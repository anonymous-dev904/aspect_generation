{"contents": ["avcodec/xwddec:", "Check", "bpp", "more", "completely", "Fixes", "out", "of", "array", "access", "Fixes:", "1399/clusterfuzz-testcase-minimized-4866094172995584", "Found-by:", "continuous", "fuzzing", "process", "https://github.com/google/oss-fuzz/tree/master/targets/ffmpeg", "Signed-off-by:", "Michael", "Niedermayer", "<michael@niedermayer.cc>"], "code_tokens": ["@", "@", "-", "157", ",", "9", "+", "157", ",", "9", "@", "@", "static", "int", "xwd_decode_frame", "(", "AVCodecContext", "*", "avctx", ",", "void", "*", "data", ",", "case", "XWD_GRAY_SCALE", ":", "if", "(", "bpp", "!", "=", "1", "&", "&", "bpp", "!", "=", "8", ")", "return", "AVERROR_INVALIDDATA", ";", "if", "(", "pixdepth", "=", "=", "1", ")", "{", "if", "(", "bpp", "=", "=", "1", "&", "&", "pixdepth", "=", "=", "1", ")", "{", "avctx", "-", ">", "pix_fmt", "=", "AV_PIX_FMT_MONOWHITE", ";", "}", "else", "if", "(", "pixdepth", "=", "=", "8", ")", "{", "}", "else", "if", "(", "bpp", "=", "=", "8", "&", "&", "pixdepth", "=", "=", "8", ")", "{", "avctx", "-", ">", "pix_fmt", "=", "AV_PIX_FMT_GRAY8", ";", "}", "break", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Fix", "for:", "libpam4j", "authenticates", "invalid", "accounts", "[https://github.com/kohsuke/libpam4j/issues/18]", "Change-Id:", "I5052cd0d9f617239a63fb036daa697cbae5bb9d7"], "code_tokens": ["@", "@", "-", "124", ",", "8", "+", "124", ",", "7", "@", "@", "public", "UnixUser", "authenticate", "(", "String", "username", ",", "String", "password", ")", "throws", "PAMExcepti", "check", "(", "libpam", ".", "pam_set_item", "(", "pht", ",", "PAM_USER", ",", "username", ")", ",\"", "pam_set_item", "failed", "\"", ");", "check", "(", "libpam", ".", "pam_authenticate", "(", "pht", ",", "0", ")", ",\"", "pam_authenticate", "failed", "\"", ");", "check", "(", "libpam", ".", "pam_setcred", "(", "pht", ",", "0", ")", ",\"", "pam_setcred", "failed", "\"", ");", "/", "/", "several", "different", "error", "code", "seem", "to", "be", "used", "to", "represent", "authentication", "failures", "/", "/", "check", "(", "libpam", ".", "pam_acct_mgmt", "(", "pht", ",", "0", ")", ",\"", "pam_acct_mgmt", "failed", "\"", ");", "check", "(", "libpam", ".", "pam_acct_mgmt", "(", "pht", ",", "0", ")", ",\"", "pam_acct_mgmt", "failed", "\"", ");", "PointerByReference", "r", "=", "new", "PointerByReference", "(", ");", "check", "(", "libpam", ".", "pam_get_item", "(", "pht", ",", "PAM_USER", ",", "r", ")", ",\"", "pam_get_item", "failed", "\"", ");"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["cifs:", "fix", "unicode", "string", "area", "word", "alignment", "in", "session", "setup", "The", "handling", "of", "unicode", "string", "area", "alignment", "is", "wrong.", "decode_unicode_ssetup", "improperly", "assumes", "that", "it", "will", "always", "be", "preceded", "by", "a", "pad", "byte.", "This", "isn't", "the", "case", "if", "the", "string", "area", "is", "already", "word-aligned.", "This", "problem,", "combined", "with", "the", "bad", "buffer", "sizing", "for", "the", "serverDomain", "string", "can", "cause", "memory", "corruption.", "The", "bad", "alignment", "can", "make", "it", "so", "that", "the", "alignment", "of", "the", "characters", "is", "off.", "This", "can", "make", "them", "translate", "to", "characters", "that", "are", "greater", "than", "2", "bytes", "each.", "If", "this", "happens", "we", "can", "overflow", "the", "allocation.", "Fix", "this", "by", "fixing", "the", "alignment", "in", "CIFS_SessSetup", "instead", "so", "we", "can", "verify", "it", "against", "the", "head", "of", "the", "response.", "Also,", "clean", "up", "the", "workaround", "for", "improperly", "terminated", "strings", "by", "checking", "for", "a", "odd-length", "unicode", "buffers", "and", "then", "forcibly", "terminating", "them.", "Finally,", "resize", "the", "buffer", "for", "serverDomain.", "Now", "that", "we've", "fixed", "the", "alignment,", "it's", "probably", "fine,", "but", "a", "malicious", "server", "could", "overflow", "it.", "A", "better", "solution", "for", "handling", "these", "strings", "is", "still", "needed,", "but", "this", "should", "be", "a", "suitable", "bandaid.", "Signed-off-by:", "Jeff", "Layton", "<jlayton@redhat.com>", "CC:", "Stable", "<stable@vger.kernel.org>", "Signed-off-by:", "Steve", "French", "<sfrench@us.ibm.com>"], "code_tokens": ["@", "@", "-", "285", ",", "27", "+", "285", ",", "26", "@", "@", "static", "int", "decode_unicode_ssetup", "(", "char", "*", "*", "pbcc_area", ",", "int", "bleft", ",", "int", "words_left", ",", "len", ";", "char", "*", "data", "=", "*", "pbcc_area", ";", "cFYI", "(", "1", ",", "(", "\"", "bleft", "%", "d", "\"", ",", "bleft", ")", ");", "/", "*", "SMB", "header", "is", "unaligned", ",", "so", "cifs", "servers", "word", "align", "start", "of", "Unicode", "strings", "*", "/", "data", "+", "+;", "bleft", "-", "-;", "/", "*", "Windows", "servers", "do", "not", "always", "double", "null", "terminate", "their", "final", "Unicode", "string", "-", "in", "which", "case", "we", "now", "will", "not", "attempt", "to", "decode", "the", "byte", "of", "junk", "which", "follows", "it", "*", "/", "/", "*", "*", "Windows", "servers", "do", "not", "always", "double", "null", "terminate", "their", "final", "*", "Unicode", "string", ".", "Check", "to", "see", "if", "there", "are", "an", "uneven", "number", "of", "bytes", "*", "left", ".", "If", "so", ",", "then", "add", "an", "extra", "NULL", "pad", "byte", "to", "the", "end", "of", "the", "*", "response", ".", "*", "*", "See", "section", "2", ".", "7", ".", "2", "in", "\"", "Implementing", "CIFS", "\"", "for", "details", "*", "/", "if", "(", "bleft", "%", "2", ")", "{", "data", "[", "bleft", "]", "=", "0", ";", "+", "+", "bleft", ";", "}", "words_left", "=", "bleft", "/", "2", ";", "/", "*", "save", "off", "server", "operating", "system", "*", "/", "len", "=", "UniStrnlen", "(", "(", "wchar_t", "*", ")", "data", ",", "words_left", ")", ";", "/", "*", "We", "look", "for", "obvious", "messed", "up", "bcc", "or", "strings", "in", "response", "so", "we", "do", "not", "go", "off", "the", "end", "since", "(", "at", "least", ")", "WIN2K", "and", "Windows", "XP", "have", "a", "major", "bug", "in", "not", "null", "terminating", "last", "Unicode", "string", "in", "response", "*", "/", "if", "(", "len", ">", "=", "words_left", ")", "return", "rc", ";", "@", "@", "-", "343", ",", "13", "+", "342", ",", "10", "@", "@", "static", "int", "decode_unicode_ssetup", "(", "char", "*", "*", "pbcc_area", ",", "int", "bleft", ",", "return", "rc", ";", "kfree", "(", "ses", "-", ">", "serverDomain", ")", ";", "ses", "-", ">", "serverDomain", "=", "kzalloc", "(", "2", "*", "(", "len", "+", "1", ")", ",", "GFP_KERNEL", ")", ";", "/", "*", "BB", "FIXME", "wrong", "length", "*", "/", "if", "(", "ses", "-", ">", "serverDomain", "!", "=", "NULL", ")", "{", "ses", "-", ">", "serverDomain", "=", "kzalloc", "(", "(", "4", "*", "len", ")", "+", "2", ",", "GFP_KERNEL", ")", ";", "if", "(", "ses", "-", ">", "serverDomain", "!", "=", "NULL", ")", "cifs_strfromUCS_le", "(", "ses", "-", ">", "serverDomain", ",", "(", "__le16", "*", ")", "data", ",", "len", ",", "nls_cp", ")", ";", "ses", "-", ">", "serverDomain", "[", "2", "*", "len", "]", "=", "0", ";", "ses", "-", ">", "serverDomain", "[", "(", "2", "*", "len", ")", "+", "1", "]", "=", "0", ";", "}", "data", "+", "=", "2", "*", "(", "len", "+", "1", ")", ";", "words_left", "-", "=", "len", "+", "1", ";", "@", "@", "-", "702", ",", "12", "+", "698", ",", "18", "@", "@", "CIFS_SessSetup", "(", "unsigned", "int", "xid", ",", "struct", "cifsSesInfo", "*", "ses", ",", "int", "first_time", ",", "}", "/", "*", "BB", "check", "if", "Unicode", "and", "decode", "strings", "*", "/", "if", "(", "smb_buf", "-", ">", "Flags2", "&", "SMBFLG2_UNICODE", ")", "if", "(", "smb_buf", "-", ">", "Flags2", "&", "SMBFLG2_UNICODE", ")", "{", "/", "*", "unicode", "string", "area", "must", "be", "word", "-", "aligned", "*", "/", "if", "(", "((", "unsigned", "long", ")", "bcc_ptr", "-", "(", "unsigned", "long", ")", "smb_buf", ")", "%", "2", ")", "{", "+", "+", "bcc_ptr", ";", "-", "-", "bytes_remaining", ";", "}", "rc", "=", "decode_unicode_ssetup", "(", "&", "bcc_ptr", ",", "bytes_remaining", ",", "ses", ",", "nls_cp", ")", ";", "else", "ses", ",", "nls_cp", ")", ";", "}", "else", "{", "rc", "=", "decode_ascii_ssetup", "(", "&", "bcc_ptr", ",", "bytes_remaining", ",", "ses", ",", "nls_cp", ")", ";", "}", "ssetup_exit", ":", "if", "(", "spnego_key", ")", "{"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Credits", "translators", "who", "helped", "reach", "100%", "of", "translated", "BP", "trunk", "Many", "thanks", "to", "you", "5", "\ud83d\udcaa.", "Props", "dancaragea,", "ianbarnes,", "nobnob,", "marbaque,", "markscottrobson", "See", "#8514", "git-svn-id:", "https://buddypress.svn.wordpress.org/trunk@13022", "cdf35c40-ae34-48e0-9cc9-0c9da1808c22"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["fix", "upstream", "nightly", "pipeline", "(#3658)", "pipeline", "fixes", "under", "this", "PR", "externalca_nssdb-topo-03-sk", "topology_02_ldaps_sk", "topo-03-kra-bugzilla", "Signed-off-by:", "Deepak", "Punia", "<dpunia@redhat.com>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["added", "data:", "link", "fix", "to", "prevent", "xss"], "code_tokens": ["@", "@", "-", "875", ",", "7", "+", "875", ",", "7", "@", "@", "Renderer", ".", "prototype", ".", "link", "=", "function", "(", "href", ",", "title", ",", "text", ")", "{", "}", "catch", "(", "e", ")", "{", "return", "'", "';", "}", "if", "(", "prot", ".", "indexOf", "(", "'", "javascript", ":", "')", "=", "==", "0", "|", "|", "prot", ".", "indexOf", "(", "'", "vbscript", ":", "')", "=", "==", "0", ")", "{", "if", "(", "prot", ".", "indexOf", "(", "'", "javascript", ":", "')", "=", "==", "0", "|", "|", "prot", ".", "indexOf", "(", "'", "vbscript", ":", "')", "=", "==", "0", "|", "|", "prot", ".", "indexOf", "(", "'", "data", ":", "')", "=", "==", "0", ")", "{", "return", "'", "';", "}", "}", "@", "@", "-", "1", ",", "4", "+", "1", ",", "5", "@", "@", "<", "p", ">", "</", "p", ">", "<", "p", ">", "</", "p", ">", "<", "p", ">", "</", "p", ">", "<", "p", ">", "</", "p", ">", "<", "p", ">", "</", "p", ">", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "4", ",", "4", "+", "4", ",", "6", "@", "@", "[", "URL", "]", "(", "javascript", "&", "colon", ";", "alert", "&", "#", "40", ";", "1", "&", "#", "41", ";", ")", "[", "URL", "]", "(", "javascript", "&", "#", "58document", ";", "alert", "&", "#", "40", ";", "1", "&", "#", "41", ";", ")", "\\", "No", "newline", "at", "end", "of", "file", "[", "URL", "]", "(", "javascript", "&", "#", "58document", ";", "alert", "&", "#", "40", ";", "1", "&", "#", "41", ";", ")", "[", "URL", "]", "(", "data", ":", "text", "/", "html", ";", "base64", ",", "PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K", ")", "\\", "No", "newline", "at", "end", "of", "file"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["mac80211:", "fix", "AP", "powersave", "TX", "vs.", "wakeup", "race", "There", "is", "a", "race", "between", "the", "TX", "path", "and", "the", "STA", "wakeup:", "while", "a", "station", "is", "sleeping,", "mac80211", "buffers", "frames", "until", "it", "wakes", "up,", "then", "the", "frames", "are", "transmitted.", "However,", "the", "RX", "and", "TX", "path", "are", "concurrent,", "so", "the", "packet", "indicating", "wakeup", "can", "be", "processed", "while", "a", "packet", "is", "being", "transmitted.", "This", "can", "lead", "to", "a", "situation", "where", "the", "buffered", "frames", "list", "is", "emptied", "on", "the", "one", "side,", "while", "a", "frame", "is", "being", "added", "on", "the", "other", "side,", "as", "the", "station", "is", "still", "seen", "as", "sleeping", "in", "the", "TX", "path.", "As", "a", "result,", "the", "newly", "added", "frame", "will", "not", "be", "send", "anytime", "soon.", "It", "might", "be", "sent", "much", "later", "(and", "out", "of", "order)", "when", "the", "station", "goes", "to", "sleep", "and", "wakes", "up", "the", "next", "time.", "Additionally,", "it", "can", "lead", "to", "the", "crash", "below.", "Fix", "all", "this", "by", "synchronising", "both", "paths", "with", "a", "new", "lock.", "Both", "path", "are", "not", "fastpath", "since", "they", "handle", "PS", "situations.", "In", "a", "later", "patch", "we'll", "remove", "the", "extra", "skb", "queue", "locks", "to", "reduce", "locking", "overhead.", "BUG:", "unable", "to", "handle", "kernel", "NULL", "pointer", "dereference", "at", "000000b0", "IP:", "[<ff6f1791>]", "ieee80211_report_used_skb+0x11/0x3e0", "[mac80211]", "*pde", "=", "00000000", "Oops:", "0000", "[#1]", "SMP", "DEBUG_PAGEALLOC", "EIP:", "0060:[<ff6f1791>]", "EFLAGS:", "00210282", "CPU:", "1", "EIP", "is", "at", "ieee80211_report_used_skb+0x11/0x3e0", "[mac80211]", "EAX:", "e5900da0", "EBX:", "00000000", "ECX:", "00000001", "EDX:", "00000000", "ESI:", "e41d00c0", "EDI:", "e5900da0", "EBP:", "ebe458e4", "ESP:", "ebe458b0", "DS:", "007b", "ES:", "007b", "FS:", "00d8", "GS:", "00e0", "SS:", "0068", "CR0:", "8005003b", "CR2:", "000000b0", "CR3:", "25a78000", "CR4:", "000407d0", "DR0:", "00000000", "DR1:", "00000000", "DR2:", "00000000", "DR3:", "00000000", "DR6:", "ffff0ff0", "DR7:", "00000400", "Process", "iperf", "(pid:", "3934,", "ti=ebe44000", "task=e757c0b0", "task.ti=ebe44000)", "iwlwifi", "0000:02:00.0:", "I", "iwl_pcie_enqueue_hcmd", "Sending", "command", "LQ_CMD", "(#4e),", "seq:", "0x0903,", "92", "bytes", "at", "3[3]:9", "Stack:", "e403b32c", "ebe458c4", "00200002", "00200286", "e403b338", "ebe458cc", "c10960bb", "e5900da0", "ff76a6ec", "ebe458d8", "00000000", "e41d00c0", "e5900da0", "ebe458f0", "ff6f1b75", "e403b210", "ebe4598c", "ff723dc1", "00000000", "ff76a6ec", "e597c978", "e403b758", "00000002", "00000002", "Call", "Trace:", "[<ff6f1b75>]", "ieee80211_free_txskb+0x15/0x20", "[mac80211]", "[<ff723dc1>]", "invoke_tx_handlers+0x1661/0x1780", "[mac80211]", "[<ff7248a5>]", "ieee80211_tx+0x75/0x100", "[mac80211]", "[<ff7249bf>]", "ieee80211_xmit+0x8f/0xc0", "[mac80211]", "[<ff72550e>]", "ieee80211_subif_start_xmit+0x4fe/0xe20", "[mac80211]", "[<c149ef70>]", "dev_hard_start_xmit+0x450/0x950", "[<c14b9aa9>]", "sch_direct_xmit+0xa9/0x250", "[<c14b9c9b>]", "__qdisc_run+0x4b/0x150", "[<c149f732>]", "dev_queue_xmit+0x2c2/0xca0", "Cc:", "stable@vger.kernel.org", "Reported-by:", "Yaara", "Rozenblum", "<yaara.rozenblum@intel.com>", "Signed-off-by:", "Emmanuel", "Grumbach", "<emmanuel.grumbach@intel.com>", "Reviewed-by:", "Stanislaw", "Gruszka", "<sgruszka@redhat.com>", "[reword", "commit", "log,", "use", "a", "separate", "lock]", "Signed-off-by:", "Johannes", "Berg", "<johannes.berg@intel.com>"], "code_tokens": ["@", "@", "-", "330", ",", "6", "+", "330", ",", "7", "@", "@", "struct", "sta_info", "*", "sta_info_alloc", "(", "struct", "ieee80211_sub_if_data", "*", "sdata", ",", "rcu_read_unlock", "(", ");", "spin_lock_init", "(", "&", "sta", "-", ">", "lock", ")", ";", "spin_lock_init", "(", "&", "sta", "-", ">", "ps_lock", ")", ";", "INIT_WORK", "(", "&", "sta", "-", ">", "drv_unblock_wk", ",", "sta_unblock", ")", ";", "INIT_WORK", "(", "&", "sta", "-", ">", "ampdu_mlme", ".", "work", ",", "ieee80211_ba_session_work", ")", ";", "mutex_init", "(", "&", "sta", "-", ">", "ampdu_mlme", ".", "mtx", ")", ";", "@", "@", "-", "1109", ",", "6", "+", "1110", ",", "8", "@", "@", "void", "ieee80211_sta_ps_deliver_wakeup", "(", "struct", "sta_info", "*", "sta", ")", "skb_queue_head_init", "(", "&", "pending", ")", ";", "/", "*", "sync", "with", "ieee80211_tx_h_unicast_ps_buf", "*", "/", "spin_lock", "(", "&", "sta", "-", ">", "ps_lock", ")", ";", "/", "*", "Send", "all", "buffered", "frames", "to", "the", "station", "*", "/", "for", "(", "ac", "=", "0", ";", "ac", "<", "IEEE80211_NUM_ACS", ";", "ac", "+", "+)", "{", "int", "count", "=", "skb_queue_len", "(", "&", "pending", ")", ",", "tmp", ";", "@", "@", "-", "1128", ",", "6", "+", "1131", ",", "7", "@", "@", "void", "ieee80211_sta_ps_deliver_wakeup", "(", "struct", "sta_info", "*", "sta", ")", "}", "ieee80211_add_pending_skbs_fn", "(", "local", ",", "&", "pending", ",", "clear_sta_ps_flags", ",", "sta", ")", ";", "spin_unlock", "(", "&", "sta", "-", ">", "ps_lock", ")", ";", "/", "*", "This", "station", "just", "woke", "up", "and", "isn", "'", "t", "aware", "of", "our", "SMPS", "state", "*", "/", "if", "(", "!", "ieee80211_smps_is_restrictive", "(", "sta", "-", ">", "known_smps_mode", ",", "@", "@", "-", "267", ",", "6", "+", "267", ",", "7", "@", "@", "struct", "ieee80211_tx_latency_stat", "{", "*", "@", "drv_unblock_wk", ":", "used", "for", "driver", "PS", "unblocking", "*", "@", "listen_interval", ":", "listen", "interval", "of", "this", "station", ",", "when", "we", "'", "re", "acting", "as", "AP", "*", "@", "_flags", ":", "STA", "flags", ",", "see", "&", "enum", "ieee80211_sta_info_flags", ",", "do", "not", "use", "directly", "*", "@", "ps_lock", ":", "used", "for", "powersave", "(", "when", "mac80211", "is", "the", "AP", ")", "related", "locking", "*", "@", "ps_tx_buf", ":", "buffers", "(", "per", "AC", ")", "of", "frames", "to", "transmit", "to", "this", "station", "*", "when", "it", "leaves", "power", "saving", "state", "or", "polls", "*", "@", "tx_filtered", ":", "buffers", "(", "per", "AC", ")", "of", "frames", "we", "already", "tried", "to", "@", "@", "-", "356", ",", "10", "+", "357", ",", "8", "@", "@", "struct", "sta_info", "{", "/", "*", "use", "the", "accessors", "defined", "below", "*", "/", "unsigned", "long", "_flags", ";", "/", "*", "*", "STA", "powersave", "frame", "queues", ",", "no", "more", "than", "the", "internal", "*", "locking", "required", ".", "*", "/", "/", "*", "STA", "powersave", "lock", "and", "frame", "queues", "*", "/", "spinlock_t", "ps_lock", ";", "struct", "sk_buff_head", "ps_tx_buf", "[", "IEEE80211_NUM_ACS", "]", ";", "struct", "sk_buff_head", "tx_filtered", "[", "IEEE80211_NUM_ACS", "]", ";", "unsigned", "long", "driver_buffered_tids", ";", "@", "@", "-", "478", ",", "6", "+", "478", ",", "20", "@", "@", "ieee80211_tx_h_unicast_ps_buf", "(", "struct", "ieee80211_tx_data", "*", "tx", ")", "sta", "-", ">", "sta", ".", "addr", ",", "sta", "-", ">", "sta", ".", "aid", ",", "ac", ")", ";", "if", "(", "tx", "-", ">", "local", "-", ">", "total_ps_buffered", ">", "=", "TOTAL_MAX_TX_BUFFER", ")", "purge_old_ps_buffers", "(", "tx", "-", ">", "local", ")", ";", "/", "*", "sync", "with", "ieee80211_sta_ps_deliver_wakeup", "*", "/", "spin_lock", "(", "&", "sta", "-", ">", "ps_lock", ")", ";", "/", "*", "*", "STA", "woke", "up", "the", "meantime", "and", "all", "the", "frames", "on", "ps_tx_buf", "have", "*", "been", "queued", "to", "pending", "queue", ".", "No", "reordering", "can", "happen", ",", "go", "*", "ahead", "and", "Tx", "the", "packet", ".", "*", "/", "if", "(", "!", "test_sta_flag", "(", "sta", ",", "WLAN_STA_PS_STA", ")", "&", "&", "!", "test_sta_flag", "(", "sta", ",", "WLAN_STA_PS_DRIVER", ")", ")", "{", "spin_unlock", "(", "&", "sta", "-", ">", "ps_lock", ")", ";", "return", "TX_CONTINUE", ";", "}", "if", "(", "skb_queue_len", "(", "&", "sta", "-", ">", "ps_tx_buf", "[", "ac", "]", ")", ">", "=", "STA_MAX_TX_BUFFER", ")", "{", "struct", "sk_buff", "*", "old", "=", "skb_dequeue", "(", "&", "sta", "-", ">", "ps_tx_buf", "[", "ac", "]", ");", "ps_dbg", "(", "tx", "-", ">", "sdata", ",", "@", "@", "-", "492", ",", "6", "+", "506", ",", "7", "@", "@", "ieee80211_tx_h_unicast_ps_buf", "(", "struct", "ieee80211_tx_data", "*", "tx", ")", "info", "-", ">", "flags", "|", "=", "IEEE80211_TX_INTFL_NEED_TXPROCESSING", ";", "info", "-", ">", "flags", "&", "=", "~", "IEEE80211_TX_TEMPORARY_FLAGS", ";", "skb_queue_tail", "(", "&", "sta", "-", ">", "ps_tx_buf", "[", "ac", "]", ",", "tx", "-", ">", "skb", ")", ";", "spin_unlock", "(", "&", "sta", "-", ">", "ps_lock", ")", ";", "if", "(", "!", "timer_pending", "(", "&", "local", "-", ">", "sta_cleanup", ")", ")", "mod_timer", "(", "&", "local", "-", ">", "sta_cleanup", ","], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["xconfig:", "fix", "'Show", "Debug'", "functionality", "xconfig", "-", "Fix", "missing", "'Show", "Debug'", "functionality.", "xconfig", "Help", "mentions", "'Show", "Debug", "Info'", "but", "it", "was", "missing", "from", "any", "menu.", "*", "Add", "'Show", "debug'", "menu", "to", "the", "main", "menu.", "*", "Properly", "load", "showDebug", "settings.", "Reported-by:", "Jason", "Vas", "Dias", "<jason.vas.dias@gmail.com>", "Signed-off-by:", "Boris", "Barbulovski", "<bbarbulovski@gmail.com>", "Signed-off-by:", "Randy", "Dunlap", "<rdunlap@infradead.org>", "Tested-by:", "Randy", "Dunlap", "<rdunlap@infradead.org>", "Signed-off-by:", "Michal", "Marek", "<mmarek@suse.com>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["perf_counter:", "Fix", "buffer", "overflow", "in", "perf_copy_attr()", "If", "we", "pass", "a", "big", "size", "data", "over", "perf_counter_open()", "syscall,", "the", "kernel", "will", "copy", "this", "data", "to", "a", "small", "buffer,", "it", "will", "cause", "kernel", "crash.", "This", "bug", "makes", "the", "kernel", "unsafe", "and", "non-root", "local", "user", "can", "trigger", "it.", "Signed-off-by:", "Xiao", "Guangrong", "<xiaoguangrong@cn.fujitsu.com>", "Acked-by:", "Peter", "Zijlstra", "<peterz@infradead.org>", "Acked-by:", "Paul", "Mackerras", "<paulus@samba.org>", "Cc:", "<stable@kernel.org>", "LKML-Reference:", "<4AAF37D4.5010706@cn.fujitsu.com>", "Signed-off-by:", "Ingo", "Molnar", "<mingo@elte.hu>"], "code_tokens": ["@", "@", "-", "4171", ",", "6", "+", "4171", ",", "7", "@", "@", "static", "int", "perf_copy_attr", "(", "struct", "perf_counter_attr", "__user", "*", "uattr", ",", "if", "(", "val", ")", "goto", "err_size", ";", "}", "size", "=", "sizeof", "(", "*", "attr", ")", ";", "}", "ret", "=", "copy_from_user", "(", "attr", ",", "uattr", ",", "size", ")", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["drm/i915:", "bounds", "check", "execbuffer", "relocation", "count", "It", "is", "possible", "to", "wrap", "the", "counter", "used", "to", "allocate", "the", "buffer", "for", "relocation", "copies.", "This", "could", "lead", "to", "heap", "writing", "overflows.", "CVE-2013-0913", "v3:", "collapse", "test,", "improve", "comment", "v2:", "move", "check", "into", "validate_exec_list", "Signed-off-by:", "Kees", "Cook", "<keescook@chromium.org>", "Reported-by:", "Pinkie", "Pie", "Cc:", "stable@vger.kernel.org", "Reviewed-by:", "Chris", "Wilson", "<chris@chris-wilson.co.uk>", "Signed-off-by:", "Daniel", "Vetter", "<daniel.vetter@ffwll.ch>"], "code_tokens": ["@", "@", "-", "732", ",", "6", "+", "732", ",", "8", "@", "@", "validate_exec_list", "(", "struct", "drm_i915_gem_exec_object2", "*", "exec", ",", "int", "count", ")", "{", "int", "i", ";", "int", "relocs_total", "=", "0", ";", "int", "relocs_max", "=", "INT_MAX", "/", "sizeof", "(", "struct", "drm_i915_gem_relocation_entry", ")", ";", "for", "(", "i", "=", "0", ";", "i", "<", "count", ";", "i", "+", "+)", "{", "char", "__user", "*", "ptr", "=", "(", "char", "__user", "*", ")(", "uintptr_t", ")", "exec", "[", "i", "]", ".", "relocs_ptr", ";", "@", "@", "-", "740", ",", "10", "+", "742", ",", "13", "@", "@", "validate_exec_list", "(", "struct", "drm_i915_gem_exec_object2", "*", "exec", ",", "if", "(", "exec", "[", "i", "]", ".", "flags", "&", "__EXEC_OBJECT_UNKNOWN_FLAGS", ")", "return", "-", "EINVAL", ";", "/", "*", "First", "check", "for", "malicious", "input", "causing", "overflow", "*", "/", "if", "(", "exec", "[", "i", "]", ".", "relocation_count", ">", "INT_MAX", "/", "sizeof", "(", "struct", "drm_i915_gem_relocation_entry", ")", ")", "/", "*", "First", "check", "for", "malicious", "input", "causing", "overflow", "in", "*", "the", "worst", "case", "where", "we", "need", "to", "allocate", "the", "entire", "*", "relocation", "tree", "as", "a", "single", "array", ".", "*", "/", "if", "(", "exec", "[", "i", "]", ".", "relocation_count", ">", "relocs_max", "-", "relocs_total", ")", "return", "-", "EINVAL", ";", "relocs_total", "+", "=", "exec", "[", "i", "]", ".", "relocation_count", ";", "length", "=", "exec", "[", "i", "]", ".", "relocation_count", "*", "sizeof", "(", "struct", "drm_i915_gem_relocation_entry", ")", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["MPS-30661", "MPS", "opens", "tcp", "ports", "listening", "for", "0.0.0.0"], "code_tokens": ["@", "@", "-", "1718", ",", "9", "+", "1718", ",", "7", "@", "@", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "liA8E", "\"", "id", "=", "\"", "1WjOD0I_pFc", "\"", "role", "=", "\"", "2OqNvi", "\"", ">", "<", "ref", "role", "=", "\"", "37wK5l", "\"", "to", "=", "\"", "zf81", ":", "~", "ServerSocket", ".", "setReuseAddress", "(", "boolean", ")", "\"", "resolve", "=", "\"", "setReuseAddress", "\"", "/", ">", "<", "node", "concept", "=", "\"", "3clFbT", "\"", "id", "=", "\"", "1WjOD0I_pGS", "\"", "role", "=", "\"", "37wK5m", "\"", ">", "<", "property", "role", "=", "\"", "3clFbU", "\"", "value", "=", "\"", "true", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3clFbT", "\"", "id", "=", "\"", "1WjOD0I_pGS", "\"", "role", "=", "\"", "37wK5m", "\"", "/", ">", "<", "/", "node", ">", "<", "/", "node", ">", "<", "/", "node", ">", "@", "@", "-", "1893", ",", "9", "+", "1891", ",", "7", "@", "@", "<", "node", "concept", "=", "\"", "10P_77", "\"", "id", "=", "\"", "G", "$", "0uqqCcrP", "\"", "role", "=", "\"", "3clF45", "\"", "/", ">", "<", "node", "concept", "=", "\"", "3clFbS", "\"", "id", "=", "\"", "G", "$", "0uqqCcrR", "\"", "role", "=", "\"", "3clF47", "\"", ">", "<", "node", "concept", "=", "\"", "3clFbF", "\"", "id", "=", "\"", "G", "$", "0uqqCcrU", "\"", "role", "=", "\"", "3cqZAp", "\"", ">", "<", "node", "concept", "=", "\"", "3clFbT", "\"", "id", "=", "\"", "G", "$", "0uqqCcrT", "\"", "role", "=", "\"", "3clFbG", "\"", ">", "<", "property", "role", "=", "\"", "3clFbU", "\"", "value", "=", "\"", "true", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3clFbT", "\"", "id", "=", "\"", "G", "$", "0uqqCcrT", "\"", "role", "=", "\"", "3clFbG", "\"", "/", ">", "<", "/", "node", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "2AHcQZ", "\"", "id", "=", "\"", "G", "$", "0uqqCcrS", "\"", "role", "=", "\"", "2AJF6D", "\"", ">", "@", "@", "-", "2219", ",", "9", "+", "2215", ",", "7", "@", "@", "<", "node", "concept", "=", "\"", "10P_77", "\"", "id", "=", "\"", "3PMO5H7WJ6g", "\"", "role", "=", "\"", "3clF45", "\"", "/", ">", "<", "node", "concept", "=", "\"", "3clFbS", "\"", "id", "=", "\"", "3PMO5H7WJ6h", "\"", "role", "=", "\"", "3clF47", "\"", ">", "<", "node", "concept", "=", "\"", "3clFbF", "\"", "id", "=", "\"", "3PMO5H7WJ6i", "\"", "role", "=", "\"", "3cqZAp", "\"", ">", "<", "node", "concept", "=", "\"", "3clFbT", "\"", "id", "=", "\"", "3PMO5H7WJ6j", "\"", "role", "=", "\"", "3clFbG", "\"", ">", "<", "property", "role", "=", "\"", "3clFbU", "\"", "value", "=", "\"", "true", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3clFbT", "\"", "id", "=", "\"", "3PMO5H7WJ6j", "\"", "role", "=", "\"", "3clFbG", "\"", "/", ">", "<", "/", "node", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "2AHcQZ", "\"", "id", "=", "\"", "3PMO5H7WJ6k", "\"", "role", "=", "\"", "2AJF6D", "\"", ">", "@", "@", "-", "1", ",", "5", "+", "1", ",", "5", "@", "@", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "?>", "<", "product", "version", "=", "\"", "3", "\"", "modelHash", "=", "\"-", "5wtk7wsu7eoadzhvxu2qqk5wx8ohzu5", "\"", ">", "<", "product", "version", "=", "\"", "3", "\"", "modelHash", "=", "\"", "56pj07iad95qk9ljhz67odnsk14i1ak", "\"", ">", "<", "files", "names", "=", "\"", "HttpRequest", ".", "java", ":", "HttpSupportPluginNotifications", ".", "java", ":", "IHttpRequestHandler", ".", "java", ":", "IHttpRequestHandlerFactory", ".", "java", ":", "MPSIntegrationPortManager", ".", "java", ":", "MPSInternalPortManager", ".", "java", ":", "MPSRequestManager", ".", "java", "\"", "/", ">", "<", "/", "product", ">", "@", "@", "-", "32", ",", "7", "+", "32", ",", "7", "@", "@", "private", "int", "findPort", "(", ")", "{", "ServerSocket", "socket", ";", "try", "{", "socket", "=", "new", "ServerSocket", "(", ");", "socket", ".", "setReuseAddress", "(", "true", ")", ";", "socket", ".", "setReuseAddress", "(", "false", ")", ";", "socket", ".", "bind", "(", "new", "InetSocketAddress", "(", "port", ")", ");", "socket", ".", "close", "(", ");", "@", "@", "-", "55", ",", "7", "+", "55", ",", "7", "@", "@", "public", "void", "cannotBind", "(", "Exception", "e", ",", "int", "port", ")", "{", "@", "Override", "public", "boolean", "isAvailableExternally", "(", ")", "{", "return", "true", ";", "return", "false", ";", "}", "public", "static", "int", "getCurrentPort", "(", ")", "{", "@", "@", "-", "49", ",", "7", "+", "49", ",", "7", "@", "@", "public", "void", "cannotBind", "(", "Exception", "e", ",", "int", "port", ")", "{", "@", "Override", "public", "boolean", "isAvailableExternally", "(", ")", "{", "return", "true", ";", "return", "false", ";", "}", "public", "static", "boolean", "isEnabled", "(", ")", "{", "@", "@", "-", "157", ",", "7", "+", "157", ",", "7", "@", "@", "<", "node", "id", "=", "\"", "7730948292370037540", "\"", "at", "=", "\"", "33", ",", "33", ",", "34", ",", "22", "\"", "concept", "=", "\"", "1", "\"", "/", ">", "<", "node", "id", "=", "\"", "4427830474126516198", "\"", "at", "=", "\"", "40", ",", "24", ",", "41", ",", "39", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "3750908339007129361", "\"", "at", "=", "\"", "45", ",", "49", ",", "46", ",", "144", "\"", "concept", "=", "\"", "1", "\"", "/", ">", "<", "node", "id", "=", "\"", "4427830474126324114", "\"", "at", "=", "\"", "51", ",", "42", ",", "52", ",", "16", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "4427830474126324114", "\"", "at", "=", "\"", "51", ",", "42", ",", "52", ",", "17", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "4427830474126539076", "\"", "at", "=", "\"", "55", ",", "37", ",", "56", ",", "73", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "4739183745611777362", "\"", "at", "=", "\"", "59", ",", "38", ",", "60", ",", "418", "\"", "concept", "=", "\"", "9", "\"", "/", ">", "<", "node", "id", "=", "\"", "4170577479149439104", "\"", "at", "=", "\"", "60", ",", "418", ",", "61", ",", "46", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "@", "@", "-", "172", ",", "7", "+", "172", ",", "7", "@", "@", "<", "node", "id", "=", "\"", "4170577479149191565", "\"", "at", "=", "\"", "25", ",", "0", ",", "38", ",", "0", "\"", "concept", "=", "\"", "0", "\"", "trace", "=", "\"", "MPSInternalPortManager", "#", "()", "V", "\"", "/", ">", "<", "scope", "id", "=", "\"", "4427830474126324052", "\"", "at", "=", "\"", "40", ",", "24", ",", "41", ",", "39", "\"", "/", ">", "<", "scope", "id", "=", "\"", "4427830474126324064", "\"", "at", "=", "\"", "45", ",", "49", ",", "46", ",", "144", "\"", "/", ">", "<", "scope", "id", "=", "\"", "4427830474126324113", "\"", "at", "=", "\"", "51", ",", "42", ",", "52", ",", "16", "\"", "/", ">", "<", "scope", "id", "=", "\"", "4427830474126324113", "\"", "at", "=", "\"", "51", ",", "42", ",", "52", ",", "17", "\"", "/", ">", "<", "scope", "id", "=", "\"", "4427830474126538663", "\"", "at", "=", "\"", "55", ",", "37", ",", "56", ",", "73", "\"", "/", ">", "<", "scope", "id", "=", "\"", "4170577479149429594", "\"", "at", "=", "\"", "32", ",", "67", ",", "34", ",", "22", "\"", "/", ">", "<", "scope", "id", "=", "\"", "4170577479149437914", "\"", "at", "=", "\"", "59", ",", "38", ",", "61", ",", "46", "\"", "/", ">", "@", "@", "-", "294", ",", "16", "+", "294", ",", "16", "@", "@", "<", "node", "id", "=", "\"", "8307722521382980144", "\"", "at", "=", "\"", "26", ",", "5", ",", "27", ",", "16", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "6335079110187781402", "\"", "at", "=", "\"", "31", ",", "59", ",", "32", ",", "26", "\"", "concept", "=", "\"", "7", "\"", "/", ">", "<", "node", "id", "=", "\"", "6335079110187785218", "\"", "at", "=", "\"", "33", ",", "11", ",", "34", ",", "36", "\"", "concept", "=", "\"", "1", "\"", "/", ">", "<", "node", "id", "=", "\"", "2239364956431946071", "\"", "at", "=", "\"", "34", ",", "36", ",", "35", ",", "37", "\"", "concept", "=", "\"", "1", "\"", "/", ">", "<", "node", "id", "=", "\"", "2239364956431950131", "\"", "at", "=", "\"", "35", ",", "37", ",", "36", ",", "49", "\"", "concept", "=", "\"", "1", "\"", "/", ">", "<", "node", "id", "=", "\"", "2239364956431946071", "\"", "at", "=", "\"", "34", ",", "36", ",", "35", ",", "38", "\"", "concept", "=", "\"", "1", "\"", "/", ">", "<", "node", "id", "=", "\"", "2239364956431950131", "\"", "at", "=", "\"", "35", ",", "38", ",", "36", ",", "49", "\"", "concept", "=", "\"", "1", "\"", "/", ">", "<", "node", "id", "=", "\"", "6335079110187746245", "\"", "at", "=", "\"", "36", ",", "49", ",", "37", ",", "23", "\"", "concept", "=", "\"", "1", "\"", "/", ">", "<", "node", "id", "=", "\"", "6335079110187745649", "\"", "at", "=", "\"", "37", ",", "23", ",", "38", ",", "0", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "6335079110187736890", "\"", "at", "=", "\"", "38", ",", "0", ",", "39", ",", "20", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "6335079110187788684", "\"", "at", "=", "\"", "40", ",", "33", ",", "41", ",", "21", "\"", "concept", "=", "\"", "9", "\"", "/", ">", "<", "node", "id", "=", "\"", "2239364956432076216", "\"", "at", "=", "\"", "43", ",", "44", ",", "44", ",", "90", "\"", "concept", "=", "\"", "1", "\"", "/", ">", "<", "node", "id", "=", "\"", "6335079110187742852", "\"", "at", "=", "\"", "47", ",", "5", ",", "48", ",", "21", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "3750908339007132279", "\"", "at", "=", "\"", "52", ",", "49", ",", "53", ",", "183", "\"", "concept", "=", "\"", "1", "\"", "/", ">", "<", "node", "id", "=", "\"", "802768723527124730", "\"", "at", "=", "\"", "57", ",", "42", ",", "58", ",", "16", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "802768723527124730", "\"", "at", "=", "\"", "57", ",", "42", ",", "58", ",", "17", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "64850105743264062", "\"", "at", "=", "\"", "61", ",", "38", ",", "62", ",", "76", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "6335079110187223709", "\"", "at", "=", "\"", "23", ",", "24", ",", "26", ",", "5", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "2239364956432076216", "\"", "at", "=", "\"", "42", ",", "31", ",", "45", ",", "9", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "@", "@", "-", "321", ",", "7", "+", "321", ",", "7", "@", "@", "<", "scope", "id", "=", "\"", "6335079110187231518", "\"", "at", "=", "\"", "40", ",", "33", ",", "41", ",", "21", "\"", "/", ">", "<", "scope", "id", "=", "\"", "2239364956432076216", "\"", "at", "=", "\"", "43", ",", "44", ",", "44", ",", "90", "\"", "/", ">", "<", "scope", "id", "=", "\"", "802768723527124720", "\"", "at", "=", "\"", "52", ",", "49", ",", "53", ",", "183", "\"", "/", ">", "<", "scope", "id", "=", "\"", "802768723527124727", "\"", "at", "=", "\"", "57", ",", "42", ",", "58", ",", "16", "\"", "/", ">", "<", "scope", "id", "=", "\"", "802768723527124727", "\"", "at", "=", "\"", "57", ",", "42", ",", "58", ",", "17", "\"", "/", ">", "<", "scope", "id", "=", "\"", "64850105743259916", "\"", "at", "=", "\"", "61", ",", "38", ",", "62", ",", "76", "\"", "/", ">", "<", "scope", "id", "=", "\"", "2239364956432074669", "\"", "at", "=", "\"", "42", ",", "0", ",", "45", ",", "9", "\"", ">", "<", "var", "name", "=", "\"", "e", "\"", "id", "=", "\"", "2239364956432074670", "\"", "/", ">", "@", "@", "-", "15", ",", "6", "+", "15", ",", "7", "@", "@", "*", "/", "package", "jetbrains", ".", "mps", ".", "plugin", ";", "import", "com", ".", "intellij", ".", "execution", ".", "rmi", ".", "RemoteServer", ";", "import", "com", ".", "intellij", ".", "openapi", ".", "application", ".", "ApplicationManager", ";", "import", "com", ".", "intellij", ".", "openapi", ".", "components", ".", "ApplicationComponent", ";", "import", "org", ".", "jetbrains", ".", "annotations", ".", "NotNull", ";", "@", "@", "-", "24", ",", "6", "+", "25", ",", "9", "@", "@", "public", "class", "IDEAHandler", "extends", "UnicastRemoteObject", "implements", "ApplicationComponent", ",", "IIDEAHandler", "{", "static", "{", "/", "/", "has", "to", "be", "called", "before", "instantiation", "of", "IDEAHandler", ",", "MPSPluginImpl", "and", "ProjectHandler", "to", "make", "these", "instances", "available", "only", "at", "localhost", "RemoteServer", ".", "setupRMI", "(", ");", "RMIHandler", ".", "class", ".", "getClassLoader", "(", ");", "}", "@", "@", "-", "69", ",", "6", "+", "69", ",", "7", "@", "@", "<", "import", "index", "=", "\"", "jlff", "\"", "ref", "=", "\"", "498d89d2", "-", "c2e9", "-", "11e2", "-", "ad49", "-", "6cf049e62fe5", "/", "java", ":", "com", ".", "intellij", ".", "openapi", ".", "vfs", "(", "MPS", ".", "IDEA", "/", ")\"", "/", ">", "<", "import", "index", "=", "\"", "4hrd", "\"", "ref", "=", "\"", "742f6602", "-", "5a2f", "-", "4313", "-", "aa6e", "-", "ae1cd4ffdc61", "/", "java", ":", "jetbrains", ".", "mps", ".", "ide", ".", "vfs", "(", "MPS", ".", "Platform", "/", ")\"", "/", ">", "<", "import", "index", "=", "\"", "zn9m", "\"", "ref", "=", "\"", "498d89d2", "-", "c2e9", "-", "11e2", "-", "ad49", "-", "6cf049e62fe5", "/", "java", ":", "com", ".", "intellij", ".", "openapi", ".", "util", "(", "MPS", ".", "IDEA", "/", ")\"", "/", ">", "<", "import", "index", "=", "\"", "p2by", "\"", "ref", "=", "\"", "498d89d2", "-", "c2e9", "-", "11e2", "-", "ad49", "-", "6cf049e62fe5", "/", "java", ":", "com", ".", "intellij", ".", "execution", ".", "rmi", "(", "MPS", ".", "IDEA", "/", ")\"", "/", ">", "<", "import", "index", "=", "\"", "tpcu", "\"", "ref", "=", "\"", "r", ":", "00000000", "-", "0000", "-", "4000", "-", "0000", "-", "011c89590282", "(", "jetbrains", ".", "mps", ".", "lang", ".", "core", ".", "behavior", ")", "\"", "implicit", "=", "\"", "true", "\"", "/", ">", "<", "/", "imports", ">", "<", "registry", ">", "@", "@", "-", "307", ",", "6", "+", "308", ",", "9", "@", "@", "<", "child", "id", "=", "\"", "1163668934364", "\"", "name", "=", "\"", "ifFalse", "\"", "index", "=", "\"", "3K4GZi", "\"", "/", ">", "<", "/", "concept", ">", "<", "concept", "id", "=", "\"", "1082113931046", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "baseLanguage", ".", "structure", ".", "ContinueStatement", "\"", "flags", "=", "\"", "nn", "\"", "index", "=", "\"", "3N13vt", "\"", "/", ">", "<", "concept", "id", "=", "\"", "1221737317277", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "baseLanguage", ".", "structure", ".", "StaticInitializer", "\"", "flags", "=", "\"", "lg", "\"", "index", "=", "\"", "1Pe0a1", "\"", ">", "<", "child", "id", "=", "\"", "1221737317278", "\"", "name", "=", "\"", "statementList", "\"", "index", "=", "\"", "1Pe0a2", "\"", "/", ">", "<", "/", "concept", ">", "<", "concept", "id", "=", "\"", "1208890769693", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "baseLanguage", ".", "structure", ".", "ArrayLengthOperation", "\"", "flags", "=", "\"", "nn", "\"", "index", "=", "\"", "1Rwk04", "\"", "/", ">", "<", "concept", "id", "=", "\"", "6329021646629104954", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "baseLanguage", ".", "structure", ".", "SingleLineComment", "\"", "flags", "=", "\"", "nn", "\"", "index", "=", "\"", "3SKdUt", "\"", ">", "<", "child", "id", "=", "\"", "1350122676458893092", "\"", "name", "=", "\"", "text", "\"", "index", "=", "\"", "3ndbpf", "\"", "/", ">", "@", "@", "-", "989", ",", "6", "+", "993", ",", "70", "@", "@", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3Tm6S6", "\"", "id", "=", "\"", "7vbFQ4bPX_Q", "\"", "role", "=", "\"", "1B3o_S", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "2tJIrI", "\"", "id", "=", "\"", "2nMnFSwIi6i", "\"", "role", "=", "\"", "jymVt", "\"", "/", ">", "<", "node", "concept", "=", "\"", "1Pe0a1", "\"", "id", "=", "\"", "2nMnFSwInjy", "\"", "role", "=", "\"", "jymVt", "\"", ">", "<", "node", "concept", "=", "\"", "3clFbS", "\"", "id", "=", "\"", "2nMnFSwInj", "$", "\"", "role", "=", "\"", "1Pe0a2", "\"", ">", "<", "node", "concept", "=", "\"", "3SKdUt", "\"", "id", "=", "\"", "2nMnFSwIqI6", "\"", "role", "=", "\"", "3cqZAp", "\"", ">", "<", "node", "concept", "=", "\"", "1PaTwC", "\"", "id", "=", "\"", "2nMnFSwIqOC", "\"", "role", "=", "\"", "3ndbpf", "\"", ">", "<", "node", "concept", "=", "\"", "3oM_SD", "\"", "id", "=", "\"", "2nMnFSwIqI9", "\"", "role", "=", "\"", "1PaTwD", "\"", ">", "<", "property", "role", "=", "\"", "3oM_SC", "\"", "value", "=", "\"", "has", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3oM_SD", "\"", "id", "=", "\"", "2nMnFSwIqMh", "\"", "role", "=", "\"", "1PaTwD", "\"", ">", "<", "property", "role", "=", "\"", "3oM_SC", "\"", "value", "=", "\"", "to", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3oM_SD", "\"", "id", "=", "\"", "2nMnFSwIqMk", "\"", "role", "=", "\"", "1PaTwD", "\"", ">", "<", "property", "role", "=", "\"", "3oM_SC", "\"", "value", "=", "\"", "be", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3oM_SD", "\"", "id", "=", "\"", "2nMnFSwIqMo", "\"", "role", "=", "\"", "1PaTwD", "\"", ">", "<", "property", "role", "=", "\"", "3oM_SC", "\"", "value", "=", "\"", "called", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3oM_SD", "\"", "id", "=", "\"", "2nMnFSwIqMt", "\"", "role", "=", "\"", "1PaTwD", "\"", ">", "<", "property", "role", "=", "\"", "3oM_SC", "\"", "value", "=", "\"", "before", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3oM_SD", "\"", "id", "=", "\"", "2nMnFSwIqMz", "\"", "role", "=", "\"", "1PaTwD", "\"", ">", "<", "property", "role", "=", "\"", "3oM_SC", "\"", "value", "=", "\"", "instantiation", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3oM_SD", "\"", "id", "=", "\"", "2nMnFSwIqME", "\"", "role", "=", "\"", "1PaTwD", "\"", ">", "<", "property", "role", "=", "\"", "3oM_SC", "\"", "value", "=", "\"", "of", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3oM_SD", "\"", "id", "=", "\"", "2nMnFSwIqMM", "\"", "role", "=", "\"", "1PaTwD", "\"", ">", "<", "property", "role", "=", "\"", "3oM_SC", "\"", "value", "=", "\"", "MPSProjectIDEHandler", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3oM_SD", "\"", "id", "=", "\"", "2nMnFSwIqMV", "\"", "role", "=", "\"", "1PaTwD", "\"", ">", "<", "property", "role", "=", "\"", "3oM_SC", "\"", "value", "=", "\"", "to", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3oM_SD", "\"", "id", "=", "\"", "2nMnFSwIqN5", "\"", "role", "=", "\"", "1PaTwD", "\"", ">", "<", "property", "role", "=", "\"", "3oM_SC", "\"", "value", "=", "\"", "make", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3oM_SD", "\"", "id", "=", "\"", "2nMnFSwIqNg", "\"", "role", "=", "\"", "1PaTwD", "\"", ">", "<", "property", "role", "=", "\"", "3oM_SC", "\"", "value", "=", "\"", "the", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3oM_SD", "\"", "id", "=", "\"", "2nMnFSwIqNs", "\"", "role", "=", "\"", "1PaTwD", "\"", ">", "<", "property", "role", "=", "\"", "3oM_SC", "\"", "value", "=", "\"", "instance", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3oM_SD", "\"", "id", "=", "\"", "2nMnFSwIqND", "\"", "role", "=", "\"", "1PaTwD", "\"", ">", "<", "property", "role", "=", "\"", "3oM_SC", "\"", "value", "=", "\"", "available", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3oM_SD", "\"", "id", "=", "\"", "2nMnFSwIqNR", "\"", "role", "=", "\"", "1PaTwD", "\"", ">", "<", "property", "role", "=", "\"", "3oM_SC", "\"", "value", "=", "\"", "only", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3oM_SD", "\"", "id", "=", "\"", "2nMnFSwIqO6", "\"", "role", "=", "\"", "1PaTwD", "\"", ">", "<", "property", "role", "=", "\"", "3oM_SC", "\"", "value", "=", "\"", "at", "\"", "/", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3oM_SD", "\"", "id", "=", "\"", "2nMnFSwIqOW", "\"", "role", "=", "\"", "1PaTwD", "\"", ">", "<", "property", "role", "=", "\"", "3oM_SC", "\"", "value", "=", "\"", "localhost", "\"", "/", ">", "<", "/", "node", ">", "<", "/", "node", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "3clFbF", "\"", "id", "=", "\"", "2nMnFSwItms", "\"", "role", "=", "\"", "3cqZAp", "\"", ">", "<", "node", "concept", "=", "\"", "2YIFZM", "\"", "id", "=", "\"", "2nMnFSwItn0", "\"", "role", "=", "\"", "3clFbG", "\"", ">", "<", "ref", "role", "=", "\"", "37wK5l", "\"", "to", "=", "\"", "p2by", ":", "~", "RemoteServer", ".", "setupRMI", "(", ")\"", "resolve", "=", "\"", "setupRMI", "\"", "/", ">", "<", "ref", "role", "=", "\"", "1Pybhc", "\"", "to", "=", "\"", "p2by", ":", "~", "RemoteServer", "\"", "resolve", "=", "\"", "RemoteServer", "\"", "/", ">", "<", "/", "node", ">", "<", "/", "node", ">", "<", "/", "node", ">", "<", "/", "node", ">", "<", "node", "concept", "=", "\"", "2tJIrI", "\"", "id", "=", "\"", "2nMnFSwIlnk", "\"", "role", "=", "\"", "jymVt", "\"", "/", ">", "<", "node", "concept", "=", "\"", "3clFbW", "\"", "id", "=", "\"", "7vbFQ4bPX_R", "\"", "role", "=", "\"", "jymVt", "\"", ">", "<", "node", "concept", "=", "\"", "3Tm1VV", "\"", "id", "=", "\"", "7vbFQ4bPX_S", "\"", "role", "=", "\"", "1B3o_S", "\"", "/", ">", "<", "node", "concept", "=", "\"", "3cqZAl", "\"", "id", "=", "\"", "7vbFQ4bPX_T", "\"", "role", "=", "\"", "3clF45", "\"", "/", ">", "@", "@", "-", "115", ",", "6", "+", "115", ",", "7", "@", "@", "<", "classNode", "dependClassName", "=", "\"", "org", ".", "apache", ".", "log4j", ".", "LogManager", "\"", "/", ">", "<", "/", "dependency", ">", "<", "dependency", "className", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "\"", ">", "<", "classNode", "dependClassName", "=", "\"", "com", ".", "intellij", ".", "execution", ".", "rmi", ".", "RemoteServer", "\"", "/", ">", "<", "classNode", "dependClassName", "=", "\"", "com", ".", "intellij", ".", "ide", ".", "impl", ".", "ProjectUtil", "\"", "/", ">", "<", "classNode", "dependClassName", "=", "\"", "com", ".", "intellij", ".", "openapi", ".", "project", ".", "Project", "\"", "/", ">", "<", "classNode", "dependClassName", "=", "\"", "com", ".", "intellij", ".", "openapi", ".", "ui", ".", "MessageType", "\"", "/", ">", "@", "@", "-", "1", ",", "5", "+", "1", ",", "5", "@", "@", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "?>", "<", "product", "version", "=", "\"", "3", "\"", "modelHash", "=", "\"", "1obnyn4yzivkhnbn7wmazkin2pj7wa4", "\"", ">", "<", "product", "version", "=", "\"", "3", "\"", "modelHash", "=", "\"", "6kei0wcle3cwn7y2s5t7sgfq79iv4vy", "\"", ">", "<", "files", "names", "=", "\"", "DefaultGoToDeclarationHandler", ".", "java", ":", "IdeaCodeNavigationProvider", ".", "java", ":", "IdeaGoToDeclarationInitializer", ".", "java", ":", "IdeaJavaCompilerImpl", ".", "java", ":", "InstallIDEAPlugin_Action", ".", "java", ":", "MPSPlugin", ".", "java", ":", "MPSProjectIDEHandler", ".", "java", ":", "PluginStateMonitor", ".", "java", ":", "PluginStateWidget", ".", "java", "\"", "/", ">", "<", "/", "product", ">", "@", "@", "-", "7", ",", "6", "+", "7", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "log4j", ".", "Logger", ";", "import", "org", ".", "apache", ".", "log4j", ".", "LogManager", ";", "import", "com", ".", "intellij", ".", "openapi", ".", "project", ".", "Project", ";", "import", "com", ".", "intellij", ".", "execution", ".", "rmi", ".", "RemoteServer", ";", "import", "java", ".", "rmi", ".", "RemoteException", ";", "import", "jetbrains", ".", "mps", ".", "RuntimeFlags", ";", "import", "java", ".", "rmi", ".", "NoSuchObjectException", ";", "@", "@", "-", "72", ",", "6", "+", "73", ",", "12", "@", "@", "private", "static", "final", "Logger", "LOG_1373119566", "=", "LogManager", ".", "getLogger", "(", "MPSProjectIDEHandler", ".", "class", ")", ";", "private", "static", "final", "Logger", "LOG", "=", "LogManager", ".", "getLogger", "(", "MPSProjectIDEHandler", ".", "class", ")", ";", "private", "Project", "myProject", ";", "static", "{", "/", "/", "has", "to", "be", "called", "before", "instantiation", "of", "MPSProjectIDEHandler", "to", "make", "the", "instance", "available", "only", "at", "localhost", "RemoteServer", ".", "setupRMI", "(", ");", "}", "public", "MPSProjectIDEHandler", "(", "Project", "project", ")", "throws", "RemoteException", "{", "myProject", "=", "project", ";", "}", "@", "@", "-", "141", ",", "11", "+", "148", ",", "11", "@", "@", "public", "void", "run", "(", ")", "{", "List", "<", "SModel", ">", "modelsByName", "=", "ListSequence", ".", "fromList", "(", "new", "ArrayList", "<", "SModel", ">", "()", ");", "{", "SearchScope", "scope_xnj2f8_e0a0a1a8", "=", "CommandUtil", ".", "createScope", "(", "mpsProject", ")", ";", "final", "SearchScope", "scope_xnj2f8_e0a0a1a8_0", "=", "new", "EditableFilteringScope", "(", "scope_xnj2f8_e0a0a1a8", ")", ";", "SearchScope", "scope_xnj2f8_e0a0a1a11", "=", "CommandUtil", ".", "createScope", "(", "mpsProject", ")", ";", "final", "SearchScope", "scope_xnj2f8_e0a0a1a11_0", "=", "new", "EditableFilteringScope", "(", "scope_xnj2f8_e0a0a1a11", ")", ";", "QueryExecutionContext", "context", "=", "new", "QueryExecutionContext", "(", ")", "{", "public", "SearchScope", "getDefaultSearchScope", "(", ")", "{", "return", "scope_xnj2f8_e0a0a1a8_0", ";", "return", "scope_xnj2f8_e0a0a1a11_0", ";", "}", "}", ";", "/", "/", "we", "first", "look", "up", "in", "models", "with", "the", "given", "name", "(", "better", "chance", "to", "succeed", ")", ",", "then", "in", "all", "other", "models", "@", "@", "-", "675", ",", "422", "+", "675", ",", "425", "@", "@", "<", "/", "root", ">", "<", "root", "nodeRef", "=", "\"", "r", ":", "20925211", "-", "384c", "-", "4c5f", "-", "b751", "-", "56b79dd3b32e", "(", "jetbrains", ".", "mps", ".", "plugin", ")", "/", "8632185942131071134", "\"", ">", "<", "file", "name", "=", "\"", "MPSProjectIDEHandler", ".", "java", "\"", ">", "<", "node", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "72", ",", "0", ",", "73", ",", "0", "\"", "concept", "=", "\"", "14", "\"", "trace", "=", "\"", "LOG_1373119566", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071343", "\"", "at", "=", "\"", "73", ",", "0", ",", "74", ",", "0", "\"", "concept", "=", "\"", "14", "\"", "trace", "=", "\"", "LOG", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071348", "\"", "at", "=", "\"", "74", ",", "0", ",", "75", ",", "0", "\"", "concept", "=", "\"", "6", "\"", "trace", "=", "\"", "myProject", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071357", "\"", "at", "=", "\"", "75", ",", "71", ",", "76", ",", "24", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071371", "\"", "at", "=", "\"", "80", ",", "36", ",", "81", ",", "13", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071570", "\"", "at", "=", "\"", "86", ",", "13", ",", "87", ",", "103", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071582", "\"", "at", "=", "\"", "88", ",", "32", ",", "89", ",", "19", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071583", "\"", "at", "=", "\"", "90", ",", "11", ",", "91", ",", "59", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071563", "\"", "at", "=", "\"", "92", ",", "37", ",", "93", ",", "30", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071390", "\"", "at", "=", "\"", "100", ",", "36", ",", "101", ",", "13", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071589", "\"", "at", "=", "\"", "105", ",", "25", ",", "106", ",", "101", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071612", "\"", "at", "=", "\"", "108", ",", "15", ",", "109", ",", "64", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071604", "\"", "at", "=", "\"", "110", ",", "39", ",", "111", ",", "52", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071627", "\"", "at", "=", "\"", "114", ",", "13", ",", "115", ",", "78", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071620", "\"", "at", "=", "\"", "116", ",", "43", ",", "117", ",", "40", "\"", "concept", "=", "\"", "17", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071404", "\"", "at", "=", "\"", "125", ",", "36", ",", "126", ",", "37", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488320770", "\"", "at", "=", "\"", "135", ",", "124", ",", "136", ",", "94", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889284065", "\"", "at", "=", "\"", "138", ",", "25", ",", "139", ",", "55", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889301374", "\"", "at", "=", "\"", "139", ",", "55", ",", "140", ",", "0", "\"", "concept", "=", "\"", "13", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488278450", "\"", "at", "=", "\"", "140", ",", "0", ",", "141", ",", "83", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889496311", "\"", "at", "=", "\"", "141", ",", "83", ",", "142", ",", "0", "\"", "concept", "=", "\"", "13", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "143", ",", "9", ",", "144", ",", "82", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "144", ",", "82", ",", "145", ",", "104", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "147", ",", "56", ",", "148", ",", "45", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889520884", "\"", "at", "=", "\"", "150", ",", "12", ",", "151", ",", "113", "\"", "concept", "=", "\"", "12", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488278457", "\"", "at", "=", "\"", "153", ",", "46", ",", "154", ",", "82", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889514820", "\"", "at", "=", "\"", "158", ",", "46", ",", "159", ",", "85", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488577257", "\"", "at", "=", "\"", "162", ",", "9", ",", "163", ",", "0", "\"", "concept", "=", "\"", "13", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816487899827", "\"", "at", "=", "\"", "163", ",", "0", ",", "164", ",", "30", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816487899820", "\"", "at", "=", "\"", "165", ",", "66", ",", "166", ",", "61", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8389443510893291159", "\"", "at", "=", "\"", "168", ",", "58", ",", "169", ",", "108", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8389443510893287888", "\"", "at", "=", "\"", "170", ",", "13", ",", "171", ",", "21", "\"", "concept", "=", "\"", "4", "\"", "/", ">", "<", "node", "id", "=", "\"", "822599051486384987", "\"", "at", "=", "\"", "172", ",", "11", ",", "173", ",", "126", "\"", "concept", "=", "\"", "12", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816490759614", "\"", "at", "=", "\"", "173", ",", "126", ",", "174", ",", "75", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488593712", "\"", "at", "=", "\"", "174", ",", "75", ",", "175", ",", "60", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488618510", "\"", "at", "=", "\"", "176", ",", "33", ",", "177", ",", "18", "\"", "concept", "=", "\"", "2", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488629033", "\"", "at", "=", "\"", "179", ",", "9", ",", "180", ",", "0", "\"", "concept", "=", "\"", "13", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889116858", "\"", "at", "=", "\"", "181", ",", "33", ",", "182", ",", "87", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889116871", "\"", "at", "=", "\"", "183", ",", "33", ",", "184", ",", "74", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889116876", "\"", "at", "=", "\"", "184", ",", "74", ",", "185", ",", "127", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "7690266557989444429", "\"", "at", "=", "\"", "187", ",", "16", ",", "188", ",", "105", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "1896585687540983104", "\"", "at", "=", "\"", "189", ",", "9", ",", "190", ",", "56", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975073798", "\"", "at", "=", "\"", "196", ",", "116", ",", "197", ",", "152", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488887879", "\"", "at", "=", "\"", "197", ",", "152", ",", "198", ",", "57", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489830988", "\"", "at", "=", "\"", "200", ",", "47", ",", "201", ",", "52", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489984626", "\"", "at", "=", "\"", "203", ",", "9", ",", "204", ",", "72", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "822599051486238786", "\"", "at", "=", "\"", "204", ",", "72", ",", "205", ",", "80", "\"", "concept", "=", "\"", "12", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317974867144", "\"", "at", "=", "\"", "207", ",", "57", ",", "208", ",", "45", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489302047", "\"", "at", "=", "\"", "211", ",", "57", ",", "212", ",", "35", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489302057", "\"", "at", "=", "\"", "215", ",", "57", ",", "216", ",", "43", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "822599051486250162", "\"", "at", "=", "\"", "219", ",", "25", ",", "220", ",", "78", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816490615991", "\"", "at", "=", "\"", "223", ",", "57", ",", "224", ",", "36", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975250220", "\"", "at", "=", "\"", "225", ",", "5", ",", "226", ",", "0", "\"", "concept", "=", "\"", "13", "\"", "/", ">", "<", "node", "id", "=", "\"", "822599051486267111", "\"", "at", "=", "\"", "226", ",", "0", ",", "227", ",", "84", "\"", "concept", "=", "\"", "12", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975368321", "\"", "at", "=", "\"", "229", ",", "76", ",", "230", ",", "36", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975368331", "\"", "at", "=", "\"", "233", ",", "76", ",", "234", ",", "44", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975353371", "\"", "at", "=", "\"", "236", ",", "7", ",", "237", ",", "0", "\"", "concept", "=", "\"", "13", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489250842", "\"", "at", "=", "\"", "237", ",", "0", ",", "238", ",", "153", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "5542552559869470180", "\"", "at", "=", "\"", "242", ",", "88", ",", "243", ",", "94", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "7690266557990045527", "\"", "at", "=", "\"", "243", ",", "94", ",", "244", ",", "76", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1071422968910417126", "\"", "at", "=", "\"", "248", ",", "69", ",", "249", ",", "21", "\"", "concept", "=", "\"", "4", "\"", "/", ">", "<", "node", "id", "=", "\"", "1071422968910417137", "\"", "at", "=", "\"", "250", ",", "11", ",", "251", ",", "50", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "7690266557990180925", "\"", "at", "=", "\"", "252", ",", "29", ",", "253", ",", "103", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "1896585687540980171", "\"", "at", "=", "\"", "255", ",", "9", ",", "256", ",", "56", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "7690266557991803384", "\"", "at", "=", "\"", "261", ",", "104", ",", "262", ",", "98", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071450", "\"", "at", "=", "\"", "262", ",", "98", ",", "263", ",", "115", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "5542552559868791017", "\"", "at", "=", "\"", "263", ",", "115", ",", "264", ",", "159", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "5542552559869784771", "\"", "at", "=", "\"", "264", ",", "159", ",", "265", ",", "124", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "5542552559869817182", "\"", "at", "=", "\"", "268", ",", "75", ",", "269", ",", "94", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "7690266557991564951", "\"", "at", "=", "\"", "272", ",", "25", ",", "273", ",", "72", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071748", "\"", "at", "=", "\"", "273", ",", "72", ",", "274", ",", "51", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071760", "\"", "at", "=", "\"", "275", ",", "26", ",", "276", ",", "73", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071767", "\"", "at", "=", "\"", "276", ",", "73", ",", "277", ",", "17", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "1896585687540977451", "\"", "at", "=", "\"", "278", ",", "9", ",", "279", ",", "56", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071771", "\"", "at", "=", "\"", "279", ",", "56", ",", "280", ",", "115", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "5542552559869822423", "\"", "at", "=", "\"", "285", ",", "132", ",", "286", ",", "94", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "2976809348477198820", "\"", "at", "=", "\"", "290", ",", "56", ",", "291", ",", "98", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "2976809348477198831", "\"", "at", "=", "\"", "291", ",", "98", ",", "292", ",", "17", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "2976809348477198800", "\"", "at", "=", "\"", "292", ",", "17", ",", "293", ",", "0", "\"", "concept", "=", "\"", "13", "\"", "/", ">", "<", "node", "id", "=", "\"", "7690266557991113160", "\"", "at", "=", "\"", "294", ",", "9", ",", "295", ",", "72", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071780", "\"", "at", "=", "\"", "295", ",", "72", ",", "296", ",", "56", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071792", "\"", "at", "=", "\"", "297", ",", "26", ",", "298", ",", "78", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071799", "\"", "at", "=", "\"", "298", ",", "78", ",", "299", ",", "17", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "9184997660524409575", "\"", "at", "=", "\"", "300", ",", "9", ",", "301", ",", "132", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "9184997660524409615", "\"", "at", "=", "\"", "303", ",", "43", ",", "304", ",", "195", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071836", "\"", "at", "=", "\"", "307", ",", "29", ",", "308", ",", "98", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071847", "\"", "at", "=", "\"", "308", ",", "98", ",", "309", ",", "17", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "1896585687540936092", "\"", "at", "=", "\"", "310", ",", "9", ",", "311", ",", "56", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "9184997660524409832", "\"", "at", "=", "\"", "311", ",", "56", ",", "312", ",", "189", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071919", "\"", "at", "=", "\"", "312", ",", "189", ",", "313", ",", "44", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "5542552559869832083", "\"", "at", "=", "\"", "317", ",", "111", ",", "318", ",", "156", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "5542552559869832680", "\"", "at", "=", "\"", "318", ",", "156", ",", "319", ",", "86", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109660537", "\"", "at", "=", "\"", "321", ",", "79", ",", "322", ",", "111", "\"", "concept", "=", "\"", "12", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109947282", "\"", "at", "=", "\"", "322", ",", "111", ",", "323", ",", "49", "\"", "concept", "=", "\"", "12", "\"", "/", ">", "<", "node", "id", "=", "\"", "1238267575188", "\"", "at", "=", "\"", "323", ",", "49", ",", "324", ",", "67", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1238267599634", "\"", "at", "=", "\"", "324", ",", "67", ",", "325", ",", "62", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109808191", "\"", "at", "=", "\"", "327", ",", "59", ",", "328", ",", "17", "\"", "concept", "=", "\"", "4", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109849257", "\"", "at", "=", "\"", "329", ",", "7", ",", "330", ",", "23", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109911534", "\"", "at", "=", "\"", "332", ",", "80", ",", "333", ",", "22", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109925233", "\"", "at", "=", "\"", "336", ",", "5", ",", "337", ",", "16", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "341", ",", "0", ",", "342", ",", "0", "\"", "concept", "=", "\"", "14", "\"", "trace", "=", "\"", "BaseMethodDeclaration", "$", "RR", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "342", ",", "0", ",", "343", ",", "0", "\"", "concept", "=", "\"", "14", "\"", "trace", "=", "\"", "Classifier", "$", "hJ", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "346", ",", "0", ",", "347", ",", "0", "\"", "concept", "=", "\"", "14", "\"", "trace", "=", "\"", "name", "$", "tAp1", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "350", ",", "0", ",", "351", ",", "0", "\"", "concept", "=", "\"", "14", "\"", "trace", "=", "\"", "parameter", "$", "WIkZ", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488662073", "\"", "at", "=", "\"", "187", ",", "14", ",", "189", ",", "9", "\"", "concept", "=", "\"", "1", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071351", "\"", "at", "=", "\"", "75", ",", "0", ",", "78", ",", "0", "\"", "concept", "=", "\"", "3", "\"", "trace", "=", "\"", "MPSProjectIDEHandler", "#", "(", "Lcom", "/", "intellij", "/", "openapi", "/", "project", "/", "Project", ";", ")", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071366", "\"", "at", "=", "\"", "79", ",", "31", ",", "82", ",", "5", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071577", "\"", "at", "=", "\"", "87", ",", "103", ",", "90", ",", "11", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071385", "\"", "at", "=", "\"", "99", ",", "31", ",", "102", ",", "5", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071408", "\"", "at", "=", "\"", "128", ",", "0", ",", "131", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "initComponent", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071412", "\"", "at", "=", "\"", "131", ",", "0", ",", "134", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "disposeComponent", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "147", ",", "0", ",", "150", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "getDefaultSearchScope", "#", "()", "Lorg", "/", "jetbrains", "/", "mps", "/", "openapi", "/", "module", "/", "SearchScope", ";", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488278455", "\"", "at", "=", "\"", "153", ",", "0", ",", "156", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "accept", "#", "(", "Lorg", "/", "jetbrains", "/", "mps", "/", "openapi", "/", "model", "/", "SModel", ";", ")", "Z", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889514818", "\"", "at", "=", "\"", "158", ",", "0", ",", "161", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "accept", "#", "(", "Lorg", "/", "jetbrains", "/", "mps", "/", "openapi", "/", "model", "/", "SModel", ";", ")", "Z", "\"", "/", ">", "<", "node", "id", "=", "\"", "8389443510893291159", "\"", "at", "=", "\"", "167", ",", "27", ",", "170", ",", "13", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488434697", "\"", "at", "=", "\"", "175", ",", "60", ",", "178", ",", "11", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489830986", "\"", "at", "=", "\"", "200", ",", "0", ",", "203", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "accept", "#", "(", "Ljetbrains", "/", "mps", "/", "textgen", "/", "trace", "/", "DebugInfoRoot", ";", ")", "Z", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317974853303", "\"", "at", "=", "\"", "207", ",", "0", ",", "210", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "accept", "#", "(", "Ljetbrains", "/", "mps", "/", "textgen", "/", "trace", "/", "TraceablePositionInfo", ";", ")", "Z", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489302045", "\"", "at", "=", "\"", "211", ",", "0", ",", "214", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "select", "#", "(", "Ljetbrains", "/", "mps", "/", "textgen", "/", "trace", "/", "TraceablePositionInfo", ";", ")", "Ljava", "/", "lang", "/", "Integer", ";", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489302055", "\"", "at", "=", "\"", "215", ",", "0", ",", "218", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "accept", "#", "(", "Ljetbrains", "/", "mps", "/", "textgen", "/", "trace", "/", "TraceablePositionInfo", ";", ")", "Z", "\"", "/", ">", "<", "node", "id", "=", "\"", "720398003261311501", "\"", "at", "=", "\"", "218", ",", "9", ",", "221", ",", "7", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975170470", "\"", "at", "=", "\"", "222", ",", "5", ",", "225", ",", "5", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975368319", "\"", "at", "=", "\"", "229", ",", "0", ",", "232", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "select", "#", "(", "Ljetbrains", "/", "mps", "/", "util", "/", "Pair", ";", ")", "Ljava", "/", "lang", "/", "Integer", ";", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975368329", "\"", "at", "=", "\"", "233", ",", "0", ",", "236", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "accept", "#", "(", "Ljetbrains", "/", "mps", "/", "util", "/", "Pair", ";", ")", "Z", "\"", "/", ">", "<", "node", "id", "=", "\"", "1071422968910417115", "\"", "at", "=", "\"", "247", ",", "89", ",", "250", ",", "11", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "1071422968910417146", "\"", "at", "=", "\"", "251", ",", "50", ",", "254", ",", "11", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "9184997660524409611", "\"", "at", "=", "\"", "303", ",", "0", ",", "306", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "accept", "#", "(", "Lorg", "/", "jetbrains", "/", "mps", "/", "openapi", "/", "model", "/", "SNode", ";", ")", "Z", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109723047", "\"", "at", "=", "\"", "326", ",", "63", ",", "329", ",", "7", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109852715", "\"", "at", "=", "\"", "331", ",", "103", ",", "334", ",", "9", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889116864", "\"", "at", "=", "\"", "182", ",", "87", ",", "186", ",", "11", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071755", "\"", "at", "=", "\"", "274", ",", "51", ",", "278", ",", "9", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071787", "\"", "at", "=", "\"", "296", ",", "56", ",", "300", ",", "9", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071831", "\"", "at", "=", "\"", "306", ",", "11", ",", "310", ",", "9", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071539", "\"", "at", "=", "\"", "317", ",", "0", ",", "321", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "findUsages", "#", "(", "Lorg", "/", "jetbrains", "/", "mps", "/", "openapi", "/", "model", "/", "SNode", ";", "Lorg", "/", "jetbrains", "/", "mps", "/", "openapi", "/", "module", "/", "SearchScope", ";", "Ljetbrains", "/", "mps", "/", "ide", "/", "findusages", "/", "model", "/", "IResultProvider", ";", ")", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071601", "\"", "at", "=", "\"", "107", ",", "30", ",", "112", ",", "11", "\"", "concept", "=", "\"", "18", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071617", "\"", "at", "=", "\"", "113", ",", "9", ",", "118", ",", "9", "\"", "concept", "=", "\"", "18", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "145", ",", "104", ",", "150", ",", "12", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889502177", "\"", "at", "=", "\"", "151", ",", "113", ",", "156", ",", "14", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889514811", "\"", "at", "=", "\"", "156", ",", "14", ",", "161", ",", "14", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "2976809348477198798", "\"", "at", "=", "\"", "289", ",", "25", ",", "294", ",", "9", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071800", "\"", "at", "=", "\"", "301", ",", "132", ",", "306", ",", "11", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109825838", "\"", "at", "=", "\"", "330", ",", "23", ",", "335", ",", "7", "\"", "concept", "=", "\"", "7", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071400", "\"", "at", "=", "\"", "122", ",", "0", ",", "128", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "getComponentName", "#", "()", "Ljava", "/", "lang", "/", "String", ";", "\"", "/", ">", "<", "node", "id", "=", "\"", "8389443510893206000", "\"", "at", "=", "\"", "166", ",", "61", ",", "172", ",", "11", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071596", "\"", "at", "=", "\"", "106", ",", "101", ",", "113", ",", "9", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071442", "\"", "at", "=", "\"", "260", ",", "0", ",", "267", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "showAspectMethodUsages", "#", "(", "Ljava", "/", "lang", "/", "String", ";", "Ljava", "/", "lang", "/", "String", ";", ")", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071560", "\"", "at", "=", "\"", "85", ",", "25", ",", "94", ",", "9", "\"", "concept", "=", "\"", "18", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488637142", "\"", "at", "=", "\"", "180", ",", "0", ",", "189", ",", "9", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975368313", "\"", "at", "=", "\"", "227", ",", "84", ",", "236", ",", "7", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1071422968910417108", "\"", "at", "=", "\"", "246", ",", "25", ",", "255", ",", "9", "\"", "concept", "=", "\"", "7", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071514", "\"", "at", "=", "\"", "271", ",", "0", ",", "282", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "run", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109720111", "\"", "at", "=", "\"", "325", ",", "62", ",", "336", ",", "5", "\"", "concept", "=", "\"", "7", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071377", "\"", "at", "=", "\"", "84", ",", "0", ",", "96", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "run", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "1071422968910417106", "\"", "at", "=", "\"", "246", ",", "0", ",", "258", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "run", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489302004", "\"", "at", "=", "\"", "205", ",", "80", ",", "218", ",", "9", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071507", "\"", "at", "=", "\"", "269", ",", "94", ",", "282", ",", "7", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071372", "\"", "at", "=", "\"", "82", ",", "5", ",", "96", ",", "14", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "1071422968910417098", "\"", "at", "=", "\"", "244", ",", "76", ",", "258", ",", "7", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488299471", "\"", "at", "=", "\"", "164", ",", "30", ",", "179", ",", "9", "\"", "concept", "=", "\"", "7", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071396", "\"", "at", "=", "\"", "104", ",", "0", ",", "120", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "run", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071501", "\"", "at", "=", "\"", "267", ",", "0", ",", "284", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "showClassUsages", "#", "(", "Ljava", "/", "lang", "/", "String", ";", ")", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071391", "\"", "at", "=", "\"", "102", ",", "5", ",", "120", ",", "14", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "7690266557991251440", "\"", "at", "=", "\"", "321", ",", "0", ",", "339", ",", "0", "\"", "concept", "=", "\"", "15", "\"", "trace", "=", "\"", "findClassByName", "#", "(", "Lorg", "/", "jetbrains", "/", "mps", "/", "openapi", "/", "module", "/", "SearchScope", ";", "Ljava", "/", "lang", "/", "String", ";", ")", "Lorg", "/", "jetbrains", "/", "mps", "/", "openapi", "/", "model", "/", "SNode", ";", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071425", "\"", "at", "=", "\"", "241", ",", "0", ",", "260", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "showNode", "#", "(", "Ljava", "/", "lang", "/", "String", ";", "Ljava", "/", "lang", "/", "String", ";", ")", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071362", "\"", "at", "=", "\"", "78", ",", "0", ",", "98", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "projectOpened", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "142", ",", "0", ",", "162", ",", "9", "\"", "concept", "=", "\"", "1", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071381", "\"", "at", "=", "\"", "98", ",", "0", ",", "122", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "projectClosed", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489722633", "\"", "at", "=", "\"", "198", ",", "57", ",", "222", ",", "5", "\"", "concept", "=", "\"", "7", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071535", "\"", "at", "=", "\"", "288", ",", "0", ",", "315", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "run", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071528", "\"", "at", "=", "\"", "286", ",", "94", ",", "315", ",", "7", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071518", "\"", "at", "=", "\"", "284", ",", "0", ",", "317", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "showMethodUsages", "#", "(", "Ljava", "/", "lang", "/", "String", ";", "Ljava", "/", "lang", "/", "String", ";", "I", ")", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816487899843", "\"", "at", "=", "\"", "195", ",", "0", ",", "240", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "getBestNodeForPosition", "#", "(", "Ljetbrains", "/", "mps", "/", "textgen", "/", "trace", "/", "DebugInfo", ";", "Ljava", "/", "lang", "/", "String", ";", "I", ")", "Ljetbrains", "/", "mps", "/", "smodel", "/", "SNodePointer", ";", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488320781", "\"", "at", "=", "\"", "138", ",", "0", ",", "192", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "run", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488320775", "\"", "at", "=", "\"", "136", ",", "94", ",", "192", ",", "7", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816487899798", "\"", "at", "=", "\"", "134", ",", "0", ",", "194", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "showSource", "#", "(", "Ljava", "/", "lang", "/", "String", ";", "Ljava", "/", "lang", "/", "String", ";", "II", ")", "V", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071411", "\"", "at", "=", "\"", "129", ",", "31", ",", "129", ",", "31", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071415", "\"", "at", "=", "\"", "132", ",", "34", ",", "132", ",", "34", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071356", "\"", "at", "=", "\"", "75", ",", "71", ",", "76", ",", "24", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071370", "\"", "at", "=", "\"", "80", ",", "36", ",", "81", ",", "13", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071581", "\"", "at", "=", "\"", "88", ",", "32", ",", "89", ",", "19", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071561", "\"", "at", "=", "\"", "92", ",", "0", ",", "93", ",", "30", "\"", ">", "<", "node", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "73", ",", "0", ",", "74", ",", "0", "\"", "concept", "=", "\"", "14", "\"", "trace", "=", "\"", "LOG_1373119566", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071343", "\"", "at", "=", "\"", "74", ",", "0", ",", "75", ",", "0", "\"", "concept", "=", "\"", "14", "\"", "trace", "=", "\"", "LOG", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071348", "\"", "at", "=", "\"", "75", ",", "0", ",", "76", ",", "0", "\"", "concept", "=", "\"", "6", "\"", "trace", "=", "\"", "myProject", "\"", "/", ">", "<", "node", "id", "=", "\"", "2734352094453148550", "\"", "at", "=", "\"", "77", ",", "10", ",", "78", ",", "118", "\"", "concept", "=", "\"", "12", "\"", "/", ">", "<", "node", "id", "=", "\"", "2734352094453159324", "\"", "at", "=", "\"", "78", ",", "118", ",", "79", ",", "28", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071357", "\"", "at", "=", "\"", "82", ",", "71", ",", "83", ",", "24", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071371", "\"", "at", "=", "\"", "87", ",", "36", ",", "88", ",", "13", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071570", "\"", "at", "=", "\"", "93", ",", "13", ",", "94", ",", "103", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071582", "\"", "at", "=", "\"", "95", ",", "32", ",", "96", ",", "19", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071583", "\"", "at", "=", "\"", "97", ",", "11", ",", "98", ",", "59", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071563", "\"", "at", "=", "\"", "99", ",", "37", ",", "100", ",", "30", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071390", "\"", "at", "=", "\"", "107", ",", "36", ",", "108", ",", "13", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071589", "\"", "at", "=", "\"", "112", ",", "25", ",", "113", ",", "101", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071612", "\"", "at", "=", "\"", "115", ",", "15", ",", "116", ",", "64", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071604", "\"", "at", "=", "\"", "117", ",", "39", ",", "118", ",", "52", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071627", "\"", "at", "=", "\"", "121", ",", "13", ",", "122", ",", "78", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071620", "\"", "at", "=", "\"", "123", ",", "43", ",", "124", ",", "40", "\"", "concept", "=", "\"", "17", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071404", "\"", "at", "=", "\"", "132", ",", "36", ",", "133", ",", "37", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488320770", "\"", "at", "=", "\"", "142", ",", "124", ",", "143", ",", "94", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889284065", "\"", "at", "=", "\"", "145", ",", "25", ",", "146", ",", "55", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889301374", "\"", "at", "=", "\"", "146", ",", "55", ",", "147", ",", "0", "\"", "concept", "=", "\"", "13", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488278450", "\"", "at", "=", "\"", "147", ",", "0", ",", "148", ",", "83", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889496311", "\"", "at", "=", "\"", "148", ",", "83", ",", "149", ",", "0", "\"", "concept", "=", "\"", "13", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "150", ",", "9", ",", "151", ",", "83", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "151", ",", "83", ",", "152", ",", "106", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "154", ",", "56", ",", "155", ",", "46", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889520884", "\"", "at", "=", "\"", "157", ",", "12", ",", "158", ",", "113", "\"", "concept", "=", "\"", "12", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488278457", "\"", "at", "=", "\"", "160", ",", "46", ",", "161", ",", "82", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889514820", "\"", "at", "=", "\"", "165", ",", "46", ",", "166", ",", "85", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488577257", "\"", "at", "=", "\"", "169", ",", "9", ",", "170", ",", "0", "\"", "concept", "=", "\"", "13", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816487899827", "\"", "at", "=", "\"", "170", ",", "0", ",", "171", ",", "30", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816487899820", "\"", "at", "=", "\"", "172", ",", "66", ",", "173", ",", "61", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8389443510893291159", "\"", "at", "=", "\"", "175", ",", "58", ",", "176", ",", "108", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8389443510893287888", "\"", "at", "=", "\"", "177", ",", "13", ",", "178", ",", "21", "\"", "concept", "=", "\"", "4", "\"", "/", ">", "<", "node", "id", "=", "\"", "822599051486384987", "\"", "at", "=", "\"", "179", ",", "11", ",", "180", ",", "126", "\"", "concept", "=", "\"", "12", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816490759614", "\"", "at", "=", "\"", "180", ",", "126", ",", "181", ",", "75", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488593712", "\"", "at", "=", "\"", "181", ",", "75", ",", "182", ",", "60", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488618510", "\"", "at", "=", "\"", "183", ",", "33", ",", "184", ",", "18", "\"", "concept", "=", "\"", "2", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488629033", "\"", "at", "=", "\"", "186", ",", "9", ",", "187", ",", "0", "\"", "concept", "=", "\"", "13", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889116858", "\"", "at", "=", "\"", "188", ",", "33", ",", "189", ",", "87", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889116871", "\"", "at", "=", "\"", "190", ",", "33", ",", "191", ",", "74", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889116876", "\"", "at", "=", "\"", "191", ",", "74", ",", "192", ",", "127", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "7690266557989444429", "\"", "at", "=", "\"", "194", ",", "16", ",", "195", ",", "105", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "1896585687540983104", "\"", "at", "=", "\"", "196", ",", "9", ",", "197", ",", "56", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975073798", "\"", "at", "=", "\"", "203", ",", "116", ",", "204", ",", "152", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488887879", "\"", "at", "=", "\"", "204", ",", "152", ",", "205", ",", "57", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489830988", "\"", "at", "=", "\"", "207", ",", "47", ",", "208", ",", "52", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489984626", "\"", "at", "=", "\"", "210", ",", "9", ",", "211", ",", "72", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "822599051486238786", "\"", "at", "=", "\"", "211", ",", "72", ",", "212", ",", "80", "\"", "concept", "=", "\"", "12", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317974867144", "\"", "at", "=", "\"", "214", ",", "57", ",", "215", ",", "45", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489302047", "\"", "at", "=", "\"", "218", ",", "57", ",", "219", ",", "35", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489302057", "\"", "at", "=", "\"", "222", ",", "57", ",", "223", ",", "43", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "822599051486250162", "\"", "at", "=", "\"", "226", ",", "25", ",", "227", ",", "78", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816490615991", "\"", "at", "=", "\"", "230", ",", "57", ",", "231", ",", "36", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975250220", "\"", "at", "=", "\"", "232", ",", "5", ",", "233", ",", "0", "\"", "concept", "=", "\"", "13", "\"", "/", ">", "<", "node", "id", "=", "\"", "822599051486267111", "\"", "at", "=", "\"", "233", ",", "0", ",", "234", ",", "84", "\"", "concept", "=", "\"", "12", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975368321", "\"", "at", "=", "\"", "236", ",", "76", ",", "237", ",", "36", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975368331", "\"", "at", "=", "\"", "240", ",", "76", ",", "241", ",", "44", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975353371", "\"", "at", "=", "\"", "243", ",", "7", ",", "244", ",", "0", "\"", "concept", "=", "\"", "13", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489250842", "\"", "at", "=", "\"", "244", ",", "0", ",", "245", ",", "153", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "5542552559869470180", "\"", "at", "=", "\"", "249", ",", "88", ",", "250", ",", "94", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "7690266557990045527", "\"", "at", "=", "\"", "250", ",", "94", ",", "251", ",", "76", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1071422968910417126", "\"", "at", "=", "\"", "255", ",", "69", ",", "256", ",", "21", "\"", "concept", "=", "\"", "4", "\"", "/", ">", "<", "node", "id", "=", "\"", "1071422968910417137", "\"", "at", "=", "\"", "257", ",", "11", ",", "258", ",", "50", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "7690266557990180925", "\"", "at", "=", "\"", "259", ",", "29", ",", "260", ",", "103", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "1896585687540980171", "\"", "at", "=", "\"", "262", ",", "9", ",", "263", ",", "56", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "7690266557991803384", "\"", "at", "=", "\"", "268", ",", "104", ",", "269", ",", "98", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071450", "\"", "at", "=", "\"", "269", ",", "98", ",", "270", ",", "115", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "5542552559868791017", "\"", "at", "=", "\"", "270", ",", "115", ",", "271", ",", "159", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "5542552559869784771", "\"", "at", "=", "\"", "271", ",", "159", ",", "272", ",", "124", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "5542552559869817182", "\"", "at", "=", "\"", "275", ",", "75", ",", "276", ",", "94", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "7690266557991564951", "\"", "at", "=", "\"", "279", ",", "25", ",", "280", ",", "72", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071748", "\"", "at", "=", "\"", "280", ",", "72", ",", "281", ",", "51", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071760", "\"", "at", "=", "\"", "282", ",", "26", ",", "283", ",", "73", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071767", "\"", "at", "=", "\"", "283", ",", "73", ",", "284", ",", "17", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "1896585687540977451", "\"", "at", "=", "\"", "285", ",", "9", ",", "286", ",", "56", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071771", "\"", "at", "=", "\"", "286", ",", "56", ",", "287", ",", "115", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "5542552559869822423", "\"", "at", "=", "\"", "292", ",", "132", ",", "293", ",", "94", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "2976809348477198820", "\"", "at", "=", "\"", "297", ",", "56", ",", "298", ",", "98", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "2976809348477198831", "\"", "at", "=", "\"", "298", ",", "98", ",", "299", ",", "17", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "2976809348477198800", "\"", "at", "=", "\"", "299", ",", "17", ",", "300", ",", "0", "\"", "concept", "=", "\"", "13", "\"", "/", ">", "<", "node", "id", "=", "\"", "7690266557991113160", "\"", "at", "=", "\"", "301", ",", "9", ",", "302", ",", "72", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071780", "\"", "at", "=", "\"", "302", ",", "72", ",", "303", ",", "56", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071792", "\"", "at", "=", "\"", "304", ",", "26", ",", "305", ",", "78", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071799", "\"", "at", "=", "\"", "305", ",", "78", ",", "306", ",", "17", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "9184997660524409575", "\"", "at", "=", "\"", "307", ",", "9", ",", "308", ",", "132", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "9184997660524409615", "\"", "at", "=", "\"", "310", ",", "43", ",", "311", ",", "195", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071836", "\"", "at", "=", "\"", "314", ",", "29", ",", "315", ",", "98", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071847", "\"", "at", "=", "\"", "315", ",", "98", ",", "316", ",", "17", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "1896585687540936092", "\"", "at", "=", "\"", "317", ",", "9", ",", "318", ",", "56", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "9184997660524409832", "\"", "at", "=", "\"", "318", ",", "56", ",", "319", ",", "189", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071919", "\"", "at", "=", "\"", "319", ",", "189", ",", "320", ",", "44", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "5542552559869832083", "\"", "at", "=", "\"", "324", ",", "111", ",", "325", ",", "156", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "5542552559869832680", "\"", "at", "=", "\"", "325", ",", "156", ",", "326", ",", "86", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109660537", "\"", "at", "=", "\"", "328", ",", "79", ",", "329", ",", "111", "\"", "concept", "=", "\"", "12", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109947282", "\"", "at", "=", "\"", "329", ",", "111", ",", "330", ",", "49", "\"", "concept", "=", "\"", "12", "\"", "/", ">", "<", "node", "id", "=", "\"", "1238267575188", "\"", "at", "=", "\"", "330", ",", "49", ",", "331", ",", "67", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1238267599634", "\"", "at", "=", "\"", "331", ",", "67", ",", "332", ",", "62", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109808191", "\"", "at", "=", "\"", "334", ",", "59", ",", "335", ",", "17", "\"", "concept", "=", "\"", "4", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109849257", "\"", "at", "=", "\"", "336", ",", "7", ",", "337", ",", "23", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109911534", "\"", "at", "=", "\"", "339", ",", "80", ",", "340", ",", "22", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109925233", "\"", "at", "=", "\"", "343", ",", "5", ",", "344", ",", "16", "\"", "concept", "=", "\"", "11", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "348", ",", "0", ",", "349", ",", "0", "\"", "concept", "=", "\"", "14", "\"", "trace", "=", "\"", "BaseMethodDeclaration", "$", "RR", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "349", ",", "0", ",", "350", ",", "0", "\"", "concept", "=", "\"", "14", "\"", "trace", "=", "\"", "Classifier", "$", "hJ", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "353", ",", "0", ",", "354", ",", "0", "\"", "concept", "=", "\"", "14", "\"", "trace", "=", "\"", "name", "$", "tAp1", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "357", ",", "0", ",", "358", ",", "0", "\"", "concept", "=", "\"", "14", "\"", "trace", "=", "\"", "parameter", "$", "WIkZ", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488662073", "\"", "at", "=", "\"", "194", ",", "14", ",", "196", ",", "9", "\"", "concept", "=", "\"", "1", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071351", "\"", "at", "=", "\"", "82", ",", "0", ",", "85", ",", "0", "\"", "concept", "=", "\"", "3", "\"", "trace", "=", "\"", "MPSProjectIDEHandler", "#", "(", "Lcom", "/", "intellij", "/", "openapi", "/", "project", "/", "Project", ";", ")", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071366", "\"", "at", "=", "\"", "86", ",", "31", ",", "89", ",", "5", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071577", "\"", "at", "=", "\"", "94", ",", "103", ",", "97", ",", "11", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071385", "\"", "at", "=", "\"", "106", ",", "31", ",", "109", ",", "5", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071408", "\"", "at", "=", "\"", "135", ",", "0", ",", "138", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "initComponent", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071412", "\"", "at", "=", "\"", "138", ",", "0", ",", "141", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "disposeComponent", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "154", ",", "0", ",", "157", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "getDefaultSearchScope", "#", "()", "Lorg", "/", "jetbrains", "/", "mps", "/", "openapi", "/", "module", "/", "SearchScope", ";", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488278455", "\"", "at", "=", "\"", "160", ",", "0", ",", "163", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "accept", "#", "(", "Lorg", "/", "jetbrains", "/", "mps", "/", "openapi", "/", "model", "/", "SModel", ";", ")", "Z", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889514818", "\"", "at", "=", "\"", "165", ",", "0", ",", "168", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "accept", "#", "(", "Lorg", "/", "jetbrains", "/", "mps", "/", "openapi", "/", "model", "/", "SModel", ";", ")", "Z", "\"", "/", ">", "<", "node", "id", "=", "\"", "8389443510893291159", "\"", "at", "=", "\"", "174", ",", "27", ",", "177", ",", "13", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488434697", "\"", "at", "=", "\"", "182", ",", "60", ",", "185", ",", "11", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489830986", "\"", "at", "=", "\"", "207", ",", "0", ",", "210", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "accept", "#", "(", "Ljetbrains", "/", "mps", "/", "textgen", "/", "trace", "/", "DebugInfoRoot", ";", ")", "Z", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317974853303", "\"", "at", "=", "\"", "214", ",", "0", ",", "217", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "accept", "#", "(", "Ljetbrains", "/", "mps", "/", "textgen", "/", "trace", "/", "TraceablePositionInfo", ";", ")", "Z", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489302045", "\"", "at", "=", "\"", "218", ",", "0", ",", "221", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "select", "#", "(", "Ljetbrains", "/", "mps", "/", "textgen", "/", "trace", "/", "TraceablePositionInfo", ";", ")", "Ljava", "/", "lang", "/", "Integer", ";", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489302055", "\"", "at", "=", "\"", "222", ",", "0", ",", "225", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "accept", "#", "(", "Ljetbrains", "/", "mps", "/", "textgen", "/", "trace", "/", "TraceablePositionInfo", ";", ")", "Z", "\"", "/", ">", "<", "node", "id", "=", "\"", "720398003261311501", "\"", "at", "=", "\"", "225", ",", "9", ",", "228", ",", "7", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975170470", "\"", "at", "=", "\"", "229", ",", "5", ",", "232", ",", "5", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975368319", "\"", "at", "=", "\"", "236", ",", "0", ",", "239", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "select", "#", "(", "Ljetbrains", "/", "mps", "/", "util", "/", "Pair", ";", ")", "Ljava", "/", "lang", "/", "Integer", ";", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975368329", "\"", "at", "=", "\"", "240", ",", "0", ",", "243", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "accept", "#", "(", "Ljetbrains", "/", "mps", "/", "util", "/", "Pair", ";", ")", "Z", "\"", "/", ">", "<", "node", "id", "=", "\"", "1071422968910417115", "\"", "at", "=", "\"", "254", ",", "89", ",", "257", ",", "11", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "1071422968910417146", "\"", "at", "=", "\"", "258", ",", "50", ",", "261", ",", "11", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "9184997660524409611", "\"", "at", "=", "\"", "310", ",", "0", ",", "313", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "accept", "#", "(", "Lorg", "/", "jetbrains", "/", "mps", "/", "openapi", "/", "model", "/", "SNode", ";", ")", "Z", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109723047", "\"", "at", "=", "\"", "333", ",", "63", ",", "336", ",", "7", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109852715", "\"", "at", "=", "\"", "338", ",", "103", ",", "341", ",", "9", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889116864", "\"", "at", "=", "\"", "189", ",", "87", ",", "193", ",", "11", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071755", "\"", "at", "=", "\"", "281", ",", "51", ",", "285", ",", "9", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071787", "\"", "at", "=", "\"", "303", ",", "56", ",", "307", ",", "9", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071831", "\"", "at", "=", "\"", "313", ",", "11", ",", "317", ",", "9", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071539", "\"", "at", "=", "\"", "324", ",", "0", ",", "328", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "findUsages", "#", "(", "Lorg", "/", "jetbrains", "/", "mps", "/", "openapi", "/", "model", "/", "SNode", ";", "Lorg", "/", "jetbrains", "/", "mps", "/", "openapi", "/", "module", "/", "SearchScope", ";", "Ljetbrains", "/", "mps", "/", "ide", "/", "findusages", "/", "model", "/", "IResultProvider", ";", ")", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071601", "\"", "at", "=", "\"", "114", ",", "30", ",", "119", ",", "11", "\"", "concept", "=", "\"", "18", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071617", "\"", "at", "=", "\"", "120", ",", "9", ",", "125", ",", "9", "\"", "concept", "=", "\"", "18", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "152", ",", "106", ",", "157", ",", "12", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889502177", "\"", "at", "=", "\"", "158", ",", "113", ",", "163", ",", "14", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "1423989185889514811", "\"", "at", "=", "\"", "163", ",", "14", ",", "168", ",", "14", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "2976809348477198798", "\"", "at", "=", "\"", "296", ",", "25", ",", "301", ",", "9", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071800", "\"", "at", "=", "\"", "308", ",", "132", ",", "313", ",", "11", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109825838", "\"", "at", "=", "\"", "337", ",", "23", ",", "342", ",", "7", "\"", "concept", "=", "\"", "7", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071400", "\"", "at", "=", "\"", "129", ",", "0", ",", "135", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "getComponentName", "#", "()", "Ljava", "/", "lang", "/", "String", ";", "\"", "/", ">", "<", "node", "id", "=", "\"", "8389443510893206000", "\"", "at", "=", "\"", "173", ",", "61", ",", "179", ",", "11", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071596", "\"", "at", "=", "\"", "113", ",", "101", ",", "120", ",", "9", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071442", "\"", "at", "=", "\"", "267", ",", "0", ",", "274", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "showAspectMethodUsages", "#", "(", "Ljava", "/", "lang", "/", "String", ";", "Ljava", "/", "lang", "/", "String", ";", ")", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071560", "\"", "at", "=", "\"", "92", ",", "25", ",", "101", ",", "9", "\"", "concept", "=", "\"", "18", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488637142", "\"", "at", "=", "\"", "187", ",", "0", ",", "196", ",", "9", "\"", "concept", "=", "\"", "8", "\"", "/", ">", "<", "node", "id", "=", "\"", "4015100317975368313", "\"", "at", "=", "\"", "234", ",", "84", ",", "243", ",", "7", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "1071422968910417108", "\"", "at", "=", "\"", "253", ",", "25", ",", "262", ",", "9", "\"", "concept", "=", "\"", "7", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071514", "\"", "at", "=", "\"", "278", ",", "0", ",", "289", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "run", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "3355834833109720111", "\"", "at", "=", "\"", "332", ",", "62", ",", "343", ",", "5", "\"", "concept", "=", "\"", "7", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071377", "\"", "at", "=", "\"", "91", ",", "0", ",", "103", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "run", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "1071422968910417106", "\"", "at", "=", "\"", "253", ",", "0", ",", "265", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "run", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489302004", "\"", "at", "=", "\"", "212", ",", "80", ",", "225", ",", "9", "\"", "concept", "=", "\"", "10", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071507", "\"", "at", "=", "\"", "276", ",", "94", ",", "289", ",", "7", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071372", "\"", "at", "=", "\"", "89", ",", "5", ",", "103", ",", "14", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "1071422968910417098", "\"", "at", "=", "\"", "251", ",", "76", ",", "265", ",", "7", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488299471", "\"", "at", "=", "\"", "171", ",", "30", ",", "186", ",", "9", "\"", "concept", "=", "\"", "7", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071396", "\"", "at", "=", "\"", "111", ",", "0", ",", "127", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "run", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071501", "\"", "at", "=", "\"", "274", ",", "0", ",", "291", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "showClassUsages", "#", "(", "Ljava", "/", "lang", "/", "String", ";", ")", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071391", "\"", "at", "=", "\"", "109", ",", "5", ",", "127", ",", "14", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "7690266557991251440", "\"", "at", "=", "\"", "328", ",", "0", ",", "346", ",", "0", "\"", "concept", "=", "\"", "15", "\"", "trace", "=", "\"", "findClassByName", "#", "(", "Lorg", "/", "jetbrains", "/", "mps", "/", "openapi", "/", "module", "/", "SearchScope", ";", "Ljava", "/", "lang", "/", "String", ";", ")", "Lorg", "/", "jetbrains", "/", "mps", "/", "openapi", "/", "model", "/", "SNode", ";", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071425", "\"", "at", "=", "\"", "248", ",", "0", ",", "267", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "showNode", "#", "(", "Ljava", "/", "lang", "/", "String", ";", "Ljava", "/", "lang", "/", "String", ";", ")", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071362", "\"", "at", "=", "\"", "85", ",", "0", ",", "105", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "projectOpened", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "149", ",", "0", ",", "169", ",", "9", "\"", "concept", "=", "\"", "1", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071381", "\"", "at", "=", "\"", "105", ",", "0", ",", "129", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "projectClosed", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816489722633", "\"", "at", "=", "\"", "205", ",", "57", ",", "229", ",", "5", "\"", "concept", "=", "\"", "7", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071535", "\"", "at", "=", "\"", "295", ",", "0", ",", "322", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "run", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071528", "\"", "at", "=", "\"", "293", ",", "94", ",", "322", ",", "7", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "8632185942131071518", "\"", "at", "=", "\"", "291", ",", "0", ",", "324", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "showMethodUsages", "#", "(", "Ljava", "/", "lang", "/", "String", ";", "Ljava", "/", "lang", "/", "String", ";", "I", ")", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816487899843", "\"", "at", "=", "\"", "202", ",", "0", ",", "247", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "getBestNodeForPosition", "#", "(", "Ljetbrains", "/", "mps", "/", "textgen", "/", "trace", "/", "DebugInfo", ";", "Ljava", "/", "lang", "/", "String", ";", "I", ")", "Ljetbrains", "/", "mps", "/", "smodel", "/", "SNodePointer", ";", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488320781", "\"", "at", "=", "\"", "145", ",", "0", ",", "199", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "run", "#", "()", "V", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816488320775", "\"", "at", "=", "\"", "143", ",", "94", ",", "199", ",", "7", "\"", "concept", "=", "\"", "5", "\"", "/", ">", "<", "node", "id", "=", "\"", "6173352816487899798", "\"", "at", "=", "\"", "141", ",", "0", ",", "201", ",", "0", "\"", "concept", "=", "\"", "9", "\"", "trace", "=", "\"", "showSource", "#", "(", "Ljava", "/", "lang", "/", "String", ";", "Ljava", "/", "lang", "/", "String", ";", "II", ")", "V", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071411", "\"", "at", "=", "\"", "136", ",", "31", ",", "136", ",", "31", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071415", "\"", "at", "=", "\"", "139", ",", "34", ",", "139", ",", "34", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071356", "\"", "at", "=", "\"", "82", ",", "71", ",", "83", ",", "24", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071370", "\"", "at", "=", "\"", "87", ",", "36", ",", "88", ",", "13", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071581", "\"", "at", "=", "\"", "95", ",", "32", ",", "96", ",", "19", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071561", "\"", "at", "=", "\"", "99", ",", "0", ",", "100", ",", "30", "\"", ">", "<", "var", "name", "=", "\"", "e", "\"", "id", "=", "\"", "8632185942131071567", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071562", "\"", "at", "=", "\"", "92", ",", "37", ",", "93", ",", "30", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071389", "\"", "at", "=", "\"", "100", ",", "36", ",", "101", ",", "13", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071611", "\"", "at", "=", "\"", "108", ",", "15", ",", "109", ",", "64", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071602", "\"", "at", "=", "\"", "110", ",", "0", ",", "111", ",", "52", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071562", "\"", "at", "=", "\"", "99", ",", "37", ",", "100", ",", "30", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071389", "\"", "at", "=", "\"", "107", ",", "36", ",", "108", ",", "13", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071611", "\"", "at", "=", "\"", "115", ",", "15", ",", "116", ",", "64", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071602", "\"", "at", "=", "\"", "117", ",", "0", ",", "118", ",", "52", "\"", ">", "<", "var", "name", "=", "\"", "e", "\"", "id", "=", "\"", "8632185942131071609", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071603", "\"", "at", "=", "\"", "110", ",", "39", ",", "111", ",", "52", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071626", "\"", "at", "=", "\"", "114", ",", "13", ",", "115", ",", "78", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071618", "\"", "at", "=", "\"", "116", ",", "0", ",", "117", ",", "40", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071603", "\"", "at", "=", "\"", "117", ",", "39", ",", "118", ",", "52", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071626", "\"", "at", "=", "\"", "121", ",", "13", ",", "122", ",", "78", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071618", "\"", "at", "=", "\"", "123", ",", "0", ",", "124", ",", "40", "\"", ">", "<", "var", "name", "=", "\"", "e", "\"", "id", "=", "\"", "8632185942131071624", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071619", "\"", "at", "=", "\"", "116", ",", "43", ",", "117", ",", "40", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071403", "\"", "at", "=", "\"", "125", ",", "36", ",", "126", ",", "37", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "147", ",", "56", ",", "148", ",", "45", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816488278456", "\"", "at", "=", "\"", "153", ",", "46", ",", "154", ",", "82", "\"", "/", ">", "<", "scope", "id", "=", "\"", "1423989185889514819", "\"", "at", "=", "\"", "158", ",", "46", ",", "159", ",", "85", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8389443510893291159", "\"", "at", "=", "\"", "168", ",", "58", ",", "169", ",", "108", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816488434699", "\"", "at", "=", "\"", "176", ",", "33", ",", "177", ",", "18", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816488662074", "\"", "at", "=", "\"", "187", ",", "16", ",", "188", ",", "105", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816489830987", "\"", "at", "=", "\"", "200", ",", "47", ",", "201", ",", "52", "\"", "/", ">", "<", "scope", "id", "=", "\"", "4015100317974853304", "\"", "at", "=", "\"", "207", ",", "57", ",", "208", ",", "45", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816489302046", "\"", "at", "=", "\"", "211", ",", "57", ",", "212", ",", "35", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816489302056", "\"", "at", "=", "\"", "215", ",", "57", ",", "216", ",", "43", "\"", "/", ">", "<", "scope", "id", "=", "\"", "720398003261311503", "\"", "at", "=", "\"", "219", ",", "25", ",", "220", ",", "78", "\"", "/", ">", "<", "scope", "id", "=", "\"", "4015100317975170472", "\"", "at", "=", "\"", "223", ",", "57", ",", "224", ",", "36", "\"", "/", ">", "<", "scope", "id", "=", "\"", "4015100317975368320", "\"", "at", "=", "\"", "229", ",", "76", ",", "230", ",", "36", "\"", "/", ">", "<", "scope", "id", "=", "\"", "4015100317975368330", "\"", "at", "=", "\"", "233", ",", "76", ",", "234", ",", "44", "\"", "/", ">", "<", "scope", "id", "=", "\"", "1071422968910417125", "\"", "at", "=", "\"", "248", ",", "69", ",", "249", ",", "21", "\"", "/", ">", "<", "scope", "id", "=", "\"", "1071422968910417150", "\"", "at", "=", "\"", "252", ",", "29", ",", "253", ",", "103", "\"", "/", ">", "<", "scope", "id", "=", "\"", "9184997660524409612", "\"", "at", "=", "\"", "303", ",", "43", ",", "304", ",", "195", "\"", "/", ">", "<", "scope", "id", "=", "\"", "3355834833109723048", "\"", "at", "=", "\"", "327", ",", "59", ",", "328", ",", "17", "\"", "/", ">", "<", "scope", "id", "=", "\"", "3355834833109852716", "\"", "at", "=", "\"", "332", ",", "80", ",", "333", ",", "22", "\"", "/", ">", "<", "scope", "id", "=", "\"", "1423989185889116869", "\"", "at", "=", "\"", "183", ",", "33", ",", "185", ",", "127", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071619", "\"", "at", "=", "\"", "123", ",", "43", ",", "124", ",", "40", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071403", "\"", "at", "=", "\"", "132", ",", "36", ",", "133", ",", "37", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "154", ",", "56", ",", "155", ",", "46", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816488278456", "\"", "at", "=", "\"", "160", ",", "46", ",", "161", ",", "82", "\"", "/", ">", "<", "scope", "id", "=", "\"", "1423989185889514819", "\"", "at", "=", "\"", "165", ",", "46", ",", "166", ",", "85", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8389443510893291159", "\"", "at", "=", "\"", "175", ",", "58", ",", "176", ",", "108", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816488434699", "\"", "at", "=", "\"", "183", ",", "33", ",", "184", ",", "18", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816488662074", "\"", "at", "=", "\"", "194", ",", "16", ",", "195", ",", "105", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816489830987", "\"", "at", "=", "\"", "207", ",", "47", ",", "208", ",", "52", "\"", "/", ">", "<", "scope", "id", "=", "\"", "4015100317974853304", "\"", "at", "=", "\"", "214", ",", "57", ",", "215", ",", "45", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816489302046", "\"", "at", "=", "\"", "218", ",", "57", ",", "219", ",", "35", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816489302056", "\"", "at", "=", "\"", "222", ",", "57", ",", "223", ",", "43", "\"", "/", ">", "<", "scope", "id", "=", "\"", "720398003261311503", "\"", "at", "=", "\"", "226", ",", "25", ",", "227", ",", "78", "\"", "/", ">", "<", "scope", "id", "=", "\"", "4015100317975170472", "\"", "at", "=", "\"", "230", ",", "57", ",", "231", ",", "36", "\"", "/", ">", "<", "scope", "id", "=", "\"", "4015100317975368320", "\"", "at", "=", "\"", "236", ",", "76", ",", "237", ",", "36", "\"", "/", ">", "<", "scope", "id", "=", "\"", "4015100317975368330", "\"", "at", "=", "\"", "240", ",", "76", ",", "241", ",", "44", "\"", "/", ">", "<", "scope", "id", "=", "\"", "1071422968910417125", "\"", "at", "=", "\"", "255", ",", "69", ",", "256", ",", "21", "\"", "/", ">", "<", "scope", "id", "=", "\"", "1071422968910417150", "\"", "at", "=", "\"", "259", ",", "29", ",", "260", ",", "103", "\"", "/", ">", "<", "scope", "id", "=", "\"", "9184997660524409612", "\"", "at", "=", "\"", "310", ",", "43", ",", "311", ",", "195", "\"", "/", ">", "<", "scope", "id", "=", "\"", "3355834833109723048", "\"", "at", "=", "\"", "334", ",", "59", ",", "335", ",", "17", "\"", "/", ">", "<", "scope", "id", "=", "\"", "3355834833109852716", "\"", "at", "=", "\"", "339", ",", "80", ",", "340", ",", "22", "\"", "/", ">", "<", "scope", "id", "=", "\"", "2734352094453134564", "\"", "at", "=", "\"", "77", ",", "10", ",", "79", ",", "28", "\"", "/", ">", "<", "scope", "id", "=", "\"", "1423989185889116869", "\"", "at", "=", "\"", "190", ",", "33", ",", "192", ",", "127", "\"", ">", "<", "var", "name", "=", "\"", "statusBar", "\"", "id", "=", "\"", "1423989185889116870", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071759", "\"", "at", "=", "\"", "275", ",", "26", ",", "277", ",", "17", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071791", "\"", "at", "=", "\"", "297", ",", "26", ",", "299", ",", "17", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071835", "\"", "at", "=", "\"", "307", ",", "29", ",", "309", ",", "17", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071549", "\"", "at", "=", "\"", "317", ",", "111", ",", "319", ",", "86", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071759", "\"", "at", "=", "\"", "282", ",", "26", ",", "284", ",", "17", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071791", "\"", "at", "=", "\"", "304", ",", "26", ",", "306", ",", "17", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071835", "\"", "at", "=", "\"", "314", ",", "29", ",", "316", ",", "17", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071549", "\"", "at", "=", "\"", "324", ",", "111", ",", "326", ",", "86", "\"", ">", "<", "var", "name", "=", "\"", "opt", "\"", "id", "=", "\"", "5542552559869832084", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071351", "\"", "at", "=", "\"", "75", ",", "0", ",", "78", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071351", "\"", "at", "=", "\"", "82", ",", "0", ",", "85", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "project", "\"", "id", "=", "\"", "8632185942131071354", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071408", "\"", "at", "=", "\"", "128", ",", "0", ",", "131", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071412", "\"", "at", "=", "\"", "131", ",", "0", ",", "134", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "147", ",", "0", ",", "150", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816488278455", "\"", "at", "=", "\"", "153", ",", "0", ",", "156", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071408", "\"", "at", "=", "\"", "135", ",", "0", ",", "138", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071412", "\"", "at", "=", "\"", "138", ",", "0", ",", "141", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "154", ",", "0", ",", "157", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816488278455", "\"", "at", "=", "\"", "160", ",", "0", ",", "163", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "it", "\"", "id", "=", "\"", "6173352816488278455", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "1423989185889514818", "\"", "at", "=", "\"", "158", ",", "0", ",", "161", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "1423989185889514818", "\"", "at", "=", "\"", "165", ",", "0", ",", "168", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "it", "\"", "id", "=", "\"", "1423989185889514818", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "6173352816489830986", "\"", "at", "=", "\"", "200", ",", "0", ",", "203", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "6173352816489830986", "\"", "at", "=", "\"", "207", ",", "0", ",", "210", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "it", "\"", "id", "=", "\"", "6173352816489830986", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "4015100317974853303", "\"", "at", "=", "\"", "207", ",", "0", ",", "210", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "4015100317974853303", "\"", "at", "=", "\"", "214", ",", "0", ",", "217", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "it", "\"", "id", "=", "\"", "4015100317974853303", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "6173352816489302045", "\"", "at", "=", "\"", "211", ",", "0", ",", "214", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "6173352816489302045", "\"", "at", "=", "\"", "218", ",", "0", ",", "221", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "it", "\"", "id", "=", "\"", "6173352816489302045", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "6173352816489302055", "\"", "at", "=", "\"", "215", ",", "0", ",", "218", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "6173352816489302055", "\"", "at", "=", "\"", "222", ",", "0", ",", "225", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "it", "\"", "id", "=", "\"", "6173352816489302055", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "4015100317975368319", "\"", "at", "=", "\"", "229", ",", "0", ",", "232", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "4015100317975368319", "\"", "at", "=", "\"", "236", ",", "0", ",", "239", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "it", "\"", "id", "=", "\"", "4015100317975368319", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "4015100317975368329", "\"", "at", "=", "\"", "233", ",", "0", ",", "236", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "4015100317975368329", "\"", "at", "=", "\"", "240", ",", "0", ",", "243", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "it", "\"", "id", "=", "\"", "4015100317975368329", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "2976809348477198799", "\"", "at", "=", "\"", "290", ",", "56", ",", "293", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "9184997660524409611", "\"", "at", "=", "\"", "303", ",", "0", ",", "306", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "2976809348477198799", "\"", "at", "=", "\"", "297", ",", "56", ",", "300", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "9184997660524409611", "\"", "at", "=", "\"", "310", ",", "0", ",", "313", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "it", "\"", "id", "=", "\"", "9184997660524409611", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "3355834833109825840", "\"", "at", "=", "\"", "331", ",", "103", ",", "334", ",", "9", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8389443510893206002", "\"", "at", "=", "\"", "167", ",", "27", ",", "171", ",", "21", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071449", "\"", "at", "=", "\"", "261", ",", "104", ",", "265", ",", "124", "\"", ">", "<", "scope", "id", "=", "\"", "3355834833109825840", "\"", "at", "=", "\"", "338", ",", "103", ",", "341", ",", "9", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8389443510893206002", "\"", "at", "=", "\"", "174", ",", "27", ",", "178", ",", "21", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071449", "\"", "at", "=", "\"", "268", ",", "104", ",", "272", ",", "124", "\"", ">", "<", "var", "name", "=", "\"", "opt", "\"", "id", "=", "\"", "5542552559868791020", "\"", "/", ">", "<", "var", "name", "=", "\"", "scope", "\"", "id", "=", "\"", "7690266557991803385", "\"", "/", ">", "<", "var", "name", "=", "\"", "searchQuery", "\"", "id", "=", "\"", "8632185942131071451", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071539", "\"", "at", "=", "\"", "317", ",", "0", ",", "321", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071539", "\"", "at", "=", "\"", "324", ",", "0", ",", "328", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "node", "\"", "id", "=", "\"", "8632185942131071542", "\"", "/", ">", "<", "var", "name", "=", "\"", "provider", "\"", "id", "=", "\"", "8632185942131071547", "\"", "/", ">", "<", "var", "name", "=", "\"", "scope", "\"", "id", "=", "\"", "8632185942131071545", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071569", "\"", "at", "=", "\"", "86", ",", "13", ",", "91", ",", "59", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071569", "\"", "at", "=", "\"", "93", ",", "13", ",", "98", ",", "59", "\"", ">", "<", "var", "name", "=", "\"", "handler", "\"", "id", "=", "\"", "8632185942131071571", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071600", "\"", "at", "=", "\"", "107", ",", "30", ",", "112", ",", "11", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816488637144", "\"", "at", "=", "\"", "181", ",", "33", ",", "186", ",", "11", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071600", "\"", "at", "=", "\"", "114", ",", "30", ",", "119", ",", "11", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816488637144", "\"", "at", "=", "\"", "188", ",", "33", ",", "193", ",", "11", "\"", ">", "<", "var", "name", "=", "\"", "ideFrame", "\"", "id", "=", "\"", "1423989185889116857", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "3355834833109825838", "\"", "at", "=", "\"", "330", ",", "23", ",", "335", ",", "7", "\"", ">", "<", "scope", "id", "=", "\"", "3355834833109825838", "\"", "at", "=", "\"", "337", ",", "23", ",", "342", ",", "7", "\"", ">", "<", "var", "name", "=", "\"", "root", "\"", "id", "=", "\"", "3355834833109825844", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071400", "\"", "at", "=", "\"", "122", ",", "0", ",", "128", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "1071422968910417114", "\"", "at", "=", "\"", "247", ",", "89", ",", "254", ",", "11", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071400", "\"", "at", "=", "\"", "129", ",", "0", ",", "135", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "1071422968910417114", "\"", "at", "=", "\"", "254", ",", "89", ",", "261", ",", "11", "\"", ">", "<", "var", "name", "=", "\"", "node", "\"", "id", "=", "\"", "1071422968910417138", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071442", "\"", "at", "=", "\"", "260", ",", "0", ",", "267", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071442", "\"", "at", "=", "\"", "267", ",", "0", ",", "274", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "name", "\"", "id", "=", "\"", "8632185942131071447", "\"", "/", ">", "<", "var", "name", "=", "\"", "namespace", "\"", "id", "=", "\"", "8632185942131071445", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071747", "\"", "at", "=", "\"", "272", ",", "25", ",", "280", ",", "115", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071747", "\"", "at", "=", "\"", "279", ",", "25", ",", "287", ",", "115", "\"", ">", "<", "var", "name", "=", "\"", "cls", "\"", "id", "=", "\"", "8632185942131071749", "\"", "/", ">", "<", "var", "name", "=", "\"", "scope", "\"", "id", "=", "\"", "7690266557991564952", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071559", "\"", "at", "=", "\"", "85", ",", "25", ",", "94", ",", "9", "\"", "/", ">", "<", "scope", "id", "=", "\"", "1071422968910417108", "\"", "at", "=", "\"", "246", ",", "25", ",", "255", ",", "9", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071559", "\"", "at", "=", "\"", "92", ",", "25", ",", "101", ",", "9", "\"", "/", ">", "<", "scope", "id", "=", "\"", "1071422968910417108", "\"", "at", "=", "\"", "253", ",", "25", ",", "262", ",", "9", "\"", ">", "<", "var", "name", "=", "\"", "descriptor", "\"", "id", "=", "\"", "1071422968910417112", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "3355834833109720113", "\"", "at", "=", "\"", "326", ",", "63", ",", "335", ",", "7", "\"", ">", "<", "scope", "id", "=", "\"", "3355834833109720113", "\"", "at", "=", "\"", "333", ",", "63", ",", "342", ",", "7", "\"", ">", "<", "var", "name", "=", "\"", "model", "\"", "id", "=", "\"", "3355834833109849258", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "1071422968910417107", "\"", "at", "=", "\"", "246", ",", "25", ",", "256", ",", "56", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071514", "\"", "at", "=", "\"", "271", ",", "0", ",", "282", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "3355834833109720111", "\"", "at", "=", "\"", "325", ",", "62", ",", "336", ",", "5", "\"", ">", "<", "scope", "id", "=", "\"", "1071422968910417107", "\"", "at", "=", "\"", "253", ",", "25", ",", "263", ",", "56", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071514", "\"", "at", "=", "\"", "278", ",", "0", ",", "289", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "3355834833109720111", "\"", "at", "=", "\"", "332", ",", "62", ",", "343", ",", "5", "\"", ">", "<", "var", "name", "=", "\"", "m", "\"", "id", "=", "\"", "3355834833109720117", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071377", "\"", "at", "=", "\"", "84", ",", "0", ",", "96", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "1071422968910417106", "\"", "at", "=", "\"", "246", ",", "0", ",", "258", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071588", "\"", "at", "=", "\"", "105", ",", "25", ",", "118", ",", "9", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071377", "\"", "at", "=", "\"", "91", ",", "0", ",", "103", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "1071422968910417106", "\"", "at", "=", "\"", "253", ",", "0", ",", "265", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071588", "\"", "at", "=", "\"", "112", ",", "25", ",", "125", ",", "9", "\"", ">", "<", "var", "name", "=", "\"", "handler", "\"", "id", "=", "\"", "8632185942131071590", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "6173352816488299477", "\"", "at", "=", "\"", "165", ",", "66", ",", "178", ",", "11", "\"", ">", "<", "scope", "id", "=", "\"", "6173352816488299477", "\"", "at", "=", "\"", "172", ",", "66", ",", "185", ",", "11", "\"", ">", "<", "var", "name", "=", "\"", "di", "\"", "id", "=", "\"", "6173352816487899819", "\"", "/", ">", "<", "var", "name", "=", "\"", "np", "\"", "id", "=", "\"", "6173352816490759615", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071506", "\"", "at", "=", "\"", "268", ",", "75", ",", "282", ",", "7", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071506", "\"", "at", "=", "\"", "275", ",", "75", ",", "289", ",", "7", "\"", ">", "<", "var", "name", "=", "\"", "mpsProject", "\"", "id", "=", "\"", "5542552559869817183", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "6173352816488299471", "\"", "at", "=", "\"", "164", ",", "30", ",", "179", ",", "9", "\"", ">", "<", "scope", "id", "=", "\"", "6173352816488299471", "\"", "at", "=", "\"", "171", ",", "30", ",", "186", ",", "9", "\"", ">", "<", "var", "name", "=", "\"", "model", "\"", "id", "=", "\"", "6173352816488299473", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071396", "\"", "at", "=", "\"", "104", ",", "0", ",", "120", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071432", "\"", "at", "=", "\"", "242", ",", "88", ",", "258", ",", "7", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071396", "\"", "at", "=", "\"", "111", ",", "0", ",", "127", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071432", "\"", "at", "=", "\"", "249", ",", "88", ",", "265", ",", "7", "\"", ">", "<", "var", "name", "=", "\"", "mpsProject", "\"", "id", "=", "\"", "5542552559869470181", "\"", "/", ">", "<", "var", "name", "=", "\"", "nodeId", "\"", "id", "=", "\"", "7690266557990045528", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "3355834833109596362", "\"", "at", "=", "\"", "321", ",", "79", ",", "337", ",", "16", "\"", ">", "<", "scope", "id", "=", "\"", "3355834833109596362", "\"", "at", "=", "\"", "328", ",", "79", ",", "344", ",", "16", "\"", ">", "<", "var", "name", "=", "\"", "modelName", "\"", "id", "=", "\"", "1238267575189", "\"", "/", ">", "<", "var", "name", "=", "\"", "name", "\"", "id", "=", "\"", "1238267599635", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071365", "\"", "at", "=", "\"", "79", ",", "31", ",", "96", ",", "14", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071501", "\"", "at", "=", "\"", "267", ",", "0", ",", "284", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071365", "\"", "at", "=", "\"", "86", ",", "31", ",", "103", ",", "14", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071501", "\"", "at", "=", "\"", "274", ",", "0", ",", "291", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "fqName", "\"", "id", "=", "\"", "8632185942131071504", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "143", ",", "9", ",", "161", ",", "14", "\"", ">", "<", "scope", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "150", ",", "9", ",", "168", ",", "14", "\"", ">", "<", "var", "name", "=", "\"", "context", "\"", "id", "=", "\"", "6173352816488226159", "\"", "/", ">", "<", "var", "name", "=", "\"", "scope_xnj2f8_e0a0a1a8", "\"", "id", "=", "\"", "6173352816488226159", "\"", "/", ">", "<", "var", "name", "=", "\"", "scope_xnj2f8_e0a0a1a8_0", "\"", "id", "=", "\"", "6173352816488226159", "\"", "/", ">", "<", "var", "name", "=", "\"", "scope_xnj2f8_e0a0a1a11", "\"", "id", "=", "\"", "6173352816488226159", "\"", "/", ">", "<", "var", "name", "=", "\"", "scope_xnj2f8_e0a0a1a11_0", "\"", "id", "=", "\"", "6173352816488226159", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "6173352816489722639", "\"", "at", "=", "\"", "203", ",", "9", ",", "221", ",", "7", "\"", ">", "<", "scope", "id", "=", "\"", "6173352816489722639", "\"", "at", "=", "\"", "210", ",", "9", ",", "228", ",", "7", "\"", ">", "<", "var", "name", "=", "\"", "info", "\"", "id", "=", "\"", "6173352816489302005", "\"", "/", ">", "<", "var", "name", "=", "\"", "positions", "\"", "id", "=", "\"", "6173352816489984627", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "7690266557991251440", "\"", "at", "=", "\"", "321", ",", "0", ",", "339", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "7690266557991251440", "\"", "at", "=", "\"", "328", ",", "0", ",", "346", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "classFqName", "\"", "id", "=", "\"", "3355834833109653826", "\"", "/", ">", "<", "var", "name", "=", "\"", "scope", "\"", "id", "=", "\"", "7690266557991293126", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071425", "\"", "at", "=", "\"", "241", ",", "0", ",", "260", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071425", "\"", "at", "=", "\"", "248", ",", "0", ",", "267", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "id", "\"", "id", "=", "\"", "8632185942131071430", "\"", "/", ">", "<", "var", "name", "=", "\"", "namespace", "\"", "id", "=", "\"", "8632185942131071428", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071362", "\"", "at", "=", "\"", "78", ",", "0", ",", "98", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071384", "\"", "at", "=", "\"", "99", ",", "31", ",", "120", ",", "14", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071381", "\"", "at", "=", "\"", "98", ",", "0", ",", "122", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816489722633", "\"", "at", "=", "\"", "198", ",", "57", ",", "222", ",", "5", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071362", "\"", "at", "=", "\"", "85", ",", "0", ",", "105", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071384", "\"", "at", "=", "\"", "106", ",", "31", ",", "127", ",", "14", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071381", "\"", "at", "=", "\"", "105", ",", "0", ",", "129", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816489722633", "\"", "at", "=", "\"", "205", ",", "57", ",", "229", ",", "5", "\"", ">", "<", "var", "name", "=", "\"", "root", "\"", "id", "=", "\"", "6173352816489722635", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071779", "\"", "at", "=", "\"", "289", ",", "25", ",", "313", ",", "44", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071779", "\"", "at", "=", "\"", "296", ",", "25", ",", "320", ",", "44", "\"", ">", "<", "var", "name", "=", "\"", "allMethods", "\"", "id", "=", "\"", "9184997660524409576", "\"", "/", ">", "<", "var", "name", "=", "\"", "cls", "\"", "id", "=", "\"", "8632185942131071781", "\"", "/", ">", "<", "var", "name", "=", "\"", "method", "\"", "id", "=", "\"", "8632185942131071801", "\"", "/", ">", "<", "var", "name", "=", "\"", "provider", "\"", "id", "=", "\"", "9184997660524409833", "\"", "/", ">", "<", "var", "name", "=", "\"", "scope", "\"", "id", "=", "\"", "7690266557991113161", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071535", "\"", "at", "=", "\"", "288", ",", "0", ",", "315", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071527", "\"", "at", "=", "\"", "285", ",", "132", ",", "315", ",", "7", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071535", "\"", "at", "=", "\"", "295", ",", "0", ",", "322", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "8632185942131071527", "\"", "at", "=", "\"", "292", ",", "132", ",", "322", ",", "7", "\"", ">", "<", "var", "name", "=", "\"", "mpsProject", "\"", "id", "=", "\"", "5542552559869822424", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "8632185942131071518", "\"", "at", "=", "\"", "284", ",", "0", ",", "317", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "8632185942131071518", "\"", "at", "=", "\"", "291", ",", "0", ",", "324", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "classFqName", "\"", "id", "=", "\"", "8632185942131071521", "\"", "/", ">", "<", "var", "name", "=", "\"", "methodName", "\"", "id", "=", "\"", "8632185942131071523", "\"", "/", ">", "<", "var", "name", "=", "\"", "parameterCount", "\"", "id", "=", "\"", "8632185942131071525", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "6173352816487899852", "\"", "at", "=", "\"", "196", ",", "116", ",", "238", ",", "153", "\"", ">", "<", "scope", "id", "=", "\"", "6173352816487899852", "\"", "at", "=", "\"", "203", ",", "116", ",", "245", ",", "153", "\"", ">", "<", "var", "name", "=", "\"", "bestPosition", "\"", "id", "=", "\"", "4015100317975368314", "\"", "/", ">", "<", "var", "name", "=", "\"", "nicePositions", "\"", "id", "=", "\"", "4015100317975073801", "\"", "/", ">", "<", "var", "name", "=", "\"", "roots", "\"", "id", "=", "\"", "6173352816488887880", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "6173352816487899843", "\"", "at", "=", "\"", "195", ",", "0", ",", "240", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "6173352816487899843", "\"", "at", "=", "\"", "202", ",", "0", ",", "247", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "debugInfo", "\"", "id", "=", "\"", "6173352816487899845", "\"", "/", ">", "<", "var", "name", "=", "\"", "fileName", "\"", "id", "=", "\"", "6173352816487899847", "\"", "/", ">", "<", "var", "name", "=", "\"", "line", "\"", "id", "=", "\"", "6173352816487899850", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "6173352816488320782", "\"", "at", "=", "\"", "138", ",", "25", ",", "190", ",", "56", "\"", ">", "<", "scope", "id", "=", "\"", "6173352816488320782", "\"", "at", "=", "\"", "145", ",", "25", ",", "197", ",", "56", "\"", ">", "<", "var", "name", "=", "\"", "bestNode", "\"", "id", "=", "\"", "6173352816487899826", "\"", "/", ">", "<", "var", "name", "=", "\"", "fileName", "\"", "id", "=", "\"", "1423989185889284066", "\"", "/", ">", "<", "var", "name", "=", "\"", "modelsByName", "\"", "id", "=", "\"", "6173352816488278451", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "6173352816488320781", "\"", "at", "=", "\"", "138", ",", "0", ",", "192", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816487899809", "\"", "at", "=", "\"", "135", ",", "124", ",", "192", ",", "7", "\"", ">", "<", "scope", "id", "=", "\"", "6173352816488320781", "\"", "at", "=", "\"", "145", ",", "0", ",", "199", ",", "0", "\"", "/", ">", "<", "scope", "id", "=", "\"", "6173352816487899809", "\"", "at", "=", "\"", "142", ",", "124", ",", "199", ",", "7", "\"", ">", "<", "var", "name", "=", "\"", "mpsProject", "\"", "id", "=", "\"", "6173352816488320771", "\"", "/", ">", "<", "/", "scope", ">", "<", "scope", "id", "=", "\"", "6173352816487899798", "\"", "at", "=", "\"", "134", ",", "0", ",", "194", ",", "0", "\"", ">", "<", "scope", "id", "=", "\"", "6173352816487899798", "\"", "at", "=", "\"", "141", ",", "0", ",", "201", ",", "0", "\"", ">", "<", "var", "name", "=", "\"", "column", "\"", "id", "=", "\"", "6173352816487899806", "\"", "/", ">", "<", "var", "name", "=", "\"", "filePath", "\"", "id", "=", "\"", "6173352816487899800", "\"", "/", ">", "<", "var", "name", "=", "\"", "line", "\"", "id", "=", "\"", "6173352816487899804", "\"", "/", ">", "<", "var", "name", "=", "\"", "modelHint", "\"", "id", "=", "\"", "6173352816487899802", "\"", "/", ">", "<", "/", "scope", ">", "<", "unit", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "345", ",", "0", ",", "348", ",", "0", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "PROPS", "\"", "/", ">", "<", "unit", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "349", ",", "0", ",", "352", ",", "0", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "LINKS", "\"", "/", ">", "<", "unit", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "146", ",", "46", ",", "150", ",", "11", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "3", "$", "1", "\"", "/", ">", "<", "unit", "id", "=", "\"", "6173352816488278455", "\"", "at", "=", "\"", "152", ",", "150", ",", "156", ",", "11", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "3", "$", "2", "\"", "/", ">", "<", "unit", "id", "=", "\"", "1423989185889514818", "\"", "at", "=", "\"", "157", ",", "150", ",", "161", ",", "11", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "3", "$", "3", "\"", "/", ">", "<", "unit", "id", "=", "\"", "6173352816489830986", "\"", "at", "=", "\"", "199", ",", "69", ",", "203", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "7", "\"", "/", ">", "<", "unit", "id", "=", "\"", "4015100317974853303", "\"", "at", "=", "\"", "206", ",", "90", ",", "210", ",", "7", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "4", "\"", "/", ">", "<", "unit", "id", "=", "\"", "6173352816489302045", "\"", "at", "=", "\"", "210", ",", "18", ",", "214", ",", "7", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "5", "\"", "/", ">", "<", "unit", "id", "=", "\"", "6173352816489302055", "\"", "at", "=", "\"", "214", ",", "28", ",", "218", ",", "7", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "6", "\"", "/", ">", "<", "unit", "id", "=", "\"", "4015100317975368319", "\"", "at", "=", "\"", "228", ",", "108", ",", "232", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "8", "\"", "/", ">", "<", "unit", "id", "=", "\"", "4015100317975368329", "\"", "at", "=", "\"", "232", ",", "26", ",", "236", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "9", "\"", "/", ">", "<", "unit", "id", "=", "\"", "9184997660524409611", "\"", "at", "=", "\"", "302", ",", "71", ",", "306", ",", "9", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "12", "$", "1", "\"", "/", ">", "<", "unit", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "340", ",", "0", ",", "344", ",", "0", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "CONCEPTS", "\"", "/", ">", "<", "unit", "id", "=", "\"", "8632185942131071513", "\"", "at", "=", "\"", "270", ",", "50", ",", "282", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "11", "\"", "/", ">", "<", "unit", "id", "=", "\"", "8632185942131071376", "\"", "at", "=", "\"", "83", ",", "8", ",", "96", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "1", "\"", "/", ">", "<", "unit", "id", "=", "\"", "1071422968910417106", "\"", "at", "=", "\"", "245", ",", "49", ",", "258", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "10", "\"", "/", ">", "<", "unit", "id", "=", "\"", "8632185942131071395", "\"", "at", "=", "\"", "103", ",", "8", ",", "120", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "2", "\"", "/", ">", "<", "unit", "id", "=", "\"", "8632185942131071534", "\"", "at", "=", "\"", "287", ",", "50", ",", "315", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "12", "\"", "/", ">", "<", "unit", "id", "=", "\"", "6173352816488320781", "\"", "at", "=", "\"", "137", ",", "49", ",", "192", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "3", "\"", "/", ">", "<", "unit", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "71", ",", "0", ",", "353", ",", "0", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "\"", "/", ">", "<", "unit", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "352", ",", "0", ",", "355", ",", "0", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "PROPS", "\"", "/", ">", "<", "unit", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "356", ",", "0", ",", "359", ",", "0", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "LINKS", "\"", "/", ">", "<", "unit", "id", "=", "\"", "6173352816488226159", "\"", "at", "=", "\"", "153", ",", "46", ",", "157", ",", "11", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "3", "$", "1", "\"", "/", ">", "<", "unit", "id", "=", "\"", "6173352816488278455", "\"", "at", "=", "\"", "159", ",", "150", ",", "163", ",", "11", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "3", "$", "2", "\"", "/", ">", "<", "unit", "id", "=", "\"", "1423989185889514818", "\"", "at", "=", "\"", "164", ",", "150", ",", "168", ",", "11", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "3", "$", "3", "\"", "/", ">", "<", "unit", "id", "=", "\"", "6173352816489830986", "\"", "at", "=", "\"", "206", ",", "69", ",", "210", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "7", "\"", "/", ">", "<", "unit", "id", "=", "\"", "4015100317974853303", "\"", "at", "=", "\"", "213", ",", "90", ",", "217", ",", "7", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "4", "\"", "/", ">", "<", "unit", "id", "=", "\"", "6173352816489302045", "\"", "at", "=", "\"", "217", ",", "18", ",", "221", ",", "7", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "5", "\"", "/", ">", "<", "unit", "id", "=", "\"", "6173352816489302055", "\"", "at", "=", "\"", "221", ",", "28", ",", "225", ",", "7", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "6", "\"", "/", ">", "<", "unit", "id", "=", "\"", "4015100317975368319", "\"", "at", "=", "\"", "235", ",", "108", ",", "239", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "8", "\"", "/", ">", "<", "unit", "id", "=", "\"", "4015100317975368329", "\"", "at", "=", "\"", "239", ",", "26", ",", "243", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "9", "\"", "/", ">", "<", "unit", "id", "=", "\"", "9184997660524409611", "\"", "at", "=", "\"", "309", ",", "71", ",", "313", ",", "9", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "12", "$", "1", "\"", "/", ">", "<", "unit", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "347", ",", "0", ",", "351", ",", "0", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "CONCEPTS", "\"", "/", ">", "<", "unit", "id", "=", "\"", "8632185942131071513", "\"", "at", "=", "\"", "277", ",", "50", ",", "289", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "11", "\"", "/", ">", "<", "unit", "id", "=", "\"", "8632185942131071376", "\"", "at", "=", "\"", "90", ",", "8", ",", "103", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "1", "\"", "/", ">", "<", "unit", "id", "=", "\"", "1071422968910417106", "\"", "at", "=", "\"", "252", ",", "49", ",", "265", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "10", "\"", "/", ">", "<", "unit", "id", "=", "\"", "8632185942131071395", "\"", "at", "=", "\"", "110", ",", "8", ",", "127", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "2", "\"", "/", ">", "<", "unit", "id", "=", "\"", "8632185942131071534", "\"", "at", "=", "\"", "294", ",", "50", ",", "322", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "12", "\"", "/", ">", "<", "unit", "id", "=", "\"", "6173352816488320781", "\"", "at", "=", "\"", "144", ",", "49", ",", "199", ",", "5", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "$", "3", "\"", "/", ">", "<", "unit", "id", "=", "\"", "8632185942131071134", "\"", "at", "=", "\"", "72", ",", "0", ",", "360", ",", "0", "\"", "name", "=", "\"", "jetbrains", ".", "mps", ".", "plugin", ".", "MPSProjectIDEHandler", "\"", "/", ">", "<", "/", "file", ">", "<", "/", "root", ">", "<", "root", "nodeRef", "=", "\"", "r", ":", "20925211", "-", "384c", "-", "4c5f", "-", "b751", "-", "56b79dd3b32e", "(", "jetbrains", ".", "mps", ".", "plugin", ")", "/", "8632185942131071966", "\"", ">"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["trivial", "improvements", "to", "RPW"], "code_tokens": ["@", "@", "-", "20", ",", "15", "+", "20", ",", "19", "@", "@", "import", "org", ".", "apache", ".", "tika", ".", "exception", ".", "CorruptedFileException", ";", "import", "org", ".", "apache", ".", "tika", ".", "exception", ".", "TikaException", ";", "import", "org", ".", "apache", ".", "tika", ".", "io", ".", "FilenameUtils", ";", "import", "org", ".", "apache", ".", "tika", ".", "io", ".", "TikaInputStream", ";", "import", "org", ".", "apache", ".", "tika", ".", "metadata", ".", "Metadata", ";", "import", "org", ".", "apache", ".", "tika", ".", "metadata", ".", "Property", ";", "import", "org", ".", "apache", ".", "tika", ".", "metadata", ".", "TikaCoreProperties", ";", "import", "org", ".", "apache", ".", "tika", ".", "mime", ".", "MediaType", ";", "import", "org", ".", "apache", ".", "tika", ".", "sax", ".", "AbstractRecursiveParserWrapperHandler", ";", "import", "org", ".", "apache", ".", "tika", ".", "sax", ".", "ContentHandlerDecorator", ";", "import", "org", ".", "apache", ".", "tika", ".", "sax", ".", "ContentHandlerFactory", ";", "import", "org", ".", "apache", ".", "tika", ".", "sax", ".", "RecursiveParserWrapperHandler", ";", "import", "org", ".", "apache", ".", "tika", ".", "sax", ".", "SecureContentHandler", ";", "import", "org", ".", "apache", ".", "tika", ".", "utils", ".", "ExceptionUtils", ";", "import", "org", ".", "apache", ".", "tika", ".", "utils", ".", "ParserUtils", ";", "import", "org", ".", "xml", ".", "sax", ".", "Attributes", ";", "import", "org", ".", "xml", ".", "sax", ".", "ContentHandler", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "@", "@", "-", "221", ",", "7", "+", "225", ",", "12", "@", "@", "public", "void", "parse", "(", "InputStream", "stream", ",", "ContentHandler", "recursiveParserWrapperHandl", "long", "started", "=", "System", ".", "currentTimeMillis", "(", ");", "parserState", ".", "recursiveParserWrapperHandler", ".", "startDocument", "(", ");", "try", "{", "getWrappedParser", "(", ").", "parse", "(", "stream", ",", "localHandler", ",", "metadata", ",", "context", ")", ";", "try", "(", "TikaInputStream", "tis", "=", "TikaInputStream", ".", "get", "(", "stream", ")", ")", "{", "RecursivelySecureContentHandler", "secureContentHandler", "=", "new", "RecursivelySecureContentHandler", "(", "localHandler", ",", "tis", ")", ";", "context", ".", "set", "(", "RecursivelySecureContentHandler", ".", "class", ",", "secureContentHandler", ")", ";", "getWrappedParser", "(", ").", "parse", "(", "tis", ",", "secureContentHandler", ",", "metadata", ",", "context", ")", ";", "}", "}", "catch", "(", "SAXException", "e", ")", "{", "boolean", "wlr", "=", "isWriteLimitReached", "(", "e", ")", ";", "if", "(", "wlr", "=", "=", "false", ")", "{", "@", "@", "-", "366", ",", "8", "+", "375", ",", "14", "@", "@", "public", "void", "parse", "(", "InputStream", "stream", ",", "ContentHandler", "ignore", ",", "Parser", "preContextParser", "=", "context", ".", "get", "(", "Parser", ".", "class", ")", ";", "context", ".", "set", "(", "Parser", ".", "class", ",", "new", "EmbeddedParserDecorator", "(", "getWrappedParser", "(", "),", "objectLocation", ",", "parserState", ")", ");", "long", "started", "=", "System", ".", "currentTimeMillis", "(", ");", "RecursivelySecureContentHandler", "secureContentHandler", "=", "context", ".", "get", "(", "RecursivelySecureContentHandler", ".", "class", ")", ";", "/", "/", "store", "the", "handler", "that", "was", "used", "before", "this", "parse", "/", "/", "so", "that", "you", "can", "return", "it", "back", "to", "its", "state", "at", "the", "end", "of", "this", "parse", "ContentHandler", "preContextHandler", "=", "secureContentHandler", ".", "handler", ";", "secureContentHandler", ".", "updateContentHandler", "(", "localHandler", ")", ";", "try", "{", "super", ".", "parse", "(", "stream", ",", "localHandler", ",", "metadata", ",", "context", ")", ";", "super", ".", "parse", "(", "stream", ",", "secureContentHandler", ",", "metadata", ",", "context", ")", ";", "}", "catch", "(", "SAXException", "e", ")", "{", "boolean", "wlr", "=", "isWriteLimitReached", "(", "e", ")", ";", "if", "(", "wlr", "=", "=", "true", ")", "{", "@", "@", "-", "389", ",", "6", "+", "404", ",", "7", "@", "@", "public", "void", "parse", "(", "InputStream", "stream", ",", "ContentHandler", "ignore", ",", "}", "}", "finally", "{", "context", ".", "set", "(", "Parser", ".", "class", ",", "preContextParser", ")", ";", "secureContentHandler", ".", "updateContentHandler", "(", "preContextHandler", ")", ";", "long", "elapsedMillis", "=", "System", ".", "currentTimeMillis", "(", ")", "-", "started", ";", "metadata", ".", "set", "(", "RecursiveParserWrapperHandler", ".", "PARSE_TIME_MILLIS", ",", "Long", ".", "toString", "(", "elapsedMillis", ")", ");", "parserState", ".", "recursiveParserWrapperHandler", ".", "endEmbeddedDocument", "(", "localHandler", ",", "metadata", ")", ";", "@", "@", "-", "406", ",", "7", "+", "422", ",", "46", "@", "@", "public", "void", "parse", "(", "InputStream", "stream", ",", "ContentHandler", "ignore", ",", "private", "ParserState", "(", "AbstractRecursiveParserWrapperHandler", "handler", ")", "{", "this", ".", "recursiveParserWrapperHandler", "=", "handler", ";", "}", "}", "private", "class", "RecursivelySecureContentHandler", "extends", "SecureContentHandler", "{", "private", "ContentHandler", "handler", ";", "public", "RecursivelySecureContentHandler", "(", "ContentHandler", "handler", ",", "TikaInputStream", "stream", ")", "{", "super", "(", "handler", ",", "stream", ")", ";", "this", ".", "handler", "=", "handler", ";", "}", "public", "void", "updateContentHandler", "(", "ContentHandler", "handler", ")", "{", "setContentHandler", "(", "handler", ")", ";", "this", ".", "handler", "=", "handler", ";", "}", "/", "**", "*", "Bypass", "the", "SecureContentHandler", ".", "..", "*", "*", "This", "handler", "only", "looks", "at", "zip", "bomb", "via", "zip", "expansion", ".", "*", "Users", "should", "be", "protected", "within", "entries", "against", "nested", "*", "nested", "xml", "entities", ".", "We", "don", "'", "t", "want", "to", "carry", "*", "those", "stats", "_across_", "entries", ".", "*", "*", "@", "param", "uri", "*", "@", "param", "localName", "*", "@", "param", "name", "*", "@", "param", "atts", "*", "@", "throws", "SAXException", "*", "/", "@", "Override", "public", "void", "startElement", "(", "String", "uri", ",", "String", "localName", ",", "String", "name", ",", "Attributes", "atts", ")", "throws", "SAXException", "{", "this", ".", "handler", ".", "startElement", "(", "uri", ",", "localName", ",", "name", ",", "atts", ")", ";", "}", "@", "Override", "public", "void", "endElement", "(", "String", "uri", ",", "String", "localName", ",", "String", "name", ")", "throws", "SAXException", "{", "this", ".", "handler", ".", "endElement", "(", "uri", ",", "localName", ",", "name", ")", ";", "}", "}", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["..."], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Update", "README.md"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Revert", "\"tests", "for", "statefulset", "PersistentVolumeClaimDeletePolicy", "api", "change\"", "This", "reverts", "commit", "b259686b367ffef89310a71875834a97befc5b4b.", "Change-Id:", "I25cc8ae8a9aa77d0bc483147d3f8fb65616a2b2b", "Kubernetes-commit:", "aeb82243fc863c44c3603f0d3bf4d8910774765e"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Fix", "bug", "#67060:", "use", "default", "mode", "of", "660"], "code_tokens": ["@", "@", "-", "10", ",", "6", "+", "10", ",", "10", "@", "@", "PHP", "NEWS", ".", "Fixed", "memory", "corruption", "in", "openssl_x509_parse", "(", ")", "(", "CVE", "-", "2013", "-", "6420", ")", ".", "(", "Stefan", "Esser", ")", ".", "-", "FPM", ":", ".", "Fixed", "bug", "#", "67060", "(", "sapi", "/", "fpm", ":", "possible", "privilege", "escalation", "due", "to", "insecure", "default", "configuration", ")", "(", "CVE", "-", "2014", "-", "0185", ")", ".", "(", "Stas", ")", "11", "Jul", "2013", ",", "PHP", "5", ".", "3", ".", "27", "-", "Core", ":", "@", "@", "-", "35", ",", "7", "+", "35", ",", "7", "@", "@", "int", "fpm_unix_resolve_socket_premissions", "(", "struct", "fpm_worker_pool_s", "*", "wp", ")", "/", "*", "{", "{{", "*", "/", "/", "*", "uninitialized", "*", "/", "wp", "-", ">", "socket_uid", "=", "-", "1", ";", "wp", "-", ">", "socket_gid", "=", "-", "1", ";", "wp", "-", ">", "socket_mode", "=", "0666", ";", "wp", "-", ">", "socket_mode", "=", "0660", ";", "if", "(", "!", "c", ")", "{", "return", "0", ";", "@", "@", "-", "158", ",", "10", "+", "158", ",", "10", "@", "@", "listen", "=", "127", ".", "0", ".", "0", ".", "1", ":", "9000", ";", "permissions", "must", "be", "set", "in", "order", "to", "allow", "connections", "from", "a", "web", "server", ".", "Many", ";", "BSD", "-", "derived", "systems", "allow", "connections", "regardless", "of", "permissions", ".", ";", "Default", "Values", ":", "user", "and", "group", "are", "set", "as", "the", "running", "user", ";", "mode", "is", "set", "to", "0666", ";", "mode", "is", "set", "to", "0660", ";", "listen", ".", "owner", "=", "@", "php_fpm_user", "@", ";", "listen", ".", "group", "=", "@", "php_fpm_group", "@", ";", "listen", ".", "mode", "=", "0666", ";", "listen", ".", "mode", "=", "0660", ";", "List", "of", "ipv4", "addresses", "of", "FastCGI", "clients", "which", "are", "allowed", "to", "connect", ".", ";", "Equivalent", "to", "the", "FCGI_WEB_SERVER_ADDRS", "environment", "variable", "in", "the", "original"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Merge", "pull", "request", "#418", "from", "JCgH4164838Gh792C124B5/CPickPR416_417_26x", "Cherry-pick", "PR#416", "and", "PR#417", "from", "2.5.x", "into", "2.6.x"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["jbd2:", "clear", "BH_Delay", "&", "BH_Unwritten", "in", "journal_unmap_buffer", "journal_unmap_buffer()'s", "zap_buffer:", "code", "clears", "a", "lot", "of", "buffer", "head", "state", "ala", "discard_buffer(),", "but", "does", "not", "touch", "_Delay", "or", "_Unwritten", "as", "discard_buffer()", "does.", "This", "can", "be", "problematic", "in", "some", "areas", "of", "the", "ext4", "code", "which", "assume", "that", "if", "they", "have", "found", "a", "buffer", "marked", "unwritten", "or", "delay,", "then", "it's", "a", "live", "one.", "Perhaps", "those", "spots", "should", "check", "whether", "it", "is", "mapped", "as", "well,", "but", "if", "jbd2", "is", "going", "to", "tear", "down", "a", "buffer,", "let's", "really", "tear", "it", "down", "completely.", "Without", "this", "I", "get", "some", "fsx", "failures", "on", "sub-page-block", "filesystems", "up", "until", "v3.2,", "at", "which", "point", "4e96b2dbbf1d7e81f22047a50f862555a6cb87cb", "and", "189e868fa8fdca702eb9db9d8afc46b5cb9144c9", "make", "the", "failures", "go", "away,", "because", "buried", "within", "that", "large", "change", "is", "some", "more", "flag", "clearing.", "I", "still", "think", "it's", "worth", "doing", "in", "jbd2,", "since", "->invalidatepage", "leads", "here", "directly,", "and", "it's", "the", "right", "place", "to", "clear", "away", "these", "flags.", "Signed-off-by:", "Eric", "Sandeen", "<sandeen@redhat.com>", "Signed-off-by:", "\"Theodore", "Ts'o\"", "<tytso@mit.edu>", "Cc:", "stable@vger.kernel.org"], "code_tokens": ["@", "@", "-", "1949", ",", "6", "+", "1949", ",", "8", "@", "@", "static", "int", "journal_unmap_buffer", "(", "journal_t", "*", "journal", ",", "struct", "buffer_head", "*", "bh", ")", "clear_buffer_mapped", "(", "bh", ")", ";", "clear_buffer_req", "(", "bh", ")", ";", "clear_buffer_new", "(", "bh", ")", ";", "clear_buffer_delay", "(", "bh", ")", ";", "clear_buffer_unwritten", "(", "bh", ")", ";", "bh", "-", ">", "b_bdev", "=", "NULL", ";", "return", "may_free", ";", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["GEODE-7018:", "Enable", "hostname", "validation", "for", "SSL", "over", "NIO", "(#3849)"], "code_tokens": ["@", "@", "-", "0", ",", "0", "+", "1", ",", "227", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "*", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "*", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "*", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "*", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "*", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "*", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "geode", ".", "internal", ".", "net", ";", "import", "static", "junit", ".", "framework", ".", "TestCase", ".", "fail", ";", "import", "static", "org", ".", "apache", ".", "geode", ".", "internal", ".", "security", ".", "SecurableCommunicationChannel", ".", "CLUSTER", ";", "import", "static", "org", ".", "apache", ".", "geode", ".", "test", ".", "awaitility", ".", "GeodeAwaitility", ".", "await", ";", "import", "static", "org", ".", "assertj", ".", "core", ".", "api", ".", "Assertions", ".", "assertThat", ";", "import", "static", "org", ".", "assertj", ".", "core", ".", "api", ".", "Assertions", ".", "assertThatThrownBy", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNull", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "java", ".", "net", ".", "InetAddress", ";", "import", "java", ".", "net", ".", "InetSocketAddress", ";", "import", "java", ".", "net", ".", "ServerSocket", ";", "import", "java", ".", "net", ".", "Socket", ";", "import", "java", ".", "nio", ".", "ByteBuffer", ";", "import", "java", ".", "nio", ".", "channels", ".", "ServerSocketChannel", ";", "import", "java", ".", "nio", ".", "channels", ".", "SocketChannel", ";", "import", "java", ".", "security", ".", "cert", ".", "CertificateException", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLEngine", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLHandshakeException", ";", "import", "org", ".", "junit", ".", "After", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Rule", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "contrib", ".", "java", ".", "lang", ".", "system", ".", "RestoreSystemProperties", ";", "import", "org", ".", "junit", ".", "experimental", ".", "categories", ".", "Category", ";", "import", "org", ".", "junit", ".", "rules", ".", "ErrorCollector", ";", "import", "org", ".", "junit", ".", "rules", ".", "TestName", ";", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", ";", "import", "org", ".", "junit", ".", "runners", ".", "Parameterized", ";", "import", "org", ".", "junit", ".", "runners", ".", "Parameterized", ".", "Parameter", ";", "import", "org", ".", "junit", ".", "runners", ".", "Parameterized", ".", "Parameters", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "ssl", ".", "CertStores", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "ssl", ".", "TestSSLUtils", ";", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "internal", ".", "DMStats", ";", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "internal", ".", "DistributionConfig", ";", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "internal", ".", "DistributionConfigImpl", ";", "import", "org", ".", "apache", ".", "geode", ".", "test", ".", "dunit", ".", "IgnoredException", ";", "import", "org", ".", "apache", ".", "geode", ".", "test", ".", "junit", ".", "categories", ".", "MembershipTest", ";", "import", "org", ".", "apache", ".", "geode", ".", "test", ".", "junit", ".", "runners", ".", "CategoryWithParameterizedRunnerFactory", ";", "/", "**", "*", "Integration", "tests", "for", "SSL", "handshake", "specifically", "focusing", "on", "hostname", "validation", ".", "*", "/", "@", "Category", "(", "{", "MembershipTest", ".", "class", "}", ")", "@", "RunWith", "(", "Parameterized", ".", "class", ")", "@", "Parameterized", ".", "UseParametersRunnerFactory", "(", "CategoryWithParameterizedRunnerFactory", ".", "class", ")", "public", "class", "SSLSocketHostNameVerificationIntegrationTest", "{", "@", "Parameter", "public", "boolean", "addCertificateSAN", ";", "@", "Parameter", "(", "1", ")", "public", "boolean", "doEndPointIdentification", ";", "@", "Parameters", "(", "name", "=", "\"", "hasSAN", "=", "{", "0", "}", "and", "doEndPointIdentification", "=", "{", "1", "}", "\")", "public", "static", "Iterable", "<", "Boolean", "[", "]>", "addCertificateOrNot", "(", ")", "{", "return", "Arrays", ".", "asList", "(", "new", "Boolean", "[", "]", "{", "Boolean", ".", "TRUE", ",", "Boolean", ".", "TRUE", "}", ",", "new", "Boolean", "[", "]", "{", "Boolean", ".", "TRUE", ",", "Boolean", ".", "FALSE", "}", ",", "new", "Boolean", "[", "]", "{", "Boolean", ".", "FALSE", ",", "Boolean", ".", "TRUE", "}", ",", "new", "Boolean", "[", "]", "{", "Boolean", ".", "FALSE", ",", "Boolean", ".", "FALSE", "}", ");", "}", "private", "DistributionConfig", "distributionConfig", ";", "private", "SocketCreator", "socketCreator", ";", "private", "InetAddress", "localHost", ";", "private", "Thread", "serverThread", ";", "private", "ServerSocket", "serverSocket", ";", "private", "Socket", "clientSocket", ";", "@", "Rule", "public", "ErrorCollector", "errorCollector", "=", "new", "ErrorCollector", "(", ");", "@", "Rule", "public", "RestoreSystemProperties", "restoreSystemProperties", "=", "new", "RestoreSystemProperties", "(", ");", "@", "Rule", "public", "TestName", "testName", "=", "new", "TestName", "(", ");", "private", "Throwable", "serverException", ";", "@", "Before", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "IgnoredException", ".", "addIgnoredException", "(", "\"", "javax", ".", "net", ".", "ssl", ".", "SSLException", ":", "Read", "timed", "out", "\"", ");", "this", ".", "localHost", "=", "InetAddress", ".", "getLoopbackAddress", "(", ");", "TestSSLUtils", ".", "CertificateBuilder", "certBuilder", "=", "new", "TestSSLUtils", ".", "CertificateBuilder", "(", ")", ".", "commonName", "(", "\"", "iAmTheServer", "\"", ");", "if", "(", "addCertificateSAN", ")", "{", "certBuilder", ".", "sanDnsName", "(", "this", ".", "localHost", ".", "getHostName", "(", "))", ";", "}", "CertStores", "certStores", "=", "CertStores", ".", "locatorStore", "(", ");", "certStores", ".", "withCertificate", "(", "certBuilder", ")", ";", "certStores", ".", "trustSelf", "(", ");", "this", ".", "distributionConfig", "=", "new", "DistributionConfigImpl", "(", "certStores", ".", "propertiesWith", "(", "\"", "cluster", "\"", ",", "false", ",", "doEndPointIdentification", ")", ");", "SocketCreatorFactory", ".", "setDistributionConfig", "(", "this", ".", "distributionConfig", ")", ";", "this", ".", "socketCreator", "=", "SocketCreatorFactory", ".", "getSocketCreatorForComponent", "(", "CLUSTER", ")", ";", "}", "@", "After", "public", "void", "tearDown", "(", ")", "throws", "Exception", "{", "if", "(", "this", ".", "clientSocket", "!", "=", "null", ")", "{", "this", ".", "clientSocket", ".", "close", "(", ");", "}", "if", "(", "this", ".", "serverSocket", "!", "=", "null", ")", "{", "this", ".", "serverSocket", ".", "close", "(", ");", "}", "if", "(", "this", ".", "serverThread", "!", "=", "null", "&", "&", "this", ".", "serverThread", ".", "isAlive", "(", "))", "{", "this", ".", "serverThread", ".", "interrupt", "(", ");", "}", "SocketCreatorFactory", ".", "close", "(", ");", "}", "@", "Test", "public", "void", "nioHandshakeValidatesHostName", "(", ")", "throws", "Exception", "{", "ServerSocketChannel", "serverChannel", "=", "ServerSocketChannel", ".", "open", "(", ");", "this", ".", "serverSocket", "=", "serverChannel", ".", "socket", "(", ");", "InetSocketAddress", "addr", "=", "new", "InetSocketAddress", "(", "localHost", ",", "0", ")", ";", "serverSocket", ".", "bind", "(", "addr", ",", "10", ")", ";", "int", "serverPort", "=", "this", ".", "serverSocket", ".", "getLocalPort", "(", ");", "this", ".", "serverThread", "=", "startServerNIO", "(", "serverSocket", ",", "15000", ")", ";", "await", "(", ").", "until", "(", "()", "-", ">", "serverThread", ".", "isAlive", "(", "))", ";", "SocketChannel", "clientChannel", "=", "SocketChannel", ".", "open", "(", ");", "await", "(", ").", "until", "(", "(", ")", "-", ">", "clientChannel", ".", "connect", "(", "new", "InetSocketAddress", "(", "localHost", ",", "serverPort", ")", "))", ";", "this", ".", "clientSocket", "=", "clientChannel", ".", "socket", "(", ");", "SSLEngine", "sslEngine", "=", "this", ".", "socketCreator", ".", "createSSLEngine", "(", "this", ".", "localHost", ".", "getHostName", "(", "),", "1234", ")", ";", "try", "{", "this", ".", "socketCreator", ".", "handshakeSSLSocketChannel", "(", "clientSocket", ".", "getChannel", "(", "),", "sslEngine", ",", "0", ",", "true", ",", "ByteBuffer", ".", "allocate", "(", "500", ")", ",", "new", "BufferPool", "(", "mock", "(", "DMStats", ".", "class", ")", "))", ";", "if", "(", "doEndPointIdentification", "&", "&", "!", "addCertificateSAN", ")", "{", "fail", "(", "\"", "Failed", "to", "validate", "hostname", "in", "certificate", "SAN", "\"", ");", "}", "else", "{", "assertNull", "(", "serverException", ")", ";", "}", "}", "catch", "(", "SSLHandshakeException", "sslException", ")", "{", "if", "(", "doEndPointIdentification", "&", "&", "!", "addCertificateSAN", ")", "{", "assertThat", "(", "sslException", ")", ".", "hasRootCauseInstanceOf", "(", "CertificateException", ".", "class", ")", ".", "hasStackTraceContaining", "(", "\"", "No", "name", "matching", "\"", "+", "this", ".", "localHost", ".", "getHostName", "(", ")", "+", "\"", "found", "\"", ");", "}", "else", "{", "assertThat", "(", "sslException", ")", ".", "doesNotHaveSameClassAs", "(", "new", "CertificateException", "(", "\"", "No", "name", "matching", "\"", "+", "this", ".", "localHost", ".", "getHostName", "(", ")", "+", "\"", "found", "\"", "))", ";", "throw", "sslException", ";", "}", "}", "}", "private", "Thread", "startServerNIO", "(", "final", "ServerSocket", "serverSocket", ",", "int", "timeoutMillis", ")", "{", "Thread", "serverThread", "=", "new", "Thread", "(", "new", "MyThreadGroup", "(", "this", ".", "testName", ".", "getMethodName", "(", "))", ",", "(", ")", "-", ">", "{", "NioSslEngine", "engine", "=", "null", ";", "Socket", "socket", "=", "null", ";", "try", "{", "socket", "=", "serverSocket", ".", "accept", "(", ");", "SocketCreator", "sc", "=", "SocketCreatorFactory", ".", "getSocketCreatorForComponent", "(", "CLUSTER", ")", ";", "engine", "=", "sc", ".", "handshakeSSLSocketChannel", "(", "socket", ".", "getChannel", "(", "),", "sc", ".", "createSSLEngine", "(", "this", ".", "localHost", ".", "getHostName", "(", "),", "1234", ")", ",", "timeoutMillis", ",", "false", ",", "ByteBuffer", ".", "allocate", "(", "500", ")", ",", "new", "BufferPool", "(", "mock", "(", "DMStats", ".", "class", ")", "))", ";", "}", "catch", "(", "Throwable", "throwable", ")", "{", "serverException", "=", "throwable", ";", "}", "finally", "{", "if", "(", "engine", "!", "=", "null", "&", "&", "socket", "!", "=", "null", ")", "{", "final", "NioSslEngine", "nioSslEngine", "=", "engine", ";", "engine", ".", "close", "(", "socket", ".", "getChannel", "(", "))", ";", "assertThatThrownBy", "(", "()", "-", ">", "{", "nioSslEngine", ".", "unwrap", "(", "ByteBuffer", ".", "wrap", "(", "new", "byte", "[", "0", "]", "))", ";", "}", ")", ".", "isInstanceOf", "(", "IllegalStateException", ".", "class", ")", ";", "}", "}", "}", ",", "this", ".", "testName", ".", "getMethodName", "(", ")", "+", "\"", "-", "server", "\"", ");", "serverThread", ".", "start", "(", ");", "return", "serverThread", ";", "}", "private", "class", "MyThreadGroup", "extends", "ThreadGroup", "{", "public", "MyThreadGroup", "(", "final", "String", "name", ")", "{", "super", "(", "name", ")", ";", "}", "@", "Override", "public", "void", "uncaughtException", "(", "final", "Thread", "thread", ",", "final", "Throwable", "throwable", ")", "{", "errorCollector", ".", "addError", "(", "throwable", ")", ";", "}", "}", "}", "@", "@", "-", "933", ",", "6", "+", "933", ",", "14", "@", "@", "public", "NioSslEngine", "handshakeSSLSocketChannel", "(", "SocketChannel", "socketChannel", ",", "SSLEn", "BufferPool", "bufferPool", ")", "throws", "IOException", "{", "engine", ".", "setUseClientMode", "(", "clientSocket", ")", ";", "if", "(", "!", "clientSocket", ")", "{", "engine", ".", "setNeedClientAuth", "(", "sslConfig", ".", "isRequireAuth", "(", "))", ";", "}", "if", "(", "clientSocket", ")", "{", "SSLParameters", "modifiedParams", "=", "checkAndEnableHostnameValidation", "(", "engine", ".", "getSSLParameters", "(", "))", ";", "engine", ".", "setSSLParameters", "(", "modifiedParams", ")", ";", "}", "while", "(", "!", "socketChannel", ".", "finishConnect", "(", "))", "{", "try", "{", "Thread", ".", "sleep", "(", "50", ")", ";", "@", "@", "-", "976", ",", "6", "+", "984", ",", "20", "@", "@", "public", "NioSslEngine", "handshakeSSLSocketChannel", "(", "SocketChannel", "socketChannel", ",", "SSLEn", "return", "nioSslEngine", ";", "}", "private", "SSLParameters", "checkAndEnableHostnameValidation", "(", "SSLParameters", "sslParameters", ")", "{", "if", "(", "sslConfig", ".", "doEndpointIdentification", "(", "))", "{", "sslParameters", ".", "setEndpointIdentificationAlgorithm", "(", "\"", "HTTPS", "\"", ");", "}", "else", "{", "if", "(", "!", "hostnameValidationDisabledLogShown", ")", "{", "logger", ".", "info", "(", "\"", "Your", "SSL", "configuration", "disables", "hostname", "validation", ".", "\"", "+", "\"", "ssl", "-", "endpoint", "-", "identification", "-", "enabled", "should", "be", "set", "to", "true", "when", "SSL", "is", "enabled", ".", "\"", "+", "\"", "Please", "refer", "to", "the", "Apache", "GEODE", "SSL", "Documentation", "for", "SSL", "Property", ":", "ssl", "\u2011", "endpoint", "\u2011", "identification", "\u2011", "enabled", "\"", ");", "hostnameValidationDisabledLogShown", "=", "true", ";", "}", "}", "return", "sslParameters", ";", "}", "/", "**", "*", "Use", "this", "method", "to", "perform", "the", "SSL", "handshake", "on", "a", "newly", "accepted", "socket", ".", "Non", "-", "SSL", "*", "sockets", "are", "ignored", "by", "this", "method", ".", "@", "@", "-", "1052", ",", "18", "+", "1074", ",", "9", "@", "@", "private", "void", "configureClientSSLSocket", "(", "Socket", "socket", ",", "int", "timeout", ")", "throws", "IOExcep", "sslSocket", ".", "setUseClientMode", "(", "true", ")", ";", "sslSocket", ".", "setEnableSessionCreation", "(", "true", ")", ";", "if", "(", "sslConfig", ".", "doEndpointIdentification", "(", "))", "{", "SSLParameters", "sslParameters", "=", "sslSocket", ".", "getSSLParameters", "(", ");", "sslParameters", ".", "setEndpointIdentificationAlgorithm", "(", "\"", "HTTPS", "\"", ");", "sslSocket", ".", "setSSLParameters", "(", "sslParameters", ")", ";", "}", "else", "{", "if", "(", "!", "hostnameValidationDisabledLogShown", ")", "{", "logger", ".", "info", "(", "\"", "Your", "SSL", "configuration", "disables", "hostname", "validation", ".", "\"", "+", "\"", "ssl", "-", "endpoint", "-", "identification", "-", "enabled", "should", "be", "set", "to", "true", "when", "SSL", "is", "enabled", ".", "\"", "+", "\"", "Please", "refer", "to", "the", "Apache", "GEODE", "SSL", "Documentation", "for", "SSL", "Property", ":", "ssl", "\u2011", "endpoint", "\u2011", "identification", "\u2011", "enabled", "\"", ");", "hostnameValidationDisabledLogShown", "=", "true", ";", "}", "}", "SSLParameters", "modifiedParams", "=", "checkAndEnableHostnameValidation", "(", "sslSocket", ".", "getSSLParameters", "(", "))", ";", "sslSocket", ".", "setSSLParameters", "(", "modifiedParams", ")", ";", "String", "[", "]", "protocols", "=", "this", ".", "sslConfig", ".", "getProtocolsAsStringArray", "(", ");", "@", "@", "-", "15", ",", "7", "+", "15", ",", "6", "@", "@", "package", "org", ".", "apache", ".", "geode", ".", "internal", ".", "tcp", ";", "import", "static", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "ConfigurationProperties", ".", "SECURITY_PEER_AUTH_INIT", ";", "import", "static", "org", ".", "apache", ".", "geode", ".", "internal", ".", "net", ".", "SSLConfigurationFactory", ".", "getSSLConfigForComponent", ";", "import", "java", ".", "io", ".", "DataInputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "@", "@", "-", "81", ",", "7", "+", "80", ",", "6", "@", "@", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "net", ".", "NioFilter", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "net", ".", "NioPlainEngine", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "net", ".", "SocketCreator", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "security", ".", "SecurableCommunicationChannel", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "tcp", ".", "MsgReader", ".", "Header", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "util", ".", "concurrent", ".", "ReentrantSemaphore", ";", "@", "@", "-", "1834", ",", "11", "+", "1832", ",", "6", "@", "@", "private", "void", "createIoFilter", "(", "SocketChannel", "channel", ",", "boolean", "clientSocket", ")", "throws", "SSLEngine", "engine", "=", "getConduit", "(", ").", "getSocketCreator", "(", ").", "createSSLEngine", "(", "address", ".", "getHostName", "(", "),", "address", ".", "getPort", "(", "))", ";", "if", "(", "!", "clientSocket", ")", "{", "engine", ".", "setNeedClientAuth", "(", "getSSLConfigForComponent", "(", "getConduit", "(", ").", "config", ",", "SecurableCommunicationChannel", ".", "CLUSTER", ")", ".", "isRequireAuth", "(", "))", ";", "}", "int", "packetBufferSize", "=", "engine", ".", "getSession", "(", ").", "getPacketBufferSize", "(", ");", "if", "(", "inputBuffer", "=", "=", "null", "|", "|", "(", "inputBuffer", ".", "capacity", "(", ")", "<", "packetBufferSize", ")", ")", "{"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["avformat/aadec:", "Check", "for", "EOF", "while", "reading", "chapters", "Fixes:", "timeout", "Fixes:", "28199/clusterfuzz-testcase-minimized-ffmpeg_dem_AA_fuzzer-4896162657861632", "Found-by:", "continuous", "fuzzing", "process", "https://github.com/google/oss-fuzz/tree/master/projects/ffmpeg", "Signed-off-by:", "Michael", "Niedermayer", "<michael@niedermayer.cc>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Normalize", "resource", "URL", "in", "ResourceServlet", "Issue:", "SPR-14946"], "code_tokens": ["@", "@", "-", "270", ",", "18", "+", "270", ",", "18", "@", "@", "private", "void", "doInclude", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ",", "if", "(", "this", ".", "contentType", "!", "=", "null", ")", "{", "response", ".", "setContentType", "(", "this", ".", "contentType", ")", ";", "}", "String", "[", "]", "resourceUrls", "=", "StringUtils", ".", "tokenizeToStringArray", "(", "resourceUrl", ",", "RESOURCE_URL_DELIMITERS", ")", ";", "for", "(", "String", "url", ":", "resourceUrls", ")", "{", "String", "path", "=", "StringUtils", ".", "cleanPath", "(", "url", ")", ";", "/", "/", "Check", "whether", "URL", "matches", "allowed", "resources", "if", "(", "this", ".", "allowedResources", "!", "=", "null", "&", "&", "!", "this", ".", "pathMatcher", ".", "match", "(", "this", ".", "allowedResources", ",", "url", ")", ")", "{", "throw", "new", "ServletException", "(", "\"", "Resource", "[", "\"", "+", "url", "+", "if", "(", "this", ".", "allowedResources", "!", "=", "null", "&", "&", "!", "this", ".", "pathMatcher", ".", "match", "(", "this", ".", "allowedResources", ",", "path", ")", ")", "{", "throw", "new", "ServletException", "(", "\"", "Resource", "[", "\"", "+", "path", "\"", "]", "does", "not", "match", "allowed", "pattern", "[", "\"", "+", "this", ".", "allowedResources", "+", "\"", "]\"", ");", "}", "if", "(", "logger", ".", "isDebugEnabled", "(", "))", "{", "logger", ".", "debug", "(", "\"", "Including", "resource", "[", "\"", "+", "url", "+", "\"", "]\"", ");", "logger", ".", "debug", "(", "\"", "Including", "resource", "[", "\"", "+", "path", "+", "\"", "]\"", ");", "}", "RequestDispatcher", "rd", "=", "request", ".", "getRequestDispatcher", "(", "url", ")", ";", "RequestDispatcher", "rd", "=", "request", ".", "getRequestDispatcher", "(", "path", ")", ";", "rd", ".", "include", "(", "request", ",", "response", ")", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "61", "@", "@", "/", "*", "*", "Copyright", "2002", "-", "2016", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "springframework", ".", "web", ".", "servlet", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "javax", ".", "servlet", ".", "ServletException", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "springframework", ".", "mock", ".", "web", ".", "test", ".", "MockHttpServletRequest", ";", "import", "org", ".", "springframework", ".", "mock", ".", "web", ".", "test", ".", "MockHttpServletResponse", ";", "import", "org", ".", "springframework", ".", "mock", ".", "web", ".", "test", ".", "MockServletConfig", ";", "/", "**", "*", "@", "author", "Rossen", "Stoyanchev", "*", "/", "public", "class", "ResourceServletTests", "{", "@", "Test", "(", "expected", "=", "ServletException", ".", "class", ")", "public", "void", "example1", "(", ")", "throws", "Exception", "{", "testInvalidResourceUrl", "(", "\"/", "resources", "/", "**", "\",", "\"", "/", "resources", "/", "..", "/", "WEB", "-", "INF", "/", "web", ".", "xml", "\"", ");", "}", "@", "Test", "(", "expected", "=", "ServletException", ".", "class", ")", "public", "void", "example2", "(", ")", "throws", "Exception", "{", "testInvalidResourceUrl", "(", "\"/", "resources", "/", "*\"", ",", "\"", "/", "resources", "/", "..", "\\\\", "WEB", "-", "INF", "\\", "\\", "web", ".", "xml", "\"", ");", "}", "@", "Test", "(", "expected", "=", "ServletException", ".", "class", ")", "public", "void", "example3", "(", ")", "throws", "Exception", "{", "testInvalidResourceUrl", "(", "\"/", "resources", "/", "*\"", ",", "\"", "/", "resources", "/", "..", "\\\\", "Servlet2", "?", "param", "=", "111", "\"", ");", "}", "private", "void", "testInvalidResourceUrl", "(", "String", "allowedResources", ",", "String", "resourceParam", ")", "throws", "ServletException", ",", "IOException", "{", "ResourceServlet", "servlet", "=", "new", "ResourceServlet", "(", ");", "servlet", ".", "setAllowedResources", "(", "allowedResources", ")", ";", "servlet", ".", "init", "(", "new", "MockServletConfig", "(", "))", ";", "MockHttpServletRequest", "request", "=", "new", "MockHttpServletRequest", "(", "\"", "GET", "\"", ",", "\"", "/\"", ");", "request", ".", "addParameter", "(", "\"", "resource", "\"", ",", "resourceParam", ")", ";", "MockHttpServletResponse", "response", "=", "new", "MockHttpServletResponse", "(", ");", "servlet", ".", "service", "(", "request", ",", "response", ")", ";", "}", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["[NETFILTER]:", "iptables", "32bit", "compat", "layer", "This", "patch", "extends", "current", "iptables", "compatibility", "layer", "in", "order", "to", "get", "32bit", "iptables", "to", "work", "on", "64bit", "kernel.", "Current", "layer", "is", "insufficient", "due", "to", "alignment", "checks", "both", "in", "kernel", "and", "user", "space", "tools.", "Patch", "is", "for", "current", "net-2.6.17", "with", "addition", "of", "move", "of", "ipt_entry_{match|", "target}", "definitions", "to", "xt_entry_{match|target}.", "Signed-off-by:", "Dmitry", "Mishin", "<dim@openvz.org>", "Acked-off-by:", "Kirill", "Korotaev", "<dev@openvz.org>", "Signed-off-by:", "Patrick", "McHardy", "<kaber@trash.net>", "Signed-off-by:", "David", "S.", "Miller", "<davem@davemloft.net>"], "code_tokens": ["@", "@", "-", "142", ",", "6", "+", "142", ",", "12", "@", "@", "struct", "xt_counters_info", "#", "define", "ASSERT_WRITE_LOCK", "(", "x", ")", "#", "include", "<", "linux", "/", "netfilter_ipv4", "/", "listhelp", ".", "h", ">", "#", "ifdef", "CONFIG_COMPAT", "#", "define", "COMPAT_TO_USER", "1", "#", "define", "COMPAT_FROM_USER", "-", "1", "#", "define", "COMPAT_CALC_SIZE", "0", "#", "endif", "struct", "xt_match", "{", "struct", "list_head", "list", ";", "@", "@", "-", "175", ",", "6", "+", "181", ",", "9", "@", "@", "struct", "xt_match", "void", "(", "*", "destroy", ")", "(", "const", "struct", "xt_match", "*", "match", ",", "void", "*", "matchinfo", ",", "unsigned", "int", "matchinfosize", ")", ";", "/", "*", "Called", "when", "userspace", "align", "differs", "from", "kernel", "space", "one", "*", "/", "int", "(", "*", "compat", ")", "(", "void", "*", "match", ",", "void", "*", "*", "dstptr", ",", "int", "*", "size", ",", "int", "convert", ")", ";", "/", "*", "Set", "this", "to", "THIS_MODULE", "if", "you", "are", "a", "module", ",", "otherwise", "NULL", "*", "/", "struct", "module", "*", "me", ";", "@", "@", "-", "220", ",", "6", "+", "229", ",", "9", "@", "@", "struct", "xt_target", "void", "(", "*", "destroy", ")", "(", "const", "struct", "xt_target", "*", "target", ",", "void", "*", "targinfo", ",", "unsigned", "int", "targinfosize", ")", ";", "/", "*", "Called", "when", "userspace", "align", "differs", "from", "kernel", "space", "one", "*", "/", "int", "(", "*", "compat", ")", "(", "void", "*", "target", ",", "void", "*", "*", "dstptr", ",", "int", "*", "size", ",", "int", "convert", ")", ";", "/", "*", "Set", "this", "to", "THIS_MODULE", "if", "you", "are", "a", "module", ",", "otherwise", "NULL", "*", "/", "struct", "module", "*", "me", ";", "@", "@", "-", "314", ",", "6", "+", "326", ",", "61", "@", "@", "extern", "void", "xt_proto_fini", "(", "int", "af", ")", ";", "extern", "struct", "xt_table_info", "*", "xt_alloc_table_info", "(", "unsigned", "int", "size", ")", ";", "extern", "void", "xt_free_table_info", "(", "struct", "xt_table_info", "*", "info", ")", ";", "#", "ifdef", "CONFIG_COMPAT", "#", "include", "<", "net", "/", "compat", ".", "h", ">", "struct", "compat_xt_entry_match", "{", "union", "{", "struct", "{", "u_int16_t", "match_size", ";", "char", "name", "[", "XT_FUNCTION_MAXNAMELEN", "-", "1", "]", ";", "u_int8_t", "revision", ";", "}", "user", ";", "u_int16_t", "match_size", ";", "}", "u", ";", "unsigned", "char", "data", "[", "0", "]", ";", "}", ";", "struct", "compat_xt_entry_target", "{", "union", "{", "struct", "{", "u_int16_t", "target_size", ";", "char", "name", "[", "XT_FUNCTION_MAXNAMELEN", "-", "1", "]", ";", "u_int8_t", "revision", ";", "}", "user", ";", "u_int16_t", "target_size", ";", "}", "u", ";", "unsigned", "char", "data", "[", "0", "]", ";", "}", ";", "/", "*", "FIXME", ":", "this", "works", "only", "on", "32", "bit", "tasks", "*", "need", "to", "change", "whole", "approach", "in", "order", "to", "calculate", "align", "as", "function", "of", "*", "current", "task", "alignment", "*", "/", "struct", "compat_xt_counters", "{", "u_int32_t", "cnt", "[", "4", "]", ";", "}", ";", "struct", "compat_xt_counters_info", "{", "char", "name", "[", "XT_TABLE_MAXNAMELEN", "]", ";", "compat_uint_t", "num_counters", ";", "struct", "compat_xt_counters", "counters", "[", "0", "]", ";", "}", ";", "#", "define", "COMPAT_XT_ALIGN", "(", "s", ")", "(", "((", "s", ")", "+", "(", "__alignof__", "(", "struct", "compat_xt_counters", ")", "-", "1", ")", ")", "\\", "&", "~", "(", "__alignof__", "(", "struct", "compat_xt_counters", ")", "-", "1", ")", ")", "extern", "void", "xt_compat_lock", "(", "int", "af", ")", ";", "extern", "void", "xt_compat_unlock", "(", "int", "af", ")", ";", "extern", "int", "xt_compat_match", "(", "void", "*", "match", ",", "void", "*", "*", "dstptr", ",", "int", "*", "size", ",", "int", "convert", ")", ";", "extern", "int", "xt_compat_target", "(", "void", "*", "target", ",", "void", "*", "*", "dstptr", ",", "int", "*", "size", ",", "int", "convert", ")", ";", "#", "endif", "/", "*", "CONFIG_COMPAT", "*", "/", "#", "endif", "/", "*", "__KERNEL__", "*", "/", "#", "endif", "/", "*", "_X_TABLES_H", "*", "/", "@", "@", "-", "316", ",", "5", "+", "316", ",", "23", "@", "@", "extern", "unsigned", "int", "ipt_do_table", "(", "struct", "sk_buff", "*", "*", "pskb", ",", "void", "*", "userdata", ")", ";", "#", "define", "IPT_ALIGN", "(", "s", ")", "XT_ALIGN", "(", "s", ")", "#", "ifdef", "CONFIG_COMPAT", "#", "include", "<", "net", "/", "compat", ".", "h", ">", "struct", "compat_ipt_entry", "{", "struct", "ipt_ip", "ip", ";", "compat_uint_t", "nfcache", ";", "u_int16_t", "target_offset", ";", "u_int16_t", "next_offset", ";", "compat_uint_t", "comefrom", ";", "struct", "compat_xt_counters", "counters", ";", "unsigned", "char", "elems", "[", "0", "]", ";", "}", ";", "#", "define", "COMPAT_IPT_ALIGN", "(", "s", ")", "COMPAT_XT_ALIGN", "(", "s", ")", "#", "endif", "/", "*", "CONFIG_COMPAT", "*", "/", "#", "endif", "/", "*", "__KERNEL__", "*", "/", "#", "endif", "/", "*", "_IPTABLES_H", "*", "/", "@", "@", "-", "476", ",", "8", "+", "476", ",", "7", "@", "@", "asmlinkage", "long", "compat_sys_setsockopt", "(", "int", "fd", ",", "int", "level", ",", "int", "optname", ",", "int", "err", ";", "struct", "socket", "*", "sock", ";", "/", "*", "SO_SET_REPLACE", "seems", "to", "be", "the", "same", "in", "all", "levels", "*", "/", "if", "(", "optname", "=", "=", "IPT_SO_SET_REPLACE", ")", "if", "(", "level", "=", "=", "SOL_IPV6", "&", "&", "optname", "=", "=", "IPT_SO_SET_REPLACE", ")", "return", "do_netfilter_replace", "(", "fd", ",", "level", ",", "optname", ",", "optval", ",", "optlen", ")", ";", "@", "@", "-", "24", ",", "6", "+", "24", ",", "7", "@", "@", "#", "include", "<", "linux", "/", "module", ".", "h", ">", "#", "include", "<", "linux", "/", "icmp", ".", "h", ">", "#", "include", "<", "net", "/", "ip", ".", "h", ">", "#", "include", "<", "net", "/", "compat", ".", "h", ">", "#", "include", "<", "asm", "/", "uaccess", ".", "h", ">", "#", "include", "<", "linux", "/", "mutex", ".", "h", ">", "#", "include", "<", "linux", "/", "proc_fs", ".", "h", ">", "@", "@", "-", "799", ",", "17", "+", "800", ",", "11", "@", "@", "get_counters", "(", "const", "struct", "xt_table_info", "*", "t", ",", "}", "}", "static", "int", "copy_entries_to_user", "(", "unsigned", "int", "total_size", ",", "struct", "ipt_table", "*", "table", ",", "void", "__user", "*", "userptr", ")", "static", "inline", "struct", "xt_counters", "*", "alloc_counters", "(", "struct", "ipt_table", "*", "table", ")", "{", "unsigned", "int", "off", ",", "num", ",", "countersize", ";", "struct", "ipt_entry", "*", "e", ";", "unsigned", "int", "countersize", ";", "struct", "xt_counters", "*", "counters", ";", "struct", "xt_table_info", "*", "private", "=", "table", "-", ">", "private", ";", "int", "ret", "=", "0", ";", "void", "*", "loc_cpu_entry", ";", "/", "*", "We", "need", "atomic", "snapshot", "of", "counters", ":", "rest", "doesn", "'", "t", "change", "(", "other", "than", "comefrom", ",", "which", "userspace", "doesn", "'", "t", "care", "@", "@", "-", "818", ",", "13", "+", "813", ",", "32", "@", "@", "copy_entries_to_user", "(", "unsigned", "int", "total_size", ",", "counters", "=", "vmalloc_node", "(", "countersize", ",", "numa_node_id", "(", "))", ";", "if", "(", "counters", "=", "=", "NULL", ")", "return", "-", "ENOMEM", ";", "return", "ERR_PTR", "(", "-", "ENOMEM", ")", ";", "/", "*", "First", ",", "sum", "counters", ".", "..", "*", "/", "write_lock_bh", "(", "&", "table", "-", ">", "lock", ")", ";", "get_counters", "(", "private", ",", "counters", ")", ";", "write_unlock_bh", "(", "&", "table", "-", ">", "lock", ")", ";", "return", "counters", ";", "}", "static", "int", "copy_entries_to_user", "(", "unsigned", "int", "total_size", ",", "struct", "ipt_table", "*", "table", ",", "void", "__user", "*", "userptr", ")", "{", "unsigned", "int", "off", ",", "num", ";", "struct", "ipt_entry", "*", "e", ";", "struct", "xt_counters", "*", "counters", ";", "struct", "xt_table_info", "*", "private", "=", "table", "-", ">", "private", ";", "int", "ret", "=", "0", ";", "void", "*", "loc_cpu_entry", ";", "counters", "=", "alloc_counters", "(", "table", ")", ";", "if", "(", "IS_ERR", "(", "counters", ")", ")", "return", "PTR_ERR", "(", "counters", ")", ";", "/", "*", "choose", "the", "copy", "that", "is", "on", "our", "node", "/", "cpu", ",", ".", "..", "*", "This", "choice", "is", "lazy", "(", "because", "current", "thread", "is", "*", "allowed", "to", "migrate", "to", "another", "cpu", ")", "@", "@", "-", "884", ",", "44", "+", "898", ",", "899", "@", "@", "copy_entries_to_user", "(", "unsigned", "int", "total_size", ",", "return", "ret", ";", "}", "#", "ifdef", "CONFIG_COMPAT", "struct", "compat_delta", "{", "struct", "compat_delta", "*", "next", ";", "u_int16_t", "offset", ";", "short", "delta", ";", "}", ";", "static", "struct", "compat_delta", "*", "compat_offsets", "=", "NULL", ";", "static", "int", "compat_add_offset", "(", "u_int16_t", "offset", ",", "short", "delta", ")", "{", "struct", "compat_delta", "*", "tmp", ";", "tmp", "=", "kmalloc", "(", "sizeof", "(", "struct", "compat_delta", ")", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "tmp", ")", "return", "-", "ENOMEM", ";", "tmp", "-", ">", "offset", "=", "offset", ";", "tmp", "-", ">", "delta", "=", "delta", ";", "if", "(", "compat_offsets", ")", "{", "tmp", "-", ">", "next", "=", "compat_offsets", "-", ">", "next", ";", "compat_offsets", "-", ">", "next", "=", "tmp", ";", "}", "else", "{", "compat_offsets", "=", "tmp", ";", "tmp", "-", ">", "next", "=", "NULL", ";", "}", "return", "0", ";", "}", "static", "void", "compat_flush_offsets", "(", "void", ")", "{", "struct", "compat_delta", "*", "tmp", ",", "*", "next", ";", "if", "(", "compat_offsets", ")", "{", "for", "(", "tmp", "=", "compat_offsets", ";", "tmp", ";", "tmp", "=", "next", ")", "{", "next", "=", "tmp", "-", ">", "next", ";", "kfree", "(", "tmp", ")", ";", "}", "compat_offsets", "=", "NULL", ";", "}", "}", "static", "short", "compat_calc_jump", "(", "u_int16_t", "offset", ")", "{", "struct", "compat_delta", "*", "tmp", ";", "short", "delta", ";", "for", "(", "tmp", "=", "compat_offsets", ",", "delta", "=", "0", ";", "tmp", ";", "tmp", "=", "tmp", "-", ">", "next", ")", "if", "(", "tmp", "-", ">", "offset", "<", "offset", ")", "delta", "+", "=", "tmp", "-", ">", "delta", ";", "return", "delta", ";", "}", "struct", "compat_ipt_standard_target", "{", "struct", "compat_xt_entry_target", "target", ";", "compat_int_t", "verdict", ";", "}", ";", "#", "define", "IPT_ST_OFFSET", "(", "sizeof", "(", "struct", "ipt_standard_target", ")", "-", "\\", "sizeof", "(", "struct", "compat_ipt_standard_target", ")", ")", "struct", "compat_ipt_standard", "{", "struct", "compat_ipt_entry", "entry", ";", "struct", "compat_ipt_standard_target", "target", ";", "}", ";", "static", "int", "compat_ipt_standard_fn", "(", "void", "*", "target", ",", "void", "*", "*", "dstptr", ",", "int", "*", "size", ",", "int", "convert", ")", "{", "struct", "compat_ipt_standard_target", "compat_st", ",", "*", "pcompat_st", ";", "struct", "ipt_standard_target", "st", ",", "*", "pst", ";", "int", "ret", ";", "ret", "=", "0", ";", "switch", "(", "convert", ")", "{", "case", "COMPAT_TO_USER", ":", "pst", "=", "(", "struct", "ipt_standard_target", "*", ")", "target", ";", "memcpy", "(", "&", "compat_st", ".", "target", ",", "&", "pst", "-", ">", "target", ",", "sizeof", "(", "struct", "ipt_entry_target", ")", ");", "compat_st", ".", "verdict", "=", "pst", "-", ">", "verdict", ";", "if", "(", "compat_st", ".", "verdict", ">", "0", ")", "compat_st", ".", "verdict", "-", "=", "compat_calc_jump", "(", "compat_st", ".", "verdict", ")", ";", "compat_st", ".", "target", ".", "u", ".", "user", ".", "target_size", "=", "sizeof", "(", "struct", "compat_ipt_standard_target", ")", ";", "if", "(", "__copy_to_user", "(", "*", "dstptr", ",", "&", "compat_st", ",", "sizeof", "(", "struct", "compat_ipt_standard_target", ")", "))", "ret", "=", "-", "EFAULT", ";", "*", "size", "-", "=", "IPT_ST_OFFSET", ";", "*", "dstptr", "+", "=", "sizeof", "(", "struct", "compat_ipt_standard_target", ")", ";", "break", ";", "case", "COMPAT_FROM_USER", ":", "pcompat_st", "=", "(", "struct", "compat_ipt_standard_target", "*", ")", "target", ";", "memcpy", "(", "&", "st", ".", "target", ",", "&", "pcompat_st", "-", ">", "target", ",", "sizeof", "(", "struct", "ipt_entry_target", ")", ");", "st", ".", "verdict", "=", "pcompat_st", "-", ">", "verdict", ";", "if", "(", "st", ".", "verdict", ">", "0", ")", "st", ".", "verdict", "+", "=", "compat_calc_jump", "(", "st", ".", "verdict", ")", ";", "st", ".", "target", ".", "u", ".", "user", ".", "target_size", "=", "sizeof", "(", "struct", "ipt_standard_target", ")", ";", "memcpy", "(", "*", "dstptr", ",", "&", "st", ",", "sizeof", "(", "struct", "ipt_standard_target", ")", ");", "*", "size", "+", "=", "IPT_ST_OFFSET", ";", "*", "dstptr", "+", "=", "sizeof", "(", "struct", "ipt_standard_target", ")", ";", "break", ";", "case", "COMPAT_CALC_SIZE", ":", "*", "size", "+", "=", "IPT_ST_OFFSET", ";", "break", ";", "default", ":", "ret", "=", "-", "ENOPROTOOPT", ";", "break", ";", "}", "return", "ret", ";", "}", "static", "inline", "int", "compat_calc_match", "(", "struct", "ipt_entry_match", "*", "m", ",", "int", "*", "size", ")", "{", "if", "(", "m", "-", ">", "u", ".", "kernel", ".", "match", "-", ">", "compat", ")", "m", "-", ">", "u", ".", "kernel", ".", "match", "-", ">", "compat", "(", "m", ",", "NULL", ",", "size", ",", "COMPAT_CALC_SIZE", ")", ";", "else", "xt_compat_match", "(", "m", ",", "NULL", ",", "size", ",", "COMPAT_CALC_SIZE", ")", ";", "return", "0", ";", "}", "static", "int", "compat_calc_entry", "(", "struct", "ipt_entry", "*", "e", ",", "struct", "xt_table_info", "*", "info", ",", "void", "*", "base", ",", "struct", "xt_table_info", "*", "newinfo", ")", "{", "struct", "ipt_entry_target", "*", "t", ";", "u_int16_t", "entry_offset", ";", "int", "off", ",", "i", ",", "ret", ";", "off", "=", "0", ";", "entry_offset", "=", "(", "void", "*", ")", "e", "-", "base", ";", "IPT_MATCH_ITERATE", "(", "e", ",", "compat_calc_match", ",", "&", "off", ")", ";", "t", "=", "ipt_get_target", "(", "e", ")", ";", "if", "(", "t", "-", ">", "u", ".", "kernel", ".", "target", "-", ">", "compat", ")", "t", "-", ">", "u", ".", "kernel", ".", "target", "-", ">", "compat", "(", "t", ",", "NULL", ",", "&", "off", ",", "COMPAT_CALC_SIZE", ")", ";", "else", "xt_compat_target", "(", "t", ",", "NULL", ",", "&", "off", ",", "COMPAT_CALC_SIZE", ")", ";", "newinfo", "-", ">", "size", "-", "=", "off", ";", "ret", "=", "compat_add_offset", "(", "entry_offset", ",", "off", ")", ";", "if", "(", "ret", ")", "return", "ret", ";", "for", "(", "i", "=", "0", ";", "i", "<", "NF_IP_NUMHOOKS", ";", "i", "+", "+)", "{", "if", "(", "info", "-", ">", "hook_entry", "[", "i", "]", "&", "&", "(", "e", "<", "(", "struct", "ipt_entry", "*", ")", "(", "base", "+", "info", "-", ">", "hook_entry", "[", "i", "]", "))", ")", "newinfo", "-", ">", "hook_entry", "[", "i", "]", "-", "=", "off", ";", "if", "(", "info", "-", ">", "underflow", "[", "i", "]", "&", "&", "(", "e", "<", "(", "struct", "ipt_entry", "*", ")", "(", "base", "+", "info", "-", ">", "underflow", "[", "i", "]", "))", ")", "newinfo", "-", ">", "underflow", "[", "i", "]", "-", "=", "off", ";", "}", "return", "0", ";", "}", "static", "int", "compat_table_info", "(", "struct", "xt_table_info", "*", "info", ",", "struct", "xt_table_info", "*", "newinfo", ")", "{", "void", "*", "loc_cpu_entry", ";", "int", "i", ";", "if", "(", "!", "newinfo", "|", "|", "!", "info", ")", "return", "-", "EINVAL", ";", "memset", "(", "newinfo", ",", "0", ",", "sizeof", "(", "struct", "xt_table_info", ")", ");", "newinfo", "-", ">", "size", "=", "info", "-", ">", "size", ";", "newinfo", "-", ">", "number", "=", "info", "-", ">", "number", ";", "for", "(", "i", "=", "0", ";", "i", "<", "NF_IP_NUMHOOKS", ";", "i", "+", "+)", "{", "newinfo", "-", ">", "hook_entry", "[", "i", "]", "=", "info", "-", ">", "hook_entry", "[", "i", "]", ";", "newinfo", "-", ">", "underflow", "[", "i", "]", "=", "info", "-", ">", "underflow", "[", "i", "]", ";", "}", "loc_cpu_entry", "=", "info", "-", ">", "entries", "[", "raw_smp_processor_id", "(", ")]", ";", "return", "IPT_ENTRY_ITERATE", "(", "loc_cpu_entry", ",", "info", "-", ">", "size", ",", "compat_calc_entry", ",", "info", ",", "loc_cpu_entry", ",", "newinfo", ")", ";", "}", "#", "endif", "static", "int", "get_info", "(", "void", "__user", "*", "user", ",", "int", "*", "len", ",", "int", "compat", ")", "{", "char", "name", "[", "IPT_TABLE_MAXNAMELEN", "]", ";", "struct", "ipt_table", "*", "t", ";", "int", "ret", ";", "if", "(", "*", "len", "!", "=", "sizeof", "(", "struct", "ipt_getinfo", ")", ")", "{", "duprintf", "(", "\"", "length", "%", "u", "!", "=", "%", "u", "\\", "n", "\"", ",", "*", "len", ",", "(", "unsigned", "int", ")", "sizeof", "(", "struct", "ipt_getinfo", ")", ");", "return", "-", "EINVAL", ";", "}", "if", "(", "copy_from_user", "(", "name", ",", "user", ",", "sizeof", "(", "name", ")", ")", "!", "=", "0", ")", "return", "-", "EFAULT", ";", "name", "[", "IPT_TABLE_MAXNAMELEN", "-", "1", "]", "=", "'", "\\", "0", "'", ";", "#", "ifdef", "CONFIG_COMPAT", "if", "(", "compat", ")", "xt_compat_lock", "(", "AF_INET", ")", ";", "#", "endif", "t", "=", "try_then_request_module", "(", "xt_find_table_lock", "(", "AF_INET", ",", "name", ")", ",", "\"", "iptable_", "%", "s", "\"", ",", "name", ")", ";", "if", "(", "t", "&", "&", "!", "IS_ERR", "(", "t", ")", ")", "{", "struct", "ipt_getinfo", "info", ";", "struct", "xt_table_info", "*", "private", "=", "t", "-", ">", "private", ";", "#", "ifdef", "CONFIG_COMPAT", "if", "(", "compat", ")", "{", "struct", "xt_table_info", "tmp", ";", "ret", "=", "compat_table_info", "(", "private", ",", "&", "tmp", ")", ";", "compat_flush_offsets", "(", ");", "private", "=", "&", "tmp", ";", "}", "#", "endif", "info", ".", "valid_hooks", "=", "t", "-", ">", "valid_hooks", ";", "memcpy", "(", "info", ".", "hook_entry", ",", "private", "-", ">", "hook_entry", ",", "sizeof", "(", "info", ".", "hook_entry", ")", ");", "memcpy", "(", "info", ".", "underflow", ",", "private", "-", ">", "underflow", ",", "sizeof", "(", "info", ".", "underflow", ")", ");", "info", ".", "num_entries", "=", "private", "-", ">", "number", ";", "info", ".", "size", "=", "private", "-", ">", "size", ";", "strcpy", "(", "info", ".", "name", ",", "name", ")", ";", "if", "(", "copy_to_user", "(", "user", ",", "&", "info", ",", "*", "len", ")", "!", "=", "0", ")", "ret", "=", "-", "EFAULT", ";", "else", "ret", "=", "0", ";", "xt_table_unlock", "(", "t", ")", ";", "module_put", "(", "t", "-", ">", "me", ")", ";", "}", "else", "ret", "=", "t", "?", "PTR_ERR", "(", "t", ")", ":", "-", "ENOENT", ";", "#", "ifdef", "CONFIG_COMPAT", "if", "(", "compat", ")", "xt_compat_unlock", "(", "AF_INET", ")", ";", "#", "endif", "return", "ret", ";", "}", "static", "int", "get_entries", "(", "struct", "ipt_get_entries", "__user", "*", "uptr", ",", "int", "*", "len", ")", "{", "int", "ret", ";", "struct", "ipt_get_entries", "get", ";", "struct", "ipt_table", "*", "t", ";", "if", "(", "*", "len", "<", "sizeof", "(", "get", ")", ")", "{", "duprintf", "(", "\"", "get_entries", ":", "%", "u", "<", "%", "d", "\\", "n", "\"", ",", "*", "len", ",", "(", "unsigned", "int", ")", "sizeof", "(", "get", ")", ");", "return", "-", "EINVAL", ";", "}", "if", "(", "copy_from_user", "(", "&", "get", ",", "uptr", ",", "sizeof", "(", "get", ")", ")", "!", "=", "0", ")", "return", "-", "EFAULT", ";", "if", "(", "*", "len", "!", "=", "sizeof", "(", "struct", "ipt_get_entries", ")", "+", "get", ".", "size", ")", "{", "duprintf", "(", "\"", "get_entries", ":", "%", "u", "!", "=", "%", "u", "\\", "n", "\"", ",", "*", "len", ",", "(", "unsigned", "int", ")", "(", "sizeof", "(", "struct", "ipt_get_entries", ")", "get", ".", "size", ")", ");", "return", "-", "EINVAL", ";", "}", "t", "=", "xt_find_table_lock", "(", "AF_INET", ",", "get", ".", "name", ")", ";", "if", "(", "t", "&", "&", "!", "IS_ERR", "(", "t", ")", ")", "{", "struct", "xt_table_info", "*", "private", "=", "t", "-", ">", "private", ";", "duprintf", "(", "\"", "t", "-", ">", "private", "-", ">", "number", "=", "%", "u", "\\", "n", "\"", ",", "private", "-", ">", "number", ")", ";", "if", "(", "get", ".", "size", "=", "=", "private", "-", ">", "size", ")", "ret", "=", "copy_entries_to_user", "(", "private", "-", ">", "size", ",", "t", ",", "uptr", "-", ">", "entrytable", ")", ";", "else", "{", "duprintf", "(", "\"", "get_entries", ":", "I", "'", "ve", "got", "%", "u", "not", "%", "u", "!", "\\", "n", "\"", ",", "private", "-", ">", "size", ",", "get", ".", "size", ")", ";", "ret", "=", "-", "EINVAL", ";", "}", "module_put", "(", "t", "-", ">", "me", ")", ";", "xt_table_unlock", "(", "t", ")", ";", "}", "else", "ret", "=", "t", "?", "PTR_ERR", "(", "t", ")", ":", "-", "ENOENT", ";", "return", "ret", ";", "}", "static", "int", "__do_replace", "(", "const", "char", "*", "name", ",", "unsigned", "int", "valid_hooks", ",", "struct", "xt_table_info", "*", "newinfo", ",", "unsigned", "int", "num_counters", ",", "void", "__user", "*", "counters_ptr", ")", "{", "int", "ret", ";", "struct", "ipt_table", "*", "t", ";", "struct", "xt_table_info", "*", "oldinfo", ";", "struct", "xt_counters", "*", "counters", ";", "void", "*", "loc_cpu_old_entry", ";", "ret", "=", "0", ";", "counters", "=", "vmalloc", "(", "num_counters", "*", "sizeof", "(", "struct", "xt_counters", ")", ");", "if", "(", "!", "counters", ")", "{", "ret", "=", "-", "ENOMEM", ";", "goto", "out", ";", "}", "t", "=", "try_then_request_module", "(", "xt_find_table_lock", "(", "AF_INET", ",", "name", ")", ",", "\"", "iptable_", "%", "s", "\"", ",", "name", ")", ";", "if", "(", "!", "t", "|", "|", "IS_ERR", "(", "t", ")", ")", "{", "ret", "=", "t", "?", "PTR_ERR", "(", "t", ")", ":", "-", "ENOENT", ";", "goto", "free_newinfo_counters_untrans", ";", "}", "/", "*", "You", "lied", "!", "*", "/", "if", "(", "valid_hooks", "!", "=", "t", "-", ">", "valid_hooks", ")", "{", "duprintf", "(", "\"", "Valid", "hook", "crap", ":", "%", "08X", "vs", "%", "08X", "\\", "n", "\"", ",", "valid_hooks", ",", "t", "-", ">", "valid_hooks", ")", ";", "ret", "=", "-", "EINVAL", ";", "goto", "put_module", ";", "}", "oldinfo", "=", "xt_replace_table", "(", "t", ",", "num_counters", ",", "newinfo", ",", "&", "ret", ")", ";", "if", "(", "!", "oldinfo", ")", "goto", "put_module", ";", "/", "*", "Update", "module", "usage", "count", "based", "on", "number", "of", "rules", "*", "/", "duprintf", "(", "\"", "do_replace", ":", "oldnum", "=", "%", "u", ",", "initnum", "=", "%", "u", ",", "newnum", "=", "%", "u", "\\", "n", "\"", ",", "oldinfo", "-", ">", "number", ",", "oldinfo", "-", ">", "initial_entries", ",", "newinfo", "-", ">", "number", ")", ";", "if", "(", "(", "oldinfo", "-", ">", "number", ">", "oldinfo", "-", ">", "initial_entries", ")", "|", "|", "(", "newinfo", "-", ">", "number", "<", "=", "oldinfo", "-", ">", "initial_entries", ")", ")", "module_put", "(", "t", "-", ">", "me", ")", ";", "if", "(", "(", "oldinfo", "-", ">", "number", ">", "oldinfo", "-", ">", "initial_entries", ")", "&", "&", "(", "newinfo", "-", ">", "number", "<", "=", "oldinfo", "-", ">", "initial_entries", ")", ")", "module_put", "(", "t", "-", ">", "me", ")", ";", "/", "*", "Get", "the", "old", "counters", ".", "*", "/", "get_counters", "(", "oldinfo", ",", "counters", ")", ";", "/", "*", "Decrease", "module", "usage", "counts", "and", "free", "resource", "*", "/", "loc_cpu_old_entry", "=", "oldinfo", "-", ">", "entries", "[", "raw_smp_processor_id", "(", ")]", ";", "IPT_ENTRY_ITERATE", "(", "loc_cpu_old_entry", ",", "oldinfo", "-", ">", "size", ",", "cleanup_entry", ",", "NULL", ")", ";", "xt_free_table_info", "(", "oldinfo", ")", ";", "if", "(", "copy_to_user", "(", "counters_ptr", ",", "counters", ",", "sizeof", "(", "struct", "xt_counters", ")", "*", "num_counters", ")", "!", "=", "0", ")", "ret", "=", "-", "EFAULT", ";", "vfree", "(", "counters", ")", ";", "xt_table_unlock", "(", "t", ")", ";", "return", "ret", ";", "put_module", ":", "module_put", "(", "t", "-", ">", "me", ")", ";", "xt_table_unlock", "(", "t", ")", ";", "free_newinfo_counters_untrans", ":", "vfree", "(", "counters", ")", ";", "out", ":", "return", "ret", ";", "}", "static", "int", "do_replace", "(", "void", "__user", "*", "user", ",", "unsigned", "int", "len", ")", "{", "int", "ret", ";", "struct", "ipt_replace", "tmp", ";", "struct", "xt_table_info", "*", "newinfo", ";", "void", "*", "loc_cpu_entry", ";", "if", "(", "copy_from_user", "(", "&", "tmp", ",", "user", ",", "sizeof", "(", "tmp", ")", ")", "!", "=", "0", ")", "return", "-", "EFAULT", ";", "/", "*", "Hack", ":", "Causes", "ipchains", "to", "give", "correct", "error", "msg", "-", "-", "RR", "*", "/", "if", "(", "len", "!", "=", "sizeof", "(", "tmp", ")", "+", "tmp", ".", "size", ")", "return", "-", "ENOPROTOOPT", ";", "/", "*", "overflow", "check", "*", "/", "if", "(", "tmp", ".", "size", ">", "=", "(", "INT_MAX", "-", "sizeof", "(", "struct", "xt_table_info", ")", ")", "/", "NR_CPUS", "-", "SMP_CACHE_BYTES", ")", "return", "-", "ENOMEM", ";", "if", "(", "tmp", ".", "num_counters", ">", "=", "INT_MAX", "/", "sizeof", "(", "struct", "xt_counters", ")", ")", "return", "-", "ENOMEM", ";", "newinfo", "=", "xt_alloc_table_info", "(", "tmp", ".", "size", ")", ";", "if", "(", "!", "newinfo", ")", "return", "-", "ENOMEM", ";", "/", "*", "choose", "the", "copy", "that", "is", "our", "node", "/", "cpu", "*", "/", "loc_cpu_entry", "=", "newinfo", "-", ">", "entries", "[", "raw_smp_processor_id", "(", ")]", ";", "if", "(", "copy_from_user", "(", "loc_cpu_entry", ",", "user", "+", "sizeof", "(", "tmp", ")", ",", "tmp", ".", "size", ")", "!", "=", "0", ")", "{", "ret", "=", "-", "EFAULT", ";", "goto", "free_newinfo", ";", "}", "ret", "=", "translate_table", "(", "tmp", ".", "name", ",", "tmp", ".", "valid_hooks", ",", "newinfo", ",", "loc_cpu_entry", ",", "tmp", ".", "size", ",", "tmp", ".", "num_entries", ",", "tmp", ".", "hook_entry", ",", "tmp", ".", "underflow", ")", ";", "if", "(", "ret", "!", "=", "0", ")", "goto", "free_newinfo", ";", "duprintf", "(", "\"", "ip_tables", ":", "Translated", "table", "\\", "n", "\"", ");", "ret", "=", "__do_replace", "(", "tmp", ".", "name", ",", "tmp", ".", "valid_hooks", ",", "newinfo", ",", "tmp", ".", "num_counters", ",", "tmp", ".", "counters", ")", ";", "if", "(", "ret", ")", "goto", "free_newinfo_untrans", ";", "return", "0", ";", "free_newinfo_untrans", ":", "IPT_ENTRY_ITERATE", "(", "loc_cpu_entry", ",", "newinfo", "-", ">", "size", ",", "cleanup_entry", ",", "NULL", ")", ";", "free_newinfo", ":", "xt_free_table_info", "(", "newinfo", ")", ";", "return", "ret", ";", "}", "/", "*", "We", "'", "re", "lazy", ",", "and", "add", "to", "the", "first", "CPU", ";", "overflow", "works", "its", "fey", "magic", "*", "and", "everything", "is", "OK", ".", "*", "/", "static", "inline", "int", "add_counter_to_entry", "(", "struct", "ipt_entry", "*", "e", ",", "const", "struct", "xt_counters", "addme", "[", "],", "unsigned", "int", "*", "i", ")", "{", "#", "if", "0", "duprintf", "(", "\"", "add_counter", ":", "Entry", "%", "u", "%", "lu", "/", "%", "lu", "+", "%", "lu", "/", "%", "lu", "\\", "n", "\"", ",", "*", "i", ",", "(", "long", "unsigned", "int", ")", "e", "-", ">", "counters", ".", "pcnt", ",", "(", "long", "unsigned", "int", ")", "e", "-", ">", "counters", ".", "bcnt", ",", "(", "long", "unsigned", "int", ")", "addme", "[", "*", "i", "]", ".", "pcnt", ",", "(", "long", "unsigned", "int", ")", "addme", "[", "*", "i", "]", ".", "bcnt", ")", ";", "#", "endif", "ADD_COUNTER", "(", "e", "-", ">", "counters", ",", "addme", "[", "*", "i", "]", ".", "bcnt", ",", "addme", "[", "*", "i", "]", ".", "pcnt", ")", ";", "(", "*", "i", ")", "++", ";", "return", "0", ";", "}", "static", "int", "do_add_counters", "(", "void", "__user", "*", "user", ",", "unsigned", "int", "len", ",", "int", "compat", ")", "{", "unsigned", "int", "i", ";", "struct", "xt_counters_info", "tmp", ";", "struct", "xt_counters", "*", "paddc", ";", "unsigned", "int", "num_counters", ";", "char", "*", "name", ";", "int", "size", ";", "void", "*", "ptmp", ";", "struct", "ipt_table", "*", "t", ";", "struct", "xt_table_info", "*", "private", ";", "int", "ret", "=", "0", ";", "void", "*", "loc_cpu_entry", ";", "#", "ifdef", "CONFIG_COMPAT", "struct", "compat_xt_counters_info", "compat_tmp", ";", "if", "(", "compat", ")", "{", "ptmp", "=", "&", "compat_tmp", ";", "size", "=", "sizeof", "(", "struct", "compat_xt_counters_info", ")", ";", "}", "else", "#", "endif", "{", "ptmp", "=", "&", "tmp", ";", "size", "=", "sizeof", "(", "struct", "xt_counters_info", ")", ";", "}", "if", "(", "copy_from_user", "(", "ptmp", ",", "user", ",", "size", ")", "!", "=", "0", ")", "return", "-", "EFAULT", ";", "#", "ifdef", "CONFIG_COMPAT", "if", "(", "compat", ")", "{", "num_counters", "=", "compat_tmp", ".", "num_counters", ";", "name", "=", "compat_tmp", ".", "name", ";", "}", "else", "#", "endif", "{", "num_counters", "=", "tmp", ".", "num_counters", ";", "name", "=", "tmp", ".", "name", ";", "}", "if", "(", "len", "!", "=", "size", "+", "num_counters", "*", "sizeof", "(", "struct", "xt_counters", ")", ")", "return", "-", "EINVAL", ";", "paddc", "=", "vmalloc_node", "(", "len", "-", "size", ",", "numa_node_id", "(", "))", ";", "if", "(", "!", "paddc", ")", "return", "-", "ENOMEM", ";", "if", "(", "copy_from_user", "(", "paddc", ",", "user", "+", "size", ",", "len", "-", "size", ")", "!", "=", "0", ")", "{", "ret", "=", "-", "EFAULT", ";", "goto", "free", ";", "}", "t", "=", "xt_find_table_lock", "(", "AF_INET", ",", "name", ")", ";", "if", "(", "!", "t", "|", "|", "IS_ERR", "(", "t", ")", ")", "{", "ret", "=", "t", "?", "PTR_ERR", "(", "t", ")", ":", "-", "ENOENT", ";", "goto", "free", ";", "}", "write_lock_bh", "(", "&", "t", "-", ">", "lock", ")", ";", "private", "=", "t", "-", ">", "private", ";", "if", "(", "private", "-", ">", "number", "!", "=", "num_counters", ")", "{", "ret", "=", "-", "EINVAL", ";", "goto", "unlock_up_free", ";", "}", "i", "=", "0", ";", "/", "*", "Choose", "the", "copy", "that", "is", "on", "our", "node", "*", "/", "loc_cpu_entry", "=", "private", "-", ">", "entries", "[", "raw_smp_processor_id", "(", ")]", ";", "IPT_ENTRY_ITERATE", "(", "loc_cpu_entry", ",", "private", "-", ">", "size", ",", "add_counter_to_entry", ",", "paddc", ",", "&", "i", ")", ";", "unlock_up_free", ":", "write_unlock_bh", "(", "&", "t", "-", ">", "lock", ")", ";", "xt_table_unlock", "(", "t", ")", ";", "module_put", "(", "t", "-", ">", "me", ")", ";", "free", ":", "vfree", "(", "paddc", ")", ";", "return", "ret", ";", "}", "#", "ifdef", "CONFIG_COMPAT", "struct", "compat_ipt_replace", "{", "char", "name", "[", "IPT_TABLE_MAXNAMELEN", "]", ";", "u32", "valid_hooks", ";", "u32", "num_entries", ";", "u32", "size", ";", "u32", "hook_entry", "[", "NF_IP_NUMHOOKS", "]", ";", "u32", "underflow", "[", "NF_IP_NUMHOOKS", "]", ";", "u32", "num_counters", ";", "compat_uptr_t", "counters", ";", "/", "*", "struct", "ipt_counters", "*", "*", "/", "struct", "compat_ipt_entry", "entries", "[", "0", "]", ";", "}", ";", "static", "inline", "int", "compat_copy_match_to_user", "(", "struct", "ipt_entry_match", "*", "m", ",", "void", "__user", "*", "*", "dstptr", ",", "compat_uint_t", "*", "size", ")", "{", "if", "(", "m", "-", ">", "u", ".", "kernel", ".", "match", "-", ">", "compat", ")", "return", "m", "-", ">", "u", ".", "kernel", ".", "match", "-", ">", "compat", "(", "m", ",", "dstptr", ",", "size", ",", "COMPAT_TO_USER", ")", ";", "else", "return", "xt_compat_match", "(", "m", ",", "dstptr", ",", "size", ",", "COMPAT_TO_USER", ")", ";", "}", "static", "int", "compat_copy_entry_to_user", "(", "struct", "ipt_entry", "*", "e", ",", "void", "__user", "*", "*", "dstptr", ",", "compat_uint_t", "*", "size", ")", "{", "struct", "ipt_entry_target", "__user", "*", "t", ";", "struct", "compat_ipt_entry", "__user", "*", "ce", ";", "u_int16_t", "target_offset", ",", "next_offset", ";", "compat_uint_t", "origsize", ";", "int", "ret", ";", "ret", "=", "-", "EFAULT", ";", "origsize", "=", "*", "size", ";", "ce", "=", "(", "struct", "compat_ipt_entry", "__user", "*", ")*", "dstptr", ";", "if", "(", "__copy_to_user", "(", "ce", ",", "e", ",", "sizeof", "(", "struct", "ipt_entry", ")", "))", "goto", "out", ";", "*", "dstptr", "+", "=", "sizeof", "(", "struct", "compat_ipt_entry", ")", ";", "ret", "=", "IPT_MATCH_ITERATE", "(", "e", ",", "compat_copy_match_to_user", ",", "dstptr", ",", "size", ")", ";", "target_offset", "=", "e", "-", ">", "target_offset", "-", "(", "origsize", "-", "*", "size", ")", ";", "if", "(", "ret", ")", "goto", "out", ";", "t", "=", "ipt_get_target", "(", "e", ")", ";", "if", "(", "t", "-", ">", "u", ".", "kernel", ".", "target", "-", ">", "compat", ")", "ret", "=", "t", "-", ">", "u", ".", "kernel", ".", "target", "-", ">", "compat", "(", "t", ",", "dstptr", ",", "size", ",", "COMPAT_TO_USER", ")", ";", "else", "ret", "=", "xt_compat_target", "(", "t", ",", "dstptr", ",", "size", ",", "COMPAT_TO_USER", ")", ";", "if", "(", "ret", ")", "goto", "out", ";", "ret", "=", "-", "EFAULT", ";", "next_offset", "=", "e", "-", ">", "next_offset", "-", "(", "origsize", "-", "*", "size", ")", ";", "if", "(", "__put_user", "(", "target_offset", ",", "&", "ce", "-", ">", "target_offset", ")", ")", "goto", "out", ";", "if", "(", "__put_user", "(", "next_offset", ",", "&", "ce", "-", ">", "next_offset", ")", ")", "goto", "out", ";", "return", "0", ";", "out", ":", "return", "ret", ";", "}", "static", "inline", "int", "compat_check_calc_match", "(", "struct", "ipt_entry_match", "*", "m", ",", "const", "char", "*", "name", ",", "const", "struct", "ipt_ip", "*", "ip", ",", "unsigned", "int", "hookmask", ",", "int", "*", "size", ",", "int", "*", "i", ")", "{", "struct", "ipt_match", "*", "match", ";", "match", "=", "try_then_request_module", "(", "xt_find_match", "(", "AF_INET", ",", "m", "-", ">", "u", ".", "user", ".", "name", ",", "m", "-", ">", "u", ".", "user", ".", "revision", ")", ",", "\"", "ipt_", "%", "s", "\"", ",", "m", "-", ">", "u", ".", "user", ".", "name", ")", ";", "if", "(", "IS_ERR", "(", "match", ")", "|", "|", "!", "match", ")", "{", "duprintf", "(", "\"", "compat_check_calc_match", ":", "`", "%", "s", "'", "not", "found", "\\", "n", "\"", ",", "m", "-", ">", "u", ".", "user", ".", "name", ")", ";", "return", "match", "?", "PTR_ERR", "(", "match", ")", ":", "-", "ENOENT", ";", "}", "m", "-", ">", "u", ".", "kernel", ".", "match", "=", "match", ";", "if", "(", "m", "-", ">", "u", ".", "kernel", ".", "match", "-", ">", "compat", ")", "m", "-", ">", "u", ".", "kernel", ".", "match", "-", ">", "compat", "(", "m", ",", "NULL", ",", "size", ",", "COMPAT_CALC_SIZE", ")", ";", "else", "xt_compat_match", "(", "m", ",", "NULL", ",", "size", ",", "COMPAT_CALC_SIZE", ")", ";", "(", "*", "i", ")", "++", ";", "return", "0", ";", "}", "static", "inline", "int", "check_compat_entry_size_and_hooks", "(", "struct", "ipt_entry", "*", "e", ",", "struct", "xt_table_info", "*", "newinfo", ",", "unsigned", "int", "*", "size", ",", "unsigned", "char", "*", "base", ",", "unsigned", "char", "*", "limit", ",", "unsigned", "int", "*", "hook_entries", ",", "unsigned", "int", "*", "underflows", ",", "unsigned", "int", "*", "i", ",", "const", "char", "*", "name", ")", "{", "struct", "ipt_entry_target", "*", "t", ";", "struct", "ipt_target", "*", "target", ";", "u_int16_t", "entry_offset", ";", "int", "ret", ",", "off", ",", "h", ",", "j", ";", "duprintf", "(", "\"", "check_compat_entry_size_and_hooks", "%", "p", "\\", "n", "\"", ",", "e", ")", ";", "if", "(", "(", "unsigned", "long", ")", "e", "%", "__alignof__", "(", "struct", "compat_ipt_entry", ")", "!", "=", "0", "|", "|", "(", "unsigned", "char", "*", ")", "e", "+", "sizeof", "(", "struct", "compat_ipt_entry", ")", ">", "=", "limit", ")", "{", "duprintf", "(", "\"", "Bad", "offset", "%", "p", ",", "limit", "=", "%", "p", "\\", "n", "\"", ",", "e", ",", "limit", ")", ";", "return", "-", "EINVAL", ";", "}", "if", "(", "e", "-", ">", "next_offset", "<", "sizeof", "(", "struct", "compat_ipt_entry", ")", "sizeof", "(", "struct", "compat_xt_entry_target", ")", ")", "{", "duprintf", "(", "\"", "checking", ":", "element", "%", "p", "size", "%", "u", "\\", "n", "\"", ",", "e", ",", "e", "-", ">", "next_offset", ")", ";", "return", "-", "EINVAL", ";", "}", "if", "(", "!", "ip_checkentry", "(", "&", "e", "-", ">", "ip", ")", ")", "{", "duprintf", "(", "\"", "ip_tables", ":", "ip", "check", "failed", "%", "p", "%", "s", ".", "\\", "n", "\"", ",", "e", ",", "name", ")", ";", "return", "-", "EINVAL", ";", "}", "off", "=", "0", ";", "entry_offset", "=", "(", "void", "*", ")", "e", "-", "(", "void", "*", ")", "base", ";", "j", "=", "0", ";", "ret", "=", "IPT_MATCH_ITERATE", "(", "e", ",", "compat_check_calc_match", ",", "name", ",", "&", "e", "-", ">", "ip", ",", "e", "-", ">", "comefrom", ",", "&", "off", ",", "&", "j", ")", ";", "if", "(", "ret", "!", "=", "0", ")", "goto", "out", ";", "t", "=", "ipt_get_target", "(", "e", ")", ";", "target", "=", "try_then_request_module", "(", "xt_find_target", "(", "AF_INET", ",", "t", "-", ">", "u", ".", "user", ".", "name", ",", "t", "-", ">", "u", ".", "user", ".", "revision", ")", ",", "\"", "ipt_", "%", "s", "\"", ",", "t", "-", ">", "u", ".", "user", ".", "name", ")", ";", "if", "(", "IS_ERR", "(", "target", ")", "|", "|", "!", "target", ")", "{", "duprintf", "(", "\"", "check_entry", ":", "`", "%", "s", "'", "not", "found", "\\", "n", "\"", ",", "t", "-", ">", "u", ".", "user", ".", "name", ")", ";", "ret", "=", "target", "?", "PTR_ERR", "(", "target", ")", ":", "-", "ENOENT", ";", "goto", "out", ";", "}", "t", "-", ">", "u", ".", "kernel", ".", "target", "=", "target", ";", "if", "(", "t", "-", ">", "u", ".", "kernel", ".", "target", "-", ">", "compat", ")", "t", "-", ">", "u", ".", "kernel", ".", "target", "-", ">", "compat", "(", "t", ",", "NULL", ",", "&", "off", ",", "COMPAT_CALC_SIZE", ")", ";", "else", "xt_compat_target", "(", "t", ",", "NULL", ",", "&", "off", ",", "COMPAT_CALC_SIZE", ")", ";", "*", "size", "+", "=", "off", ";", "ret", "=", "compat_add_offset", "(", "entry_offset", ",", "off", ")", ";", "if", "(", "ret", ")", "goto", "out", ";", "/", "*", "Check", "hooks", "&", "underflows", "*", "/", "for", "(", "h", "=", "0", ";", "h", "<", "NF_IP_NUMHOOKS", ";", "h", "+", "+)", "{", "if", "(", "(", "unsigned", "char", "*", ")", "e", "-", "base", "=", "=", "hook_entries", "[", "h", "]", ")", "newinfo", "-", ">", "hook_entry", "[", "h", "]", "=", "hook_entries", "[", "h", "]", ";", "if", "(", "(", "unsigned", "char", "*", ")", "e", "-", "base", "=", "=", "underflows", "[", "h", "]", ")", "newinfo", "-", ">", "underflow", "[", "h", "]", "=", "underflows", "[", "h", "]", ";", "}", "/", "*", "Clear", "counters", "and", "comefrom", "*", "/", "e", "-", ">", "counters", "=", "(", "(", "struct", "ipt_counters", ")", "{", "0", ",", "0", "}", ");", "e", "-", ">", "comefrom", "=", "0", ";", "(", "*", "i", ")", "++", ";", "return", "0", ";", "out", ":", "IPT_MATCH_ITERATE", "(", "e", ",", "cleanup_match", ",", "&", "j", ")", ";", "return", "ret", ";", "}", "static", "inline", "int", "compat_copy_match_from_user", "(", "struct", "ipt_entry_match", "*", "m", ",", "void", "*", "*", "dstptr", ",", "compat_uint_t", "*", "size", ",", "const", "char", "*", "name", ",", "const", "struct", "ipt_ip", "*", "ip", ",", "unsigned", "int", "hookmask", ")", "{", "struct", "ipt_entry_match", "*", "dm", ";", "struct", "ipt_match", "*", "match", ";", "int", "ret", ";", "dm", "=", "(", "struct", "ipt_entry_match", "*", ")*", "dstptr", ";", "match", "=", "m", "-", ">", "u", ".", "kernel", ".", "match", ";", "if", "(", "match", "-", ">", "compat", ")", "match", "-", ">", "compat", "(", "m", ",", "dstptr", ",", "size", ",", "COMPAT_FROM_USER", ")", ";", "else", "xt_compat_match", "(", "m", ",", "dstptr", ",", "size", ",", "COMPAT_FROM_USER", ")", ";", "ret", "=", "xt_check_match", "(", "match", ",", "AF_INET", ",", "dm", "-", ">", "u", ".", "match_size", "-", "sizeof", "(", "*", "dm", ")", ",", "name", ",", "hookmask", ",", "ip", "-", ">", "proto", ",", "ip", "-", ">", "invflags", "&", "IPT_INV_PROTO", ")", ";", "if", "(", "ret", ")", "return", "ret", ";", "if", "(", "m", "-", ">", "u", ".", "kernel", ".", "match", "-", ">", "checkentry", "&", "&", "!", "m", "-", ">", "u", ".", "kernel", ".", "match", "-", ">", "checkentry", "(", "name", ",", "ip", ",", "match", ",", "dm", "-", ">", "data", ",", "dm", "-", ">", "u", ".", "match_size", "-", "sizeof", "(", "*", "dm", ")", ",", "hookmask", ")", ")", "{", "duprintf", "(", "\"", "ip_tables", ":", "check", "failed", "for", "`", "%", "s", "'", ".\\", "n", "\"", ",", "m", "-", ">", "u", ".", "kernel", ".", "match", "-", ">", "name", ")", ";", "return", "-", "EINVAL", ";", "}", "return", "0", ";", "}", "static", "int", "compat_copy_entry_from_user", "(", "struct", "ipt_entry", "*", "e", ",", "void", "*", "*", "dstptr", ",", "unsigned", "int", "*", "size", ",", "const", "char", "*", "name", ",", "struct", "xt_table_info", "*", "newinfo", ",", "unsigned", "char", "*", "base", ")", "{", "struct", "ipt_entry_target", "*", "t", ";", "struct", "ipt_target", "*", "target", ";", "struct", "ipt_entry", "*", "de", ";", "unsigned", "int", "origsize", ";", "int", "ret", ",", "h", ";", "ret", "=", "0", ";", "origsize", "=", "*", "size", ";", "de", "=", "(", "struct", "ipt_entry", "*", ")*", "dstptr", ";", "memcpy", "(", "de", ",", "e", ",", "sizeof", "(", "struct", "ipt_entry", ")", ");", "*", "dstptr", "+", "=", "sizeof", "(", "struct", "compat_ipt_entry", ")", ";", "ret", "=", "IPT_MATCH_ITERATE", "(", "e", ",", "compat_copy_match_from_user", ",", "dstptr", ",", "size", ",", "name", ",", "&", "de", "-", ">", "ip", ",", "de", "-", ">", "comefrom", ")", ";", "if", "(", "ret", ")", "goto", "out", ";", "de", "-", ">", "target_offset", "=", "e", "-", ">", "target_offset", "-", "(", "origsize", "-", "*", "size", ")", ";", "t", "=", "ipt_get_target", "(", "e", ")", ";", "target", "=", "t", "-", ">", "u", ".", "kernel", ".", "target", ";", "if", "(", "target", "-", ">", "compat", ")", "target", "-", ">", "compat", "(", "t", ",", "dstptr", ",", "size", ",", "COMPAT_FROM_USER", ")", ";", "else", "xt_compat_target", "(", "t", ",", "dstptr", ",", "size", ",", "COMPAT_FROM_USER", ")", ";", "de", "-", ">", "next_offset", "=", "e", "-", ">", "next_offset", "-", "(", "origsize", "-", "*", "size", ")", ";", "for", "(", "h", "=", "0", ";", "h", "<", "NF_IP_NUMHOOKS", ";", "h", "+", "+)", "{", "if", "(", "(", "unsigned", "char", "*", ")", "de", "-", "base", "<", "newinfo", "-", ">", "hook_entry", "[", "h", "]", ")", "newinfo", "-", ">", "hook_entry", "[", "h", "]", "-", "=", "origsize", "-", "*", "size", ";", "if", "(", "(", "unsigned", "char", "*", ")", "de", "-", "base", "<", "newinfo", "-", ">", "underflow", "[", "h", "]", ")", "newinfo", "-", ">", "underflow", "[", "h", "]", "-", "=", "origsize", "-", "*", "size", ";", "}", "t", "=", "ipt_get_target", "(", "de", ")", ";", "target", "=", "t", "-", ">", "u", ".", "kernel", ".", "target", ";", "ret", "=", "xt_check_target", "(", "target", ",", "AF_INET", ",", "t", "-", ">", "u", ".", "target_size", "-", "sizeof", "(", "*", "t", ")", ",", "name", ",", "e", "-", ">", "comefrom", ",", "e", "-", ">", "ip", ".", "proto", ",", "e", "-", ">", "ip", ".", "invflags", "&", "IPT_INV_PROTO", ")", ";", "if", "(", "ret", ")", "goto", "out", ";", "ret", "=", "-", "EINVAL", ";", "if", "(", "t", "-", ">", "u", ".", "kernel", ".", "target", "=", "=", "&", "ipt_standard_target", ")", "{", "if", "(", "!", "standard_check", "(", "t", ",", "*", "size", ")", ")", "goto", "out", ";", "}", "else", "if", "(", "t", "-", ">", "u", ".", "kernel", ".", "target", "-", ">", "checkentry", "&", "&", "!", "t", "-", ">", "u", ".", "kernel", ".", "target", "-", ">", "checkentry", "(", "name", ",", "de", ",", "target", ",", "t", "-", ">", "data", ",", "t", "-", ">", "u", ".", "target_size", "-", "sizeof", "(", "*", "t", ")", ",", "de", "-", ">", "comefrom", ")", ")", "{", "duprintf", "(", "\"", "ip_tables", ":", "compat", ":", "check", "failed", "for", "`", "%", "s", "'", ".\\", "n", "\"", ",", "t", "-", ">", "u", ".", "kernel", ".", "target", "-", ">", "name", ")", ";", "goto", "out", ";", "}", "ret", "=", "0", ";", "out", ":", "return", "ret", ";", "}", "static", "int", "get_entries", "(", "const", "struct", "ipt_get_entries", "*", "entries", ",", "struct", "ipt_get_entries", "__user", "*", "uptr", ")", "translate_compat_table", "(", "const", "char", "*", "name", ",", "unsigned", "int", "valid_hooks", ",", "struct", "xt_table_info", "*", "*", "pinfo", ",", "void", "*", "*", "pentry0", ",", "unsigned", "int", "total_size", ",", "unsigned", "int", "number", ",", "unsigned", "int", "*", "hook_entries", ",", "unsigned", "int", "*", "underflows", ")", "{", "unsigned", "int", "i", ";", "struct", "xt_table_info", "*", "newinfo", ",", "*", "info", ";", "void", "*", "pos", ",", "*", "entry0", ",", "*", "entry1", ";", "unsigned", "int", "size", ";", "int", "ret", ";", "struct", "ipt_table", "*", "t", ";", "t", "=", "xt_find_table_lock", "(", "AF_INET", ",", "entries", "-", ">", "name", ")", ";", "if", "(", "t", "&", "&", "!", "IS_ERR", "(", "t", ")", ")", "{", "struct", "xt_table_info", "*", "private", "=", "t", "-", ">", "private", ";", "duprintf", "(", "\"", "t", "-", ">", "private", "-", ">", "number", "=", "%", "u", "\\", "n", "\"", ",", "private", "-", ">", "number", ")", ";", "if", "(", "entries", "-", ">", "size", "=", "=", "private", "-", ">", "size", ")", "ret", "=", "copy_entries_to_user", "(", "private", "-", ">", "size", ",", "t", ",", "uptr", "-", ">", "entrytable", ")", ";", "else", "{", "duprintf", "(", "\"", "get_entries", ":", "I", "'", "ve", "got", "%", "u", "not", "%", "u", "!", "\\", "n", "\"", ",", "private", "-", ">", "size", ",", "entries", "-", ">", "size", ")", ";", "ret", "=", "-", "EINVAL", ";", "info", "=", "*", "pinfo", ";", "entry0", "=", "*", "pentry0", ";", "size", "=", "total_size", ";", "info", "-", ">", "number", "=", "number", ";", "/", "*", "Init", "all", "hooks", "to", "impossible", "value", ".", "*", "/", "for", "(", "i", "=", "0", ";", "i", "<", "NF_IP_NUMHOOKS", ";", "i", "+", "+)", "{", "info", "-", ">", "hook_entry", "[", "i", "]", "=", "0xFFFFFFFF", ";", "info", "-", ">", "underflow", "[", "i", "]", "=", "0xFFFFFFFF", ";", "}", "duprintf", "(", "\"", "translate_compat_table", ":", "size", "%", "u", "\\", "n", "\"", ",", "info", "-", ">", "size", ")", ";", "i", "=", "0", ";", "xt_compat_lock", "(", "AF_INET", ")", ";", "/", "*", "Walk", "through", "entries", ",", "checking", "offsets", ".", "*", "/", "ret", "=", "IPT_ENTRY_ITERATE", "(", "entry0", ",", "total_size", ",", "check_compat_entry_size_and_hooks", ",", "info", ",", "&", "size", ",", "entry0", ",", "entry0", "+", "total_size", ",", "hook_entries", ",", "underflows", ",", "&", "i", ",", "name", ")", ";", "if", "(", "ret", "!", "=", "0", ")", "goto", "out_unlock", ";", "ret", "=", "-", "EINVAL", ";", "if", "(", "i", "!", "=", "number", ")", "{", "duprintf", "(", "\"", "translate_compat_table", ":", "%", "u", "not", "%", "u", "entries", "\\", "n", "\"", ",", "i", ",", "number", ")", ";", "goto", "out_unlock", ";", "}", "/", "*", "Check", "hooks", "all", "assigned", "*", "/", "for", "(", "i", "=", "0", ";", "i", "<", "NF_IP_NUMHOOKS", ";", "i", "+", "+)", "{", "/", "*", "Only", "hooks", "which", "are", "valid", "*", "/", "if", "(", "!(", "valid_hooks", "&", "(", "1", "<", "<", "i", ")", "))", "continue", ";", "if", "(", "info", "-", ">", "hook_entry", "[", "i", "]", "=", "=", "0xFFFFFFFF", ")", "{", "duprintf", "(", "\"", "Invalid", "hook", "entry", "%", "u", "%", "u", "\\", "n", "\"", ",", "i", ",", "hook_entries", "[", "i", "]", ");", "goto", "out_unlock", ";", "}", "module_put", "(", "t", "-", ">", "me", ")", ";", "xt_table_unlock", "(", "t", ")", ";", "}", "else", "ret", "=", "t", "?", "PTR_ERR", "(", "t", ")", ":", "-", "ENOENT", ";", "if", "(", "info", "-", ">", "underflow", "[", "i", "]", "=", "=", "0xFFFFFFFF", ")", "{", "duprintf", "(", "\"", "Invalid", "underflow", "%", "u", "%", "u", "\\", "n", "\"", ",", "i", ",", "underflows", "[", "i", "]", ");", "goto", "out_unlock", ";", "}", "}", "ret", "=", "-", "ENOMEM", ";", "newinfo", "=", "xt_alloc_table_info", "(", "size", ")", ";", "if", "(", "!", "newinfo", ")", "goto", "out_unlock", ";", "newinfo", "-", ">", "number", "=", "number", ";", "for", "(", "i", "=", "0", ";", "i", "<", "NF_IP_NUMHOOKS", ";", "i", "+", "+)", "{", "newinfo", "-", ">", "hook_entry", "[", "i", "]", "=", "info", "-", ">", "hook_entry", "[", "i", "]", ";", "newinfo", "-", ">", "underflow", "[", "i", "]", "=", "info", "-", ">", "underflow", "[", "i", "]", ";", "}", "entry1", "=", "newinfo", "-", ">", "entries", "[", "raw_smp_processor_id", "(", ")]", ";", "pos", "=", "entry1", ";", "size", "=", "total_size", ";", "ret", "=", "IPT_ENTRY_ITERATE", "(", "entry0", ",", "total_size", ",", "compat_copy_entry_from_user", ",", "&", "pos", ",", "&", "size", ",", "name", ",", "newinfo", ",", "entry1", ")", ";", "compat_flush_offsets", "(", ");", "xt_compat_unlock", "(", "AF_INET", ")", ";", "if", "(", "ret", ")", "goto", "free_newinfo", ";", "ret", "=", "-", "ELOOP", ";", "if", "(", "!", "mark_source_chains", "(", "newinfo", ",", "valid_hooks", ",", "entry1", ")", ")", "goto", "free_newinfo", ";", "/", "*", "And", "one", "copy", "for", "every", "other", "CPU", "*", "/", "for_each_cpu", "(", "i", ")", "if", "(", "newinfo", "-", ">", "entries", "[", "i", "]", "&", "&", "newinfo", "-", ">", "entries", "[", "i", "]", "!", "=", "entry1", ")", "memcpy", "(", "newinfo", "-", ">", "entries", "[", "i", "]", ",", "entry1", ",", "newinfo", "-", ">", "size", ")", ";", "*", "pinfo", "=", "newinfo", ";", "*", "pentry0", "=", "entry1", ";", "xt_free_table_info", "(", "info", ")", ";", "return", "0", ";", "free_newinfo", ":", "xt_free_table_info", "(", "newinfo", ")", ";", "out", ":", "return", "ret", ";", "out_unlock", ":", "xt_compat_unlock", "(", "AF_INET", ")", ";", "goto", "out", ";", "}", "static", "int", "do_replace", "(", "void", "__user", "*", "user", ",", "unsigned", "int", "len", ")", "compat_do_replace", "(", "void", "__user", "*", "user", ",", "unsigned", "int", "len", ")", "{", "int", "ret", ";", "struct", "ipt_replace", "tmp", ";", "struct", "ipt_table", "*", "t", ";", "struct", "xt_table_info", "*", "newinfo", ",", "*", "oldinfo", ";", "struct", "xt_counters", "*", "counters", ";", "void", "*", "loc_cpu_entry", ",", "*", "loc_cpu_old_entry", ";", "struct", "compat_ipt_replace", "tmp", ";", "struct", "xt_table_info", "*", "newinfo", ";", "void", "*", "loc_cpu_entry", ";", "if", "(", "copy_from_user", "(", "&", "tmp", ",", "user", ",", "sizeof", "(", "tmp", ")", ")", "!", "=", "0", ")", "return", "-", "EFAULT", ";", "@", "@", "-", "949", ",", "151", "+", "1818", ",", "201", "@", "@", "do_replace", "(", "void", "__user", "*", "user", ",", "unsigned", "int", "len", ")", "goto", "free_newinfo", ";", "}", "counters", "=", "vmalloc", "(", "tmp", ".", "num_counters", "*", "sizeof", "(", "struct", "xt_counters", ")", ");", "if", "(", "!", "counters", ")", "{", "ret", "=", "-", "ENOMEM", ";", "ret", "=", "translate_compat_table", "(", "tmp", ".", "name", ",", "tmp", ".", "valid_hooks", ",", "&", "newinfo", ",", "&", "loc_cpu_entry", ",", "tmp", ".", "size", ",", "tmp", ".", "num_entries", ",", "tmp", ".", "hook_entry", ",", "tmp", ".", "underflow", ")", ";", "if", "(", "ret", "!", "=", "0", ")", "goto", "free_newinfo", ";", "}", "ret", "=", "translate_table", "(", "tmp", ".", "name", ",", "tmp", ".", "valid_hooks", ",", "newinfo", ",", "loc_cpu_entry", ",", "tmp", ".", "size", ",", "tmp", ".", "num_entries", ",", "tmp", ".", "hook_entry", ",", "tmp", ".", "underflow", ")", ";", "if", "(", "ret", "!", "=", "0", ")", "goto", "free_newinfo_counters", ";", "duprintf", "(", "\"", "compat_do_replace", ":", "Translated", "table", "\\", "n", "\"", ");", "duprintf", "(", "\"", "ip_tables", ":", "Translated", "table", "\\", "n", "\"", ");", "ret", "=", "__do_replace", "(", "tmp", ".", "name", ",", "tmp", ".", "valid_hooks", ",", "newinfo", ",", "tmp", ".", "num_counters", ",", "compat_ptr", "(", "tmp", ".", "counters", ")", ");", "if", "(", "ret", ")", "goto", "free_newinfo_untrans", ";", "return", "0", ";", "t", "=", "try_then_request_module", "(", "xt_find_table_lock", "(", "AF_INET", ",", "tmp", ".", "name", ")", ",", "\"", "iptable_", "%", "s", "\"", ",", "tmp", ".", "name", ")", ";", "if", "(", "!", "t", "|", "|", "IS_ERR", "(", "t", ")", ")", "{", "ret", "=", "t", "?", "PTR_ERR", "(", "t", ")", ":", "-", "ENOENT", ";", "goto", "free_newinfo_counters_untrans", ";", "}", "free_newinfo_untrans", ":", "IPT_ENTRY_ITERATE", "(", "loc_cpu_entry", ",", "newinfo", "-", ">", "size", ",", "cleanup_entry", ",", "NULL", ")", ";", "free_newinfo", ":", "xt_free_table_info", "(", "newinfo", ")", ";", "return", "ret", ";", "}", "/", "*", "You", "lied", "!", "*", "/", "if", "(", "tmp", ".", "valid_hooks", "!", "=", "t", "-", ">", "valid_hooks", ")", "{", "duprintf", "(", "\"", "Valid", "hook", "crap", ":", "%", "08X", "vs", "%", "08X", "\\", "n", "\"", ",", "tmp", ".", "valid_hooks", ",", "t", "-", ">", "valid_hooks", ")", ";", "ret", "=", "-", "EINVAL", ";", "goto", "put_module", ";", "}", "static", "int", "compat_do_ipt_set_ctl", "(", "struct", "sock", "*", "sk", ",", "int", "cmd", ",", "void", "__user", "*", "user", ",", "unsigned", "int", "len", ")", "{", "int", "ret", ";", "oldinfo", "=", "xt_replace_table", "(", "t", ",", "tmp", ".", "num_counters", ",", "newinfo", ",", "&", "ret", ")", ";", "if", "(", "!", "oldinfo", ")", "goto", "put_module", ";", "if", "(", "!", "capable", "(", "CAP_NET_ADMIN", ")", ")", "return", "-", "EPERM", ";", "/", "*", "Update", "module", "usage", "count", "based", "on", "number", "of", "rules", "*", "/", "duprintf", "(", "\"", "do_replace", ":", "oldnum", "=", "%", "u", ",", "initnum", "=", "%", "u", ",", "newnum", "=", "%", "u", "\\", "n", "\"", ",", "oldinfo", "-", ">", "number", ",", "oldinfo", "-", ">", "initial_entries", ",", "newinfo", "-", ">", "number", ")", ";", "if", "(", "(", "oldinfo", "-", ">", "number", ">", "oldinfo", "-", ">", "initial_entries", ")", "|", "|", "(", "newinfo", "-", ">", "number", "<", "=", "oldinfo", "-", ">", "initial_entries", ")", ")", "module_put", "(", "t", "-", ">", "me", ")", ";", "if", "(", "(", "oldinfo", "-", ">", "number", ">", "oldinfo", "-", ">", "initial_entries", ")", "&", "&", "(", "newinfo", "-", ">", "number", "<", "=", "oldinfo", "-", ">", "initial_entries", ")", ")", "module_put", "(", "t", "-", ">", "me", ")", ";", "switch", "(", "cmd", ")", "{", "case", "IPT_SO_SET_REPLACE", ":", "ret", "=", "compat_do_replace", "(", "user", ",", "len", ")", ";", "break", ";", "/", "*", "Get", "the", "old", "counters", ".", "*", "/", "get_counters", "(", "oldinfo", ",", "counters", ")", ";", "/", "*", "Decrease", "module", "usage", "counts", "and", "free", "resource", "*", "/", "loc_cpu_old_entry", "=", "oldinfo", "-", ">", "entries", "[", "raw_smp_processor_id", "(", ")]", ";", "IPT_ENTRY_ITERATE", "(", "loc_cpu_old_entry", ",", "oldinfo", "-", ">", "size", ",", "cleanup_entry", ",", "NULL", ")", ";", "xt_free_table_info", "(", "oldinfo", ")", ";", "if", "(", "copy_to_user", "(", "tmp", ".", "counters", ",", "counters", ",", "sizeof", "(", "struct", "xt_counters", ")", "*", "tmp", ".", "num_counters", ")", "!", "=", "0", ")", "ret", "=", "-", "EFAULT", ";", "vfree", "(", "counters", ")", ";", "xt_table_unlock", "(", "t", ")", ";", "return", "ret", ";", "case", "IPT_SO_SET_ADD_COUNTERS", ":", "ret", "=", "do_add_counters", "(", "user", ",", "len", ",", "1", ")", ";", "break", ";", "default", ":", "duprintf", "(", "\"", "do_ipt_set_ctl", ":", "unknown", "request", "%", "i", "\\", "n", "\"", ",", "cmd", ")", ";", "ret", "=", "-", "EINVAL", ";", "}", "put_module", ":", "module_put", "(", "t", "-", ">", "me", ")", ";", "xt_table_unlock", "(", "t", ")", ";", "free_newinfo_counters_untrans", ":", "IPT_ENTRY_ITERATE", "(", "loc_cpu_entry", ",", "newinfo", "-", ">", "size", ",", "cleanup_entry", ",", "NULL", ")", ";", "free_newinfo_counters", ":", "vfree", "(", "counters", ")", ";", "free_newinfo", ":", "xt_free_table_info", "(", "newinfo", ")", ";", "return", "ret", ";", "}", "/", "*", "We", "'", "re", "lazy", ",", "and", "add", "to", "the", "first", "CPU", ";", "overflow", "works", "its", "fey", "magic", "*", "and", "everything", "is", "OK", ".", "*", "/", "static", "inline", "int", "add_counter_to_entry", "(", "struct", "ipt_entry", "*", "e", ",", "const", "struct", "xt_counters", "addme", "[", "],", "unsigned", "int", "*", "i", ")", "struct", "compat_ipt_get_entries", "{", "#", "if", "0", "duprintf", "(", "\"", "add_counter", ":", "Entry", "%", "u", "%", "lu", "/", "%", "lu", "+", "%", "lu", "/", "%", "lu", "\\", "n", "\"", ",", "*", "i", ",", "(", "long", "unsigned", "int", ")", "e", "-", ">", "counters", ".", "pcnt", ",", "(", "long", "unsigned", "int", ")", "e", "-", ">", "counters", ".", "bcnt", ",", "(", "long", "unsigned", "int", ")", "addme", "[", "*", "i", "]", ".", "pcnt", ",", "(", "long", "unsigned", "int", ")", "addme", "[", "*", "i", "]", ".", "bcnt", ")", ";", "#", "endif", "char", "name", "[", "IPT_TABLE_MAXNAMELEN", "]", ";", "compat_uint_t", "size", ";", "struct", "compat_ipt_entry", "entrytable", "[", "0", "]", ";", "}", ";", "ADD_COUNTER", "(", "e", "-", ">", "counters", ",", "addme", "[", "*", "i", "]", ".", "bcnt", ",", "addme", "[", "*", "i", "]", ".", "pcnt", ")", ";", "static", "int", "compat_copy_entries_to_user", "(", "unsigned", "int", "total_size", ",", "struct", "ipt_table", "*", "table", ",", "void", "__user", "*", "userptr", ")", "{", "unsigned", "int", "off", ",", "num", ";", "struct", "compat_ipt_entry", "e", ";", "struct", "xt_counters", "*", "counters", ";", "struct", "xt_table_info", "*", "private", "=", "table", "-", ">", "private", ";", "void", "__user", "*", "pos", ";", "unsigned", "int", "size", ";", "int", "ret", "=", "0", ";", "void", "*", "loc_cpu_entry", ";", "(", "*", "i", ")", "++", ";", "return", "0", ";", "counters", "=", "alloc_counters", "(", "table", ")", ";", "if", "(", "IS_ERR", "(", "counters", ")", ")", "return", "PTR_ERR", "(", "counters", ")", ";", "/", "*", "choose", "the", "copy", "that", "is", "on", "our", "node", "/", "cpu", ",", ".", "..", "*", "This", "choice", "is", "lazy", "(", "because", "current", "thread", "is", "*", "allowed", "to", "migrate", "to", "another", "cpu", ")", "*", "/", "loc_cpu_entry", "=", "private", "-", ">", "entries", "[", "raw_smp_processor_id", "(", ")]", ";", "pos", "=", "userptr", ";", "size", "=", "total_size", ";", "ret", "=", "IPT_ENTRY_ITERATE", "(", "loc_cpu_entry", ",", "total_size", ",", "compat_copy_entry_to_user", ",", "&", "pos", ",", "&", "size", ")", ";", "if", "(", "ret", ")", "goto", "free_counters", ";", "/", "*", ".", "..", "then", "go", "back", "and", "fix", "counters", "and", "names", "*", "/", "for", "(", "off", "=", "0", ",", "num", "=", "0", ";", "off", "<", "size", ";", "off", "+", "=", "e", ".", "next_offset", ",", "num", "+", "+)", "{", "unsigned", "int", "i", ";", "struct", "ipt_entry_match", "m", ";", "struct", "ipt_entry_target", "t", ";", "ret", "=", "-", "EFAULT", ";", "if", "(", "copy_from_user", "(", "&", "e", ",", "userptr", "+", "off", ",", "sizeof", "(", "struct", "compat_ipt_entry", ")", "))", "goto", "free_counters", ";", "if", "(", "copy_to_user", "(", "userptr", "+", "off", "offsetof", "(", "struct", "compat_ipt_entry", ",", "counters", ")", ",", "&", "counters", "[", "num", "]", ",", "sizeof", "(", "counters", "[", "num", "]", "))", ")", "goto", "free_counters", ";", "for", "(", "i", "=", "sizeof", "(", "struct", "compat_ipt_entry", ")", ";", "i", "<", "e", ".", "target_offset", ";", "i", "+", "=", "m", ".", "u", ".", "match_size", ")", "{", "if", "(", "copy_from_user", "(", "&", "m", ",", "userptr", "+", "off", "+", "i", ",", "sizeof", "(", "struct", "ipt_entry_match", ")", "))", "goto", "free_counters", ";", "if", "(", "copy_to_user", "(", "userptr", "+", "off", "+", "i", "offsetof", "(", "struct", "ipt_entry_match", ",", "u", ".", "user", ".", "name", ")", ",", "m", ".", "u", ".", "kernel", ".", "match", "-", ">", "name", ",", "strlen", "(", "m", ".", "u", ".", "kernel", ".", "match", "-", ">", "name", ")", "+", "1", ")", ")", "goto", "free_counters", ";", "}", "if", "(", "copy_from_user", "(", "&", "t", ",", "userptr", "+", "off", "+", "e", ".", "target_offset", ",", "sizeof", "(", "struct", "ipt_entry_target", ")", "))", "goto", "free_counters", ";", "if", "(", "copy_to_user", "(", "userptr", "+", "off", "+", "e", ".", "target_offset", "offsetof", "(", "struct", "ipt_entry_target", ",", "u", ".", "user", ".", "name", ")", ",", "t", ".", "u", ".", "kernel", ".", "target", "-", ">", "name", ",", "strlen", "(", "t", ".", "u", ".", "kernel", ".", "target", "-", ">", "name", ")", "+", "1", ")", ")", "goto", "free_counters", ";", "}", "ret", "=", "0", ";", "free_counters", ":", "vfree", "(", "counters", ")", ";", "return", "ret", ";", "}", "static", "int", "do_add_counters", "(", "void", "__user", "*", "user", ",", "unsigned", "int", "len", ")", "compat_get_entries", "(", "struct", "compat_ipt_get_entries", "__user", "*", "uptr", ",", "int", "*", "len", ")", "{", "unsigned", "int", "i", ";", "struct", "xt_counters_info", "tmp", ",", "*", "paddc", ";", "int", "ret", ";", "struct", "compat_ipt_get_entries", "get", ";", "struct", "ipt_table", "*", "t", ";", "struct", "xt_table_info", "*", "private", ";", "int", "ret", "=", "0", ";", "void", "*", "loc_cpu_entry", ";", "if", "(", "copy_from_user", "(", "&", "tmp", ",", "user", ",", "sizeof", "(", "tmp", ")", ")", "!", "=", "0", ")", "return", "-", "EFAULT", ";", "if", "(", "len", "!", "=", "sizeof", "(", "tmp", ")", "+", "tmp", ".", "num_counters", "*", "sizeof", "(", "struct", "xt_counters", ")", ")", "if", "(", "*", "len", "<", "sizeof", "(", "get", ")", ")", "{", "duprintf", "(", "\"", "compat_get_entries", ":", "%", "u", "<", "%", "u", "\\", "n", "\"", ",", "*", "len", ",", "(", "unsigned", "int", ")", "sizeof", "(", "get", ")", ");", "return", "-", "EINVAL", ";", "}", "paddc", "=", "vmalloc_node", "(", "len", ",", "numa_node_id", "(", "))", ";", "if", "(", "!", "paddc", ")", "return", "-", "ENOMEM", ";", "if", "(", "copy_from_user", "(", "&", "get", ",", "uptr", ",", "sizeof", "(", "get", ")", ")", "!", "=", "0", ")", "return", "-", "EFAULT", ";", "if", "(", "copy_from_user", "(", "paddc", ",", "user", ",", "len", ")", "!", "=", "0", ")", "{", "ret", "=", "-", "EFAULT", ";", "goto", "free", ";", "if", "(", "*", "len", "!", "=", "sizeof", "(", "struct", "compat_ipt_get_entries", ")", "+", "get", ".", "size", ")", "{", "duprintf", "(", "\"", "compat_get_entries", ":", "%", "u", "!", "=", "%", "u", "\\", "n", "\"", ",", "*", "len", ",", "(", "unsigned", "int", ")", "(", "sizeof", "(", "struct", "compat_ipt_get_entries", ")", "get", ".", "size", ")", ");", "return", "-", "EINVAL", ";", "}", "t", "=", "xt_find_table_lock", "(", "AF_INET", ",", "tmp", ".", "name", ")", ";", "if", "(", "!", "t", "|", "|", "IS_ERR", "(", "t", ")", ")", "{", "xt_compat_lock", "(", "AF_INET", ")", ";", "t", "=", "xt_find_table_lock", "(", "AF_INET", ",", "get", ".", "name", ")", ";", "if", "(", "t", "&", "&", "!", "IS_ERR", "(", "t", ")", ")", "{", "struct", "xt_table_info", "*", "private", "=", "t", "-", ">", "private", ";", "struct", "xt_table_info", "info", ";", "duprintf", "(", "\"", "t", "-", ">", "private", "-", ">", "number", "=", "%", "u", "\\", "n", "\"", ",", "private", "-", ">", "number", ")", ";", "ret", "=", "compat_table_info", "(", "private", ",", "&", "info", ")", ";", "if", "(", "!", "ret", "&", "&", "get", ".", "size", "=", "=", "info", ".", "size", ")", "{", "ret", "=", "compat_copy_entries_to_user", "(", "private", "-", ">", "size", ",", "t", ",", "uptr", "-", ">", "entrytable", ")", ";", "}", "else", "if", "(", "!", "ret", ")", "{", "duprintf", "(", "\"", "compat_get_entries", ":", "I", "'", "ve", "got", "%", "u", "not", "%", "u", "!", "\\", "n", "\"", ",", "private", "-", ">", "size", ",", "get", ".", "size", ")", ";", "ret", "=", "-", "EINVAL", ";", "}", "compat_flush_offsets", "(", ");", "module_put", "(", "t", "-", ">", "me", ")", ";", "xt_table_unlock", "(", "t", ")", ";", "}", "else", "ret", "=", "t", "?", "PTR_ERR", "(", "t", ")", ":", "-", "ENOENT", ";", "goto", "free", ";", "}", "write_lock_bh", "(", "&", "t", "-", ">", "lock", ")", ";", "private", "=", "t", "-", ">", "private", ";", "if", "(", "private", "-", ">", "number", "!", "=", "paddc", "-", ">", "num_counters", ")", "{", "ret", "=", "-", "EINVAL", ";", "goto", "unlock_up_free", ";", "}", "xt_compat_unlock", "(", "AF_INET", ")", ";", "return", "ret", ";", "}", "i", "=", "0", ";", "/", "*", "Choose", "the", "copy", "that", "is", "on", "our", "node", "*", "/", "loc_cpu_entry", "=", "private", "-", ">", "entries", "[", "raw_smp_processor_id", "(", ")]", ";", "IPT_ENTRY_ITERATE", "(", "loc_cpu_entry", ",", "private", "-", ">", "size", ",", "add_counter_to_entry", ",", "paddc", "-", ">", "counters", ",", "&", "i", ")", ";", "unlock_up_free", ":", "write_unlock_bh", "(", "&", "t", "-", ">", "lock", ")", ";", "xt_table_unlock", "(", "t", ")", ";", "module_put", "(", "t", "-", ">", "me", ")", ";", "free", ":", "vfree", "(", "paddc", ")", ";", "static", "int", "compat_do_ipt_get_ctl", "(", "struct", "sock", "*", "sk", ",", "int", "cmd", ",", "void", "__user", "*", "user", ",", "int", "*", "len", ")", "{", "int", "ret", ";", "switch", "(", "cmd", ")", "{", "case", "IPT_SO_GET_INFO", ":", "ret", "=", "get_info", "(", "user", ",", "len", ",", "1", ")", ";", "break", ";", "case", "IPT_SO_GET_ENTRIES", ":", "ret", "=", "compat_get_entries", "(", "user", ",", "len", ")", ";", "break", ";", "default", ":", "duprintf", "(", "\"", "compat_do_ipt_get_ctl", ":", "unknown", "request", "%", "i", "\\", "n", "\"", ",", "cmd", ")", ";", "ret", "=", "-", "EINVAL", ";", "}", "return", "ret", ";", "}", "#", "endif", "static", "int", "do_ipt_set_ctl", "(", "struct", "sock", "*", "sk", ",", "int", "cmd", ",", "void", "__user", "*", "user", ",", "unsigned", "int", "len", ")", "@", "@", "-", "1109", ",", "7", "+", "2028", ",", "7", "@", "@", "do_ipt_set_ctl", "(", "struct", "sock", "*", "sk", ",", "int", "cmd", ",", "void", "__user", "*", "user", ",", "unsigned", "int", "len", ")", "break", ";", "case", "IPT_SO_SET_ADD_COUNTERS", ":", "ret", "=", "do_add_counters", "(", "user", ",", "len", ")", ";", "ret", "=", "do_add_counters", "(", "user", ",", "len", ",", "0", ")", ";", "break", ";", "default", ":", "@", "@", "-", "1129", ",", "65", "+", "2048", ",", "13", "@", "@", "do_ipt_get_ctl", "(", "struct", "sock", "*", "sk", ",", "int", "cmd", ",", "void", "__user", "*", "user", ",", "int", "*", "len", ")", "return", "-", "EPERM", ";", "switch", "(", "cmd", ")", "{", "case", "IPT_SO_GET_INFO", ":", "{", "char", "name", "[", "IPT_TABLE_MAXNAMELEN", "]", ";", "struct", "ipt_table", "*", "t", ";", "if", "(", "*", "len", "!", "=", "sizeof", "(", "struct", "ipt_getinfo", ")", ")", "{", "duprintf", "(", "\"", "length", "%", "u", "!", "=", "%", "u", "\\", "n", "\"", ",", "*", "len", ",", "sizeof", "(", "struct", "ipt_getinfo", ")", ");", "ret", "=", "-", "EINVAL", ";", "break", ";", "}", "if", "(", "copy_from_user", "(", "name", ",", "user", ",", "sizeof", "(", "name", ")", ")", "!", "=", "0", ")", "{", "ret", "=", "-", "EFAULT", ";", "break", ";", "}", "name", "[", "IPT_TABLE_MAXNAMELEN", "-", "1", "]", "=", "'", "\\", "0", "'", ";", "t", "=", "try_then_request_module", "(", "xt_find_table_lock", "(", "AF_INET", ",", "name", ")", ",", "\"", "iptable_", "%", "s", "\"", ",", "name", ")", ";", "if", "(", "t", "&", "&", "!", "IS_ERR", "(", "t", ")", ")", "{", "struct", "ipt_getinfo", "info", ";", "struct", "xt_table_info", "*", "private", "=", "t", "-", ">", "private", ";", "info", ".", "valid_hooks", "=", "t", "-", ">", "valid_hooks", ";", "memcpy", "(", "info", ".", "hook_entry", ",", "private", "-", ">", "hook_entry", ",", "sizeof", "(", "info", ".", "hook_entry", ")", ");", "memcpy", "(", "info", ".", "underflow", ",", "private", "-", ">", "underflow", ",", "sizeof", "(", "info", ".", "underflow", ")", ");", "info", ".", "num_entries", "=", "private", "-", ">", "number", ";", "info", ".", "size", "=", "private", "-", ">", "size", ";", "memcpy", "(", "info", ".", "name", ",", "name", ",", "sizeof", "(", "info", ".", "name", ")", ");", "if", "(", "copy_to_user", "(", "user", ",", "&", "info", ",", "*", "len", ")", "!", "=", "0", ")", "ret", "=", "-", "EFAULT", ";", "else", "ret", "=", "0", ";", "xt_table_unlock", "(", "t", ")", ";", "module_put", "(", "t", "-", ">", "me", ")", ";", "}", "else", "ret", "=", "t", "?", "PTR_ERR", "(", "t", ")", ":", "-", "ENOENT", ";", "}", "break", ";", "case", "IPT_SO_GET_ENTRIES", ":", "{", "struct", "ipt_get_entries", "get", ";", "case", "IPT_SO_GET_INFO", ":", "ret", "=", "get_info", "(", "user", ",", "len", ",", "0", ")", ";", "break", ";", "if", "(", "*", "len", "<", "sizeof", "(", "get", ")", ")", "{", "duprintf", "(", "\"", "get_entries", ":", "%", "u", "<", "%", "u", "\\", "n", "\"", ",", "*", "len", ",", "sizeof", "(", "get", ")", ");", "ret", "=", "-", "EINVAL", ";", "}", "else", "if", "(", "copy_from_user", "(", "&", "get", ",", "user", ",", "sizeof", "(", "get", ")", ")", "!", "=", "0", ")", "{", "ret", "=", "-", "EFAULT", ";", "}", "else", "if", "(", "*", "len", "!", "=", "sizeof", "(", "struct", "ipt_get_entries", ")", "+", "get", ".", "size", ")", "{", "duprintf", "(", "\"", "get_entries", ":", "%", "u", "!", "=", "%", "u", "\\", "n", "\"", ",", "*", "len", ",", "sizeof", "(", "struct", "ipt_get_entries", ")", "+", "get", ".", "size", ")", ";", "ret", "=", "-", "EINVAL", ";", "}", "else", "ret", "=", "get_entries", "(", "&", "get", ",", "user", ")", ";", "case", "IPT_SO_GET_ENTRIES", ":", "ret", "=", "get_entries", "(", "user", ",", "len", ")", ";", "break", ";", "}", "case", "IPT_SO_GET_REVISION_MATCH", ":", "case", "IPT_SO_GET_REVISION_TARGET", ":", "{", "@", "@", "-", "1336", ",", "6", "+", "2203", ",", "9", "@", "@", "static", "struct", "ipt_target", "ipt_standard_target", "=", "{", ".", "name", "=", "IPT_STANDARD_TARGET", ",", ".", "targetsize", "=", "sizeof", "(", "int", ")", ",", ".", "family", "=", "AF_INET", ",", "#", "ifdef", "CONFIG_COMPAT", ".", "compat", "=", "&", "compat_ipt_standard_fn", ",", "#", "endif", "}", ";", "static", "struct", "ipt_target", "ipt_error_target", "=", "{", "@", "@", "-", "1350", ",", "9", "+", "2220", ",", "15", "@", "@", "static", "struct", "nf_sockopt_ops", "ipt_sockopts", "=", "{", ".", "set_optmin", "=", "IPT_BASE_CTL", ",", ".", "set_optmax", "=", "IPT_SO_SET_MAX", "+", "1", ",", ".", "set", "=", "do_ipt_set_ctl", ",", "#", "ifdef", "CONFIG_COMPAT", ".", "compat_set", "=", "compat_do_ipt_set_ctl", ",", "#", "endif", ".", "get_optmin", "=", "IPT_BASE_CTL", ",", ".", "get_optmax", "=", "IPT_SO_GET_MAX", "+", "1", ",", ".", "get", "=", "do_ipt_get_ctl", ",", "#", "ifdef", "CONFIG_COMPAT", ".", "compat_get", "=", "compat_do_ipt_get_ctl", ",", "#", "endif", "}", ";", "static", "struct", "ipt_match", "icmp_matchstruct", "=", "{", "@", "@", "-", "38", ",", "6", "+", "38", ",", "7", "@", "@", "struct", "xt_af", "{", "struct", "list_head", "match", ";", "struct", "list_head", "target", ";", "struct", "list_head", "tables", ";", "struct", "mutex", "compat_mutex", ";", "}", ";", "static", "struct", "xt_af", "*", "xt", ";", "@", "@", "-", "272", ",", "6", "+", "273", ",", "54", "@", "@", "int", "xt_check_match", "(", "const", "struct", "xt_match", "*", "match", ",", "unsigned", "short", "family", ",", "}", "EXPORT_SYMBOL_GPL", "(", "xt_check_match", ")", ";", "#", "ifdef", "CONFIG_COMPAT", "int", "xt_compat_match", "(", "void", "*", "match", ",", "void", "*", "*", "dstptr", ",", "int", "*", "size", ",", "int", "convert", ")", "{", "struct", "xt_match", "*", "m", ";", "struct", "compat_xt_entry_match", "*", "pcompat_m", ";", "struct", "xt_entry_match", "*", "pm", ";", "u_int16_t", "msize", ";", "int", "off", ",", "ret", ";", "ret", "=", "0", ";", "m", "=", "(", "(", "struct", "xt_entry_match", "*", ")", "match", ")", "->", "u", ".", "kernel", ".", "match", ";", "off", "=", "XT_ALIGN", "(", "m", "-", ">", "matchsize", ")", "-", "COMPAT_XT_ALIGN", "(", "m", "-", ">", "matchsize", ")", ";", "switch", "(", "convert", ")", "{", "case", "COMPAT_TO_USER", ":", "pm", "=", "(", "struct", "xt_entry_match", "*", ")", "match", ";", "msize", "=", "pm", "-", ">", "u", ".", "user", ".", "match_size", ";", "if", "(", "__copy_to_user", "(", "*", "dstptr", ",", "pm", ",", "msize", ")", ")", "{", "ret", "=", "-", "EFAULT", ";", "break", ";", "}", "msize", "-", "=", "off", ";", "if", "(", "put_user", "(", "msize", ",", "(", "u_int16_t", "*", ")*", "dstptr", ")", ")", "ret", "=", "-", "EFAULT", ";", "*", "size", "-", "=", "off", ";", "*", "dstptr", "+", "=", "msize", ";", "break", ";", "case", "COMPAT_FROM_USER", ":", "pcompat_m", "=", "(", "struct", "compat_xt_entry_match", "*", ")", "match", ";", "pm", "=", "(", "struct", "xt_entry_match", "*", ")*", "dstptr", ";", "msize", "=", "pcompat_m", "-", ">", "u", ".", "user", ".", "match_size", ";", "memcpy", "(", "pm", ",", "pcompat_m", ",", "msize", ")", ";", "msize", "+", "=", "off", ";", "pm", "-", ">", "u", ".", "user", ".", "match_size", "=", "msize", ";", "*", "size", "+", "=", "off", ";", "*", "dstptr", "+", "=", "msize", ";", "break", ";", "case", "COMPAT_CALC_SIZE", ":", "*", "size", "+", "=", "off", ";", "break", ";", "default", ":", "ret", "=", "-", "ENOPROTOOPT", ";", "break", ";", "}", "return", "ret", ";", "}", "EXPORT_SYMBOL_GPL", "(", "xt_compat_match", ")", ";", "#", "endif", "int", "xt_check_target", "(", "const", "struct", "xt_target", "*", "target", ",", "unsigned", "short", "family", ",", "unsigned", "int", "size", ",", "const", "char", "*", "table", ",", "unsigned", "int", "hook_mask", ",", "unsigned", "short", "proto", ",", "int", "inv_proto", ")", "@", "@", "-", "301", ",", "6", "+", "350", ",", "54", "@", "@", "int", "xt_check_target", "(", "const", "struct", "xt_target", "*", "target", ",", "unsigned", "short", "family", ",", "}", "EXPORT_SYMBOL_GPL", "(", "xt_check_target", ")", ";", "#", "ifdef", "CONFIG_COMPAT", "int", "xt_compat_target", "(", "void", "*", "target", ",", "void", "*", "*", "dstptr", ",", "int", "*", "size", ",", "int", "convert", ")", "{", "struct", "xt_target", "*", "t", ";", "struct", "compat_xt_entry_target", "*", "pcompat", ";", "struct", "xt_entry_target", "*", "pt", ";", "u_int16_t", "tsize", ";", "int", "off", ",", "ret", ";", "ret", "=", "0", ";", "t", "=", "(", "(", "struct", "xt_entry_target", "*", ")", "target", ")", "->", "u", ".", "kernel", ".", "target", ";", "off", "=", "XT_ALIGN", "(", "t", "-", ">", "targetsize", ")", "-", "COMPAT_XT_ALIGN", "(", "t", "-", ">", "targetsize", ")", ";", "switch", "(", "convert", ")", "{", "case", "COMPAT_TO_USER", ":", "pt", "=", "(", "struct", "xt_entry_target", "*", ")", "target", ";", "tsize", "=", "pt", "-", ">", "u", ".", "user", ".", "target_size", ";", "if", "(", "__copy_to_user", "(", "*", "dstptr", ",", "pt", ",", "tsize", ")", ")", "{", "ret", "=", "-", "EFAULT", ";", "break", ";", "}", "tsize", "-", "=", "off", ";", "if", "(", "put_user", "(", "tsize", ",", "(", "u_int16_t", "*", ")*", "dstptr", ")", ")", "ret", "=", "-", "EFAULT", ";", "*", "size", "-", "=", "off", ";", "*", "dstptr", "+", "=", "tsize", ";", "break", ";", "case", "COMPAT_FROM_USER", ":", "pcompat", "=", "(", "struct", "compat_xt_entry_target", "*", ")", "target", ";", "pt", "=", "(", "struct", "xt_entry_target", "*", ")*", "dstptr", ";", "tsize", "=", "pcompat", "-", ">", "u", ".", "user", ".", "target_size", ";", "memcpy", "(", "pt", ",", "pcompat", ",", "tsize", ")", ";", "tsize", "+", "=", "off", ";", "pt", "-", ">", "u", ".", "user", ".", "target_size", "=", "tsize", ";", "*", "size", "+", "=", "off", ";", "*", "dstptr", "+", "=", "tsize", ";", "break", ";", "case", "COMPAT_CALC_SIZE", ":", "*", "size", "+", "=", "off", ";", "break", ";", "default", ":", "ret", "=", "-", "ENOPROTOOPT", ";", "break", ";", "}", "return", "ret", ";", "}", "EXPORT_SYMBOL_GPL", "(", "xt_compat_target", ")", ";", "#", "endif", "struct", "xt_table_info", "*", "xt_alloc_table_info", "(", "unsigned", "int", "size", ")", "{", "struct", "xt_table_info", "*", "newinfo", ";", "@", "@", "-", "371", ",", "6", "+", "468", ",", "19", "@", "@", "void", "xt_table_unlock", "(", "struct", "xt_table", "*", "table", ")", "}", "EXPORT_SYMBOL_GPL", "(", "xt_table_unlock", ")", ";", "#", "ifdef", "CONFIG_COMPAT", "void", "xt_compat_lock", "(", "int", "af", ")", "{", "mutex_lock", "(", "&", "xt", "[", "af", "]", ".", "compat_mutex", ")", ";", "}", "EXPORT_SYMBOL_GPL", "(", "xt_compat_lock", ")", ";", "void", "xt_compat_unlock", "(", "int", "af", ")", "{", "mutex_unlock", "(", "&", "xt", "[", "af", "]", ".", "compat_mutex", ")", ";", "}", "EXPORT_SYMBOL_GPL", "(", "xt_compat_unlock", ")", ";", "#", "endif", "struct", "xt_table_info", "*", "xt_replace_table", "(", "struct", "xt_table", "*", "table", ",", "@", "@", "-", "671", ",", "6", "+", "781", ",", "9", "@", "@", "static", "int", "__init", "xt_init", "(", "void", ")", "for", "(", "i", "=", "0", ";", "i", "<", "NPROTO", ";", "i", "+", "+)", "{", "mutex_init", "(", "&", "xt", "[", "i", "]", ".", "mutex", ")", ";", "#", "ifdef", "CONFIG_COMPAT", "mutex_init", "(", "&", "xt", "[", "i", "]", ".", "compat_mutex", ")", ";", "#", "endif", "INIT_LIST_HEAD", "(", "&", "xt", "[", "i", "]", ".", "target", ")", ";", "INIT_LIST_HEAD", "(", "&", "xt", "[", "i", "]", ".", "match", ")", ";", "INIT_LIST_HEAD", "(", "&", "xt", "[", "i", "]", ".", "tables", ")", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["kvm:", "take", "srcu", "lock", "around", "kvm_steal_time_set_preempted()", "kvm_memslots()", "will", "be", "called", "by", "kvm_write_guest_offset_cached()", "so", "take", "the", "srcu", "lock.", "Signed-off-by:", "Andrea", "Arcangeli", "<aarcange@redhat.com>", "Signed-off-by:", "Paolo", "Bonzini", "<pbonzini@redhat.com>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["dccp:", "handle", "invalid", "feature", "options", "length", "A", "length", "of", "zero", "(after", "subtracting", "two", "for", "the", "type", "and", "len", "fields)", "for", "the", "DCCPO_{CHANGE,CONFIRM}_{L,R}", "options", "will", "cause", "an", "underflow", "due", "to", "the", "subtraction.", "The", "subsequent", "code", "may", "read", "past", "the", "end", "of", "the", "options", "value", "buffer", "when", "parsing.", "I'm", "unsure", "of", "what", "the", "consequences", "of", "this", "might", "be,", "but", "it's", "probably", "not", "good.", "Signed-off-by:", "Dan", "Rosenberg", "<drosenberg@vsecurity.com>", "Cc:", "stable@kernel.org", "Acked-by:", "Gerrit", "Renker", "<gerrit@erg.abdn.ac.uk>", "Signed-off-by:", "David", "S.", "Miller", "<davem@davemloft.net>"], "code_tokens": ["@", "@", "-", "123", ",", "6", "+", "123", ",", "8", "@", "@", "int", "dccp_parse_options", "(", "struct", "sock", "*", "sk", ",", "struct", "dccp_request_sock", "*", "dreq", ",", "case", "DCCPO_CHANGE_L", ".", "..", "DCCPO_CONFIRM_R", ":", "if", "(", "pkt_type", "=", "=", "DCCP_PKT_DATA", ")", "/", "*", "RFC", "4340", ",", "6", "*", "/", "break", ";", "if", "(", "len", "=", "=", "0", ")", "goto", "out_invalid_option", ";", "rc", "=", "dccp_feat_parse_options", "(", "sk", ",", "dreq", ",", "mandatory", ",", "opt", ",", "*", "value", ",", "value", "+", "1", ",", "len", "-", "1", ")", ";", "if", "(", "rc", ")"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Bump", "junit", "from", "4.12", "to", "4.13.1", "Bumps", "[junit](https://github.com/junit-team/junit4)", "from", "4.12", "to", "4.13.1.", "-", "[Release", "notes](https://github.com/junit-team/junit4/releases)", "-", "[Changelog](https://github.com/junit-team/junit4/blob/main/doc/ReleaseNotes4.12.md)", "-", "[Commits](https://github.com/junit-team/junit4/compare/r4.12...r4.13.1)", "Signed-off-by:", "dependabot[bot]", "<support@github.com>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["cipso:", "don't", "follow", "a", "NULL", "pointer", "when", "setsockopt()", "is", "called", "As", "reported", "by", "Alan", "Cox,", "and", "verified", "by", "Lin", "Ming,", "when", "a", "user", "attempts", "to", "add", "a", "CIPSO", "option", "to", "a", "socket", "using", "the", "CIPSO_V4_TAG_LOCAL", "tag", "the", "kernel", "dies", "a", "terrible", "death", "when", "it", "attempts", "to", "follow", "a", "NULL", "pointer", "(the", "skb", "argument", "to", "cipso_v4_validate()", "is", "NULL", "when", "called", "via", "the", "setsockopt()", "syscall).", "This", "patch", "fixes", "this", "by", "first", "checking", "to", "ensure", "that", "the", "skb", "is", "non-NULL", "before", "using", "it", "to", "find", "the", "incoming", "network", "interface.", "In", "the", "unlikely", "case", "where", "the", "skb", "is", "NULL", "and", "the", "user", "attempts", "to", "add", "a", "CIPSO", "option", "with", "the", "_TAG_LOCAL", "tag", "we", "return", "an", "error", "as", "this", "is", "not", "something", "we", "want", "to", "allow.", "A", "simple", "reproducer,", "kindly", "supplied", "by", "Lin", "Ming,", "although", "you", "must", "have", "the", "CIPSO", "DOI", "#3", "configure", "on", "the", "system", "first", "or", "you", "will", "be", "caught", "early", "in", "cipso_v4_validate():", "#include", "<sys/types.h>", "#include", "<sys/socket.h>", "#include", "<linux/ip.h>", "#include", "<linux/in.h>", "#include", "<string.h>", "struct", "local_tag", "{", "char", "type;", "char", "length;", "char", "info[4];", "};", "struct", "cipso", "{", "char", "type;", "char", "length;", "char", "doi[4];", "struct", "local_tag", "local;", "};", "int", "main(int", "argc,", "char", "**argv)", "{", "int", "sockfd;", "struct", "cipso", "cipso", "=", "{", ".type", "=", "IPOPT_CIPSO,", ".length", "=", "sizeof(struct", "cipso),", ".local", "=", "{", ".type", "=", "128,", ".length", "=", "sizeof(struct", "local_tag),", "},", "};", "memset(cipso.doi,", "0,", "4);", "cipso.doi[3]", "=", "3;", "sockfd", "=", "socket(AF_INET,", "SOCK_DGRAM,", "0);", "#define", "SOL_IP", "0", "setsockopt(sockfd,", "SOL_IP,", "IP_OPTIONS,", "&cipso,", "sizeof(struct", "cipso));", "return", "0;", "}", "CC:", "Lin", "Ming", "<mlin@ss.pku.edu.cn>", "Reported-by:", "Alan", "Cox", "<alan@lxorguk.ukuu.org.uk>", "Signed-off-by:", "Paul", "Moore", "<pmoore@redhat.com>", "Signed-off-by:", "David", "S.", "Miller", "<davem@davemloft.net>"], "code_tokens": ["@", "@", "-", "1725", ",", "8", "+", "1725", ",", "10", "@", "@", "int", "cipso_v4_validate", "(", "const", "struct", "sk_buff", "*", "skb", ",", "unsigned", "char", "*", "*", "option", ")", "case", "CIPSO_V4_TAG_LOCAL", ":", "/", "*", "This", "is", "a", "non", "-", "standard", "tag", "that", "we", "only", "allow", "for", "*", "local", "connections", ",", "so", "if", "the", "incoming", "interface", "is", "*", "not", "the", "loopback", "device", "drop", "the", "packet", ".", "*", "/", "if", "(", "!(", "skb", "-", ">", "dev", "-", ">", "flags", "&", "IFF_LOOPBACK", ")", ")", "{", "*", "not", "the", "loopback", "device", "drop", "the", "packet", ".", "Further", ",", "*", "there", "is", "no", "legitimate", "reason", "for", "setting", "this", "from", "*", "userspace", "so", "reject", "it", "if", "skb", "is", "NULL", ".", "*", "/", "if", "(", "skb", "=", "=", "NULL", "|", "|", "!", "(", "skb", "-", ">", "dev", "-", ">", "flags", "&", "IFF_LOOPBACK", ")", ")", "{", "err_offset", "=", "opt_iter", ";", "goto", "validate_return_locked", ";", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Merge", "pull", "request", "#28", "from", "ashinn/fix-nfa-compilation-of-empty-sequences-in-or", "Fix", "#26", "by", "taking", "the", "max", "of", "the", "inserted", "state", "numbers"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["USB:", "serial:", "visor:", "fix", "crash", "on", "detecting", "device", "without", "write_urbs", "The", "visor", "driver", "crashes", "in", "clie_5_attach()", "when", "a", "specially", "crafted", "USB", "device", "without", "bulk-out", "endpoint", "is", "detected.", "This", "fix", "adds", "a", "check", "that", "the", "device", "has", "proper", "configuration", "expected", "by", "the", "driver.", "Reported-by:", "Ralf", "Spenneberg", "<ralf@spenneberg.net>", "Signed-off-by:", "Vladis", "Dronov", "<vdronov@redhat.com>", "Fixes:", "cfb8da8f69b8", "(\"USB:", "visor:", "fix", "initialisation", "of", "UX50/TH55", "devices\")", "Cc:", "stable", "<stable@vger.kernel.org>", "Signed-off-by:", "Johan", "Hovold", "<johan@kernel.org>"], "code_tokens": ["@", "@", "-", "602", ",", "8", "+", "602", ",", "10", "@", "@", "static", "int", "clie_5_attach", "(", "struct", "usb_serial", "*", "serial", ")", "*", "/", "/", "*", "some", "sanity", "check", "*", "/", "if", "(", "serial", "-", ">", "num_ports", "<", "2", ")", "return", "-", "1", ";", "if", "(", "serial", "-", ">", "num_bulk_out", "<", "2", ")", "{", "dev_err", "(", "&", "serial", "-", ">", "interface", "-", ">", "dev", ",", "\"", "missing", "bulk", "out", "endpoints", "\\", "n", "\"", ");", "return", "-", "ENODEV", ";", "}", "/", "*", "port", "0", "now", "uses", "the", "modified", "endpoint", "Address", "*", "/", "port", "=", "serial", "-", ">", "port", "[", "0", "]", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["sendmmsg/sendmsg:", "fix", "unsafe", "user", "pointer", "access", "Dereferencing", "a", "user", "pointer", "directly", "from", "kernel-space", "without", "going", "through", "the", "copy_from_user", "family", "of", "functions", "is", "a", "bad", "idea.", "Two", "of", "such", "usages", "can", "be", "found", "in", "the", "sendmsg", "code", "path", "called", "from", "sendmmsg,", "added", "by", "commit", "c71d8ebe7a4496fb7231151cb70a6baa0cb56f9a", "upstream.", "commit", "5b47b8038f183b44d2d8ff1c7d11a5c1be706b34", "in", "the", "3.0-stable", "tree.", "Usages", "are", "performed", "through", "memcmp()", "and", "memcpy()", "directly.", "Fix", "those", "by", "using", "the", "already", "copied", "msg_sys", "structure", "instead", "of", "the", "__user", "*msg", "structure.", "Note", "that", "msg_sys", "can", "be", "set", "to", "NULL", "by", "verify_compat_iovec()", "or", "verify_iovec(),", "which", "requires", "additional", "NULL", "pointer", "checks.", "Signed-off-by:", "Mathieu", "Desnoyers", "<mathieu.desnoyers@efficios.com>", "Signed-off-by:", "David", "Goulet", "<dgoulet@ev0ke.net>", "CC:", "Tetsuo", "Handa", "<penguin-kernel@I-love.SAKURA.ne.jp>", "CC:", "Anton", "Blanchard", "<anton@samba.org>", "CC:", "David", "S.", "Miller", "<davem@davemloft.net>", "CC:", "stable", "<stable@kernel.org>", "Signed-off-by:", "David", "S.", "Miller", "<davem@davemloft.net>"], "code_tokens": ["@", "@", "-", "1965", ",", "8", "+", "1965", ",", "9", "@", "@", "static", "int", "__sys_sendmsg", "(", "struct", "socket", "*", "sock", ",", "struct", "msghdr", "__user", "*", "msg", ",", "*", "used_address", "-", ">", "name_len", "is", "initialized", "to", "UINT_MAX", "so", "that", "the", "first", "*", "destination", "address", "never", "matches", ".", "*", "/", "if", "(", "used_address", "&", "&", "used_address", "-", ">", "name_len", "=", "=", "msg_sys", "-", ">", "msg_namelen", "&", "&", "!", "memcmp", "(", "&", "used_address", "-", ">", "name", ",", "msg", "-", ">", "msg_name", ",", "if", "(", "used_address", "&", "&", "msg_sys", "-", ">", "msg_name", "&", "&", "used_address", "-", ">", "name_len", "=", "=", "msg_sys", "-", ">", "msg_namelen", "&", "&", "!", "memcmp", "(", "&", "used_address", "-", ">", "name", ",", "msg_sys", "-", ">", "msg_name", ",", "used_address", "-", ">", "name_len", ")", ")", "{", "err", "=", "sock_sendmsg_nosec", "(", "sock", ",", "msg_sys", ",", "total_len", ")", ";", "goto", "out_freectl", ";", "@", "@", "-", "1978", ",", "8", "+", "1979", ",", "9", "@", "@", "static", "int", "__sys_sendmsg", "(", "struct", "socket", "*", "sock", ",", "struct", "msghdr", "__user", "*", "msg", ",", "*", "/", "if", "(", "used_address", "&", "&", "err", ">", "=", "0", ")", "{", "used_address", "-", ">", "name_len", "=", "msg_sys", "-", ">", "msg_namelen", ";", "memcpy", "(", "&", "used_address", "-", ">", "name", ",", "msg", "-", ">", "msg_name", ",", "used_address", "-", ">", "name_len", ")", ";", "if", "(", "msg_sys", "-", ">", "msg_name", ")", "memcpy", "(", "&", "used_address", "-", ">", "name", ",", "msg_sys", "-", ">", "msg_name", ",", "used_address", "-", ">", "name_len", ")", ";", "}", "out_freectl", ":"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Make", "sure", "that", "the", "OAuth", "authenticate", "principal", "name", "matches", "the", "client_id", "(if", "specified)", "(cherry", "picked", "from", "commit", "337609d81a9f53e7680cb79d9ab733a79f4cd769)", "(cherry", "picked", "from", "commit", "6bf89927d3e07197d49453b00d673eadce696cf9)"], "code_tokens": ["@", "@", "-", "56", ",", "8", "+", "56", ",", "8", "@", "@", "protected", "Client", "authenticateClientIfNeeded", "(", "MultivaluedMap", "<", "String", ",", "String", ">", "param", "SecurityContext", "sc", "=", "getMessageContext", "(", ").", "getSecurityContext", "(", ");", "Principal", "principal", "=", "sc", ".", "getUserPrincipal", "(", ");", "String", "clientId", "=", "retrieveClientId", "(", "params", ")", ";", "if", "(", "principal", "=", "=", "null", ")", "{", "String", "clientId", "=", "retrieveClientId", "(", "params", ")", ";", "if", "(", "clientId", "!", "=", "null", ")", "{", "String", "clientSecret", "=", "params", ".", "getFirst", "(", "OAuthConstants", ".", "CLIENT_SECRET", ")", ";", "if", "(", "clientSecret", "!", "=", "null", ")", "{", "@", "@", "-", "77", ",", "11", "+", "77", ",", "12", "@", "@", "protected", "Client", "authenticateClientIfNeeded", "(", "MultivaluedMap", "<", "String", ",", "String", ">", "param", "}", "}", "}", "else", "{", "String", "clientId", "=", "retrieveClientId", "(", "params", ")", ";", "if", "(", "clientId", "!", "=", "null", ")", "{", "if", "(", "clientId", ".", "equals", "(", "principal", ".", "getName", "(", "))", ")", "{", "client", "=", "(", "Client", ")", "getMessageContext", "(", ").", "get", "(", "Client", ".", "class", ".", "getName", "(", "))", ";", "if", "(", "!", "clientId", ".", "equals", "(", "principal", ".", "getName", "(", "))", ")", "{", "reportInvalidClient", "(", ");", "}", "client", "=", "(", "Client", ")", "getMessageContext", "(", ").", "get", "(", "Client", ".", "class", ".", "getName", "(", "))", ";", "if", "(", "client", "=", "=", "null", ")", "{", "client", "=", "getClient", "(", "clientId", ",", "params", ")", ";", "}", "@", "@", "-", "108", ",", "7", "+", "109", ",", "7", "@", "@", "protected", "void", "validateClientAuthenticationMethod", "(", "Client", "c", ",", "String", "authMethod", ")", "{", "reportInvalidClient", "(", "new", "OAuthError", "(", "OAuthConstants", ".", "UNAUTHORIZED_CLIENT", ")", ");", "}", "}", "protected", "String", "retrieveClientId", "(", "MultivaluedMap", "<", "String", ",", "String", ">", "params", ")", "{", "String", "clientId", "=", "params", ".", "getFirst", "(", "OAuthConstants", ".", "CLIENT_ID", ")", ";", "if", "(", "clientId", "=", "=", "null", ")", "{", "@", "@", "-", "164", ",", "14", "+", "165", ",", "14", "@", "@", "protected", "void", "checkCertificateBinding", "(", "Client", "client", ",", "TLSSessionInfo", "tlsSessionI", "reportInvalidClient", "(", ");", "}", "X509Certificate", "cert", "=", "OAuthUtils", ".", "getRootTLSCertificate", "(", "tlsSessionInfo", ")", ";", "if", "(", "subjectDn", "!", "=", "null", "if", "(", "subjectDn", "!", "=", "null", "&", "&", "!", "subjectDn", ".", "equals", "(", "OAuthUtils", ".", "getSubjectDnFromTLSCertificates", "(", "cert", ")", "))", "{", "LOG", ".", "warning", "(", "\"", "Client", "\\", "\"\"", "+", "client", ".", "getClientId", "(", ")", "+", "\"", "\\\"", "can", "not", "be", "bound", "to", "the", "TLS", "certificate", "\"", ");", "reportInvalidClient", "(", ");", "}", "String", "issuerDn", "=", "client", ".", "getProperties", "(", ").", "get", "(", "OAuthConstants", ".", "TLS_CLIENT_AUTH_ISSUER_DN", ")", ";", "if", "(", "issuerDn", "!", "=", "null", "if", "(", "issuerDn", "!", "=", "null", "&", "&", "!", "issuerDn", ".", "equals", "(", "OAuthUtils", ".", "getIssuerDnFromTLSCertificates", "(", "cert", ")", "))", "{", "LOG", ".", "warning", "(", "\"", "Client", "\\", "\"\"", "+", "client", ".", "getClientId", "(", ")", "+", "\"", "\\\"", "can", "not", "be", "bound", "to", "the", "TLS", "certificate", "\"", ");", "reportInvalidClient", "(", ");", "@", "@", "-", "187", ",", "7", "+", "188", ",", "7", "@", "@", "private", "TLSSessionInfo", "getTlsSessionInfo", "(", ")", "{", "return", "(", "TLSSessionInfo", ")", "getMessageContext", "(", ").", "get", "(", "TLSSessionInfo", ".", "class", ".", "getName", "(", "))", ";", "}", "protected", "Client", "getClientFromTLSCertificates", "(", "SecurityContext", "sc", ",", "TLSSessionInfo", "tlsSessionInfo", ",", "MultivaluedMap", "<", "String", ",", "String", ">", "params", ")", "{", "@", "@", "-", "206", ",", "11", "+", "207", ",", "11", "@", "@", "protected", "Client", "getClientFromTLSCertificates", "(", "SecurityContext", "sc", ",", "}", "return", "client", ";", "}", "protected", "void", "compareTlsCertificates", "(", "TLSSessionInfo", "tlsInfo", ",", "List", "<", "String", ">", "base64EncodedCerts", ")", "{", "if", "(", "!", "OAuthUtils", ".", "compareTlsCertificates", "(", "tlsInfo", ",", "base64EncodedCerts", ")", ")", "{", "reportInvalidClient", "(", ");", "reportInvalidClient", "(", ");", "}", "}", "@", "@", "-", "244", ",", "7", "+", "245", ",", "7", "@", "@", "protected", "Response", "createErrorResponseFromBean", "(", "OAuthError", "errorBean", ")", "{", "protected", "Client", "getClient", "(", "String", "clientId", ",", "MultivaluedMap", "<", "String", ",", "String", ">", "params", ")", "{", "return", "getClient", "(", "clientId", ",", "params", ".", "getFirst", "(", "OAuthConstants", ".", "CLIENT_SECRET", ")", ",", "params", ")", ";", "}", "protected", "Client", "getClient", "(", "String", "clientId", ",", "String", "clientSecret", ",", "MultivaluedMap", "<", "String", ",", "String", ">", "params", ")", "{", "if", "(", "clientId", "=", "=", "null", ")", "{", "reportInvalidRequestError", "(", "\"", "Client", "ID", "is", "null", "\"", ");", "@", "@", "-", "555", ",", "6", "+", "555", ",", "129", "@", "@", "public", "void", "testAuthorizationCodeGrantWithUnknownAudience", "(", ")", "throws", "Exception", "{", "}", "}", "/", "/", "Here", "we", "are", "sending", "a", "different", "client", "Id", "in", "both", "the", "authz", "+", "token", "requests", "@", "org", ".", "junit", ".", "Test", "public", "void", "testNonMatchingClientId", "(", ")", "throws", "Exception", "{", "URL", "busFile", "=", "AuthorizationGrantTest", ".", "class", ".", "getResource", "(", "\"", "client", ".", "xml", "\"", ");", "String", "address", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "port", "+", "\"", "/", "services", "/", "\";", "WebClient", "client", "=", "WebClient", ".", "create", "(", "address", ",", "OAuth2TestUtils", ".", "setupProviders", "(", "),", "\"", "alice", "\"", ",", "\"", "security", "\"", ",", "busFile", ".", "toString", "(", "))", ";", "/", "/", "Save", "the", "Cookie", "for", "the", "second", "request", ".", "..", "WebClient", ".", "getConfig", "(", "client", ")", ".", "getRequestContext", "(", ").", "put", "(", "org", ".", "apache", ".", "cxf", ".", "message", ".", "Message", ".", "MAINTAIN_SESSION", ",", "Boolean", ".", "TRUE", ")", ";", "/", "/", "Get", "Authorization", "Code", "String", "code", "=", "OAuth2TestUtils", ".", "getAuthorizationCode", "(", "client", ")", ";", "assertNotNull", "(", "code", ")", ";", "/", "/", "Now", "get", "the", "access", "token", "using", "a", "different", "client", "id", "client", "=", "WebClient", ".", "create", "(", "address", ",", "OAuth2TestUtils", ".", "setupProviders", "(", "),", "\"", "consumer", "-", "id", "-", "aud", "\"", ",", "\"", "this", "-", "is", "-", "a", "-", "secret", "\"", ",", "busFile", ".", "toString", "(", "))", ";", "/", "/", "Save", "the", "Cookie", "for", "the", "second", "request", ".", "..", "WebClient", ".", "getConfig", "(", "client", ")", ".", "getRequestContext", "(", ").", "put", "(", "org", ".", "apache", ".", "cxf", ".", "message", ".", "Message", ".", "MAINTAIN_SESSION", ",", "Boolean", ".", "TRUE", ")", ";", "client", ".", "type", "(", "\"", "application", "/", "x", "-", "www", "-", "form", "-", "urlencoded", "\"", ").", "accept", "(", "\"", "application", "/", "json", "\"", ");", "client", ".", "path", "(", "\"", "token", "\"", ");", "Form", "form", "=", "new", "Form", "(", ");", "form", ".", "param", "(", "\"", "grant_type", "\"", ",", "\"", "authorization_code", "\"", ");", "form", ".", "param", "(", "\"", "code", "\"", ",", "code", ")", ";", "form", ".", "param", "(", "\"", "client_id", "\"", ",", "\"", "consumer", "-", "id", "-", "aud", "\"", ");", "/", "/", "Now", "try", "to", "get", "a", "token", "Response", "response", "=", "client", ".", "post", "(", "form", ")", ";", "try", "{", "response", ".", "readEntity", "(", "ClientAccessToken", ".", "class", ")", ";", "fail", "(", "\"", "Failure", "expected", "on", "trying", "to", "get", "a", "token", "\"", ");", "}", "catch", "(", "ResponseProcessingException", "ex", ")", "{", "/", "/", "expected", "}", "}", "/", "/", "Here", "we", "are", "sending", "a", "different", "client", "Id", "in", "both", "the", "authz", "+", "token", "requests", "@", "org", ".", "junit", ".", "Test", "public", "void", "testNonMatchingClientIdBasicAuth", "(", ")", "throws", "Exception", "{", "URL", "busFile", "=", "AuthorizationGrantTest", ".", "class", ".", "getResource", "(", "\"", "client", ".", "xml", "\"", ");", "String", "address", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "port", "+", "\"", "/", "services", "/", "\";", "WebClient", "client", "=", "WebClient", ".", "create", "(", "address", ",", "OAuth2TestUtils", ".", "setupProviders", "(", "),", "\"", "alice", "\"", ",", "\"", "security", "\"", ",", "busFile", ".", "toString", "(", "))", ";", "/", "/", "Save", "the", "Cookie", "for", "the", "second", "request", ".", "..", "WebClient", ".", "getConfig", "(", "client", ")", ".", "getRequestContext", "(", ").", "put", "(", "org", ".", "apache", ".", "cxf", ".", "message", ".", "Message", ".", "MAINTAIN_SESSION", ",", "Boolean", ".", "TRUE", ")", ";", "/", "/", "Get", "Authorization", "Code", "String", "code", "=", "OAuth2TestUtils", ".", "getAuthorizationCode", "(", "client", ")", ";", "assertNotNull", "(", "code", ")", ";", "/", "/", "Now", "get", "the", "access", "token", "using", "a", "different", "client", "id", "client", "=", "WebClient", ".", "create", "(", "address", ",", "OAuth2TestUtils", ".", "setupProviders", "(", "),", "\"", "consumer", "-", "id", "-", "aud", "\"", ",", "\"", "this", "-", "is", "-", "a", "-", "secret", "\"", ",", "busFile", ".", "toString", "(", "))", ";", "/", "/", "Save", "the", "Cookie", "for", "the", "second", "request", ".", "..", "WebClient", ".", "getConfig", "(", "client", ")", ".", "getRequestContext", "(", ").", "put", "(", "org", ".", "apache", ".", "cxf", ".", "message", ".", "Message", ".", "MAINTAIN_SESSION", ",", "Boolean", ".", "TRUE", ")", ";", "client", ".", "type", "(", "\"", "application", "/", "x", "-", "www", "-", "form", "-", "urlencoded", "\"", ").", "accept", "(", "\"", "application", "/", "json", "\"", ");", "client", ".", "path", "(", "\"", "token", "\"", ");", "Form", "form", "=", "new", "Form", "(", ");", "form", ".", "param", "(", "\"", "grant_type", "\"", ",", "\"", "authorization_code", "\"", ");", "form", ".", "param", "(", "\"", "code", "\"", ",", "code", ")", ";", "/", "/", "Now", "try", "to", "get", "a", "token", "Response", "response", "=", "client", ".", "post", "(", "form", ")", ";", "try", "{", "response", ".", "readEntity", "(", "ClientAccessToken", ".", "class", ")", ";", "fail", "(", "\"", "Failure", "expected", "on", "trying", "to", "get", "a", "token", "\"", ");", "}", "catch", "(", "ResponseProcessingException", "ex", ")", "{", "/", "/", "expected", "}", "}", "/", "/", "Here", "we", "are", "sending", "a", "different", "client", "Id", "in", "both", "the", "authz", "+", "token", "requests", ",", "where", "in", "the", "/", "/", "token", "request", "we", "authenticate", "using", "a", "different", "clientId", "@", "org", ".", "junit", ".", "Test", "public", "void", "testNonMatchingClientDifferentClientIds", "(", ")", "throws", "Exception", "{", "URL", "busFile", "=", "AuthorizationGrantTest", ".", "class", ".", "getResource", "(", "\"", "client", ".", "xml", "\"", ");", "String", "address", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "port", "+", "\"", "/", "services", "/", "\";", "WebClient", "client", "=", "WebClient", ".", "create", "(", "address", ",", "OAuth2TestUtils", ".", "setupProviders", "(", "),", "\"", "alice", "\"", ",", "\"", "security", "\"", ",", "busFile", ".", "toString", "(", "))", ";", "/", "/", "Save", "the", "Cookie", "for", "the", "second", "request", ".", "..", "WebClient", ".", "getConfig", "(", "client", ")", ".", "getRequestContext", "(", ").", "put", "(", "org", ".", "apache", ".", "cxf", ".", "message", ".", "Message", ".", "MAINTAIN_SESSION", ",", "Boolean", ".", "TRUE", ")", ";", "/", "/", "Get", "Authorization", "Code", "String", "code", "=", "OAuth2TestUtils", ".", "getAuthorizationCode", "(", "client", ")", ";", "assertNotNull", "(", "code", ")", ";", "/", "/", "Now", "get", "the", "access", "token", "using", "a", "different", "client", "id", "client", "=", "WebClient", ".", "create", "(", "address", ",", "OAuth2TestUtils", ".", "setupProviders", "(", "),", "\"", "consumer", "-", "id", "-", "aud", "\"", ",", "\"", "this", "-", "is", "-", "a", "-", "secret", "\"", ",", "busFile", ".", "toString", "(", "))", ";", "/", "/", "Save", "the", "Cookie", "for", "the", "second", "request", ".", "..", "WebClient", ".", "getConfig", "(", "client", ")", ".", "getRequestContext", "(", ").", "put", "(", "org", ".", "apache", ".", "cxf", ".", "message", ".", "Message", ".", "MAINTAIN_SESSION", ",", "Boolean", ".", "TRUE", ")", ";", "client", ".", "type", "(", "\"", "application", "/", "x", "-", "www", "-", "form", "-", "urlencoded", "\"", ").", "accept", "(", "\"", "application", "/", "json", "\"", ");", "client", ".", "path", "(", "\"", "token", "\"", ");", "Form", "form", "=", "new", "Form", "(", ");", "form", ".", "param", "(", "\"", "grant_type", "\"", ",", "\"", "authorization_code", "\"", ");", "form", ".", "param", "(", "\"", "code", "\"", ",", "code", ")", ";", "form", ".", "param", "(", "\"", "client_id", "\"", ",", "\"", "consumer", "-", "id", "\"", ");", "/", "/", "Now", "try", "to", "get", "a", "token", "Response", "response", "=", "client", ".", "post", "(", "form", ")", ";", "try", "{", "response", ".", "readEntity", "(", "ClientAccessToken", ".", "class", ")", ";", "fail", "(", "\"", "Failure", "expected", "on", "trying", "to", "get", "a", "token", "\"", ");", "}", "catch", "(", "ResponseProcessingException", "ex", ")", "{", "/", "/", "expected", "}", "}", "/", "/", "/", "/", "SAML", "Authorization", "grants", "/", "/", "@", "@", "-", "495", ",", "7", "+", "495", ",", "7", "@", "@", "public", "void", "testSAMLAuthorizationGrant", "(", ")", "throws", "Exception", "{", "String", "address", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "port", "+", "\"", "/", "services", "/", "\";", "WebClient", "client", "=", "WebClient", ".", "create", "(", "address", ",", "OAuth2TestUtils", ".", "setupProviders", "(", "),", "\"", "alice", "\"", ",", "\"", "security", "\"", ",", "busFile", ".", "toString", "(", "))", ";", "\"", "consumer", "-", "id", "\"", ",", "\"", "this", "-", "is", "-", "a", "-", "secret", "\"", ",", "busFile", ".", "toString", "(", "))", ";", "/", "/", "Create", "the", "SAML", "Assertion", "String", "assertion", "=", "OAuth2TestUtils", ".", "createToken", "(", "address", "+", "\"", "token", "\"", ");", "@", "@", "-", "525", ",", "7", "+", "525", ",", "7", "@", "@", "public", "void", "testJWTAuthorizationGrant", "(", ")", "throws", "Exception", "{", "String", "address", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "port", "+", "\"", "/", "services", "/", "\";", "WebClient", "client", "=", "WebClient", ".", "create", "(", "address", ",", "OAuth2TestUtils", ".", "setupProviders", "(", "),", "\"", "alice", "\"", ",", "\"", "security", "\"", ",", "busFile", ".", "toString", "(", "))", ";", "\"", "consumer", "-", "id", "\"", ",", "\"", "this", "-", "is", "-", "a", "-", "secret", "\"", ",", "busFile", ".", "toString", "(", "))", ";", "/", "/", "Create", "the", "JWT", "Token", "String", "token", "=", "OAuth2TestUtils", ".", "createToken", "(", "\"", "DoubleItSTSIssuer", "\"", ",", "\"", "consumer", "-", "id", "\"", ","], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Fix", "wrong", "api", "usage"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Use", "the", "Index", "Access", "Control", "from", "the", "scroll", "search", "context", "(#60640)", "When", "the", "RBACEngine", "authorizes", "scroll", "searches", "it", "sets", "the", "index", "access", "control", "to", "the", "very", "limiting", "IndicesAccessControl.ALLOW_NO_INDICES", "value.", "This", "change", "will", "set", "it", "to", "the", "value", "for", "the", "index", "access", "control", "that", "was", "produced", "during", "the", "authorization", "of", "the", "initial", "search", "that", "created", "the", "scroll,", "which", "is", "now", "stored", "in", "the", "scroll", "context."], "code_tokens": ["@", "@", "-", "239", ",", "10", "+", "239", ",", "15", "@", "@", "public", "void", "authorizeIndexAction", "(", "RequestInfo", "requestInfo", ",", "AuthorizationInfo", "auth", "if", "(", "SearchScrollAction", ".", "NAME", ".", "equals", "(", "action", ")", ")", "{", "authorizeIndexActionName", "(", "action", ",", "authorizationInfo", ",", "null", ",", "listener", ")", ";", "}", "else", "{", "/", "/", "we", "store", "the", "request", "as", "a", "transient", "in", "the", "ThreadContext", "in", "case", "of", "a", "authorization", "failure", "at", "the", "shard", "/", "/", "level", ".", "If", "authorization", "fails", "we", "will", "audit", "a", "access_denied", "message", "and", "will", "use", "the", "request", "to", "retrieve", "/", "/", "information", "such", "as", "the", "index", "and", "the", "incoming", "address", "of", "the", "request", "listener", ".", "onResponse", "(", "new", "IndexAuthorizationResult", "(", "true", ",", "IndicesAccessControl", ".", "ALLOW_NO_INDICES", ")", ");", "/", "/", "RBACEngine", "simply", "authorizes", "scroll", "related", "actions", "without", "filling", "in", "any", "DLS", "/", "FLS", "permissions", ".", "/", "/", "Scroll", "related", "actions", "have", "special", "security", "logic", ",", "where", "the", "security", "context", "of", "the", "initial", "search", "/", "/", "request", "is", "attached", "to", "the", "scroll", "context", "upon", "creation", "in", "{", "@", "code", "SecuritySearchOperationListener", "#", "onNewScrollContext", "}", "/", "/", "and", "it", "is", "then", "verified", ",", "before", "every", "use", "of", "the", "scroll", ",", "in", "/", "/", "{", "@", "code", "SecuritySearchOperationListener", "#", "validateSearchContext", "}", ".", "/", "/", "The", "DLS", "/", "FLS", "permissions", "are", "used", "inside", "the", "{", "@", "code", "DirectoryReader", "}", "that", "{", "@", "code", "SecurityIndexReaderWrapper", "}", "/", "/", "built", "while", "handling", "the", "initial", "search", "request", ".", "In", "addition", ",", "for", "consistency", ",", "the", "DLS", "/", "FLS", "permissions", "from", "/", "/", "the", "originating", "search", "request", "are", "attached", "to", "the", "thread", "context", "upon", "validating", "the", "scroll", ".", "listener", ".", "onResponse", "(", "new", "IndexAuthorizationResult", "(", "true", ",", "null", ")", ");", "}", "}", "else", "{", "assert", "false", ":", "@", "@", "-", "5", ",", "18", "+", "5", ",", "21", "@", "@", "*", "/", "package", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "authz", ";", "import", "org", ".", "elasticsearch", ".", "ElasticsearchSecurityException", ";", "import", "org", ".", "elasticsearch", ".", "common", ".", "util", ".", "concurrent", ".", "ThreadContext", ";", "import", "org", ".", "elasticsearch", ".", "index", ".", "shard", ".", "SearchOperationListener", ";", "import", "org", ".", "elasticsearch", ".", "license", ".", "XPackLicenseState", ";", "import", "org", ".", "elasticsearch", ".", "search", ".", "SearchContextMissingException", ";", "import", "org", ".", "elasticsearch", ".", "search", ".", "internal", ".", "ScrollContext", ";", "import", "org", ".", "elasticsearch", ".", "search", ".", "internal", ".", "SearchContext", ";", "import", "org", ".", "elasticsearch", ".", "transport", ".", "TransportRequest", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "audit", ".", "AuditTrailService", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authc", ".", "Authentication", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authc", ".", "AuthenticationField", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "audit", ".", "AuditUtil", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authz", ".", "AuthorizationEngine", ".", "AuthorizationInfo", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authz", ".", "AuthorizationServiceField", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authz", ".", "accesscontrol", ".", "IndicesAccessControl", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "audit", ".", "AuditTrailService", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "audit", ".", "AuditUtil", ";", "import", "static", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "authz", ".", "AuthorizationService", ".", "AUTHORIZATION_INFO_KEY", ";", "import", "static", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "authz", ".", "AuthorizationService", ".", "ORIGINATING_ACTION_KEY", ";", "@", "@", "-", "50", ",", "6", "+", "53", ",", "9", "@", "@", "public", "void", "onNewScrollContext", "(", "SearchContext", "searchContext", ")", "{", "if", "(", "licenseState", ".", "isAuthAllowed", "(", "))", "{", "searchContext", ".", "scrollContext", "(", ").", "putInContext", "(", "AuthenticationField", ".", "AUTHENTICATION_KEY", ",", "Authentication", ".", "getAuthentication", "(", "threadContext", ")", ");", "IndicesAccessControl", "indicesAccessControl", "=", "threadContext", ".", "getTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ";", "assert", "indicesAccessControl", "!", "=", "null", ":", "\"", "thread", "context", "does", "not", "contain", "index", "access", "control", "\"", ";", "searchContext", ".", "scrollContext", "(", ").", "putInContext", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ",", "indicesAccessControl", ")", ";", "}", "}", "@", "@", "-", "66", ",", "6", "+", "72", ",", "38", "@", "@", "public", "void", "validateSearchContext", "(", "SearchContext", "searchContext", ",", "TransportRequest", "final", "String", "action", "=", "threadContext", ".", "getTransient", "(", "ORIGINATING_ACTION_KEY", ")", ";", "ensureAuthenticatedUserIsSame", "(", "originalAuth", ",", "current", ",", "auditTrailService", ",", "searchContext", ".", "id", "(", "),", "action", ",", "request", ",", "AuditUtil", ".", "extractRequestId", "(", "threadContext", ")", ",", "threadContext", ".", "getTransient", "(", "AUTHORIZATION_INFO_KEY", ")", ");", "/", "/", "piggyback", "on", "context", "validation", "to", "assert", "the", "DLS", "/", "FLS", "permissions", "on", "the", "thread", "context", "of", "the", "scroll", "search", "handler", "if", "(", "null", "=", "=", "threadContext", ".", "getTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ")", "{", "/", "/", "fill", "in", "the", "DLS", "and", "FLS", "permissions", "for", "the", "scroll", "search", "action", "from", "the", "scroll", "context", "IndicesAccessControl", "scrollIndicesAccessControl", "=", "searchContext", ".", "scrollContext", "(", ").", "getFromContext", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ";", "assert", "scrollIndicesAccessControl", "!", "=", "null", ":", "\"", "scroll", "does", "not", "contain", "index", "access", "control", "\"", ";", "threadContext", ".", "putTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ",", "scrollIndicesAccessControl", ")", ";", "}", "}", "}", "}", "@", "Override", "public", "void", "onPreFetchPhase", "(", "SearchContext", "searchContext", ")", "{", "ensureIndicesAccessControlForScrollThreadContext", "(", "searchContext", ")", ";", "}", "@", "Override", "public", "void", "onPreQueryPhase", "(", "SearchContext", "searchContext", ")", "{", "ensureIndicesAccessControlForScrollThreadContext", "(", "searchContext", ")", ";", "}", "void", "ensureIndicesAccessControlForScrollThreadContext", "(", "SearchContext", "searchContext", ")", "{", "if", "(", "licenseState", ".", "isAuthAllowed", "(", ")", "&", "&", "searchContext", ".", "scrollContext", "(", ")", "!", "=", "null", ")", "{", "IndicesAccessControl", "scrollIndicesAccessControl", "=", "searchContext", ".", "scrollContext", "(", ").", "getFromContext", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ";", "IndicesAccessControl", "threadIndicesAccessControl", "=", "threadContext", ".", "getTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ";", "if", "(", "scrollIndicesAccessControl", "!", "=", "threadIndicesAccessControl", ")", "{", "throw", "new", "ElasticsearchSecurityException", "(", "\"[", "\"", "+", "searchContext", ".", "id", "(", ")", "+", "\"", "]", "expected", "scroll", "indices", "access", "control", "[", "\"", "scrollIndicesAccessControl", ".", "toString", "(", ")", "+", "\"", "]", "but", "found", "[", "\"", "+", "threadIndicesAccessControl", ".", "toString", "(", ")", "+", "\"", "]", "in", "thread", "\"", "\"", "context", "\"", ");", "}", "}", "}", "@", "@", "-", "26", ",", "6", "+", "26", ",", "7", "@", "@", "import", "org", ".", "elasticsearch", ".", "common", ".", "xcontent", ".", "XContentBuilder", ";", "import", "org", ".", "elasticsearch", ".", "common", ".", "xcontent", ".", "XContentFactory", ";", "import", "org", ".", "elasticsearch", ".", "index", ".", "IndexModule", ";", "import", "org", ".", "elasticsearch", ".", "index", ".", "query", ".", "QueryBuilder", ";", "import", "org", ".", "elasticsearch", ".", "index", ".", "query", ".", "QueryBuilders", ";", "import", "org", ".", "elasticsearch", ".", "indices", ".", "IndicesRequestCache", ";", "import", "org", ".", "elasticsearch", ".", "join", ".", "ParentJoinPlugin", ";", "@", "@", "-", "768", ",", "6", "+", "769", ",", "114", "@", "@", "public", "void", "testQueryCache", "(", ")", "throws", "Exception", "{", "}", "}", "public", "void", "testScrollWithQueryCache", "(", ")", "{", "assertAcked", "(", "client", "(", ").", "admin", "(", ").", "indices", "(", ").", "prepareCreate", "(", "\"", "test", "\"", ")", ".", "setSettings", "(", "Settings", ".", "builder", "(", ").", "put", "(", "IndexModule", ".", "INDEX_QUERY_CACHE_EVERYTHING_SETTING", ".", "getKey", "(", "),", "true", ")", ")", ".", "addMapping", "(", "\"", "type1", "\"", ",", "\"", "field1", "\"", ",", "\"", "type", "=", "text", "\"", ",", "\"", "field2", "\"", ",", "\"", "type", "=", "text", "\"", ")", ")", ";", "final", "int", "numDocs", "=", "scaledRandomIntBetween", "(", "2", ",", "4", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "numDocs", ";", "i", "+", "+)", "{", "client", "(", ").", "prepareIndex", "(", "\"", "test", "\"", ",", "\"", "type1", "\"", ",", "String", ".", "valueOf", "(", "i", ")", ")", ".", "setSource", "(", "\"", "field1", "\"", ",", "\"", "value1", "\"", ",", "\"", "field2", "\"", ",", "\"", "value2", "\"", ")", ".", "get", "(", ");", "}", "refresh", "(", "\"", "test", "\"", ");", "final", "QueryBuilder", "cacheableQueryBuilder", "=", "constantScoreQuery", "(", "termQuery", "(", "\"", "field1", "\"", ",", "\"", "value1", "\"", "))", ";", "SearchResponse", "user1SearchResponse", "=", "null", ";", "SearchResponse", "user2SearchResponse", "=", "null", ";", "int", "scrolledDocsUser1", "=", "0", ";", "final", "int", "numScrollSearch", "=", "scaledRandomIntBetween", "(", "20", ",", "30", ")", ";", "try", "{", "for", "(", "int", "i", "=", "0", ";", "i", "<", "numScrollSearch", ";", "i", "+", "+)", "{", "if", "(", "randomBoolean", "(", "))", "{", "if", "(", "user2SearchResponse", "=", "=", "null", ")", "{", "user2SearchResponse", "=", "client", "(", ").", "filterWithHeader", "(", "Collections", ".", "singletonMap", "(", "BASIC_AUTH_HEADER", ",", "basicAuthHeaderValue", "(", "\"", "user2", "\"", ",", "USERS_PASSWD", ")", "))", ".", "prepareSearch", "(", "\"", "test", "\"", ")", ".", "setQuery", "(", "cacheableQueryBuilder", ")", ".", "setScroll", "(", "TimeValue", ".", "timeValueMinutes", "(", "10L", ")", ")", ".", "setSize", "(", "1", ")", ".", "setFetchSource", "(", "true", ")", ".", "get", "(", ");", "assertThat", "(", "user2SearchResponse", ".", "getHits", "(", ").", "getTotalHits", "(", "),", "is", "(", "(", "long", ")", "0", ")", ");", "assertThat", "(", "user2SearchResponse", ".", "getHits", "(", ").", "getHits", "(", ").", "length", ",", "is", "(", "0", ")", ");", "}", "else", "{", "/", "/", "make", "sure", "scroll", "is", "empty", "user2SearchResponse", "=", "client", "(", ")", ".", "filterWithHeader", "(", "Collections", ".", "singletonMap", "(", "BASIC_AUTH_HEADER", ",", "basicAuthHeaderValue", "(", "\"", "user2", "\"", ",", "USERS_PASSWD", ")", "))", ".", "prepareSearchScroll", "(", "user2SearchResponse", ".", "getScrollId", "(", "))", ".", "setScroll", "(", "TimeValue", ".", "timeValueMinutes", "(", "10L", ")", ")", ".", "get", "(", ");", "assertThat", "(", "user2SearchResponse", ".", "getHits", "(", ").", "getTotalHits", "(", "),", "is", "(", "(", "long", ")", "0", ")", ");", "assertThat", "(", "user2SearchResponse", ".", "getHits", "(", ").", "getHits", "(", ").", "length", ",", "is", "(", "0", ")", ");", "if", "(", "randomBoolean", "(", "))", "{", "/", "/", "maybe", "reuse", "the", "scroll", "even", "if", "empty", "client", "(", ").", "prepareClearScroll", "(", ").", "addScrollId", "(", "user2SearchResponse", ".", "getScrollId", "(", "))", ".", "get", "(", ");", "user2SearchResponse", "=", "null", ";", "}", "}", "}", "else", "{", "if", "(", "user1SearchResponse", "=", "=", "null", ")", "{", "user1SearchResponse", "=", "client", "(", ").", "filterWithHeader", "(", "Collections", ".", "singletonMap", "(", "BASIC_AUTH_HEADER", ",", "basicAuthHeaderValue", "(", "\"", "user1", "\"", ",", "USERS_PASSWD", ")", "))", ".", "prepareSearch", "(", "\"", "test", "\"", ")", ".", "setQuery", "(", "cacheableQueryBuilder", ")", ".", "setScroll", "(", "TimeValue", ".", "timeValueMinutes", "(", "10L", ")", ")", ".", "setSize", "(", "1", ")", ".", "setFetchSource", "(", "true", ")", ".", "get", "(", ");", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getTotalHits", "(", "),", "is", "(", "(", "long", ")", "numDocs", ")", ");", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getHits", "(", ").", "length", ",", "is", "(", "1", ")", ");", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getAt", "(", "0", ")", ".", "getSourceAsMap", "(", ").", "size", "(", "),", "is", "(", "1", ")", ");", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getAt", "(", "0", ")", ".", "getSourceAsMap", "(", ").", "get", "(", "\"", "field1", "\"", "),", "is", "(", "\"", "value1", "\"", "))", ";", "scrolledDocsUser1", "+", "+;", "}", "else", "{", "user1SearchResponse", "=", "client", "(", ")", ".", "filterWithHeader", "(", "Collections", ".", "singletonMap", "(", "BASIC_AUTH_HEADER", ",", "basicAuthHeaderValue", "(", "\"", "user1", "\"", ",", "USERS_PASSWD", ")", "))", ".", "prepareSearchScroll", "(", "user1SearchResponse", ".", "getScrollId", "(", "))", ".", "setScroll", "(", "TimeValue", ".", "timeValueMinutes", "(", "10L", ")", ")", ".", "get", "(", ");", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getTotalHits", "(", "),", "is", "(", "(", "long", ")", "numDocs", ")", ");", "if", "(", "scrolledDocsUser1", "<", "numDocs", ")", "{", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getHits", "(", ").", "length", ",", "is", "(", "1", ")", ");", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getAt", "(", "0", ")", ".", "getSourceAsMap", "(", ").", "size", "(", "),", "is", "(", "1", ")", ");", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getAt", "(", "0", ")", ".", "getSourceAsMap", "(", ").", "get", "(", "\"", "field1", "\"", "),", "is", "(", "\"", "value1", "\"", "))", ";", "scrolledDocsUser1", "+", "+;", "}", "else", "{", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getHits", "(", ").", "length", ",", "is", "(", "0", ")", ");", "if", "(", "randomBoolean", "(", "))", "{", "/", "/", "maybe", "reuse", "the", "scroll", "even", "if", "empty", "if", "(", "user1SearchResponse", ".", "getScrollId", "(", ")", "!", "=", "null", ")", "{", "client", "(", ").", "prepareClearScroll", "(", ").", "addScrollId", "(", "user1SearchResponse", ".", "getScrollId", "(", "))", ".", "get", "(", ");", "}", "user1SearchResponse", "=", "null", ";", "scrolledDocsUser1", "=", "0", ";", "}", "}", "}", "}", "}", "}", "finally", "{", "if", "(", "user1SearchResponse", "!", "=", "null", ")", "{", "String", "scrollId", "=", "user1SearchResponse", ".", "getScrollId", "(", ");", "if", "(", "scrollId", "!", "=", "null", ")", "{", "client", "(", ").", "prepareClearScroll", "(", ").", "addScrollId", "(", "scrollId", ")", ".", "get", "(", ");", "}", "}", "if", "(", "user2SearchResponse", "!", "=", "null", ")", "{", "String", "scrollId", "=", "user2SearchResponse", ".", "getScrollId", "(", ");", "if", "(", "scrollId", "!", "=", "null", ")", "{", "client", "(", ").", "prepareClearScroll", "(", ").", "addScrollId", "(", "scrollId", ")", ".", "get", "(", ");", "}", "}", "}", "}", "public", "void", "testRequestCache", "(", ")", "throws", "Exception", "{", "assertAcked", "(", "client", "(", ").", "admin", "(", ").", "indices", "(", ").", "prepareCreate", "(", "\"", "test", "\"", ")", ".", "setSettings", "(", "Settings", ".", "builder", "(", ").", "put", "(", "IndicesRequestCache", ".", "INDEX_CACHE_REQUEST_ENABLED_SETTING", ".", "getKey", "(", "),", "true", ")", ")", "@", "@", "-", "22", ",", "9", "+", "22", ",", "11", "@", "@", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authc", ".", "Authentication", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authc", ".", "Authentication", ".", "RealmRef", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authc", ".", "AuthenticationField", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authz", ".", "AuthorizationEngine", ".", "AuthorizationInfo", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authz", ".", "AuthorizationServiceField", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authz", ".", "accesscontrol", ".", "IndicesAccessControl", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "user", ".", "User", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "audit", ".", "AuditTrailService", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authz", ".", "AuthorizationEngine", ".", "AuthorizationInfo", ";", "import", "java", ".", "util", ".", "Collections", ";", "@", "@", "-", "34", ",", "6", "+", "36", ",", "8", "@", "@", "import", "static", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "authz", ".", "AuthorizationService", ".", "ORIGINATING_ACTION_KEY", ";", "import", "static", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "authz", ".", "AuthorizationServiceTests", ".", "authzInfoRoles", ";", "import", "static", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "authz", ".", "SecuritySearchOperationListener", ".", "ensureAuthenticatedUserIsSame", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "is", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "nullValue", ";", "import", "static", "org", ".", "mockito", ".", "Matchers", ".", "eq", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "times", ";", "@", "@", "-", "69", ",", "6", "+", "73", ",", "8", "@", "@", "public", "void", "testOnNewContextSetsAuthentication", "(", ")", "throws", "Exception", "{", "AuditTrailService", "auditTrailService", "=", "mock", "(", "AuditTrailService", ".", "class", ")", ";", "Authentication", "authentication", "=", "new", "Authentication", "(", "new", "User", "(", "\"", "test", "\"", ",", "\"", "role", "\"", "),", "new", "RealmRef", "(", "\"", "realm", "\"", ",", "\"", "file", "\"", ",", "\"", "node", "\"", "),", "null", ")", ";", "authentication", ".", "writeToContext", "(", "threadContext", ")", ";", "IndicesAccessControl", "indicesAccessControl", "=", "mock", "(", "IndicesAccessControl", ".", "class", ")", ";", "threadContext", ".", "putTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ",", "indicesAccessControl", ")", ";", "SecuritySearchOperationListener", "listener", "=", "new", "SecuritySearchOperationListener", "(", "threadContext", ",", "licenseState", ",", "auditTrailService", ")", ";", "listener", ".", "onNewScrollContext", "(", "testSearchContext", ")", ";", "@", "@", "-", "77", ",", "6", "+", "83", ",", "9", "@", "@", "public", "void", "testOnNewContextSetsAuthentication", "(", ")", "throws", "Exception", "{", "assertEquals", "(", "authentication", ",", "contextAuth", ")", ";", "assertEquals", "(", "scroll", ",", "testSearchContext", ".", "scrollContext", "(", ").", "scroll", ")", ";", "assertThat", "(", "testSearchContext", ".", "scrollContext", "(", ").", "getFromContext", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ",", "is", "(", "indicesAccessControl", ")", ");", "verify", "(", "licenseState", ")", ".", "isAuthAllowed", "(", ");", "verifyZeroInteractions", "(", "auditTrailService", ")", ";", "}", "@", "@", "-", "86", ",", "6", "+", "95", ",", "8", "@", "@", "public", "void", "testValidateSearchContext", "(", ")", "throws", "Exception", "{", "testSearchContext", ".", "scrollContext", "(", "new", "ScrollContext", "(", "))", ";", "testSearchContext", ".", "scrollContext", "(", ").", "putInContext", "(", "AuthenticationField", ".", "AUTHENTICATION_KEY", ",", "new", "Authentication", "(", "new", "User", "(", "\"", "test", "\"", ",", "\"", "role", "\"", "),", "new", "RealmRef", "(", "\"", "realm", "\"", ",", "\"", "file", "\"", ",", "\"", "node", "\"", "),", "null", ")", ");", "final", "IndicesAccessControl", "indicesAccessControl", "=", "mock", "(", "IndicesAccessControl", ".", "class", ")", ";", "testSearchContext", ".", "scrollContext", "(", ").", "putInContext", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ",", "indicesAccessControl", ")", ";", "testSearchContext", ".", "scrollContext", "(", ").", "scroll", "=", "new", "Scroll", "(", "TimeValue", ".", "timeValueSeconds", "(", "2L", ")", ");", "XPackLicenseState", "licenseState", "=", "mock", "(", "XPackLicenseState", ".", "class", ")", ";", "when", "(", "licenseState", ".", "isAuthAllowed", "(", "))", ".", "thenReturn", "(", "true", ")", ";", "@", "@", "-", "97", ",", "6", "+", "108", ",", "7", "@", "@", "public", "void", "testValidateSearchContext", "(", ")", "throws", "Exception", "{", "Authentication", "authentication", "=", "new", "Authentication", "(", "new", "User", "(", "\"", "test", "\"", ",", "\"", "role", "\"", "),", "new", "RealmRef", "(", "\"", "realm", "\"", ",", "\"", "file", "\"", ",", "\"", "node", "\"", "),", "null", ")", ";", "authentication", ".", "writeToContext", "(", "threadContext", ")", ";", "listener", ".", "validateSearchContext", "(", "testSearchContext", ",", "Empty", ".", "INSTANCE", ")", ";", "assertThat", "(", "threadContext", ".", "getTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ",", "is", "(", "indicesAccessControl", ")", ");", "verify", "(", "licenseState", ")", ".", "isAuthAllowed", "(", ");", "verifyZeroInteractions", "(", "auditTrailService", ")", ";", "}", "@", "@", "-", "107", ",", "6", "+", "119", ",", "7", "@", "@", "public", "void", "testValidateSearchContext", "(", ")", "throws", "Exception", "{", "Authentication", "authentication", "=", "new", "Authentication", "(", "new", "User", "(", "\"", "test", "\"", ",", "\"", "role", "\"", "),", "new", "RealmRef", "(", "realmName", ",", "\"", "file", "\"", ",", "nodeName", ")", ",", "null", ")", ";", "authentication", ".", "writeToContext", "(", "threadContext", ")", ";", "listener", ".", "validateSearchContext", "(", "testSearchContext", ",", "Empty", ".", "INSTANCE", ")", ";", "assertThat", "(", "threadContext", ".", "getTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ",", "is", "(", "indicesAccessControl", ")", ");", "verify", "(", "licenseState", ",", "times", "(", "2", ")", ").", "isAuthAllowed", "(", ");", "verifyZeroInteractions", "(", "auditTrailService", ")", ";", "}", "@", "@", "-", "123", ",", "6", "+", "136", ",", "7", "@", "@", "public", "void", "testValidateSearchContext", "(", ")", "throws", "Exception", "{", "final", "InternalScrollSearchRequest", "request", "=", "new", "InternalScrollSearchRequest", "(", ");", "SearchContextMissingException", "expected", "=", "expectThrows", "(", "SearchContextMissingException", ".", "class", ",", "(", ")", "-", ">", "listener", ".", "validateSearchContext", "(", "testSearchContext", ",", "request", ")", ");", "assertThat", "(", "threadContext", ".", "getTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ",", "nullValue", "(", "))", ";", "assertEquals", "(", "testSearchContext", ".", "id", "(", "),", "expected", ".", "id", "(", "))", ";", "verify", "(", "licenseState", ",", "times", "(", "3", ")", ").", "isAuthAllowed", "(", ");", "verify", "(", "auditTrailService", ")", ".", "accessDenied", "(", "eq", "(", "null", ")", ",", "eq", "(", "authentication", ")", ",", "eq", "(", "\"", "action", "\"", "),", "eq", "(", "request", ")", ",", "@", "@", "-", "141", ",", "6", "+", "155", ",", "7", "@", "@", "public", "void", "testValidateSearchContext", "(", ")", "throws", "Exception", "{", "threadContext", ".", "putTransient", "(", "ORIGINATING_ACTION_KEY", ",", "\"", "action", "\"", ");", "final", "InternalScrollSearchRequest", "request", "=", "new", "InternalScrollSearchRequest", "(", ");", "listener", ".", "validateSearchContext", "(", "testSearchContext", ",", "request", ")", ";", "assertThat", "(", "threadContext", ".", "getTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ",", "is", "(", "indicesAccessControl", ")", ");", "verify", "(", "licenseState", ",", "times", "(", "4", ")", ").", "isAuthAllowed", "(", ");", "verifyNoMoreInteractions", "(", "auditTrailService", ")", ";", "}", "@", "@", "-", "159", ",", "6", "+", "174", ",", "7", "@", "@", "public", "void", "testValidateSearchContext", "(", ")", "throws", "Exception", "{", "final", "InternalScrollSearchRequest", "request", "=", "new", "InternalScrollSearchRequest", "(", ");", "SearchContextMissingException", "expected", "=", "expectThrows", "(", "SearchContextMissingException", ".", "class", ",", "(", ")", "-", ">", "listener", ".", "validateSearchContext", "(", "testSearchContext", ",", "request", ")", ");", "assertThat", "(", "threadContext", ".", "getTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ",", "nullValue", "(", "))", ";", "assertEquals", "(", "testSearchContext", ".", "id", "(", "),", "expected", ".", "id", "(", "))", ";", "verify", "(", "licenseState", ",", "times", "(", "5", ")", ").", "isAuthAllowed", "(", ");", "verify", "(", "auditTrailService", ")", ".", "accessDenied", "(", "eq", "(", "null", ")", ",", "eq", "(", "authentication", ")", ",", "eq", "(", "\"", "action", "\"", "),", "eq", "(", "request", ")", ","], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["zlib:", "Clear", "buffer", "pointers", "on", "cleanup", "(#444)", "The", "pointers", "to", "the", "buffers", "were", "freed,", "and", "the", "size", "fields", "were", "set", "to", "0,", "but", "the", "buffer", "pointers", "themsef", "was", "not", "set", "to", "NULL,", "when", "shutting", "down,", "meaning", "the", "next", "time", "used,", "NULL", "checks", "would", "not", "tell", "whether", "the", "pointer", "is", "valid.", "This", "caused", "crashes", "ending", "with", "#0", "0x00007ffff73729e5", "in", "raise", "()", "from", "/lib64/libc.so.6", "#1", "0x00007ffff735b895", "in", "abort", "()", "from", "/lib64/libc.so.6", "#2", "0x00007ffff73b6857", "in", "__libc_message", "()", "from", "/lib64/libc.so.6", "#3", "0x00007ffff73bdd7c", "in", "malloc_printerr", "()", "from", "/lib64/libc.so.6", "#4", "0x00007ffff73c2f1a", "in", "realloc", "()", "from", "/lib64/libc.so.6", "#5", "0x00007ffff78b558e", "in", "rfbSendOneRectEncodingZlib", "(cl=0x4a4b80,", "x=0,", "y=0,", "w=800,", "h=40)", "at", "/home/jonas/Dev/gnome/libvncserver/libvncserver/zlib.c:106", "#6", "0x00007ffff78b5dec", "in", "rfbSendRectEncodingZlib", "(cl=0x4a4b80,", "x=0,", "y=0,", "w=800,", "h=600)", "at", "/home/jonas/Dev/gnome/libvncserver/libvncserver/zlib.c:308", "#7", "0x00007ffff7899453", "in", "rfbSendFramebufferUpdate", "(cl=0x4a4b80,", "givenUpdateRegion=0x49ef70)", "at", "/home/jonas/Dev/gnome/libvncserver/libvncserver/rfbserver.c:3264", "#8", "0x00007ffff789079d", "in", "rfbUpdateClient", "(cl=0x4a4b80)", "at", "/home/jonas/Dev/gnome/libvncserver/libvncserver/main.c:1275", "#9", "0x00007ffff78905f5", "in", "rfbProcessEvents", "(screen=0x4d5790,", "usec=0)", "at", "/home/jonas/Dev/gnome/libvncserver/libvncserver/main.c:1251"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["tracing:", "Check", "for", "no", "filter", "when", "processing", "event", "filters", "The", "syzkaller", "detected", "a", "out-of-bounds", "issue", "with", "the", "events", "filter", "code,", "specifically", "here:", "prog[N].pred", "=", "NULL;", "/*", "#13", "*/", "prog[N].target", "=", "1;", "/*", "TRUE", "*/", "prog[N+1].pred", "=", "NULL;", "prog[N+1].target", "=", "0;", "/*", "FALSE", "*/", "->", "prog[N-1].target", "=", "N;", "prog[N-1].when_to_branch", "=", "false;", "As", "that's", "the", "first", "reference", "to", "a", "\"N-1\"", "index,", "it", "appears", "that", "the", "code", "got", "here", "with", "N", "=", "0,", "which", "means", "the", "filter", "parser", "found", "no", "filter", "to", "parse", "(which", "shouldn't", "ever", "happen,", "but", "apparently", "it", "did).", "Add", "a", "new", "error", "to", "the", "parsing", "code", "that", "will", "check", "to", "make", "sure", "that", "N", "is", "not", "zero", "before", "going", "into", "this", "part", "of", "the", "code.", "If", "N", "=", "0,", "then", "-EINVAL", "is", "returned,", "and", "a", "error", "message", "is", "added", "to", "the", "filter.", "Cc:", "stable@vger.kernel.org", "Fixes:", "80765597bc587", "(\"tracing:", "Rewrite", "filter", "logic", "to", "be", "simpler", "and", "faster\")", "Reported-by:", "air", "icy", "<icytxw@gmail.com>", "bugzilla", "url:", "https://bugzilla.kernel.org/show_bug.cgi?id=200019", "Signed-off-by:", "Steven", "Rostedt", "(VMware)", "<rostedt@goodmis.org>"], "code_tokens": ["@", "@", "-", "78", ",", "7", "+", "78", ",", "8", "@", "@", "static", "const", "char", "*", "ops", "[", "]", "=", "{", "OPS", "}", ";", "C", "(", "TOO_MANY_PREDS", ",", "\"", "Too", "many", "terms", "in", "predicate", "expression", "\"", "),", "\\", "C", "(", "INVALID_FILTER", ",", "\"", "Meaningless", "filter", "expression", "\"", "),", "\\", "C", "(", "IP_FIELD_ONLY", ",", "\"", "Only", "'", "ip", "'", "field", "is", "supported", "for", "function", "trace", "\"", "),", "\\", "C", "(", "INVALID_VALUE", ",", "\"", "Invalid", "value", "(", "did", "you", "forget", "quotes", ")", "?\"", "),", "C", "(", "INVALID_VALUE", ",", "\"", "Invalid", "value", "(", "did", "you", "forget", "quotes", ")", "?\"", "),", "\\", "C", "(", "NO_FILTER", ",", "\"", "No", "filter", "found", "\"", "),", "#", "undef", "C", "#", "define", "C", "(", "a", ",", "b", ")", "FILT_ERR_", "#", "#", "a", "@", "@", "-", "550", ",", "6", "+", "551", ",", "13", "@", "@", "predicate_parse", "(", "const", "char", "*", "str", ",", "int", "nr_parens", ",", "int", "nr_preds", ",", "goto", "out_free", ";", "}", "if", "(", "!", "N", ")", "{", "/", "*", "No", "program", "?", "*", "/", "ret", "=", "-", "EINVAL", ";", "parse_error", "(", "pe", ",", "FILT_ERR_NO_FILTER", ",", "ptr", "-", "str", ")", ";", "goto", "out_free", ";", "}", "prog", "[", "N", "]", ".", "pred", "=", "NULL", ";", "/", "*", "#", "13", "*", "/", "prog", "[", "N", "]", ".", "target", "=", "1", ";", "/", "*", "TRUE", "*", "/", "prog", "[", "N", "+", "1", "]", ".", "pred", "=", "NULL", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Btrfs:", "fix", "hash", "overflow", "handling", "The", "handling", "for", "directory", "crc", "hash", "overflows", "was", "fairly", "obscure,", "split_leaf", "returns", "EOVERFLOW", "when", "we", "try", "to", "extend", "the", "item", "and", "that", "is", "supposed", "to", "bubble", "up", "to", "userland.", "For", "a", "while", "it", "did", "so,", "but", "along", "the", "way", "we", "added", "better", "handling", "of", "errors", "and", "forced", "the", "FS", "readonly", "if", "we", "hit", "IO", "errors", "during", "the", "directory", "insertion.", "Along", "the", "way,", "we", "started", "testing", "only", "for", "EEXIST", "and", "the", "EOVERFLOW", "case", "was", "dropped.", "The", "end", "result", "is", "that", "we", "may", "force", "the", "FS", "readonly", "if", "we", "catch", "a", "directory", "hash", "bucket", "overflow.", "This", "fixes", "a", "few", "problem", "spots.", "First", "I", "add", "tests", "for", "EOVERFLOW", "in", "the", "places", "where", "we", "can", "safely", "just", "return", "the", "error", "up", "the", "chain.", "btrfs_rename", "is", "harder", "though,", "because", "it", "tries", "to", "insert", "the", "new", "directory", "item", "only", "after", "it", "has", "already", "unlinked", "anything", "the", "rename", "was", "going", "to", "overwrite.", "Rather", "than", "adding", "very", "complex", "logic,", "I", "added", "a", "helper", "to", "test", "for", "the", "hash", "overflow", "case", "early", "while", "it", "is", "still", "safe", "to", "bail", "out.", "Snapshot", "and", "subvolume", "creation", "had", "a", "similar", "problem,", "so", "they", "are", "using", "the", "new", "helper", "now", "too.", "Signed-off-by:", "Chris", "Mason", "<chris.mason@fusionio.com>", "Reported-by:", "Pascal", "Junod", "<pascal@junod.info>"], "code_tokens": ["@", "@", "-", "3283", ",", "6", "+", "3283", ",", "8", "@", "@", "void", "btrfs_update_root_times", "(", "struct", "btrfs_trans_handle", "*", "trans", ",", "struct", "btrfs_root", "*", "root", ")", ";", "/", "*", "dir", "-", "item", ".", "c", "*", "/", "int", "btrfs_check_dir_item_collision", "(", "struct", "btrfs_root", "*", "root", ",", "u64", "dir", ",", "const", "char", "*", "name", ",", "int", "name_len", ")", ";", "int", "btrfs_insert_dir_item", "(", "struct", "btrfs_trans_handle", "*", "trans", ",", "struct", "btrfs_root", "*", "root", ",", "const", "char", "*", "name", ",", "int", "name_len", ",", "struct", "inode", "*", "dir", ",", "@", "@", "-", "213", ",", "6", "+", "213", ",", "65", "@", "@", "struct", "btrfs_dir_item", "*", "btrfs_lookup_dir_item", "(", "struct", "btrfs_trans_handle", "*", "trans", ",", "return", "btrfs_match_dir_item_name", "(", "root", ",", "path", ",", "name", ",", "name_len", ")", ";", "}", "int", "btrfs_check_dir_item_collision", "(", "struct", "btrfs_root", "*", "root", ",", "u64", "dir", ",", "const", "char", "*", "name", ",", "int", "name_len", ")", "{", "int", "ret", ";", "struct", "btrfs_key", "key", ";", "struct", "btrfs_dir_item", "*", "di", ";", "int", "data_size", ";", "struct", "extent_buffer", "*", "leaf", ";", "int", "slot", ";", "struct", "btrfs_path", "*", "path", ";", "path", "=", "btrfs_alloc_path", "(", ");", "if", "(", "!", "path", ")", "return", "-", "ENOMEM", ";", "key", ".", "objectid", "=", "dir", ";", "btrfs_set_key_type", "(", "&", "key", ",", "BTRFS_DIR_ITEM_KEY", ")", ";", "key", ".", "offset", "=", "btrfs_name_hash", "(", "name", ",", "name_len", ")", ";", "ret", "=", "btrfs_search_slot", "(", "NULL", ",", "root", ",", "&", "key", ",", "path", ",", "0", ",", "0", ")", ";", "/", "*", "return", "back", "any", "errors", "*", "/", "if", "(", "ret", "<", "0", ")", "goto", "out", ";", "/", "*", "nothing", "found", ",", "we", "'", "re", "safe", "*", "/", "if", "(", "ret", ">", "0", ")", "{", "ret", "=", "0", ";", "goto", "out", ";", "}", "/", "*", "we", "found", "an", "item", ",", "look", "for", "our", "name", "in", "the", "item", "*", "/", "di", "=", "btrfs_match_dir_item_name", "(", "root", ",", "path", ",", "name", ",", "name_len", ")", ";", "if", "(", "di", ")", "{", "/", "*", "our", "exact", "name", "was", "found", "*", "/", "ret", "=", "-", "EEXIST", ";", "goto", "out", ";", "}", "/", "*", "*", "see", "if", "there", "is", "room", "in", "the", "item", "to", "insert", "this", "*", "name", "*", "/", "data_size", "=", "sizeof", "(", "*", "di", ")", "+", "name_len", "+", "sizeof", "(", "struct", "btrfs_item", ")", ";", "leaf", "=", "path", "-", ">", "nodes", "[", "0", "]", ";", "slot", "=", "path", "-", ">", "slots", "[", "0", "]", ";", "if", "(", "data_size", "+", "btrfs_item_size_nr", "(", "leaf", ",", "slot", ")", "sizeof", "(", "struct", "btrfs_item", ")", ">", "BTRFS_LEAF_DATA_SIZE", "(", "root", ")", ")", "{", "ret", "=", "-", "EOVERFLOW", ";", "}", "else", "{", "/", "*", "plenty", "of", "insertion", "room", "*", "/", "ret", "=", "0", ";", "}", "out", ":", "btrfs_free_path", "(", "path", ")", ";", "return", "ret", ";", "}", "/", "*", "*", "lookup", "a", "directory", "item", "based", "on", "index", ".", "'", "dir", "'", "is", "the", "objectid", "*", "we", "'", "re", "searching", "in", ",", "and", "'", "mod", "'", "tells", "us", "if", "you", "plan", "on", "deleting", "the", "@", "@", "-", "4885", ",", "7", "+", "4885", ",", "7", "@", "@", "int", "btrfs_add_link", "(", "struct", "btrfs_trans_handle", "*", "trans", ",", "ret", "=", "btrfs_insert_dir_item", "(", "trans", ",", "root", ",", "name", ",", "name_len", ",", "parent_inode", ",", "&", "key", ",", "btrfs_inode_type", "(", "inode", ")", ",", "index", ")", ";", "if", "(", "ret", "=", "=", "-", "EEXIST", ")", "if", "(", "ret", "=", "=", "-", "EEXIST", "|", "|", "ret", "=", "=", "-", "EOVERFLOW", ")", "goto", "fail_dir_item", ";", "else", "if", "(", "ret", ")", "{", "btrfs_abort_transaction", "(", "trans", ",", "root", ",", "ret", ")", ";", "@", "@", "-", "7336", ",", "6", "+", "7336", ",", "28", "@", "@", "static", "int", "btrfs_rename", "(", "struct", "inode", "*", "old_dir", ",", "struct", "dentry", "*", "old_dentry", ",", "if", "(", "S_ISDIR", "(", "old_inode", "-", ">", "i_mode", ")", "&", "&", "new_inode", "&", "&", "new_inode", "-", ">", "i_size", ">", "BTRFS_EMPTY_DIR_SIZE", ")", "return", "-", "ENOTEMPTY", ";", "/", "*", "check", "for", "collisions", ",", "even", "if", "the", "name", "isn", "'", "t", "there", "*", "/", "ret", "=", "btrfs_check_dir_item_collision", "(", "root", ",", "new_dir", "-", ">", "i_ino", ",", "new_dentry", "-", ">", "d_name", ".", "name", ",", "new_dentry", "-", ">", "d_name", ".", "len", ")", ";", "if", "(", "ret", ")", "{", "if", "(", "ret", "=", "=", "-", "EEXIST", ")", "{", "/", "*", "we", "shouldn", "'", "t", "get", "*", "eexist", "without", "a", "new_inode", "*", "/", "if", "(", "!", "new_inode", ")", "{", "WARN_ON", "(", "1", ")", ";", "return", "ret", ";", "}", "}", "else", "{", "/", "*", "maybe", "-", "EOVERFLOW", "*", "/", "return", "ret", ";", "}", "}", "ret", "=", "0", ";", "/", "*", "*", "we", "'", "re", "using", "rename", "to", "replace", "one", "file", "with", "another", ".", "*", "and", "the", "replacement", "file", "is", "large", ".", "Start", "IO", "on", "it", "now", "so", "@", "@", "-", "710", ",", "6", "+", "710", ",", "16", "@", "@", "static", "noinline", "int", "btrfs_mksubvol", "(", "struct", "path", "*", "parent", ",", "if", "(", "error", ")", "goto", "out_dput", ";", "/", "*", "*", "even", "if", "this", "name", "doesn", "'", "t", "exist", ",", "we", "may", "get", "hash", "collisions", ".", "*", "check", "for", "them", "now", "when", "we", "can", "safely", "fail", "*", "/", "error", "=", "btrfs_check_dir_item_collision", "(", "BTRFS_I", "(", "dir", ")", "->", "root", ",", "dir", "-", ">", "i_ino", ",", "name", ",", "namelen", ")", ";", "if", "(", "error", ")", "goto", "out_dput", ";", "down_read", "(", "&", "BTRFS_I", "(", "dir", ")", "->", "root", "-", ">", "fs_info", "-", ">", "subvol_sem", ")", ";", "if", "(", "btrfs_root_refs", "(", "&", "BTRFS_I", "(", "dir", ")", "->", "root", "-", ">", "root_item", ")", "=", "=", "0", ")", "@", "@", "-", "1190", ",", "7", "+", "1190", ",", "7", "@", "@", "static", "noinline", "int", "create_pending_snapshot", "(", "struct", "btrfs_trans_handle", "*", "trans", ",", "parent_inode", ",", "&", "key", ",", "BTRFS_FT_DIR", ",", "index", ")", ";", "/", "*", "We", "have", "check", "then", "name", "at", "the", "beginning", ",", "so", "it", "is", "impossible", ".", "*", "/", "BUG_ON", "(", "ret", "=", "=", "-", "EEXIST", ")", ";", "BUG_ON", "(", "ret", "=", "=", "-", "EEXIST", "|", "|", "ret", "=", "=", "-", "EOVERFLOW", ")", ";", "if", "(", "ret", ")", "{", "btrfs_abort_transaction", "(", "trans", ",", "root", ",", "ret", ")", ";", "goto", "fail", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["TCP:", "Add", "a", "test", "with", "data", "in", "the", "RST", "segment"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["avfilter/formats:", "Remove", "avfilter_make_format64_list()", "The", "API", "it", "is", "part", "of", "has", "been", "made", "private", "long", "ago", "(see", "commit", "b74a1da49db5ebed51aceae6cacc2329288a92c1).", "Signed-off-by:", "Andreas", "Rheinhardt", "<andreas.rheinhardt@gmail.com>", "Signed-off-by:", "James", "Almer", "<jamrial@gmail.com>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Fix", "#76409:", "heap", "use", "after", "free", "in", "_php_stream_free", "We", "must", "not", "close", "the", "stream", "in", "exif_read_from_impl(),", "since", "it", "is", "the", "responsibility", "of", "the", "(caller's)", "caller", "to", "do", "so,", "if", "it", "actually", "opened", "the", "stream.", "We", "simplify", "the", "reproduce", "script,", "which", "is", "actually", "about", "supplying", "a", "path", "to", "a", "directory", "(opposed", "to", "a", "regular", "file),", "and", "use", "`.`", "instead", "of", "`/`", "to", "also", "make", "it", "work", "on", "Windows."], "code_tokens": ["@", "@", "-", "2", ",", "6", "+", "2", ",", "9", "@", "@", "PHP", "NEWS", "|", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "?", "?", "?", "??", "?", "??", "?,", "PHP", "7", ".", "2", ".", "8", "-", "EXIF", ":", ".", "Fixed", "bug", "#", "76409", "(", "heap", "use", "after", "free", "in", "_php_stream_free", ")", ".", "(", "cmb", ")", "07", "Jun", "2018", ",", "PHP", "7", ".", "2", ".", "7", "-", "Core", ":", "@", "@", "-", "4324", ",", "7", "+", "4324", ",", "7", "@", "@", "static", "int", "exif_read_from_impl", "(", "image_info_type", "*", "ImageInfo", ",", "php_stream", "*", "stream", ",", "i", "zend_string", "*", "base", ";", "if", "(", "(", "st", ".", "st_mode", "&", "S_IFMT", ")", "!", "=", "S_IFREG", ")", "{", "exif_error_docref", "(", "NULL", "EXIFERR_CC", ",", "ImageInfo", ",", "E_WARNING", ",", "\"", "Not", "a", "file", "\"", ");", "php_stream_close", "(", "ImageInfo", "-", ">", "infile", ")", ";", "ImageInfo", "-", ">", "infile", "=", "NULL", ";", "return", "FALSE", ";", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "14", "@", "@", "-", "-", "TEST", "-", "-", "Bug", "#", "76409", "(", "heap", "use", "after", "free", "in", "_php_stream_free", ")", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "'", "exif", "'", "))", "die", "(", "'", "skip", "exif", "extension", "not", "available", "'", ");", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "exif_read_data", "(", "'.", "')", ";", "?", ">", "=", "==", "DONE", "=", "==", "-", "-", "EXPECTF", "-", "-", "Warning", ":", "exif_read_data", "(", "):", "Not", "a", "file", "in", "%", "s", "on", "line", "%", "d", "=", "==", "DONE", "=", "=="], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["[CIFS]", "CIFS", "should", "honour", "umask", "This", "patch", "makes", "CIFS", "honour", "a", "process'", "umask", "like", "other", "filesystems.", "Of", "course", "the", "server", "is", "still", "free", "to", "munge", "the", "permissions", "if", "it", "wants", "to;", "but", "the", "client", "will", "send", "the", "\"right\"", "permissions", "to", "begin", "with.", "A", "few", "caveats:", "1)", "It", "only", "applies", "to", "filesystems", "that", "have", "CAP_UNIX", "(aka", "support", "unix", "extensions)", "2)", "It", "applies", "the", "correct", "mode", "to", "the", "follow", "up", "CIFSSMBUnixSetPerms()", "after", "remote", "creation", "When", "mode", "to", "CIFS/NTFS", "ACL", "mapping", "is", "complete", "we", "can", "do", "the", "same", "thing", "for", "that", "case", "for", "servers", "which", "do", "not", "support", "the", "Unix", "Extensions.", "Signed-off-by:", "Matt", "Keenen", "<matt@opcode-solutions.com>", "Signed-off-by:", "Steve", "French", "<sfrench@us.ibm.com>"], "code_tokens": ["@", "@", "-", "208", ",", "7", "+", "208", ",", "8", "@", "@", "cifs_create", "(", "struct", "inode", "*", "inode", ",", "struct", "dentry", "*", "direntry", ",", "int", "mode", ",", "/", "*", "If", "Open", "reported", "that", "we", "actually", "created", "a", "file", "then", "we", "now", "have", "to", "set", "the", "mode", "if", "possible", "*", "/", "if", "(", "(", "cifs_sb", "-", ">", "tcon", "-", ">", "ses", "-", ">", "capabilities", "&", "CAP_UNIX", ")", "&", "&", "(", "oplock", "&", "CIFS_CREATE_ACTION", ")", ")", "(", "oplock", "&", "CIFS_CREATE_ACTION", ")", ")", "{", "mode", "&", "=", "~", "current", "-", ">", "fs", "-", ">", "umask", ";", "if", "(", "cifs_sb", "-", ">", "mnt_cifs_flags", "&", "CIFS_MOUNT_SET_UID", ")", "{", "CIFSSMBUnixSetPerms", "(", "xid", ",", "pTcon", ",", "full_path", ",", "mode", ",", "(", "__u64", ")", "current", "-", ">", "fsuid", ",", "@", "@", "-", "226", ",", "7", "+", "227", ",", "7", "@", "@", "cifs_create", "(", "struct", "inode", "*", "inode", ",", "struct", "dentry", "*", "direntry", ",", "int", "mode", ",", "cifs_sb", "-", ">", "mnt_cifs_flags", "&", "CIFS_MOUNT_MAP_SPECIAL_CHR", ")", ";", "}", "else", "{", "}", "else", "{", "/", "*", "BB", "implement", "mode", "setting", "via", "Windows", "security", "descriptors", "e", ".", "g", ".", "*", "/", "/", "*", "CIFSSMBWinSetPerms", "(", "xid", ",", "pTcon", ",", "path", ",", "mode", ",", "-", "1", ",", "-", "1", ",", "nls", ")", ";*", "/", "@", "@", "-", "336", ",", "6", "+", "337", ",", "7", "@", "@", "int", "cifs_mknod", "(", "struct", "inode", "*", "inode", ",", "struct", "dentry", "*", "direntry", ",", "int", "mode", ",", "if", "(", "full_path", "=", "=", "NULL", ")", "rc", "=", "-", "ENOMEM", ";", "else", "if", "(", "pTcon", "-", ">", "ses", "-", ">", "capabilities", "&", "CAP_UNIX", ")", "{", "mode", "&", "=", "~", "current", "-", ">", "fs", "-", ">", "umask", ";", "if", "(", "cifs_sb", "-", ">", "mnt_cifs_flags", "&", "CIFS_MOUNT_SET_UID", ")", "{", "rc", "=", "CIFSSMBUnixSetPerms", "(", "xid", ",", "pTcon", ",", "full_path", ",", "mode", ",", "(", "__u64", ")", "current", "-", ">", "fsuid", ",", "@", "@", "-", "986", ",", "7", "+", "986", ",", "8", "@", "@", "int", "cifs_mkdir", "(", "struct", "inode", "*", "inode", ",", "struct", "dentry", "*", "direntry", ",", "int", "mode", ")", "*", "failed", "to", "get", "it", "from", "the", "server", "or", "was", "set", "bogus", "*", "/", "if", "(", "(", "direntry", "-", ">", "d_inode", ")", "&", "&", "(", "direntry", "-", ">", "d_inode", "-", ">", "i_nlink", "<", "2", ")", ")", "direntry", "-", ">", "d_inode", "-", ">", "i_nlink", "=", "2", ";", "if", "(", "cifs_sb", "-", ">", "tcon", "-", ">", "ses", "-", ">", "capabilities", "&", "CAP_UNIX", ")", "if", "(", "cifs_sb", "-", ">", "tcon", "-", ">", "ses", "-", ">", "capabilities", "&", "CAP_UNIX", ")", "{", "mode", "&", "=", "~", "current", "-", ">", "fs", "-", ">", "umask", ";", "if", "(", "cifs_sb", "-", ">", "mnt_cifs_flags", "&", "CIFS_MOUNT_SET_UID", ")", "{", "CIFSSMBUnixSetPerms", "(", "xid", ",", "pTcon", ",", "full_path", ",", "mode", ",", "@", "@", "-", "1004", ",", "7", "+", "1005", ",", "7", "@", "@", "int", "cifs_mkdir", "(", "struct", "inode", "*", "inode", ",", "struct", "dentry", "*", "direntry", ",", "int", "mode", ")", "cifs_sb", "-", ">", "mnt_cifs_flags", "&", "CIFS_MOUNT_MAP_SPECIAL_CHR", ")", ";", "}", "else", "{", "}", "else", "{", "/", "*", "BB", "to", "be", "implemented", "via", "Windows", "secrty", "descriptors", "eg", "CIFSSMBWinSetPerms", "(", "xid", ",", "pTcon", ",", "full_path", ",", "mode", ",", "-", "1", ",", "-", "1", ",", "local_nls", ")", ";", "*", "/"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Merge", "pull", "request", "#6511", "from", "eclipse/jetty-10.0.x-6487-expose-chainend-servletholder", "Issue", "#6487", "-", "expose", "ServletHolder", "in", "ChainEnd", "(Jetty", "10)"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["TIKA-3475", "--", "general", "upgrades", "for", "2.x"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["ITC-2138", "Show", "warning", "on", "host", "creation", "in", "Wizard", "when", "a", "host", "with", "the", "same", "name", "already", "exists", "(this", "considers", "MY_RIGHTS)"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["btrfs:", "relocation:", "Only", "remove", "reloc", "rb_trees", "if", "reloc", "control", "has", "been", "initialized", "Invalid", "reloc", "tree", "can", "cause", "kernel", "NULL", "pointer", "dereference", "when", "btrfs", "does", "some", "cleanup", "of", "the", "reloc", "roots.", "It", "turns", "out", "that", "fs_info::reloc_ctl", "can", "be", "NULL", "in", "btrfs_recover_relocation()", "as", "we", "allocate", "relocation", "control", "after", "all", "reloc", "roots", "have", "been", "verified.", "So", "when", "we", "hit:", "note,", "we", "haven't", "called", "set_reloc_control()", "thus", "fs_info::reloc_ctl", "is", "still", "NULL.", "Link:", "https://bugzilla.kernel.org/show_bug.cgi?id=199833", "Reported-by:", "Xu", "Wen", "<wen.xu@gatech.edu>", "Signed-off-by:", "Qu", "Wenruo", "<wqu@suse.com>", "Tested-by:", "Gu", "Jinxiang", "<gujx@cn.fujitsu.com>", "Reviewed-by:", "David", "Sterba", "<dsterba@suse.com>", "Signed-off-by:", "David", "Sterba", "<dsterba@suse.com>"], "code_tokens": ["@", "@", "-", "1281", ",", "18", "+", "1281", ",", "19", "@", "@", "static", "void", "__del_reloc_root", "(", "struct", "btrfs_root", "*", "root", ")", "struct", "mapping_node", "*", "node", "=", "NULL", ";", "struct", "reloc_control", "*", "rc", "=", "fs_info", "-", ">", "reloc_ctl", ";", "spin_lock", "(", "&", "rc", "-", ">", "reloc_root_tree", ".", "lock", ")", ";", "rb_node", "=", "tree_search", "(", "&", "rc", "-", ">", "reloc_root_tree", ".", "rb_root", ",", "root", "-", ">", "node", "-", ">", "start", ")", ";", "if", "(", "rb_node", ")", "{", "node", "=", "rb_entry", "(", "rb_node", ",", "struct", "mapping_node", ",", "rb_node", ")", ";", "rb_erase", "(", "&", "node", "-", ">", "rb_node", ",", "&", "rc", "-", ">", "reloc_root_tree", ".", "rb_root", ")", ";", "if", "(", "rc", ")", "{", "spin_lock", "(", "&", "rc", "-", ">", "reloc_root_tree", ".", "lock", ")", ";", "rb_node", "=", "tree_search", "(", "&", "rc", "-", ">", "reloc_root_tree", ".", "rb_root", ",", "root", "-", ">", "node", "-", ">", "start", ")", ";", "if", "(", "rb_node", ")", "{", "node", "=", "rb_entry", "(", "rb_node", ",", "struct", "mapping_node", ",", "rb_node", ")", ";", "rb_erase", "(", "&", "node", "-", ">", "rb_node", ",", "&", "rc", "-", ">", "reloc_root_tree", ".", "rb_root", ")", ";", "}", "spin_unlock", "(", "&", "rc", "-", ">", "reloc_root_tree", ".", "lock", ")", ";", "if", "(", "!", "node", ")", "return", ";", "BUG_ON", "(", "(", "struct", "btrfs_root", "*", ")", "node", "-", ">", "data", "!", "=", "root", ")", ";", "}", "spin_unlock", "(", "&", "rc", "-", ">", "reloc_root_tree", ".", "lock", ")", ";", "if", "(", "!", "node", ")", "return", ";", "BUG_ON", "(", "(", "struct", "btrfs_root", "*", ")", "node", "-", ">", "data", "!", "=", "root", ")", ";", "spin_lock", "(", "&", "fs_info", "-", ">", "trans_lock", ")", ";", "list_del_init", "(", "&", "root", "-", ">", "root_list", ")", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["factor", "in", "release", "for", "RPM", "if", "present", "(#1149)", "*", "factor", "in", "release", "for", "RPM", "if", "present", "*", "add", "tests", "and", "ensure", "they", "fail", "*", "add", "fix", "back", "in", "with", "tests", "*", "blacken", "code", "Signed-off-by:", "James", "Petersen", "<jpetersenames@gmail.com>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["xfs:", "XFS_IS_REALTIME_INODE()", "should", "be", "false", "if", "no", "rt", "device", "present", "If", "using", "a", "kernel", "with", "CONFIG_XFS_RT=y", "and", "we", "set", "the", "RHINHERIT", "flag", "on", "a", "directory", "in", "a", "filesystem", "that", "does", "not", "have", "a", "realtime", "device", "and", "create", "a", "new", "file", "in", "that", "directory,", "it", "gets", "marked", "as", "a", "real", "time", "file.", "When", "data", "is", "written", "and", "a", "fsync", "is", "issued,", "the", "filesystem", "attempts", "to", "flush", "a", "non-existent", "rt", "device", "during", "the", "fsync", "process.", "This", "results", "in", "a", "crash", "dereferencing", "a", "null", "buftarg", "pointer", "in", "xfs_blkdev_issue_flush():", "BUG:", "unable", "to", "handle", "kernel", "NULL", "pointer", "dereference", "at", "0000000000000008", "IP:", "xfs_blkdev_issue_flush+0xd/0x20", ".....", "Call", "Trace:", "xfs_file_fsync+0x188/0x1c0", "vfs_fsync_range+0x3b/0xa0", "do_fsync+0x3d/0x70", "SyS_fsync+0x10/0x20", "do_syscall_64+0x4d/0xb0", "entry_SYSCALL64_slow_path+0x25/0x25", "Setting", "RT", "inode", "flags", "does", "not", "require", "special", "privileges", "so", "any", "unprivileged", "user", "can", "cause", "this", "oops", "to", "occur.", "To", "reproduce,", "confirm", "kernel", "is", "compiled", "with", "CONFIG_XFS_RT=y", "and", "run:", "#", "mkfs.xfs", "-f", "/dev/pmem0", "#", "mount", "/dev/pmem0", "/mnt/test", "#", "mkdir", "/mnt/test/foo", "#", "xfs_io", "-c", "'chattr", "+t'", "/mnt/test/foo", "#", "xfs_io", "-f", "-c", "'pwrite", "0", "5m'", "-c", "fsync", "/mnt/test/foo/bar", "Or", "just", "run", "xfstests", "with", "MKFS_OPTIONS=\"-d", "rtinherit=1\"", "and", "wait.", "Kernels", "built", "with", "CONFIG_XFS_RT=n", "are", "not", "exposed", "to", "this", "bug.", "Fixes:", "f538d4da8d52", "(\"[XFS]", "write", "barrier", "support\")", "Cc:", "<stable@vger.kernel.org>", "Signed-off-by:", "Richard", "Wareing", "<rwareing@fb.com>", "Signed-off-by:", "Dave", "Chinner", "<david@fromorbit.com>", "Signed-off-by:", "Linus", "Torvalds", "<torvalds@linux-foundation.org>"], "code_tokens": ["@", "@", "-", "270", ",", "7", "+", "270", ",", "14", "@", "@", "static", "inline", "uint64_t", "howmany_64", "(", "uint64_t", "x", ",", "uint32_t", "y", ")", "#", "endif", "/", "*", "DEBUG", "*", "/", "#", "ifdef", "CONFIG_XFS_RT", "#", "define", "XFS_IS_REALTIME_INODE", "(", "ip", ")", "(", "(", "ip", ")", "->", "i_d", ".", "di_flags", "&", "XFS_DIFLAG_REALTIME", ")", "/", "*", "*", "make", "sure", "we", "ignore", "the", "inode", "flag", "if", "the", "filesystem", "doesn", "'", "t", "have", "a", "*", "configured", "realtime", "device", ".", "*", "/", "#", "define", "XFS_IS_REALTIME_INODE", "(", "ip", ")", "\\", "(", "((", "ip", ")", "->", "i_d", ".", "di_flags", "&", "XFS_DIFLAG_REALTIME", ")", "&", "&", "\\", "(", "ip", ")", "->", "i_mount", "-", ">", "m_rtdev_targp", ")", "#", "else", "#", "define", "XFS_IS_REALTIME_INODE", "(", "ip", ")", "(", "0", ")", "#", "endif"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Sync", "upstream"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Merge", "pull", "request", "#4031", "from", "abacusresearch/KEYCLOAK-4736_http_header_x-xss-protection", "KEYCLOAK-4736", "Extend", "security", "defenses", "with", "X-XSS-Protection", "header"], "code_tokens": ["@", "@", "-", "40", ",", "6", "+", "40", ",", "7", "@", "@", "public", "void", "migrate", "(", "KeycloakSession", "session", ")", "{", "Map", "<", "String", ",", "String", ">", "browserSecurityHeaders", "=", "new", "HashMap", "<", ">(", "realm", ".", "getBrowserSecurityHeaders", "(", "))", ";", "browserSecurityHeaders", ".", "put", "(", "\"", "xRobotsTag", "\"", ",", "\"", "none", "\"", ");", "browserSecurityHeaders", ".", "put", "(", "\"", "xXSSProtection", "\"", ",", "\"", "1", ";", "mode", "=", "block", "\"", ");", "realm", ".", "setBrowserSecurityHeaders", "(", "Collections", ".", "unmodifiableMap", "(", "browserSecurityHeaders", ")", ");", "}", "@", "@", "-", "35", ",", "12", "+", "35", ",", "14", "@", "@", "headerMap", ".", "put", "(", "\"", "contentSecurityPolicy", "\"", ",", "\"", "Content", "-", "Security", "-", "Policy", "\"", ");", "headerMap", ".", "put", "(", "\"", "xContentTypeOptions", "\"", ",", "\"", "X", "-", "Content", "-", "Type", "-", "Options", "\"", ");", "headerMap", ".", "put", "(", "\"", "xRobotsTag", "\"", ",", "\"", "X", "-", "Robots", "-", "Tag", "\"", ");", "headerMap", ".", "put", "(", "\"", "xXSSProtection", "\"", ",", "\"", "X", "-", "XSS", "-", "Protection", "\"", ");", "Map", "<", "String", ",", "String", ">", "dh", "=", "new", "HashMap", "<", ">(", ");", "dh", ".", "put", "(", "\"", "xFrameOptions", "\"", ",", "\"", "SAMEORIGIN", "\"", ");", "dh", ".", "put", "(", "\"", "contentSecurityPolicy", "\"", ",", "\"", "frame", "-", "src", "'", "self", "'", "\")", ";", "dh", ".", "put", "(", "\"", "xContentTypeOptions", "\"", ",", "\"", "nosniff", "\"", ");", "dh", ".", "put", "(", "\"", "xRobotsTag", "\"", ",", "\"", "none", "\"", ");", "dh", ".", "put", "(", "\"", "xXSSProtection", "\"", ",", "\"", "1", ";", "mode", "=", "block", "\"", ");", "defaultHeaders", "=", "Collections", ".", "unmodifiableMap", "(", "dh", ")", ";", "headerAttributeMap", "=", "Collections", ".", "unmodifiableMap", "(", "headerMap", ")", ";", "@", "@", "-", "124", ",", "6", "+", "124", ",", "8", "@", "@", "content", "-", "type", "-", "options", "=", "X", "-", "Content", "-", "Type", "-", "Options", "content", "-", "type", "-", "options", "-", "tooltip", "=", "Default", "value", "prevents", "Internet", "Explorer", "and", "Google", "Chrome", "from", "MIME", "-", "sniffing", "a", "response", "away", "from", "the", "declared", "content", "-", "type", "(", "click", "label", "for", "more", "information", ")", "robots", "-", "tag", "=", "X", "-", "Robots", "-", "Tag", "robots", "-", "tag", "-", "tooltip", "=", "Prevent", "pages", "from", "appearing", "in", "search", "engines", "(", "click", "label", "for", "more", "information", ")", "x", "-", "xss", "-", "protection", "=", "X", "-", "XSS", "-", "Protection", "x", "-", "xss", "-", "protection", "-", "tooltip", "=", "This", "header", "configures", "the", "Cross", "-", "site", "scripting", "(", "XSS", ")", "filter", "in", "your", "browser", ".", "Using", "the", "default", "behavior", ",", "the", "browser", "will", "prevent", "rendering", "of", "the", "page", "when", "a", "XSS", "attack", "is", "detected", "(", "click", "label", "for", "more", "information", ")", "max", "-", "login", "-", "failures", "=", "Max", "Login", "Failures", "max", "-", "login", "-", "failures", ".", "tooltip", "=", "How", "many", "failures", "before", "wait", "is", "triggered", ".", "wait", "-", "increment", "=", "Wait", "Increment", "@", "@", "-", "36", ",", "6", "+", "36", ",", "13", "@", "@", "<", "/", "div", ">", "<", "kc", "-", "tooltip", ">", "{{", "::", "'", "robots", "-", "tag", "-", "tooltip", "'", "|", "translate", "}", "}<", "/", "kc", "-", "tooltip", ">", "<", "/", "div", ">", "<", "div", "class", "=", "\"", "form", "-", "group", "\"", ">", "<", "label", "class", "=", "\"", "col", "-", "md", "-", "2", "control", "-", "label", "\"", "for", "=", "\"", "xXSSProtection", "\"", "><", "a", "href", "=", "\"", "https", ":", "//", "www", ".", "owasp", ".", "org", "/", "index", ".", "php", "/", "OWASP_Secure_Headers_Project", "#", "xxxsp", "\"", "target", "=", "\"", "_blank", "\"", ">{", "{:", ":", "'", "x", "-", "xss", "-", "protection", "'", "|", "translate", "}", "}<", "/", "a", ">", "</", "label", ">", "<", "div", "class", "=", "\"", "col", "-", "sm", "-", "6", "\"", ">", "<", "input", "class", "=", "\"", "form", "-", "control", "\"", "id", "=", "\"", "xXSSProtection", "\"", "type", "=", "\"", "text", "\"", "ng", "-", "model", "=", "\"", "realm", ".", "browserSecurityHeaders", ".", "xXSSProtection", "\"", ">", "<", "/", "div", ">", "<", "kc", "-", "tooltip", ">", "{{", "::", "'", "x", "-", "xss", "-", "protection", "-", "tooltip", "'", "|", "translate", "}", "}<", "/", "kc", "-", "tooltip", ">", "<", "/", "div", ">", "<", "/", "fieldset", ">", "<", "div", "class", "=", "\"", "form", "-", "group", "\"", "data", "-", "ng", "-", "show", "=", "\"", "access", ".", "manageRealm", "\"", ">", "<", "div", "class", "=", "\"", "col", "-", "md", "-", "10", "col", "-", "md", "-", "offset", "-", "2", "\"", ">"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["ISPN-7781", "Add", "java", "deserial", "white", "list", "for", "client", "*", "Added", "new", "option", "to", "Hot", "Rod", "client", "that", "enables", "a", "list", "of", "regular", "expressions", "to", "be", "plugged", "that", "define", "classes", "that", "can", "be", "deserialized", "using", "standard", "Java", "serialization."], "code_tokens": ["@", "@", "-", "199", ",", "7", "+", "199", ",", "7", "@", "@", "public", "void", "start", "(", ")", "{", "createExecutorService", "(", ");", "listenerNotifier", "=", "ClientListenerNotifier", ".", "create", "(", "codec", ",", "marshaller", ",", "transportFactory", ")", ";", "listenerNotifier", "=", "ClientListenerNotifier", ".", "create", "(", "codec", ",", "marshaller", ",", "transportFactory", ",", "configuration", ".", "serialWhitelist", "(", "))", ";", "transportFactory", ".", "start", "(", "codec", ",", "configuration", ",", "defaultCacheTopologyId", ",", "listenerNotifier", ")", ";", "synchronized", "(", "cacheName2RemoteCache", ")", "{", "@", "@", "-", "321", ",", "7", "+", "321", ",", "7", "@", "@", "private", "void", "startRemoteCache", "(", "RemoteCacheHolder", "remoteCacheHolder", ")", "{", "RemoteCacheImpl", "<", "?,", "?", ">", "remoteCache", "=", "remoteCacheHolder", ".", "remoteCache", ";", "OperationsFactory", "operationsFactory", "=", "new", "OperationsFactory", "(", "transportFactory", ",", "remoteCache", ".", "getName", "(", "),", "remoteCacheHolder", ".", "forceReturnValue", ",", "codec", ",", "listenerNotifier", ",", "asyncExecutorService", ",", "configuration", ".", "clientIntelligence", "(", "))", ";", "asyncExecutorService", ",", "configuration", ")", ";", "remoteCache", ".", "init", "(", "marshaller", ",", "asyncExecutorService", ",", "operationsFactory", ",", "configuration", ".", "keySizeEstimate", "(", "),", "configuration", ".", "valueSizeEstimate", "(", "))", ";", "}", "@", "@", "-", "341", ",", "7", "+", "341", ",", "7", "@", "@", "public", "Marshaller", "getMarshaller", "(", ")", "{", "}", "public", "RemoteCacheManagerAdmin", "administration", "(", ")", "{", "OperationsFactory", "operationsFactory", "=", "new", "OperationsFactory", "(", "transportFactory", ",", "codec", ",", "asyncExecutorService", ",", "configuration", ".", "clientIntelligence", "(", "))", ";", "OperationsFactory", "operationsFactory", "=", "new", "OperationsFactory", "(", "transportFactory", ",", "codec", ",", "asyncExecutorService", ",", "configuration", ")", ";", "return", "new", "RemoteCacheManagerAdminImpl", "(", "operationsFactory", ")", ";", "}", "@", "@", "-", "165", ",", "6", "+", "165", ",", "11", "@", "@", "public", "ConfigurationBuilder", "maxRetries", "(", "int", "retriesPerServer", ")", "{", "return", "builder", ".", "maxRetries", "(", "retriesPerServer", ")", ";", "}", "@", "Override", "public", "ConfigurationBuilder", "addJavaSerialWhiteList", "(", "String", ".", "..", "regExs", ")", "{", "return", "builder", ".", "addJavaSerialWhiteList", "(", "regExs", ")", ";", "}", "@", "Override", "public", "ConfigurationBuilder", "withProperties", "(", "Properties", "properties", ")", "{", "return", "builder", ".", "withProperties", "(", "properties", ")", ";", "@", "@", "-", "48", ",", "13", "+", "48", ",", "14", "@", "@", "private", "final", "int", "maxRetries", ";", "private", "final", "NearCacheConfiguration", "nearCache", ";", "private", "final", "List", "<", "ClusterConfiguration", ">", "clusters", ";", "private", "final", "List", "<", "String", ">", "serialWhitelist", ";", "Configuration", "(", "ExecutorFactoryConfiguration", "asyncExecutorFactory", ",", "Class", "<", "?", "extends", "FailoverRequestBalancingStrategy", ">", "balancingStrategyClass", ",", "FailoverRequestBalancingStrategy", "balancingStrategy", ",", "ClassLoader", "classLoader", ",", "ClientIntelligence", "clientIntelligence", ",", "ConnectionPoolConfiguration", "connectionPool", ",", "int", "connectionTimeout", ",", "Class", "<", "?", "extends", "ConsistentHash", ">", "[]", "consistentHashImpl", ",", "boolean", "forceReturnValues", ",", "int", "keySizeEstimate", ",", "Marshaller", "marshaller", ",", "Class", "<", "?", "extends", "Marshaller", ">", "marshallerClass", ",", "ProtocolVersion", "protocolVersion", ",", "List", "<", "ServerConfiguration", ">", "servers", ",", "int", "socketTimeout", ",", "SecurityConfiguration", "security", ",", "boolean", "tcpNoDelay", ",", "boolean", "tcpKeepAlive", ",", "Class", "<", "?", "extends", "TransportFactory", ">", "transportFactory", ",", "int", "valueSizeEstimate", ",", "int", "maxRetries", ",", "NearCacheConfiguration", "nearCache", ",", "List", "<", "ClusterConfiguration", ">", "clusters", ")", "{", "List", "<", "ClusterConfiguration", ">", "clusters", ",", "List", "<", "String", ">", "serialWhitelist", ")", "{", "this", ".", "asyncExecutorFactory", "=", "asyncExecutorFactory", ";", "this", ".", "balancingStrategyClass", "=", "balancingStrategyClass", ";", "this", ".", "balancingStrategy", "=", "balancingStrategy", ";", "@", "@", "-", "78", ",", "6", "+", "79", ",", "7", "@", "@", "this", ".", "valueSizeEstimate", "=", "valueSizeEstimate", ";", "this", ".", "nearCache", "=", "nearCache", ";", "this", ".", "clusters", "=", "clusters", ";", "this", ".", "serialWhitelist", "=", "serialWhitelist", ";", "}", "public", "ExecutorFactoryConfiguration", "asyncExecutorFactory", "(", ")", "{", "@", "@", "-", "185", ",", "6", "+", "187", ",", "10", "@", "@", "public", "int", "maxRetries", "(", ")", "{", "return", "maxRetries", ";", "}", "public", "List", "<", "String", ">", "serialWhitelist", "(", ")", "{", "return", "serialWhitelist", ";", "}", "@", "Override", "public", "String", "toString", "(", ")", "{", "return", "\"", "Configuration", "[", "asyncExecutorFactory", "=", "\"", "+", "asyncExecutorFactory", "+", "\"", ",", "balancingStrategyClass", "=", "\"", "+", "balancingStrategyClass", "+", "\"", ",", "balancingStrategy", "=", "\"", "+", "balancingStrategy", "@", "@", "-", "193", ",", "6", "+", "199", ",", "7", "@", "@", "public", "String", "toString", "(", ")", "{", "+", "forceReturnValues", "+", "\"", ",", "keySizeEstimate", "=", "\"", "+", "keySizeEstimate", "+", "\"", ",", "marshallerClass", "=", "\"", "+", "marshallerClass", "+", "\"", ",", "marshaller", "=", "\"", "+", "marshaller", "+", "\"", ",", "protocolVersion", "=", "\"", "+", "protocolVersion", "+", "\"", ",", "servers", "=", "\"", "+", "servers", "+", "\"", ",", "socketTimeout", "=", "\"", "+", "socketTimeout", "+", "\"", ",", "security", "=", "\"", "+", "security", "+", "\"", ",", "tcpNoDelay", "=", "\"", "+", "tcpNoDelay", "+", "\"", ",", "tcpKeepAlive", "=", "\"", "+", "tcpKeepAlive", "+", "\"", ",", "transportFactory", "=", "\"", "+", "transportFactory", "+", "\"", ",", "valueSizeEstimate", "=", "\"", "+", "valueSizeEstimate", "+", "\"", ",", "maxRetries", "=", "\"", "+", "maxRetries", "+", "\"", ",", "serialWhiteList", "=", "\"", "+", "serialWhitelist", "+", "\"", "nearCache", "=", "\"", "+", "nearCache", "+", "\"", "]\"", ";", "}", "@", "@", "-", "295", ",", "6", "+", "302", ",", "8", "@", "@", "public", "Properties", "properties", "(", ")", "{", "for", "(", "Map", ".", "Entry", "<", "String", ",", "String", ">", "entry", ":", "security", ".", "authentication", "(", ").", "saslProperties", "(", ").", "entrySet", "(", "))", "properties", ".", "setProperty", "(", "ConfigurationProperties", ".", "SASL_PROPERTIES_PREFIX", "+", "'", ".'", "+", "entry", ".", "getKey", "(", "),", "entry", ".", "getValue", "(", "))", ";", "properties", ".", "setProperty", "(", "ConfigurationProperties", ".", "JAVA_SERIAL_WHITELIST", ",", "String", ".", "join", "(", "\",", "\",", "serialWhitelist", ")", ");", "return", "properties", ";", "}", "}", "@", "@", "-", "2", ",", "6", "+", "2", ",", "8", "@", "@", "import", "java", ".", "lang", ".", "ref", ".", "WeakReference", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Properties", ";", "@", "@", "-", "68", ",", "6", "+", "70", ",", "7", "@", "@", "private", "int", "valueSizeEstimate", "=", "ConfigurationProperties", ".", "DEFAULT_VALUE_SIZE", ";", "private", "int", "maxRetries", "=", "ConfigurationProperties", ".", "DEFAULT_MAX_RETRIES", ";", "private", "final", "NearCacheConfigurationBuilder", "nearCache", ";", "private", "final", "List", "<", "String", ">", "whiteListRegExs", "=", "new", "ArrayList", "<", ">(", ");", "private", "final", "List", "<", "ClusterConfigurationBuilder", ">", "clusters", "=", "new", "ArrayList", "<", "ClusterConfigurationBuilder", ">", "()", ";", "@", "@", "-", "281", ",", "6", "+", "284", ",", "12", "@", "@", "public", "ConfigurationBuilder", "maxRetries", "(", "int", "maxRetries", ")", "{", "return", "this", ";", "}", "@", "Override", "public", "ConfigurationBuilder", "addJavaSerialWhiteList", "(", "String", ".", "..", "regEx", ")", "{", "this", ".", "whiteListRegExs", ".", "addAll", "(", "Arrays", ".", "asList", "(", "regEx", ")", ");", "return", "this", ";", "}", "@", "Override", "public", "ConfigurationBuilder", "withProperties", "(", "Properties", "properties", ")", "{", "TypedProperties", "typed", "=", "TypedProperties", ".", "toTypedProperties", "(", "properties", ")", ";", "@", "@", "-", "322", ",", "6", "+", "331", ",", "13", "@", "@", "public", "ConfigurationBuilder", "withProperties", "(", "Properties", "properties", ")", "{", "this", ".", "maxRetries", "(", "typed", ".", "getIntProperty", "(", "ConfigurationProperties", ".", "MAX_RETRIES", ",", "maxRetries", ",", "true", ")", ");", "this", ".", "security", ".", "ssl", "(", ").", "withProperties", "(", "properties", ")", ";", "this", ".", "security", ".", "authentication", "(", ").", "withProperties", "(", "properties", ")", ";", "String", "serialWhitelist", "=", "typed", ".", "getProperty", "(", "ConfigurationProperties", ".", "JAVA_SERIAL_WHITELIST", ")", ";", "if", "(", "serialWhitelist", "!", "=", "null", ")", "{", "String", "[", "]", "classes", "=", "serialWhitelist", ".", "split", "(", "\",", "\")", ";", "Collections", ".", "addAll", "(", "this", ".", "whiteListRegExs", ",", "classes", ")", ";", "}", "return", "this", ";", "}", "@", "@", "-", "362", ",", "7", "+", "378", ",", "7", "@", "@", "public", "Configuration", "create", "(", ")", "{", "return", "new", "Configuration", "(", "asyncExecutorFactory", ".", "create", "(", "),", "balancingStrategyClass", ",", "balancingStrategy", ",", "classLoader", "=", "=", "null", "?", "null", ":", "classLoader", ".", "get", "(", "),", "clientIntelligence", ",", "connectionPool", ".", "create", "(", "),", "connectionTimeout", ",", "consistentHashImpl", ",", "forceReturnValues", ",", "keySizeEstimate", ",", "marshaller", ",", "marshallerClass", ",", "protocolVersion", ",", "servers", ",", "socketTimeout", ",", "security", ".", "create", "(", "),", "tcpNoDelay", ",", "tcpKeepAlive", ",", "transportFactory", ",", "valueSizeEstimate", ",", "maxRetries", ",", "nearCache", ".", "create", "(", "),", "serverClusterConfigs", ")", ";", "valueSizeEstimate", ",", "maxRetries", ",", "nearCache", ".", "create", "(", "),", "serverClusterConfigs", ",", "whiteListRegExs", ")", ";", "}", "@", "Override", "@", "@", "-", "405", ",", "6", "+", "421", ",", "8", "@", "@", "public", "ConfigurationBuilder", "read", "(", "Configuration", "template", ")", "{", "this", ".", "valueSizeEstimate", "=", "template", ".", "valueSizeEstimate", "(", ");", "this", ".", "maxRetries", "=", "template", ".", "maxRetries", "(", ");", "this", ".", "nearCache", ".", "read", "(", "template", ".", "nearCache", "(", "))", ";", "this", ".", "whiteListRegExs", ".", "addAll", "(", "template", ".", "serialWhitelist", "(", "))", ";", "return", "this", ";", "}", "}", "@", "@", "-", "1", ",", "5", "+", "1", ",", "6", "@", "@", "package", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Properties", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "ProtocolVersion", ";", "@", "@", "-", "182", ",", "6", "+", "183", ",", "12", "@", "@", "*", "/", "ConfigurationBuilder", "maxRetries", "(", "int", "maxRetries", ")", ";", "/", "**", "*", "List", "of", "regular", "expressions", "for", "classes", "that", "can", "be", "deserialized", "using", "standard", "Java", "deserialization", "*", "when", "reading", "data", "that", "might", "have", "been", "stored", "with", "a", "different", "endpoint", ",", "e", ".", "g", ".", "REST", ".", "*", "/", "ConfigurationBuilder", "addJavaSerialWhiteList", "(", "String", ".", "..", "regEx", ")", ";", "/", "**", "*", "Configures", "this", "builder", "using", "the", "specified", "properties", "*", "/", "@", "@", "-", "64", ",", "19", "+", "64", ",", "21", "@", "@", "private", "final", "TransportFactory", "transportFactory", ";", "private", "final", "Consumer", "<", "WrappedByteArray", ">", "failoverClientListener", "=", "this", ":", ":", "failoverClientListener", ";", "private", "final", "List", "<", "String", ">", "whitelist", ";", "protected", "ClientListenerNotifier", "(", "ExecutorService", "executor", ",", "Codec", "codec", ",", "Marshaller", "marshaller", ",", "TransportFactory", "transportFactory", ")", "{", "Marshaller", "marshaller", ",", "TransportFactory", "transportFactory", ",", "List", "<", "String", ">", "whitelist", ")", "{", "this", ".", "executor", "=", "executor", ";", "this", ".", "codec", "=", "codec", ";", "this", ".", "marshaller", "=", "marshaller", ";", "this", ".", "transportFactory", "=", "transportFactory", ";", "this", ".", "whitelist", "=", "whitelist", ";", "}", "public", "static", "ClientListenerNotifier", "create", "(", "Codec", "codec", ",", "Marshaller", "marshaller", ",", "TransportFactory", "transportFactory", ")", "{", "public", "static", "ClientListenerNotifier", "create", "(", "Codec", "codec", ",", "Marshaller", "marshaller", ",", "TransportFactory", "transportFactory", ",", "List", "<", "String", ">", "whitelist", ")", "{", "ExecutorService", "executor", "=", "Executors", ".", "newCachedThreadPool", "(", "getRestoreThreadNameThreadFactory", "(", "))", ";", "return", "new", "ClientListenerNotifier", "(", "executor", ",", "codec", ",", "marshaller", ",", "transportFactory", ")", ";", "return", "new", "ClientListenerNotifier", "(", "executor", ",", "codec", ",", "marshaller", ",", "transportFactory", ",", "whitelist", ")", ";", "}", "private", "static", "ThreadFactory", "getRestoreThreadNameThreadFactory", "(", ")", "{", "@", "@", "-", "277", ",", "7", "+", "279", ",", "7", "@", "@", "public", "void", "run", "(", ")", "{", "while", "(", "!", "Thread", ".", "currentThread", "(", ").", "isInterrupted", "(", "))", "{", "ClientEvent", "clientEvent", "=", "null", ";", "try", "{", "clientEvent", "=", "codec", ".", "readEvent", "(", "transport", ",", "op", ".", "listenerId", ",", "marshaller", ")", ";", "clientEvent", "=", "codec", ".", "readEvent", "(", "transport", ",", "op", ".", "listenerId", ",", "marshaller", ",", "whitelist", ")", ";", "invokeClientEvent", "(", "clientEvent", ")", ";", "/", "/", "Nullify", "event", ",", "makes", "it", "easier", "to", "identify", "network", "vs", "invocation", "error", "messages", "clientEvent", "=", "null", ";", "@", "@", "-", "61", ",", "6", "+", "61", ",", "7", "@", "@", "public", "static", "final", "String", "SASL_PROPERTIES_PREFIX", "=", "\"", "infinispan", ".", "client", ".", "hotrod", ".", "sasl_properties", "\"", ";", "public", "static", "final", "Pattern", "SASL_PROPERTIES_PREFIX_REGEX", "=", "Pattern", ".", "compile", "(", "'^", "'", "+", "ConfigurationProperties", ".", "SASL_PROPERTIES_PREFIX", "+", "'", ".'", ");", "public", "static", "final", "String", "JAVA_SERIAL_WHITELIST", "=", "\"", "infinispan", ".", "client", ".", "hotrod", ".", "java_serial_whitelist", "\"", ";", "/", "/", "defaults", "@", "@", "-", "1", ",", "5", "+", "1", ",", "6", "@", "@", "package", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "iteration", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Set", ";", "/", "**", "@", "@", "-", "8", ",", "7", "+", "9", ",", "7", "@", "@", "*", "/", "public", "interface", "KeyTracker", "{", "boolean", "track", "(", "byte", "[", "]", "key", ",", "short", "status", ")", ";", "boolean", "track", "(", "byte", "[", "]", "key", ",", "short", "status", ",", "List", "<", "String", ">", "whitelist", ")", ";", "void", "segmentsFinished", "(", "byte", "[", "]", "finishedSegments", ")", ";", "@", "@", "-", "1", ",", "5", "+", "1", ",", "6", "@", "@", "package", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "iteration", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Set", ";", "/", "**", "@", "@", "-", "9", ",", "7", "+", "10", ",", "7", "@", "@", "class", "NoOpSegmentKeyTracker", "implements", "KeyTracker", "{", "@", "Override", "public", "boolean", "track", "(", "byte", "[", "]", "key", ",", "short", "status", ")", "{", "public", "boolean", "track", "(", "byte", "[", "]", "key", ",", "short", "status", ",", "List", "<", "String", ">", "whitelist", ")", "{", "return", "true", ";", "}", "@", "@", "-", "1", ",", "6", "+", "1", ",", "7", "@", "@", "package", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "iteration", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "org", ".", "infinispan", ".", "commons", ".", "marshall", ".", "WrappedByteArray", ";", "@", "@", "-", "17", ",", "7", "+", "18", ",", "7", "@", "@", "private", "Set", "<", "WrappedByteArray", ">", "keys", "=", "new", "HashSet", "<", ">(", ");", "@", "Override", "public", "boolean", "track", "(", "byte", "[", "]", "key", ",", "short", "status", ")", "{", "public", "boolean", "track", "(", "byte", "[", "]", "key", ",", "short", "status", ",", "List", "<", "String", ">", "whitelist", ")", "{", "return", "keys", ".", "add", "(", "new", "WrappedByteArray", "(", "key", ")", ");", "}", "@", "@", "-", "2", ",", "6", "+", "2", ",", "7", "@", "@", "import", "java", ".", "util", ".", "BitSet", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicReferenceArray", ";", "import", "java", ".", "util", ".", "stream", ".", "IntStream", ";", "@", "@", "-", "38", ",", "9", "+", "39", ",", "9", "@", "@", "public", "SegmentKeyTracker", "(", "Marshaller", "marshaller", ",", "SegmentConsistentHash", "segmentCon", "segmentStream", ".", "forEach", "(", "i", "-", ">", "keysPerSegment", ".", "set", "(", "i", ",", "new", "HashSet", "<", ">(", "))", ");", "}", "public", "boolean", "track", "(", "byte", "[", "]", "key", ",", "short", "status", ")", "{", "public", "boolean", "track", "(", "byte", "[", "]", "key", ",", "short", "status", ",", "List", "<", "String", ">", "whitelist", ")", "{", "int", "segment", "=", "HotRodConstants", ".", "hasCompatibility", "(", "status", ")", "?", "segmentConsistentHash", ".", "getSegment", "(", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "key", ",", "status", ")", ")", ":", "segmentConsistentHash", ".", "getSegment", "(", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "key", ",", "status", ",", "whitelist", ")", ")", ":", "segmentConsistentHash", ".", "getSegment", "(", "key", ")", ";", "boolean", "result", "=", "keysPerSegment", ".", "get", "(", "segment", ")", ".", "add", "(", "new", "WrappedByteArray", "(", "key", ")", ");", "if", "(", "log", ".", "isTraceEnabled", "(", "))", "@", "@", "-", "4", ",", "7", "+", "4", ",", "7", "@", "@", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "VersionedOperationResponse", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "@", "@", "-", "26", ",", "8", "+", "26", ",", "8", "@", "@", "protected", "final", "byte", "[", "]", "keyBytes", ";", "protected", "AbstractKeyOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "Configuration", "cfg", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "this", ".", "key", "=", "key", ";", "this", ".", "keyBytes", "=", "keyBytes", ";", "}", "@", "@", "-", "52", ",", "7", "+", "52", ",", "7", "@", "@", "protected", "short", "sendKeyOperation", "(", "byte", "[", "]", "key", ",", "Transport", "transport", ",", "byte", "opCode", ",", "b", "}", "protected", "T", "returnPossiblePrevValue", "(", "Transport", "transport", ",", "short", "status", ")", "{", "return", "(", "T", ")", "codec", ".", "returnPossiblePrevValue", "(", "transport", ",", "status", ",", "flags", ")", ";", "return", "(", "T", ")", "codec", ".", "returnPossiblePrevValue", "(", "transport", ",", "status", ",", "flags", ",", "cfg", ".", "serialWhitelist", "(", "))", ";", "}", "protected", "VersionedOperationResponse", "returnVersionedOperationResponse", "(", "Transport", "transport", ",", "HeaderParams", "params", ")", "{", "@", "@", "-", "3", ",", "7", "+", "3", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "TimeUnit", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "@", "@", "-", "31", ",", "9", "+", "31", ",", "9", "@", "@", "protected", "final", "TimeUnit", "maxIdleTimeUnit", ";", "protected", "AbstractKeyValueOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "byte", "[", "]", "value", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "Configuration", "cfg", ",", "byte", "[", "]", "value", ",", "long", "lifespan", ",", "TimeUnit", "lifespanTimeUnit", ",", "long", "maxIdle", ",", "TimeUnit", "maxIdleTimeUnit", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "this", ".", "value", "=", "value", ";", "this", ".", "lifespan", "=", "lifespan", ";", "this", ".", "maxIdle", "=", "maxIdle", ";", "@", "@", "-", "8", ",", "7", "+", "8", ",", "7", "@", "@", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "RemoteCacheManager", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "annotation", ".", "ClientListener", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "event", ".", "ClientEvent", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "event", ".", "ClientListenerNotifier", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "@", "@", "-", "44", ",", "10", "+", "44", ",", "10", "@", "@", "public", "final", "byte", "[", "][", "]", "converterFactoryParams", ";", "protected", "AddClientListenerOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "String", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "String", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "Configuration", "cfg", ",", "ClientListenerNotifier", "listenerNotifier", ",", "Object", "listener", ",", "byte", "[", "][", "]", "filterFactoryParams", ",", "byte", "[", "][", "]", "converterFactoryParams", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "RemoteCacheManager", ".", "cacheNameBytes", "(", "cacheName", ")", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "super", "(", "codec", ",", "transportFactory", ",", "RemoteCacheManager", ".", "cacheNameBytes", "(", "cacheName", ")", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "this", ".", "listenerId", "=", "generateListenerId", "(", ");", "this", ".", "listenerNotifier", "=", "listenerNotifier", ";", "this", ".", "listener", "=", "listener", ";", "@", "@", "-", "94", ",", "7", "+", "94", ",", "7", "@", "@", "protected", "Short", "executeOperation", "(", "Transport", "transport", ")", "{", "Either", "<", "Short", ",", "ClientEvent", ">", "either", ";", "do", "{", "/", "/", "Process", "state", "transfer", "related", "events", "or", "add", "listener", "response", "either", "=", "codec", ".", "readHeaderOrEvent", "(", "dedicatedTransport", ",", "params", ",", "listenerId", ",", "listenerNotifier", ".", "getMarshaller", "(", "))", ";", "either", "=", "codec", ".", "readHeaderOrEvent", "(", "dedicatedTransport", ",", "params", ",", "listenerId", ",", "listenerNotifier", ".", "getMarshaller", "(", "),", "cfg", ".", "serialWhitelist", "(", "))", ";", "switch", "(", "either", ".", "type", "(", "))", "{", "case", "LEFT", ":", "if", "(", "HotRodConstants", ".", "isSuccess", "(", "either", ".", "left", "(", "))", ")", "@", "@", "-", "4", ",", "7", "+", "4", ",", "7", "@", "@", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "@", "@", "-", "22", ",", "8", "+", "22", ",", "8", "@", "@", "private", "final", "Transport", "transport", ";", "public", "AuthMechListOperation", "(", "Codec", "codec", ",", "AtomicInteger", "topologyId", ",", "ClientIntelligence", "clientIntelligence", ",", "Transport", "transport", ")", "{", "super", "(", "codec", ",", "0", ",", "clientIntelligence", ",", "DEFAULT_CACHE_NAME_BYTES", ",", "topologyId", ")", ";", "public", "AuthMechListOperation", "(", "Codec", "codec", ",", "AtomicInteger", "topologyId", ",", "Configuration", "cfg", ",", "Transport", "transport", ")", "{", "super", "(", "codec", ",", "0", ",", "cfg", ",", "DEFAULT_CACHE_NAME_BYTES", ",", "topologyId", ")", ";", "this", ".", "transport", "=", "transport", ";", "}", "@", "@", "-", "2", ",", "7", "+", "2", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "@", "@", "-", "22", ",", "9", "+", "22", ",", "9", "@", "@", "private", "final", "String", "saslMechanism", ";", "private", "final", "byte", "[", "]", "response", ";", "public", "AuthOperation", "(", "Codec", "codec", ",", "AtomicInteger", "topologyId", ",", "ClientIntelligence", "clientIntelligence", ",", "Transport", "transport", ",", "public", "AuthOperation", "(", "Codec", "codec", ",", "AtomicInteger", "topologyId", ",", "Configuration", "cfg", ",", "Transport", "transport", ",", "String", "saslMechanism", ",", "byte", "response", "[", "])", "{", "super", "(", "codec", ",", "0", ",", "clientIntelligence", ",", "DEFAULT_CACHE_NAME_BYTES", ",", "topologyId", ")", ";", "super", "(", "codec", ",", "0", ",", "cfg", ",", "DEFAULT_CACHE_NAME_BYTES", ",", "topologyId", ")", ";", "this", ".", "transport", "=", "transport", ";", "this", ".", "saslMechanism", "=", "saslMechanism", ";", "this", ".", "response", "=", "response", ";", "@", "@", "-", "5", ",", "7", "+", "5", ",", "7", "@", "@", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "@", "@", "-", "21", ",", "8", "+", "21", ",", "8", "@", "@", "private", "final", "int", "scope", ";", "public", "BulkGetKeysOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "int", "scope", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "Configuration", "cfg", ",", "int", "scope", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "this", ".", "scope", "=", "scope", ";", "}", "@", "@", "-", "39", ",", "7", "+", "39", ",", "7", "@", "@", "protected", "Transport", "getTransport", "(", "int", "retryCount", ",", "Set", "<", "SocketAddress", ">", "failedServer", "short", "status", "=", "readHeaderAndValidate", "(", "transport", ",", "params", ")", ";", "Set", "<", "K", ">", "result", "=", "new", "HashSet", "<", "K", ">", "()", ";", "while", "(", "transport", ".", "readByte", "(", ")", "=", "=", "1", ")", "{", "/", "/", "there", "'", "s", "more", "!", "result", ".", "add", "(", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ")", ");", "result", ".", "add", "(", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ",", "cfg", ".", "serialWhitelist", "(", "))", ");", "}", "return", "result", ";", "}", "@", "@", "-", "6", ",", "7", "+", "6", ",", "7", "@", "@", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "@", "@", "-", "23", ",", "8", "+", "23", ",", "8", "@", "@", "private", "final", "int", "entryCount", ";", "public", "BulkGetOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "int", "entryCount", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "int", "flags", ",", "Configuration", "cfg", ",", "int", "entryCount", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "this", ".", "entryCount", "=", "entryCount", ";", "}", "@", "@", "-", "41", ",", "8", "+", "41", ",", "8", "@", "@", "protected", "Transport", "getTransport", "(", "int", "retryCount", ",", "Set", "<", "SocketAddress", ">", "failedServer", "short", "status", "=", "readHeaderAndValidate", "(", "transport", ",", "params", ")", ";", "Map", "<", "K", ",", "V", ">", "result", "=", "new", "HashMap", "<", "K", ",", "V", ">", "()", ";", "while", "(", "transport", ".", "readByte", "(", ")", "=", "=", "1", ")", "{", "/", "/", "there", "'", "s", "more", "!", "K", "key", "=", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ")", ";", "V", "value", "=", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ")", ";", "K", "key", "=", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ",", "cfg", ".", "serialWhitelist", "(", "))", ";", "V", "value", "=", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ",", "cfg", ".", "serialWhitelist", "(", "))", ";", "result", ".", "put", "(", "key", ",", "value", ")", ";", "}", "return", "result", ";", "@", "@", "-", "4", ",", "7", "+", "4", ",", "7", "@", "@", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "@", "@", "-", "22", ",", "8", "+", "22", ",", "8", "@", "@", "public", "class", "ClearOperation", "extends", "RetryOnFailureOperation", "<", "Void", ">", "{", "public", "ClearOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "Configuration", "cfg", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "}", "@", "Override", "@", "@", "-", "2", ",", "7", "+", "2", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HotRodConstants", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "@", "@", "-", "20", ",", "8", "+", "20", ",", "8", "@", "@", "public", "class", "ContainsKeyOperation", "extends", "AbstractKeyOperation", "<", "Boolean", ">", "{", "public", "ContainsKeyOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "Configuration", "cfg", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "}", "@", "Override", "@", "@", "-", "6", ",", "7", "+", "6", ",", "7", "@", "@", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "@", "@", "-", "24", ",", "9", "+", "24", ",", "9", "@", "@", "private", "final", "Map", "<", "String", ",", "byte", "[", "]>", "marshalledParams", ";", "protected", "ExecuteOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "Configuration", "cfg", ",", "String", "taskName", ",", "Map", "<", "String", ",", "byte", "[", "]>", "marshalledParams", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", "=", "=", "null", "?", "DEFAULT_CACHE_NAME_BYTES", ":", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", "=", "=", "null", "?", "DEFAULT_CACHE_NAME_BYTES", ":", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "this", ".", "taskName", "=", "taskName", ";", "this", ".", "marshalledParams", "=", "marshalledParams", ";", "}", "@", "@", "-", "48", ",", "7", "+", "48", ",", "7", "@", "@", "protected", "T", "executeOperation", "(", "Transport", "transport", ")", "{", "}", "transport", ".", "flush", "(", ");", "short", "status", "=", "readHeaderAndValidate", "(", "transport", ",", "params", ")", ";", "return", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ")", ";", "return", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ",", "cfg", ".", "serialWhitelist", "(", "))", ";", "}", "}", "@", "@", "-", "4", ",", "7", "+", "4", ",", "7", "@", "@", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "TransportFactory", ";", "@", "@", "-", "19", ",", "8", "+", "19", ",", "8", "@", "@", "protected", "FaultTolerantPingOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "Configuration", "cfg", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "}", "@", "Override", "@", "@", "-", "30", ",", "7", "+", "30", ",", "7", "@", "@", "protected", "Transport", "getTransport", "(", "int", "retryCount", ",", "Set", "<", "SocketAddress", ">", "failedServer", "@", "Override", "protected", "PingOperation", ".", "PingResult", "executeOperation", "(", "Transport", "transport", ")", "{", "return", "new", "PingOperation", "(", "codec", ",", "topologyId", ",", "clientIntelligence", ",", "transport", ",", "cacheName", ")", ".", "execute", "(", ");", "return", "new", "PingOperation", "(", "codec", ",", "topologyId", ",", "cfg", ",", "transport", ",", "cacheName", ")", ".", "execute", "(", ");", "}", "}", "@", "@", "-", "6", ",", "7", "+", "6", ",", "7", "@", "@", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "@", "@", "-", "25", ",", "8", "+", "25", ",", "8", "@", "@", "public", "GetAllOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Set", "<", "byte", "[", "]>", "keys", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "int", "flags", ",", "Configuration", "cfg", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "this", ".", "keys", "=", "keys", ";", "}", "@", "@", "-", "45", ",", "8", "+", "45", ",", "8", "@", "@", "public", "GetAllOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "int", "size", "=", "transport", ".", "readVInt", "(", ");", "Map", "<", "K", ",", "V", ">", "result", "=", "new", "HashMap", "<", "K", ",", "V", ">", "(", "size", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "size", ";", "+", "+", "i", ")", "{", "K", "key", "=", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ")", ";", "V", "value", "=", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ")", ";", "K", "key", "=", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ",", "cfg", ".", "serialWhitelist", "(", "))", ";", "V", "value", "=", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ",", "cfg", ".", "serialWhitelist", "(", "))", ";", "result", ".", "put", "(", "key", ",", "value", ")", ";", "}", "return", "result", ";", "@", "@", "-", "10", ",", "7", "+", "10", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "java", ".", "util", ".", "stream", ".", "Collectors", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "TransportFactory", ";", "@", "@", "-", "22", ",", "8", "+", "22", ",", "8", "@", "@", "private", "final", "Set", "<", "byte", "[", "]>", "keys", ";", "protected", "GetAllParallelOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Set", "<", "byte", "[", "]>", "keys", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "ExecutorService", "executorService", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ",", "executorService", ")", ";", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "Configuration", "cfg", ",", "ExecutorService", "executorService", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ",", "executorService", ")", ";", "this", ".", "keys", "=", "keys", ";", "}", "@", "@", "-", "43", ",", "7", "+", "43", ",", "7", "@", "@", "protected", "GetAllParallelOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", "return", "splittedKeys", ".", "values", "(", ").", "stream", "(", ").", "map", "(", "keysSubset", "-", ">", "new", "GetAllOperation", "<", "K", ",", "V", ">", "(", "codec", ",", "transportFactory", ",", "keysSubset", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ").", "collect", "(", "Collectors", ".", "toList", "(", "))", ";", "flags", ",", "cfg", ")", ").", "collect", "(", "Collectors", ".", "toList", "(", "))", ";", "}", "@", "Override", "@", "@", "-", "1", ",", "8", "+", "1", ",", "10", "@", "@", "package", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "operations", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HotRodConstants", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "@", "@", "-", "21", ",", "8", "+", "23", ",", "8", "@", "@", "public", "GetOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "Configuration", "cfg", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "}", "@", "Override", "@", "@", "-", "33", ",", "7", "+", "35", ",", "7", "@", "@", "public", "V", "executeOperation", "(", "Transport", "transport", ")", "{", "result", "=", "null", ";", "}", "else", "{", "if", "(", "HotRodConstants", ".", "isSuccess", "(", "status", ")", ")", "{", "result", "=", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ")", ";", "result", "=", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ",", "cfg", ".", "serialWhitelist", "(", "))", ";", "}", "}", "return", "result", ";", "@", "@", "-", "4", ",", "7", "+", "4", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "VersionedMetadata", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "VersionedMetadataImpl", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "@", "@", "-", "26", ",", "8", "+", "26", ",", "8", "@", "@", "private", "boolean", "retryable", ";", "public", "GetStreamOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "int", "offset", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "int", "offset", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "Configuration", "cfg", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "this", ".", "offset", "=", "offset", ";", "retryable", "=", "true", ";", "}", "@", "@", "-", "3", ",", "7", "+", "3", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "MetadataValue", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "MetadataValueImpl", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HotRodConstants", ";", "@", "@", "-", "29", ",", "8", "+", "29", ",", "8", "@", "@", "public", "GetWithMetadataOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "Configuration", "cfg", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "}", "@", "Override", "@", "@", "-", "57", ",", "7", "+", "57", ",", "7", "@", "@", "public", "GetWithMetadataOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "if", "(", "trace", ")", "{", "log", ".", "tracef", "(", "\"", "Received", "version", ":", "%", "d", "\"", ",", "version", ")", ";", "}", "V", "value", "=", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ")", ";", "V", "value", "=", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ",", "cfg", ".", "serialWhitelist", "(", "))", ";", "result", "=", "new", "MetadataValueImpl", "<", "V", ">", "(", "creation", ",", "lifespan", ",", "lastUsed", ",", "maxIdle", ",", "version", ",", "value", ")", ";", "}", "return", "result", ";", "@", "@", "-", "1", ",", "9", "+", "1", ",", "11", "@", "@", "package", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "operations", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "VersionedValue", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "VersionedValueImpl", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HotRodConstants", ";", "@", "@", "-", "30", ",", "8", "+", "32", ",", "8", "@", "@", "public", "GetWithVersionOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "Configuration", "cfg", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "}", "@", "Override", "@", "@", "-", "45", ",", "7", "+", "47", ",", "7", "@", "@", "public", "GetWithVersionOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "O", "if", "(", "trace", ")", "{", "log", ".", "tracef", "(", "\"", "Received", "version", ":", "%", "d", "\"", ",", "version", ")", ";", "}", "V", "value", "=", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ")", ";", "V", "value", "=", "codec", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ",", "cfg", ".", "serialWhitelist", "(", "))", ";", "result", "=", "new", "VersionedValueImpl", "<", "V", ">", "(", "version", ",", "value", ")", ";", "}", "return", "result", ";", "@", "@", "-", "2", ",", "7", "+", "2", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HotRodConstants", ";", "@", "@", "-", "29", ",", "14", "+", "29", ",", "14", "@", "@", "protected", "final", "Codec", "codec", ";", "protected", "final", "ClientIntelligence", "clientIntelligence", ";", "protected", "final", "Configuration", "cfg", ";", "private", "static", "final", "byte", "NO_TX", "=", "0", ";", "private", "static", "final", "byte", "XA_TX", "=", "1", ";", "protected", "HotRodOperation", "(", "Codec", "codec", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ")", "{", "protected", "HotRodOperation", "(", "Codec", "codec", ",", "int", "flags", ",", "Configuration", "cfg", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ")", "{", "this", ".", "flags", "=", "flags", ";", "this", ".", "clientIntelligence", "=", "clientIntelligence", ";", "this", ".", "cfg", "=", "cfg", ";", "this", ".", "cacheName", "=", "cacheName", ";", "this", ".", "topologyId", "=", "topologyId", ";", "this", ".", "codec", "=", "codec", ";", "@", "@", "-", "47", ",", "7", "+", "47", ",", "7", "@", "@", "protected", "HotRodOperation", "(", "Codec", "codec", ",", "int", "flags", ",", "ClientIntelligence", "clientIntel", "protected", "final", "HeaderParams", "writeHeader", "(", "Transport", "transport", ",", "short", "operationCode", ")", "{", "HeaderParams", "params", "=", "new", "HeaderParams", "(", ")", ".", "opCode", "(", "operationCode", ")", ".", "cacheName", "(", "cacheName", ")", ".", "flags", "(", "flags", ")", ".", "clientIntel", "(", "clientIntelligence", ")", ".", "clientIntel", "(", "cfg", ".", "clientIntelligence", "(", "))", ".", "topologyId", "(", "topologyId", ")", ".", "txMarker", "(", "NO_TX", ")", ".", "topologyAge", "(", "transport", ".", "getTransportFactory", "(", ").", "getTopologyAge", "(", "))", ";", "return", "codec", ".", "writeHeader", "(", "transport", ",", "params", ")", ";", "@", "@", "-", "2", ",", "7", "+", "2", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "@", "@", "-", "18", ",", "10", "+", "18", ",", "10", "@", "@", "private", "final", "TransportFactory", "transportFactory", ";", "private", "final", "Transport", "transport", ";", "protected", "IterationEndOperation", "(", "Codec", "codec", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "byte", "[", "]", "cacheName", ",", "protected", "IterationEndOperation", "(", "Codec", "codec", ",", "int", "flags", ",", "Configuration", "cfg", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "String", "iterationId", ",", "TransportFactory", "transportFactory", ",", "Transport", "transport", ")", "{", "super", "(", "codec", ",", "flags", ",", "clientIntelligence", ",", "cacheName", ",", "topologyId", ")", ";", "super", "(", "codec", ",", "flags", ",", "cfg", ",", "cacheName", ",", "topologyId", ")", ";", "this", ".", "iterationId", "=", "iterationId", ";", "this", ".", "transportFactory", "=", "transportFactory", ";", "this", ".", "transport", "=", "transport", ";", "@", "@", "-", "6", ",", "7", "+", "6", ",", "7", "@", "@", "import", "java", ".", "util", ".", "Map", ".", "Entry", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "MetadataValueImpl", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "iteration", ".", "KeyTracker", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "@", "@", "-", "28", ",", "15", "+", "28", ",", "16", "@", "@", "private", "final", "String", "iterationId", ";", "private", "final", "Transport", "transport", ";", "private", "final", "List", "<", "String", ">", "whitelist", ";", "private", "final", "KeyTracker", "segmentKeyTracker", ";", "protected", "IterationNextOperation", "(", "Codec", "codec", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "byte", "[", "]", "cacheName", ",", "protected", "IterationNextOperation", "(", "Codec", "codec", ",", "int", "flags", ",", "Configuration", "cfg", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "String", "iterationId", ",", "Transport", "transport", ",", "KeyTracker", "segmentKeyTracker", ")", "{", "super", "(", "codec", ",", "flags", ",", "clientIntelligence", ",", "cacheName", ",", "topologyId", ")", ";", "KeyTracker", "segmentKeyTracker", ",", "List", "<", "String", ">", "whitelist", ")", "{", "super", "(", "codec", ",", "flags", ",", "cfg", ",", "cacheName", ",", "topologyId", ")", ";", "this", ".", "iterationId", "=", "iterationId", ";", "this", ".", "transport", "=", "transport", ";", "this", ".", "whitelist", "=", "whitelist", ";", "this", ".", "segmentKeyTracker", "=", "segmentKeyTracker", ";", "}", "@", "@", "-", "88", ",", "7", "+", "89", ",", "7", "@", "@", "protected", "IterationNextOperation", "(", "Codec", "codec", ",", "int", "flags", ",", "ClientIntelligence", "clie", "value", "=", "new", "MetadataValueImpl", "<", ">(", "creation", ",", "lifespan", ",", "lastUsed", ",", "maxIdle", ",", "version", ",", "value", ")", ";", "}", "if", "(", "segmentKeyTracker", ".", "track", "(", "key", ",", "status", ")", ")", "{", "if", "(", "segmentKeyTracker", ".", "track", "(", "key", ",", "status", ",", "whitelist", ")", ")", "{", "entries", ".", "add", "(", "new", "SimpleEntry", "<", ">(", "unmarshall", "(", "key", ",", "status", ")", ",", "(", "E", ")", "value", ")", ");", "}", "}", "@", "@", "-", "102", ",", "7", "+", "103", ",", "7", "@", "@", "protected", "IterationNextOperation", "(", "Codec", "codec", ",", "int", "flags", ",", "ClientIntelligence", "clie", "private", "Object", "unmarshall", "(", "byte", "[", "]", "bytes", ",", "short", "status", ")", "{", "Marshaller", "marshaller", "=", "transport", ".", "getTransportFactory", "(", ").", "getMarshaller", "(", ");", "return", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "bytes", ",", "status", ")", ";", "return", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "bytes", ",", "status", ",", "whitelist", ")", ";", "}", "}", "@", "@", "-", "7", ",", "7", "+", "7", ",", "7", "@", "@", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "consistenthash", ".", "SegmentConsistentHash", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "@", "@", "-", "27", ",", "10", "+", "27", ",", "10", "@", "@", "private", "final", "TransportFactory", "transportFactory", ";", "private", "final", "boolean", "metadata", ";", "IterationStartOperation", "(", "Codec", "codec", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "IterationStartOperation", "(", "Codec", "codec", ",", "int", "flags", ",", "Configuration", "cfg", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "String", "filterConverterFactory", ",", "byte", "[", "][", "]", "filterParameters", ",", "Set", "<", "Integer", ">", "segments", ",", "int", "batchSize", ",", "TransportFactory", "transportFactory", ",", "boolean", "metadata", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "this", ".", "filterConverterFactory", "=", "filterConverterFactory", ";", "this", ".", "filterParameters", "=", "filterParameters", ";", "this", ".", "segments", "=", "segments", ";", "@", "@", "-", "9", ",", "7", "+", "9", ",", "7", "@", "@", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "CacheTopologyInfo", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "Flag", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "RemoteCacheManager", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "event", ".", "ClientListenerNotifier", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "iteration", ".", "KeyTracker", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "@", "@", "-", "47", ",", "10", "+", "47", ",", "10", "@", "@", "private", "final", "ExecutorService", "executorService", ";", "private", "final", "ClientIntelligence", "clientIntelligence", ";", "private", "final", "Configuration", "cfg", ";", "public", "OperationsFactory", "(", "TransportFactory", "transportFactory", ",", "String", "cacheName", ",", "boolean", "forceReturnValue", ",", "Codec", "codec", ",", "ClientListenerNotifier", "listenerNotifier", ",", "ExecutorService", "executorService", ",", "ClientIntelligence", "clientIntelligence", ")", "{", "codec", ",", "ClientListenerNotifier", "listenerNotifier", ",", "ExecutorService", "executorService", ",", "Configuration", "cfg", ")", "{", "this", ".", "transportFactory", "=", "transportFactory", ";", "this", ".", "executorService", "=", "executorService", ";", "this", ".", "cacheNameBytes", "=", "cacheName", "=", "=", "null", "?", "null", ":", "RemoteCacheManager", ".", "cacheNameBytes", "(", "cacheName", ")", ";", "@", "@", "-", "61", ",", "11", "+", "61", ",", "11", "@", "@", "public", "OperationsFactory", "(", "TransportFactory", "transportFactory", ",", "String", "cacheName", ",", "bo", "this", ".", "forceReturnValue", "=", "forceReturnValue", ";", "this", ".", "codec", "=", "codec", ";", "this", ".", "listenerNotifier", "=", "listenerNotifier", ";", "this", ".", "clientIntelligence", "=", "clientIntelligence", ";", "this", ".", "cfg", "=", "cfg", ";", "}", "public", "OperationsFactory", "(", "TransportFactory", "transportFactory", ",", "Codec", "codec", ",", "ExecutorService", "executorService", ",", "ClientIntelligence", "clientIntelligence", ")", "{", "this", "(", "transportFactory", ",", "null", ",", "false", ",", "codec", ",", "null", ",", "executorService", ",", "clientIntelligence", ")", ";", "public", "OperationsFactory", "(", "TransportFactory", "transportFactory", ",", "Codec", "codec", ",", "ExecutorService", "executorService", ",", "Configuration", "cfg", ")", "{", "this", "(", "transportFactory", ",", "null", ",", "false", ",", "codec", ",", "null", ",", "executorService", ",", "cfg", ")", ";", "}", "public", "ClientListenerNotifier", "getListenerNotifier", "(", ")", "{", "@", "@", "-", "78", ",", "110", "+", "78", ",", "110", "@", "@", "public", "ClientListenerNotifier", "getListenerNotifier", "(", ")", "{", "public", "<", "V", ">", "GetOperation", "<", "V", ">", "newGetKeyOperation", "(", "Object", "key", ",", "byte", "[", "]", "keyBytes", ")", "{", "return", "new", "GetOperation", "<", ">(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ")", ";", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ")", ";", "}", "public", "<", "K", ",", "V", ">", "GetAllParallelOperation", "<", "K", ",", "V", ">", "newGetAllOperation", "(", "Set", "<", "byte", "[", "]>", "keys", ")", "{", "return", "new", "GetAllParallelOperation", "<", ">(", "codec", ",", "transportFactory", ",", "keys", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ",", "executorService", ")", ";", "cfg", ",", "executorService", ")", ";", "}", "public", "<", "V", ">", "RemoveOperation", "<", "V", ">", "newRemoveOperation", "(", "Object", "key", ",", "byte", "[", "]", "keyBytes", ")", "{", "return", "new", "RemoveOperation", "<", ">(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ")", ";", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ")", ";", "}", "public", "<", "V", ">", "RemoveIfUnmodifiedOperation", "<", "V", ">", "newRemoveIfUnmodifiedOperation", "(", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "long", "version", ")", "{", "return", "new", "RemoveIfUnmodifiedOperation", "<", ">(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ",", "version", ")", ";", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ",", "version", ")", ";", "}", "public", "ReplaceIfUnmodifiedOperation", "newReplaceIfUnmodifiedOperation", "(", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "value", ",", "long", "lifespan", ",", "TimeUnit", "lifespanTimeUnit", ",", "long", "maxIdle", ",", "TimeUnit", "maxIdleTimeUnit", ",", "long", "version", ")", "{", "return", "new", "ReplaceIfUnmodifiedOperation", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "lifespan", ",", "maxIdle", ")", ",", "clientIntelligence", ",", "value", ",", "lifespan", ",", "lifespanTimeUnit", ",", "maxIdle", ",", "maxIdleTimeUnit", ",", "version", ")", ";", "cfg", ",", "value", ",", "lifespan", ",", "lifespanTimeUnit", ",", "maxIdle", ",", "maxIdleTimeUnit", ",", "version", ")", ";", "}", "public", "<", "V", ">", "GetWithVersionOperation", "<", "V", ">", "newGetWithVersionOperation", "(", "Object", "key", ",", "byte", "[", "]", "keyBytes", ")", "{", "return", "new", "GetWithVersionOperation", "<", ">(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ")", ";", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ")", ";", "}", "public", "<", "V", ">", "GetWithMetadataOperation", "<", "V", ">", "newGetWithMetadataOperation", "(", "Object", "key", ",", "byte", "[", "]", "keyBytes", ")", "{", "return", "new", "GetWithMetadataOperation", "<", ">(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ")", ";", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ")", ";", "}", "public", "StatsOperation", "newStatsOperation", "(", ")", "{", "return", "new", "StatsOperation", "(", "codec", ",", "transportFactory", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ")", ";", "codec", ",", "transportFactory", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ")", ";", "}", "public", "<", "V", ">", "PutOperation", "<", "V", ">", "newPutKeyValueOperation", "(", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "value", ",", "long", "lifespan", ",", "TimeUnit", "lifespanTimeUnit", ",", "long", "maxIdle", ",", "TimeUnit", "maxIdleTimeUnit", ")", "{", "return", "new", "PutOperation", "<", ">(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "lifespan", ",", "maxIdle", ")", ",", "clientIntelligence", ",", "value", ",", "lifespan", ",", "lifespanTimeUnit", ",", "maxIdle", ",", "maxIdleTimeUnit", ")", ";", "cfg", ",", "value", ",", "lifespan", ",", "lifespanTimeUnit", ",", "maxIdle", ",", "maxIdleTimeUnit", ")", ";", "}", "public", "PutAllParallelOperation", "newPutAllOperation", "(", "Map", "<", "byte", "[", "],", "byte", "[", "]>", "map", ",", "long", "lifespan", ",", "TimeUnit", "lifespanTimeUnit", ",", "long", "maxIdle", ",", "TimeUnit", "maxIdleTimeUnit", ")", "{", "return", "new", "PutAllParallelOperation", "(", "codec", ",", "transportFactory", ",", "map", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "lifespan", ",", "maxIdle", ")", ",", "clientIntelligence", ",", "codec", ",", "transportFactory", ",", "map", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "lifespan", ",", "maxIdle", ")", ",", "cfg", ",", "lifespan", ",", "lifespanTimeUnit", ",", "maxIdle", ",", "maxIdleTimeUnit", ",", "executorService", ")", ";", "}", "public", "<", "V", ">", "PutIfAbsentOperation", "<", "V", ">", "newPutIfAbsentOperation", "(", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "value", ",", "long", "lifespan", ",", "TimeUnit", "lifespanUnit", ",", "long", "maxIdleTime", ",", "TimeUnit", "maxIdleTimeUnit", ")", "{", "return", "new", "PutIfAbsentOperation", "<", ">(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "lifespan", ",", "maxIdleTime", ")", ",", "clientIntelligence", ",", "value", ",", "lifespan", ",", "lifespanUnit", ",", "maxIdleTime", ",", "maxIdleTimeUnit", ")", ";", "cfg", ",", "value", ",", "lifespan", ",", "lifespanUnit", ",", "maxIdleTime", ",", "maxIdleTimeUnit", ")", ";", "}", "public", "<", "V", ">", "ReplaceOperation", "<", "V", ">", "newReplaceOperation", "(", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "values", ",", "long", "lifespan", ",", "TimeUnit", "lifespanTimeUnit", ",", "long", "maxIdle", ",", "TimeUnit", "maxIdleTimeUnit", ")", "{", "return", "new", "ReplaceOperation", "<", ">(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "lifespan", ",", "maxIdle", ")", ",", "clientIntelligence", ",", "values", ",", "lifespan", ",", "lifespanTimeUnit", ",", "maxIdle", ",", "maxIdleTimeUnit", ")", ";", "cfg", ",", "values", ",", "lifespan", ",", "lifespanTimeUnit", ",", "maxIdle", ",", "maxIdleTimeUnit", ")", ";", "}", "public", "ContainsKeyOperation", "newContainsKeyOperation", "(", "Object", "key", ",", "byte", "[", "]", "keyBytes", ")", "{", "return", "new", "ContainsKeyOperation", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ")", ";", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ")", ";", "}", "public", "ClearOperation", "newClearOperation", "(", ")", "{", "return", "new", "ClearOperation", "(", "codec", ",", "transportFactory", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ")", ";", "codec", ",", "transportFactory", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ")", ";", "}", "public", "<", "K", ",", "V", ">", "BulkGetOperation", "<", "K", ",", "V", ">", "newBulkGetOperation", "(", "int", "size", ")", "{", "return", "new", "BulkGetOperation", "(", "codec", ",", "transportFactory", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ",", "size", ")", ";", "codec", ",", "transportFactory", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ",", "size", ")", ";", "}", "public", "<", "K", ">", "BulkGetKeysOperation", "<", "K", ">", "newBulkGetKeysOperation", "(", "int", "scope", ")", "{", "return", "new", "BulkGetKeysOperation", "<", ">(", "codec", ",", "transportFactory", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ",", "scope", ")", ";", "codec", ",", "transportFactory", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ",", "scope", ")", ";", "}", "public", "AddClientListenerOperation", "newAddClientListenerOperation", "(", "Object", "listener", ")", "{", "return", "new", "AddClientListenerOperation", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ",", "listenerNotifier", ",", "cacheName", ",", "topologyId", ",", "flags", "(", "),", "cfg", ",", "listenerNotifier", ",", "listener", ",", "null", ",", "null", ")", ";", "}", "public", "AddClientListenerOperation", "newAddClientListenerOperation", "(", "Object", "listener", ",", "byte", "[", "][", "]", "filterFactoryParams", ",", "byte", "[", "][", "]", "converterFactoryParams", ")", "{", "return", "new", "AddClientListenerOperation", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ",", "listenerNotifier", ",", "cacheName", ",", "topologyId", ",", "flags", "(", "),", "cfg", ",", "listenerNotifier", ",", "listener", ",", "filterFactoryParams", ",", "converterFactoryParams", ")", ";", "}", "public", "RemoveClientListenerOperation", "newRemoveClientListenerOperation", "(", "Object", "listener", ")", "{", "return", "new", "RemoveClientListenerOperation", "(", "codec", ",", "transportFactory", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ",", "listenerNotifier", ",", "listener", ")", ";", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ",", "listenerNotifier", ",", "listener", ")", ";", "}", "/", "**", "@", "@", "-", "191", ",", "7", "+", "191", ",", "7", "@", "@", "public", "RemoveClientListenerOperation", "newRemoveClientListenerOperation", "(", "Object", "lis", "*", "@", "return", "a", "ping", "operation", "for", "a", "particular", "node", "*", "/", "public", "PingOperation", "newPingOperation", "(", "Transport", "transport", ")", "{", "return", "new", "PingOperation", "(", "codec", ",", "topologyId", ",", "clientIntelligence", ",", "transport", ",", "cacheNameBytes", ")", ";", "return", "new", "PingOperation", "(", "codec", ",", "topologyId", ",", "cfg", ",", "transport", ",", "cacheNameBytes", ")", ";", "}", "/", "**", "@", "@", "-", "203", ",", "21", "+", "203", ",", "21", "@", "@", "public", "PingOperation", "newPingOperation", "(", "Transport", "transport", ")", "{", "*", "/", "public", "FaultTolerantPingOperation", "newFaultTolerantPingOperation", "(", ")", "{", "return", "new", "FaultTolerantPingOperation", "(", "codec", ",", "transportFactory", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ")", ";", "codec", ",", "transportFactory", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ")", ";", "}", "public", "QueryOperation", "newQueryOperation", "(", "RemoteQuery", "remoteQuery", ")", "{", "return", "new", "QueryOperation", "(", "codec", ",", "transportFactory", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ",", "remoteQuery", ")", ";", "codec", ",", "transportFactory", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ",", "remoteQuery", ")", ";", "}", "public", "SizeOperation", "newSizeOperation", "(", ")", "{", "return", "new", "SizeOperation", "(", "codec", ",", "transportFactory", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ")", ";", "return", "new", "SizeOperation", "(", "codec", ",", "transportFactory", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ")", ";", "}", "public", "<", "T", ">", "ExecuteOperation", "<", "T", ">", "newExecuteOperation", "(", "String", "taskName", ",", "Map", "<", "String", ",", "byte", "[", "]>", "marshalledParams", ")", "{", "return", "new", "ExecuteOperation", "<", ">(", "codec", ",", "transportFactory", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ",", "taskName", ",", "marshalledParams", ")", ";", "topologyId", ",", "flags", "(", "),", "cfg", ",", "taskName", ",", "marshalledParams", ")", ";", "}", "private", "int", "flags", "(", "long", "lifespan", ",", "long", "maxIdle", ")", "{", "@", "@", "-", "265", ",", "30", "+", "265", ",", "30", "@", "@", "public", "CacheTopologyInfo", "getCacheTopologyInfo", "(", ")", "{", "}", "public", "IterationStartOperation", "newIterationStartOperation", "(", "String", "filterConverterFactory", ",", "byte", "[", "][", "]", "filterParameters", ",", "Set", "<", "Integer", ">", "segments", ",", "int", "batchSize", ",", "boolean", "metadata", ")", "{", "return", "new", "IterationStartOperation", "(", "codec", ",", "flags", "(", "),", "clientIntelligence", ",", "cacheNameBytes", ",", "topologyId", ",", "filterConverterFactory", ",", "filterParameters", ",", "segments", ",", "batchSize", ",", "transportFactory", ",", "metadata", ")", ";", "return", "new", "IterationStartOperation", "(", "codec", ",", "flags", "(", "),", "cfg", ",", "cacheNameBytes", ",", "topologyId", ",", "filterConverterFactory", ",", "filterParameters", ",", "segments", ",", "batchSize", ",", "transportFactory", ",", "metadata", ")", ";", "}", "public", "IterationEndOperation", "newIterationEndOperation", "(", "String", "iterationId", ",", "Transport", "transport", ")", "{", "return", "new", "IterationEndOperation", "(", "codec", ",", "flags", "(", "),", "clientIntelligence", ",", "cacheNameBytes", ",", "topologyId", ",", "iterationId", ",", "transportFactory", ",", "transport", ")", ";", "return", "new", "IterationEndOperation", "(", "codec", ",", "flags", "(", "),", "cfg", ",", "cacheNameBytes", ",", "topologyId", ",", "iterationId", ",", "transportFactory", ",", "transport", ")", ";", "}", "public", "<", "K", ",", "V", ">", "IterationNextOperation", "newIterationNextOperation", "(", "String", "iterationId", ",", "Transport", "transport", ",", "KeyTracker", "segmentKeyTracker", ")", "{", "return", "new", "IterationNextOperation", "(", "codec", ",", "flags", "(", "),", "clientIntelligence", ",", "cacheNameBytes", ",", "topologyId", ",", "iterationId", ",", "transport", ",", "segmentKeyTracker", ")", ";", "return", "new", "IterationNextOperation", "(", "codec", ",", "flags", "(", "),", "cfg", ",", "cacheNameBytes", ",", "topologyId", ",", "iterationId", ",", "transport", ",", "segmentKeyTracker", ",", "cfg", ".", "serialWhitelist", "(", "))", ";", "}", "public", "<", "K", ">", "GetStreamOperation", "newGetStreamOperation", "(", "K", "key", ",", "byte", "[", "]", "keyBytes", ",", "int", "offset", ")", "{", "return", "new", "GetStreamOperation", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "offset", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ")", ";", "return", "new", "GetStreamOperation", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "offset", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ")", ";", "}", "public", "<", "K", ">", "PutStreamOperation", "newPutStreamOperation", "(", "K", "key", ",", "byte", "[", "]", "keyBytes", ",", "long", "version", ",", "long", "lifespan", ",", "TimeUnit", "lifespanUnit", ",", "long", "maxIdle", ",", "TimeUnit", "maxIdleUnit", ")", "{", "return", "new", "PutStreamOperation", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ",", "version", ",", "lifespan", ",", "lifespanUnit", ",", "maxIdle", ",", "maxIdleUnit", ")", ";", "return", "new", "PutStreamOperation", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ",", "version", ",", "lifespan", ",", "lifespanUnit", ",", "maxIdle", ",", "maxIdleUnit", ")", ";", "}", "public", "<", "K", ">", "PutStreamOperation", "newPutStreamOperation", "(", "K", "key", ",", "byte", "[", "]", "keyBytes", ",", "long", "lifespan", ",", "TimeUnit", "lifespanUnit", ",", "long", "maxIdle", ",", "TimeUnit", "maxIdleUnit", ")", "{", "return", "new", "PutStreamOperation", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ",", "PutStreamOperation", ".", "VERSION_PUT", ",", "lifespan", ",", "lifespanUnit", ",", "maxIdle", ",", "maxIdleUnit", ")", ";", "return", "new", "PutStreamOperation", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ",", "PutStreamOperation", ".", "VERSION_PUT", ",", "lifespan", ",", "lifespanUnit", ",", "maxIdle", ",", "maxIdleUnit", ")", ";", "}", "public", "<", "K", ">", "PutStreamOperation", "newPutIfAbsentStreamOperation", "(", "K", "key", ",", "byte", "[", "]", "keyBytes", ",", "long", "lifespan", ",", "TimeUnit", "lifespanUnit", ",", "long", "maxIdle", ",", "TimeUnit", "maxIdleUnit", ")", "{", "return", "new", "PutStreamOperation", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "clientIntelligence", ",", "PutStreamOperation", ".", "VERSION_PUT_IF_ABSENT", ",", "lifespan", ",", "lifespanUnit", ",", "maxIdle", ",", "maxIdleUnit", ")", ";", "return", "new", "PutStreamOperation", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheNameBytes", ",", "topologyId", ",", "flags", "(", "),", "cfg", ",", "PutStreamOperation", ".", "VERSION_PUT_IF_ABSENT", ",", "lifespan", ",", "lifespanUnit", ",", "maxIdle", ",", "maxIdleUnit", ")", ";", "}", "}", "@", "@", "-", "11", ",", "6", "+", "11", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "exceptions", ".", "ParallelOperationException", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "TransportFactory", ";", "@", "@", "-", "30", ",", "8", "+", "31", ",", "8", "@", "@", "protected", "final", "CompletionService", "<", "T", ">", "completionService", ";", "protected", "ParallelHotRodOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "ExecutorService", "executorService", ")", "{", "super", "(", "codec", ",", "flags", ",", "clientIntelligence", ",", "cacheName", ",", "topologyId", ")", ";", "topologyId", ",", "int", "flags", ",", "Configuration", "cfg", ",", "ExecutorService", "executorService", ")", "{", "super", "(", "codec", ",", "flags", ",", "cfg", ",", "cacheName", ",", "topologyId", ")", ";", "this", ".", "transportFactory", "=", "transportFactory", ";", "this", ".", "completionService", "=", "new", "ExecutorCompletionService", "<", ">(", "executorService", ")", ";", "}", "@", "@", "-", "2", ",", "7", "+", "2", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "exceptions", ".", "HotRodClientException", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "exceptions", ".", "InvalidResponseException", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "@", "@", "-", "28", ",", "12", "+", "28", ",", "12", "@", "@", "private", "final", "Transport", "transport", ";", "public", "PingOperation", "(", "Codec", "codec", ",", "AtomicInteger", "topologyId", ",", "ClientIntelligence", "clientIntelligence", ",", "Transport", "transport", ")", "{", "this", "(", "codec", ",", "topologyId", ",", "clientIntelligence", ",", "transport", ",", "DEFAULT_CACHE_NAME_BYTES", ")", ";", "public", "PingOperation", "(", "Codec", "codec", ",", "AtomicInteger", "topologyId", ",", "Configuration", "cfg", ",", "Transport", "transport", ")", "{", "this", "(", "codec", ",", "topologyId", ",", "cfg", ",", "transport", ",", "DEFAULT_CACHE_NAME_BYTES", ")", ";", "}", "public", "PingOperation", "(", "Codec", "codec", ",", "AtomicInteger", "topologyId", ",", "ClientIntelligence", "clientIntelligence", ",", "Transport", "transport", ",", "byte", "[", "]", "cacheName", ")", "{", "super", "(", "codec", ",", "0", ",", "clientIntelligence", ",", "cacheName", ",", "topologyId", ")", ";", "public", "PingOperation", "(", "Codec", "codec", ",", "AtomicInteger", "topologyId", ",", "Configuration", "cfg", ",", "Transport", "transport", ",", "byte", "[", "]", "cacheName", ")", "{", "super", "(", "codec", ",", "0", ",", "cfg", ",", "cacheName", ",", "topologyId", ")", ";", "this", ".", "transport", "=", "transport", ";", "}", "@", "@", "-", "7", ",", "7", "+", "7", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "TimeUnit", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "exceptions", ".", "InvalidResponseException", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "@", "@", "-", "28", ",", "9", "+", "28", ",", "9", "@", "@", "public", "PutAllOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Map", "<", "byte", "[", "],", "byte", "[", "]>", "map", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "int", "flags", ",", "Configuration", "cfg", ",", "long", "lifespan", ",", "TimeUnit", "lifespanTimeUnit", ",", "long", "maxIdle", ",", "TimeUnit", "maxIdleTimeUnit", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "this", ".", "map", "=", "map", ";", "this", ".", "lifespan", "=", "lifespan", ";", "this", ".", "lifespanTimeUnit", "=", "lifespanTimeUnit", ";", "@", "@", "-", "9", ",", "7", "+", "9", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "java", ".", "util", ".", "stream", ".", "Collectors", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "TransportFactory", ";", "@", "@", "-", "25", ",", "10", "+", "25", ",", "10", "@", "@", "private", "final", "TimeUnit", "maxIdleTimeUnit", ";", "public", "PutAllParallelOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Map", "<", "byte", "[", "],", "byte", "[", "]>", "map", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "long", "lifespan", ",", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "Configuration", "cfg", ",", "long", "lifespan", ",", "TimeUnit", "lifespanTimeUnit", ",", "long", "maxIdle", ",", "TimeUnit", "maxIdleTimeUnit", ",", "ExecutorService", "executorService", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ",", "executorService", ")", ";", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ",", "executorService", ")", ";", "this", ".", "map", "=", "map", ";", "this", ".", "lifespan", "=", "lifespan", ";", "this", ".", "lifespanTimeUnit", "=", "lifespanTimeUnit", ";", "@", "@", "-", "52", ",", "7", "+", "52", ",", "7", "@", "@", "public", "PutAllParallelOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "M", "return", "splittedMaps", ".", "values", "(", ").", "stream", "(", ").", "map", "(", "mapSubset", "-", ">", "new", "PutAllOperation", "(", "codec", ",", "transportFactory", ",", "mapSubset", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ",", "lifespan", ",", "lifespanTimeUnit", ",", "maxIdle", ",", "maxIdleTimeUnit", ")", ").", "collect", "(", "Collectors", ".", "toList", "(", "))", ";", "cfg", ",", "lifespan", ",", "lifespanTimeUnit", ",", "maxIdle", ",", "maxIdleTimeUnit", ")", ").", "collect", "(", "Collectors", ".", "toList", "(", "))", ";", "}", "@", "Override", "@", "@", "-", "3", ",", "7", "+", "3", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "TimeUnit", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HotRodConstants", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "@", "@", "-", "28", ",", "9", "+", "28", ",", "9", "@", "@", "public", "PutIfAbsentOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "byte", "[", "]", "value", ",", "long", "lifespan", ",", "int", "flags", ",", "Configuration", "cfg", ",", "byte", "[", "]", "value", ",", "long", "lifespan", ",", "TimeUnit", "lifespanTimeUnit", ",", "long", "maxIdleTime", ",", "TimeUnit", "maxIdleTimeUnit", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ",", "value", ",", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ",", "value", ",", "lifespan", ",", "lifespanTimeUnit", ",", "maxIdleTime", ",", "maxIdleTimeUnit", ")", ";", "}", "@", "@", "-", "4", ",", "6", "+", "4", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "exceptions", ".", "InvalidResponseException", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HotRodConstants", ";", "@", "@", "-", "23", ",", "10", "+", "24", ",", "10", "@", "@", "public", "PutOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "byte", "[", "]", "value", ",", "long", "lifespan", ",", "TimeUnit", "lifespanTimeUnit", ",", "int", "flags", ",", "Configuration", "cfg", ",", "byte", "[", "]", "value", ",", "long", "lifespan", ",", "TimeUnit", "lifespanTimeUnit", ",", "long", "maxIdle", ",", "TimeUnit", "maxIdleTimeUnit", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ",", "value", ",", "lifespan", ",", "lifespanTimeUnit", ",", "maxIdle", ",", "maxIdleTimeUnit", ")", ";", "flags", ",", "cfg", ",", "value", ",", "lifespan", ",", "lifespanTimeUnit", ",", "maxIdle", ",", "maxIdleTimeUnit", ")", ";", "}", "@", "Override", "@", "@", "-", "4", ",", "7", "+", "4", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "TimeUnit", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "exceptions", ".", "InvalidResponseException", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "@", "@", "-", "33", ",", "10", "+", "33", ",", "10", "@", "@", "public", "PutStreamOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "long", "version", ",", "int", "flags", ",", "Configuration", "cfg", ",", "long", "version", ",", "long", "lifespan", ",", "TimeUnit", "lifespanTimeUnit", ",", "long", "maxIdle", ",", "TimeUnit", "maxIdleTimeUnit", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "flags", ",", "cfg", ")", ";", "this", ".", "version", "=", "version", ";", "this", ".", "lifespan", "=", "lifespan", ";", "this", ".", "maxIdle", "=", "maxIdle", ";", "@", "@", "-", "10", ",", "7", "+", "10", ",", "7", "@", "@", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "exceptions", ".", "HotRodClientException", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "@", "@", "-", "33", ",", "8", "+", "33", ",", "8", "@", "@", "private", "final", "RemoteQuery", "remoteQuery", ";", "public", "QueryOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "RemoteQuery", "remoteQuery", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "int", "flags", ",", "Configuration", "cfg", ",", "RemoteQuery", "remoteQuery", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "this", ".", "remoteQuery", "=", "remoteQuery", ";", "}", "@", "@", "-", "3", ",", "7", "+", "3", ",", "7", "@", "@", "import", "java", ".", "net", ".", "SocketAddress", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "event", ".", "ClientListenerNotifier", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "@", "@", "-", "29", ",", "9", "+", "29", ",", "9", "@", "@", "protected", "RemoveClientListenerOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "Configuration", "cfg", ",", "ClientListenerNotifier", "listenerNotifier", ",", "Object", "listener", ")", "{", "super", "(", "codec", ",", "flags", ",", "clientIntelligence", ",", "cacheName", ",", "topologyId", ")", ";", "super", "(", "codec", ",", "flags", ",", "cfg", ",", "cacheName", ",", "topologyId", ")", ";", "this", ".", "transportFactory", "=", "transportFactory", ";", "this", ".", "listenerNotifier", "=", "listenerNotifier", ";", "this", ".", "listener", "=", "listener", ";", "@", "@", "-", "3", ",", "6", "+", "3", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "VersionedOperationResponse", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "@", "@", "-", "25", ",", "9", "+", "26", ",", "9", "@", "@", "public", "RemoveIfUnmodifiedOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "int", "flags", ",", "Configuration", "cfg", ",", "long", "version", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "this", ".", "version", "=", "version", ";", "}", "@", "@", "-", "2", ",", "7", "+", "2", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HotRodConstants", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "@", "@", "-", "21", ",", "8", "+", "21", ",", "8", "@", "@", "public", "class", "RemoveOperation", "<", "V", ">", "extends", "AbstractKeyOperation", "<", "V", ">", "{", "public", "RemoveOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "Configuration", "cfg", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "}", "@", "Override", "@", "@", "-", "4", ",", "6", "+", "4", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "VersionedOperationResponse", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "@", "@", "-", "21", ",", "9", "+", "22", ",", "9", "@", "@", "private", "final", "long", "version", ";", "public", "ReplaceIfUnmodifiedOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "byte", "[", "]", "value", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "Configuration", "cfg", ",", "byte", "[", "]", "value", ",", "long", "lifespan", ",", "TimeUnit", "lifespanTimeUnit", ",", "long", "maxIdle", ",", "TimeUnit", "maxIdleTimeUnit", ",", "long", "version", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ",", "value", ",", "lifespan", ",", "lifespanTimeUnit", ",", "maxIdle", ",", "maxIdleTimeUnit", ")", ";", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ",", "value", ",", "lifespan", ",", "lifespanTimeUnit", ",", "maxIdle", ",", "maxIdleTimeUnit", ")", ";", "this", ".", "version", "=", "version", ";", "}", "@", "@", "-", "3", ",", "7", "+", "3", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "TimeUnit", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "TransportFactory", ";", "@", "@", "-", "22", ",", "9", "+", "22", ",", "9", "@", "@", "public", "ReplaceOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "Object", "key", ",", "byte", "[", "]", "keyBytes", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ",", "byte", "[", "]", "value", ",", "int", "flags", ",", "Configuration", "cfg", ",", "byte", "[", "]", "value", ",", "long", "lifespan", ",", "TimeUnit", "lifespanTimeUnit", ",", "long", "maxIdle", ",", "TimeUnit", "maxIdleTimeUnit", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ",", "value", ",", "super", "(", "codec", ",", "transportFactory", ",", "key", ",", "keyBytes", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ",", "value", ",", "lifespan", ",", "lifespanTimeUnit", ",", "maxIdle", ",", "maxIdleTimeUnit", ")", ";", "}", "@", "@", "-", "6", ",", "6", "+", "6", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "exceptions", ".", "HotRodClientException", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "exceptions", ".", "RemoteIllegalLifecycleStateException", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "exceptions", ".", "RemoteNodeSuspectException", ";", "@", "@", "-", "38", ",", "8", "+", "39", ",", "8", "@", "@", "private", "boolean", "triedCompleteRestart", "=", "false", ";", "protected", "RetryOnFailureOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ")", "{", "super", "(", "codec", ",", "flags", ",", "clientIntelligence", ",", "cacheName", ",", "topologyId", ")", ";", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "Configuration", "cfg", ")", "{", "super", "(", "codec", ",", "flags", ",", "cfg", ",", "cacheName", ",", "topologyId", ")", ";", "this", ".", "transportFactory", "=", "transportFactory", ";", "}", "@", "@", "-", "4", ",", "7", "+", "4", ",", "7", "@", "@", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "@", "@", "-", "13", ",", "8", "+", "13", ",", "8", "@", "@", "public", "class", "SizeOperation", "extends", "RetryOnFailureOperation", "<", "Integer", ">", "{", "protected", "SizeOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "Configuration", "cfg", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "}", "@", "Override", "@", "@", "-", "7", ",", "6", "+", "7", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "Codec", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HeaderParams", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "@", "@", "-", "24", ",", "8", "+", "25", ",", "8", "@", "@", "public", "class", "StatsOperation", "extends", "RetryOnFailureOperation", "<", "Map", "<", "String", ",", "String", ">", ">", "{", "public", "StatsOperation", "(", "Codec", "codec", ",", "TransportFactory", "transportFactory", ",", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "ClientIntelligence", "clientIntelligence", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "clientIntelligence", ")", ";", "byte", "[", "]", "cacheName", ",", "AtomicInteger", "topologyId", ",", "int", "flags", ",", "Configuration", "cfg", ")", "{", "super", "(", "codec", ",", "transportFactory", ",", "cacheName", ",", "topologyId", ",", "flags", ",", "cfg", ")", ";", "}", "@", "Override", "@", "@", "-", "3", ",", "6", "+", "3", ",", "7", "@", "@", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "io", ".", "OutputStream", ";", "import", "java", ".", "lang", ".", "annotation", ".", "Annotation", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "TimeUnit", ";", "@", "@", "-", "45", ",", "11", "+", "46", ",", "11", "@", "@", "void", "writeClientListenerParams", "(", "Transport", "transport", ",", "ClientListener", "clientListene", "*", "/", "short", "readHeader", "(", "Transport", "transport", ",", "HeaderParams", "params", ")", ";", "ClientEvent", "readEvent", "(", "Transport", "transport", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ")", ";", "ClientEvent", "readEvent", "(", "Transport", "transport", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ",", "List", "<", "String", ">", "whitelist", ")", ";", "Either", "<", "Short", ",", "ClientEvent", ">", "readHeaderOrEvent", "(", "Transport", "transport", ",", "HeaderParams", "params", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ")", ";", "Either", "<", "Short", ",", "ClientEvent", ">", "readHeaderOrEvent", "(", "Transport", "transport", ",", "HeaderParams", "params", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ",", "List", "<", "String", ">", "whitelist", ")", ";", "Object", "returnPossiblePrevValue", "(", "Transport", "transport", ",", "short", "status", ",", "int", "flags", ")", ";", "Object", "returnPossiblePrevValue", "(", "Transport", "transport", ",", "short", "status", ",", "int", "flags", ",", "List", "<", "String", ">", "whitelist", ")", ";", "/", "**", "*", "Logger", "for", "Hot", "Rod", "client", "codec", "@", "@", "-", "59", ",", "7", "+", "60", ",", "7", "@", "@", "void", "writeClientListenerParams", "(", "Transport", "transport", ",", "ClientListener", "clientListene", "/", "**", "*", "Read", "and", "unmarshall", "byte", "array", ".", "*", "/", "<", "T", ">", "T", "readUnmarshallByteArray", "(", "Transport", "transport", ",", "short", "status", ")", ";", "<", "T", ">", "T", "readUnmarshallByteArray", "(", "Transport", "transport", ",", "short", "status", ",", "List", "<", "String", ">", "whitelist", ")", ";", "/", "**", "*", "Reads", "a", "stream", "of", "data", "@", "@", "-", "9", ",", "6", "+", "9", ",", "7", "@", "@", "import", "java", ".", "net", ".", "SocketAddress", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "LinkedHashMap", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "TimeUnit", ";", "@", "@", "-", "134", ",", "23", "+", "135", ",", "23", "@", "@", "public", "short", "readHeader", "(", "Transport", "transport", ",", "HeaderParams", "params", ")", "{", "}", "@", "Override", "public", "ClientEvent", "readEvent", "(", "Transport", "transport", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ")", "{", "public", "ClientEvent", "readEvent", "(", "Transport", "transport", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ",", "List", "<", "String", ">", "whitelist", ")", "{", "return", "null", ";", "/", "/", "No", "events", "sent", "in", "Hot", "Rod", "1", ".", "x", "protocol", "}", "@", "Override", "public", "Either", "<", "Short", ",", "ClientEvent", ">", "readHeaderOrEvent", "(", "Transport", "transport", ",", "HeaderParams", "params", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ")", "{", "public", "Either", "<", "Short", ",", "ClientEvent", ">", "readHeaderOrEvent", "(", "Transport", "transport", ",", "HeaderParams", "params", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ",", "List", "<", "String", ">", "whitelist", ")", "{", "return", "null", ";", "/", "/", "No", "events", "sent", "in", "Hot", "Rod", "1", ".", "x", "protocol", "}", "@", "Override", "public", "Object", "returnPossiblePrevValue", "(", "Transport", "transport", ",", "short", "status", ",", "int", "flags", ")", "{", "public", "Object", "returnPossiblePrevValue", "(", "Transport", "transport", ",", "short", "status", ",", "int", "flags", ",", "List", "<", "String", ">", "whitelist", ")", "{", "Marshaller", "marshaller", "=", "transport", ".", "getTransportFactory", "(", ").", "getMarshaller", "(", ");", "if", "(", "hasForceReturn", "(", "flags", ")", ")", "{", "byte", "[", "]", "bytes", "=", "transport", ".", "readArray", "(", ");", "if", "(", "trace", ")", "getLog", "(", ").", "tracef", "(", "\"", "Previous", "value", "bytes", "is", ":", "%", "s", "\"", ",", "Util", ".", "printArray", "(", "bytes", ",", "false", ")", ");", "/", "/", "0", "-", "length", "response", "means", "null", "return", "bytes", ".", "length", "=", "=", "0", "?", "null", ":", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "bytes", ",", "status", ")", ";", "return", "bytes", ".", "length", "=", "=", "0", "?", "null", ":", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "bytes", ",", "status", ",", "whitelist", ")", ";", "}", "else", "{", "return", "null", ";", "}", "@", "@", "-", "166", ",", "8", "+", "167", ",", "8", "@", "@", "public", "Log", "getLog", "(", ")", "{", "}", "@", "Override", "public", "<", "T", ">", "T", "readUnmarshallByteArray", "(", "Transport", "transport", ",", "short", "status", ")", "{", "return", "CodecUtils", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ")", ";", "public", "<", "T", ">", "T", "readUnmarshallByteArray", "(", "Transport", "transport", ",", "short", "status", ",", "List", "<", "String", ">", "whitelist", ")", "{", "return", "CodecUtils", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ",", "whitelist", ")", ";", "}", "@", "Override", "@", "@", "-", "50", ",", "8", "+", "50", ",", "8", "@", "@", "final", "boolean", "trace", "=", "getLog", "(", ").", "isTraceEnabled", "(", ");", "@", "Override", "public", "<", "T", ">", "T", "readUnmarshallByteArray", "(", "Transport", "transport", ",", "short", "status", ")", "{", "return", "CodecUtils", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ")", ";", "public", "<", "T", ">", "T", "readUnmarshallByteArray", "(", "Transport", "transport", ",", "short", "status", ",", "List", "<", "String", ">", "whitelist", ")", "{", "return", "CodecUtils", ".", "readUnmarshallByteArray", "(", "transport", ",", "status", ",", "whitelist", ")", ";", "}", "@", "Override", "@", "@", "-", "163", ",", "14", "+", "163", ",", "14", "@", "@", "private", "short", "readPartialHeader", "(", "Transport", "transport", ",", "HeaderParams", "params", ",", "short", "}", "@", "Override", "public", "ClientEvent", "readEvent", "(", "Transport", "transport", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ")", "{", "public", "ClientEvent", "readEvent", "(", "Transport", "transport", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ",", "List", "<", "String", ">", "whitelist", ")", "{", "readMagic", "(", "transport", ")", ";", "readMessageId", "(", "transport", ",", "null", ")", ";", "short", "eventTypeId", "=", "transport", ".", "readByte", "(", ");", "return", "readPartialEvent", "(", "transport", ",", "expectedListenerId", ",", "marshaller", ",", "eventTypeId", ")", ";", "return", "readPartialEvent", "(", "transport", ",", "expectedListenerId", ",", "marshaller", ",", "eventTypeId", ",", "whitelist", ")", ";", "}", "protected", "ClientEvent", "readPartialEvent", "(", "Transport", "transport", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ",", "short", "eventTypeId", ")", "{", "protected", "ClientEvent", "readPartialEvent", "(", "Transport", "transport", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ",", "short", "eventTypeId", ",", "List", "<", "String", ">", "whitelist", ")", "{", "short", "status", "=", "transport", ".", "readByte", "(", ");", "transport", ".", "readByte", "(", ");", "/", "/", "ignore", ",", "no", "topology", "expected", "ClientEvent", ".", "Type", "eventType", ";", "@", "@", "-", "199", ",", "20", "+", "199", ",", "20", "@", "@", "protected", "ClientEvent", "readPartialEvent", "(", "Transport", "transport", ",", "byte", "[", "]", "expectedListe", "boolean", "isRetried", "=", "transport", ".", "readByte", "(", ")", "=", "=", "1", "?", "true", ":", "false", ";", "if", "(", "isCustom", "=", "=", "1", ")", "{", "final", "Object", "eventData", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ")", ";", "final", "Object", "eventData", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ",", "whitelist", ")", ";", "return", "createCustomEvent", "(", "eventData", ",", "eventType", ",", "isRetried", ")", ";", "}", "else", "{", "switch", "(", "eventType", ")", "{", "case", "CLIENT_CACHE_ENTRY_CREATED", ":", "Object", "createdKey", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ")", ";", "Object", "createdKey", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ",", "whitelist", ")", ";", "long", "createdDataVersion", "=", "transport", ".", "readLong", "(", ");", "return", "createCreatedEvent", "(", "createdKey", ",", "createdDataVersion", ",", "isRetried", ")", ";", "case", "CLIENT_CACHE_ENTRY_MODIFIED", ":", "Object", "modifiedKey", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ")", ";", "Object", "modifiedKey", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ",", "whitelist", ")", ";", "long", "modifiedDataVersion", "=", "transport", ".", "readLong", "(", ");", "return", "createModifiedEvent", "(", "modifiedKey", ",", "modifiedDataVersion", ",", "isRetried", ")", ";", "case", "CLIENT_CACHE_ENTRY_REMOVED", ":", "Object", "removedKey", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ")", ";", "Object", "removedKey", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ",", "whitelist", ")", ";", "return", "createRemovedEvent", "(", "removedKey", ",", "isRetried", ")", ";", "default", ":", "throw", "log", ".", "unknownEvent", "(", "eventTypeId", ")", ";", "@", "@", "-", "221", ",", "29", "+", "221", ",", "29", "@", "@", "protected", "ClientEvent", "readPartialEvent", "(", "Transport", "transport", ",", "byte", "[", "]", "expectedListe", "}", "@", "Override", "public", "Either", "<", "Short", ",", "ClientEvent", ">", "readHeaderOrEvent", "(", "Transport", "transport", ",", "HeaderParams", "params", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ")", "{", "public", "Either", "<", "Short", ",", "ClientEvent", ">", "readHeaderOrEvent", "(", "Transport", "transport", ",", "HeaderParams", "params", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ",", "List", "<", "String", ">", "whitelist", ")", "{", "readMagic", "(", "transport", ")", ";", "readMessageId", "(", "transport", ",", "null", ")", ";", "short", "opCode", "=", "transport", ".", "readByte", "(", ");", "switch", "(", "opCode", ")", "{", "case", "CACHE_ENTRY_CREATED_EVENT_RESPONSE", ":", "case", "CACHE_ENTRY_MODIFIED_EVENT_RESPONSE", ":", "case", "CACHE_ENTRY_REMOVED_EVENT_RESPONSE", ":", "ClientEvent", "clientEvent", "=", "readPartialEvent", "(", "transport", ",", "expectedListenerId", ",", "marshaller", ",", "opCode", ")", ";", "ClientEvent", "clientEvent", "=", "readPartialEvent", "(", "transport", ",", "expectedListenerId", ",", "marshaller", ",", "opCode", ",", "whitelist", ")", ";", "return", "Either", ".", "newRight", "(", "clientEvent", ")", ";", "default", ":", "return", "Either", ".", "newLeft", "(", "readPartialHeader", "(", "transport", ",", "params", ",", "opCode", ")", ");", "}", "}", "@", "Override", "public", "Object", "returnPossiblePrevValue", "(", "Transport", "transport", ",", "short", "status", ",", "int", "flags", ")", "{", "public", "Object", "returnPossiblePrevValue", "(", "Transport", "transport", ",", "short", "status", ",", "int", "flags", ",", "List", "<", "String", ">", "whitelist", ")", "{", "Marshaller", "marshaller", "=", "transport", ".", "getTransportFactory", "(", ").", "getMarshaller", "(", ");", "if", "(", "HotRodConstants", ".", "hasPrevious", "(", "status", ")", ")", "{", "byte", "[", "]", "bytes", "=", "transport", ".", "readArray", "(", ");", "if", "(", "trace", ")", "getLog", "(", ").", "tracef", "(", "\"", "Previous", "value", "bytes", "is", ":", "%", "s", "\"", ",", "printArray", "(", "bytes", ",", "false", ")", ");", "/", "/", "0", "-", "length", "response", "means", "null", "return", "bytes", ".", "length", "=", "=", "0", "?", "null", ":", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "bytes", ",", "status", ")", ";", "return", "bytes", ".", "length", "=", "=", "0", "?", "null", ":", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "bytes", ",", "status", ",", "whitelist", ")", ";", "}", "else", "{", "return", "null", ";", "}", "@", "@", "-", "3", ",", "6", "+", "3", ",", "7", "@", "@", "import", "static", "org", ".", "infinispan", ".", "commons", ".", "util", ".", "Util", ".", "printArray", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "annotation", ".", "ClientListener", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "event", ".", "ClientCacheEntryExpiredEvent", ";", "@", "@", "-", "34", ",", "7", "+", "35", ",", "7", "@", "@", "public", "void", "writeClientListenerParams", "(", "Transport", "transport", ",", "ClientListener", "client", "}", "@", "Override", "protected", "ClientEvent", "readPartialEvent", "(", "Transport", "transport", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ",", "short", "eventTypeId", ")", "{", "protected", "ClientEvent", "readPartialEvent", "(", "Transport", "transport", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ",", "short", "eventTypeId", ",", "List", "<", "String", ">", "whitelist", ")", "{", "short", "status", "=", "transport", ".", "readByte", "(", ");", "transport", ".", "readByte", "(", ");", "/", "/", "ignore", ",", "no", "topology", "expected", "ClientEvent", ".", "Type", "eventType", ";", "@", "@", "-", "65", ",", "25", "+", "66", ",", "25", "@", "@", "protected", "ClientEvent", "readPartialEvent", "(", "Transport", "transport", ",", "byte", "[", "]", "expectedListe", "boolean", "isRetried", "=", "transport", ".", "readByte", "(", ")", "=", "=", "1", "?", "true", ":", "false", ";", "if", "(", "isCustom", "=", "=", "1", ")", "{", "final", "Object", "eventData", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ")", ";", "final", "Object", "eventData", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ",", "whitelist", ")", ";", "return", "createCustomEvent", "(", "eventData", ",", "eventType", ",", "isRetried", ")", ";", "}", "else", "if", "(", "isCustom", "=", "=", "2", ")", "{", "/", "/", "New", "in", "2", ".", "1", ",", "dealing", "with", "raw", "custom", "events", "return", "createCustomEvent", "(", "transport", ".", "readArray", "(", "),", "eventType", ",", "isRetried", ")", ";", "/", "/", "Raw", "data", "}", "else", "{", "switch", "(", "eventType", ")", "{", "case", "CLIENT_CACHE_ENTRY_CREATED", ":", "Object", "createdKey", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ")", ";", "Object", "createdKey", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ",", "whitelist", ")", ";", "long", "createdDataVersion", "=", "transport", ".", "readLong", "(", ");", "return", "createCreatedEvent", "(", "createdKey", ",", "createdDataVersion", ",", "isRetried", ")", ";", "case", "CLIENT_CACHE_ENTRY_MODIFIED", ":", "Object", "modifiedKey", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ")", ";", "Object", "modifiedKey", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ",", "whitelist", ")", ";", "long", "modifiedDataVersion", "=", "transport", ".", "readLong", "(", ");", "return", "createModifiedEvent", "(", "modifiedKey", ",", "modifiedDataVersion", ",", "isRetried", ")", ";", "case", "CLIENT_CACHE_ENTRY_REMOVED", ":", "Object", "removedKey", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ")", ";", "Object", "removedKey", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ",", "whitelist", ")", ";", "return", "createRemovedEvent", "(", "removedKey", ",", "isRetried", ")", ";", "case", "CLIENT_CACHE_ENTRY_EXPIRED", ":", "Object", "expiredKey", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ")", ";", "Object", "expiredKey", "=", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "transport", ".", "readArray", "(", "),", "status", ",", "whitelist", ")", ";", "return", "createExpiredEvent", "(", "expiredKey", ")", ";", "default", ":", "throw", "getLog", "(", ").", "unknownEvent", "(", "eventTypeId", ")", ";", "@", "@", "-", "1", ",", "5", "+", "1", ",", "6", "@", "@", "package", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "concurrent", ".", "TimeUnit", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "@", "@", "-", "31", ",", "10", "+", "32", ",", "10", "@", "@", "public", "static", "int", "toSeconds", "(", "long", "duration", ",", "TimeUnit", "timeUnit", ")", "{", "return", "seconds", ";", "}", "static", "<", "T", ">", "T", "readUnmarshallByteArray", "(", "Transport", "transport", ",", "short", "status", ")", "{", "static", "<", "T", ">", "T", "readUnmarshallByteArray", "(", "Transport", "transport", ",", "short", "status", ",", "List", "<", "String", ">", "whitelist", ")", "{", "byte", "[", "]", "bytes", "=", "transport", ".", "readArray", "(", ");", "Marshaller", "marshaller", "=", "transport", ".", "getTransportFactory", "(", ").", "getMarshaller", "(", ");", "return", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "bytes", ",", "status", ")", ";", "return", "MarshallerUtil", ".", "bytes2obj", "(", "marshaller", ",", "bytes", ",", "status", ",", "whitelist", ")", ";", "}", "}", "@", "@", "-", "127", ",", "12", "+", "127", ",", "12", "@", "@", "public", "SaslClient", "run", "(", ")", "throws", "Exception", "{", "}", "private", "List", "<", "String", ">", "mechList", "(", "TcpTransport", "tcpTransport", ",", "AtomicInteger", "topologyId", ")", "{", "AuthMechListOperation", "op", "=", "new", "AuthMechListOperation", "(", "codec", ",", "topologyId", ",", "configuration", ".", "clientIntelligence", "(", "),", "tcpTransport", ")", ";", "AuthMechListOperation", "op", "=", "new", "AuthMechListOperation", "(", "codec", ",", "topologyId", ",", "configuration", ",", "tcpTransport", ")", ";", "return", "op", ".", "execute", "(", ");", "}", "private", "byte", "[", "]", "auth", "(", "TcpTransport", "tcpTransport", ",", "AtomicInteger", "topologyId", ",", "String", "mech", ",", "byte", "[", "]", "response", ")", "{", "AuthOperation", "op", "=", "new", "AuthOperation", "(", "codec", ",", "topologyId", ",", "configuration", ".", "clientIntelligence", "(", "),", "tcpTransport", ",", "mech", ",", "response", ")", ";", "AuthOperation", "op", "=", "new", "AuthOperation", "(", "codec", ",", "topologyId", ",", "configuration", ",", "tcpTransport", ",", "mech", ",", "response", ")", ";", "return", "op", ".", "execute", "(", ");", "}", "@", "@", "-", "49", ",", "7", "+", "49", ",", "7", "@", "@", "public", "TcpTransport", "makeObject", "(", "SocketAddress", "address", ")", "throws", "Exception", "{", "}", "protected", "PingOperation", ".", "PingResult", "ping", "(", "TcpTransport", "tcpTransport", ",", "AtomicInteger", "topologyId", ")", "{", "PingOperation", "po", "=", "new", "PingOperation", "(", "codec", ",", "topologyId", ",", "configuration", ".", "clientIntelligence", "(", "),", "tcpTransport", ")", ";", "PingOperation", "po", "=", "new", "PingOperation", "(", "codec", ",", "topologyId", ",", "configuration", ",", "tcpTransport", ")", ";", "return", "po", ".", "execute", "(", ");", "}", "@", "@", "-", "7", ",", "6", "+", "7", ",", "7", "@", "@", "import", "static", "org", ".", "jboss", ".", "logging", ".", "Logger", ".", "Level", ".", "WARN", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InvalidClassException", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "net", ".", "SocketAddress", ";", "import", "java", ".", "util", ".", "Collection", ";", "@", "@", "-", "20", ",", "6", "+", "21", ",", "7", "@", "@", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "Transport", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "transport", ".", "tcp", ".", "TcpTransport", ";", "import", "org", ".", "infinispan", ".", "commons", ".", "CacheConfigurationException", ";", "import", "org", ".", "infinispan", ".", "commons", ".", "CacheException", ";", "import", "org", ".", "infinispan", ".", "commons", ".", "CacheListenerException", ";", "import", "org", ".", "jboss", ".", "logging", ".", "BasicLogger", ";", "import", "org", ".", "jboss", ".", "logging", ".", "annotations", ".", "Cause", ";", "@", "@", "-", "252", ",", "4", "+", "254", ",", "8", "@", "@", "@", "Message", "(", "value", "=", "\"", "Cannot", "specify", "both", "a", "callback", "handler", "and", "a", "username", "for", "authentication", "\"", ",", "id", "=", "4067", ")", "CacheConfigurationException", "callbackHandlerAndUsernameMutuallyExclusive", "(", ");", "@", "Message", "(", "value", "=", "\"", "Class", "'", "%", "s", "'", "blocked", "by", "Java", "standard", "deserialization", "white", "list", ".", "Adjust", "the", "client", "configuration", "java", "serialization", "white", "list", "regular", "expression", "to", "include", "this", "class", ".", "\",", "id", "=", "4068", ")", "CacheException", "classNotInWhitelist", "(", "String", "className", ")", ";", "}", "@", "@", "-", "2", ",", "13", "+", "2", ",", "21", "@", "@", "import", "java", ".", "io", ".", "ByteArrayInputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "io", ".", "InvalidClassException", ";", "import", "java", ".", "io", ".", "ObjectInputStream", ";", "import", "java", ".", "io", ".", "ObjectStreamClass", ";", "import", "java", ".", "io", ".", "ObjectStreamConstants", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "regex", ".", "Matcher", ";", "import", "java", ".", "util", ".", "regex", ".", "Pattern", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "Configuration", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "exceptions", ".", "HotRodClientException", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "protocol", ".", "HotRodConstants", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "logging", ".", "Log", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "logging", ".", "LogFactory", ";", "import", "org", ".", "infinispan", ".", "commons", ".", "CacheException", ";", "import", "org", ".", "infinispan", ".", "commons", ".", "marshall", ".", "Marshaller", ";", "import", "org", ".", "infinispan", ".", "commons", ".", "util", ".", "Util", ";", "@", "@", "-", "22", ",", "7", "+", "30", ",", "7", "@", "@", "private", "MarshallerUtil", "(", ")", "{", "}", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "public", "static", "<", "T", ">", "T", "bytes2obj", "(", "Marshaller", "marshaller", ",", "byte", "[", "]", "bytes", ",", "short", "status", ")", "{", "public", "static", "<", "T", ">", "T", "bytes2obj", "(", "Marshaller", "marshaller", ",", "byte", "[", "]", "bytes", ",", "short", "status", ",", "List", "<", "String", ">", "whitelist", ")", "{", "if", "(", "bytes", "=", "=", "null", "|", "|", "bytes", ".", "length", "=", "=", "0", ")", "return", "null", ";", "try", "{", "Object", "ret", "=", "marshaller", ".", "objectFromByteBuffer", "(", "bytes", ")", ";", "@", "@", "-", "33", ",", "12", "+", "41", ",", "9", "@", "@", "private", "MarshallerUtil", "(", ")", "{", "}", "/", "/", "So", ",", "if", "the", "unmarshalled", "object", "is", "still", "a", "byte", "[", "],", "it", "could", "be", "a", "standard", "/", "/", "serialized", "object", ",", "so", "check", "for", "stream", "magic", "if", "(", "ret", "instanceof", "byte", "[", "]", "&", "&", "isJavaSerialized", "(", "(", "byte", "[", "])", "ret", ")", ")", "{", "try", "(", "ObjectInputStream", "ois", "=", "new", "ObjectInputStream", "(", "new", "ByteArrayInputStream", "(", "(", "byte", "[", "])", "ret", ")", "))", "{", "return", "(", "T", ")", "ois", ".", "readObject", "(", ");", "}", "catch", "(", "Exception", "ee", ")", "{", "if", "(", "log", ".", "isDebugEnabled", "(", "))", "log", ".", "debugf", "(", "\"", "Standard", "deserialization", "not", "in", "use", "for", "%", "s", "\"", ",", "Util", ".", "printArray", "(", "bytes", ")", ");", "}", "T", "ois", "=", "tryJavaDeserialize", "(", "bytes", ",", "(", "byte", "[", "])", "ret", ",", "whitelist", ")", ";", "if", "(", "ois", "!", "=", "null", ")", "return", "ois", ";", "}", "}", "@", "@", "-", "48", ",", "6", "+", "53", ",", "18", "@", "@", "private", "MarshallerUtil", "(", ")", "{", "}", "}", "}", "public", "static", "<", "T", ">", "T", "tryJavaDeserialize", "(", "byte", "[", "]", "bytes", ",", "byte", "[", "]", "ret", ",", "List", "<", "String", ">", "whitelist", ")", "{", "try", "(", "ObjectInputStream", "ois", "=", "new", "CheckedInputStream", "(", "new", "ByteArrayInputStream", "(", "ret", ")", ",", "whitelist", ")", ")", "{", "return", "(", "T", ")", "ois", ".", "readObject", "(", ");", "}", "catch", "(", "CacheException", "ce", ")", "{", "throw", "ce", ";", "}", "catch", "(", "Exception", "ee", ")", "{", "if", "(", "log", ".", "isDebugEnabled", "(", "))", "log", ".", "debugf", "(", "\"", "Standard", "deserialization", "not", "in", "use", "for", "%", "s", "\"", ",", "Util", ".", "printArray", "(", "bytes", ")", ");", "}", "return", "null", ";", "}", "private", "static", "boolean", "isJavaSerialized", "(", "byte", "[", "]", "bytes", ")", "{", "if", "(", "bytes", ".", "length", ">", "2", ")", "{", "short", "magic", "=", "(", "short", ")", "(", "(", "bytes", "[", "1", "]", "&", "0xFF", ")", "+", "(", "bytes", "[", "0", "]", "<", "<", "8", ")", ");", "@", "@", "-", "73", ",", "4", "+", "90", ",", "35", "@", "@", "static", "short", "getShort", "(", "byte", "[", "]", "b", ",", "int", "off", ")", "{", "}", "}", "private", "final", "static", "class", "CheckedInputStream", "extends", "ObjectInputStream", "{", "private", "final", "List", "<", "String", ">", "whitelist", ";", "public", "CheckedInputStream", "(", "InputStream", "in", ",", "List", "<", "String", ">", "whitelist", ")", "throws", "IOException", "{", "super", "(", "in", ")", ";", "this", ".", "whitelist", "=", "whitelist", ";", "}", "@", "Override", "protected", "Class", "<", "?>", "resolveClass", "(", "ObjectStreamClass", "desc", ")", "throws", "IOException", ",", "ClassNotFoundException", "{", "/", "/", "Enforce", "SerialKiller", "'", "s", "whitelist", "boolean", "safeClass", "=", "false", ";", "for", "(", "String", "whiteRegExp", ":", "whitelist", ")", "{", "Pattern", "whitePattern", "=", "Pattern", ".", "compile", "(", "whiteRegExp", ")", ";", "Matcher", "whiteMatcher", "=", "whitePattern", ".", "matcher", "(", "desc", ".", "getName", "(", "))", ";", "if", "(", "whiteMatcher", ".", "find", "(", "))", "{", "safeClass", "=", "true", ";", "if", "(", "log", ".", "isTraceEnabled", "(", "))", "log", ".", "tracef", "(", "\"", "Whitelist", "match", ":", "'", "%", "s", "'", "\",", "desc", ".", "getName", "(", "))", ";", "}", "}", "if", "(", "!", "safeClass", ")", "throw", "log", ".", "classNotInWhitelist", "(", "desc", ".", "getName", "(", "))", ";", "return", "super", ".", "resolveClass", "(", "desc", ")", ";", "}", "}", "}", "@", "@", "-", "15", ",", "6", "+", "15", ",", "7", "@", "@", "import", "static", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "ConfigurationProperties", ".", "REQUEST_BALANCING_STRATEGY", ";", "import", "static", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "ConfigurationProperties", ".", "SASL_MECHANISM", ";", "import", "static", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "ConfigurationProperties", ".", "SASL_PROPERTIES_PREFIX", ";", "import", "static", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "ConfigurationProperties", ".", "JAVA_SERIAL_WHITELIST", ";", "import", "static", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "ConfigurationProperties", ".", "SERVER_LIST", ";", "import", "static", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "ConfigurationProperties", ".", "SNI_HOST_NAME", ";", "import", "static", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "impl", ".", "ConfigurationProperties", ".", "SO_TIMEOUT", ";", "@", "@", "-", "35", ",", "7", "+", "36", ",", "10", "@", "@", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "security", ".", "NoSuchAlgorithmException", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Properties", ";", "import", "java", ".", "util", ".", "function", ".", "Function", ";", "@", "@", "-", "107", ",", "6", "+", "111", ",", "7", "@", "@", "OPTIONS", ".", "put", "(", "SASL_PROPERTIES_PREFIX", "+", "\"", ".", "A", "\"", ",", "c", "-", ">", "c", ".", "security", "(", ").", "authentication", "(", ").", "saslProperties", "(", ").", "get", "(", "\"", "A", "\"", "))", ";", "OPTIONS", ".", "put", "(", "SASL_PROPERTIES_PREFIX", "+", "\"", ".", "B", "\"", ",", "c", "-", ">", "c", ".", "security", "(", ").", "authentication", "(", ").", "saslProperties", "(", ").", "get", "(", "\"", "B", "\"", "))", ";", "OPTIONS", ".", "put", "(", "SASL_PROPERTIES_PREFIX", "+", "\"", ".", "C", "\"", ",", "c", "-", ">", "c", ".", "security", "(", ").", "authentication", "(", ").", "saslProperties", "(", ").", "get", "(", "\"", "C", "\"", "))", ";", "OPTIONS", ".", "put", "(", "JAVA_SERIAL_WHITELIST", ",", "Configuration", ":", ":", "serialWhitelist", ")", ";", "TYPES", ".", "put", "(", "Boolean", ".", "class", ",", "b", "-", ">", "Boolean", ".", "toString", "(", "(", "Boolean", ")", "b", ")", ");", "TYPES", ".", "put", "(", "ExhaustedAction", ".", "class", ",", "e", "-", ">", "Integer", ".", "toString", "(", "((", "ExhaustedAction", ")", "e", ")", ".", "ordinal", "(", "))", ");", "@", "@", "-", "118", ",", "6", "+", "123", ",", "15", "@", "@", "TYPES", ".", "put", "(", "MyCallbackHandler", ".", "class", ",", "c", "-", ">", "c", ")", ";", "TYPES", ".", "put", "(", "Subject", ".", "class", ",", "s", "-", ">", "s", ")", ";", "TYPES", ".", "put", "(", "ProtocolVersion", ".", "class", ",", "p", "-", ">", "p", ".", "toString", "(", "))", ";", "TYPES", ".", "put", "(", "mkClass", "(", "),", "l", "-", ">", "String", ".", "join", "(", "\",", "\",", "(", "List", "<", "String", ">", ")", "l", ")", ");", "}", "private", "static", "Class", "<", "?>", "mkClass", "(", ")", "{", "try", "{", "return", "Class", ".", "forName", "(", "\"", "java", ".", "util", ".", "Arrays", "$", "ArrayList", "\"", ");", "}", "catch", "(", "ClassNotFoundException", "e", ")", "{", "throw", "new", "RuntimeException", "(", "e", ")", ";", "}", "}", "CallbackHandler", "callbackHandler", "=", "new", "MyCallbackHandler", "(", ");", "@", "@", "-", "184", ",", "7", "+", "198", ",", "8", "@", "@", "public", "void", "testConfiguration", "(", ")", "{", ".", "callbackHandler", "(", "callbackHandler", ")", ".", "serverName", "(", "\"", "my", "-", "server", "-", "name", "\"", ")", ".", "clientSubject", "(", "clientSubject", ")", ".", "saslProperties", "(", "saslProperties", ")", ";", ".", "saslProperties", "(", "saslProperties", ")", ".", "addJavaSerialWhiteList", "(", "\".", "*", "Person", ".", "*\"", ",", "\"", ".*", "Employee", ".", "*\"", ");", "Configuration", "configuration", "=", "builder", ".", "build", "(", ");", "validateConfiguration", "(", "configuration", ")", ";", "@", "@", "-", "238", ",", "6", "+", "253", ",", "7", "@", "@", "public", "void", "testWithProperties", "(", ")", "{", "p", ".", "setProperty", "(", "SASL_PROPERTIES_PREFIX", "+", "\"", ".", "A", "\"", ",", "\"", "1", "\"", ");", "p", ".", "setProperty", "(", "SASL_PROPERTIES_PREFIX", "+", "\"", ".", "B", "\"", ",", "\"", "2", "\"", ");", "p", ".", "setProperty", "(", "SASL_PROPERTIES_PREFIX", "+", "\"", ".", "C", "\"", ",", "\"", "3", "\"", ");", "p", ".", "setProperty", "(", "JAVA_SERIAL_WHITELIST", ",", "\"", ".*", "Person", ".", "*,", ".*", "Employee", ".", "*\"", ");", "Configuration", "configuration", "=", "builder", ".", "withProperties", "(", "p", ")", ".", "build", "(", ");", "validateConfiguration", "(", "configuration", ")", ";", "@", "@", "-", "501", ",", "6", "+", "517", ",", "7", "@", "@", "private", "void", "validateConfiguration", "(", "Configuration", "configuration", ")", "{", "assertEqualsConfig", "(", "\"", "2", "\"", ",", "SASL_PROPERTIES_PREFIX", "+", "\"", ".", "B", "\"", ",", "configuration", ")", ";", "assertEqualsConfig", "(", "\"", "3", "\"", ",", "SASL_PROPERTIES_PREFIX", "+", "\"", ".", "C", "\"", ",", "configuration", ")", ";", "assertEqualsConfig", "(", "ProtocolVersion", ".", "PROTOCOL_VERSION_13", ",", "PROTOCOL_VERSION", ",", "configuration", ")", ";", "assertEqualsConfig", "(", "Arrays", ".", "asList", "(", "\".", "*", "Person", ".", "*\"", ",", "\"", ".*", "Employee", ".", "*\"", "),", "JAVA_SERIAL_WHITELIST", ",", "configuration", ")", ";", "}", "private", "void", "validateSSLContextConfiguration", "(", "Configuration", "configuration", ")", "{", "@", "@", "-", "45", ",", "7", "+", "45", ",", "7", "@", "@", "private", "ConfigurationBuilder", "getCacheConfiguration", "(", ")", "{", "List", "<", "Integer", ">", "finished", "=", "new", "ArrayList", "<", ">(", ");", "@", "Override", "public", "boolean", "track", "(", "byte", "[", "]", "key", ",", "short", "status", ")", "{", "public", "boolean", "track", "(", "byte", "[", "]", "key", ",", "short", "status", ",", "List", "<", "String", ">", "whitelist", ")", "{", "return", "true", ";", "}", "@", "@", "-", "5", ",", "6", "+", "5", ",", "7", "@", "@", "import", "static", "org", ".", "infinispan", ".", "test", ".", "TestingUtil", ".", "replaceField", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "java", ".", "util", ".", "stream", ".", "IntStream", ";", "@", "@", "-", "102", ",", "11", "+", "103", ",", "11", "@", "@", "protected", "int", "maxRetries", "(", ")", "{", "private", "final", "IOException", "failWith", "=", "new", "IOException", "(", "\"", "Connection", "reset", "by", "peer", "\"", ");", "@", "Override", "public", "ClientEvent", "readEvent", "(", "Transport", "transport", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ")", "{", "public", "ClientEvent", "readEvent", "(", "Transport", "transport", ",", "byte", "[", "]", "expectedListenerId", ",", "Marshaller", "marshaller", ",", "List", "<", "String", ">", "whitelist", ")", "{", "if", "(", "failure", ")", "{", "throw", "new", "TransportException", "(", "failWith", ",", "transport", ".", "getRemoteSocketAddress", "(", "))", ";", "}", "return", "super", ".", "readEvent", "(", "transport", ",", "expectedListenerId", ",", "marshaller", ")", ";", "return", "super", ".", "readEvent", "(", "transport", ",", "expectedListenerId", ",", "marshaller", ",", "whitelist", ")", ";", "}", "private", "void", "induceFailure", "(", ")", "{", "@", "@", "-", "6", ",", "7", "+", "6", ",", "7", "@", "@", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ClientIntelligence", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "configuration", ".", "ConfigurationBuilder", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "exceptions", ".", "HotRodClientException", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "exceptions", ".", "RemoteNodeSuspectException", ";", "import", "org", ".", "infinispan", ".", "client", ".", "hotrod", ".", "exceptions", ".", "TransportException", ";", "@", "@", "-", "80", ",", "7", "+", "80", ",", "7", "@", "@", "private", "void", "doRetryTest", "(", "int", "maxRetry", ",", "boolean", "failOnTransport", ")", "{", "private", "final", "boolean", "failOnTransport", ";", "public", "MockOperation", "(", "TransportFactory", "transportFactory", ",", "boolean", "failOnTransport", ")", "{", "super", "(", "null", ",", "transportFactory", ",", "null", ",", "null", ",", "0", ",", "ClientIntelligence", ".", "getDefault", "(", "))", ";", "super", "(", "null", ",", "transportFactory", ",", "null", ",", "null", ",", "0", ",", "new", "ConfigurationBuilder", "(", ").", "build", "(", "))", ";", "this", ".", "failOnTransport", "=", "failOnTransport", ";", "transportInvocationCount", "=", "new", "AtomicInteger", "(", "0", ")", ";", "executeInvocationCount", "=", "new", "AtomicInteger", "(", "0", ")", ";", "@", "@", "-", "184", ",", "6", "+", "184", ",", "7", "@", "@", "private", "void", "createHotRodCache", "(", "HotRodServer", "server", ")", "{", "hotrod", "=", "server", ";", "hotrodClient", "=", "new", "RemoteCacheManager", "(", "new", "ConfigurationBuilder", "(", ")", ".", "addServers", "(", "\"", "localhost", ":", "\"", "+", "hotrod", ".", "getPort", "(", "))", ".", "addJavaSerialWhiteList", "(", "\".", "*", "Person", ".", "*\"", ")", ".", "marshaller", "(", "marshaller", ")", ".", "build", "(", "))", ";", "hotrodCache", "=", "cacheName", ".", "isEmpty", "(", ")"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["cdc_ncm:", "do", "not", "call", "usbnet_link_change", "from", "cdc_ncm_bind", "usbnet_link_change", "will", "call", "schedule_work", "and", "should", "be", "avoided", "if", "bind", "is", "failing.", "Otherwise", "we", "will", "end", "up", "with", "scheduled", "work", "referring", "to", "a", "netdev", "which", "has", "gone", "away.", "Instead", "of", "making", "the", "call", "conditional,", "we", "can", "just", "defer", "it", "to", "usbnet_probe,", "using", "the", "driver_info", "flag", "made", "for", "this", "purpose.", "Fixes:", "8a34b0ae8778", "(\"usbnet:", "cdc_ncm:", "apply", "usbnet_link_change\")", "Reported-by:", "Andrey", "Konovalov", "<andreyknvl@gmail.com>", "Suggested-by:", "Linus", "Torvalds", "<torvalds@linux-foundation.org>", "Signed-off-by:", "Bj\u00f8rn", "Mork", "<bjorn@mork.no>", "Signed-off-by:", "David", "S.", "Miller", "<davem@davemloft.net>"], "code_tokens": ["@", "@", "-", "988", ",", "8", "+", "988", ",", "6", "@", "@", "EXPORT_SYMBOL_GPL", "(", "cdc_ncm_select_altsetting", ")", ";", "static", "int", "cdc_ncm_bind", "(", "struct", "usbnet", "*", "dev", ",", "struct", "usb_interface", "*", "intf", ")", "{", "int", "ret", ";", "/", "*", "MBIM", "backwards", "compatible", "function", "?", "*", "/", "if", "(", "cdc_ncm_select_altsetting", "(", "intf", ")", "!", "=", "CDC_NCM_COMM_ALTSETTING_NCM", ")", "return", "-", "ENODEV", ";", "@", "@", "-", "998", ",", "16", "+", "996", ",", "7", "@", "@", "static", "int", "cdc_ncm_bind", "(", "struct", "usbnet", "*", "dev", ",", "struct", "usb_interface", "*", "intf", ")", "*", "Additionally", ",", "generic", "NCM", "devices", "are", "assumed", "to", "accept", "arbitrarily", "*", "placed", "NDP", ".", "*", "/", "ret", "=", "cdc_ncm_bind_common", "(", "dev", ",", "intf", ",", "CDC_NCM_DATA_ALTSETTING_NCM", ",", "0", ")", ";", "/", "*", "*", "We", "should", "get", "an", "event", "when", "network", "connection", "is", "\"", "connected", "\"", "or", "*", "\"", "disconnected", "\"", ".", "Set", "network", "connection", "in", "\"", "disconnected", "\"", "state", "*", "(", "carrier", "is", "OFF", ")", "during", "attach", ",", "so", "the", "IP", "network", "stack", "does", "not", "*", "start", "IPv6", "negotiation", "and", "more", ".", "*", "/", "usbnet_link_change", "(", "dev", ",", "0", ",", "0", ")", ";", "return", "ret", ";", "return", "cdc_ncm_bind_common", "(", "dev", ",", "intf", ",", "CDC_NCM_DATA_ALTSETTING_NCM", ",", "0", ")", ";", "}", "static", "void", "cdc_ncm_align_tail", "(", "struct", "sk_buff", "*", "skb", ",", "size_t", "modulus", ",", "size_t", "remainder", ",", "size_t", "max", ")", "@", "@", "-", "1590", ",", "7", "+", "1579", ",", "8", "@", "@", "static", "void", "cdc_ncm_status", "(", "struct", "usbnet", "*", "dev", ",", "struct", "urb", "*", "urb", ")", "static", "const", "struct", "driver_info", "cdc_ncm_info", "=", "{", ".", "description", "=", "\"", "CDC", "NCM", "\"", ",", ".", "flags", "=", "FLAG_POINTTOPOINT", "|", "FLAG_NO_SETINT", "|", "FLAG_MULTI_PACKET", ",", ".", "flags", "=", "FLAG_POINTTOPOINT", "|", "FLAG_NO_SETINT", "|", "FLAG_MULTI_PACKET", "|", "FLAG_LINK_INTR", ",", ".", "bind", "=", "cdc_ncm_bind", ",", ".", "unbind", "=", "cdc_ncm_unbind", ",", ".", "manage_power", "=", "usbnet_manage_power", ",", "@", "@", "-", "1603", ",", "7", "+", "1593", ",", "7", "@", "@", "static", "const", "struct", "driver_info", "cdc_ncm_info", "=", "{", "static", "const", "struct", "driver_info", "wwan_info", "=", "{", ".", "description", "=", "\"", "Mobile", "Broadband", "Network", "Device", "\"", ",", ".", "flags", "=", "FLAG_POINTTOPOINT", "|", "FLAG_NO_SETINT", "|", "FLAG_MULTI_PACKET", "|", "FLAG_WWAN", ",", "|", "FLAG_LINK_INTR", "|", "FLAG_WWAN", ",", ".", "bind", "=", "cdc_ncm_bind", ",", ".", "unbind", "=", "cdc_ncm_unbind", ",", ".", "manage_power", "=", "usbnet_manage_power", ",", "@", "@", "-", "1616", ",", "7", "+", "1606", ",", "7", "@", "@", "static", "const", "struct", "driver_info", "wwan_info", "=", "{", "static", "const", "struct", "driver_info", "wwan_noarp_info", "=", "{", ".", "description", "=", "\"", "Mobile", "Broadband", "Network", "Device", "(", "NO", "ARP", ")", "\",", ".", "flags", "=", "FLAG_POINTTOPOINT", "|", "FLAG_NO_SETINT", "|", "FLAG_MULTI_PACKET", "|", "FLAG_WWAN", "|", "FLAG_NOARP", ",", "|", "FLAG_LINK_INTR", "|", "FLAG_WWAN", "|", "FLAG_NOARP", ",", ".", "bind", "=", "cdc_ncm_bind", ",", ".", "unbind", "=", "cdc_ncm_unbind", ",", ".", "manage_power", "=", "usbnet_manage_power", ","], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["KVM:", "VMX:", "Don't", "allow", "uninhibited", "access", "to", "EFER", "on", "i386", "vmx_set_msr()", "does", "not", "allow", "i386", "guests", "to", "touch", "EFER,", "but", "they", "can", "still", "do", "so", "through", "the", "default:", "label", "in", "the", "switch.", "If", "they", "set", "EFER_LME,", "they", "can", "oops", "the", "host.", "Fix", "by", "having", "EFER", "access", "through", "the", "normal", "channel", "(which", "will", "check", "for", "EFER_LME)", "even", "on", "i386.", "Reported-and-tested-by:", "Benjamin", "Gilbert", "<bgilbert@cs.cmu.edu>", "Cc:", "stable@kernel.org", "Signed-off-by:", "Avi", "Kivity", "<avi@redhat.com>"], "code_tokens": ["@", "@", "-", "936", ",", "11", "+", "936", ",", "11", "@", "@", "static", "int", "vmx_set_msr", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "u32", "msr_index", ",", "u64", "data", ")", "int", "ret", "=", "0", ";", "switch", "(", "msr_index", ")", "{", "#", "ifdef", "CONFIG_X86_64", "case", "MSR_EFER", ":", "vmx_load_host_state", "(", "vmx", ")", ";", "ret", "=", "kvm_set_msr_common", "(", "vcpu", ",", "msr_index", ",", "data", ")", ";", "break", ";", "#", "ifdef", "CONFIG_X86_64", "case", "MSR_FS_BASE", ":", "vmcs_writel", "(", "GUEST_FS_BASE", ",", "data", ")", ";", "break", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Improve", "processing", "of", "chuck", "size", "from", "chunked", "headers.", "Avoid", "overflow", "and", "use", "a", "bit", "shift", "instead", "of", "a", "multiplication", "as", "it", "is", "marginally", "faster.", "git-svn-id:", "https://svn.apache.org/repos/asf/tomcat/trunk@1578337", "13f79535-47bb-0310-9956-ffa450edef68"], "code_tokens": ["@", "@", "-", "319", ",", "7", "+", "319", ",", "7", "@", "@", "protected", "boolean", "parseChunkHeader", "(", ")", "int", "result", "=", "0", ";", "boolean", "eol", "=", "false", ";", "boolean", "readDigit", "=", "false", ";", "int", "readDigit", "=", "0", ";", "boolean", "extension", "=", "false", ";", "while", "(", "!", "eol", ")", "{", "@", "@", "-", "341", ",", "10", "+", "341", ",", "9", "@", "@", "protected", "boolean", "parseChunkHeader", "(", ")", "}", "else", "if", "(", "!", "extension", ")", "{", "/", "/", "don", "'", "t", "read", "data", "after", "the", "trailer", "int", "charValue", "=", "HexUtils", ".", "getDec", "(", "buf", "[", "pos", "]", ");", "if", "(", "charValue", "!", "=", "-", "1", ")", "{", "readDigit", "=", "true", ";", "result", "*", "=", "16", ";", "result", "+", "=", "charValue", ";", "if", "(", "charValue", "!", "=", "-", "1", "&", "&", "readDigit", "<", "8", ")", "{", "readDigit", "+", "+;", "result", "=", "(", "result", "<", "<", "4", ")", "|", "charValue", ";", "}", "else", "{", "/", "/", "we", "shouldn", "'", "t", "allow", "invalid", ",", "non", "hex", "characters", "/", "/", "in", "the", "chunked", "header", "@", "@", "-", "367", ",", "7", "+", "366", ",", "7", "@", "@", "protected", "boolean", "parseChunkHeader", "(", ")", "}", "if", "(", "!", "readDigit", ")", "if", "(", "readDigit", "=", "=", "0", "|", "|", "result", "<", "0", ")", "return", "false", ";", "if", "(", "result", "=", "=", "0", ")", "@", "@", "-", "105", ",", "7", "+", "105", ",", "7", "@", "@", "private", "void", "doTestChunkingCRLF", "(", "boolean", "chunkHeaderUsesCRLF", ",", "Context", "ctx", "=", "tomcat", ".", "addContext", "(", "\"\"", ",", "System", ".", "getProperty", "(", "\"", "java", ".", "io", ".", "tmpdir", "\"", "))", ";", "EchoHeaderServlet", "servlet", "=", "new", "EchoHeaderServlet", "(", ");", "EchoHeaderServlet", "servlet", "=", "new", "EchoHeaderServlet", "(", "expectPass", ")", ";", "Tomcat", ".", "addServlet", "(", "ctx", ",", "\"", "servlet", "\"", ",", "servlet", ")", ";", "ctx", ".", "addServletMapping", "(", "\"/", "\",", "\"", "servlet", "\"", ");", "@", "@", "-", "169", ",", "7", "+", "169", ",", "7", "@", "@", "public", "void", "testTrailingHeadersSizeLimit", "(", ")", "throws", "Exception", "{", "Context", "ctx", "=", "tomcat", ".", "addContext", "(", "\"\"", ",", "System", ".", "getProperty", "(", "\"", "java", ".", "io", ".", "tmpdir", "\"", "))", ";", "Tomcat", ".", "addServlet", "(", "ctx", ",", "\"", "servlet", "\"", ",", "new", "EchoHeaderServlet", "(", "))", ";", "Tomcat", ".", "addServlet", "(", "ctx", ",", "\"", "servlet", "\"", ",", "new", "EchoHeaderServlet", "(", "false", ")", ");", "ctx", ".", "addServletMapping", "(", "\"/", "\",", "\"", "servlet", "\"", ");", "/", "/", "Limit", "the", "size", "of", "the", "trailing", "header", "@", "@", "-", "233", ",", "7", "+", "233", ",", "7", "@", "@", "private", "void", "doTestExtensionSizeLimit", "(", "int", "len", ",", "boolean", "ok", ")", "throws", "Exception", "{", "Context", "ctx", "=", "tomcat", ".", "addContext", "(", "\"\"", ",", "System", ".", "getProperty", "(", "\"", "java", ".", "io", ".", "tmpdir", "\"", "))", ";", "Tomcat", ".", "addServlet", "(", "ctx", ",", "\"", "servlet", "\"", ",", "new", "EchoHeaderServlet", "(", "))", ";", "Tomcat", ".", "addServlet", "(", "ctx", ",", "\"", "servlet", "\"", ",", "new", "EchoHeaderServlet", "(", "ok", ")", ");", "ctx", ".", "addServletMapping", "(", "\"/", "\",", "\"", "servlet", "\"", ");", "tomcat", ".", "start", "(", ");", "@", "@", "-", "282", ",", "7", "+", "282", ",", "7", "@", "@", "public", "void", "testNoTrailingHeaders", "(", ")", "throws", "Exception", "{", "Context", "ctx", "=", "tomcat", ".", "addContext", "(", "\"\"", ",", "System", ".", "getProperty", "(", "\"", "java", ".", "io", ".", "tmpdir", "\"", "))", ";", "Tomcat", ".", "addServlet", "(", "ctx", ",", "\"", "servlet", "\"", ",", "new", "EchoHeaderServlet", "(", "))", ";", "Tomcat", ".", "addServlet", "(", "ctx", ",", "\"", "servlet", "\"", ",", "new", "EchoHeaderServlet", "(", "true", ")", ");", "ctx", ".", "addServletMapping", "(", "\"/", "\",", "\"", "servlet", "\"", ");", "tomcat", ".", "start", "(", ");", "@", "@", "-", "311", ",", "11", "+", "311", ",", "136", "@", "@", "public", "void", "testNoTrailingHeaders", "(", ")", "throws", "Exception", "{", "assertEquals", "(", "\"", "nullnull7nullnull", "\"", ",", "client", ".", "getResponseBody", "(", "))", ";", "}", "@", "Test", "public", "void", "testChunkSizeZero", "(", ")", "throws", "Exception", "{", "doTestChunkSize", "(", "true", ",", "true", ",", "\"", "\",", "10", ",", "0", ")", ";", "}", "@", "Test", "public", "void", "testChunkSizeAbsent", "(", ")", "throws", "Exception", "{", "doTestChunkSize", "(", "false", ",", "false", ",", "SimpleHttpClient", ".", "CRLF", ",", "10", ",", "0", ")", ";", "}", "@", "Test", "public", "void", "testChunkSizeTwentyFive", "(", ")", "throws", "Exception", "{", "doTestChunkSize", "(", "true", ",", "true", ",", "\"", "19", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+", "\"", "Hello", "World", "!", "Hello", "World", "!", "!\"", "+", "SimpleHttpClient", ".", "CRLF", ",", "40", ",", "25", ")", ";", "}", "@", "Test", "public", "void", "testChunkSizeEightDigit", "(", ")", "throws", "Exception", "{", "doTestChunkSize", "(", "true", ",", "true", ",", "\"", "0000000C", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+", "\"", "Hello", "World", "!", "\"", "+", "SimpleHttpClient", ".", "CRLF", ",", "20", ",", "12", ")", ";", "}", "@", "Test", "public", "void", "testChunkSizeNineDigit", "(", ")", "throws", "Exception", "{", "doTestChunkSize", "(", "false", ",", "false", ",", "\"", "00000000C", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+", "\"", "Hello", "World", "!", "\"", "+", "SimpleHttpClient", ".", "CRLF", ",", "20", ",", "12", ")", ";", "}", "@", "Test", "public", "void", "testChunkSizeLong", "(", ")", "throws", "Exception", "{", "doTestChunkSize", "(", "true", ",", "false", ",", "\"", "7fFFffFF", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+", "\"", "Hello", "World", "!", "\"", "+", "SimpleHttpClient", ".", "CRLF", ",", "10", ",", "10", ")", ";", "}", "@", "Test", "public", "void", "testChunkSizeIntegerMinValue", "(", ")", "throws", "Exception", "{", "doTestChunkSize", "(", "false", ",", "false", ",", "\"", "80000000", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+", "\"", "Hello", "World", "!", "\"", "+", "SimpleHttpClient", ".", "CRLF", ",", "10", ",", "10", ")", ";", "}", "@", "Test", "public", "void", "testChunkSizeMinusOne", "(", ")", "throws", "Exception", "{", "doTestChunkSize", "(", "false", ",", "false", ",", "\"", "ffffffff", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+", "\"", "Hello", "World", "!", "\"", "+", "SimpleHttpClient", ".", "CRLF", ",", "10", ",", "10", ")", ";", "}", "/", "**", "*", "@", "param", "expectPass", "*", "If", "the", "servlet", "is", "expected", "to", "process", "the", "request", "*", "@", "param", "expectReadWholeBody", "*", "If", "the", "servlet", "is", "expected", "to", "fully", "read", "the", "body", "and", "reliably", "*", "deliver", "a", "response", "*", "@", "param", "chunks", "*", "Text", "of", "chunks", "*", "@", "param", "readLimit", "*", "Do", "not", "read", "more", "than", "this", "many", "bytes", "*", "@", "param", "expectReadCount", "*", "Expected", "count", "of", "read", "bytes", "*", "@", "throws", "Exception", "*", "Unexpected", "*", "/", "private", "void", "doTestChunkSize", "(", "boolean", "expectPass", ",", "boolean", "expectReadWholeBody", ",", "String", "chunks", ",", "int", "readLimit", ",", "int", "expectReadCount", ")", "throws", "Exception", "{", "/", "/", "Setup", "Tomcat", "instance", "Tomcat", "tomcat", "=", "getTomcatInstance", "(", ");", "/", "/", "Must", "have", "a", "real", "docBase", "-", "just", "use", "temp", "Context", "ctx", "=", "tomcat", ".", "addContext", "(", "\"\"", ",", "System", ".", "getProperty", "(", "\"", "java", ".", "io", ".", "tmpdir", "\"", "))", ";", "BodyReadServlet", "servlet", "=", "new", "BodyReadServlet", "(", "expectPass", ",", "readLimit", ")", ";", "Tomcat", ".", "addServlet", "(", "ctx", ",", "\"", "servlet", "\"", ",", "servlet", ")", ";", "ctx", ".", "addServletMapping", "(", "\"/", "\",", "\"", "servlet", "\"", ");", "tomcat", ".", "start", "(", ");", "String", "request", "=", "\"", "POST", "/", "echo", "-", "params", ".", "jsp", "HTTP", "/", "1", ".", "1", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+", "\"", "Host", ":", "any", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+", "\"", "Transfer", "-", "encoding", ":", "chunked", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+", "\"", "Content", "-", "Type", ":", "text", "/", "plain", "\"", "+", "SimpleHttpClient", ".", "CRLF", ";", "if", "(", "expectPass", ")", "{", "request", "+", "=", "\"", "Connection", ":", "close", "\"", "+", "SimpleHttpClient", ".", "CRLF", ";", "}", "request", "+", "=", "SimpleHttpClient", ".", "CRLF", "+", "chunks", "+", "\"", "0", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+", "SimpleHttpClient", ".", "CRLF", ";", "TrailerClient", "client", "=", "new", "TrailerClient", "(", "tomcat", ".", "getConnector", "(", ")", ".", "getLocalPort", "(", "))", ";", "client", ".", "setRequest", "(", "new", "String", "[", "]", "{", "request", "}", ");", "Exception", "processException", "=", "null", ";", "client", ".", "connect", "(", ");", "try", "{", "client", ".", "processRequest", "(", ");", "}", "catch", "(", "Exception", "e", ")", "{", "/", "/", "Socket", "was", "probably", "closed", "before", "client", "had", "a", "chance", "to", "read", "/", "/", "response", "processException", "=", "e", ";", "}", "if", "(", "expectPass", ")", "{", "if", "(", "expectReadWholeBody", ")", "{", "assertNull", "(", "processException", ")", ";", "}", "if", "(", "processException", "=", "=", "null", ")", "{", "assertTrue", "(", "client", ".", "getResponseLine", "(", "),", "client", ".", "isResponse200", "(", "))", ";", "assertEquals", "(", "String", ".", "valueOf", "(", "expectReadCount", ")", ",", "client", ".", "getResponseBody", "(", "))", ";", "}", "assertEquals", "(", "expectReadCount", ",", "servlet", ".", "getCountRead", "(", "))", ";", "}", "else", "{", "if", "(", "processException", "=", "=", "null", ")", "{", "assertTrue", "(", "client", ".", "getResponseLine", "(", "),", "client", ".", "isResponse500", "(", "))", ";", "}", "assertEquals", "(", "0", ",", "servlet", ".", "getCountRead", "(", "))", ";", "assertTrue", "(", "servlet", ".", "getExceptionDuringRead", "(", "))", ";", "}", "}", "private", "static", "class", "EchoHeaderServlet", "extends", "HttpServlet", "{", "private", "static", "final", "long", "serialVersionUID", "=", "1L", ";", "private", "boolean", "exceptionDuringRead", "=", "false", ";", "private", "final", "boolean", "expectPass", ";", "public", "EchoHeaderServlet", "(", "boolean", "expectPass", ")", "{", "this", ".", "expectPass", "=", "expectPass", ";", "}", "@", "Override", "protected", "void", "doPost", "(", "HttpServletRequest", "req", ",", "HttpServletResponse", "resp", ")", "throws", "ServletException", ",", "IOException", "{", "@", "@", "-", "334", ",", "6", "+", "459", ",", "11", "@", "@", "protected", "void", "doPost", "(", "HttpServletRequest", "req", ",", "HttpServletResponse", "resp", ")", "}", "}", "catch", "(", "IOException", "ioe", ")", "{", "exceptionDuringRead", "=", "true", ";", "if", "(", "!", "expectPass", ")", "{", "/", "/", "as", "expected", "log", "(", "ioe", ".", "toString", "(", "))", ";", "resp", ".", "sendError", "(", "HttpServletResponse", ".", "SC_INTERNAL_SERVER_ERROR", ")", ";", "return", ";", "}", "throw", "ioe", ";", "}", "@", "@", "-", "358", ",", "6", "+", "488", ",", "53", "@", "@", "private", "void", "dumpHeader", "(", "String", "headerName", ",", "HttpServletRequest", "req", ",", "}", "}", "private", "static", "class", "BodyReadServlet", "extends", "HttpServlet", "{", "private", "static", "final", "long", "serialVersionUID", "=", "1L", ";", "private", "boolean", "exceptionDuringRead", "=", "false", ";", "private", "int", "countRead", "=", "0", ";", "private", "final", "boolean", "expectPass", ";", "private", "final", "int", "readLimit", ";", "public", "BodyReadServlet", "(", "boolean", "expectPass", ",", "int", "readLimit", ")", "{", "this", ".", "expectPass", "=", "expectPass", ";", "this", ".", "readLimit", "=", "readLimit", ";", "}", "@", "Override", "protected", "void", "doPost", "(", "HttpServletRequest", "req", ",", "HttpServletResponse", "resp", ")", "throws", "ServletException", ",", "IOException", "{", "resp", ".", "setContentType", "(", "\"", "text", "/", "plain", "\"", ");", "PrintWriter", "pw", "=", "resp", ".", "getWriter", "(", ");", "/", "/", "Read", "the", "body", "-", "quick", "and", "dirty", "InputStream", "is", "=", "req", ".", "getInputStream", "(", ");", "try", "{", "while", "(", "is", ".", "read", "(", ")", ">", "-", "1", "&", "&", "countRead", "<", "readLimit", ")", "{", "countRead", "+", "+;", "}", "}", "catch", "(", "IOException", "ioe", ")", "{", "exceptionDuringRead", "=", "true", ";", "if", "(", "!", "expectPass", ")", "{", "/", "/", "as", "expected", "log", "(", "ioe", ".", "toString", "(", "))", ";", "resp", ".", "sendError", "(", "HttpServletResponse", ".", "SC_INTERNAL_SERVER_ERROR", ")", ";", "return", ";", "}", "throw", "ioe", ";", "}", "pw", ".", "write", "(", "Integer", ".", "valueOf", "(", "countRead", ")", ".", "toString", "(", "))", ";", "}", "public", "boolean", "getExceptionDuringRead", "(", ")", "{", "return", "exceptionDuringRead", ";", "}", "public", "int", "getCountRead", "(", ")", "{", "return", "countRead", ";", "}", "}", "private", "static", "class", "TrailerClient", "extends", "SimpleHttpClient", "{", "public", "TrailerClient", "(", "int", "port", ")", "{", "@", "@", "-", "149", ",", "6", "+", "149", ",", "11", "@", "@", "Add", "experimental", "NIO2", "connector", ".", "Based", "on", "code", "developed", "by", "Nabil", "Benothman", ".", "(", "remm", ")", "<", "/", "add", ">", "<", "fix", ">", "Improve", "processing", "of", "chuck", "size", "from", "chunked", "headers", ".", "Avoid", "overflow", "and", "use", "a", "bit", "shift", "instead", "of", "a", "multiplication", "as", "it", "is", "marginally", "faster", ".", "(", "markt", "/", "kkolinko", ")", "<", "/", "fix", ">", "<", "/", "changelog", ">", "<", "/", "subsection", ">", "<", "subsection", "name", "=", "\"", "Jasper", "\"", ">"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["avcodec/iff:", "Reorder", "checks", "to", "avoid", "unnecessary", "alloc+free", "Signed-off-by:", "Andreas", "Rheinhardt", "<andreas.rheinhardt@gmail.com>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["[fix]", "Fixes", "relative", "path", "resolving", "#199", "#200", "(#201)", "*", "[fix]", "Fixes", "relative", "path", "resolving", "#199", "#200", "*", "[test]", "Additional", "extractProtocol", "tests"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Update", "NEWS", "for", "#77120"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["tools/target_dec_fuzzer:", "Adjust", "threshold", "for", "H264", "Fixes:", "Timeout", "(too", "long", "->", "3sec)", "Fixes:", "28047/clusterfuzz-testcase-minimized-ffmpeg_AV_CODEC_ID_H264_fuzzer-4662727980875776", "Found-by:", "continuous", "fuzzing", "process", "https://github.com/google/oss-fuzz/tree/master/projects/ffmpeg", "Signed-off-by:", "Michael", "Niedermayer", "<michael@niedermayer.cc>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["avformat/rtpdec:", "use", "av_packet_alloc()", "to", "allocate", "packets", "Signed-off-by:", "James", "Almer", "<jamrial@gmail.com>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["[FIXED", "SECURITY-281]", "MasterComputer.doConfigDotXml", "should", "be", "rejected."], "code_tokens": ["@", "@", "-", "298", ",", "6", "+", "298", ",", "7", "@", "@", "import", "hudson", ".", "util", ".", "LogTaskListener", ";", "import", "static", "java", ".", "util", ".", "logging", ".", "Level", ".", "*;", "import", "static", "javax", ".", "servlet", ".", "http", ".", "HttpServletResponse", ".", "*;", "import", "org", ".", "kohsuke", ".", "stapler", ".", "WebMethod", ";", "/", "**", "*", "Root", "object", "of", "the", "system", ".", "@", "@", "-", "3996", ",", "6", "+", "3997", ",", "12", "@", "@", "public", "void", "doConfigSubmit", "(", "StaplerRequest", "req", ",", "StaplerResponse", "rsp", ")", "throws", "IOExc", "Jenkins", ".", "getInstance", "(", ").", "doConfigExecutorsSubmit", "(", "req", ",", "rsp", ")", ";", "}", "@", "WebMethod", "(", "name", "=", "\"", "config", ".", "xml", "\"", ")", "@", "Override", "public", "void", "doConfigDotXml", "(", "StaplerRequest", "req", ",", "StaplerResponse", "rsp", ")", "throws", "IOException", ",", "ServletException", "{", "throw", "HttpResponses", ".", "status", "(", "SC_BAD_REQUEST", ")", ";", "}", "@", "Override", "public", "boolean", "hasPermission", "(", "Permission", "permission", ")", "{", "/", "/", "no", "one", "should", "be", "allowed", "to", "delete", "the", "master", ".", "@", "@", "-", "23", ",", "6", "+", "23", ",", "10", "@", "@", "*", "/", "package", "hudson", ".", "model", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "FailingHttpStatusCodeException", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "HttpMethod", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "Page", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "WebRequestSettings", ";", "import", "hudson", ".", "EnvVars", ";", "import", "hudson", ".", "FilePath", ";", "import", "hudson", ".", "maven", ".", "MavenModuleSet", ";", "@", "@", "-", "41", ",", "6", "+", "45", ",", "7", "@", "@", "import", "hudson", ".", "slaves", ".", "OfflineCause", ".", "ByCLI", ";", "import", "hudson", ".", "slaves", ".", "OfflineCause", ".", "UserCause", ";", "import", "hudson", ".", "util", ".", "TagCloud", ";", "import", "java", ".", "net", ".", "HttpURLConnection", ";", "import", "java", ".", "util", ".", "*;", "import", "java", ".", "util", ".", "concurrent", ".", "Callable", ";", "@", "@", "-", "400", ",", "6", "+", "405", ",", "22", "@", "@", "public", "void", "testGetAssignedLabelWithSpaceOnly", "(", ")", "throws", "Exception", "{", "assertThatCloudLabelDoesNotContain", "(", "cloud", ",", "\"", "label1", "label2", "\"", ",", "0", ")", ";", "}", "@", "Issue", "(", "\"", "SECURITY", "-", "281", "\"", ")", "@", "Test", "public", "void", "masterComputerConfigDotXml", "(", ")", "throws", "Exception", "{", "JenkinsRule", ".", "WebClient", "wc", "=", "j", ".", "createWebClient", "(", ");", "wc", ".", "assertFails", "(", "\"", "computer", "/", "(", "master", ")", "/", "config", ".", "xml", "\"", ",", "HttpURLConnection", ".", "HTTP_BAD_REQUEST", ")", ";", "WebRequestSettings", "settings", "=", "new", "WebRequestSettings", "(", "wc", ".", "createCrumbedUrl", "(", "\"", "computer", "/", "(", "master", ")", "/", "config", ".", "xml", "\"", "))", ";", "settings", ".", "setHttpMethod", "(", "HttpMethod", ".", "POST", ")", ";", "settings", ".", "setRequestBody", "(", "\"<", "hudson", "/", ">\"", ");", "try", "{", "Page", "page", "=", "wc", ".", "getPage", "(", "settings", ")", ";", "fail", "(", "page", ".", "getWebResponse", "(", ").", "getContentAsString", "(", "))", ";", "}", "catch", "(", "FailingHttpStatusCodeException", "x", ")", "{", "assertEquals", "(", "HttpURLConnection", ".", "HTTP_BAD_REQUEST", ",", "x", ".", "getStatusCode", "(", "))", ";", "}", "}", "/", "**", "*", "Assert", "that", "a", "tag", "cloud", "contains", "label", "name", "and", "weight", ".", "*", "/"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Migration", "to", "big", "int"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["x86/tx_float:", "remove", "ff_", "prefix", "from", "external", "constant", "tables", "Fixes", "compilation", "with", "some", "assemblers.", "Reviewed-by:", "Lynne", "Signed-off-by:", "James", "Almer", "<jamrial@gmail.com>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Fix", "#2688"], "code_tokens": ["@", "@", "-", "4", ",", "6", "+", "4", ",", "11", "@", "@", "Project", ":", "jackson", "-", "databind", "=", "==", "Releases", "=", "==", "2", ".", "9", ".", "10", ".", "5", "(", "not", "yet", "released", ")", "#", "2688", ":", "Block", "one", "more", "gadget", "type", "(", "apache", "-", "drill", ")", "(", "reported", "by", "Topsec", "(", "tcc", ")", ")", "2", ".", "9", ".", "10", ".", "4", "(", "11", "-", "Apr", "-", "2020", ")", "#", "2631", ":", "Block", "one", "more", "gadget", "type", "(", "shaded", "-", "hikari", "-", "config", ",", "CVE", "-", "2020", "-", "9546", ")", "@", "@", "-", "180", ",", "6", "+", "180", ",", "9", "@", "@", "/", "/", "[", "databind", "#", "2682", "]", ":", "commons", "-", "jelly", "s", ".", "add", "(", "\"", "org", ".", "apache", ".", "commons", ".", "jelly", ".", "impl", ".", "Embedded", "\"", ");", "/", "/", "[", "databind", "#", "2688", "]", ":", "apache", "/", "drill", "s", ".", "add", "(", "\"", "oadd", ".", "org", ".", "apache", ".", "xalan", ".", "lib", ".", "sql", ".", "JNDIConnectionPool", "\"", ");", "DEFAULT_NO_DESER_CLASS_NAMES", "=", "Collections", ".", "unmodifiableSet", "(", "s", ")", ";", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["AMQ-6871", "-", "By", "default", "only", "send", "generic", "platform", "details", "The", "default", "behavior", "by", "the", "OpenWire", "client", "will", "be", "to", "send", "generic", "platform", "details", "to", "the", "server", "with", "a", "new", "flag", "to", "send", "more", "specific", "information.", "(cherry", "picked", "from", "commit", "5fa0bbd5156f29d97dcf48fd9fdb6a0488a8df1a)"], "code_tokens": ["@", "@", "-", "33", ",", "6", "+", "33", ",", "7", "@", "@", "public", "static", "final", "int", "PROVIDER_MAJOR_VERSION", ";", "public", "static", "final", "int", "PROVIDER_MINOR_VERSION", ";", "public", "static", "final", "String", "PROVIDER_NAME", "=", "\"", "ActiveMQ", "\"", ";", "public", "static", "final", "String", "DEFAULT_PLATFORM_DETAILS", "=", "\"", "Java", "\"", ";", "public", "static", "final", "String", "PLATFORM_DETAILS", ";", "public", "static", "final", "ActiveMQConnectionMetaData", "INSTANCE", "=", "new", "ActiveMQConnectionMetaData", "(", ");", "@", "@", "-", "22", ",", "7", "+", "22", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "activemq", ".", "wireformat", ".", "WireFormatFactory", ";", "/", "**", "*", "*", "*", "/", "public", "class", "OpenWireFormatFactory", "implements", "WireFormatFactory", "{", "@", "@", "-", "44", ",", "8", "+", "44", ",", "10", "@", "@", "private", "String", "host", "=", "null", ";", "private", "String", "providerName", "=", "ActiveMQConnectionMetaData", ".", "PROVIDER_NAME", ";", "private", "String", "providerVersion", "=", "ActiveMQConnectionMetaData", ".", "PROVIDER_VERSION", ";", "private", "String", "platformDetails", "=", "ActiveMQConnectionMetaData", ".", "PLATFORM_DETAILS", ";", "private", "String", "platformDetails", "=", "ActiveMQConnectionMetaData", ".", "DEFAULT_PLATFORM_DETAILS", ";", "private", "boolean", "includePlatformDetails", "=", "false", ";", "@", "Override", "public", "WireFormat", "createWireFormat", "(", ")", "{", "WireFormatInfo", "info", "=", "new", "WireFormatInfo", "(", ");", "info", ".", "setVersion", "(", "version", ")", ";", "@", "@", "-", "65", ",", "6", "+", "67", ",", "9", "@", "@", "public", "WireFormat", "createWireFormat", "(", ")", "{", "}", "info", ".", "setProviderName", "(", "providerName", ")", ";", "info", ".", "setProviderVersion", "(", "providerVersion", ")", ";", "if", "(", "includePlatformDetails", ")", "{", "platformDetails", "=", "ActiveMQConnectionMetaData", ".", "PLATFORM_DETAILS", ";", "}", "info", ".", "setPlatformDetails", "(", "platformDetails", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "IllegalStateException", "ise", "=", "new", "IllegalStateException", "(", "\"", "Could", "not", "configure", "WireFormatInfo", "\"", ");", "@", "@", "-", "190", ",", "4", "+", "195", ",", "12", "@", "@", "public", "String", "getPlatformDetails", "(", ")", "{", "public", "void", "setPlatformDetails", "(", "String", "platformDetails", ")", "{", "this", ".", "platformDetails", "=", "platformDetails", ";", "}", "public", "boolean", "isIncludePlatformDetails", "(", ")", "{", "return", "includePlatformDetails", ";", "}", "public", "void", "setIncludePlatformDetails", "(", "boolean", "includePlatformDetails", ")", "{", "this", ".", "includePlatformDetails", "=", "includePlatformDetails", ";", "}", "}", "@", "@", "-", "25", ",", "15", "+", "25", ",", "15", "@", "@", "import", "java", ".", "io", ".", "DataOutputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "net", ".", "URI", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicReference", ";", "import", "org", ".", "apache", ".", "activemq", ".", "ActiveMQConnection", ";", "import", "org", ".", "apache", ".", "activemq", ".", "ActiveMQConnectionFactory", ";", "import", "org", ".", "apache", ".", "activemq", ".", "ActiveMQConnectionMetaData", ";", "import", "org", ".", "apache", ".", "activemq", ".", "broker", ".", "BrokerService", ";", "import", "org", ".", "apache", ".", "activemq", ".", "broker", ".", "TransportConnector", ";", "import", "org", ".", "apache", ".", "activemq", ".", "command", ".", "WireFormatInfo", ";", "import", "org", ".", "apache", ".", "activemq", ".", "transport", ".", "DefaultTransportListener", ";", "import", "org", ".", "junit", ".", "After", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "@", "@", "-", "42", ",", "36", "+", "42", ",", "60", "@", "@", "static", "final", "Logger", "LOG", "=", "LoggerFactory", ".", "getLogger", "(", "WireFormatInfoPropertiesTest", ".", "class", ")", ";", "protected", "BrokerService", "master", ";", "protected", "String", "brokerUri", ";", "private", "BrokerService", "service", ";", "private", "String", "brokerUri", ";", "private", "TransportConnector", "connector", ";", "@", "Before", "public", "void", "before", "(", ")", "throws", "Exception", "{", "service", "=", "new", "BrokerService", "(", ");", "connector", "=", "service", ".", "addConnector", "(", "\"", "tcp", ":", "//", "localhost", ":", "0", "\"", ");", "brokerUri", "=", "connector", ".", "getPublishableConnectString", "(", ");", "service", ".", "setPersistent", "(", "false", ")", ";", "service", ".", "setUseJmx", "(", "false", ")", ";", "service", ".", "setBrokerName", "(", "\"", "Master", "\"", ");", "service", ".", "start", "(", ");", "service", ".", "waitUntilStarted", "(", ");", "}", "@", "After", "public", "void", "after", "(", ")", "throws", "Exception", "{", "if", "(", "service", "!", "=", "null", ")", "{", "service", ".", "stop", "(", ");", "service", ".", "waitUntilStopped", "(", ");", "}", "}", "@", "Test", "public", "void", "testClientProperties", "(", ")", "throws", "Exception", "{", "BrokerService", "service", "=", "createBrokerService", "(", ");", "try", "{", "ActiveMQConnectionFactory", "factory", "=", "new", "ActiveMQConnectionFactory", "(", "new", "URI", "(", "brokerUri", ")", ");", "ActiveMQConnection", "conn", "=", "(", "ActiveMQConnection", ")", "factory", ".", "createConnection", "(", ");", "final", "AtomicReference", "<", "WireFormatInfo", ">", "clientWf", "=", "new", "AtomicReference", "<", "WireFormatInfo", ">", "()", ";", "conn", ".", "addTransportListener", "(", "new", "DefaultTransportListener", "(", ")", "{", "@", "Override", "public", "void", "onCommand", "(", "Object", "command", ")", "{", "if", "(", "command", "instanceof", "WireFormatInfo", ")", "{", "clientWf", ".", "set", "(", "(", "WireFormatInfo", ")", "command", ")", ";", "}", "}", "}", ");", "conn", ".", "start", "(", ");", "if", "(", "clientWf", ".", "get", "(", ")", "=", "=", "null", ")", "{", "fail", "(", "\"", "Wire", "format", "info", "is", "null", "\"", ");", "}", "assertTrue", "(", "clientWf", ".", "get", "(", ").", "getProperties", "(", ").", "containsKey", "(", "\"", "ProviderName", "\"", "))", ";", "assertTrue", "(", "clientWf", ".", "get", "(", ").", "getProperties", "(", ").", "containsKey", "(", "\"", "ProviderVersion", "\"", "))", ";", "assertTrue", "(", "clientWf", ".", "get", "(", ").", "getProperties", "(", ").", "containsKey", "(", "\"", "PlatformDetails", "\"", "))", ";", "assertTrue", "(", "clientWf", ".", "get", "(", ").", "getProviderName", "(", ").", "equals", "(", "ActiveMQConnectionMetaData", ".", "PROVIDER_NAME", ")", ");", "assertTrue", "(", "clientWf", ".", "get", "(", ").", "getPlatformDetails", "(", ").", "equals", "(", "ActiveMQConnectionMetaData", ".", "PLATFORM_DETAILS", ")", ");", "}", "finally", "{", "stopBroker", "(", "service", ")", ";", "public", "void", "testClientPropertiesWithDefaultPlatformDetails", "(", ")", "throws", "Exception", "{", "WireFormatInfo", "clientWf", "=", "testClientProperties", "(", "brokerUri", ")", ";", "assertTrue", "(", "clientWf", ".", "getPlatformDetails", "(", ").", "equals", "(", "ActiveMQConnectionMetaData", ".", "DEFAULT_PLATFORM_DETAILS", ")", ");", "}", "@", "Test", "public", "void", "testClientPropertiesWithPlatformDetails", "(", ")", "throws", "Exception", "{", "WireFormatInfo", "clientWf", "=", "testClientProperties", "(", "brokerUri", "+", "\"", "?", "wireFormat", ".", "includePlatformDetails", "=", "true", "\"", ");", "assertTrue", "(", "clientWf", ".", "getPlatformDetails", "(", ").", "equals", "(", "ActiveMQConnectionMetaData", ".", "PLATFORM_DETAILS", ")", ");", "}", "private", "WireFormatInfo", "testClientProperties", "(", "String", "brokerUri", ")", "throws", "Exception", "{", "ActiveMQConnectionFactory", "factory", "=", "new", "ActiveMQConnectionFactory", "(", "new", "URI", "(", "brokerUri", ")", ");", "ActiveMQConnection", "conn", "=", "(", "ActiveMQConnection", ")", "factory", ".", "createConnection", "(", ");", "conn", ".", "start", "(", ");", "assertTrue", "(", "connector", ".", "getConnections", "(", ").", "size", "(", ")", "=", "=", "1", ")", ";", "final", "WireFormatInfo", "clientWf", "=", "connector", ".", "getConnections", "(", ").", "get", "(", "0", ")", ".", "getRemoteWireFormatInfo", "(", ");", "if", "(", "clientWf", "=", "=", "null", ")", "{", "fail", "(", "\"", "Wire", "format", "info", "is", "null", "\"", ");", "}", "/", "/", "verify", "properties", "that", "the", "client", "sends", "to", "the", "broker", "assertTrue", "(", "clientWf", ".", "getProperties", "(", ").", "containsKey", "(", "\"", "ProviderName", "\"", "))", ";", "assertTrue", "(", "clientWf", ".", "getProperties", "(", ").", "containsKey", "(", "\"", "ProviderVersion", "\"", "))", ";", "assertTrue", "(", "clientWf", ".", "getProperties", "(", ").", "containsKey", "(", "\"", "PlatformDetails", "\"", "))", ";", "assertTrue", "(", "clientWf", ".", "getProviderName", "(", ").", "equals", "(", "ActiveMQConnectionMetaData", ".", "PROVIDER_NAME", ")", ");", "return", "clientWf", ";", "}", "@", "Test", "@", "@", "-", "100", ",", "23", "+", "124", ",", "4", "@", "@", "public", "void", "testMarshalClientProperties", "(", ")", "throws", "IOException", "{", "assertTrue", "(", "result", ".", "getPlatformDetails", "(", ").", "equals", "(", "orig", ".", "getPlatformDetails", "(", "))", ");", "}", "private", "BrokerService", "createBrokerService", "(", ")", "throws", "Exception", "{", "BrokerService", "service", "=", "new", "BrokerService", "(", ");", "TransportConnector", "connector", "=", "service", ".", "addConnector", "(", "\"", "tcp", ":", "//", "localhost", ":", "0", "\"", ");", "brokerUri", "=", "connector", ".", "getPublishableConnectString", "(", ");", "service", ".", "setPersistent", "(", "false", ")", ";", "service", ".", "setUseJmx", "(", "false", ")", ";", "service", ".", "setBrokerName", "(", "\"", "Master", "\"", ");", "service", ".", "start", "(", ");", "service", ".", "waitUntilStarted", "(", ");", "return", "service", ";", "}", "private", "void", "stopBroker", "(", "BrokerService", "service", ")", "throws", "Exception", "{", "if", "(", "service", "!", "=", "null", ")", "{", "service", ".", "stop", "(", ");", "service", ".", "waitUntilStopped", "(", ");", "}", "}", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["#866", "Block", "inline", "edit", "minor", "enhancements:", "no", "header", "blocks", "and", "plain", "blocks", "handled", "correctly", "now.", "Basic", "phrase", "inline", "edit", "functionality"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Fix", "bug", "#67328", "(fileinfo:", "numerous", "file_printf", "calls", "resulting", "in", "performance", "degradation)", "Upstream", "patch:", "https://github.com/file/file/commit/b8acc83781d5a24cc5101e525d15efe0482c280d"], "code_tokens": ["@", "@", "-", "32", ",", "7", "+", "32", ",", "8", "@", "@", "PHP", "NEWS", "-", "Fileinfo", ":", ".", "Fixed", "bug", "#", "67327", "(", "fileinfo", ":", "CDF", "infinite", "loop", "in", "nelements", "DoS", ")", ".", "(", "CVE", "-", "2014", "-", "0238", ")", ".", ".", "Fixed", "bug", "#", "67328", "(", "fileinfo", ":", "fileinfo", ":", "numerous", "file_printf", "calls", "resulting", "in", "performance", "degradation", ")", ".", "-", "FPM", ":", ".", "Fixed", "bug", "#", "66908", "(", "php", "-", "fpm", "reload", "leaks", "epoll_create", "(", ")", "file", "descriptor", ")", ".", "@", "@", "-", "948", ",", "7", "+", "948", ",", "7", "@", "@", "int", "cdf_unpack_summary_info", "(", "const", "cdf_stream_t", "*", "sst", ",", "const", "cdf_header_t", "*", "h", ",", "cdf_summary_info_header_t", "*", "ssi", ",", "cdf_property_info_t", "*", "*", "info", ",", "size_t", "*", "count", ")", "{", "size_t", "i", ",", "maxcount", ";", "size_t", "maxcount", ";", "const", "cdf_summary_info_header_t", "*", "si", "=", "CAST", "(", "const", "cdf_summary_info_header_t", "*", ",", "sst", "-", ">", "sst_tab", ")", ";", "const", "cdf_section_declaration_t", "*", "sd", "=", "@", "@", "-", "963", ",", "21", "+", "963", ",", "13", "@", "@", "cdf_unpack_summary_info", "(", "const", "cdf_stream_t", "*", "sst", ",", "const", "cdf_header_t", "*", "h", ",", "ssi", "-", ">", "si_os", "=", "CDF_TOLE2", "(", "si", "-", ">", "si_os", ")", ";", "ssi", "-", ">", "si_class", "=", "si", "-", ">", "si_class", ";", "cdf_swap_class", "(", "&", "ssi", "-", ">", "si_class", ")", ";", "ssi", "-", ">", "si_count", "=", "CDF_TOLE2", "(", "si", "-", ">", "si_count", ")", ";", "ssi", "-", ">", "si_count", "=", "CDF_TOLE4", "(", "si", "-", ">", "si_count", ")", ";", "*", "count", "=", "0", ";", "maxcount", "=", "0", ";", "*", "info", "=", "NULL", ";", "for", "(", "i", "=", "0", ";", "i", "<", "CDF_TOLE4", "(", "si", "-", ">", "si_count", ")", ";", "i", "+", "+)", "{", "if", "(", "i", ">", "=", "CDF_LOOP_LIMIT", ")", "{", "DPRINTF", "(", "(\"", "Unpack", "summary", "info", "loop", "limit", "\"", "))", ";", "errno", "=", "EFTYPE", ";", "return", "-", "1", ";", "}", "if", "(", "cdf_read_property_info", "(", "sst", ",", "h", ",", "CDF_TOLE4", "(", "sd", "-", ">", "sd_offset", ")", ",", "info", ",", "count", ",", "&", "maxcount", ")", "=", "=", "-", "1", ")", "{", "if", "(", "cdf_read_property_info", "(", "sst", ",", "h", ",", "CDF_TOLE4", "(", "sd", "-", ">", "sd_offset", ")", ",", "info", ",", "count", ",", "&", "maxcount", ")", "=", "=", "-", "1", ")", "return", "-", "1", ";", "}", "}", "return", "0", ";", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["fix(route):", "enhance", "route", "sspai", "(#7792)"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Update", "Fox", "e-mail", "address", "in", "copyright", "notices", "Replace", "openvpn@fox-it.com", "with", "openvpn@foxcrypto.com.", "Signed-off-by:", "Max", "Fillinger", "<maximilian.fillinger@foxcrypto.com>", "Acked-by:", "Gert", "Doering", "<gert@greenie.muc.de>", "Message-Id:", "<20210701171458.8897-1-maximilian.fillinger@foxcrypto.com>", "URL:", "https://www.mail-archive.com/openvpn-devel@lists.sourceforge.net/msg22608.html", "Signed-off-by:", "Gert", "Doering", "<gert@greenie.muc.de>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["vhost:", "fix", "length", "for", "cross", "region", "descriptor", "If", "a", "single", "descriptor", "crosses", "a", "region,", "the", "second", "chunk", "length", "should", "be", "decremented", "by", "size", "translated", "so", "far,", "instead", "it", "includes", "the", "full", "descriptor", "length.", "Signed-off-by:", "Michael", "S.", "Tsirkin", "<mst@redhat.com>", "Acked-by:", "Jason", "Wang", "<jasowang@redhat.com>", "Signed-off-by:", "David", "S.", "Miller", "<davem@davemloft.net>"], "code_tokens": ["@", "@", "-", "1076", ",", "7", "+", "1076", ",", "7", "@", "@", "static", "int", "translate_desc", "(", "struct", "vhost_dev", "*", "dev", ",", "u64", "addr", ",", "u32", "len", ",", "}", "_iov", "=", "iov", "+", "ret", ";", "size", "=", "reg", "-", ">", "memory_size", "-", "addr", "+", "reg", "-", ">", "guest_phys_addr", ";", "_iov", "-", ">", "iov_len", "=", "min", "(", "(", "u64", ")", "len", ",", "size", ")", ";", "_iov", "-", ">", "iov_len", "=", "min", "(", "(", "u64", ")", "len", "-", "s", ",", "size", ")", ";", "_iov", "-", ">", "iov_base", "=", "(", "void", "__user", "*", ")(", "unsigned", "long", ")", "(", "reg", "-", ">", "userspace_addr", "+", "addr", "-", "reg", "-", ">", "guest_phys_addr", ")", ";", "s", "+", "=", "size", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["CAMEL-10894:", "Improve", "test", "fix"], "code_tokens": ["@", "@", "-", "173", ",", "7", "+", "173", ",", "7", "@", "@", "protected", "SchemaFactory", "createSchemaFactory", "(", ")", "{", "if", "(", "getResourceResolver", "(", ")", "!", "=", "null", ")", "{", "factory", ".", "setResourceResolver", "(", "getResourceResolver", "(", "))", ";", "}", "if", "(", "camelContext", "!", "=", "null", "&", "&", "!", "Boolean", ".", "parseBoolean", "(", "camelContext", ".", "getGlobalOptions", "(", ").", "get", "(", "ACCESS_EXTERNAL_DTD", ")", "))", "{", "if", "(", "camelContext", "=", "=", "null", "|", "|", "!", "Boolean", ".", "parseBoolean", "(", "camelContext", ".", "getGlobalOptions", "(", ").", "get", "(", "ACCESS_EXTERNAL_DTD", ")", "))", "{", "try", "{", "factory", ".", "setProperty", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_DTD", ",", "\"", "\")", ";", "}", "catch", "(", "SAXException", "e", ")", "{"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Merge", "branch", "'PHP-8.0'", "*", "PHP-8.0:", "Fix", "snmp", "build", "without", "DES"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["x86/asm/entry/64:", "Remove", "a", "bogus", "'ret_from_fork'", "optimization", "'ret_from_fork'", "checks", "TIF_IA32", "to", "determine", "whether", "'pt_regs'", "and", "the", "related", "state", "make", "sense", "for", "'ret_from_sys_call'.", "This", "is", "entirely", "the", "wrong", "check.", "TS_COMPAT", "would", "make", "a", "little", "more", "sense,", "but", "there's", "really", "no", "point", "in", "keeping", "this", "optimization", "at", "all.", "This", "fixes", "a", "return", "to", "the", "wrong", "user", "CS", "if", "we", "came", "from", "int", "0x80", "in", "a", "64-bit", "task.", "Signed-off-by:", "Andy", "Lutomirski", "<luto@amacapital.net>", "Cc:", "Borislav", "Petkov", "<bp@alien8.de>", "Cc:", "Denys", "Vlasenko", "<dvlasenk@redhat.com>", "Cc:", "H.", "Peter", "Anvin", "<hpa@zytor.com>", "Cc:", "Linus", "Torvalds", "<torvalds@linux-foundation.org>", "Cc:", "Oleg", "Nesterov", "<oleg@redhat.com>", "Cc:", "Thomas", "Gleixner", "<tglx@linutronix.de>", "Cc:", "<stable@vger.kernel.org>", "Link:", "http://lkml.kernel.org/r/4710be56d76ef994ddf59087aad98c000fbab9a4.1424989793.git.luto@amacapital.net", "[", "Backported", "from", "tip:x86/asm.", "]", "Signed-off-by:", "Ingo", "Molnar", "<mingo@kernel.org>"], "code_tokens": ["@", "@", "-", "269", ",", "11", "+", "269", ",", "14", "@", "@", "ENTRY", "(", "ret_from_fork", ")", "testl", "$", "3", ",", "CS", "-", "ARGOFFSET", "(", "%", "rsp", ")", "#", "from", "kernel_thread", "?", "jz", "1f", "testl", "$", "_TIF_IA32", ",", "TI_flags", "(", "%", "rcx", ")", "#", "32", "-", "bit", "compat", "task", "needs", "IRET", "jnz", "int_ret_from_sys_call", "RESTORE_TOP_OF_STACK", "%", "rdi", ",", "-", "ARGOFFSET", "jmp", "ret_from_sys_call", "#", "go", "to", "the", "SYSRET", "fastpath", "/", "*", "*", "By", "the", "time", "we", "get", "here", ",", "we", "have", "no", "idea", "whether", "our", "pt_regs", ",", "*", "ti", "flags", ",", "and", "ti", "status", "came", "from", "the", "64", "-", "bit", "SYSCALL", "fast", "path", ",", "*", "the", "slow", "path", ",", "or", "one", "of", "the", "ia32entry", "paths", ".", "*", "Use", "int_ret_from_sys_call", "to", "return", ",", "since", "it", "can", "safely", "handle", "*", "all", "of", "the", "above", ".", "*", "/", "jmp", "int_ret_from_sys_call", "1", ":", "subq", "$", "REST_SKIP", ",", "%", "rsp", "#", "leave", "space", "for", "volatiles"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Fix", "bug", "#73192"], "code_tokens": ["@", "@", "-", "0", ",", "0", "+", "1", ",", "30", "@", "@", "-", "-", "TEST", "-", "-", "Bug", "#", "73192", ":", "parse_url", "return", "wrong", "hostname", "-", "-", "FILE", "-", "-", "<", "?", "php", "var_dump", "(", "parse_url", "(", "\"", "http", ":", "//", "example", ".", "com", ":", "80", "#", "@", "google", ".", "com", "/", "\")", ");", "var_dump", "(", "parse_url", "(", "\"", "http", ":", "//", "example", ".", "com", ":", "80", "?", "@", "google", ".", "com", "/", "\")", ");", "?", ">", "-", "-", "EXPECT", "-", "-", "array", "(", "4", ")", "{", "[", "\"", "scheme", "\"", "]=", ">", "string", "(", "4", ")", "\"", "http", "\"", "[", "\"", "host", "\"", "]=", ">", "string", "(", "11", ")", "\"", "example", ".", "com", "\"", "[", "\"", "port", "\"", "]=", ">", "int", "(", "80", ")", "[", "\"", "fragment", "\"", "]=", ">", "string", "(", "12", ")", "\"", "@", "google", ".", "com", "/", "\"", "}", "array", "(", "4", ")", "{", "[", "\"", "scheme", "\"", "]=", ">", "string", "(", "4", ")", "\"", "http", "\"", "[", "\"", "host", "\"", "]=", ">", "string", "(", "11", ")", "\"", "example", ".", "com", "\"", "[", "\"", "port", "\"", "]=", ">", "int", "(", "80", ")", "[", "\"", "query", "\"", "]=", ">", "string", "(", "12", ")", "\"", "@", "google", ".", "com", "/", "\"", "}", "@", "@", "-", "763", ",", "25", "+", "763", ",", "9", "@", "@", "echo", "\"", "Done", "\"", ";", "int", "(", "6", ")", "}", ">", "http", ":", "//", "?:", "/:", "array", "(", "3", ")", "{", "[", "\"", "scheme", "\"", "]=", ">", "string", "(", "4", ")", "\"", "http", "\"", "[", "\"", "host", "\"", "]=", ">", "string", "(", "1", ")", "\"", "?\"", "[", "\"", "path", "\"", "]=", ">", "string", "(", "1", ")", "\"", "/\"", "}", "-", "->", "http", ":", "//", "?:", "/:", "bool", "(", "false", ")", ">", "http", ":", "//", "@?", ":/", ":", "array", "(", "4", ")", "{", "[", "\"", "scheme", "\"", "]=", ">", "string", "(", "4", ")", "\"", "http", "\"", "[", "\"", "host", "\"", "]=", ">", "string", "(", "1", ")", "\"", "?\"", "[", "\"", "user", "\"", "]=", ">", "string", "(", "0", ")", "\"", "\"", "[", "\"", "path", "\"", "]=", ">", "string", "(", "1", ")", "\"", "/\"", "}", "-", "->", "http", ":", "//", "@?", ":/", ":", "bool", "(", "false", ")", "-", "->", "file", ":", "//", "/:", ":", "array", "(", "2", ")", "{", "[", "\"", "scheme", "\"", "]=", ">", "@", "@", "-", "98", ",", "8", "+", "98", ",", "8", "@", "@", "echo", "\"", "Done", "\"", ";", "-", "->", "http", ":", "//", "::", "?", ":", "string", "(", "4", ")", "\"", "http", "\"", "-", "->", "http", ":", "//", "::", "#", ":", "string", "(", "4", ")", "\"", "http", "\"", "-", "->", "x", ":", "//", "::", "6", ".", "5", ":", "string", "(", "1", ")", "\"", "x", "\"", ">", "http", ":", "//", "?:", "/", ":", "string", "(", "4", ")", "\"", "http", "\"", ">", "http", ":", "//", "@?", ":/", ":", "string", "(", "4", ")", "\"", "http", "\"", "-", "->", "http", ":", "//", "?:", "/", ":", "bool", "(", "false", ")", "-", "->", "http", ":", "//", "@?", ":/", ":", "bool", "(", "false", ")", "-", "->", "file", ":", "//", "/:", ":", "string", "(", "4", ")", "\"", "file", "\"", "-", "->", "file", ":", "//", "/", "a", ":", "/", ":", "string", "(", "4", ")", "\"", "file", "\"", "-", "->", "file", ":", "//", "/", "ab", ":", "/", ":", "string", "(", "4", ")", "\"", "file", "\"", "@", "@", "-", "97", ",", "8", "+", "97", ",", "8", "@", "@", "echo", "\"", "Done", "\"", ";", "-", "->", "http", ":", "//", "::", "?", ":", "string", "(", "1", ")", "\"", ":\"", "-", "->", "http", ":", "//", "::", "#", ":", "string", "(", "1", ")", "\"", ":\"", "-", "->", "x", ":", "//", "::", "6", ".", "5", ":", "string", "(", "1", ")", "\"", ":\"", ">", "http", ":", "//", "?:", "/", ":", "string", "(", "1", ")", "\"", "?\"", ">", "http", ":", "//", "@?", ":/", ":", "string", "(", "1", ")", "\"", "?\"", "-", "->", "http", ":", "//", "?:", "/", ":", "bool", "(", "false", ")", "-", "->", "http", ":", "//", "@?", ":/", ":", "bool", "(", "false", ")", "-", "->", "file", ":", "//", "/:", ":", "NULL", "-", "->", "file", ":", "//", "/", "a", ":", "/", ":", "NULL", "-", "->", "file", ":", "//", "/", "ab", ":", "/", ":", "NULL", "@", "@", "-", "97", ",", "8", "+", "97", ",", "8", "@", "@", "echo", "\"", "Done", "\"", ";", "-", "->", "http", ":", "//", "::", "?", ":", "NULL", "-", "->", "http", ":", "//", "::", "#", ":", "NULL", "-", "->", "x", ":", "//", "::", "6", ".", "5", ":", "int", "(", "6", ")", ">", "http", ":", "//", "?:", "/", ":", "NULL", ">", "http", ":", "//", "@?", ":/", ":", "NULL", "-", "->", "http", ":", "//", "?:", "/", ":", "bool", "(", "false", ")", "-", "->", "http", ":", "//", "@?", ":/", ":", "bool", "(", "false", ")", "-", "->", "file", ":", "//", "/:", ":", "NULL", "-", "->", "file", ":", "//", "/", "a", ":", "/", ":", "NULL", "-", "->", "file", ":", "//", "/", "ab", ":", "/", ":", "NULL", "@", "@", "-", "97", ",", "8", "+", "97", ",", "8", "@", "@", "echo", "\"", "Done", "\"", ";", "-", "->", "http", ":", "//", "::", "?", ":", "NULL", "-", "->", "http", ":", "//", "::", "#", ":", "NULL", "-", "->", "x", ":", "//", "::", "6", ".", "5", ":", "NULL", ">", "http", ":", "//", "?:", "/", ":", "NULL", ">", "http", ":", "//", "@?", ":/", ":", "string", "(", "0", ")", "\"", "\"", "-", "->", "http", ":", "//", "?:", "/", ":", "bool", "(", "false", ")", "-", "->", "http", ":", "//", "@?", ":/", ":", "bool", "(", "false", ")", "-", "->", "file", ":", "//", "/:", ":", "NULL", "-", "->", "file", ":", "//", "/", "a", ":", "/", ":", "NULL", "-", "->", "file", ":", "//", "/", "ab", ":", "/", ":", "NULL", "@", "@", "-", "97", ",", "8", "+", "97", ",", "8", "@", "@", "echo", "\"", "Done", "\"", ";", "-", "->", "http", ":", "//", "::", "?", ":", "NULL", "-", "->", "http", ":", "//", "::", "#", ":", "NULL", "-", "->", "x", ":", "//", "::", "6", ".", "5", ":", "NULL", ">", "http", ":", "//", "?:", "/", ":", "NULL", ">", "http", ":", "//", "@?", ":/", ":", "NULL", "-", "->", "http", ":", "//", "?:", "/", ":", "bool", "(", "false", ")", "-", "->", "http", ":", "//", "@?", ":/", ":", "bool", "(", "false", ")", "-", "->", "file", ":", "//", "/:", ":", "NULL", "-", "->", "file", ":", "//", "/", "a", ":", "/", ":", "NULL", "-", "->", "file", ":", "//", "/", "ab", ":", "/", ":", "NULL", "@", "@", "-", "97", ",", "8", "+", "97", ",", "8", "@", "@", "echo", "\"", "Done", "\"", ";", "-", "->", "http", ":", "//", "::", "?", ":", "NULL", "-", "->", "http", ":", "//", "::", "#", ":", "NULL", "-", "->", "x", ":", "//", "::", "6", ".", "5", ":", "NULL", ">", "http", ":", "//", "?:", "/", ":", "string", "(", "1", ")", "\"", "/\"", ">", "http", ":", "//", "@?", ":/", ":", "string", "(", "1", ")", "\"", "/\"", "-", "->", "http", ":", "//", "?:", "/", ":", "bool", "(", "false", ")", "-", "->", "http", ":", "//", "@?", ":/", ":", "bool", "(", "false", ")", "-", "->", "file", ":", "//", "/:", ":", "string", "(", "2", ")", "\"", "/:", "\"", "-", "->", "file", ":", "//", "/", "a", ":", "/", ":", "string", "(", "3", ")", "\"", "a", ":", "/\"", "-", "->", "file", ":", "//", "/", "ab", ":", "/", ":", "string", "(", "5", ")", "\"", "/", "ab", ":", "/\"", "@", "@", "-", "97", ",", "8", "+", "97", ",", "8", "@", "@", "echo", "\"", "Done", "\"", ";", "-", "->", "http", ":", "//", "::", "?", ":", "NULL", "-", "->", "http", ":", "//", "::", "#", ":", "NULL", "-", "->", "x", ":", "//", "::", "6", ".", "5", ":", "NULL", ">", "http", ":", "//", "?:", "/", ":", "NULL", ">", "http", ":", "//", "@?", ":/", ":", "NULL", "-", "->", "http", ":", "//", "?:", "/", ":", "bool", "(", "false", ")", "-", "->", "http", ":", "//", "@?", ":/", ":", "bool", "(", "false", ")", "-", "->", "file", ":", "//", "/:", ":", "NULL", "-", "->", "file", ":", "//", "/", "a", ":", "/", ":", "NULL", "-", "->", "file", ":", "//", "/", "ab", ":", "/", ":", "NULL", "@", "@", "-", "97", ",", "8", "+", "97", ",", "8", "@", "@", "echo", "\"", "Done", "\"", ";", "-", "->", "http", ":", "//", "::", "?", ":", "NULL", "-", "->", "http", ":", "//", "::", "#", ":", "NULL", "-", "->", "x", ":", "//", "::", "6", ".", "5", ":", "NULL", ">", "http", ":", "//", "?:", "/", ":", "NULL", ">", "http", ":", "//", "@?", ":/", ":", "NULL", "-", "->", "http", ":", "//", "?:", "/", ":", "bool", "(", "false", ")", "-", "->", "http", ":", "//", "@?", ":/", ":", "bool", "(", "false", ")", "-", "->", "file", ":", "//", "/:", ":", "NULL", "-", "->", "file", ":", "//", "/", "a", ":", "/", ":", "NULL", "-", "->", "file", ":", "//", "/", "ab", ":", "/", ":", "NULL", "@", "@", "-", "217", ",", "28", "+", "217", ",", "7", "@", "@", "PHPAPI", "php_url", "*", "php_url_parse_ex", "(", "char", "const", "*", "str", ",", "int", "length", ")", "goto", "nohost", ";", "}", "e", "=", "ue", ";", "if", "(", "!(", "p", "=", "memchr", "(", "s", ",", "'", "/'", ",", "(", "ue", "-", "s", ")", "))", ")", "{", "char", "*", "query", ",", "*", "fragment", ";", "query", "=", "memchr", "(", "s", ",", "'", "?'", ",", "(", "ue", "-", "s", ")", ");", "fragment", "=", "memchr", "(", "s", ",", "'", "#'", ",", "(", "ue", "-", "s", ")", ");", "if", "(", "query", "&", "&", "fragment", ")", "{", "if", "(", "query", ">", "fragment", ")", "{", "e", "=", "fragment", ";", "}", "else", "{", "e", "=", "query", ";", "}", "}", "else", "if", "(", "query", ")", "{", "e", "=", "query", ";", "}", "else", "if", "(", "fragment", ")", "{", "e", "=", "fragment", ";", "}", "}", "else", "{", "e", "=", "p", ";", "}", "e", "=", "s", "+", "strcspn", "(", "s", ",", "\"", "/?", "#\"", ");", "/", "*", "check", "for", "login", "and", "password", "*", "/", "if", "(", "(", "p", "=", "zend_memrchr", "(", "s", ",", "'", "@'", ",", "(", "e", "-", "s", ")", "))", ")", "{"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["net:", "fix", "infoleak", "in", "rtnetlink", "The", "stack", "object", "\u201cmap\u201d", "has", "a", "total", "size", "of", "32", "bytes.", "Its", "last", "4", "bytes", "are", "padding", "generated", "by", "compiler.", "These", "padding", "bytes", "are", "not", "initialized", "and", "sent", "out", "via", "\u201cnla_put\u201d.", "Signed-off-by:", "Kangjie", "Lu", "<kjlu@gatech.edu>", "Signed-off-by:", "David", "S.", "Miller", "<davem@davemloft.net>"], "code_tokens": ["@", "@", "-", "1180", ",", "14", "+", "1180", ",", "16", "@", "@", "static", "noinline_for_stack", "int", "rtnl_fill_vfinfo", "(", "struct", "sk_buff", "*", "skb", ",", "static", "int", "rtnl_fill_link_ifmap", "(", "struct", "sk_buff", "*", "skb", ",", "struct", "net_device", "*", "dev", ")", "{", "struct", "rtnl_link_ifmap", "map", "=", "{", ".", "mem_start", "=", "dev", "-", ">", "mem_start", ",", ".", "mem_end", "=", "dev", "-", ">", "mem_end", ",", ".", "base_addr", "=", "dev", "-", ">", "base_addr", ",", ".", "irq", "=", "dev", "-", ">", "irq", ",", ".", "dma", "=", "dev", "-", ">", "dma", ",", ".", "port", "=", "dev", "-", ">", "if_port", ",", "}", ";", "struct", "rtnl_link_ifmap", "map", ";", "memset", "(", "&", "map", ",", "0", ",", "sizeof", "(", "map", ")", ");", "map", ".", "mem_start", "=", "dev", "-", ">", "mem_start", ";", "map", ".", "mem_end", "=", "dev", "-", ">", "mem_end", ";", "map", ".", "base_addr", "=", "dev", "-", ">", "base_addr", ";", "map", ".", "irq", "=", "dev", "-", ">", "irq", ";", "map", ".", "dma", "=", "dev", "-", ">", "dma", ";", "map", ".", "port", "=", "dev", "-", ">", "if_port", ";", "if", "(", "nla_put", "(", "skb", ",", "IFLA_MAP", ",", "sizeof", "(", "map", ")", ",", "&", "map", ")", ")", "return", "-", "EMSGSIZE", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Backported", "changes", "made", "in", "2.1"], "code_tokens": ["@", "@", "-", "24", ",", "7", "+", "24", ",", "7", "@", "@", "<", "parent", ">", "<", "groupId", ">", "org", ".", "apache", ".", "mina", "<", "/", "groupId", ">", "<", "artifactId", ">", "mina", "-", "parent", "<", "/", "artifactId", ">", "<", "version", ">", "2", ".", "0", ".", "21", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "2", ".", "0", ".", "20", "<", "/", "version", ">", "<", "/", "parent", ">", "<", "artifactId", ">", "mina", "-", "core", "<", "/", "artifactId", ">", "@", "@", "-", "493", ",", "8", "+", "493", ",", "10", "@", "@", "private", "boolean", "isOrderedMap", "(", "Map", "<", "String", ",", "?", "extends", "IoFilter", ">", "map", ")", "{", "/", "/", "Last", "resort", ":", "try", "to", "create", "a", "new", "instance", "and", "test", "if", "it", "maintains", "/", "/", "the", "insertion", "order", ".", "LOGGER", ".", "debug", "(", "\"", "Last", "resort", ";", "trying", "to", "create", "a", "new", "map", "instance", "with", "a", "\"", "+", "\"", "default", "constructor", "and", "test", "if", "insertion", "order", "is", "maintained", ".", "\")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Last", "resort", ";", "trying", "to", "create", "a", "new", "map", "instance", "with", "a", "\"", "+", "\"", "default", "constructor", "and", "test", "if", "insertion", "order", "is", "maintained", ".", "\")", ";", "}", "Map", "<", "String", ",", "IoFilter", ">", "newMap", ";", "@", "@", "-", "535", ",", "7", "+", "537", ",", "9", "@", "@", "private", "boolean", "isOrderedMap", "(", "Map", "<", "String", ",", "?", "extends", "IoFilter", ">", "map", ")", "{", "}", "}", "LOGGER", ".", "debug", "(", "\"", "The", "specified", "map", "passed", "the", "insertion", "order", "test", ".", "\")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "The", "specified", "map", "passed", "the", "insertion", "order", "test", ".", "\")", ";", "}", "return", "true", ";", "}", "@", "@", "-", "1117", ",", "7", "+", "1117", ",", "7", "@", "@", "private", "int", "writeBuffer", "(", "S", "session", ",", "WriteRequest", "req", ",", "boolean", "hasFragmentation", ",", "i", "session", ".", "increaseWrittenBytes", "(", "localWrittenBytes", ",", "currentTime", ")", ";", "/", "/", "Now", ",", "forward", "the", "original", "message", "/", "/", "Now", ",", "forward", "the", "original", "message", "if", "it", "has", "been", "fully", "sent", "if", "(", "!", "buf", ".", "hasRemaining", "(", ")", "|", "|", "(", "!", "hasFragmentation", "&", "&", "(", "localWrittenBytes", "!", "=", "0", ")", "))", "{", "WriteRequest", "originalRequest", "=", "req", ".", "getOriginalRequest", "(", ");", "@", "@", "-", "335", ",", "9", "+", "335", ",", "15", "@", "@", "public", "final", "void", "dispose", "(", "boolean", "awaitTermination", ")", "{", "if", "(", "awaitTermination", ")", "{", "try", "{", "LOGGER", ".", "debug", "(", "\"", "awaitTermination", "on", "{", "}", "called", "by", "thread", "=", "[{", "}]", "\",", "this", ",", "Thread", ".", "currentThread", "(", ").", "getName", "(", "))", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "awaitTermination", "on", "{", "}", "called", "by", "thread", "=", "[{", "}]", "\",", "this", ",", "Thread", ".", "currentThread", "(", ").", "getName", "(", "))", ";", "}", "e", ".", "awaitTermination", "(", "Integer", ".", "MAX_VALUE", ",", "TimeUnit", ".", "SECONDS", ")", ";", "LOGGER", ".", "debug", "(", "\"", "awaitTermination", "on", "{", "}", "finished", "\"", ",", "this", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "awaitTermination", "on", "{", "}", "finished", "\"", ",", "this", ")", ";", "}", "}", "catch", "(", "InterruptedException", "e1", ")", "{", "LOGGER", ".", "warn", "(", "\"", "awaitTermination", "on", "[", "{}", "]", "was", "interrupted", "\"", ",", "this", ")", ";", "/", "/", "Restore", "the", "interrupted", "status", "@", "@", "-", "47", ",", "8", "+", "47", ",", "8", "@", "@", "*", "@", "org", ".", "apache", ".", "xbean", ".", "XBean", "*", "/", "public", "final", "class", "BufferedWriteFilter", "extends", "IoFilterAdapter", "{", "private", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "BufferedWriteFilter", ".", "class", ")", ";", "private", "static", "final", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "BufferedWriteFilter", ".", "class", ")", ";", "/", "**", "*", "Default", "buffer", "size", "value", "in", "bytes", ".", "*", "/", "@", "@", "-", "196", ",", "7", "+", "196", ",", "11", "@", "@", "private", "void", "internalFlush", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ",", "IoBuffer", "bu", "tmp", "=", "buf", ".", "duplicate", "(", ");", "buf", ".", "clear", "(", ");", "}", "logger", ".", "debug", "(", "\"", "Flushing", "buffer", ":", "{", "}\"", ",", "tmp", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Flushing", "buffer", ":", "{", "}\"", ",", "tmp", ")", ";", "}", "nextFilter", ".", "filterWrite", "(", "session", ",", "new", "DefaultWriteRequest", "(", "tmp", ")", ");", "}", "@", "@", "-", "230", ",", "7", "+", "230", ",", "9", "@", "@", "public", "void", "onPostRemove", "(", "IoFilterChain", "parent", ",", "String", "name", ",", "NextFilter", "nextFilte", "*", "/", "@", "Override", "public", "void", "messageReceived", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ",", "Object", "message", ")", "throws", "Exception", "{", "LOGGER", ".", "debug", "(", "\"", "Processing", "a", "MESSAGE_RECEIVED", "for", "session", "{", "}\"", ",", "session", ".", "getId", "(", "))", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Processing", "a", "MESSAGE_RECEIVED", "for", "session", "{", "}\"", ",", "session", ".", "getId", "(", "))", ";", "}", "if", "(", "!(", "message", "instanceof", "IoBuffer", ")", ")", "{", "nextFilter", ".", "messageReceived", "(", "session", ",", "message", ")", ";", "@", "@", "-", "48", ",", "8", "+", "48", ",", "8", "@", "@", "*", "@", "author", "<", "a", "href", "=", "\"", "http", ":", "//", "mina", ".", "apache", ".", "org", "\"", ">", "Apache", "MINA", "Project", "<", "/", "a", ">", "*", "/", "public", "abstract", "class", "DecodingStateMachine", "implements", "DecodingState", "{", "private", "final", "Logger", "log", "=", "LoggerFactory", ".", "getLogger", "(", "DecodingStateMachine", ".", "class", ")", ";", "private", "static", "final", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "DecodingStateMachine", ".", "class", ")", ";", "private", "final", "List", "<", "Object", ">", "childProducts", "=", "new", "ArrayList", "<", ">(", ");", "private", "final", "ProtocolDecoderOutput", "childOutput", "=", "new", "ProtocolDecoderOutput", "(", ")", "{", "@", "@", "-", "175", ",", "7", "+", "175", ",", "10", "@", "@", "public", "DecodingState", "finishDecode", "(", "ProtocolDecoderOutput", "out", ")", "throws", "Exception", "{", "}", "}", "catch", "(", "Exception", "e", ")", "{", "state", "=", "null", ";", "log", ".", "debug", "(", "\"", "Ignoring", "the", "exception", "caused", "by", "a", "closed", "session", ".", "\",", "e", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Ignoring", "the", "exception", "caused", "by", "a", "closed", "session", ".", "\",", "e", ")", ";", "}", "}", "finally", "{", "this", ".", "currentState", "=", "state", ";", "nextState", "=", "finishDecode", "(", "childProducts", ",", "out", ")", ";", "@", "@", "-", "196", ",", "7", "+", "199", ",", "9", "@", "@", "private", "void", "cleanup", "(", ")", "{", "try", "{", "destroy", "(", ");", "}", "catch", "(", "Exception", "e2", ")", "{", "log", ".", "warn", "(", "\"", "Failed", "to", "destroy", "a", "decoding", "state", "machine", ".", "\",", "e2", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "warn", "(", "\"", "Failed", "to", "destroy", "a", "decoding", "state", "machine", ".", "\",", "e2", ")", ";", "}", "}", "}", "@", "@", "-", "411", ",", "6", "+", "411", ",", "7", "@", "@", "private", "void", "print", "(", "Queue", "<", "Runnable", ">", "queue", ",", "IoEvent", "event", ")", "{", "sb", ".", "append", "(", "\"", "Adding", "event", "\"", ").", "append", "(", "event", ".", "getType", "(", "))", ".", "append", "(", "\"", "to", "session", "\"", ").", "append", "(", "event", ".", "getSession", "(", ").", "getId", "(", "))", ";", "boolean", "first", "=", "true", ";", "sb", ".", "append", "(", "\"\\", "nQueue", ":", "[", "\")", ";", "for", "(", "Runnable", "elem", ":", "queue", ")", "{", "if", "(", "first", ")", "{", "first", "=", "false", ";", "@", "@", "-", "420", ",", "8", "+", "421", ",", "12", "@", "@", "private", "void", "print", "(", "Queue", "<", "Runnable", ">", "queue", ",", "IoEvent", "event", ")", "{", "sb", ".", "append", "(", "((", "IoEvent", ")", "elem", ")", ".", "getType", "(", "))", ".", "append", "(", "\",", "\"", ");", "}", "sb", ".", "append", "(", "\"]", "\\", "n", "\"", ");", "LOGGER", ".", "debug", "(", "sb", ".", "toString", "(", "))", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "sb", ".", "toString", "(", "))", ";", "}", "}", "/", "**", "@", "@", "-", "44", ",", "6", "+", "44", ",", "7", "@", "@", "/", "**", "The", "list", "of", "blocked", "addresses", "*", "/", "private", "final", "List", "<", "Subnet", ">", "blacklist", "=", "new", "CopyOnWriteArrayList", "<", "Subnet", ">", "()", ";", "/", "**", "A", "logger", "for", "this", "class", "*", "/", "private", "final", "static", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "BlacklistFilter", ".", "class", ")", ";", "/", "**", "@", "@", "-", "60", ",", "9", "+", "61", ",", "8", "@", "@", "public", "void", "setBlacklist", "(", "InetAddress", "[", "]", "addresses", ")", "{", "blacklist", ".", "clear", "(", ");", "for", "(", "int", "i", "=", "0", ";", "i", "<", "addresses", ".", "length", ";", "i", "+", "+)", "{", "InetAddress", "addr", "=", "addresses", "[", "i", "]", ";", "block", "(", "addr", ")", ";", "for", "(", "InetAddress", "address", ":", "addresses", ")", "{", "block", "(", "address", ")", ";", "}", "}", "@", "@", "-", "178", ",", "6", "+", "178", ",", "9", "@", "@", "public", "void", "unblock", "(", "Subnet", "subnet", ")", "{", "blacklist", ".", "remove", "(", "subnet", ")", ";", "}", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "void", "sessionCreated", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ")", "{", "if", "(", "!", "isBlocked", "(", "session", ")", ")", "{", "@", "@", "-", "188", ",", "6", "+", "191", ",", "9", "@", "@", "public", "void", "sessionCreated", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ")", "{", "}", "}", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "void", "sessionOpened", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ")", "throws", "Exception", "{", "if", "(", "!", "isBlocked", "(", "session", ")", ")", "{", "@", "@", "-", "198", ",", "6", "+", "204", ",", "9", "@", "@", "public", "void", "sessionOpened", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ")", "throws", "Excep", "}", "}", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "void", "sessionClosed", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ")", "throws", "Exception", "{", "if", "(", "!", "isBlocked", "(", "session", ")", ")", "{", "@", "@", "-", "208", ",", "6", "+", "217", ",", "9", "@", "@", "public", "void", "sessionClosed", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ")", "throws", "Excep", "}", "}", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "void", "sessionIdle", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ",", "IdleStatus", "status", ")", "throws", "Exception", "{", "if", "(", "!", "isBlocked", "(", "session", ")", ")", "{", "@", "@", "-", "218", ",", "6", "+", "230", ",", "9", "@", "@", "public", "void", "sessionIdle", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ",", "IdleStatus", "sta", "}", "}", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "void", "messageReceived", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ",", "Object", "message", ")", "{", "if", "(", "!", "isBlocked", "(", "session", ")", ")", "{", "@", "@", "-", "228", ",", "6", "+", "243", ",", "9", "@", "@", "public", "void", "messageReceived", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ",", "Object", "mes", "}", "}", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "void", "messageSent", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ",", "WriteRequest", "writeRequest", ")", "throws", "Exception", "{", "if", "(", "!", "isBlocked", "(", "session", ")", ")", "{", "@", "@", "-", "163", ",", "7", "+", "163", ",", "10", "@", "@", "protected", "boolean", "isConnectionOk", "(", "IoSession", "session", ")", "{", "try", "{", "if", "(", "clients", ".", "containsKey", "(", "addr", ".", "getAddress", "(", ").", "getHostAddress", "(", "))", ")", "{", "LOGGER", ".", "debug", "(", "\"", "This", "is", "not", "a", "new", "client", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "This", "is", "not", "a", "new", "client", "\"", ");", "}", "Long", "lastConnTime", "=", "clients", ".", "get", "(", "addr", ".", "getAddress", "(", ").", "getHostAddress", "(", "))", ";", "clients", ".", "put", "(", "addr", ".", "getAddress", "(", ").", "getHostAddress", "(", "),", "now", ")", ";", "@", "@", "-", "29", ",", "10", "+", "29", ",", "10", "@", "@", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "/", "**", "*", "Logs", "all", "MINA", "protocol", "events", ".", "Each", "event", "can", "be", "*", "tuned", "to", "use", "a", "different", "level", "based", "on", "the", "user", "'", "s", "specific", "requirements", ".", "Methods", "*", "are", "in", "place", "that", "allow", "the", "user", "to", "use", "either", "the", "get", "or", "set", "method", "for", "each", "event", "*", "and", "pass", "in", "the", "{", "@", "link", "IoEventType", "}", "and", "the", "{", "@", "link", "LogLevel", "}", ".", "*", "Logs", "MINA", "protocol", "events", ".", "Each", "event", "can", "be", "tuned", "to", "use", "a", "different", "level", "based", "on", "*", "the", "user", "'", "s", "specific", "requirements", ".", "Methods", "are", "in", "place", "that", "allow", "the", "user", "to", "use", "*", "either", "the", "get", "or", "set", "method", "for", "each", "event", "and", "pass", "in", "the", "{", "@", "link", "IoEventType", "}", "and", "*", "the", "{", "@", "link", "LogLevel", "}", ".", "*", "*", "By", "default", ",", "all", "events", "are", "logged", "to", "the", "{", "@", "link", "LogLevel", "#", "INFO", "}", "level", "except", "*", "{", "@", "link", "IoFilterAdapter", "#", "exceptionCaught", "(", "IoFilter", ".", "NextFilter", ",", "IoSession", ",", "Throwable", ")", "},", "@", "@", "-", "196", ",", "42", "+", "196", ",", "67", "@", "@", "private", "void", "log", "(", "LogLevel", "eventLevel", ",", "String", "message", ")", "{", "}", "}", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "void", "exceptionCaught", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ",", "Throwable", "cause", ")", "throws", "Exception", "{", "log", "(", "exceptionCaughtLevel", ",", "\"", "EXCEPTION", ":", "\",", "cause", ")", ";", "nextFilter", ".", "exceptionCaught", "(", "session", ",", "cause", ")", ";", "}", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "void", "messageReceived", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ",", "Object", "message", ")", "throws", "Exception", "{", "/", "/", "Note", ":", "the", "way", "the", "IoBuffer", "method", "is", "implemented", ",", "logging", "an", "instance", "of", "/", "/", "an", "instance", "will", "not", "change", "its", "position", ".", "It", "'", "s", "safe", ".", "log", "(", "messageReceivedLevel", ",", "\"", "RECEIVED", ":", "{", "}\"", ",", "message", ")", ";", "nextFilter", ".", "messageReceived", "(", "session", ",", "message", ")", ";", "}", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "void", "messageSent", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ",", "WriteRequest", "writeRequest", ")", "throws", "Exception", "{", "/", "/", "Note", ":", "the", "way", "the", "IoBuffer", "method", "is", "implemented", ",", "logging", "an", "instance", "of", "/", "/", "an", "instance", "will", "not", "change", "its", "position", ".", "It", "'", "s", "safe", ".", "log", "(", "messageSentLevel", ",", "\"", "SENT", ":", "{", "}\"", ",", "writeRequest", ".", "getOriginalRequest", "(", ").", "getMessage", "(", "))", ";", "nextFilter", ".", "messageSent", "(", "session", ",", "writeRequest", ")", ";", "}", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "void", "sessionCreated", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ")", "throws", "Exception", "{", "log", "(", "sessionCreatedLevel", ",", "\"", "CREATED", "\"", ");", "nextFilter", ".", "sessionCreated", "(", "session", ")", ";", "}", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "void", "sessionOpened", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ")", "throws", "Exception", "{", "log", "(", "sessionOpenedLevel", ",", "\"", "OPENED", "\"", ");", "nextFilter", ".", "sessionOpened", "(", "session", ")", ";", "}", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "void", "sessionIdle", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ",", "IdleStatus", "status", ")", "throws", "Exception", "{", "log", "(", "sessionIdleLevel", ",", "\"", "IDLE", "\"", ");", "nextFilter", ".", "sessionIdle", "(", "session", ",", "status", ")", ";", "}", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "void", "sessionClosed", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ")", "throws", "Exception", "{", "log", "(", "sessionClosedLevel", ",", "\"", "CLOSED", "\"", ");", "@", "@", "-", "454", ",", "7", "+", "454", ",", "9", "@", "@", "public", "void", "onPreAdd", "(", "IoFilterChain", "parent", ",", "String", "name", ",", "NextFilter", "nextFilter", ")", "t", "throw", "new", "IllegalStateException", "(", "msg", ")", ";", "}", "LOGGER", ".", "debug", "(", "\"", "Adding", "the", "SSL", "Filter", "{", "}", "to", "the", "chain", "\"", ",", "name", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Adding", "the", "SSL", "Filter", "{", "}", "to", "the", "chain", "\"", ",", "name", ")", ";", "}", "IoSession", "session", "=", "parent", ".", "getSession", "(", ");", "session", ".", "setAttribute", "(", "NEXT_FILTER", ",", "nextFilter", ")", ";", "@", "@", "-", "749", ",", "7", "+", "751", ",", "10", "@", "@", "public", "void", "initiateHandshake", "(", "IoSession", "session", ")", "throws", "SSLException", "{", "}", "private", "void", "initiateHandshake", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ")", "throws", "SSLException", "{", "LOGGER", ".", "debug", "(", "\"{", "}", ":", "Starting", "the", "first", "handshake", "\"", ",", "getSessionInfo", "(", "session", ")", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"{", "}", ":", "Starting", "the", "first", "handshake", "\"", ",", "getSessionInfo", "(", "session", ")", ");", "}", "SslHandler", "sslHandler", "=", "getSslSessionHandler", "(", "session", ")", ";", "try", "{", "@", "@", "-", "862", ",", "7", "+", "867", ",", "7", "@", "@", "public", "String", "toString", "(", ")", "{", "}", "}", "private", "static", "class", "EncryptedWriteRequest", "extends", "WriteRequestWrapper", "{", "/", "*", "package", "protected", "*", "/", "static", "class", "EncryptedWriteRequest", "extends", "WriteRequestWrapper", "{", "private", "final", "IoBuffer", "encryptedMessage", ";", "private", "EncryptedWriteRequest", "(", "WriteRequest", "writeRequest", ",", "IoBuffer", "encryptedMessage", ")", "{", "@", "@", "-", "33", ",", "6", "+", "33", ",", "7", "@", "@", "import", "javax", ".", "net", ".", "ssl", ".", "SSLException", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLHandshakeException", ";", "import", "org", ".", "apache", ".", "mina", ".", "core", ".", "RuntimeIoException", ";", "import", "org", ".", "apache", ".", "mina", ".", "core", ".", "buffer", ".", "IoBuffer", ";", "import", "org", ".", "apache", ".", "mina", ".", "core", ".", "filterchain", ".", "IoFilter", ".", "NextFilter", ";", "import", "org", ".", "apache", ".", "mina", ".", "core", ".", "filterchain", ".", "IoFilterEvent", ";", "@", "@", "-", "42", ",", "6", "+", "43", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "mina", ".", "core", ".", "session", ".", "IoSession", ";", "import", "org", ".", "apache", ".", "mina", ".", "core", ".", "write", ".", "DefaultWriteRequest", ";", "import", "org", ".", "apache", ".", "mina", ".", "core", ".", "write", ".", "WriteRequest", ";", "import", "org", ".", "apache", ".", "mina", ".", "filter", ".", "ssl", ".", "SslFilter", ".", "EncryptedWriteRequest", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "@", "@", "-", "144", ",", "7", "+", "146", ",", "9", "@", "@", "return", ";", "}", "LOGGER", ".", "debug", "(", "\"{", "}", "Initializing", "the", "SSL", "Handler", "\"", ",", "sslFilter", ".", "getSessionInfo", "(", "session", ")", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"{", "}", "Initializing", "the", "SSL", "Handler", "\"", ",", "sslFilter", ".", "getSessionInfo", "(", "session", ")", ");", "}", "InetSocketAddress", "peer", "=", "(", "InetSocketAddress", ")", "session", ".", "getAttribute", "(", "SslFilter", ".", "PEER_ADDRESS", ")", ";", "@", "@", "-", "210", ",", "7", "+", "214", ",", "9", "@", "@", "try", "{", "sslEngine", ".", "closeInbound", "(", ");", "}", "catch", "(", "SSLException", "e", ")", "{", "LOGGER", ".", "debug", "(", "\"", "Unexpected", "exception", "from", "SSLEngine", ".", "closeInbound", "(", ").", "\",", "e", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Unexpected", "exception", "from", "SSLEngine", ".", "closeInbound", "(", ").", "\",", "e", ")", ";", "}", "}", "if", "(", "outNetBuffer", "!", "=", "null", ")", "{", "@", "@", "-", "517", ",", "9", "+", "523", ",", "34", "@", "@", "private", "void", "checkStatus", "(", "SSLEngineResult", "res", ")", "throws", "SSLException", "{", "*", "UNDERFLOW", "-", "Need", "to", "read", "more", "data", "from", "the", "socket", ".", "It", "'", "s", "normal", ".", "*", "CLOSED", "-", "The", "other", "peer", "closed", "the", "socket", ".", "Also", "normal", ".", "*", "/", "if", "(", "status", "=", "=", "SSLEngineResult", ".", "Status", ".", "BUFFER_OVERFLOW", ")", "{", "throw", "new", "SSLException", "(", "\"", "SSLEngine", "error", "during", "decrypt", ":", "\"", "+", "status", "+", "\"", "inNetBuffer", ":", "\"", "+", "inNetBuffer", "switch", "(", "status", ")", "{", "case", "BUFFER_OVERFLOW", ":", "throw", "new", "SSLException", "(", "\"", "SSLEngine", "error", "during", "decrypt", ":", "\"", "+", "status", "+", "\"", "inNetBuffer", ":", "\"", "+", "inNetBuffer", "+", "\"", "appBuffer", ":", "\"", "+", "appBuffer", ")", ";", "case", "CLOSED", ":", "Exception", "exception", "=", "new", "RuntimeIoException", "(", "\"", "SSL", "/", "TLS", "close_notify", "received", "\"", ");", "/", "/", "Empty", "the", "Ssl", "queue", "for", "(", "IoFilterEvent", "event", ":", "filterWriteEventQueue", ")", "{", "EncryptedWriteRequest", "writeRequest", "=", "(", "EncryptedWriteRequest", ")", "event", ".", "getParameter", "(", ");", "WriteFuture", "writeFuture", "=", "writeRequest", ".", "getParentRequest", "(", ").", "getFuture", "(", ");", "writeFuture", ".", "setException", "(", "exception", ")", ";", "writeFuture", ".", "notifyAll", "(", ");", "}", "/", "/", "Empty", "the", "session", "queue", "while", "(", "!", "session", ".", "getWriteRequestQueue", "(", ").", "isEmpty", "(", "session", ")", ")", "{", "WriteRequest", "writeRequest", "=", "session", ".", "getWriteRequestQueue", "(", ").", "poll", "(", "session", ")", ";", "WriteFuture", "writeFuture", "=", "writeRequest", ".", "getFuture", "(", ");", "writeFuture", ".", "setException", "(", "exception", ")", ";", "writeFuture", ".", "notifyAll", "(", ");", "}", "/", "/", "We", "*", "must", "*", "shutdown", "session", "session", ".", "closeNow", "(", ");", "break", ";", "default", ":", "break", ";", "}", "}", "@", "@", "-", "34", ",", "8", "+", "34", ",", "8", "@", "@", "*", "@", "since", "MINA", "2", ".", "0", ".", "0", "-", "M3", "*", "/", "public", "abstract", "class", "AbstractProxyIoHandler", "extends", "IoHandlerAdapter", "{", "private", "final", "static", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "AbstractProxyIoHandler", ".", "class", ")", ";", "private", "final", "static", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "AbstractProxyIoHandler", ".", "class", ")", ";", "/", "**", "*", "Method", "called", "only", "when", "handshake", "has", "completed", ".", "*", "@", "@", "-", "57", ",", "7", "+", "57", ",", "9", "@", "@", "public", "final", "void", "sessionOpened", "(", "IoSession", "session", ")", "throws", "Exception", "{", "|", "|", "proxyIoSession", ".", "getHandler", "(", ").", "isHandshakeComplete", "(", "))", "{", "proxySessionOpened", "(", "session", ")", ";", "}", "else", "{", "logger", ".", "debug", "(", "\"", "Filtered", "session", "opened", "event", "!", "\")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Filtered", "session", "opened", "event", "!", "\")", ";", "}", "}", "}", "}", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "104", ",", "7", "+", "104", ",", "9", "@", "@", "protected", "WriteFuture", "writeData", "(", "final", "NextFilter", "nextFilter", ",", "final", "IoBuffer", "data", "/", "/", "write", "net", "data", "ProxyHandshakeIoBuffer", "writeBuffer", "=", "new", "ProxyHandshakeIoBuffer", "(", "data", ")", ";", "LOGGER", ".", "debug", "(", "\"", "session", "write", ":", "{", "}\"", ",", "writeBuffer", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "session", "write", ":", "{", "}\"", ",", "writeBuffer", ")", ";", "}", "WriteFuture", "writeFuture", "=", "new", "DefaultWriteFuture", "(", "getSession", "(", "))", ";", "getProxyFilter", "(", ").", "writeData", "(", "nextFilter", ",", "getSession", "(", "),", "new", "DefaultWriteRequest", "(", "writeBuffer", ",", "writeFuture", ")", ",", "true", ")", ";", "@", "@", "-", "133", ",", "7", "+", "135", ",", "9", "@", "@", "protected", "final", "void", "setHandshakeComplete", "(", ")", "{", "ProxyIoSession", "proxyIoSession", "=", "getProxyIoSession", "(", ");", "proxyIoSession", ".", "getConnector", "(", ").", "fireConnected", "(", "proxyIoSession", ".", "getSession", "(", "))", ".", "awaitUninterruptibly", "(", ");", "LOGGER", ".", "debug", "(", "\"", "handshake", "completed", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "handshake", "completed", "\"", ");", "}", "/", "/", "Connected", "OK", "try", "{", "@", "@", "-", "150", ",", "15", "+", "154", ",", "19", "@", "@", "protected", "final", "void", "setHandshakeComplete", "(", ")", "{", "*", "@", "throws", "Exception", "If", "we", "can", "'", "t", "flush", "the", "pending", "write", "requests", "*", "/", "protected", "synchronized", "void", "flushPendingWriteRequests", "(", ")", "throws", "Exception", "{", "LOGGER", ".", "debug", "(", "\"", "flushPendingWriteRequests", "(", ")\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "flushPendingWriteRequests", "(", ")\"", ");", "}", "if", "(", "writeRequestQueue", "=", "=", "null", ")", "{", "return", ";", "}", "Event", "scheduledWrite", ";", "while", "(", "(", "scheduledWrite", "=", "writeRequestQueue", ".", "poll", "(", "))", "!", "=", "null", ")", "{", "LOGGER", ".", "debug", "(", "\"", "Flushing", "buffered", "write", "request", ":", "{", "}\"", ",", "scheduledWrite", ".", "data", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Flushing", "buffered", "write", "request", ":", "{", "}\"", ",", "scheduledWrite", ".", "data", ")", ";", "}", "getProxyFilter", "(", ").", "filterWrite", "(", "scheduledWrite", ".", "nextFilter", ",", "getSession", "(", "),", "(", "WriteRequest", ")", "scheduledWrite", ".", "data", ")", ";", "}", "@", "@", "-", "153", ",", "12", "+", "153", ",", "16", "@", "@", "public", "void", "messageReceived", "(", "final", "NextFilter", "nextFilter", ",", "final", "IoSession", "session", "nextFilter", ".", "messageReceived", "(", "session", ",", "buf", ")", ";", "}", "else", "{", "LOGGER", ".", "debug", "(", "\"", "Data", "Read", ":", "{", "}", "(", "{}", ")\"", ",", "handler", ",", "buf", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Data", "Read", ":", "{", "}", "(", "{}", ")\"", ",", "handler", ",", "buf", ")", ";", "}", "/", "/", "Keep", "sending", "handshake", "data", "to", "the", "handler", "until", "we", "run", "out", "/", "/", "of", "data", "or", "the", "handshake", "is", "finished", "while", "(", "buf", ".", "hasRemaining", "(", ")", "&", "&", "!", "handler", ".", "isHandshakeComplete", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Pre", "-", "handshake", "-", "passing", "to", "handler", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Pre", "-", "handshake", "-", "passing", "to", "handler", "\"", ");", "}", "int", "pos", "=", "buf", ".", "position", "(", ");", "handler", ".", "messageReceived", "(", "nextFilter", ",", "buf", ")", ";", "@", "@", "-", "171", ",", "7", "+", "175", ",", "9", "@", "@", "public", "void", "messageReceived", "(", "final", "NextFilter", "nextFilter", ",", "final", "IoSession", "session", "/", "/", "Pass", "on", "any", "remaining", "data", "to", "the", "next", "filter", "if", "(", "buf", ".", "hasRemaining", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Passing", "remaining", "data", "to", "next", "filter", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Passing", "remaining", "data", "to", "next", "filter", "\"", ");", "}", "nextFilter", ".", "messageReceived", "(", "session", ",", "buf", ")", ";", "}", "@", "@", "-", "210", ",", "18", "+", "216", ",", "25", "@", "@", "public", "void", "writeData", "(", "final", "NextFilter", "nextFilter", ",", "final", "IoSession", "session", ",", "fina", "/", "/", "Handshake", "is", "done", "-", "write", "data", "as", "normal", "nextFilter", ".", "filterWrite", "(", "session", ",", "writeRequest", ")", ";", "}", "else", "if", "(", "isHandshakeData", ")", "{", "LOGGER", ".", "debug", "(", "\"", "handshake", "data", ":", "{", "}\"", ",", "writeRequest", ".", "getMessage", "(", "))", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "handshake", "data", ":", "{", "}\"", ",", "writeRequest", ".", "getMessage", "(", "))", ";", "}", "/", "/", "Writing", "handshake", "data", "nextFilter", ".", "filterWrite", "(", "session", ",", "writeRequest", ")", ";", "}", "else", "{", "/", "/", "Writing", "non", "-", "handshake", "data", "before", "the", "handshake", "finished", "if", "(", "!", "session", ".", "isConnected", "(", "))", "{", "/", "/", "Not", "even", "connected", "-", "ignore", "LOGGER", ".", "debug", "(", "\"", "Write", "request", "on", "closed", "session", ".", "Request", "ignored", ".", "\")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Write", "request", "on", "closed", "session", ".", "Request", "ignored", ".", "\")", ";", "}", "}", "else", "{", "/", "/", "Queue", "the", "data", "to", "be", "sent", "as", "soon", "as", "the", "handshake", "completes", "LOGGER", ".", "debug", "(", "\"", "Handshaking", "is", "not", "complete", "yet", ".", "Buffering", "write", "request", ".", "\")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Handshaking", "is", "not", "complete", "yet", ".", "Buffering", "write", "request", ".", "\")", ";", "}", "handler", ".", "enqueueWriteRequest", "(", "nextFilter", ",", "writeRequest", ")", ";", "}", "}", "@", "@", "-", "263", ",", "9", "+", "276", ",", "16", "@", "@", "public", "void", "messageSent", "(", "final", "NextFilter", "nextFilter", ",", "final", "IoSession", "session", ",", "fi", "*", "/", "@", "Override", "public", "void", "sessionCreated", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ")", "throws", "Exception", "{", "LOGGER", ".", "debug", "(", "\"", "Session", "created", ":", "\"", "+", "session", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Session", "created", ":", "\"", "+", "session", ")", ";", "}", "ProxyIoSession", "proxyIoSession", "=", "(", "ProxyIoSession", ")", "session", ".", "getAttribute", "(", "ProxyIoSession", ".", "PROXY_SESSION", ")", ";", "LOGGER", ".", "debug", "(", "\"", "get", "proxyIoSession", ":", "\"", "+", "proxyIoSession", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "get", "proxyIoSession", ":", "\"", "+", "proxyIoSession", ")", ";", "}", "proxyIoSession", ".", "setProxyFilter", "(", "this", ")", ";", "/", "/", "Create", "a", "HTTP", "proxy", "handler", "and", "start", "handshake", ".", "@", "@", "-", "38", ",", "8", "+", "38", ",", "8", "@", "@", "*", "@", "since", "MINA", "2", ".", "0", ".", "0", "-", "M3", "*", "/", "public", "abstract", "class", "AbstractAuthLogicHandler", "{", "private", "static", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "AbstractAuthLogicHandler", ".", "class", ")", ";", "private", "static", "final", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "AbstractAuthLogicHandler", ".", "class", ")", ";", "/", "**", "*", "The", "request", "to", "be", "handled", "by", "the", "proxy", ".", "*", "/", "@", "@", "-", "94", ",", "7", "+", "94", ",", "9", "@", "@", "protected", "AbstractAuthLogicHandler", "(", "final", "ProxyIoSession", "proxyIoSession", ")", "throws", "P", "*", "@", "throws", "ProxyAuthException", "If", "we", "get", "an", "error", "during", "the", "proxy", "authentication", "*", "/", "protected", "void", "writeRequest", "(", "final", "NextFilter", "nextFilter", ",", "final", "HttpProxyRequest", "request", ")", "throws", "ProxyAuthException", "{", "logger", ".", "debug", "(", "\"", "sending", "HTTP", "request", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "sending", "HTTP", "request", "\"", ");", "}", "(", "(", "AbstractHttpLogicHandler", ")", "proxyIoSession", ".", "getHandler", "(", "))", ".", "writeRequest", "(", "nextFilter", ",", "request", ")", ";", "}", "@", "@", "-", "115", ",", "7", "+", "115", ",", "9", "@", "@", "public", "AbstractHttpLogicHandler", "(", "final", "ProxyIoSession", "proxyIoSession", ")", "{", "*", "/", "@", "Override", "public", "synchronized", "void", "messageReceived", "(", "final", "NextFilter", "nextFilter", ",", "final", "IoBuffer", "buf", ")", "throws", "ProxyAuthException", "{", "LOGGER", ".", "debug", "(", "\"", "messageReceived", "(", ")\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "messageReceived", "(", ")\"", ");", "}", "IoBufferDecoder", "decoder", "=", "(", "IoBufferDecoder", ")", "getSession", "(", ").", "getAttribute", "(", "DECODER", ")", ";", "if", "(", "decoder", "=", "=", "null", ")", "{", "@", "@", "-", "135", ",", "8", "+", "137", ",", "10", "@", "@", "public", "synchronized", "void", "messageReceived", "(", "final", "NextFilter", "nextFilter", ",", "final", "IoBu", "String", "responseHeader", "=", "responseData", ".", "getString", "(", "getProxyIoSession", "(", ").", "getCharset", "(", ").", "newDecoder", "(", "))", ";", "entityBodyStartPosition", "=", "responseData", ".", "position", "(", ");", "LOGGER", ".", "debug", "(", "\"", "response", "header", "received", ":", "\\", "n", "{", "}\"", ",", "responseHeader", ".", "replace", "(", "\"\\", "r", "\"", ",", "\"", "\\\\", "r", "\"", ").", "replace", "(", "\"\\", "n", "\"", ",", "\"", "\\\\", "n", "\\", "n", "\"", "))", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "response", "header", "received", ":", "\\", "n", "{", "}\"", ",", "responseHeader", ".", "replace", "(", "\"\\", "r", "\"", ",", "\"", "\\\\", "r", "\"", ").", "replace", "(", "\"\\", "n", "\"", ",", "\"", "\\\\", "n", "\\", "n", "\"", "))", ";", "}", "/", "/", "Parse", "the", "response", "parsedResponse", "=", "decodeResponse", "(", "responseHeader", ")", ";", "@", "@", "-", "174", ",", "7", "+", "178", ",", "10", "@", "@", "public", "synchronized", "void", "messageReceived", "(", "final", "NextFilter", "nextFilter", ",", "final", "IoBu", "if", "(", "\"", "chunked", "\"", ".", "equalsIgnoreCase", "(", "StringUtilities", ".", "getSingleValuedHeader", "(", "parsedResponse", ".", "getHeaders", "(", "),", "\"", "Transfer", "-", "Encoding", "\"", "))", ")", "{", "/", "/", "Handle", "Transfer", "-", "Encoding", ":", "Chunked", "LOGGER", ".", "debug", "(", "\"", "Retrieving", "additional", "http", "response", "chunks", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Retrieving", "additional", "http", "response", "chunks", "\"", ");", "}", "hasChunkedData", "=", "true", ";", "waitingChunkedData", "=", "true", ";", "}", "@", "@", "-", "244", ",", "8", "+", "251", ",", "10", "@", "@", "public", "synchronized", "void", "messageReceived", "(", "final", "NextFilter", "nextFilter", ",", "final", "IoBu", "responseData", ".", "flip", "(", ");", "LOGGER", ".", "debug", "(", "\"", "end", "of", "response", "received", ":", "\\", "n", "{", "}\"", ",", "responseData", ".", "getString", "(", "getProxyIoSession", "(", ").", "getCharset", "(", ").", "newDecoder", "(", "))", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "end", "of", "response", "received", ":", "\\", "n", "{", "}\"", ",", "responseData", ".", "getString", "(", "getProxyIoSession", "(", ").", "getCharset", "(", ").", "newDecoder", "(", "))", ");", "}", "/", "/", "Retrieve", "entity", "body", "content", "responseData", ".", "position", "(", "entityBodyStartPosition", ")", ";", "@", "@", "-", "311", ",", "7", "+", "320", ",", "9", "@", "@", "private", "void", "writeRequest0", "(", "final", "NextFilter", "nextFilter", ",", "final", "HttpProxyRequest", "r", "String", "data", "=", "request", ".", "toHttpString", "(", ");", "IoBuffer", "buf", "=", "IoBuffer", ".", "wrap", "(", "data", ".", "getBytes", "(", "getProxyIoSession", "(", ").", "getCharsetName", "(", "))", ");", "LOGGER", ".", "debug", "(", "\"", "write", ":", "\\", "n", "{", "}\"", ",", "data", ".", "replace", "(", "\"\\", "r", "\"", ",", "\"", "\\\\", "r", "\"", ").", "replace", "(", "\"\\", "n", "\"", ",", "\"", "\\\\", "n", "\\", "n", "\"", "))", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "write", ":", "\\", "n", "{", "}\"", ",", "data", ".", "replace", "(", "\"\\", "r", "\"", ",", "\"", "\\\\", "r", "\"", ").", "replace", "(", "\"\\", "n", "\"", ",", "\"", "\\\\", "n", "\\", "n", "\"", "))", ";", "}", "writeData", "(", "nextFilter", ",", "buf", ")", ";", "@", "@", "-", "328", ",", "18", "+", "339", ",", "27", "@", "@", "private", "void", "writeRequest0", "(", "final", "NextFilter", "nextFilter", ",", "final", "HttpProxyRequest", "r", "*", "@", "param", "request", "the", "http", "request", "*", "/", "private", "void", "reconnect", "(", "final", "NextFilter", "nextFilter", ",", "final", "HttpProxyRequest", "request", ")", "{", "LOGGER", ".", "debug", "(", "\"", "Reconnecting", "to", "proxy", ".", "..", "\")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Reconnecting", "to", "proxy", ".", "..", "\")", ";", "}", "final", "ProxyIoSession", "proxyIoSession", "=", "getProxyIoSession", "(", ");", "/", "/", "Fires", "reconnection", "proxyIoSession", ".", "getConnector", "(", ").", "connect", "(", "new", "IoSessionInitializer", "<", "ConnectFuture", ">", "()", "{", "@", "Override", "public", "void", "initializeSession", "(", "final", "IoSession", "session", ",", "ConnectFuture", "future", ")", "{", "LOGGER", ".", "debug", "(", "\"", "Initializing", "new", "session", ":", "{", "}\"", ",", "session", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Initializing", "new", "session", ":", "{", "}\"", ",", "session", ")", ";", "}", "session", ".", "setAttribute", "(", "ProxyIoSession", ".", "PROXY_SESSION", ",", "proxyIoSession", ")", ";", "proxyIoSession", ".", "setSession", "(", "session", ")", ";", "LOGGER", ".", "debug", "(", "\"", "setting", "up", "proxyIoSession", ":", "{", "}\"", ",", "proxyIoSession", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "setting", "up", "proxyIoSession", ":", "{", "}\"", ",", "proxyIoSession", ")", ";", "}", "/", "/", "Reconnection", "is", "done", "so", "we", "send", "the", "/", "/", "request", "to", "the", "proxy", "proxyIoSession", ".", "setReconnectionNeeded", "(", "false", ")", ";", "@", "@", "-", "356", ",", "7", "+", "376", ",", "9", "@", "@", "public", "void", "initializeSession", "(", "final", "IoSession", "session", ",", "ConnectFuture", "future", ")", "{", "*", "@", "throws", "Exception", "If", "we", "get", "an", "error", "while", "decoding", "the", "response", "*", "/", "protected", "HttpProxyResponse", "decodeResponse", "(", "final", "String", "response", ")", "throws", "Exception", "{", "LOGGER", ".", "debug", "(", "\"", "parseResponse", "(", ")\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "parseResponse", "(", ")\"", ");", "}", "/", "/", "Break", "response", "into", "lines", "String", "[", "]", "responseLines", "=", "response", ".", "split", "(", "HttpProxyConstants", ".", "CRLF", ")", ";", "@", "@", "-", "37", ",", "8", "+", "37", ",", "8", "@", "@", "*", "@", "since", "MINA", "2", ".", "0", ".", "0", "-", "M3", "*", "/", "public", "class", "HttpProxyRequest", "extends", "ProxyRequest", "{", "private", "static", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "HttpProxyRequest", ".", "class", ")", ";", "private", "static", "final", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "HttpProxyRequest", ".", "class", ")", ";", "/", "**", "*", "The", "HTTP", "verb", ".", "*", "/", "@", "@", "-", "199", ",", "7", "+", "199", ",", "9", "@", "@", "public", "final", "synchronized", "String", "getHost", "(", ")", "{", "try", "{", "host", "=", "(", "new", "URL", "(", "httpURI", ")", ").", "getHost", "(", ");", "}", "catch", "(", "MalformedURLException", "e", ")", "{", "logger", ".", "debug", "(", "\"", "Malformed", "URL", "\"", ",", "e", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Malformed", "URL", "\"", ",", "e", ")", ";", "}", "}", "}", "}", "@", "@", "-", "38", ",", "8", "+", "38", ",", "8", "@", "@", "*", "@", "since", "MINA", "2", ".", "0", ".", "0", "-", "M3", "*", "/", "public", "class", "HttpSmartProxyHandler", "extends", "AbstractHttpLogicHandler", "{", "private", "static", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "HttpSmartProxyHandler", ".", "class", ")", ";", "private", "static", "final", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "HttpSmartProxyHandler", ".", "class", ")", ";", "/", "**", "*", "Has", "the", "HTTP", "proxy", "request", "been", "sent", "?", "*", "/", "@", "@", "-", "66", ",", "7", "+", "66", ",", "9", "@", "@", "public", "HttpSmartProxyHandler", "(", "final", "ProxyIoSession", "proxyIoSession", ")", "{", "*", "/", "@", "Override", "public", "void", "doHandshake", "(", "final", "NextFilter", "nextFilter", ")", "throws", "ProxyAuthException", "{", "logger", ".", "debug", "(", "\"", "doHandshake", "(", ")\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "doHandshake", "(", ")\"", ");", "}", "if", "(", "authHandler", "!", "=", "null", ")", "{", "authHandler", ".", "doHandshake", "(", "nextFilter", ")", ";", "@", "@", "-", "76", ",", "7", "+", "78", ",", "9", "@", "@", "public", "void", "doHandshake", "(", "final", "NextFilter", "nextFilter", ")", "throws", "ProxyAuthException", "{", "throw", "new", "ProxyAuthException", "(", "\"", "Authentication", "request", "already", "sent", "\"", ");", "}", "logger", ".", "debug", "(", "\"", "sending", "HTTP", "request", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "sending", "HTTP", "request", "\"", ");", "}", "/", "/", "Compute", "request", "headers", "HttpProxyRequest", "req", "=", "(", "HttpProxyRequest", ")", "getProxyIoSession", "(", ").", "getRequest", "(", ");", "@", "@", "-", "130", ",", "7", "+", "134", ",", "9", "@", "@", "private", "void", "autoSelectAuthHandler", "(", "final", "HttpProxyResponse", "response", ")", "throws", "Prox", "try", "{", "authHandler", "=", "HttpAuthenticationMethods", ".", "getNewHandler", "(", "method", ",", "proxyIoSession", ")", ";", "}", "catch", "(", "Exception", "ex", ")", "{", "logger", ".", "debug", "(", "\"", "Following", "exception", "occured", ":", "\",", "ex", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Following", "exception", "occured", ":", "\",", "ex", ")", ";", "}", "}", "}", "@", "@", "-", "165", ",", "7", "+", "171", ",", "9", "@", "@", "private", "void", "autoSelectAuthHandler", "(", "final", "HttpProxyResponse", "response", ")", "throws", "Prox", "break", ";", "}", "}", "catch", "(", "Exception", "ex", ")", "{", "logger", ".", "debug", "(", "\"", "Following", "exception", "occured", ":", "\",", "ex", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Following", "exception", "occured", ":", "\",", "ex", ")", ";", "}", "}", "}", "}", "@", "@", "-", "42", ",", "8", "+", "42", ",", "8", "@", "@", "*", "@", "since", "MINA", "2", ".", "0", ".", "0", "-", "M3", "*", "/", "public", "class", "HttpBasicAuthLogicHandler", "extends", "AbstractAuthLogicHandler", "{", "private", "static", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "HttpBasicAuthLogicHandler", ".", "class", ")", ";", "private", "static", "final", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "HttpBasicAuthLogicHandler", ".", "class", ")", ";", "/", "**", "*", "Build", "an", "HttpBasicAuthLogicHandler", "*", "@", "@", "-", "62", ",", "7", "+", "62", ",", "9", "@", "@", "public", "HttpBasicAuthLogicHandler", "(", "final", "ProxyIoSession", "proxyIoSession", ")", "throws", "Pro", "*", "/", "@", "Override", "public", "void", "doHandshake", "(", "final", "NextFilter", "nextFilter", ")", "throws", "ProxyAuthException", "{", "logger", ".", "debug", "(", "\"", "doHandshake", "(", ")\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "doHandshake", "(", ")\"", ");", "}", "if", "(", "step", ">", "0", ")", "{", "throw", "new", "ProxyAuthException", "(", "\"", "Authentication", "request", "already", "sent", "\"", ");", "@", "@", "-", "35", ",", "8", "+", "35", ",", "8", "@", "@", "*", "@", "since", "MINA", "2", ".", "0", ".", "0", "-", "M3", "*", "/", "public", "class", "HttpNoAuthLogicHandler", "extends", "AbstractAuthLogicHandler", "{", "private", "static", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "HttpNoAuthLogicHandler", ".", "class", ")", ";", "private", "static", "final", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "HttpNoAuthLogicHandler", ".", "class", ")", ";", "/", "**", "*", "Build", "an", "HttpNoAuthLogicHandler", "*", "@", "@", "-", "52", ",", "7", "+", "52", ",", "9", "@", "@", "public", "HttpNoAuthLogicHandler", "(", "final", "ProxyIoSession", "proxyIoSession", ")", "throws", "ProxyA", "*", "/", "@", "Override", "public", "void", "doHandshake", "(", "final", "NextFilter", "nextFilter", ")", "throws", "ProxyAuthException", "{", "logger", ".", "debug", "(", "\"", "doHandshake", "(", ")\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "doHandshake", "(", ")\"", ");", "}", "/", "/", "Just", "send", "the", "request", ",", "no", "authentication", "needed", "writeRequest", "(", "nextFilter", ",", "(", "HttpProxyRequest", ")", "request", ")", ";", "@", "@", "-", "47", ",", "9", "+", "47", ",", "8", "@", "@", "*", "@", "since", "MINA", "2", ".", "0", ".", "0", "-", "M3", "*", "/", "public", "class", "HttpDigestAuthLogicHandler", "extends", "AbstractAuthLogicHandler", "{", "private", "static", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "HttpDigestAuthLogicHandler", ".", "class", ")", ";", "private", "static", "final", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "HttpDigestAuthLogicHandler", ".", "class", ")", ";", "/", "**", "*", "The", "challenge", "directives", "provided", "by", "the", "server", ".", "*", "/", "@", "@", "-", "89", ",", "7", "+", "88", ",", "9", "@", "@", "public", "HttpDigestAuthLogicHandler", "(", "ProxyIoSession", "proxyIoSession", ")", "throws", "ProxyAut", "*", "/", "@", "Override", "public", "void", "doHandshake", "(", "NextFilter", "nextFilter", ")", "throws", "ProxyAuthException", "{", "logger", ".", "debug", "(", "\"", "doHandshake", "(", ")\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "doHandshake", "(", ")\"", ");", "}", "if", "(", "step", ">", "0", "&", "&", "directives", "=", "=", "null", ")", "{", "throw", "new", "ProxyAuthException", "(", "\"", "Authentication", "challenge", "not", "received", "\"", ");", "@", "@", "-", "100", ",", "7", "+", "101", ",", "9", "@", "@", "public", "void", "doHandshake", "(", "NextFilter", "nextFilter", ")", "throws", "ProxyAuthException", "{", ":", "new", "HashMap", "<", "String", ",", "List", "<", "String", ">", ">(", ");", "if", "(", "step", ">", "0", ")", "{", "logger", ".", "debug", "(", "\"", "sending", "DIGEST", "challenge", "response", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "sending", "DIGEST", "challenge", "response", "\"", ");", "}", "/", "/", "Build", "a", "challenge", "response", "HashMap", "<", "String", ",", "String", ">", "map", "=", "new", "HashMap", "<", ">(", ");", "@", "@", "-", "70", ",", "7", "+", "70", ",", "9", "@", "@", "public", "HttpNTLMAuthLogicHandler", "(", "final", "ProxyIoSession", "proxyIoSession", ")", "throws", "Prox", "*", "/", "@", "Override", "public", "void", "doHandshake", "(", "NextFilter", "nextFilter", ")", "throws", "ProxyAuthException", "{", "LOGGER", ".", "debug", "(", "\"", "doHandshake", "(", ")\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "doHandshake", "(", ")\"", ");", "}", "if", "(", "step", ">", "0", "&", "&", "challengePacket", "=", "=", "null", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "NTLM", "Challenge", "packet", "not", "received", "\"", ");", "@", "@", "-", "84", ",", "7", "+", "86", ",", "9", "@", "@", "public", "void", "doHandshake", "(", "NextFilter", "nextFilter", ")", "throws", "ProxyAuthException", "{", "String", "workstation", "=", "req", ".", "getProperties", "(", ").", "get", "(", "HttpProxyConstants", ".", "WORKSTATION_PROPERTY", ")", ";", "if", "(", "step", ">", "0", ")", "{", "LOGGER", ".", "debug", "(", "\"", "sending", "NTLM", "challenge", "response", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "sending", "NTLM", "challenge", "response", "\"", ");", "}", "byte", "[", "]", "challenge", "=", "NTLMUtilities", ".", "extractChallengeFromType2Message", "(", "challengePacket", ")", ";", "int", "serverFlags", "=", "NTLMUtilities", ".", "extractFlagsFromType2Message", "(", "challengePacket", ")", ";", "@", "@", "-", "99", ",", "7", "+", "103", ",", "9", "@", "@", "public", "void", "doHandshake", "(", "NextFilter", "nextFilter", ")", "throws", "ProxyAuthException", "{", "\"", "NTLM", "\"", "+", "new", "String", "(", "Base64", ".", "encodeBase64", "(", "authenticationPacket", ")", "),", "true", ")", ";", "}", "else", "{", "LOGGER", ".", "debug", "(", "\"", "sending", "NTLM", "negotiation", "packet", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "sending", "NTLM", "negotiation", "packet", "\"", ");", "}", "byte", "[", "]", "negotiationPacket", "=", "NTLMUtilities", ".", "createType1Message", "(", "workstation", ",", "domain", ",", "null", ",", "null", ")", ";", "StringUtilities", ".", "addValueToHeader", "(", "headers", ",", "\"", "Proxy", "-", "Authorization", "\"", ",", "@", "@", "-", "35", ",", "9", "+", "35", ",", "8", "@", "@", "*", "@", "since", "MINA", "2", ".", "0", ".", "0", "-", "M3", "*", "/", "public", "class", "Socks4LogicHandler", "extends", "AbstractSocksLogicHandler", "{", "private", "static", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "Socks4LogicHandler", ".", "class", ")", ";", "private", "static", "final", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "Socks4LogicHandler", ".", "class", ")", ";", "/", "**", "*", "@", "see", "AbstractSocksLogicHandler", "#", "AbstractSocksLogicHandler", "(", "ProxyIoSession", ")", "*", "@", "@", "-", "54", ",", "7", "+", "53", ",", "9", "@", "@", "public", "Socks4LogicHandler", "(", "final", "ProxyIoSession", "proxyIoSession", ")", "{", "*", "/", "@", "Override", "public", "void", "doHandshake", "(", "final", "NextFilter", "nextFilter", ")", "{", "logger", ".", "debug", "(", "\"", "doHandshake", "(", ")\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "doHandshake", "(", ")\"", ");", "}", "/", "/", "Send", "request", "writeRequest", "(", "nextFilter", ",", "request", ")", ";", "@", "@", "-", "93", ",", "10", "+", "94", ",", "12", "@", "@", "protected", "void", "writeRequest", "(", "final", "NextFilter", "nextFilter", ",", "final", "SocksProxyRequest", "buf", ".", "put", "(", "SocksProxyConstants", ".", "TERMINATOR", ")", ";", "}", "if", "(", "isV4ARequest", ")", "{", "logger", ".", "debug", "(", "\"", "sending", "SOCKS4a", "request", "\"", ");", "}", "else", "{", "logger", ".", "debug", "(", "\"", "sending", "SOCKS4", "request", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "if", "(", "isV4ARequest", ")", "{", "LOGGER", ".", "debug", "(", "\"", "sending", "SOCKS4a", "request", "\"", ");", "}", "else", "{", "LOGGER", ".", "debug", "(", "\"", "sending", "SOCKS4", "request", "\"", ");", "}", "}", "buf", ".", "flip", "(", ");", "@", "@", "-", "83", ",", "7", "+", "83", ",", "9", "@", "@", "public", "Socks5LogicHandler", "(", "final", "ProxyIoSession", "proxyIoSession", ")", "{", "*", "/", "@", "Override", "public", "synchronized", "void", "doHandshake", "(", "final", "NextFilter", "nextFilter", ")", "{", "LOGGER", ".", "debug", "(", "\"", "doHandshake", "(", ")\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "doHandshake", "(", ")\"", ");", "}", "/", "/", "Send", "request", "writeRequest", "(", "nextFilter", ",", "request", ",", "(", "(", "Integer", ")", "getSession", "(", ").", "getAttribute", "(", "HANDSHAKE_STEP", ")", ").", "intValue", "(", "))", ";", "@", "@", "-", "236", ",", "7", "+", "238", ",", "9", "@", "@", "private", "IoBuffer", "encodeGSSAPIAuthenticationPacket", "(", "final", "SocksProxyRequest", "reques", "byte", "[", "]", "token", "=", "(", "byte", "[", "])", "getSession", "(", ").", "getAttribute", "(", "GSS_TOKEN", ")", ";", "if", "(", "token", "!", "=", "null", ")", "{", "LOGGER", ".", "debug", "(", "\"", "Received", "Token", "[", "{}", "]", "=", "{", "}\"", ",", "token", ".", "length", ",", "ByteUtilities", ".", "asHex", "(", "token", ")", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Received", "Token", "[", "{}", "]", "=", "{", "}\"", ",", "token", ".", "length", ",", "ByteUtilities", ".", "asHex", "(", "token", ")", ");", "}", "}", "IoBuffer", "buf", "=", "null", ";", "@", "@", "-", "251", ",", "7", "+", "255", ",", "9", "@", "@", "private", "IoBuffer", "encodeGSSAPIAuthenticationPacket", "(", "final", "SocksProxyRequest", "reques", "/", "/", "Send", "a", "token", "to", "the", "server", "if", "one", "was", "generated", "by", "/", "/", "initSecContext", "if", "(", "token", "!", "=", "null", ")", "{", "LOGGER", ".", "debug", "(", "\"", "Sending", "Token", "[", "{}", "]", "=", "{", "}\"", ",", "token", ".", "length", ",", "ByteUtilities", ".", "asHex", "(", "token", ")", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Sending", "Token", "[", "{}", "]", "=", "{", "}\"", ",", "token", ".", "length", ",", "ByteUtilities", ".", "asHex", "(", "token", ")", ");", "}", "getSession", "(", ").", "setAttribute", "(", "GSS_TOKEN", ",", "token", ")", ";", "buf", "=", "IoBuffer", ".", "allocate", "(", "4", "+", "token", ".", "length", ")", ";", "@", "@", "-", "401", ",", "7", "+", "407", ",", "9", "@", "@", "protected", "void", "handleResponse", "(", "final", "NextFilter", "nextFilter", ",", "final", "IoBuffer", "buf", ",", "i", "if", "(", "buf", ".", "remaining", "(", ")", ">", "=", "len", ")", "{", "/", "/", "handle", "response", "byte", "status", "=", "buf", ".", "get", "(", "1", ")", ";", "LOGGER", ".", "debug", "(", "\"", "response", "status", ":", "{", "}\"", ",", "SocksProxyConstants", ".", "getReplyCodeAsString", "(", "status", ")", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "response", "status", ":", "{", "}\"", ",", "SocksProxyConstants", ".", "getReplyCodeAsString", "(", "status", ")", ");", "}", "if", "(", "status", "=", "=", "SocksProxyConstants", ".", "V5_REPLY_SUCCEEDED", ")", "{", "buf", ".", "position", "(", "buf", ".", "position", "(", ")", "+", "len", ")", ";", "@", "@", "-", "55", ",", "14", "+", "55", ",", "20", "@", "@", "public", "void", "testBasicBuffering", "(", ")", "{", "@", "Override", "public", "void", "filterClose", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ")", "throws", "Exception", "{", "LOGGER", ".", "debug", "(", "\"", "Filter", "closed", "!", "\")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Filter", "closed", "!", "\")", ";", "}", "assertEquals", "(", "3", ",", "counter", ")", ";", "}", "@", "Override", "public", "void", "filterWrite", "(", "NextFilter", "nextFilter", ",", "IoSession", "session", ",", "WriteRequest", "writeRequest", ")", "throws", "Exception", "{", "LOGGER", ".", "debug", "(", "\"", "New", "buffered", "message", "written", "!", "\")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "New", "buffered", "message", "written", "!", "\")", ";", "}", "counter", "+", "+;", "try", "{", "IoBuffer", "buf", "=", "(", "IoBuffer", ")", "writeRequest", ".", "getMessage", "(", ");", "@", "@", "-", "21", ",", "7", "+", "21", ",", "7", "@", "@", "<", "parent", ">", "<", "groupId", ">", "org", ".", "apache", ".", "mina", "<", "/", "groupId", ">", "<", "artifactId", ">", "mina", "-", "parent", "<", "/", "artifactId", ">", "<", "version", ">", "2", ".", "0", ".", "21", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "2", ".", "0", ".", "20", "<", "/", "version", ">", "<", "/", "parent", ">", "<", "artifactId", ">", "mina", "-", "example", "<", "/", "artifactId", ">", "@", "@", "-", "38", ",", "7", "+", "38", ",", "7", "@", "@", "public", "static", "final", "String", "OTHER_IO_SESSION", "=", "AbstractProxyIoHandler", ".", "class", ".", "getName", "(", ")+", "\".", "OtherIoSession", "\"", ";", "private", "final", "static", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "AbstractProxyIoHandler", ".", "class", ")", ";", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/", "@", "@", "-", "24", ",", "7", "+", "24", ",", "7", "@", "@", "<", "parent", ">", "<", "groupId", ">", "org", ".", "apache", ".", "mina", "<", "/", "groupId", ">", "<", "artifactId", ">", "mina", "-", "parent", "<", "/", "artifactId", ">", "<", "version", ">", "2", ".", "0", ".", "21", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "2", ".", "0", ".", "20", "<", "/", "version", ">", "<", "/", "parent", ">", "<", "artifactId", ">", "mina", "-", "filter", "-", "compression", "<", "/", "artifactId", ">", "@", "@", "-", "65", ",", "13", "+", "65", ",", "13", "@", "@", "org", ".", "apache", ".", "mina", ".", "filter", ".", "compression", ";", "version", "=", "${", "project", ".", "version", "}", ";-", "noimport", ":", "=", "true", "<", "/", "Export", "-", "Package", ">", "<", "Import", "-", "Package", ">", "org", ".", "apache", ".", "mina", ".", "core", ".", "buffer", ";", "version", "=", "${", "project", ".", "version", "}", ",", "org", ".", "apache", ".", "mina", ".", "core", ".", "filterchain", ";", "version", "=", "${", "project", ".", "version", "}", ",", "org", ".", "apache", ".", "mina", ".", "core", ".", "session", ";", "version", "=", "${", "project", ".", "version", "}", ",", "org", ".", "apache", ".", "mina", ".", "core", ".", "write", ";", "version", "=", "${", "project", ".", "version", "}", ",", "org", ".", "apache", ".", "mina", ".", "filter", ".", "util", ";", "version", "=", "${", "project", ".", "version", "}", ",", "com", ".", "jcraft", ".", "jzlib", ";", "version", "=", "${", "version", ".", "jzlib", "}", ",", "org", ".", "slf4j", ";", "version", "=", "${", "osgi", "-", "min", "-", "version", ".", "slf4j", ".", "api", "}", "org", ".", "apache", ".", "mina", ".", "core", ".", "buffer", ";", "version", "=", "${", "project", ".", "version", "}", ",", "org", ".", "apache", ".", "mina", ".", "core", ".", "filterchain", ";", "version", "=", "${", "project", ".", "version", "}", ",", "org", ".", "apache", ".", "mina", ".", "core", ".", "session", ";", "version", "=", "${", "project", ".", "version", "}", ",", "org", ".", "apache", ".", "mina", ".", "core", ".", "write", ";", "version", "=", "${", "project", ".", "version", "}", ",", "org", ".", "apache", ".", "mina", ".", "filter", ".", "util", ";", "version", "=", "${", "project", ".", "version", "}", ",", "com", ".", "jcraft", ".", "jzlib", ";", "version", "=", "${", "version", ".", "jzlib", "}", ",", "org", ".", "slf4j", ";", "version", "=", "${", "osgi", "-", "min", "-", "version", ".", "slf4j", ".", "api", "}", "<", "/", "Import", "-", "Package", ">", "<", "/", "instructions", ">", "<", "/", "configuration", ">", "@", "@", "-", "153", ",", "6", "+", "153", ",", "8", "@", "@", "public", "IoBuffer", "inflate", "(", "IoBuffer", "inBuffer", ")", "throws", "IOException", "{", "}", "}", "}", "while", "(", "zStream", ".", "avail_in", ">", "0", ")", ";", "cleanUp", "(", ");", "}", "return", "outBuffer", ".", "flip", "(", ");", "@", "@", "-", "197", ",", "6", "+", "199", ",", "8", "@", "@", "public", "IoBuffer", "deflate", "(", "IoBuffer", "inBuffer", ")", "throws", "IOException", "{", "}", "IoBuffer", "outBuf", "=", "IoBuffer", ".", "wrap", "(", "outBytes", ",", "0", ",", "zStream", ".", "next_out_index", ")", ";", "cleanUp", "(", ");", "return", "outBuf", ";", "}", "@", "@", "-", "24", ",", "7", "+", "24", ",", "7", "@", "@", "<", "parent", ">", "<", "groupId", ">", "org", ".", "apache", ".", "mina", "<", "/", "groupId", ">", "<", "artifactId", ">", "mina", "-", "parent", "<", "/", "artifactId", ">", "<", "version", ">", "2", ".", "0", ".", "21", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "2", ".", "0", ".", "20", "<", "/", "version", ">", "<", "/", "parent", ">", "<", "artifactId", ">", "mina", "-", "http", "<", "/", "artifactId", ">", "@", "@", "-", "41", ",", "8", "+", "41", ",", "8", "@", "@", "*", "@", "author", "<", "a", "href", "=", "\"", "http", ":", "//", "mina", ".", "apache", ".", "org", "\"", ">", "Apache", "MINA", "Project", "<", "/", "a", ">", "*", "/", "public", "class", "HttpClientDecoder", "implements", "ProtocolDecoder", "{", "private", "static", "final", "Logger", "LOG", "=", "LoggerFactory", ".", "getLogger", "(", "HttpClientCodec", ".", "class", ")", ";", "private", "static", "final", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "HttpClientCodec", ".", "class", ")", ";", "/", "**", "Key", "for", "decoder", "current", "state", "*", "/", "private", "static", "final", "String", "DECODER_STATE_ATT", "=", "\"", "http", ".", "ds", "\"", ";", "@", "@", "-", "96", ",", "15", "+", "96", ",", "21", "@", "@", "public", "void", "decode", "(", "IoSession", "session", ",", "IoBuffer", "msg", ",", "ProtocolDecoderOutput", "out", ")", "{", "switch", "(", "state", ")", "{", "case", "HEAD", ":", "LOG", ".", "debug", "(", "\"", "decoding", "HEAD", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "decoding", "HEAD", "\"", ");", "}", "/", "/", "grab", "the", "stored", "a", "partial", "HEAD", "request", "ByteBuffer", "oldBuffer", "=", "(", "ByteBuffer", ")", "session", ".", "getAttribute", "(", "PARTIAL_HEAD_ATT", ")", ";", "/", "/", "concat", "the", "old", "buffer", "and", "the", "new", "incoming", "one", "IoBuffer", ".", "allocate", "(", "oldBuffer", ".", "remaining", "(", ")", "+", "msg", ".", "remaining", "(", "))", ".", "put", "(", "oldBuffer", ")", ".", "put", "(", "msg", ")", ".", "flip", "(", ");", "/", "/", "now", "let", "'", "s", "decode", "like", "it", "was", "a", "new", "message", "case", "NEW", ":", "LOG", ".", "debug", "(", "\"", "decoding", "NEW", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "decoding", "NEW", "\"", ");", "}", "DefaultHttpResponse", "rp", "=", "parseHttpReponseHead", "(", "msg", ".", "buf", "(", "))", ";", "if", "(", "rp", "=", "=", "null", ")", "{", "@", "@", "-", "118", ",", "16", "+", "124", ",", "25", "@", "@", "public", "void", "decode", "(", "IoSession", "session", ",", "IoBuffer", "msg", ",", "ProtocolDecoderOutput", "out", ")", "{", "}", "else", "{", "out", ".", "write", "(", "rp", ")", ";", "/", "/", "is", "it", "a", "response", "with", "some", "body", "content", "?", "LOG", ".", "debug", "(", "\"", "response", "with", "content", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "response", "with", "content", "\"", ");", "}", "session", ".", "setAttribute", "(", "DECODER_STATE_ATT", ",", "DecoderState", ".", "BODY", ")", ";", "String", "contentLen", "=", "rp", ".", "getHeader", "(", "\"", "content", "-", "length", "\"", ");", "if", "(", "contentLen", "!", "=", "null", ")", "{", "LOG", ".", "debug", "(", "\"", "found", "content", "len", ":", "{", "}\"", ",", "contentLen", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "found", "content", "len", ":", "{", "}\"", ",", "contentLen", ")", ";", "}", "session", ".", "setAttribute", "(", "BODY_REMAINING_BYTES", ",", "Integer", ".", "valueOf", "(", "contentLen", ")", ");", "}", "else", "if", "(", "\"", "chunked", "\"", ".", "equalsIgnoreCase", "(", "rp", ".", "getHeader", "(", "\"", "transfer", "-", "encoding", "\"", "))", ")", "{", "LOG", ".", "debug", "(", "\"", "no", "content", "len", "but", "chunked", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "no", "content", "len", "but", "chunked", "\"", ");", "}", "session", ".", "setAttribute", "(", "BODY_CHUNKED", ",", "Boolean", ".", "TRUE", ")", ";", "}", "else", "if", "(", "\"", "close", "\"", ".", "equalsIgnoreCase", "(", "rp", ".", "getHeader", "(", "\"", "connection", "\"", "))", ")", "{", "session", ".", "closeNow", "(", ");", "@", "@", "-", "139", ",", "7", "+", "154", ",", "10", "@", "@", "public", "void", "decode", "(", "IoSession", "session", ",", "IoBuffer", "msg", ",", "ProtocolDecoderOutput", "out", ")", "{", "break", ";", "case", "BODY", ":", "LOG", ".", "debug", "(", "\"", "decoding", "BODY", ":", "{", "}", "bytes", "\"", ",", "msg", ".", "remaining", "(", "))", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "decoding", "BODY", ":", "{", "}", "bytes", "\"", ",", "msg", ".", "remaining", "(", "))", ";", "}", "int", "chunkSize", "=", "msg", ".", "remaining", "(", ");", "/", "/", "send", "the", "chunk", "of", "body", "@", "@", "-", "165", ",", "7", "+", "183", ",", "10", "@", "@", "public", "void", "decode", "(", "IoSession", "session", ",", "IoBuffer", "msg", ",", "ProtocolDecoderOutput", "out", ")", "{", "}", "if", "(", "remaining", "<", "=", "0", ")", "{", "LOG", ".", "debug", "(", "\"", "end", "of", "HTTP", "body", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "end", "of", "HTTP", "body", "\"", ");", "}", "session", ".", "setAttribute", "(", "DECODER_STATE_ATT", ",", "DecoderState", ".", "NEW", ")", ";", "session", ".", "removeAttribute", "(", "BODY_REMAINING_BYTES", ")", ";", "@", "@", "-", "38", ",", "18", "+", "38", ",", "23", "@", "@", "*", "@", "author", "<", "a", "href", "=", "\"", "http", ":", "//", "mina", ".", "apache", ".", "org", "\"", ">", "Apache", "MINA", "Project", "<", "/", "a", ">", "*", "/", "public", "class", "HttpClientEncoder", "implements", "ProtocolEncoder", "{", "private", "static", "final", "Logger", "LOG", "=", "LoggerFactory", ".", "getLogger", "(", "HttpClientCodec", ".", "class", ")", ";", "private", "static", "final", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "HttpClientCodec", ".", "class", ")", ";", "private", "static", "final", "CharsetEncoder", "ENCODER", "=", "StandardCharsets", ".", "UTF_8", ".", "newEncoder", "(", ");", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "void", "encode", "(", "IoSession", "session", ",", "Object", "message", ",", "ProtocolEncoderOutput", "out", ")", "throws", "Exception", "{", "LOG", ".", "debug", "(", "\"", "encode", "{", "}\"", ",", "message", ".", "getClass", "(", ").", "getCanonicalName", "(", "))", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "encode", "{", "}\"", ",", "message", ".", "getClass", "(", ").", "getCanonicalName", "(", "))", ";", "}", "if", "(", "message", "instanceof", "HttpRequest", ")", "{", "LOG", ".", "debug", "(", "\"", "HttpRequest", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "HttpRequest", "\"", ");", "}", "HttpRequest", "msg", "=", "(", "HttpRequest", ")", "message", ";", "StringBuilder", "sb", "=", "new", "StringBuilder", "(", "msg", ".", "getMethod", "(", ").", "toString", "(", "))", ";", "sb", ".", "append", "(", "\"", "\"", ");", "@", "@", "-", "77", ",", "10", "+", "82", ",", "15", "@", "@", "public", "void", "encode", "(", "IoSession", "session", ",", "Object", "message", ",", "ProtocolEncoderOutput", "out", ")", "buf", ".", "flip", "(", ");", "out", ".", "write", "(", "buf", ")", ";", "}", "else", "if", "(", "message", "instanceof", "ByteBuffer", ")", "{", "LOG", ".", "debug", "(", "\"", "Body", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Body", "\"", ");", "}", "out", ".", "write", "(", "message", ")", ";", "}", "else", "if", "(", "message", "instanceof", "HttpEndOfContent", ")", "{", "LOG", ".", "debug", "(", "\"", "End", "of", "Content", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "End", "of", "Content", "\"", ");", "}", "/", "/", "end", "of", "HTTP", "content", "/", "/", "keep", "alive", "?", "}", "@", "@", "-", "41", ",", "8", "+", "41", ",", "8", "@", "@", "*", "@", "author", "<", "a", "href", "=", "\"", "http", ":", "//", "mina", ".", "apache", ".", "org", "\"", ">", "Apache", "MINA", "Project", "<", "/", "a", ">", "*", "/", "public", "class", "HttpServerDecoder", "implements", "ProtocolDecoder", "{", "private", "static", "final", "Logger", "LOG", "=", "LoggerFactory", ".", "getLogger", "(", "HttpServerCodec", ".", "class", ")", ";", "private", "static", "final", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "HttpServerCodec", ".", "class", ")", ";", "/", "**", "Key", "for", "decoder", "current", "state", "*", "/", "private", "static", "final", "String", "DECODER_STATE_ATT", "=", "\"", "http", ".", "ds", "\"", ";", "@", "@", "-", "90", ",", "15", "+", "90", ",", "21", "@", "@", "public", "void", "decode", "(", "IoSession", "session", ",", "IoBuffer", "msg", ",", "ProtocolDecoderOutput", "out", ")", "{", "switch", "(", "state", ")", "{", "case", "HEAD", ":", "LOG", ".", "debug", "(", "\"", "decoding", "HEAD", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "decoding", "HEAD", "\"", ");", "}", "/", "/", "grab", "the", "stored", "a", "partial", "HEAD", "request", "ByteBuffer", "oldBuffer", "=", "(", "ByteBuffer", ")", "session", ".", "getAttribute", "(", "PARTIAL_HEAD_ATT", ")", ";", "/", "/", "concat", "the", "old", "buffer", "and", "the", "new", "incoming", "one", "/", "/", "now", "let", "'", "s", "decode", "like", "it", "was", "a", "new", "message", "msg", "=", "IoBuffer", ".", "allocate", "(", "oldBuffer", ".", "remaining", "(", ")", "+", "msg", ".", "remaining", "(", "))", ".", "put", "(", "oldBuffer", ")", ".", "put", "(", "msg", ")", ".", "flip", "(", ");", "case", "NEW", ":", "LOG", ".", "debug", "(", "\"", "decoding", "NEW", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "decoding", "NEW", "\"", ");", "}", "HttpRequestImpl", "rq", "=", "parseHttpRequestHead", "(", "msg", ".", "buf", "(", "))", ";", "if", "(", "rq", "=", "=", "null", ")", "{", "@", "@", "-", "116", ",", "20", "+", "122", ",", "29", "@", "@", "public", "void", "decode", "(", "IoSession", "session", ",", "IoBuffer", "msg", ",", "ProtocolDecoderOutput", "out", ")", "{", "String", "contentLen", "=", "rq", ".", "getHeader", "(", "\"", "content", "-", "length", "\"", ");", "if", "(", "contentLen", "!", "=", "null", ")", "{", "LOG", ".", "debug", "(", "\"", "found", "content", "len", ":", "{", "}\"", ",", "contentLen", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "found", "content", "len", ":", "{", "}\"", ",", "contentLen", ")", ";", "}", "session", ".", "setAttribute", "(", "BODY_REMAINING_BYTES", ",", "Integer", ".", "valueOf", "(", "contentLen", ")", ");", "session", ".", "setAttribute", "(", "DECODER_STATE_ATT", ",", "DecoderState", ".", "BODY", ")", ";", "/", "/", "fallthrough", ",", "process", "body", "immediately", "}", "else", "{", "LOG", ".", "debug", "(", "\"", "request", "without", "content", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "request", "without", "content", "\"", ");", "}", "session", ".", "setAttribute", "(", "DECODER_STATE_ATT", ",", "DecoderState", ".", "NEW", ")", ";", "out", ".", "write", "(", "new", "HttpEndOfContent", "(", "))", ";", "break", ";", "}", "}", "case", "BODY", ":", "LOG", ".", "debug", "(", "\"", "decoding", "BODY", ":", "{", "}", "bytes", "\"", ",", "msg", ".", "remaining", "(", "))", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "decoding", "BODY", ":", "{", "}", "bytes", "\"", ",", "msg", ".", "remaining", "(", "))", ";", "}", "int", "chunkSize", "=", "msg", ".", "remaining", "(", ");", "/", "/", "send", "the", "chunk", "of", "body", "@", "@", "-", "146", ",", "7", "+", "161", ",", "10", "@", "@", "public", "void", "decode", "(", "IoSession", "session", ",", "IoBuffer", "msg", ",", "ProtocolDecoderOutput", "out", ")", "{", "remaining", "-", "=", "chunkSize", ";", "if", "(", "remaining", "<", "=", "0", ")", "{", "LOG", ".", "debug", "(", "\"", "end", "of", "HTTP", "body", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "end", "of", "HTTP", "body", "\"", ");", "}", "session", ".", "setAttribute", "(", "DECODER_STATE_ATT", ",", "DecoderState", ".", "NEW", ")", ";", "session", ".", "removeAttribute", "(", "BODY_REMAINING_BYTES", ")", ";", "out", ".", "write", "(", "new", "HttpEndOfContent", "(", "))", ";", "@", "@", "-", "39", ",", "18", "+", "39", ",", "23", "@", "@", "*", "@", "author", "<", "a", "href", "=", "\"", "http", ":", "//", "mina", ".", "apache", ".", "org", "\"", ">", "Apache", "MINA", "Project", "<", "/", "a", ">", "*", "/", "public", "class", "HttpServerEncoder", "implements", "ProtocolEncoder", "{", "private", "static", "final", "Logger", "LOG", "=", "LoggerFactory", ".", "getLogger", "(", "HttpServerCodec", ".", "class", ")", ";", "private", "static", "final", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "HttpServerCodec", ".", "class", ")", ";", "private", "static", "final", "CharsetEncoder", "ENCODER", "=", "StandardCharsets", ".", "UTF_8", ".", "newEncoder", "(", ");", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "void", "encode", "(", "IoSession", "session", ",", "Object", "message", ",", "ProtocolEncoderOutput", "out", ")", "throws", "Exception", "{", "LOG", ".", "debug", "(", "\"", "encode", "{", "}\"", ",", "message", ".", "getClass", "(", ").", "getCanonicalName", "(", "))", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "encode", "{", "}\"", ",", "message", ".", "getClass", "(", ").", "getCanonicalName", "(", "))", ";", "}", "if", "(", "message", "instanceof", "HttpResponse", ")", "{", "LOG", ".", "debug", "(", "\"", "HttpResponse", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "HttpResponse", "\"", ");", "}", "HttpResponse", "msg", "=", "(", "HttpResponse", ")", "message", ";", "StringBuilder", "sb", "=", "new", "StringBuilder", "(", "msg", ".", "getStatus", "(", ").", "line", "(", "))", ";", "@", "@", "-", "67", ",", "10", "+", "72", ",", "15", "@", "@", "public", "void", "encode", "(", "IoSession", "session", ",", "Object", "message", ",", "ProtocolEncoderOutput", "out", ")", "buf", ".", "flip", "(", ");", "out", ".", "write", "(", "buf", ")", ";", "}", "else", "if", "(", "message", "instanceof", "ByteBuffer", ")", "{", "LOG", ".", "debug", "(", "\"", "Body", "{", "}\"", ",", "message", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Body", "{", "}\"", ",", "message", ")", ";", "}", "out", ".", "write", "(", "message", ")", ";", "}", "else", "if", "(", "message", "instanceof", "HttpEndOfContent", ")", "{", "LOG", ".", "debug", "(", "\"", "End", "of", "Content", "\"", ");", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "End", "of", "Content", "\"", ");", "}", "/", "/", "end", "of", "HTTP", "content", "/", "/", "keep", "alive", "?", "}", "@", "@", "-", "24", ",", "7", "+", "24", ",", "7", "@", "@", "<", "parent", ">", "<", "groupId", ">", "org", ".", "apache", ".", "mina", "<", "/", "groupId", ">", "<", "artifactId", ">", "mina", "-", "parent", "<", "/", "artifactId", ">", "<", "version", ">", "2", ".", "0", ".", "21", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "2", ".", "0", ".", "20", "<", "/", "version", ">", "<", "/", "parent", ">", "<", "artifactId", ">", "mina", "-", "integration", "-", "beans", "<", "/", "artifactId", ">", "@", "@", "-", "24", ",", "7", "+", "24", ",", "7", "@", "@", "<", "parent", ">", "<", "groupId", ">", "org", ".", "apache", ".", "mina", "<", "/", "groupId", ">", "<", "artifactId", ">", "mina", "-", "parent", "<", "/", "artifactId", ">", "<", "version", ">", "2", ".", "0", ".", "21", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "2", ".", "0", ".", "20", "<", "/", "version", ">", "<", "/", "parent", ">", "<", "artifactId", ">", "mina", "-", "integration", "-", "jmx", "<", "/", "artifactId", ">", "@", "@", "-", "532", ",", "7", "+", "532", ",", "10", "@", "@", "private", "void", "expandAttribute", "(", "List", "<", "ModelMBeanAttributeInfo", ">", "attributes", ",", "Object", "ob", "try", "{", "property", "=", "getAttribute", "(", "object", ",", "attrName", ",", "pdesc", ".", "getPropertyType", "(", "))", ";", "}", "catch", "(", "Exception", "e", ")", "{", "LOGGER", ".", "debug", "(", "\"", "Unexpected", "exception", ".", "\",", "e", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Unexpected", "exception", ".", "\",", "e", ")", ";", "}", "return", ";", "}", "@", "@", "-", "24", ",", "7", "+", "24", ",", "7", "@", "@", "<", "parent", ">", "<", "groupId", ">", "org", ".", "apache", ".", "mina", "<", "/", "groupId", ">", "<", "artifactId", ">", "mina", "-", "parent", "<", "/", "artifactId", ">", "<", "version", ">", "2", ".", "0", ".", "21", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "2", ".", "0", ".", "20", "<", "/", "version", ">", "<", "/", "parent", ">", "<", "artifactId", ">", "mina", "-", "integration", "-", "ognl", "<", "/", "artifactId", ">", "@", "@", "-", "24", ",", "7", "+", "24", ",", "7", "@", "@", "<", "parent", ">", "<", "groupId", ">", "org", ".", "apache", ".", "mina", "<", "/", "groupId", ">", "<", "artifactId", ">", "mina", "-", "parent", "<", "/", "artifactId", ">", "<", "version", ">", "2", ".", "0", ".", "21", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "2", ".", "0", ".", "20", "<", "/", "version", ">", "<", "/", "parent", ">", "<", "modelVersion", ">", "4", ".", "0", ".", "0", "<", "/", "modelVersion", ">", "@", "@", "-", "24", ",", "7", "+", "24", ",", "7", "@", "@", "<", "parent", ">", "<", "groupId", ">", "org", ".", "apache", ".", "mina", "<", "/", "groupId", ">", "<", "artifactId", ">", "mina", "-", "parent", "<", "/", "artifactId", ">", "<", "version", ">", "2", ".", "0", ".", "21", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "2", ".", "0", ".", "20", "<", "/", "version", ">", "<", "/", "parent", ">", "<", "artifactId", ">", "mina", "-", "statemachine", "<", "/", "artifactId", ">", "@", "@", "-", "41", ",", "8", "+", "41", ",", "7", "@", "@", "*", "@", "author", "<", "a", "href", "=", "\"", "http", ":", "//", "mina", ".", "apache", ".", "org", "\"", ">", "Apache", "MINA", "Project", "<", "/", "a", ">", "*", "/", "public", "class", "StateMachineProxyBuilder", "{", "private", "static", "final", "Logger", "log", "=", "LoggerFactory", ".", "getLogger", "(", "StateMachineProxyBuilder", ".", "class", ")", ";", "private", "static", "final", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "StateMachineProxyBuilder", ".", "class", ")", ";", "private", "static", "final", "Object", "[", "]", "EMPTY_ARGUMENTS", "=", "new", "Object", "[", "0", "]", ";", "private", "StateContextLookup", "contextLookup", "=", "new", "SingletonStateContextLookup", "(", ");", "@", "@", "-", "235", ",", "10", "+", "234", ",", "10", "@", "@", "public", "Object", "invoke", "(", "Object", "proxy", ",", "Method", "method", ",", "Object", "[", "]", "args", ")", "throws", "Throwabl", "+", "Integer", ".", "toHexString", "(", "System", ".", "identityHashCode", "(", "proxy", ")", ");", "}", "if", "(", "log", ".", "isDebugEnabled", "(", "))", "{", "log", ".", "debug", "(", "\"", "Method", "invoked", ":", "\"", "+", "method", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Method", "invoked", ":", "\"", "+", "method", ")", ";", "}", "args", "=", "args", "=", "=", "null", "?", "EMPTY_ARGUMENTS", ":", "args", ";", "if", "(", "interceptor", "!", "=", "null", ")", "{", "@", "@", "-", "22", ",", "7", "+", "22", ",", "7", "@", "@", "<", "parent", ">", "<", "groupId", ">", "org", ".", "apache", ".", "mina", "<", "/", "groupId", ">", "<", "artifactId", ">", "mina", "-", "parent", "<", "/", "artifactId", ">", "<", "version", ">", "2", ".", "0", ".", "21", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "2", ".", "0", ".", "20", "<", "/", "version", ">", "<", "/", "parent", ">", "<", "artifactId", ">", "mina", "-", "transport", "-", "apr", "<", "/", "artifactId", ">", "@", "@", "-", "24", ",", "7", "+", "24", ",", "7", "@", "@", "<", "parent", ">", "<", "groupId", ">", "org", ".", "apache", ".", "mina", "<", "/", "groupId", ">", "<", "artifactId", ">", "mina", "-", "parent", "<", "/", "artifactId", ">", "<", "version", ">", "2", ".", "0", ".", "21", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "2", ".", "0", ".", "20", "<", "/", "version", ">", "<", "/", "parent", ">", "<", "artifactId", ">", "mina", "-", "transport", "-", "serial", "<", "/", "artifactId", ">", "@", "@", "-", "47", ",", "8", "+", "47", ",", "8", "@", "@", "*", "@", "author", "<", "a", "href", "=", "\"", "http", ":", "//", "mina", ".", "apache", ".", "org", "\"", ">", "Apache", "MINA", "Project", "<", "/", "a", ">", "*", "/", "public", "final", "class", "SerialConnector", "extends", "AbstractIoConnector", "{", "private", "final", "Logger", "log", ";", "private", "static", "final", "Logger", "LOGGER", "=", "LoggerFactory", ".", "getLogger", "(", "SerialConnector", ".", "class", ")", ";", "private", "IdleStatusChecker", "idleChecker", ";", "/", "**", "@", "@", "-", "65", ",", "7", "+", "65", ",", "6", "@", "@", "public", "SerialConnector", "(", ")", "{", "*", "/", "public", "SerialConnector", "(", "Executor", "executor", ")", "{", "super", "(", "new", "DefaultSerialSessionConfig", "(", "),", "executor", ")", ";", "log", "=", "LoggerFactory", ".", "getLogger", "(", "SerialConnector", ".", "class", ")", ";", "idleChecker", "=", "new", "IdleStatusChecker", "(", ");", "/", "/", "we", "schedule", "the", "idle", "status", "checking", "task", "in", "this", "service", "exceutor", "@", "@", "-", "87", ",", "14", "+", "86", ",", "14", "@", "@", "protected", "synchronized", "ConnectFuture", "connect0", "(", "SocketAddress", "remoteAddress", ",", "Socke", "portId", "=", "(", "CommPortIdentifier", ")", "portList", ".", "nextElement", "(", ");", "if", "(", "portId", ".", "getPortType", "(", ")", "=", "=", "CommPortIdentifier", ".", "PORT_SERIAL", ")", "{", "if", "(", "log", ".", "isDebugEnabled", "(", "))", "{", "log", ".", "debug", "(", "\"", "Serial", "port", "discovered", ":", "\"", "+", "portId", ".", "getName", "(", "))", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Serial", "port", "discovered", ":", "\"", "+", "portId", ".", "getName", "(", "))", ";", "}", "if", "(", "portId", ".", "getName", "(", ").", "equals", "(", "portAddress", ".", "getName", "(", "))", ")", "{", "try", "{", "if", "(", "log", ".", "isDebugEnabled", "(", "))", "{", "log", ".", "debug", "(", "\"", "Serial", "port", "found", ":", "\"", "+", "portId", ".", "getName", "(", "))", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Serial", "port", "found", ":", "\"", "+", "portId", ".", "getName", "(", "))", ";", "}", "SerialPort", "serialPort", "=", "initializePort", "(", "\"", "Apache", "MINA", "\"", ",", "portId", ",", "portAddress", ")", ";", "@", "@", "-", "106", ",", "26", "+", "105", ",", "26", "@", "@", "protected", "synchronized", "ConnectFuture", "connect0", "(", "SocketAddress", "remoteAddress", ",", "Socke", "return", "future", ";", "}", "catch", "(", "PortInUseException", "e", ")", "{", "if", "(", "log", ".", "isDebugEnabled", "(", "))", "{", "log", ".", "debug", "(", "\"", "Port", "In", "Use", "Exception", ":", "\"", ",", "e", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Port", "In", "Use", "Exception", ":", "\"", ",", "e", ")", ";", "}", "return", "DefaultConnectFuture", ".", "newFailedFuture", "(", "e", ")", ";", "}", "catch", "(", "UnsupportedCommOperationException", "e", ")", "{", "if", "(", "log", ".", "isDebugEnabled", "(", "))", "{", "log", ".", "debug", "(", "\"", "Comm", "Exception", ":", "\"", ",", "e", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "Comm", "Exception", ":", "\"", ",", "e", ")", ";", "}", "return", "DefaultConnectFuture", ".", "newFailedFuture", "(", "e", ")", ";", "}", "catch", "(", "IOException", "e", ")", "{", "if", "(", "log", ".", "isDebugEnabled", "(", "))", "{", "log", ".", "debug", "(", "\"", "IOException", ":", "\"", ",", "e", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "IOException", ":", "\"", ",", "e", ")", ";", "}", "return", "DefaultConnectFuture", ".", "newFailedFuture", "(", "e", ")", ";", "}", "catch", "(", "TooManyListenersException", "e", ")", "{", "if", "(", "log", ".", "isDebugEnabled", "(", "))", "{", "log", ".", "debug", "(", "\"", "TooManyListenersException", ":", "\"", ",", "e", ")", ";", "if", "(", "LOGGER", ".", "isDebugEnabled", "(", "))", "{", "LOGGER", ".", "debug", "(", "\"", "TooManyListenersException", ":", "\"", ",", "e", ")", ";", "}", "return", "DefaultConnectFuture", ".", "newFailedFuture", "(", "e", ")", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["vendor:", "update", "github.com/cilium/ebpf", "We", "need", "to", "update", "the", "eBPF", "library", "so", "that", "we", "can", "get", "the", "raw", "syscall", "errors", "from", "bpf(2)", "syscalls", "using", "errors.Is.", "Signed-off-by:", "Aleksa", "Sarai", "<cyphar@cyphar.com>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Retire", "github", "mirror,", "repo", "moved", "to", "opendev"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Merge", "pull", "request", "#103785", "from", "smarterclayton/preserve_reason", "Ensure", "that", "Reason", "and", "Message", "are", "preserved", "on", "pod", "status"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Fixed", "bug", "#75571:", "Potential", "infinite", "loop", "in", "gdImageCreateFromGifCtx", "Due", "to", "a", "signedness", "confusion", "in", "`GetCode_`", "a", "corrupt", "GIF", "file", "can", "trigger", "an", "infinite", "loop.", "Furthermore", "we", "make", "sure", "that", "a", "GIF", "without", "any", "palette", "entries", "is", "treated", "as", "invalid", "*after*", "open", "palette", "entries", "have", "been", "removed."], "code_tokens": ["@", "@", "-", "261", ",", "10", "+", "261", ",", "6", "@", "@", "gdImagePtr", "gdImageCreateFromGifCtx", "(", "gdIOCtxPtr", "fd", ")", "/", "*", "{", "{{", "*", "/", "if", "(", "!", "im", ")", "{", "return", "0", ";", "}", "if", "(", "!", "im", "-", ">", "colorsTotal", ")", "{", "gdImageDestroy", "(", "im", ")", ";", "return", "0", ";", "}", "/", "*", "Check", "for", "open", "colors", "at", "the", "end", ",", "so", "we", "can", "reduce", "colorsTotal", "and", "ultimately", "BitsPerPixel", "*", "/", "@", "@", "-", "275", ",", "6", "+", "271", ",", "10", "@", "@", "gdImagePtr", "gdImageCreateFromGifCtx", "(", "gdIOCtxPtr", "fd", ")", "/", "*", "{", "{{", "*", "/", "break", ";", "}", "}", "if", "(", "!", "im", "-", ">", "colorsTotal", ")", "{", "gdImageDestroy", "(", "im", ")", ";", "return", "0", ";", "}", "return", "im", ";", "}", "/", "*", "}", "}}", "*", "/", "@", "@", "-", "375", ",", "7", "+", "375", ",", "7", "@", "@", "static", "int", "GetCode_", "(", "gdIOCtx", "*", "fd", ",", "CODE_STATIC_DATA", "*", "scd", ",", "int", "code_size", ",", "int", "flag", ",", "int", "*", "ZeroDataBlockP", ")", "{", "int", "i", ",", "j", ",", "ret", ";", "unsigned", "char", "count", ";", "int", "count", ";", "if", "(", "flag", ")", "{", "scd", "-", ">", "curbit", "=", "0", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "15", "@", "@", "-", "-", "TEST", "-", "-", "Bug", "#", "75571", "(", "Infinite", "loop", "in", "GIF", "reading", "causing", "DoS", ")", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "'", "gd", "'", "))", "die", "(", "'", "skip", "gd", "extension", "not", "available", "'", ");", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "var_dump", "(", "imagecreatefromgif", "(", "__DIR__", ".", "'", "/", "bug75571", ".", "gif", "'", "))", ";", "?", ">", "=", "==", "DONE", "=", "==", "-", "-", "EXPECTF", "-", "-", "Warning", ":", "imagecreatefromgif", "(", "):", "'", "%", "s", "'", "is", "not", "a", "valid", "GIF", "file", "in", "%", "s", "on", "line", "%", "d", "bool", "(", "false", ")", "=", "==", "DONE", "=", "=="], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["..."], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["USB:", "whiteheat:", "fix", "potential", "null-deref", "at", "probe", "Fix", "potential", "null-pointer", "dereference", "at", "probe", "by", "making", "sure", "that", "the", "required", "endpoints", "are", "present.", "The", "whiteheat", "driver", "assumes", "there", "are", "at", "least", "five", "pairs", "of", "bulk", "endpoints,", "of", "which", "the", "final", "pair", "is", "used", "for", "the", "\"command", "port\".", "An", "attempt", "to", "bind", "to", "an", "interface", "with", "fewer", "bulk", "endpoints", "would", "currently", "lead", "to", "an", "oops.", "Fixes", "CVE-2015-5257.", "Reported-by:", "Moein", "Ghasemzadeh", "<moein@istuary.com>", "Cc:", "stable", "<stable@vger.kernel.org>", "Signed-off-by:", "Johan", "Hovold", "<johan@kernel.org>", "Signed-off-by:", "Greg", "Kroah-Hartman", "<gregkh@linuxfoundation.org>"], "code_tokens": ["@", "@", "-", "80", ",", "6", "+", "80", ",", "8", "@", "@", "static", "int", "whiteheat_firmware_download", "(", "struct", "usb_serial", "*", "serial", ",", "static", "int", "whiteheat_firmware_attach", "(", "struct", "usb_serial", "*", "serial", ")", ";", "/", "*", "function", "prototypes", "for", "the", "Connect", "Tech", "WhiteHEAT", "serial", "converter", "*", "/", "static", "int", "whiteheat_probe", "(", "struct", "usb_serial", "*", "serial", ",", "const", "struct", "usb_device_id", "*", "id", ")", ";", "static", "int", "whiteheat_attach", "(", "struct", "usb_serial", "*", "serial", ")", ";", "static", "void", "whiteheat_release", "(", "struct", "usb_serial", "*", "serial", ")", ";", "static", "int", "whiteheat_port_probe", "(", "struct", "usb_serial_port", "*", "port", ")", ";", "@", "@", "-", "116", ",", "6", "+", "118", ",", "7", "@", "@", "static", "struct", "usb_serial_driver", "whiteheat_device", "=", "{", ".", "description", "=", "\"", "Connect", "Tech", "-", "WhiteHEAT", "\"", ",", ".", "id_table", "=", "id_table_std", ",", ".", "num_ports", "=", "4", ",", ".", "probe", "=", "whiteheat_probe", ",", ".", "attach", "=", "whiteheat_attach", ",", ".", "release", "=", "whiteheat_release", ",", ".", "port_probe", "=", "whiteheat_port_probe", ",", "@", "@", "-", "217", ",", "6", "+", "220", ",", "34", "@", "@", "static", "int", "whiteheat_firmware_attach", "(", "struct", "usb_serial", "*", "serial", ")", "/", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*", "*", "Connect", "Tech", "'", "s", "White", "Heat", "serial", "driver", "functions", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "/", "static", "int", "whiteheat_probe", "(", "struct", "usb_serial", "*", "serial", ",", "const", "struct", "usb_device_id", "*", "id", ")", "{", "struct", "usb_host_interface", "*", "iface_desc", ";", "struct", "usb_endpoint_descriptor", "*", "endpoint", ";", "size_t", "num_bulk_in", "=", "0", ";", "size_t", "num_bulk_out", "=", "0", ";", "size_t", "min_num_bulk", ";", "unsigned", "int", "i", ";", "iface_desc", "=", "serial", "-", ">", "interface", "-", ">", "cur_altsetting", ";", "for", "(", "i", "=", "0", ";", "i", "<", "iface_desc", "-", ">", "desc", ".", "bNumEndpoints", ";", "i", "+", "+)", "{", "endpoint", "=", "&", "iface_desc", "-", ">", "endpoint", "[", "i", "]", ".", "desc", ";", "if", "(", "usb_endpoint_is_bulk_in", "(", "endpoint", ")", ")", "+", "+", "num_bulk_in", ";", "if", "(", "usb_endpoint_is_bulk_out", "(", "endpoint", ")", ")", "+", "+", "num_bulk_out", ";", "}", "min_num_bulk", "=", "COMMAND_PORT", "+", "1", ";", "if", "(", "num_bulk_in", "<", "min_num_bulk", "|", "|", "num_bulk_out", "<", "min_num_bulk", ")", "return", "-", "ENODEV", ";", "return", "0", ";", "}", "static", "int", "whiteheat_attach", "(", "struct", "usb_serial", "*", "serial", ")", "{", "struct", "usb_serial_port", "*", "command_port", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Merge", "branch", "'udp-receive-path-optimizations'", "Eric", "Dumazet", "says:", "====================", "udp:", "receive", "path", "optimizations", "This", "patch", "series", "provides", "about", "100", "%", "performance", "increase", "under", "flood.", "v2:", "added", "Paolo", "feedback", "on", "udp_rmem_release()", "for", "tiny", "sk_rcvbuf", "added", "the", "last", "patch", "touching", "sk_rmem_alloc", "later", "====================", "Signed-off-by:", "David", "S.", "Miller", "<davem@davemloft.net>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Tests:", "Use", "more", "appropriate", "assertions", "in", "`rest_sanitize_request_arg()`", "tests.", "This", "replaces", "instances", "of", "`assertSame(", "true,", "...", ")`", "with", "`assertTrue()`", "to", "use", "native", "PHPUnit", "functionality.", "Follow-up", "to", "[38832].", "See", "#53363.", "git-svn-id:", "https://develop.svn.wordpress.org/trunk@51453", "602fd350-edb4-49c9-b593-d223f7449a82"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["[maven-release-plugin]", "prepare", "for", "next", "development", "iteration"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["UNOMI-494", "Change", "validation", "exception", "logging", "to", "debug", "(#316)"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Improve", "memory", "allocation", "related", "code", "in", "zend_fibers", "(#7058)", "-", "make_fcontext()", "never", "returns", "NULL.", "-", "Show", "syscall", "error", "info", "in", "exception", "just", "like", "zend_alloc", "does", "(we", "also", "used", "php_win32_error_*()", "in", "Zend).", "-", "MAP_ANON", "was", "marked", "as", "deprecated", "or", "compatibility", "macro", "on", "Linux,", "It", "would", "be", "better", "to", "use", "MAP_ANONYMOUS", "first.", "-", "Makes", "the", "code", "consistent", "with", "the", "code", "of", "other", "modules", "in", "the", "kernel.", "-", "adds", "some", "comments."], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["watchdog:", "it87_wdt:", "add", "IT8620E", "ID", "This", "adds", "IT8620E", "chip", "ID", "to", "it87_wdt", "driver.", "Such", "chip", "is", "often", "found", "on", "current", "Gigabyte", "motherboards,", "it", "is", "allegedly", "custom", "made", "for", "this", "manufacturer.", "Upon", "testing", "it", "looks", "like", "it", "has", "a", "16-bit", "timer", "and", "cannot", "be", "reset", "via", "game", "port", "(only", "via", "CIR),", "so", "it", "is", "similar", "to", "IT87{18,20,21,28,83}", "chips.", "Tested", "on", "GA-F2A88XM-HD3P", "board.", "Signed-off-by:", "Maciej", "S.", "Szmigiero", "<mail@maciej.szmigiero.name>", "Reviewed-by:", "Guenter", "Roeck", "<linux@roeck-us.net>", "Signed-off-by:", "Guenter", "Roeck", "<linux@roeck-us.net>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["NIFI-7079", "Added", "SecureHasher", "interface", "and", "Argon2SecureHasher", "implementation.", "Added", "unit", "tests.", "Fixed", "JwtService", "charset", "references.", "Changed", "FingerprintFactory", "to", "mask", "sensitive", "values", "via", "Argon2", "hashing.", "Resolved", "RAT", "checks."], "code_tokens": ["@", "@", "-", "37", ",", "9", "+", "37", ",", "14", "@", "@", "<", "artifactId", ">", "nifi", "-", "utils", "<", "/", "artifactId", ">", "<", "version", ">", "1", ".", "12", ".", "0", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "/", "dependency", ">", "<", "!-", "-<", "dependency", ">", "--", ">", "<", "!-", "-<", "groupId", ">", "org", ".", "slf4j", "<", "/", "groupId", ">", "--", ">", "<", "!-", "-<", "artifactId", ">", "slf4j", "-", "api", "<", "/", "artifactId", ">", "--", ">", "<", "!-", "-<", "/", "dependency", ">", "--", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "slf4j", "<", "/", "groupId", ">", "<", "artifactId", ">", "slf4j", "-", "api", "<", "/", "artifactId", ">", "<", "groupId", ">", "ch", ".", "qos", ".", "logback", "<", "/", "groupId", ">", "<", "artifactId", ">", "logback", "-", "classic", "<", "/", "artifactId", ">", "<", "scope", ">", "provided", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "apache", ".", "commons", "<", "/", "groupId", ">", "@", "@", "-", "0", ",", "0", "+", "1", ",", "218", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "nifi", ".", "security", ".", "util", ".", "crypto", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "security", ".", "SecureRandom", ";", "import", "java", ".", "util", ".", "concurrent", ".", "TimeUnit", ";", "import", "org", ".", "bouncycastle", ".", "crypto", ".", "generators", ".", "Argon2BytesGenerator", ";", "import", "org", ".", "bouncycastle", ".", "crypto", ".", "params", ".", "Argon2Parameters", ";", "import", "org", ".", "bouncycastle", ".", "util", ".", "encoders", ".", "Base64", ";", "import", "org", ".", "bouncycastle", ".", "util", ".", "encoders", ".", "Hex", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "/", "**", "*", "Provides", "an", "implementation", "of", "{", "@", "code", "Argon2", "}", "for", "secure", "password", "hashing", ".", "This", "class", "is", "*", "roughly", "based", "on", "Spring", "Security", "'", "s", "implementation", "but", "does", "not", "include", "the", "full", "module", "*", "in", "this", "utility", "module", ".", "This", "implementation", "uses", "{", "@", "code", "Argon2id", "}", "which", "provides", "a", "*", "balance", "of", "protection", "against", "side", "-", "channel", "and", "memory", "attacks", ".", "*", "<", "p", ">", "*", "One", "<", "strong", ">", "critical", "<", "/", "strong", ">", "difference", "is", "that", "this", "implementation", "uses", "a", "*", "<", "strong", ">", "static", "universal", "<", "/", "strong", ">", "salt", "unless", "instructed", "otherwise", ",", "which", "provides", "*", "strict", "determinism", "across", "nodes", "in", "a", "cluster", ".", "The", "purpose", "for", "this", "is", "to", "allow", "for", "*", "blind", "equality", "comparison", "of", "sensitive", "values", "hashed", "on", "different", "nodes", "(", "with", "*", "potentially", "different", "{", "@", "code", "nifi", ".", "sensitive", ".", "props", ".", "key", "}", "values", ")", "during", "flow", "inheritance", "*", "(", "see", "{", "@", "code", "FingerprintFactory", "}", ").", "*", "/", "public", "class", "Argon2SecureHasher", "implements", "SecureHasher", "{", "private", "static", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "Argon2SecureHasher", ".", "class", ")", ";", "private", "static", "final", "int", "DEFAULT_SALT_LENGTH", "=", "16", ";", "private", "static", "final", "int", "DEFAULT_HASH_LENGTH", "=", "32", ";", "private", "static", "final", "int", "DEFAULT_PARALLELISM", "=", "1", ";", "private", "static", "final", "int", "DEFAULT_MEMORY", "=", "1", "<", "<", "12", ";", "private", "static", "final", "int", "DEFAULT_ITERATIONS", "=", "3", ";", "private", "final", "int", "hashLength", ";", "private", "final", "int", "memory", ";", "private", "final", "int", "parallelism", ";", "private", "final", "int", "iterations", ";", "private", "final", "int", "saltLength", ";", "private", "final", "boolean", "usingStaticSalt", ";", "/", "/", "A", "16", "byte", "salt", "(", "nonce", ")", "is", "recommended", "for", "password", "hashing", "private", "static", "final", "byte", "[", "]", "staticSalt", "=", "\"", "NiFi", "Static", "Salt", "\"", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ";", "/", "**", "*", "Instantiates", "an", "Argon2", "secure", "hasher", "using", "the", "default", "cost", "parameters", "*", "(", "{@", "code", "hashLength", "=", "}", "{@", "link", "#", "DEFAULT_HASH_LENGTH", "}", ",", "*", "{", "@", "code", "memory", "=", "}", "{@", "link", "#", "DEFAULT_MEMORY", "}", ",", "*", "{", "@", "code", "parallelism", "=", "}", "{@", "link", "#", "DEFAULT_PARALLELISM", "}", ",", "*", "{", "@", "code", "iterations", "=", "}", "{@", "link", "#", "DEFAULT_ITERATIONS", "}", ").", "A", "static", "salt", "is", "also", "used", ".", "*", "/", "public", "Argon2SecureHasher", "(", ")", "{", "this", "(", "DEFAULT_HASH_LENGTH", ",", "DEFAULT_MEMORY", ",", "DEFAULT_PARALLELISM", ",", "DEFAULT_ITERATIONS", ",", "0", ")", ";", "}", "/", "**", "*", "Instantiates", "an", "Argon2", "secure", "hasher", "using", "the", "provided", "cost", "parameters", ".", "A", "unique", "*", "{", "@", "link", "#", "DEFAULT_SALT_LENGTH", "}", "byte", "salt", "will", "be", "generated", "on", "every", "hash", "request", ".", "*", "*", "@", "param", "hashLength", "the", "output", "length", "in", "bytes", "(", "{@", "code", "4", "to", "2", "^", "32", "-", "1", "}", ")", "*", "@", "param", "memory", "the", "integer", "number", "of", "KB", "used", "(", "{@", "code", "8p", "to", "2", "^", "32", "-", "1", "}", ")", "*", "@", "param", "parallelism", "degree", "of", "parallelism", "(", "{@", "code", "1", "to", "2", "^", "24", "-", "1", "}", ")", "*", "@", "param", "iterations", "number", "of", "iterations", "(", "{@", "code", "1", "to", "2", "^", "32", "-", "1", "}", ")", "*", "/", "public", "Argon2SecureHasher", "(", "int", "hashLength", ",", "int", "memory", ",", "int", "parallelism", ",", "int", "iterations", ")", "{", "this", "(", "hashLength", ",", "memory", ",", "parallelism", ",", "iterations", ",", "0", ")", ";", "}", "/", "**", "*", "Instantiates", "an", "Argon2", "secure", "hasher", "using", "the", "provided", "cost", "parameters", ".", "A", "unique", "*", "salt", "of", "the", "specified", "length", "will", "be", "generated", "on", "every", "hash", "request", ".", "*", "*", "@", "param", "hashLength", "the", "output", "length", "in", "bytes", "(", "{@", "code", "4", "to", "2", "^", "32", "-", "1", "}", ")", "*", "@", "param", "memory", "the", "integer", "number", "of", "KB", "used", "(", "{@", "code", "8p", "to", "2", "^", "32", "-", "1", "}", ")", "*", "@", "param", "parallelism", "degree", "of", "parallelism", "(", "{@", "code", "1", "to", "2", "^", "24", "-", "1", "}", ")", "*", "@", "param", "iterations", "number", "of", "iterations", "(", "{@", "code", "1", "to", "2", "^", "32", "-", "1", "}", ")", "*", "@", "param", "saltLength", "the", "salt", "length", "in", "bytes", "{", "@", "code", "8", "to", "2", "^", "32", "-", "1", "}", ")", "*", "/", "public", "Argon2SecureHasher", "(", "int", "hashLength", ",", "int", "memory", ",", "int", "parallelism", ",", "int", "iterations", ",", "int", "saltLength", ")", "{", "/", "/", "TODO", ":", "Implement", "boundary", "checking", "this", ".", "hashLength", "=", "hashLength", ";", "this", ".", "memory", "=", "memory", ";", "this", ".", "parallelism", "=", "parallelism", ";", "this", ".", "iterations", "=", "iterations", ";", "this", ".", "saltLength", "=", "saltLength", ";", "if", "(", "saltLength", ">", "0", ")", "{", "this", ".", "usingStaticSalt", "=", "false", ";", "}", "else", "{", "this", ".", "usingStaticSalt", "=", "true", ";", "logger", ".", "debug", "(", "\"", "Configured", "to", "use", "static", "salt", "\"", ");", "}", "}", "/", "**", "*", "Returns", "{", "@", "code", "true", "}", "if", "this", "instance", "is", "configured", "to", "use", "a", "static", "salt", ".", "*", "*", "@", "return", "true", "if", "all", "hashes", "will", "be", "generated", "using", "a", "static", "salt", "*", "/", "public", "boolean", "isUsingStaticSalt", "(", ")", "{", "return", "usingStaticSalt", ";", "}", "/", "**", "*", "Returns", "a", "salt", "to", "use", ".", "If", "using", "a", "static", "salt", "(", "see", "{", "@", "link", "#", "isUsingStaticSalt", "(", ")}", "),", "*", "this", "return", "value", "will", "be", "identical", "across", "every", "invocation", ".", "If", "using", "a", "dynamic", "salt", ",", "*", "it", "will", "be", "{", "@", "link", "#", "saltLength", "}", "bytes", "of", "a", "securely", "-", "generated", "random", "value", ".", "*", "*", "@", "return", "the", "salt", "value", "*", "/", "byte", "[", "]", "getSalt", "(", ")", "{", "if", "(", "isUsingStaticSalt", "(", "))", "{", "return", "staticSalt", ";", "}", "else", "{", "SecureRandom", "sr", "=", "new", "SecureRandom", "(", ");", "byte", "[", "]", "salt", "=", "new", "byte", "[", "saltLength", "]", ";", "sr", ".", "nextBytes", "(", "salt", ")", ";", "return", "salt", ";", "}", "}", "/", "**", "*", "Returns", "a", "String", "representation", "of", "{", "@", "code", "CHF", "(", "input", ")", "}", "in", "hex", "-", "encoded", "format", ".", "*", "*", "@", "param", "input", "the", "input", "*", "@", "return", "the", "hex", "-", "encoded", "hash", "*", "/", "@", "Override", "public", "String", "hashHex", "(", "String", "input", ")", "{", "if", "(", "input", "=", "=", "null", ")", "{", "logger", ".", "warn", "(", "\"", "Attempting", "to", "generate", "an", "Argon2", "hash", "of", "null", "input", ";", "using", "empty", "input", "\"", ");", "input", "=", "\"", "\";", "}", "return", "Hex", ".", "toHexString", "(", "hash", "(", "input", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", "))", ";", "}", "/", "**", "*", "Returns", "a", "String", "representation", "of", "{", "@", "code", "CHF", "(", "input", ")", "}", "in", "Base", "64", "-", "encoded", "format", ".", "*", "*", "@", "param", "input", "the", "input", "*", "@", "return", "the", "Base", "64", "-", "encoded", "hash", "*", "/", "@", "Override", "public", "String", "hashBase64", "(", "String", "input", ")", "{", "if", "(", "input", "=", "=", "null", ")", "{", "logger", ".", "warn", "(", "\"", "Attempting", "to", "generate", "an", "Argon2", "hash", "of", "null", "input", ";", "using", "empty", "input", "\"", ");", "input", "=", "\"", "\";", "}", "return", "Base64", ".", "toBase64String", "(", "hash", "(", "input", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", "))", ";", "}", "/", "**", "*", "Returns", "a", "byte", "[", "]", "representation", "of", "{", "@", "code", "CHF", "(", "input", ")", "}.", "*", "*", "@", "param", "input", "the", "input", "*", "@", "return", "the", "hash", "*", "/", "@", "Override", "public", "byte", "[", "]", "hashRaw", "(", "byte", "[", "]", "input", ")", "{", "return", "hash", "(", "input", ")", ";", "}", "/", "**", "*", "Internal", "method", "to", "hash", "the", "raw", "bytes", ".", "*", "*", "@", "param", "input", "the", "raw", "bytes", "to", "hash", "(", "can", "be", "length", "0", ")", "*", "@", "return", "the", "generated", "hash", "*", "/", "private", "byte", "[", "]", "hash", "(", "byte", "[", "]", "input", ")", "{", "byte", "[", "]", "salt", "=", "getSalt", "(", ");", "byte", "[", "]", "hash", "=", "new", "byte", "[", "hashLength", "]", ";", "logger", ".", "debug", "(", "\"", "Creating", "{", "}", "byte", "Argon2", "hash", "with", "salt", "[", "{}", "]\"", ",", "hashLength", ",", "Hex", ".", "toHexString", "(", "salt", ")", ");", "final", "long", "startNanos", "=", "System", ".", "nanoTime", "(", ");", "Argon2Parameters", "params", "=", "new", "Argon2Parameters", ".", "Builder", "(", "Argon2Parameters", ".", "ARGON2_id", ")", ".", "withSalt", "(", "salt", ")", ".", "withParallelism", "(", "parallelism", ")", ".", "withMemoryAsKB", "(", "memory", ")", ".", "withIterations", "(", "iterations", ")", ".", "build", "(", ");", "Argon2BytesGenerator", "generator", "=", "new", "Argon2BytesGenerator", "(", ");", "generator", ".", "init", "(", "params", ")", ";", "final", "long", "initNanos", "=", "System", ".", "nanoTime", "(", ");", "generator", ".", "generateBytes", "(", "input", ",", "hash", ")", ";", "final", "long", "generateNanos", "=", "System", ".", "nanoTime", "(", ");", "final", "long", "initDurationMicros", "=", "TimeUnit", ".", "NANOSECONDS", ".", "toMicros", "(", "initNanos", "-", "startNanos", ")", ";", "final", "long", "generateDurationMicros", "=", "TimeUnit", ".", "NANOSECONDS", ".", "toMicros", "(", "generateNanos", "-", "initNanos", ")", ";", "final", "long", "totalDurationMillis", "=", "TimeUnit", ".", "MICROSECONDS", ".", "toMillis", "(", "initDurationMicros", "+", "generateDurationMicros", ")", ";", "logger", ".", "debug", "(", "\"", "Generated", "Argon2", "hash", "in", "{", "}", "ms", "(", "init", ":", "{", "}", "\u00b5", "s", ",", "generate", ":", "{", "}", "\u00b5", "s", ")", "\",", "totalDurationMillis", ",", "initDurationMicros", ",", "generateDurationMicros", ")", ";", "return", "hash", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "56", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "nifi", ".", "security", ".", "util", ".", "crypto", ";", "/", "**", "*", "An", "interface", "which", "specifies", "that", "implementations", "should", "provide", "a", "*", "cryptographic", "hash", "function", "(", "CHF", ")", "which", "accepts", "input", "and", "returns", "a", "*", "deterministic", ",", "(", "mathematically", "-", "difficult", ")", "irreversible", "value", ".", "*", "*", "While", "SHA", "-", "256", ",", "SHA", "-", "512", ",", "and", "Blake2", "are", "CHF", "implementations", ",", "this", "interface", "is", "intended", "to", "*", "be", "used", "by", "password", "protection", "or", "key", "derivation", "functions", "(", "KDF", ")", "like", "*", "{", "@", "link", "PBKDF2CipherProvider", "}", ",", "{", "@", "link", "BcryptCipherProvider", "}", ",", "{", "@", "link", "ScryptCipherProvider", "}", ",", "*", "or", "{", "@", "link", "Argon2SecureHasher", "}", ".", "These", "classes", "implement", "iterative", "processes", "which", "make", "use", "*", "of", "cryptographic", "primitives", "to", "return", "an", "irreversible", "value", "which", "can", "either", "securely", "*", "store", "a", "password", "representation", "or", "be", "used", "as", "an", "encryption", "key", "derived", "from", "a", "password", ".", "*", "/", "public", "interface", "SecureHasher", "{", "/", "**", "*", "Returns", "a", "String", "representation", "of", "{", "@", "code", "CHF", "(", "input", ")", "}", "in", "hex", "-", "encoded", "format", ".", "*", "*", "@", "param", "input", "the", "input", "*", "@", "return", "the", "hex", "-", "encoded", "hash", "*", "/", "String", "hashHex", "(", "String", "input", ")", ";", "/", "**", "*", "Returns", "a", "String", "representation", "of", "{", "@", "code", "CHF", "(", "input", ")", "}", "in", "Base", "64", "-", "encoded", "format", ".", "*", "*", "@", "param", "input", "the", "input", "*", "@", "return", "the", "Base", "64", "-", "encoded", "hash", "*", "/", "String", "hashBase64", "(", "String", "input", ")", ";", "/", "**", "*", "Returns", "a", "byte", "[", "]", "representation", "of", "{", "@", "code", "CHF", "(", "input", ")", "}.", "*", "*", "@", "param", "input", "the", "input", "*", "@", "return", "the", "hash", "*", "/", "byte", "[", "]", "hashRaw", "(", "byte", "[", "]", "input", ")", ";", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "242", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "nifi", ".", "security", ".", "util", ".", "crypto", "import", "org", ".", "apache", ".", "kerby", ".", "util", ".", "Hex", "import", "org", ".", "bouncycastle", ".", "jce", ".", "provider", ".", "BouncyCastleProvider", "import", "org", ".", "junit", ".", "After", "import", "org", ".", "junit", ".", "Before", "import", "org", ".", "junit", ".", "BeforeClass", "import", "org", ".", "junit", ".", "Ignore", "import", "org", ".", "junit", ".", "Test", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", "import", "org", ".", "junit", ".", "runners", ".", "JUnit4", "import", "org", ".", "slf4j", ".", "Logger", "import", "org", ".", "slf4j", ".", "LoggerFactory", "import", "java", ".", "security", ".", "Security", "@", "RunWith", "(", "JUnit4", ".", "class", ")", "class", "Argon2SecureHasherTest", "extends", "GroovyTestCase", "{", "private", "static", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "Argon2SecureHasherTest", ".", "class", ")", "@", "BeforeClass", "static", "void", "setUpOnce", "(", ")", "throws", "Exception", "{", "Security", ".", "addProvider", "(", "new", "BouncyCastleProvider", "(", "))", "logger", ".", "metaClass", ".", "methodMissing", "=", "{", "String", "name", ",", "args", "-", ">", "logger", ".", "info", "(", "\"[", "${", "name", "?", ".", "toUpperCase", "(", ")}", "]", "$", "{(", "args", "as", "List", ")", ".", "join", "(", "\"", "\"", ")}", "\")", "}", "}", "@", "Before", "void", "setUp", "(", ")", "throws", "Exception", "{", "}", "@", "After", "void", "tearDown", "(", ")", "throws", "Exception", "{", "}", "private", "static", "byte", "[", "]", "decodeHex", "(", "String", "hex", ")", "{", "Hex", ".", "decode", "(", "hex", "?", ".", "replaceAll", "(", "\"[", "^", "0", "-", "9a", "-", "fA", "-", "F", "]", "\",", "\"", "\")", ")", "}", "@", "Ignore", "(", "\"", "Cannot", "override", "static", "salt", "\"", ")", "@", "Test", "void", "testShouldMatchReferenceVectors", "(", ")", "{", "/", "/", "Arrange", "int", "hashLength", "=", "32", "int", "memory", "=", "32", "int", "parallelism", "=", "4", "int", "iterations", "=", "3", "logger", ".", "info", "(", "\"", "Generating", "Argon2", "hash", "for", "hash", "length", ":", "$", "{", "hashLength", "}", "B", ",", "mem", ":", "$", "{", "memory", "}", "KiB", ",", "parallelism", ":", "$", "{", "parallelism", "}", ",", "iterations", ":", "$", "{", "iterations", "}", "\")", "Argon2SecureHasher", "a2sh", "=", "new", "Argon2SecureHasher", "(", "hashLength", ",", "memory", ",", "parallelism", ",", "iterations", ")", "/", "/", "Override", "the", "static", "salt", "for", "the", "published", "test", "vector", "/", "/", "a2sh", ".", "staticSalt", "=", "[", "0x02", "]", "*", "16", "/", "/", "Act", "byte", "[", "]", "hash", "=", "a2sh", ".", "hashRaw", "(", "[", "0x01", "]", "*", "32", "as", "byte", "[", "])", "logger", ".", "info", "(", "\"", "Generated", "hash", ":", "$", "{", "Hex", ".", "encode", "(", "hash", ")", "}\"", ")", "/", "/", "Assert", "assert", "hash", "=", "=", "decodeHex", "(", "\"", "0d", "64", "0d", "f5", "8d", "78", "76", "6c", "08", "c0", "37", "a3", "4a", "8b", "53", "c9", "d0", "\"", "\"", "1e", "f0", "45", "2d", "75", "b6", "5e", "b5", "25", "20", "e9", "6b", "01", "e6", "59", "\"", ")", "/", "/", "Clean", "up", "/", "/", "Argon2SecureHasher", ".", "staticSalt", "=", "\"", "NiFi", "Static", "Salt", "\"", ".", "bytes", "}", "@", "Test", "void", "testShouldBeDeterministicWithStaticSalt", "(", ")", "{", "/", "/", "Arrange", "int", "hashLength", "=", "32", "int", "memory", "=", "8", "int", "parallelism", "=", "4", "int", "iterations", "=", "4", "logger", ".", "info", "(", "\"", "Generating", "Argon2", "hash", "for", "hash", "length", ":", "$", "{", "hashLength", "}", "B", ",", "mem", ":", "$", "{", "memory", "}", "KiB", ",", "parallelism", ":", "$", "{", "parallelism", "}", ",", "iterations", ":", "$", "{", "iterations", "}", "\")", "int", "testIterations", "=", "10", "byte", "[", "]", "inputBytes", "=", "\"", "This", "is", "a", "sensitive", "value", "\"", ".", "bytes", "final", "String", "EXPECTED_HASH_HEX", "=", "\"", "a73a471f51b2900901a00b81e770b9c1dfc595602bb7aec64cd27754a4174919", "\"", "Argon2SecureHasher", "a2sh", "=", "new", "Argon2SecureHasher", "(", "hashLength", ",", "memory", ",", "parallelism", ",", "iterations", ")", "def", "results", "=", "[", "]", "/", "/", "Act", "testIterations", ".", "times", "{", "int", "i", "-", ">", "byte", "[", "]", "hash", "=", "a2sh", ".", "hashRaw", "(", "inputBytes", ")", "String", "hashHex", "=", "Hex", ".", "encode", "(", "hash", ")", "logger", ".", "info", "(", "\"", "Generated", "hash", ":", "$", "{", "hashHex", "}", "\")", "results", "<", "<", "hashHex", "}", "/", "/", "Assert", "assert", "results", ".", "every", "{", "it", "=", "=", "EXPECTED_HASH_HEX", "}", "}", "@", "Test", "void", "testShouldBeDifferentWithRandomSalt", "(", ")", "{", "/", "/", "Arrange", "int", "hashLength", "=", "32", "int", "memory", "=", "8", "int", "parallelism", "=", "4", "int", "iterations", "=", "4", "logger", ".", "info", "(", "\"", "Generating", "Argon2", "hash", "for", "hash", "length", ":", "$", "{", "hashLength", "}", "B", ",", "mem", ":", "$", "{", "memory", "}", "KiB", ",", "parallelism", ":", "$", "{", "parallelism", "}", ",", "iterations", ":", "$", "{", "iterations", "}", "\")", "int", "testIterations", "=", "10", "byte", "[", "]", "inputBytes", "=", "\"", "This", "is", "a", "sensitive", "value", "\"", ".", "bytes", "final", "String", "EXPECTED_HASH_HEX", "=", "\"", "a73a471f51b2900901a00b81e770b9c1dfc595602bb7aec64cd27754a4174919", "\"", "Argon2SecureHasher", "a2sh", "=", "new", "Argon2SecureHasher", "(", "hashLength", ",", "memory", ",", "parallelism", ",", "iterations", ",", "16", ")", "def", "results", "=", "[", "]", "/", "/", "Act", "testIterations", ".", "times", "{", "int", "i", "-", ">", "byte", "[", "]", "hash", "=", "a2sh", ".", "hashRaw", "(", "inputBytes", ")", "String", "hashHex", "=", "Hex", ".", "encode", "(", "hash", ")", "logger", ".", "info", "(", "\"", "Generated", "hash", ":", "$", "{", "hashHex", "}", "\")", "results", "<", "<", "hashHex", "}", "/", "/", "Assert", "assert", "results", ".", "unique", "(", ").", "size", "(", ")", "=", "=", "results", ".", "size", "(", ")", "assert", "results", ".", "every", "{", "it", "!", "=", "EXPECTED_HASH_HEX", "}", "}", "@", "Test", "void", "testShouldFormatHex", "(", ")", "{", "/", "/", "Arrange", "String", "input", "=", "\"", "This", "is", "a", "sensitive", "value", "\"", "final", "String", "EXPECTED_HASH_HEX", "=", "\"", "0c2920c52f28e0a2c77d006ec6138c8dc59580881468b85541cf886abdebcf18", "\"", "Argon2SecureHasher", "a2sh", "=", "new", "Argon2SecureHasher", "(", ")", "/", "/", "Act", "String", "hashHex", "=", "a2sh", ".", "hashHex", "(", "input", ")", "logger", ".", "info", "(", "\"", "Generated", "hash", ":", "$", "{", "hashHex", "}", "\")", "/", "/", "Assert", "assert", "hashHex", "=", "=", "EXPECTED_HASH_HEX", "}", "@", "Test", "void", "testShouldFormatBase64", "(", ")", "{", "/", "/", "Arrange", "String", "input", "=", "\"", "This", "is", "a", "sensitive", "value", "\"", "final", "String", "EXPECTED_HASH_B64", "=", "\"", "DCkgxS8o4KLHfQBuxhOMjcWVgIgUaLhVQc", "+", "Iar3rzxg", "=", "\"", "Argon2SecureHasher", "a2sh", "=", "new", "Argon2SecureHasher", "(", ")", "/", "/", "Act", "String", "hashB64", "=", "a2sh", ".", "hashBase64", "(", "input", ")", "logger", ".", "info", "(", "\"", "Generated", "hash", ":", "$", "{", "hashB64", "}", "\")", "/", "/", "Assert", "assert", "hashB64", "=", "=", "EXPECTED_HASH_B64", "}", "@", "Test", "void", "testShouldHandleNullInput", "(", ")", "{", "/", "/", "Arrange", "List", "<", "String", ">", "inputs", "=", "[", "null", ",", "\"", "\"]", "final", "String", "EXPECTED_HASH_HEX", "=", "\"", "8e5625a66b94ed9d31c1496d7f9ff49249cf05d6753b50ba0e2bf2a1108973dd", "\"", "final", "String", "EXPECTED_HASH_B64", "=", "\"", "jlYlpmuU7Z0xwUltf5", "/", "0kknPBdZ1O1C6DivyoRCJc90", "=", "\"", "Argon2SecureHasher", "a2sh", "=", "new", "Argon2SecureHasher", "(", ")", "def", "hexResults", "=", "[", "]", "def", "b64Results", "=", "[", "]", "/", "/", "Act", "inputs", ".", "each", "{", "String", "input", "-", ">", "String", "hashHex", "=", "a2sh", ".", "hashHex", "(", "input", ")", "logger", ".", "info", "(", "\"", "Generated", "hash", ":", "$", "{", "hashHex", "}", "\")", "hexResults", "<", "<", "hashHex", "String", "hashB64", "=", "a2sh", ".", "hashBase64", "(", "input", ")", "logger", ".", "info", "(", "\"", "Generated", "hash", ":", "$", "{", "hashB64", "}", "\")", "b64Results", "<", "<", "hashB64", "}", "/", "/", "Assert", "assert", "hexResults", ".", "every", "{", "it", "=", "=", "EXPECTED_HASH_HEX", "}", "assert", "b64Results", ".", "every", "{", "it", "=", "=", "EXPECTED_HASH_B64", "}", "}", "/", "**", "*", "This", "test", "can", "have", "the", "minimum", "time", "threshold", "updated", "to", "determine", "if", "the", "performance", "*", "is", "still", "sufficient", "compared", "to", "the", "existing", "threat", "model", ".", "*", "/", "@", "Test", "void", "testDefaultCostParamsShouldBeSufficient", "(", ")", "{", "/", "/", "Arrange", "int", "testIterations", "=", "10", "byte", "[", "]", "inputBytes", "=", "\"", "This", "is", "a", "sensitive", "value", "\"", ".", "bytes", "Argon2SecureHasher", "a2sh", "=", "new", "Argon2SecureHasher", "(", ")", "def", "results", "=", "[", "]", "def", "resultDurations", "=", "[", "]", "/", "/", "Act", "testIterations", ".", "times", "{", "int", "i", "-", ">", "long", "startNanos", "=", "System", ".", "nanoTime", "(", ")", "byte", "[", "]", "hash", "=", "a2sh", ".", "hashRaw", "(", "inputBytes", ")", "long", "endNanos", "=", "System", ".", "nanoTime", "(", ")", "long", "durationNanos", "=", "endNanos", "-", "startNanos", "String", "hashHex", "=", "Hex", ".", "encode", "(", "hash", ")", "logger", ".", "info", "(", "\"", "Generated", "hash", ":", "$", "{", "hashHex", "}", "in", "$", "{", "durationNanos", "}", "ns", "\"", ")", "results", "<", "<", "hashHex", "resultDurations", "<", "<", "durationNanos", "}", "/", "/", "Assert", "final", "long", "MIN_DURATION_NANOS", "=", "5_000_000", "/", "/", "5", "ms", "assert", "resultDurations", ".", "min", "(", ")", ">", "MIN_DURATION_NANOS", "assert", "resultDurations", ".", "sum", "(", ")", "/", "testIterations", ">", "MIN_DURATION_NANOS", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "39", "@", "@", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "?>", "<", "!-", "-", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "the", "License", ".", "-", "->", "<", "configuration", ">", "<", "appender", "name", "=", "\"", "CONSOLE", "\"", "class", "=", "\"", "ch", ".", "qos", ".", "logback", ".", "core", ".", "ConsoleAppender", "\"", ">", "<", "encoder", "class", "=", "\"", "ch", ".", "qos", ".", "logback", ".", "classic", ".", "encoder", ".", "PatternLayoutEncoder", "\"", ">", "<", "pattern", ">", "%-", "4r", "[", "%", "t", "]", "%", "-", "5p", "%", "c", "{", "3", "}", "-", "%", "m", "%", "n", "<", "/", "pattern", ">", "<", "/", "encoder", ">", "<", "/", "appender", ">", "<", "appender", "name", "=", "\"", "FILE", "\"", "class", "=", "\"", "ch", ".", "qos", ".", "logback", ".", "core", ".", "FileAppender", "\"", ">", "<", "file", ">", "./", "target", "/", "log", "<", "/", "file", ">", "<", "encoder", "class", "=", "\"", "ch", ".", "qos", ".", "logback", ".", "classic", ".", "encoder", ".", "PatternLayoutEncoder", "\"", ">", "<", "pattern", ">", "%", "date", "%", "level", "[", "%", "thread", "]", "%", "logger", "{", "40", "}", "%", "msg", "%", "n", "<", "/", "pattern", ">", "<", "/", "encoder", ">", "<", "/", "appender", ">", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", "\"", "level", "=", "\"", "INFO", "\"", "/>", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", ".", "security", ".", "util", ".", "crypto", "\"", "level", "=", "\"", "DEBUG", "\"", "/>", "<", "root", "level", "=", "\"", "DEBUG", "\"", ">", "<", "appender", "-", "ref", "ref", "=", "\"", "CONSOLE", "\"", "/>", "<", "/", "root", ">", "<", "/", "configuration", ">", "@", "@", "-", "16", ",", "6", "+", "16", ",", "23", "@", "@", "*", "/", "package", "org", ".", "apache", ".", "nifi", ".", "fingerprint", ";", "import", "java", ".", "io", ".", "ByteArrayInputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "UnsupportedEncodingException", ";", "import", "java", ".", "security", ".", "NoSuchAlgorithmException", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Comparator", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "SortedMap", ";", "import", "java", ".", "util", ".", "TreeMap", ";", "import", "java", ".", "util", ".", "stream", ".", "Stream", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "validation", ".", "Schema", ";", "import", "javax", ".", "xml", ".", "validation", ".", "SchemaFactory", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang3", ".", "StringUtils", ";", "import", "org", ".", "apache", ".", "nifi", ".", "bundle", ".", "BundleCoordinate", ";", "import", "org", ".", "apache", ".", "nifi", ".", "components", ".", "ConfigurableComponent", ";", "@", "@", "-", "25", ",", "6", "+", "42", ",", "8", "@", "@", "import", "org", ".", "apache", ".", "nifi", ".", "controller", ".", "serialization", ".", "FlowFromDOMFactory", ";", "import", "org", ".", "apache", ".", "nifi", ".", "encrypt", ".", "StringEncryptor", ";", "import", "org", ".", "apache", ".", "nifi", ".", "nar", ".", "ExtensionManager", ";", "import", "org", ".", "apache", ".", "nifi", ".", "security", ".", "util", ".", "crypto", ".", "Argon2SecureHasher", ";", "import", "org", ".", "apache", ".", "nifi", ".", "security", ".", "util", ".", "crypto", ".", "SecureHasher", ";", "import", "org", ".", "apache", ".", "nifi", ".", "util", ".", "BundleUtils", ";", "import", "org", ".", "apache", ".", "nifi", ".", "util", ".", "DomUtils", ";", "import", "org", ".", "apache", ".", "nifi", ".", "util", ".", "LoggingXmlParserErrorHandler", ";", "@", "@", "-", "39", ",", "24", "+", "58", ",", "6", "@", "@", "import", "org", ".", "w3c", ".", "dom", ".", "NodeList", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "validation", ".", "Schema", ";", "import", "javax", ".", "xml", ".", "validation", ".", "SchemaFactory", ";", "import", "java", ".", "io", ".", "ByteArrayInputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "UnsupportedEncodingException", ";", "import", "java", ".", "security", ".", "NoSuchAlgorithmException", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Comparator", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "SortedMap", ";", "import", "java", ".", "util", ".", "TreeMap", ";", "import", "java", ".", "util", ".", "stream", ".", "Stream", ";", "/", "**", "*", "<", "p", ">", "Creates", "a", "fingerprint", "of", "a", "flow", ".", "xml", ".", "The", "order", "of", "elements", "or", "attributes", "in", "the", "flow", ".", "xml", "does", "not", "influence", "the", "fingerprint", "generation", ".", "*", "@", "@", "-", "342", ",", "7", "+", "343", ",", "7", "@", "@", "private", "void", "addParameter", "(", "final", "StringBuilder", "builder", ",", "final", "Element", "parameterEl", "/", "/", "append", "value", "if", "(", "isEncrypted", "(", "value", ")", ")", "{", "/", "/", "propValue", "is", "non", "null", ",", "no", "need", "to", "use", "getValue", "builder", ".", "append", "(", "decrypt", "(", "value", ")", ");", "builder", ".", "append", "(", "getLoggableRepresentationOfSensitiveValue", "(", "value", ")", ");", "}", "else", "{", "builder", ".", "append", "(", "getValue", "(", "value", ",", "NO_VALUE", ")", ");", "}", "@", "@", "-", "532", ",", "15", "+", "533", ",", "41", "@", "@", "private", "StringBuilder", "addPropertyFingerprint", "(", "final", "StringBuilder", "builder", ",", "final", "/", "/", "append", "value", "if", "(", "isEncrypted", "(", "propValue", ")", ")", "{", "/", "/", "propValue", "is", "non", "null", ",", "no", "need", "to", "use", "getValue", "builder", ".", "append", "(", "decrypt", "(", "propValue", ")", ");", "/", "/", "Get", "a", "secure", ",", "deterministic", ",", "loggable", "representation", "of", "this", "value", "builder", ".", "append", "(", "getLoggableRepresentationOfSensitiveValue", "(", "propValue", ")", ");", "}", "else", "{", "builder", ".", "append", "(", "getValue", "(", "propValue", ",", "NO_VALUE", ")", ");", "}", "return", "builder", ";", "}", "/", "**", "*", "Returns", "a", "securely", "-", "derived", ",", "deterministic", "value", "from", "the", "provided", "encrypted", "property", "*", "value", ".", "This", "is", "because", "the", "flow", "fingerprint", "is", "displayed", "in", "the", "log", "if", "NiFi", "has", "*", "trouble", "inheriting", "a", "flow", ",", "so", "the", "sensitive", "value", "should", "not", "be", "disclosed", "through", "the", "*", "log", ".", "However", ",", "the", "equality", "or", "difference", "of", "the", "sensitive", "value", "can", "influence", "in", "the", "*", "inheritability", "of", "the", "flow", ",", "so", "it", "cannot", "be", "ignored", "completely", ".", "*", "*", "The", "specific", "derivation", "process", "is", "unimportant", "as", "long", "as", "it", "is", "a", "salted", ",", "*", "cryptographically", "-", "secure", "hash", "function", "with", "an", "iteration", "cost", "sufficient", "for", "password", "*", "storage", "in", "other", "applications", ".", "*", "*", "@", "param", "encryptedPropertyValue", "the", "encrypted", "property", "value", "*", "@", "return", "a", "deterministic", "string", "value", "which", "represents", "this", "input", "but", "is", "safe", "to", "print", "in", "a", "log", "*", "/", "private", "String", "getLoggableRepresentationOfSensitiveValue", "(", "String", "encryptedPropertyValue", ")", "{", "/", "/", "TODO", ":", "Implement", "Scrypt", "or", "Argon2", "secure", "hash", "of", "decrypted", "value", "/", "/", "TODO", ":", "Use", "DI", "/", "IoC", "to", "inject", "this", "implementation", "in", "the", "constructor", "of", "the", "FingerprintFactory", "/", "/", "There", "is", "little", "initialization", "cost", ",", "so", "it", "doesn", "'", "t", "make", "sense", "to", "cache", "this", "as", "a", "field", "SecureHasher", "secureHasher", "=", "new", "Argon2SecureHasher", "(", ");", "/", "/", "TODO", ":", "Extend", "{", "@", "link", "StringEncryptor", "}", "with", "secure", "hashing", "capability", "and", "inject", "?", "String", "hexEncodedHash", "=", "secureHasher", ".", "hashHex", "(", "decrypt", "(", "encryptedPropertyValue", ")", ");", "return", "hexEncodedHash", ";", "}", "private", "StringBuilder", "addPortFingerprint", "(", "final", "StringBuilder", "builder", ",", "final", "Element", "portElem", ")", "throws", "FingerprintException", "{", "/", "/", "id", "appendFirstValue", "(", "builder", ",", "DomUtils", ".", "getChildNodesByTagName", "(", "portElem", ",", "\"", "id", "\"", "))", ";", "@", "@", "-", "593", ",", "7", "+", "620", ",", "7", "@", "@", "private", "StringBuilder", "addRemoteProcessGroupFingerprint", "(", "final", "StringBuilder", "build", "\"", "transportProtocol", "\"", ",", "\"", "proxyHost", "\"", ",", "\"", "proxyPort", "\"", ",", "\"", "proxyUser", "\"", ",", "\"", "proxyPassword", "\"", "})", "{", "final", "String", "value", "=", "getFirstValue", "(", "DomUtils", ".", "getChildNodesByTagName", "(", "remoteProcessGroupElem", ",", "tagName", ")", ");", "if", "(", "isEncrypted", "(", "value", ")", ")", "{", "builder", ".", "append", "(", "decrypt", "(", "value", ")", ");", "builder", ".", "append", "(", "getLoggableRepresentationOfSensitiveValue", "(", "value", ")", ");", "}", "else", "{", "builder", ".", "append", "(", "value", ")", ";", "}", "@", "@", "-", "824", ",", "15", "+", "851", ",", "15", "@", "@", "public", "int", "compare", "(", "final", "Element", "e1", ",", "final", "Element", "e2", ")", "{", "final", "String", "e1PropName", "=", "getFirstValue", "(", "DomUtils", ".", "getChildNodesByTagName", "(", "e1", ",", "\"", "name", "\"", "))", ";", "String", "e1PropValue", "=", "getFirstValue", "(", "DomUtils", ".", "getChildNodesByTagName", "(", "e1", ",", "\"", "value", "\"", "))", ";", "if", "(", "isEncrypted", "(", "e1PropValue", ")", ")", "{", "e1PropValue", "=", "decrypt", "(", "e1PropValue", ")", ";", "e1PropValue", "=", "getLoggableRepresentationOfSensitiveValue", "(", "e1PropValue", ")", ";", "}", "final", "String", "e1CombinedValue", "=", "e1PropName", "+", "e1PropValue", ";", "/", "/", "combine", "the", "property", "name", "and", "value", "for", "the", "second", "required", "property", "final", "String", "e2PropName", "=", "getFirstValue", "(", "DomUtils", ".", "getChildNodesByTagName", "(", "e2", ",", "\"", "name", "\"", "))", ";", "String", "e2PropValue", "=", "getFirstValue", "(", "DomUtils", ".", "getChildNodesByTagName", "(", "e2", ",", "\"", "value", "\"", "))", ";", "if", "(", "isEncrypted", "(", "e2PropValue", ")", ")", "{", "e2PropValue", "=", "decrypt", "(", "e2PropValue", ")", ";", "e2PropValue", "=", "getLoggableRepresentationOfSensitiveValue", "(", "e2PropValue", ")", ";", "}", "final", "String", "e2CombinedValue", "=", "e2PropName", "+", "e2PropValue", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "88", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "nifi", ".", "fingerprint", "import", "org", ".", "apache", ".", "nifi", ".", "encrypt", ".", "StringEncryptor", "import", "org", ".", "apache", ".", "nifi", ".", "nar", ".", "ExtensionManager", "import", "org", ".", "apache", ".", "nifi", ".", "nar", ".", "StandardExtensionDiscoveringManager", "import", "org", ".", "bouncycastle", ".", "jce", ".", "provider", ".", "BouncyCastleProvider", "import", "org", ".", "junit", ".", "After", "import", "org", ".", "junit", ".", "Before", "import", "org", ".", "junit", ".", "BeforeClass", "import", "org", ".", "junit", ".", "Test", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", "import", "org", ".", "junit", ".", "runners", ".", "JUnit4", "import", "org", ".", "slf4j", ".", "Logger", "import", "org", ".", "slf4j", ".", "LoggerFactory", "import", "java", ".", "security", ".", "Security", "@", "RunWith", "(", "JUnit4", ".", "class", ")", "class", "FingerprintFactoryGroovyTest", "extends", "GroovyTestCase", "{", "private", "static", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "FingerprintFactoryGroovyTest", ".", "class", ")", "private", "static", "StringEncryptor", "mockEncryptor", "=", "[", "encrypt", ":", "{", "String", "plaintext", "-", ">", "plaintext", ".", "reverse", "(", ")", "}", ",", "decrypt", ":", "{", "String", "cipherText", "-", ">", "cipherText", ".", "reverse", "(", ")", "}", "]", "as", "StringEncryptor", "private", "static", "ExtensionManager", "extensionManager", "=", "new", "StandardExtensionDiscoveringManager", "(", ")", "@", "BeforeClass", "static", "void", "setUpOnce", "(", ")", "throws", "Exception", "{", "Security", ".", "addProvider", "(", "new", "BouncyCastleProvider", "(", "))", "logger", ".", "metaClass", ".", "methodMissing", "=", "{", "String", "name", ",", "args", "-", ">", "logger", ".", "info", "(", "\"[", "${", "name", "?", ".", "toUpperCase", "(", ")}", "]", "$", "{(", "args", "as", "List", ")", ".", "join", "(", "\"", "\"", ")}", "\")", "}", "}", "@", "Before", "void", "setUp", "(", ")", "throws", "Exception", "{", "}", "@", "After", "void", "tearDown", "(", ")", "throws", "Exception", "{", "}", "/", "**", "*", "The", "flow", "fingerprint", "should", "not", "disclose", "sensitive", "property", "values", ".", "*", "/", "@", "Test", "void", "testCreateFingerprintShouldNotDiscloseSensitivePropertyValues", "(", ")", "{", "/", "/", "Arrange", "/", "/", "Create", "flow", "String", "initialFlowXML", "=", "new", "File", "(", "\"", "src", "/", "test", "/", "resources", "/", "nifi", "/", "fingerprint", "/", "initial", ".", "xml", "\"", ").", "text", "logger", ".", "info", "(", "\"", "Read", "initial", "flow", ":", "$", "{", "initialFlowXML", "[", "0", ".", ".<", "100", "]", "}.", "..", "\")", "/", "/", "Create", "the", "FingerprintFactory", "with", "collaborators", "FingerprintFactory", "fingerprintFactory", "=", "new", "FingerprintFactory", "(", "mockEncryptor", ",", "extensionManager", ")", "/", "/", "Act", "/", "/", "Create", "the", "fingerprint", "from", "the", "flow", "String", "fingerprint", "=", "fingerprintFactory", ".", "createFingerprint", "(", "initialFlowXML", ".", "bytes", ")", "logger", ".", "info", "(", "\"", "Generated", "flow", "fingerprint", ":", "$", "{", "fingerprint", "}", "\")", "/", "/", "Assert", "/", "/", "Assert", "the", "fingerprint", "does", "not", "contain", "the", "password", "assert", "!", "(", "fingerprint", "=", "~", "\"", "originalPlaintextPassword", "\"", ")", "}", "}", "@", "@", "-", "16", ",", "6", "+", "16", ",", "26", "@", "@", "*", "/", "package", "org", ".", "apache", ".", "nifi", ".", "fingerprint", ";", "import", "static", "org", ".", "apache", ".", "nifi", ".", "controller", ".", "serialization", ".", "ScheduledStateLookup", ".", "IDENTITY_LOOKUP", ";", "import", "static", "org", ".", "apache", ".", "nifi", ".", "fingerprint", ".", "FingerprintFactory", ".", "FLOW_CONFIG_XSD", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Optional", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "javax", ".", "xml", ".", "validation", ".", "Schema", ";", "import", "javax", ".", "xml", ".", "validation", ".", "SchemaFactory", ";", "import", "org", ".", "apache", ".", "commons", ".", "io", ".", "IOUtils", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang3", ".", "StringUtils", ";", "import", "org", ".", "apache", ".", "nifi", ".", "connectable", ".", "Position", ";", "@", "@", "-", "30", ",", "6", "+", "50", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "nifi", ".", "nar", ".", "StandardExtensionDiscoveringManager", ";", "import", "org", ".", "apache", ".", "nifi", ".", "remote", ".", "RemoteGroupPort", ";", "import", "org", ".", "apache", ".", "nifi", ".", "remote", ".", "protocol", ".", "SiteToSiteTransportProtocol", ";", "import", "org", ".", "apache", ".", "nifi", ".", "security", ".", "util", ".", "crypto", ".", "Argon2SecureHasher", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "@", "@", "-", "38", ",", "27", "+", "59", ",", "6", "@", "@", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXParseException", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "javax", ".", "xml", ".", "validation", ".", "Schema", ";", "import", "javax", ".", "xml", ".", "validation", ".", "SchemaFactory", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Optional", ";", "import", "static", "org", ".", "apache", ".", "nifi", ".", "controller", ".", "serialization", ".", "ScheduledStateLookup", ".", "IDENTITY_LOOKUP", ";", "import", "static", "org", ".", "apache", ".", "nifi", ".", "fingerprint", ".", "FingerprintFactory", ".", "FLOW_CONFIG_XSD", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "/", "**", "*", "/", "public", "class", "FingerprintFactoryTest", "{", "@", "@", "-", "248", ",", "6", "+", "248", ",", "7", "@", "@", "public", "void", "testRemoteProcessGroupFingerprintRaw", "(", ")", "throws", "Exception", "{", "@", "Test", "public", "void", "testRemoteProcessGroupFingerprintWithProxy", "(", ")", "throws", "Exception", "{", "final", "String", "proxyPassword", "=", "\"", "proxy", "-", "pass", "\"", ";", "/", "/", "Fill", "out", "every", "configuration", ".", "final", "RemoteProcessGroup", "component", "=", "mock", "(", "RemoteProcessGroup", ".", "class", ")", ";", "@", "@", "-", "263", ",", "10", "+", "264", ",", "11", "@", "@", "public", "void", "testRemoteProcessGroupFingerprintWithProxy", "(", ")", "throws", "Exception", "{", "when", "(", "component", ".", "getProxyHost", "(", "))", ".", "thenReturn", "(", "\"", "proxy", "-", "host", "\"", ");", "when", "(", "component", ".", "getProxyPort", "(", "))", ".", "thenReturn", "(", "3128", ")", ";", "when", "(", "component", ".", "getProxyUser", "(", "))", ".", "thenReturn", "(", "\"", "proxy", "-", "user", "\"", ");", "when", "(", "component", ".", "getProxyPassword", "(", "))", ".", "thenReturn", "(", "\"", "proxy", "-", "pass", "\"", ");", "when", "(", "component", ".", "getProxyPassword", "(", "))", ".", "thenReturn", "(", "proxyPassword", ")", ";", "when", "(", "component", ".", "getVersionedComponentId", "(", "))", ".", "thenReturn", "(", "Optional", ".", "empty", "(", "))", ";", "/", "/", "Assert", "fingerprints", "with", "expected", "one", ".", "final", "String", "hashedProxyPassword", "=", "new", "Argon2SecureHasher", "(", ").", "hashHex", "(", "proxyPassword", ")", ";", "final", "String", "expected", "=", "\"", "id", "\"", "+", "\"", "NO_VALUE", "\"", "+", "\"", "http", ":", "//", "node1", ":", "8080", "/", "nifi", ",", "http", ":", "//", "node2", ":", "8080", "/", "nifi", "\"", "+", "@", "@", "-", "277", ",", "11", "+", "279", ",", "11", "@", "@", "public", "void", "testRemoteProcessGroupFingerprintWithProxy", "(", ")", "throws", "Exception", "{", "\"", "proxy", "-", "host", "\"", "+", "\"", "3128", "\"", "+", "\"", "proxy", "-", "user", "\"", "+", "\"", "proxy", "-", "pass", "\"", ";", "hashedProxyPassword", ";", "final", "Element", "rootElement", "=", "serializeElement", "(", "encryptor", ",", "RemoteProcessGroup", ".", "class", ",", "component", ",", "\"", "addRemoteProcessGroup", "\"", ",", "IDENTITY_LOOKUP", ")", ";", "final", "Element", "componentElement", "=", "(", "Element", ")", "rootElement", ".", "getElementsByTagName", "(", "\"", "remoteProcessGroup", "\"", ").", "item", "(", "0", ")", ";", "assertEquals", "(", "expected", ".", "toString", "(", "),", "fingerprint", "(", "\"", "addRemoteProcessGroupFingerprint", "\"", ",", "Element", ".", "class", ",", "componentElement", ")", ");", "assertEquals", "(", "expected", ",", "fingerprint", "(", "\"", "addRemoteProcessGroupFingerprint", "\"", ",", "Element", ".", "class", ",", "componentElement", ")", ");", "}", "@", "Test", "@", "@", "-", "33", ",", "6", "+", "33", ",", "7", "@", "@", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", ".", "controller", ".", "tasks", "\"", "level", "=", "\"", "DEBUG", "\"", "/", ">\"", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", ".", "controller", ".", "service", "\"", "level", "=", "\"", "DEBUG", "\"", "/>", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", ".", "encrypt", "\"", "level", "=", "\"", "DEBUG", "\"", "/>", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", ".", "security", ".", "util", ".", "crypto", "\"", "level", "=", "\"", "DEBUG", "\"", "/>", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", ".", "controller", ".", "repository", ".", "crypto", "\"", "level", "=", "\"", "DEBUG", "\"", "/>", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", ".", "security", ".", "repository", "\"", "level", "=", "\"", "DEBUG", "\"", "/>", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", ".", "controller", ".", "service", ".", "mock", "\"", "level", "=", "\"", "ERROR", "\"", "/>", "@", "@", "-", "0", ",", "0", "+", "1", ",", "152", "@", "@", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "standalone", "=", "\"", "no", "\"", "?>", "<", "!-", "-", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "the", "License", ".", "-", "->", "<", "flowController", "encoding", "-", "version", "=", "\"", "1", ".", "4", "\"", ">", "<", "maxTimerDrivenThreadCount", ">", "10", "<", "/", "maxTimerDrivenThreadCount", ">", "<", "maxEventDrivenThreadCount", ">", "1", "<", "/", "maxEventDrivenThreadCount", ">", "<", "registries", "/", ">", "<", "parameterContexts", "/", ">", "<", "rootGroup", ">", "<", "id", ">", "f31f71c7", "-", "016f", "-", "1000", "-", "52b1", "-", "4f4e21375b31", "<", "/", "id", ">", "<", "name", ">", "NiFi", "Flow", "<", "/", "name", ">", "<", "position", "x", "=", "\"", "0", ".", "0", "\"", "y", "=", "\"", "0", ".", "0", "\"", "/>", "<", "comment", "/", ">", "<", "processor", ">", "<", "id", ">", "f3214b1c", "-", "016f", "-", "1000", "-", "0000", "-", "00001b1546be", "<", "/", "id", ">", "<", "name", ">", "GetFTP", "<", "/", "name", ">", "<", "position", "x", "=", "\"", "363", ".", "0", "\"", "y", "=", "\"", "111", ".", "01388549804688", "\"", "/>", "<", "styles", "/", ">", "<", "comment", "/", ">", "<", "class", ">", "org", ".", "apache", ".", "nifi", ".", "processors", ".", "standard", ".", "GetFTP", "<", "/", "class", ">", "<", "bundle", ">", "<", "group", ">", "org", ".", "apache", ".", "nifi", "<", "/", "group", ">", "<", "artifact", ">", "nifi", "-", "standard", "-", "nar", "<", "/", "artifact", ">", "<", "version", ">", "1", ".", "11", ".", "0", "<", "/", "version", ">", "<", "/", "bundle", ">", "<", "maxConcurrentTasks", ">", "1", "<", "/", "maxConcurrentTasks", ">", "<", "schedulingPeriod", ">", "0", "sec", "<", "/", "schedulingPeriod", ">", "<", "penalizationPeriod", ">", "30", "sec", "<", "/", "penalizationPeriod", ">", "<", "yieldPeriod", ">", "1", "sec", "<", "/", "yieldPeriod", ">", "<", "bulletinLevel", ">", "WARN", "<", "/", "bulletinLevel", ">", "<", "lossTolerant", ">", "false", "<", "/", "lossTolerant", ">", "<", "scheduledState", ">", "STOPPED", "<", "/", "scheduledState", ">", "<", "schedulingStrategy", ">", "TIMER_DRIVEN", "<", "/", "schedulingStrategy", ">", "<", "executionNode", ">", "ALL", "<", "/", "executionNode", ">", "<", "runDurationNanos", ">", "0", "<", "/", "runDurationNanos", ">", "<", "property", ">", "<", "name", ">", "Hostname", "<", "/", "name", ">", "<", "value", ">", "abc", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Port", "<", "/", "name", ">", "<", "value", ">", "21", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Username", "<", "/", "name", ">", "<", "value", ">", "abc", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Password", "<", "/", "name", ">", "<", "value", ">", "enc", "{", "drowssaPtxetnialPlanigiro", "}", "</", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Connection", "Mode", "<", "/", "name", ">", "<", "value", ">", "Passive", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Transfer", "Mode", "<", "/", "name", ">", "<", "value", ">", "Binary", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Remote", "Path", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "File", "Filter", "Regex", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Path", "Filter", "Regex", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Polling", "Interval", "<", "/", "name", ">", "<", "value", ">", "60", "sec", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Search", "Recursively", "<", "/", "name", ">", "<", "value", ">", "false", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "follow", "-", "symlink", "<", "/", "name", ">", "<", "value", ">", "false", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Ignore", "Dotted", "Files", "<", "/", "name", ">", "<", "value", ">", "true", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Delete", "Original", "<", "/", "name", ">", "<", "value", ">", "true", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Connection", "Timeout", "<", "/", "name", ">", "<", "value", ">", "30", "sec", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Data", "Timeout", "<", "/", "name", ">", "<", "value", ">", "30", "sec", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Max", "Selects", "<", "/", "name", ">", "<", "value", ">", "100", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Remote", "Poll", "Batch", "Size", "<", "/", "name", ">", "<", "value", ">", "5000", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Use", "Natural", "Ordering", "<", "/", "name", ">", "<", "value", ">", "false", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "proxy", "-", "configuration", "-", "service", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Proxy", "Type", "<", "/", "name", ">", "<", "value", ">", "DIRECT", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Proxy", "Host", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Proxy", "Port", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Http", "Proxy", "Username", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Http", "Proxy", "Password", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Internal", "Buffer", "Size", "<", "/", "name", ">", "<", "value", ">", "16KB", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "ftp", "-", "use", "-", "utf8", "<", "/", "name", ">", "<", "value", ">", "false", "<", "/", "value", ">", "<", "/", "property", ">", "<", "/", "processor", ">", "<", "/", "rootGroup", ">", "<", "controllerServices", "/", ">", "<", "reportingTasks", "/", ">", "<", "/", "flowController", ">", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "0", ",", "0", "+", "1", ",", "152", "@", "@", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "standalone", "=", "\"", "no", "\"", "?>", "<", "!-", "-", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "the", "License", ".", "-", "->", "<", "flowController", "encoding", "-", "version", "=", "\"", "1", ".", "4", "\"", ">", "<", "maxTimerDrivenThreadCount", ">", "10", "<", "/", "maxTimerDrivenThreadCount", ">", "<", "maxEventDrivenThreadCount", ">", "1", "<", "/", "maxEventDrivenThreadCount", ">", "<", "registries", "/", ">", "<", "parameterContexts", "/", ">", "<", "rootGroup", ">", "<", "id", ">", "f31f71c7", "-", "016f", "-", "1000", "-", "52b1", "-", "4f4e21375b31", "<", "/", "id", ">", "<", "name", ">", "NiFi", "Flow", "<", "/", "name", ">", "<", "position", "x", "=", "\"", "0", ".", "0", "\"", "y", "=", "\"", "0", ".", "0", "\"", "/>", "<", "comment", "/", ">", "<", "processor", ">", "<", "id", ">", "f3214b1c", "-", "016f", "-", "1000", "-", "0000", "-", "00001b1546be", "<", "/", "id", ">", "<", "name", ">", "GetFTP", "<", "/", "name", ">", "<", "position", "x", "=", "\"", "363", ".", "0", "\"", "y", "=", "\"", "111", ".", "01388549804688", "\"", "/>", "<", "styles", "/", ">", "<", "comment", "/", ">", "<", "class", ">", "org", ".", "apache", ".", "nifi", ".", "processors", ".", "standard", ".", "GetFTP", "<", "/", "class", ">", "<", "bundle", ">", "<", "group", ">", "org", ".", "apache", ".", "nifi", "<", "/", "group", ">", "<", "artifact", ">", "nifi", "-", "standard", "-", "nar", "<", "/", "artifact", ">", "<", "version", ">", "1", ".", "11", ".", "0", "<", "/", "version", ">", "<", "/", "bundle", ">", "<", "maxConcurrentTasks", ">", "1", "<", "/", "maxConcurrentTasks", ">", "<", "schedulingPeriod", ">", "0", "sec", "<", "/", "schedulingPeriod", ">", "<", "penalizationPeriod", ">", "30", "sec", "<", "/", "penalizationPeriod", ">", "<", "yieldPeriod", ">", "1", "sec", "<", "/", "yieldPeriod", ">", "<", "bulletinLevel", ">", "WARN", "<", "/", "bulletinLevel", ">", "<", "lossTolerant", ">", "false", "<", "/", "lossTolerant", ">", "<", "scheduledState", ">", "STOPPED", "<", "/", "scheduledState", ">", "<", "schedulingStrategy", ">", "TIMER_DRIVEN", "<", "/", "schedulingStrategy", ">", "<", "executionNode", ">", "ALL", "<", "/", "executionNode", ">", "<", "runDurationNanos", ">", "0", "<", "/", "runDurationNanos", ">", "<", "property", ">", "<", "name", ">", "Hostname", "<", "/", "name", ">", "<", "value", ">", "abc", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Port", "<", "/", "name", ">", "<", "value", ">", "21", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Username", "<", "/", "name", ">", "<", "value", ">", "abc", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Password", "<", "/", "name", ">", "<", "value", ">", "enc", "{", "drowssaPtxetnialPdeifidom", "}", "</", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Connection", "Mode", "<", "/", "name", ">", "<", "value", ">", "Passive", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Transfer", "Mode", "<", "/", "name", ">", "<", "value", ">", "Binary", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Remote", "Path", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "File", "Filter", "Regex", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Path", "Filter", "Regex", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Polling", "Interval", "<", "/", "name", ">", "<", "value", ">", "60", "sec", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Search", "Recursively", "<", "/", "name", ">", "<", "value", ">", "false", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "follow", "-", "symlink", "<", "/", "name", ">", "<", "value", ">", "false", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Ignore", "Dotted", "Files", "<", "/", "name", ">", "<", "value", ">", "true", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Delete", "Original", "<", "/", "name", ">", "<", "value", ">", "true", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Connection", "Timeout", "<", "/", "name", ">", "<", "value", ">", "30", "sec", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Data", "Timeout", "<", "/", "name", ">", "<", "value", ">", "30", "sec", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Max", "Selects", "<", "/", "name", ">", "<", "value", ">", "100", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Remote", "Poll", "Batch", "Size", "<", "/", "name", ">", "<", "value", ">", "5000", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Use", "Natural", "Ordering", "<", "/", "name", ">", "<", "value", ">", "false", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "proxy", "-", "configuration", "-", "service", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Proxy", "Type", "<", "/", "name", ">", "<", "value", ">", "DIRECT", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Proxy", "Host", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Proxy", "Port", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Http", "Proxy", "Username", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Http", "Proxy", "Password", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Internal", "Buffer", "Size", "<", "/", "name", ">", "<", "value", ">", "16KB", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "ftp", "-", "use", "-", "utf8", "<", "/", "name", ">", "<", "value", ">", "false", "<", "/", "value", ">", "<", "/", "property", ">", "<", "/", "processor", ">", "<", "/", "rootGroup", ">", "<", "controllerServices", "/", ">", "<", "reportingTasks", "/", ">", "<", "/", "flowController", ">", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "16", ",", "8", "+", "16", ",", "22", "@", "@", "*", "/", "package", "org", ".", "apache", ".", "nifi", ".", "web", ".", "security", ".", "jwt", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "fail", ";", "import", "static", "org", ".", "mockito", ".", "ArgumentMatchers", ".", "anyInt", ";", "import", "static", "org", ".", "mockito", ".", "ArgumentMatchers", ".", "anyString", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doAnswer", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "import", "io", ".", "jsonwebtoken", ".", "JwtException", ";", "import", "org", ".", "apache", ".", "commons", ".", "codec", ".", "CharEncoding", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "security", ".", "InvalidKeyException", ";", "import", "java", ".", "security", ".", "NoSuchAlgorithmException", ";", "import", "java", ".", "util", ".", "LinkedHashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "javax", ".", "crypto", ".", "Mac", ";", "import", "javax", ".", "crypto", ".", "spec", ".", "SecretKeySpec", ";", "import", "org", ".", "apache", ".", "commons", ".", "codec", ".", "binary", ".", "Base64", ";", "import", "org", ".", "apache", ".", "nifi", ".", "admin", ".", "service", ".", "AdministrationException", ";", "import", "org", ".", "apache", ".", "nifi", ".", "admin", ".", "service", ".", "KeyService", ";", "@", "@", "-", "40", ",", "22", "+", "54", ",", "6", "@", "@", "import", "org", ".", "springframework", ".", "security", ".", "core", ".", "context", ".", "SecurityContext", ";", "import", "org", ".", "springframework", ".", "security", ".", "core", ".", "context", ".", "SecurityContextHolder", ";", "import", "javax", ".", "crypto", ".", "Mac", ";", "import", "javax", ".", "crypto", ".", "spec", ".", "SecretKeySpec", ";", "import", "java", ".", "io", ".", "UnsupportedEncodingException", ";", "import", "java", ".", "security", ".", "InvalidKeyException", ";", "import", "java", ".", "security", ".", "NoSuchAlgorithmException", ";", "import", "java", ".", "util", ".", "LinkedHashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "fail", ";", "import", "static", "org", ".", "mockito", ".", "ArgumentMatchers", ".", "anyInt", ";", "import", "static", "org", ".", "mockito", ".", "ArgumentMatchers", ".", "anyString", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doAnswer", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "public", "class", "JwtServiceTest", "{", "private", "static", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "JwtServiceTest", ".", "class", ")", ";", "@", "@", "-", "155", ",", "16", "+", "153", ",", "16", "@", "@", "private", "static", "String", "generateHS256Token", "(", "String", "rawHeader", ",", "String", "rawPayload", ",", "St", "try", "{", "logger", ".", "info", "(", "\"", "Generating", "token", "for", "\"", "+", "rawHeader", "+", "\"", "+", "\"", "+", "rawPayload", ")", ";", "String", "base64Header", "=", "Base64", ".", "encodeBase64URLSafeString", "(", "rawHeader", ".", "getBytes", "(", "CharEncoding", ".", "UTF_8", ")", ");", "String", "base64Payload", "=", "Base64", ".", "encodeBase64URLSafeString", "(", "rawPayload", ".", "getBytes", "(", "CharEncoding", ".", "UTF_8", ")", ");", "String", "base64Header", "=", "Base64", ".", "encodeBase64URLSafeString", "(", "rawHeader", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ");", "String", "base64Payload", "=", "Base64", ".", "encodeBase64URLSafeString", "(", "rawPayload", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ");", "/", "/", "TODO", ":", "Support", "valid", "/", "invalid", "manipulation", "final", "String", "body", "=", "base64Header", "+", "TOKEN_DELIMITER", "+", "base64Payload", ";", "String", "signature", "=", "generateHMAC", "(", "hmacSecret", ",", "body", ")", ";", "return", "body", "+", "TOKEN_DELIMITER", "+", "signature", ";", "}", "catch", "(", "NoSuchAlgorithmException", "|", "InvalidKeyException", "|", "UnsupportedEncodingException", "e", ")", "{", "}", "catch", "(", "NoSuchAlgorithmException", "|", "InvalidKeyException", "e", ")", "{", "final", "String", "errorMessage", "=", "\"", "Could", "not", "generate", "the", "token", "\"", ";", "logger", ".", "error", "(", "errorMessage", ",", "e", ")", ";", "fail", "(", "errorMessage", ")", ";", "@", "@", "-", "173", ",", "11", "+", "171", ",", "11", "@", "@", "private", "static", "String", "generateHS256Token", "(", "String", "rawHeader", ",", "String", "rawPayload", ",", "St", "}", "private", "static", "String", "generateHMAC", "(", "String", "hmacSecret", ",", "String", "body", ")", "throws", "NoSuchAlgorithmException", ",", "UnsupportedEncodingException", ",", "InvalidKeyException", "{", "InvalidKeyException", "{", "Mac", "hmacSHA256", "=", "Mac", ".", "getInstance", "(", "\"", "HmacSHA256", "\"", ");", "SecretKeySpec", "secret_key", "=", "new", "SecretKeySpec", "(", "hmacSecret", ".", "getBytes", "(", "\"", "UTF", "-", "8", "\"", "),", "\"", "HmacSHA256", "\"", ");", "SecretKeySpec", "secret_key", "=", "new", "SecretKeySpec", "(", "hmacSecret", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ",", "\"", "HmacSHA256", "\"", ");", "hmacSHA256", ".", "init", "(", "secret_key", ")", ";", "return", "Base64", ".", "encodeBase64URLSafeString", "(", "hmacSHA256", ".", "doFinal", "(", "body", ".", "getBytes", "(", "\"", "UTF", "-", "8", "\"", "))", ");", "return", "Base64", ".", "encodeBase64URLSafeString", "(", "hmacSHA256", ".", "doFinal", "(", "body", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", "))", ";", "}", "@", "Before", "@", "@", "-", "481", ",", "7", "+", "479", ",", "6", "@", "@", "public", "void", "testShouldNotGenerateTokenWithMissingKey", "(", ")", "throws", "Exception", "{", "@", "Test", "public", "void", "testShouldLogOutUser", "(", ")", "throws", "Exception", "{", "/", "/", "Arrange", "expectedException", ".", "expect", "(", "JwtException", ".", "class", ")", ";", "expectedException", ".", "expectMessage", "(", "\"", "Unable", "to", "validate", "the", "access", "token", ".", "\")", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["GEODE-3685:", "MBean", "wrappers", "are", "properly", "invoked", "over", "http", "This", "closes", "#838."], "code_tokens": ["@", "@", "-", "0", ",", "0", "+", "1", ",", "66", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "*", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "*", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "*", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "*", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "*", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "*", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "cli", ".", "commands", ";", "import", "static", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "ConfigurationProperties", ".", "SECURITY_MANAGER", ";", "import", "static", "org", ".", "assertj", ".", "core", ".", "api", ".", "Assertions", ".", "assertThat", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "FileOutputStream", ";", "import", "java", ".", "util", ".", "Properties", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Rule", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "experimental", ".", "categories", ".", "Category", ";", "import", "org", ".", "apache", ".", "geode", ".", "examples", ".", "SimpleSecurityManager", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "cli", ".", "util", ".", "CommandStringBuilder", ";", "import", "org", ".", "apache", ".", "geode", ".", "test", ".", "junit", ".", "categories", ".", "AcceptanceTest", ";", "import", "org", ".", "apache", ".", "geode", ".", "test", ".", "junit", ".", "rules", ".", "gfsh", ".", "GfshExecution", ";", "import", "org", ".", "apache", ".", "geode", ".", "test", ".", "junit", ".", "rules", ".", "gfsh", ".", "GfshRule", ";", "import", "org", ".", "apache", ".", "geode", ".", "test", ".", "junit", ".", "rules", ".", "gfsh", ".", "GfshScript", ";", "@", "Category", "(", "AcceptanceTest", ".", "class", ")", "public", "class", "StopServerAcceptanceTest", "{", "@", "Rule", "public", "GfshRule", "gfshRule", "=", "new", "GfshRule", "(", ");", "@", "Before", "public", "void", "startCluster", "(", ")", "{", "gfshRule", ".", "execute", "(", "\"", "start", "locator", "-", "-", "name", "=", "locator", "\"", ",", "\"", "start", "server", "-", "-", "name", "=", "server", "\"", ");", "}", "@", "Test", "public", "void", "canStopServerByNameWhenConnectedOverJmx", "(", ")", "throws", "Exception", "{", "gfshRule", ".", "execute", "(", "\"", "connect", "\"", ",", "\"", "stop", "server", "-", "-", "name", "=", "server", "\"", ");", "}", "@", "Test", "public", "void", "canStopServerByNameWhenConnectedOverHttp", "(", ")", "throws", "Exception", "{", "gfshRule", ".", "execute", "(", "\"", "connect", "-", "-", "use", "-", "http", "\"", ",", "\"", "stop", "server", "-", "-", "name", "=", "server", "\"", ");", "}", "@", "Test", "public", "void", "cannotStopServerByNameWhenNotConnected", "(", ")", "throws", "Exception", "{", "startCluster", "(", ");", "gfshRule", ".", "execute", "(", "GfshScript", ".", "of", "(", "\"", "stop", "server", "-", "-", "name", "=", "server", "\"", ").", "expectFailure", "(", "))", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "139", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "*", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "*", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "*", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "*", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "*", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "*", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "cli", ".", "commands", ";", "import", "static", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "ConfigurationProperties", ".", "SECURITY_MANAGER", ";", "import", "static", "org", ".", "assertj", ".", "core", ".", "api", ".", "Assertions", ".", "assertThat", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "FileOutputStream", ";", "import", "java", ".", "util", ".", "Properties", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Rule", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "experimental", ".", "categories", ".", "Category", ";", "import", "org", ".", "apache", ".", "geode", ".", "examples", ".", "SimpleSecurityManager", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "cli", ".", "util", ".", "CommandStringBuilder", ";", "import", "org", ".", "apache", ".", "geode", ".", "test", ".", "junit", ".", "categories", ".", "AcceptanceTest", ";", "import", "org", ".", "apache", ".", "geode", ".", "test", ".", "junit", ".", "rules", ".", "gfsh", ".", "GfshExecution", ";", "import", "org", ".", "apache", ".", "geode", ".", "test", ".", "junit", ".", "rules", ".", "gfsh", ".", "GfshRule", ";", "import", "org", ".", "apache", ".", "geode", ".", "test", ".", "junit", ".", "rules", ".", "gfsh", ".", "GfshScript", ";", "@", "Category", "(", "AcceptanceTest", ".", "class", ")", "public", "class", "StopServerWithSecurityAcceptanceTest", "{", "@", "Rule", "public", "GfshRule", "gfshRule", "=", "new", "GfshRule", "(", ");", "private", "static", "final", "Properties", "securityProps", "=", "new", "Properties", "(", ");", "static", "{", "securityProps", ".", "setProperty", "(", "SECURITY_MANAGER", ",", "SimpleSecurityManager", ".", "class", ".", "getName", "(", "))", ";", "securityProps", ".", "setProperty", "(", "\"", "security", "-", "username", "\"", ",", "\"", "cluster", "\"", ");", "securityProps", ".", "setProperty", "(", "\"", "security", "-", "password", "\"", ",", "\"", "cluster", "\"", ");", "}", "private", "File", "securityPropertiesFile", ";", "@", "Before", "public", "void", "before", "(", ")", "throws", "Exception", "{", "securityPropertiesFile", "=", "gfshRule", ".", "getTemporaryFolder", "(", ").", "newFile", "(", "\"", "security", ".", "properties", "\"", ");", "securityProps", ".", "store", "(", "new", "FileOutputStream", "(", "securityPropertiesFile", ")", ",", "null", ")", ";", "}", "@", "Test", "public", "void", "cannotStopServerAsDataReaderOverHttp", "(", ")", "throws", "Exception", "{", "startCluster", "(", ");", "GfshExecution", "stopServer", "=", "dataReaderCannotStopServer", "(", "true", ")", ";", "assertThat", "(", "stopServer", ".", "getStdErrText", "(", "))", ".", "contains", "(", "\"", "dataReader", "not", "authorized", "for", "CLUSTER", ":", "READ", "\"", ");", "}", "@", "Test", "public", "void", "canStopServerAsClusterAdminOverHttp", "(", ")", "throws", "Exception", "{", "startCluster", "(", ");", "clusterAdminCanStopServer", "(", "true", ")", ";", "}", "@", "Test", "public", "void", "cannotStopServerAsDataReaderOverJmx", "(", ")", "throws", "Exception", "{", "startCluster", "(", ");", "GfshExecution", "stopServer", "=", "dataReaderCannotStopServer", "(", "false", ")", ";", "assertThat", "(", "stopServer", ".", "getStdErrText", "(", "))", ".", "contains", "(", "\"", "dataReader", "not", "authorized", "for", "CLUSTER", ":", "READ", "\"", ");", "}", "@", "Test", "public", "void", "canStopServerAsClusterAdminOverJmx", "(", ")", "throws", "Exception", "{", "startCluster", "(", ");", "clusterAdminCanStopServer", "(", "false", ")", ";", "}", "@", "Test", "public", "void", "cannotStopServerAsClusterReaderOverJmx", "(", ")", "throws", "Exception", "{", "startCluster", "(", ");", "GfshExecution", "stopServer", "=", "clusterReaderCannotStopServer", "(", "false", ")", ";", "assertThat", "(", "stopServer", ".", "getStdErrText", "(", "))", ".", "contains", "(", "\"", "clusterRead", "not", "authorized", "for", "CLUSTER", ":", "MANAGE", "\"", ");", "}", "@", "Test", "public", "void", "cannotStopServerAsClusterReaderOverHttp", "(", ")", "throws", "Exception", "{", "startCluster", "(", ");", "GfshExecution", "stopServer", "=", "clusterReaderCannotStopServer", "(", "true", ")", ";", "assertThat", "(", "stopServer", ".", "getStdErrText", "(", "))", ".", "contains", "(", "\"", "clusterRead", "not", "authorized", "for", "CLUSTER", ":", "MANAGE", "\"", ");", "}", "private", "GfshExecution", "startCluster", "(", ")", "{", "String", "startLocator", "=", "new", "CommandStringBuilder", "(", "\"", "start", "locator", "\"", ").", "addOption", "(", "\"", "name", "\"", ",", "\"", "locator", "\"", ")", ".", "addOption", "(", "\"", "security", "-", "properties", "-", "file", "\"", ",", "securityPropertiesFile", ".", "getAbsolutePath", "(", "))", ".", "toString", "(", ");", "String", "startServer", "=", "new", "CommandStringBuilder", "(", "\"", "start", "server", "\"", ").", "addOption", "(", "\"", "name", "\"", ",", "\"", "server", "\"", ")", ".", "addOption", "(", "\"", "security", "-", "properties", "-", "file", "\"", ",", "securityPropertiesFile", ".", "getAbsolutePath", "(", "))", ".", "toString", "(", ");", "return", "GfshScript", ".", "of", "(", "startLocator", ",", "startServer", ")", ".", "withName", "(", "\"", "cluster", "-", "setup", "\"", ").", "execute", "(", "gfshRule", ")", ";", "}", "private", "GfshExecution", "dataReaderCannotStopServer", "(", "boolean", "useHttp", ")", "{", "return", "GfshScript", ".", "of", "(", "connectCommand", "(", "\"", "dataReader", "\"", ",", "useHttp", ")", ",", "\"", "stop", "server", "-", "-", "name", "=", "server", "\"", ")", ".", "expectFailure", "(", ").", "execute", "(", "gfshRule", ")", ";", "}", "private", "GfshExecution", "clusterAdminCanStopServer", "(", "boolean", "useHttp", ")", "{", "return", "GfshScript", ".", "of", "(", "connectCommand", "(", "\"", "cluster", "\"", ",", "useHttp", ")", ",", "\"", "stop", "server", "-", "-", "name", "=", "server", "\"", ")", ".", "execute", "(", "gfshRule", ")", ";", "}", "private", "GfshExecution", "clusterReaderCannotStopServer", "(", "boolean", "useHttp", ")", "{", "return", "GfshScript", ".", "of", "(", "connectCommand", "(", "\"", "clusterRead", "\"", ",", "useHttp", ")", ",", "\"", "stop", "server", "-", "-", "name", "=", "server", "\"", ")", ".", "expectFailure", "(", ").", "execute", "(", "gfshRule", ")", ";", "}", "private", "String", "connectCommand", "(", "String", "permission", ",", "boolean", "useHttp", ")", "{", "CommandStringBuilder", "cmd", "=", "new", "CommandStringBuilder", "(", "\"", "connect", "\"", ").", "addOption", "(", "\"", "user", "\"", ",", "permission", ")", ".", "addOption", "(", "\"", "password", "\"", ",", "permission", ")", ";", "if", "(", "useHttp", ")", "{", "cmd", ".", "addOption", "(", "\"", "use", "-", "http", "\"", ");", "}", "return", "cmd", ".", "getCommandString", "(", ");", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "59", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "*", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "*", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "*", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "*", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "*", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "*", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "geode", ".", "examples", ";", "import", "java", ".", "util", ".", "Properties", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "AuthenticationFailedException", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "ResourcePermission", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "SecurityManager", ";", "/", "**", "*", "Intended", "for", "implementation", "testing", ",", "this", "class", "authenticates", "a", "user", "when", "the", "username", "matches", "*", "the", "password", ",", "which", "also", "represents", "the", "permissions", "the", "user", "is", "granted", ".", "*", "/", "public", "class", "SimpleSecurityManager", "implements", "SecurityManager", "{", "@", "Override", "public", "void", "init", "(", "final", "Properties", "securityProps", ")", "{", "/", "/", "nothing", "}", "@", "Override", "public", "Object", "authenticate", "(", "final", "Properties", "credentials", ")", "throws", "AuthenticationFailedException", "{", "String", "username", "=", "credentials", ".", "getProperty", "(", "\"", "security", "-", "username", "\"", ");", "String", "password", "=", "credentials", ".", "getProperty", "(", "\"", "security", "-", "password", "\"", ");", "if", "(", "username", "!", "=", "null", "&", "&", "username", ".", "equals", "(", "password", ")", ")", "{", "return", "username", ";", "}", "throw", "new", "AuthenticationFailedException", "(", "\"", "invalid", "username", "/", "password", "\"", ");", "}", "@", "Override", "public", "boolean", "authorize", "(", "final", "Object", "principal", ",", "final", "ResourcePermission", "permission", ")", "{", "String", "[", "]", "principals", "=", "principal", ".", "toString", "(", ").", "toLowerCase", "(", ").", "split", "(", "\",", "\")", ";", "for", "(", "String", "role", ":", "principals", ")", "{", "String", "permissionString", "=", "permission", ".", "toString", "(", ").", "replace", "(", "\":", "\",", "\"", "\")", ".", "toLowerCase", "(", ");", "if", "(", "permissionString", ".", "startsWith", "(", "role", ")", ")", "return", "true", ";", "}", "return", "false", ";", "}", "@", "Override", "public", "void", "close", "(", ")", "{", "/", "/", "nothing", "}", "}", "@", "@", "-", "19", ",", "7", "+", "19", ",", "6", "@", "@", "import", "java", ".", "lang", ".", "management", ".", "ManagementFactory", ";", "import", "java", ".", "net", ".", "InetAddress", ";", "import", "java", ".", "net", ".", "ServerSocket", ";", "import", "java", ".", "net", ".", "Socket", ";", "import", "java", ".", "net", ".", "UnknownHostException", ";", "import", "java", ".", "rmi", ".", "AlreadyBoundException", ";", "import", "java", ".", "rmi", ".", "registry", ".", "LocateRegistry", ";", "@", "@", "-", "90", ",", "12", "+", "89", ",", "12", "@", "@", "*", "/", "private", "boolean", "running", "=", "false", ";", "private", "Registry", "registry", ";", "private", "JMXConnectorServer", "jmxConnectorServer", ";", "private", "JMXShiroAuthenticator", "shiroAuthenticator", ";", "private", "final", "DistributionConfig", "config", ";", "private", "final", "SecurityService", "securityService", ";", "private", "boolean", "isHttpServiceRunning", "=", "false", ";", "/", "**", "*", "This", "system", "property", "is", "set", "to", "true", "when", "the", "embedded", "HTTP", "server", "is", "started", "so", "that", "the", "*", "embedded", "pulse", "webapp", "can", "use", "a", "local", "MBeanServer", "instead", "of", "a", "remote", "JMX", "connection", ".", "@", "@", "-", "115", ",", "11", "+", "114", ",", "11", "@", "@", "public", "synchronized", "boolean", "isRunning", "(", ")", "{", "return", "this", ".", "running", ";", "}", "public", "synchronized", "boolean", "isHttpServiceRunning", "(", ")", "{", "synchronized", "boolean", "isHttpServiceRunning", "(", ")", "{", "return", "isHttpServiceRunning", ";", "}", "public", "synchronized", "void", "setHttpServiceRunning", "(", "boolean", "isHttpServiceRunning", ")", "{", "private", "synchronized", "void", "setHttpServiceRunning", "(", "boolean", "isHttpServiceRunning", ")", "{", "this", ".", "isHttpServiceRunning", "=", "isHttpServiceRunning", ";", "}", "@", "@", "-", "180", ",", "7", "+", "179", ",", "7", "@", "@", "public", "synchronized", "void", "stopAgent", "(", ")", "{", "private", "Server", "httpServer", ";", "private", "final", "String", "GEMFIRE_VERSION", "=", "GemFireVersion", ".", "getGemFireVersion", "(", ");", "private", "AgentUtil", "agentUtil", "=", "new", "AgentUtil", "(", "GEMFIRE_VERSION", ")", ";", "private", "final", "AgentUtil", "agentUtil", "=", "new", "AgentUtil", "(", "GEMFIRE_VERSION", ")", ";", "private", "void", "startHttpService", "(", "boolean", "isServer", ")", "{", "final", "SystemManagementService", "managementService", "=", "(", "SystemManagementService", ")", "ManagementService", "@", "@", "-", "461", ",", "8", "+", "460", ",", "7", "@", "@", "public", "synchronized", "void", "start", "(", ")", "throws", "IOException", "{", "try", "{", "registry", ".", "bind", "(", "\"", "jmxrmi", "\"", ",", "stub", ")", ";", "}", "catch", "(", "AlreadyBoundException", "x", ")", "{", "final", "IOException", "io", "=", "new", "IOException", "(", "x", ".", "getMessage", "(", "),", "x", ")", ";", "throw", "io", ";", "throw", "new", "IOException", "(", "x", ".", "getMessage", "(", "),", "x", ")", ";", "}", "super", ".", "start", "(", ");", "}", "@", "@", "-", "513", ",", "30", "+", "511", ",", "18", "@", "@", "private", "void", "registerAccessControlMBean", "(", ")", "{", "logger", ".", "info", "(", "\"", "Registered", "AccessControlMBean", "on", "\"", "+", "accessControlMBeanON", ")", ";", "}", "catch", "(", "InstanceAlreadyExistsException", "|", "MBeanRegistrationException", "|", "NotCompliantMBeanException", "e", ")", "{", "throw", "new", "GemFireConfigException", "(", "\"", "Error", "while", "configuring", "accesscontrol", "for", "jmx", "resource", "\"", ",", "e", ")", ";", "throw", "new", "GemFireConfigException", "(", "\"", "Error", "while", "configuring", "access", "control", "for", "jmx", "resource", "\"", ",", "e", ")", ";", "}", "}", "}", "catch", "(", "MalformedObjectNameException", "e", ")", "{", "throw", "new", "GemFireConfigException", "(", "\"", "Error", "while", "configuring", "accesscontrol", "for", "jmx", "resource", "\"", ",", "e", ")", ";", "throw", "new", "GemFireConfigException", "(", "\"", "Error", "while", "configuring", "access", "control", "for", "jmx", "resource", "\"", ",", "e", ")", ";", "}", "}", "private", "static", "class", "GemFireRMIClientSocketFactory", "implements", "RMIClientSocketFactory", ",", "Serializable", "{", "private", "static", "final", "long", "serialVersionUID", "=", "-", "7604285019188827617L", ";", "private", "transient", "SocketCreator", "sc", ";", "public", "GemFireRMIClientSocketFactory", "(", "SocketCreator", "sc", ")", "{", "this", ".", "sc", "=", "sc", ";", "}", "@", "Override", "public", "Socket", "createSocket", "(", "String", "host", ",", "int", "port", ")", "throws", "IOException", "{", "return", "this", ".", "sc", ".", "connectForClient", "(", "host", ",", "port", ",", "0", ")", ";", "}", "public", "JMXConnectorServer", "getJmxConnectorServer", "(", ")", "{", "return", "jmxConnectorServer", ";", "}", "private", "static", "class", "GemFireRMIServerSocketFactory", "@", "@", "-", "17", ",", "19", "+", "17", ",", "14", "@", "@", "import", "java", ".", "io", ".", "PrintWriter", ";", "import", "java", ".", "io", ".", "StringWriter", ";", "import", "java", ".", "lang", ".", "management", ".", "ManagementFactory", ";", "import", "java", ".", "net", ".", "URI", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "javax", ".", "management", ".", "InstanceNotFoundException", ";", "import", "javax", ".", "management", ".", "JMX", ";", "import", "javax", ".", "management", ".", "MBeanServer", ";", "import", "javax", ".", "management", ".", "MalformedObjectNameException", ";", "import", "javax", ".", "management", ".", "ObjectName", ";", "import", "javax", ".", "management", ".", "Query", ";", "import", "javax", ".", "management", ".", "QueryExp", ";", "import", "org", ".", "apache", ".", "logging", ".", "log4j", ".", "Logger", ";", "import", "org", ".", "springframework", ".", "beans", ".", "propertyeditors", ".", "StringArrayPropertyEditor", ";", "@", "@", "-", "39", ",", "25", "+", "34", ",", "25", "@", "@", "import", "org", ".", "springframework", ".", "web", ".", "bind", ".", "annotation", ".", "ExceptionHandler", ";", "import", "org", ".", "springframework", ".", "web", ".", "bind", ".", "annotation", ".", "InitBinder", ";", "import", "org", ".", "springframework", ".", "web", ".", "bind", ".", "annotation", ".", "ResponseBody", ";", "import", "org", ".", "springframework", ".", "web", ".", "bind", ".", "annotation", ".", "ResponseStatus", ";", "import", "org", ".", "springframework", ".", "web", ".", "context", ".", "request", ".", "WebRequest", ";", "import", "org", ".", "springframework", ".", "web", ".", "servlet", ".", "support", ".", "ServletUriComponentsBuilder", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "GemFireCacheImpl", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCache", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "lang", ".", "StringUtils", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "logging", ".", "LogService", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "logging", ".", "log4j", ".", "LogMarker", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "security", ".", "SecurityService", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "util", ".", "ArrayUtils", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "DistributedSystemMXBean", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "ManagementService", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "MemberMXBean", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "MBeanJMXAdapter", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "ManagementConstants", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "ManagementAgent", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "SystemManagementService", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "cli", ".", "shell", ".", "Gfsh", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "security", ".", "MBeanServerWrapper", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "controllers", ".", "support", ".", "LoginHandlerInterceptor", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "util", ".", "UriUtils", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "AuthenticationFailedException", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "GemFireSecurityException", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "NotAuthorizedException", ";", "/", "**", "@", "@", "-", "67", ",", "14", "+", "62", ",", "15", "@", "@", "*", "*", "@", "see", "org", ".", "apache", ".", "geode", ".", "management", ".", "MemberMXBean", "*", "@", "see", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "cli", ".", "shell", ".", "Gfsh", "*", "@", "see", "org", ".", "springframework", ".", "http", ".", "ResponseEntity", "*", "@", "see", "org", ".", "springframework", ".", "stereotype", ".", "Controller", "*", "@", "see", "org", ".", "springframework", ".", "web", ".", "bind", ".", "annotation", ".", "ExceptionHandler", "*", "@", "see", "org", ".", "springframework", ".", "web", ".", "bind", ".", "annotation", ".", "InitBinder", "*", "@", "see", "org", ".", "springframework", ".", "web", ".", "bind", ".", "annotation", ".", "ResponseBody", "*", "@", "since", "GemFire", "8", ".", "0", "*", "/", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "abstract", "class", "AbstractCommandsController", "{", "private", "static", "final", "Logger", "logger", "=", "LogService", ".", "getLogger", "(", ");", "protected", "static", "final", "String", "DEFAULT_ENCODING", "=", "UriUtils", ".", "DEFAULT_ENCODING", ";", "@", "@", "-", "84", ",", "242", "+", "80", ",", "53", "@", "@", "private", "Class", "accessControlKlass", ";", "private", "InternalCache", "getCache", "(", ")", "{", "return", "GemFireCacheImpl", ".", "getInstance", "(", ");", "}", "/", "/", "Convert", "a", "predefined", "exception", "to", "an", "HTTP", "Status", "code", "@", "ResponseStatus", "(", "value", "=", "HttpStatus", ".", "UNAUTHORIZED", ",", "reason", "=", "\"", "Not", "authenticated", "\"", ")", "/", "/", "401", "@", "ExceptionHandler", "(", "org", ".", "apache", ".", "geode", ".", "security", ".", "AuthenticationFailedException", ".", "class", ")", "public", "void", "authenticate", "(", ")", "{", "/", "/", "nothing", "}", "/", "/", "Convert", "a", "predefined", "exception", "to", "an", "HTTP", "Status", "code", "@", "ResponseStatus", "(", "value", "=", "HttpStatus", ".", "FORBIDDEN", ",", "reason", "=", "\"", "Access", "Denied", "\"", ")", "/", "/", "403", "@", "ExceptionHandler", "(", "java", ".", "lang", ".", "SecurityException", ".", "class", ")", "public", "void", "authorize", "(", ")", "{", "/", "/", "nothing", "}", "/", "**", "*", "Asserts", "the", "argument", "is", "valid", ",", "as", "determined", "by", "the", "caller", "passing", "the", "result", "of", "an", "evaluated", "*", "expression", "to", "this", "assertion", ".", "*", "*", "@", "param", "validArg", "a", "boolean", "value", "indicating", "the", "evaluation", "of", "the", "expression", "validating", "the", "*", "argument", ".", "*", "@", "param", "message", "a", "String", "value", "used", "as", "the", "message", "when", "constructing", "an", "*", "IllegalArgumentException", ".", "*", "@", "param", "args", "Object", "arguments", "used", "to", "populate", "placeholder", "'", "s", "in", "the", "message", ".", "*", "@", "throws", "IllegalArgumentException", "if", "the", "argument", "is", "not", "valid", ".", "*", "@", "see", "java", ".", "lang", ".", "String", "#", "format", "(", "String", ",", "Object", ".", "..", ")", "*", "/", "protected", "static", "void", "assertArgument", "(", "final", "boolean", "validArg", ",", "final", "String", "message", ",", "final", "Object", ".", "..", "args", ")", "{", "if", "(", "!", "validArg", ")", "{", "throw", "new", "IllegalArgumentException", "(", "String", ".", "format", "(", "message", ",", "args", ")", ");", "}", "}", "/", "**", "*", "Asserts", "the", "Object", "reference", "is", "not", "null", "!", "*", "*", "@", "param", "obj", "the", "reference", "to", "the", "Object", ".", "*", "@", "param", "message", "the", "String", "value", "used", "as", "the", "message", "when", "constructing", "and", "throwing", "a", "*", "NullPointerException", ".", "*", "@", "param", "args", "Object", "arguments", "used", "to", "populate", "placeholder", "'", "s", "in", "the", "message", ".", "*", "@", "throws", "NullPointerException", "if", "the", "Object", "reference", "is", "null", ".", "*", "@", "see", "java", ".", "lang", ".", "String", "#", "format", "(", "String", ",", "Object", ".", "..", ")", "*", "/", "protected", "static", "void", "assertNotNull", "(", "final", "Object", "obj", ",", "final", "String", "message", ",", "final", "Object", ".", "..", "args", ")", "{", "if", "(", "obj", "=", "=", "null", ")", "{", "throw", "new", "NullPointerException", "(", "String", ".", "format", "(", "message", ",", "args", ")", ");", "}", "}", "/", "**", "*", "Asserts", "whether", "state", ",", "based", "on", "the", "evaluation", "of", "a", "conditional", "expression", ",", "passed", "to", "this", "*", "assertion", "is", "valid", ".", "*", "*", "@", "param", "validState", "a", "boolean", "value", "indicating", "the", "evaluation", "of", "the", "expression", "from", "which", "the", "*", "conditional", "state", "is", "based", ".", "For", "example", ",", "a", "caller", "might", "use", "an", "expression", "of", "the", "form", "*", "(", "initableObj", ".", "isInitialized", "(", "))", ".", "*", "@", "param", "message", "a", "String", "values", "used", "as", "the", "message", "when", "constructing", "an", "IllegalStateException", ".", "*", "@", "param", "args", "Object", "arguments", "used", "to", "populate", "placeholder", "'", "s", "in", "the", "message", ".", "*", "@", "throws", "IllegalStateException", "if", "the", "conditional", "state", "is", "not", "valid", ".", "*", "@", "see", "java", ".", "lang", ".", "String", "#", "format", "(", "String", ",", "Object", ".", "..", ")", "*", "/", "protected", "static", "void", "assertState", "(", "final", "boolean", "validState", ",", "final", "String", "message", ",", "final", "Object", ".", "..", "args", ")", "{", "if", "(", "!", "validState", ")", "{", "throw", "new", "IllegalStateException", "(", "String", ".", "format", "(", "message", ",", "args", ")", ");", "}", "}", "/", "**", "*", "Decodes", "the", "encoded", "String", "value", "using", "the", "default", "encoding", "UTF", "-", "8", ".", "It", "is", "assumed", "the", "String", "*", "value", "was", "encoded", "with", "the", "URLEncoder", "using", "the", "UTF", "-", "8", "encoding", ".", "This", "method", "handles", "*", "UnsupportedEncodingException", "by", "just", "returning", "the", "encodedValue", ".", "*", "*", "@", "param", "encodedValue", "the", "encoded", "String", "value", "to", "decode", ".", "*", "@", "return", "the", "decoded", "value", "of", "the", "String", "or", "encodedValue", "if", "the", "UTF", "-", "8", "encoding", "is", "unsupported", ".", "*", "@", "see", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "util", ".", "UriUtils", "#", "decode", "(", "String", ")", "*", "/", "protected", "static", "String", "decode", "(", "final", "String", "encodedValue", ")", "{", "return", "UriUtils", ".", "decode", "(", "encodedValue", ")", ";", "@", "ExceptionHandler", "(", "Exception", ".", "class", ")", "public", "ResponseEntity", "<", "String", ">", "internalError", "(", "final", "Exception", "e", ")", "{", "final", "String", "stackTrace", "=", "getPrintableStackTrace", "(", "e", ")", ";", "logger", ".", "fatal", "(", "stackTrace", ")", ";", "return", "new", "ResponseEntity", "<", ">(", "stackTrace", ",", "HttpStatus", ".", "INTERNAL_SERVER_ERROR", ")", ";", "}", "/", "**", "*", "Decodes", "the", "encoded", "String", "value", "using", "the", "specified", "encoding", "(", "such", "as", "UTF", "-", "8", ")", ".", "It", "is", "assumed", "*", "the", "String", "value", "was", "encoded", "with", "the", "URLEncoder", "using", "the", "specified", "encoding", ".", "This", "method", "*", "handles", "UnsupportedEncodingException", "by", "just", "returning", "the", "encodedValue", ".", "*", "*", "@", "param", "encodedValue", "a", "String", "value", "encoded", "in", "the", "encoding", ".", "*", "@", "param", "encoding", "a", "String", "value", "specifying", "the", "encoding", ".", "*", "@", "return", "the", "decoded", "value", "of", "the", "String", "or", "encodedValue", "if", "the", "specified", "encoding", "is", "*", "unsupported", ".", "*", "@", "see", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "util", ".", "UriUtils", "#", "decode", "(", "String", ",", "String", ")", "*", "/", "protected", "static", "String", "decode", "(", "final", "String", "encodedValue", ",", "final", "String", "encoding", ")", "{", "return", "UriUtils", ".", "decode", "(", "encodedValue", ",", "encoding", ")", ";", "@", "ExceptionHandler", "(", "AuthenticationFailedException", ".", "class", ")", "public", "ResponseEntity", "<", "String", ">", "unauthorized", "(", "AuthenticationFailedException", "e", ")", "{", "return", "new", "ResponseEntity", "<", ">(", "e", ".", "getMessage", "(", "),", "HttpStatus", ".", "UNAUTHORIZED", ")", ";", "}", "/", "**", "*", "Gets", "the", "specified", "value", "if", "not", "null", "or", "empty", ",", "otherwise", "returns", "the", "default", "value", ".", "*", "*", "@", "param", "value", "the", "String", "value", "being", "evaluated", "for", "having", "value", "(", "not", "null", "and", "not", "empty", ")", ".", "*", "@", "param", "defaultValue", "the", "default", "String", "value", "returned", "if", "'", "value", "'", "has", "no", "value", ".", "*", "@", "return", "'", "value", "'", "if", "not", "null", "or", "empty", ",", "otherwise", "returns", "the", "default", "value", ".", "*", "@", "see", "#", "hasValue", "(", "String", ")", "*", "/", "protected", "static", "String", "defaultIfNoValue", "(", "final", "String", "value", ",", "final", "String", "defaultValue", ")", "{", "return", "(", "hasValue", "(", "value", ")", "?", "value", ":", "defaultValue", ")", ";", "@", "ExceptionHandler", "(", "{", "NotAuthorizedException", ".", "class", ",", "java", ".", "lang", ".", "SecurityException", ".", "class", "}", ")", "public", "ResponseEntity", "<", "String", ">", "forbidden", "(", "Exception", "e", ")", "{", "return", "new", "ResponseEntity", "<", ">(", "e", ".", "getMessage", "(", "),", "HttpStatus", ".", "FORBIDDEN", ")", ";", "}", "/", "**", "*", "Encodes", "the", "String", "value", "using", "the", "default", "encoding", "UTF", "-", "8", ".", "*", "*", "@", "param", "value", "the", "String", "value", "to", "encode", ".", "*", "@", "return", "an", "encoded", "value", "of", "the", "String", "using", "the", "default", "encoding", "UTF", "-", "8", "or", "value", "if", "the", "UTF", "-", "8", "*", "encoding", "is", "unsupported", ".", "*", "@", "see", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "util", ".", "UriUtils", "#", "encode", "(", "String", ")", "*", "/", "protected", "static", "String", "encode", "(", "final", "String", "value", ")", "{", "return", "UriUtils", ".", "encode", "(", "value", ")", ";", "@", "ExceptionHandler", "(", "MalformedObjectNameException", ".", "class", ")", "public", "ResponseEntity", "<", "String", ">", "badRequest", "(", "final", "MalformedObjectNameException", "e", ")", "{", "logger", ".", "info", "(", "e", ")", ";", "return", "new", "ResponseEntity", "<", ">(", "getPrintableStackTrace", "(", "e", ")", ",", "HttpStatus", ".", "BAD_REQUEST", ")", ";", "}", "/", "**", "*", "Encodes", "the", "String", "value", "using", "the", "specified", "encoding", "(", "such", "as", "UTF", "-", "8", ")", ".", "*", "*", "@", "param", "value", "the", "String", "value", "to", "encode", ".", "*", "@", "param", "encoding", "a", "String", "value", "indicating", "the", "encoding", ".", "*", "@", "return", "an", "encoded", "value", "of", "the", "String", "using", "the", "specified", "encoding", "or", "value", "if", "the", "specified", "*", "encoding", "is", "unsupported", ".", "*", "@", "see", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "util", ".", "UriUtils", "#", "encode", "(", "String", ",", "String", ")", "*", "/", "protected", "static", "String", "encode", "(", "final", "String", "value", ",", "final", "String", "encoding", ")", "{", "return", "UriUtils", ".", "encode", "(", "value", ",", "encoding", ")", ";", "@", "ExceptionHandler", "(", "InstanceNotFoundException", ".", "class", ")", "public", "ResponseEntity", "<", "String", ">", "notFound", "(", "final", "InstanceNotFoundException", "e", ")", "{", "logger", ".", "info", "(", "e", ")", ";", "return", "new", "ResponseEntity", "<", ">(", "getPrintableStackTrace", "(", "e", ")", ",", "HttpStatus", ".", "NOT_FOUND", ")", ";", "}", "/", "**", "*", "Determines", "whether", "the", "specified", "Object", "has", "value", ",", "which", "is", "determined", "by", "a", "non", "-", "null", "Object", "*", "reference", ".", "*", "*", "@", "param", "value", "the", "Object", "value", "being", "evaluated", "for", "value", ".", "*", "@", "return", "a", "boolean", "value", "indicating", "whether", "the", "specified", "Object", "has", "value", ".", "*", "@", "see", "java", ".", "lang", ".", "Object", "*", "/", "protected", "static", "boolean", "hasValue", "(", "final", "Object", "value", ")", "{", "return", "(", "value", "instanceof", "String", "[", "]", "?", "hasValue", "(", "(", "String", "[", "])", "value", ")", ":", "(", "value", "instanceof", "String", "?", "hasValue", "(", "(", "String", ")", "value", ")", ":", "value", "!", "=", "null", ")", ");", "}", "/", "**", "*", "Determines", "whether", "the", "specified", "String", "has", "value", ",", "determined", "by", "whether", "the", "String", "is", "*", "non", "-", "null", ",", "not", "empty", "and", "not", "blank", ".", "*", "*", "@", "param", "value", "the", "String", "being", "evaluated", "for", "value", ".", "*", "@", "return", "a", "boolean", "indicating", "whether", "the", "specified", "String", "has", "value", "or", "not", ".", "*", "@", "see", "java", ".", "lang", ".", "String", "*", "/", "protected", "static", "boolean", "hasValue", "(", "final", "String", "value", ")", "{", "return", "StringUtils", ".", "isNotBlank", "(", "value", ")", ";", "}", "/", "**", "*", "Determines", "whether", "the", "specified", "String", "array", "has", "any", "value", ",", "which", "is", "determined", "by", "a", "non", "-", "null", "*", "String", "array", "reference", "along", "with", "containing", "at", "least", "1", "non", "-", "null", ",", "not", "empty", "and", "not", "blank", "*", "element", ".", "*", "*", "@", "param", "array", "an", "String", "array", "being", "evaluated", "for", "value", ".", "*", "@", "return", "a", "boolean", "indicating", "whether", "the", "specified", "String", "array", "has", "any", "value", ".", "*", "@", "see", "#", "hasValue", "(", "String", ")", "*", "@", "see", "java", ".", "lang", ".", "String", "*", "/", "protected", "static", "boolean", "hasValue", "(", "final", "String", "[", "]", "array", ")", "{", "if", "(", "array", "!", "=", "null", "&", "&", "array", ".", "length", ">", "0", ")", "{", "for", "(", "final", "String", "element", ":", "array", ")", "{", "if", "(", "hasValue", "(", "element", ")", ")", "{", "return", "true", ";", "}", "}", "}", "return", "false", ";", "}", "/", "**", "*", "Writes", "the", "stack", "trace", "of", "the", "Throwable", "to", "a", "String", ".", "*", "*", "*", "@", "param", "t", "a", "Throwable", "object", "who", "'", "s", "stack", "trace", "will", "be", "written", "to", "a", "String", ".", "*", "@", "return", "a", "String", "containing", "the", "stack", "trace", "of", "the", "Throwable", ".", "*", "@", "see", "java", ".", "io", ".", "StringWriter", "*", "@", "see", "java", ".", "lang", ".", "Throwable", "#", "printStackTrace", "(", "java", ".", "io", ".", "PrintWriter", ")", "*", "/", "protected", "static", "String", "printStackTrace", "(", "final", "Throwable", "t", ")", "{", "private", "static", "String", "getPrintableStackTrace", "(", "final", "Throwable", "t", ")", "{", "final", "StringWriter", "stackTraceWriter", "=", "new", "StringWriter", "(", ");", "t", ".", "printStackTrace", "(", "new", "PrintWriter", "(", "stackTraceWriter", ")", ");", "return", "stackTraceWriter", ".", "toString", "(", ");", "}", "/", "**", "*", "Converts", "the", "URI", "relative", "path", "to", "an", "absolute", "path", "based", "on", "the", "Servlet", "context", "information", ".", "*", "*", "@", "param", "path", "the", "URI", "relative", "path", "to", "append", "to", "the", "Servlet", "context", "path", ".", "*", "@", "param", "scheme", "the", "scheme", "to", "use", "for", "the", "URI", "*", "@", "return", "a", "URI", "constructed", "with", "all", "component", "path", "information", ".", "*", "@", "see", "java", ".", "net", ".", "URI", "*", "@", "see", "org", ".", "springframework", ".", "web", ".", "servlet", ".", "support", ".", "ServletUriComponentsBuilder", "*", "/", "public", "static", "URI", "toUri", "(", "final", "String", "path", ",", "final", "String", "scheme", ")", "{", "return", "ServletUriComponentsBuilder", ".", "fromCurrentContextPath", "(", ").", "path", "(", "REST_API_VERSION", ")", ".", "path", "(", "path", ")", ".", "scheme", "(", "scheme", ")", ".", "build", "(", ").", "toUri", "(", ");", "}", "/", "**", "*", "Handles", "any", "Exception", "thrown", "by", "a", "REST", "API", "web", "service", "endpoint", ",", "HTTP", "request", "handler", "method", "*", "during", "the", "invocation", "and", "processing", "of", "a", "command", ".", "*", "*", "@", "param", "cause", "the", "Exception", "causing", "the", "error", ".", "*", "@", "return", "a", "ResponseEntity", "with", "an", "appropriate", "HTTP", "status", "code", "(", "500", "-", "Internal", "Server", "Error", ")", "and", "*", "HTTP", "response", "body", "containing", "the", "stack", "trace", "of", "the", "Exception", ".", "*", "@", "see", "java", ".", "lang", ".", "Exception", "*", "@", "see", "org", ".", "springframework", ".", "http", ".", "ResponseEntity", "*", "@", "see", "org", ".", "springframework", ".", "web", ".", "bind", ".", "annotation", ".", "ExceptionHandler", "*", "@", "see", "org", ".", "springframework", ".", "web", ".", "bind", ".", "annotation", ".", "ResponseBody", "*", "/", "@", "ExceptionHandler", "(", "Exception", ".", "class", ")", "@", "ResponseBody", "public", "ResponseEntity", "<", "String", ">", "handleException", "(", "final", "Exception", "cause", ")", "{", "final", "String", "stackTrace", "=", "printStackTrace", "(", "cause", ")", ";", "logger", ".", "fatal", "(", "stackTrace", ")", ";", "return", "new", "ResponseEntity", "<", "String", ">", "(", "stackTrace", ",", "HttpStatus", ".", "INTERNAL_SERVER_ERROR", ")", ";", "}", "/", "**", "*", "Initializes", "data", "bindings", "for", "various", "HTTP", "request", "handler", "method", "parameter", "Java", "class", "types", ".", "*", "*", "*", "@", "param", "dataBinder", "the", "DataBinder", "implementation", "used", "for", "Web", "transactions", ".", "*", "@", "see", "org", ".", "springframework", ".", "web", ".", "bind", ".", "WebDataBinder", "*", "@", "see", "org", ".", "springframework", ".", "web", ".", "bind", ".", "annotation", ".", "InitBinder", "@", "@", "-", "330", ",", "110", "+", "137", ",", "27", "@", "@", "public", "void", "initBinder", "(", "final", "WebDataBinder", "dataBinder", ")", "{", "new", "StringArrayPropertyEditor", "(", "StringArrayPropertyEditor", ".", "DEFAULT_SEPARATOR", ",", "false", ")", ");", "}", "/", "**", "*", "Logs", "the", "client", "'", "s", "HTTP", "(", "web", ")", "request", "including", "details", "of", "the", "HTTP", "headers", "and", "request", "*", "parameters", "along", "with", "the", "web", "request", "context", "and", "description", ".", "*", "*", "@", "param", "request", "the", "object", "encapsulating", "the", "details", "of", "the", "client", "'", "s", "HTTP", "(", "web", ")", "request", ".", "*", "@", "see", "org", ".", "springframework", ".", "web", ".", "context", ".", "request", ".", "WebRequest", "*", "/", "protected", "void", "logRequest", "(", "final", "WebRequest", "request", ")", "{", "if", "(", "request", "!", "=", "null", ")", "{", "final", "Map", "<", "String", ",", "String", ">", "headers", "=", "new", "HashMap", "<", "java", ".", "lang", ".", "String", ",", "java", ".", "lang", ".", "String", ">", "()", ";", "for", "(", "Iterator", "<", "String", ">", "it", "=", "request", ".", "getHeaderNames", "(", ");", "it", ".", "hasNext", "(", ");", ")", "{", "final", "String", "headerName", "=", "it", ".", "next", "(", ");", "headers", ".", "put", "(", "headerName", ",", "ArrayUtils", ".", "toString", "(", "(", "Object", "[", "])", "request", ".", "getHeaderValues", "(", "headerName", ")", "))", ";", "}", "final", "Map", "<", "String", ",", "String", ">", "parameters", "=", "new", "HashMap", "<", "String", ",", "String", ">", "(", "request", ".", "getParameterMap", "(", ").", "size", "(", "))", ";", "for", "(", "Iterator", "<", "String", ">", "it", "=", "request", ".", "getParameterNames", "(", ");", "it", ".", "hasNext", "(", ");", ")", "{", "final", "String", "parameterName", "=", "it", ".", "next", "(", ");", "parameters", ".", "put", "(", "parameterName", ",", "ArrayUtils", ".", "toString", "(", "(", "Object", "[", "])", "request", ".", "getParameterValues", "(", "parameterName", ")", "))", ";", "}", "logger", ".", "info", "(", "\"", "HTTP", "-", "request", ":", "description", "(", "{}", "),", "context", "(", "{}", "),", "headers", "(", "{}", "),", "parameters", "(", "{}", ")\"", ",", "request", ".", "getDescription", "(", "false", ")", ",", "request", ".", "getContextPath", "(", "),", "headers", ",", "parameters", ")", ";", "}", "}", "/", "**", "*", "Gets", "a", "reference", "to", "the", "platform", "MBeanServer", "running", "in", "this", "JVM", "process", ".", "The", "MBeanServer", "*", "instance", "constitutes", "a", "connection", "to", "the", "MBeanServer", ".", "*", "instance", "constitutes", "a", "connection", "to", "the", "MBeanServer", ".", "This", "method", "returns", "a", "security", "-", "wrapped", "*", "MBean", "if", "integrated", "security", "is", "active", ".", "*", "*", "@", "return", "a", "reference", "to", "the", "platform", "MBeanServer", "for", "this", "JVM", "process", ".", "*", "@", "see", "java", ".", "lang", ".", "management", ".", "ManagementFactory", "#", "getPlatformMBeanServer", "(", ")", "*", "@", "see", "javax", ".", "management", ".", "MBeanServer", "*", "/", "protected", "MBeanServer", "getMBeanServer", "(", ")", "{", "return", "ManagementFactory", ".", "getPlatformMBeanServer", "(", ");", "}", "/", "**", "*", "Gets", "the", "MemberMXBean", "from", "the", "JVM", "Platform", "MBeanServer", "for", "the", "specified", "member", ",", "identified", "by", "*", "name", "or", "ID", "in", "the", "GemFire", "cluster", ".", "*", "*", "@", "param", "memberNameId", "a", "String", "indicating", "the", "name", "or", "ID", "of", "the", "GemFire", "member", ".", "*", "@", "return", "a", "proxy", "to", "the", "GemFire", "member", "'", "s", "MemberMXBean", ".", "*", "@", "throws", "IllegalStateException", "if", "no", "MemberMXBean", "could", "be", "found", "for", "GemFire", "member", "with", "ID", "or", "*", "name", ".", "*", "@", "throws", "RuntimeException", "wrapping", "the", "MalformedObjectNameException", "if", "the", "ObjectName", "pattern", "is", "*", "malformed", ".", "*", "@", "see", "#", "getMBeanServer", "(", ")", "*", "@", "see", "#", "isMemberMXBeanFound", "(", "java", ".", "util", ".", "Collection", ")", "*", "@", "see", "javax", ".", "management", ".", "ObjectName", "*", "@", "see", "javax", ".", "management", ".", "QueryExp", "*", "@", "see", "javax", ".", "management", ".", "MBeanServer", "#", "queryNames", "(", "javax", ".", "management", ".", "ObjectName", ",", "*", "javax", ".", "management", ".", "QueryExp", ")", "*", "@", "see", "javax", ".", "management", ".", "JMX", "#", "newMXBeanProxy", "(", "javax", ".", "management", ".", "MBeanServerConnection", ",", "*", "javax", ".", "management", ".", "ObjectName", ",", "Class", ")", "*", "@", "see", "org", ".", "apache", ".", "geode", ".", "management", ".", "MemberMXBean", "*", "/", "protected", "MemberMXBean", "getMemberMXBean", "(", "final", "String", "memberNameId", ")", "{", "try", "{", "final", "MBeanServer", "connection", "=", "getMBeanServer", "(", ");", "final", "String", "objectNamePattern", "=", "ManagementConstants", ".", "OBJECTNAME__PREFIX", ".", "concat", "(", "\"", "type", "=", "Member", ",", "*\"", ");", "/", "/", "NOTE", "throws", "a", "MalformedObjectNameException", ",", "but", "this", "should", "not", "happen", "since", "we", "constructed", "/", "/", "the", "ObjectName", "above", "final", "ObjectName", "objectName", "=", "ObjectName", ".", "getInstance", "(", "objectNamePattern", ")", ";", "final", "QueryExp", "query", "=", "Query", ".", "or", "(", "Query", ".", "eq", "(", "Query", ".", "attr", "(", "\"", "Name", "\"", "),", "Query", ".", "value", "(", "memberNameId", ")", "),", "Query", ".", "eq", "(", "Query", ".", "attr", "(", "\"", "Id", "\"", "),", "Query", ".", "value", "(", "memberNameId", ")", "))", ";", "final", "Set", "<", "ObjectName", ">", "objectNames", "=", "connection", ".", "queryNames", "(", "objectName", ",", "query", ")", ";", "assertState", "(", "isMemberMXBeanFound", "(", "objectNames", ")", ",", "\"", "No", "MemberMXBean", "with", "ObjectName", "(", "%", "1", "$", "s", ")", "based", "on", "Query", "(", "%", "2", "$", "s", ")", "was", "found", "in", "the", "Platform", "MBeanServer", "for", "member", "(", "%", "3", "$", "s", ")", "!\"", ",", "objectName", ",", "query", ",", "memberNameId", ")", ";", "return", "JMX", ".", "newMXBeanProxy", "(", "connection", ",", "objectNames", ".", "iterator", "(", ").", "next", "(", "),", "MemberMXBean", ".", "class", ")", ";", "}", "catch", "(", "MalformedObjectNameException", "e", ")", "{", "throw", "new", "RuntimeException", "(", "e", ")", ";", "}", "}", "/", "**", "*", "Determines", "whether", "the", "desired", "MemberMXBean", ",", "identified", "by", "name", "or", "ID", ",", "was", "found", "in", "the", "*", "platform", "MBeanServer", "of", "this", "JVM", "process", ".", "*", "*", "@", "param", "objectNames", "a", "Collection", "of", "ObjectNames", "possibly", "referring", "to", "the", "desired", "MemberMXBean", ".", "*", "@", "return", "a", "boolean", "value", "indicating", "whether", "the", "desired", "MemberMXBean", "was", "found", ".", "*", "@", "see", "javax", ".", "management", ".", "ObjectName", "*", "/", "private", "boolean", "isMemberMXBeanFound", "(", "final", "Collection", "<", "ObjectName", ">", "objectNames", ")", "{", "return", "!", "(", "objectNames", "=", "=", "null", "|", "|", "objectNames", ".", "isEmpty", "(", "))", ";", "InternalCache", "cache", "=", "GemFireCacheImpl", ".", "getInstance", "(", ");", "SystemManagementService", "service", "=", "(", "SystemManagementService", ")", "ManagementService", ".", "getExistingManagementService", "(", "cache", ")", ";", "ManagementAgent", "managementAgent", "=", "service", ".", "getManagementAgent", "(", ");", "return", "managementAgent", ".", "getJmxConnectorServer", "(", ").", "getMBeanServer", "(", ");", "}", "/", "**", "*", "Lookup", "operation", "for", "the", "MemberMXBean", "representing", "the", "Manager", "in", "the", "GemFire", "cluster", ".", "This", "*", "method", "gets", "an", "instance", "fo", "the", "Platform", "MBeanServer", "for", "this", "JVM", "process", "and", "uses", "it", "to", "lookup", "*", "method", "gets", "an", "instance", "of", "the", "Platform", "MBeanServer", "for", "this", "JVM", "process", "and", "uses", "it", "to", "lookup", "*", "the", "MemberMXBean", "for", "the", "GemFire", "Manager", "based", "on", "the", "ObjectName", "declared", "in", "the", "*", "DistributedSystemMXBean", ".", "getManagerObjectName", "(", ")", "operation", ".", "*", "@", "@", "-", "444", ",", "15", "+", "168", ",", "11", "@", "@", "private", "boolean", "isMemberMXBeanFound", "(", "final", "Collection", "<", "ObjectName", ">", "objectNames", ")", "{", "*", "@", "see", "org", ".", "apache", ".", "geode", ".", "management", ".", "DistributedSystemMXBean", "*", "@", "see", "org", ".", "apache", ".", "geode", ".", "management", ".", "MemberMXBean", "*", "/", "protected", "synchronized", "MemberMXBean", "getManagingMemberMXBean", "(", ")", "{", "private", "synchronized", "MemberMXBean", "getManagingMemberMXBean", "(", ")", "{", "if", "(", "managingMemberMXBeanProxy", "=", "=", "null", ")", "{", "SystemManagementService", "service", "=", "(", "SystemManagementService", ")", "ManagementService", ".", "getExistingManagementService", "(", "getCache", "(", "))", ";", "MBeanServer", "mbs", "=", "getMBeanServer", "(", ");", "final", "DistributedSystemMXBean", "distributedSystemMXBean", "=", "JMX", ".", "newMXBeanProxy", "(", "mbs", ",", "DistributedSystemMXBean", "distributedSystemMXBean", "=", "JMX", ".", "newMXBeanProxy", "(", "mbs", ",", "MBeanJMXAdapter", ".", "getDistributedSystemName", "(", "),", "DistributedSystemMXBean", ".", "class", ")", ";", "managingMemberMXBeanProxy", "=", "createMemberMXBeanForManagerUsingProxy", "(", "mbs", ",", "distributedSystemMXBean", ".", "getMemberObjectName", "(", "))", ";", "}", "@", "@", "-", "461", ",", "11", "+", "181", ",", "9", "@", "@", "protected", "synchronized", "MemberMXBean", "getManagingMemberMXBean", "(", ")", "{", "}", "protected", "synchronized", "ObjectName", "getMemberObjectName", "(", ")", "{", "final", "MBeanServer", "platformMBeanServer", "=", "getMBeanServer", "(", ");", "final", "DistributedSystemMXBean", "distributedSystemMXBean", "=", "JMX", ".", "newMXBeanProxy", "(", "platformMBeanServer", ",", "MBeanServer", "platformMBeanServer", "=", "getMBeanServer", "(", ");", "DistributedSystemMXBean", "distributedSystemMXBean", "=", "JMX", ".", "newMXBeanProxy", "(", "platformMBeanServer", ",", "MBeanJMXAdapter", ".", "getDistributedSystemName", "(", "),", "DistributedSystemMXBean", ".", "class", ")", ";", "return", "distributedSystemMXBean", ".", "getMemberObjectName", "(", ");", "}", "@", "@", "-", "494", ",", "7", "+", "212", ",", "7", "@", "@", "private", "MemberMXBean", "createMemberMXBeanForManagerUsingProxy", "(", "final", "MBeanServer", "se", "*", "@", "see", "LoginHandlerInterceptor", "#", "getEnvironment", "(", ")", "*", "/", "protected", "Map", "<", "String", ",", "String", ">", "getEnvironment", "(", ")", "{", "final", "Map", "<", "String", ",", "String", ">", "environment", "=", "new", "HashMap", "<", "String", ",", "String", ">", "()", ";", "final", "Map", "<", "String", ",", "String", ">", "environment", "=", "new", "HashMap", "<", ">(", ");", "environment", ".", "putAll", "(", "LoginHandlerInterceptor", ".", "getEnvironment", "(", "))", ";", "environment", ".", "put", "(", "Gfsh", ".", "ENV_APP_NAME", ",", "Gfsh", ".", "GFSH_APP_NAME", ")", ";", "@", "@", "-", "525", ",", "13", "+", "243", ",", "7", "@", "@", "protected", "String", "processCommand", "(", "final", "String", "command", ",", "final", "Map", "<", "String", ",", "String", ">", "logger", ".", "debug", "(", "LogMarker", ".", "CONFIG", ",", "\"", "Processing", "Command", "(", "{}", ")", "with", "Environment", "(", "{}", ")", "having", "File", "Data", "(", "{}", ").", "..", "\",", "command", ",", "environment", ",", "(", "fileData", "!", "=", "null", "&", "&", "fileData", ".", "length", ">", "0", ")", ");", "return", "getManagingMemberMXBean", "(", ").", "processCommand", "(", "command", ",", "environment", ",", "ArrayUtils", ".", "toByteArray", "(", "fileData", ")", ");", "MemberMXBean", "manager", "=", "getManagingMemberMXBean", "(", ");", "return", "manager", ".", "processCommand", "(", "command", ",", "environment", ",", "ArrayUtils", ".", "toByteArray", "(", "fileData", ")", ");", "}", "@", "ExceptionHandler", "(", "NotAuthorizedException", ".", "class", ")", "public", "ResponseEntity", "<", "String", ">", "handleAppException", "(", "NotAuthorizedException", "ex", ")", "{", "return", "new", "ResponseEntity", "<", "String", ">", "(", "ex", ".", "getMessage", "(", "),", "HttpStatus", ".", "FORBIDDEN", ")", ";", "}", "}", "@", "@", "-", "1", ",", "77", "+", "0", ",", "0", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "*", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "*", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "*", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "*", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "*", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "*", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "controllers", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "FileOutputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "lang", ".", "SystemUtils", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "util", ".", "IOUtils", ";", "import", "org", ".", "springframework", ".", "web", ".", "multipart", ".", "MultipartFile", ";", "/", "**", "*", "The", "AbstractMultiPartCommandsController", "class", "is", "a", "abstract", "base", "class", "encapsulating", "all", "common", "*", "functionality", "for", "handling", "multi", "-", "part", "(", "file", "upload", ")", "HTTP", "requests", ".", "*", "<", "p", "/", ">", "*", "*", "@", "see", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "controllers", ".", "AbstractCommandsController", "*", "@", "since", "GemFire", "8", ".", "0", "*", "/", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "class", "AbstractMultiPartCommandsController", "extends", "AbstractCommandsController", "{", "protected", "static", "final", "String", "RESOURCES_REQUEST_PARAMETER", "=", "\"", "resources", "\"", ";", "/", "**", "*", "Saves", "an", "array", "of", "File", "objects", "to", "this", "system", "'", "s", "file", "system", ".", "*", "<", "p", "/", ">", "*", "*", "@", "param", "files", "an", "array", "of", "MultipartFile", "objects", "to", "persist", "to", "the", "file", "system", ".", "*", "@", "throws", "IOException", "if", "I", "/", "O", "error", "occurs", "while", "saving", "the", "Files", "to", "the", "file", "system", ".", "*", "@", "see", "org", ".", "springframework", ".", "web", ".", "multipart", ".", "MultipartFile", "*", "/", "protected", "static", "void", "save", "(", "final", "MultipartFile", ".", "..", "files", ")", "throws", "IOException", "{", "if", "(", "files", "!", "=", "null", ")", "{", "for", "(", "final", "MultipartFile", "file", ":", "files", ")", "{", "save", "(", "file", ")", ";", "}", "}", "}", "/", "**", "*", "Saves", "a", "multi", "-", "part", "File", "to", "this", "system", "'", "s", "file", "system", ".", "*", "<", "p", "/", ">", "*", "*", "@", "param", "file", "the", "MultipartFile", "object", "to", "persist", "to", "the", "file", "system", ".", "*", "@", "throws", "IOException", "if", "I", "/", "O", "error", "occurs", "while", "saving", "the", "File", "to", "the", "file", "system", ".", "*", "@", "see", "org", ".", "springframework", ".", "web", ".", "multipart", ".", "MultipartFile", "*", "/", "protected", "static", "void", "save", "(", "final", "MultipartFile", "file", ")", "throws", "IOException", "{", "final", "File", "saveFile", "=", "new", "File", "(", "SystemUtils", ".", "CURRENT_DIRECTORY", ",", "file", ".", "getOriginalFilename", "(", "))", ";", "FileOutputStream", "fileWriter", "=", "null", ";", "try", "{", "fileWriter", "=", "new", "FileOutputStream", "(", "saveFile", ",", "false", ")", ";", "fileWriter", ".", "write", "(", "file", ".", "getBytes", "(", "))", ";", "fileWriter", ".", "flush", "(", ");", "}", "finally", "{", "IOUtils", ".", "close", "(", "fileWriter", ")", ";", "}", "}", "}", "@", "@", "-", "14", ",", "7", "+", "14", ",", "8", "@", "@", "*", "/", "package", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "controllers", ";", "import", "static", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "controllers", ".", "AbstractMultiPartCommandsController", ".", "RESOURCES_REQUEST_PARAMETER", ";", "import", "static", "org", ".", "apache", ".", "commons", ".", "io", ".", "IOUtils", ".", "toInputStream", ";", "import", "static", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "util", ".", "UriUtils", ".", "decode", ";", "import", "java", ".", "io", ".", "FileInputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "@", "@", "-", "23", ",", "8", "+", "24", ",", "11", "@", "@", "import", "javax", ".", "management", ".", "AttributeNotFoundException", ";", "import", "javax", ".", "management", ".", "InstanceNotFoundException", ";", "import", "javax", ".", "management", ".", "MBeanException", ";", "import", "javax", ".", "management", ".", "MBeanServer", ";", "import", "javax", ".", "management", ".", "MalformedObjectNameException", ";", "import", "javax", ".", "management", ".", "ObjectName", ";", "import", "javax", ".", "management", ".", "ReflectionException", ";", "import", "org", ".", "apache", ".", "commons", ".", "io", ".", "FileUtils", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang", ".", "ArrayUtils", ";", "@", "@", "-", "65", ",", "113", "+", "69", ",", "53", "@", "@", "@", "RequestMapping", "(", "AbstractCommandsController", ".", "REST_API_VERSION", ")", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "class", "ShellCommandsController", "extends", "AbstractCommandsController", "{", "protected", "static", "final", "String", "MBEAN_ATTRIBUTE_LINK_RELATION", "=", "\"", "mbean", "-", "attribute", "\"", ";", "protected", "static", "final", "String", "MBEAN_OPERATION_LINK_RELATION", "=", "\"", "mbean", "-", "operation", "\"", ";", "protected", "static", "final", "String", "MBEAN_QUERY_LINK_RELATION", "=", "\"", "mbean", "-", "query", "\"", ";", "protected", "static", "final", "String", "PING_LINK_RELATION", "=", "\"", "ping", "\"", ";", "@", "RequestMapping", "(", "method", "=", "{", "RequestMethod", ".", "GET", ",", "RequestMethod", ".", "POST", "}", ",", "value", "=", "\"", "/", "management", "/", "commands", "\"", ")", "public", "ResponseEntity", "<", "InputStreamResource", ">", "command", "(", "@", "RequestParam", "(", "value", "=", "\"", "cmd", "\"", ")", "String", "command", ",", "@", "RequestParam", "(", "value", "=", "RESOURCES_REQUEST_PARAMETER", ",", "required", "=", "false", ")", "MultipartFile", "[", "]", "fileResource", ")", "@", "RequestParam", "(", "value", "=", "\"", "resources", "\"", ",", "required", "=", "false", ")", "MultipartFile", "[", "]", "fileResource", ")", "throws", "IOException", "{", "String", "result", "=", "processCommand", "(", "decode", "(", "command", ")", ",", "getEnvironment", "(", "),", "ConvertUtils", ".", "convert", "(", "fileResource", ")", ");", "return", "getResponse", "(", "result", ")", ";", "}", "ResponseEntity", "<", "InputStreamResource", ">", "getResponse", "(", "String", "result", ")", "{", "/", "/", "the", "result", "is", "json", "string", "from", "CommandResult", "CommandResult", "commandResult", "=", "ResultBuilder", ".", "fromJson", "(", "result", ")", ";", "if", "(", "commandResult", ".", "getStatus", "(", ").", "equals", "(", "Result", ".", "Status", ".", "OK", ")", "&", "&", "commandResult", ".", "hasFileToDownload", "(", "))", "{", "return", "getFileDownloadResponse", "(", "commandResult", ")", ";", "}", "else", "{", "return", "getJsonResponse", "(", "result", ")", ";", "}", "}", "private", "ResponseEntity", "<", "InputStreamResource", ">", "getJsonResponse", "(", "String", "result", ")", "{", "/", "/", "if", "the", "command", "is", "successful", ",", "the", "output", "is", "the", "filepath", ",", "else", "we", "need", "to", "send", "the", "/", "/", "original", "result", "back", "so", "that", "the", "receiver", "will", "know", "to", "turn", "it", "into", "a", "Result", "object", "HttpHeaders", "respHeaders", "=", "new", "HttpHeaders", "(", ");", "try", "{", "InputStreamResource", "isr", "=", "new", "InputStreamResource", "(", "org", ".", "apache", ".", "commons", ".", "io", ".", "IOUtils", ".", "toInputStream", "(", "result", ",", "\"", "UTF", "-", "8", "\"", "))", ";", "respHeaders", ".", "set", "(", "HttpHeaders", ".", "CONTENT_TYPE", ",", "MediaType", ".", "APPLICATION_JSON_VALUE", ")", ";", "return", "new", "ResponseEntity", "<", ">(", "isr", ",", "respHeaders", ",", "HttpStatus", ".", "OK", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "new", "RuntimeException", "(", "\"", "IO", "Error", "writing", "file", "to", "output", "stream", "\"", ",", "e", ")", ";", "}", "}", "private", "ResponseEntity", "<", "InputStreamResource", ">", "getFileDownloadResponse", "(", "CommandResult", "commandResult", ")", "{", "HttpHeaders", "respHeaders", "=", "new", "HttpHeaders", "(", ");", "InputStreamResource", "isr", ";", "//", "if", "the", "command", "is", "successful", ",", "the", "output", "is", "the", "filepath", ",", "Path", "filePath", "=", "commandResult", ".", "getFileToDownload", "(", ");", "try", "{", "isr", "=", "new", "InputStreamResource", "(", "new", "FileInputStream", "(", "filePath", ".", "toFile", "(", "))", ");", "respHeaders", ".", "set", "(", "HttpHeaders", ".", "CONTENT_TYPE", ",", "MediaType", ".", "APPLICATION_OCTET_STREAM_VALUE", ")", ";", "return", "new", "ResponseEntity", "<", ">(", "isr", ",", "respHeaders", ",", "HttpStatus", ".", "OK", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "new", "RuntimeException", "(", "\"", "IO", "Error", "writing", "file", "to", "output", "stream", "\"", ",", "e", ")", ";", "}", "finally", "{", "FileUtils", ".", "deleteQuietly", "(", "filePath", ".", "toFile", "(", "))", ";", "}", "}", "@", "RequestMapping", "(", "method", "=", "RequestMethod", ".", "GET", ",", "value", "=", "\"", "/", "mbean", "/", "attribute", "\"", ")", "public", "ResponseEntity", "<", "?>", "getAttribute", "(", "@", "RequestParam", "(", "\"", "resourceName", "\"", ")", "final", "String", "resourceName", ",", "@", "RequestParam", "(", "\"", "attributeName", "\"", ")", "final", "String", "attributeName", ")", "{", "try", "{", "final", "Object", "attributeValue", "=", "getMBeanServer", "(", ")", ".", "getAttribute", "(", "ObjectName", ".", "getInstance", "(", "decode", "(", "resourceName", ")", "),", "decode", "(", "attributeName", ")", ");", "return", "new", "ResponseEntity", "<", ">(", "IOUtils", ".", "serializeObject", "(", "attributeValue", ")", ",", "HttpStatus", ".", "OK", ")", ";", "}", "catch", "(", "AttributeNotFoundException", "|", "MalformedObjectNameException", "e", ")", "{", "return", "new", "ResponseEntity", "<", ">(", "printStackTrace", "(", "e", ")", ",", "HttpStatus", ".", "BAD_REQUEST", ")", ";", "}", "catch", "(", "InstanceNotFoundException", "e", ")", "{", "return", "new", "ResponseEntity", "<", ">(", "printStackTrace", "(", "e", ")", ",", "HttpStatus", ".", "NOT_FOUND", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "return", "new", "ResponseEntity", "<", ">(", "printStackTrace", "(", "e", ")", ",", "HttpStatus", ".", "INTERNAL_SERVER_ERROR", ")", ";", "}", "@", "RequestParam", "(", "\"", "attributeName", "\"", ")", "final", "String", "attributeName", ")", "throws", "AttributeNotFoundException", ",", "MBeanException", ",", "ReflectionException", ",", "InstanceNotFoundException", ",", "IOException", ",", "MalformedObjectNameException", "{", "/", "/", "Exceptions", "are", "caught", "by", "the", "@", "ExceptionHandler", "AbstractCommandsController", ".", "handleAppException", "MBeanServer", "mBeanServer", "=", "getMBeanServer", "(", ");", "ObjectName", "objectName", "=", "ObjectName", ".", "getInstance", "(", "decode", "(", "resourceName", ")", ");", "final", "Object", "attributeValue", "=", "mBeanServer", ".", "getAttribute", "(", "objectName", ",", "decode", "(", "attributeName", ")", ");", "byte", "[", "]", "serializedResult", "=", "IOUtils", ".", "serializeObject", "(", "attributeValue", ")", ";", "return", "new", "ResponseEntity", "<", ">(", "serializedResult", ",", "HttpStatus", ".", "OK", ")", ";", "}", "@", "RequestMapping", "(", "method", "=", "RequestMethod", ".", "POST", ",", "value", "=", "\"", "/", "mbean", "/", "operation", "\"", ")", "public", "ResponseEntity", "<", "?>", "invoke", "(", "@", "RequestParam", "(", "\"", "resourceName", "\"", ")", "final", "String", "resourceName", ",", "@", "RequestParam", "(", "\"", "operationName", "\"", ")", "final", "String", "operationName", ",", "@", "RequestParam", "(", "value", "=", "\"", "signature", "\"", ",", "required", "=", "false", ")", "String", "[", "]", "signature", ",", "@", "RequestParam", "(", "value", "=", "\"", "parameters", "\"", ",", "required", "=", "false", ")", "Object", "[", "]", "parameters", ")", "{", "@", "RequestParam", "(", "value", "=", "\"", "parameters", "\"", ",", "required", "=", "false", ")", "Object", "[", "]", "parameters", ")", "throws", "MalformedObjectNameException", ",", "MBeanException", ",", "InstanceNotFoundException", ",", "ReflectionException", ",", "IOException", "{", "/", "/", "Exceptions", "are", "caught", "by", "the", "@", "ExceptionHandler", "AbstractCommandsController", ".", "handleAppException", "signature", "=", "(", "signature", "!", "=", "null", "?", "signature", ":", "ArrayUtils", ".", "EMPTY_STRING_ARRAY", ")", ";", "parameters", "=", "(", "parameters", "!", "=", "null", "?", "parameters", ":", "ObjectUtils", ".", "EMPTY_OBJECT_ARRAY", ")", ";", "try", "{", "final", "Object", "result", "=", "getMBeanServer", "(", ").", "invoke", "(", "ObjectName", ".", "getInstance", "(", "decode", "(", "resourceName", ")", "),", "decode", "(", "operationName", ")", ",", "parameters", ",", "signature", ")", ";", "return", "new", "ResponseEntity", "<", ">(", "IOUtils", ".", "serializeObject", "(", "result", ")", ",", "HttpStatus", ".", "OK", ")", ";", "}", "catch", "(", "InstanceNotFoundException", "e", ")", "{", "return", "new", "ResponseEntity", "<", ">(", "printStackTrace", "(", "e", ")", ",", "HttpStatus", ".", "NOT_FOUND", ")", ";", "}", "catch", "(", "MalformedObjectNameException", "e", ")", "{", "return", "new", "ResponseEntity", "<", ">(", "printStackTrace", "(", "e", ")", ",", "HttpStatus", ".", "BAD_REQUEST", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "return", "new", "ResponseEntity", "<", ">(", "printStackTrace", "(", "e", ")", ",", "HttpStatus", ".", "INTERNAL_SERVER_ERROR", ")", ";", "}", "MBeanServer", "mBeanServer", "=", "getMBeanServer", "(", ");", "ObjectName", "objectName", "=", "ObjectName", ".", "getInstance", "(", "decode", "(", "resourceName", ")", ");", "final", "Object", "result", "=", "mBeanServer", ".", "invoke", "(", "objectName", ",", "decode", "(", "operationName", ")", ",", "parameters", ",", "signature", ")", ";", "byte", "[", "]", "serializedResult", "=", "IOUtils", ".", "serializeObject", "(", "result", ")", ";", "return", "new", "ResponseEntity", "<", ">(", "serializedResult", ",", "HttpStatus", ".", "OK", ")", ";", "}", "@", "RequestMapping", "(", "method", "=", "RequestMethod", ".", "POST", ",", "value", "=", "\"", "/", "mbean", "/", "query", "\"", ")", "public", "ResponseEntity", "<", "?>", "queryNames", "(", "@", "RequestBody", "final", "QueryParameterSource", "query", ")", "{", "try", "{", "final", "Set", "<", "ObjectName", ">", "objectNames", "=", "getMBeanServer", "(", ").", "queryNames", "(", "query", ".", "getObjectName", "(", "),", "query", ".", "getQueryExpression", "(", "))", ";", "return", "new", "ResponseEntity", "<", ">(", "IOUtils", ".", "serializeObject", "(", "objectNames", ")", ",", "HttpStatus", ".", "OK", ")", ";", "}", "catch", "(", "IOException", "e", ")", "{", "return", "new", "ResponseEntity", "<", ">(", "printStackTrace", "(", "e", ")", ",", "HttpStatus", ".", "INTERNAL_SERVER_ERROR", ")", ";", "}", "public", "ResponseEntity", "<", "?>", "queryNames", "(", "@", "RequestBody", "final", "QueryParameterSource", "query", ")", "throws", "IOException", "{", "/", "/", "Exceptions", "are", "caught", "by", "the", "@", "ExceptionHandler", "AbstractCommandsController", ".", "handleAppException", "final", "Set", "<", "ObjectName", ">", "objectNames", "=", "getMBeanServer", "(", ").", "queryNames", "(", "query", ".", "getObjectName", "(", "),", "query", ".", "getQueryExpression", "(", "))", ";", "return", "new", "ResponseEntity", "<", ">(", "IOUtils", ".", "serializeObject", "(", "objectNames", ")", ",", "HttpStatus", ".", "OK", ")", ";", "}", "@", "RequestMapping", "(", "method", "=", "{", "RequestMethod", ".", "GET", ",", "RequestMethod", ".", "HEAD", "}", ",", "value", "=", "\"", "/", "ping", "\"", ")", "@", "@", "-", "187", ",", "8", "+", "131", ",", "42", "@", "@", "public", "String", "version", "(", ")", "{", "@", "RequestMapping", "(", "method", "=", "RequestMethod", ".", "GET", ",", "value", "=", "\"", "/", "version", "/", "full", "\"", ")", "@", "ResponseBody", "public", "String", "versionSimple", "(", ")", "{", "public", "String", "fullVersion", "(", ")", "{", "return", "GemFireVersion", ".", "asString", "(", ");", "}", "private", "ResponseEntity", "<", "InputStreamResource", ">", "getResponse", "(", "String", "result", ")", "{", "CommandResult", "commandResult", "=", "ResultBuilder", ".", "fromJson", "(", "result", ")", ";", "if", "(", "commandResult", ".", "getStatus", "(", ").", "equals", "(", "Result", ".", "Status", ".", "OK", ")", "&", "&", "commandResult", ".", "hasFileToDownload", "(", "))", "{", "return", "getFileDownloadResponse", "(", "commandResult", ")", ";", "}", "else", "{", "return", "getJsonResponse", "(", "result", ")", ";", "}", "}", "private", "ResponseEntity", "<", "InputStreamResource", ">", "getJsonResponse", "(", "String", "result", ")", "{", "HttpHeaders", "respHeaders", "=", "new", "HttpHeaders", "(", ");", "try", "{", "InputStreamResource", "isr", "=", "new", "InputStreamResource", "(", "toInputStream", "(", "result", ",", "\"", "UTF", "-", "8", "\"", "))", ";", "respHeaders", ".", "set", "(", "HttpHeaders", ".", "CONTENT_TYPE", ",", "MediaType", ".", "APPLICATION_JSON_VALUE", ")", ";", "return", "new", "ResponseEntity", "<", ">(", "isr", ",", "respHeaders", ",", "HttpStatus", ".", "OK", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "new", "RuntimeException", "(", "\"", "IO", "Error", "writing", "file", "to", "output", "stream", "\"", ",", "e", ")", ";", "}", "}", "private", "ResponseEntity", "<", "InputStreamResource", ">", "getFileDownloadResponse", "(", "CommandResult", "commandResult", ")", "{", "HttpHeaders", "respHeaders", "=", "new", "HttpHeaders", "(", ");", "Path", "filePath", "=", "commandResult", ".", "getFileToDownload", "(", ");", "try", "{", "InputStreamResource", "isr", "=", "new", "InputStreamResource", "(", "new", "FileInputStream", "(", "filePath", ".", "toFile", "(", "))", ");", "respHeaders", ".", "set", "(", "HttpHeaders", ".", "CONTENT_TYPE", ",", "MediaType", ".", "APPLICATION_OCTET_STREAM_VALUE", ")", ";", "return", "new", "ResponseEntity", "<", ">(", "isr", ",", "respHeaders", ",", "HttpStatus", ".", "OK", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "new", "RuntimeException", "(", "\"", "IO", "Error", "writing", "file", "to", "output", "stream", "\"", ",", "e", ")", ";", "}", "finally", "{", "FileUtils", ".", "deleteQuietly", "(", "filePath", ".", "toFile", "(", "))", ";", "}", "}", "}", "@", "@", "-", "15", ",", "24", "+", "15", ",", "19", "@", "@", "package", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "http", ".", "support", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Properties", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "org", ".", "springframework", ".", "http", ".", "HttpEntity", ";", "import", "org", ".", "springframework", ".", "http", ".", "HttpHeaders", ";", "import", "org", ".", "springframework", ".", "http", ".", "HttpMethod", ";", "import", "org", ".", "springframework", ".", "http", ".", "HttpStatus", ";", "import", "org", ".", "springframework", ".", "http", ".", "ResponseEntity", ";", "import", "org", ".", "springframework", ".", "http", ".", "client", ".", "ClientHttpResponse", ";", "import", "org", ".", "springframework", ".", "http", ".", "client", ".", "SimpleClientHttpRequestFactory", ";", "import", "org", ".", "springframework", ".", "web", ".", "client", ".", "ResponseErrorHandler", ";", "import", "org", ".", "springframework", ".", "web", ".", "client", ".", "RestTemplate", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "cli", ".", "shell", ".", "Gfsh", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "AuthenticationFailedException", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "NotAuthorizedException", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "shell", ".", "RestOperationErrorHandler", ";", "/", "**", "@", "@", "-", "78", ",", "51", "+", "73", ",", "7", "@", "@", "public", "SimpleHttpRequester", "(", "final", "Gfsh", "gfsh", ",", "final", "int", "connectTimeout", ",", "this", ".", "securityProperties", "=", "securityProperties", ";", "this", ".", "restTemplate", "=", "new", "RestTemplate", "(", "clientHttpRequestFactory", ")", ";", "this", ".", "restTemplate", ".", "setErrorHandler", "(", "new", "ResponseErrorHandler", "(", ")", "{", "@", "Override", "public", "boolean", "hasError", "(", "final", "ClientHttpResponse", "response", ")", "throws", "IOException", "{", "final", "HttpStatus", "status", "=", "response", ".", "getStatusCode", "(", ");", "switch", "(", "status", ")", "{", "case", "BAD_REQUEST", ":", "/", "/", "400", "*", "case", "UNAUTHORIZED", ":", "/", "/", "401", "case", "FORBIDDEN", ":", "/", "/", "403", "case", "NOT_FOUND", ":", "/", "/", "404", "*", "case", "METHOD_NOT_ALLOWED", ":", "/", "/", "405", "*", "case", "NOT_ACCEPTABLE", ":", "/", "/", "406", "*", "case", "REQUEST_TIMEOUT", ":", "/", "/", "408", "case", "CONFLICT", ":", "/", "/", "409", "case", "REQUEST_ENTITY_TOO_LARGE", ":", "/", "/", "413", "case", "REQUEST_URI_TOO_LONG", ":", "/", "/", "414", "case", "UNSUPPORTED_MEDIA_TYPE", ":", "/", "/", "415", "*", "case", "TOO_MANY_REQUESTS", ":", "/", "/", "429", "case", "INTERNAL_SERVER_ERROR", ":", "/", "/", "500", "*", "case", "NOT_IMPLEMENTED", ":", "/", "/", "501", "case", "BAD_GATEWAY", ":", "/", "/", "502", "?", "case", "SERVICE_UNAVAILABLE", ":", "/", "/", "503", "return", "true", ";", "default", ":", "return", "false", ";", "}", "}", "@", "Override", "public", "void", "handleError", "(", "final", "ClientHttpResponse", "response", ")", "throws", "IOException", "{", "final", "String", "message", "=", "String", ".", "format", "(", "\"", "The", "HTTP", "request", "failed", "with", ":", "%", "1", "$", "d", "-", "%", "2", "$", "s", "\"", ",", "response", ".", "getRawStatusCode", "(", "),", "response", ".", "getStatusText", "(", "))", ";", "if", "(", "response", ".", "getRawStatusCode", "(", ")", "=", "=", "401", ")", "{", "throw", "new", "AuthenticationFailedException", "(", "message", ")", ";", "}", "else", "if", "(", "response", ".", "getRawStatusCode", "(", ")", "=", "=", "403", ")", "{", "throw", "new", "NotAuthorizedException", "(", "message", ")", ";", "}", "else", "{", "throw", "new", "RuntimeException", "(", "message", ")", ";", "}", "}", "}", ");", "this", ".", "restTemplate", ".", "setErrorHandler", "(", "new", "RestOperationErrorHandler", "(", "))", ";", "}", "@", "@", "-", "14", ",", "9", "+", "14", ",", "7", "@", "@", "*", "/", "package", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "shell", ";", "import", "java", ".", "io", ".", "BufferedReader", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStreamReader", ";", "import", "java", ".", "net", ".", "URI", ";", "import", "java", ".", "net", ".", "URISyntaxException", ";", "import", "java", ".", "nio", ".", "file", ".", "Files", ";", "@", "@", "-", "33", ",", "12", "+", "31", ",", "12", "@", "@", "import", "javax", ".", "management", ".", "QueryExp", ";", "import", "org", ".", "apache", ".", "commons", ".", "io", ".", "FileUtils", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang", ".", "StringUtils", ";", "import", "org", ".", "apache", ".", "logging", ".", "log4j", ".", "Logger", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "http", ".", "HttpEntity", ";", "import", "org", ".", "springframework", ".", "http", ".", "HttpHeaders", ";", "import", "org", ".", "springframework", ".", "http", ".", "HttpMethod", ";", "import", "org", ".", "springframework", ".", "http", ".", "HttpStatus", ";", "import", "org", ".", "springframework", ".", "http", ".", "MediaType", ";", "import", "org", ".", "springframework", ".", "http", ".", "ResponseEntity", ";", "import", "org", ".", "springframework", ".", "http", ".", "client", ".", "ClientHttpResponse", ";", "@", "@", "-", "48", ",", "13", "+", "46", ",", "11", "@", "@", "import", "org", ".", "springframework", ".", "util", ".", "LinkedMultiValueMap", ";", "import", "org", ".", "springframework", ".", "util", ".", "MultiValueMap", ";", "import", "org", ".", "springframework", ".", "web", ".", "client", ".", "ResourceAccessException", ";", "import", "org", ".", "springframework", ".", "web", ".", "client", ".", "ResponseErrorHandler", ";", "import", "org", ".", "springframework", ".", "web", ".", "client", ".", "RestTemplate", ";", "import", "org", ".", "springframework", ".", "web", ".", "util", ".", "UriComponentsBuilder", ";", "import", "org", ".", "apache", ".", "geode", ".", "annotations", ".", "TestingOnly", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "GemFireVersion", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "lang", ".", "StringUtils", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "logging", ".", "LogService", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "util", ".", "IOUtils", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "DistributedSystemMXBean", ";", "@", "@", "-", "68", ",", "8", "+", "64", ",", "6", "@", "@", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "http", ".", "support", ".", "SimpleHttpRequester", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "shell", ".", "support", ".", "HttpMBeanProxyFactory", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "util", ".", "ConvertUtils", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "AuthenticationFailedException", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "NotAuthorizedException", ";", "/", "**", "*", "The", "HttpOperationInvoker", "class", "is", "an", "abstract", "base", "class", "encapsulating", "common", "functionality", "for", "@", "@", "-", "85", ",", "23", "+", "79", ",", "23", "@", "@", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "class", "HttpOperationInvoker", "implements", "OperationInvoker", "{", "protected", "static", "final", "long", "DEFAULT_INITIAL_DELAY", "=", "TimeUnit", ".", "SECONDS", ".", "toMillis", "(", "1", ")", ";", "protected", "static", "final", "long", "DEFAULT_PERIOD", "=", "TimeUnit", ".", "MILLISECONDS", ".", "toMillis", "(", "2000", ")", ";", "private", "static", "final", "long", "DEFAULT_INITIAL_DELAY", "=", "TimeUnit", ".", "SECONDS", ".", "toMillis", "(", "1", ")", ";", "private", "static", "final", "long", "DEFAULT_PERIOD", "=", "TimeUnit", ".", "MILLISECONDS", ".", "toMillis", "(", "2000", ")", ";", "protected", "static", "final", "String", "REST_API_BASE_URL", "=", "\"", "http", ":", "//", "localhost", ":", "8080", "\"", ";", "protected", "static", "final", "String", "REST_API_VERSION", "=", "\"", "/", "v1", "\"", ";", "protected", "static", "final", "String", "REST_API_WEB_APP_CONTEXT", "=", "\"", "/", "geode", "-", "mgmt", "\"", ";", "protected", "static", "final", "String", "REST_API_URL", "=", "private", "static", "final", "String", "REST_API_BASE_URL", "=", "\"", "http", ":", "//", "localhost", ":", "8080", "\"", ";", "private", "static", "final", "String", "REST_API_VERSION", "=", "\"", "/", "v1", "\"", ";", "private", "static", "final", "String", "REST_API_WEB_APP_CONTEXT", "=", "\"", "/", "geode", "-", "mgmt", "\"", ";", "private", "static", "final", "String", "REST_API_URL", "=", "REST_API_BASE_URL", "+", "REST_API_WEB_APP_CONTEXT", "+", "REST_API_VERSION", ";", "protected", "static", "final", "String", "USER_AGENT_HTTP_REQUEST_HEADER_VALUE", "=", "private", "static", "final", "String", "USER_AGENT_HTTP_REQUEST_HEADER_VALUE", "=", "\"", "GemFire", "-", "Shell", "/", "v", "\"", "+", "GemFireVersion", ".", "getGemFireVersion", "(", ");", "protected", "static", "final", "TimeUnit", "DEFAULT_TIME_UNIT", "=", "TimeUnit", ".", "MILLISECONDS", ";", "private", "static", "final", "TimeUnit", "DEFAULT_TIME_UNIT", "=", "TimeUnit", ".", "MILLISECONDS", ";", "/", "/", "the", "ID", "of", "the", "GemFire", "distributed", "system", "(", "cluster", ")", "private", "Integer", "clusterId", "=", "CLUSTER_ID_WHEN_NOT_CONNECTED", ";", "protected", "static", "final", "String", "RESOURCES_REQUEST_PARAMETER", "=", "\"", "resources", "\"", ";", "private", "static", "final", "String", "RESOURCES_REQUEST_PARAMETER", "=", "\"", "resources", "\"", ";", "/", "/", "Executor", "for", "scheduling", "periodic", "Runnable", "task", "to", "assess", "the", "state", "of", "the", "Manager", "'", "s", "HTTP", "/", "/", "service", "or", "Web", "Service", "@", "@", "-", "144", ",", "7", "+", "138", ",", "7", "@", "@", "*", "testing", "purposes", ".", "*", "/", "@", "TestingOnly", "HttpOperationInvoker", "(", "final", "String", "baseUrl", ")", "{", "private", "HttpOperationInvoker", "(", "final", "String", "baseUrl", ")", "{", "this", ".", "baseUrl", "=", "baseUrl", ";", "this", ".", "executorService", "=", "null", ";", "this", ".", "gfsh", "=", "null", ";", "@", "@", "-", "154", ",", "7", "+", "148", ",", "7", "@", "@", "/", "**", "*", "Constructs", "an", "instance", "of", "the", "HttpOperationInvoker", "class", "with", "a", "reference", "to", "the", "GemFire", "shell", "*", "(", "Gfsh", ")", "instance", "using", "this", "HTTP", "-", "based", "OperationInvoker", "to", "send", "commands", "to", "the", "GemFire", "Manager", "*", "via", "HTTP", "for", "procsessing", "along", "with", "the", "base", "URL", "to", "the", "GemFire", "Manager", "'", "s", "embedded", "HTTP", "service", "*", "via", "HTTP", "for", "processing", "along", "with", "the", "base", "URL", "to", "the", "GemFire", "Manager", "'", "s", "embedded", "HTTP", "service", "*", "hosting", "the", "HTTP", "(", "REST", ")", "interface", ".", "*", "*", "@", "param", "gfsh", "a", "reference", "to", "the", "instance", "of", "the", "GemFire", "shell", "(", "Gfsh", ")", "using", "this", "HTTP", "-", "based", "@", "@", "-", "178", ",", "9", "+", "172", ",", "8", "@", "@", "public", "HttpOperationInvoker", "(", "final", "Gfsh", "gfsh", ",", "final", "String", "baseUrl", ",", "/", "/", "constructs", "an", "instance", "of", "the", "Spring", "RestTemplate", "for", "M", "&", "M", "REST", "API", "(", "interface", ")", "operations", "this", ".", "restTemplate", "=", "new", "RestTemplate", "(", "new", "SimpleClientHttpRequestFactory", "(", "))", ";", "/", "/", "add", "our", "custom", "HttpMessageConverter", "for", "serializing", "DTO", "Objects", "into", "the", "HTTP", "request", "message", "/", "/", "body", "/", "/", "and", "de", "-", "serializing", "HTTP", "response", "message", "body", "content", "back", "into", "DTO", "Objects", "/", "/", "add", "our", "custom", "HttpMessageConverter", "for", "serializing", "DTO", "Objects", "into", "the", "HTTP", "request", "/", "/", "message", "body", "and", "de", "-", "serializing", "HTTP", "response", "message", "body", "content", "back", "into", "DTO", "Objects", "List", "<", "HttpMessageConverter", "<", "?>", ">", "converters", "=", "this", ".", "restTemplate", ".", "getMessageConverters", "(", ");", "/", "/", "remove", "the", "MappingJacksonHttpConverter", "for", "(", "int", "i", "=", "converters", ".", "size", "(", ")", "-", "1", ";", "i", ">", "=", "0", ";", "i", "-", "-)", "{", "@", "@", "-", "192", ",", "77", "+", "185", ",", "13", "@", "@", "public", "HttpOperationInvoker", "(", "final", "Gfsh", "gfsh", ",", "final", "String", "baseUrl", ",", "converters", ".", "add", "(", "new", "SerializableObjectHttpMessageConverter", "(", "))", ";", "/", "/", "set", "the", "ResponseErrorHandler", "handling", "any", "errors", "originating", "from", "our", "HTTP", "request", "this", ".", "restTemplate", ".", "setErrorHandler", "(", "new", "ResponseErrorHandler", "(", ")", "{", "@", "Override", "public", "boolean", "hasError", "(", "final", "ClientHttpResponse", "response", ")", "throws", "IOException", "{", "final", "HttpStatus", "status", "=", "response", ".", "getStatusCode", "(", ");", "switch", "(", "status", ")", "{", "case", "BAD_REQUEST", ":", "/", "/", "400", "*", "case", "UNAUTHORIZED", ":", "/", "/", "401", "case", "FORBIDDEN", ":", "/", "/", "403", "case", "NOT_FOUND", ":", "/", "/", "404", "*", "case", "METHOD_NOT_ALLOWED", ":", "/", "/", "405", "*", "case", "NOT_ACCEPTABLE", ":", "/", "/", "406", "*", "case", "REQUEST_TIMEOUT", ":", "/", "/", "408", "case", "CONFLICT", ":", "/", "/", "409", "case", "REQUEST_ENTITY_TOO_LARGE", ":", "/", "/", "413", "case", "REQUEST_URI_TOO_LONG", ":", "/", "/", "414", "case", "UNSUPPORTED_MEDIA_TYPE", ":", "/", "/", "415", "*", "case", "TOO_MANY_REQUESTS", ":", "/", "/", "429", "case", "INTERNAL_SERVER_ERROR", ":", "/", "/", "500", "*", "case", "NOT_IMPLEMENTED", ":", "/", "/", "501", "case", "BAD_GATEWAY", ":", "/", "/", "502", "?", "case", "SERVICE_UNAVAILABLE", ":", "/", "/", "503", "return", "true", ";", "default", ":", "return", "false", ";", "}", "}", "@", "Override", "public", "void", "handleError", "(", "final", "ClientHttpResponse", "response", ")", "throws", "IOException", "{", "String", "body", "=", "readBody", "(", "response", ")", ";", "final", "String", "message", "=", "String", ".", "format", "(", "\"", "The", "HTTP", "request", "failed", "with", ":", "%", "1", "$", "d", "-", "%", "2", "$", "s", ".", "\",", "response", ".", "getRawStatusCode", "(", "),", "body", ")", ";", "if", "(", "gfsh", ".", "getDebug", "(", "))", "{", "gfsh", ".", "logSevere", "(", "body", ",", "null", ")", ";", "}", "if", "(", "response", ".", "getRawStatusCode", "(", ")", "=", "=", "401", ")", "{", "throw", "new", "AuthenticationFailedException", "(", "message", ")", ";", "}", "else", "if", "(", "response", ".", "getRawStatusCode", "(", ")", "=", "=", "403", ")", "{", "throw", "new", "NotAuthorizedException", "(", "message", ")", ";", "}", "else", "{", "throw", "new", "RuntimeException", "(", "message", ")", ";", "}", "}", "private", "String", "readBody", "(", "final", "ClientHttpResponse", "response", ")", "throws", "IOException", "{", "BufferedReader", "responseBodyReader", "=", "null", ";", "this", ".", "restTemplate", ".", "setErrorHandler", "(", "new", "RestOperationErrorHandler", "(", "gfsh", ")", ");", "try", "{", "responseBodyReader", "=", "new", "BufferedReader", "(", "new", "InputStreamReader", "(", "response", ".", "getBody", "(", "))", ");", "final", "StringBuilder", "buffer", "=", "new", "StringBuilder", "(", ");", "String", "line", ";", "while", "(", "(", "line", "=", "responseBodyReader", ".", "readLine", "(", "))", "!", "=", "null", ")", "{", "buffer", ".", "append", "(", "line", ")", ".", "append", "(", "StringUtils", ".", "LINE_SEPARATOR", ")", ";", "}", "return", "buffer", ".", "toString", "(", ").", "trim", "(", ");", "}", "finally", "{", "IOUtils", ".", "close", "(", "responseBodyReader", ")", ";", "}", "}", "}", ");", "setupBackgroundPingRequest", "(", ");", "initClusterId", "(", ");", "}", "protected", "void", "setupBackgroundPingRequest", "(", ")", "{", "private", "void", "setupBackgroundPingRequest", "(", ")", "{", "SimpleHttpRequester", "requester", "=", "new", "SimpleHttpRequester", "(", "gfsh", ",", "securityProperties", ")", ";", "getExecutorService", "(", ").", "scheduleAtFixedRate", "(", "()", "-", ">", "{", "try", "{", "@", "@", "-", "312", ",", "7", "+", "241", ",", "7", "@", "@", "protected", "boolean", "isDebugEnabled", "(", ")", "{", "*", "@", "return", "an", "instance", "of", "the", "ScheduledExecutorService", "for", "scheduling", "periodic", "or", "delayed", "tasks", ".", "*", "@", "see", "java", ".", "util", ".", "concurrent", ".", "ScheduledExecutorService", "*", "/", "protected", "ScheduledExecutorService", "getExecutorService", "(", ")", "{", "private", "ScheduledExecutorService", "getExecutorService", "(", ")", "{", "return", "this", ".", "executorService", ";", "}", "@", "@", "-", "335", ",", "7", "+", "264", ",", "7", "@", "@", "protected", "Gfsh", "getGfsh", "(", ")", "{", "*", "@", "return", "an", "instance", "of", "the", "Spring", "RestTemplate", "used", "to", "make", "REST", "API", "web", "service", "calls", ".", "*", "@", "see", "org", ".", "springframework", ".", "web", ".", "client", ".", "RestTemplate", "*", "/", "protected", "RestTemplate", "getRestTemplate", "(", ")", "{", "private", "RestTemplate", "getRestTemplate", "(", ")", "{", "return", "this", ".", "restTemplate", ";", "}", "@", "@", "-", "365", ",", "7", "+", "294", ",", "7", "@", "@", "protected", "String", "handleResourceAccessException", "(", "final", "ResourceAccessException", "e", ")", "*", "@", "see", "#", "isDebugEnabled", "(", ")", "*", "@", "see", "#", "printInfo", "(", "String", ",", "Object", ".", "..", ")", "*", "/", "protected", "void", "printDebug", "(", "final", "String", "message", ",", "final", "Object", ".", "..", "args", ")", "{", "private", "void", "printDebug", "(", "final", "String", "message", ",", "final", "Object", ".", "..", "args", ")", "{", "if", "(", "isDebugEnabled", "(", "))", "{", "printInfo", "(", "message", ",", "args", ")", ";", "}", "@", "@", "-", "446", ",", "8", "+", "375", ",", "7", "@", "@", "Object", "extractResponse", "(", "ClientHttpResponse", "response", ")", "throws", "IOException", "{", "}", "}", "void", "addHeaderValues", "(", "org", ".", "springframework", ".", "http", ".", "client", ".", "ClientHttpRequest", "request", ")", "throws", "IOException", "{", "private", "void", "addHeaderValues", "(", "org", ".", "springframework", ".", "http", ".", "client", ".", "ClientHttpRequest", "request", ")", "{", "/", "/", "update", "the", "headers", "request", ".", "getHeaders", "(", ").", "add", "(", "HttpHeaders", ".", "USER_AGENT", ",", "USER_AGENT_HTTP_REQUEST_HEADER_VALUE", ")", ";", "request", ".", "getHeaders", "(", ").", "setAccept", "(", "acceptableMediaTypes", ")", ";", "@", "@", "-", "533", ",", "7", "+", "461", ",", "7", "@", "@", "public", "int", "getClusterId", "(", ")", "{", "return", "clusterId", ";", "}", "protected", "void", "initClusterId", "(", ")", "{", "private", "void", "initClusterId", "(", ")", "{", "if", "(", "isReady", "(", "))", "{", "try", "{", "clusterId", "=", "(", "Integer", ")", "getAttribute", "(", "ManagementConstants", ".", "OBJECTNAME__DISTRIBUTEDSYSTEM_MXBEAN", ",", "@", "@", "-", "593", ",", "7", "+", "521", ",", "7", "@", "@", "public", "Object", "invoke", "(", "final", "String", "resourceName", ",", "final", "String", "operationName", ",", "fina", "final", "String", "[", "]", "signatures", ")", "{", "final", "URI", "link", "=", "createURI", "(", "\"/", "mbean", "/", "operation", "\"", ");", "MultiValueMap", "<", "String", ",", "Object", ">", "content", "=", "new", "LinkedMultiValueMap", "<", "String", ",", "Object", ">", "()", ";", "MultiValueMap", "<", "String", ",", "Object", ">", "content", "=", "new", "LinkedMultiValueMap", "<", ">(", ");", "content", ".", "add", "(", "\"", "resourceName", "\"", ",", "resourceName", ")", ";", "content", ".", "add", "(", "\"", "operationName", "\"", ",", "operationName", ")", ";", "@", "@", "-", "609", ",", "8", "+", "537", ",", "8", "@", "@", "public", "Object", "invoke", "(", "final", "String", "resourceName", ",", "final", "String", "operationName", ",", "fina", "}", "try", "{", "return", "IOUtils", ".", "deserializeObject", "(", "post", "(", "link", ",", "MediaType", ".", "MULTIPART_FORM_DATA", ",", "content", ",", "byte", "[", "].", "class", ")", ");", "byte", "[", "]", "postResult", "=", "post", "(", "link", ",", "MediaType", ".", "MULTIPART_FORM_DATA", ",", "content", ",", "byte", "[", "].", "class", ")", ";", "return", "IOUtils", ".", "deserializeObject", "(", "postResult", ")", ";", "}", "catch", "(", "IOException", "e", ")", "{", "throw", "new", "MBeanAccessException", "(", "String", ".", "format", "(", "\"", "De", "-", "serializing", "the", "result", "from", "invoking", "operation", "(", "%", "1", "$", "s", ")", "on", "MBean", "(", "%", "2", "$", "s", ")", "failed", "!", "\",", "@", "@", "-", "678", ",", "7", "+", "606", ",", "7", "@", "@", "public", "String", "toString", "(", ")", "{", "public", "Object", "processCommand", "(", "final", "CommandRequest", "command", ")", "{", "URI", "link", "=", "command", ".", "getHttpRequestUrl", "(", "baseUrl", ")", ";", "if", "(", "command", ".", "hasFileData", "(", "))", "{", "MultiValueMap", "<", "String", ",", "Object", ">", "content", "=", "new", "LinkedMultiValueMap", "<", "String", ",", "Object", ">", "()", ";", "MultiValueMap", "<", "String", ",", "Object", ">", "content", "=", "new", "LinkedMultiValueMap", "<", ">(", ");", "Resource", "[", "]", "resources", "=", "ConvertUtils", ".", "convert", "(", "command", ".", "getFileData", "(", "))", ";", "for", "(", "Resource", "resource", ":", "resources", ")", "{", "@", "@", "-", "0", ",", "0", "+", "1", ",", "58", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "*", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "*", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "*", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "*", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "*", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "*", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "web", ".", "shell", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "org", ".", "apache", ".", "commons", ".", "io", ".", "IOUtils", ";", "import", "org", ".", "springframework", ".", "http", ".", "client", ".", "ClientHttpResponse", ";", "import", "org", ".", "springframework", ".", "web", ".", "client", ".", "DefaultResponseErrorHandler", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "cli", ".", "shell", ".", "Gfsh", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "AuthenticationFailedException", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "NotAuthorizedException", ";", "public", "class", "RestOperationErrorHandler", "extends", "DefaultResponseErrorHandler", "{", "private", "final", "Gfsh", "gfsh", ";", "RestOperationErrorHandler", "(", "Gfsh", "gfsh", ")", "{", "this", ".", "gfsh", "=", "gfsh", ";", "}", "public", "RestOperationErrorHandler", "(", ")", "{", "this", "(", "null", ")", ";", "}", "@", "Override", "public", "void", "handleError", "(", "final", "ClientHttpResponse", "response", ")", "throws", "IOException", "{", "String", "body", "=", "IOUtils", ".", "toString", "(", "response", ".", "getBody", "(", "),", "StandardCharsets", ".", "UTF_8", ")", ";", "final", "String", "message", "=", "String", ".", "format", "(", "\"", "The", "HTTP", "request", "failed", "with", ":", "%", "1", "$", "d", "-", "%", "2", "$", "s", "\"", ",", "response", ".", "getRawStatusCode", "(", "),", "body", ")", ";", "if", "(", "gfsh", "!", "=", "null", "&", "&", "gfsh", ".", "getDebug", "(", "))", "{", "gfsh", ".", "logSevere", "(", "body", ",", "null", ")", ";", "}", "if", "(", "response", ".", "getRawStatusCode", "(", ")", "=", "=", "401", ")", "{", "throw", "new", "AuthenticationFailedException", "(", "message", ")", ";", "}", "else", "if", "(", "response", ".", "getRawStatusCode", "(", ")", "=", "=", "403", ")", "{", "throw", "new", "NotAuthorizedException", "(", "message", ")", ";", "}", "else", "{", "throw", "new", "RuntimeException", "(", "message", ")", ";", "}", "}", "}", "@", "@", "-", "14", ",", "9", "+", "14", ",", "13", "@", "@", "*", "/", "package", "org", ".", "apache", ".", "geode", ".", "test", ".", "junit", ".", "rules", ".", "gfsh", ";", "import", "static", "java", ".", "util", ".", "stream", ".", "Collectors", ".", "joining", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang", ".", "SystemUtils", ";", "public", "class", "GfshExecution", "{", "private", "final", "Process", "process", ";", "private", "final", "File", "workingDir", ";", "@", "@", "-", "36", ",", "6", "+", "40", ",", "10", "@", "@", "protected", "GfshExecution", "(", "Process", "process", ",", "File", "workingDir", ")", "{", "return", "processLogger", ".", "getStdErrLines", "(", ");", "}", "public", "String", "getStdErrText", "(", ")", "{", "return", "getStdErrLines", "(", ").", "stream", "(", ").", "collect", "(", "joining", "(", "SystemUtils", ".", "LINE_SEPARATOR", ")", ");", "}", "/", "**", "*", "Note", "that", "this", "is", "the", "working", "directory", "of", "gfsh", "itself", ".", "If", "your", "script", "started", "a", "server", "or", "*", "locator", ",", "this", "will", "be", "the", "parent", "directory", "of", "that", "member", "'", "s", "working", "directory", ".", "@", "@", "-", "89", ",", "7", "+", "89", ",", "8", "@", "@", "public", "GfshExecution", "execute", "(", "String", ".", "..", "commands", ")", "{", "public", "GfshExecution", "execute", "(", "GfshScript", "gfshScript", ")", "{", "GfshExecution", "gfshExecution", ";", "try", "{", "File", "workingDir", "=", "temporaryFolder", ".", "newFolder", "(", "gfshScript", ".", "getName", "(", "))", ";", "File", "workingDir", "=", "new", "File", "(", "temporaryFolder", ".", "getRoot", "(", "),", "gfshScript", ".", "getName", "(", "))", ";", "workingDir", ".", "mkdirs", "(", ");", "Process", "process", "=", "toProcessBuilder", "(", "gfshScript", ",", "gfsh", ",", "workingDir", ")", ".", "start", "(", ");", "gfshExecution", "=", "new", "GfshExecution", "(", "process", ",", "workingDir", ")", ";", "gfshExecutions", ".", "add", "(", "gfshExecution", ")", ";", "@", "@", "-", "55", ",", "7", "+", "55", ",", "7", "@", "@", "private", "static", "CommandRequest", "request", ";", "@", "Test", "public", "void", "performBeanOperationsNoAuthorizationCheck", "(", ")", "throws", "Exception", "{", "public", "void", "performBeanOperationsHasAuthorizationCheck", "(", ")", "throws", "Exception", "{", "gfsh", ".", "secureConnectAndVerify", "(", "locator", ".", "getHttpPort", "(", "),", "GfshShellConnectionRule", ".", "PortType", ".", "http", ",", "\"", "test", "\"", ",", "\"", "test", "\"", ");", "invoker", "=", "(", "HttpOperationInvoker", ")", "gfsh", ".", "getGfsh", "(", ").", "getOperationInvoker", "(", ");", "@", "@", "-", "70", ",", "11", "+", "70", ",", "11", "@", "@", "public", "void", "performBeanOperationsNoAuthorizationCheck", "(", ")", "throws", "Exception", "{", "DistributedSystemMXBean", "bean", "=", "invoker", ".", "getDistributedSystemMXBean", "(", ");", "assertThat", "(", "bean", ")", ".", "isInstanceOf", "(", "DistributedSystemMXBean", ".", "class", ")", ";", "String", "[", "]", "gatewayReceivers", "=", "(", "String", "[", "])", "invoker", ".", "invoke", "(", "ManagementConstants", ".", "OBJECTNAME__DISTRIBUTEDSYSTEM_MXBEAN", ",", "\"", "listGatewayReceivers", "\"", ",", "new", "Object", "[", "0", "]", ",", "new", "String", "[", "0", "]", ");", "assertThatThrownBy", "(", "(", ")", "-", ">", "invoker", ".", "invoke", "(", "ManagementConstants", ".", "OBJECTNAME__DISTRIBUTEDSYSTEM_MXBEAN", ",", "\"", "listGatewayReceivers", "\"", ",", "new", "Object", "[", "0", "]", ",", "new", "String", "[", "0", "]", "))", ".", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "assertThat", "(", "gatewayReceivers", ")", ".", "isEmpty", "(", ");", "ObjectName", "objectName", "=", "ObjectName", ".", "getInstance", "(", "\"", "GemFire", ":", "type", "=", "Member", ",", "*\"", ");", "QueryExp", "query", "=", "Query", ".", "eq", "(", "Query", ".", "attr", "(", "\"", "Name", "\"", "),", "Query", ".", "value", "(", "\"", "mock", "\"", "))", ";", "@", "@", "-", "94", ",", "7", "+", "94", ",", "6", "@", "@", "public", "void", "processCommandHasAuthorizationCheck", "(", ")", "throws", "Exception", "{", "when", "(", "request", ".", "getHttpRequestUrl", "(", "anyString", "(", "))", ").", "thenCallRealMethod", "(", ");", "when", "(", "request", ".", "getUserInput", "(", "))", ".", "thenReturn", "(", "\"", "list", "members", "\"", ");", "assertThatThrownBy", "(", "()", "-", ">", "invoker", ".", "processCommand", "(", "request", ")", ")", ".", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "gfsh", ".", "disconnect", "(", ");"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["(Update:CHANGELOG):", "\u63d2\u4ef6\u66f4\u65b0\u8bf4\u660e"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Mention", "ReturnTypeWillChange", "attribute", "in", "the", "error", "message", "(#7183)"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Confirm", "size", "of", "decrypted", "PMS", "before", "using"], "code_tokens": ["@", "@", "-", "97", ",", "7", "+", "97", ",", "11", "@", "@", "protected", "TlsSecret", "safeDecryptPreMasterSecret", "(", "TlsCryptoParameters", "cryptoParams", ",", "{", "Cipher", "c", "=", "crypto", ".", "createRSAEncryptionCipher", "(", ");", "c", ".", "init", "(", "Cipher", ".", "DECRYPT_MODE", ",", "rsaServerPrivateKey", ")", ";", "M", "=", "c", ".", "doFinal", "(", "encryptedPreMasterSecret", ")", ";", "byte", "[", "]", "m", "=", "c", ".", "doFinal", "(", "encryptedPreMasterSecret", ")", ";", "if", "(", "m", "!", "=", "null", "&", "&", "m", ".", "length", "=", "=", "48", ")", "{", "M", "=", "m", ";", "}", "}", "catch", "(", "Exception", "e", ")", "{"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Remove", "custom", "plugin_lang_get_defaulted()", "Function", "was", "introduced", "in", "#215", "to", "fix", "the", "problem", "in", "the", "plugin,", "until", "the", "update", "was", "implemented", "in", "MantisBT", "core", "(which", "happened", "in", "2.24.0).", "Fixes", "#339"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["4.2.2"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["0.4.1"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Disable", "message", "interpolation", "in", "ConstraintViolations", "by", "default", "(#3208)", "Disable", "message", "interpolation", "in", "ConstraintViolations", "by", "default", "but", "allow", "enabling", "it", "explicitly", "with", "`SelfValidating#escapeExpressions()`.", "Additionally,", "`ConstraintViolations`", "now", "provides", "a", "set", "of", "methods", "which", "take", "a", "map", "of", "message", "parameters", "for", "interpolation.", "The", "message", "parameters", "will", "be", "escaped", "by", "default.", "Refs", "#3153", "Refs", "#3157"], "code_tokens": ["@", "@", "-", "0", ",", "0", "+", "1", ",", "38", "@", "@", "/", "*", "*", "Hibernate", "Validator", ",", "declare", "and", "validate", "application", "constraints", "*", "*", "License", ":", "Apache", "License", ",", "Version", "2", ".", "0", "*", "See", "the", "license", ".", "txt", "file", "in", "the", "root", "directory", "or", "<", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", ">", ".", "*", "/", "package", "io", ".", "dropwizard", ".", "validation", ";", "import", "javax", ".", "annotation", ".", "Nullable", ";", "import", "java", ".", "util", ".", "regex", ".", "Matcher", ";", "import", "java", ".", "util", ".", "regex", ".", "Pattern", ";", "/", "**", "*", "Utilities", "used", "for", "message", "interpolation", ".", "*", "*", "@", "author", "Guillaume", "Smet", "*", "@", "since", "2", ".", "0", ".", "3", "*", "/", "public", "final", "class", "InterpolationHelper", "{", "public", "static", "final", "char", "BEGIN_TERM", "=", "'", "{'", ";", "public", "static", "final", "char", "END_TERM", "=", "'", "}'", ";", "public", "static", "final", "char", "EL_DESIGNATOR", "=", "'", "$'", ";", "public", "static", "final", "char", "ESCAPE_CHARACTER", "=", "'", "\\\\", "';", "private", "static", "final", "Pattern", "ESCAPE_MESSAGE_PARAMETER_PATTERN", "=", "Pattern", ".", "compile", "(", "\"(", "[\\", "\\\"", "+", "ESCAPE_CHARACTER", "+", "BEGIN_TERM", "+", "END_TERM", "+", "EL_DESIGNATOR", "+", "\"", "])", "\")", ";", "private", "InterpolationHelper", "(", ")", "{", "}", "@", "Nullable", "public", "static", "String", "escapeMessageParameter", "(", "@", "Nullable", "String", "messageParameter", ")", "{", "if", "(", "messageParameter", "=", "=", "null", ")", "{", "return", "null", ";", "}", "return", "ESCAPE_MESSAGE_PARAMETER_PATTERN", ".", "matcher", "(", "messageParameter", ")", ".", "replaceAll", "(", "Matcher", ".", "quoteReplacement", "(", "String", ".", "valueOf", "(", "ESCAPE_CHARACTER", ")", ")", "+", "\"", "$", "1", "\"", ");", "}", "}", "@", "@", "-", "7", ",", "6", "+", "7", ",", "7", "@", "@", "import", "java", ".", "lang", ".", "annotation", ".", "Retention", ";", "import", "java", ".", "lang", ".", "annotation", ".", "RetentionPolicy", ";", "import", "java", ".", "lang", ".", "annotation", ".", "Target", ";", "import", "java", ".", "util", ".", "Map", ";", "/", "**", "*", "The", "annotated", "element", "has", "methods", "annotated", "by", "@", "@", "-", "24", ",", "4", "+", "25", ",", "16", "@", "@", "Class", "<", "?>", "[]", "groups", "(", ")", "default", "{", "};", "Class", "<", "?", "extends", "Payload", ">", "[]", "payload", "(", ")", "default", "{", "};", "/", "**", "*", "Escape", "EL", "expressions", "to", "avoid", "template", "injection", "attacks", ".", "*", "<", "p", ">", "*", "This", "has", "serious", "security", "implications", "and", "you", "will", "*", "have", "to", "escape", "the", "violation", "messages", "added", "to", "{", "@", "link", "ViolationCollector", "}", "appropriately", ".", "*", "*", "@", "see", "ViolationCollector", "#", "addViolation", "(", "String", ",", "Map", ")", "*", "@", "see", "ViolationCollector", "#", "addViolation", "(", "String", ",", "String", ",", "Map", ")", "*", "@", "see", "ViolationCollector", "#", "addViolation", "(", "String", ",", "Integer", ",", "String", ",", "Map", ")", "*", "/", "boolean", "escapeExpressions", "(", ")", "default", "true", ";", "}", "@", "@", "-", "31", ",", "15", "+", "31", ",", "17", "@", "@", "private", "final", "AnnotationConfiguration", "annotationConfiguration", "=", "new", "AnnotationConfiguration", ".", "StdConfiguration", "(", "AnnotationInclusion", ".", "INCLUDE_AND_INHERIT_IF_INHERITED", ")", ";", "private", "final", "TypeResolver", "typeResolver", "=", "new", "TypeResolver", "(", ");", "private", "final", "MemberResolver", "memberResolver", "=", "new", "MemberResolver", "(", "typeResolver", ")", ";", "private", "boolean", "escapeExpressions", "=", "true", ";", "@", "Override", "public", "void", "initialize", "(", "SelfValidating", "constraintAnnotation", ")", "{", "escapeExpressions", "=", "constraintAnnotation", ".", "escapeExpressions", "(", ");", "}", "@", "SuppressWarnings", "(", "{\"", "unchecked", "\"", ",", "\"", "rawtypes", "\"", "})", "@", "Override", "public", "boolean", "isValid", "(", "Object", "value", ",", "ConstraintValidatorContext", "context", ")", "{", "final", "ViolationCollector", "collector", "=", "new", "ViolationCollector", "(", "context", ")", ";", "final", "ViolationCollector", "collector", "=", "new", "ViolationCollector", "(", "context", ",", "escapeExpressions", ")", ";", "context", ".", "disableDefaultConstraintViolation", "(", ");", "for", "(", "ValidationCaller", "caller", ":", "methodMap", ".", "computeIfAbsent", "(", "value", ".", "getClass", "(", "),", "this", ":", ":", "findMethods", ")", ")", "{", "caller", ".", "setValidationObject", "(", "value", ")", ";", "@", "@", "-", "1", ",", "64", "+", "1", ",", "116", "@", "@", "package", "io", ".", "dropwizard", ".", "validation", ".", "selfvalidating", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "constraintvalidation", ".", "HibernateConstraintValidatorContext", ";", "import", "javax", ".", "annotation", ".", "Nullable", ";", "import", "javax", ".", "validation", ".", "ConstraintValidatorContext", ";", "import", "java", ".", "util", ".", "regex", ".", "Matcher", ";", "import", "java", ".", "util", ".", "regex", ".", "Pattern", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "static", "io", ".", "dropwizard", ".", "validation", ".", "InterpolationHelper", ".", "escapeMessageParameter", ";", "/", "**", "*", "This", "class", "is", "a", "simple", "wrapper", "around", "the", "ConstraintValidatorContext", "of", "hibernate", "validation", ".", "*", "It", "collects", "all", "the", "violations", "of", "the", "SelfValidation", "methods", "of", "an", "object", ".", "*", "/", "public", "class", "ViolationCollector", "{", "private", "static", "final", "Pattern", "ESCAPE_PATTERN", "=", "Pattern", ".", "compile", "(", "\"\\", "\\$", "\\\\", "{\"", ");", "private", "final", "ConstraintValidatorContext", "constraintValidatorContext", ";", "private", "final", "boolean", "escapeExpressions", ";", "private", "boolean", "violationOccurred", "=", "false", ";", "private", "ConstraintValidatorContext", "context", ";", "public", "ViolationCollector", "(", "ConstraintValidatorContext", "constraintValidatorContext", ")", "{", "this", "(", "constraintValidatorContext", ",", "true", ")", ";", "}", "public", "ViolationCollector", "(", "ConstraintValidatorContext", "context", ")", "{", "this", ".", "context", "=", "context", ";", "public", "ViolationCollector", "(", "ConstraintValidatorContext", "constraintValidatorContext", ",", "boolean", "escapeExpressions", ")", "{", "this", ".", "constraintValidatorContext", "=", "constraintValidatorContext", ";", "this", ".", "escapeExpressions", "=", "escapeExpressions", ";", "}", "/", "**", "*", "Adds", "a", "new", "violation", "to", "this", "collector", ".", "This", "also", "sets", "{", "@", "code", "violationOccurred", "}", "to", "{", "@", "code", "true", "}", ".", "*", "<", "p", ">", "*", "Prefer", "the", "method", "with", "explicit", "message", "parameters", "if", "you", "want", "to", "interpolate", "the", "message", ".", "*", "*", "@", "param", "message", "the", "message", "of", "the", "violation", "(", "any", "EL", "expression", "will", "be", "escaped", "and", "not", "parsed", ")", "*", "@", "param", "message", "the", "message", "of", "the", "violation", "*", "@", "see", "#", "addViolation", "(", "String", ",", "Map", ")", "*", "/", "public", "void", "addViolation", "(", "String", "message", ")", "{", "addViolation", "(", "message", ",", "Collections", ".", "emptyMap", "(", "))", ";", "}", "/", "**", "*", "Adds", "a", "new", "violation", "to", "this", "collector", ".", "This", "also", "sets", "{", "@", "code", "violationOccurred", "}", "to", "{", "@", "code", "true", "}", ".", "*", "*", "@", "param", "message", "the", "message", "of", "the", "violation", "*", "@", "param", "messageParameters", "a", "map", "of", "message", "parameters", "which", "can", "be", "interpolated", "in", "the", "violation", "message", "*", "@", "since", "2", ".", "0", ".", "3", "*", "/", "public", "void", "addViolation", "(", "String", "message", ",", "Map", "<", "String", ",", "Object", ">", "messageParameters", ")", "{", "violationOccurred", "=", "true", ";", "String", "messageTemplate", "=", "escapeEl", "(", "message", ")", ";", "context", ".", "buildConstraintViolationWithTemplate", "(", "messageTemplate", ")", "getContextWithMessageParameters", "(", "messageParameters", ")", ".", "buildConstraintViolationWithTemplate", "(", "sanitizeTemplate", "(", "message", ")", ")", ".", "addConstraintViolation", "(", ");", "}", "/", "**", "*", "Adds", "a", "new", "violation", "to", "this", "collector", ".", "This", "also", "sets", "{", "@", "code", "violationOccurred", "}", "to", "{", "@", "code", "true", "}", ".", "*", "<", "p", ">", "*", "Prefer", "the", "method", "with", "explicit", "message", "parameters", "if", "you", "want", "to", "interpolate", "the", "message", ".", "*", "*", "@", "param", "propertyName", "the", "name", "of", "the", "property", "*", "@", "param", "message", "the", "message", "of", "the", "violation", "(", "any", "EL", "expression", "will", "be", "escaped", "and", "not", "parsed", ")", "*", "@", "param", "message", "the", "message", "of", "the", "violation", "*", "@", "see", "#", "addViolation", "(", "String", ",", "String", ",", "Map", ")", "*", "@", "since", "2", ".", "0", ".", "2", "*", "/", "public", "void", "addViolation", "(", "String", "propertyName", ",", "String", "message", ")", "{", "addViolation", "(", "propertyName", ",", "message", ",", "Collections", ".", "emptyMap", "(", "))", ";", "}", "/", "**", "*", "Adds", "a", "new", "violation", "to", "this", "collector", ".", "This", "also", "sets", "{", "@", "code", "violationOccurred", "}", "to", "{", "@", "code", "true", "}", ".", "*", "*", "@", "param", "propertyName", "the", "name", "of", "the", "property", "*", "@", "param", "message", "the", "message", "of", "the", "violation", "*", "@", "param", "messageParameters", "a", "map", "of", "message", "parameters", "which", "can", "be", "interpolated", "in", "the", "violation", "message", "*", "@", "since", "2", ".", "0", ".", "3", "*", "/", "public", "void", "addViolation", "(", "String", "propertyName", ",", "String", "message", ",", "Map", "<", "String", ",", "Object", ">", "messageParameters", ")", "{", "violationOccurred", "=", "true", ";", "String", "messageTemplate", "=", "escapeEl", "(", "message", ")", ";", "context", ".", "buildConstraintViolationWithTemplate", "(", "messageTemplate", ")", "getContextWithMessageParameters", "(", "messageParameters", ")", ".", "buildConstraintViolationWithTemplate", "(", "sanitizeTemplate", "(", "message", ")", ")", ".", "addPropertyNode", "(", "propertyName", ")", ".", "addConstraintViolation", "(", ");", "}", "/", "**", "*", "Adds", "a", "new", "violation", "to", "this", "collector", ".", "This", "also", "sets", "{", "@", "code", "violationOccurred", "}", "to", "{", "@", "code", "true", "}", ".", "*", "Prefer", "the", "method", "with", "explicit", "message", "parameters", "if", "you", "want", "to", "interpolate", "the", "message", ".", "*", "*", "@", "param", "propertyName", "the", "name", "of", "the", "property", "with", "the", "violation", "*", "@", "param", "index", "the", "index", "of", "the", "element", "with", "the", "violation", "*", "@", "param", "message", "the", "message", "of", "the", "violation", "(", "any", "EL", "expression", "will", "be", "escaped", "and", "not", "parsed", ")", "*", "@", "see", "ViolationCollector", "#", "addViolation", "(", "String", ",", "Integer", ",", "String", ",", "Map", ")", "*", "@", "since", "2", ".", "0", ".", "2", "*", "/", "public", "void", "addViolation", "(", "String", "propertyName", ",", "Integer", "index", ",", "String", "message", ")", "{", "addViolation", "(", "propertyName", ",", "index", ",", "message", ",", "Collections", ".", "emptyMap", "(", "))", ";", "}", "/", "**", "*", "Adds", "a", "new", "violation", "to", "this", "collector", ".", "This", "also", "sets", "{", "@", "code", "violationOccurred", "}", "to", "{", "@", "code", "true", "}", ".", "*", "*", "@", "param", "propertyName", "the", "name", "of", "the", "property", "with", "the", "violation", "*", "@", "param", "index", "the", "index", "of", "the", "element", "with", "the", "violation", "*", "@", "param", "message", "the", "message", "of", "the", "violation", "*", "@", "param", "messageParameters", "a", "map", "of", "message", "parameters", "which", "can", "be", "interpolated", "in", "the", "violation", "message", "*", "@", "since", "2", ".", "0", ".", "3", "*", "/", "public", "void", "addViolation", "(", "String", "propertyName", ",", "Integer", "index", ",", "String", "message", ",", "Map", "<", "String", ",", "Object", ">", "messageParameters", ")", "{", "violationOccurred", "=", "true", ";", "String", "messageTemplate", "=", "escapeEl", "(", "message", ")", ";", "context", ".", "buildConstraintViolationWithTemplate", "(", "messageTemplate", ")", "getContextWithMessageParameters", "(", "messageParameters", ")", ".", "buildConstraintViolationWithTemplate", "(", "sanitizeTemplate", "(", "message", ")", ")", ".", "addPropertyNode", "(", "propertyName", ")", ".", "addBeanNode", "(", ").", "inIterable", "(", ").", "atIndex", "(", "index", ")", ".", "addConstraintViolation", "(", ");", "@", "@", "-", "69", ",", "32", "+", "121", ",", "46", "@", "@", "public", "void", "addViolation", "(", "String", "propertyName", ",", "Integer", "index", ",", "String", "message", ")", "{", "*", "*", "@", "param", "propertyName", "the", "name", "of", "the", "property", "with", "the", "violation", "*", "@", "param", "key", "the", "key", "of", "the", "element", "with", "the", "violation", "*", "@", "param", "message", "the", "message", "of", "the", "violation", "(", "any", "EL", "expression", "will", "be", "escaped", "and", "not", "parsed", ")", "*", "@", "param", "message", "the", "message", "of", "the", "violation", "*", "@", "since", "2", ".", "0", ".", "2", "*", "/", "public", "void", "addViolation", "(", "String", "propertyName", ",", "String", "key", ",", "String", "message", ")", "{", "addViolation", "(", "propertyName", ",", "key", ",", "message", ",", "Collections", ".", "emptyMap", "(", "))", ";", "}", "/", "**", "*", "Adds", "a", "new", "violation", "to", "this", "collector", ".", "This", "also", "sets", "{", "@", "code", "violationOccurred", "}", "to", "{", "@", "code", "true", "}", ".", "*", "*", "@", "param", "propertyName", "the", "name", "of", "the", "property", "with", "the", "violation", "*", "@", "param", "key", "the", "key", "of", "the", "element", "with", "the", "violation", "*", "@", "param", "message", "the", "message", "of", "the", "violation", "*", "@", "param", "messageParameters", "a", "map", "of", "message", "parameters", "which", "can", "be", "interpolated", "in", "the", "violation", "message", "*", "@", "since", "2", ".", "0", ".", "3", "*", "/", "public", "void", "addViolation", "(", "String", "propertyName", ",", "String", "key", ",", "String", "message", ",", "Map", "<", "String", ",", "Object", ">", "messageParameters", ")", "{", "violationOccurred", "=", "true", ";", "String", "messageTemplate", "=", "escapeEl", "(", "message", ")", ";", "final", "String", "messageTemplate", "=", "sanitizeTemplate", "(", "message", ")", ";", "final", "HibernateConstraintValidatorContext", "context", "=", "getContextWithMessageParameters", "(", "messageParameters", ")", ";", "context", ".", "buildConstraintViolationWithTemplate", "(", "messageTemplate", ")", ".", "addPropertyNode", "(", "propertyName", ")", ".", "addBeanNode", "(", ").", "inIterable", "(", ").", "atKey", "(", "key", ")", ".", "addConstraintViolation", "(", ");", "}", "@", "Nullable", "private", "String", "escapeEl", "(", "@", "Nullable", "String", "s", ")", "{", "if", "(", "s", "=", "=", "null", "|", "|", "s", ".", "isEmpty", "(", "))", "{", "return", "s", ";", "}", "final", "Matcher", "m", "=", "ESCAPE_PATTERN", ".", "matcher", "(", "s", ")", ";", "final", "StringBuffer", "sb", "=", "new", "StringBuffer", "(", "s", ".", "length", "(", ")", "+", "16", ")", ";", "while", "(", "m", ".", "find", "(", "))", "{", "m", ".", "appendReplacement", "(", "sb", ",", "\"", "\\\\", "\\\\", "\\\\", "${", "\")", ";", "private", "HibernateConstraintValidatorContext", "getContextWithMessageParameters", "(", "Map", "<", "String", ",", "Object", ">", "messageParameters", ")", "{", "final", "HibernateConstraintValidatorContext", "context", "=", "constraintValidatorContext", ".", "unwrap", "(", "HibernateConstraintValidatorContext", ".", "class", ")", ";", "for", "(", "Map", ".", "Entry", "<", "String", ",", "Object", ">", "messageParameter", ":", "messageParameters", ".", "entrySet", "(", "))", "{", "final", "Object", "value", "=", "messageParameter", ".", "getValue", "(", ");", "final", "String", "escapedValue", "=", "value", "=", "=", "null", "?", "null", ":", "escapeMessageParameter", "(", "value", ".", "toString", "(", "))", ";", "context", ".", "addMessageParameter", "(", "messageParameter", ".", "getKey", "(", "),", "escapedValue", ")", ";", "}", "m", ".", "appendTail", "(", "sb", ")", ";", "return", "context", ";", "}", "return", "sb", ".", "toString", "(", ");", "@", "Nullable", "private", "String", "sanitizeTemplate", "(", "@", "Nullable", "String", "message", ")", "{", "return", "escapeExpressions", "?", "escapeMessageParameter", "(", "message", ")", ":", "message", ";", "}", "/", "**", "@", "@", "-", "104", ",", "7", "+", "170", ",", "7", "@", "@", "private", "String", "escapeEl", "(", "@", "Nullable", "String", "s", ")", "{", "*", "@", "return", "the", "wrapped", "Hibernate", "ConstraintValidatorContext", "*", "/", "public", "ConstraintValidatorContext", "getContext", "(", ")", "{", "return", "context", ";", "return", "constraintValidatorContext", ";", "}", "/", "**", "@", "@", "-", "1", ",", "5", "+", "1", ",", "6", "@", "@", "package", "io", ".", "dropwizard", ".", "validation", ";", "import", "io", ".", "dropwizard", ".", "util", ".", "Maps", ";", "import", "io", ".", "dropwizard", ".", "validation", ".", "selfvalidating", ".", "SelfValidating", ";", "import", "io", ".", "dropwizard", ".", "validation", ".", "selfvalidating", ".", "SelfValidation", ";", "import", "io", ".", "dropwizard", ".", "validation", ".", "selfvalidating", ".", "ViolationCollector", ";", "@", "@", "-", "12", ",", "6", "+", "13", ",", "7", "@", "@", "import", "javax", ".", "annotation", ".", "concurrent", ".", "NotThreadSafe", ";", "import", "javax", ".", "validation", ".", "Validator", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "static", "org", ".", "assertj", ".", "core", ".", "api", ".", "Assertions", ".", "assertThat", ";", "@", "@", "-", "146", ",", "12", "+", "148", ",", "48", "@", "@", "public", "void", "validateCorrect", "(", "ViolationCollector", "col", ")", "{", "@", "SelfValidation", "public", "void", "validateFail", "(", "ViolationCollector", "col", ")", "{", "col", ".", "addViolation", "(", "\"$", "{'", "value", "'", "}\"", ");", "col", ".", "addViolation", "(", "\"$", "\\\\", "A", "{", "1", "+", "1", "}", "\")", ";", "col", ".", "addViolation", "(", "\"{", "value", "}", "\",", "Collections", ".", "singletonMap", "(", "\"", "value", "\"", ",", "\"", "TEST", "\"", "))", ";", "col", ".", "addViolation", "(", "\"$", "{'", "property", "'", "}\"", ",", "\"", "${", "'", "value", "'", "}\"", ");", "col", ".", "addViolation", "(", "\"$", "{'", "property", "'", "}\"", ",", "1", ",", "\"", "${", "'", "value", "'", "}\"", ");", "col", ".", "addViolation", "(", "\"$", "{'", "property", "'", "}\"", ",", "\"", "${", "'", "key", "'", "}\"", ",", "\"", "${", "'", "value", "'", "}\"", ");", "}", "}", "@", "SelfValidating", "(", "escapeExpressions", "=", "false", ")", "public", "static", "class", "EscapingDisabledExample", "{", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "@", "SelfValidation", "public", "void", "validateFail", "(", "ViolationCollector", "col", ")", "{", "col", ".", "addViolation", "(", "\"$", "{'", "value", "'", "}\"", ");", "col", ".", "addViolation", "(", "\"$", "\\\\", "A", "{", "1", "+", "1", "}", "\")", ";", "col", ".", "addViolation", "(", "\"{", "value", "}", "\",", "Collections", ".", "singletonMap", "(", "\"", "value", "\"", ",", "\"", "TEST", "\"", "))", ";", "col", ".", "addViolation", "(", "\"$", "{'", "property", "'", "}\"", ",", "\"", "${", "'", "value", "'", "}\"", ");", "col", ".", "addViolation", "(", "\"$", "{'", "property", "'", "}\"", ",", "1", ",", "\"", "${", "'", "value", "'", "}\"", ");", "col", ".", "addViolation", "(", "\"$", "{'", "property", "'", "}\"", ",", "\"", "${", "'", "key", "'", "}\"", ",", "\"", "${", "'", "value", "'", "}\"", ");", "}", "}", "@", "SelfValidating", "(", "escapeExpressions", "=", "false", ")", "public", "static", "class", "MessageParametersExample", "{", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "@", "SelfValidation", "public", "void", "validateFail", "(", "ViolationCollector", "col", ")", "{", "col", ".", "addViolation", "(", "\"{", "1", "+", "1", "}", "\")", ";", "col", ".", "addViolation", "(", "\"{", "value", "}", "\",", "Collections", ".", "singletonMap", "(", "\"", "value", "\"", ",", "\"", "VALUE", "\"", "))", ";", "col", ".", "addViolation", "(", "\"", "No", "parameter", "\"", ",", "Collections", ".", "singletonMap", "(", "\"", "value", "\"", ",", "\"", "VALUE", "\"", "))", ";", "col", ".", "addViolation", "(", "\"{", "value", "}", "{", "unsetParameter", "}", "\",", "Collections", ".", "singletonMap", "(", "\"", "value", "\"", ",", "\"", "VALUE", "\"", "))", ";", "col", ".", "addViolation", "(", "\"{", "value", "\"", ",", "Collections", ".", "singletonMap", "(", "\"", "value", "\"", ",", "\"", "VALUE", "\"", "))", ";", "col", ".", "addViolation", "(", "\"", "value", "}", "\",", "Collections", ".", "singletonMap", "(", "\"", "value", "\"", ",", "\"", "VALUE", "\"", "))", ";", "col", ".", "addViolation", "(", "\"{", "value", "}", "\",", "Collections", ".", "singletonMap", "(", "\"", "value", "\"", ",", "\"", "VALUE", "\"", "))", ";", "col", ".", "addViolation", "(", "\"", "Mixed", "$", "{'", "value", "'", "}", "{", "value", "}", "\",", "Collections", ".", "singletonMap", "(", "\"", "value", "\"", ",", "\"", "VALUE", "\"", "))", ";", "col", ".", "addViolation", "(", "\"", "Nested", "{", "value", "}", "\",", "Collections", ".", "singletonMap", "(", "\"", "value", "\"", ",", "\"", "${", "'", "nested", "'", "}\"", "))", ";", "col", ".", "addViolation", "(", "\"{", "property", "}", "\",", "\"", "{", "value", "}", "\",", "Maps", ".", "of", "(", "\"", "property", "\"", ",", "\"", "PROPERTY", "\"", ",", "\"", "value", "\"", ",", "\"", "VALUE", "\"", "))", ";", "col", ".", "addViolation", "(", "\"{", "property", "}", "\",", "1", ",", "\"", "{", "value", "}", "\",", "Maps", ".", "of", "(", "\"", "property", "\"", ",", "\"", "PROPERTY", "\"", ",", "\"", "value", "\"", ",", "\"", "VALUE", "\"", "))", ";", "col", ".", "addViolation", "(", "\"{", "property", "}", "\",", "\"", "{", "key", "}", "\",", "\"", "{", "value", "}", "\",", "Maps", ".", "of", "(", "\"", "property", "\"", ",", "\"", "PROPERTY", "\"", ",", "\"", "key", "\"", ",", "\"", "KEY", "\"", ",", "\"", "value", "\"", ",", "\"", "VALUE", "\"", "))", ";", "}", "}", "private", "final", "Validator", "validator", "=", "BaseValidator", ".", "newValidator", "(", ");", "@", "Test", "@", "@", "-", "271", ",", "13", "+", "309", ",", "47", "@", "@", "public", "void", "giveWarningIfNoValidationMethods", "(", ")", "{", "}", "@", "Test", "public", "void", "violationMessagesAreEscaped", "(", ")", "{", "public", "void", "violationMessagesAreEscapedByDefault", "(", ")", "{", "assertThat", "(", "ConstraintViolations", ".", "format", "(", "validator", ".", "validate", "(", "new", "InjectionExample", "(", "))", "))", ".", "containsExactly", "(", "\"", "$", "\\\\", "A", "{", "1", "+", "1", "}", "\",", "\"", "$", "{'", "value", "'", "}\"", ",", "\"", "{", "value", "}", "\",", "\"", "${", "'", "property", "'", "}", "$", "{'", "value", "'", "}\"", ",", "\"", "${", "'", "property", "'", "}[", "${", "'", "key", "'", "}]", "$", "{'", "value", "'", "}\"", ",", "\"", "${", "'", "property", "'", "}[", "1", "]", "$", "{'", "value", "'", "}\"", ")", ";", "assertThat", "(", "TestLoggerFactory", ".", "getAllLoggingEvents", "(", "))", ".", "isEmpty", "(", ");", "}", "@", "Test", "public", "void", "violationMessagesAreInterpolatedIfEscapingDisabled", "(", ")", "{", "assertThat", "(", "ConstraintViolations", ".", "format", "(", "validator", ".", "validate", "(", "new", "EscapingDisabledExample", "(", "))", "))", ".", "containsExactly", "(", "\"", "A2", "\"", ",", "\"", "TEST", "\"", ",", "\"", "value", "\"", ",", "\"", "${", "'", "property", "'", "}", "value", "\"", ",", "\"", "${", "'", "property", "'", "}[", "${", "'", "key", "'", "}]", "value", "\"", ",", "\"", "${", "'", "property", "'", "}[", "1", "]", "value", "\"", ")", ";", "assertThat", "(", "TestLoggerFactory", ".", "getAllLoggingEvents", "(", "))", ".", "isEmpty", "(", ");", "}", "@", "Test", "public", "void", "messageParametersExample", "(", ")", "{", "assertThat", "(", "ConstraintViolations", ".", "format", "(", "validator", ".", "validate", "(", "new", "MessageParametersExample", "(", "))", "))", ".", "containsExactly", "(", "\"", "Mixed", "value", "VALUE", "\"", ",", "\"", "Nested", "$", "{'", "nested", "'", "}\"", ",", "\"", "No", "parameter", "\"", ",", "\"", "VALUE", "\"", ",", "\"", "VALUE", "{", "unsetParameter", "}", "\",", "\"", "value", "}", "\",", "\"", "{", "value", "}", "\",", "\"", "{", "1", "+", "1", "}", "\",", "\"", "{", "value", "\"", ",", "\"", "{", "property", "}", "VALUE", "\"", ",", "\"", "{", "property", "}", "[", "1", "]", "VALUE", "\"", ",", "\"", "{", "property", "}", "[{", "key", "}", "]", "VALUE", "\"", ")", ";", "assertThat", "(", "TestLoggerFactory", ".", "getAllLoggingEvents", "(", "))", ".", "isEmpty", "(", ");", "}", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["[SECURITY-916]"], "code_tokens": ["@", "@", "-", "19", ",", "6", "+", "19", ",", "7", "@", "@", "import", "edu", ".", "umd", ".", "cs", ".", "findbugs", ".", "annotations", ".", "NonNull", ";", "import", "hudson", ".", "Extension", ";", "import", "hudson", ".", "Util", ";", "import", "hudson", ".", "security", ".", "GroupDetails", ";", "import", "hudson", ".", "security", ".", "UserMayOrMayNotExistException", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "@", "@", "-", "44", ",", "6", "+", "45", ",", "7", "@", "@", "import", "org", ".", "pac4j", ".", "saml", ".", "profile", ".", "SAML2Profile", ";", "import", "javax", ".", "annotation", ".", "Nonnull", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpSession", ";", "import", "java", ".", "io", ".", "*;", "import", "java", ".", "net", ".", "MalformedURLException", ";", "import", "java", ".", "net", ".", "URL", ";", "@", "@", "-", "240", ",", "9", "+", "242", ",", "12", "@", "@", "public", "String", "getLoginUrl", "(", ")", "{", "*", "@", "param", "referer", "referer", ".", "*", "@", "return", "the", "http", "response", ".", "*", "/", "public", "HttpResponse", "doCommenceLogin", "(", "final", "StaplerRequest", "request", ",", "final", "StaplerResponse", "response", ",", "@", "Header", "(", "\"", "Referer", "\"", ")", "final", "String", "referer", ")", "{", "public", "HttpResponse", "doCommenceLogin", "(", "final", "StaplerRequest", "request", ",", "final", "StaplerResponse", "response", ",", "@", "QueryParameter", "String", "from", ",", "@", "Header", "(", "\"", "Referer", "\"", ")", "final", "String", "referer", ")", "{", "LOG", ".", "fine", "(", "\"", "SamlSecurityRealm", ".", "doCommenceLogin", "called", ".", "Using", "consumerServiceUrl", "\"", "+", "getSamlPluginConfig", "(", ").", "getConsumerServiceUrl", "(", "))", ";", "request", ".", "getSession", "(", ").", "setAttribute", "(", "REFERER_ATTRIBUTE", ",", "referer", ")", ";", "String", "redirectOnFinish", "=", "calculateSafeRedirect", "(", "from", ",", "referer", ")", ";", "request", ".", "getSession", "(", ").", "setAttribute", "(", "REFERER_ATTRIBUTE", ",", "redirectOnFinish", ")", ";", "RedirectAction", "action", "=", "new", "SamlRedirectActionWrapper", "(", "getSamlPluginConfig", "(", "),", "request", ",", "response", ")", ".", "get", "(", ");", "if", "(", "action", ".", "getType", "(", ")", "=", "=", "RedirectType", ".", "REDIRECT", ")", "{", "@", "@", "-", "256", ",", "6", "+", "261", ",", "28", "@", "@", "public", "HttpResponse", "doCommenceLogin", "(", "final", "StaplerRequest", "request", ",", "final", "StaplerR", "}", "}", "/", "**", "*", "Check", "parameters", "\"", "from", "\"", "and", "\"", "referer", "\"", "to", "decide", "where", "is", "the", "safe", "URL", "to", "be", "redirected", ".", "*", "@", "param", "from", "http", "request", "\"", "from", "\"", "parameter", ".", "*", "@", "param", "referer", "referer", "header", ".", "*", "@", "return", "a", "safe", "URL", "to", "be", "redirected", ".", "*", "/", "private", "String", "calculateSafeRedirect", "(", "String", "from", ",", "String", "referer", ")", "{", "String", "redirectURL", ";", "String", "rootUrl", "=", "Jenkins", ".", "getInstance", "(", ").", "getRootUrl", "(", ");", "if", "(", "from", "!", "=", "null", "&", "&", "Util", ".", "isSafeToRedirectTo", "(", "from", ")", ")", "{", "redirectURL", "=", "from", ";", "}", "else", "{", "if", "(", "referer", "!", "=", "null", "&", "&", "(", "referer", ".", "startsWith", "(", "rootUrl", ")", "|", "|", "Util", ".", "isSafeToRedirectTo", "(", "referer", ")", "))", "{", "redirectURL", "=", "referer", ";", "}", "else", "{", "redirectURL", "=", "rootUrl", ";", "}", "}", "LOG", ".", "fine", "(", "\"", "Safe", "URL", "redirection", ":", "\"", "+", "redirectURL", ")", ";", "return", "redirectURL", ";", "}", "/", "**", "*", "/", "securityRealm", "/", "finishLogin", "*", "@", "@", "-", "266", ",", "7", "+", "293", ",", "12", "@", "@", "public", "HttpResponse", "doCommenceLogin", "(", "final", "StaplerRequest", "request", ",", "final", "StaplerR", "@", "RequirePOST", "public", "HttpResponse", "doFinishLogin", "(", "final", "StaplerRequest", "request", ",", "final", "StaplerResponse", "response", ")", "{", "LOG", ".", "finer", "(", "\"", "SamlSecurityRealm", ".", "doFinishLogin", "called", "\"", ");", "String", "referer", "=", "(", "String", ")", "request", ".", "getSession", "(", ").", "getAttribute", "(", "REFERER_ATTRIBUTE", ")", ";", "/", "/", "redirect", "back", "to", "original", "page", "String", "redirectUrl", "=", "referer", "!", "=", "null", "?", "referer", ":", "baseUrl", "(", ");", "recreateSession", "(", "request", ")", ";", "logSamlResponse", "(", "request", ")", ";", "boolean", "saveUser", "=", "false", ";", "SAML2Profile", "saml2Profile", "=", "new", "SamlProfileWrapper", "(", "getSamlPluginConfig", "(", "),", "request", ",", "response", ")", ".", "get", "(", ");", "@", "@", "-", "312", ",", "14", "+", "344", ",", "24", "@", "@", "public", "HttpResponse", "doFinishLogin", "(", "final", "StaplerRequest", "request", ",", "final", "StaplerRes", "}", "SecurityListener", ".", "fireLoggedIn", "(", "userDetails", ".", "getUsername", "(", "))", ";", "/", "/", "redirect", "back", "to", "original", "page", "String", "referer", "=", "(", "String", ")", "request", ".", "getSession", "(", ").", "getAttribute", "(", "REFERER_ATTRIBUTE", ")", ";", "String", "redirectUrl", "=", "referer", "!", "=", "null", "?", "referer", ":", "baseUrl", "(", ");", "return", "HttpResponses", ".", "redirectTo", "(", "redirectUrl", ")", ";", "}", "/", "**", "*", "check", "if", "a", "request", "contains", "a", "session", ",", "if", "so", ",", "it", "invalidate", "the", "session", "and", "create", "new", "one", "to", "avoid", "session", "*", "fixation", ".", "*", "@", "param", "request", "request", ".", "*", "/", "private", "void", "recreateSession", "(", "StaplerRequest", "request", ")", "{", "HttpSession", "session", "=", "request", ".", "getSession", "(", "false", ")", ";", "if", "(", "session", "!", "=", "null", ")", "{", "LOG", ".", "finest", "(", "\"", "Invalidate", "previous", "session", "\"", ");", "/", "/", "avoid", "session", "fixation", "session", ".", "invalidate", "(", ");", "}", "request", ".", "getSession", "(", "true", ")", ";", "}", "private", "boolean", "modifyUserSamlCustomAttributes", "(", "User", "user", ",", "SAML2Profile", "profile", ")", "{", "boolean", "saveUser", "=", "false", ";", "if", "(", "!", "getSamlCustomAttributes", "(", ").", "isEmpty", "(", ")", "&", "&", "user", "!", "=", "null", ")", "{"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["tools:", "hv:", "Netlink", "source", "address", "validation", "allows", "DoS", "The", "source", "code", "without", "this", "patch", "caused", "hypervkvpd", "to", "exit", "when", "it", "processed", "a", "spoofed", "Netlink", "packet", "which", "has", "been", "sent", "from", "an", "untrusted", "local", "user.", "Now", "Netlink", "messages", "with", "a", "non-zero", "nl_pid", "source", "address", "are", "ignored", "and", "a", "warning", "is", "printed", "into", "the", "syslog.", "Signed-off-by:", "Tomas", "Hozza", "<thozza@redhat.com>", "Acked-by:", "K.", "Y.", "Srinivasan", "<kys@microsoft.com>", "Signed-off-by:", "Greg", "Kroah-Hartman", "<gregkh@linuxfoundation.org>"], "code_tokens": ["@", "@", "-", "1486", ",", "13", "+", "1486", ",", "19", "@", "@", "int", "main", "(", "void", ")", "len", "=", "recvfrom", "(", "fd", ",", "kvp_recv_buffer", ",", "sizeof", "(", "kvp_recv_buffer", ")", ",", "0", ",", "addr_p", ",", "&", "addr_l", ")", ";", "if", "(", "len", "<", "0", "|", "|", "addr", ".", "nl_pid", ")", "{", "if", "(", "len", "<", "0", ")", "{", "syslog", "(", "LOG_ERR", ",", "\"", "recvfrom", "failed", ";", "pid", ":", "%", "u", "error", ":", "%", "d", "%", "s", "\"", ",", "addr", ".", "nl_pid", ",", "errno", ",", "strerror", "(", "errno", ")", ");", "close", "(", "fd", ")", ";", "return", "-", "1", ";", "}", "if", "(", "addr", ".", "nl_pid", ")", "{", "syslog", "(", "LOG_WARNING", ",", "\"", "Received", "packet", "from", "untrusted", "pid", ":", "%", "u", "\"", ",", "addr", ".", "nl_pid", ")", ";", "continue", ";", "}", "incoming_msg", "=", "(", "struct", "nlmsghdr", "*", ")", "kvp_recv_buffer", ";", "incoming_cn_msg", "=", "(", "struct", "cn_msg", "*", ")", "NLMSG_DATA", "(", "incoming_msg", ")", ";", "hv_msg", "=", "(", "struct", "hv_kvp_msg", "*", ")", "incoming_cn_msg", "-", ">", "data", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Fixed", "bug", "#42862", "(IMAP", "toolkit", "crash:", "rfc822.c", "legacy", "routine", "buffer", "overflow)"], "code_tokens": ["@", "@", "-", "235", ",", "4", "+", "235", ",", "40", "@", "@", "if", "test", "\"", "$", "PHP_IMAP", "\"", "!", "=", "\"", "no", "\"", ";", "then", "AC_MSG_RESULT", "(", "no", ")", "AC_MSG_ERROR", "(", "[", "build", "test", "failed", ".", "Please", "check", "the", "config", ".", "log", "for", "details", ".", "])", "]", ",", "$", "TST_LIBS", ")", "AC_MSG_CHECKING", "(", "whether", "rfc822_output_address_list", "function", "present", ")", "PHP_TEST_BUILD", "(", "foobar", ",", "[", "AC_MSG_RESULT", "(", "yes", ")", "AC_DEFINE", "(", "HAVE_RFC822_OUTPUT_ADDRESS_LIST", ",", "1", ",", "[", "]", ")", "]", ",", "[", "AC_MSG_RESULT", "(", "no", ")", "]", ",", "[", "$", "TST_LIBS", "]", ",", "[", "#", "if", "defined", "(", "__GNUC__", ")", "&", "&", "__GNUC__", ">", "=", "4", "#", "define", "PHP_IMAP_EXPORT", "__attribute__", "(", "(", "visibility", "(", "\"", "default", "\"", "))", ")", "#", "else", "#", "define", "PHP_IMAP_EXPORT", "#", "endif", "PHP_IMAP_EXPORT", "void", "mm_log", "(", "void", ")", "{}", "PHP_IMAP_EXPORT", "void", "mm_dlog", "(", "void", ")", "{}", "PHP_IMAP_EXPORT", "void", "mm_flags", "(", "void", ")", "{}", "PHP_IMAP_EXPORT", "void", "mm_fatal", "(", "void", ")", "{}", "PHP_IMAP_EXPORT", "void", "mm_critical", "(", "void", ")", "{}", "PHP_IMAP_EXPORT", "void", "mm_nocritical", "(", "void", ")", "{}", "PHP_IMAP_EXPORT", "void", "mm_notify", "(", "void", ")", "{}", "PHP_IMAP_EXPORT", "void", "mm_login", "(", "void", ")", "{}", "PHP_IMAP_EXPORT", "void", "mm_diskerror", "(", "void", ")", "{}", "PHP_IMAP_EXPORT", "void", "mm_status", "(", "void", ")", "{}", "PHP_IMAP_EXPORT", "void", "mm_lsub", "(", "void", ")", "{}", "PHP_IMAP_EXPORT", "void", "mm_list", "(", "void", ")", "{}", "PHP_IMAP_EXPORT", "void", "mm_exists", "(", "void", ")", "{}", "PHP_IMAP_EXPORT", "void", "mm_searched", "(", "void", ")", "{}", "PHP_IMAP_EXPORT", "void", "mm_expunged", "(", "void", ")", "{}", "void", "rfc822_output_address_list", "(", "void", ")", ";", "void", "(", "*", "f", ")", "(", "void", ")", ";", "char", "foobar", "(", ")", "{", "f", "=", "rfc822_output_address_list", ";", "}", "]", ")", "fi", "@", "@", "-", "40", ",", "6", "+", "40", ",", "7", "@", "@", "#", "include", "\"", "ext", "/", "standard", "/", "php_string", ".", "h", "\"", "#", "include", "\"", "ext", "/", "standard", "/", "info", ".", "h", "\"", "#", "include", "\"", "ext", "/", "standard", "/", "file", ".", "h", "\"", "#", "include", "\"", "ext", "/", "standard", "/", "php_smart_str", ".", "h", "\"", "#", "ifdef", "ERROR", "#", "undef", "ERROR", "@", "@", "-", "72", ",", "10", "+", "73", ",", "11", "@", "@", "MAILSTREAM", "DEFAULTPROTO", ";", "#", "define", "PHP_IMAP_EXPORT", "#", "endif", "static", "void", "_php_make_header_object", "(", "zval", "*", "myzvalue", ",", "ENVELOPE", "*", "en", "TSRMLS_DC", ")", ";", "static", "void", "_php_imap_add_body", "(", "zval", "*", "arg", ",", "BODY", "*", "body", "TSRMLS_DC", ")", ";", "static", "void", "_php_imap_parse_address", "(", "ADDRESS", "*", "addresslist", ",", "char", "*", "*", "fulladdress", ",", "zval", "*", "paddress", "TSRMLS_DC", ")", ";", "static", "int", "_php_imap_address_size", "(", "ADDRESS", "*", "addresslist", ")", ";", "static", "char", "*", "_php_imap_parse_address", "(", "ADDRESS", "*", "addresslist", ",", "zval", "*", "paddress", "TSRMLS_DC", ")", ";", "static", "char", "*", "_php_rfc822_write_address", "(", "ADDRESS", "*", "addresslist", "TSRMLS_DC", ")", ";", "/", "*", "the", "gets", "we", "use", "*", "/", "static", "char", "*", "php_mail_gets", "(", "readfn_t", "f", ",", "void", "*", "stream", ",", "unsigned", "long", "size", ",", "GETS_DATA", "*", "md", ")", ";", "@", "@", "-", "2473", ",", "7", "+", "2475", ",", "7", "@", "@", "PHP_FUNCTION", "(", "imap_rfc822_write_address", ")", "char", "*", "mailbox", ",", "*", "host", ",", "*", "personal", ";", "int", "mailbox_len", ",", "host_len", ",", "personal_len", ";", "ADDRESS", "*", "addr", ";", "char", "string", "[", "MAILTMPLEN", "]", ";", "char", "*", "string", ";", "if", "(", "zend_parse_parameters", "(", "ZEND_NUM_ARGS", "(", ")", "TSRMLS_CC", ",", "\"", "sss", "\"", ",", "&", "mailbox", ",", "&", "mailbox_len", ",", "&", "host", ",", "&", "host_len", ",", "&", "personal", ",", "&", "personal_len", ")", "=", "=", "FAILURE", ")", "{", "return", ";", "@", "@", "-", "2497", ",", "13", "+", "2499", ",", "12", "@", "@", "PHP_FUNCTION", "(", "imap_rfc822_write_address", ")", "addr", "-", ">", "error", "=", "NIL", ";", "addr", "-", ">", "adl", "=", "NIL", ";", "if", "(", "_php_imap_address_size", "(", "addr", ")", ">", "=", "MAILTMPLEN", ")", "{", "string", "=", "_php_rfc822_write_address", "(", "addr", "TSRMLS_CC", ")", ";", "if", "(", "string", ")", "{", "RETVAL_STRING", "(", "string", ",", "0", ")", ";", "}", "else", "{", "RETURN_FALSE", ";", "}", "string", "[", "0", "]", "='", "\\", "0", "'", ";", "rfc822_write_address", "(", "string", ",", "addr", ")", ";", "RETVAL_STRING", "(", "string", ",", "1", ")", ";", "}", "/", "*", "}", "}}", "*", "/", "@", "@", "-", "3213", ",", "7", "+", "3214", ",", "7", "@", "@", "PHP_FUNCTION", "(", "imap_fetch_overview", ")", "int", "sequence_len", ";", "pils", "*", "imap_le_struct", ";", "zval", "*", "myoverview", ";", "char", "address", "[", "MAILTMPLEN", "]", ";", "char", "*", "address", ";", "long", "status", ",", "flags", "=", "0L", ";", "int", "argc", "=", "ZEND_NUM_ARGS", "(", ");", "@", "@", "-", "3242", ",", "17", "+", "3243", ",", "19", "@", "@", "PHP_FUNCTION", "(", "imap_fetch_overview", ")", "if", "(", "env", "-", ">", "subject", ")", "{", "add_property_string", "(", "myoverview", ",", "\"", "subject", "\"", ",", "env", "-", ">", "subject", ",", "1", ")", ";", "}", "if", "(", "env", "-", ">", "from", "&", "&", "_php_imap_address_size", "(", "env", "-", ">", "from", ")", "<", "MAILTMPLEN", ")", "{", "if", "(", "env", "-", ">", "from", ")", "{", "env", "-", ">", "from", "-", ">", "next", "=", "NULL", ";", "address", "[", "0", "]", "=", "'", "\\", "0", "'", ";", "rfc822_write_address", "(", "address", ",", "env", "-", ">", "from", ")", ";", "add_property_string", "(", "myoverview", ",", "\"", "from", "\"", ",", "address", ",", "1", ")", ";", "address", "=", "_php_rfc822_write_address", "(", "env", "-", ">", "from", "TSRMLS_CC", ")", ";", "if", "(", "address", ")", "{", "add_property_string", "(", "myoverview", ",", "\"", "from", "\"", ",", "address", ",", "0", ")", ";", "}", "}", "if", "(", "env", "-", ">", "to", "&", "&", "_php_imap_address_size", "(", "env", "-", ">", "to", ")", "<", "MAILTMPLEN", ")", "{", "if", "(", "env", "-", ">", "to", ")", "{", "env", "-", ">", "to", "-", ">", "next", "=", "NULL", ";", "address", "[", "0", "]", "=", "'", "\\", "0", "'", ";", "rfc822_write_address", "(", "address", ",", "env", "-", ">", "to", ")", ";", "add_property_string", "(", "myoverview", ",", "\"", "to", "\"", ",", "address", ",", "1", ")", ";", "address", "=", "_php_rfc822_write_address", "(", "env", "-", ">", "to", "TSRMLS_CC", ")", ";", "if", "(", "address", ")", "{", "add_property_string", "(", "myoverview", ",", "\"", "to", "\"", ",", "address", ",", "0", ")", ";", "}", "}", "if", "(", "env", "-", ">", "date", ")", "{", "add_property_string", "(", "myoverview", ",", "\"", "date", "\"", ",", "env", "-", ">", "date", ",", "1", ")", ";", "@", "@", "-", "4144", ",", "6", "+", "4147", ",", "43", "@", "@", "static", "int", "_php_rfc822_len", "(", "char", "*", "str", ")", "/", "*", "}", "}}", "*", "/", "/", "*", "Support", "Functions", "*", "/", "#", "ifdef", "HAVE_RFC822_OUTPUT_ADDRESS_LIST", "/", "*", "{", "{{", "_php_rfc822_soutr", "*", "/", "static", "long", "_php_rfc822_soutr", "(", "void", "*", "stream", ",", "char", "*", "string", ")", "{", "smart_str", "*", "ret", "=", "(", "smart_str", "*", ")", "stream", ";", "int", "len", "=", "strlen", "(", "string", ")", ";", "smart_str_appendl", "(", "ret", ",", "string", ",", "len", ")", ";", "return", "LONGT", ";", "}", "/", "*", "}", "}}", "*", "/", "/", "*", "{", "{{", "_php_rfc822_write_address", "*", "/", "static", "char", "*", "_php_rfc822_write_address", "(", "ADDRESS", "*", "addresslist", "TSRMLS_DC", ")", "{", "char", "address", "[", "MAILTMPLEN", "]", ";", "smart_str", "ret", "=", "{", "0", "}", ";", "RFC822BUFFER", "buf", ";", "buf", ".", "beg", "=", "address", ";", "buf", ".", "cur", "=", "buf", ".", "beg", ";", "buf", ".", "end", "=", "buf", ".", "beg", "+", "sizeof", "(", "address", ")", "-", "1", ";", "buf", ".", "s", "=", "&", "ret", ";", "buf", ".", "f", "=", "_php_rfc822_soutr", ";", "rfc822_output_address_list", "(", "&", "buf", ",", "addresslist", ",", "0", ",", "NULL", ")", ";", "rfc822_output_flush", "(", "&", "buf", ")", ";", "smart_str_0", "(", "&", "ret", ")", ";", "return", "ret", ".", "c", ";", "}", "/", "*", "}", "}}", "*", "/", "#", "else", "/", "*", "{", "{{", "_php_imap_get_address_size", "*", "/", "static", "int", "_php_imap_address_size", "(", "ADDRESS", "*", "addresslist", ")", "@", "@", "-", "4173", ",", "26", "+", "4213", ",", "33", "@", "@", "static", "int", "_php_imap_address_size", "(", "ADDRESS", "*", "addresslist", ")", "/", "*", "}", "}}", "*", "/", "/", "*", "{", "{{", "_php_rfc822_write_address", "*", "/", "static", "char", "*", "_php_rfc822_write_address", "(", "ADDRESS", "*", "addresslist", "TSRMLS_DC", ")", "{", "char", "address", "[", "SENDBUFLEN", "]", ";", "if", "(", "_php_imap_address_size", "(", "addresslist", ")", ">", "=", "SENDBUFLEN", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_ERROR", ",", "\"", "Address", "buffer", "overflow", "\"", ");", "return", "NULL", ";", "}", "address", "[", "0", "]", "=", "0", ";", "rfc822_write_address", "(", "address", ",", "addresslist", ")", ";", "return", "estrdup", "(", "address", ")", ";", "}", "/", "*", "}", "}}", "*", "/", "#", "endif", "/", "*", "{", "{{", "_php_imap_parse_address", "*", "/", "static", "void", "_php_imap_parse_address", "(", "ADDRESS", "*", "addresslist", ",", "char", "*", "*", "fulladdress", ",", "zval", "*", "paddress", "TSRMLS_DC", ")", "static", "char", "*", "_php_imap_parse_address", "(", "ADDRESS", "*", "addresslist", ",", "zval", "*", "paddress", "TSRMLS_DC", ")", "{", "char", "*", "fulladdress", ";", "ADDRESS", "*", "addresstmp", ";", "zval", "*", "tmpvals", ";", "char", "*", "tmpstr", ";", "int", "len", "=", "0", ";", "addresstmp", "=", "addresslist", ";", "if", "(", "(", "len", "=", "_php_imap_address_size", "(", "addresstmp", ")", "))", "{", "tmpstr", "=", "(", "char", "*", ")", "pemalloc", "(", "len", "+", "1", ",", "1", ")", ";", "tmpstr", "[", "0", "]", "=", "'", "\\", "0", "'", ";", "rfc822_write_address", "(", "tmpstr", ",", "addresstmp", ")", ";", "*", "fulladdress", "=", "tmpstr", ";", "}", "else", "{", "*", "fulladdress", "=", "NULL", ";", "}", "fulladdress", "=", "_php_rfc822_write_address", "(", "addresstmp", "TSRMLS_CC", ")", ";", "addresstmp", "=", "addresslist", ";", "do", "{", "@", "@", "-", "4204", ",", "6", "+", "4251", ",", "7", "@", "@", "static", "void", "_php_imap_parse_address", "(", "ADDRESS", "*", "addresslist", ",", "char", "*", "*", "fulladdress", ",", "z", "if", "(", "addresstmp", "-", ">", "host", ")", "add_property_string", "(", "tmpvals", ",", "\"", "host", "\"", ",", "addresstmp", "-", ">", "host", ",", "1", ")", ";", "add_next_index_object", "(", "paddress", ",", "tmpvals", "TSRMLS_CC", ")", ";", "}", "while", "(", "(", "addresstmp", "=", "addresstmp", "-", ">", "next", ")", ");", "return", "fulladdress", ";", "}", "/", "*", "}", "}}", "*", "/", "@", "@", "-", "4230", ",", "76", "+", "4278", ",", "69", "@", "@", "static", "void", "_php_make_header_object", "(", "zval", "*", "myzvalue", ",", "ENVELOPE", "*", "en", "TSRMLS_DC", ")", "if", "(", "en", "-", ">", "to", ")", "{", "MAKE_STD_ZVAL", "(", "paddress", ")", ";", "array_init", "(", "paddress", ")", ";", "_php_imap_parse_address", "(", "en", "-", ">", "to", ",", "&", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "fulladdress", "=", "_php_imap_parse_address", "(", "en", "-", ">", "to", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "{", "add_property_string", "(", "myzvalue", ",", "\"", "toaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "free", "(", "fulladdress", ")", ";", "add_property_string", "(", "myzvalue", ",", "\"", "toaddress", "\"", ",", "fulladdress", ",", "0", ")", ";", "}", "add_assoc_object", "(", "myzvalue", ",", "\"", "to", "\"", ",", "paddress", "TSRMLS_CC", ")", ";", "}", "if", "(", "en", "-", ">", "from", ")", "{", "MAKE_STD_ZVAL", "(", "paddress", ")", ";", "array_init", "(", "paddress", ")", ";", "_php_imap_parse_address", "(", "en", "-", ">", "from", ",", "&", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "fulladdress", "=", "_php_imap_parse_address", "(", "en", "-", ">", "from", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "{", "add_property_string", "(", "myzvalue", ",", "\"", "fromaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "free", "(", "fulladdress", ")", ";", "add_property_string", "(", "myzvalue", ",", "\"", "fromaddress", "\"", ",", "fulladdress", ",", "0", ")", ";", "}", "add_assoc_object", "(", "myzvalue", ",", "\"", "from", "\"", ",", "paddress", "TSRMLS_CC", ")", ";", "}", "if", "(", "en", "-", ">", "cc", ")", "{", "MAKE_STD_ZVAL", "(", "paddress", ")", ";", "array_init", "(", "paddress", ")", ";", "_php_imap_parse_address", "(", "en", "-", ">", "cc", ",", "&", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "fulladdress", "=", "_php_imap_parse_address", "(", "en", "-", ">", "cc", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "{", "add_property_string", "(", "myzvalue", ",", "\"", "ccaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "free", "(", "fulladdress", ")", ";", "add_property_string", "(", "myzvalue", ",", "\"", "ccaddress", "\"", ",", "fulladdress", ",", "0", ")", ";", "}", "add_assoc_object", "(", "myzvalue", ",", "\"", "cc", "\"", ",", "paddress", "TSRMLS_CC", ")", ";", "}", "if", "(", "en", "-", ">", "bcc", ")", "{", "MAKE_STD_ZVAL", "(", "paddress", ")", ";", "array_init", "(", "paddress", ")", ";", "_php_imap_parse_address", "(", "en", "-", ">", "bcc", ",", "&", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "fulladdress", "=", "_php_imap_parse_address", "(", "en", "-", ">", "bcc", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "{", "add_property_string", "(", "myzvalue", ",", "\"", "bccaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "free", "(", "fulladdress", ")", ";", "add_property_string", "(", "myzvalue", ",", "\"", "bccaddress", "\"", ",", "fulladdress", ",", "0", ")", ";", "}", "add_assoc_object", "(", "myzvalue", ",", "\"", "bcc", "\"", ",", "paddress", "TSRMLS_CC", ")", ";", "}", "if", "(", "en", "-", ">", "reply_to", ")", "{", "MAKE_STD_ZVAL", "(", "paddress", ")", ";", "array_init", "(", "paddress", ")", ";", "_php_imap_parse_address", "(", "en", "-", ">", "reply_to", ",", "&", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "fulladdress", "=", "_php_imap_parse_address", "(", "en", "-", ">", "reply_to", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "{", "add_property_string", "(", "myzvalue", ",", "\"", "reply_toaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "free", "(", "fulladdress", ")", ";", "add_property_string", "(", "myzvalue", ",", "\"", "reply_toaddress", "\"", ",", "fulladdress", ",", "0", ")", ";", "}", "add_assoc_object", "(", "myzvalue", ",", "\"", "reply_to", "\"", ",", "paddress", "TSRMLS_CC", ")", ";", "}", "if", "(", "en", "-", ">", "sender", ")", "{", "MAKE_STD_ZVAL", "(", "paddress", ")", ";", "array_init", "(", "paddress", ")", ";", "_php_imap_parse_address", "(", "en", "-", ">", "sender", ",", "&", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "fulladdress", "=", "_php_imap_parse_address", "(", "en", "-", ">", "sender", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "{", "add_property_string", "(", "myzvalue", ",", "\"", "senderaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "free", "(", "fulladdress", ")", ";", "add_property_string", "(", "myzvalue", ",", "\"", "senderaddress", "\"", ",", "fulladdress", ",", "0", ")", ";", "}", "add_assoc_object", "(", "myzvalue", ",", "\"", "sender", "\"", ",", "paddress", "TSRMLS_CC", ")", ";", "}", "if", "(", "en", "-", ">", "return_path", ")", "{", "MAKE_STD_ZVAL", "(", "paddress", ")", ";", "array_init", "(", "paddress", ")", ";", "_php_imap_parse_address", "(", "en", "-", ">", "return_path", ",", "&", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "fulladdress", "=", "_php_imap_parse_address", "(", "en", "-", ">", "return_path", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "{", "add_property_string", "(", "myzvalue", ",", "\"", "return_pathaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "free", "(", "fulladdress", ")", ";", "add_property_string", "(", "myzvalue", ",", "\"", "return_pathaddress", "\"", ",", "fulladdress", ",", "0", ")", ";", "}", "add_assoc_object", "(", "myzvalue", ",", "\"", "return_path", "\"", ",", "paddress", "TSRMLS_CC", ")", ";", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["ieee802154:", "atusb:", "do", "not", "use", "the", "stack", "for", "buffers", "to", "make", "them", "DMA", "able", "From", "4.9", "we", "should", "really", "avoid", "using", "the", "stack", "here", "as", "this", "will", "not", "be", "DMA", "able", "on", "various", "platforms.", "This", "changes", "the", "buffers", "already", "being", "present", "in", "time", "of", "4.9", "being", "released.", "This", "should", "go", "into", "stable", "as", "well.", "Reported-by:", "Dan", "Carpenter", "<dan.carpenter@oracle.com>", "Cc:", "stable@vger.kernel.org", "Signed-off-by:", "Stefan", "Schmidt", "<stefan@osg.samsung.com>", "Signed-off-by:", "Marcel", "Holtmann", "<marcel@holtmann.org>"], "code_tokens": ["@", "@", "-", "117", ",", "13", "+", "117", ",", "26", "@", "@", "static", "int", "atusb_read_reg", "(", "struct", "atusb", "*", "atusb", ",", "uint8_t", "reg", ")", "{", "struct", "usb_device", "*", "usb_dev", "=", "atusb", "-", ">", "usb_dev", ";", "int", "ret", ";", "uint8_t", "*", "buffer", ";", "uint8_t", "value", ";", "buffer", "=", "kmalloc", "(", "1", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "buffer", ")", "return", "-", "ENOMEM", ";", "dev_dbg", "(", "&", "usb_dev", "-", ">", "dev", ",", "\"", "atusb", ":", "reg", "=", "0x", "%", "x", "\\", "n", "\"", ",", "reg", ")", ";", "ret", "=", "atusb_control_msg", "(", "atusb", ",", "usb_rcvctrlpipe", "(", "usb_dev", ",", "0", ")", ",", "ATUSB_REG_READ", ",", "ATUSB_REQ_FROM_DEV", ",", "0", ",", "reg", ",", "&", "value", ",", "1", ",", "1000", ")", ";", "return", "ret", ">", "=", "0", "?", "value", ":", "ret", ";", "0", ",", "reg", ",", "buffer", ",", "1", ",", "1000", ")", ";", "if", "(", "ret", ">", "=", "0", ")", "{", "value", "=", "buffer", "[", "0", "]", ";", "kfree", "(", "buffer", ")", ";", "return", "value", ";", "}", "else", "{", "kfree", "(", "buffer", ")", ";", "return", "ret", ";", "}", "}", "static", "int", "atusb_write_subreg", "(", "struct", "atusb", "*", "atusb", ",", "uint8_t", "reg", ",", "uint8_t", "mask", ",", "@", "@", "-", "608", ",", "9", "+", "621", ",", "13", "@", "@", "static", "const", "struct", "ieee802154_ops", "atusb_ops", "=", "{", "static", "int", "atusb_get_and_show_revision", "(", "struct", "atusb", "*", "atusb", ")", "{", "struct", "usb_device", "*", "usb_dev", "=", "atusb", "-", ">", "usb_dev", ";", "unsigned", "char", "buffer", "[", "3", "]", ";", "unsigned", "char", "*", "buffer", ";", "int", "ret", ";", "buffer", "=", "kmalloc", "(", "3", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "buffer", ")", "return", "-", "ENOMEM", ";", "/", "*", "Get", "a", "couple", "of", "the", "ATMega", "Firmware", "values", "*", "/", "ret", "=", "atusb_control_msg", "(", "atusb", ",", "usb_rcvctrlpipe", "(", "usb_dev", ",", "0", ")", ",", "ATUSB_ID", ",", "ATUSB_REQ_FROM_DEV", ",", "0", ",", "0", ",", "@", "@", "-", "631", ",", "15", "+", "648", ",", "20", "@", "@", "static", "int", "atusb_get_and_show_revision", "(", "struct", "atusb", "*", "atusb", ")", "dev_info", "(", "&", "usb_dev", "-", ">", "dev", ",", "\"", "Please", "update", "to", "version", "0", ".", "2", "or", "newer", "\"", ");", "}", "kfree", "(", "buffer", ")", ";", "return", "ret", ";", "}", "static", "int", "atusb_get_and_show_build", "(", "struct", "atusb", "*", "atusb", ")", "{", "struct", "usb_device", "*", "usb_dev", "=", "atusb", "-", ">", "usb_dev", ";", "char", "build", "[", "ATUSB_BUILD_SIZE", "+", "1", "]", ";", "char", "*", "build", ";", "int", "ret", ";", "build", "=", "kmalloc", "(", "ATUSB_BUILD_SIZE", "+", "1", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "build", ")", "return", "-", "ENOMEM", ";", "ret", "=", "atusb_control_msg", "(", "atusb", ",", "usb_rcvctrlpipe", "(", "usb_dev", ",", "0", ")", ",", "ATUSB_BUILD", ",", "ATUSB_REQ_FROM_DEV", ",", "0", ",", "0", ",", "build", ",", "ATUSB_BUILD_SIZE", ",", "1000", ")", ";", "@", "@", "-", "648", ",", "6", "+", "670", ",", "7", "@", "@", "static", "int", "atusb_get_and_show_build", "(", "struct", "atusb", "*", "atusb", ")", "dev_info", "(", "&", "usb_dev", "-", ">", "dev", ",", "\"", "Firmware", ":", "build", "%", "s", "\\", "n", "\"", ",", "build", ")", ";", "}", "kfree", "(", "build", ")", ";", "return", "ret", ";", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["net:", "Audit", "drivers", "to", "identify", "those", "needing", "IFF_TX_SKB_SHARING", "cleared", "After", "the", "last", "patch,", "We", "are", "left", "in", "a", "state", "in", "which", "only", "drivers", "calling", "ether_setup", "have", "IFF_TX_SKB_SHARING", "set", "(we", "assume", "that", "drivers", "touching", "real", "hardware", "call", "ether_setup", "for", "their", "net_devices", "and", "don't", "hold", "any", "state", "in", "their", "skbs.", "There", "are", "a", "handful", "of", "drivers", "that", "violate", "this", "assumption", "of", "course,", "and", "need", "to", "be", "fixed", "up.", "This", "patch", "identifies", "those", "drivers,", "and", "marks", "them", "as", "not", "being", "able", "to", "support", "the", "safe", "transmission", "of", "skbs", "by", "clearning", "the", "IFF_TX_SKB_SHARING", "flag", "in", "priv_flags", "Signed-off-by:", "Neil", "Horman", "<nhorman@tuxdriver.com>", "CC:", "Karsten", "Keil", "<isdn@linux-pingi.de>", "CC:", "\"David", "S.", "Miller\"", "<davem@davemloft.net>", "CC:", "Jay", "Vosburgh", "<fubar@us.ibm.com>", "CC:", "Andy", "Gospodarek", "<andy@greyhouse.net>", "CC:", "Patrick", "McHardy", "<kaber@trash.net>", "CC:", "Krzysztof", "Halasa", "<khc@pm.waw.pl>", "CC:", "\"John", "W.", "Linville\"", "<linville@tuxdriver.com>", "CC:", "Greg", "Kroah-Hartman", "<gregkh@suse.de>", "CC:", "Marcel", "Holtmann", "<marcel@holtmann.org>", "CC:", "Johannes", "Berg", "<johannes@sipsolutions.net>", "Signed-off-by:", "David", "S.", "Miller", "<davem@davemloft.net>"], "code_tokens": ["@", "@", "-", "2532", ",", "6", "+", "2532", ",", "9", "@", "@", "static", "void", "_isdn_setup", "(", "struct", "net_device", "*", "dev", ")", "/", "*", "Setup", "the", "generic", "properties", "*", "/", "dev", "-", ">", "flags", "=", "IFF_NOARP", "|", "IFF_POINTOPOINT", ";", "/", "*", "isdn", "prepends", "a", "header", "in", "the", "tx", "path", ",", "can", "'", "t", "share", "skbs", "*", "/", "dev", "-", ">", "priv_flags", "&", "=", "~", "IFF_TX_SKB_SHARING", ";", "dev", "-", ">", "header_ops", "=", "NULL", ";", "dev", "-", ">", "netdev_ops", "=", "&", "isdn_netdev_ops", ";", "@", "@", "-", "1557", ",", "8", "+", "1557", ",", "10", "@", "@", "int", "bond_enslave", "(", "struct", "net_device", "*", "bond_dev", ",", "struct", "net_device", "*", "slave_dev", ")", "if", "(", "slave_dev", "-", ">", "type", "!", "=", "ARPHRD_ETHER", ")", "bond_setup_by_slave", "(", "bond_dev", ",", "slave_dev", ")", ";", "else", "else", "{", "ether_setup", "(", "bond_dev", ")", ";", "bond_dev", "-", ">", "priv_flags", "&", "=", "~", "IFF_TX_SKB_SHARING", ";", "}", "netdev_bonding_change", "(", "bond_dev", ",", "NETDEV_POST_TYPE_CHANGE", ")", ";", "@", "@", "-", "4330", ",", "7", "+", "4332", ",", "7", "@", "@", "static", "void", "bond_setup", "(", "struct", "net_device", "*", "bond_dev", ")", "bond_dev", "-", ">", "tx_queue_len", "=", "0", ";", "bond_dev", "-", ">", "flags", "|", "=", "IFF_MASTER", "|", "IFF_MULTICAST", ";", "bond_dev", "-", ">", "priv_flags", "|", "=", "IFF_BONDING", ";", "bond_dev", "-", ">", "priv_flags", "&", "=", "~", "IFF_XMIT_DST_RELEASE", ";", "bond_dev", "-", ">", "priv_flags", "&", "=", "~", "(", "IFF_XMIT_DST_RELEASE", "|", "IFF_TX_SKB_SHARING", ")", ";", "/", "*", "At", "first", ",", "we", "block", "adding", "VLANs", ".", "That", "'", "s", "the", "only", "way", "to", "*", "prevent", "problems", "that", "occur", "when", "adding", "VLANs", "over", "an", "@", "@", "-", "183", ",", "7", "+", "183", ",", "7", "@", "@", "static", "void", "ifb_setup", "(", "struct", "net_device", "*", "dev", ")", "dev", "-", ">", "flags", "|", "=", "IFF_NOARP", ";", "dev", "-", ">", "flags", "&", "=", "~", "IFF_MULTICAST", ";", "dev", "-", ">", "priv_flags", "&", "=", "~", "IFF_XMIT_DST_RELEASE", ";", "dev", "-", ">", "priv_flags", "&", "=", "~", "(", "IFF_XMIT_DST_RELEASE", "|", "IFF_TX_SKB_SHARING", ")", ";", "random_ether_addr", "(", "dev", "-", ">", "dev_addr", ")", ";", "}", "@", "@", "-", "572", ",", "7", "+", "572", ",", "7", "@", "@", "void", "macvlan_common_setup", "(", "struct", "net_device", "*", "dev", ")", "{", "ether_setup", "(", "dev", ")", ";", "dev", "-", ">", "priv_flags", "&", "=", "~", "IFF_XMIT_DST_RELEASE", ";", "dev", "-", ">", "priv_flags", "&", "=", "~", "(", "IFF_XMIT_DST_RELEASE", "|", "IFF_TX_SKB_SHARING", ")", ";", "dev", "-", ">", "netdev_ops", "=", "&", "macvlan_netdev_ops", ";", "dev", "-", ">", "destructor", "=", "free_netdev", ";", "dev", "-", ">", "header_ops", "=", "&", "macvlan_hard_header_ops", ",", "@", "@", "-", "528", ",", "6", "+", "528", ",", "7", "@", "@", "static", "void", "tun_net_init", "(", "struct", "net_device", "*", "dev", ")", "dev", "-", ">", "netdev_ops", "=", "&", "tap_netdev_ops", ";", "/", "*", "Ethernet", "TAP", "Device", "*", "/", "ether_setup", "(", "dev", ")", ";", "dev", "-", ">", "priv_flags", "&", "=", "~", "IFF_TX_SKB_SHARING", ";", "random_ether_addr", "(", "dev", "-", ">", "dev_addr", ")", ";", "@", "@", "-", "263", ",", "6", "+", "263", ",", "8", "@", "@", "static", "void", "veth_setup", "(", "struct", "net_device", "*", "dev", ")", "{", "ether_setup", "(", "dev", ")", ";", "dev", "-", ">", "priv_flags", "&", "=", "~", "IFF_TX_SKB_SHARING", ";", "dev", "-", ">", "netdev_ops", "=", "&", "veth_netdev_ops", ";", "dev", "-", ">", "ethtool_ops", "=", "&", "veth_ethtool_ops", ";", "dev", "-", ">", "features", "|", "=", "NETIF_F_LLTX", ";", "@", "@", "-", "1074", ",", "9", "+", "1074", ",", "10", "@", "@", "static", "int", "fr_add_pvc", "(", "struct", "net_device", "*", "frad", ",", "unsigned", "int", "dlci", ",", "int", "type", ")", "used", "=", "pvc_is_used", "(", "pvc", ")", ";", "if", "(", "type", "=", "=", "ARPHRD_ETHER", ")", "if", "(", "type", "=", "=", "ARPHRD_ETHER", ")", "{", "dev", "=", "alloc_netdev", "(", "0", ",", "\"", "pvceth", "%", "d", "\"", ",", "ether_setup", ")", ";", "else", "dev", "-", ">", "priv_flags", "&", "=", "~", "IFF_TX_SKB_SHARING", ";", "}", "else", "dev", "=", "alloc_netdev", "(", "0", ",", "\"", "pvc", "%", "d", "\"", ",", "pvc_setup", ")", ";", "if", "(", "!", "dev", ")", "{", "@", "@", "-", "2823", ",", "6", "+", "2823", ",", "7", "@", "@", "static", "struct", "net_device", "*", "_init_airo_card", "(", "unsigned", "short", "irq", ",", "int", "port", ",", "dev", "-", ">", "wireless_data", "=", "&", "ai", "-", ">", "wireless_data", ";", "dev", "-", ">", "irq", "=", "irq", ";", "dev", "-", ">", "base_addr", "=", "port", ";", "dev", "-", ">", "priv_flags", "&", "=", "~", "IFF_TX_SKB_SHARING", ";", "SET_NETDEV_DEV", "(", "dev", ",", "dmdev", ")", ";", "@", "@", "-", "855", ",", "6", "+", "855", ",", "7", "@", "@", "void", "hostap_setup_dev", "(", "struct", "net_device", "*", "dev", ",", "local_info_t", "*", "local", ",", "iface", "=", "netdev_priv", "(", "dev", ")", ";", "ether_setup", "(", "dev", ")", ";", "dev", "-", ">", "priv_flags", "&", "=", "~", "IFF_TX_SKB_SHARING", ";", "/", "*", "kernel", "callbacks", "*", "/", "if", "(", "iface", ")", "{", "@", "@", "-", "6179", ",", "6", "+", "6179", ",", "7", "@", "@", "int", "ar6000_create_ap_interface", "(", "struct", "ar6_softc", "*", "ar", ",", "char", "*", "ap_ifname", ")", "ether_setup", "(", "dev", ")", ";", "init_netdev", "(", "dev", ",", "ap_ifname", ")", ";", "dev", "-", ">", "priv_flags", "&", "=", "~", "IFF_TX_SKB_SHARING", ";", "if", "(", "register_netdev", "(", "dev", ")", ")", "{", "AR_DEBUG_PRINTF", "(", "ATH_DEBUG_ERR", ",", "(\"", "ar6000_create_ap_interface", ":", "register_netdev", "failed", "\\", "n", "\"", "))", ";", "@", "@", "-", "695", ",", "7", "+", "695", ",", "7", "@", "@", "void", "vlan_setup", "(", "struct", "net_device", "*", "dev", ")", "ether_setup", "(", "dev", ")", ";", "dev", "-", ">", "priv_flags", "|", "=", "IFF_802_1Q_VLAN", ";", "dev", "-", ">", "priv_flags", "&", "=", "~", "IFF_XMIT_DST_RELEASE", ";", "dev", "-", ">", "priv_flags", "&", "=", "~", "(", "IFF_XMIT_DST_RELEASE", "|", "IFF_TX_SKB_SHARING", ")", ";", "dev", "-", ">", "tx_queue_len", "=", "0", ";", "dev", "-", ">", "netdev_ops", "=", "&", "vlan_netdev_ops", ";", "@", "@", "-", "231", ",", "6", "+", "231", ",", "7", "@", "@", "void", "bnep_net_setup", "(", "struct", "net_device", "*", "dev", ")", "dev", "-", ">", "addr_len", "=", "ETH_ALEN", ";", "ether_setup", "(", "dev", ")", ";", "dev", "-", ">", "priv_flags", "&", "=", "~", "IFF_TX_SKB_SHARING", ";", "dev", "-", ">", "netdev_ops", "=", "&", "bnep_netdev_ops", ";", "dev", "-", ">", "watchdog_timeo", "=", "HZ", "*", "2", ";", "@", "@", "-", "103", ",", "7", "+", "103", ",", "7", "@", "@", "static", "struct", "net_device_ops", "l2tp_eth_netdev_ops", "=", "{", "static", "void", "l2tp_eth_dev_setup", "(", "struct", "net_device", "*", "dev", ")", "{", "ether_setup", "(", "dev", ")", ";", "dev", "-", ">", "priv_flags", "&", "=", "~", "IFF_TX_SKB_SHARING", ";", "dev", "-", ">", "netdev_ops", "=", "&", "l2tp_eth_netdev_ops", ";", "dev", "-", ">", "destructor", "=", "free_netdev", ";", "}", "@", "@", "-", "698", ",", "6", "+", "698", ",", "7", "@", "@", "static", "const", "struct", "net_device_ops", "ieee80211_monitorif_ops", "=", "{", "static", "void", "ieee80211_if_setup", "(", "struct", "net_device", "*", "dev", ")", "{", "ether_setup", "(", "dev", ")", ";", "dev", "-", ">", "priv_flags", "&", "=", "~", "IFF_TX_SKB_SHARING", ";", "dev", "-", ">", "netdev_ops", "=", "&", "ieee80211_dataif_ops", ";", "dev", "-", ">", "destructor", "=", "free_netdev", ";", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Cirrus", "CI:", "Try", "to", "speed", "FreeBSD", "13.0", "up.", "[skip", "appveyor]", "[skip", "travis]", "Whatever", "the", "underlying", "reason,", "freebsd-13-0-snap", "used", "to", "take", "a", "couple", "times", "more", "time", "to", "make", "it", "through", "the", "build", "than", "the", "other", "two", "image", "families.", "After", "switching", "to", "the", "full", "nested", "matrix", "this", "started", "to", "cause", "task", "timeouts", "and", "rescheduling.", "Let's", "see", "if", "a", "different", "distribution", "of", "resources", "can", "improve", "this.", "Update", "the", "Linux", "task", "comment", "while", "at", "it."], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Upgrades", "OWASP", "Dependency", "Check", "plugin"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["ext4:", "only", "use", "i_size_high", "for", "regular", "files", "Directories", "are", "not", "allowed", "to", "be", "bigger", "than", "2GB,", "so", "don't", "use", "i_size_high", "for", "anything", "other", "than", "regular", "files.", "E2fsck", "should", "complain", "about", "these", "inodes,", "but", "the", "simplest", "thing", "to", "do", "for", "the", "kernel", "is", "to", "only", "use", "i_size_high", "for", "regular", "files.", "This", "prevents", "an", "intentially", "corrupted", "filesystem", "from", "causing", "the", "kernel", "to", "burn", "a", "huge", "amount", "of", "CPU", "and", "issuing", "error", "messages", "such", "as:", "EXT4-fs", "warning", "(device", "loop0):", "ext4_block_to_path:", "block", "135090028", ">", "max", "Thanks", "to", "David", "Maciejak", "from", "Fortinet's", "FortiGuard", "Global", "Security", "Research", "Team", "for", "reporting", "this", "issue.", "http://bugzilla.kernel.org/show_bug.cgi?id=12375", "Signed-off-by:", "\"Theodore", "Ts'o\"", "<tytso@mit.edu>", "Cc:", "stable@kernel.org"], "code_tokens": ["@", "@", "-", "1206", ",", "8", "+", "1206", ",", "11", "@", "@", "static", "inline", "void", "ext4_r_blocks_count_set", "(", "struct", "ext4_super_block", "*", "es", ",", "static", "inline", "loff_t", "ext4_isize", "(", "struct", "ext4_inode", "*", "raw_inode", ")", "{", "return", "(", "(", "loff_t", ")", "le32_to_cpu", "(", "raw_inode", "-", ">", "i_size_high", ")", "<", "<", "32", ")", "|", "le32_to_cpu", "(", "raw_inode", "-", ">", "i_size_lo", ")", ";", "if", "(", "S_ISREG", "(", "le16_to_cpu", "(", "raw_inode", "-", ">", "i_mode", ")", "))", "return", "(", "(", "loff_t", ")", "le32_to_cpu", "(", "raw_inode", "-", ">", "i_size_high", ")", "<", "<", "32", ")", "|", "le32_to_cpu", "(", "raw_inode", "-", ">", "i_size_lo", ")", ";", "else", "return", "(", "loff_t", ")", "le32_to_cpu", "(", "raw_inode", "-", ">", "i_size_lo", ")", ";", "}", "static", "inline", "void", "ext4_isize_set", "(", "struct", "ext4_inode", "*", "raw_inode", ",", "loff_t", "i_size", ")", "@", "@", "-", "360", ",", "9", "+", "360", ",", "9", "@", "@", "static", "int", "ext4_block_to_path", "(", "struct", "inode", "*", "inode", ",", "final", "=", "ptrs", ";", "}", "else", "{", "ext4_warning", "(", "inode", "-", ">", "i_sb", ",", "\"", "ext4_block_to_path", "\"", ",", "\"", "block", "%", "lu", ">", "max", "\"", ",", "\"", "block", "%", "lu", ">", "max", "in", "inode", "%", "lu", "\"", ",", "i_block", "+", "direct_blocks", "+", "indirect_blocks", "+", "double_blocks", ")", ";", "indirect_blocks", "+", "double_blocks", ",", "inode", "-", ">", "i_ino", ")", ";", "}", "if", "(", "boundary", ")", "*", "boundary", "=", "final", "-", "1", "-", "(", "i_block", "&", "(", "ptrs", "-", "1", ")", ");"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["update", "PF-Selenium-readme.md", "plus", "move", "TreeTable", "to", "right", "package", "(#7624)"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["[SECURITY-166]", "Prevent", "the", "creation", "of", "anonymous,", "system", "or", "unknown", "users.", "These", "users", "can", "still", "be", "instantiated,", "as", "would", "happen", "if", "there", "is", "no", "security", "and", "an", "anonymous", "user", "triggers", "a", "build", "--", "the", "anonymous", "user", "would", "correctly", "be", "created", "and", "added", "to", "the", "User", "list.", "This", "fix", "merely", "prevents", "the", "saving", "of", "that", "user,", "and", "therefore", "prevents", "them", "from", "logging", "in.", "There", "may", "be", "some", "plugins", "which", "trigger", "a", "build", "as", "the", "SYSTEM", "user,", "and", "that", "is", "not", "prohibited", "here.", "Also", "prevent", "full", "names", "of", "'anonymous',", "'system'", "or", "'uknown'.", "As", "discussed", "on", "SECURITY-166", "this", "may", "encumber", "auditing", "since", "full", "names", "are", "used", "in", "most", "places", "in", "the", "UI"], "code_tokens": ["@", "@", "-", "34", ",", "6", "+", "34", ",", "7", "@", "@", "import", "hudson", ".", "security", ".", "Permission", ";", "import", "hudson", ".", "security", ".", "SecurityRealm", ";", "import", "hudson", ".", "util", ".", "FormApply", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "hudson", ".", "util", ".", "RunList", ";", "import", "hudson", ".", "util", ".", "XStream2", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "@", "@", "-", "46", ",", "6", "+", "47", ",", "8", "@", "@", "import", "org", ".", "acegisecurity", ".", "providers", ".", "anonymous", ".", "AnonymousAuthenticationToken", ";", "import", "org", ".", "acegisecurity", ".", "userdetails", ".", "UserDetails", ";", "import", "org", ".", "acegisecurity", ".", "userdetails", ".", "UsernameNotFoundException", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "Restricted", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "restrictions", ".", "NoExternalUse", ";", "import", "org", ".", "springframework", ".", "dao", ".", "DataAccessException", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerResponse", ";", "@", "@", "-", "102", ",", "7", "+", "105", ",", "12", "@", "@", "*", "/", "@", "ExportedBean", "public", "class", "User", "extends", "AbstractModelObject", "implements", "AccessControlled", ",", "DescriptorByNameOwner", ",", "Saveable", ",", "Comparable", "<", "User", ">", ",", "ModelObjectWithContextMenu", "{", "/", "**", "*", "These", "usernames", "should", "not", "be", "used", "by", "real", "users", "logging", "into", "Jenkins", ".", "Therefore", ",", "we", "prevent", "*", "users", "with", "these", "names", "from", "being", "saved", ".", "*", "/", "public", "static", "final", "String", "[", "]", "ILLEGAL_PERSISTED_USERNAMES", "=", "new", "String", "[", "]{", "\"", "anonymous", "\"", ",", "\"", "system", "\"", ",", "\"", "unknown", "\"", "};", "private", "transient", "final", "String", "id", ";", "private", "volatile", "String", "fullName", ";", "@", "@", "-", "500", ",", "10", "+", "508", ",", "36", "@", "@", "private", "static", "File", "getRootDir", "(", ")", "{", "return", "new", "File", "(", "Jenkins", ".", "getInstance", "(", ").", "getRootDir", "(", "),", "\"", "users", "\"", ");", "}", "/", "**", "*", "Is", "the", "ID", "allowed", "?", "Some", "are", "prohibited", "for", "security", "reasons", ".", "See", "SECURITY", "-", "166", ".", "*", "<", "p", "/", ">", "*", "Note", "that", "this", "is", "only", "enforced", "when", "saving", ".", "These", "users", "are", "often", "created", "*", "via", "the", "constructor", "(", "and", "even", "listed", "on", "/", "asynchPeople", ")", ",", "but", "our", "goal", "is", "to", "*", "prevent", "anyone", "from", "logging", "in", "as", "these", "users", ".", "Therefore", ",", "we", "prevent", "*", "saving", "a", "User", "with", "one", "of", "these", "ids", ".", "*", "*", "@", "return", "true", "if", "the", "username", "or", "fullname", "is", "valid", "*", "/", "/", "/", "TODO", ":", "Remove", "Restricted", "and", "add", "@", "since", "when", "merging", "to", "stable", "-", "rc", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "public", "static", "boolean", "isIdOrFullnameAllowed", "(", "String", "id", ")", "{", "for", "(", "String", "invalidId", ":", "ILLEGAL_PERSISTED_USERNAMES", ")", "{", "if", "(", "id", ".", "equalsIgnoreCase", "(", "invalidId", ")", ")", "return", "false", ";", "}", "return", "true", ";", "}", "/", "**", "*", "Save", "the", "settings", "to", "a", "file", ".", "*", "/", "public", "synchronized", "void", "save", "(", ")", "throws", "IOException", "{", "public", "synchronized", "void", "save", "(", ")", "throws", "IOException", ",", "FormValidation", "{", "if", "(", "!", "isIdOrFullnameAllowed", "(", "id", ")", ")", "{", "throw", "FormValidation", ".", "error", "(", "Messages", ".", "User_IllegalUsername", "(", "id", ")", ");", "}", "if", "(", "!", "isIdOrFullnameAllowed", "(", "fullName", ")", ")", "{", "throw", "FormValidation", ".", "error", "(", "Messages", ".", "User_IllegalFullname", "(", "fullName", ")", ");", "}", "if", "(", "BulkChange", ".", "contains", "(", "this", ")", ")", "return", ";", "getConfigFile", "(", ").", "write", "(", "this", ")", ";", "SaveableListener", ".", "fireOnChange", "(", "this", ",", "getConfigFile", "(", "))", ";", "@", "@", "-", "329", ",", "6", "+", "329", ",", "14", "@", "@", "private", "User", "createAccount", "(", "StaplerRequest", "req", ",", "StaplerResponse", "rsp", ",", "boolean", "self", "if", "(", "si", ".", "email", "=", "=", "null", "|", "|", "!", "si", ".", "email", ".", "contains", "(", "\"@", "\")", ")", "si", ".", "errorMessage", "=", "Messages", ".", "HudsonPrivateSecurityRealm_CreateAccount_InvalidEmailAddress", "(", ");", "if", "(", "!", "User", ".", "isIdOrFullnameAllowed", "(", "si", ".", "username", ")", ")", "{", "si", ".", "errorMessage", "=", "hudson", ".", "model", ".", "Messages", ".", "User_IllegalUsername", "(", "si", ".", "username", ")", ";", "}", "if", "(", "!", "User", ".", "isIdOrFullnameAllowed", "(", "si", ".", "fullname", ")", ")", "{", "si", ".", "errorMessage", "=", "hudson", ".", "model", ".", "Messages", ".", "User_IllegalFullname", "(", "si", ".", "fullname", ")", ";", "}", "if", "(", "si", ".", "errorMessage", "!", "=", "null", ")", "{", "/", "/", "failed", ".", "ask", "the", "user", "to", "try", "again", ".", "req", ".", "setAttribute", "(", "\"", "data", "\"", ",", "si", ")", ";", "@", "@", "-", "357", ",", "3", "+", "357", ",", "6", "@", "@", "Jenkins", ".", "CheckDisplayName", ".", "NameNotUniqueWarning", "=", "The", "display", "name", ",", "\"", "{", "0", "}", "\",", "is", "used", "a", "Jenkins", ".", "CheckDisplayName", ".", "DisplayNameNotUniqueWarning", "=", "The", "display", "name", ",", "\"", "{", "0", "}", "\",", "is", "already", "in", "use", "by", "another", "job", "and", "could", "cause", "confusion", "and", "delay", ".", "Jenkins", ".", "NotAllowedName", "=", "\"{", "0", "}", "\"", "is", "not", "allowed", "name", "User", ".", "IllegalUsername", "=", "\"{", "0", "}", "\"", "is", "prohibited", "as", "a", "username", "for", "security", "reasons", ".", "User", ".", "IllegalFullname", "=", "\"{", "0", "}", "\"", "is", "prohibited", "as", "a", "full", "name", "for", "security", "reasons", ".", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "0", ",", "0", "+", "1", ",", "93", "@", "@", "package", "hudson", ".", "security", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "html", ".", "HtmlPage", ";", "import", "hudson", ".", "model", ".", "User", ";", "import", "hudson", ".", "security", ".", "pages", ".", "SignupPage", ";", "import", "org", ".", "junit", ".", "Rule", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "JenkinsRule", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "containsString", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*;", "/", "**", "*", "Tests", "the", "signup", "page", "of", "{", "@", "link", "hudson", ".", "security", ".", "HudsonPrivateSecurityRealm", "}", "*", "TODO", ":", "Add", "to", "{", "@", "link", "hudson", ".", "security", ".", "HudsonPrivateSecurityRealmTest", "}", "going", "forward", "*", "/", "public", "class", "HudsonPrivateSecurityRealm2Test", "{", "@", "Rule", "public", "JenkinsRule", "rule", "=", "new", "JenkinsRule", "(", ");", "@", "Test", "public", "void", "signup", "(", ")", "throws", "Exception", "{", "HudsonPrivateSecurityRealm", "securityRealm", "=", "new", "HudsonPrivateSecurityRealm", "(", "true", ",", "false", ",", "null", ")", ";", "rule", ".", "jenkins", ".", "setSecurityRealm", "(", "securityRealm", ")", ";", "JenkinsRule", ".", "WebClient", "wc", "=", "rule", ".", "createWebClient", "(", ");", "SignupPage", "signup", "=", "new", "SignupPage", "(", "wc", ".", "goTo", "(", "\"", "signup", "\"", "))", ";", "signup", ".", "enterUsername", "(", "\"", "alice", "\"", ");", "signup", ".", "enterPassword", "(", "\"", "alice", "\"", ");", "signup", ".", "enterFullName", "(", "\"", "Alice", "User", "\"", ");", "signup", ".", "enterEmail", "(", "\"", "alice", "@", "nowhere", ".", "com", "\"", ");", "HtmlPage", "success", "=", "signup", ".", "submit", "(", "rule", ")", ";", "assertThat", "(", "success", ".", "getElementById", "(", "\"", "main", "-", "panel", "\"", ").", "getTextContent", "(", "),", "containsString", "(", "\"", "Success", "\"", "))", ";", "assertThat", "(", "success", ".", "getElementById", "(", "\"", "login", "-", "field", "\"", ").", "getTextContent", "(", "),", "containsString", "(", "\"", "Alice", "User", "\"", "))", ";", "assertEquals", "(", "\"", "Alice", "User", "\"", ",", "securityRealm", ".", "getUser", "(", "\"", "alice", "\"", ").", "getDisplayName", "(", "))", ";", "}", "/", "/", "@", "Issue", "(", "\"", "SECURITY", "-", "166", "\"", ")", "@", "Test", "public", "void", "anonymousCantSignup", "(", ")", "throws", "Exception", "{", "HudsonPrivateSecurityRealm", "securityRealm", "=", "new", "HudsonPrivateSecurityRealm", "(", "true", ",", "false", ",", "null", ")", ";", "rule", ".", "jenkins", ".", "setSecurityRealm", "(", "securityRealm", ")", ";", "JenkinsRule", ".", "WebClient", "wc", "=", "rule", ".", "createWebClient", "(", ");", "SignupPage", "signup", "=", "new", "SignupPage", "(", "wc", ".", "goTo", "(", "\"", "signup", "\"", "))", ";", "signup", ".", "enterUsername", "(", "\"", "anonymous", "\"", ");", "signup", ".", "enterFullName", "(", "\"", "Bob", "\"", ");", "signup", ".", "enterPassword", "(", "\"", "nothing", "\"", ");", "signup", ".", "enterEmail", "(", "\"", "noone", "@", "nowhere", ".", "com", "\"", ");", "signup", "=", "new", "SignupPage", "(", "signup", ".", "submit", "(", "rule", ")", ");", "signup", ".", "assertErrorContains", "(", "\"", "prohibited", "as", "a", "username", "\"", ");", "assertNull", "(", "User", ".", "get", "(", "\"", "anonymous", "\"", ",", "false", ",", "Collections", ".", "emptyMap", "(", "))", ");", "}", "/", "/", "@", "Issue", "(", "\"", "SECURITY", "-", "166", "\"", ")", "@", "Test", "public", "void", "systemCantSignup", "(", ")", "throws", "Exception", "{", "HudsonPrivateSecurityRealm", "securityRealm", "=", "new", "HudsonPrivateSecurityRealm", "(", "true", ",", "false", ",", "null", ")", ";", "rule", ".", "jenkins", ".", "setSecurityRealm", "(", "securityRealm", ")", ";", "JenkinsRule", ".", "WebClient", "wc", "=", "rule", ".", "createWebClient", "(", ");", "SignupPage", "signup", "=", "new", "SignupPage", "(", "wc", ".", "goTo", "(", "\"", "signup", "\"", "))", ";", "signup", ".", "enterUsername", "(", "\"", "system", "\"", ");", "signup", ".", "enterFullName", "(", "\"", "Bob", "\"", ");", "signup", ".", "enterPassword", "(", "\"", "nothing", "\"", ");", "signup", ".", "enterEmail", "(", "\"", "noone", "@", "nowhere", ".", "com", "\"", ");", "signup", "=", "new", "SignupPage", "(", "signup", ".", "submit", "(", "rule", ")", ");", "signup", ".", "assertErrorContains", "(", "\"", "prohibited", "as", "a", "username", "\"", ");", "assertNull", "(", "User", ".", "get", "(", "\"", "system", "\"", ",", "false", ",", "Collections", ".", "emptyMap", "(", "))", ");", "}", "/", "**", "*", "We", "don", "'", "t", "allow", "prohibited", "fullnames", "since", "this", "may", "encumber", "auditing", ".", "*", "/", "/", "/", "@", "Issue", "(", "\"", "SECURITY", "-", "166", "\"", ")", "@", "Test", "public", "void", "fullNameOfUnknownCantSignup", "(", ")", "throws", "Exception", "{", "HudsonPrivateSecurityRealm", "securityRealm", "=", "new", "HudsonPrivateSecurityRealm", "(", "true", ",", "false", ",", "null", ")", ";", "rule", ".", "jenkins", ".", "setSecurityRealm", "(", "securityRealm", ")", ";", "JenkinsRule", ".", "WebClient", "wc", "=", "rule", ".", "createWebClient", "(", ");", "SignupPage", "signup", "=", "new", "SignupPage", "(", "wc", ".", "goTo", "(", "\"", "signup", "\"", "))", ";", "signup", ".", "enterUsername", "(", "\"", "unknown2", "\"", ");", "signup", ".", "enterPassword", "(", "\"", "unknown2", "\"", ");", "signup", ".", "enterFullName", "(", "\"", "unknown", "\"", ");", "signup", ".", "enterEmail", "(", "\"", "noone", "@", "nowhere", ".", "com", "\"", ");", "signup", "=", "new", "SignupPage", "(", "signup", ".", "submit", "(", "rule", ")", ");", "signup", ".", "assertErrorContains", "(", "\"", "prohibited", "as", "a", "full", "name", "\"", ");", "assertNull", "(", "User", ".", "get", "(", "\"", "unknown2", "\"", ",", "false", ",", "Collections", ".", "emptyMap", "(", "))", ");", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "65", "@", "@", "package", "hudson", ".", "security", ".", "pages", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "html", ".", "HtmlForm", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "html", ".", "HtmlPage", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "JenkinsRule", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "containsString", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*;", "/", "**", "*", "The", "the", "signup", "page", "for", "{", "@", "link", "hudson", ".", "security", ".", "HudsonPrivateSecurityRealm", "}", "*", "/", "public", "class", "SignupPage", "{", "public", "HtmlForm", "signupForm", ";", "public", "final", "HtmlPage", "signupPage", ";", "public", "SignupPage", "(", "HtmlPage", "signupPage", ")", "{", "this", ".", "signupPage", "=", "signupPage", ";", "assertNotNull", "(", "\"", "The", "sign", "up", "page", "has", "a", "username", "field", ".", "\",", "this", ".", "signupPage", ".", "getElementById", "(", "\"", "username", "\"", "))", ";", "for", "(", "HtmlForm", "signupForm", ":", "this", ".", "signupPage", ".", "getForms", "(", "))", "{", "if", "(", "signupForm", ".", "getInputsByName", "(", "\"", "username", "\"", ").", "size", "(", ")", "=", "=", "0", ")", "continue", ";", "this", ".", "signupForm", "=", "signupForm", ";", "}", "}", "public", "void", "enterUsername", "(", "String", "username", ")", "{", "signupForm", ".", "getInputByName", "(", "\"", "username", "\"", ").", "setValueAttribute", "(", "username", ")", ";", "}", "/", "**", "*", "Enters", "the", "password", "in", "password1", "and", "password2", ".", "*", "You", "can", "then", "call", "{", "@", "link", "#", "enterPassword2", "(", "String", ")", "}", "if", "you", "want", "them", "to", "be", "different", ".", "*", "@", "param", "password", "*", "/", "public", "void", "enterPassword", "(", "String", "password", ")", "{", "signupForm", ".", "getInputByName", "(", "\"", "password1", "\"", ").", "setValueAttribute", "(", "password", ")", ";", "signupForm", ".", "getInputByName", "(", "\"", "password2", "\"", ").", "setValueAttribute", "(", "password", ")", ";", "}", "public", "void", "enterPassword2", "(", "String", "password2", ")", "{", "signupForm", ".", "getInputByName", "(", "\"", "password2", "\"", ").", "setValueAttribute", "(", "password2", ")", ";", "}", "public", "void", "enterFullName", "(", "String", "fullName", ")", "{", "signupForm", ".", "getInputByName", "(", "\"", "fullname", "\"", ").", "setValueAttribute", "(", "fullName", ")", ";", "}", "public", "void", "enterEmail", "(", "String", "email", ")", "{", "signupForm", ".", "getInputByName", "(", "\"", "email", "\"", ").", "setValueAttribute", "(", "email", ")", ";", "}", "public", "HtmlPage", "submit", "(", "JenkinsRule", "rule", ")", "throws", "Exception", "{", "return", "rule", ".", "submit", "(", "signupForm", ")", ";", "}", "public", "void", "assertErrorContains", "(", "String", "msg", ")", "{", "assertThat", "(", "signupForm", ".", "getElementById", "(", "\"", "main", "-", "panel", "\"", ").", "getTextContent", "(", "),", "containsString", "(", "msg", ")", ");", "}", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["swscale:", "set", "colorspace", "information", "to", "swscale", "context", "Colorspace", "most", "cases", "default", "with", "swscale,", "but", "it", "shouldn't", "hurt", "to", "define", "it", "if", "possible."], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["vfs:", "ioctl:", "prevent", "double-fetch", "in", "dedupe", "ioctl", "This", "prevents", "a", "double-fetch", "from", "user", "space", "that", "can", "lead", "to", "to", "an", "undersized", "allocation", "and", "heap", "overflow.", "Fixes:", "54dbc1517237", "(\"vfs:", "hoist", "the", "btrfs", "deduplication", "ioctl", "to", "the", "vfs\")", "Signed-off-by:", "Scott", "Bauer", "<sbauer@plzdonthack.me>", "Signed-off-by:", "Linus", "Torvalds", "<torvalds@linux-foundation.org>"], "code_tokens": ["@", "@", "-", "590", ",", "6", "+", "590", ",", "7", "@", "@", "static", "long", "ioctl_file_dedupe_range", "(", "struct", "file", "*", "file", ",", "void", "__user", "*", "arg", ")", "goto", "out", ";", "}", "same", "-", ">", "dest_count", "=", "count", ";", "ret", "=", "vfs_dedupe_file_range", "(", "file", ",", "same", ")", ";", "if", "(", "ret", ")", "goto", "out", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Demonstration", "code", "to", "show", "how", "NOT", "NULL", "and", "CHECK", "constraints", "can", "be", "verified", "after", "an", "ALTER", "TABLE", "ADD", "COLUMN.", "FossilOrigin-Name:", "039f540373b03af9e0c87499e5e0423eb093d1d343829282a5ac1de2d600b881"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["usbip:", "prevent", "vhci_hcd", "driver", "from", "leaking", "a", "socket", "pointer", "address", "When", "a", "client", "has", "a", "USB", "device", "attached", "over", "IP,", "the", "vhci_hcd", "driver", "is", "locally", "leaking", "a", "socket", "pointer", "address", "via", "the", "/sys/devices/platform/vhci_hcd/status", "file", "(world-readable)", "and", "in", "debug", "output", "when", "\"usbip", "--debug", "port\"", "is", "run.", "Fix", "it", "to", "not", "leak.", "The", "socket", "pointer", "address", "is", "not", "used", "at", "the", "moment", "and", "it", "was", "made", "visible", "as", "a", "convenient", "way", "to", "find", "IP", "address", "from", "socket", "pointer", "address", "by", "looking", "up", "/proc/net/{tcp,tcp6}.", "As", "this", "opens", "a", "security", "hole,", "the", "fix", "replaces", "socket", "pointer", "address", "with", "sockfd.", "Reported-by:", "Secunia", "Research", "<vuln@secunia.com>", "Cc:", "stable", "<stable@vger.kernel.org>", "Signed-off-by:", "Shuah", "Khan", "<shuahkh@osg.samsung.com>", "Signed-off-by:", "Greg", "Kroah-Hartman", "<gregkh@linuxfoundation.org>"], "code_tokens": ["@", "@", "-", "256", ",", "6", "+", "256", ",", "7", "@", "@", "struct", "usbip_device", "{", "/", "*", "lock", "for", "status", "*", "/", "spinlock_t", "lock", ";", "int", "sockfd", ";", "struct", "socket", "*", "tcp_socket", ";", "struct", "task_struct", "*", "tcp_rx", ";", "@", "@", "-", "17", ",", "15", "+", "17", ",", "20", "@", "@", "/", "*", "*", "output", "example", ":", "*", "hub", "port", "sta", "spd", "dev", "socket", "local_busid", "*", "hs", "0000", "004", "000", "00000000", "c5a7bb80", "1", "-", "2", ".", "3", "*", "hub", "port", "sta", "spd", "dev", "sockfd", "local_busid", "*", "hs", "0000", "004", "000", "00000000", "3", "1", "-", "2", ".", "3", "*", ".", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", ".", "*", "ss", "0008", "004", "000", "00000000", "d8cee980", "2", "-", "3", ".", "4", "*", "ss", "0008", "004", "000", "00000000", "4", "2", "-", "3", ".", "4", "*", ".", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", "..", ".", "*", "*", "IP", "address", "can", "be", "retrieved", "from", "a", "socket", "pointer", "address", "by", "looking", "*", "up", "/", "proc", "/", "net", "/", "{", "tcp", ",", "tcp6", "}", ".", "Also", ",", "a", "userland", "program", "may", "remember", "a", "*", "port", "number", "and", "its", "peer", "IP", "address", ".", "*", "Output", "includes", "socket", "fd", "instead", "of", "socket", "pointer", "address", "to", "avoid", "*", "leaking", "kernel", "memory", "address", "in", ":", "*", "/", "sys", "/", "devices", "/", "platform", "/", "vhci_hcd", ".", "0", "/", "status", "and", "in", "debug", "output", ".", "*", "The", "socket", "pointer", "address", "is", "not", "used", "at", "the", "moment", "and", "it", "was", "made", "*", "visible", "as", "a", "convenient", "way", "to", "find", "IP", "address", "from", "socket", "pointer", "*", "address", "by", "looking", "up", "/", "proc", "/", "net", "/", "{", "tcp", ",", "tcp6", "}", ".", "As", "this", "opens", "a", "security", "*", "hole", ",", "the", "change", "is", "made", "to", "use", "sockfd", "instead", ".", "*", "*", "/", "static", "void", "port_show_vhci", "(", "char", "*", "*", "out", ",", "int", "hub", ",", "int", "port", ",", "struct", "vhci_device", "*", "vdev", ")", "{", "@", "@", "-", "39", ",", "8", "+", "44", ",", "8", "@", "@", "static", "void", "port_show_vhci", "(", "char", "*", "*", "out", ",", "int", "hub", ",", "int", "port", ",", "struct", "vhci_device", "*", "vd", "if", "(", "vdev", "-", ">", "ud", ".", "status", "=", "=", "VDEV_ST_USED", ")", "{", "*", "out", "+", "=", "sprintf", "(", "*", "out", ",", "\"", "%", "03u", "%", "08x", "\"", ",", "vdev", "-", ">", "speed", ",", "vdev", "-", ">", "devid", ")", ";", "*", "out", "+", "=", "sprintf", "(", "*", "out", ",", "\"", "%", "16p", "%", "s", "\"", ",", "vdev", "-", ">", "ud", ".", "tcp_socket", ",", "*", "out", "+", "=", "sprintf", "(", "*", "out", ",", "\"", "%", "u", "%", "s", "\"", ",", "vdev", "-", ">", "ud", ".", "sockfd", ",", "dev_name", "(", "&", "vdev", "-", ">", "udev", "-", ">", "dev", ")", ");", "}", "else", "{", "@", "@", "-", "160", ",", "7", "+", "165", ",", "8", "@", "@", "static", "ssize_t", "nports_show", "(", "struct", "device", "*", "dev", ",", "struct", "device_attribute", "*", "attr", ",", "char", "*", "s", "=", "out", ";", "/", "*", "*", "Half", "the", "ports", "are", "for", "SPEED_HIGH", "and", "half", "for", "SPEED_SUPER", ",", "thus", "the", "*", "2", ".", "*", "Half", "the", "ports", "are", "for", "SPEED_HIGH", "and", "half", "for", "SPEED_SUPER", ",", "*", "thus", "the", "*", "2", ".", "*", "/", "out", "+", "=", "sprintf", "(", "out", ",", "\"", "%", "d", "\\", "n", "\"", ",", "VHCI_PORTS", "*", "vhci_num_controllers", ")", ";", "return", "out", "-", "s", ";", "@", "@", "-", "366", ",", "6", "+", "372", ",", "7", "@", "@", "static", "ssize_t", "store_attach", "(", "struct", "device", "*", "dev", ",", "struct", "device_attribute", "*", "attr", ",", "vdev", "-", ">", "devid", "=", "devid", ";", "vdev", "-", ">", "speed", "=", "speed", ";", "vdev", "-", ">", "ud", ".", "sockfd", "=", "sockfd", ";", "vdev", "-", ">", "ud", ".", "tcp_socket", "=", "socket", ";", "vdev", "-", ">", "ud", ".", "status", "=", "VDEV_ST_NOTASSIGNED", ";", "@", "@", "-", "50", ",", "14", "+", "50", ",", "14", "@", "@", "static", "int", "parse_status", "(", "const", "char", "*", "value", ")", "while", "(", "*", "c", "!", "=", "'", "\\", "0", "'", ")", "{", "int", "port", ",", "status", ",", "speed", ",", "devid", ";", "unsigned", "long", "socket", ";", "int", "sockfd", ";", "char", "lbusid", "[", "SYSFS_BUS_ID_SIZE", "]", ";", "struct", "usbip_imported_device", "*", "idev", ";", "char", "hub", "[", "3", "]", ";", "ret", "=", "sscanf", "(", "c", ",", "\"", "%", "2s", "%", "d", "%", "d", "%", "d", "%", "x", "%", "lx", "%", "31s", "\\", "n", "\"", ",", "ret", "=", "sscanf", "(", "c", ",", "\"", "%", "2s", "%", "d", "%", "d", "%", "d", "%", "x", "%", "u", "%", "31s", "\\", "n", "\"", ",", "hub", ",", "&", "port", ",", "&", "status", ",", "&", "speed", ",", "&", "devid", ",", "&", "socket", ",", "lbusid", ")", ";", "&", "devid", ",", "&", "sockfd", ",", "lbusid", ")", ";", "if", "(", "ret", "<", "5", ")", "{", "dbg", "(", "\"", "sscanf", "failed", ":", "%", "d", "\"", ",", "ret", ")", ";", "@", "@", "-", "66", ",", "7", "+", "66", ",", "7", "@", "@", "static", "int", "parse_status", "(", "const", "char", "*", "value", ")", "dbg", "(", "\"", "hub", "%", "s", "port", "%", "d", "status", "%", "d", "speed", "%", "d", "devid", "%", "x", "\"", ",", "hub", ",", "port", ",", "status", ",", "speed", ",", "devid", ")", ";", "dbg", "(", "\"", "socket", "%", "lx", "lbusid", "%", "s", "\"", ",", "socket", ",", "lbusid", ")", ";", "dbg", "(", "\"", "sockfd", "%", "u", "lbusid", "%", "s", "\"", ",", "sockfd", ",", "lbusid", ")", ";", "/", "*", "if", "a", "device", "is", "connected", ",", "look", "at", "it", "*", "/", "idev", "=", "&", "vhci_driver", "-", ">", "idev", "[", "port", "]", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Use", "SnakeYAML", "SafeConstructor", "by", "default", "Overridable", "by", "setting", "a", "system", "property."], "code_tokens": ["@", "@", "-", "37", ",", "4", "+", "37", ",", "6", "@", "@", "public", "static", "StringSystemProperty", "HOST_GEO_LOOKUP_IMPL_LEGACY", "=", "new", "StringSystemProperty", "(", "\"", "brooklyn", ".", "location", ".", "geo", ".", "HostGeoLookup", "\"", ");", "public", "static", "StringSystemProperty", "HOST_GEO_LOOKUP_IMPL", "=", "new", "StringSystemProperty", "(", "\"", "org", ".", "apache", ".", "brooklyn", ".", "core", ".", "location", ".", "geo", ".", "HostGeoLookup", "\"", ");", "/", "**", "Allows", "the", "use", "of", "YAML", "tags", "to", "create", "arbitrary", "types", "known", "to", "Java", ".", "*", "/", "public", "static", "BooleanSystemProperty", "YAML_TYPE_INSTANTIATION", "=", "new", "BooleanSystemProperty", "(", "\"", "org", ".", "apache", ".", "brooklyn", ".", "unsafe", ".", "YamlTypeInstantiation", "\"", ");", "}", "@", "@", "-", "34", ",", "11", "+", "34", ",", "13", "@", "@", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "collections", ".", "MutableList", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "exceptions", ".", "Exceptions", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "exceptions", ".", "UserFacingException", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "internal", ".", "BrooklynSystemProperties", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "text", ".", "Strings", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "yaml", ".", "Yamls", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "import", "org", ".", "yaml", ".", "snakeyaml", ".", "Yaml", ";", "import", "org", ".", "yaml", ".", "snakeyaml", ".", "constructor", ".", "Constructor", ";", "import", "org", ".", "yaml", ".", "snakeyaml", ".", "constructor", ".", "SafeConstructor", ";", "import", "org", ".", "yaml", ".", "snakeyaml", ".", "error", ".", "Mark", ";", "import", "org", ".", "yaml", ".", "snakeyaml", ".", "nodes", ".", "MappingNode", ";", "import", "org", ".", "yaml", ".", "snakeyaml", ".", "nodes", ".", "Node", ";", "@", "@", "-", "54", ",", "6", "+", "56", ",", "14", "@", "@", "private", "static", "final", "Logger", "log", "=", "LoggerFactory", ".", "getLogger", "(", "Yamls", ".", "class", ")", ";", "private", "static", "Yaml", "newYaml", "(", ")", "{", "return", "new", "Yaml", "(", "BrooklynSystemProperties", ".", "YAML_TYPE_INSTANTIATION", ".", "isEnabled", "(", ")", "?", "new", "Constructor", "(", ")", "/", "/", "allows", "instantiation", "of", "arbitrary", "Java", "types", ":", "new", "SafeConstructor", "(", ")", "/", "/", "allows", "instantiation", "of", "limited", "set", "of", "types", "only", ")", ";", "}", "/", "**", "returns", "the", "given", "(", "yaml", "-", "parsed", ")", "object", "as", "the", "given", "yaml", "type", ".", "*", "<", "p", ">", "*", "if", "the", "object", "is", "an", "iterable", "or", "iterator", "this", "method", "will", "fully", "expand", "it", "as", "a", "list", ".", "@", "@", "-", "93", ",", "7", "+", "103", ",", "7", "@", "@", "*", "/", "@", "Beta", "public", "static", "Object", "getAt", "(", "String", "yaml", ",", "List", "<", "String", ">", "path", ")", "{", "Iterable", "<", "Object", ">", "result", "=", "new", "org", ".", "yaml", ".", "snakeyaml", ".", "Yaml", "(", ").", "loadAll", "(", "yaml", ")", ";", "Iterable", "<", "Object", ">", "result", "=", "newYaml", "(", ").", "loadAll", "(", "yaml", ")", ";", "Object", "current", "=", "result", ".", "iterator", "(", ").", "next", "(", ");", "return", "getAtPreParsed", "(", "current", ",", "path", ")", ";", "}", "@", "@", "-", "152", ",", "14", "+", "162", ",", "14", "@", "@", "public", "static", "void", "dump", "(", "int", "depth", ",", "Object", "r", ")", "{", "/", "**", "simplifies", "new", "Yaml", "(", ").", "loadAll", ",", "and", "converts", "to", "list", "to", "prevent", "single", "-", "use", "iterable", "bug", "in", "yaml", "*", "/", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "public", "static", "Iterable", "<", "Object", ">", "parseAll", "(", "String", "yaml", ")", "{", "Iterable", "<", "Object", ">", "result", "=", "new", "org", ".", "yaml", ".", "snakeyaml", ".", "Yaml", "(", ").", "loadAll", "(", "yaml", ")", ";", "Iterable", "<", "Object", ">", "result", "=", "newYaml", "(", ").", "loadAll", "(", "yaml", ")", ";", "return", "(", "List", "<", "Object", ">", ")", "getAs", "(", "result", ",", "List", ".", "class", ")", ";", "}", "/", "**", "as", "{", "@", "link", "#", "parseAll", "(", "String", ")", "}", "*", "/", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "public", "static", "Iterable", "<", "Object", ">", "parseAll", "(", "Reader", "yaml", ")", "{", "Iterable", "<", "Object", ">", "result", "=", "new", "org", ".", "yaml", ".", "snakeyaml", ".", "Yaml", "(", ").", "loadAll", "(", "yaml", ")", ";", "Iterable", "<", "Object", ">", "result", "=", "newYaml", "(", ").", "loadAll", "(", "yaml", ")", ";", "return", "(", "List", "<", "Object", ">", ")", "getAs", "(", "result", ",", "List", ".", "class", ")", ";", "}", "@", "@", "-", "536", ",", "7", "+", "546", ",", "7", "@", "@", "public", "static", "YamlExtract", "getTextOfYamlAtPath", "(", "String", "yaml", ",", "Object", ".", "..", "path", ")", "{", "try", "{", "int", "pathIndex", "=", "0", ";", "result", ".", "yaml", "=", "yaml", ";", "result", ".", "focus", "=", "new", "Yaml", "(", ").", "compose", "(", "new", "StringReader", "(", "yaml", ")", ");", "result", ".", "focus", "=", "newYaml", "(", ").", "compose", "(", "new", "StringReader", "(", "yaml", ")", ");", "findTextOfYamlAtPath", "(", "result", ",", "pathIndex", ",", "path", ")", ";", "return", "result", ";", "@", "@", "-", "19", ",", "18", "+", "19", ",", "20", "@", "@", "package", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "yaml", ";", "import", "static", "org", ".", "testng", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "testng", ".", "Assert", ".", "assertFalse", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "test", ".", "Asserts", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "collections", ".", "MutableList", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "exceptions", ".", "UserFacingException", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "yaml", ".", "Yamls", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "yaml", ".", "YamlsTest", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "internal", ".", "BrooklynSystemProperties", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "yaml", ".", "Yamls", ".", "YamlExtract", ";", "import", "org", ".", "testng", ".", "Assert", ";", "import", "org", ".", "testng", ".", "TestNG", ";", "import", "org", ".", "testng", ".", "annotations", ".", "Test", ";", "import", "org", ".", "yaml", ".", "snakeyaml", ".", "constructor", ".", "ConstructorException", ";", "import", "com", ".", "google", ".", "common", ".", "collect", ".", "ImmutableList", ";", "import", "com", ".", "google", ".", "common", ".", "collect", ".", "ImmutableMap", ";", "@", "@", "-", "183", ",", "6", "+", "185", ",", "22", "@", "@", "public", "void", "testExtractNoOOBE", "(", ")", "{", "}", "}", "@", "Test", "public", "void", "testSafeYaml", "(", ")", "throws", "Exception", "{", "assertFalse", "(", "BrooklynSystemProperties", ".", "YAML_TYPE_INSTANTIATION", ".", "isEnabled", "(", "),", "\"", "Set", "property", "to", "false", "(", "or", "do", "not", "set", "at", "all", ")", ":", "\"", "+", "BrooklynSystemProperties", ".", "YAML_TYPE_INSTANTIATION", ".", "getPropertyName", "(", "))", ";", "try", "{", "Yamls", ".", "parseAll", "(", "\"!", "!", "java", ".", "util", ".", "Date", "\\", "n", "\"", "\"", "date", ":", "25", "\\", "n", "\"", "\"", "month", ":", "12", "\\", "n", "\"", "\"", "year", ":", "2016", "\"", ");", "Asserts", ".", "shouldHaveFailedPreviously", "(", "\"", "Expected", "exception", ":", "\"", "+", "ConstructorException", ".", "class", ".", "getCanonicalName", "(", "))", ";", "}", "catch", "(", "ConstructorException", "e", ")", "{", "Asserts", ".", "expectedFailureContains", "(", "e", ",", "\"", "could", "not", "determine", "a", "constructor", "\"", ");", "}", "}", "/", "/", "convenience", ",", "since", "running", "with", "older", "TestNG", "IDE", "plugin", "will", "fail", "(", "older", "snakeyaml", "dependency", ")", ";", "/", "/", "if", "you", "run", "as", "a", "java", "app", "it", "doesn", "'", "t", "bring", "in", "the", "IDE", "TestNG", "jar", "version", ",", "and", "it", "works", "public", "static", "void", "main", "(", "String", "[", "]", "args", ")", "{"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Improve", "ChangeLog", "message."], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["[PATCH]", "do_coredump()", "and", "not", "stopping", "rewrite", "attacks?", "On", "Sat,", "Dec", "02,", "2006", "at", "11:47:44PM", "+0300,", "Alexey", "Dobriyan", "wrote:", ">", "David", "Binderman", "compiled", "2.6.19", "with", "icc", "and", "grepped", "for", "\"was", "set", "but", "never", ">", "used\".", "Many", "warnings", "are", "on", ">", "http://coderock.org/kj/unused-2.6.19-fs", "Heh,", "the", "very", "first", "line:", "fs/exec.c(1465):", "remark", "#593:", "variable", "\"flag\"", "was", "set", "but", "never", "used", "fs/exec.c:", "1477", "/*", "1478", "*", "We", "cannot", "trust", "fsuid", "as", "being", "the", "\"true\"", "uid", "of", "the", "1479", "*", "process", "nor", "do", "we", "know", "its", "entire", "history.", "We", "only", "know", "it", "1480", "*", "was", "tainted", "so", "we", "dump", "it", "as", "root", "in", "mode", "2.", "1481", "*/", "1482", "if", "(mm->dumpable", "==", "2)", "{", "/*", "Setuid", "core", "dump", "mode", "*/", "1483", "flag", "=", "O_EXCL;", "/*", "Stop", "rewrite", "attacks", "*/", "1484", "current->fsuid", "=", "0;", "/*", "Dump", "root", "private", "*/", "1485", "}", "And", "then", "filp_open", "follows", "with", "\"flag\"", "totally", "ignored.", "(akpm:", "this", "restores", "the", "code", "to", "Alan's", "original", "version.", "Andi's", "\"Support", "piping", "into", "commands", "in", "/proc/sys/kernel/core_pattern\"", "(cset", "d025c9db)", "broke", "it).", "Cc:", "Alan", "Cox", "<alan@lxorguk.ukuu.org.uk>", "Cc:", "<stable@kerenl.org>", "Cc:", "Andi", "Kleen", "<ak@suse.de>", "Signed-off-by:", "Andrew", "Morton", "<akpm@osdl.org>", "Signed-off-by:", "Linus", "Torvalds", "<torvalds@osdl.org>"], "code_tokens": ["@", "@", "-", "1515", ",", "7", "+", "1515", ",", "8", "@", "@", "int", "do_coredump", "(", "long", "signr", ",", "int", "exit_code", ",", "struct", "pt_regs", "*", "regs", ")", "ispipe", "=", "1", ";", "}", "else", "file", "=", "filp_open", "(", "corename", ",", "O_CREAT", "|", "2", "|", "O_NOFOLLOW", "|", "O_LARGEFILE", ",", "0600", ")", ";", "O_CREAT", "|", "2", "|", "O_NOFOLLOW", "|", "O_LARGEFILE", "|", "flag", ",", "0600", ")", ";", "if", "(", "IS_ERR", "(", "file", ")", ")", "goto", "fail_unlock", ";", "inode", "=", "file", "-", ">", "f_dentry", "-", ">", "d_inode", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["arm64:", "don't", "kill", "the", "kernel", "on", "a", "bad", "esr", "from", "el0", "Rather", "than", "completely", "killing", "the", "kernel", "if", "we", "receive", "an", "esr", "value", "we", "can't", "deal", "with", "in", "the", "el0", "handlers,", "send", "the", "process", "a", "SIGILL", "and", "log", "the", "esr", "value", "in", "the", "hope", "that", "we", "can", "debug", "it.", "If", "we", "receive", "a", "bad", "esr", "from", "el1,", "we'll", "die()", "as", "before.", "Signed-off-by:", "Mark", "Rutland", "<mark.rutland@arm.com>", "Signed-off-by:", "Catalin", "Marinas", "<catalin.marinas@arm.com>", "Cc:", "stable@vger.kernel.org"], "code_tokens": ["@", "@", "-", "311", ",", "14", "+", "311", ",", "20", "@", "@", "asmlinkage", "long", "do_ni_syscall", "(", "struct", "pt_regs", "*", "regs", ")", "*", "/", "asmlinkage", "void", "bad_mode", "(", "struct", "pt_regs", "*", "regs", ",", "int", "reason", ",", "unsigned", "int", "esr", ")", "{", "siginfo_t", "info", ";", "void", "__user", "*", "pc", "=", "(", "void", "__user", "*", ")", "instruction_pointer", "(", "regs", ")", ";", "console_verbose", "(", ");", "pr_crit", "(", "\"", "Bad", "mode", "in", "%", "s", "handler", "detected", ",", "code", "0x", "%", "08x", "\\", "n", "\"", ",", "handler", "[", "reason", "]", ",", "esr", ")", ";", "__show_regs", "(", "regs", ")", ";", "info", ".", "si_signo", "=", "SIGILL", ";", "info", ".", "si_errno", "=", "0", ";", "info", ".", "si_code", "=", "ILL_ILLOPC", ";", "info", ".", "si_addr", "=", "pc", ";", "die", "(", "\"", "Oops", "-", "bad", "mode", "\"", ",", "regs", ",", "0", ")", ";", "local_irq_disable", "(", ");", "panic", "(", "\"", "bad", "mode", "\"", ");", "arm64_notify_die", "(", "\"", "Oops", "-", "bad", "mode", "\"", ",", "regs", ",", "&", "info", ",", "0", ")", ";", "}", "void", "__pte_error", "(", "const", "char", "*", "file", ",", "int", "line", ",", "unsigned", "long", "val", ")"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Remove", "support", "for", "node10", "(#876)"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["copy_process:", "fix", "CLONE_PARENT", "&&", "parent_exec_id", "interaction", "CLONE_PARENT", "can", "fool", "the", "->self_exec_id/parent_exec_id", "logic.", "If", "we", "re-use", "the", "old", "parent,", "we", "must", "also", "re-use", "->parent_exec_id", "to", "make", "sure", "exit_notify()", "sees", "the", "right", "->xxx_exec_id's", "when", "the", "CLONE_PARENT'ed", "task", "exits.", "Also,", "move", "down", "the", "\"p->parent_exec_id", "=", "p->self_exec_id\"", "thing,", "to", "place", "two", "different", "cases", "together.", "Signed-off-by:", "Oleg", "Nesterov", "<oleg@redhat.com>", "Cc:", "Roland", "McGrath", "<roland@redhat.com>", "Cc:", "Andrew", "Morton", "<akpm@linux-foundation.org>", "Cc:", "David", "Howells", "<dhowells@redhat.com>", "Cc:", "Serge", "E.", "Hallyn", "<serge@hallyn.com>", "Signed-off-by:", "Linus", "Torvalds", "<torvalds@linux-foundation.org>"], "code_tokens": ["@", "@", "-", "1179", ",", "10", "+", "1179", ",", "6", "@", "@", "static", "struct", "task_struct", "*", "copy_process", "(", "unsigned", "long", "clone_flags", ",", "#", "endif", "clear_all_latency_tracing", "(", "p", ")", ";", "/", "*", "Our", "parent", "execution", "domain", "becomes", "current", "domain", "These", "must", "match", "for", "thread", "signalling", "to", "apply", "*", "/", "p", "-", ">", "parent_exec_id", "=", "p", "-", ">", "self_exec_id", ";", "/", "*", "ok", ",", "now", "we", "should", "be", "set", "up", ".", ".", "*", "/", "p", "-", ">", "exit_signal", "=", "(", "clone_flags", "&", "CLONE_THREAD", ")", "?", "-", "1", ":", "(", "clone_flags", "&", "CSIGNAL", ")", ";", "p", "-", ">", "pdeath_signal", "=", "0", ";", "@", "@", "-", "1220", ",", "10", "+", "1216", ",", "13", "@", "@", "static", "struct", "task_struct", "*", "copy_process", "(", "unsigned", "long", "clone_flags", ",", "set_task_cpu", "(", "p", ",", "smp_processor_id", "(", "))", ";", "/", "*", "CLONE_PARENT", "re", "-", "uses", "the", "old", "parent", "*", "/", "if", "(", "clone_flags", "&", "(", "CLONE_PARENT", "|", "CLONE_THREAD", ")", ")", "if", "(", "clone_flags", "&", "(", "CLONE_PARENT", "|", "CLONE_THREAD", ")", ")", "{", "p", "-", ">", "real_parent", "=", "current", "-", ">", "real_parent", ";", "else", "p", "-", ">", "parent_exec_id", "=", "current", "-", ">", "parent_exec_id", ";", "}", "else", "{", "p", "-", ">", "real_parent", "=", "current", ";", "p", "-", ">", "parent_exec_id", "=", "current", "-", ">", "self_exec_id", ";", "}", "spin_lock", "(", "&", "current", "-", ">", "sighand", "-", ">", "siglock", ")", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["treewide:", "Fix", "printk()", "message", "errors", "This", "patch", "fix", "spelling", "typos", "in", "printk", "and", "kconfig.", "Signed-off-by:", "Masanari", "Iida", "<standby24x7@gmail.com>", "Acked-by:", "Randy", "Dunlap", "<rdunlap@infradead.org>", "Signed-off-by:", "Jiri", "Kosina", "<jkosina@suse.cz>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["drm/i915:", "Fix", "i965", "secured", "batchbuffer", "usage", "This", "965G", "and", "above", "chipsets", "moved", "the", "batch", "buffer", "non-secure", "bits", "to", "another", "place.", "This", "means", "that", "previous", "drm's", "allowed", "in-secure", "batchbuffers", "to", "be", "submitted", "to", "the", "hardware", "from", "non-privileged", "users", "who", "are", "logged", "into", "X", "and", "and", "have", "access", "to", "direct", "rendering.", "Signed-off-by:", "Dave", "Airlie", "<airlied@redhat.com>", "Signed-off-by:", "Linus", "Torvalds", "<torvalds@linux-foundation.org>"], "code_tokens": ["@", "@", "-", "184", ",", "6", "+", "184", ",", "8", "@", "@", "static", "int", "i915_initialize", "(", "struct", "drm_device", "*", "dev", ",", "*", "private", "backbuffer", "/", "depthbuffer", "usage", ".", "*", "/", "dev_priv", "-", ">", "use_mi_batchbuffer_start", "=", "0", ";", "if", "(", "IS_I965G", "(", "dev", ")", ")", "/", "*", "965", "doesn", "'", "t", "support", "older", "method", "*", "/", "dev_priv", "-", ">", "use_mi_batchbuffer_start", "=", "1", ";", "/", "*", "Allow", "hardware", "batchbuffers", "unless", "told", "otherwise", ".", "*", "/", "@", "@", "-", "517", ",", "8", "+", "519", ",", "13", "@", "@", "static", "int", "i915_dispatch_batchbuffer", "(", "struct", "drm_device", "*", "dev", ",", "if", "(", "dev_priv", "-", ">", "use_mi_batchbuffer_start", ")", "{", "BEGIN_LP_RING", "(", "2", ")", ";", "OUT_RING", "(", "MI_BATCH_BUFFER_START", "|", "(", "2", "<", "<", "6", ")", ");", "OUT_RING", "(", "batch", "-", ">", "start", "|", "MI_BATCH_NON_SECURE", ")", ";", "if", "(", "IS_I965G", "(", "dev", ")", ")", "{", "OUT_RING", "(", "MI_BATCH_BUFFER_START", "|", "(", "2", "<", "<", "6", ")", "|", "MI_BATCH_NON_SECURE_I965", ")", ";", "OUT_RING", "(", "batch", "-", ">", "start", ")", ";", "}", "else", "{", "OUT_RING", "(", "MI_BATCH_BUFFER_START", "|", "(", "2", "<", "<", "6", ")", ");", "OUT_RING", "(", "batch", "-", ">", "start", "|", "MI_BATCH_NON_SECURE", ")", ";", "}", "ADVANCE_LP_RING", "(", ");", "}", "else", "{", "BEGIN_LP_RING", "(", "4", ")", ";", "@", "@", "-", "735", ",", "7", "+", "742", ",", "8", "@", "@", "static", "int", "i915_setparam", "(", "DRM_IOCTL_ARGS", ")", "switch", "(", "param", ".", "param", ")", "{", "case", "I915_SETPARAM_USE_MI_BATCHBUFFER_START", ":", "dev_priv", "-", ">", "use_mi_batchbuffer_start", "=", "param", ".", "value", ";", "if", "(", "!", "IS_I965G", "(", "dev", ")", ")", "dev_priv", "-", ">", "use_mi_batchbuffer_start", "=", "param", ".", "value", ";", "break", ";", "case", "I915_SETPARAM_TEX_LRU_LOG_GRANULARITY", ":", "dev_priv", "-", ">", "tex_lru_log_granularity", "=", "param", ".", "value", ";", "@", "@", "-", "282", ",", "6", "+", "282", ",", "7", "@", "@", "extern", "int", "i915_wait_ring", "(", "struct", "drm_device", "*", "dev", ",", "int", "n", ",", "const", "char", "*", "caller", ")", ";", "#", "define", "MI_BATCH_BUFFER_START", "(", "0x31", "<", "<", "23", ")", "#", "define", "MI_BATCH_BUFFER_END", "(", "0xA", "<", "<", "23", ")", "#", "define", "MI_BATCH_NON_SECURE", "(", "1", ")", "#", "define", "MI_BATCH_NON_SECURE_I965", "(", "1", "<", "<", "8", ")", "#", "define", "MI_WAIT_FOR_EVENT", "(", "(", "0x3", "<", "<", "23", ")", ")", "#", "define", "MI_WAIT_FOR_PLANE_A_FLIP", "(", "1", "<", "<", "2", ")"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Merge", "git://git.kernel.org/pub/scm/linux/kernel/git/davem/net"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Linux", "3.19"], "code_tokens": ["@", "@", "-", "1", ",", "7", "+", "1", ",", "7", "@", "@", "VERSION", "=", "3", "PATCHLEVEL", "=", "19", "SUBLEVEL", "=", "0", "EXTRAVERSION", "=", "-", "rc7", "EXTRAVERSION", "=", "NAME", "=", "Diseased", "Newt", "#", "*", "DOCUMENTATION", "*"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Improve", "validation", "of", "storage", "location", "when", "using", "FileStore."], "code_tokens": ["@", "@", "-", "33", ",", "6", "+", "33", ",", "8", "@", "@", "import", "org", ".", "apache", ".", "catalina", ".", "Globals", ";", "import", "org", ".", "apache", ".", "catalina", ".", "Session", ";", "import", "org", ".", "apache", ".", "juli", ".", "logging", ".", "Log", ";", "import", "org", ".", "apache", ".", "juli", ".", "logging", ".", "LogFactory", ";", "import", "org", ".", "apache", ".", "tomcat", ".", "util", ".", "res", ".", "StringManager", ";", "/", "**", "*", "Concrete", "implementation", "of", "the", "<", "b", ">", "Store", "<", "/", "b", ">", "interface", "that", "utilizes", "@", "@", "-", "43", ",", "6", "+", "45", ",", "10", "@", "@", "*", "/", "public", "final", "class", "FileStore", "extends", "StoreBase", "{", "private", "static", "final", "Log", "log", "=", "LogFactory", ".", "getLog", "(", "FileStore", ".", "class", ")", ";", "private", "static", "final", "StringManager", "sm", "=", "StringManager", ".", "getManager", "(", "FileStore", ".", "class", ")", ";", "/", "/", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "Constants", "/", "**", "@", "@", "-", "336", ",", "11", "+", "342", ",", "20", "@", "@", "private", "File", "directory", "(", ")", "throws", "IOException", "{", "*", "used", "in", "the", "file", "naming", ".", "*", "/", "private", "File", "file", "(", "String", "id", ")", "throws", "IOException", "{", "if", "(", "this", ".", "directory", "=", "=", "null", ")", "{", "File", "storageDir", "=", "directory", "(", ");", "if", "(", "storageDir", "=", "=", "null", ")", "{", "return", "null", ";", "}", "String", "filename", "=", "id", "+", "FILE_EXT", ";", "File", "file", "=", "new", "File", "(", "directory", "(", "),", "filename", ")", ";", "File", "file", "=", "new", "File", "(", "storageDir", ",", "filename", ")", ";", "/", "/", "Check", "the", "file", "is", "within", "the", "storage", "directory", "if", "(", "!", "file", ".", "getCanonicalPath", "(", ").", "startsWith", "(", "storageDir", ".", "getCanonicalPath", "(", "))", ")", "{", "log", ".", "warn", "(", "sm", ".", "getString", "(", "\"", "fileStore", ".", "invalid", "\"", ",", "file", ".", "getPath", "(", "),", "id", ")", ");", "return", "null", ";", "}", "return", "file", ";", "}", "}", "@", "@", "-", "29", ",", "6", "+", "29", ",", "7", "@", "@", "JDBCStore", ".", "wrongDataSource", "=", "Cannot", "open", "JNDI", "DataSource", "[", "{", "0", "}", "]", "fileStore", ".", "createFailed", "=", "Unable", "to", "create", "directory", "[", "{", "0", "}", "]", "for", "the", "storage", "of", "session", "data", "fileStore", ".", "deleteFailed", "=", "Unable", "to", "delete", "file", "[", "{", "0", "}", "]", "which", "is", "preventing", "the", "creation", "of", "the", "session", "storage", "location", "fileStore", ".", "deleteSessionFailed", "=", "Unable", "to", "delete", "file", "[", "{", "0", "}", "]", "which", "is", "no", "longer", "required", "fileStore", ".", "invalid", "=", "Invalid", "persistence", "file", "[", "{", "0", "}", "]", "for", "session", "ID", "[", "{", "1", "}", "]", "fileStore", ".", "loading", "=", "Loading", "Session", "[", "{", "0", "}", "]", "from", "file", "[", "{", "1", "}", "]", "fileStore", ".", "removing", "=", "Removing", "Session", "[", "{", "0", "}", "]", "at", "file", "[", "{", "1", "}", "]", "fileStore", ".", "saving", "=", "Saving", "Session", "[", "{", "0", "}", "]", "to", "file", "[", "{", "1", "}", "]", "@", "@", "-", "99", ",", "6", "+", "99", ",", "9", "@", "@", "replacement", "to", "<", "code", ">", ":-", "</", "code", ">", "due", "to", "possible", "conflicts", ".", "The", "syntax", "is", "now", "<", "code", ">", "${", "name", ":", "-", "default", "}", "</", "code", ">", ".", "(", "remm", ")", "<", "/", "fix", ">", "<", "add", ">", "Improve", "validation", "of", "storage", "location", "when", "using", "FileStore", ".", "(", "markt", ")", "<", "/", "add", ">", "<", "/", "changelog", ">", "<", "/", "subsection", ">", "<", "subsection", "name", "=", "\"", "Coyote", "\"", ">"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Use", "the", "new", "issue", "templates."], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["KVM:", "x86:", "Check", "non-canonical", "addresses", "upon", "WRMSR", "Upon", "WRMSR,", "the", "CPU", "should", "inject", "#GP", "if", "a", "non-canonical", "value", "(address)", "is", "written", "to", "certain", "MSRs.", "The", "behavior", "is", "\"almost\"", "identical", "for", "AMD", "and", "Intel", "(ignoring", "MSRs", "that", "are", "not", "implemented", "in", "either", "architecture", "since", "they", "would", "anyhow", "#GP).", "However,", "IA32_SYSENTER_ESP", "and", "IA32_SYSENTER_EIP", "cause", "#GP", "if", "non-canonical", "address", "is", "written", "on", "Intel", "but", "not", "on", "AMD", "(which", "ignores", "the", "top", "32-bits).", "Accordingly,", "this", "patch", "injects", "a", "#GP", "on", "the", "MSRs", "which", "behave", "identically", "on", "Intel", "and", "AMD.", "To", "eliminate", "the", "differences", "between", "the", "architecutres,", "the", "value", "which", "is", "written", "to", "IA32_SYSENTER_ESP", "and", "IA32_SYSENTER_EIP", "is", "turned", "to", "canonical", "value", "before", "writing", "instead", "of", "injecting", "a", "#GP.", "Some", "references", "from", "Intel", "and", "AMD", "manuals:", "According", "to", "Intel", "SDM", "description", "of", "WRMSR", "instruction", "#GP", "is", "expected", "on", "WRMSR", "\"If", "the", "source", "register", "contains", "a", "non-canonical", "address", "and", "ECX", "specifies", "one", "of", "the", "following", "MSRs:", "IA32_DS_AREA,", "IA32_FS_BASE,", "IA32_GS_BASE,", "IA32_KERNEL_GS_BASE,", "IA32_LSTAR,", "IA32_SYSENTER_EIP,", "IA32_SYSENTER_ESP.\"", "According", "to", "AMD", "manual", "instruction", "manual:", "LSTAR/CSTAR", "(SYSCALL):", "\"The", "WRMSR", "instruction", "loads", "the", "target", "RIP", "into", "the", "LSTAR", "and", "CSTAR", "registers.", "If", "an", "RIP", "written", "by", "WRMSR", "is", "not", "in", "canonical", "form,", "a", "general-protection", "exception", "(#GP)", "occurs.\"", "IA32_GS_BASE", "and", "IA32_FS_BASE", "(WRFSBASE/WRGSBASE):", "\"The", "address", "written", "to", "the", "base", "field", "must", "be", "in", "canonical", "form", "or", "a", "#GP", "fault", "will", "occur.\"", "IA32_KERNEL_GS_BASE", "(SWAPGS):", "\"The", "address", "stored", "in", "the", "KernelGSbase", "MSR", "must", "be", "in", "canonical", "form.\"", "This", "patch", "fixes", "CVE-2014-3610.", "Cc:", "stable@vger.kernel.org", "Signed-off-by:", "Nadav", "Amit", "<namit@cs.technion.ac.il>", "Signed-off-by:", "Paolo", "Bonzini", "<pbonzini@redhat.com>"], "code_tokens": ["@", "@", "-", "989", ",", "6", "+", "989", ",", "20", "@", "@", "static", "inline", "void", "kvm_inject_gp", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "u32", "error_code", ")", "kvm_queue_exception_e", "(", "vcpu", ",", "GP_VECTOR", ",", "error_code", ")", ";", "}", "static", "inline", "u64", "get_canonical", "(", "u64", "la", ")", "{", "return", "(", "(", "int64_t", ")", "la", "<", "<", "16", ")", ">", ">", "16", ";", "}", "static", "inline", "bool", "is_noncanonical_address", "(", "u64", "la", ")", "{", "#", "ifdef", "CONFIG_X86_64", "return", "get_canonical", "(", "la", ")", "!", "=", "la", ";", "#", "else", "return", "false", ";", "#", "endif", "}", "#", "define", "TSS_IOPB_BASE_OFFSET", "0x66", "#", "define", "TSS_BASE_SIZE", "0x68", "#", "define", "TSS_IOPB_SIZE", "(", "65536", "/", "8", ")", "@", "@", "-", "3251", ",", "7", "+", "3251", ",", "7", "@", "@", "static", "int", "wrmsr_interception", "(", "struct", "vcpu_svm", "*", "svm", ")", "msr", ".", "host_initiated", "=", "false", ";", "svm", "-", ">", "next_rip", "=", "kvm_rip_read", "(", "&", "svm", "-", ">", "vcpu", ")", "+", "2", ";", "if", "(", "svm_set_msr", "(", "&", "svm", "-", ">", "vcpu", ",", "&", "msr", ")", ")", "{", "if", "(", "kvm_set_msr", "(", "&", "svm", "-", ">", "vcpu", ",", "&", "msr", ")", ")", "{", "trace_kvm_msr_write_ex", "(", "ecx", ",", "data", ")", ";", "kvm_inject_gp", "(", "&", "svm", "-", ">", "vcpu", ",", "0", ")", ";", "}", "else", "{", "@", "@", "-", "5291", ",", "7", "+", "5291", ",", "7", "@", "@", "static", "int", "handle_wrmsr", "(", "struct", "kvm_vcpu", "*", "vcpu", ")", "msr", ".", "data", "=", "data", ";", "msr", ".", "index", "=", "ecx", ";", "msr", ".", "host_initiated", "=", "false", ";", "if", "(", "vmx_set_msr", "(", "vcpu", ",", "&", "msr", ")", "!", "=", "0", ")", "{", "if", "(", "kvm_set_msr", "(", "vcpu", ",", "&", "msr", ")", "!", "=", "0", ")", "{", "trace_kvm_msr_write_ex", "(", "ecx", ",", "data", ")", ";", "kvm_inject_gp", "(", "vcpu", ",", "0", ")", ";", "return", "1", ";", "@", "@", "-", "987", ",", "16", "+", "987", ",", "41", "@", "@", "void", "kvm_enable_efer_bits", "(", "u64", "mask", ")", "}", "EXPORT_SYMBOL_GPL", "(", "kvm_enable_efer_bits", ")", ";", "/", "*", "*", "Writes", "msr", "value", "into", "into", "the", "appropriate", "\"", "register", "\"", ".", "*", "Returns", "0", "on", "success", ",", "non", "-", "0", "otherwise", ".", "*", "Assumes", "vcpu_load", "(", ")", "was", "already", "called", ".", "*", "/", "int", "kvm_set_msr", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "struct", "msr_data", "*", "msr", ")", "{", "switch", "(", "msr", "-", ">", "index", ")", "{", "case", "MSR_FS_BASE", ":", "case", "MSR_GS_BASE", ":", "case", "MSR_KERNEL_GS_BASE", ":", "case", "MSR_CSTAR", ":", "case", "MSR_LSTAR", ":", "if", "(", "is_noncanonical_address", "(", "msr", "-", ">", "data", ")", ")", "return", "1", ";", "break", ";", "case", "MSR_IA32_SYSENTER_EIP", ":", "case", "MSR_IA32_SYSENTER_ESP", ":", "/", "*", "*", "IA32_SYSENTER_ESP", "and", "IA32_SYSENTER_EIP", "cause", "#", "GP", "if", "*", "non", "-", "canonical", "address", "is", "written", "on", "Intel", "but", "not", "on", "*", "AMD", "(", "which", "ignores", "the", "top", "32", "-", "bits", ",", "because", "it", "does", "*", "not", "implement", "64", "-", "bit", "SYSENTER", ")", ".", "*", "*", "64", "-", "bit", "code", "should", "hence", "be", "able", "to", "write", "a", "non", "-", "canonical", "*", "value", "on", "AMD", ".", "Making", "the", "address", "canonical", "ensures", "that", "*", "vmentry", "does", "not", "fail", "on", "Intel", "after", "writing", "a", "non", "-", "canonical", "*", "value", ",", "and", "that", "something", "deterministic", "happens", "if", "the", "guest", "*", "invokes", "64", "-", "bit", "SYSENTER", ".", "*", "/", "msr", "-", ">", "data", "=", "get_canonical", "(", "msr", "-", ">", "data", ")", ";", "}", "return", "kvm_x86_ops", "-", ">", "set_msr", "(", "vcpu", ",", "msr", ")", ";", "}", "EXPORT_SYMBOL_GPL", "(", "kvm_set_msr", ")", ";", "/", "*", "*", "Adapt", "set_msr", "(", ")", "to", "msr_io", "(", ")'", "s", "calling", "convention"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["tcp:", "implement", "RFC", "5961", "3.2", "Implement", "the", "RFC", "5691", "mitigation", "against", "Blind", "Reset", "attack", "using", "RST", "bit.", "Idea", "is", "to", "validate", "incoming", "RST", "sequence,", "to", "match", "RCV.NXT", "value,", "instead", "of", "previouly", "accepted", "window", ":", "(RCV.NXT", "<=", "SEG.SEQ", "<", "RCV.NXT+RCV.WND)", "If", "sequence", "is", "in", "window", "but", "not", "an", "exact", "match,", "send", "a", "\"challenge", "ACK\",", "so", "that", "the", "other", "part", "can", "resend", "an", "RST", "with", "the", "appropriate", "sequence.", "Add", "a", "new", "sysctl,", "tcp_challenge_ack_limit,", "to", "limit", "number", "of", "challenge", "ACK", "sent", "per", "second.", "Add", "a", "new", "SNMP", "counter", "to", "count", "number", "of", "challenge", "acks", "sent.", "(netstat", "-s", "|", "grep", "TCPChallengeACK)", "Signed-off-by:", "Eric", "Dumazet", "<edumazet@google.com>", "Cc:", "Kiran", "Kumar", "Kella", "<kkiran@broadcom.com>", "Signed-off-by:", "David", "S.", "Miller", "<davem@davemloft.net>"], "code_tokens": ["@", "@", "-", "565", ",", "6", "+", "565", ",", "11", "@", "@", "tcp_limit_output_bytes", "-", "INTEGER", "reduce", "the", "size", "of", "individual", "GSO", "packet", "(", "64KB", "being", "the", "max", ")", "Default", ":", "131072", "tcp_challenge_ack_limit", "-", "INTEGER", "Limits", "number", "of", "Challenge", "ACK", "sent", "per", "second", ",", "as", "recommended", "in", "RFC", "5961", "(", "Improving", "TCP", "'", "s", "Robustness", "to", "Blind", "In", "-", "Window", "Attacks", ")", "Default", ":", "100", "UDP", "variables", ":", "udp_mem", "-", "vector", "of", "3", "INTEGERs", ":", "min", ",", "pressure", ",", "max", "@", "@", "-", "237", ",", "6", "+", "237", ",", "7", "@", "@", "enum", "LINUX_MIB_TCPOFOQUEUE", ",", "/", "*", "TCPOFOQueue", "*", "/", "LINUX_MIB_TCPOFODROP", ",", "/", "*", "TCPOFODrop", "*", "/", "LINUX_MIB_TCPOFOMERGE", ",", "/", "*", "TCPOFOMerge", "*", "/", "LINUX_MIB_TCPCHALLENGEACK", ",", "/", "*", "TCPChallengeACK", "*", "/", "__LINUX_MIB_MAX", "}", ";", "@", "@", "-", "254", ",", "6", "+", "254", ",", "7", "@", "@", "extern", "int", "sysctl_tcp_thin_linear_timeouts", ";", "extern", "int", "sysctl_tcp_thin_dupack", ";", "extern", "int", "sysctl_tcp_early_retrans", ";", "extern", "int", "sysctl_tcp_limit_output_bytes", ";", "extern", "int", "sysctl_tcp_challenge_ack_limit", ";", "extern", "atomic_long_t", "tcp_memory_allocated", ";", "extern", "struct", "percpu_counter", "tcp_sockets_allocated", ";", "@", "@", "-", "261", ",", "6", "+", "261", ",", "7", "@", "@", "static", "const", "struct", "snmp_mib", "snmp4_net_list", "[", "]", "=", "{", "SNMP_MIB_ITEM", "(", "\"", "TCPOFOQueue", "\"", ",", "LINUX_MIB_TCPOFOQUEUE", ")", ",", "SNMP_MIB_ITEM", "(", "\"", "TCPOFODrop", "\"", ",", "LINUX_MIB_TCPOFODROP", ")", ",", "SNMP_MIB_ITEM", "(", "\"", "TCPOFOMerge", "\"", ",", "LINUX_MIB_TCPOFOMERGE", ")", ",", "SNMP_MIB_ITEM", "(", "\"", "TCPChallengeACK", "\"", ",", "LINUX_MIB_TCPCHALLENGEACK", ")", ",", "SNMP_MIB_SENTINEL", "}", ";", "@", "@", "-", "605", ",", "6", "+", "605", ",", "13", "@", "@", "static", "struct", "ctl_table", "ipv4_table", "[", "]", "=", "{", ".", "mode", "=", "0644", ",", ".", "proc_handler", "=", "proc_dointvec", "}", ",", "{", ".", "procname", "=", "\"", "tcp_challenge_ack_limit", "\"", ",", ".", "data", "=", "&", "sysctl_tcp_challenge_ack_limit", ",", ".", "maxlen", "=", "sizeof", "(", "int", ")", ",", ".", "mode", "=", "0644", ",", ".", "proc_handler", "=", "proc_dointvec", "}", ",", "#", "ifdef", "CONFIG_NET_DMA", "{", ".", "procname", "=", "\"", "tcp_dma_copybreak", "\"", ",", "@", "@", "-", "88", ",", "6", "+", "88", ",", "9", "@", "@", "int", "sysctl_tcp_app_win", "__read_mostly", "=", "31", ";", "int", "sysctl_tcp_adv_win_scale", "__read_mostly", "=", "1", ";", "EXPORT_SYMBOL", "(", "sysctl_tcp_adv_win_scale", ")", ";", "/", "*", "rfc5961", "challenge", "ack", "rate", "limiting", "*", "/", "int", "sysctl_tcp_challenge_ack_limit", "=", "100", ";", "int", "sysctl_tcp_stdurg", "__read_mostly", ";", "int", "sysctl_tcp_rfc1337", "__read_mostly", ";", "int", "sysctl_tcp_max_orphans", "__read_mostly", "=", "NR_FILE", ";", "@", "@", "-", "5247", ",", "6", "+", "5250", ",", "23", "@", "@", "static", "bool", "tcp_dma_try_early_copy", "(", "struct", "sock", "*", "sk", ",", "struct", "sk_buff", "*", "skb", ",", "}", "#", "endif", "/", "*", "CONFIG_NET_DMA", "*", "/", "static", "void", "tcp_send_challenge_ack", "(", "struct", "sock", "*", "sk", ")", "{", "/", "*", "unprotected", "vars", ",", "we", "dont", "care", "of", "overwrites", "*", "/", "static", "u32", "challenge_timestamp", ";", "static", "unsigned", "int", "challenge_count", ";", "u32", "now", "=", "jiffies", "/", "HZ", ";", "if", "(", "now", "!", "=", "challenge_timestamp", ")", "{", "challenge_timestamp", "=", "now", ";", "challenge_count", "=", "0", ";", "}", "if", "(", "++", "challenge_count", "<", "=", "sysctl_tcp_challenge_ack_limit", ")", "{", "NET_INC_STATS_BH", "(", "sock_net", "(", "sk", ")", ",", "LINUX_MIB_TCPCHALLENGEACK", ")", ";", "tcp_send_ack", "(", "sk", ")", ";", "}", "}", "/", "*", "Does", "PAWS", "and", "seqno", "based", "validation", "of", "an", "incoming", "segment", ",", "flags", "will", "*", "play", "significant", "role", "here", ".", "*", "/", "@", "@", "-", "5283", ",", "7", "+", "5303", ",", "16", "@", "@", "static", "int", "tcp_validate_incoming", "(", "struct", "sock", "*", "sk", ",", "struct", "sk_buff", "*", "skb", ",", "/", "*", "Step", "2", ":", "check", "RST", "bit", "*", "/", "if", "(", "th", "-", ">", "rst", ")", "{", "tcp_reset", "(", "sk", ")", ";", "/", "*", "RFC", "5961", "3", ".", "2", ":", "*", "If", "sequence", "number", "exactly", "matches", "RCV", ".", "NXT", ",", "then", "*", "RESET", "the", "connection", "*", "else", "*", "Send", "a", "challenge", "ACK", "*", "/", "if", "(", "TCP_SKB_CB", "(", "skb", ")", "->", "seq", "=", "=", "tp", "-", ">", "rcv_nxt", ")", "tcp_reset", "(", "sk", ")", ";", "else", "tcp_send_challenge_ack", "(", "sk", ")", ";", "goto", "discard", ";", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Sanity", "check", "ticket", "length.", "If", "a", "ticket", "callback", "changes", "the", "HMAC", "digest", "to", "SHA512", "the", "existing", "sanity", "checks", "are", "not", "sufficient", "and", "an", "attacker", "could", "perform", "a", "DoS", "attack", "with", "a", "malformed", "ticket.", "Add", "additional", "checks", "based", "on", "HMAC", "size.", "Thanks", "to", "Shi", "Lei", "for", "reporting", "this", "bug.", "CVE-2016-6302", "Reviewed-by:", "Viktor", "Dukhovni", "<viktor@openssl.org>"], "code_tokens": ["@", "@", "-", "2969", ",", "9", "+", "2969", ",", "7", "@", "@", "static", "int", "tls_decrypt_ticket", "(", "SSL", "*", "s", ",", "const", "unsigned", "char", "*", "etick", ",", "HMAC_CTX", "*", "hctx", "=", "NULL", ";", "EVP_CIPHER_CTX", "*", "ctx", ";", "SSL_CTX", "*", "tctx", "=", "s", "-", ">", "initial_ctx", ";", "/", "*", "Need", "at", "least", "keyname", "+", "iv", "+", "some", "encrypted", "data", "*", "/", "if", "(", "eticklen", "<", "48", ")", "return", "2", ";", "/", "*", "Initialize", "session", "ticket", "encryption", "and", "HMAC", "contexts", "*", "/", "hctx", "=", "HMAC_CTX_new", "(", ");", "if", "(", "hctx", "=", "=", "NULL", ")", "@", "@", "-", "3018", ",", "6", "+", "3016", ",", "12", "@", "@", "static", "int", "tls_decrypt_ticket", "(", "SSL", "*", "s", ",", "const", "unsigned", "char", "*", "etick", ",", "if", "(", "mlen", "<", "0", ")", "{", "goto", "err", ";", "}", "/", "*", "Sanity", "check", "ticket", "length", ":", "must", "exceed", "keyname", "+", "IV", "+", "HMAC", "*", "/", "if", "(", "eticklen", "<", "=", "TLSEXT_KEYNAME_LENGTH", "+", "EVP_CIPHER_CTX_iv_length", "(", "ctx", ")", "+", "mlen", ")", "{", "ret", "=", "2", ";", "goto", "err", ";", "}", "eticklen", "-", "=", "mlen", ";", "/", "*", "Check", "HMAC", "of", "encrypted", "ticket", "*", "/", "if", "(", "HMAC_Update", "(", "hctx", ",", "etick", ",", "eticklen", ")", "<", "=", "0"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["xfs:", "prevent", "reading", "uninitialized", "stack", "memory", "The", "XFS_IOC_FSGETXATTR", "ioctl", "allows", "unprivileged", "users", "to", "read", "12", "bytes", "of", "uninitialized", "stack", "memory,", "because", "the", "fsxattr", "struct", "declared", "on", "the", "stack", "in", "xfs_ioc_fsgetxattr()", "does", "not", "alter", "(or", "zero)", "the", "12-byte", "fsx_pad", "member", "before", "copying", "it", "back", "to", "the", "user.", "This", "patch", "takes", "care", "of", "it.", "Signed-off-by:", "Dan", "Rosenberg", "<dan.j.rosenberg@gmail.com>", "Reviewed-by:", "Eric", "Sandeen", "<sandeen@redhat.com>", "Signed-off-by:", "Alex", "Elder", "<aelder@sgi.com>"], "code_tokens": ["@", "@", "-", "785", ",", "6", "+", "785", ",", "8", "@", "@", "xfs_ioc_fsgetxattr", "(", "{", "struct", "fsxattr", "fa", ";", "memset", "(", "&", "fa", ",", "0", ",", "sizeof", "(", "struct", "fsxattr", ")", ");", "xfs_ilock", "(", "ip", ",", "XFS_ILOCK_SHARED", ")", ";", "fa", ".", "fsx_xflags", "=", "xfs_ip2xflags", "(", "ip", ")", ";", "fa", ".", "fsx_extsize", "=", "ip", "-", ">", "i_d", ".", "di_extsize", "<", "<", "ip", "-", ">", "i_mount", "-", ">", "m_sb", ".", "sb_blocklog", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Set", "max", "P", "to", "2^32", "-", "256"], "code_tokens": ["@", "@", "-", "177", ",", "7", "+", "177", ",", "7", "@", "@", "else", "if", "(", "this", ".", "H", "=", "=", "null", ")", "this", ".", "atLength", "=", "0", ";", "this", ".", "atLengthPre", "=", "0", ";", "this", ".", "counter", "=", "Arrays", ".", "clone", "(", "J0", ")", ";", "this", ".", "blocksRemaining", "=", "-", "1", ";", "this", ".", "blocksRemaining", "=", "-", "2", ";", "/", "/", "page", "8", ",", "len", "(", "P", ")", "<", "=", "2", "^", "39", "-", "256", "this", ".", "bufOff", "=", "0", ";", "this", ".", "totalLength", "=", "0", ";", "@", "@", "-", "458", ",", "7", "+", "458", ",", "7", "@", "@", "private", "void", "reset", "(", "atLength", "=", "0", ";", "atLengthPre", "=", "0", ";", "counter", "=", "Arrays", ".", "clone", "(", "J0", ")", ";", "blocksRemaining", "=", "-", "1", ";", "blocksRemaining", "=", "-", "2", ";", "bufOff", "=", "0", ";", "totalLength", "=", "0", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["powerpc/fsl/dts:", "add", "FMan", "node", "for", "t1042d4rdb", "Signed-off-by:", "Madalin", "Bucur", "<madalin.bucur@nxp.com>", "Signed-off-by:", "Scott", "Wood", "<oss@buserror.net>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["usermodehelper:", "implement", "UMH_KILLABLE", "Implement", "UMH_KILLABLE,", "should", "be", "used", "along", "with", "UMH_WAIT_EXEC/PROC.", "The", "caller", "must", "ensure", "that", "subprocess_info->path/etc", "can", "not", "go", "away", "until", "call_usermodehelper_freeinfo().", "call_usermodehelper_exec(UMH_KILLABLE)", "does", "wait_for_completion_killable.", "If", "it", "fails,", "it", "uses", "xchg(&sub_info->complete,", "NULL)", "to", "serialize", "with", "umh_complete()", "which", "does", "the", "same", "xhcg()", "to", "access", "sub_info->complete.", "If", "call_usermodehelper_exec", "wins,", "it", "can", "safely", "return.", "umh_complete()", "should", "get", "NULL", "and", "call", "call_usermodehelper_freeinfo().", "Otherwise", "we", "know", "that", "umh_complete()", "was", "already", "called,", "in", "this", "case", "call_usermodehelper_exec()", "falls", "back", "to", "wait_for_completion()", "which", "should", "succeed", "\"very", "soon\".", "Note:", "UMH_NO_WAIT", "==", "-1", "but", "it", "obviously", "should", "not", "be", "used", "with", "UMH_KILLABLE.", "We", "delay", "the", "neccessary", "cleanup", "to", "simplify", "the", "back", "porting.", "Signed-off-by:", "Oleg", "Nesterov", "<oleg@redhat.com>", "Cc:", "Tetsuo", "Handa", "<penguin-kernel@I-love.SAKURA.ne.jp>", "Cc:", "Rusty", "Russell", "<rusty@rustcorp.com.au>", "Cc:", "Tejun", "Heo", "<tj@kernel.org>", "Cc:", "David", "Rientjes", "<rientjes@google.com>", "Signed-off-by:", "Andrew", "Morton", "<akpm@linux-foundation.org>", "Signed-off-by:", "Linus", "Torvalds", "<torvalds@linux-foundation.org>"], "code_tokens": ["@", "@", "-", "54", ",", "6", "+", "54", ",", "8", "@", "@", "enum", "umh_wait", "{", "UMH_WAIT_PROC", "=", "1", ",", "/", "*", "wait", "for", "the", "process", "to", "complete", "*", "/", "}", ";", "#", "define", "UMH_KILLABLE", "4", "/", "*", "wait", "for", "EXEC", "/", "PROC", "killable", "*", "/", "struct", "subprocess_info", "{", "struct", "work_struct", "work", ";", "struct", "completion", "*", "complete", ";", "@", "@", "-", "201", ",", "7", "+", "201", ",", "15", "@", "@", "EXPORT_SYMBOL", "(", "call_usermodehelper_freeinfo", ")", ";", "static", "void", "umh_complete", "(", "struct", "subprocess_info", "*", "sub_info", ")", "{", "complete", "(", "sub_info", "-", ">", "complete", ")", ";", "struct", "completion", "*", "comp", "=", "xchg", "(", "&", "sub_info", "-", ">", "complete", ",", "NULL", ")", ";", "/", "*", "*", "See", "call_usermodehelper_exec", "(", ").", "If", "xchg", "(", ")", "returns", "NULL", "*", "we", "own", "sub_info", ",", "the", "UMH_KILLABLE", "caller", "has", "gone", "away", ".", "*", "/", "if", "(", "comp", ")", "complete", "(", "comp", ")", ";", "else", "call_usermodehelper_freeinfo", "(", "sub_info", ")", ";", "}", "/", "*", "Keventd", "can", "'", "t", "block", ",", "but", "this", "(", "a", "child", ")", "can", ".", "*", "/", "@", "@", "-", "252", ",", "6", "+", "260", ",", "9", "@", "@", "static", "void", "__call_usermodehelper", "(", "struct", "work_struct", "*", "work", ")", "enum", "umh_wait", "wait", "=", "sub_info", "-", ">", "wait", ";", "pid_t", "pid", ";", "if", "(", "wait", "!", "=", "UMH_NO_WAIT", ")", "wait", "&", "=", "~", "UMH_KILLABLE", ";", "/", "*", "CLONE_VFORK", ":", "wait", "until", "the", "usermode", "helper", "has", "execve", "'", "d", "*", "successfully", "We", "need", "the", "data", "structures", "to", "stay", "around", "*", "until", "that", "is", "done", ".", "*", "/", "@", "@", "-", "461", ",", "9", "+", "472", ",", "21", "@", "@", "int", "call_usermodehelper_exec", "(", "struct", "subprocess_info", "*", "sub_info", ",", "queue_work", "(", "khelper_wq", ",", "&", "sub_info", "-", ">", "work", ")", ";", "if", "(", "wait", "=", "=", "UMH_NO_WAIT", ")", "/", "*", "task", "has", "freed", "sub_info", "*", "/", "goto", "unlock", ";", "if", "(", "wait", "&", "UMH_KILLABLE", ")", "{", "retval", "=", "wait_for_completion_killable", "(", "&", "done", ")", ";", "if", "(", "!", "retval", ")", "goto", "wait_done", ";", "/", "*", "umh_complete", "(", ")", "will", "see", "NULL", "and", "free", "sub_info", "*", "/", "if", "(", "xchg", "(", "&", "sub_info", "-", ">", "complete", ",", "NULL", ")", ")", "goto", "unlock", ";", "/", "*", "fallthrough", ",", "umh_complete", "(", ")", "was", "already", "called", "*", "/", "}", "wait_for_completion", "(", "&", "done", ")", ";", "wait_done", ":", "retval", "=", "sub_info", "-", ">", "retval", ";", "out", ":", "call_usermodehelper_freeinfo", "(", "sub_info", ")", ";", "unlock", ":"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["v2.26.0"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["scripts/bloat-o-meter:", "compile", ".NUMBER", "regex", "Every", "often", "used", "regex", "is", "better", "be", "compiled", "in", "Python.", "Speedup", "is", "about", "~9.8%", "(whee!)", "$", "perf", "stat", "-r", "16", "taskset", "-c", "15", "./scripts/bloat-o-meter", "../vmlinux-000", "../obj/vmlinux", ">/dev/null", "7.091202853", "seconds", "time", "elapsed", "(", "+-", "0.15%", ")", "+re.compile", "6.397564973", "seconds", "time", "elapsed", "(", "+-", "0.34%", ")", "Link:", "http://lkml.kernel.org/r/20161119004417.GB1200@avx2", "Signed-off-by:", "Alexey", "Dobriyan", "<adobriyan@gmail.com>", "Signed-off-by:", "Andrew", "Morton", "<akpm@linux-foundation.org>", "Signed-off-by:", "Linus", "Torvalds", "<torvalds@linux-foundation.org>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["plistutil:", "Prevent", "OOB", "heap", "buffer", "read", "by", "checking", "input", "size", "As", "pointed", "out", "in", "#87", "plistutil", "would", "do", "a", "memcmp", "with", "a", "heap", "buffer", "without", "checking", "the", "size.", "If", "the", "size", "is", "less", "than", "8", "it", "would", "read", "beyond", "the", "bounds", "of", "this", "heap", "buffer.", "This", "commit", "prevents", "that."], "code_tokens": ["@", "@", "-", "129", ",", "6", "+", "129", ",", "12", "@", "@", "int", "main", "(", "int", "argc", ",", "char", "*", "argv", "[", "])", "}", "stat", "(", "options", "-", ">", "in_file", ",", "&", "filestats", ")", ";", "if", "(", "filestats", ".", "st_size", "<", "8", ")", "{", "printf", "(", "\"", "ERROR", ":", "Input", "file", "is", "too", "small", "to", "contain", "valid", "plist", "data", ".", "\\", "n", "\"", ");", "return", "-", "1", ";", "}", "plist_entire", "=", "(", "char", "*", ")", "malloc", "(", "sizeof", "(", "char", ")", "*", "(", "filestats", ".", "st_size", "+", "1", ")", ");", "read_size", "=", "fread", "(", "plist_entire", ",", "sizeof", "(", "char", ")", ",", "filestats", ".", "st_size", ",", "iplist", ")", ";", "fclose", "(", "iplist", ")", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["ima:", "store", "the", "builtin/custom", "template", "definitions", "in", "a", "list", "The", "builtin", "and", "single", "custom", "templates", "are", "currently", "stored", "in", "an", "array.", "In", "preparation", "for", "being", "able", "to", "restore", "a", "measurement", "list", "containing", "multiple", "builtin/custom", "templates,", "this", "patch", "stores", "the", "builtin", "and", "custom", "templates", "as", "a", "linked", "list.", "This", "will", "permit", "defining", "more", "than", "one", "custom", "template", "per", "boot.", "Link:", "http://lkml.kernel.org/r/1480554346-29071-8-git-send-email-zohar@linux.vnet.ibm.com", "Signed-off-by:", "Mimi", "Zohar", "<zohar@linux.vnet.ibm.com>", "Acked-by:", "Dmitry", "Kasatkin", "<dmitry.kasatkin@gmail.com>", "Cc:", "Thiago", "Jung", "Bauermann", "<bauerman@linux.vnet.ibm.com>", "Cc:", "\"Eric", "W.", "Biederman\"", "<ebiederm@xmission.com>", "Cc:", "Andreas", "Steffen", "<andreas.steffen@strongswan.org>", "Cc:", "Josh", "Sklar", "<sklar@linux.vnet.ibm.com>", "Cc:", "Dave", "Young", "<dyoung@redhat.com>", "Cc:", "Vivek", "Goyal", "<vgoyal@redhat.com>", "Cc:", "Baoquan", "He", "<bhe@redhat.com>", "Cc:", "Michael", "Ellerman", "<mpe@ellerman.id.au>", "Cc:", "Benjamin", "Herrenschmidt", "<benh@kernel.crashing.org>", "Cc:", "Paul", "Mackerras", "<paulus@samba.org>", "Cc:", "Stewart", "Smith", "<stewart@linux.vnet.ibm.com>", "Signed-off-by:", "Andrew", "Morton", "<akpm@linux-foundation.org>", "Signed-off-by:", "Linus", "Torvalds", "<torvalds@linux-foundation.org>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["fix:", "use", "correct", "userData", "path", "when", "unbundled", "(#30113)"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["asn1:", "additional", "sanity", "checking", "during", "BER", "decoding", "-", "Don't", "trust", "a", "length", "which", "is", "greater", "than", "the", "working", "buffer.", "An", "invalid", "length", "could", "cause", "overflow", "when", "calculating", "buffer", "size", "for", "decoding", "oid.", "-", "An", "oid", "length", "of", "zero", "is", "invalid", "and", "allows", "for", "an", "off-by-one", "error", "when", "decoding", "oid", "because", "the", "first", "subid", "actually", "encodes", "first", "2", "subids.", "-", "A", "primitive", "encoding", "may", "not", "have", "an", "indefinite", "length.", "Thanks", "to", "Wei", "Wang", "from", "McAfee", "for", "report.", "Cc:", "Steven", "French", "<sfrench@us.ibm.com>", "Cc:", "stable@kernel.org", "Acked-by:", "Patrick", "McHardy", "<kaber@trash.net>", "Signed-off-by:", "Chris", "Wright", "<chrisw@sous-sol.org>", "Signed-off-by:", "Linus", "Torvalds", "<torvalds@linux-foundation.org>"], "code_tokens": ["@", "@", "-", "186", ",", "6", "+", "186", ",", "11", "@", "@", "asn1_length_decode", "(", "struct", "asn1_ctx", "*", "ctx", ",", "unsigned", "int", "*", "def", ",", "unsigned", "int", "*", "len", ")", "}", "}", "}", "/", "*", "don", "'", "t", "trust", "len", "bigger", "than", "ctx", "buffer", "*", "/", "if", "(", "*", "len", ">", "ctx", "-", ">", "end", "-", "ctx", "-", ">", "pointer", ")", "return", "0", ";", "return", "1", ";", "}", "@", "@", "-", "203", ",", "6", "+", "208", ",", "10", "@", "@", "asn1_header_decode", "(", "struct", "asn1_ctx", "*", "ctx", ",", "if", "(", "!", "asn1_length_decode", "(", "ctx", ",", "&", "def", ",", "&", "len", ")", ")", "return", "0", ";", "/", "*", "primitive", "shall", "be", "definite", ",", "indefinite", "shall", "be", "constructed", "*", "/", "if", "(", "*", "con", "=", "=", "ASN1_PRI", "&", "&", "!", "def", ")", "return", "0", ";", "if", "(", "def", ")", "*", "eoc", "=", "ctx", "-", ">", "pointer", "+", "len", ";", "else", "@", "@", "-", "389", ",", "6", "+", "398", ",", "11", "@", "@", "asn1_oid_decode", "(", "struct", "asn1_ctx", "*", "ctx", ",", "unsigned", "long", "*", "optr", ";", "size", "=", "eoc", "-", "ctx", "-", ">", "pointer", "+", "1", ";", "/", "*", "first", "subid", "actually", "encodes", "first", "two", "subids", "*", "/", "if", "(", "size", "<", "2", "|", "|", "size", ">", "ULONG_MAX", "/", "sizeof", "(", "unsigned", "long", ")", ")", "return", "0", ";", "*", "oid", "=", "kmalloc", "(", "size", "*", "sizeof", "(", "unsigned", "long", ")", ",", "GFP_ATOMIC", ")", ";", "if", "(", "*", "oid", "=", "=", "NULL", ")", "return", "0", ";", "@", "@", "-", "232", ",", "6", "+", "232", ",", "11", "@", "@", "static", "unsigned", "char", "asn1_length_decode", "(", "struct", "asn1_ctx", "*", "ctx", ",", "}", "}", "}", "/", "*", "don", "'", "t", "trust", "len", "bigger", "than", "ctx", "buffer", "*", "/", "if", "(", "*", "len", ">", "ctx", "-", ">", "end", "-", "ctx", "-", ">", "pointer", ")", "return", "0", ";", "return", "1", ";", "}", "@", "@", "-", "250", ",", "6", "+", "255", ",", "10", "@", "@", "static", "unsigned", "char", "asn1_header_decode", "(", "struct", "asn1_ctx", "*", "ctx", ",", "if", "(", "!", "asn1_length_decode", "(", "ctx", ",", "&", "def", ",", "&", "len", ")", ")", "return", "0", ";", "/", "*", "primitive", "shall", "be", "definite", ",", "indefinite", "shall", "be", "constructed", "*", "/", "if", "(", "*", "con", "=", "=", "ASN1_PRI", "&", "&", "!", "def", ")", "return", "0", ";", "if", "(", "def", ")", "*", "eoc", "=", "ctx", "-", ">", "pointer", "+", "len", ";", "else", "@", "@", "-", "434", ",", "6", "+", "443", ",", "11", "@", "@", "static", "unsigned", "char", "asn1_oid_decode", "(", "struct", "asn1_ctx", "*", "ctx", ",", "unsigned", "long", "*", "optr", ";", "size", "=", "eoc", "-", "ctx", "-", ">", "pointer", "+", "1", ";", "/", "*", "first", "subid", "actually", "encodes", "first", "two", "subids", "*", "/", "if", "(", "size", "<", "2", "|", "|", "size", ">", "ULONG_MAX", "/", "sizeof", "(", "unsigned", "long", ")", ")", "return", "0", ";", "*", "oid", "=", "kmalloc", "(", "size", "*", "sizeof", "(", "unsigned", "long", ")", ",", "GFP_ATOMIC", ")", ";", "if", "(", "*", "oid", "=", "=", "NULL", ")", "{", "if", "(", "net_ratelimit", "(", "))"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["https://bugs.launchpad.net/ubuntu/+source/imagemagick/+bug/1537213"], "code_tokens": ["@", "@", "-", "723", ",", "7", "+", "723", ",", "8", "@", "@", "static", "MagickBooleanType", "WriteHDRImage", "(", "const", "ImageInfo", "*", "image_info", ",", "Image", "*", "image", ",", "}", "if", "(", "image", "-", ">", "gamma", "!", "=", "0", ".", "0", ")", "{", "count", "=", "FormatLocaleString", "(", "header", ",", "MagickPathExtent", ",", "\"", "GAMMA", "=", "%", "g", "\\", "n", "\"", ",", "image", "-", ">", "gamma", ")", ";", "count", "=", "FormatLocaleString", "(", "header", ",", "MagickPathExtent", ",", "\"", "GAMMA", "=", "%", "g", "\\", "n", "\"", ",", "image", "-", ">", "gamma", ")", ";", "(", "void", ")", "WriteBlob", "(", "image", ",", "(", "size_t", ")", "count", ",", "(", "unsigned", "char", "*", ")", "header", ")", ";", "}", "count", "=", "FormatLocaleString", "(", "header", ",", "MagickPathExtent", ",", "@", "@", "-", "741", ",", "10", "+", "742", ",", "11", "@", "@", "static", "MagickBooleanType", "WriteHDRImage", "(", "const", "ImageInfo", "*", "image_info", ",", "Image", "*", "image", ",", "/", "*", "Write", "HDR", "pixels", ".", "*", "/", "pixels", "=", "(", "unsigned", "char", "*", ")", "AcquireQuantumMemory", "(", "image", "-", ">", "columns", ",", "4", "*", "pixels", "=", "(", "unsigned", "char", "*", ")", "AcquireQuantumMemory", "(", "image", "-", ">", "columns", "+", "128", ",", "4", "*", "sizeof", "(", "*", "pixels", ")", ");", "if", "(", "pixels", "=", "=", "(", "unsigned", "char", "*", ")", "NULL", ")", "ThrowWriterException", "(", "ResourceLimitError", ",", "\"", "MemoryAllocationFailed", "\"", ");", "(", "void", ")", "ResetMagickMemory", "(", "pixels", ",", "0", ",", "4", "*", "(", "image", "-", ">", "columns", "+", "128", ")", "*", "sizeof", "(", "*", "pixels", ")", ");", "for", "(", "y", "=", "0", ";", "y", "<", "(", "ssize_t", ")", "image", "-", ">", "rows", ";", "y", "+", "+)", "{", "p", "=", "GetVirtualPixels", "(", "image", ",", "0", ",", "y", ",", "image", "-", ">", "columns", ",", "1", ",", "exception", ")", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Update", "dependencies", "to", "fix", "security", "vulnerability."], "code_tokens": ["@", "@", "-", "121", ",", "11", "+", "121", ",", "12", "@", "@", "<", "scope", ">", "test", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "hibernate", "<", "/", "groupId", ">", "<", "artifactId", ">", "hibernate", "-", "validator", "<", "/", "artifactId", ">", "<", "groupId", ">", "org", ".", "apache", ".", "bval", "<", "/", "groupId", ">", "<", "artifactId", ">", "bval", "-", "jsr", "<", "/", "artifactId", ">", "<", "version", ">", "1", ".", "1", ".", "2", "<", "/", "version", ">", "<", "!-", "-", "The", "Hibernate", "dependency", "is", "no", "longer", "used", ",", "due", "to", "security", "vulnerabilities", "-", "->", "<", "!-", "-", "https", ":", "//", "stackoverflow", ".", "com", "/", "questions", "/", "48323244", "/", "java", "-", "lang", "-", "nosuchmethoderror", "-", "javax", "-", "validation", "-", "bootstrapconfiguration", "-", "getclockproExecutionTimeQuartzIntegrationTest", "-", "->", "<", "!-", "-", "https", ":", "//", "stackoverflow", ".", "com", "/", "questions", "/", "24386771", "/", "javax", "-", "validation", "-", "validationexception", "-", "hv000183", "-", "unable", "-", "to", "-", "load", "-", "javax", "-", "el", "-", "express", "-", "->", "<", "version", ">", "5", ".", "3", ".", "6", ".", "Final", "<", "/", "version", ">", "<", "scope", ">", "test", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "dependency", ">"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["[DROOLS-6415]", "Impact", "Analysis", ":", "analyze", "modified", "map", "key/value", "(#3739)", "*", "[DROOLS-6415]", "Impact", "Analysis", ":", "analyze", "modified", "map", "key/value", "*", "-", "minor", "improvement", "and", "sonarLint", "fix"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["setup_arg_pages:", "diagnose", "excessive", "argument", "size", "The", "CONFIG_STACK_GROWSDOWN", "variant", "of", "setup_arg_pages()", "does", "not", "check", "the", "size", "of", "the", "argument/environment", "area", "on", "the", "stack.", "When", "it", "is", "unworkably", "large,", "shift_arg_pages()", "hits", "its", "BUG_ON.", "This", "is", "exploitable", "with", "a", "very", "large", "RLIMIT_STACK", "limit,", "to", "create", "a", "crash", "pretty", "easily.", "Check", "that", "the", "initial", "stack", "is", "not", "too", "large", "to", "make", "it", "possible", "to", "map", "in", "any", "executable.", "We're", "not", "checking", "that", "the", "actual", "executable", "(or", "intepreter,", "for", "binfmt_elf)", "will", "fit.", "So", "those", "mappings", "might", "clobber", "part", "of", "the", "initial", "stack", "mapping.", "But", "that", "is", "just", "userland", "lossage", "that", "userland", "made", "happen,", "not", "a", "kernel", "problem.", "Signed-off-by:", "Roland", "McGrath", "<roland@redhat.com>", "Reviewed-by:", "KOSAKI", "Motohiro", "<kosaki.motohiro@jp.fujitsu.com>", "Signed-off-by:", "Linus", "Torvalds", "<torvalds@linux-foundation.org>"], "code_tokens": ["@", "@", "-", "594", ",", "6", "+", "594", ",", "11", "@", "@", "int", "setup_arg_pages", "(", "struct", "linux_binprm", "*", "bprm", ",", "#", "else", "stack_top", "=", "arch_align_stack", "(", "stack_top", ")", ";", "stack_top", "=", "PAGE_ALIGN", "(", "stack_top", ")", ";", "if", "(", "unlikely", "(", "stack_top", "<", "mmap_min_addr", ")", "|", "|", "unlikely", "(", "vma", "-", ">", "vm_end", "-", "vma", "-", ">", "vm_start", ">", "=", "stack_top", "-", "mmap_min_addr", ")", ")", "return", "-", "ENOMEM", ";", "stack_shift", "=", "vma", "-", ">", "vm_end", "-", "stack_top", ";", "bprm", "-", ">", "p", "-", "=", "stack_shift", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["eliminate", "compiler", "warning"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Prevent", "buffer", "overflow", "in", "SIXEL,", "PDB,", "MAP,", "and", "CALS", "coders", "(bug", "report", "from", "Donghai", "Zhu)"], "code_tokens": ["@", "@", "-", "3", ",", "6", "+", "3", ",", "8", "@", "@", "pwchen", "&", "rayzhong", "of", "tencent", ")", ".", "*", "Fix", "MSVG", "regression", "(", "reference", "https", ":", "//", "github", ".", "com", "/", "ImageMagick", "/", "ImageMagick", "/", "issues", "/", "252", ")", ".", "*", "Prevent", "buffer", "overflow", "in", "SIXEL", ",", "PDB", ",", "MAP", ",", "and", "CALS", "coders", "(", "bug", "report", "from", "Donghai", "Zhu", ")", ".", "2016", "-", "08", "-", "14", "6", ".", "9", ".", "5", "-", "7", "Cristy", "<", "quetzlzacatenango", "@", "image", ".", "..", ">", "*", "Release", "ImageMagick", "version", "6", ".", "9", ".", "5", "-", "7", ",", "GIT", "revision", "10993", ":", "7d2fd25", ":", "20160814", ".", "@", "@", "-", "401", ",", "22", "+", "401", ",", "23", "@", "@", "static", "MagickBooleanType", "WriteMAPImage", "(", "const", "ImageInfo", "*", "image_info", ",", "Image", "*", "image", ")", "Write", "colormap", "to", "file", ".", "*", "/", "q", "=", "colormap", ";", "if", "(", "image", "-", ">", "depth", "<", "=", "8", ")", "q", "=", "colormap", ";", "if", "(", "image", "-", ">", "colors", "<", "=", "256", ")", "for", "(", "i", "=", "0", ";", "i", "<", "(", "ssize_t", ")", "image", "-", ">", "colors", ";", "i", "+", "+)", "{", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "image", "-", ">", "colormap", "[", "i", "]", ".", "red", ";", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "image", "-", ">", "colormap", "[", "i", "]", ".", "green", ";", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "image", "-", ">", "colormap", "[", "i", "]", ".", "blue", ";", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "ScaleQuantumToChar", "(", "image", "-", ">", "colormap", "[", "i", "]", ".", "red", ")", ";", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "ScaleQuantumToChar", "(", "image", "-", ">", "colormap", "[", "i", "]", ".", "green", ")", ";", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "ScaleQuantumToChar", "(", "image", "-", ">", "colormap", "[", "i", "]", ".", "blue", ")", ";", "}", "else", "for", "(", "i", "=", "0", ";", "i", "<", "(", "ssize_t", ")", "image", "-", ">", "colors", ";", "i", "+", "+)", "{", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "(", "(", "size_t", ")", "image", "-", ">", "colormap", "[", "i", "]", ".", "red", ">", ">", "8", ")", ";", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "image", "-", ">", "colormap", "[", "i", "]", ".", "red", ";", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "(", "(", "size_t", ")", "image", "-", ">", "colormap", "[", "i", "]", ".", "green", ">", ">", "8", ")", ";", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "image", "-", ">", "colormap", "[", "i", "]", ".", "green", ";", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "(", "(", "size_t", ")", "image", "-", ">", "colormap", "[", "i", "]", ".", "blue", ">", ">", "8", ")", ";", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "image", "-", ">", "colormap", "[", "i", "]", ".", "blue", ";", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "(", "ScaleQuantumToShort", "(", "image", "-", ">", "colormap", "[", "i", "]", ".", "red", ")", ">", ">", "8", ")", ";", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "(", "ScaleQuantumToShort", "(", "image", "-", ">", "colormap", "[", "i", "]", ".", "red", ")", "&", "0xff", ")", ";", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "(", "ScaleQuantumToShort", "(", "image", "-", ">", "colormap", "[", "i", "]", ".", "green", ")", ">", ">", "8", ")", ";", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "(", "ScaleQuantumToShort", "(", "image", "-", ">", "colormap", "[", "i", "]", ".", "green", ")", "&", "0xff", ")", ";;", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "(", "ScaleQuantumToShort", "(", "image", "-", ">", "colormap", "[", "i", "]", ".", "blue", ")", ">", ">", "8", ")", ";", "*", "q", "+", "+=", "(", "unsigned", "char", ")", "(", "ScaleQuantumToShort", "(", "image", "-", ">", "colormap", "[", "i", "]", ".", "blue", ")", "&", "0xff", ")", ";", "}", "(", "void", ")", "WriteBlob", "(", "image", ",", "packet_size", "*", "image", "-", ">", "colors", ",", "colormap", ")", ";", "colormap", "=", "(", "unsigned", "char", "*", ")", "RelinquishMagickMemory", "(", "colormap", ")", ";", "@", "@", "-", "825", ",", "7", "+", "825", ",", "7", "@", "@", "static", "MagickBooleanType", "WritePDBImage", "(", "const", "ImageInfo", "*", "image_info", ",", "Image", "*", "image", ")", "buffer", "=", "(", "unsigned", "char", "*", ")", "AcquireQuantumMemory", "(", "512", ",", "sizeof", "(", "*", "buffer", ")", ");", "if", "(", "buffer", "=", "=", "(", "unsigned", "char", "*", ")", "NULL", ")", "ThrowWriterException", "(", "ResourceLimitError", ",", "\"", "MemoryAllocationFailed", "\"", ");", "packet_size", "=", "(", "size_t", ")", "(", "image", "-", ">", "depth", ">", "8", "?", "2", ":", "1", ")", ";", "packet_size", "=", "(", "size_t", ")", "(", "image", "-", ">", "depth", ">", "8", "?", "2", ":", "1", ")", ";", "scanline", "=", "(", "unsigned", "char", "*", ")", "AcquireQuantumMemory", "(", "image", "-", ">", "columns", ",", "packet_size", "*", "sizeof", "(", "*", "scanline", ")", ");", "if", "(", "scanline", "=", "=", "(", "unsigned", "char", "*", ")", "NULL", ")", "@", "@", "-", "838", ",", "6", "+", "838", ",", "7", "@", "@", "static", "MagickBooleanType", "WritePDBImage", "(", "const", "ImageInfo", "*", "image_info", ",", "Image", "*", "image", ")", "quantum_info", "=", "AcquireQuantumInfo", "(", "image_info", ",", "image", ")", ";", "if", "(", "quantum_info", "=", "=", "(", "QuantumInfo", "*", ")", "NULL", ")", "ThrowWriterException", "(", "ResourceLimitError", ",", "\"", "MemoryAllocationFailed", "\"", ");", "status", "=", "SetQuantumDepth", "(", "image", ",", "quantum_info", ",", "image", "-", ">", "depth", ">", "8", "?", "16", ":", "8", ")", ";", "bits", "=", "8", "/", "(", "int", ")", "bits_per_pixel", "-", "1", ";", "/", "*", "start", "at", "most", "significant", "bits", "*", "/", "literal", "=", "0", ";", "repeat", "=", "0", ";", "@", "@", "-", "257", ",", "7", "+", "257", ",", "7", "@", "@", "MagickBooleanType", "sixel_decode", "(", "unsigned", "char", "/", "*", "in", "*", "/", "*", "p", ",", "imsx", "=", "2048", ";", "imsy", "=", "2048", ";", "imbuf", "=", "(", "unsigned", "char", "*", ")", "AcquireQuantumMemory", "(", "imsx", "*", "imsy", ",", "1", ")", ";", "imbuf", "=", "(", "unsigned", "char", "*", ")", "AcquireQuantumMemory", "(", "imsx", ",", "imsy", ")", ";", "if", "(", "imbuf", "=", "=", "NULL", ")", "{", "return", "(", "MagickFalse", ")", ";", "@", "@", "-", "284", ",", "7", "+", "284", ",", "7", "@", "@", "MagickBooleanType", "sixel_decode", "(", "unsigned", "char", "/", "*", "in", "*", "/", "*", "p", ",", "sixel_palet", "[", "n", "]", "=", "SIXEL_RGB", "(", "255", ",", "255", ",", "255", ")", ";", "}", "(", "void", ")", "ResetMagickMemory", "(", "imbuf", ",", "background_color_index", ",", "imsx", "*", "imsy", ")", ";", "(", "void", ")", "ResetMagickMemory", "(", "imbuf", ",", "background_color_index", ",", "(", "size_t", ")", "imsx", "*", "imsy", ")", ";", "while", "(", "*", "p", "!", "=", "'", "\\", "0", "'", ")", "{", "if", "(", "(", "p", "[", "0", "]", "=", "=", "'", "\\", "033", "'", "&", "&", "p", "[", "1", "]", "=", "=", "'", "P", "'", ")", "|", "|", "*", "p", "=", "=", "0x90", ")", "{", "@", "@", "-", "358", ",", "14", "+", "358", ",", "14", "@", "@", "MagickBooleanType", "sixel_decode", "(", "unsigned", "char", "/", "*", "in", "*", "/", "*", "p", ",", "if", "(", "imsx", "<", "attributed_ph", "|", "|", "imsy", "<", "attributed_pv", ")", "{", "dmsx", "=", "imsx", ">", "attributed_ph", "?", "imsx", ":", "attributed_ph", ";", "dmsy", "=", "imsy", ">", "attributed_pv", "?", "imsy", ":", "attributed_pv", ";", "dmbuf", "=", "(", "unsigned", "char", "*", ")", "AcquireQuantumMemory", "(", "dmsx", "*", "dmsy", ",", "1", ")", ";", "dmbuf", "=", "(", "unsigned", "char", "*", ")", "AcquireQuantumMemory", "(", "dmsx", ",", "dmsy", ")", ";", "if", "(", "dmbuf", "=", "=", "(", "unsigned", "char", "*", ")", "NULL", ")", "{", "imbuf", "=", "(", "unsigned", "char", "*", ")", "RelinquishMagickMemory", "(", "imbuf", ")", ";", "return", "(", "MagickFalse", ")", ";", "}", "(", "void", ")", "ResetMagickMemory", "(", "dmbuf", ",", "background_color_index", ",", "dmsx", "*", "dmsy", ")", ";", "(", "void", ")", "ResetMagickMemory", "(", "dmbuf", ",", "background_color_index", ",", "(", "size_t", ")", "dmsx", "*", "dmsy", ")", ";", "for", "(", "y", "=", "0", ";", "y", "<", "imsy", ";", "+", "+", "y", ")", "{", "(", "void", ")", "CopyMagickMemory", "(", "dmbuf", "+", "dmsx", "*", "y", ",", "imbuf", "+", "imsx", "*", "y", ",", "imsx", ")", ";", "(", "void", ")", "CopyMagickMemory", "(", "dmbuf", "+", "dmsx", "*", "y", ",", "imbuf", "+", "(", "size_t", ")", "imsx", "*", "y", ",", "imsx", ")", ";", "}", "imbuf", "=", "(", "unsigned", "char", "*", ")", "RelinquishMagickMemory", "(", "imbuf", ")", ";", "imsx", "=", "dmsx", ";", "@", "@", "-", "432", ",", "14", "+", "432", ",", "14", "@", "@", "MagickBooleanType", "sixel_decode", "(", "unsigned", "char", "/", "*", "in", "*", "/", "*", "p", ",", "dmsx", "=", "nx", ";", "dmsy", "=", "ny", ";", "dmbuf", "=", "(", "unsigned", "char", "*", ")", "AcquireQuantumMemory", "(", "dmsx", "*", "dmsy", ",", "1", ")", ";", "dmbuf", "=", "(", "unsigned", "char", "*", ")", "AcquireQuantumMemory", "(", "dmsx", ",", "dmsy", ")", ";", "if", "(", "dmbuf", "=", "=", "(", "unsigned", "char", "*", ")", "NULL", ")", "{", "imbuf", "=", "(", "unsigned", "char", "*", ")", "RelinquishMagickMemory", "(", "imbuf", ")", ";", "return", "(", "MagickFalse", ")", ";", "}", "(", "void", ")", "ResetMagickMemory", "(", "dmbuf", ",", "background_color_index", ",", "dmsx", "*", "dmsy", ")", ";", "(", "void", ")", "ResetMagickMemory", "(", "dmbuf", ",", "background_color_index", ",", "(", "size_t", ")", "dmsx", "*", "dmsy", ")", ";", "for", "(", "y", "=", "0", ";", "y", "<", "imsy", ";", "+", "+", "y", ")", "{", "(", "void", ")", "CopyMagickMemory", "(", "dmbuf", "+", "dmsx", "*", "y", ",", "imbuf", "+", "imsx", "*", "y", ",", "imsx", ")", ";", "(", "void", ")", "CopyMagickMemory", "(", "dmbuf", "+", "dmsx", "*", "y", ",", "imbuf", "+", "(", "size_t", ")", "imsx", "*", "y", ",", "imsx", ")", ";", "}", "imbuf", "=", "(", "unsigned", "char", "*", ")", "RelinquishMagickMemory", "(", "imbuf", ")", ";", "imsx", "=", "dmsx", ";", "@", "@", "-", "482", ",", "7", "+", "482", ",", "7", "@", "@", "MagickBooleanType", "sixel_decode", "(", "unsigned", "char", "/", "*", "in", "*", "/", "*", "p", ",", "c", "<", "<=", "1", ";", "}", "for", "(", "y", "=", "posision_y", "+", "i", ";", "y", "<", "posision_y", "+", "i", "+", "n", ";", "+", "+", "y", ")", "{", "(", "void", ")", "ResetMagickMemory", "(", "imbuf", "+", "imsx", "*", "y", "+", "posision_x", ",", "color_index", ",", "repeat_count", ")", ";", "(", "void", ")", "ResetMagickMemory", "(", "imbuf", "+", "(", "size_t", ")", "imsx", "*", "y", "+", "posision_x", ",", "color_index", ",", "repeat_count", ")", ";", "}", "if", "(", "max_x", "<", "(", "posision_x", "+", "repeat_count", "-", "1", ")", ")", "{", "max_x", "=", "posision_x", "+", "repeat_count", "-", "1", ";", "@", "@", "-", "515", ",", "7", "+", "515", ",", "7", "@", "@", "MagickBooleanType", "sixel_decode", "(", "unsigned", "char", "/", "*", "in", "*", "/", "*", "p", ",", "if", "(", "imsx", ">", "max_x", "|", "|", "imsy", ">", "max_y", ")", "{", "dmsx", "=", "max_x", ";", "dmsy", "=", "max_y", ";", "if", "(", "(", "dmbuf", "=", "(", "unsigned", "char", "*", ")", "AcquireQuantumMemory", "(", "dmsx", "*", "dmsy", ",", "1", ")", ")", "=", "=", "NULL", ")", "{", "if", "(", "(", "dmbuf", "=", "(", "unsigned", "char", "*", ")", "AcquireQuantumMemory", "(", "dmsx", ",", "dmsy", ")", ")", "=", "=", "NULL", ")", "{", "imbuf", "=", "(", "unsigned", "char", "*", ")", "RelinquishMagickMemory", "(", "imbuf", ")", ";", "return", "(", "MagickFalse", ")", ";", "}", "@", "@", "-", "1291", ",", "7", "+", "1291", ",", "7", "@", "@", "static", "MagickBooleanType", "WriteSIXELImage", "(", "const", "ImageInfo", "*", "image_info", ",", "Image", "*", "imag", "Define", "SIXEL", "pixels", ".", "*", "/", "output", "=", "sixel_output_create", "(", "image", ")", ";", "sixel_pixels", "=", "(", "unsigned", "char", "*", ")", "AcquireQuantumMemory", "(", "image", "-", ">", "columns", "*", "image", "-", ">", "rows", ",", "1", ")", ";", "sixel_pixels", "=", "(", "unsigned", "char", "*", ")", "AcquireQuantumMemory", "(", "image", "-", ">", "columns", ",", "image", "-", ">", "rows", ")", ";", "for", "(", "y", "=", "0", ";", "y", "<", "(", "ssize_t", ")", "image", "-", ">", "rows", ";", "y", "+", "+)", "{", "(", "void", ")", "GetVirtualPixels", "(", "image", ",", "0", ",", "y", ",", "image", "-", ">", "columns", ",", "1", ",", "exception", ")", ";", "@", "@", "-", "2492", ",", "8", "+", "2492", ",", "8", "@", "@", "static", "MagickBooleanType", "WriteGROUP4Image", "(", "const", "ImageInfo", "*", "image_info", ",", "(", "void", ")", "SetImageType", "(", "huffman_image", ",", "BilevelType", ")", ";", "write_info", "=", "CloneImageInfo", "(", "(", "ImageInfo", "*", ")", "NULL", ")", ";", "SetImageInfoFile", "(", "write_info", ",", "file", ")", ";", "(", "void", ")", "SetImageType", "(", "image", ",", "BilevelType", ")", ";", "(", "void", ")", "SetImageDepth", "(", "image", ",", "1", ")", ";", "(", "void", ")", "SetImageType", "(", "image", ",", "BilevelType", ")", ";", "write_info", "-", ">", "compression", "=", "Group4Compression", ";", "write_info", "-", ">", "type", "=", "BilevelType", ";", "(", "void", ")", "SetImageOption", "(", "write_info", ",", "\"", "quantum", ":", "polarity", "\"", ",\"", "min", "-", "is", "-", "white", "\"", ");"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Allow", "float", "for", "server->timeout", "setting"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["econet:", "fix", "CVE-2010-3850", "Add", "missing", "check", "for", "capable(CAP_NET_ADMIN)", "in", "SIOCSIFADDR", "operation.", "Signed-off-by:", "Phil", "Blundell", "<philb@gnu.org>", "Signed-off-by:", "David", "S.", "Miller", "<davem@davemloft.net>"], "code_tokens": ["@", "@", "-", "661", ",", "6", "+", "661", ",", "9", "@", "@", "static", "int", "ec_dev_ioctl", "(", "struct", "socket", "*", "sock", ",", "unsigned", "int", "cmd", ",", "void", "__user", "*", "arg", ")", "err", "=", "0", ";", "switch", "(", "cmd", ")", "{", "case", "SIOCSIFADDR", ":", "if", "(", "!", "capable", "(", "CAP_NET_ADMIN", ")", ")", "return", "-", "EPERM", ";", "edev", "=", "dev", "-", ">", "ec_ptr", ";", "if", "(", "edev", "=", "=", "NULL", ")", "{", "/", "*", "Magic", "up", "a", "new", "one", ".", "*", "/"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["use", "LONG_MIN", "define", "rather", "than", "SSIZE_MAX"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["[SECURITY-234]", "Getters", "instead", "of", "fields;", "trim", "base64", "to", "fix", "test"], "code_tokens": ["@", "@", "-", "1104", ",", "9", "+", "1104", ",", "6", "@", "@", "private", "void", "addStatus", "(", "UnknownHostException", "e", ")", "{", "*", "/", "protected", "abstract", "void", "onSuccess", "(", ");", "private", "Authentication", "authentication", ";", "/", "**", "*", "During", "download", ",", "an", "attempt", "is", "made", "to", "compute", "the", "SHA", "-", "1", "checksum", "of", "the", "file", ".", "*", "@", "@", "-", "1115", ",", "7", "+", "1112", ",", "13", "@", "@", "private", "void", "addStatus", "(", "UnknownHostException", "e", ")", "{", "/", "/", "TODO", "no", "new", "API", "in", "LTS", ",", "but", "remove", "for", "mainline", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "@", "CheckForNull", "protected", "String", "computedSHA1", ";", "protected", "String", "getComputedSHA1", "(", ")", "{", "return", "computedSHA1", ";", "}", "private", "String", "computedSHA1", ";", "private", "Authentication", "authentication", ";", "/", "**", "*", "Get", "the", "user", "that", "initiated", "this", "job", "@", "@", "-", "1168", ",", "7", "+", "1171", ",", "8", "@", "@", "protected", "void", "_run", "(", ")", "throws", "IOException", ",", "InstallationStatus", "{", "dis", ".", "close", "(", ");", "}", "byte", "[", "]", "digest", "=", "sha1", ".", "digest", "(", ");", "computedSHA1", "=", "Base64", ".", "encodeBase64String", "(", "digest", ")", ";", "/", "/", "need", "to", "trim", "because", "commons", "-", "codec", "1", ".", "4", "used", "in", "test", "chunked", "output", "and", "adds", "\\", "r", "\\", "n", "at", "the", "end", "computedSHA1", "=", "Base64", ".", "encodeBase64String", "(", "digest", ")", ".", "trim", "(", ");", "}", "catch", "(", "NoSuchAlgorithmException", "ignored", ")", "{", "/", "/", "Irrelevant", "as", "the", "Java", "spec", "says", "SHA", "-", "1", "must", "exist", ".", "Still", ",", "if", "this", "fails", "/", "/", "the", "DownloadJob", "will", "just", "have", "computedSha1", "=", "null", "and", "that", "is", "expected", "@", "@", "-", "1374", ",", "30", "+", "1378", ",", "33", "@", "@", "public", "String", "toString", "(", ")", "{", "*", "/", "@", "Override", "protected", "void", "replace", "(", "File", "dst", ",", "File", "src", ")", "throws", "IOException", "{", "File", "bak", "=", "Util", ".", "changeExtension", "(", "dst", ",", "\".", "bak", "\"", ");", "bak", ".", "delete", "(", ");", "final", "File", "legacy", "=", "getLegacyDestination", "(", ");", "if", "(", "legacy", ".", "exists", "(", "))", "{", "legacy", ".", "renameTo", "(", "bak", ")", ";", "}", "else", "{", "dst", ".", "renameTo", "(", "bak", ")", ";", "}", "legacy", ".", "delete", "(", ");", "if", "(", "plugin", ".", "sha1", "!", "=", "null", ")", "{", "if", "(", "computedSHA1", "=", "=", "null", ")", "{", "if", "(", "plugin", ".", "getSha1", "(", ")", "!", "=", "null", ")", "{", "if", "(", "getComputedSHA1", "(", ")", "=", "=", "null", ")", "{", "/", "/", "refuse", "to", "install", "if", "SHA", "-", "1", "could", "not", "be", "computed", "throw", "new", "IOException", "(", "\"", "Failed", "to", "compute", "SHA", "-", "1", "of", "downloaded", "file", ",", "refusing", "installation", "\"", ");", "}", "if", "(", "!", "plugin", ".", "sha1", ".", "equals", "(", "computedSHA1", ")", ")", "{", "throw", "new", "IOException", "(", "\"", "Downloaded", "file", "\"", "+", "src", ".", "getAbsolutePath", "(", ")", "+", "\"", "does", "not", "match", "expected", "SHA", "-", "1", ",", "expected", "\"", "+", "plugin", ".", "sha1", "+", "\"", ",", "actual", "\"", "+", "computedSHA1", ")", ";", "if", "(", "!", "plugin", ".", "getSha1", "(", ").", "equals", "(", "getComputedSHA1", "(", "))", ")", "{", "throw", "new", "IOException", "(", "\"", "Downloaded", "file", "\"", "+", "src", ".", "getAbsolutePath", "(", ")", "+", "\"", "does", "not", "match", "expected", "SHA", "-", "1", ",", "expected", "\"", "+", "plugin", ".", "getSha1", "(", ")", "+", "\"", ",", "actual", "\"", "+", "getComputedSHA1", "(", "))", ";", "/", "/", "keep", "'", "src", "'", "around", "for", "investigating", "what", "'", "s", "going", "on", "}", "}", "dst", ".", "delete", "(", ");", "/", "/", "any", "failure", "up", "to", "here", "is", "no", "big", "deal", "File", "bak", "=", "Util", ".", "changeExtension", "(", "dst", ",", "\"", ".", "bak", "\"", ");", "bak", ".", "delete", "(", ");", "final", "File", "legacy", "=", "getLegacyDestination", "(", ");", "if", "(", "legacy", ".", "exists", "(", "))", "{", "if", "(", "!", "legacy", ".", "renameTo", "(", "bak", ")", ")", "{", "legacy", ".", "delete", "(", ");", "}", "}", "if", "(", "dst", ".", "exists", "(", "))", "{", "if", "(", "!", "dst", ".", "renameTo", "(", "bak", ")", ")", "{", "dst", ".", "delete", "(", ");", "}", "}", "if", "(", "!", "src", ".", "renameTo", "(", "dst", ")", ")", "{", "throw", "new", "IOException", "(", "\"", "Failed", "to", "rename", "\"", "+", "src", "+", "\"", "to", "\"", "+", "dst", ")", ";", "}", "@", "@", "-", "1515", ",", "14", "+", "1522", ",", "14", "@", "@", "protected", "void", "onSuccess", "(", ")", "{", "@", "Override", "protected", "void", "replace", "(", "File", "dst", ",", "File", "src", ")", "throws", "IOException", "{", "String", "expectedSHA1", "=", "site", ".", "getData", "(", ").", "core", ".", "sha1", ";", "String", "expectedSHA1", "=", "site", ".", "getData", "(", ").", "core", ".", "getSha1", "(", ");", "if", "(", "expectedSHA1", "!", "=", "null", ")", "{", "if", "(", "computedSHA1", "=", "=", "null", ")", "{", "if", "(", "getComputedSHA1", "(", ")", "=", "=", "null", ")", "{", "/", "/", "refuse", "to", "install", "if", "SHA", "-", "1", "could", "not", "be", "computed", "throw", "new", "IOException", "(", "\"", "Failed", "to", "compute", "SHA", "-", "1", "of", "downloaded", "file", ",", "refusing", "installation", "\"", ");", "}", "if", "(", "!", "expectedSHA1", ".", "equals", "(", "computedSHA1", ")", ")", "{", "throw", "new", "IOException", "(", "\"", "Downloaded", "file", "\"", "+", "src", ".", "getAbsolutePath", "(", ")", "+", "\"", "does", "not", "match", "expected", "SHA", "-", "1", ",", "expected", "\"", "+", "expectedSHA1", "+", "\"", ",", "actual", "\"", "+", "computedSHA1", ")", ";", "if", "(", "!", "expectedSHA1", ".", "equals", "(", "getComputedSHA1", "(", "))", ")", "{", "throw", "new", "IOException", "(", "\"", "Downloaded", "file", "\"", "+", "src", ".", "getAbsolutePath", "(", ")", "+", "\"", "does", "not", "match", "expected", "SHA", "-", "1", ",", "expected", "\"", "+", "expectedSHA1", "+", "\"", ",", "actual", "\"", "+", "getComputedSHA1", "(", "))", ";", "/", "/", "keep", "'", "src", "'", "around", "for", "investigating", "what", "'", "s", "going", "on", "}", "}", "@", "@", "-", "510", ",", "12", "+", "510", ",", "7", "@", "@", "public", "boolean", "canUpgrade", "(", ")", "{", "@", "Exported", "public", "final", "String", "url", ";", "/", "**", "*", "The", "base64", "encoded", "binary", "SHA", "-", "1", "checksum", "of", "the", "file", ".", "*", "@", "since", "TODO", "*", "/", "/", "/", "TODO", "@", "Exported", "assuming", "we", "want", "this", "in", "the", "API", "public", "final", "String", "sha1", ";", "private", "final", "String", "sha1", ";", "public", "Entry", "(", "String", "sourceId", ",", "JSONObject", "o", ")", "{", "this", "(", "sourceId", ",", "o", ",", "null", ")", ";", "@", "@", "-", "536", ",", "6", "+", "531", ",", "16", "@", "@", "public", "Entry", "(", "String", "sourceId", ",", "JSONObject", "o", ")", "{", "this", ".", "url", "=", "url", ";", "}", "/", "**", "*", "The", "base64", "encoded", "binary", "SHA", "-", "1", "checksum", "of", "the", "file", ".", "*", "Can", "be", "null", "if", "not", "provided", "by", "the", "update", "site", ".", "*", "@", "since", "TODO", "*", "/", "/", "/", "TODO", "@", "Exported", "assuming", "we", "want", "this", "in", "the", "API", "public", "String", "getSha1", "(", ")", "{", "return", "sha1", ";", "}", "/", "**", "*", "Checks", "if", "the", "specified", "\"", "current", "version", "\"", "is", "older", "than", "the", "version", "of", "this", "entry", ".", "*"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["dmaengine:", "ioat:", "remove", "unused", "\u2018ioat_dma\u2019", "In", "ioat_tx_submit_unlock(),", "variable", "\u2018ioat_dma\u2019", "is", "initialized", "but", "never", "used,", "which", "leads", "to", "warning", "with", "W=1", "drivers/dma/ioat/dma.c:", "In", "function", "\u2018ioat_alloc_ring_ent\u2019:", "drivers/dma/ioat/dma.c:341:25:", "warning:", "variable", "\u2018ioat_dma\u2019", "set", "but", "not", "used", "[-Wunused-but-set-variable]", "struct", "ioatdma_device", "*ioat_dma;", "So", "remove", "it.", "Cc:", "Dave", "Jiang", "<dave.jiang@intel.com>", "Signed-off-by:", "Vinod", "Koul", "<vinod.koul@intel.com>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["fix", "typo"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["sctp:", "fix", "to", "calc", "the", "INIT/INIT-ACK", "chunk", "length", "correctly", "is", "set", "When", "calculating", "the", "INIT/INIT-ACK", "chunk", "length,", "we", "should", "not", "only", "account", "the", "length", "of", "parameters,", "but", "also", "the", "parameters", "zero", "padding", "length,", "such", "as", "AUTH", "HMACS", "parameter", "and", "CHUNKS", "parameter.", "Without", "the", "parameters", "zero", "padding", "length", "we", "may", "get", "following", "oops.", "skb_over_panic:", "text:ce2068d2", "len:130", "put:6", "head:cac3fe00", "data:cac3fe00", "tail:0xcac3fe82", "end:0xcac3fe80", "dev:<NULL>", "------------[", "cut", "here", "]------------", "kernel", "BUG", "at", "net/core/skbuff.c:127!", "invalid", "opcode:", "0000", "[#2]", "SMP", "last", "sysfs", "file:", "/sys/module/aes_generic/initstate", "Modules", "linked", "in:", "authenc", "......", "Pid:", "4102,", "comm:", "sctp_darn", "Tainted:", "G", "D", "2.6.34-rc2", "#6", "EIP:", "0060:[<c0607630>]", "EFLAGS:", "00010282", "CPU:", "0", "EIP", "is", "at", "skb_over_panic+0x37/0x3e", "EAX:", "00000078", "EBX:", "c07c024b", "ECX:", "c07c02b9", "EDX:", "cb607b78", "ESI:", "00000000", "EDI:", "cac3fe7a", "EBP:", "00000002", "ESP:", "cb607b74", "DS:", "007b", "ES:", "007b", "FS:", "00d8", "GS:", "0033", "SS:", "0068", "Process", "sctp_darn", "(pid:", "4102,", "ti=cb607000", "task=cabdc990", "task.ti=cb607000)", "Stack:", "c07c02b9", "ce2068d2", "00000082", "00000006", "cac3fe00", "cac3fe00", "cac3fe82", "cac3fe80", "<0>", "c07c024b", "cac3fe7c", "cac3fe7a", "c0608dec", "ca986e80", "ce2068d2", "00000006", "0000007a", "<0>", "cb8120ca", "ca986e80", "cb812000", "00000003", "cb8120c4", "ce208a25", "cb8120ca", "cadd9400", "Call", "Trace:", "[<ce2068d2>]", "?", "sctp_addto_chunk+0x45/0x85", "[sctp]", "[<c0608dec>]", "?", "skb_put+0x2e/0x32", "[<ce2068d2>]", "?", "sctp_addto_chunk+0x45/0x85", "[sctp]", "[<ce208a25>]", "?", "sctp_make_init+0x279/0x28c", "[sctp]", "[<c0686a92>]", "?", "apic_timer_interrupt+0x2a/0x30", "[<ce1fdc0b>]", "?", "sctp_sf_do_prm_asoc+0x2b/0x7b", "[sctp]", "[<ce202823>]", "?", "sctp_do_sm+0xa0/0x14a", "[sctp]", "[<ce2133b9>]", "?", "sctp_pname+0x0/0x14", "[sctp]", "[<ce211d72>]", "?", "sctp_primitive_ASSOCIATE+0x2b/0x31", "[sctp]", "[<ce20f3cf>]", "?", "sctp_sendmsg+0x7a0/0x9eb", "[sctp]", "[<c064eb1e>]", "?", "inet_sendmsg+0x3b/0x43", "[<c04244b7>]", "?", "task_tick_fair+0x2d/0xd9", "[<c06031e1>]", "?", "sock_sendmsg+0xa7/0xc1", "[<c0416afe>]", "?", "smp_apic_timer_interrupt+0x6b/0x75", "[<c0425123>]", "?", "dequeue_task_fair+0x34/0x19b", "[<c0446abb>]", "?", "sched_clock_local+0x17/0x11e", "[<c052ea87>]", "?", "_copy_from_user+0x2b/0x10c", "[<c060ab3a>]", "?", "verify_iovec+0x3c/0x6a", "[<c06035ca>]", "?", "sys_sendmsg+0x186/0x1e2", "[<c042176b>]", "?", "__wake_up_common+0x34/0x5b", "[<c04240c2>]", "?", "__wake_up+0x2c/0x3b", "[<c057e35c>]", "?", "tty_wakeup+0x43/0x47", "[<c04430f2>]", "?", "remove_wait_queue+0x16/0x24", "[<c0580c94>]", "?", "n_tty_read+0x5b8/0x65e", "[<c042be02>]", "?", "default_wake_function+0x0/0x8", "[<c0604e0e>]", "?", "sys_socketcall+0x17f/0x1cd", "[<c040264c>]", "?", "sysenter_do_call+0x12/0x22", "Code:", "0f", "45", "de", "53", "ff", "b0", "98", "00", "00", "00", "ff", "b0", "94", "......", "EIP:", "[<c0607630>]", "skb_over_panic+0x37/0x3e", "SS:ESP", "0068:cb607b74", "To", "reproduce:", "#", "modprobe", "sctp", "#", "echo", "1", ">", "/proc/sys/net/sctp/addip_enable", "#", "echo", "1", ">", "/proc/sys/net/sctp/auth_enable", "#", "sctp_test", "-H", "3ffe:501:ffff:100:20c:29ff:fe4d:f37e", "-P", "800", "-l", "#", "sctp_darn", "-H", "3ffe:501:ffff:100:20c:29ff:fe4d:f37e", "-P", "900", "-h", "192.168.0.21", "-p", "800", "-I", "-s", "-t", "sctp_darn", "ready", "to", "send...", "3ffe:501:ffff:100:20c:29ff:fe4d:f37e:900-192.168.0.21:800", "Interactive", "mode>", "bindx-add=192.168.0.21", "3ffe:501:ffff:100:20c:29ff:fe4d:f37e:900-192.168.0.21:800", "Interactive", "mode>", "bindx-add=192.168.1.21", "3ffe:501:ffff:100:20c:29ff:fe4d:f37e:900-192.168.0.21:800", "Interactive", "mode>", "snd=10", "------------------------------------------------------------------", "eth0", "has", "addresses:", "3ffe:501:ffff:100:20c:29ff:fe4d:f37e", "and", "192.168.0.21", "eth1", "has", "addresses:", "192.168.1.21", "------------------------------------------------------------------", "Reported-by:", "George", "Cheimonidis", "<gchimon@gmail.com>", "Signed-off-by:", "Wei", "Yongjun", "<yjwei@cn.fujitsu.com>", "Signed-off-by:", "Vlad", "Yasevich", "<vladislav.yasevich@hp.com>", "Signed-off-by:", "David", "S.", "Miller", "<davem@davemloft.net>"], "code_tokens": ["@", "@", "-", "208", ",", "7", "+", "208", ",", "8", "@", "@", "struct", "sctp_chunk", "*", "sctp_make_init", "(", "const", "struct", "sctp_association", "*", "asoc", ",", "sp", "=", "sctp_sk", "(", "asoc", "-", ">", "base", ".", "sk", ")", ";", "num_types", "=", "sp", "-", ">", "pf", "-", ">", "supported_addrs", "(", "sp", ",", "types", ")", ";", "chunksize", "=", "sizeof", "(", "init", ")", "+", "addrs_len", "+", "SCTP_SAT_LEN", "(", "num_types", ")", ";", "chunksize", "=", "sizeof", "(", "init", ")", "+", "addrs_len", ";", "chunksize", "+", "=", "WORD_ROUND", "(", "SCTP_SAT_LEN", "(", "num_types", ")", ");", "chunksize", "+", "=", "sizeof", "(", "ecap_param", ")", ";", "if", "(", "sctp_prsctp_enable", ")", "@", "@", "-", "238", ",", "14", "+", "239", ",", "14", "@", "@", "struct", "sctp_chunk", "*", "sctp_make_init", "(", "const", "struct", "sctp_association", "*", "asoc", ",", "/", "*", "Add", "HMACS", "parameter", "length", "if", "any", "were", "defined", "*", "/", "auth_hmacs", "=", "(", "sctp_paramhdr_t", "*", ")", "asoc", "-", ">", "c", ".", "auth_hmacs", ";", "if", "(", "auth_hmacs", "-", ">", "length", ")", "chunksize", "+", "=", "ntohs", "(", "auth_hmacs", "-", ">", "length", ")", ";", "chunksize", "+", "=", "WORD_ROUND", "(", "ntohs", "(", "auth_hmacs", "-", ">", "length", ")", ");", "else", "auth_hmacs", "=", "NULL", ";", "/", "*", "Add", "CHUNKS", "parameter", "length", "*", "/", "auth_chunks", "=", "(", "sctp_paramhdr_t", "*", ")", "asoc", "-", ">", "c", ".", "auth_chunks", ";", "if", "(", "auth_chunks", "-", ">", "length", ")", "chunksize", "+", "=", "ntohs", "(", "auth_chunks", "-", ">", "length", ")", ";", "chunksize", "+", "=", "WORD_ROUND", "(", "ntohs", "(", "auth_chunks", "-", ">", "length", ")", ");", "else", "auth_chunks", "=", "NULL", ";", "@", "@", "-", "255", ",", "7", "+", "256", ",", "8", "@", "@", "struct", "sctp_chunk", "*", "sctp_make_init", "(", "const", "struct", "sctp_association", "*", "asoc", ",", "/", "*", "If", "we", "have", "any", "extensions", "to", "report", ",", "account", "for", "that", "*", "/", "if", "(", "num_ext", ")", "chunksize", "+", "=", "sizeof", "(", "sctp_supported_ext_param_t", ")", "+", "num_ext", ";", "chunksize", "+", "=", "WORD_ROUND", "(", "sizeof", "(", "sctp_supported_ext_param_t", ")", "num_ext", ")", ";", "/", "*", "RFC", "2960", "3", ".", "3", ".", "2", "Initiation", "(", "INIT", ")", "(", "1", ")", "*", "@", "@", "-", "397", ",", "13", "+", "399", ",", "13", "@", "@", "struct", "sctp_chunk", "*", "sctp_make_init_ack", "(", "const", "struct", "sctp_association", "*", "asoc", ",", "auth_hmacs", "=", "(", "sctp_paramhdr_t", "*", ")", "asoc", "-", ">", "c", ".", "auth_hmacs", ";", "if", "(", "auth_hmacs", "-", ">", "length", ")", "chunksize", "+", "=", "ntohs", "(", "auth_hmacs", "-", ">", "length", ")", ";", "chunksize", "+", "=", "WORD_ROUND", "(", "ntohs", "(", "auth_hmacs", "-", ">", "length", ")", ");", "else", "auth_hmacs", "=", "NULL", ";", "auth_chunks", "=", "(", "sctp_paramhdr_t", "*", ")", "asoc", "-", ">", "c", ".", "auth_chunks", ";", "if", "(", "auth_chunks", "-", ">", "length", ")", "chunksize", "+", "=", "ntohs", "(", "auth_chunks", "-", ">", "length", ")", ";", "chunksize", "+", "=", "WORD_ROUND", "(", "ntohs", "(", "auth_chunks", "-", ">", "length", ")", ");", "else", "auth_chunks", "=", "NULL", ";", "@", "@", "-", "412", ",", "7", "+", "414", ",", "8", "@", "@", "struct", "sctp_chunk", "*", "sctp_make_init_ack", "(", "const", "struct", "sctp_association", "*", "asoc", ",", "}", "if", "(", "num_ext", ")", "chunksize", "+", "=", "sizeof", "(", "sctp_supported_ext_param_t", ")", "+", "num_ext", ";", "chunksize", "+", "=", "WORD_ROUND", "(", "sizeof", "(", "sctp_supported_ext_param_t", ")", "num_ext", ")", ";", "/", "*", "Now", "allocate", "and", "fill", "out", "the", "chunk", ".", "*", "/", "retval", "=", "sctp_make_chunk", "(", "asoc", ",", "SCTP_CID_INIT_ACK", ",", "0", ",", "chunksize", ")", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["avformat/rtpenc_mpegts:", "stop", "leaks", "Fixes", "CID", "1474460", "&", "1474461"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Branch", "2.1.x", "is", "built", "for", "Java", "1.8."], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["fediz-core:", "extract", "duplicate", "code", "in", "SAMLProcessorImpl"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["userns:", "Don't", "allow", "setgroups", "until", "a", "gid", "mapping", "has", "been", "setablished", "setgroups", "is", "unique", "in", "not", "needing", "a", "valid", "mapping", "before", "it", "can", "be", "called,", "in", "the", "case", "of", "setgroups(0,", "NULL)", "which", "drops", "all", "supplemental", "groups.", "The", "design", "of", "the", "user", "namespace", "assumes", "that", "CAP_SETGID", "can", "not", "actually", "be", "used", "until", "a", "gid", "mapping", "is", "established.", "Therefore", "add", "a", "helper", "function", "to", "see", "if", "the", "user", "namespace", "gid", "mapping", "has", "been", "established", "and", "call", "that", "function", "in", "the", "setgroups", "permission", "check.", "This", "is", "part", "of", "the", "fix", "for", "CVE-2014-8989,", "being", "able", "to", "drop", "groups", "without", "privilege", "using", "user", "namespaces.", "Cc:", "stable@vger.kernel.org", "Reviewed-by:", "Andy", "Lutomirski", "<luto@amacapital.net>", "Signed-off-by:", "\"Eric", "W.", "Biederman\"", "<ebiederm@xmission.com>"], "code_tokens": ["@", "@", "-", "63", ",", "6", "+", "63", ",", "7", "@", "@", "extern", "const", "struct", "seq_operations", "proc_projid_seq_operations", ";", "extern", "ssize_t", "proc_uid_map_write", "(", "struct", "file", "*", ",", "const", "char", "__user", "*", ",", "size_t", ",", "loff_t", "*", ");", "extern", "ssize_t", "proc_gid_map_write", "(", "struct", "file", "*", ",", "const", "char", "__user", "*", ",", "size_t", ",", "loff_t", "*", ");", "extern", "ssize_t", "proc_projid_map_write", "(", "struct", "file", "*", ",", "const", "char", "__user", "*", ",", "size_t", ",", "loff_t", "*", ");", "extern", "bool", "userns_may_setgroups", "(", "const", "struct", "user_namespace", "*", "ns", ")", ";", "#", "else", "static", "inline", "struct", "user_namespace", "*", "get_user_ns", "(", "struct", "user_namespace", "*", "ns", ")", "@", "@", "-", "87", ",", "6", "+", "88", ",", "10", "@", "@", "static", "inline", "void", "put_user_ns", "(", "struct", "user_namespace", "*", "ns", ")", "{", "}", "static", "inline", "bool", "userns_may_setgroups", "(", "const", "struct", "user_namespace", "*", "ns", ")", "{", "return", "true", ";", "}", "#", "endif", "#", "endif", "/", "*", "_LINUX_USER_H", "*", "/", "@", "@", "-", "6", ",", "6", "+", "6", ",", "7", "@", "@", "#", "include", "<", "linux", "/", "slab", ".", "h", ">", "#", "include", "<", "linux", "/", "security", ".", "h", ">", "#", "include", "<", "linux", "/", "syscalls", ".", "h", ">", "#", "include", "<", "linux", "/", "user_namespace", ".", "h", ">", "#", "include", "<", "asm", "/", "uaccess", ".", "h", ">", "/", "*", "init", "to", "2", "-", "one", "for", "init_task", ",", "one", "to", "ensure", "it", "is", "never", "freed", "*", "/", "@", "@", "-", "217", ",", "7", "+", "218", ",", "8", "@", "@", "bool", "may_setgroups", "(", "void", ")", "{", "struct", "user_namespace", "*", "user_ns", "=", "current_user_ns", "(", ");", "return", "ns_capable", "(", "user_ns", ",", "CAP_SETGID", ")", ";", "return", "ns_capable", "(", "user_ns", ",", "CAP_SETGID", ")", "&", "&", "userns_may_setgroups", "(", "user_ns", ")", ";", "}", "/", "*", "@", "@", "-", "843", ",", "6", "+", "843", ",", "20", "@", "@", "static", "bool", "new_idmap_permitted", "(", "const", "struct", "file", "*", "file", ",", "return", "false", ";", "}", "bool", "userns_may_setgroups", "(", "const", "struct", "user_namespace", "*", "ns", ")", "{", "bool", "allowed", ";", "mutex_lock", "(", "&", "id_map_mutex", ")", ";", "/", "*", "It", "is", "not", "safe", "to", "use", "setgroups", "until", "a", "gid", "mapping", "in", "*", "the", "user", "namespace", "has", "been", "established", ".", "*", "/", "allowed", "=", "ns", "-", ">", "gid_map", ".", "nr_extents", "!", "=", "0", ";", "mutex_unlock", "(", "&", "id_map_mutex", ")", ";", "return", "allowed", ";", "}", "static", "void", "*", "userns_get", "(", "struct", "task_struct", "*", "task", ")", "{", "struct", "user_namespace", "*", "user_ns", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["crypto:", "algif_skcipher", "-", "Load", "TX", "SG", "list", "after", "waiting", "We", "need", "to", "load", "the", "TX", "SG", "list", "in", "sendmsg(2)", "after", "waiting", "for", "incoming", "data,", "not", "before.", "Cc:", "stable@vger.kernel.org", "Reported-by:", "Dmitry", "Vyukov", "<dvyukov@google.com>", "Signed-off-by:", "Herbert", "Xu", "<herbert@gondor.apana.org.au>", "Tested-by:", "Dmitry", "Vyukov", "<dvyukov@google.com>"], "code_tokens": ["@", "@", "-", "647", ",", "13", "+", "647", ",", "6", "@", "@", "static", "int", "skcipher_recvmsg_sync", "(", "struct", "socket", "*", "sock", ",", "struct", "msghdr", "*", "msg", ",", "lock_sock", "(", "sk", ")", ";", "while", "(", "msg_data_left", "(", "msg", ")", ")", "{", "sgl", "=", "list_first_entry", "(", "&", "ctx", "-", ">", "tsgl", ",", "struct", "skcipher_sg_list", ",", "list", ")", ";", "sg", "=", "sgl", "-", ">", "sg", ";", "while", "(", "!", "sg", "-", ">", "length", ")", "sg", "+", "+;", "if", "(", "!", "ctx", "-", ">", "used", ")", "{", "err", "=", "skcipher_wait_for_data", "(", "sk", ",", "flags", ")", ";", "if", "(", "err", ")", "@", "@", "-", "674", ",", "6", "+", "667", ",", "13", "@", "@", "static", "int", "skcipher_recvmsg_sync", "(", "struct", "socket", "*", "sock", ",", "struct", "msghdr", "*", "msg", ",", "if", "(", "!", "used", ")", "goto", "free", ";", "sgl", "=", "list_first_entry", "(", "&", "ctx", "-", ">", "tsgl", ",", "struct", "skcipher_sg_list", ",", "list", ")", ";", "sg", "=", "sgl", "-", ">", "sg", ";", "while", "(", "!", "sg", "-", ">", "length", ")", "sg", "+", "+;", "skcipher_request_set_crypt", "(", "&", "ctx", "-", ">", "req", ",", "sg", ",", "ctx", "-", ">", "rsgl", ".", "sg", ",", "used", ",", "ctx", "-", ">", "iv", ")", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["KEYS:", "Sort", "out", "big_key", "initialisation", "big_key", "has", "two", "separate", "initialisation", "functions,", "one", "that", "registers", "the", "key", "type", "and", "one", "that", "registers", "the", "crypto.", "If", "the", "key", "type", "fails", "to", "register,", "there's", "no", "problem", "if", "the", "crypto", "registers", "successfully", "because", "there's", "no", "way", "to", "reach", "the", "crypto", "except", "through", "the", "key", "type.", "However,", "if", "the", "key", "type", "registers", "successfully", "but", "the", "crypto", "does", "not,", "big_key_rng", "and", "big_key_blkcipher", "may", "end", "up", "set", "to", "NULL", "-", "but", "the", "code", "neither", "checks", "for", "this", "nor", "unregisters", "the", "big", "key", "key", "type.", "Furthermore,", "since", "the", "key", "type", "is", "registered", "before", "the", "crypto,", "it", "is", "theoretically", "possible", "for", "the", "kernel", "to", "try", "adding", "a", "big_key", "before", "the", "crypto", "is", "set", "up,", "leading", "to", "the", "same", "effect.", "Fix", "this", "by", "merging", "big_key_crypto_init()", "and", "big_key_init()", "and", "calling", "the", "resulting", "function", "late.", "If", "they're", "going", "to", "be", "encrypted,", "we", "shouldn't", "be", "creating", "big_keys", "before", "we", "have", "the", "facilities", "to", "do", "the", "encryption", "available.", "The", "key", "type", "registration", "is", "also", "moved", "after", "the", "crypto", "initialisation.", "The", "fix", "also", "includes", "message", "printing", "on", "failure.", "If", "the", "big_key", "type", "isn't", "correctly", "set", "up,", "simply", "doing:", "dd", "if=/dev/zero", "bs=4096", "count=1", "|", "keyctl", "padd", "big_key", "a", "@s", "ought", "to", "cause", "an", "oops.", "Fixes:", "13100a72f40f5748a04017e0ab3df4cf27c809ef", "('Security:", "Keys:", "Big", "keys", "stored", "encrypted')", "Signed-off-by:", "David", "Howells", "<dhowells@redhat.com>", "cc:", "Peter", "Hlavaty", "<zer0mem@yahoo.com>", "cc:", "Kirill", "Marinushkin", "<k.marinushkin@gmail.com>", "cc:", "Artem", "Savkov", "<asavkov@redhat.com>", "cc:", "stable@vger.kernel.org", "Signed-off-by:", "James", "Morris", "<james.l.morris@oracle.com>"], "code_tokens": ["@", "@", "-", "9", ",", "6", "+", "9", ",", "7", "@", "@", "*", "2", "of", "the", "Licence", ",", "or", "(", "at", "your", "option", ")", "any", "later", "version", ".", "*", "/", "#", "define", "pr_fmt", "(", "fmt", ")", "\"", "big_key", ":", "\"", "fmt", "#", "include", "<", "linux", "/", "init", ".", "h", ">", "#", "include", "<", "linux", "/", "seq_file", ".", "h", ">", "#", "include", "<", "linux", "/", "file", ".", "h", ">", "@", "@", "-", "341", ",", "44", "+", "342", ",", "48", "@", "@", "long", "big_key_read", "(", "const", "struct", "key", "*", "key", ",", "char", "__user", "*", "buffer", ",", "size_t", "buflen", ")", "*", "/", "static", "int", "__init", "big_key_init", "(", "void", ")", "{", "return", "register_key_type", "(", "&", "key_type_big_key", ")", ";", "}", "/", "*", "*", "Initialize", "big_key", "crypto", "and", "RNG", "algorithms", "*", "/", "static", "int", "__init", "big_key_crypto_init", "(", "void", ")", "{", "int", "ret", "=", "-", "EINVAL", ";", "struct", "crypto_skcipher", "*", "cipher", ";", "struct", "crypto_rng", "*", "rng", ";", "int", "ret", ";", "/", "*", "init", "RNG", "*", "/", "big_key_rng", "=", "crypto_alloc_rng", "(", "big_key_rng_name", ",", "0", ",", "0", ")", ";", "if", "(", "IS_ERR", "(", "big_key_rng", ")", ")", "{", "big_key_rng", "=", "NULL", ";", "return", "-", "EFAULT", ";", "rng", "=", "crypto_alloc_rng", "(", "big_key_rng_name", ",", "0", ",", "0", ")", ";", "if", "(", "IS_ERR", "(", "rng", ")", ")", "{", "pr_err", "(", "\"", "Can", "'", "t", "alloc", "rng", ":", "%", "ld", "\\", "n", "\"", ",", "PTR_ERR", "(", "rng", ")", ");", "return", "PTR_ERR", "(", "rng", ")", ";", "}", "big_key_rng", "=", "rng", ";", "/", "*", "seed", "RNG", "*", "/", "ret", "=", "crypto_rng_reset", "(", "big_key_rng", ",", "NULL", ",", "crypto_rng_seedsize", "(", "big_key_rng", ")", ");", "if", "(", "ret", ")", "goto", "error", ";", "ret", "=", "crypto_rng_reset", "(", "rng", ",", "NULL", ",", "crypto_rng_seedsize", "(", "rng", ")", ");", "if", "(", "ret", ")", "{", "pr_err", "(", "\"", "Can", "'", "t", "reset", "rng", ":", "%", "d", "\\", "n", "\"", ",", "ret", ")", ";", "goto", "error_rng", ";", "}", "/", "*", "init", "block", "cipher", "*", "/", "big_key_skcipher", "=", "crypto_alloc_skcipher", "(", "big_key_alg_name", ",", "0", ",", "CRYPTO_ALG_ASYNC", ")", ";", "if", "(", "IS_ERR", "(", "big_key_skcipher", ")", ")", "{", "big_key_skcipher", "=", "NULL", ";", "ret", "=", "-", "EFAULT", ";", "goto", "error", ";", "cipher", "=", "crypto_alloc_skcipher", "(", "big_key_alg_name", ",", "0", ",", "CRYPTO_ALG_ASYNC", ")", ";", "if", "(", "IS_ERR", "(", "cipher", ")", ")", "{", "ret", "=", "PTR_ERR", "(", "cipher", ")", ";", "pr_err", "(", "\"", "Can", "'", "t", "alloc", "crypto", ":", "%", "d", "\\", "n", "\"", ",", "ret", ")", ";", "goto", "error_rng", ";", "}", "big_key_skcipher", "=", "cipher", ";", "ret", "=", "register_key_type", "(", "&", "key_type_big_key", ")", ";", "if", "(", "ret", "<", "0", ")", "{", "pr_err", "(", "\"", "Can", "'", "t", "register", "type", ":", "%", "d", "\\", "n", "\"", ",", "ret", ")", ";", "goto", "error_cipher", ";", "}", "return", "0", ";", "error", ":", "error_cipher", ":", "crypto_free_skcipher", "(", "big_key_skcipher", ")", ";", "error_rng", ":", "crypto_free_rng", "(", "big_key_rng", ")", ";", "big_key_rng", "=", "NULL", ";", "return", "ret", ";", "}", "device_initcall", "(", "big_key_init", ")", ";", "late_initcall", "(", "big_key_crypto_init", ")", ";", "late_initcall", "(", "big_key_init", ")", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["lavfi/dnn/dnn_io_proc.c:", "fix", "CID", "1484955", "CID", "1484955:", "Memory", "-", "corruptions", "(ARRAY_VS_SINGLETON)"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Partial", "fix", "for", "bug", "#72613", "-", "do", "not", "treat", "negative", "returns", "from", "bz2", "as", "size_t"], "code_tokens": ["@", "@", "-", "15", ",", "7", "+", "15", ",", "7", "@", "@", "|", "Author", ":", "Sterling", "Hughes", "<", "sterling", "@", "php", ".", "net", ">", "|", "+", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "*", "/", "/", "*", "$", "Id", "$", "*", "/", "#", "ifdef", "HAVE_CONFIG_H", "@", "@", "-", "137", ",", "29", "+", "137", ",", "33", "@", "@", "struct", "php_bz2_stream_data_t", "{", "static", "size_t", "php_bz2iop_read", "(", "php_stream", "*", "stream", ",", "char", "*", "buf", ",", "size_t", "count", "TSRMLS_DC", ")", "{", "struct", "php_bz2_stream_data_t", "*", "self", "=", "(", "struct", "php_bz2_stream_data_t", "*", ")", "stream", "-", ">", "abstract", ";", "size_t", "ret", ";", "ret", "=", "BZ2_bzread", "(", "self", "-", ">", "bz_file", ",", "buf", ",", "count", ")", ";", "int", "bz2_ret", ";", "bz2_ret", "=", "BZ2_bzread", "(", "self", "-", ">", "bz_file", ",", "buf", ",", "count", ")", ";", "if", "(", "ret", "=", "=", "0", ")", "{", "if", "(", "bz2_ret", "<", "0", ")", "{", "stream", "-", ">", "eof", "=", "1", ";", "return", "-", "1", ";", "}", "if", "(", "bz2_ret", "=", "=", "0", ")", "{", "stream", "-", ">", "eof", "=", "1", ";", "}", "return", "ret", ";", "return", "(", "size_t", ")", "bz2_ret", ";", "}", "static", "size_t", "php_bz2iop_write", "(", "php_stream", "*", "stream", ",", "const", "char", "*", "buf", ",", "size_t", "count", "TSRMLS_DC", ")", "{", "struct", "php_bz2_stream_data_t", "*", "self", "=", "(", "struct", "php_bz2_stream_data_t", "*", ")", "stream", "-", ">", "abstract", ";", "return", "BZ2_bzwrite", "(", "self", "-", ">", "bz_file", ",", "(", "char", "*", ")", "buf", ",", "count", ")", ";", "return", "BZ2_bzwrite", "(", "self", "-", ">", "bz_file", ",", "(", "char", "*", ")", "buf", ",", "count", ")", ";", "}", "static", "int", "php_bz2iop_close", "(", "php_stream", "*", "stream", ",", "int", "close_handle", "TSRMLS_DC", ")", "{", "struct", "php_bz2_stream_data_t", "*", "self", "=", "(", "struct", "php_bz2_stream_data_t", "*", ")", "stream", "-", ">", "abstract", ";", "int", "ret", "=", "EOF", ";", "if", "(", "close_handle", ")", "{", "BZ2_bzclose", "(", "self", "-", ">", "bz_file", ")", ";", "}", "@", "@", "-", "191", ",", "11", "+", "195", ",", "11", "@", "@", "php_stream_ops", "php_stream_bz2io_ops", "=", "{", "}", ";", "/", "*", "{", "{{", "Bzip2", "stream", "openers", "*", "/", "PHP_BZ2_API", "php_stream", "*", "_php_stream_bz2open_from_BZFILE", "(", "BZFILE", "*", "bz", ",", "PHP_BZ2_API", "php_stream", "*", "_php_stream_bz2open_from_BZFILE", "(", "BZFILE", "*", "bz", ",", "char", "*", "mode", ",", "php_stream", "*", "innerstream", "STREAMS_DC", "TSRMLS_DC", ")", "{", "struct", "php_bz2_stream_data_t", "*", "self", ";", "self", "=", "emalloc", "(", "sizeof", "(", "*", "self", ")", ");", "self", "-", ">", "stream", "=", "innerstream", ";", "@", "@", "-", "226", ",", "15", "+", "230", ",", "15", "@", "@", "PHP_BZ2_API", "php_stream", "*", "_php_stream_bz2open", "(", "php_stream_wrapper", "*", "wrapper", ",", "virtual_filepath_ex", "(", "path", ",", "&", "path_copy", ",", "NULL", "TSRMLS_CC", ")", ";", "#", "else", "path_copy", "=", "path", ";", "#", "endif", "#", "endif", "if", "(", "php_check_open_basedir", "(", "path_copy", "TSRMLS_CC", ")", ")", "{", "#", "ifdef", "VIRTUAL_DIR", "free", "(", "path_copy", ")", ";", "#", "endif", "return", "NULL", ";", "}", "/", "*", "try", "and", "open", "it", "directly", "first", "*", "/", "bz_file", "=", "BZ2_bzopen", "(", "path_copy", ",", "mode", ")", ";", "@", "@", "-", "245", ",", "11", "+", "249", ",", "11", "@", "@", "PHP_BZ2_API", "php_stream", "*", "_php_stream_bz2open", "(", "php_stream_wrapper", "*", "wrapper", ",", "free", "(", "path_copy", ")", ";", "#", "endif", "path_copy", "=", "NULL", ";", "if", "(", "bz_file", "=", "=", "NULL", ")", "{", "/", "*", "that", "didn", "'", "t", "work", ",", "so", "try", "and", "get", "something", "from", "the", "network", "/", "wrapper", "*", "/", "stream", "=", "php_stream_open_wrapper", "(", "path", ",", "mode", ",", "options", "|", "STREAM_WILL_CAST", ",", "opened_path", ")", ";", "if", "(", "stream", ")", "{", "int", "fd", ";", "if", "(", "SUCCESS", "=", "=", "php_stream_cast", "(", "stream", ",", "PHP_STREAM_AS_FD", ",", "(", "void", "*", "*)", "&", "fd", ",", "REPORT_ERRORS", ")", ")", "{", "@", "@", "-", "264", ",", "7", "+", "268", ",", "7", "@", "@", "PHP_BZ2_API", "php_stream", "*", "_php_stream_bz2open", "(", "php_stream_wrapper", "*", "wrapper", ",", "VCWD_UNLINK", "(", "*", "opened_path", ")", ";", "}", "}", "if", "(", "bz_file", ")", "{", "retstream", "=", "_php_stream_bz2open_from_BZFILE", "(", "bz_file", ",", "mode", ",", "stream", "STREAMS_REL_CC", "TSRMLS_CC", ")", ";", "if", "(", "retstream", ")", "{", "@", "@", "-", "340", ",", "7", "+", "344", ",", "7", "@", "@", "static", "PHP_FUNCTION", "(", "bzread", ")", "if", "(", "FAILURE", "=", "=", "zend_parse_parameters", "(", "ZEND_NUM_ARGS", "(", ")", "TSRMLS_CC", ",", "\"", "r", "|", "l", "\"", ",", "&", "bz", ",", "&", "len", ")", ")", "{", "RETURN_FALSE", ";", "}", "php_stream_from_zval", "(", "stream", ",", "&", "bz", ")", ";", "if", "(", "(", "len", "+", "1", ")", "<", "1", ")", "{", "@", "@", "-", "350", ",", "13", "+", "354", ",", "13", "@", "@", "static", "PHP_FUNCTION", "(", "bzread", ")", "Z_STRVAL_P", "(", "return_value", ")", "=", "emalloc", "(", "len", "+", "1", ")", ";", "Z_STRLEN_P", "(", "return_value", ")", "=", "php_stream_read", "(", "stream", ",", "Z_STRVAL_P", "(", "return_value", ")", ",", "len", ")", ";", "if", "(", "Z_STRLEN_P", "(", "return_value", ")", "<", "0", ")", "{", "efree", "(", "Z_STRVAL_P", "(", "return_value", ")", ");", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "could", "not", "read", "valid", "bz2", "data", "from", "stream", "\"", ");", "RETURN_FALSE", ";", "RETURN_FALSE", ";", "}", "Z_STRVAL_P", "(", "return_value", ")", "[", "Z_STRLEN_P", "(", "return_value", ")", "]", "=", "0", ";", "Z_TYPE_P", "(", "return_value", ")", "=", "IS_STRING", ";", "}", "@", "@", "-", "372", ",", "7", "+", "376", ",", "7", "@", "@", "static", "PHP_FUNCTION", "(", "bzopen", ")", "BZFILE", "*", "bz", ";", "/", "*", "The", "compressed", "file", "stream", "*", "/", "php_stream", "*", "stream", "=", "NULL", ";", "if", "(", "zend_parse_parameters", "(", "ZEND_NUM_ARGS", "(", ")", "TSRMLS_CC", ",", "\"", "Zs", "\"", ",", "&", "file", ",", "&", "mode", ",", "&", "mode_len", ")", "=", "=", "FAILURE", ")", "{", "return", ";", "}", "@", "@", "-", "388", ",", "15", "+", "392", ",", "15", "@", "@", "static", "PHP_FUNCTION", "(", "bzopen", ")", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "filename", "cannot", "be", "empty", "\"", ");", "RETURN_FALSE", ";", "}", "if", "(", "CHECK_ZVAL_NULL_PATH", "(", "*", "file", ")", ")", "{", "RETURN_FALSE", ";", "}", "stream", "=", "php_stream_bz2open", "(", "NULL", ",", "Z_STRVAL_PP", "(", "file", ")", ",", "mode", ",", "REPORT_ERRORS", ",", "Z_STRVAL_PP", "(", "file", ")", ",", "mode", ",", "REPORT_ERRORS", ",", "NULL", ")", ";", "}", "else", "if", "(", "Z_TYPE_PP", "(", "file", ")", "=", "=", "IS_RESOURCE", ")", "{", "/", "*", "If", "it", "is", "a", "resource", ",", "than", "its", "a", "stream", "resource", "*", "/", "@", "@", "-", "405", ",", "7", "+", "409", ",", "7", "@", "@", "static", "PHP_FUNCTION", "(", "bzopen", ")", "php_stream_from_zval", "(", "stream", ",", "file", ")", ";", "stream_mode_len", "=", "strlen", "(", "stream", "-", ">", "mode", ")", ";", "if", "(", "stream_mode_len", "!", "=", "1", "&", "&", "!", "(", "stream_mode_len", "=", "=", "2", "&", "&", "memchr", "(", "stream", "-", ">", "mode", ",", "'", "b", "'", ",", "2", ")", "))", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "cannot", "use", "stream", "opened", "in", "mode", "'", "%", "s", "'", "\",", "stream", "-", ">", "mode", ")", ";", "RETURN_FALSE", ";", "@", "@", "-", "439", ",", "7", "+", "443", ",", "7", "@", "@", "static", "PHP_FUNCTION", "(", "bzopen", ")", "if", "(", "FAILURE", "=", "=", "php_stream_cast", "(", "stream", ",", "PHP_STREAM_AS_FD", ",", "(", "void", "*", ")", "&", "fd", ",", "REPORT_ERRORS", ")", ")", "{", "RETURN_FALSE", ";", "}", "bz", "=", "BZ2_bzdopen", "(", "fd", ",", "mode", ")", ";", "stream", "=", "php_stream_bz2open_from_BZFILE", "(", "bz", ",", "mode", ",", "stream", ")", ";", "@", "@", "-", "493", ",", "7", "+", "497", ",", "7", "@", "@", "static", "PHP_FUNCTION", "(", "bzcompress", ")", "work_factor", "=", "0", ",", "/", "*", "Work", "factor", "for", "compression", "algorithm", "*", "/", "argc", ";", "/", "*", "Argument", "count", "*", "/", "int", "source_len", ";", "/", "*", "Length", "of", "the", "source", "data", "*", "/", "unsigned", "int", "dest_len", ";", "/", "*", "Length", "of", "the", "destination", "buffer", "*", "/", "unsigned", "int", "dest_len", ";", "/", "*", "Length", "of", "the", "destination", "buffer", "*", "/", "argc", "=", "ZEND_NUM_ARGS", "(", ");", "@", "@", "-", "502", ",", "19", "+", "506", ",", "19", "@", "@", "static", "PHP_FUNCTION", "(", "bzcompress", ")", "}", "/", "*", "Assign", "them", "to", "easy", "to", "use", "variables", ",", "dest_len", "is", "initially", "the", "length", "of", "the", "data", "+", ".", "01", "x", "length", "of", "data", "+", "600", "which", "is", "the", "largest", "size", "the", "results", "of", "the", "compression", "could", "possibly", "be", ",", "at", "least", "that", "'", "s", "what", "the", "libbz2", "docs", "say", "(", "thanks", "to", "jeremy", "@", "nirvani", ".", "net", "+", ".", "01", "x", "length", "of", "data", "+", "600", "which", "is", "the", "largest", "size", "the", "results", "of", "the", "compression", "could", "possibly", "be", ",", "at", "least", "that", "'", "s", "what", "the", "libbz2", "docs", "say", "(", "thanks", "to", "jeremy", "@", "nirvani", ".", "net", "for", "pointing", "this", "out", ")", ".", "*", "/", "dest_len", "=", "(", "unsigned", "int", ")", "(", "source_len", "+", "(", "0", ".", "01", "*", "source_len", ")", "+", "600", ")", ";", "/", "*", "Allocate", "the", "destination", "buffer", "*", "/", "dest", "=", "emalloc", "(", "dest_len", "+", "1", ")", ";", "/", "*", "Handle", "the", "optional", "arguments", "*", "/", "if", "(", "argc", ">", "1", ")", "{", "block_size", "=", "zblock_size", ";", "}", "if", "(", "argc", ">", "2", ")", "{", "work_factor", "=", "zwork_factor", ";", "}", "@", "@", "-", "564", ",", "7", "+", "568", ",", "7", "@", "@", "static", "PHP_FUNCTION", "(", "bzdecompress", ")", "/", "*", "in", "most", "cases", "bz2", "offers", "at", "least", "2", ":", "1", "compression", ",", "so", "we", "use", "that", "as", "our", "base", "*", "/", "bzs", ".", "avail_out", "=", "source_len", "*", "2", ";", "bzs", ".", "next_out", "=", "dest", "=", "emalloc", "(", "bzs", ".", "avail_out", "+", "1", ")", ";", "while", "(", "(", "error", "=", "BZ2_bzDecompress", "(", "&", "bzs", ")", ")", "=", "=", "BZ_OK", "&", "&", "bzs", ".", "avail_in", ">", "0", ")", "{", "/", "*", "compression", "is", "better", "then", "2", ":", "1", ",", "need", "to", "allocate", "more", "memory", "*", "/", "bzs", ".", "avail_out", "=", "source_len", ";", "@", "@", "-", "590", ",", "13", "+", "594", ",", "13", "@", "@", "static", "PHP_FUNCTION", "(", "bzdecompress", ")", "/", "*", "{", "{{", "php_bz2_error", "(", ")", "The", "central", "error", "handling", "interface", ",", "does", "the", "work", "for", "bzerrno", ",", "bzerrstr", "and", "bzerror", "*", "/", "static", "void", "php_bz2_error", "(", "INTERNAL_FUNCTION_PARAMETERS", ",", "int", "opt", ")", "{", "{", "zval", "*", "bzp", ";", "/", "*", "BZip2", "Resource", "Pointer", "*", "/", "php_stream", "*", "stream", ";", "const", "char", "*", "errstr", ";", "/", "*", "Error", "string", "*", "/", "int", "errnum", ";", "/", "*", "Error", "number", "*", "/", "struct", "php_bz2_stream_data_t", "*", "self", ";", "if", "(", "zend_parse_parameters", "(", "ZEND_NUM_ARGS", "(", ")", "TSRMLS_CC", ",", "\"", "r", "\"", ",", "&", "bzp", ")", "=", "=", "FAILURE", ")", "{", "return", ";", "}", "@", "@", "-", "608", ",", "10", "+", "612", ",", "10", "@", "@", "static", "void", "php_bz2_error", "(", "INTERNAL_FUNCTION_PARAMETERS", ",", "int", "opt", ")", "}", "self", "=", "(", "struct", "php_bz2_stream_data_t", "*", ")", "stream", "-", ">", "abstract", ";", "/", "*", "Fetch", "the", "error", "information", "*", "/", "errstr", "=", "BZ2_bzerror", "(", "self", "-", ">", "bz_file", ",", "&", "errnum", ")", ";", "/", "*", "Determine", "what", "to", "return", "*", "/", "switch", "(", "opt", ")", "{", "case", "PHP_BZ_ERRNO", ":", "@", "@", "-", "622", ",", "7", "+", "626", ",", "7", "@", "@", "static", "void", "php_bz2_error", "(", "INTERNAL_FUNCTION_PARAMETERS", ",", "int", "opt", ")", "break", ";", "case", "PHP_BZ_ERRBOTH", ":", "array_init", "(", "return_value", ")", ";", "add_assoc_long", "(", "return_value", ",", "\"", "errno", "\"", ",", "errnum", ")", ";", "add_assoc_string", "(", "return_value", ",", "\"", "errstr", "\"", ",", "(", "char", "*", ")", "errstr", ",", "1", ")", ";", "break", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "23", "@", "@", "-", "-", "TEST", "-", "-", "Bug", "#", "72613", "(", "Inadequate", "error", "handling", "in", "bzread", "(", "))", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "\"", "bz2", "\"", "))", "print", "\"", "skip", "\"", ";", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "fp", "=", "bzopen", "(", "__DIR__", ".", "'/", "72613", ".", "bz2", "'", ",", "'", "r", "'", ");", "if", "(", "$", "fp", "=", "==", "FALSE", ")", "{", "exit", "(", "\"", "ERROR", ":", "bzopen", "(", ")\"", ");", "}", "$", "data", "=", "\"", "\";", "while", "(", "!", "feof", "(", "$", "fp", ")", ")", "{", "$", "res", "=", "bzread", "(", "$", "fp", ")", ";", "if", "(", "$", "res", "=", "==", "FALSE", ")", "{", "exit", "(", "\"", "ERROR", ":", "bzread", "(", ")\"", ");", "}", "$", "data", ".", "=", "$", "res", ";", "}", "bzclose", "(", "$", "fp", ")", ";", "?", ">", "DONE", "-", "-", "EXPECT", "-", "-", "DONE", "\\", "No", "newline", "at", "end", "of", "file"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Initialise", "X509_STORE_CTX", "properly", "so", "CRLs", "with", "nextUpdate", "date", "in", "the", "past", "produce", "an", "error", "(CVE-2011-3207)"], "code_tokens": ["@", "@", "-", "431", ",", "8", "+", "431", ",", "12", "@", "@", "Changes", "between", "1", ".", "0", ".", "0d", "and", "1", ".", "0", ".", "0e", "[", "xx", "XXX", "xxxx", "]", "*", ")", "Fix", "bug", "where", "CRLs", "with", "nextUpdate", "in", "the", "past", "are", "sometimes", "accepted", "by", "initialising", "X509_STORE_CTX", "properly", ".", "(", "CVE", "-", "2011", "-", "3207", ")", "[", "Kaspar", "Brand", "<", "ossl", "@", "velox", ".", "ch", ">", "]", "*", ")", "Fix", "SSL", "memory", "handling", "for", "(", "EC", ")", "DH", "ciphersuites", ",", "in", "particular", "for", "multi", "-", "threaded", "use", "of", "ECDH", ".", "for", "multi", "-", "threaded", "use", "of", "ECDH", ".", "(", "CVE", "-", "2011", "-", "3210", ")", "[", "Adam", "Langley", "(", "Google", ")", "]", "*", ")", "Fix", "x509_name_ex_d2i", "memory", "leak", "on", "bad", "inputs", ".", "@", "@", "-", "745", ",", "6", "+", "745", ",", "7", "@", "@", "static", "int", "check_cert", "(", "X509_STORE_CTX", "*", "ctx", ")", "x", "=", "sk_X509_value", "(", "ctx", "-", ">", "chain", ",", "cnum", ")", ";", "ctx", "-", ">", "current_cert", "=", "x", ";", "ctx", "-", ">", "current_issuer", "=", "NULL", ";", "ctx", "-", ">", "current_crl_score", "=", "0", ";", "ctx", "-", ">", "current_reasons", "=", "0", ";", "while", "(", "ctx", "-", ">", "current_reasons", "!", "=", "CRLDP_ALL_REASONS", ")", "{", "@", "@", "-", "2057", ",", "6", "+", "2058", ",", "9", "@", "@", "int", "X509_STORE_CTX_init", "(", "X509_STORE_CTX", "*", "ctx", ",", "X509_STORE", "*", "store", ",", "X509", "*", "x509", ",", "ctx", "-", ">", "error_depth", "=", "0", ";", "ctx", "-", ">", "current_cert", "=", "NULL", ";", "ctx", "-", ">", "current_issuer", "=", "NULL", ";", "ctx", "-", ">", "current_crl", "=", "NULL", ";", "ctx", "-", ">", "current_crl_score", "=", "0", ";", "ctx", "-", ">", "current_reasons", "=", "0", ";", "ctx", "-", ">", "tree", "=", "NULL", ";", "ctx", "-", ">", "parent", "=", "NULL", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["caddyhttp:", "Fix", "edgecase", "with", "auto", "HTTP->HTTPS", "logic", "(#4243)"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Ensuring", "all", "XML", "input", "processing", "is", "safe", "-", "disable", "DTD", "and", "external", "entities"], "code_tokens": ["@", "@", "-", "32", ",", "10", "+", "32", ",", "15", "@", "@", "public", "final", "class", "ReconciliationReportParser", "{", "private", "static", "final", "XMLInputFactory", "INPUT_FACTORY", "=", "XMLInputFactory", ".", "newInstance", "(", ");", "private", "static", "final", "XMLInputFactory", "XML_INPUT_FACTORY", "=", "XMLInputFactory", ".", "newInstance", "(", ");", "static", "{", "XML_INPUT_FACTORY", ".", "setProperty", "(", "XMLInputFactory", ".", "IS_SUPPORTING_EXTERNAL_ENTITIES", ",", "Boolean", ".", "FALSE", ")", ";", "XML_INPUT_FACTORY", ".", "setProperty", "(", "XMLInputFactory", ".", "SUPPORT_DTD", ",", "Boolean", ".", "FALSE", ")", ";", "}", "public", "static", "ReconciliationReport", "parse", "(", "final", "Date", "run", ",", "final", "InputStream", "in", ")", "throws", "XMLStreamException", "{", "XMLStreamReader", "streamReader", "=", "INPUT_FACTORY", ".", "createXMLStreamReader", "(", "in", ")", ";", "XMLStreamReader", "streamReader", "=", "XML_INPUT_FACTORY", ".", "createXMLStreamReader", "(", "in", ")", ";", "streamReader", ".", "nextTag", "(", ");", "/", "/", "root", "streamReader", ".", "nextTag", "(", ");", "/", "/", "report", "streamReader", ".", "nextTag", "(", ");", "/", "/", "reportlet", "@", "@", "-", "41", ",", "6", "+", "41", ",", "13", "@", "@", "private", "static", "final", "ObjectMapper", "OBJECT_MAPPER", "=", "new", "ObjectMapper", "(", ");", "private", "static", "final", "XMLInputFactory", "XML_INPUT_FACTORY", "=", "XMLInputFactory", ".", "newInstance", "(", ");", "static", "{", "XML_INPUT_FACTORY", ".", "setProperty", "(", "XMLInputFactory", ".", "IS_SUPPORTING_EXTERNAL_ENTITIES", ",", "Boolean", ".", "FALSE", ")", ";", "XML_INPUT_FACTORY", ".", "setProperty", "(", "XMLInputFactory", ".", "SUPPORT_DTD", ",", "Boolean", ".", "FALSE", ")", ";", "}", "public", "static", "Deployment", "deployDefinition", "(", "final", "ProcessEngine", "engine", ",", "final", "String", "resourceName", ",", "final", "byte", "[", "]", "definition", ")", "{", "@", "@", "-", "58", ",", "7", "+", "65", ",", "7", "@", "@", "public", "static", "void", "deployModel", "(", "final", "ProcessEngine", "engine", ",", "final", "ProcessDefiniti", "getResourceAsStream", "(", "procDef", ".", "getDeploymentId", "(", "),", "procDef", ".", "getResourceName", "(", "))", ";", "InputStreamReader", "isr", "=", "new", "InputStreamReader", "(", "bpmnStream", ")", ")", "{", "xtr", "=", "XMLInputFactory", ".", "newInstance", "(", ").", "createXMLStreamReader", "(", "isr", ")", ";", "xtr", "=", "XML_INPUT_FACTORY", ".", "createXMLStreamReader", "(", "isr", ")", ";", "BpmnModel", "bpmnModel", "=", "new", "BpmnXMLConverter", "(", ").", "convertToBpmnModel", "(", "xtr", ")", ";", "Model", "model", "=", "engine", ".", "getRepositoryService", "(", ").", "newModel", "(", ");", "@", "@", "-", "18", ",", "16", "+", "18", ",", "14", "@", "@", "*", "/", "package", "org", ".", "apache", ".", "syncope", ".", "core", ".", "flowable", ".", "support", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "javax", ".", "sql", ".", "DataSource", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang3", ".", "StringUtils", ";", "import", "org", ".", "flowable", ".", "engine", ".", "ProcessEngine", ";", "import", "org", ".", "flowable", ".", "common", ".", "engine", ".", "impl", ".", "cfg", ".", "SpringBeanFactoryProxyMap", ";", "import", "org", ".", "flowable", ".", "common", ".", "engine", ".", "impl", ".", "interceptor", ".", "EngineConfigurationConstants", ";", "import", "org", ".", "flowable", ".", "engine", ".", "form", ".", "AbstractFormType", ";", "import", "org", ".", "flowable", ".", "engine", ".", "impl", ".", "util", ".", "EngineServiceUtil", ";", "import", "org", ".", "flowable", ".", "idm", ".", "spring", ".", "SpringIdmEngineConfiguration", ";", "import", "org", ".", "flowable", ".", "spring", ".", "SpringExpressionManager", ";", "@", "@", "-", "84", ",", "9", "+", "82", ",", "8", "@", "@", "public", "DomainProcessEngine", "getObject", "(", ")", "throws", "Exception", "{", "EngineConfigurationConstants", ".", "KEY_IDM_ENGINE_CONFIG", ",", "ctx", ".", "getBean", "(", "SpringIdmEngineConfiguration", ".", "class", ")", ");", "}", "List", "<", "AbstractFormType", ">", "customFormTypes", "=", "new", "ArrayList", "<", ">(", ");", "customFormTypes", ".", "add", "(", "new", "DropdownFormType", "(", "null", ")", ");", "conf", ".", "setCustomFormTypes", "(", "customFormTypes", ")", ";", "conf", ".", "setEnableSafeBpmnXml", "(", "true", ")", ";", "conf", ".", "setCustomFormTypes", "(", "Arrays", ".", "asList", "(", "new", "DropdownFormType", "(", "null", ")", "))", ";", "engines", ".", "put", "(", "domain", ",", "conf", ".", "buildProcessEngine", "(", "))", ";", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["PCI:", "Add", "MCFG", "quirks", "for", "HiSilicon", "Hip05/06/07", "host", "controllers", "The", "PCIe", "controller", "in", "Hip05/Hip06/Hip07", "SoCs", "is", "not", "completely", "ECAM-compliant.", "It", "is", "non-ECAM", "only", "for", "the", "RC", "bus", "config", "space;", "for", "any", "other", "bus", "underneath", "the", "root", "bus", "it", "does", "support", "ECAM", "access.", "Add", "specific", "quirks", "for", "PCI", "config", "space", "accessors.", "This", "involves:", "1.", "New", "initialization", "call", "hisi_pcie_init()", "to", "obtain", "RC", "base", "addresses", "from", "PNP0C02", "at", "the", "root", "of", "the", "ACPI", "namespace", "(under", "\\_SB).", "2.", "New", "entry", "in", "common", "quirk", "array.", "[bhelgaas:", "move", "to", "pcie-hisi.c", "and", "change", "Makefile/ifdefs", "so", "quirk", "doesn't", "depend", "on", "CONFIG_PCI_HISI]", "Signed-off-by:", "Dongdong", "Liu", "<liudongdong3@huawei.com>", "Signed-off-by:", "Gabriele", "Paoloni", "<gabriele.paoloni@huawei.com>", "Signed-off-by:", "Bjorn", "Helgaas", "<bhelgaas@google.com>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["build", "check"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["audit:", "fix", "a", "double", "fetch", "in", "audit_log_single_execve_arg()", "There", "is", "a", "double", "fetch", "problem", "in", "audit_log_single_execve_arg()", "where", "we", "first", "check", "the", "execve(2)", "argumnets", "for", "any", "\"bad\"", "characters", "which", "would", "require", "hex", "encoding", "and", "then", "re-fetch", "the", "arguments", "for", "logging", "in", "the", "audit", "record[1].", "Of", "course", "this", "leaves", "a", "window", "of", "opportunity", "for", "an", "unsavory", "application", "to", "munge", "with", "the", "data.", "This", "patch", "reworks", "things", "by", "only", "fetching", "the", "argument", "data", "once[2]", "into", "a", "buffer", "where", "it", "is", "scanned", "and", "logged", "into", "the", "audit", "records(s).", "In", "addition", "to", "fixing", "the", "double", "fetch,", "this", "patch", "improves", "on", "the", "original", "code", "in", "a", "few", "other", "ways:", "better", "handling", "of", "large", "arguments", "which", "require", "encoding,", "stricter", "record", "length", "checking,", "and", "some", "performance", "improvements", "(completely", "unverified,", "but", "we", "got", "rid", "of", "some", "strlen()", "calls,", "that's", "got", "to", "be", "a", "good", "thing).", "As", "part", "of", "the", "development", "of", "this", "patch,", "I've", "also", "created", "a", "basic", "regression", "test", "for", "the", "audit-testsuite,", "the", "test", "can", "be", "tracked", "on", "GitHub", "at", "the", "following", "link:", "*", "https://github.com/linux-audit/audit-testsuite/issues/25", "[1]", "If", "you", "pay", "careful", "attention,", "there", "is", "actually", "a", "triple", "fetch", "problem", "due", "to", "a", "strnlen_user()", "call", "at", "the", "top", "of", "the", "function.", "[2]", "This", "is", "a", "tiny", "white", "lie,", "we", "do", "make", "a", "call", "to", "strnlen_user()", "prior", "to", "fetching", "the", "argument", "data.", "I", "don't", "like", "it,", "but", "due", "to", "the", "way", "the", "audit", "record", "is", "structured", "we", "really", "have", "no", "choice", "unless", "we", "copy", "the", "entire", "argument", "at", "once", "(which", "would", "require", "a", "rather", "wasteful", "allocation).", "The", "good", "news", "is", "that", "with", "this", "patch", "the", "kernel", "no", "longer", "relies", "on", "this", "strnlen_user()", "value", "for", "anything", "beyond", "recording", "it", "in", "the", "log,", "we", "also", "update", "it", "with", "a", "trustworthy", "value", "whenever", "possible.", "Reported-by:", "Pengfei", "Wang", "<wpengfeinudt@gmail.com>", "Cc:", "<stable@vger.kernel.org>", "Signed-off-by:", "Paul", "Moore", "<paul@paul-moore.com>"], "code_tokens": ["@", "@", "-", "73", ",", "6", "+", "73", ",", "7", "@", "@", "#", "include", "<", "linux", "/", "compat", ".", "h", ">", "#", "include", "<", "linux", "/", "ctype", ".", "h", ">", "#", "include", "<", "linux", "/", "string", ".", "h", ">", "#", "include", "<", "linux", "/", "uaccess", ".", "h", ">", "#", "include", "<", "uapi", "/", "linux", "/", "limits", ".", "h", ">", "#", "include", "\"", "audit", ".", "h", "\"", "@", "@", "-", "82", ",", "7", "+", "83", ",", "8", "@", "@", "#", "define", "AUDITSC_SUCCESS", "1", "#", "define", "AUDITSC_FAILURE", "2", "/", "*", "no", "execve", "audit", "message", "should", "be", "longer", "than", "this", "(", "userspace", "limits", ")", "*", "/", "/", "*", "no", "execve", "audit", "message", "should", "be", "longer", "than", "this", "(", "userspace", "limits", ")", ",", "*", "see", "the", "note", "near", "the", "top", "of", "audit_log_execve_info", "(", ")", "about", "this", "value", "*", "/", "#", "define", "MAX_EXECVE_AUDIT_LEN", "7500", "/", "*", "max", "length", "to", "print", "of", "cmdline", "/", "proctitle", "value", "during", "audit", "*", "/", "@", "@", "-", "992", ",", "184", "+", "994", ",", "178", "@", "@", "static", "int", "audit_log_pid_context", "(", "struct", "audit_context", "*", "context", ",", "pid_t", "pid", ",", "return", "rc", ";", "}", "/", "*", "*", "to_send", "and", "len_sent", "accounting", "are", "very", "loose", "estimates", ".", "We", "aren", "'", "t", "*", "really", "worried", "about", "a", "hard", "cap", "to", "MAX_EXECVE_AUDIT_LEN", "so", "much", "as", "being", "*", "within", "about", "500", "bytes", "(", "next", "page", "boundary", ")", "*", "*", "why", "snprintf", "?", "an", "int", "is", "up", "to", "12", "digits", "long", ".", "if", "we", "just", "assumed", "when", "*", "logging", "that", "a", "[", "%", "d", "]", "=", "was", "going", "to", "be", "16", "characters", "long", "we", "would", "be", "wasting", "*", "space", "in", "every", "audit", "message", ".", "In", "one", "7500", "byte", "message", "we", "can", "log", "up", "to", "*", "about", "1000", "min", "size", "arguments", ".", "That", "comes", "down", "to", "about", "50", "%", "waste", "of", "space", "*", "if", "we", "didn", "'", "t", "do", "the", "snprintf", "to", "find", "out", "how", "long", "arg_num_len", "was", ".", "*", "/", "static", "int", "audit_log_single_execve_arg", "(", "struct", "audit_context", "*", "context", ",", "struct", "audit_buffer", "*", "*", "ab", ",", "int", "arg_num", ",", "size_t", "*", "len_sent", ",", "const", "char", "__user", "*", "p", ",", "char", "*", "buf", ")", "static", "void", "audit_log_execve_info", "(", "struct", "audit_context", "*", "context", ",", "struct", "audit_buffer", "*", "*", "ab", ")", "{", "char", "arg_num_len_buf", "[", "12", "]", ";", "const", "char", "__user", "*", "tmp_p", "=", "p", ";", "/", "*", "how", "many", "digits", "are", "in", "arg_num", "?", "5", "is", "the", "length", "of", "'", "a", "=", "\"\"", "'", "*", "/", "size_t", "arg_num_len", "=", "snprintf", "(", "arg_num_len_buf", ",", "12", ",", "\"", "%", "d", "\"", ",", "arg_num", ")", "+", "5", ";", "size_t", "len", ",", "len_left", ",", "to_send", ";", "size_t", "max_execve_audit_len", "=", "MAX_EXECVE_AUDIT_LEN", ";", "unsigned", "int", "i", ",", "has_cntl", "=", "0", ",", "too_long", "=", "0", ";", "int", "ret", ";", "/", "*", "strnlen_user", "includes", "the", "null", "we", "don", "'", "t", "want", "to", "send", "*", "/", "len_left", "=", "len", "=", "strnlen_user", "(", "p", ",", "MAX_ARG_STRLEN", ")", "-", "1", ";", "/", "*", "*", "We", "just", "created", "this", "mm", ",", "if", "we", "can", "'", "t", "find", "the", "strings", "*", "we", "just", "copied", "into", "it", "something", "is", "_very_", "wrong", ".", "Similar", "*", "for", "strings", "that", "are", "too", "long", ",", "we", "should", "not", "have", "created", "*", "any", ".", "*", "/", "if", "(", "WARN_ON_ONCE", "(", "len", "<", "0", "|", "|", "len", ">", "MAX_ARG_STRLEN", "-", "1", ")", ")", "{", "send_sig", "(", "SIGKILL", ",", "current", ",", "0", ")", ";", "return", "-", "1", ";", "long", "len_max", ";", "long", "len_rem", ";", "long", "len_full", ";", "long", "len_buf", ";", "long", "len_abuf", ";", "long", "len_tmp", ";", "bool", "require_data", ";", "bool", "encode", ";", "unsigned", "int", "iter", ";", "unsigned", "int", "arg", ";", "char", "*", "buf_head", ";", "char", "*", "buf", ";", "const", "char", "__user", "*", "p", "=", "(", "const", "char", "__user", "*", ")", "current", "-", ">", "mm", "-", ">", "arg_start", ";", "/", "*", "NOTE", ":", "this", "buffer", "needs", "to", "be", "large", "enough", "to", "hold", "all", "the", "non", "-", "arg", "*", "data", "we", "put", "in", "the", "audit", "record", "for", "this", "argument", "(", "see", "the", "*", "code", "below", ")", ".", "..", "at", "this", "point", "in", "time", "96", "is", "plenty", "*", "/", "char", "abuf", "[", "96", "]", ";", "/", "*", "NOTE", ":", "we", "set", "MAX_EXECVE_AUDIT_LEN", "to", "a", "rather", "arbitrary", "limit", ",", "the", "*", "current", "value", "of", "7500", "is", "not", "as", "important", "as", "the", "fact", "that", "it", "*", "is", "less", "than", "8k", ",", "a", "setting", "of", "7500", "gives", "us", "plenty", "of", "wiggle", "*", "room", "if", "we", "go", "over", "a", "little", "bit", "in", "the", "logging", "below", "*", "/", "WARN_ON_ONCE", "(", "MAX_EXECVE_AUDIT_LEN", ">", "7500", ")", ";", "len_max", "=", "MAX_EXECVE_AUDIT_LEN", ";", "/", "*", "scratch", "buffer", "to", "hold", "the", "userspace", "args", "*", "/", "buf_head", "=", "kmalloc", "(", "MAX_EXECVE_AUDIT_LEN", "+", "1", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "buf_head", ")", "{", "audit_panic", "(", "\"", "out", "of", "memory", "for", "argv", "string", "\"", ");", "return", ";", "}", "buf", "=", "buf_head", ";", "/", "*", "walk", "the", "whole", "argument", "looking", "for", "non", "-", "ascii", "chars", "*", "/", "audit_log_format", "(", "*", "ab", ",", "\"", "argc", "=", "%", "d", "\"", ",", "context", "-", ">", "execve", ".", "argc", ")", ";", "len_rem", "=", "len_max", ";", "len_buf", "=", "0", ";", "len_full", "=", "0", ";", "require_data", "=", "true", ";", "encode", "=", "false", ";", "iter", "=", "0", ";", "arg", "=", "0", ";", "do", "{", "if", "(", "len_left", ">", "MAX_EXECVE_AUDIT_LEN", ")", "to_send", "=", "MAX_EXECVE_AUDIT_LEN", ";", "else", "to_send", "=", "len_left", ";", "ret", "=", "copy_from_user", "(", "buf", ",", "tmp_p", ",", "to_send", ")", ";", "/", "*", "*", "There", "is", "no", "reason", "for", "this", "copy", "to", "be", "short", ".", "We", "just", "*", "copied", "them", "here", ",", "and", "the", "mm", "hasn", "'", "t", "been", "exposed", "to", "user", "*", "space", "yet", ".", "*", "/", "if", "(", "ret", ")", "{", "WARN_ON", "(", "1", ")", ";", "send_sig", "(", "SIGKILL", ",", "current", ",", "0", ")", ";", "return", "-", "1", ";", "}", "buf", "[", "to_send", "]", "=", "'", "\\", "0", "'", ";", "has_cntl", "=", "audit_string_contains_control", "(", "buf", ",", "to_send", ")", ";", "if", "(", "has_cntl", ")", "{", "/", "*", "*", "hex", "messages", "get", "logged", "as", "2", "bytes", ",", "so", "we", "can", "only", "*", "send", "half", "as", "much", "in", "each", "message", "*", "/", "max_execve_audit_len", "=", "MAX_EXECVE_AUDIT_LEN", "/", "2", ";", "break", ";", "}", "len_left", "-", "=", "to_send", ";", "tmp_p", "+", "=", "to_send", ";", "}", "while", "(", "len_left", ">", "0", ")", ";", "len_left", "=", "len", ";", "if", "(", "len", ">", "max_execve_audit_len", ")", "too_long", "=", "1", ";", "/", "*", "rewalk", "the", "argument", "actually", "logging", "the", "message", "*", "/", "for", "(", "i", "=", "0", ";", "len_left", ">", "0", ";", "i", "+", "+)", "{", "int", "room_left", ";", "if", "(", "len_left", ">", "max_execve_audit_len", ")", "to_send", "=", "max_execve_audit_len", ";", "else", "to_send", "=", "len_left", ";", "/", "*", "do", "we", "have", "space", "left", "to", "send", "this", "argument", "in", "this", "ab", "?", "*", "/", "room_left", "=", "MAX_EXECVE_AUDIT_LEN", "-", "arg_num_len", "-", "*", "len_sent", ";", "if", "(", "has_cntl", ")", "room_left", "-", "=", "(", "to_send", "*", "2", ")", ";", "else", "room_left", "-", "=", "to_send", ";", "if", "(", "room_left", "<", "0", ")", "{", "*", "len_sent", "=", "0", ";", "audit_log_end", "(", "*", "ab", ")", ";", "*", "ab", "=", "audit_log_start", "(", "context", ",", "GFP_KERNEL", ",", "AUDIT_EXECVE", ")", ";", "if", "(", "!*", "ab", ")", "return", "0", ";", "}", "/", "*", "NOTE", ":", "we", "don", "'", "t", "ever", "want", "to", "trust", "this", "value", "for", "anything", "*", "serious", ",", "but", "the", "audit", "record", "format", "insists", "we", "*", "provide", "an", "argument", "length", "for", "really", "long", "arguments", ",", "*", "e", ".", "g", ".", ">", "MAX_EXECVE_AUDIT_LEN", ",", "so", "we", "have", "no", "choice", "but", "*", "to", "use", "strncpy_from_user", "(", ")", "to", "obtain", "this", "value", "for", "*", "recording", "in", "the", "log", ",", "although", "we", "don", "'", "t", "use", "it", "*", "anywhere", "here", "to", "avoid", "a", "double", "-", "fetch", "problem", "*", "/", "if", "(", "len_full", "=", "=", "0", ")", "len_full", "=", "strnlen_user", "(", "p", ",", "MAX_ARG_STRLEN", ")", "-", "1", ";", "/", "*", "read", "more", "data", "from", "userspace", "*", "/", "if", "(", "require_data", ")", "{", "/", "*", "can", "we", "make", "more", "room", "in", "the", "buffer", "?", "*", "/", "if", "(", "buf", "!", "=", "buf_head", ")", "{", "memmove", "(", "buf_head", ",", "buf", ",", "len_buf", ")", ";", "buf", "=", "buf_head", ";", "}", "/", "*", "fetch", "as", "much", "as", "we", "can", "of", "the", "argument", "*", "/", "len_tmp", "=", "strncpy_from_user", "(", "&", "buf_head", "[", "len_buf", "]", ",", "p", ",", "len_max", "-", "len_buf", ")", ";", "if", "(", "len_tmp", "=", "=", "-", "EFAULT", ")", "{", "/", "*", "unable", "to", "copy", "from", "userspace", "*", "/", "send_sig", "(", "SIGKILL", ",", "current", ",", "0", ")", ";", "goto", "out", ";", "}", "else", "if", "(", "len_tmp", "=", "=", "(", "len_max", "-", "len_buf", ")", ")", "{", "/", "*", "buffer", "is", "not", "large", "enough", "*", "/", "require_data", "=", "true", ";", "/", "*", "NOTE", ":", "if", "we", "are", "going", "to", "span", "multiple", "*", "buffers", "force", "the", "encoding", "so", "we", "stand", "*", "a", "chance", "at", "a", "sane", "len_full", "value", "and", "*", "consistent", "record", "encoding", "*", "/", "encode", "=", "true", ";", "len_full", "=", "len_full", "*", "2", ";", "p", "+", "=", "len_tmp", ";", "}", "else", "{", "require_data", "=", "false", ";", "if", "(", "!", "encode", ")", "encode", "=", "audit_string_contains_control", "(", "buf", ",", "len_tmp", ")", ";", "/", "*", "try", "to", "use", "a", "trusted", "value", "for", "len_full", "*", "/", "if", "(", "len_full", "<", "len_max", ")", "len_full", "=", "(", "encode", "?", "len_tmp", "*", "2", ":", "len_tmp", ")", ";", "p", "+", "=", "len_tmp", "+", "1", ";", "}", "len_buf", "+", "=", "len_tmp", ";", "buf_head", "[", "len_buf", "]", "=", "'", "\\", "0", "'", ";", "/", "*", "*", "first", "record", "needs", "to", "say", "how", "long", "the", "original", "string", "was", "*", "so", "we", "can", "be", "sure", "nothing", "was", "lost", ".", "*", "/", "if", "(", "(", "i", "=", "=", "0", ")", "&", "&", "(", "too_long", ")", ")", "audit_log_format", "(", "*", "ab", ",", "\"", "a", "%", "d_len", "=", "%", "zu", "\"", ",", "arg_num", ",", "has_cntl", "?", "2", "*", "len", ":", "len", ")", ";", "/", "*", "*", "normally", "arguments", "are", "small", "enough", "to", "fit", "and", "we", "already", "*", "filled", "buf", "above", "when", "we", "checked", "for", "control", "characters", "*", "so", "don", "'", "t", "bother", "with", "another", "copy_from_user", "*", "/", "if", "(", "len", ">", "=", "max_execve_audit_len", ")", "ret", "=", "copy_from_user", "(", "buf", ",", "p", ",", "to_send", ")", ";", "else", "ret", "=", "0", ";", "if", "(", "ret", ")", "{", "WARN_ON", "(", "1", ")", ";", "send_sig", "(", "SIGKILL", ",", "current", ",", "0", ")", ";", "return", "-", "1", ";", "/", "*", "length", "of", "the", "buffer", "in", "the", "audit", "record", "?", "*", "/", "len_abuf", "=", "(", "encode", "?", "len_buf", "*", "2", ":", "len_buf", "+", "2", ")", ";", "}", "buf", "[", "to_send", "]", "=", "'", "\\", "0", "'", ";", "/", "*", "actually", "log", "it", "*", "/", "audit_log_format", "(", "*", "ab", ",", "\"", "a", "%", "d", "\"", ",", "arg_num", ")", ";", "if", "(", "too_long", ")", "audit_log_format", "(", "*", "ab", ",", "\"", "[%", "d", "]", "\",", "i", ")", ";", "audit_log_format", "(", "*", "ab", ",", "\"", "=\"", ");", "if", "(", "has_cntl", ")", "audit_log_n_hex", "(", "*", "ab", ",", "buf", ",", "to_send", ")", ";", "else", "audit_log_string", "(", "*", "ab", ",", "buf", ")", ";", "p", "+", "=", "to_send", ";", "len_left", "-", "=", "to_send", ";", "*", "len_sent", "+", "=", "arg_num_len", ";", "if", "(", "has_cntl", ")", "*", "len_sent", "+", "=", "to_send", "*", "2", ";", "else", "*", "len_sent", "+", "=", "to_send", ";", "}", "/", "*", "include", "the", "null", "we", "didn", "'", "t", "log", "*", "/", "return", "len", "+", "1", ";", "}", "static", "void", "audit_log_execve_info", "(", "struct", "audit_context", "*", "context", ",", "struct", "audit_buffer", "*", "*", "ab", ")", "{", "int", "i", ",", "len", ";", "size_t", "len_sent", "=", "0", ";", "const", "char", "__user", "*", "p", ";", "char", "*", "buf", ";", "/", "*", "write", "as", "much", "as", "we", "can", "to", "the", "audit", "log", "*", "/", "if", "(", "len_buf", ">", "0", ")", "{", "/", "*", "NOTE", ":", "some", "magic", "numbers", "here", "-", "basically", "if", "we", "*", "can", "'", "t", "fit", "a", "reasonable", "amount", "of", "data", "into", "the", "*", "existing", "audit", "buffer", ",", "flush", "it", "and", "start", "with", "*", "a", "new", "buffer", "*", "/", "if", "(", "(", "sizeof", "(", "abuf", ")", "+", "8", ")", ">", "len_rem", ")", "{", "len_rem", "=", "len_max", ";", "audit_log_end", "(", "*", "ab", ")", ";", "*", "ab", "=", "audit_log_start", "(", "context", ",", "GFP_KERNEL", ",", "AUDIT_EXECVE", ")", ";", "if", "(", "!*", "ab", ")", "goto", "out", ";", "}", "p", "=", "(", "const", "char", "__user", "*", ")", "current", "-", ">", "mm", "-", ">", "arg_start", ";", "/", "*", "create", "the", "non", "-", "arg", "portion", "of", "the", "arg", "record", "*", "/", "len_tmp", "=", "0", ";", "if", "(", "require_data", "|", "|", "(", "iter", ">", "0", ")", "|", "|", "(", "(", "len_abuf", "+", "sizeof", "(", "abuf", ")", ")", ">", "len_rem", ")", ")", "{", "if", "(", "iter", "=", "=", "0", ")", "{", "len_tmp", "+", "=", "snprintf", "(", "&", "abuf", "[", "len_tmp", "]", ",", "sizeof", "(", "abuf", ")", "-", "len_tmp", ",", "\"", "a", "%", "d_len", "=", "%", "lu", "\"", ",", "arg", ",", "len_full", ")", ";", "}", "len_tmp", "+", "=", "snprintf", "(", "&", "abuf", "[", "len_tmp", "]", ",", "sizeof", "(", "abuf", ")", "-", "len_tmp", ",", "\"", "a", "%", "d", "[", "%", "d", "]", "=\"", ",", "arg", ",", "iter", "+", "+)", ";", "}", "else", "len_tmp", "+", "=", "snprintf", "(", "&", "abuf", "[", "len_tmp", "]", ",", "sizeof", "(", "abuf", ")", "-", "len_tmp", ",", "\"", "a", "%", "d", "=", "\",", "arg", ")", ";", "WARN_ON", "(", "len_tmp", ">", "=", "sizeof", "(", "abuf", ")", ");", "abuf", "[", "sizeof", "(", "abuf", ")", "-", "1", "]", "=", "'", "\\", "0", "'", ";", "/", "*", "log", "the", "arg", "in", "the", "audit", "record", "*", "/", "audit_log_format", "(", "*", "ab", ",", "\"", "%", "s", "\"", ",", "abuf", ")", ";", "len_rem", "-", "=", "len_tmp", ";", "len_tmp", "=", "len_buf", ";", "if", "(", "encode", ")", "{", "if", "(", "len_abuf", ">", "len_rem", ")", "len_tmp", "=", "len_rem", "/", "2", ";", "/", "*", "encoding", "*", "/", "audit_log_n_hex", "(", "*", "ab", ",", "buf", ",", "len_tmp", ")", ";", "len_rem", "-", "=", "len_tmp", "*", "2", ";", "len_abuf", "-", "=", "len_tmp", "*", "2", ";", "}", "else", "{", "if", "(", "len_abuf", ">", "len_rem", ")", "len_tmp", "=", "len_rem", "-", "2", ";", "/", "*", "quotes", "*", "/", "audit_log_n_string", "(", "*", "ab", ",", "buf", ",", "len_tmp", ")", ";", "len_rem", "-", "=", "len_tmp", "+", "2", ";", "/", "*", "don", "'", "t", "subtract", "the", "\"", "2", "\"", "because", "we", "still", "need", "*", "to", "add", "quotes", "to", "the", "remaining", "string", "*", "/", "len_abuf", "-", "=", "len_tmp", ";", "}", "len_buf", "-", "=", "len_tmp", ";", "buf", "+", "=", "len_tmp", ";", "}", "audit_log_format", "(", "*", "ab", ",", "\"", "argc", "=", "%", "d", "\"", ",", "context", "-", ">", "execve", ".", "argc", ")", ";", "/", "*", "ready", "to", "move", "to", "the", "next", "argument", "?", "*", "/", "if", "(", "(", "len_buf", "=", "=", "0", ")", "&", "&", "!", "require_data", ")", "{", "arg", "+", "+;", "iter", "=", "0", ";", "len_full", "=", "0", ";", "require_data", "=", "true", ";", "encode", "=", "false", ";", "}", "}", "while", "(", "arg", "<", "context", "-", ">", "execve", ".", "argc", ")", ";", "/", "*", "*", "we", "need", "some", "kernel", "buffer", "to", "hold", "the", "userspace", "args", ".", "Just", "*", "allocate", "one", "big", "one", "rather", "than", "allocating", "one", "of", "the", "right", "size", "*", "for", "every", "single", "argument", "inside", "audit_log_single_execve_arg", "(", ")", "*", "should", "be", "<", "8k", "allocation", "so", "should", "be", "pretty", "safe", ".", "*", "/", "buf", "=", "kmalloc", "(", "MAX_EXECVE_AUDIT_LEN", "+", "1", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "buf", ")", "{", "audit_panic", "(", "\"", "out", "of", "memory", "for", "argv", "string", "\"", ");", "return", ";", "}", "/", "*", "NOTE", ":", "the", "caller", "handles", "the", "final", "audit_log_end", "(", ")", "call", "*", "/", "for", "(", "i", "=", "0", ";", "i", "<", "context", "-", ">", "execve", ".", "argc", ";", "i", "+", "+)", "{", "len", "=", "audit_log_single_execve_arg", "(", "context", ",", "ab", ",", "i", ",", "&", "len_sent", ",", "p", ",", "buf", ")", ";", "if", "(", "len", "<", "=", "0", ")", "break", ";", "p", "+", "=", "len", ";", "}", "kfree", "(", "buf", ")", ";", "out", ":", "kfree", "(", "buf_head", ")", ";", "}", "static", "void", "show_special", "(", "struct", "audit_context", "*", "context", ",", "int", "*", "call_panic", ")"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Merge", "branch", "'detect_musl_and_turn_off_tls_attribute'", "into", "PHP-8.0"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["KEYS:", "fix", "keyctl_set_reqkey_keyring()", "to", "not", "leak", "thread", "keyrings", "This", "fixes", "CVE-2017-7472.", "Running", "the", "following", "program", "as", "an", "unprivileged", "user", "exhausts", "kernel", "memory", "by", "leaking", "thread", "keyrings:", "#include", "<keyutils.h>", "int", "main()", "{", "for", "(;;)", "keyctl_set_reqkey_keyring(KEY_REQKEY_DEFL_THREAD_KEYRING);", "}", "Fix", "it", "by", "only", "creating", "a", "new", "thread", "keyring", "if", "there", "wasn't", "one", "before.", "To", "make", "things", "more", "consistent,", "make", "install_thread_keyring_to_cred()", "and", "install_process_keyring_to_cred()", "both", "return", "0", "if", "the", "corresponding", "keyring", "is", "already", "present.", "Fixes:", "d84f4f992cbd", "(\"CRED:", "Inaugurate", "COW", "credentials\")", "Cc:", "stable@vger.kernel.org", "#", "2.6.29+", "Signed-off-by:", "Eric", "Biggers", "<ebiggers@google.com>", "Signed-off-by:", "David", "Howells", "<dhowells@redhat.com>"], "code_tokens": ["@", "@", "-", "1258", ",", "8", "+", "1258", ",", "8", "@", "@", "long", "keyctl_reject_key", "(", "key_serial_t", "id", ",", "unsigned", "timeout", ",", "unsigned", "error", ",", "*", "Read", "or", "set", "the", "default", "keyring", "in", "which", "request_key", "(", ")", "will", "cache", "keys", "and", "*", "return", "the", "old", "setting", ".", "*", "*", "If", "a", "process", "keyring", "is", "specified", "then", "this", "will", "be", "created", "if", "it", "doesn", "'", "t", "*", "yet", "exist", ".", "The", "old", "setting", "will", "be", "returned", "if", "successful", ".", "*", "If", "a", "thread", "or", "process", "keyring", "is", "specified", "then", "it", "will", "be", "created", "if", "it", "*", "doesn", "'", "t", "yet", "exist", ".", "The", "old", "setting", "will", "be", "returned", "if", "successful", ".", "*", "/", "long", "keyctl_set_reqkey_keyring", "(", "int", "reqkey_defl", ")", "{", "@", "@", "-", "1284", ",", "11", "+", "1284", ",", "8", "@", "@", "long", "keyctl_set_reqkey_keyring", "(", "int", "reqkey_defl", ")", "case", "KEY_REQKEY_DEFL_PROCESS_KEYRING", ":", "ret", "=", "install_process_keyring_to_cred", "(", "new", ")", ";", "if", "(", "ret", "<", "0", ")", "{", "if", "(", "ret", "!", "=", "-", "EEXIST", ")", "goto", "error", ";", "ret", "=", "0", ";", "}", "if", "(", "ret", "<", "0", ")", "goto", "error", ";", "goto", "set", ";", "case", "KEY_REQKEY_DEFL_DEFAULT", ":", "@", "@", "-", "128", ",", "13", "+", "128", ",", "18", "@", "@", "int", "install_user_keyrings", "(", "void", ")", "}", "/", "*", "*", "Install", "a", "fresh", "thread", "keyring", "directly", "to", "new", "credentials", ".", "This", "keyring", "is", "*", "allowed", "to", "overrun", "the", "quota", ".", "*", "Install", "a", "thread", "keyring", "to", "the", "given", "credentials", "struct", "if", "it", "didn", "'", "t", "have", "*", "one", "already", ".", "This", "is", "allowed", "to", "overrun", "the", "quota", ".", "*", "*", "Return", ":", "0", "if", "a", "thread", "keyring", "is", "now", "present", ";", "-", "errno", "on", "failure", ".", "*", "/", "int", "install_thread_keyring_to_cred", "(", "struct", "cred", "*", "new", ")", "{", "struct", "key", "*", "keyring", ";", "if", "(", "new", "-", ">", "thread_keyring", ")", "return", "0", ";", "keyring", "=", "keyring_alloc", "(", "\"", "_tid", "\"", ",", "new", "-", ">", "uid", ",", "new", "-", ">", "gid", ",", "new", ",", "KEY_POS_ALL", "|", "KEY_USR_VIEW", ",", "KEY_ALLOC_QUOTA_OVERRUN", ",", "@", "@", "-", "147", ",", "7", "+", "152", ",", "9", "@", "@", "int", "install_thread_keyring_to_cred", "(", "struct", "cred", "*", "new", ")", "}", "/", "*", "*", "Install", "a", "fresh", "thread", "keyring", ",", "discarding", "the", "old", "one", ".", "*", "Install", "a", "thread", "keyring", "to", "the", "current", "task", "if", "it", "didn", "'", "t", "have", "one", "already", ".", "*", "*", "Return", ":", "0", "if", "a", "thread", "keyring", "is", "now", "present", ";", "-", "errno", "on", "failure", ".", "*", "/", "static", "int", "install_thread_keyring", "(", "void", ")", "{", "@", "@", "-", "158", ",", "8", "+", "165", ",", "6", "@", "@", "static", "int", "install_thread_keyring", "(", "void", ")", "if", "(", "!", "new", ")", "return", "-", "ENOMEM", ";", "BUG_ON", "(", "new", "-", ">", "thread_keyring", ")", ";", "ret", "=", "install_thread_keyring_to_cred", "(", "new", ")", ";", "if", "(", "ret", "<", "0", ")", "{", "abort_creds", "(", "new", ")", ";", "@", "@", "-", "170", ",", "17", "+", "175", ",", "17", "@", "@", "static", "int", "install_thread_keyring", "(", "void", ")", "}", "/", "*", "*", "Install", "a", "process", "keyring", "directly", "to", "a", "credentials", "struct", ".", "*", "Install", "a", "process", "keyring", "to", "the", "given", "credentials", "struct", "if", "it", "didn", "'", "t", "have", "*", "one", "already", ".", "This", "is", "allowed", "to", "overrun", "the", "quota", ".", "*", "*", "Returns", "-", "EEXIST", "if", "there", "was", "already", "a", "process", "keyring", ",", "0", "if", "one", "installed", ",", "*", "and", "other", "value", "on", "any", "other", "error", "*", "Return", ":", "0", "if", "a", "process", "keyring", "is", "now", "present", ";", "-", "errno", "on", "failure", ".", "*", "/", "int", "install_process_keyring_to_cred", "(", "struct", "cred", "*", "new", ")", "{", "struct", "key", "*", "keyring", ";", "if", "(", "new", "-", ">", "process_keyring", ")", "return", "-", "EEXIST", ";", "return", "0", ";", "keyring", "=", "keyring_alloc", "(", "\"", "_pid", "\"", ",", "new", "-", ">", "uid", ",", "new", "-", ">", "gid", ",", "new", ",", "KEY_POS_ALL", "|", "KEY_USR_VIEW", ",", "@", "@", "-", "194", ",", "11", "+", "199", ",", "9", "@", "@", "int", "install_process_keyring_to_cred", "(", "struct", "cred", "*", "new", ")", "}", "/", "*", "*", "Make", "sure", "a", "process", "keyring", "is", "installed", "for", "the", "current", "process", ".", "The", "*", "existing", "process", "keyring", "is", "not", "replaced", ".", "*", "Install", "a", "process", "keyring", "to", "the", "current", "task", "if", "it", "didn", "'", "t", "have", "one", "already", ".", "*", "*", "Returns", "0", "if", "there", "is", "a", "process", "keyring", "by", "the", "end", "of", "this", "function", ",", "some", "*", "error", "otherwise", ".", "*", "Return", ":", "0", "if", "a", "process", "keyring", "is", "now", "present", ";", "-", "errno", "on", "failure", ".", "*", "/", "static", "int", "install_process_keyring", "(", "void", ")", "{", "@", "@", "-", "212", ",", "14", "+", "215", ",", "18", "@", "@", "static", "int", "install_process_keyring", "(", "void", ")", "ret", "=", "install_process_keyring_to_cred", "(", "new", ")", ";", "if", "(", "ret", "<", "0", ")", "{", "abort_creds", "(", "new", ")", ";", "return", "ret", "!", "=", "-", "EEXIST", "?", "ret", ":", "0", ";", "return", "ret", ";", "}", "return", "commit_creds", "(", "new", ")", ";", "}", "/", "*", "*", "Install", "a", "session", "keyring", "directly", "to", "a", "credentials", "struct", ".", "*", "Install", "the", "given", "keyring", "as", "the", "session", "keyring", "of", "the", "given", "credentials", "*", "struct", ",", "replacing", "the", "existing", "one", "if", "any", ".", "If", "the", "given", "keyring", "is", "NULL", ",", "*", "then", "install", "a", "new", "anonymous", "session", "keyring", ".", "*", "*", "Return", ":", "0", "on", "success", ";", "-", "errno", "on", "failure", ".", "*", "/", "int", "install_session_keyring_to_cred", "(", "struct", "cred", "*", "cred", ",", "struct", "key", "*", "keyring", ")", "{", "@", "@", "-", "254", ",", "8", "+", "261", ",", "11", "@", "@", "int", "install_session_keyring_to_cred", "(", "struct", "cred", "*", "cred", ",", "struct", "key", "*", "keyring", ")", "}", "/", "*", "*", "Install", "a", "session", "keyring", ",", "discarding", "the", "old", "one", ".", "If", "a", "keyring", "is", "not", "*", "supplied", ",", "an", "empty", "one", "is", "invented", ".", "*", "Install", "the", "given", "keyring", "as", "the", "session", "keyring", "of", "the", "current", "task", ",", "*", "replacing", "the", "existing", "one", "if", "any", ".", "If", "the", "given", "keyring", "is", "NULL", ",", "then", "*", "install", "a", "new", "anonymous", "session", "keyring", ".", "*", "*", "Return", ":", "0", "on", "success", ";", "-", "errno", "on", "failure", ".", "*", "/", "static", "int", "install_session_keyring", "(", "struct", "key", "*", "keyring", ")", "{"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["https://github.com/ImageMagick/ImageMagick/issues/3896"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["chore:", "bump", "Flow", "version", "to", "9.0", "(#11405)"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Add", "a", "test."], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["xfrm_user:", "validate", "XFRM_MSG_NEWAE", "XFRMA_REPLAY_ESN_VAL", "replay_window", "When", "a", "new", "xfrm", "state", "is", "created", "during", "an", "XFRM_MSG_NEWSA", "call", "we", "validate", "the", "user", "supplied", "replay_esn", "to", "ensure", "that", "the", "size", "is", "valid", "and", "to", "ensure", "that", "the", "replay_window", "size", "is", "within", "the", "allocated", "buffer.", "However", "later", "it", "is", "possible", "to", "update", "this", "replay_esn", "via", "a", "XFRM_MSG_NEWAE", "call.", "There", "we", "again", "validate", "the", "size", "of", "the", "supplied", "buffer", "matches", "the", "existing", "state", "and", "if", "so", "inject", "the", "contents.", "We", "do", "not", "at", "this", "point", "check", "that", "the", "replay_window", "is", "within", "the", "allocated", "memory.", "This", "leads", "to", "out-of-bounds", "reads", "and", "writes", "triggered", "by", "netlink", "packets.", "This", "leads", "to", "memory", "corruption", "and", "the", "potential", "for", "priviledge", "escalation.", "We", "already", "attempt", "to", "validate", "the", "incoming", "replay", "information", "in", "xfrm_new_ae()", "via", "xfrm_replay_verify_len().", "This", "confirms", "that", "the", "user", "is", "not", "trying", "to", "change", "the", "size", "of", "the", "replay", "state", "buffer", "which", "includes", "the", "replay_esn.", "It", "however", "does", "not", "check", "the", "replay_window", "remains", "within", "that", "buffer.", "Add", "validation", "of", "the", "contained", "replay_window.", "CVE-2017-7184", "Signed-off-by:", "Andy", "Whitcroft", "<apw@canonical.com>", "Acked-by:", "Steffen", "Klassert", "<steffen.klassert@secunet.com>", "Signed-off-by:", "Linus", "Torvalds", "<torvalds@linux-foundation.org>"], "code_tokens": ["@", "@", "-", "415", ",", "6", "+", "415", ",", "9", "@", "@", "static", "inline", "int", "xfrm_replay_verify_len", "(", "struct", "xfrm_replay_state_esn", "*", "replay_es", "if", "(", "nla_len", "(", "rp", ")", "<", "ulen", "|", "|", "xfrm_replay_state_esn_len", "(", "replay_esn", ")", "!", "=", "ulen", ")", "return", "-", "EINVAL", ";", "if", "(", "up", "-", ">", "replay_window", ">", "up", "-", ">", "bmp_len", "*", "sizeof", "(", "__u32", ")", "*", "8", ")", "return", "-", "EINVAL", ";", "return", "0", ";", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["[DS-3094]", "Apply", "attached", "patch"], "code_tokens": ["@", "@", "-", "37", ",", "6", "+", "37", ",", "9", "@", "@", "public", "void", "setup", "(", "SourceResolver", "resolver", ",", "Map", "objectModel", ",", "String", "src", ",", "Paramete", "/", "/", "If", "the", "requested", "path", "includes", "any", "of", "the", "following", "strings", "/", "characters", "/", "/", "then", "block", "access", "and", "return", "\"", "Resource", "Not", "Found", "\"", "if", "(", "src", "!", "=", "null", "&", "&", "(", "src", ".", "toLowerCase", "(", ").", "contains", "(", "\":", "\")", "|", "|", "/", "/", "%", "3a", "=", "encoded", "colon", "(", ":)", "src", ".", "toLowerCase", "(", ").", "contains", "(", "\"%", "3a", "\"", ")", "|", "|", "/", "/", "%", "252e", "=", "double", "encoded", "dot", "(", ".)", "src", ".", "toLowerCase", "(", ").", "contains", "(", "\"%", "252e", "\"", ")", "|", "|", "/", "/", "%", "2e", "=", "encoded", "dot", "(", ".)", "@", "@", "-", "0", ",", "0", "+", "1", ",", "74", "@", "@", "/", "**", "*", "The", "contents", "of", "this", "file", "are", "subject", "to", "the", "license", "and", "copyright", "*", "detailed", "in", "the", "LICENSE", "and", "NOTICE", "files", "at", "the", "root", "of", "the", "source", "*", "tree", "and", "available", "online", "at", "*", "*", "http", ":", "//", "www", ".", "dspace", ".", "org", "/", "license", "/", "*", "/", "package", "org", ".", "dspace", ".", "app", ".", "xmlui", ".", "cocoon", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "org", ".", "apache", ".", "avalon", ".", "framework", ".", "configuration", ".", "Configurable", ";", "import", "org", ".", "apache", ".", "avalon", ".", "framework", ".", "parameters", ".", "Parameters", ";", "import", "org", ".", "apache", ".", "cocoon", ".", "ProcessingException", ";", "import", "org", ".", "apache", ".", "cocoon", ".", "ResourceNotFoundException", ";", "import", "org", ".", "apache", ".", "cocoon", ".", "caching", ".", "CacheableProcessingComponent", ";", "import", "org", ".", "apache", ".", "cocoon", ".", "environment", ".", "SourceResolver", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang", ".", "StringUtils", ";", "import", "org", ".", "dspace", ".", "core", ".", "ConfigurationManager", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "/", "**", "*", "An", "XMLUI", "Theme", "Resource", "Reader", ",", "which", "ONLY", "allows", "for", "certain", "types", "of", "files", "*", "to", "be", "included", "in", "a", "themes", ".", "*", "*", "@", "author", "Tim", "Donohue", "*", "@", "author", "Andrea", "Schweer", "*", "/", "public", "class", "ThemeResourceReader", "extends", "SafeResourceReader", "implements", "CacheableProcessingComponent", ",", "Configurable", "{", "/", "/", "Default", "whitelist", "of", "file", "extensions", "that", "are", "allowed", "in", "an", "XMLUI", "theme", "protected", "String", "[", "]", "DEFAULT_WHITELIST", "=", "new", "String", "[", "]{", "\"", "css", "\"", ",", "\"", "js", "\"", ",", "\"", "json", "\"", ",", "\"", "gif", "\"", ",", "\"", "jpg", "\"", ",", "\"", "jpeg", "\"", ",", "\"", "png", "\"", ",", "\"", "ico", "\"", ",", "\"", "bmp", "\"", ",", "\"", "htm", "\"", ",", "\"", "html", "\"", ",", "\"", "svg", "\"", ",", "\"", "ttf", "\"", ",", "\"", "woff", "\"", "};", "@", "Override", "public", "void", "setup", "(", "SourceResolver", "resolver", ",", "Map", "objectModel", ",", "String", "src", ",", "Parameters", "par", ")", "throws", "ProcessingException", ",", "SAXException", ",", "IOException", "{", "/", "/", "If", "our", "XMLUI", "sitemap", "has", "specified", "to", "bypass", "the", "whitelist", "for", "this", "resource", ",", "/", "/", "then", "just", "let", "this", "through", "to", "the", "SafeResourceReader", "if", "(", "par", ".", "getParameterAsBoolean", "(", "\"", "bypass", "-", "whitelist", "\"", ",", "false", ")", ")", "{", "super", ".", "setup", "(", "resolver", ",", "objectModel", ",", "src", ",", "par", ")", ";", "return", ";", "}", "/", "/", "Otherwise", ",", "we", "'", "ll", "load", "our", "configured", "file", "-", "extension", "whitelist", "String", "whitelistProp", "=", "ConfigurationManager", ".", "getProperty", "(", "\"", "xmlui", ".", "theme", ".", "whitelist", "\"", ");", "String", "[", "]", "whitelist", ";", "if", "(", "StringUtils", ".", "isEmpty", "(", "whitelistProp", ")", ")", "{", "whitelist", "=", "DEFAULT_WHITELIST", ";", "}", "else", "{", "whitelist", "=", "whitelistProp", ".", "split", "(", "\",", "\")", ";", "}", "/", "/", "Check", "resource", "suffix", "against", "our", "whitelist", "for", "(", "String", "suffix", ":", "whitelist", ")", "{", "/", "/", "If", "it", "is", "in", "our", "whitelist", ",", "let", "it", "through", "to", "the", "SafeResourceReader", "if", "(", "src", "!", "=", "null", "&", "&", "src", ".", "toLowerCase", "(", ").", "endsWith", "(", "\".", "\"", "+", "suffix", ".", "trim", "(", "))", ")", "{", "super", ".", "setup", "(", "resolver", ",", "objectModel", ",", "src", ",", "par", ")", ";", "return", ";", "}", "}", "/", "/", "Finally", ",", "if", "the", "resource", "has", "a", "suffix", "that", "is", "NOT", "in", "our", "whitelist", ",", "block", "it", "throw", "new", "ResourceNotFoundException", "(", "\"", "Resource", "not", "found", "(", "\"", "+", "src", "+", "\"", ")\"", ");", "}", "}", "@", "@", "-", "188", ",", "6", "+", "188", ",", "7", "@", "@", "logger", "=", "\"", "sitemap", ".", "reader", ".", "resource", "\"", "pool", "-", "max", "=", "\"", "32", "\"", ">", "<", "expires", ">", "3600000", "<", "/", "expires", ">", "<", "!-", "-", "1000", "*", "60", "*", "60", "=", "3600000", "=", "One", "hour", "-", "->", "<", "/", "map", ":", "reader", ">", "<", "map", ":", "reader", "name", "=", "\"", "ThemeResourceReader", "\"", "src", "=", "\"", "org", ".", "dspace", ".", "app", ".", "xmlui", ".", "cocoon", ".", "ThemeResourceReader", "\"", "/>", "<", "map", ":", "reader", "name", "=", "\"", "BitstreamReader", "\"", "src", "=", "\"", "org", ".", "dspace", ".", "app", ".", "xmlui", ".", "cocoon", ".", "BitstreamReader", "\"", "/>", "<", "map", ":", "reader", "name", "=", "\"", "ExportReader", "\"", "src", "=", "\"", "org", ".", "dspace", ".", "app", ".", "xmlui", ".", "cocoon", ".", "ItemExportDownloadReader", "\"", "/>", "<", "map", ":", "reader", "name", "=", "\"", "MetadataExportReader", "\"", "src", "=", "\"", "org", ".", "dspace", ".", "app", ".", "xmlui", ".", "cocoon", ".", "MetadataExportReader", "\"", "/>", "@", "@", "-", "620", ",", "10", "+", "621", ",", "18", "@", "@", "<", "/", "map", ":", "read", ">", "<", "/", "map", ":", "match", ">", "<", "!-", "-", "Redirect", "/", "block", "for", "DS", "-", "3094", "(", "security", "issue", ")", "for", "custom", "themes", "-", "->", "<", "!-", "-", "This", "ensures", "any", "custom", "themes", "are", "not", "affected", "by", "DS", "-", "3094", "by", "redirecting", "vulnerable", "URL", "paths", "to", "/", "error", "(", "which", "returns", "a", "404", "File", "Not", "Found", ")", ".", "Custom", "themes", "may", "still", "be", "affected", "by", "this", "issue", ",", "if", "they", "have", "not", "been", "updated", "to", "use", "ThemeResourceReader", "in", "all", "<", "map", ":", "read", ">", "settings", ".", "-", "->", "<", "map", ":", "match", "pattern", "=", "\"", "themes", "/", "**", ":*", "*\"", ">", "<", "map", ":", "redirect", "-", "to", "uri", "=", "\"{", "request", ":", "contextPath", "}", "/", "error", "\"", "permanent", "=", "\"", "yes", "\"", "/>", "<", "/", "map", ":", "match", ">", "<", "!-", "-", "handle", "common", "theme", "resources", ",", "such", "as", "dri2xhtml", "-", "->", "<", "map", ":", "match", "pattern", "=", "\"", "themes", "/", "*\"", ">", "<", "map", ":", "read", "src", "=", "\"", "themes", "/", "{", "1", "}", "\"/", ">", "<", "map", ":", "read", "type", "=", "\"", "ThemeResourceReader", "\"", "src", "=", "\"", "themes", "/", "{", "1", "}", "\"/", ">", "<", "/", "map", ":", "match", ">", "<", "!-", "-", "handle", "theme", "specific", "resources", "static", "or", "dynamic", "-", "->", "@", "@", "-", "25", ",", "7", "+", "25", ",", "7", "@", "@", "<", "!-", "-", "Static", "content", "-", "->", "<", "map", ":", "match", "pattern", "=", "\"", "themes", "/", "*/", "**", "\">", "<", "map", ":", "read", "src", "=", "\"{", "2", "}", "\"/", ">", "<", "map", ":", "read", "type", "=", "\"", "ThemeResourceReader", "\"", "src", "=", "\"{", "2", "}", "\"/", ">", "<", "/", "map", ":", "match", ">", "<", "/", "map", ":", "pipeline", ">", "@", "@", "-", "34", ",", "7", "+", "34", ",", "7", "@", "@", "<", "!-", "-", "Static", "content", "-", "->", "<", "map", ":", "match", "pattern", "=", "\"", "themes", "/", "*/", "**", "\">", "<", "map", ":", "read", "src", "=", "\"{", "2", "}", "\"/", ">", "<", "map", ":", "read", "type", "=", "\"", "ThemeResourceReader", "\"", "src", "=", "\"{", "2", "}", "\"/", ">", "<", "/", "map", ":", "match", ">", "<", "/", "map", ":", "pipeline", ">", "@", "@", "-", "58", ",", "7", "+", "58", ",", "7", "@", "@", "<", "!-", "-", "Static", "content", "-", "->", "<", "map", ":", "match", "pattern", "=", "\"", "themes", "/", "*/", "**", "\">", "<", "map", ":", "read", "src", "=", "\"{", "2", "}", "\"/", ">", "<", "map", ":", "read", "type", "=", "\"", "ThemeResourceReader", "\"", "src", "=", "\"{", "2", "}", "\"/", ">", "<", "/", "map", ":", "match", ">", "<", "/", "map", ":", "pipeline", ">", "@", "@", "-", "34", ",", "7", "+", "34", ",", "7", "@", "@", "<", "!-", "-", "Static", "content", "-", "->", "<", "map", ":", "match", "pattern", "=", "\"", "themes", "/", "*/", "**", "\">", "<", "map", ":", "read", "src", "=", "\"{", "2", "}", "\"/", ">", "<", "map", ":", "read", "type", "=", "\"", "ThemeResourceReader", "\"", "src", "=", "\"{", "2", "}", "\"/", ">", "<", "/", "map", ":", "match", ">", "<", "/", "map", ":", "pipeline", ">", "@", "@", "-", "53", ",", "7", "+", "53", ",", "7", "@", "@", "<", "!-", "-", "Static", "content", "-", "->", "<", "map", ":", "match", "pattern", "=", "\"", "themes", "/", "*/", "**", "\">", "<", "map", ":", "read", "src", "=", "\"{", "2", "}", "\"/", ">", "<", "map", ":", "read", "type", "=", "\"", "ThemeResourceReader", "\"", "src", "=", "\"{", "2", "}", "\"/", ">", "<", "/", "map", ":", "match", ">", "<", "!-", "-", "Aspect", "content", "@", "@", "-", "1903", ",", "6", "+", "1903", ",", "11", "@", "@", "webui", ".", "suggest", ".", "enable", "=", "false", "#", "files", "before", "enabling", "this", "property", ".", "#", "xmlui", ".", "theme", ".", "enableMinification", "=", "false", "#", "Themes", "only", "allow", "specific", "file", "formats", "(", "extensions", ")", "to", "be", "accessible", ",", "for", "security", "reasons", ".", "#", "While", "the", "default", "list", "should", "work", "for", "most", "sites", ",", "you", "may", "wish", "to", "customize", "it", ".", "The", "default", "#", "list", "is", "commented", "out", "below", ".", "To", "customize", ",", "just", "uncomment", "and", "add", "more", "file", "extensions", ".", "#", "xmlui", ".", "theme", ".", "whitelist", "=", "css", ",", "js", ",", "json", ",", "gif", ",", "jpg", ",", "jpeg", ",", "png", ",", "bmp", ",", "ico", ",", "htm", ",", "html", ",", "svg", ",", "ttf", ",", "woff", "#", "##", "Settings", "for", "Item", "lists", "in", "Mirage", "theme", "#", "##", "#", "What", "should", "the", "emphasis", "be", "in", "the", "display", "of", "item", "lists", "?", "#", "Possible", "values", ":", "'", "file", "'", ",", "'", "metadata", "'", ".", "If", "your", "repository", "is"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["lavfi/vflip:", "Support", "Bayer", "vertical", "flip.", "Fixes", "ticket", "#8819."], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Normalize", "resource", "URL", "in", "ResourceServlet", "Issue:", "SPR-14946"], "code_tokens": ["@", "@", "-", "273", ",", "18", "+", "273", ",", "18", "@", "@", "private", "void", "doInclude", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ",", "if", "(", "this", ".", "contentType", "!", "=", "null", ")", "{", "response", ".", "setContentType", "(", "this", ".", "contentType", ")", ";", "}", "String", "[", "]", "resourceUrls", "=", "StringUtils", ".", "tokenizeToStringArray", "(", "resourceUrl", ",", "RESOURCE_URL_DELIMITERS", ")", ";", "for", "(", "String", "url", ":", "resourceUrls", ")", "{", "String", "path", "=", "StringUtils", ".", "cleanPath", "(", "url", ")", ";", "/", "/", "Check", "whether", "URL", "matches", "allowed", "resources", "if", "(", "this", ".", "allowedResources", "!", "=", "null", "&", "&", "!", "this", ".", "pathMatcher", ".", "match", "(", "this", ".", "allowedResources", ",", "url", ")", ")", "{", "throw", "new", "ServletException", "(", "\"", "Resource", "[", "\"", "+", "url", "+", "if", "(", "this", ".", "allowedResources", "!", "=", "null", "&", "&", "!", "this", ".", "pathMatcher", ".", "match", "(", "this", ".", "allowedResources", ",", "path", ")", ")", "{", "throw", "new", "ServletException", "(", "\"", "Resource", "[", "\"", "+", "path", "\"", "]", "does", "not", "match", "allowed", "pattern", "[", "\"", "+", "this", ".", "allowedResources", "+", "\"", "]\"", ");", "}", "if", "(", "logger", ".", "isDebugEnabled", "(", "))", "{", "logger", ".", "debug", "(", "\"", "Including", "resource", "[", "\"", "+", "url", "+", "\"", "]\"", ");", "logger", ".", "debug", "(", "\"", "Including", "resource", "[", "\"", "+", "path", "+", "\"", "]\"", ");", "}", "RequestDispatcher", "rd", "=", "request", ".", "getRequestDispatcher", "(", "url", ")", ";", "RequestDispatcher", "rd", "=", "request", ".", "getRequestDispatcher", "(", "path", ")", ";", "rd", ".", "include", "(", "request", ",", "response", ")", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "61", "@", "@", "/", "*", "*", "Copyright", "2002", "-", "2016", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "springframework", ".", "web", ".", "servlet", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "javax", ".", "servlet", ".", "ServletException", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "springframework", ".", "mock", ".", "web", ".", "test", ".", "MockHttpServletRequest", ";", "import", "org", ".", "springframework", ".", "mock", ".", "web", ".", "test", ".", "MockHttpServletResponse", ";", "import", "org", ".", "springframework", ".", "mock", ".", "web", ".", "test", ".", "MockServletConfig", ";", "/", "**", "*", "@", "author", "Rossen", "Stoyanchev", "*", "/", "public", "class", "ResourceServletTests", "{", "@", "Test", "(", "expected", "=", "ServletException", ".", "class", ")", "public", "void", "example1", "(", ")", "throws", "Exception", "{", "testInvalidResourceUrl", "(", "\"/", "resources", "/", "**", "\",", "\"", "/", "resources", "/", "..", "/", "WEB", "-", "INF", "/", "web", ".", "xml", "\"", ");", "}", "@", "Test", "(", "expected", "=", "ServletException", ".", "class", ")", "public", "void", "example2", "(", ")", "throws", "Exception", "{", "testInvalidResourceUrl", "(", "\"/", "resources", "/", "*\"", ",", "\"", "/", "resources", "/", "..", "\\\\", "WEB", "-", "INF", "\\", "\\", "web", ".", "xml", "\"", ");", "}", "@", "Test", "(", "expected", "=", "ServletException", ".", "class", ")", "public", "void", "example3", "(", ")", "throws", "Exception", "{", "testInvalidResourceUrl", "(", "\"/", "resources", "/", "*\"", ",", "\"", "/", "resources", "/", "..", "\\\\", "Servlet2", "?", "param", "=", "111", "\"", ");", "}", "private", "void", "testInvalidResourceUrl", "(", "String", "allowedResources", ",", "String", "resourceParam", ")", "throws", "ServletException", ",", "IOException", "{", "ResourceServlet", "servlet", "=", "new", "ResourceServlet", "(", ");", "servlet", ".", "setAllowedResources", "(", "allowedResources", ")", ";", "servlet", ".", "init", "(", "new", "MockServletConfig", "(", "))", ";", "MockHttpServletRequest", "request", "=", "new", "MockHttpServletRequest", "(", "\"", "GET", "\"", ",", "\"", "/\"", ");", "request", ".", "addParameter", "(", "\"", "resource", "\"", ",", "resourceParam", ")", ";", "MockHttpServletResponse", "response", "=", "new", "MockHttpServletResponse", "(", ");", "servlet", ".", "service", "(", "request", ",", "response", ")", ";", "}", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Get", "rid", "of", "NIY", "in", "spill", "code"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["CAMEL-6748:", "Optimize", "File", "Producers", "by", "Skipping", "Header", "Evaluation.", "Thansk", "to", "James", "Carman", "for", "the", "patch."], "code_tokens": ["@", "@", "-", "286", ",", "30", "+", "286", ",", "41", "@", "@", "public", "String", "createFileName", "(", "Exchange", "exchange", ")", "{", "String", "answer", ";", "/", "/", "overrule", "takes", "precedence", "String", "overrule", "=", "exchange", ".", "getIn", "(", ").", "getHeader", "(", "Exchange", ".", "OVERRULE_FILE_NAME", ",", "String", ".", "class", ")", ";", "String", "consumed", "=", "exchange", ".", "getIn", "(", ").", "getHeader", "(", "Exchange", ".", "FILE_NAME_CONSUMED", ",", "String", ".", "class", ")", ";", "String", "name", "=", "overrule", "=", "=", "null", "?", "exchange", ".", "getIn", "(", ").", "getHeader", "(", "Exchange", ".", "FILE_NAME", ",", "String", ".", "class", ")", ":", "overrule", ";", "Object", "value", ";", "Object", "overrule", "=", "exchange", ".", "getIn", "(", ").", "getHeader", "(", "Exchange", ".", "OVERRULE_FILE_NAME", ")", ";", "if", "(", "overrule", "!", "=", "null", ")", "{", "if", "(", "overrule", "instanceof", "Expression", ")", "{", "value", "=", "overrule", ";", "}", "else", "{", "value", "=", "exchange", ".", "getContext", "(", ").", "getTypeConverter", "(", ").", "convertTo", "(", "String", ".", "class", ",", "exchange", ",", "overrule", ")", ";", "}", "}", "else", "{", "value", "=", "exchange", ".", "getIn", "(", ").", "getHeader", "(", "Exchange", ".", "FILE_NAME", ")", ";", "}", "/", "/", "if", "we", "have", "an", "overrule", "then", "override", "the", "existing", "header", "to", "use", "the", "overrule", "computed", "name", "from", "this", "point", "forward", "if", "(", "overrule", "!", "=", "null", ")", "{", "exchange", ".", "getIn", "(", ").", "setHeader", "(", "Exchange", ".", "FILE_NAME", ",", "name", ")", ";", "exchange", ".", "getIn", "(", ").", "setHeader", "(", "Exchange", ".", "FILE_NAME", ",", "value", ")", ";", "}", "if", "(", "value", "!", "=", "null", "&", "&", "value", "instanceof", "String", "&", "&", "StringHelper", ".", "hasStartToken", "(", "(", "String", ")", "value", ",", "\"", "simple", "\"", "))", "{", "log", ".", "warn", "(", "\"", "Simple", "expression", ":", "{", "}", "detected", "in", "header", ":", "{", "}", "of", "type", "String", ".", "This", "feature", "has", "been", "removed", "(", "see", "CAMEL", "-", "6748", ")", ".\"", ",", "value", ",", "Exchange", ".", "FILE_NAME", ")", ";", "}", "/", "/", "expression", "support", "Expression", "expression", "=", "endpoint", ".", "getFileName", "(", ");", "if", "(", "name", "!", "=", "null", "&", "&", "!", "name", ".", "equals", "(", "consumed", ")", ")", "{", "/", "/", "the", "header", "name", "can", "be", "an", "expression", "too", ",", "that", "should", "override", "/", "/", "whatever", "configured", "on", "the", "endpoint", "if", "(", "StringHelper", ".", "hasStartToken", "(", "name", ",", "\"", "simple", "\"", "))", "{", "log", ".", "trace", "(", "\"{", "}", "contains", "a", "Simple", "expression", ":", "{", "}\"", ",", "Exchange", ".", "FILE_NAME", ",", "name", ")", ";", "Language", "language", "=", "getEndpoint", "(", ").", "getCamelContext", "(", ").", "resolveLanguage", "(", "\"", "file", "\"", ");", "expression", "=", "language", ".", "createExpression", "(", "name", ")", ";", "}", "if", "(", "value", "!", "=", "null", "&", "&", "value", "instanceof", "Expression", ")", "{", "expression", "=", "(", "Expression", ")", "value", ";", "}", "/", "/", "evaluate", "the", "name", "as", "a", "String", "from", "the", "value", "String", "name", ";", "if", "(", "expression", "!", "=", "null", ")", "{", "log", ".", "trace", "(", "\"", "Filename", "evaluated", "as", "expression", ":", "{", "}\"", ",", "expression", ")", ";", "name", "=", "expression", ".", "evaluate", "(", "exchange", ",", "String", ".", "class", ")", ";", "}", "else", "{", "name", "=", "exchange", ".", "getContext", "(", ").", "getTypeConverter", "(", ").", "convertTo", "(", "String", ".", "class", ",", "exchange", ",", "value", ")", ";", "}", "/", "/", "flatten", "name", "@", "@", "-", "22", ",", "6", "+", "22", ",", "8", "@", "@", "import", "org", ".", "apache", ".", "camel", ".", "component", ".", "mock", ".", "MockEndpoint", ";", "import", "org", ".", "apache", ".", "camel", ".", "impl", ".", "JndiRegistry", ";", "import", "static", "org", ".", "apache", ".", "camel", ".", "language", ".", "simple", ".", "SimpleLanguage", ".", "simple", ";", "/", "**", "*", "Unit", "test", "for", "expression", "option", "for", "file", "consumer", ".", "*", "/", "@", "@", "-", "70", ",", "7", "+", "72", ",", "7", "@", "@", "public", "void", "configure", "(", ")", "throws", "Exception", "{", "public", "void", "testConsumeFileBasedOnDatePattern", "(", ")", "throws", "Exception", "{", "template", ".", "sendBodyAndHeader", "(", "\"", "file", ":", "//", "target", "/", "filelanguage", "/", "date", "\"", ",", "\"", "Bye", "World", "\"", ",", "Exchange", ".", "FILE_NAME", ",", "\"", "myfile", "-", "20081128", ".", "txt", "\"", ");", "template", ".", "sendBodyAndHeader", "(", "\"", "file", ":", "//", "target", "/", "filelanguage", "/", "date", "\"", ",", "\"", "Hello", "World", "\"", ",", "Exchange", ".", "FILE_NAME", ",", "\"", "myfile", "-", "20081129", ".", "txt", "\"", ");", "template", ".", "sendBodyAndHeader", "(", "\"", "file", ":", "//", "target", "/", "filelanguage", "/", "date", "\"", ",", "\"", "Goodday", "World", "\"", ",", "Exchange", ".", "FILE_NAME", ",", "\"", "myfile", "-", "${", "date", ":", "now", ":", "yyyyMMdd", "}", ".", "txt", "\"", ");", "template", ".", "sendBodyAndHeader", "(", "\"", "file", ":", "//", "target", "/", "filelanguage", "/", "date", "\"", ",", "\"", "Goodday", "World", "\"", ",", "Exchange", ".", "FILE_NAME", ",", "simple", "(", "\"", "myfile", "-", "${", "date", ":", "now", ":", "yyyyMMdd", "}", ".", "txt", "\"", "))", ";", "context", ".", "addRoutes", "(", "new", "RouteBuilder", "(", ")", "{", "@", "Override", "@", "@", "-", "1", ",", "62", "+", "0", ",", "0", "@", "@", "/", "**", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "camel", ".", "component", ".", "file", ";", "import", "java", ".", "text", ".", "SimpleDateFormat", ";", "import", "java", ".", "util", ".", "Date", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "TreeMap", ";", "import", "org", ".", "apache", ".", "camel", ".", "ContextTestSupport", ";", "import", "org", ".", "apache", ".", "camel", ".", "Exchange", ";", "/", "**", "*", "@", "version", "*", "/", "public", "class", "FileProducerConsumedFileNameEvaluationTest", "extends", "ContextTestSupport", "{", "@", "Override", "protected", "void", "setUp", "(", ")", "throws", "Exception", "{", "deleteDirectory", "(", "\"", "target", "/", "producerconsumedfilename", "\"", ");", "super", ".", "setUp", "(", ");", "}", "public", "void", "testFileNameNotEvaluatedWhenMatchingConsumed", "(", ")", "throws", "Exception", "{", "Map", "<", "String", ",", "Object", ">", "headers", "=", "new", "TreeMap", "<", "String", ",", "Object", ">", "()", ";", "headers", ".", "put", "(", "Exchange", ".", "FILE_NAME", ",", "\"", "file", "-", "${", "date", ":", "now", ":", "yyyyMMdd", "}", "\")", ";", "headers", ".", "put", "(", "Exchange", ".", "FILE_NAME_CONSUMED", ",", "\"", "file", "-", "${", "date", ":", "now", ":", "yyyyMMdd", "}", "\")", ";", "template", ".", "sendBodyAndHeaders", "(", "\"", "file", ":", "//", "target", "/", "producerconsumedfilename", "\"", ",", "\"", "Hello", "World", "\"", ",", "headers", ")", ";", "assertFileExists", "(", "\"", "target", "/", "producerconsumedfilename", "/", "file", "-", "${", "date", ":", "now", ":", "yyyyMMdd", "}", "\")", ";", "}", "public", "void", "testFileNameEvaluatedWhenNotMatchingConsumed", "(", ")", "throws", "Exception", "{", "Map", "<", "String", ",", "Object", ">", "headers", "=", "new", "TreeMap", "<", "String", ",", "Object", ">", "()", ";", "headers", ".", "put", "(", "Exchange", ".", "FILE_NAME", ",", "\"", "file", "-", "${", "date", ":", "now", ":", "yyyyMMdd", "}", ".", "txt", "\"", ");", "headers", ".", "put", "(", "Exchange", ".", "FILE_NAME_CONSUMED", ",", "\"", "file", "-", "consumed", "\"", ");", "template", ".", "sendBodyAndHeaders", "(", "\"", "file", ":", "//", "target", "/", "producerconsumedfilename", "\"", ",", "\"", "Hello", "World", "\"", ",", "headers", ")", ";", "String", "date", "=", "new", "SimpleDateFormat", "(", "\"", "yyyyMMdd", "\"", ").", "format", "(", "new", "Date", "(", "))", ";", "assertFileExists", "(", "\"", "target", "/", "producerconsumedfilename", "/", "file", "-", "\"", "+", "date", "+", "\"", ".", "txt", "\"", ");", "}", "public", "void", "testFileNameEvaluatedWhenConsumedNull", "(", ")", "throws", "Exception", "{", "Map", "<", "String", ",", "Object", ">", "headers", "=", "new", "TreeMap", "<", "String", ",", "Object", ">", "()", ";", "headers", ".", "put", "(", "Exchange", ".", "FILE_NAME", ",", "\"", "file", "-", "${", "date", ":", "now", ":", "yyyyMMdd", "}", ".", "txt", "\"", ");", "template", ".", "sendBodyAndHeaders", "(", "\"", "file", ":", "//", "target", "/", "producerconsumedfilename", "\"", ",", "\"", "Hello", "World", "\"", ",", "headers", ")", ";", "String", "date", "=", "new", "SimpleDateFormat", "(", "\"", "yyyyMMdd", "\"", ").", "format", "(", "new", "Date", "(", "))", ";", "assertFileExists", "(", "\"", "target", "/", "producerconsumedfilename", "/", "file", "-", "\"", "+", "date", "+", "\"", ".", "txt", "\"", ");", "}", "}", "@", "@", "-", "24", ",", "6", "+", "24", ",", "8", "@", "@", "import", "org", ".", "apache", ".", "camel", ".", "Exchange", ";", "import", "org", ".", "apache", ".", "camel", ".", "impl", ".", "JndiRegistry", ";", "import", "static", "org", ".", "apache", ".", "camel", ".", "language", ".", "simple", ".", "SimpleLanguage", ".", "simple", ";", "/", "**", "*", "Unit", "test", "for", "expression", "option", "for", "file", "producer", ".", "*", "/", "@", "@", "-", "42", ",", "11", "+", "44", ",", "9", "@", "@", "protected", "JndiRegistry", "createRegistry", "(", ")", "throws", "Exception", "{", "return", "jndi", ";", "}", "public", "void", "testProduceBeanByHeader", "(", ")", "throws", "Exception", "{", "template", ".", "sendBodyAndHeader", "(", "\"", "file", ":", "//", "target", "/", "filelanguage", "\"", ",", "\"", "Hello", "World", "\"", ",", "Exchange", ".", "FILE_NAME", ",", "\"", "${", "bean", ":", "myguidgenerator", "}", ".", "bak", "\"", ");", "assertFileExists", "(", "\"", "target", "/", "filelanguage", "/", "123", ".", "bak", "\"", ");", "public", "void", "testProducerFileNameHeaderNotEvaluated", "(", ")", "{", "template", ".", "sendBodyAndHeader", "(", "\"", "file", ":", "//", "target", "/", "filelanguage", "\"", ",", "\"", "Hello", "World", "\"", ",", "Exchange", ".", "FILE_NAME", ",", "\"", "$", "simple", "{", "myfile", "-", "${", "date", ":", "now", ":", "yyyyMMdd", "}", "}.", "txt", "\"", ");", "assertFileExists", "(", "\"", "target", "/", "filelanguage", "/", "$", "simple", "{", "myfile", "-", "${", "date", ":", "now", ":", "yyyyMMdd", "}", "}.", "txt", "\"", ");", "}", "public", "void", "testProduceBeanByExpression", "(", ")", "throws", "Exception", "{", "@", "@", "-", "57", ",", "7", "+", "57", ",", "7", "@", "@", "public", "void", "testProduceBeanByExpression", "(", ")", "throws", "Exception", "{", "public", "void", "testProducerDateByHeader", "(", ")", "throws", "Exception", "{", "template", ".", "sendBodyAndHeader", "(", "\"", "file", ":", "//", "target", "/", "filelanguage", "\"", ",", "\"", "Hello", "World", "\"", ",", "Exchange", ".", "FILE_NAME", ",", "\"", "myfile", "-", "${", "date", ":", "now", ":", "yyyyMMdd", "}", ".", "txt", "\"", ");", "Exchange", ".", "FILE_NAME", ",", "simple", "(", "\"", "myfile", "-", "${", "date", ":", "now", ":", "yyyyMMdd", "}", ".", "txt", "\"", "))", ";", "String", "date", "=", "new", "SimpleDateFormat", "(", "\"", "yyyyMMdd", "\"", ").", "format", "(", "new", "Date", "(", "))", ";", "assertFileExists", "(", "\"", "target", "/", "filelanguage", "/", "myfile", "-", "\"", "+", "date", "+", "\"", ".", "txt", "\"", ");", "@", "@", "-", "32", ",", "6", "+", "32", ",", "8", "@", "@", "import", "org", ".", "junit", ".", "After", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "static", "org", ".", "apache", ".", "camel", ".", "language", ".", "simple", ".", "SimpleLanguage", ".", "simple", ";", "/", "**", "*", "Base", "class", "for", "unit", "testing", "using", "a", "FTPServer", "*", "/", "@", "@", "-", "125", ",", "7", "+", "127", ",", "7", "@", "@", "protected", "FtpServerFactory", "createFtpServerFactory", "(", ")", "throws", "Exception", "{", "}", "public", "void", "sendFile", "(", "String", "url", ",", "Object", "body", ",", "String", "fileName", ")", "{", "template", ".", "sendBodyAndHeader", "(", "url", ",", "body", ",", "Exchange", ".", "FILE_NAME", ",", "fileName", ")", ";", "template", ".", "sendBodyAndHeader", "(", "url", ",", "body", ",", "Exchange", ".", "FILE_NAME", ",", "simple", "(", "fileName", ")", ");", "}", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Merge", "pull", "request", "#5585", "from", "radarhere/stdout", "Catch", "OSError", "when", "checking", "if", "fp", "is", "sys.stdout"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Using", "'var'", "instead", "of", "'let'", "(#14)", "Fixing", "failed", "to", "compile", "issue", "during", "react", "build."], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["JBPM-6415", "-", "Remove", "jPDL", "migration", "plugin", "and", "its", "use", "from", "jbpm-designer", "(#658)", "(#673)"], "code_tokens": ["@", "@", "-", "143", ",", "30", "+", "143", ",", "6", "@", "@", "<", "artifactId", ">", "jbpm", "-", "bpmn2", "-", "emfextmodel", "<", "/", "artifactId", ">", "<", "/", "dependency", ">", "<", "!-", "-", "jBPM", "Migration", "-", "->", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jbpm", ".", "jbpm5", "<", "/", "groupId", ">", "<", "artifactId", ">", "jbpmmigration", "<", "/", "artifactId", ">", "<", "exclusions", ">", "<", "exclusion", ">", "<", "groupId", ">", "log4j", "<", "/", "groupId", ">", "<", "artifactId", ">", "log4j", "<", "/", "artifactId", ">", "<", "/", "exclusion", ">", "<", "exclusion", ">", "<", "groupId", ">", "xml", "-", "apis", "<", "/", "groupId", ">", "<", "artifactId", ">", "xml", "-", "apis", "<", "/", "artifactId", ">", "<", "/", "exclusion", ">", "<", "exclusion", ">", "<", "groupId", ">", "xalan", "<", "/", "groupId", ">", "<", "artifactId", ">", "xalan", "<", "/", "artifactId", ">", "<", "/", "exclusion", ">", "<", "exclusion", ">", "<", "groupId", ">", "xerces", "<", "/", "groupId", ">", "<", "artifactId", ">", "xercesImpl", "<", "/", "artifactId", ">", "<", "/", "exclusion", ">", "<", "/", "exclusions", ">", "<", "/", "dependency", ">", "<", "!-", "-", "Drools", "-", "->", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "drools", "<", "/", "groupId", ">", "@", "@", "-", "79", ",", "7", "+", "79", ",", "6", "@", "@", "import", "org", ".", "jbpm", ".", "designer", ".", "web", ".", "profile", ".", "IDiagramProfile", ";", "import", "org", ".", "jbpm", ".", "designer", ".", "web", ".", "profile", ".", "IDiagramProfileService", ";", "import", "org", ".", "jbpm", ".", "designer", ".", "web", ".", "profile", ".", "impl", ".", "JbpmProfileImpl", ";", "import", "org", ".", "jbpm", ".", "migration", ".", "JbpmMigration", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "@", "@", "-", "96", ",", "7", "+", "95", ",", "6", "@", "@", "private", "static", "final", "String", "TO_PDF", "=", "\"", "pdf", "\"", ";", "private", "static", "final", "String", "TO_PNG", "=", "\"", "png", "\"", ";", "private", "static", "final", "String", "TO_SVG", "=", "\"", "svg", "\"", ";", "private", "static", "final", "String", "JPDL_TO_BPMN2", "=", "\"", "jpdl2bpmn2", "\"", ";", "private", "static", "final", "String", "BPMN2_TO_JSON", "=", "\"", "bpmn2json", "\"", ";", "private", "static", "final", "String", "JSON_TO_BPMN2", "=", "\"", "json2bpmn2", "\"", ";", "private", "static", "final", "String", "HTML_TO_PDF", "=", "\"", "html2pdf", "\"", ";", "@", "@", "-", "281", ",", "37", "+", "279", ",", "8", "@", "@", "protected", "void", "doPost", "(", "HttpServletRequest", "req", ",", "HttpServletResponse", "resp", ")", "}", "}", "else", "if", "(", "transformto", "!", "=", "null", "&", "&", "transformto", ".", "equals", "(", "TO_SVG", ")", ")", "{", "storeInRepository", "(", "uuid", ",", "formattedSvg", ",", "transformto", ",", "processid", ",", "repository", ")", ";", "}", "else", "if", "(", "transformto", "!", "=", "null", "&", "&", "transformto", ".", "equals", "(", "JPDL_TO_BPMN2", ")", ")", "{", "try", "{", "String", "bpmn2", "=", "JbpmMigration", ".", "transform", "(", "jpdl", ")", ";", "Definitions", "def", "=", "(", "(", "JbpmProfileImpl", ")", "profile", ")", ".", "getDefinitions", "(", "bpmn2", ")", ";", "/", "/", "add", "bpmndi", "info", "to", "Definitions", "with", "help", "of", "gpd", "addBpmnDiInfo", "(", "def", ",", "gpd", ")", ";", "/", "/", "hack", "for", "now", "revisitSequenceFlows", "(", "def", ",", "bpmn2", ")", ";", "/", "/", "another", "hack", "if", "id", "=", "=", "name", "revisitNodeNames", "(", "def", ")", ";", "/", "/", "get", "the", "xml", "from", "Definitions", "ResourceSet", "rSet", "=", "new", "ResourceSetImpl", "(", ");", "rSet", ".", "getResourceFactoryRegistry", "(", ").", "getExtensionToFactoryMap", "(", ").", "put", "(", "\"", "bpmn2", "\"", ",", "new", "JBPMBpmn2ResourceFactoryImpl", "(", "))", ";", "JBPMBpmn2ResourceImpl", "bpmn2resource", "=", "(", "JBPMBpmn2ResourceImpl", ")", "rSet", ".", "createResource", "(", "URI", ".", "createURI", "(", "\"", "virtual", ".", "bpmn2", "\"", "))", ";", "rSet", ".", "getResources", "(", ").", "add", "(", "bpmn2resource", ")", ";", "bpmn2resource", ".", "getContents", "(", ").", "add", "(", "def", ")", ";", "ByteArrayOutputStream", "outputStream", "=", "new", "ByteArrayOutputStream", "(", ");", "bpmn2resource", ".", "save", "(", "outputStream", ",", "new", "HashMap", "<", "Object", ",", "Object", ">", "()", ");", "String", "fullXmlModel", "=", "outputStream", ".", "toString", "(", ");", "/", "/", "convert", "to", "json", "and", "write", "response", "String", "json", "=", "profile", ".", "createUnmarshaller", "(", ").", "parseModel", "(", "fullXmlModel", ",", "profile", ",", "pp", ")", ";", "resp", ".", "setCharacterEncoding", "(", "\"", "UTF", "-", "8", "\"", ");", "resp", ".", "setContentType", "(", "\"", "application", "/", "json", "\"", ");", "resp", ".", "getWriter", "(", ").", "print", "(", "json", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "_logger", ".", "error", "(", "e", ".", "getMessage", "(", "))", ";", "resp", ".", "setContentType", "(", "\"", "application", "/", "json", "\"", ");", "resp", ".", "getWriter", "(", ").", "print", "(", "\"{", "}\"", ");", "}", "}", "else", "if", "(", "transformto", "!", "=", "null", "&", "&", "transformto", ".", "equals", "(", "BPMN2_TO_JSON", ")", ")", "{", "}", "else", "if", "(", "transformto", "!", "=", "null", "&", "&", "transformto", ".", "equals", "(", "BPMN2_TO_JSON", ")", ")", "{", "try", "{", "if", "(", "convertServiceTasks", "!", "=", "null", "&", "&", "convertServiceTasks", ".", "equals", "(", "\"", "true", "\"", "))", "{", "bpmn2in", "=", "bpmn2in", ".", "replaceAll", "(", "\"", "drools", ":", "taskName", "=", "\\\"", ".*", "?\\", "\"\"", ",", "\"", "drools", ":", "taskName", "=", "\\\"", "ReadOnlyService", "\\", "\"\"", ");", "@", "@", "-", "348", ",", "7", "+", "348", ",", "6", "@", "@", "<", "include", ">", "${", "project", ".", "build", ".", "directory", "}", "/", "classes", "/", "org", "/", "jbpm", "/", "designer", "/", "public", "/", "js", "/", "Plugins", "/", "selectssperspective", "-", "min", ".", "js", "<", "/", "include", ">", "<", "include", ">", "${", "project", ".", "build", ".", "directory", "}", "/", "classes", "/", "org", "/", "jbpm", "/", "designer", "/", "public", "/", "js", "/", "Plugins", "/", "toolbar", "-", "min", ".", "js", "<", "/", "include", ">", "<", "include", ">", "${", "project", ".", "build", ".", "directory", "}", "/", "classes", "/", "org", "/", "jbpm", "/", "designer", "/", "public", "/", "js", "/", "Plugins", "/", "processinfo", "-", "min", ".", "js", "<", "/", "include", ">", "<", "include", ">", "${", "project", ".", "build", ".", "directory", "}", "/", "classes", "/", "org", "/", "jbpm", "/", "designer", "/", "public", "/", "js", "/", "Plugins", "/", "jpdlmigration", "-", "min", ".", "js", "<", "/", "include", ">", "<", "include", ">", "${", "project", ".", "build", ".", "directory", "}", "/", "classes", "/", "org", "/", "jbpm", "/", "designer", "/", "public", "/", "js", "/", "Plugins", "/", "servicerepo", "-", "min", ".", "js", "<", "/", "include", ">", "<", "include", ">", "${", "project", ".", "build", ".", "directory", "}", "/", "classes", "/", "org", "/", "jbpm", "/", "designer", "/", "public", "/", "js", "/", "Plugins", "/", "saveplugin", "-", "min", ".", "js", "<", "/", "include", ">", "<", "include", ">", "${", "project", ".", "build", ".", "directory", "}", "/", "classes", "/", "org", "/", "jbpm", "/", "designer", "/", "public", "/", "js", "/", "Plugins", "/", "shapemenu", "-", "min", ".", "js", "<", "/", "include", ">", "@", "@", "-", "1", ",", "230", "+", "0", ",", "0", "@", "@", "if", "(", "!", "ORYX", ".", "Plugins", ")", "ORYX", ".", "Plugins", "=", "{", "};", "if", "(", "!", "ORYX", ".", "Config", ")", "ORYX", ".", "Config", "=", "{", "};", "ORYX", ".", "Plugins", ".", "JPDLMigration", "=", "Clazz", ".", "extend", "(", "{", "construct", ":", "function", "(", "facade", ")", "{", "this", ".", "facade", "=", "facade", ";", "if", "(", "!(", "ORYX", ".", "READONLY", "=", "=", "true", "|", "|", "ORYX", ".", "VIEWLOCKED", "=", "=", "true", ")", ")", "{", "this", ".", "facade", ".", "offer", "(", "{", "'", "name", "'", ":", "ORYX", ".", "I18N", ".", "View", ".", "migratejPDL", ",", "'", "functionality", "'", ":", "this", ".", "migrateJPDL", ".", "bind", "(", "this", ")", ",", "'", "group", "'", ":", "'", "importgroup", "'", ",", "'", "icon", "'", ":", "ORYX", ".", "BASE_FILE_PATH", "+", "\"", "images", "/", "jpdl_import_icon", ".", "png", "\"", ",", "dropDownGroupIcon", ":", "ORYX", ".", "BASE_FILE_PATH", "+", "\"", "images", "/", "import", ".", "png", "\"", ",", "'", "description", "'", ":", "ORYX", ".", "I18N", ".", "View", ".", "migratejPDLDesc", ",", "'", "index", "'", ":", "3", ",", "'", "minShape", "'", ":", "0", ",", "'", "maxShape", "'", ":", "0", ",", "'", "isEnabled", "'", ":", "function", "(", "){", "return", "!", "(", "ORYX", ".", "READONLY", "=", "=", "true", "|", "|", "ORYX", ".", "VIEWLOCKED", "=", "=", "true", ")", ";", "/", "/", "profileParamName", "=", "\"", "profile", "\"", ";", "/", "/", "profileParamName", "=", "profileParamName", ".", "replace", "(", "/[", "\\[", "]/", ",\"", "\\\\", "\\[", "\")", ".", "replace", "(", "/[", "\\]", "]/", ",\"", "\\\\", "\\]", "\")", ";", "/", "/", "regexSa", "=", "\"", "[\\", "\\?", "&]", "\"+", "profileParamName", "+", "\"=", "([", "^&", "#]", "*)", "\";", "/", "/", "regexa", "=", "new", "RegExp", "(", "regexSa", ")", ";", "/", "/", "profileParams", "=", "regexa", ".", "exec", "(", "window", ".", "location", ".", "href", ")", ";", "/", "/", "profileParamValue", "=", "profileParams", "[", "1", "]", ";", "/", "/", "return", "profileParamValue", "=", "=", "\"", "jbpm", "\"", ";", "}", ".", "bind", "(", "this", ")", "}", ");", "}", "}", ",", "migrateJPDL", ":", "function", "(", ")", "{", "this", ".", "_showImportDialog", "(", ");", "}", ",", "_showImportDialog", ":", "function", "(", "successCallback", ")", "{", "var", "dialogSize", "=", "ORYX", ".", "Utils", ".", "getDialogSize", "(", "450", ",", "500", ")", ";", "var", "panelHeight", "=", "Math", ".", "max", "(", "50", ",", "(", "dialogSize", ".", "height", "-", "150", ")", "/", "2", ")", ";", "var", "panelWidth", "=", "dialogSize", ".", "width", "-", "50", ";", "var", "form", "=", "new", "Ext", ".", "form", ".", "FormPanel", "(", "{", "baseCls", ":", "'", "x", "-", "plain", "'", ",", "labelWidth", ":", "50", ",", "defaultType", ":", "'", "textfield", "'", ",", "items", ":", "[", "{", "text", ":", "ORYX", ".", "I18N", ".", "jPDLSupport", ".", "selectFile", ",", "style", ":", "'", "font", "-", "size", ":", "12px", ";", "margin", "-", "bottom", ":", "10px", ";", "display", ":", "block", ";", "',", "/", "/", "anchor", ":", "'", "100", "%", "',", "xtype", ":", "'", "label", "'", "}", ",", "{", "fieldLabel", ":", "ORYX", ".", "I18N", ".", "jPDLSupport", ".", "file", ",", "name", ":", "'", "subject", "'", ",", "inputType", ":", "'", "file", "'", ",", "style", ":", "'", "margin", "-", "bottom", ":", "10px", ";", "display", ":", "block", ";", "',", "itemCls", ":", "'", "ext_specific_window_overflow", "'", "}", ",", "{", "xtype", ":", "'", "textarea", "'", ",", "hideLabel", ":", "true", ",", "name", ":", "'", "msg", "'", ",", "grow", ":", "false", ",", "width", ":", "panelWidth", ",", "height", ":", "panelHeight", "}", "]", "}", ");", "var", "form2", "=", "new", "Ext", ".", "form", ".", "FormPanel", "(", "{", "baseCls", ":", "'", "x", "-", "plain", "'", ",", "labelWidth", ":", "50", ",", "defaultType", ":", "'", "textfield", "'", ",", "items", ":", "[", "{", "text", ":", "ORYX", ".", "I18N", ".", "jPDLSupport", ".", "selectGpdFile", ",", "style", ":", "'", "font", "-", "size", ":", "12px", ";", "margin", "-", "bottom", ":", "10px", ";", "display", ":", "block", ";", "',", "/", "/", "anchor", ":", "'", "100", "%", "',", "xtype", ":", "'", "label", "'", "}", ",", "{", "fieldLabel", ":", "ORYX", ".", "I18N", ".", "jPDLSupport", ".", "gpdfile", ",", "name", ":", "'", "subject", "'", ",", "inputType", ":", "'", "file", "'", ",", "style", ":", "'", "margin", "-", "bottom", ":", "10px", ";", "display", ":", "block", ";", "',", "itemCls", ":", "'", "ext_specific_window_overflow", "'", "}", ",", "{", "xtype", ":", "'", "textarea", "'", ",", "hideLabel", ":", "true", ",", "name", ":", "'", "msg", "'", ",", "grow", ":", "false", ",", "width", ":", "panelWidth", ",", "height", ":", "panelHeight", "}", "]", "}", ");", "/", "/", "Create", "the", "panel", "var", "dialog", "=", "new", "Ext", ".", "Window", "(", "{", "autoCreate", ":", "true", ",", "autoScroll", ":", "true", ",", "/", "/", "layout", ":", "'", "fit", "'", ",", "plain", ":", "true", ",", "bodyStyle", ":", "'", "padding", ":", "5px", ";", "',", "title", ":", "ORYX", ".", "I18N", ".", "jPDLSupport", ".", "impJPDL", ",", "height", ":", "dialogSize", ".", "height", ",", "width", ":", "dialogSize", ".", "width", ",", "modal", ":", "true", ",", "fixedcenter", ":", "true", ",", "shadow", ":", "true", ",", "proxyDrag", ":", "true", ",", "resizable", ":", "true", ",", "items", ":", "[", "form", ",", "form2", "]", ",", "buttons", ":", "[", "{", "text", ":", "ORYX", ".", "I18N", ".", "jPDLSupport", ".", "impBtn", ",", "handler", ":", "function", "(", "){", "this", ".", "facade", ".", "raiseEvent", "(", "{", "type", ":", "ORYX", ".", "CONFIG", ".", "EVENT_NOTIFICATION_SHOW", ",", "ntype", ":", "'", "info", "'", ",", "msg", ":", "ORYX", ".", "I18N", ".", "jPDLSupport", ".", "impProgress", ",", "title", ":", "'", "'", "}", ");", "window", ".", "setTimeout", "(", "function", "(", "){", "var", "jpdlString", "=", "form", ".", "items", ".", "items", "[", "2", "]", ".", "getValue", "(", ");", "var", "gpdString", "=", "form2", ".", "items", ".", "items", "[", "2", "]", ".", "getValue", "(", ");", "this", ".", "_sendRequest", "(", "ORYX", ".", "CONFIG", ".", "TRANSFORMER_URL", "(", "),", "'", "POST", "'", ",", "{", "'", "jpdl", "'", ":", "jpdlString", ",", "'", "gpd", "'", ":", "gpdString", ",", "'", "transformto", "'", ":", "'", "jpdl2bpmn2", "'", ",", "'", "profile", "'", ":", "ORYX", ".", "PROFILE", ",", "'", "uuid", "'", ":", "window", ".", "btoa", "(", "encodeURI", "(", "ORYX", ".", "UUID", ")", ")", "}", ",", "function", "(", "arg", ")", "{", "this", ".", "_loadJSON", "(", "arg", ")", ";", "dialog", ".", "hide", "(", ");", "}", ".", "bind", "(", "this", ")", ",", "function", "(", ")", "{", "dialog", ".", "hide", "(", ");", "}", ".", "bind", "(", "this", ")", ")", ";", "}", ".", "bind", "(", "this", ")", ",", "100", ")", ";", "}", ".", "bind", "(", "this", ")", "}", ",{", "text", ":", "ORYX", ".", "I18N", ".", "jPDLSupport", ".", "close", ",", "handler", ":", "function", "(", "){", "dialog", ".", "hide", "(", ");", "}", ".", "bind", "(", "this", ")", "}", "]", "}", ");", "/", "/", "Destroy", "the", "panel", "when", "hiding", "dialog", ".", "on", "(", "'", "hide", "'", ",", "function", "(", "){", "dialog", ".", "destroy", "(", "true", ")", ";", "delete", "dialog", ";", "}", ");", "/", "/", "Show", "the", "panel", "dialog", ".", "show", "(", ");", "/", "/", "Adds", "the", "change", "event", "handler", "to", "form", ".", "items", ".", "items", "[", "1", "]", ".", "getEl", "(", ").", "dom", ".", "addEventListener", "(", "'", "change", "'", ",", "function", "(", "evt", ")", "{", "var", "reader", "=", "new", "FileReader", "(", ");", "reader", ".", "onload", "=", "function", "(", "e", ")", "{", "form", ".", "items", ".", "items", "[", "2", "]", ".", "setValue", "(", "e", ".", "target", ".", "result", ")", ";", "}", "reader", ".", "readAsText", "(", "evt", ".", "target", ".", "files", "[", "0", "]", ",", "'", "UTF", "-", "8", "'", ");", "}", ",", "true", ")", ";", "form2", ".", "items", ".", "items", "[", "1", "]", ".", "getEl", "(", ").", "dom", ".", "addEventListener", "(", "'", "change", "'", ",", "function", "(", "evt", ")", "{", "var", "reader", "=", "new", "FileReader", "(", ");", "reader", ".", "onload", "=", "function", "(", "e", ")", "{", "form2", ".", "items", ".", "items", "[", "2", "]", ".", "setValue", "(", "e", ".", "target", ".", "result", ")", ";", "}", "reader", ".", "readAsText", "(", "evt", ".", "target", ".", "files", "[", "0", "]", ",", "'", "UTF", "-", "8", "'", ");", "}", ",", "true", ")", ";", "}", ",", "_loadJSON", ":", "function", "(", "jsonString", ")", "{", "if", "(", "jsonString", ")", "{", "var", "jsonObj", "=", "jsonString", ".", "evalJSON", "(", ");", "this", ".", "facade", ".", "importJSON", "(", "jsonString", ")", ";", "}", "else", "{", "this", ".", "_showErrorMessageBox", "(", "ORYX", ".", "I18N", ".", "Oryx", ".", "title", ",", "ORYX", ".", "I18N", ".", "jPDLSupport", ".", "impFailedJson", ")", ";", "}", "}", ",", "_sendRequest", ":", "function", "(", "url", ",", "method", ",", "params", ",", "successcallback", ",", "failedcallback", ")", "{", "var", "suc", "=", "false", ";", "new", "Ajax", ".", "Request", "(", "url", ",", "{", "method", ":", "method", ",", "asynchronous", ":", "false", ",", "parameters", ":", "params", ",", "onSuccess", ":", "function", "(", "transport", ")", "{", "suc", "=", "true", ";", "if", "(", "successcallback", ")", "{", "successcallback", "(", "transport", ".", "responseText", ")", "}", "}", ".", "bind", "(", "this", ")", ",", "onFailure", ":", "function", "(", "transport", ")", "{", "if", "(", "failedcallback", ")", "{", "failedcallback", "(", ");", "}", "else", "{", "this", ".", "_showErrorMessageBox", "(", "ORYX", ".", "I18N", ".", "Oryx", ".", "title", ",", "ORYX", ".", "I18N", ".", "jPDLSupport", ".", "impFailedReq", ")", ";", "ORYX", ".", "log", ".", "warn", "(", "\"", "jPDL", "migration", "failed", ":", "\"", "+", "transport", ".", "responseText", ")", ";", "}", "}", ".", "bind", "(", "this", ")", "}", ");", "return", "suc", ";", "}", "}", ");", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "34", ",", "8", "+", "34", ",", "7", "@", "@", "<", "requires", "namespace", "=", "\"", "http", ":", "//", "b3mn", ".", "org", "/", "stencilset", "/", "bpmn1", ".", "1", "#", "\"", "/", ">", "<", "!-", "-", "plugin", "loads", "dynamically", "the", "needed", "extension", "<", "requires", "namespace", "=", "\"", "http", ":", "//", "oryx", "-", "editor", ".", "org", "/", "stencilsets", "/", "extensions", "/", "jbpm", "#", "\"/", ">", "-", "->", "<", "/", "plugin", ">", "<", "plugin", "source", "=", "\"", "jpdlmigration", ".", "js", "\"", "name", "=", "\"", "ORYX", ".", "Plugins", ".", "JPDLMigration", "\"", "/>", "<", "plugin", "source", "=", "\"", "servicerepo", ".", "js", "\"", "name", "=", "\"", "ORYX", ".", "Plugins", ".", "ServiceRepoIntegration", "\"", "/>", "<", "!-", "-", "User", "Interface", "Aggregation", "-", "->", "@", "@", "-", "4", ",", "7", "+", "4", ",", "6", "@", "@", "<", "profile", "name", "=", "\"", "jbpm", "\"", "stencilset", "=", "\"", "bpmn2", ".", "0jbpm", "\"", ">", "<", "plugin", "name", "=", "\"", "ORYX", ".", "Plugins", ".", "SelectStencilSetPerspective", "\"", "/>", "<", "plugin", "name", "=", "\"", "ORYX", ".", "Plugins", ".", "Toolbar", "\"", "/>", "<", "plugin", "name", "=", "\"", "ORYX", ".", "Plugins", ".", "JPDLMigration", "\"", "/>", "<", "plugin", "name", "=", "\"", "ORYX", ".", "Plugins", ".", "ServiceRepoIntegration", "\"", "/>", "<", "plugin", "name", "=", "\"", "ORYX", ".", "Plugins", ".", "SavePlugin", "\"", "/>", "<", "plugin", "name", "=", "\"", "ORYX", ".", "Plugins", ".", "ShapeMenuPlugin", "\"", "/>"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["bcache:", "partition", "support:", "add", "16", "minors", "per", "bcacheN", "device", "Signed-off-by:", "Eric", "Wheeler", "<bcache@linux.ewheeler.net>", "Tested-by:", "Wido", "den", "Hollander", "<wido@widodh.nl>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Enable", "HTTP", "header", "validation"], "code_tokens": ["@", "@", "-", "156", ",", "7", "+", "156", ",", "7", "@", "@", "private", "void", "newRequest", "(", "ChannelHandlerContext", "ctx", ",", "HttpRequest", "nettyRequest", ")", "thr", "channel", ".", "attr", "(", "CLIENT_CERT_KEY", ")", ".", "get", "(", ")", ")", ";", "HttpHeaders", "nettyHeaders", "=", "new", "DefaultHttpHeaders", "(", "false", ")", ";", "HttpHeaders", "nettyHeaders", "=", "new", "DefaultHttpHeaders", "(", ");", "MutableHeaders", "responseHeaders", "=", "new", "NettyHeadersBackedMutableHeaders", "(", "nettyHeaders", ")", ";", "AtomicBoolean", "transmitted", "=", "new", "AtomicBoolean", "(", "false", ")", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["fs:", "check", "closing_", "in", "FileHandle::Close", "Fix", "possible", "flaky", "failure.", "Keep", "uv_fs_close", "from", "being", "called", "twice", "on", "the", "same", "fd.", "Signed-off-by:", "James", "M", "Snell", "<jasnell@gmail.com>", "PR-URL:", "https://github.com/nodejs/node/pull/39472", "Refs:", "https://github.com/nodejs/node/issues/39464", "Reviewed-By:", "Matteo", "Collina", "<matteo.collina@gmail.com>", "Reviewed-By:", "Tobias", "Nie\u00dfen", "<tniessen@tnie.de>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["KEYS:", "Fix", "termination", "condition", "in", "assoc", "array", "garbage", "collection", "This", "fixes", "CVE-2014-3631.", "It", "is", "possible", "for", "an", "associative", "array", "to", "end", "up", "with", "a", "shortcut", "node", "at", "the", "root", "of", "the", "tree", "if", "there", "are", "more", "than", "fan-out", "leaves", "in", "the", "tree,", "but", "they", "all", "crowd", "into", "the", "same", "slot", "in", "the", "lowest", "level", "(ie.", "they", "all", "have", "the", "same", "first", "nibble", "of", "their", "index", "keys).", "When", "assoc_array_gc()", "returns", "back", "up", "the", "tree", "after", "scanning", "some", "leaves,", "it", "can", "fall", "off", "of", "the", "root", "and", "crash", "because", "it", "assumes", "that", "the", "back", "pointer", "from", "a", "shortcut", "(after", "label", "ascend_old_tree)", "must", "point", "to", "a", "normal", "node", "-", "which", "isn't", "true", "of", "a", "shortcut", "node", "at", "the", "root.", "Should", "we", "find", "we're", "ascending", "rootwards", "over", "a", "shortcut,", "we", "should", "check", "to", "see", "if", "the", "backpointer", "is", "zero", "-", "and", "if", "it", "is,", "we", "have", "completed", "the", "scan.", "This", "particular", "bug", "cannot", "occur", "if", "the", "root", "node", "is", "not", "a", "shortcut", "-", "ie.", "if", "you", "have", "fewer", "than", "17", "keys", "in", "a", "keyring", "or", "if", "you", "have", "at", "least", "two", "keys", "that", "sit", "into", "separate", "slots", "(eg.", "a", "keyring", "and", "a", "non", "keyring).", "This", "can", "be", "reproduced", "by:", "ring=`keyctl", "newring", "bar", "@s`", "for", "((i=1;", "i<=18;", "i++));", "do", "last_key=`keyctl", "newring", "foo$i", "$ring`;", "done", "keyctl", "timeout", "$last_key", "2", "Doing", "this:", "echo", "3", ">/proc/sys/kernel/keys/gc_delay", "first", "will", "speed", "things", "up.", "If", "we", "do", "fall", "off", "of", "the", "top", "of", "the", "tree,", "we", "get", "the", "following", "oops:", "BUG:", "unable", "to", "handle", "kernel", "NULL", "pointer", "dereference", "at", "0000000000000018", "IP:", "[<ffffffff8136cea7>]", "assoc_array_gc+0x2f7/0x540", "PGD", "dae15067", "PUD", "cfc24067", "PMD", "0", "Oops:", "0000", "[#1]", "SMP", "Modules", "linked", "in:", "xt_nat", "xt_mark", "nf_conntrack_netbios_ns", "nf_conntrack_broadcast", "ip6t_rpfilter", "ip6t_REJECT", "xt_conntrack", "ebtable_nat", "ebtable_broute", "bridge", "stp", "llc", "ebtable_filter", "ebtables", "ip6table_ni", "CPU:", "0", "PID:", "26011", "Comm:", "kworker/0:1", "Not", "tainted", "3.14.9-200.fc20.x86_64", "#1", "Hardware", "name:", "Bochs", "Bochs,", "BIOS", "Bochs", "01/01/2011", "Workqueue:", "events", "key_garbage_collector", "task:", "ffff8800918bd580", "ti:", "ffff8800aac14000", "task.ti:", "ffff8800aac14000", "RIP:", "0010:[<ffffffff8136cea7>]", "[<ffffffff8136cea7>]", "assoc_array_gc+0x2f7/0x540", "RSP:", "0018:ffff8800aac15d40", "EFLAGS:", "00010206", "RAX:", "0000000000000000", "RBX:", "0000000000000000", "RCX:", "ffff8800aaecacc0", "RDX:", "ffff8800daecf440", "RSI:", "0000000000000001", "RDI:", "ffff8800aadc2bc0", "RBP:", "ffff8800aac15da8", "R08:", "0000000000000001", "R09:", "0000000000000003", "R10:", "ffffffff8136ccc7", "R11:", "0000000000000000", "R12:", "0000000000000000", "R13:", "0000000000000000", "R14:", "0000000000000070", "R15:", "0000000000000001", "FS:", "0000000000000000(0000)", "GS:ffff88011fc00000(0000)", "knlGS:0000000000000000", "CS:", "0010", "DS:", "0000", "ES:", "0000", "CR0:", "000000008005003b", "CR2:", "0000000000000018", "CR3:", "00000000db10d000", "CR4:", "00000000000006f0", "Stack:", "ffff8800aac15d50", "0000000000000011", "ffff8800aac15db8", "ffffffff812e2a70", "ffff880091a00600", "0000000000000000", "ffff8800aadc2bc3", "00000000cd42c987", "ffff88003702df20", "ffff88003702dfa0", "0000000053b65c09", "ffff8800aac15fd8", "Call", "Trace:", "[<ffffffff812e2a70>]", "?", "keyring_detect_cycle_iterator+0x30/0x30", "[<ffffffff812e3e75>]", "keyring_gc+0x75/0x80", "[<ffffffff812e1424>]", "key_garbage_collector+0x154/0x3c0", "[<ffffffff810a67b6>]", "process_one_work+0x176/0x430", "[<ffffffff810a744b>]", "worker_thread+0x11b/0x3a0", "[<ffffffff810a7330>]", "?", "rescuer_thread+0x3b0/0x3b0", "[<ffffffff810ae1a8>]", "kthread+0xd8/0xf0", "[<ffffffff810ae0d0>]", "?", "insert_kthread_work+0x40/0x40", "[<ffffffff816ffb7c>]", "ret_from_fork+0x7c/0xb0", "[<ffffffff810ae0d0>]", "?", "insert_kthread_work+0x40/0x40", "Code:", "08", "4c", "8b", "22", "0f", "84", "bf", "00", "00", "00", "41", "83", "c7", "01", "49", "83", "e4", "fc", "41", "83", "ff", "0f", "4c", "89", "65", "c0", "0f", "8f", "5a", "fe", "ff", "ff", "48", "8b", "45", "c0", "4d", "63", "cf", "49", "83", "c1", "02", "<4e>", "8b", "34", "c8", "4d", "85", "f6", "0f", "84", "be", "00", "00", "00", "41", "f6", "c6", "01", "0f", "84", "92", "RIP", "[<ffffffff8136cea7>]", "assoc_array_gc+0x2f7/0x540", "RSP", "<ffff8800aac15d40>", "CR2:", "0000000000000018", "---[", "end", "trace", "1129028a088c0cbd", "]---", "Signed-off-by:", "David", "Howells", "<dhowells@redhat.com>", "Acked-by:", "Don", "Zickus", "<dzickus@redhat.com>", "Signed-off-by:", "James", "Morris", "<james.l.morris@oracle.com>"], "code_tokens": ["@", "@", "-", "1723", ",", "11", "+", "1723", ",", "13", "@", "@", "int", "assoc_array_gc", "(", "struct", "assoc_array", "*", "array", ",", "shortcut", "=", "assoc_array_ptr_to_shortcut", "(", "ptr", ")", ";", "slot", "=", "shortcut", "-", ">", "parent_slot", ";", "cursor", "=", "shortcut", "-", ">", "back_pointer", ";", "if", "(", "!", "cursor", ")", "goto", "gc_complete", ";", "}", "else", "{", "slot", "=", "node", "-", ">", "parent_slot", ";", "cursor", "=", "ptr", ";", "}", "BUG_ON", "(", "!", "ptr", ")", ";", "BUG_ON", "(", "!", "cursor", ")", ";", "node", "=", "assoc_array_ptr_to_node", "(", "cursor", ")", ";", "slot", "+", "+;", "goto", "continue_node", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Fixed", "some", "SSL", "code"], "code_tokens": ["@", "@", "-", "857", ",", "7", "+", "857", ",", "7", "@", "@", "public", "String", "toString", "(", ")", "{", "*", "message", ",", "but", "not", "for", "handshake", "messages", ",", "which", "will", "be", "swallowed", ".", "*", "*", "/", "private", "static", "class", "EncryptedWriteRequest", "extends", "DefaultWriteRequest", "{", "/", "*", "package", "protected", "*", "/", "static", "class", "EncryptedWriteRequest", "extends", "DefaultWriteRequest", "{", "/", "/", "Thee", "encrypted", "messagee", "private", "final", "IoBuffer", "encryptedMessage", ";", "@", "@", "-", "33", ",", "6", "+", "33", ",", "7", "@", "@", "import", "javax", ".", "net", ".", "ssl", ".", "SSLException", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLHandshakeException", ";", "import", "org", ".", "apache", ".", "mina", ".", "core", ".", "RuntimeIoException", ";", "import", "org", ".", "apache", ".", "mina", ".", "core", ".", "buffer", ".", "IoBuffer", ";", "import", "org", ".", "apache", ".", "mina", ".", "core", ".", "filterchain", ".", "IoFilter", ".", "NextFilter", ";", "import", "org", ".", "apache", ".", "mina", ".", "core", ".", "filterchain", ".", "IoFilterEvent", ";", "@", "@", "-", "42", ",", "6", "+", "43", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "mina", ".", "core", ".", "session", ".", "IoSession", ";", "import", "org", ".", "apache", ".", "mina", ".", "core", ".", "write", ".", "DefaultWriteRequest", ";", "import", "org", ".", "apache", ".", "mina", ".", "core", ".", "write", ".", "WriteRequest", ";", "import", "org", ".", "apache", ".", "mina", ".", "filter", ".", "ssl", ".", "SslFilter", ".", "EncryptedWriteRequest", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "@", "@", "-", "528", ",", "9", "+", "530", ",", "34", "@", "@", "private", "void", "checkStatus", "(", "SSLEngineResult", "res", ")", "throws", "SSLException", "{", "*", "UNDERFLOW", "-", "Need", "to", "read", "more", "data", "from", "the", "socket", ".", "It", "'", "s", "normal", ".", "*", "CLOSED", "-", "The", "other", "peer", "closed", "the", "socket", ".", "Also", "normal", ".", "*", "/", "if", "(", "status", "=", "=", "SSLEngineResult", ".", "Status", ".", "BUFFER_OVERFLOW", ")", "{", "throw", "new", "SSLException", "(", "\"", "SSLEngine", "error", "during", "decrypt", ":", "\"", "+", "status", "+", "\"", "inNetBuffer", ":", "\"", "+", "inNetBuffer", "switch", "(", "status", ")", "{", "case", "BUFFER_OVERFLOW", ":", "throw", "new", "SSLException", "(", "\"", "SSLEngine", "error", "during", "decrypt", ":", "\"", "+", "status", "+", "\"", "inNetBuffer", ":", "\"", "+", "inNetBuffer", "+", "\"", "appBuffer", ":", "\"", "+", "appBuffer", ")", ";", "case", "CLOSED", ":", "Exception", "exception", "=", "new", "RuntimeIoException", "(", "\"", "SSL", "/", "TLS", "close_notify", "received", "\"", ");", "/", "/", "Empty", "the", "Ssl", "queue", "for", "(", "IoFilterEvent", "event", ":", "filterWriteEventQueue", ")", "{", "EncryptedWriteRequest", "writeRequest", "=", "(", "EncryptedWriteRequest", ")", "event", ".", "getParameter", "(", ");", "WriteFuture", "writeFuture", "=", "writeRequest", ".", "getParentRequest", "(", ").", "getFuture", "(", ");", "writeFuture", ".", "setException", "(", "exception", ")", ";", "writeFuture", ".", "notifyAll", "(", ");", "}", "/", "/", "Empty", "the", "session", "queue", "while", "(", "!", "session", ".", "getWriteRequestQueue", "(", ").", "isEmpty", "(", "session", ")", ")", "{", "WriteRequest", "writeRequest", "=", "session", ".", "getWriteRequestQueue", "(", ").", "poll", "(", "session", ")", ";", "WriteFuture", "writeFuture", "=", "writeRequest", ".", "getFuture", "(", ");", "writeFuture", ".", "setException", "(", "exception", ")", ";", "writeFuture", ".", "notifyAll", "(", ");", "}", "/", "/", "We", "*", "must", "*", "shutdown", "session", "session", ".", "closeNow", "(", ");", "break", ";", "default", ":", "break", ";", "}", "}", "@", "@", "-", "595", ",", "8", "+", "622", ",", "7", "@", "@", "private", "void", "checkStatus", "(", "SSLEngineResult", "res", ")", "throws", "SSLException", "{", "}", "/", "/", "First", "make", "sure", "that", "the", "out", "buffer", "is", "completely", "empty", ".", "/", "/", "Since", "we", "/", "/", "cannot", "call", "wrap", "with", "data", "left", "on", "the", "buffer", "/", "/", "Since", "we", "cannot", "call", "wrap", "with", "data", "left", "on", "the", "buffer", "if", "(", "outNetBuffer", "!", "=", "null", "&", "&", "outNetBuffer", ".", "hasRemaining", "(", "))", "{", "return", ";", "}", "@", "@", "-", "152", ",", "7", "+", "152", ",", "6", "@", "@", "private", "static", "void", "connectAndSend", "(", ")", "throws", "Exception", "{", "String", "line", "=", "in", ".", "readLine", "(", ");", "/", "/", "System", ".", "out", ".", "println", "(", "\"", "Client", "got", ":", "\"", "+", "line", ")", ";", "socket", ".", "close", "(", ");", "}", "private", "static", "SSLContext", "createSSLContext", "(", ")", "throws", "IOException", ",", "GeneralSecurityException", "{"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Merge", "pull", "request", "#29", "from", "PierreBtz/pbeitz/JENKINS-64865", "[JENKINS-64865]", "Fix", "the", "documentation", "to", "mention", "unshelving", "needs", "adm\u2026"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["fix", "multiple", "memory", "leak", "in", "ReadYUVImage"], "code_tokens": ["@", "@", "-", "211", ",", "7", "+", "211", ",", "10", "@", "@", "static", "Image", "*", "ReadYUVImage", "(", "const", "ImageInfo", "*", "image_info", ",", "ExceptionInfo", "*", "exception", ")", "horizontal_factor", ",", "(", "image", "-", ">", "rows", "+", "vertical_factor", "-", "1", ")", "/", "vertical_factor", ",", "MagickTrue", ",", "exception", ")", ";", "if", "(", "chroma_image", "=", "=", "(", "Image", "*", ")", "NULL", ")", "ThrowReaderException", "(", "ResourceLimitError", ",", "\"", "MemoryAllocationFailed", "\"", ");", "{", "scanline", "=", "(", "unsigned", "char", "*", ")", "RelinquishMagickMemory", "(", "scanline", ")", ";", "ThrowReaderException", "(", "ResourceLimitError", ",", "\"", "MemoryAllocationFailed", "\"", ");", "}", "/", "*", "Convert", "raster", "image", "to", "pixel", "packets", ".", "*", "/", "@", "@", "-", "227", ",", "6", "+", "230", ",", "7", "@", "@", "static", "Image", "*", "ReadYUVImage", "(", "const", "ImageInfo", "*", "image_info", ",", "ExceptionInfo", "*", "exception", ")", "status", "=", "OpenBlob", "(", "image_info", ",", "image", ",", "ReadBinaryBlobMode", ",", "exception", ")", ";", "if", "(", "status", "=", "=", "MagickFalse", ")", "{", "scanline", "=", "(", "unsigned", "char", "*", ")", "RelinquishMagickMemory", "(", "scanline", ")", ";", "image", "=", "DestroyImageList", "(", "image", ")", ";", "return", "(", "(", "Image", "*", ")", "NULL", ")", ";", "}", "@", "@", "-", "353", ",", "6", "+", "357", ",", "7", "@", "@", "static", "Image", "*", "ReadYUVImage", "(", "const", "ImageInfo", "*", "image_info", ",", "ExceptionInfo", "*", "exception", ")", "status", "=", "OpenBlob", "(", "image_info", ",", "image", ",", "ReadBinaryBlobMode", ",", "exception", ")", ";", "if", "(", "status", "=", "=", "MagickFalse", ")", "{", "scanline", "=", "(", "unsigned", "char", "*", ")", "RelinquishMagickMemory", "(", "scanline", ")", ";", "image", "=", "DestroyImageList", "(", "image", ")", ";", "return", "(", "(", "Image", "*", ")", "NULL", ")", ";", "}", "@", "@", "-", "399", ",", "6", "+", "404", ",", "7", "@", "@", "static", "Image", "*", "ReadYUVImage", "(", "const", "ImageInfo", "*", "image_info", ",", "ExceptionInfo", "*", "exception", ")", "status", "=", "OpenBlob", "(", "image_info", ",", "image", ",", "ReadBinaryBlobMode", ",", "exception", ")", ";", "if", "(", "status", "=", "=", "MagickFalse", ")", "{", "scanline", "=", "(", "unsigned", "char", "*", ")", "RelinquishMagickMemory", "(", "scanline", ")", ";", "image", "=", "DestroyImageList", "(", "image", ")", ";", "return", "(", "(", "Image", "*", ")", "NULL", ")", ";", "}", "@", "@", "-", "442", ",", "7", "+", "448", ",", "10", "@", "@", "static", "Image", "*", "ReadYUVImage", "(", "const", "ImageInfo", "*", "image_info", ",", "ExceptionInfo", "*", "exception", ")", "TriangleFilter", ",", "exception", ")", ";", "chroma_image", "=", "DestroyImage", "(", "chroma_image", ")", ";", "if", "(", "resize_image", "=", "=", "(", "Image", "*", ")", "NULL", ")", "ThrowReaderException", "(", "ResourceLimitError", ",", "\"", "MemoryAllocationFailed", "\"", ");", "{", "scanline", "=", "(", "unsigned", "char", "*", ")", "RelinquishMagickMemory", "(", "scanline", ")", ";", "ThrowReaderException", "(", "ResourceLimitError", ",", "\"", "MemoryAllocationFailed", "\"", ");", "}", "for", "(", "y", "=", "0", ";", "y", "<", "(", "ssize_t", ")", "image", "-", ">", "rows", ";", "y", "+", "+)", "{", "q", "=", "GetAuthenticPixels", "(", "image", ",", "0", ",", "y", ",", "image", "-", ">", "columns", ",", "1", ",", "exception", ")", ";", "@", "@", "-", "491", ",", "6", "+", "500", ",", "7", "@", "@", "static", "Image", "*", "ReadYUVImage", "(", "const", "ImageInfo", "*", "image_info", ",", "ExceptionInfo", "*", "exception", ")", "AcquireNextImage", "(", "image_info", ",", "image", ",", "exception", ")", ";", "if", "(", "GetNextImageInList", "(", "image", ")", "=", "=", "(", "Image", "*", ")", "NULL", ")", "{", "scanline", "=", "(", "unsigned", "char", "*", ")", "RelinquishMagickMemory", "(", "scanline", ")", ";", "image", "=", "DestroyImageList", "(", "image", ")", ";", "return", "(", "(", "Image", "*", ")", "NULL", ")", ";", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["efi/x86/Add", "missing", "error", "handling", "to", "old_memmap", "1:1", "mapping", "code", "The", "old_memmap", "flow", "in", "efi_call_phys_prolog()", "performs", "numerous", "memory", "allocations,", "and", "either", "does", "not", "check", "for", "failure", "at", "all,", "or", "it", "does", "but", "fails", "to", "propagate", "it", "back", "to", "the", "caller,", "which", "may", "end", "up", "calling", "into", "the", "firmware", "with", "an", "incomplete", "1:1", "mapping.", "So", "let's", "fix", "this", "by", "returning", "NULL", "from", "efi_call_phys_prolog()", "on", "memory", "allocation", "failures", "only,", "and", "by", "handling", "this", "condition", "in", "the", "caller.", "Also,", "clean", "up", "any", "half", "baked", "sets", "of", "page", "tables", "that", "we", "may", "have", "created", "before", "returning", "with", "a", "NULL", "return", "value.", "Note", "that", "any", "failure", "at", "this", "level", "will", "trigger", "a", "panic()", "two", "levels", "up,", "so", "none", "of", "this", "makes", "a", "huge", "difference,", "but", "it", "is", "a", "nice", "cleanup", "nonetheless.", "[ardb:", "update", "commit", "log,", "add", "efi_call_phys_epilog()", "call", "on", "error", "path]", "Signed-off-by:", "Gen", "Zhang", "<blackgod016574@gmail.com>", "Signed-off-by:", "Ard", "Biesheuvel", "<ard.biesheuvel@linaro.org>", "Cc:", "Linus", "Torvalds", "<torvalds@linux-foundation.org>", "Cc:", "Peter", "Zijlstra", "<peterz@infradead.org>", "Cc:", "Rob", "Bradford", "<robert.bradford@intel.com>", "Cc:", "Thomas", "Gleixner", "<tglx@linutronix.de>", "Cc:", "linux-efi@vger.kernel.org", "Link:", "http://lkml.kernel.org/r/20190525112559.7917-2-ard.biesheuvel@linaro.org", "Signed-off-by:", "Ingo", "Molnar", "<mingo@kernel.org>"], "code_tokens": ["@", "@", "-", "85", ",", "6", "+", "85", ",", "8", "@", "@", "static", "efi_status_t", "__init", "phys_efi_set_virtual_address_map", "(", "pgd_t", "*", "save_pgd", ";", "save_pgd", "=", "efi_call_phys_prolog", "(", ");", "if", "(", "!", "save_pgd", ")", "return", "EFI_ABORTED", ";", "/", "*", "Disable", "interrupts", "around", "EFI", "calls", ":", "*", "/", "local_irq_save", "(", "flags", ")", ";", "@", "@", "-", "84", ",", "13", "+", "84", ",", "15", "@", "@", "pgd_t", "*", "__init", "efi_call_phys_prolog", "(", "void", ")", "if", "(", "!", "efi_enabled", "(", "EFI_OLD_MEMMAP", ")", ")", "{", "efi_switch_mm", "(", "&", "efi_mm", ")", ";", "return", "NULL", ";", "return", "efi_mm", ".", "pgd", ";", "}", "early_code_mapping_set_exec", "(", "1", ")", ";", "n_pgds", "=", "DIV_ROUND_UP", "(", "(", "max_pfn", "<", "<", "PAGE_SHIFT", ")", ",", "PGDIR_SIZE", ")", ";", "save_pgd", "=", "kmalloc_array", "(", "n_pgds", ",", "sizeof", "(", "*", "save_pgd", ")", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "save_pgd", ")", "return", "NULL", ";", "/", "*", "*", "Build", "1", ":", "1", "identity", "mapping", "for", "efi", "=", "old_map", "usage", ".", "Note", "that", "@", "@", "-", "138", ",", "10", "+", "140", ",", "11", "@", "@", "pgd_t", "*", "__init", "efi_call_phys_prolog", "(", "void", ")", "pgd_offset_k", "(", "pgd", "*", "PGDIR_SIZE", ")", "->", "pgd", "&", "=", "~", "_PAGE_NX", ";", "}", "out", ":", "__flush_tlb_all", "(", ");", "return", "save_pgd", ";", "out", ":", "efi_call_phys_epilog", "(", "save_pgd", ")", ";", "return", "NULL", ";", "}", "void", "__init", "efi_call_phys_epilog", "(", "pgd_t", "*", "save_pgd", ")"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Move", "repositories", "decl", "to", "end", "of", "pom", "Easier", "to", "find,", "consistent", "with", "other", "repos"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["[SECURITY-1411]"], "code_tokens": ["@", "@", "-", "389", ",", "7", "+", "389", ",", "7", "@", "@", "public", "String", "uploadArtifact", "(", "+", "\"", "/", "commander", "/", "cgi", "-", "bin", "/", "publishArtifactAPI", ".", "cgi", "\"", ";", "/", "/", "return", "sessionId", ";", "MultipartUtility", "multipart", "=", "new", "MultipartUtility", "(", "requestURL", ",", "CHARSET", ")", ";", "MultipartUtility", "multipart", "=", "new", "MultipartUtility", "(", "requestURL", ",", "CHARSET", ",", "this", ".", "getIgnoreSslConnectionErrors", "(", "))", ";", "multipart", ".", "addFormField", "(", "\"", "artifactName", "\"", ",", "name", ")", ";", "multipart", ".", "addFormField", "(", "\"", "artifactVersionVersion", "\"", ",", "version", ")", ";", "@", "@", "-", "9", ",", "6", "+", "9", ",", "9", "@", "@", "package", "org", ".", "jenkinsci", ".", "plugins", ".", "electricflow", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "Log", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "LogFactory", ";", "import", "java", ".", "io", ".", "BufferedReader", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "FileInputStream", ";", "@", "@", "-", "37", ",", "6", "+", "40", ",", "7", "@", "@", "/", "/~", "Static", "fields", "/", "initializers", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "private", "static", "final", "String", "LINE_FEED", "=", "\"", "\\", "r", "\\", "n", "\"", ";", "private", "static", "final", "Log", "log", "=", "LogFactory", ".", "getLog", "(", "MultipartUtility", ".", "class", ")", ";", "/", "/~", "Instance", "fields", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "-", "@", "@", "-", "54", ",", "47", "+", "58", ",", "18", "@", "@", "*", "*", "@", "param", "requestURL", "URL", "for", "request", "*", "@", "param", "charset", "name", "of", "encodings", "*", "@", "param", "ignoreSslConnectionErrors", "Override", "Electric", "Flow", "SSL", "Validation", "Check", "*", "*", "@", "throws", "NoSuchAlgorithmException", "Exception", "*", "@", "throws", "KeyManagementException", "Exception", "*", "@", "throws", "IOException", "Exception", "*", "/", "public", "MultipartUtility", "(", "String", "requestURL", ",", "String", "charset", ")", "throws", "NoSuchAlgorithmException", ",", "KeyManagementException", ",", "IOException", "String", "charset", ",", "boolean", "ignoreSslConnectionErrors", ")", "throws", "IOException", "{", "this", ".", "charset", "=", "charset", ";", "TrustManager", "[", "]", "trustAllCerts", "=", "new", "TrustManager", "[", "]", "{", "new", "X509TrustManager", "(", ")", "{", "@", "Override", "public", "java", ".", "security", ".", "cert", ".", "X509Certificate", "[", "]", "getAcceptedIssuers", "(", ")", "{", "return", "null", ";", "}", "@", "Override", "public", "void", "checkClientTrusted", "(", "X509Certificate", "[", "]", "certs", ",", "String", "authType", ")", "{", "}", "@", "Override", "public", "void", "checkServerTrusted", "(", "X509Certificate", "[", "]", "certs", ",", "String", "authType", ")", "{", "}", "}", "}", ";", "/", "/", "Install", "the", "all", "-", "trusting", "trust", "manager", "SSLContext", "sc", "=", "SSLContext", ".", "getInstance", "(", "\"", "SSL", "\"", ");", "sc", ".", "init", "(", "null", ",", "trustAllCerts", ",", "new", "java", ".", "security", ".", "SecureRandom", "(", "))", ";", "HttpsURLConnection", ".", "setDefaultSSLSocketFactory", "(", "sc", ".", "getSocketFactory", "(", "))", ";", "/", "/", "Create", "all", "-", "trusting", "host", "name", "verifier", "HostnameVerifier", "allHostsValid", "=", "(", "hostname", ",", "session", ")", "-", ">", "true", ";", "/", "/", "Install", "the", "all", "-", "trusting", "host", "verifier", "HttpsURLConnection", ".", "setDefaultHostnameVerifier", "(", "allHostsValid", ")", ";", "/", "/", "creates", "a", "unique", "boundary", "based", "on", "time", "stamp", "boundary", "=", "\"", "==", "=\"", "+", "System", ".", "currentTimeMillis", "(", ")", "+", "\"", "==", "=\"", ";", "@", "@", "-", "107", ",", "10", "+", "82", ",", "21", "@", "@", "public", "MultipartUtility", "(", "httpConn", ".", "setDoInput", "(", "true", ")", ";", "httpConn", ".", "setRequestProperty", "(", "\"", "Content", "-", "Type", "\"", ",", "\"", "multipart", "/", "form", "-", "data", ";", "boundary", "=", "\"", "+", "boundary", ")", ";", "if", "(", "ignoreSslConnectionErrors", ")", "{", "try", "{", "httpConn", ".", "setSSLSocketFactory", "(", "RelaxedSSLContext", ".", "getInstance", "(", ").", "getSocketFactory", "(", "))", ";", "}", "catch", "(", "KeyManagementException", "|", "NoSuchAlgorithmException", "e", ")", "{", "if", "(", "log", ".", "isDebugEnabled", "(", "))", "{", "log", ".", "debug", "(", "e", ".", "getMessage", "(", "),", "e", ")", ";", "}", "}", "httpConn", ".", "setHostnameVerifier", "(", "RelaxedSSLContext", ".", "allHostsValid", ")", ";", "}", "outputStream", "=", "httpConn", ".", "getOutputStream", "(", ");", "writer", "=", "new", "PrintWriter", "(", "new", "OutputStreamWriter", "(", "outputStream", ",", "charset", ")", ",", "true", ")", ";", "/", "/", "Create", "a", "trust", "manager", "that", "does", "not", "validate", "certificate", "chains", "}", "/", "/~", "Methods", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "-"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Fix", "bug", "#72928", "-", "Out", "of", "bound", "when", "verify", "signature", "of", "zip", "phar", "in", "phar_parse_zipfile"], "code_tokens": ["@", "@", "-", "0", ",", "0", "+", "1", ",", "18", "@", "@", "-", "-", "TEST", "-", "-", "Phar", ":", "#", "72928", "(", "Out", "of", "bound", "when", "verify", "signature", "of", "zip", "phar", "in", "phar_parse_zipfile", ")", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "\"", "phar", "\"", "))", "die", "(", "\"", "skip", "\"", ");", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "chdir", "(", "__DIR__", ")", ";", "try", "{", "$", "phar", "=", "new", "PharData", "(", "'", "bug72928", ".", "zip", "'", ");", "var_dump", "(", "$", "phar", ")", ";", "}", "catch", "(", "UnexpectedValueException", "$", "e", ")", "{", "print", "$", "e", "-", ">", "getMessage", "(", ").", "\"\\", "n", "\"", ";", "}", "?", ">", "DONE", "-", "-", "EXPECTF", "-", "-", "phar", "error", ":", "signature", "cannot", "be", "read", "in", "zip", "-", "based", "phar", "\"", "%", "sbug72928", ".", "zip", "\"", "DONE", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "1650", ",", "6", "+", "1650", ",", "13", "@", "@", "int", "phar_verify_signature", "(", "php_stream", "*", "fp", ",", "size_t", "end_of_phar", ",", "php_uint32", "sig_typ", "unsigned", "char", "digest", "[", "64", "]", ";", "PHP_SHA512_CTX", "context", ";", "if", "(", "sig_len", "<", "sizeof", "(", "digest", ")", ")", "{", "if", "(", "error", ")", "{", "spprintf", "(", "error", ",", "0", ",", "\"", "broken", "signature", "\"", ");", "}", "return", "FAILURE", ";", "}", "PHP_SHA512Init", "(", "&", "context", ")", ";", "read_len", "=", "end_of_phar", ";", "@", "@", "-", "1683", ",", "6", "+", "1690", ",", "13", "@", "@", "int", "phar_verify_signature", "(", "php_stream", "*", "fp", ",", "size_t", "end_of_phar", ",", "php_uint32", "sig_typ", "unsigned", "char", "digest", "[", "32", "]", ";", "PHP_SHA256_CTX", "context", ";", "if", "(", "sig_len", "<", "sizeof", "(", "digest", ")", ")", "{", "if", "(", "error", ")", "{", "spprintf", "(", "error", ",", "0", ",", "\"", "broken", "signature", "\"", ");", "}", "return", "FAILURE", ";", "}", "PHP_SHA256Init", "(", "&", "context", ")", ";", "read_len", "=", "end_of_phar", ";", "@", "@", "-", "1724", ",", "6", "+", "1738", ",", "13", "@", "@", "int", "phar_verify_signature", "(", "php_stream", "*", "fp", ",", "size_t", "end_of_phar", ",", "php_uint32", "sig_typ", "unsigned", "char", "digest", "[", "20", "]", ";", "PHP_SHA1_CTX", "context", ";", "if", "(", "sig_len", "<", "sizeof", "(", "digest", ")", ")", "{", "if", "(", "error", ")", "{", "spprintf", "(", "error", ",", "0", ",", "\"", "broken", "signature", "\"", ");", "}", "return", "FAILURE", ";", "}", "PHP_SHA1Init", "(", "&", "context", ")", ";", "read_len", "=", "end_of_phar", ";", "@", "@", "-", "1757", ",", "6", "+", "1778", ",", "13", "@", "@", "int", "phar_verify_signature", "(", "php_stream", "*", "fp", ",", "size_t", "end_of_phar", ",", "php_uint32", "sig_typ", "unsigned", "char", "digest", "[", "16", "]", ";", "PHP_MD5_CTX", "context", ";", "if", "(", "sig_len", "<", "sizeof", "(", "digest", ")", ")", "{", "if", "(", "error", ")", "{", "spprintf", "(", "error", ",", "0", ",", "\"", "broken", "signature", "\"", ");", "}", "return", "FAILURE", ";", "}", "PHP_MD5Init", "(", "&", "context", ")", ";", "read_len", "=", "end_of_phar", ";", "@", "@", "-", "430", ",", "7", "+", "430", ",", "7", "@", "@", "int", "phar_parse_zipfile", "(", "php_stream", "*", "fp", ",", "char", "*", "fname", ",", "int", "fname_len", ",", "char", "*", "alias", ",", "php_stream_seek", "(", "fp", ",", "sizeof", "(", "phar_zip_file_header", ")", "+", "entry", ".", "header_offset", "+", "entry", ".", "filename_len", "+", "PHAR_GET_16", "(", "zipentry", ".", "extra_len", ")", ",", "SEEK_SET", ")", ";", "sig", "=", "(", "char", "*", ")", "emalloc", "(", "entry", ".", "uncompressed_filesize", ")", ";", "read", "=", "php_stream_read", "(", "fp", ",", "sig", ",", "entry", ".", "uncompressed_filesize", ")", ";", "if", "(", "read", "!", "=", "entry", ".", "uncompressed_filesize", ")", "{", "if", "(", "read", "!", "=", "entry", ".", "uncompressed_filesize", "|", "|", "read", "<", "=", "8", ")", "{", "php_stream_close", "(", "sigfile", ")", ";", "efree", "(", "sig", ")", ";", "PHAR_ZIP_FAIL", "(", "\"", "signature", "cannot", "be", "read", "\"", ");"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["binman:", "Put", "compressed", "data", "into", "separate", "files", "At", "present", "compression", "uses", "the", "same", "temporary", "file", "for", "all", "invocations.", "With", "multithreading", "this", "causes", "the", "data", "to", "become", "corrupted.", "Use", "a", "different", "filename", "each", "time.", "Signed-off-by:", "Simon", "Glass", "<sjg@chromium.org>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["fscrypto:", "add", "authorization", "check", "for", "setting", "encryption", "policy", "On", "an", "ext4", "or", "f2fs", "filesystem", "with", "file", "encryption", "supported,", "a", "user", "could", "set", "an", "encryption", "policy", "on", "any", "empty", "directory(*)", "to", "which", "they", "had", "readonly", "access.", "This", "is", "obviously", "problematic,", "since", "such", "a", "directory", "might", "be", "owned", "by", "another", "user", "and", "the", "new", "encryption", "policy", "would", "prevent", "that", "other", "user", "from", "creating", "files", "in", "their", "own", "directory", "(for", "example).", "Fix", "this", "by", "requiring", "inode_owner_or_capable()", "permission", "to", "set", "an", "encryption", "policy.", "This", "means", "that", "either", "the", "caller", "must", "own", "the", "file,", "or", "the", "caller", "must", "have", "the", "capability", "CAP_FOWNER.", "(*)", "Or", "also", "on", "any", "regular", "file,", "for", "f2fs", "v4.6", "and", "later", "and", "ext4", "v4.8-rc1", "and", "later;", "a", "separate", "bug", "fix", "is", "coming", "for", "that.", "Signed-off-by:", "Eric", "Biggers", "<ebiggers@google.com>", "Cc:", "stable@vger.kernel.org", "#", "4.1+;", "check", "fs/{ext4,f2fs}", "Signed-off-by:", "Theodore", "Ts'o", "<tytso@mit.edu>"], "code_tokens": ["@", "@", "-", "95", ",", "6", "+", "95", ",", "9", "@", "@", "static", "int", "create_encryption_context_from_policy", "(", "struct", "inode", "*", "inode", ",", "int", "fscrypt_process_policy", "(", "struct", "inode", "*", "inode", ",", "const", "struct", "fscrypt_policy", "*", "policy", ")", "{", "if", "(", "!", "inode_owner_or_capable", "(", "inode", ")", ")", "return", "-", "EACCES", ";", "if", "(", "policy", "-", ">", "version", "!", "=", "0", ")", "return", "-", "EINVAL", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["arm64:", "setup:", "introduce", "kaslr_offset()", "Introduce", "kaslr_offset()", "similar", "to", "x86_64", "to", "fix", "kcov.", "[", "Updated", "by", "Will", "Deacon", "]", "Link:", "http://lkml.kernel.org/r/1481417456-28826-2-git-send-email-alex.popov@linux.com", "Signed-off-by:", "Alexander", "Popov", "<alex.popov@linux.com>", "Cc:", "Catalin", "Marinas", "<catalin.marinas@arm.com>", "Cc:", "Ard", "Biesheuvel", "<ard.biesheuvel@linaro.org>", "Cc:", "Mark", "Rutland", "<mark.rutland@arm.com>", "Cc:", "Rob", "Herring", "<robh@kernel.org>", "Cc:", "Kefeng", "Wang", "<wangkefeng.wang@huawei.com>", "Cc:", "AKASHI", "Takahiro", "<takahiro.akashi@linaro.org>", "Cc:", "Jon", "Masters", "<jcm@redhat.com>", "Cc:", "David", "Daney", "<david.daney@cavium.com>", "Cc:", "Ganapatrao", "Kulkarni", "<gkulkarni@caviumnetworks.com>", "Cc:", "Dmitry", "Vyukov", "<dvyukov@google.com>", "Cc:", "Nicolai", "Stange", "<nicstange@gmail.com>", "Cc:", "James", "Morse", "<james.morse@arm.com>", "Cc:", "Andrey", "Ryabinin", "<aryabinin@virtuozzo.com>", "Cc:", "Andrey", "Konovalov", "<andreyknvl@google.com>", "Cc:", "Alexander", "Popov", "<alex.popov@linux.com>", "Cc:", "syzkaller", "<syzkaller@googlegroups.com>", "Signed-off-by:", "Andrew", "Morton", "<akpm@linux-foundation.org>", "Signed-off-by:", "Will", "Deacon", "<will.deacon@arm.com>", "Signed-off-by:", "Linus", "Torvalds", "<torvalds@linux-foundation.org>"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["aacraid:", "missing", "capable()", "check", "in", "compat", "ioctl", "In", "commit", "d496f94d22d1", "('[SCSI]", "aacraid:", "fix", "security", "weakness')", "we", "added", "a", "check", "on", "CAP_SYS_RAWIO", "to", "the", "ioctl.", "The", "compat", "ioctls", "need", "the", "check", "as", "well.", "Signed-off-by:", "Dan", "Carpenter", "<dan.carpenter@oracle.com>", "Cc:", "stable@kernel.org", "Signed-off-by:", "Linus", "Torvalds", "<torvalds@linux-foundation.org>"], "code_tokens": ["@", "@", "-", "771", ",", "6", "+", "771", ",", "8", "@", "@", "static", "long", "aac_compat_do_ioctl", "(", "struct", "aac_dev", "*", "dev", ",", "unsigned", "cmd", ",", "unsigned", "long", "static", "int", "aac_compat_ioctl", "(", "struct", "scsi_device", "*", "sdev", ",", "int", "cmd", ",", "void", "__user", "*", "arg", ")", "{", "struct", "aac_dev", "*", "dev", "=", "(", "struct", "aac_dev", "*", ")", "sdev", "-", ">", "host", "-", ">", "hostdata", ";", "if", "(", "!", "capable", "(", "CAP_SYS_RAWIO", ")", ")", "return", "-", "EPERM", ";", "return", "aac_compat_do_ioctl", "(", "dev", ",", "cmd", ",", "(", "unsigned", "long", ")", "arg", ")", ";", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["https://github.com/ImageMagick/ImageMagick/issues/99"], "code_tokens": ["@", "@", "-", "506", ",", "8", "+", "506", ",", "8", "@", "@", "static", "Image", "*", "ReadVIFFImage", "(", "const", "ImageInfo", "*", "image_info", ",", "max_packets", "=", "((", "image", "-", ">", "columns", "+", "7UL", ")", ">", ">", "3UL", ")", "*", "image", "-", ">", "rows", ";", "else", "max_packets", "=", "(", "size_t", ")", "(", "number_pixels", "*", "viff_info", ".", "number_data_bands", ")", ";", "pixels", "=", "(", "unsigned", "char", "*", ")", "AcquireQuantumMemory", "(", "max_packets", ",", "bytes_per_pixel", "*", "sizeof", "(", "*", "pixels", ")", ");", "pixels", "=", "(", "unsigned", "char", "*", ")", "AcquireQuantumMemory", "(", "MagickMax", "(", "number_pixels", ",", "max_packets", ")", ",", "bytes_per_pixel", "*", "sizeof", "(", "*", "pixels", ")", ");", "if", "(", "pixels", "=", "=", "(", "unsigned", "char", "*", ")", "NULL", ")", "ThrowReaderException", "(", "ResourceLimitError", ",", "\"", "MemoryAllocationFailed", "\"", ");", "(", "void", ")", "ReadBlob", "(", "image", ",", "bytes_per_pixel", "*", "max_packets", ",", "pixels", ")", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["netfilter:", "arp_tables:", "fix", "infoleak", "to", "userspace", "Structures", "ipt_replace,", "compat_ipt_replace,", "and", "xt_get_revision", "are", "copied", "from", "userspace.", "Fields", "of", "these", "structs", "that", "are", "zero-terminated", "strings", "are", "not", "checked.", "When", "they", "are", "used", "as", "argument", "to", "a", "format", "string", "containing", "\"%s\"", "in", "request_module(),", "some", "sensitive", "information", "is", "leaked", "to", "userspace", "via", "argument", "of", "spawned", "modprobe", "process.", "The", "first", "bug", "was", "introduced", "before", "the", "git", "epoch;", "the", "second", "is", "introduced", "by", "6b7d31fc", "(v2.6.15-rc1);", "the", "third", "is", "introduced", "by", "6b7d31fc", "(v2.6.15-rc1).", "To", "trigger", "the", "bug", "one", "should", "have", "CAP_NET_ADMIN.", "Signed-off-by:", "Vasiliy", "Kulikov", "<segoon@openwall.com>", "Signed-off-by:", "Patrick", "McHardy", "<kaber@trash.net>"], "code_tokens": ["@", "@", "-", "1066", ",", "6", "+", "1066", ",", "7", "@", "@", "static", "int", "do_replace", "(", "struct", "net", "*", "net", ",", "const", "void", "__user", "*", "user", ",", "/", "*", "overflow", "check", "*", "/", "if", "(", "tmp", ".", "num_counters", ">", "=", "INT_MAX", "/", "sizeof", "(", "struct", "xt_counters", ")", ")", "return", "-", "ENOMEM", ";", "tmp", ".", "name", "[", "sizeof", "(", "tmp", ".", "name", ")", "-", "1", "]", "=", "0", ";", "newinfo", "=", "xt_alloc_table_info", "(", "tmp", ".", "size", ")", ";", "if", "(", "!", "newinfo", ")", "@", "@", "-", "1488", ",", "6", "+", "1489", ",", "7", "@", "@", "static", "int", "compat_do_replace", "(", "struct", "net", "*", "net", ",", "void", "__user", "*", "user", ",", "return", "-", "ENOMEM", ";", "if", "(", "tmp", ".", "num_counters", ">", "=", "INT_MAX", "/", "sizeof", "(", "struct", "xt_counters", ")", ")", "return", "-", "ENOMEM", ";", "tmp", ".", "name", "[", "sizeof", "(", "tmp", ".", "name", ")", "-", "1", "]", "=", "0", ";", "newinfo", "=", "xt_alloc_table_info", "(", "tmp", ".", "size", ")", ";", "if", "(", "!", "newinfo", ")", "@", "@", "-", "1740", ",", "6", "+", "1742", ",", "7", "@", "@", "static", "int", "do_arpt_get_ctl", "(", "struct", "sock", "*", "sk", ",", "int", "cmd", ",", "void", "__user", "*", "user", ",", "int", "*", "len", "ret", "=", "-", "EFAULT", ";", "break", ";", "}", "rev", ".", "name", "[", "sizeof", "(", "rev", ".", "name", ")", "-", "1", "]", "=", "0", ";", "try_then_request_module", "(", "xt_find_revision", "(", "NFPROTO_ARP", ",", "rev", ".", "name", ",", "rev", ".", "revision", ",", "1", ",", "&", "ret", ")", ","], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["HV-912", "Removing", "methods", "from", "ReflectionHelper", "which", "make", "privileged", "operations", "publicly", "accessible"], "code_tokens": ["@", "@", "-", "0", ",", "0", "+", "1", ",", "71", "@", "@", "/", "*", "*", "JBoss", ",", "Home", "of", "Professional", "Open", "Source", "*", "Copyright", "2014", ",", "Red", "Hat", ",", "Inc", ".", "and", "/", "or", "its", "affiliates", ",", "and", "individual", "contributors", "*", "by", "the", "@", "authors", "tag", ".", "See", "the", "copyright", ".", "txt", "in", "the", "distribution", "for", "a", "*", "full", "listing", "of", "individual", "contributors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "cdi", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newArrayList", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "Contracts", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "classhierarchy", ".", "ClassHierarchyHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetMethods", ";", "/", "**", "*", "Deals", "with", "methods", "of", "types", "in", "inheritance", "hierarchies", ".", "*", "*", "@", "author", "Hardy", "Ferentschik", "*", "@", "author", "Gunnar", "Morling", "*", "*", "/", "class", "InheritedMethodsHelper", "{", "/", "**", "*", "Get", "a", "list", "of", "all", "methods", "wich", "the", "given", "class", "declares", ",", "implements", ",", "*", "overrides", "or", "inherits", ".", "Methods", "are", "added", "by", "adding", "first", "all", "methods", "of", "*", "the", "class", "itself", "and", "its", "implemented", "interfaces", ",", "then", "the", "super", "class", "and", "*", "its", "interfaces", ",", "etc", ".", "*", "*", "@", "param", "clazz", "the", "class", "for", "which", "to", "retrieve", "the", "methods", "*", "*", "@", "return", "set", "of", "all", "methods", "of", "the", "given", "class", "*", "/", "static", "List", "<", "Method", ">", "getAllMethods", "(", "Class", "<", "?>", "clazz", ")", "{", "Contracts", ".", "assertNotNull", "(", "clazz", ")", ";", "List", "<", "Method", ">", "methods", "=", "newArrayList", "(", ");", "for", "(", "Class", "<", "?>", "hierarchyClass", ":", "ClassHierarchyHelper", ".", "getHierarchy", "(", "clazz", ")", ")", "{", "Collections", ".", "addAll", "(", "methods", ",", "run", "(", "GetMethods", ".", "action", "(", "hierarchyClass", ")", ")", ")", ";", "}", "return", "methods", ";", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "static", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "26", ",", "6", "+", "26", ",", "7", "@", "@", "import", "java", ".", "util", ".", "LinkedList", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "javax", ".", "enterprise", ".", "event", ".", "Observes", ";", "import", "javax", ".", "enterprise", ".", "inject", ".", "Default", ";", "import", "javax", ".", "enterprise", ".", "inject", ".", "spi", ".", "AfterBeanDiscovery", ";", "@", "@", "-", "60", ",", "7", "+", "61", ",", "6", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ExecutableHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "TypeResolutionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "classhierarchy", ".", "ClassHierarchyHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "@", "@", "-", "268", ",", "7", "+", "268", ",", "7", "@", "@", "else", "if", "(", "bean", ".", "getTypes", "(", ").", "contains", "(", "Validator", ".", "class", ")", "|", "|", "bean", "instanceof", "Validat", "private", "<", "T", ">", "void", "determineConstrainedMethod", "(", "AnnotatedType", "<", "T", ">", "type", ",", "BeanDescriptor", "beanDescriptor", ",", "Set", "<", "AnnotatedCallable", "<", "?", "super", "T", ">", ">", "callables", ")", "{", "List", "<", "Method", ">", "overriddenAndImplementedMethods", "=", "ClassHierarchyHelper", ".", "getAllMethods", "(", "type", ".", "getJavaClass", "(", ")", ")", ";", "List", "<", "Method", ">", "overriddenAndImplementedMethods", "=", "InheritedMethodsHelper", ".", "getAllMethods", "(", "type", ".", "getJavaClass", "(", ")", ")", ";", "for", "(", "AnnotatedMethod", "<", "?", "super", "T", ">", "annotatedMethod", ":", "type", ".", "getMethods", "(", ")", ")", "{", "Method", "method", "=", "annotatedMethod", ".", "getJavaMember", "(", ");", "@", "@", "-", "18", ",", "8", "+", "18", ",", "11", "@", "@", "import", "java", ".", "lang", ".", "annotation", ".", "Annotation", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Type", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "javax", ".", "enterprise", ".", "context", ".", "ApplicationScoped", ";", "import", "javax", ".", "enterprise", ".", "context", ".", "spi", ".", "CreationalContext", ";", "import", "javax", ".", "enterprise", ".", "inject", ".", "spi", ".", "Bean", ";", "@", "@", "-", "36", ",", "8", "+", "39", ",", "8", "@", "@", "import", "javax", ".", "validation", ".", "ValidatorFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "classhierarchy", ".", "ClassHierarchyHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "LoadClass", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashSet", ";", "@", "@", "-", "141", ",", "9", "+", "144", ",", "11", "@", "@", "private", "MessageInterpolator", "createMessageInterpolator", "(", "Configuration", "<", "?>", "config", ")", "{", "}", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Class", "<", "MessageInterpolator", ">", "messageInterpolatorClass", "=", "(", "Class", "<", "MessageInterpolator", ">", ")", "ReflectionHelper", ".", "loadClass", "(", "messageInterpolatorFqcn", ",", "this", ".", "getClass", "(", ")", "Class", "<", "MessageInterpolator", ">", "messageInterpolatorClass", "=", "(", "Class", "<", "MessageInterpolator", ">", ")", "run", "(", "LoadClass", ".", "action", "(", "messageInterpolatorFqcn", ",", "this", ".", "getClass", "(", ")", ")", ")", ";", "return", "createInstance", "(", "messageInterpolatorClass", ")", ";", "@", "@", "-", "158", ",", "9", "+", "163", ",", "11", "@", "@", "private", "TraversableResolver", "createTraversableResolver", "(", "Configuration", "<", "?>", "config", ")", "{", "}", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Class", "<", "TraversableResolver", ">", "traversableResolverClass", "=", "(", "Class", "<", "TraversableResolver", ">", ")", "ReflectionHelper", ".", "loadClass", "(", "traversableResolverFqcn", ",", "this", ".", "getClass", "(", ")", "Class", "<", "TraversableResolver", ">", "traversableResolverClass", "=", "(", "Class", "<", "TraversableResolver", ">", ")", "run", "(", "LoadClass", ".", "action", "(", "traversableResolverFqcn", ",", "this", ".", "getClass", "(", ")", ")", ")", ";", "return", "createInstance", "(", "traversableResolverClass", ")", ";", "@", "@", "-", "175", ",", "9", "+", "182", ",", "11", "@", "@", "private", "ParameterNameProvider", "createParameterNameProvider", "(", "Configuration", "<", "?>", "confi", "}", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Class", "<", "ParameterNameProvider", ">", "parameterNameProviderClass", "=", "(", "Class", "<", "ParameterNameProvider", ">", ")", "ReflectionHelper", ".", "loadClass", "(", "parameterNameProviderFqcn", ",", "this", ".", "getClass", "(", ")", "Class", "<", "ParameterNameProvider", ">", "parameterNameProviderClass", "=", "(", "Class", "<", "ParameterNameProvider", ">", ")", "run", "(", "LoadClass", ".", "action", "(", "parameterNameProviderFqcn", ",", "this", ".", "getClass", "(", ")", ")", ")", ";", "return", "createInstance", "(", "parameterNameProviderClass", ")", ";", "@", "@", "-", "193", ",", "11", "+", "202", ",", "12", "@", "@", "private", "ConstraintValidatorFactory", "createConstraintValidatorFactory", "(", "Configuratio", "}", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Class", "<", "ConstraintValidatorFactory", ">", "constraintValidatorFactoryClass", "=", "(", "Class", "<", "ConstraintValidatorFactory", ">", ")", "ReflectionHelper", ".", "loadClass", "(", "Class", "<", "ConstraintValidatorFactory", ">", "constraintValidatorFactoryClass", "=", "(", "Class", "<", "ConstraintValidatorFactory", ">", ")", "run", "(", "LoadClass", ".", "action", "(", "constraintValidatorFactoryFqcn", ",", "this", ".", "getClass", "(", ")", ")", ";", ")", ")", ";", "return", "createInstance", "(", "constraintValidatorFactoryClass", ")", ";", "}", "@", "@", "-", "214", ",", "6", "+", "224", ",", "16", "@", "@", "private", "ConstraintValidatorFactory", "createConstraintValidatorFactory", "(", "Configuratio", "Validation", ".", "byProvider", "(", "org", ".", "hibernate", ".", "validator", ".", "HibernateValidator", ".", "class", ")", ".", "configure", "(", ");", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "@", "Override", "public", "String", "getId", "(", ")", "{", "return", "ValidatorFactoryBean", ".", "class", ".", "getName", "(", ")", "+", "\"", "_", "\"", "+", "(", "validationProviderHelper", ".", "isDefaultProvider", "(", ")", "?", "\"", "default", "\"", ":", "\"", "hv", "\"", ")", ";", "@", "@", "-", "20", ",", "9", "+", "20", ",", "12", "@", "@", "import", "java", ".", "lang", ".", "reflect", ".", "Constructor", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Member", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "javax", ".", "validation", ".", "ParameterNameProvider", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "ConstraintDef", ";", "@", "@", "-", "44", ",", "6", "+", "47", ",", "11", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "StringHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredConstructor", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredField", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredMethod", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetMethod", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "NewInstance", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "spi", ".", "group", ".", "DefaultGroupSequenceProvider", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashSet", ";", "@", "@", "-", "114", ",", "7", "+", "122", ",", "7", "@", "@", "public", "PropertyConstraintMappingContext", "property", "(", "String", "property", ",", "ElementType", "el", "Contracts", ".", "assertNotNull", "(", "elementType", ",", "\"", "The", "element", "type", "must", "not", "be", "null", ".", "\"", ")", ";", "Contracts", ".", "assertNotEmpty", "(", "property", ",", "MESSAGES", ".", "propertyNameMustNotBeEmpty", "(", ")", ")", ";", "Member", "member", "=", "ReflectionHelper", ".", "getMember", "(", "Member", "member", "=", "getMember", "(", "beanClass", ",", "property", ",", "elementType", ")", ";", "@", "@", "-", "140", ",", "7", "+", "148", ",", "7", "@", "@", "public", "PropertyConstraintMappingContext", "property", "(", "String", "property", ",", "ElementType", "el", "public", "MethodConstraintMappingContext", "method", "(", "String", "name", ",", "Class", "<", "?>", "..", ".", "parameterTypes", ")", "{", "Contracts", ".", "assertNotNull", "(", "name", ",", "MESSAGES", ".", "methodNameMustNotBeNull", "(", ")", ")", ";", "Method", "method", "=", "ReflectionHelper", ".", "getDeclaredMethod", "(", "beanClass", ",", "name", ",", "parameterTypes", ")", ";", "Method", "method", "=", "run", "(", "GetDeclaredMethod", ".", "action", "(", "beanClass", ",", "name", ",", "parameterTypes", ")", ")", ";", "if", "(", "method", "=", "=", "null", "|", "|", "method", ".", "getDeclaringClass", "(", ")", "!", "=", "beanClass", ")", "{", "throw", "log", ".", "getUnableToFindMethodException", "(", "@", "@", "-", "165", ",", "7", "+", "173", ",", "7", "@", "@", "public", "MethodConstraintMappingContext", "method", "(", "String", "name", ",", "Class", "<", "?>", "..", ".", "parameterT", "@", "Override", "public", "ConstructorConstraintMappingContext", "constructor", "(", "Class", "<", "?>", "..", ".", "parameterTypes", ")", "{", "Constructor", "<", "C", ">", "constructor", "=", "ReflectionHelper", ".", "getDeclaredConstructor", "(", "beanClass", ",", "parameterTypes", ")", ";", "Constructor", "<", "C", ">", "constructor", "=", "run", "(", "GetDeclaredConstructor", ".", "action", "(", "beanClass", ",", "parameterTypes", ")", ")", ";", "if", "(", "constructor", "=", "=", "null", "|", "|", "constructor", ".", "getDeclaringClass", "(", ")", "!", "=", "beanClass", ")", "{", "throw", "log", ".", "getBeanDoesNotContainConstructorException", "(", "@", "@", "-", "227", ",", "9", "+", "235", ",", "11", "@", "@", "public", "ConstructorConstraintMappingContext", "constructor", "(", "Class", "<", "?>", "..", ".", "parameterType", "}", "private", "DefaultGroupSequenceProvider", "<", "?", "super", "C", ">", "getDefaultGroupSequenceProvider", "(", ")", "{", "return", "defaultGroupSequenceProviderClass", "!", "=", "null", "?", "ReflectionHelper", ".", "newInstance", "(", "defaultGroupSequenceProviderClass", ",", "\"", "default", "group", "sequence", "provider", "\"", "return", "defaultGroupSequenceProviderClass", "!", "=", "null", "?", "run", "(", "NewInstance", ".", "action", "(", "defaultGroupSequenceProviderClass", ",", "\"", "default", "group", "sequence", "provider", "\"", ")", ")", ":", "null", ";", "}", "@", "@", "-", "241", ",", "4", "+", "251", ",", "50", "@", "@", "public", "ConstructorConstraintMappingContext", "constructor", "(", "Class", "<", "?>", "..", ".", "parameterType", "protected", "ConstraintType", "getConstraintType", "(", ")", "{", "return", "ConstraintType", ".", "GENERIC", ";", "}", "/", "**", "*", "Returns", "the", "member", "with", "the", "given", "name", "and", "type", ".", "*", "*", "@", "param", "clazz", "The", "class", "from", "which", "to", "retrieve", "the", "member", ".", "Cannot", "be", "{", "@", "code", "null", "}", ".", "*", "@", "param", "property", "The", "property", "name", "without", "\"", "is", "\"", ",", "\"", "get", "\"", "or", "\"", "has", "\"", ".", "Cannot", "be", "{", "@", "code", "null", "}", "or", "empty", ".", "*", "@", "param", "elementType", "The", "element", "type", ".", "Either", "{", "@", "code", "ElementType", ".", "FIELD", "}", "or", "{", "@", "code", "ElementType", "METHOD", "}", ".", "*", "*", "@", "return", "the", "member", "which", "matching", "the", "name", "and", "type", "or", "{", "@", "code", "null", "}", "if", "no", "such", "member", "exists", ".", "*", "/", "private", "Member", "getMember", "(", "Class", "<", "?>", "clazz", ",", "String", "property", ",", "ElementType", "elementType", ")", "{", "Contracts", ".", "assertNotNull", "(", "clazz", ",", "MESSAGES", ".", "classCannotBeNull", "(", ")", ")", ";", "if", "(", "property", "=", "=", "null", "|", "|", "property", ".", "length", "(", ")", "=", "=", "0", ")", "{", "throw", "log", ".", "getPropertyNameCannotBeNullOrEmptyException", "(", ");", "}", "if", "(", "!", "(", "ElementType", ".", "FIELD", ".", "equals", "(", "elementType", ")", "|", "|", "ElementType", ".", "METHOD", ".", "equals", "(", "elementType", ")", ")", ")", "{", "throw", "log", ".", "getElementTypeHasToBeFieldOrMethodException", "(", ");", "}", "Member", "member", "=", "null", ";", "if", "(", "ElementType", ".", "FIELD", ".", "equals", "(", "elementType", ")", ")", "{", "member", "=", "run", "(", "GetDeclaredField", ".", "action", "(", "clazz", ",", "property", ")", ")", ";", "}", "else", "{", "String", "methodName", "=", "property", ".", "substring", "(", "0", ",", "1", ")", ".", "toUpperCase", "(", ")", "+", "property", ".", "substring", "(", "1", ")", ";", "for", "(", "String", "prefix", ":", "ReflectionHelper", ".", "PROPERTY_ACCESSOR_PREFIXES", ")", "{", "member", "=", "run", "(", "GetMethod", ".", "action", "(", "clazz", ",", "prefix", "+", "methodName", ")", ")", ";", "if", "(", "member", "!", "=", "null", ")", "{", "break", ";", "}", "}", "}", "return", "member", ";", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "19", ",", "6", "+", "19", ",", "8", "@", "@", "import", "java", ".", "io", ".", "BufferedInputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "@", "@", "-", "28", ",", "6", "+", "30", ",", "7", "@", "@", "import", "javax", ".", "validation", ".", "MessageInterpolator", ";", "import", "javax", ".", "validation", ".", "ParameterNameProvider", ";", "import", "javax", ".", "validation", ".", "TraversableResolver", ";", "import", "javax", ".", "validation", ".", "ValidationException", ";", "import", "javax", ".", "validation", ".", "ValidationProviderResolver", ";", "import", "javax", ".", "validation", ".", "ValidatorFactory", ";", "import", "javax", ".", "validation", ".", "spi", ".", "BootstrapState", ";", "@", "@", "-", "43", ",", "11", "+", "46", ",", "11", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "engine", ".", "valuehandling", ".", "OptionalValueUnwrapper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "Contracts", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "TypeResolutionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "Version", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "LoadClass", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "xml", ".", "ValidationBootstrapParameters", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "xml", ".", "ValidationXmlParser", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "messageinterpolation", ".", "ResourceBundleMessageInterpolator", ";", "@", "@", "-", "433", ",", "6", "+", "436", ",", "26", "@", "@", "private", "void", "applyXmlSettings", "(", "ValidationBootstrapParameters", "xmlParameters", ")", "{", "}", "private", "boolean", "isJavaFxInClasspath", "(", ")", "{", "return", "ReflectionHelper", ".", "isClassPresent", "(", "\"", "javafx", ".", "application", ".", "Application", "\"", ",", "this", ".", "getClass", "(", ")", ")", ";", "return", "isClassPresent", "(", "\"", "javafx", ".", "application", ".", "Application", "\"", ")", ";", "}", "private", "boolean", "isClassPresent", "(", "String", "className", ")", "{", "try", "{", "run", "(", "LoadClass", ".", "action", "(", "className", ",", "getClass", "(", ")", ")", ")", ";", "return", "true", ";", "}", "catch", "(", "ValidationException", "e", ")", "{", "return", "false", ";", "}", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "static", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "16", ",", "6", "+", "16", ",", "8", "@", "@", "*", "/", "package", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "engine", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "IdentityHashMap", ";", "import", "java", ".", "util", ".", "List", ";", "@", "@", "-", "40", ",", "10", "+", "42", ",", "11", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "provider", ".", "ProgrammaticMetaDataProvider", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "provider", ".", "XmlMetaDataProvider", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ExecutableHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "TypeResolutionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "LoadClass", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "NewInstance", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "messageinterpolation", ".", "ResourceBundleMessageInterpolator", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "spi", ".", "valuehandling", ".", "ValidatedValueUnwrapper", ";", "@", "@", "-", "257", ",", "7", "+", "260", ",", "7", "@", "@", "Validator", "createValidator", "(", "ConstraintValidatorFactory", "constraintValidatorFactory", ",", "throw", "log", ".", "getMissingELDependenciesException", "(", ");", "}", "}", "BeanMetaDataManager", "beanMetaDataManager", ";", "if", "(", "!", "beanMetaDataManagerMap", ".", "containsKey", "(", "parameterNameProvider", ")", ")", "{", "beanMetaDataManager", "=", "new", "BeanMetaDataManager", "(", "@", "@", "-", "337", ",", "12", "+", "340", ",", "21", "@", "@", "private", "boolean", "checkPropertiesForFailFast", "(", "Map", "<", "String", ",", "String", ">", "properties", ",", "boole", "for", "(", "String", "handlerName", ":", "handlerNames", ")", "{", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Class", "<", "?", "extends", "ValidatedValueUnwrapper", "<", "?>", ">", "handlerType", "=", "(", "Class", "<", "?", "extends", "ValidatedValueUnwrapper", "<", "?>", ">)", "ReflectionHelper", ".", "loadClass", "(", "handlerName", ",", "ValidatorFactoryImpl", ".", "class", ")", ";", "handlers", ".", "add", "(", "ReflectionHelper", ".", "newInstance", "(", "handlerType", ",", "\"", "validated", "value", "handler", "class", "\"", ")", ")", ";", "Class", "<", "?", "extends", "ValidatedValueUnwrapper", "<", "?>", ">", "handlerType", "=", "(", "Class", "<", "?", "extends", "ValidatedValueUnwrapper", "<", "?>", ">)", "run", "(", "LoadClass", ".", "action", "(", "handlerName", ",", "ValidatorFactoryImpl", ".", "class", ")", ")", ";", "handlers", ".", "add", "(", "run", "(", "NewInstance", ".", "action", "(", "handlerType", ",", "\"", "validated", "value", "handler", "class", "\"", ")", ")", ")", ";", "}", "return", "handlers", ";", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "16", ",", "26", "+", "16", ",", "40", "@", "@", "*", "/", "package", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "engine", ".", "constraintvalidation", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "javax", ".", "validation", ".", "ConstraintValidator", ";", "import", "javax", ".", "validation", ".", "ConstraintValidatorFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "NewInstance", ";", "/", "**", "*", "Default", "{", "@", "code", "ConstraintValidatorFactory", "}", "using", "a", "no", "-", "arg", "constructor", ".", "*", "*", "@", "author", "Emmanuel", "Bernard", "*", "@", "author", "Hardy", "Ferentschik", "*", "/", "/", "/", "TODO", "Can", "we", "make", "the", "constructor", "non", "-", "public", "?", "public", "class", "ConstraintValidatorFactoryImpl", "implements", "ConstraintValidatorFactory", "{", "@", "Override", "public", "final", "<", "T", "extends", "ConstraintValidator", "<", "?,", "?", ">>", "T", "getInstance", "(", "Class", "<", "T", ">", "key", ")", "{", "return", "ReflectionHelper", ".", "newInstance", "(", "key", ",", "\"", "ConstraintValidator", "\"", ")", ";", "return", "run", "(", "NewInstance", ".", "action", "(", "key", ",", "\"", "ConstraintValidator", "\"", ")", ")", ";", "}", "@", "Override", "public", "void", "releaseInstance", "(", "ConstraintValidator", "<", "?,", "?", ">", "instance", ")", "{", "/", "/", "noop", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "18", ",", "13", "+", "18", ",", "19", "@", "@", "import", "java", ".", "lang", ".", "annotation", ".", "ElementType", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "javax", ".", "validation", ".", "Path", ";", "import", "javax", ".", "validation", ".", "TraversableResolver", ";", "import", "javax", ".", "validation", ".", "ValidationException", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetMethod", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "LoadClass", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "NewInstance", ";", "/", "**", "*", "A", "JPA", "2", "aware", "{", "@", "code", "TraversableResolver", "}", ".", "@", "@", "-", "68", ",", "7", "+", "74", ",", "7", "@", "@", "private", "void", "detectJPA", "(", ")", "{", "/", "/", "check", "whether", "we", "have", "Persistence", "on", "the", "classpath", "Class", "<", "?>", "persistenceClass", ";", "try", "{", "persistenceClass", "=", "ReflectionHelper", ".", "loadClass", "(", "PERSISTENCE_CLASS_NAME", ",", "this", ".", "getClass", "(", ")", ")", ";", "persistenceClass", "=", "run", "(", "LoadClass", ".", "action", "(", "PERSISTENCE_CLASS_NAME", ",", "this", ".", "getClass", "(", ")", ")", ")", ";", "}", "catch", "(", "ValidationException", "e", ")", "{", "log", ".", "debugf", "(", "@", "@", "-", "79", ",", "7", "+", "85", ",", "7", "@", "@", "private", "void", "detectJPA", "(", ")", "{", "}", "/", "/", "check", "whether", "Persistence", "contains", "getPersistenceUtil", "Method", "persistenceUtilGetter", "=", "ReflectionHelper", ".", "getMethod", "(", "persistenceClass", ",", "PERSISTENCE_UTIL_METHOD", ")", ";", "Method", "persistenceUtilGetter", "=", "run", "(", "GetMethod", ".", "action", "(", "persistenceClass", ",", "PERSISTENCE_UTIL_METHOD", ")", ")", ";", "if", "(", "persistenceUtilGetter", "=", "=", "null", ")", "{", "log", ".", "debugf", "(", "\"", "Found", "%", "s", "on", "classpath", ",", "but", "no", "method", "'", "%", "s", "'", ".", "Assuming", "JPA", "1", "environment", ".", "All", "properties", "will", "per", "default", "be", "traversable", ".", "\",", "@", "@", "-", "92", ",", "7", "+", "98", ",", "7", "@", "@", "private", "void", "detectJPA", "(", ")", "{", "/", "/", "try", "to", "invoke", "the", "method", "to", "make", "sure", "that", "we", "are", "dealing", "with", "a", "complete", "JPA2", "implementation", "/", "/", "unfortunately", "there", "are", "several", "incomplete", "implementations", "out", "there", "(", "see", "HV", "-", "374", ")", "try", "{", "Object", "persistence", "=", "ReflectionHelper", ".", "newInstance", "(", "persistenceClass", ",", "\"", "persistence", "provider", "\"", ")", ";", "Object", "persistence", "=", "run", "(", "NewInstance", ".", "action", "(", "persistenceClass", ",", "\"", "persistence", "provider", "\"", ")", ")", ";", "ReflectionHelper", ".", "getValue", "(", "persistenceUtilGetter", ",", "persistence", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "@", "@", "-", "112", ",", "8", "+", "118", ",", "8", "@", "@", "private", "void", "detectJPA", "(", ")", "{", "try", "{", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Class", "<", "?", "extends", "TraversableResolver", ">", "jpaAwareResolverClass", "=", "(", "Class", "<", "?", "extends", "TraversableResolver", ">", ")", "ReflectionHelper", ".", "loadClass", "(", "JPA_AWARE_TRAVERSABLE_RESOLVER_CLASS_NAME", ",", "this", ".", "getClass", "(", ")", ")", ";", "jpaTraversableResolver", "=", "ReflectionHelper", ".", "newInstance", "(", "jpaAwareResolverClass", ",", "\"", "\"", ")", ";", "run", "(", "LoadClass", ".", "action", "(", "JPA_AWARE_TRAVERSABLE_RESOLVER_CLASS_NAME", ",", "this", ".", "getClass", "(", ")", ")", ")", ";", "jpaTraversableResolver", "=", "run", "(", "NewInstance", ".", "action", "(", "jpaAwareResolverClass", ",", "\"", "\"", ")", ")", ";", "log", ".", "debugf", "(", "\"", "Instantiated", "JPA", "aware", "TraversableResolver", "of", "type", "%", "s", ".", "\",", "JPA_AWARE_TRAVERSABLE_RESOLVER_CLASS_NAME", ")", ";", "@", "@", "-", "126", ",", "15", "+", "132", ",", "27", "@", "@", "private", "void", "detectJPA", "(", ")", "{", "}", "}", "@", "Override", "public", "boolean", "isReachable", "(", "Object", "traversableObject", ",", "Path", ".", "Node", "traversableProperty", ",", "Class", "<", "?>", "rootBeanType", ",", "Path", "pathToTraversableObject", ",", "ElementType", "elementType", ")", "{", "return", "jpaTraversableResolver", "=", "=", "null", "|", "|", "jpaTraversableResolver", ".", "isReachable", "(", "traversableObject", ",", "traversableProperty", ",", "rootBeanType", ",", "pathToTraversableObject", ",", "elementType", ")", ";", "}", "@", "Override", "public", "boolean", "isCascadable", "(", "Object", "traversableObject", ",", "Path", ".", "Node", "traversableProperty", ",", "Class", "<", "?>", "rootBeanType", ",", "Path", "pathToTraversableObject", ",", "ElementType", "elementType", ")", "{", "return", "jpaTraversableResolver", "=", "=", "null", "|", "|", "jpaTraversableResolver", ".", "isCascadable", "(", "traversableObject", ",", "traversableProperty", ",", "rootBeanType", ",", "pathToTraversableObject", ",", "elementType", ")", ";", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "18", ",", "13", "+", "18", ",", "17", "@", "@", "import", "java", ".", "lang", ".", "annotation", ".", "Annotation", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ConcurrentMap", ";", "import", "javax", ".", "validation", ".", "Constraint", ";", "import", "javax", ".", "validation", ".", "ConstraintTarget", ";", "import", "javax", ".", "validation", ".", "ConstraintValidator", ";", "import", "javax", ".", "validation", ".", "ValidationException", ";", "import", "javax", ".", "validation", ".", "constraints", ".", "AssertFalse", ";", "import", "javax", ".", "validation", ".", "constraints", ".", "AssertTrue", ";", "import", "javax", ".", "validation", ".", "constraints", ".", "DecimalMax", ";", "@", "@", "-", "115", ",", "10", "+", "119", ",", "13", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "constraintvalidators", ".", "bv", ".", "size", ".", "SizeValidatorForMap", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "constraintvalidators", ".", "hv", ".", "URLValidator", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "Contracts", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "Version", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetAnnotationParameter", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredMethods", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetMethod", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "LoadClass", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newArrayList", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newConcurrentHashMap", ";", "@", "@", "-", "415", ",", "7", "+", "422", ",", "7", "@", "@", "private", "boolean", "supportsValidationTarget", "(", "Class", "<", "?", "extends", "ConstraintValidator", "<", "?,", "*", "/", "public", "boolean", "isMultiValueConstraint", "(", "Class", "<", "?", "extends", "Annotation", ">", "annotationType", ")", "{", "boolean", "isMultiValueConstraint", "=", "false", ";", "final", "Method", "method", "=", "ReflectionHelper", ".", "getMethod", "(", "annotationType", ",", "\"", "value", "\"", ")", ";", "final", "Method", "method", "=", "run", "(", "GetMethod", ".", "action", "(", "annotationType", ",", "\"", "value", "\"", ")", ")", ";", "if", "(", "method", "!", "=", "null", ")", "{", "Class", "<", "?>", "returnType", "=", "method", ".", "getReturnType", "(", ");", "if", "(", "returnType", ".", "isArray", "(", ")", "&", "&", "returnType", ".", "getComponentType", "(", ").", "isAnnotation", "(", ")", ")", "{", "@", "@", "-", "444", ",", "10", "+", "451", ",", "12", "@", "@", "public", "boolean", "isMultiValueConstraint", "(", "Class", "<", "?", "extends", "Annotation", ">", "annotationType", "*", "@", "return", "A", "list", "of", "constraint", "annotations", ",", "may", "be", "empty", "but", "never", "{", "@", "code", "null", "}", ".", "*", "/", "public", "<", "A", "extends", "Annotation", ">", "List", "<", "Annotation", ">", "getConstraintsFromMultiValueConstraint", "(", "A", "multiValueConstraint", ")", "{", "Annotation", "[", "]", "annotations", "=", "ReflectionHelper", ".", "getAnnotationParameter", "(", "multiValueConstraint", ",", "\"", "value", "\"", ",", "Annotation", "[", "].", "class", "Annotation", "[", "]", "annotations", "=", "run", "(", "GetAnnotationParameter", ".", "action", "(", "multiValueConstraint", ",", "\"", "value", "\"", ",", "Annotation", "[", "].", "class", ")", ")", ";", "return", "Arrays", ".", "asList", "(", "annotations", ")", ";", "}", "@", "@", "-", "481", ",", "7", "+", "490", ",", "7", "@", "@", "public", "boolean", "isConstraintAnnotation", "(", "Class", "<", "?", "extends", "Annotation", ">", "annotationType", "}", "private", "void", "assertNoParameterStartsWithValid", "(", "Class", "<", "?", "extends", "Annotation", ">", "annotationType", ")", "{", "final", "Method", "[", "]", "methods", "=", "ReflectionHelper", ".", "getDeclaredMethods", "(", "annotationType", ")", ";", "final", "Method", "[", "]", "methods", "=", "run", "(", "GetDeclaredMethods", ".", "action", "(", "annotationType", ")", ")", ";", "for", "(", "Method", "m", ":", "methods", ")", "{", "if", "(", "m", ".", "getName", "(", ").", "startsWith", "(", "\"", "valid", "\"", ")", "&", "&", "!", "m", ".", "getName", "(", ").", "equals", "(", "VALIDATION_APPLIES_TO", ")", ")", "{", "throw", "log", ".", "getConstraintParametersCannotStartWithValidException", "(", ");", "@", "@", "-", "491", ",", "7", "+", "500", ",", "7", "@", "@", "private", "void", "assertNoParameterStartsWithValid", "(", "Class", "<", "?", "extends", "Annotation", ">", "annota", "private", "void", "assertPayloadParameterExists", "(", "Class", "<", "?", "extends", "Annotation", ">", "annotationType", ")", "{", "try", "{", "final", "Method", "method", "=", "ReflectionHelper", ".", "getMethod", "(", "annotationType", ",", "PAYLOAD", ")", ";", "final", "Method", "method", "=", "run", "(", "GetMethod", ".", "action", "(", "annotationType", ",", "PAYLOAD", ")", ")", ";", "if", "(", "method", "=", "=", "null", ")", "{", "throw", "log", ".", "getConstraintWithoutMandatoryParameterException", "(", "PAYLOAD", ",", "annotationType", ".", "getName", "(", ")", ")", ";", "}", "@", "@", "-", "507", ",", "7", "+", "516", ",", "7", "@", "@", "private", "void", "assertPayloadParameterExists", "(", "Class", "<", "?", "extends", "Annotation", ">", "annotation", "private", "void", "assertGroupsParameterExists", "(", "Class", "<", "?", "extends", "Annotation", ">", "annotationType", ")", "{", "try", "{", "final", "Method", "method", "=", "ReflectionHelper", ".", "getMethod", "(", "annotationType", ",", "GROUPS", ")", ";", "final", "Method", "method", "=", "run", "(", "GetMethod", ".", "action", "(", "annotationType", ",", "GROUPS", ")", ")", ";", "if", "(", "method", "=", "=", "null", ")", "{", "throw", "log", ".", "getConstraintWithoutMandatoryParameterException", "(", "GROUPS", ",", "annotationType", ".", "getName", "(", ")", ")", ";", "}", "@", "@", "-", "522", ",", "7", "+", "531", ",", "7", "@", "@", "private", "void", "assertGroupsParameterExists", "(", "Class", "<", "?", "extends", "Annotation", ">", "annotationT", "}", "private", "void", "assertMessageParameterExists", "(", "Class", "<", "?", "extends", "Annotation", ">", "annotationType", ")", "{", "final", "Method", "method", "=", "ReflectionHelper", ".", "getMethod", "(", "annotationType", ",", "MESSAGE", ")", ";", "final", "Method", "method", "=", "run", "(", "GetMethod", ".", "action", "(", "annotationType", ",", "MESSAGE", ")", ")", ";", "if", "(", "method", "=", "=", "null", ")", "{", "throw", "log", ".", "getConstraintWithoutMandatoryParameterException", "(", "MESSAGE", ",", "annotationType", ".", "getName", "(", ")", ")", ";", "}", "@", "@", "-", "540", ",", "7", "+", "549", ",", "7", "@", "@", "private", "void", "assertValidationAppliesToParameterSetUpCorrectly", "(", "Class", "<", "?", "extends", "An", "annotationType", ",", "ValidationTarget", ".", "PARAMETERS", ")", ".", "isEmpty", "(", ");", "final", "Method", "method", "=", "ReflectionHelper", ".", "getMethod", "(", "annotationType", ",", "VALIDATION_APPLIES_TO", ")", ";", "final", "Method", "method", "=", "run", "(", "GetMethod", ".", "action", "(", "annotationType", ",", "VALIDATION_APPLIES_TO", ")", ")", ";", "if", "(", "hasGenericValidators", "&", "&", "hasCrossParameterValidator", ")", "{", "if", "(", "method", "=", "=", "null", ")", "{", "@", "@", "-", "567", ",", "8", "+", "576", ",", "8", "@", "@", "public", "boolean", "isConstraintComposition", "(", "Class", "<", "?", "extends", "Annotation", ">", "annotationTyp", "return", "annotationType", "=", "=", "ConstraintComposition", ".", "class", ";", "}", "private", "boolean", "isJodaTimeInClasspath", "(", ")", "{", "return", "ReflectionHelper", ".", "isClassPresent", "(", "JODA_TIME_CLASS_NAME", ",", "this", ".", "getClass", "(", ")", ")", ";", "private", "static", "boolean", "isJodaTimeInClasspath", "(", ")", "{", "return", "isClassPresent", "(", "JODA_TIME_CLASS_NAME", ")", ";", "}", "/", "**", "@", "@", "-", "593", ",", "6", "+", "602", ",", "26", "@", "@", "private", "boolean", "isJodaTimeInClasspath", "(", ")", "{", "}", "}", "private", "static", "boolean", "isClassPresent", "(", "String", "className", ")", "{", "try", "{", "run", "(", "LoadClass", ".", "action", "(", "className", ",", "ConstraintHelper", ".", "class", ")", ")", ";", "return", "true", ";", "}", "catch", "(", "ValidationException", "e", ")", "{", "return", "false", ";", "}", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "static", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "/", "**", "*", "A", "type", "-", "safe", "wrapper", "around", "a", "concurrent", "map", "from", "constraint", "types", "to", "*", "associated", "validator", "classes", ".", "The", "casts", "are", "safe", "as", "data", "is", "added", "trough", "@", "@", "-", "26", ",", "11", "+", "26", ",", "14", "@", "@", "import", "java", ".", "lang", ".", "reflect", ".", "Field", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Member", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "javax", ".", "validation", ".", "Constraint", ";", "import", "javax", ".", "validation", ".", "ConstraintTarget", ";", "import", "javax", ".", "validation", ".", "ConstraintValidator", ";", "@", "@", "-", "46", ",", "11", "+", "49", ",", "13", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "constraints", ".", "ConstraintComposition", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "core", ".", "ConstraintHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "core", ".", "ConstraintOrigin", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "annotationfactory", ".", "AnnotationDescriptor", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "annotationfactory", ".", "AnnotationFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetAnnotationParameter", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredMethods", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetMethod", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashMap", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashSet", ";", "@", "@", "-", "505", ",", "10", "+", "510", ",", "8", "@", "@", "private", "boolean", "isExecutable", "(", "ElementType", "elementType", ")", "{", "Class", "<", "Payload", ">", "[]", "payloadFromAnnotation", ";", "try", "{", "/", "/", "TODO", "be", "extra", "safe", "and", "make", "sure", "this", "is", "an", "array", "of", "Payload", "payloadFromAnnotation", "=", "ReflectionHelper", ".", "getAnnotationParameter", "(", "annotation", ",", "ConstraintHelper", ".", "PAYLOAD", ",", "Class", "[", "].", "class", "payloadFromAnnotation", "=", "run", "(", "GetAnnotationParameter", ".", "action", "(", "annotation", ",", "ConstraintHelper", ".", "PAYLOAD", ",", "Class", "[", "].", "class", ")", ")", ";", "}", "catch", "(", "ValidationException", "e", ")", "{", "@", "@", "-", "523", ",", "8", "+", "526", ",", "8", "@", "@", "private", "boolean", "isExecutable", "(", "ElementType", "elementType", ")", "{", "private", "Set", "<", "Class", "<", "?>", ">", "buildGroupSet", "(", "Class", "<", "?>", "implicitGroup", ")", "{", "Set", "<", "Class", "<", "?>", ">", "groupSet", "=", "newHashSet", "(", ");", "final", "Class", "<", "?>", "[]", "groupsFromAnnotation", "=", "ReflectionHelper", ".", "getAnnotationParameter", "(", "annotation", ",", "ConstraintHelper", ".", "GROUPS", ",", "Class", "[", "].", "class", "final", "Class", "<", "?>", "[]", "groupsFromAnnotation", "=", "run", "(", "GetAnnotationParameter", ".", "action", "(", "annotation", ",", "ConstraintHelper", ".", "GROUPS", ",", "Class", "[", "].", "class", ")", ")", ";", "if", "(", "groupsFromAnnotation", ".", "length", "=", "=", "0", ")", "{", "groupSet", ".", "add", "(", "Default", ".", "class", ")", ";", "@", "@", "-", "541", ",", "18", "+", "544", ",", "18", "@", "@", "private", "boolean", "isExecutable", "(", "ElementType", "elementType", ")", "{", "}", "private", "Map", "<", "String", ",", "Object", ">", "buildAnnotationParameterMap", "(", "Annotation", "annotation", ")", "{", "final", "Method", "[", "]", "declaredMethods", "=", "ReflectionHelper", ".", "getDeclaredMethods", "(", "annotation", ".", "annotationType", "(", ")", ")", ";", "final", "Method", "[", "]", "declaredMethods", "=", "run", "(", "GetDeclaredMethods", ".", "action", "(", "annotation", ".", "annotationType", "(", ")", ")", ")", ";", "Map", "<", "String", ",", "Object", ">", "parameters", "=", "newHashMap", "(", "declaredMethods", ".", "length", ")", ";", "for", "(", "Method", "m", ":", "declaredMethods", ")", "{", "Object", "value", "=", "ReflectionHelper", ".", "getAnnotationParameter", "(", "annotation", ",", "m", ".", "getName", "(", "),", "Object", ".", "class", ")", ";", "Object", "value", "=", "run", "(", "GetAnnotationParameter", ".", "action", "(", "annotation", ",", "m", ".", "getName", "(", "),", "Object", ".", "class", ")", ")", ";", "parameters", ".", "put", "(", "m", ".", "getName", "(", "),", "value", ")", ";", "}", "return", "Collections", ".", "unmodifiableMap", "(", "parameters", ")", ";", "}", "private", "Map", "<", "ClassIndexWrapper", ",", "Map", "<", "String", ",", "Object", ">", ">", "parseOverrideParameters", "(", ")", "{", "Map", "<", "ClassIndexWrapper", ",", "Map", "<", "String", ",", "Object", ">", ">", "overrideParameters", "=", "newHashMap", "(", ");", "final", "Method", "[", "]", "methods", "=", "ReflectionHelper", ".", "getDeclaredMethods", "(", "annotationType", ")", ";", "final", "Method", "[", "]", "methods", "=", "run", "(", "GetDeclaredMethods", ".", "action", "(", "annotationType", ")", ")", ";", "for", "(", "Method", "m", ":", "methods", ")", "{", "if", "(", "m", ".", "getAnnotation", "(", "OverridesAttribute", ".", "class", ")", "!", "=", "null", ")", "{", "addOverrideAttributes", "(", "@", "@", "-", "571", ",", "7", "+", "574", ",", "7", "@", "@", "else", "if", "(", "m", ".", "getAnnotation", "(", "OverridesAttribute", ".", "List", ".", "class", ")", "!", "=", "null", ")", "{", "}", "private", "void", "addOverrideAttributes", "(", "Map", "<", "ClassIndexWrapper", ",", "Map", "<", "String", ",", "Object", ">", ">", "overrideParameters", ",", "Method", "m", ",", "OverridesAttribute", ".", "..", "attributes", ")", "{", "Object", "value", "=", "ReflectionHelper", ".", "getAnnotationParameter", "(", "annotation", ",", "m", ".", "getName", "(", "),", "Object", ".", "class", ")", ";", "Object", "value", "=", "run", "(", "GetAnnotationParameter", ".", "action", "(", "annotation", ",", "m", ".", "getName", "(", "),", "Object", ".", "class", ")", ")", ";", "for", "(", "OverridesAttribute", "overridesAttribute", ":", "attributes", ")", "{", "ensureAttributeIsOverridable", "(", "m", ",", "overridesAttribute", ")", ";", "@", "@", "-", "588", ",", "7", "+", "591", ",", "7", "@", "@", "private", "void", "addOverrideAttributes", "(", "Map", "<", "ClassIndexWrapper", ",", "Map", "<", "String", ",", "Object", ">", ">", "o", "}", "private", "void", "ensureAttributeIsOverridable", "(", "Method", "m", ",", "OverridesAttribute", "overridesAttribute", ")", "{", "final", "Method", "method", "=", "ReflectionHelper", ".", "getMethod", "(", "overridesAttribute", ".", "constraint", "(", "),", "overridesAttribute", ".", "name", "(", ")", ")", ";", "final", "Method", "method", "=", "run", "(", "GetMethod", ".", "action", "(", "overridesAttribute", ".", "constraint", "(", "),", "overridesAttribute", ".", "name", "(", ")", ")", ")", ";", "if", "(", "method", "=", "=", "null", ")", "{", "throw", "log", ".", "getOverriddenConstraintAttributeNotFoundException", "(", "overridesAttribute", ".", "name", "(", ")", ")", ";", "}", "@", "@", "-", "704", ",", "6", "+", "707", ",", "16", "@", "@", "private", "CompositionType", "parseCompositionType", "(", "ConstraintHelper", "constraintHelper", ")", ")", ";", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "<", "P", ">", "P", "run", "(", "PrivilegedAction", "<", "P", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "/", "**", "*", "@", "return", "the", "compositionType", "*", "/", "@", "@", "-", "23", ",", "6", "+", "23", ",", "8", "@", "@", "import", "java", ".", "lang", ".", "reflect", ".", "Member", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Modifier", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "List", ";", "@", "@", "-", "57", ",", "6", "+", "59", ",", "11", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "classhierarchy", ".", "ClassHierarchyHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredConstructors", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredFields", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredMethods", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetMethods", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "NewInstance", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "spi", ".", "group", ".", "DefaultGroupSequenceProvider", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "valuehandling", ".", "UnwrapValidatedValue", ";", "@", "@", "-", "65", ",", "8", "+", "72", ",", "6", "@", "@", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashSet", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "partition", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ConcurrentReferenceHashMap", ".", "ReferenceType", ".", "SOFT", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ".", "getMethods", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ".", "newInstance", ";", "/", "**", "*", "{", "@", "code", "MetaDataProvider", "}", "which", "reads", "the", "metadata", "from", "annotations", "which", "is", "the", "default", "configuration", "source", ".", "@", "@", "-", "184", ",", "14", "+", "189", ",", "14", "@", "@", "public", "AnnotationProcessingOptions", "getAnnotationProcessingOptions", "(", ")", "{", "private", "<", "T", ">", "DefaultGroupSequenceProvider", "<", "?", "super", "T", ">", "newGroupSequenceProviderClassInstance", "(", "Class", "<", "T", ">", "beanClass", ",", "Class", "<", "?", "extends", "DefaultGroupSequenceProvider", "<", "?", "super", "T", ">", ">", "providerClass", ")", "{", "Method", "[", "]", "providerMethods", "=", "getMethods", "(", "providerClass", ")", ";", "Method", "[", "]", "providerMethods", "=", "run", "(", "GetMethods", ".", "action", "(", "providerClass", ")", ")", ";", "for", "(", "Method", "method", ":", "providerMethods", ")", "{", "Class", "<", "?>", "[]", "paramTypes", "=", "method", ".", "getParameterTypes", "(", ");", "if", "(", "\"", "getValidationGroups", "\"", ".", "equals", "(", "method", ".", "getName", "(", ")", ")", "&", "&", "!", "method", ".", "isBridge", "(", ")", "&", "&", "paramTypes", ".", "length", "=", "=", "1", "&", "&", "paramTypes", "[", "0", "]", ".", "isAssignableFrom", "(", "beanClass", ")", ")", "{", "return", "newInstance", "(", "providerClass", ",", "\"", "the", "default", "group", "sequence", "provider", "\"", "return", "run", "(", "NewInstance", ".", "action", "(", "providerClass", ",", "\"", "the", "default", "group", "sequence", "provider", "\"", ")", ")", ";", "}", "}", "@", "@", "-", "219", ",", "7", "+", "224", ",", "7", "@", "@", "public", "AnnotationProcessingOptions", "getAnnotationProcessingOptions", "(", ")", "{", "private", "Set", "<", "ConstrainedElement", ">", "getFieldMetaData", "(", "Class", "<", "?>", "beanClass", ")", "{", "Set", "<", "ConstrainedElement", ">", "propertyMetaData", "=", "newHashSet", "(", ");", "for", "(", "Field", "field", ":", "ReflectionHelper", ".", "getDeclaredFields", "(", "beanClass", ")", ")", "{", "for", "(", "Field", "field", ":", "run", "(", "GetDeclaredFields", ".", "action", "(", "beanClass", ")", ")", ")", "{", "/", "/", "HV", "-", "172", "if", "(", "Modifier", ".", "isStatic", "(", "field", ".", "getModifiers", "(", ")", ")", "|", "|", "annotationProcessingOptions", ".", "areMemberConstraintsIgnoredFor", "(", "field", ")", "|", "|", "@", "@", "-", "268", ",", "15", "+", "273", ",", "15", "@", "@", "private", "ConstrainedField", "findPropertyMetaData", "(", "Field", "field", ")", "{", "private", "Set", "<", "ConstrainedExecutable", ">", "getConstructorMetaData", "(", "Class", "<", "?>", "clazz", ")", "{", "List", "<", "ExecutableElement", ">", "declaredConstructors", "=", "ExecutableElement", ".", "forConstructors", "(", "ReflectionHelper", ".", "getDeclaredConstructors", "(", "clazz", ")", "run", "(", "GetDeclaredConstructors", ".", "action", "(", "clazz", ")", ")", ")", ";", "return", "getMetaData", "(", "declaredConstructors", ")", ";", "}", "private", "Set", "<", "ConstrainedExecutable", ">", "getMethodMetaData", "(", "Class", "<", "?>", "clazz", ")", "{", "List", "<", "ExecutableElement", ">", "declaredMethods", "=", "ExecutableElement", ".", "forMethods", "(", "ReflectionHelper", ".", "getDeclaredMethods", "(", "clazz", ")", "run", "(", "GetDeclaredMethods", ".", "action", "(", "clazz", ")", ")", ")", ";", "return", "getMetaData", "(", "declaredMethods", ")", ";", "@", "@", "-", "608", ",", "4", "+", "613", ",", "14", "@", "@", "public", "ConstraintType", "getPartition", "(", "ConstraintDescriptorImpl", "<", "?>", "v", ")", "{", "type", ")", ";", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "18", ",", "17", "+", "18", ",", "20", "@", "@", "import", "java", ".", "lang", ".", "reflect", ".", "Constructor", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "javax", ".", "validation", ".", "metadata", ".", "ConstraintDescriptor", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "core", ".", "MetaConstraint", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "location", ".", "ConstraintLocation", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "SetAccessibility", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newArrayList", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashMap", ";", "@", "@", "-", "142", ",", "7", "+", "145", ",", "7", "@", "@", "public", "ConstrainedExecutable", "(", "this", ".", "hasParameterConstraints", "=", "hasParameterConstraints", "(", "parameterMetaData", ")", "|", "|", "!", "crossParameterConstraints", ".", "isEmpty", "(", ");", "if", "(", "isConstrained", "(", ")", ")", "{", "ReflectionHelper", ".", "setAccessibility", "(", "location", ".", "getMember", "(", ")", ")", ";", "run", "(", "SetAccessibility", ".", "action", "(", "location", ".", "getMember", "(", ")", ")", ")", ";", "}", "}", "@", "@", "-", "350", ",", "4", "+", "353", ",", "8", "@", "@", "else", "if", "(", "!", "executable", ".", "equals", "(", "other", ".", "executable", ")", ")", "{", "}", "return", "true", ";", "}", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "17", ",", "12", "+", "17", ",", "14", "@", "@", "package", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Member", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "core", ".", "MetaConstraint", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "location", ".", "ConstraintLocation", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "SetAccessibility", ";", "/", "**", "*", "Represents", "a", "field", "of", "a", "Java", "type", "and", "all", "its", "associated", "meta", "-", "data", "relevant", "@", "@", "-", "54", ",", "7", "+", "56", ",", "7", "@", "@", "public", "ConstrainedField", "(", "ConfigurationSource", "source", ",", "Member", "member", "=", "location", ".", "getMember", "(", ");", "if", "(", "member", "!", "=", "null", "&", "&", "isConstrained", "(", ")", ")", "{", "ReflectionHelper", ".", "setAccessibility", "(", "member", ")", ";", "run", "(", "SetAccessibility", ".", "action", "(", "member", ")", ")", ";", "}", "}", "@", "@", "-", "88", ",", "4", "+", "90", ",", "8", "@", "@", "else", "if", "(", "!", "getLocation", "(", ").", "getMember", "(", ").", "equals", "(", "other", ".", "getLocation", "(", ").", "getMember", "(", ")", ")", ")", "}", "return", "true", ";", "}", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "16", ",", "8", "+", "16", ",", "6", "@", "@", "*", "/", "package", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ";", "import", "java", ".", "lang", ".", "annotation", ".", "Annotation", ";", "import", "java", ".", "lang", ".", "annotation", ".", "ElementType", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Constructor", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Field", ";", "import", "java", ".", "lang", ".", "reflect", ".", "InvocationTargetException", ";", "@", "@", "-", "27", ",", "37", "+", "25", ",", "17", "@", "@", "import", "java", ".", "lang", ".", "reflect", ".", "Type", ";", "import", "java", ".", "lang", ".", "reflect", ".", "TypeVariable", ";", "import", "java", ".", "lang", ".", "reflect", ".", "WildcardType", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "javax", ".", "validation", ".", "ValidationException", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ".", "ExecutableElement", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "ConstructorInstance", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetAnnotationParameter", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetClassLoader", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredConstructor", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredConstructors", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredField", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredFields", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredMethod", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredMethods", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetMethod", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetMethodFromPropertyName", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetMethods", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "LoadClass", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "NewInstance", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "SetAccessibility", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashMap", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Messages", ".", "MESSAGES", ";", "/", "**", "*", "Some", "reflection", "utility", "methods", ".", "Where", "necessary", "calls", "will", "be", "performed", "as", "{", "@", "code", "PrivilegedAction", "}", "which", "is", "necessary", "@", "@", "-", "69", ",", "39", "+", "47", ",", "17", "@", "@", "*", "/", "public", "final", "class", "ReflectionHelper", "{", "private", "static", "final", "String", "PACKAGE_SEPARATOR", "=", "\"", ".\"", ";", "private", "static", "final", "String", "ARRAY_CLASS_NAME_PREFIX", "=", "\"", "[", "L", "\"", ";", "private", "static", "final", "String", "ARRAY_CLASS_NAME_SUFFIX", "=", "\"", ";\"", ";", "private", "static", "final", "String", "PROPERTY_ACCESSOR_PREFIX_GET", "=", "\"", "get", "\"", ";", "private", "static", "final", "String", "PROPERTY_ACCESSOR_PREFIX_IS", "=", "\"", "is", "\"", ";", "private", "static", "final", "String", "PROPERTY_ACCESSOR_PREFIX_HAS", "=", "\"", "has", "\"", ";", "private", "static", "final", "String", "[", "]", "PROPERTY_ACCESSOR_PREFIXES", "=", "{", "public", "static", "final", "String", "[", "]", "PROPERTY_ACCESSOR_PREFIXES", "=", "{", "PROPERTY_ACCESSOR_PREFIX_GET", ",", "PROPERTY_ACCESSOR_PREFIX_IS", ",", "PROPERTY_ACCESSOR_PREFIX_HAS", "}", ";", "private", "static", "final", "Log", "log", "=", "LoggerFactory", ".", "make", "(", ");", "private", "static", "final", "Map", "<", "String", ",", "Class", "<", "?>", ">", "PRIMITIVE_NAME_TO_PRIMITIVE", ";", "static", "{", "Map", "<", "String", ",", "Class", "<", "?>", ">", "tmpMap", "=", "newHashMap", "(", "9", ")", ";", "tmpMap", ".", "put", "(", "boolean", ".", "class", ".", "getName", "(", "),", "boolean", ".", "class", ")", ";", "tmpMap", ".", "put", "(", "char", ".", "class", ".", "getName", "(", "),", "char", ".", "class", ")", ";", "tmpMap", ".", "put", "(", "double", ".", "class", ".", "getName", "(", "),", "double", ".", "class", ")", ";", "tmpMap", ".", "put", "(", "float", ".", "class", ".", "getName", "(", "),", "float", ".", "class", ")", ";", "tmpMap", ".", "put", "(", "long", ".", "class", ".", "getName", "(", "),", "long", ".", "class", ")", ";", "tmpMap", ".", "put", "(", "int", ".", "class", ".", "getName", "(", "),", "int", ".", "class", ")", ";", "tmpMap", ".", "put", "(", "short", ".", "class", ".", "getName", "(", "),", "short", ".", "class", ")", ";", "tmpMap", ".", "put", "(", "byte", ".", "class", ".", "getName", "(", "),", "byte", ".", "class", ")", ";", "tmpMap", ".", "put", "(", "Void", ".", "TYPE", ".", "getName", "(", "),", "Void", ".", "TYPE", ")", ";", "PRIMITIVE_NAME_TO_PRIMITIVE", "=", "Collections", ".", "unmodifiableMap", "(", "tmpMap", ")", ";", "}", "private", "static", "final", "Map", "<", "Class", "<", "?>", ",", "Class", "<", "?>", ">", "PRIMITIVE_TO_WRAPPER_TYPES", ";", "static", "{", "@", "@", "-", "144", ",", "84", "+", "100", ",", "6", "@", "@", "private", "ReflectionHelper", "(", ")", "{", "}", "public", "static", "ClassLoader", "getClassLoaderFromContext", "(", ")", "{", "return", "run", "(", "GetClassLoader", ".", "fromContext", "(", ")", ")", ";", "}", "public", "static", "ClassLoader", "getClassLoaderFromClass", "(", "Class", "<", "?>", "clazz", ")", "{", "return", "run", "(", "GetClassLoader", ".", "fromClass", "(", "clazz", ")", ")", ";", "}", "public", "static", "Class", "<", "?>", "loadClass", "(", "String", "className", ",", "Class", "<", "?>", "caller", ")", "{", "return", "run", "(", "LoadClass", ".", "action", "(", "className", ",", "caller", ")", ")", ";", "}", "public", "static", "Class", "<", "?>", "loadClass", "(", "String", "className", ",", "String", "defaultPackage", ")", "{", "return", "loadClass", "(", "className", ",", "defaultPackage", ",", "ReflectionHelper", ".", "class", ")", ";", "}", "public", "static", "boolean", "isClassPresent", "(", "String", "className", ",", "Class", "<", "?>", "caller", ")", "{", "try", "{", "ReflectionHelper", ".", "loadClass", "(", "className", ",", "caller", ")", ";", "return", "true", ";", "}", "catch", "(", "ValidationException", "e", ")", "{", "return", "false", ";", "}", "}", "public", "static", "Class", "<", "?>", "loadClass", "(", "String", "className", ",", "String", "defaultPackage", ",", "Class", "<", "?>", "caller", ")", "{", "if", "(", "PRIMITIVE_NAME_TO_PRIMITIVE", ".", "containsKey", "(", "className", ")", ")", "{", "return", "PRIMITIVE_NAME_TO_PRIMITIVE", ".", "get", "(", "className", ")", ";", "}", "StringBuilder", "fullyQualifiedClass", "=", "new", "StringBuilder", "(", ");", "String", "tmpClassName", "=", "className", ";", "if", "(", "isArrayClassName", "(", "className", ")", ")", "{", "fullyQualifiedClass", ".", "append", "(", "ARRAY_CLASS_NAME_PREFIX", ")", ";", "tmpClassName", "=", "getArrayElementClassName", "(", "className", ")", ";", "}", "if", "(", "isQualifiedClass", "(", "tmpClassName", ")", ")", "{", "fullyQualifiedClass", ".", "append", "(", "tmpClassName", ")", ";", "}", "else", "{", "fullyQualifiedClass", ".", "append", "(", "defaultPackage", ")", ";", "fullyQualifiedClass", ".", "append", "(", "PACKAGE_SEPARATOR", ")", ";", "fullyQualifiedClass", ".", "append", "(", "tmpClassName", ")", ";", "}", "if", "(", "isArrayClassName", "(", "className", ")", ")", "{", "fullyQualifiedClass", ".", "append", "(", "ARRAY_CLASS_NAME_SUFFIX", ")", ";", "}", "return", "loadClass", "(", "fullyQualifiedClass", ".", "toString", "(", "),", "caller", ")", ";", "}", "private", "static", "boolean", "isArrayClassName", "(", "String", "className", ")", "{", "return", "className", ".", "startsWith", "(", "ARRAY_CLASS_NAME_PREFIX", ")", "&", "&", "className", ".", "endsWith", "(", "ARRAY_CLASS_NAME_SUFFIX", ")", ";", "}", "private", "static", "String", "getArrayElementClassName", "(", "String", "className", ")", "{", "return", "className", ".", "substring", "(", "2", ",", "className", ".", "length", "(", ")", "-", "1", ")", ";", "}", "private", "static", "boolean", "isQualifiedClass", "(", "String", "clazz", ")", "{", "return", "clazz", ".", "contains", "(", "PACKAGE_SEPARATOR", ")", ";", "}", "public", "static", "<", "T", ">", "T", "newInstance", "(", "Class", "<", "T", ">", "clazz", ",", "String", "message", ")", "{", "return", "run", "(", "NewInstance", ".", "action", "(", "clazz", ",", "message", ")", ")", ";", "}", "public", "static", "<", "T", ">", "T", "newConstructorInstance", "(", "Constructor", "<", "T", ">", "constructor", ",", "Object", ".", "..", "initArgs", ")", "{", "return", "run", "(", "ConstructorInstance", ".", "action", "(", "constructor", ",", "initArgs", ")", ")", ";", "}", "public", "static", "<", "T", ">", "T", "getAnnotationParameter", "(", "Annotation", "annotation", ",", "String", "parameterName", ",", "Class", "<", "T", ">", "type", ")", "{", "return", "run", "(", "GetAnnotationParameter", ".", "action", "(", "annotation", ",", "parameterName", ",", "type", ")", ")", ";", "}", "/", "**", "*", "Returns", "the", "JavaBeans", "property", "name", "of", "the", "given", "member", ".", "*", "<", "p", ">", "@", "@", "-", "301", ",", "42", "+", "179", ",", "6", "@", "@", "else", "if", "(", "methodName", ".", "startsWith", "(", "PROPERTY_ACCESSOR_PREFIX_HAS", ")", "&", "&", "method", ".", "getRet", "return", "false", ";", "}", "/", "**", "*", "Returns", "the", "member", "with", "the", "given", "name", "and", "type", ".", "*", "*", "@", "param", "clazz", "The", "class", "from", "which", "to", "retrieve", "the", "member", ".", "Cannot", "be", "{", "@", "code", "null", "}", ".", "*", "@", "param", "property", "The", "property", "name", "without", "\"", "is", "\"", ",", "\"", "get", "\"", "or", "\"", "has", "\"", ".", "Cannot", "be", "{", "@", "code", "null", "}", "or", "empty", ".", "*", "@", "param", "elementType", "The", "element", "type", ".", "Either", "{", "@", "code", "ElementType", ".", "FIELD", "}", "or", "{", "@", "code", "ElementType", "METHOD", "}", ".", "*", "*", "@", "return", "the", "member", "which", "matching", "the", "name", "and", "type", "or", "{", "@", "code", "null", "}", "if", "no", "such", "member", "exists", ".", "*", "/", "public", "static", "Member", "getMember", "(", "Class", "<", "?>", "clazz", ",", "String", "property", ",", "ElementType", "elementType", ")", "{", "Contracts", ".", "assertNotNull", "(", "clazz", ",", "MESSAGES", ".", "classCannotBeNull", "(", ")", ")", ";", "if", "(", "property", "=", "=", "null", "|", "|", "property", ".", "length", "(", ")", "=", "=", "0", ")", "{", "throw", "log", ".", "getPropertyNameCannotBeNullOrEmptyException", "(", ");", "}", "if", "(", "!", "(", "ElementType", ".", "FIELD", ".", "equals", "(", "elementType", ")", "|", "|", "ElementType", ".", "METHOD", ".", "equals", "(", "elementType", ")", ")", ")", "{", "throw", "log", ".", "getElementTypeHasToBeFieldOrMethodException", "(", ");", "}", "Member", "member", "=", "null", ";", "if", "(", "ElementType", ".", "FIELD", ".", "equals", "(", "elementType", ")", ")", "{", "member", "=", "run", "(", "GetDeclaredField", ".", "action", "(", "clazz", ",", "property", ")", ")", ";", "}", "else", "{", "String", "methodName", "=", "property", ".", "substring", "(", "0", ",", "1", ")", ".", "toUpperCase", "(", ")", "+", "property", ".", "substring", "(", "1", ")", ";", "for", "(", "String", "prefix", ":", "PROPERTY_ACCESSOR_PREFIXES", ")", "{", "member", "=", "run", "(", "GetMethod", ".", "action", "(", "clazz", ",", "prefix", "+", "methodName", ")", ")", ";", "if", "(", "member", "!", "=", "null", ")", "{", "break", ";", "}", "}", "}", "return", "member", ";", "}", "/", "**", "*", "@", "param", "member", "The", "<", "code", ">", "Member", "<", "/", "code", ">", "instance", "for", "which", "to", "retrieve", "the", "type", ".", "*", "@", "@", "-", "420", ",", "10", "+", "262", ",", "6", "@", "@", "public", "static", "Object", "getValue", "(", "Method", "method", ",", "Object", "object", ")", "{", "}", "}", "public", "static", "void", "setAccessibility", "(", "Member", "member", ")", "{", "run", "(", "SetAccessibility", ".", "action", "(", "member", ")", ")", ";", "}", "/", "**", "*", "Determines", "the", "type", "of", "elements", "of", "an", "<", "code", ">", "Iterable", "<", "/", "code", ">", ",", "array", "or", "the", "value", "of", "a", "<", "code", ">", "Map", "<", "/", "code", ">", ".", "*", "@", "@", "-", "565", ",", "128", "+", "403", ",", "6", "@", "@", "public", "static", "Object", "getMappedValue", "(", "Object", "value", ",", "Object", "key", ")", "{", "return", "map", ".", "get", "(", "key", ")", ";", "}", "/", "**", "*", "Returns", "the", "declared", "field", "with", "the", "specified", "name", "or", "{", "@", "code", "null", "}", "if", "it", "does", "not", "exist", ".", "*", "*", "@", "param", "clazz", "The", "class", "to", "check", ".", "*", "@", "param", "fieldName", "The", "field", "name", ".", "*", "*", "@", "return", "Returns", "the", "declared", "field", "with", "the", "specified", "name", "or", "{", "@", "code", "null", "}", "if", "it", "does", "not", "exist", ".", "*", "/", "public", "static", "Field", "getDeclaredField", "(", "Class", "<", "?>", "clazz", ",", "String", "fieldName", ")", "{", "return", "run", "(", "GetDeclaredField", ".", "action", "(", "clazz", ",", "fieldName", ")", ")", ";", "}", "/", "**", "*", "Returns", "the", "fields", "of", "the", "specified", "class", ".", "*", "*", "@", "param", "clazz", "The", "class", "for", "which", "to", "retrieve", "the", "fields", ".", "*", "*", "@", "return", "Returns", "the", "fields", "for", "this", "class", ".", "*", "/", "public", "static", "Field", "[", "]", "getDeclaredFields", "(", "Class", "<", "?>", "clazz", ")", "{", "return", "run", "(", "GetDeclaredFields", ".", "action", "(", "clazz", ")", ")", ";", "}", "/", "**", "*", "Returns", "the", "method", "with", "the", "specified", "property", "name", "or", "{", "@", "code", "null", "}", "if", "it", "does", "not", "exist", ".", "This", "method", "will", "*", "prepend", "'", "is", "'", "and", "'", "get", "'", "to", "the", "property", "name", "and", "capitalize", "the", "first", "letter", ".", "*", "*", "@", "param", "clazz", "The", "class", "to", "check", ".", "*", "@", "param", "methodName", "The", "property", "name", ".", "*", "*", "@", "return", "Returns", "the", "method", "with", "the", "specified", "property", "or", "{", "@", "code", "null", "}", "if", "it", "does", "not", "exist", ".", "*", "/", "public", "static", "Method", "getMethodFromPropertyName", "(", "Class", "<", "?>", "clazz", ",", "String", "methodName", ")", "{", "return", "run", "(", "GetMethodFromPropertyName", ".", "action", "(", "clazz", ",", "methodName", ")", ")", ";", "}", "/", "**", "*", "Returns", "the", "method", "with", "the", "specified", "name", "or", "{", "@", "code", "null", "}", "if", "it", "does", "not", "exist", ".", "*", "*", "@", "param", "clazz", "The", "class", "to", "check", ".", "*", "@", "param", "methodName", "The", "method", "name", ".", "*", "*", "@", "return", "Returns", "the", "method", "with", "the", "specified", "property", "or", "{", "@", "code", "null", "}", "if", "it", "does", "not", "exist", ".", "*", "/", "public", "static", "Method", "getMethod", "(", "Class", "<", "?>", "clazz", ",", "String", "methodName", ")", "{", "return", "run", "(", "GetMethod", ".", "action", "(", "clazz", ",", "methodName", ")", ")", ";", "}", "/", "**", "*", "Returns", "the", "declared", "method", "with", "the", "specified", "name", "and", "parameter", "types", "or", "{", "@", "code", "null", "}", "if", "*", "it", "does", "not", "exist", ".", "*", "*", "@", "param", "clazz", "The", "class", "to", "check", ".", "*", "@", "param", "methodName", "The", "method", "name", ".", "*", "@", "param", "parameterTypes", "The", "method", "parameter", "types", ".", "*", "*", "@", "return", "Returns", "the", "declared", "method", "with", "the", "specified", "name", "or", "{", "@", "code", "null", "}", "if", "it", "does", "not", "exist", ".", "*", "/", "public", "static", "Method", "getDeclaredMethod", "(", "Class", "<", "?>", "clazz", ",", "String", "methodName", ",", "Class", "<", "?>", "..", ".", "parameterTypes", ")", "{", "return", "run", "(", "GetDeclaredMethod", ".", "action", "(", "clazz", ",", "methodName", ",", "parameterTypes", ")", ")", ";", "}", "/", "**", "*", "Returns", "the", "declared", "methods", "of", "the", "specified", "class", ".", "*", "*", "@", "param", "clazz", "The", "class", "for", "which", "to", "retrieve", "the", "methods", ".", "*", "*", "@", "return", "Returns", "the", "declared", "methods", "for", "this", "class", ".", "*", "/", "public", "static", "Method", "[", "]", "getDeclaredMethods", "(", "Class", "<", "?>", "clazz", ")", "{", "return", "run", "(", "GetDeclaredMethods", ".", "action", "(", "clazz", ")", ")", ";", "}", "/", "**", "*", "Returns", "the", "methods", "of", "the", "specified", "class", "(", "include", "inherited", "methods", ")", ".", "*", "*", "@", "param", "clazz", "The", "class", "for", "which", "to", "retrieve", "the", "methods", ".", "*", "*", "@", "return", "Returns", "the", "methods", "for", "this", "class", ".", "*", "/", "public", "static", "Method", "[", "]", "getMethods", "(", "Class", "<", "?>", "clazz", ")", "{", "return", "run", "(", "GetMethods", ".", "action", "(", "clazz", ")", ")", ";", "}", "/", "**", "*", "Returns", "the", "declared", "constructors", "of", "the", "specified", "class", ".", "*", "*", "@", "param", "clazz", "The", "class", "for", "which", "to", "retrieve", "the", "constructors", ".", "*", "*", "@", "return", "Returns", "the", "declared", "constructors", "for", "this", "class", ".", "*", "/", "public", "static", "Constructor", "<", "?>", "[]", "getDeclaredConstructors", "(", "Class", "<", "?>", "clazz", ")", "{", "return", "run", "(", "GetDeclaredConstructors", ".", "action", "(", "clazz", ")", ")", ";", "}", "/", "**", "*", "Returns", "the", "declared", "constructor", "with", "the", "specified", "parameter", "types", "or", "{", "@", "code", "null", "}", "if", "*", "it", "does", "not", "exist", ".", "*", "*", "@", "param", "clazz", "The", "class", "to", "check", ".", "*", "@", "param", "params", "The", "constructor", "parameter", "types", ".", "*", "@", "param", "<", "T", ">", "The", "type", "of", "class", "to", "get", "the", "constructor", "for", ".", "*", "*", "@", "return", "Returns", "the", "declared", "constructor", "with", "the", "specified", "name", "or", "{", "@", "code", "null", "}", "if", "it", "does", "not", "exist", ".", "*", "/", "public", "static", "<", "T", ">", "Constructor", "<", "T", ">", "getDeclaredConstructor", "(", "Class", "<", "T", ">", "clazz", ",", "Class", "<", "?>", "..", ".", "params", ")", "{", "return", "run", "(", "GetDeclaredConstructor", ".", "action", "(", "clazz", ",", "params", ")", ")", ";", "}", "/", "**", "*", "Executes", "the", "given", "privileged", "action", "either", "directly", "or", "with", "privileges", "*", "enabled", ",", "depending", "on", "whether", "a", "security", "manager", "is", "around", "or", "not", ".", "*", "*", "@", "param", "<", "T", ">", "The", "return", "type", "of", "the", "privileged", "action", "to", "run", ".", "*", "@", "param", "action", "The", "action", "to", "run", ".", "*", "*", "@", "return", "The", "result", "of", "the", "privileged", "action", "'", "s", "execution", ".", "*", "/", "private", "static", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "/", "**", "*", "Returns", "the", "auto", "-", "boxed", "type", "of", "a", "primitive", "type", ".", "*", "@", "@", "-", "9", ",", "7", "+", "9", ",", "7", "@", "@", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "@", "@", "-", "18", ",", "9", "+", "18", ",", "12", "@", "@", "import", "java", ".", "io", ".", "BufferedInputStream", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetClassLoader", ";", "/", "**", "*", "Helper", "methods", "for", "loading", "resource", "files", "@", "@", "-", "50", ",", "18", "+", "53", ",", "18", "@", "@", "public", "static", "InputStream", "getResettableInputStreamForPath", "(", "String", "path", ")", "{", "boolean", "isContextCL", "=", "true", ";", "/", "/", "try", "the", "context", "class", "loader", "first", "ClassLoader", "loader", "=", "ReflectionHelper", ".", "getClassLoaderFromContext", "(", ");", "ClassLoader", "loader", "=", "run", "(", "GetClassLoader", ".", "fromContext", "(", ")", ")", ";", "if", "(", "loader", "=", "=", "null", ")", "{", "log", ".", "debug", "(", "\"", "No", "default", "context", "class", "loader", ",", "fall", "back", "to", "Bean", "Validation", "'", "s", "loader", "\"", ")", ";", "loader", "=", "ReflectionHelper", ".", "getClassLoaderFromClass", "(", "ResourceLoaderHelper", ".", "class", ")", ";", "loader", "=", "run", "(", "GetClassLoader", ".", "fromClass", "(", "ResourceLoaderHelper", ".", "class", ")", ")", ";", "isContextCL", "=", "false", ";", "}", "InputStream", "inputStream", "=", "loader", ".", "getResourceAsStream", "(", "inputPath", ")", ";", "/", "/", "try", "the", "current", "class", "loader", "if", "(", "isContextCL", "&", "&", "inputStream", "=", "=", "null", ")", "{", "loader", "=", "ReflectionHelper", ".", "getClassLoaderFromClass", "(", "ResourceLoaderHelper", ".", "class", ")", ";", "loader", "=", "run", "(", "GetClassLoader", ".", "fromClass", "(", "ResourceLoaderHelper", ".", "class", ")", ")", ";", "inputStream", "=", "loader", ".", "getResourceAsStream", "(", "inputPath", ")", ";", "}", "@", "@", "-", "75", ",", "4", "+", "78", ",", "14", "@", "@", "else", "if", "(", "inputStream", ".", "markSupported", "(", ")", ")", "{", "return", "new", "BufferedInputStream", "(", "inputStream", ")", ";", "}", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "static", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "21", ",", "8", "+", "21", ",", "12", "@", "@", "import", "java", ".", "lang", ".", "reflect", ".", "InvocationHandler", ";", "import", "java", ".", "lang", ".", "reflect", ".", "InvocationTargetException", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Proxy", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "ConstructorInstance", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetClassLoader", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredConstructor", ";", "/", "**", "*", "Creates", "live", "annotations", "(", "actually", "{", "@", "link", "AnnotationProxy", "}", "instances", ")", "from", "{", "@", "code", "AnnotationDescriptor", "}", "s", ".", "@", "@", "-", "37", ",", "7", "+", "41", ",", "7", "@", "@", "public", "static", "<", "T", "extends", "Annotation", ">", "T", "create", "(", "AnnotationDescriptor", "<", "T", ">", "descriptor", ")", "{", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Class", "<", "T", ">", "proxyClass", "=", "(", "Class", "<", "T", ">", ")", "Proxy", ".", "getProxyClass", "(", "ReflectionHelper", ".", "getClassLoaderFromClass", "(", "descriptor", ".", "type", "(", ")", ")", ",", "run", "(", "GetClassLoader", ".", "fromClass", "(", "descriptor", ".", "type", "(", ")", ")", ")", ",", "descriptor", ".", "type", "(", ")", ")", ";", "InvocationHandler", "handler", "=", "new", "AnnotationProxy", "(", "descriptor", ")", ";", "@", "@", "-", "55", ",", "10", "+", "59", ",", "20", "@", "@", "private", "static", "<", "T", "extends", "Annotation", ">", "T", "getProxyInstance", "(", "Class", "<", "T", ">", "proxyClass", ",", "InvocationHandler", "handler", ")", "throws", "SecurityException", ",", "NoSuchMethodException", ",", "IllegalArgumentException", ",", "InstantiationException", ",", "IllegalAccessException", ",", "InvocationTargetException", "{", "final", "Constructor", "<", "T", ">", "constructor", "=", "ReflectionHelper", ".", "getDeclaredConstructor", "(", "final", "Constructor", "<", "T", ">", "constructor", "=", "run", "(", "GetDeclaredConstructor", ".", "action", "(", "proxyClass", ",", "InvocationHandler", ".", "class", ")", ";", "return", "ReflectionHelper", ".", "newConstructorInstance", "(", "constructor", ",", "handler", ")", ";", ")", ")", ";", "return", "run", "(", "ConstructorInstance", ".", "action", "(", "constructor", ",", "handler", ")", ")", ";", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "static", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "21", ",", "6", "+", "21", ",", "8", "@", "@", "import", "java", ".", "lang", ".", "reflect", ".", "InvocationHandler", ";", "import", "java", ".", "lang", ".", "reflect", ".", "InvocationTargetException", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Map", ";", "@", "@", "-", "29", ",", "9", "+", "31", ",", "10", "@", "@", "import", "java", ".", "util", ".", "SortedSet", ";", "import", "java", ".", "util", ".", "TreeSet", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredMethod", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredMethods", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashMap", ";", "@", "@", "-", "154", ",", "7", "+", "157", ",", "7", "@", "@", "public", "String", "toString", "(", ")", "{", "private", "Map", "<", "String", ",", "Object", ">", "getAnnotationValues", "(", "AnnotationDescriptor", "<", "?>", "descriptor", ")", "{", "Map", "<", "String", ",", "Object", ">", "result", "=", "newHashMap", "(", ");", "int", "processedValuesFromDescriptor", "=", "0", ";", "final", "Method", "[", "]", "declaredMethods", "=", "ReflectionHelper", ".", "getDeclaredMethods", "(", "annotationType", ")", ";", "final", "Method", "[", "]", "declaredMethods", "=", "run", "(", "GetDeclaredMethods", ".", "action", "(", "annotationType", ")", ")", ";", "for", "(", "Method", "m", ":", "declaredMethods", ")", "{", "if", "(", "descriptor", ".", "containsElement", "(", "m", ".", "getName", "(", ")", ")", ")", "{", "result", ".", "put", "(", "m", ".", "getName", "(", "),", "descriptor", ".", "valueOf", "(", "m", ".", "getName", "(", ")", ")", ")", ";", "@", "@", "-", "252", ",", "8", "+", "255", ",", "7", "@", "@", "private", "boolean", "areEqual", "(", "Object", "o1", ",", "Object", "o2", ")", "{", "private", "Object", "getAnnotationMemberValue", "(", "Annotation", "annotation", ",", "String", "name", ")", "{", "try", "{", "return", "ReflectionHelper", ".", "getDeclaredMethod", "(", "annotation", ".", "annotationType", "(", "),", "name", ")", ".", "invoke", "(", "annotation", ")", ";", "return", "run", "(", "GetDeclaredMethod", ".", "action", "(", "annotation", ".", "annotationType", "(", "),", "name", ")", ")", ".", "invoke", "(", "annotation", ")", ";", "}", "catch", "(", "IllegalAccessException", "e", ")", "{", "throw", "log", ".", "getUnableToRetrieveAnnotationParameterValueException", "(", "e", ")", ";", "@", "@", "-", "265", ",", "4", "+", "267", ",", "14", "@", "@", "private", "Object", "getAnnotationMemberValue", "(", "Annotation", "annotation", ",", "String", "name", ")", "{", "throw", "log", ".", "getUnableToRetrieveAnnotationParameterValueException", "(", "e", ")", ";", "}", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "16", ",", "14", "+", "16", ",", "11", "@", "@", "*", "/", "package", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "classhierarchy", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "Contracts", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newArrayList", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashSet", ";", "@", "@", "-", "130", ",", "26", "+", "127", ",", "4", "@", "@", "private", "static", "boolean", "acceptedByAllFilters", "(", "Class", "<", "?>", "clazz", ",", "Iterable", "<", "Filter", ">", "fil", "getImplementedInterfaces", "(", "currentInterfaceCasted", ",", "classes", ")", ";", "}", "}", "/", "**", "*", "Get", "a", "list", "of", "all", "methods", "wich", "the", "given", "class", "declares", ",", "implements", ",", "*", "overrides", "or", "inherits", ".", "Methods", "are", "added", "by", "adding", "first", "all", "methods", "of", "*", "the", "class", "itself", "and", "its", "implemented", "interfaces", ",", "then", "the", "super", "class", "and", "*", "its", "interfaces", ",", "etc", ".", "*", "*", "@", "param", "clazz", "the", "class", "for", "which", "to", "retrieve", "the", "methods", "*", "*", "@", "return", "set", "of", "all", "methods", "of", "the", "given", "class", "*", "/", "public", "static", "List", "<", "Method", ">", "getAllMethods", "(", "Class", "<", "?>", "clazz", ")", "{", "Contracts", ".", "assertNotNull", "(", "clazz", ")", ";", "List", "<", "Method", ">", "methods", "=", "newArrayList", "(", ");", "for", "(", "Class", "<", "?>", "hierarchyClass", ":", "getHierarchy", "(", "clazz", ")", ")", "{", "Collections", ".", "addAll", "(", "methods", ",", "ReflectionHelper", ".", "getMethods", "(", "hierarchyClass", ")", ")", ";", "}", "return", "methods", ";", "}", "}", "@", "@", "-", "20", ",", "6", "+", "20", ",", "8", "@", "@", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "/", "**", "*", "Returns", "the", "declared", "constructor", "with", "the", "specified", "parameter", "types", "or", "{", "@", "code", "null", "}", "if", "it", "does", "not", "exist", ".", "*", "*", "@", "author", "Emmanuel", "Bernard", "*", "/", "public", "final", "class", "GetDeclaredConstructor", "<", "T", ">", "implements", "PrivilegedAction", "<", "Constructor", "<", "T", ">", ">", "{", "@", "@", "-", "35", ",", "6", "+", "37", ",", "7", "@", "@", "private", "GetDeclaredConstructor", "(", "Class", "<", "T", ">", "clazz", ",", "Class", "<", "?>", "..", ".", "params", ")", "{", "this", ".", "params", "=", "params", ";", "}", "@", "Override", "public", "Constructor", "<", "T", ">", "run", "(", ")", "{", "try", "{", "return", "clazz", ".", "getDeclaredConstructor", "(", "params", ")", ";", "@", "@", "-", "20", ",", "6", "+", "20", ",", "8", "@", "@", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "/", "**", "*", "Returns", "the", "declared", "constructors", "of", "the", "specified", "class", ".", "*", "*", "@", "author", "Gunnar", "Morling", "*", "/", "public", "final", "class", "GetDeclaredConstructors", "implements", "PrivilegedAction", "<", "Constructor", "<", "?>", "[]", ">", "{", "@", "@", "-", "33", ",", "6", "+", "35", ",", "7", "@", "@", "private", "GetDeclaredConstructors", "(", "Class", "<", "?>", "clazz", ")", "{", "this", ".", "clazz", "=", "clazz", ";", "}", "@", "Override", "public", "Constructor", "<", "?>", "[]", "run", "(", ")", "{", "return", "clazz", ".", "getDeclaredConstructors", "(", ");", "}", "@", "@", "-", "20", ",", "6", "+", "20", ",", "8", "@", "@", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "/", "**", "*", "Returns", "the", "declared", "field", "with", "the", "specified", "name", "or", "{", "@", "code", "null", "}", "if", "it", "does", "not", "exist", ".", "*", "*", "@", "author", "Emmanuel", "Bernard", "*", "/", "public", "final", "class", "GetDeclaredField", "implements", "PrivilegedAction", "<", "Field", ">", "{", "@", "@", "-", "35", ",", "6", "+", "37", ",", "7", "@", "@", "private", "GetDeclaredField", "(", "Class", "<", "?>", "clazz", ",", "String", "fieldName", ")", "{", "this", ".", "fieldName", "=", "fieldName", ";", "}", "@", "Override", "public", "Field", "run", "(", ")", "{", "try", "{", "final", "Field", "field", "=", "clazz", ".", "getDeclaredField", "(", "fieldName", ")", ";", "@", "@", "-", "20", ",", "6", "+", "20", ",", "8", "@", "@", "import", "java", ".", "lang", ".", "reflect", ".", "Field", ";", "/", "**", "*", "Returns", "the", "fields", "of", "the", "specified", "class", ".", "*", "*", "@", "author", "Emmanuel", "Bernard", "*", "/", "public", "final", "class", "GetDeclaredFields", "implements", "PrivilegedAction", "<", "Field", "[", "]>", "{", "@", "@", "-", "33", ",", "6", "+", "35", ",", "7", "@", "@", "private", "GetDeclaredFields", "(", "Class", "<", "?>", "clazz", ")", "{", "this", ".", "clazz", "=", "clazz", ";", "}", "@", "Override", "public", "Field", "[", "]", "run", "(", ")", "{", "return", "clazz", ".", "getDeclaredFields", "(", ");", "}", "@", "@", "-", "20", ",", "6", "+", "20", ",", "8", "@", "@", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "/", "**", "*", "Returns", "the", "declared", "method", "with", "the", "specified", "name", "and", "parameter", "types", "or", "{", "@", "code", "null", "}", "if", "it", "does", "not", "exist", ".", "*", "*", "@", "author", "Kevin", "Pollet", "&", "lt", ";", "kevin", ".", "pollet", "@", "serli", ".", "com", "&", "gt", ";", "(", "C", ")", "2011", "SERLI", "*", "/", "public", "final", "class", "GetDeclaredMethod", "implements", "PrivilegedAction", "<", "Method", ">", "{", "@", "@", "-", "37", ",", "6", "+", "39", ",", "7", "@", "@", "private", "GetDeclaredMethod", "(", "Class", "<", "?>", "clazz", ",", "String", "methodName", ",", "Class", "<", "?>", "..", ".", "paramet", "this", ".", "parameterTypes", "=", "parameterTypes", ";", "}", "@", "Override", "public", "Method", "run", "(", ")", "{", "try", "{", "return", "clazz", ".", "getDeclaredMethod", "(", "methodName", ",", "parameterTypes", ")", ";", "@", "@", "-", "20", ",", "6", "+", "20", ",", "8", "@", "@", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "/", "**", "*", "Returns", "the", "declared", "methods", "of", "the", "specified", "class", ".", "*", "*", "@", "author", "Emmanuel", "Bernard", "*", "/", "public", "final", "class", "GetDeclaredMethods", "implements", "PrivilegedAction", "<", "Method", "[", "]>", "{", "@", "@", "-", "33", ",", "6", "+", "35", ",", "7", "@", "@", "private", "GetDeclaredMethods", "(", "Class", "<", "?>", "clazz", ")", "{", "this", ".", "clazz", "=", "clazz", ";", "}", "@", "Override", "public", "Method", "[", "]", "run", "(", ")", "{", "return", "clazz", ".", "getDeclaredMethods", "(", ");", "}", "@", "@", "-", "20", ",", "6", "+", "20", ",", "8", "@", "@", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "/", "**", "*", "Returns", "the", "method", "with", "the", "specified", "name", "or", "{", "@", "code", "null", "}", "if", "it", "does", "not", "exist", ".", "*", "*", "@", "author", "Emmanuel", "Bernard", "*", "/", "public", "final", "class", "GetMethod", "implements", "PrivilegedAction", "<", "Method", ">", "{", "@", "@", "-", "35", ",", "6", "+", "37", ",", "7", "@", "@", "private", "GetMethod", "(", "Class", "<", "?>", "clazz", ",", "String", "methodName", ")", "{", "this", ".", "methodName", "=", "methodName", ";", "}", "@", "Override", "public", "Method", "run", "(", ")", "{", "try", "{", "return", "clazz", ".", "getMethod", "(", "methodName", ")", ";", "@", "@", "-", "20", ",", "6", "+", "20", ",", "9", "@", "@", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "/", "**", "*", "Returns", "the", "method", "with", "the", "specified", "property", "name", "or", "{", "@", "code", "null", "}", "if", "it", "does", "not", "exist", ".", "This", "method", "will", "prepend", "*", "'", "is", "'", "and", "'", "get", "'", "to", "the", "property", "name", "and", "capitalize", "the", "first", "letter", ".", "*", "*", "@", "author", "Emmanuel", "Bernard", "*", "@", "author", "Hardy", "Ferentschik", "*", "/", "@", "@", "-", "36", ",", "6", "+", "39", ",", "7", "@", "@", "private", "GetMethodFromPropertyName", "(", "Class", "<", "?>", "clazz", ",", "String", "property", ")", "{", "this", ".", "property", "=", "property", ";", "}", "@", "Override", "public", "Method", "run", "(", ")", "{", "try", "{", "char", "[", "]", "string", "=", "property", ".", "toCharArray", "(", ");", "@", "@", "-", "20", ",", "6", "+", "20", ",", "8", "@", "@", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "/", "**", "*", "Returns", "the", "methods", "of", "the", "specified", "class", "(", "include", "inherited", "methods", ")", ".", "*", "*", "@", "author", "Emmanuel", "Bernard", "*", "/", "public", "final", "class", "GetMethods", "implements", "PrivilegedAction", "<", "Method", "[", "]>", "{", "@", "@", "-", "33", ",", "6", "+", "35", ",", "7", "@", "@", "private", "GetMethods", "(", "Class", "<", "?>", "clazz", ")", "{", "this", ".", "clazz", "=", "clazz", ";", "}", "@", "Override", "public", "Method", "[", "]", "run", "(", ")", "{", "return", "clazz", ".", "getMethods", "(", ");", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "119", "@", "@", "/", "*", "*", "JBoss", ",", "Home", "of", "Professional", "Open", "Source", "*", "Copyright", "2014", ",", "Red", "Hat", ",", "Inc", ".", "and", "/", "or", "its", "affiliates", ",", "and", "individual", "contributors", "*", "by", "the", "@", "authors", "tag", ".", "See", "the", "copyright", ".", "txt", "in", "the", "distribution", "for", "a", "*", "full", "listing", "of", "individual", "contributors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "xml", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashMap", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "LoadClass", ";", "/", "**", "*", "A", "helper", "for", "loading", "classes", "by", "names", ",", "as", "given", "in", "XML", "constraint", "mappings", ".", "Given", "names", "can", "be", "the", "names", "of", "primitive", "*", "types", ",", "qualified", "names", "or", "unqualified", "names", "(", "in", "which", "case", "a", "given", "default", "package", "will", "be", "assumed", ")", ".", "*", "*", "@", "author", "Gunnar", "Morling", "*", "/", "/", "*", "package", "*", "/", "class", "ClassLoadingHelper", "{", "private", "static", "final", "String", "PACKAGE_SEPARATOR", "=", "\"", ".\"", ";", "private", "static", "final", "String", "ARRAY_CLASS_NAME_PREFIX", "=", "\"", "[", "L", "\"", ";", "private", "static", "final", "String", "ARRAY_CLASS_NAME_SUFFIX", "=", "\"", ";\"", ";", "private", "static", "final", "Map", "<", "String", ",", "Class", "<", "?>", ">", "PRIMITIVE_NAME_TO_PRIMITIVE", ";", "static", "{", "Map", "<", "String", ",", "Class", "<", "?>", ">", "tmpMap", "=", "newHashMap", "(", "9", ")", ";", "tmpMap", ".", "put", "(", "boolean", ".", "class", ".", "getName", "(", "),", "boolean", ".", "class", ")", ";", "tmpMap", ".", "put", "(", "char", ".", "class", ".", "getName", "(", "),", "char", ".", "class", ")", ";", "tmpMap", ".", "put", "(", "double", ".", "class", ".", "getName", "(", "),", "double", ".", "class", ")", ";", "tmpMap", ".", "put", "(", "float", ".", "class", ".", "getName", "(", "),", "float", ".", "class", ")", ";", "tmpMap", ".", "put", "(", "long", ".", "class", ".", "getName", "(", "),", "long", ".", "class", ")", ";", "tmpMap", ".", "put", "(", "int", ".", "class", ".", "getName", "(", "),", "int", ".", "class", ")", ";", "tmpMap", ".", "put", "(", "short", ".", "class", ".", "getName", "(", "),", "short", ".", "class", ")", ";", "tmpMap", ".", "put", "(", "byte", ".", "class", ".", "getName", "(", "),", "byte", ".", "class", ")", ";", "tmpMap", ".", "put", "(", "Void", ".", "TYPE", ".", "getName", "(", "),", "Void", ".", "TYPE", ")", ";", "PRIMITIVE_NAME_TO_PRIMITIVE", "=", "Collections", ".", "unmodifiableMap", "(", "tmpMap", ")", ";", "}", "private", "ClassLoadingHelper", "(", ")", "{", "}", "/", "*", "package", "*", "/", "static", "Class", "<", "?>", "loadClass", "(", "String", "className", ",", "String", "defaultPackage", ")", "{", "return", "loadClass", "(", "className", ",", "defaultPackage", ",", "ReflectionHelper", ".", "class", ")", ";", "}", "/", "*", "package", "*", "/", "static", "Class", "<", "?>", "loadClass", "(", "String", "className", ",", "String", "defaultPackage", ",", "Class", "<", "?>", "caller", ")", "{", "if", "(", "PRIMITIVE_NAME_TO_PRIMITIVE", ".", "containsKey", "(", "className", ")", ")", "{", "return", "PRIMITIVE_NAME_TO_PRIMITIVE", ".", "get", "(", "className", ")", ";", "}", "StringBuilder", "fullyQualifiedClass", "=", "new", "StringBuilder", "(", ");", "String", "tmpClassName", "=", "className", ";", "if", "(", "isArrayClassName", "(", "className", ")", ")", "{", "fullyQualifiedClass", ".", "append", "(", "ARRAY_CLASS_NAME_PREFIX", ")", ";", "tmpClassName", "=", "getArrayElementClassName", "(", "className", ")", ";", "}", "if", "(", "isQualifiedClass", "(", "tmpClassName", ")", ")", "{", "fullyQualifiedClass", ".", "append", "(", "tmpClassName", ")", ";", "}", "else", "{", "fullyQualifiedClass", ".", "append", "(", "defaultPackage", ")", ";", "fullyQualifiedClass", ".", "append", "(", "PACKAGE_SEPARATOR", ")", ";", "fullyQualifiedClass", ".", "append", "(", "tmpClassName", ")", ";", "}", "if", "(", "isArrayClassName", "(", "className", ")", ")", "{", "fullyQualifiedClass", ".", "append", "(", "ARRAY_CLASS_NAME_SUFFIX", ")", ";", "}", "return", "loadClass", "(", "fullyQualifiedClass", ".", "toString", "(", "),", "caller", ")", ";", "}", "private", "static", "Class", "<", "?>", "loadClass", "(", "String", "className", ",", "Class", "<", "?>", "caller", ")", "{", "return", "run", "(", "LoadClass", ".", "action", "(", "className", ",", "caller", ")", ")", ";", "}", "private", "static", "boolean", "isArrayClassName", "(", "String", "className", ")", "{", "return", "className", ".", "startsWith", "(", "ARRAY_CLASS_NAME_PREFIX", ")", "&", "&", "className", ".", "endsWith", "(", "ARRAY_CLASS_NAME_SUFFIX", ")", ";", "}", "private", "static", "String", "getArrayElementClassName", "(", "String", "className", ")", "{", "return", "className", ".", "substring", "(", "2", ",", "className", ".", "length", "(", ")", "-", "1", ")", ";", "}", "private", "static", "boolean", "isQualifiedClass", "(", "String", "clazz", ")", "{", "return", "clazz", ".", "contains", "(", "PACKAGE_SEPARATOR", ")", ";", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "static", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "18", ",", "6", "+", "18", ",", "8", "@", "@", "import", "java", ".", "lang", ".", "reflect", ".", "Constructor", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "@", "@", "-", "34", ",", "10", "+", "36", ",", "11", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ".", "ConstrainedExecutable", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ".", "ConstrainedParameter", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ".", "ExecutableElement", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "StringHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredConstructor", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredMethod", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newArrayList", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashMap", ";", "@", "@", "-", "73", ",", "10", "+", "76", ",", "12", "@", "@", "private", "ConstrainedExecutableBuilder", "(", ")", "{", "String", "methodName", "=", "methodType", ".", "getName", "(", ");", "final", "Method", "method", "=", "ReflectionHelper", ".", "getDeclaredMethod", "(", "beanClass", ",", "methodName", ",", "parameterTypes", ".", "toArray", "(", "new", "Class", "[", "parameterTypes", ".", "size", "(", ")]", ")", "final", "Method", "method", "=", "run", "(", "GetDeclaredMethod", ".", "action", "(", "beanClass", ",", "methodName", ",", "parameterTypes", ".", "toArray", "(", "new", "Class", "[", "parameterTypes", ".", "size", "(", ")]", ")", ")", ")", ";", "if", "(", "method", "=", "=", "null", ")", "{", "@", "@", "-", "136", ",", "9", "+", "141", ",", "11", "@", "@", "private", "ConstrainedExecutableBuilder", "(", ")", "{", "defaultPackage", ")", ";", "final", "Constructor", "<", "?>", "constructor", "=", "ReflectionHelper", ".", "getDeclaredConstructor", "(", "beanClass", ",", "constructorParameterTypes", ".", "toArray", "(", "new", "Class", "[", "constructorParameterTypes", ".", "size", "(", ")]", ")", "final", "Constructor", "<", "?>", "constructor", "=", "run", "(", "GetDeclaredConstructor", ".", "action", "(", "beanClass", ",", "constructorParameterTypes", ".", "toArray", "(", "new", "Class", "[", "constructorParameterTypes", ".", "size", "(", ")]", ")", ")", ")", ";", "if", "(", "constructor", "=", "=", "null", ")", "{", "@", "@", "-", "317", ",", "7", "+", "324", ",", "7", "@", "@", "private", "static", "boolean", "parseReturnValueType", "(", "ReturnValueType", "returnValueType", ",", "String", "type", "=", "null", ";", "try", "{", "type", "=", "parameterType", ".", "getType", "(", ");", "Class", "<", "?>", "parameterClass", "=", "ReflectionHelper", ".", "loadClass", "(", "type", ",", "defaultPackage", ")", ";", "Class", "<", "?>", "parameterClass", "=", "ClassLoadingHelper", ".", "loadClass", "(", "type", ",", "defaultPackage", ")", ";", "parameterTypes", ".", "add", "(", "parameterClass", ")", ";", "}", "catch", "(", "ValidationException", "e", ")", "{", "@", "@", "-", "327", ",", "4", "+", "334", ",", "14", "@", "@", "private", "static", "boolean", "parseReturnValueType", "(", "ReturnValueType", "returnValueType", ",", "return", "parameterTypes", ";", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "static", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "17", ",", "6", "+", "17", ",", "8", "@", "@", "package", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "xml", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Field", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "@", "@", "-", "27", ",", "9", "+", "29", ",", "9", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "location", ".", "ConstraintLocation", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ".", "ConfigurationSource", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ".", "ConstrainedField", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredField", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newArrayList", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashSet", ";", "@", "@", "-", "103", ",", "12", "+", "105", ",", "20", "@", "@", "private", "static", "Field", "findField", "(", "Class", "<", "?>", "beanClass", ",", "String", "fieldName", ",", "List", "<", "String", "alreadyProcessedFieldNames", ".", "add", "(", "fieldName", ")", ";", "}", "final", "Field", "field", "=", "ReflectionHelper", ".", "getDeclaredField", "(", "beanClass", ",", "fieldName", ")", ";", "final", "Field", "field", "=", "run", "(", "GetDeclaredField", ".", "action", "(", "beanClass", ",", "fieldName", ")", ")", ";", "if", "(", "field", "=", "=", "null", ")", "{", "throw", "log", ".", "getBeanDoesNotContainTheFieldException", "(", "beanClass", ".", "getName", "(", "),", "fieldName", ")", ";", "}", "return", "field", ";", "}", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "static", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "17", ",", "6", "+", "17", ",", "8", "@", "@", "package", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "xml", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "@", "@", "-", "29", ",", "9", "+", "31", ",", "9", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ".", "ConfigurationSource", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ".", "ConstrainedExecutable", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ".", "ConstrainedParameter", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetMethodFromPropertyName", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newArrayList", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashSet", ";", "@", "@", "-", "108", ",", "13", "+", "110", ",", "21", "@", "@", "private", "static", "Method", "findGetter", "(", "Class", "<", "?>", "beanClass", ",", "String", "getterName", ",", "List", "<", "Str", "alreadyProcessedGetterNames", ".", "add", "(", "getterName", ")", ";", "}", "final", "Method", "method", "=", "ReflectionHelper", ".", "getMethodFromPropertyName", "(", "beanClass", ",", "getterName", ")", ";", "final", "Method", "method", "=", "run", "(", "GetMethodFromPropertyName", ".", "action", "(", "beanClass", ",", "getterName", ")", ")", ";", "if", "(", "method", "=", "=", "null", ")", "{", "throw", "log", ".", "getBeanDoesNotContainThePropertyException", "(", "beanClass", ".", "getName", "(", "),", "getterName", ")", ";", "}", "return", "method", ";", "}", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "static", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "26", ",", "7", "+", "26", ",", "6", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "location", ".", "ConstraintLocation", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ".", "ConfigurationSource", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ".", "ConstrainedType", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newArrayList", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashSet", ";", "@", "@", "-", "91", ",", "7", "+", "90", ",", "7", "@", "@", "public", "static", "ConstrainedType", "buildConstrainedType", "(", "ClassType", "classType", ",", "List", "<", "Class", "<", "?>", ">", "groupSequence", "=", "newArrayList", "(", ");", "if", "(", "groupSequenceType", "!", "=", "null", ")", "{", "for", "(", "String", "groupName", ":", "groupSequenceType", ".", "getValue", "(", ")", ")", "{", "Class", "<", "?>", "group", "=", "ReflectionHelper", ".", "loadClass", "(", "groupName", ",", "defaultPackage", ")", ";", "Class", "<", "?>", "group", "=", "ClassLoadingHelper", ".", "loadClass", "(", "groupName", ",", "defaultPackage", ")", ";", "groupSequence", ".", "add", "(", "group", ")", ";", "}", "}", "@", "@", "-", "19", ",", "8", "+", "19", ",", "6", "@", "@", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashMap", ";", "/", "**", "@", "@", "-", "37", ",", "13", "+", "35", ",", "11", "@", "@", "private", "GroupConversionBuilder", "(", ")", "{", "String", "defaultPackage", ")", "{", "Map", "<", "Class", "<", "?>", ",", "Class", "<", "?>", ">", "groupConversionMap", "=", "newHashMap", "(", ");", "for", "(", "GroupConversionType", "groupConversionType", ":", "groupConversionTypes", ")", "{", "Class", "<", "?>", "fromClass", "=", "ReflectionHelper", ".", "loadClass", "(", "groupConversionType", ".", "getFrom", "(", "),", "defaultPackage", ")", ";", "Class", "<", "?>", "toClass", "=", "ReflectionHelper", ".", "loadClass", "(", "groupConversionType", ".", "getTo", "(", "),", "defaultPackage", ")", ";", "Class", "<", "?>", "fromClass", "=", "ClassLoadingHelper", ".", "loadClass", "(", "groupConversionType", ".", "getFrom", "(", "),", "defaultPackage", ")", ";", "Class", "<", "?>", "toClass", "=", "ClassLoadingHelper", ".", "loadClass", "(", "groupConversionType", ".", "getTo", "(", "),", "defaultPackage", ")", ";", "groupConversionMap", ".", "put", "(", "fromClass", ",", "toClass", ")", ";", "}", "return", "groupConversionMap", ";", "}", "}", "@", "@", "-", "20", ",", "7", "+", "20", ",", "10", "@", "@", "import", "java", ".", "lang", ".", "annotation", ".", "Annotation", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Array", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "List", ";", "import", "javax", ".", "validation", ".", "Payload", ";", "import", "javax", ".", "validation", ".", "ValidationException", ";", "import", "javax", ".", "xml", ".", "bind", ".", "JAXBElement", ";", "@", "@", "-", "29", ",", "11", "+", "32", ",", "11", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "core", ".", "MetaConstraint", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "descriptor", ".", "ConstraintDescriptorImpl", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "location", ".", "ConstraintLocation", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "annotationfactory", ".", "AnnotationDescriptor", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "annotationfactory", ".", "AnnotationFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetMethod", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newArrayList", ";", "@", "@", "-", "61", ",", "7", "+", "64", ",", "7", "@", "@", "private", "MetaConstraintBuilder", "(", ")", "{", "ConstraintDescriptorImpl", ".", "ConstraintType", "constraintType", ")", "{", "Class", "<", "A", ">", "annotationClass", ";", "try", "{", "annotationClass", "=", "(", "Class", "<", "A", ">", ")", "ReflectionHelper", ".", "loadClass", "(", "constraint", ".", "getAnnotation", "(", "),", "defaultPackage", ")", ";", "annotationClass", "=", "(", "Class", "<", "A", ">", ")", "ClassLoadingHelper", ".", "loadClass", "(", "constraint", ".", "getAnnotation", "(", "),", "defaultPackage", ")", ";", "}", "catch", "(", "ValidationException", "e", ")", "{", "throw", "log", ".", "getUnableToLoadConstraintAnnotationClassException", "(", "constraint", ".", "getAnnotation", "(", "),", "e", ")", ";", "@", "@", "-", "117", ",", "7", "+", "120", ",", "7", "@", "@", "private", "static", "void", "checkNameIsValid", "(", "String", "name", ")", "{", "}", "private", "static", "<", "A", "extends", "Annotation", ">", "Class", "<", "?>", "getAnnotationParameterType", "(", "Class", "<", "A", ">", "annotationClass", ",", "String", "name", ")", "{", "Method", "m", "=", "ReflectionHelper", ".", "getMethod", "(", "annotationClass", ",", "name", ")", ";", "Method", "m", "=", "run", "(", "GetMethod", ".", "action", "(", "annotationClass", ",", "name", ")", ")", ";", "if", "(", "m", "=", "=", "null", ")", "{", "throw", "log", ".", "getAnnotationDoesNotContainAParameterException", "(", "annotationClass", ".", "getName", "(", "),", "name", ")", ";", "}", "@", "@", "-", "249", ",", "7", "+", "252", ",", "7", "@", "@", "else", "if", "(", "returnType", ".", "getName", "(", ").", "equals", "(", "String", ".", "class", ".", "getName", "(", ")", ")", ")", "{", "returnValue", "=", "value", ";", "}", "else", "if", "(", "returnType", ".", "getName", "(", ").", "equals", "(", "Class", ".", "class", ".", "getName", "(", ")", ")", ")", "{", "returnValue", "=", "ReflectionHelper", ".", "loadClass", "(", "value", ",", "defaultPackage", ",", "MetaConstraintBuilder", ".", "class", ")", ";", "returnValue", "=", "ClassLoadingHelper", ".", "loadClass", "(", "value", ",", "defaultPackage", ",", "MetaConstraintBuilder", ".", "class", ")", ";", "}", "else", "{", "try", "{", "@", "@", "-", "271", ",", "7", "+", "274", ",", "7", "@", "@", "else", "if", "(", "returnType", ".", "getName", "(", ").", "equals", "(", "Class", ".", "class", ".", "getName", "(", ")", ")", ")", "{", "List", "<", "Class", "<", "?>", ">", "groupList", "=", "newArrayList", "(", ");", "for", "(", "String", "groupClass", ":", "groupsType", ".", "getValue", "(", ")", ")", "{", "groupList", ".", "add", "(", "ReflectionHelper", ".", "loadClass", "(", "groupClass", ",", "defaultPackage", ")", ")", ";", "groupList", ".", "add", "(", "ClassLoadingHelper", ".", "loadClass", "(", "groupClass", ",", "defaultPackage", ")", ")", ";", "}", "return", "groupList", ".", "toArray", "(", "new", "Class", "[", "groupList", ".", "size", "(", ")]", ")", ";", "}", "@", "@", "-", "284", ",", "7", "+", "287", ",", "7", "@", "@", "else", "if", "(", "returnType", ".", "getName", "(", ").", "equals", "(", "Class", ".", "class", ".", "getName", "(", ")", ")", ")", "{", "List", "<", "Class", "<", "?", "extends", "Payload", ">", ">", "payloadList", "=", "newArrayList", "(", ");", "for", "(", "String", "groupClass", ":", "payloadType", ".", "getValue", "(", ")", ")", "{", "Class", "<", "?>", "payload", "=", "ReflectionHelper", ".", "loadClass", "(", "groupClass", ",", "defaultPackage", ")", ";", "Class", "<", "?>", "payload", "=", "ClassLoadingHelper", ".", "loadClass", "(", "groupClass", ",", "defaultPackage", ")", ";", "if", "(", "!", "Payload", ".", "class", ".", "isAssignableFrom", "(", "payload", ")", ")", "{", "throw", "log", ".", "getWrongPayloadClassException", "(", "payload", ".", "getName", "(", ")", ")", ";", "}", "@", "@", "-", "294", ",", "6", "+", "297", ",", "14", "@", "@", "else", "if", "(", "returnType", ".", "getName", "(", ").", "equals", "(", "Class", ".", "class", ".", "getName", "(", ")", ")", ")", "{", "}", "return", "payloadList", ".", "toArray", "(", "new", "Class", "[", "payloadList", ".", "size", "(", ")]", ")", ";", "}", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "static", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "17", ",", "6", "+", "17", ",", "8", "@", "@", "package", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "xml", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "@", "@", "-", "30", ",", "10", "+", "32", ",", "11", "@", "@", "import", "javax", ".", "validation", ".", "ValidationException", ";", "import", "javax", ".", "validation", ".", "spi", ".", "ValidationProvider", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ResourceLoaderHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "LoadClass", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "NewInstance", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "spi", ".", "valuehandling", ".", "ValidatedValueUnwrapper", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newArrayList", ";", "@", "@", "-", "141", ",", "9", "+", "144", ",", "8", "@", "@", "public", "void", "setParameterNameProvider", "(", "ParameterNameProvider", "parameterNameProvider", "private", "void", "setProviderClass", "(", "String", "providerFqcn", ")", "{", "if", "(", "providerFqcn", "!", "=", "null", ")", "{", "try", "{", "providerClass", "=", "(", "Class", "<", "?", "extends", "ValidationProvider", "<", "?>", ">)", "ReflectionHelper", ".", "loadClass", "(", "providerFqcn", ",", "this", ".", "getClass", "(", ")", "providerClass", "=", "(", "Class", "<", "?", "extends", "ValidationProvider", "<", "?>", ">)", "run", "(", "LoadClass", ".", "action", "(", "providerFqcn", ",", "this", ".", "getClass", "(", ")", ")", ")", ";", "log", ".", "usingValidationProvider", "(", "providerFqcn", ")", ";", "}", "@", "@", "-", "157", ",", "10", "+", "159", ",", "10", "@", "@", "private", "void", "setMessageInterpolator", "(", "String", "messageInterpolatorFqcn", ")", "{", "if", "(", "messageInterpolatorFqcn", "!", "=", "null", ")", "{", "try", "{", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Class", "<", "MessageInterpolator", ">", "messageInterpolatorClass", "=", "(", "Class", "<", "MessageInterpolator", ">", ")", "ReflectionHelper", ".", "loadClass", "(", "messageInterpolatorFqcn", ",", "this", ".", "getClass", "(", ")", "Class", "<", "MessageInterpolator", ">", "messageInterpolatorClass", "=", "(", "Class", "<", "MessageInterpolator", ">", ")", "run", "(", "LoadClass", ".", "action", "(", "messageInterpolatorFqcn", ",", "this", ".", "getClass", "(", ")", ")", ")", ";", "messageInterpolator", "=", "ReflectionHelper", ".", "newInstance", "(", "messageInterpolatorClass", ",", "\"", "message", "interpolator", "\"", ")", ";", "messageInterpolator", "=", "run", "(", "NewInstance", ".", "action", "(", "messageInterpolatorClass", ",", "\"", "message", "interpolator", "\"", ")", ")", ";", "log", ".", "usingMessageInterpolator", "(", "messageInterpolatorFqcn", ")", ";", "}", "catch", "(", "ValidationException", "e", ")", "{", "@", "@", "-", "173", ",", "10", "+", "175", ",", "10", "@", "@", "private", "void", "setTraversableResolver", "(", "String", "traversableResolverFqcn", ")", "{", "if", "(", "traversableResolverFqcn", "!", "=", "null", ")", "{", "try", "{", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Class", "<", "TraversableResolver", ">", "clazz", "=", "(", "Class", "<", "TraversableResolver", ">", ")", "ReflectionHelper", ".", "loadClass", "(", "traversableResolverFqcn", ",", "this", ".", "getClass", "(", ")", "Class", "<", "TraversableResolver", ">", "clazz", "=", "(", "Class", "<", "TraversableResolver", ">", ")", "run", "(", "LoadClass", ".", "action", "(", "traversableResolverFqcn", ",", "this", ".", "getClass", "(", ")", ")", ")", ";", "traversableResolver", "=", "ReflectionHelper", ".", "newInstance", "(", "clazz", ",", "\"", "traversable", "resolver", "\"", ")", ";", "traversableResolver", "=", "run", "(", "NewInstance", ".", "action", "(", "clazz", ",", "\"", "traversable", "resolver", "\"", ")", ")", ";", "log", ".", "usingTraversableResolver", "(", "traversableResolverFqcn", ")", ";", "}", "catch", "(", "ValidationException", "e", ")", "{", "@", "@", "-", "189", ",", "10", "+", "191", ",", "10", "@", "@", "private", "void", "setConstraintFactory", "(", "String", "constraintFactoryFqcn", ")", "{", "if", "(", "constraintFactoryFqcn", "!", "=", "null", ")", "{", "try", "{", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Class", "<", "ConstraintValidatorFactory", ">", "clazz", "=", "(", "Class", "<", "ConstraintValidatorFactory", ">", ")", "ReflectionHelper", ".", "loadClass", "(", "constraintFactoryFqcn", ",", "this", ".", "getClass", "(", ")", "Class", "<", "ConstraintValidatorFactory", ">", "clazz", "=", "(", "Class", "<", "ConstraintValidatorFactory", ">", ")", "run", "(", "LoadClass", ".", "action", "(", "constraintFactoryFqcn", ",", "this", ".", "getClass", "(", ")", ")", ")", ";", "constraintValidatorFactory", "=", "ReflectionHelper", ".", "newInstance", "(", "clazz", ",", "\"", "constraint", "factory", "class", "\"", ")", ";", "constraintValidatorFactory", "=", "run", "(", "NewInstance", ".", "action", "(", "clazz", ",", "\"", "constraint", "factory", "class", "\"", ")", ")", ";", "log", ".", "usingConstraintFactory", "(", "constraintFactoryFqcn", ")", ";", "}", "catch", "(", "ValidationException", "e", ")", "{", "@", "@", "-", "205", ",", "10", "+", "207", ",", "10", "@", "@", "private", "void", "setParameterNameProvider", "(", "String", "parameterNameProviderFqcn", ")", "{", "if", "(", "parameterNameProviderFqcn", "!", "=", "null", ")", "{", "try", "{", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Class", "<", "ParameterNameProvider", ">", "clazz", "=", "(", "Class", "<", "ParameterNameProvider", ">", ")", "ReflectionHelper", ".", "loadClass", "(", "parameterNameProviderFqcn", ",", "this", ".", "getClass", "(", ")", "Class", "<", "ParameterNameProvider", ">", "clazz", "=", "(", "Class", "<", "ParameterNameProvider", ">", ")", "run", "(", "LoadClass", ".", "action", "(", "parameterNameProviderFqcn", ",", "this", ".", "getClass", "(", ")", ")", ")", ";", "parameterNameProvider", "=", "ReflectionHelper", ".", "newInstance", "(", "clazz", ",", "\"", "parameter", "name", "provider", "class", "\"", ")", ";", "parameterNameProvider", "=", "run", "(", "NewInstance", ".", "action", "(", "clazz", ",", "\"", "parameter", "name", "provider", "class", "\"", ")", ")", ";", "log", ".", "usingParameterNameProvider", "(", "parameterNameProviderFqcn", ")", ";", "}", "catch", "(", "ValidationException", "e", ")", "{", "@", "@", "-", "235", ",", "6", "+", "237", ",", "16", "@", "@", "private", "void", "setConfigProperties", "(", "Map", "<", "String", ",", "String", ">", "properties", ")", "{", "}", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "public", "void", "addValidatedValueHandler", "(", "ValidatedValueUnwrapper", "<", "?>", "handler", ")", "{", "validatedValueHandlers", ".", "add", "(", "handler", ")", ";", "}", "@", "@", "-", "20", ",", "12", "+", "20", ",", "15", "@", "@", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "lang", ".", "annotation", ".", "Annotation", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ConcurrentHashMap", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ConcurrentMap", ";", "import", "javax", ".", "validation", ".", "ConstraintValidator", ";", "import", "javax", ".", "validation", ".", "ParameterNameProvider", ";", "import", "javax", ".", "xml", ".", "bind", ".", "JAXBContext", ";", "@", "@", "-", "43", ",", "9", "+", "46", ",", "9", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ".", "ConstrainedExecutable", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ".", "ConstrainedField", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ".", "ConstrainedType", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "LoadClass", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newArrayList", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashMap", ";", "@", "@", "-", "118", ",", "7", "+", "121", ",", "7", "@", "@", "public", "final", "void", "parse", "(", "Set", "<", "InputStream", ">", "mappingStreams", ")", "{", ")", ";", "for", "(", "BeanType", "bean", ":", "mapping", ".", "getBean", "(", ")", ")", "{", "Class", "<", "?>", "beanClass", "=", "ReflectionHelper", ".", "loadClass", "(", "bean", ".", "getClazz", "(", "),", "defaultPackage", ")", ";", "Class", "<", "?>", "beanClass", "=", "ClassLoadingHelper", ".", "loadClass", "(", "bean", ".", "getClazz", "(", "),", "defaultPackage", ")", ";", "checkClassHasNotBeenProcessed", "(", "processedClasses", ",", "beanClass", ")", ";", "/", "/", "update", "annotation", "ignores", "@", "@", "-", "220", ",", "7", "+", "223", ",", "7", "@", "@", "private", "void", "parseConstraintDefinitions", "(", "List", "<", "ConstraintDefinitionType", ">", "constrain", "alreadyProcessedConstraintDefinitions", ".", "add", "(", "annotationClassName", ")", ";", "}", "Class", "<", "?>", "clazz", "=", "ReflectionHelper", ".", "loadClass", "(", "annotationClassName", ",", "defaultPackage", ")", ";", "Class", "<", "?>", "clazz", "=", "ClassLoadingHelper", ".", "loadClass", "(", "annotationClassName", ",", "defaultPackage", ")", ";", "if", "(", "!", "clazz", ".", "isAnnotation", "(", ")", ")", "{", "throw", "log", ".", "getIsNotAnAnnotationException", "(", "annotationClassName", ")", ";", "}", "@", "@", "-", "235", ",", "11", "+", "238", ",", "9", "@", "@", "private", "void", "parseConstraintDefinitions", "(", "List", "<", "ConstraintDefinitionType", ">", "constrain", "for", "(", "String", "validatorClassName", ":", "validatedByType", ".", "getValue", "(", ")", ")", "{", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Class", "<", "?", "extends", "ConstraintValidator", "<", "A", ",", "?", ">>", "validatorClass", "=", "(", "Class", "<", "?", "extends", "ConstraintValidator", "<", "A", ",", "?", ">>", ")", "ReflectionHelper", ".", "loadClass", "(", "validatorClassName", ",", "this", ".", "getClass", "(", ")", ")", ";", "Class", "<", "?", "extends", "ConstraintValidator", "<", "A", ",", "?", ">>", "validatorClass", "=", "(", "Class", "<", "?", "extends", "ConstraintValidator", "<", "A", ",", "?", ">>", ")", "run", "(", "LoadClass", ".", "action", "(", "validatorClassName", ",", "this", ".", "getClass", "(", ")", ")", ")", ";", "if", "(", "!", "ConstraintValidator", ".", "class", ".", "isAssignableFrom", "(", "validatorClass", ")", ")", "{", "@", "@", "-", "335", ",", "6", "+", "336", ",", "16", "@", "@", "private", "String", "getSchemaResourceName", "(", "String", "schemaVersion", ")", "{", "return", "schemaResource", ";", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "/", "/", "JAXB", "closes", "the", "underlying", "input", "stream", "private", "static", "class", "CloseIgnoringInputStream", "extends", "FilterInputStream", "{", "public", "CloseIgnoringInputStream", "(", "InputStream", "in", ")", "{", "@", "@", "-", "19", ",", "8", "+", "19", ",", "11", "@", "@", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "net", ".", "URL", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ConcurrentHashMap", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ConcurrentMap", ";", "import", "javax", ".", "xml", ".", "namespace", ".", "QName", ";", "import", "javax", ".", "xml", ".", "stream", ".", "XMLEventReader", ";", "import", "javax", ".", "xml", ".", "stream", ".", "XMLInputFactory", ";", "@", "@", "-", "32", ",", "11", "+", "35", ",", "10", "@", "@", "import", "javax", ".", "xml", ".", "validation", ".", "SchemaFactory", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "Contracts", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetClassLoader", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Messages", ".", "MESSAGES", ";", "@", "@", "-", "148", ",", "7", "+", "150", ",", "7", "@", "@", "public", "Schema", "getSchema", "(", "String", "schemaResource", ")", "{", "}", "private", "Schema", "loadSchema", "(", "String", "schemaResource", ")", "{", "ClassLoader", "loader", "=", "ReflectionHelper", ".", "getClassLoaderFromClass", "(", "XmlParserHelper", ".", "class", ")", ";", "ClassLoader", "loader", "=", "run", "(", "GetClassLoader", ".", "fromClass", "(", "XmlParserHelper", ".", "class", ")", ")", ";", "URL", "schemaUrl", "=", "loader", ".", "getResource", "(", "schemaResource", ")", ";", "SchemaFactory", "sf", "=", "SchemaFactory", ".", "newInstance", "(", "javax", ".", "xml", ".", "XMLConstants", ".", "W3C_XML_SCHEMA_NS_URI", ")", ";", "@", "@", "-", "161", ",", "4", "+", "163", ",", "14", "@", "@", "private", "Schema", "loadSchema", "(", "String", "schemaResource", ")", "{", "}", "return", "schema", ";", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "19", ",", "17", "+", "19", ",", "17", "@", "@", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "javax", ".", "validation", ".", "ConstraintViolation", ";", "import", "javax", ".", "validation", ".", "Validator", ";", "import", "org", ".", "testng", ".", "annotations", ".", "BeforeMethod", ";", "import", "org", ".", "testng", ".", "annotations", ".", "Test", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "HibernateValidator", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "HibernateValidatorConfiguration", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "ConstraintMapping", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "defs", ".", "NotNullDef", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetMethod", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "testutil", ".", "TestForIssue", ";", "import", "static", "java", ".", "lang", ".", "annotation", ".", "ElementType", ".", "FIELD", ";", "@", "@", "-", "108", ",", "7", "+", "108", ",", "7", "@", "@", "public", "void", "testProgrammaticCascadingMethodValidation", "(", ")", "{", "B", "b", "=", "new", "B", "(", ");", "b", ".", "c", "=", "new", "C", "(", ");", "Method", "method", "=", "ReflectionHelper", ".", "getMethod", "(", "B", ".", "class", ",", "\"", "getC", "\"", ")", ";", "Method", "method", "=", "GetMethod", ".", "action", "(", "B", ".", "class", ",", "\"", "getC", "\"", ")", ".", "run", "(", ");", "Set", "<", "ConstraintViolation", "<", "B", ">", ">", "violations", "=", "validator", ".", "forExecutables", "(", ").", "validateReturnValue", "(", "b", ",", "method", ",", "b", ".", "getC", "(", ")", "@", "@", "-", "16", ",", "7", "+", "16", ",", "6", "@", "@", "*", "/", "package", "org", ".", "hibernate", ".", "validator", ".", "test", ".", "internal", ".", "util", ";", "import", "java", ".", "lang", ".", "annotation", ".", "Annotation", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Type", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "@", "@", "-", "27", ",", "10", "+", "26", ",", "6", "@", "@", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "SortedMap", ";", "import", "java", ".", "util", ".", "TreeSet", ";", "import", "javax", ".", "validation", ".", "Payload", ";", "import", "javax", ".", "validation", ".", "ValidationException", ";", "import", "javax", ".", "validation", ".", "constraints", ".", "NotNull", ";", "import", "javax", ".", "validation", ".", "groups", ".", "Default", ";", "import", "org", ".", "testng", ".", "annotations", ".", "Test", ";", "@", "@", "-", "41", ",", "7", "+", "36", ",", "6", "@", "@", "import", "static", "org", ".", "testng", ".", "Assert", ".", "assertFalse", ";", "import", "static", "org", ".", "testng", ".", "Assert", ".", "assertNull", ";", "import", "static", "org", ".", "testng", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "testng", ".", "Assert", ".", "fail", ";", "/", "**", "*", "Tests", "for", "the", "{", "@", "code", "ReflectionHelper", "}", ".", "@", "@", "-", "126", ",", "57", "+", "120", ",", "6", "@", "@", "public", "void", "testGetIndexedValueForNull", "(", ")", "{", "assertNull", "(", "value", ")", ";", "}", "@", "Test", "public", "void", "testGetMessageParameter", "(", ")", "{", "NotNull", "testAnnotation", "=", "new", "NotNull", "(", ")", "{", "@", "Override", "public", "String", "message", "(", ")", "{", "return", "\"", "test", "\"", ";", "}", "@", "Override", "public", "Class", "<", "?>", "[]", "groups", "(", ")", "{", "return", "new", "Class", "<", "?>", "[]", "{", "Default", ".", "class", "}", ";", "}", "@", "Override", "public", "Class", "<", "?", "extends", "Payload", ">", "[]", "payload", "(", ")", "{", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Class", "<", "?", "extends", "Payload", ">", "[]", "classes", "=", "new", "Class", "[", "]", "{", "}", ";", "return", "classes", ";", "}", "@", "Override", "public", "Class", "<", "?", "extends", "Annotation", ">", "annotationType", "(", ")", "{", "return", "this", ".", "getClass", "(", ");", "}", "}", ";", "String", "message", "=", "ReflectionHelper", ".", "getAnnotationParameter", "(", "testAnnotation", ",", "\"", "message", "\"", ",", "String", ".", "class", ")", ";", "assertEquals", "(", "\"", "test", "\"", ",", "message", ",", "\"", "Wrong", "message", "\"", ")", ";", "Class", "<", "?>", "[]", "group", "=", "ReflectionHelper", ".", "getAnnotationParameter", "(", "testAnnotation", ",", "\"", "groups", "\"", ",", "Class", "[", "].", "class", ")", ";", "assertEquals", "(", "group", "[", "0", "]", ",", "Default", ".", "class", ",", "\"", "Wrong", "message", "\"", ")", ";", "try", "{", "ReflectionHelper", ".", "getAnnotationParameter", "(", "testAnnotation", ",", "\"", "message", "\"", ",", "Integer", ".", "class", ")", ";", "fail", "(", ");", "}", "catch", "(", "ValidationException", "e", ")", "{", "assertTrue", "(", "e", ".", "getMessage", "(", ").", "contains", "(", "\"", "Wrong", "parameter", "type", ".", "\"", ")", ",", "\"", "Wrong", "exception", "message", "\"", ")", ";", "}", "try", "{", "ReflectionHelper", ".", "getAnnotationParameter", "(", "testAnnotation", ",", "\"", "foo", "\"", ",", "Integer", ".", "class", ")", ";", "fail", "(", ");", "}", "catch", "(", "ValidationException", "e", ")", "{", "assertTrue", "(", "e", ".", "getMessage", "(", ").", "contains", "(", "\"", "The", "specified", "annotation", "defines", "no", "parameter", "\"", ")", ",", "\"", "Wrong", "exception", "message", "\"", ")", ";", "}", "}", "@", "Test", "@", "TestForIssue", "(", "jiraKey", "=", "\"", "HV", "-", "622", "\"", ")", "public", "void", "testIsGetterMethod", "(", ")", "throws", "Exception", "{", "@", "@", "-", "9", ",", "7", "+", "9", ",", "7", "@", "@", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "@", "@", "-", "25", ",", "10", "+", "25", ",", "9", "@", "@", "import", "org", ".", "testng", ".", "annotations", ".", "BeforeMethod", ";", "import", "org", ".", "testng", ".", "annotations", ".", "Test", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "annotationfactory", ".", "AnnotationDescriptor", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "annotationfactory", ".", "AnnotationFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredMethods", ";", "/", "**", "*", "@", "author", "Gunnar", "Morling", "@", "@", "-", "273", ",", "7", "+", "272", ",", "7", "@", "@", "public", "void", "testHashCode", "(", ")", "{", "AnnotationDescriptor", "<", "A", ">", "descriptor", "=", "new", "AnnotationDescriptor", "<", "A", ">", "(", "annotationType", ")", ";", "for", "(", "Method", "method", ":", "ReflectionHelper", ".", "getDeclaredMethods", "(", "annotationType", ")", ")", "{", "for", "(", "Method", "method", ":", "GetDeclaredMethods", ".", "action", "(", "annotationType", ")", ".", "run", "(", ")", ")", "{", "try", "{", "descriptor", ".", "setValue", "(", "method", ".", "getName", "(", "),", "method", ".", "invoke", "(", "annotation", ")", ")", ";", "}", "@", "@", "-", "16", ",", "7", "+", "16", ",", "6", "@", "@", "*", "/", "package", "org", ".", "hibernate", ".", "validator", ".", "test", ".", "internal", ".", "util", ".", "classhierarchy", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "testng", ".", "annotations", ".", "Test", ";", "@", "@", "-", "25", ",", "7", "+", "24", ",", "6", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "classhierarchy", ".", "Filters", ";", "import", "static", "org", ".", "fest", ".", "assertions", ".", "Assertions", ".", "assertThat", ";", "import", "static", "org", ".", "testng", ".", "Assert", ".", "assertTrue", ";", "/", "**", "*", "Unit", "test", "for", "{", "@", "link", "ClassHierarchyHelper", "}", ".", "@", "@", "-", "35", ",", "13", "+", "33", ",", "6", "@", "@", "*", "/", "public", "class", "ClassHierarchyHelperTest", "{", "@", "Test", "public", "void", "testGetAllMethods", "(", ")", "throws", "Exception", "{", "List", "<", "Method", ">", "methods", "=", "ClassHierarchyHelper", ".", "getAllMethods", "(", "Fubar", ".", "class", ")", ";", "assertTrue", "(", "methods", ".", "contains", "(", "Snafu", ".", "class", ".", "getMethod", "(", "\"", "snafu", "\"", ")", ")", ")", ";", "assertTrue", "(", "methods", ".", "contains", "(", "Susfu", ".", "class", ".", "getMethod", "(", "\"", "susfu", "\"", ")", ")", ")", ";", "}", "@", "Test", "public", "void", "testGetHierarchy", "(", ")", "{", "List", "<", "Class", "<", "?", "super", "Fubar", ">", ">", "hierarchy", "=", "ClassHierarchyHelper", ".", "getHierarchy", "(", "Fubar", ".", "class", ")", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "91", "@", "@", "/", "*", "*", "JBoss", ",", "Home", "of", "Professional", "Open", "Source", "*", "Copyright", "2014", ",", "Red", "Hat", ",", "Inc", ".", "and", "/", "or", "its", "affiliates", ",", "and", "individual", "contributors", "*", "by", "the", "@", "authors", "tag", ".", "See", "the", "copyright", ".", "txt", "in", "the", "distribution", "for", "a", "*", "full", "listing", "of", "individual", "contributors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "hibernate", ".", "validator", ".", "test", ".", "internal", ".", "util", ".", "privilegedactions", ";", "import", "static", "org", ".", "testng", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "testng", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "testng", ".", "Assert", ".", "fail", ";", "import", "java", ".", "lang", ".", "annotation", ".", "Annotation", ";", "import", "javax", ".", "validation", ".", "Payload", ";", "import", "javax", ".", "validation", ".", "ValidationException", ";", "import", "javax", ".", "validation", ".", "constraints", ".", "NotNull", ";", "import", "javax", ".", "validation", ".", "groups", ".", "Default", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetAnnotationParameter", ";", "import", "org", ".", "testng", ".", "annotations", ".", "Test", ";", "/", "**", "*", "Unit", "test", "for", "{", "@", "link", "GetAnnotationsParameter", "}", ".", "*", "*", "@", "author", "Gunnar", "Morling", "*", "*", "/", "public", "class", "GetAnnotationsParameterTest", "{", "@", "Test", "public", "void", "testGetMessageParameter", "(", ")", "{", "NotNull", "testAnnotation", "=", "new", "NotNull", "(", ")", "{", "@", "Override", "public", "String", "message", "(", ")", "{", "return", "\"", "test", "\"", ";", "}", "@", "Override", "public", "Class", "<", "?>", "[]", "groups", "(", ")", "{", "return", "new", "Class", "<", "?>", "[]", "{", "Default", ".", "class", "}", ";", "}", "@", "Override", "public", "Class", "<", "?", "extends", "Payload", ">", "[]", "payload", "(", ")", "{", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Class", "<", "?", "extends", "Payload", ">", "[]", "classes", "=", "new", "Class", "[", "]", "{", "}", ";", "return", "classes", ";", "}", "@", "Override", "public", "Class", "<", "?", "extends", "Annotation", ">", "annotationType", "(", ")", "{", "return", "this", ".", "getClass", "(", ");", "}", "}", ";", "String", "message", "=", "GetAnnotationParameter", ".", "action", "(", "testAnnotation", ",", "\"", "message", "\"", ",", "String", ".", "class", ")", ".", "run", "(", ");", "assertEquals", "(", "\"", "test", "\"", ",", "message", ",", "\"", "Wrong", "message", "\"", ")", ";", "Class", "<", "?>", "[]", "group", "=", "GetAnnotationParameter", ".", "action", "(", "testAnnotation", ",", "\"", "groups", "\"", ",", "Class", "[", "].", "class", ")", ".", "run", "(", ");", "assertEquals", "(", "group", "[", "0", "]", ",", "Default", ".", "class", ",", "\"", "Wrong", "message", "\"", ")", ";", "try", "{", "GetAnnotationParameter", ".", "action", "(", "testAnnotation", ",", "\"", "message", "\"", ",", "Integer", ".", "class", ")", ".", "run", "(", ");", "fail", "(", ");", "}", "catch", "(", "ValidationException", "e", ")", "{", "assertTrue", "(", "e", ".", "getMessage", "(", ").", "contains", "(", "\"", "Wrong", "parameter", "type", ".", "\"", ")", ",", "\"", "Wrong", "exception", "message", "\"", ")", ";", "}", "try", "{", "GetAnnotationParameter", ".", "action", "(", "testAnnotation", ",", "\"", "foo", "\"", ",", "Integer", ".", "class", ")", ".", "run", "(", ");", "fail", "(", ");", "}", "catch", "(", "ValidationException", "e", ")", "{", "assertTrue", "(", "e", ".", "getMessage", "(", ").", "contains", "(", "\"", "The", "specified", "annotation", "defines", "no", "parameter", "\"", ")", ",", "\"", "Wrong", "exception", "message", "\"", ")", ";", "}", "}", "}"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Update", "version", "to", "4.1.7"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["related", "#1245", "displaying", "the", "activated", "plugin", "list", "in", "environnement", "section"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["Update", "lz4", "to", "1.8.3"], "code_tokens": ["@", "@", "-", "1", "+", "1", "@", "@", "Subproject", "commit", "dfed9fa1d77f0434306d377c4da1f7191d3ba08a", "Subproject", "commit", "641b453d9db536ee020851bfcb1dc39f61006f0a"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["PR:", "1923", "Submitted", "by:", "Daniel", "Mentz", "<daniel.m@sent.com>,", "Robin", "Seggelmann", "<seggelmann@fh-muenster.de>", "Approved", "by:", "steve@openssl.org", "Don't", "access", "freed", "data", "structure."], "code_tokens": ["@", "@", "-", "519", ",", "6", "+", "519", ",", "7", "@", "@", "dtls1_retrieve_buffered_fragment", "(", "SSL", "*", "s", ",", "long", "max", ",", "int", "*", "ok", ")", "if", "(", "s", "-", ">", "d1", "-", ">", "handshake_read_seq", "=", "=", "frag", "-", ">", "msg_header", ".", "seq", ")", "{", "unsigned", "long", "frag_len", "=", "frag", "-", ">", "msg_header", ".", "frag_len", ";", "pqueue_pop", "(", "s", "-", ">", "d1", "-", ">", "buffered_messages", ")", ";", "al", "=", "dtls1_preprocess_fragment", "(", "s", ",", "&", "frag", "-", ">", "msg_header", ",", "max", ")", ";", "@", "@", "-", "536", ",", "7", "+", "537", ",", "7", "@", "@", "dtls1_retrieve_buffered_fragment", "(", "SSL", "*", "s", ",", "long", "max", ",", "int", "*", "ok", ")", "if", "(", "al", "=", "=", "0", ")", "{", "*", "ok", "=", "1", ";", "return", "frag", "-", ">", "msg_header", ".", "frag_len", ";", "return", "frag_len", ";", "}", "ssl3_send_alert", "(", "s", ",", "SSL3_AL_FATAL", ",", "al", ")", ";"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["[maven-release-plugin]", "prepare", "for", "next", "development", "iteration"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["[PATCH]", "x86_64:", "When", "user", "could", "have", "changed", "RIP", "always", "force", "IRET", "Intel", "EM64T", "CPUs", "handle", "uncanonical", "return", "addresses", "differently", "from", "AMD", "CPUs.", "The", "exception", "is", "reported", "in", "the", "SYSRET,", "not", "the", "next", "instruction.", "This", "leads", "to", "the", "kernel", "exception", "handler", "running", "on", "the", "user", "stack", "with", "the", "wrong", "GS", "because", "the", "kernel", "didn't", "expect", "exceptions", "on", "this", "instruction.", "This", "version", "of", "the", "patch", "has", "the", "teething", "problems", "that", "plagued", "an", "earlier", "version", "fixed.", "This", "is", "CVE-2006-0744", "Thanks", "to", "Ernie", "Petrides", "and", "Asit", "B.", "Mallick", "for", "analysis", "and", "initial", "patches.", "Signed-off-by:", "Andi", "Kleen", "<ak@suse.de>", "Signed-off-by:", "Linus", "Torvalds", "<torvalds@osdl.org>"], "code_tokens": ["@", "@", "-", "180", ",", "6", "+", "180", ",", "10", "@", "@", "rff_trace", ":", "*", "*", "XXX", "if", "we", "had", "a", "free", "scratch", "register", "we", "could", "save", "the", "RSP", "into", "the", "stack", "frame", "*", "and", "report", "it", "properly", "in", "ps", ".", "Unfortunately", "we", "haven", "'", "t", ".", "*", "*", "When", "user", "can", "change", "the", "frames", "always", "force", "IRET", ".", "That", "is", "because", "*", "it", "deals", "with", "uncanonical", "addresses", "better", ".", "SYSRET", "has", "trouble", "*", "with", "them", "due", "to", "bugs", "in", "both", "AMD", "and", "Intel", "CPUs", ".", "*", "/", "ENTRY", "(", "system_call", ")", "@", "@", "-", "254", ",", "7", "+", "258", ",", "10", "@", "@", "sysret_signal", ":", "xorl", "%", "esi", ",", "%", "esi", "#", "oldset", "-", ">", "arg2", "call", "ptregscall_common", "1", ":", "movl", "$", "_TIF_NEED_RESCHED", ",", "%", "edi", "jmp", "sysret_check", "/", "*", "Use", "IRET", "because", "user", "could", "have", "changed", "frame", ".", "This", "works", "because", "ptregscall_common", "has", "called", "FIXUP_TOP_OF_STACK", ".", "*", "/", "cli", "jmp", "int_with_check", "badsys", ":", "movq", "$", "-", "ENOSYS", ",", "RAX", "-", "ARGOFFSET", "(", "%", "rsp", ")", "@", "@", "-", "280", ",", "7", "+", "287", ",", "8", "@", "@", "tracesys", ":", "call", "syscall_trace_leave", "RESTORE_TOP_OF_STACK", "%", "rbx", "RESTORE_REST", "jmp", "ret_from_sys_call", "/", "*", "Use", "IRET", "because", "user", "could", "have", "changed", "frame", "*", "/", "jmp", "int_ret_from_sys_call", "CFI_ENDPROC", "/", "*"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Merge", "pull", "request", "#2", "from", "jenkinsci-cert/SECURITY-163", "[SECURITY-163]", "Non-browser-based", "DownloadService"], "code_tokens": ["@", "@", "-", "108", ",", "7", "+", "108", ",", "11", "@", "@", "import", "org", ".", "xml", ".", "sax", ".", "helpers", ".", "DefaultHandler", ";", "import", "static", "hudson", ".", "init", ".", "InitMilestone", ".", "*;", "import", "hudson", ".", "model", ".", "DownloadService", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "static", "java", ".", "util", ".", "logging", ".", "Level", ".", "WARNING", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "Restricted", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "restrictions", ".", "NoExternalUse", ";", "/", "**", "*", "Manages", "{", "@", "link", "PluginWrapper", "}", "s", ".", "@", "@", "-", "775", ",", "6", "+", "779", ",", "24", "@", "@", "public", "HttpResponse", "doUploadPlugin", "(", "StaplerRequest", "req", ")", "throws", "IOException", ",", "Servl", "}", "}", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "@", "RequirePOST", "public", "HttpResponse", "doCheckUpdatesServer", "(", ")", "throws", "IOException", "{", "for", "(", "UpdateSite", "site", ":", "Jenkins", ".", "getInstance", "(", ").", "getUpdateCenter", "(", ").", "getSites", "(", "))", "{", "FormValidation", "v", "=", "site", ".", "updateDirectlyNow", "(", "DownloadService", ".", "signatureCheck", ")", ";", "if", "(", "v", ".", "kind", "!", "=", "FormValidation", ".", "Kind", ".", "OK", ")", "{", "/", "/", "TODO", "crude", "but", "enough", "for", "now", "return", "v", ";", "}", "}", "for", "(", "DownloadService", ".", "Downloadable", "d", ":", "DownloadService", ".", "Downloadable", ".", "all", "(", "))", "{", "FormValidation", "v", "=", "d", ".", "updateNow", "(", ");", "if", "(", "v", ".", "kind", "!", "=", "FormValidation", ".", "Kind", ".", "OK", ")", "{", "return", "v", ";", "}", "}", "return", "HttpResponses", ".", "forwardToPreviousPage", "(", ");", "}", "protected", "String", "identifyPluginShortName", "(", "File", "t", ")", "{", "try", "{", "JarFile", "j", "=", "new", "JarFile", "(", "t", ")", ";", "@", "@", "-", "26", ",", "20", "+", "26", ",", "25", "@", "@", "import", "hudson", ".", "Extension", ";", "import", "hudson", ".", "ExtensionList", ";", "import", "hudson", ".", "ExtensionPoint", ";", "import", "hudson", ".", "ProxyConfiguration", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "hudson", ".", "util", ".", "FormValidation", ".", "Kind", ";", "import", "hudson", ".", "util", ".", "QuotedStringTokenizer", ";", "import", "hudson", ".", "util", ".", "TextFile", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "jenkins", ".", "util", ".", "JSONSignatureValidator", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONException", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "Stapler", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "net", ".", "URL", ";", "import", "java", ".", "net", ".", "URLEncoder", ";", "import", "java", ".", "util", ".", "logging", ".", "Logger", ";", "import", "jenkins", ".", "model", ".", "DownloadSettings", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "jenkins", ".", "util", ".", "JSONSignatureValidator", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONException", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONObject", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "Restricted", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "restrictions", ".", "NoExternalUse", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "Stapler", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerResponse", ";", "@", "@", "-", "62", ",", "6", "+", "67", ",", "9", "@", "@", "*", "Builds", "up", "an", "HTML", "fragment", "that", "starts", "all", "the", "download", "jobs", ".", "*", "/", "public", "String", "generateFragment", "(", ")", "{", "if", "(", "!", "DownloadSettings", ".", "usePostBack", "(", "))", "{", "return", "\"", "\";", "}", "if", "(", "neverUpdate", ")", "return", "\"", "\";", "if", "(", "doesNotSupportPostMessage", "(", "))", "return", "\"", "\";", "@", "@", "-", "135", ",", "6", "+", "143", ",", "58", "@", "@", "public", "Downloadable", "getById", "(", "String", "id", ")", "{", "return", "null", ";", "}", "/", "**", "*", "Loads", "JSON", "from", "a", "JSONP", "URL", ".", "*", "Metadata", "for", "downloadables", "and", "update", "centers", "is", "offered", "in", "two", "formats", ",", "both", "designed", "for", "download", "from", "the", "browser", "(", "predating", "{", "@", "link", "DownloadSettings", "}", "):", "*", "HTML", "using", "{", "@", "code", "postMessage", "}", "for", "newer", "browsers", ",", "and", "JSONP", "as", "a", "fallback", ".", "*", "Confusingly", ",", "the", "JSONP", "files", "are", "given", "the", "{", "@", "code", "*", ".", "json", "}", "file", "extension", ",", "when", "they", "are", "really", "JavaScript", "and", "should", "be", "{", "@", "code", "*", ".", "js", "}", ".", "*", "This", "method", "extracts", "the", "JSON", "from", "a", "JSONP", "URL", ",", "since", "that", "is", "what", "we", "actually", "want", "when", "we", "download", "from", "the", "server", ".", "*", "(", "Currently", "the", "true", "JSON", "is", "not", "published", "separately", ",", "and", "extracting", "from", "the", "{", "@", "code", "*", ".", "json", ".", "html", "}", "is", "more", "work", ".", ")", "*", "@", "param", "src", "a", "URL", "to", "a", "JSONP", "file", "(", "typically", "including", "{", "@", "code", "id", "}", "and", "{", "@", "code", "version", "}", "query", "parameters", ")", "*", "@", "return", "the", "embedded", "JSON", "text", "*", "@", "throws", "IOException", "if", "either", "downloading", "or", "processing", "failed", "*", "/", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "public", "static", "String", "loadJSON", "(", "URL", "src", ")", "throws", "IOException", "{", "InputStream", "is", "=", "ProxyConfiguration", ".", "open", "(", "src", ")", ".", "getInputStream", "(", ");", "try", "{", "String", "jsonp", "=", "IOUtils", ".", "toString", "(", "is", ",", "\"", "UTF", "-", "8", "\"", ");", "int", "start", "=", "jsonp", ".", "indexOf", "(", "'{", "')", ";", "int", "end", "=", "jsonp", ".", "lastIndexOf", "(", "'}", "')", ";", "if", "(", "start", ">", "=", "0", "&", "&", "end", ">", "start", ")", "{", "return", "jsonp", ".", "substring", "(", "start", ",", "end", "+", "1", ")", ";", "}", "else", "{", "throw", "new", "IOException", "(", "\"", "Could", "not", "find", "JSON", "in", "\"", "+", "src", ")", ";", "}", "}", "finally", "{", "is", ".", "close", "(", ");", "}", "}", "/", "**", "*", "Loads", "JSON", "from", "a", "JSON", "-", "with", "-", "{@", "code", "postMessage", "}", "URL", ".", "*", "@", "param", "src", "a", "URL", "to", "a", "JSON", "HTML", "file", "(", "typically", "including", "{", "@", "code", "id", "}", "and", "{", "@", "code", "version", "}", "query", "parameters", ")", "*", "@", "return", "the", "embedded", "JSON", "text", "*", "@", "throws", "IOException", "if", "either", "downloading", "or", "processing", "failed", "*", "/", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "public", "static", "String", "loadJSONHTML", "(", "URL", "src", ")", "throws", "IOException", "{", "InputStream", "is", "=", "ProxyConfiguration", ".", "open", "(", "src", ")", ".", "getInputStream", "(", ");", "try", "{", "String", "jsonp", "=", "IOUtils", ".", "toString", "(", "is", ",", "\"", "UTF", "-", "8", "\"", ");", "String", "preamble", "=", "\"", "window", ".", "parent", ".", "postMessage", "(", "JSON", ".", "stringify", "(", "\";", "int", "start", "=", "jsonp", ".", "indexOf", "(", "preamble", ")", ";", "int", "end", "=", "jsonp", ".", "lastIndexOf", "(", "\")", ",'", "*'", ");", "\")", ";", "if", "(", "start", ">", "=", "0", "&", "&", "end", ">", "start", ")", "{", "return", "jsonp", ".", "substring", "(", "start", "+", "preamble", ".", "length", "(", "),", "end", ")", ".", "trim", "(", ");", "}", "else", "{", "throw", "new", "IOException", "(", "\"", "Could", "not", "find", "JSON", "in", "\"", "+", "src", ")", ";", "}", "}", "finally", "{", "is", ".", "close", "(", ");", "}", "}", "/", "**", "*", "Represents", "a", "periodically", "updated", "JSON", "data", "file", "obtained", "from", "a", "remote", "URL", ".", "*", "@", "@", "-", "248", ",", "26", "+", "308", ",", "39", "@", "@", "public", "JSONObject", "getData", "(", ")", "throws", "IOException", "{", "*", "This", "is", "where", "the", "browser", "sends", "us", "the", "data", ".", "*", "/", "public", "void", "doPostBack", "(", "StaplerRequest", "req", ",", "StaplerResponse", "rsp", ")", "throws", "IOException", "{", "DownloadSettings", ".", "checkPostBackAccess", "(", ");", "long", "dataTimestamp", "=", "System", ".", "currentTimeMillis", "(", ");", "due", "=", "dataTimestamp", "+", "getInterval", "(", ");", "/", "/", "success", "or", "fail", ",", "don", "'", "t", "try", "too", "often", "String", "json", "=", "IOUtils", ".", "toString", "(", "req", ".", "getInputStream", "(", "),", "\"", "UTF", "-", "8", "\"", ");", "FormValidation", "e", "=", "load", "(", "json", ",", "dataTimestamp", ")", ";", "if", "(", "e", ".", "kind", "!", "=", "Kind", ".", "OK", ")", "{", "LOGGER", ".", "severe", "(", "e", ".", "renderHtml", "(", "))", ";", "throw", "e", ";", "}", "rsp", ".", "setContentType", "(", "\"", "text", "/", "plain", "\"", ");", "/", "/", "So", "browser", "won", "'", "t", "try", "to", "parse", "response", "}", "private", "FormValidation", "load", "(", "String", "json", ",", "long", "dataTimestamp", ")", "throws", "IOException", "{", "JSONObject", "o", "=", "JSONObject", ".", "fromObject", "(", "json", ")", ";", "if", "(", "signatureCheck", ")", "{", "FormValidation", "e", "=", "new", "JSONSignatureValidator", "(", "\"", "downloadable", "'", "\"+", "id", "+", "\"'", "\")", ".", "verifySignature", "(", "o", ")", ";", "if", "(", "e", ".", "kind", "!", "=", "Kind", ".", "OK", ")", "{", "LOGGER", ".", "severe", "(", "e", ".", "renderHtml", "(", "))", ";", "throw", "e", ";", "return", "e", ";", "}", "}", "TextFile", "df", "=", "getDataFile", "(", ");", "df", ".", "write", "(", "json", ")", ";", "df", ".", "file", ".", "setLastModified", "(", "dataTimestamp", ")", ";", "LOGGER", ".", "info", "(", "\"", "Obtained", "the", "updated", "data", "file", "for", "\"", "+", "id", ")", ";", "return", "FormValidation", ".", "ok", "(", ");", "}", "rsp", ".", "setContentType", "(", "\"", "text", "/", "plain", "\"", ");", "/", "/", "So", "browser", "won", "'", "t", "try", "to", "parse", "response", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "public", "FormValidation", "updateNow", "(", ")", "throws", "IOException", "{", "return", "load", "(", "loadJSONHTML", "(", "new", "URL", "(", "getUrl", "(", ")", "+", "\"", ".", "html", "?", "id", "=", "\"", "+", "URLEncoder", ".", "encode", "(", "getId", "(", "),", "\"", "UTF", "-", "8", "\"", ")", "+", "\"", "&", "version", "=", "\"", "+", "URLEncoder", ".", "encode", "(", "Jenkins", ".", "VERSION", ",", "\"", "UTF", "-", "8", "\"", "))", "),", "System", ".", "currentTimeMillis", "(", "))", ";", "}", "/", "**", "@", "@", "-", "296", ",", "7", "+", "369", ",", "10", "@", "@", "public", "static", "Downloadable", "get", "(", "String", "id", ")", "{", "public", "static", "boolean", "neverUpdate", "=", "Boolean", ".", "getBoolean", "(", "DownloadService", ".", "class", ".", "getName", "(", ")+", "\".", "never", "\"", ");", "/", "**", "*", "Off", "by", "default", "until", "we", "know", "this", "is", "reasonably", "working", ".", "*", "May", "be", "used", "to", "temporarily", "disable", "signature", "checking", "on", "{", "@", "link", "DownloadService", "}", "and", "{", "@", "link", "UpdateCenter", "}", ".", "*", "Useful", "when", "upstream", "signatures", "are", "broken", ",", "such", "as", "due", "to", "expired", "certificates", ".", "*", "Should", "only", "be", "used", "when", "{", "@", "link", "DownloadSettings", "#", "isUseBrowser", "}", ";", "*", "disabling", "signature", "checks", "for", "in", "-", "browser", "downloads", "is", "<", "em", ">", "very", "dangerous", "<", "/", "em", ">", "as", "unprivileged", "users", "could", "submit", "spoofed", "metadata", "!", "*", "/", "public", "static", "boolean", "signatureCheck", "=", "!", "Boolean", ".", "getBoolean", "(", "DownloadService", ".", "class", ".", "getName", "(", ")+", "\".", "noSignatureCheck", "\"", ");", "}", "@", "@", "-", "630", ",", "7", "+", "630", ",", "7", "@", "@", "private", "static", "String", "getCategoryDisplayName", "(", "String", "category", ")", "{", "public", "List", "<", "FormValidation", ">", "updateAllSites", "(", ")", "throws", "InterruptedException", ",", "ExecutionException", "{", "List", "<", "Future", "<", "FormValidation", ">", ">", "futures", "=", "new", "ArrayList", "<", "Future", "<", "FormValidation", ">", ">(", ");", "for", "(", "UpdateSite", "site", ":", "getSites", "(", "))", "{", "Future", "<", "FormValidation", ">", "future", "=", "site", ".", "updateDirectly", "(", "true", ")", ";", "Future", "<", "FormValidation", ">", "future", "=", "site", ".", "updateDirectly", "(", "DownloadService", ".", "signatureCheck", ")", ";", "if", "(", "future", "!", "=", "null", ")", "{", "futures", ".", "add", "(", "future", ")", ";", "}", "@", "@", "-", "27", ",", "32", "+", "27", ",", "18", "@", "@", "import", "hudson", ".", "PluginManager", ";", "import", "hudson", ".", "PluginWrapper", ";", "import", "hudson", ".", "ProxyConfiguration", ";", "import", "hudson", ".", "lifecycle", ".", "Lifecycle", ";", "import", "hudson", ".", "model", ".", "UpdateCenter", ".", "UpdateCenterJob", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "hudson", ".", "util", ".", "FormValidation", ".", "Kind", ";", "import", "hudson", ".", "util", ".", "HttpResponses", ";", "import", "hudson", ".", "util", ".", "TextFile", ";", "import", "static", "hudson", ".", "util", ".", "TimeUnit2", ".", "*;", "import", "hudson", ".", "util", ".", "VersionNumber", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "jenkins", ".", "util", ".", "JSONSignatureValidator", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONException", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONObject", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang", ".", "StringUtils", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "DataBoundConstructor", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "HttpResponse", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "export", ".", "Exported", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "export", ".", "ExportedBean", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "interceptor", ".", "RequirePOST", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "net", ".", "URI", ";", "import", "java", ".", "net", ".", "URL", ";", "import", "java", ".", "net", ".", "URLConnection", ";", "import", "java", ".", "net", ".", "URLEncoder", ";", "import", "java", ".", "security", ".", "GeneralSecurityException", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "@", "@", "-", "66", ",", "10", "+", "52", ",", "23", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "Future", ";", "import", "java", ".", "util", ".", "logging", ".", "Level", ";", "import", "java", ".", "util", ".", "logging", ".", "Logger", ";", "import", "static", "hudson", ".", "util", ".", "TimeUnit2", ".", "*;", "import", "org", ".", "apache", ".", "commons", ".", "io", ".", "IOUtils", ";", "import", "javax", ".", "annotation", ".", "CheckForNull", ";", "import", "javax", ".", "annotation", ".", "Nonnull", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "jenkins", ".", "model", ".", "DownloadSettings", ";", "import", "jenkins", ".", "util", ".", "JSONSignatureValidator", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONException", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONObject", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang", ".", "StringUtils", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "Restricted", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "restrictions", ".", "NoExternalUse", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "DataBoundConstructor", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "HttpResponse", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "export", ".", "Exported", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "export", ".", "ExportedBean", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "interceptor", ".", "RequirePOST", ";", "/", "**", "*", "Source", "of", "the", "update", "center", "information", ",", "like", "\"", "http", ":", "//", "jenkins", "-", "ci", ".", "org", "/", "update", "-", "center", ".", "json", "\"", "@", "@", "-", "154", ",", "42", "+", "153", ",", "28", "@", "@", "public", "long", "getDataTimestamp", "(", ")", "{", "*", "@", "return", "null", "if", "no", "updates", "are", "necessary", ",", "or", "the", "future", "result", "*", "@", "since", "1", ".", "502", "*", "/", "public", "Future", "<", "FormValidation", ">", "updateDirectly", "(", "final", "boolean", "signatureCheck", ")", "{", "public", "@", "CheckForNull", "Future", "<", "FormValidation", ">", "updateDirectly", "(", "final", "boolean", "signatureCheck", ")", "{", "if", "(", "!", "getDataFile", "(", ").", "exists", "(", ")", "|", "|", "isDue", "(", "))", "{", "return", "Jenkins", ".", "getInstance", "(", ").", "getUpdateCenter", "(", ").", "updateService", ".", "submit", "(", "new", "Callable", "<", "FormValidation", ">", "()", "{", "public", "FormValidation", "call", "(", ")", "throws", "Exception", "{", "URL", "src", "=", "new", "URL", "(", "getUrl", "(", ")", "+", "\"", "?", "id", "=", "\"", "+", "URLEncoder", ".", "encode", "(", "getId", "(", "),", "\"", "UTF", "-", "8", "\"", ")", "+", "\"", "&", "version", "=", "\"+", "URLEncoder", ".", "encode", "(", "Jenkins", ".", "VERSION", ",", "\"", "UTF", "-", "8", "\"", "))", ";", "URLConnection", "conn", "=", "ProxyConfiguration", ".", "open", "(", "src", ")", ";", "InputStream", "is", "=", "conn", ".", "getInputStream", "(", ");", "try", "{", "String", "uncleanJson", "=", "IOUtils", ".", "toString", "(", "is", ",", "\"", "UTF", "-", "8", "\"", ");", "int", "jsonStart", "=", "uncleanJson", ".", "indexOf", "(", "\"{", "\\\"", "\")", ";", "if", "(", "jsonStart", ">", "=", "0", ")", "{", "uncleanJson", "=", "uncleanJson", ".", "substring", "(", "jsonStart", ")", ";", "int", "end", "=", "uncleanJson", ".", "lastIndexOf", "(", "'}", "')", ";", "if", "(", "end", ">", "0", ")", "uncleanJson", "=", "uncleanJson", ".", "substring", "(", "0", ",", "end", "+", "1", ")", ";", "return", "updateData", "(", "uncleanJson", ",", "signatureCheck", ")", ";", "}", "else", "{", "throw", "new", "IOException", "(", "\"", "Could", "not", "find", "json", "in", "content", "of", "\"", "+", "\"", "update", "center", "from", "url", ":", "\"", "+", "src", ".", "toExternalForm", "(", "))", ";", "}", "}", "finally", "{", "if", "(", "is", "!", "=", "null", ")", "is", ".", "close", "(", ");", "}", "@", "Override", "public", "FormValidation", "call", "(", ")", "throws", "Exception", "{", "return", "updateDirectlyNow", "(", "signatureCheck", ")", ";", "}", "}", ");", "}", "}", "else", "{", "return", "null", ";", "}", "}", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "public", "@", "Nonnull", "FormValidation", "updateDirectlyNow", "(", "boolean", "signatureCheck", ")", "throws", "IOException", "{", "return", "updateData", "(", "DownloadService", ".", "loadJSON", "(", "new", "URL", "(", "getUrl", "(", ")", "+", "\"", "?", "id", "=", "\"", "+", "URLEncoder", ".", "encode", "(", "getId", "(", "),", "\"", "UTF", "-", "8", "\"", ")", "+", "\"", "&", "version", "=", "\"", "+", "URLEncoder", ".", "encode", "(", "Jenkins", ".", "VERSION", ",", "\"", "UTF", "-", "8", "\"", "))", "),", "signatureCheck", ")", ";", "}", "/", "**", "*", "This", "is", "the", "endpoint", "that", "receives", "the", "update", "center", "data", "file", "from", "the", "browser", ".", "*", "/", "public", "FormValidation", "doPostBack", "(", "StaplerRequest", "req", ")", "throws", "IOException", ",", "GeneralSecurityException", "{", "DownloadSettings", ".", "checkPostBackAccess", "(", ");", "return", "updateData", "(", "IOUtils", ".", "toString", "(", "req", ".", "getInputStream", "(", "),", "\"", "UTF", "-", "8", "\"", "),", "true", ")", ";", "}", "@", "@", "-", "239", ",", "9", "+", "239", ",", "13", "@", "@", "private", "static", "FormValidation", "_errorWithMarkup", "(", "final", "String", "message", ",", "final", "Kind", "return", "ok", "(", ");", "return", "new", "FormValidation", "(", "kind", ",", "message", ")", "{", "public", "String", "renderHtml", "(", ")", "{", "StaplerRequest", "req", "=", "Stapler", ".", "getCurrentRequest", "(", ");", "if", "(", "req", "=", "=", "null", ")", "{", "/", "/", "being", "called", "from", "some", "other", "context", "return", "message", ";", "}", "/", "/", "1x16", "spacer", "needed", "for", "IE", "since", "it", "doesn", "'", "t", "support", "min", "-", "height", "return", "\"", "<", "div", "class", "=", "\"+", "kind", ".", "name", "(", ").", "toLowerCase", "(", "Locale", ".", "ENGLISH", ")", "+", "\">", "<", "img", "src", "=", "'\"", "+", "Stapler", ".", "getCurrentRequest", "(", ").", "getContextPath", "(", ")+", "Jenkins", ".", "RESOURCE_PATH", "+", "\"/", "images", "/", "none", ".", "gif", "'", "height", "=", "16", "width", "=", "1", ">", "\"+", "req", ".", "getContextPath", "(", ")+", "Jenkins", ".", "RESOURCE_PATH", "+", "\"/", "images", "/", "none", ".", "gif", "'", "height", "=", "16", "width", "=", "1", ">", "\"", "message", "+", "\"<", "/", "div", ">", "\";", "}", "@", "Override", "public", "String", "toString", "(", ")", "{", "@", "@", "-", "0", ",", "0", "+", "1", ",", "134", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "2014", "Jesse", "Glick", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "jenkins", ".", "model", ";", "import", "hudson", ".", "Extension", ";", "import", "hudson", ".", "Main", ";", "import", "hudson", ".", "model", ".", "AdministrativeMonitor", ";", "import", "hudson", ".", "model", ".", "AsyncPeriodicWork", ";", "import", "hudson", ".", "model", ".", "DownloadService", ";", "import", "hudson", ".", "model", ".", "TaskListener", ";", "import", "hudson", ".", "model", ".", "UpdateSite", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONObject", ";", "import", "org", ".", "acegisecurity", ".", "AccessDeniedException", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "Restricted", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "restrictions", ".", "NoExternalUse", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "HttpResponse", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "/", "**", "*", "Lets", "user", "configure", "how", "metadata", "files", "should", "be", "downloaded", ".", "*", "@", "see", "UpdateSite", "*", "@", "see", "DownloadService", "*", "/", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "/", "/", "no", "clear", "reason", "for", "this", "to", "be", "an", "API", "@", "Extension", "public", "final", "class", "DownloadSettings", "extends", "GlobalConfiguration", "{", "public", "static", "DownloadSettings", "get", "(", ")", "{", "return", "Jenkins", ".", "getInstance", "(", ").", "getInjector", "(", ").", "getInstance", "(", "DownloadSettings", ".", "class", ")", ";", "}", "private", "boolean", "useBrowser", "=", "false", ";", "public", "DownloadSettings", "(", ")", "{", "load", "(", ");", "}", "@", "Override", "public", "boolean", "configure", "(", "StaplerRequest", "req", ",", "JSONObject", "json", ")", "throws", "FormException", "{", "req", ".", "bindJSON", "(", "this", ",", "json", ")", ";", "return", "true", ";", "}", "public", "boolean", "isUseBrowser", "(", ")", "{", "return", "useBrowser", ";", "}", "public", "void", "setUseBrowser", "(", "boolean", "useBrowser", ")", "{", "this", ".", "useBrowser", "=", "useBrowser", ";", "save", "(", ");", "}", "@", "Override", "public", "GlobalConfigurationCategory", "getCategory", "(", ")", "{", "return", "GlobalConfigurationCategory", ".", "get", "(", "GlobalConfigurationCategory", ".", "Security", ".", "class", ")", ";", "}", "public", "static", "boolean", "usePostBack", "(", ")", "{", "return", "get", "(", ").", "isUseBrowser", "(", ")", "&", "&", "Jenkins", ".", "getInstance", "(", ").", "hasPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "}", "public", "static", "void", "checkPostBackAccess", "(", ")", "throws", "AccessDeniedException", "{", "if", "(", "!", "get", "(", ").", "isUseBrowser", "(", "))", "{", "throw", "new", "AccessDeniedException", "(", "\"", "browser", "-", "based", "download", "disabled", "\"", ");", "}", "Jenkins", ".", "getInstance", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "}", "@", "Extension", "public", "static", "final", "class", "DailyCheck", "extends", "AsyncPeriodicWork", "{", "public", "DailyCheck", "(", ")", "{", "super", "(", "\"", "Download", "metadata", "\"", ");", "}", "@", "Override", "public", "long", "getRecurrencePeriod", "(", ")", "{", "return", "DAY", ";", "}", "@", "Override", "public", "long", "getInitialDelay", "(", ")", "{", "return", "Main", ".", "isUnitTest", "?", "DAY", ":", "0", ";", "}", "@", "Override", "protected", "void", "execute", "(", "TaskListener", "listener", ")", "throws", "IOException", ",", "InterruptedException", "{", "if", "(", "get", "(", ").", "isUseBrowser", "(", "))", "{", "return", ";", "}", "boolean", "due", "=", "false", ";", "for", "(", "UpdateSite", "site", ":", "Jenkins", ".", "getInstance", "(", ").", "getUpdateCenter", "(", ").", "getSites", "(", "))", "{", "if", "(", "site", ".", "isDue", "(", "))", "{", "due", "=", "true", ";", "break", ";", "}", "}", "if", "(", "!", "due", ")", "{", "return", ";", "}", "HttpResponse", "rsp", "=", "Jenkins", ".", "getInstance", "(", ").", "getPluginManager", "(", ").", "doCheckUpdatesServer", "(", ");", "if", "(", "rsp", "instanceof", "FormValidation", ")", "{", "listener", ".", "error", "(", "((", "FormValidation", ")", "rsp", ")", ".", "renderHtml", "(", "))", ";", "}", "}", "}", "@", "Extension", "public", "static", "final", "class", "Warning", "extends", "AdministrativeMonitor", "{", "@", "Override", "public", "boolean", "isActivated", "(", ")", "{", "return", "DownloadSettings", ".", "get", "(", ").", "isUseBrowser", "(", ");", "}", "}", "}", "@", "@", "-", "73", ",", "6", "+", "73", ",", "9", "@", "@", "public", "FormValidation", "verifySignature", "(", "JSONObject", "o", ")", "throws", "IOException", "{", "/", "/", "which", "isn", "'", "t", "useful", "at", "all", "Set", "<", "TrustAnchor", ">", "anchors", "=", "new", "HashSet", "<", "TrustAnchor", ">", "()", ";", "/", "/", "CertificateUtil", ".", "getDefaultRootCAs", "(", ");", "Jenkins", "j", "=", "Jenkins", ".", "getInstance", "(", ");", "if", "(", "j", "=", "=", "null", ")", "{", "return", "FormValidation", ".", "error", "(", "\"", "Jenkins", "has", "shut", "down", ",", "cannot", "find", "root", "CAs", "\"", ");", "}", "for", "(", "String", "cert", ":", "(", "Set", "<", "String", ">", ")", "j", ".", "servletContext", ".", "getResourcePaths", "(", "\"/", "WEB", "-", "INF", "/", "update", "-", "center", "-", "rootCAs", "\"", "))", "{", "if", "(", "cert", ".", "endsWith", "(", "\".", "txt", "\"", "))", "continue", ";", "/", "/", "skip", "text", "files", "that", "are", "meant", "to", "be", "documentation", "anchors", ".", "add", "(", "new", "TrustAnchor", "(", "(", "X509Certificate", ")", "cf", ".", "generateCertificate", "(", "j", ".", "servletContext", ".", "getResourceAsStream", "(", "cert", ")", "),", "null", ")", ");", "@", "@", "-", "96", ",", "7", "+", "96", ",", "8", "@", "@", "THE", "SOFTWARE", ".", "<", "/", "tr", ">", "<", "/", "table", ">", "<", "div", "align", "=", "\"", "right", "\"", "style", "=", "\"", "margin", "-", "top", ":", "1em", "\"", ">", "<", "form", "method", "=", "\"", "post", "\"", "action", "=", "\"", "checkUpdates", "\"", ">", "<", "j", ":", "invokeStatic", "var", "=", "\"", "ds", "\"", "className", "=", "\"", "jenkins", ".", "model", ".", "DownloadSettings", "\"", "method", "=", "\"", "get", "\"", "/>", "<", "form", "method", "=", "\"", "post", "\"", "action", "=", "\"$", "{", "ds", ".", "useBrowser", "?", "'", "checkUpdates", "'", ":", "'", "checkUpdatesServer", "'", "}\"", ">", "$", "{%", "lastUpdated", "(", "app", ".", "updateCenter", ".", "lastUpdatedString", ")", "}", "<", "f", ":", "submit", "value", "=", "\"$", "{%", "Check", "now", "}", "\"", "/", ">", "<", "/", "form", ">", "@", "@", "-", "31", ",", "6", "+", "31", ",", "8", "@", "@", "THE", "SOFTWARE", ".", "-", "->", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "st", "=", "\"", "jelly", ":", "stapler", "\"", "xmlns", ":", "d", "=", "\"", "jelly", ":", "define", "\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "xmlns", ":", "t", "=", "\"/", "lib", "/", "hudson", "\"", "xmlns", ":", "f", "=", "\"/", "lib", "/", "form", "\"", ">", "<", "j", ":", "invokeStatic", "var", "=", "\"", "enabled", "\"", "className", "=", "\"", "jenkins", ".", "model", ".", "DownloadSettings", "\"", "method", "=", "\"", "usePostBack", "\"", "/>", "<", "j", ":", "if", "test", "=", "\"$", "{", "enabled", "}", "\">", "<", "j", ":", "forEach", "var", "=", "\"", "site", "\"", "items", "=", "\"$", "{", "app", ".", "updateCenter", ".", "sites", "}", "\">", "<", "j", ":", "if", "test", "=", "\"$", "{", "site", ".", "due", "or", "forcedUpdateCheck", "}", "\">", "<", "script", ">", "@", "@", "-", "45", ",", "4", "+", "47", ",", "5", "@", "@", "THE", "SOFTWARE", ".", "<", "/", "script", ">", "<", "/", "j", ":", "if", ">", "<", "/", "j", ":", "forEach", ">", "<", "/", "j", ":", "if", ">", "<", "/", "j", ":", "jelly", ">", "@", "@", "-", "0", ",", "0", "+", "1", ",", "34", "@", "@", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "?>", "<", "!-", "-", "The", "MIT", "License", "Copyright", "2015", "Jesse", "Glick", ".", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", "-", "->", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "f", "=", "\"/", "lib", "/", "form", "\"", ">", "<", "div", "class", "=", "\"", "warning", "\"", ">", "<", "form", "method", "=", "\"", "post", "\"", "action", "=", "\"$", "{", "rootURL", "}", "/$", "{", "it", ".", "url", "}", "/", "disable", "\"", ">", "<", "j", ":", "out", "value", "=", "\"$", "{%", "blurb", "(", "rootURL", ")", "}\"", "/>", "<", "f", ":", "submit", "value", "=", "\"$", "{%", "Dismiss", "}", "\"/", ">", "<", "/", "form", ">", "<", "/", "div", ">", "<", "/", "j", ":", "jelly", ">", "@", "@", "-", "0", ",", "0", "+", "1", ",", "26", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "2015", "Jesse", "Glick", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "blurb", "=", "\\", "You", "currently", "are", "using", "browser", "-", "based", "download", "to", "retrieve", "metadata", "for", "Jenkins", "plugins", "and", "tools", ".", "\\", "This", "has", "reliability", "issues", "and", "is", "not", "considered", "fully", "secure", ".", "\\", "Consider", "<", "a", "href", "=", "\"{", "0", "}", "/", "configureSecurity", "\"", ">", "switching", "to", "server", "-", "based", "download", "<", "/", "a", ">", ".", "@", "@", "-", "0", ",", "0", "+", "1", ",", "8", "@", "@", "package", "jenkins", ".", "security", ".", "DownloadSettings", "def", "f", "=", "namespace", "(", "lib", ".", "FormTagLib", ")", "/", "/", "TODO", "avoid", "indentation", "somehow", "f", ".", "entry", "(", "field", ":", "\"", "useBrowser", "\"", ")", "{", "f", ".", "checkbox", "(", "title", ":", "_", "(", "\"", "Use", "browser", "for", "metadata", "download", "\"", "))", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "10", "@", "@", "<", "p", ">", "Check", "to", "force", "the", "user", "\u2019", "s", "browser", "to", "download", "metadata", "rather", "than", "Jenkins", "itself", "doing", "it", ".", "Actual", "file", "downloads", "(", "plugins", ",", "tools", ")", "will", "still", "happen", "from", "Jenkins", "itself", ",", "but", "this", "can", "be", "used", "to", "at", "least", "<", "em", ">", "see", "<", "/", "em", ">", "new", "metadata", "when", "Jenkins", "cannot", "access", "the", "Internet", "(", "but", "your", "own", "browser", "can", ",", "perhaps", "using", "some", "special", "proxy", "that", "Jenkins", "is", "not", "configured", "to", "use", ")", ".", "<", "/", "p", ">", "<", "p", ">", "Use", "of", "browser", "mode", "is", "discouraged", ".", "It", "has", "robustness", "problems", "and", "has", "been", "limited", "to", "users", "with", "Overall", "/", "Administer", ".", "<", "/", "p", ">", "@", "@", "-", "197", ",", "7", "+", "197", ",", "6", "@", "@", "THE", "SOFTWARE", ".", "<", "/", "systemPropertyVariables", ">", "<", "reuseForks", ">", "true", "<", "/", "reuseForks", ">", "<", "forkCount", ">", "${", "concurrency", "}", "</", "forkCount", ">", "<", "redirectTestOutputToFile", ">", "true", "<", "/", "redirectTestOutputToFile", ">", "<", "/", "configuration", ">", "<", "/", "plugin", ">", "<", "plugin", ">", "@", "@", "-", "257", ",", "6", "+", "256", ",", "17", "@", "@", "THE", "SOFTWARE", ".", "<", "skipTests", ">", "true", "<", "/", "skipTests", ">", "<", "/", "properties", ">", "<", "/", "profile", ">", "<", "profile", ">", "<", "id", ">", "all", "-", "tests", "<", "/", "id", ">", "<", "activation", ">", "<", "property", ">", "<", "name", ">", "!", "test", "<", "/", "name", ">", "<", "/", "property", ">", "<", "/", "activation", ">", "<", "properties", ">", "<", "maven", ".", "test", ".", "redirectTestOutputToFile", ">", "true", "<", "/", "maven", ".", "test", ".", "redirectTestOutputToFile", ">", "<", "/", "properties", ">", "<", "/", "profile", ">", "<", "profile", ">", "<", "!-", "-", "Obtain", "code", "coverage", "report", ".", "This", "is", "done", "by", "running", "Unit", "tests", "on", "our", "own", "and", "suppressing", "surefire", ".", "@", "@", "-", "0", ",", "0", "+", "1", ",", "64", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "2015", "Jesse", "Glick", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "model", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "java", ".", "net", ".", "URL", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "TreeSet", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONObject", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*;", "import", "org", ".", "junit", ".", "Rule", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "JenkinsRule", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "WithoutJenkins", ";", "/", "/@", "Issue", "(", "\"", "SECURITY", "-", "163", "\"", ")", "public", "class", "DownloadService2Test", "{", "@", "Rule", "public", "JenkinsRule", "r", "=", "new", "JenkinsRule", "(", ");", "@", "Test", "public", "void", "updateNow", "(", ")", "throws", "Exception", "{", "for", "(", "DownloadService", ".", "Downloadable", "d", ":", "DownloadService", ".", "Downloadable", ".", "all", "(", "))", "{", "FormValidation", "v", "=", "d", ".", "updateNow", "(", ");", "assertEquals", "(", "v", ".", "toString", "(", "),", "FormValidation", ".", "Kind", ".", "OK", ",", "v", ".", "kind", ")", ";", "}", "}", "@", "WithoutJenkins", "@", "Test", "public", "void", "loadJSONHTML", "(", ")", "throws", "Exception", "{", "assertRoots", "(", "\"[", "list", ",", "signature", "]", "\",", "\"", "hudson", ".", "tasks", ".", "Maven", ".", "MavenInstaller", ".", "json", ".", "html", "\"", ");", "/", "/", "format", "used", "by", "most", "tools", "assertRoots", "(", "\"[", "data", ",", "signature", ",", "version", "]", "\",", "\"", "hudson", ".", "tools", ".", "JDKInstaller", ".", "json", ".", "html", "\"", ");", "/", "/", "anomalous", "format", "}", "private", "static", "void", "assertRoots", "(", "String", "expected", ",", "String", "file", ")", "throws", "Exception", "{", "URL", "resource", "=", "DownloadService2Test", ".", "class", ".", "getResource", "(", "file", ")", ";", "assertNotNull", "(", "file", ",", "resource", ")", ";", "JSONObject", "json", "=", "JSONObject", ".", "fromObject", "(", "DownloadService", ".", "loadJSONHTML", "(", "resource", ")", ");", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Set", "<", "String", ">", "keySet", "=", "json", ".", "keySet", "(", ");", "assertEquals", "(", "expected", ",", "new", "TreeSet", "<", "String", ">", "(", "keySet", ")", ".", "toString", "(", "))", ";", "}", "}", "@", "@", "-", "1", ",", "13", "+", "1", ",", "17", "@", "@", "package", "hudson", ".", "model", ";", "import", "hudson", ".", "model", ".", "DownloadService", ".", "Downloadable", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "net", ".", "URL", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "TreeSet", ";", "import", "jenkins", ".", "model", ".", "DownloadSettings", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONObject", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "Bug", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "HudsonTestCase", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "WithoutJenkins", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerResponse", ";", "import", "java", ".", "io", ".", "IOException", ";", "/", "**", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "@", "@", "-", "20", ",", "16", "+", "24", ",", "14", "@", "@", "@", "Override", "protected", "void", "setUp", "(", ")", "throws", "Exception", "{", "super", ".", "setUp", "(", ");", "if", "(", "jenkins", "=", "=", "null", ")", "{", "return", ";", "}", "/", "/", "this", "object", "receives", "the", "submission", ".", "/", "/", "to", "bypass", "the", "URL", "restriction", ",", "we", "'", "ll", "trigger", "downloadService", ".", "download", "ourselves", "job", "=", "new", "Downloadable", "(", "\"", "test", "\"", ",", "\"", "UNUSED", "\"", ");", "Downloadable", ".", "all", "(", ").", "add", "(", "job", ")", ";", "}", "@", "Override", "protected", "void", "tearDown", "(", ")", "throws", "Exception", "{", "Downloadable", ".", "all", "(", ").", "remove", "(", "job", ")", ";", "super", ".", "tearDown", "(", ");", "DownloadSettings", ".", "get", "(", ").", "setUseBrowser", "(", "true", ")", ";", "}", "@", "Bug", "(", "5536", ")", "@", "@", "-", "59", ",", "4", "+", "61", ",", "20", "@", "@", "public", "void", "doData", "(", "StaplerResponse", "rsp", ")", "throws", "IOException", "{", "rsp", ".", "setContentType", "(", "\"", "application", "/", "javascript", "\"", ");", "rsp", ".", "getWriter", "(", ").", "println", "(", "\"", "downloadService", ".", "post", "(", "'", "test", "'", ",{", "'", "hello", "'", ":\"", "+", "hashCode", "(", ")+", "\"}", ")\"", ");", "}", "@", "WithoutJenkins", "/", "/", "could", "have", "been", "in", "core", "/", "src", "/", "test", "/", "but", "update", "-", "center", ".", "json", "was", "already", "in", "test", "/", "src", "/", "test", "/", "(", "used", "by", "UpdateSiteTest", ")", "public", "void", "testLoadJSON", "(", ")", "throws", "Exception", "{", "assertRoots", "(", "\"[", "list", "]", "\",", "\"", "hudson", ".", "tasks", ".", "Maven", ".", "MavenInstaller", ".", "json", "\"", ");", "/", "/", "format", "used", "by", "most", "tools", "assertRoots", "(", "\"[", "data", ",", "version", "]", "\",", "\"", "hudson", ".", "tools", ".", "JDKInstaller", ".", "json", "\"", ");", "/", "/", "anomalous", "format", "assertRoots", "(", "\"[", "connectionCheckUrl", ",", "core", ",", "id", ",", "plugins", ",", "signature", ",", "updateCenterVersion", "]", "\",", "\"", "update", "-", "center", ".", "json", "\"", ");", "}", "private", "static", "void", "assertRoots", "(", "String", "expected", ",", "String", "file", ")", "throws", "Exception", "{", "URL", "resource", "=", "DownloadServiceTest", ".", "class", ".", "getResource", "(", "file", ")", ";", "assertNotNull", "(", "file", ",", "resource", ")", ";", "JSONObject", "json", "=", "JSONObject", ".", "fromObject", "(", "DownloadService", ".", "loadJSON", "(", "resource", ")", ");", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Set", "<", "String", ">", "keySet", "=", "json", ".", "keySet", "(", ");", "assertEquals", "(", "expected", ",", "new", "TreeSet", "<", "String", ">", "(", "keySet", ")", ".", "toString", "(", "))", ";", "}", "}", "@", "@", "-", "26", ",", "7", "+", "26", ",", "6", "@", "@", "import", "com", ".", "trilead", ".", "ssh2", ".", "crypto", ".", "Base64", ";", "import", "hudson", ".", "util", ".", "TimeUnit2", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONObject", ";", "import", "org", ".", "apache", ".", "commons", ".", "io", ".", "IOUtils", ";", "import", "java", ".", "io", ".", "ByteArrayInputStream", ";", "import", "java", ".", "net", ".", "URL", ";", "@", "@", "-", "57", ",", "8", "+", "56", ",", "8", "@", "@", "}", "private", "void", "doData", "(", "String", "location", ")", "throws", "Exception", "{", "URL", "url", "=", "new", "URL", "(", "location", ")", ";", "String", "jsonp", "=", "IOUtils", ".", "toString", "(", "url", ".", "openStream", "(", "))", ";", "JSONObject", "json", "=", "JSONObject", ".", "fromObject", "(", "jsonp", ".", "substring", "(", "jsonp", ".", "indexOf", "(", "'(", "')", "+", "1", ",", "jsonp", ".", "lastIndexOf", "(", "')", "')", "))", ";", "String", "jsonp", "=", "DownloadService", ".", "loadJSON", "(", "url", ")", ";", "JSONObject", "json", "=", "JSONObject", ".", "fromObject", "(", "jsonp", ")", ";", "UpdateSite", "us", "=", "new", "UpdateSite", "(", "\"", "default", "\"", ",", "url", ".", "toExternalForm", "(", "))", ";", "UpdateSite", ".", "Data", "data", "=", "us", ".", "new", "Data", "(", "json", ")", ";", "@", "@", "-", "128", ",", "10", "+", "128", ",", "4", "@", "@", "public", "void", "shutdownWebserver", "(", ")", "throws", "Exception", "{", "assertNotNull", "(", "us", ".", "getPlugin", "(", "\"", "AdaptivePlugin", "\"", "))", ";", "}", "@", "Test", "public", "void", "updateDirectlyWithHtml", "(", ")", "throws", "Exception", "{", "UpdateSite", "us", "=", "new", "UpdateSite", "(", "\"", "default", "\"", ",", "new", "URL", "(", "baseUrl", ",", "\"", "update", "-", "center", ".", "json", ".", "html", "\"", ").", "toExternalForm", "(", "))", ";", "assertNull", "(", "us", ".", "getPlugin", "(", "\"", "AdaptivePlugin", "\"", "))", ";", "assertEquals", "(", "FormValidation", ".", "ok", "(", "),", "us", ".", "updateDirectly", "(", "false", ")", ".", "get", "(", "))", ";", "assertNotNull", "(", "us", ".", "getPlugin", "(", "\"", "AdaptivePlugin", "\"", "))", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "137", "@", "@", "downloadService", ".", "post", "(", "'", "hudson", ".", "tasks", ".", "Maven", ".", "MavenInstaller", "'", ",{", "\"", "list", "\"", ":", "[", "{", "\"", "id", "\"", ":", "\"", "3", ".", "1", ".", "1", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "1", ".", "1", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "1", ".", "1", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "3", ".", "1", ".", "0", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "1", ".", "0", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "1", ".", "0", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "3", ".", "0", ".", "5", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "0", ".", "5", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "0", ".", "5", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "3", ".", "0", ".", "4", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "0", ".", "4", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "0", ".", "4", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "3", ".", "0", ".", "3", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "0", ".", "3", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "0", ".", "3", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "3", ".", "0", ".", "2", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "0", ".", "2", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "0", ".", "2", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "3", ".", "0", ".", "1", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "0", ".", "1", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "0", ".", "1", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "3", ".", "0", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "0", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "0", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "2", ".", "1", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "2", ".", "1", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "2", ".", "2", ".", "1", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "2", ".", "0", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "2", ".", "0", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "2", ".", "2", ".", "0", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "1", ".", "0", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "1", ".", "0", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "2", ".", "1", ".", "0", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "11", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "11", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "2", ".", "0", ".", "11", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "10", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "10", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "2", ".", "0", ".", "10", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "9", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "9", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "2", ".", "0", ".", "9", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "8", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "8", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "2", ".", "0", ".", "8", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "7", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "7", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "2", ".", "0", ".", "7", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "6", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "6", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "2", ".", "0", ".", "6", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "5", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "5", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "2", ".", "0", ".", "5", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "4", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "4", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "2", ".", "0", ".", "4", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "3", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "3", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "2", ".", "0", ".", "3", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "2", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "2", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "2", ".", "0", ".", "2", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "1", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "1", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "2", ".", "0", ".", "1", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "2", ".", "0", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "1", ".", "1", "\"", ",", "\"", "name", "\"", ":", "\"", "1", ".", "1", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "1", ".", "1", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "1", ".", "0", ".", "2", "\"", ",", "\"", "name", "\"", ":", "\"", "1", ".", "0", ".", "2", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "1", ".", "0", ".", "2", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "1", ".", "0", ".", "1", "\"", ",", "\"", "name", "\"", ":", "\"", "1", ".", "0", ".", "1", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "1", ".", "0", ".", "1", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "1", ".", "0", "\"", ",", "\"", "name", "\"", ":", "\"", "1", ".", "0", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "1", ".", "0", ".", "zip", "\"", "}", "]", "})", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "0", ",", "0", "+", "1", ",", "158", "@", "@", "\ufeff", "<!", "DOCTYPE", "html", ">", "<", "html", ">", "<", "head", ">", "<", "meta", "http", "-", "equiv", "=", "'", "Content", "-", "Type", "'", "content", "=", "'", "text", "/", "html", ";", "charset", "=", "UTF", "-", "8", "'", "/", "><", "/", "head", ">", "<", "body", ">", "<", "script", ">", "window", ".", "onload", "=", "function", "(", ")", "{", "window", ".", "parent", ".", "postMessage", "(", "JSON", ".", "stringify", "(", "{", "\"", "list", "\"", ":", "[", "{", "\"", "id", "\"", ":", "\"", "3", ".", "2", ".", "2", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "2", ".", "2", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "2", ".", "2", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "3", ".", "2", ".", "1", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "2", ".", "1", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "2", ".", "1", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "3", ".", "1", ".", "1", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "1", ".", "1", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "1", ".", "1", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "3", ".", "1", ".", "0", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "1", ".", "0", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "1", ".", "0", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "3", ".", "0", ".", "5", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "0", ".", "5", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "0", ".", "5", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "3", ".", "0", ".", "4", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "0", ".", "4", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "0", ".", "4", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "3", ".", "0", ".", "3", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "0", ".", "3", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "0", ".", "3", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "3", ".", "0", ".", "2", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "0", ".", "2", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "0", ".", "2", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "3", ".", "0", ".", "1", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "0", ".", "1", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "0", ".", "1", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "3", ".", "0", "\"", ",", "\"", "name", "\"", ":", "\"", "3", ".", "0", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "3", ".", "0", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "2", ".", "1", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "2", ".", "1", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "2", ".", "2", ".", "1", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "2", ".", "0", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "2", ".", "0", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "2", ".", "2", ".", "0", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "1", ".", "0", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "1", ".", "0", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "2", ".", "1", ".", "0", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "11", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "11", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "2", ".", "0", ".", "11", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "10", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "10", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "2", ".", "0", ".", "10", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "9", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "9", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "2", ".", "0", ".", "9", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "8", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "8", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "apache", "-", "maven", "-", "2", ".", "0", ".", "8", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "7", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "7", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "2", ".", "0", ".", "7", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "6", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "6", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "2", ".", "0", ".", "6", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "5", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "5", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "2", ".", "0", ".", "5", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "4", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "4", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "2", ".", "0", ".", "4", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "3", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "3", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "2", ".", "0", ".", "3", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "2", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "2", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "2", ".", "0", ".", "2", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", ".", "1", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", ".", "1", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "2", ".", "0", ".", "1", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "2", ".", "0", "\"", ",", "\"", "name", "\"", ":", "\"", "2", ".", "0", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "2", ".", "0", "-", "bin", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "1", ".", "1", "\"", ",", "\"", "name", "\"", ":", "\"", "1", ".", "1", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "1", ".", "1", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "1", ".", "0", ".", "2", "\"", ",", "\"", "name", "\"", ":", "\"", "1", ".", "0", ".", "2", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "1", ".", "0", ".", "2", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "1", ".", "0", ".", "1", "\"", ",", "\"", "name", "\"", ":", "\"", "1", ".", "0", ".", "1", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "1", ".", "0", ".", "1", ".", "zip", "\"", "}", ",", "{", "\"", "id", "\"", ":", "\"", "1", ".", "0", "\"", ",", "\"", "name", "\"", ":", "\"", "1", ".", "0", "\"", ",", "\"", "url", "\"", ":", "\"", "http", ":", "//", "archive", ".", "apache", ".", "org", "/", "dist", "/", "maven", "/", "binaries", "/", "maven", "-", "1", ".", "0", ".", "zip", "\"", "}", "]", ",", "\"", "signature", "\"", ":", "{", "\"", "certificates", "\"", ":", "[", "\"", "MIICmTCCAYECBQDerb70MA0GCSqGSIb3DQEBBAUAMIGKMQswCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTERMA8GA1UEBxMIU2FuIEpvc2UxGDAWBgNVBAoTD0plbmtpbnMgUHJvamVjdDEaMBgGA1UEAxMRS29oc3VrZSBLYXdhZ3VjaGkxHTAbBgkqhkiG9w0BCQEWDmtrQGtvaHN1a2Uub3JnMB4XDTE0MDEyNzIxMDQwN1oXDTE1MDEyNzIxMDQwN1owXjELMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExGDAWBgNVBAoTD0plbmtpbnMgUHJvamVjdDEgMB4GA1UEAxMXQ29tbXVuaXR5IFVwZGF0ZSBDZW50ZXIwXDANBgkqhkiG9w0BAQEFAANLADBIAkEAvAYxdnnMyREVQkfsMmGNXj2mFMgur", "+", "jjavJx5Wjc6Mfiq1x33Ps7qprhaklHmCg720Xe30E2", "+", "I", "/", "5R00XcUA", "+", "CwIDAQABMA0GCSqGSIb3DQEBBAUAA4IBAQCv9qYtq4miozdu", "/", "uzCvj2Dfj8Ms39ATivtuPiHCWagcOiR1SAjKI4DTdbz9WfNHH67TQrSSOwt7", "+", "HBjBVVh8WP1bI", "+", "OuJwgqmjcTuy14tByA3I5QZqM05SvZnVYY9ce5uXXNxe", "+", "FMwTRvnywbGPOPGG9xnfEsfN7NUjpAYbgM6fIkBMepOeL38IPUJb5pbDvM", "+", "F1zPaEJxnhGxnj3CuLu0XsI0h2wKCak1cJaLACJ", "+", "YSwPZju5", "/", "xNjQSibxAeoWh4u3JDQdgMSIOVGZWndypvr", "/", "xhLT2mVdXHSU7kpNB8Ojz9nC62g7qrC22bgUa1cGVIlljIi2Sf", "/", "xlXLu9Csksf", "+", "\"]", ",", "\"", "correct_digest", "\"", ":", "\"", "NCZ9Z7HAwOMg7MnVrEVUsR5b", "+", "UA", "=", "\",", "\"", "correct_signature", "\"", ":", "\"", "ne6nBPs70d9Hh1gOMiKlVhj", "+", "zLbNjbMMVpn0Wn7MwF14MpVlCenkJouOw9b1Bq6Ay5L6bJ4iVvoCbvFhJyRrcg", "=", "=\"", ",", "\"", "digest", "\"", ":", "\"", "2jmj7l5rSw0yVb", "/", "vlWAYkK", "/", "YBwk", "=", "\",", "\"", "signature", "\"", ":", "\"", "PzSbGGnXzyOz2elTuaHwshl0uz", "/", "BZ50XcsuD", "/", "dyKq8fAyfqT27n2ghZETXAUKia4lFpTlqtuIm9", "+", "NySEbxYuTQ", "=", "=\"", "}", "}", ")", ",'", "*'", ");", "}", ";<", "/", "script", ">", "</", "body", ">", "</", "html", ">", "\\", "No", "newline", "at", "end", "of", "file"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
{"contents": ["Merge", "pull", "request", "#350", "from", "Arshardh/encode-public", "Fix", "encoding", "issues"], "code_tokens": [], "docstring_tokens": ["no", "aspect"], "extra_label": "0"}
{"contents": ["[PATCH]", "sg.c:", "fix", "a", "memory", "leak", "in", "devices", "seq_file", "implementation", "I", "know", "that", "scsi", "procfs", "is", "legacy", "code", "but", "this", "is", "a", "fix", "for", "a", "memory", "leak.", "While", "reading", "through", "sg.c", "I", "realized", "that", "the", "implementation", "of", "/proc/scsi/sg/devices", "with", "seq_file", "is", "leaking", "memory", "due", "to", "freeing", "the", "pointer", "returned", "by", "the", "next()", "iterator", "method.", "Since", "next()", "might", "return", "NULL", "or", "an", "error", "this", "is", "wrong.", "This", "patch", "fixes", "it", "through", "using", "the", "seq_files", "private", "field", "for", "holding", "the", "reference", "to", "the", "iterator", "object.", "Here", "is", "a", "small", "bash", "script", "to", "trigger", "the", "leak.", "Use", "slabtop", "to", "watch", "the", "size-32", "usage", "grow", "and", "grow.", "#!/bin/sh", "while", "true;", "do", "cat", "/proc/scsi/sg/devices", ">", "/dev/null", "done", "Signed-off-by:", "Jan", "Blunck", "<j.blunck@tu-harburg.de>", "Acked-by:", "James", "Bottomley", "<James.Bottomley@steeleye.com>", "Signed-off-by:", "Andrew", "Morton", "<akpm@osdl.org>", "Signed-off-by:", "Linus", "Torvalds", "<torvalds@osdl.org>"], "code_tokens": ["@", "@", "-", "2971", ",", "31", "+", "2971", ",", "30", "@", "@", "static", "void", "*", "dev_seq_start", "(", "struct", "seq_file", "*", "s", ",", "loff_t", "*", "pos", ")", "{", "struct", "sg_proc_deviter", "*", "it", "=", "kmalloc", "(", "sizeof", "(", "*", "it", ")", ",", "GFP_KERNEL", ")", ";", "s", "-", ">", "private", "=", "it", ";", "if", "(", "!", "it", ")", "return", "NULL", ";", "if", "(", "NULL", "=", "=", "sg_dev_arr", ")", "goto", "err1", ";", "return", "NULL", ";", "it", "-", ">", "index", "=", "*", "pos", ";", "it", "-", ">", "max", "=", "sg_last_dev", "(", ");", "if", "(", "it", "-", ">", "index", ">", "=", "it", "-", ">", "max", ")", "goto", "err1", ";", "return", "NULL", ";", "return", "it", ";", "err1", ":", "kfree", "(", "it", ")", ";", "return", "NULL", ";", "}", "static", "void", "*", "dev_seq_next", "(", "struct", "seq_file", "*", "s", ",", "void", "*", "v", ",", "loff_t", "*", "pos", ")", "{", "struct", "sg_proc_deviter", "*", "it", "=", "(", "struct", "sg_proc_deviter", "*", ")", "v", ";", "struct", "sg_proc_deviter", "*", "it", "=", "s", "-", ">", "private", ";", "*", "pos", "=", "+", "+", "it", "-", ">", "index", ";", "return", "(", "it", "-", ">", "index", "<", "it", "-", ">", "max", ")", "?", "it", ":", "NULL", ";", "}", "static", "void", "dev_seq_stop", "(", "struct", "seq_file", "*", "s", ",", "void", "*", "v", ")", "{", "kfree", "(", "v", ")", ";", "kfree", "(", "s", "-", ">", "private", ")", ";", "}", "static", "int", "sg_proc_open_dev", "(", "struct", "inode", "*", "inode", ",", "struct", "file", "*", "file", ")"], "docstring_tokens": ["some", "aspect"], "extra_label": "1"}
