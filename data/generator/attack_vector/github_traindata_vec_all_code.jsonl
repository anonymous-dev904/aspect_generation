{"contents": ["empty"], "code_tokens": ["@", "@", "-", "32", ",", "12", "+", "32", ",", "14", "@", "@", "import", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "jose", ".", "jwt", ".", "JwtUtils", ";", "import", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oauth2", ".", "common", ".", "Client", ";", "import", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oauth2", ".", "common", ".", "OAuthContext", ";", "import", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oauth2", ".", "common", ".", "OAuthPermission", ";", "import", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oauth2", ".", "provider", ".", "OAuthDataProvider", ";", "import", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oauth2", ".", "provider", ".", "OAuthServerJoseJwtProducer", ";", "import", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oauth2", ".", "utils", ".", "OAuthContextUtils", ";", "import", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oauth2", ".", "utils", ".", "OAuthUtils", ";", "import", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oidc", ".", "common", ".", "IdToken", ";", "import", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oidc", ".", "common", ".", "UserInfo", ";", "import", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "oidc", ".", "utils", ".", "OidcUtils", ";", "@", "Path", "(", "\"/", "userinfo", "\"", ")", "public", "class", "UserInfoService", "extends", "OAuthServerJoseJwtProducer", "{", "@", "@", "-", "51", ",", "6", "+", "53", ",", "14", "@", "@", "@", "Produces", "(", "{\"", "application", "/", "json", "\"", ",", "\"", "application", "/", "jwt", "\"", "}", ")", "public", "Response", "getUserInfo", "(", ")", "{", "OAuthContext", "oauth", "=", "OAuthContextUtils", ".", "getContext", "(", "mc", ")", ";", "/", "/", "Check", "the", "access", "token", "has", "the", "\"", "openid", "\"", "scope", "if", "(", "!", "oauth", ".", "getPermissions", "(", ").", "stream", "(", ")", ".", "map", "(", "OAuthPermission", ":", ":", "getPermission", ")", ".", "anyMatch", "(", "OidcUtils", ".", "OPENID_SCOPE", ":", ":", "equals", ")", ")", "{", "Response", ".", "status", "(", "401", ")", ";", "}", "UserInfo", "userInfo", "=", "null", ";", "if", "(", "userInfoProvider", "!", "=", "null", ")", "{", "userInfo", "=", "userInfoProvider", ".", "getUserInfo", "(", "oauth", ".", "getClientId", "(", "),", "oauth", ".", "getSubject", "(", "),"], "docstring_tokens": ["obtaining", "the", "authorization", "code", "issued", "to", "another", "client"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1351", ",", "7", "+", "1351", ",", "7", "@", "@", "static", "int", "gather_hugetbl_stats", "(", "pte_t", "*", "pte", ",", "unsigned", "long", "hmask", ",", "struct", "numa_maps", "*", "md", ";", "struct", "page", "*", "page", ";", "if", "(", "pte_none", "(", "*", "pte", ")", ")", "if", "(", "!", "pte_present", "(", "*", "pte", ")", ")", "return", "0", ";", "page", "=", "pte_page", "(", "*", "pte", ")", ";", "@", "@", "-", "526", ",", "9", "+", "526", ",", "13", "@", "@", "static", "void", "queue_pages_hugetlb_pmd_range", "(", "struct", "vm_area_struct", "*", "vma", ",", "int", "nid", ";", "struct", "page", "*", "page", ";", "spinlock_t", "*", "ptl", ";", "pte_t", "entry", ";", "ptl", "=", "huge_pte_lock", "(", "hstate_vma", "(", "vma", ")", ",", "vma", "-", ">", "vm_mm", ",", "(", "pte_t", "*", ")", "pmd", ")", ";", "page", "=", "pte_page", "(", "huge_ptep_get", "(", "(", "pte_t", "*", ")", "pmd", ")", ");", "entry", "=", "huge_ptep_get", "(", "(", "pte_t", "*", ")", "pmd", ")", ";", "if", "(", "!", "pte_present", "(", "entry", ")", ")", "goto", "unlock", ";", "page", "=", "pte_page", "(", "entry", ")", ";", "nid", "=", "page_to_nid", "(", "page", ")", ";", "if", "(", "node_isset", "(", "nid", ",", "*", "nodes", ")", "=", "=", "!", "!(", "flags", "&", "MPOL_MF_INVERT", ")", ")", "goto", "unlock", ";"], "docstring_tokens": ["by", "accessing", "certain", "memory", "locations"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "273", ",", "6", "+", "273", ",", "7", "@", "@", "static", "struct", "task_struct", "*", "dup_task_struct", "(", "struct", "task_struct", "*", "orig", ")", "setup_thread_stack", "(", "tsk", ",", "orig", ")", ";", "clear_user_return_notifier", "(", "tsk", ")", ";", "clear_tsk_need_resched", "(", "tsk", ")", ";", "stackend", "=", "end_of_stack", "(", "tsk", ")", ";", "*", "stackend", "=", "STACK_END_MAGIC", ";", "/", "*", "for", "overflow", "detection", "*", "/", "@", "@", "-", "641", ",", "17", "+", "641", ",", "18", "@", "@", "static", "void", "sched_irq_time_avg_update", "(", "struct", "rq", "*", "rq", ",", "u64", "irq_time", ")", ";", "inline", "void", "update_rq_clock", "(", "struct", "rq", "*", "rq", ")", "{", "if", "(", "!", "rq", "-", ">", "skip_clock_update", ")", "{", "int", "cpu", "=", "cpu_of", "(", "rq", ")", ";", "u64", "irq_time", ";", "int", "cpu", "=", "cpu_of", "(", "rq", ")", ";", "u64", "irq_time", ";", "rq", "-", ">", "clock", "=", "sched_clock_cpu", "(", "cpu", ")", ";", "irq_time", "=", "irq_time_cpu", "(", "cpu", ")", ";", "if", "(", "rq", "-", ">", "clock", "-", "irq_time", ">", "rq", "-", ">", "clock_task", ")", "rq", "-", ">", "clock_task", "=", "rq", "-", ">", "clock", "-", "irq_time", ";", "if", "(", "rq", "-", ">", "skip_clock_update", ")", "return", ";", "sched_irq_time_avg_update", "(", "rq", ",", "irq_time", ")", ";", "}", "rq", "-", ">", "clock", "=", "sched_clock_cpu", "(", "cpu", ")", ";", "irq_time", "=", "irq_time_cpu", "(", "cpu", ")", ";", "if", "(", "rq", "-", ">", "clock", "-", "irq_time", ">", "rq", "-", ">", "clock_task", ")", "rq", "-", ">", "clock_task", "=", "rq", "-", ">", "clock", "-", "irq_time", ";", "sched_irq_time_avg_update", "(", "rq", ",", "irq_time", ")", ";", "}", "/", "*", "@", "@", "-", "2129", ",", "7", "+", "2130", ",", "7", "@", "@", "static", "void", "check_preempt_curr", "(", "struct", "rq", "*", "rq", ",", "struct", "task_struct", "*", "p", ",", "int", "flags", ")", "*", "A", "queue", "event", "has", "occurred", ",", "and", "we", "'", "re", "going", "to", "schedule", ".", "In", "*", "this", "case", ",", "we", "can", "save", "a", "useless", "back", "to", "back", "clock", "update", ".", "*", "/", "if", "(", "test_tsk_need_resched", "(", "rq", "-", ">", "curr", ")", ")", "if", "(", "rq", "-", ">", "curr", "-", ">", "se", ".", "on_rq", "&", "&", "test_tsk_need_resched", "(", "rq", "-", ">", "curr", ")", ")", "rq", "-", ">", "skip_clock_update", "=", "1", ";", "}", "@", "@", "-", "3973", ",", "7", "+", "3974", ",", "6", "@", "@", "static", "void", "put_prev_task", "(", "struct", "rq", "*", "rq", ",", "struct", "task_struct", "*", "prev", ")", "{", "if", "(", "prev", "-", ">", "se", ".", "on_rq", ")", "update_rq_clock", "(", "rq", ")", ";", "rq", "-", ">", "skip_clock_update", "=", "0", ";", "prev", "-", ">", "sched_class", "-", ">", "put_prev_task", "(", "rq", ",", "prev", ")", ";", "}", "@", "@", "-", "4031", ",", "7", "+", "4031", ",", "6", "@", "@", "asmlinkage", "void", "__sched", "schedule", "(", "void", ")", "hrtick_clear", "(", "rq", ")", ";", "raw_spin_lock_irq", "(", "&", "rq", "-", ">", "lock", ")", ";", "clear_tsk_need_resched", "(", "prev", ")", ";", "switch_count", "=", "&", "prev", "-", ">", "nivcsw", ";", "if", "(", "prev", "-", ">", "state", "&", "&", "!", "(", "preempt_count", "(", ")", "&", "PREEMPT_ACTIVE", ")", ")", "{", "@", "@", "-", "4063", ",", "6", "+", "4062", ",", "8", "@", "@", "asmlinkage", "void", "__sched", "schedule", "(", "void", ")", "put_prev_task", "(", "rq", ",", "prev", ")", ";", "next", "=", "pick_next_task", "(", "rq", ")", ";", "clear_tsk_need_resched", "(", "prev", ")", ";", "rq", "-", ">", "skip_clock_update", "=", "0", ";", "if", "(", "likely", "(", "prev", "!", "=", "next", ")", ")", "{", "sched_info_switch", "(", "prev", ",", "next", ")", ";", "@", "@", "-", "4071", ",", "6", "+", "4072", ",", "7", "@", "@", "asmlinkage", "void", "__sched", "schedule", "(", "void", ")", "rq", "-", ">", "nr_switches", "+", "+;", "rq", "-", ">", "curr", "=", "next", ";", "+", "+*", "switch_count", ";", "WARN_ON_ONCE", "(", "test_tsk_need_resched", "(", "next", ")", ");", "context_switch", "(", "rq", ",", "prev", ",", "next", ")", ";", "/", "*", "unlocks", "the", "rq", "*", "/", "/", "*"], "docstring_tokens": ["via", "an", "application", "that", "executes", "code", "in", "a", "loop", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "679", ",", "7", "+", "679", ",", "7", "@", "@", "static", "int", "rose_bind", "(", "struct", "socket", "*", "sock", ",", "struct", "sockaddr", "*", "uaddr", ",", "int", "addr_len", ")", "if", "(", "addr_len", "=", "=", "sizeof", "(", "struct", "sockaddr_rose", ")", "&", "&", "addr", "-", ">", "srose_ndigis", ">", "1", ")", "return", "-", "EINVAL", ";", "if", "(", "addr", "-", ">", "srose_ndigis", ">", "ROSE_MAX_DIGIS", ")", "if", "(", "(", "unsigned", "int", ")", "addr", "-", ">", "srose_ndigis", ">", "ROSE_MAX_DIGIS", ")", "return", "-", "EINVAL", ";", "if", "(", "(", "dev", "=", "rose_dev_get", "(", "&", "addr", "-", ">", "srose_addr", ")", ")", "=", "=", "NULL", ")", "{", "@", "@", "-", "739", ",", "7", "+", "739", ",", "7", "@", "@", "static", "int", "rose_connect", "(", "struct", "socket", "*", "sock", ",", "struct", "sockaddr", "*", "uaddr", ",", "int", "addr_le", "if", "(", "addr_len", "=", "=", "sizeof", "(", "struct", "sockaddr_rose", ")", "&", "&", "addr", "-", ">", "srose_ndigis", ">", "1", ")", "return", "-", "EINVAL", ";", "if", "(", "addr", "-", ">", "srose_ndigis", ">", "ROSE_MAX_DIGIS", ")", "if", "(", "(", "unsigned", "int", ")", "addr", "-", ">", "srose_ndigis", ">", "ROSE_MAX_DIGIS", ")", "return", "-", "EINVAL", ";", "/", "*", "Source", "+", "Destination", "digis", "should", "not", "exceed", "ROSE_MAX_DIGIS", "*", "/"], "docstring_tokens": ["value"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2348", ",", "7", "+", "2348", ",", "10", "@", "@", "static", "int", "tls_decrypt_ticket", "(", "SSL", "*", "s", ",", "const", "unsigned", "char", "*", "etick", ",", "int", "eticklen", ",", "HMAC_Final", "(", "&", "hctx", ",", "tick_hmac", ",", "NULL", ")", ";", "HMAC_CTX_cleanup", "(", "&", "hctx", ")", ";", "if", "(", "CRYPTO_memcmp", "(", "tick_hmac", ",", "etick", "+", "eticklen", ",", "mlen", ")", ")", "{", "EVP_CIPHER_CTX_cleanup", "(", "&", "ctx", ")", ";", "return", "2", ";", "}", "/", "*", "Attempt", "to", "decrypt", "session", "data", "*", "/", "/", "*", "Move", "p", "after", "IV", "to", "start", "of", "encrypted", "ticket", ",", "update", "length", "*", "/", "p", "=", "etick", "+", "16", "+", "EVP_CIPHER_CTX_iv_length", "(", "&", "ctx", ")", ";"], "docstring_tokens": ["via", "a", "crafted", "session", "ticket", "that", "triggers", "an", "integrity-check", "failure", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "142", ",", "7", "+", "142", ",", "7", "@", "@", "static", "void", "dump_one_vdso_page", "(", "struct", "page", "*", "pg", ",", "struct", "page", "*", "upg", ")", "printk", "(", "\"", "kpg", ":", "%", "p", "(", "c", ":", "%", "d", ",", "f", ":", "%", "08lx", ")", "\",", "__va", "(", "page_to_pfn", "(", "pg", ")", "<", "<", "PAGE_SHIFT", ")", ",", "page_count", "(", "pg", ")", ",", "pg", "-", ">", "flags", ")", ";", "if", "(", "upg", "/", "*", "&", "&", "pg", "!", "=", "upg", "*", "/)", "{", "if", "(", "upg", "&", "&", "!", "IS_ERR", "(", "upg", ")", "/", "*", "&", "&", "pg", "!", "=", "upg", "*", "/)", "{", "printk", "(", "\"", "upg", ":", "%", "p", "(", "c", ":", "%", "d", ",", "f", ":", "%", "08lx", ")", "\",", "__va", "(", "page_to_pfn", "(", "upg", ")", "<", "<", "PAGE_SHIFT", ")", ",", "page_count", "(", "upg", ")", ",", "@", "@", "-", "999", ",", "17", "+", "999", ",", "15", "@", "@", "struct", "page", "*", "follow_page", "(", "struct", "vm_area_struct", "*", "vma", ",", "unsigned", "long", "address", ",", "goto", "no_page_table", ";", "ptep", "=", "pte_offset_map_lock", "(", "mm", ",", "pmd", ",", "address", ",", "&", "ptl", ")", ";", "if", "(", "!", "ptep", ")", "goto", "out", ";", "pte", "=", "*", "ptep", ";", "if", "(", "!", "pte_present", "(", "pte", ")", ")", "goto", "unlock", ";", "goto", "no_page", ";", "if", "(", "(", "flags", "&", "FOLL_WRITE", ")", "&", "&", "!", "pte_write", "(", "pte", ")", ")", "goto", "unlock", ";", "page", "=", "vm_normal_page", "(", "vma", ",", "address", ",", "pte", ")", ";", "if", "(", "unlikely", "(", "!", "page", ")", ")", "goto", "unlock", ";", "goto", "bad_page", ";", "if", "(", "flags", "&", "FOLL_GET", ")", "get_page", "(", "page", ")", ";", "@", "@", "-", "1024", ",", "6", "+", "1022", ",", "15", "@", "@", "struct", "page", "*", "follow_page", "(", "struct", "vm_area_struct", "*", "vma", ",", "unsigned", "long", "address", ",", "out", ":", "return", "page", ";", "bad_page", ":", "pte_unmap_unlock", "(", "ptep", ",", "ptl", ")", ";", "return", "ERR_PTR", "(", "-", "EFAULT", ")", ";", "no_page", ":", "pte_unmap_unlock", "(", "ptep", ",", "ptl", ")", ";", "if", "(", "!", "pte_none", "(", "pte", ")", ")", "return", "page", ";", "/", "*", "Fall", "through", "to", "ZERO_PAGE", "handling", "*", "/", "no_page_table", ":", "/", "*", "*", "When", "core", "dumping", "an", "enormous", "anonymous", "area", "that", "nobody", "@", "@", "-", "1159", ",", "6", "+", "1166", ",", "8", "@", "@", "int", "get_user_pages", "(", "struct", "task_struct", "*", "tsk", ",", "struct", "mm_struct", "*", "mm", ",", "cond_resched", "(", ");", "}", "if", "(", "IS_ERR", "(", "page", ")", ")", "return", "i", "?", "i", ":", "PTR_ERR", "(", "page", ")", ";", "if", "(", "pages", ")", "{", "pages", "[", "i", "]", "=", "page", ";", "@", "@", "-", "865", ",", "6", "+", "865", ",", "11", "@", "@", "static", "int", "do_move_pages", "(", "struct", "mm_struct", "*", "mm", ",", "struct", "page_to_node", "*", "pm", ",", "goto", "set_status", ";", "page", "=", "follow_page", "(", "vma", ",", "pp", "-", ">", "addr", ",", "FOLL_GET", ")", ";", "err", "=", "PTR_ERR", "(", "page", ")", ";", "if", "(", "IS_ERR", "(", "page", ")", ")", "goto", "set_status", ";", "err", "=", "-", "ENOENT", ";", "if", "(", "!", "page", ")", "goto", "set_status", ";", "@", "@", "-", "928", ",", "6", "+", "933", ",", "11", "@", "@", "static", "int", "do_pages_stat", "(", "struct", "mm_struct", "*", "mm", ",", "struct", "page_to_node", "*", "pm", ")", "goto", "set_status", ";", "page", "=", "follow_page", "(", "vma", ",", "pm", "-", ">", "addr", ",", "0", ")", ";", "err", "=", "PTR_ERR", "(", "page", ")", ";", "if", "(", "IS_ERR", "(", "page", ")", ")", "goto", "set_status", ";", "err", "=", "-", "ENOENT", ";", "/", "*", "Use", "PageReserved", "to", "check", "for", "zero", "page", "*", "/", "if", "(", "!", "page", "|", "|", "PageReserved", "(", "page", ")", ")"], "docstring_tokens": ["via", "a", "large", "number", "of", "calls", "to", "the", "get_user_pages", "function"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "224", ",", "7", "+", "224", ",", "9", "@", "@", "protected", "void", "writeToResult", "(", "T", "t", ",", "HttpHeaders", "headers", ",", "Result", "result", ")", "throws", "IOE", "*", "@", "return", "the", "created", "factory", "*", "/", "protected", "XMLInputFactory", "createXmlInputFactory", "(", ")", "{", "return", "XMLInputFactory", ".", "newInstance", "(", ");", "XMLInputFactory", "inputFactory", "=", "XMLInputFactory", ".", "newInstance", "(", ");", "inputFactory", ".", "setProperty", "(", "XMLInputFactory", ".", "IS_REPLACING_ENTITY_REFERENCES", ",", "false", ")", ";", "return", "inputFactory", ";", "}", "}"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "513", ",", "11", "+", "513", ",", "16", "@", "@", "static", "int", "raw_sendmsg", "(", "struct", "sock", "*", "sk", ",", "struct", "msghdr", "*", "msg", ",", "size_t", "len", ")", "int", "err", ";", "struct", "ip_options_data", "opt_copy", ";", "struct", "raw_frag_vec", "rfv", ";", "int", "hdrincl", ";", "err", "=", "-", "EMSGSIZE", ";", "if", "(", "len", ">", "0xFFFF", ")", "goto", "out", ";", "/", "*", "hdrincl", "should", "be", "READ_ONCE", "(", "inet", "-", ">", "hdrincl", ")", "*", "but", "READ_ONCE", "(", ")", "doesn", "'", "t", "work", "with", "bit", "fields", "*", "/", "hdrincl", "=", "inet", "-", ">", "hdrincl", ";", "/", "*", "*", "Check", "the", "flags", ".", "*", "/", "@", "@", "-", "593", ",", "7", "+", "598", ",", "7", "@", "@", "static", "int", "raw_sendmsg", "(", "struct", "sock", "*", "sk", ",", "struct", "msghdr", "*", "msg", ",", "size_t", "len", ")", "/", "*", "Linux", "does", "not", "mangle", "headers", "on", "raw", "sockets", ",", "*", "so", "that", "IP", "options", "+", "IP_HDRINCL", "is", "non", "-", "sense", ".", "*", "/", "if", "(", "inet", "-", ">", "hdrincl", ")", "if", "(", "hdrincl", ")", "goto", "done", ";", "if", "(", "ipc", ".", "opt", "-", ">", "opt", ".", "srr", ")", "{", "if", "(", "!", "daddr", ")", "@", "@", "-", "615", ",", "12", "+", "620", ",", "12", "@", "@", "static", "int", "raw_sendmsg", "(", "struct", "sock", "*", "sk", ",", "struct", "msghdr", "*", "msg", ",", "size_t", "len", ")", "flowi4_init_output", "(", "&", "fl4", ",", "ipc", ".", "oif", ",", "sk", "-", ">", "sk_mark", ",", "tos", ",", "RT_SCOPE_UNIVERSE", ",", "inet", "-", ">", "hdrincl", "?", "IPPROTO_RAW", ":", "sk", "-", ">", "sk_protocol", ",", "hdrincl", "?", "IPPROTO_RAW", ":", "sk", "-", ">", "sk_protocol", ",", "inet_sk_flowi_flags", "(", "sk", ")", "|", "(", "inet", "-", ">", "hdrincl", "?", "FLOWI_FLAG_KNOWN_NH", ":", "0", ")", ",", "(", "hdrincl", "?", "FLOWI_FLAG_KNOWN_NH", ":", "0", ")", ",", "daddr", ",", "saddr", ",", "0", ",", "0", ",", "sk", "-", ">", "sk_uid", ")", ";", "if", "(", "!", "inet", "-", ">", "hdrincl", ")", "{", "if", "(", "!", "hdrincl", ")", "{", "rfv", ".", "msg", "=", "msg", ";", "rfv", ".", "hlen", "=", "0", ";", "@", "@", "-", "645", ",", "7", "+", "650", ",", "7", "@", "@", "static", "int", "raw_sendmsg", "(", "struct", "sock", "*", "sk", ",", "struct", "msghdr", "*", "msg", ",", "size_t", "len", ")", "goto", "do_confirm", ";", "back_from_confirm", ":", "if", "(", "inet", "-", ">", "hdrincl", ")", "if", "(", "hdrincl", ")", "err", "=", "raw_send_hdrinc", "(", "sk", ",", "&", "fl4", ",", "msg", ",", "len", ",", "&", "rt", ",", "msg", "-", ">", "msg_flags", ",", "&", "ipc", ".", "sockc", ")", ";"], "docstring_tokens": ["spraying", "the", "stack", "with", "controlled", "user", "data"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "6", ",", "7", "+", "6", ",", "7", "@", "@", "<", "groupId", ">", "edu", ".", "vt", ".", "middleware", "<", "/", "groupId", ">", "<", "artifactId", ">", "vt", "-", "ldap", "<", "/", "artifactId", ">", "<", "packaging", ">", "jar", "<", "/", "packaging", ">", "<", "version", ">", "3", ".", "3", ".", "7", "<", "/", "version", ">", "<", "version", ">", "3", ".", "3", ".", "8", "<", "/", "version", ">", "<", "name", ">", "VT", "LDAP", "Libraries", "<", "/", "name", ">", "<", "description", ">", "Library", "for", "performing", "common", "LDAP", "operations", "<", "/", "description", ">", "<", "url", ">", "http", ":", "//", "code", ".", "google", ".", "com", "/", "p", "/", "vt", "-", "middleware", "/", "wiki", "/", "vtldap", "<", "/", "url", ">", "@", "@", "-", "20", ",", "7", "+", "20", ",", "12", "@", "@", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "StringTokenizer", ";", "import", "javax", ".", "naming", ".", "NamingEnumeration", ";", "import", "javax", ".", "naming", ".", "NamingException", ";", "import", "javax", ".", "naming", ".", "directory", ".", "Attribute", ";", "import", "javax", ".", "naming", ".", "directory", ".", "Attributes", ";", "import", "javax", ".", "naming", ".", "ldap", ".", "LdapName", ";", "import", "javax", ".", "naming", ".", "ldap", ".", "Rdn", ";", "import", "javax", ".", "net", ".", "SocketFactory", ";", "import", "javax", ".", "net", ".", "ssl", ".", "HostnameVerifier", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLPeerUnverifiedException", ";", "@", "@", "-", "214", ",", "9", "+", "219", ",", "11", "@", "@", "protected", "boolean", "verifyDNS", "(", "final", "String", "hostname", ",", "final", "X509Certificate", "cert", ")", "this", ".", "logger", ".", "debug", "(", "\"", "verifyDNS", "using", "CN", "=", "\"", "+", "Arrays", ".", "toString", "(", "cns", ")", ");", "}", "if", "(", "cns", ".", "length", ">", "0", ")", "{", "if", "(", "isMatch", "(", "hostname", ",", "cns", "[", "0", "]", "))", "{", "/", "/", "the", "most", "specific", "CN", "refers", "to", "the", "last", "CN", "if", "(", "isMatch", "(", "hostname", ",", "cns", "[", "cns", ".", "length", "-", "1", "]", "))", "{", "if", "(", "this", ".", "logger", ".", "isDebugEnabled", "(", "))", "{", "this", ".", "logger", ".", "debug", "(", "\"", "verifyDNS", "found", "hostname", "match", ":", "\"", "+", "cns", "[", "0", "]", ");", "this", ".", "logger", ".", "debug", "(", "\"", "verifyDNS", "found", "hostname", "match", ":", "\"", "+", "cns", "[", "cns", ".", "length", "-", "1", "]", ");", "}", "verified", "=", "true", ";", "}", "@", "@", "-", "269", ",", "15", "+", "276", ",", "39", "@", "@", "protected", "boolean", "verifyDNS", "(", "final", "String", "hostname", ",", "final", "X509Certificate", "cert", ")", "private", "String", "[", "]", "getCNs", "(", "final", "X509Certificate", "cert", ")", "{", "final", "List", "<", "String", ">", "names", "=", "new", "ArrayList", "<", "String", ">", "()", ";", "/", "/", "not", "a", "perfect", "implementation", "but", "appears", "to", "work", "for", ">", "99", "%", "of", "certificates", "/", "/", "and", "has", "the", "virtue", "of", "not", "requiring", "any", "dependencies", "final", "String", "subjectPrincipal", "=", "cert", ".", "getSubjectX500Principal", "(", ").", "toString", "(", ");", "final", "StringTokenizer", "st", "=", "new", "StringTokenizer", "(", "subjectPrincipal", ",", "\"", ",\"", ");", "while", "(", "st", ".", "hasMoreTokens", "(", "))", "{", "final", "String", "tok", "=", "st", ".", "nextToken", "(", ");", "final", "int", "x", "=", "tok", ".", "indexOf", "(", "\"", "CN", "=", "\")", ";", "if", "(", "x", ">", "=", "0", ")", "{", "names", ".", "add", "(", "tok", ".", "substring", "(", "x", "+", "\"", "CN", "=", "\".", "length", "(", "))", ");", "if", "(", "subjectPrincipal", "!", "=", "null", ")", "{", "try", "{", "final", "LdapName", "subjectDn", "=", "new", "LdapName", "(", "subjectPrincipal", ")", ";", "for", "(", "Rdn", "rdn", ":", "subjectDn", ".", "getRdns", "(", "))", "{", "final", "Attributes", "attrs", "=", "rdn", ".", "toAttributes", "(", ");", "final", "NamingEnumeration", "<", "String", ">", "ids", "=", "attrs", ".", "getIDs", "(", ");", "while", "(", "ids", ".", "hasMore", "(", "))", "{", "final", "String", "id", "=", "ids", ".", "next", "(", ");", "if", "(", "id", ".", "toLowerCase", "(", ").", "equals", "(", "\"", "cn", "\"", ")", "|", "|", "id", ".", "toLowerCase", "(", ").", "equals", "(", "\"", "commonname", "\"", ")", "|", "|", "id", ".", "toLowerCase", "(", ").", "equals", "(", "\"", "2", ".", "5", ".", "4", ".", "3", "\"", "))", "{", "final", "Object", "value", "=", "attrs", ".", "get", "(", "id", ")", ".", "get", "(", ");", "if", "(", "value", "!", "=", "null", ")", "{", "if", "(", "value", "instanceof", "String", ")", "{", "names", ".", "add", "(", "(", "String", ")", "value", ")", ";", "}", "else", "if", "(", "value", "instanceof", "Attribute", ")", "{", "/", "/", "for", "multi", "value", "RDNs", "the", "first", "value", "is", "used", "final", "Object", "multiValue", "=", "(", "(", "Attribute", ")", "value", ")", ".", "get", "(", ");", "if", "(", "multiValue", "!", "=", "null", "&", "&", "multiValue", "instanceof", "String", ")", "{", "names", ".", "add", "(", "(", "String", ")", "multiValue", ")", ";", "}", "}", "}", "}", "}", "}", "}", "catch", "(", "NamingException", "e", ")", "{", "if", "(", "this", ".", "logger", ".", "isWarnEnabled", "(", "))", "{", "this", ".", "logger", ".", "warn", "(", "\"", "Could", "not", "get", "distinguished", "name", "from", "subject", "\"", "+", "subjectPrincipal", ",", "e", ")", ";", "}", "}", "}", "return", "names", ".", "toArray", "(", "new", "String", "[", "names", ".", "size", "(", ")]", ");", "@", "@", "-", "217", ",", "6", "+", "217", ",", "81", "@", "@", "\"", "h65ugoRzPU690x6DkscPxSQKexEjEZG", "+", "z0QnsQgaig6SY3bX2kKMa48QywLp0", "/", "Vo", "\"", "+", "\"", "HddtVv0q6rQqonRHRuCyD", "+", "FuXUg0w7BVVRH9txYAsE5eciIc7z0", "=", "\";", "/", "**", "*", "Certificate", "with", "CN", "=", "a", ".", "foo", ".", "com", "/", "CN", "=", "b", ".", "foo", ".", "com", "*", "/", "private", "static", "final", "String", "A_FOO_COM_MV_CERT", "=", "\"", "MIIC2zCCAkSgAwIBAgIDAVJ9MA0GCSqGSIb3DQEBBQUAMFcxEzARBgoJkiaJk", "/", "Is", "\"", "\"", "ZAEZFgNvcmcxGDAWBgoJkiaJk", "/", "IsZAEZFghsZGFwdGl2ZTESMBAGA1UEAxMJYS5m", "\"", "\"", "b28uY29tMRIwEAYDVQQDEwliLmZvby5jb20wHhcNMTQwODI5MTk1MTE5WhcNMTQw", "\"", "\"", "OTI4MTk1MTE5WjBXMRMwEQYKCZImiZPyLGQBGRYDb3JnMRgwFgYKCZImiZPyLGQB", "\"", "\"", "GRYIbGRhcHRpdmUxEjAQBgNVBAMTCWEuZm9vLmNvbTESMBAGA1UEAxMJYi5mb28u", "\"", "\"", "Y29tMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCrFV0ARzYvBJLXMLo8yex7", "\"", "\"", "aNATrAANh4S3utE", "/", "ce", "+", "xj2qTi", "+", "hl9xm0EU6Zal", "+", "iYGpsKqnpTPfNE8HVMbzOrrPB", "\"", "\"", "6fRMGS1AyRV3WOy", "+", "2mgdzi1P068PqpTkm", "+", "MjXF6El8OBnuGaIwLzvFMno0rV7lse", "\"", "\"", "UOLDYcEIl3BdVsIlH27KpQIDAQABo4G0MIGxMB0GA1UdDgQWBBSHRs4AN3PGdL", "/", "i", "\"", "\"", "OkPq", "/", "Cjjc6f8EDCBgQYDVR0jBHoweIAUh0bOADdzxnS", "/", "4jpD6vwo43On", "/", "BChW6RZ", "\"", "\"", "MFcxEzARBgoJkiaJk", "/", "IsZAEZFgNvcmcxGDAWBgoJkiaJk", "/", "IsZAEZFghsZGFwdGl2", "\"", "\"", "ZTESMBAGA1UEAxMJYS5mb28uY29tMRIwEAYDVQQDEwliLmZvby5jb22CAwFSfTAM", "\"", "\"", "BgNVHRMEBTADAQH", "/", "MA0GCSqGSIb3DQEBBQUAA4GBAC", "+", "+", "ms", "/", "hrIOiY4Gdyie8qiIW", "\"", "\"", "FAU", "/", "IZLkbFSPwFpVQrYLdN7m", "+", "xCIcq2", "+", "viaZdXG6QYOC8dYr2URoEoVm", "+", "DPfx2Hj", "\"", "\"", "TokXEIsNS7ODx8r", "/", "sBmJ2UHvRdPROtqwY4tCgYlf7LWD", "/", "s27eRVYCTZbcwMF1hBf", "\"", "\"", "aNe1VTBZ5MLkzyewZ6tW", "\"", ";", "/", "**", "*", "Certificate", "with", "CN", "=", "a", ".", "foo", ".", "com", "+", "b", ".", "foo", ".", "com", "*", "/", "private", "static", "final", "String", "A_FOO_COM_MV_RDN_CERT", "=", "\"", "MIIC1DCCAj2gAwIBAgIDAVJ9MA0GCSqGSIb3DQEBBQUAMFUxJDAQBgNVBAMTCWEu", "\"", "\"", "Zm9vLmNvbTAQBgNVBAMTCWIuZm9vLmNvbTEYMBYGCgmSJomT8ixkARkWCGxkYXB0", "\"", "\"", "aXZlMRMwEQYKCZImiZPyLGQBGRYDb3JnMB4XDTE0MDgyOTE5MjY1OVoXDTE0MDky", "\"", "\"", "ODE5MjY1OVowVTEkMBAGA1UEAxMJYS5mb28uY29tMBAGA1UEAxMJYi5mb28uY29t", "\"", "\"", "MRgwFgYKCZImiZPyLGQBGRYIbGRhcHRpdmUxEzARBgoJkiaJk", "/", "IsZAEZFgNvcmcw", "\"", "\"", "gZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAOC2KBN8MDiKHWEuv1pnIEcWYjHb", "\"", "\"", "D", "+", "NgAGVnZh7i8jEDRIVpWUzFj7FxNROEsAitZAanzpwo6jYeGmT60Vl4DpliuoVu", "\"", "\"", "Vt1Reem96Dp9", "/", "J7BL0QBv0fJErv", "/", "YRhNor4wSOuWI96TWHvCDEL4oDNuxEK46Nsn", "\"", "\"", "dAw10DFBRMWt1VcFAgMBAAGjgbEwga4wHQYDVR0OBBYEFB7EPqv9y", "/", "GqxBrJAMS4", "\"", "\"", "pEh2ktyTMH8GA1UdIwR4MHaAFB7EPqv9y", "/", "GqxBrJAMS4pEh2ktyToVmkVzBVMSQw", "\"", "\"", "EAYDVQQDEwlhLmZvby5jb20wEAYDVQQDEwliLmZvby5jb20xGDAWBgoJkiaJk", "/", "Is", "\"", "\"", "ZAEZFghsZGFwdGl2ZTETMBEGCgmSJomT8ixkARkWA29yZ4IDAVJ9MAwGA1UdEwQF", "\"", "\"", "MAMBAf8wDQYJKoZIhvcNAQEFBQADgYEALU4SluqREjvyztZDZRsVnKn0Wy5kQqh3", "\"", "\"", "wVN", "/", "U2Sv82", "+", "N6ulzqOttmEY", "/", "dq8UGH5QbIioGUTgWxycidYwzWCIT", "/", "+", "Gg", "+", "pwBcmz", "\"", "\"", "oTYxJY0aUKfvfy4p25dcaG360DMycUpmZHM", "+", "HpgEGOrMsLCewKshuR", "+", "D03pE9eH5", "\"", "\"", "AK1FbieXQtM", "=", "\";", "/", "**", "Certificate", "with", "/", "CN", "=", "a", ".", "foo", ".", "com", "/", "O", "=", "foo", ",", "CN", "=", "b", ".", "embed", ".", "com", ",", "/.", "*", "/", "private", "static", "final", "String", "END_B_EMBED_COM_CERT", "=", "\"", "MIICbjCCAdegAwIBAgIDAVJ9MA0GCSqGSIb3DQEBBQUAMDMxEjAQBgNVBAMTCWEu", "\"", "\"", "Zm9vLmNvbTEdMBsGA1UEChMUZm9vLCBDTj1iLmVtYmVkLmNvbSwwHhcNMTQwODIw", "\"", "\"", "MDQ1MDQ3WhcNMTQwOTE5MDQ1MDQ3WjAzMRIwEAYDVQQDEwlhLmZvby5jb20xHTAb", "\"", "\"", "BgNVBAoTFGZvbywgQ049Yi5lbWJlZC5jb20sMIGfMA0GCSqGSIb3DQEBAQUAA4GN", "\"", "\"", "ADCBiQKBgQCmODoBNwHc", "/", "1lReh98PU0Cwc9VWewd", "/", "Z7Ieoy48ScunJj", "+", "85XDtzYZ", "\"", "\"", "xv14kBuRGY1dDA282b3cQE5Q4AHen9rmmAAPQqU4jTPCcr51XyMzEdVn3AL4DYMb", "\"", "\"", "t7MkH09UikI", "+", "9KRrJLdRuLDX4UKfs1q1HBFuI5xETH2K9", "/", "Ck5aVghwIDAQABo4GP", "\"", "\"", "MIGMMB0GA1UdDgQWBBQhSWjpzcpwrouaTb", "+", "xrnzhP", "/", "o", "/", "ZDBdBgNVHSMEVjBUgBQh", "\"", "\"", "SWjpzcpwrouaTb", "+", "xrnzhP", "/", "o", "/", "ZKE3pDUwMzESMBAGA1UEAxMJYS5mb28uY29tMR0w", "\"", "\"", "GwYDVQQKExRmb28sIENOPWIuZW1iZWQuY29tLIIDAVJ9MAwGA1UdEwQFMAMBAf8w", "\"", "\"", "DQYJKoZIhvcNAQEFBQADgYEAgehg1PgzUh4uxz2k", "/", "8aSM4aizRqp5o9g9uuUn6BI", "\"", "\"", "swNWWa7BsF2G", "/", "NDdIj0cB34n8nYHlAn24UuIxZHAkT7L79hlkkGX", "/", "sal8ttga", "/", "8g", "\"", "\"", "Rr56cBlZoR8lbD", "+", "fLMJx1EmMRYOLVq9I7o", "+", "QkwuCyyBFaxQB2JGx1GeZTp0d14zO", "\"", "\"", "3UM", "=", "\";", "/", "**", "Certificate", "with", "/", "CN", "=", "a", ".", "foo", ".", "com", "/", "O", "=", "CN", "=", "b", ".", "embed", ".", "com", ",", "foo", "/", ".", "*", "/", "private", "static", "final", "String", "BEGIN_B_EMBED_COM_CERT", "=", "\"", "MIICazCCAdSgAwIBAgIDAVJ9MA0GCSqGSIb3DQEBBQUAMDIxEjAQBgNVBAMTCWEu", "\"", "\"", "Zm9vLmNvbTEcMBoGA1UEChMTQ049Yi5lbWJlZC5jb20sIGZvbzAeFw0xNDA4MjAw", "\"", "\"", "NDUzNDJaFw0xNDA5MTkwNDUzNDJaMDIxEjAQBgNVBAMTCWEuZm9vLmNvbTEcMBoG", "\"", "\"", "A1UEChMTQ049Yi5lbWJlZC5jb20sIGZvbzCBnzANBgkqhkiG9w0BAQEFAAOBjQAw", "\"", "\"", "gYkCgYEA2oe29WdBaLWlYxKw8Hk8Gws19g5OpB", "+", "GG8yyef", "+", "P490iAg", "+", "M3n4", "+", "tXbd", "\"", "\"", "Jls9zTg6t5", "/", "8dAY6lfDCZBjdz9wCaJwE4g8YQr159iPAPOw1He1F6kHWcS3HUbfX", "\"", "\"", "Yzzv2G9gg0Ect3cFx3A", "+", "fFCrQTNumoHIE6dCO3E7DiEGnaVFVOECAwEAAaOBjjCB", "\"", "\"", "izAdBgNVHQ4EFgQUOeHQsTmcK1EGC5FMf", "+", "MPRVNWapcwXAYDVR0jBFUwU4AUOeHQ", "\"", "\"", "sTmcK1EGC5FMf", "+", "MPRVNWapehNqQ0MDIxEjAQBgNVBAMTCWEuZm9vLmNvbTEcMBoG", "\"", "\"", "A1UEChMTQ049Yi5lbWJlZC5jb20sIGZvb4IDAVJ9MAwGA1UdEwQFMAMBAf8wDQYJ", "\"", "\"", "KoZIhvcNAQEFBQADgYEAideRQI", "+", "/", "vGYAV4pP3vwB22mLwopN8Q7sKiH34l", "+", "Jt8ib", "\"", "\"", "UG9", "/", "HiI6nf2kizoqxK3yTWzQ7UpjsOI4pvNpXQ01IXcz9pdpUQOVCp60oEmWyie0", "\"", "\"", "qTSGaeM8OdLLJQeV9UZTZt7e", "/", "gnF", "+", "FHmrYcNKyM518IbJY", "+", "Pth87bJeFYcU7", "+", "MI", "=", "\";", "/", "**", "*", "Certificate", "test", "data", ".", "@", "@", "-", "254", ",", "6", "+", "329", ",", "20", "@", "@", "(", "X509Certificate", ")", "cf", ".", "generateCertificate", "(", "new", "ByteArrayInputStream", "(", "LdapUtil", ".", "base64Decode", "(", "LOCALHOST_ALTNAME_CERT", ")", "))", ";", "final", "X509Certificate", "aFooComMvCert", "=", "(", "X509Certificate", ")", "cf", ".", "generateCertificate", "(", "new", "ByteArrayInputStream", "(", "LdapUtil", ".", "base64Decode", "(", "A_FOO_COM_MV_CERT", ")", "))", ";", "final", "X509Certificate", "aFooComMvRdnCert", "=", "(", "X509Certificate", ")", "cf", ".", "generateCertificate", "(", "new", "ByteArrayInputStream", "(", "LdapUtil", ".", "base64Decode", "(", "A_FOO_COM_MV_RDN_CERT", ")", "))", ";", "final", "X509Certificate", "endBEmbedComCert", "=", "(", "X509Certificate", ")", "cf", ".", "generateCertificate", "(", "new", "ByteArrayInputStream", "(", "LdapUtil", ".", "base64Decode", "(", "END_B_EMBED_COM_CERT", ")", "))", ";", "final", "X509Certificate", "beginBEmbedComCert", "=", "(", "X509Certificate", ")", "cf", ".", "generateCertificate", "(", "new", "ByteArrayInputStream", "(", "LdapUtil", ".", "base64Decode", "(", "BEGIN_B_EMBED_COM_CERT", ")", "))", ";", "return", "new", "Object", "[", "][", "]", "{", "/", "*", "a", ".", "foo", ".", "com", "=", "=", "CN", "=", "a", ".", "foo", ".", "com", "*", "/", "@", "@", "-", "320", ",", "6", "+", "409", ",", "38", "@", "@", "new", "Object", "[", "]", "{", "\"", "127", ".", "0", ".", "0", ".", "1", "\"", ",", "localhostAltNameCert", ",", "true", ",", "}", ",", "/", "*", "a", ".", "foo", ".", "com", "!", "=", "CN", "=", "a", ".", "foo", ".", "com", "/", "CN", "=", "b", ".", "foo", ".", "com", "*", "/", "new", "Object", "[", "]", "{", "\"", "a", ".", "foo", ".", "com", "\"", ",", "aFooComMvCert", ",", "false", ",", "}", ",", "/", "*", "b", ".", "foo", ".", "com", "=", "=", "CN", "=", "a", ".", "foo", ".", "com", "/", "CN", "=", "b", ".", "foo", ".", "com", "*", "/", "new", "Object", "[", "]", "{", "\"", "b", ".", "foo", ".", "com", "\"", ",", "aFooComMvCert", ",", "true", ",", "}", ",", "/", "*", "a", ".", "foo", ".", "com", "=", "=", "CN", "=", "a", ".", "foo", ".", "com", "+", "CN", "=", "b", ".", "foo", ".", "com", "*", "/", "new", "Object", "[", "]", "{", "\"", "a", ".", "foo", ".", "com", "\"", ",", "aFooComMvRdnCert", ",", "true", ",", "}", ",", "/", "*", "b", ".", "foo", ".", "com", "!", "=", "CN", "=", "a", ".", "foo", ".", "com", "+", "CN", "=", "b", ".", "foo", ".", "com", "*", "/", "new", "Object", "[", "]", "{", "\"", "b", ".", "foo", ".", "com", "\"", ",", "aFooComMvRdnCert", ",", "false", ",", "}", ",", "/", "*", "a", ".", "foo", ".", "com", "=", "=", "CN", "=", "a", ".", "foo", ".", "com", "*", "/", "new", "Object", "[", "]", "{", "\"", "a", ".", "foo", ".", "com", "\"", ",", "endBEmbedComCert", ",", "true", "}", ",", "/", "*", "a", ".", "foo", ".", "com", "!", "=", "CN", "=", "b", ".", "embed", ".", "com", "*", "/", "new", "Object", "[", "]", "{", "\"", "b", ".", "embed", ".", "com", "\"", ",", "endBEmbedComCert", ",", "false", "}", ",", "/", "*", "a", ".", "foo", ".", "com", "=", "=", "CN", "=", "a", ".", "foo", ".", "com", "*", "/", "new", "Object", "[", "]", "{", "\"", "a", ".", "foo", ".", "com", "\"", ",", "beginBEmbedComCert", ",", "true", "}", ",", "/", "*", "a", ".", "foo", ".", "com", "!", "=", "CN", "=", "b", ".", "embed", ".", "com", "*", "/", "new", "Object", "[", "]", "{", "\"", "b", ".", "embed", ".", "com", "\"", ",", "beginBEmbedComCert", ",", "false", "}", ",", "}", ";", "}", "@", "@", "-", "332", ",", "13", "+", "453", ",", "26", "@", "@", "*", "@", "throws", "Exception", "On", "test", "failure", ".", "*", "/", "@", "Test", "(", "groups", "=", "{", "\"", "ssl", "\"", "},", "dataProvider", "=", "\"", "certificates", "\"", ")", "public", "void", "verify", "(", "public", "void", "verifyDefault", "(", "final", "String", "hostname", ",", "final", "X509Certificate", "cert", ",", "final", "boolean", "pass", ")", "throws", "Exception", "{", "Assert", ".", "assertEquals", "(", "DEFAULT_VERIFIER", ".", "verify", "(", "hostname", ",", "cert", ")", ",", "pass", ")", ";", "}", "/", "**", "*", "@", "param", "hostname", "to", "match", "against", "the", "cert", "*", "@", "param", "cert", "to", "extract", "hostname", "from", "*", "@", "param", "pass", "whether", "the", "verify", "should", "succeed", "*", "*", "@", "throws", "Exception", "On", "test", "failure", ".", "*", "/", "@", "Test", "(", "groups", "=", "{", "\"", "ssl", "\"", "},", "dataProvider", "=", "\"", "certificates", "\"", ")", "public", "void", "verifySun", "(", "final", "String", "hostname", ",", "final", "X509Certificate", "cert", ",", "final", "boolean", "pass", ")", "throws", "Exception", "{", "final", "boolean", "defaultResult", "=", "DEFAULT_VERIFIER", ".", "verify", "(", "hostname", ",", "cert", ")", ";", "final", "boolean", "sunResult", "=", "SUN_VERIFIER", ".", "verify", "(", "hostname", ",", "cert", ")", ";", "Assert", ".", "assertEquals", "(", "defaultResult", ",", "sunResult", ")", ";", "Assert", ".", "assertEquals", "(", "defaultResult", ",", "pass", ")", ";", "Assert", ".", "assertEquals", "(", "SUN_VERIFIER", ".", "verify", "(", "hostname", ",", "cert", ")", ",", "pass", ")", ";", "}", "}"], "docstring_tokens": ["via", "an", "arbitrary", "valid", "certificate", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "165", ",", "8", "+", "165", ",", "10", "@", "@", "import", "org", ".", "apache", ".", "mina", ".", "core", ".", "future", ".", "WriteFuture", ";", "import", "org", ".", "apache", ".", "mina", ".", "core", ".", "service", ".", "IoConnector", ";", "import", "org", ".", "apache", ".", "mina", ".", "core", ".", "session", ".", "IoSession", ";", "import", "org", ".", "apache", ".", "mina", ".", "filter", ".", "FilterEvent", ";", "import", "org", ".", "apache", ".", "mina", ".", "filter", ".", "codec", ".", "ProtocolCodecFilter", ";", "import", "org", ".", "apache", ".", "mina", ".", "filter", ".", "codec", ".", "ProtocolEncoderException", ";", "import", "org", ".", "apache", ".", "mina", ".", "filter", ".", "ssl", ".", "SslEvent", ";", "import", "org", ".", "apache", ".", "mina", ".", "filter", ".", "ssl", ".", "SslFilter", ";", "import", "org", ".", "apache", ".", "mina", ".", "transport", ".", "socket", ".", "SocketSessionConfig", ";", "import", "org", ".", "apache", ".", "mina", ".", "transport", ".", "socket", ".", "nio", ".", "NioSocketConnector", ";", "@", "@", "-", "242", ",", "6", "+", "244", ",", "9", "@", "@", "/", "**", "The", "krb5", "configuration", "property", "*", "/", "private", "static", "final", "String", "KRB5_CONF", "=", "\"", "java", ".", "security", ".", "krb5", ".", "conf", "\"", ";", "/", "**", "A", "future", "used", "to", "block", "any", "action", "until", "the", "handhake", "is", "completed", "*", "/", "private", "HandshakeFuture", "handshakeFuture", ";", "/", "/", "~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "common", "error", "messages", "~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~~", "~", "static", "final", "String", "TIME_OUT_ERROR", "=", "\"", "TimeOut", "occurred", "\"", ";", "@", "@", "-", "668", ",", "6", "+", "673", ",", "26", "@", "@", "public", "boolean", "connect", "(", ")", "throws", "LdapException", "while", "(", "maxRetry", ">", "System", ".", "currentTimeMillis", "(", ")", "&", "&", "!", "interrupted", ")", "{", "connectionFuture", "=", "connector", ".", "connect", "(", "address", ")", ";", "if", "(", "config", ".", "isUseSsl", "(", ")", ")", "{", "try", "{", "boolean", "isSecured", "=", "handshakeFuture", ".", "get", "(", "timeout", ",", "TimeUnit", ".", "MILLISECONDS", ")", ";", "if", "(", "!", "isSecured", ")", "{", "throw", "new", "LdapOperationException", "(", "ResultCodeEnum", ".", "OTHER", ",", "I18n", ".", "err", "(", "I18n", ".", "ERR_4100_TLS_HANDSHAKE_ERROR", ")", ")", ";", "}", "}", "catch", "(", "Exception", "e", ")", "{", "String", "msg", "=", "\"", "Failed", "to", "initialize", "the", "SSL", "context", "\"", ";", "LOG", ".", "error", "(", "msg", ",", "e", ")", ";", "throw", "new", "LdapException", "(", "msg", ",", "e", ")", ";", "}", "}", "boolean", "result", "=", "false", ";", "@", "@", "-", "861", ",", "7", "+", "886", ",", "6", "@", "@", "else", "if", "(", "responseFuture", "instanceof", "SearchFuture", ")", "/", "/", "Get", "back", "the", "session", "ldapSession", "=", "connectionFuture", ".", "getSession", "(", ");", "connected", ".", "set", "(", "true", ")", ";", "/", "/", "Store", "the", "container", "into", "the", "session", "if", "we", "don", "'", "t", "have", "one", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "@", "@", "-", "2432", ",", "27", "+", "2456", ",", "6", "@", "@", "private", "boolean", "isNoticeOfDisconnect", "(", "Message", "message", ")", "public", "void", "messageReceived", "(", "IoSession", "session", ",", "Object", "message", ")", "throws", "Exception", "{", "/", "/", "Feed", "the", "response", "and", "store", "it", "into", "the", "session", "if", "(", "message", "instanceof", "SslFilter", ".", "SslFilterMessage", ")", "{", "/", "/", "This", "is", "a", "SSL", "message", "telling", "if", "the", "session", "has", "been", "secured", "or", "not", "HandshakeFuture", "handshakeFuture", "=", "(", "HandshakeFuture", ")", "ldapSession", ".", "getAttribute", "(", "\"", "HANDSHAKE_FUTURE", "\"", ")", ";", "if", "(", "message", "=", "=", "SslFilter", ".", "SESSION_SECURED", ")", "{", "/", "/", "SECURED", "handshakeFuture", ".", "secured", "(", ");", "}", "else", "{", "/", "/", "UNSECURED", "handshakeFuture", ".", "cancel", "(", ");", "}", "ldapSession", ".", "removeAttribute", "(", "\"", "HANDSHAKE_FUTURE", "\"", ")", ";", "return", ";", "}", "Message", "response", "=", "(", "Message", ")", "message", ";", "if", "(", "LOG", ".", "isDebugEnabled", "(", ")", ")", "@", "@", "-", "4529", ",", "6", "+", "4532", ",", "7", "@", "@", "public", "void", "sessionCreated", "(", "IoSession", "session", ")", "throws", "Exception", "codec", ",", "config", ".", "getBinaryAttributeDetector", "(", ")", ")", ";", "session", ".", "setAttribute", "(", "LdapDecoder", ".", "MESSAGE_CONTAINER_ATTR", ",", "ldapMessageContainer", ")", ";", "connected", ".", "set", "(", "true", ")", ";", "}", "@", "@", "-", "4680", ",", "20", "+", "4684", ",", "16", "@", "@", "private", "void", "addSslFilter", "(", ")", "throws", "LdapException", "{", "\"", "TLSv1", "\"", ",", "\"", "TLSv1", ".", "1", "\"", ",", "\"", "TLSv1", ".", "2", "\"", "}", ")", ";", "}", "/", "/", "for", "LDAPS", "/", "/", "for", "LDAPS", "/", "TLS", "handshakeFuture", "=", "new", "HandshakeFuture", "(", ");", "if", "(", "(", "ldapSession", "=", "=", "null", ")", "|", "|", "!", "connected", ".", "get", "(", ")", ")", "{", "connector", ".", "getFilterChain", "(", ").", "addFirst", "(", "SSL_FILTER_KEY", ",", "sslFilter", ")", ";", "}", "else", "/", "/", "for", "StartTLS", "{", "HandshakeFuture", "handshakeFuture", "=", "new", "HandshakeFuture", "(", ");", "ldapSession", ".", "setAttribute", "(", "SslFilter", ".", "USE_NOTIFICATION", ",", "Boolean", ".", "TRUE", ")", ";", "ldapSession", ".", "setAttribute", "(", "\"", "HANDSHAKE_FUTURE", "\"", ",", "handshakeFuture", ")", ";", "ldapSession", ".", "getFilterChain", "(", ").", "addFirst", "(", "SSL_FILTER_KEY", ",", "sslFilter", ")", ";", "boolean", "isSecured", "=", "handshakeFuture", ".", "get", "(", "timeout", ",", "TimeUnit", ".", "MILLISECONDS", ")", ";", "if", "(", "!", "isSecured", ")", "@", "@", "-", "4911", ",", "13", "+", "4911", ",", "6", "@", "@", "public", "BindFuture", "bindSasl", "(", "SaslRequest", "saslRequest", ")", "throws", "LdapException", "*", "/", "private", "void", "writeRequest", "(", "Request", "request", ")", "throws", "LdapException", "{", "/", "/", "If", "we", "are", "meant", "to", "be", "using", "a", "secure", "connection", "but", "the", "ssl", "filter", "isn", "'", "in", "the", "filter", "chain", "then", "/", "/", "throw", "immediately", "if", "(", "config", ".", "isUseSsl", "(", ")", "&", "&", "!", "ldapSession", ".", "getFilterChain", "(", ").", "contains", "(", "\"", "sslFilter", "\"", ")", ")", "{", "throw", "new", "InvalidConnectionException", "(", "\"", "Attempting", "to", "send", "over", "an", "insecure", "connection", "\"", ")", ";", "}", "/", "/", "Send", "the", "request", "to", "the", "server", "WriteFuture", "writeFuture", "=", "ldapSession", ".", "write", "(", "request", ")", ";", "@", "@", "-", "5090", ",", "4", "+", "5083", ",", "18", "@", "@", "public", "void", "setConnectionConfig", "(", "SocketSessionConfig", "connectionConfig", ")", "{", "this", ".", "connectionConfig", "=", "connectionConfig", ";", "}", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/", "@", "Override", "public", "void", "event", "(", "IoSession", "session", ",", "FilterEvent", "event", ")", "throws", "Exception", "{", "/", "/", "Check", "if", "it", "'", "s", "a", "SSLevent", "if", "(", "(", "event", "instanceof", "SslEvent", ")", "&", "&", "(", "(", "SslEvent", ")", "event", "=", "=", "SslEvent", ".", "SECURED", ")", ")", "{", "handshakeFuture", ".", "secured", "(", ");", "}", "}", "}"], "docstring_tokens": ["using", "connections", "put", "back", "in", "a", "pool", "of", "connections"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "203", ",", "6", "+", "203", ",", "11", "@", "@", "PHP", "NEWS", ".", "Added", "SplObjectStorage", ":", ":", "getHash", "(", ")", "hook", ".", "(", "Etienne", ")", ".", "Added", "CallbackFilterIterator", "and", "RecursiveCallbackFilterIterator", "(", "Arnaud", ")", "-", "Improved", "XSL", "extension", ":", ".", "Added", "XsltProcessor", ":", ":", "setSecurityPrefs", "(", "$", "options", ")", "and", "getSecurityPrefs", "(", ")", "to", "define", "forbidden", "operations", "within", "XSLT", "stylesheets", ",", "default", "is", "not", "to", "enable", "any", "write", "operations", "from", "XSLT", "anymore", ".", "Bug", "#", "54446", "-", "Improved", "ZLIB", "extension", ":", ".", "Re", "-", "implemented", "non", "-", "file", "related", "functionality", ".", "(", "Mike", ")", "@", "@", "-", "174", ",", "6", "+", "174", ",", "9", "@", "@", "UPGRADE", "NOTES", "-", "PHP", "X", ".", "Y", "just", "the", "first", "matching", "node", ".", "-", "All", "SimpleXMLElement", "children", "are", "now", "always", "printed", "when", "using", "var_dump", "(", "),", "var_export", "(", "),", "and", "print_r", "(", ").", "-", "Write", "operations", "within", "XSLT", "(", "for", "example", "with", "the", "extension", "sax", ":", "output", ")", "are", "disabled", "by", "default", ".", "You", "can", "define", "what", "is", "forbidden", "with", "the", "method", "XsltProcess", ":", ":", "setSecurityPrefs", "(", "$", "options", ")", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "5", ".", "Changes", "made", "to", "existing", "methods", "@", "@", "-", "126", ",", "6", "+", "126", ",", "7", "@", "@", "zend_object_value", "xsl_objects_new", "(", "zend_class_entry", "*", "class_type", "TSRMLS_DC", ")", "intern", "-", ">", "node_list", "=", "NULL", ";", "intern", "-", ">", "doc", "=", "NULL", ";", "intern", "-", ">", "profiling", "=", "NULL", ";", "intern", "-", ">", "securityPrefs", "=", "XSL_SECPREF_WRITE_FILE", "|", "XSL_SECPREF_WRITE_NETWORK", "|", "XSL_SECPREF_CREATE_DIRECTORY", ";", "zend_object_std_init", "(", "&", "intern", "-", ">", "std", ",", "class_type", "TSRMLS_CC", ")", ";", "object_properties_init", "(", "&", "intern", "-", ">", "std", ",", "class_type", ")", ";", "@", "@", "-", "166", ",", "6", "+", "167", ",", "13", "@", "@", "PHP_MINIT_FUNCTION", "(", "xsl", ")", "REGISTER_LONG_CONSTANT", "(", "\"", "XSL_CLONE_NEVER", "\"", ",", "-", "1", ",", "CONST_CS", "|", "CONST_PERSISTENT", ")", ";", "REGISTER_LONG_CONSTANT", "(", "\"", "XSL_CLONE_ALWAYS", "\"", ",", "1", ",", "CONST_CS", "|", "CONST_PERSISTENT", ")", ";", "REGISTER_LONG_CONSTANT", "(", "\"", "XSL_SECPREF_NONE", "\"", ",", "XSL_SECPREF_NONE", ",", "CONST_CS", "|", "CONST_PERSISTENT", ")", ";", "REGISTER_LONG_CONSTANT", "(", "\"", "XSL_SECPREF_READ_FILE", "\"", ",", "XSL_SECPREF_READ_FILE", ",", "CONST_CS", "|", "CONST_PERSISTENT", ")", ";", "REGISTER_LONG_CONSTANT", "(", "\"", "XSL_SECPREF_WRITE_FILE", "\"", ",", "XSL_SECPREF_WRITE_FILE", ",", "CONST_CS", "|", "CONST_PERSISTENT", ")", ";", "REGISTER_LONG_CONSTANT", "(", "\"", "XSL_SECPREF_CREATE_DIRECTORY", "\"", ",", "XSL_SECPREF_CREATE_DIRECTORY", ",", "CONST_CS", "|", "CONST_PERSISTENT", ")", ";", "REGISTER_LONG_CONSTANT", "(", "\"", "XSL_SECPREF_READ_NETWORK", "\"", ",", "XSL_SECPREF_READ_NETWORK", ",", "CONST_CS", "|", "CONST_PERSISTENT", ")", ";", "REGISTER_LONG_CONSTANT", "(", "\"", "XSL_SECPREF_WRITE_NETWORK", "\"", ",", "XSL_SECPREF_WRITE_NETWORK", ",", "CONST_CS", "|", "CONST_PERSISTENT", ")", ";", "REGISTER_LONG_CONSTANT", "(", "\"", "LIBXSLT_VERSION", "\"", ",", "LIBXSLT_VERSION", ",", "CONST_CS", "|", "CONST_PERSISTENT", ")", ";", "REGISTER_STRING_CONSTANT", "(", "\"", "LIBXSLT_DOTTED_VERSION", "\"", ",", "LIBXSLT_DOTTED_VERSION", ",", "CONST_CS", "|", "CONST_PERSISTENT", ")", ";", "@", "@", "-", "32", ",", "6", "+", "32", ",", "7", "@", "@", "extern", "zend_module_entry", "xsl_module_entry", ";", "#", "include", "<", "libxslt", "/", "xsltInternals", ".", "h", ">", "#", "include", "<", "libxslt", "/", "xsltutils", ".", "h", ">", "#", "include", "<", "libxslt", "/", "transform", ".", "h", ">", "#", "include", "<", "libxslt", "/", "security", ".", "h", ">", "#", "if", "HAVE_XSL_EXSLT", "#", "include", "<", "libexslt", "/", "exslt", ".", "h", ">", "#", "include", "<", "libexslt", "/", "exsltconfig", ".", "h", ">", "@", "@", "-", "43", ",", "6", "+", "44", ",", "13", "@", "@", "extern", "zend_module_entry", "xsl_module_entry", ";", "#", "include", "<", "libxslt", "/", "extensions", ".", "h", ">", "#", "include", "<", "libxml", "/", "xpathInternals", ".", "h", ">", "#", "define", "XSL_SECPREF_NONE", "0", "#", "define", "XSL_SECPREF_READ_FILE", "2", "#", "define", "XSL_SECPREF_WRITE_FILE", "4", "#", "define", "XSL_SECPREF_CREATE_DIRECTORY", "8", "#", "define", "XSL_SECPREF_READ_NETWORK", "16", "#", "define", "XSL_SECPREF_WRITE_NETWORK", "32", "typedef", "struct", "_xsl_object", "{", "zend_object", "std", ";", "void", "*", "ptr", ";", "@", "@", "-", "55", ",", "6", "+", "63", ",", "7", "@", "@", "typedef", "struct", "_xsl_object", "{", "HashTable", "*", "node_list", ";", "php_libxml_node_object", "*", "doc", ";", "char", "*", "profiling", ";", "long", "securityPrefs", ";", "}", "xsl_object", ";", "void", "php_xsl_set_object", "(", "zval", "*", "wrapper", ",", "void", "*", "obj", "TSRMLS_DC", ")", ";", "@", "@", "-", "34", ",", "6", "+", "34", ",", "9", "@", "@", "PHP_FUNCTION", "(", "xsl_xsltprocessor_remove_parameter", ")", ";", "PHP_FUNCTION", "(", "xsl_xsltprocessor_has_exslt_support", ")", ";", "PHP_FUNCTION", "(", "xsl_xsltprocessor_register_php_functions", ")", ";", "PHP_FUNCTION", "(", "xsl_xsltprocessor_set_profiling", ")", ";", "PHP_FUNCTION", "(", "xsl_xsltprocessor_set_security_prefs", ")", ";", "PHP_FUNCTION", "(", "xsl_xsltprocessor_get_security_prefs", ")", ";", "#", "endif", "/", "*", "@", "@", "-", "71", ",", "6", "+", "71", ",", "13", "@", "@", "ZEND_END_ARG_INFO", "(", ");", "ZEND_BEGIN_ARG_INFO_EX", "(", "arginfo_xsl_xsltprocessor_set_profiling", ",", "0", ",", "0", ",", "1", ")", "ZEND_ARG_INFO", "(", "0", ",", "filename", ")", "ZEND_END_ARG_INFO", "(", ");", "ZEND_BEGIN_ARG_INFO_EX", "(", "arginfo_xsl_xsltprocessor_set_security_prefs", ",", "0", ",", "0", ",", "1", ")", "ZEND_ARG_INFO", "(", "0", ",", "securityPrefs", ")", "ZEND_END_ARG_INFO", "(", ");", "ZEND_BEGIN_ARG_INFO_EX", "(", "arginfo_xsl_xsltprocessor_get_security_prefs", ",", "0", ",", "0", ",", "0", ")", "ZEND_END_ARG_INFO", "(", ");", "/", "*", "}", "}}", "*", "/", "/", "*", "@", "@", "-", "91", ",", "6", "+", "98", ",", "8", "@", "@", "const", "zend_function_entry", "php_xsl_xsltprocessor_class_functions", "[", "]", "=", "{", "PHP_FALIAS", "(", "hasExsltSupport", ",", "xsl_xsltprocessor_has_exslt_support", ",", "arginfo_xsl_xsltprocessor_has_exslt_support", ")", "PHP_FALIAS", "(", "registerPHPFunctions", ",", "xsl_xsltprocessor_register_php_functions", ",", "arginfo_xsl_xsltprocessor_register_php_functions", ")", "PHP_FALIAS", "(", "setProfiling", ",", "xsl_xsltprocessor_set_profiling", ",", "arginfo_xsl_xsltprocessor_set_profiling", ")", "PHP_FALIAS", "(", "setSecurityPrefs", ",", "xsl_xsltprocessor_set_security_prefs", ",", "arginfo_xsl_xsltprocessor_set_security_prefs", ")", "PHP_FALIAS", "(", "getSecurityPrefs", ",", "xsl_xsltprocessor_get_security_prefs", ",", "arginfo_xsl_xsltprocessor_get_security_prefs", ")", "{", "NULL", ",", "NULL", ",", "NULL", "}", "}", ";", "@", "@", "-", "531", ",", "11", "+", "540", ",", "46", "@", "@", "static", "xmlDocPtr", "php_xsl_apply_stylesheet", "(", "zval", "*", "id", ",", "xsl_object", "*", "intern", ",", "xsltStyl", "}", "efree", "(", "member", ")", ";", "/", "*", "Add", "security", "checks", "*", "/", "/", "*", "XSLT_SECPREF_READ_FILE", "and", "XSLT_SECPREF_READ_NETWORK", "aren", "'", "t", "needed", "*", "/", "xsltSecurityPrefsPtr", "secPrefs", "=", "xsltNewSecurityPrefs", "(", ");", "if", "(", "intern", "-", ">", "securityPrefs", "&", "XSL_SECPREF_READ_FILE", ")", "{", "if", "(", "0", "!", "=", "xsltSetSecurityPrefs", "(", "secPrefs", ",", "XSLT_SECPREF_READ_FILE", ",", "xsltSecurityForbid", ")", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "Can", "'", "t", "set", "libxslt", "security", "properties", "\"", ");", "}", "}", "if", "(", "intern", "-", ">", "securityPrefs", "&", "XSL_SECPREF_WRITE_FILE", ")", "{", "if", "(", "0", "!", "=", "xsltSetSecurityPrefs", "(", "secPrefs", ",", "XSLT_SECPREF_WRITE_FILE", ",", "xsltSecurityForbid", ")", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "Can", "'", "t", "set", "libxslt", "security", "properties", "\"", ");", "}", "}", "if", "(", "intern", "-", ">", "securityPrefs", "&", "XSL_SECPREF_CREATE_DIRECTORY", ")", "{", "if", "(", "0", "!", "=", "xsltSetSecurityPrefs", "(", "secPrefs", ",", "XSLT_SECPREF_CREATE_DIRECTORY", ",", "xsltSecurityForbid", ")", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "Can", "'", "t", "set", "libxslt", "security", "properties", "\"", ");", "}", "}", "if", "(", "intern", "-", ">", "securityPrefs", "&", "XSL_SECPREF_READ_NETWORK", ")", "{", "if", "(", "0", "!", "=", "xsltSetSecurityPrefs", "(", "secPrefs", ",", "XSLT_SECPREF_READ_NETWORK", ",", "xsltSecurityForbid", ")", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "Can", "'", "t", "set", "libxslt", "security", "properties", "\"", ");", "}", "}", "if", "(", "intern", "-", ">", "securityPrefs", "&", "XSL_SECPREF_WRITE_NETWORK", ")", "{", "if", "(", "0", "!", "=", "xsltSetSecurityPrefs", "(", "secPrefs", ",", "XSLT_SECPREF_WRITE_NETWORK", ",", "xsltSecurityForbid", ")", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "Can", "'", "t", "set", "libxslt", "security", "properties", "\"", ");", "}", "}", "if", "(", "0", "!", "=", "xsltSetCtxtSecurityPrefs", "(", "secPrefs", ",", "ctxt", ")", ")", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "Can", "'", "t", "set", "libxslt", "security", "handler", "\"", ");", "newdocp", "=", "xsltApplyStylesheetUser", "(", "style", ",", "doc", ",", "(", "const", "char", "*", "*)", "params", ",", "NULL", ",", "f", ",", "ctxt", ")", ";", "if", "(", "f", ")", "{", "fclose", "(", "f", ")", ";", "}", "xsltFreeTransformContext", "(", "ctxt", ")", ";", "xsltFreeSecurityPrefs", "(", "secPrefs", ")", ";", "if", "(", "intern", "-", ">", "node_list", "!", "=", "NULL", ")", "{", "zend_hash_destroy", "(", "intern", "-", ">", "node_list", ")", ";", "@", "@", "-", "857", ",", "6", "+", "901", ",", "44", "@", "@", "PHP_FUNCTION", "(", "xsl_xsltprocessor_set_profiling", ")", "}", "/", "*", "}", "}}", "end", "xsl_xsltprocessor_set_profiling", "*", "/", "/", "*", "{", "{{", "proto", "long", "xsl_xsltprocessor_set_security_prefs", "(", "long", "securityPrefs", ")", "*", "/", "PHP_FUNCTION", "(", "xsl_xsltprocessor_set_security_prefs", ")", "{", "zval", "*", "id", ";", "xsl_object", "*", "intern", ";", "DOM_GET_THIS", "(", "id", ")", ";", "long", "securityPrefs", ",", "oldSecurityPrefs", ";", "if", "(", "zend_parse_parameters_ex", "(", "ZEND_PARSE_PARAMS_QUIET", ",", "ZEND_NUM_ARGS", "(", ")", "TSRMLS_CC", ",", "\"", "l", "\"", ",", "&", "securityPrefs", ")", "=", "=", "SUCCESS", ")", "{", "intern", "=", "(", "xsl_object", "*", ")", "zend_object_store_get_object", "(", "id", "TSRMLS_CC", ")", ";", "oldSecurityPrefs", "=", "intern", "-", ">", "securityPrefs", ";", "intern", "-", ">", "securityPrefs", "=", "securityPrefs", ";", "RETURN_LONG", "(", "oldSecurityPrefs", ")", ";", "}", "else", "{", "WRONG_PARAM_COUNT", ";", "}", "}", "/", "*", "}", "}}", "end", "xsl_xsltprocessor_set_security_prefs", "*", "/", "/", "*", "{", "{{", "proto", "long", "xsl_xsltprocessor_get_security_prefs", "(", ")", "*", "/", "PHP_FUNCTION", "(", "xsl_xsltprocessor_get_security_prefs", ")", "{", "zval", "*", "id", ";", "xsl_object", "*", "intern", ";", "DOM_GET_THIS", "(", "id", ")", ";", "long", "securityPrefs", ";", "if", "(", "zend_parse_parameters_ex", "(", "ZEND_PARSE_PARAMS_QUIET", ",", "ZEND_NUM_ARGS", "(", ")", "TSRMLS_CC", ",", "\"", "\")", "=", "=", "SUCCESS", ")", "{", "intern", "=", "(", "xsl_object", "*", ")", "zend_object_store_get_object", "(", "id", "TSRMLS_CC", ")", ";", "RETURN_LONG", "(", "intern", "-", ">", "securityPrefs", ")", ";", "}", "else", "{", "WRONG_PARAM_COUNT", ";", "}", "}", "/", "*", "}", "}}", "end", "xsl_xsltprocessor_get_security_prefs", "*", "/", "/", "*", "{", "{{", "proto", "bool", "xsl_xsltprocessor_has_exslt_support", "(", ");", "*", "/", "PHP_FUNCTION", "(", "xsl_xsltprocessor_has_exslt_support", ")"], "docstring_tokens": ["uses", "something", "like", "\"<sax:output", "href=\"0wn3d.php"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "25", ",", "6", "+", "25", ",", "7", "@", "@", "#", "include", "<", "linux", "/", "slab", ".", "h", ">", "#", "include", "<", "linux", "/", "wait", ".", "h", ">", "#", "include", "<", "linux", "/", "mount", ".", "h", ">", "#", "include", "<", "linux", "/", "file", ".", "h", ">", "#", "include", "\"", "ecryptfs_kernel", ".", "h", "\"", "struct", "ecryptfs_open_req", "{", "@", "@", "-", "147", ",", "7", "+", "148", ",", "7", "@", "@", "int", "ecryptfs_privileged_open", "(", "struct", "file", "*", "*", "lower_file", ",", "flags", "|", "=", "IS_RDONLY", "(", "d_inode", "(", "lower_dentry", ")", ")", "?", "O_RDONLY", ":", "O_RDWR", ";", "(", "*", "lower_file", ")", "=", "dentry_open", "(", "&", "req", ".", "path", ",", "flags", ",", "cred", ")", ";", "if", "(", "!", "IS_ERR", "(", "*", "lower_file", ")", ")", "goto", "out", ";", "goto", "have_file", ";", "if", "(", "(", "flags", "&", "O_ACCMODE", ")", "=", "=", "O_RDONLY", ")", "{", "rc", "=", "PTR_ERR", "(", "(*", "lower_file", ")", ");", "goto", "out", ";", "@", "@", "-", "165", ",", "8", "+", "166", ",", "16", "@", "@", "int", "ecryptfs_privileged_open", "(", "struct", "file", "*", "*", "lower_file", ",", "mutex_unlock", "(", "&", "ecryptfs_kthread_ctl", ".", "mux", ")", ";", "wake_up", "(", "&", "ecryptfs_kthread_ctl", ".", "wait", ")", ";", "wait_for_completion", "(", "&", "req", ".", "done", ")", ";", "if", "(", "IS_ERR", "(", "*", "lower_file", ")", ")", "if", "(", "IS_ERR", "(", "*", "lower_file", ")", ")", "{", "rc", "=", "PTR_ERR", "(", "*", "lower_file", ")", ";", "goto", "out", ";", "}", "have_file", ":", "if", "(", "(*", "lower_file", ")", "->", "f_op", "-", ">", "mmap", "=", "=", "NULL", ")", "{", "fput", "(", "*", "lower_file", ")", ";", "*", "lower_file", "=", "NULL", ";", "rc", "=", "-", "EMEDIUMTYPE", ";", "}", "out", ":", "return", "rc", ";", "}"], "docstring_tokens": ["create", "a", "stack", "with", "a", "bounded", "length", "that", "is", "still", "too", "high"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "51", ",", "7", "+", "51", ",", "7", "@", "@", "*", "A", "<", "a", "href", "=", "\"", "http", ":", "//", "camel", ".", "apache", ".", "org", "/", "data", "-", "format", ".", "html", "\"", ">", "data", "format", "<", "/", "a", ">", "(", "{@", "link", "DataFormat", "}", ")", "*", "using", "<", "a", "href", "=", "\"", "http", ":", "//", "www", ".", "snakeyaml", ".", "org", "\"", ">", "SnakeYAML", "<", "/", "a", ">", "to", "marshal", "to", "and", "from", "YAML", ".", "*", "/", "public", "final", "class", "SnakeYAMLDataFormat", "extends", "ServiceSupport", "implements", "DataFormat", ",", "DataFormatName", "{", "public", "class", "SnakeYAMLDataFormat", "extends", "ServiceSupport", "implements", "DataFormat", ",", "DataFormatName", "{", "private", "final", "ThreadLocal", "<", "WeakReference", "<", "Yaml", ">", ">", "yamlCache", ";", "private", "BaseConstructor", "constructor", ";", "private", "Representer", "representer", ";", "@", "@", "-", "77", ",", "7", "+", "77", ",", "9", "@", "@", "public", "SnakeYAMLDataFormat", "(", "Class", "<", "?>", "type", ")", "{", "this", ".", "allowAnyType", "=", "false", ";", "if", "(", "type", "!", "=", "null", ")", "{", "setUnmarshalType", "(", "type", ")", ";", "this", ".", "unmarshalType", "=", "type", ";", "this", ".", "typeFilters", "=", "new", "CopyOnWriteArrayList", "<", ">(", ");", "this", ".", "typeFilters", ".", "add", "(", "TypeFilters", ".", "types", "(", "type", ")", ");", "}", "}"], "docstring_tokens": ["using", "de-serializing", "untrusted", "data"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "103", ",", "7", "+", "103", ",", "7", "@", "@", "static", "int", "ext2_commit_chunk", "(", "struct", "page", "*", "page", ",", "loff_t", "pos", ",", "unsigned", "len", ")", "return", "err", ";", "}", "static", "void", "ext2_check_page", "(", "struct", "page", "*", "page", ")", "static", "void", "ext2_check_page", "(", "struct", "page", "*", "page", ",", "int", "quiet", ")", "{", "struct", "inode", "*", "dir", "=", "page", "-", ">", "mapping", "-", ">", "host", ";", "struct", "super_block", "*", "sb", "=", "dir", "-", ">", "i_sb", ";", "@", "@", "-", "146", ",", "10", "+", "146", ",", "10", "@", "@", "static", "void", "ext2_check_page", "(", "struct", "page", "*", "page", ")", "/", "*", "Too", "bad", ",", "we", "had", "an", "error", "*", "/", "Ebadsize", ":", "ext2_error", "(", "sb", ",", "\"", "ext2_check_page", "\"", ",", "\"", "size", "of", "directory", "#", "%", "lu", "is", "not", "a", "multiple", "of", "chunk", "size", "\"", ",", "dir", "-", ">", "i_ino", ")", ";", "if", "(", "!", "quiet", ")", "ext2_error", "(", "sb", ",", "__func__", ",", "\"", "size", "of", "directory", "#", "%", "lu", "is", "not", "a", "multiple", "\"", "\"", "of", "chunk", "size", "\"", ",", "dir", "-", ">", "i_ino", ")", ";", "goto", "fail", ";", "Eshort", ":", "error", "=", "\"", "rec_len", "is", "smaller", "than", "minimal", "\"", ";", "@", "@", "-", "166", ",", "32", "+", "166", ",", "36", "@", "@", "static", "void", "ext2_check_page", "(", "struct", "page", "*", "page", ")", "Einumber", ":", "error", "=", "\"", "inode", "out", "of", "bounds", "\"", ";", "bad_entry", ":", "ext2_error", "(", "sb", ",", "\"", "ext2_check_page", "\"", ",", "\"", "bad", "entry", "in", "directory", "#", "%", "lu", ":", "%", "s", "-", "\"", "\"", "offset", "=", "%", "lu", ",", "inode", "=", "%", "lu", ",", "rec_len", "=", "%", "d", ",", "name_len", "=", "%", "d", "\"", ",", "dir", "-", ">", "i_ino", ",", "error", ",", "(", "page", "-", ">", "index", "<", "<", "PAGE_CACHE_SHIFT", ")", "+", "offs", ",", "(", "unsigned", "long", ")", "le32_to_cpu", "(", "p", "-", ">", "inode", ")", ",", "rec_len", ",", "p", "-", ">", "name_len", ")", ";", "if", "(", "!", "quiet", ")", "ext2_error", "(", "sb", ",", "__func__", ",", "\"", "bad", "entry", "in", "directory", "#", "%", "lu", ":", ":", "%", "s", "-", "\"", "\"", "offset", "=", "%", "lu", ",", "inode", "=", "%", "lu", ",", "rec_len", "=", "%", "d", ",", "name_len", "=", "%", "d", "\"", ",", "dir", "-", ">", "i_ino", ",", "error", ",", "(", "page", "-", ">", "index", "<", "<", "PAGE_CACHE_SHIFT", ")", "+", "offs", ",", "(", "unsigned", "long", ")", "le32_to_cpu", "(", "p", "-", ">", "inode", ")", ",", "rec_len", ",", "p", "-", ">", "name_len", ")", ";", "goto", "fail", ";", "Eend", ":", "p", "=", "(", "ext2_dirent", "*", ")(", "kaddr", "+", "offs", ")", ";", "ext2_error", "(", "sb", ",", "\"", "ext2_check_page", "\"", ",", "\"", "entry", "in", "directory", "#", "%", "lu", "spans", "the", "page", "boundary", "\"", "\"", "offset", "=", "%", "lu", ",", "inode", "=", "%", "lu", "\"", ",", "dir", "-", ">", "i_ino", ",", "(", "page", "-", ">", "index", "<", "<", "PAGE_CACHE_SHIFT", ")", "+", "offs", ",", "(", "unsigned", "long", ")", "le32_to_cpu", "(", "p", "-", ">", "inode", ")", ");", "if", "(", "!", "quiet", ")", "{", "p", "=", "(", "ext2_dirent", "*", ")(", "kaddr", "+", "offs", ")", ";", "ext2_error", "(", "sb", ",", "\"", "ext2_check_page", "\"", ",", "\"", "entry", "in", "directory", "#", "%", "lu", "spans", "the", "page", "boundary", "\"", "\"", "offset", "=", "%", "lu", ",", "inode", "=", "%", "lu", "\"", ",", "dir", "-", ">", "i_ino", ",", "(", "page", "-", ">", "index", "<", "<", "PAGE_CACHE_SHIFT", ")", "+", "offs", ",", "(", "unsigned", "long", ")", "le32_to_cpu", "(", "p", "-", ">", "inode", ")", ");", "}", "fail", ":", "SetPageChecked", "(", "page", ")", ";", "SetPageError", "(", "page", ")", ";", "}", "static", "struct", "page", "*", "ext2_get_page", "(", "struct", "inode", "*", "dir", ",", "unsigned", "long", "n", ")", "static", "struct", "page", "*", "ext2_get_page", "(", "struct", "inode", "*", "dir", ",", "unsigned", "long", "n", ",", "int", "quiet", ")", "{", "struct", "address_space", "*", "mapping", "=", "dir", "-", ">", "i_mapping", ";", "struct", "page", "*", "page", "=", "read_mapping_page", "(", "mapping", ",", "n", ",", "NULL", ")", ";", "if", "(", "!", "IS_ERR", "(", "page", ")", ")", "{", "kmap", "(", "page", ")", ";", "if", "(", "!", "PageChecked", "(", "page", ")", ")", "ext2_check_page", "(", "page", ")", ";", "ext2_check_page", "(", "page", ",", "quiet", ")", ";", "if", "(", "PageError", "(", "page", ")", ")", "goto", "fail", ";", "}", "@", "@", "-", "292", ",", "7", "+", "296", ",", "7", "@", "@", "ext2_readdir", "(", "struct", "file", "*", "filp", ",", "void", "*", "dirent", ",", "filldir_t", "filldir", ")", "for", "(", ";", "n", "<", "npages", ";", "n", "+", "+,", "offset", "=", "0", ")", "{", "char", "*", "kaddr", ",", "*", "limit", ";", "ext2_dirent", "*", "de", ";", "struct", "page", "*", "page", "=", "ext2_get_page", "(", "inode", ",", "n", ")", ";", "struct", "page", "*", "page", "=", "ext2_get_page", "(", "inode", ",", "n", ",", "0", ")", ";", "if", "(", "IS_ERR", "(", "page", ")", ")", "{", "ext2_error", "(", "sb", ",", "__func__", ",", "@", "@", "-", "361", ",", "6", "+", "365", ",", "7", "@", "@", "struct", "ext2_dir_entry_2", "*", "ext2_find_entry", "(", "struct", "inode", "*", "dir", ",", "struct", "page", "*", "page", "=", "NULL", ";", "struct", "ext2_inode_info", "*", "ei", "=", "EXT2_I", "(", "dir", ")", ";", "ext2_dirent", "*", "de", ";", "int", "dir_has_error", "=", "0", ";", "if", "(", "npages", "=", "=", "0", ")", "goto", "out", ";", "@", "@", "-", "374", ",", "7", "+", "379", ",", "7", "@", "@", "struct", "ext2_dir_entry_2", "*", "ext2_find_entry", "(", "struct", "inode", "*", "dir", ",", "n", "=", "start", ";", "do", "{", "char", "*", "kaddr", ";", "page", "=", "ext2_get_page", "(", "dir", ",", "n", ")", ";", "page", "=", "ext2_get_page", "(", "dir", ",", "n", ",", "dir_has_error", ")", ";", "if", "(", "!", "IS_ERR", "(", "page", ")", ")", "{", "kaddr", "=", "page_address", "(", "page", ")", ";", "de", "=", "(", "ext2_dirent", "*", ")", "kaddr", ";", "@", "@", "-", "391", ",", "7", "+", "396", ",", "9", "@", "@", "struct", "ext2_dir_entry_2", "*", "ext2_find_entry", "(", "struct", "inode", "*", "dir", ",", "de", "=", "ext2_next_entry", "(", "de", ")", ";", "}", "ext2_put_page", "(", "page", ")", ";", "}", "}", "else", "dir_has_error", "=", "1", ";", "if", "(", "++", "n", ">", "=", "npages", ")", "n", "=", "0", ";", "/", "*", "next", "page", "is", "past", "the", "blocks", "we", "'", "ve", "got", "*", "/", "@", "@", "-", "414", ",", "7", "+", "421", ",", "7", "@", "@", "struct", "ext2_dir_entry_2", "*", "ext2_find_entry", "(", "struct", "inode", "*", "dir", ",", "struct", "ext2_dir_entry_2", "*", "ext2_dotdot", "(", "struct", "inode", "*", "dir", ",", "struct", "page", "*", "*", "p", ")", "{", "struct", "page", "*", "page", "=", "ext2_get_page", "(", "dir", ",", "0", ")", ";", "struct", "page", "*", "page", "=", "ext2_get_page", "(", "dir", ",", "0", ",", "0", ")", ";", "ext2_dirent", "*", "de", "=", "NULL", ";", "if", "(", "!", "IS_ERR", "(", "page", ")", ")", "{", "@", "@", "-", "487", ",", "7", "+", "494", ",", "7", "@", "@", "int", "ext2_add_link", "(", "struct", "dentry", "*", "dentry", ",", "struct", "inode", "*", "inode", ")", "for", "(", "n", "=", "0", ";", "n", "<", "=", "npages", ";", "n", "+", "+)", "{", "char", "*", "dir_end", ";", "page", "=", "ext2_get_page", "(", "dir", ",", "n", ")", ";", "page", "=", "ext2_get_page", "(", "dir", ",", "n", ",", "0", ")", ";", "err", "=", "PTR_ERR", "(", "page", ")", ";", "if", "(", "IS_ERR", "(", "page", ")", ")", "goto", "out", ";", "@", "@", "-", "655", ",", "14", "+", "662", ",", "17", "@", "@", "int", "ext2_empty_dir", "(", "struct", "inode", "*", "inode", ")", "{", "struct", "page", "*", "page", "=", "NULL", ";", "unsigned", "long", "i", ",", "npages", "=", "dir_pages", "(", "inode", ")", ";", "int", "dir_has_error", "=", "0", ";", "for", "(", "i", "=", "0", ";", "i", "<", "npages", ";", "i", "+", "+)", "{", "char", "*", "kaddr", ";", "ext2_dirent", "*", "de", ";", "page", "=", "ext2_get_page", "(", "inode", ",", "i", ")", ";", "page", "=", "ext2_get_page", "(", "inode", ",", "i", ",", "dir_has_error", ")", ";", "if", "(", "IS_ERR", "(", "page", ")", ")", "if", "(", "IS_ERR", "(", "page", ")", ")", "{", "dir_has_error", "=", "1", ";", "continue", ";", "}", "kaddr", "=", "page_address", "(", "page", ")", ";", "de", "=", "(", "ext2_dirent", "*", ")", "kaddr", ";"], "docstring_tokens": ["performing", "either", "a", "read", "or", "write", "operation", "on", "the", "mounted", "image", "or", "partition"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "780", ",", "21", "+", "780", ",", "16", "@", "@", "asmlinkage", "long", "compat_sys_recvmmsg", "(", "int", "fd", ",", "struct", "compat_mmsghdr", "__user", "*", "mmsg", ",", "if", "(", "flags", "&", "MSG_CMSG_COMPAT", ")", "return", "-", "EINVAL", ";", "if", "(", "COMPAT_USE_64BIT_TIME", ")", "return", "__sys_recvmmsg", "(", "fd", ",", "(", "struct", "mmsghdr", "__user", "*", ")", "mmsg", ",", "vlen", ",", "flags", "|", "MSG_CMSG_COMPAT", ",", "(", "struct", "timespec", "*", ")", "timeout", ")", ";", "if", "(", "timeout", "=", "=", "NULL", ")", "return", "__sys_recvmmsg", "(", "fd", ",", "(", "struct", "mmsghdr", "__user", "*", ")", "mmsg", ",", "vlen", ",", "flags", "|", "MSG_CMSG_COMPAT", ",", "NULL", ")", ";", "if", "(", "get_compat_timespec", "(", "&", "ktspec", ",", "timeout", ")", ")", "if", "(", "compat_get_timespec", "(", "&", "ktspec", ",", "timeout", ")", ")", "return", "-", "EFAULT", ";", "datagrams", "=", "__sys_recvmmsg", "(", "fd", ",", "(", "struct", "mmsghdr", "__user", "*", ")", "mmsg", ",", "vlen", ",", "flags", "|", "MSG_CMSG_COMPAT", ",", "&", "ktspec", ")", ";", "if", "(", "datagrams", ">", "0", "&", "&", "put_compat_timespec", "(", "&", "ktspec", ",", "timeout", ")", ")", "if", "(", "datagrams", ">", "0", "&", "&", "compat_put_timespec", "(", "&", "ktspec", ",", "timeout", ")", ")", "datagrams", "=", "-", "EFAULT", ";", "return", "datagrams", ";"], "docstring_tokens": ["passing", "an", "appropriate", "value", "for", "the", "timeout", "pointer"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "730", ",", "6", "+", "730", ",", "11", "@", "@", "node", ",", "but", "nothing", "more", ".", "(", "The", "problem", "is", ",", "if", "you", "want", "to", "call", "zoo_exists", "(", ")", "on", "a", "node", "that", "doesn", "'", "t", "exist", ",", "there", "is", "no", "permission", "to", "check", ".", ")", "_ADMIN_", "permission", "also", "has", "a", "special", "role", "in", "terms", "of", "ACLs", ":", "in", "order", "to", "retrieve", "ACLs", "of", "a", "znode", "user", "has", "to", "have", "_READ_", "or", "_ADMIN_", "permission", ",", "but", "without", "_ADMIN_", "permission", ",", "digest", "hash", "values", "will", "be", "masked", "out", ".", "<", "a", "name", "=", "\"", "sc_BuiltinACLSchemes", "\"", "><", "/", "a", ">", "#", "##", "#", "Builtin", "ACL", "Schemes", "@", "@", "-", "839", ",", "7", "+", "844", ",", "8", "@", "@", "node", "must", "have", "the", "CREATE", "permission", "bit", "set", ".", "\\", "*", "path", ",", "_struct_", "ACL_vector", "\\", "*", "acl", ",", "_struct_", "Stat", "\\", "*", "stat", ")", ";", "This", "operation", "returns", "a", "node", "\u2019", "s", "ACL", "info", ".", "This", "operation", "returns", "a", "node", "\u2019", "s", "ACL", "info", ".", "The", "node", "must", "have", "READ", "or", "ADMIN", "permission", "set", ".", "Without", "ADMIN", "permission", ",", "the", "digest", "hash", "values", "will", "be", "masked", "out", ".", "*", "_int_", "_zoo_set_acl_", "(", "zhandle_t", "\\", "*", "zh", ",", "_const_", "_char_", "@", "@", "-", "18", ",", "8", "+", "18", ",", "17", "@", "@", "package", "org", ".", "apache", ".", "zookeeper", ".", "server", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "nio", ".", "ByteBuffer", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang", ".", "StringUtils", ";", "import", "org", ".", "apache", ".", "jute", ".", "Record", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "common", ".", "Time", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "Id", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "KeeperException", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "KeeperException", ".", "Code", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "KeeperException", ".", "SessionMovedException", ";", "@", "@", "-", "33", ",", "7", "+", "42", ",", "6", "@", "@", "import", "org", ".", "apache", ".", "zookeeper", ".", "Watcher", ".", "WatcherType", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "ZooDefs", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "ZooDefs", ".", "OpCode", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "common", ".", "Time", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "ACL", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "Stat", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "proto", ".", "CheckWatchesRequest", ";", "@", "@", "-", "368", ",", "11", "+", "376", ",", "36", "@", "@", "public", "void", "processRequest", "(", "Request", "request", ")", "{", "GetACLRequest", "getACLRequest", "=", "new", "GetACLRequest", "(", ");", "ByteBufferInputStream", ".", "byteBuffer2Record", "(", "request", ".", "request", ",", "getACLRequest", ")", ";", "Stat", "stat", "=", "new", "Stat", "(", ");", "path", "=", "getACLRequest", ".", "getPath", "(", ");", "DataNode", "n", "=", "zks", ".", "getZKDatabase", "(", ").", "getNode", "(", "path", ")", ";", "if", "(", "n", "=", "=", "null", ")", "{", "throw", "new", "KeeperException", ".", "NoNodeException", "(", ");", "}", "PrepRequestProcessor", ".", "checkACL", "(", "zks", ",", "request", ".", "cnxn", ",", "zks", ".", "getZKDatabase", "(", ").", "aclForNode", "(", "n", ")", ",", "ZooDefs", ".", "Perms", ".", "READ", "|", "ZooDefs", ".", "Perms", ".", "ADMIN", ",", "request", ".", "authInfo", ",", "path", ",", "null", ")", ";", "Stat", "stat", "=", "new", "Stat", "(", ");", "List", "<", "ACL", ">", "acl", "=", "zks", ".", "getZKDatabase", "(", ").", "getACL", "(", "path", ",", "stat", ")", ";", "rsp", "=", "new", "GetACLResponse", "(", "acl", ",", "stat", ")", ";", "zks", ".", "getZKDatabase", "(", ").", "getACL", "(", "path", ",", "stat", ")", ";", "try", "{", "PrepRequestProcessor", ".", "checkACL", "(", "zks", ",", "request", ".", "cnxn", ",", "zks", ".", "getZKDatabase", "(", ").", "aclForNode", "(", "n", ")", ",", "ZooDefs", ".", "Perms", ".", "ADMIN", ",", "request", ".", "authInfo", ",", "path", ",", "null", ")", ";", "rsp", "=", "new", "GetACLResponse", "(", "acl", ",", "stat", ")", ";", "}", "catch", "(", "KeeperException", ".", "NoAuthException", "e", ")", "{", "List", "<", "ACL", ">", "acl1", "=", "new", "ArrayList", "<", "ACL", ">", "(", "acl", ".", "size", "(", "))", ";", "for", "(", "ACL", "a", ":", "acl", ")", "{", "if", "(", "\"", "digest", "\"", ".", "equals", "(", "a", ".", "getId", "(", ").", "getScheme", "(", "))", ")", "{", "Id", "id", "=", "a", ".", "getId", "(", ");", "Id", "id1", "=", "new", "Id", "(", "id", ".", "getScheme", "(", "),", "id", ".", "getId", "(", ").", "replaceAll", "(", "\":", ".*", "\",", "\"", ":", "x", "\"", "))", ";", "acl1", ".", "add", "(", "new", "ACL", "(", "a", ".", "getPerms", "(", "),", "id1", ")", ");", "}", "else", "{", "acl1", ".", "add", "(", "a", ")", ";", "}", "}", "rsp", "=", "new", "GetACLResponse", "(", "acl1", ",", "stat", ")", ";", "}", "break", ";", "}", "case", "OpCode", ".", "getChildren", ":", "{", "@", "@", "-", "0", ",", "0", "+", "1", ",", "230", "@", "@", "/", "**", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "*", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "*", "distributed", "with", "this", "work", "for", "additional", "information", "*", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "*", "to", "you", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "*", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "zookeeper", ".", "server", ";", "import", "org", ".", "apache", ".", "jute", ".", "BinaryOutputArchive", ";", "import", "org", ".", "apache", ".", "jute", ".", "Record", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "KeeperException", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "ZooDefs", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "ACL", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "Id", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "Stat", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "proto", ".", "GetACLRequest", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "proto", ".", "GetACLResponse", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "proto", ".", "ReplyHeader", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "mockito", ".", "invocation", ".", "InvocationOnMock", ";", "import", "org", ".", "mockito", ".", "stubbing", ".", "Answer", ";", "import", "java", ".", "io", ".", "ByteArrayOutputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "nio", ".", "ByteBuffer", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "List", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "equalTo", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertThat", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "mockito", ".", "Matchers", ".", "any", ";", "import", "static", "org", ".", "mockito", ".", "Matchers", ".", "anyString", ";", "import", "static", "org", ".", "mockito", ".", "Matchers", ".", "eq", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doAnswer", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "public", "class", "FinalRequestProcessorTest", "{", "private", "List", "<", "ACL", ">", "testACLs", "=", "new", "ArrayList", "<", "ACL", ">", "()", ";", "private", "final", "Record", "[", "]", "responseRecord", "=", "new", "Record", "[", "1", "]", ";", "private", "final", "ReplyHeader", "[", "]", "replyHeaders", "=", "new", "ReplyHeader", "[", "1", "]", ";", "private", "ServerCnxn", "cnxn", ";", "private", "ByteBuffer", "bb", ";", "private", "FinalRequestProcessor", "processor", ";", "@", "Before", "public", "void", "setUp", "(", ")", "throws", "KeeperException", ".", "NoNodeException", ",", "IOException", "{", "testACLs", ".", "clear", "(", ");", "testACLs", ".", "addAll", "(", "Arrays", ".", "asList", "(", "new", "ACL", "(", "ZooDefs", ".", "Perms", ".", "ALL", ",", "new", "Id", "(", "\"", "digest", "\"", ",", "\"", "user", ":", "secrethash", "\"", "))", ",", "new", "ACL", "(", "ZooDefs", ".", "Perms", ".", "ADMIN", ",", "new", "Id", "(", "\"", "digest", "\"", ",", "\"", "adminuser", ":", "adminsecret", "\"", "))", ",", "new", "ACL", "(", "ZooDefs", ".", "Perms", ".", "READ", ",", "new", "Id", "(", "\"", "world", "\"", ",", "\"", "anyone", "\"", "))", ")", ");", "ZooKeeperServer", "zks", "=", "new", "ZooKeeperServer", "(", ");", "ZKDatabase", "db", "=", "mock", "(", "ZKDatabase", ".", "class", ")", ";", "String", "testPath", "=", "\"", "/", "testPath", "\"", ";", "when", "(", "db", ".", "getNode", "(", "eq", "(", "testPath", ")", "))", ".", "thenReturn", "(", "new", "DataNode", "(", "))", ";", "when", "(", "db", ".", "getACL", "(", "eq", "(", "testPath", ")", ",", "any", "(", "Stat", ".", "class", ")", "))", ".", "thenReturn", "(", "testACLs", ")", ";", "when", "(", "db", ".", "aclForNode", "(", "any", "(", "DataNode", ".", "class", ")", "))", ".", "thenReturn", "(", "testACLs", ")", ";", "zks", ".", "setZKDatabase", "(", "db", ")", ";", "processor", "=", "new", "FinalRequestProcessor", "(", "zks", ")", ";", "cnxn", "=", "mock", "(", "ServerCnxn", ".", "class", ")", ";", "doAnswer", "(", "new", "Answer", "(", ")", "{", "@", "Override", "public", "Object", "answer", "(", "InvocationOnMock", "invocationOnMock", ")", "{", "replyHeaders", "[", "0", "]", "=", "(", "ReplyHeader", ")", "invocationOnMock", ".", "getArguments", "(", ")[", "0", "]", ";", "responseRecord", "[", "0", "]", "=", "(", "Record", ")", "invocationOnMock", ".", "getArguments", "(", ")[", "1", "]", ";", "return", "null", ";", "}", "}", ").", "when", "(", "cnxn", ")", ".", "sendResponse", "(", "any", "(", "ReplyHeader", ".", "class", ")", ",", "any", "(", "Record", ".", "class", ")", ",", "anyString", "(", "))", ";", "GetACLRequest", "getACLRequest", "=", "new", "GetACLRequest", "(", ");", "getACLRequest", ".", "setPath", "(", "testPath", ")", ";", "ByteArrayOutputStream", "baos", "=", "new", "ByteArrayOutputStream", "(", ");", "BinaryOutputArchive", "boa", "=", "BinaryOutputArchive", ".", "getArchive", "(", "baos", ")", ";", "getACLRequest", ".", "serialize", "(", "boa", ",", "\"", "request", "\"", ");", "baos", ".", "close", "(", ");", "bb", "=", "ByteBuffer", ".", "wrap", "(", "baos", ".", "toByteArray", "(", "))", ";", "}", "@", "Test", "public", "void", "testACLDigestHashHiding_NoAuth_WorldCanRead", "(", ")", "{", "/", "/", "Arrange", "/", "/", "Act", "Request", "r", "=", "new", "Request", "(", "cnxn", ",", "0", ",", "0", ",", "ZooDefs", ".", "OpCode", ".", "getACL", ",", "bb", ",", "new", "ArrayList", "<", "Id", ">", "()", ");", "processor", ".", "processRequest", "(", "r", ")", ";", "/", "/", "Assert", "assertMasked", "(", "true", ")", ";", "}", "@", "Test", "public", "void", "testACLDigestHashHiding_NoAuth_NoWorld", "(", ")", "{", "/", "/", "Arrange", "testACLs", ".", "remove", "(", "2", ")", ";", "/", "/", "Act", "Request", "r", "=", "new", "Request", "(", "cnxn", ",", "0", ",", "0", ",", "ZooDefs", ".", "OpCode", ".", "getACL", ",", "bb", ",", "new", "ArrayList", "<", "Id", ">", "()", ");", "processor", ".", "processRequest", "(", "r", ")", ";", "/", "/", "Assert", "assertThat", "(", "KeeperException", ".", "Code", ".", "get", "(", "replyHeaders", "[", "0", "]", ".", "getErr", "(", "))", ",", "equalTo", "(", "KeeperException", ".", "Code", ".", "NOAUTH", ")", ");", "}", "@", "Test", "public", "void", "testACLDigestHashHiding_UserCanRead", "(", ")", "{", "/", "/", "Arrange", "List", "<", "Id", ">", "authInfo", "=", "new", "ArrayList", "<", "Id", ">", "()", ";", "authInfo", ".", "add", "(", "new", "Id", "(", "\"", "digest", "\"", ",", "\"", "otheruser", ":", "somesecrethash", "\"", "))", ";", "/", "/", "Act", "Request", "r", "=", "new", "Request", "(", "cnxn", ",", "0", ",", "0", ",", "ZooDefs", ".", "OpCode", ".", "getACL", ",", "bb", ",", "authInfo", ")", ";", "processor", ".", "processRequest", "(", "r", ")", ";", "/", "/", "Assert", "assertMasked", "(", "true", ")", ";", "}", "@", "Test", "public", "void", "testACLDigestHashHiding_UserCanAll", "(", ")", "{", "/", "/", "Arrange", "List", "<", "Id", ">", "authInfo", "=", "new", "ArrayList", "<", "Id", ">", "()", ";", "authInfo", ".", "add", "(", "new", "Id", "(", "\"", "digest", "\"", ",", "\"", "user", ":", "secrethash", "\"", "))", ";", "/", "/", "Act", "Request", "r", "=", "new", "Request", "(", "cnxn", ",", "0", ",", "0", ",", "ZooDefs", ".", "OpCode", ".", "getACL", ",", "bb", ",", "authInfo", ")", ";", "processor", ".", "processRequest", "(", "r", ")", ";", "/", "/", "Assert", "assertMasked", "(", "false", ")", ";", "}", "@", "Test", "public", "void", "testACLDigestHashHiding_AdminUser", "(", ")", "{", "/", "/", "Arrange", "List", "<", "Id", ">", "authInfo", "=", "new", "ArrayList", "<", "Id", ">", "()", ";", "authInfo", ".", "add", "(", "new", "Id", "(", "\"", "digest", "\"", ",", "\"", "adminuser", ":", "adminsecret", "\"", "))", ";", "/", "/", "Act", "Request", "r", "=", "new", "Request", "(", "cnxn", ",", "0", ",", "0", ",", "ZooDefs", ".", "OpCode", ".", "getACL", ",", "bb", ",", "authInfo", ")", ";", "processor", ".", "processRequest", "(", "r", ")", ";", "/", "/", "Assert", "assertMasked", "(", "false", ")", ";", "}", "@", "Test", "public", "void", "testACLDigestHashHiding_OnlyAdmin", "(", ")", "{", "/", "/", "Arrange", "testACLs", ".", "clear", "(", ");", "testACLs", ".", "addAll", "(", "Arrays", ".", "asList", "(", "new", "ACL", "(", "ZooDefs", ".", "Perms", ".", "READ", ",", "new", "Id", "(", "\"", "digest", "\"", ",", "\"", "user", ":", "secrethash", "\"", "))", ",", "new", "ACL", "(", "ZooDefs", ".", "Perms", ".", "ADMIN", ",", "new", "Id", "(", "\"", "digest", "\"", ",", "\"", "adminuser", ":", "adminsecret", "\"", "))", ")", ");", "List", "<", "Id", ">", "authInfo", "=", "new", "ArrayList", "<", "Id", ">", "()", ";", "authInfo", ".", "add", "(", "new", "Id", "(", "\"", "digest", "\"", ",", "\"", "adminuser", ":", "adminsecret", "\"", "))", ";", "/", "/", "Act", "Request", "r", "=", "new", "Request", "(", "cnxn", ",", "0", ",", "0", ",", "ZooDefs", ".", "OpCode", ".", "getACL", ",", "bb", ",", "authInfo", ")", ";", "processor", ".", "processRequest", "(", "r", ")", ";", "/", "/", "Assert", "assertTrue", "(", "\"", "Not", "a", "GetACL", "response", ".", "Auth", "failed", "?", "\",", "responseRecord", "[", "0", "]", "instanceof", "GetACLResponse", ")", ";", "GetACLResponse", "rsp", "=", "(", "GetACLResponse", ")", "responseRecord", "[", "0", "]", ";", "assertThat", "(", "\"", "Number", "of", "ACLs", "in", "the", "response", "are", "different", "\"", ",", "rsp", ".", "getAcl", "(", ").", "size", "(", "),", "equalTo", "(", "2", ")", ");", "/", "/", "Verify", "ACLs", "in", "the", "response", "assertThat", "(", "\"", "Password", "hash", "mismatch", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "0", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "user", ":", "secrethash", "\"", "))", ";", "assertThat", "(", "\"", "Password", "hash", "mismatch", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "1", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "adminuser", ":", "adminsecret", "\"", "))", ";", "}", "private", "void", "assertMasked", "(", "boolean", "masked", ")", "{", "assertTrue", "(", "\"", "Not", "a", "GetACL", "response", ".", "Auth", "failed", "?", "\",", "responseRecord", "[", "0", "]", "instanceof", "GetACLResponse", ")", ";", "GetACLResponse", "rsp", "=", "(", "GetACLResponse", ")", "responseRecord", "[", "0", "]", ";", "assertThat", "(", "\"", "Number", "of", "ACLs", "in", "the", "response", "are", "different", "\"", ",", "rsp", ".", "getAcl", "(", ").", "size", "(", "),", "equalTo", "(", "3", ")", ");", "/", "/", "Verify", "ACLs", "in", "the", "response", "assertThat", "(", "\"", "Invalid", "ACL", "list", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "0", ")", ".", "getPerms", "(", "),", "equalTo", "(", "ZooDefs", ".", "Perms", ".", "ALL", ")", ");", "assertThat", "(", "\"", "Invalid", "ACL", "list", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "0", ")", ".", "getId", "(", ").", "getScheme", "(", "),", "equalTo", "(", "\"", "digest", "\"", "))", ";", "if", "(", "masked", ")", "{", "assertThat", "(", "\"", "Password", "hash", "is", "not", "masked", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "0", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "user", ":", "x", "\"", "))", ";", "}", "else", "{", "assertThat", "(", "\"", "Password", "hash", "mismatch", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "0", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "user", ":", "secrethash", "\"", "))", ";", "}", "assertThat", "(", "\"", "Invalid", "ACL", "list", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "1", ")", ".", "getPerms", "(", "),", "equalTo", "(", "ZooDefs", ".", "Perms", ".", "ADMIN", ")", ");", "assertThat", "(", "\"", "Invalid", "ACL", "list", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "1", ")", ".", "getId", "(", ").", "getScheme", "(", "),", "equalTo", "(", "\"", "digest", "\"", "))", ";", "if", "(", "masked", ")", "{", "assertThat", "(", "\"", "Password", "hash", "is", "not", "masked", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "1", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "adminuser", ":", "x", "\"", "))", ";", "}", "else", "{", "assertThat", "(", "\"", "Password", "hash", "mismatch", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "1", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "adminuser", ":", "adminsecret", "\"", "))", ";", "}", "assertThat", "(", "\"", "Invalid", "ACL", "list", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "2", ")", ".", "getPerms", "(", "),", "equalTo", "(", "ZooDefs", ".", "Perms", ".", "READ", ")", ");", "assertThat", "(", "\"", "Invalid", "ACL", "list", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "2", ")", ".", "getId", "(", ").", "getScheme", "(", "),", "equalTo", "(", "\"", "world", "\"", "))", ";", "assertThat", "(", "\"", "Invalid", "ACL", "list", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "2", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "anyone", "\"", "))", ";", "/", "/", "Verify", "that", "FinalRequestProcessor", "hasn", "'", "t", "changed", "the", "original", "ACL", "objects", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "0", ")", ".", "getPerms", "(", "),", "equalTo", "(", "ZooDefs", ".", "Perms", ".", "ALL", ")", ");", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "0", ")", ".", "getId", "(", ").", "getScheme", "(", "),", "equalTo", "(", "\"", "digest", "\"", "))", ";", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "0", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "user", ":", "secrethash", "\"", "))", ";", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "1", ")", ".", "getPerms", "(", "),", "equalTo", "(", "ZooDefs", ".", "Perms", ".", "ADMIN", ")", ");", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "1", ")", ".", "getId", "(", ").", "getScheme", "(", "),", "equalTo", "(", "\"", "digest", "\"", "))", ";", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "1", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "adminuser", ":", "adminsecret", "\"", "))", ";", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "2", ")", ".", "getPerms", "(", "),", "equalTo", "(", "ZooDefs", ".", "Perms", ".", "READ", ")", ");", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "2", ")", ".", "getId", "(", ").", "getScheme", "(", "),", "equalTo", "(", "\"", "world", "\"", "))", ";", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "2", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "anyone", "\"", "))", ";", "}", "}"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "6313", ",", "6", "+", "6313", ",", "8", "@", "@", "static", "int", "btrfs_check_chunk_valid", "(", "struct", "btrfs_fs_info", "*", "fs_info", ",", "u16", "num_stripes", ";", "u16", "sub_stripes", ";", "u64", "type", ";", "u64", "features", ";", "bool", "mixed", "=", "false", ";", "length", "=", "btrfs_chunk_length", "(", "leaf", ",", "chunk", ")", ";", "stripe_len", "=", "btrfs_chunk_stripe_len", "(", "leaf", ",", "chunk", ")", ";", "@", "@", "-", "6351", ",", "6", "+", "6353", ",", "32", "@", "@", "static", "int", "btrfs_check_chunk_valid", "(", "struct", "btrfs_fs_info", "*", "fs_info", ",", "btrfs_chunk_type", "(", "leaf", ",", "chunk", ")", ");", "return", "-", "EIO", ";", "}", "if", "(", "(", "type", "&", "BTRFS_BLOCK_GROUP_TYPE_MASK", ")", "=", "=", "0", ")", "{", "btrfs_err", "(", "fs_info", ",", "\"", "missing", "chunk", "type", "flag", ":", "0x", "%", "llx", "\"", ",", "type", ")", ";", "return", "-", "EIO", ";", "}", "if", "(", "(", "type", "&", "BTRFS_BLOCK_GROUP_SYSTEM", ")", "&", "&", "(", "type", "&", "(", "BTRFS_BLOCK_GROUP_METADATA", "|", "BTRFS_BLOCK_GROUP_DATA", ")", "))", "{", "btrfs_err", "(", "fs_info", ",", "\"", "system", "chunk", "with", "data", "or", "metadata", "type", ":", "0x", "%", "llx", "\"", ",", "type", ")", ";", "return", "-", "EIO", ";", "}", "features", "=", "btrfs_super_incompat_flags", "(", "fs_info", "-", ">", "super_copy", ")", ";", "if", "(", "features", "&", "BTRFS_FEATURE_INCOMPAT_MIXED_GROUPS", ")", "mixed", "=", "true", ";", "if", "(", "!", "mixed", ")", "{", "if", "(", "(", "type", "&", "BTRFS_BLOCK_GROUP_METADATA", ")", "&", "&", "(", "type", "&", "BTRFS_BLOCK_GROUP_DATA", ")", ")", "{", "btrfs_err", "(", "fs_info", ",", "\"", "mixed", "chunk", "type", "in", "non", "-", "mixed", "mode", ":", "0x", "%", "llx", "\"", ",", "type", ")", ";", "return", "-", "EIO", ";", "}", "}", "if", "(", "(", "type", "&", "BTRFS_BLOCK_GROUP_RAID10", "&", "&", "sub_stripes", "!", "=", "2", ")", "|", "|", "(", "type", "&", "BTRFS_BLOCK_GROUP_RAID1", "&", "&", "num_stripes", "<", "1", ")", "|", "|", "(", "type", "&", "BTRFS_BLOCK_GROUP_RAID5", "&", "&", "num_stripes", "<", "2", ")", "|", "|"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1045", ",", "6", "+", "1045", ",", "8", "@", "@", "static", "Image", "*", "ReadWPGImage", "(", "const", "ImageInfo", "*", "image_info", ",", "if", "(", "i", "=", "=", "EOF", ")", "break", ";", "Rd_WP_DWORD", "(", "image", ",", "&", "Rec", ".", "RecordLength", ")", ";", "if", "(", "Rec", ".", "RecordLength", ">", "GetBlobSize", "(", "image", ")", ")", "ThrowReaderException", "(", "CorruptImageError", ",", "\"", "ImproperImageHeader", "\"", ");", "if", "(", "EOFBlob", "(", "image", ")", ")", "break", ";"], "docstring_tokens": ["via", "a", "crafted", "wpg", "image", "file", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "144", ",", "9", "+", "144", ",", "6", "@", "@", "smb_send_kvec", "(", "struct", "TCP_Server_Info", "*", "server", ",", "struct", "kvec", "*", "iov", ",", "size_t", "n_vec", ",", "*", "sent", "=", "0", ";", "if", "(", "ssocket", "=", "=", "NULL", ")", "return", "-", "ENOTSOCK", ";", "/", "*", "BB", "eventually", "add", "reconnect", "code", "here", "*", "/", "smb_msg", ".", "msg_name", "=", "(", "struct", "sockaddr", "*", ")", "&", "server", "-", ">", "dstaddr", ";", "smb_msg", ".", "msg_namelen", "=", "sizeof", "(", "struct", "sockaddr", ")", ";", "smb_msg", ".", "msg_control", "=", "NULL", ";", "@", "@", "-", "291", ",", "6", "+", "288", ",", "9", "@", "@", "smb_send_rqst", "(", "struct", "TCP_Server_Info", "*", "server", ",", "struct", "smb_rqst", "*", "rqst", ")", "struct", "socket", "*", "ssocket", "=", "server", "-", ">", "ssocket", ";", "int", "val", "=", "1", ";", "if", "(", "ssocket", "=", "=", "NULL", ")", "return", "-", "ENOTSOCK", ";", "cFYI", "(", "1", ",", "\"", "Sending", "smb", ":", "smb_len", "=", "%", "u", "\"", ",", "smb_buf_length", ")", ";", "dump_smb", "(", "iov", "[", "0", "]", ".", "iov_base", ",", "iov", "[", "0", "]", ".", "iov_len", ")", ";"], "docstring_tokens": ["via", "vectors", "involving", "a", "reconnection", "event", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "52", ",", "14", "+", "52", ",", "6", "@", "@", "void", "do_invalidatepage", "(", "struct", "page", "*", "page", ",", "unsigned", "int", "offset", ",", "(", "*", "invalidatepage", ")", "(", "page", ",", "offset", ",", "length", ")", ";", "}", "static", "inline", "void", "truncate_partial_page", "(", "struct", "page", "*", "page", ",", "unsigned", "partial", ")", "{", "zero_user_segment", "(", "page", ",", "partial", ",", "PAGE_CACHE_SIZE", ")", ";", "cleancache_invalidate_page", "(", "page", "-", ">", "mapping", ",", "page", ")", ";", "if", "(", "page_has_private", "(", "page", ")", ")", "do_invalidatepage", "(", "page", ",", "partial", ",", "PAGE_CACHE_SIZE", "-", "partial", ")", ";", "}", "/", "*", "*", "This", "cancels", "just", "the", "dirty", "bit", "on", "the", "kernel", "page", "itself", ",", "it", "*", "does", "NOT", "actually", "remove", "dirty", "bits", "on", "any", "mmap", "'", "s", "that", "may", "be", "@", "@", "-", "188", ",", "11", "+", "180", ",", "11", "@", "@", "int", "invalidate_inode_page", "(", "struct", "page", "*", "page", ")", "*", "truncate_inode_pages_range", "-", "truncate", "range", "of", "pages", "specified", "by", "start", "&", "end", "byte", "offsets", "*", "@", "mapping", ":", "mapping", "to", "truncate", "*", "@", "lstart", ":", "offset", "from", "which", "to", "truncate", "*", "@", "lend", ":", "offset", "to", "which", "to", "truncate", "*", "@", "lend", ":", "offset", "to", "which", "to", "truncate", "(", "inclusive", ")", "*", "*", "Truncate", "the", "page", "cache", ",", "removing", "the", "pages", "that", "are", "between", "*", "specified", "offsets", "(", "and", "zeroing", "out", "partial", "page", "*", "(", "if", "lstart", "is", "not", "page", "aligned", ")", ").", "*", "specified", "offsets", "(", "and", "zeroing", "out", "partial", "pages", "*", "if", "lstart", "or", "lend", "+", "1", "is", "not", "page", "aligned", ")", ".", "*", "*", "Truncate", "takes", "two", "passes", "-", "the", "first", "pass", "is", "nonblocking", ".", "It", "will", "not", "*", "block", "on", "page", "locks", "and", "it", "will", "not", "block", "on", "writeback", ".", "The", "second", "pass", "@", "@", "-", "203", ",", "35", "+", "195", ",", "58", "@", "@", "int", "invalidate_inode_page", "(", "struct", "page", "*", "page", ")", "*", "We", "pass", "down", "the", "cache", "-", "hot", "hint", "to", "the", "page", "freeing", "code", ".", "Even", "if", "the", "*", "mapping", "is", "large", ",", "it", "is", "probably", "the", "case", "that", "the", "final", "pages", "are", "the", "most", "*", "recently", "touched", ",", "and", "freeing", "happens", "in", "ascending", "file", "offset", "order", ".", "*", "*", "Note", "that", "since", "-", ">", "invalidatepage", "(", ")", "accepts", "range", "to", "invalidate", "*", "truncate_inode_pages_range", "is", "able", "to", "handle", "cases", "where", "lend", "+", "1", "is", "not", "*", "page", "aligned", "properly", ".", "*", "/", "void", "truncate_inode_pages_range", "(", "struct", "address_space", "*", "mapping", ",", "loff_t", "lstart", ",", "loff_t", "lend", ")", "{", "const", "pgoff_t", "start", "=", "(", "lstart", "+", "PAGE_CACHE_SIZE", "-", "1", ")", ">", ">", "PAGE_CACHE_SHIFT", ";", "const", "unsigned", "partial", "=", "lstart", "&", "(", "PAGE_CACHE_SIZE", "-", "1", ")", ";", "struct", "pagevec", "pvec", ";", "pgoff_t", "index", ";", "pgoff_t", "end", ";", "int", "i", ";", "pgoff_t", "start", ";", "/", "*", "inclusive", "*", "/", "pgoff_t", "end", ";", "/", "*", "exclusive", "*", "/", "unsigned", "int", "partial_start", ";", "/", "*", "inclusive", "*", "/", "unsigned", "int", "partial_end", ";", "/", "*", "exclusive", "*", "/", "struct", "pagevec", "pvec", ";", "pgoff_t", "index", ";", "int", "i", ";", "cleancache_invalidate_inode", "(", "mapping", ")", ";", "if", "(", "mapping", "-", ">", "nrpages", "=", "=", "0", ")", "return", ";", "BUG_ON", "(", "(", "lend", "&", "(", "PAGE_CACHE_SIZE", "-", "1", ")", ")", "!", "=", "(", "PAGE_CACHE_SIZE", "-", "1", ")", ");", "end", "=", "(", "lend", ">", ">", "PAGE_CACHE_SHIFT", ")", ";", "/", "*", "Offsets", "within", "partial", "pages", "*", "/", "partial_start", "=", "lstart", "&", "(", "PAGE_CACHE_SIZE", "-", "1", ")", ";", "partial_end", "=", "(", "lend", "+", "1", ")", "&", "(", "PAGE_CACHE_SIZE", "-", "1", ")", ";", "/", "*", "*", "'", "start", "'", "and", "'", "end", "'", "always", "covers", "the", "range", "of", "pages", "to", "be", "fully", "*", "truncated", ".", "Partial", "pages", "are", "covered", "with", "'", "partial_start", "'", "at", "the", "*", "start", "of", "the", "range", "and", "'", "partial_end", "'", "at", "the", "end", "of", "the", "range", ".", "*", "Note", "that", "'", "end", "'", "is", "exclusive", "while", "'", "lend", "'", "is", "inclusive", ".", "*", "/", "start", "=", "(", "lstart", "+", "PAGE_CACHE_SIZE", "-", "1", ")", ">", ">", "PAGE_CACHE_SHIFT", ";", "if", "(", "lend", "=", "=", "-", "1", ")", "/", "*", "*", "lend", "=", "=", "-", "1", "indicates", "end", "-", "of", "-", "file", "so", "we", "have", "to", "set", "'", "end", "'", "*", "to", "the", "highest", "possible", "pgoff_t", "and", "since", "the", "type", "is", "*", "unsigned", "we", "'", "re", "using", "-", "1", ".", "*", "/", "end", "=", "-", "1", ";", "else", "end", "=", "(", "lend", "+", "1", ")", ">", ">", "PAGE_CACHE_SHIFT", ";", "pagevec_init", "(", "&", "pvec", ",", "0", ")", ";", "index", "=", "start", ";", "while", "(", "index", "<", "=", "end", "&", "&", "pagevec_lookup", "(", "&", "pvec", ",", "mapping", ",", "index", ",", "min", "(", "end", "-", "index", ",", "(", "pgoff_t", ")", "PAGEVEC_SIZE", "-", "1", ")", "+", "1", ")", ")", "{", "while", "(", "index", "<", "end", "&", "&", "pagevec_lookup", "(", "&", "pvec", ",", "mapping", ",", "index", ",", "min", "(", "end", "-", "index", ",", "(", "pgoff_t", ")", "PAGEVEC_SIZE", ")", "))", "{", "mem_cgroup_uncharge_start", "(", ");", "for", "(", "i", "=", "0", ";", "i", "<", "pagevec_count", "(", "&", "pvec", ")", ";", "i", "+", "+)", "{", "struct", "page", "*", "page", "=", "pvec", ".", "pages", "[", "i", "]", ";", "/", "*", "We", "rely", "upon", "deletion", "not", "changing", "page", "-", ">", "index", "*", "/", "index", "=", "page", "-", ">", "index", ";", "if", "(", "index", ">", "end", ")", "if", "(", "index", ">", "=", "end", ")", "break", ";", "if", "(", "!", "trylock_page", "(", "page", ")", ")", "@", "@", "-", "250", ",", "27", "+", "265", ",", "56", "@", "@", "void", "truncate_inode_pages_range", "(", "struct", "address_space", "*", "mapping", ",", "index", "+", "+;", "}", "if", "(", "partial", ")", "{", "if", "(", "partial_start", ")", "{", "struct", "page", "*", "page", "=", "find_lock_page", "(", "mapping", ",", "start", "-", "1", ")", ";", "if", "(", "page", ")", "{", "unsigned", "int", "top", "=", "PAGE_CACHE_SIZE", ";", "if", "(", "start", ">", "end", ")", "{", "/", "*", "Truncation", "within", "a", "single", "page", "*", "/", "top", "=", "partial_end", ";", "partial_end", "=", "0", ";", "}", "wait_on_page_writeback", "(", "page", ")", ";", "truncate_partial_page", "(", "page", ",", "partial", ")", ";", "zero_user_segment", "(", "page", ",", "partial_start", ",", "top", ")", ";", "cleancache_invalidate_page", "(", "mapping", ",", "page", ")", ";", "if", "(", "page_has_private", "(", "page", ")", ")", "do_invalidatepage", "(", "page", ",", "partial_start", ",", "top", "-", "partial_start", ")", ";", "unlock_page", "(", "page", ")", ";", "page_cache_release", "(", "page", ")", ";", "}", "}", "if", "(", "partial_end", ")", "{", "struct", "page", "*", "page", "=", "find_lock_page", "(", "mapping", ",", "end", ")", ";", "if", "(", "page", ")", "{", "wait_on_page_writeback", "(", "page", ")", ";", "zero_user_segment", "(", "page", ",", "0", ",", "partial_end", ")", ";", "cleancache_invalidate_page", "(", "mapping", ",", "page", ")", ";", "if", "(", "page_has_private", "(", "page", ")", ")", "do_invalidatepage", "(", "page", ",", "0", ",", "partial_end", ")", ";", "unlock_page", "(", "page", ")", ";", "page_cache_release", "(", "page", ")", ";", "}", "}", "/", "*", "*", "If", "the", "truncation", "happened", "within", "a", "single", "page", "no", "pages", "*", "will", "be", "released", ",", "just", "zeroed", ",", "so", "we", "can", "bail", "out", "now", ".", "*", "/", "if", "(", "start", ">", "=", "end", ")", "return", ";", "index", "=", "start", ";", "for", "(", ";", ";", ")", "{", "cond_resched", "(", ");", "if", "(", "!", "pagevec_lookup", "(", "&", "pvec", ",", "mapping", ",", "index", ",", "min", "(", "end", "-", "index", ",", "(", "pgoff_t", ")", "PAGEVEC_SIZE", "-", "1", ")", "+", "1", ")", ")", "{", "min", "(", "end", "-", "index", ",", "(", "pgoff_t", ")", "PAGEVEC_SIZE", ")", "))", "{", "if", "(", "index", "=", "=", "start", ")", "break", ";", "index", "=", "start", ";", "continue", ";", "}", "if", "(", "index", "=", "=", "start", "&", "&", "pvec", ".", "pages", "[", "0", "]", "->", "index", ">", "end", ")", "{", "if", "(", "index", "=", "=", "start", "&", "&", "pvec", ".", "pages", "[", "0", "]", "->", "index", ">", "=", "end", ")", "{", "pagevec_release", "(", "&", "pvec", ")", ";", "break", ";", "}", "@", "@", "-", "280", ",", "7", "+", "324", ",", "7", "@", "@", "void", "truncate_inode_pages_range", "(", "struct", "address_space", "*", "mapping", ",", "/", "*", "We", "rely", "upon", "deletion", "not", "changing", "page", "-", ">", "index", "*", "/", "index", "=", "page", "-", ">", "index", ";", "if", "(", "index", ">", "end", ")", "if", "(", "index", ">", "=", "end", ")", "break", ";", "lock_page", "(", "page", ")", ";", "@", "@", "-", "601", ",", "10", "+", "645", ",", "8", "@", "@", "void", "truncate_pagecache_range", "(", "struct", "inode", "*", "inode", ",", "loff_t", "lstart", ",", "loff_t", "lend", ")", "*", "This", "rounding", "is", "currently", "just", "for", "example", ":", "unmap_mapping_range", "*", "expands", "its", "hole", "outwards", ",", "whereas", "we", "want", "it", "to", "contract", "the", "hole", "*", "inwards", ".", "However", ",", "existing", "callers", "of", "truncate_pagecache_range", "are", "*", "doing", "their", "own", "page", "rounding", "first", ";", "and", "truncate_inode_pages_range", "*", "currently", "BUGs", "if", "lend", "is", "not", "pagealigned", "-", "1", "(", "it", "handles", "partial", "*", "page", "at", "start", "of", "hole", ",", "but", "not", "partial", "page", "at", "end", "of", "hole", ")", ".", "Note", "*", "unmap_mapping_range", "allows", "holelen", "0", "for", "all", ",", "and", "we", "allow", "lend", "-", "1", ".", "*", "doing", "their", "own", "page", "rounding", "first", ".", "Note", "that", "unmap_mapping_range", "*", "allows", "holelen", "0", "for", "all", ",", "and", "we", "allow", "lend", "-", "1", "for", "end", "of", "file", ".", "*", "/", "/", "*"], "docstring_tokens": ["if", "an", "application", "punches", "a", "hole", "in", "a", "file", "that", "does", "not", "end", "aligned", "to", "a", "page", "boundary", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "732", ",", "6", "+", "732", ",", "8", "@", "@", "validate_exec_list", "(", "struct", "drm_i915_gem_exec_object2", "*", "exec", ",", "int", "count", ")", "{", "int", "i", ";", "int", "relocs_total", "=", "0", ";", "int", "relocs_max", "=", "INT_MAX", "/", "sizeof", "(", "struct", "drm_i915_gem_relocation_entry", ")", ";", "for", "(", "i", "=", "0", ";", "i", "<", "count", ";", "i", "+", "+)", "{", "char", "__user", "*", "ptr", "=", "(", "char", "__user", "*", ")(", "uintptr_t", ")", "exec", "[", "i", "]", ".", "relocs_ptr", ";", "@", "@", "-", "740", ",", "10", "+", "742", ",", "13", "@", "@", "validate_exec_list", "(", "struct", "drm_i915_gem_exec_object2", "*", "exec", ",", "if", "(", "exec", "[", "i", "]", ".", "flags", "&", "__EXEC_OBJECT_UNKNOWN_FLAGS", ")", "return", "-", "EINVAL", ";", "/", "*", "First", "check", "for", "malicious", "input", "causing", "overflow", "*", "/", "if", "(", "exec", "[", "i", "]", ".", "relocation_count", ">", "INT_MAX", "/", "sizeof", "(", "struct", "drm_i915_gem_relocation_entry", ")", ")", "/", "*", "First", "check", "for", "malicious", "input", "causing", "overflow", "in", "*", "the", "worst", "case", "where", "we", "need", "to", "allocate", "the", "entire", "*", "relocation", "tree", "as", "a", "single", "array", ".", "*", "/", "if", "(", "exec", "[", "i", "]", ".", "relocation_count", ">", "relocs_max", "-", "relocs_total", ")", "return", "-", "EINVAL", ";", "relocs_total", "+", "=", "exec", "[", "i", "]", ".", "relocation_count", ";", "length", "=", "exec", "[", "i", "]", ".", "relocation_count", "*", "sizeof", "(", "struct", "drm_i915_gem_relocation_entry", ")", ";"], "docstring_tokens": ["via", "a", "crafted", "application", "that", "triggers", "many", "relocation", "copies"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "918", ",", "6", "+", "918", ",", "79", "@", "@", "static", "loff_t", "max_file_size", "(", "unsigned", "bits", ")", "return", "result", ";", "}", "static", "inline", "bool", "sanity_check_area_boundary", "(", "struct", "super_block", "*", "sb", ",", "struct", "f2fs_super_block", "*", "raw_super", ")", "{", "u32", "segment0_blkaddr", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "segment0_blkaddr", ")", ";", "u32", "cp_blkaddr", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "cp_blkaddr", ")", ";", "u32", "sit_blkaddr", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "sit_blkaddr", ")", ";", "u32", "nat_blkaddr", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "nat_blkaddr", ")", ";", "u32", "ssa_blkaddr", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "ssa_blkaddr", ")", ";", "u32", "main_blkaddr", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "main_blkaddr", ")", ";", "u32", "segment_count_ckpt", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "segment_count_ckpt", ")", ";", "u32", "segment_count_sit", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "segment_count_sit", ")", ";", "u32", "segment_count_nat", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "segment_count_nat", ")", ";", "u32", "segment_count_ssa", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "segment_count_ssa", ")", ";", "u32", "segment_count_main", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "segment_count_main", ")", ";", "u32", "segment_count", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "segment_count", ")", ";", "u32", "log_blocks_per_seg", "=", "le32_to_cpu", "(", "raw_super", "-", ">", "log_blocks_per_seg", ")", ";", "if", "(", "segment0_blkaddr", "!", "=", "cp_blkaddr", ")", "{", "f2fs_msg", "(", "sb", ",", "KERN_INFO", ",", "\"", "Mismatch", "start", "address", ",", "segment0", "(", "%", "u", ")", "cp_blkaddr", "(", "%", "u", ")", "\",", "segment0_blkaddr", ",", "cp_blkaddr", ")", ";", "return", "true", ";", "}", "if", "(", "cp_blkaddr", "+", "(", "segment_count_ckpt", "<", "<", "log_blocks_per_seg", ")", "!", "=", "sit_blkaddr", ")", "{", "f2fs_msg", "(", "sb", ",", "KERN_INFO", ",", "\"", "Wrong", "CP", "boundary", ",", "start", "(", "%", "u", ")", "end", "(", "%", "u", ")", "blocks", "(", "%", "u", ")", "\",", "cp_blkaddr", ",", "sit_blkaddr", ",", "segment_count_ckpt", "<", "<", "log_blocks_per_seg", ")", ";", "return", "true", ";", "}", "if", "(", "sit_blkaddr", "+", "(", "segment_count_sit", "<", "<", "log_blocks_per_seg", ")", "!", "=", "nat_blkaddr", ")", "{", "f2fs_msg", "(", "sb", ",", "KERN_INFO", ",", "\"", "Wrong", "SIT", "boundary", ",", "start", "(", "%", "u", ")", "end", "(", "%", "u", ")", "blocks", "(", "%", "u", ")", "\",", "sit_blkaddr", ",", "nat_blkaddr", ",", "segment_count_sit", "<", "<", "log_blocks_per_seg", ")", ";", "return", "true", ";", "}", "if", "(", "nat_blkaddr", "+", "(", "segment_count_nat", "<", "<", "log_blocks_per_seg", ")", "!", "=", "ssa_blkaddr", ")", "{", "f2fs_msg", "(", "sb", ",", "KERN_INFO", ",", "\"", "Wrong", "NAT", "boundary", ",", "start", "(", "%", "u", ")", "end", "(", "%", "u", ")", "blocks", "(", "%", "u", ")", "\",", "nat_blkaddr", ",", "ssa_blkaddr", ",", "segment_count_nat", "<", "<", "log_blocks_per_seg", ")", ";", "return", "true", ";", "}", "if", "(", "ssa_blkaddr", "+", "(", "segment_count_ssa", "<", "<", "log_blocks_per_seg", ")", "!", "=", "main_blkaddr", ")", "{", "f2fs_msg", "(", "sb", ",", "KERN_INFO", ",", "\"", "Wrong", "SSA", "boundary", ",", "start", "(", "%", "u", ")", "end", "(", "%", "u", ")", "blocks", "(", "%", "u", ")", "\",", "ssa_blkaddr", ",", "main_blkaddr", ",", "segment_count_ssa", "<", "<", "log_blocks_per_seg", ")", ";", "return", "true", ";", "}", "if", "(", "main_blkaddr", "+", "(", "segment_count_main", "<", "<", "log_blocks_per_seg", ")", "!", "=", "segment0_blkaddr", "+", "(", "segment_count", "<", "<", "log_blocks_per_seg", ")", ")", "{", "f2fs_msg", "(", "sb", ",", "KERN_INFO", ",", "\"", "Wrong", "MAIN_AREA", "boundary", ",", "start", "(", "%", "u", ")", "end", "(", "%", "u", ")", "blocks", "(", "%", "u", ")", "\",", "main_blkaddr", ",", "segment0_blkaddr", "+", "(", "segment_count", "<", "<", "log_blocks_per_seg", ")", ",", "segment_count_main", "<", "<", "log_blocks_per_seg", ")", ";", "return", "true", ";", "}", "return", "false", ";", "}", "static", "int", "sanity_check_raw_super", "(", "struct", "super_block", "*", "sb", ",", "struct", "f2fs_super_block", "*", "raw_super", ")", "{", "@", "@", "-", "947", ",", "6", "+", "1020", ",", "14", "@", "@", "static", "int", "sanity_check_raw_super", "(", "struct", "super_block", "*", "sb", ",", "return", "1", ";", "}", "/", "*", "check", "log", "blocks", "per", "segment", "*", "/", "if", "(", "le32_to_cpu", "(", "raw_super", "-", ">", "log_blocks_per_seg", ")", "!", "=", "9", ")", "{", "f2fs_msg", "(", "sb", ",", "KERN_INFO", ",", "\"", "Invalid", "log", "blocks", "per", "segment", "(", "%", "u", ")", "\\", "n", "\"", ",", "le32_to_cpu", "(", "raw_super", "-", ">", "log_blocks_per_seg", ")", ");", "return", "1", ";", "}", "/", "*", "Currently", ",", "support", "512", "/", "1024", "/", "2048", "/", "4096", "bytes", "sector", "size", "*", "/", "if", "(", "le32_to_cpu", "(", "raw_super", "-", ">", "log_sectorsize", ")", ">", "F2FS_MAX_LOG_SECTOR_SIZE", "|", "|", "@", "@", "-", "965", ",", "6", "+", "1046", ",", "23", "@", "@", "static", "int", "sanity_check_raw_super", "(", "struct", "super_block", "*", "sb", ",", "le32_to_cpu", "(", "raw_super", "-", ">", "log_sectorsize", ")", ");", "return", "1", ";", "}", "/", "*", "check", "reserved", "ino", "info", "*", "/", "if", "(", "le32_to_cpu", "(", "raw_super", "-", ">", "node_ino", ")", "!", "=", "1", "|", "|", "le32_to_cpu", "(", "raw_super", "-", ">", "meta_ino", ")", "!", "=", "2", "|", "|", "le32_to_cpu", "(", "raw_super", "-", ">", "root_ino", ")", "!", "=", "3", ")", "{", "f2fs_msg", "(", "sb", ",", "KERN_INFO", ",", "\"", "Invalid", "Fs", "Meta", "Ino", ":", "node", "(", "%", "u", ")", "meta", "(", "%", "u", ")", "root", "(", "%", "u", ")", "\",", "le32_to_cpu", "(", "raw_super", "-", ">", "node_ino", ")", ",", "le32_to_cpu", "(", "raw_super", "-", ">", "meta_ino", ")", ",", "le32_to_cpu", "(", "raw_super", "-", ">", "root_ino", ")", ");", "return", "1", ";", "}", "/", "*", "check", "CP", "/", "SIT", "/", "NAT", "/", "SSA", "/", "MAIN_AREA", "area", "boundary", "*", "/", "if", "(", "sanity_check_area_boundary", "(", "sb", ",", "raw_super", ")", ")", "return", "1", ";", "return", "0", ";", "}"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "application"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "7455", ",", "7", "+", "7455", ",", "8", "@", "@", "static", "void", "vcpu_scan_ioapic", "(", "struct", "kvm_vcpu", "*", "vcpu", ")", "else", "{", "if", "(", "vcpu", "-", ">", "arch", ".", "apicv_active", ")", "kvm_x86_ops", "-", ">", "sync_pir_to_irr", "(", "vcpu", ")", ";", "kvm_ioapic_scan_entry", "(", "vcpu", ",", "vcpu", "-", ">", "arch", ".", "ioapic_handled_vectors", ")", ";", "if", "(", "ioapic_in_kernel", "(", "vcpu", "-", ">", "kvm", ")", ")", "kvm_ioapic_scan_entry", "(", "vcpu", ",", "vcpu", "-", ">", "arch", ".", "ioapic_handled_vectors", ")", ";", "}", "if", "(", "is_guest_mode", "(", "vcpu", ")", ")"], "docstring_tokens": ["using", "a", "specially-crafted", "system", "call"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "4", ",", "7", "+", "4", ",", "6", "@", "@", "import", "org", ".", "airsonic", ".", "player", ".", "domain", ".", "User", ";", "import", "org", ".", "airsonic", ".", "player", ".", "service", ".", "SecurityService", ";", "import", "org", ".", "airsonic", ".", "player", ".", "service", ".", "SettingsService", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang", ".", "RandomStringUtils", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang", ".", "StringUtils", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "@", "@", "-", "22", ",", "6", "+", "21", ",", "7", "@", "@", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletRequest", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletResponse", ";", "import", "java", ".", "security", ".", "SecureRandom", ";", "import", "java", ".", "util", ".", "Date", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "@", "@", "-", "37", ",", "6", "+", "37", ",", "10", "@", "@", "private", "static", "final", "Logger", "LOG", "=", "LoggerFactory", ".", "getLogger", "(", "RecoverController", ".", "class", ")", ";", "private", "static", "final", "String", "SYMBOLS", "=", "\"", "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890", "\"", ";", "private", "final", "SecureRandom", "random", "=", "new", "SecureRandom", "(", ");", "private", "static", "final", "int", "PASSWORD_LENGTH", "=", "32", ";", "@", "Autowired", "private", "SettingsService", "settingsService", ";", "@", "Autowired", "@", "@", "-", "69", ",", "7", "+", "73", ",", "13", "@", "@", "public", "ModelAndView", "recover", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "resp", "}", "else", "if", "(", "user", ".", "getEmail", "(", ")", "=", "=", "null", ")", "{", "map", ".", "put", "(", "\"", "error", "\"", ",", "\"", "recover", ".", "error", ".", "noemail", "\"", ");", "}", "else", "{", "String", "password", "=", "RandomStringUtils", ".", "randomAlphanumeric", "(", "8", ")", ";", "StringBuilder", "sb", "=", "new", "StringBuilder", "(", "PASSWORD_LENGTH", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "PASSWORD_LENGTH", ";", "i", "+", "+)", "{", "int", "index", "=", "random", ".", "nextInt", "(", "SYMBOLS", ".", "length", "(", "))", ";", "sb", ".", "append", "(", "SYMBOLS", ".", "charAt", "(", "index", ")", ");", "}", "String", "password", "=", "sb", ".", "toString", "(", ");", "if", "(", "emailPassword", "(", "password", ",", "user", ".", "getUsername", "(", "),", "user", ".", "getEmail", "(", "))", ")", "{", "map", ".", "put", "(", "\"", "sentTo", "\"", ",", "user", ".", "getEmail", "(", "))", ";", "user", ".", "setLdapAuthenticated", "(", "false", ")", ";"], "docstring_tokens": ["using", "a", "brute", "force", "technique"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "138", ",", "11", "+", "138", ",", "18", "@", "@", "static", "int", "_gd2GetHeader", "(", "gdIOCtxPtr", "in", ",", "int", "*", "sx", ",", "int", "*", "sy", ",", "int", "*", "cs", ",", "int", "*", "vers", ",", "in", "if", "(", "gd2_compressed", "(", "*", "fmt", ")", ")", "{", "nc", "=", "(", "*", "ncx", ")", "*", "(", "*", "ncy", ")", ";", "GD2_DBG", "(", "php_gd_error", "(", "\"", "Reading", "%", "d", "chunk", "index", "entries", "\"", ",", "nc", ")", ");", "if", "(", "overflow2", "(", "sidx", ",", "nc", ")", ")", "{", "goto", "fail1", ";", "}", "sidx", "=", "sizeof", "(", "t_chunk_info", ")", "*", "nc", ";", "if", "(", "sidx", "<", "=", "0", ")", "{", "goto", "fail1", ";", "}", "cidx", "=", "gdCalloc", "(", "sidx", ",", "1", ")", ";", "if", "(", "cidx", "=", "=", "NULL", ")", "{", "goto", "fail1", ";", "}", "for", "(", "i", "=", "0", ";", "i", "<", "nc", ";", "i", "+", "+)", "{", "if", "(", "gdGetInt", "(", "&", "cidx", "[", "i", "]", ".", "offset", ",", "in", ")", "!", "=", "1", ")", "{", "gdFree", "(", "cidx", ")", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "11", "@", "@", "-", "-", "TEST", "-", "-", "Bug", "#", "72339", "Integer", "Overflow", "in", "_gd2GetHeader", "(", ")", "resulting", "in", "heap", "overflow", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "function_exists", "(", "\"", "imagecreatefromgd2", "\"", "))", "print", "\"", "skip", "\"", ";", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "imagecreatefromgd2", "(", "dirname", "(", "__FILE__", ")", ".", "DIRECTORY_SEPARATOR", ".", "\"", "bug72339", ".", "gd", "\"", ");", "?", ">", "-", "-", "EXPECTF", "-", "-", "Warning", ":", "imagecreatefromgd2", "(", "):", "gd", "warning", ":", "product", "of", "memory", "allocation", "multiplication", "would", "exceed", "INT_MAX", ",", "failing", "operation", "gracefully", "in", "%", "sbug72339", ".", "php", "on", "line", "%", "d", "Warning", ":", "imagecreatefromgd2", "(", "):", "'", "%", "sbug72339", ".", "gd", "'", "is", "not", "a", "valid", "GD2", "file", "in", "%", "sbug72339", ".", "php", "on", "line", "%", "d"], "docstring_tokens": ["via", "crafted", "chunk", "dimensions", "in", "an", "image", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "72", ",", "6", "+", "72", ",", "9", "@", "@", "static", "void", "uvesafb_cn_callback", "(", "struct", "cn_msg", "*", "msg", ",", "struct", "netlink_skb_parms", "*", "ns", "struct", "uvesafb_task", "*", "utask", ";", "struct", "uvesafb_ktask", "*", "task", ";", "if", "(", "!", "cap_raised", "(", "nsp", "-", ">", "eff_cap", ",", "CAP_SYS_ADMIN", ")", ")", "return", ";", "if", "(", "msg", "-", ">", "seq", ">", "=", "UVESAFB_TASKS_MAX", ")", "return", ";"], "docstring_tokens": ["via", "calls", "to", "functions", "in", "these", "subsystems", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "41", ",", "6", "+", "41", ",", "10", "@", "@", ".", "Refactored", "the", "fix", "for", "bug", "#", "66084", "(", "simplexml_load_string", "(", ")", "mangles", "empty", "node", "name", ")", ".", "(", "Christoph", "Michael", "Becker", ")", "-", "SPL", ":", ".", "Fixed", "bug", "#", "69737", "(", "Segfault", "when", "SplMinHeap", ":", ":", "compare", "produces", "fatal", "error", ")", ".", "(", "Stas", ")", "14", "May", "2015", ",", "PHP", "5", ".", "5", ".", "25", "-", "Core", ":", "@", "@", "-", "249", ",", "9", "+", "249", ",", "10", "@", "@", "static", "void", "spl_ptr_heap_insert", "(", "spl_ptr_heap", "*", "heap", ",", "spl_ptr_heap_element", "elem", ",", "v", "heap", "-", ">", "ctor", "(", "elem", "TSRMLS_CC", ")", ";", "/", "*", "sifting", "up", "*", "/", "for", "(", "i", "=", "heap", "-", ">", "count", "+", "+;", "i", ">", "0", "&", "&", "heap", "-", ">", "cmp", "(", "heap", "-", ">", "elements", "[", "(", "i", "-", "1", ")", "/", "2", "]", ",", "elem", ",", "cmp_userdata", "TSRMLS_CC", ")", "<", "0", ";", "i", "=", "(", "i", "-", "1", ")", "/", "2", ")", "{", "for", "(", "i", "=", "heap", "-", ">", "count", ";", "i", ">", "0", "&", "&", "heap", "-", ">", "cmp", "(", "heap", "-", ">", "elements", "[", "(", "i", "-", "1", ")", "/", "2", "]", ",", "elem", ",", "cmp_userdata", "TSRMLS_CC", ")", "<", "0", ";", "i", "=", "(", "i", "-", "1", ")", "/", "2", ")", "{", "heap", "-", ">", "elements", "[", "i", "]", "=", "heap", "-", ">", "elements", "[", "(", "i", "-", "1", ")", "/", "2", "]", ";", "}", "heap", "-", ">", "count", "+", "+;", "if", "(", "EG", "(", "exception", ")", ")", "{", "/", "*", "exception", "thrown", "during", "comparison", "*", "/", "@", "@", "-", "0", ",", "0", "+", "1", ",", "16", "@", "@", "-", "-", "TEST", "-", "-", "Bug", "#", "69737", "(", "Segfault", "when", "SplMinHeap", ":", ":", "compare", "produces", "fatal", "error", ")", "-", "-", "FILE", "-", "-", "<", "?", "php", "class", "SplMinHeap1", "extends", "SplMinHeap", "{", "public", "function", "compare", "(", "$", "a", ",", "$", "b", ")", "{", "return", "-", "parent", ":", ":", "notexist", "(", "$", "a", ",", "$", "b", ")", ";", "}", "}", "$", "h", "=", "new", "SplMinHeap1", "(", ");", "$", "h", "-", ">", "insert", "(", "1", ")", ";", "$", "h", "-", ">", "insert", "(", "6", ")", ";", "?", ">", "=", "==", "DONE", "=", "==", "-", "-", "EXPECTF", "-", "-", "Fatal", "error", ":", "Call", "to", "undefined", "method", "SplMinHeap", ":", ":", "notexist", "(", ")", "in", "%", "s", "/", "bug69737", ".", "php", "on", "line", "%", "d"], "docstring_tokens": ["triggering", "a", "failed", "SplMinHeap::compare", "operation"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "890", ",", "8", "+", "890", ",", "21", "@", "@", "static", "struct", "mount", "*", "clone_mnt", "(", "struct", "mount", "*", "old", ",", "struct", "dentry", "*", "root", ",", "mnt", "-", ">", "mnt", ".", "mnt_flags", "=", "old", "-", ">", "mnt", ".", "mnt_flags", "&", "~", "(", "MNT_WRITE_HOLD", "|", "MNT_MARKED", ")", ";", "/", "*", "Don", "'", "t", "allow", "unprivileged", "users", "to", "change", "mount", "flags", "*", "/", "if", "(", "(", "flag", "&", "CL_UNPRIVILEGED", ")", "&", "&", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_READONLY", ")", ")", "mnt", "-", ">", "mnt", ".", "mnt_flags", "|", "=", "MNT_LOCK_READONLY", ";", "if", "(", "flag", "&", "CL_UNPRIVILEGED", ")", "{", "mnt", "-", ">", "mnt", ".", "mnt_flags", "|", "=", "MNT_LOCK_ATIME", ";", "if", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_READONLY", ")", "mnt", "-", ">", "mnt", ".", "mnt_flags", "|", "=", "MNT_LOCK_READONLY", ";", "if", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_NODEV", ")", "mnt", "-", ">", "mnt", ".", "mnt_flags", "|", "=", "MNT_LOCK_NODEV", ";", "if", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_NOSUID", ")", "mnt", "-", ">", "mnt", ".", "mnt_flags", "|", "=", "MNT_LOCK_NOSUID", ";", "if", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_NOEXEC", ")", "mnt", "-", ">", "mnt", ".", "mnt_flags", "|", "=", "MNT_LOCK_NOEXEC", ";", "}", "/", "*", "Don", "'", "t", "allow", "unprivileged", "users", "to", "reveal", "what", "is", "under", "a", "mount", "*", "/", "if", "(", "(", "flag", "&", "CL_UNPRIVILEGED", ")", "&", "&", "list_empty", "(", "&", "old", "-", ">", "mnt_expire", ")", ")", "@", "@", "-", "1931", ",", "6", "+", "1944", ",", "23", "@", "@", "static", "int", "do_remount", "(", "struct", "path", "*", "path", ",", "int", "flags", ",", "int", "mnt_flags", ",", "!", "(", "mnt_flags", "&", "MNT_READONLY", ")", ")", "{", "return", "-", "EPERM", ";", "}", "if", "(", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_LOCK_NODEV", ")", "&", "&", "!", "(", "mnt_flags", "&", "MNT_NODEV", ")", ")", "{", "return", "-", "EPERM", ";", "}", "if", "(", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_LOCK_NOSUID", ")", "&", "&", "!", "(", "mnt_flags", "&", "MNT_NOSUID", ")", ")", "{", "return", "-", "EPERM", ";", "}", "if", "(", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_LOCK_NOEXEC", ")", "&", "&", "!", "(", "mnt_flags", "&", "MNT_NOEXEC", ")", ")", "{", "return", "-", "EPERM", ";", "}", "if", "(", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_LOCK_ATIME", ")", "&", "&", "(", "(", "mnt", "-", ">", "mnt", ".", "mnt_flags", "&", "MNT_ATIME_MASK", ")", "!", "=", "(", "mnt_flags", "&", "MNT_ATIME_MASK", ")", "))", "{", "return", "-", "EPERM", ";", "}", "err", "=", "security_sb_remount", "(", "sb", ",", "data", ")", ";", "if", "(", "err", ")", "return", "err", ";", "@", "@", "-", "2129", ",", "7", "+", "2159", ",", "7", "@", "@", "static", "int", "do_new_mount", "(", "struct", "path", "*", "path", ",", "const", "char", "*", "fstype", ",", "int", "flags", ",", "*", "/", "if", "(", "!(", "type", "-", ">", "fs_flags", "&", "FS_USERNS_DEV_MOUNT", ")", ")", "{", "flags", "|", "=", "MS_NODEV", ";", "mnt_flags", "|", "=", "MNT_NODEV", ";", "mnt_flags", "|", "=", "MNT_NODEV", "|", "MNT_LOCK_NODEV", ";", "}", "}", "@", "@", "-", "45", ",", "12", "+", "45", ",", "17", "@", "@", "struct", "mnt_namespace", ";", "#", "define", "MNT_USER_SETTABLE_MASK", "(", "MNT_NOSUID", "|", "MNT_NODEV", "|", "MNT_NOEXEC", "\\", "|", "MNT_NOATIME", "|", "MNT_NODIRATIME", "|", "MNT_RELATIME", "\\", "|", "MNT_READONLY", ")", "#", "define", "MNT_ATIME_MASK", "(", "MNT_NOATIME", "|", "MNT_NODIRATIME", "|", "MNT_RELATIME", ")", "#", "define", "MNT_INTERNAL_FLAGS", "(", "MNT_SHARED", "|", "MNT_WRITE_HOLD", "|", "MNT_INTERNAL", "|", "\\", "MNT_DOOMED", "|", "MNT_SYNC_UMOUNT", "|", "MNT_MARKED", ")", "#", "define", "MNT_INTERNAL", "0x4000", "#", "define", "MNT_LOCK_ATIME", "0x040000", "#", "define", "MNT_LOCK_NOEXEC", "0x080000", "#", "define", "MNT_LOCK_NOSUID", "0x100000", "#", "define", "MNT_LOCK_NODEV", "0x200000", "#", "define", "MNT_LOCK_READONLY", "0x400000", "#", "define", "MNT_LOCKED", "0x800000", "#", "define", "MNT_DOOMED", "0x1000000"], "docstring_tokens": ["via", "a", "\"mount", "-o", "remount", "\"", "command", "within", "a", "user", "namespace", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "228", ",", "19", "+", "228", ",", "18", "@", "@", "Jetty", "9", ".", "4", ".", "19", ".", "v20190610", "Upgrade", "Notes", "*", "Velocity", "response", "writer", "is", "no", "longer", "available", "to", "be", "used", "through", "the", "_default", "configset", ".", "In", "order", "to", "use", "it", ",", "you", "would", "need", "to", "manually", "add", "it", "to", "your", "configset", ".", "Also", ",", "the", "initialization", "parameters", "*", "Velocity", ":", "The", "initialization", "parameters", "\"", "params", ".", "resource", ".", "loader", ".", "enabled", "\"", "and", "\"", "solr", ".", "resource", ".", "loader", ".", "enabled", "\"", "have", "been", "removed", "and", "replaced", "by", "startup", "parameters", "\"", "velocity", ".", "resourceloader", ".", "params", ".", "enabled", "\"", "and", "\"", "velocity", ".", "resourceloader", ".", "solr", ".", "enabled", "\"", "Java", "system", "properties", "\"", "velocity", ".", "resourceloader", ".", "params", ".", "enabled", "\"", "and", "\"", "velocity", ".", "resourceloader", ".", "solr", ".", "enabled", "\"", "respectively", "(", "both", "turned", "off", "by", "default", ")", ".", "Please", "see", "SOLR", "-", "13971", "for", "more", "details", ".", "Bug", "Fixes", "*", "SOLR", "-", "13963", ":", "JavaBinCodec", "has", "concurrent", "modification", "of", "CharArr", "resulting", "in", "corrupt", "internode", "updates", "(", "Colvin", "Cowie", ",", "noble", ")", "*", "SOLR", "-", "13971", ":", "Velocity", "response", "writer", "'", "s", "resource", "loading", "now", "possible", "only", "through", "startup", "parameters", ".", "Also", ",", "removed", "velocity", "response", "writer", "from", "_default", "configset", ".", "(", "Ishan", "Chattopadhyaya", ")", "*", "SOLR", "-", "13971", ":", "Velocity", "response", "writer", "'", "s", "resource", "loading", "now", "possible", "only", "through", "startup", "parameters", ".", "(", "Ishan", "Chattopadhyaya", ",", "David", "Smiley", ")", "=", "==", "==", "==", "==", "==", "==", "==", "==", "=", "8", ".", "3", ".", "0", "=", "==", "==", "==", "==", "==", "==", "==", "==", "=", "@", "@", "-", "108", ",", "12", "+", "108", ",", "10", "@", "@", "public", "void", "init", "(", "NamedList", "args", ")", "{", "}", "/", "/", "params", "resource", "loader", ":", "off", "by", "default", "Boolean", "prle", "=", "Boolean", ".", "getBoolean", "(", "PARAMS_RESOURCE_LOADER_ENABLED", ")", ";", "paramsResourceLoaderEnabled", "=", "(", "null", "=", "=", "prle", "?", "false", ":", "prle", ")", ";", "paramsResourceLoaderEnabled", "=", "Boolean", ".", "getBoolean", "(", "PARAMS_RESOURCE_LOADER_ENABLED", ")", ";", "/", "/", "solr", "resource", "loader", ":", "off", "by", "default", "Boolean", "srle", "=", "Boolean", ".", "getBoolean", "(", "SOLR_RESOURCE_LOADER_ENABLED", ")", ";", "solrResourceLoaderEnabled", "=", "(", "null", "=", "=", "srle", "?", "false", ":", "srle", ")", ";", "solrResourceLoaderEnabled", "=", "Boolean", ".", "getBoolean", "(", "SOLR_RESOURCE_LOADER_ENABLED", ")", ";", "initPropertiesFileName", "=", "(", "String", ")", "args", ".", "get", "(", "PROPERTIES_FILE", ")", ";", "@", "@", "-", "81", ",", "6", "+", "81", ",", "8", "@", "@", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "contrib", "/", "langid", "/", "lib", "/", "\"", "regex", "=", "\".", "*\\", ".", "jar", "\"", "/", ">", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "dist", "/", "\"", "regex", "=", "\"", "solr", "-", "langid", "-", "\\", "d", ".", "*\\", ".", "jar", "\"", "/", ">", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "contrib", "/", "velocity", "/", "lib", "\"", "regex", "=", "\".", "*\\", ".", "jar", "\"", "/", ">", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "dist", "/", "\"", "regex", "=", "\"", "solr", "-", "velocity", "-", "\\", "d", ".", "*\\", ".", "jar", "\"", "/", ">", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "dist", "/", "\"", "regex", "=", "\"", "solr", "-", "ltr", "-", "\\", "d", ".", "*\\", ".", "jar", "\"", "/", ">", "<", "!-", "-", "an", "exact", "'", "path", "'", "can", "be", "used", "instead", "of", "a", "'", "dir", "'", "to", "specify", "a", "@", "@", "-", "778", ",", "7", "+", "780", ",", "7", "@", "@", "(", "SearchHandler", ")", "can", "be", "registered", "multiple", "times", "with", "different", "names", "(", "and", "different", "init", "parameters", ")", "-", "->", "<", "requestHandler", "name", "=", "\"/", "browse", "\"", "class", "=", "\"", "solr", ".", "SearchHandler", "\"", "useParams", "=", "\"", "query", ",", "facets", ",", "browse", "\"", ">", "<", "requestHandler", "name", "=", "\"/", "browse", "\"", "class", "=", "\"", "solr", ".", "SearchHandler", "\"", "useParams", "=", "\"", "query", ",", "facets", ",", "velocity", ",", "browse", "\"", ">", "<", "lst", "name", "=", "\"", "defaults", "\"", ">", "<", "str", "name", "=", "\"", "echoParams", "\"", ">", "explicit", "<", "/", "str", ">", "<", "/", "lst", ">", "@", "@", "-", "1290", ",", "6", "+", "1292", ",", "15", "@", "@", "<", "/", "queryResponseWriter", ">", "-", "->", "<", "!-", "-", "Custom", "response", "writers", "can", "be", "declared", "as", "needed", ".", "..", "-", "->", "<", "queryResponseWriter", "name", "=", "\"", "velocity", "\"", "class", "=", "\"", "solr", ".", "VelocityResponseWriter", "\"", "startup", "=", "\"", "lazy", "\"", ">", "<", "str", "name", "=", "\"", "template", ".", "base", ".", "dir", "\"", ">$", "{", "velocity", ".", "template", ".", "base", ".", "dir", ":", "}<", "/", "str", ">", "<", "str", "name", "=", "\"", "solr", ".", "resource", ".", "loader", ".", "enabled", "\"", ">$", "{", "velocity", ".", "solr", ".", "resource", ".", "loader", ".", "enabled", ":", "true", "}", "</", "str", ">", "<", "str", "name", "=", "\"", "params", ".", "resource", ".", "loader", ".", "enabled", "\"", ">$", "{", "velocity", ".", "params", ".", "resource", ".", "loader", ".", "enabled", ":", "false", "}", "</", "str", ">", "<", "/", "queryResponseWriter", ">", "<", "!-", "-", "XSLT", "response", "writer", "transforms", "the", "XML", "output", "by", "any", "xslt", "file", "found", "in", "Solr", "'", "s", "conf", "/", "xslt", "directory", ".", "Changes", "to", "xslt", "files", "are", "checked", "for", "every", "xsltCacheLifetimeSeconds", ".", "@", "@", "-", "81", ",", "6", "+", "81", ",", "8", "@", "@", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "contrib", "/", "langid", "/", "lib", "/", "\"", "regex", "=", "\".", "*\\", ".", "jar", "\"", "/", ">", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "dist", "/", "\"", "regex", "=", "\"", "solr", "-", "langid", "-", "\\", "d", ".", "*\\", ".", "jar", "\"", "/", ">", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "contrib", "/", "velocity", "/", "lib", "\"", "regex", "=", "\".", "*\\", ".", "jar", "\"", "/", ">", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "dist", "/", "\"", "regex", "=", "\"", "solr", "-", "velocity", "-", "\\", "d", ".", "*\\", ".", "jar", "\"", "/", ">", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "dist", "/", "\"", "regex", "=", "\"", "solr", "-", "ltr", "-", "\\", "d", ".", "*\\", ".", "jar", "\"", "/", ">", "<", "!-", "-", "an", "exact", "'", "path", "'", "can", "be", "used", "instead", "of", "a", "'", "dir", "'", "to", "specify", "a", "@", "@", "-", "778", ",", "7", "+", "780", ",", "7", "@", "@", "(", "SearchHandler", ")", "can", "be", "registered", "multiple", "times", "with", "different", "names", "(", "and", "different", "init", "parameters", ")", "-", "->", "<", "requestHandler", "name", "=", "\"/", "browse", "\"", "class", "=", "\"", "solr", ".", "SearchHandler", "\"", "useParams", "=", "\"", "query", ",", "facets", ",", "browse", "\"", ">", "<", "requestHandler", "name", "=", "\"/", "browse", "\"", "class", "=", "\"", "solr", ".", "SearchHandler", "\"", "useParams", "=", "\"", "query", ",", "facets", ",", "velocity", ",", "browse", "\"", ">", "<", "lst", "name", "=", "\"", "defaults", "\"", ">", "<", "str", "name", "=", "\"", "echoParams", "\"", ">", "explicit", "<", "/", "str", ">", "<", "/", "lst", ">", "@", "@", "-", "1290", ",", "6", "+", "1292", ",", "15", "@", "@", "<", "/", "queryResponseWriter", ">", "-", "->", "<", "!-", "-", "Custom", "response", "writers", "can", "be", "declared", "as", "needed", ".", "..", "-", "->", "<", "queryResponseWriter", "name", "=", "\"", "velocity", "\"", "class", "=", "\"", "solr", ".", "VelocityResponseWriter", "\"", "startup", "=", "\"", "lazy", "\"", ">", "<", "str", "name", "=", "\"", "template", ".", "base", ".", "dir", "\"", ">$", "{", "velocity", ".", "template", ".", "base", ".", "dir", ":", "}<", "/", "str", ">", "<", "str", "name", "=", "\"", "solr", ".", "resource", ".", "loader", ".", "enabled", "\"", ">$", "{", "velocity", ".", "solr", ".", "resource", ".", "loader", ".", "enabled", ":", "true", "}", "</", "str", ">", "<", "str", "name", "=", "\"", "params", ".", "resource", ".", "loader", ".", "enabled", "\"", ">$", "{", "velocity", ".", "params", ".", "resource", ".", "loader", ".", "enabled", ":", "false", "}", "</", "str", ">", "<", "/", "queryResponseWriter", ">", "<", "!-", "-", "XSLT", "response", "writer", "transforms", "the", "XML", "output", "by", "any", "xslt", "file", "found", "in", "Solr", "'", "s", "conf", "/", "xslt", "directory", ".", "Changes", "to", "xslt", "files", "are", "checked", "for", "every", "xsltCacheLifetimeSeconds", ".", "@", "@", "-", "17", ",", "8", "+", "17", ",", "8", "@", "@", "/", "/", "specific", "language", "governing", "permissions", "and", "limitations", "/", "/", "under", "the", "License", ".", "Solr", "allows", "you", "to", "load", "custom", "code", "to", "perform", "a", "variety", "of", "tasks", "within", "Solr", ",", "from", "custom", "Request", "Handlers", "to", "process", "your", "searches", ",", "to", "custom", "Analyzers", "and", "Token", "Filters", "for", "your", "text", "field", ".", "You", "can", "even", "load", "custom", "Field", "Types", ".", "These", "pieces", "of", "custom", "code", "are", "called", "plugins", ".", "Solr", "allows", "you", "to", "load", "custom", "code", "to", "perform", "a", "variety", "of", "tasks", "within", "Solr", ",", "from", "custom", "Request", "Handlers", "to", "process", "your", "searches", ",", "to", "custom", "Analyzers", "and", "Token", "Filters", "for", "your", "text", "field", ".", "You", "can", "even", "load", "custom", "Field", "Types", ".", "These", "pieces", "of", "custom", "code", "are", "called", "_plugins_", ".", "Not", "everyone", "will", "need", "to", "create", "plugins", "for", "their", "Solr", "instances", "-", "what", "'", "s", "provided", "is", "usually", "enough", "for", "most", "applications", ".", "However", ",", "if", "there", "'", "s", "something", "that", "you", "need", ",", "you", "may", "want", "to", "review", "the", "Solr", "Wiki", "documentation", "on", "plugins", "at", "http", ":", "//", "wiki", ".", "apache", ".", "org", "/", "solr", "/", "SolrPlugins", "[", "SolrPlugins", "]", ".", "Not", "everyone", "will", "need", "to", "create", "plugins", "for", "their", "Solr", "instances", "-", "what", "'", "s", "provided", "is", "usually", "enough", "for", "most", "applications", ".", "However", ",", "if", "there", "'", "s", "something", "that", "you", "need", ",", "you", "may", "want", "to", "review", "the", "Solr", "Wiki", "documentation", "on", "plugins", "at", "https", ":", "//", "cwiki", ".", "apache", ".", "org", "/", "confluence", "/", "display", "/", "solr", "/", "SolrPlugins", "[", "SolrPlugins", "]", ".", "If", "you", "have", "a", "plugin", "you", "would", "like", "to", "use", ",", "and", "you", "are", "running", "in", "SolrCloud", "mode", ",", "you", "can", "use", "the", "Blob", "Store", "API", "and", "the", "Config", "API", "to", "load", "the", "jars", "to", "Solr", ".", "The", "commands", "to", "use", "are", "described", "in", "the", "section", "<", "<", "adding", "-", "custom", "-", "plugins", "-", "in", "-", "solrcloud", "-", "mode", ".", "adoc", "#", "adding", "-", "custom", "-", "plugins", "-", "in", "-", "solrcloud", "-", "mode", ",", "Adding", "Custom", "Plugins", "in", "SolrCloud", "Mode", ">", ">.", "@", "@", "-", "40", ",", "6", "+", "40", ",", "8", "@", "@", "The", "above", "example", "shows", "the", "optional", "initialization", "and", "custom", "tool", "parameters", "u", "=", "==", "VelocityResponseWriter", "Startup", "Parameters", "These", "are", "Java", "system", "properties", "to", "mitigate", "security", "risks", ".", "`", "velocity", ".", "resourceloader", ".", "params", ".", "enabled", "`", "::", "The", "\"", "params", "\"", "resource", "loader", "allows", "templates", "to", "be", "specified", "in", "Solr", "request", "parameters", ".", "For", "example", ":"], "docstring_tokens": ["the", "VelocityResponseWriter"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "16", ",", "6", "+", "16", ",", "8", "@", "@", "PHP", "NEWS", "-", "GD", ":", ".", "Fixed", "bug", "#", "66901", "(", "php", "-", "gd", "'", "c_color", "'", "NULL", "pointer", "dereference", ")", ".", "(", "CVE", "-", "2014", "-", "2497", ")", "(", "Remi", ")", ".", "Fixed", "bug", "#", "67730", "(", "Null", "byte", "injection", "possible", "with", "imagexxx", "functions", ")", ".", "(", "CVE", "-", "2014", "-", "5120", ")", "(", "Ryan", "Mauger", ")", "-", "Milter", ":", ".", "Fixed", "bug", "#", "67715", "(", "php", "-", "milter", "does", "not", "build", "and", "crashes", "randomly", ")", ".", "(", "Mike", ")", "@", "@", "-", "124", ",", "6", "+", "124", ",", "11", "@", "@", "static", "void", "_php_image_output_ctx", "(", "INTERNAL_FUNCTION_PARAMETERS", ",", "int", "image_type", ",", "RETURN_FALSE", ";", "}", "}", "else", "if", "(", "Z_TYPE_P", "(", "to_zval", ")", "=", "=", "IS_STRING", ")", "{", "if", "(", "CHECK_ZVAL_NULL_PATH", "(", "to_zval", ")", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "Invalid", "2nd", "parameter", ",", "filename", "must", "not", "contain", "null", "bytes", "\"", ");", "RETURN_FALSE", ";", "}", "stream", "=", "php_stream_open_wrapper", "(", "Z_STRVAL_P", "(", "to_zval", ")", ",", "\"", "wb", "\"", ",", "REPORT_ERRORS", "|", "IGNORE_PATH", "|", "IGNORE_URL_WIN", ",", "NULL", ")", ";", "if", "(", "stream", "=", "=", "NULL", ")", "{", "RETURN_FALSE", ";"], "docstring_tokens": ["."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "4929", ",", "7", "+", "4929", ",", "7", "@", "@", "we", "set", "the", "flag", "only", "if", "there", "is", "a", "literal", "\"", "\\", "r", "\"", "or", "\"", "\\", "n", "\"", "in", "the", "class", ".", "*", "/", "(", "lengthptr", "=", "=", "NULL", "|", "|", "*", "lengthptr", "=", "=", "2", "+", "2", "*", "LINK_SIZE", ")", ")", "{", "cd", "-", ">", "external_options", "=", "newoptions", ";", "options", "=", "newoptions", ";", "options", "=", "*", "optionsptr", "=", "newoptions", ";", "}", "else", "{"], "docstring_tokens": ["via", "a", "regular", "expression", "that", "begins", "with", "an", "option", "and", "contains", "multiple", "branches", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "19", ",", "6", "+", "19", ",", "7", "@", "@", "package", "org", ".", "jvnet", ".", "hudson", ".", "plugins", ".", "monitoring", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "Enumeration", ";", "import", "javax", ".", "servlet", ".", "FilterChain", ";", "import", "javax", ".", "servlet", ".", "FilterConfig", ";", "@", "@", "-", "69", ",", "9", "+", "70", ",", "19", "@", "@", "public", "void", "doFilter", "(", "ServletRequest", "request", ",", "ServletResponse", "response", ",", "FilterCha", "final", "String", "monitoringUrl", "=", "getMonitoringUrl", "(", "httpRequest", ")", ";", "final", "String", "monitoringSlavesUrl", "=", "monitoringUrl", "+", "\"", "/", "nodes", "\"", ";", "if", "(", "!", "PLUGIN_AUTHENTICATION_DISABLED", "&", "&", "(", "requestURI", ".", "equals", "(", "monitoringUrl", ")", "|", "|", "requestURI", ".", "equals", "(", "monitoringSlavesUrl", ")", "))", "{", "&", "&", "(", "requestURI", ".", "equals", "(", "monitoringUrl", ")", "|", "|", "requestURI", ".", "startsWith", "(", "monitoringSlavesUrl", ")", "))", "{", "/", "/", "only", "the", "Hudson", "/", "Jenkins", "administrator", "can", "view", "the", "monitoring", "report", "Jenkins", ".", "getInstance", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "Enumeration", "<", "?>", "parameterNames", "=", "request", ".", "getParameterNames", "(", ");", "while", "(", "parameterNames", ".", "hasMoreElements", "(", "))", "{", "String", "parameterName", "=", "(", "String", ")", "parameterNames", ".", "nextElement", "(", ");", "for", "(", "String", "value", ":", "request", ".", "getParameterValues", "(", "parameterName", ")", ")", "{", "if", "(", "value", ".", "indexOf", "(", "'\"", "')", "!", "=", "-", "1", "|", "|", "value", ".", "indexOf", "(", "'\\", "''", ")", "!", "=", "-", "1", "|", "|", "value", ".", "indexOf", "(", "'<", "')", "!", "=", "-", "1", "|", "|", "value", ".", "indexOf", "(", "'&", "')", "!", "=", "-", "1", ")", "{", "(", "(", "HttpServletResponse", ")", "response", ")", ".", "sendError", "(", "HttpServletResponse", ".", "SC_BAD_REQUEST", ")", ";", "return", ";", "}", "}", "}", "}", "if", "(", "requestURI", ".", "startsWith", "(", "monitoringSlavesUrl", ")", ")", "{"], "docstring_tokens": ["via", "unspecified", "vectors", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "347", ",", "6", "+", "347", ",", "7", "@", "@", "static", "const", "struct", "nla_policy", "nl80211_policy", "[", "NUM_NL80211_ATTR", "]", "=", "{", "[", "NL80211_ATTR_SCAN_FLAGS", "]", "=", "{", ".", "type", "=", "NLA_U32", "}", ",", "[", "NL80211_ATTR_P2P_CTWINDOW", "]", "=", "{", ".", "type", "=", "NLA_U8", "}", ",", "[", "NL80211_ATTR_P2P_OPPPS", "]", "=", "{", ".", "type", "=", "NLA_U8", "}", ",", "[", "NL80211_ATTR_LOCAL_MESH_POWER_MODE", "]", "=", "{", ".", "type", "=", "NLA_U32", "}", ",", "[", "NL80211_ATTR_ACL_POLICY", "]", "=", "{", ".", "type", "=", "NLA_U32", "}", ",", "[", "NL80211_ATTR_MAC_ADDRS", "]", "=", "{", ".", "type", "=", "NLA_NESTED", "}", ",", "[", "NL80211_ATTR_STA_CAPABILITY", "]", "=", "{", ".", "type", "=", "NLA_U16", "}", ","], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "519", ",", "7", "+", "519", ",", "8", "@", "@", "void", "brcmf_rx_frame", "(", "struct", "device", "*", "dev", ",", "struct", "sk_buff", "*", "skb", ",", "bool", "handle_event", ")", "}", "else", "{", "/", "*", "Process", "special", "event", "packets", "*", "/", "if", "(", "handle_event", ")", "brcmf_fweh_process_skb", "(", "ifp", "-", ">", "drvr", ",", "skb", ")", ";", "brcmf_fweh_process_skb", "(", "ifp", "-", ">", "drvr", ",", "skb", ",", "BCMILCP_SUBTYPE_VENDOR_LONG", ")", ";", "brcmf_netif_rx", "(", "ifp", ",", "skb", ")", ";", "}", "@", "@", "-", "536", ",", "7", "+", "537", ",", "7", "@", "@", "void", "brcmf_rx_event", "(", "struct", "device", "*", "dev", ",", "struct", "sk_buff", "*", "skb", ")", "if", "(", "brcmf_rx_hdrpull", "(", "drvr", ",", "skb", ",", "&", "ifp", ")", ")", "return", ";", "brcmf_fweh_process_skb", "(", "ifp", "-", ">", "drvr", ",", "skb", ")", ";", "brcmf_fweh_process_skb", "(", "ifp", "-", ">", "drvr", ",", "skb", ",", "0", ")", ";", "brcmu_pkt_buf_free_skb", "(", "skb", ")", ";", "}", "@", "@", "-", "211", ",", "7", "+", "211", ",", "7", "@", "@", "enum", "brcmf_fweh_event_code", "{", "*", "/", "#", "define", "BRCM_OUI", "\"", "\\", "x00", "\\", "x10", "\\", "x18", "\"", "#", "define", "BCMILCP_BCM_SUBTYPE_EVENT", "1", "#", "define", "BCMILCP_SUBTYPE_VENDOR_LONG", "32769", "/", "**", "*", "struct", "brcm_ethhdr", "-", "broadcom", "specific", "ether", "header", ".", "@", "@", "-", "334", ",", "10", "+", "334", ",", "10", "@", "@", "void", "brcmf_fweh_process_event", "(", "struct", "brcmf_pub", "*", "drvr", ",", "void", "brcmf_fweh_p2pdev_setup", "(", "struct", "brcmf_if", "*", "ifp", ",", "bool", "ongoing", ")", ";", "static", "inline", "void", "brcmf_fweh_process_skb", "(", "struct", "brcmf_pub", "*", "drvr", ",", "struct", "sk_buff", "*", "skb", ")", "struct", "sk_buff", "*", "skb", ",", "u16", "stype", ")", "{", "struct", "brcmf_event", "*", "event_packet", ";", "u16", "usr_stype", ";", "u16", "subtype", ",", "usr_stype", ";", "/", "*", "only", "process", "events", "when", "protocol", "matches", "*", "/", "if", "(", "skb", "-", ">", "protocol", "!", "=", "cpu_to_be16", "(", "ETH_P_LINK_CTL", ")", ")", "@", "@", "-", "346", ",", "8", "+", "346", ",", "16", "@", "@", "static", "inline", "void", "brcmf_fweh_process_skb", "(", "struct", "brcmf_pub", "*", "drvr", ",", "if", "(", "(", "skb", "-", ">", "len", "+", "ETH_HLEN", ")", "<", "sizeof", "(", "*", "event_packet", ")", ")", "return", ";", "/", "*", "check", "for", "BRCM", "oui", "match", "*", "/", "event_packet", "=", "(", "struct", "brcmf_event", "*", ")", "skb_mac_header", "(", "skb", ")", ";", "/", "*", "check", "subtype", "if", "needed", "*", "/", "if", "(", "unlikely", "(", "stype", ")", ")", "{", "subtype", "=", "get_unaligned_be16", "(", "&", "event_packet", "-", ">", "hdr", ".", "subtype", ")", ";", "if", "(", "subtype", "!", "=", "stype", ")", "return", ";", "}", "/", "*", "check", "for", "BRCM", "oui", "match", "*", "/", "if", "(", "memcmp", "(", "BRCM_OUI", ",", "&", "event_packet", "-", ">", "hdr", ".", "oui", "[", "0", "]", ",", "sizeof", "(", "event_packet", "-", ">", "hdr", ".", "oui", ")", "))", "return", ";", "@", "@", "-", "1116", ",", "7", "+", "1116", ",", "7", "@", "@", "static", "void", "brcmf_msgbuf_process_event", "(", "struct", "brcmf_msgbuf", "*", "msgbuf", ",", "void", "*", "buf", ")", "skb", "-", ">", "protocol", "=", "eth_type_trans", "(", "skb", ",", "ifp", "-", ">", "ndev", ")", ";", "brcmf_fweh_process_skb", "(", "ifp", "-", ">", "drvr", ",", "skb", ")", ";", "brcmf_fweh_process_skb", "(", "ifp", "-", ">", "drvr", ",", "skb", ",", "0", ")", ";", "exit", ":", "brcmu_pkt_buf_free_skb", "(", "skb", ")", ";"], "docstring_tokens": ["receiving", "firmware", "event", "frames", "from", "a", "remote", "source"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1", ",", "7", "+", "1", ",", "5", "@", "@", "package", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "provider", ";", "import", "com", ".", "fasterxml", ".", "jackson", ".", "annotation", ".", "JsonIgnore", ";", "public", "class", "LockoutPolicy", "{", "private", "int", "lockoutPeriodSeconds", ";", "private", "int", "lockoutAfterFailures", ";", "@", "@", "-", "17", ",", "11", "+", "15", ",", "6", "@", "@", "public", "LockoutPolicy", "(", "int", "countFailuresWithin", ",", "int", "lockoutAfterFailures", ",", "int", "lock", "this", ".", "lockoutPeriodSeconds", "=", "lockoutPeriodSeconds", ";", "}", "@", "JsonIgnore", "public", "boolean", "isLockoutEnabled", "(", ")", "{", "return", "countFailuresWithin", ">", "0", ";", "}", "public", "LockoutPolicy", "setLockoutPeriodSeconds", "(", "int", "lockoutPeriod", ")", "{", "this", ".", "lockoutPeriodSeconds", "=", "lockoutPeriod", ";", "return", "this", ";", "@", "@", "-", "6", ",", "11", "+", "6", ",", "18", "@", "@", "public", "class", "ClientLockoutPolicyRetriever", "implements", "LockoutPolicyRetriever", "{", "private", "LockoutPolicy", "defaultLockoutPolicy", ";", "private", "LockoutPolicy", "disabledLockoutPolicy", "=", "new", "LockoutPolicy", "(", ");", "private", "boolean", "isEnabled", ";", "@", "Override", "public", "LockoutPolicy", "getLockoutPolicy", "(", ")", "{", "LockoutPolicy", "res", "=", "IdentityZoneHolder", ".", "get", "(", ").", "getConfig", "(", ").", "getClientLockoutPolicy", "(", ");", "return", "res", ".", "getLockoutAfterFailures", "(", ")", "!", "=", "-", "1", "?", "res", ":", "defaultLockoutPolicy", ";", "if", "(", "isEnabled", ")", "{", "LockoutPolicy", "res", "=", "IdentityZoneHolder", ".", "get", "(", ").", "getConfig", "(", ").", "getClientLockoutPolicy", "(", ");", "return", "res", ".", "getLockoutAfterFailures", "(", ")", "!", "=", "-", "1", "?", "res", ":", "defaultLockoutPolicy", ";", "}", "else", "{", "return", "disabledLockoutPolicy", ";", "}", "}", "@", "Override", "@", "@", "-", "22", ",", "4", "+", "29", ",", "9", "@", "@", "public", "LockoutPolicy", "getDefaultLockoutPolicy", "(", ")", "{", "public", "void", "setDefaultLockoutPolicy", "(", "LockoutPolicy", "defaultLockoutPolicy", ")", "{", "this", ".", "defaultLockoutPolicy", "=", "defaultLockoutPolicy", ";", "}", "public", "ClientLockoutPolicyRetriever", "setEnabled", "(", "boolean", "enabled", ")", "{", "isEnabled", "=", "enabled", ";", "return", "this", ";", "}", "}", "@", "@", "-", "44", ",", "10", "+", "44", ",", "6", "@", "@", "public", "CommonLoginPolicy", "(", "UaaAuditService", "auditService", ",", "public", "Result", "isAllowed", "(", "String", "principalId", ")", "{", "LockoutPolicy", "lockoutPolicy", "=", "lockoutPolicyRetriever", ".", "getLockoutPolicy", "(", ");", "if", "(", "!", "lockoutPolicy", ".", "isLockoutEnabled", "(", "))", "{", "return", "new", "Result", "(", "true", ",", "0", ")", ";", "}", "long", "eventsAfter", "=", "System", ".", "currentTimeMillis", "(", ")", "-", "lockoutPolicy", ".", "getCountFailuresWithin", "(", ")", "*", "1000", ";", "List", "<", "AuditEvent", ">", "events", "=", "auditService", ".", "find", "(", "principalId", ",", "eventsAfter", ")", ";", "@", "@", "-", "255", ",", "6", "+", "255", ",", "7", "@", "@", "<", "/", "bean", ">", "<", "bean", "id", "=", "\"", "clientLockoutPolicyRetriever", "\"", "class", "=", "\"", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "authentication", ".", "manager", ".", "ClientLockoutPolicyRetriever", "\"", ">", "<", "property", "name", "=", "\"", "enabled", "\"", "value", "=", "\"$", "{", "authentication", ".", "policy", ".", "client", ".", "lockoutEnabled", ":", "false", "}", "\"", "/", ">", "<", "property", "name", "=", "\"", "defaultLockoutPolicy", "\"", "ref", "=", "\"", "defaultClientLockoutPolicy", "\"", "/", ">", "<", "/", "bean", ">", "@", "@", "-", "573", ",", "11", "+", "574", ",", "11", "@", "@", "<", "bean", "id", "=", "\"", "defaultClientLockoutPolicy", "\"", "class", "=", "\"", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "provider", ".", "LockoutPolicy", "\"", ">", "<", "property", "name", "=", "\"", "lockoutAfterFailures", "\"", "value", "=", "\"$", "{", "authentication", ".", "policy", ".", "global", ".", "lockoutAfterFailures", ":", "5", "}", "\"/", ">", "value", "=", "\"$", "{", "authentication", ".", "policy", ".", "global", ".", "lockoutAfterFailures", ":", "-", "1", "}", "\"/", ">", "<", "property", "name", "=", "\"", "countFailuresWithin", "\"", "value", "=", "\"$", "{", "authentication", ".", "policy", ".", "global", ".", "countFailuresWithinSeconds", ":", "-", "1", "}", "\"/", ">", "<", "property", "name", "=", "\"", "lockoutPeriodSeconds", "\"", "value", "=", "\"$", "{", "authentication", ".", "policy", ".", "global", ".", "lockoutPeriodSeconds", ":", "300", "}", "\"/", ">", "value", "=", "\"$", "{", "authentication", ".", "policy", ".", "global", ".", "lockoutPeriodSeconds", ":", "-", "1", "}", "\"/", ">", "<", "/", "bean", ">", "<", "bean", "id", "=", "\"", "globalUserLockoutPolicyRetriever", "\"", "class", "=", "\"", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "authentication", ".", "manager", ".", "UserLockoutPolicyRetriever", "\"", ">", "@", "@", "-", "25", ",", "12", "+", "25", ",", "7", "@", "@", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "client", ".", "ClientConstants", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "jwt", ".", "Jwt", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "jwt", ".", "JwtHelper", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "token", ".", "ClaimConstants", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "token", ".", "Claims", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "token", ".", "CompositeAccessToken", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "token", ".", "JdbcRevocableTokenProvisioning", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "token", ".", "RevocableToken", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "token", ".", "RevocableTokenProvisioning", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "token", ".", "*;", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "provider", ".", "IdentityProvider", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "provider", ".", "PasswordPolicy", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "provider", ".", "UaaIdentityProviderDefinition", ";", "@", "@", "-", "81", ",", "69", "+", "76", ",", "30", "@", "@", "import", "java", ".", "net", ".", "URL", ";", "import", "java", ".", "net", ".", "URLDecoder", ";", "import", "java", ".", "sql", ".", "Timestamp", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Calendar", ";", "import", "java", ".", "util", ".", "Date", ";", "import", "java", ".", "util", ".", "GregorianCalendar", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "LinkedHashMap", ";", "import", "java", ".", "util", ".", "LinkedList", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "TreeSet", ";", "import", "java", ".", "util", ".", "*;", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "mock", ".", "util", ".", "MockMvcUtils", ".", "CookieCsrfPostProcessor", ".", "cookieCsrf", ";", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "mock", ".", "util", ".", "MockMvcUtils", ".", "createClient", ";", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "mock", ".", "util", ".", "MockMvcUtils", ".", "createUser", ";", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "mock", ".", "util", ".", "MockMvcUtils", ".", "getClientCredentialsOAuthAccessToken", ";", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "mock", ".", "util", ".", "MockMvcUtils", ".", "getUserOAuthAccessToken", ";", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "mock", ".", "util", ".", "MockMvcUtils", ".", "setDisableInternalAuth", ";", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "mock", ".", "util", ".", "MockMvcUtils", ".", "*;", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "UaaTokenServicesTests", ".", "PASSWORD", ";", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "token", ".", "ClaimConstants", ".", "JTI", ";", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "token", ".", "TokenConstants", ".", "ID_TOKEN_HINT_PROMPT", ";", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "token", ".", "TokenConstants", ".", "ID_TOKEN_HINT_PROMPT_NONE", ";", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "token", ".", "TokenConstants", ".", "OPAQUE", ";", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "token", ".", "TokenConstants", ".", "REFRESH_TOKEN_SUFFIX", ";", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "token", ".", "TokenConstants", ".", "REQUEST_TOKEN_FORMAT", ";", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "oauth", ".", "token", ".", "TokenConstants", ".", "*;", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "web", ".", "UaaSavedRequestAwareAuthenticationSuccessHandler", ".", "FORM_REDIRECT_PARAMETER", ";", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "web", ".", "UaaSavedRequestAwareAuthenticationSuccessHandler", ".", "SAVED_REQUEST_SESSION_ATTRIBUTE", ";", "import", "static", "org", ".", "hamcrest", ".", "CoreMatchers", ".", "not", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "containsInAnyOrder", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "containsString", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "endsWith", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "greaterThan", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "hasItem", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "lessThanOrEqualTo", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "stringContainsInOrder", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "*;", "import", "static", "org", ".", "hamcrest", ".", "core", ".", "Is", ".", "is", ";", "import", "static", "org", ".", "hamcrest", ".", "core", ".", "StringStartsWith", ".", "startsWith", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertFalse", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNull", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertThat", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "fail", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*;", "import", "static", "org", ".", "springframework", ".", "http", ".", "HttpHeaders", ".", "AUTHORIZATION", ";", "import", "static", "org", ".", "springframework", ".", "http", ".", "MediaType", ".", "APPLICATION_FORM_URLENCODED", ";", "import", "static", "org", ".", "springframework", ".", "http", ".", "MediaType", ".", "APPLICATION_JSON", ";", "import", "static", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "common", ".", "OAuth2AccessToken", ".", "ACCESS_TOKEN", ";", "import", "static", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "common", ".", "OAuth2AccessToken", ".", "REFRESH_TOKEN", ";", "import", "static", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "common", ".", "util", ".", "OAuth2Utils", ".", "GRANT_TYPE", ";", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "request", ".", "MockMvcRequestBuilders", ".", "delete", ";", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "request", ".", "MockMvcRequestBuilders", ".", "get", ";", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "request", ".", "MockMvcRequestBuilders", ".", "post", ";", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "request", ".", "MockMvcRequestBuilders", ".", "*;", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "result", ".", "MockMvcResultHandlers", ".", "print", ";", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "result", ".", "MockMvcResultMatchers", ".", "content", ";", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "result", ".", "MockMvcResultMatchers", ".", "cookie", ";", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "result", ".", "MockMvcResultMatchers", ".", "forwardedUrl", ";", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "result", ".", "MockMvcResultMatchers", ".", "header", ";", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "result", ".", "MockMvcResultMatchers", ".", "model", ";", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "result", ".", "MockMvcResultMatchers", ".", "*;", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "result", ".", "MockMvcResultMatchers", ".", "request", ";", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "result", ".", "MockMvcResultMatchers", ".", "status", ";", "public", "class", "TokenMvcMockTests", "extends", "AbstractTokenMockMvcTests", "{", "@", "@", "-", "2352", ",", "17", "+", "2308", ",", "8", "@", "@", "public", "void", "clientCredentials_byDefault_willNotLockoutClientsUsingFormData", "(", ")", "thr", "String", "clientId", "=", "\"", "testclient", "\"", "+", "generator", ".", "generate", "(", ");", "String", "scopes", "=", "\"", "space", ".", "*.", "developer", ",", "space", ".", "*.", "admin", ",", "org", ".", "*.", "reader", ",", "org", ".", "123", "*", ".", "admin", ",", "*.", "*,", "*\"", ";", "setUpClients", "(", "clientId", ",", "scopes", ",", "scopes", ",", "GRANT_TYPES", ",", "true", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "6", ";", "i", "+", "+)", "{", "getMockMvc", "(", ")", ".", "perform", "(", "post", "(", "\"/", "oauth", "/", "token", "\"", ")", ".", "accept", "(", "MediaType", ".", "APPLICATION_JSON_VALUE", ")", ".", "contentType", "(", "MediaType", ".", "APPLICATION_FORM_URLENCODED_VALUE", ")", ".", "param", "(", "\"", "grant_type", "\"", ",", "\"", "client_credentials", "\"", ")", ".", "param", "(", "\"", "client_id", "\"", ",", "clientId", ")", ".", "param", "(", "\"", "client_secret", "\"", ",", "BADSECRET", ")", ")", ".", "andExpect", "(", "status", "(", ").", "isUnauthorized", "(", "))", ".", "andReturn", "(", ").", "getResponse", "(", ").", "getContentAsString", "(", ");", "tryLoginWithWrongSecretInBody", "(", "clientId", ")", ";", "}", "getMockMvc", "(", ")", "@", "@", "-", "2383", ",", "57", "+", "2330", ",", "53", "@", "@", "public", "void", "clientCredentials_byDefault_WillNotLockoutDuringFailedBasicAuth", "(", ")", "th", "setUpClients", "(", "clientId", ",", "scopes", ",", "scopes", ",", "GRANT_TYPES", ",", "true", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "6", ";", "i", "+", "+)", "{", "getMockMvc", "(", ")", ".", "perform", "(", "post", "(", "\"/", "oauth", "/", "token", "\"", ")", ".", "accept", "(", "MediaType", ".", "APPLICATION_JSON_VALUE", ")", ".", "header", "(", "\"", "Authorization", "\"", ",", "\"", "Basic", "\"", "+", "new", "String", "(", "Base64", ".", "encode", "(", "(", "clientId", "+", "\"", ":\"", "+", "BADSECRET", ")", ".", "getBytes", "(", "))", "))", ".", "param", "(", "\"", "grant_type", "\"", ",", "\"", "client_credentials", "\"", "))", ".", "andExpect", "(", "status", "(", ").", "isUnauthorized", "(", "))", ".", "andReturn", "(", ").", "getResponse", "(", ").", "getContentAsString", "(", ");", "tryLoginWithWrongSecretInHeader", "(", "clientId", ")", ";", "}", "getMockMvc", "(", ")", ".", "perform", "(", "post", "(", "\"/", "oauth", "/", "token", "\"", ")", ".", "accept", "(", "MediaType", ".", "APPLICATION_JSON_VALUE", ")", ".", "header", "(", "\"", "Authorization", "\"", ",", "\"", "Basic", "\"", "+", "new", "String", "(", "Base64", ".", "encode", "(", "(", "clientId", "+", "\"", ":\"", "+", "SECRET", ")", ".", "getBytes", "(", "))", "))", ".", "param", "(", "\"", "grant_type", "\"", ",", "\"", "client_credentials", "\"", "))", ".", "andExpect", "(", "status", "(", ").", "isOk", "(", "))", ".", "andReturn", "(", ").", "getResponse", "(", ").", "getContentAsString", "(", ");", "login", "(", "clientId", ")", ";", "}", "@", "Test", "public", "void", "clientCredentials_byDefault_WillNotLockoutDuringFailedBasicAuthAndFormData", "(", ")", "throws", "Exception", "{", "String", "clientId", "=", "\"", "testclient", "\"", "+", "generator", ".", "generate", "(", ");", "String", "scopes", "=", "\"", "space", ".", "*.", "developer", ",", "space", ".", "*.", "admin", ",", "org", ".", "*.", "reader", ",", "org", ".", "123", "*", ".", "admin", ",", "*.", "*,", "*\"", ";", "setUpClients", "(", "clientId", ",", "scopes", ",", "scopes", ",", "GRANT_TYPES", ",", "true", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "3", ";", "i", "+", "+)", "{", "tryLoginWithWrongSecretInHeader", "(", "clientId", ")", ";", "tryLoginWithWrongSecretInBody", "(", "clientId", ")", ";", "}", "login", "(", "clientId", ")", ";", "}", "String", "body", "=", "null", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "3", ";", "i", "+", "+)", "{", "body", "=", "getMockMvc", "(", ").", "perform", "(", "post", "(", "\"/", "oauth", "/", "token", "\"", ")", "private", "void", "tryLoginWithWrongSecretInHeader", "(", "String", "clientId", ")", "throws", "Exception", "{", "getMockMvc", "(", ").", "perform", "(", "post", "(", "\"/", "oauth", "/", "token", "\"", ")", ".", "accept", "(", "MediaType", ".", "APPLICATION_JSON_VALUE", ")", ".", "header", "(", "\"", "Authorization", "\"", ",", "\"", "Basic", "\"", "+", "new", "String", "(", "Base64", ".", "encode", "(", "(", "clientId", "+", "\"", ":\"", "+", "BADSECRET", ")", ".", "getBytes", "(", "))", "))", ".", "param", "(", "\"", "grant_type", "\"", ",", "\"", "client_credentials", "\"", ")", ")", ")", ".", "andExpect", "(", "status", "(", ").", "isUnauthorized", "(", "))", ".", "andReturn", "(", ").", "getResponse", "(", ").", "getContentAsString", "(", ");", "}", "body", "=", "getMockMvc", "(", ").", "perform", "(", "post", "(", "\"/", "oauth", "/", "token", "\"", ")", ".", "accept", "(", "MediaType", ".", "APPLICATION_JSON_VALUE", ")", ".", "contentType", "(", "MediaType", ".", "APPLICATION_FORM_URLENCODED_VALUE", ")", ".", "param", "(", "\"", "grant_type", "\"", ",", "\"", "client_credentials", "\"", ")", ".", "param", "(", "\"", "client_id", "\"", ",", "clientId", ")", ".", "param", "(", "\"", "client_secret", "\"", ",", "BADSECRET", ")", ")", ".", "andExpect", "(", "status", "(", ").", "isUnauthorized", "(", "))", ".", "andReturn", "(", ").", "getResponse", "(", ").", "getContentAsString", "(", ");", "}", "private", "void", "tryLoginWithWrongSecretInBody", "(", "String", "clientId", ")", "throws", "Exception", "{", "getMockMvc", "(", ").", "perform", "(", "post", "(", "\"/", "oauth", "/", "token", "\"", ")", ".", "accept", "(", "MediaType", ".", "APPLICATION_JSON_VALUE", ")", ".", "contentType", "(", "MediaType", ".", "APPLICATION_FORM_URLENCODED_VALUE", ")", ".", "param", "(", "\"", "grant_type", "\"", ",", "\"", "client_credentials", "\"", ")", ".", "param", "(", "\"", "client_id", "\"", ",", "clientId", ")", ".", "param", "(", "\"", "client_secret", "\"", ",", "BADSECRET", ")", ")", ".", "andExpect", "(", "status", "(", ").", "isUnauthorized", "(", "))", ".", "andReturn", "(", ").", "getResponse", "(", ").", "getContentAsString", "(", ");", "}", "body", "=", "getMockMvc", "(", ").", "perform", "(", "post", "(", "\"/", "oauth", "/", "token", "\"", ")", "private", "void", "login", "(", "String", "clientId", ")", "throws", "Exception", "{", "getMockMvc", "(", ").", "perform", "(", "post", "(", "\"/", "oauth", "/", "token", "\"", ")", ".", "accept", "(", "MediaType", ".", "APPLICATION_JSON_VALUE", ")", ".", "header", "(", "\"", "Authorization", "\"", ",", "\"", "Basic", "\"", "+", "new", "String", "(", "Base64", ".", "encode", "(", "(", "clientId", "+", "\"", ":\"", "+", "SECRET", ")", ".", "getBytes", "(", "))", "))", ".", "param", "(", "\"", "grant_type", "\"", ",", "\"", "client_credentials", "\"", ")", ")", ")", ".", "andExpect", "(", "status", "(", ").", "isOk", "(", "))", ".", "andReturn", "(", ").", "getResponse", "(", ").", "getContentAsString", "(", ");", "}"], "docstring_tokens": ["using", "the", "lockout", "feature"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "273", ",", "7", "+", "273", ",", "8", "@", "@", "long", "keyctl_get_keyring_ID", "(", "key_serial_t", "id", ",", "int", "create", ")", "*", "Create", "and", "join", "an", "anonymous", "session", "keyring", "or", "join", "a", "named", "session", "*", "keyring", ",", "creating", "it", "if", "necessary", ".", "A", "named", "session", "keyring", "must", "have", "Search", "*", "permission", "for", "it", "to", "be", "joined", ".", "Session", "keyrings", "without", "this", "permit", "will", "*", "be", "skipped", "over", ".", "*", "be", "skipped", "over", ".", "It", "is", "not", "permitted", "for", "userspace", "to", "create", "or", "join", "*", "keyrings", "whose", "name", "begin", "with", "a", "dot", ".", "*", "*", "If", "successful", ",", "the", "ID", "of", "the", "joined", "session", "keyring", "will", "be", "returned", ".", "*", "/", "@", "@", "-", "290", ",", "12", "+", "291", ",", "16", "@", "@", "long", "keyctl_join_session_keyring", "(", "const", "char", "__user", "*", "_name", ")", "ret", "=", "PTR_ERR", "(", "name", ")", ";", "goto", "error", ";", "}", "ret", "=", "-", "EPERM", ";", "if", "(", "name", "[", "0", "]", "=", "=", "'", ".'", ")", "goto", "error_name", ";", "}", "/", "*", "join", "the", "session", "*", "/", "ret", "=", "join_session_keyring", "(", "name", ")", ";", "error_name", ":", "kfree", "(", "name", ")", ";", "error", ":", "return", "ret", ";", "}"], "docstring_tokens": ["adding", "a", "new", "public", "key", "of", "its", "own", "devising", "to", "the", "keyring"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "58", ",", "7", "+", "58", ",", "7", "@", "@", "struct", "thread_info", "{", "struct", "cpu_context_save", "cpu_context", ";", "/", "*", "cpu", "context", "*", "/", "__u32", "syscall", ";", "/", "*", "syscall", "number", "*", "/", "__u8", "used_cp", "[", "16", "]", ";", "/", "*", "thread", "used", "copro", "*", "/", "unsigned", "long", "tp_value", ";", "unsigned", "long", "tp_value", "[", "2", "]", ";", "/", "*", "TLS", "registers", "*", "/", "#", "ifdef", "CONFIG_CRUNCH", "struct", "crunch_state", "crunchstate", ";", "#", "endif", "@", "@", "-", "2", ",", "27", "+", "2", ",", "30", "@", "@", "#", "define", "__ASMARM_TLS_H", "#", "ifdef", "__ASSEMBLY__", ".", "macro", "set_tls_none", ",", "tp", ",", "tmp1", ",", "tmp2", "#", "include", "<", "asm", "/", "asm", "-", "offsets", ".", "h", ">", ".", "macro", "switch_tls_none", ",", "base", ",", "tp", ",", "tpuser", ",", "tmp1", ",", "tmp2", ".", "endm", ".", "macro", "set_tls_v6k", ",", "tp", ",", "tmp1", ",", "tmp2", ".", "macro", "switch_tls_v6k", ",", "base", ",", "tp", ",", "tpuser", ",", "tmp1", ",", "tmp2", "mrc", "p15", ",", "0", ",", "\\", "tmp2", ",", "c13", ",", "c0", ",", "2", "@", "get", "the", "user", "r", "/", "w", "register", "mcr", "p15", ",", "0", ",", "\\", "tp", ",", "c13", ",", "c0", ",", "3", "@", "set", "TLS", "register", "mov", "\\", "tmp1", ",", "#", "0", "mcr", "p15", ",", "0", ",", "\\", "tmp1", ",", "c13", ",", "c0", ",", "2", "@", "clear", "user", "r", "/", "w", "TLS", "register", "mcr", "p15", ",", "0", ",", "\\", "tpuser", ",", "c13", ",", "c0", ",", "2", "@", "and", "the", "user", "r", "/", "w", "register", "str", "\\", "tmp2", ",", "[", "\\", "base", ",", "#", "TI_TP_VALUE", "+", "4", "]", "@", "save", "it", ".", "endm", ".", "macro", "set_tls_v6", ",", "tp", ",", "tmp1", ",", "tmp2", ".", "macro", "switch_tls_v6", ",", "base", ",", "tp", ",", "tpuser", ",", "tmp1", ",", "tmp2", "ldr", "\\", "tmp1", ",", "=", "elf_hwcap", "ldr", "\\", "tmp1", ",", "[", "\\", "tmp1", ",", "#", "0", "]", "mov", "\\", "tmp2", ",", "#", "0xffff0fff", "tst", "\\", "tmp1", ",", "#", "HWCAP_TLS", "@", "hardware", "TLS", "available", "?", "mcrne", "p15", ",", "0", ",", "\\", "tp", ",", "c13", ",", "c0", ",", "3", "@", "yes", ",", "set", "TLS", "register", "movne", "\\", "tmp1", ",", "#", "0", "mcrne", "p15", ",", "0", ",", "\\", "tmp1", ",", "c13", ",", "c0", ",", "2", "@", "clear", "user", "r", "/", "w", "TLS", "register", "streq", "\\", "tp", ",", "[", "\\", "tmp2", ",", "#", "-", "15", "]", "@", "set", "TLS", "value", "at", "0xffff0ff0", "mrcne", "p15", ",", "0", ",", "\\", "tmp2", ",", "c13", ",", "c0", ",", "2", "@", "get", "the", "user", "r", "/", "w", "register", "mcrne", "p15", ",", "0", ",", "\\", "tp", ",", "c13", ",", "c0", ",", "3", "@", "yes", ",", "set", "TLS", "register", "mcrne", "p15", ",", "0", ",", "\\", "tpuser", ",", "c13", ",", "c0", ",", "2", "@", "set", "user", "r", "/", "w", "register", "strne", "\\", "tmp2", ",", "[", "\\", "base", ",", "#", "TI_TP_VALUE", "+", "4", "]", "@", "save", "it", ".", "endm", ".", "macro", "set_tls_software", ",", "tp", ",", "tmp1", ",", "tmp2", ".", "macro", "switch_tls_software", ",", "base", ",", "tp", ",", "tpuser", ",", "tmp1", ",", "tmp2", "mov", "\\", "tmp1", ",", "#", "0xffff0fff", "str", "\\", "tp", ",", "[", "\\", "tmp1", ",", "#", "-", "15", "]", "@", "set", "TLS", "value", "at", "0xffff0ff0", ".", "endm", "@", "@", "-", "31", ",", "19", "+", "34", ",", "30", "@", "@", "#", "ifdef", "CONFIG_TLS_REG_EMUL", "#", "define", "tls_emu", "1", "#", "define", "has_tls_reg", "1", "#", "define", "set_tls", "set_tls_none", "#", "define", "switch_tls", "switch_tls_none", "#", "elif", "defined", "(", "CONFIG_CPU_V6", ")", "#", "define", "tls_emu", "0", "#", "define", "has_tls_reg", "(", "elf_hwcap", "&", "HWCAP_TLS", ")", "#", "define", "set_tls", "set_tls_v6", "#", "define", "switch_tls", "switch_tls_v6", "#", "elif", "defined", "(", "CONFIG_CPU_32v6K", ")", "#", "define", "tls_emu", "0", "#", "define", "has_tls_reg", "1", "#", "define", "set_tls", "set_tls_v6k", "#", "define", "switch_tls", "switch_tls_v6k", "#", "else", "#", "define", "tls_emu", "0", "#", "define", "has_tls_reg", "0", "#", "define", "set_tls", "set_tls_software", "#", "define", "switch_tls", "switch_tls_software", "#", "endif", "#", "ifndef", "__ASSEMBLY__", "static", "inline", "unsigned", "long", "get_tpuser", "(", "void", ")", "{", "unsigned", "long", "reg", "=", "0", ";", "if", "(", "has_tls_reg", "&", "&", "!", "tls_emu", ")", "__asm__", "(", "\"", "mrc", "p15", ",", "0", ",", "%", "0", ",", "c13", ",", "c0", ",", "2", "\"", ":", "\"", "=", "r", "\"", "(", "reg", ")", ");", "return", "reg", ";", "}", "#", "endif", "#", "endif", "/", "*", "__ASMARM_TLS_H", "*", "/", "@", "@", "-", "685", ",", "15", "+", "685", ",", "16", "@", "@", "ENTRY", "(", "__switch_to", ")", "UNWIND", "(", ".", "fnstart", ")", "UNWIND", "(", ".", "cantunwind", ")", "add", "ip", ",", "r1", ",", "#", "TI_CPU_SAVE", "ldr", "r3", ",", "[", "r2", ",", "#", "TI_TP_VALUE", "]", "ARM", "(", "stmia", "ip", "!", ",", "{", "r4", "-", "sl", ",", "fp", ",", "sp", ",", "lr", "}", ")", "@", "Store", "most", "regs", "on", "stack", "THUMB", "(", "stmia", "ip", "!", ",", "{", "r4", "-", "sl", ",", "fp", "}", ")", "@", "Store", "most", "regs", "on", "stack", "THUMB", "(", "str", "sp", ",", "[", "ip", "]", ",", "#", "4", ")", "THUMB", "(", "str", "lr", ",", "[", "ip", "]", ",", "#", "4", ")", "ldr", "r4", ",", "[", "r2", ",", "#", "TI_TP_VALUE", "]", "ldr", "r5", ",", "[", "r2", ",", "#", "TI_TP_VALUE", "+", "4", "]", "#", "ifdef", "CONFIG_CPU_USE_DOMAINS", "ldr", "r6", ",", "[", "r2", ",", "#", "TI_CPU_DOMAIN", "]", "#", "endif", "set_tls", "r3", ",", "r4", ",", "r5", "switch_tls", "r1", ",", "r4", ",", "r5", ",", "r3", ",", "r7", "#", "if", "defined", "(", "CONFIG_CC_STACKPROTECTOR", ")", "&", "&", "!", "defined", "(", "CONFIG_SMP", ")", "ldr", "r7", ",", "[", "r2", ",", "#", "TI_TASK", "]", "ldr", "r8", ",", "=", "__stack_chk_guard", "@", "@", "-", "39", ",", "6", "+", "39", ",", "7", "@", "@", "#", "include", "<", "asm", "/", "thread_notify", ".", "h", ">", "#", "include", "<", "asm", "/", "stacktrace", ".", "h", ">", "#", "include", "<", "asm", "/", "mach", "/", "time", ".", "h", ">", "#", "include", "<", "asm", "/", "tls", ".", "h", ">", "#", "ifdef", "CONFIG_CC_STACKPROTECTOR", "#", "include", "<", "linux", "/", "stackprotector", ".", "h", ">", "@", "@", "-", "343", ",", "7", "+", "344", ",", "8", "@", "@", "copy_thread", "(", "unsigned", "long", "clone_flags", ",", "unsigned", "long", "stack_start", ",", "clear_ptrace_hw_breakpoint", "(", "p", ")", ";", "if", "(", "clone_flags", "&", "CLONE_SETTLS", ")", "thread", "-", ">", "tp_value", "=", "childregs", "-", ">", "ARM_r3", ";", "thread", "-", ">", "tp_value", "[", "0", "]", "=", "childregs", "-", ">", "ARM_r3", ";", "thread", "-", ">", "tp_value", "[", "1", "]", "=", "get_tpuser", "(", ");", "thread_notify", "(", "THREAD_NOTIFY_COPY", ",", "thread", ")", ";", "@", "@", "-", "849", ",", "7", "+", "849", ",", "7", "@", "@", "long", "arch_ptrace", "(", "struct", "task_struct", "*", "child", ",", "long", "request", ",", "#", "endif", "case", "PTRACE_GET_THREAD_AREA", ":", "ret", "=", "put_user", "(", "task_thread_info", "(", "child", ")", "->", "tp_value", ",", "ret", "=", "put_user", "(", "task_thread_info", "(", "child", ")", "->", "tp_value", "[", "0", "]", ",", "datap", ")", ";", "break", ";", "@", "@", "-", "581", ",", "7", "+", "581", ",", "7", "@", "@", "asmlinkage", "int", "arm_syscall", "(", "int", "no", ",", "struct", "pt_regs", "*", "regs", ")", "return", "regs", "-", ">", "ARM_r0", ";", "case", "NR", "(", "set_tls", ")", ":", "thread", "-", ">", "tp_value", "=", "regs", "-", ">", "ARM_r0", ";", "thread", "-", ">", "tp_value", "[", "0", "]", "=", "regs", "-", ">", "ARM_r0", ";", "if", "(", "tls_emu", ")", "return", "0", ";", "if", "(", "has_tls_reg", ")", "{", "@", "@", "-", "699", ",", "7", "+", "699", ",", "7", "@", "@", "static", "int", "get_tp_trap", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "int", "instr", ")", "int", "reg", "=", "(", "instr", ">", ">", "12", ")", "&", "15", ";", "if", "(", "reg", "=", "=", "15", ")", "return", "1", ";", "regs", "-", ">", "uregs", "[", "reg", "]", "=", "current_thread_info", "(", ")-", ">", "tp_value", ";", "regs", "-", ">", "uregs", "[", "reg", "]", "=", "current_thread_info", "(", ")-", ">", "tp_value", "[", "0", "]", ";", "regs", "-", ">", "ARM_pc", "+", "=", "4", ";", "return", "0", ";", "}"], "docstring_tokens": ["persuading", "a", "victim", "to", "install", "a", "specially-crafted", "application"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "15", ",", "10", "+", "15", ",", "9", "@", "@", "dependencies", "{", "compile", "\"", "com", ".", "fasterxml", ".", "jackson", ".", "core", ":", "jackson", "-", "core", ":", "${", "revJacksonCore", "}", "\"", "compile", "\"", "javax", ".", "inject", ":", "javax", ".", "inject", ":", "${", "revJavaxInject", "}", "\"", "compile", "\"", "com", ".", "github", ".", "vmg", ".", "protogen", ":", "protogen", "-", "annotations", ":", "${", "revProtogenAnnotations", "}", "\"", "compile", "\"", "org", ".", "hibernate", ":", "hibernate", "-", "validator", ":", "${", "revHiberante", "}", "\"", "compile", "\"", "org", ".", "apache", ".", "bval", ":", "bval", "-", "jsr", ":", "${", "revBval", "}", "\"", "compile", "\"", "javax", ".", "validation", ":", "validation", "-", "api", ":", "${", "revValidationApi", "}", "\"", "compile", "\"", "org", ".", "apache", ".", "commons", ":", "commons", "-", "lang3", ":", "${", "revCommonsLang3", "}", "\"", "/", "/", "Bean", "validation", "runtime", "dependencies", "compile", "\"", "javax", ".", "el", ":", "javax", ".", "el", "-", "api", ":", "${", "revJavaElApi", "}", "\"", "/", "/", "https", ":", "//", "mvnrepository", ".", "com", "/", "artifact", "/", "org", ".", "glassfish", "/", "javax", ".", "el", "compile", "group", ":", "'", "org", ".", "glassfish", "'", ",", "name", ":", "'", "javax", ".", "el", "'", ",", "version", ":", "\"", "${", "revJavaElApi", "}", "\"", "}", "@", "@", "-", "14", ",", "9", "+", "14", ",", "8", "@", "@", "dependencies", "{", "compile", "\"", "org", ".", "apache", ".", "commons", ":", "commons", "-", "lang3", ":", "${", "revCommonsLang3", "}", "\"", "compile", "\"", "com", ".", "spotify", ":", "completable", "-", "futures", ":", "${", "revSpotifyCompletableFutures", "}", "\"", "compile", "\"", "com", ".", "amazonaws", ":", "aws", "-", "java", "-", "sdk", "-", "s3", ":", "${", "revAwsSdk", "}", "\"", "compile", "\"", "org", ".", "hibernate", ":", "hibernate", "-", "validator", ":", "${", "revHiberante", "}", "\"", "/", "/", "Bean", "validation", "runtime", "dependencies", "compile", "\"", "javax", ".", "el", ":", "javax", ".", "el", "-", "api", ":", "${", "revJavaElApi", "}", "\"", "compile", "\"", "org", ".", "apache", ".", "bval", ":", "bval", "-", "jsr", ":", "${", "revBval", "}", "\"", "compile", "\"", "javax", ".", "validation", ":", "validation", "-", "api", ":", "${", "revValidationApi", "}", "\"", "/", "/", "https", ":", "//", "mvnrepository", ".", "com", "/", "artifact", "/", "org", ".", "glassfish", "/", "javax", ".", "el", "compile", "group", ":", "'", "org", ".", "glassfish", "'", ",", "name", ":", "'", "javax", ".", "el", "'", ",", "version", ":", "\"", "${", "revJavaElApi", "}", "\"", "@", "@", "-", "3", ",", "17", "+", "3", ",", "11", "@", "@", "import", "com", ".", "google", ".", "inject", ".", "AbstractModule", ";", "import", "com", ".", "google", ".", "inject", ".", "Provides", ";", "import", "com", ".", "google", ".", "inject", ".", "Singleton", ";", "import", "com", ".", "google", ".", "inject", ".", "multibindings", ".", "MultibindingsScanner", ";", "import", "com", ".", "google", ".", "inject", ".", "multibindings", ".", "ProvidesIntoSet", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "HibernateValidator", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "HibernateValidatorConfiguration", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "ConstraintMapping", ";", "import", "com", ".", "netflix", ".", "conductor", ".", "validations", ".", "TaskDefConstraint", ";", "import", "org", ".", "apache", ".", "bval", ".", "jsr", ".", "ApacheValidationProvider", ";", "import", "org", ".", "apache", ".", "bval", ".", "util", ".", "reflection", ".", "Reflection", ";", "import", "javax", ".", "validation", ".", "Validation", ";", "import", "javax", ".", "validation", ".", "Validator", ";", "import", "javax", ".", "validation", ".", "ValidatorContext", ";", "import", "java", ".", "util", ".", "Set", ";", "/", "**", "*", "Most", "of", "the", "constraints", "validators", "are", "define", "at", "data", "model", "@", "@", "-", "27", ",", "34", "+", "21", ",", "22", "@", "@", "*", "/", "public", "class", "ValidationModule", "extends", "AbstractModule", "{", "/", "**", "*", "Custom", "validation", "mapping", "configuration", "for", "constraints", "defined", "in", "core", "module", ".", "*", "/", "private", "static", "final", "String", "VALIDATION_MAPPING_FILE", "=", "\"", "conductor", "-", "validation", "-", "mapping", ".", "xml", "\"", ";", "@", "Override", "protected", "void", "configure", "(", ")", "{", "install", "(", "MultibindingsScanner", ".", "asModule", "(", "))", ";", "}", "@", "Provides", "@", "Singleton", "public", "HibernateValidatorConfiguration", "getConfiguration", "(", ")", "{", "return", "Validation", ".", "byProvider", "(", "HibernateValidator", ".", "class", ")", ".", "configure", "(", ");", "public", "Validator", "getValidator", "(", ")", "{", "return", "Validation", ".", "byProvider", "(", "ApacheValidationProvider", ".", "class", ")", ".", "configure", "(", ")", ".", "addMapping", "(", "Reflection", ".", "loaderFromThreadOrClass", "(", "this", ".", "getClass", "(", "))", ".", "getResourceAsStream", "(", "VALIDATION_MAPPING_FILE", ")", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "}", "@", "Provides", "@", "Singleton", "public", "Validator", "getValidator", "(", "ValidatorContext", "validatorContext", ")", "{", "return", "validatorContext", ".", "getValidator", "(", ");", "}", "@", "Provides", "@", "Singleton", "public", "ValidatorContext", "getValidatorContext", "(", "HibernateValidatorConfiguration", "configuration", ",", "Set", "<", "ConstraintMapping", ">", "constraintMappings", ")", "{", "constraintMappings", ".", "forEach", "(", "configuration", ":", ":", "addMapping", ")", ";", "return", "configuration", ".", "buildValidatorFactory", "(", ")", ".", "usingContext", "(", ");", "}", "@", "ProvidesIntoSet", "public", "ConstraintMapping", "getWorkflowTaskConstraint", "(", "final", "HibernateValidatorConfiguration", "configuration", ")", "{", "return", "TaskDefConstraint", ".", "getWorkflowTaskConstraint", "(", "configuration", ")", ";", "}", "}", "@", "@", "-", "1", ",", "22", "+", "0", ",", "0", "@", "@", "package", "com", ".", "netflix", ".", "conductor", ".", "validations", ";", "import", "com", ".", "google", ".", "inject", ".", "Singleton", ";", "import", "com", ".", "google", ".", "inject", ".", "multibindings", ".", "ProvidesIntoSet", ";", "import", "com", ".", "netflix", ".", "conductor", ".", "common", ".", "metadata", ".", "workflow", ".", "WorkflowTask", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "HibernateValidatorConfiguration", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "ConstraintMapping", ";", "public", "class", "TaskDefConstraint", "{", "@", "Singleton", "@", "ProvidesIntoSet", "public", "static", "ConstraintMapping", "getWorkflowTaskConstraint", "(", "final", "HibernateValidatorConfiguration", "configuration", ")", "{", "ConstraintMapping", "mapping", "=", "configuration", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ".", "constraint", "(", "new", "WorkflowTaskValidConstraintDef", "(", "))", ";", "return", "mapping", ";", "}", "}", "@", "@", "-", "1", ",", "11", "+", "0", ",", "0", "@", "@", "package", "com", ".", "netflix", ".", "conductor", ".", "validations", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "ConstraintDef", ";", "public", "class", "WorkflowTaskTypeConstraintDef", "extends", "ConstraintDef", "<", "WorkflowTaskTypeConstraintDef", ",", "WorkflowTaskTypeConstraint", ">", "{", "public", "WorkflowTaskTypeConstraintDef", "(", ")", "{", "super", "(", "WorkflowTaskTypeConstraint", ".", "class", ")", ";", "}", "}", "@", "@", "-", "1", ",", "11", "+", "0", ",", "0", "@", "@", "package", "com", ".", "netflix", ".", "conductor", ".", "validations", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "ConstraintDef", ";", "public", "class", "WorkflowTaskValidConstraintDef", "extends", "ConstraintDef", "<", "WorkflowTaskValidConstraintDef", ",", "WorkflowTaskValidConstraint", ">", "{", "public", "WorkflowTaskValidConstraintDef", "(", ")", "{", "super", "(", "WorkflowTaskValidConstraint", ".", "class", ")", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "15", "@", "@", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "?>", "<", "constraint", "-", "mappings", "xmlns", "=", "\"", "http", ":", "//", "jboss", ".", "org", "/", "xml", "/", "ns", "/", "javax", "/", "validation", "/", "mapping", "\"", "xmlns", ":", "xsi", "=", "\"", "http", ":", "//", "www", ".", "w3", ".", "org", "/", "2001", "/", "XMLSchema", "-", "instance", "\"", "xsi", ":", "schemaLocation", "=", "\"", "http", ":", "//", "jboss", ".", "org", "/", "xml", "/", "ns", "/", "javax", "/", "validation", "/", "mapping", "validation", "-", "mapping", "-", "1", ".", "0", ".", "xsd", "\"", ">", "<", "default", "-", "package", ">", "com", ".", "netflix", ".", "conductor", ".", "common", ".", "metadata", ".", "workflow", "<", "/", "default", "-", "package", ">", "<", "bean", "class", "=", "\"", "WorkflowTask", "\"", "ignore", "-", "annotations", "=", "\"", "false", "\"", ">", "<", "class", "ignore", "-", "annotations", "=", "\"", "false", "\"", ">", "<", "constraint", "annotation", "=", "\"", "com", ".", "netflix", ".", "conductor", ".", "validations", ".", "WorkflowTaskTypeConstraint", "\"", "/>", "<", "constraint", "annotation", "=", "\"", "com", ".", "netflix", ".", "conductor", ".", "validations", ".", "WorkflowTaskValidConstraint", "\"", "/>", "<", "/", "class", ">", "<", "/", "bean", ">", "<", "/", "constraint", "-", "mappings", ">", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "15", ",", "45", "+", "15", ",", "42", "@", "@", "*", "/", "package", "com", ".", "netflix", ".", "conductor", ".", "validations", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "mockito", ".", "Matchers", ".", "anyString", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "import", "com", ".", "netflix", ".", "conductor", ".", "common", ".", "metadata", ".", "tasks", ".", "TaskDef", ";", "import", "com", ".", "netflix", ".", "conductor", ".", "common", ".", "metadata", ".", "workflow", ".", "TaskType", ";", "import", "com", ".", "netflix", ".", "conductor", ".", "common", ".", "metadata", ".", "workflow", ".", "WorkflowDef", ";", "import", "com", ".", "netflix", ".", "conductor", ".", "common", ".", "metadata", ".", "workflow", ".", "WorkflowTask", ";", "import", "com", ".", "netflix", ".", "conductor", ".", "core", ".", "config", ".", "ValidationModule", ";", "import", "com", ".", "netflix", ".", "conductor", ".", "dao", ".", "MetadataDAO", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "mockito", ".", "Mockito", ";", "import", "javax", ".", "validation", ".", "ConstraintViolation", ";", "import", "javax", ".", "validation", ".", "Validation", ";", "import", "javax", ".", "validation", ".", "Validator", ";", "import", "javax", ".", "validation", ".", "ValidatorFactory", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "javax", ".", "validation", ".", "ConstraintViolation", ";", "import", "javax", ".", "validation", ".", "Validation", ";", "import", "javax", ".", "validation", ".", "Validator", ";", "import", "javax", ".", "validation", ".", "ValidatorFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "HibernateValidator", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "HibernateValidatorConfiguration", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "mockito", ".", "Mockito", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "mockito", ".", "Matchers", ".", "anyString", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "public", "class", "WorkflowDefConstraintTest", "{", "private", "Validator", "validator", ";", "private", "MetadataDAO", "mockMetadataDao", ";", "private", "HibernateValidatorConfiguration", "config", ";", "@", "Before", "public", "void", "init", "(", ")", "{", "ValidatorFactory", "vf", "=", "Validation", ".", "buildDefaultValidatorFactory", "(", ");", "validator", "=", "vf", ".", "getValidator", "(", ");", "validator", "=", "new", "ValidationModule", "(", ").", "getValidator", "(", ");", "mockMetadataDao", "=", "Mockito", ".", "mock", "(", "MetadataDAO", ".", "class", ")", ";", "when", "(", "mockMetadataDao", ".", "getTaskDef", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "TaskDef", "(", "))", ";", "ValidationContext", ".", "initialize", "(", "mockMetadataDao", ")", ";", "config", "=", "Validation", ".", "byProvider", "(", "HibernateValidator", ".", "class", ")", ".", "configure", "(", ");", "}", "@", "Test", "@", "@", "-", "4", ",", "48", "+", "4", ",", "47", "@", "@", "import", "com", ".", "netflix", ".", "conductor", ".", "common", ".", "metadata", ".", "workflow", ".", "SubWorkflowParams", ";", "import", "com", ".", "netflix", ".", "conductor", ".", "common", ".", "metadata", ".", "workflow", ".", "TaskType", ";", "import", "com", ".", "netflix", ".", "conductor", ".", "common", ".", "metadata", ".", "workflow", ".", "WorkflowTask", ";", "import", "com", ".", "netflix", ".", "conductor", ".", "core", ".", "config", ".", "ValidationModule", ";", "import", "com", ".", "netflix", ".", "conductor", ".", "core", ".", "execution", ".", "tasks", ".", "Terminate", ";", "import", "com", ".", "netflix", ".", "conductor", ".", "dao", ".", "MetadataDAO", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "HibernateValidator", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "HibernateValidatorConfiguration", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "ConstraintMapping", ";", "import", "org", ".", "junit", ".", "Assert", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "mockito", ".", "Mockito", ";", "import", "javax", ".", "validation", ".", "ConstraintViolation", ";", "import", "javax", ".", "validation", ".", "Validation", ";", "import", "javax", ".", "validation", ".", "Validator", ";", "import", "javax", ".", "validation", ".", "ValidatorFactory", ";", "import", "javax", ".", "validation", ".", "executable", ".", "ExecutableValidator", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "util", ".", "*;", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "mockito", ".", "ArgumentMatchers", ".", "anyString", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "public", "class", "WorkflowTaskTypeConstraintTest", "{", "private", "static", "Validator", "validator", ";", "private", "MetadataDAO", "mockMetadataDao", ";", "private", "HibernateValidatorConfiguration", "config", ";", "@", "Before", "public", "void", "init", "(", ")", "{", "ValidatorFactory", "vf", "=", "Validation", ".", "buildDefaultValidatorFactory", "(", ");", "validator", "=", "vf", ".", "getValidator", "(", ");", "validator", "=", "new", "ValidationModule", "(", ").", "getValidator", "(", ");", "mockMetadataDao", "=", "Mockito", ".", "mock", "(", "MetadataDAO", ".", "class", ")", ";", "ValidationContext", ".", "initialize", "(", "mockMetadataDao", ")", ";", "config", "=", "Validation", ".", "byProvider", "(", "HibernateValidator", ".", "class", ")", ".", "configure", "(", ");", "}", "@", "Test", "public", "void", "testWorkflowTaskMissingReferenceName", "(", ")", "{", "WorkflowTask", "workflowTask", "=", "createSampleWorkflowTask", "(", ");", "workflowTask", ".", "setDynamicForkTasksParam", "(", "\"", "taskList", "\"", ");", "workflowTask", ".", "setDynamicForkTasksInputParamName", "(", "\"", "ForkTaskInputParam", "\"", ");", "workflowTask", ".", "setTaskReferenceName", "(", "null", ")", ";", "Set", "<", "ConstraintViolation", "<", "Object", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "@", "@", "-", "74", ",", "15", "+", "73", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeEvent", "(", ")", "{", "WorkflowTask", "workflowTask", "=", "createSampleWorkflowTask", "(", ");", "workflowTask", ".", "setType", "(", "\"", "EVENT", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "when", "(", "mockMetadataDao", ".", "getTaskDef", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "TaskDef", "(", "))", ";", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "@", "@", "-", "96", ",", "15", "+", "86", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeDynamic", "(", ")", "{", "WorkflowTask", "workflowTask", "=", "createSampleWorkflowTask", "(", ");", "workflowTask", ".", "setType", "(", "\"", "DYNAMIC", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "when", "(", "mockMetadataDao", ".", "getTaskDef", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "TaskDef", "(", "))", ";", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "@", "@", "-", "117", ",", "15", "+", "98", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeDecision", "(", ")", "{", "WorkflowTask", "workflowTask", "=", "createSampleWorkflowTask", "(", ");", "workflowTask", ".", "setType", "(", "\"", "DECISION", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "when", "(", "mockMetadataDao", ".", "getTaskDef", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "TaskDef", "(", "))", ";", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "@", "@", "-", "144", ",", "15", "+", "116", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeDoWhile", "(", ")", "{", "WorkflowTask", "workflowTask", "=", "createSampleWorkflowTask", "(", ");", "workflowTask", ".", "setType", "(", "\"", "DO_WHILE", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "when", "(", "mockMetadataDao", ".", "getTaskDef", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "TaskDef", "(", "))", ";", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "@", "@", "-", "175", ",", "15", "+", "138", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeDoWhileWithSubWorkflow", "(", ")", "{", "workflowTask2", ".", "setType", "(", "\"", "SUB_WORKFLOW", "\"", ");", "workflowTask", ".", "setLoopOver", "(", "Arrays", ".", "asList", "(", "workflowTask2", ")", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "when", "(", "mockMetadataDao", ".", "getTaskDef", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "TaskDef", "(", "))", ";", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "@", "@", "-", "202", ",", "15", "+", "156", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeDecisionWithCaseParam", "(", ")", "{", "workflowTask", ".", "setType", "(", "\"", "DECISION", "\"", ");", "workflowTask", ".", "setCaseExpression", "(", "\"$", ".", "valueCheck", "=", "=", "null", "?", "'", "true", "'", ":", "'", "false", "'", "\")", ";", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "when", "(", "mockMetadataDao", ".", "getTaskDef", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "TaskDef", "(", "))", ";", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "@", "@", "-", "228", ",", "15", "+", "173", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeForJoinDynamic", "(", ")", "{", "WorkflowTask", "workflowTask", "=", "createSampleWorkflowTask", "(", ");", "workflowTask", ".", "setType", "(", "\"", "FORK_JOIN_DYNAMIC", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "when", "(", "mockMetadataDao", ".", "getTaskDef", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "TaskDef", "(", "))", ";", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "@", "@", "-", "256", ",", "15", "+", "192", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeForJoinDynamicLegacy", "(", ")", "{", "workflowTask", ".", "setType", "(", "\"", "FORK_JOIN_DYNAMIC", "\"", ");", "workflowTask", ".", "setDynamicForkJoinTasksParam", "(", "\"", "taskList", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "when", "(", "mockMetadataDao", ".", "getTaskDef", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "TaskDef", "(", "))", ";", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "@", "@", "-", "278", ",", "15", "+", "205", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeForJoinDynamicWithForJoinTaskParam", "(", ")", "{", "workflowTask", ".", "setDynamicForkJoinTasksParam", "(", "\"", "taskList", "\"", ");", "workflowTask", ".", "setDynamicForkTasksInputParamName", "(", "\"", "ForkTaskInputParam", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "when", "(", "mockMetadataDao", ".", "getTaskDef", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "TaskDef", "(", "))", ";", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "@", "@", "-", "306", ",", "15", "+", "224", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeForJoinDynamicValid", "(", ")", "{", "workflowTask", ".", "setDynamicForkTasksParam", "(", "\"", "ForkTasksParam", "\"", ");", "workflowTask", ".", "setDynamicForkTasksInputParamName", "(", "\"", "ForkTaskInputParam", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "when", "(", "mockMetadataDao", ".", "getTaskDef", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "TaskDef", "(", "))", ";", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "@", "@", "-", "329", ",", "15", "+", "238", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeForJoinDynamicWithForJoinTaskParamAndInputTaskPa", "workflowTask", ".", "setDynamicForkTasksInputParamName", "(", "\"", "ForkTaskInputParam", "\"", ");", "workflowTask", ".", "setDynamicForkTasksParam", "(", "\"", "ForkTasksParam", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "when", "(", "mockMetadataDao", ".", "getTaskDef", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "TaskDef", "(", "))", ";", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "@", "@", "-", "356", ",", "15", "+", "256", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeHTTP", "(", ")", "{", "workflowTask", ".", "setType", "(", "\"", "HTTP", "\"", ");", "workflowTask", ".", "getInputParameters", "(", ").", "put", "(", "\"", "http_request", "\"", ",", "\"", "http", ":", "//", "www", ".", "netflix", ".", "com", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "when", "(", "mockMetadataDao", ".", "getTaskDef", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "TaskDef", "(", "))", ";", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "@", "@", "-", "376", ",", "15", "+", "267", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeHTTPWithHttpParamMissing", "(", ")", "{", "WorkflowTask", "workflowTask", "=", "createSampleWorkflowTask", "(", ");", "workflowTask", ".", "setType", "(", "\"", "HTTP", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "when", "(", "mockMetadataDao", ".", "getTaskDef", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "TaskDef", "(", "))", ";", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "@", "@", "-", "402", ",", "15", "+", "284", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeHTTPWithHttpParamInTaskDef", "(", ")", "{", "WorkflowTask", "workflowTask", "=", "createSampleWorkflowTask", "(", ");", "workflowTask", ".", "setType", "(", "\"", "HTTP", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "TaskDef", "taskDef", "=", "new", "TaskDef", "(", ");", "taskDef", ".", "setName", "(", "\"", "encode", "\"", ");", "taskDef", ".", "getInputTemplate", "(", ").", "put", "(", "\"", "http_request", "\"", ",", "\"", "http", ":", "//", "www", ".", "netflix", ".", "com", "\"", ");", "@", "@", "-", "428", ",", "15", "+", "301", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeHTTPWithHttpParamInTaskDefAndWorkflowTask", "(", ")", "{", "workflowTask", ".", "setType", "(", "\"", "HTTP", "\"", ");", "workflowTask", ".", "getInputParameters", "(", ").", "put", "(", "\"", "http_request", "\"", ",", "\"", "http", ":", "//", "www", ".", "netflix", ".", "com", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "TaskDef", "taskDef", "=", "new", "TaskDef", "(", ");", "taskDef", ".", "setName", "(", "\"", "encode", "\"", ");", "taskDef", ".", "getInputTemplate", "(", ").", "put", "(", "\"", "http_request", "\"", ",", "\"", "http", ":", "//", "www", ".", "netflix", ".", "com", "\"", ");", "@", "@", "-", "452", ",", "15", "+", "316", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeFork", "(", ")", "{", "WorkflowTask", "workflowTask", "=", "createSampleWorkflowTask", "(", ");", "workflowTask", ".", "setType", "(", "\"", "FORK_JOIN", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "when", "(", "mockMetadataDao", ".", "getTaskDef", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "TaskDef", "(", "))", ";", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "@", "@", "-", "554", ",", "15", "+", "409", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeKafkaPublish", "(", ")", "{", "workflowTask", ".", "setType", "(", "\"", "KAFKA_PUBLISH", "\"", ");", "workflowTask", ".", "getInputParameters", "(", ").", "put", "(", "\"", "kafka_request", "\"", ",", "\"", "testInput", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "when", "(", "mockMetadataDao", ".", "getTaskDef", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "TaskDef", "(", "))", ";", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "@", "@", "-", "574", ",", "15", "+", "420", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeKafkaPublishWithRequestParamMissing", "(", ")", "{", "WorkflowTask", "workflowTask", "=", "createSampleWorkflowTask", "(", ");", "workflowTask", ".", "setType", "(", "\"", "KAFKA_PUBLISH", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "when", "(", "mockMetadataDao", ".", "getTaskDef", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "TaskDef", "(", "))", ";", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "@", "@", "-", "600", ",", "15", "+", "437", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeKafkaPublishWithKafkaParamInTaskDef", "(", ")", "{", "WorkflowTask", "workflowTask", "=", "createSampleWorkflowTask", "(", ");", "workflowTask", ".", "setType", "(", "\"", "KAFKA_PUBLISH", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "TaskDef", "taskDef", "=", "new", "TaskDef", "(", ");", "taskDef", ".", "setName", "(", "\"", "encode", "\"", ");", "taskDef", ".", "getInputTemplate", "(", ").", "put", "(", "\"", "kafka_request", "\"", ",", "\"", "test_kafka_request", "\"", ");", "@", "@", "-", "626", ",", "15", "+", "454", ",", "6", "@", "@", "public", "void", "testWorkflowTaskTypeKafkaPublioshWithRequestParamInTaskDefAndWorkflo", "workflowTask", ".", "setType", "(", "\"", "KAFKA_PUBLISH", "\"", ");", "workflowTask", ".", "getInputParameters", "(", ").", "put", "(", "\"", "kafka_request", "\"", ",", "\"", "http", ":", "//", "www", ".", "netflix", ".", "com", "\"", ");", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "Validator", "validator", "=", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "TaskDef", "taskDef", "=", "new", "TaskDef", "(", ");", "taskDef", ".", "setName", "(", "\"", "encode", "\"", ");", "taskDef", ".", "getInputTemplate", "(", ").", "put", "(", "\"", "kafka_request", "\"", ",", "\"", "test", "Kafka", "Request", "\"", ");", "@", "@", "-", "646", ",", "22", "+", "465", ",", "13", "@", "@", "public", "void", "testWorkflowTaskTypeKafkaPublioshWithRequestParamInTaskDefAndWorkflo", "}", "private", "List", "<", "String", ">", "getErrorMessages", "(", "WorkflowTask", "workflowTask", ")", "{", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "buildValidator", "(", ").", "validate", "(", "workflowTask", ")", ";", "Set", "<", "ConstraintViolation", "<", "WorkflowTask", ">", ">", "result", "=", "validator", ".", "validate", "(", "workflowTask", ")", ";", "List", "<", "String", ">", "validationErrors", "=", "new", "ArrayList", "<", ">(", ");", "result", ".", "forEach", "(", "e", "-", ">", "validationErrors", ".", "add", "(", "e", ".", "getMessage", "(", "))", ");", "return", "validationErrors", ";", "}", "private", "Validator", "buildValidator", "(", ")", "{", "ConstraintMapping", "mapping", "=", "config", ".", "createConstraintMapping", "(", ");", "mapping", ".", "type", "(", "WorkflowTask", ".", "class", ")", ".", "constraint", "(", "new", "WorkflowTaskTypeConstraintDef", "(", "))", ";", "return", "config", ".", "addMapping", "(", "mapping", ")", ".", "buildValidatorFactory", "(", ")", ".", "getValidator", "(", ");", "}", "private", "WorkflowTask", "createSampleWorkflowTask", "(", ")", "{", "WorkflowTask", "workflowTask", "=", "new", "WorkflowTask", "(", ");", "workflowTask", ".", "setName", "(", "\"", "encode", "\"", ");", "@", "@", "-", "8", ",", "7", "+", "8", ",", "8", "@", "@", "dependencies", "{", "compile", "\"", "javax", ".", "ws", ".", "rs", ":", "jsr311", "-", "api", ":", "${", "revJsr311Api", "}", "\"", "compile", "\"", "io", ".", "swagger", ":", "swagger", "-", "jaxrs", ":", "${", "revSwagger", "}", "\"", "compile", "\"", "com", ".", "sun", ".", "jersey", ":", "jersey", "-", "bundle", ":", "${", "revJerseyBundle", "}", "\"", "compile", "\"", "org", ".", "hibernate", ":", "hibernate", "-", "validator", ":", "${", "revHiberante", "}", "\"", "compile", "\"", "org", ".", "apache", ".", "bval", ":", "bval", "-", "jsr", ":", "${", "revBval", "}", "\"", "compile", "\"", "javax", ".", "validation", ":", "validation", "-", "api", ":", "${", "revValidationApi", "}", "\"", "compileOnly", "\"", "javax", ".", "servlet", ":", "javax", ".", "servlet", "-", "api", ":", "${", "revServletApi", "}", "\"", "}", "@", "@", "-", "22", ",", "11", "+", "22", ",", "12", "@", "@", "ext", "{", "revGuiceMultiBindings", "=", "'", "4", ".", "1", ".", "0", "'", "revGuiceServlet", "=", "'", "4", ".", "1", ".", "0", "'", "revHealth", "=", "'", "1", ".", "1", ".", "+'", "revHiberante", "=", "'", "6", ".", "0", ".", "13", ".", "Final", "'", "revHikariCP", "=", "'", "3", ".", "2", ".", "0", "'", "revJsonPath", "=", "'", "2", ".", "2", ".", "0", "'", "revJaxrsJackson", "=", "'", "2", ".", "10", ".", "0", "'", "revJavaElApi", "=", "'", "3", ".", "0", ".", "0", "'", "revBval", "=", "'", "2", ".", "0", ".", "3", "'", "revValidationApi", "=", "'", "2", ".", "0", ".", "1", ".", "Final", "'", "revJavaxInject", "=", "'", "1", "'", "revJacksonCore", "=", "'", "2", ".", "10", ".", "0", "'", "revJacksonDatabind", "=", "'", "2", ".", "10", ".", "0", "'"], "docstring_tokens": ["sending", "a", "specially", "crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "15", ",", "11", "+", "15", ",", "11", "@", "@", "*", "In", "practice", "this", "is", "far", "bigger", "than", "any", "realistic", "pointer", "offset", ";", "this", "limit", "*", "ensures", "that", "umax_value", "+", "(", "int", ")", "off", "+", "(", "int", ")", "size", "cannot", "overflow", "a", "u64", ".", "*", "/", "#", "define", "BPF_MAX_VAR_OFF", "(", "1ULL", "<", "<", "31", ")", "#", "define", "BPF_MAX_VAR_OFF", "(", "1", "<", "<", "29", ")", "/", "*", "Maximum", "variable", "size", "permitted", "for", "ARG_CONST_SIZE", "[", "_OR_ZERO", "]", ".", "This", "ensures", "*", "that", "converting", "umax_value", "to", "int", "cannot", "overflow", ".", "*", "/", "#", "define", "BPF_MAX_VAR_SIZ", "INT_MAX", "#", "define", "BPF_MAX_VAR_SIZ", "(", "1", "<", "<", "29", ")", "/", "*", "Liveness", "marks", ",", "used", "for", "registers", "and", "spilled", "-", "regs", "(", "in", "stack", "slots", ")", ".", "*", "Read", "marks", "propagate", "upwards", "until", "they", "find", "a", "write", "mark", ";", "they", "record", "that", "@", "@", "-", "1819", ",", "6", "+", "1819", ",", "41", "@", "@", "static", "bool", "signed_sub_overflows", "(", "s64", "a", ",", "s64", "b", ")", "return", "res", ">", "a", ";", "}", "static", "bool", "check_reg_sane_offset", "(", "struct", "bpf_verifier_env", "*", "env", ",", "const", "struct", "bpf_reg_state", "*", "reg", ",", "enum", "bpf_reg_type", "type", ")", "{", "bool", "known", "=", "tnum_is_const", "(", "reg", "-", ">", "var_off", ")", ";", "s64", "val", "=", "reg", "-", ">", "var_off", ".", "value", ";", "s64", "smin", "=", "reg", "-", ">", "smin_value", ";", "if", "(", "known", "&", "&", "(", "val", ">", "=", "BPF_MAX_VAR_OFF", "|", "|", "val", "<", "=", "-", "BPF_MAX_VAR_OFF", ")", ")", "{", "verbose", "(", "env", ",", "\"", "math", "between", "%", "s", "pointer", "and", "%", "lld", "is", "not", "allowed", "\\", "n", "\"", ",", "reg_type_str", "[", "type", "]", ",", "val", ")", ";", "return", "false", ";", "}", "if", "(", "reg", "-", ">", "off", ">", "=", "BPF_MAX_VAR_OFF", "|", "|", "reg", "-", ">", "off", "<", "=", "-", "BPF_MAX_VAR_OFF", ")", "{", "verbose", "(", "env", ",", "\"", "%", "s", "pointer", "offset", "%", "d", "is", "not", "allowed", "\\", "n", "\"", ",", "reg_type_str", "[", "type", "]", ",", "reg", "-", ">", "off", ")", ";", "return", "false", ";", "}", "if", "(", "smin", "=", "=", "S64_MIN", ")", "{", "verbose", "(", "env", ",", "\"", "math", "between", "%", "s", "pointer", "and", "register", "with", "unbounded", "min", "value", "is", "not", "allowed", "\\", "n", "\"", ",", "reg_type_str", "[", "type", "]", ");", "return", "false", ";", "}", "if", "(", "smin", ">", "=", "BPF_MAX_VAR_OFF", "|", "|", "smin", "<", "=", "-", "BPF_MAX_VAR_OFF", ")", "{", "verbose", "(", "env", ",", "\"", "value", "%", "lld", "makes", "%", "s", "pointer", "be", "out", "of", "bounds", "\\", "n", "\"", ",", "smin", ",", "reg_type_str", "[", "type", "]", ");", "return", "false", ";", "}", "return", "true", ";", "}", "/", "*", "Handles", "arithmetic", "on", "a", "pointer", "and", "a", "scalar", ":", "computes", "new", "min", "/", "max", "and", "var_off", ".", "*", "Caller", "should", "also", "handle", "BPF_MOV", "case", "separately", ".", "*", "If", "we", "return", "-", "EACCES", ",", "caller", "may", "want", "to", "try", "again", "treating", "pointer", "as", "a", "@", "@", "-", "1887", ",", "6", "+", "1922", ",", "10", "@", "@", "static", "int", "adjust_ptr_min_max_vals", "(", "struct", "bpf_verifier_env", "*", "env", ",", "dst_reg", "-", ">", "type", "=", "ptr_reg", "-", ">", "type", ";", "dst_reg", "-", ">", "id", "=", "ptr_reg", "-", ">", "id", ";", "if", "(", "!", "check_reg_sane_offset", "(", "env", ",", "off_reg", ",", "ptr_reg", "-", ">", "type", ")", "|", "|", "!", "check_reg_sane_offset", "(", "env", ",", "ptr_reg", ",", "ptr_reg", "-", ">", "type", ")", ")", "return", "-", "EINVAL", ";", "switch", "(", "opcode", ")", "{", "case", "BPF_ADD", ":", "/", "*", "We", "can", "take", "a", "fixed", "offset", "as", "long", "as", "it", "doesn", "'", "t", "overflow", "@", "@", "-", "2017", ",", "6", "+", "2056", ",", "9", "@", "@", "static", "int", "adjust_ptr_min_max_vals", "(", "struct", "bpf_verifier_env", "*", "env", ",", "return", "-", "EACCES", ";", "}", "if", "(", "!", "check_reg_sane_offset", "(", "env", ",", "dst_reg", ",", "ptr_reg", "-", ">", "type", ")", ")", "return", "-", "EINVAL", ";", "__update_reg_bounds", "(", "dst_reg", ")", ";", "__reg_deduce_bounds", "(", "dst_reg", ")", ";", "__reg_bound_offset", "(", "dst_reg", ")", ";", "@", "@", "-", "2046", ",", "6", "+", "2088", ",", "12", "@", "@", "static", "int", "adjust_scalar_min_max_vals", "(", "struct", "bpf_verifier_env", "*", "env", ",", "src_known", "=", "tnum_is_const", "(", "src_reg", ".", "var_off", ")", ";", "dst_known", "=", "tnum_is_const", "(", "dst_reg", "-", ">", "var_off", ")", ";", "if", "(", "!", "src_known", "&", "&", "opcode", "!", "=", "BPF_ADD", "&", "&", "opcode", "!", "=", "BPF_SUB", "&", "&", "opcode", "!", "=", "BPF_AND", ")", "{", "__mark_reg_unknown", "(", "dst_reg", ")", ";", "return", "0", ";", "}", "switch", "(", "opcode", ")", "{", "case", "BPF_ADD", ":", "if", "(", "signed_add_overflows", "(", "dst_reg", "-", ">", "smin_value", ",", "smin_val", ")", "|", "|"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "21", ",", "6", "+", "21", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "activemq", ".", "broker", ".", "BrokerFactoryHandler", ";", "import", "org", ".", "apache", ".", "activemq", ".", "broker", ".", "BrokerPlugin", ";", "import", "org", ".", "apache", ".", "activemq", ".", "broker", ".", "BrokerService", ";", "import", "org", ".", "apache", ".", "activemq", ".", "broker", ".", "jmx", ".", "ManagementContext", ";", "import", "org", ".", "apache", ".", "activemq", ".", "network", ".", "DiscoveryNetworkConnector", ";", "import", "org", ".", "apache", ".", "activemq", ".", "network", ".", "NetworkConnector", ";", "import", "org", ".", "apache", ".", "activemq", ".", "ra", ".", "ActiveMQResourceAdapter", ";", "@", "@", "-", "185", ",", "6", "+", "186", ",", "10", "@", "@", "public", "synchronized", "BrokerService", "createBroker", "(", "final", "URI", "brokerURI", ")", "throws", "Excep", "broker", ".", "setStartAsync", "(", "false", ")", ";", "final", "ManagementContext", "managementContext", "=", "new", "ManagementContext", "(", ");", "managementContext", ".", "setCreateConnector", "(", "false", ")", ";", "broker", ".", "setManagementContext", "(", "managementContext", ")", ";", "final", "BrokerService", "bs", "=", "broker", ";", "final", "Thread", "start", "=", "new", "Thread", "(", "\"", "ActiveMQFactory", "start", "and", "checkpoint", "\"", ")", "{", "@", "@", "-", "170", ",", "7", "+", "170", ",", "7", "@", "@", "<", "commons", "-", "net", ".", "version", ">", "3", ".", "3", "<", "/", "commons", "-", "net", ".", "version", ">", "<", "bval", ".", "version", ">", "1", ".", "1", ".", "2", "<", "/", "bval", ".", "version", ">", "<", "org", ".", "apache", ".", "activemq", ".", "version", ">", "5", ".", "15", ".", "10", "<", "/", "org", ".", "apache", ".", "activemq", ".", "version", ">", "<", "org", ".", "apache", ".", "activemq", ".", "version", ">", "5", ".", "15", ".", "12", "<", "/", "org", ".", "apache", ".", "activemq", ".", "version", ">", "<", "org", ".", "springframework", ".", "version", ">", "3", ".", "1", ".", "4", ".", "RELEASE", "<", "/", "org", ".", "springframework", ".", "version", ">", "<", "junit", ".", "version", ">", "4", ".", "12", "<", "/", "junit", ".", "version", ">", "<", "org", ".", "apache", ".", "axis2", ".", "version", ">", "1", ".", "4", ".", "1", "<", "/", "org", ".", "apache", ".", "axis2", ".", "version", ">"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "447", ",", "8", "+", "447", ",", "10", "@", "@", "static", "void", "icmp6_send", "(", "struct", "sk_buff", "*", "skb", ",", "u8", "type", ",", "u8", "code", ",", "__u32", "info", ",", "if", "(", "__ipv6_addr_needs_scope_id", "(", "addr_type", ")", ")", "iif", "=", "skb", "-", ">", "dev", "-", ">", "ifindex", ";", "else", "iif", "=", "l3mdev_master_ifindex", "(", "skb_dst", "(", "skb", ")", "->", "dev", ")", ";", "else", "{", "dst", "=", "skb_dst", "(", "skb", ")", ";", "iif", "=", "l3mdev_master_ifindex", "(", "dst", "?", "dst", "-", ">", "dev", ":", "skb", "-", ">", "dev", ")", ";", "}", "/", "*", "*", "Must", "not", "send", "error", "if", "the", "source", "does", "not", "uniquely"], "docstring_tokens": ["the", "internet"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "27", ",", "10", "+", "27", ",", "12", "@", "@", "private", "CrestEndpointFactory", "(", ")", "{", "/", "**", "*", "Constructs", "a", "new", "CRest", "endpoint", ",", "caches", "it", "and", "returns", "it", "for", "use", ".", "*", "*", "@", "param", "url", "*", "@", "param", "username", "*", "@", "param", "password", "*", "@", "return", "*", "@", "param", "url", "url", "*", "@", "param", "username", "user", "name", "*", "@", "param", "password", "password", "*", "@", "param", "endpointClass", "endpoint", "class", "*", "@", "param", "<", "T", ">", "type", "*", "@", "return", "endpoint", "*", "/", "public", "<", "T", ">", "T", "getEndpoint", "(", "String", "url", ",", "String", "username", ",", "String", "password", ",", "Class", "<", "T", ">", "endpointClass", ")", "{", "T", "endpoint", ";", "@", "@", "-", "50", ",", "15", "+", "52", ",", "15", "@", "@", "private", "CrestEndpointFactory", "(", ")", "{", "*", "Returns", "an", "endpoint", "to", "Testlab", ".", "*", "*", "If", "onpremiseUrl", "is", "set", "it", "used", "as", "a", "base", "url", ".", "It", "not", ",", "this", "methods", "peeks", "for", "*", "TESTLAB_", "<", "companyid", "in", "upper", "case", ">", "system", "environment", "variable", "for", "testlab", "api", "address", ".", "*", "TESTLAB_", "&", "lt", ";", "companyid", "in", "upper", "case", "&", "gt", ";", "system", "environment", "variable", "for", "testlab", "api", "address", ".", "*", "If", "none", "is", "set", "a", "default", "of", "https", ":", "//", "companyid", ".", "melioratestlab", ".", "com", "/", "api", "is", "used", ".", "*", "*", "@", "param", "companyId", "*", "@", "parma", "onpremiseUrl", "*", "@", "param", "apiKey", "*", "@", "param", "endpointClass", "*", "@", "param", "<", "T", ">", "*", "@", "return", "*", "@", "param", "companyId", "company", "id", "*", "@", "param", "onpremiseUrl", "onpremise", "url", "*", "@", "param", "apiKey", "api", "key", "*", "@", "param", "endpointClass", "endpoint", "class", "*", "@", "param", "<", "T", ">", "type", "*", "@", "return", "endpoint", "*", "/", "public", "<", "T", ">", "T", "getTestlabEndpoint", "(", "String", "companyId", ",", "String", "onpremiseUrl", ",", "String", "apiKey", ",", "Class", "<", "T", ">", "endpointClass", ")", "{", "String", "url", ";", "@", "@", "-", "1", ",", "7", "+", "1", ",", "6", "@", "@", "package", "fi", ".", "meliora", ".", "testlab", ".", "ext", ".", "crest", ";", "import", "fi", ".", "meliora", ".", "testlab", ".", "ext", ".", "crest", ".", "exception", ".", "NotFoundException", ";", "import", "fi", ".", "meliora", ".", "testlab", ".", "ext", ".", "crest", ".", "exception", ".", "TestlabAPIException", ";", "import", "fi", ".", "meliora", ".", "testlab", ".", "ext", ".", "crest", ".", "exception", ".", "*;", "import", "org", ".", "codegist", ".", "crest", ".", "io", ".", "Request", ";", "import", "org", ".", "codegist", ".", "crest", ".", "io", ".", "RequestException", ";", "import", "org", ".", "codegist", ".", "crest", ".", "io", ".", "Response", ";", "@", "@", "-", "12", ",", "7", "+", "11", ",", "7", "@", "@", "import", "java", ".", "util", ".", "Scanner", ";", "/", "**", "*", "Our", "Testlab", "api", "call", "error", "handler", ".", "*", "Our", "Testlab", "API", "call", "error", "handler", ".", "*", "*", "@", "author", "Marko", "Kanala", "*", "/", "@", "@", "-", "22", ",", "32", "+", "21", ",", "12", "@", "@", "@", "Override", "public", "<", "T", ">", "T", "handle", "(", "Request", "request", ",", "Exception", "e", ")", "throws", "Exception", "{", "if", "(", "e", "instanceof", "RequestException", ")", "{", "/", "/", "if", "we", "have", "a", "http", "response", "from", "testlab", "just", "log", "the", "error", "RequestException", "re", "=", "(", "RequestException", ")", "e", ";", "Response", "testlabResponse", "=", "re", ".", "getResponse", "(", ");", "if", "(", "testlabResponse", "!", "=", "null", ")", "{", "/", "/", "read", "response", "String", "responseData", "=", "null", ";", "/", "/", "try", "to", "read", "error", "InputStream", "is", "=", "null", ";", "try", "{", "is", "=", "testlabResponse", ".", "asStream", "(", ");", "if", "(", "is", "!", "=", "null", ")", "{", "String", "charset", "=", "testlabResponse", ".", "getCharset", "(", ")", "!", "=", "null", "?", "testlabResponse", ".", "getCharset", "(", ").", "name", "(", ")", ":", "\"", "UTF", "-", "8", "\"", ";", "Scanner", "s", "=", "new", "Scanner", "(", "is", ",", "charset", ")", ".", "useDelimiter", "(", "\"\\", "\\", "A", "\"", ");", "if", "(", "s", ".", "hasNext", "(", "))", "responseData", "=", "s", ".", "next", "(", ");", "}", "if", "(", "responseData", "!", "=", "null", "&", "&", "responseData", ".", "length", "(", ")", ">", "400", ")", "responseData", "=", "responseData", ".", "substring", "(", "0", ",", "400", ")", "+", "\"", "..", ".\"", ";", "}", "catch", "(", "Exception", "ee", ")", "{", "/", "/", ".", "..", "}", "finally", "{", "if", "(", "is", "!", "=", "null", ")", "try", "{", "is", ".", "close", "(", ");", "}", "catch", "(", "Exception", "eee", ")", "{", "}", "}", "/", "/", "read", "response", ",", "if", "any", "String", "responseData", "=", "getResponseIfAny", "(", "testlabResponse", ")", ";", "if", "(", "log", ".", "isErrorEnabled", "(", "))", "log", ".", "error", "(", "@", "@", "-", "64", ",", "7", "+", "43", ",", "16", "@", "@", "if", "(", "statusCode", "=", "=", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Response", ".", "Status", ".", "NOT_FOUND", ".", "getStatusCode", "(", "))", "{", "/", "/", "call", "returned", "not", "found", "status", "throw", "new", "NotFoundException", "(", "responseData", ")", ";", "}", "else", "if", "(", "statusCode", "=", "=", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Response", ".", "Status", ".", "CONFLICT", ".", "getStatusCode", "(", "))", "{", "throw", "new", "ConflictException", "(", "responseData", ")", ";", "}", "else", "if", "(", "statusCode", "=", "=", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Response", ".", "Status", ".", "SERVICE_UNAVAILABLE", ".", "getStatusCode", "(", "))", "{", "throw", "new", "ServiceUnavailableException", "(", "responseData", ")", ";", "}", "else", "if", "(", "statusCode", "=", "=", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Response", ".", "Status", ".", "UNAUTHORIZED", ".", "getStatusCode", "(", "))", "{", "throw", "new", "UnauthorizedException", "(", "responseData", ")", ";", "}", "else", "if", "(", "statusCode", "=", "=", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Response", ".", "Status", ".", "BAD_REQUEST", ".", "getStatusCode", "(", "))", "{", "throw", "new", "ValidationException", "(", "responseData", ")", ";", "}", "if", "(", "responseData", "!", "=", "null", "&", "&", "responseData", ".", "length", "(", ")", ">", "0", ")", "{", "throw", "new", "TestlabAPIException", "(", "responseData", ")", ";", "}", "@", "@", "-", "80", ",", "4", "+", "68", ",", "27", "@", "@", "throw", "e", ";", "}", "protected", "String", "getResponseIfAny", "(", "Response", "response", ")", "{", "/", "/", "read", "response", "String", "responseData", "=", "null", ";", "InputStream", "is", "=", "null", ";", "try", "{", "is", "=", "response", ".", "asStream", "(", ");", "if", "(", "is", "!", "=", "null", ")", "{", "String", "charset", "=", "response", ".", "getCharset", "(", ")", "!", "=", "null", "?", "response", ".", "getCharset", "(", ").", "name", "(", ")", ":", "\"", "UTF", "-", "8", "\"", ";", "Scanner", "s", "=", "new", "Scanner", "(", "is", ",", "charset", ")", ".", "useDelimiter", "(", "\"\\", "\\", "A", "\"", ");", "if", "(", "s", ".", "hasNext", "(", "))", "responseData", "=", "s", ".", "next", "(", ");", "}", "if", "(", "responseData", "!", "=", "null", "&", "&", "responseData", ".", "length", "(", ")", ">", "400", ")", "responseData", "=", "responseData", ".", "substring", "(", "0", ",", "400", ")", "+", "\"", "..", ".\"", ";", "}", "catch", "(", "Exception", "e", ")", "{", "/", "/", "could", "not", "read", "response", ",", "just", "ignore", "}", "finally", "{", "if", "(", "is", "!", "=", "null", ")", "try", "{", "is", ".", "close", "(", ");", "}", "catch", "(", "Exception", "ee", ")", "{", "}", "}", "return", "responseData", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "14", "@", "@", "package", "fi", ".", "meliora", ".", "testlab", ".", "ext", ".", "crest", ".", "exception", ";", "/", "**", "*", "Thrown", "if", "rest", "endpoint", "sends", "409", "CONFLICT", "response", ".", "*", "*", "@", "author", "Marko", "Kanala", "*", "/", "public", "class", "ConflictException", "extends", "TestlabAPIException", "{", "public", "ConflictException", "(", "Object", "responseData", ")", "{", "super", "(", "responseData", ")", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "15", "@", "@", "package", "fi", ".", "meliora", ".", "testlab", ".", "ext", ".", "crest", ".", "exception", ";", "/", "**", "*", "Thrown", "if", "rest", "endpoint", "sends", "503", "SERVICE", "UNAVAILABLE", "response", ".", "*", "*", "@", "author", "Marko", "Kanala", "*", "/", "public", "class", "ServiceUnavailableException", "extends", "TestlabAPIException", "{", "public", "ServiceUnavailableException", "(", "Object", "responseData", ")", "{", "super", "(", "responseData", ")", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "15", "@", "@", "package", "fi", ".", "meliora", ".", "testlab", ".", "ext", ".", "crest", ".", "exception", ";", "/", "**", "*", "Thrown", "if", "rest", "endpoint", "sends", "401", "UNAUTHORIZED", "response", ".", "*", "*", "@", "author", "Marko", "Kanala", "*", "/", "public", "class", "UnauthorizedException", "extends", "TestlabAPIException", "{", "public", "UnauthorizedException", "(", "Object", "responseData", ")", "{", "super", "(", "responseData", ")", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "15", "@", "@", "package", "fi", ".", "meliora", ".", "testlab", ".", "ext", ".", "crest", ".", "exception", ";", "/", "**", "*", "Thrown", "if", "rest", "endpoint", "sends", "400", "BAD_REQUEST", "response", ".", "*", "*", "@", "author", "Marko", "Kanala", "*", "/", "public", "class", "ValidationException", "extends", "TestlabAPIException", "{", "public", "ValidationException", "(", "Object", "responseData", ")", "{", "super", "(", "responseData", ")", ";", "}", "}", "@", "@", "-", "21", ",", "8", "+", "21", ",", "6", "@", "@", "import", "org", ".", "apache", ".", "commons", ".", "lang", ".", "StringUtils", ";", "import", "org", ".", "apache", ".", "tools", ".", "ant", ".", "DirectoryScanner", ";", "import", "org", ".", "apache", ".", "tools", ".", "ant", ".", "types", ".", "FileSet", ";", "import", "org", ".", "tap4j", ".", "plugin", ".", "TapTestResultAction", ";", "import", "org", ".", "tap4j", ".", "plugin", ".", "model", ".", "TapTestResultResult", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "IOException", ";", "@", "@", "-", "60", ",", "35", "+", "58", ",", "6", "@", "@", "/", "**", "*", "Does", "the", "actual", "sending", "of", "results", "to", "Testlab", ".", "Called", "from", "appropriate", "Jenkins", "extension", "point", ".", "*", "*", "@", "param", "workspace", "*", "@", "param", "companyId", "*", "@", "param", "usingonpremise", "*", "@", "param", "onpremiseurl", "*", "@", "param", "apiKey", "*", "@", "param", "projectKey", "*", "@", "param", "milestone", "*", "@", "param", "testRunTitle", "*", "@", "param", "comment", "*", "@", "param", "testTargetTitle", "*", "@", "param", "testEnvironmentTitle", "*", "@", "param", "tags", "*", "@", "param", "parameters", "*", "@", "param", "addIssues", "*", "@", "param", "mergeAsSingleIssue", "*", "@", "param", "reopenExisting", "*", "@", "param", "assignToUser", "*", "@", "param", "publishTap", "*", "@", "param", "tapTestsAsSteps", ",", "*", "@", "param", "tapFileNameInIdentifier", ",", "*", "@", "param", "tapTestNumberInIdentifier", "*", "@", "param", "importTestCases", "*", "@", "param", "importTestCasesRootCategory", "*", "@", "param", "testCaseMappingField", "*", "@", "param", "publishRobot", "*", "@", "param", "robotOutput", "*", "@", "param", "robotCatenateParentKeywords", "*", "@", "param", "build", "*", "/", "public", "static", "void", "sendResults", "(", "final", "FilePath", "workspace", ",", "String", "companyId", ",", "boolean", "usingonpremise", ",", "String", "onpremiseurl", ",", "String", "apiKey", ",", "String", "projectKey", ",", "String", "milestone", ",", "String", "testRunTitle", ",", "String", "comment", ",", "String", "testTargetTitle", ",", "String", "testEnvironmentTitle", ",", "String", "tags", ",", "@", "@", "-", "117", ",", "7", "+", "86", ",", "7", "@", "@", "public", "static", "void", "sendResults", "(", "final", "FilePath", "workspace", ",", "String", "companyId", ",", "boole", "for", "(", "Action", "a", ":", "build", ".", "getAllActions", "(", "))", "{", "if", "(", "log", ".", "isLoggable", "(", "Level", ".", "FINE", ")", ")", "log", ".", "fine", "(", "\"", "Action", ":", "\"", "+", "a", ")", ";", "if", "(", "hasTAPSupport", "&", "&", "a", "instanceof", "TapTestResultAction", ")", "{", "if", "(", "hasTAPSupport", "&", "&", "a", "instanceof", "org", ".", "tap4j", ".", "plugin", ".", "TapTestResultAction", ")", "{", "ras", ".", "add", "(", "a", ")", ";", "}", "else", "if", "(", "a", "instanceof", "AbstractTestResultAction", ")", "{", "ras", ".", "add", "(", "a", ")", ";", "@", "@", "-", "187", ",", "7", "+", "156", ",", "7", "@", "@", "public", "static", "void", "sendResults", "(", "final", "FilePath", "workspace", ",", "String", "companyId", ",", "boole", "for", "(", "Object", "ra", ":", "ras", ")", "{", "Object", "resultObject", "=", "null", ";", "if", "(", "ra", "instanceof", "TapTestResultAction", ")", "{", "if", "(", "hasTAPSupport", "&", "&", "ra", "instanceof", "org", ".", "tap4j", ".", "plugin", ".", "TapTestResultAction", ")", "{", "try", "{", "/", "/", "due", "to", "2", ".", "1", "change", "in", "tap", "plugin", ",", "try", "to", "keep", "compatibility", "to", "tap", "plugin", "<", "2", ".", "1", "Method", "m", "=", "ra", ".", "getClass", "(", ").", "getMethod", "(", "\"", "getResult", "\"", ");", "@", "@", "-", "294", ",", "7", "+", "263", ",", "7", "@", "@", "else", "if", "(", "cr", ".", "isSkipped", "(", "))", "org", ".", "tap4j", ".", "plugin", ".", "model", ".", "TapStreamResult", "tsr", "=", "(", "org", ".", "tap4j", ".", "plugin", ".", "model", ".", "TapStreamResult", ")", "result", ";", "for", "(", "TestResult", "tr", ":", "tsr", ".", "getChildren", "(", "))", "{", "TapTestResultResult", "r", "=", "(", "TapTestResultResult", ")", "tr", ";", "org", ".", "tap4j", ".", "plugin", ".", "model", ".", "TapTestResultResult", "r", "=", "(", "org", ".", "tap4j", ".", "plugin", ".", "model", ".", "TapTestResultResult", ")", "tr", ";", "/", "/", "see", "https", ":", "//", "testanything", ".", "org", "/", "tap", "-", "specification", ".", "html", "@", "@", "-", "4", ",", "6", "+", "4", ",", "7", "@", "@", "import", "hudson", ".", "model", ".", "*;", "import", "hudson", ".", "tasks", ".", "*;", "import", "hudson", ".", "util", ".", "PluginServletFilter", ";", "import", "hudson", ".", "util", ".", "Secret", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONObject", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "DataBoundConstructor", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "@", "@", "-", "137", ",", "9", "+", "138", ",", "9", "@", "@", "public", "String", "getCompanyId", "(", ")", "{", "}", "/", "/", "job", "specific", "apikey", "of", "target", "testlab", ",", "optional", "private", "String", "apiKey", ";", "private", "Secret", "apiKey", ";", "public", "String", "getApiKey", "(", ")", "{", "public", "Secret", "getApiKey", "(", ")", "{", "return", "apiKey", ";", "}", "@", "@", "-", "298", ",", "7", "+", "299", ",", "6", "@", "@", "public", "TestlabNotifier", "(", "String", "projectKey", ",", "String", "testRunTitle", ",", "String", "comment", ",", "S", "*", "When", "{", "@", "link", "hudson", ".", "tasks", ".", "Publisher", "}", "behaves", "this", "way", ",", "note", "that", "they", "can", "no", "longer", "*", "change", "the", "build", "status", "anymore", ".", "*", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "@", "since", "1", ".", "153", "*", "/", "@", "Override", "@", "@", "-", "329", ",", "7", "+", "329", ",", "7", "@", "@", "public", "BuildStepMonitor", "getRequiredMonitorService", "(", ")", "{", "*", "@", "param", "build", "*", "@", "param", "launcher", "*", "@", "param", "listener", "*", "@", "return", "*", "@", "return", "boolean", "*", "@", "throws", "InterruptedException", "*", "@", "throws", "IOException", "*", "/", "@", "@", "-", "342", ",", "7", "+", "342", ",", "12", "@", "@", "public", "boolean", "perform", "(", "AbstractBuild", "<", "?,", "?", ">", "build", ",", "Launcher", "launcher", ",", "BuildListen", "log", ".", "fine", "(", "\"", "perform", "(", "):", "\"", "+", "this", "+", "\"", ",", "descriptor", ":", "\"", "+", "d", ")", ";", "/", "/", "get", "job", "specific", "settings", "if", "any", "and", "fallback", "to", "global", "configuration", "String", "runApiKey", "=", "isBlank", "(", "apiKey", ")", "?", "d", ".", "getApiKey", "(", ")", ":", "apiKey", ";", "Secret", "secretKey", "=", "apiKey", ";", "if", "(", "secretKey", "=", "=", "null", "|", "|", "\"", "\".", "equals", "(", "secretKey", ".", "getPlainText", "(", "))", ")", "{", "/", "/", "prefer", "key", "from", "global", "settings", "if", "the", "job", "has", "none", "secretKey", "=", "d", ".", "getApiKey", "(", ");", "}", "String", "runApiKey", "=", "secretKey", ".", "getPlainText", "(", ");", "String", "runTestCaseMappingField", "=", "isBlank", "(", "testCaseMappingField", ")", "?", "d", ".", "getTestCaseMappingField", "(", ")", ":", "testCaseMappingField", ";", "Usingonpremise", "uop", "=", "advancedSettings", "!", "=", "null", "&", "&", "advancedSettings", ".", "getUsingonpremise", "(", ")", "!", "=", "null", "@", "@", "-", "503", ",", "7", "+", "508", ",", "7", "@", "@", "public", "DescriptorImpl", "getDescriptor", "(", ")", "{", "/", "/", "company", "id", "of", "the", "testlab", "which", "to", "publish", "to", "private", "String", "companyId", ";", "/", "/", "testlab", "api", "key", "private", "String", "apiKey", ";", "private", "Secret", "apiKey", ";", "/", "/", "custom", "field", "name", "to", "map", "the", "test", "ids", "against", "with", "private", "String", "testCaseMappingField", ";", "/", "/", "if", "set", ",", "on", "-", "premise", "variant", "of", "Testlab", "is", "used", "and", "Testlab", "URL", "should", "be", "set", "and", "honored", "@", "@", "-", "551", ",", "7", "+", "556", ",", "7", "@", "@", "public", "boolean", "isApplicable", "(", "Class", "type", ")", "{", "public", "boolean", "configure", "(", "StaplerRequest", "staplerRequest", ",", "JSONObject", "json", ")", "throws", "Descriptor", ".", "FormException", "{", "/", "/", "persist", "configuration", "companyId", "=", "json", ".", "getString", "(", "\"", "companyId", "\"", ");", "apiKey", "=", "json", ".", "getString", "(", "\"", "apiKey", "\"", ");", "apiKey", "=", "Secret", ".", "fromString", "(", "json", ".", "getString", "(", "\"", "apiKey", "\"", "))", ";", "testCaseMappingField", "=", "json", ".", "getString", "(", "\"", "testCaseMappingField", "\"", ");", "JSONObject", "uop", "=", "json", ".", "getJSONObject", "(", "\"", "usingonpremise", "\"", ");", "@", "@", "-", "596", ",", "7", "+", "601", ",", "7", "@", "@", "public", "String", "getCompanyId", "(", ")", "{", "return", "companyId", ";", "}", "public", "String", "getApiKey", "(", ")", "{", "public", "Secret", "getApiKey", "(", ")", "{", "return", "apiKey", ";", "}", "@", "@", "-", "640", ",", "9", "+", "645", ",", "9", "@", "@", "public", "String", "getCompanyId", "(", ")", "{", "}", "/", "/", "job", "specific", "apikey", "of", "target", "testlab", ",", "optional", "private", "String", "apiKey", ";", "private", "Secret", "apiKey", ";", "public", "String", "getApiKey", "(", ")", "{", "public", "Secret", "getApiKey", "(", ")", "{", "return", "apiKey", ";", "}", "@", "@", "-", "661", ",", "7", "+", "666", ",", "7", "@", "@", "public", "Usingonpremise", "getUsingonpremise", "(", ")", "{", "}", "@", "DataBoundConstructor", "public", "AdvancedSettings", "(", "String", "companyId", ",", "String", "apiKey", ",", "String", "testCaseMappingField", ",", "Usingonpremise", "usingonpremise", ")", "{", "public", "AdvancedSettings", "(", "String", "companyId", ",", "Secret", "apiKey", ",", "String", "testCaseMappingField", ",", "Usingonpremise", "usingonpremise", ")", "{", "this", ".", "companyId", "=", "companyId", ";", "this", ".", "apiKey", "=", "apiKey", ";", "this", ".", "testCaseMappingField", "=", "testCaseMappingField", ";", "@", "@", "-", "18", ",", "7", "+", "18", ",", "7", "@", "@", "/", "**", "*", "Creates", "a", "new", "variable", "replacer", "by", "combining", "key", "-", "value", "maps", "provided", ".", "*", "*", "@", "param", "vars", "*", "@", "param", "vars", "variables", "*", "/", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "public", "VariableReplacer", "(", "Map", "<", "String", ",", "String", ">", "..", ".", "vars", ")", "{", "@", "@", "-", "38", ",", "8", "+", "38", ",", "8", "@", "@", "public", "VariableReplacer", "(", "Map", "<", "String", ",", "String", ">", "..", ".", "vars", ")", "{", "*", "Replaces", "all", "tags", "in", "format", "$", "{", "BUILD_NUMBER", "}", "with", "matching", "value", "from", "envVars", ".", "*", "If", "variable", "is", "missing", ",", "tag", "is", "left", "as", "it", "is", ".", "*", "*", "@", "param", "src", "*", "@", "return", "*", "@", "param", "src", "source", "String", "*", "@", "return", "String", "with", "variables", "replaced", "*", "/", "public", "String", "replace", "(", "String", "src", ")", "{", "if", "(", "vars", "=", "=", "null", "|", "|", "src", "=", "=", "null", "|", "|", "src", ".", "length", "(", ")", "=", "=", "0", ")", "@", "@", "-", "0", ",", "0", "+", "1", ",", "210", "@", "@", "package", "fi", ".", "meliora", ".", "testlab", ".", "ext", ".", "rest", ".", "model", ";", "import", "javax", ".", "xml", ".", "bind", ".", "annotation", ".", "XmlAccessType", ";", "import", "javax", ".", "xml", ".", "bind", ".", "annotation", ".", "XmlAccessorType", ";", "/", "**", "*", "A", "custom", "field", "object", "with", "10", "fields", "included", ".", "*", "*", "@", "author", "Marko", "Kanala", "*", "/", "@", "XmlAccessorType", "(", "XmlAccessType", ".", "FIELD", ")", "public", "class", "CustomFieldObject", "extends", "ModelObject", "{", "/", "**", "*", "custom", "field", "value", "*", "/", "private", "String", "custom1", ";", "/", "**", "*", "custom", "field", "value", "*", "/", "private", "String", "custom2", ";", "/", "**", "*", "custom", "field", "value", "*", "/", "private", "String", "custom3", ";", "/", "**", "*", "custom", "field", "value", "*", "/", "private", "String", "custom4", ";", "/", "**", "*", "custom", "field", "value", "*", "/", "private", "String", "custom5", ";", "/", "**", "*", "custom", "field", "value", "*", "/", "private", "String", "custom6", ";", "/", "**", "*", "custom", "field", "value", "*", "/", "private", "String", "custom7", ";", "/", "**", "*", "custom", "field", "value", "*", "/", "private", "String", "custom8", ";", "/", "**", "*", "custom", "field", "value", "*", "/", "private", "String", "custom9", ";", "/", "**", "*", "custom", "field", "value", "*", "/", "private", "String", "custom10", ";", "public", "String", "getCustom1", "(", ")", "{", "return", "custom1", ";", "}", "public", "void", "setCustom1", "(", "String", "custom1", ")", "{", "this", ".", "custom1", "=", "custom1", ";", "}", "public", "String", "getCustom2", "(", ")", "{", "return", "custom2", ";", "}", "public", "void", "setCustom2", "(", "String", "custom2", ")", "{", "this", ".", "custom2", "=", "custom2", ";", "}", "public", "String", "getCustom3", "(", ")", "{", "return", "custom3", ";", "}", "public", "void", "setCustom3", "(", "String", "custom3", ")", "{", "this", ".", "custom3", "=", "custom3", ";", "}", "public", "String", "getCustom4", "(", ")", "{", "return", "custom4", ";", "}", "public", "void", "setCustom4", "(", "String", "custom4", ")", "{", "this", ".", "custom4", "=", "custom4", ";", "}", "public", "String", "getCustom5", "(", ")", "{", "return", "custom5", ";", "}", "public", "void", "setCustom5", "(", "String", "custom5", ")", "{", "this", ".", "custom5", "=", "custom5", ";", "}", "public", "String", "getCustom6", "(", ")", "{", "return", "custom6", ";", "}", "public", "void", "setCustom6", "(", "String", "custom6", ")", "{", "this", ".", "custom6", "=", "custom6", ";", "}", "public", "String", "getCustom7", "(", ")", "{", "return", "custom7", ";", "}", "public", "void", "setCustom7", "(", "String", "custom7", ")", "{", "this", ".", "custom7", "=", "custom7", ";", "}", "public", "String", "getCustom8", "(", ")", "{", "return", "custom8", ";", "}", "public", "void", "setCustom8", "(", "String", "custom8", ")", "{", "this", ".", "custom8", "=", "custom8", ";", "}", "public", "String", "getCustom9", "(", ")", "{", "return", "custom9", ";", "}", "public", "void", "setCustom9", "(", "String", "custom9", ")", "{", "this", ".", "custom9", "=", "custom9", ";", "}", "public", "String", "getCustom10", "(", ")", "{", "return", "custom10", ";", "}", "public", "void", "setCustom10", "(", "String", "custom10", ")", "{", "this", ".", "custom10", "=", "custom10", ";", "}", "/", "**", "*", "Returns", "a", "custom", "field", "value", "from", "this", "object", "by", "field", "index", ".", "*", "*", "@", "param", "index", "field", "index", "*", "@", "return", "field", "value", "*", "/", "public", "String", "getCustomFieldValue", "(", "int", "index", ")", "{", "switch", "(", "index", ")", "{", "case", "1", ":", "return", "getCustom1", "(", ");", "case", "2", ":", "return", "getCustom2", "(", ");", "case", "3", ":", "return", "getCustom3", "(", ");", "case", "4", ":", "return", "getCustom4", "(", ");", "case", "5", ":", "return", "getCustom5", "(", ");", "case", "6", ":", "return", "getCustom6", "(", ");", "case", "7", ":", "return", "getCustom7", "(", ");", "case", "8", ":", "return", "getCustom8", "(", ");", "case", "9", ":", "return", "getCustom9", "(", ");", "case", "10", ":", "return", "getCustom10", "(", ");", "}", "return", "null", ";", "}", "/", "**", "*", "Sets", "a", "custom", "field", "value", "to", "this", "object", "by", "field", "index", ".", "*", "*", "@", "param", "index", "field", "index", "*", "@", "param", "value", "field", "value", "*", "/", "public", "void", "setCustomFieldValue", "(", "int", "index", ",", "String", "value", ")", "{", "switch", "(", "index", ")", "{", "case", "1", ":", "setCustom1", "(", "value", ")", ";", "break", ";", "case", "2", ":", "setCustom2", "(", "value", ")", ";", "break", ";", "case", "3", ":", "setCustom3", "(", "value", ")", ";", "break", ";", "case", "4", ":", "setCustom4", "(", "value", ")", ";", "break", ";", "case", "5", ":", "setCustom5", "(", "value", ")", ";", "break", ";", "case", "6", ":", "setCustom6", "(", "value", ")", ";", "break", ";", "case", "7", ":", "setCustom7", "(", "value", ")", ";", "break", ";", "case", "8", ":", "setCustom8", "(", "value", ")", ";", "break", ";", "case", "9", ":", "setCustom9", "(", "value", ")", ";", "break", ";", "case", "10", ":", "setCustom10", "(", "value", ")", ";", "break", ";", "default", ":", "throw", "new", "RuntimeException", "(", "\"", "setCustomFieldValue", "called", "for", "invalid", "index", ":", "\"", "+", "index", ")", ";", "}", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "1183", "@", "@", "package", "fi", ".", "meliora", ".", "testlab", ".", "ext", ".", "rest", ".", "model", ";", "import", "javax", ".", "xml", ".", "bind", ".", "annotation", ".", "XmlAccessType", ";", "import", "javax", ".", "xml", ".", "bind", ".", "annotation", ".", "XmlAccessorType", ";", "import", "javax", ".", "xml", ".", "bind", ".", "annotation", ".", "XmlElement", ";", "import", "javax", ".", "xml", ".", "bind", ".", "annotation", ".", "XmlTransient", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "/", "**", "*", "A", "custom", "field", "object", "with", "150", "fields", "included", ".", "*", "*", "@", "author", "Marko", "Kanala", "*", "/", "@", "XmlAccessorType", "(", "XmlAccessType", ".", "PROPERTY", ")", "public", "class", "CustomFieldObjectWithExtraFields", "extends", "CustomFieldObject", "{", "@", "XmlTransient", "private", "Map", "<", "String", ",", "String", ">", "ef", "=", "new", "HashMap", "<", "String", ",", "String", ">", "()", ";", "@", "XmlElement", "public", "String", "getCustom11", "(", ")", "{", "return", "getCustomFieldValue", "(", "11", ")", ";", "}", "public", "void", "setCustom11", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "11", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom12", "(", ")", "{", "return", "getCustomFieldValue", "(", "12", ")", ";", "}", "public", "void", "setCustom12", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "12", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom13", "(", ")", "{", "return", "getCustomFieldValue", "(", "13", ")", ";", "}", "public", "void", "setCustom13", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "13", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom14", "(", ")", "{", "return", "getCustomFieldValue", "(", "14", ")", ";", "}", "public", "void", "setCustom14", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "14", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom15", "(", ")", "{", "return", "getCustomFieldValue", "(", "15", ")", ";", "}", "public", "void", "setCustom15", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "15", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom16", "(", ")", "{", "return", "getCustomFieldValue", "(", "16", ")", ";", "}", "public", "void", "setCustom16", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "16", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom17", "(", ")", "{", "return", "getCustomFieldValue", "(", "17", ")", ";", "}", "public", "void", "setCustom17", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "17", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom18", "(", ")", "{", "return", "getCustomFieldValue", "(", "18", ")", ";", "}", "public", "void", "setCustom18", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "18", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom19", "(", ")", "{", "return", "getCustomFieldValue", "(", "19", ")", ";", "}", "public", "void", "setCustom19", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "19", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom20", "(", ")", "{", "return", "getCustomFieldValue", "(", "20", ")", ";", "}", "public", "void", "setCustom20", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "20", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom21", "(", ")", "{", "return", "getCustomFieldValue", "(", "21", ")", ";", "}", "public", "void", "setCustom21", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "21", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom22", "(", ")", "{", "return", "getCustomFieldValue", "(", "22", ")", ";", "}", "public", "void", "setCustom22", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "22", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom23", "(", ")", "{", "return", "getCustomFieldValue", "(", "23", ")", ";", "}", "public", "void", "setCustom23", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "23", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom24", "(", ")", "{", "return", "getCustomFieldValue", "(", "24", ")", ";", "}", "public", "void", "setCustom24", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "24", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom25", "(", ")", "{", "return", "getCustomFieldValue", "(", "25", ")", ";", "}", "public", "void", "setCustom25", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "25", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom26", "(", ")", "{", "return", "getCustomFieldValue", "(", "26", ")", ";", "}", "public", "void", "setCustom26", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "26", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom27", "(", ")", "{", "return", "getCustomFieldValue", "(", "27", ")", ";", "}", "public", "void", "setCustom27", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "27", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom28", "(", ")", "{", "return", "getCustomFieldValue", "(", "28", ")", ";", "}", "public", "void", "setCustom28", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "28", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom29", "(", ")", "{", "return", "getCustomFieldValue", "(", "29", ")", ";", "}", "public", "void", "setCustom29", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "29", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom30", "(", ")", "{", "return", "getCustomFieldValue", "(", "30", ")", ";", "}", "public", "void", "setCustom30", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "30", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom31", "(", ")", "{", "return", "getCustomFieldValue", "(", "31", ")", ";", "}", "public", "void", "setCustom31", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "31", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom32", "(", ")", "{", "return", "getCustomFieldValue", "(", "32", ")", ";", "}", "public", "void", "setCustom32", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "32", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom33", "(", ")", "{", "return", "getCustomFieldValue", "(", "33", ")", ";", "}", "public", "void", "setCustom33", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "33", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom34", "(", ")", "{", "return", "getCustomFieldValue", "(", "34", ")", ";", "}", "public", "void", "setCustom34", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "34", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom35", "(", ")", "{", "return", "getCustomFieldValue", "(", "35", ")", ";", "}", "public", "void", "setCustom35", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "35", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom36", "(", ")", "{", "return", "getCustomFieldValue", "(", "36", ")", ";", "}", "public", "void", "setCustom36", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "36", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom37", "(", ")", "{", "return", "getCustomFieldValue", "(", "37", ")", ";", "}", "public", "void", "setCustom37", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "37", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom38", "(", ")", "{", "return", "getCustomFieldValue", "(", "38", ")", ";", "}", "public", "void", "setCustom38", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "38", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom39", "(", ")", "{", "return", "getCustomFieldValue", "(", "39", ")", ";", "}", "public", "void", "setCustom39", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "39", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom40", "(", ")", "{", "return", "getCustomFieldValue", "(", "40", ")", ";", "}", "public", "void", "setCustom40", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "40", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom41", "(", ")", "{", "return", "getCustomFieldValue", "(", "41", ")", ";", "}", "public", "void", "setCustom41", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "41", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom42", "(", ")", "{", "return", "getCustomFieldValue", "(", "42", ")", ";", "}", "public", "void", "setCustom42", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "42", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom43", "(", ")", "{", "return", "getCustomFieldValue", "(", "43", ")", ";", "}", "public", "void", "setCustom43", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "43", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom44", "(", ")", "{", "return", "getCustomFieldValue", "(", "44", ")", ";", "}", "public", "void", "setCustom44", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "44", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom45", "(", ")", "{", "return", "getCustomFieldValue", "(", "45", ")", ";", "}", "public", "void", "setCustom45", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "45", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom46", "(", ")", "{", "return", "getCustomFieldValue", "(", "46", ")", ";", "}", "public", "void", "setCustom46", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "46", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom47", "(", ")", "{", "return", "getCustomFieldValue", "(", "47", ")", ";", "}", "public", "void", "setCustom47", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "47", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom48", "(", ")", "{", "return", "getCustomFieldValue", "(", "48", ")", ";", "}", "public", "void", "setCustom48", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "48", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom49", "(", ")", "{", "return", "getCustomFieldValue", "(", "49", ")", ";", "}", "public", "void", "setCustom49", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "49", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom50", "(", ")", "{", "return", "getCustomFieldValue", "(", "50", ")", ";", "}", "public", "void", "setCustom50", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "50", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom51", "(", ")", "{", "return", "getCustomFieldValue", "(", "51", ")", ";", "}", "public", "void", "setCustom51", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "51", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom52", "(", ")", "{", "return", "getCustomFieldValue", "(", "52", ")", ";", "}", "public", "void", "setCustom52", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "52", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom53", "(", ")", "{", "return", "getCustomFieldValue", "(", "53", ")", ";", "}", "public", "void", "setCustom53", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "53", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom54", "(", ")", "{", "return", "getCustomFieldValue", "(", "54", ")", ";", "}", "public", "void", "setCustom54", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "54", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom55", "(", ")", "{", "return", "getCustomFieldValue", "(", "55", ")", ";", "}", "public", "void", "setCustom55", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "55", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom56", "(", ")", "{", "return", "getCustomFieldValue", "(", "56", ")", ";", "}", "public", "void", "setCustom56", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "56", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom57", "(", ")", "{", "return", "getCustomFieldValue", "(", "57", ")", ";", "}", "public", "void", "setCustom57", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "57", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom58", "(", ")", "{", "return", "getCustomFieldValue", "(", "58", ")", ";", "}", "public", "void", "setCustom58", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "58", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom59", "(", ")", "{", "return", "getCustomFieldValue", "(", "59", ")", ";", "}", "public", "void", "setCustom59", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "59", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom60", "(", ")", "{", "return", "getCustomFieldValue", "(", "60", ")", ";", "}", "public", "void", "setCustom60", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "60", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom61", "(", ")", "{", "return", "getCustomFieldValue", "(", "61", ")", ";", "}", "public", "void", "setCustom61", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "61", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom62", "(", ")", "{", "return", "getCustomFieldValue", "(", "62", ")", ";", "}", "public", "void", "setCustom62", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "62", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom63", "(", ")", "{", "return", "getCustomFieldValue", "(", "63", ")", ";", "}", "public", "void", "setCustom63", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "63", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom64", "(", ")", "{", "return", "getCustomFieldValue", "(", "64", ")", ";", "}", "public", "void", "setCustom64", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "64", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom65", "(", ")", "{", "return", "getCustomFieldValue", "(", "65", ")", ";", "}", "public", "void", "setCustom65", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "65", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom66", "(", ")", "{", "return", "getCustomFieldValue", "(", "66", ")", ";", "}", "public", "void", "setCustom66", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "66", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom67", "(", ")", "{", "return", "getCustomFieldValue", "(", "67", ")", ";", "}", "public", "void", "setCustom67", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "67", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom68", "(", ")", "{", "return", "getCustomFieldValue", "(", "68", ")", ";", "}", "public", "void", "setCustom68", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "68", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom69", "(", ")", "{", "return", "getCustomFieldValue", "(", "69", ")", ";", "}", "public", "void", "setCustom69", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "69", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom70", "(", ")", "{", "return", "getCustomFieldValue", "(", "70", ")", ";", "}", "public", "void", "setCustom70", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "70", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom71", "(", ")", "{", "return", "getCustomFieldValue", "(", "71", ")", ";", "}", "public", "void", "setCustom71", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "71", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom72", "(", ")", "{", "return", "getCustomFieldValue", "(", "72", ")", ";", "}", "public", "void", "setCustom72", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "72", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom73", "(", ")", "{", "return", "getCustomFieldValue", "(", "73", ")", ";", "}", "public", "void", "setCustom73", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "73", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom74", "(", ")", "{", "return", "getCustomFieldValue", "(", "74", ")", ";", "}", "public", "void", "setCustom74", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "74", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom75", "(", ")", "{", "return", "getCustomFieldValue", "(", "75", ")", ";", "}", "public", "void", "setCustom75", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "75", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom76", "(", ")", "{", "return", "getCustomFieldValue", "(", "76", ")", ";", "}", "public", "void", "setCustom76", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "76", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom77", "(", ")", "{", "return", "getCustomFieldValue", "(", "77", ")", ";", "}", "public", "void", "setCustom77", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "77", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom78", "(", ")", "{", "return", "getCustomFieldValue", "(", "78", ")", ";", "}", "public", "void", "setCustom78", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "78", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom79", "(", ")", "{", "return", "getCustomFieldValue", "(", "79", ")", ";", "}", "public", "void", "setCustom79", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "79", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom80", "(", ")", "{", "return", "getCustomFieldValue", "(", "80", ")", ";", "}", "public", "void", "setCustom80", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "80", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom81", "(", ")", "{", "return", "getCustomFieldValue", "(", "81", ")", ";", "}", "public", "void", "setCustom81", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "81", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom82", "(", ")", "{", "return", "getCustomFieldValue", "(", "82", ")", ";", "}", "public", "void", "setCustom82", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "82", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom83", "(", ")", "{", "return", "getCustomFieldValue", "(", "83", ")", ";", "}", "public", "void", "setCustom83", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "83", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom84", "(", ")", "{", "return", "getCustomFieldValue", "(", "84", ")", ";", "}", "public", "void", "setCustom84", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "84", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom85", "(", ")", "{", "return", "getCustomFieldValue", "(", "85", ")", ";", "}", "public", "void", "setCustom85", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "85", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom86", "(", ")", "{", "return", "getCustomFieldValue", "(", "86", ")", ";", "}", "public", "void", "setCustom86", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "86", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom87", "(", ")", "{", "return", "getCustomFieldValue", "(", "87", ")", ";", "}", "public", "void", "setCustom87", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "87", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom88", "(", ")", "{", "return", "getCustomFieldValue", "(", "88", ")", ";", "}", "public", "void", "setCustom88", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "88", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom89", "(", ")", "{", "return", "getCustomFieldValue", "(", "89", ")", ";", "}", "public", "void", "setCustom89", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "89", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom90", "(", ")", "{", "return", "getCustomFieldValue", "(", "90", ")", ";", "}", "public", "void", "setCustom90", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "90", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom91", "(", ")", "{", "return", "getCustomFieldValue", "(", "91", ")", ";", "}", "public", "void", "setCustom91", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "91", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom92", "(", ")", "{", "return", "getCustomFieldValue", "(", "92", ")", ";", "}", "public", "void", "setCustom92", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "92", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom93", "(", ")", "{", "return", "getCustomFieldValue", "(", "93", ")", ";", "}", "public", "void", "setCustom93", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "93", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom94", "(", ")", "{", "return", "getCustomFieldValue", "(", "94", ")", ";", "}", "public", "void", "setCustom94", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "94", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom95", "(", ")", "{", "return", "getCustomFieldValue", "(", "95", ")", ";", "}", "public", "void", "setCustom95", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "95", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom96", "(", ")", "{", "return", "getCustomFieldValue", "(", "96", ")", ";", "}", "public", "void", "setCustom96", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "96", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom97", "(", ")", "{", "return", "getCustomFieldValue", "(", "97", ")", ";", "}", "public", "void", "setCustom97", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "97", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom98", "(", ")", "{", "return", "getCustomFieldValue", "(", "98", ")", ";", "}", "public", "void", "setCustom98", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "98", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom99", "(", ")", "{", "return", "getCustomFieldValue", "(", "99", ")", ";", "}", "public", "void", "setCustom99", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "99", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom100", "(", ")", "{", "return", "getCustomFieldValue", "(", "100", ")", ";", "}", "public", "void", "setCustom100", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "100", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom101", "(", ")", "{", "return", "getCustomFieldValue", "(", "101", ")", ";", "}", "public", "void", "setCustom101", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "101", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom102", "(", ")", "{", "return", "getCustomFieldValue", "(", "102", ")", ";", "}", "public", "void", "setCustom102", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "102", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom103", "(", ")", "{", "return", "getCustomFieldValue", "(", "103", ")", ";", "}", "public", "void", "setCustom103", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "103", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom104", "(", ")", "{", "return", "getCustomFieldValue", "(", "104", ")", ";", "}", "public", "void", "setCustom104", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "104", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom105", "(", ")", "{", "return", "getCustomFieldValue", "(", "105", ")", ";", "}", "public", "void", "setCustom105", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "105", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom106", "(", ")", "{", "return", "getCustomFieldValue", "(", "106", ")", ";", "}", "public", "void", "setCustom106", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "106", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom107", "(", ")", "{", "return", "getCustomFieldValue", "(", "107", ")", ";", "}", "public", "void", "setCustom107", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "107", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom108", "(", ")", "{", "return", "getCustomFieldValue", "(", "108", ")", ";", "}", "public", "void", "setCustom108", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "108", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom109", "(", ")", "{", "return", "getCustomFieldValue", "(", "109", ")", ";", "}", "public", "void", "setCustom109", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "109", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom110", "(", ")", "{", "return", "getCustomFieldValue", "(", "110", ")", ";", "}", "public", "void", "setCustom110", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "110", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom111", "(", ")", "{", "return", "getCustomFieldValue", "(", "111", ")", ";", "}", "public", "void", "setCustom111", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "111", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom112", "(", ")", "{", "return", "getCustomFieldValue", "(", "112", ")", ";", "}", "public", "void", "setCustom112", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "112", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom113", "(", ")", "{", "return", "getCustomFieldValue", "(", "113", ")", ";", "}", "public", "void", "setCustom113", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "113", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom114", "(", ")", "{", "return", "getCustomFieldValue", "(", "114", ")", ";", "}", "public", "void", "setCustom114", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "114", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom115", "(", ")", "{", "return", "getCustomFieldValue", "(", "115", ")", ";", "}", "public", "void", "setCustom115", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "115", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom116", "(", ")", "{", "return", "getCustomFieldValue", "(", "116", ")", ";", "}", "public", "void", "setCustom116", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "116", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom117", "(", ")", "{", "return", "getCustomFieldValue", "(", "117", ")", ";", "}", "public", "void", "setCustom117", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "117", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom118", "(", ")", "{", "return", "getCustomFieldValue", "(", "118", ")", ";", "}", "public", "void", "setCustom118", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "118", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom119", "(", ")", "{", "return", "getCustomFieldValue", "(", "119", ")", ";", "}", "public", "void", "setCustom119", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "119", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom120", "(", ")", "{", "return", "getCustomFieldValue", "(", "120", ")", ";", "}", "public", "void", "setCustom120", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "120", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom121", "(", ")", "{", "return", "getCustomFieldValue", "(", "121", ")", ";", "}", "public", "void", "setCustom121", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "121", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom122", "(", ")", "{", "return", "getCustomFieldValue", "(", "122", ")", ";", "}", "public", "void", "setCustom122", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "122", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom123", "(", ")", "{", "return", "getCustomFieldValue", "(", "123", ")", ";", "}", "public", "void", "setCustom123", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "123", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom124", "(", ")", "{", "return", "getCustomFieldValue", "(", "124", ")", ";", "}", "public", "void", "setCustom124", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "124", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom125", "(", ")", "{", "return", "getCustomFieldValue", "(", "125", ")", ";", "}", "public", "void", "setCustom125", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "125", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom126", "(", ")", "{", "return", "getCustomFieldValue", "(", "126", ")", ";", "}", "public", "void", "setCustom126", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "126", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom127", "(", ")", "{", "return", "getCustomFieldValue", "(", "127", ")", ";", "}", "public", "void", "setCustom127", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "127", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom128", "(", ")", "{", "return", "getCustomFieldValue", "(", "128", ")", ";", "}", "public", "void", "setCustom128", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "128", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom129", "(", ")", "{", "return", "getCustomFieldValue", "(", "129", ")", ";", "}", "public", "void", "setCustom129", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "129", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom130", "(", ")", "{", "return", "getCustomFieldValue", "(", "130", ")", ";", "}", "public", "void", "setCustom130", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "130", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom131", "(", ")", "{", "return", "getCustomFieldValue", "(", "131", ")", ";", "}", "public", "void", "setCustom131", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "131", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom132", "(", ")", "{", "return", "getCustomFieldValue", "(", "132", ")", ";", "}", "public", "void", "setCustom132", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "132", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom133", "(", ")", "{", "return", "getCustomFieldValue", "(", "133", ")", ";", "}", "public", "void", "setCustom133", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "133", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom134", "(", ")", "{", "return", "getCustomFieldValue", "(", "134", ")", ";", "}", "public", "void", "setCustom134", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "134", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom135", "(", ")", "{", "return", "getCustomFieldValue", "(", "135", ")", ";", "}", "public", "void", "setCustom135", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "135", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom136", "(", ")", "{", "return", "getCustomFieldValue", "(", "136", ")", ";", "}", "public", "void", "setCustom136", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "136", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom137", "(", ")", "{", "return", "getCustomFieldValue", "(", "137", ")", ";", "}", "public", "void", "setCustom137", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "137", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom138", "(", ")", "{", "return", "getCustomFieldValue", "(", "138", ")", ";", "}", "public", "void", "setCustom138", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "138", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom139", "(", ")", "{", "return", "getCustomFieldValue", "(", "139", ")", ";", "}", "public", "void", "setCustom139", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "139", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom140", "(", ")", "{", "return", "getCustomFieldValue", "(", "140", ")", ";", "}", "public", "void", "setCustom140", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "140", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom141", "(", ")", "{", "return", "getCustomFieldValue", "(", "141", ")", ";", "}", "public", "void", "setCustom141", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "141", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom142", "(", ")", "{", "return", "getCustomFieldValue", "(", "142", ")", ";", "}", "public", "void", "setCustom142", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "142", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom143", "(", ")", "{", "return", "getCustomFieldValue", "(", "143", ")", ";", "}", "public", "void", "setCustom143", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "143", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom144", "(", ")", "{", "return", "getCustomFieldValue", "(", "144", ")", ";", "}", "public", "void", "setCustom144", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "144", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom145", "(", ")", "{", "return", "getCustomFieldValue", "(", "145", ")", ";", "}", "public", "void", "setCustom145", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "145", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom146", "(", ")", "{", "return", "getCustomFieldValue", "(", "146", ")", ";", "}", "public", "void", "setCustom146", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "146", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom147", "(", ")", "{", "return", "getCustomFieldValue", "(", "147", ")", ";", "}", "public", "void", "setCustom147", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "147", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom148", "(", ")", "{", "return", "getCustomFieldValue", "(", "148", ")", ";", "}", "public", "void", "setCustom148", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "148", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom149", "(", ")", "{", "return", "getCustomFieldValue", "(", "149", ")", ";", "}", "public", "void", "setCustom149", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "149", ",", "val", ")", ";", "}", "@", "XmlElement", "public", "String", "getCustom150", "(", ")", "{", "return", "getCustomFieldValue", "(", "150", ")", ";", "}", "public", "void", "setCustom150", "(", "String", "val", ")", "{", "setCustomFieldValue", "(", "150", ",", "val", ")", ";", "}", "/", "**", "*", "Returns", "a", "custom", "field", "value", "from", "this", "object", "by", "field", "index", ".", "*", "*", "@", "param", "index", "field", "index", "*", "@", "return", "field", "value", "*", "/", "@", "Override", "@", "XmlTransient", "public", "String", "getCustomFieldValue", "(", "int", "index", ")", "{", "if", "(", "index", ">", "10", ")", "{", "if", "(", "ef", "!", "=", "null", ")", "{", "return", "ef", ".", "get", "(", "String", ".", "valueOf", "(", "index", ")", ");", "}", "return", "null", ";", "}", "else", "{", "return", "super", ".", "getCustomFieldValue", "(", "index", ")", ";", "}", "}", "/", "**", "*", "Sets", "a", "custom", "field", "value", "to", "this", "object", "by", "field", "index", ".", "*", "*", "@", "param", "index", "field", "index", "*", "@", "param", "value", "field", "value", "*", "/", "@", "Override", "@", "XmlTransient", "public", "void", "setCustomFieldValue", "(", "int", "index", ",", "String", "value", ")", "{", "if", "(", "index", ">", "10", ")", "{", "if", "(", "ef", "!", "=", "null", ")", "{", "String", "key", "=", "String", ".", "valueOf", "(", "index", ")", ";", "if", "(", "value", "=", "=", "null", "|", "|", "value", ".", "trim", "(", ").", "length", "(", ")", "=", "=", "0", ")", "{", "ef", ".", "remove", "(", "key", ")", ";", "}", "else", "{", "ef", ".", "put", "(", "key", ",", "value", ")", ";", "}", "}", "else", "{", "throw", "new", "RuntimeException", "(", "\"", "setCustomFieldValue", "called", "custom", "field", "object", "without", "extra", "fields", ":", "\"", "+", "index", "+", "\"", "/\"", "+", "value", ")", ";", "}", "}", "else", "{", "super", ".", "setCustomFieldValue", "(", "index", ",", "value", ")", ";", "}", "}", "}", "@", "@", "-", "45", ",", "7", "+", "45", ",", "7", "@", "@", "public", "Long", "getTestCaseId", "(", ")", "{", "/", "**", "*", "Test", "case", "id", "for", "this", "result", ".", "Optional", "if", "mappingId", "is", "set", ".", "*", "*", "@", "param", "testCaseId", "*", "@", "param", "testCaseId", "test", "case", "id", "*", "/", "public", "void", "setTestCaseId", "(", "Long", "testCaseId", ")", "{", "this", ".", "testCaseId", "=", "testCaseId", ";", "@", "@", "-", "59", ",", "7", "+", "59", ",", "7", "@", "@", "public", "String", "getMappingId", "(", ")", "{", "*", "Id", "value", "to", "use", "to", "lookup", "the", "test", "case", "from", "Testlab", ".", "This", "value", "is", "compared", "*", "against", "project", "'", "s", "custom", "field", "value", "from", "custom", "field", "set", "in", "TestResult", ".", "testCaseMappingField", ".", "*", "*", "@", "param", "mappingId", "*", "@", "param", "mappingId", "test", "case", "mapping", "id", "*", "/", "public", "void", "setMappingId", "(", "String", "mappingId", ")", "{", "this", ".", "mappingId", "=", "mappingId", ";", "@", "@", "-", "72", ",", "7", "+", "72", ",", "7", "@", "@", "public", "int", "getResult", "(", ")", "{", "/", "**", "*", "Result", "status", "value", "for", "the", "run", "test", "case", ".", "*", "*", "@", "param", "result", "*", "@", "param", "result", "result", "*", "/", "public", "void", "setResult", "(", "int", "result", ")", "{", "this", ".", "result", "=", "result", ";", "@", "@", "-", "85", ",", "7", "+", "85", ",", "7", "@", "@", "public", "long", "getStarted", "(", ")", "{", "/", "**", "*", "Timestamp", "of", "when", "this", "test", "case", "was", "started", ".", "*", "*", "@", "param", "started", "*", "@", "param", "started", "started", "*", "/", "public", "void", "setStarted", "(", "Long", "started", ")", "{", "this", ".", "started", "=", "started", ";", "@", "@", "-", "98", ",", "7", "+", "98", ",", "7", "@", "@", "public", "Long", "getRun", "(", ")", "{", "/", "**", "*", "Timestamp", "of", "when", "this", "test", "case", "was", "completed", ".", "*", "*", "@", "param", "run", "*", "@", "param", "run", "run", "*", "/", "public", "void", "setRun", "(", "Long", "run", ")", "{", "this", ".", "run", "=", "run", ";", "@", "@", "-", "111", ",", "7", "+", "111", ",", "7", "@", "@", "public", "Long", "getRunById", "(", ")", "{", "/", "**", "*", "Id", "of", "the", "user", "who", "ran", "this", "test", "case", ".", "Optional", ".", "*", "*", "@", "param", "runById", "*", "@", "param", "runById", "user", "id", "*", "/", "public", "void", "setRunById", "(", "Long", "runById", ")", "{", "this", ".", "runById", "=", "runById", ";", "@", "@", "-", "124", ",", "7", "+", "124", ",", "7", "@", "@", "public", "String", "getRunBy", "(", ")", "{", "/", "**", "*", "Name", "of", "the", "user", "who", "ran", "this", "test", "case", ".", "Optional", ".", "*", "*", "@", "param", "runBy", "*", "@", "param", "runBy", "user", "name", "*", "/", "public", "void", "setRunBy", "(", "String", "runBy", ")", "{", "this", ".", "runBy", "=", "runBy", ";", "@", "@", "-", "134", ",", "7", "+", "134", ",", "7", "@", "@", "public", "void", "setRunBy", "(", "String", "runBy", ")", "{", "*", "Comment", "(", "i", ".", "e", ".", "error", "description", ")", "for", "this", "result", ".", "This", "value", "is", "used", "*", "when", "adding", "issues", "for", "this", "result", ".", "*", "*", "@", "return", "*", "@", "return", "comment", "*", "/", "public", "String", "getComment", "(", ")", "{", "return", "comment", ";", "@", "@", "-", "147", ",", "7", "+", "147", ",", "7", "@", "@", "public", "void", "setComment", "(", "String", "comment", ")", "{", "/", "**", "*", "Optional", "execution", "steps", "and", "their", "results", "for", "this", "result", ".", "*", "*", "@", "return", "*", "@", "return", "steps", "*", "/", "public", "List", "<", "TestCaseResultStep", ">", "getSteps", "(", ")", "{", "return", "steps", ";", "@", "@", "-", "106", ",", "7", "+", "106", ",", "7", "@", "@", "public", "Long", "getProjectId", "(", ")", "{", "/", "**", "*", "Id", "of", "the", "project", "to", "add", "the", "test", "results", "to", ".", "If", "null", ",", "projectKey", "is", "used", ".", "*", "*", "@", "param", "projectId", "*", "@", "param", "projectId", "projectId", "*", "/", "public", "void", "setProjectId", "(", "Long", "projectId", ")", "{", "this", ".", "projectId", "=", "projectId", ";", "@", "@", "-", "119", ",", "7", "+", "119", ",", "7", "@", "@", "public", "String", "getProjectKey", "(", ")", "{", "/", "**", "*", "Key", "of", "the", "project", "to", "add", "the", "test", "results", "to", ".", "Optional", "if", "projectId", "is", "set", ".", "*", "*", "@", "param", "projectKey", "*", "@", "param", "projectKey", "project", "prefix", "/", "key", "*", "/", "public", "void", "setProjectKey", "(", "String", "projectKey", ")", "{", "this", ".", "projectKey", "=", "projectKey", ";", "@", "@", "-", "132", ",", "7", "+", "132", ",", "7", "@", "@", "public", "Long", "getTestRunId", "(", ")", "{", "/", "**", "*", "Id", "of", "the", "test", "run", "to", "update", "the", "test", "results", "to", ".", "If", "null", ",", "testRunTitle", "is", "used", ".", "*", "*", "@", "param", "testRunId", "*", "@", "param", "testRunId", "test", "run", "id", "*", "/", "public", "void", "setTestRunId", "(", "Long", "testRunId", ")", "{", "this", ".", "testRunId", "=", "testRunId", ";", "@", "@", "-", "145", ",", "7", "+", "145", ",", "7", "@", "@", "public", "String", "getTestRunTitle", "(", ")", "{", "/", "**", "*", "Title", "of", "the", "test", "run", "to", "update", "the", "test", "results", "to", ".", "Optional", "if", "testRunId", "is", "set", ".", "*", "*", "@", "param", "testRunTitle", "*", "@", "param", "testRunTitle", "test", "run", "title", "*", "/", "public", "void", "setTestRunTitle", "(", "String", "testRunTitle", ")", "{", "this", ".", "testRunTitle", "=", "testRunTitle", ";", "@", "@", "-", "159", ",", "7", "+", "159", ",", "7", "@", "@", "public", "String", "getComment", "(", ")", "{", "*", "Comment", "for", "the", "test", "run", ".", "If", "test", "run", "exists", "and", "comment", "is", "left", "as", "null", "the", "comment", "*", "of", "TestRun", "at", "Testlab", "is", "left", "as", "it", "is", ".", "*", "*", "@", "param", "comment", "*", "@", "param", "comment", "comment", "*", "/", "public", "void", "setComment", "(", "String", "comment", ")", "{", "this", ".", "comment", "=", "comment", ";", "@", "@", "-", "172", ",", "7", "+", "172", ",", "7", "@", "@", "public", "int", "getStatus", "(", ")", "{", "/", "**", "*", "Status", "for", "test", "run", ".", "*", "*", "@", "param", "status", "*", "@", "param", "status", "status", "*", "/", "public", "void", "setStatus", "(", "int", "status", ")", "{", "this", ".", "status", "=", "status", ";", "@", "@", "-", "185", ",", "7", "+", "185", ",", "7", "@", "@", "public", "String", "getUser", "(", ")", "{", "/", "**", "*", "Name", "of", "the", "user", "to", "execute", "Testlab", "operations", "with", ".", "*", "*", "@", "param", "user", "*", "@", "param", "user", "user", "name", "*", "/", "public", "void", "setUser", "(", "String", "user", ")", "{", "this", ".", "user", "=", "user", ";", "@", "@", "-", "198", ",", "7", "+", "198", ",", "7", "@", "@", "public", "Long", "getMilestoneId", "(", ")", "{", "/", "**", "*", "Id", "of", "the", "milestone", "for", "the", "test", "run", "and", "issues", ".", "If", "null", ",", "milestoneIdentifier", "and", "milestoneTitle", "are", "used", ".", "*", "*", "@", "param", "milestoneId", "*", "@", "param", "milestoneId", "milestone", "id", "*", "/", "public", "void", "setMilestoneId", "(", "Long", "milestoneId", ")", "{", "this", ".", "milestoneId", "=", "milestoneId", ";", "@", "@", "-", "211", ",", "7", "+", "211", ",", "7", "@", "@", "public", "String", "getMilestoneIdentifier", "(", ")", "{", "/", "**", "*", "Identifier", "of", "the", "milestone", "for", "the", "test", "run", "and", "issues", ".", "If", "null", ",", "milestoneTitle", "is", "used", ".", "*", "*", "@", "param", "milestoneIdentifier", "*", "@", "param", "milestoneIdentifier", "milestone", "identifier", "*", "/", "public", "void", "setMilestoneIdentifier", "(", "String", "milestoneIdentifier", ")", "{", "this", ".", "milestoneIdentifier", "=", "milestoneIdentifier", ";", "@", "@", "-", "224", ",", "7", "+", "224", ",", "7", "@", "@", "public", "String", "getMilestoneTitle", "(", ")", "{", "/", "**", "*", "Title", "of", "the", "milestone", "for", "the", "test", "run", "and", "issues", ".", "*", "*", "@", "param", "milestoneTitle", "*", "@", "param", "milestoneTitle", "milestone", "title", "*", "/", "public", "void", "setMilestoneTitle", "(", "String", "milestoneTitle", ")", "{", "this", ".", "milestoneTitle", "=", "milestoneTitle", ";", "@", "@", "-", "237", ",", "7", "+", "237", ",", "7", "@", "@", "public", "Long", "getTestTargetId", "(", ")", "{", "/", "**", "*", "Id", "of", "the", "test", "target", "(", "version", ")", "for", "the", "test", "run", ".", "If", "null", ",", "testTargetTitle", "is", "used", ".", "*", "*", "@", "param", "testTargetId", "*", "@", "param", "testTargetId", "test", "target", "id", "*", "/", "public", "void", "setTestTargetId", "(", "Long", "testTargetId", ")", "{", "this", ".", "testTargetId", "=", "testTargetId", ";", "@", "@", "-", "250", ",", "7", "+", "250", ",", "7", "@", "@", "public", "String", "getTestTargetTitle", "(", ")", "{", "/", "**", "*", "Title", "of", "the", "test", "target", "(", "version", ")", "for", "the", "test", "run", ".", "Optional", "if", "testTargetId", "is", "set", ".", "*", "*", "@", "param", "testTargetTitle", "*", "@", "param", "testTargetTitle", "test", "target", "title", "*", "/", "public", "void", "setTestTargetTitle", "(", "String", "testTargetTitle", ")", "{", "this", ".", "testTargetTitle", "=", "testTargetTitle", ";", "@", "@", "-", "263", ",", "7", "+", "263", ",", "7", "@", "@", "public", "Long", "getTestEnvironmentId", "(", ")", "{", "/", "**", "*", "Id", "of", "the", "test", "environment", "for", "the", "test", "run", ".", "If", "null", ",", "testEnvironmentTitle", "is", "used", ".", "*", "*", "@", "param", "testEnvironmentId", "*", "@", "param", "testEnvironmentId", "test", "environment", "id", "*", "/", "public", "void", "setTestEnvironmentId", "(", "Long", "testEnvironmentId", ")", "{", "this", ".", "testEnvironmentId", "=", "testEnvironmentId", ";", "@", "@", "-", "276", ",", "7", "+", "276", ",", "7", "@", "@", "public", "String", "getTestEnvironmentTitle", "(", ")", "{", "/", "**", "*", "Title", "of", "the", "test", "environment", "for", "the", "test", "run", ".", "Optional", "if", "testEnvironmentId", "is", "set", ".", "*", "*", "@", "param", "testEnvironmentTitle", "*", "@", "param", "testEnvironmentTitle", "test", "environment", "title", "*", "/", "public", "void", "setTestEnvironmentTitle", "(", "String", "testEnvironmentTitle", ")", "{", "this", ".", "testEnvironmentTitle", "=", "testEnvironmentTitle", ";", "@", "@", "-", "289", ",", "7", "+", "289", ",", "7", "@", "@", "public", "String", "getTags", "(", ")", "{", "/", "**", "*", "Tags", "for", "the", "test", "run", ".", "Optional", ".", "Separate", "multiple", "tags", "with", "spaces", "(", "\"", "tag1", "tag2", "tag3", ".", "..", "\")", ".", "*", "*", "@", "param", "tags", "*", "@", "param", "tags", "a", "list", "of", "tags", "*", "/", "public", "void", "setTags", "(", "String", "tags", ")", "{", "this", ".", "tags", "=", "tags", ";", "@", "@", "-", "305", ",", "7", "+", "305", ",", "7", "@", "@", "public", "String", "getTestCaseMappingField", "(", ")", "{", "*", "*", "This", "value", "is", "case", "-", "insensitive", ".", "*", "*", "@", "param", "testCaseMappingField", "*", "@", "param", "testCaseMappingField", "test", "case", "mapping", "field", "*", "/", "public", "void", "setTestCaseMappingField", "(", "String", "testCaseMappingField", ")", "{", "this", ".", "testCaseMappingField", "=", "testCaseMappingField", ";", "@", "@", "-", "318", ",", "7", "+", "318", ",", "7", "@", "@", "public", "void", "setTestCaseMappingField", "(", "String", "testCaseMappingField", ")", "{", "/", "**", "*", "Values", "to", "set", "to", "test", "case", "parameters", "if", "any", ".", "*", "*", "@", "return", "*", "@", "return", "parameters", "*", "/", "public", "List", "<", "KeyValuePair", ">", "getParameters", "(", ")", "{", "return", "parameters", ";", "@", "@", "-", "331", ",", "7", "+", "331", ",", "7", "@", "@", "public", "void", "setParameters", "(", "List", "<", "KeyValuePair", ">", "parameters", ")", "{", "/", "**", "*", "Results", "of", "individual", "test", "cases", ".", "*", "*", "@", "param", "results", "*", "@", "param", "results", "results", "*", "/", "public", "void", "setResults", "(", "List", "<", "TestCaseResult", ">", "results", ")", "{", "this", ".", "results", "=", "results", ";", "@", "@", "-", "344", ",", "7", "+", "344", ",", "7", "@", "@", "public", "boolean", "isAddIssues", "(", ")", "{", "/", "**", "*", "Set", "to", "true", "to", "add", "issues", "for", "failed", "test", "cases", ".", "*", "*", "@", "param", "addIssues", "*", "@", "param", "addIssues", "boolean", "*", "/", "public", "void", "setAddIssues", "(", "boolean", "addIssues", ")", "{", "this", ".", "addIssues", "=", "addIssues", ";", "@", "@", "-", "357", ",", "7", "+", "357", ",", "7", "@", "@", "public", "boolean", "isMergeAsSingleIssue", "(", ")", "{", "/", "**", "*", "Set", "to", "true", "to", "merge", "added", "issues", "to", "a", "single", "issue", ".", "*", "*", "@", "param", "mergeAsSingleIssue", "*", "@", "param", "mergeAsSingleIssue", "boolean", "*", "/", "public", "void", "setMergeAsSingleIssue", "(", "boolean", "mergeAsSingleIssue", ")", "{", "this", ".", "mergeAsSingleIssue", "=", "mergeAsSingleIssue", ";", "@", "@", "-", "370", ",", "7", "+", "370", ",", "7", "@", "@", "public", "boolean", "isReopenExistingIssues", "(", ")", "{", "/", "**", "*", "Set", "to", "true", "to", "reopen", "existing", "issues", "in", "Testlab", "if", "found", ".", "*", "*", "@", "param", "reopenExistingIssues", "*", "@", "param", "reopenExistingIssues", "boolean", "*", "/", "public", "void", "setReopenExistingIssues", "(", "boolean", "reopenExistingIssues", ")", "{", "this", ".", "reopenExistingIssues", "=", "reopenExistingIssues", ";", "@", "@", "-", "383", ",", "7", "+", "383", ",", "7", "@", "@", "public", "String", "getAssignIssuesToUser", "(", ")", "{", "/", "**", "*", "Assign", "added", "issues", "to", "this", "user", "if", "the", "user", "is", "found", "in", "the", "project", ".", "*", "*", "@", "param", "assignIssuesToUser", "*", "@", "param", "assignIssuesToUser", "boolean", "*", "/", "public", "void", "setAssignIssuesToUser", "(", "String", "assignIssuesToUser", ")", "{", "this", ".", "assignIssuesToUser", "=", "assignIssuesToUser", ";", "@", "@", "-", "397", ",", "7", "+", "397", ",", "7", "@", "@", "public", "String", "getXml", "(", ")", "{", "*", "JUnit", "compatible", "xml", "content", "for", "results", ".", "If", "results", "are", "delivered", "in", "results", "*", "field", "this", "field", "is", "ignored", ".", "*", "*", "@", "param", "xml", "*", "@", "param", "xml", "xml", "*", "/", "public", "void", "setXml", "(", "String", "xml", ")", "{", "this", ".", "xml", "=", "xml", ";", "@", "@", "-", "411", ",", "7", "+", "411", ",", "7", "@", "@", "public", "boolean", "isImportTestCases", "(", ")", "{", "*", "If", "set", "implies", "that", "test", "cases", "which", "are", "not", "found", "via", "the", "mapping", "identifier", "*", "should", "be", "automatically", "created", "during", "the", "push", ".", "*", "*", "@", "param", "importTestCases", "*", "@", "param", "importTestCases", "boolean", "*", "/", "public", "void", "setImportTestCases", "(", "boolean", "importTestCases", ")", "{", "this", ".", "importTestCases", "=", "importTestCases", ";", "@", "@", "-", "424", ",", "7", "+", "424", ",", "7", "@", "@", "public", "String", "getImportTestCasesRootCategory", "(", ")", "{", "/", "**", "*", "If", "set", ",", "sets", "the", "root", "category", "path", "where", "the", "test", "cases", "are", "created", ".", "By", "default", ",", "\"", "Import", "\"", ".", "*", "*", "@", "param", "importTestCasesRootCategory", "*", "@", "param", "importTestCasesRootCategory", "boolean", "*", "/", "public", "void", "setImportTestCasesRootCategory", "(", "String", "importTestCasesRootCategory", ")", "{", "this", ".", "importTestCasesRootCategory", "=", "importTestCasesRootCategory", ";", "@", "@", "-", "167", ",", "7", "+", "167", ",", "7", "@", "@", "<", "f", ":", "entry", "title", "=", "\"", "Testlab", "API", "key", "\"", "description", "=", "\"", "Testlab", "API", "key", "to", "use", "for", "security", ".", "Overrides", "default", "setting", "set", "in", "Manage", "Jenkins", ">", "Configure", "System", ".", "\"", "field", "=", "\"", "apiKey", "\"", ">", "<", "f", ":", "textbox", "clazz", "=", "\"", "required", "\"", "/", ">", "<", "f", ":", "password", "clazz", "=", "\"", "required", "\"", "/", ">", "<", "/", "f", ":", "entry", ">", "<", "f", ":", "entry", "title", "=", "\"", "Test", "case", "mapping", "field", "\"", "@", "@", "-", "34", ",", "7", "+", "34", ",", "7", "@", "@", "<", "f", ":", "entry", "title", "=", "\"", "Testlab", "API", "key", "\"", "description", "=", "\"", "Testlab", "API", "key", "to", "use", "for", "security", "\"", "field", "=", "\"", "apiKey", "\"", ">", "<", "f", ":", "textbox", "/", ">", "<", "f", ":", "password", "/", ">", "<", "/", "f", ":", "entry", ">", "<", "f", ":", "entry", "title", "=", "\"", "Test", "case", "mapping", "field", "\"", "@", "@", "-", "6", ",", "6", "+", "6", ",", "7", "@", "@", "import", "hudson", ".", "tasks", ".", "Maven", ";", "import", "hudson", ".", "tasks", ".", "Shell", ";", "import", "hudson", ".", "tasks", ".", "junit", ".", "JUnitResultArchiver", ";", "import", "hudson", ".", "util", ".", "Secret", ";", "import", "org", ".", "apache", ".", "commons", ".", "io", ".", "FileUtils", ";", "import", "org", ".", "junit", ".", "Test", ";", "@", "@", "-", "61", ",", "9", "+", "62", ",", "9", "@", "@", "public", "void", "testSenderFreestyleJob", "(", ")", "throws", "Exception", "{", "TestlabNotifier", ".", "AdvancedSettings", "advancedSettings", ";", "if", "(", "TEST_TESTLABURL", "!", "=", "null", ")", "{", "TestlabNotifier", ".", "Usingonpremise", "usingonpremise", "=", "new", "TestlabNotifier", ".", "Usingonpremise", "(", "TEST_TESTLABURL", ")", ";", "advancedSettings", "=", "new", "TestlabNotifier", ".", "AdvancedSettings", "(", "null", ",", "TEST_APIKEY", ",", "\"", "Automated", "\"", ",", "usingonpremise", ")", ";", "advancedSettings", "=", "new", "TestlabNotifier", ".", "AdvancedSettings", "(", "null", ",", "Secret", ".", "fromString", "(", "TEST_APIKEY", ")", ",", "\"", "Automated", "\"", ",", "usingonpremise", ")", ";", "}", "else", "{", "advancedSettings", "=", "new", "TestlabNotifier", ".", "AdvancedSettings", "(", "TEST_COMPANYID", ",", "TEST_APIKEY", ",", "\"", "Automated", "\"", ",", "null", ")", ";", "advancedSettings", "=", "new", "TestlabNotifier", ".", "AdvancedSettings", "(", "TEST_COMPANYID", ",", "Secret", ".", "fromString", "(", "TEST_APIKEY", ")", ",", "\"", "Automated", "\"", ",", "null", ")", ";", "}", "/", "//", "/", "setup", "a", "new", "project", "and", "build", "it", "@", "@", "-", "3", ",", "6", "+", "3", ",", "7", "@", "@", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "html", ".", "*;", "import", "fi", ".", "meliora", ".", "testlab", ".", "ext", ".", "jenkins", ".", "TestlabNotifier", ";", "import", "hudson", ".", "model", ".", "FreeStyleProject", ";", "import", "hudson", ".", "util", ".", "Secret", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "JenkinsRule", ";", "@", "@", "-", "35", ",", "7", "+", "36", ",", "7", "@", "@", "public", "void", "testGlobalSettings", "(", ")", "throws", "Exception", "{", "HtmlTextInput", "companyIdInput", "=", "form", ".", "getInputByName", "(", "FIELD_COMPANYID", ")", ";", "HtmlCheckBoxInput", "usingonpremiseInput", "=", "form", ".", "getInputByName", "(", "FIELD_USINGONPREMISE", ")", ";", "HtmlTextInput", "onpremiseurlInput", "=", "form", ".", "getInputByName", "(", "FIELD_ONPREMISEURL", ")", ";", "HtmlTextInput", "apiKeyInput", "=", "form", ".", "getInputByName", "(", "FIELD_APIKEY", ")", ";", "HtmlPasswordInput", "apiKeyInput", "=", "form", ".", "getInputByName", "(", "FIELD_APIKEY", ")", ";", "HtmlTextInput", "testCaseMappingFieldInput", "=", "form", ".", "getInputByName", "(", "FIELD_TESTCASEMAPPINGFIELD", ")", ";", "HtmlCheckBoxInput", "corsInput", "=", "form", ".", "getInputByName", "(", "FIELD_CORS", ")", ";", "HtmlTextInput", "originsInput", "=", "form", ".", "getInputByName", "(", "FIELD_ORIGIN", ")", ";", "@", "@", "-", "72", ",", "7", "+", "73", ",", "7", "@", "@", "public", "void", "testGlobalSettings", "(", ")", "throws", "Exception", "{", "assertHasValue", "(", "companyIdInput", ",", "\"", "unittestcompany", "\"", ");", "assertChecked", "(", "usingonpremiseInput", ",", "true", ")", ";", "assertHasValue", "(", "onpremiseurlInput", ",", "\"", "https", ":", "//", "unittesthost", ":", "8080", "\"", ");", "assertHasValue", "(", "apiKeyInput", ",", "\"", "1010101010202020", "\"", ");", "assertHasValue", "(", "apiKeyInput", ",", "Secret", ".", "fromString", "(", "\"", "1010101010202020", "\"", ").", "getEncryptedValue", "(", "))", ";", "assertHasValue", "(", "testCaseMappingFieldInput", ",", "\"", "Some", "field", "\"", ");", "assertChecked", "(", "corsInput", ",", "true", ")", ";", "assertHasValue", "(", "originsInput", ",", "\"", "http", ":", "//", "somehost", ",", "http", ":", "//", "anotherhost", "\"", ");", "@", "@", "-", "122", ",", "7", "+", "123", ",", "7", "@", "@", "public", "void", "testJobSettings", "(", ")", "throws", "Exception", "{", "HtmlTextInput", "companyIdInput", "=", "form", ".", "getInputByName", "(", "FIELD_COMPANYID", ")", ";", "HtmlCheckBoxInput", "usingonpremiseInput", "=", "form", ".", "getInputByName", "(", "FIELD_USINGONPREMISE", ")", ";", "HtmlTextInput", "onpremiseurlInput", "=", "form", ".", "getInputByName", "(", "FIELD_ONPREMISEURL", ")", ";", "HtmlTextInput", "apiKeyInput", "=", "form", ".", "getInputByName", "(", "FIELD_APIKEY", ")", ";", "HtmlPasswordInput", "apiKeyInput", "=", "form", ".", "getInputByName", "(", "FIELD_APIKEY", ")", ";", "HtmlTextInput", "testCaseMappingFieldInput", "=", "form", ".", "getInputByName", "(", "FIELD_TESTCASEMAPPINGFIELD", ")", ";", "HtmlTextArea", "commentInput", "=", "form", ".", "getTextAreaByName", "(", "FIELD_COMMENT", ")", ";", "HtmlTextInput", "tagsInput", "=", "form", ".", "getInputByName", "(", "FIELD_TAGS", ")", ";", "@", "@", "-", "395", ",", "7", "+", "396", ",", "7", "@", "@", "public", "void", "testJobSettings", "(", ")", "throws", "Exception", "{", "assertHasValue", "(", "companyIdInput", ",", "\"", "unittestcompanyjob", "\"", ");", "assertChecked", "(", "usingonpremiseInput", ",", "true", ")", ";", "assertHasValue", "(", "onpremiseurlInput", ",", "\"", "https", ":", "//", "unittesthost", ":", "8080", "\"", ");", "assertHasValue", "(", "apiKeyInput", ",", "\"", "1010101010303030", "\"", ");", "assertHasValue", "(", "apiKeyInput", ",", "Secret", ".", "fromString", "(", "\"", "1010101010303030", "\"", ").", "getEncryptedValue", "(", "))", ";", "assertHasValue", "(", "testCaseMappingFieldInput", ",", "\"", "Other", "field", "\"", ");", "assertChecked", "(", "publishTapInput", ",", "true", ")", ";", "@", "@", "-", "77", ",", "7", "+", "77", ",", "7", "@", "@", "protected", "void", "assertEmpty", "(", "HtmlInput", "input", ")", "{", "*", "@", "param", "value", "*", "/", "protected", "void", "assertHasValue", "(", "HtmlInput", "input", ",", "String", "value", ")", "{", "assertTrue", "(", "input", ".", "getNameAttribute", "(", ")", "+", "\"", "value", "was", "not", "\"", "+", "value", ",", "value", ".", "equals", "(", "input", ".", "getValueAttribute", "(", "))", ");", "assertTrue", "(", "input", ".", "getNameAttribute", "(", ")", "+", "\"", "value", "was", "not", "\"", "+", "value", "+", "\"", ":", "was", "\"", "+", "input", ".", "getValueAttribute", "(", "),", "value", ".", "equals", "(", "input", ".", "getValueAttribute", "(", "))", ");", "}", "/", "**", "@", "@", "-", "87", ",", "7", "+", "87", ",", "7", "@", "@", "protected", "void", "assertHasValue", "(", "HtmlInput", "input", ",", "String", "value", ")", "{", "*", "@", "param", "value", "*", "/", "protected", "void", "assertHasValue", "(", "HtmlTextArea", "textArea", ",", "String", "value", ")", "{", "assertTrue", "(", "textArea", ".", "getNameAttribute", "(", ")", "+", "\"", "value", "was", "not", "\"", "+", "value", ",", "value", ".", "equals", "(", "textArea", ".", "getText", "(", "))", ");", "assertTrue", "(", "textArea", ".", "getNameAttribute", "(", ")", "+", "\"", "value", "was", "not", "\"", "+", "value", "+", "\"", ":", "was", "\"", "+", "textArea", ".", "getText", "(", "),", "value", ".", "equals", "(", "textArea", ".", "getText", "(", "))", ");", "}", "/", "**"], "docstring_tokens": ["using", "attacker", "specified", "credentials"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "102", ",", "6", "+", "102", ",", "7", "@", "@", "static", "int", "ext3_readdir", "(", "struct", "file", "*", "filp", ",", "int", "err", ";", "struct", "inode", "*", "inode", "=", "filp", "-", ">", "f_path", ".", "dentry", "-", ">", "d_inode", ";", "int", "ret", "=", "0", ";", "int", "dir_has_error", "=", "0", ";", "sb", "=", "inode", "-", ">", "i_sb", ";", "@", "@", "-", "148", ",", "9", "+", "149", ",", "12", "@", "@", "static", "int", "ext3_readdir", "(", "struct", "file", "*", "filp", ",", "*", "of", "recovering", "data", "when", "there", "'", "s", "a", "bad", "sector", "*", "/", "if", "(", "!", "bh", ")", "{", "ext3_error", "(", "sb", ",", "\"", "ext3_readdir", "\"", ",", "\"", "directory", "#", "%", "lu", "contains", "a", "hole", "at", "offset", "%", "lu", "\"", ",", "inode", "-", ">", "i_ino", ",", "(", "unsigned", "long", ")", "filp", "-", ">", "f_pos", ")", ";", "if", "(", "!", "dir_has_error", ")", "{", "ext3_error", "(", "sb", ",", "__func__", ",", "\"", "directory", "#", "%", "lu", "\"", "\"", "contains", "a", "hole", "at", "offset", "%", "lld", "\"", ",", "inode", "-", ">", "i_ino", ",", "filp", "-", ">", "f_pos", ")", ";", "dir_has_error", "=", "1", ";", "}", "/", "*", "corrupt", "size", "?", "Maybe", "no", "more", "blocks", "to", "read", "*", "/", "if", "(", "filp", "-", ">", "f_pos", ">", "inode", "-", ">", "i_blocks", "<", "<", "9", ")", "break", ";"], "docstring_tokens": ["performing", "either", "a", "read", "or", "write", "operation", "on", "the", "mounted", "image", "or", "partition"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "927", ",", "14", "+", "927", ",", "13", "@", "@", "enum", "lru_status", "binder_alloc_free_page", "(", "struct", "list_head", "*", "item", ",", "index", "=", "page", "-", "alloc", "-", ">", "pages", ";", "page_addr", "=", "(", "uintptr_t", ")", "alloc", "-", ">", "buffer", "+", "index", "*", "PAGE_SIZE", ";", "mm", "=", "alloc", "-", ">", "vma_vm_mm", ";", "if", "(", "!", "mmget_not_zero", "(", "mm", ")", ")", "goto", "err_mmget", ";", "if", "(", "!", "down_write_trylock", "(", "&", "mm", "-", ">", "mmap_sem", ")", ")", "goto", "err_down_write_mmap_sem_failed", ";", "vma", "=", "binder_alloc_get_vma", "(", "alloc", ")", ";", "if", "(", "vma", ")", "{", "if", "(", "!", "mmget_not_zero", "(", "alloc", "-", ">", "vma_vm_mm", ")", ")", "goto", "err_mmget", ";", "mm", "=", "alloc", "-", ">", "vma_vm_mm", ";", "if", "(", "!", "down_read_trylock", "(", "&", "mm", "-", ">", "mmap_sem", ")", ")", "goto", "err_down_write_mmap_sem_failed", ";", "}", "list_lru_isolate", "(", "lru", ",", "item", ")", ";", "spin_unlock", "(", "lock", ")", ";", "@", "@", "-", "945", ",", "10", "+", "944", ",", "9", "@", "@", "enum", "lru_status", "binder_alloc_free_page", "(", "struct", "list_head", "*", "item", ",", "zap_page_range", "(", "vma", ",", "page_addr", ",", "PAGE_SIZE", ")", ";", "trace_binder_unmap_user_end", "(", "alloc", ",", "index", ")", ";", "up_read", "(", "&", "mm", "-", ">", "mmap_sem", ")", ";", "mmput", "(", "mm", ")", ";", "}", "up_write", "(", "&", "mm", "-", ">", "mmap_sem", ")", ";", "mmput", "(", "mm", ")", ";", "trace_binder_unmap_kernel_start", "(", "alloc", ",", "index", ")", ";"], "docstring_tokens": ["executing", "a", "specially-crafted", "application"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "427", ",", "6", "+", "427", ",", "14", "@", "@", "int", "git_pkt_parse_line", "(", "if", "(", "bufflen", ">", "0", "&", "&", "bufflen", "<", "(", "size_t", ")", "len", ")", "return", "GIT_EBUFS", ";", "/", "*", "*", "The", "length", "has", "to", "be", "exactly", "0", "in", "case", "of", "a", "flush", "*", "packet", "or", "greater", "than", "PKT_LEN_SIZE", ",", "as", "the", "decoded", "*", "length", "includes", "its", "own", "encoded", "length", "of", "four", "bytes", ".", "*", "/", "if", "(", "len", "!", "=", "0", "&", "&", "len", "<", "PKT_LEN_SIZE", ")", "return", "GIT_ERROR", ";", "line", "+", "=", "PKT_LEN_SIZE", ";", "/", "*", "*", "TODO", ":", "How", "do", "we", "deal", "with", "empty", "lines", "?", "Try", "again", "?", "with", "the", "next"], "docstring_tokens": ["using", "a", "specially-crafted", "non-flush", "packet"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "34", ",", "6", "+", "34", ",", "7", "@", "@", "import", "org", ".", "kohsuke", ".", "stapler", ".", "export", ".", "Exported", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "export", ".", "ExportedBean", ";", "import", "com", ".", "thoughtworks", ".", "xstream", ".", "converters", ".", "UnmarshallingContext", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "javax", ".", "annotation", ".", "CheckForNull", ";", "@", "@", "-", "371", ",", "10", "+", "372", ",", "13", "@", "@", "public", "RemoteCause", "(", "String", "host", ",", "String", "note", ")", "{", "@", "Override", "public", "String", "getShortDescription", "(", ")", "{", "if", "(", "note", "!", "=", "null", ")", "{", "return", "Messages", ".", "Cause_RemoteCause_ShortDescriptionWithNote", "(", "addr", ",", "note", ")", ";", "}", "else", "{", "return", "Messages", ".", "Cause_RemoteCause_ShortDescription", "(", "addr", ")", ";", "try", "{", "return", "Messages", ".", "Cause_RemoteCause_ShortDescriptionWithNote", "(", "addr", ",", "Jenkins", ".", "getInstance", "(", ").", "getMarkupFormatter", "(", ").", "translate", "(", "note", ")", ");", "}", "catch", "(", "IOException", "x", ")", "{", "/", "/", "ignore", "}", "}", "return", "Messages", ".", "Cause_RemoteCause_ShortDescription", "(", "addr", ")", ";", "}", "@", "Override"], "docstring_tokens": ["via", "a", "\"remote", "cause", "note.\""]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "138", ",", "6", "+", "138", ",", "11", "@", "@", "struct", "key_restriction", "{", "struct", "key_type", "*", "keytype", ";", "}", ";", "enum", "key_state", "{", "KEY_IS_UNINSTANTIATED", ",", "KEY_IS_POSITIVE", ",", "/", "*", "Positively", "instantiated", "*", "/", "}", ";", "/", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*/", "/", "*", "*", "authentication", "token", "/", "access", "credential", "/", "keyring", "@", "@", "-", "169", ",", "25", "+", "174", ",", "24", "@", "@", "struct", "key", "{", "*", "-", "may", "not", "match", "RCU", "dereferenced", "payload", "*", "-", "payload", "should", "contain", "own", "length", "*", "/", "short", "state", ";", "/", "*", "Key", "state", "(", "+)", "or", "rejection", "error", "(", "-)", "*", "/", "#", "ifdef", "KEY_DEBUGGING", "unsigned", "magic", ";", "#", "define", "KEY_DEBUG_MAGIC", "0x18273645u", "#", "endif", "unsigned", "long", "flags", ";", "/", "*", "status", "flags", "(", "change", "with", "bitops", ")", "*", "/", "#", "define", "KEY_FLAG_INSTANTIATED", "0", "/", "*", "set", "if", "key", "has", "been", "instantiated", "*", "/", "#", "define", "KEY_FLAG_DEAD", "1", "/", "*", "set", "if", "key", "type", "has", "been", "deleted", "*", "/", "#", "define", "KEY_FLAG_REVOKED", "2", "/", "*", "set", "if", "key", "had", "been", "revoked", "*", "/", "#", "define", "KEY_FLAG_IN_QUOTA", "3", "/", "*", "set", "if", "key", "consumes", "quota", "*", "/", "#", "define", "KEY_FLAG_USER_CONSTRUCT", "4", "/", "*", "set", "if", "key", "is", "being", "constructed", "in", "userspace", "*", "/", "#", "define", "KEY_FLAG_NEGATIVE", "5", "/", "*", "set", "if", "key", "is", "negative", "*", "/", "#", "define", "KEY_FLAG_ROOT_CAN_CLEAR", "6", "/", "*", "set", "if", "key", "can", "be", "cleared", "by", "root", "without", "permission", "*", "/", "#", "define", "KEY_FLAG_INVALIDATED", "7", "/", "*", "set", "if", "key", "has", "been", "invalidated", "*", "/", "#", "define", "KEY_FLAG_BUILTIN", "8", "/", "*", "set", "if", "key", "is", "built", "in", "to", "the", "kernel", "*", "/", "#", "define", "KEY_FLAG_ROOT_CAN_INVAL", "9", "/", "*", "set", "if", "key", "can", "be", "invalidated", "by", "root", "without", "permission", "*", "/", "#", "define", "KEY_FLAG_KEEP", "10", "/", "*", "set", "if", "key", "should", "not", "be", "removed", "*", "/", "#", "define", "KEY_FLAG_UID_KEYRING", "11", "/", "*", "set", "if", "key", "is", "a", "user", "or", "user", "session", "keyring", "*", "/", "#", "define", "KEY_FLAG_DEAD", "0", "/", "*", "set", "if", "key", "type", "has", "been", "deleted", "*", "/", "#", "define", "KEY_FLAG_REVOKED", "1", "/", "*", "set", "if", "key", "had", "been", "revoked", "*", "/", "#", "define", "KEY_FLAG_IN_QUOTA", "2", "/", "*", "set", "if", "key", "consumes", "quota", "*", "/", "#", "define", "KEY_FLAG_USER_CONSTRUCT", "3", "/", "*", "set", "if", "key", "is", "being", "constructed", "in", "userspace", "*", "/", "#", "define", "KEY_FLAG_ROOT_CAN_CLEAR", "4", "/", "*", "set", "if", "key", "can", "be", "cleared", "by", "root", "without", "permission", "*", "/", "#", "define", "KEY_FLAG_INVALIDATED", "5", "/", "*", "set", "if", "key", "has", "been", "invalidated", "*", "/", "#", "define", "KEY_FLAG_BUILTIN", "6", "/", "*", "set", "if", "key", "is", "built", "in", "to", "the", "kernel", "*", "/", "#", "define", "KEY_FLAG_ROOT_CAN_INVAL", "7", "/", "*", "set", "if", "key", "can", "be", "invalidated", "by", "root", "without", "permission", "*", "/", "#", "define", "KEY_FLAG_KEEP", "8", "/", "*", "set", "if", "key", "should", "not", "be", "removed", "*", "/", "#", "define", "KEY_FLAG_UID_KEYRING", "9", "/", "*", "set", "if", "key", "is", "a", "user", "or", "user", "session", "keyring", "*", "/", "/", "*", "the", "key", "type", "and", "key", "description", "string", "*", "-", "the", "desc", "is", "used", "to", "match", "a", "key", "against", "search", "criteria", "@", "@", "-", "213", ",", "7", "+", "217", ",", "6", "@", "@", "struct", "key", "{", "struct", "list_head", "name_link", ";", "struct", "assoc_array", "keys", ";", "}", ";", "int", "reject_error", ";", "}", ";", "/", "*", "This", "is", "set", "on", "a", "keyring", "to", "restrict", "the", "addition", "of", "a", "link", "to", "a", "key", "@", "@", "-", "353", ",", "17", "+", "356", ",", "27", "@", "@", "extern", "void", "key_set_timeout", "(", "struct", "key", "*", ",", "unsigned", ")", ";", "#", "define", "KEY_NEED_SETATTR", "0x20", "/", "*", "Require", "permission", "to", "change", "attributes", "*", "/", "#", "define", "KEY_NEED_ALL", "0x3f", "/", "*", "All", "the", "above", "permissions", "*", "/", "static", "inline", "short", "key_read_state", "(", "const", "struct", "key", "*", "key", ")", "{", "/", "*", "Barrier", "versus", "mark_key_instantiated", "(", ").", "*", "/", "return", "smp_load_acquire", "(", "&", "key", "-", ">", "state", ")", ";", "}", "/", "**", "*", "key_is_instantiated", "-", "Determine", "if", "a", "key", "has", "been", "positively", "instantiated", "*", "key_is_positive", "-", "Determine", "if", "a", "key", "has", "been", "positively", "instantiated", "*", "@", "key", ":", "The", "key", "to", "check", ".", "*", "*", "Return", "true", "if", "the", "specified", "key", "has", "been", "positively", "instantiated", ",", "false", "*", "otherwise", ".", "*", "/", "static", "inline", "bool", "key_is_instantiated", "(", "const", "struct", "key", "*", "key", ")", "static", "inline", "bool", "key_is_positive", "(", "const", "struct", "key", "*", "key", ")", "{", "return", "key_read_state", "(", "key", ")", "=", "=", "KEY_IS_POSITIVE", ";", "}", "static", "inline", "bool", "key_is_negative", "(", "const", "struct", "key", "*", "key", ")", "{", "return", "test_bit", "(", "KEY_FLAG_INSTANTIATED", ",", "&", "key", "-", ">", "flags", ")", "&", "&", "!", "test_bit", "(", "KEY_FLAG_NEGATIVE", ",", "&", "key", "-", ">", "flags", ")", ";", "return", "key_read_state", "(", "key", ")", "<", "0", ";", "}", "#", "define", "dereference_key_rcu", "(", "KEY", ")", "\\", "@", "@", "-", "224", ",", "7", "+", "224", ",", "7", "@", "@", "static", "int", "dns_resolver_match_preparse", "(", "struct", "key_match_data", "*", "match_data", ")", "static", "void", "dns_resolver_describe", "(", "const", "struct", "key", "*", "key", ",", "struct", "seq_file", "*", "m", ")", "{", "seq_puts", "(", "m", ",", "key", "-", ">", "description", ")", ";", "if", "(", "key_is_instantiated", "(", "key", ")", ")", "{", "if", "(", "key_is_positive", "(", "key", ")", ")", "{", "int", "err", "=", "PTR_ERR", "(", "key", "-", ">", "payload", ".", "data", "[", "dns_key_error", "]", ");", "if", "(", "err", ")", "@", "@", "-", "247", ",", "7", "+", "247", ",", "7", "@", "@", "void", "big_key_revoke", "(", "struct", "key", "*", "key", ")", "/", "*", "clear", "the", "quota", "*", "/", "key_payload_reserve", "(", "key", ",", "0", ")", ";", "if", "(", "key_is_instantiated", "(", "key", ")", "&", "&", "if", "(", "key_is_positive", "(", "key", ")", "&", "&", "(", "size_t", ")", "key", "-", ">", "payload", ".", "data", "[", "big_key_len", "]", ">", "BIG_KEY_FILE_THRESHOLD", ")", "vfs_truncate", "(", "path", ",", "0", ")", ";", "}", "@", "@", "-", "279", ",", "7", "+", "279", ",", "7", "@", "@", "void", "big_key_describe", "(", "const", "struct", "key", "*", "key", ",", "struct", "seq_file", "*", "m", ")", "seq_puts", "(", "m", ",", "key", "-", ">", "description", ")", ";", "if", "(", "key_is_instantiated", "(", "key", ")", ")", "if", "(", "key_is_positive", "(", "key", ")", ")", "seq_printf", "(", "m", ",", "\"", ":", "%", "zu", "[", "%", "s", "]", "\",", "datalen", ",", "datalen", ">", "BIG_KEY_FILE_THRESHOLD", "?", "\"", "file", "\"", ":", "\"", "buff", "\"", ");", "@", "@", "-", "854", ",", "7", "+", "854", ",", "7", "@", "@", "static", "int", "encrypted_update", "(", "struct", "key", "*", "key", ",", "struct", "key_preparsed_payload", "*", "prep", ")", "size_t", "datalen", "=", "prep", "-", ">", "datalen", ";", "int", "ret", "=", "0", ";", "if", "(", "test_bit", "(", "KEY_FLAG_NEGATIVE", ",", "&", "key", "-", ">", "flags", ")", ")", "if", "(", "key_is_negative", "(", "key", ")", ")", "return", "-", "ENOKEY", ";", "if", "(", "datalen", "<", "=", "0", "|", "|", "datalen", ">", "32767", "|", "|", "!", "prep", "-", ">", "data", ")", "return", "-", "EINVAL", ";", "@", "@", "-", "129", ",", "15", "+", "129", ",", "15", "@", "@", "static", "noinline", "void", "key_gc_unused_keys", "(", "struct", "list_head", "*", "keys", ")", "while", "(", "!", "list_empty", "(", "keys", ")", ")", "{", "struct", "key", "*", "key", "=", "list_entry", "(", "keys", "-", ">", "next", ",", "struct", "key", ",", "graveyard_link", ")", ";", "short", "state", "=", "key", "-", ">", "state", ";", "list_del", "(", "&", "key", "-", ">", "graveyard_link", ")", ";", "kdebug", "(", "\"-", "%", "u", "\"", ",", "key", "-", ">", "serial", ")", ";", "key_check", "(", "key", ")", ";", "/", "*", "Throw", "away", "the", "key", "data", "if", "the", "key", "is", "instantiated", "*", "/", "if", "(", "test_bit", "(", "KEY_FLAG_INSTANTIATED", ",", "&", "key", "-", ">", "flags", ")", "&", "&", "!", "test_bit", "(", "KEY_FLAG_NEGATIVE", ",", "&", "key", "-", ">", "flags", ")", "&", "&", "key", "-", ">", "type", "-", ">", "destroy", ")", "if", "(", "state", "=", "=", "KEY_IS_POSITIVE", "&", "&", "key", "-", ">", "type", "-", ">", "destroy", ")", "key", "-", ">", "type", "-", ">", "destroy", "(", "key", ")", ";", "security_key_free", "(", "key", ")", ";", "@", "@", "-", "151", ",", "7", "+", "151", ",", "7", "@", "@", "static", "noinline", "void", "key_gc_unused_keys", "(", "struct", "list_head", "*", "keys", ")", "}", "atomic_dec", "(", "&", "key", "-", ">", "user", "-", ">", "nkeys", ")", ";", "if", "(", "test_bit", "(", "KEY_FLAG_INSTANTIATED", ",", "&", "key", "-", ">", "flags", ")", ")", "if", "(", "state", "!", "=", "KEY_IS_UNINSTANTIATED", ")", "atomic_dec", "(", "&", "key", "-", ">", "user", "-", ">", "nikeys", ")", ";", "key_user_put", "(", "key", "-", ">", "user", ")", ";", "@", "@", "-", "401", ",", "6", "+", "401", ",", "18", "@", "@", "int", "key_payload_reserve", "(", "struct", "key", "*", "key", ",", "size_t", "datalen", ")", "}", "EXPORT_SYMBOL", "(", "key_payload_reserve", ")", ";", "/", "*", "*", "Change", "the", "key", "state", "to", "being", "instantiated", ".", "*", "/", "static", "void", "mark_key_instantiated", "(", "struct", "key", "*", "key", ",", "int", "reject_error", ")", "{", "/", "*", "Commit", "the", "payload", "before", "setting", "the", "state", ";", "barrier", "versus", "*", "key_read_state", "(", ").", "*", "/", "smp_store_release", "(", "&", "key", "-", ">", "state", ",", "(", "reject_error", "<", "0", ")", "?", "reject_error", ":", "KEY_IS_POSITIVE", ")", ";", "}", "/", "*", "*", "Instantiate", "a", "key", "and", "link", "it", "into", "the", "target", "keyring", "atomically", ".", "Must", "be", "*", "called", "with", "the", "target", "keyring", "'", "s", "semaphore", "writelocked", ".", "The", "target", "key", "'", "s", "@", "@", "-", "424", ",", "14", "+", "436", ",", "14", "@", "@", "static", "int", "__key_instantiate_and_link", "(", "struct", "key", "*", "key", ",", "mutex_lock", "(", "&", "key_construction_mutex", ")", ";", "/", "*", "can", "'", "t", "instantiate", "twice", "*", "/", "if", "(", "!", "test_bit", "(", "KEY_FLAG_INSTANTIATED", ",", "&", "key", "-", ">", "flags", ")", ")", "{", "if", "(", "key", "-", ">", "state", "=", "=", "KEY_IS_UNINSTANTIATED", ")", "{", "/", "*", "instantiate", "the", "key", "*", "/", "ret", "=", "key", "-", ">", "type", "-", ">", "instantiate", "(", "key", ",", "prep", ")", ";", "if", "(", "ret", "=", "=", "0", ")", "{", "/", "*", "mark", "the", "key", "as", "being", "instantiated", "*", "/", "atomic_inc", "(", "&", "key", "-", ">", "user", "-", ">", "nikeys", ")", ";", "set_bit", "(", "KEY_FLAG_INSTANTIATED", ",", "&", "key", "-", ">", "flags", ")", ";", "mark_key_instantiated", "(", "key", ",", "0", ")", ";", "if", "(", "test_and_clear_bit", "(", "KEY_FLAG_USER_CONSTRUCT", ",", "&", "key", "-", ">", "flags", ")", ")", "awaken", "=", "1", ";", "@", "@", "-", "577", ",", "13", "+", "589", ",", "10", "@", "@", "int", "key_reject_and_link", "(", "struct", "key", "*", "key", ",", "mutex_lock", "(", "&", "key_construction_mutex", ")", ";", "/", "*", "can", "'", "t", "instantiate", "twice", "*", "/", "if", "(", "!", "test_bit", "(", "KEY_FLAG_INSTANTIATED", ",", "&", "key", "-", ">", "flags", ")", ")", "{", "if", "(", "key", "-", ">", "state", "=", "=", "KEY_IS_UNINSTANTIATED", ")", "{", "/", "*", "mark", "the", "key", "as", "being", "negatively", "instantiated", "*", "/", "atomic_inc", "(", "&", "key", "-", ">", "user", "-", ">", "nikeys", ")", ";", "key", "-", ">", "reject_error", "=", "-", "error", ";", "smp_wmb", "(", ");", "set_bit", "(", "KEY_FLAG_NEGATIVE", ",", "&", "key", "-", ">", "flags", ")", ";", "set_bit", "(", "KEY_FLAG_INSTANTIATED", ",", "&", "key", "-", ">", "flags", ")", ";", "mark_key_instantiated", "(", "key", ",", "-", "error", ")", ";", "now", "=", "current_kernel_time", "(", ");", "key", "-", ">", "expiry", "=", "now", ".", "tv_sec", "+", "timeout", ";", "key_schedule_gc", "(", "key", "-", ">", "expiry", "+", "key_gc_delay", ")", ";", "@", "@", "-", "752", ",", "8", "+", "761", ",", "8", "@", "@", "static", "inline", "key_ref_t", "__key_update", "(", "key_ref_t", "key_ref", ",", "ret", "=", "key", "-", ">", "type", "-", ">", "update", "(", "key", ",", "prep", ")", ";", "if", "(", "ret", "=", "=", "0", ")", "/", "*", "updating", "a", "negative", "key", "instantiates", "it", "*", "/", "clear_bit", "(", "KEY_FLAG_NEGATIVE", ",", "&", "key", "-", ">", "flags", ")", ";", "/", "*", "Updating", "a", "negative", "key", "positively", "instantiates", "it", "*", "/", "mark_key_instantiated", "(", "key", ",", "0", ")", ";", "up_write", "(", "&", "key", "-", ">", "sem", ")", ";", "@", "@", "-", "986", ",", "8", "+", "995", ",", "8", "@", "@", "int", "key_update", "(", "key_ref_t", "key_ref", ",", "const", "void", "*", "payload", ",", "size_t", "plen", ")", "ret", "=", "key", "-", ">", "type", "-", ">", "update", "(", "key", ",", "&", "prep", ")", ";", "if", "(", "ret", "=", "=", "0", ")", "/", "*", "updating", "a", "negative", "key", "instantiates", "it", "*", "/", "clear_bit", "(", "KEY_FLAG_NEGATIVE", ",", "&", "key", "-", ">", "flags", ")", ";", "/", "*", "Updating", "a", "negative", "key", "positively", "instantiates", "it", "*", "/", "mark_key_instantiated", "(", "key", ",", "0", ")", ";", "up_write", "(", "&", "key", "-", ">", "sem", ")", ";", "@", "@", "-", "766", ",", "10", "+", "766", ",", "9", "@", "@", "long", "keyctl_read_key", "(", "key_serial_t", "keyid", ",", "char", "__user", "*", "buffer", ",", "size_t", "buflen", ")", "key", "=", "key_ref_to_ptr", "(", "key_ref", ")", ";", "if", "(", "test_bit", "(", "KEY_FLAG_NEGATIVE", ",", "&", "key", "-", ">", "flags", ")", ")", "{", "ret", "=", "-", "ENOKEY", ";", "goto", "error2", ";", "}", "ret", "=", "key_read_state", "(", "key", ")", ";", "if", "(", "ret", "<", "0", ")", "goto", "error2", ";", "/", "*", "Negatively", "instantiated", "*", "/", "/", "*", "see", "if", "we", "can", "read", "it", "directly", "*", "/", "ret", "=", "key_permission", "(", "key_ref", ",", "KEY_NEED_READ", ")", ";", "@", "@", "-", "901", ",", "7", "+", "900", ",", "7", "@", "@", "long", "keyctl_chown_key", "(", "key_serial_t", "id", ",", "uid_t", "user", ",", "gid_t", "group", ")", "atomic_dec", "(", "&", "key", "-", ">", "user", "-", ">", "nkeys", ")", ";", "atomic_inc", "(", "&", "newowner", "-", ">", "nkeys", ")", ";", "if", "(", "test_bit", "(", "KEY_FLAG_INSTANTIATED", ",", "&", "key", "-", ">", "flags", ")", ")", "{", "if", "(", "key", "-", ">", "state", "!", "=", "KEY_IS_UNINSTANTIATED", ")", "{", "atomic_dec", "(", "&", "key", "-", ">", "user", "-", ">", "nikeys", ")", ";", "atomic_inc", "(", "&", "newowner", "-", ">", "nikeys", ")", ";", "}", "@", "@", "-", "414", ",", "7", "+", "414", ",", "7", "@", "@", "static", "void", "keyring_describe", "(", "const", "struct", "key", "*", "keyring", ",", "struct", "seq_file", "*", "m", ")", "else", "seq_puts", "(", "m", ",", "\"", "[", "anon", "]", "\")", ";", "if", "(", "key_is_instantiated", "(", "keyring", ")", ")", "{", "if", "(", "key_is_positive", "(", "keyring", ")", ")", "{", "if", "(", "keyring", "-", ">", "keys", ".", "nr_leaves_on_tree", "!", "=", "0", ")", "seq_printf", "(", "m", ",", "\"", ":", "%", "lu", "\"", ",", "keyring", "-", ">", "keys", ".", "nr_leaves_on_tree", ")", ";", "else", "@", "@", "-", "553", ",", "7", "+", "553", ",", "8", "@", "@", "static", "int", "keyring_search_iterator", "(", "const", "void", "*", "object", ",", "void", "*", "iterator_data", ")", "{", "struct", "keyring_search_context", "*", "ctx", "=", "iterator_data", ";", "const", "struct", "key", "*", "key", "=", "keyring_ptr_to_key", "(", "object", ")", ";", "unsigned", "long", "kflags", "=", "key", "-", ">", "flags", ";", "unsigned", "long", "kflags", "=", "READ_ONCE", "(", "key", "-", ">", "flags", ")", ";", "short", "state", "=", "READ_ONCE", "(", "key", "-", ">", "state", ")", ";", "kenter", "(", "\"{", "%", "d", "}", "\",", "key", "-", ">", "serial", ")", ";", "@", "@", "-", "597", ",", "9", "+", "598", ",", "8", "@", "@", "static", "int", "keyring_search_iterator", "(", "const", "void", "*", "object", ",", "void", "*", "iterator_data", ")", "if", "(", "ctx", "-", ">", "flags", "&", "KEYRING_SEARCH_DO_STATE_CHECK", ")", "{", "/", "*", "we", "set", "a", "different", "error", "code", "if", "we", "pass", "a", "negative", "key", "*", "/", "if", "(", "kflags", "&", "(", "1", "<", "<", "KEY_FLAG_NEGATIVE", ")", ")", "{", "smp_rmb", "(", ");", "ctx", "-", ">", "result", "=", "ERR_PTR", "(", "key", "-", ">", "reject_error", ")", ";", "if", "(", "state", "<", "0", ")", "{", "ctx", "-", ">", "result", "=", "ERR_PTR", "(", "state", ")", ";", "kleave", "(", "\"", "=", "%", "d", "[", "neg", "]", "\",", "ctx", "-", ">", "skipped_ret", ")", ";", "goto", "skipped", ";", "}", "@", "@", "-", "182", ",", "6", "+", "182", ",", "7", "@", "@", "static", "int", "proc_keys_show", "(", "struct", "seq_file", "*", "m", ",", "void", "*", "v", ")", "unsigned", "long", "timo", ";", "key_ref_t", "key_ref", ",", "skey_ref", ";", "char", "xbuf", "[", "16", "]", ";", "short", "state", ";", "int", "rc", ";", "struct", "keyring_search_context", "ctx", "=", "{", "@", "@", "-", "236", ",", "17", "+", "237", ",", "19", "@", "@", "static", "int", "proc_keys_show", "(", "struct", "seq_file", "*", "m", ",", "void", "*", "v", ")", "sprintf", "(", "xbuf", ",", "\"", "%", "luw", "\"", ",", "timo", "/", "(", "60", "*", "60", "*", "24", "*", "7", ")", ");", "}", "state", "=", "key_read_state", "(", "key", ")", ";", "#", "define", "showflag", "(", "KEY", ",", "LETTER", ",", "FLAG", ")", "\\", "(", "test_bit", "(", "FLAG", ",", "&", "(", "KEY", ")", "->", "flags", ")", "?", "LETTER", ":", "'", "-'", ")", "seq_printf", "(", "m", ",", "\"", "%", "08x", "%", "c", "%", "c", "%", "c", "%", "c", "%", "c", "%", "c", "%", "c", "%", "5d", "%", "4s", "%", "08x", "%", "5d", "%", "5d", "%", "-", "9", ".", "9s", "\"", ",", "key", "-", ">", "serial", ",", "showflag", "(", "key", ",", "'", "I", "'", ",", "KEY_FLAG_INSTANTIATED", ")", ",", "state", "!", "=", "KEY_IS_UNINSTANTIATED", "?", "'", "I", "'", ":", "'", "-'", ",", "showflag", "(", "key", ",", "'", "R", "'", ",", "KEY_FLAG_REVOKED", ")", ",", "showflag", "(", "key", ",", "'", "D", "'", ",", "KEY_FLAG_DEAD", ")", ",", "showflag", "(", "key", ",", "'", "Q", "'", ",", "KEY_FLAG_IN_QUOTA", ")", ",", "showflag", "(", "key", ",", "'", "U", "'", ",", "KEY_FLAG_USER_CONSTRUCT", ")", ",", "showflag", "(", "key", ",", "'", "N", "'", ",", "KEY_FLAG_NEGATIVE", ")", ",", "state", "<", "0", "?", "'", "N", "'", ":", "'", "-'", ",", "showflag", "(", "key", ",", "'", "i", "'", ",", "KEY_FLAG_INVALIDATED", ")", ",", "refcount_read", "(", "&", "key", "-", ">", "usage", ")", ",", "xbuf", ",", "@", "@", "-", "730", ",", "7", "+", "730", ",", "7", "@", "@", "key_ref_t", "lookup_user_key", "(", "key_serial_t", "id", ",", "unsigned", "long", "lflags", ",", "ret", "=", "-", "EIO", ";", "if", "(", "!(", "lflags", "&", "KEY_LOOKUP_PARTIAL", ")", "&", "&", "!", "test_bit", "(", "KEY_FLAG_INSTANTIATED", ",", "&", "key", "-", ">", "flags", ")", ")", "key_read_state", "(", "key", ")", "=", "=", "KEY_IS_UNINSTANTIATED", ")", "goto", "invalid_key", ";", "/", "*", "check", "the", "permissions", "*", "/", "@", "@", "-", "595", ",", "10", "+", "595", ",", "9", "@", "@", "int", "wait_for_key_construction", "(", "struct", "key", "*", "key", ",", "bool", "intr", ")", "intr", "?", "TASK_INTERRUPTIBLE", ":", "TASK_UNINTERRUPTIBLE", ")", ";", "if", "(", "ret", ")", "return", "-", "ERESTARTSYS", ";", "if", "(", "test_bit", "(", "KEY_FLAG_NEGATIVE", ",", "&", "key", "-", ">", "flags", ")", ")", "{", "smp_rmb", "(", ");", "return", "key", "-", ">", "reject_error", ";", "}", "ret", "=", "key_read_state", "(", "key", ")", ";", "if", "(", "ret", "<", "0", ")", "return", "ret", ";", "return", "key_validate", "(", "key", ")", ";", "}", "EXPORT_SYMBOL", "(", "wait_for_key_construction", ")", ";", "@", "@", "-", "73", ",", "7", "+", "73", ",", "7", "@", "@", "static", "void", "request_key_auth_describe", "(", "const", "struct", "key", "*", "key", ",", "seq_puts", "(", "m", ",", "\"", "key", ":", "\")", ";", "seq_puts", "(", "m", ",", "key", "-", ">", "description", ")", ";", "if", "(", "key_is_instantiated", "(", "key", ")", ")", "if", "(", "key_is_positive", "(", "key", ")", ")", "seq_printf", "(", "m", ",", "\"", "pid", ":", "%", "d", "ci", ":", "%", "zu", "\"", ",", "rka", "-", ">", "pid", ",", "rka", "-", ">", "callout_len", ")", ";", "}", "@", "@", "-", "1066", ",", "7", "+", "1066", ",", "7", "@", "@", "static", "int", "trusted_update", "(", "struct", "key", "*", "key", ",", "struct", "key_preparsed_payload", "*", "prep", ")", "char", "*", "datablob", ";", "int", "ret", "=", "0", ";", "if", "(", "test_bit", "(", "KEY_FLAG_NEGATIVE", ",", "&", "key", "-", ">", "flags", ")", ")", "if", "(", "key_is_negative", "(", "key", ")", ")", "return", "-", "ENOKEY", ";", "p", "=", "key", "-", ">", "payload", ".", "data", "[", "0", "]", ";", "if", "(", "!", "p", "-", ">", "migratable", ")", "@", "@", "-", "114", ",", "7", "+", "114", ",", "7", "@", "@", "int", "user_update", "(", "struct", "key", "*", "key", ",", "struct", "key_preparsed_payload", "*", "prep", ")", "/", "*", "attach", "the", "new", "data", ",", "displacing", "the", "old", "*", "/", "key", "-", ">", "expiry", "=", "prep", "-", ">", "expiry", ";", "if", "(", "!", "test_bit", "(", "KEY_FLAG_NEGATIVE", ",", "&", "key", "-", ">", "flags", ")", ")", "if", "(", "key_is_positive", "(", "key", ")", ")", "zap", "=", "dereference_key_locked", "(", "key", ")", ";", "rcu_assign_keypointer", "(", "key", ",", "prep", "-", ">", "payload", ".", "data", "[", "0", "]", ");", "prep", "-", ">", "payload", ".", "data", "[", "0", "]", "=", "NULL", ";", "@", "@", "-", "162", ",", "7", "+", "162", ",", "7", "@", "@", "EXPORT_SYMBOL_GPL", "(", "user_destroy", ")", ";", "void", "user_describe", "(", "const", "struct", "key", "*", "key", ",", "struct", "seq_file", "*", "m", ")", "{", "seq_puts", "(", "m", ",", "key", "-", ">", "description", ")", ";", "if", "(", "key_is_instantiated", "(", "key", ")", ")", "if", "(", "key_is_positive", "(", "key", ")", ")", "seq_printf", "(", "m", ",", "\"", ":", "%", "u", "\"", ",", "key", "-", ">", "datalen", ")", ";", "}"], "docstring_tokens": ["using", "specially-crafted", "system", "calls"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1009", ",", "6", "+", "1009", ",", "7", "@", "@", "static", "int", "hci_sock_getsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "{", "struct", "hci_filter", "*", "f", "=", "&", "hci_pi", "(", "sk", ")", "->", "filter", ";", "memset", "(", "&", "uf", ",", "0", ",", "sizeof", "(", "uf", ")", ");", "uf", ".", "type_mask", "=", "f", "-", ">", "type_mask", ";", "uf", ".", "opcode", "=", "f", "-", ">", "opcode", ";", "uf", ".", "event_mask", "[", "0", "]", "=", "*", "((", "u32", "*", ")", "f", "-", ">", "event_mask", "+", "0", ")", ";"], "docstring_tokens": ["getsockname"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "30", ",", "6", "+", "30", ",", "7", "@", "@", "#", "include", "<", "linux", "/", "mempolicy", ".", "h", ">", "#", "include", "<", "linux", "/", "vmalloc", ".", "h", ">", "#", "include", "<", "linux", "/", "security", ".", "h", ">", "#", "include", "<", "linux", "/", "backing", "-", "dev", ".", "h", ">", "#", "include", "<", "linux", "/", "syscalls", ".", "h", ">", "#", "include", "<", "linux", "/", "hugetlb", ".", "h", ">", "#", "include", "<", "linux", "/", "hugetlb_cgroup", ".", "h", ">", "@", "@", "-", "313", ",", "6", "+", "314", ",", "8", "@", "@", "int", "migrate_page_move_mapping", "(", "struct", "address_space", "*", "mapping", ",", "struct", "buffer_head", "*", "head", ",", "enum", "migrate_mode", "mode", ",", "int", "extra_count", ")", "{", "struct", "zone", "*", "oldzone", ",", "*", "newzone", ";", "int", "dirty", ";", "int", "expected_count", "=", "1", "+", "extra_count", ";", "void", "*", "*", "pslot", ";", "@", "@", "-", "331", ",", "6", "+", "334", ",", "9", "@", "@", "int", "migrate_page_move_mapping", "(", "struct", "address_space", "*", "mapping", ",", "return", "MIGRATEPAGE_SUCCESS", ";", "}", "oldzone", "=", "page_zone", "(", "page", ")", ";", "newzone", "=", "page_zone", "(", "newpage", ")", ";", "spin_lock_irq", "(", "&", "mapping", "-", ">", "tree_lock", ")", ";", "pslot", "=", "radix_tree_lookup_slot", "(", "&", "mapping", "-", ">", "page_tree", ",", "@", "@", "-", "378", ",", "6", "+", "384", ",", "13", "@", "@", "int", "migrate_page_move_mapping", "(", "struct", "address_space", "*", "mapping", ",", "set_page_private", "(", "newpage", ",", "page_private", "(", "page", ")", ");", "}", "/", "*", "Move", "dirty", "while", "page", "refs", "frozen", "and", "newpage", "not", "yet", "exposed", "*", "/", "dirty", "=", "PageDirty", "(", "page", ")", ";", "if", "(", "dirty", ")", "{", "ClearPageDirty", "(", "page", ")", ";", "SetPageDirty", "(", "newpage", ")", ";", "}", "radix_tree_replace_slot", "(", "pslot", ",", "newpage", ")", ";", "/", "*", "@", "@", "-", "387", ",", "6", "+", "400", ",", "9", "@", "@", "int", "migrate_page_move_mapping", "(", "struct", "address_space", "*", "mapping", ",", "*", "/", "page_unfreeze_refs", "(", "page", ",", "expected_count", "-", "1", ")", ";", "spin_unlock", "(", "&", "mapping", "-", ">", "tree_lock", ")", ";", "/", "*", "Leave", "irq", "disabled", "to", "prevent", "preemption", "while", "updating", "stats", "*", "/", "/", "*", "*", "If", "moved", "to", "a", "different", "zone", "then", "also", "account", "*", "the", "page", "for", "that", "zone", ".", "Other", "VM", "counters", "will", "be", "@", "@", "-", "397", ",", "13", "+", "413", ",", "19", "@", "@", "int", "migrate_page_move_mapping", "(", "struct", "address_space", "*", "mapping", ",", "*", "via", "NR_FILE_PAGES", "and", "NR_ANON_PAGES", "if", "they", "*", "are", "mapped", "to", "swap", "space", ".", "*", "/", "__dec_zone_page_state", "(", "page", ",", "NR_FILE_PAGES", ")", ";", "__inc_zone_page_state", "(", "newpage", ",", "NR_FILE_PAGES", ")", ";", "if", "(", "!", "PageSwapCache", "(", "page", ")", "&", "&", "PageSwapBacked", "(", "page", ")", ")", "{", "__dec_zone_page_state", "(", "page", ",", "NR_SHMEM", ")", ";", "__inc_zone_page_state", "(", "newpage", ",", "NR_SHMEM", ")", ";", "if", "(", "newzone", "!", "=", "oldzone", ")", "{", "__dec_zone_state", "(", "oldzone", ",", "NR_FILE_PAGES", ")", ";", "__inc_zone_state", "(", "newzone", ",", "NR_FILE_PAGES", ")", ";", "if", "(", "PageSwapBacked", "(", "page", ")", "&", "&", "!", "PageSwapCache", "(", "page", ")", ")", "{", "__dec_zone_state", "(", "oldzone", ",", "NR_SHMEM", ")", ";", "__inc_zone_state", "(", "newzone", ",", "NR_SHMEM", ")", ";", "}", "if", "(", "dirty", "&", "&", "mapping_cap_account_dirty", "(", "mapping", ")", ")", "{", "__dec_zone_state", "(", "oldzone", ",", "NR_FILE_DIRTY", ")", ";", "__inc_zone_state", "(", "newzone", ",", "NR_FILE_DIRTY", ")", ";", "}", "}", "spin_unlock_irq", "(", "&", "mapping", "-", ">", "tree_lock", ")", ";", "local_irq_enable", "(", ");", "return", "MIGRATEPAGE_SUCCESS", ";", "}", "@", "@", "-", "524", ",", "20", "+", "546", ",", "9", "@", "@", "void", "migrate_page_copy", "(", "struct", "page", "*", "newpage", ",", "struct", "page", "*", "page", ")", "if", "(", "PageMappedToDisk", "(", "page", ")", ")", "SetPageMappedToDisk", "(", "newpage", ")", ";", "if", "(", "PageDirty", "(", "page", ")", ")", "{", "clear_page_dirty_for_io", "(", "page", ")", ";", "/", "*", "*", "Want", "to", "mark", "the", "page", "and", "the", "radix", "tree", "as", "dirty", ",", "and", "*", "redo", "the", "accounting", "that", "clear_page_dirty_for_io", "undid", ",", "*", "but", "we", "can", "'", "t", "use", "set_page_dirty", "because", "that", "function", "*", "is", "actually", "a", "signal", "that", "all", "of", "the", "page", "has", "become", "dirty", ".", "*", "Whereas", "only", "part", "of", "our", "page", "may", "be", "dirty", ".", "*", "/", "if", "(", "PageSwapBacked", "(", "page", ")", ")", "SetPageDirty", "(", "newpage", ")", ";", "else", "__set_page_dirty_nobuffers", "(", "newpage", ")", ";", "}", "/", "*", "Move", "dirty", "on", "pages", "not", "done", "by", "migrate_page_move_mapping", "(", ")", "*", "/", "if", "(", "PageDirty", "(", "page", ")", ")", "SetPageDirty", "(", "newpage", ")", ";", "if", "(", "page_is_young", "(", "page", ")", ")", "set_page_young", "(", "newpage", ")", ";"], "docstring_tokens": ["by", "triggering", "a", "certain", "page", "move", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "606", ",", "7", "+", "606", ",", "8", "@", "@", "int", "dccp_rcv_state_process", "(", "struct", "sock", "*", "sk", ",", "struct", "sk_buff", "*", "skb", ",", "if", "(", "inet_csk", "(", "sk", ")", "->", "icsk_af_ops", "-", ">", "conn_request", "(", "sk", ",", "skb", ")", "<", "0", ")", "return", "1", ";", "goto", "discard", ";", "consume_skb", "(", "skb", ")", ";", "return", "0", ";", "}", "if", "(", "dh", "-", ">", "dccph_type", "=", "=", "DCCP_PKT_RESET", ")", "goto", "discard", ";"], "docstring_tokens": ["doing", "the", "trick", "I", "mentioned", "in", "the", "previous", "email"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2", ",", "6", "+", "2", ",", "10", "@", "@", "PHP", "NEWS", "|", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "?", "?", "?", "??", "2015", "PHP", "5", ".", "4", ".", "42", "-", "Core", ":", ".", "Imroved", "fix", "for", "bug", "#", "69545", "(", "Integer", "overflow", "in", "ftp_genlist", "(", ")", "resulting", "in", "heap", "overflow", ")", ".", "(", "Max", "Spelsberg", ")", "-", "Postgres", ":", ".", "Fixed", "bug", "#", "69667", "(", "segfault", "in", "php_pgsql_meta_data", ")", ".", "(", "Remi", ")", "@", "@", "-", "1668", ",", "8", "+", "1668", ",", "6", "@", "@", "ftp_genlist", "(", "ftpbuf_t", "*", "ftp", ",", "const", "char", "*", "cmd", ",", "const", "char", "*", "path", "TSRMLS_DC", ")", "for", "(", "ptr", "=", "data", "-", ">", "buf", ";", "rcvd", ";", "rcvd", "-", "-,", "ptr", "+", "+)", "{", "if", "(", "*", "ptr", "=", "=", "'", "\\", "n", "'", "&", "&", "lastch", "=", "=", "'", "\\", "r", "'", ")", "{", "lines", "+", "+;", "}", "else", "{", "size", "+", "+;", "}", "lastch", "=", "*", "ptr", ";", "}"], "docstring_tokens": ["leading", "to", "a", "heap-based", "buffer", "overflow", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1136", ",", "7", "+", "1136", ",", "8", "@", "@", "public", "void", "servletSecurityAnnotationScan", "(", ")", "throws", "ServletException", "{", "if", "(", "getServlet", "(", ")", "=", "=", "null", ")", "{", "Class", "<", "?>", "clazz", "=", "null", ";", "try", "{", "clazz", "=", "getParentClassLoader", "(", ").", "loadClass", "(", "getServletClass", "(", "))", ";", "clazz", "=", "getParent", "(", ").", "getLoader", "(", ").", "getClassLoader", "(", ").", "loadClass", "(", "getServletClass", "(", "))", ";", "processServletSecurityAnnotation", "(", "clazz", ")", ";", "}", "catch", "(", "ClassNotFoundException", "e", ")", "{", "/", "/", "Safe", "to", "ignore", ".", "No", "class", "means", "no", "annotations", "to", "process", "@", "@", "-", "61", ",", "6", "+", "61", ",", "10", "@", "@", "Use", "safe", "equality", "test", "when", "determining", "event", "type", "in", "the", "MapperListener", ".", "(", "markt", ")", "<", "/", "fix", ">", "<", "fix", ">", "Use", "correct", "class", "loader", "when", "loading", "Servlet", "classes", "in", "StandardWrapper", ".", "(", "markt", ")", "<", "/", "fix", ">", "<", "/", "changelog", ">", "<", "/", "subsection", ">", "<", "/", "section", ">"], "docstring_tokens": ["using", "@ServletSecurity", "annotations"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1534", ",", "10", "+", "1534", ",", "6", "@", "@", "public", "int", "getProtocolVersion", "(", ")", "{", "@", "Override", "public", "Response", "processControlCommand", "(", "ControlCommand", "command", ")", "throws", "Exception", "{", "String", "control", "=", "command", ".", "getCommand", "(", ");", "if", "(", "control", "!", "=", "null", "&", "&", "control", ".", "equals", "(", "\"", "shutdown", "\"", "))", "{", "System", ".", "exit", "(", "0", ")", ";", "}", "return", "null", ";", "}"], "docstring_tokens": ["via", "a", "shutdown", "command", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "562", ",", "7", "+", "562", ",", "7", "@", "@", "public", "void", "internalAdd", "(", "final", "Component", "child", ")", "*", "/", "class", "MarkupChildIterator", "implements", "Iterator", "<", "Component", ">", "{", "private", "int", "indexInRemovalsSinceLastUpdate", "=", "removals_size", "(", ");", "private", "int", "indexInRemovalsSinceLastUpdate", ";", "private", "int", "expectedModCounter", "=", "-", "1", ";", "private", "Component", "currentComponent", "=", "null", ";", "private", "Iterator", "<", "Component", ">", "internalIterator", "=", "null", ";", "@", "@", "-", "590", ",", "8", "+", "590", ",", "10", "@", "@", "public", "void", "remove", "(", ")", "private", "void", "refreshInternalIteratorIfNeeded", "(", ")", "{", "if", "(", "expectedModCounter", ">", "=", "modCounter", ")", "if", "(", "expectedModCounter", ">", "=", "modCounter", ")", "{", "/", "/", "no", "new", "modifications", "return", ";", "}", "if", "(", "children", "=", "=", "null", ")", "{", "@", "@", "-", "615", ",", "7", "+", "617", ",", "6", "@", "@", "else", "if", "(", "children", "instanceof", "List", ")", "/", "/", "since", "we", "now", "have", "a", "new", "iterator", ",", "we", "need", "to", "set", "it", "to", "the", "last", "known", "position", "currentComponent", "=", "findLastExistingChildAlreadyReturned", "(", "currentComponent", ")", ";", "expectedModCounter", "=", "modCounter", ";", "indexInRemovalsSinceLastUpdate", "=", "removals_size", "(", ");", "if", "(", "currentComponent", "!", "=", "null", ")", "{", "@", "@", "-", "627", ",", "33", "+", "628", ",", "38", "@", "@", "else", "if", "(", "children", "instanceof", "List", ")", "}", "}", "private", "Component", "findLastExistingChildAlreadyReturned", "(", "Component", "target", ")", "private", "Component", "findLastExistingChildAlreadyReturned", "(", "Component", "current", ")", "{", "while", "(", "true", ")", "{", "if", "(", "target", "=", "=", "null", ")", "return", "null", ";", "RemovedChild", "removedChild", "=", "null", ";", "for", "(", "int", "i", "=", "indexInRemovalsSinceLastUpdate", ";", "i", "<", "removals_size", "(", ");", "i", "+", "+)", "{", "RemovedChild", "curRemovedChild", "=", "removals_get", "(", "i", ")", ";", "if", "(", "curRemovedChild", ".", "removedChild", "=", "=", "target", "|", "|", "curRemovedChild", ".", "removedChild", "=", "=", "null", ")", "if", "(", "current", "=", "=", "null", ")", "{", "indexInRemovalsSinceLastUpdate", "=", "0", ";", "}", "else", "{", "LinkedList", "<", "RemovedChild", ">", "removals", "=", "removals_get", "(", ");", "if", "(", "removals", "!", "=", "null", ")", "{", "check_removed", ":", "while", "(", "current", "!", "=", "null", ")", "{", "removedChild", "=", "curRemovedChild", ";", "for", "(", "int", "i", "=", "indexInRemovalsSinceLastUpdate", ";", "i", "<", "removals", ".", "size", "(", ");", "i", "+", "+)", "{", "RemovedChild", "removal", "=", "removals", ".", "get", "(", "i", ")", ";", "if", "(", "removal", ".", "removedChild", "=", "=", "current", "|", "|", "removal", ".", "removedChild", "=", "=", "null", ")", "{", "current", "=", "removal", ".", "previousSibling", ";", "/", "/", "current", "was", "removed", ",", "use", "its", "sibling", "instead", "continue", "check_removed", ";", "}", "}", "/", "/", "current", "wasn", "'", "t", "removed", ",", "keep", "it", "break", ";", "}", "}", "if", "(", "removedChild", "=", "=", "null", ")", "{", "return", "target", ";", "}", "else", "{", "target", "=", "removedChild", ".", "previousSibling", ";", "indexInRemovalsSinceLastUpdate", "=", "removals", ".", "size", "(", ");", "}", "}", "return", "current", ";", "}", "}", ";", "return", "new", "MarkupChildIterator", "(", ");", "@", "@", "-", "1361", ",", "29", "+", "1367", ",", "6", "@", "@", "private", "void", "removals_add", "(", "Component", "removedChild", ",", "Component", "prevSibling", ")", "removals", ".", "add", "(", "new", "RemovedChild", "(", "removedChild", ",", "prevSibling", ")", ");", "}", "/", "**", "*", "Gets", "the", "{", "@", "link", "RemovedChild", "}", "from", "the", "list", "of", "removals", "at", "given", "position", ".", "*", "*", "@", "param", "i", "*", "the", "position", "*", "@", "return", "the", "removed", "child", "*", "/", "private", "RemovedChild", "removals_get", "(", "int", "i", ")", "{", "return", "getMetaData", "(", "REMOVALS_KEY", ")", ".", "get", "(", "i", ")", ";", "}", "/", "**", "*", "Gets", "the", "number", "of", "removals", "that", "happened", "during", "the", "request", ".", "*", "*", "@", "return", "the", "number", "of", "removals", "*", "/", "private", "int", "removals_size", "(", ")", "{", "LinkedList", "<", "RemovedChild", ">", "removals", "=", "removals_get", "(", ");", "return", "removals", "=", "=", "null", "?", "0", ":", "removals", ".", "size", "(", ");", "}", "/", "**", "*", "@", "param", "component", "*", "Component", "being", "removed"], "docstring_tokens": ["see", "possibly", "sensitive", "information", "inside", "a", "HTML", "template"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2345", ",", "6", "+", "2345", ",", "9", "@", "@", "struct", "vhost_msg_node", "*", "vhost_new_msg", "(", "struct", "vhost_virtqueue", "*", "vq", ",", "int", "type", ")", "struct", "vhost_msg_node", "*", "node", "=", "kmalloc", "(", "sizeof", "*", "node", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "node", ")", "return", "NULL", ";", "/", "*", "Make", "sure", "all", "padding", "within", "the", "structure", "is", "initialized", ".", "*", "/", "memset", "(", "&", "node", "-", ">", "msg", ",", "0", ",", "sizeof", "node", "-", ">", "msg", ")", ";", "node", "-", ">", "vq", "=", "vq", ";", "node", "-", ">", "msg", ".", "type", "=", "type", ";", "return", "node", ";"], "docstring_tokens": ["reading", "from", "the", "dev/vhost-net", "device", "file"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "13", ",", "6", "+", "13", ",", "15", "@", "@", "<", "h3", ">", "Version", "4", ".", "0", ".", "5", "<", "/", "h3", ">", "<", "/", "p", ">", "<", "ul", ">", "<", "li", ">", "Fixed", "a", "bug", "in", "simple", "bind", "request", "processing", "in", "which", "the", "LDAP", "SDK", "would", "only", "reject", "a", "bind", "request", "that", "contains", "a", "DN", "but", "no", "password", "(", "subject", "to", "the", "<", "tt", ">", "LDAPConnectionOptions", ".", "bindWithDNRequiresPassword", "(", ")<", "/", "tt", ">", "setting", ")", "when", "using", "the", "default", "asynchronous", "mode", ",", "but", "not", "when", "configured", "to", "operate", "in", "synchronous", "mode", ".", "<", "br", ">", "<", "br", ">", "<", "/", "li", ">", "<", "li", ">", "Added", "support", "for", "two", "new", "UnboundID", "/", "Ping", "-", "proprietary", "request", "controls", ".", "The", "reject", "unindexed", "search", "request", "control", "can", "be", "used", "to", "indicate", "that", "the", "server", "@", "@", "-", "513", ",", "14", "+", "513", ",", "6", "@", "@", "public", "ASN1Element", "encodeProtocolOp", "(", ")", "protected", "BindResult", "process", "(", "final", "LDAPConnection", "connection", ",", "final", "int", "depth", ")", "throws", "LDAPException", "{", "if", "(", "connection", ".", "synchronousMode", "(", "))", "{", "@", "SuppressWarnings", "(", "\"", "deprecation", "\"", ")", "final", "boolean", "autoReconnect", "=", "connection", ".", "getConnectionOptions", "(", ").", "autoReconnect", "(", ");", "return", "processSync", "(", "connection", ",", "autoReconnect", ")", ";", "}", "/", "/", "See", "if", "a", "bind", "DN", "was", "provided", "without", "a", "password", ".", "If", "that", "is", "the", "case", "/", "/", "and", "this", "should", "not", "be", "allowed", ",", "then", "throw", "an", "exception", ".", "if", "(", "password", "!", "=", "null", ")", "@", "@", "-", "536", ",", "6", "+", "528", ",", "14", "@", "@", "protected", "BindResult", "process", "(", "final", "LDAPConnection", "connection", ",", "final", "int", "depth", ")", "}", "if", "(", "connection", ".", "synchronousMode", "(", "))", "{", "@", "SuppressWarnings", "(", "\"", "deprecation", "\"", ")", "final", "boolean", "autoReconnect", "=", "connection", ".", "getConnectionOptions", "(", ").", "autoReconnect", "(", ");", "return", "processSync", "(", "connection", ",", "autoReconnect", ")", ";", "}", "/", "/", "Create", "the", "LDAP", "message", ".", "messageID", "=", "connection", ".", "nextMessageID", "(", ");", "final", "LDAPMessage", "message", "=", "new", "LDAPMessage", "(", "messageID", ",", "this", ",", "getControls", "(", "))", ";", "@", "@", "-", "27", ",", "6", "+", "27", ",", "7", "@", "@", "import", "org", ".", "testng", ".", "annotations", ".", "Test", ";", "import", "com", ".", "unboundid", ".", "asn1", ".", "ASN1OctetString", ";", "import", "com", ".", "unboundid", ".", "ldap", ".", "listener", ".", "InMemoryDirectoryServer", ";", "import", "com", ".", "unboundid", ".", "ldap", ".", "protocol", ".", "LDAPMessage", ";", "@", "@", "-", "1393", ",", "22", "+", "1394", ",", "72", "@", "@", "public", "void", "testFailedAdminBind", "(", ")", "/", "**", "*", "Tests", "to", "ensure", "that", "the", "LDAP", "SDK", "will", "reject", "attempts", "to", "perform", "a", "simple", "*", "bind", "with", "a", "DN", "but", "without", "a", "password", ".", "Note", "that", "processing", "for", "this", "test", "*", "will", "only", "be", "performed", "if", "a", "Directory", "Server", "instance", "is", "available", ".", "*", "bind", "with", "a", "DN", "but", "without", "a", "password", ",", "when", "operating", "in", "synchronous", "mode", ".", "*", "*", "@", "throws", "Exception", "If", "an", "unexpected", "problem", "occurs", ".", "*", "/", "@", "Test", "(", ")", "public", "void", "testRejectBindWithDNButNoPassword", "(", ")", "public", "void", "testRejectBindWithDNButNoPasswordSyncMode", "(", ")", "throws", "Exception", "{", "if", "(", "!", "isDirectoryInstanceAvailable", "(", "))", "final", "InMemoryDirectoryServer", "ds", "=", "getTestDS", "(", "true", ",", "true", ")", ";", "final", "LDAPConnectionOptions", "options", "=", "new", "LDAPConnectionOptions", "(", ");", "options", ".", "setUseSynchronousMode", "(", "true", ")", ";", "final", "LDAPConnection", "conn", "=", "ds", ".", "getConnection", "(", "options", ")", ";", "final", "SimpleBindRequest", "bindRequest", "=", "new", "SimpleBindRequest", "(", "\"", "cn", "=", "Directory", "Manager", "\"", ",", "\"", "\")", ";", "try", "{", "return", ";", "bindRequest", ".", "process", "(", "conn", ",", "1", ")", ";", "fail", "(", "\"", "Expected", "an", "exception", "when", "binding", "with", "a", "DN", "but", "no", "password", "\"", ");", "}", "catch", "(", "LDAPException", "le", ")", "{", "assertEquals", "(", "le", ".", "getResultCode", "(", "),", "ResultCode", ".", "PARAM_ERROR", ")", ";", "}", "LDAPConnection", "conn", "=", "getUnauthenticatedConnection", "(", ");", "SimpleBindRequest", "bindRequest", "=", "new", "SimpleBindRequest", "(", "getTestBindDN", "(", "),", "\"", "\")", ";", "/", "/", "Reconfigure", "the", "connection", "so", "that", "it", "will", "allow", "binds", "with", "a", "DN", "but", "no", "/", "/", "password", ".", "conn", ".", "getConnectionOptions", "(", ").", "setBindWithDNRequiresPassword", "(", "false", ")", ";", "try", "{", "bindRequest", ".", "process", "(", "conn", ",", "1", ")", ";", "}", "catch", "(", "LDAPException", "le", ")", "{", "/", "/", "The", "server", "will", "still", "likely", "reject", "the", "operation", ",", "but", "we", "should", "at", "/", "/", "least", "verify", "that", "it", "wasn", "'", "t", "a", "parameter", "error", ".", "assertFalse", "(", "le", ".", "getResultCode", "(", ")", "=", "=", "ResultCode", ".", "PARAM_ERROR", ")", ";", "}", "conn", ".", "getConnectionOptions", "(", ").", "setBindWithDNRequiresPassword", "(", "true", ")", ";", "conn", ".", "close", "(", ");", "}", "/", "**", "*", "Tests", "to", "ensure", "that", "the", "LDAP", "SDK", "will", "reject", "attempts", "to", "perform", "a", "simple", "*", "bind", "with", "a", "DN", "but", "without", "a", "password", ",", "when", "operating", "in", "asynchronous", "mode", ".", "*", "*", "@", "throws", "Exception", "If", "an", "unexpected", "problem", "occurs", ".", "*", "/", "@", "Test", "(", ")", "public", "void", "testRejectBindWithDNButNoPasswordAsyncMode", "(", ")", "throws", "Exception", "{", "final", "InMemoryDirectoryServer", "ds", "=", "getTestDS", "(", "true", ",", "true", ")", ";", "final", "LDAPConnectionOptions", "options", "=", "new", "LDAPConnectionOptions", "(", ");", "options", ".", "setUseSynchronousMode", "(", "false", ")", ";", "final", "LDAPConnection", "conn", "=", "ds", ".", "getConnection", "(", "options", ")", ";", "final", "SimpleBindRequest", "bindRequest", "=", "new", "SimpleBindRequest", "(", "\"", "cn", "=", "Directory", "Manager", "\"", ",", "\"", "\")", ";", "try", "{"], "docstring_tokens": ["using", "a", "valid", "username", "and", "empty", "password"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "181", ",", "7", "+", "181", ",", "7", "@", "@", "static", "int", "proc_keys_show", "(", "struct", "seq_file", "*", "m", ",", "void", "*", "v", ")", "struct", "timespec", "now", ";", "unsigned", "long", "timo", ";", "key_ref_t", "key_ref", ",", "skey_ref", ";", "char", "xbuf", "[", "12", "]", ";", "char", "xbuf", "[", "16", "]", ";", "int", "rc", ";", "struct", "keyring_search_context", "ctx", "=", "{"], "docstring_tokens": ["by", "reading", "the", "/proc/keys", "file", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "661", ",", "6", "+", "661", ",", "8", "@", "@", "static", "Image", "*", "ReadBMPImage", "(", "const", "ImageInfo", "*", "image_info", ",", "ExceptionInfo", "*", "exception", ")", "bmp_info", ".", "x_pixels", "=", "ReadBlobLSBLong", "(", "image", ")", ";", "bmp_info", ".", "y_pixels", "=", "ReadBlobLSBLong", "(", "image", ")", ";", "bmp_info", ".", "number_colors", "=", "ReadBlobLSBLong", "(", "image", ")", ";", "if", "(", "bmp_info", ".", "number_colors", ">", "GetBlobSize", "(", "image", ")", ")", "ThrowReaderException", "(", "CorruptImageError", ",", "\"", "InsufficientImageDataInFile", "\"", ");", "bmp_info", ".", "colors_important", "=", "ReadBlobLSBLong", "(", "image", ")", ";", "if", "(", "image", "-", ">", "debug", "!", "=", "MagickFalse", ")", "{"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "4080", ",", "7", "+", "4080", ",", "7", "@", "@", "int", "hugetlb_mcopy_atomic_pte", "(", "struct", "mm_struct", "*", "dst_mm", ",", "/", "*", "fallback", "to", "copy_from_user", "outside", "mmap_sem", "*", "/", "if", "(", "unlikely", "(", "ret", ")", ")", "{", "ret", "=", "-", "EFAULT", ";", "ret", "=", "-", "ENOENT", ";", "*", "pagep", "=", "page", ";", "/", "*", "don", "'", "t", "free", "the", "page", "*", "/", "goto", "out", ";", "@", "@", "-", "2238", ",", "7", "+", "2238", ",", "7", "@", "@", "static", "int", "shmem_mfill_atomic_pte", "(", "struct", "mm_struct", "*", "dst_mm", ",", "*", "pagep", "=", "page", ";", "shmem_inode_unacct_blocks", "(", "inode", ",", "1", ")", ";", "/", "*", "don", "'", "t", "free", "the", "page", "*", "/", "return", "-", "EFAULT", ";", "return", "-", "ENOENT", ";", "}", "}", "else", "{", "/", "*", "mfill_zeropage_atomic", "*", "/", "clear_highpage", "(", "page", ")", ";", "@", "@", "-", "48", ",", "7", "+", "48", ",", "7", "@", "@", "static", "int", "mcopy_atomic_pte", "(", "struct", "mm_struct", "*", "dst_mm", ",", "/", "*", "fallback", "to", "copy_from_user", "outside", "mmap_sem", "*", "/", "if", "(", "unlikely", "(", "ret", ")", ")", "{", "ret", "=", "-", "EFAULT", ";", "ret", "=", "-", "ENOENT", ";", "*", "pagep", "=", "page", ";", "/", "*", "don", "'", "t", "free", "the", "page", "*", "/", "goto", "out", ";", "@", "@", "-", "274", ",", "7", "+", "274", ",", "7", "@", "@", "static", "__always_inline", "ssize_t", "__mcopy_atomic_hugetlb", "(", "struct", "mm_struct", "*", "dst_mm", ",", "cond_resched", "(", ");", "if", "(", "unlikely", "(", "err", "=", "=", "-", "EFAULT", ")", ")", "{", "if", "(", "unlikely", "(", "err", "=", "=", "-", "ENOENT", ")", ")", "{", "up_read", "(", "&", "dst_mm", "-", ">", "mmap_sem", ")", ";", "BUG_ON", "(", "!", "page", ")", ";", "@", "@", "-", "530", ",", "7", "+", "530", ",", "7", "@", "@", "static", "__always_inline", "ssize_t", "__mcopy_atomic", "(", "struct", "mm_struct", "*", "dst_mm", ",", "src_addr", ",", "&", "page", ",", "zeropage", ")", ";", "cond_resched", "(", ");", "if", "(", "unlikely", "(", "err", "=", "=", "-", "EFAULT", ")", ")", "{", "if", "(", "unlikely", "(", "err", "=", "=", "-", "ENOENT", ")", ")", "{", "void", "*", "page_kaddr", ";", "up_read", "(", "&", "dst_mm", "-", ">", "mmap_sem", ")", ";"], "docstring_tokens": ["staying", ">", "sufficiently", "behind", "current", "versions"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "4", ",", "7", "+", "4", ",", "14", "@", "@", "Changes", "between", "1", ".", "0", ".", "0l", "and", "1", ".", "0", ".", "0m", "[", "xx", "XXX", "xxxx", "]", "*", ")", "*", ")", "Fix", "for", "the", "attack", "described", "in", "the", "paper", "\"", "Recovering", "OpenSSL", "ECDSA", "Nonces", "Using", "the", "FLUSH", "+", "RELOAD", "Cache", "Side", "-", "channel", "Attack", "\"", "by", "Yuval", "Yarom", "and", "Naomi", "Benger", ".", "Details", "can", "be", "obtained", "from", ":", "http", ":", "//", "eprint", ".", "iacr", ".", "org", "/", "2014", "/", "140", "Thanks", "to", "Yuval", "Yarom", "and", "Naomi", "Benger", "for", "discovering", "this", "flaw", "and", "to", "Yuval", "Yarom", "for", "supplying", "a", "fix", "(", "CVE", "-", "2014", "-", "0076", ")", "[", "Yuval", "Yarom", "and", "Naomi", "Benger", "]", "Changes", "between", "1", ".", "0", ".", "0k", "and", "1", ".", "0", ".", "0l", "[", "6", "Jan", "2014", "]", "@", "@", "-", "538", ",", "6", "+", "538", ",", "8", "@", "@", "BIGNUM", "*", "BN_mod_inverse", "(", "BIGNUM", "*", "ret", ",", "BIGNUM", "*", "BN_mod_sqrt", "(", "BIGNUM", "*", "ret", ",", "const", "BIGNUM", "*", "a", ",", "const", "BIGNUM", "*", "n", ",", "BN_CTX", "*", "ctx", ")", ";", "void", "BN_consttime_swap", "(", "BN_ULONG", "swap", ",", "BIGNUM", "*", "a", ",", "BIGNUM", "*", "b", ",", "int", "nwords", ")", ";", "/", "*", "Deprecated", "versions", "*", "/", "#", "ifndef", "OPENSSL_NO_DEPRECATED", "BIGNUM", "*", "BN_generate_prime", "(", "BIGNUM", "*", "ret", ",", "int", "bits", ",", "int", "safe", ",", "@", "@", "-", "759", ",", "11", "+", "761", ",", "20", "@", "@", "int", "RAND_pseudo_bytes", "(", "unsigned", "char", "*", "buf", ",", "int", "num", ")", ";", "#", "define", "bn_fix_top", "(", "a", ")", "bn_check_top", "(", "a", ")", "#", "define", "bn_check_size", "(", "bn", ",", "bits", ")", "bn_wcheck_size", "(", "bn", ",", "(", "(", "bits", "+", "BN_BITS2", "-", "1", ")", ")/", "BN_BITS2", ")", "#", "define", "bn_wcheck_size", "(", "bn", ",", "words", ")", "\\", "do", "{", "\\", "const", "BIGNUM", "*", "_bnum2", "=", "(", "bn", ")", ";", "\\", "assert", "(", "words", "<", "=", "(", "_bnum2", ")", "->", "dmax", "&", "&", "words", ">", "=", "(", "_bnum2", ")", "->", "top", ")", ";", "\\", "}", "while", "(", "0", ")", "#", "else", "/", "*", "!", "BN_DEBUG", "*", "/", "#", "define", "bn_pollute", "(", "a", ")", "#", "define", "bn_check_top", "(", "a", ")", "#", "define", "bn_fix_top", "(", "a", ")", "bn_correct_top", "(", "a", ")", "#", "define", "bn_check_size", "(", "bn", ",", "bits", ")", "#", "define", "bn_wcheck_size", "(", "bn", ",", "words", ")", "#", "endif", "@", "@", "-", "843", ",", "3", "+", "843", ",", "55", "@", "@", "int", "bn_cmp_part_words", "(", "const", "BN_ULONG", "*", "a", ",", "const", "BN_ULONG", "*", "b", ",", "}", "return", "bn_cmp_words", "(", "a", ",", "b", ",", "cl", ")", ";", "}", "/", "*", "*", "Constant", "-", "time", "conditional", "swap", "of", "a", "and", "b", ".", "*", "a", "and", "b", "are", "swapped", "if", "condition", "is", "not", "0", ".", "The", "code", "assumes", "that", "at", "most", "one", "bit", "of", "condition", "is", "set", ".", "*", "nwords", "is", "the", "number", "of", "words", "to", "swap", ".", "The", "code", "assumes", "that", "at", "least", "nwords", "are", "allocated", "in", "both", "a", "and", "b", ",", "*", "and", "that", "no", "more", "than", "nwords", "are", "used", "by", "either", "a", "or", "b", ".", "*", "a", "and", "b", "cannot", "be", "the", "same", "number", "*", "/", "void", "BN_consttime_swap", "(", "BN_ULONG", "condition", ",", "BIGNUM", "*", "a", ",", "BIGNUM", "*", "b", ",", "int", "nwords", ")", "{", "BN_ULONG", "t", ";", "int", "i", ";", "bn_wcheck_size", "(", "a", ",", "nwords", ")", ";", "bn_wcheck_size", "(", "b", ",", "nwords", ")", ";", "assert", "(", "a", "!", "=", "b", ")", ";", "assert", "(", "(", "condition", "&", "(", "condition", "-", "1", ")", ")", "=", "=", "0", ")", ";", "assert", "(", "sizeof", "(", "BN_ULONG", ")", ">", "=", "sizeof", "(", "int", ")", ");", "condition", "=", "(", "(", "condition", "-", "1", ")", ">", ">", "(", "BN_BITS2", "-", "1", ")", ")", "-", "1", ";", "t", "=", "(", "a", "-", ">", "top", "^", "b", "-", ">", "top", ")", "&", "condition", ";", "a", "-", ">", "top", "^", "=", "t", ";", "b", "-", ">", "top", "^", "=", "t", ";", "#", "define", "BN_CONSTTIME_SWAP", "(", "ind", ")", "\\", "do", "{", "\\", "t", "=", "(", "a", "-", ">", "d", "[", "ind", "]", "^", "b", "-", ">", "d", "[", "ind", "]", ")", "&", "condition", ";", "\\", "a", "-", ">", "d", "[", "ind", "]", "^", "=", "t", ";", "\\", "b", "-", ">", "d", "[", "ind", "]", "^", "=", "t", ";", "\\", "}", "while", "(", "0", ")", "switch", "(", "nwords", ")", "{", "default", ":", "for", "(", "i", "=", "10", ";", "i", "<", "nwords", ";", "i", "+", "+)", "BN_CONSTTIME_SWAP", "(", "i", ")", ";", "/", "*", "Fallthrough", "*", "/", "case", "10", ":", "BN_CONSTTIME_SWAP", "(", "9", ")", ";", "/", "*", "Fallthrough", "*", "/", "case", "9", ":", "BN_CONSTTIME_SWAP", "(", "8", ")", ";", "/", "*", "Fallthrough", "*", "/", "case", "8", ":", "BN_CONSTTIME_SWAP", "(", "7", ")", ";", "/", "*", "Fallthrough", "*", "/", "case", "7", ":", "BN_CONSTTIME_SWAP", "(", "6", ")", ";", "/", "*", "Fallthrough", "*", "/", "case", "6", ":", "BN_CONSTTIME_SWAP", "(", "5", ")", ";", "/", "*", "Fallthrough", "*", "/", "case", "5", ":", "BN_CONSTTIME_SWAP", "(", "4", ")", ";", "/", "*", "Fallthrough", "*", "/", "case", "4", ":", "BN_CONSTTIME_SWAP", "(", "3", ")", ";", "/", "*", "Fallthrough", "*", "/", "case", "3", ":", "BN_CONSTTIME_SWAP", "(", "2", ")", ";", "/", "*", "Fallthrough", "*", "/", "case", "2", ":", "BN_CONSTTIME_SWAP", "(", "1", ")", ";", "/", "*", "Fallthrough", "*", "/", "case", "1", ":", "BN_CONSTTIME_SWAP", "(", "0", ")", ";", "}", "#", "undef", "BN_CONSTTIME_SWAP", "}", "@", "@", "-", "206", ",", "11", "+", "206", ",", "15", "@", "@", "static", "int", "gf2m_Mxy", "(", "const", "EC_GROUP", "*", "group", ",", "const", "BIGNUM", "*", "x", ",", "const", "BIGNUM", "*", "y", ",", "BIG", "return", "ret", ";", "}", "/", "*", "Computes", "scalar", "*", "point", "and", "stores", "the", "result", "in", "r", ".", "*", "point", "can", "not", "equal", "r", ".", "*", "Uses", "algorithm", "2P", "of", "*", "Uses", "a", "modified", "algorithm", "2P", "of", "*", "Lopez", ",", "J", ".", "and", "Dahab", ",", "R", ".", "\"", "Fast", "multiplication", "on", "elliptic", "curves", "over", "*", "GF", "(", "2", "^", "m", ")", "without", "precomputation", "\"", "(", "CHES", "'", "99", ",", "LNCS", "1717", ")", ".", "*", "*", "To", "protect", "against", "side", "-", "channel", "attack", "the", "function", "uses", "constant", "time", "swap", ",", "*", "avoiding", "conditional", "branches", ".", "*", "/", "static", "int", "ec_GF2m_montgomery_point_multiply", "(", "const", "EC_GROUP", "*", "group", ",", "EC_POINT", "*", "r", ",", "const", "BIGNUM", "*", "scalar", ",", "const", "EC_POINT", "*", "point", ",", "BN_CTX", "*", "ctx", ")", "@", "@", "-", "244", ",", "6", "+", "248", ",", "11", "@", "@", "static", "int", "ec_GF2m_montgomery_point_multiply", "(", "const", "EC_GROUP", "*", "group", ",", "EC_POINT", "*", "r", ",", "x2", "=", "&", "r", "-", ">", "X", ";", "z2", "=", "&", "r", "-", ">", "Y", ";", "bn_wexpand", "(", "x1", ",", "group", "-", ">", "field", ".", "top", ")", ";", "bn_wexpand", "(", "z1", ",", "group", "-", ">", "field", ".", "top", ")", ";", "bn_wexpand", "(", "x2", ",", "group", "-", ">", "field", ".", "top", ")", ";", "bn_wexpand", "(", "z2", ",", "group", "-", ">", "field", ".", "top", ")", ";", "if", "(", "!", "BN_GF2m_mod_arr", "(", "x1", ",", "&", "point", "-", ">", "X", ",", "group", "-", ">", "poly", ")", ")", "goto", "err", ";", "/", "*", "x1", "=", "x", "*", "/", "if", "(", "!", "BN_one", "(", "z1", ")", ")", "goto", "err", ";", "/", "*", "z1", "=", "1", "*", "/", "if", "(", "!", "group", "-", ">", "meth", "-", ">", "field_sqr", "(", "group", ",", "z2", ",", "x1", ",", "ctx", ")", ")", "goto", "err", ";", "/", "*", "z2", "=", "x1", "^", "2", "=", "x", "^", "2", "*", "/", "@", "@", "-", "268", ",", "16", "+", "277", ",", "12", "@", "@", "static", "int", "ec_GF2m_montgomery_point_multiply", "(", "const", "EC_GROUP", "*", "group", ",", "EC_POINT", "*", "r", ",", "word", "=", "scalar", "-", ">", "d", "[", "i", "]", ";", "while", "(", "mask", ")", "{", "if", "(", "word", "&", "mask", ")", "{", "if", "(", "!", "gf2m_Madd", "(", "group", ",", "&", "point", "-", ">", "X", ",", "x1", ",", "z1", ",", "x2", ",", "z2", ",", "ctx", ")", ")", "goto", "err", ";", "if", "(", "!", "gf2m_Mdouble", "(", "group", ",", "x2", ",", "z2", ",", "ctx", ")", ")", "goto", "err", ";", "}", "else", "{", "if", "(", "!", "gf2m_Madd", "(", "group", ",", "&", "point", "-", ">", "X", ",", "x2", ",", "z2", ",", "x1", ",", "z1", ",", "ctx", ")", ")", "goto", "err", ";", "if", "(", "!", "gf2m_Mdouble", "(", "group", ",", "x1", ",", "z1", ",", "ctx", ")", ")", "goto", "err", ";", "}", "BN_consttime_swap", "(", "word", "&", "mask", ",", "x1", ",", "x2", ",", "group", "-", ">", "field", ".", "top", ")", ";", "BN_consttime_swap", "(", "word", "&", "mask", ",", "z1", ",", "z2", ",", "group", "-", ">", "field", ".", "top", ")", ";", "if", "(", "!", "gf2m_Madd", "(", "group", ",", "&", "point", "-", ">", "X", ",", "x2", ",", "z2", ",", "x1", ",", "z1", ",", "ctx", ")", ")", "goto", "err", ";", "if", "(", "!", "gf2m_Mdouble", "(", "group", ",", "x1", ",", "z1", ",", "ctx", ")", ")", "goto", "err", ";", "BN_consttime_swap", "(", "word", "&", "mask", ",", "x1", ",", "x2", ",", "group", "-", ">", "field", ".", "top", ")", ";", "BN_consttime_swap", "(", "word", "&", "mask", ",", "z1", ",", "z2", ",", "group", "-", ">", "field", ".", "top", ")", ";", "mask", ">", ">=", "1", ";", "}", "mask", "=", "BN_TBIT", ";"], "docstring_tokens": ["using", "the", "FLUSH+RELOAD", "cache", "side-channel", "attack"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1052", ",", "6", "+", "1052", ",", "7", "@", "@", "static", "int", "wake_futex_pi", "(", "u32", "__user", "*", "uaddr", ",", "u32", "uval", ",", "struct", "futex_q", "*", "this", ")", "struct", "task_struct", "*", "new_owner", ";", "struct", "futex_pi_state", "*", "pi_state", "=", "this", "-", ">", "pi_state", ";", "u32", "uninitialized_var", "(", "curval", ")", ",", "newval", ";", "int", "ret", "=", "0", ";", "if", "(", "!", "pi_state", ")", "return", "-", "EINVAL", ";", "@", "@", "-", "1075", ",", "23", "+", "1076", ",", "19", "@", "@", "static", "int", "wake_futex_pi", "(", "u32", "__user", "*", "uaddr", ",", "u32", "uval", ",", "struct", "futex_q", "*", "this", ")", "new_owner", "=", "this", "-", ">", "task", ";", "/", "*", "*", "We", "pass", "it", "to", "the", "next", "owner", ".", "(", "The", "WAITERS", "bit", "is", "always", "*", "kept", "enabled", "while", "there", "is", "PI", "state", "around", ".", "We", "must", "also", "*", "preserve", "the", "owner", "died", "bit", ".", ")", "*", "We", "pass", "it", "to", "the", "next", "owner", ".", "The", "WAITERS", "bit", "is", "always", "*", "kept", "enabled", "while", "there", "is", "PI", "state", "around", ".", "We", "cleanup", "the", "*", "owner", "died", "bit", ",", "because", "we", "are", "the", "owner", ".", "*", "/", "if", "(", "!(", "uval", "&", "FUTEX_OWNER_DIED", ")", ")", "{", "int", "ret", "=", "0", ";", "newval", "=", "FUTEX_WAITERS", "|", "task_pid_vnr", "(", "new_owner", ")", ";", "newval", "=", "FUTEX_WAITERS", "|", "task_pid_vnr", "(", "new_owner", ")", ";", "if", "(", "cmpxchg_futex_value_locked", "(", "&", "curval", ",", "uaddr", ",", "uval", ",", "newval", ")", ")", "ret", "=", "-", "EFAULT", ";", "else", "if", "(", "curval", "!", "=", "uval", ")", "ret", "=", "-", "EINVAL", ";", "if", "(", "ret", ")", "{", "raw_spin_unlock", "(", "&", "pi_state", "-", ">", "pi_mutex", ".", "wait_lock", ")", ";", "return", "ret", ";", "}", "if", "(", "cmpxchg_futex_value_locked", "(", "&", "curval", ",", "uaddr", ",", "uval", ",", "newval", ")", ")", "ret", "=", "-", "EFAULT", ";", "else", "if", "(", "curval", "!", "=", "uval", ")", "ret", "=", "-", "EINVAL", ";", "if", "(", "ret", ")", "{", "raw_spin_unlock", "(", "&", "pi_state", "-", ">", "pi_mutex", ".", "wait_lock", ")", ";", "return", "ret", ";", "}", "raw_spin_lock_irq", "(", "&", "pi_state", "-", ">", "owner", "-", ">", "pi_lock", ")", ";", "@", "@", "-", "2351", ",", "9", "+", "2348", ",", "10", "@", "@", "static", "int", "futex_unlock_pi", "(", "u32", "__user", "*", "uaddr", ",", "unsigned", "int", "flags", ")", "/", "*", "*", "To", "avoid", "races", ",", "try", "to", "do", "the", "TID", "-", ">", "0", "atomic", "transition", "*", "again", ".", "If", "it", "succeeds", "then", "we", "can", "return", "without", "waking", "*", "anyone", "else", "up", ":", "*", "anyone", "else", "up", ".", "We", "only", "try", "this", "if", "neither", "the", "waiters", "nor", "*", "the", "owner", "died", "bit", "are", "set", ".", "*", "/", "if", "(", "!(", "uval", "&", "FUTEX_OWNER_DIED", ")", "&", "&", "if", "(", "!(", "uval", "&", "~", "FUTEX_TID_MASK", ")", "&", "&", "cmpxchg_futex_value_locked", "(", "&", "uval", ",", "uaddr", ",", "vpid", ",", "0", ")", ")", "goto", "pi_faulted", ";", "/", "*", "@", "@", "-", "2383", ",", "11", "+", "2381", ",", "9", "@", "@", "static", "int", "futex_unlock_pi", "(", "u32", "__user", "*", "uaddr", ",", "unsigned", "int", "flags", ")", "/", "*", "*", "No", "waiters", "-", "kernel", "unlocks", "the", "futex", ":", "*", "/", "if", "(", "!(", "uval", "&", "FUTEX_OWNER_DIED", ")", ")", "{", "ret", "=", "unlock_futex_pi", "(", "uaddr", ",", "uval", ")", ";", "if", "(", "ret", "=", "=", "-", "EFAULT", ")", "goto", "pi_faulted", ";", "}", "ret", "=", "unlock_futex_pi", "(", "uaddr", ",", "uval", ")", ";", "if", "(", "ret", "=", "=", "-", "EFAULT", ")", "goto", "pi_faulted", ";", "out_unlock", ":", "spin_unlock", "(", "&", "hb", "-", ">", "lock", ")", ";"], "docstring_tokens": ["via", "a", "crafted", "FUTEX_REQUEUE", "command", "that", "facilitates", "unsafe", "waiter", "modification", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "593", ",", "7", "+", "593", ",", "8", "@", "@", "static", "int", "apparmor_setprocattr", "(", "struct", "task_struct", "*", "task", ",", "char", "*", "name", ",", "sa", ".", "aad", ".", "op", "=", "OP_SETPROCATTR", ";", "sa", ".", "aad", ".", "info", "=", "name", ";", "sa", ".", "aad", ".", "error", "=", "-", "EINVAL", ";", "return", "aa_audit", "(", "AUDIT_APPARMOR_DENIED", ",", "NULL", ",", "GFP_KERNEL", ",", "return", "aa_audit", "(", "AUDIT_APPARMOR_DENIED", ",", "__aa_current_profile", "(", "),", "GFP_KERNEL", ",", "&", "sa", ",", "NULL", ")", ";", "}", "}", "else", "if", "(", "strcmp", "(", "name", ",", "\"", "exec", "\"", ")", "=", "=", "0", ")", "{"], "docstring_tokens": ["by", "writing", "to", "a", "/proc/#####/attr/current", "file", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "58", ",", "6", "+", "58", ",", "7", "@", "@", "MAILSTREAM", "DEFAULTPROTO", ";", "#", "define", "CRLF", "\"", "\\", "015", "\\", "012", "\"", "#", "define", "PHP_EXPUNGE", "32768", "#", "define", "PHP_IMAP_ADDRESS_SIZE_BUF", "10", "static", "void", "_php_make_header_object", "(", "zval", "*", "myzvalue", ",", "ENVELOPE", "*", "en", "TSRMLS_DC", ")", ";", "static", "void", "_php_imap_add_body", "(", "zval", "*", "arg", ",", "BODY", "*", "body", "TSRMLS_DC", ")", ";", "@", "@", "-", "3546", ",", "7", "+", "3547", ",", "7", "@", "@", "PHP_FUNCTION", "(", "imap_mime_header_decode", ")", "static", "int", "_php_imap_address_size", "(", "ADDRESS", "*", "addresslist", ")", "{", "ADDRESS", "*", "tmp", ";", "int", "ret", "=", "0", ";", "int", "ret", "=", "0", ",", "num_ent", "=", "0", ";", "tmp", "=", "addresslist", ";", "@", "@", "-", "3555", ",", "10", "+", "3556", ",", "15", "@", "@", "static", "int", "_php_imap_address_size", "(", "ADDRESS", "*", "addresslist", ")", "ret", "+", "=", "(", "tmp", "-", ">", "adl", ")", "?", "strlen", "(", "tmp", "-", ">", "adl", ")", ":", "0", ";", "ret", "+", "=", "(", "tmp", "-", ">", "mailbox", ")", "?", "strlen", "(", "tmp", "-", ">", "mailbox", ")", ":", "0", ";", "ret", "+", "=", "(", "tmp", "-", ">", "host", ")", "?", "strlen", "(", "tmp", "-", ">", "host", ")", ":", "0", ";", "num_ent", "+", "+;", "}", "while", "(", "(", "tmp", "=", "tmp", "-", ">", "next", ")", ");", "/", "*", "rfc822_write_address_full", "(", ")", "needs", "some", "extra", "space", "for", "'", "<>", ",'", ",", "etc", ".", "*", "/", "ret", "+", "=", "(", "ret", ")", "?", "MAILTMPLEN", ":", "0", ";", "/", "*", "*", "rfc822_write_address_full", "(", ")", "needs", "some", "extra", "space", "for", "'", "<>", ",'", ",", "etc", ".", "*", "for", "this", "perpouse", "we", "allocate", "additional", "PHP_IMAP_ADDRESS_SIZE_BUF", "bytes", "*", "by", "default", "this", "buffer", "is", "10", "bytes", "long", "*", "/", "ret", "+", "=", "(", "ret", ")", "?", "num_ent", "*", "PHP_IMAP_ADDRESS_SIZE_BUF", ":", "0", ";", "return", "ret", ";", "}"], "docstring_tokens": ["sending", "a", "specially-crafted", "email", "containing", "a", "large", "number", "of", "recipients", "in", "the", "To", "field"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "145", ",", "27", "+", "145", ",", "56", "@", "@", "public", "void", "setAllowHostHeaderMismatch", "(", "boolean", "allowHostHeaderMismatch", ")", "{", "}", "private", "boolean", "rejectIllegalHeaderName", "=", "false", ";", "private", "boolean", "rejectIllegalHeader", "=", "false", ";", "/", "**", "*", "If", "an", "HTTP", "request", "is", "received", "that", "contains", "an", "illegal", "header", "name", "(", "i", ".", "e", ".", "*", "the", "header", "name", "is", "not", "a", "token", ")", "will", "the", "request", "be", "rejected", "(", "with", "a", "400", "*", "response", ")", "or", "will", "the", "illegal", "header", "be", "ignored", ".", "*", "If", "an", "HTTP", "request", "is", "received", "that", "contains", "an", "illegal", "header", "name", "or", "*", "value", "(", "e", ".", "g", ".", "the", "header", "name", "is", "not", "a", "token", ")", "will", "the", "request", "be", "rejected", "*", "(", "with", "a", "400", "response", ")", "or", "will", "the", "illegal", "header", "be", "ignored", "?", "*", "*", "@", "return", "{", "@", "code", "true", "}", "if", "the", "request", "will", "be", "rejected", "or", "{", "@", "code", "false", "}", "if", "*", "the", "header", "will", "be", "ignored", "*", "/", "public", "boolean", "getRejectIllegalHeaderName", "(", ")", "{", "return", "rejectIllegalHeaderName", ";", "}", "public", "boolean", "getRejectIllegalHeader", "(", ")", "{", "return", "rejectIllegalHeader", ";", "}", "/", "**", "*", "If", "an", "HTTP", "request", "is", "received", "that", "contains", "an", "illegal", "header", "name", "(", "i", ".", "e", ".", "*", "the", "header", "name", "is", "not", "a", "token", ")", "should", "the", "request", "be", "rejected", "(", "with", "a", "*", "400", "response", ")", "or", "should", "the", "illegal", "header", "be", "ignored", ".", "*", "If", "an", "HTTP", "request", "is", "received", "that", "contains", "an", "illegal", "header", "name", "or", "*", "value", "(", "e", ".", "g", ".", "the", "header", "name", "is", "not", "a", "token", ")", "should", "the", "request", "be", "*", "rejected", "(", "with", "a", "400", "response", ")", "or", "should", "the", "illegal", "header", "be", "ignored", "?", "*", "*", "@", "param", "rejectIllegalHeader", "{", "@", "code", "true", "}", "to", "reject", "requests", "with", "illegal", "*", "header", "names", "or", "values", ",", "{", "@", "code", "false", "}", "to", "*", "ignore", "the", "header", "*", "/", "public", "void", "setRejectIllegalHeader", "(", "boolean", "rejectIllegalHeader", ")", "{", "this", ".", "rejectIllegalHeader", "=", "rejectIllegalHeader", ";", "}", "/", "**", "*", "If", "an", "HTTP", "request", "is", "received", "that", "contains", "an", "illegal", "header", "name", "or", "*", "value", "(", "e", ".", "g", ".", "the", "header", "name", "is", "not", "a", "token", ")", "will", "the", "request", "be", "rejected", "*", "(", "with", "a", "400", "response", ")", "or", "will", "the", "illegal", "header", "be", "ignored", "?", "*", "*", "@", "return", "{", "@", "code", "true", "}", "if", "the", "request", "will", "be", "rejected", "or", "{", "@", "code", "false", "}", "if", "*", "the", "header", "will", "be", "ignored", "*", "*", "@", "deprecated", "Now", "an", "alias", "for", "{", "@", "link", "#", "getRejectIllegalHeader", "(", ")}", ".", "Will", "be", "*", "removed", "in", "Tomcat", "10", "onwards", ".", "*", "/", "@", "Deprecated", "public", "boolean", "getRejectIllegalHeaderName", "(", ")", "{", "return", "rejectIllegalHeader", ";", "}", "/", "**", "*", "If", "an", "HTTP", "request", "is", "received", "that", "contains", "an", "illegal", "header", "name", "or", "*", "value", "(", "e", ".", "g", ".", "the", "header", "name", "is", "not", "a", "token", ")", "should", "the", "request", "be", "*", "rejected", "(", "with", "a", "400", "response", ")", "or", "should", "the", "illegal", "header", "be", "ignored", "?", "*", "*", "@", "param", "rejectIllegalHeaderName", "{", "@", "code", "true", "}", "to", "reject", "requests", "with", "*", "illegal", "header", "names", ",", "{", "@", "code", "false", "}", "to", "*", "ignore", "the", "header", "*", "illegal", "header", "names", "or", "values", ",", "*", "{", "@", "code", "false", "}", "to", "ignore", "the", "header", "*", "*", "@", "deprecated", "Now", "an", "alias", "for", "{", "@", "link", "#", "setRejectIllegalHeader", "(", "boolean", ")", "}.", "*", "Will", "be", "removed", "in", "Tomcat", "10", "onwards", ".", "*", "/", "@", "Deprecated", "public", "void", "setRejectIllegalHeaderName", "(", "boolean", "rejectIllegalHeaderName", ")", "{", "this", ".", "rejectIllegalHeaderName", "=", "rejectIllegalHeaderName", ";", "this", ".", "rejectIllegalHeader", "=", "rejectIllegalHeaderName", ";", "}", "@", "@", "-", "66", ",", "7", "+", "66", ",", "7", "@", "@", "private", "final", "MimeHeaders", "headers", ";", "private", "final", "boolean", "rejectIllegalHeaderName", ";", "private", "final", "boolean", "rejectIllegalHeader", ";", "/", "**", "*", "State", ".", "@", "@", "-", "152", ",", "13", "+", "152", ",", "13", "@", "@", "/", "/", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "Constructors", "public", "Http11InputBuffer", "(", "Request", "request", ",", "int", "headerBufferSize", ",", "boolean", "rejectIllegalHeaderName", ",", "HttpParser", "httpParser", ")", "{", "boolean", "rejectIllegalHeader", ",", "HttpParser", "httpParser", ")", "{", "this", ".", "request", "=", "request", ";", "headers", "=", "request", ".", "getMimeHeaders", "(", ");", "this", ".", "headerBufferSize", "=", "headerBufferSize", ";", "this", ".", "rejectIllegalHeaderName", "=", "rejectIllegalHeaderName", ";", "this", ".", "rejectIllegalHeader", "=", "rejectIllegalHeader", ";", "this", ".", "httpParser", "=", "httpParser", ";", "filterLibrary", "=", "new", "InputFilter", "[", "0", "]", ";", "@", "@", "-", "760", ",", "6", "+", "760", ",", "8", "@", "@", "private", "HeaderParseStatus", "parseHeader", "(", ")", "throws", "IOException", "{", "/", "/", "byte", "chr", "=", "0", ";", "byte", "prevChr", "=", "0", ";", "while", "(", "headerParsePos", "=", "=", "HeaderParsePosition", ".", "HEADER_START", ")", "{", "/", "/", "Read", "new", "bytes", "if", "needed", "@", "@", "-", "770", ",", "17", "+", "772", ",", "23", "@", "@", "private", "HeaderParseStatus", "parseHeader", "(", ")", "throws", "IOException", "{", "}", "}", "prevChr", "=", "chr", ";", "chr", "=", "byteBuffer", ".", "get", "(", ");", "if", "(", "chr", "=", "=", "Constants", ".", "CR", ")", "{", "/", "/", "Skip", "}", "else", "if", "(", "chr", "=", "=", "Constants", ".", "LF", ")", "{", "if", "(", "chr", "=", "=", "Constants", ".", "CR", "&", "&", "prevChr", "!", "=", "Constants", ".", "CR", ")", "{", "/", "/", "Possible", "start", "of", "CRLF", "-", "process", "the", "next", "byte", ".", "}", "else", "if", "(", "prevChr", "=", "=", "Constants", ".", "CR", "&", "&", "chr", "=", "=", "Constants", ".", "LF", ")", "{", "return", "HeaderParseStatus", ".", "DONE", ";", "}", "else", "{", "byteBuffer", ".", "position", "(", "byteBuffer", ".", "position", "(", ")", "-", "1", ")", ";", "if", "(", "prevChr", "=", "=", "0", ")", "{", "/", "/", "Must", "have", "only", "read", "one", "byte", "byteBuffer", ".", "position", "(", "byteBuffer", ".", "position", "(", ")", "-", "1", ")", ";", "}", "else", "{", "/", "/", "Must", "have", "read", "two", "bytes", "(", "first", "was", "CR", ",", "second", "was", "not", "LF", ")", "byteBuffer", ".", "position", "(", "byteBuffer", ".", "position", "(", ")", "-", "2", ")", ";", "}", "break", ";", "}", "}", "if", "(", "headerParsePos", "=", "=", "HeaderParsePosition", ".", "HEADER_START", ")", "{", "@", "@", "-", "877", ",", "11", "+", "885", ",", "22", "@", "@", "private", "HeaderParseStatus", "parseHeader", "(", ")", "throws", "IOException", "{", "}", "}", "prevChr", "=", "chr", ";", "chr", "=", "byteBuffer", ".", "get", "(", ");", "if", "(", "chr", "=", "=", "Constants", ".", "CR", ")", "{", "/", "/", "Skip", "}", "else", "if", "(", "chr", "=", "=", "Constants", ".", "LF", ")", "{", "/", "/", "Possible", "start", "of", "CRLF", "-", "process", "the", "next", "byte", ".", "}", "else", "if", "(", "prevChr", "=", "=", "Constants", ".", "CR", "&", "&", "chr", "=", "=", "Constants", ".", "LF", ")", "{", "eol", "=", "true", ";", "}", "else", "if", "(", "prevChr", "=", "=", "Constants", ".", "CR", ")", "{", "/", "/", "Invalid", "value", "/", "/", "Delete", "the", "header", "(", "it", "will", "be", "the", "most", "recent", "one", ")", "headers", ".", "removeHeader", "(", "headers", ".", "size", "(", ")", "-", "1", ")", ";", "return", "skipLine", "(", ");", "}", "else", "if", "(", "chr", "!", "=", "Constants", ".", "HT", "&", "&", "HttpParser", ".", "isControl", "(", "chr", ")", ")", "{", "/", "/", "Invalid", "value", "/", "/", "Delete", "the", "header", "(", "it", "will", "be", "the", "most", "recent", "one", ")", "headers", ".", "removeHeader", "(", "headers", ".", "size", "(", ")", "-", "1", ")", ";", "return", "skipLine", "(", ");", "}", "else", "if", "(", "chr", "=", "=", "Constants", ".", "SP", "|", "|", "chr", "=", "=", "Constants", ".", "HT", ")", "{", "byteBuffer", ".", "put", "(", "headerData", ".", "realPos", ",", "chr", ")", ";", "headerData", ".", "realPos", "+", "+;", "@", "@", "-", "933", ",", "6", "+", "952", ",", "9", "@", "@", "private", "HeaderParseStatus", "skipLine", "(", ")", "throws", "IOException", "{", "headerParsePos", "=", "HeaderParsePosition", ".", "HEADER_SKIPLINE", ";", "boolean", "eol", "=", "false", ";", "byte", "chr", "=", "0", ";", "byte", "prevChr", "=", "0", ";", "/", "/", "Reading", "bytes", "until", "the", "end", "of", "the", "line", "while", "(", "!", "eol", ")", "{", "@", "@", "-", "944", ",", "20", "+", "966", ",", "21", "@", "@", "private", "HeaderParseStatus", "skipLine", "(", ")", "throws", "IOException", "{", "}", "int", "pos", "=", "byteBuffer", ".", "position", "(", ");", "byte", "chr", "=", "byteBuffer", ".", "get", "(", ");", "prevChr", "=", "chr", ";", "chr", "=", "byteBuffer", ".", "get", "(", ");", "if", "(", "chr", "=", "=", "Constants", ".", "CR", ")", "{", "/", "/", "Skip", "}", "else", "if", "(", "chr", "=", "=", "Constants", ".", "LF", ")", "{", "}", "else", "if", "(", "prevChr", "=", "=", "Constants", ".", "CR", "&", "&", "chr", "=", "=", "Constants", ".", "LF", ")", "{", "eol", "=", "true", ";", "}", "else", "{", "headerData", ".", "lastSignificantChar", "=", "pos", ";", "}", "}", "if", "(", "rejectIllegalHeaderName", "|", "|", "log", ".", "isDebugEnabled", "(", "))", "{", "if", "(", "rejectIllegalHeader", "|", "|", "log", ".", "isDebugEnabled", "(", "))", "{", "String", "message", "=", "sm", ".", "getString", "(", "\"", "iib", ".", "invalidheader", "\"", ",", "HeaderUtil", ".", "toPrintableString", "(", "byteBuffer", ".", "array", "(", "),", "headerData", ".", "lineStart", ",", "headerData", ".", "lastSignificantChar", "-", "headerData", ".", "lineStart", "+", "1", ")", ");", "if", "(", "rejectIllegalHeaderName", ")", "{", "if", "(", "rejectIllegalHeader", ")", "{", "throw", "new", "IllegalArgumentException", "(", "message", ")", ";", "}", "log", ".", "debug", "(", "message", ")", ";", "@", "@", "-", "188", ",", "7", "+", "188", ",", "7", "@", "@", "public", "Http11Processor", "(", "AbstractHttp11Protocol", "<", "?>", "protocol", ",", "AbstractEndpoint", "<", "?>", "e", "protocol", ".", "getRelaxedQueryChars", "(", "))", ";", "inputBuffer", "=", "new", "Http11InputBuffer", "(", "request", ",", "protocol", ".", "getMaxHttpHeaderSize", "(", "),", "protocol", ".", "getRejectIllegalHeaderName", "(", "),", "httpParser", ")", ";", "protocol", ".", "getRejectIllegalHeader", "(", "),", "httpParser", ")", ";", "request", ".", "setInputBuffer", "(", "inputBuffer", ")", ";", "outputBuffer", "=", "new", "Http11OutputBuffer", "(", "response", ",", "protocol", ".", "getMaxHttpHeaderSize", "(", "),", "@", "@", "-", "395", ",", "7", "+", "395", ",", "7", "@", "@", "public", "void", "removeHeader", "(", "String", "name", ")", "{", "*", "reset", "and", "swap", "with", "last", "header", "*", "@", "param", "idx", "the", "index", "of", "the", "header", "to", "remove", ".", "*", "/", "private", "void", "removeHeader", "(", "int", "idx", ")", "{", "public", "void", "removeHeader", "(", "int", "idx", ")", "{", "MimeHeaderField", "mh", "=", "headers", "[", "idx", "]", ";", "mh", ".", "recycle", "(", ");", "@", "@", "-", "337", ",", "6", "+", "337", ",", "17", "@", "@", "public", "static", "boolean", "isQuery", "(", "int", "c", ")", "{", "}", "public", "static", "boolean", "isControl", "(", "int", "c", ")", "{", "/", "/", "Fast", "for", "valid", "control", "characters", ",", "slower", "for", "some", "incorrect", "/", "/", "ones", "try", "{", "return", "IS_CONTROL", "[", "c", "]", ";", "}", "catch", "(", "ArrayIndexOutOfBoundsException", "ex", ")", "{", "return", "false", ";", "}", "}", "/", "/", "Skip", "any", "LWS", "and", "position", "to", "read", "the", "next", "character", ".", "The", "next", "character", "/", "/", "is", "returned", "as", "being", "able", "to", "'", "peek", "(", ")'", "it", "allows", "a", "small", "optimisation", "in", "/", "/", "some", "cases", ".", "@", "@", "-", "163", ",", "27", "+", "163", ",", "52", "@", "@", "public", "void", "testBug51557NoColon", "(", ")", "{", "@", "Test", "public", "void", "testBug51557Separators", "(", ")", "throws", "Exception", "{", "public", "void", "testBug51557SeparatorsInName", "(", ")", "throws", "Exception", "{", "char", "httpSeparators", "[", "]", "=", "new", "char", "[", "]", "{", "'", "\\", "t", "'", ",", "'", "'", ",", "'", "\\\"", "',", "'", "('", ",", "'", ")'", ",", "'", ",'", ",", "'", "/'", ",", "'", ":'", ",", "'", ";'", ",", "'", "<'", ",", "'", "='", ",", "'", ">'", ",", "'", "?'", ",", "'", "@'", ",", "'", "['", ",", "'", "\\\\", "',", "'", "]'", ",", "'", "{'", ",", "'", "}'", "}", ";", "for", "(", "char", "s", ":", "httpSeparators", ")", "{", "doTestBug51557Char", "(", "s", ")", ";", "doTestBug51557CharInName", "(", "s", ")", ";", "tearDown", "(", ");", "setUp", "(", ");", "}", "}", "@", "Test", "public", "void", "testBug51557Ctl", "(", ")", "throws", "Exception", "{", "public", "void", "testBug51557CtlInName", "(", ")", "throws", "Exception", "{", "for", "(", "int", "i", "=", "0", ";", "i", "<", "31", ";", "i", "+", "+)", "{", "doTestBug51557Char", "(", "(", "char", ")", "i", ")", ";", "doTestBug51557CharInName", "(", "(", "char", ")", "i", ")", ";", "tearDown", "(", ");", "setUp", "(", ");", "}", "doTestBug51557CharInName", "(", "(", "char", ")", "127", ")", ";", "}", "@", "Test", "public", "void", "testBug51557CtlInValue", "(", ")", "throws", "Exception", "{", "for", "(", "int", "i", "=", "0", ";", "i", "<", "31", ";", "i", "+", "+)", "{", "if", "(", "i", "=", "=", "'", "\\", "t", "'", ")", "{", "/", "/", "TAB", "is", "allowed", "continue", ";", "}", "doTestBug51557InvalidCharInValue", "(", "(", "char", ")", "i", ")", ";", "tearDown", "(", ");", "setUp", "(", ");", "}", "doTestBug51557InvalidCharInValue", "(", "(", "char", ")", "127", ")", ";", "}", "@", "Test", "public", "void", "testBug51557ObsTextInValue", "(", ")", "throws", "Exception", "{", "for", "(", "int", "i", "=", "128", ";", "i", "<", "255", ";", "i", "+", "+)", "{", "doTestBug51557ValidCharInValue", "(", "(", "char", ")", "i", ")", ";", "tearDown", "(", ");", "setUp", "(", ");", "}", "doTestBug51557Char", "(", "(", "char", ")", "127", ")", ";", "}", "@", "@", "-", "226", ",", "7", "+", "251", ",", "7", "@", "@", "public", "void", "testBug51557BoundaryEnd", "(", ")", "{", "}", "private", "void", "doTestBug51557Char", "(", "char", "s", ")", "{", "private", "void", "doTestBug51557CharInName", "(", "char", "s", ")", "{", "Bug51557Client", "client", "=", "new", "Bug51557Client", "(", "\"", "X", "-", "Bug", "\"", "+", "s", "+", "\"", "51557", "\"", ",", "\"", "invalid", "\"", ");", "@", "@", "-", "236", ",", "30", "+", "261", ",", "53", "@", "@", "private", "void", "doTestBug51557Char", "(", "char", "s", ")", "{", "Assert", ".", "assertTrue", "(", "client", ".", "isResponseBodyOK", "(", "))", ";", "}", "private", "void", "doTestBug51557InvalidCharInValue", "(", "char", "s", ")", "{", "Bug51557Client", "client", "=", "new", "Bug51557Client", "(", "\"", "X", "-", "Bug51557", "-", "Invalid", "\"", ",", "\"", "invalid", "\"", "+", "s", "+", "\"", "invalid", "\"", ");", "client", ".", "doRequest", "(", ");", "Assert", ".", "assertTrue", "(", "\"", "Testing", "[", "\"", "+", "(", "int", ")", "s", "+", "\"", "]\"", ",", "client", ".", "isResponse200", "(", "))", ";", "Assert", ".", "assertEquals", "(", "\"", "Testing", "[", "\"", "+", "(", "int", ")", "s", "+", "\"", "]\"", ",", "\"", "abcd", "\"", ",", "client", ".", "getResponseBody", "(", "))", ";", "Assert", ".", "assertTrue", "(", "client", ".", "isResponseBodyOK", "(", "))", ";", "}", "private", "void", "doTestBug51557ValidCharInValue", "(", "char", "s", ")", "{", "Bug51557Client", "client", "=", "new", "Bug51557Client", "(", "\"", "X", "-", "Bug51557", "-", "Valid", "\"", ",", "\"", "valid", "\"", "+", "s", "+", "\"", "valid", "\"", ");", "client", ".", "doRequest", "(", ");", "Assert", ".", "assertTrue", "(", "\"", "Testing", "[", "\"", "+", "(", "int", ")", "s", "+", "\"", "]\"", ",", "client", ".", "isResponse200", "(", "))", ";", "Assert", ".", "assertEquals", "(", "\"", "Testing", "[", "\"", "+", "(", "int", ")", "s", "+", "\"", "]\"", ",", "\"", "valid", "\"", "+", "s", "+", "\"", "validabcd", "\"", ",", "client", ".", "getResponseBody", "(", "))", ";", "Assert", ".", "assertTrue", "(", "client", ".", "isResponseBodyOK", "(", "))", ";", "}", "/", "**", "*", "Bug", "51557", "test", "client", ".", "*", "/", "private", "class", "Bug51557Client", "extends", "SimpleHttpClient", "{", "private", "final", "String", "headerName", ";", "private", "final", "String", "headerLine", ";", "private", "final", "boolean", "rejectIllegalHeaderName", ";", "private", "final", "boolean", "rejectIllegalHeader", ";", "public", "Bug51557Client", "(", "String", "headerName", ")", "{", "this", ".", "headerName", "=", "headerName", ";", "this", ".", "headerLine", "=", "headerName", ";", "this", ".", "rejectIllegalHeaderName", "=", "false", ";", "this", ".", "rejectIllegalHeader", "=", "false", ";", "}", "public", "Bug51557Client", "(", "String", "headerName", ",", "String", "headerValue", ")", "{", "this", "(", "headerName", ",", "headerValue", ",", "false", ")", ";", "}", "public", "Bug51557Client", "(", "String", "headerName", ",", "String", "headerValue", ",", "boolean", "rejectIllegalHeaderName", ")", "{", "boolean", "rejectIllegalHeader", ")", "{", "this", ".", "headerName", "=", "headerName", ";", "this", ".", "headerLine", "=", "headerName", "+", "\"", ":", "\"", "+", "headerValue", ";", "this", ".", "rejectIllegalHeaderName", "=", "rejectIllegalHeaderName", ";", "this", ".", "rejectIllegalHeader", "=", "rejectIllegalHeader", ";", "}", "private", "Exception", "doRequest", "(", ")", "{", "@", "@", "-", "274", ",", "7", "+", "322", ",", "7", "@", "@", "private", "Exception", "doRequest", "(", ")", "{", "try", "{", "Connector", "connector", "=", "tomcat", ".", "getConnector", "(", ");", "Assert", ".", "assertTrue", "(", "connector", ".", "setProperty", "(", "\"", "rejectIllegalHeaderName", "\"", ",", "Boolean", ".", "toString", "(", "rejectIllegalHeaderName", ")", "))", ";", "\"", "rejectIllegalHeader", "\"", ",", "Boolean", ".", "toString", "(", "rejectIllegalHeader", ")", "))", ";", "tomcat", ".", "start", "(", ");", "setPort", "(", "connector", ".", "getLocalPort", "(", "))", ";", "@", "@", "-", "548", ",", "7", "+", "596", ",", "7", "@", "@", "private", "Exception", "doRequest", "(", ")", "{", "try", "{", "Connector", "connector", "=", "tomcat", ".", "getConnector", "(", ");", "Assert", ".", "assertTrue", "(", "connector", ".", "setProperty", "(", "\"", "rejectIllegalHeaderName", "\"", ",", "\"", "false", "\"", "))", ";", "Assert", ".", "assertTrue", "(", "connector", ".", "setProperty", "(", "\"", "rejectIllegalHeader", "\"", ",", "\"", "false", "\"", "))", ";", "tomcat", ".", "start", "(", ");", "setPort", "(", "connector", ".", "getLocalPort", "(", "))", ";", "@", "@", "-", "174", ",", "6", "+", "174", ",", "11", "@", "@", "the", "<", "code", ">", "Transfer", "-", "Encoding", "<", "/", "code", ">", "header", "were", "ignored", "rather", "than", "treated", "as", "an", "error", ".", "(", "markt", ")", "<", "/", "fix", ">", "<", "fix", ">", "Rename", "the", "HTTP", "Connector", "attribute", "<", "code", ">", "rejectIllegalHeaderName", "<", "/", "code", ">", "to", "<", "code", ">", "rejectIllegalHeader", "<", "/", "code", ">", "and", "expand", "the", "underlying", "implementation", "to", "include", "header", "values", "as", "well", "as", "names", ".", "(", "markt", ")", "<", "/", "fix", ">", "<", "/", "changelog", ">", "<", "/", "subsection", ">", "<", "subsection", "name", "=", "\"", "Jasper", "\"", ">", "@", "@", "-", "575", ",", "15", "+", "575", ",", "20", "@", "@", "expected", "concurrent", "requests", "(", "synchronous", "and", "asynchronous", ")", ".<", "/", "p", ">", "<", "/", "attribute", ">", "<", "attribute", "name", "=", "\"", "rejectIllegalHeaderName", "\"", "required", "=", "\"", "false", "\"", ">", "<", "p", ">", "If", "an", "HTTP", "request", "is", "received", "that", "contains", "an", "illegal", "header", "name", "(", "i", ".", "e", ".", "the", "header", "name", "is", "not", "a", "token", ")", "this", "setting", "determines", "if", "the", "<", "attribute", "name", "=", "\"", "rejectIllegalHeader", "\"", "required", "=", "\"", "false", "\"", ">", "<", "p", ">", "If", "an", "HTTP", "request", "is", "received", "that", "contains", "an", "illegal", "header", "name", "or", "value", "(", "e", ".", "g", ".", "the", "header", "name", "is", "not", "a", "token", ")", "this", "setting", "determines", "if", "the", "request", "will", "be", "rejected", "with", "a", "400", "response", "(", "<", "code", ">", "true", "<", "/", "code", ">", ")", "or", "if", "the", "illegal", "header", "be", "ignored", "(", "<", "code", ">", "false", "<", "/", "code", ">", ").", "The", "default", "value", "is", "<", "code", ">", "false", "<", "/", "code", ">", "which", "will", "cause", "the", "request", "to", "be", "processed", "but", "the", "illegal", "header", "will", "be", "ignored", ".", "</", "p", ">", "<", "/", "attribute", ">", "<", "attribute", "name", "=", "\"", "rejectIllegalHeaderName", "\"", "required", "=", "\"", "false", "\"", ">", "<", "p", ">", "This", "attribute", "is", "deprecated", ".", "It", "will", "be", "removed", "in", "Tomcat", "10", "onwards", ".", "It", "is", "now", "an", "alias", "for", "<", "strong", ">", "rejectIllegalHeader", "<", "/", "strong", ">", ".<", "/", "p", ">", "<", "/", "attribute", ">", "<", "attribute", "name", "=", "\"", "relaxedPathChars", "\"", "required", "=", "\"", "false", "\"", ">", "<", "p", ">", "The", "<", "a", "href", "=", "\"", "https", ":", "//", "tools", ".", "ietf", ".", "org", "/", "rfc", "/", "rfc7230", ".", "txt", "\"", ">", "HTTP", "/", "1", ".", "1", "specification", "<", "/", "a", ">", "requires", "that", "certain", "characters", "are", "%", "nn", "encoded", "when"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "95", ",", "8", "+", "95", ",", "8", "@", "@", "struct", "k_itimer", "{", "clockid_t", "it_clock", ";", "timer_t", "it_id", ";", "int", "it_active", ";", "int", "it_overrun", ";", "int", "it_overrun_last", ";", "s64", "it_overrun", ";", "s64", "it_overrun_last", ";", "int", "it_requeue_pending", ";", "int", "it_sigev_notify", ";", "ktime_t", "it_interval", ";", "@", "@", "-", "85", ",", "7", "+", "85", ",", "7", "@", "@", "static", "void", "bump_cpu_timer", "(", "struct", "k_itimer", "*", "timer", ",", "u64", "now", ")", "continue", ";", "timer", "-", ">", "it", ".", "cpu", ".", "expires", "+", "=", "incr", ";", "timer", "-", ">", "it_overrun", "+", "=", "1", "<", "<", "i", ";", "timer", "-", ">", "it_overrun", "+", "=", "1LL", "<", "<", "i", ";", "delta", "-", "=", "incr", ";", "}", "}", "@", "@", "-", "283", ",", "16", "+", "283", ",", "26", "@", "@", "static", "__init", "int", "init_posix_timers", "(", "void", ")", "}", "__initcall", "(", "init_posix_timers", ")", ";", "/", "*", "*", "The", "siginfo", "si_overrun", "field", "and", "the", "return", "value", "of", "timer_getoverrun", "(", "2", ")", "*", "are", "of", "type", "int", ".", "Clamp", "the", "overrun", "value", "to", "INT_MAX", "*", "/", "static", "inline", "int", "timer_overrun_to_int", "(", "struct", "k_itimer", "*", "timr", ",", "int", "baseval", ")", "{", "s64", "sum", "=", "timr", "-", ">", "it_overrun_last", "+", "(", "s64", ")", "baseval", ";", "return", "sum", ">", "(", "s64", ")", "INT_MAX", "?", "INT_MAX", ":", "(", "int", ")", "sum", ";", "}", "static", "void", "common_hrtimer_rearm", "(", "struct", "k_itimer", "*", "timr", ")", "{", "struct", "hrtimer", "*", "timer", "=", "&", "timr", "-", ">", "it", ".", "real", ".", "timer", ";", "if", "(", "!", "timr", "-", ">", "it_interval", ")", "return", ";", "timr", "-", ">", "it_overrun", "+", "=", "(", "unsigned", "int", ")", "hrtimer_forward", "(", "timer", ",", "timer", "-", ">", "base", "-", ">", "get_time", "(", "),", "timr", "-", ">", "it_interval", ")", ";", "timr", "-", ">", "it_overrun", "+", "=", "hrtimer_forward", "(", "timer", ",", "timer", "-", ">", "base", "-", ">", "get_time", "(", "),", "timr", "-", ">", "it_interval", ")", ";", "hrtimer_restart", "(", "timer", ")", ";", "}", "@", "@", "-", "321", ",", "10", "+", "331", ",", "10", "@", "@", "void", "posixtimer_rearm", "(", "struct", "siginfo", "*", "info", ")", "timr", "-", ">", "it_active", "=", "1", ";", "timr", "-", ">", "it_overrun_last", "=", "timr", "-", ">", "it_overrun", ";", "timr", "-", ">", "it_overrun", "=", "-", "1", ";", "timr", "-", ">", "it_overrun", "=", "-", "1LL", ";", "+", "+", "timr", "-", ">", "it_requeue_pending", ";", "info", "-", ">", "si_overrun", "+", "=", "timr", "-", ">", "it_overrun_last", ";", "info", "-", ">", "si_overrun", "=", "timer_overrun_to_int", "(", "timr", ",", "info", "-", ">", "si_overrun", ")", ";", "}", "unlock_timer", "(", "timr", ",", "flags", ")", ";", "@", "@", "-", "418", ",", "9", "+", "428", ",", "8", "@", "@", "static", "enum", "hrtimer_restart", "posix_timer_fn", "(", "struct", "hrtimer", "*", "timer", ")", "now", "=", "ktime_add", "(", "now", ",", "kj", ")", ";", "}", "#", "endif", "timr", "-", ">", "it_overrun", "+", "=", "(", "unsigned", "int", ")", "hrtimer_forward", "(", "timer", ",", "now", ",", "timr", "-", ">", "it_interval", ")", ";", "timr", "-", ">", "it_overrun", "+", "=", "hrtimer_forward", "(", "timer", ",", "now", ",", "timr", "-", ">", "it_interval", ")", ";", "ret", "=", "HRTIMER_RESTART", ";", "+", "+", "timr", "-", ">", "it_requeue_pending", ";", "timr", "-", ">", "it_active", "=", "1", ";", "@", "@", "-", "524", ",", "7", "+", "533", ",", "7", "@", "@", "static", "int", "do_timer_create", "(", "clockid_t", "which_clock", ",", "struct", "sigevent", "*", "event", ",", "new_timer", "-", ">", "it_id", "=", "(", "timer_t", ")", "new_timer_id", ";", "new_timer", "-", ">", "it_clock", "=", "which_clock", ";", "new_timer", "-", ">", "kclock", "=", "kc", ";", "new_timer", "-", ">", "it_overrun", "=", "-", "1", ";", "new_timer", "-", ">", "it_overrun", "=", "-", "1LL", ";", "if", "(", "event", ")", "{", "rcu_read_lock", "(", ");", "@", "@", "-", "702", ",", "7", "+", "711", ",", "7", "@", "@", "void", "common_timer_get", "(", "struct", "k_itimer", "*", "timr", ",", "struct", "itimerspec64", "*", "cur_setting", ")", "*", "expiry", "time", "forward", "by", "intervals", ",", "so", "expiry", "is", ">", "now", ".", "*", "/", "if", "(", "iv", "&", "&", "(", "timr", "-", ">", "it_requeue_pending", "&", "REQUEUE_PENDING", "|", "|", "sig_none", ")", ")", "timr", "-", ">", "it_overrun", "+", "=", "(", "int", ")", "kc", "-", ">", "timer_forward", "(", "timr", ",", "now", ")", ";", "timr", "-", ">", "it_overrun", "+", "=", "kc", "-", ">", "timer_forward", "(", "timr", ",", "now", ")", ";", "remaining", "=", "kc", "-", ">", "timer_remaining", "(", "timr", ",", "now", ")", ";", "/", "*", "Return", "0", "only", ",", "when", "the", "timer", "is", "expired", "and", "not", "pending", "*", "/", "@", "@", "-", "791", ",", "7", "+", "800", ",", "7", "@", "@", "SYSCALL_DEFINE1", "(", "timer_getoverrun", ",", "timer_t", ",", "timer_id", ")", "if", "(", "!", "timr", ")", "return", "-", "EINVAL", ";", "overrun", "=", "timr", "-", ">", "it_overrun_last", ";", "overrun", "=", "timer_overrun_to_int", "(", "timr", ",", "0", ")", ";", "unlock_timer", "(", "timr", ",", "flags", ")", ";", "return", "overrun", ";"], "docstring_tokens": ["using", "a", "specially-crafted", "system", "call"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "47", ",", "7", "+", "47", ",", "7", "@", "@", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "access", ".", "expression", ".", "DefaultWebSecurityExpressionHandler", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "access", ".", "intercept", ".", "FilterSecurityInterceptor", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "debug", ".", "DebugFilter", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "firewall", ".", "DefaultHttpFirewall", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "firewall", ".", "StrictHttpFirewall", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "firewall", ".", "HttpFirewall", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "servlet", ".", "util", ".", "matcher", ".", "MvcRequestMatcher", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "util", ".", "matcher", ".", "RequestMatcher", ";", "@", "@", "-", "159", ",", "7", "+", "159", ",", "7", "@", "@", "public", "IgnoredRequestConfigurer", "ignoring", "(", ")", "{", "/", "**", "*", "Allows", "customizing", "the", "{", "@", "link", "HttpFirewall", "}", ".", "The", "default", "is", "*", "{", "@", "link", "DefaultHttpFirewall", "}", ".", "*", "{", "@", "link", "StrictHttpFirewall", "}", ".", "*", "*", "@", "param", "httpFirewall", "the", "custom", "{", "@", "link", "HttpFirewall", "}", "*", "@", "return", "the", "{", "@", "link", "WebSecurity", "}", "for", "further", "customizations", "@", "@", "-", "38", ",", "6", "+", "38", ",", "7", "@", "@", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "SecurityFilterChain", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "authentication", ".", "UsernamePasswordAuthenticationFilter", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "context", ".", "SecurityContextPersistenceFilter", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "firewall", ".", "DefaultHttpFirewall", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "servletapi", ".", "SecurityContextHolderAwareRequestFilter", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "util", ".", "matcher", ".", "AntPathRequestMatcher", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "util", ".", "matcher", ".", "AnyRequestMatcher", ";", "@", "@", "-", "80", ",", "6", "+", "81", ",", "7", "@", "@", "public", "void", "normalOperation", "(", ")", "throws", "Exception", "{", "public", "void", "normalOperationWithNewConfig", "(", ")", "throws", "Exception", "{", "FilterChainProxy", "filterChainProxy", "=", "appCtx", ".", "getBean", "(", "\"", "newFilterChainProxy", "\"", ",", "FilterChainProxy", ".", "class", ")", ";", "filterChainProxy", ".", "setFirewall", "(", "new", "DefaultHttpFirewall", "(", "))", ";", "checkPathAndFilterOrder", "(", "filterChainProxy", ")", ";", "doNormalOperation", "(", "filterChainProxy", ")", ";", "}", "@", "@", "-", "88", ",", "6", "+", "90", ",", "7", "@", "@", "public", "void", "normalOperationWithNewConfig", "(", ")", "throws", "Exception", "{", "public", "void", "normalOperationWithNewConfigRegex", "(", ")", "throws", "Exception", "{", "FilterChainProxy", "filterChainProxy", "=", "appCtx", ".", "getBean", "(", "\"", "newFilterChainProxyRegex", "\"", ",", "FilterChainProxy", ".", "class", ")", ";", "filterChainProxy", ".", "setFirewall", "(", "new", "DefaultHttpFirewall", "(", "))", ";", "checkPathAndFilterOrder", "(", "filterChainProxy", ")", ";", "doNormalOperation", "(", "filterChainProxy", ")", ";", "}", "@", "@", "-", "96", ",", "6", "+", "99", ",", "7", "@", "@", "public", "void", "normalOperationWithNewConfigRegex", "(", ")", "throws", "Exception", "{", "public", "void", "normalOperationWithNewConfigNonNamespace", "(", ")", "throws", "Exception", "{", "FilterChainProxy", "filterChainProxy", "=", "appCtx", ".", "getBean", "(", "\"", "newFilterChainProxyNonNamespace", "\"", ",", "FilterChainProxy", ".", "class", ")", ";", "filterChainProxy", ".", "setFirewall", "(", "new", "DefaultHttpFirewall", "(", "))", ";", "checkPathAndFilterOrder", "(", "filterChainProxy", ")", ";", "doNormalOperation", "(", "filterChainProxy", ")", ";", "}", "@", "@", "-", "28", ",", "6", "+", "28", ",", "7", "@", "@", "import", "org", ".", "springframework", ".", "security", ".", "core", ".", "context", ".", "SecurityContextHolder", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "FilterChainProxy", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "context", ".", "HttpSessionSecurityContextRepository", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "firewall", ".", "RequestRejectedException", ";", "import", "org", ".", "springframework", ".", "test", ".", "context", ".", "ContextConfiguration", ";", "import", "org", ".", "springframework", ".", "test", ".", "context", ".", "junit4", ".", "SpringJUnit4ClassRunner", ";", "@", "@", "-", "40", ",", "32", "+", "41", ",", "33", "@", "@", "@", "Autowired", "private", "FilterChainProxy", "fcp", ";", "@", "Test", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "securedFilterChainCannotBeBypassedByAddingPathParameters", "(", ")", "throws", "Exception", "{", "MockHttpServletRequest", "request", "=", "new", "MockHttpServletRequest", "(", ");", "request", ".", "setPathInfo", "(", "\"/", "secured", ";", "x", "=", "y", "/", "admin", ".", "html", "\"", ");", "request", ".", "setSession", "(", "createAuthenticatedSession", "(", "\"", "ROLE_USER", "\"", "))", ";", "MockHttpServletResponse", "response", "=", "new", "MockHttpServletResponse", "(", ");", "fcp", ".", "doFilter", "(", "request", ",", "response", ",", "new", "MockFilterChain", "(", "))", ";", "assertThat", "(", "response", ".", "getStatus", "(", "))", ".", "isEqualTo", "(", "403", ")", ";", "}", "@", "Test", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "adminFilePatternCannotBeBypassedByAddingPathParameters", "(", ")", "throws", "Exception", "{", "MockHttpServletRequest", "request", "=", "new", "MockHttpServletRequest", "(", ");", "request", ".", "setServletPath", "(", "\"/", "secured", "/", "admin", ".", "html", ";", "x", "=", "user", ".", "html", "\"", ");", "request", ".", "setSession", "(", "createAuthenticatedSession", "(", "\"", "ROLE_USER", "\"", "))", ";", "MockHttpServletResponse", "response", "=", "new", "MockHttpServletResponse", "(", ");", "fcp", ".", "doFilter", "(", "request", ",", "response", ",", "new", "MockFilterChain", "(", "))", ";", "assertThat", "(", "response", ".", "getStatus", "(", "))", ".", "isEqualTo", "(", "403", ")", ";", "}", "/", "/", "Try", "with", "pathInfo", "request", "=", "new", "MockHttpServletRequest", "(", ");", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "adminFilePatternCannotBeBypassedByAddingPathParametersWithPathInfo", "(", ")", "throws", "Exception", "{", "MockHttpServletRequest", "request", "=", "new", "MockHttpServletRequest", "(", ");", "request", ".", "setServletPath", "(", "\"/", "secured", "\"", ");", "request", ".", "setPathInfo", "(", "\"/", "admin", ".", "html", ";", "x", "=", "user", ".", "html", "\"", ");", "request", ".", "setSession", "(", "createAuthenticatedSession", "(", "\"", "ROLE_USER", "\"", "))", ";", "response", "=", "new", "MockHttpServletResponse", "(", ");", "MockHttpServletResponse", "response", "=", "new", "MockHttpServletResponse", "(", ");", "fcp", ".", "doFilter", "(", "request", ",", "response", ",", "new", "MockFilterChain", "(", "))", ";", "assertThat", "(", "response", ".", "getStatus", "(", "))", ".", "isEqualTo", "(", "403", ")", ";", "}", "@", "@", "-", "19", ",", "9", "+", "19", ",", "9", "@", "@", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "Log", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "LogFactory", ";", "import", "org", ".", "springframework", ".", "security", ".", "core", ".", "context", ".", "SecurityContextHolder", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "firewall", ".", "DefaultHttpFirewall", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "firewall", ".", "FirewalledRequest", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "firewall", ".", "HttpFirewall", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "firewall", ".", "StrictHttpFirewall", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "util", ".", "matcher", ".", "RequestMatcher", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "util", ".", "UrlUtils", ";", "import", "org", ".", "springframework", ".", "web", ".", "filter", ".", "DelegatingFilterProxy", ";", "@", "@", "-", "96", ",", "7", "+", "96", ",", "7", "@", "@", "*", "*", "An", "{", "@", "link", "HttpFirewall", "}", "instance", "is", "used", "to", "validate", "incoming", "requests", "and", "create", "a", "*", "wrapped", "request", "which", "provides", "consistent", "path", "values", "for", "matching", "against", ".", "See", "*", "{", "@", "link", "DefaultHttpFirewall", "}", ",", "for", "more", "information", "on", "the", "type", "of", "attacks", "which", "the", "*", "{", "@", "link", "StrictHttpFirewall", "}", ",", "for", "more", "information", "on", "the", "type", "of", "attacks", "which", "the", "*", "default", "implementation", "protects", "against", ".", "A", "custom", "implementation", "can", "be", "injected", "to", "*", "provide", "stricter", "control", "over", "the", "request", "contents", "or", "if", "an", "application", "needs", "to", "*", "support", "certain", "types", "of", "request", "which", "are", "rejected", "by", "default", ".", "@", "@", "-", "147", ",", "7", "+", "147", ",", "7", "@", "@", "private", "FilterChainValidator", "filterChainValidator", "=", "new", "NullFilterChainValidator", "(", ");", "private", "HttpFirewall", "firewall", "=", "new", "DefaultHttpFirewall", "(", ");", "private", "HttpFirewall", "firewall", "=", "new", "StrictHttpFirewall", "(", ");", "/", "/", "~", "Methods", "/", "/", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "@", "@", "-", "37", ",", "8", "+", "37", ",", "10", "@", "@", "*", "containers", "normalize", "the", "paths", "before", "performing", "the", "servlet", "-", "mapping", ",", "but", "*", "again", "this", "is", "not", "guaranteed", "by", "the", "servlet", "spec", ".", "*", "*", "@", "deprecated", "Use", "{", "@", "link", "StrictHttpFirewall", "}", "instead", "*", "@", "author", "Luke", "Taylor", "*", "/", "@", "Deprecated", "public", "class", "DefaultHttpFirewall", "implements", "HttpFirewall", "{", "private", "boolean", "allowUrlEncodedSlash", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "239", "@", "@", "/", "*", "*", "Copyright", "2012", "-", "2017", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "springframework", ".", "security", ".", "web", ".", "firewall", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletRequest", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletResponse", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Set", ";", "/", "**", "*", "A", "strict", "implementation", "of", "{", "@", "link", "HttpFirewall", "}", "that", "rejects", "any", "suspicious", "requests", "*", "with", "a", "{", "@", "link", "RequestRejectedException", "}", ".", "*", "*", "@", "author", "Rob", "Winch", "*", "@", "since", "5", ".", "0", ".", "1", "*", "/", "public", "class", "StrictHttpFirewall", "implements", "HttpFirewall", "{", "private", "static", "final", "String", "ENCODED_PERCENT", "=", "\"", "%", "25", "\"", ";", "private", "static", "final", "String", "PERCENT", "=", "\"", "%\"", ";", "private", "static", "final", "List", "<", "String", ">", "FORBIDDEN_ENCODED_PERIOD", "=", "Collections", ".", "unmodifiableList", "(", "Arrays", ".", "asList", "(", "\"%", "2e", "\"", ",", "\"", "%", "2E", "\"", "))", ";", "private", "static", "final", "List", "<", "String", ">", "FORBIDDEN_SEMICOLON", "=", "Collections", ".", "unmodifiableList", "(", "Arrays", ".", "asList", "(", "\";", "\",", "\"", "%", "3b", "\"", ",", "\"", "%", "3B", "\"", "))", ";", "private", "static", "final", "List", "<", "String", ">", "FORBIDDEN_FORWARDSLASH", "=", "Collections", ".", "unmodifiableList", "(", "Arrays", ".", "asList", "(", "\"%", "2f", "\"", ",", "\"", "%", "2F", "\"", "))", ";", "private", "static", "final", "List", "<", "String", ">", "FORBIDDEN_BACKSLASH", "=", "Collections", ".", "unmodifiableList", "(", "Arrays", ".", "asList", "(", "\"\\", "\\\"", ",", "\"", "%", "5c", "\"", ",", "\"", "%", "5C", "\"", "))", ";", "private", "Set", "<", "String", ">", "encodedUrlBlacklist", "=", "new", "HashSet", "<", "String", ">", "()", ";", "private", "Set", "<", "String", ">", "decodedUrlBlacklist", "=", "new", "HashSet", "<", "String", ">", "()", ";", "public", "StrictHttpFirewall", "(", ")", "{", "urlBlacklistsAddAll", "(", "FORBIDDEN_SEMICOLON", ")", ";", "urlBlacklistsAddAll", "(", "FORBIDDEN_FORWARDSLASH", ")", ";", "urlBlacklistsAddAll", "(", "FORBIDDEN_BACKSLASH", ")", ";", "this", ".", "encodedUrlBlacklist", ".", "add", "(", "ENCODED_PERCENT", ")", ";", "this", ".", "encodedUrlBlacklist", ".", "addAll", "(", "FORBIDDEN_ENCODED_PERIOD", ")", ";", "this", ".", "decodedUrlBlacklist", ".", "add", "(", "PERCENT", ")", ";", "}", "/", "**", "*", "*", "@", "param", "allowSemicolon", "*", "/", "public", "void", "setAllowSemicolon", "(", "boolean", "allowSemicolon", ")", "{", "if", "(", "allowSemicolon", ")", "{", "urlBlacklistsRemoveAll", "(", "FORBIDDEN_SEMICOLON", ")", ";", "}", "else", "{", "urlBlacklistsAddAll", "(", "FORBIDDEN_SEMICOLON", ")", ";", "}", "}", "public", "void", "setAllowUrlEncodedSlash", "(", "boolean", "allowUrlEncodedSlash", ")", "{", "if", "(", "allowUrlEncodedSlash", ")", "{", "urlBlacklistsRemoveAll", "(", "FORBIDDEN_FORWARDSLASH", ")", ";", "}", "else", "{", "urlBlacklistsAddAll", "(", "FORBIDDEN_FORWARDSLASH", ")", ";", "}", "}", "public", "void", "setAllowUrlEncodedPeriod", "(", "boolean", "allowUrlEncodedPeriod", ")", "{", "if", "(", "allowUrlEncodedPeriod", ")", "{", "this", ".", "encodedUrlBlacklist", ".", "removeAll", "(", "FORBIDDEN_ENCODED_PERIOD", ")", ";", "}", "else", "{", "this", ".", "encodedUrlBlacklist", ".", "addAll", "(", "FORBIDDEN_ENCODED_PERIOD", ")", ";", "}", "}", "public", "void", "setAllowBackSlash", "(", "boolean", "allowBackSlash", ")", "{", "if", "(", "allowBackSlash", ")", "{", "urlBlacklistsRemoveAll", "(", "FORBIDDEN_BACKSLASH", ")", ";", "}", "else", "{", "urlBlacklistsAddAll", "(", "FORBIDDEN_BACKSLASH", ")", ";", "}", "}", "public", "void", "setAllowUrlEncodedPercent", "(", "boolean", "allowUrlEncodedPercent", ")", "{", "if", "(", "allowUrlEncodedPercent", ")", "{", "this", ".", "encodedUrlBlacklist", ".", "remove", "(", "ENCODED_PERCENT", ")", ";", "this", ".", "decodedUrlBlacklist", ".", "remove", "(", "PERCENT", ")", ";", "}", "else", "{", "this", ".", "encodedUrlBlacklist", ".", "add", "(", "ENCODED_PERCENT", ")", ";", "this", ".", "decodedUrlBlacklist", ".", "add", "(", "PERCENT", ")", ";", "}", "}", "private", "void", "urlBlacklistsAddAll", "(", "Collection", "<", "String", ">", "values", ")", "{", "this", ".", "encodedUrlBlacklist", ".", "addAll", "(", "values", ")", ";", "this", ".", "decodedUrlBlacklist", ".", "addAll", "(", "values", ")", ";", "}", "private", "void", "urlBlacklistsRemoveAll", "(", "Collection", "<", "String", ">", "values", ")", "{", "this", ".", "encodedUrlBlacklist", ".", "removeAll", "(", "values", ")", ";", "this", ".", "decodedUrlBlacklist", ".", "removeAll", "(", "values", ")", ";", "}", "@", "Override", "public", "FirewalledRequest", "getFirewalledRequest", "(", "HttpServletRequest", "request", ")", "throws", "RequestRejectedException", "{", "rejectedBlacklistedUrls", "(", "request", ")", ";", "if", "(", "!", "isNormalized", "(", "request", ")", ")", "{", "throw", "new", "RequestRejectedException", "(", "\"", "The", "request", "was", "rejected", "because", "the", "URL", "was", "not", "normalized", ".", "\")", ";", "}", "String", "requestUri", "=", "request", ".", "getRequestURI", "(", ");", "if", "(", "!", "containsOnlyPrintableAsciiCharacters", "(", "requestUri", ")", ")", "{", "throw", "new", "RequestRejectedException", "(", "\"", "The", "requestURI", "was", "rejected", "because", "it", "can", "only", "contain", "printable", "ASCII", "characters", ".", "\")", ";", "}", "return", "new", "FirewalledRequest", "(", "request", ")", "{", "@", "Override", "public", "void", "reset", "(", ")", "{", "}", "}", ";", "}", "private", "void", "rejectedBlacklistedUrls", "(", "HttpServletRequest", "request", ")", "{", "for", "(", "String", "forbidden", ":", "this", ".", "encodedUrlBlacklist", ")", "{", "if", "(", "encodedUrlContains", "(", "request", ",", "forbidden", ")", ")", "{", "throw", "new", "RequestRejectedException", "(", "\"", "The", "request", "was", "rejected", "because", "the", "URL", "contained", "a", "potentially", "malicious", "String", "\\", "\"\"", "+", "forbidden", "+", "\"", "\\\"", "\")", ";", "}", "}", "for", "(", "String", "forbidden", ":", "this", ".", "decodedUrlBlacklist", ")", "{", "if", "(", "decodedUrlContains", "(", "request", ",", "forbidden", ")", ")", "{", "throw", "new", "RequestRejectedException", "(", "\"", "The", "request", "was", "rejected", "because", "the", "URL", "contained", "a", "potentially", "malicious", "String", "\\", "\"\"", "+", "forbidden", "+", "\"", "\\\"", "\")", ";", "}", "}", "}", "@", "Override", "public", "HttpServletResponse", "getFirewalledResponse", "(", "HttpServletResponse", "response", ")", "{", "return", "new", "FirewalledResponse", "(", "response", ")", ";", "}", "private", "static", "boolean", "isNormalized", "(", "HttpServletRequest", "request", ")", "{", "if", "(", "!", "isNormalized", "(", "request", ".", "getRequestURI", "(", "))", ")", "{", "return", "false", ";", "}", "if", "(", "!", "isNormalized", "(", "request", ".", "getContextPath", "(", "))", ")", "{", "return", "false", ";", "}", "if", "(", "!", "isNormalized", "(", "request", ".", "getServletPath", "(", "))", ")", "{", "return", "false", ";", "}", "if", "(", "!", "isNormalized", "(", "request", ".", "getPathInfo", "(", "))", ")", "{", "return", "false", ";", "}", "return", "true", ";", "}", "private", "static", "boolean", "encodedUrlContains", "(", "HttpServletRequest", "request", ",", "String", "value", ")", "{", "if", "(", "valueContains", "(", "request", ".", "getContextPath", "(", "),", "value", ")", ")", "{", "return", "true", ";", "}", "return", "valueContains", "(", "request", ".", "getRequestURI", "(", "),", "value", ")", ";", "}", "private", "static", "boolean", "decodedUrlContains", "(", "HttpServletRequest", "request", ",", "String", "value", ")", "{", "if", "(", "valueContains", "(", "request", ".", "getServletPath", "(", "),", "value", ")", ")", "{", "return", "true", ";", "}", "if", "(", "valueContains", "(", "request", ".", "getPathInfo", "(", "),", "value", ")", ")", "{", "return", "true", ";", "}", "return", "false", ";", "}", "private", "static", "boolean", "containsOnlyPrintableAsciiCharacters", "(", "String", "uri", ")", "{", "int", "length", "=", "uri", ".", "length", "(", ");", "for", "(", "int", "i", "=", "0", ";", "i", "<", "length", ";", "i", "+", "+)", "{", "char", "c", "=", "uri", ".", "charAt", "(", "i", ")", ";", "if", "(", "c", "<", "'", "\\", "u0021", "'", "|", "|", "'", "\\", "u007e", "'", "<", "c", ")", "{", "return", "false", ";", "}", "}", "return", "true", ";", "}", "private", "static", "boolean", "valueContains", "(", "String", "value", ",", "String", "contains", ")", "{", "return", "value", "!", "=", "null", "&", "&", "value", ".", "contains", "(", "contains", ")", ";", "}", "/", "**", "*", "Checks", "whether", "a", "path", "is", "normalized", "(", "doesn", "'", "t", "contain", "path", "traversal", "*", "sequences", "like", "\"", "./", "\",", "\"", "/.", "./", "\"", "or", "\"", "/.", "\")", "*", "*", "@", "param", "path", "*", "the", "path", "to", "test", "*", "@", "return", "true", "if", "the", "path", "doesn", "'", "t", "contain", "any", "path", "-", "traversal", "character", "*", "sequences", ".", "*", "/", "private", "static", "boolean", "isNormalized", "(", "String", "path", ")", "{", "if", "(", "path", "=", "=", "null", ")", "{", "return", "true", ";", "}", "if", "(", "path", ".", "indexOf", "(", "\"/", "/\"", ")", ">", "0", ")", "{", "return", "false", ";", "}", "for", "(", "int", "j", "=", "path", ".", "length", "(", ");", "j", ">", "0", ";", ")", "{", "int", "i", "=", "path", ".", "lastIndexOf", "(", "'/", "',", "j", "-", "1", ")", ";", "int", "gap", "=", "j", "-", "i", ";", "if", "(", "gap", "=", "=", "2", "&", "&", "path", ".", "charAt", "(", "i", "+", "1", ")", "=", "=", "'", ".'", ")", "{", "/", "/", "\"", ".\"", ",", "\"", "/.", "/\"", "or", "\"", "/.", "\"", "return", "false", ";", "}", "else", "if", "(", "gap", "=", "=", "3", "&", "&", "path", ".", "charAt", "(", "i", "+", "1", ")", "=", "=", "'", ".'", "&", "&", "path", ".", "charAt", "(", "i", "+", "2", ")", "=", "=", "'", ".'", ")", "{", "return", "false", ";", "}", "j", "=", "i", ";", "}", "return", "true", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "351", "@", "@", "/", "*", "*", "Copyright", "2012", "-", "2017", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "springframework", ".", "security", ".", "web", ".", "firewall", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "springframework", ".", "mock", ".", "web", ".", "MockHttpServletRequest", ";", "import", "static", "org", ".", "assertj", ".", "core", ".", "api", ".", "Assertions", ".", "fail", ";", "/", "**", "*", "@", "author", "Rob", "Winch", "*", "/", "public", "class", "StrictHttpFirewallTests", "{", "public", "String", "[", "]", "unnormalizedPaths", "=", "{", "\"", "/.", ".\"", ",", "\"", "/.", "/", "path", "/", "\",", "\"", "/", "path", "/", "path", "/", ".\"", ",", "\"", "/", "path", "/", "path", "/", "/.", "\",", "\"", "./", "path", "/", "..", "/", "path", "/", "/.", "\",", "\"", "./", "path", "\"", ",", "\"", "./", "/", "path", "\"", ",", "\"", ".\"", ",", "\"", "/", "path", "/", "/\"", "}", ";", "private", "StrictHttpFirewall", "firewall", "=", "new", "StrictHttpFirewall", "(", ");", "private", "MockHttpServletRequest", "request", "=", "new", "MockHttpServletRequest", "(", ");", "@", "Test", "public", "void", "getFirewalledRequestWhenRequestURINotNormalizedThenThrowsRequestRejectedException", "(", ")", "throws", "Exception", "{", "for", "(", "String", "path", ":", "this", ".", "unnormalizedPaths", ")", "{", "this", ".", "request", "=", "new", "MockHttpServletRequest", "(", ");", "this", ".", "request", ".", "setRequestURI", "(", "path", ")", ";", "try", "{", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "fail", "(", "path", "+", "\"", "is", "un", "-", "normalized", "\"", ");", "}", "catch", "(", "RequestRejectedException", "expected", ")", "{", "}", "}", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenContextPathNotNormalizedThenThrowsRequestRejectedException", "(", ")", "throws", "Exception", "{", "for", "(", "String", "path", ":", "this", ".", "unnormalizedPaths", ")", "{", "this", ".", "request", "=", "new", "MockHttpServletRequest", "(", ");", "this", ".", "request", ".", "setContextPath", "(", "path", ")", ";", "try", "{", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "fail", "(", "path", "+", "\"", "is", "un", "-", "normalized", "\"", ");", "}", "catch", "(", "RequestRejectedException", "expected", ")", "{", "}", "}", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenServletPathNotNormalizedThenThrowsRequestRejectedException", "(", ")", "throws", "Exception", "{", "for", "(", "String", "path", ":", "this", ".", "unnormalizedPaths", ")", "{", "this", ".", "request", "=", "new", "MockHttpServletRequest", "(", ");", "this", ".", "request", ".", "setServletPath", "(", "path", ")", ";", "try", "{", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "fail", "(", "path", "+", "\"", "is", "un", "-", "normalized", "\"", ");", "}", "catch", "(", "RequestRejectedException", "expected", ")", "{", "}", "}", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenPathInfoNotNormalizedThenThrowsRequestRejectedException", "(", ")", "throws", "Exception", "{", "for", "(", "String", "path", ":", "this", ".", "unnormalizedPaths", ")", "{", "this", ".", "request", "=", "new", "MockHttpServletRequest", "(", ");", "this", ".", "request", ".", "setPathInfo", "(", "path", ")", ";", "try", "{", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "fail", "(", "path", "+", "\"", "is", "un", "-", "normalized", "\"", ");", "}", "catch", "(", "RequestRejectedException", "expected", ")", "{", "}", "}", "}", "/", "/", "-", "--", ";", "-", "--", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "getFirewalledRequestWhenSemicolonInContextPathThenThrowsRequestRejectedException", "(", ")", "{", "this", ".", "request", ".", "setContextPath", "(", "\";", "/", "context", "\"", ");", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "getFirewalledRequestWhenSemicolonInServletPathThenThrowsRequestRejectedException", "(", ")", "{", "this", ".", "request", ".", "setServletPath", "(", "\"/", "spring", ";", "/\"", ");", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "getFirewalledRequestWhenSemicolonInPathInfoThenThrowsRequestRejectedException", "(", ")", "{", "this", ".", "request", ".", "setPathInfo", "(", "\"/", "path", ";", "/\"", ");", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "getFirewalledRequestWhenSemicolonInRequestUriThenThrowsRequestRejectedException", "(", ")", "{", "this", ".", "request", ".", "setRequestURI", "(", "\"/", "path", ";", "/\"", ");", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "getFirewalledRequestWhenEncodedSemicolonInContextPathThenThrowsRequestRejectedException", "(", ")", "{", "this", ".", "request", ".", "setContextPath", "(", "\"%", "3B", "/", "context", "\"", ");", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "getFirewalledRequestWhenEncodedSemicolonInServletPathThenThrowsRequestRejectedException", "(", ")", "{", "this", ".", "request", ".", "setServletPath", "(", "\"/", "spring", "%", "3B", "/", "\")", ";", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "getFirewalledRequestWhenEncodedSemicolonInPathInfoThenThrowsRequestRejectedException", "(", ")", "{", "this", ".", "request", ".", "setPathInfo", "(", "\"/", "path", "%", "3B", "/", "\")", ";", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "getFirewalledRequestWhenEncodedSemicolonInRequestUriThenThrowsRequestRejectedException", "(", ")", "{", "this", ".", "request", ".", "setRequestURI", "(", "\"/", "path", "%", "3B", "/", "\")", ";", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "getFirewalledRequestWhenLowercaseEncodedSemicolonInContextPathThenThrowsRequestRejectedException", "(", ")", "{", "this", ".", "request", ".", "setContextPath", "(", "\"%", "3b", "/", "context", "\"", ");", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "getFirewalledRequestWhenLowercaseEncodedSemicolonInServletPathThenThrowsRequestRejectedException", "(", ")", "{", "this", ".", "request", ".", "setServletPath", "(", "\"/", "spring", "%", "3b", "/", "\")", ";", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "getFirewalledRequestWhenLowercaseEncodedSemicolonInPathInfoThenThrowsRequestRejectedException", "(", ")", "{", "this", ".", "request", ".", "setPathInfo", "(", "\"/", "path", "%", "3b", "/", "\")", ";", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "getFirewalledRequestWhenLowercaseEncodedSemicolonInRequestUriThenThrowsRequestRejectedException", "(", ")", "{", "this", ".", "request", ".", "setRequestURI", "(", "\"/", "path", "%", "3b", "/", "\")", ";", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenSemicolonInContextPathAndAllowSemicolonThenNoException", "(", ")", "{", "this", ".", "firewall", ".", "setAllowSemicolon", "(", "true", ")", ";", "this", ".", "request", ".", "setContextPath", "(", "\";", "/", "context", "\"", ");", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenSemicolonInServletPathAndAllowSemicolonThenNoException", "(", ")", "{", "this", ".", "firewall", ".", "setAllowSemicolon", "(", "true", ")", ";", "this", ".", "request", ".", "setServletPath", "(", "\"/", "spring", ";", "/\"", ");", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenSemicolonInPathInfoAndAllowSemicolonThenNoException", "(", ")", "{", "this", ".", "firewall", ".", "setAllowSemicolon", "(", "true", ")", ";", "this", ".", "request", ".", "setPathInfo", "(", "\"/", "path", ";", "/\"", ");", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenSemicolonInRequestUriAndAllowSemicolonThenNoException", "(", ")", "{", "this", ".", "firewall", ".", "setAllowSemicolon", "(", "true", ")", ";", "this", ".", "request", ".", "setRequestURI", "(", "\"/", "path", ";", "/\"", ");", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenEncodedSemicolonInContextPathAndAllowSemicolonThenNoException", "(", ")", "{", "this", ".", "firewall", ".", "setAllowUrlEncodedPercent", "(", "true", ")", ";", "this", ".", "firewall", ".", "setAllowSemicolon", "(", "true", ")", ";", "this", ".", "request", ".", "setContextPath", "(", "\"%", "3B", "/", "context", "\"", ");", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenEncodedSemicolonInServletPathAndAllowSemicolonThenNoException", "(", ")", "{", "this", ".", "firewall", ".", "setAllowUrlEncodedPercent", "(", "true", ")", ";", "this", ".", "firewall", ".", "setAllowSemicolon", "(", "true", ")", ";", "this", ".", "request", ".", "setServletPath", "(", "\"/", "spring", "%", "3B", "/", "\")", ";", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenEncodedSemicolonInPathInfoAndAllowSemicolonThenNoException", "(", ")", "{", "this", ".", "firewall", ".", "setAllowUrlEncodedPercent", "(", "true", ")", ";", "this", ".", "firewall", ".", "setAllowSemicolon", "(", "true", ")", ";", "this", ".", "request", ".", "setPathInfo", "(", "\"/", "path", "%", "3B", "/", "\")", ";", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenEncodedSemicolonInRequestUriAndAllowSemicolonThenNoException", "(", ")", "{", "this", ".", "firewall", ".", "setAllowSemicolon", "(", "true", ")", ";", "this", ".", "request", ".", "setRequestURI", "(", "\"/", "path", "%", "3B", "/", "\")", ";", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenLowercaseEncodedSemicolonInContextPathAndAllowSemicolonThenNoException", "(", ")", "{", "this", ".", "firewall", ".", "setAllowUrlEncodedPercent", "(", "true", ")", ";", "this", ".", "firewall", ".", "setAllowSemicolon", "(", "true", ")", ";", "this", ".", "request", ".", "setContextPath", "(", "\"%", "3b", "/", "context", "\"", ");", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenLowercaseEncodedSemicolonInServletPathAndAllowSemicolonThenNoException", "(", ")", "{", "this", ".", "firewall", ".", "setAllowUrlEncodedPercent", "(", "true", ")", ";", "this", ".", "firewall", ".", "setAllowSemicolon", "(", "true", ")", ";", "this", ".", "request", ".", "setServletPath", "(", "\"/", "spring", "%", "3b", "/", "\")", ";", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenLowercaseEncodedSemicolonInPathInfoAndAllowSemicolonThenNoException", "(", ")", "{", "this", ".", "firewall", ".", "setAllowUrlEncodedPercent", "(", "true", ")", ";", "this", ".", "firewall", ".", "setAllowSemicolon", "(", "true", ")", ";", "this", ".", "request", ".", "setPathInfo", "(", "\"/", "path", "%", "3b", "/", "\")", ";", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenLowercaseEncodedSemicolonInRequestUriAndAllowSemicolonThenNoException", "(", ")", "{", "this", ".", "firewall", ".", "setAllowSemicolon", "(", "true", ")", ";", "this", ".", "request", ".", "setRequestURI", "(", "\"/", "path", "%", "3b", "/", "\")", ";", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "/", "/", "-", "--", "encoded", ".", "-", "--", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "getFirewalledRequestWhenEncodedPeriodInThenThrowsRequestRejectedException", "(", ")", "{", "this", ".", "request", ".", "setRequestURI", "(", "\"/", "%", "2E", "/", "\")", ";", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "getFirewalledRequestWhenLowercaseEncodedPeriodInThenThrowsRequestRejectedException", "(", ")", "{", "this", ".", "request", ".", "setRequestURI", "(", "\"/", "%", "2e", "/", "\")", ";", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenAllowEncodedPeriodAndEncodedPeriodInThenNoException", "(", ")", "{", "this", ".", "firewall", ".", "setAllowUrlEncodedPeriod", "(", "true", ")", ";", "this", ".", "request", ".", "setRequestURI", "(", "\"/", "%", "2E", "/", "\")", ";", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "/", "/", "-", "--", "from", "DefaultHttpFirewallTests", "-", "--", "/", "**", "*", "On", "WebSphere", "8", ".", "5", "a", "URL", "like", "/", "context", "-", "root", "/", "a", "/", "b", ";", "%", "2f1", "/", "c", "can", "bypass", "a", "rule", "on", "*", "/", "a", "/", "b", "/", "c", "because", "the", "pathInfo", "is", "/", "a", "/", "b", ";", "/", "1", "/", "c", "which", "ends", "up", "being", "/", "a", "/", "b", "/", "1", "/", "c", "*", "while", "Spring", "MVC", "will", "strip", "the", ";", "content", "from", "requestURI", "before", "the", "path", "*", "is", "URL", "decoded", ".", "*", "/", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "getFirewalledRequestWhenLowercaseEncodedPathThenException", "(", ")", "{", "this", ".", "request", ".", "setRequestURI", "(", "\"/", "context", "-", "root", "/", "a", "/", "b", ";", "%", "2f1", "/", "c", "\"", ");", "this", ".", "request", ".", "setContextPath", "(", "\"/", "context", "-", "root", "\"", ");", "this", ".", "request", ".", "setServletPath", "(", "\"\"", ");", "this", ".", "request", ".", "setPathInfo", "(", "\"/", "a", "/", "b", ";", "/", "1", "/", "c", "\"", ");", "/", "/", "URL", "decoded", "requestURI", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "(", "expected", "=", "RequestRejectedException", ".", "class", ")", "public", "void", "getFirewalledRequestWhenUppercaseEncodedPathThenException", "(", ")", "{", "this", ".", "request", ".", "setRequestURI", "(", "\"/", "context", "-", "root", "/", "a", "/", "b", ";", "%", "2F1", "/", "c", "\"", ");", "this", ".", "request", ".", "setContextPath", "(", "\"/", "context", "-", "root", "\"", ");", "this", ".", "request", ".", "setServletPath", "(", "\"\"", ");", "this", ".", "request", ".", "setPathInfo", "(", "\"/", "a", "/", "b", ";", "/", "1", "/", "c", "\"", ");", "/", "/", "URL", "decoded", "requestURI", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "this", ".", "request", ")", ";", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenAllowUrlEncodedSlashAndLowercaseEncodedPathThenNoException", "(", ")", "{", "this", ".", "firewall", ".", "setAllowUrlEncodedSlash", "(", "true", ")", ";", "this", ".", "firewall", ".", "setAllowSemicolon", "(", "true", ")", ";", "MockHttpServletRequest", "request", "=", "new", "MockHttpServletRequest", "(", ");", "request", ".", "setRequestURI", "(", "\"/", "context", "-", "root", "/", "a", "/", "b", ";", "%", "2f1", "/", "c", "\"", ");", "request", ".", "setContextPath", "(", "\"/", "context", "-", "root", "\"", ");", "request", ".", "setServletPath", "(", "\"\"", ");", "request", ".", "setPathInfo", "(", "\"/", "a", "/", "b", ";", "/", "1", "/", "c", "\"", ");", "/", "/", "URL", "decoded", "requestURI", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "request", ")", ";", "}", "@", "Test", "public", "void", "getFirewalledRequestWhenAllowUrlEncodedSlashAndUppercaseEncodedPathThenNoException", "(", ")", "{", "this", ".", "firewall", ".", "setAllowUrlEncodedSlash", "(", "true", ")", ";", "this", ".", "firewall", ".", "setAllowSemicolon", "(", "true", ")", ";", "MockHttpServletRequest", "request", "=", "new", "MockHttpServletRequest", "(", ");", "request", ".", "setRequestURI", "(", "\"/", "context", "-", "root", "/", "a", "/", "b", ";", "%", "2F1", "/", "c", "\"", ");", "request", ".", "setContextPath", "(", "\"/", "context", "-", "root", "\"", ");", "request", ".", "setServletPath", "(", "\"\"", ");", "request", ".", "setPathInfo", "(", "\"/", "a", "/", "b", ";", "/", "1", "/", "c", "\"", ");", "/", "/", "URL", "decoded", "requestURI", "this", ".", "firewall", ".", "getFirewalledRequest", "(", "request", ")", ";", "}", "}"], "docstring_tokens": ["adding", "a", "URL", "path", "parameter", "with", "special", "encodings"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "128", ",", "12", "+", "128", ",", "11", "@", "@", "xfs_nfs_get_inode", "(", "return", "ERR_PTR", "(", "-", "ESTALE", ")", ";", "/", "*", "*", "The", "XFS_IGET_BULKSTAT", "means", "that", "an", "invalid", "inode", "number", "is", "just", "*", "fine", "and", "not", "an", "indication", "of", "a", "corrupted", "filesystem", ".", "Because", "*", "clients", "can", "send", "any", "kind", "of", "invalid", "file", "handle", ",", "e", ".", "g", ".", "after", "*", "a", "restore", "on", "the", "server", "we", "have", "to", "deal", "with", "this", "case", "gracefully", ".", "*", "The", "XFS_IGET_UNTRUSTED", "means", "that", "an", "invalid", "inode", "number", "is", "just", "*", "fine", "and", "not", "an", "indication", "of", "a", "corrupted", "filesystem", "as", "clients", "can", "*", "send", "invalid", "file", "handles", "and", "we", "have", "to", "handle", "it", "gracefully", ".", ".", "*", "/", "error", "=", "xfs_iget", "(", "mp", ",", "NULL", ",", "ino", ",", "XFS_IGET_BULKSTAT", ",", "error", "=", "xfs_iget", "(", "mp", ",", "NULL", ",", "ino", ",", "XFS_IGET_UNTRUSTED", ",", "XFS_ILOCK_SHARED", ",", "&", "ip", ",", "0", ")", ";", "if", "(", "error", ")", "{", "/", "*", "@", "@", "-", "1251", ",", "7", "+", "1251", ",", "7", "@", "@", "xfs_imap_lookup", "(", "return", "error", ";", "/", "*", "for", "untrusted", "inodes", "check", "it", "is", "allocated", "first", "*", "/", "if", "(", "(", "flags", "&", "XFS_IGET_BULKSTAT", ")", "&", "&", "if", "(", "(", "flags", "&", "XFS_IGET_UNTRUSTED", ")", "&", "&", "(", "rec", ".", "ir_free", "&", "XFS_INOBT_MASK", "(", "agino", "-", "rec", ".", "ir_startino", ")", "))", "return", "EINVAL", ";", "@", "@", "-", "1292", ",", "8", "+", "1292", ",", "11", "@", "@", "xfs_imap", "(", "if", "(", "agno", ">", "=", "mp", "-", ">", "m_sb", ".", "sb_agcount", "|", "|", "agbno", ">", "=", "mp", "-", ">", "m_sb", ".", "sb_agblocks", "|", "|", "ino", "!", "=", "XFS_AGINO_TO_INO", "(", "mp", ",", "agno", ",", "agino", ")", ")", "{", "#", "ifdef", "DEBUG", "/", "*", "no", "diagnostics", "for", "bulkstat", ",", "ino", "comes", "from", "userspace", "*", "/", "if", "(", "flags", "&", "XFS_IGET_BULKSTAT", ")", "/", "*", "*", "Don", "'", "t", "output", "diagnostic", "information", "for", "untrusted", "inodes", "*", "as", "they", "can", "be", "invalid", "without", "implying", "corruption", ".", "*", "/", "if", "(", "flags", "&", "XFS_IGET_UNTRUSTED", ")", "return", "XFS_ERROR", "(", "EINVAL", ")", ";", "if", "(", "agno", ">", "=", "mp", "-", ">", "m_sb", ".", "sb_agcount", ")", "{", "xfs_fs_cmn_err", "(", "CE_ALERT", ",", "mp", ",", "@", "@", "-", "1329", ",", "7", "+", "1332", ",", "7", "@", "@", "xfs_imap", "(", "*", "inodes", "in", "stale", "state", "on", "disk", ".", "Hence", "we", "have", "to", "do", "a", "btree", "lookup", "*", "in", "all", "cases", "where", "an", "untrusted", "inode", "number", "is", "passed", ".", "*", "/", "if", "(", "flags", "&", "XFS_IGET_BULKSTAT", ")", "{", "if", "(", "flags", "&", "XFS_IGET_UNTRUSTED", ")", "{", "error", "=", "xfs_imap_lookup", "(", "mp", ",", "tp", ",", "agno", ",", "agino", ",", "agbno", ",", "&", "chunk_agbno", ",", "&", "offset_agbno", ",", "flags", ")", ";", "if", "(", "error", ")", "@", "@", "-", "177", ",", "7", "+", "177", ",", "7", "@", "@", "xfs_imap_to_bp", "(", "if", "(", "unlikely", "(", "XFS_TEST_ERROR", "(", "!", "di_ok", ",", "mp", ",", "XFS_ERRTAG_ITOBP_INOTOBP", ",", "XFS_RANDOM_ITOBP_INOTOBP", ")", "))", "{", "if", "(", "iget_flags", "&", "XFS_IGET_BULKSTAT", ")", "{", "if", "(", "iget_flags", "&", "XFS_IGET_UNTRUSTED", ")", "{", "xfs_trans_brelse", "(", "tp", ",", "bp", ")", ";", "return", "XFS_ERROR", "(", "EINVAL", ")", ";", "}", "@", "@", "-", "500", ",", "7", "+", "500", ",", "7", "@", "@", "do", "{", "\\", "*", "Flags", "for", "xfs_iget", "(", ")", "*", "/", "#", "define", "XFS_IGET_CREATE", "0x1", "#", "define", "XFS_IGET_BULKSTAT", "0x2", "#", "define", "XFS_IGET_UNTRUSTED", "0x2", "int", "xfs_inotobp", "(", "struct", "xfs_mount", "*", ",", "struct", "xfs_trans", "*", ",", "xfs_ino_t", ",", "struct", "xfs_dinode", "*", "*,", "@", "@", "-", "80", ",", "7", "+", "80", ",", "7", "@", "@", "xfs_bulkstat_one_int", "(", "return", "XFS_ERROR", "(", "ENOMEM", ")", ";", "error", "=", "xfs_iget", "(", "mp", ",", "NULL", ",", "ino", ",", "XFS_IGET_BULKSTAT", ",", "XFS_ILOCK_SHARED", ",", "&", "ip", ",", "bno", ")", ";", "XFS_IGET_UNTRUSTED", ",", "XFS_ILOCK_SHARED", ",", "&", "ip", ",", "bno", ")", ";", "if", "(", "error", ")", "{", "*", "stat", "=", "BULKSTAT_RV_NOTHING", ";", "goto", "out_free", ";"], "docstring_tokens": ["create", "a", "stale", "handle", "and", "open", "it"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "390", ",", "6", "+", "390", ",", "15", "@", "@", "public", "void", "getStaticFilePathOperationVulnerability2", "(", ")", "throws", "Exception", "{", "}", "}", "@", "Test", "public", "void", "getStaticFilePathOperationVulnerability3", "(", ")", "throws", "Exception", "{", "HttpGet", "request", "=", "new", "HttpGet", "(", "httpsAdminServerUrl", ".", "replace", "(", "\"", "admin", "\"", ",", "\"", "static", "/", "/.", "..", "//", "..", "./", "/.", "..", "//", "..", "./", "/.", "..", "//", "..", "./", "/.", "..", "//", "..", "./", "/.", "..", "/", "etc", "/", "passwd", "\"", "))", ";", "try", "(", "CloseableHttpResponse", "response", "=", "httpclient", ".", "execute", "(", "request", ")", ")", "{", "assertEquals", "(", "404", ",", "response", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "))", ";", "}", "}", "@", "Test", "public", "void", "testGetFavIconHttp", "(", ")", "throws", "Exception", "{", "HttpGet", "request", "=", "new", "HttpGet", "(", "httpServerUrl", "+", "\"", "favicon", ".", "ico", "\"", ");", "@", "@", "-", "186", ",", "7", "+", "186", ",", "10", "@", "@", "private", "void", "serveStatic", "(", "ChannelHandlerContext", "ctx", ",", "FullHttpRequest", "request", ",", "Sta", "Path", "path", ";", "String", "uri", "=", "request", ".", "uri", "(", ");", "uri", "=", "uri", ".", "replace", "(", "\"/", ".\"", ",", "\"", "\")", ";", "if", "(", "uri", ".", "contains", "(", "\"/", "..", "\")", ")", "{", "sendError", "(", "ctx", ",", "NOT_FOUND", ")", ";", "return", ";", "}", "/", "/", "running", "from", "jar", "if", "(", "isUnpacked", ")", "{", "log", ".", "trace", "(", "\"", "Is", "unpacked", ".", "\")", ";"], "docstring_tokens": ["by", "reading", "the", "/etc/passwd", "file", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "812", ",", "6", "+", "812", ",", "19", "@", "@", "<", "classifier", ">", "core", "<", "/", "classifier", ">", "<", "/", "configuration", ">", "<", "/", "execution", ">", "<", "execution", ">", "<", "id", ">", "fallbackauthorizer", "-", "jar", "<", "/", "id", ">", "<", "phase", ">", "package", "<", "/", "phase", ">", "<", "goals", ">", "<", "goal", ">", "jar", "<", "/", "goal", ">", "<", "/", "goals", ">", "<", "configuration", ">", "<", "classifier", ">", "fallbackauthorizer", "<", "/", "classifier", ">", "<", "includes", ">", "<", "include", ">", "org", "/", "apache", "/", "hadoop", "/", "hive", "/", "ql", "/", "security", "/", "authorization", "/", "plugin", "/", "fallback", "/", "*.", "class", "<", "/", "include", ">", "<", "/", "includes", ">", "<", "/", "configuration", ">", "<", "/", "execution", ">", "<", "/", "executions", ">", "<", "/", "plugin", ">", "<", "plugin", ">", "@", "@", "-", "63", ",", "7", "+", "63", ",", "7", "@", "@", "public", "static", "void", "setHiveConfWhiteList", "(", "HiveConf", "hiveConf", ")", "throws", "HiveAuthzPlugi", "/", "/", "if", "admin", "has", "already", "customized", "this", "list", ",", "honor", "that", "String", "curBlackList", "=", "hiveConf", ".", "getVar", "(", "ConfVars", ".", "HIVE_SERVER2_BUILTIN_UDF_BLACKLIST", ")", ";", "if", "(", "curBlackList", "=", "=", "null", "|", "|", "curBlackList", ".", "trim", "(", ").", "isEmpty", "(", "))", "{", "hiveConf", ".", "setVar", "(", "ConfVars", ".", "HIVE_SERVER2_BUILTIN_UDF_BLACKLIST", ",", "\"", "reflect", ",", "reflect2", ",", "java_method", "\"", ");", "hiveConf", ".", "setVar", "(", "ConfVars", ".", "HIVE_SERVER2_BUILTIN_UDF_BLACKLIST", ",", "\"", "reflect", ",", "reflect2", ",", "java_method", ",", "in_file", "\"", ");", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "253", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "*", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "*", "distributed", "with", "this", "work", "for", "additional", "information", "*", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "*", "to", "you", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "*", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "fallback", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "Log", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "LogFactory", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "conf", ".", "HiveConf", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "parse", ".", "SemanticException", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "HiveAuthenticationProvider", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "AbstractHiveAuthorizer", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "DisallowTransformHook", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "HiveAccessControlException", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "HiveAuthzContext", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "HiveAuthzPluginException", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "HiveAuthzSessionContext", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "HiveOperationType", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "HivePrincipal", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "HivePrivilege", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "HivePrivilegeInfo", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "HivePrivilegeObject", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "HiveRoleGrant", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "SettableConfigUpdater", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "sqlstd", ".", "Operation2Privilege", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "sqlstd", ".", "SQLAuthorizationUtils", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "sqlstd", ".", "SQLPrivTypeGrant", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "List", ";", "public", "class", "FallbackHiveAuthorizer", "extends", "AbstractHiveAuthorizer", "{", "private", "static", "final", "Log", "LOG", "=", "LogFactory", ".", "getLog", "(", "FallbackHiveAuthorizer", ".", "class", ")", ";", "private", "final", "HiveAuthzSessionContext", "sessionCtx", ";", "private", "final", "HiveAuthenticationProvider", "authenticator", ";", "private", "String", "[", "]", "admins", "=", "null", ";", "FallbackHiveAuthorizer", "(", "HiveConf", "hiveConf", ",", "HiveAuthenticationProvider", "hiveAuthenticator", ",", "HiveAuthzSessionContext", "ctx", ")", "{", "this", ".", "authenticator", "=", "hiveAuthenticator", ";", "this", ".", "sessionCtx", "=", "applyTestSettings", "(", "ctx", ",", "hiveConf", ")", ";", "String", "adminString", "=", "hiveConf", ".", "getVar", "(", "HiveConf", ".", "ConfVars", ".", "USERS_IN_ADMIN_ROLE", ")", ";", "if", "(", "adminString", "!", "=", "null", ")", "{", "admins", "=", "hiveConf", ".", "getVar", "(", "HiveConf", ".", "ConfVars", ".", "USERS_IN_ADMIN_ROLE", ")", ".", "split", "(", "\",", "\")", ";", "}", "}", "/", "**", "*", "Change", "the", "session", "context", "based", "on", "configuration", "to", "aid", "in", "testing", "of", "sql", "*", "std", "auth", "*", "*", "@", "param", "ctx", "*", "@", "param", "conf", "*", "@", "return", "*", "/", "static", "HiveAuthzSessionContext", "applyTestSettings", "(", "HiveAuthzSessionContext", "ctx", ",", "HiveConf", "conf", ")", "{", "if", "(", "conf", ".", "getBoolVar", "(", "HiveConf", ".", "ConfVars", ".", "HIVE_TEST_AUTHORIZATION_SQLSTD_HS2_MODE", ")", "&", "&", "ctx", ".", "getClientType", "(", ")", "=", "=", "HiveAuthzSessionContext", ".", "CLIENT_TYPE", ".", "HIVECLI", ")", "{", "/", "/", "create", "new", "session", "ctx", "object", "with", "HS2", "as", "client", "type", "HiveAuthzSessionContext", ".", "Builder", "ctxBuilder", "=", "new", "HiveAuthzSessionContext", ".", "Builder", "(", "ctx", ")", ";", "ctxBuilder", ".", "setClientType", "(", "HiveAuthzSessionContext", ".", "CLIENT_TYPE", ".", "HIVESERVER2", ")", ";", "return", "ctxBuilder", ".", "build", "(", ");", "}", "return", "ctx", ";", "}", "@", "Override", "public", "VERSION", "getVersion", "(", ")", "{", "return", "VERSION", ".", "V1", ";", "}", "@", "Override", "public", "void", "grantPrivileges", "(", "List", "<", "HivePrincipal", ">", "hivePrincipals", ",", "List", "<", "HivePrivilege", ">", "hivePrivileges", ",", "HivePrivilegeObject", "hivePrivObject", ",", "HivePrincipal", "grantorPrincipal", ",", "boolean", "grantOption", ")", "throws", "HiveAuthzPluginException", "{", "throw", "new", "HiveAuthzPluginException", "(", "\"", "grantPrivileges", "not", "implemented", "in", "FallbackHiveAuthorizer", "\"", ");", "}", "@", "Override", "public", "void", "revokePrivileges", "(", "List", "<", "HivePrincipal", ">", "hivePrincipals", ",", "List", "<", "HivePrivilege", ">", "hivePrivileges", ",", "HivePrivilegeObject", "hivePrivObject", ",", "HivePrincipal", "grantorPrincipal", ",", "boolean", "grantOption", ")", "throws", "HiveAuthzPluginException", "{", "throw", "new", "HiveAuthzPluginException", "(", "\"", "revokePrivileges", "not", "implemented", "in", "FallbackHiveAuthorizer", "\"", ");", "}", "@", "Override", "public", "void", "createRole", "(", "String", "roleName", ",", "HivePrincipal", "adminGrantor", ")", "throws", "HiveAuthzPluginException", "{", "throw", "new", "HiveAuthzPluginException", "(", "\"", "createRole", "not", "implemented", "in", "FallbackHiveAuthorizer", "\"", ");", "}", "@", "Override", "public", "void", "dropRole", "(", "String", "roleName", ")", "throws", "HiveAuthzPluginException", ",", "HiveAccessControlException", "{", "throw", "new", "HiveAuthzPluginException", "(", "\"", "dropRole", "not", "implemented", "in", "FallbackHiveAuthorizer", "\"", ");", "}", "@", "Override", "public", "List", "<", "HiveRoleGrant", ">", "getPrincipalGrantInfoForRole", "(", "String", "roleName", ")", "throws", "HiveAuthzPluginException", ",", "HiveAccessControlException", "{", "throw", "new", "HiveAuthzPluginException", "(", "\"", "getPrincipalGrantInfoForRole", "not", "implemented", "in", "FallbackHiveAuthorizer", "\"", ");", "}", "@", "Override", "public", "List", "<", "HiveRoleGrant", ">", "getRoleGrantInfoForPrincipal", "(", "HivePrincipal", "principal", ")", "throws", "HiveAuthzPluginException", ",", "HiveAccessControlException", "{", "throw", "new", "HiveAuthzPluginException", "(", "\"", "getRoleGrantInfoForPrincipal", "not", "implemented", "in", "FallbackHiveAuthorizer", "\"", ");", "}", "@", "Override", "public", "void", "grantRole", "(", "List", "<", "HivePrincipal", ">", "hivePrincipals", ",", "List", "<", "String", ">", "roles", ",", "boolean", "grantOption", ",", "HivePrincipal", "grantorPrinc", ")", "throws", "HiveAuthzPluginException", ",", "HiveAccessControlException", "{", "throw", "new", "HiveAuthzPluginException", "(", "\"", "grantRole", "not", "implemented", "in", "FallbackHiveAuthorizer", "\"", ");", "}", "@", "Override", "public", "void", "revokeRole", "(", "List", "<", "HivePrincipal", ">", "hivePrincipals", ",", "List", "<", "String", ">", "roles", ",", "boolean", "grantOption", ",", "HivePrincipal", "grantorPrinc", ")", "throws", "HiveAuthzPluginException", ",", "HiveAccessControlException", "{", "throw", "new", "HiveAuthzPluginException", "(", "\"", "revokeRole", "not", "implemented", "in", "FallbackHiveAuthorizer", "\"", ");", "}", "@", "Override", "public", "void", "checkPrivileges", "(", "HiveOperationType", "hiveOpType", ",", "List", "<", "HivePrivilegeObject", ">", "inputHObjs", ",", "List", "<", "HivePrivilegeObject", ">", "outputHObjs", ",", "HiveAuthzContext", "context", ")", "throws", "HiveAuthzPluginException", ",", "HiveAccessControlException", "{", "String", "userName", "=", "authenticator", ".", "getUserName", "(", ");", "/", "/", "check", "privileges", "on", "input", "and", "output", "objects", "List", "<", "String", ">", "deniedMessages", "=", "new", "ArrayList", "<", ">(", ");", "checkPrivileges", "(", "hiveOpType", ",", "inputHObjs", ",", "userName", ",", "Operation2Privilege", ".", "IOType", ".", "INPUT", ",", "deniedMessages", ")", ";", "checkPrivileges", "(", "hiveOpType", ",", "outputHObjs", ",", "userName", ",", "Operation2Privilege", ".", "IOType", ".", "OUTPUT", ",", "deniedMessages", ")", ";", "SQLAuthorizationUtils", ".", "assertNoDeniedPermissions", "(", "new", "HivePrincipal", "(", "userName", ",", "HivePrincipal", ".", "HivePrincipalType", ".", "USER", ")", ",", "hiveOpType", ",", "deniedMessages", ")", ";", "}", "/", "/", "Adapted", "from", "SQLStdHiveAuthorizationValidator", ",", "only", "check", "privileges", "for", "LOAD", "/", "ADD", "/", "DFS", "/", "COMPILE", "and", "admin", "privileges", "private", "void", "checkPrivileges", "(", "HiveOperationType", "hiveOpType", ",", "List", "<", "HivePrivilegeObject", ">", "hiveObjects", ",", "String", "userName", ",", "Operation2Privilege", ".", "IOType", "ioType", ",", "List", "<", "String", ">", "deniedMessages", ")", "{", "if", "(", "hiveObjects", "=", "=", "null", ")", "{", "return", ";", "}", "if", "(", "admins", "!", "=", "null", "&", "&", "Arrays", ".", "stream", "(", "admins", ")", ".", "parallel", "(", ").", "anyMatch", "(", "n", "-", ">", "n", ".", "equals", "(", "userName", ")", "))", "{", "return", ";", "/", "/", "Skip", "rest", "of", "checks", "if", "user", "is", "admin", "}", "/", "/", "Special", "-", "casing", "for", "ADMIN", "-", "level", "operations", "that", "do", "not", "require", "object", "checking", ".", "if", "(", "Operation2Privilege", ".", "isAdminPrivOperation", "(", "hiveOpType", ")", ")", "{", "/", "/", "Require", "ADMIN", "privilege", "deniedMessages", ".", "add", "(", "SQLPrivTypeGrant", ".", "ADMIN_PRIV", ".", "toString", "(", ")", "+", "\"", "on", "\"", "+", "ioType", ")", ";", "return", ";", "/", "/", "Ignore", "object", ",", "fail", "if", "not", "admin", ",", "succeed", "if", "admin", ".", "}", "boolean", "needAdmin", "=", "false", ";", "for", "(", "HivePrivilegeObject", "hiveObj", ":", "hiveObjects", ")", "{", "/", "/", "If", "involving", "local", "file", "system", "if", "(", "hiveObj", ".", "getType", "(", ")", "=", "=", "HivePrivilegeObject", ".", "HivePrivilegeObjectType", ".", "LOCAL_URI", ")", "{", "needAdmin", "=", "true", ";", "break", ";", "}", "}", "if", "(", "!", "needAdmin", ")", "{", "switch", "(", "hiveOpType", ")", "{", "case", "ADD", ":", "case", "DFS", ":", "case", "COMPILE", ":", "needAdmin", "=", "true", ";", "break", ";", "default", ":", "break", ";", "}", "}", "if", "(", "needAdmin", ")", "{", "deniedMessages", ".", "add", "(", "\"", "ADMIN", "\"", ");", "}", "}", "@", "Override", "public", "List", "<", "HivePrivilegeObject", ">", "filterListCmdObjects", "(", "List", "<", "HivePrivilegeObject", ">", "listObjs", ",", "HiveAuthzContext", "context", ")", "{", "return", "listObjs", ";", "}", "@", "Override", "public", "List", "<", "String", ">", "getAllRoles", "(", ")", "throws", "HiveAuthzPluginException", "{", "throw", "new", "HiveAuthzPluginException", "(", "\"", "getAllRoles", "not", "implemented", "in", "FallbackHiveAuthorizer", "\"", ");", "}", "@", "Override", "public", "List", "<", "HivePrivilegeInfo", ">", "showPrivileges", "(", "HivePrincipal", "principal", ",", "HivePrivilegeObject", "privObj", ")", "throws", "HiveAuthzPluginException", "{", "throw", "new", "HiveAuthzPluginException", "(", "\"", "showPrivileges", "not", "implemented", "in", "FallbackHiveAuthorizer", "\"", ");", "}", "@", "Override", "public", "void", "setCurrentRole", "(", "String", "roleName", ")", "throws", "HiveAuthzPluginException", "{", "throw", "new", "HiveAuthzPluginException", "(", "\"", "setCurrentRole", "not", "implemented", "in", "FallbackHiveAuthorizer", "\"", ");", "}", "@", "Override", "public", "List", "<", "String", ">", "getCurrentRoleNames", "(", ")", "throws", "HiveAuthzPluginException", "{", "throw", "new", "HiveAuthzPluginException", "(", "\"", "getCurrentRoleNames", "not", "implemented", "in", "FallbackHiveAuthorizer", "\"", ");", "}", "@", "Override", "public", "void", "applyAuthorizationConfigPolicy", "(", "HiveConf", "hiveConf", ")", "throws", "HiveAuthzPluginException", "{", "/", "/", "from", "SQLStdHiveAccessController", ".", "applyAuthorizationConfigPolicy", "(", ")", "if", "(", "sessionCtx", ".", "getClientType", "(", ")", "=", "=", "HiveAuthzSessionContext", ".", "CLIENT_TYPE", ".", "HIVESERVER2", "&", "&", "hiveConf", ".", "getBoolVar", "(", "HiveConf", ".", "ConfVars", ".", "HIVE_AUTHORIZATION_ENABLED", ")", ")", "{", "/", "/", "Configure", "PREEXECHOOKS", "with", "DisallowTransformHook", "to", "disallow", "transform", "queries", "String", "hooks", "=", "hiveConf", ".", "getVar", "(", "HiveConf", ".", "ConfVars", ".", "PREEXECHOOKS", ")", ".", "trim", "(", ");", "if", "(", "hooks", ".", "isEmpty", "(", "))", "{", "hooks", "=", "DisallowTransformHook", ".", "class", ".", "getName", "(", ");", "}", "else", "{", "hooks", "=", "hooks", "+", "\"", ",\"", "+", "DisallowTransformHook", ".", "class", ".", "getName", "(", ");", "}", "LOG", ".", "debug", "(", "\"", "Configuring", "hooks", ":", "\"", "+", "hooks", ")", ";", "hiveConf", ".", "setVar", "(", "HiveConf", ".", "ConfVars", ".", "PREEXECHOOKS", ",", "hooks", ")", ";", "SettableConfigUpdater", ".", "setHiveConfWhiteList", "(", "hiveConf", ")", ";", "String", "curBlackList", "=", "hiveConf", ".", "getVar", "(", "HiveConf", ".", "ConfVars", ".", "HIVE_SERVER2_BUILTIN_UDF_BLACKLIST", ")", ";", "if", "(", "curBlackList", "!", "=", "null", "&", "&", "curBlackList", ".", "trim", "(", ").", "equals", "(", "\"", "reflect", ",", "reflect2", ",", "java_method", "\"", "))", "{", "hiveConf", ".", "setVar", "(", "HiveConf", ".", "ConfVars", ".", "HIVE_SERVER2_BUILTIN_UDF_BLACKLIST", ",", "\"", "reflect", ",", "reflect2", ",", "java_method", ",", "in_file", "\"", ");", "}", "}", "}", "@", "Override", "public", "List", "<", "HivePrivilegeObject", ">", "applyRowFilterAndColumnMasking", "(", "HiveAuthzContext", "context", ",", "List", "<", "HivePrivilegeObject", ">", "privObjs", ")", "throws", "SemanticException", "{", "return", "privObjs", ";", "}", "@", "Override", "public", "boolean", "needTransform", "(", ")", "{", "return", "false", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "36", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "*", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "*", "distributed", "with", "this", "work", "for", "additional", "information", "*", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "*", "to", "you", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "*", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "fallback", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "conf", ".", "HiveConf", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "HiveAuthenticationProvider", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "HiveAuthorizer", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "HiveAuthorizerFactory", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "HiveAuthzPluginException", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "HiveAuthzSessionContext", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "HiveMetastoreClientFactory", ";", "public", "class", "FallbackHiveAuthorizerFactory", "implements", "HiveAuthorizerFactory", "{", "@", "Override", "public", "HiveAuthorizer", "createHiveAuthorizer", "(", "HiveMetastoreClientFactory", "metastoreClientFactory", ",", "HiveConf", "conf", ",", "HiveAuthenticationProvider", "authenticator", ",", "HiveAuthzSessionContext", "ctx", ")", "{", "return", "new", "FallbackHiveAuthorizer", "(", "conf", ",", "authenticator", ",", "ctx", ")", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "4", "@", "@", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "fallback", ".", "FallbackHiveAuthorizerFactory", ";", "add", "jar", "dummy", ".", "jar", "@", "@", "-", "0", ",", "0", "+", "1", ",", "9", "@", "@", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "fallback", ".", "FallbackHiveAuthorizerFactory", ";", "compile", "`", "import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "exec", ".", "UDF", "\\", ";", "public", "class", "Pyth", "extends", "UDF", "{", "public", "double", "evaluate", "(", "double", "a", ",", "double", "b", ")", "{", "return", "Math", ".", "sqrt", "(", "(", "a", "*", "a", ")", "+", "(", "b", "*", "b", ")", ")", "\\", ";", "}", "}", "`", "AS", "GROOVY", "NAMED", "Pyth", ".", "groovy", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "5", "@", "@", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "fallback", ".", "FallbackHiveAuthorizerFactory", ";", "-", "-", "permanent", "function", "creation", "should", "fail", "for", "non", "-", "admin", "roles", "create", "function", "perm_fn", "as", "'", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "udf", ".", "UDFAscii", "'", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "6", "@", "@", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "fallback", ".", "FallbackHiveAuthorizerFactory", ";", "-", "-", "temp", "function", "creation", "should", "fail", "for", "non", "-", "admin", "roles", "create", "temporary", "function", "temp_fn", "as", "'", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "udf", ".", "UDFAscii", "'", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "4", "@", "@", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "fallback", ".", "FallbackHiveAuthorizerFactory", ";", "dfs", "-", "ls", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "6", "@", "@", "set", "hive", ".", "test", ".", "authz", ".", "sstd", ".", "hs2", ".", "mode", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "fallback", ".", "FallbackHiveAuthorizerFactory", ";", "create", "table", "t1", "(", "i", "int", ")", ";", "SELECT", "TRANSFORM", "(", "*)", "USING", "'", "cat", "'", "AS", "(", "key", ",", "value", ")", "FROM", "t1", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "15", "@", "@", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "fallback", ".", "FallbackHiveAuthorizerFactory", ";", "!", "cp", ".", "./", "..", "/", "data", "/", "files", "/", "kv1", ".", "txt", ".", ";", "create", "table", "fallbackauthload", "(", "c1", "string", ",", "c2", "string", ")", ";", "!", "chmod", "777", "kv1", ".", "txt", ";", "load", "data", "local", "inpath", "'", "kv1", ".", "txt", "'", "into", "table", "fallbackauthload", ";", "!", "chmod", "755", "kv1", ".", "txt", ";", "load", "data", "local", "inpath", "'", "kv1", ".", "txt", "'", "into", "table", "fallbackauthload", ";", "!", "rm", "kv1", ".", "txt", ";", "drop", "table", "fallbackauthload", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "8", "@", "@", "set", "hive", ".", "test", ".", "authz", ".", "sstd", ".", "hs2", ".", "mode", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "fallback", ".", "FallbackHiveAuthorizerFactory", ";", "-", "-", "run", "a", "sql", "query", "to", "initialize", "authorization", ",", "then", "try", "setting", "a", "allowed", "config", "and", "then", "a", "disallowed", "config", "param", "use", "default", ";", "set", "hive", ".", "optimize", ".", "listbucketing", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "true", ";", "@", "@", "-", "0", ",", "0", "+", "1", "@", "@", "Query", "returned", "non", "-", "zero", "code", ":", "1", ",", "cause", ":", "Permission", "denied", ":", "Principal", "[", "name", "=", "hive_test_user", ",", "type", "=", "USER", "]", "does", "not", "have", "following", "privileges", "for", "operation", "ADD", "[", "ADMIN", "]", "@", "@", "-", "0", ",", "0", "+", "1", "@", "@", "Query", "returned", "non", "-", "zero", "code", ":", "1", ",", "cause", ":", "Permission", "denied", ":", "Principal", "[", "name", "=", "hive_test_user", ",", "type", "=", "USER", "]", "does", "not", "have", "following", "privileges", "for", "operation", "COMPILE", "[", "ADMIN", "]", "@", "@", "-", "0", ",", "0", "+", "1", "@", "@", "FAILED", ":", "HiveAccessControlException", "Permission", "denied", ":", "Principal", "[", "name", "=", "hive_test_user", ",", "type", "=", "USER", "]", "does", "not", "have", "following", "privileges", "for", "operation", "CREATEFUNCTION", "[", "ADMIN", "PRIVILEGE", "on", "INPUT", ",", "ADMIN", "PRIVILEGE", "on", "OUTPUT", "]", "@", "@", "-", "0", ",", "0", "+", "1", "@", "@", "FAILED", ":", "HiveAccessControlException", "Permission", "denied", ":", "Principal", "[", "name", "=", "hive_test_user", ",", "type", "=", "USER", "]", "does", "not", "have", "following", "privileges", "for", "operation", "CREATEFUNCTION", "[", "ADMIN", "PRIVILEGE", "on", "INPUT", ",", "ADMIN", "PRIVILEGE", "on", "OUTPUT", "]", "@", "@", "-", "0", ",", "0", "+", "1", "@", "@", "Query", "returned", "non", "-", "zero", "code", ":", "1", ",", "cause", ":", "Permission", "denied", ":", "Principal", "[", "name", "=", "hive_test_user", ",", "type", "=", "USER", "]", "does", "not", "have", "following", "privileges", "for", "operation", "DFS", "[", "ADMIN", "]", "@", "@", "-", "0", ",", "0", "+", "1", ",", "16", "@", "@", "PREHOOK", ":", "query", ":", "create", "table", "t1", "(", "i", "int", ")", "PREHOOK", ":", "type", ":", "CREATETABLE", "PREHOOK", ":", "Output", ":", "database", ":", "default", "PREHOOK", ":", "Output", ":", "default", "@", "t1", "POSTHOOK", ":", "query", ":", "create", "table", "t1", "(", "i", "int", ")", "POSTHOOK", ":", "type", ":", "CREATETABLE", "POSTHOOK", ":", "Output", ":", "database", ":", "default", "POSTHOOK", ":", "Output", ":", "default", "@", "t1", "PREHOOK", ":", "query", ":", "SELECT", "TRANSFORM", "(", "*)", "USING", "'", "cat", "'", "AS", "(", "key", ",", "value", ")", "FROM", "t1", "PREHOOK", ":", "type", ":", "QUERY", "PREHOOK", ":", "Input", ":", "default", "@", "t1", "#", "##", "#", "A", "masked", "pattern", "was", "here", "#", "##", "#", "FAILED", ":", "Hive", "Internal", "Error", ":", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "HiveAccessControlException", "(", "Query", "with", "transform", "clause", "is", "disallowed", "in", "current", "configuration", ".", ")", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "HiveAccessControlException", ":", "Query", "with", "transform", "clause", "is", "disallowed", "in", "current", "configuration", ".", "#", "##", "#", "A", "masked", "pattern", "was", "here", "#", "##", "#", "@", "@", "-", "0", ",", "0", "+", "1", ",", "9", "@", "@", "PREHOOK", ":", "query", ":", "create", "table", "fallbackauthload", "(", "c1", "string", ",", "c2", "string", ")", "PREHOOK", ":", "type", ":", "CREATETABLE", "PREHOOK", ":", "Output", ":", "database", ":", "default", "PREHOOK", ":", "Output", ":", "default", "@", "fallbackauthload", "POSTHOOK", ":", "query", ":", "create", "table", "fallbackauthload", "(", "c1", "string", ",", "c2", "string", ")", "POSTHOOK", ":", "type", ":", "CREATETABLE", "POSTHOOK", ":", "Output", ":", "database", ":", "default", "POSTHOOK", ":", "Output", ":", "default", "@", "fallbackauthload", "FAILED", ":", "HiveAccessControlException", "Permission", "denied", ":", "Principal", "[", "name", "=", "hive_test_user", ",", "type", "=", "USER", "]", "does", "not", "have", "following", "privileges", "for", "operation", "LOAD", "[", "ADMIN", "]", "@", "@", "-", "0", ",", "0", "+", "1", ",", "7", "@", "@", "PREHOOK", ":", "query", ":", "use", "default", "PREHOOK", ":", "type", ":", "SWITCHDATABASE", "PREHOOK", ":", "Input", ":", "database", ":", "default", "POSTHOOK", ":", "query", ":", "use", "default", "POSTHOOK", ":", "type", ":", "SWITCHDATABASE", "POSTHOOK", ":", "Input", ":", "database", ":", "default", "Query", "returned", "non", "-", "zero", "code", ":", "1", ",", "cause", ":", "Cannot", "modify", "hive", ".", "security", ".", "authorization", ".", "enabled", "at", "runtime", ".", "It", "is", "not", "in", "list", "of", "params", "that", "are", "allowed", "to", "be", "modified", "at", "runtime"], "docstring_tokens": ["using", "EXPLAIN", "on", "arbitrary", "table"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "37", ",", "4", "+", "37", ",", "6", "@", "@", "public", "static", "StringSystemProperty", "HOST_GEO_LOOKUP_IMPL_LEGACY", "=", "new", "StringSystemProperty", "(", "\"", "brooklyn", ".", "location", ".", "geo", ".", "HostGeoLookup", "\"", ");", "public", "static", "StringSystemProperty", "HOST_GEO_LOOKUP_IMPL", "=", "new", "StringSystemProperty", "(", "\"", "org", ".", "apache", ".", "brooklyn", ".", "core", ".", "location", ".", "geo", ".", "HostGeoLookup", "\"", ");", "/", "**", "Allows", "the", "use", "of", "YAML", "tags", "to", "create", "arbitrary", "types", "known", "to", "Java", ".", "*", "/", "public", "static", "BooleanSystemProperty", "YAML_TYPE_INSTANTIATION", "=", "new", "BooleanSystemProperty", "(", "\"", "org", ".", "apache", ".", "brooklyn", ".", "unsafe", ".", "YamlTypeInstantiation", "\"", ");", "}", "@", "@", "-", "34", ",", "11", "+", "34", ",", "13", "@", "@", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "collections", ".", "MutableList", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "exceptions", ".", "Exceptions", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "exceptions", ".", "UserFacingException", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "internal", ".", "BrooklynSystemProperties", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "text", ".", "Strings", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "yaml", ".", "Yamls", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "import", "org", ".", "yaml", ".", "snakeyaml", ".", "Yaml", ";", "import", "org", ".", "yaml", ".", "snakeyaml", ".", "constructor", ".", "Constructor", ";", "import", "org", ".", "yaml", ".", "snakeyaml", ".", "constructor", ".", "SafeConstructor", ";", "import", "org", ".", "yaml", ".", "snakeyaml", ".", "error", ".", "Mark", ";", "import", "org", ".", "yaml", ".", "snakeyaml", ".", "nodes", ".", "MappingNode", ";", "import", "org", ".", "yaml", ".", "snakeyaml", ".", "nodes", ".", "Node", ";", "@", "@", "-", "54", ",", "6", "+", "56", ",", "14", "@", "@", "private", "static", "final", "Logger", "log", "=", "LoggerFactory", ".", "getLogger", "(", "Yamls", ".", "class", ")", ";", "private", "static", "Yaml", "newYaml", "(", ")", "{", "return", "new", "Yaml", "(", "BrooklynSystemProperties", ".", "YAML_TYPE_INSTANTIATION", ".", "isEnabled", "(", ")", "?", "new", "Constructor", "(", ")", "/", "/", "allows", "instantiation", "of", "arbitrary", "Java", "types", ":", "new", "SafeConstructor", "(", ")", "/", "/", "allows", "instantiation", "of", "limited", "set", "of", "types", "only", ")", ";", "}", "/", "**", "returns", "the", "given", "(", "yaml", "-", "parsed", ")", "object", "as", "the", "given", "yaml", "type", ".", "*", "<", "p", ">", "*", "if", "the", "object", "is", "an", "iterable", "or", "iterator", "this", "method", "will", "fully", "expand", "it", "as", "a", "list", ".", "@", "@", "-", "93", ",", "7", "+", "103", ",", "7", "@", "@", "*", "/", "@", "Beta", "public", "static", "Object", "getAt", "(", "String", "yaml", ",", "List", "<", "String", ">", "path", ")", "{", "Iterable", "<", "Object", ">", "result", "=", "new", "org", ".", "yaml", ".", "snakeyaml", ".", "Yaml", "(", ").", "loadAll", "(", "yaml", ")", ";", "Iterable", "<", "Object", ">", "result", "=", "newYaml", "(", ").", "loadAll", "(", "yaml", ")", ";", "Object", "current", "=", "result", ".", "iterator", "(", ").", "next", "(", ");", "return", "getAtPreParsed", "(", "current", ",", "path", ")", ";", "}", "@", "@", "-", "152", ",", "14", "+", "162", ",", "14", "@", "@", "public", "static", "void", "dump", "(", "int", "depth", ",", "Object", "r", ")", "{", "/", "**", "simplifies", "new", "Yaml", "(", ").", "loadAll", ",", "and", "converts", "to", "list", "to", "prevent", "single", "-", "use", "iterable", "bug", "in", "yaml", "*", "/", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "public", "static", "Iterable", "<", "Object", ">", "parseAll", "(", "String", "yaml", ")", "{", "Iterable", "<", "Object", ">", "result", "=", "new", "org", ".", "yaml", ".", "snakeyaml", ".", "Yaml", "(", ").", "loadAll", "(", "yaml", ")", ";", "Iterable", "<", "Object", ">", "result", "=", "newYaml", "(", ").", "loadAll", "(", "yaml", ")", ";", "return", "(", "List", "<", "Object", ">", ")", "getAs", "(", "result", ",", "List", ".", "class", ")", ";", "}", "/", "**", "as", "{", "@", "link", "#", "parseAll", "(", "String", ")", "}", "*", "/", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "public", "static", "Iterable", "<", "Object", ">", "parseAll", "(", "Reader", "yaml", ")", "{", "Iterable", "<", "Object", ">", "result", "=", "new", "org", ".", "yaml", ".", "snakeyaml", ".", "Yaml", "(", ").", "loadAll", "(", "yaml", ")", ";", "Iterable", "<", "Object", ">", "result", "=", "newYaml", "(", ").", "loadAll", "(", "yaml", ")", ";", "return", "(", "List", "<", "Object", ">", ")", "getAs", "(", "result", ",", "List", ".", "class", ")", ";", "}", "@", "@", "-", "536", ",", "7", "+", "546", ",", "7", "@", "@", "public", "static", "YamlExtract", "getTextOfYamlAtPath", "(", "String", "yaml", ",", "Object", ".", "..", "path", ")", "{", "try", "{", "int", "pathIndex", "=", "0", ";", "result", ".", "yaml", "=", "yaml", ";", "result", ".", "focus", "=", "new", "Yaml", "(", ").", "compose", "(", "new", "StringReader", "(", "yaml", ")", ");", "result", ".", "focus", "=", "newYaml", "(", ").", "compose", "(", "new", "StringReader", "(", "yaml", ")", ");", "findTextOfYamlAtPath", "(", "result", ",", "pathIndex", ",", "path", ")", ";", "return", "result", ";", "@", "@", "-", "19", ",", "18", "+", "19", ",", "20", "@", "@", "package", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "yaml", ";", "import", "static", "org", ".", "testng", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "testng", ".", "Assert", ".", "assertFalse", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "test", ".", "Asserts", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "collections", ".", "MutableList", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "exceptions", ".", "UserFacingException", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "yaml", ".", "Yamls", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "yaml", ".", "YamlsTest", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "internal", ".", "BrooklynSystemProperties", ";", "import", "org", ".", "apache", ".", "brooklyn", ".", "util", ".", "yaml", ".", "Yamls", ".", "YamlExtract", ";", "import", "org", ".", "testng", ".", "Assert", ";", "import", "org", ".", "testng", ".", "TestNG", ";", "import", "org", ".", "testng", ".", "annotations", ".", "Test", ";", "import", "org", ".", "yaml", ".", "snakeyaml", ".", "constructor", ".", "ConstructorException", ";", "import", "com", ".", "google", ".", "common", ".", "collect", ".", "ImmutableList", ";", "import", "com", ".", "google", ".", "common", ".", "collect", ".", "ImmutableMap", ";", "@", "@", "-", "183", ",", "6", "+", "185", ",", "22", "@", "@", "public", "void", "testExtractNoOOBE", "(", ")", "{", "}", "}", "@", "Test", "public", "void", "testSafeYaml", "(", ")", "throws", "Exception", "{", "assertFalse", "(", "BrooklynSystemProperties", ".", "YAML_TYPE_INSTANTIATION", ".", "isEnabled", "(", "),", "\"", "Set", "property", "to", "false", "(", "or", "do", "not", "set", "at", "all", ")", ":", "\"", "+", "BrooklynSystemProperties", ".", "YAML_TYPE_INSTANTIATION", ".", "getPropertyName", "(", "))", ";", "try", "{", "Yamls", ".", "parseAll", "(", "\"!", "!", "java", ".", "util", ".", "Date", "\\", "n", "\"", "\"", "date", ":", "25", "\\", "n", "\"", "\"", "month", ":", "12", "\\", "n", "\"", "\"", "year", ":", "2016", "\"", ");", "Asserts", ".", "shouldHaveFailedPreviously", "(", "\"", "Expected", "exception", ":", "\"", "+", "ConstructorException", ".", "class", ".", "getCanonicalName", "(", "))", ";", "}", "catch", "(", "ConstructorException", "e", ")", "{", "Asserts", ".", "expectedFailureContains", "(", "e", ",", "\"", "could", "not", "determine", "a", "constructor", "\"", ");", "}", "}", "/", "/", "convenience", ",", "since", "running", "with", "older", "TestNG", "IDE", "plugin", "will", "fail", "(", "older", "snakeyaml", "dependency", ")", ";", "/", "/", "if", "you", "run", "as", "a", "java", "app", "it", "doesn", "'", "t", "bring", "in", "the", "IDE", "TestNG", "jar", "version", ",", "and", "it", "works", "public", "static", "void", "main", "(", "String", "[", "]", "args", ")", "{"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "290", ",", "7", "+", "290", ",", "7", "@", "@", "static", "ssize_t", "picolcd_operation_mode_store", "(", "struct", "device", "*", "dev", ",", "buf", "+", "=", "10", ";", "cnt", "-", "=", "10", ";", "}", "if", "(", "!", "report", ")", "if", "(", "!", "report", "|", "|", "report", "-", ">", "maxfield", "!", "=", "1", ")", "return", "-", "EINVAL", ";", "while", "(", "cnt", ">", "0", "&", "&", "(", "buf", "[", "cnt", "-", "1", "]", "=", "=", "'", "\\", "n", "'", "|", "|", "buf", "[", "cnt", "-", "1", "]", "=", "=", "'", "\\", "r", "'", "))"], "docstring_tokens": ["using", "a", "specially-crafted", "output", "report"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "89", ",", "11", "+", "89", ",", "11", "@", "@", "ENTRY", "(", "xen_iret", ")", "*", "/", "#", "ifdef", "CONFIG_SMP", "GET_THREAD_INFO", "(", "%", "eax", ")", "movl", "TI_cpu", "(", "%", "eax", ")", ",", "%", "eax", "movl", "__per_cpu_offset", "(", ",%", "eax", ",", "4", ")", ",", "%", "eax", "mov", "xen_vcpu", "(", "%", "eax", ")", ",", "%", "eax", "movl", "%", "ss", ":", "TI_cpu", "(", "%", "eax", ")", ",", "%", "eax", "movl", "%", "ss", ":", "__per_cpu_offset", "(", ",%", "eax", ",", "4", ")", ",", "%", "eax", "mov", "%", "ss", ":", "xen_vcpu", "(", "%", "eax", ")", ",", "%", "eax", "#", "else", "movl", "xen_vcpu", ",", "%", "eax", "movl", "%", "ss", ":", "xen_vcpu", ",", "%", "eax", "#", "endif", "/", "*", "check", "IF", "state", "we", "'", "re", "restoring", "*", "/", "@", "@", "-", "106", ",", "19", "+", "106", ",", "19", "@", "@", "ENTRY", "(", "xen_iret", ")", "*", "resuming", "the", "code", ",", "so", "we", "don", "'", "t", "have", "to", "be", "worried", "about", "*", "being", "preempted", "to", "another", "CPU", ".", "*", "/", "setz", "XEN_vcpu_info_mask", "(", "%", "eax", ")", "setz", "%", "ss", ":", "XEN_vcpu_info_mask", "(", "%", "eax", ")", "xen_iret_start_crit", ":", "/", "*", "check", "for", "unmasked", "and", "pending", "*", "/", "cmpw", "$", "0x0001", ",", "XEN_vcpu_info_pending", "(", "%", "eax", ")", "cmpw", "$", "0x0001", ",", "%", "ss", ":", "XEN_vcpu_info_pending", "(", "%", "eax", ")", "/", "*", "*", "If", "there", "'", "s", "something", "pending", ",", "mask", "events", "again", "so", "we", "can", "*", "jump", "back", "into", "xen_hypervisor_callback", ".", "Otherwise", "do", "not", "*", "touch", "XEN_vcpu_info_mask", ".", "*", "/", "jne", "1f", "movb", "$", "1", ",", "XEN_vcpu_info_mask", "(", "%", "eax", ")", "movb", "$", "1", ",", "%", "ss", ":", "XEN_vcpu_info_mask", "(", "%", "eax", ")", "1", ":", "popl", "%", "eax"], "docstring_tokens": ["via", "a", "crafted", "application", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "718", ",", "6", "+", "718", ",", "11", "@", "@", "node", ",", "but", "nothing", "more", ".", "(", "The", "problem", "is", ",", "if", "you", "want", "to", "call", "zoo_exists", "(", ")", "on", "a", "node", "that", "doesn", "'", "t", "exist", ",", "there", "is", "no", "permission", "to", "check", ".", ")", "_ADMIN_", "permission", "also", "has", "a", "special", "role", "in", "terms", "of", "ACLs", ":", "in", "order", "to", "retrieve", "ACLs", "of", "a", "znode", "user", "has", "to", "have", "_READ_", "or", "_ADMIN_", "permission", ",", "but", "without", "_ADMIN_", "permission", ",", "digest", "hash", "values", "will", "be", "masked", "out", ".", "<", "a", "name", "=", "\"", "sc_BuiltinACLSchemes", "\"", "><", "/", "a", ">", "#", "##", "#", "Builtin", "ACL", "Schemes", "@", "@", "-", "827", ",", "7", "+", "832", ",", "8", "@", "@", "node", "must", "have", "the", "CREATE", "permission", "bit", "set", ".", "\\", "*", "path", ",", "_struct_", "ACL_vector", "\\", "*", "acl", ",", "_struct_", "Stat", "\\", "*", "stat", ")", ";", "This", "operation", "returns", "a", "node", "\u2019", "s", "ACL", "info", ".", "This", "operation", "returns", "a", "node", "\u2019", "s", "ACL", "info", ".", "The", "node", "must", "have", "READ", "or", "ADMIN", "permission", "set", ".", "Without", "ADMIN", "permission", ",", "the", "digest", "hash", "values", "will", "be", "masked", "out", ".", "*", "_int_", "_zoo_set_acl_", "(", "zhandle_t", "\\", "*", "zh", ",", "_const_", "_char_", "@", "@", "-", "18", ",", "7", "+", "18", ",", "16", "@", "@", "package", "org", ".", "apache", ".", "zookeeper", ".", "server", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "nio", ".", "ByteBuffer", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "apache", ".", "jute", ".", "Record", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "common", ".", "Time", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "Id", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "KeeperException", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "KeeperException", ".", "Code", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "KeeperException", ".", "SessionMovedException", ";", "@", "@", "-", "32", ",", "7", "+", "41", ",", "6", "@", "@", "import", "org", ".", "apache", ".", "zookeeper", ".", "Watcher", ".", "WatcherType", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "ZooDefs", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "ZooDefs", ".", "OpCode", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "common", ".", "Time", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "ACL", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "Stat", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "proto", ".", "CheckWatchesRequest", ";", "@", "@", "-", "346", ",", "10", "+", "354", ",", "35", "@", "@", "public", "void", "processRequest", "(", "Request", "request", ")", "{", "GetACLRequest", "getACLRequest", "=", "new", "GetACLRequest", "(", ");", "ByteBufferInputStream", ".", "byteBuffer2Record", "(", "request", ".", "request", ",", "getACLRequest", ")", ";", "DataNode", "n", "=", "zks", ".", "getZKDatabase", "(", ").", "getNode", "(", "getACLRequest", ".", "getPath", "(", "))", ";", "if", "(", "n", "=", "=", "null", ")", "{", "throw", "new", "KeeperException", ".", "NoNodeException", "(", ");", "}", "PrepRequestProcessor", ".", "checkACL", "(", "zks", ",", "zks", ".", "getZKDatabase", "(", ").", "aclForNode", "(", "n", ")", ",", "ZooDefs", ".", "Perms", ".", "READ", "|", "ZooDefs", ".", "Perms", ".", "ADMIN", ",", "request", ".", "authInfo", ")", ";", "Stat", "stat", "=", "new", "Stat", "(", ");", "List", "<", "ACL", ">", "acl", "=", "zks", ".", "getZKDatabase", "(", ").", "getACL", "(", "getACLRequest", ".", "getPath", "(", "),", "stat", ")", ";", "rsp", "=", "new", "GetACLResponse", "(", "acl", ",", "stat", ")", ";", "zks", ".", "getZKDatabase", "(", ").", "getACL", "(", "getACLRequest", ".", "getPath", "(", "),", "stat", ")", ";", "try", "{", "PrepRequestProcessor", ".", "checkACL", "(", "zks", ",", "zks", ".", "getZKDatabase", "(", ").", "aclForNode", "(", "n", ")", ",", "ZooDefs", ".", "Perms", ".", "ADMIN", ",", "request", ".", "authInfo", ")", ";", "rsp", "=", "new", "GetACLResponse", "(", "acl", ",", "stat", ")", ";", "}", "catch", "(", "KeeperException", ".", "NoAuthException", "e", ")", "{", "List", "<", "ACL", ">", "acl1", "=", "new", "ArrayList", "<", "ACL", ">", "(", "acl", ".", "size", "(", "))", ";", "for", "(", "ACL", "a", ":", "acl", ")", "{", "if", "(", "\"", "digest", "\"", ".", "equals", "(", "a", ".", "getId", "(", ").", "getScheme", "(", "))", ")", "{", "Id", "id", "=", "a", ".", "getId", "(", ");", "Id", "id1", "=", "new", "Id", "(", "id", ".", "getScheme", "(", "),", "id", ".", "getId", "(", ").", "replaceAll", "(", "\":", ".*", "\",", "\"", ":", "x", "\"", "))", ";", "acl1", ".", "add", "(", "new", "ACL", "(", "a", ".", "getPerms", "(", "),", "id1", ")", ");", "}", "else", "{", "acl1", ".", "add", "(", "a", ")", ";", "}", "}", "rsp", "=", "new", "GetACLResponse", "(", "acl1", ",", "stat", ")", ";", "}", "break", ";", "}", "case", "OpCode", ".", "getChildren", ":", "{", "@", "@", "-", "0", ",", "0", "+", "1", ",", "230", "@", "@", "/", "**", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "*", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "*", "distributed", "with", "this", "work", "for", "additional", "information", "*", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "*", "to", "you", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "*", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "zookeeper", ".", "server", ";", "import", "org", ".", "apache", ".", "jute", ".", "BinaryOutputArchive", ";", "import", "org", ".", "apache", ".", "jute", ".", "Record", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "KeeperException", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "ZooDefs", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "ACL", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "Id", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "Stat", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "proto", ".", "GetACLRequest", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "proto", ".", "GetACLResponse", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "proto", ".", "ReplyHeader", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "mockito", ".", "invocation", ".", "InvocationOnMock", ";", "import", "org", ".", "mockito", ".", "stubbing", ".", "Answer", ";", "import", "java", ".", "io", ".", "ByteArrayOutputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "nio", ".", "ByteBuffer", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "List", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "equalTo", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertThat", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "mockito", ".", "Matchers", ".", "any", ";", "import", "static", "org", ".", "mockito", ".", "Matchers", ".", "anyString", ";", "import", "static", "org", ".", "mockito", ".", "Matchers", ".", "eq", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doAnswer", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "public", "class", "FinalRequestProcessorTest", "{", "private", "List", "<", "ACL", ">", "testACLs", "=", "new", "ArrayList", "<", "ACL", ">", "()", ";", "private", "final", "Record", "[", "]", "responseRecord", "=", "new", "Record", "[", "1", "]", ";", "private", "final", "ReplyHeader", "[", "]", "replyHeaders", "=", "new", "ReplyHeader", "[", "1", "]", ";", "private", "ServerCnxn", "cnxn", ";", "private", "ByteBuffer", "bb", ";", "private", "FinalRequestProcessor", "processor", ";", "@", "Before", "public", "void", "setUp", "(", ")", "throws", "KeeperException", ".", "NoNodeException", ",", "IOException", "{", "testACLs", ".", "clear", "(", ");", "testACLs", ".", "addAll", "(", "Arrays", ".", "asList", "(", "new", "ACL", "(", "ZooDefs", ".", "Perms", ".", "ALL", ",", "new", "Id", "(", "\"", "digest", "\"", ",", "\"", "user", ":", "secrethash", "\"", "))", ",", "new", "ACL", "(", "ZooDefs", ".", "Perms", ".", "ADMIN", ",", "new", "Id", "(", "\"", "digest", "\"", ",", "\"", "adminuser", ":", "adminsecret", "\"", "))", ",", "new", "ACL", "(", "ZooDefs", ".", "Perms", ".", "READ", ",", "new", "Id", "(", "\"", "world", "\"", ",", "\"", "anyone", "\"", "))", ")", ");", "ZooKeeperServer", "zks", "=", "new", "ZooKeeperServer", "(", ");", "ZKDatabase", "db", "=", "mock", "(", "ZKDatabase", ".", "class", ")", ";", "String", "testPath", "=", "\"", "/", "testPath", "\"", ";", "when", "(", "db", ".", "getNode", "(", "eq", "(", "testPath", ")", "))", ".", "thenReturn", "(", "new", "DataNode", "(", "))", ";", "when", "(", "db", ".", "getACL", "(", "eq", "(", "testPath", ")", ",", "any", "(", "Stat", ".", "class", ")", "))", ".", "thenReturn", "(", "testACLs", ")", ";", "when", "(", "db", ".", "aclForNode", "(", "any", "(", "DataNode", ".", "class", ")", "))", ".", "thenReturn", "(", "testACLs", ")", ";", "zks", ".", "setZKDatabase", "(", "db", ")", ";", "processor", "=", "new", "FinalRequestProcessor", "(", "zks", ")", ";", "cnxn", "=", "mock", "(", "ServerCnxn", ".", "class", ")", ";", "doAnswer", "(", "new", "Answer", "(", ")", "{", "@", "Override", "public", "Object", "answer", "(", "InvocationOnMock", "invocationOnMock", ")", "{", "replyHeaders", "[", "0", "]", "=", "(", "ReplyHeader", ")", "invocationOnMock", ".", "getArguments", "(", ")[", "0", "]", ";", "responseRecord", "[", "0", "]", "=", "(", "Record", ")", "invocationOnMock", ".", "getArguments", "(", ")[", "1", "]", ";", "return", "null", ";", "}", "}", ").", "when", "(", "cnxn", ")", ".", "sendResponse", "(", "any", "(", "ReplyHeader", ".", "class", ")", ",", "any", "(", "Record", ".", "class", ")", ",", "anyString", "(", "))", ";", "GetACLRequest", "getACLRequest", "=", "new", "GetACLRequest", "(", ");", "getACLRequest", ".", "setPath", "(", "testPath", ")", ";", "ByteArrayOutputStream", "baos", "=", "new", "ByteArrayOutputStream", "(", ");", "BinaryOutputArchive", "boa", "=", "BinaryOutputArchive", ".", "getArchive", "(", "baos", ")", ";", "getACLRequest", ".", "serialize", "(", "boa", ",", "\"", "request", "\"", ");", "baos", ".", "close", "(", ");", "bb", "=", "ByteBuffer", ".", "wrap", "(", "baos", ".", "toByteArray", "(", "))", ";", "}", "@", "Test", "public", "void", "testACLDigestHashHiding_NoAuth_WorldCanRead", "(", ")", "{", "/", "/", "Arrange", "/", "/", "Act", "Request", "r", "=", "new", "Request", "(", "cnxn", ",", "0", ",", "0", ",", "ZooDefs", ".", "OpCode", ".", "getACL", ",", "bb", ",", "new", "ArrayList", "<", "Id", ">", "()", ");", "processor", ".", "processRequest", "(", "r", ")", ";", "/", "/", "Assert", "assertMasked", "(", "true", ")", ";", "}", "@", "Test", "public", "void", "testACLDigestHashHiding_NoAuth_NoWorld", "(", ")", "{", "/", "/", "Arrange", "testACLs", ".", "remove", "(", "2", ")", ";", "/", "/", "Act", "Request", "r", "=", "new", "Request", "(", "cnxn", ",", "0", ",", "0", ",", "ZooDefs", ".", "OpCode", ".", "getACL", ",", "bb", ",", "new", "ArrayList", "<", "Id", ">", "()", ");", "processor", ".", "processRequest", "(", "r", ")", ";", "/", "/", "Assert", "assertThat", "(", "KeeperException", ".", "Code", ".", "get", "(", "replyHeaders", "[", "0", "]", ".", "getErr", "(", "))", ",", "equalTo", "(", "KeeperException", ".", "Code", ".", "NOAUTH", ")", ");", "}", "@", "Test", "public", "void", "testACLDigestHashHiding_UserCanRead", "(", ")", "{", "/", "/", "Arrange", "List", "<", "Id", ">", "authInfo", "=", "new", "ArrayList", "<", "Id", ">", "()", ";", "authInfo", ".", "add", "(", "new", "Id", "(", "\"", "digest", "\"", ",", "\"", "otheruser", ":", "somesecrethash", "\"", "))", ";", "/", "/", "Act", "Request", "r", "=", "new", "Request", "(", "cnxn", ",", "0", ",", "0", ",", "ZooDefs", ".", "OpCode", ".", "getACL", ",", "bb", ",", "authInfo", ")", ";", "processor", ".", "processRequest", "(", "r", ")", ";", "/", "/", "Assert", "assertMasked", "(", "true", ")", ";", "}", "@", "Test", "public", "void", "testACLDigestHashHiding_UserCanAll", "(", ")", "{", "/", "/", "Arrange", "List", "<", "Id", ">", "authInfo", "=", "new", "ArrayList", "<", "Id", ">", "()", ";", "authInfo", ".", "add", "(", "new", "Id", "(", "\"", "digest", "\"", ",", "\"", "user", ":", "secrethash", "\"", "))", ";", "/", "/", "Act", "Request", "r", "=", "new", "Request", "(", "cnxn", ",", "0", ",", "0", ",", "ZooDefs", ".", "OpCode", ".", "getACL", ",", "bb", ",", "authInfo", ")", ";", "processor", ".", "processRequest", "(", "r", ")", ";", "/", "/", "Assert", "assertMasked", "(", "false", ")", ";", "}", "@", "Test", "public", "void", "testACLDigestHashHiding_AdminUser", "(", ")", "{", "/", "/", "Arrange", "List", "<", "Id", ">", "authInfo", "=", "new", "ArrayList", "<", "Id", ">", "()", ";", "authInfo", ".", "add", "(", "new", "Id", "(", "\"", "digest", "\"", ",", "\"", "adminuser", ":", "adminsecret", "\"", "))", ";", "/", "/", "Act", "Request", "r", "=", "new", "Request", "(", "cnxn", ",", "0", ",", "0", ",", "ZooDefs", ".", "OpCode", ".", "getACL", ",", "bb", ",", "authInfo", ")", ";", "processor", ".", "processRequest", "(", "r", ")", ";", "/", "/", "Assert", "assertMasked", "(", "false", ")", ";", "}", "@", "Test", "public", "void", "testACLDigestHashHiding_OnlyAdmin", "(", ")", "{", "/", "/", "Arrange", "testACLs", ".", "clear", "(", ");", "testACLs", ".", "addAll", "(", "Arrays", ".", "asList", "(", "new", "ACL", "(", "ZooDefs", ".", "Perms", ".", "READ", ",", "new", "Id", "(", "\"", "digest", "\"", ",", "\"", "user", ":", "secrethash", "\"", "))", ",", "new", "ACL", "(", "ZooDefs", ".", "Perms", ".", "ADMIN", ",", "new", "Id", "(", "\"", "digest", "\"", ",", "\"", "adminuser", ":", "adminsecret", "\"", "))", ")", ");", "List", "<", "Id", ">", "authInfo", "=", "new", "ArrayList", "<", "Id", ">", "()", ";", "authInfo", ".", "add", "(", "new", "Id", "(", "\"", "digest", "\"", ",", "\"", "adminuser", ":", "adminsecret", "\"", "))", ";", "/", "/", "Act", "Request", "r", "=", "new", "Request", "(", "cnxn", ",", "0", ",", "0", ",", "ZooDefs", ".", "OpCode", ".", "getACL", ",", "bb", ",", "authInfo", ")", ";", "processor", ".", "processRequest", "(", "r", ")", ";", "/", "/", "Assert", "assertTrue", "(", "\"", "Not", "a", "GetACL", "response", ".", "Auth", "failed", "?", "\",", "responseRecord", "[", "0", "]", "instanceof", "GetACLResponse", ")", ";", "GetACLResponse", "rsp", "=", "(", "GetACLResponse", ")", "responseRecord", "[", "0", "]", ";", "assertThat", "(", "\"", "Number", "of", "ACLs", "in", "the", "response", "are", "different", "\"", ",", "rsp", ".", "getAcl", "(", ").", "size", "(", "),", "equalTo", "(", "2", ")", ");", "/", "/", "Verify", "ACLs", "in", "the", "response", "assertThat", "(", "\"", "Password", "hash", "mismatch", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "0", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "user", ":", "secrethash", "\"", "))", ";", "assertThat", "(", "\"", "Password", "hash", "mismatch", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "1", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "adminuser", ":", "adminsecret", "\"", "))", ";", "}", "private", "void", "assertMasked", "(", "boolean", "masked", ")", "{", "assertTrue", "(", "\"", "Not", "a", "GetACL", "response", ".", "Auth", "failed", "?", "\",", "responseRecord", "[", "0", "]", "instanceof", "GetACLResponse", ")", ";", "GetACLResponse", "rsp", "=", "(", "GetACLResponse", ")", "responseRecord", "[", "0", "]", ";", "assertThat", "(", "\"", "Number", "of", "ACLs", "in", "the", "response", "are", "different", "\"", ",", "rsp", ".", "getAcl", "(", ").", "size", "(", "),", "equalTo", "(", "3", ")", ");", "/", "/", "Verify", "ACLs", "in", "the", "response", "assertThat", "(", "\"", "Invalid", "ACL", "list", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "0", ")", ".", "getPerms", "(", "),", "equalTo", "(", "ZooDefs", ".", "Perms", ".", "ALL", ")", ");", "assertThat", "(", "\"", "Invalid", "ACL", "list", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "0", ")", ".", "getId", "(", ").", "getScheme", "(", "),", "equalTo", "(", "\"", "digest", "\"", "))", ";", "if", "(", "masked", ")", "{", "assertThat", "(", "\"", "Password", "hash", "is", "not", "masked", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "0", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "user", ":", "x", "\"", "))", ";", "}", "else", "{", "assertThat", "(", "\"", "Password", "hash", "mismatch", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "0", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "user", ":", "secrethash", "\"", "))", ";", "}", "assertThat", "(", "\"", "Invalid", "ACL", "list", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "1", ")", ".", "getPerms", "(", "),", "equalTo", "(", "ZooDefs", ".", "Perms", ".", "ADMIN", ")", ");", "assertThat", "(", "\"", "Invalid", "ACL", "list", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "1", ")", ".", "getId", "(", ").", "getScheme", "(", "),", "equalTo", "(", "\"", "digest", "\"", "))", ";", "if", "(", "masked", ")", "{", "assertThat", "(", "\"", "Password", "hash", "is", "not", "masked", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "1", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "adminuser", ":", "x", "\"", "))", ";", "}", "else", "{", "assertThat", "(", "\"", "Password", "hash", "mismatch", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "1", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "adminuser", ":", "adminsecret", "\"", "))", ";", "}", "assertThat", "(", "\"", "Invalid", "ACL", "list", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "2", ")", ".", "getPerms", "(", "),", "equalTo", "(", "ZooDefs", ".", "Perms", ".", "READ", ")", ");", "assertThat", "(", "\"", "Invalid", "ACL", "list", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "2", ")", ".", "getId", "(", ").", "getScheme", "(", "),", "equalTo", "(", "\"", "world", "\"", "))", ";", "assertThat", "(", "\"", "Invalid", "ACL", "list", "in", "the", "response", "\"", ",", "rsp", ".", "getAcl", "(", ").", "get", "(", "2", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "anyone", "\"", "))", ";", "/", "/", "Verify", "that", "FinalRequestProcessor", "hasn", "'", "t", "changed", "the", "original", "ACL", "objects", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "0", ")", ".", "getPerms", "(", "),", "equalTo", "(", "ZooDefs", ".", "Perms", ".", "ALL", ")", ");", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "0", ")", ".", "getId", "(", ").", "getScheme", "(", "),", "equalTo", "(", "\"", "digest", "\"", "))", ";", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "0", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "user", ":", "secrethash", "\"", "))", ";", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "1", ")", ".", "getPerms", "(", "),", "equalTo", "(", "ZooDefs", ".", "Perms", ".", "ADMIN", ")", ");", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "1", ")", ".", "getId", "(", ").", "getScheme", "(", "),", "equalTo", "(", "\"", "digest", "\"", "))", ";", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "1", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "adminuser", ":", "adminsecret", "\"", "))", ";", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "2", ")", ".", "getPerms", "(", "),", "equalTo", "(", "ZooDefs", ".", "Perms", ".", "READ", ")", ");", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "2", ")", ".", "getId", "(", ").", "getScheme", "(", "),", "equalTo", "(", "\"", "world", "\"", "))", ";", "assertThat", "(", "\"", "Original", "ACL", "list", "has", "been", "modified", "\"", ",", "testACLs", ".", "get", "(", "2", ")", ".", "getId", "(", ").", "getId", "(", "),", "equalTo", "(", "\"", "anyone", "\"", "))", ";", "}", "}"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "21", ",", "99", "+", "21", ",", "9", "@", "@", "#", "include", "<", "linux", "/", "module", ".", "h", ">", "#", "include", "<", "linux", "/", "string", ".", "h", ">", "#", "include", "<", "linux", "/", "types", ".", "h", ">", "#", "include", "<", "linux", "/", "cryptohash", ".", "h", ">", "#", "include", "<", "asm", "/", "byteorder", ".", "h", ">", "#", "define", "F1", "(", "x", ",", "y", ",", "z", ")", "(", "z", "^", "(", "x", "&", "(", "y", "^", "z", ")", "))", "#", "define", "F2", "(", "x", ",", "y", ",", "z", ")", "F1", "(", "z", ",", "x", ",", "y", ")", "#", "define", "F3", "(", "x", ",", "y", ",", "z", ")", "(", "x", "^", "y", "^", "z", ")", "#", "define", "F4", "(", "x", ",", "y", ",", "z", ")", "(", "y", "^", "(", "x", "|", "~", "z", ")", ")", "#", "define", "MD5STEP", "(", "f", ",", "w", ",", "x", ",", "y", ",", "z", ",", "in", ",", "s", ")", "\\", "(", "w", "+", "=", "f", "(", "x", ",", "y", ",", "z", ")", "+", "in", ",", "w", "=", "(", "w", "<", "<", "s", "|", "w", ">", ">(", "32", "-", "s", ")", ")", "+", "x", ")", "static", "void", "md5_transform", "(", "u32", "*", "hash", ",", "u32", "const", "*", "in", ")", "{", "u32", "a", ",", "b", ",", "c", ",", "d", ";", "a", "=", "hash", "[", "0", "]", ";", "b", "=", "hash", "[", "1", "]", ";", "c", "=", "hash", "[", "2", "]", ";", "d", "=", "hash", "[", "3", "]", ";", "MD5STEP", "(", "F1", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "0", "]", "+", "0xd76aa478", ",", "7", ")", ";", "MD5STEP", "(", "F1", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "1", "]", "+", "0xe8c7b756", ",", "12", ")", ";", "MD5STEP", "(", "F1", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "2", "]", "+", "0x242070db", ",", "17", ")", ";", "MD5STEP", "(", "F1", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "3", "]", "+", "0xc1bdceee", ",", "22", ")", ";", "MD5STEP", "(", "F1", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "4", "]", "+", "0xf57c0faf", ",", "7", ")", ";", "MD5STEP", "(", "F1", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "5", "]", "+", "0x4787c62a", ",", "12", ")", ";", "MD5STEP", "(", "F1", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "6", "]", "+", "0xa8304613", ",", "17", ")", ";", "MD5STEP", "(", "F1", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "7", "]", "+", "0xfd469501", ",", "22", ")", ";", "MD5STEP", "(", "F1", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "8", "]", "+", "0x698098d8", ",", "7", ")", ";", "MD5STEP", "(", "F1", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "9", "]", "+", "0x8b44f7af", ",", "12", ")", ";", "MD5STEP", "(", "F1", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "10", "]", "+", "0xffff5bb1", ",", "17", ")", ";", "MD5STEP", "(", "F1", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "11", "]", "+", "0x895cd7be", ",", "22", ")", ";", "MD5STEP", "(", "F1", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "12", "]", "+", "0x6b901122", ",", "7", ")", ";", "MD5STEP", "(", "F1", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "13", "]", "+", "0xfd987193", ",", "12", ")", ";", "MD5STEP", "(", "F1", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "14", "]", "+", "0xa679438e", ",", "17", ")", ";", "MD5STEP", "(", "F1", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "15", "]", "+", "0x49b40821", ",", "22", ")", ";", "MD5STEP", "(", "F2", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "1", "]", "+", "0xf61e2562", ",", "5", ")", ";", "MD5STEP", "(", "F2", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "6", "]", "+", "0xc040b340", ",", "9", ")", ";", "MD5STEP", "(", "F2", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "11", "]", "+", "0x265e5a51", ",", "14", ")", ";", "MD5STEP", "(", "F2", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "0", "]", "+", "0xe9b6c7aa", ",", "20", ")", ";", "MD5STEP", "(", "F2", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "5", "]", "+", "0xd62f105d", ",", "5", ")", ";", "MD5STEP", "(", "F2", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "10", "]", "+", "0x02441453", ",", "9", ")", ";", "MD5STEP", "(", "F2", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "15", "]", "+", "0xd8a1e681", ",", "14", ")", ";", "MD5STEP", "(", "F2", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "4", "]", "+", "0xe7d3fbc8", ",", "20", ")", ";", "MD5STEP", "(", "F2", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "9", "]", "+", "0x21e1cde6", ",", "5", ")", ";", "MD5STEP", "(", "F2", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "14", "]", "+", "0xc33707d6", ",", "9", ")", ";", "MD5STEP", "(", "F2", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "3", "]", "+", "0xf4d50d87", ",", "14", ")", ";", "MD5STEP", "(", "F2", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "8", "]", "+", "0x455a14ed", ",", "20", ")", ";", "MD5STEP", "(", "F2", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "13", "]", "+", "0xa9e3e905", ",", "5", ")", ";", "MD5STEP", "(", "F2", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "2", "]", "+", "0xfcefa3f8", ",", "9", ")", ";", "MD5STEP", "(", "F2", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "7", "]", "+", "0x676f02d9", ",", "14", ")", ";", "MD5STEP", "(", "F2", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "12", "]", "+", "0x8d2a4c8a", ",", "20", ")", ";", "MD5STEP", "(", "F3", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "5", "]", "+", "0xfffa3942", ",", "4", ")", ";", "MD5STEP", "(", "F3", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "8", "]", "+", "0x8771f681", ",", "11", ")", ";", "MD5STEP", "(", "F3", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "11", "]", "+", "0x6d9d6122", ",", "16", ")", ";", "MD5STEP", "(", "F3", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "14", "]", "+", "0xfde5380c", ",", "23", ")", ";", "MD5STEP", "(", "F3", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "1", "]", "+", "0xa4beea44", ",", "4", ")", ";", "MD5STEP", "(", "F3", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "4", "]", "+", "0x4bdecfa9", ",", "11", ")", ";", "MD5STEP", "(", "F3", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "7", "]", "+", "0xf6bb4b60", ",", "16", ")", ";", "MD5STEP", "(", "F3", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "10", "]", "+", "0xbebfbc70", ",", "23", ")", ";", "MD5STEP", "(", "F3", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "13", "]", "+", "0x289b7ec6", ",", "4", ")", ";", "MD5STEP", "(", "F3", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "0", "]", "+", "0xeaa127fa", ",", "11", ")", ";", "MD5STEP", "(", "F3", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "3", "]", "+", "0xd4ef3085", ",", "16", ")", ";", "MD5STEP", "(", "F3", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "6", "]", "+", "0x04881d05", ",", "23", ")", ";", "MD5STEP", "(", "F3", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "9", "]", "+", "0xd9d4d039", ",", "4", ")", ";", "MD5STEP", "(", "F3", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "12", "]", "+", "0xe6db99e5", ",", "11", ")", ";", "MD5STEP", "(", "F3", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "15", "]", "+", "0x1fa27cf8", ",", "16", ")", ";", "MD5STEP", "(", "F3", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "2", "]", "+", "0xc4ac5665", ",", "23", ")", ";", "MD5STEP", "(", "F4", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "0", "]", "+", "0xf4292244", ",", "6", ")", ";", "MD5STEP", "(", "F4", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "7", "]", "+", "0x432aff97", ",", "10", ")", ";", "MD5STEP", "(", "F4", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "14", "]", "+", "0xab9423a7", ",", "15", ")", ";", "MD5STEP", "(", "F4", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "5", "]", "+", "0xfc93a039", ",", "21", ")", ";", "MD5STEP", "(", "F4", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "12", "]", "+", "0x655b59c3", ",", "6", ")", ";", "MD5STEP", "(", "F4", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "3", "]", "+", "0x8f0ccc92", ",", "10", ")", ";", "MD5STEP", "(", "F4", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "10", "]", "+", "0xffeff47d", ",", "15", ")", ";", "MD5STEP", "(", "F4", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "1", "]", "+", "0x85845dd1", ",", "21", ")", ";", "MD5STEP", "(", "F4", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "8", "]", "+", "0x6fa87e4f", ",", "6", ")", ";", "MD5STEP", "(", "F4", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "15", "]", "+", "0xfe2ce6e0", ",", "10", ")", ";", "MD5STEP", "(", "F4", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "6", "]", "+", "0xa3014314", ",", "15", ")", ";", "MD5STEP", "(", "F4", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "13", "]", "+", "0x4e0811a1", ",", "21", ")", ";", "MD5STEP", "(", "F4", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "4", "]", "+", "0xf7537e82", ",", "6", ")", ";", "MD5STEP", "(", "F4", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "11", "]", "+", "0xbd3af235", ",", "10", ")", ";", "MD5STEP", "(", "F4", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "2", "]", "+", "0x2ad7d2bb", ",", "15", ")", ";", "MD5STEP", "(", "F4", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "9", "]", "+", "0xeb86d391", ",", "21", ")", ";", "hash", "[", "0", "]", "+", "=", "a", ";", "hash", "[", "1", "]", "+", "=", "b", ";", "hash", "[", "2", "]", "+", "=", "c", ";", "hash", "[", "3", "]", "+", "=", "d", ";", "}", "/", "*", "XXX", ":", "this", "stuff", "can", "be", "optimized", "*", "/", "static", "inline", "void", "le32_to_cpu_array", "(", "u32", "*", "buf", ",", "unsigned", "int", "words", ")", "{", "@", "@", "-", "8", ",", "6", "+", "8", ",", "11", "@", "@", "void", "sha_init", "(", "__u32", "*", "buf", ")", ";", "void", "sha_transform", "(", "__u32", "*", "digest", ",", "const", "char", "*", "data", ",", "__u32", "*", "W", ")", ";", "#", "define", "MD5_DIGEST_WORDS", "4", "#", "define", "MD5_MESSAGE_BYTES", "64", "void", "md5_transform", "(", "__u32", "*", "hash", ",", "__u32", "const", "*", "in", ")", ";", "__u32", "half_md4_transform", "(", "__u32", "buf", "[", "4", "]", ",", "__u32", "const", "in", "[", "8", "]", ");", "#", "endif", "@", "@", "-", "10", ",", "7", "+", "10", ",", "7", "@", "@", "endif", "lib", "-", "y", ":", "=", "ctype", ".", "o", "string", ".", "o", "vsprintf", ".", "o", "cmdline", ".", "o", "\\", "rbtree", ".", "o", "radix", "-", "tree", ".", "o", "dump_stack", ".", "o", "timerqueue", ".", "o", "\\", "idr", ".", "o", "int_sqrt", ".", "o", "extable", ".", "o", "prio_tree", ".", "o", "\\", "sha1", ".", "o", "irq_regs", ".", "o", "reciprocal_div", ".", "o", "argv_split", ".", "o", "\\", "sha1", ".", "o", "md5", ".", "o", "irq_regs", ".", "o", "reciprocal_div", ".", "o", "argv_split", ".", "o", "\\", "proportions", ".", "o", "prio_heap", ".", "o", "ratelimit", ".", "o", "show_mem", ".", "o", "\\", "is_single_threaded", ".", "o", "plist", ".", "o", "decompress", ".", "o", "find_next_bit", ".", "o", "@", "@", "-", "0", ",", "0", "+", "1", ",", "95", "@", "@", "#", "include", "<", "linux", "/", "kernel", ".", "h", ">", "#", "include", "<", "linux", "/", "module", ".", "h", ">", "#", "include", "<", "linux", "/", "cryptohash", ".", "h", ">", "#", "define", "F1", "(", "x", ",", "y", ",", "z", ")", "(", "z", "^", "(", "x", "&", "(", "y", "^", "z", ")", "))", "#", "define", "F2", "(", "x", ",", "y", ",", "z", ")", "F1", "(", "z", ",", "x", ",", "y", ")", "#", "define", "F3", "(", "x", ",", "y", ",", "z", ")", "(", "x", "^", "y", "^", "z", ")", "#", "define", "F4", "(", "x", ",", "y", ",", "z", ")", "(", "y", "^", "(", "x", "|", "~", "z", ")", ")", "#", "define", "MD5STEP", "(", "f", ",", "w", ",", "x", ",", "y", ",", "z", ",", "in", ",", "s", ")", "\\", "(", "w", "+", "=", "f", "(", "x", ",", "y", ",", "z", ")", "+", "in", ",", "w", "=", "(", "w", "<", "<", "s", "|", "w", ">", ">(", "32", "-", "s", ")", ")", "+", "x", ")", "void", "md5_transform", "(", "__u32", "*", "hash", ",", "__u32", "const", "*", "in", ")", "{", "u32", "a", ",", "b", ",", "c", ",", "d", ";", "a", "=", "hash", "[", "0", "]", ";", "b", "=", "hash", "[", "1", "]", ";", "c", "=", "hash", "[", "2", "]", ";", "d", "=", "hash", "[", "3", "]", ";", "MD5STEP", "(", "F1", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "0", "]", "+", "0xd76aa478", ",", "7", ")", ";", "MD5STEP", "(", "F1", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "1", "]", "+", "0xe8c7b756", ",", "12", ")", ";", "MD5STEP", "(", "F1", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "2", "]", "+", "0x242070db", ",", "17", ")", ";", "MD5STEP", "(", "F1", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "3", "]", "+", "0xc1bdceee", ",", "22", ")", ";", "MD5STEP", "(", "F1", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "4", "]", "+", "0xf57c0faf", ",", "7", ")", ";", "MD5STEP", "(", "F1", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "5", "]", "+", "0x4787c62a", ",", "12", ")", ";", "MD5STEP", "(", "F1", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "6", "]", "+", "0xa8304613", ",", "17", ")", ";", "MD5STEP", "(", "F1", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "7", "]", "+", "0xfd469501", ",", "22", ")", ";", "MD5STEP", "(", "F1", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "8", "]", "+", "0x698098d8", ",", "7", ")", ";", "MD5STEP", "(", "F1", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "9", "]", "+", "0x8b44f7af", ",", "12", ")", ";", "MD5STEP", "(", "F1", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "10", "]", "+", "0xffff5bb1", ",", "17", ")", ";", "MD5STEP", "(", "F1", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "11", "]", "+", "0x895cd7be", ",", "22", ")", ";", "MD5STEP", "(", "F1", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "12", "]", "+", "0x6b901122", ",", "7", ")", ";", "MD5STEP", "(", "F1", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "13", "]", "+", "0xfd987193", ",", "12", ")", ";", "MD5STEP", "(", "F1", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "14", "]", "+", "0xa679438e", ",", "17", ")", ";", "MD5STEP", "(", "F1", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "15", "]", "+", "0x49b40821", ",", "22", ")", ";", "MD5STEP", "(", "F2", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "1", "]", "+", "0xf61e2562", ",", "5", ")", ";", "MD5STEP", "(", "F2", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "6", "]", "+", "0xc040b340", ",", "9", ")", ";", "MD5STEP", "(", "F2", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "11", "]", "+", "0x265e5a51", ",", "14", ")", ";", "MD5STEP", "(", "F2", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "0", "]", "+", "0xe9b6c7aa", ",", "20", ")", ";", "MD5STEP", "(", "F2", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "5", "]", "+", "0xd62f105d", ",", "5", ")", ";", "MD5STEP", "(", "F2", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "10", "]", "+", "0x02441453", ",", "9", ")", ";", "MD5STEP", "(", "F2", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "15", "]", "+", "0xd8a1e681", ",", "14", ")", ";", "MD5STEP", "(", "F2", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "4", "]", "+", "0xe7d3fbc8", ",", "20", ")", ";", "MD5STEP", "(", "F2", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "9", "]", "+", "0x21e1cde6", ",", "5", ")", ";", "MD5STEP", "(", "F2", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "14", "]", "+", "0xc33707d6", ",", "9", ")", ";", "MD5STEP", "(", "F2", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "3", "]", "+", "0xf4d50d87", ",", "14", ")", ";", "MD5STEP", "(", "F2", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "8", "]", "+", "0x455a14ed", ",", "20", ")", ";", "MD5STEP", "(", "F2", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "13", "]", "+", "0xa9e3e905", ",", "5", ")", ";", "MD5STEP", "(", "F2", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "2", "]", "+", "0xfcefa3f8", ",", "9", ")", ";", "MD5STEP", "(", "F2", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "7", "]", "+", "0x676f02d9", ",", "14", ")", ";", "MD5STEP", "(", "F2", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "12", "]", "+", "0x8d2a4c8a", ",", "20", ")", ";", "MD5STEP", "(", "F3", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "5", "]", "+", "0xfffa3942", ",", "4", ")", ";", "MD5STEP", "(", "F3", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "8", "]", "+", "0x8771f681", ",", "11", ")", ";", "MD5STEP", "(", "F3", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "11", "]", "+", "0x6d9d6122", ",", "16", ")", ";", "MD5STEP", "(", "F3", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "14", "]", "+", "0xfde5380c", ",", "23", ")", ";", "MD5STEP", "(", "F3", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "1", "]", "+", "0xa4beea44", ",", "4", ")", ";", "MD5STEP", "(", "F3", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "4", "]", "+", "0x4bdecfa9", ",", "11", ")", ";", "MD5STEP", "(", "F3", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "7", "]", "+", "0xf6bb4b60", ",", "16", ")", ";", "MD5STEP", "(", "F3", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "10", "]", "+", "0xbebfbc70", ",", "23", ")", ";", "MD5STEP", "(", "F3", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "13", "]", "+", "0x289b7ec6", ",", "4", ")", ";", "MD5STEP", "(", "F3", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "0", "]", "+", "0xeaa127fa", ",", "11", ")", ";", "MD5STEP", "(", "F3", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "3", "]", "+", "0xd4ef3085", ",", "16", ")", ";", "MD5STEP", "(", "F3", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "6", "]", "+", "0x04881d05", ",", "23", ")", ";", "MD5STEP", "(", "F3", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "9", "]", "+", "0xd9d4d039", ",", "4", ")", ";", "MD5STEP", "(", "F3", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "12", "]", "+", "0xe6db99e5", ",", "11", ")", ";", "MD5STEP", "(", "F3", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "15", "]", "+", "0x1fa27cf8", ",", "16", ")", ";", "MD5STEP", "(", "F3", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "2", "]", "+", "0xc4ac5665", ",", "23", ")", ";", "MD5STEP", "(", "F4", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "0", "]", "+", "0xf4292244", ",", "6", ")", ";", "MD5STEP", "(", "F4", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "7", "]", "+", "0x432aff97", ",", "10", ")", ";", "MD5STEP", "(", "F4", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "14", "]", "+", "0xab9423a7", ",", "15", ")", ";", "MD5STEP", "(", "F4", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "5", "]", "+", "0xfc93a039", ",", "21", ")", ";", "MD5STEP", "(", "F4", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "12", "]", "+", "0x655b59c3", ",", "6", ")", ";", "MD5STEP", "(", "F4", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "3", "]", "+", "0x8f0ccc92", ",", "10", ")", ";", "MD5STEP", "(", "F4", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "10", "]", "+", "0xffeff47d", ",", "15", ")", ";", "MD5STEP", "(", "F4", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "1", "]", "+", "0x85845dd1", ",", "21", ")", ";", "MD5STEP", "(", "F4", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "8", "]", "+", "0x6fa87e4f", ",", "6", ")", ";", "MD5STEP", "(", "F4", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "15", "]", "+", "0xfe2ce6e0", ",", "10", ")", ";", "MD5STEP", "(", "F4", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "6", "]", "+", "0xa3014314", ",", "15", ")", ";", "MD5STEP", "(", "F4", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "13", "]", "+", "0x4e0811a1", ",", "21", ")", ";", "MD5STEP", "(", "F4", ",", "a", ",", "b", ",", "c", ",", "d", ",", "in", "[", "4", "]", "+", "0xf7537e82", ",", "6", ")", ";", "MD5STEP", "(", "F4", ",", "d", ",", "a", ",", "b", ",", "c", ",", "in", "[", "11", "]", "+", "0xbd3af235", ",", "10", ")", ";", "MD5STEP", "(", "F4", ",", "c", ",", "d", ",", "a", ",", "b", ",", "in", "[", "2", "]", "+", "0x2ad7d2bb", ",", "15", ")", ";", "MD5STEP", "(", "F4", ",", "b", ",", "c", ",", "d", ",", "a", ",", "in", "[", "9", "]", "+", "0xeb86d391", ",", "21", ")", ";", "hash", "[", "0", "]", "+", "=", "a", ";", "hash", "[", "1", "]", "+", "=", "b", ";", "hash", "[", "2", "]", "+", "=", "c", ";", "hash", "[", "3", "]", "+", "=", "d", ";", "}", "EXPORT_SYMBOL", "(", "md5_transform", ")", ";"], "docstring_tokens": ["by", "predicting", "these", "values", "and", "sending", "crafted", "packets", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "289", ",", "6", "+", "289", ",", "11", "@", "@", "static", "plist_t", "parse_string_node", "(", "const", "char", "*", "*", "bnode", ",", "uint64_t", "size", ")", "data", "-", ">", "type", "=", "PLIST_STRING", ";", "data", "-", ">", "strval", "=", "(", "char", "*", ")", "malloc", "(", "sizeof", "(", "char", ")", "*", "(", "size", "+", "1", ")", ");", "if", "(", "!", "data", "-", ">", "strval", ")", "{", "plist_free_data", "(", "data", ")", ";", "PLIST_BIN_ERR", "(", "\"%", "s", ":", "Could", "not", "allocate", "%", "\"", "PRIu64", "\"", "bytes", "\\", "n", "\"", ",", "__func__", ",", "sizeof", "(", "char", ")", "*", "(", "size", "+", "1", ")", ");", "return", "NULL", ";", "}", "memcpy", "(", "data", "-", ">", "strval", ",", "*", "bnode", ",", "size", ")", ";", "data", "-", ">", "strval", "[", "size", "]", "=", "'", "\\", "0", "'", ";", "data", "-", ">", "length", "=", "strlen", "(", "data", "-", ">", "strval", ")", ";"], "docstring_tokens": ["via", "a", "crafted", "plist", "file", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "182", ",", "7", "+", "182", ",", "8", "@", "@", "static", "void", "m_stop", "(", "struct", "seq_file", "*", "m", ",", "void", "*", "v", ")", "struct", "proc_maps_private", "*", "priv", "=", "m", "-", ">", "private", ";", "struct", "vm_area_struct", "*", "vma", "=", "v", ";", "vma_stop", "(", "priv", ",", "vma", ")", ";", "if", "(", "!", "IS_ERR", "(", "vma", ")", ")", "vma_stop", "(", "priv", ",", "vma", ")", ";", "if", "(", "priv", "-", ">", "task", ")", "put_task_struct", "(", "priv", "-", ">", "task", ")", ";", "}"], "docstring_tokens": ["via", "vectors", "that", "trigger", "an", "m_start", "error", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "45", ",", "9", "+", "45", ",", "9", "@", "@", "extern", "struct", "group_info", "init_groups", ";", "#", "define", "INIT_STRUCT_PID", "{", "\\", ".", "count", "=", "ATOMIC_INIT", "(", "1", ")", ",", "\\", ".", "tasks", "=", "{", "\\", "{", ".", "first", "=", "&", "init_task", ".", "pids", "[", "PIDTYPE_PID", "]", ".", "node", "}", ",", "\\", "{", ".", "first", "=", "&", "init_task", ".", "pids", "[", "PIDTYPE_PGID", "]", ".", "node", "}", ",", "\\", "{", ".", "first", "=", "&", "init_task", ".", "pids", "[", "PIDTYPE_SID", "]", ".", "node", "}", ",", "\\", "{", ".", "first", "=", "NULL", "}", ",", "\\", "{", ".", "first", "=", "NULL", "}", ",", "\\", "{", ".", "first", "=", "NULL", "}", ",", "\\", "}", ",", "\\", ".", "level", "=", "0", ",", "\\", ".", "numbers", "=", "{", "{", "\\", "@", "@", "-", "61", ",", "7", "+", "61", ",", "7", "@", "@", "extern", "struct", "group_info", "init_groups", ";", "{", "\\", ".", "node", "=", "{", "\\", ".", "next", "=", "NULL", ",", "\\", ".", "pprev", "=", "&", "init_struct_pid", ".", "tasks", "[", "type", "]", ".", "first", ",", "\\", ".", "pprev", "=", "NULL", ",", "\\", "}", ",", "\\", ".", "pid", "=", "&", "init_struct_pid", ",", "\\", "}"], "docstring_tokens": ["by", "leveraging", "access", "to", "this", "process", "group", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "143", ",", "14", "+", "143", ",", "48", "@", "@", "public", "void", "setTomcatAuthorization", "(", "boolean", "tomcatAuthorization", ")", "{", "}", "private", "String", "requiredSecret", "=", "null", ";", "private", "String", "secret", "=", "null", ";", "/", "**", "*", "Set", "the", "secret", "that", "must", "be", "included", "with", "every", "request", ".", "*", "*", "@", "param", "secret", "The", "required", "secret", "*", "/", "public", "void", "setSecret", "(", "String", "secret", ")", "{", "this", ".", "secret", "=", "secret", ";", "}", "protected", "String", "getSecret", "(", ")", "{", "return", "secret", ";", "}", "/", "**", "*", "Set", "the", "required", "secret", "that", "must", "be", "included", "with", "every", "request", ".", "*", "*", "@", "param", "requiredSecret", "The", "required", "secret", "*", "*", "@", "deprecated", "Replaced", "by", "{", "@", "link", "#", "setSecret", "(", "String", ")", "}.", "*", "Will", "be", "removed", "in", "Tomcat", "11", "onwards", "*", "/", "@", "Deprecated", "public", "void", "setRequiredSecret", "(", "String", "requiredSecret", ")", "{", "this", ".", "requiredSecret", "=", "requiredSecret", ";", "setSecret", "(", "requiredSecret", ")", ";", "}", "/", "**", "*", "@", "return", "The", "current", "secret", "*", "*", "@", "deprecated", "Replaced", "by", "{", "@", "link", "#", "getSecret", "(", ")}", ".", "*", "Will", "be", "removed", "in", "Tomcat", "11", "onwards", "*", "/", "@", "Deprecated", "protected", "String", "getRequiredSecret", "(", ")", "{", "return", "getSecret", "(", ");", "}", "private", "boolean", "secretRequired", "=", "true", ";", "public", "void", "setSecretRequired", "(", "boolean", "secretRequired", ")", "{", "this", ".", "secretRequired", "=", "secretRequired", ";", "}", "public", "boolean", "getSecretRequired", "(", ")", "{", "return", "secretRequired", ";", "}", "@", "@", "-", "202", ",", "7", "+", "236", ",", "7", "@", "@", "protected", "Processor", "createProcessor", "(", ")", "{", "processor", ".", "setAjpFlush", "(", "getAjpFlush", "(", "))", ";", "processor", ".", "setTomcatAuthentication", "(", "getTomcatAuthentication", "(", "))", ";", "processor", ".", "setTomcatAuthorization", "(", "getTomcatAuthorization", "(", "))", ";", "processor", ".", "setRequiredSecret", "(", "requiredSecret", ")", ";", "processor", ".", "setSecret", "(", "secret", ")", ";", "processor", ".", "setKeepAliveTimeout", "(", "getKeepAliveTimeout", "(", "))", ";", "processor", ".", "setClientCertProvider", "(", "getClientCertProvider", "(", "))", ";", "processor", ".", "setSendReasonPhrase", "(", "getSendReasonPhrase", "(", "))", ";", "@", "@", "-", "216", ",", "4", "+", "250", ",", "16", "@", "@", "protected", "Processor", "createUpgradeProcessor", "(", "SocketWrapperBase", "<", "?>", "socket", ",", "throw", "new", "IllegalStateException", "(", "sm", ".", "getString", "(", "\"", "ajpprotocol", ".", "noUpgradeHandler", "\"", ",", "upgradeToken", ".", "getHttpUpgradeHandler", "(", ").", "getClass", "(", ").", "getName", "(", "))", ");", "}", "@", "Override", "public", "void", "init", "(", ")", "throws", "Exception", "{", "if", "(", "getSecretRequired", "(", "))", "{", "String", "secret", "=", "getSecret", "(", ");", "if", "(", "secret", "=", "=", "null", "|", "|", "secret", ".", "length", "(", ")", "=", "=", "0", ")", "{", "throw", "new", "IllegalArgumentException", "(", "sm", ".", "getString", "(", "\"", "ajpprotocol", ".", "nosecret", "\"", "))", ";", "}", "}", "super", ".", "init", "(", ");", "}", "}", "@", "@", "-", "322", ",", "9", "+", "322", ",", "13", "@", "@", "public", "void", "setTomcatAuthorization", "(", "boolean", "tomcatAuthorization", ")", "{", "/", "**", "*", "Required", "secret", ".", "*", "/", "private", "String", "requiredSecret", "=", "null", ";", "private", "String", "secret", "=", "null", ";", "@", "Deprecated", "public", "void", "setRequiredSecret", "(", "String", "requiredSecret", ")", "{", "this", ".", "requiredSecret", "=", "requiredSecret", ";", "setSecret", "(", "requiredSecret", ")", ";", "}", "public", "void", "setSecret", "(", "String", "secret", ")", "{", "this", ".", "secret", "=", "secret", ";", "}", "@", "@", "-", "782", ",", "7", "+", "786", ",", "7", "@", "@", "private", "void", "prepareRequest", "(", ")", "{", "}", "/", "/", "Decode", "extra", "attributes", "boolean", "secret", "=", "false", ";", "boolean", "secretPresentInRequest", "=", "false", ";", "byte", "attributeCode", ";", "while", "(", "(", "attributeCode", "=", "requestHeaderMessage", ".", "getByte", "(", "))", "!", "=", "Constants", ".", "SC_A_ARE_DONE", ")", "{", "@", "@", "-", "883", ",", "9", "+", "887", ",", "9", "@", "@", "private", "void", "prepareRequest", "(", ")", "{", "case", "Constants", ".", "SC_A_SECRET", ":", "requestHeaderMessage", ".", "getBytes", "(", "tmpMB", ")", ";", "if", "(", "requiredSecret", "!", "=", "null", ")", "{", "secret", "=", "true", ";", "if", "(", "!", "tmpMB", ".", "equals", "(", "requiredSecret", ")", ")", "{", "if", "(", "secret", "!", "=", "null", ")", "{", "secretPresentInRequest", "=", "true", ";", "if", "(", "!", "tmpMB", ".", "equals", "(", "secret", ")", ")", "{", "response", ".", "setStatus", "(", "403", ")", ";", "setErrorState", "(", "ErrorState", ".", "CLOSE_CLEAN", ",", "null", ")", ";", "}", "@", "@", "-", "901", ",", "7", "+", "905", ",", "7", "@", "@", "private", "void", "prepareRequest", "(", ")", "{", "}", "/", "/", "Check", "if", "secret", "was", "submitted", "if", "required", "if", "(", "(", "requiredSecret", "!", "=", "null", ")", "&", "&", "!", "secret", ")", "{", "if", "(", "(", "secret", "!", "=", "null", ")", "&", "&", "!", "secretPresentInRequest", ")", "{", "response", ".", "setStatus", "(", "403", ")", ";", "setErrorState", "(", "ErrorState", ".", "CLOSE_CLEAN", ",", "null", ")", ";", "}", "@", "@", "-", "32", ",", "5", "+", "32", ",", "6", "@", "@", "ajpprocessor", ".", "request", ".", "process", "=", "Error", "processing", "request", "ajpprotocol", ".", "noBio", "=", "The", "AJP", "BIO", "connector", "has", "been", "removed", "in", "Tomcat", "8", ".", "5", ".", "x", "onwards", ".", "The", "AJP", "BIO", "connector", "configuration", "has", "been", "automatically", "switched", "to", "use", "the", "AJP", "NIO", "connector", "instead", ".", "ajpprotocol", ".", "noSSL", "=", "SSL", "is", "not", "supported", "with", "AJP", ".", "The", "SSL", "host", "configuration", "for", "[", "{", "0", "}", "]", "was", "ignored", "ajpprotocol", ".", "nosecret", "=", "The", "AJP", "Connector", "is", "configured", "with", "secretRequired", "=", "\"", "true", "\"", "but", "the", "secret", "attribute", "is", "either", "null", "or", "\"", "\".", "This", "combination", "is", "not", "valid", ".", "ajpprotocol", ".", "noUpgrade", "=", "Upgrade", "is", "not", "supported", "with", "AJP", ".", "The", "UpgradeProtocol", "configuration", "for", "[", "{", "0", "}", "]", "was", "ignored", "ajpprotocol", ".", "noUpgradeHandler", "=", "Upgrade", "is", "not", "supported", "with", "AJP", ".", "The", "HttpUpgradeHandler", "[", "{", "0", "}", "]", "can", "not", "be", "processed", "@", "@", "-", "187", ",", "6", "+", "187", ",", "14", "@", "@", "Change", "the", "default", "bind", "address", "for", "the", "AJP", "/", "1", ".", "3", "connector", "to", "be", "the", "loopback", "address", ".", "(", "markt", ")", "<", "/", "update", ">", "<", "add", ">", "Rename", "the", "<", "code", ">", "requiredSecret", "<", "/", "code", ">", "attribute", "of", "the", "AJP", "/", "1", ".", "3", "Connector", "to", "<", "code", ">", "secret", "<", "/", "code", ">", "and", "add", "a", "new", "attribute", "<", "code", ">", "secretRequired", "<", "/", "code", ">", "that", "defaults", "to", "<", "code", ">", "true", "<", "/", "code", ">", ".", "When", "<", "code", ">", "secretRequired", "<", "/", "code", ">", "is", "<", "code", ">", "true", "<", "/", "code", ">", "the", "AJP", "/", "1", ".", "3", "Connector", "will", "not", "start", "unless", "the", "<", "code", ">", "secret", "<", "/", "code", ">", "attribute", "is", "configured", "to", "a", "non", "-", "null", ",", "non", "-", "zero", "length", "String", ".", "(", "markt", ")", "<", "/", "add", ">", "<", "/", "changelog", ">", "<", "/", "subsection", ">", "<", "subsection", "name", "=", "\"", "Jasper", "\"", ">", "@", "@", "-", "437", ",", "8", "+", "437", ",", "18", "@", "@", "expected", "concurrent", "requests", "(", "synchronous", "and", "asynchronous", ")", ".<", "/", "p", ">", "<", "/", "attribute", ">", "<", "attribute", "name", "=", "\"", "requiredSecret", "\"", "required", "=", "\"", "false", "\"", ">", "<", "attribute", "name", "=", "\"", "secret", "\"", "required", "=", "\"", "false", "\"", ">", "<", "p", ">", "Only", "requests", "from", "workers", "with", "this", "secret", "keyword", "will", "be", "accepted", ".", "The", "default", "value", "is", "<", "code", ">", "null", "<", "/", "code", ">", ".", "This", "attrbute", "must", "be", "specified", "with", "a", "non", "-", "null", ",", "non", "-", "zero", "length", "value", "unless", "<", "strong", ">", "secretRequired", "<", "/", "strong", ">", "is", "explicitly", "configured", "to", "be", "<", "code", ">", "false", "<", "/", "code", ">", ".<", "/", "p", ">", "<", "/", "attribute", ">", "<", "attribute", "name", "=", "\"", "secretRequired", "\"", "required", "=", "\"", "false", "\"", ">", "<", "p", ">", "If", "this", "attribute", "is", "<", "code", ">", "true", "<", "/", "code", ">", ",", "the", "AJP", "Connector", "will", "only", "start", "if", "the", "<", "strong", ">", "secret", "<", "/", "strong", ">", "attribute", "is", "configured", "with", "a", "non", "-", "null", ",", "non", "-", "zero", "length", "value", ".", "The", "default", "value", "is", "<", "code", ">", "true", "<", "/", "code", ">", ".", "<", "/", "p", ">", "<", "/", "attribute", ">"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "3109", ",", "6", "+", "3109", ",", "12", "@", "@", "int", "ff_mpeg4_decode_picture_header", "(", "Mpeg4DecContext", "*", "ctx", ",", "GetBitContext", "*", "gb", ")", "/", "*", "search", "next", "start", "code", "*", "/", "align_get_bits", "(", "gb", ")", ";", "/", "/", "If", "we", "have", "not", "switched", "to", "studio", "profile", "than", "we", "also", "did", "not", "switch", "bps", "/", "/", "that", "means", "something", "else", "(", "like", "a", "previous", "instance", ")", "outside", "set", "bps", "which", "/", "/", "would", "be", "inconsistant", "with", "the", "currect", "state", ",", "thus", "reset", "it", "if", "(", "!", "s", "-", ">", "studio_profile", "&", "&", "s", "-", ">", "avctx", "-", ">", "bits_per_raw_sample", "!", "=", "8", ")", "s", "-", ">", "avctx", "-", ">", "bits_per_raw_sample", "=", "0", ";", "if", "(", "s", "-", ">", "codec_tag", "=", "=", "AV_RL32", "(", "\"", "WV1F", "\"", ")", "&", "&", "show_bits", "(", "gb", ",", "24", ")", "=", "=", "0x575630", ")", "{", "skip_bits", "(", "gb", ",", "24", ")", ";", "if", "(", "get_bits", "(", "gb", ",", "8", ")", "=", "=", "0xF0", ")"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2027", ",", "7", "+", "2027", ",", "7", "@", "@", "static", "int", "sctp_sendmsg", "(", "struct", "sock", "*", "sk", ",", "struct", "msghdr", "*", "msg", ",", "size_t", "msg_len", ")", "struct", "sctp_endpoint", "*", "ep", "=", "sctp_sk", "(", "sk", ")", "->", "ep", ";", "struct", "sctp_transport", "*", "transport", "=", "NULL", ";", "struct", "sctp_sndrcvinfo", "_sinfo", ",", "*", "sinfo", ";", "struct", "sctp_association", "*", "asoc", ";", "struct", "sctp_association", "*", "asoc", ",", "*", "tmp", ";", "struct", "sctp_cmsgs", "cmsgs", ";", "union", "sctp_addr", "*", "daddr", ";", "bool", "new", "=", "false", ";", "@", "@", "-", "2053", ",", "7", "+", "2053", ",", "7", "@", "@", "static", "int", "sctp_sendmsg", "(", "struct", "sock", "*", "sk", ",", "struct", "msghdr", "*", "msg", ",", "size_t", "msg_len", ")", "/", "*", "SCTP_SENDALL", "process", "*", "/", "if", "(", "(", "sflags", "&", "SCTP_SENDALL", ")", "&", "&", "sctp_style", "(", "sk", ",", "UDP", ")", ")", "{", "list_for_each_entry", "(", "asoc", ",", "&", "ep", "-", ">", "asocs", ",", "asocs", ")", "{", "list_for_each_entry_safe", "(", "asoc", ",", "tmp", ",", "&", "ep", "-", ">", "asocs", ",", "asocs", ")", "{", "err", "=", "sctp_sendmsg_check_sflags", "(", "asoc", ",", "sflags", ",", "msg", ",", "msg_len", ")", ";", "if", "(", "err", "=", "=", "0", ")"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "116", ",", "10", "+", "116", ",", "10", "@", "@", "static", "void", "ip_cmsg_recv_checksum", "(", "struct", "msghdr", "*", "msg", ",", "struct", "sk_buff", "*", "skb", ",", "if", "(", "skb", "-", ">", "ip_summed", "!", "=", "CHECKSUM_COMPLETE", ")", "return", ";", "if", "(", "offset", "!", "=", "0", ")", "csum", "=", "csum_sub", "(", "csum", ",", "csum_partial", "(", "skb_transport_header", "(", "skb", ")", "+", "tlen", ",", "offset", ",", "0", ")", ");", "if", "(", "offset", "!", "=", "0", ")", "{", "int", "tend_off", "=", "skb_transport_offset", "(", "skb", ")", "+", "tlen", ";", "csum", "=", "csum_sub", "(", "csum", ",", "skb_checksum", "(", "skb", ",", "tend_off", ",", "offset", ",", "0", ")", ");", "}", "put_cmsg", "(", "msg", ",", "SOL_IP", ",", "IP_CHECKSUM", ",", "sizeof", "(", "__wsum", ")", ",", "&", "csum", ")", ";", "}"], "docstring_tokens": ["using", "specially-crafted", "system", "calls"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "28", ",", "6", "+", "28", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "commons", ".", "lang", ".", "StringUtils", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "AncestorInPath", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "QueryParameter", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "verb", ".", "POST", ";", "import", "com", ".", "agiletestware", ".", "pangolin", ".", "client", ".", "DefaultPangolinClientFactory", ";", "import", "com", ".", "agiletestware", ".", "pangolin", ".", "client", ".", "DefaultRetrofitFactory", ";", "@", "@", "-", "45", ",", "6", "+", "46", ",", "7", "@", "@", "import", "hudson", ".", "model", ".", "AbstractProject", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "jenkins", ".", "model", ".", "GlobalConfiguration", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "/", "**", "*", "Global", "configuration", "for", "Pangolin", "plugin", ".", "@", "@", "-", "98", ",", "13", "+", "100", ",", "14", "@", "@", "public", "GlobalConfig", "(", ")", "{", "*", "@", "return", "the", "form", "validation", "*", "/", "/", "/", "GlobalSettings", "form", "validation", "@", "POST", "public", "FormValidation", "doSaveConnection", "(", "@", "QueryParameter", "(", "\"", "pangolinUrl", "\"", ")", "final", "String", "pangolinUrl", ",", "@", "QueryParameter", "(", "\"", "testRailUrl", "\"", ")", "final", "String", "testRailUrl", ",", "@", "QueryParameter", "(", "\"", "testRailUserName", "\"", ")", "final", "String", "testRailUserName", ",", "@", "QueryParameter", "(", "\"", "testRailPassword", "\"", ")", "final", "String", "testRailPassword", ",", "@", "QueryParameter", "(", "\"", "uploadTimeOut", "\"", ")", "final", "int", "uploadTimeOut", ")", "{", "Jenkins", ".", "getInstance", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "final", "String", "pangolinURLTrimmed", "=", "fixEmptyAndTrim", "(", "pangolinUrl", ")", ";", "final", "String", "testRailURLTrimmed", "=", "fixEmptyAndTrim", "(", "testRailUrl", ")", ";", "final", "String", "testRailUserNameTrimmed", "=", "fixEmptyAndTrim", "(", "testRailUserName", ")", ";", "@", "@", "-", "34", ",", "8", "+", "34", ",", "11", "@", "@", "import", "javax", ".", "servlet", ".", "ServletException", ";", "import", "org", ".", "acegisecurity", ".", "Authentication", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Rule", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "rules", ".", "ExpectedException", ";", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", ";", "import", "org", ".", "powermock", ".", "api", ".", "mockito", ".", "PowerMockito", ";", "import", "org", ".", "powermock", ".", "core", ".", "classloader", ".", "annotations", ".", "PrepareForTest", ";", "@", "@", "-", "46", ",", "6", "+", "49", ",", "9", "@", "@", "import", "com", ".", "agiletestware", ".", "pangolin", ".", "validator", ".", "CustomUrlAvailableValidator", ";", "import", "hudson", ".", "model", ".", "AbstractProject", ";", "import", "hudson", ".", "security", ".", "ACL", ";", "import", "hudson", ".", "security", ".", "AccessDeniedException2", ";", "import", "hudson", ".", "security", ".", "Permission", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "@", "@", "-", "66", ",", "6", "+", "72", ",", "8", "@", "@", "private", "static", "final", "int", "TIME_OUT", "=", "1", ";", "private", "static", "final", "String", "ENCRYPTED_PASSWORD", "=", "\"", "encryptedPassword", "\"", ";", "@", "Rule", "public", "ExpectedException", "expected", "=", "ExpectedException", ".", "none", "(", ");", "private", "final", "Jenkins", "jenkins", "=", "mock", "(", "Jenkins", ".", "class", ")", ";", "private", "GlobalConfig", "globalConfig", ";", "private", "final", "CustomUrlAvailableValidator", "alwaysValidValidator", "=", "mock", "(", "CustomUrlAvailableValidator", ".", "class", ")", ";", "@", "@", "-", "74", ",", "6", "+", "82", ",", "14", "@", "@", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "PowerMockito", ".", "mockStatic", "(", "Jenkins", ".", "class", ")", ";", "PowerMockito", ".", "when", "(", "Jenkins", ".", "getInstance", "(", "))", ".", "thenReturn", "(", "jenkins", ")", ";", "PowerMockito", ".", "when", "(", "Jenkins", ".", "getAuthentication", "(", "))", ".", "thenCallRealMethod", "(", ");", "when", "(", "jenkins", ".", "getACL", "(", "))", ".", "thenReturn", "(", "new", "ACL", "(", ")", "{", "@", "Override", "public", "boolean", "hasPermission", "(", "final", "Authentication", "a", ",", "final", "Permission", "permission", ")", "{", "return", "true", ";", "}", "}", ");", "globalConfig", "=", "spy", "(", "GlobalConfig", ".", "class", ")", ";", "doAnswer", "(", "(", "i", ")", "-", ">", "null", ")", ".", "when", "(", "globalConfig", ")", ".", "save", "(", ");", "when", "(", "alwaysValidValidator", ".", "validate", "(", "any", "(", "),", "any", "(", "))", ").", "thenReturn", "(", "FormValidation", ".", "ok", "(", "))", ";", "@", "@", "-", "179", ",", "6", "+", "195", ",", "19", "@", "@", "public", "void", "doSaveConnectionWithDifferentPasswordValues", "(", ")", "throws", "Exception", "{", "verifyNoMoreInteractions", "(", "client", ")", ";", "}", "@", "Test", "public", "void", "doSaveConnectionFailOnMissingPrivileges", "(", ")", "{", "expected", ".", "expect", "(", "AccessDeniedException2", ".", "class", ")", ";", "when", "(", "jenkins", ".", "getACL", "(", "))", ".", "thenReturn", "(", "new", "ACL", "(", ")", "{", "@", "Override", "public", "boolean", "hasPermission", "(", "final", "Authentication", "a", ",", "final", "Permission", "permission", ")", "{", "return", "false", ";", "}", "}", ");", "globalConfig", ".", "doSaveConnection", "(", "PANGOLIN_URL", ",", "TEST_RAIL_URL", ",", "TEST_RAIL_USER", ",", "TEST_RAIL_PASSWORD", ",", "TIME_OUT", ")", ";", "}", "@", "Test", "public", "void", "doCheckPassPangolinURL", "(", ")", "throws", "IOException", ",", "ServletException", "{", "final", "List", "<", "String", ">", "urls", "=", "Arrays", ".", "asList", "(", "\"", "http", ":", "//", "localhost", ":", "9090", "\"", ",", "\"", "https", ":", "//", "localhost", ":", "9090", "\"", ",", "\"", "http", ":", "//", "localhost", "\"", ","], "docstring_tokens": ["using", "attacker", "specified", "credentials"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "277", ",", "6", "+", "277", ",", "11", "@", "@", "static", "int", "putreg", "(", "struct", "task_struct", "*", "child", ",", "return", "-", "EIO", ";", "value", "&", "=", "0xffff", ";", "break", ";", "case", "offsetof", "(", "struct", "user_regs_struct", ",", "rip", ")", ":", "/", "*", "Check", "if", "the", "new", "RIP", "address", "is", "canonical", "*", "/", "if", "(", "value", ">", "=", "TASK_SIZE", ")", "return", "-", "EIO", ";", "break", ";", "}", "put_stack_long", "(", "child", ",", "regno", "-", "sizeof", "(", "struct", "pt_regs", ")", ",", "value", ")", ";", "return", "0", ";"], "docstring_tokens": ["via", "a", "\"non-canonical", "\"", "address", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "690", ",", "6", "+", "690", ",", "7", "@", "@", "static", "int", "l2tp_ip6_recvmsg", "(", "struct", "kiocb", "*", "iocb", ",", "struct", "sock", "*", "sk", ",", "lsa", "-", ">", "l2tp_addr", "=", "ipv6_hdr", "(", "skb", ")", "->", "saddr", ";", "lsa", "-", ">", "l2tp_flowinfo", "=", "0", ";", "lsa", "-", ">", "l2tp_scope_id", "=", "0", ";", "lsa", "-", ">", "l2tp_conn_id", "=", "0", ";", "if", "(", "ipv6_addr_type", "(", "&", "lsa", "-", ">", "l2tp_addr", ")", "&", "IPV6_ADDR_LINKLOCAL", ")", "lsa", "-", ">", "l2tp_scope_id", "=", "IP6CB", "(", "skb", ")", "->", "iif", ";", "}"], "docstring_tokens": ["via", "a", "crafted", "recvmsg", "or", "recvfrom", "system", "call", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "486", ",", "12", "+", "486", ",", "14", "@", "@", "static", "unsigned", "int", "tun_chr_poll", "(", "struct", "file", "*", "file", ",", "poll_table", "*", "wait", ")", "{", "struct", "tun_file", "*", "tfile", "=", "file", "-", ">", "private_data", ";", "struct", "tun_struct", "*", "tun", "=", "__tun_get", "(", "tfile", ")", ";", "struct", "sock", "*", "sk", "=", "tun", "-", ">", "sk", ";", "struct", "sock", "*", "sk", ";", "unsigned", "int", "mask", "=", "0", ";", "if", "(", "!", "tun", ")", "return", "POLLERR", ";", "sk", "=", "tun", "-", ">", "sk", ";", "DBG", "(", "KERN_INFO", "\"", "%", "s", ":", "tun_chr_poll", "\\", "n", "\"", ",", "tun", "-", ">", "dev", "-", ">", "name", ")", ";", "poll_wait", "(", "file", ",", "&", "tun", "-", ">", "socket", ".", "wait", ",", "wait", ")", ";"], "docstring_tokens": ["moving", "one", "line", "of", "code"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "188", ",", "9", "+", "188", ",", "6", "@", "@", "unsigned", "ext4_init_block_bitmap", "(", "struct", "super_block", "*", "sb", ",", "struct", "buffer_head", "*", "bh", ",", "*", "when", "a", "file", "system", "is", "mounted", "(", "see", "ext4_fill_super", ")", ".", "*", "/", "#", "define", "in_range", "(", "b", ",", "first", ",", "len", ")", "(", "(", "b", ")", ">", "=", "(", "first", ")", "&", "&", "(", "b", ")", "<", "=", "(", "first", ")", "+", "(", "len", ")", "-", "1", ")", "/", "**", "*", "ext4_get_group_desc", "(", ")", "-", "-", "load", "group", "descriptor", "from", "disk", "*", "@", "sb", ":", "super", "block", "@", "@", "-", "1819", ",", "6", "+", "1819", ",", "8", "@", "@", "static", "inline", "void", "set_bitmap_uptodate", "(", "struct", "buffer_head", "*", "bh", ")", "set_bit", "(", "BH_BITMAP_UPTODATE", ",", "&", "(", "bh", ")", "->", "b_state", ")", ";", "}", "#", "define", "in_range", "(", "b", ",", "first", ",", "len", ")", "(", "(", "b", ")", ">", "=", "(", "first", ")", "&", "&", "(", "b", ")", "<", "=", "(", "first", ")", "+", "(", "len", ")", "-", "1", ")", "#", "endif", "/", "*", "__KERNEL__", "*", "/", "#", "endif", "/", "*", "_EXT4_H", "*", "/", "@", "@", "-", "2051", ",", "7", "+", "2051", ",", "7", "@", "@", "ext4_ext_in_cache", "(", "struct", "inode", "*", "inode", ",", "ext4_lblk_t", "block", ",", "BUG_ON", "(", "cex", "-", ">", "ec_type", "!", "=", "EXT4_EXT_CACHE_GAP", "&", "&", "cex", "-", ">", "ec_type", "!", "=", "EXT4_EXT_CACHE_EXTENT", ")", ";", "if", "(", "block", ">", "=", "cex", "-", ">", "ec_block", "&", "&", "block", "<", "cex", "-", ">", "ec_block", "+", "cex", "-", ">", "ec_len", ")", "{", "if", "(", "in_range", "(", "block", ",", "cex", "-", ">", "ec_block", ",", "cex", "-", ">", "ec_len", ")", ")", "{", "ex", "-", ">", "ee_block", "=", "cpu_to_le32", "(", "cex", "-", ">", "ec_block", ")", ";", "ext4_ext_store_pblock", "(", "ex", ",", "cex", "-", ">", "ec_start", ")", ";", "ex", "-", ">", "ee_len", "=", "cpu_to_le16", "(", "cex", "-", ">", "ec_len", ")", ";", "@", "@", "-", "3364", ",", "7", "+", "3364", ",", "7", "@", "@", "int", "ext4_ext_get_blocks", "(", "handle_t", "*", "handle", ",", "struct", "inode", "*", "inode", ",", "*", "/", "ee_len", "=", "ext4_ext_get_actual_len", "(", "ex", ")", ";", "/", "*", "if", "found", "extent", "covers", "block", ",", "simply", "return", "it", "*", "/", "if", "(", "iblock", ">", "=", "ee_block", "&", "&", "iblock", "<", "ee_block", "+", "ee_len", ")", "{", "if", "(", "in_range", "(", "iblock", ",", "ee_block", ",", "ee_len", ")", ")", "{", "newblock", "=", "iblock", "-", "ee_block", "+", "ee_start", ";", "/", "*", "number", "of", "remaining", "blocks", "in", "the", "extent", "*", "/", "allocated", "=", "ee_len", "-", "(", "iblock", "-", "ee_block", ")", ";", "@", "@", "-", "220", ",", "8", "+", "220", ",", "6", "@", "@", "struct", "ext4_buddy", "{", "#", "define", "EXT4_MB_BITMAP", "(", "e4b", ")", "(", "(", "e4b", ")", "->", "bd_bitmap", ")", "#", "define", "EXT4_MB_BUDDY", "(", "e4b", ")", "(", "(", "e4b", ")", "->", "bd_buddy", ")", "#", "define", "in_range", "(", "b", ",", "first", ",", "len", ")", "(", "(", "b", ")", ">", "=", "(", "first", ")", "&", "&", "(", "b", ")", "<", "=", "(", "first", ")", "+", "(", "len", ")", "-", "1", ")", "static", "inline", "ext4_fsblk_t", "ext4_grp_offs_to_block", "(", "struct", "super_block", "*", "sb", ",", "struct", "ext4_free_extent", "*", "fex", ")", "{"], "docstring_tokens": ["via", "a", "write", "operation", "on", "the", "last", "block", "of", "a", "large", "file"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1", ",", "7", "+", "1", ",", "7", "@", "@", "/", "*", "*", "*", "**", "**", "BEGIN", "LICENSE", "BLOCK", "*", "**", "**", "*", "Zimbra", "Collaboration", "Suite", "Server", "*", "Copyright", "(", "C", ")", "2006", ",", "2007", ",", "2008", ",", "2009", ",", "2010", ",", "2011", ",", "2013", ",", "2014", ",", "2016", "Synacor", ",", "Inc", ".", "*", "Copyright", "(", "C", ")", "2006", ",", "2007", ",", "2008", ",", "2009", ",", "2010", ",", "2011", ",", "2013", ",", "2014", ",", "2016", ",", "2020", "Synacor", ",", "Inc", ".", "*", "*", "This", "program", "is", "free", "software", ":", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "it", "under", "*", "the", "terms", "of", "the", "GNU", "General", "Public", "License", "as", "published", "by", "the", "Free", "Software", "Foundation", ",", "@", "@", "-", "57", ",", "8", "+", "57", ",", "14", "@", "@", "public", "Element", "handle", "(", "Element", "request", ",", "Map", "<", "String", ",", "Object", ">", "context", ")", "throws", "Servi", "params", ".", "setLimit", "(", "account", ".", "getContactAutoCompleteMaxResults", "(", "))", ";", "params", ".", "setNeedCanExpand", "(", "needCanExpand", ")", ";", "params", ".", "setResponseName", "(", "AccountConstants", ".", "AUTO_COMPLETE_GAL_RESPONSE", ")", ";", "if", "(", "galAcctId", "!", "=", "null", ")", "params", ".", "setGalSyncAccount", "(", "Provisioning", ".", "getInstance", "(", ").", "getAccountById", "(", "galAcctId", ")", ");", "if", "(", "galAcctId", "!", "=", "null", ")", "{", "Account", "galAccount", "=", "Provisioning", ".", "getInstance", "(", ").", "getAccountById", "(", "galAcctId", ")", ";", "if", "(", "galAccount", "!", "=", "null", "&", "&", "(", "!", "account", ".", "getDomainId", "(", ").", "equals", "(", "galAccount", ".", "getDomainId", "(", "))", "))", "{", "throw", "ServiceException", ".", "PERM_DENIED", "(", "\"", "can", "not", "access", "galsync", "account", "of", "different", "domain", "\"", ");", "}", "params", ".", "setGalSyncAccount", "(", "galAccount", ")", ";", "}", "GalSearchControl", "gal", "=", "new", "GalSearchControl", "(", "params", ")", ";", "gal", ".", "autocomplete", "(", ");", "return", "params", ".", "getResultCallback", "(", ").", "getResponse", "(", ");"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "64", ",", "6", "+", "64", ",", "7", "@", "@", "import", "org", ".", "mindrot", ".", "jbcrypt", ".", "BCrypt", ";", "import", "org", ".", "springframework", ".", "dao", ".", "DataAccessException", ";", "import", "javax", ".", "annotation", ".", "Nonnull", ";", "import", "javax", ".", "servlet", ".", "Filter", ";", "import", "javax", ".", "servlet", ".", "FilterChain", ";", "import", "javax", ".", "servlet", ".", "FilterConfig", ";", "@", "@", "-", "95", ",", "6", "+", "96", ",", "15", "@", "@", "*", "@", "author", "Kohsuke", "Kawaguchi", "*", "/", "public", "class", "HudsonPrivateSecurityRealm", "extends", "AbstractPasswordBasedSecurityRealm", "implements", "ModelObject", ",", "AccessControlled", "{", "private", "static", "/", "*", "not", "final", "*", "/", "String", "ID_REGEX", "=", "System", ".", "getProperty", "(", "HudsonPrivateSecurityRealm", ".", "class", ".", "getName", "(", ")", "+", "\"", ".", "ID_REGEX", "\"", ");", "/", "**", "*", "Default", "REGEX", "for", "the", "user", "ID", "check", "in", "case", "the", "ID_REGEX", "is", "not", "set", "*", "It", "allows", "A", "-", "Za", "-", "z0", "-", "9", "+", "\"", "_", "-", "\"", "*", "in", "Java", "{", "@", "code", "\\", "w", "}", "is", "equivalent", "to", "{", "@", "code", "[", "A", "-", "Za", "-", "z0", "-", "9_", "]", "}", "(", "take", "care", "of", "\"", "_", "\"", ")", "*", "/", "private", "static", "final", "String", "DEFAULT_ID_REGEX", "=", "\"", "^[", "\\\\", "w", "-", "]+", "$\"", ";", "/", "**", "*", "If", "true", ",", "sign", "up", "is", "not", "allowed", ".", "*", "<", "p", ">", "@", "@", "-", "338", ",", "6", "+", "348", ",", "12", "@", "@", "private", "User", "createAccount", "(", "StaplerRequest", "req", ",", "StaplerResponse", "rsp", ",", "boolean", "self", "if", "(", "si", ".", "username", "=", "=", "null", "|", "|", "si", ".", "username", ".", "length", "(", ")=", "=", "0", ")", "si", ".", "errorMessage", "=", "Messages", ".", "HudsonPrivateSecurityRealm_CreateAccount_UserNameRequired", "(", ");", "else", "if", "(", "!", "containsOnlyAcceptableCharacters", "(", "si", ".", "username", ")", ")", "if", "(", "ID_REGEX", "=", "=", "null", ")", "{", "si", ".", "errorMessage", "=", "Messages", ".", "HudsonPrivateSecurityRealm_CreateAccount_UserNameInvalidCharacters", "(", ");", "}", "else", "{", "si", ".", "errorMessage", "=", "Messages", ".", "HudsonPrivateSecurityRealm_CreateAccount_UserNameInvalidCharactersCustom", "(", "ID_REGEX", ")", ";", "}", "else", "{", "/", "/", "do", "not", "create", "the", "user", "-", "we", "just", "want", "to", "check", "if", "the", "user", "already", "exists", "but", "is", "not", "a", "\"", "login", "\"", "user", ".", "User", "user", "=", "User", ".", "getById", "(", "si", ".", "username", ",", "false", ")", ";", "@", "@", "-", "385", ",", "6", "+", "401", ",", "14", "@", "@", "private", "User", "createAccount", "(", "StaplerRequest", "req", ",", "StaplerResponse", "rsp", ",", "boolean", "self", "return", "user", ";", "}", "private", "boolean", "containsOnlyAcceptableCharacters", "(", "@", "Nonnull", "String", "value", ")", "{", "if", "(", "ID_REGEX", "=", "=", "null", ")", "{", "return", "value", ".", "matches", "(", "DEFAULT_ID_REGEX", ")", ";", "}", "else", "{", "return", "value", ".", "matches", "(", "ID_REGEX", ")", ";", "}", "}", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "public", "boolean", "isMailerPluginPresent", "(", ")", "{", "try", "{", "@", "@", "-", "37", ",", "6", "+", "37", ",", "8", "@", "@", "HudsonPrivateSecurityRealm", ".", "CreateAccount", ".", "TextNotMatchWordInImage", "=", "Text", "didn", "'", "t", "mat", "HudsonPrivateSecurityRealm", ".", "CreateAccount", ".", "PasswordNotMatch", "=", "Password", "didn", "'", "t", "match", "HudsonPrivateSecurityRealm", ".", "CreateAccount", ".", "PasswordRequired", "=", "Password", "is", "required", "HudsonPrivateSecurityRealm", ".", "CreateAccount", ".", "UserNameRequired", "=", "User", "name", "is", "required", "HudsonPrivateSecurityRealm", ".", "CreateAccount", ".", "UserNameInvalidCharacters", "=", "User", "name", "must", "only", "contain", "alphanumeric", "characters", ",", "underscore", "and", "dash", "HudsonPrivateSecurityRealm", ".", "CreateAccount", ".", "UserNameInvalidCharactersCustom", "=", "User", "name", "must", "match", "the", "following", "expression", ":", "{", "0", "}", "HudsonPrivateSecurityRealm", ".", "CreateAccount", ".", "InvalidEmailAddress", "=", "Invalid", "e", "-", "mail", "address", "HudsonPrivateSecurityRealm", ".", "CreateAccount", ".", "UserNameAlreadyTaken", "=", "User", "name", "is", "already", "taken", "@", "@", "-", "2", ",", "15", "+", "2", ",", "21", "@", "@", "import", "static", "hudson", ".", "security", ".", "HudsonPrivateSecurityRealm", ".", "CLASSIC", ";", "import", "static", "hudson", ".", "security", ".", "HudsonPrivateSecurityRealm", ".", "PASSWORD_ENCODER", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "containsString", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "not", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertFalse", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertThat", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "is", ";", "import", "static", "org", ".", "hamcrest", ".", "xml", ".", "HasXPath", ".", "hasXPath", ";", "import", "java", ".", "io", ".", "UnsupportedEncodingException", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Field", ";", "import", "hudson", ".", "security", ".", "pages", ".", "SignupPage", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Rule", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "Issue", ";", "@", "@", "-", "34", ",", "6", "+", "40", ",", "13", "@", "@", "@", "Rule", "public", "JenkinsRule", "j", "=", "new", "JenkinsRule", "(", ");", "@", "Before", "public", "void", "setup", "(", ")", "throws", "Exception", "{", "Field", "field", "=", "HudsonPrivateSecurityRealm", ".", "class", ".", "getDeclaredField", "(", "\"", "ID_REGEX", "\"", ");", "field", ".", "setAccessible", "(", "true", ")", ";", "field", ".", "set", "(", "null", ",", "null", ")", ";", "}", "/", "**", "*", "Tests", "the", "data", "compatibility", "with", "Hudson", "before", "1", ".", "283", ".", "*", "Starting", "1", ".", "283", ",", "passwords", "are", "now", "stored", "hashed", ".", "@", "@", "-", "170", ",", "5", "+", "183", ",", "119", "@", "@", "private", "static", "final", "String", "basicHeader", "(", "String", "user", ",", "String", "pass", ")", "throws", "Unsuppo", "String", "authHeader", "=", "\"", "Basic", "\"", "+", "auth", ";", "return", "authHeader", ";", "}", "@", "Issue", "(", "\"", "SECURITY", "-", "786", "\"", ")", "@", "Test", "public", "void", "controlCharacterAreNoMoreValid", "(", ")", "throws", "Exception", "{", "HudsonPrivateSecurityRealm", "securityRealm", "=", "new", "HudsonPrivateSecurityRealm", "(", "true", ",", "false", ",", "null", ")", ";", "j", ".", "jenkins", ".", "setSecurityRealm", "(", "securityRealm", ")", ";", "String", "password", "=", "\"", "testPwd", "\"", ";", "String", "email", "=", "\"", "test", "@", "test", ".", "com", "\"", ";", "int", "i", "=", "0", ";", "/", "/", "regular", "case", "=", "only", "accepting", "a", "-", "zA", "-", "Z0", "-", "9", "+", "\"", "-", "_", "\"", "checkUserCanBeCreatedWith", "(", "securityRealm", ",", "\"", "test", "\"", "+", "i", ",", "password", ",", "\"", "Test", "\"", "+", "i", ",", "email", ")", ";", "assertNotNull", "(", "User", ".", "getById", "(", "\"", "test", "\"", "+", "i", ",", "false", ")", ");", "i", "+", "+;", "checkUserCanBeCreatedWith", "(", "securityRealm", ",", "\"", "te", "-", "st_123", "\"", "+", "i", ",", "password", ",", "\"", "Test", "\"", "+", "i", ",", "email", ")", ";", "assertNotNull", "(", "User", ".", "getById", "(", "\"", "te", "-", "st_123", "\"", "+", "i", ",", "false", ")", ");", "i", "+", "+;", "{", "//", "user", "id", "that", "contains", "invalid", "characters", "checkUserCannotBeCreatedWith", "(", "securityRealm", ",", "\"", "test", "\"", "+", "i", ",", "password", ",", "\"", "Test", "\"", "+", "i", ",", "email", ")", ";", "i", "+", "+;", "checkUserCannotBeCreatedWith", "(", "securityRealm", ",", "\"", "te", "@", "st", "\"", "+", "i", ",", "password", ",", "\"", "Test", "\"", "+", "i", ",", "email", ")", ";", "i", "+", "+;", "checkUserCannotBeCreatedWith", "(", "securityRealm", ",", "\"", "test", ".", "com", "\"", "+", "i", ",", "password", ",", "\"", "Test", "\"", "+", "i", ",", "email", ")", ";", "i", "+", "+;", "checkUserCannotBeCreatedWith", "(", "securityRealm", ",", "\"", "test", ",", "com", "\"", "+", "i", ",", "password", ",", "\"", "Test", "\"", "+", "i", ",", "email", ")", ";", "i", "+", "+;", "checkUserCannotBeCreatedWith", "(", "securityRealm", ",", "\"", "test", ",", "com", "\"", "+", "i", ",", "password", ",", "\"", "Test", "\"", "+", "i", ",", "email", ")", ";", "i", "+", "+;", "checkUserCannotBeCreatedWith", "(", "securityRealm", ",", "\"", "test", "\u00e9", "com", "\"", "+", "i", ",", "password", ",", "\"", "Test", "\"", "+", "i", ",", "email", ")", ";", "i", "+", "+;", "checkUserCannotBeCreatedWith", "(", "securityRealm", ",", "\"", "Starg", "\u00e5", "te", "\"", "+", "i", ",", "password", ",", "\"", "Test", "\"", "+", "i", ",", "email", ")", ";", "i", "+", "+;", "checkUserCannotBeCreatedWith", "(", "securityRealm", ",", "\"", "te", "\\", "u0000st", "\"", "+", "i", ",", "password", ",", "\"", "Test", "\"", "+", "i", ",", "email", ")", ";", "i", "+", "+;", "}", "}", "@", "Issue", "(", "\"", "SECURITY", "-", "786", "\"", ")", "@", "Test", "public", "void", "controlCharacterAreNoMoreValid_CustomRegex", "(", ")", "throws", "Exception", "{", "HudsonPrivateSecurityRealm", "securityRealm", "=", "new", "HudsonPrivateSecurityRealm", "(", "true", ",", "false", ",", "null", ")", ";", "j", ".", "jenkins", ".", "setSecurityRealm", "(", "securityRealm", ")", ";", "String", "currentRegex", "=", "\"", "^[", "A", "-", "Z", "]", "+[", "0", "-", "9", "]", "*$", "\";", "Field", "field", "=", "HudsonPrivateSecurityRealm", ".", "class", ".", "getDeclaredField", "(", "\"", "ID_REGEX", "\"", ");", "field", ".", "setAccessible", "(", "true", ")", ";", "field", ".", "set", "(", "null", ",", "currentRegex", ")", ";", "String", "password", "=", "\"", "testPwd", "\"", ";", "String", "email", "=", "\"", "test", "@", "test", ".", "com", "\"", ";", "int", "i", "=", "0", ";", "/", "/", "regular", "case", "=", "only", "accepting", "a", "-", "zA", "-", "Z0", "-", "9", "+", "\"", "-", "_", "\"", "checkUserCanBeCreatedWith", "(", "securityRealm", ",", "\"", "TEST", "\"", "+", "i", ",", "password", ",", "\"", "Test", "\"", "+", "i", ",", "email", ")", ";", "assertNotNull", "(", "User", ".", "getById", "(", "\"", "TEST", "\"", "+", "i", ",", "false", ")", ");", "i", "+", "+;", "checkUserCanBeCreatedWith", "(", "securityRealm", ",", "\"", "TEST123", "\"", "+", "i", ",", "password", ",", "\"", "Test", "\"", "+", "i", ",", "email", ")", ";", "assertNotNull", "(", "User", ".", "getById", "(", "\"", "TEST123", "\"", "+", "i", ",", "false", ")", ");", "i", "+", "+;", "{", "//", "user", "id", "that", "do", "not", "follow", "custom", "regex", "checkUserCannotBeCreatedWith_custom", "(", "securityRealm", ",", "\"", "test", "\"", "+", "i", ",", "password", ",", "\"", "Test", "\"", "+", "i", ",", "email", ",", "currentRegex", ")", ";", "i", "+", "+;", "checkUserCannotBeCreatedWith_custom", "(", "securityRealm", ",", "\"", "@\"", "+", "i", ",", "password", ",", "\"", "Test", "\"", "+", "i", ",", "email", ",", "currentRegex", ")", ";", "i", "+", "+;", "checkUserCannotBeCreatedWith_custom", "(", "securityRealm", ",", "\"", "T2A", "\"", "+", "i", ",", "password", ",", "\"", "Test", "\"", "+", "i", ",", "email", ",", "currentRegex", ")", ";", "i", "+", "+;", "}", "{", "/", "/", "we", "can", "even", "change", "regex", "on", "the", "fly", "currentRegex", "=", "\"", "^[", "0", "-", "9", "]", "*$", "\";", "field", ".", "set", "(", "null", ",", "currentRegex", ")", ";", "checkUserCanBeCreatedWith", "(", "securityRealm", ",", "\"", "125213", "\"", "+", "i", ",", "password", ",", "\"", "Test", "\"", "+", "i", ",", "email", ")", ";", "assertNotNull", "(", "User", ".", "getById", "(", "\"", "125213", "\"", "+", "i", ",", "false", ")", ");", "i", "+", "+;", "checkUserCannotBeCreatedWith_custom", "(", "securityRealm", ",", "\"", "TEST12", "\"", "+", "i", ",", "password", ",", "\"", "Test", "\"", "+", "i", ",", "email", ",", "currentRegex", ")", ";", "i", "+", "+;", "}", "}", "private", "void", "checkUserCanBeCreatedWith", "(", "HudsonPrivateSecurityRealm", "securityRealm", ",", "String", "id", ",", "String", "password", ",", "String", "fullName", ",", "String", "email", ")", "throws", "Exception", "{", "JenkinsRule", ".", "WebClient", "wc", "=", "j", ".", "createWebClient", "(", ");", "SignupPage", "signup", "=", "new", "SignupPage", "(", "wc", ".", "goTo", "(", "\"", "signup", "\"", "))", ";", "signup", ".", "enterUsername", "(", "id", ")", ";", "signup", ".", "enterPassword", "(", "password", ")", ";", "signup", ".", "enterFullName", "(", "fullName", ")", ";", "signup", ".", "enterEmail", "(", "email", ")", ";", "HtmlPage", "success", "=", "signup", ".", "submit", "(", "j", ")", ";", "assertThat", "(", "success", ".", "getElementById", "(", "\"", "main", "-", "panel", "\"", ").", "getTextContent", "(", "),", "containsString", "(", "\"", "Success", "\"", "))", ";", "}", "private", "void", "checkUserCannotBeCreatedWith", "(", "HudsonPrivateSecurityRealm", "securityRealm", ",", "String", "id", ",", "String", "password", ",", "String", "fullName", ",", "String", "email", ")", "throws", "Exception", "{", "JenkinsRule", ".", "WebClient", "wc", "=", "j", ".", "createWebClient", "(", ");", "SignupPage", "signup", "=", "new", "SignupPage", "(", "wc", ".", "goTo", "(", "\"", "signup", "\"", "))", ";", "signup", ".", "enterUsername", "(", "id", ")", ";", "signup", ".", "enterPassword", "(", "password", ")", ";", "signup", ".", "enterFullName", "(", "fullName", ")", ";", "signup", ".", "enterEmail", "(", "email", ")", ";", "HtmlPage", "success", "=", "signup", ".", "submit", "(", "j", ")", ";", "assertThat", "(", "success", ".", "getElementById", "(", "\"", "main", "-", "panel", "\"", ").", "getTextContent", "(", "),", "not", "(", "containsString", "(", "\"", "Success", "\"", "))", ");", "assertThat", "(", "success", ".", "getElementById", "(", "\"", "main", "-", "panel", "\"", ").", "getTextContent", "(", "),", "containsString", "(", "Messages", ".", "HudsonPrivateSecurityRealm_CreateAccount_UserNameInvalidCharacters", "(", "))", ");", "}", "private", "void", "checkUserCannotBeCreatedWith_custom", "(", "HudsonPrivateSecurityRealm", "securityRealm", ",", "String", "id", ",", "String", "password", ",", "String", "fullName", ",", "String", "email", ",", "String", "regex", ")", "throws", "Exception", "{", "JenkinsRule", ".", "WebClient", "wc", "=", "j", ".", "createWebClient", "(", ");", "SignupPage", "signup", "=", "new", "SignupPage", "(", "wc", ".", "goTo", "(", "\"", "signup", "\"", "))", ";", "signup", ".", "enterUsername", "(", "id", ")", ";", "signup", ".", "enterPassword", "(", "password", ")", ";", "signup", ".", "enterFullName", "(", "fullName", ")", ";", "signup", ".", "enterEmail", "(", "email", ")", ";", "HtmlPage", "success", "=", "signup", ".", "submit", "(", "j", ")", ";", "assertThat", "(", "success", ".", "getElementById", "(", "\"", "main", "-", "panel", "\"", ").", "getTextContent", "(", "),", "not", "(", "containsString", "(", "\"", "Success", "\"", "))", ");", "assertThat", "(", "success", ".", "getElementById", "(", "\"", "main", "-", "panel", "\"", ").", "getTextContent", "(", "),", "containsString", "(", "regex", ")", ");", "}", "}"], "docstring_tokens": ["parse", "a", "maliciously", "crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2232", ",", "6", "+", "2232", ",", "7", "@", "@", "static", "inline", "struct", "page", "*", "follow_page", "(", "struct", "vm_area_struct", "*", "vma", ",", "#", "define", "FOLL_TRIED", "0x800", "/", "*", "a", "retry", ",", "previous", "pass", "started", "an", "IO", "*", "/", "#", "define", "FOLL_MLOCK", "0x1000", "/", "*", "lock", "present", "pages", "*", "/", "#", "define", "FOLL_REMOTE", "0x2000", "/", "*", "we", "are", "working", "on", "non", "-", "current", "tsk", "/", "mm", "*", "/", "#", "define", "FOLL_COW", "0x4000", "/", "*", "internal", "GUP", "flag", "*", "/", "typedef", "int", "(", "*", "pte_fn_t", ")", "(", "pte_t", "*", "pte", ",", "pgtable_t", "token", ",", "unsigned", "long", "addr", ",", "void", "*", "data", ")", ";", "@", "@", "-", "60", ",", "6", "+", "60", ",", "16", "@", "@", "static", "int", "follow_pfn_pte", "(", "struct", "vm_area_struct", "*", "vma", ",", "unsigned", "long", "address", ",", "return", "-", "EEXIST", ";", "}", "/", "*", "*", "FOLL_FORCE", "can", "write", "to", "even", "unwritable", "pte", "'", "s", ",", "but", "only", "*", "after", "we", "'", "ve", "gone", "through", "a", "COW", "cycle", "and", "they", "are", "dirty", ".", "*", "/", "static", "inline", "bool", "can_follow_write_pte", "(", "pte_t", "pte", ",", "unsigned", "int", "flags", ")", "{", "return", "pte_write", "(", "pte", ")", "|", "|", "(", "(", "flags", "&", "FOLL_FORCE", ")", "&", "&", "(", "flags", "&", "FOLL_COW", ")", "&", "&", "pte_dirty", "(", "pte", ")", ");", "}", "static", "struct", "page", "*", "follow_page_pte", "(", "struct", "vm_area_struct", "*", "vma", ",", "unsigned", "long", "address", ",", "pmd_t", "*", "pmd", ",", "unsigned", "int", "flags", ")", "{", "@", "@", "-", "95", ",", "7", "+", "105", ",", "7", "@", "@", "static", "struct", "page", "*", "follow_page_pte", "(", "struct", "vm_area_struct", "*", "vma", ",", "}", "if", "(", "(", "flags", "&", "FOLL_NUMA", ")", "&", "&", "pte_protnone", "(", "pte", ")", ")", "goto", "no_page", ";", "if", "(", "(", "flags", "&", "FOLL_WRITE", ")", "&", "&", "!", "pte_write", "(", "pte", ")", ")", "{", "if", "(", "(", "flags", "&", "FOLL_WRITE", ")", "&", "&", "!", "can_follow_write_pte", "(", "pte", ",", "flags", ")", ")", "{", "pte_unmap_unlock", "(", "ptep", ",", "ptl", ")", ";", "return", "NULL", ";", "}", "@", "@", "-", "412", ",", "7", "+", "422", ",", "7", "@", "@", "static", "int", "faultin_page", "(", "struct", "task_struct", "*", "tsk", ",", "struct", "vm_area_struct", "*", "vma", ",", "*", "reCOWed", "by", "userspace", "write", ")", ".", "*", "/", "if", "(", "(", "ret", "&", "VM_FAULT_WRITE", ")", "&", "&", "!", "(", "vma", "-", ">", "vm_flags", "&", "VM_WRITE", ")", ")", "*", "flags", "&", "=", "~", "FOLL_WRITE", ";", "*", "flags", "|", "=", "FOLL_COW", ";", "return", "0", ";", "}"], "docstring_tokens": ["using", "the", "zero", "value", "as", "an", "indicator", "that", "a", "global", "variable", "hasn't", "been", "initialized"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "209", ",", "6", "+", "209", ",", "10", "@", "@", "ENTRY", "(", "ret_from_fork", ")", "GET_THREAD_INFO", "(", "%", "ebp", ")", "popl", "%", "eax", "CFI_ADJUST_CFA_OFFSET", "-", "4", "pushl", "$", "0x0202", "#", "Reset", "kernel", "eflags", "CFI_ADJUST_CFA_OFFSET", "4", "popfl", "CFI_ADJUST_CFA_OFFSET", "-", "4", "jmp", "syscall_exit", "CFI_ENDPROC", "@", "@", "-", "11", ",", "16", "+", "11", ",", "22", "@", "@", "struct", "task_struct", ";", "/", "*", "one", "of", "the", "stranger", "aspects", "of", "C", "forward", "declarations", ".", ".", "*", "/", "extern", "struct", "task_struct", "*", "FASTCALL", "(", "__switch_to", "(", "struct", "task_struct", "*", "prev", ",", "struct", "task_struct", "*", "next", ")", ");", "/", "*", "*", "Saving", "eflags", "is", "important", ".", "It", "switches", "not", "only", "IOPL", "between", "tasks", ",", "*", "it", "also", "protects", "other", "tasks", "from", "NT", "leaking", "through", "sysenter", "etc", ".", "*", "/", "#", "define", "switch_to", "(", "prev", ",", "next", ",", "last", ")", "do", "{", "\\", "unsigned", "long", "esi", ",", "edi", ";", "\\", "asm", "volatile", "(", "\"", "pushl", "%", "%", "ebp", "\\", "n", "\\", "t", "\"", "\\", "asm", "volatile", "(", "\"", "pushfl", "\\", "n", "\\", "t", "\"", "/", "*", "Save", "flags", "*", "/", "\\", "\"", "pushl", "%", "%", "ebp", "\\", "n", "\\", "t", "\"", "\\", "\"", "movl", "%", "%", "esp", ",", "%", "0", "\\", "n", "\\", "t", "\"", "/", "*", "save", "ESP", "*", "/", "\\", "\"", "movl", "%", "5", ",", "%%", "esp", "\\", "n", "\\", "t", "\"", "/", "*", "restore", "ESP", "*", "/", "\\", "\"", "movl", "$", "1f", ",", "%", "1", "\\", "n", "\\", "t", "\"", "/", "*", "save", "EIP", "*", "/", "\\", "\"", "pushl", "%", "6", "\\", "n", "\\", "t", "\"", "/", "*", "restore", "EIP", "*", "/", "\\", "\"", "jmp", "__switch_to", "\\", "n", "\"", "\\", "\"", "1", ":", "\\", "t", "\"", "\\", "\"", "popl", "%", "%", "ebp", "\\", "n", "\\", "t", "\"", "\\", "\"", "popfl", "\"", "\\", ":", "\"=", "m", "\"", "(", "prev", "-", ">", "thread", ".", "esp", ")", ",\"", "=", "m", "\"", "(", "prev", "-", ">", "thread", ".", "eip", ")", ",", "\\", "\"", "=", "a", "\"", "(", "last", ")", ",\"", "=", "S", "\"", "(", "esi", ")", ",\"", "=", "D", "\"", "(", "edi", ")", "\\", ":", "\"", "m", "\"", "(", "next", "-", ">", "thread", ".", "esp", ")", ",\"", "m", "\"", "(", "next", "-", ">", "thread", ".", "eip", ")", ",", "\\"], "docstring_tokens": ["initiating", "a", "specially-crafted", "executable"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "28", ",", "6", "+", "28", ",", "7", "@", "@", "var", "npm", "=", "require", "(", "'.", "./", "lib", "/", "npm", ".", "js", "'", ")", "var", "npmconf", "=", "require", "(", "'.", "./", "lib", "/", "config", "/", "core", ".", "js", "'", ")", "var", "errorHandler", "=", "require", "(", "'.", "./", "lib", "/", "utils", "/", "error", "-", "handler", ".", "js", "'", ")", "var", "replaceInfo", "=", "require", "(", "'.", "./", "lib", "/", "utils", "/", "replace", "-", "info", ".", "js", "'", ")", "var", "configDefs", "=", "npmconf", ".", "defs", "var", "shorthands", "=", "configDefs", ".", "shorthands", "@", "@", "-", "40", ",", "7", "+", "41", ",", "8", "@", "@", "process", ".", "argv", ".", "splice", "(", "1", ",", "1", ",", "'", "npm", "'", ",", "'", "-", "g", "'", ")", "}", "log", ".", "verbose", "(", "'", "cli", "'", ",", "process", ".", "argv", ")", "var", "args", "=", "replaceInfo", "(", "process", ".", "argv", ")", "log", ".", "verbose", "(", "'", "cli", "'", ",", "args", ")", "var", "conf", "=", "nopt", "(", "types", ",", "shorthands", ")", "npm", ".", "argv", "=", "conf", ".", "argv", ".", "remain", "@", "@", "-", "3", ",", "6", "+", "3", ",", "7", "@", "@", "const", "deprCheck", "=", "require", "(", "'.", "/", "utils", "/", "depr", "-", "check", "'", ")", "const", "path", "=", "require", "(", "'", "path", "'", ")", "const", "log", "=", "require", "(", "'", "npmlog", "'", ")", "const", "pacote", "=", "require", "(", "'", "pacote", "'", ")", "const", "readPackageTree", "=", "require", "(", "'", "read", "-", "package", "-", "tree", "'", ")", "const", "rimraf", "=", "require", "(", "'", "rimraf", "'", ")", "const", "validate", "=", "require", "(", "'", "aproba", "'", ")", "@", "@", "-", "11", ",", "15", "+", "12", ",", "17", "@", "@", "const", "npm", "=", "require", "(", "'.", "/", "npm", "'", ")", "let", "npmConfig", "const", "npmlog", "=", "require", "(", "'", "npmlog", "'", ")", "const", "limit", "=", "require", "(", "'", "call", "-", "limit", "'", ")", "const", "tempFilename", "=", "require", "(", "'.", "/", "utils", "/", "temp", "-", "filename", "'", ")", "const", "pacote", "=", "require", "(", "'", "pacote", "'", ")", "const", "tempFilename", "=", "require", "(", "'.", "/", "utils", "/", "temp", "-", "filename", ".", "js", "'", ")", "const", "replaceInfo", "=", "require", "(", "'.", "/", "utils", "/", "replace", "-", "info", ".", "js", "'", ")", "const", "isWindows", "=", "require", "(", "'.", "/", "utils", "/", "is", "-", "windows", ".", "js", "'", ")", "function", "andLogAndFinish", "(", "spec", ",", "tracker", ",", "done", ")", "{", "validate", "(", "'", "SOF", "|", "SZF", "|", "OOF", "|", "OZF", "'", ",", "[", "spec", ",", "tracker", ",", "done", "]", ")", "return", "(", "er", ",", "pkg", ")", "=", ">", "{", "if", "(", "er", ")", "{", "log", ".", "silly", "(", "'", "fetchPackageMetaData", "'", ",", "'", "error", "for", "'", "+", "String", "(", "spec", ")", ",", "er", ".", "message", ")", "er", ".", "message", "=", "replaceInfo", "(", "er", ".", "message", ")", "var", "spc", "=", "replaceInfo", "(", "String", "(", "spec", ")", ")", "log", ".", "silly", "(", "'", "fetchPackageMetaData", "'", ",", "'", "error", "for", "'", "+", "spc", ",", "er", ".", "message", ")", "if", "(", "tracker", ")", "tracker", ".", "finish", "(", ")", "}", "return", "done", "(", "er", ",", "pkg", ")", "@", "@", "-", "12", ",", "6", "+", "12", ",", "7", "@", "@", "var", "exitCode", "=", "0", "var", "rollbacks", "=", "npm", ".", "rollbacks", "var", "chain", "=", "require", "(", "'", "slide", "'", ").", "chain", "var", "errorMessage", "=", "require", "(", "'.", "/", "error", "-", "message", ".", "js", "'", ")", "var", "replaceInfo", "=", "require", "(", "'.", "/", "replace", "-", "info", ".", "js", "'", ")", "var", "stopMetrics", "=", "require", "(", "'.", "/", "metrics", ".", "js", "'", ").", "stop", "const", "cacheFile", "=", "require", "(", "'.", "/", "cache", "-", "file", ".", "js", "'", ")", "@", "@", "-", "175", ",", "14", "+", "176", ",", "16", "@", "@", "function", "errorHandler", "(", "er", ")", "{", "]", ".", "forEach", "(", "function", "(", "k", ")", "{", "var", "v", "=", "er", "[", "k", "]", "if", "(", "!", "v", ")", "return", "v", "=", "replaceInfo", "(", "v", ")", "log", ".", "verbose", "(", "k", ",", "v", ")", "}", ")", "log", ".", "verbose", "(", "'", "cwd", "'", ",", "process", ".", "cwd", "(", "))", "var", "os", "=", "require", "(", "'", "os", "'", ")", "var", "args", "=", "replaceInfo", "(", "process", ".", "argv", ")", "log", ".", "verbose", "(", "''", ",", "os", ".", "type", "(", ")", "+", "'", "'", "+", "os", ".", "release", "(", "))", "log", ".", "verbose", "(", "'", "argv", "'", ",", "process", ".", "argv", ".", "map", "(", "JSON", ".", "stringify", ")", ".", "join", "(", "'", "'", "))", "log", ".", "verbose", "(", "'", "argv", "'", ",", "args", ".", "map", "(", "JSON", ".", "stringify", ")", ".", "join", "(", "'", "'", "))", "log", ".", "verbose", "(", "'", "node", "'", ",", "process", ".", "version", ")", "log", ".", "verbose", "(", "'", "npm", "'", ",", "'", "v", "'", "+", "npm", ".", "version", ")", "@", "@", "-", "3", ",", "12", "+", "3", ",", "17", "@", "@", "var", "npm", "=", "require", "(", "'.", "./", "npm", ".", "js", "'", ")", "var", "util", "=", "require", "(", "'", "util", "'", ")", "var", "nameValidator", "=", "require", "(", "'", "validate", "-", "npm", "-", "package", "-", "name", "'", ")", "var", "npmlog", "=", "require", "(", "'", "npmlog", "'", ")", "var", "replaceInfo", "=", "require", "(", "'.", "/", "replace", "-", "info", ".", "js", "'", ")", "module", ".", "exports", "=", "errorMessage", "function", "errorMessage", "(", "er", ")", "{", "var", "short", "=", "[", "]", "var", "detail", "=", "[", "]", "er", ".", "message", "=", "replaceInfo", "(", "er", ".", "message", ")", "er", ".", "stack", "=", "replaceInfo", "(", "er", ".", "stack", ")", "switch", "(", "er", ".", "code", ")", "{", "case", "'", "ENOAUDIT", "'", ":", "short", ".", "push", "(", "['", "audit", "'", ",", "er", ".", "message", "]", ")", "@", "@", "-", "0", ",", "0", "+", "1", ",", "22", "@", "@", "const", "URL", "=", "require", "(", "'", "url", "'", ")", "/", "/", "replaces", "auth", "info", "in", "an", "array", "/", "/", "of", "arguments", "or", "in", "a", "strings", "function", "replaceInfo", "(", "arg", ")", "{", "const", "isArray", "=", "Array", ".", "isArray", "(", "arg", ")", "const", "isString", "=", "typeof", "arg", "=", "==", "'", "string", "'", "if", "(", "!", "isArray", "&", "&", "!", "isString", ")", "return", "arg", "const", "args", "=", "isString", "?", "arg", ".", "split", "(", "'", "'", ")", ":", "arg", "const", "info", "=", "args", ".", "map", "(", "arg", "=", ">", "{", "try", "{", "const", "url", "=", "new", "URL", "(", "arg", ")", "return", "url", ".", "password", "=", "==", "'", "'", "?", "arg", ":", "arg", ".", "replace", "(", "url", ".", "password", ",", "'", "**", "*'", ")", "}", "catch", "(", "e", ")", "{", "return", "arg", "}", "}", ")", "return", "isString", "?", "info", ".", "join", "(", "'", "'", ")", ":", "info", "}", "module", ".", "exports", "=", "replaceInfo"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "log", "file"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "21", ",", "7", "+", "21", ",", "6", "@", "@", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "OutputStream", ";", "import", "java", ".", "net", ".", "URL", ";", "import", "javax", ".", "servlet", ".", "ServletException", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletRequest", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletResponse", ";", "@", "@", "-", "142", ",", "17", "+", "141", ",", "15", "@", "@", "public", "void", "handle", "(", "String", "target", ",", "Request", "baseRequest", ",", "HttpServletRequest", "reques", "writer", ".", "write", "(", "context", ".", "getContextPath", "(", "))", ";", "if", "(", "context", ".", "getVirtualHosts", "(", ")!", "=", "null", "&", "&", "context", ".", "getVirtualHosts", "(", ").", "length", ">", "0", ")", "writer", ".", "write", "(", "\"&", "nbsp", ";", "@&", "nbsp", ";", "\"+", "context", ".", "getVirtualHosts", "(", ")[", "0", "]", "+\"", ":\"", "+", "request", ".", "getLocalPort", "(", "))", ";", "writer", ".", "write", "(", "\"&", "nbsp", ";", "--", "->", "&", "nbsp", ";", "\")", ";", "writer", ".", "write", "(", "context", ".", "toString", "(", "))", ";", "writer", ".", "write", "(", "\"<", "/", "a", ">", "</", "li", ">", "\\", "n", "\"", ");", "writer", ".", "write", "(", "\"&", "nbsp", ";", "</", "a", ">", "</", "li", ">", "\\", "n", "\"", ");", "}", "else", "{", "writer", ".", "write", "(", "\"<", "li", ">", "\")", ";", "writer", ".", "write", "(", "context", ".", "getContextPath", "(", "))", ";", "if", "(", "context", ".", "getVirtualHosts", "(", ")!", "=", "null", "&", "&", "context", ".", "getVirtualHosts", "(", ").", "length", ">", "0", ")", "writer", ".", "write", "(", "\"&", "nbsp", ";", "@&", "nbsp", ";", "\"+", "context", ".", "getVirtualHosts", "(", ")[", "0", "]", "+\"", ":\"", "+", "request", ".", "getLocalPort", "(", "))", ";", "writer", ".", "write", "(", "\"&", "nbsp", ";", "--", "->", "&", "nbsp", ";", "\")", ";", "writer", ".", "write", "(", "\"&", "nbsp", ";", "\")", ";", "writer", ".", "write", "(", "context", ".", "toString", "(", "))", ";", "if", "(", "context", ".", "isFailed", "(", "))", "writer", ".", "write", "(", "\"", "[", "failed", "]", "\")", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "101", "@", "@", "/", "/", "/", "/", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "/", "/", "Copyright", "(", "c", ")", "1995", "-", "2018", "Mort", "Bay", "Consulting", "Pty", ".", "Ltd", ".", "/", "/", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "-", "/", "/", "All", "rights", "reserved", ".", "This", "program", "and", "the", "accompanying", "materials", "/", "/", "are", "made", "available", "under", "the", "terms", "of", "the", "Eclipse", "Public", "License", "v1", ".", "0", "/", "/", "and", "Apache", "License", "v2", ".", "0", "which", "accompanies", "this", "distribution", ".", "/", "/", "/", "/", "The", "Eclipse", "Public", "License", "is", "available", "at", "/", "/", "http", ":", "//", "www", ".", "eclipse", ".", "org", "/", "legal", "/", "epl", "-", "v10", ".", "html", "/", "/", "/", "/", "The", "Apache", "License", "v2", ".", "0", "is", "available", "at", "/", "/", "http", ":", "//", "www", ".", "opensource", ".", "org", "/", "licenses", "/", "apache2", ".", "0", ".", "php", "/", "/", "/", "/", "You", "may", "elect", "to", "redistribute", "this", "code", "under", "either", "of", "these", "licenses", ".", "/", "/", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "/", "/", "package", "org", ".", "eclipse", ".", "jetty", ".", "servlet", ";", "import", "java", ".", "io", ".", "File", ";", "import", "org", ".", "eclipse", ".", "jetty", ".", "server", ".", "LocalConnector", ";", "import", "org", ".", "eclipse", ".", "jetty", ".", "server", ".", "Server", ";", "import", "org", ".", "eclipse", ".", "jetty", ".", "server", ".", "handler", ".", "DefaultHandler", ";", "import", "org", ".", "eclipse", ".", "jetty", ".", "server", ".", "handler", ".", "HandlerList", ";", "import", "org", ".", "eclipse", ".", "jetty", ".", "toolchain", ".", "test", ".", "FS", ";", "import", "org", ".", "eclipse", ".", "jetty", ".", "toolchain", ".", "test", ".", "MavenTestingUtils", ";", "import", "org", ".", "eclipse", ".", "jetty", ".", "util", ".", "resource", ".", "PathResource", ";", "import", "org", ".", "junit", ".", "After", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "static", "org", ".", "hamcrest", ".", "MatcherAssert", ".", "assertThat", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "containsString", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "not", ";", "public", "class", "DefaultHandlerTest", "{", "private", "Server", "server", ";", "private", "LocalConnector", "localConnector", ";", "private", "File", "baseA", ";", "private", "File", "baseFoo", ";", "@", "Before", "public", "void", "startServer", "(", ")", "throws", "Exception", "{", "server", "=", "new", "Server", "(", ");", "localConnector", "=", "new", "LocalConnector", "(", "server", ")", ";", "server", ".", "addConnector", "(", "localConnector", ")", ";", "File", "docRoot", "=", "MavenTestingUtils", ".", "getTargetTestingDir", "(", "DefaultHandlerTest", ".", "class", ".", "getName", "(", "))", ";", "FS", ".", "ensureDirExists", "(", "docRoot", ")", ";", "baseA", "=", "new", "File", "(", "docRoot", ",", "\"", "baseA", "\"", ");", "FS", ".", "ensureDirExists", "(", "baseA", ")", ";", "baseFoo", "=", "new", "File", "(", "docRoot", ",", "\"", "baseFoo", "\"", ");", "FS", ".", "ensureDirExists", "(", "baseFoo", ")", ";", "ServletContextHandler", "contextA", "=", "new", "ServletContextHandler", "(", ");", "contextA", ".", "setContextPath", "(", "\"/", "a", "\"", ");", "contextA", ".", "setBaseResource", "(", "new", "PathResource", "(", "baseA", ")", ");", "ServletContextHandler", "contextFoo", "=", "new", "ServletContextHandler", "(", ");", "contextFoo", ".", "setContextPath", "(", "\"/", "foo", "\"", ");", "contextFoo", ".", "setBaseResource", "(", "new", "PathResource", "(", "baseFoo", ")", ");", "HandlerList", "handlers", "=", "new", "HandlerList", "(", ");", "handlers", ".", "addHandler", "(", "contextA", ")", ";", "handlers", ".", "addHandler", "(", "contextFoo", ")", ";", "handlers", ".", "addHandler", "(", "new", "DefaultHandler", "(", "))", ";", "server", ".", "setHandler", "(", "handlers", ")", ";", "server", ".", "start", "(", ");", "}", "@", "After", "public", "void", "stopServer", "(", ")", "throws", "Exception", "{", "server", ".", "stop", "(", ");", "}", "@", "Test", "public", "void", "testNotRevealBaseResource", "(", ")", "throws", "Exception", "{", "StringBuilder", "req", "=", "new", "StringBuilder", "(", ");", "req", ".", "append", "(", "\"", "GET", "/", "HTTP", "/", "1", ".", "0", "\\", "r", "\\", "n", "\"", ");", "req", ".", "append", "(", "\"\\", "r", "\\", "n", "\"", ");", "String", "rawResponse", "=", "localConnector", ".", "getResponses", "(", "req", ".", "toString", "(", "))", ";", "assertThat", "(", "rawResponse", ",", "containsString", "(", "\"", "404", "Not", "Found", "\"", "))", ";", "assertThat", "(", "rawResponse", ",", "containsString", "(", "\"", "No", "context", "on", "this", "server", "matched", "or", "handled", "this", "request", "\"", "))", ";", "assertThat", "(", "rawResponse", ",", "containsString", "(", "\"", "Contexts", "known", "to", "this", "server", "are", "\"", "))", ";", "assertThat", "(", "rawResponse", ",", "containsString", "(", "\"<", "a", "href", "=", "\\\"", "/", "a", "\\", "\">", "\")", ");", "assertThat", "(", "rawResponse", ",", "containsString", "(", "\"<", "a", "href", "=", "\\\"", "/", "foo", "\\", "\">", "\")", ");", "assertThat", "(", "rawResponse", ",", "not", "(", "containsString", "(", "baseA", ".", "toString", "(", "))", "))", ";", "assertThat", "(", "rawResponse", ",", "not", "(", "containsString", "(", "baseFoo", ".", "toString", "(", "))", "))", ";", "}", "}"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "3842", ",", "6", "+", "3842", ",", "15", "@", "@", "static", "int", "ext4_fill_super", "(", "struct", "super_block", "*", "sb", ",", "void", "*", "data", ",", "int", "silent", ")", "(", "EXT4_MAX_BLOCK_FILE_PHYS", "/", "EXT4_BLOCKS_PER_GROUP", "(", "sb", ")", "))", ";", "db_count", "=", "(", "sbi", "-", ">", "s_groups_count", "+", "EXT4_DESC_PER_BLOCK", "(", "sb", ")", "-", "1", ")", "/", "EXT4_DESC_PER_BLOCK", "(", "sb", ")", ";", "if", "(", "ext4_has_feature_meta_bg", "(", "sb", ")", ")", "{", "if", "(", "le32_to_cpu", "(", "es", "-", ">", "s_first_meta_bg", ")", ">", "=", "db_count", ")", "{", "ext4_msg", "(", "sb", ",", "KERN_WARNING", ",", "\"", "first", "meta", "block", "group", "too", "large", ":", "%", "u", "\"", "\"", "(", "group", "descriptor", "block", "count", "%", "u", ")", "\",", "le32_to_cpu", "(", "es", "-", ">", "s_first_meta_bg", ")", ",", "db_count", ")", ";", "goto", "failed_mount", ";", "}", "}", "sbi", "-", ">", "s_group_desc", "=", "ext4_kvmalloc", "(", "db_count", "*", "sizeof", "(", "struct", "buffer_head", "*", "),", "GFP_KERNEL", ")", ";"], "docstring_tokens": ["via", "a", "crafted", "ext4", "image", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "17", ",", "15", "+", "17", ",", "21", "@", "@", "package", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "engine", ";", "import", "java", ".", "lang", ".", "annotation", ".", "ElementType", ";", "import", "java", ".", "lang", ".", "reflect", ".", "AccessibleObject", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Constructor", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Field", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Member", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Type", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ConcurrentMap", ";", "import", "javax", ".", "validation", ".", "ConstraintValidatorFactory", ";", "import", "javax", ".", "validation", ".", "ConstraintViolation", ";", "@", "@", "-", "58", ",", "12", "+", "64", ",", "17", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "facets", ".", "Cascadable", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "facets", ".", "Validatable", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ".", "ExecutableElement", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ConcurrentReferenceHashMap", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ConcurrentReferenceHashMap", ".", "ReferenceType", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "Contracts", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "TypeHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "TypeResolutionHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredField", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "GetDeclaredMethod", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "SetAccessibility", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "spi", ".", "valuehandling", ".", "ValidatedValueUnwrapper", ";", "import", "com", ".", "fasterxml", ".", "classmate", ".", "ResolvedType", ";", "@", "@", "-", "142", ",", "6", "+", "153", ",", "11", "@", "@", "*", "/", "private", "final", "List", "<", "ValidatedValueUnwrapper", "<", "?>", ">", "validatedValueHandlers", ";", "/", "**", "*", "Keeps", "an", "accessible", "version", "for", "each", "non", "-", "accessible", "member", "whose", "value", "needs", "to", "be", "accessed", "during", "validation", ".", "*", "/", "private", "final", "ConcurrentMap", "<", "Member", ",", "Member", ">", "accessibleMembers", ";", "public", "ValidatorImpl", "(", "ConstraintValidatorFactory", "constraintValidatorFactory", ",", "MessageInterpolator", "messageInterpolator", ",", "TraversableResolver", "traversableResolver", ",", "@", "@", "-", "162", ",", "6", "+", "178", ",", "12", "@", "@", "public", "ValidatorImpl", "(", "ConstraintValidatorFactory", "constraintValidatorFactory", ",", "this", ".", "failFast", "=", "failFast", ";", "validationOrderGenerator", "=", "new", "ValidationOrderGenerator", "(", ");", "this", ".", "accessibleMembers", "=", "new", "ConcurrentReferenceHashMap", "<", "Member", ",", "Member", ">", "(", "100", ",", "ReferenceType", ".", "SOFT", ",", "ReferenceType", ".", "SOFT", ")", ";", "}", "@", "Override", "@", "@", "-", "519", ",", "7", "+", "541", ",", "7", "@", "@", "private", "boolean", "validateConstraint", "(", "ValidationContext", "<", "?>", "validationContext", ",", "if", "(", "isValidationRequired", "(", "validationContext", ",", "valueContext", ",", "metaConstraint", ")", ")", "{", "if", "(", "valueContext", ".", "getCurrentBean", "(", ")", "!", "=", "null", ")", "{", "Object", "valueToValidate", "=", "metaConstraint", ".", "getValue", "(", "valueContext", ".", "getCurrentBean", "(", ")", ")", ";", "Object", "valueToValidate", "=", "getValue", "(", "metaConstraint", ".", "getLocation", "(", ").", "getMember", "(", "),", "valueContext", ".", "getCurrentBean", "(", ")", ")", ";", "valueContext", ".", "setCurrentValidatedValue", "(", "valueToValidate", ")", ";", "}", "validationSuccessful", "=", "metaConstraint", ".", "validateConstraint", "(", "validationContext", ",", "valueContext", ")", ";", "@", "@", "-", "552", ",", "9", "+", "574", ",", "8", "@", "@", "private", "void", "validateCascadedConstraints", "(", "ValidationContext", "<", "?>", "validationContext", ",", "valueContext", ".", "getPropertyPath", "(", "),", "elementType", ")", ")", "{", "Object", "value", "=", "cascadable", ".", "getValue", "(", "valueContext", ".", "getCurrentBean", "(", ")", ")", ";", "Object", "value", "=", "getValue", "(", "valueContext", ".", "getCurrentBean", "(", "),", "cascadable", ")", ";", "/", "/", "Value", "can", "be", "wrapped", "(", "e", ".", "g", ".", "Optional", "<", "Address", ">", ").", "Try", "to", "unwrap", "it", "ConstraintMetaData", "metaData", "=", "(", "ConstraintMetaData", ")", "cascadable", ";", "@", "@", "-", "1302", ",", "9", "+", "1323", ",", "7", "@", "@", "else", "if", "(", "!", "propertyIter", ".", "hasNext", "(", ")", ")", "{", "else", "{", "if", "(", "property", ".", "isCascading", "(", ")", ")", "{", "Type", "type", "=", "property", ".", "getType", "(", ");", "newValue", "=", "newValue", "=", "=", "null", "?", "null", ":", "property", ".", "getValue", "(", "newValue", ")", ";", "newValue", "=", "newValue", "=", "=", "null", "?", "null", ":", "getValue", "(", "newValue", ",", "property", ")", ";", "if", "(", "elem", ".", "isIterable", "(", ")", ")", "{", "if", "(", "newValue", "!", "=", "null", "&", "&", "elem", ".", "getIndex", "(", ")", "!", "=", "null", ")", "{", "newValue", "=", "ReflectionHelper", ".", "getIndexedValue", "(", "newValue", ",", "elem", ".", "getIndex", "(", ")", ")", ";", "@", "@", "-", "1483", ",", "4", "+", "1502", ",", "78", "@", "@", "private", "boolean", "shouldFailFast", "(", "ValidationContext", "<", "?>", "context", ")", "{", "valueContext", ".", "setValidatedValueHandler", "(", "handler", ")", ";", "}", "}", "private", "Object", "getValue", "(", "Object", "object", ",", "Cascadable", "cascadable", ")", "{", "if", "(", "cascadable", "instanceof", "PropertyMetaData", ")", "{", "Member", "member", "=", "getAccessible", "(", "(", "(", "PropertyMetaData", ")", "cascadable", ")", ".", "getCascadingMember", "(", ")", ")", ";", "return", "getValue", "(", "member", ",", "object", ")", ";", "}", "else", "if", "(", "cascadable", "instanceof", "ParameterMetaData", ")", "{", "return", "(", "(", "Object", "[", "])", "object", ")", "[(", "(", "ParameterMetaData", ")", "cascadable", ")", ".", "getIndex", "(", ")]", ";", "}", "else", "{", "return", "object", ";", "}", "}", "private", "Object", "getValue", "(", "Member", "member", ",", "Object", "object", ")", "{", "if", "(", "member", "=", "=", "null", ")", "{", "return", "object", ";", "}", "member", "=", "getAccessible", "(", "member", ")", ";", "if", "(", "member", "instanceof", "Method", ")", "{", "return", "ReflectionHelper", ".", "getValue", "(", "(", "Method", ")", "member", ",", "object", ")", ";", "}", "else", "if", "(", "member", "instanceof", "Field", ")", "{", "return", "ReflectionHelper", ".", "getValue", "(", "(", "Field", ")", "member", ",", "object", ")", ";", "}", "return", "null", ";", "}", "/", "**", "*", "Returns", "an", "accessible", "version", "of", "the", "given", "member", ".", "Will", "be", "the", "given", "member", "itself", "in", "case", "it", "is", "accessible", ",", "*", "otherwise", "a", "copy", "which", "is", "set", "accessible", ".", "These", "copies", "are", "maintained", "in", "the", "*", "{", "@", "link", "ValidatorImpl", "#", "accessibleMembers", "}", "cache", ".", "*", "/", "private", "Member", "getAccessible", "(", "Member", "original", ")", "{", "if", "(", "(", "(", "AccessibleObject", ")", "original", ")", ".", "isAccessible", "(", ")", ")", "{", "return", "original", ";", "}", "Member", "member", "=", "accessibleMembers", ".", "get", "(", "original", ")", ";", "if", "(", "member", "!", "=", "null", ")", "{", "return", "member", ";", "}", "Class", "<", "?>", "clazz", "=", "original", ".", "getDeclaringClass", "(", ");", "if", "(", "original", "instanceof", "Field", ")", "{", "member", "=", "run", "(", "GetDeclaredField", ".", "action", "(", "clazz", ",", "original", ".", "getName", "(", ")", ")", ")", ";", "}", "else", "{", "member", "=", "run", "(", "GetDeclaredMethod", ".", "action", "(", "clazz", ",", "original", ".", "getName", "(", ")", ")", ")", ";", "}", "run", "(", "SetAccessibility", ".", "action", "(", "member", ")", ")", ";", "Member", "cached", "=", "accessibleMembers", ".", "putIfAbsent", "(", "original", ",", "member", ")", ";", "if", "(", "cached", "!", "=", "null", ")", "{", "member", "=", "cached", ";", "}", "return", "member", ";", "}", "/", "**", "*", "Runs", "the", "given", "privileged", "action", ",", "using", "a", "privileged", "block", "if", "required", ".", "*", "<", "p", ">", "*", "<", "b", ">", "NOTE", ":", "</", "b", ">", "This", "must", "never", "be", "changed", "into", "a", "publicly", "available", "method", "to", "avoid", "execution", "of", "arbitrary", "*", "privileged", "actions", "within", "HV", "'", "s", "protection", "domain", ".", "*", "/", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "99", ",", "7", "+", "99", ",", "7", "@", "@", "private", "void", "detectJPA", "(", ")", "{", "/", "/", "unfortunately", "there", "are", "several", "incomplete", "implementations", "out", "there", "(", "see", "HV", "-", "374", ")", "try", "{", "Object", "persistence", "=", "run", "(", "NewInstance", ".", "action", "(", "persistenceClass", ",", "\"", "persistence", "provider", "\"", ")", ")", ";", "ReflectionHelper", ".", "getValue", "(", "persistenceUtilGetter", ",", "persistence", ")", ";", "ReflectionHelper", ".", "getValue", "(", "persistenceUtilGetter", ",", "persistence", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "log", ".", "debugf", "(", "@", "@", "-", "88", ",", "11", "+", "88", ",", "6", "@", "@", "public", "ElementType", "getElementType", "(", ")", "{", "return", "ElementType", ".", "PARAMETER", ";", "}", "@", "Override", "public", "Object", "getValue", "(", "Object", "parent", ")", "{", "return", "(", "(", "Object", "[", "])", "parent", ")", "[", "index", "]", ";", "}", "@", "Override", "public", "ParameterDescriptor", "asDescriptor", "(", "boolean", "defaultGroupSequenceRedefined", ",", "List", "<", "Class", "<", "?>", ">", "defaultGroupSequence", ")", "{", "return", "new", "ParameterDescriptorImpl", "(", "@", "@", "-", "24", ",", "6", "+", "24", ",", "7", "@", "@", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "javax", ".", "validation", ".", "ElementKind", ";", "import", "javax", ".", "validation", ".", "metadata", ".", "GroupConversionDescriptor", ";", "@", "@", "-", "94", ",", "9", "+", "95", ",", "8", "@", "@", "private", "PropertyMetaData", "(", "String", "propertyName", ",", "this", ".", "groupConversionHelper", ".", "validateGroupConversions", "(", "isCascading", "(", "),", "this", ".", "toString", "(", ")", ")", ";", "}", "@", "Override", "public", "Object", "getValue", "(", "Object", "parent", ")", "{", "return", "ReflectionHelper", ".", "getValue", "(", "cascadingMember", ",", "parent", ")", ";", "public", "Member", "getCascadingMember", "(", ")", "{", "return", "cascadingMember", ";", "}", "@", "Override", "@", "@", "-", "86", ",", "11", "+", "86", ",", "6", "@", "@", "public", "ElementType", "getElementType", "(", ")", "{", "return", "ElementType", ".", "METHOD", ";", "}", "@", "Override", "public", "Object", "getValue", "(", "Object", "parent", ")", "{", "return", "parent", ";", "}", "@", "Override", "public", "ReturnValueDescriptor", "asDescriptor", "(", "boolean", "defaultGroupSequenceRedefined", ",", "List", "<", "Class", "<", "?>", ">", "defaultGroupSequence", ")", "{", "return", "new", "ReturnValueDescriptorImpl", "(", "@", "@", "-", "25", ",", "7", "+", "25", ",", "6", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "engine", ".", "constraintvalidation", ".", "ConstraintTree", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "descriptor", ".", "ConstraintDescriptorImpl", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "location", ".", "ConstraintLocation", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ReflectionHelper", ";", "/", "**", "*", "Instances", "of", "this", "class", "abstract", "the", "constraint", "type", "(", "class", ",", "method", "or", "field", "constraint", ")", "and", "give", "access", "to", "@", "@", "-", "91", ",", "21", "+", "90", ",", "6", "@", "@", "public", "ConstraintLocation", "getLocation", "(", ")", "{", "return", "location", ";", "}", "/", "**", "*", "@", "param", "o", "the", "object", "from", "which", "to", "retrieve", "the", "value", ".", "*", "*", "@", "return", "Returns", "the", "value", "for", "this", "constraint", "from", "the", "specified", "object", ".", "Depending", "on", "the", "type", "either", "the", "value", "itself", "*", "is", "returned", "of", "method", "or", "field", "access", "is", "used", "to", "access", "the", "value", ".", "*", "/", "public", "Object", "getValue", "(", "Object", "o", ")", "{", "if", "(", "location", ".", "getMember", "(", ")", "=", "=", "null", ")", "{", "return", "o", ";", "}", "else", "{", "return", "ReflectionHelper", ".", "getValue", "(", "location", ".", "getMember", "(", "),", "o", ")", ";", "}", "}", "@", "Override", "public", "boolean", "equals", "(", "Object", "o", ")", "{", "if", "(", "this", "=", "=", "o", ")", "{", "@", "@", "-", "54", ",", "15", "+", "54", ",", "6", "@", "@", "ElementType", "getElementType", "(", ");", "/", "**", "*", "Retrieves", "the", "value", "of", "this", "element", "from", "the", "given", "object", ".", "*", "*", "@", "param", "parent", "The", "object", "to", "retrieve", "the", "value", "from", ".", "*", "*", "@", "return", "This", "element", "'", "s", "value", ".", "*", "/", "Object", "getValue", "(", "Object", "parent", ")", ";", "/", "**", "*", "Returns", "the", "name", "of", "this", "cascadable", "element", ".", "*", "@", "@", "-", "18", ",", "8", "+", "18", ",", "6", "@", "@", "import", "java", ".", "lang", ".", "reflect", ".", "Constructor", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "@", "@", "-", "31", ",", "7", "+", "29", ",", "6", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "location", ".", "ConstraintLocation", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "SetAccessibility", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newArrayList", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashMap", ";", "@", "@", "-", "143", ",", "10", "+", "140", ",", "6", "@", "@", "public", "ConstrainedExecutable", "(", "this", ".", "crossParameterConstraints", "=", "crossParameterConstraints", ";", "this", ".", "parameterMetaData", "=", "Collections", ".", "unmodifiableList", "(", "parameterMetaData", ")", ";", "this", ".", "hasParameterConstraints", "=", "hasParameterConstraints", "(", "parameterMetaData", ")", "|", "|", "!", "crossParameterConstraints", ".", "isEmpty", "(", ");", "if", "(", "isConstrained", "(", ")", ")", "{", "run", "(", "SetAccessibility", ".", "action", "(", "location", ".", "getMember", "(", ")", ")", ")", ";", "}", "}", "/", "**", "@", "@", "-", "353", ",", "8", "+", "346", ",", "4", "@", "@", "else", "if", "(", "!", "executable", ".", "equals", "(", "other", ".", "executable", ")", ")", "{", "}", "return", "true", ";", "}", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}", "@", "@", "-", "16", ",", "15", "+", "16", ",", "11", "@", "@", "*", "/", "package", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Member", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "core", ".", "MetaConstraint", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "location", ".", "ConstraintLocation", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "SetAccessibility", ";", "/", "**", "*", "Represents", "a", "field", "of", "a", "Java", "type", "and", "all", "its", "associated", "meta", "-", "data", "relevant", "@", "@", "-", "53", ",", "11", "+", "49", ",", "6", "@", "@", "public", "ConstrainedField", "(", "ConfigurationSource", "source", ",", "boolean", "requiresUnwrapping", ")", "{", "super", "(", "source", ",", "ConstrainedElementKind", ".", "FIELD", ",", "location", ",", "constraints", ",", "groupConversions", ",", "isCascading", ",", "requiresUnwrapping", ")", ";", "Member", "member", "=", "location", ".", "getMember", "(", ");", "if", "(", "member", "!", "=", "null", "&", "&", "isConstrained", "(", ")", ")", "{", "run", "(", "SetAccessibility", ".", "action", "(", "member", ")", ")", ";", "}", "}", "@", "Override", "@", "@", "-", "90", ",", "8", "+", "81", ",", "4", "@", "@", "else", "if", "(", "!", "getLocation", "(", ").", "getMember", "(", ").", "equals", "(", "other", ".", "getLocation", "(", ").", "getMember", "(", ")", ")", ")", "}", "return", "true", ";", "}", "private", "<", "T", ">", "T", "run", "(", "PrivilegedAction", "<", "T", ">", "action", ")", "{", "return", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", "?", "AccessController", ".", "doPrivileged", "(", "action", ")", ":", "action", ".", "run", "(", ");", "}", "}"], "docstring_tokens": ["via", "a", "crafted", "application", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "198", ",", "6", "+", "198", ",", "8", "@", "@", "Bug", "Fixes", "scheduled", "triggers", "not", "be", "used", "for", "very", "frequent", "operations", "to", "avoid", "this", "problem", ".", "(", "ab", ",", "shalin", ")", "*", "SOLR", "-", "12514", ":", "Rule", "-", "base", "Authorization", "plugin", "skips", "authorization", "if", "querying", "node", "does", "not", "have", "collection", "replica", "(", "noble", ")", "Improvements", "@", "@", "-", "496", ",", "6", "+", "496", ",", "7", "@", "@", "public", "Action", "call", "(", ")", "throws", "IOException", "{", "handleAdminRequest", "(", ");", "return", "RETURN", ";", "case", "REMOTEQUERY", ":", "SolrRequestInfo", ".", "setRequestInfo", "(", "new", "SolrRequestInfo", "(", "solrReq", ",", "new", "SolrQueryResponse", "(", "))", ");", "remoteQuery", "(", "coreUrl", "+", "path", ",", "resp", ")", ";", "return", "RETURN", ";", "case", "PROCESS", ":", "@", "@", "-", "312", ",", "6", "+", "312", ",", "7", "@", "@", "public", "void", "testProxyNullProxyUser", "(", ")", "throws", "Exception", "{", "}", "@", "Test", "@", "AwaitsFix", "(", "bugUrl", "=", "\"", "https", ":", "//", "issues", ".", "apache", ".", "org", "/", "jira", "/", "browse", "/", "SOLR", "-", "13098", "\"", ")", "public", "void", "testForwarding", "(", ")", "throws", "Exception", "{", "String", "collectionName", "=", "\"", "forwardingCollection", "\"", ";", "miniCluster", ".", "uploadConfigSet", "(", "TEST_PATH", "(", ").", "resolve", "(", "\"", "collection1", "/", "conf", "\"", "),", "\"", "conf1", "\"", ");", "@", "@", "-", "100", ",", "7", "+", "100", ",", "7", "@", "@", "public", "void", "tearDownCluster", "(", ")", "throws", "Exception", "{", "@", "Test", "/", "/", "commented", "9", "-", "Aug", "-", "2018", "@", "BadApple", "(", "bugUrl", "=", "\"", "https", ":", "//", "issues", ".", "apache", ".", "org", "/", "jira", "/", "browse", "/", "SOLR", "-", "12028", "\"", ")", "/", "/", "21", "-", "May", "-", "2018", "@", "BadApple", "(", "bugUrl", "=", "\"", "https", ":", "//", "issues", ".", "apache", ".", "org", "/", "jira", "/", "browse", "/", "SOLR", "-", "12028", "\"", ")", "/", "/", "annotated", "on", ":", "24", "-", "Dec", "-", "2018", "/", "/", "@", "BadApple", "(", "bugUrl", "=", "\"", "https", ":", "//", "issues", ".", "apache", ".", "org", "/", "jira", "/", "browse", "/", "SOLR", "-", "12028", "\"", ")", "/", "/", "annotated", "on", ":", "24", "-", "Dec", "-", "2018", "public", "void", "testBasicAuth", "(", ")", "throws", "Exception", "{", "boolean", "isUseV2Api", "=", "random", "(", ").", "nextBoolean", "(", ");", "String", "authcPrefix", "=", "\"", "/", "admin", "/", "authentication", "\"", ";", "@", "@", "-", "239", ",", "6", "+", "239", ",", "19", "@", "@", "public", "void", "testBasicAuth", "(", ")", "throws", "Exception", "{", "del", ".", "setCommitWithin", "(", "10", ")", ";", "del", ".", "process", "(", "cluster", ".", "getSolrClient", "(", "),", "COLLECTION", ")", ";", "/", "/", "Test", "for", "SOLR", "-", "12514", ".", "Create", "a", "new", "jetty", ".", "This", "jetty", "does", "not", "have", "the", "collection", ".", "/", "/", "Make", "a", "request", "to", "that", "jetty", "and", "it", "should", "fail", "JettySolrRunner", "aNewJetty", "=", "cluster", ".", "startJettySolrRunner", "(", ");", "try", "{", "del", "=", "new", "UpdateRequest", "(", ").", "deleteByQuery", "(", "\"*", ":*", "\")", ";", "del", ".", "process", "(", "aNewJetty", ".", "newClient", "(", "),", "COLLECTION", ")", ";", "fail", "(", "\"", "This", "should", "not", "have", "succeeded", "without", "credentials", "\"", ");", "}", "catch", "(", "HttpSolrClient", ".", "RemoteSolrException", "e", ")", "{", "assertTrue", "(", "e", ".", "getMessage", "(", ").", "contains", "(", "\"", "Unauthorized", "request", "\"", "))", ";", "}", "finally", "{", "cluster", ".", "stopJettySolrRunner", "(", "aNewJetty", ")", ";", "}", "addDocument", "(", "\"", "harry", "\"", ",\"", "HarryIsUberCool", "\"", ",\"", "id", "\"", ",", "\"", "4", "\"", ");", "executeCommand", "(", "baseUrl", "+", "authcPrefix", ",", "cl", ",", "\"", "{", "set", "-", "property", ":", "{", "blockUnknown", ":", "true", "}", "}\"", ",", "\"", "harry", "\"", ",", "\"", "HarryIsUberCool", "\"", ");"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "168", ",", "6", "+", "168", ",", "13", "@", "@", "Library", "and", "Framework", "Specific", ":", "with", "@", "ngInject", "(", "default", ":", "false", ")", "-", "-", "dart_pass", ":", "Rewrite", "Dart", "Dev", "Compiler", "output", "to", "be", "compiler", "-", "friendly", ".", "(", "default", ":", "false", ")", "-", "-", "force_inject_library", "VAL", ":", "Force", "injection", "of", "named", "runtime", "libraries", ".", "The", "format", "is", "<", "name", ">", "where", "<", "name", ">", "is", "the", "name", "of", "a", "runtime", "library", ".", "Possible", "libraries", "include", ":", "base", ",", "es6_runtime", ",", "runtime_type_check", "-", "-", "inject_libraries", ":", "Allow", "injecting", "runtime", "libraries", ".", "(", "default", ":", "true", ")", "-", "-", "polymer_pass", ":", "Equivalent", "to", "-", "-", "polymer_version", "=", "1", "(", "default", ":", "false", ")", "-", "-", "process_closure_primitives", ":", "Processes", "built", "-", "ins", "from", "the", "Closure", "@", "@", "-", "1", ",", "5", "+", "1", ",", "5", "@", "@", "{", "\"", "compiler_url", "\"", ":", "\"", "http", ":", "//", "dl", ".", "google", ".", "com", "/", "closure", "-", "compiler", "/", "compiler", "-", "20170218", ".", "zip", "\"", ",", "\"", "library_url", "\"", ":", "\"", "https", ":", "//", "github", ".", "com", "/", "google", "/", "closure", "-", "library", "/", "archive", "/", "v20170218", ".", "zip", "\"", ",", "\"", "compiler_url", "\"", ":", "\"", "https", ":", "//", "dl", ".", "google", ".", "com", "/", "closure", "-", "compiler", "/", "compiler", "-", "20170409", ".", "zip", "\"", ",", "\"", "library_url", "\"", ":", "\"", "https", ":", "//", "github", ".", "com", "/", "google", "/", "closure", "-", "library", "/", "archive", "/", "v20170409", ".", "zip", "\"", ",", "\"", "log_level", "\"", ":", "\"", "info", "\"", "}"], "docstring_tokens": ["by", "swapping", "out", "the", "requested", "binary", "with", "an", "attacker", "controlled", "binary", "if", "the", "attacker", "is", "on", "the", "network", "or", "positioned", "in", "between", "the", "user", "and", "the", "remote", "server", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "86", ",", "6", "+", "86", ",", "7", "@", "@", "private", "final", "IAdvancedFSOps", "fsOps", ";", "private", "final", "String", "user", ";", "private", "final", "Map", "<", "String", ",", "Object", ">", "conf", ";", "private", "final", "boolean", "symLinksDisabled", ";", "/", "/", "size", "of", "the", "resource", "private", "long", "size", "=", "-", "1", ";", "@", "@", "-", "95", ",", "6", "+", "96", ",", "7", "@", "@", "Path", "base", "=", "getLocalUserFileCacheDir", "(", "localBaseDir", ",", "user", ")", ";", "this", ".", "baseDir", "=", "uncompressed", "?", "getCacheDirForArchives", "(", "base", ")", ":", "getCacheDirForFiles", "(", "base", ")", ";", "this", ".", "conf", "=", "conf", ";", "this", ".", "symLinksDisabled", "=", "(", "boolean", ")", "conf", ".", "getOrDefault", "(", "Config", ".", "DISABLE_SYMLINKS", ",", "false", ")", ";", "this", ".", "user", "=", "user", ";", "this", ".", "fsOps", "=", "fsOps", ";", "versionFilePath", "=", "constructVersionFileName", "(", "baseDir", ",", "key", ")", ";", "@", "@", "-", "273", ",", "7", "+", "275", ",", "7", "@", "@", "public", "long", "downloadToTempLocation", "(", "ClientBlobStore", "store", ")", "throws", "IOException", ",", "Ke", "}", "}", "if", "(", "uncompressed", ")", "{", "ServerUtils", ".", "unpack", "(", "downloadFile", ".", "toFile", "(", "),", "finalLocation", ".", "toFile", "(", "))", ";", "ServerUtils", ".", "unpack", "(", "downloadFile", ".", "toFile", "(", "),", "finalLocation", ".", "toFile", "(", "),", "symLinksDisabled", ")", ";", "LOG", ".", "debug", "(", "\"", "Uncompressed", "{", "}", "to", ":", "{", "}\"", ",", "downloadFile", ",", "finalLocation", ")", ";", "}", "setBlobPermissions", "(", "conf", ",", "user", ",", "finalLocation", ")", ";", "@", "@", "-", "32", ",", "14", "+", "32", ",", "19", "@", "@", "import", "java", ".", "io", ".", "RandomAccessFile", ";", "import", "java", ".", "nio", ".", "file", ".", "FileSystems", ";", "import", "java", ".", "nio", ".", "file", ".", "Files", ";", "import", "java", ".", "nio", ".", "file", ".", "LinkOption", ";", "import", "java", ".", "nio", ".", "file", ".", "Path", ";", "import", "java", ".", "nio", ".", "file", ".", "Paths", ";", "import", "java", ".", "nio", ".", "file", ".", "attribute", ".", "PosixFilePermission", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Enumeration", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "jar", ".", "JarEntry", ";", "import", "java", ".", "util", ".", "jar", ".", "JarFile", ";", "import", "java", ".", "util", ".", "zip", ".", "GZIPInputStream", ";", "@", "@", "-", "378", ",", "52", "+", "383", ",", "9", "@", "@", "public", "static", "boolean", "canUserReadBlob", "(", "ReadableBlobMeta", "meta", ",", "String", "user", ",", "Map", "<", "St", "*", "@", "param", "jarFile", "the", ".", "jar", "file", "to", "unpack", "*", "@", "param", "toDir", "the", "destination", "directory", "into", "which", "to", "unpack", "the", "jar", "*", "/", "public", "static", "void", "unJar", "(", "File", "jarFile", ",", "File", "toDir", ")", "throws", "IOException", "{", "JarFile", "jar", "=", "new", "JarFile", "(", "jarFile", ")", ";", "try", "{", "Enumeration", "<", "JarEntry", ">", "entries", "=", "jar", ".", "entries", "(", ");", "while", "(", "entries", ".", "hasMoreElements", "(", "))", "{", "final", "JarEntry", "entry", "=", "entries", ".", "nextElement", "(", ");", "if", "(", "!", "entry", ".", "isDirectory", "(", "))", "{", "InputStream", "in", "=", "jar", ".", "getInputStream", "(", "entry", ")", ";", "try", "{", "File", "file", "=", "new", "File", "(", "toDir", ",", "entry", ".", "getName", "(", "))", ";", "ensureDirectory", "(", "file", ".", "getParentFile", "(", "))", ";", "OutputStream", "out", "=", "new", "FileOutputStream", "(", "file", ")", ";", "try", "{", "copyBytes", "(", "in", ",", "out", ",", "8192", ")", ";", "}", "finally", "{", "out", ".", "close", "(", ");", "}", "}", "finally", "{", "in", ".", "close", "(", ");", "}", "}", "}", "}", "finally", "{", "jar", ".", "close", "(", ");", "}", "}", "/", "**", "*", "Copies", "from", "one", "stream", "to", "another", ".", "*", "*", "@", "param", "in", "InputStream", "to", "read", "from", "*", "@", "param", "out", "OutputStream", "to", "write", "to", "*", "@", "param", "buffSize", "the", "size", "of", "the", "buffer", "*", "/", "public", "static", "void", "copyBytes", "(", "InputStream", "in", ",", "OutputStream", "out", ",", "int", "buffSize", ")", "throws", "IOException", "{", "PrintStream", "ps", "=", "out", "instanceof", "PrintStream", "?", "(", "PrintStream", ")", "out", ":", "null", ";", "byte", "buf", "[", "]", "=", "new", "byte", "[", "buffSize", "]", ";", "int", "bytesRead", "=", "in", ".", "read", "(", "buf", ")", ";", "while", "(", "bytesRead", ">", "=", "0", ")", "{", "out", ".", "write", "(", "buf", ",", "0", ",", "bytesRead", ")", ";", "if", "(", "(", "ps", "!", "=", "null", ")", "&", "&", "ps", ".", "checkError", "(", "))", "{", "throw", "new", "IOException", "(", "\"", "Unable", "to", "write", "to", "output", "stream", ".", "\")", ";", "}", "bytesRead", "=", "in", ".", "read", "(", "buf", ")", ";", "public", "static", "void", "unJar", "(", "File", "jarFile", ",", "File", "toDir", ")", "throws", "IOException", "{", "try", "(", "JarFile", "jar", "=", "new", "JarFile", "(", "jarFile", ")", ")", "{", "extractZipFile", "(", "jar", ",", "toDir", ",", "null", ")", ";", "}", "}", "@", "@", "-", "446", ",", "20", "+", "408", ",", "17", "@", "@", "private", "static", "void", "ensureDirectory", "(", "File", "dir", ")", "throws", "IOException", "{", "*", "*", "@", "param", "inFile", "The", "tar", "file", "as", "input", ".", "*", "@", "param", "untarDir", "The", "untar", "directory", "where", "to", "untar", "the", "tar", "file", ".", "*", "@", "param", "symlinksDisabled", "true", "if", "symlinks", "should", "be", "disabled", ",", "else", "false", ".", "*", "@", "throws", "IOException", "*", "/", "public", "static", "void", "unTar", "(", "File", "inFile", ",", "File", "untarDir", ")", "throws", "IOException", "{", "if", "(", "!", "untarDir", ".", "mkdirs", "(", "))", "{", "if", "(", "!", "untarDir", ".", "isDirectory", "(", "))", "{", "throw", "new", "IOException", "(", "\"", "Mkdirs", "failed", "to", "create", "\"", "+", "untarDir", ")", ";", "}", "}", "public", "static", "void", "unTar", "(", "File", "inFile", ",", "File", "untarDir", ",", "boolean", "symlinksDisabled", ")", "throws", "IOException", "{", "ensureDirectory", "(", "untarDir", ")", ";", "boolean", "gzipped", "=", "inFile", ".", "toString", "(", ").", "endsWith", "(", "\"", "gz", "\"", ");", "if", "(", "Utils", ".", "isOnWindows", "(", "))", "{", "if", "(", "Utils", ".", "isOnWindows", "(", ")", "|", "|", "symlinksDisabled", ")", "{", "/", "/", "Tar", "is", "not", "native", "to", "Windows", ".", "Use", "simple", "Java", "based", "implementation", "for", "/", "/", "tests", "and", "simple", "tar", "archives", "unTarUsingJava", "(", "inFile", ",", "untarDir", ",", "gzipped", ")", ";", "unTarUsingJava", "(", "inFile", ",", "untarDir", ",", "gzipped", ",", "symlinksDisabled", ")", ";", "}", "else", "{", "/", "/", "spawn", "tar", "utility", "to", "untar", "archive", "for", "full", "fledged", "unix", "behavior", "such", "/", "/", "as", "resolving", "symlinks", "in", "tar", "archives", "@", "@", "-", "496", ",", "7", "+", "455", ",", "9", "@", "@", "private", "static", "void", "unTarUsingTar", "(", "File", "inFile", ",", "File", "untarDir", ",", "}", "private", "static", "void", "unTarUsingJava", "(", "File", "inFile", ",", "File", "untarDir", ",", "boolean", "gzipped", ")", "throws", "IOException", "{", "boolean", "gzipped", ",", "boolean", "symlinksDisabled", ")", "throws", "IOException", "{", "final", "String", "base", "=", "untarDir", ".", "getCanonicalPath", "(", ");", "LOG", ".", "trace", "(", "\"", "java", "untar", "{", "}", "to", "{", "}\"", ",", "inFile", ",", "base", ")", ";", "InputStream", "inputStream", "=", "null", ";", "try", "{", "if", "(", "gzipped", ")", "{", "@", "@", "-", "507", ",", "7", "+", "468", ",", "7", "@", "@", "private", "static", "void", "unTarUsingJava", "(", "File", "inFile", ",", "File", "untarDir", ",", "}", "try", "(", "TarArchiveInputStream", "tis", "=", "new", "TarArchiveInputStream", "(", "inputStream", ")", ")", "{", "for", "(", "TarArchiveEntry", "entry", "=", "tis", ".", "getNextTarEntry", "(", ");", "entry", "!", "=", "null", ";", ")", "{", "unpackEntries", "(", "tis", ",", "entry", ",", "untarDir", ")", ";", "unpackEntries", "(", "tis", ",", "entry", ",", "untarDir", ",", "base", ",", "symlinksDisabled", ")", ";", "entry", "=", "tis", ".", "getNextTarEntry", "(", ");", "}", "}", "@", "@", "-", "519", ",", "47", "+", "480", ",", "99", "@", "@", "private", "static", "void", "unTarUsingJava", "(", "File", "inFile", ",", "File", "untarDir", ",", "}", "private", "static", "void", "unpackEntries", "(", "TarArchiveInputStream", "tis", ",", "TarArchiveEntry", "entry", ",", "File", "outputDir", ")", "throws", "IOException", "{", "TarArchiveEntry", "entry", ",", "File", "outputDir", ",", "final", "String", "base", ",", "boolean", "symlinksDisabled", ")", "throws", "IOException", "{", "File", "target", "=", "new", "File", "(", "outputDir", ",", "entry", ".", "getName", "(", "))", ";", "String", "found", "=", "target", ".", "getCanonicalPath", "(", ");", "if", "(", "!", "found", ".", "startsWith", "(", "base", ")", ")", "{", "LOG", ".", "error", "(", "\"", "Invalid", "location", "{", "}", "is", "outside", "of", "{", "}\"", ",", "found", ",", "base", ")", ";", "return", ";", "}", "if", "(", "entry", ".", "isDirectory", "(", "))", "{", "File", "subDir", "=", "new", "File", "(", "outputDir", ",", "entry", ".", "getName", "(", "))", ";", "if", "(", "!", "subDir", ".", "mkdirs", "(", ")", "&", "&", "!", "subDir", ".", "isDirectory", "(", "))", "{", "throw", "new", "IOException", "(", "\"", "Mkdirs", "failed", "to", "create", "tar", "internal", "dir", "\"", "+", "outputDir", ")", ";", "}", "LOG", ".", "trace", "(", "\"", "Extracting", "dir", "{", "}\"", ",", "target", ")", ";", "ensureDirectory", "(", "target", ")", ";", "for", "(", "TarArchiveEntry", "e", ":", "entry", ".", "getDirectoryEntries", "(", "))", "{", "unpackEntries", "(", "tis", ",", "e", ",", "subDir", ")", ";", "unpackEntries", "(", "tis", ",", "e", ",", "target", ",", "base", ",", "symlinksDisabled", ")", ";", "}", "return", ";", "}", "else", "if", "(", "entry", ".", "isSymbolicLink", "(", "))", "{", "if", "(", "symlinksDisabled", ")", "{", "LOG", ".", "info", "(", "\"", "Symlinks", "disabled", "skipping", "{", "}\"", ",", "target", ")", ";", "}", "else", "{", "Path", "src", "=", "target", ".", "toPath", "(", ");", "Path", "dest", "=", "Paths", ".", "get", "(", "entry", ".", "getLinkName", "(", "))", ";", "LOG", ".", "trace", "(", "\"", "Extracting", "sym", "link", "{", "}", "to", "{", "}\"", ",", "target", ",", "dest", ")", ";", "/", "/", "Create", "symbolic", "link", "relative", "to", "tar", "parent", "dir", "Files", ".", "createSymbolicLink", "(", "src", ",", "dest", ")", ";", "}", "}", "else", "if", "(", "entry", ".", "isFile", "(", "))", "{", "LOG", ".", "trace", "(", "\"", "Extracting", "file", "{", "}\"", ",", "target", ")", ";", "ensureDirectory", "(", "target", ".", "getParentFile", "(", "))", ";", "try", "(", "BufferedOutputStream", "outputStream", "=", "new", "BufferedOutputStream", "(", "new", "FileOutputStream", "(", "target", ")", "))", "{", "IOUtils", ".", "copy", "(", "tis", ",", "outputStream", ")", ";", "}", "}", "else", "{", "LOG", ".", "error", "(", "\"{", "}", "is", "not", "a", "currently", "supported", "tar", "entry", "type", ".", "\",", "entry", ")", ";", "}", "File", "outputFile", "=", "new", "File", "(", "outputDir", ",", "entry", ".", "getName", "(", "))", ";", "if", "(", "!", "outputFile", ".", "getParentFile", "(", ").", "exists", "(", "))", "{", "if", "(", "!", "outputFile", ".", "getParentFile", "(", ").", "mkdirs", "(", "))", "{", "throw", "new", "IOException", "(", "\"", "Mkdirs", "failed", "to", "create", "tar", "internal", "dir", "\"", "+", "outputDir", ")", ";", "Path", "p", "=", "target", ".", "toPath", "(", ");", "if", "(", "Files", ".", "exists", "(", "p", ")", ")", "{", "try", "{", "/", "/", "We", "created", "it", "so", "lets", "chmod", "it", "properly", "int", "mode", "=", "entry", ".", "getMode", "(", ");", "Files", ".", "setPosixFilePermissions", "(", "p", ",", "parsePerms", "(", "mode", ")", ");", "}", "catch", "(", "UnsupportedOperationException", "e", ")", "{", "/", "/", "Ignored", "the", "file", "system", "we", "are", "on", "does", "not", "support", "this", ",", "so", "don", "'", "t", "do", "it", ".", "}", "}", "int", "count", ";", "byte", "data", "[", "]", "=", "new", "byte", "[", "2048", "]", ";", "BufferedOutputStream", "outputStream", "=", "new", "BufferedOutputStream", "(", "new", "FileOutputStream", "(", "outputFile", ")", ");", "}", "while", "(", "(", "count", "=", "tis", ".", "read", "(", "data", ")", ")", "!", "=", "-", "1", ")", "{", "outputStream", ".", "write", "(", "data", ",", "0", ",", "count", ")", ";", "private", "static", "Set", "<", "PosixFilePermission", ">", "parsePerms", "(", "int", "mode", ")", "{", "Set", "<", "PosixFilePermission", ">", "ret", "=", "new", "HashSet", "<", ">(", ");", "if", "(", "(", "mode", "&", "0001", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "OTHERS_EXECUTE", ")", ";", "}", "if", "(", "(", "mode", "&", "0002", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "OTHERS_WRITE", ")", ";", "}", "if", "(", "(", "mode", "&", "0004", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "OTHERS_READ", ")", ";", "}", "if", "(", "(", "mode", "&", "0010", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "GROUP_EXECUTE", ")", ";", "}", "outputStream", ".", "flush", "(", ");", "outputStream", ".", "close", "(", ");", "if", "(", "(", "mode", "&", "0020", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "GROUP_WRITE", ")", ";", "}", "if", "(", "(", "mode", "&", "0040", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "GROUP_READ", ")", ";", "}", "if", "(", "(", "mode", "&", "0100", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "OWNER_EXECUTE", ")", ";", "}", "if", "(", "(", "mode", "&", "0200", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "OWNER_WRITE", ")", ";", "}", "if", "(", "(", "mode", "&", "0400", ")", ">", "0", ")", "{", "ret", ".", "add", "(", "PosixFilePermission", ".", "OWNER_READ", ")", ";", "}", "return", "ret", ";", "}", "public", "static", "void", "unpack", "(", "File", "localrsrc", ",", "File", "dst", ")", "throws", "IOException", "{", "public", "static", "void", "unpack", "(", "File", "localrsrc", ",", "File", "dst", ",", "boolean", "symLinksDisabled", ")", "throws", "IOException", "{", "String", "lowerDst", "=", "localrsrc", ".", "getName", "(", ").", "toLowerCase", "(", ");", "if", "(", "lowerDst", ".", "endsWith", "(", "\".", "jar", "\"", "))", "{", "if", "(", "lowerDst", ".", "endsWith", "(", "\".", "jar", "\"", ")", "|", "|", "lowerDst", ".", "endsWith", "(", "\"", "_jar", "\"", "))", "{", "unJar", "(", "localrsrc", ",", "dst", ")", ";", "}", "else", "if", "(", "lowerDst", ".", "endsWith", "(", "\".", "zip", "\"", "))", "{", "}", "else", "if", "(", "lowerDst", ".", "endsWith", "(", "\".", "zip", "\"", ")", "|", "|", "lowerDst", ".", "endsWith", "(", "\"", "_zip", "\"", "))", "{", "unZip", "(", "localrsrc", ",", "dst", ")", ";", "}", "else", "if", "(", "lowerDst", ".", "endsWith", "(", "\".", "tar", ".", "gz", "\"", ")", "|", "|", "lowerDst", ".", "endsWith", "(", "\".", "tgz", "\"", ")", "|", "|", "lowerDst", ".", "endsWith", "(", "\".", "tar", "\"", "))", "{", "unTar", "(", "localrsrc", ",", "dst", ")", ";", "lowerDst", ".", "endsWith", "(", "\"", "_tar_gz", "\"", ")", "|", "|", "lowerDst", ".", "endsWith", "(", "\".", "tgz", "\"", ")", "|", "|", "lowerDst", ".", "endsWith", "(", "\"", "_tgz", "\"", ")", "|", "|", "lowerDst", ".", "endsWith", "(", "\".", "tar", "\"", ")", "|", "|", "lowerDst", ".", "endsWith", "(", "\"", "_tar", "\"", "))", "{", "unTar", "(", "localrsrc", ",", "dst", ",", "symLinksDisabled", ")", ";", "}", "else", "{", "LOG", ".", "warn", "(", "\"", "Cannot", "unpack", "\"", "+", "localrsrc", ")", ";", "if", "(", "!", "localrsrc", ".", "renameTo", "(", "dst", ")", ")", "{", "@", "@", "-", "572", ",", "48", "+", "585", ",", "45", "@", "@", "public", "static", "void", "unpack", "(", "File", "localrsrc", ",", "File", "dst", ")", "throws", "IOException", "{", "}", "}", "private", "static", "void", "extractZipFile", "(", "ZipFile", "zipFile", ",", "File", "toDir", ",", "String", "prefix", ")", "throws", "IOException", "{", "ensureDirectory", "(", "toDir", ")", ";", "final", "String", "base", "=", "toDir", ".", "getCanonicalPath", "(", ");", "Enumeration", "<", "?", "extends", "ZipEntry", ">", "entries", "=", "zipFile", ".", "entries", "(", ");", "while", "(", "entries", ".", "hasMoreElements", "(", "))", "{", "ZipEntry", "entry", "=", "entries", ".", "nextElement", "(", ");", "if", "(", "!", "entry", ".", "isDirectory", "(", "))", "{", "if", "(", "prefix", "!", "=", "null", "&", "&", "!", "entry", ".", "getName", "(", ").", "startsWith", "(", "prefix", ")", ")", "{", "/", "/", "No", "need", "to", "extract", "it", ",", "it", "is", "not", "what", "we", "are", "looking", "for", ".", "continue", ";", "}", "File", "file", "=", "new", "File", "(", "toDir", ",", "entry", ".", "getName", "(", "))", ";", "String", "found", "=", "file", ".", "getCanonicalPath", "(", ");", "if", "(", "!", "found", ".", "startsWith", "(", "base", ")", ")", "{", "LOG", ".", "error", "(", "\"", "Invalid", "location", "{", "}", "is", "outside", "of", "{", "}\"", ",", "found", ",", "base", ")", ";", "continue", ";", "}", "try", "(", "InputStream", "in", "=", "zipFile", ".", "getInputStream", "(", "entry", ")", ")", "{", "ensureDirectory", "(", "file", ".", "getParentFile", "(", "))", ";", "try", "(", "OutputStream", "out", "=", "new", "FileOutputStream", "(", "file", ")", ")", "{", "IOUtils", ".", "copy", "(", "in", ",", "out", ")", ";", "}", "}", "}", "}", "}", "/", "**", "*", "Given", "a", "File", "input", "it", "will", "unzip", "the", "file", "in", "a", "the", "unzip", "directory", "passed", "as", "the", "second", "parameter", "*", "Given", "a", "File", "input", "it", "will", "unzip", "the", "file", "in", "a", "the", "unzip", "directory", "passed", "as", "the", "second", "parameter", ".", "*", "*", "@", "param", "inFile", "The", "zip", "file", "as", "input", "*", "@", "param", "unzipDir", "The", "unzip", "directory", "where", "to", "unzip", "the", "zip", "file", ".", "*", "@", "param", "toDir", "The", "unzip", "directory", "where", "to", "unzip", "the", "zip", "file", ".", "*", "@", "throws", "IOException", "*", "/", "public", "static", "void", "unZip", "(", "File", "inFile", ",", "File", "unzipDir", ")", "throws", "IOException", "{", "Enumeration", "<", "?", "extends", "ZipEntry", ">", "entries", ";", "ZipFile", "zipFile", "=", "new", "ZipFile", "(", "inFile", ")", ";", "try", "{", "entries", "=", "zipFile", ".", "entries", "(", ");", "while", "(", "entries", ".", "hasMoreElements", "(", "))", "{", "ZipEntry", "entry", "=", "entries", ".", "nextElement", "(", ");", "if", "(", "!", "entry", ".", "isDirectory", "(", "))", "{", "InputStream", "in", "=", "zipFile", ".", "getInputStream", "(", "entry", ")", ";", "try", "{", "File", "file", "=", "new", "File", "(", "unzipDir", ",", "entry", ".", "getName", "(", "))", ";", "if", "(", "!", "file", ".", "getParentFile", "(", ").", "mkdirs", "(", "))", "{", "if", "(", "!", "file", ".", "getParentFile", "(", ").", "isDirectory", "(", "))", "{", "throw", "new", "IOException", "(", "\"", "Mkdirs", "failed", "to", "create", "\"", "+", "file", ".", "getParentFile", "(", ").", "toString", "(", "))", ";", "}", "}", "OutputStream", "out", "=", "new", "FileOutputStream", "(", "file", ")", ";", "try", "{", "byte", "[", "]", "buffer", "=", "new", "byte", "[", "8192", "]", ";", "int", "i", ";", "while", "(", "(", "i", "=", "in", ".", "read", "(", "buffer", ")", ")", "!", "=", "-", "1", ")", "{", "out", ".", "write", "(", "buffer", ",", "0", ",", "i", ")", ";", "}", "}", "finally", "{", "out", ".", "close", "(", ");", "}", "}", "finally", "{", "in", ".", "close", "(", ");", "}", "}", "}", "}", "finally", "{", "zipFile", ".", "close", "(", ");", "public", "static", "void", "unZip", "(", "File", "inFile", ",", "File", "toDir", ")", "throws", "IOException", "{", "try", "(", "ZipFile", "zipFile", "=", "new", "ZipFile", "(", "inFile", ")", ")", "{", "extractZipFile", "(", "zipFile", ",", "toDir", ",", "null", ")", ";", "}", "}", "@", "@", "-", "741", ",", "18", "+", "751", ",", "7", "@", "@", "public", "String", "currentClasspathImpl", "(", ")", "{", "public", "void", "extractDirFromJarImpl", "(", "String", "jarpath", ",", "String", "dir", ",", "File", "destdir", ")", "{", "try", "(", "JarFile", "jarFile", "=", "new", "JarFile", "(", "jarpath", ")", ")", "{", "Enumeration", "<", "JarEntry", ">", "jarEnums", "=", "jarFile", ".", "entries", "(", ");", "while", "(", "jarEnums", ".", "hasMoreElements", "(", "))", "{", "JarEntry", "entry", "=", "jarEnums", ".", "nextElement", "(", ");", "if", "(", "!", "entry", ".", "isDirectory", "(", ")", "&", "&", "entry", ".", "getName", "(", ").", "startsWith", "(", "dir", ")", ")", "{", "File", "aFile", "=", "new", "File", "(", "destdir", ",", "entry", ".", "getName", "(", "))", ";", "aFile", ".", "getParentFile", "(", ").", "mkdirs", "(", ");", "try", "(", "FileOutputStream", "out", "=", "new", "FileOutputStream", "(", "aFile", ")", ";", "InputStream", "in", "=", "jarFile", ".", "getInputStream", "(", "entry", ")", ")", "{", "IOUtils", ".", "copy", "(", "in", ",", "out", ")", ";", "}", "}", "}", "extractZipFile", "(", "jarFile", ",", "destdir", ",", "dir", ")", ";", "}", "catch", "(", "IOException", "e", ")", "{", "LOG", ".", "info", "(", "\"", "Could", "not", "extract", "{", "}", "from", "{", "}\"", ",", "dir", ",", "jarpath", ")", ";", "}"], "docstring_tokens": ["using", "a", "specially", "crafted", "zip", "archive"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1363", ",", "7", "+", "1363", ",", "11", "@", "@", "public", "Jooby", "renderer", "(", "final", "Renderer", "renderer", ")", "{", "@", "Override", "public", "Route", ".", "Definition", "get", "(", "final", "String", "path", ",", "final", "Route", ".", "Handler", "handler", ")", "{", "return", "appendDefinition", "(", "GET", ",", "path", ",", "handler", ")", ";", "if", "(", "handler", "instanceof", "AssetHandler", ")", "{", "return", "assets", "(", "path", ",", "(", "AssetHandler", ")", "handler", ")", ";", "}", "else", "{", "return", "appendDefinition", "(", "GET", ",", "path", ",", "handler", ")", ";", "}", "}", "@", "Override", "@", "@", "-", "1636", ",", "6", "+", "1636", ",", "7", "@", "@", "public", "static", "Route", "unwrap", "(", "final", "Route", "route", ")", "{", "public", "AssetDefinition", "(", "final", "String", "method", ",", "final", "String", "pattern", ",", "final", "Route", ".", "Filter", "handler", ",", "boolean", "caseSensitiveRouting", ")", "{", "super", "(", "method", ",", "pattern", ",", "handler", ",", "caseSensitiveRouting", ")", ";", "filter", "(", ").", "setRoute", "(", "this", ")", ";", "}", "@", "Nonnull", "@", "@", "-", "206", ",", "7", "+", "206", ",", "6", "@", "@", "import", "com", ".", "google", ".", "common", ".", "base", ".", "Strings", ";", "import", "com", ".", "typesafe", ".", "config", ".", "ConfigFactory", ";", "import", "com", ".", "typesafe", ".", "config", ".", "ConfigValueFactory", ";", "import", "static", "java", ".", "util", ".", "Objects", ".", "requireNonNull", ";", "import", "org", ".", "jooby", ".", "Asset", ";", "import", "org", ".", "jooby", ".", "Err", ";", "import", "org", ".", "jooby", ".", "Jooby", ";", "@", "@", "-", "229", ",", "6", "+", "228", ",", "8", "@", "@", "import", "java", ".", "util", ".", "Date", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "static", "java", ".", "util", ".", "Objects", ".", "requireNonNull", ";", "/", "**", "*", "Serve", "static", "resources", ",", "via", "{", "@", "link", "Jooby", "#", "assets", "(", "String", ")", "}", "or", "variants", ".", "*", "@", "@", "-", "287", ",", "6", "+", "288", ",", "12", "@", "@", "private", "int", "statusCode", "=", "404", ";", "private", "String", "location", ";", "private", "Path", "basedir", ";", "private", "ClassLoader", "classLoader", ";", "/", "**", "*", "<", "p", ">", "*", "Creates", "a", "new", "{", "@", "link", "AssetHandler", "}", ".", "The", "handler", "accepts", "a", "location", "pattern", ",", "that", "serve", "for", "@", "@", "-", "315", ",", "7", "+", "322", ",", "9", "@", "@", "*", "@", "param", "loader", "The", "one", "who", "load", "the", "static", "resources", ".", "*", "/", "public", "AssetHandler", "(", "final", "String", "pattern", ",", "final", "ClassLoader", "loader", ")", "{", "init", "(", "Route", ".", "normalize", "(", "pattern", ")", ",", "Paths", ".", "get", "(", "\"", "public", "\"", "),", "loader", ")", ";", "this", ".", "location", "=", "Route", ".", "normalize", "(", "pattern", ")", ";", "this", ".", "basedir", "=", "Paths", ".", "get", "(", "\"", "public", "\"", ");", "this", ".", "classLoader", "=", "loader", ";", "}", "/", "**", "@", "@", "-", "345", ",", "7", "+", "354", ",", "9", "@", "@", "public", "AssetHandler", "(", "final", "String", "pattern", ",", "final", "ClassLoader", "loader", ")", "{", "*", "@", "param", "basedir", "Base", "directory", ".", "*", "/", "public", "AssetHandler", "(", "final", "Path", "basedir", ")", "{", "init", "(", "\"/", "{", "0", "}", "\",", "basedir", ",", "getClass", "(", ").", "getClassLoader", "(", "))", ";", "this", ".", "location", "=", "\"", "/{", "0", "}", "\";", "this", ".", "basedir", "=", "basedir", ";", "this", ".", "classLoader", "=", "getClass", "(", ").", "getClassLoader", "(", ");", "}", "/", "**", "@", "@", "-", "375", ",", "7", "+", "386", ",", "9", "@", "@", "public", "AssetHandler", "(", "final", "Path", "basedir", ")", "{", "*", "@", "param", "pattern", "Pattern", "to", "locate", "static", "resources", ".", "*", "/", "public", "AssetHandler", "(", "final", "String", "pattern", ")", "{", "init", "(", "Route", ".", "normalize", "(", "pattern", ")", ",", "Paths", ".", "get", "(", "\"", "public", "\"", "),", "getClass", "(", ").", "getClassLoader", "(", "))", ";", "this", ".", "location", "=", "Route", ".", "normalize", "(", "pattern", ")", ";", "this", ".", "basedir", "=", "Paths", ".", "get", "(", "\"", "public", "\"", ");", "this", ".", "classLoader", "=", "getClass", "(", ").", "getClassLoader", "(", ");", "}", "/", "**", "@", "@", "-", "422", ",", "6", "+", "435", ",", "45", "@", "@", "public", "AssetHandler", "maxAge", "(", "final", "long", "maxAge", ")", "{", "return", "this", ";", "}", "/", "**", "*", "Set", "the", "route", "definition", "and", "initialize", "the", "handler", ".", "*", "*", "@", "param", "route", "Route", "definition", ".", "*", "@", "return", "This", "handler", ".", "*", "/", "public", "AssetHandler", "setRoute", "(", "final", "Route", ".", "AssetDefinition", "route", ")", "{", "String", "prefix", ";", "boolean", "rootLocation", "=", "location", ".", "equals", "(", "\"/", "\")", "|", "|", "location", ".", "equals", "(", "\"/", "{", "0", "}", "\")", ";", "if", "(", "rootLocation", ")", "{", "String", "pattern", "=", "route", ".", "pattern", "(", ");", "int", "i", "=", "pattern", ".", "indexOf", "(", "\"/", "*\"", ");", "if", "(", "i", ">", "0", ")", "{", "prefix", "=", "pattern", ".", "substring", "(", "0", ",", "i", "+", "1", ")", ";", "}", "else", "{", "prefix", "=", "pattern", ";", "}", "}", "else", "{", "int", "i", "=", "location", ".", "indexOf", "(", "\"{", "\")", ";", "if", "(", "i", ">", "0", ")", "{", "prefix", "=", "location", ".", "substring", "(", "0", ",", "i", ")", ";", "}", "else", "{", "/", "//", "TODO", ":", "review", "what", "we", "have", "here", "prefix", "=", "location", ";", "}", "}", "if", "(", "prefix", ".", "startsWith", "(", "\"/", "\")", ")", "{", "prefix", "=", "prefix", ".", "substring", "(", "1", ")", ";", "}", "if", "(", "prefix", ".", "isEmpty", "(", ")", "&", "&", "rootLocation", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "For", "security", "reasons", "root", "classpath", "access", "is", "not", "allowed", ".", "Map", "your", "static", "resources", "\"", "+", "\"", "using", "a", "prefix", "like", ":", "assets", "(", "static", "/", "**", ");", "or", "use", "a", "location", "classpath", "prefix", "like", ":", "\"", "+", "\"", "assets", "(", "/,", "/", "static", "/", "{", "0", "}", ")\"", ");", "}", "init", "(", "prefix", ",", "location", ",", "basedir", ",", "classLoader", ")", ";", "return", "this", ";", "}", "/", "**", "*", "Parse", "value", "as", "{", "@", "link", "Duration", "}", ".", "If", "the", "value", "is", "already", "a", "number", "then", "it", "uses", "as", "seconds", ".", "*", "Otherwise", ",", "it", "parse", "expressions", "like", ":", "8m", ",", "1h", ",", "365d", ",", "etc", ".", "..", "@", "@", "-", "485", ",", "7", "+", "537", ",", "6", "@", "@", "public", "void", "handle", "(", "final", "Request", "req", ",", "final", "Response", "rsp", ")", "throws", "Throwable", "{", "}", "private", "void", "doHandle", "(", "final", "Request", "req", ",", "final", "Response", "rsp", ",", "final", "Asset", "asset", ")", "throws", "Throwable", "{", "/", "/", "handle", "etag", "if", "(", "this", ".", "etag", ")", "{", "String", "etag", "=", "asset", ".", "etag", "(", ");", "@", "@", "-", "551", ",", "21", "+", "602", ",", "22", "@", "@", "protected", "URL", "resolve", "(", "final", "String", "path", ")", "throws", "Exception", "{", "return", "loader", ".", "getResource", "(", "path", ")", ";", "}", "private", "void", "init", "(", "final", "String", "pattern", ",", "final", "Path", "basedir", ",", "final", "ClassLoader", "loader", ")", "{", "private", "void", "init", "(", "final", "String", "classPathPrefix", ",", "final", "String", "location", ",", "final", "Path", "basedir", ",", "final", "ClassLoader", "loader", ")", "{", "requireNonNull", "(", "loader", ",", "\"", "Resource", "loader", "is", "required", ".", "\")", ";", "this", ".", "fn", "=", "pattern", ".", "equals", "(", "\"/", "\")", "this", ".", "fn", "=", "location", ".", "equals", "(", "\"/", "\")", "?", "(", "req", ",", "p", ")", "-", ">", "prefix", ".", "apply", "(", "p", ")", ":", "(", "req", ",", "p", ")", "-", ">", "MessageFormat", ".", "format", "(", "prefix", ".", "apply", "(", "pattern", ")", ",", "vars", "(", "req", ")", ");", "this", ".", "loader", "=", "loader", "(", "basedir", ",", "loader", ")", ";", ":", "(", "req", ",", "p", ")", "-", ">", "MessageFormat", ".", "format", "(", "prefix", ".", "apply", "(", "location", ")", ",", "vars", "(", "req", ")", ");", "this", ".", "loader", "=", "loader", "(", "basedir", ",", "classpathLoader", "(", "classPathPrefix", ",", "classLoader", ")", ");", "}", "private", "static", "Object", "[", "]", "vars", "(", "final", "Request", "req", ")", "{", "Map", "<", "Object", ",", "String", ">", "vars", "=", "req", ".", "route", "(", ").", "vars", "(", ");", "return", "vars", ".", "values", "(", ").", "toArray", "(", "new", "Object", "[", "vars", ".", "size", "(", ")]", ");", "}", "private", "static", "Loader", "loader", "(", "final", "Path", "basedir", ",", "final", "ClassLoader", "classloader", ")", "{", "if", "(", "Files", ".", "exists", "(", "basedir", ")", ")", "{", "private", "static", "Loader", "loader", "(", "final", "Path", "basedir", ",", "Loader", "classpath", ")", "{", "if", "(", "basedir", "!", "=", "null", "&", "&", "Files", ".", "exists", "(", "basedir", ")", ")", "{", "return", "name", "-", ">", "{", "Path", "path", "=", "basedir", ".", "resolve", "(", "name", ")", ".", "normalize", "(", ");", "if", "(", "Files", ".", "exists", "(", "path", ")", "&", "&", "path", ".", "startsWith", "(", "basedir", ")", ")", "{", "@", "@", "-", "575", ",", "10", "+", "627", ",", "45", "@", "@", "private", "static", "Loader", "loader", "(", "final", "Path", "basedir", ",", "final", "ClassLoader", "classloader", ")", "/", "/", "shh", "}", "}", "return", "classloader", ".", "getResource", "(", "name", ")", ";", "return", "classpath", ".", "getResource", "(", "name", ")", ";", "}", ";", "}", "return", "classloader", ":", ":", "getResource", ";", "return", "classpath", ";", "}", "private", "static", "Loader", "classpathLoader", "(", "String", "prefix", ",", "ClassLoader", "classloader", ")", "{", "return", "name", "-", ">", "{", "String", "safePath", "=", "safePath", "(", "name", ")", ";", "if", "(", "safePath", ".", "startsWith", "(", "prefix", ")", ")", "{", "URL", "resource", "=", "classloader", ".", "getResource", "(", "safePath", ")", ";", "return", "resource", ";", "}", "return", "null", ";", "}", ";", "}", "private", "static", "String", "safePath", "(", "String", "name", ")", "{", "if", "(", "name", ".", "indexOf", "(", "\".", "/\"", ")", ">", "0", ")", "{", "Path", "path", "=", "toPath", "(", "name", ".", "split", "(", "\"/", "\")", ").", "normalize", "(", ");", "return", "toStringPath", "(", "path", ")", ";", "}", "return", "name", ";", "}", "private", "static", "String", "toStringPath", "(", "Path", "path", ")", "{", "StringBuilder", "buffer", "=", "new", "StringBuilder", "(", ");", "for", "(", "Path", "segment", ":", "path", ")", "{", "buffer", ".", "append", "(", "\"/", "\")", ".", "append", "(", "segment", ")", ";", "}", "return", "buffer", ".", "substring", "(", "1", ")", ";", "}", "private", "static", "Path", "toPath", "(", "String", "[", "]", "segments", ")", "{", "Path", "path", "=", "Paths", ".", "get", "(", "segments", "[", "0", "]", ");", "for", "(", "int", "i", "=", "1", ";", "i", "<", "segments", ".", "length", ";", "i", "+", "+)", "{", "path", "=", "path", ".", "resolve", "(", "segments", "[", "i", "]", ");", "}", "return", "path", ";", "}", "private", "static", "Throwing", ".", "Function", "<", "String", ",", "String", ">", "prefix", "(", ")", "{", "@", "@", "-", "0", ",", "0", "+", "1", ",", "44", "@", "@", "package", "org", ".", "jooby", ".", "internal", ";", "import", "com", ".", "google", ".", "common", ".", "base", ".", "Strings", ";", "import", "java", ".", "net", ".", "MalformedURLException", ";", "import", "java", ".", "net", ".", "URL", ";", "import", "java", ".", "nio", ".", "file", ".", "Files", ";", "import", "java", ".", "nio", ".", "file", ".", "Path", ";", "public", "interface", "AssetSource", "{", "URL", "getResource", "(", "String", "name", ")", ";", "static", "AssetSource", "fromClassPath", "(", "ClassLoader", "loader", ",", "String", "source", ")", "{", "if", "(", "Strings", ".", "isNullOrEmpty", "(", "source", ")", "|", "|", "\"", "/\"", ".", "equals", "(", "source", ".", "trim", "(", "))", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "For", "security", "reasons", "root", "classpath", "access", "is", "not", "allowed", ":", "\"", "+", "source", ")", ";", "}", "return", "path", "-", ">", "{", "URL", "resource", "=", "loader", ".", "getResource", "(", "path", ")", ";", "if", "(", "resource", "=", "=", "null", ")", "{", "return", "null", ";", "}", "String", "realPath", "=", "resource", ".", "getPath", "(", ");", "if", "(", "realPath", ".", "startsWith", "(", "source", ")", ")", "{", "return", "resource", ";", "}", "return", "null", ";", "}", ";", "}", "static", "AssetSource", "fromFileSystem", "(", "Path", "basedir", ")", "{", "return", "name", "-", ">", "{", "Path", "path", "=", "basedir", ".", "resolve", "(", "name", ")", ".", "normalize", "(", ");", "if", "(", "Files", ".", "exists", "(", "path", ")", "&", "&", "path", ".", "startsWith", "(", "basedir", ")", ")", "{", "try", "{", "return", "path", ".", "toUri", "(", ").", "toURL", "(", ");", "}", "catch", "(", "MalformedURLException", "x", ")", "{", "/", "/", "shh", "}", "}", "return", "null", ";", "}", ";", "}", "}", "@", "@", "-", "1", ",", "7", "+", "1", ",", "12", "@", "@", "package", "org", ".", "jooby", ".", "handlers", ";", "import", "static", "org", ".", "easymock", ".", "EasyMock", ".", "expect", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "import", "org", ".", "jooby", ".", "Route", ";", "import", "org", ".", "jooby", ".", "test", ".", "MockUnit", ";", "import", "org", ".", "jooby", ".", "test", ".", "MockUnit", ".", "Block", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", ";", "import", "org", ".", "powermock", ".", "core", ".", "classloader", ".", "annotations", ".", "PrepareForTest", ";", "import", "org", ".", "powermock", ".", "modules", ".", "junit4", ".", "PowerMockRunner", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "net", ".", "MalformedURLException", ";", "@", "@", "-", "11", ",", "15", "+", "16", ",", "11", "@", "@", "import", "java", ".", "nio", ".", "file", ".", "Path", ";", "import", "java", ".", "nio", ".", "file", ".", "Paths", ";", "import", "org", ".", "jooby", ".", "test", ".", "MockUnit", ";", "import", "org", ".", "jooby", ".", "test", ".", "MockUnit", ".", "Block", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", ";", "import", "org", ".", "powermock", ".", "core", ".", "classloader", ".", "annotations", ".", "PrepareForTest", ";", "import", "org", ".", "powermock", ".", "modules", ".", "junit4", ".", "PowerMockRunner", ";", "import", "static", "org", ".", "easymock", ".", "EasyMock", ".", "expect", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "@", "RunWith", "(", "PowerMockRunner", ".", "class", ")", "@", "PrepareForTest", "(", "{", "AssetHandler", ".", "class", ",", "File", ".", "class", ",", "Paths", ".", "class", ",", "Files", ".", "class", "}", ")", "@", "PrepareForTest", "(", "{", "AssetHandler", ".", "class", ",", "File", ".", "class", ",", "Paths", ".", "class", ",", "Files", ".", "class", "}", ")", "public", "class", "AssetHandlerTest", "{", "@", "Test", "@", "@", "-", "28", ",", "24", "+", "29", ",", "30", "@", "@", "public", "void", "customClassloader", "(", ")", "throws", "Exception", "{", "new", "MockUnit", "(", "ClassLoader", ".", "class", ")", ".", "expect", "(", "publicDir", "(", "uri", ",", "\"", "JoobyTest", ".", "js", "\"", "))", ".", "run", "(", "unit", "-", ">", "{", "URL", "value", "=", "new", "AssetHandler", "(", "\"/", "\",", "unit", ".", "get", "(", "ClassLoader", ".", "class", ")", ")", "URL", "value", "=", "newHandler", "(", "unit", ",", "\"", "/\"", ")", ".", "resolve", "(", "\"", "JoobyTest", ".", "js", "\"", ");", "assertNotNull", "(", "value", ")", ";", "}", ");", "}", "private", "AssetHandler", "newHandler", "(", "MockUnit", "unit", ",", "String", "location", ")", "{", "AssetHandler", "handler", "=", "new", "AssetHandler", "(", "location", ",", "unit", ".", "get", "(", "ClassLoader", ".", "class", ")", ");", "new", "Route", ".", "AssetDefinition", "(", "\"", "GET", "\"", ",", "\"", "/", "assets", "/", "**", "\",", "handler", ",", "false", ")", ";", "return", "handler", ";", "}", "@", "Test", "public", "void", "shouldCallParentOnMissing", "(", ")", "throws", "Exception", "{", "URI", "uri", "=", "Paths", ".", "get", "(", "\"", "src", "\"", ",", "\"", "test", "\"", ",", "\"", "resources", "\"", ",", "\"", "org", "\"", ",", "\"", "jooby", "\"", ").", "toUri", "(", ");", "new", "MockUnit", "(", "ClassLoader", ".", "class", ")", ".", "expect", "(", "publicDir", "(", "uri", ",", "\"", "index", ".", "js", "\"", ",", "false", ")", ")", ".", "expect", "(", "publicDir", "(", "uri", ",", "\"", "assets", "/", "index", ".", "js", "\"", ",", "false", ")", ")", ".", "expect", "(", "unit", "-", ">", "{", "ClassLoader", "loader", "=", "unit", ".", "get", "(", "ClassLoader", ".", "class", ")", ";", "expect", "(", "loader", ".", "getResource", "(", "\"", "index", ".", "js", "\"", "))", ".", "andReturn", "(", "uri", ".", "toURL", "(", "))", ";", "expect", "(", "loader", ".", "getResource", "(", "\"", "assets", "/", "index", ".", "js", "\"", "))", ".", "andReturn", "(", "uri", ".", "toURL", "(", "))", ";", "}", ")", ".", "run", "(", "unit", "-", ">", "{", "URL", "value", "=", "new", "AssetHandler", "(", "\"/", "\",", "unit", ".", "get", "(", "ClassLoader", ".", "class", ")", ")", ".", "resolve", "(", "\"", "index", ".", "js", "\"", ");", "URL", "value", "=", "newHandler", "(", "unit", ",", "\"", "/\"", ")", ".", "resolve", "(", "\"", "assets", "/", "index", ".", "js", "\"", ");", "assertNotNull", "(", "value", ")", ";", "}", ");", "}", "@", "@", "-", "54", ",", "18", "+", "61", ",", "18", "@", "@", "public", "void", "shouldCallParentOnMissing", "(", ")", "throws", "Exception", "{", "public", "void", "ignoreMalformedURL", "(", ")", "throws", "Exception", "{", "Path", "path", "=", "Paths", ".", "get", "(", "\"", "src", "\"", ",", "\"", "test", "\"", ",", "\"", "resources", "\"", ",", "\"", "org", "\"", ",", "\"", "jooby", "\"", ");", "new", "MockUnit", "(", "ClassLoader", ".", "class", ",", "URI", ".", "class", ")", ".", "expect", "(", "publicDir", "(", "null", ",", "\"", "index", ".", "js", "\"", "))", ".", "expect", "(", "publicDir", "(", "null", ",", "\"", "assets", "/", "index", ".", "js", "\"", "))", ".", "expect", "(", "unit", "-", ">", "{", "URI", "uri", "=", "unit", ".", "get", "(", "URI", ".", "class", ")", ";", "expect", "(", "uri", ".", "toURL", "(", "))", ".", "andThrow", "(", "new", "MalformedURLException", "(", "))", ";", "}", ")", ".", "expect", "(", "unit", "-", ">", "{", "ClassLoader", "loader", "=", "unit", ".", "get", "(", "ClassLoader", ".", "class", ")", ";", "expect", "(", "loader", ".", "getResource", "(", "\"", "index", ".", "js", "\"", "))", ".", "andReturn", "(", "path", ".", "toUri", "(", ").", "toURL", "(", "))", ";", "expect", "(", "loader", ".", "getResource", "(", "\"", "assets", "/", "index", ".", "js", "\"", "))", ".", "andReturn", "(", "path", ".", "toUri", "(", ").", "toURL", "(", "))", ";", "}", ")", ".", "run", "(", "unit", "-", ">", "{", "URL", "value", "=", "new", "AssetHandler", "(", "\"/", "\",", "unit", ".", "get", "(", "ClassLoader", ".", "class", ")", ")", ".", "resolve", "(", "\"", "index", ".", "js", "\"", ");", "URL", "value", "=", "newHandler", "(", "unit", ",", "\"", "/\"", ")", ".", "resolve", "(", "\"", "assets", "/", "index", ".", "js", "\"", ");", "assertNotNull", "(", "value", ")", ";", "}", ");", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "31", "@", "@", "package", "org", ".", "jooby", ".", "issues", ";", "import", "org", ".", "jooby", ".", "test", ".", "ServerFeature", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "java", ".", "nio", ".", "file", ".", "Files", ";", "import", "java", ".", "nio", ".", "file", ".", "Path", ";", "import", "java", ".", "nio", ".", "file", ".", "Paths", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "public", "class", "Issue1639", "extends", "ServerFeature", "{", "{", "Path", "dir", "=", "Paths", ".", "get", "(", "System", ".", "getProperty", "(", "\"", "user", ".", "dir", "\"", "),", "\"", "src", "\"", ",", "\"", "test", "\"", ",", "\"", "resources", "\"", ",", "\"", "assets", "\"", ");", "assertTrue", "(", "Files", ".", "exists", "(", "dir", ")", ");", "assets", "(", "\"/", "static", "/", "**", "\",", "dir", ")", ";", "}", "@", "Test", "public", "void", "shouldNotFallbackToArbitraryClasspathResources", "(", ")", "throws", "Exception", "{", "request", "(", ")", ".", "get", "(", "\"/", "static", "/", "WEB", "-", "INF", "/", "web2", ".", "xml", "\"", ")", ".", "expect", "(", "404", ")", ";", "request", "(", ")", ".", "get", "(", "\"/", "static", "/", "..", "/", "WEB", "-", "INF", "/", "web2", ".", "xml", "\"", ")", ".", "expect", "(", "404", ")", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "33", "@", "@", "package", "org", ".", "jooby", ".", "issues", ";", "import", "org", ".", "jooby", ".", "test", ".", "ServerFeature", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "java", ".", "nio", ".", "file", ".", "Paths", ";", "public", "class", "Issue1639b", "extends", "ServerFeature", "{", "{", "assets", "(", "\"/", "static", "/", "**", "/*", ".", "js", "\"", ",", "Paths", ".", "get", "(", "\"", "static", "\"", "))", ";", "}", "@", "Test", "public", "void", "shouldNotByPassPrefixValue", "(", ")", "throws", "Exception", "{", "request", "(", ")", ".", "get", "(", "\"/", "static", "/", "org", "/", "jooby", "/", "issues", "/", "Issue1639b", ".", "class", ".", "js", "\"", ")", ".", "expect", "(", "404", ")", ";", "request", "(", ")", ".", "get", "(", "\"/", "static", "/", "..", "/", "org", "/", "jooby", "/", "issues", "/", "Issue1639b", ".", "class", ".", "js", "\"", ")", ".", "expect", "(", "404", ")", ";", "request", "(", ")", ".", "get", "(", "\"/", "static", "/", "..", "%", "252forg", "/", "jooby", "/", "issues", "/", "Issue1639b", ".", "class", ".", "js", "\"", ")", ".", "expect", "(", "404", ")", ";", "request", "(", ")", ".", "get", "(", "\"/", "static", "/", "org", "/", "jooby", "/", "issues", "/", "Issue1639b", ".", "class", "\"", ")", ".", "expect", "(", "404", ")", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "24", "@", "@", "package", "org", ".", "jooby", ".", "issues", ";", "import", "org", ".", "jooby", ".", "test", ".", "ServerFeature", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "java", ".", "nio", ".", "file", ".", "Paths", ";", "public", "class", "Issue1639c", "extends", "ServerFeature", "{", "{", "assets", "(", "\"/", "static", "/", "**", "\")", ";", "}", "@", "Test", "public", "void", "shouldNotByPassPrefixValue", "(", ")", "throws", "Exception", "{", "request", "(", ")", ".", "get", "(", "\"/", "static", "/", "..", "%", "252forg", "/", "jooby", "/", "issues", "/", "Issue1639c", ".", "class", "\"", ")", ".", "expect", "(", "404", ")", ";", "request", "(", ")", ".", "get", "(", "\"/", "static", "/", "..", "/", "org", "/", "jooby", "/", "issues", "/", "Issue1639c", ".", "class", "\"", ")", ".", "expect", "(", "404", ")", ";", "}", "}", "@", "@", "-", "209", ",", "6", "+", "209", ",", "7", "@", "@", "import", "com", ".", "typesafe", ".", "config", ".", "ConfigFactory", ";", "import", "org", ".", "jooby", ".", "Env", ";", "import", "org", ".", "jooby", ".", "Jooby", ";", "import", "org", ".", "jooby", ".", "Route", ";", "import", "org", ".", "jooby", ".", "Router", ";", "import", "org", ".", "jooby", ".", "handlers", ".", "AssetHandler", ";", "import", "org", ".", "jooby", ".", "internal", ".", "assets", ".", "AssetVars", ";"], "docstring_tokens": ["via", "two", "separate", "vectors", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "80", ",", "7", "+", "80", ",", "7", "@", "@", "protected", "Object", "getOverrideExpr", "(", "ActionInvocation", "invocation", ",", "Object", "value", ")", "{", "try", "{", "stack", ".", "push", "(", "value", ")", ";", "return", "\"", "'\"", "+", "stack", ".", "findValue", "(", "\"", "top", "\"", ",", "String", ".", "class", ")", "+", "\"", "'\"", ";", "return", "escape", "(", "stack", ".", "findString", "(", "\"", "top", "\"", "))", ";", "}", "finally", "{", "stack", ".", "pop", "(", ");", "}", "@", "@", "-", "29", ",", "7", "+", "29", ",", "7", "@", "@", "maxlength", "=", "\"$", "{", "parameters", ".", "maxlength", "?", "html", "}", "\"<", "#", "rt", "/", ">", "<", "/#", "if", ">", "<", "#", "if", "parameters", ".", "nameValue", "?", "?>", "value", "=", "\"<", "@", "s", ".", "property", "value", "=", "\"", "parameters", ".", "nameValue", "\"", "/>", "\"<", "#", "rt", "/", ">", "value", "=", "\"$", "{", "parameters", ".", "nameValue", "?", "html", "}", "\"<", "#", "rt", "/", ">", "<", "/#", "if", ">", "<", "#", "if", "parameters", ".", "disabled", "?", "default", "(", "false", ")", ">", "disabled", "=", "\"", "disabled", "\"", "<#", "rt", "/", ">", "@", "@", "-", "21", ",", "19", "+", "21", ",", "17", "@", "@", "package", "org", ".", "apache", ".", "struts2", ".", "interceptor", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "org", ".", "apache", ".", "struts2", ".", "StrutsTestCase", ";", "import", "com", ".", "mockobjects", ".", "dynamic", ".", "C", ";", "import", "com", ".", "mockobjects", ".", "dynamic", ".", "Mock", ";", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "Action", ";", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "ActionContext", ";", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "ActionInvocation", ";", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "ActionSupport", ";", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "util", ".", "ValueStack", ";", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "util", ".", "ValueStackFactory", ";", "import", "org", ".", "apache", ".", "struts2", ".", "StrutsTestCase", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "/", "**", "@", "@", "-", "44", ",", "14", "+", "42", ",", "14", "@", "@", "protected", "ActionContext", "context", ";", "protected", "ActionInvocation", "invocation", ";", "protected", "Map", "conversionErrors", ";", "protected", "Map", "<", "String", ",", "Object", ">", "conversionErrors", ";", "protected", "Mock", "mockInvocation", ";", "protected", "ValueStack", "stack", ";", "protected", "StrutsConversionErrorInterceptor", "interceptor", ";", "public", "void", "testEmptyValuesDoNotSetFieldErrors", "(", ")", "throws", "Exception", "{", "conversionErrors", ".", "put", "(", "\"", "foo", "\"", ",", "new", "Long", "(", "123", ")", ");", "conversionErrors", ".", "put", "(", "\"", "foo", "\"", ",", "123L", ")", ";", "conversionErrors", ".", "put", "(", "\"", "bar", "\"", ",", "\"", "\")", ";", "conversionErrors", ".", "put", "(", "\"", "baz", "\"", ",", "new", "String", "[", "]{", "\"\"", "})", ";", "@", "@", "-", "70", ",", "7", "+", "68", ",", "7", "@", "@", "public", "void", "testEmptyValuesDoNotSetFieldErrors", "(", ")", "throws", "Exception", "{", "}", "public", "void", "testFieldErrorAdded", "(", ")", "throws", "Exception", "{", "conversionErrors", ".", "put", "(", "\"", "foo", "\"", ",", "new", "Long", "(", "123", ")", ");", "conversionErrors", ".", "put", "(", "\"", "foo", "\"", ",", "123L", ")", ";", "ActionSupport", "action", "=", "new", "ActionSupport", "(", ");", "mockInvocation", ".", "expectAndReturn", "(", "\"", "getAction", "\"", ",", "action", ")", ";", "@", "@", "-", "89", ",", "7", "+", "87", ",", "7", "@", "@", "protected", "void", "setUp", "(", ")", "throws", "Exception", "{", "invocation", "=", "(", "ActionInvocation", ")", "mockInvocation", ".", "proxy", "(", ");", "stack", "=", "ActionContext", ".", "getContext", "(", ").", "getValueStack", "(", ");", "context", "=", "new", "ActionContext", "(", "stack", ".", "getContext", "(", "))", ";", "conversionErrors", "=", "new", "HashMap", "(", ");", "conversionErrors", "=", "new", "HashMap", "<", "String", ",", "Object", ">", "()", ";", "context", ".", "setConversionErrors", "(", "conversionErrors", ")", ";", "mockInvocation", ".", "matchAndReturn", "(", "\"", "getInvocationContext", "\"", ",", "context", ")", ";", "mockInvocation", ".", "expectAndReturn", "(", "\"", "invoke", "\"", ",", "Action", ".", "SUCCESS", ")", ";", "@", "@", "-", "20", ",", "6", "+", "20", ",", "7", "@", "@", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "ValidationAware", ";", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "conversion", ".", "impl", ".", "XWorkConverter", ";", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "util", ".", "ValueStack", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang", ".", "StringEscapeUtils", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "@", "@", "-", "84", ",", "7", "+", "85", ",", "11", "@", "@", "public", "static", "final", "String", "ORIGINAL_PROPERTY_OVERRIDE", "=", "\"", "original", ".", "property", ".", "override", "\"", ";", "protected", "Object", "getOverrideExpr", "(", "ActionInvocation", "invocation", ",", "Object", "value", ")", "{", "return", "\"", "'\"", "+", "value", "+", "\"", "'\"", ";", "return", "escape", "(", "value", ")", ";", "}", "protected", "String", "escape", "(", "Object", "value", ")", "{", "return", "\"", "\\\"", "\"", "+", "StringEscapeUtils", ".", "escapeJava", "(", "String", ".", "valueOf", "(", "value", ")", ")", "+", "\"", "\\\"", "\";", "}", "@", "Override", "@", "@", "-", "22", ",", "58", "+", "22", ",", "59", "@", "@", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "util", ".", "logging", ".", "Logger", ";", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "validator", ".", "ValidationException", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang", ".", "StringEscapeUtils", ";", "import", "java", ".", "util", ".", "LinkedHashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "/", "**", "*", "*", "*", "*", "*", "An", "abstract", "base", "class", "that", "adds", "in", "the", "capability", "to", "populate", "the", "stack", "with", "*", "a", "fake", "parameter", "map", "when", "a", "conversion", "error", "has", "occurred", "and", "the", "'", "repopulateField", "'", "*", "property", "is", "set", "to", "\"", "true", "\"", ".", "*", "*", "*", "<", "p", "/", ">", "*", "*", "*", "*", "<", "!-", "-", "START", "SNIPPET", ":", "javadoc", "-", "->", "*", "*", "The", "capability", "of", "auto", "-", "repopulating", "the", "stack", "with", "a", "fake", "parameter", "map", "when", "*", "a", "conversion", "error", "has", "occurred", "can", "be", "done", "with", "'", "repopulateField", "'", "property", "*", "set", "to", "\"", "true", "\"", ".", "*", "The", "capability", "of", "auto", "-", "repopulating", "the", "stack", "with", "a", "fake", "parameter", "map", "when", "*", "a", "conversion", "error", "has", "occurred", "can", "be", "done", "with", "'", "repopulateField", "'", "property", "*", "set", "to", "\"", "true", "\"", ".", "*", "*", "<", "p", "/", ">", "*", "*", "This", "is", "typically", "usefull", "when", "one", "wants", "to", "repopulate", "the", "field", "with", "the", "original", "value", "*", "when", "a", "conversion", "error", "occurred", ".", "Eg", ".", "with", "a", "textfield", "that", "only", "allows", "an", "Integer", "*", "This", "is", "typically", "usefull", "when", "one", "wants", "to", "repopulate", "the", "field", "with", "the", "original", "value", "*", "when", "a", "conversion", "error", "occurred", ".", "Eg", ".", "with", "a", "textfield", "that", "only", "allows", "an", "Integer", "*", "(", "the", "action", "class", "have", "an", "Integer", "field", "declared", ")", ",", "upon", "conversion", "error", ",", "the", "incorrectly", "*", "entered", "integer", "(", "maybe", "a", "text", "'", "one", "'", ")", "will", "not", "appear", "when", "dispatched", "back", ".", "With", "'", "repopulateField", "'", "*", "porperty", "set", "to", "true", ",", "it", "will", ",", "meaning", "the", "textfield", "will", "have", "'", "one", "'", "as", "its", "value", "*", "porperty", "set", "to", "true", ",", "it", "will", ",", "meaning", "the", "textfield", "will", "have", "'", "one", "'", "as", "its", "value", "*", "upon", "conversion", "error", ".", "*", "*", "*", "<", "!-", "-", "END", "SNIPPET", ":", "javadoc", "-", "->", "*", "*", "*", "<", "p", "/", ">", "*", "*", "*", "<", "pre", ">", "*", "<", "!-", "-", "START", "SNIPPET", ":", "exampleJspPage", "-", "->", "*", "*", "*", "&", "lt", ";", "!-", "-", "myJspPage", ".", "jsp", "-", "-&", "gt", ";", "*", "&", "lt", ";", "ww", ":", "form", "action", "=", "\"", "someAction", "\"", "method", "=", "\"", "POST", "\"", "&", "gt", ";", "*", ".", "..", ".", "*", "&", "lt", ";", "ww", ":", "textfield", "*", "&", "lt", ";", "ww", ":", "textfield", "*", "label", "=", "\"", "My", "Integer", "Field", "\"", "*", "name", "=", "\"", "myIntegerField", "\"", "/", "&", "gt", ";", "*", ".", "..", ".", "*", "&", "lt", ";", "ww", ":", "submit", "/", "&", "gt", ";", "*", "&", "lt", ";", "ww", ":", "submit", "/", "&", "gt", ";", "*", "&", "lt", ";", "/", "ww", ":", "form", "&", "gt", ";", "*", "*", "*", "<", "!-", "-", "END", "SNIPPET", ":", "exampleJspPage", "-", "->", "*", "<", "/", "pre", ">", "*", "*", "*", "<", "pre", ">", "*", "<", "!-", "-", "START", "SNIPPET", ":", "exampleXwork", "-", "->", "*", "*", "*", "&", "lt", ";", "!-", "-", "xwork", ".", "xml", "-", "-&", "gt", ";", "*", "&", "lt", ";", "xwork", "&", "gt", ";", "*", "&", "lt", ";", "include", "file", "=", "\"", "xwork", "-", "default", ".", "xml", "\"", "/", "&", "gt", ";", "@", "@", "-", "88", ",", "31", "+", "89", ",", "31", "@", "@", "*", "&", "lt", ";", "/", "package", "&", "gt", ";", "*", ".", "..", ".", "*", "&", "lt", ";", "/", "xwork", "&", "gt", ";", "*", "*", "*", "<", "!-", "-", "END", "SNIPPET", ":", "exampleXwork", "-", "->", "*", "<", "/", "pre", ">", "*", "*", "*", "*", "*", "<", "pre", ">", "*", "<", "!-", "-", "START", "SNIPPET", ":", "exampleJava", "-", "->", "*", "*", "*", "&", "lt", ";", "!-", "-", "MyActionSupport", ".", "java", "-", "-&", "gt", ";", "*", "public", "class", "MyActionSupport", "extends", "ActionSupport", "{", "*", "private", "Integer", "myIntegerField", ";", "*", "*", "*", "public", "Integer", "getMyIntegerField", "(", ")", "{", "return", "this", ".", "myIntegerField", ";", "}", "*", "public", "void", "setMyIntegerField", "(", "Integer", "myIntegerField", ")", "{", "*", "this", ".", "myIntegerField", "=", "myIntegerField", ";", "*", "public", "void", "setMyIntegerField", "(", "Integer", "myIntegerField", ")", "{", "*", "this", ".", "myIntegerField", "=", "myIntegerField", ";", "*", "}", "*", "}", "*", "*", "*", "<", "!-", "-", "END", "SNIPPET", ":", "exampleJava", "-", "->", "*", "<", "/", "pre", ">", "*", "*", "*", "*", "*", "<", "pre", ">", "*", "<", "!-", "-", "START", "SNIPPET", ":", "exampleValidation", "-", "->", "*", "*", "*", "&", "lt", ";", "!-", "-", "MyActionSupport", "-", "someAction", "-", "validation", ".", "xml", "-", "-&", "gt", ";", "*", "&", "lt", ";", "validators", "&", "gt", ";", "*", ".", "..", "@", "@", "-", "124", ",", "43", "+", "125", ",", "43", "@", "@", "*", "&", "lt", ";", "/", "field", "&", "gt", ";", "*", ".", "..", "*", "&", "lt", ";", "/", "validators", "&", "gt", ";", "*", "*", "*", "<", "!-", "-", "END", "SNIPPET", ":", "exampleValidation", "-", "->", "*", "<", "/", "pre", ">", "*", "*", "*", "@", "author", "tm_jee", "*", "@", "version", "$", "Date", "$", "$", "Id", "$", "*", "/", "public", "abstract", "class", "RepopulateConversionErrorFieldValidatorSupport", "extends", "FieldValidatorSupport", "{", "private", "static", "final", "Logger", "LOG", "=", "LoggerFactory", ".", "getLogger", "(", "RepopulateConversionErrorFieldValidatorSupport", ".", "class", ")", ";", "private", "String", "repopulateFieldAsString", "=", "\"", "false", "\"", ";", "private", "boolean", "repopulateFieldAsBoolean", "=", "false", ";", "public", "String", "getRepopulateField", "(", ")", "{", "return", "repopulateFieldAsString", ";", "}", "public", "void", "setRepopulateField", "(", "String", "repopulateField", ")", "{", "this", ".", "repopulateFieldAsString", "=", "repopulateField", "=", "=", "null", "?", "repopulateField", ":", "repopulateField", ".", "trim", "(", ");", "this", ".", "repopulateFieldAsBoolean", "=", "\"", "true", "\"", ".", "equalsIgnoreCase", "(", "this", ".", "repopulateFieldAsString", ")", "?", "(", "true", ")", ":", "(", "false", ")", ";", "}", "public", "void", "validate", "(", "Object", "object", ")", "throws", "ValidationException", "{", "doValidate", "(", "object", ")", ";", "if", "(", "repopulateFieldAsBoolean", ")", "{", "repopulateField", "(", "object", ")", ";", "}", "}", "public", "void", "repopulateField", "(", "Object", "object", ")", "throws", "ValidationException", "{", "ActionInvocation", "invocation", "=", "ActionContext", ".", "getContext", "(", ").", "getActionInvocation", "(", ");", "Map", "<", "String", ",", "Object", ">", "conversionErrors", "=", "ActionContext", ".", "getContext", "(", ").", "getConversionErrors", "(", ");", "String", "fieldName", "=", "getFieldName", "(", ");", "String", "fullFieldName", "=", "getValidatorContext", "(", ").", "getFullFieldName", "(", "fieldName", ")", ";", "private", "static", "final", "Logger", "LOG", "=", "LoggerFactory", ".", "getLogger", "(", "RepopulateConversionErrorFieldValidatorSupport", ".", "class", ")", ";", "private", "String", "repopulateFieldAsString", "=", "\"", "false", "\"", ";", "private", "boolean", "repopulateFieldAsBoolean", "=", "false", ";", "public", "String", "getRepopulateField", "(", ")", "{", "return", "repopulateFieldAsString", ";", "}", "public", "void", "setRepopulateField", "(", "String", "repopulateField", ")", "{", "this", ".", "repopulateFieldAsString", "=", "repopulateField", "=", "=", "null", "?", "repopulateField", ":", "repopulateField", ".", "trim", "(", ");", "this", ".", "repopulateFieldAsBoolean", "=", "\"", "true", "\"", ".", "equalsIgnoreCase", "(", "this", ".", "repopulateFieldAsString", ")", "?", "(", "true", ")", ":", "(", "false", ")", ";", "}", "public", "void", "validate", "(", "Object", "object", ")", "throws", "ValidationException", "{", "doValidate", "(", "object", ")", ";", "if", "(", "repopulateFieldAsBoolean", ")", "{", "repopulateField", "(", "object", ")", ";", "}", "}", "public", "void", "repopulateField", "(", "Object", "object", ")", "throws", "ValidationException", "{", "ActionInvocation", "invocation", "=", "ActionContext", ".", "getContext", "(", ").", "getActionInvocation", "(", ");", "Map", "<", "String", ",", "Object", ">", "conversionErrors", "=", "ActionContext", ".", "getContext", "(", ").", "getConversionErrors", "(", ");", "String", "fieldName", "=", "getFieldName", "(", ");", "String", "fullFieldName", "=", "getValidatorContext", "(", ").", "getFullFieldName", "(", "fieldName", ")", ";", "if", "(", "conversionErrors", ".", "containsKey", "(", "fullFieldName", ")", ")", "{", "Object", "value", "=", "conversionErrors", ".", "get", "(", "fullFieldName", ")", ";", "@", "@", "-", "170", ",", "18", "+", "171", ",", "18", "@", "@", "public", "void", "repopulateField", "(", "Object", "object", ")", "throws", "ValidationException", "{", "if", "(", "value", "instanceof", "String", "[", "])", "{", "/", "/", "take", "the", "first", "element", ",", "if", "possible", "String", "[", "]", "tmpValue", "=", "(", "String", "[", "])", "value", ";", "if", "(", "tmpValue", "!", "=", "null", "&", "&", "(", "tmpValue", ".", "length", ">", "0", ")", ")", "{", "if", "(", "(", "tmpValue", ".", "length", ">", "0", ")", ")", "{", "doExprOverride", "=", "true", ";", "fakeParams", ".", "put", "(", "fullFieldName", ",", "\"", "'\"", "+", "tmpValue", "[", "0", "]", "+", "\"", "'\"", ");", "fakeParams", ".", "put", "(", "fullFieldName", ",", "escape", "(", "tmpValue", "[", "0", "]", "))", ";", "}", "else", "{", "if", "(", "LOG", ".", "isWarnEnabled", "(", "))", "{", "LOG", ".", "warn", "(", "\"", "value", "is", "an", "empty", "array", "of", "String", "or", "with", "first", "element", "in", "it", "as", "null", "[", "\"", "+", "value", "+", "\"", "],", "will", "not", "repopulate", "conversion", "error", "\"", ");", "LOG", ".", "warn", "(", "\"", "value", "is", "an", "empty", "array", "of", "String", "or", "with", "first", "element", "in", "it", "as", "null", "[", "\"", "+", "value", "+", "\"", "],", "will", "not", "repopulate", "conversion", "error", "\"", ");", "}", "}", "}", "else", "if", "(", "value", "instanceof", "String", ")", "{", "String", "tmpValue", "=", "(", "String", ")", "value", ";", "doExprOverride", "=", "true", ";", "fakeParams", ".", "put", "(", "fullFieldName", ",", "\"", "'\"", "+", "tmpValue", "+", "\"", "'\"", ");", "fakeParams", ".", "put", "(", "fullFieldName", ",", "escape", "(", "tmpValue", ")", ");", "}", "else", "{", "/", "/", "opps", ".", "..", "it", "should", "be", "if", "(", "LOG", ".", "isWarnEnabled", "(", "))", "{", "@", "@", "-", "198", ",", "7", "+", "199", ",", "11", "@", "@", "public", "void", "beforeResult", "(", "ActionInvocation", "invocation", ",", "String", "resultCode", ")", "{", "}", ");", "}", "}", "}", "protected", "abstract", "void", "doValidate", "(", "Object", "object", ")", "throws", "ValidationException", ";", "}", "protected", "String", "escape", "(", "String", "value", ")", "{", "return", "\"", "\\\"", "\"", "+", "StringEscapeUtils", ".", "escapeJava", "(", "value", ")", "+", "\"", "\\\"", "\";", "}", "protected", "abstract", "void", "doValidate", "(", "Object", "object", ")", "throws", "ValidationException", ";", "}", "@", "@", "-", "35", ",", "7", "+", "35", ",", "7", "@", "@", "protected", "ActionContext", "context", ";", "protected", "ActionInvocation", "invocation", ";", "protected", "ConversionErrorInterceptor", "interceptor", ";", "protected", "Map", "<", "String", ",", "Object", ">", "conversionErrors", ";", "protected", "Map", "<", "String", ",", "Object", ">", "conversionErrors", ";", "protected", "Mock", "mockInvocation", ";", "protected", "ValueStack", "stack", ";", "@", "@", "-", "86", ",", "10", "+", "86", ",", "11", "@", "@", "public", "void", "testWithPreResultListener", "(", ")", "throws", "Exception", "{", "/", "**", "*", "See", "WW", "-", "3668", "*", "*", "@", "throws", "Exception", "*", "/", "public", "void", "testWithPreResultListenerAgainstMaliciousCode", "(", ")", "throws", "Exception", "{", "conversionErrors", ".", "put", "(", "\"", "foo", "\"", ",", "\"", "'", "+", "#", "root", "+", "'", "\")", ";", "conversionErrors", ".", "put", "(", "\"", "foo", "\"", ",", "\"", "\\\"", "+", "#", "root", "+", "\\", "\"\"", ");", "ActionContext", "ac", "=", "createActionContext", "(", ");", "@", "@", "-", "104", ",", "7", "+", "105", ",", "7", "@", "@", "public", "void", "testWithPreResultListenerAgainstMaliciousCode", "(", ")", "throws", "Exception", "{", "assertTrue", "(", "action", ".", "hasFieldErrors", "(", "))", ";", "assertNotNull", "(", "action", ".", "getFieldErrors", "(", ").", "get", "(", "\"", "foo", "\"", "))", ";", "assertEquals", "(", "\"'", "+", "#", "root", "+", "'", "\",", "stack", ".", "findValue", "(", "\"", "foo", "\"", "))", ";", "assertEquals", "(", "\"\\", "\"", "+", "#", "root", "+", "\\", "\"\"", ",", "stack", ".", "findValue", "(", "\"", "foo", "\"", "))", ";", "}", "private", "MockActionInvocation", "createActionInvocation", "(", "ActionContext", "ac", ")", "{", "@", "@", "-", "137", ",", "7", "+", "138", ",", "7", "@", "@", "protected", "void", "setUp", "(", ")", "throws", "Exception", "{", "invocation", "=", "(", "ActionInvocation", ")", "mockInvocation", ".", "proxy", "(", ");", "stack", "=", "ActionContext", ".", "getContext", "(", ").", "getValueStack", "(", ");", "context", "=", "new", "ActionContext", "(", "stack", ".", "getContext", "(", "))", ";", "conversionErrors", "=", "new", "HashMap", "<", "String", ",", "Object", ">", "()", ";", "conversionErrors", "=", "new", "HashMap", "<", "String", ",", "Object", ">", "()", ";", "context", ".", "setConversionErrors", "(", "conversionErrors", ")", ";", "mockInvocation", ".", "matchAndReturn", "(", "\"", "getInvocationContext", "\"", ",", "context", ")", ";", "mockInvocation", ".", "expect", "(", "\"", "addPreResultListener", "\"", ",", "C", ".", "isA", "(", "PreResultListener", ".", "class", ")", ");"], "docstring_tokens": ["via", "invalid", "input", "to", "a", "field", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "56", ",", "6", "+", "56", ",", "11", "@", "@", "private", "final", "Logger", "log", "=", "getLogger", "(", "getClass", "(", "))", ";", "private", "static", "final", "String", "EVENTTIME_TAGNAME", "=", "\"", "eventTime", "\"", ";", "private", "static", "final", "String", "DISALLOW_DTD_FEATURE", "=", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", ";", "private", "static", "final", "String", "DISALLOW_EXTERNAL_DTD", "=", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "nonvalidating", "/", "load", "-", "external", "-", "dtd", "\"", ";", "@", "Override", "public", "Collection", "<", "Alarm", ">", "translateToAlarm", "(", "DeviceId", "deviceId", ",", "InputStream", "message", ")", "{", "try", "{", "@", "@", "-", "93", ",", "10", "+", "98", ",", "25", "@", "@", "private", "Document", "createDocFromMessage", "(", "InputStream", "message", ")", "throws", "SAXException", ",", "IOException", ",", "ParserConfigurationException", "{", "DocumentBuilderFactory", "dbfactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "/", "/", "Disabling", "DTDs", "in", "order", "to", "avoid", "XXE", "xml", "-", "based", "attacks", ".", "disableFeature", "(", "dbfactory", ",", "DISALLOW_DTD_FEATURE", ")", ";", "disableFeature", "(", "dbfactory", ",", "DISALLOW_EXTERNAL_DTD", ")", ";", "dbfactory", ".", "setXIncludeAware", "(", "false", ")", ";", "dbfactory", ".", "setExpandEntityReferences", "(", "false", ")", ";", "DocumentBuilder", "builder", "=", "dbfactory", ".", "newDocumentBuilder", "(", ");", "return", "builder", ".", "parse", "(", "new", "InputSource", "(", "message", ")", ");", "}", "private", "void", "disableFeature", "(", "DocumentBuilderFactory", "dbfactory", ",", "String", "feature", ")", "{", "try", "{", "dbfactory", ".", "setFeature", "(", "feature", ",", "true", ")", ";", "}", "catch", "(", "ParserConfigurationException", "e", ")", "{", "/", "/", "This", "should", "catch", "a", "failed", "setFeature", "feature", "log", ".", "info", "(", "\"", "ParserConfigurationException", "was", "thrown", ".", "The", "feature", "'", "\"", "feature", "+", "\"", "'", "is", "probably", "not", "supported", "by", "your", "XML", "processor", ".", "\")", ";", "}", "}", "private", "long", "parseDate", "(", "String", "timeStr", ")", "throws", "UnsupportedOperationException", ",", "IllegalArgumentException", "{", "return", "DateTimeFormatter", ".", "ISO_DATE_TIME", ".", "parse", "(", "timeStr", ",", "Instant", ":", ":", "from", ")", ".", "getEpochSecond", "(", ");", "@", "@", "-", "111", ",", "4", "+", "131", ",", "4", "@", "@", "private", "static", "String", "nodeToString", "(", "Node", "rootNode", ")", "throws", "TransformerException", "{", "transformer", ".", "transform", "(", "source", ",", "new", "StreamResult", "(", "writer", ")", ");", "return", "writer", ".", "getBuffer", "(", ").", "toString", "(", ");", "}", "}", "}", "\\", "No", "newline", "at", "end", "of", "file"], "docstring_tokens": ["sending", "a", "specially", "crafted", "protocol", "message"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "404", ",", "12", "+", "404", ",", "7", "@", "@", "protected", "URIResolver", "getURIResolver", "(", ")", "{", "ServletActionContext", ".", "getServletContext", "(", "))", ";", "}", "protected", "Templates", "getTemplates", "(", "String", "path", ")", "throws", "TransformerException", ",", "IOException", "{", "String", "pathFromRequest", "=", "ServletActionContext", ".", "getRequest", "(", ").", "getParameter", "(", "\"", "xslt", ".", "location", "\"", ");", "if", "(", "pathFromRequest", "!", "=", "null", ")", "path", "=", "pathFromRequest", ";", "protected", "Templates", "getTemplates", "(", "final", "String", "path", ")", "throws", "TransformerException", ",", "IOException", "{", "if", "(", "path", "=", "=", "null", ")", "throw", "new", "TransformerException", "(", "\"", "Stylesheet", "path", "is", "null", "\"", ");"], "docstring_tokens": ["via", "the", "stylesheet", "location", "parameter", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "22", ",", "19", "+", "22", ",", "28", "@", "@", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "import", "java", ".", "io", ".", "OutputStream", ";", "import", "java", ".", "io", ".", "UnsupportedEncodingException", ";", "import", "java", ".", "util", ".", "Date", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "LinkedHashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "TreeMap", ";", "import", "org", ".", "apache", ".", "commons", ".", "collections4", ".", "bidimap", ".", "TreeBidiMap", ";", "import", "org", ".", "apache", ".", "poi", ".", "hpsf", ".", "wellknown", ".", "PropertyIDMap", ";", "import", "org", ".", "apache", ".", "poi", ".", "hpsf", ".", "wellknown", ".", "SectionIDMap", ";", "import", "org", ".", "apache", ".", "poi", ".", "util", ".", "CodePageUtil", ";", "import", "org", ".", "apache", ".", "poi", ".", "util", ".", "LittleEndian", ";", "import", "org", ".", "apache", ".", "poi", ".", "util", ".", "LittleEndianByteArrayInputStream", ";", "import", "org", ".", "apache", ".", "poi", ".", "util", ".", "LittleEndianConsts", ";", "import", "org", ".", "apache", ".", "poi", ".", "util", ".", "POILogFactory", ";", "import", "org", ".", "apache", ".", "poi", ".", "util", ".", "POILogger", ";", "/", "**", "*", "Represents", "a", "section", "in", "a", "{", "@", "link", "PropertySet", "}", ".", "*", "/", "public", "class", "Section", "{", "private", "static", "final", "POILogger", "LOG", "=", "POILogFactory", ".", "getLogger", "(", "Section", ".", "class", ")", ";", "/", "**", "*", "Maps", "property", "IDs", "to", "section", "-", "private", "PID", "strings", ".", "These", "@", "@", "-", "62", ",", "7", "+", "71", ",", "7", "@", "@", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "/", "**", "*", "The", "offset", "of", "the", "section", "in", "the", "stream", ".", "*", "/", "private", "long", "offset", "=", "-", "1", ";", "private", "final", "long", "_offset", ";", "/", "**", "*", "The", "section", "'", "s", "size", "in", "bytes", ".", "@", "@", "-", "72", ",", "7", "+", "81", ",", "7", "@", "@", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "/", "**", "*", "This", "section", "'", "s", "properties", ".", "*", "/", "private", "final", "Map", "<", "Long", ",", "Property", ">", "properties", "=", "new", "TreeMap", "<", "Long", ",", "Property", ">", "()", ";", "private", "final", "Map", "<", "Long", ",", "Property", ">", "properties", "=", "new", "LinkedHashMap", "<", "Long", ",", "Property", ">", "()", ";", "/", "**", "*", "This", "member", "is", "{", "@", "code", "true", "}", "if", "the", "last", "call", "to", "{", "@", "link", "@", "@", "-", "85", ",", "6", "+", "94", ",", "7", "@", "@", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "Creates", "an", "empty", "{", "@", "link", "Section", "}", ".", "*", "/", "public", "Section", "(", ")", "{", "this", ".", "_offset", "=", "-", "1", ";", "}", "/", "**", "@", "@", "-", "96", ",", "6", "+", "106", ",", "7", "@", "@", "public", "Section", "(", ")", "{", "*", "@", "param", "s", "The", "section", "set", "to", "copy", "*", "/", "public", "Section", "(", "final", "Section", "s", ")", "{", "this", ".", "_offset", "=", "-", "1", ";", "setFormatID", "(", "s", ".", "getFormatID", "(", "))", ";", "for", "(", "Property", "p", ":", "s", ".", "properties", ".", "values", "(", "))", "{", "properties", ".", "put", "(", "p", ".", "getID", "(", "),", "new", "MutableProperty", "(", "p", ")", ");", "@", "@", "-", "117", ",", "32", "+", "128", ",", "38", "@", "@", "public", "Section", "(", "final", "Section", "s", ")", "{", "*", "/", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "public", "Section", "(", "final", "byte", "[", "]", "src", ",", "final", "int", "offset", ")", "throws", "UnsupportedEncodingException", "{", "int", "o1", "=", "offset", ";", "/", "*", "*", "Read", "the", "format", "ID", ".", "*", "/", "formatID", "=", "new", "ClassID", "(", "src", ",", "o1", ")", ";", "o1", "+", "=", "ClassID", ".", "LENGTH", ";", "formatID", "=", "new", "ClassID", "(", "src", ",", "offset", ")", ";", "/", "*", "*", "Read", "the", "offset", "from", "the", "stream", "'", "s", "start", "and", "positions", "to", "*", "the", "section", "header", ".", "*", "/", "this", ".", "offset", "=", "LittleEndian", ".", "getUInt", "(", "src", ",", "o1", ")", ";", "o1", "=", "(", "int", ")", "this", ".", "offset", ";", "int", "offFix", "=", "(", "int", ")", "LittleEndian", ".", "getUInt", "(", "src", ",", "offset", "+", "ClassID", ".", "LENGTH", ")", ";", "/", "/", "some", "input", "files", "have", "a", "invalid", "(", "padded", "?", ")", "offset", ",", "which", "need", "to", "be", "fixed", "/", "/", "search", "for", "beginning", "of", "size", "field", "if", "(", "src", "[", "offFix", "]", "=", "=", "0", ")", "{", "for", "(", "int", "i", "=", "0", ";", "i", "<", "3", "&", "&", "src", "[", "offFix", "]", "=", "=", "0", ";", "i", "+", "+,", "offFix", "+", "+)", ";", "/", "/", "cross", "check", "with", "propertyCount", "field", "and", "the", "property", "list", "field", "for", "(", "int", "i", "=", "0", ";", "i", "<", "3", "&", "&", "(", "src", "[", "offFix", "+", "3", "]", "!", "=", "0", "|", "|", "src", "[", "offFix", "+", "7", "]", "!", "=", "0", "|", "|", "src", "[", "offFix", "+", "11", "]", "!", "=", "0", ")", ";", "i", "+", "+,", "offFix", "-", "-)", ";", "}", "this", ".", "_offset", "=", "offFix", ";", "LittleEndianByteArrayInputStream", "leis", "=", "new", "LittleEndianByteArrayInputStream", "(", "src", ",", "offFix", ")", ";", "/", "*", "*", "Read", "the", "section", "length", ".", "*", "/", "size", "=", "(", "int", ")", "LittleEndian", ".", "getUInt", "(", "src", ",", "o1", ")", ";", "o1", "+", "=", "LittleEndian", ".", "INT_SIZE", ";", "size", "=", "(", "int", ")", "leis", ".", "readUInt", "(", ");", "/", "*", "*", "Read", "the", "number", "of", "properties", ".", "*", "/", "final", "int", "propertyCount", "=", "(", "int", ")", "LittleEndian", ".", "getUInt", "(", "src", ",", "o1", ")", ";", "o1", "+", "=", "LittleEndian", ".", "INT_SIZE", ";", "final", "int", "propertyCount", "=", "(", "int", ")", "leis", ".", "readUInt", "(", ");", "/", "*", "*", "Read", "the", "properties", ".", "The", "offset", "is", "positioned", "at", "the", "first", "@", "@", "-", "169", ",", "64", "+", "186", ",", "65", "@", "@", "public", "Section", "(", "final", "byte", "[", "]", "src", ",", "final", "int", "offset", ")", "throws", "UnsupportedEncodingExc", "*", "seconds", "pass", "reads", "the", "other", "properties", ".", "*", "/", "/", "*", "Pass", "1", ":", "Read", "the", "property", "list", ".", "*", "/", "int", "pass1Offset", "=", "o1", ";", "long", "cpOffset", "=", "-", "1", ";", "final", "TreeBidiMap", "<", "Long", ",", "Long", ">", "offset2Id", "=", "new", "TreeBidiMap", "<", "Long", ",", "Long", ">", "()", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "propertyCount", ";", "i", "+", "+)", "{", "/", "*", "Read", "the", "property", "ID", ".", "*", "/", "long", "id", "=", "LittleEndian", ".", "getUInt", "(", "src", ",", "pass1Offset", ")", ";", "pass1Offset", "+", "=", "LittleEndian", ".", "INT_SIZE", ";", "long", "id", "=", "(", "int", ")", "leis", ".", "readUInt", "(", ");", "/", "*", "Offset", "from", "the", "section", "'", "s", "start", ".", "*", "/", "long", "off", "=", "LittleEndian", ".", "getUInt", "(", "src", ",", "pass1Offset", ")", ";", "pass1Offset", "+", "=", "LittleEndian", ".", "INT_SIZE", ";", "long", "off", "=", "(", "int", ")", "leis", ".", "readUInt", "(", ");", "offset2Id", ".", "put", "(", "off", ",", "id", ")", ";", "if", "(", "id", "=", "=", "PropertyIDMap", ".", "PID_CODEPAGE", ")", "{", "cpOffset", "=", "off", ";", "}", "}", "Long", "cpOffset", "=", "offset2Id", ".", "getKey", "(", "(", "long", ")", "PropertyIDMap", ".", "PID_CODEPAGE", ")", ";", "/", "*", "Look", "for", "the", "codepage", ".", "*", "/", "int", "codepage", "=", "-", "1", ";", "if", "(", "cpOffset", "!", "=", "-", "1", ")", "{", "if", "(", "cpOffset", "!", "=", "null", ")", "{", "/", "*", "Read", "the", "property", "'", "s", "value", "type", ".", "It", "must", "be", "VT_I2", ".", "*", "/", "long", "o", "=", "this", ".", "offset", "+", "cpOffset", ";", "final", "long", "type", "=", "LittleEndian", ".", "getUInt", "(", "src", ",", "(", "int", ")", "o", ")", ";", "o", "+", "=", "LittleEndian", ".", "INT_SIZE", ";", "leis", ".", "setReadIndex", "(", "(", "int", ")", "(", "this", ".", "_offset", "+", "cpOffset", ")", ");", "final", "long", "type", "=", "leis", ".", "readUInt", "(", ");", "if", "(", "type", "!", "=", "Variant", ".", "VT_I2", ")", "{", "throw", "new", "HPSFRuntimeException", "(", "\"", "Value", "type", "of", "property", "ID", "1", "is", "not", "VT_I2", "but", "\"", "+", "type", "+", "\"", ".\"", ");", "(", "\"", "Value", "type", "of", "property", "ID", "1", "is", "not", "VT_I2", "but", "\"", "+", "type", "+", "\"", ".\"", ");", "}", "/", "*", "Read", "the", "codepage", "number", ".", "*", "/", "codepage", "=", "LittleEndian", ".", "getUShort", "(", "src", ",", "(", "int", ")", "o", ")", ";", "codepage", "=", "leis", ".", "readUShort", "(", ");", "}", "/", "*", "Pass", "2", ":", "Read", "all", "properties", "-", "including", "the", "codepage", "property", ",", "*", "if", "available", ".", "*", "/", "for", "(", "Map", ".", "Entry", "<", "Long", ",", "Long", ">", "me", ":", "offset2Id", ".", "entrySet", "(", "))", "{", "long", "off", "=", "me", ".", "getKey", "(", ");", "long", "id", "=", "me", ".", "getValue", "(", ");", "Property", "p", ";", "if", "(", "id", "=", "=", "PropertyIDMap", ".", "PID_CODEPAGE", ")", "{", "p", "=", "new", "Property", "(", "PropertyIDMap", ".", "PID_CODEPAGE", ",", "Variant", ".", "VT_I2", ",", "codepage", ")", ";", "int", "pLen", "=", "propLen", "(", "offset2Id", ",", "off", ",", "size", ")", ";", "leis", ".", "setReadIndex", "(", "(", "int", ")", "(", "this", ".", "_offset", "+", "off", ")", ");", "if", "(", "id", "=", "=", "PropertyIDMap", ".", "PID_DICTIONARY", ")", "{", "leis", ".", "mark", "(", "100000", ")", ";", "if", "(", "!", "readDictionary", "(", "leis", ",", "pLen", ",", "codepage", ")", ")", "{", "/", "/", "there", "was", "an", "error", "reading", "the", "dictionary", ",", "maybe", "because", "the", "pid", "(", "0", ")", "was", "used", "wrong", "/", "/", "try", "reading", "a", "property", "instead", "leis", ".", "reset", "(", ");", "try", "{", "/", "/", "fix", "id", "id", "=", "Math", ".", "max", "(", "PropertyIDMap", ".", "PID_MAX", ",", "offset2Id", ".", "inverseBidiMap", "(", ").", "lastKey", "(", "))", "+", "1", ";", "setProperty", "(", "new", "MutableProperty", "(", "id", ",", "leis", ",", "pLen", ",", "codepage", ")", ");", "}", "catch", "(", "RuntimeException", "e", ")", "{", "LOG", ".", "log", "(", "POILogger", ".", "INFO", ",", "\"", "Dictionary", "fallback", "failed", "-", "ignoring", "property", "\"", ");", "}", "}", ";", "}", "else", "if", "(", "id", "=", "=", "PropertyIDMap", ".", "PID_CODEPAGE", ")", "{", "setCodepage", "(", "codepage", ")", ";", "}", "else", "{", "int", "pLen", "=", "propLen", "(", "offset2Id", ",", "off", ",", "size", ")", ";", "long", "o", "=", "this", ".", "offset", "+", "off", ";", "p", "=", "new", "Property", "(", "id", ",", "src", ",", "o", ",", "pLen", ",", "codepage", ")", ";", "setProperty", "(", "new", "MutableProperty", "(", "id", ",", "leis", ",", "pLen", ",", "codepage", ")", ");", "}", "properties", ".", "put", "(", "id", ",", "p", ")", ";", "}", "/", "*", "*", "Extract", "the", "dictionary", "(", "if", "available", ")", ".", "*", "/", "dictionary", "=", "(", "Map", "<", "Long", ",", "String", ">", ")", "getProperty", "(", "0", ")", ";", "}", "/", "**", "@", "@", "-", "291", ",", "7", "+", "309", ",", "7", "@", "@", "public", "void", "setFormatID", "(", "final", "byte", "[", "]", "formatID", ")", "{", "*", "@", "return", "The", "offset", "of", "the", "section", "in", "the", "stream", ".", "*", "/", "public", "long", "getOffset", "(", ")", "{", "return", "offset", ";", "return", "_offset", ";", "}", "/", "**", "@", "@", "-", "344", ",", "11", "+", "362", ",", "10", "@", "@", "public", "Object", "getProperty", "(", "final", "long", "id", ")", "{", "*", "Sets", "the", "string", "value", "of", "the", "property", "with", "the", "specified", "ID", ".", "*", "*", "@", "param", "id", "The", "property", "'", "s", "ID", "*", "@", "param", "value", "The", "property", "'", "s", "value", ".", "It", "will", "be", "written", "as", "a", "Unicode", "*", "string", ".", "*", "@", "param", "value", "The", "property", "'", "s", "value", ".", "*", "/", "public", "void", "setProperty", "(", "final", "int", "id", ",", "final", "String", "value", ")", "{", "setProperty", "(", "id", ",", "Variant", ".", "VT_LPWSTR", ",", "value", ")", ";", "setProperty", "(", "id", ",", "Variant", ".", "VT_LPSTR", ",", "value", ")", ";", "}", "/", "**", "@", "@", "-", "411", ",", "8", "+", "428", ",", "9", "@", "@", "public", "void", "setProperty", "(", "final", "int", "id", ",", "final", "boolean", "value", ")", "{", "*", "@", "see", "#", "getProperty", "*", "@", "see", "Variant", "*", "/", "@", "SuppressWarnings", "(", "\"", "deprecation", "\"", ")", "public", "void", "setProperty", "(", "final", "int", "id", ",", "final", "long", "variantType", ",", "final", "Object", "value", ")", "{", "setProperty", "(", "new", "Property", "(", "id", ",", "variantType", ",", "value", ")", ");", "setProperty", "(", "new", "MutableProperty", "(", "id", ",", "variantType", ",", "value", ")", ");", "}", "@", "@", "-", "591", ",", "11", "+", "609", ",", "12", "@", "@", "public", "boolean", "wasNull", "(", ")", "{", "*", "/", "public", "String", "getPIDString", "(", "final", "long", "pid", ")", "{", "String", "s", "=", "null", ";", "if", "(", "dictionary", "!", "=", "null", ")", "{", "s", "=", "dictionary", ".", "get", "(", "Long", ".", "valueOf", "(", "pid", ")", ");", "Map", "<", "Long", ",", "String", ">", "dic", "=", "getDictionary", "(", ");", "if", "(", "dic", "!", "=", "null", ")", "{", "s", "=", "dic", ".", "get", "(", "pid", ")", ";", "}", "if", "(", "s", "=", "=", "null", ")", "{", "s", "=", "SectionIDMap", ".", "getPIDString", "(", "getFormatID", "(", ").", "getBytes", "(", "),", "pid", ")", ";", "s", "=", "SectionIDMap", ".", "getPIDString", "(", "getFormatID", "(", "),", "pid", ")", ";", "}", "return", "s", ";", "}", "@", "@", "-", "614", ",", "19", "+", "633", ",", "6", "@", "@", "public", "void", "clear", "(", ")", "}", "}", "/", "**", "*", "Sets", "the", "codepage", ".", "*", "*", "@", "param", "codepage", "the", "codepage", "*", "/", "public", "void", "setCodepage", "(", "final", "int", "codepage", ")", "{", "setProperty", "(", "PropertyIDMap", ".", "PID_CODEPAGE", ",", "Variant", ".", "VT_I2", ",", "Integer", ".", "valueOf", "(", "codepage", ")", ");", "}", "/", "**", "*", "Checks", "whether", "this", "section", "is", "equal", "to", "another", "object", ".", "The", "result", "is", "*", "{", "@", "code", "false", "}", "if", "one", "of", "the", "the", "following", "conditions", "holds", ":", "@", "@", "-", "651", ",", "68", "+", "657", ",", "36", "@", "@", "public", "void", "setCodepage", "(", "final", "int", "codepage", ")", "*", "@", "return", "{", "@", "code", "true", "}", "if", "the", "objects", "are", "equal", ",", "{", "@", "code", "false", "}", "if", "*", "not", "*", "/", "@", "Override", "public", "boolean", "equals", "(", "final", "Object", "o", ")", "{", "if", "(", "o", "=", "=", "null", "|", "|", "!", "(", "o", "instanceof", "Section", ")", ")", "{", "if", "(", "!(", "o", "instanceof", "Section", ")", ")", "{", "return", "false", ";", "}", "final", "Section", "s", "=", "(", "Section", ")", "o", ";", "if", "(", "!", "s", ".", "getFormatID", "(", ").", "equals", "(", "getFormatID", "(", "))", ")", "{", "return", "false", ";", "}", "/", "*", "Compare", "all", "properties", "except", "0", "and", "1", "as", "they", "must", "be", "handled", "*", "specially", ".", "*", "/", "Property", "[", "]", "pa1", "=", "new", "Property", "[", "getProperties", "(", ").", "length", "]", ";", "Property", "[", "]", "pa2", "=", "new", "Property", "[", "s", ".", "getProperties", "(", ").", "length", "]", ";", "System", ".", "arraycopy", "(", "getProperties", "(", "),", "0", ",", "pa1", ",", "0", ",", "pa1", ".", "length", ")", ";", "System", ".", "arraycopy", "(", "s", ".", "getProperties", "(", "),", "0", ",", "pa2", ",", "0", ",", "pa2", ".", "length", ")", ";", "/", "*", "Extract", "properties", "0", "and", "1", "and", "remove", "them", "from", "the", "copy", "of", "the", "*", "arrays", ".", "*", "/", "Property", "p10", "=", "null", ";", "Property", "p20", "=", "null", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "pa1", ".", "length", ";", "i", "+", "+)", "{", "final", "long", "id", "=", "pa1", "[", "i", "]", ".", "getID", "(", ");", "if", "(", "id", "=", "=", "0", ")", "{", "p10", "=", "pa1", "[", "i", "]", ";", "pa1", "=", "remove", "(", "pa1", ",", "i", ")", ";", "i", "-", "-;", "}", "if", "(", "id", "=", "=", "1", ")", "{", "pa1", "=", "remove", "(", "pa1", ",", "i", ")", ";", "i", "-", "-;", "/", "*", "Compare", "all", "properties", "except", "the", "dictionary", "(", "id", "0", ")", "and", "*", "the", "codepage", "(", "id", "1", "/", "ignored", ")", "as", "they", "must", "be", "handled", "specially", ".", "*", "/", "Set", "<", "Long", ">", "propIds", "=", "new", "HashSet", "<", "Long", ">", "(", "properties", ".", "keySet", "(", "))", ";", "propIds", ".", "addAll", "(", "s", ".", "properties", ".", "keySet", "(", "))", ";", "propIds", ".", "remove", "(", "0L", ")", ";", "propIds", ".", "remove", "(", "1L", ")", ";", "for", "(", "Long", "id", ":", "propIds", ")", "{", "Property", "p1", "=", "properties", ".", "get", "(", "id", ")", ";", "Property", "p2", "=", "s", ".", "properties", ".", "get", "(", "id", ")", ";", "if", "(", "p1", "=", "=", "null", "|", "|", "p2", "=", "=", "null", "|", "|", "!", "p1", ".", "equals", "(", "p2", ")", ")", "{", "return", "false", ";", "}", "}", "for", "(", "int", "i", "=", "0", ";", "i", "<", "pa2", ".", "length", ";", "i", "+", "+)", "{", "final", "long", "id", "=", "pa2", "[", "i", "]", ".", "getID", "(", ");", "if", "(", "id", "=", "=", "0", ")", "{", "p20", "=", "pa2", "[", "i", "]", ";", "pa2", "=", "remove", "(", "pa2", ",", "i", ")", ";", "i", "-", "-;", "}", "if", "(", "id", "=", "=", "1", ")", "{", "pa2", "=", "remove", "(", "pa2", ",", "i", ")", ";", "i", "-", "-;", "}", "}", "/", "*", "If", "the", "number", "of", "properties", "(", "not", "counting", "property", "1", ")", "is", "unequal", "the", "*", "sections", "are", "unequal", ".", "*", "/", "if", "(", "pa1", ".", "length", "!", "=", "pa2", ".", "length", ")", "{", "return", "false", ";", "}", "/", "*", "If", "the", "dictionaries", "are", "unequal", "the", "sections", "are", "unequal", ".", "*", "/", "boolean", "dictionaryEqual", "=", "true", ";", "if", "(", "p10", "!", "=", "null", "&", "&", "p20", "!", "=", "null", ")", "{", "dictionaryEqual", "=", "p10", ".", "getValue", "(", ").", "equals", "(", "p20", ".", "getValue", "(", "))", ";", "}", "else", "if", "(", "p10", "!", "=", "null", "|", "|", "p20", "!", "=", "null", ")", "{", "dictionaryEqual", "=", "false", ";", "}", "if", "(", "dictionaryEqual", ")", "{", "return", "Util", ".", "equals", "(", "pa1", ",", "pa2", ")", ";", "}", "return", "false", ";", "Map", "<", "Long", ",", "String", ">", "d1", "=", "getDictionary", "(", ");", "Map", "<", "Long", ",", "String", ">", "d2", "=", "s", ".", "getDictionary", "(", ");", "return", "(", "d1", "=", "=", "null", "&", "&", "d2", "=", "=", "null", ")", "|", "|", "(", "d1", "!", "=", "null", "&", "&", "d2", "!", "=", "null", "&", "&", "d1", ".", "equals", "(", "d2", ")", ");", "}", "/", "**", "@", "@", "-", "724", ",", "22", "+", "698", ",", "6", "@", "@", "public", "void", "removeProperty", "(", "final", "long", "id", ")", "{", "dirty", "|", "=", "(", "properties", ".", "remove", "(", "id", ")", "!", "=", "null", ")", ";", "}", "/", "**", "*", "Removes", "a", "field", "from", "a", "property", "array", ".", "The", "resulting", "array", "is", "*", "compactified", "and", "returned", ".", "*", "*", "@", "param", "pa", "The", "property", "array", ".", "*", "@", "param", "i", "The", "index", "of", "the", "field", "to", "be", "removed", ".", "*", "@", "return", "the", "compactified", "array", ".", "*", "/", "private", "Property", "[", "]", "remove", "(", "final", "Property", "[", "]", "pa", ",", "final", "int", "i", ")", "{", "final", "Property", "[", "]", "h", "=", "new", "Property", "[", "pa", ".", "length", "-", "1", "]", ";", "if", "(", "i", ">", "0", ")", "{", "System", ".", "arraycopy", "(", "pa", ",", "0", ",", "h", ",", "0", ",", "i", ")", ";", "}", "System", ".", "arraycopy", "(", "pa", ",", "i", "+", "1", ",", "h", ",", "i", ",", "h", ".", "length", "-", "i", ")", ";", "return", "h", ";", "}", "/", "**", "*", "Writes", "this", "section", "into", "an", "output", "stream", ".", "<", "p", ">", "*", "@", "@", "-", "763", ",", "6", "+", "721", ",", "17", "@", "@", "public", "int", "write", "(", "final", "OutputStream", "out", ")", "throws", "WritingNotSupportedException", ",", "IO", "return", "sectionBytes", ".", "length", ";", "}", "/", "*", "Writing", "the", "section", "'", "s", "dictionary", "it", "tricky", ".", "If", "there", "is", "a", "dictionary", "*", "(", "property", "0", ")", "the", "codepage", "property", "(", "property", "1", ")", "must", "be", "set", ",", "too", ".", "*", "/", "int", "codepage", "=", "getCodepage", "(", ");", "if", "(", "codepage", "=", "=", "-", "1", ")", "{", "String", "msg", "=", "\"", "The", "codepage", "property", "is", "not", "set", "although", "a", "dictionary", "is", "present", ".", "\"", "\"", "Defaulting", "to", "ISO", "-", "8859", "-", "1", ".", "\";", "LOG", ".", "log", "(", "POILogger", ".", "WARN", ",", "msg", ")", ";", "codepage", "=", "Property", ".", "DEFAULT_CODEPAGE", ";", "}", "/", "*", "The", "properties", "are", "written", "to", "this", "stream", ".", "*", "/", "final", "ByteArrayOutputStream", "propertyStream", "=", "new", "ByteArrayOutputStream", "(", ");", "@", "@", "-", "777", ",", "79", "+", "746", ",", "120", "@", "@", "public", "int", "write", "(", "final", "OutputStream", "out", ")", "throws", "WritingNotSupportedException", ",", "IO", "/", "*", "Increase", "the", "position", "variable", "by", "the", "size", "of", "the", "property", "list", "so", "*", "that", "it", "points", "behind", "the", "property", "list", "and", "to", "the", "beginning", "of", "the", "*", "properties", "themselves", ".", "*", "/", "position", "+", "=", "2", "*", "LittleEndian", ".", "INT_SIZE", "+", "getPropertyCount", "(", ")", "*", "2", "*", "LittleEndian", ".", "INT_SIZE", ";", "position", "+", "=", "2", "*", "LittleEndianConsts", ".", "INT_SIZE", "+", "getPropertyCount", "(", ")", "*", "2", "*", "LittleEndianConsts", ".", "INT_SIZE", ";", "/", "*", "Writing", "the", "section", "'", "s", "dictionary", "it", "tricky", ".", "If", "there", "is", "a", "dictionary", "*", "(", "property", "0", ")", "the", "codepage", "property", "(", "property", "1", ")", "must", "be", "set", ",", "too", ".", "*", "/", "int", "codepage", "=", "-", "1", ";", "if", "(", "getProperty", "(", "PropertyIDMap", ".", "PID_DICTIONARY", ")", "!", "=", "null", ")", "{", "final", "Object", "p1", "=", "getProperty", "(", "PropertyIDMap", ".", "PID_CODEPAGE", ")", ";", "if", "(", "p1", "!", "=", "null", ")", "{", "if", "(", "!(", "p1", "instanceof", "Integer", ")", ")", "{", "throw", "new", "IllegalPropertySetDataException", "(", "\"", "The", "codepage", "property", "(", "ID", "=", "1", ")", "must", "be", "an", "\"", "+", "\"", "Integer", "object", ".", "\")", ";", "}", "}", "else", "{", "/", "*", "Warning", ":", "The", "codepage", "property", "is", "not", "set", "although", "a", "*", "dictionary", "is", "present", ".", "In", "order", "to", "cope", "with", "this", "problem", "we", "*", "add", "the", "codepage", "property", "and", "set", "it", "to", "Unicode", ".", "*", "/", "setProperty", "(", "PropertyIDMap", ".", "PID_CODEPAGE", ",", "Variant", ".", "VT_I2", ",", "Integer", ".", "valueOf", "(", "CodePageUtil", ".", "CP_UNICODE", ")", ");", "}", "codepage", "=", "getCodepage", "(", ");", "}", "/", "*", "Write", "the", "properties", "and", "the", "property", "list", "into", "their", "respective", "*", "streams", ":", "*", "/", "for", "(", "Property", "p", ":", "properties", ".", "values", "(", "))", "{", "final", "long", "id", "=", "p", ".", "getID", "(", ");", "/", "*", "Write", "the", "property", "list", "entry", ".", "*", "/", "TypeWriter", ".", "writeUIntToStream", "(", "propertyListStream", ",", "p", ".", "getID", "(", "))", ";", "TypeWriter", ".", "writeUIntToStream", "(", "propertyListStream", ",", "position", ")", ";", "LittleEndian", ".", "putUInt", "(", "id", ",", "propertyListStream", ")", ";", "LittleEndian", ".", "putUInt", "(", "position", ",", "propertyListStream", ")", ";", "/", "*", "If", "the", "property", "ID", "is", "not", "equal", "0", "we", "write", "the", "property", "and", "all", "*", "is", "fine", ".", "However", ",", "if", "it", "equals", "0", "we", "have", "to", "write", "the", "section", "'", "s", "*", "dictionary", "which", "has", "an", "implicit", "type", "only", "and", "an", "explicit", "*", "value", ".", "*", "/", "if", "(", "id", "!", "=", "0", ")", "if", "(", "id", "!", "=", "0", ")", "{", "/", "*", "Write", "the", "property", "and", "update", "the", "position", "to", "the", "next", "*", "property", ".", "*", "/", "position", "+", "=", "p", ".", "write", "(", "propertyStream", ",", "getCodepage", "(", "))", ";", "else", "{", "if", "(", "codepage", "=", "=", "-", "1", ")", "throw", "new", "IllegalPropertySetDataException", "(", "\"", "Codepage", "(", "property", "1", ")", "is", "undefined", ".", "\")", ";", "position", "+", "=", "writeDictionary", "(", "propertyStream", ",", "dictionary", ",", "codepage", ")", ";", "position", "+", "=", "p", ".", "write", "(", "propertyStream", ",", "codepage", ")", ";", "}", "else", "{", "if", "(", "codepage", "=", "=", "-", "1", ")", "{", "throw", "new", "IllegalPropertySetDataException", "(", "\"", "Codepage", "(", "property", "1", ")", "is", "undefined", ".", "\")", ";", "}", "position", "+", "=", "writeDictionary", "(", "propertyStream", ",", "codepage", ")", ";", "}", "}", "propertyStream", ".", "close", "(", ");", "propertyListStream", ".", "close", "(", ");", "/", "*", "Write", "the", "section", ":", "*", "/", "byte", "[", "]", "pb1", "=", "propertyListStream", ".", "toByteArray", "(", ");", "byte", "[", "]", "pb2", "=", "propertyStream", ".", "toByteArray", "(", ");", "int", "streamLength", "=", "LittleEndianConsts", ".", "INT_SIZE", "*", "2", "+", "propertyListStream", ".", "size", "(", ")", "+", "propertyStream", ".", "size", "(", ");", "/", "*", "Write", "the", "section", "'", "s", "length", ":", "*", "/", "TypeWriter", ".", "writeToStream", "(", "out", ",", "LittleEndian", ".", "INT_SIZE", "*", "2", "+", "pb1", ".", "length", "+", "pb2", ".", "length", ")", ";", "LittleEndian", ".", "putInt", "(", "streamLength", ",", "out", ")", ";", "/", "*", "Write", "the", "section", "'", "s", "number", "of", "properties", ":", "*", "/", "TypeWriter", ".", "writeToStream", "(", "out", ",", "getPropertyCount", "(", "))", ";", "LittleEndian", ".", "putInt", "(", "getPropertyCount", "(", "),", "out", ")", ";", "/", "*", "Write", "the", "property", "list", ":", "*", "/", "out", ".", "write", "(", "pb1", ")", ";", "propertyListStream", ".", "writeTo", "(", "out", ")", ";", "/", "*", "Write", "the", "properties", ":", "*", "/", "out", ".", "write", "(", "pb2", ")", ";", "propertyStream", ".", "writeTo", "(", "out", ")", ";", "int", "streamLength", "=", "LittleEndian", ".", "INT_SIZE", "*", "2", "+", "pb1", ".", "length", "+", "pb2", ".", "length", ";", "return", "streamLength", ";", "}", "/", "**", "*", "Reads", "a", "dictionary", ".", "*", "*", "@", "param", "leis", "The", "byte", "stream", "containing", "the", "bytes", "making", "out", "the", "dictionary", ".", "*", "@", "param", "length", "The", "dictionary", "contains", "at", "most", "this", "many", "bytes", ".", "*", "@", "param", "codepage", "The", "codepage", "of", "the", "string", "values", ".", "*", "*", "@", "return", "{", "@", "code", "true", "}", "if", "dictionary", "was", "read", "successful", ",", "{", "@", "code", "false", "}", "otherwise", "*", "*", "@", "throws", "UnsupportedEncodingException", "if", "the", "dictionary", "'", "s", "codepage", "is", "not", "*", "(", "yet", ")", "supported", ".", "*", "/", "private", "boolean", "readDictionary", "(", "LittleEndianByteArrayInputStream", "leis", ",", "final", "int", "length", ",", "final", "int", "codepage", ")", "throws", "UnsupportedEncodingException", "{", "Map", "<", "Long", ",", "String", ">", "dic", "=", "new", "HashMap", "<", "Long", ",", "String", ">", "()", ";", "/", "*", "*", "Read", "the", "number", "of", "dictionary", "entries", ".", "*", "/", "final", "long", "nrEntries", "=", "leis", ".", "readUInt", "(", ");", "long", "id", "=", "-", "1", ";", "boolean", "isCorrupted", "=", "false", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "nrEntries", ";", "i", "+", "+)", "{", "String", "errMsg", "=", "\"", "The", "property", "set", "'", "s", "dictionary", "contains", "bogus", "data", ".", "\"", "+", "\"", "All", "dictionary", "entries", "starting", "with", "the", "one", "with", "ID", "\"", "+", "id", "+", "\"", "will", "be", "ignored", ".", "\";", "/", "*", "The", "key", ".", "*", "/", "id", "=", "leis", ".", "readUInt", "(", ");", "/", "*", "The", "value", "(", "a", "string", ")", ".", "The", "length", "is", "the", "either", "the", "*", "number", "of", "(", "two", "-", "byte", ")", "characters", "if", "the", "character", "set", "is", "Unicode", "*", "or", "the", "number", "of", "bytes", "if", "the", "character", "set", "is", "not", "Unicode", ".", "*", "The", "length", "includes", "terminating", "0x00", "bytes", "which", "we", "have", "to", "strip", "*", "off", "to", "create", "a", "Java", "string", ".", "*", "/", "long", "sLength", "=", "leis", ".", "readUInt", "(", ");", "/", "*", "Read", "the", "string", "-", "Strip", "0x00", "characters", "from", "the", "end", "of", "the", "string", ".", "*", "/", "int", "cp", "=", "(", "codepage", "=", "=", "-", "1", ")", "?", "Property", ".", "DEFAULT_CODEPAGE", ":", "codepage", ";", "int", "nrBytes", "=", "(", "int", ")", "((", "sLength", "-", "1", ")", "*", "(", "cp", "=", "=", "CodePageUtil", ".", "CP_UNICODE", "?", "2", ":", "1", ")", ");", "if", "(", "nrBytes", ">", "0xFFFFFF", ")", "{", "LOG", ".", "log", "(", "POILogger", ".", "WARN", ",", "errMsg", ")", ";", "isCorrupted", "=", "true", ";", "break", ";", "}", "try", "{", "byte", "buf", "[", "]", "=", "new", "byte", "[", "nrBytes", "]", ";", "leis", ".", "readFully", "(", "buf", ",", "0", ",", "nrBytes", ")", ";", "final", "String", "str", "=", "CodePageUtil", ".", "getStringFromCodePage", "(", "buf", ",", "0", ",", "nrBytes", ",", "cp", ")", ";", "int", "pad", "=", "1", ";", "if", "(", "cp", "=", "=", "CodePageUtil", ".", "CP_UNICODE", ")", "{", "pad", "=", "2", "+", "((", "4", "-", "(", "(", "nrBytes", "+", "2", ")", "&", "0x3", ")", ")", "&", "0x3", ")", ";", "}", "leis", ".", "skip", "(", "pad", ")", ";", "dic", ".", "put", "(", "id", ",", "str", ")", ";", "}", "catch", "(", "RuntimeException", "ex", ")", "{", "LOG", ".", "log", "(", "POILogger", ".", "WARN", ",", "errMsg", ",", "ex", ")", ";", "isCorrupted", "=", "true", ";", "break", ";", "}", "}", "setDictionary", "(", "dic", ")", ";", "return", "!", "isCorrupted", ";", "}", "/", "**", "@", "@", "-", "861", ",", "48", "+", "871", ",", "37", "@", "@", "public", "int", "write", "(", "final", "OutputStream", "out", ")", "throws", "WritingNotSupportedException", ",", "IO", "*", "@", "return", "The", "number", "of", "bytes", "written", "*", "@", "exception", "IOException", "if", "an", "I", "/", "O", "exception", "occurs", ".", "*", "/", "private", "static", "int", "writeDictionary", "(", "final", "OutputStream", "out", ",", "final", "Map", "<", "Long", ",", "String", ">", "dictionary", ",", "final", "int", "codepage", ")", "private", "int", "writeDictionary", "(", "final", "OutputStream", "out", ",", "final", "int", "codepage", ")", "throws", "IOException", "{", "int", "length", "=", "TypeWriter", ".", "writeUIntToStream", "(", "out", ",", "dictionary", ".", "size", "(", "))", ";", "for", "(", "Map", ".", "Entry", "<", "Long", ",", "String", ">", "ls", ":", "dictionary", ".", "entrySet", "(", "))", "{", "final", "Long", "key", "=", "ls", ".", "getKey", "(", ");", "final", "String", "value", "=", "ls", ".", "getValue", "(", ");", "final", "byte", "padding", "[", "]", "=", "new", "byte", "[", "4", "]", ";", "Map", "<", "Long", ",", "String", ">", "dic", "=", "getDictionary", "(", ");", "LittleEndian", ".", "putUInt", "(", "dic", ".", "size", "(", "),", "out", ")", ";", "int", "length", "=", "LittleEndianConsts", ".", "INT_SIZE", ";", "for", "(", "Map", ".", "Entry", "<", "Long", ",", "String", ">", "ls", ":", "dic", ".", "entrySet", "(", "))", "{", "LittleEndian", ".", "putUInt", "(", "ls", ".", "getKey", "(", "),", "out", ")", ";", "length", "+", "=", "LittleEndianConsts", ".", "INT_SIZE", ";", "String", "value", "=", "ls", ".", "getValue", "(", ")+", "\"\\", "0", "\"", ";", "LittleEndian", ".", "putUInt", "(", "value", ".", "length", "(", "),", "out", ")", ";", "length", "+", "=", "LittleEndianConsts", ".", "INT_SIZE", ";", "byte", "bytes", "[", "]", "=", "CodePageUtil", ".", "getBytesInCodePage", "(", "value", ",", "codepage", ")", ";", "out", ".", "write", "(", "bytes", ")", ";", "length", "+", "=", "bytes", ".", "length", ";", "if", "(", "codepage", "=", "=", "CodePageUtil", ".", "CP_UNICODE", ")", "{", "/", "*", "Write", "the", "dictionary", "item", "in", "Unicode", ".", "*", "/", "int", "sLength", "=", "value", ".", "length", "(", ")", "+", "1", ";", "if", "(", "(", "sLength", "&", "1", ")", "=", "=", "1", ")", "{", "sLength", "+", "+;", "}", "length", "+", "=", "TypeWriter", ".", "writeUIntToStream", "(", "out", ",", "key", ".", "longValue", "(", "))", ";", "length", "+", "=", "TypeWriter", ".", "writeUIntToStream", "(", "out", ",", "sLength", ")", ";", "final", "byte", "[", "]", "ca", "=", "CodePageUtil", ".", "getBytesInCodePage", "(", "value", ",", "codepage", ")", ";", "for", "(", "int", "j", "=", "2", ";", "j", "<", "ca", ".", "length", ";", "j", "+", "=", "2", ")", "{", "out", ".", "write", "(", "ca", "[", "j", "+", "1", "]", ");", "out", ".", "write", "(", "ca", "[", "j", "]", ");", "length", "+", "=", "2", ";", "}", "sLength", "-", "=", "value", ".", "length", "(", ");", "while", "(", "sLength", ">", "0", ")", "{", "out", ".", "write", "(", "0x00", ")", ";", "out", ".", "write", "(", "0x00", ")", ";", "length", "+", "=", "2", ";", "sLength", "-", "-;", "}", "}", "else", "{", "/", "*", "Write", "the", "dictionary", "item", "in", "another", "codepage", "than", "*", "Unicode", ".", "*", "/", "length", "+", "=", "TypeWriter", ".", "writeUIntToStream", "(", "out", ",", "key", ".", "longValue", "(", "))", ";", "length", "+", "=", "TypeWriter", ".", "writeUIntToStream", "(", "out", ",", "value", ".", "length", "(", ")", "+", "1L", ")", ";", "final", "byte", "[", "]", "ba", "=", "CodePageUtil", ".", "getBytesInCodePage", "(", "value", ",", "codepage", ")", ";", "for", "(", "int", "j", "=", "0", ";", "j", "<", "ba", ".", "length", ";", "j", "+", "+)", "{", "out", ".", "write", "(", "ba", "[", "j", "]", ");", "length", "+", "+;", "}", "out", ".", "write", "(", "0x00", ")", ";", "length", "+", "+;", "int", "pad", "=", "(", "4", "-", "(", "length", "&", "0x3", ")", ")", "&", "0x3", ";", "out", ".", "write", "(", "padding", ",", "0", ",", "pad", ")", ";", "length", "+", "=", "pad", ";", "}", "}", "int", "pad", "=", "(", "4", "-", "(", "length", "&", "0x3", ")", ")", "&", "0x3", ";", "out", ".", "write", "(", "padding", ",", "0", ",", "pad", ")", ";", "length", "+", "=", "pad", ";", "return", "length", ";", "}", "@", "@", "-", "924", ",", "25", "+", "923", ",", "27", "@", "@", "private", "static", "int", "writeDictionary", "(", "final", "OutputStream", "out", ",", "final", "Map", "<", "Long", ",", "String", "*", "/", "public", "void", "setDictionary", "(", "final", "Map", "<", "Long", ",", "String", ">", "dictionary", ")", "throws", "IllegalPropertySetDataException", "{", "if", "(", "dictionary", "!", "=", "null", ")", "{", "this", ".", "dictionary", "=", "dictionary", ";", "if", "(", "this", ".", "dictionary", "=", "=", "null", ")", "{", "this", ".", "dictionary", "=", "new", "TreeMap", "<", "Long", ",", "String", ">", "()", ";", "}", "this", ".", "dictionary", ".", "putAll", "(", "dictionary", ")", ";", "/", "*", "If", "the", "codepage", "property", "(", "ID", "1", ")", "for", "the", "strings", "(", "keys", "and", "values", ")", "*", "used", "in", "the", "dictionary", "is", "not", "yet", "defined", ",", "set", "it", "to", "ISO", "-", "8859", "-", "1", ".", "*", "/", "int", "cp", "=", "getCodepage", "(", ");", "if", "(", "cp", "=", "=", "-", "1", ")", "{", "setCodepage", "(", "Property", ".", "DEFAULT_CODEPAGE", ")", ";", "}", "/", "*", "Set", "the", "dictionary", "property", "(", "ID", "0", ")", ".", "Please", "note", "that", "the", "second", "*", "parameter", "in", "the", "method", "call", "below", "is", "unused", "because", "dictionaries", "*", "don", "'", "t", "have", "a", "type", ".", "*", "/", "setProperty", "(", "PropertyIDMap", ".", "PID_DICTIONARY", ",", "-", "1", ",", "dictionary", ")", ";", "/", "*", "If", "the", "codepage", "property", "(", "ID", "1", ")", "for", "the", "strings", "(", "keys", "and", "*", "values", ")", "used", "in", "the", "dictionary", "is", "not", "yet", "defined", ",", "set", "it", "to", "*", "Unicode", ".", "*", "/", "final", "Integer", "codepage", "=", "(", "Integer", ")", "getProperty", "(", "PropertyIDMap", ".", "PID_CODEPAGE", ")", ";", "if", "(", "codepage", "=", "=", "null", ")", "{", "setProperty", "(", "PropertyIDMap", ".", "PID_CODEPAGE", ",", "Variant", ".", "VT_I2", ",", "Integer", ".", "valueOf", "(", "CodePageUtil", ".", "CP_UNICODE", ")", ");", "}", "}", "else", "{", "/", "*", "Setting", "the", "dictionary", "to", "null", "means", "to", "remove", "property", "0", ".", "*", "However", ",", "it", "does", "not", "mean", "to", "remove", "property", "1", "(", "codepage", ")", ".", "*", "/", "removeProperty", "(", "PropertyIDMap", ".", "PID_DICTIONARY", ")", ";", "this", ".", "dictionary", "=", "null", ";", "}", "}", "@", "@", "-", "951", ",", "6", "+", "952", ",", "7", "@", "@", "public", "void", "setDictionary", "(", "final", "Map", "<", "Long", ",", "String", ">", "dictionary", ")", "throws", "IllegalPrope", "/", "**", "*", "@", "see", "Object", "#", "hashCode", "(", ")", "*", "/", "@", "Override", "public", "int", "hashCode", "(", ")", "{", "long", "hashCode", "=", "0", ";", "hashCode", "+", "=", "getFormatID", "(", ").", "hashCode", "(", ");", "@", "@", "-", "967", ",", "9", "+", "969", ",", "11", "@", "@", "public", "int", "hashCode", "(", ")", "{", "/", "**", "*", "@", "see", "Object", "#", "toString", "(", ")", "*", "/", "@", "Override", "public", "String", "toString", "(", ")", "{", "final", "StringBuffer", "b", "=", "new", "StringBuffer", "(", ");", "final", "Property", "[", "]", "pa", "=", "getProperties", "(", ");", "b", ".", "append", "(", "\"\\", "n", "\\", "n", "\\", "n", "\"", ");", "b", ".", "append", "(", "getClass", "(", ").", "getName", "(", "))", ";", "b", ".", "append", "(", "'[", "')", ";", "b", ".", "append", "(", "\"", "formatID", ":", "\"", ");", "@", "@", "-", "981", ",", "8", "+", "985", ",", "12", "@", "@", "public", "String", "toString", "(", ")", "{", "b", ".", "append", "(", "\",", "size", ":", "\"", ");", "b", ".", "append", "(", "getSize", "(", "))", ";", "b", ".", "append", "(", "\",", "properties", ":", "[", "\\", "n", "\"", ");", "for", "(", "int", "i", "=", "0", ";", "i", "<", "pa", ".", "length", ";", "i", "+", "+)", "{", "b", ".", "append", "(", "pa", "[", "i", "]", ");", "int", "codepage", "=", "getCodepage", "(", ");", "if", "(", "codepage", "=", "=", "-", "1", ")", "{", "codepage", "=", "Property", ".", "DEFAULT_CODEPAGE", ";", "}", "for", "(", "Property", "p", ":", "pa", ")", "{", "b", ".", "append", "(", "p", ".", "toString", "(", "codepage", ")", ");", "b", ".", "append", "(", "\",", "\\", "n", "\"", ");", "}", "b", ".", "append", "(", "']", "')", ";", "@", "@", "-", "1002", ",", "7", "+", "1010", ",", "12", "@", "@", "public", "String", "toString", "(", ")", "{", "*", "@", "return", "the", "dictionary", "or", "{", "@", "code", "null", "}", "if", "the", "section", "does", "not", "have", "*", "a", "dictionary", ".", "*", "/", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "public", "Map", "<", "Long", ",", "String", ">", "getDictionary", "(", ")", "{", "if", "(", "dictionary", "=", "=", "null", ")", "{", "dictionary", "=", "(", "Map", "<", "Long", ",", "String", ">", ")", "getProperty", "(", "PropertyIDMap", ".", "PID_DICTIONARY", ")", ";", "}", "return", "dictionary", ";", "}", "@", "@", "-", "1013", ",", "13", "+", "1026", ",", "17", "@", "@", "public", "String", "toString", "(", ")", "{", "*", "*", "@", "return", "The", "section", "'", "s", "codepage", "if", "one", "is", "defined", ",", "else", "-", "1", ".", "*", "/", "public", "int", "getCodepage", "(", ")", "{", "public", "int", "getCodepage", "(", ")", "{", "final", "Integer", "codepage", "=", "(", "Integer", ")", "getProperty", "(", "PropertyIDMap", ".", "PID_CODEPAGE", ")", ";", "if", "(", "codepage", "=", "=", "null", ")", "{", "return", "-", "1", ";", "}", "int", "cp", "=", "codepage", ".", "intValue", "(", ");", "return", "cp", ";", "return", "(", "codepage", "=", "=", "null", ")", "?", "-", "1", ":", "codepage", ".", "intValue", "(", ");", "}", "/", "**", "*", "Sets", "the", "codepage", ".", "*", "*", "@", "param", "codepage", "the", "codepage", "*", "/", "public", "void", "setCodepage", "(", "final", "int", "codepage", ")", "{", "setProperty", "(", "PropertyIDMap", ".", "PID_CODEPAGE", ",", "Variant", ".", "VT_I2", ",", "codepage", ")", ";", "}", "}"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially", "crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "3", ",", "6", "+", "3", ",", "9", "@", "@", "PHP", "NEWS", "?", "?", "?", "??", "2010", ",", "PHP", "5", ".", "2", ".", "14", "-", "Updated", "timezone", "database", "to", "version", "2010", ".", "3", ".", "(", "Derick", ")", "-", "Fixed", "a", "NULL", "pointer", "dereference", "when", "processing", "invalid", "XML", "-", "RPC", "requests", "(", "Fixes", "CVE", "-", "2010", "-", "0397", ",", "bug", "#", "51288", ")", ".", "(", "Raphael", "Geissert", ")", "-", "Fixed", "bug", "#", "51269", "(", "zlib", ".", "output_compression", "Overwrites", "Vary", "Header", ")", ".", "(", "Adam", ")", "-", "Fixed", "bug", "#", "51237", "(", "milter", "SAPI", "crash", "on", "startup", ")", ".", "(", "igmar", "at", "palsenberg", "dot", "com", ")", "-", "Fixed", "bug", "#", "51213", "(", "pdo_mssql", "is", "trimming", "value", "of", "the", "money", "column", ")", ".", "(", "Ilia", ",", "@", "@", "-", "0", ",", "0", "+", "1", ",", "14", "@", "@", "-", "-", "TEST", "-", "-", "Bug", "#", "51288", "(", "CVE", "-", "2010", "-", "0397", ",", "NULL", "pointer", "deref", "when", "no", "<", "methodName", ">", "in", "request", ")", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "method", "=", "NULL", ";", "$", "req", "=", "'", "<?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "?>", "<", "methodCall", ">", "</", "methodCall", ">", "';", "var_dump", "(", "xmlrpc_decode_request", "(", "$", "req", ",", "$", "method", ")", ");", "var_dump", "(", "$", "method", ")", ";", "echo", "\"", "Done", "\\", "n", "\"", ";", "?", ">", "-", "-", "EXPECT", "-", "-", "NULL", "NULL", "Done", "@", "@", "-", "723", ",", "6", "+", "723", ",", "7", "@", "@", "zval", "*", "decode_request_worker", "(", "zval", "*", "xml_in", ",", "zval", "*", "encoding_in", ",", "zval", "*", "method_name_", "zval", "*", "retval", "=", "NULL", ";", "XMLRPC_REQUEST", "response", ";", "STRUCT_XMLRPC_REQUEST_INPUT_OPTIONS", "opts", "=", "{", "{", "0", "}", "};", "const", "char", "*", "method_name", ";", "opts", ".", "xml_elem_opts", ".", "encoding", "=", "encoding_in", "?", "utf8_get_encoding_id_from_string", "(", "Z_STRVAL_P", "(", "encoding_in", ")", ")", ":", "ENCODING_DEFAULT", ";", "/", "*", "generate", "XMLRPC_REQUEST", "from", "raw", "xml", "*", "/", "@", "@", "-", "733", ",", "10", "+", "734", ",", "15", "@", "@", "zval", "*", "decode_request_worker", "(", "zval", "*", "xml_in", ",", "zval", "*", "encoding_in", ",", "zval", "*", "method_name_", "if", "(", "XMLRPC_RequestGetRequestType", "(", "response", ")", "=", "=", "xmlrpc_request_call", ")", "{", "if", "(", "method_name_out", ")", "{", "zval_dtor", "(", "method_name_out", ")", ";", "Z_TYPE_P", "(", "method_name_out", ")", "=", "IS_STRING", ";", "Z_STRVAL_P", "(", "method_name_out", ")", "=", "estrdup", "(", "XMLRPC_RequestGetMethodName", "(", "response", ")", ");", "Z_STRLEN_P", "(", "method_name_out", ")", "=", "strlen", "(", "Z_STRVAL_P", "(", "method_name_out", ")", ");", "method_name", "=", "XMLRPC_RequestGetMethodName", "(", "response", ")", ";", "if", "(", "method_name", ")", "{", "zval_dtor", "(", "method_name_out", ")", ";", "Z_TYPE_P", "(", "method_name_out", ")", "=", "IS_STRING", ";", "Z_STRVAL_P", "(", "method_name_out", ")", "=", "estrdup", "(", "method_name", ")", ";", "Z_STRLEN_P", "(", "method_name_out", ")", "=", "strlen", "(", "Z_STRVAL_P", "(", "method_name_out", ")", ");", "}", "else", "{", "retval", "=", "NULL", ";", "}", "}", "}"], "docstring_tokens": ["a", "specially-crafted", "argument"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "277", ",", "7", "+", "277", ",", "7", "@", "@", "static", "int", "dvb_ca_ioctl", "(", "struct", "file", "*", "file", ",", "unsigned", "int", "cmd", ",", "void", "*", "parg", ")", "{", "ca_slot_info_t", "*", "info", "=", "(", "ca_slot_info_t", "*", ")", "parg", ";", "if", "(", "info", "-", ">", "num", ">", "1", ")", "if", "(", "info", "-", ">", "num", "<", "0", "|", "|", "info", "-", ">", "num", ">", "1", ")", "return", "-", "EINVAL", ";", "av7110", "-", ">", "ci_slot", "[", "info", "-", ">", "num", "]", ".", "num", "=", "info", "-", ">", "num", ";", "av7110", "-", ">", "ci_slot", "[", "info", "-", ">", "num", "]", ".", "type", "=", "FW_CI_LL_SUPPORT", "(", "av7110", "-", ">", "arm_app", ")", "?"], "docstring_tokens": ["via", "a", "negative", "value", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1673", ",", "9", "+", "1673", ",", "8", "@", "@", "static", "Image", "*", "ReadDDSImage", "(", "const", "ImageInfo", "*", "image_info", ",", "ExceptionInfo", "*", "exception", ")", "/", "*", "Initialize", "image", "structure", ".", "*", "/", "if", "(", "ReadDDSInfo", "(", "image", ",", "&", "dds_info", ")", "!", "=", "MagickTrue", ")", "{", "if", "(", "ReadDDSInfo", "(", "image", ",", "&", "dds_info", ")", "!", "=", "MagickTrue", ")", "ThrowReaderException", "(", "CorruptImageError", ",", "\"", "ImproperImageHeader", "\"", ");", "}", "if", "(", "dds_info", ".", "ddscaps2", "&", "DDSCAPS2_CUBEMAP", ")", "cubemap", "=", "MagickTrue", ";", "@", "@", "-", "1772", ",", "6", "+", "1771", ",", "9", "@", "@", "static", "Image", "*", "ReadDDSImage", "(", "const", "ImageInfo", "*", "image_info", ",", "ExceptionInfo", "*", "exception", ")", "if", "(", "volume", ")", "num_images", "=", "dds_info", ".", "depth", ";", "if", "(", "num_images", "<", "1", ")", "ThrowReaderException", "(", "CorruptImageError", ",", "\"", "ImproperImageHeader", "\"", ");", "for", "(", "n", "=", "0", ";", "n", "<", "num_images", ";", "n", "+", "+)", "{", "if", "(", "n", "!", "=", "0", ")"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "421", ",", "6", "+", "421", ",", "10", "@", "@", "int", "tipc_enable_l2_media", "(", "struct", "net", "*", "net", ",", "struct", "tipc_bearer", "*", "b", ",", "dev", "=", "dev_get_by_name", "(", "net", ",", "driver_name", ")", ";", "if", "(", "!", "dev", ")", "return", "-", "ENODEV", ";", "if", "(", "tipc_mtu_bad", "(", "dev", ",", "0", ")", ")", "{", "dev_put", "(", "dev", ")", ";", "return", "-", "EINVAL", ";", "}", "/", "*", "Associate", "TIPC", "bearer", "with", "L2", "bearer", "*", "/", "rcu_assign_pointer", "(", "b", "-", ">", "media_ptr", ",", "dev", ")", ";", "@", "@", "-", "610", ",", "8", "+", "614", ",", "6", "@", "@", "static", "int", "tipc_l2_device_event", "(", "struct", "notifier_block", "*", "nb", ",", "unsigned", "long", "evt", ",", "if", "(", "!", "b", ")", "return", "NOTIFY_DONE", ";", "b", "-", ">", "mtu", "=", "dev", "-", ">", "mtu", ";", "switch", "(", "evt", ")", "{", "case", "NETDEV_CHANGE", ":", "if", "(", "netif_carrier_ok", "(", "dev", ")", ")", "@", "@", "-", "624", ",", "6", "+", "626", ",", "11", "@", "@", "static", "int", "tipc_l2_device_event", "(", "struct", "notifier_block", "*", "nb", ",", "unsigned", "long", "evt", ",", "tipc_reset_bearer", "(", "net", ",", "b", ")", ";", "break", ";", "case", "NETDEV_CHANGEMTU", ":", "if", "(", "tipc_mtu_bad", "(", "dev", ",", "0", ")", ")", "{", "bearer_disable", "(", "net", ",", "b", ")", ";", "break", ";", "}", "b", "-", ">", "mtu", "=", "dev", "-", ">", "mtu", ";", "tipc_reset_bearer", "(", "net", ",", "b", ")", ";", "break", ";", "case", "NETDEV_CHANGEADDR", ":", "@", "@", "-", "39", ",", "6", "+", "39", ",", "7", "@", "@", "#", "include", "\"", "netlink", ".", "h", "\"", "#", "include", "\"", "core", ".", "h", "\"", "#", "include", "\"", "msg", ".", "h", "\"", "#", "include", "<", "net", "/", "genetlink", ".", "h", ">", "#", "define", "MAX_MEDIA", "3", "@", "@", "-", "59", ",", "6", "+", "60", ",", "9", "@", "@", "#", "define", "TIPC_MEDIA_TYPE_IB", "2", "#", "define", "TIPC_MEDIA_TYPE_UDP", "3", "/", "*", "minimum", "bearer", "MTU", "*", "/", "#", "define", "TIPC_MIN_BEARER_MTU", "(", "MAX_H_SIZE", "+", "INT_H_SIZE", ")", "/", "**", "*", "struct", "tipc_media_addr", "-", "destination", "address", "used", "by", "TIPC", "bearers", "*", "@", "value", ":", "address", "info", "(", "format", "defined", "by", "media", ")", "@", "@", "-", "215", ",", "4", "+", "219", ",", "13", "@", "@", "void", "tipc_bearer_xmit", "(", "struct", "net", "*", "net", ",", "u32", "bearer_id", ",", "void", "tipc_bearer_bc_xmit", "(", "struct", "net", "*", "net", ",", "u32", "bearer_id", ",", "struct", "sk_buff_head", "*", "xmitq", ")", ";", "/", "*", "check", "if", "device", "MTU", "is", "too", "low", "for", "tipc", "headers", "*", "/", "static", "inline", "bool", "tipc_mtu_bad", "(", "struct", "net_device", "*", "dev", ",", "unsigned", "int", "reserve", ")", "{", "if", "(", "dev", "-", ">", "mtu", ">", "=", "TIPC_MIN_BEARER_MTU", "+", "reserve", ")", "return", "false", ";", "netdev_warn", "(", "dev", ",", "\"", "MTU", "too", "low", "for", "tipc", "bearer", "\\", "n", "\"", ");", "return", "true", ";", "}", "#", "endif", "/", "*", "_TIPC_BEARER_H", "*", "/", "@", "@", "-", "697", ",", "6", "+", "697", ",", "11", "@", "@", "static", "int", "tipc_udp_enable", "(", "struct", "net", "*", "net", ",", "struct", "tipc_bearer", "*", "b", ",", "udp_conf", ".", "local_ip", ".", "s_addr", "=", "htonl", "(", "INADDR_ANY", ")", ";", "udp_conf", ".", "use_udp_checksums", "=", "false", ";", "ub", "-", ">", "ifindex", "=", "dev", "-", ">", "ifindex", ";", "if", "(", "tipc_mtu_bad", "(", "dev", ",", "sizeof", "(", "struct", "iphdr", ")", "sizeof", "(", "struct", "udphdr", ")", "))", "{", "err", "=", "-", "EINVAL", ";", "goto", "err", ";", "}", "b", "-", ">", "mtu", "=", "dev", "-", ">", "mtu", "-", "sizeof", "(", "struct", "iphdr", ")", "-", "sizeof", "(", "struct", "udphdr", ")", ";", "#", "if", "IS_ENABLED", "(", "CONFIG_IPV6", ")"], "docstring_tokens": ["layout", "the", "appropriate", "heap", "space"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2831", ",", "7", "+", "2831", ",", "7", "@", "@", "cifs_mount", "(", "struct", "super_block", "*", "sb", ",", "struct", "cifs_sb_info", "*", "cifs_sb", ",", "remote_path_check", ":", "/", "*", "check", "if", "a", "whole", "path", "(", "including", "prepath", ")", "is", "not", "remote", "*", "/", "if", "(", "!", "rc", "&", "&", "cifs_sb", "-", ">", "prepathlen", "&", "&", "tcon", ")", "{", "if", "(", "!", "rc", "&", "&", "tcon", ")", "{", "/", "*", "build_path_to_root", "works", "only", "when", "we", "have", "a", "valid", "tcon", "*", "/", "full_path", "=", "cifs_build_path_to_root", "(", "cifs_sb", ",", "tcon", ")", ";", "if", "(", "full_path", "=", "=", "NULL", ")", "{"], "docstring_tokens": ["persuading", "a", "victim", "to", "mount", "from", "a", "malicious", "server"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "175", ",", "7", "+", "175", ",", "7", "@", "@", "static", "int", "decode_dds1", "(", "GetByteContext", "*", "gb", ",", "uint8_t", "*", "frame", ",", "int", "width", ",", "int", "height", "return", "AVERROR_INVALIDDATA", ";", "frame", "+", "=", "v", ";", "}", "else", "{", "if", "(", "frame_end", "-", "frame", "<", "width", "+", "3", ")", "if", "(", "frame_end", "-", "frame", "<", "width", "+", "4", ")", "return", "AVERROR_INVALIDDATA", ";", "frame", "[", "0", "]", "=", "frame", "[", "1", "]", "=", "frame", "[", "width", "]", "=", "frame", "[", "width", "+", "1", "]", "=", "bytestream2_get_byte", "(", "gb", ")", ";"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "270", ",", "6", "+", "270", ",", "7", "@", "@", "long", "keyctl_join_session_keyring", "(", "const", "char", "__user", "*", "_name", ")", "/", "*", "join", "the", "session", "*", "/", "ret", "=", "join_session_keyring", "(", "name", ")", ";", "kfree", "(", "name", ")", ";", "error", ":", "return", "ret", ";"], "docstring_tokens": ["via", "unknown", "vectors", "related", "to", "a", "\"missing", "kfree.\""]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "523", ",", "6", "+", "523", ",", "17", "@", "@", "void", "setExtractInlineImages", "(", "boolean", "extractInlineImages", ")", "{", "defaultConfig", ".", "setExtractInlineImages", "(", "extractInlineImages", ")", ";", "}", "@", "Field", "void", "setAverageCharTolerance", "(", "float", "averageCharTolerance", ")", "{", "defaultConfig", ".", "setAverageCharTolerance", "(", "averageCharTolerance", ")", ";", "}", "@", "Field", "void", "setSpacingTolerance", "(", "float", "spacingTolerance", ")", "{", "defaultConfig", ".", "setSpacingTolerance", "(", "spacingTolerance", ")", ";", "}", "@", "Field", "void", "setCatchIntermediateExceptions", "(", "boolean", "catchIntermediateExceptions", ")", "{", "defaultConfig", ".", "setCatchIntermediateIOExceptions", "(", "catchIntermediateExceptions", ")", ";", "@", "@", "-", "114", ",", "10", "+", "114", ",", "16", "@", "@", "private", "static", "OCR_STRATEGY", "parse", "(", "String", "s", ")", "{", "private", "boolean", "extractMarkedContent", "=", "false", ";", "/", "/", "The", "character", "width", "-", "based", "tolerance", "value", "used", "to", "estimate", "where", "spaces", "in", "text", "should", "be", "added", "private", "Float", "averageCharTolerance", ";", "/", "/", "Default", "taken", "from", "PDFBox", ".", "private", "Float", "averageCharTolerance", "=", "0", ".", "5f", ";", "/", "/", "The", "space", "width", "-", "based", "tolerance", "value", "used", "to", "estimate", "where", "spaces", "in", "text", "should", "be", "added", "private", "Float", "spacingTolerance", ";", "/", "/", "Default", "taken", "from", "PDFBox", ".", "private", "Float", "spacingTolerance", "=", "0", ".", "3f", ";", "/", "/", "The", "multiplication", "factor", "for", "line", "height", "to", "decide", "when", "a", "new", "paragraph", "starts", ".", "/", "/", "Default", "taken", "from", "PDFBox", ".", "private", "Float", "dropThreshold", "=", "2", ".", "5f", ";", "/", "/", "If", "the", "PDF", "has", "an", "XFA", "element", ",", "process", "only", "that", "and", "skip", "extracting", "/", "/", "content", "from", "elsewhere", "in", "the", "document", ".", "@", "@", "-", "238", ",", "6", "+", "244", ",", "10", "@", "@", "private", "void", "init", "(", "InputStream", "is", ")", "{", "setSetKCMS", "(", "getBooleanProp", "(", "props", ".", "getProperty", "(", "\"", "setKCMS", "\"", "),", "false", ")", ");", "setAverageCharTolerance", "(", "getFloatProp", "(", "props", ".", "getProperty", "(", "\"", "averageCharTolerance", "\"", "),", "averageCharTolerance", ")", ");", "setSpacingTolerance", "(", "getFloatProp", "(", "props", ".", "getProperty", "(", "\"", "spacingTolerance", "\"", "),", "spacingTolerance", ")", ");", "setDropThreshold", "(", "getFloatProp", "(", "props", ".", "getProperty", "(", "\"", "dropThreshold", "\"", "),", "dropThreshold", ")", ");", "boolean", "checkExtractAccessPermission", "=", "getBooleanProp", "(", "props", ".", "getProperty", "(", "\"", "checkExtractAccessPermission", "\"", "),", "false", ")", ";", "boolean", "allowExtractionForAccessibility", "=", "getBooleanProp", "(", "props", ".", "getProperty", "(", "\"", "allowExtractionForAccessibility", "\"", "),", "true", ")", ";", "@", "@", "-", "287", ",", "6", "+", "297", ",", "9", "@", "@", "public", "void", "configure", "(", "PDF2XHTML", "pdf2XHTML", ")", "{", "if", "(", "getSpacingTolerance", "(", ")", "!", "=", "null", ")", "{", "pdf2XHTML", ".", "setSpacingTolerance", "(", "getSpacingTolerance", "(", "))", ";", "}", "if", "(", "getDropThreshold", "(", ")", "!", "=", "null", ")", "{", "pdf2XHTML", ".", "setDropThreshold", "(", "dropThreshold", ")", ";", "}", "pdf2XHTML", ".", "setSuppressDuplicateOverlappingText", "(", "getSuppressDuplicateOverlappingText", "(", "))", ";", "}", "@", "@", "-", "513", ",", "6", "+", "526", ",", "14", "@", "@", "public", "void", "setSpacingTolerance", "(", "Float", "spacingTolerance", ")", "{", "this", ".", "spacingTolerance", "=", "spacingTolerance", ";", "}", "public", "Float", "getDropThreshold", "(", ")", "{", "return", "dropThreshold", ";", "}", "public", "void", "setDropThreshold", "(", "float", "dropThreshold", ")", "{", "this", ".", "dropThreshold", "=", "dropThreshold", ";", "}", "public", "AccessChecker", "getAccessChecker", "(", ")", "{", "return", "accessChecker", ";", "}", "@", "@", "-", "824", ",", "6", "+", "845", ",", "7", "@", "@", "public", "boolean", "equals", "(", "Object", "o", ")", "{", "if", "(", "getCatchIntermediateIOExceptions", "(", ")", "!", "=", "config", ".", "getCatchIntermediateIOExceptions", "(", "))", "return", "false", ";", "if", "(", "!", "getAverageCharTolerance", "(", ").", "equals", "(", "config", ".", "getAverageCharTolerance", "(", "))", ")", "return", "false", ";", "if", "(", "!", "getSpacingTolerance", "(", ").", "equals", "(", "config", ".", "getSpacingTolerance", "(", "))", ")", "return", "false", ";", "if", "(", "!", "getDropThreshold", "(", ").", "equals", "(", "config", ".", "getDropThreshold", "(", "))", ")", "return", "false", ";", "if", "(", "!", "getOcrStrategy", "(", ").", "equals", "(", "config", ".", "getOcrStrategy", "(", "))", ")", "return", "false", ";", "if", "(", "getOcrImageType", "(", ")", "!", "=", "config", ".", "getOcrImageType", "(", "))", "return", "false", ";", "if", "(", "!", "getOcrImageFormatName", "(", ").", "equals", "(", "config", ".", "getOcrImageFormatName", "(", "))", ")", "return", "false", ";", "@", "@", "-", "844", ",", "6", "+", "866", ",", "7", "@", "@", "public", "int", "hashCode", "(", ")", "{", "result", "=", "31", "*", "result", "+", "(", "getExtractUniqueInlineImagesOnly", "(", ")", "?", "1", ":", "0", ")", ";", "result", "=", "31", "*", "result", "+", "getAverageCharTolerance", "(", ").", "hashCode", "(", ");", "result", "=", "31", "*", "result", "+", "getSpacingTolerance", "(", ").", "hashCode", "(", ");", "result", "=", "31", "*", "result", "+", "getDropThreshold", "(", ").", "hashCode", "(", ");", "result", "=", "31", "*", "result", "+", "(", "getIfXFAExtractOnlyXFA", "(", ")", "?", "1", ":", "0", ")", ";", "result", "=", "31", "*", "result", "+", "ocrStrategy", ".", "hashCode", "(", ");", "result", "=", "31", "*", "result", "+", "getOcrDPI", "(", ");", "@", "@", "-", "869", ",", "6", "+", "892", ",", "7", "@", "@", "public", "String", "toString", "(", ")", "{", "\"", ",", "extractUniqueInlineImagesOnly", "=", "\"", "+", "extractUniqueInlineImagesOnly", "+", "\"", ",", "averageCharTolerance", "=", "\"", "+", "averageCharTolerance", "+", "\"", ",", "spacingTolerance", "=", "\"", "+", "spacingTolerance", "+", "\"", ",", "dropThreshold", "=", "\"", "+", "dropThreshold", "\"", ",", "ifXFAExtractOnlyXFA", "=", "\"", "+", "ifXFAExtractOnlyXFA", "+", "\"", ",", "ocrStrategy", "=", "\"", "+", "ocrStrategy", "+", "\"", ",", "ocrDPI", "=", "\"", "+", "ocrDPI", "+", "@", "@", "-", "1528", ",", "6", "+", "1528", ",", "16", "@", "@", "public", "void", "testUnmappedUnicodeStats", "(", ")", "throws", "Exception", "{", "}", "@", "Test", "public", "void", "testNPEInPDFParserConfig", "(", ")", "{", "/", "/", "TIKA", "-", "3091", "PDFParserConfig", "config", "=", "new", "PDFParserConfig", "(", ");", "/", "/", "don", "'", "t", "care", "about", "values", ";", "want", "to", "make", "sure", "no", "NPE", "is", "thrown", "String", "txt", "=", "config", ".", "toString", "(", ");", "config", ".", "hashCode", "(", ");", "config", ".", "equals", "(", "new", "PDFParserConfig", "(", "))", ";", "}", "@", "Test", "/", "/", "TIKA", "-", "3041", "@", "Ignore", "(", "\"", "turn", "back", "on", "if", "we", "add", "file", "from", "PDFBOX", "-", "52", "\"", ")", "public", "void", "testPDFBox52", "(", ")", "throws", "Exception", "{"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "288", ",", "19", "+", "288", ",", "19", "@", "@", "public", "MultipartStream", "(", "InputStream", "input", ",", "if", "(", "boundary", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "boundary", "may", "not", "be", "null", "\"", ");", "}", "this", ".", "input", "=", "input", ";", "this", ".", "bufSize", "=", "bufSize", ";", "this", ".", "buffer", "=", "new", "byte", "[", "bufSize", "]", ";", "this", ".", "notifier", "=", "pNotifier", ";", "/", "/", "We", "prepend", "CR", "/", "LF", "to", "the", "boundary", "to", "chop", "trailing", "CR", "/", "LF", "from", "/", "/", "body", "-", "data", "tokens", ".", "this", ".", "boundaryLength", "=", "boundary", ".", "length", "+", "BOUNDARY_PREFIX", ".", "length", ";", "if", "(", "bufSize", "<", "this", ".", "boundaryLength", "+", "1", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "The", "buffer", "size", "specified", "for", "the", "MultipartStream", "is", "too", "small", "\"", ");", "}", "this", ".", "input", "=", "input", ";", "this", ".", "bufSize", "=", "Math", ".", "max", "(", "bufSize", ",", "boundaryLength", "*", "2", ")", ";", "this", ".", "buffer", "=", "new", "byte", "[", "this", ".", "bufSize", "]", ";", "this", ".", "notifier", "=", "pNotifier", ";", "this", ".", "boundary", "=", "new", "byte", "[", "this", ".", "boundaryLength", "]", ";", "this", ".", "keepRegion", "=", "this", ".", "boundary", ".", "length", ";", "@", "@", "-", "68", ",", "6", "+", "68", ",", "10", "@", "@", "Update", "the", "internal", "fork", "of", "Commons", "Pool", "2", "to", "r1743697", "(", "2", ".", "4", ".", "2", "plus", "additional", "fixes", ")", ".", "(", "markt", ")", "<", "/", "update", ">", "<", "update", ">", "Update", "the", "internal", "fork", "of", "Commons", "File", "Upload", "to", "r1743698", "(", "1", ".", "3", ".", "1", "plus", "additional", "fixes", ")", ".", "(", "markt", ")", "<", "/", "update", ">", "<", "/", "changelog", ">", "<", "/", "subsection", ">", "<", "/", "section", ">"], "docstring_tokens": ["via", "a", "long", "boundary", "string", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "10", ",", "7", "+", "10", ",", "13", "@", "@", "PHP", "NEWS", "buffer", "overflow", ")", ".", "(", "Stas", ")", ".", "Fixed", "bug", "#", "67827", "(", "broken", "detection", "of", "system", "crypt", "sha256", "/", "sha512", "support", ")", ".", "(", "ncopa", "at", "alpinelinux", "dot", "org", ")", ".", "Fixed", "bug", "#", "68942", "(", "Use", "after", "free", "vulnerability", "in", "unserialize", "(", ")", "with", "DateTimeZone", ")", ".", "(", "Stas", ")", "-", "Enchant", ":", ".", "Fixed", "bug", "#", "6855", "(", "heap", "buffer", "overflow", "in", "enchant_broker_request_dict", "(", "))", ".", "(", "Antony", ")", "-", "SOAP", ":", ".", "Fixed", "bug", "#", "67427", "(", "SoapServer", "cannot", "handle", "large", "messages", ")", "(", "brandt", "at", "docoloc", "dot", "de", ")", "@", "@", "-", "550", ",", "13", "+", "550", ",", "12", "@", "@", "PHP_FUNCTION", "(", "enchant_broker_request_dict", ")", "d", "=", "enchant_broker_request_dict", "(", "pbroker", "-", ">", "pbroker", ",", "(", "const", "char", "*", ")", "tag", ")", ";", "if", "(", "d", ")", "{", "pos", "=", "pbroker", "-", ">", "dictcnt", "+", "+;", "if", "(", "pbroker", "-", ">", "dictcnt", ")", "{", "pbroker", "-", ">", "dict", "=", "(", "enchant_dict", "*", "*)", "erealloc", "(", "pbroker", "-", ">", "dict", ",", "sizeof", "(", "enchant_dict", "*", ")", "*", "pbroker", "-", ">", "dictcnt", ")", ";", "pos", "=", "pbroker", "-", ">", "dictcnt", "+", "+;", "}", "else", "{", "pbroker", "-", ">", "dict", "=", "(", "enchant_dict", "*", "*)", "emalloc", "(", "sizeof", "(", "enchant_dict", "*", "))", ";", "pos", "=", "0", ";", "pbroker", "-", ">", "dictcnt", "+", "+;", "}", "dict", "=", "pbroker", "-", ">", "dict", "[", "pos", "]", "=", "(", "enchant_dict", "*", ")", "emalloc", "(", "sizeof", "(", "enchant_dict", ")", ");", "@", "@", "-", "607", ",", "14", "+", "606", ",", "14", "@", "@", "PHP_FUNCTION", "(", "enchant_broker_request_pwl_dict", ")", "d", "=", "enchant_broker_request_pwl_dict", "(", "pbroker", "-", ">", "pbroker", ",", "(", "const", "char", "*", ")", "pwl", ")", ";", "if", "(", "d", ")", "{", "pos", "=", "pbroker", "-", ">", "dictcnt", "+", "+;", "if", "(", "pbroker", "-", ">", "dictcnt", ")", "{", "pos", "=", "pbroker", "-", ">", "dictcnt", "+", "+;", "pbroker", "-", ">", "dict", "=", "(", "enchant_dict", "*", "*)", "erealloc", "(", "pbroker", "-", ">", "dict", ",", "sizeof", "(", "enchant_dict", "*", ")", "*", "pbroker", "-", ">", "dictcnt", ")", ";", "}", "else", "{", "pbroker", "-", ">", "dict", "=", "(", "enchant_dict", "*", "*)", "emalloc", "(", "sizeof", "(", "enchant_dict", "*", "))", ";", "pos", "=", "0", ";", "pbroker", "-", ">", "dictcnt", "+", "+;", "}", "dict", "=", "pbroker", "-", ">", "dict", "[", "pos", "]", "=", "(", "enchant_dict", "*", ")", "emalloc", "(", "sizeof", "(", "enchant_dict", ")", ");", "dict", "-", ">", "id", "=", "pos", ";", "dict", "-", ">", "pbroker", "=", "pbroker", ";"], "docstring_tokens": ["via", "vectors", "that", "trigger", "creation", "of", "multiple", "dictionaries", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "9", ",", "8", "+", "9", ",", "17", "@", "@", "import", "*", "as", "fetchers", "from", "'", "./", "fetchers", "/", "index", ".", "js", "'", ";", "import", "*", "as", "fs", "from", "'", "./", "util", "/", "fs", ".", "js", "'", ";", "import", "*", "as", "promise", "from", "'", "./", "util", "/", "promise", ".", "js", "'", ";", "async", "function", "fetchCache", "(", "dest", ":", "string", ",", "fetcher", ":", "Fetchers", ",", "config", ":", "Config", ")", ":", "Promise", "<", "FetchedMetadata", ">", "{", "const", "{", "hash", ",", "package", ":", "pkg", "}", "=", "await", "config", ".", "readPackageMetadata", "(", "dest", ")", ";", "const", "ssri", "=", "require", "(", "'", "ssri", "'", ");", "async", "function", "fetchCache", "(", "dest", ":", "string", ",", "fetcher", ":", "Fetchers", ",", "config", ":", "Config", ",", "integrity", ":", "?", "string", ")", ":", "Promise", "<", "FetchedMetadata", ">", "{", "const", "{", "hash", ",", "package", ":", "pkg", ",", "remote", "}", "=", "await", "config", ".", "readPackageMetadata", "(", "dest", ")", ";", "if", "(", "integrity", ")", "{", "if", "(", "!", "remote", ".", "integrity", "|", "|", "!", "ssri", ".", "parse", "(", "integrity", ")", ".", "match", "(", "remote", ".", "integrity", ")", ")", "{", "throw", "new", "MessageError", "(", "'", "Incorrect", "integrity", "when", "fetching", "from", "the", "cache", "'", ");", "}", "}", "await", "fetcher", ".", "setupMirrorFromCache", "(", ");", "return", "{", "package", ":", "pkg", ",", "@", "@", "-", "40", ",", "7", "+", "49", ",", "7", "@", "@", "export", "async", "function", "fetchOneRemote", "(", "const", "fetcher", "=", "new", "Fetcher", "(", "dest", ",", "remote", ",", "config", ")", ";", "if", "(", "await", "config", ".", "isValidModuleDest", "(", "dest", ")", ")", "{", "return", "fetchCache", "(", "dest", ",", "fetcher", ",", "config", ")", ";", "return", "fetchCache", "(", "dest", ",", "fetcher", ",", "config", ",", "remote", ".", "integrity", ")", ";", "}", "/", "/", "remove", "as", "the", "module", "may", "be", "invalid"], "docstring_tokens": ["sending", "a", "specially", "crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1878", ",", "6", "+", "1878", ",", "9", "@", "@", "static", "int", "futex_requeue", "(", "u32", "__user", "*", "uaddr1", ",", "unsigned", "int", "flags", ",", "struct", "futex_q", "*", "this", ",", "*", "next", ";", "DEFINE_WAKE_Q", "(", "wake_q", ")", ";", "if", "(", "nr_wake", "<", "0", "|", "|", "nr_requeue", "<", "0", ")", "return", "-", "EINVAL", ";", "/", "*", "*", "When", "PI", "not", "supported", ":", "return", "-", "ENOSYS", "if", "requeue_pi", "is", "true", ",", "*", "consequently", "the", "compiler", "knows", "requeue_pi", "is", "always", "false", "past"], "docstring_tokens": ["by", "triggering", "a", "negative", "wake", "or", "requeue", "value", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "68", ",", "7", "+", "68", ",", "7", "@", "@", "private", "String", "enableFeatures", ";", "private", "String", "disableFeatures", ";", "private", "boolean", "enableJacksonTypeConverter", ";", "private", "boolean", "allowJacksonUnmarshallType", ";", "private", "boolean", "allowUnmarshallType", ";", "/", "**", "*", "Use", "the", "default", "Jackson", "{", "@", "link", "ObjectMapper", "}", "and", "{", "@", "link", "Object", "}", "@", "@", "-", "160", ",", "7", "+", "160", ",", "7", "@", "@", "public", "Object", "unmarshal", "(", "Exchange", "exchange", ",", "InputStream", "stream", ")", "throws", "Exception", "/", "/", "is", "there", "a", "header", "with", "the", "unmarshal", "type", "?", "Class", "<", "?>", "clazz", "=", "unmarshalType", ";", "String", "type", "=", "null", ";", "if", "(", "allowJacksonUnmarshallType", ")", "{", "if", "(", "allowUnmarshallType", ")", "{", "type", "=", "exchange", ".", "getIn", "(", ").", "getHeader", "(", "JacksonConstants", ".", "UNMARSHAL_TYPE", ",", "String", ".", "class", ")", ";", "}", "if", "(", "type", "=", "=", "null", "&", "&", "isAllowJmsType", "(", "))", "{", "@", "@", "-", "331", ",", "17", "+", "331", ",", "17", "@", "@", "public", "void", "setEnableJacksonTypeConverter", "(", "boolean", "enableJacksonTypeConverter", ")", "{", "this", ".", "enableJacksonTypeConverter", "=", "enableJacksonTypeConverter", ";", "}", "public", "boolean", "isAllowJacksonUnmarshallType", "(", ")", "{", "return", "allowJacksonUnmarshallType", ";", "public", "boolean", "isAllowUnmarshallType", "(", ")", "{", "return", "allowUnmarshallType", ";", "}", "/", "**", "*", "If", "enabled", "then", "Jackson", "is", "allowed", "to", "attempt", "to", "use", "the", "CamelJacksonUnmarshalType", "header", "during", "the", "unmarshalling", ".", "*", "<", "p", "/", ">", "*", "This", "should", "only", "be", "enabled", "when", "desired", "to", "be", "used", ".", "*", "/", "public", "void", "setAllowJacksonUnmarshallType", "(", "boolean", "allowJacksonUnmarshallType", ")", "{", "this", ".", "allowJacksonUnmarshallType", "=", "allowJacksonUnmarshallType", ";", "public", "void", "setAllowUnmarshallType", "(", "boolean", "allowJacksonUnmarshallType", ")", "{", "this", ".", "allowUnmarshallType", "=", "allowJacksonUnmarshallType", ";", "}", "public", "String", "getEnableFeatures", "(", ")", "{", "@", "@", "-", "46", ",", "7", "+", "46", ",", "7", "@", "@", "protected", "RouteBuilder", "createRouteBuilder", "(", ")", "throws", "Exception", "{", "@", "Override", "public", "void", "configure", "(", ")", "throws", "Exception", "{", "JacksonDataFormat", "format", "=", "new", "JacksonDataFormat", "(", ");", "format", ".", "setAllowJacksonUnmarshallType", "(", "true", ")", ";", "format", ".", "setAllowUnmarshallType", "(", "true", ")", ";", "from", "(", "\"", "direct", ":", "backPojo", "\"", ").", "unmarshal", "(", "format", ")", ".", "to", "(", "\"", "mock", ":", "reversePojo", "\"", ");"], "docstring_tokens": ["using", "de-serializing", "untrusted", "data"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "50", ",", "7", "+", "50", ",", "7", "@", "@", "private", "final", "JaasContext", "jaasContext", ";", "private", "boolean", "complete", ";", "private", "String", "authorizationID", ";", "private", "String", "authorizationId", ";", "public", "PlainSaslServer", "(", "JaasContext", "jaasContext", ")", "{", "this", ".", "jaasContext", "=", "jaasContext", ";", "@", "@", "-", "79", ",", "7", "+", "79", ",", "7", "@", "@", "public", "PlainSaslServer", "(", "JaasContext", "jaasContext", ")", "{", "}", "if", "(", "tokens", ".", "length", "!", "=", "3", ")", "throw", "new", "SaslException", "(", "\"", "Invalid", "SASL", "/", "PLAIN", "response", ":", "expected", "3", "tokens", ",", "got", "\"", "+", "tokens", ".", "length", ")", ";", "authorizationID", "=", "tokens", "[", "0", "]", ";", "String", "authorizationIdFromClient", "=", "tokens", "[", "0", "]", ";", "String", "username", "=", "tokens", "[", "1", "]", ";", "String", "password", "=", "tokens", "[", "2", "]", ";", "@", "@", "-", "89", ",", "14", "+", "89", ",", "18", "@", "@", "public", "PlainSaslServer", "(", "JaasContext", "jaasContext", ")", "{", "if", "(", "password", ".", "isEmpty", "(", "))", "{", "throw", "new", "SaslException", "(", "\"", "Authentication", "failed", ":", "password", "not", "specified", "\"", ");", "}", "if", "(", "authorizationID", ".", "isEmpty", "(", "))", "authorizationID", "=", "username", ";", "String", "expectedPassword", "=", "jaasContext", ".", "configEntryOption", "(", "JAAS_USER_PREFIX", "+", "username", ",", "PlainLoginModule", ".", "class", ".", "getName", "(", "))", ";", "if", "(", "!", "password", ".", "equals", "(", "expectedPassword", ")", ")", "{", "throw", "new", "SaslException", "(", "\"", "Authentication", "failed", ":", "Invalid", "username", "or", "password", "\"", ");", "}", "if", "(", "!", "authorizationIdFromClient", ".", "isEmpty", "(", ")", "&", "&", "!", "authorizationIdFromClient", ".", "equals", "(", "username", ")", ")", "throw", "new", "SaslException", "(", "\"", "Authentication", "failed", ":", "Client", "requested", "an", "authorization", "id", "that", "is", "different", "from", "username", "\"", ");", "this", ".", "authorizationId", "=", "username", ";", "complete", "=", "true", ";", "return", "new", "byte", "[", "0", "]", ";", "}", "@", "@", "-", "105", ",", "7", "+", "109", ",", "7", "@", "@", "public", "PlainSaslServer", "(", "JaasContext", "jaasContext", ")", "{", "public", "String", "getAuthorizationID", "(", ")", "{", "if", "(", "!", "complete", ")", "throw", "new", "IllegalStateException", "(", "\"", "Authentication", "exchange", "has", "not", "completed", "\"", ");", "return", "authorizationID", ";", "return", "authorizationId", ";", "}", "@", "Override", "@", "@", "-", "64", ",", "7", "+", "64", ",", "6", "@", "@", "private", "String", "username", ";", "private", "ClientFirstMessage", "clientFirstMessage", ";", "private", "ServerFirstMessage", "serverFirstMessage", ";", "private", "String", "serverNonce", ";", "private", "ScramCredential", "scramCredential", ";", "public", "ScramSaslServer", "(", "ScramMechanism", "mechanism", ",", "Map", "<", "String", ",", "?", ">", "props", ",", "CallbackHandler", "callbackHandler", ")", "throws", "NoSuchAlgorithmException", "{", "@", "@", "-", "80", ",", "7", "+", "79", ",", "7", "@", "@", "public", "ScramSaslServer", "(", "ScramMechanism", "mechanism", ",", "Map", "<", "String", ",", "?", ">", "props", ",", "CallbackH", "switch", "(", "state", ")", "{", "case", "RECEIVE_CLIENT_FIRST_MESSAGE", ":", "this", ".", "clientFirstMessage", "=", "new", "ClientFirstMessage", "(", "response", ")", ";", "serverNonce", "=", "formatter", ".", "secureRandomString", "(", ");", "String", "serverNonce", "=", "formatter", ".", "secureRandomString", "(", ");", "try", "{", "String", "saslName", "=", "clientFirstMessage", ".", "saslName", "(", ");", "this", ".", "username", "=", "formatter", ".", "username", "(", "saslName", ")", ";", "@", "@", "-", "90", ",", "6", "+", "89", ",", "10", "@", "@", "public", "ScramSaslServer", "(", "ScramMechanism", "mechanism", ",", "Map", "<", "String", ",", "?", ">", "props", ",", "CallbackH", "this", ".", "scramCredential", "=", "credentialCallback", ".", "scramCredential", "(", ");", "if", "(", "scramCredential", "=", "=", "null", ")", "throw", "new", "SaslException", "(", "\"", "Authentication", "failed", ":", "Invalid", "user", "credentials", "\"", ");", "String", "authorizationIdFromClient", "=", "clientFirstMessage", ".", "authorizationId", "(", ");", "if", "(", "!", "authorizationIdFromClient", ".", "isEmpty", "(", ")", "&", "&", "!", "authorizationIdFromClient", ".", "equals", "(", "username", ")", ")", "throw", "new", "SaslException", "(", "\"", "Authentication", "failed", ":", "Client", "requested", "an", "authorization", "id", "that", "is", "different", "from", "username", "\"", ");", "if", "(", "scramCredential", ".", "iterations", "(", ")", "<", "mechanism", ".", "minIterations", "(", "))", "throw", "new", "SaslException", "(", "\"", "Iterations", "\"", "+", "scramCredential", ".", "iterations", "(", ")", "+", "\"", "is", "less", "than", "the", "minimum", "\"", "+", "mechanism", ".", "minIterations", "(", ")", "+", "\"", "for", "\"", "+", "mechanism", ")", ";", "this", ".", "serverFirstMessage", "=", "new", "ServerFirstMessage", "(", "clientFirstMessage", ".", "nonce", "(", "),", "@", "@", "-", "109", ",", "6", "+", "112", ",", "7", "@", "@", "public", "ScramSaslServer", "(", "ScramMechanism", "mechanism", ",", "Map", "<", "String", ",", "?", ">", "props", ",", "CallbackH", "byte", "[", "]", "serverKey", "=", "scramCredential", ".", "serverKey", "(", ");", "byte", "[", "]", "serverSignature", "=", "formatter", ".", "serverSignature", "(", "serverKey", ",", "clientFirstMessage", ",", "serverFirstMessage", ",", "clientFinalMessage", ")", ";", "ServerFinalMessage", "serverFinalMessage", "=", "new", "ServerFinalMessage", "(", "null", ",", "serverSignature", ")", ";", "clearCredentials", "(", ");", "setState", "(", "State", ".", "COMPLETE", ")", ";", "return", "serverFinalMessage", ".", "toBytes", "(", ");", "}", "catch", "(", "InvalidKeyException", "e", ")", "{", "@", "@", "-", "119", ",", "6", "+", "123", ",", "7", "@", "@", "public", "ScramSaslServer", "(", "ScramMechanism", "mechanism", ",", "Map", "<", "String", ",", "?", ">", "props", ",", "CallbackH", "throw", "new", "IllegalSaslStateException", "(", "\"", "Unexpected", "challenge", "in", "Sasl", "server", "state", "\"", "+", "state", ")", ";", "}", "}", "catch", "(", "SaslException", "e", ")", "{", "clearCredentials", "(", ");", "setState", "(", "State", ".", "FAILED", ")", ";", "throw", "e", ";", "}", "@", "@", "-", "128", ",", "8", "+", "133", ",", "7", "@", "@", "public", "ScramSaslServer", "(", "ScramMechanism", "mechanism", ",", "Map", "<", "String", ",", "?", ">", "props", ",", "CallbackH", "public", "String", "getAuthorizationID", "(", ")", "{", "if", "(", "!", "isComplete", "(", "))", "throw", "new", "IllegalStateException", "(", "\"", "Authentication", "exchange", "has", "not", "completed", "\"", ");", "String", "authzId", "=", "clientFirstMessage", ".", "authorizationId", "(", ");", "return", "authzId", "=", "=", "null", "|", "|", "authzId", ".", "length", "(", ")", "=", "=", "0", "?", "username", ":", "authzId", ";", "return", "username", ";", "}", "@", "Override", "@", "@", "-", "184", ",", "6", "+", "188", ",", "12", "@", "@", "private", "void", "verifyClientProof", "(", "ClientFinalMessage", "clientFinalMessage", ")", "throws", "Sas", "}", "}", "private", "void", "clearCredentials", "(", ")", "{", "scramCredential", "=", "null", ";", "clientFirstMessage", "=", "null", ";", "serverFirstMessage", "=", "null", ";", "}", "public", "static", "class", "ScramSaslServerFactory", "implements", "SaslServerFactory", "{", "@", "Override", "@", "@", "-", "0", ",", "0", "+", "1", ",", "75", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "kafka", ".", "common", ".", "security", ".", "plain", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "javax", ".", "security", ".", "sasl", ".", "SaslException", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "org", ".", "apache", ".", "kafka", ".", "common", ".", "security", ".", "JaasContext", ";", "import", "org", ".", "apache", ".", "kafka", ".", "common", ".", "security", ".", "authenticator", ".", "TestJaasConfig", ";", "public", "class", "PlainSaslServerTest", "{", "private", "static", "final", "String", "USER_A", "=", "\"", "userA", "\"", ";", "private", "static", "final", "String", "PASSWORD_A", "=", "\"", "passwordA", "\"", ";", "private", "static", "final", "String", "USER_B", "=", "\"", "userB", "\"", ";", "private", "static", "final", "String", "PASSWORD_B", "=", "\"", "passwordB", "\"", ";", "private", "PlainSaslServer", "saslServer", ";", "@", "Before", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "TestJaasConfig", "jaasConfig", "=", "new", "TestJaasConfig", "(", ");", "Map", "<", "String", ",", "Object", ">", "options", "=", "new", "HashMap", "<", ">(", ");", "options", ".", "put", "(", "\"", "user_", "\"", "+", "USER_A", ",", "PASSWORD_A", ")", ";", "options", ".", "put", "(", "\"", "user_", "\"", "+", "USER_B", ",", "PASSWORD_B", ")", ";", "jaasConfig", ".", "addEntry", "(", "\"", "jaasContext", "\"", ",", "PlainLoginModule", ".", "class", ".", "getName", "(", "),", "options", ")", ";", "JaasContext", "jaasContext", "=", "new", "JaasContext", "(", "\"", "jaasContext", "\"", ",", "JaasContext", ".", "Type", ".", "SERVER", ",", "jaasConfig", ")", ";", "saslServer", "=", "new", "PlainSaslServer", "(", "jaasContext", ")", ";", "}", "@", "Test", "public", "void", "noAuthorizationIdSpecified", "(", ")", "throws", "Exception", "{", "byte", "[", "]", "nextChallenge", "=", "saslServer", ".", "evaluateResponse", "(", "saslMessage", "(", "\"\"", ",", "USER_A", ",", "PASSWORD_A", ")", ");", "assertEquals", "(", "0", ",", "nextChallenge", ".", "length", ")", ";", "}", "@", "Test", "public", "void", "authorizatonIdEqualsAuthenticationId", "(", ")", "throws", "Exception", "{", "byte", "[", "]", "nextChallenge", "=", "saslServer", ".", "evaluateResponse", "(", "saslMessage", "(", "USER_A", ",", "USER_A", ",", "PASSWORD_A", ")", ");", "assertEquals", "(", "0", ",", "nextChallenge", ".", "length", ")", ";", "}", "@", "Test", "(", "expected", "=", "SaslException", ".", "class", ")", "public", "void", "authorizatonIdNotEqualsAuthenticationId", "(", ")", "throws", "Exception", "{", "saslServer", ".", "evaluateResponse", "(", "saslMessage", "(", "USER_B", ",", "USER_A", ",", "PASSWORD_A", ")", ");", "}", "private", "byte", "[", "]", "saslMessage", "(", "String", "authorizationId", ",", "String", "userName", ",", "String", "password", ")", "{", "String", "nul", "=", "\"", "\\", "u0000", "\"", ";", "String", "message", "=", "String", ".", "format", "(", "\"%", "s", "%", "s", "%", "s", "%", "s", "%", "s", "\"", ",", "authorizationId", ",", "nul", ",", "userName", ",", "nul", ",", "password", ")", ";", "return", "message", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "74", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "kafka", ".", "common", ".", "security", ".", "scram", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "javax", ".", "security", ".", "sasl", ".", "SaslException", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "org", ".", "apache", ".", "kafka", ".", "common", ".", "security", ".", "authenticator", ".", "CredentialCache", ";", "public", "class", "ScramSaslServerTest", "{", "private", "static", "final", "String", "USER_A", "=", "\"", "userA", "\"", ";", "private", "static", "final", "String", "USER_B", "=", "\"", "userB", "\"", ";", "private", "ScramMechanism", "mechanism", ";", "private", "ScramFormatter", "formatter", ";", "private", "ScramSaslServer", "saslServer", ";", "@", "Before", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "mechanism", "=", "ScramMechanism", ".", "SCRAM_SHA_256", ";", "formatter", "=", "new", "ScramFormatter", "(", "mechanism", ")", ";", "CredentialCache", ".", "Cache", "<", "ScramCredential", ">", "credentialCache", "=", "new", "CredentialCache", "(", ").", "createCache", "(", "mechanism", ".", "mechanismName", "(", "),", "ScramCredential", ".", "class", ")", ";", "credentialCache", ".", "put", "(", "USER_A", ",", "formatter", ".", "generateCredential", "(", "\"", "passwordA", "\"", ",", "4096", ")", ");", "credentialCache", ".", "put", "(", "USER_B", ",", "formatter", ".", "generateCredential", "(", "\"", "passwordB", "\"", ",", "4096", ")", ");", "ScramServerCallbackHandler", "callbackHandler", "=", "new", "ScramServerCallbackHandler", "(", "credentialCache", ")", ";", "saslServer", "=", "new", "ScramSaslServer", "(", "mechanism", ",", "new", "HashMap", "<", "String", ",", "Object", ">", "()", ",", "callbackHandler", ")", ";", "}", "@", "Test", "public", "void", "noAuthorizationIdSpecified", "(", ")", "throws", "Exception", "{", "byte", "[", "]", "nextChallenge", "=", "saslServer", ".", "evaluateResponse", "(", "clientFirstMessage", "(", "USER_A", ",", "null", ")", ");", "assertTrue", "(", "\"", "Next", "challenge", "is", "empty", "\"", ",", "nextChallenge", ".", "length", ">", "0", ")", ";", "}", "@", "Test", "public", "void", "authorizatonIdEqualsAuthenticationId", "(", ")", "throws", "Exception", "{", "byte", "[", "]", "nextChallenge", "=", "saslServer", ".", "evaluateResponse", "(", "clientFirstMessage", "(", "USER_A", ",", "USER_A", ")", ");", "assertTrue", "(", "\"", "Next", "challenge", "is", "empty", "\"", ",", "nextChallenge", ".", "length", ">", "0", ")", ";", "}", "@", "Test", "(", "expected", "=", "SaslException", ".", "class", ")", "public", "void", "authorizatonIdNotEqualsAuthenticationId", "(", ")", "throws", "Exception", "{", "saslServer", ".", "evaluateResponse", "(", "clientFirstMessage", "(", "USER_A", ",", "USER_B", ")", ");", "}", "private", "byte", "[", "]", "clientFirstMessage", "(", "String", "userName", ",", "String", "authorizationId", ")", "{", "String", "nonce", "=", "formatter", ".", "secureRandomString", "(", ");", "String", "authorizationField", "=", "authorizationId", "!", "=", "null", "?", "\"", "a", "=", "\"", "+", "authorizationId", ":", "\"", "\";", "String", "firstMessage", "=", "String", ".", "format", "(", "\"", "n", ",", "%", "s", ",", "n", "=", "%", "s", ",", "r", "=", "%", "s", "\"", ",", "authorizationField", ",", "userName", ",", "nonce", ")", ";", "return", "firstMessage", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ";", "}", "}"], "docstring_tokens": ["a", "manually", "crafted", "protocol", "message"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1091", ",", "8", "+", "1091", ",", "8", "@", "@", "SYSCALL_DEFINE3", "(", "shmctl", ",", "int", ",", "shmid", ",", "int", ",", "cmd", ",", "struct", "shmid_ds", "__user", "*", ",", "buf", ")", "*", "\"", "raddr", "\"", "thing", "points", "to", "kernel", "space", ",", "and", "there", "has", "to", "be", "a", "wrapper", "around", "*", "this", ".", "*", "/", "long", "do_shmat", "(", "int", "shmid", ",", "char", "__user", "*", "shmaddr", ",", "int", "shmflg", ",", "ulong", "*", "raddr", ",", "unsigned", "long", "shmlba", ")", "long", "do_shmat", "(", "int", "shmid", ",", "char", "__user", "*", "shmaddr", ",", "int", "shmflg", ",", "ulong", "*", "raddr", ",", "unsigned", "long", "shmlba", ")", "{", "struct", "shmid_kernel", "*", "shp", ";", "unsigned", "long", "addr", ";", "@", "@", "-", "1113", ",", "8", "+", "1113", ",", "13", "@", "@", "long", "do_shmat", "(", "int", "shmid", ",", "char", "__user", "*", "shmaddr", ",", "int", "shmflg", ",", "ulong", "*", "raddr", ",", "goto", "out", ";", "else", "if", "(", "(", "addr", "=", "(", "ulong", ")", "shmaddr", ")", ")", "{", "if", "(", "addr", "&", "(", "shmlba", "-", "1", ")", ")", "{", "if", "(", "shmflg", "&", "SHM_RND", ")", "addr", "&", "=", "~", "(", "shmlba", "-", "1", ")", ";", "/", "*", "round", "down", "*", "/", "/", "*", "*", "Round", "down", "to", "the", "nearest", "multiple", "of", "shmlba", ".", "*", "For", "sane", "do_mmap_pgoff", "(", ")", "parameters", ",", "avoid", "*", "round", "downs", "that", "trigger", "nil", "-", "page", "and", "MAP_FIXED", ".", "*", "/", "if", "(", "(", "shmflg", "&", "SHM_RND", ")", "&", "&", "addr", ">", "=", "shmlba", ")", "addr", "&", "=", "~", "(", "shmlba", "-", "1", ")", ";", "else", "#", "ifndef", "__ARCH_FORCE_SHMLBA", "if", "(", "addr", "&", "~", "PAGE_MASK", ")"], "docstring_tokens": ["by", "a", "certain", "rounding", "operation"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "227", ",", "21", "+", "227", ",", "13", "@", "@", "public", "String", "intercept", "(", "ActionInvocation", "invocation", ")", "throws", "Exception", "{", "protected", "void", "addParametersToContext", "(", "ActionContext", "ac", ",", "Map", "<", "String", ",", "?", ">", "newParams", ")", "{", "HttpParameters", "previousParams", "=", "ac", ".", "getParameters", "(", ");", "HttpParameters", ".", "Builder", "combinedParams", "=", "HttpParameters", ".", "create", "(", ");", "HttpParameters", ".", "Builder", "combinedParams", ";", "if", "(", "overwrite", ")", "{", "if", "(", "previousParams", "!", "=", "null", ")", "{", "combinedParams", "=", "combinedParams", ".", "withParent", "(", "previousParams", ")", ";", "}", "if", "(", "newParams", "!", "=", "null", ")", "{", "combinedParams", "=", "combinedParams", ".", "withExtraParams", "(", "newParams", ")", ";", "}", "combinedParams", "=", "HttpParameters", ".", "create", "(", ").", "withParent", "(", "previousParams", ")", ";", "combinedParams", "=", "combinedParams", ".", "withExtraParams", "(", "newParams", ")", ";", "}", "else", "{", "if", "(", "newParams", "!", "=", "null", ")", "{", "combinedParams", "=", "combinedParams", ".", "withExtraParams", "(", "newParams", ")", ";", "}", "if", "(", "previousParams", "!", "=", "null", ")", "{", "combinedParams", "=", "combinedParams", ".", "withParent", "(", "previousParams", ")", ";", "}", "combinedParams", "=", "HttpParameters", ".", "create", "(", "newParams", ")", ";", "combinedParams", "=", "combinedParams", ".", "withExtraParams", "(", "previousParams", ")", ";", "}", "ac", ".", "setParameters", "(", "combinedParams", ".", "build", "(", "))", ";", "}", "@", "@", "-", "192", ",", "7", "+", "192", ",", "11", "@", "@", "public", "HttpParameters", "build", "(", ")", "{", "for", "(", "Map", ".", "Entry", "<", "String", ",", "Object", ">", "entry", ":", "requestParameterMap", ".", "entrySet", "(", "))", "{", "String", "name", "=", "entry", ".", "getKey", "(", ");", "Object", "value", "=", "entry", ".", "getValue", "(", ");", "parameters", ".", "put", "(", "name", ",", "new", "Parameter", ".", "Request", "(", "name", ",", "value", ")", ");", "if", "(", "value", "instanceof", "Parameter", ")", "{", "parameters", ".", "put", "(", "name", ",", "(", "Parameter", ")", "value", ")", ";", "}", "else", "{", "parameters", ".", "put", "(", "name", ",", "new", "Parameter", ".", "Request", "(", "name", ",", "value", ")", ");", "}", "}", "return", "new", "HttpParameters", "(", "parameters", ")", ";", "@", "@", "-", "28", ",", "6", "+", "28", ",", "7", "@", "@", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "mock", ".", "MockActionProxy", ";", "import", "org", ".", "apache", ".", "struts2", ".", "dispatcher", ".", "HttpParameters", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "/", "**", "@", "@", "-", "139", ",", "6", "+", "140", ",", "51", "@", "@", "public", "void", "testNoMerge", "(", ")", "throws", "Exception", "{", "assertEquals", "(", "0", ",", "ActionContext", ".", "getContext", "(", ").", "getParameters", "(", ").", "keySet", "(", ").", "size", "(", "))", ";", "}", "public", "void", "testOverwrite", "(", ")", "throws", "Exception", "{", "MockActionInvocation", "mai", "=", "new", "MockActionInvocation", "(", ");", "MockActionProxy", "map", "=", "new", "MockActionProxy", "(", ");", "ActionConfig", "ac", "=", "new", "ActionConfig", ".", "Builder", "(", "\"\"", ",", "\"", "\",", "\"", "\")", ".", "addParam", "(", "\"", "name", "\"", ",", "\"", "${", "hero", "}", "\")", ".", "build", "(", ");", "map", ".", "setConfig", "(", "ac", ")", ";", "mai", ".", "setProxy", "(", "map", ")", ";", "mai", ".", "setAction", "(", "new", "SimpleFooAction", "(", "))", ";", "Map", "<", "String", ",", "String", ">", "existingParams", "=", "new", "HashMap", "<", ">(", ");", "existingParams", ".", "put", "(", "\"", "name", "\"", ",", "\"", "Akash", "\"", ");", "ActionContext", ".", "getContext", "(", ").", "setParameters", "(", "HttpParameters", ".", "create", "(", "existingParams", ")", ".", "build", "(", "))", ";", "int", "before", "=", "ActionContext", ".", "getContext", "(", ").", "getValueStack", "(", ").", "size", "(", ");", "interceptor", ".", "setOverwrite", "(", "\"", "true", "\"", ");", "interceptor", ".", "intercept", "(", "mai", ")", ";", "assertEquals", "(", "before", ",", "ActionContext", ".", "getContext", "(", ").", "getValueStack", "(", ").", "size", "(", "))", ";", "assertEquals", "(", "\"$", "{", "hero", "}", "\",", "ActionContext", ".", "getContext", "(", ").", "getParameters", "(", ").", "get", "(", "\"", "name", "\"", ").", "toString", "(", "))", ";", "}", "public", "void", "testNoOverwrite", "(", ")", "throws", "Exception", "{", "MockActionInvocation", "mai", "=", "new", "MockActionInvocation", "(", ");", "MockActionProxy", "map", "=", "new", "MockActionProxy", "(", ");", "ActionConfig", "ac", "=", "new", "ActionConfig", ".", "Builder", "(", "\"\"", ",", "\"", "\",", "\"", "\")", ".", "addParam", "(", "\"", "name", "\"", ",", "\"", "${", "hero", "}", "\")", ".", "build", "(", ");", "map", ".", "setConfig", "(", "ac", ")", ";", "mai", ".", "setProxy", "(", "map", ")", ";", "mai", ".", "setAction", "(", "new", "SimpleFooAction", "(", "))", ";", "mai", ".", "setInvocationContext", "(", "ActionContext", ".", "getContext", "(", "))", ";", "Map", "<", "String", ",", "String", ">", "existingParams", "=", "new", "HashMap", "<", ">(", ");", "existingParams", ".", "put", "(", "\"", "name", "\"", ",", "\"", "Akash", "\"", ");", "ActionContext", ".", "getContext", "(", ").", "setParameters", "(", "HttpParameters", ".", "create", "(", "existingParams", ")", ".", "build", "(", "))", ";", "int", "before", "=", "ActionContext", ".", "getContext", "(", ").", "getValueStack", "(", ").", "size", "(", ");", "interceptor", ".", "setOverwrite", "(", "\"", "false", "\"", ");", "interceptor", ".", "intercept", "(", "mai", ")", ";", "assertEquals", "(", "before", ",", "ActionContext", ".", "getContext", "(", ").", "getValueStack", "(", ").", "size", "(", "))", ";", "assertEquals", "(", "\"", "Akash", "\"", ",", "ActionContext", ".", "getContext", "(", ").", "getParameters", "(", ").", "get", "(", "\"", "name", "\"", ").", "toString", "(", "))", ";", "}", "public", "void", "testFewParametersParse", "(", ")", "throws", "Exception", "{", "MockActionInvocation", "mai", "=", "new", "MockActionInvocation", "(", ");", "MockActionProxy", "map", "=", "new", "MockActionProxy", "(", ");"], "docstring_tokens": ["sending", "specially", "crafted", "data"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1715", ",", "7", "+", "1715", ",", "16", "@", "@", "public", "static", "String", "generateConsoleAnnotationScriptAndStylesheet", "(", ")", "{", "*", "/", "public", "String", "getPasswordValue", "(", "Object", "o", ")", "{", "if", "(", "o", "=", "=", "null", ")", "return", "null", ";", "if", "(", "o", "instanceof", "Secret", ")", "return", "(", "(", "Secret", ")", "o", ")", ".", "getEncryptedValue", "(", ");", "if", "(", "o", "instanceof", "Secret", ")", "{", "StaplerRequest", "req", "=", "Stapler", ".", "getCurrentRequest", "(", ");", "if", "(", "req", "!", "=", "null", ")", "{", "Item", "item", "=", "req", ".", "findAncestorObject", "(", "Item", ".", "class", ")", ";", "if", "(", "item", "!", "=", "null", "&", "&", "!", "item", ".", "hasPermission", "(", "Item", ".", "CONFIGURE", ")", ")", "{", "return", "\"", "<", "some", "secret", ">", "\";", "}", "}", "return", "(", "(", "Secret", ")", "o", ")", ".", "getEncryptedValue", "(", ");", "}", "if", "(", "getIsUnitTest", "(", "))", "{", "throw", "new", "SecurityException", "(", "\"", "attempted", "to", "render", "plaintext", "\u2018", "\"", "+", "o", "+", "\"", "\u2019", "in", "password", "field", ";", "use", "a", "getter", "of", "type", "Secret", "instead", "\"", ");", "}", "@", "@", "-", "28", ",", "8", "+", "28", ",", "20", "@", "@", "import", "hudson", ".", "Extension", ";", "import", "hudson", ".", "model", ".", "Describable", ";", "import", "hudson", ".", "model", ".", "Descriptor", ";", "import", "hudson", ".", "model", ".", "FreeStyleProject", ";", "import", "hudson", ".", "model", ".", "Item", ";", "import", "hudson", ".", "model", ".", "JobProperty", ";", "import", "hudson", ".", "model", ".", "JobPropertyDescriptor", ";", "import", "hudson", ".", "security", ".", "GlobalMatrixAuthorizationStrategy", ";", "import", "hudson", ".", "util", ".", "Secret", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "containsString", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "not", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertThat", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "HudsonTestCase", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "Issue", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "TestExtension", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "DataBoundConstructor", ";", "/", "**", "*", "@", "author", "Kohsuke", "Kawaguchi", "@", "@", "-", "55", ",", "4", "+", "67", ",", "51", "@", "@", "public", "String", "getDisplayName", "(", ")", "{", "return", "null", ";", "}", "}", "@", "Issue", "(", "\"", "SECURITY", "-", "266", "\"", ")", "public", "void", "testExposedCiphertext", "(", ")", "throws", "Exception", "{", "boolean", "saveEnabled", "=", "Item", ".", "EXTENDED_READ", ".", "getEnabled", "(", ");", "try", "{", "jenkins", ".", "setSecurityRealm", "(", "createDummySecurityRealm", "(", "))", ";", "/", "/", "TODO", "1", ".", "645", "+", "use", "MockAuthorizationStrategy", "GlobalMatrixAuthorizationStrategy", "pmas", "=", "new", "GlobalMatrixAuthorizationStrategy", "(", ");", "pmas", ".", "add", "(", "Jenkins", ".", "ADMINISTER", ",", "\"", "admin", "\"", ");", "pmas", ".", "add", "(", "Jenkins", ".", "READ", ",", "\"", "dev", "\"", ");", "pmas", ".", "add", "(", "Item", ".", "READ", ",", "\"", "dev", "\"", ");", "Item", ".", "EXTENDED_READ", ".", "setEnabled", "(", "true", ")", ";", "pmas", ".", "add", "(", "Item", ".", "EXTENDED_READ", ",", "\"", "dev", "\"", ");", "jenkins", ".", "setAuthorizationStrategy", "(", "pmas", ")", ";", "Secret", "secret", "=", "Secret", ".", "fromString", "(", "\"", "s3cr3t", "\"", ");", "FreeStyleProject", "p", "=", "createFreeStyleProject", "(", "\"", "p", "\"", ");", "p", ".", "addProperty", "(", "new", "VulnerableProperty", "(", "secret", ")", ");", "WebClient", "wc", "=", "createWebClient", "(", ");", "wc", ".", "login", "(", "\"", "admin", "\"", ");", "HtmlPage", "configure", "=", "wc", ".", "getPage", "(", "p", ",", "\"", "configure", "\"", ");", "assertThat", "(", "configure", ".", "getWebResponse", "(", ").", "getContentAsString", "(", "),", "containsString", "(", "secret", ".", "getEncryptedValue", "(", "))", ");", "submit", "(", "configure", ".", "getFormByName", "(", "\"", "config", "\"", "))", ";", "VulnerableProperty", "vp", "=", "p", ".", "getProperty", "(", "VulnerableProperty", ".", "class", ")", ";", "assertNotNull", "(", "vp", ")", ";", "assertEquals", "(", "secret", ",", "vp", ".", "secret", ")", ";", "wc", ".", "login", "(", "\"", "dev", "\"", ");", "configure", "=", "wc", ".", "getPage", "(", "p", ",", "\"", "configure", "\"", ");", "assertThat", "(", "configure", ".", "getWebResponse", "(", ").", "getContentAsString", "(", "),", "not", "(", "containsString", "(", "secret", ".", "getEncryptedValue", "(", "))", "))", ";", "}", "finally", "{", "Item", ".", "EXTENDED_READ", ".", "setEnabled", "(", "saveEnabled", ")", ";", "}", "}", "public", "static", "class", "VulnerableProperty", "extends", "JobProperty", "<", "FreeStyleProject", ">", "{", "public", "final", "Secret", "secret", ";", "@", "DataBoundConstructor", "public", "VulnerableProperty", "(", "Secret", "secret", ")", "{", "this", ".", "secret", "=", "secret", ";", "}", "@", "TestExtension", "(", "\"", "testExposedCiphertext", "\"", ")", "public", "static", "class", "DescriptorImpl", "extends", "JobPropertyDescriptor", "{", "@", "Override", "/", "/", "TODO", "delete", "in", "1", ".", "635", "public", "String", "getDisplayName", "(", ")", "{", "return", "\"", "VulnerableProperty", "\"", ";", "}", "}", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "31", "@", "@", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "?>", "<", "!-", "-", "The", "MIT", "License", "Copyright", "2016", "CloudBees", ",", "Inc", ".", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", "-", "->", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "f", "=", "\"/", "lib", "/", "form", "\"", ">", "<", "f", ":", "entry", "field", "=", "\"", "secret", "\"", "title", "=", "\"", "secret", "\"", ">", "<", "f", ":", "password", "/", ">", "<", "/", "f", ":", "entry", ">", "<", "/", "j", ":", "jelly", ">"], "docstring_tokens": ["by", "reading", "a", "job", "configuration", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "239", ",", "10", "+", "239", ",", "15", "@", "@", "public", "void", "authorizeIndexAction", "(", "RequestInfo", "requestInfo", ",", "AuthorizationInfo", "auth", "if", "(", "SearchScrollAction", ".", "NAME", ".", "equals", "(", "action", ")", ")", "{", "authorizeIndexActionName", "(", "action", ",", "authorizationInfo", ",", "null", ",", "listener", ")", ";", "}", "else", "{", "/", "/", "we", "store", "the", "request", "as", "a", "transient", "in", "the", "ThreadContext", "in", "case", "of", "a", "authorization", "failure", "at", "the", "shard", "/", "/", "level", ".", "If", "authorization", "fails", "we", "will", "audit", "a", "access_denied", "message", "and", "will", "use", "the", "request", "to", "retrieve", "/", "/", "information", "such", "as", "the", "index", "and", "the", "incoming", "address", "of", "the", "request", "listener", ".", "onResponse", "(", "new", "IndexAuthorizationResult", "(", "true", ",", "IndicesAccessControl", ".", "ALLOW_NO_INDICES", ")", ");", "/", "/", "RBACEngine", "simply", "authorizes", "scroll", "related", "actions", "without", "filling", "in", "any", "DLS", "/", "FLS", "permissions", ".", "/", "/", "Scroll", "related", "actions", "have", "special", "security", "logic", ",", "where", "the", "security", "context", "of", "the", "initial", "search", "/", "/", "request", "is", "attached", "to", "the", "scroll", "context", "upon", "creation", "in", "{", "@", "code", "SecuritySearchOperationListener", "#", "onNewScrollContext", "}", "/", "/", "and", "it", "is", "then", "verified", ",", "before", "every", "use", "of", "the", "scroll", ",", "in", "/", "/", "{", "@", "code", "SecuritySearchOperationListener", "#", "validateSearchContext", "}", ".", "/", "/", "The", "DLS", "/", "FLS", "permissions", "are", "used", "inside", "the", "{", "@", "code", "DirectoryReader", "}", "that", "{", "@", "code", "SecurityIndexReaderWrapper", "}", "/", "/", "built", "while", "handling", "the", "initial", "search", "request", ".", "In", "addition", ",", "for", "consistency", ",", "the", "DLS", "/", "FLS", "permissions", "from", "/", "/", "the", "originating", "search", "request", "are", "attached", "to", "the", "thread", "context", "upon", "validating", "the", "scroll", ".", "listener", ".", "onResponse", "(", "new", "IndexAuthorizationResult", "(", "true", ",", "null", ")", ");", "}", "}", "else", "{", "assert", "false", ":", "@", "@", "-", "5", ",", "18", "+", "5", ",", "21", "@", "@", "*", "/", "package", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "authz", ";", "import", "org", ".", "elasticsearch", ".", "ElasticsearchSecurityException", ";", "import", "org", ".", "elasticsearch", ".", "common", ".", "util", ".", "concurrent", ".", "ThreadContext", ";", "import", "org", ".", "elasticsearch", ".", "index", ".", "shard", ".", "SearchOperationListener", ";", "import", "org", ".", "elasticsearch", ".", "license", ".", "XPackLicenseState", ";", "import", "org", ".", "elasticsearch", ".", "search", ".", "SearchContextMissingException", ";", "import", "org", ".", "elasticsearch", ".", "search", ".", "internal", ".", "ScrollContext", ";", "import", "org", ".", "elasticsearch", ".", "search", ".", "internal", ".", "SearchContext", ";", "import", "org", ".", "elasticsearch", ".", "transport", ".", "TransportRequest", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "audit", ".", "AuditTrailService", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authc", ".", "Authentication", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authc", ".", "AuthenticationField", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "audit", ".", "AuditUtil", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authz", ".", "AuthorizationEngine", ".", "AuthorizationInfo", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authz", ".", "AuthorizationServiceField", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authz", ".", "accesscontrol", ".", "IndicesAccessControl", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "audit", ".", "AuditTrailService", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "audit", ".", "AuditUtil", ";", "import", "static", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "authz", ".", "AuthorizationService", ".", "AUTHORIZATION_INFO_KEY", ";", "import", "static", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "authz", ".", "AuthorizationService", ".", "ORIGINATING_ACTION_KEY", ";", "@", "@", "-", "50", ",", "6", "+", "53", ",", "9", "@", "@", "public", "void", "onNewScrollContext", "(", "SearchContext", "searchContext", ")", "{", "if", "(", "licenseState", ".", "isAuthAllowed", "(", "))", "{", "searchContext", ".", "scrollContext", "(", ").", "putInContext", "(", "AuthenticationField", ".", "AUTHENTICATION_KEY", ",", "Authentication", ".", "getAuthentication", "(", "threadContext", ")", ");", "IndicesAccessControl", "indicesAccessControl", "=", "threadContext", ".", "getTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ";", "assert", "indicesAccessControl", "!", "=", "null", ":", "\"", "thread", "context", "does", "not", "contain", "index", "access", "control", "\"", ";", "searchContext", ".", "scrollContext", "(", ").", "putInContext", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ",", "indicesAccessControl", ")", ";", "}", "}", "@", "@", "-", "66", ",", "6", "+", "72", ",", "38", "@", "@", "public", "void", "validateSearchContext", "(", "SearchContext", "searchContext", ",", "TransportRequest", "final", "String", "action", "=", "threadContext", ".", "getTransient", "(", "ORIGINATING_ACTION_KEY", ")", ";", "ensureAuthenticatedUserIsSame", "(", "originalAuth", ",", "current", ",", "auditTrailService", ",", "searchContext", ".", "id", "(", "),", "action", ",", "request", ",", "AuditUtil", ".", "extractRequestId", "(", "threadContext", ")", ",", "threadContext", ".", "getTransient", "(", "AUTHORIZATION_INFO_KEY", ")", ");", "/", "/", "piggyback", "on", "context", "validation", "to", "assert", "the", "DLS", "/", "FLS", "permissions", "on", "the", "thread", "context", "of", "the", "scroll", "search", "handler", "if", "(", "null", "=", "=", "threadContext", ".", "getTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ")", "{", "/", "/", "fill", "in", "the", "DLS", "and", "FLS", "permissions", "for", "the", "scroll", "search", "action", "from", "the", "scroll", "context", "IndicesAccessControl", "scrollIndicesAccessControl", "=", "searchContext", ".", "scrollContext", "(", ").", "getFromContext", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ";", "assert", "scrollIndicesAccessControl", "!", "=", "null", ":", "\"", "scroll", "does", "not", "contain", "index", "access", "control", "\"", ";", "threadContext", ".", "putTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ",", "scrollIndicesAccessControl", ")", ";", "}", "}", "}", "}", "@", "Override", "public", "void", "onPreFetchPhase", "(", "SearchContext", "searchContext", ")", "{", "ensureIndicesAccessControlForScrollThreadContext", "(", "searchContext", ")", ";", "}", "@", "Override", "public", "void", "onPreQueryPhase", "(", "SearchContext", "searchContext", ")", "{", "ensureIndicesAccessControlForScrollThreadContext", "(", "searchContext", ")", ";", "}", "void", "ensureIndicesAccessControlForScrollThreadContext", "(", "SearchContext", "searchContext", ")", "{", "if", "(", "licenseState", ".", "isAuthAllowed", "(", ")", "&", "&", "searchContext", ".", "scrollContext", "(", ")", "!", "=", "null", ")", "{", "IndicesAccessControl", "scrollIndicesAccessControl", "=", "searchContext", ".", "scrollContext", "(", ").", "getFromContext", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ";", "IndicesAccessControl", "threadIndicesAccessControl", "=", "threadContext", ".", "getTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ";", "if", "(", "scrollIndicesAccessControl", "!", "=", "threadIndicesAccessControl", ")", "{", "throw", "new", "ElasticsearchSecurityException", "(", "\"[", "\"", "+", "searchContext", ".", "id", "(", ")", "+", "\"", "]", "expected", "scroll", "indices", "access", "control", "[", "\"", "scrollIndicesAccessControl", ".", "toString", "(", ")", "+", "\"", "]", "but", "found", "[", "\"", "+", "threadIndicesAccessControl", ".", "toString", "(", ")", "+", "\"", "]", "in", "thread", "\"", "\"", "context", "\"", ");", "}", "}", "}", "@", "@", "-", "26", ",", "6", "+", "26", ",", "7", "@", "@", "import", "org", ".", "elasticsearch", ".", "common", ".", "xcontent", ".", "XContentBuilder", ";", "import", "org", ".", "elasticsearch", ".", "common", ".", "xcontent", ".", "XContentFactory", ";", "import", "org", ".", "elasticsearch", ".", "index", ".", "IndexModule", ";", "import", "org", ".", "elasticsearch", ".", "index", ".", "query", ".", "QueryBuilder", ";", "import", "org", ".", "elasticsearch", ".", "index", ".", "query", ".", "QueryBuilders", ";", "import", "org", ".", "elasticsearch", ".", "indices", ".", "IndicesRequestCache", ";", "import", "org", ".", "elasticsearch", ".", "join", ".", "ParentJoinPlugin", ";", "@", "@", "-", "768", ",", "6", "+", "769", ",", "114", "@", "@", "public", "void", "testQueryCache", "(", ")", "throws", "Exception", "{", "}", "}", "public", "void", "testScrollWithQueryCache", "(", ")", "{", "assertAcked", "(", "client", "(", ").", "admin", "(", ").", "indices", "(", ").", "prepareCreate", "(", "\"", "test", "\"", ")", ".", "setSettings", "(", "Settings", ".", "builder", "(", ").", "put", "(", "IndexModule", ".", "INDEX_QUERY_CACHE_EVERYTHING_SETTING", ".", "getKey", "(", "),", "true", ")", ")", ".", "addMapping", "(", "\"", "type1", "\"", ",", "\"", "field1", "\"", ",", "\"", "type", "=", "text", "\"", ",", "\"", "field2", "\"", ",", "\"", "type", "=", "text", "\"", ")", ")", ";", "final", "int", "numDocs", "=", "scaledRandomIntBetween", "(", "2", ",", "4", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "numDocs", ";", "i", "+", "+)", "{", "client", "(", ").", "prepareIndex", "(", "\"", "test", "\"", ",", "\"", "type1", "\"", ",", "String", ".", "valueOf", "(", "i", ")", ")", ".", "setSource", "(", "\"", "field1", "\"", ",", "\"", "value1", "\"", ",", "\"", "field2", "\"", ",", "\"", "value2", "\"", ")", ".", "get", "(", ");", "}", "refresh", "(", "\"", "test", "\"", ");", "final", "QueryBuilder", "cacheableQueryBuilder", "=", "constantScoreQuery", "(", "termQuery", "(", "\"", "field1", "\"", ",", "\"", "value1", "\"", "))", ";", "SearchResponse", "user1SearchResponse", "=", "null", ";", "SearchResponse", "user2SearchResponse", "=", "null", ";", "int", "scrolledDocsUser1", "=", "0", ";", "final", "int", "numScrollSearch", "=", "scaledRandomIntBetween", "(", "20", ",", "30", ")", ";", "try", "{", "for", "(", "int", "i", "=", "0", ";", "i", "<", "numScrollSearch", ";", "i", "+", "+)", "{", "if", "(", "randomBoolean", "(", "))", "{", "if", "(", "user2SearchResponse", "=", "=", "null", ")", "{", "user2SearchResponse", "=", "client", "(", ").", "filterWithHeader", "(", "Collections", ".", "singletonMap", "(", "BASIC_AUTH_HEADER", ",", "basicAuthHeaderValue", "(", "\"", "user2", "\"", ",", "USERS_PASSWD", ")", "))", ".", "prepareSearch", "(", "\"", "test", "\"", ")", ".", "setQuery", "(", "cacheableQueryBuilder", ")", ".", "setScroll", "(", "TimeValue", ".", "timeValueMinutes", "(", "10L", ")", ")", ".", "setSize", "(", "1", ")", ".", "setFetchSource", "(", "true", ")", ".", "get", "(", ");", "assertThat", "(", "user2SearchResponse", ".", "getHits", "(", ").", "getTotalHits", "(", "),", "is", "(", "(", "long", ")", "0", ")", ");", "assertThat", "(", "user2SearchResponse", ".", "getHits", "(", ").", "getHits", "(", ").", "length", ",", "is", "(", "0", ")", ");", "}", "else", "{", "/", "/", "make", "sure", "scroll", "is", "empty", "user2SearchResponse", "=", "client", "(", ")", ".", "filterWithHeader", "(", "Collections", ".", "singletonMap", "(", "BASIC_AUTH_HEADER", ",", "basicAuthHeaderValue", "(", "\"", "user2", "\"", ",", "USERS_PASSWD", ")", "))", ".", "prepareSearchScroll", "(", "user2SearchResponse", ".", "getScrollId", "(", "))", ".", "setScroll", "(", "TimeValue", ".", "timeValueMinutes", "(", "10L", ")", ")", ".", "get", "(", ");", "assertThat", "(", "user2SearchResponse", ".", "getHits", "(", ").", "getTotalHits", "(", "),", "is", "(", "(", "long", ")", "0", ")", ");", "assertThat", "(", "user2SearchResponse", ".", "getHits", "(", ").", "getHits", "(", ").", "length", ",", "is", "(", "0", ")", ");", "if", "(", "randomBoolean", "(", "))", "{", "/", "/", "maybe", "reuse", "the", "scroll", "even", "if", "empty", "client", "(", ").", "prepareClearScroll", "(", ").", "addScrollId", "(", "user2SearchResponse", ".", "getScrollId", "(", "))", ".", "get", "(", ");", "user2SearchResponse", "=", "null", ";", "}", "}", "}", "else", "{", "if", "(", "user1SearchResponse", "=", "=", "null", ")", "{", "user1SearchResponse", "=", "client", "(", ").", "filterWithHeader", "(", "Collections", ".", "singletonMap", "(", "BASIC_AUTH_HEADER", ",", "basicAuthHeaderValue", "(", "\"", "user1", "\"", ",", "USERS_PASSWD", ")", "))", ".", "prepareSearch", "(", "\"", "test", "\"", ")", ".", "setQuery", "(", "cacheableQueryBuilder", ")", ".", "setScroll", "(", "TimeValue", ".", "timeValueMinutes", "(", "10L", ")", ")", ".", "setSize", "(", "1", ")", ".", "setFetchSource", "(", "true", ")", ".", "get", "(", ");", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getTotalHits", "(", "),", "is", "(", "(", "long", ")", "numDocs", ")", ");", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getHits", "(", ").", "length", ",", "is", "(", "1", ")", ");", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getAt", "(", "0", ")", ".", "getSourceAsMap", "(", ").", "size", "(", "),", "is", "(", "1", ")", ");", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getAt", "(", "0", ")", ".", "getSourceAsMap", "(", ").", "get", "(", "\"", "field1", "\"", "),", "is", "(", "\"", "value1", "\"", "))", ";", "scrolledDocsUser1", "+", "+;", "}", "else", "{", "user1SearchResponse", "=", "client", "(", ")", ".", "filterWithHeader", "(", "Collections", ".", "singletonMap", "(", "BASIC_AUTH_HEADER", ",", "basicAuthHeaderValue", "(", "\"", "user1", "\"", ",", "USERS_PASSWD", ")", "))", ".", "prepareSearchScroll", "(", "user1SearchResponse", ".", "getScrollId", "(", "))", ".", "setScroll", "(", "TimeValue", ".", "timeValueMinutes", "(", "10L", ")", ")", ".", "get", "(", ");", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getTotalHits", "(", "),", "is", "(", "(", "long", ")", "numDocs", ")", ");", "if", "(", "scrolledDocsUser1", "<", "numDocs", ")", "{", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getHits", "(", ").", "length", ",", "is", "(", "1", ")", ");", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getAt", "(", "0", ")", ".", "getSourceAsMap", "(", ").", "size", "(", "),", "is", "(", "1", ")", ");", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getAt", "(", "0", ")", ".", "getSourceAsMap", "(", ").", "get", "(", "\"", "field1", "\"", "),", "is", "(", "\"", "value1", "\"", "))", ";", "scrolledDocsUser1", "+", "+;", "}", "else", "{", "assertThat", "(", "user1SearchResponse", ".", "getHits", "(", ").", "getHits", "(", ").", "length", ",", "is", "(", "0", ")", ");", "if", "(", "randomBoolean", "(", "))", "{", "/", "/", "maybe", "reuse", "the", "scroll", "even", "if", "empty", "if", "(", "user1SearchResponse", ".", "getScrollId", "(", ")", "!", "=", "null", ")", "{", "client", "(", ").", "prepareClearScroll", "(", ").", "addScrollId", "(", "user1SearchResponse", ".", "getScrollId", "(", "))", ".", "get", "(", ");", "}", "user1SearchResponse", "=", "null", ";", "scrolledDocsUser1", "=", "0", ";", "}", "}", "}", "}", "}", "}", "finally", "{", "if", "(", "user1SearchResponse", "!", "=", "null", ")", "{", "String", "scrollId", "=", "user1SearchResponse", ".", "getScrollId", "(", ");", "if", "(", "scrollId", "!", "=", "null", ")", "{", "client", "(", ").", "prepareClearScroll", "(", ").", "addScrollId", "(", "scrollId", ")", ".", "get", "(", ");", "}", "}", "if", "(", "user2SearchResponse", "!", "=", "null", ")", "{", "String", "scrollId", "=", "user2SearchResponse", ".", "getScrollId", "(", ");", "if", "(", "scrollId", "!", "=", "null", ")", "{", "client", "(", ").", "prepareClearScroll", "(", ").", "addScrollId", "(", "scrollId", ")", ".", "get", "(", ");", "}", "}", "}", "}", "public", "void", "testRequestCache", "(", ")", "throws", "Exception", "{", "assertAcked", "(", "client", "(", ").", "admin", "(", ").", "indices", "(", ").", "prepareCreate", "(", "\"", "test", "\"", ")", ".", "setSettings", "(", "Settings", ".", "builder", "(", ").", "put", "(", "IndicesRequestCache", ".", "INDEX_CACHE_REQUEST_ENABLED_SETTING", ".", "getKey", "(", "),", "true", ")", ")", "@", "@", "-", "22", ",", "9", "+", "22", ",", "11", "@", "@", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authc", ".", "Authentication", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authc", ".", "Authentication", ".", "RealmRef", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authc", ".", "AuthenticationField", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authz", ".", "AuthorizationEngine", ".", "AuthorizationInfo", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authz", ".", "AuthorizationServiceField", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authz", ".", "accesscontrol", ".", "IndicesAccessControl", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "user", ".", "User", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "audit", ".", "AuditTrailService", ";", "import", "org", ".", "elasticsearch", ".", "xpack", ".", "core", ".", "security", ".", "authz", ".", "AuthorizationEngine", ".", "AuthorizationInfo", ";", "import", "java", ".", "util", ".", "Collections", ";", "@", "@", "-", "34", ",", "6", "+", "36", ",", "8", "@", "@", "import", "static", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "authz", ".", "AuthorizationService", ".", "ORIGINATING_ACTION_KEY", ";", "import", "static", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "authz", ".", "AuthorizationServiceTests", ".", "authzInfoRoles", ";", "import", "static", "org", ".", "elasticsearch", ".", "xpack", ".", "security", ".", "authz", ".", "SecuritySearchOperationListener", ".", "ensureAuthenticatedUserIsSame", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "is", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "nullValue", ";", "import", "static", "org", ".", "mockito", ".", "Matchers", ".", "eq", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "times", ";", "@", "@", "-", "69", ",", "6", "+", "73", ",", "8", "@", "@", "public", "void", "testOnNewContextSetsAuthentication", "(", ")", "throws", "Exception", "{", "AuditTrailService", "auditTrailService", "=", "mock", "(", "AuditTrailService", ".", "class", ")", ";", "Authentication", "authentication", "=", "new", "Authentication", "(", "new", "User", "(", "\"", "test", "\"", ",", "\"", "role", "\"", "),", "new", "RealmRef", "(", "\"", "realm", "\"", ",", "\"", "file", "\"", ",", "\"", "node", "\"", "),", "null", ")", ";", "authentication", ".", "writeToContext", "(", "threadContext", ")", ";", "IndicesAccessControl", "indicesAccessControl", "=", "mock", "(", "IndicesAccessControl", ".", "class", ")", ";", "threadContext", ".", "putTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ",", "indicesAccessControl", ")", ";", "SecuritySearchOperationListener", "listener", "=", "new", "SecuritySearchOperationListener", "(", "threadContext", ",", "licenseState", ",", "auditTrailService", ")", ";", "listener", ".", "onNewScrollContext", "(", "testSearchContext", ")", ";", "@", "@", "-", "77", ",", "6", "+", "83", ",", "9", "@", "@", "public", "void", "testOnNewContextSetsAuthentication", "(", ")", "throws", "Exception", "{", "assertEquals", "(", "authentication", ",", "contextAuth", ")", ";", "assertEquals", "(", "scroll", ",", "testSearchContext", ".", "scrollContext", "(", ").", "scroll", ")", ";", "assertThat", "(", "testSearchContext", ".", "scrollContext", "(", ").", "getFromContext", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ",", "is", "(", "indicesAccessControl", ")", ");", "verify", "(", "licenseState", ")", ".", "isAuthAllowed", "(", ");", "verifyZeroInteractions", "(", "auditTrailService", ")", ";", "}", "@", "@", "-", "86", ",", "6", "+", "95", ",", "8", "@", "@", "public", "void", "testValidateSearchContext", "(", ")", "throws", "Exception", "{", "testSearchContext", ".", "scrollContext", "(", "new", "ScrollContext", "(", "))", ";", "testSearchContext", ".", "scrollContext", "(", ").", "putInContext", "(", "AuthenticationField", ".", "AUTHENTICATION_KEY", ",", "new", "Authentication", "(", "new", "User", "(", "\"", "test", "\"", ",", "\"", "role", "\"", "),", "new", "RealmRef", "(", "\"", "realm", "\"", ",", "\"", "file", "\"", ",", "\"", "node", "\"", "),", "null", ")", ");", "final", "IndicesAccessControl", "indicesAccessControl", "=", "mock", "(", "IndicesAccessControl", ".", "class", ")", ";", "testSearchContext", ".", "scrollContext", "(", ").", "putInContext", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ",", "indicesAccessControl", ")", ";", "testSearchContext", ".", "scrollContext", "(", ").", "scroll", "=", "new", "Scroll", "(", "TimeValue", ".", "timeValueSeconds", "(", "2L", ")", ");", "XPackLicenseState", "licenseState", "=", "mock", "(", "XPackLicenseState", ".", "class", ")", ";", "when", "(", "licenseState", ".", "isAuthAllowed", "(", "))", ".", "thenReturn", "(", "true", ")", ";", "@", "@", "-", "97", ",", "6", "+", "108", ",", "7", "@", "@", "public", "void", "testValidateSearchContext", "(", ")", "throws", "Exception", "{", "Authentication", "authentication", "=", "new", "Authentication", "(", "new", "User", "(", "\"", "test", "\"", ",", "\"", "role", "\"", "),", "new", "RealmRef", "(", "\"", "realm", "\"", ",", "\"", "file", "\"", ",", "\"", "node", "\"", "),", "null", ")", ";", "authentication", ".", "writeToContext", "(", "threadContext", ")", ";", "listener", ".", "validateSearchContext", "(", "testSearchContext", ",", "Empty", ".", "INSTANCE", ")", ";", "assertThat", "(", "threadContext", ".", "getTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ",", "is", "(", "indicesAccessControl", ")", ");", "verify", "(", "licenseState", ")", ".", "isAuthAllowed", "(", ");", "verifyZeroInteractions", "(", "auditTrailService", ")", ";", "}", "@", "@", "-", "107", ",", "6", "+", "119", ",", "7", "@", "@", "public", "void", "testValidateSearchContext", "(", ")", "throws", "Exception", "{", "Authentication", "authentication", "=", "new", "Authentication", "(", "new", "User", "(", "\"", "test", "\"", ",", "\"", "role", "\"", "),", "new", "RealmRef", "(", "realmName", ",", "\"", "file", "\"", ",", "nodeName", ")", ",", "null", ")", ";", "authentication", ".", "writeToContext", "(", "threadContext", ")", ";", "listener", ".", "validateSearchContext", "(", "testSearchContext", ",", "Empty", ".", "INSTANCE", ")", ";", "assertThat", "(", "threadContext", ".", "getTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ",", "is", "(", "indicesAccessControl", ")", ");", "verify", "(", "licenseState", ",", "times", "(", "2", ")", ").", "isAuthAllowed", "(", ");", "verifyZeroInteractions", "(", "auditTrailService", ")", ";", "}", "@", "@", "-", "123", ",", "6", "+", "136", ",", "7", "@", "@", "public", "void", "testValidateSearchContext", "(", ")", "throws", "Exception", "{", "final", "InternalScrollSearchRequest", "request", "=", "new", "InternalScrollSearchRequest", "(", ");", "SearchContextMissingException", "expected", "=", "expectThrows", "(", "SearchContextMissingException", ".", "class", ",", "(", ")", "-", ">", "listener", ".", "validateSearchContext", "(", "testSearchContext", ",", "request", ")", ");", "assertThat", "(", "threadContext", ".", "getTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ",", "nullValue", "(", "))", ";", "assertEquals", "(", "testSearchContext", ".", "id", "(", "),", "expected", ".", "id", "(", "))", ";", "verify", "(", "licenseState", ",", "times", "(", "3", ")", ").", "isAuthAllowed", "(", ");", "verify", "(", "auditTrailService", ")", ".", "accessDenied", "(", "eq", "(", "null", ")", ",", "eq", "(", "authentication", ")", ",", "eq", "(", "\"", "action", "\"", "),", "eq", "(", "request", ")", ",", "@", "@", "-", "141", ",", "6", "+", "155", ",", "7", "@", "@", "public", "void", "testValidateSearchContext", "(", ")", "throws", "Exception", "{", "threadContext", ".", "putTransient", "(", "ORIGINATING_ACTION_KEY", ",", "\"", "action", "\"", ");", "final", "InternalScrollSearchRequest", "request", "=", "new", "InternalScrollSearchRequest", "(", ");", "listener", ".", "validateSearchContext", "(", "testSearchContext", ",", "request", ")", ";", "assertThat", "(", "threadContext", ".", "getTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ",", "is", "(", "indicesAccessControl", ")", ");", "verify", "(", "licenseState", ",", "times", "(", "4", ")", ").", "isAuthAllowed", "(", ");", "verifyNoMoreInteractions", "(", "auditTrailService", ")", ";", "}", "@", "@", "-", "159", ",", "6", "+", "174", ",", "7", "@", "@", "public", "void", "testValidateSearchContext", "(", ")", "throws", "Exception", "{", "final", "InternalScrollSearchRequest", "request", "=", "new", "InternalScrollSearchRequest", "(", ");", "SearchContextMissingException", "expected", "=", "expectThrows", "(", "SearchContextMissingException", ".", "class", ",", "(", ")", "-", ">", "listener", ".", "validateSearchContext", "(", "testSearchContext", ",", "request", ")", ");", "assertThat", "(", "threadContext", ".", "getTransient", "(", "AuthorizationServiceField", ".", "INDICES_PERMISSIONS_KEY", ")", ",", "nullValue", "(", "))", ";", "assertEquals", "(", "testSearchContext", ".", "id", "(", "),", "expected", ".", "id", "(", "))", ";", "verify", "(", "licenseState", ",", "times", "(", "5", ")", ").", "isAuthAllowed", "(", ");", "verify", "(", "auditTrailService", ")", ".", "accessDenied", "(", "eq", "(", "null", ")", ",", "eq", "(", "authentication", ")", ",", "eq", "(", "\"", "action", "\"", "),", "eq", "(", "request", ")", ","], "docstring_tokens": ["running", "the", "same", "query"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "5", ",", "6", "+", "5", ",", "11", "@", "@", "http", ":", "//", "s", ".", "apache", ".", "org", "/", "luceneversions", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "Lucene", "7", ".", "1", ".", "0", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "Changes", "in", "Runtime", "Behavior", "*", "Resolving", "of", "external", "entities", "in", "queryparser", "/", "xml", "/", "CoreParser", "is", "disallowed", "by", "default", ".", "See", "SOLR", "-", "11477", "for", "details", ".", "New", "Features", "*", "LUCENE", "-", "7970", ":", "Add", "a", "shape", "to", "Geo3D", "that", "consists", "of", "multiple", "planes", "that", "@", "@", "-", "111", ",", "6", "+", "116", ",", "9", "@", "@", "Bug", "Fixes", "*", "LUCENE", "-", "7957", ":", "ConjunctionScorer", ".", "getChildren", "was", "failing", "to", "return", "all", "child", "scorers", "(", "Adrien", "Grand", ",", "Mike", "McCandless", ")", "*", "SOLR", "-", "11477", ":", "Disallow", "resolving", "of", "external", "entities", "in", "queryparser", "/", "xml", "/", "CoreParser", "by", "default", ".", "(", "Michael", "Stepankin", ",", "Olga", "Barinova", ",", "Uwe", "Schindler", ",", "Christine", "Poerschke", ")", "Build", "*", "SOLR", "-", "11181", ":", "Switch", "order", "of", "maven", "artifact", "publishing", "procedure", ":", "deploy", "first", "@", "@", "-", "23", ",", "11", "+", "23", ",", "17", "@", "@", "import", "org", ".", "apache", ".", "lucene", ".", "search", ".", "spans", ".", "SpanQuery", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Element", ";", "import", "org", ".", "xml", ".", "sax", ".", "EntityResolver", ";", "import", "org", ".", "xml", ".", "sax", ".", "ErrorHandler", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "util", ".", "Locale", ";", "/", "**", "*", "Assembles", "a", "QueryBuilder", "which", "uses", "only", "core", "Lucene", "Query", "objects", "@", "@", "-", "111", ",", "6", "+", "117", ",", "10", "@", "@", "protected", "CoreParser", "(", "String", "defaultField", ",", "Analyzer", "analyzer", ",", "QueryParser", "parser", ")", "queryFactory", ".", "addBuilder", "(", "\"", "SpanNot", "\"", ",", "snot", ")", ";", "}", "/", "**", "*", "Parses", "the", "given", "stream", "as", "XML", "file", "and", "returns", "a", "{", "@", "link", "Query", "}", ".", "*", "By", "default", "this", "disallows", "external", "entities", "for", "security", "reasons", ".", "*", "/", "public", "Query", "parse", "(", "InputStream", "xmlStream", ")", "throws", "ParserException", "{", "return", "getQuery", "(", "parseXML", "(", "xmlStream", ")", ".", "getDocumentElement", "(", "))", ";", "}", "@", "@", "-", "133", ",", "23", "+", "143", ",", "47", "@", "@", "public", "void", "addSpanQueryBuilder", "(", "String", "nodeName", ",", "SpanQueryBuilder", "builder", ")", "{", "spanFactory", ".", "addBuilder", "(", "nodeName", ",", "builder", ")", ";", "}", "static", "Document", "parseXML", "(", "InputStream", "pXmlFile", ")", "throws", "ParserException", "{", "DocumentBuilderFactory", "dbf", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "DocumentBuilder", "db", "=", "null", ";", "/", "**", "*", "Returns", "a", "SAX", "{", "@", "link", "EntityResolver", "}", "to", "be", "used", "by", "{", "@", "link", "DocumentBuilder", "}", ".", "*", "By", "default", "this", "returns", "{", "@", "link", "#", "DISALLOW_EXTERNAL_ENTITY_RESOLVER", "}", ",", "which", "disallows", "the", "*", "expansion", "of", "external", "entities", "(", "for", "security", "reasons", ")", ".", "To", "restore", "legacy", "behavior", ",", "*", "override", "this", "method", "to", "return", "{", "@", "code", "null", "}", ".", "*", "/", "protected", "EntityResolver", "getEntityResolver", "(", ")", "{", "return", "DISALLOW_EXTERNAL_ENTITY_RESOLVER", ";", "}", "/", "**", "*", "Subclass", "and", "override", "to", "return", "a", "SAX", "{", "@", "link", "ErrorHandler", "}", "to", "be", "used", "by", "{", "@", "link", "DocumentBuilder", "}", ".", "*", "By", "default", "this", "returns", "{", "@", "code", "null", "}", "so", "no", "error", "handler", "is", "used", ".", "*", "This", "method", "can", "be", "used", "to", "redirect", "XML", "parse", "errors", "/", "warnings", "to", "a", "custom", "logger", ".", "*", "/", "protected", "ErrorHandler", "getErrorHandler", "(", ")", "{", "return", "null", ";", "}", "private", "Document", "parseXML", "(", "InputStream", "pXmlFile", ")", "throws", "ParserException", "{", "final", "DocumentBuilderFactory", "dbf", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "dbf", ".", "setValidating", "(", "false", ")", ";", "try", "{", "db", "=", "dbf", ".", "newDocumentBuilder", "(", ");", "}", "catch", "(", "Exception", "se", ")", "{", "throw", "new", "ParserException", "(", "\"", "XML", "Parser", "configuration", "error", "\"", ",", "se", ")", ";", "dbf", ".", "setFeature", "(", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "}", "catch", "(", "ParserConfigurationException", "e", ")", "{", "/", "/", "ignore", "since", "all", "implementations", "are", "required", "to", "support", "the", "/", "/", "{", "@", "link", "javax", ".", "xml", ".", "XMLConstants", "#", "FEATURE_SECURE_PROCESSING", "}", "feature", "}", "org", ".", "w3c", ".", "dom", ".", "Document", "doc", "=", "null", ";", "final", "DocumentBuilder", "db", ";", "try", "{", "doc", "=", "db", ".", "parse", "(", "pXmlFile", ")", ";", "db", "=", "dbf", ".", "newDocumentBuilder", "(", ");", "}", "catch", "(", "Exception", "se", ")", "{", "throw", "new", "ParserException", "(", "\"", "XML", "Parser", "configuration", "error", ".", "\",", "se", ")", ";", "}", "catch", "(", "Exception", "se", ")", "{", "throw", "new", "ParserException", "(", "\"", "Error", "parsing", "XML", "stream", ":", "\"", "+", "se", ",", "se", ")", ";", "try", "{", "db", ".", "setEntityResolver", "(", "getEntityResolver", "(", "))", ";", "db", ".", "setErrorHandler", "(", "getErrorHandler", "(", "))", ";", "return", "db", ".", "parse", "(", "pXmlFile", ")", ";", "}", "catch", "(", "Exception", "se", ")", "{", "throw", "new", "ParserException", "(", "\"", "Error", "parsing", "XML", "stream", ":", "\"", "+", "se", ",", "se", ")", ";", "}", "return", "doc", ";", "}", "public", "Query", "getQuery", "(", "Element", "e", ")", "throws", "ParserException", "{", "@", "@", "-", "160", ",", "4", "+", "194", ",", "11", "@", "@", "public", "Query", "getQuery", "(", "Element", "e", ")", "throws", "ParserException", "{", "public", "SpanQuery", "getSpanQuery", "(", "Element", "e", ")", "throws", "ParserException", "{", "return", "spanFactory", ".", "getSpanQuery", "(", "e", ")", ";", "}", "public", "static", "final", "EntityResolver", "DISALLOW_EXTERNAL_ENTITY_RESOLVER", "=", "(", "String", "publicId", ",", "String", "systemId", ")", "-", ">", "{", "throw", "new", "SAXException", "(", "String", ".", "format", "(", "Locale", ".", "ENGLISH", ",", "\"", "External", "Entity", "resolving", "unsupported", ":", "publicId", "=", "\\\"", "%", "s", "\\", "\"", "systemId", "=", "\\\"", "%", "s", "\\", "\"\"", ",", "publicId", ",", "systemId", ")", ");", "}", ";", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "19", "@", "@", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "?>", "<", "!", "DOCTYPE", "TermQuery", "SYSTEM", "\"", "foo", ":", "//", "bar", ".", "xyz", "/", "mydtd", "\"", ">", "<", "!-", "-", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "the", "License", ".", "-", "->", "<", "TermQuery", "fieldName", "=", "\"", "contents", "\"", ">", "sumitomo", "<", "/", "TermQuery", ">", "@", "@", "-", "0", ",", "0", "+", "1", ",", "23", "@", "@", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "?>", "<", "!", "DOCTYPE", "TermQuery", "[", "<", "!", "ENTITY", "internalTerm", "\"", "sumitomo", "\"", ">", "<", "!", "ENTITY", "externalTerm", "SYSTEM", "\"", "foo", ":", "//", "bar", ".", "xyz", "/", "external", "\"", ">", "<", "!", "ENTITY", "%", "myParameterEntity", "\"", "foo", ":", "//", "bar", ".", "xyz", "/", "param", "\"", ">", "]", ">", "<", "!-", "-", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "the", "License", ".", "-", "->", "<", "TermQuery", "fieldName", "=", "\"", "contents", "\"", ">&", "internalTerm", ";", "&", "externalTerm", ";", "</", "TermQuery", ">", "@", "@", "-", "30", ",", "6", "+", "30", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "lucene", ".", "search", ".", "spans", ".", "SpanQuery", ";", "import", "org", ".", "apache", ".", "lucene", ".", "util", ".", "LuceneTestCase", ";", "import", "org", ".", "junit", ".", "AfterClass", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "@", "@", "-", "67", ",", "6", "+", "68", ",", "18", "@", "@", "public", "void", "testTermQueryXML", "(", ")", "throws", "ParserException", ",", "IOException", "{", "dumpResults", "(", "\"", "TermQuery", "\"", ",", "q", ",", "5", ")", ";", "}", "public", "void", "test_DOCTYPE_TermQueryXML", "(", ")", "throws", "ParserException", ",", "IOException", "{", "SAXException", "saxe", "=", "LuceneTestCase", ".", "expectThrows", "(", "ParserException", ".", "class", ",", "SAXException", ".", "class", ",", "(", ")", "-", ">", "parse", "(", "\"", "DOCTYPE_TermQuery", ".", "xml", "\"", "))", ";", "assertTrue", "(", "saxe", ".", "getMessage", "(", ").", "startsWith", "(", "\"", "External", "Entity", "resolving", "unsupported", ":", "\")", ");", "}", "public", "void", "test_ENTITY_TermQueryXML", "(", ")", "throws", "ParserException", ",", "IOException", "{", "SAXException", "saxe", "=", "LuceneTestCase", ".", "expectThrows", "(", "ParserException", ".", "class", ",", "SAXException", ".", "class", ",", "(", ")", "-", ">", "parse", "(", "\"", "ENTITY_TermQuery", ".", "xml", "\"", "))", ";", "assertTrue", "(", "saxe", ".", "getMessage", "(", ").", "startsWith", "(", "\"", "External", "Entity", "resolving", "unsupported", ":", "\")", ");", "}", "public", "void", "testTermQueryEmptyXML", "(", ")", "throws", "ParserException", ",", "IOException", "{", "parseShouldFail", "(", "\"", "TermQueryEmpty", ".", "xml", "\"", ",", "\"", "TermQuery", "has", "no", "text", "\"", ");", "@", "@", "-", "64", ",", "6", "+", "64", ",", "9", "@", "@", "Upgrade", "Notes", "events", "caused", "by", "updates", ",", "commits", ",", "or", "optimize", ",", "write", "your", "own", "listener", "as", "native", "Java", "class", "as", "part", "of", "a", "Solr", "plugin", ".", "*", "SOLR", "-", "11477", ":", "in", "the", "XML", "query", "parser", "(", "defType", "=", "xmlparser", "or", "{", "!", "xmlparser", ".", "..", "}", ")", "the", "resolving", "of", "external", "entities", "is", "now", "disallowed", "by", "default", ".", "New", "Features", "*", "SOLR", "-", "10339", ":", "New", "set", "-", "trigger", "and", "remove", "-", "trigger", "APIs", "for", "autoscaling", ".", "(", "shalin", ")", "@", "@", "-", "233", ",", "6", "+", "236", ",", "9", "@", "@", "Bug", "Fixes", "*", "SOLR", "-", "11449", ":", "MoveReplicaCmd", "mistakenly", "called", "registerCollectionStateWatcher", "on", "failure", ".", "(", "ab", ")", "*", "SOLR", "-", "11477", ":", "Disallow", "resolving", "of", "external", "entities", "in", "the", "XML", "query", "parser", "(", "defType", "=", "xmlparser", ")", ".", "(", "Michael", "Stepankin", ",", "Olga", "Barinova", ",", "Uwe", "Schindler", ",", "Christine", "Poerschke", ")", "Optimizations", "@", "@", "-", "25", ",", "11", "+", "25", ",", "13", "@", "@", "import", "org", ".", "apache", ".", "lucene", ".", "queryparser", ".", "xml", ".", "builders", ".", "SpanQueryBuilder", ";", "import", "org", ".", "apache", ".", "solr", ".", "common", ".", "SolrException", ";", "import", "org", ".", "apache", ".", "solr", ".", "common", ".", "util", ".", "NamedList", ";", "import", "org", ".", "apache", ".", "solr", ".", "common", ".", "util", ".", "XMLErrorLogger", ";", "import", "org", ".", "apache", ".", "solr", ".", "core", ".", "SolrResourceLoader", ";", "import", "org", ".", "apache", ".", "solr", ".", "request", ".", "SolrQueryRequest", ";", "import", "org", ".", "apache", ".", "solr", ".", "util", ".", "plugin", ".", "NamedListInitializedPlugin", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "import", "org", ".", "xml", ".", "sax", ".", "ErrorHandler", ";", "/", "**", "*", "Assembles", "a", "QueryBuilder", "which", "uses", "Query", "objects", "from", "Solr", "'", "s", "<", "code", ">", "search", "<", "/", "code", ">", "module", "@", "@", "-", "38", ",", "6", "+", "40", ",", "7", "@", "@", "public", "class", "SolrCoreParser", "extends", "CoreParser", "implements", "NamedListInitializedPlugin", "{", "private", "static", "final", "Logger", "log", "=", "LoggerFactory", ".", "getLogger", "(", "MethodHandles", ".", "lookup", "(", ").", "lookupClass", "(", "))", ";", "private", "static", "final", "XMLErrorLogger", "xmllog", "=", "new", "XMLErrorLogger", "(", "log", ")", ";", "protected", "final", "SolrQueryRequest", "req", ";", "@", "@", "-", "97", ",", "4", "+", "100", ",", "9", "@", "@", "public", "void", "init", "(", "NamedList", "initArgs", ")", "{", "}", "}", "@", "Override", "protected", "ErrorHandler", "getErrorHandler", "(", ")", "{", "return", "xmllog", ";", "}", "}"], "docstring_tokens": ["using", "a", "Config", "API", "add-listener", "command", "to", "reach", "the", "RunExecutableListener", "class"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "842", ",", "20", "+", "842", ",", "15", "@", "@", "EXPORT_SYMBOL_GPL", "(", "vmf_insert_pfn_pud", ")", ";", "#", "endif", "/", "*", "CONFIG_HAVE_ARCH_TRANSPARENT_HUGEPAGE_PUD", "*", "/", "static", "void", "touch_pmd", "(", "struct", "vm_area_struct", "*", "vma", ",", "unsigned", "long", "addr", ",", "pmd_t", "*", "pmd", ")", "pmd_t", "*", "pmd", ",", "int", "flags", ")", "{", "pmd_t", "_pmd", ";", "/", "*", "*", "We", "should", "set", "the", "dirty", "bit", "only", "for", "FOLL_WRITE", "but", "for", "now", "*", "the", "dirty", "bit", "in", "the", "pmd", "is", "meaningless", ".", "And", "if", "the", "dirty", "*", "bit", "will", "become", "meaningful", "and", "we", "'", "ll", "only", "set", "it", "with", "*", "FOLL_WRITE", ",", "an", "atomic", "set_bit", "will", "be", "required", "on", "the", "pmd", "to", "*", "set", "the", "young", "bit", ",", "instead", "of", "the", "current", "set_pmd_at", ".", "*", "/", "_pmd", "=", "pmd_mkyoung", "(", "pmd_mkdirty", "(", "*", "pmd", ")", ");", "_pmd", "=", "pmd_mkyoung", "(", "*", "pmd", ")", ";", "if", "(", "flags", "&", "FOLL_WRITE", ")", "_pmd", "=", "pmd_mkdirty", "(", "_pmd", ")", ";", "if", "(", "pmdp_set_access_flags", "(", "vma", ",", "addr", "&", "HPAGE_PMD_MASK", ",", "pmd", ",", "_pmd", ",", "1", ")", ")", "pmd", ",", "_pmd", ",", "flags", "&", "FOLL_WRITE", ")", ")", "update_mmu_cache_pmd", "(", "vma", ",", "addr", ",", "pmd", ")", ";", "}", "@", "@", "-", "884", ",", "7", "+", "879", ",", "7", "@", "@", "struct", "page", "*", "follow_devmap_pmd", "(", "struct", "vm_area_struct", "*", "vma", ",", "unsigned", "long", "addr", ",", "return", "NULL", ";", "if", "(", "flags", "&", "FOLL_TOUCH", ")", "touch_pmd", "(", "vma", ",", "addr", ",", "pmd", ")", ";", "touch_pmd", "(", "vma", ",", "addr", ",", "pmd", ",", "flags", ")", ";", "/", "*", "*", "device", "mapped", "pages", "can", "only", "be", "returned", "if", "the", "@", "@", "-", "995", ",", "20", "+", "990", ",", "15", "@", "@", "int", "copy_huge_pmd", "(", "struct", "mm_struct", "*", "dst_mm", ",", "struct", "mm_struct", "*", "src_mm", ",", "#", "ifdef", "CONFIG_HAVE_ARCH_TRANSPARENT_HUGEPAGE_PUD", "static", "void", "touch_pud", "(", "struct", "vm_area_struct", "*", "vma", ",", "unsigned", "long", "addr", ",", "pud_t", "*", "pud", ")", "pud_t", "*", "pud", ",", "int", "flags", ")", "{", "pud_t", "_pud", ";", "/", "*", "*", "We", "should", "set", "the", "dirty", "bit", "only", "for", "FOLL_WRITE", "but", "for", "now", "*", "the", "dirty", "bit", "in", "the", "pud", "is", "meaningless", ".", "And", "if", "the", "dirty", "*", "bit", "will", "become", "meaningful", "and", "we", "'", "ll", "only", "set", "it", "with", "*", "FOLL_WRITE", ",", "an", "atomic", "set_bit", "will", "be", "required", "on", "the", "pud", "to", "*", "set", "the", "young", "bit", ",", "instead", "of", "the", "current", "set_pud_at", ".", "*", "/", "_pud", "=", "pud_mkyoung", "(", "pud_mkdirty", "(", "*", "pud", ")", ");", "_pud", "=", "pud_mkyoung", "(", "*", "pud", ")", ";", "if", "(", "flags", "&", "FOLL_WRITE", ")", "_pud", "=", "pud_mkdirty", "(", "_pud", ")", ";", "if", "(", "pudp_set_access_flags", "(", "vma", ",", "addr", "&", "HPAGE_PUD_MASK", ",", "pud", ",", "_pud", ",", "1", ")", ")", "pud", ",", "_pud", ",", "flags", "&", "FOLL_WRITE", ")", ")", "update_mmu_cache_pud", "(", "vma", ",", "addr", ",", "pud", ")", ";", "}", "@", "@", "-", "1031", ",", "7", "+", "1021", ",", "7", "@", "@", "struct", "page", "*", "follow_devmap_pud", "(", "struct", "vm_area_struct", "*", "vma", ",", "unsigned", "long", "addr", ",", "return", "NULL", ";", "if", "(", "flags", "&", "FOLL_TOUCH", ")", "touch_pud", "(", "vma", ",", "addr", ",", "pud", ")", ";", "touch_pud", "(", "vma", ",", "addr", ",", "pud", ",", "flags", ")", ";", "/", "*", "*", "device", "mapped", "pages", "can", "only", "be", "returned", "if", "the", "@", "@", "-", "1424", ",", "7", "+", "1414", ",", "7", "@", "@", "struct", "page", "*", "follow_trans_huge_pmd", "(", "struct", "vm_area_struct", "*", "vma", ",", "page", "=", "pmd_page", "(", "*", "pmd", ")", ";", "VM_BUG_ON_PAGE", "(", "!", "PageHead", "(", "page", ")", "&", "&", "!", "is_zone_device_page", "(", "page", ")", ",", "page", ")", ";", "if", "(", "flags", "&", "FOLL_TOUCH", ")", "touch_pmd", "(", "vma", ",", "addr", ",", "pmd", ")", ";", "touch_pmd", "(", "vma", ",", "addr", ",", "pmd", ",", "flags", ")", ";", "if", "(", "(", "flags", "&", "FOLL_MLOCK", ")", "&", "&", "(", "vma", "-", ">", "vm_flags", "&", "VM_LOCKED", ")", ")", "{", "/", "*", "*", "We", "don", "'", "t", "mlock", "(", ")", "pte", "-", "mapped", "THPs", ".", "This", "way", "we", "can", "avoid"], "docstring_tokens": ["using", "the", "zero", "value", "as", "an", "indicator", "that", "a", "global", "variable", "hasn't", "been", "initialized"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1206", ",", "8", "+", "1206", ",", "11", "@", "@", "static", "inline", "void", "ext4_r_blocks_count_set", "(", "struct", "ext4_super_block", "*", "es", ",", "static", "inline", "loff_t", "ext4_isize", "(", "struct", "ext4_inode", "*", "raw_inode", ")", "{", "return", "(", "(", "loff_t", ")", "le32_to_cpu", "(", "raw_inode", "-", ">", "i_size_high", ")", "<", "<", "32", ")", "|", "le32_to_cpu", "(", "raw_inode", "-", ">", "i_size_lo", ")", ";", "if", "(", "S_ISREG", "(", "le16_to_cpu", "(", "raw_inode", "-", ">", "i_mode", ")", "))", "return", "(", "(", "loff_t", ")", "le32_to_cpu", "(", "raw_inode", "-", ">", "i_size_high", ")", "<", "<", "32", ")", "|", "le32_to_cpu", "(", "raw_inode", "-", ">", "i_size_lo", ")", ";", "else", "return", "(", "loff_t", ")", "le32_to_cpu", "(", "raw_inode", "-", ">", "i_size_lo", ")", ";", "}", "static", "inline", "void", "ext4_isize_set", "(", "struct", "ext4_inode", "*", "raw_inode", ",", "loff_t", "i_size", ")", "@", "@", "-", "360", ",", "9", "+", "360", ",", "9", "@", "@", "static", "int", "ext4_block_to_path", "(", "struct", "inode", "*", "inode", ",", "final", "=", "ptrs", ";", "}", "else", "{", "ext4_warning", "(", "inode", "-", ">", "i_sb", ",", "\"", "ext4_block_to_path", "\"", ",", "\"", "block", "%", "lu", ">", "max", "\"", ",", "\"", "block", "%", "lu", ">", "max", "in", "inode", "%", "lu", "\"", ",", "i_block", "+", "direct_blocks", "+", "indirect_blocks", "+", "double_blocks", ")", ";", "indirect_blocks", "+", "double_blocks", ",", "inode", "-", ">", "i_ino", ")", ";", "}", "if", "(", "boundary", ")", "*", "boundary", "=", "final", "-", "1", "-", "(", "i_block", "&", "(", "ptrs", "-", "1", ")", ");"], "docstring_tokens": ["by", "attempting", "to", "mount", "a", "crafted", "ext4", "filesystem", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "0", ",", "0", "+", "1", ",", "11", "@", "@", "set", "hive", ".", "test", ".", "authz", ".", "sstd", ".", "hs2", ".", "mode", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "sqlstd", ".", "SQLStdHiveAuthorizerFactoryForTest", ";", "set", "hive", ".", "security", ".", "authenticator", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "SessionStateConfigUserAuthenticator", ";", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "true", ";", "-", "-", "check", "alter", "-", "drop", "on", "partition", "create", "table", "auth_trunc2", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", ";", "alter", "table", "auth_trunc2", "add", "partition", "(", "j", "=", "42", ")", ";", "set", "user", ".", "name", "=", "user1", ";", "alter", "table", "auth_trunc2", "drop", "partition", "(", "j", "=", "42", ")", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "19", "@", "@", "set", "hive", ".", "test", ".", "authz", ".", "sstd", ".", "hs2", ".", "mode", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "sqlstd", ".", "SQLStdHiveAuthorizerFactoryForTest", ";", "set", "hive", ".", "security", ".", "authenticator", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "SessionStateConfigUserAuthenticator", ";", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "true", ";", "dfs", "$", "{", "system", ":", "test", ".", "dfs", ".", "mkdir", "}", "$", "{", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "export", "/", "temp", ";", "dfs", "-", "rmr", "$", "{", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "export", ";", "dfs", "$", "{", "system", ":", "test", ".", "dfs", ".", "mkdir", "}", "$", "{", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "export", "/", ";", "-", "-", "check", "export", "on", "partition", "create", "table", "auth_export_ptn", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", ";", "alter", "table", "auth_export_ptn", "add", "partition", "(", "j", "=", "42", ")", ";", "set", "user", ".", "name", "=", "user1", ";", "export", "table", "auth_export_ptn", "partition", "(", "j", "=", "42", ")", "to", "'", "pfile", ":", "//", "${", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "export", "'", ";", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "false", ";", "drop", "table", "auth_export_ptn", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "23", "@", "@", "set", "hive", ".", "test", ".", "authz", ".", "sstd", ".", "hs2", ".", "mode", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "sqlstd", ".", "SQLStdHiveAuthorizerFactoryForTest", ";", "set", "hive", ".", "security", ".", "authenticator", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "SessionStateConfigUserAuthenticator", ";", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "true", ";", "dfs", "$", "{", "system", ":", "test", ".", "dfs", ".", "mkdir", "}", "$", "{", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "import", "/", "temp", ";", "dfs", "-", "rmr", "$", "{", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "import", ";", "dfs", "$", "{", "system", ":", "test", ".", "dfs", ".", "mkdir", "}", "$", "{", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "import", "/", ";", "-", "-", "check", "export", "on", "partition", "create", "table", "auth_import_ptn", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", ";", "alter", "table", "auth_import_ptn", "add", "partition", "(", "j", "=", "42", ")", ";", "export", "table", "auth_import_ptn", "partition", "(", "j", "=", "42", ")", "to", "'", "pfile", ":", "//", "${", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "import", "'", ";", "alter", "table", "auth_import_ptn", "drop", "partition", "(", "j", "=", "42", ")", ";", "set", "user", ".", "name", "=", "user1", ";", "import", "table", "auth_import_ptn", "partition", "(", "j", "=", "42", ")", "from", "'", "pfile", ":", "//", "${", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "import", "'", ";", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "false", ";", "drop", "table", "auth_import_ptn", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "11", "@", "@", "set", "hive", ".", "test", ".", "authz", ".", "sstd", ".", "hs2", ".", "mode", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "sqlstd", ".", "SQLStdHiveAuthorizerFactoryForTest", ";", "set", "hive", ".", "security", ".", "authenticator", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "SessionStateConfigUserAuthenticator", ";", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "true", ";", "-", "-", "check", "truncate", "on", "partition", "create", "table", "auth_trunc2", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", ";", "alter", "table", "auth_trunc2", "add", "partition", "(", "j", "=", "42", ")", ";", "set", "user", ".", "name", "=", "user1", ";", "truncate", "table", "auth_trunc2", "partition", "(", "j", "=", "42", ")", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "18", "@", "@", "PREHOOK", ":", "query", ":", "-", "-", "check", "alter", "-", "drop", "on", "partition", "create", "table", "auth_trunc2", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", "PREHOOK", ":", "type", ":", "CREATETABLE", "PREHOOK", ":", "Output", ":", "database", ":", "default", "PREHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "POSTHOOK", ":", "query", ":", "-", "-", "check", "alter", "-", "drop", "on", "partition", "create", "table", "auth_trunc2", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", "POSTHOOK", ":", "type", ":", "CREATETABLE", "POSTHOOK", ":", "Output", ":", "database", ":", "default", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "PREHOOK", ":", "query", ":", "alter", "table", "auth_trunc2", "add", "partition", "(", "j", "=", "42", ")", "PREHOOK", ":", "type", ":", "ALTERTABLE_ADDPARTS", "PREHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "POSTHOOK", ":", "query", ":", "alter", "table", "auth_trunc2", "add", "partition", "(", "j", "=", "42", ")", "POSTHOOK", ":", "type", ":", "ALTERTABLE_ADDPARTS", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "@", "j", "=", "42", "FAILED", ":", "HiveAccessControlException", "Permission", "denied", ":", "Principal", "[", "name", "=", "user1", ",", "type", "=", "USER", "]", "does", "not", "have", "following", "privileges", "for", "operation", "ALTERTABLE_DROPPARTS", "[", "[", "DELETE", "]", "on", "Object", "[", "type", "=", "TABLE_OR_VIEW", ",", "name", "=", "default", ".", "auth_trunc2", "]", "]", "@", "@", "-", "0", ",", "0", "+", "1", ",", "19", "@", "@", "#", "##", "#", "A", "masked", "pattern", "was", "here", "#", "##", "#", "PREHOOK", ":", "query", ":", "-", "-", "check", "export", "on", "partition", "create", "table", "auth_export_ptn", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", "PREHOOK", ":", "type", ":", "CREATETABLE", "PREHOOK", ":", "Output", ":", "database", ":", "default", "PREHOOK", ":", "Output", ":", "default", "@", "auth_export_ptn", "POSTHOOK", ":", "query", ":", "-", "-", "check", "export", "on", "partition", "create", "table", "auth_export_ptn", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", "POSTHOOK", ":", "type", ":", "CREATETABLE", "POSTHOOK", ":", "Output", ":", "database", ":", "default", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_export_ptn", "PREHOOK", ":", "query", ":", "alter", "table", "auth_export_ptn", "add", "partition", "(", "j", "=", "42", ")", "PREHOOK", ":", "type", ":", "ALTERTABLE_ADDPARTS", "PREHOOK", ":", "Output", ":", "default", "@", "auth_export_ptn", "POSTHOOK", ":", "query", ":", "alter", "table", "auth_export_ptn", "add", "partition", "(", "j", "=", "42", ")", "POSTHOOK", ":", "type", ":", "ALTERTABLE_ADDPARTS", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_export_ptn", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_export_ptn", "@", "j", "=", "42", "#", "##", "#", "A", "masked", "pattern", "was", "here", "#", "##", "#", "@", "@", "-", "0", ",", "0", "+", "1", ",", "34", "@", "@", "#", "##", "#", "A", "masked", "pattern", "was", "here", "#", "##", "#", "PREHOOK", ":", "query", ":", "-", "-", "check", "export", "on", "partition", "create", "table", "auth_import_ptn", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", "PREHOOK", ":", "type", ":", "CREATETABLE", "PREHOOK", ":", "Output", ":", "database", ":", "default", "PREHOOK", ":", "Output", ":", "default", "@", "auth_import_ptn", "POSTHOOK", ":", "query", ":", "-", "-", "check", "export", "on", "partition", "create", "table", "auth_import_ptn", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", "POSTHOOK", ":", "type", ":", "CREATETABLE", "POSTHOOK", ":", "Output", ":", "database", ":", "default", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_import_ptn", "PREHOOK", ":", "query", ":", "alter", "table", "auth_import_ptn", "add", "partition", "(", "j", "=", "42", ")", "PREHOOK", ":", "type", ":", "ALTERTABLE_ADDPARTS", "PREHOOK", ":", "Output", ":", "default", "@", "auth_import_ptn", "POSTHOOK", ":", "query", ":", "alter", "table", "auth_import_ptn", "add", "partition", "(", "j", "=", "42", ")", "POSTHOOK", ":", "type", ":", "ALTERTABLE_ADDPARTS", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_import_ptn", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_import_ptn", "@", "j", "=", "42", "#", "##", "#", "A", "masked", "pattern", "was", "here", "#", "##", "#", "PREHOOK", ":", "type", ":", "EXPORT", "PREHOOK", ":", "Input", ":", "default", "@", "auth_import_ptn", "@", "j", "=", "42", "#", "##", "#", "A", "masked", "pattern", "was", "here", "#", "##", "#", "POSTHOOK", ":", "type", ":", "EXPORT", "POSTHOOK", ":", "Input", ":", "default", "@", "auth_import_ptn", "@", "j", "=", "42", "#", "##", "#", "A", "masked", "pattern", "was", "here", "#", "##", "#", "PREHOOK", ":", "query", ":", "alter", "table", "auth_import_ptn", "drop", "partition", "(", "j", "=", "42", ")", "PREHOOK", ":", "type", ":", "ALTERTABLE_DROPPARTS", "PREHOOK", ":", "Input", ":", "default", "@", "auth_import_ptn", "PREHOOK", ":", "Output", ":", "default", "@", "auth_import_ptn", "@", "j", "=", "42", "POSTHOOK", ":", "query", ":", "alter", "table", "auth_import_ptn", "drop", "partition", "(", "j", "=", "42", ")", "POSTHOOK", ":", "type", ":", "ALTERTABLE_DROPPARTS", "POSTHOOK", ":", "Input", ":", "default", "@", "auth_import_ptn", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_import_ptn", "@", "j", "=", "42", "#", "##", "#", "A", "masked", "pattern", "was", "here", "#", "##", "#", "@", "@", "-", "0", ",", "0", "+", "1", ",", "18", "@", "@", "PREHOOK", ":", "query", ":", "-", "-", "check", "truncate", "on", "partition", "create", "table", "auth_trunc2", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", "PREHOOK", ":", "type", ":", "CREATETABLE", "PREHOOK", ":", "Output", ":", "database", ":", "default", "PREHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "POSTHOOK", ":", "query", ":", "-", "-", "check", "truncate", "on", "partition", "create", "table", "auth_trunc2", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", "POSTHOOK", ":", "type", ":", "CREATETABLE", "POSTHOOK", ":", "Output", ":", "database", ":", "default", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "PREHOOK", ":", "query", ":", "alter", "table", "auth_trunc2", "add", "partition", "(", "j", "=", "42", ")", "PREHOOK", ":", "type", ":", "ALTERTABLE_ADDPARTS", "PREHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "POSTHOOK", ":", "query", ":", "alter", "table", "auth_trunc2", "add", "partition", "(", "j", "=", "42", ")", "POSTHOOK", ":", "type", ":", "ALTERTABLE_ADDPARTS", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "@", "j", "=", "42", "FAILED", ":", "HiveAccessControlException", "Permission", "denied", ":", "Principal", "[", "name", "=", "user1", ",", "type", "=", "USER", "]", "does", "not", "have", "following", "privileges", "for", "operation", "TRUNCATETABLE", "[", "[", "OBJECT", "OWNERSHIP", "]", "on", "Object", "[", "type", "=", "TABLE_OR_VIEW", ",", "name", "=", "default", ".", "auth_trunc2", "]", "]"], "docstring_tokens": ["the", "partition-level", "privilege", "is", "not", "checked", "by", "the", "authorization", "framework"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "3124", ",", "11", "+", "3124", ",", "16", "@", "@", "static", "int", "proc_pid_fill_cache", "(", "struct", "file", "*", "filp", ",", "void", "*", "dirent", ",", "filldir_t", "filldi", "/", "*", "for", "the", "/", "proc", "/", "directory", "itself", ",", "after", "non", "-", "process", "stuff", "has", "been", "done", "*", "/", "int", "proc_pid_readdir", "(", "struct", "file", "*", "filp", ",", "void", "*", "dirent", ",", "filldir_t", "filldir", ")", "{", "unsigned", "int", "nr", "=", "filp", "-", ">", "f_pos", "-", "FIRST_PROCESS_ENTRY", ";", "struct", "task_struct", "*", "reaper", "=", "get_proc_task", "(", "filp", "-", ">", "f_path", ".", "dentry", "-", ">", "d_inode", ")", ";", "unsigned", "int", "nr", ";", "struct", "task_struct", "*", "reaper", ";", "struct", "tgid_iter", "iter", ";", "struct", "pid_namespace", "*", "ns", ";", "if", "(", "filp", "-", ">", "f_pos", ">", "=", "PID_MAX_LIMIT", "+", "TGID_OFFSET", ")", "goto", "out_no_task", ";", "nr", "=", "filp", "-", ">", "f_pos", "-", "FIRST_PROCESS_ENTRY", ";", "reaper", "=", "get_proc_task", "(", "filp", "-", ">", "f_path", ".", "dentry", "-", ">", "d_inode", ")", ";", "if", "(", "!", "reaper", ")", "goto", "out_no_task", ";"], "docstring_tokens": ["via", "a", "crafted", "(1", ")", "getdents", "or", "(2", ")", "readdir", "system", "call", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "248", ",", "11", "+", "248", ",", "12", "@", "@", "public", "static", "String", "getContextPath", "(", "HttpServletRequest", "request", ")", "{", "if", "(", "contextPath", "=", "=", "null", ")", "{", "contextPath", "=", "request", ".", "getContextPath", "(", ");", "}", "contextPath", "=", "normalize", "(", "decodeRequestString", "(", "request", ",", "contextPath", ")", ");", "if", "(", "\"/", "\".", "equals", "(", "contextPath", ")", ")", "{", "/", "/", "Invalid", "case", ",", "but", "happens", "for", "includes", "on", "Jetty", ":", "silently", "adapt", "it", ".", "/", "/", "the", "normalize", "method", "will", "return", "a", "\"", "/\"", "and", "includes", "on", "Jetty", ",", "will", "also", "be", "a", "\"", "/\"", ".", "contextPath", "=", "\"", "\";", "}", "return", "decodeRequestString", "(", "request", ",", "contextPath", ")", ";", "return", "contextPath", ";", "}", "/", "**", "@", "@", "-", "0", ",", "0", "+", "1", ",", "158", "@", "@", "package", "org", ".", "apache", ".", "shiro", ".", "web", ".", "util", "import", "org", ".", "junit", ".", "Assert", "import", "org", ".", "junit", ".", "Test", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletRequest", "import", "static", "org", ".", "easymock", ".", "EasyMock", ".", "*", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*", "/", "**", "*", "Tests", "for", "{", "@", "link", "WebUtils", "}", ".", "*", "/", "public", "class", "WebUtilsTest", "{", "@", "Test", "void", "testGetContextPathIncludes", "(", ")", "{", "def", "request", "=", "createMock", "(", "HttpServletRequest", ")", "expect", "(", "request", ".", "getAttribute", "(", "WebUtils", ".", "INCLUDE_CONTEXT_PATH_ATTRIBUTE", ")", ").", "andReturn", "(", "\"/", "\")", "expect", "(", "request", ".", "getCharacterEncoding", "(", "))", ".", "andReturn", "(", "\"", "UTF", "-", "8", "\"", ")", "replay", "request", "assertEquals", "\"", "\",", "WebUtils", ".", "getContextPath", "(", "request", ")", "verify", "request", "request", "=", "createMock", "(", "HttpServletRequest", ")", "expect", "(", "request", ".", "getAttribute", "(", "WebUtils", ".", "INCLUDE_CONTEXT_PATH_ATTRIBUTE", ")", ").", "andReturn", "(", "\"\"", ")", "expect", "(", "request", ".", "getCharacterEncoding", "(", "))", ".", "andReturn", "(", "\"", "UTF", "-", "8", "\"", ")", "replay", "request", "assertEquals", "\"", "\",", "WebUtils", ".", "getContextPath", "(", "request", ")", "verify", "request", "request", "=", "createMock", "(", "HttpServletRequest", ")", "expect", "(", "request", ".", "getAttribute", "(", "WebUtils", ".", "INCLUDE_CONTEXT_PATH_ATTRIBUTE", ")", ").", "andReturn", "(", "\"/", "context", "-", "path", "\"", ")", "expect", "(", "request", ".", "getCharacterEncoding", "(", "))", ".", "andReturn", "(", "\"", "UTF", "-", "8", "\"", ")", "replay", "request", "assertEquals", "\"", "/", "context", "-", "path", "\"", ",", "WebUtils", ".", "getContextPath", "(", "request", ")", "verify", "request", "request", "=", "createMock", "(", "HttpServletRequest", ")", "expect", "(", "request", ".", "getAttribute", "(", "WebUtils", ".", "INCLUDE_CONTEXT_PATH_ATTRIBUTE", ")", ").", "andReturn", "(", "\"/", "/", "context", "-", "path", "\"", ")", "expect", "(", "request", ".", "getCharacterEncoding", "(", "))", ".", "andReturn", "(", "\"", "UTF", "-", "8", "\"", ")", "replay", "request", "assertEquals", "\"", "/", "context", "-", "path", "\"", ",", "WebUtils", ".", "getContextPath", "(", "request", ")", "verify", "request", "}", "@", "Test", "void", "testGetContextPath", "(", ")", "{", "def", "request", "=", "createMock", "(", "HttpServletRequest", ")", "expect", "(", "request", ".", "getAttribute", "(", "WebUtils", ".", "INCLUDE_CONTEXT_PATH_ATTRIBUTE", ")", ").", "andReturn", "(", "null", ")", "expect", "(", "request", ".", "getContextPath", "(", "))", ".", "andReturn", "(", "\"/", "\")", "expect", "(", "request", ".", "getCharacterEncoding", "(", "))", ".", "andReturn", "(", "\"", "UTF", "-", "8", "\"", ")", "replay", "request", "assertEquals", "\"", "\",", "WebUtils", ".", "getContextPath", "(", "request", ")", "verify", "request", "request", "=", "createMock", "(", "HttpServletRequest", ")", "expect", "(", "request", ".", "getAttribute", "(", "WebUtils", ".", "INCLUDE_CONTEXT_PATH_ATTRIBUTE", ")", ").", "andReturn", "(", "null", ")", "expect", "(", "request", ".", "getContextPath", "(", "))", ".", "andReturn", "(", "\"\"", ")", "expect", "(", "request", ".", "getCharacterEncoding", "(", "))", ".", "andReturn", "(", "\"", "UTF", "-", "8", "\"", ")", "replay", "request", "assertEquals", "\"", "\",", "WebUtils", ".", "getContextPath", "(", "request", ")", "verify", "request", "request", "=", "createMock", "(", "HttpServletRequest", ")", "expect", "(", "request", ".", "getAttribute", "(", "WebUtils", ".", "INCLUDE_CONTEXT_PATH_ATTRIBUTE", ")", ").", "andReturn", "(", "null", ")", "expect", "(", "request", ".", "getContextPath", "(", "))", ".", "andReturn", "(", "\"/", "context", "-", "path", "\"", ")", "expect", "(", "request", ".", "getCharacterEncoding", "(", "))", ".", "andReturn", "(", "\"", "UTF", "-", "8", "\"", ")", "replay", "request", "assertEquals", "\"", "/", "context", "-", "path", "\"", ",", "WebUtils", ".", "getContextPath", "(", "request", ")", "verify", "request", "request", "=", "createMock", "(", "HttpServletRequest", ")", "expect", "(", "request", ".", "getAttribute", "(", "WebUtils", ".", "INCLUDE_CONTEXT_PATH_ATTRIBUTE", ")", ").", "andReturn", "(", "null", ")", "expect", "(", "request", ".", "getContextPath", "(", "))", ".", "andReturn", "(", "\"/", "/", "context", "-", "path", "\"", ")", "expect", "(", "request", ".", "getCharacterEncoding", "(", "))", ".", "andReturn", "(", "\"", "UTF", "-", "8", "\"", ")", "replay", "request", "assertEquals", "\"", "/", "context", "-", "path", "\"", ",", "WebUtils", ".", "getContextPath", "(", "request", ")", "verify", "request", "request", "=", "createMock", "(", "HttpServletRequest", ")", "expect", "(", "request", ".", "getAttribute", "(", "WebUtils", ".", "INCLUDE_CONTEXT_PATH_ATTRIBUTE", ")", ").", "andReturn", "(", "null", ")", "expect", "(", "request", ".", "getContextPath", "(", "))", ".", "andReturn", "(", "\"/", "context", "%", "20path", "\"", ")", "expect", "(", "request", ".", "getCharacterEncoding", "(", "))", ".", "andReturn", "(", "\"", "UTF", "-", "8", "\"", ")", "replay", "request", "assertEquals", "\"", "/", "context", "path", "\"", ",", "WebUtils", ".", "getContextPath", "(", "request", ")", "verify", "request", "request", "=", "createMock", "(", "HttpServletRequest", ")", "expect", "(", "request", ".", "getAttribute", "(", "WebUtils", ".", "INCLUDE_CONTEXT_PATH_ATTRIBUTE", ")", ").", "andReturn", "(", "null", ")", "expect", "(", "request", ".", "getContextPath", "(", "))", ".", "andReturn", "(", "\"/", "c", "%", "6Fntext", "%", "20path", "\"", ")", "expect", "(", "request", ".", "getCharacterEncoding", "(", "))", ".", "andReturn", "(", "\"", "UTF", "-", "8", "\"", ")", "replay", "request", "assertEquals", "\"", "/", "context", "path", "\"", ",", "WebUtils", ".", "getContextPath", "(", "request", ")", "verify", "request", "request", "=", "createMock", "(", "HttpServletRequest", ")", "expect", "(", "request", ".", "getAttribute", "(", "WebUtils", ".", "INCLUDE_CONTEXT_PATH_ATTRIBUTE", ")", ").", "andReturn", "(", "null", ")", "expect", "(", "request", ".", "getContextPath", "(", "))", ".", "andReturn", "(", "\"/", "context", "path", "\"", ")", "expect", "(", "request", ".", "getCharacterEncoding", "(", "))", ".", "andReturn", "(", "\"", "UTF", "-", "8", "\"", ")", "replay", "request", "assertEquals", "\"", "/", "context", "path", "\"", ",", "WebUtils", ".", "getContextPath", "(", "request", ")", "verify", "request", "request", "=", "createMock", "(", "HttpServletRequest", ")", "expect", "(", "request", ".", "getAttribute", "(", "WebUtils", ".", "INCLUDE_CONTEXT_PATH_ATTRIBUTE", ")", ").", "andReturn", "(", "null", ")", "expect", "(", "request", ".", "getContextPath", "(", "))", ".", "andReturn", "(", "\"/", "context", "%", "2525path", "\"", ")", "expect", "(", "request", ".", "getCharacterEncoding", "(", "))", ".", "andReturn", "(", "\"", "UTF", "-", "8", "\"", ")", "replay", "request", "assertEquals", "\"", "/", "context", "%", "25path", "\"", ",", "WebUtils", ".", "getContextPath", "(", "request", ")", "verify", "request", "/", "/", "non", "visible", "character", "'", "s", "are", "NOT", "normalized", ",", "such", "as", "a", "backspace", "request", "=", "createMock", "(", "HttpServletRequest", ")", "expect", "(", "request", ".", "getAttribute", "(", "WebUtils", ".", "INCLUDE_CONTEXT_PATH_ATTRIBUTE", ")", ").", "andReturn", "(", "null", ")", "expect", "(", "request", ".", "getContextPath", "(", "))", ".", "andReturn", "(", "\"/", "context", "-", "%", "08path", "\"", ")", "expect", "(", "request", ".", "getCharacterEncoding", "(", "))", ".", "andReturn", "(", "\"", "UTF", "-", "8", "\"", ")", "replay", "request", "def", "expected", "=", "\"", "/", "context", "-", "\"", "+", "(", "char", ")", "0x08", "+", "\"", "path", "\"", "assertEquals", "expected", ",", "WebUtils", ".", "getContextPath", "(", "request", ")", "verify", "request", "}", "@", "Test", "void", "testGetPathWithinApplication", "(", ")", "{", "doTestGetPathWithinApplication", "(", "\"/", "\",", "\"", "/", "foobar", "\"", ",", "\"", "/", "foobar", "\"", ");", "doTestGetPathWithinApplication", "(", "\"\"", ",", "\"", "/", "foobar", "\"", ",", "\"", "/", "foobar", "\"", ");", "doTestGetPathWithinApplication", "(", "\"\"", ",", "\"", "foobar", "\"", ",", "\"", "/", "foobar", "\"", ");", "doTestGetPathWithinApplication", "(", "\"/", "\",", "\"", "foobar", "\"", ",", "\"", "/", "foobar", "\"", ");", "doTestGetPathWithinApplication", "(", "\"/", "/\"", ",", "\"", "foobar", "\"", ",", "\"", "/", "foobar", "\"", ");", "doTestGetPathWithinApplication", "(", "\"/", "/\"", ",", "\"", "//", "foobar", "\"", ",", "\"", "/", "foobar", "\"", ");", "doTestGetPathWithinApplication", "(", "\"/", "context", "-", "path", "\"", ",", "\"", "/", "context", "-", "path", "/", "foobar", "\"", ",", "\"", "/", "foobar", "\"", ");", "doTestGetPathWithinApplication", "(", "\"/", "context", "-", "path", "\"", ",", "\"", "/", "context", "-", "path", "/", "foobar", "/", "\",", "\"", "/", "foobar", "/", "\")", ";", "doTestGetPathWithinApplication", "(", "\"/", "/", "context", "-", "path", "\"", ",", "\"", "//", "context", "-", "path", "/", "foobar", "\"", ",", "\"", "/", "foobar", "\"", ");", "doTestGetPathWithinApplication", "(", "\"/", "/", "context", "-", "path", "\"", ",", "\"", "//", "context", "-", "path", "/", "/", "foobar", "\"", ",", "\"", "/", "foobar", "\"", ");", "doTestGetPathWithinApplication", "(", "\"/", "/", "context", "-", "path", "\"", ",", "\"", "//", "context", "-", "path", "/", "remove", "-", "one", "/", "remove", "-", "two", "/", "..", "/.", "./", "./", "./", "/", "foobar", "\"", ",", "\"", "/", "foobar", "\"", ");", "doTestGetPathWithinApplication", "(", "\"/", "/", "context", "-", "path", "\"", ",", "\"", "//", "context", "-", "path", "/", "/.", "./", "..", "/.", "/.", "//", "foobar", "\"", ",", "null", ")", ";", "doTestGetPathWithinApplication", "(", "\"/", "context", "%", "2525path", "\"", ",", "\"", "/", "context", "%", "2525path", "/", "foobar", "\"", ",", "\"", "/", "foobar", "\"", ");", "doTestGetPathWithinApplication", "(", "\"/", "c", "%", "6Fntext", "%", "20path", "\"", ",", "\"", "/", "c", "%", "6Fntext", "%", "20path", "/", "foobar", "\"", ",", "\"", "/", "foobar", "\"", ");", "doTestGetPathWithinApplication", "(", "\"/", "context", "path", "\"", ",", "\"", "/", "context", "path", "/", "foobar", "\"", ",", "\"", "/", "foobar", "\"", ");", "}", "void", "doTestGetPathWithinApplication", "(", "String", "contextPath", ",", "String", "requestUri", ",", "String", "expectedValue", ")", "{", "def", "request", "=", "createMock", "(", "HttpServletRequest", ")", "expect", "(", "request", ".", "getAttribute", "(", "WebUtils", ".", "INCLUDE_CONTEXT_PATH_ATTRIBUTE", ")", ").", "andReturn", "(", "contextPath", ")", "expect", "(", "request", ".", "getAttribute", "(", "WebUtils", ".", "INCLUDE_REQUEST_URI_ATTRIBUTE", ")", ").", "andReturn", "(", "requestUri", ")", "expect", "(", "request", ".", "getCharacterEncoding", "(", "))", ".", "andReturn", "(", "\"", "UTF", "-", "8", "\"", ").", "times", "(", "2", ")", "replay", "request", "assertEquals", "expectedValue", ",", "WebUtils", ".", "getPathWithinApplication", "(", "request", ")", "verify", "request", "}", "}"], "docstring_tokens": ["specifically", "crafted", "requests", "can", "be", "used", "to", "by", "pass", "some", "security", "servlet", "filters"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "30", ",", "7", "+", "30", ",", "7", "@", "@", "\"", "1", ":", "movl", "%", "2", ",", "%", "0", "\\", "n", "\\", "movl", "%", "0", ",", "%", "3", "\\", "n", "\"", "\\", "insn", "\"", "\\", "n", "\"", "\\", "\"", "2", ":", "\"", "LOCK_PREFIX", "\"", "cmpxchgl", "%", "3", ",", "%", "2", "\\", "n", "\\", "\"", "2", ":", "lock", ";", "cmpxchgl", "%", "3", ",", "%", "2", "\\", "n", "\\", "jnz", "1b", "\\", "n", "\\", "3", ":", ".", "section", ".", "fixup", ",", "\\\"", "ax", "\\", "\"\\", "n", "\\", "4", ":", "mov", "%", "5", ",", "%", "1", "\\", "n", "\\", "@", "@", "-", "72", ",", "7", "+", "72", ",", "7", "@", "@", "futex_atomic_op_inuser", "(", "int", "encoded_op", ",", "int", "__user", "*", "uaddr", ")", "__futex_atomic_op1", "(", "\"", "xchgl", "%", "0", ",", "%", "2", "\"", ",", "ret", ",", "oldval", ",", "uaddr", ",", "oparg", ")", ";", "break", ";", "case", "FUTEX_OP_ADD", ":", "__futex_atomic_op1", "(", "LOCK_PREFIX", "\"", "xaddl", "%", "0", ",", "%", "2", "\"", ",", "ret", ",", "oldval", ",", "__futex_atomic_op1", "(", "\"", "lock", ";", "xaddl", "%", "0", ",", "%", "2", "\"", ",", "ret", ",", "oldval", ",", "uaddr", ",", "oparg", ")", ";", "break", ";", "case", "FUTEX_OP_OR", ":", "@", "@", "-", "111", ",", "8", "+", "111", ",", "8", "@", "@", "futex_atomic_cmpxchg_inatomic", "(", "int", "__user", "*", "uaddr", ",", "int", "oldval", ",", "int", "newval", ")", "return", "-", "EFAULT", ";", "__asm__", "__volatile__", "(", "\"", "1", ":", "\"", "LOCK_PREFIX", "\"", "cmpxchgl", "%", "3", ",", "%", "1", "\\", "n", "\"", "\"", "1", ":", "lock", ";", "cmpxchgl", "%", "3", ",", "%", "1", "\\", "n", "\"", "\"", "2", ":", ".", "section", ".", "fixup", ",", "\\", "\"", "ax", "\\", "\"", "\\", "n", "\"", "\"", "3", ":", "mov", "%", "2", ",", "%", "0", "\\", "n", "\"", "\"", "jmp", "2b", "\\", "n", "\""], "docstring_tokens": ["via", "an", "invalid", "application", "that", "triggers", "a", "page", "fault", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2792", ",", "7", "+", "2792", ",", "7", "@", "@", "static", "int", "rtl8169_rx_interrupt", "(", "struct", "net_device", "*", "dev", ",", "pkt_size", ",", "PCI_DMA_FROMDEVICE", ")", ";", "rtl8169_mark_to_asic", "(", "desc", ",", "tp", "-", ">", "rx_buf_sz", ")", ";", "}", "else", "{", "pci_unmap_single", "(", "pdev", ",", "addr", ",", "pkt_size", ",", "pci_unmap_single", "(", "pdev", ",", "addr", ",", "tp", "-", ">", "rx_buf_sz", ",", "PCI_DMA_FROMDEVICE", ")", ";", "tp", "-", ">", "Rx_skbuff", "[", "entry", "]", "=", "NULL", ";", "}"], "docstring_tokens": ["flooding", "the", "system", "with", "ping", "requests"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "185", ",", "7", "+", "185", ",", "7", "@", "@", "protected", "void", "addTranportConnectors", "(", ")", "throws", "Exception", "{", "}", "if", "(", "isUseSslConnector", "(", "))", "{", "connector", "=", "brokerService", ".", "addConnector", "(", "\"", "amqp", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "\"", "+", "amqpSslPort", "+", "\"", "?", "transport", ".", "tcpNoDelay", "=", "true", "&", "transport", ".", "transformer", "=", "\"", "+", "getAmqpTransformer", "(", ")", "+", "getAdditionalConfig", "(", "))", ";", "\"", "amqp", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "\"", "+", "amqpSslPort", "+", "\"", "?", "transport", ".", "verifyHostName", "=", "false", "&", "transport", ".", "tcpNoDelay", "=", "true", "&", "transport", ".", "transformer", "=", "\"", "+", "getAmqpTransformer", "(", ")", "+", "getAdditionalConfig", "(", "))", ";", "amqpSslPort", "=", "connector", ".", "getConnectUri", "(", ").", "getPort", "(", ");", "amqpSslURI", "=", "connector", ".", "getPublishableConnectURI", "(", ");", "LOG", ".", "debug", "(", "\"", "Using", "amqp", "+", "ssl", "port", "\"", "+", "amqpSslPort", ")", ";", "@", "@", "-", "199", ",", "7", "+", "199", ",", "7", "@", "@", "protected", "void", "addTranportConnectors", "(", ")", "throws", "Exception", "{", "}", "if", "(", "isUseNioPlusSslConnector", "(", "))", "{", "connector", "=", "brokerService", ".", "addConnector", "(", "\"", "amqp", "+", "nio", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "\"", "+", "amqpNioPlusSslPort", "+", "\"", "?", "transport", ".", "tcpNoDelay", "=", "true", "&", "transport", ".", "transformer", "=", "\"", "+", "getAmqpTransformer", "(", ")", "+", "getAdditionalConfig", "(", "))", ";", "\"", "amqp", "+", "nio", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "\"", "+", "amqpNioPlusSslPort", "+", "\"", "?", "transport", ".", "verifyHostName", "=", "false", "&", "transport", ".", "tcpNoDelay", "=", "true", "&", "transport", ".", "transformer", "=", "\"", "+", "getAmqpTransformer", "(", ")", "+", "getAdditionalConfig", "(", "))", ";", "amqpNioPlusSslPort", "=", "connector", ".", "getConnectUri", "(", ").", "getPort", "(", ");", "amqpNioPlusSslURI", "=", "connector", ".", "getPublishableConnectURI", "(", ");", "LOG", ".", "debug", "(", "\"", "Using", "amqp", "+", "nio", "+", "ssl", "port", "\"", "+", "amqpNioPlusSslPort", ")", ";", "@", "@", "-", "79", ",", "7", "+", "79", ",", "7", "@", "@", "protected", "URI", "getBrokerURI", "(", ")", "{", "@", "Override", "protected", "String", "getAdditionalConfig", "(", ")", "{", "return", "\"", "?", "transport", ".", "needClientAuth", "=", "true", "\"", ";", "return", "\"", "?", "transport", ".", "needClientAuth", "=", "true", "&", "transport", ".", "verifyHostName", "=", "false", "\"", ";", "}", "@", "@", "-", "30", ",", "6", "+", "30", ",", "7", "@", "@", "import", "javax", ".", "net", ".", "ssl", ".", "SSLContext", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLEngine", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLEngineResult", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLParameters", ";", "import", "org", ".", "apache", ".", "activemq", ".", "thread", ".", "TaskRunnerFactory", ";", "import", "org", ".", "apache", ".", "activemq", ".", "util", ".", "IOExceptionSupport", ";", "@", "@", "-", "89", ",", "6", "+", "90", ",", "12", "@", "@", "protected", "void", "initializeStreams", "(", ")", "throws", "IOException", "{", "sslEngine", "=", "sslContext", ".", "createSSLEngine", "(", ");", "}", "if", "(", "verifyHostName", ")", "{", "SSLParameters", "sslParams", "=", "new", "SSLParameters", "(", ");", "sslParams", ".", "setEndpointIdentificationAlgorithm", "(", "\"", "HTTPS", "\"", ");", "sslEngine", ".", "setSSLParameters", "(", "sslParams", ")", ";", "}", "sslEngine", ".", "setUseClientMode", "(", "false", ")", ";", "if", "(", "enabledCipherSuites", "!", "=", "null", ")", "{", "sslEngine", ".", "setEnabledCipherSuites", "(", "enabledCipherSuites", ")", ";", "@", "@", "-", "36", ",", "6", "+", "36", ",", "7", "@", "@", "import", "javax", ".", "net", ".", "ssl", ".", "SSLEngine", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLEngineResult", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLEngineResult", ".", "HandshakeStatus", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLParameters", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLPeerUnverifiedException", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLSession", ";", "@", "@", "-", "56", ",", "6", "+", "57", ",", "7", "@", "@", "protected", "boolean", "wantClientAuth", ";", "protected", "String", "[", "]", "enabledCipherSuites", ";", "protected", "String", "[", "]", "enabledProtocols", ";", "protected", "boolean", "verifyHostName", "=", "true", ";", "protected", "SSLContext", "sslContext", ";", "protected", "SSLEngine", "sslEngine", ";", "@", "@", "-", "119", ",", "6", "+", "121", ",", "12", "@", "@", "protected", "void", "initializeStreams", "(", ")", "throws", "IOException", "{", "sslEngine", "=", "sslContext", ".", "createSSLEngine", "(", ");", "}", "if", "(", "verifyHostName", ")", "{", "SSLParameters", "sslParams", "=", "new", "SSLParameters", "(", ");", "sslParams", ".", "setEndpointIdentificationAlgorithm", "(", "\"", "HTTPS", "\"", ");", "sslEngine", ".", "setSSLParameters", "(", "sslParams", ")", ";", "}", "sslEngine", ".", "setUseClientMode", "(", "false", ")", ";", "if", "(", "enabledCipherSuites", "!", "=", "null", ")", "{", "sslEngine", ".", "setEnabledCipherSuites", "(", "enabledCipherSuites", ")", ";", "@", "@", "-", "543", ",", "4", "+", "551", ",", "12", "@", "@", "public", "void", "setEnabledCipherSuites", "(", "String", "[", "]", "enabledCipherSuites", ")", "{", "public", "void", "setEnabledProtocols", "(", "String", "[", "]", "enabledProtocols", ")", "{", "this", ".", "enabledProtocols", "=", "enabledProtocols", ";", "}", "public", "boolean", "isVerifyHostName", "(", ")", "{", "return", "verifyHostName", ";", "}", "public", "void", "setVerifyHostName", "(", "boolean", "verifyHostName", ")", "{", "this", ".", "verifyHostName", "=", "verifyHostName", ";", "}", "}", "@", "@", "-", "17", ",", "11", "+", "17", ",", "14", "@", "@", "package", "org", ".", "apache", ".", "activemq", ".", "transport", ".", "tcp", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "net", ".", "Socket", ";", "import", "java", ".", "net", ".", "SocketException", ";", "import", "java", ".", "net", ".", "URI", ";", "import", "java", ".", "net", ".", "UnknownHostException", ";", "import", "java", ".", "security", ".", "cert", ".", "X509Certificate", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLParameters", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLPeerUnverifiedException", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLSession", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLSocket", ";", "@", "@", "-", "43", ",", "6", "+", "46", ",", "8", "@", "@", "*", "/", "public", "class", "SslTransport", "extends", "TcpTransport", "{", "private", "Boolean", "verifyHostName", "=", "null", ";", "/", "**", "*", "Connect", "to", "a", "remote", "node", "such", "as", "a", "Broker", ".", "*", "@", "@", "-", "73", ",", "6", "+", "78", ",", "37", "@", "@", "public", "SslTransport", "(", "WireFormat", "wireFormat", ",", "SSLSocketFactory", "socketFactory", ",", "URI", "r", "}", "}", "@", "Override", "protected", "void", "initialiseSocket", "(", "Socket", "sock", ")", "throws", "SocketException", ",", "IllegalArgumentException", "{", "/", "/", "This", "needs", "to", "default", "to", "null", "because", "this", "transport", "class", "is", "used", "for", "both", "a", "server", "transport", "/", "/", "and", "a", "client", "connection", "and", "if", "we", "default", "it", "to", "a", "value", "it", "might", "override", "the", "transport", "server", "setting", "/", "/", "that", "was", "configured", "inside", "TcpTransportServer", "/", "/", "The", "idea", "here", "is", "that", "if", "this", "is", "a", "server", "transport", "then", "verifyHostName", "will", "be", "set", "by", "the", "setter", "/", "/", "below", "and", "not", "be", "null", "(", "if", "using", "transport", ".", "verifyHostName", ")", "but", "if", "a", "client", "uses", "socket", ".", "verifyHostName", "/", "/", "then", "it", "will", "be", "null", "and", "we", "can", "check", "socketOptions", "/", "/", "Unfortunately", "we", "have", "to", "do", "this", "to", "stay", "consistent", "because", "every", "other", "SSL", "option", "on", "the", "client", "/", "/", "side", "is", "configured", "using", "socket", ".", "but", "this", "particular", "option", "isn", "'", "t", "actually", "part", "of", "the", "socket", "/", "/", "so", "it", "makes", "it", "tricky", "if", "(", "verifyHostName", "=", "=", "null", ")", "{", "if", "(", "socketOptions", "!", "=", "null", "&", "&", "socketOptions", ".", "containsKey", "(", "\"", "verifyHostName", "\"", "))", "{", "verifyHostName", "=", "Boolean", ".", "parseBoolean", "(", "socketOptions", ".", "get", "(", "\"", "verifyHostName", "\"", ").", "toString", "(", "))", ";", "socketOptions", ".", "remove", "(", "\"", "verifyHostName", "\"", ");", "}", "else", "{", "verifyHostName", "=", "true", ";", "}", "}", "if", "(", "verifyHostName", ")", "{", "SSLParameters", "sslParams", "=", "new", "SSLParameters", "(", ");", "sslParams", ".", "setEndpointIdentificationAlgorithm", "(", "\"", "HTTPS", "\"", ");", "(", "(", "SSLSocket", ")", "this", ".", "socket", ")", ".", "setSSLParameters", "(", "sslParams", ")", ";", "}", "super", ".", "initialiseSocket", "(", "sock", ")", ";", "}", "/", "**", "*", "Initialize", "from", "a", "ServerSocket", ".", "No", "access", "to", "needClientAuth", "is", "given", "*", "since", "it", "is", "already", "set", "within", "the", "provided", "socket", ".", "@", "@", "-", "108", ",", "6", "+", "144", ",", "10", "@", "@", "public", "void", "doConsume", "(", "Object", "command", ")", "{", "super", ".", "doConsume", "(", "command", ")", ";", "}", "public", "void", "setVerifyHostName", "(", "Boolean", "verifyHostName", ")", "{", "this", ".", "verifyHostName", "=", "verifyHostName", ";", "}", "/", "**", "*", "@", "return", "peer", "certificate", "chain", "associated", "with", "the", "ssl", "socket", "*", "/", "@", "@", "-", "100", ",", "6", "+", "100", ",", "7", "@", "@", "public", "void", "setWantClientAuth", "(", "boolean", "wantAuth", ")", "{", "*", "*", "@", "throws", "IOException", "passed", "up", "from", "TcpTransportServer", ".", "*", "/", "@", "Override", "public", "void", "bind", "(", ")", "throws", "IOException", "{", "super", ".", "bind", "(", ");", "if", "(", "needClientAuth", ")", "{", "@", "@", "-", "119", ",", "6", "+", "120", ",", "7", "@", "@", "public", "void", "bind", "(", ")", "throws", "IOException", "{", "*", "@", "return", "The", "newly", "return", "(", "SSL", ")", "Transport", ".", "*", "@", "throws", "IOException", "*", "/", "@", "Override", "protected", "Transport", "createTransport", "(", "Socket", "socket", ",", "WireFormat", "format", ")", "throws", "IOException", "{", "return", "new", "SslTransport", "(", "format", ",", "(", "SSLSocket", ")", "socket", ")", ";", "}", "@", "@", "-", "133", ",", "7", "+", "133", ",", "7", "@", "@", "protected", "final", "AtomicReference", "<", "CountDownLatch", ">", "stoppedLatch", "=", "new", "AtomicReference", "<", "CountDownLatch", ">", "()", ";", "protected", "volatile", "int", "receiveCounter", ";", "private", "Map", "<", "String", ",", "Object", ">", "socketOptions", ";", "protected", "Map", "<", "String", ",", "Object", ">", "socketOptions", ";", "private", "int", "soLinger", "=", "Integer", ".", "MIN_VALUE", ";", "private", "Boolean", "keepAlive", ";", "private", "Boolean", "tcpNoDelay", ";", "@", "@", "-", "751", ",", "6", "+", "751", ",", "7", "@", "@", "private", "boolean", "setTrafficClass", "(", "Socket", "sock", ")", "throws", "SocketException", ",", "return", "true", ";", "}", "@", "Override", "public", "WireFormat", "getWireFormat", "(", ")", "{", "return", "wireFormat", ";", "}", "@", "@", "-", "40", ",", "6", "+", "40", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "import", "javax", ".", "net", ".", "ServerSocketFactory", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLParameters", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLServerSocket", ";", "import", "org", ".", "apache", ".", "activemq", ".", "Service", ";", "@", "@", "-", "79", ",", "6", "+", "80", ",", "7", "@", "@", "protected", "int", "minmumWireFormatVersion", ";", "protected", "boolean", "useQueueForAccept", "=", "true", ";", "protected", "boolean", "allowLinkStealing", ";", "protected", "boolean", "verifyHostName", "=", "true", ";", "/", "**", "*", "trace", "=", "true", "-", ">", "the", "Transport", "stack", "where", "this", "TcpTransport", "object", "will", "be", ",", "will", "have", "a", "TransportLogger", "layer", "@", "@", "-", "172", ",", "6", "+", "174", ",", "16", "@", "@", "private", "void", "configureServerSocket", "(", "ServerSocket", "socket", ")", "throws", "SocketException", "{", "/", "/", "see", ":", "https", ":", "//", "issues", ".", "apache", ".", "org", "/", "jira", "/", "browse", "/", "AMQ", "-", "4582", "/", "/", "if", "(", "socket", "instanceof", "SSLServerSocket", ")", "{", "if", "(", "transportOptions", ".", "containsKey", "(", "\"", "verifyHostName", "\"", "))", "{", "verifyHostName", "=", "Boolean", ".", "parseBoolean", "(", "transportOptions", ".", "get", "(", "\"", "verifyHostName", "\"", ").", "toString", "(", "))", ";", "}", "if", "(", "verifyHostName", ")", "{", "SSLParameters", "sslParams", "=", "new", "SSLParameters", "(", ");", "sslParams", ".", "setEndpointIdentificationAlgorithm", "(", "\"", "HTTPS", "\"", ");", "(", "(", "SSLServerSocket", ")", "this", ".", "serverSocket", ")", ".", "setSSLParameters", "(", "sslParams", ")", ";", "}", "if", "(", "transportOptions", ".", "containsKey", "(", "\"", "enabledCipherSuites", "\"", "))", "{", "Object", "cipherSuites", "=", "transportOptions", ".", "remove", "(", "\"", "enabledCipherSuites", "\"", ");", "@", "@", "-", "180", ",", "6", "+", "192", ",", "7", "@", "@", "private", "void", "configureServerSocket", "(", "ServerSocket", "socket", ")", "throws", "SocketException", "{", "\"", "Invalid", "transport", "options", "{", "enabledCipherSuites", "=", "%", "s", "}", "\",", "cipherSuites", ")", ");", "}", "}", "}", "/", "/", "AMQ", "-", "6599", "-", "don", "'", "t", "strip", "out", "set", "properties", "on", "the", "socket", "as", "we", "need", "to", "set", "them", "@", "@", "-", "55", ",", "7", "+", "55", ",", "7", "@", "@", "*", "/", "public", "MQTTAutoSslAuthTest", "(", "String", "protocol", ")", "{", "this", ".", "protocol", "=", "protocol", ";", "protocolConfig", "=", "\"", "transport", ".", "needClientAuth", "=", "true", "\"", ";", "protocolConfig", "=", "\"", "transport", ".", "needClientAuth", "=", "true", "&", "transport", ".", "verifyHostName", "=", "false", "&", "\";", "}", "@", "Override", "@", "@", "-", "54", ",", "13", "+", "54", ",", "13", "@", "@", "protected", "Socket", "createSocket", "(", ")", "throws", "IOException", "{", "@", "Override", "public", "void", "addOpenWireConnector", "(", ")", "throws", "Exception", "{", "TransportConnector", "connector", "=", "brokerService", ".", "addConnector", "(", "\"", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "needClientAuth", "=", "true", "\"", ");", "cf", "=", "new", "ActiveMQConnectionFactory", "(", "connector", ".", "getPublishableConnectString", "(", "))", ";", "TransportConnector", "connector", "=", "brokerService", ".", "addConnector", "(", "\"", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "&", "transport", ".", "verifyHostName", "=", "false", "\"", ");", "cf", "=", "new", "ActiveMQConnectionFactory", "(", "connector", ".", "getPublishableConnectString", "(", ")", "+", "\"", "?", "socket", ".", "verifyHostName", "=", "false", "\"", ");", "}", "@", "Override", "protected", "String", "getAdditionalConfig", "(", ")", "{", "return", "\"", "?", "needClientAuth", "=", "true", "\"", ";", "return", "\"", "?", "needClientAuth", "=", "true", "&", "transport", ".", "verifyHostName", "=", "false", "\"", ";", "}", "/", "/", "NOOP", "-", "These", "operations", "handled", "by", "jaas", "cert", "login", "module", "@", "@", "-", "102", ",", "7", "+", "102", ",", "7", "@", "@", "protected", "Socket", "createSocket", "(", ")", "throws", "IOException", "{", "@", "Override", "protected", "String", "getAdditionalConfig", "(", ")", "{", "return", "\"", "?", "transport", ".", "needClientAuth", "=", "true", "\"", ";", "return", "\"", "?", "transport", ".", "needClientAuth", "=", "true", "&", "transport", ".", "verifyHostName", "=", "false", "\"", ";", "}", "@", "Override", "@", "@", "-", "121", ",", "7", "+", "121", ",", "7", "@", "@", "public", "void", "testStompNIOSSLWithCertificate", "(", ")", "throws", "Exception", "{", "public", "void", "openwireConnectTo", "(", "String", "connectorName", ",", "String", "username", ",", "String", "password", ")", "throws", "Exception", "{", "URI", "brokerURI", "=", "broker", ".", "getConnectorByName", "(", "connectorName", ")", ".", "getConnectUri", "(", ");", "String", "uri", "=", "\"", "ssl", ":", "//", "\"", "+", "brokerURI", ".", "getHost", "(", ")", "+", "\"", ":\"", "+", "brokerURI", ".", "getPort", "(", ");", "String", "uri", "=", "\"", "ssl", ":", "//", "\"", "+", "brokerURI", ".", "getHost", "(", ")", "+", "\"", ":\"", "+", "brokerURI", ".", "getPort", "(", ")", "+", "\"", "?", "socket", ".", "verifyHostName", "=", "false", "\"", ";", "ActiveMQSslConnectionFactory", "cf", "=", "new", "ActiveMQSslConnectionFactory", "(", "uri", ")", ";", "cf", ".", "setTrustStore", "(", "\"", "org", "/", "apache", "/", "activemq", "/", "security", "/", "broker1", ".", "ks", "\"", ");", "cf", ".", "setTrustStorePassword", "(", "\"", "password", "\"", ");", "@", "@", "-", "71", ",", "7", "+", "71", ",", "7", "@", "@", "public", "void", "before", "(", ")", "throws", "Exception", "{", "brokerService", ".", "setPersistent", "(", "false", ")", ";", "TransportConnector", "connector", "=", "brokerService", ".", "addConnector", "(", "protocol", "+", "\"", ":/", "/", "localhost", ":", "0", "?", "transport", ".", "soTimeout", "=", "3500", "\"", ");", "\"", ":/", "/", "localhost", ":", "0", "?", "transport", ".", "soTimeout", "=", "3500", "&", "transport", ".", "verifyHostName", "=", "false", "\"", ");", "connector", ".", "setName", "(", "\"", "connector", "\"", ");", "uri", "=", "connector", ".", "getPublishableConnectString", "(", ");", "@", "@", "-", "47", ",", "14", "+", "47", ",", "14", "@", "@", "public", "void", "testForceReconnect", "(", ")", "throws", "Exception", "{", "remote", ".", "setSslContext", "(", "sslContext", ")", ";", "remote", ".", "setUseJmx", "(", "false", ")", ";", "remote", ".", "setPersistent", "(", "false", ")", ";", "final", "TransportConnector", "transportConnector", "=", "remote", ".", "addConnector", "(", "\"", "nio", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "\"", ");", "final", "TransportConnector", "transportConnector", "=", "remote", ".", "addConnector", "(", "\"", "nio", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "verifyHostName", "=", "false", "\"", ");", "remote", ".", "start", "(", ");", "BrokerService", "local", "=", "new", "BrokerService", "(", ");", "local", ".", "setSslContext", "(", "sslContext", ")", ";", "local", ".", "setUseJmx", "(", "false", ")", ";", "local", ".", "setPersistent", "(", "false", ")", ";", "final", "NetworkConnector", "networkConnector", "=", "local", ".", "addNetworkConnector", "(", "\"", "static", ":", "(\"", "+", "remote", ".", "getTransportConnectorByScheme", "(", "\"", "nio", "+", "ssl", "\"", ").", "getPublishableConnectString", "(", ").", "replace", "(", "\"", "nio", "+", "ssl", "\"", ",", "\"", "ssl", "\"", ")", "+", "\"", ")?", "useExponentialBackOff", "=", "false", "&", "initialReconnectDelay", "=", "10", "\"", ");", "final", "NetworkConnector", "networkConnector", "=", "local", ".", "addNetworkConnector", "(", "\"", "static", ":", "(\"", "+", "remote", ".", "getTransportConnectorByScheme", "(", "\"", "nio", "+", "ssl", "\"", ").", "getPublishableConnectString", "(", ").", "replace", "(", "\"", "nio", "+", "ssl", "\"", ",", "\"", "ssl", "\"", ")", "+", "\"", "?", "socket", ".", "verifyHostName", "=", "false", "\"", "+", "\"", ")?", "useExponentialBackOff", "=", "false", "&", "initialReconnectDelay", "=", "10", "\"", ");", "local", ".", "start", "(", ");", "assertTrue", "(", "\"", "Bridge", "created", "\"", ",", "Wait", ".", "waitFor", "(", "new", "Wait", ".", "Condition", "(", ")", "{", "@", "@", "-", "75", ",", "7", "+", "75", ",", "7", "@", "@", "public", "void", "before", "(", ")", "throws", "Exception", "{", "BrokerService", "brokerService", "=", "new", "BrokerService", "(", ");", "brokerService", ".", "setPersistent", "(", "false", ")", ";", "TransportConnector", "connector", "=", "brokerService", ".", "addConnector", "(", "protocol", "+", "\"", ":/", "/", "localhost", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "\"", ");", "TransportConnector", "connector", "=", "brokerService", ".", "addConnector", "(", "protocol", "+", "\"", ":/", "/", "localhost", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "&", "transport", ".", "verifyHostName", "=", "false", "\"", ");", "connector", ".", "setName", "(", "\"", "auto", "\"", ");", "uri", "=", "connector", ".", "getPublishableConnectString", "(", ");", "@", "@", "-", "126", ",", "7", "+", "126", ",", "7", "@", "@", "public", "AutoSslAuthTest", "(", "String", "protocol", ")", "{", "@", "Test", "(", "timeout", "=", "60000", ")", "public", "void", "testConnect", "(", ")", "throws", "Exception", "{", "ActiveMQConnectionFactory", "factory", "=", "new", "ActiveMQConnectionFactory", "(", ");", "factory", ".", "setBrokerURL", "(", "uri", ")", ";", "factory", ".", "setBrokerURL", "(", "uri", "+", "\"", "?", "socket", ".", "verifyHostName", "=", "false", "\"", ");", "/", "/", "Create", "5", "connections", "to", "make", "sure", "all", "are", "properly", "set", "for", "(", "int", "i", "=", "0", ";", "i", "<", "5", ";", "i", "+", "+)", "{", "@", "@", "-", "103", ",", "8", "+", "103", ",", "14", "@", "@", "public", "void", "tearDown", "(", ")", "throws", "Exception", "{", "}", "public", "void", "configureConnectorAndStart", "(", "String", "bindAddress", ")", "throws", "Exception", "{", "if", "(", "bindAddress", ".", "contains", "(", "\"", "ssl", "\"", "))", "{", "bindAddress", "+", "=", "bindAddress", ".", "contains", "(", "\"?", "\")", "?", "\"", "&", "transport", ".", "verifyHostName", "=", "false", "\"", ":", "\"", "?", "transport", ".", "verifyHostName", "=", "false", "\"", ";", "}", "connector", "=", "service", ".", "addConnector", "(", "bindAddress", ")", ";", "connectionUri", "=", "connector", ".", "getPublishableConnectString", "(", ");", "if", "(", "connectionUri", ".", "contains", "(", "\"", "ssl", "\"", "))", "{", "connectionUri", "+", "=", "connectionUri", ".", "contains", "(", "\"?", "\")", "?", "\"", "&", "socket", ".", "verifyHostName", "=", "false", "\"", ":", "\"", "?", "socket", ".", "verifyHostName", "=", "false", "\"", ";", "}", "service", ".", "start", "(", ");", "service", ".", "waitUntilStarted", "(", ");", "}", "@", "@", "-", "17", ",", "14", "+", "17", ",", "14", "@", "@", "package", "org", ".", "apache", ".", "activemq", ".", "transport", ".", "nio", ";", "import", "javax", ".", "jms", ".", "Connection", ";", "import", "javax", ".", "jms", ".", "JMSException", ";", "import", "javax", ".", "jms", ".", "Message", ";", "import", "javax", ".", "jms", ".", "MessageConsumer", ";", "import", "javax", ".", "jms", ".", "MessageProducer", ";", "import", "javax", ".", "jms", ".", "Queue", ";", "import", "javax", ".", "jms", ".", "Session", ";", "import", "javax", ".", "jms", ".", "TextMessage", ";", "import", "junit", ".", "framework", ".", "TestCase", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLHandshakeException", ";", "import", "org", ".", "apache", ".", "activemq", ".", "ActiveMQConnectionFactory", ";", "import", "org", ".", "apache", ".", "activemq", ".", "broker", ".", "BrokerService", ";", "@", "@", "-", "33", ",", "6", "+", "33", ",", "8", "@", "@", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "junit", ".", "framework", ".", "TestCase", ";", "public", "class", "NIOSSLBasicTest", "{", "public", "static", "final", "String", "KEYSTORE_TYPE", "=", "\"", "jks", "\"", ";", "@", "@", "-", "78", ",", "25", "+", "80", ",", "40", "@", "@", "public", "void", "stopBroker", "(", "BrokerService", "broker", ")", "throws", "Exception", "{", "@", "Test", "public", "void", "basicConnector", "(", ")", "throws", "Exception", "{", "BrokerService", "broker", "=", "createBroker", "(", "\"", "nio", "+", "ssl", "\"", ",", "getTransportType", "(", ")", "+", "\"", ":/", "/", "localhost", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "\"", ");", "basicSendReceive", "(", "\"", "ssl", ":", "//", "localhost", ":", "\"", "+", "broker", ".", "getConnectorByName", "(", "\"", "nio", "+", "ssl", "\"", ").", "getConnectUri", "(", ").", "getPort", "(", "))", ";", "BrokerService", "broker", "=", "createBroker", "(", "\"", "nio", "+", "ssl", "\"", ",", "getTransportType", "(", ")", "+", "\"", ":/", "/", "localhost", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "&", "transport", ".", "verifyHostName", "=", "false", "\"", ");", "basicSendReceive", "(", "\"", "ssl", ":", "//", "localhost", ":", "\"", "+", "broker", ".", "getConnectorByName", "(", "\"", "nio", "+", "ssl", "\"", ").", "getConnectUri", "(", ").", "getPort", "(", ")", "+", "\"", "?", "socket", ".", "verifyHostName", "=", "false", "\"", ");", "stopBroker", "(", "broker", ")", ";", "}", "@", "Test", "public", "void", "enabledCipherSuites", "(", ")", "throws", "Exception", "{", "BrokerService", "broker", "=", "createBroker", "(", "\"", "nio", "+", "ssl", "\"", ",", "getTransportType", "(", ")", "+", "\"", ":/", "/", "localhost", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "&", "transport", ".", "enabledCipherSuites", "=", "SSL_RSA_WITH_RC4_128_SHA", ",", "SSL_DH_anon_WITH_3DES_EDE_CBC_SHA", "\"", ");", "basicSendReceive", "(", "\"", "ssl", ":", "//", "localhost", ":", "\"", "+", "broker", ".", "getConnectorByName", "(", "\"", "nio", "+", "ssl", "\"", ").", "getConnectUri", "(", ").", "getPort", "(", "))", ";", "BrokerService", "broker", "=", "createBroker", "(", "\"", "nio", "+", "ssl", "\"", ",", "getTransportType", "(", ")", "+", "\"", ":/", "/", "localhost", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "&", "transport", ".", "verifyHostName", "=", "false", "&", "transport", ".", "enabledCipherSuites", "=", "TLS_RSA_WITH_AES_256_CBC_SHA256", "&", "transport", ".", "verifyHostName", "=", "false", "\"", ");", "basicSendReceive", "(", "\"", "ssl", ":", "//", "localhost", ":", "\"", "+", "broker", ".", "getConnectorByName", "(", "\"", "nio", "+", "ssl", "\"", ").", "getConnectUri", "(", ").", "getPort", "(", ")", "+", "\"", "?", "socket", ".", "verifyHostName", "=", "false", "\"", ");", "stopBroker", "(", "broker", ")", ";", "}", "@", "Test", "public", "void", "enabledProtocols", "(", ")", "throws", "Exception", "{", "BrokerService", "broker", "=", "createBroker", "(", "\"", "nio", "+", "ssl", "\"", ",", "getTransportType", "(", ")", "+", "\"", ":/", "/", "localhost", ":", "61616", "?", "transport", ".", "needClientAuth", "=", "true", "&", "transport", ".", "enabledProtocols", "=", "TLSv1", ",", "TLSv1", ".", "1", ",", "TLSv1", ".", "2", "\"", ");", "basicSendReceive", "(", "\"", "ssl", ":", "//", "localhost", ":", "\"", "+", "broker", ".", "getConnectorByName", "(", "\"", "nio", "+", "ssl", "\"", ").", "getConnectUri", "(", ").", "getPort", "(", "))", ";", "BrokerService", "broker", "=", "createBroker", "(", "\"", "nio", "+", "ssl", "\"", ",", "getTransportType", "(", ")", "+", "\"", ":/", "/", "localhost", ":", "61616", "?", "transport", ".", "needClientAuth", "=", "true", "&", "transport", ".", "enabledProtocols", "=", "TLSv1", ",", "TLSv1", ".", "1", ",", "TLSv1", ".", "2", "&", "transport", ".", "verifyHostName", "=", "false", "\"", ");", "basicSendReceive", "(", "\"", "ssl", ":", "//", "localhost", ":", "\"", "+", "broker", ".", "getConnectorByName", "(", "\"", "nio", "+", "ssl", "\"", ").", "getConnectUri", "(", ").", "getPort", "(", ")", "+", "\"", "?", "socket", ".", "verifyHostName", "=", "false", "\"", ");", "stopBroker", "(", "broker", ")", ";", "}", "/", "/", "Client", "/", "server", "is", "missing", "verifyHostName", "=", "false", "so", "it", "should", "fail", "as", "cert", "doesn", "'", "t", "have", "right", "host", "name", "@", "Test", "(", "expected", "=", "Exception", ".", "class", ")", "public", "void", "verifyHostNameError", "(", ")", "throws", "Exception", "{", "BrokerService", "broker", "=", "null", ";", "try", "{", "broker", "=", "createBroker", "(", "\"", "nio", "+", "ssl", "\"", ",", "getTransportType", "(", ")", "+", "\"", ":/", "/", "localhost", ":", "61616", "?", "transport", ".", "needClientAuth", "=", "true", "\"", ");", "basicSendReceive", "(", "\"", "ssl", ":", "//", "localhost", ":", "\"", "+", "broker", ".", "getConnectorByName", "(", "\"", "nio", "+", "ssl", "\"", ").", "getConnectUri", "(", ").", "getPort", "(", "))", ";", "}", "finally", "{", "if", "(", "broker", "!", "=", "null", ")", "{", "stopBroker", "(", "broker", ")", ";", "}", "}", "}", "public", "void", "basicSendReceive", "(", "String", "uri", ")", "throws", "Exception", "{", "ActiveMQConnectionFactory", "factory", "=", "new", "ActiveMQConnectionFactory", "(", "uri", ")", ";", "Connection", "connection", "=", "factory", ".", "createConnection", "(", ");", "@", "@", "-", "74", ",", "7", "+", "74", ",", "7", "@", "@", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "broker", "=", "new", "BrokerService", "(", ");", "broker", ".", "setPersistent", "(", "false", ")", ";", "broker", ".", "setUseJmx", "(", "false", ")", ";", "connector", "=", "broker", ".", "addConnector", "(", "\"", "nio", "+", "ssl", ":", "//", "localhost", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "&", "transport", ".", "enabledCipherSuites", "=", "SSL_RSA_WITH_RC4_128_SHA", ",", "SSL_DH_anon_WITH_3DES_EDE_CBC_SHA", "\"", ");", "connector", "=", "broker", ".", "addConnector", "(", "\"", "nio", "+", "ssl", ":", "//", "localhost", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "&", "transport", ".", "verifyHostName", "=", "false", "&", "transport", ".", "enabledCipherSuites", "=", "TLS_RSA_WITH_AES_256_CBC_SHA256", "\"", ");", "broker", ".", "start", "(", ");", "broker", ".", "waitUntilStarted", "(", ");", "@", "@", "-", "113", ",", "6", "+", "113", ",", "7", "@", "@", "public", "void", "testLoad", "(", ")", "throws", "Exception", "{", "}", "Wait", ".", "waitFor", "(", "new", "Wait", ".", "Condition", "(", ")", "{", "@", "Override", "public", "boolean", "isSatisified", "(", ")", "throws", "Exception", "{", "return", "getReceived", "(", ")", "=", "=", "PRODUCER_COUNT", "*", "MESSAGE_COUNT", ";", "}", "@", "@", "-", "30", ",", "11", "+", "30", ",", "11", "@", "@", "@", "SuppressWarnings", "(", "\"", "javadoc", "\"", ")", "public", "class", "NIOSSLWindowSizeTest", "extends", "TestCase", "{", "BrokerService", "broker", ";", "Connection", "connection", ";", "Session", "session", ";", "public", "static", "final", "String", "KEYSTORE_TYPE", "=", "\"", "jks", "\"", ";", "public", "static", "final", "String", "PASSWORD", "=", "\"", "password", "\"", ";", "public", "static", "final", "String", "SERVER_KEYSTORE", "=", "\"", "src", "/", "test", "/", "resources", "/", "server", ".", "keystore", "\"", ";", "@", "@", "-", "46", ",", "7", "+", "46", ",", "7", "@", "@", "public", "static", "final", "int", "MESSAGE_SIZE", "=", "65536", ";", "byte", "[", "]", "messageData", ";", "@", "Override", "protected", "void", "setUp", "(", ")", "throws", "Exception", "{", "System", ".", "setProperty", "(", "\"", "javax", ".", "net", ".", "ssl", ".", "trustStore", "\"", ",", "TRUST_KEYSTORE", ")", ";", "@", "@", "-", "59", ",", "19", "+", "59", ",", "19", "@", "@", "protected", "void", "setUp", "(", ")", "throws", "Exception", "{", "broker", "=", "new", "BrokerService", "(", ");", "broker", ".", "setPersistent", "(", "false", ")", ";", "broker", ".", "setUseJmx", "(", "false", ")", ";", "TransportConnector", "connector", "=", "broker", ".", "addConnector", "(", "\"", "nio", "+", "ssl", ":", "//", "localhost", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "\"", ");", "TransportConnector", "connector", "=", "broker", ".", "addConnector", "(", "\"", "nio", "+", "ssl", ":", "//", "localhost", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "&", "transport", ".", "verifyHostName", "=", "false", "\"", ");", "broker", ".", "start", "(", ");", "broker", ".", "waitUntilStarted", "(", ");", "messageData", "=", "new", "byte", "[", "MESSAGE_SIZE", "]", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "MESSAGE_SIZE", ";", "i", "+", "+)", "{", "messageData", "[", "i", "]", "=", "(", "byte", ")", "(", "i", "&", "0xff", ")", ";", "}", "ActiveMQConnectionFactory", "factory", "=", "new", "ActiveMQConnectionFactory", "(", "\"", "nio", "+", "ssl", ":", "//", "localhost", ":", "\"", "+", "connector", ".", "getConnectUri", "(", ").", "getPort", "(", "))", ";", "connection", "=", "factory", ".", "createConnection", "(", ");", "session", "=", "connection", ".", "createSession", "(", "false", ",", "Session", ".", "AUTO_ACKNOWLEDGE", ")", ";", "session", "=", "connection", ".", "createSession", "(", "false", ",", "Session", ".", "AUTO_ACKNOWLEDGE", ")", ";", "connection", ".", "start", "(", ");", "}", "@", "@", "-", "100", ",", "14", "+", "100", ",", "14", "@", "@", "public", "void", "testLargePayload", "(", ")", "throws", "Exception", "{", "prod", ".", "send", "(", "msg", ")", ";", "}", "finally", "{", "prod", ".", "close", "(", ");", "}", "}", "MessageConsumer", "cons", "=", "null", ";", "try", "try", "{", "cons", "=", "session", ".", "createConsumer", "(", "dest", ")", ";", "assertNotNull", "(", "cons", ".", "receive", "(", "30000L", ")", ");", "}", "finally", "{", "cons", ".", "close", "(", ");", "}", "}", "}", "}", "@", "@", "-", "33", ",", "10", "+", "33", ",", "12", "@", "@", "private", "SslTransportFactory", "factory", ";", "private", "boolean", "verbose", ";", "@", "Override", "protected", "void", "setUp", "(", ")", "throws", "Exception", "{", "factory", "=", "new", "SslTransportFactory", "(", ");", "}", "@", "Override", "protected", "void", "tearDown", "(", ")", "throws", "Exception", "{", "super", ".", "tearDown", "(", ");", "}", "@", "@", "-", "96", ",", "6", "+", "98", ",", "12", "@", "@", "public", "void", "testCompositeConfigure", "(", ")", "throws", "IOException", "{", "/", "/", "-", "1", "since", "the", "option", "range", "is", "[", "-", "1", ",", "1", "]", ",", "not", "[", "0", ",", "2", "]", ".", "optionSettings", "[", "j", "]", "=", "getMthNaryDigit", "(", "i", ",", "j", ",", "3", ")", "-", "1", ";", "/", "/", "We", "now", "always", "set", "options", "to", "a", "default", "we", "default", "verifyHostName", "to", "true", "/", "/", "so", "we", "setSSLParameters", "so", "make", "the", "not", "set", "value", "=", "0", "if", "(", "optionSettings", "[", "j", "]", "=", "=", "-", "1", ")", "{", "optionSettings", "[", "j", "]", "=", "0", ";", "}", "if", "(", "optionSettings", "[", "j", "]", "!", "=", "-", "1", ")", "{", "options", ".", "put", "(", "optionNames", "[", "j", "]", ",", "optionSettings", "[", "j", "]", "=", "=", "1", "?", "\"", "true", "\"", ":", "\"", "false", "\"", ");", "}", "@", "@", "-", "36", ",", "12", "+", "36", ",", "12", "@", "@", "<", "/", "sslContext", ">", "<", "transportConnectors", ">", "<", "transportConnector", "name", "=", "\"", "stomp", "+", "ssl", "+", "special", "\"", "uri", "=", "\"", "stomp", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "needClientAuth", "=", "true", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "stomp", "+", "ssl", "\"", "uri", "=", "\"", "stomp", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "stomp", "+", "nio", "+", "ssl", "+", "special", "\"", "uri", "=", "\"", "stomp", "+", "nio", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "needClientAuth", "=", "true", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "stomp", "+", "nio", "+", "ssl", "\"", "uri", "=", "\"", "stomp", "+", "nio", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "mqtt", "+", "ssl", "\"", "uri", "=", "\"", "mqtt", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "mqtt", "+", "nio", "+", "ssl", "\"", "uri", "=", "\"", "mqtt", "+", "nio", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "stomp", "+", "ssl", "+", "special", "\"", "uri", "=", "\"", "stomp", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "needClientAuth", "=", "true", "&", "amp", ";", "transport", ".", "verifyHostName", "=", "false", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "stomp", "+", "ssl", "\"", "uri", "=", "\"", "stomp", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "&", "amp", ";", "transport", ".", "verifyHostName", "=", "false", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "stomp", "+", "nio", "+", "ssl", "+", "special", "\"", "uri", "=", "\"", "stomp", "+", "nio", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "needClientAuth", "=", "true", "&", "amp", ";", "transport", ".", "verifyHostName", "=", "false", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "stomp", "+", "nio", "+", "ssl", "\"", "uri", "=", "\"", "stomp", "+", "nio", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "&", "amp", ";", "transport", ".", "verifyHostName", "=", "false", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "mqtt", "+", "ssl", "\"", "uri", "=", "\"", "mqtt", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "&", "amp", ";", "transport", ".", "verifyHostName", "=", "false", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "mqtt", "+", "nio", "+", "ssl", "\"", "uri", "=", "\"", "mqtt", "+", "nio", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "&", "amp", ";", "transport", ".", "verifyHostName", "=", "false", "\"", "/", ">", "<", "/", "transportConnectors", ">", "<", "/", "broker", ">", "@", "@", "-", "36", ",", "10", "+", "36", ",", "10", "@", "@", "<", "/", "sslContext", ">", "<", "transportConnectors", ">", "<", "transportConnector", "name", "=", "\"", "stomp", "+", "ssl", "\"", "uri", "=", "\"", "stomp", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "stomp", "+", "nio", "+", "ssl", "\"", "uri", "=", "\"", "stomp", "+", "nio", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "openwire", "+", "ssl", "\"", "uri", "=", "\"", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "openwire", "+", "nio", "+", "ssl", "\"", "uri", "=", "\"", "nio", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "stomp", "+", "ssl", "\"", "uri", "=", "\"", "stomp", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "&", "amp", ";", "transport", ".", "verifyHostName", "=", "false", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "stomp", "+", "nio", "+", "ssl", "\"", "uri", "=", "\"", "stomp", "+", "nio", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "&", "amp", ";", "transport", ".", "verifyHostName", "=", "false", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "openwire", "+", "ssl", "\"", "uri", "=", "\"", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "&", "amp", ";", "transport", ".", "verifyHostName", "=", "false", "\"", "/", ">", "<", "transportConnector", "name", "=", "\"", "openwire", "+", "nio", "+", "ssl", "\"", "uri", "=", "\"", "nio", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "0", "?", "transport", ".", "needClientAuth", "=", "true", "&", "amp", ";", "transport", ".", "verifyHostName", "=", "false", "\"", "/", ">", "<", "/", "transportConnectors", ">", "<", "/", "broker", ">", "@", "@", "-", "171", ",", "7", "+", "171", ",", "7", "@", "@", "<", "/", "systemUsage", ">", "<", "transportConnectors", ">", "<", "transportConnector", "name", "=", "\"", "openwire", "+", "ssl", "-", "2", "\"", "uri", "=", "\"", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "61626", "?", "transport", ".", "closeAsync", "=", "false", "&", "amp", ";", "transport", ".", "enabledProtocols", "=", "TLSv1", ",", "TLSv1", ".", "1", ",", "TLSv1", ".", "2", "&", "amp", ";", "transport", ".", "needClientAuth", "=", "true", "\"", "/>", "<", "transportConnector", "name", "=", "\"", "openwire", "+", "ssl", "-", "2", "\"", "uri", "=", "\"", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "61626", "?", "transport", ".", "closeAsync", "=", "false", "&", "amp", ";", "transport", ".", "enabledProtocols", "=", "TLSv1", ",", "TLSv1", ".", "1", ",", "TLSv1", ".", "2", "&", "amp", ";", "transport", ".", "needClientAuth", "=", "true", "&", "amp", ";", "transport", ".", "verifyHostName", "=", "false", "\"", "/>", "<", "/", "transportConnectors", ">", "<", "/", "broker", ">", "<", "/", "beans", ">", "@", "@", "-", "171", ",", "7", "+", "171", ",", "7", "@", "@", "<", "/", "systemUsage", ">", "<", "transportConnectors", ">", "<", "transportConnector", "name", "=", "\"", "openwire", "+", "nio", "-", "ssl", "-", "2", "\"", "uri", "=", "\"", "nio", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "61626", "?", "transport", ".", "closeAsync", "=", "false", "&", "amp", ";", "transport", ".", "enabledProtocols", "=", "TLSv1", ",", "TLSv1", ".", "1", ",", "TLSv1", ".", "2", "&", "amp", ";", "transport", ".", "needClientAuth", "=", "true", "\"", "/>", "<", "transportConnector", "name", "=", "\"", "openwire", "+", "nio", "-", "ssl", "-", "2", "\"", "uri", "=", "\"", "nio", "+", "ssl", ":", "//", "0", ".", "0", ".", "0", ".", "0", ":", "61626", "?", "transport", ".", "closeAsync", "=", "false", "&", "amp", ";", "transport", ".", "enabledProtocols", "=", "TLSv1", ",", "TLSv1", ".", "1", ",", "TLSv1", ".", "2", "&", "amp", ";", "transport", ".", "needClientAuth", "=", "true", "&", "amp", ";", "transport", ".", "verifyHostName", "=", "false", "\"", "/>", "<", "/", "transportConnectors", ">", "<", "/", "broker", ">", "<", "/", "beans", ">"], "docstring_tokens": ["reference", "to", "an", "external", "resource"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1536", ",", "7", "+", "1536", ",", "7", "@", "@", "static", "void", "dma_rx", "(", "struct", "b43_dmaring", "*", "ring", ",", "int", "*", "slot", ")", "dmaaddr", "=", "meta", "-", ">", "dmaaddr", ";", "goto", "drop_recycle_buffer", ";", "}", "if", "(", "unlikely", "(", "len", ">", "ring", "-", ">", "rx_buffersize", ")", ")", "{", "if", "(", "unlikely", "(", "len", "+", "ring", "-", ">", "frameoffset", ">", "ring", "-", ">", "rx_buffersize", ")", ")", "{", "/", "*", "The", "data", "did", "not", "fit", "into", "one", "descriptor", "buffer", "*", "and", "is", "split", "over", "multiple", "buffers", ".", "*", "This", "should", "never", "happen", ",", "as", "we", "try", "to", "allocate", "buffers", "@", "@", "-", "163", ",", "7", "+", "163", ",", "7", "@", "@", "struct", "b43_dmadesc_generic", "{", "/", "*", "DMA", "engine", "tuning", "knobs", "*", "/", "#", "define", "B43_TXRING_SLOTS", "256", "#", "define", "B43_RXRING_SLOTS", "64", "#", "define", "B43_DMA0_RX_BUFFERSIZE", "IEEE80211_MAX_FRAME_LEN", "#", "define", "B43_DMA0_RX_BUFFERSIZE", "(", "B43_DMA0_RX_FRAMEOFFSET", "+", "IEEE80211_MAX_FRAME_LEN", ")", "/", "*", "Pointer", "poison", "*", "/", "#", "define", "B43_DMA_PTR_POISON", "(", "(", "void", "*", ")", "ERR_PTR", "(", "-", "ENOMEM", ")", ")"], "docstring_tokens": ["sending", "frames", "to", "the", "systems"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1873", ",", "6", "+", "1873", ",", "7", "@", "@", "static", "int", "tty_open", "(", "struct", "inode", "*", "inode", ",", "struct", "file", "*", "filp", ")", "if", "(", "IS_ERR", "(", "tty", ")", ")", "{", "tty_unlock", "(", ");", "mutex_unlock", "(", "&", "tty_mutex", ")", ";", "tty_driver_kref_put", "(", "driver", ")", ";", "return", "PTR_ERR", "(", "tty", ")", ";", "}", "}"], "docstring_tokens": ["via", "crafted", "access", "to", "a", "device", "file", "under", "the", "/dev/pts", "directory", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "724", ",", "7", "+", "724", ",", "21", "@", "@", "private", "void", "splitHeader", "(", "AppendableCharSequence", "sb", ")", "{", "nameStart", "=", "findNonWhitespace", "(", "sb", ",", "0", ")", ";", "for", "(", "nameEnd", "=", "nameStart", ";", "nameEnd", "<", "length", ";", "nameEnd", "+", "+)", "{", "char", "ch", "=", "sb", ".", "charAtUnsafe", "(", "nameEnd", ")", ";", "if", "(", "ch", "=", "=", "'", ":'", "|", "|", "Character", ".", "isWhitespace", "(", "ch", ")", ")", "{", "/", "/", "https", ":", "//", "tools", ".", "ietf", ".", "org", "/", "html", "/", "rfc7230", "#", "section", "-", "3", ".", "2", ".", "4", "/", "/", "/", "/", "No", "whitespace", "is", "allowed", "between", "the", "header", "field", "-", "name", "and", "colon", ".", "In", "/", "/", "the", "past", ",", "differences", "in", "the", "handling", "of", "such", "whitespace", "have", "led", "to", "/", "/", "security", "vulnerabilities", "in", "request", "routing", "and", "response", "handling", ".", "A", "/", "/", "server", "MUST", "reject", "any", "received", "request", "message", "that", "contains", "/", "/", "whitespace", "between", "a", "header", "field", "-", "name", "and", "colon", "with", "a", "response", "code", "/", "/", "of", "400", "(", "Bad", "Request", ")", ".", "A", "proxy", "MUST", "remove", "any", "such", "whitespace", "from", "a", "/", "/", "response", "message", "before", "forwarding", "the", "message", "downstream", ".", "if", "(", "ch", "=", "=", "'", ":'", "|", "|", "/", "/", "In", "case", "of", "decoding", "a", "request", "we", "will", "just", "continue", "processing", "and", "header", "validation", "/", "/", "is", "done", "in", "the", "DefaultHttpHeaders", "implementation", ".", "/", "/", "/", "/", "In", "the", "case", "of", "decoding", "a", "response", "we", "will", "\"", "skip", "\"", "the", "whitespace", ".", "(", "!", "isDecodingRequest", "(", ")", "&", "&", "Character", ".", "isWhitespace", "(", "ch", ")", "))", "{", "break", ";", "}", "}", "@", "@", "-", "320", ",", "4", "+", "320", ",", "18", "@", "@", "public", "void", "testTooLargeHeaders", "(", ")", "{", "assertTrue", "(", "request", ".", "decoderResult", "(", ").", "cause", "(", ")", "instanceof", "TooLongFrameException", ")", ";", "assertFalse", "(", "channel", ".", "finish", "(", "))", ";", "}", "@", "Test", "public", "void", "testWhitespace", "(", ")", "{", "EmbeddedChannel", "channel", "=", "new", "EmbeddedChannel", "(", "new", "HttpRequestDecoder", "(", "))", ";", "String", "requestStr", "=", "\"", "GET", "/", "some", "/", "path", "HTTP", "/", "1", ".", "1", "\\", "r", "\\", "n", "\"", "\"", "Transfer", "-", "Encoding", ":", "chunked", "\\", "r", "\\", "n", "\"", "\"", "Host", ":", "netty", ".", "io", "\\", "n", "\\", "r", "\\", "n", "\"", ";", "assertTrue", "(", "channel", ".", "writeInbound", "(", "Unpooled", ".", "copiedBuffer", "(", "requestStr", ",", "CharsetUtil", ".", "US_ASCII", ")", "))", ";", "HttpRequest", "request", "=", "channel", ".", "readInbound", "(", ");", "assertTrue", "(", "request", ".", "decoderResult", "(", ").", "isFailure", "(", "))", ";", "assertTrue", "(", "request", ".", "decoderResult", "(", ").", "cause", "(", ")", "instanceof", "IllegalArgumentException", ")", ";", "assertFalse", "(", "channel", ".", "finish", "(", "))", ";", "}", "}", "@", "@", "-", "663", ",", "4", "+", "663", ",", "19", "@", "@", "public", "void", "testTrailerWithEmptyLineInSeparateBuffer", "(", ")", "{", "assertFalse", "(", "channel", ".", "finish", "(", "))", ";", "}", "@", "Test", "public", "void", "testWhitespace", "(", ")", "{", "EmbeddedChannel", "channel", "=", "new", "EmbeddedChannel", "(", "new", "HttpResponseDecoder", "(", "))", ";", "String", "requestStr", "=", "\"", "HTTP", "/", "1", ".", "1", "200", "OK", "\\", "r", "\\", "n", "\"", "\"", "Transfer", "-", "Encoding", ":", "chunked", "\\", "r", "\\", "n", "\"", "\"", "Host", ":", "netty", ".", "io", "\\", "n", "\\", "r", "\\", "n", "\"", ";", "assertTrue", "(", "channel", ".", "writeInbound", "(", "Unpooled", ".", "copiedBuffer", "(", "requestStr", ",", "CharsetUtil", ".", "US_ASCII", ")", "))", ";", "HttpResponse", "response", "=", "channel", ".", "readInbound", "(", ");", "assertFalse", "(", "response", ".", "decoderResult", "(", ").", "isFailure", "(", "))", ";", "assertEquals", "(", "HttpHeaderValues", ".", "CHUNKED", ".", "toString", "(", "),", "response", ".", "headers", "(", ").", "get", "(", "HttpHeaderNames", ".", "TRANSFER_ENCODING", ")", ");", "assertEquals", "(", "\"", "netty", ".", "io", "\"", ",", "response", ".", "headers", "(", ").", "get", "(", "HttpHeaderNames", ".", "HOST", ")", ");", "assertFalse", "(", "channel", ".", "finish", "(", "))", ";", "}", "}"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "404", ",", "19", "+", "404", ",", "6", "@", "@", "static", "inline", "int", "sctp_list_single_entry", "(", "struct", "list_head", "*", "head", ")", "return", "(", "(", "head", "-", ">", "next", "!", "=", "head", ")", "&", "&", "(", "head", "-", ">", "next", "=", "=", "head", "-", ">", "prev", ")", ");", "}", "/", "*", "Calculate", "the", "size", "(", "in", "bytes", ")", "occupied", "by", "the", "data", "of", "an", "iovec", ".", "*", "/", "static", "inline", "size_t", "get_user_iov_size", "(", "struct", "iovec", "*", "iov", ",", "int", "iovlen", ")", "{", "size_t", "retval", "=", "0", ";", "for", "(", ";", "iovlen", ">", "0", ";", "-", "-", "iovlen", ")", "{", "retval", "+", "=", "iov", "-", ">", "iov_len", ";", "iov", "+", "+;", "}", "return", "retval", ";", "}", "/", "*", "Generate", "a", "random", "jitter", "in", "the", "range", "of", "-", "50", "%", "~", "+", "50", "%", "of", "input", "RTO", ".", "*", "/", "static", "inline", "__s32", "sctp_jitter", "(", "__u32", "rto", ")", "{", "@", "@", "-", "221", ",", "8", "+", "221", ",", "7", "@", "@", "struct", "sctp_chunk", "*", "sctp_make_abort_no_data", "(", "const", "struct", "sctp_association", "*", ",", "const", "struct", "sctp_chunk", "*", ",", "__u32", "tsn", ")", ";", "struct", "sctp_chunk", "*", "sctp_make_abort_user", "(", "const", "struct", "sctp_association", "*", ",", "const", "struct", "sctp_chunk", "*", ",", "const", "struct", "msghdr", "*", ");", "const", "struct", "msghdr", "*", ",", "size_t", "msg_len", ")", ";", "struct", "sctp_chunk", "*", "sctp_make_abort_violation", "(", "const", "struct", "sctp_association", "*", ",", "const", "struct", "sctp_chunk", "*", ",", "const", "__u8", "*", ",", "@", "@", "-", "806", ",", "38", "+", "806", ",", "26", "@", "@", "struct", "sctp_chunk", "*", "sctp_make_abort_no_data", "(", "/", "*", "Helper", "to", "create", "ABORT", "with", "a", "SCTP_ERROR_USER_ABORT", "error", ".", "*", "/", "struct", "sctp_chunk", "*", "sctp_make_abort_user", "(", "const", "struct", "sctp_association", "*", "asoc", ",", "const", "struct", "sctp_chunk", "*", "chunk", ",", "const", "struct", "msghdr", "*", "msg", ")", "const", "struct", "msghdr", "*", "msg", ",", "size_t", "paylen", ")", "{", "struct", "sctp_chunk", "*", "retval", ";", "void", "*", "payload", "=", "NULL", ",", "*", "payoff", ";", "size_t", "paylen", "=", "0", ";", "struct", "iovec", "*", "iov", "=", "NULL", ";", "int", "iovlen", "=", "0", ";", "if", "(", "msg", ")", "{", "iov", "=", "msg", "-", ">", "msg_iov", ";", "iovlen", "=", "msg", "-", ">", "msg_iovlen", ";", "paylen", "=", "get_user_iov_size", "(", "iov", ",", "iovlen", ")", ";", "}", "void", "*", "payload", "=", "NULL", ";", "int", "err", ";", "retval", "=", "sctp_make_abort", "(", "asoc", ",", "chunk", ",", "sizeof", "(", "sctp_errhdr_t", ")", "+", "paylen", ")", ";", "retval", "=", "sctp_make_abort", "(", "asoc", ",", "NULL", ",", "sizeof", "(", "sctp_errhdr_t", ")", "+", "paylen", ")", ";", "if", "(", "!", "retval", ")", "goto", "err_chunk", ";", "if", "(", "paylen", ")", "{", "/", "*", "Put", "the", "msg_iov", "together", "into", "payload", ".", "*", "/", "payload", "=", "kmalloc", "(", "paylen", ",", "GFP_ATOMIC", ")", ";", "payload", "=", "kmalloc", "(", "paylen", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "payload", ")", "goto", "err_payload", ";", "payoff", "=", "payload", ";", "for", "(", ";", "iovlen", ">", "0", ";", "-", "-", "iovlen", ")", "{", "if", "(", "copy_from_user", "(", "payoff", ",", "iov", "-", ">", "iov_base", ",", "iov", "-", ">", "iov_len", ")", ")", "goto", "err_copy", ";", "payoff", "+", "=", "iov", "-", ">", "iov_len", ";", "iov", "+", "+;", "}", "err", "=", "memcpy_fromiovec", "(", "payload", ",", "msg", "-", ">", "msg_iov", ",", "paylen", ")", ";", "if", "(", "err", "<", "0", ")", "goto", "err_copy", ";", "}", "sctp_init_cause", "(", "retval", ",", "SCTP_ERROR_USER_ABORT", ",", "payload", ",", "paylen", ")", ";", "@", "@", "-", "4031", ",", "18", "+", "4031", ",", "12", "@", "@", "sctp_disposition_t", "sctp_sf_do_9_1_prm_abort", "(", "*", "from", "its", "upper", "layer", ",", "but", "retransmits", "data", "to", "the", "far", "end", "*", "if", "necessary", "to", "fill", "gaps", ".", "*", "/", "struct", "msghdr", "*", "msg", "=", "arg", ";", "struct", "sctp_chunk", "*", "abort", ";", "struct", "sctp_chunk", "*", "abort", "=", "arg", ";", "sctp_disposition_t", "retval", ";", "retval", "=", "SCTP_DISPOSITION_CONSUME", ";", "/", "*", "Generate", "ABORT", "chunk", "to", "send", "the", "peer", ".", "*", "/", "abort", "=", "sctp_make_abort_user", "(", "asoc", ",", "NULL", ",", "msg", ")", ";", "if", "(", "!", "abort", ")", "retval", "=", "SCTP_DISPOSITION_NOMEM", ";", "else", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_REPLY", ",", "SCTP_CHUNK", "(", "abort", ")", ");", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_REPLY", ",", "SCTP_CHUNK", "(", "abort", ")", ");", "/", "*", "Even", "if", "we", "can", "'", "t", "send", "the", "ABORT", "due", "to", "low", "memory", "delete", "the", "*", "TCB", ".", "This", "is", "a", "departure", "from", "our", "typical", "NOMEM", "handling", ".", "@", "@", "-", "4166", ",", "21", "+", "4160", ",", "15", "@", "@", "sctp_disposition_t", "sctp_sf_cookie_wait_prm_abort", "(", "void", "*", "arg", ",", "sctp_cmd_seq_t", "*", "commands", ")", "{", "struct", "msghdr", "*", "msg", "=", "arg", ";", "struct", "sctp_chunk", "*", "abort", ";", "struct", "sctp_chunk", "*", "abort", "=", "arg", ";", "sctp_disposition_t", "retval", ";", "/", "*", "Stop", "T1", "-", "init", "timer", "*", "/", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_TIMER_STOP", ",", "SCTP_TO", "(", "SCTP_EVENT_TIMEOUT_T1_INIT", ")", ");", "retval", "=", "SCTP_DISPOSITION_CONSUME", ";", "/", "*", "Generate", "ABORT", "chunk", "to", "send", "the", "peer", "*", "/", "abort", "=", "sctp_make_abort_user", "(", "asoc", ",", "NULL", ",", "msg", ")", ";", "if", "(", "!", "abort", ")", "retval", "=", "SCTP_DISPOSITION_NOMEM", ";", "else", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_REPLY", ",", "SCTP_CHUNK", "(", "abort", ")", ");", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_REPLY", ",", "SCTP_CHUNK", "(", "abort", ")", ");", "sctp_add_cmd_sf", "(", "commands", ",", "SCTP_CMD_NEW_STATE", ",", "SCTP_STATE", "(", "SCTP_STATE_CLOSED", ")", ");", "@", "@", "-", "1520", ",", "8", "+", "1520", ",", "16", "@", "@", "SCTP_STATIC", "int", "sctp_sendmsg", "(", "struct", "kiocb", "*", "iocb", ",", "struct", "sock", "*", "sk", ",", "goto", "out_unlock", ";", "}", "if", "(", "sinfo_flags", "&", "SCTP_ABORT", ")", "{", "struct", "sctp_chunk", "*", "chunk", ";", "chunk", "=", "sctp_make_abort_user", "(", "asoc", ",", "msg", ",", "msg_len", ")", ";", "if", "(", "!", "chunk", ")", "{", "err", "=", "-", "ENOMEM", ";", "goto", "out_unlock", ";", "}", "SCTP_DEBUG_PRINTK", "(", "\"", "Aborting", "association", ":", "%", "p", "\\", "n", "\"", ",", "asoc", ")", ";", "sctp_primitive_ABORT", "(", "asoc", ",", "msg", ")", ";", "sctp_primitive_ABORT", "(", "asoc", ",", "chunk", ")", ";", "err", "=", "0", ";", "goto", "out_unlock", ";", "}"], "docstring_tokens": ["via", "unknown", "attack", "vectors", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1913", ",", "7", "+", "1913", ",", "10", "@", "@", "static", "int", "sctp_sendmsg_to_asoc", "(", "struct", "sctp_association", "*", "asoc", ",", "if", "(", "sctp_wspace", "(", "asoc", ")", "<", "(", "int", ")", "msg_len", ")", "sctp_prsctp_prune", "(", "asoc", ",", "sinfo", ",", "msg_len", "-", "sctp_wspace", "(", "asoc", ")", ");", "if", "(", "sctp_wspace", "(", "asoc", ")", "<", "=", "0", ")", "{", "if", "(", "sk_under_memory_pressure", "(", "sk", ")", ")", "sk_mem_reclaim", "(", "sk", ")", ";", "if", "(", "sctp_wspace", "(", "asoc", ")", "<", "=", "0", "|", "|", "!", "sk_wmem_schedule", "(", "sk", ",", "msg_len", ")", ")", "{", "timeo", "=", "sock_sndtimeo", "(", "sk", ",", "msg", "-", ">", "msg_flags", "&", "MSG_DONTWAIT", ")", ";", "err", "=", "sctp_wait_for_sndbuf", "(", "asoc", ",", "&", "timeo", ",", "msg_len", ")", ";", "if", "(", "err", ")", "@", "@", "-", "8930", ",", "7", "+", "8933", ",", "10", "@", "@", "static", "int", "sctp_wait_for_sndbuf", "(", "struct", "sctp_association", "*", "asoc", ",", "long", "*", "timeo_p", ",", "goto", "do_error", ";", "if", "(", "signal_pending", "(", "current", ")", ")", "goto", "do_interrupted", ";", "if", "(", "(", "int", ")", "msg_len", "<", "=", "sctp_wspace", "(", "asoc", ")", ")", "if", "(", "sk_under_memory_pressure", "(", "sk", ")", ")", "sk_mem_reclaim", "(", "sk", ")", ";", "if", "(", "(", "int", ")", "msg_len", "<", "=", "sctp_wspace", "(", "asoc", ")", "&", "&", "sk_wmem_schedule", "(", "sk", ",", "msg_len", ")", ")", "break", ";", "/", "*", "Let", "another", "process", "have", "a", "go", ".", "Since", "we", "are", "going"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "26", ",", "7", "+", "26", ",", "6", "@", "@", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "inject", ".", "Inject", ";", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "interceptor", ".", "AbstractInterceptor", ";", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "interceptor", ".", "ValidationAware", ";", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "util", ".", "LocalizedTextUtil", ";", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "util", ".", "TextParseUtil", ";", "import", "org", ".", "apache", ".", "logging", ".", "log4j", ".", "LogManager", ";", "import", "org", ".", "apache", ".", "logging", ".", "log4j", ".", "Logger", ";", "@", "@", "-", "38", ",", "7", "+", "37", ",", "6", "@", "@", "import", "org", ".", "apache", ".", "struts2", ".", "util", ".", "ContentTypeMatcher", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletRequest", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "text", ".", "NumberFormat", ";", "import", "java", ".", "util", ".", "*;", "@", "@", "-", "258", ",", "11", "+", "256", ",", "16", "@", "@", "public", "String", "intercept", "(", "ActionInvocation", "invocation", ")", "throws", "Exception", "{", "MultiPartRequestWrapper", "multiWrapper", "=", "(", "MultiPartRequestWrapper", ")", "request", ";", "if", "(", "multiWrapper", ".", "hasErrors", "(", "))", "{", "if", "(", "multiWrapper", ".", "hasErrors", "(", ")", "&", "&", "validation", "!", "=", "null", ")", "{", "TextProvider", "textProvider", "=", "getTextProvider", "(", "action", ")", ";", "for", "(", "LocalizedMessage", "error", ":", "multiWrapper", ".", "getErrors", "(", "))", "{", "if", "(", "validation", "!", "=", "null", ")", "{", "validation", ".", "addActionError", "(", "LocalizedTextUtil", ".", "findText", "(", "error", ".", "getClazz", "(", "),", "error", ".", "getTextKey", "(", "),", "ActionContext", ".", "getContext", "(", ").", "getLocale", "(", "),", "error", ".", "getDefaultMessage", "(", "),", "error", ".", "getArgs", "(", "))", ");", "String", "errorMessage", ";", "if", "(", "textProvider", ".", "hasKey", "(", "error", ".", "getTextKey", "(", "))", ")", "{", "errorMessage", "=", "textProvider", ".", "getText", "(", "error", ".", "getTextKey", "(", "),", "Arrays", ".", "asList", "(", "error", ".", "getArgs", "(", "))", ");", "}", "else", "{", "errorMessage", "=", "textProvider", ".", "getText", "(", "\"", "struts", ".", "messages", ".", "error", ".", "uploading", "\"", ",", "error", ".", "getDefaultMessage", "(", "))", ";", "}", "validation", ".", "addActionError", "(", "errorMessage", ")", ";", "}", "}", "@", "@", "-", "231", ",", "7", "+", "231", ",", "7", "@", "@", "public", "void", "testInvalidContentTypeMultipartRequest", "(", ")", "throws", "Exception", "{", "req", ".", "setContentType", "(", "\"", "text", "/", "xml", "\"", ");", "/", "/", "not", "a", "multipart", "contentype", "req", ".", "addHeader", "(", "\"", "Content", "-", "type", "\"", ",", "\"", "multipart", "/", "form", "-", "data", "\"", ");", "MyFileupAction", "action", "=", "new", "MyFileupAction", "(", ");", "MyFileupAction", "action", "=", "container", ".", "inject", "(", "MyFileupAction", ".", "class", ")", ";", "MockActionInvocation", "mai", "=", "new", "MockActionInvocation", "(", ");", "mai", ".", "setAction", "(", "action", ")", ";", "mai", ".", "setResultCode", "(", "\"", "success", "\"", ");", "@", "@", "-", "252", ",", "7", "+", "252", ",", "7", "@", "@", "public", "void", "testNoContentMultipartRequest", "(", ")", "throws", "Exception", "{", "req", ".", "addHeader", "(", "\"", "Content", "-", "type", "\"", ",", "\"", "multipart", "/", "form", "-", "data", "\"", ");", "req", ".", "setContent", "(", "null", ")", ";", "/", "/", "there", "is", "no", "content", "MyFileupAction", "action", "=", "new", "MyFileupAction", "(", ");", "MyFileupAction", "action", "=", "container", ".", "inject", "(", "MyFileupAction", ".", "class", ")", ";", "MockActionInvocation", "mai", "=", "new", "MockActionInvocation", "(", ");", "mai", ".", "setAction", "(", "action", ")", ";", "mai", ".", "setResultCode", "(", "\"", "success", "\"", ");", "@", "@", "-", "386", ",", "7", "+", "386", ",", "7", "@", "@", "public", "void", "testMultipartRequestLocalizedError", "(", ")", "throws", "Exception", "{", "\"", "--", "--", "-", "1234", "-", "-\\", "r", "\\", "n", "\"", ");", "req", ".", "setContent", "(", "content", ".", "getBytes", "(", "\"", "US", "-", "ASCII", "\"", "))", ";", "MyFileupAction", "action", "=", "new", "MyFileupAction", "(", ");", "MyFileupAction", "action", "=", "container", ".", "inject", "(", "MyFileupAction", ".", "class", ")", ";", "MockActionInvocation", "mai", "=", "new", "MockActionInvocation", "(", ");", "mai", ".", "setAction", "(", "action", ")", ";", "@", "@", "-", "453", ",", "7", "+", "453", ",", "7", "@", "@", "protected", "void", "tearDown", "(", ")", "throws", "Exception", "{", "super", ".", "tearDown", "(", ");", "}", "private", "class", "MyFileupAction", "extends", "ActionSupport", "{", "public", "static", "class", "MyFileupAction", "extends", "ActionSupport", "{", "private", "static", "final", "long", "serialVersionUID", "=", "6255238895447968889L", ";"], "docstring_tokens": ["using", "a", "malicious", "Content-Type", "value"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "21", ",", "7", "+", "21", ",", "6", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "context", ".", "Cascadable", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "context", ".", "GroupConversionTargetContext", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "context", ".", "Unwrapable", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "cfg", ".", "DefaultConstraintMapping", ";", "import", "static", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "CollectionHelper", ".", "newHashMap", ";", "@", "@", "-", "30", ",", "14", "+", "29", ",", "14", "@", "@", "*", "*", "@", "author", "Gunnar", "Morling", "*", "/", "public", "abstract", "class", "CascadableConstraintMappingContextImplBase", "<", "C", "extends", "Cascadable", "<", "C", ">", "&", "Unwrapable", "<", "C", ">", ">", "abstract", "class", "CascadableConstraintMappingContextImplBase", "<", "C", "extends", "Cascadable", "<", "C", ">", "&", "Unwrapable", "<", "C", ">", ">", "extends", "ConstraintMappingContextImplBase", "implements", "Cascadable", "<", "C", ">", ",", "Unwrapable", "<", "C", ">", "{", "protected", "boolean", "isCascading", ";", "protected", "Map", "<", "Class", "<", "?>", ",", "Class", "<", "?>", ">", "groupConversions", "=", "newHashMap", "(", ");", "private", "boolean", "unwrapValidatedValue", ";", "public", "CascadableConstraintMappingContextImplBase", "(", "DefaultConstraintMapping", "mapping", ")", "{", "CascadableConstraintMappingContextImplBase", "(", "DefaultConstraintMapping", "mapping", ")", "{", "super", "(", "mapping", ")", ";", "}", "@", "@", "-", "36", ",", "7", "+", "36", ",", "7", "@", "@", "*", "*", "@", "author", "Gunnar", "Morling", "*", "/", "public", "class", "ConfiguredConstraint", "<", "A", "extends", "Annotation", ">", "{", "class", "ConfiguredConstraint", "<", "A", "extends", "Annotation", ">", "{", "private", "static", "final", "Log", "log", "=", "LoggerFactory", ".", "make", "(", ");", "@", "@", "-", "51", ",", "11", "+", "51", ",", "11", "@", "@", "private", "ConfiguredConstraint", "(", "ConstraintDef", "<", "?,", "A", ">", "constraint", ",", "ConstraintLocation", "this", ".", "elementType", "=", "elementType", ";", "}", "public", "static", "<", "A", "extends", "Annotation", ">", "ConfiguredConstraint", "<", "A", ">", "forType", "(", "ConstraintDef", "<", "?,", "A", ">", "constraint", ",", "Class", "<", "?>", "beanType", ")", "{", "static", "<", "A", "extends", "Annotation", ">", "ConfiguredConstraint", "<", "A", ">", "forType", "(", "ConstraintDef", "<", "?,", "A", ">", "constraint", ",", "Class", "<", "?>", "beanType", ")", "{", "return", "new", "ConfiguredConstraint", "<", "A", ">", "(", "constraint", ",", "ConstraintLocation", ".", "forClass", "(", "beanType", ")", ",", "ElementType", ".", "TYPE", ")", ";", "}", "public", "static", "<", "A", "extends", "Annotation", ">", "ConfiguredConstraint", "<", "A", ">", "forProperty", "(", "ConstraintDef", "<", "?,", "A", ">", "constraint", ",", "Member", "member", ")", "{", "static", "<", "A", "extends", "Annotation", ">", "ConfiguredConstraint", "<", "A", ">", "forProperty", "(", "ConstraintDef", "<", "?,", "A", ">", "constraint", ",", "Member", "member", ")", "{", "return", "new", "ConfiguredConstraint", "<", "A", ">", "(", "constraint", ",", "ConstraintLocation", ".", "forProperty", "(", "member", ")", ",", "@", "@", "-", "21", ",", "7", "+", "21", ",", "6", "@", "@", "import", "java", ".", "util", ".", "Set", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "context", ".", "TypeConstraintMappingContext", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "cfg", ".", "DefaultConstraintMapping", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "core", ".", "ConstraintHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "core", ".", "MetaConstraint", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "descriptor", ".", "ConstraintDescriptorImpl", ";", "@", "@", "-", "34", ",", "12", "+", "33", ",", "12", "@", "@", "*", "*", "@", "author", "Gunnar", "Morling", "*", "/", "public", "abstract", "class", "ConstraintMappingContextImplBase", "{", "abstract", "class", "ConstraintMappingContextImplBase", "{", "protected", "final", "DefaultConstraintMapping", "mapping", ";", "private", "final", "Set", "<", "ConfiguredConstraint", "<", "?>", ">", "constraints", ";", "public", "ConstraintMappingContextImplBase", "(", "DefaultConstraintMapping", "mapping", ")", "{", "ConstraintMappingContextImplBase", "(", "DefaultConstraintMapping", "mapping", ")", "{", "this", ".", "mapping", "=", "mapping", ";", "this", ".", "constraints", "=", "newHashSet", "(", ");", "}", "@", "@", "-", "29", ",", "13", "+", "29", ",", "13", "@", "@", "*", "*", "@", "author", "Gunnar", "Morling", "*", "/", "public", "final", "class", "CrossParameterConstraintMappingContextImpl", "final", "class", "CrossParameterConstraintMappingContextImpl", "extends", "ConstraintMappingContextImplBase", "implements", "CrossParameterConstraintMappingContext", "{", "private", "final", "ExecutableConstraintMappingContextImpl", "executableContext", ";", "public", "CrossParameterConstraintMappingContextImpl", "(", "ExecutableConstraintMappingContextImpl", "executableContext", ")", "{", "CrossParameterConstraintMappingContextImpl", "(", "ExecutableConstraintMappingContextImpl", "executableContext", ")", "{", "super", "(", "executableContext", ".", "getTypeContext", "(", ").", "getConstraintMapping", "(", ")", ")", ";", "this", ".", "executableContext", "=", "executableContext", ";", "}", "@", "@", "-", "14", ",", "14", "+", "14", ",", "14", "@", "@", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "cfg", ";", "package", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "cfg", ".", "context", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "javax", ".", "validation", ".", "ParameterNameProvider", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "ConstraintMapping", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "context", ".", "TypeConstraintMappingContext", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "cfg", ".", "context", ".", "TypeConstraintMappingContextImpl", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "core", ".", "AnnotationProcessingOptionsImpl", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "core", ".", "ConstraintHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ".", "BeanConfiguration", ";", "@", "@", "-", "49", ",", "7", "+", "49", ",", "7", "@", "@", "*", "@", "author", "Kevin", "Pollet", "&", "lt", ";", "kevin", ".", "pollet", "@", "serli", ".", "com", "&", "gt", ";", "(", "C", ")", "2011", "SERLI", "*", "@", "author", "Gunnar", "Morling", "*", "/", "public", "class", "ExecutableConstraintMappingContextImpl", "class", "ExecutableConstraintMappingContextImpl", "implements", "ConstructorConstraintMappingContext", ",", "MethodConstraintMappingContext", "{", "private", "static", "final", "Log", "log", "=", "LoggerFactory", ".", "make", "(", ");", "@", "@", "-", "60", ",", "11", "+", "60", ",", "11", "@", "@", "private", "ReturnValueConstraintMappingContextImpl", "returnValueContext", ";", "private", "CrossParameterConstraintMappingContextImpl", "crossParameterContext", ";", "public", "ExecutableConstraintMappingContextImpl", "(", "TypeConstraintMappingContextImpl", "<", "?>", "typeContext", ",", "Constructor", "<", "?>", "constructor", ")", "{", "ExecutableConstraintMappingContextImpl", "(", "TypeConstraintMappingContextImpl", "<", "?>", "typeContext", ",", "Constructor", "<", "?>", "constructor", ")", "{", "this", "(", "typeContext", ",", "ExecutableElement", ".", "forConstructor", "(", "constructor", ")", ")", ";", "}", "public", "ExecutableConstraintMappingContextImpl", "(", "TypeConstraintMappingContextImpl", "<", "?>", "typeContext", ",", "Method", "method", ")", "{", "ExecutableConstraintMappingContextImpl", "(", "TypeConstraintMappingContextImpl", "<", "?>", "typeContext", ",", "Method", "method", ")", "{", "this", "(", "typeContext", ",", "ExecutableElement", ".", "forMethod", "(", "method", ")", ")", ";", "}", "@", "@", "-", "23", ",", "13", "+", "23", ",", "13", "@", "@", "*", "*", "@", "author", "Gunnar", "Morling", "*", "/", "public", "class", "GroupConversionTargetContextImpl", "<", "C", ">", "implements", "GroupConversionTargetContext", "<", "C", ">", "{", "class", "GroupConversionTargetContextImpl", "<", "C", ">", "implements", "GroupConversionTargetContext", "<", "C", ">", "{", "private", "final", "C", "cascadableContext", ";", "private", "final", "Class", "<", "?>", "from", ";", "private", "final", "CascadableConstraintMappingContextImplBase", "<", "?>", "target", ";", "public", "GroupConversionTargetContextImpl", "(", "Class", "<", "?>", "from", ",", "C", "cascadableContext", ",", "CascadableConstraintMappingContextImplBase", "<", "?>", "target", ")", "{", "GroupConversionTargetContextImpl", "(", "Class", "<", "?>", "from", ",", "C", "cascadableContext", ",", "CascadableConstraintMappingContextImplBase", "<", "?>", "target", ")", "{", "this", ".", "from", "=", "from", ";", "this", ".", "cascadableContext", "=", "cascadableContext", ";", "this", ".", "target", "=", "target", ";", "@", "@", "-", "38", ",", "14", "+", "38", ",", "14", "@", "@", "*", "@", "author", "Gunnar", "Morling", "*", "@", "author", "Kevin", "Pollet", "&", "lt", ";", "kevin", ".", "pollet", "@", "serli", ".", "com", "&", "gt", ";", "(", "C", ")", "2011", "SERLI", "*", "/", "public", "final", "class", "ParameterConstraintMappingContextImpl", "final", "class", "ParameterConstraintMappingContextImpl", "extends", "CascadableConstraintMappingContextImplBase", "<", "ParameterConstraintMappingContext", ">", "implements", "ParameterConstraintMappingContext", "{", "private", "final", "ExecutableConstraintMappingContextImpl", "executableContext", ";", "private", "final", "int", "parameterIndex", ";", "public", "ParameterConstraintMappingContextImpl", "(", "ExecutableConstraintMappingContextImpl", "executableContext", ",", "int", "parameterIndex", ")", "{", "ParameterConstraintMappingContextImpl", "(", "ExecutableConstraintMappingContextImpl", "executableContext", ",", "int", "parameterIndex", ")", "{", "super", "(", "executableContext", ".", "getTypeContext", "(", ").", "getConstraintMapping", "(", ")", ")", ";", "this", ".", "executableContext", "=", "executableContext", ";", "@", "@", "-", "41", ",", "14", "+", "41", ",", "14", "@", "@", "*", "@", "author", "Gunnar", "Morling", "*", "@", "author", "Kevin", "Pollet", "&", "lt", ";", "kevin", ".", "pollet", "@", "serli", ".", "com", "&", "gt", ";", "(", "C", ")", "2011", "SERLI", "*", "/", "public", "final", "class", "PropertyConstraintMappingContextImpl", "final", "class", "PropertyConstraintMappingContextImpl", "extends", "CascadableConstraintMappingContextImplBase", "<", "PropertyConstraintMappingContext", ">", "implements", "PropertyConstraintMappingContext", "{", "private", "final", "TypeConstraintMappingContextImpl", "<", "?>", "typeContext", ";", "private", "final", "Member", "member", ";", "public", "PropertyConstraintMappingContextImpl", "(", "TypeConstraintMappingContextImpl", "<", "?>", "typeContext", ",", "Member", "member", ")", "{", "PropertyConstraintMappingContextImpl", "(", "TypeConstraintMappingContextImpl", "<", "?>", "typeContext", ",", "Member", "member", ")", "{", "super", "(", "typeContext", ".", "getConstraintMapping", "(", ")", ")", ";", "this", ".", "typeContext", "=", "typeContext", ";", "this", ".", "member", "=", "member", ";", "@", "@", "-", "99", ",", "7", "+", "99", ",", "7", "@", "@", "public", "MethodConstraintMappingContext", "method", "(", "String", "name", ",", "Class", "<", "?>", "..", ".", "parameterT", "return", "typeContext", ".", "method", "(", "name", ",", "parameterTypes", ")", ";", "}", "public", "ConstrainedElement", "build", "(", "ConstraintHelper", "constraintHelper", ")", "{", "ConstrainedElement", "build", "(", "ConstraintHelper", "constraintHelper", ")", "{", "if", "(", "member", "instanceof", "Field", ")", "{", "return", "new", "ConstrainedField", "(", "ConfigurationSource", ".", "API", ",", "@", "@", "-", "31", ",", "13", "+", "31", ",", "13", "@", "@", "*", "@", "author", "Gunnar", "Morling", "*", "@", "author", "Kevin", "Pollet", "&", "lt", ";", "kevin", ".", "pollet", "@", "serli", ".", "com", "&", "gt", ";", "(", "C", ")", "2011", "SERLI", "*", "/", "public", "final", "class", "ReturnValueConstraintMappingContextImpl", "final", "class", "ReturnValueConstraintMappingContextImpl", "extends", "CascadableConstraintMappingContextImplBase", "<", "ReturnValueConstraintMappingContext", ">", "implements", "ReturnValueConstraintMappingContext", "{", "private", "final", "ExecutableConstraintMappingContextImpl", "executableContext", ";", "public", "ReturnValueConstraintMappingContextImpl", "(", "ExecutableConstraintMappingContextImpl", "executableContext", ")", "{", "ReturnValueConstraintMappingContextImpl", "(", "ExecutableConstraintMappingContextImpl", "executableContext", ")", "{", "super", "(", "executableContext", ".", "getTypeContext", "(", ").", "getConstraintMapping", "(", ")", ")", ";", "this", ".", "executableContext", "=", "executableContext", ";", "}", "@", "@", "-", "33", ",", "7", "+", "33", ",", "6", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "context", ".", "MethodConstraintMappingContext", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "context", ".", "PropertyConstraintMappingContext", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "context", ".", "TypeConstraintMappingContext", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "cfg", ".", "DefaultConstraintMapping", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "core", ".", "ConstraintHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "descriptor", ".", "ConstraintDescriptorImpl", ".", "ConstraintType", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "location", ".", "ConstraintLocation", ";", "@", "@", "-", "80", ",", "7", "+", "79", ",", "7", "@", "@", "private", "List", "<", "Class", "<", "?>", ">", "defaultGroupSequence", ";", "private", "Class", "<", "?", "extends", "DefaultGroupSequenceProvider", "<", "?", "super", "C", ">", ">", "defaultGroupSequenceProviderClass", ";", "public", "TypeConstraintMappingContextImpl", "(", "DefaultConstraintMapping", "mapping", ",", "Class", "<", "C", ">", "beanClass", ")", "{", "TypeConstraintMappingContextImpl", "(", "DefaultConstraintMapping", "mapping", ",", "Class", "<", "C", ">", "beanClass", ")", "{", "super", "(", "mapping", ")", ";", "this", ".", "beanClass", "=", "beanClass", ";", "mapping", ".", "getAnnotationProcessingOptions", "(", ").", "ignoreAnnotationConstraintForClass", "(", "beanClass", ",", "Boolean", ".", "FALSE", ")", ";", "@", "@", "-", "199", ",", "7", "+", "198", ",", "7", "@", "@", "public", "ConstructorConstraintMappingContext", "constructor", "(", "Class", "<", "?>", "..", ".", "parameterType", "return", "context", ";", "}", "public", "BeanConfiguration", "<", "C", ">", "build", "(", "ConstraintHelper", "constraintHelper", ",", "ParameterNameProvider", "parameterNameProvider", ")", "{", "BeanConfiguration", "<", "C", ">", "build", "(", "ConstraintHelper", "constraintHelper", ",", "ParameterNameProvider", "parameterNameProvider", ")", "{", "return", "new", "BeanConfiguration", "<", "C", ">", "(", "ConfigurationSource", ".", "API", ",", "beanClass", ",", "@", "@", "-", "243", ",", "7", "+", "242", ",", "7", "@", "@", "public", "ConstructorConstraintMappingContext", "constructor", "(", "Class", "<", "?>", "..", ".", "parameterType", ")", ":", "null", ";", "}", "public", "Class", "<", "?>", "getBeanClass", "(", ")", "{", "Class", "<", "?>", "getBeanClass", "(", ")", "{", "return", "beanClass", ";", "}", "@", "@", "-", "39", ",", "7", "+", "39", ",", "7", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "HibernateValidatorConfiguration", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "ConstraintMapping", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "cfg", ".", "DefaultConstraintMapping", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "cfg", ".", "context", ".", "DefaultConstraintMapping", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "engine", ".", "constraintvalidation", ".", "ConstraintValidatorFactoryImpl", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "engine", ".", "resolver", ".", "DefaultTraversableResolver", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "engine", ".", "valuehandling", ".", "JavaFXPropertyValueUnwrapper", ";", "@", "@", "-", "34", ",", "7", "+", "34", ",", "7", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "HibernateValidatorConfiguration", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "HibernateValidatorContext", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "HibernateValidatorFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "cfg", ".", "DefaultConstraintMapping", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "cfg", ".", "context", ".", "DefaultConstraintMapping", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "engine", ".", "constraintvalidation", ".", "ConstraintValidatorManager", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "BeanMetaDataManager", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "core", ".", "ConstraintHelper", ";", "@", "@", "-", "17", ",", "9", "+", "17", ",", "10", "@", "@", "package", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "provider", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "javax", ".", "validation", ".", "ParameterNameProvider", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "cfg", ".", "DefaultConstraintMapping", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "cfg", ".", "context", ".", "DefaultConstraintMapping", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "core", ".", "AnnotationProcessingOptions", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "core", ".", "AnnotationProcessingOptionsImpl", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "core", ".", "ConstraintHelper", ";", "@", "@", "-", "56", ",", "7", "+", "56", ",", "7", "@", "@", "*", "@", "author", "Gunnar", "Morling", "*", "@", "see", "java", ".", "lang", ".", "annotation", ".", "Annotation", "*", "/", "public", "class", "AnnotationProxy", "implements", "Annotation", ",", "InvocationHandler", ",", "Serializable", "{", "class", "AnnotationProxy", "implements", "Annotation", ",", "InvocationHandler", ",", "Serializable", "{", "private", "static", "final", "long", "serialVersionUID", "=", "6907601010599429454L", ";", "private", "static", "final", "Log", "log", "=", "LoggerFactory", ".", "make", "(", ");", "@", "@", "-", "65", ",", "7", "+", "65", ",", "7", "@", "@", "private", "final", "Map", "<", "String", ",", "Object", ">", "values", ";", "private", "final", "int", "hashCode", ";", "public", "AnnotationProxy", "(", "AnnotationDescriptor", "<", "?>", "descriptor", ")", "{", "AnnotationProxy", "(", "AnnotationDescriptor", "<", "?>", "descriptor", ")", "{", "this", ".", "annotationType", "=", "descriptor", ".", "type", "(", ");", "values", "=", "Collections", ".", "unmodifiableMap", "(", "getAnnotationValues", "(", "descriptor", ")", ")", ";", "this", ".", "hashCode", "=", "calculateHashCode", "(", ");", "@", "@", "-", "51", ",", "14", "+", "51", ",", "14", "@", "@", "*", "*", "@", "author", "Hardy", "Ferentschik", "*", "/", "public", "class", "ConstrainedExecutableBuilder", "{", "class", "ConstrainedExecutableBuilder", "{", "private", "static", "final", "Log", "log", "=", "LoggerFactory", ".", "make", "(", ");", "private", "ConstrainedExecutableBuilder", "(", ")", "{", "}", "public", "static", "Set", "<", "ConstrainedExecutable", ">", "buildMethodConstrainedExecutable", "(", "List", "<", "MethodType", ">", "methods", ",", "static", "Set", "<", "ConstrainedExecutable", ">", "buildMethodConstrainedExecutable", "(", "List", "<", "MethodType", ">", "methods", ",", "Class", "<", "?>", "beanClass", ",", "String", "defaultPackage", ",", "ParameterNameProvider", "parameterNameProvider", ",", "@", "@", "-", "125", ",", "7", "+", "125", ",", "7", "@", "@", "private", "ConstrainedExecutableBuilder", "(", ")", "{", "return", "constrainedExecutables", ";", "}", "public", "static", "Set", "<", "ConstrainedExecutable", ">", "buildConstructorConstrainedExecutable", "(", "List", "<", "ConstructorType", ">", "constructors", ",", "static", "Set", "<", "ConstrainedExecutable", ">", "buildConstructorConstrainedExecutable", "(", "List", "<", "ConstructorType", ">", "constructors", ",", "Class", "<", "?>", "beanClass", ",", "String", "defaultPackage", ",", "ParameterNameProvider", "parameterNameProvider", ",", "@", "@", "-", "41", ",", "13", "+", "41", ",", "13", "@", "@", "*", "*", "@", "author", "Hardy", "Ferentschik", "*", "/", "public", "class", "ConstrainedFieldBuilder", "{", "class", "ConstrainedFieldBuilder", "{", "private", "static", "final", "Log", "log", "=", "LoggerFactory", ".", "make", "(", ");", "private", "ConstrainedFieldBuilder", "(", ")", "{", "}", "public", "static", "Set", "<", "ConstrainedField", ">", "buildConstrainedFields", "(", "List", "<", "FieldType", ">", "fields", ",", "static", "Set", "<", "ConstrainedField", ">", "buildConstrainedFields", "(", "List", "<", "FieldType", ">", "fields", ",", "Class", "<", "?>", "beanClass", ",", "String", "defaultPackage", ",", "ConstraintHelper", "constraintHelper", ",", "@", "@", "-", "43", ",", "13", "+", "43", ",", "13", "@", "@", "*", "*", "@", "author", "Hardy", "Ferentschik", "*", "/", "public", "class", "ConstrainedGetterBuilder", "{", "class", "ConstrainedGetterBuilder", "{", "private", "static", "final", "Log", "log", "=", "LoggerFactory", ".", "make", "(", ");", "private", "ConstrainedGetterBuilder", "(", ")", "{", "}", "public", "static", "Set", "<", "ConstrainedExecutable", ">", "buildConstrainedGetters", "(", "List", "<", "GetterType", ">", "getterList", ",", "static", "Set", "<", "ConstrainedExecutable", ">", "buildConstrainedGetters", "(", "List", "<", "GetterType", ">", "getterList", ",", "Class", "<", "?>", "beanClass", ",", "String", "defaultPackage", ",", "ConstraintHelper", "constraintHelper", ",", "@", "@", "-", "40", ",", "12", "+", "40", ",", "12", "@", "@", "*", "*", "@", "author", "Hardy", "Ferentschik", "*", "/", "public", "class", "ConstrainedParameterBuilder", "{", "class", "ConstrainedParameterBuilder", "{", "private", "ConstrainedParameterBuilder", "(", ")", "{", "}", "public", "static", "List", "<", "ConstrainedParameter", ">", "buildConstrainedParameters", "(", "List", "<", "ParameterType", ">", "parameterList", ",", "static", "List", "<", "ConstrainedParameter", ">", "buildConstrainedParameters", "(", "List", "<", "ParameterType", ">", "parameterList", ",", "ExecutableElement", "executableElement", ",", "String", "defaultPackage", ",", "ConstraintHelper", "constraintHelper", ",", "@", "@", "-", "35", ",", "12", "+", "35", ",", "12", "@", "@", "*", "*", "@", "author", "Hardy", "Ferentschik", "*", "/", "public", "class", "ConstrainedTypeBuilder", "{", "class", "ConstrainedTypeBuilder", "{", "private", "ConstrainedTypeBuilder", "(", ")", "{", "}", "public", "static", "ConstrainedType", "buildConstrainedType", "(", "ClassType", "classType", ",", "static", "ConstrainedType", "buildConstrainedType", "(", "ClassType", "classType", ",", "Class", "<", "?>", "beanClass", ",", "String", "defaultPackage", ",", "ConstraintHelper", "constraintHelper", ",", "@", "@", "-", "26", ",", "12", "+", "26", ",", "12", "@", "@", "*", "*", "@", "author", "Hardy", "Ferentschik", "*", "/", "public", "class", "GroupConversionBuilder", "{", "class", "GroupConversionBuilder", "{", "private", "GroupConversionBuilder", "(", ")", "{", "}", "public", "static", "Map", "<", "Class", "<", "?>", ",", "Class", "<", "?>", ">", "buildGroupConversionMap", "(", "List", "<", "GroupConversionType", ">", "groupConversionTypes", ",", "static", "Map", "<", "Class", "<", "?>", ",", "Class", "<", "?>", ">", "buildGroupConversionMap", "(", "List", "<", "GroupConversionType", ">", "groupConversionTypes", ",", "String", "defaultPackage", ")", "{", "Map", "<", "Class", "<", "?>", ",", "Class", "<", "?>", ">", "groupConversionMap", "=", "newHashMap", "(", ");", "for", "(", "GroupConversionType", "groupConversionType", ":", "groupConversionTypes", ")", "{", "@", "@", "-", "45", ",", "7", "+", "45", ",", "7", "@", "@", "*", "*", "@", "author", "Hardy", "Ferentschik", "*", "/", "public", "class", "MetaConstraintBuilder", "{", "class", "MetaConstraintBuilder", "{", "private", "static", "final", "Log", "log", "=", "LoggerFactory", ".", "make", "(", ");", "private", "static", "final", "String", "MESSAGE_PARAM", "=", "\"", "message", "\"", ";", "@", "@", "-", "56", ",", "7", "+", "56", ",", "7", "@", "@", "private", "MetaConstraintBuilder", "(", ")", "{", "}", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "public", "static", "<", "A", "extends", "Annotation", ">", "MetaConstraint", "<", "A", ">", "buildMetaConstraint", "(", "ConstraintLocation", "constraintLocation", ",", "static", "<", "A", "extends", "Annotation", ">", "MetaConstraint", "<", "A", ">", "buildMetaConstraint", "(", "ConstraintLocation", "constraintLocation", ",", "ConstraintType", "constraint", ",", "java", ".", "lang", ".", "annotation", ".", "ElementType", "type", ",", "String", "defaultPackage", ",", "@", "@", "-", "14", ",", "7", "+", "14", ",", "7", "@", "@", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ";", "package", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "xml", ";", "import", "java", ".", "io", ".", "BufferedInputStream", ";", "import", "java", ".", "io", ".", "InputStream", ";", "@", "@", "-", "30", ",", "7", "+", "30", ",", "7", "@", "@", "*", "*", "@", "author", "Hardy", "Ferentschik", "*", "/", "public", "final", "class", "ResourceLoaderHelper", "{", "final", "class", "ResourceLoaderHelper", "{", "private", "static", "final", "Log", "log", "=", "LoggerFactory", ".", "make", "(", ");", "/", "**", "@", "@", "-", "44", ",", "7", "+", "44", ",", "7", "@", "@", "*", "*", "@", "see", "InputStream", "#", "markSupported", "(", ")", "*", "/", "public", "static", "InputStream", "getResettableInputStreamForPath", "(", "String", "path", ")", "{", "static", "InputStream", "getResettableInputStreamForPath", "(", "String", "path", ")", "{", "/", "/", "TODO", "not", "sure", "if", "it", "'", "s", "the", "right", "thing", "to", "removing", "'", "/'", "String", "inputPath", "=", "path", ";", "if", "(", "inputPath", ".", "startsWith", "(", "\"", "/\"", ")", ")", "{", "@", "@", "-", "32", ",", "7", "+", "32", ",", "6", "@", "@", "import", "javax", ".", "validation", ".", "ValidationException", ";", "import", "javax", ".", "validation", ".", "spi", ".", "ValidationProvider", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ResourceLoaderHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "LoadClass", ";", "@", "@", "-", "35", ",", "7", "+", "35", ",", "6", "@", "@", "import", "javax", ".", "xml", ".", "transform", ".", "stream", ".", "StreamSource", ";", "import", "javax", ".", "xml", ".", "validation", ".", "Schema", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "ResourceLoaderHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "logging", ".", "LoggerFactory", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "util", ".", "privilegedactions", ".", "NewJaxbContext", ";", "@", "@", "-", "146", ",", "7", "+", "146", ",", "7", "@", "@", "private", "synchronized", "XMLEventReader", "createXmlEventReader", "(", "InputStream", "xmlStream", ")", "*", "@", "return", "the", "schema", "identified", "by", "the", "given", "resource", "name", "or", "{", "@", "code", "null", "}", "if", "the", "resource", "was", "not", "found", "or", "could", "*", "not", "be", "loaded", ".", "*", "/", "public", "Schema", "getSchema", "(", "String", "schemaResource", ")", "{", "Schema", "getSchema", "(", "String", "schemaResource", ")", "{", "Schema", "schema", "=", "schemaCache", ".", "get", "(", "schemaResource", ")", ";", "if", "(", "schema", "!", "=", "null", ")", "{", "@", "@", "-", "35", ",", "7", "+", "35", ",", "7", "@", "@", "*", "/", "public", "class", "PlatformResourceBundleLocator", "implements", "ResourceBundleLocator", "{", "private", "static", "final", "Logger", "log", "=", "Logger", ".", "getLogger", "(", "PlatformResourceBundleLocator", ".", "class", ".", "getName", "(", ")", ")", ";", "private", "String", "bundleName", ";", "private", "final", "String", "bundleName", ";", "public", "PlatformResourceBundleLocator", "(", "String", "bundleName", ")", "{", "this", ".", "bundleName", "=", "bundleName", ";", "@", "@", "-", "49", ",", "6", "+", "49", ",", "7", "@", "@", "public", "PlatformResourceBundleLocator", "(", "String", "bundleName", ")", "{", "*", "*", "@", "return", "the", "resource", "bundle", "or", "<", "code", ">", "null", "<", "/", "code", ">", "if", "none", "is", "found", ".", "*", "/", "@", "Override", "public", "ResourceBundle", "getResourceBundle", "(", "Locale", "locale", ")", "{", "ResourceBundle", "rb", "=", "null", ";", "ClassLoader", "classLoader", "=", "GetClassLoader", ".", "fromContext", "(", ");", "@", "@", "-", "91", ",", "7", "+", "92", ",", "7", "@", "@", "private", "ResourceBundle", "loadBundle", "(", "ClassLoader", "classLoader", ",", "Locale", "locale", ",", "String", "private", "static", "class", "GetClassLoader", "implements", "PrivilegedAction", "<", "ClassLoader", ">", "{", "private", "final", "Class", "<", "?>", "clazz", ";", "public", "static", "ClassLoader", "fromContext", "(", ")", "{", "private", "static", "ClassLoader", "fromContext", "(", ")", "{", "final", "GetClassLoader", "action", "=", "new", "GetClassLoader", "(", "null", ")", ";", "if", "(", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", ")", "{", "return", "AccessController", ".", "doPrivileged", "(", "action", ")", ";", "@", "@", "-", "101", ",", "7", "+", "102", ",", "7", "@", "@", "public", "static", "ClassLoader", "fromContext", "(", ")", "{", "}", "}", "public", "static", "ClassLoader", "fromClass", "(", "Class", "<", "?>", "clazz", ")", "{", "private", "static", "ClassLoader", "fromClass", "(", "Class", "<", "?>", "clazz", ")", "{", "if", "(", "clazz", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "Class", "is", "null", "\"", ")", ";", "}", "@", "@", "-", "118", ",", "6", "+", "119", ",", "7", "@", "@", "private", "GetClassLoader", "(", "Class", "<", "?>", "clazz", ")", "{", "this", ".", "clazz", "=", "clazz", ";", "}", "@", "Override", "public", "ClassLoader", "run", "(", ")", "{", "if", "(", "clazz", "!", "=", "null", ")", "{", "return", "clazz", ".", "getClassLoader", "(", ");", "@", "@", "-", "22", ",", "6", "+", "22", ",", "7", "@", "@", "import", "java", ".", "util", ".", "GregorianCalendar", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "javax", ".", "validation", ".", "ConstraintViolation", ";", "import", "javax", ".", "validation", ".", "GroupDefinitionException", ";", "import", "javax", ".", "validation", ".", "GroupSequence", ";", "@", "@", "-", "35", ",", "7", "+", "36", ",", "6", "@", "@", "import", "org", ".", "testng", ".", "annotations", ".", "BeforeMethod", ";", "import", "org", ".", "testng", ".", "annotations", ".", "Test", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "HibernateValidator", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "HibernateValidatorConfiguration", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "ConstraintMapping", ";", "@", "@", "-", "48", ",", "7", "+", "48", ",", "7", "@", "@", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "defs", ".", "RangeDef", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "cfg", ".", "defs", ".", "SizeDef", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "group", ".", "GroupSequenceProvider", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "cfg", ".", "DefaultConstraintMapping", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "cfg", ".", "context", ".", "DefaultConstraintMapping", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "engine", ".", "DefaultParameterNameProvider", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "core", ".", "ConstraintHelper", ";", "import", "org", ".", "hibernate", ".", "validator", ".", "internal", ".", "metadata", ".", "raw", ".", "BeanConfiguration", ";"], "docstring_tokens": ["via", "a", "crafted", "application", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "47", ",", "10", "+", "47", ",", "10", "@", "@", "private", "static", "final", "long", "serialVersionUID", "=", "-", "4861942486845757891L", ";", "private", "static", "Pattern", "ALLOWABLE_PAGE_SEPARATORS_PATTERN", "=", "Pattern", ".", "compile", "(", "\"(", "?", "i", ")", "^[", "-", "_", "<", ">", "A", "-", "Z0", "-", "9", "\\", "n", "\\", "r", "]", "+$", "\")", ";", "Pattern", ".", "compile", "(", "\"(", "?", "i", ")", "^[", "-", "_", "/", "\\\\", ".", "A", "-", "Z0", "-", "9", "]", "+$", "\")", ";", "private", "static", "Pattern", "ALLOWABLE_OTHER_PARAMS_PATTERN", "=", "Pattern", ".", "compile", "(", "\"(", "?", "i", ")", "^[", "-/", "_", "<", ">", "A", "-", "Z0", "-", "9", "]", "+$", "\")", ";", "Pattern", ".", "compile", "(", "\"(", "?", "i", ")", "^[", "-", "_", "/", "\\\\", ".", "A", "-", "Z0", "-", "9", "]", "+$", "\")", ";", "public", "enum", "OUTPUT_TYPE", "{", "TXT", ",", "@", "@", "-", "283", ",", "7", "+", "283", ",", "7", "@", "@", "public", "void", "setPageSeparator", "(", "String", "pageSeparator", ")", "{", "throw", "new", "IllegalArgumentException", "(", "pageSeparator", "+", "\"", "contains", "illegal", "characters", ".", "\\", "n", "\"", "+", "\"", "If", "you", "trust", "this", "value", ",", "set", "it", "with", "setTrustedPageSeparator", "\"", ");", "}", "this", ".", "pageSeparator", "=", "pageSeparator", ";", "setTrustedPageSeparator", "(", "pageSeparator", ")", ";", "}", "/", "**", "@", "@", "-", "456", ",", "11", "+", "456", ",", "13", "@", "@", "public", "String", "getColorspace", "(", ")", "{", "*", "Deafult", "value", "is", "gray", ".", "*", "/", "public", "void", "setColorspace", "(", "String", "colorspace", ")", "{", "if", "(", "!", "colorspace", ".", "equals", "(", "null", ")", ")", "{", "this", ".", "colorspace", "=", "colorspace", ";", "}", "else", "{", "if", "(", "colorspace", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "Colorspace", "value", "cannot", "be", "null", ".", "\")", ";", "}", "if", "(", "!", "colorspace", ".", "matches", "(", "\"(", "?", "i", ")", "^[", "-", "_A", "-", "Z0", "-", "9", "]", "+$", "\")", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "colorspace", "must", "match", "this", "pattern", ":", "(", "?", "i", ")", "^[", "-", "_A", "-", "Z0", "-", "9", "]", "+$", "\")", ";", "}", "this", ".", "colorspace", "=", "colorspace", ";", "}", "/", "**", "@", "@", "-", "575", ",", "7", "+", "577", ",", "7", "@", "@", "public", "void", "addOtherTesseractConfig", "(", "String", "key", ",", "String", "value", ")", "{", "Matcher", "m", "=", "ALLOWABLE_OTHER_PARAMS_PATTERN", ".", "matcher", "(", "key", ")", ";", "if", "(", "!", "m", ".", "find", "(", "))", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "Value", "contains", "illegal", "characters", ":", "\"", "+", "key", ")", ";", "throw", "new", "IllegalArgumentException", "(", "\"", "Key", "contains", "illegal", "characters", ":", "\"", "+", "key", ")", ";", "}", "m", ".", "reset", "(", "value", ")", ";", "if", "(", "!", "m", ".", "find", "(", "))", "{", "@", "@", "-", "216", ",", "10", "+", "216", ",", "15", "@", "@", "public", "void", "testGoodOtherParameters", "(", ")", "{", "@", "Test", "public", "void", "testBogusPathCheck", "(", ")", "{", "/", "/", "allow", "path", "that", "doesn", "'", "t", "actually", "exist", "TesseractOCRConfig", "config", "=", "new", "TesseractOCRConfig", "(", ");", "config", ".", "setTesseractPath", "(", "\"", "blahdeblahblah", "\"", ");", "assertEquals", "(", "\"", "blahdeblahblah", "\"", ",", "config", ".", "getTesseractPath", "(", "))", ";", "}", "@", "Test", "(", "expected", "=", "IllegalArgumentException", ".", "class", ")", "public", "void", "testBadColorSpace", "(", ")", "{", "TesseractOCRConfig", "config", "=", "new", "TesseractOCRConfig", "(", ");", "config", ".", "setColorspace", "(", "\"", "someth", "!", "ng", "\"", ");", "}", "}", "@", "@", "-", "85", ",", "7", "+", "85", ",", "7", "@", "@", "@", "Path", "(", "\"/", "tika", "\"", ")", "public", "class", "TikaResource", "{", "private", "static", "Pattern", "ALLOWABLE_HEADER_CHARS", "=", "Pattern", ".", "compile", "(", "\"(", "?", "i", ")", "^[", "-", "_", "<", ">", "A", "-", "Z0", "-", "9", "]", "+$", "\")", ";", "private", "static", "Pattern", "ALLOWABLE_HEADER_CHARS", "=", "Pattern", ".", "compile", "(", "\"(", "?", "i", ")", "^[", "-/", "_", "\\", "\\.", "A", "-", "Z0", "-", "9", "]", "+$", "\")", ";", "public", "static", "final", "String", "GREETING", "=", "\"", "This", "is", "Tika", "Server", "(", "\"", "+", "new", "Tika", "(", ").", "toString", "(", ")", "+", "\"", ").", "Please", "PUT", "\\", "n", "\"", ";", "public", "static", "final", "String", "X_TIKA_OCR_HEADER_PREFIX", "=", "\"", "X", "-", "Tika", "-", "OCR", "\"", ";", "@", "@", "-", "196", ",", "11", "+", "196", ",", "10", "@", "@", "public", "static", "InputStream", "getInputStream", "(", "InputStream", "is", ",", "HttpHeaders", "headers", ")", "{", "*", "/", "private", "static", "void", "processHeaderConfig", "(", "MultivaluedMap", "<", "String", ",", "String", ">", "httpHeaders", ",", "Object", "object", ",", "String", "key", ",", "String", "prefix", ")", "{", "try", "{", "String", "property", "=", "StringUtils", ".", "removeStart", "(", "key", ",", "prefix", ")", ";", "try", "{", "String", "property", "=", "StringUtils", ".", "removeStart", "(", "key", ",", "prefix", ")", ";", "Field", "field", "=", "null", ";", "try", "{", "object", ".", "getClass", "(", ").", "getDeclaredField", "(", "StringUtils", ".", "uncapitalize", "(", "property", ")", ");", "field", "=", "object", ".", "getClass", "(", ").", "getDeclaredField", "(", "StringUtils", ".", "uncapitalize", "(", "property", ")", ");", "}", "catch", "(", "NoSuchFieldException", "e", ")", "{", "/", "/", "swallow", "}", "@", "@", "-", "211", ",", "12", "+", "210", ",", "20", "@", "@", "private", "static", "void", "processHeaderConfig", "(", "MultivaluedMap", "<", "String", ",", "String", ">", "httpHeade", "/", "/", "try", "that", ".", "Class", "clazz", "=", "String", ".", "class", ";", "if", "(", "field", "!", "=", "null", ")", "{", "if", "(", "field", ".", "getType", "(", ")", "=", "=", "int", ".", "class", ")", "{", "if", "(", "field", ".", "getType", "(", ")", "=", "=", "int", ".", "class", "|", "|", "field", ".", "getType", "(", ")", "=", "=", "Integer", ".", "class", ")", "{", "clazz", "=", "int", ".", "class", ";", "}", "else", "if", "(", "field", ".", "getType", "(", ")", "=", "=", "double", ".", "class", ")", "{", "clazz", "=", "double", ".", "class", ";", "}", "else", "if", "(", "field", ".", "getType", "(", ")", "=", "=", "Double", ".", "class", ")", "{", "clazz", "=", "Double", ".", "class", ";", "}", "else", "if", "(", "field", ".", "getType", "(", ")", "=", "=", "float", ".", "class", ")", "{", "clazz", "=", "float", ".", "class", ";", "}", "else", "if", "(", "field", ".", "getType", "(", ")", "=", "=", "Float", ".", "class", ")", "{", "clazz", "=", "Float", ".", "class", ";", "}", "else", "if", "(", "field", ".", "getType", "(", ")", "=", "=", "boolean", ".", "class", ")", "{", "clazz", "=", "boolean", ".", "class", ";", "}", "else", "if", "(", "field", ".", "getType", "(", ")", "=", "=", "Boolean", ".", "class", ")", "{", "clazz", "=", "Boolean", ".", "class", ";", "}", "}", "@", "@", "-", "233", ",", "14", "+", "240", ",", "16", "@", "@", "private", "static", "void", "processHeaderConfig", "(", "MultivaluedMap", "<", "String", ",", "String", ">", "httpHeade", "if", "(", "clazz", "=", "=", "String", ".", "class", ")", "{", "checkTrustWorthy", "(", "setter", ",", "val", ")", ";", "m", ".", "invoke", "(", "object", ",", "val", ")", ";", "}", "else", "if", "(", "clazz", "=", "=", "int", ".", "class", ")", "{", "}", "else", "if", "(", "clazz", "=", "=", "int", ".", "class", "|", "|", "clazz", "=", "=", "Integer", ".", "class", ")", "{", "m", ".", "invoke", "(", "object", ",", "Integer", ".", "parseInt", "(", "val", ")", ");", "}", "else", "if", "(", "clazz", "=", "=", "double", ".", "class", ")", "{", "}", "else", "if", "(", "clazz", "=", "=", "double", ".", "class", "|", "|", "clazz", "=", "=", "Double", ".", "class", ")", "{", "m", ".", "invoke", "(", "object", ",", "Double", ".", "parseDouble", "(", "val", ")", ");", "}", "else", "if", "(", "clazz", "=", "=", "boolean", ".", "class", ")", "{", "}", "else", "if", "(", "clazz", "=", "=", "boolean", ".", "class", "|", "|", "clazz", "=", "=", "Boolean", ".", "class", ")", "{", "m", ".", "invoke", "(", "object", ",", "Boolean", ".", "parseBoolean", "(", "val", ")", ");", "}", "else", "if", "(", "clazz", "=", "=", "float", ".", "class", "|", "|", "clazz", "=", "=", "Float", ".", "class", ")", "{", "m", ".", "invoke", "(", "object", ",", "Float", ".", "parseFloat", "(", "val", ")", ");", "}", "else", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "setter", "must", "be", "String", ",", "int", ",", "double", "or", "boolean", ".", "..", "for", "now", "\"", ");", "throw", "new", "IllegalArgumentException", "(", "\"", "setter", "must", "be", "String", ",", "int", ",", "float", ",", "double", "or", "boolean", ".", "..", "for", "now", "\"", ");", "}", "}", "else", "{", "throw", "new", "NoSuchMethodException", "(", "\"", "Couldn", "'", "t", "find", ":", "\"", "+", "setter", ")", ";", "@", "@", "-", "17", ",", "15", "+", "17", ",", "6", "@", "@", "package", "org", ".", "apache", ".", "tika", ".", "server", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertFalse", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Response", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "apache", ".", "cxf", ".", "jaxrs", ".", "JAXRSServerFactoryBean", ";", "import", "org", ".", "apache", ".", "cxf", ".", "jaxrs", ".", "client", ".", "WebClient", ";", "import", "org", ".", "apache", ".", "cxf", ".", "jaxrs", ".", "ext", ".", "multipart", ".", "Attachment", ";", "@", "@", "-", "35", ",", "6", "+", "26", ",", "15", "@", "@", "import", "org", ".", "apache", ".", "tika", ".", "server", ".", "resource", ".", "TikaResource", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Response", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "List", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertFalse", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "public", "class", "TikaResourceTest", "extends", "CXFTestBase", "{", "public", "static", "final", "String", "TEST_DOC", "=", "\"", "test", ".", "doc", "\"", ";", "public", "static", "final", "String", "TEST_PASSWORD_PROTECTED", "=", "\"", "password", ".", "xls", "\"", ";", "@", "@", "-", "304", ",", "14", "+", "304", ",", "27", "@", "@", "public", "void", "testDataIntegrityCheck", "(", ")", "throws", "Exception", "{", "@", "Test", "public", "void", "testTrustedMethodPrevention", "(", ")", "{", "Response", "response", "=", "WebClient", ".", "create", "(", "endPoint", "+", "TIKA_PATH", ")", ".", "type", "(", "\"", "application", "/", "pdf", "\"", ")", ".", "accept", "(", "\"", "text", "/", "plain", "\"", ")", ".", "header", "(", "TikaResource", ".", "X_TIKA_OCR_HEADER_PREFIX", "+", "\"", "trustedPageSeparator", "\"", ",", "\"", "\\", "u0010", "\"", ")", ".", "put", "(", "ClassLoader", ".", "getSystemResourceAsStream", "(", "\"", "testOCR", ".", "pdf", "\"", "))", ";", "assertEquals", "(", "500", ",", "response", ".", "getStatus", "(", "))", ";", "Response", "response", "=", "WebClient", ".", "create", "(", "endPoint", "+", "TIKA_PATH", ")", ".", "type", "(", "\"", "application", "/", "pdf", "\"", ")", ".", "accept", "(", "\"", "text", "/", "plain", "\"", ")", ".", "header", "(", "TikaResource", ".", "X_TIKA_OCR_HEADER_PREFIX", "\"", "trustedPageSeparator", "\"", ",", "\"", "\\", "u0010", "\"", ")", ".", "put", "(", "ClassLoader", ".", "getSystemResourceAsStream", "(", "\"", "testOCR", ".", "pdf", "\"", "))", ";", "assertEquals", "(", "500", ",", "response", ".", "getStatus", "(", "))", ";", "}", "}", "@", "Test", "public", "void", "testFloatInHeader", "(", ")", "{", "Response", "response", "=", "WebClient", ".", "create", "(", "endPoint", "+", "TIKA_PATH", ")", ".", "type", "(", "\"", "application", "/", "pdf", "\"", ")", ".", "accept", "(", "\"", "text", "/", "plain", "\"", ")", ".", "header", "(", "TikaResource", ".", "X_TIKA_PDF_HEADER_PREFIX", "\"", "averageCharTolerance", "\"", ",", "\"", "2", ".", "0", "\"", ")", ".", "put", "(", "ClassLoader", ".", "getSystemResourceAsStream", "(", "\"", "testOCR", ".", "pdf", "\"", "))", ";", "assertEquals", "(", "200", ",", "response", ".", "getStatus", "(", "))", ";", "}", "}"], "docstring_tokens": ["sending", "specially", "crafted", "headers"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1373", ",", "15", "+", "1373", ",", "12", "@", "@", "fb_mmap", "(", "struct", "file", "*", "file", ",", "struct", "vm_area_struct", "*", "vma", ")", "{", "struct", "fb_info", "*", "info", "=", "file_fb_info", "(", "file", ")", ";", "struct", "fb_ops", "*", "fb", ";", "unsigned", "long", "off", ";", "unsigned", "long", "mmio_pgoff", ";", "unsigned", "long", "start", ";", "u32", "len", ";", "if", "(", "!", "info", ")", "return", "-", "ENODEV", ";", "if", "(", "vma", "-", ">", "vm_pgoff", ">", "(", "~", "0UL", ">", ">", "PAGE_SHIFT", ")", ")", "return", "-", "EINVAL", ";", "off", "=", "vma", "-", ">", "vm_pgoff", "<", "<", "PAGE_SHIFT", ";", "fb", "=", "info", "-", ">", "fbops", ";", "if", "(", "!", "fb", ")", "return", "-", "ENODEV", ";", "@", "@", "-", "1393", ",", "32", "+", "1390", ",", "24", "@", "@", "fb_mmap", "(", "struct", "file", "*", "file", ",", "struct", "vm_area_struct", "*", "vma", ")", "return", "res", ";", "}", "/", "*", "frame", "buffer", "memory", "*", "/", "/", "*", "*", "Ugh", ".", "This", "can", "be", "either", "the", "frame", "buffer", "mapping", ",", "or", "*", "if", "pgoff", "points", "past", "it", ",", "the", "mmio", "mapping", ".", "*", "/", "start", "=", "info", "-", ">", "fix", ".", "smem_start", ";", "len", "=", "PAGE_ALIGN", "(", "(", "start", "&", "~", "PAGE_MASK", ")", "+", "info", "-", ">", "fix", ".", "smem_len", ")", ";", "if", "(", "off", ">", "=", "len", ")", "{", "/", "*", "memory", "mapped", "io", "*", "/", "off", "-", "=", "len", ";", "if", "(", "info", "-", ">", "var", ".", "accel_flags", ")", "{", "mutex_unlock", "(", "&", "info", "-", ">", "mm_lock", ")", ";", "return", "-", "EINVAL", ";", "}", "len", "=", "info", "-", ">", "fix", ".", "smem_len", ";", "mmio_pgoff", "=", "PAGE_ALIGN", "(", "(", "start", "&", "~", "PAGE_MASK", ")", "+", "len", ")", ">", ">", "PAGE_SHIFT", ";", "if", "(", "vma", "-", ">", "vm_pgoff", ">", "=", "mmio_pgoff", ")", "{", "vma", "-", ">", "vm_pgoff", "-", "=", "mmio_pgoff", ";", "start", "=", "info", "-", ">", "fix", ".", "mmio_start", ";", "len", "=", "PAGE_ALIGN", "(", "(", "start", "&", "~", "PAGE_MASK", ")", "+", "info", "-", ">", "fix", ".", "mmio_len", ")", ";", "len", "=", "info", "-", ">", "fix", ".", "mmio_len", ";", "}", "mutex_unlock", "(", "&", "info", "-", ">", "mm_lock", ")", ";", "start", "&", "=", "PAGE_MASK", ";", "if", "(", "(", "vma", "-", ">", "vm_end", "-", "vma", "-", ">", "vm_start", "+", "off", ")", ">", "len", ")", "return", "-", "EINVAL", ";", "off", "+", "=", "start", ";", "vma", "-", ">", "vm_pgoff", "=", "off", ">", ">", "PAGE_SHIFT", ";", "/", "*", "VM_IO", "|", "VM_DONTEXPAND", "|", "VM_DONTDUMP", "are", "set", "by", "io_remap_pfn_range", "(", ")*", "/", "vma", "-", ">", "vm_page_prot", "=", "vm_get_page_prot", "(", "vma", "-", ">", "vm_flags", ")", ";", "fb_pgprotect", "(", "file", ",", "vma", ",", "off", ")", ";", "if", "(", "io_remap_pfn_range", "(", "vma", ",", "vma", "-", ">", "vm_start", ",", "off", ">", ">", "PAGE_SHIFT", ",", "vma", "-", ">", "vm_end", "-", "vma", "-", ">", "vm_start", ",", "vma", "-", ">", "vm_page_prot", ")", ")", "return", "-", "EAGAIN", ";", "return", "0", ";", "fb_pgprotect", "(", "file", ",", "vma", ",", "start", ")", ";", "return", "vm_iomap_memory", "(", "vma", ",", "start", ",", "len", ")", ";", "}", "static", "int"], "docstring_tokens": ["via", "crafted", "/dev/graphics/fb0", "mmap2", "system", "calls"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "500", ",", "7", "+", "500", ",", "7", "@", "@", "static", "int", "spl_dllist_object_count_elements", "(", "zval", "*", "object", ",", "long", "*", "count", "TSRMLS_DC", ")", "*", "count", "=", "spl_ptr_llist_count", "(", "intern", "-", ">", "llist", ")", ";", "return", "SUCCESS", ";", "}", "}", "/", "*", "}", "}}", "*", "/", "static", "HashTable", "*", "spl_dllist_object_get_debug_info", "(", "zval", "*", "obj", ",", "int", "*", "is_temp", "TSRMLS_DC", ")", "/", "*", "{", "{{", "{", "*", "/", "@", "@", "-", "571", ",", "7", "+", "571", ",", "7", "@", "@", "SPL_METHOD", "(", "SplDoublyLinkedList", ",", "push", ")", "spl_ptr_llist_push", "(", "intern", "-", ">", "llist", ",", "value", "TSRMLS_CC", ")", ";", "RETURN_TRUE", ";", "}", "}", "/", "*", "}", "}}", "*", "/", "/", "*", "{", "{{", "proto", "bool", "SplDoublyLinkedList", ":", ":", "unshift", "(", "mixed", "$", "value", ")", "U", "@", "@", "-", "614", ",", "7", "+", "614", ",", "7", "@", "@", "SPL_METHOD", "(", "SplDoublyLinkedList", ",", "pop", ")", "}", "RETURN_ZVAL", "(", "value", ",", "1", ",", "1", ")", ";", "}", "}", "/", "*", "}", "}}", "*", "/", "/", "*", "{", "{{", "proto", "mixed", "SplDoublyLinkedList", ":", ":", "shift", "(", ")", "U", "@", "@", "-", "637", ",", "7", "+", "637", ",", "7", "@", "@", "SPL_METHOD", "(", "SplDoublyLinkedList", ",", "shift", ")", "}", "RETURN_ZVAL", "(", "value", ",", "1", ",", "1", ")", ";", "}", "}", "/", "*", "}", "}}", "*", "/", "/", "*", "{", "{{", "proto", "mixed", "SplDoublyLinkedList", ":", ":", "top", "(", ")", "U", "@", "@", "-", "1051", ",", "7", "+", "1051", ",", "7", "@", "@", "static", "void", "spl_dllist_it_move_forward", "(", "zend_object_iterator", "*", "iter", "TSRMLS_DC", ")", "/", "*", "SPL_METHOD", "(", "SplDoublyLinkedList", ",", "key", ")", "{", "spl_dllist_object", "*", "intern", "=", "(", "spl_dllist_object", "*", ")", "zend_object_store_get_object", "(", "getThis", "(", ")", "TSRMLS_CC", ")", ";", "if", "(", "zend_parse_parameters_none", "(", ")", "=", "=", "FAILURE", ")", "{", "return", ";", "}", "@", "@", "-", "1065", ",", "7", "+", "1065", ",", "7", "@", "@", "SPL_METHOD", "(", "SplDoublyLinkedList", ",", "key", ")", "SPL_METHOD", "(", "SplDoublyLinkedList", ",", "prev", ")", "{", "spl_dllist_object", "*", "intern", "=", "(", "spl_dllist_object", "*", ")", "zend_object_store_get_object", "(", "getThis", "(", ")", "TSRMLS_CC", ")", ";", "if", "(", "zend_parse_parameters_none", "(", ")", "=", "=", "FAILURE", ")", "{", "return", ";", "}", "@", "@", "-", "1079", ",", "7", "+", "1079", ",", "7", "@", "@", "SPL_METHOD", "(", "SplDoublyLinkedList", ",", "prev", ")", "SPL_METHOD", "(", "SplDoublyLinkedList", ",", "next", ")", "{", "spl_dllist_object", "*", "intern", "=", "(", "spl_dllist_object", "*", ")", "zend_object_store_get_object", "(", "getThis", "(", ")", "TSRMLS_CC", ")", ";", "if", "(", "zend_parse_parameters_none", "(", ")", "=", "=", "FAILURE", ")", "{", "return", ";", "}", "@", "@", "-", "1093", ",", "7", "+", "1093", ",", "7", "@", "@", "SPL_METHOD", "(", "SplDoublyLinkedList", ",", "next", ")", "SPL_METHOD", "(", "SplDoublyLinkedList", ",", "valid", ")", "{", "spl_dllist_object", "*", "intern", "=", "(", "spl_dllist_object", "*", ")", "zend_object_store_get_object", "(", "getThis", "(", ")", "TSRMLS_CC", ")", ";", "if", "(", "zend_parse_parameters_none", "(", ")", "=", "=", "FAILURE", ")", "{", "return", ";", "}", "@", "@", "-", "1107", ",", "7", "+", "1107", ",", "7", "@", "@", "SPL_METHOD", "(", "SplDoublyLinkedList", ",", "valid", ")", "SPL_METHOD", "(", "SplDoublyLinkedList", ",", "rewind", ")", "{", "spl_dllist_object", "*", "intern", "=", "(", "spl_dllist_object", "*", ")", "zend_object_store_get_object", "(", "getThis", "(", ")", "TSRMLS_CC", ")", ";", "if", "(", "zend_parse_parameters_none", "(", ")", "=", "=", "FAILURE", ")", "{", "return", ";", "}", "@", "@", "-", "1122", ",", "7", "+", "1122", ",", "7", "@", "@", "SPL_METHOD", "(", "SplDoublyLinkedList", ",", "current", ")", "{", "spl_dllist_object", "*", "intern", "=", "(", "spl_dllist_object", "*", ")", "zend_object_store_get_object", "(", "getThis", "(", ")", "TSRMLS_CC", ")", ";", "spl_ptr_llist_element", "*", "element", "=", "intern", "-", ">", "traverse_pointer", ";", "if", "(", "zend_parse_parameters_none", "(", ")", "=", "=", "FAILURE", ")", "{", "return", ";", "}", "@", "@", "-", "1177", ",", "7", "+", "1177", ",", "7", "@", "@", "SPL_METHOD", "(", "SplDoublyLinkedList", ",", "serialize", ")", "}", "else", "{", "RETURN_NULL", "(", ");", "}", "}", "/", "*", "}", "}}", "*", "/", "/", "*", "{", "{{", "proto", "void", "SplDoublyLinkedList", ":", ":", "unserialize", "(", "string", "serialized", ")", "@", "@", "-", "1190", ",", "7", "+", "1190", ",", "7", "@", "@", "SPL_METHOD", "(", "SplDoublyLinkedList", ",", "unserialize", ")", "int", "buf_len", ";", "const", "unsigned", "char", "*", "p", ",", "*", "s", ";", "php_unserialize_data_t", "var_hash", ";", "if", "(", "zend_parse_parameters", "(", "ZEND_NUM_ARGS", "(", ")", "TSRMLS_CC", ",", "\"", "s", "\"", ",", "&", "buf", ",", "&", "buf_len", ")", "=", "=", "FAILURE", ")", "{", "return", ";", "}", "@", "@", "-", "1209", ",", "6", "+", "1209", ",", "7", "@", "@", "SPL_METHOD", "(", "SplDoublyLinkedList", ",", "unserialize", ")", "zval_ptr_dtor", "(", "&", "flags", ")", ";", "goto", "error", ";", "}", "var_push_dtor", "(", "&", "var_hash", ",", "&", "flags", ")", ";", "intern", "-", ">", "flags", "=", "Z_LVAL_P", "(", "flags", ")", ";", "zval_ptr_dtor", "(", "&", "flags", ")", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "30", "@", "@", "-", "-", "TEST", "-", "-", "SPL", ":", "Bug", "#", "70169", "Use", "After", "Free", "Vulnerability", "in", "unserialize", "(", ")", "with", "SplDoublyLinkedList", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "inner", "=", "'", "i", ":", "1", ";", "';", "$", "exploit", "=", "'", "a", ":", "2", ":", "{", "i", ":", "0", ";", "C", ":", "19", ":", "\"", "SplDoublyLinkedList", "\"", ":'", ".", "strlen", "(", "$", "inner", ")", ".'", ":{", "'.", "$", "inner", ".", "'}", "i", ":", "1", ";", "R", ":", "3", ";", "}'", ";", "$", "data", "=", "unserialize", "(", "$", "exploit", ")", ";", "for", "(", "$", "i", "=", "0", ";", "$", "i", "<", "5", ";", "$", "i", "+", "+)", "{", "$", "v", "[", "$", "i", "]", "=", "'", "hi", "'", ".$", "i", ";", "}", "var_dump", "(", "$", "data", ")", ";", "?", ">", "=", "==", "DONE", "=", "==", "-", "-", "EXPECTF", "-", "-", "array", "(", "2", ")", "{", "[", "0", "]", "=>", "object", "(", "SplDoublyLinkedList", ")", "#%", "d", "(", "2", ")", "{", "[", "\"", "flags", "\"", ":\"", "SplDoublyLinkedList", "\"", ":", "private", "]", "=>", "int", "(", "1", ")", "[", "\"", "dllist", "\"", ":\"", "SplDoublyLinkedList", "\"", ":", "private", "]", "=>", "array", "(", "0", ")", "{", "}", "}", "[", "1", "]", "=>", "int", "(", "1", ")", "}", "=", "==", "DONE", "=", "=="], "docstring_tokens": ["abusing", "the", "object"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "26", ",", "6", "+", "26", ",", "10", "@", "@", "public", "class", "LongBitFormat", "implements", "Serializable", "{", "private", "static", "final", "long", "serialVersionUID", "=", "1L", ";", "public", "interface", "Enum", "{", "int", "getLength", "(", ");", "}", "private", "final", "String", "NAME", ";", "/", "**", "Bit", "offset", "*", "/", "private", "final", "int", "OFFSET", ";", "@", "@", "-", "69", ",", "4", "+", "73", ",", "8", "@", "@", "public", "long", "combine", "(", "long", "value", ",", "long", "record", ")", "{", "public", "long", "getMin", "(", ")", "{", "return", "MIN", ";", "}", "public", "int", "getLength", "(", ")", "{", "return", "LENGTH", ";", "}", "}", "@", "@", "-", "794", ",", "6", "+", "794", ",", "12", "@", "@", "public", "static", "final", "long", "DFS_IMAGE_TRANSFER_BOOTSTRAP_STANDBY_RATE_DEFAULT", "=", "0", ";", "/", "/", "no", "throttling", "/", "/", "String", "table", "in", "the", "fsimage", "utilizes", "an", "expanded", "bit", "range", ".", "public", "static", "final", "String", "DFS_IMAGE_EXPANDED_STRING_TABLES_KEY", "=", "\"", "dfs", ".", "image", ".", "string", "-", "tables", ".", "expanded", "\"", ";", "public", "static", "final", "boolean", "DFS_IMAGE_EXPANDED_STRING_TABLES_DEFAULT", "=", "false", ";", "/", "/", "Image", "transfer", "timeout", "public", "static", "final", "String", "DFS_IMAGE_TRANSFER_TIMEOUT_KEY", "=", "\"", "dfs", ".", "image", ".", "transfer", ".", "timeout", "\"", ";", "public", "static", "final", "int", "DFS_IMAGE_TRANSFER_TIMEOUT_DEFAULT", "=", "60", "*", "1000", ";", "@", "@", "-", "31", ",", "25", "+", "31", ",", "23", "@", "@", "/", "**", "*", "Class", "to", "pack", "an", "AclEntry", "into", "an", "integer", ".", "<", "br", ">", "*", "An", "ACL", "entry", "is", "represented", "by", "a", "32", "-", "bit", "integer", "in", "Big", "Endian", "format", ".", "<", "br", ">", "*", "The", "bits", "can", "be", "divided", "in", "four", "segments", ":", "<", "br", ">", "*", "[", "0", ":", "1", ")", "|", "|", "[", "1", ":", "3", ")", "|", "|", "[", "3", ":", "6", ")", "|", "|", "[", "6", ":", "7", ")", "|", "|", "[", "7", ":", "32", ")", "<", "br", ">", "*", "<", "br", ">", "*", "[", "0", ":", "1", ")", "-", "-", "the", "scope", "of", "the", "entry", "(", "AclEntryScope", ")", "<", "br", ">", "*", "[", "1", ":", "3", ")", "-", "-", "the", "type", "of", "the", "entry", "(", "AclEntryType", ")", "<", "br", ">", "*", "[", "3", ":", "6", ")", "-", "-", "the", "permission", "of", "the", "entry", "(", "FsAction", ")", "<", "br", ">", "*", "[", "6", ":", "7", ")", "-", "-", "A", "flag", "to", "indicate", "whether", "Named", "entry", "or", "not", "<", "br", ">", "*", "[", "7", ":", "8", ")", "-", "-", "Reserved", "<", "br", ">", "*", "[", "8", ":", "32", ")", "-", "-", "the", "name", "of", "the", "entry", ",", "which", "is", "an", "ID", "that", "points", "to", "a", "<", "br", ">", "*", "string", "in", "the", "StringTableSection", ".", "<", "br", ">", "*", "*", "Note", ":", "this", "format", "is", "used", "both", "in", "-", "memory", "and", "on", "-", "disk", ".", "Changes", "will", "be", "*", "incompatible", ".", "*", "*", "/", "public", "enum", "AclEntryStatusFormat", "{", "public", "enum", "AclEntryStatusFormat", "implements", "LongBitFormat", ".", "Enum", "{", "PERMISSION", "(", "null", ",", "3", ")", ",", "TYPE", "(", "PERMISSION", ".", "BITS", ",", "2", ")", ",", "SCOPE", "(", "TYPE", ".", "BITS", ",", "1", ")", ",", "NAME", "(", "SCOPE", ".", "BITS", ",", "24", ")", ";", "SCOPE", "(", "null", ",", "1", ")", ",", "TYPE", "(", "SCOPE", ".", "BITS", ",", "2", ")", ",", "PERMISSION", "(", "TYPE", ".", "BITS", ",", "3", ")", ",", "NAMED_ENTRY_CHECK", "(", "PERMISSION", ".", "BITS", ",", "1", ")", ",", "RESERVED", "(", "NAMED_ENTRY_CHECK", ".", "BITS", ",", "1", ")", ",", "NAME", "(", "RESERVED", ".", "BITS", ",", "24", ")", ";", "private", "static", "final", "FsAction", "[", "]", "FSACTION_VALUES", "=", "FsAction", ".", "values", "(", ");", "private", "static", "final", "AclEntryScope", "[", "]", "ACL_ENTRY_SCOPE_VALUES", "=", "AclEntryScope", ".", "values", "(", ");", "private", "static", "final", "AclEntryType", "[", "]", "ACL_ENTRY_TYPE_VALUES", "=", "AclEntryType", ".", "values", "(", ");", "private", "final", "LongBitFormat", "BITS", ";", "@", "@", "-", "59", ",", "30", "+", "57", ",", "29", "@", "@", "private", "AclEntryStatusFormat", "(", "LongBitFormat", "previous", ",", "int", "length", ")", "{", "static", "AclEntryScope", "getScope", "(", "int", "aclEntry", ")", "{", "int", "ordinal", "=", "(", "int", ")", "SCOPE", ".", "BITS", ".", "retrieve", "(", "aclEntry", ")", ";", "return", "AclEntryScope", ".", "values", "(", ")[", "ordinal", "]", ";", "return", "ACL_ENTRY_SCOPE_VALUES", "[", "ordinal", "]", ";", "}", "static", "AclEntryType", "getType", "(", "int", "aclEntry", ")", "{", "int", "ordinal", "=", "(", "int", ")", "TYPE", ".", "BITS", ".", "retrieve", "(", "aclEntry", ")", ";", "return", "AclEntryType", ".", "values", "(", ")[", "ordinal", "]", ";", "return", "ACL_ENTRY_TYPE_VALUES", "[", "ordinal", "]", ";", "}", "static", "FsAction", "getPermission", "(", "int", "aclEntry", ")", "{", "int", "ordinal", "=", "(", "int", ")", "PERMISSION", ".", "BITS", ".", "retrieve", "(", "aclEntry", ")", ";", "return", "FsAction", ".", "values", "(", ")[", "ordinal", "]", ";", "return", "FSACTION_VALUES", "[", "ordinal", "]", ";", "}", "static", "String", "getName", "(", "int", "aclEntry", ")", "{", "int", "nameExists", "=", "(", "int", ")", "NAMED_ENTRY_CHECK", ".", "BITS", ".", "retrieve", "(", "aclEntry", ")", ";", "if", "(", "nameExists", "=", "=", "0", ")", "{", "return", "null", ";", "}", "int", "id", "=", "(", "int", ")", "NAME", ".", "BITS", ".", "retrieve", "(", "aclEntry", ")", ";", "AclEntryType", "type", "=", "getType", "(", "aclEntry", ")", ";", "if", "(", "type", "=", "=", "AclEntryType", ".", "USER", ")", "{", "return", "SerialNumberManager", ".", "INSTANCE", ".", "getUser", "(", "id", ")", ";", "}", "else", "if", "(", "type", "=", "=", "AclEntryType", ".", "GROUP", ")", "{", "return", "SerialNumberManager", ".", "INSTANCE", ".", "getGroup", "(", "id", ")", ";", "return", "getName", "(", "aclEntry", ",", "null", ")", ";", "}", "static", "String", "getName", "(", "int", "aclEntry", ",", "SerialNumberManager", ".", "StringTable", "stringTable", ")", "{", "SerialNumberManager", "snm", "=", "getSerialNumberManager", "(", "getType", "(", "aclEntry", ")", ");", "if", "(", "snm", "!", "=", "null", ")", "{", "int", "nid", "=", "(", "int", ")", "NAME", ".", "BITS", ".", "retrieve", "(", "aclEntry", ")", ";", "return", "snm", ".", "getString", "(", "nid", ",", "stringTable", ")", ";", "}", "return", "null", ";", "}", "@", "@", "-", "94", ",", "29", "+", "91", ",", "26", "@", "@", "static", "int", "toInt", "(", "AclEntry", "aclEntry", ")", "{", "aclEntryInt", "=", "TYPE", ".", "BITS", ".", "combine", "(", "aclEntry", ".", "getType", "(", ").", "ordinal", "(", "),", "aclEntryInt", ")", ";", "aclEntryInt", "=", "PERMISSION", ".", "BITS", ".", "combine", "(", "aclEntry", ".", "getPermission", "(", ").", "ordinal", "(", "),", "aclEntryInt", ")", ";", "if", "(", "aclEntry", ".", "getName", "(", ")", "!", "=", "null", ")", "{", "aclEntryInt", "=", "NAMED_ENTRY_CHECK", ".", "BITS", ".", "combine", "(", "1", ",", "aclEntryInt", ")", ";", "if", "(", "aclEntry", ".", "getType", "(", ")", "=", "=", "AclEntryType", ".", "USER", ")", "{", "int", "userId", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getUserSerialNumber", "(", "aclEntry", ".", "getName", "(", "))", ";", "aclEntryInt", "=", "NAME", ".", "BITS", ".", "combine", "(", "userId", ",", "aclEntryInt", ")", ";", "}", "else", "if", "(", "aclEntry", ".", "getType", "(", ")", "=", "=", "AclEntryType", ".", "GROUP", ")", "{", "int", "groupId", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getGroupSerialNumber", "(", "aclEntry", ".", "getName", "(", "))", ";", "aclEntryInt", "=", "NAME", ".", "BITS", ".", "combine", "(", "groupId", ",", "aclEntryInt", ")", ";", "}", "SerialNumberManager", "snm", "=", "getSerialNumberManager", "(", "aclEntry", ".", "getType", "(", "))", ";", "if", "(", "snm", "!", "=", "null", ")", "{", "int", "nid", "=", "snm", ".", "getSerialNumber", "(", "aclEntry", ".", "getName", "(", "))", ";", "aclEntryInt", "=", "NAME", ".", "BITS", ".", "combine", "(", "nid", ",", "aclEntryInt", ")", ";", "}", "return", "(", "int", ")", "aclEntryInt", ";", "}", "static", "AclEntry", "toAclEntry", "(", "int", "aclEntry", ")", "{", "AclEntry", ".", "Builder", "builder", "=", "new", "AclEntry", ".", "Builder", "(", ");", "builder", ".", "setScope", "(", "getScope", "(", "aclEntry", ")", ").", "setType", "(", "getType", "(", "aclEntry", ")", ")", ".", "setPermission", "(", "getPermission", "(", "aclEntry", ")", ");", "if", "(", "getName", "(", "aclEntry", ")", "!", "=", "null", ")", "{", "builder", ".", "setName", "(", "getName", "(", "aclEntry", ")", ");", "}", "return", "builder", ".", "build", "(", ");", "return", "toAclEntry", "(", "aclEntry", ",", "null", ")", ";", "}", "static", "AclEntry", "toAclEntry", "(", "int", "aclEntry", ",", "SerialNumberManager", ".", "StringTable", "stringTable", ")", "{", "return", "new", "AclEntry", ".", "Builder", "(", ")", ".", "setScope", "(", "getScope", "(", "aclEntry", ")", ")", ".", "setType", "(", "getType", "(", "aclEntry", ")", ")", ".", "setPermission", "(", "getPermission", "(", "aclEntry", ")", ")", ".", "setName", "(", "getName", "(", "aclEntry", ",", "stringTable", ")", ")", ".", "build", "(", ");", "}", "public", "static", "int", "[", "]", "toInt", "(", "List", "<", "AclEntry", ">", "aclEntries", ")", "{", "@", "@", "-", "127", ",", "12", "+", "121", ",", "19", "@", "@", "static", "AclEntry", "toAclEntry", "(", "int", "aclEntry", ")", "{", "return", "entries", ";", "}", "public", "static", "ImmutableList", "<", "AclEntry", ">", "toAclEntries", "(", "int", "[", "]", "entries", ")", "{", "ImmutableList", ".", "Builder", "<", "AclEntry", ">", "b", "=", "new", "ImmutableList", ".", "Builder", "<", "AclEntry", ">", "()", ";", "for", "(", "int", "entry", ":", "entries", ")", "{", "AclEntry", "aclEntry", "=", "toAclEntry", "(", "entry", ")", ";", "b", ".", "add", "(", "aclEntry", ")", ";", "private", "static", "SerialNumberManager", "getSerialNumberManager", "(", "AclEntryType", "type", ")", "{", "switch", "(", "type", ")", "{", "case", "USER", ":", "return", "SerialNumberManager", ".", "USER", ";", "case", "GROUP", ":", "return", "SerialNumberManager", ".", "GROUP", ";", "default", ":", "return", "null", ";", "}", "return", "b", ".", "build", "(", ");", "}", "@", "Override", "public", "int", "getLength", "(", ")", "{", "return", "BITS", ".", "getLength", "(", ");", "}", "}", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "265", ",", "6", "+", "265", ",", "8", "@", "@", "public", "int", "getWriteHoldCount", "(", ")", "{", "}", ";", "FSDirectory", "(", "FSNamesystem", "ns", ",", "Configuration", "conf", ")", "throws", "IOException", "{", "/", "/", "used", "to", "enable", "/", "disable", "the", "use", "of", "expanded", "string", "tables", ".", "SerialNumberManager", ".", "initialize", "(", "conf", ")", ";", "this", ".", "dirLock", "=", "new", "ReentrantReadWriteLock", "(", "true", ")", ";", "/", "/", "fair", "this", ".", "inodeId", "=", "new", "INodeId", "(", ");", "rootDir", "=", "createRoot", "(", "ns", ")", ";", "@", "@", "-", "31", ",", "10", "+", "31", ",", "6", "@", "@", "import", "org", ".", "apache", ".", "hadoop", ".", "HadoopIllegalArgumentException", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "classification", ".", "InterfaceAudience", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "permission", ".", "AclEntry", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "permission", ".", "AclEntryScope", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "permission", ".", "AclEntryType", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "permission", ".", "FsAction", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "permission", ".", "FsPermission", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "permission", ".", "PermissionStatus", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "StorageType", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "XAttr", ";", "@", "@", "-", "60", ",", "6", "+", "56", ",", "8", "@", "@", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "FsImageProto", ".", "INodeSection", ".", "XAttrFeatureProto", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "FsImageProto", ".", "INodeSection", ".", "QuotaByStorageTypeEntryProto", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "FsImageProto", ".", "INodeSection", ".", "QuotaByStorageTypeFeatureProto", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "INodeWithAdditionalFields", ".", "PermissionStatusFormat", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "SerialNumberManager", ".", "StringTable", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "snapshot", ".", "Snapshot", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "startupprogress", ".", "Phase", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "startupprogress", ".", "StartupProgress", ";", "@", "@", "-", "74", ",", "22", "+", "72", ",", "11", "@", "@", "@", "InterfaceAudience", ".", "Private", "public", "final", "class", "FSImageFormatPBINode", "{", "private", "final", "static", "long", "USER_GROUP_STRID_MASK", "=", "(", "1", "<", "<", "24", ")", "-", "1", ";", "private", "final", "static", "int", "USER_STRID_OFFSET", "=", "40", ";", "private", "final", "static", "int", "GROUP_STRID_OFFSET", "=", "16", ";", "public", "static", "final", "int", "ACL_ENTRY_NAME_MASK", "=", "(", "1", "<", "<", "24", ")", "-", "1", ";", "public", "static", "final", "int", "ACL_ENTRY_NAME_OFFSET", "=", "6", ";", "public", "static", "final", "int", "ACL_ENTRY_TYPE_OFFSET", "=", "3", ";", "public", "static", "final", "int", "ACL_ENTRY_SCOPE_OFFSET", "=", "5", ";", "public", "static", "final", "int", "ACL_ENTRY_PERM_MASK", "=", "7", ";", "private", "static", "final", "int", "ACL_ENTRY_TYPE_MASK", "=", "3", ";", "private", "static", "final", "int", "ACL_ENTRY_SCOPE_MASK", "=", "1", ";", "private", "static", "final", "FsAction", "[", "]", "FSACTION_VALUES", "=", "FsAction", ".", "values", "(", ");", "private", "static", "final", "AclEntryScope", "[", "]", "ACL_ENTRY_SCOPE_VALUES", "=", "AclEntryScope", ".", "values", "(", ");", "private", "static", "final", "AclEntryType", "[", "]", "ACL_ENTRY_TYPE_VALUES", "=", "AclEntryType", ".", "values", "(", ");", "public", "static", "final", "int", "XATTR_NAMESPACE_MASK", "=", "3", ";", "public", "static", "final", "int", "XATTR_NAMESPACE_OFFSET", "=", "30", ";", "@", "@", "-", "100", ",", "55", "+", "87", ",", "35", "@", "@", "public", "static", "final", "int", "XATTR_NAMESPACE_EXT_OFFSET", "=", "5", ";", "public", "static", "final", "int", "XATTR_NAMESPACE_EXT_MASK", "=", "1", ";", "private", "static", "final", "XAttr", ".", "NameSpace", "[", "]", "XATTR_NAMESPACE_VALUES", "=", "XAttr", ".", "NameSpace", ".", "values", "(", ");", "private", "static", "final", "Log", "LOG", "=", "LogFactory", ".", "getLog", "(", "FSImageFormatPBINode", ".", "class", ")", ";", "/", "/", "the", "loader", "must", "decode", "all", "fields", "referencing", "serial", "number", "based", "fields", "/", "/", "via", "to", "<", "Item", ">", "methods", "with", "the", "string", "table", ".", "public", "final", "static", "class", "Loader", "{", "public", "static", "PermissionStatus", "loadPermission", "(", "long", "id", ",", "final", "String", "[", "]", "stringTable", ")", "{", "short", "perm", "=", "(", "short", ")", "(", "id", "&", "(", "(", "1", "<", "<", "GROUP_STRID_OFFSET", ")", "-", "1", ")", ");", "int", "gsid", "=", "(", "int", ")", "(", "(", "id", ">", ">", "GROUP_STRID_OFFSET", ")", "&", "USER_GROUP_STRID_MASK", ")", ";", "int", "usid", "=", "(", "int", ")", "(", "(", "id", ">", ">", "USER_STRID_OFFSET", ")", "&", "USER_GROUP_STRID_MASK", ")", ";", "return", "new", "PermissionStatus", "(", "stringTable", "[", "usid", "]", ",", "stringTable", "[", "gsid", "]", ",", "new", "FsPermission", "(", "perm", ")", ");", "final", "StringTable", "stringTable", ")", "{", "return", "PermissionStatusFormat", ".", "toPermissionStatus", "(", "id", ",", "stringTable", ")", ";", "}", "public", "static", "ImmutableList", "<", "AclEntry", ">", "loadAclEntries", "(", "AclFeatureProto", "proto", ",", "final", "String", "[", "]", "stringTable", ")", "{", "AclFeatureProto", "proto", ",", "final", "StringTable", "stringTable", ")", "{", "ImmutableList", ".", "Builder", "<", "AclEntry", ">", "b", "=", "ImmutableList", ".", "builder", "(", ");", "for", "(", "int", "v", ":", "proto", ".", "getEntriesList", "(", "))", "{", "int", "p", "=", "v", "&", "ACL_ENTRY_PERM_MASK", ";", "int", "t", "=", "(", "v", ">", ">", "ACL_ENTRY_TYPE_OFFSET", ")", "&", "ACL_ENTRY_TYPE_MASK", ";", "int", "s", "=", "(", "v", ">", ">", "ACL_ENTRY_SCOPE_OFFSET", ")", "&", "ACL_ENTRY_SCOPE_MASK", ";", "int", "nid", "=", "(", "v", ">", ">", "ACL_ENTRY_NAME_OFFSET", ")", "&", "ACL_ENTRY_NAME_MASK", ";", "String", "name", "=", "stringTable", "[", "nid", "]", ";", "b", ".", "add", "(", "new", "AclEntry", ".", "Builder", "(", ").", "setName", "(", "name", ")", ".", "setPermission", "(", "FSACTION_VALUES", "[", "p", "]", ")", ".", "setScope", "(", "ACL_ENTRY_SCOPE_VALUES", "[", "s", "]", ")", ".", "setType", "(", "ACL_ENTRY_TYPE_VALUES", "[", "t", "]", ").", "build", "(", "))", ";", "b", ".", "add", "(", "AclEntryStatusFormat", ".", "toAclEntry", "(", "v", ",", "stringTable", ")", ");", "}", "return", "b", ".", "build", "(", ");", "}", "public", "static", "List", "<", "XAttr", ">", "loadXAttrs", "(", "XAttrFeatureProto", "proto", ",", "final", "String", "[", "]", "stringTable", ")", "{", "XAttrFeatureProto", "proto", ",", "final", "StringTable", "stringTable", ")", "{", "List", "<", "XAttr", ">", "b", "=", "new", "ArrayList", "<", ">(", ");", "for", "(", "XAttrCompactProto", "xAttrCompactProto", ":", "proto", ".", "getXAttrsList", "(", "))", "{", "int", "v", "=", "xAttrCompactProto", ".", "getName", "(", ");", "int", "nid", "=", "(", "v", ">", ">", "XATTR_NAME_OFFSET", ")", "&", "XATTR_NAME_MASK", ";", "int", "ns", "=", "(", "v", ">", ">", "XATTR_NAMESPACE_OFFSET", ")", "&", "XATTR_NAMESPACE_MASK", ";", "ns", "|", "=", "(", "(", "v", ">", ">", "XATTR_NAMESPACE_EXT_OFFSET", ")", "&", "XATTR_NAMESPACE_EXT_MASK", ")", "<", "<", "2", ";", "String", "name", "=", "stringTable", "[", "nid", "]", ";", "byte", "[", "]", "value", "=", "null", ";", "if", "(", "xAttrCompactProto", ".", "getValue", "(", ")", "!", "=", "null", ")", "{", "value", "=", "xAttrCompactProto", ".", "getValue", "(", ").", "toByteArray", "(", ");", "}", "b", ".", "add", "(", "new", "XAttr", ".", "Builder", "(", ").", "setNameSpace", "(", "XATTR_NAMESPACE_VALUES", "[", "ns", "]", ")", ".", "setName", "(", "name", ")", ".", "setValue", "(", "value", ")", ".", "build", "(", "))", ";", "b", ".", "add", "(", "XAttrFormat", ".", "toXAttr", "(", "v", ",", "value", ",", "stringTable", ")", ");", "}", "return", "b", ";", "@", "@", "-", "438", ",", "46", "+", "405", ",", "30", "@", "@", "private", "void", "loadRootINode", "(", "INodeSection", ".", "INode", "p", ")", "{", "}", "}", "/", "/", "the", "saver", "can", "directly", "write", "out", "fields", "referencing", "serial", "numbers", ".", "/", "/", "the", "serial", "number", "maps", "will", "be", "compacted", "when", "loading", ".", "public", "final", "static", "class", "Saver", "{", "private", "long", "numImageErrors", ";", "private", "static", "long", "buildPermissionStatus", "(", "INodeAttributes", "n", ",", "final", "SaverContext", ".", "DeduplicationMap", "<", "String", ">", "stringMap", ")", "{", "long", "userId", "=", "stringMap", ".", "getId", "(", "n", ".", "getUserName", "(", "))", ";", "long", "groupId", "=", "stringMap", ".", "getId", "(", "n", ".", "getGroupName", "(", "))", ";", "return", "(", "(", "userId", "&", "USER_GROUP_STRID_MASK", ")", "<", "<", "USER_STRID_OFFSET", ")", "|", "(", "(", "groupId", "&", "USER_GROUP_STRID_MASK", ")", "<", "<", "GROUP_STRID_OFFSET", ")", "|", "n", ".", "getFsPermissionShort", "(", ");", "private", "static", "long", "buildPermissionStatus", "(", "INodeAttributes", "n", ")", "{", "return", "n", ".", "getPermissionLong", "(", ");", "}", "private", "static", "AclFeatureProto", ".", "Builder", "buildAclEntries", "(", "AclFeature", "f", ",", "final", "SaverContext", ".", "DeduplicationMap", "<", "String", ">", "map", ")", "{", "private", "static", "AclFeatureProto", ".", "Builder", "buildAclEntries", "(", "AclFeature", "f", ")", "{", "AclFeatureProto", ".", "Builder", "b", "=", "AclFeatureProto", ".", "newBuilder", "(", ");", "for", "(", "int", "pos", "=", "0", ",", "e", ";", "pos", "<", "f", ".", "getEntriesSize", "(", ");", "pos", "+", "+)", "{", "e", "=", "f", ".", "getEntryAt", "(", "pos", ")", ";", "int", "nameId", "=", "map", ".", "getId", "(", "AclEntryStatusFormat", ".", "getName", "(", "e", ")", ");", "int", "v", "=", "(", "(", "nameId", "&", "ACL_ENTRY_NAME_MASK", ")", "<", "<", "ACL_ENTRY_NAME_OFFSET", ")", "|", "(", "AclEntryStatusFormat", ".", "getType", "(", "e", ")", ".", "ordinal", "(", ")", "<", "<", "ACL_ENTRY_TYPE_OFFSET", ")", "|", "(", "AclEntryStatusFormat", ".", "getScope", "(", "e", ")", ".", "ordinal", "(", ")", "<", "<", "ACL_ENTRY_SCOPE_OFFSET", ")", "|", "(", "AclEntryStatusFormat", ".", "getPermission", "(", "e", ")", ".", "ordinal", "(", "))", ";", "b", ".", "addEntries", "(", "v", ")", ";", "b", ".", "addEntries", "(", "e", ")", ";", "}", "return", "b", ";", "}", "private", "static", "XAttrFeatureProto", ".", "Builder", "buildXAttrs", "(", "XAttrFeature", "f", ",", "final", "SaverContext", ".", "DeduplicationMap", "<", "String", ">", "stringMap", ")", "{", "private", "static", "XAttrFeatureProto", ".", "Builder", "buildXAttrs", "(", "XAttrFeature", "f", ")", "{", "XAttrFeatureProto", ".", "Builder", "b", "=", "XAttrFeatureProto", ".", "newBuilder", "(", ");", "for", "(", "XAttr", "a", ":", "f", ".", "getXAttrs", "(", "))", "{", "XAttrCompactProto", ".", "Builder", "xAttrCompactBuilder", "=", "XAttrCompactProto", ".", "newBuilder", "(", ");", "int", "nsOrd", "=", "a", ".", "getNameSpace", "(", ").", "ordinal", "(", ");", "Preconditions", ".", "checkArgument", "(", "nsOrd", "<", "8", ",", "\"", "Too", "many", "namespaces", ".", "\")", ";", "int", "v", "=", "(", "(", "nsOrd", "&", "XATTR_NAMESPACE_MASK", ")", "<", "<", "XATTR_NAMESPACE_OFFSET", ")", "|", "(", "(", "stringMap", ".", "getId", "(", "a", ".", "getName", "(", "))", "&", "XATTR_NAME_MASK", ")", "<", "<", "XATTR_NAME_OFFSET", ")", ";", "v", "|", "=", "(", "((", "nsOrd", ">", ">", "2", ")", "&", "XATTR_NAMESPACE_EXT_MASK", ")", "<", "<", "XATTR_NAMESPACE_EXT_OFFSET", ")", ";", "int", "v", "=", "XAttrFormat", ".", "toInt", "(", "a", ")", ";", "xAttrCompactBuilder", ".", "setName", "(", "v", ")", ";", "if", "(", "a", ".", "getValue", "(", ")", "!", "=", "null", ")", "{", "xAttrCompactBuilder", ".", "setValue", "(", "PBHelperClient", ".", "getByteString", "(", "a", ".", "getValue", "(", "))", ");", "@", "@", "-", "509", ",", "7", "+", "460", ",", "7", "@", "@", "private", "static", "long", "buildPermissionStatus", "(", "INodeAttributes", "n", ",", "INodeSection", ".", "INodeFile", ".", "Builder", "b", "=", "INodeSection", ".", "INodeFile", ".", "newBuilder", "(", ")", ".", "setAccessTime", "(", "file", ".", "getAccessTime", "(", "))", ".", "setModificationTime", "(", "file", ".", "getModificationTime", "(", "))", ".", "setPermission", "(", "buildPermissionStatus", "(", "file", ",", "state", ".", "getStringMap", "(", "))", ")", ".", "setPermission", "(", "buildPermissionStatus", "(", "file", ")", ")", ".", "setPreferredBlockSize", "(", "file", ".", "getPreferredBlockSize", "(", "))", ".", "setStoragePolicyID", "(", "file", ".", "getLocalStoragePolicyID", "(", "))", ".", "setBlockType", "(", "PBHelperClient", ".", "convert", "(", "file", ".", "getBlockType", "(", "))", ");", "@", "@", "-", "522", ",", "11", "+", "473", ",", "11", "@", "@", "private", "static", "long", "buildPermissionStatus", "(", "INodeAttributes", "n", ",", "AclFeature", "f", "=", "file", ".", "getAclFeature", "(", ");", "if", "(", "f", "!", "=", "null", ")", "{", "b", ".", "setAcl", "(", "buildAclEntries", "(", "f", ",", "state", ".", "getStringMap", "(", "))", ");", "b", ".", "setAcl", "(", "buildAclEntries", "(", "f", ")", ");", "}", "XAttrFeature", "xAttrFeature", "=", "file", ".", "getXAttrFeature", "(", ");", "if", "(", "xAttrFeature", "!", "=", "null", ")", "{", "b", ".", "setXAttrs", "(", "buildXAttrs", "(", "xAttrFeature", ",", "state", ".", "getStringMap", "(", "))", ");", "b", ".", "setXAttrs", "(", "buildXAttrs", "(", "xAttrFeature", ")", ");", "}", "return", "b", ";", "}", "@", "@", "-", "538", ",", "19", "+", "489", ",", "19", "@", "@", "private", "static", "long", "buildPermissionStatus", "(", "INodeAttributes", "n", ",", ".", "newBuilder", "(", ").", "setModificationTime", "(", "dir", ".", "getModificationTime", "(", "))", ".", "setNsQuota", "(", "quota", ".", "getNameSpace", "(", "))", ".", "setDsQuota", "(", "quota", ".", "getStorageSpace", "(", "))", ".", "setPermission", "(", "buildPermissionStatus", "(", "dir", ",", "state", ".", "getStringMap", "(", "))", ");", ".", "setPermission", "(", "buildPermissionStatus", "(", "dir", ")", ");", "if", "(", "quota", ".", "getTypeSpaces", "(", ").", "anyGreaterOrEqual", "(", "0", ")", ")", "{", "b", ".", "setTypeQuotas", "(", "buildQuotaByStorageTypeEntries", "(", "quota", ")", ");", "}", "AclFeature", "f", "=", "dir", ".", "getAclFeature", "(", ");", "if", "(", "f", "!", "=", "null", ")", "{", "b", ".", "setAcl", "(", "buildAclEntries", "(", "f", ",", "state", ".", "getStringMap", "(", "))", ");", "b", ".", "setAcl", "(", "buildAclEntries", "(", "f", ")", ");", "}", "XAttrFeature", "xAttrFeature", "=", "dir", ".", "getXAttrFeature", "(", ");", "if", "(", "xAttrFeature", "!", "=", "null", ")", "{", "b", ".", "setXAttrs", "(", "buildXAttrs", "(", "xAttrFeature", ",", "state", ".", "getStringMap", "(", "))", ");", "b", ".", "setXAttrs", "(", "buildXAttrs", "(", "xAttrFeature", ")", ");", "}", "return", "b", ";", "}", "@", "@", "-", "711", ",", "7", "+", "662", ",", "7", "@", "@", "private", "void", "save", "(", "OutputStream", "out", ",", "INodeSymlink", "n", ")", "throws", "IOException", "{", "SaverContext", "state", "=", "parent", ".", "getSaverContext", "(", ");", "INodeSection", ".", "INodeSymlink", ".", "Builder", "b", "=", "INodeSection", ".", "INodeSymlink", ".", "newBuilder", "(", ")", ".", "setPermission", "(", "buildPermissionStatus", "(", "n", ",", "state", ".", "getStringMap", "(", "))", ")", ".", "setPermission", "(", "buildPermissionStatus", "(", "n", ")", ")", ".", "setTarget", "(", "ByteString", ".", "copyFrom", "(", "n", ".", "getSymlink", "(", "))", ")", ".", "setModificationTime", "(", "n", ".", "getModificationTime", "(", "))", ".", "setAccessTime", "(", "n", ".", "getAccessTime", "(", "))", ";", "@", "@", "-", "85", ",", "10", "+", "85", ",", "10", "@", "@", ".", "getLogger", "(", "FSImageFormatProtobuf", ".", "class", ")", ";", "public", "static", "final", "class", "LoaderContext", "{", "private", "String", "[", "]", "stringTable", ";", "private", "SerialNumberManager", ".", "StringTable", "stringTable", ";", "private", "final", "ArrayList", "<", "INodeReference", ">", "refList", "=", "Lists", ".", "newArrayList", "(", ");", "public", "String", "[", "]", "getStringTable", "(", ")", "{", "public", "SerialNumberManager", ".", "StringTable", "getStringTable", "(", ")", "{", "return", "stringTable", ";", "}", "@", "@", "-", "129", ",", "13", "+", "129", ",", "6", "@", "@", "int", "size", "(", ")", "{", "}", "private", "final", "ArrayList", "<", "INodeReference", ">", "refList", "=", "Lists", ".", "newArrayList", "(", ");", "private", "final", "DeduplicationMap", "<", "String", ">", "stringMap", "=", "DeduplicationMap", ".", "newMap", "(", ");", "public", "DeduplicationMap", "<", "String", ">", "getStringMap", "(", ")", "{", "return", "stringMap", ";", "}", "public", "ArrayList", "<", "INodeReference", ">", "getRefList", "(", ")", "{", "return", "refList", ";", "}", "@", "@", "-", "327", ",", "11", "+", "320", ",", "12", "@", "@", "private", "void", "loadNameSystemSection", "(", "InputStream", "in", ")", "throws", "IOException", "{", "private", "void", "loadStringTableSection", "(", "InputStream", "in", ")", "throws", "IOException", "{", "StringTableSection", "s", "=", "StringTableSection", ".", "parseDelimitedFrom", "(", "in", ")", ";", "ctx", ".", "stringTable", "=", "new", "String", "[", "s", ".", "getNumEntry", "(", ")", "+", "1", "]", ";", "ctx", ".", "stringTable", "=", "SerialNumberManager", ".", "newStringTable", "(", "s", ".", "getNumEntry", "(", "),", "s", ".", "getMaskBits", "(", "))", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "s", ".", "getNumEntry", "(", ");", "+", "+", "i", ")", "{", "StringTableSection", ".", "Entry", "e", "=", "StringTableSection", ".", "Entry", ".", "parseDelimitedFrom", "(", "in", ")", ";", "ctx", ".", "stringTable", "[", "e", ".", "getId", "(", ")]", "=", "e", ".", "getStr", "(", ");", "ctx", ".", "stringTable", ".", "put", "(", "e", ".", "getId", "(", "),", "e", ".", "getStr", "(", "))", ";", "}", "}", "@", "@", "-", "651", ",", "12", "+", "645", ",", "16", "@", "@", "private", "void", "saveNameSystemSection", "(", "FileSummary", ".", "Builder", "summary", ")", "private", "void", "saveStringTableSection", "(", "FileSummary", ".", "Builder", "summary", ")", "throws", "IOException", "{", "OutputStream", "out", "=", "sectionOutputStream", ";", "SerialNumberManager", ".", "StringTable", "stringTable", "=", "SerialNumberManager", ".", "getStringTable", "(", ");", "StringTableSection", ".", "Builder", "b", "=", "StringTableSection", ".", "newBuilder", "(", ")", ".", "setNumEntry", "(", "saverContext", ".", "stringMap", ".", "size", "(", "))", ";", ".", "setNumEntry", "(", "stringTable", ".", "size", "(", "))", ".", "setMaskBits", "(", "stringTable", ".", "getMaskBits", "(", "))", ";", "b", ".", "build", "(", ").", "writeDelimitedTo", "(", "out", ")", ";", "for", "(", "Entry", "<", "String", ",", "Integer", ">", "e", ":", "saverContext", ".", "stringMap", ".", "entrySet", "(", "))", "{", "for", "(", "Entry", "<", "Integer", ",", "String", ">", "e", ":", "stringTable", ")", "{", "StringTableSection", ".", "Entry", ".", "Builder", "eb", "=", "StringTableSection", ".", "Entry", ".", "newBuilder", "(", ").", "setId", "(", "e", ".", "getValue", "(", "))", ".", "setStr", "(", "e", ".", "getKey", "(", "))", ";", ".", "newBuilder", "(", ").", "setId", "(", "e", ".", "getKey", "(", "))", ".", "setStr", "(", "e", ".", "getValue", "(", "))", ";", "eb", ".", "build", "(", ").", "writeDelimitedTo", "(", "out", ")", ";", "}", "commitSection", "(", "summary", ",", "SectionName", ".", "STRING_TABLE", ")", ";", "@", "@", "-", "33", ",", "7", "+", "33", ",", "9", "@", "@", "@", "InterfaceAudience", ".", "Private", "public", "abstract", "class", "INodeWithAdditionalFields", "extends", "INode", "implements", "LinkedElement", "{", "enum", "PermissionStatusFormat", "{", "/", "/", "Note", ":", "this", "format", "is", "used", "both", "in", "-", "memory", "and", "on", "-", "disk", ".", "Changes", "will", "be", "/", "/", "incompatible", ".", "enum", "PermissionStatusFormat", "implements", "LongBitFormat", ".", "Enum", "{", "MODE", "(", "null", ",", "16", ")", ",", "GROUP", "(", "MODE", ".", "BITS", ",", "24", ")", ",", "USER", "(", "GROUP", ".", "BITS", ",", "24", ")", ";", "@", "@", "-", "46", ",", "12", "+", "48", ",", "14", "@", "@", "private", "PermissionStatusFormat", "(", "LongBitFormat", "previous", ",", "int", "length", ")", "{", "static", "String", "getUser", "(", "long", "permission", ")", "{", "final", "int", "n", "=", "(", "int", ")", "USER", ".", "BITS", ".", "retrieve", "(", "permission", ")", ";", "return", "SerialNumberManager", ".", "INSTANCE", ".", "getUser", "(", "n", ")", ";", "String", "s", "=", "SerialNumberManager", ".", "USER", ".", "getString", "(", "n", ")", ";", "assert", "s", "!", "=", "null", ";", "return", "s", ";", "}", "static", "String", "getGroup", "(", "long", "permission", ")", "{", "final", "int", "n", "=", "(", "int", ")", "GROUP", ".", "BITS", ".", "retrieve", "(", "permission", ")", ";", "return", "SerialNumberManager", ".", "INSTANCE", ".", "getGroup", "(", "n", ")", ";", "return", "SerialNumberManager", ".", "GROUP", ".", "getString", "(", "n", ")", ";", "}", "static", "short", "getMode", "(", "long", "permission", ")", "{", "@", "@", "-", "61", ",", "16", "+", "65", ",", "34", "@", "@", "static", "short", "getMode", "(", "long", "permission", ")", "{", "/", "**", "Encode", "the", "{", "@", "link", "PermissionStatus", "}", "to", "a", "long", ".", "*", "/", "static", "long", "toLong", "(", "PermissionStatus", "ps", ")", "{", "long", "permission", "=", "0L", ";", "final", "int", "user", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getUserSerialNumber", "(", "final", "int", "user", "=", "SerialNumberManager", ".", "USER", ".", "getSerialNumber", "(", "ps", ".", "getUserName", "(", "))", ";", "assert", "user", "!", "=", "0", ";", "permission", "=", "USER", ".", "BITS", ".", "combine", "(", "user", ",", "permission", ")", ";", "final", "int", "group", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getGroupSerialNumber", "(", "/", "/", "ideally", "should", "assert", "on", "group", "but", "inodes", "are", "created", "with", "null", "/", "/", "group", "and", "then", "updated", "only", "when", "added", "to", "a", "directory", ".", "final", "int", "group", "=", "SerialNumberManager", ".", "GROUP", ".", "getSerialNumber", "(", "ps", ".", "getGroupName", "(", "))", ";", "permission", "=", "GROUP", ".", "BITS", ".", "combine", "(", "group", ",", "permission", ")", ";", "final", "int", "mode", "=", "ps", ".", "getPermission", "(", ").", "toShort", "(", ");", "permission", "=", "MODE", ".", "BITS", ".", "combine", "(", "mode", ",", "permission", ")", ";", "return", "permission", ";", "}", "static", "PermissionStatus", "toPermissionStatus", "(", "long", "id", ",", "SerialNumberManager", ".", "StringTable", "stringTable", ")", "{", "int", "uid", "=", "(", "int", ")", "USER", ".", "BITS", ".", "retrieve", "(", "id", ")", ";", "int", "gid", "=", "(", "int", ")", "GROUP", ".", "BITS", ".", "retrieve", "(", "id", ")", ";", "return", "new", "PermissionStatus", "(", "SerialNumberManager", ".", "USER", ".", "getString", "(", "uid", ",", "stringTable", ")", ",", "SerialNumberManager", ".", "GROUP", ".", "getString", "(", "gid", ",", "stringTable", ")", ",", "new", "FsPermission", "(", "getMode", "(", "id", ")", "))", ";", "}", "@", "Override", "public", "int", "getLength", "(", ")", "{", "return", "BITS", ".", "getLength", "(", ");", "}", "}", "/", "**", "The", "inode", "id", ".", "*", "/", "@", "@", "-", "175", ",", "7", "+", "197", ",", "7", "@", "@", "final", "String", "getUserName", "(", "int", "snapshotId", ")", "{", "@", "Override", "final", "void", "setUser", "(", "String", "user", ")", "{", "int", "n", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getUserSerialNumber", "(", "user", ")", ";", "int", "n", "=", "SerialNumberManager", ".", "USER", ".", "getSerialNumber", "(", "user", ")", ";", "updatePermissionStatus", "(", "PermissionStatusFormat", ".", "USER", ",", "n", ")", ";", "}", "@", "@", "-", "189", ",", "7", "+", "211", ",", "7", "@", "@", "final", "String", "getGroupName", "(", "int", "snapshotId", ")", "{", "@", "Override", "final", "void", "setGroup", "(", "String", "group", ")", "{", "int", "n", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getGroupSerialNumber", "(", "group", ")", ";", "int", "n", "=", "SerialNumberManager", ".", "GROUP", ".", "getSerialNumber", "(", "group", ")", ";", "updatePermissionStatus", "(", "PermissionStatusFormat", ".", "GROUP", ",", "n", ")", ";", "}", "@", "@", "-", "17", ",", "23", "+", "17", ",", "195", "@", "@", "*", "/", "package", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ";", "/", "**", "Manage", "name", "-", "to", "-", "serial", "-", "number", "maps", "for", "users", "and", "groups", ".", "*", "/", "class", "SerialNumberManager", "{", "/", "**", "This", "is", "the", "only", "instance", "of", "{", "@", "link", "SerialNumberManager", "}", ".*", "/", "static", "final", "SerialNumberManager", "INSTANCE", "=", "new", "SerialNumberManager", "(", ");", "import", "org", ".", "apache", ".", "hadoop", ".", "conf", ".", "Configuration", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "INodeWithAdditionalFields", ".", "PermissionStatusFormat", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "util", ".", "LongBitFormat", ";", "private", "final", "SerialNumberMap", "<", "String", ">", "usermap", "=", "new", "SerialNumberMap", "<", "String", ">", "()", ";", "private", "final", "SerialNumberMap", "<", "String", ">", "groupmap", "=", "new", "SerialNumberMap", "<", "String", ">", "()", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Map", ".", "Entry", ";", "private", "SerialNumberManager", "(", ")", "{", "}", "import", "static", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "DFSConfigKeys", ".", "DFS_IMAGE_EXPANDED_STRING_TABLES_DEFAULT", ";", "import", "static", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "DFSConfigKeys", ".", "DFS_IMAGE_EXPANDED_STRING_TABLES_KEY", ";", "int", "getUserSerialNumber", "(", "String", "u", ")", "{", "return", "usermap", ".", "get", "(", "u", ")", ";}", "int", "getGroupSerialNumber", "(", "String", "g", ")", "{", "return", "groupmap", ".", "get", "(", "g", ")", ";}", "String", "getUser", "(", "int", "n", ")", "{", "return", "usermap", ".", "get", "(", "n", ")", ";}", "String", "getGroup", "(", "int", "n", ")", "{", "return", "groupmap", ".", "get", "(", "n", ")", ";}", "/", "**", "Manage", "name", "-", "to", "-", "serial", "-", "number", "maps", "for", "various", "string", "tables", ".", "*", "/", "public", "enum", "SerialNumberManager", "{", "GLOBAL", "(", "),", "/", "/", "NEVER", "EVER", "directly", "access", "!", "USER", "(", "PermissionStatusFormat", ".", "USER", ",", "AclEntryStatusFormat", ".", "NAME", ")", ",", "GROUP", "(", "PermissionStatusFormat", ".", "GROUP", ",", "AclEntryStatusFormat", ".", "NAME", ")", ",", "XATTR", "(", "XAttrFormat", ".", "NAME", ")", ";", "{", "getUserSerialNumber", "(", "null", ")", ";", "getGroupSerialNumber", "(", "null", ")", ";", "private", "static", "final", "SerialNumberManager", "[", "]", "values", "=", "values", "(", ");", "private", "static", "final", "int", "maxEntryBits", ";", "private", "static", "final", "int", "maxEntryNumber", ";", "private", "static", "final", "int", "maskBits", ";", "private", "static", "boolean", "initialized", ";", "private", "SerialNumberMap", "<", "String", ">", "serialMap", ";", "private", "int", "bitLength", "=", "Integer", ".", "SIZE", ";", "private", "boolean", "enabled", ";", "static", "{", "maxEntryBits", "=", "Integer", ".", "numberOfLeadingZeros", "(", "values", ".", "length", ")", ";", "maxEntryNumber", "=", "(", "1", "<", "<", "maxEntryBits", ")", "-", "1", ";", "maskBits", "=", "Integer", ".", "SIZE", "-", "maxEntryBits", ";", "for", "(", "SerialNumberManager", "snm", ":", "values", ")", "{", "/", "/", "account", "for", "string", "table", "mask", "bits", ".", "snm", ".", "updateLength", "(", "maxEntryBits", ")", ";", "/", "/", "find", "max", "allowed", "length", "in", "case", "global", "is", "enabled", ".", "GLOBAL", ".", "updateLength", "(", "snm", ".", "getLength", "(", "))", ";", "}", "/", "/", "can", "reinitialize", "once", "later", ".", "initializeSerialMaps", "(", "DFS_IMAGE_EXPANDED_STRING_TABLES_DEFAULT", ")", ";", "}", "static", "synchronized", "void", "initialize", "(", "Configuration", "conf", ")", "{", "boolean", "useExpanded", "=", "conf", ".", "getBoolean", "(", "DFS_IMAGE_EXPANDED_STRING_TABLES_KEY", ",", "DFS_IMAGE_EXPANDED_STRING_TABLES_DEFAULT", ")", ";", "if", "(", "initialized", ")", "{", "if", "(", "useExpanded", "^", "!", "GLOBAL", ".", "enabled", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "Cannot", "change", "serial", "maps", "\"", ");", "}", "return", ";", "}", "initializeSerialMaps", "(", "useExpanded", ")", ";", "for", "(", "SerialNumberManager", "snm", ":", "values", ")", "{", "if", "(", "snm", ".", "enabled", ")", "{", "FSDirectory", ".", "LOG", ".", "info", "(", "snm", "+", "\"", "serial", "map", ":", "bits", "=", "\"", "+", "snm", ".", "getLength", "(", ")", "\"", "maxEntries", "=", "\"", "+", "snm", ".", "serialMap", ".", "getMax", "(", "))", ";", "}", "}", "initialized", "=", "true", ";", "}", "private", "static", "void", "initializeSerialMaps", "(", "boolean", "useExpanded", ")", "{", "if", "(", "useExpanded", ")", "{", "/", "/", "initialize", "per", "-", "manager", "serial", "maps", "for", "all", "but", "global", ".", "for", "(", "SerialNumberManager", "snm", ":", "values", ")", "{", "snm", ".", "enabled", "=", "(", "snm", "!", "=", "GLOBAL", ")", ";", "snm", ".", "serialMap", "=", "snm", ".", "enabled", "?", "new", "SerialNumberMap", "<", "String", ">", "(", "snm", ")", ":", "null", ";", "}", "}", "else", "{", "/", "/", "initialize", "all", "managers", "to", "use", "the", "global", "serial", "map", ".", "SerialNumberMap", "<", "String", ">", "globalSerialMap", "=", "new", "SerialNumberMap", "<", ">(", "GLOBAL", ")", ";", "for", "(", "SerialNumberManager", "snm", ":", "values", ")", "{", "snm", ".", "enabled", "=", "(", "snm", "=", "=", "GLOBAL", ")", ";", "snm", ".", "serialMap", "=", "globalSerialMap", ";", "}", "}", "}", "SerialNumberManager", "(", "LongBitFormat", ".", "Enum", ".", "..", "elements", ")", "{", "/", "/", "compute", "the", "smallest", "bit", "length", "registered", "with", "the", "serial", "manager", ".", "for", "(", "LongBitFormat", ".", "Enum", "element", ":", "elements", ")", "{", "updateLength", "(", "element", ".", "getLength", "(", "))", ";", "}", "}", "int", "getLength", "(", ")", "{", "return", "bitLength", ";", "}", "private", "void", "updateLength", "(", "int", "maxLength", ")", "{", "bitLength", "=", "Math", ".", "min", "(", "bitLength", ",", "maxLength", ")", ";", "}", "public", "int", "getSerialNumber", "(", "String", "u", ")", "{", "return", "serialMap", ".", "get", "(", "u", ")", ";", "}", "public", "String", "getString", "(", "int", "id", ")", "{", "return", "serialMap", ".", "get", "(", "id", ")", ";", "}", "public", "String", "getString", "(", "int", "id", ",", "StringTable", "stringTable", ")", "{", "return", "(", "stringTable", "!", "=", "null", ")", "?", "stringTable", ".", "get", "(", "this", ",", "id", ")", ":", "getString", "(", "id", ")", ";", "}", "private", "int", "getMask", "(", "int", "bits", ")", "{", "return", "ordinal", "(", ")", "<", "<", "(", "Integer", ".", "SIZE", "-", "bits", ")", ";", "}", "private", "static", "int", "getMaskBits", "(", ")", "{", "return", "GLOBAL", ".", "enabled", "?", "0", ":", "maskBits", ";", "}", "private", "int", "size", "(", ")", "{", "return", "enabled", "?", "serialMap", ".", "size", "(", ")", ":", "0", ";", "}", "private", "Iterable", "<", "Entry", "<", "Integer", ",", "String", ">", ">", "entrySet", "(", ")", "{", "if", "(", "!", "enabled", ")", "{", "return", "Collections", ".", "emptySet", "(", ");", "}", "return", "serialMap", ".", "entrySet", "(", ");", "}", "/", "/", "returns", "snapshot", "of", "current", "values", "for", "a", "save", ".", "public", "static", "StringTable", "getStringTable", "(", ")", "{", "/", "/", "approximate", "size", "for", "capacity", ".", "int", "size", "=", "0", ";", "for", "(", "final", "SerialNumberManager", "snm", ":", "values", ")", "{", "size", "+", "=", "snm", ".", "size", "(", ");", "}", "int", "tableMaskBits", "=", "getMaskBits", "(", ");", "StringTable", "map", "=", "new", "StringTable", "(", "size", ",", "tableMaskBits", ")", ";", "for", "(", "final", "SerialNumberManager", "snm", ":", "values", ")", "{", "final", "int", "mask", "=", "snm", ".", "getMask", "(", "tableMaskBits", ")", ";", "for", "(", "Entry", "<", "Integer", ",", "String", ">", "entry", ":", "snm", ".", "entrySet", "(", "))", "{", "map", ".", "put", "(", "entry", ".", "getKey", "(", ")", "|", "mask", ",", "entry", ".", "getValue", "(", "))", ";", "}", "}", "return", "map", ";", "}", "/", "/", "returns", "an", "empty", "table", "for", "load", ".", "public", "static", "StringTable", "newStringTable", "(", "int", "size", ",", "int", "bits", ")", "{", "if", "(", "bits", ">", "maskBits", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "String", "table", "bits", "\"", "+", "bits", "+", "\"", ">", "\"", "+", "maskBits", ")", ";", "}", "return", "new", "StringTable", "(", "size", ",", "bits", ")", ";", "}", "public", "static", "class", "StringTable", "implements", "Iterable", "<", "Entry", "<", "Integer", ",", "String", ">", ">", "{", "private", "final", "int", "tableMaskBits", ";", "private", "final", "Map", "<", "Integer", ",", "String", ">", "map", ";", "private", "StringTable", "(", "int", "size", ",", "int", "loadingMaskBits", ")", "{", "this", ".", "tableMaskBits", "=", "loadingMaskBits", ";", "this", ".", "map", "=", "new", "HashMap", "<", ">(", "size", ")", ";", "}", "private", "String", "get", "(", "SerialNumberManager", "snm", ",", "int", "id", ")", "{", "if", "(", "tableMaskBits", "!", "=", "0", ")", "{", "if", "(", "id", ">", "maxEntryNumber", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "serial", "id", "\"", "+", "id", "+", "\"", ">", "\"", "+", "maxEntryNumber", ")", ";", "}", "id", "|", "=", "snm", ".", "getMask", "(", "tableMaskBits", ")", ";", "}", "return", "map", ".", "get", "(", "id", ")", ";", "}", "public", "void", "put", "(", "int", "id", ",", "String", "str", ")", "{", "map", ".", "put", "(", "id", ",", "str", ")", ";", "}", "public", "Iterator", "<", "Entry", "<", "Integer", ",", "String", ">", ">", "iterator", "(", ")", "{", "return", "map", ".", "entrySet", "(", ").", "iterator", "(", ");", "}", "public", "int", "size", "(", ")", "{", "return", "map", ".", "size", "(", ");", "}", "public", "int", "getMaskBits", "(", ")", "{", "return", "tableMaskBits", ";", "}", "}", "}", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "17", ",", "6", "+", "17", ",", "10", "@", "@", "*", "/", "package", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ConcurrentHashMap", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ConcurrentMap", ";", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicInteger", ";", "@", "@", "-", "35", ",", "21", "+", "39", ",", "33", "@", "@", "*", "/", "@", "InterfaceAudience", ".", "Private", "public", "class", "SerialNumberMap", "<", "T", ">", "{", "private", "final", "AtomicInteger", "max", "=", "new", "AtomicInteger", "(", "1", ")", ";", "private", "String", "name", ";", "private", "final", "int", "max", ";", "private", "final", "AtomicInteger", "current", "=", "new", "AtomicInteger", "(", "1", ")", ";", "private", "final", "ConcurrentMap", "<", "T", ",", "Integer", ">", "t2i", "=", "new", "ConcurrentHashMap", "<", "T", ",", "Integer", ">", "()", ";", "private", "final", "ConcurrentMap", "<", "Integer", ",", "T", ">", "i2t", "=", "new", "ConcurrentHashMap", "<", "Integer", ",", "T", ">", "()", ";", "SerialNumberMap", "(", "SerialNumberManager", "snm", ")", "{", "this", "(", "snm", ".", "name", "(", "),", "snm", ".", "getLength", "(", "))", ";", "}", "SerialNumberMap", "(", "String", "name", ",", "int", "bitLength", ")", "{", "this", ".", "name", "=", "name", ";", "this", ".", "max", "=", "(", "1", "<", "<", "bitLength", ")", "-", "1", ";", "}", "public", "int", "get", "(", "T", "t", ")", "{", "if", "(", "t", "=", "=", "null", ")", "{", "return", "0", ";", "}", "Integer", "sn", "=", "t2i", ".", "get", "(", "t", ")", ";", "if", "(", "sn", "=", "=", "null", ")", "{", "sn", "=", "max", ".", "getAndIncrement", "(", ");", "if", "(", "sn", "<", "0", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "Too", "many", "elements", "!", "\")", ";", "sn", "=", "current", ".", "getAndIncrement", "(", ");", "if", "(", "sn", ">", "max", ")", "{", "current", ".", "getAndDecrement", "(", ");", "throw", "new", "IllegalStateException", "(", "name", "+", "\"", ":", "serial", "number", "map", "is", "full", "\"", ");", "}", "Integer", "old", "=", "t2i", ".", "putIfAbsent", "(", "t", ",", "sn", ")", ";", "if", "(", "old", "!", "=", "null", ")", "{", "@", "@", "-", "66", ",", "14", "+", "82", ",", "27", "@", "@", "public", "T", "get", "(", "int", "i", ")", "{", "}", "T", "t", "=", "i2t", ".", "get", "(", "i", ")", ";", "if", "(", "t", "=", "=", "null", ")", "{", "throw", "new", "IllegalStateException", "(", "\"!", "i2t", ".", "containsKey", "(", "\"", "+", "i", "+", "\"", "),", "this", "=", "\"", "+", "this", ")", ";", "throw", "new", "IllegalStateException", "(", "name", "+", "\"", ":", "serial", "number", "\"", "+", "i", "+", "\"", "does", "not", "exist", "\"", ");", "}", "return", "t", ";", "}", "int", "getMax", "(", ")", "{", "return", "max", ";", "}", "Set", "<", "Map", ".", "Entry", "<", "Integer", ",", "T", ">", ">", "entrySet", "(", ")", "{", "return", "new", "HashSet", "<", ">(", "i2t", ".", "entrySet", "(", "))", ";", "}", "public", "int", "size", "(", ")", "{", "return", "i2t", ".", "size", "(", ");", "}", "@", "Override", "public", "String", "toString", "(", ")", "{", "return", "\"", "max", "=", "\"", "+", "max", "+", "\"", ",\\", "n", "t2i", "=", "\"", "+", "t2i", "+", "\"", ",\\", "n", "i2t", "=", "\"", "+", "i2t", ";", "return", "\"", "current", "=", "\"", "+", "current", "+", "\"", ",\\", "n", "\"", "\"", "max", "=", "\"", "+", "max", "+", "\"", ",\\", "n", "t2i", "=", "\"", "+", "t2i", "+", "\"", ",\\", "n", "i2t", "=", "\"", "+", "i2t", ";", "}", "}", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "31", ",", "52", "+", "31", ",", "66", "@", "@", "/", "**", "*", "Class", "to", "pack", "XAttrs", "into", "byte", "[", "].", "<", "br", ">", "*", "For", "each", "XAttr", ":", "<", "br", ">", "*", "The", "first", "4", "bytes", "represents", "XAttr", "namespace", "and", "name", "<", "br", ">", "*", "[", "0", ":", "3", ")", "-", "XAttr", "namespace", "<", "br", ">", "*", "[", "3", ":", "8", ")", "-", "Reserved", "<", "br", ">", "*", "[", "8", ":", "32", ")", "-", "The", "name", "of", "the", "entry", ",", "which", "is", "an", "ID", "that", "points", "to", "a", "*", "string", "in", "map", "<", "br", ">", "*", "The", "following", "two", "bytes", "represents", "the", "length", "of", "XAttr", "value", "<", "br", ">", "*", "The", "remaining", "bytes", "is", "the", "XAttr", "value", "<", "br", ">", "*", "*", "Note", ":", "this", "format", "is", "used", "both", "in", "-", "memory", "and", "on", "-", "disk", ".", "Changes", "will", "be", "*", "incompatible", ".", "*", "*", "/", "class", "XAttrFormat", "{", "private", "enum", "XAttrStatusFormat", "{", "NAMESPACE", "(", "null", ",", "3", ")", ",", "RESERVED", "(", "NAMESPACE", ".", "BITS", ",", "5", ")", ",", "NAME", "(", "RESERVED", ".", "BITS", ",", "24", ")", ";", "public", "enum", "XAttrFormat", "implements", "LongBitFormat", ".", "Enum", "{", "RESERVED", "(", "null", ",", "5", ")", ",", "NS_EXT", "(", "RESERVED", ".", "BITS", ",", "1", ")", ",", "NAME", "(", "NS_EXT", ".", "BITS", ",", "24", ")", ",", "NS", "(", "NAME", ".", "BITS", ",", "2", ")", ";", "private", "final", "LongBitFormat", "BITS", ";", "private", "static", "final", "int", "NS_EXT_SHIFT", "=", "NS", ".", "BITS", ".", "getLength", "(", ");", "private", "static", "final", "int", "NS_MASK", "=", "(", "1", "<", "<", "NS_EXT_SHIFT", ")", "-", "1", ";", "XAttrStatusFormat", "(", "LongBitFormat", "previous", ",", "int", "length", ")", "{", "BITS", "=", "new", "LongBitFormat", "(", "name", "(", "),", "previous", ",", "length", ",", "0", ")", ";", "}", "private", "static", "final", "int", "XATTR_VALUE_LEN_MAX", "=", "1", "<", "<", "16", ";", "private", "static", "final", "XAttr", ".", "NameSpace", "[", "]", "XATTR_NAMESPACE_VALUES", "=", "XAttr", ".", "NameSpace", ".", "values", "(", ");", "static", "XAttr", ".", "NameSpace", "getNamespace", "(", "int", "xattrStatus", ")", "{", "int", "ordinal", "=", "(", "int", ")", "NAMESPACE", ".", "BITS", ".", "retrieve", "(", "xattrStatus", ")", ";", "return", "XAttr", ".", "NameSpace", ".", "values", "(", ")[", "ordinal", "]", ";", "}", "private", "final", "LongBitFormat", "BITS", ";", "static", "String", "getName", "(", "int", "xattrStatus", ")", "{", "int", "id", "=", "(", "int", ")", "NAME", ".", "BITS", ".", "retrieve", "(", "xattrStatus", ")", ";", "return", "XAttrStorage", ".", "getName", "(", "id", ")", ";", "}", "XAttrFormat", "(", "LongBitFormat", "previous", ",", "int", "length", ")", "{", "BITS", "=", "new", "LongBitFormat", "(", "name", "(", "),", "previous", ",", "length", ",", "0", ")", ";", "}", "static", "int", "toInt", "(", "XAttr", ".", "NameSpace", "namespace", ",", "String", "name", ")", "{", "long", "xattrStatusInt", "=", "0", ";", "@", "Override", "public", "int", "getLength", "(", ")", "{", "return", "BITS", ".", "getLength", "(", ");", "}", "xattrStatusInt", "=", "NAMESPACE", ".", "BITS", ".", "combine", "(", "namespace", ".", "ordinal", "(", "),", "xattrStatusInt", ")", ";", "int", "nid", "=", "XAttrStorage", ".", "getNameSerialNumber", "(", "name", ")", ";", "xattrStatusInt", "=", "NAME", ".", "BITS", ".", "combine", "(", "nid", ",", "xattrStatusInt", ")", ";", "static", "XAttr", ".", "NameSpace", "getNamespace", "(", "int", "record", ")", "{", "long", "nid", "=", "NS", ".", "BITS", ".", "retrieve", "(", "record", ")", ";", "nid", "|", "=", "NS_EXT", ".", "BITS", ".", "retrieve", "(", "record", ")", "<", "<", "NS_EXT_SHIFT", ";", "return", "XATTR_NAMESPACE_VALUES", "[", "(", "int", ")", "nid", "]", ";", "}", "return", "(", "int", ")", "xattrStatusInt", ";", "}", "public", "static", "String", "getName", "(", "int", "record", ")", "{", "int", "nid", "=", "(", "int", ")", "NAME", ".", "BITS", ".", "retrieve", "(", "record", ")", ";", "return", "SerialNumberManager", ".", "XATTR", ".", "getString", "(", "nid", ")", ";", "}", "private", "static", "final", "int", "XATTR_VALUE_LEN_MAX", "=", "1", "<", "<", "16", ";", "static", "int", "toInt", "(", "XAttr", "a", ")", "{", "int", "nid", "=", "SerialNumberManager", ".", "XATTR", ".", "getSerialNumber", "(", "a", ".", "getName", "(", "))", ";", "int", "nsOrd", "=", "a", ".", "getNameSpace", "(", ").", "ordinal", "(", ");", "long", "value", "=", "NS", ".", "BITS", ".", "combine", "(", "nsOrd", "&", "NS_MASK", ",", "0L", ")", ";", "value", "=", "NS_EXT", ".", "BITS", ".", "combine", "(", "nsOrd", ">", ">>", "NS_EXT_SHIFT", ",", "value", ")", ";", "value", "=", "NAME", ".", "BITS", ".", "combine", "(", "nid", ",", "value", ")", ";", "return", "(", "int", ")", "value", ";", "}", "static", "XAttr", "toXAttr", "(", "int", "record", ",", "byte", "[", "]", "value", ",", "SerialNumberManager", ".", "StringTable", "stringTable", ")", "{", "int", "nid", "=", "(", "int", ")", "NAME", ".", "BITS", ".", "retrieve", "(", "record", ")", ";", "String", "name", "=", "SerialNumberManager", ".", "XATTR", ".", "getString", "(", "nid", ",", "stringTable", ")", ";", "return", "new", "XAttr", ".", "Builder", "(", ")", ".", "setNameSpace", "(", "getNamespace", "(", "record", ")", ")", ".", "setName", "(", "name", ")", ".", "setValue", "(", "value", ")", ".", "build", "(", ");", "}", "/", "**", "*", "Unpack", "byte", "[", "]", "to", "XAttrs", ".", "@", "@", "-", "95", ",", "8", "+", "109", ",", "8", "@", "@", "static", "int", "toInt", "(", "XAttr", ".", "NameSpace", "namespace", ",", "String", "name", ")", "{", "int", "v", "=", "Ints", ".", "fromBytes", "(", "attrs", "[", "i", "]", ",", "attrs", "[", "i", "+", "1", "]", ",", "attrs", "[", "i", "+", "2", "]", ",", "attrs", "[", "i", "+", "3", "]", ");", "i", "+", "=", "4", ";", "builder", ".", "setNameSpace", "(", "XAttrStatusFormat", ".", "getNamespace", "(", "v", ")", ");", "builder", ".", "setName", "(", "XAttrStatusFormat", ".", "getName", "(", "v", ")", ");", "builder", ".", "setNameSpace", "(", "XAttrFormat", ".", "getNamespace", "(", "v", ")", ");", "builder", ".", "setName", "(", "XAttrFormat", ".", "getName", "(", "v", ")", ");", "int", "vlen", "=", "(", "(", "0xff", "&", "attrs", "[", "i", "]", ")", "<", "<", "8", ")", "|", "(", "0xff", "&", "attrs", "[", "i", "+", "1", "]", ");", "i", "+", "=", "2", ";", "if", "(", "vlen", ">", "0", ")", "{", "@", "@", "-", "129", ",", "8", "+", "143", ",", "8", "@", "@", "static", "XAttr", "getXAttr", "(", "byte", "[", "]", "attrs", ",", "String", "prefixedName", ")", "{", "int", "v", "=", "Ints", ".", "fromBytes", "(", "attrs", "[", "i", "]", ",", "attrs", "[", "i", "+", "1", "]", ",", "attrs", "[", "i", "+", "2", "]", ",", "attrs", "[", "i", "+", "3", "]", ");", "i", "+", "=", "4", ";", "XAttr", ".", "NameSpace", "namespace", "=", "XAttrStatusFormat", ".", "getNamespace", "(", "v", ")", ";", "String", "name", "=", "XAttrStatusFormat", ".", "getName", "(", "v", ")", ";", "XAttr", ".", "NameSpace", "namespace", "=", "XAttrFormat", ".", "getNamespace", "(", "v", ")", ";", "String", "name", "=", "XAttrFormat", ".", "getName", "(", "v", ")", ";", "int", "vlen", "=", "(", "(", "0xff", "&", "attrs", "[", "i", "]", ")", "<", "<", "8", ")", "|", "(", "0xff", "&", "attrs", "[", "i", "+", "1", "]", ");", "i", "+", "=", "2", ";", "if", "(", "xAttr", ".", "getNameSpace", "(", ")", "=", "=", "namespace", "&", "&", "@", "@", "-", "161", ",", "7", "+", "175", ",", "8", "@", "@", "static", "XAttr", "getXAttr", "(", "byte", "[", "]", "attrs", ",", "String", "prefixedName", ")", "{", "ByteArrayOutputStream", "out", "=", "new", "ByteArrayOutputStream", "(", ");", "try", "{", "for", "(", "XAttr", "a", ":", "xAttrs", ")", "{", "int", "v", "=", "XAttrStatusFormat", ".", "toInt", "(", "a", ".", "getNameSpace", "(", "),", "a", ".", "getName", "(", "))", ";", "/", "/", "big", "-", "endian", "int", "v", "=", "XAttrFormat", ".", "toInt", "(", "a", ")", ";", "out", ".", "write", "(", "Ints", ".", "toByteArray", "(", "v", ")", ");", "int", "vlen", "=", "a", ".", "getValue", "(", ")", "=", "=", "null", "?", "0", ":", "a", ".", "getValue", "(", ").", "length", ";", "Preconditions", ".", "checkArgument", "(", "vlen", "<", "XATTR_VALUE_LEN_MAX", ",", "@", "@", "-", "31", ",", "17", "+", "31", ",", "6", "@", "@", "@", "InterfaceAudience", ".", "Private", "public", "class", "XAttrStorage", "{", "private", "static", "final", "SerialNumberMap", "<", "String", ">", "NAME_MAP", "=", "new", "SerialNumberMap", "<", ">(", ");", "public", "static", "int", "getNameSerialNumber", "(", "String", "name", ")", "{", "return", "NAME_MAP", ".", "get", "(", "name", ")", ";", "}", "public", "static", "String", "getName", "(", "int", "n", ")", "{", "return", "NAME_MAP", ".", "get", "(", "n", ")", ";", "}", "/", "**", "*", "Reads", "the", "extended", "attribute", "of", "an", "inode", "by", "name", "with", "prefix", ".", "*", "<", "p", "/", ">", "@", "@", "-", "51", ",", "6", "+", "51", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "FsImageProto", ".", "INodeSection", ".", "INode", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "INodeFile", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "INodeId", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "SerialNumberManager", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "web", ".", "JsonUtil", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "web", ".", "resources", ".", "XAttrEncodingParam", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "io", ".", "IOUtils", ";", "@", "@", "-", "67", ",", "7", "+", "68", ",", "7", "@", "@", "class", "FSImageLoader", "{", "public", "static", "final", "Log", "LOG", "=", "LogFactory", ".", "getLog", "(", "FSImageHandler", ".", "class", ")", ";", "private", "final", "String", "[", "]", "stringTable", ";", "private", "final", "SerialNumberManager", ".", "StringTable", "stringTable", ";", "/", "/", "byte", "representation", "of", "inodes", ",", "sorted", "by", "id", "private", "final", "byte", "[", "][", "]", "inodes", ";", "private", "final", "Map", "<", "Long", ",", "long", "[", "]>", "dirmap", ";", "@", "@", "-", "93", ",", "8", "+", "94", ",", "8", "@", "@", "public", "int", "compare", "(", "byte", "[", "]", "o1", ",", "byte", "[", "]", "o2", ")", "{", "}", "}", ";", "private", "FSImageLoader", "(", "String", "[", "]", "stringTable", ",", "byte", "[", "][", "]", "inodes", ",", "Map", "<", "Long", ",", "long", "[", "]>", "dirmap", ")", "{", "private", "FSImageLoader", "(", "SerialNumberManager", ".", "StringTable", "stringTable", ",", "byte", "[", "][", "]", "inodes", ",", "Map", "<", "Long", ",", "long", "[", "]>", "dirmap", ")", "{", "this", ".", "stringTable", "=", "stringTable", ";", "this", ".", "inodes", "=", "inodes", ";", "this", ".", "dirmap", "=", "dirmap", ";", "@", "@", "-", "119", ",", "7", "+", "120", ",", "7", "@", "@", "static", "FSImageLoader", "load", "(", "String", "inputFile", ")", "throws", "IOException", "{", "try", "(", "FileInputStream", "fin", "=", "new", "FileInputStream", "(", "file", ".", "getFD", "(", "))", ")", "{", "/", "/", "Map", "to", "record", "INodeReference", "to", "the", "referred", "id", "ImmutableList", "<", "Long", ">", "refIdList", "=", "null", ";", "String", "[", "]", "stringTable", "=", "null", ";", "SerialNumberManager", ".", "StringTable", "stringTable", "=", "null", ";", "byte", "[", "][", "]", "inodes", "=", "null", ";", "Map", "<", "Long", ",", "long", "[", "]>", "dirmap", "=", "null", ";", "@", "@", "-", "242", ",", "16", "+", "243", ",", "17", "@", "@", "public", "int", "compare", "(", "FsImageProto", ".", "FileSummary", ".", "Section", "s1", ",", "return", "inodes", ";", "}", "static", "String", "[", "]", "loadStringTable", "(", "InputStream", "in", ")", "throws", "IOException", "{", "static", "SerialNumberManager", ".", "StringTable", "loadStringTable", "(", "InputStream", "in", ")", "throws", "IOException", "{", "FsImageProto", ".", "StringTableSection", "s", "=", "FsImageProto", ".", "StringTableSection", ".", "parseDelimitedFrom", "(", "in", ")", ";", "LOG", ".", "info", "(", "\"", "Loading", "\"", "+", "s", ".", "getNumEntry", "(", ")", "+", "\"", "strings", "\"", ");", "String", "[", "]", "stringTable", "=", "new", "String", "[", "s", ".", "getNumEntry", "(", ")", "+", "1", "]", ";", "SerialNumberManager", ".", "StringTable", "stringTable", "=", "SerialNumberManager", ".", "newStringTable", "(", "s", ".", "getNumEntry", "(", "),", "s", ".", "getMaskBits", "(", "))", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "s", ".", "getNumEntry", "(", ");", "+", "+", "i", ")", "{", "FsImageProto", ".", "StringTableSection", ".", "Entry", "e", "=", "FsImageProto", ".", "StringTableSection", ".", "Entry", ".", "parseDelimitedFrom", "(", "in", ")", ";", "stringTable", "[", "e", ".", "getId", "(", ")]", "=", "e", ".", "getStr", "(", ");", "stringTable", ".", "put", "(", "e", ".", "getId", "(", "),", "e", ".", "getStr", "(", "))", ";", "}", "return", "stringTable", ";", "}", "@", "@", "-", "33", ",", "6", "+", "33", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "FsImageProto", ".", "INodeSection", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "FsImageProto", ".", "INodeSection", ".", "INode", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "INodeId", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "SerialNumberManager", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "io", ".", "IOUtils", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "util", ".", "LimitInputStream", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "util", ".", "Time", ";", "@", "@", "-", "391", ",", "7", "+", "392", ",", "7", "@", "@", "public", "void", "sync", "(", ")", "throws", "IOException", "{", "}", "}", "private", "String", "[", "]", "stringTable", ";", "private", "SerialNumberManager", ".", "StringTable", "stringTable", ";", "private", "PrintStream", "out", ";", "private", "MetadataMap", "metadataMap", "=", "null", ";", "@", "@", "-", "63", ",", "7", "+", "63", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "FsImageProto", ".", "SecretManagerSection", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "FsImageProto", ".", "SnapshotDiffSection", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "FsImageProto", ".", "SnapshotSection", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "FsImageProto", ".", "StringTableSection", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "SerialNumberManager", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "INodeFile", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "util", ".", "XMLUtils", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "io", ".", "erasurecode", ".", "ECSchema", ";", "@", "@", "-", "269", ",", "7", "+", "269", ",", "7", "@", "@", "private", "final", "Configuration", "conf", ";", "private", "final", "PrintStream", "out", ";", "private", "final", "SimpleDateFormat", "isoDateFormat", ";", "private", "String", "[", "]", "stringTable", ";", "private", "SerialNumberManager", ".", "StringTable", "stringTable", ";", "public", "static", "SimpleDateFormat", "createSimpleDateFormat", "(", ")", "{", "SimpleDateFormat", "format", "=", "@", "@", "-", "430", ",", "8", "+", "430", ",", "9", "@", "@", "private", "void", "dumpXattrs", "(", "INodeSection", ".", "XAttrFeatureProto", "xattrs", ")", "{", "(", "(", "XATTR_NAMESPACE_EXT_MASK", "&", "(", "encodedName", ">", ">", "XATTR_NAMESPACE_EXT_OFFSET", ")", ")", "<", "<", "2", ")", ";", "o", "(", "INODE_SECTION_NS", ",", "XAttrProtos", ".", "XAttrProto", ".", "XAttrNamespaceProto", ".", "valueOf", "(", "ns", ")", ".", "toString", "(", "))", ";", "o", "(", "SECTION_NAME", ",", "stringTable", "[", "XATTR_NAME_MASK", "&", "(", "encodedName", ">", ">", "XATTR_NAME_OFFSET", ")", "])", ";", "o", "(", "SECTION_NAME", ",", "SerialNumberManager", ".", "XATTR", ".", "getString", "(", "XATTR_NAME_MASK", "&", "(", "encodedName", ">", ">", "XATTR_NAME_OFFSET", ")", ",", "stringTable", ")", ");", "ByteString", "val", "=", "xattr", ".", "getValue", "(", ");", "if", "(", "val", ".", "isValidUtf8", "(", "))", "{", "o", "(", "INODE_SECTION_VAL", ",", "val", ".", "toStringUtf8", "(", "))", ";", "@", "@", "-", "784", ",", "10", "+", "785", ",", "9", "@", "@", "private", "void", "dumpSnapshotDiffSection", "(", "InputStream", "in", ")", "throws", "IOException", "{", ".", "o", "(", "SNAPSHOT_DIFF_SECTION_CHILDREN_SIZE", ",", "d", ".", "getChildrenSize", "(", "))", ".", "o", "(", "SNAPSHOT_DIFF_SECTION_IS_SNAPSHOT_ROOT", ",", "d", ".", "getIsSnapshotRoot", "(", "))", ".", "o", "(", "SECTION_NAME", ",", "d", ".", "getName", "(", ").", "toStringUtf8", "(", "))", ";", "INodeDirectory", "snapshotCopy", "=", "d", ".", "getSnapshotCopy", "(", ");", "if", "(", "snapshotCopy", "!", "=", "null", ")", "{", "if", "(", "d", ".", "hasSnapshotCopy", "(", "))", "{", "out", ".", "print", "(", "\"<", "\"", "+", "SNAPSHOT_DIFF_SECTION_SNAPSHOT_COPY", "+", "\"", ">\"", ");", "dumpINodeDirectory", "(", "snapshotCopy", ")", ";", "dumpINodeDirectory", "(", "d", ".", "getSnapshotCopy", "(", "))", ";", "out", ".", "print", "(", "\"<", "/\"", "+", "SNAPSHOT_DIFF_SECTION_SNAPSHOT_COPY", "+", "\"", ">\\", "n", "\"", ");", "}", "o", "(", "SNAPSHOT_DIFF_SECTION_CREATED_LIST_SIZE", ",", "d", ".", "getCreatedListSize", "(", "))", ";", "@", "@", "-", "851", ",", "13", "+", "851", ",", "7", "@", "@", "private", "void", "dumpSnapshotSection", "(", "InputStream", "in", ")", "throws", "IOException", "{", "}", "private", "void", "loadStringTable", "(", "InputStream", "in", ")", "throws", "IOException", "{", "StringTableSection", "s", "=", "StringTableSection", ".", "parseDelimitedFrom", "(", "in", ")", ";", "stringTable", "=", "new", "String", "[", "s", ".", "getNumEntry", "(", ")", "+", "1", "]", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "s", ".", "getNumEntry", "(", ");", "+", "+", "i", ")", "{", "StringTableSection", ".", "Entry", "e", "=", "StringTableSection", ".", "Entry", ".", "parseDelimitedFrom", "(", "in", ")", ";", "stringTable", "[", "e", ".", "getId", "(", ")]", "=", "e", ".", "getStr", "(", ");", "}", "stringTable", "=", "FSImageLoader", ".", "loadStringTable", "(", "in", ")", ";", "}", "private", "PBImageXmlWriter", "o", "(", "final", "String", "e", ",", "final", "Object", "v", ")", "{", "@", "@", "-", "311", ",", "6", "+", "311", ",", "7", "@", "@", "message", "StringTableSection", "{", "optional", "string", "str", "=", "2", ";", "}", "optional", "uint32", "numEntry", "=", "1", ";", "optional", "uint32", "maskBits", "=", "2", "[", "default", "=", "0", "]", ";", "/", "/", "repeated", "Entry", "}", "@", "@", "-", "57", ",", "12", "+", "57", ",", "8", "@", "@", "private", "FSNamesystem", "makeNameSystemSpy", "(", "Block", "block", ",", "INodeFile", "file", ")", "/", "/", "set", "file", "'", "s", "parent", "as", "root", "and", "put", "the", "file", "to", "inodeMap", ",", "so", "/", "/", "FSNamesystem", "'", "s", "isFileDeleted", "(", ")", "method", "will", "return", "false", "on", "this", "file", "if", "(", "file", ".", "getParent", "(", ")", "=", "=", "null", ")", "{", "INodeDirectory", "mparent", "=", "mock", "(", "INodeDirectory", ".", "class", ")", ";", "INodeDirectory", "parent", "=", "new", "INodeDirectory", "(", "mparent", ".", "getId", "(", "),", "new", "byte", "[", "0", "]", ",", "mparent", ".", "getPermissionStatus", "(", "),", "mparent", ".", "getAccessTime", "(", "))", ";", "parent", ".", "setLocalName", "(", "new", "byte", "[", "0", "]", ");", "INodeDirectory", "parent", "=", "namesystem", ".", "getFSDirectory", "(", ").", "getRoot", "(", ");", "parent", ".", "addChild", "(", "file", ")", ";", "file", ".", "setParent", "(", "parent", ")", ";", "}", "namesystem", ".", "dir", ".", "getINodeMap", "(", ").", "put", "(", "file", ")", ";"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "56", ",", "6", "+", "56", ",", "7", "@", "@", "enum", "IPSTATS_MIB_ECT1PKTS", ",", "/", "*", "InECT1Pkts", "*", "/", "IPSTATS_MIB_ECT0PKTS", ",", "/", "*", "InECT0Pkts", "*", "/", "IPSTATS_MIB_CEPKTS", ",", "/", "*", "InCEPkts", "*", "/", "IPSTATS_MIB_REASM_OVERLAPS", ",", "/", "*", "ReasmOverlaps", "*", "/", "__IPSTATS_MIB_MAX", "}", ";", "@", "@", "-", "277", ",", "6", "+", "277", ",", "7", "@", "@", "static", "int", "ip_frag_reinit", "(", "struct", "ipq", "*", "qp", ")", "/", "*", "Add", "new", "segment", "to", "existing", "queue", ".", "*", "/", "static", "int", "ip_frag_queue", "(", "struct", "ipq", "*", "qp", ",", "struct", "sk_buff", "*", "skb", ")", "{", "struct", "net", "*", "net", "=", "container_of", "(", "qp", "-", ">", "q", ".", "net", ",", "struct", "net", ",", "ipv4", ".", "frags", ")", ";", "struct", "sk_buff", "*", "prev", ",", "*", "next", ";", "struct", "net_device", "*", "dev", ";", "unsigned", "int", "fragsize", ";", "@", "@", "-", "357", ",", "65", "+", "358", ",", "23", "@", "@", "static", "int", "ip_frag_queue", "(", "struct", "ipq", "*", "qp", ",", "struct", "sk_buff", "*", "skb", ")", "}", "found", ":", "/", "*", "We", "found", "where", "to", "put", "this", "one", ".", "Check", "for", "overlap", "with", "*", "preceding", "fragment", ",", "and", ",", "if", "needed", ",", "align", "things", "so", "that", "*", "any", "overlaps", "are", "eliminated", ".", "/", "*", "RFC5722", ",", "Section", "4", ",", "amended", "by", "Errata", "ID", ":", "3089", "*", "When", "reassembling", "an", "IPv6", "datagram", ",", "if", "*", "one", "or", "more", "its", "constituent", "fragments", "is", "determined", "to", "be", "an", "*", "overlapping", "fragment", ",", "the", "entire", "datagram", "(", "and", "any", "constituent", "*", "fragments", ")", "MUST", "be", "silently", "discarded", ".", "*", "*", "We", "do", "the", "same", "here", "for", "IPv4", ".", "*", "/", "if", "(", "prev", ")", "{", "int", "i", "=", "(", "prev", "-", ">", "ip_defrag_offset", "+", "prev", "-", ">", "len", ")", "-", "offset", ";", "if", "(", "i", ">", "0", ")", "{", "offset", "+", "=", "i", ";", "err", "=", "-", "EINVAL", ";", "if", "(", "end", "<", "=", "offset", ")", "goto", "err", ";", "err", "=", "-", "ENOMEM", ";", "if", "(", "!", "pskb_pull", "(", "skb", ",", "i", ")", ")", "goto", "err", ";", "if", "(", "skb", "-", ">", "ip_summed", "!", "=", "CHECKSUM_UNNECESSARY", ")", "skb", "-", ">", "ip_summed", "=", "CHECKSUM_NONE", ";", "}", "}", "/", "*", "Is", "there", "an", "overlap", "with", "the", "previous", "fragment", "?", "*", "/", "if", "(", "prev", "&", "&", "(", "prev", "-", ">", "ip_defrag_offset", "+", "prev", "-", ">", "len", ")", ">", "offset", ")", "goto", "discard_qp", ";", "err", "=", "-", "ENOMEM", ";", "while", "(", "next", "&", "&", "next", "-", ">", "ip_defrag_offset", "<", "end", ")", "{", "int", "i", "=", "end", "-", "next", "-", ">", "ip_defrag_offset", ";", "/", "*", "overlap", "is", "'", "i", "'", "bytes", "*", "/", "if", "(", "i", "<", "next", "-", ">", "len", ")", "{", "int", "delta", "=", "-", "next", "-", ">", "truesize", ";", "/", "*", "Eat", "head", "of", "the", "next", "overlapped", "fragment", "*", "and", "leave", "the", "loop", ".", "The", "next", "ones", "cannot", "overlap", ".", "*", "/", "if", "(", "!", "pskb_pull", "(", "next", ",", "i", ")", ")", "goto", "err", ";", "delta", "+", "=", "next", "-", ">", "truesize", ";", "if", "(", "delta", ")", "add_frag_mem_limit", "(", "qp", "-", ">", "q", ".", "net", ",", "delta", ")", ";", "next", "-", ">", "ip_defrag_offset", "+", "=", "i", ";", "qp", "-", ">", "q", ".", "meat", "-", "=", "i", ";", "if", "(", "next", "-", ">", "ip_summed", "!", "=", "CHECKSUM_UNNECESSARY", ")", "next", "-", ">", "ip_summed", "=", "CHECKSUM_NONE", ";", "break", ";", "}", "else", "{", "struct", "sk_buff", "*", "free_it", "=", "next", ";", "/", "*", "Old", "fragment", "is", "completely", "overridden", "with", "*", "new", "one", "drop", "it", ".", "*", "/", "next", "=", "next", "-", ">", "next", ";", "if", "(", "prev", ")", "prev", "-", ">", "next", "=", "next", ";", "else", "qp", "-", ">", "q", ".", "fragments", "=", "next", ";", "qp", "-", ">", "q", ".", "meat", "-", "=", "free_it", "-", ">", "len", ";", "sub_frag_mem_limit", "(", "qp", "-", ">", "q", ".", "net", ",", "free_it", "-", ">", "truesize", ")", ";", "kfree_skb", "(", "free_it", ")", ";", "}", "}", "/", "*", "Is", "there", "an", "overlap", "with", "the", "next", "fragment", "?", "*", "/", "if", "(", "next", "&", "&", "next", "-", ">", "ip_defrag_offset", "<", "end", ")", "goto", "discard_qp", ";", "/", "*", "Note", ":", "skb", "-", ">", "ip_defrag_offset", "and", "skb", "-", ">", "dev", "share", "the", "same", "location", "*", "/", "dev", "=", "skb", "-", ">", "dev", ";", "@", "@", "-", "463", ",", "6", "+", "422", ",", "10", "@", "@", "static", "int", "ip_frag_queue", "(", "struct", "ipq", "*", "qp", ",", "struct", "sk_buff", "*", "skb", ")", "skb_dst_drop", "(", "skb", ")", ";", "return", "-", "EINPROGRESS", ";", "discard_qp", ":", "inet_frag_kill", "(", "&", "qp", "-", ">", "q", ")", ";", "err", "=", "-", "EINVAL", ";", "__IP_INC_STATS", "(", "net", ",", "IPSTATS_MIB_REASM_OVERLAPS", ")", ";", "err", ":", "kfree_skb", "(", "skb", ")", ";", "return", "err", ";", "@", "@", "-", "119", ",", "6", "+", "119", ",", "7", "@", "@", "static", "const", "struct", "snmp_mib", "snmp4_ipextstats_list", "[", "]", "=", "{", "SNMP_MIB_ITEM", "(", "\"", "InECT1Pkts", "\"", ",", "IPSTATS_MIB_ECT1PKTS", ")", ",", "SNMP_MIB_ITEM", "(", "\"", "InECT0Pkts", "\"", ",", "IPSTATS_MIB_ECT0PKTS", ")", ",", "SNMP_MIB_ITEM", "(", "\"", "InCEPkts", "\"", ",", "IPSTATS_MIB_CEPKTS", ")", ",", "SNMP_MIB_ITEM", "(", "\"", "ReasmOverlaps", "\"", ",", "IPSTATS_MIB_REASM_OVERLAPS", ")", ",", "SNMP_MIB_SENTINEL", "}", ";"], "docstring_tokens": ["sending", "specially", "crafted", "packets"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "11834", ",", "7", "+", "11834", ",", "7", "@", "@", "static", "int", "vmx_update_pi_irte", "(", "struct", "kvm", "*", "kvm", ",", "unsigned", "int", "host_irq", ",", "struct", "kvm_lapic_irq", "irq", ";", "struct", "kvm_vcpu", "*", "vcpu", ";", "struct", "vcpu_data", "vcpu_info", ";", "int", "idx", ",", "ret", "=", "-", "EINVAL", ";", "int", "idx", ",", "ret", "=", "0", ";", "if", "(", "!", "kvm_arch_has_assigned_device", "(", "kvm", ")", "|", "|", "!", "irq_remapping_cap", "(", "IRQ_POSTING_CAP", ")", "|", "|", "@", "@", "-", "11843", ",", "7", "+", "11843", ",", "12", "@", "@", "static", "int", "vmx_update_pi_irte", "(", "struct", "kvm", "*", "kvm", ",", "unsigned", "int", "host_irq", ",", "idx", "=", "srcu_read_lock", "(", "&", "kvm", "-", ">", "irq_srcu", ")", ";", "irq_rt", "=", "srcu_dereference", "(", "kvm", "-", ">", "irq_routing", ",", "&", "kvm", "-", ">", "irq_srcu", ")", ";", "BUG_ON", "(", "guest_irq", ">", "=", "irq_rt", "-", ">", "nr_rt_entries", ")", ";", "if", "(", "guest_irq", ">", "=", "irq_rt", "-", ">", "nr_rt_entries", "|", "|", "hlist_empty", "(", "&", "irq_rt", "-", ">", "map", "[", "guest_irq", "]", "))", "{", "pr_warn_once", "(", "\"", "no", "route", "for", "guest_irq", "%", "u", "/", "%", "u", "(", "broken", "user", "space", "?", ")\\", "n", "\"", ",", "guest_irq", ",", "irq_rt", "-", ">", "nr_rt_entries", ")", ";", "goto", "out", ";", "}", "hlist_for_each_entry", "(", "e", ",", "&", "irq_rt", "-", ">", "map", "[", "guest_irq", "]", ",", "link", ")", "{", "if", "(", "e", "-", ">", "type", "!", "=", "KVM_IRQ_ROUTING_MSI", ")"], "docstring_tokens": ["via", "an", "out-of", "bounds", "guest_irq", "value"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "50", ",", "14", "+", "50", ",", "14", "@", "@", "int", "inode_change_ok", "(", "const", "struct", "inode", "*", "inode", ",", "struct", "iattr", "*", "attr", ")", "if", "(", "(", "ia_valid", "&", "ATTR_UID", ")", "&", "&", "(", "!", "uid_eq", "(", "current_fsuid", "(", "),", "inode", "-", ">", "i_uid", ")", "|", "|", "!", "uid_eq", "(", "attr", "-", ">", "ia_uid", ",", "inode", "-", ">", "i_uid", ")", ")", "&", "&", "!", "inode_capable", "(", "inode", ",", "CAP_CHOWN", ")", ")", "!", "capable_wrt_inode_uidgid", "(", "inode", ",", "CAP_CHOWN", ")", ")", "return", "-", "EPERM", ";", "/", "*", "Make", "sure", "caller", "can", "chgrp", ".", "*", "/", "if", "(", "(", "ia_valid", "&", "ATTR_GID", ")", "&", "&", "(", "!", "uid_eq", "(", "current_fsuid", "(", "),", "inode", "-", ">", "i_uid", ")", "|", "|", "(", "!", "in_group_p", "(", "attr", "-", ">", "ia_gid", ")", "&", "&", "!", "gid_eq", "(", "attr", "-", ">", "ia_gid", ",", "inode", "-", ">", "i_gid", ")", "))", "&", "&", "!", "inode_capable", "(", "inode", ",", "CAP_CHOWN", ")", ")", "!", "capable_wrt_inode_uidgid", "(", "inode", ",", "CAP_CHOWN", ")", ")", "return", "-", "EPERM", ";", "/", "*", "Make", "sure", "a", "caller", "can", "chmod", ".", "*", "/", "@", "@", "-", "67", ",", "7", "+", "67", ",", "7", "@", "@", "int", "inode_change_ok", "(", "const", "struct", "inode", "*", "inode", ",", "struct", "iattr", "*", "attr", ")", "/", "*", "Also", "check", "the", "setgid", "bit", "!", "*", "/", "if", "(", "!", "in_group_p", "(", "(", "ia_valid", "&", "ATTR_GID", ")", "?", "attr", "-", ">", "ia_gid", ":", "inode", "-", ">", "i_gid", ")", "&", "&", "!", "inode_capable", "(", "inode", ",", "CAP_FSETID", ")", ")", "!", "capable_wrt_inode_uidgid", "(", "inode", ",", "CAP_FSETID", ")", ")", "attr", "-", ">", "ia_mode", "&", "=", "~", "S_ISGID", ";", "}", "@", "@", "-", "160", ",", "7", "+", "160", ",", "7", "@", "@", "void", "setattr_copy", "(", "struct", "inode", "*", "inode", ",", "const", "struct", "iattr", "*", "attr", ")", "umode_t", "mode", "=", "attr", "-", ">", "ia_mode", ";", "if", "(", "!", "in_group_p", "(", "inode", "-", ">", "i_gid", ")", "&", "&", "!", "inode_capable", "(", "inode", ",", "CAP_FSETID", ")", ")", "!", "capable_wrt_inode_uidgid", "(", "inode", ",", "CAP_FSETID", ")", ")", "mode", "&", "=", "~", "S_ISGID", ";", "inode", "-", ">", "i_mode", "=", "mode", ";", "}", "@", "@", "-", "1839", ",", "14", "+", "1839", ",", "18", "@", "@", "EXPORT_SYMBOL", "(", "inode_init_owner", ")", ";", "*", "inode_owner_or_capable", "-", "check", "current", "task", "permissions", "to", "inode", "*", "@", "inode", ":", "inode", "being", "checked", "*", "*", "Return", "true", "if", "current", "either", "has", "CAP_FOWNER", "to", "the", "inode", ",", "or", "*", "owns", "the", "file", ".", "*", "Return", "true", "if", "current", "either", "has", "CAP_FOWNER", "in", "a", "namespace", "with", "the", "*", "inode", "owner", "uid", "mapped", ",", "or", "owns", "the", "file", ".", "*", "/", "bool", "inode_owner_or_capable", "(", "const", "struct", "inode", "*", "inode", ")", "{", "struct", "user_namespace", "*", "ns", ";", "if", "(", "uid_eq", "(", "current_fsuid", "(", "),", "inode", "-", ">", "i_uid", ")", ")", "return", "true", ";", "if", "(", "inode_capable", "(", "inode", ",", "CAP_FOWNER", ")", ")", "ns", "=", "current_user_ns", "(", ");", "if", "(", "ns_capable", "(", "ns", ",", "CAP_FOWNER", ")", "&", "&", "kuid_has_mapping", "(", "ns", ",", "inode", "-", ">", "i_uid", ")", ")", "return", "true", ";", "return", "false", ";", "}", "@", "@", "-", "332", ",", "10", "+", "332", ",", "11", "@", "@", "int", "generic_permission", "(", "struct", "inode", "*", "inode", ",", "int", "mask", ")", "if", "(", "S_ISDIR", "(", "inode", "-", ">", "i_mode", ")", ")", "{", "/", "*", "DACs", "are", "overridable", "for", "directories", "*", "/", "if", "(", "inode_capable", "(", "inode", ",", "CAP_DAC_OVERRIDE", ")", ")", "if", "(", "capable_wrt_inode_uidgid", "(", "inode", ",", "CAP_DAC_OVERRIDE", ")", ")", "return", "0", ";", "if", "(", "!(", "mask", "&", "MAY_WRITE", ")", ")", "if", "(", "inode_capable", "(", "inode", ",", "CAP_DAC_READ_SEARCH", ")", ")", "if", "(", "capable_wrt_inode_uidgid", "(", "inode", ",", "CAP_DAC_READ_SEARCH", ")", ")", "return", "0", ";", "return", "-", "EACCES", ";", "}", "@", "@", "-", "345", ",", "15", "+", "346", ",", "15", "@", "@", "int", "generic_permission", "(", "struct", "inode", "*", "inode", ",", "int", "mask", ")", "*", "at", "least", "one", "exec", "bit", "set", ".", "*", "/", "if", "(", "!(", "mask", "&", "MAY_EXEC", ")", "|", "|", "(", "inode", "-", ">", "i_mode", "&", "S_IXUGO", ")", ")", "if", "(", "inode_capable", "(", "inode", ",", "CAP_DAC_OVERRIDE", ")", ")", "if", "(", "capable_wrt_inode_uidgid", "(", "inode", ",", "CAP_DAC_OVERRIDE", ")", ")", "return", "0", ";", "/", "*", "*", "Searching", "includes", "executable", "on", "directories", ",", "else", "just", "read", ".", "*", "/", "mask", "&", "=", "MAY_READ", "|", "MAY_WRITE", "|", "MAY_EXEC", ";", "if", "(", "mask", "=", "=", "MAY_READ", ")", "if", "(", "inode_capable", "(", "inode", ",", "CAP_DAC_READ_SEARCH", ")", ")", "if", "(", "capable_wrt_inode_uidgid", "(", "inode", ",", "CAP_DAC_READ_SEARCH", ")", ")", "return", "0", ";", "return", "-", "EACCES", ";", "@", "@", "-", "2379", ",", "7", "+", "2380", ",", "7", "@", "@", "static", "inline", "int", "check_sticky", "(", "struct", "inode", "*", "dir", ",", "struct", "inode", "*", "inode", ")", "return", "0", ";", "if", "(", "uid_eq", "(", "dir", "-", ">", "i_uid", ",", "fsuid", ")", ")", "return", "0", ";", "return", "!", "inode_capable", "(", "inode", ",", "CAP_FOWNER", ")", ";", "return", "!", "capable_wrt_inode_uidgid", "(", "inode", ",", "CAP_FOWNER", ")", ";", "}", "/", "*", "@", "@", "-", "1215", ",", "7", "+", "1215", ",", "7", "@", "@", "xfs_ioctl_setattr", "(", "*", "cleared", "upon", "successful", "return", "from", "chown", "(", ")", "*", "/", "if", "(", "(", "ip", "-", ">", "i_d", ".", "di_mode", "&", "(", "S_ISUID", "|", "S_ISGID", ")", ")", "&", "&", "!", "inode_capable", "(", "VFS_I", "(", "ip", ")", ",", "CAP_FSETID", ")", ")", "!", "capable_wrt_inode_uidgid", "(", "VFS_I", "(", "ip", ")", ",", "CAP_FSETID", ")", ")", "ip", "-", ">", "i_d", ".", "di_mode", "&", "=", "~", "(", "S_ISUID", "|", "S_ISGID", ")", ";", "/", "*", "@", "@", "-", "210", ",", "7", "+", "210", ",", "7", "@", "@", "extern", "bool", "has_ns_capability_noaudit", "(", "struct", "task_struct", "*", "t", ",", "struct", "user_namespace", "*", "ns", ",", "int", "cap", ")", ";", "extern", "bool", "capable", "(", "int", "cap", ")", ";", "extern", "bool", "ns_capable", "(", "struct", "user_namespace", "*", "ns", ",", "int", "cap", ")", ";", "extern", "bool", "inode_capable", "(", "const", "struct", "inode", "*", "inode", ",", "int", "cap", ")", ";", "extern", "bool", "capable_wrt_inode_uidgid", "(", "const", "struct", "inode", "*", "inode", ",", "int", "cap", ")", ";", "extern", "bool", "file_ns_capable", "(", "const", "struct", "file", "*", "file", ",", "struct", "user_namespace", "*", "ns", ",", "int", "cap", ")", ";", "/", "*", "audit", "system", "wants", "to", "get", "cap", "info", "from", "files", "as", "well", "*", "/", "@", "@", "-", "424", ",", "23", "+", "424", ",", "19", "@", "@", "bool", "capable", "(", "int", "cap", ")", "EXPORT_SYMBOL", "(", "capable", ")", ";", "/", "**", "*", "inode_capable", "-", "Check", "superior", "capability", "over", "inode", "*", "capable_wrt_inode_uidgid", "-", "Check", "nsown_capable", "and", "uid", "and", "gid", "mapped", "*", "@", "inode", ":", "The", "inode", "in", "question", "*", "@", "cap", ":", "The", "capability", "in", "question", "*", "*", "Return", "true", "if", "the", "current", "task", "has", "the", "given", "superior", "capability", "*", "targeted", "at", "it", "'", "s", "own", "user", "namespace", "and", "that", "the", "given", "inode", "is", "owned", "*", "by", "the", "current", "user", "namespace", "or", "a", "child", "namespace", ".", "*", "*", "Currently", "we", "check", "to", "see", "if", "an", "inode", "is", "owned", "by", "the", "current", "*", "user", "namespace", "by", "seeing", "if", "the", "inode", "'", "s", "owner", "maps", "into", "the", "*", "current", "user", "namespace", ".", "*", "*", "Return", "true", "if", "the", "current", "task", "has", "the", "given", "capability", "targeted", "at", "*", "its", "own", "user", "namespace", "and", "that", "the", "given", "inode", "'", "s", "uid", "and", "gid", "are", "*", "mapped", "into", "the", "current", "user", "namespace", ".", "*", "/", "bool", "inode_capable", "(", "const", "struct", "inode", "*", "inode", ",", "int", "cap", ")", "bool", "capable_wrt_inode_uidgid", "(", "const", "struct", "inode", "*", "inode", ",", "int", "cap", ")", "{", "struct", "user_namespace", "*", "ns", "=", "current_user_ns", "(", ");", "return", "ns_capable", "(", "ns", ",", "cap", ")", "&", "&", "kuid_has_mapping", "(", "ns", ",", "inode", "-", ">", "i_uid", ")", ";", "return", "ns_capable", "(", "ns", ",", "cap", ")", "&", "&", "kuid_has_mapping", "(", "ns", ",", "inode", "-", ">", "i_uid", ")", "&", "&", "kgid_has_mapping", "(", "ns", ",", "inode", "-", ">", "i_gid", ")", ";", "}", "EXPORT_SYMBOL", "(", "inode_capable", ")", ";", "EXPORT_SYMBOL", "(", "capable_wrt_inode_uidgid", ")", ";"], "docstring_tokens": ["by", "first", "creating", "a", "user", "namespace"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "40", ",", "6", "+", "40", ",", "7", "@", "@", "public", "void", "migrate", "(", "KeycloakSession", "session", ")", "{", "Map", "<", "String", ",", "String", ">", "browserSecurityHeaders", "=", "new", "HashMap", "<", ">(", "realm", ".", "getBrowserSecurityHeaders", "(", "))", ";", "browserSecurityHeaders", ".", "put", "(", "\"", "xRobotsTag", "\"", ",", "\"", "none", "\"", ");", "browserSecurityHeaders", ".", "put", "(", "\"", "xXSSProtection", "\"", ",", "\"", "1", ";", "mode", "=", "block", "\"", ");", "realm", ".", "setBrowserSecurityHeaders", "(", "Collections", ".", "unmodifiableMap", "(", "browserSecurityHeaders", ")", ");", "}", "@", "@", "-", "35", ",", "12", "+", "35", ",", "14", "@", "@", "headerMap", ".", "put", "(", "\"", "contentSecurityPolicy", "\"", ",", "\"", "Content", "-", "Security", "-", "Policy", "\"", ");", "headerMap", ".", "put", "(", "\"", "xContentTypeOptions", "\"", ",", "\"", "X", "-", "Content", "-", "Type", "-", "Options", "\"", ");", "headerMap", ".", "put", "(", "\"", "xRobotsTag", "\"", ",", "\"", "X", "-", "Robots", "-", "Tag", "\"", ");", "headerMap", ".", "put", "(", "\"", "xXSSProtection", "\"", ",", "\"", "X", "-", "XSS", "-", "Protection", "\"", ");", "Map", "<", "String", ",", "String", ">", "dh", "=", "new", "HashMap", "<", ">(", ");", "dh", ".", "put", "(", "\"", "xFrameOptions", "\"", ",", "\"", "SAMEORIGIN", "\"", ");", "dh", ".", "put", "(", "\"", "contentSecurityPolicy", "\"", ",", "\"", "frame", "-", "src", "'", "self", "'", "\")", ";", "dh", ".", "put", "(", "\"", "xContentTypeOptions", "\"", ",", "\"", "nosniff", "\"", ");", "dh", ".", "put", "(", "\"", "xRobotsTag", "\"", ",", "\"", "none", "\"", ");", "dh", ".", "put", "(", "\"", "xXSSProtection", "\"", ",", "\"", "1", ";", "mode", "=", "block", "\"", ");", "defaultHeaders", "=", "Collections", ".", "unmodifiableMap", "(", "dh", ")", ";", "headerAttributeMap", "=", "Collections", ".", "unmodifiableMap", "(", "headerMap", ")", ";", "@", "@", "-", "124", ",", "6", "+", "124", ",", "8", "@", "@", "content", "-", "type", "-", "options", "=", "X", "-", "Content", "-", "Type", "-", "Options", "content", "-", "type", "-", "options", "-", "tooltip", "=", "Default", "value", "prevents", "Internet", "Explorer", "and", "Google", "Chrome", "from", "MIME", "-", "sniffing", "a", "response", "away", "from", "the", "declared", "content", "-", "type", "(", "click", "label", "for", "more", "information", ")", "robots", "-", "tag", "=", "X", "-", "Robots", "-", "Tag", "robots", "-", "tag", "-", "tooltip", "=", "Prevent", "pages", "from", "appearing", "in", "search", "engines", "(", "click", "label", "for", "more", "information", ")", "x", "-", "xss", "-", "protection", "=", "X", "-", "XSS", "-", "Protection", "x", "-", "xss", "-", "protection", "-", "tooltip", "=", "This", "header", "configures", "the", "Cross", "-", "site", "scripting", "(", "XSS", ")", "filter", "in", "your", "browser", ".", "Using", "the", "default", "behavior", ",", "the", "browser", "will", "prevent", "rendering", "of", "the", "page", "when", "a", "XSS", "attack", "is", "detected", "(", "click", "label", "for", "more", "information", ")", "max", "-", "login", "-", "failures", "=", "Max", "Login", "Failures", "max", "-", "login", "-", "failures", ".", "tooltip", "=", "How", "many", "failures", "before", "wait", "is", "triggered", ".", "wait", "-", "increment", "=", "Wait", "Increment", "@", "@", "-", "36", ",", "6", "+", "36", ",", "13", "@", "@", "<", "/", "div", ">", "<", "kc", "-", "tooltip", ">", "{{", "::", "'", "robots", "-", "tag", "-", "tooltip", "'", "|", "translate", "}", "}<", "/", "kc", "-", "tooltip", ">", "<", "/", "div", ">", "<", "div", "class", "=", "\"", "form", "-", "group", "\"", ">", "<", "label", "class", "=", "\"", "col", "-", "md", "-", "2", "control", "-", "label", "\"", "for", "=", "\"", "xXSSProtection", "\"", "><", "a", "href", "=", "\"", "https", ":", "//", "www", ".", "owasp", ".", "org", "/", "index", ".", "php", "/", "OWASP_Secure_Headers_Project", "#", "xxxsp", "\"", "target", "=", "\"", "_blank", "\"", ">{", "{:", ":", "'", "x", "-", "xss", "-", "protection", "'", "|", "translate", "}", "}<", "/", "a", ">", "</", "label", ">", "<", "div", "class", "=", "\"", "col", "-", "sm", "-", "6", "\"", ">", "<", "input", "class", "=", "\"", "form", "-", "control", "\"", "id", "=", "\"", "xXSSProtection", "\"", "type", "=", "\"", "text", "\"", "ng", "-", "model", "=", "\"", "realm", ".", "browserSecurityHeaders", ".", "xXSSProtection", "\"", ">", "<", "/", "div", ">", "<", "kc", "-", "tooltip", ">", "{{", "::", "'", "x", "-", "xss", "-", "protection", "-", "tooltip", "'", "|", "translate", "}", "}<", "/", "kc", "-", "tooltip", ">", "<", "/", "div", ">", "<", "/", "fieldset", ">", "<", "div", "class", "=", "\"", "form", "-", "group", "\"", "data", "-", "ng", "-", "show", "=", "\"", "access", ".", "manageRealm", "\"", ">", "<", "div", "class", "=", "\"", "col", "-", "md", "-", "10", "col", "-", "md", "-", "offset", "-", "2", "\"", ">"], "docstring_tokens": ["via", "a", "malicious", "server", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "29", ",", "7", "+", "29", ",", "7", "@", "@", "<", "parent", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", "<", "/", "groupId", ">", "<", "artifactId", ">", "plugin", "<", "/", "artifactId", ">", "<", "version", ">", "2", ".", "21", "<", "/", "version", ">", "<", "version", ">", "3", ".", "17", "<", "/", "version", ">", "<", "relativePath", "/", ">", "<", "/", "parent", ">", "@", "@", "-", "55", ",", "10", "+", "55", ",", "6", "@", "@", "<", "/", "developer", ">", "<", "/", "developers", ">", "<", "prerequisites", ">", "<", "maven", ">", "2", ".", "2", ".", "1", "<", "/", "maven", ">", "<", "/", "prerequisites", ">", "<", "scm", ">", "<", "connection", ">", "scm", ":", "git", ":", "git", ":", "//", "github", ".", "com", "/", "jenkinsci", "/", "ssh", "-", "agent", "-", "plugin", ".", "git", "<", "/", "connection", ">", "<", "developerConnection", ">", "scm", ":", "git", ":", "git", "@", "github", ".", "com", ":", "jenkinsci", "/", "ssh", "-", "agent", "-", "plugin", ".", "git", "<", "/", "developerConnection", ">", "@", "@", "-", "67", ",", "9", "+", "63", ",", "9", "@", "@", "<", "/", "scm", ">", "<", "properties", ">", "<", "jenkins", ".", "version", ">", "1", ".", "609", ".", "3", "<", "/", "jenkins", ".", "version", ">", "<", "java", ".", "level", ">", "7", "<", "/", "java", ".", "level", ">", "<", "!-", "-", "sshd", "-", "core", "is", "7", "+", "-", "->", "<", "workflow", "-", "jenkins", "-", "plugin", ".", "version", ">", "1", ".", "14", ".", "2", "<", "/", "workflow", "-", "jenkins", "-", "plugin", ".", "version", ">", "<", "jenkins", ".", "version", ">", "2", ".", "60", ".", "3", "<", "/", "jenkins", ".", "version", ">", "<", "java", ".", "level", ">", "8", "<", "/", "java", ".", "level", ">", "<", "workflow", "-", "support", "-", "plugin", ".", "version", ">", "2", ".", "18", "<", "/", "workflow", "-", "support", "-", "plugin", ".", "version", ">", "<", "/", "properties", ">", "<", "repositories", ">", "@", "@", "-", "97", ",", "18", "+", "93", ",", "6", "@", "@", "<", "artifactId", ">", "tomcat", "-", "apr", "<", "/", "artifactId", ">", "<", "version", ">", "5", ".", "5", ".", "23", "<", "/", "version", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "slf4j", "<", "/", "groupId", ">", "<", "artifactId", ">", "slf4j", "-", "api", "<", "/", "artifactId", ">", "<", "version", ">", "1", ".", "7", ".", "7", "<", "/", "version", ">", "<", "scope", ">", "provided", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "slf4j", "<", "/", "groupId", ">", "<", "artifactId", ">", "slf4j", "-", "jdk14", "<", "/", "artifactId", ">", "<", "version", ">", "1", ".", "7", ".", "7", "<", "/", "version", ">", "<", "scope", ">", "provided", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "com", ".", "cloudbees", ".", "util", "<", "/", "groupId", ">", "<", "artifactId", ">", "jnr", "-", "unixsocket", "-", "nodep", "<", "/", "artifactId", ">", "@", "@", "-", "117", ",", "72", "+", "101", ",", "103", "@", "@", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", ".", "workflow", "<", "/", "groupId", ">", "<", "artifactId", ">", "workflow", "-", "step", "-", "api", "<", "/", "artifactId", ">", "<", "version", ">", "${", "workflow", "-", "jenkins", "-", "plugin", ".", "version", "}", "</", "version", ">", "<", "version", ">", "2", ".", "16", "<", "/", "version", ">", "<", "/", "dependency", ">", "<", "!-", "-", "plugin", "dependencies", "-", "->", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", "<", "/", "groupId", ">", "<", "artifactId", ">", "credentials", "<", "/", "artifactId", ">", "<", "version", ">", "2", ".", "1", ".", "1", "<", "/", "version", ">", "<", "version", ">", "2", ".", "1", ".", "17", "<", "/", "version", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", "<", "/", "groupId", ">", "<", "artifactId", ">", "ssh", "-", "credentials", "<", "/", "artifactId", ">", "<", "version", ">", "1", ".", "11", "<", "/", "version", ">", "<", "version", ">", "1", ".", "14", "<", "/", "version", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", "<", "/", "groupId", ">", "<", "artifactId", ">", "bouncycastle", "-", "api", "<", "/", "artifactId", ">", "<", "version", ">", "1", ".", "0", ".", "2", "<", "/", "version", ">", "<", "version", ">", "2", ".", "16", ".", "3", "<", "/", "version", ">", "<", "/", "dependency", ">", "<", "!-", "-", "jenkins", "dependencies", "-", "->", "<", "!-", "-", "test", "dependencies", "-", "->", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", ".", "workflow", "<", "/", "groupId", ">", "<", "artifactId", ">", "workflow", "-", "api", "<", "/", "artifactId", ">", "<", "version", ">", "2", ".", "27", "<", "/", "version", ">", "<", "scope", ">", "test", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", ".", "workflow", "<", "/", "groupId", ">", "<", "artifactId", ">", "workflow", "-", "job", "<", "/", "artifactId", ">", "<", "version", ">", "${", "workflow", "-", "jenkins", "-", "plugin", ".", "version", "}", "</", "version", ">", "<", "version", ">", "2", ".", "12", ".", "2", "<", "/", "version", ">", "<", "scope", ">", "test", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", ".", "workflow", "<", "/", "groupId", ">", "<", "artifactId", ">", "workflow", "-", "basic", "-", "steps", "<", "/", "artifactId", ">", "<", "version", ">", "${", "workflow", "-", "jenkins", "-", "plugin", ".", "version", "}", "</", "version", ">", "<", "version", ">", "2", ".", "8", "<", "/", "version", ">", "<", "scope", ">", "test", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", ".", "workflow", "<", "/", "groupId", ">", "<", "artifactId", ">", "workflow", "-", "durable", "-", "task", "-", "step", "<", "/", "artifactId", ">", "<", "version", ">", "${", "workflow", "-", "jenkins", "-", "plugin", ".", "version", "}", "</", "version", ">", "<", "version", ">", "2", ".", "19", "<", "/", "version", ">", "<", "scope", ">", "test", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", ".", "workflow", "<", "/", "groupId", ">", "<", "artifactId", ">", "workflow", "-", "cps", "<", "/", "artifactId", ">", "<", "version", ">", "${", "workflow", "-", "jenkins", "-", "plugin", ".", "version", "}", "</", "version", ">", "<", "version", ">", "2", ".", "45", "<", "/", "version", ">", "<", "scope", ">", "test", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", ".", "workflow", "<", "/", "groupId", ">", "<", "artifactId", ">", "workflow", "-", "support", "<", "/", "artifactId", ">", "<", "version", ">", "${", "workflow", "-", "jenkins", "-", "plugin", ".", "version", "}", "</", "version", ">", "<", "version", ">", "${", "workflow", "-", "support", "-", "plugin", ".", "version", "}", "</", "version", ">", "<", "scope", ">", "test", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", ".", "workflow", "<", "/", "groupId", ">", "<", "artifactId", ">", "workflow", "-", "support", "<", "/", "artifactId", ">", "<", "version", ">", "${", "workflow", "-", "support", "-", "plugin", ".", "version", "}", "</", "version", ">", "<", "classifier", ">", "tests", "<", "/", "classifier", ">", "<", "scope", ">", "test", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "!-", "-", "TODO", "Jenkins", "sshd", "(", "1", ".", "6", ")", "depends", "on", "sshd", "-", "core", "0", ".", "8", ",", "which", "is", "incompatible", "with", "1", ".", "0", "-", "->", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "main", "<", "/", "groupId", ">", "<", "artifactId", ">", "jenkins", "-", "war", "<", "/", "artifactId", ">", "<", "version", ">", "${", "jenkins", ".", "version", "}", "</", "version", ">", "<", "classifier", ">", "war", "-", "for", "-", "test", "<", "/", "classifier", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", "<", "/", "groupId", ">", "<", "artifactId", ">", "docker", "-", "workflow", "<", "/", "artifactId", ">", "<", "version", ">", "1", ".", "17", "<", "/", "version", ">", "<", "scope", ">", "test", "<", "/", "scope", ">", "<", "exclusions", ">", "<", "exclusion", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "modules", "<", "/", "groupId", ">", "<", "artifactId", ">", "sshd", "<", "/", "artifactId", ">", "<", "/", "exclusion", ">", "<", "/", "exclusions", ">", "<", "/", "dependency", ">", "<", "/", "dependencies", ">", "<", "dependencyManagement", ">", "<", "dependencies", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", "<", "/", "groupId", ">", "<", "artifactId", ">", "structs", "<", "/", "artifactId", ">", "<", "version", ">", "1", ".", "14", "<", "/", "version", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", "<", "/", "groupId", ">", "<", "artifactId", ">", "symbol", "-", "annotation", "<", "/", "artifactId", ">", "<", "version", ">", "1", ".", "14", "<", "/", "version", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", "<", "/", "groupId", ">", "<", "artifactId", ">", "script", "-", "security", "<", "/", "artifactId", ">", "<", "version", ">", "1", ".", "44", "<", "/", "version", ">", "<", "scope", ">", "test", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "jenkins", "-", "ci", ".", "plugins", "<", "/", "groupId", ">", "<", "artifactId", ">", "scm", "-", "api", "<", "/", "artifactId", ">", "<", "version", ">", "2", ".", "2", ".", "7", "<", "/", "version", ">", "<", "scope", ">", "test", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "/", "dependencies", ">", "<", "/", "dependencyManagement", ">", "<", "build", ">", "<", "plugins", ">", "@", "@", "-", "63", ",", "7", "+", "63", ",", "7", "@", "@", "public", "boolean", "start", "(", ")", "throws", "Exception", "{", "initRemoteAgent", "(", ");", "context", ".", "newBodyInvoker", "(", ").", "withContext", "(", "EnvironmentExpander", ".", "merge", "(", "getContext", "(", ").", "get", "(", "EnvironmentExpander", ".", "class", ")", ",", "new", "ExpanderImpl", "(", "this", ")", "))", ".", "withCallback", "(", "new", "Callback", "(", "this", ")", ").", "withDisplayName", "(", "null", ")", ".", "start", "(", ");", "withCallback", "(", "new", "Callback", "(", "this", ")", ").", "start", "(", ");", "return", "false", ";", "}", "@", "@", "-", "105", ",", "7", "+", "105", ",", "11", "@", "@", "public", "void", "addIdentity", "(", "String", "privateKey", ",", "final", "String", "passphrase", ",", "String", "comme", "env", ".", "put", "(", "\"", "DISPLAY", "\"", ",", "\"", ":", "0", "\"", ");", "/", "/", "just", "to", "force", "using", "SSH_ASKPASS", "env", ".", "put", "(", "\"", "SSH_ASKPASS", "\"", ",", "askpass", ".", "getRemote", "(", "))", ";", "}", "if", "(", "launcher", ".", "launch", "(", ").", "cmds", "(", "\"", "ssh", "-", "add", "\"", ",", "keyFile", ".", "getRemote", "(", "))", ".", "envs", "(", "env", ")", ".", "stdout", "(", "listener", ")", ".", "start", "(", ").", "joinWithTimeout", "(", "1", ",", "TimeUnit", ".", "MINUTES", ",", "listener", ")", "!", "=", "0", ")", "{", "/", "/", "as", "the", "next", "command", "is", "in", "quiet", "mode", ",", "we", "just", "add", "a", "message", "to", "the", "log", "launcher", ".", "getListener", "(", ").", "getLogger", "(", ").", "println", "(", "\"", "Running", "ssh", "-", "add", "(", "command", "line", "suppressed", ")", "\")", ";", "if", "(", "launcher", ".", "launch", "(", ").", "quiet", "(", "true", ")", ".", "cmds", "(", "\"", "ssh", "-", "add", "\"", ",", "keyFile", ".", "getRemote", "(", "))", ".", "envs", "(", "env", ")", ".", "stdout", "(", "listener", ")", ".", "start", "(", ").", "joinWithTimeout", "(", "1", ",", "TimeUnit", ".", "MINUTES", ",", "listener", ")", "!", "=", "0", ")", "{", "throw", "new", "AbortException", "(", "\"", "Failed", "to", "run", "ssh", "-", "add", "\"", ");", "}", "}", "finally", "{", "@", "@", "-", "5", ",", "10", "+", "5", ",", "10", "@", "@", "import", "com", ".", "cloudbees", ".", "plugins", ".", "credentials", ".", "CredentialsProvider", ";", "import", "com", ".", "cloudbees", ".", "plugins", ".", "credentials", ".", "CredentialsScope", ";", "import", "com", ".", "cloudbees", ".", "plugins", ".", "credentials", ".", "SystemCredentialsProvider", ";", "import", "com", ".", "cloudbees", ".", "plugins", ".", "credentials", ".", "domains", ".", "Domain", ";", "import", "hudson", ".", "Util", ";", "import", "hudson", ".", "Launcher", ";", "import", "hudson", ".", "model", ".", "Fingerprint", ";", "import", "hudson", ".", "util", ".", "Secret", ";", "import", "hudson", ".", "util", ".", "StreamTaskListener", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "workflow", ".", "cps", ".", "CpsFlowDefinition", ";", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "workflow", ".", "cps", ".", "CpsFlowExecution", ";", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "workflow", ".", "job", ".", "WorkflowJob", ";", "@", "@", "-", "26", ",", "14", "+", "26", ",", "17", "@", "@", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Scanner", ";", "import", "java", ".", "util", ".", "regex", ".", "Matcher", ";", "import", "java", ".", "util", ".", "concurrent", ".", "TimeUnit", ";", "import", "java", ".", "util", ".", "regex", ".", "Pattern", ";", "import", "static", "org", ".", "hamcrest", ".", "CoreMatchers", ".", "is", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "is", ";", "import", "static", "org", ".", "hamcrest", ".", "core", ".", "IsCollectionContaining", ".", "hasItem", ";", "import", "static", "org", ".", "hamcrest", ".", "core", ".", "IsNull", ".", "notNullValue", ";", "import", "static", "org", ".", "hamcrest", ".", "core", ".", "IsNull", ".", "nullValue", ";", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "docker", ".", "commons", ".", "tools", ".", "DockerTool", ";", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "docker", ".", "workflow", ".", "client", ".", "DockerClient", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*;", "import", "static", "org", ".", "junit", ".", "Assume", ".", "*;", "public", "class", "SSHAgentStepWorkflowTest", "extends", "SSHAgentBase", "{", "@", "@", "-", "191", ",", "4", "+", "194", ",", "41", "@", "@", "public", "void", "evaluate", "(", ")", "throws", "Throwable", "{", "}", "}", ");", "}", "@", "Issue", "(", "\"", "SECURITY", "-", "704", "\"", ")", "@", "Test", "public", "void", "sshAgentDocker", "(", ")", "throws", "Exception", "{", "story", ".", "then", "(", "r", "-", ">", "{", "/", "/", "From", "org", ".", "jenkinsci", ".", "plugins", ".", "docker", ".", "workflow", ".", "DockerTestUtil", ":", "Launcher", ".", "LocalLauncher", "localLauncher", "=", "new", "Launcher", ".", "LocalLauncher", "(", "StreamTaskListener", ".", "NULL", ")", ";", "try", "{", "assumeThat", "(", "\"", "Docker", "working", "\"", ",", "localLauncher", ".", "launch", "(", ").", "cmds", "(", "DockerTool", ".", "getExecutable", "(", "null", ",", "null", ",", "null", ",", "null", ")", ",", "\"", "ps", "\"", ").", "start", "(", ").", "joinWithTimeout", "(", "DockerClient", ".", "CLIENT_TIMEOUT", ",", "TimeUnit", ".", "SECONDS", ",", "localLauncher", ".", "getListener", "(", "))", ",", "is", "(", "0", ")", ");", "}", "catch", "(", "IOException", "x", ")", "{", "assumeNoException", "(", "\"", "have", "Docker", "installed", "\"", ",", "x", ")", ";", "}", "List", "<", "String", ">", "credentialIds", "=", "new", "ArrayList", "<", "String", ">", "()", ";", "credentialIds", ".", "add", "(", "CREDENTIAL_ID", ")", ";", "SSHUserPrivateKey", "key", "=", "new", "BasicSSHUserPrivateKey", "(", "CredentialsScope", ".", "GLOBAL", ",", "credentialIds", ".", "get", "(", "0", ")", ",", "\"", "x", "\"", ",", "new", "BasicSSHUserPrivateKey", ".", "DirectEntryPrivateKeySource", "(", "getPrivateKey", "(", "))", ",", "\"", "cloudbees", "\"", ",", "\"", "test", "\"", ");", "SystemCredentialsProvider", ".", "getInstance", "(", ").", "getCredentials", "(", ").", "add", "(", "key", ")", ";", "SystemCredentialsProvider", ".", "getInstance", "(", ").", "save", "(", ");", "WorkflowJob", "job", "=", "r", ".", "createProject", "(", "WorkflowJob", ".", "class", ",", "\"", "sshAgentDocker", "\"", ");", "job", ".", "setDefinition", "(", "new", "CpsFlowDefinition", "(", "\"\"", "+", "\"", "node", "(", "'\"", "+", "r", ".", "createSlave", "(", ").", "getNodeName", "(", ")", "+", "\"", "')", "{", "\\", "n", "\"", "+", "\"", "withDockerContainer", "(", "'", "kroniak", "/", "ssh", "-", "client", "'", ")", "{", "\\", "n", "\"", "+", "\"", "sh", "'", "ssh", "-", "agent", "-", "k", "|", "|", ":", "'\\", "n", "\"", "+", "\"", "sshagent", "(", "credentials", ":", "[", "'\"", "+", "CREDENTIAL_ID", "+", "\"", "']", ")", "{", "\\", "n", "\"", "+", "\"", "sh", "'", "env", "'", "\\", "n", "\"", "+", "\"", "}", "\\", "n", "\"", "+", "\"", "}", "\\", "n", "\"", "+", "\"", "}\\", "n", "\"", ",", "true", ")", ")", ";", "WorkflowRun", "b", "=", "r", ".", "buildAndAssertSuccess", "(", "job", ")", ";", "r", ".", "assertLogNotContains", "(", "\"", "cloudbees", "\"", ",", "b", ")", ";", "}", ");", "}", "}"], "docstring_tokens": ["using", "attacker", "specified", "credentials"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "134", ",", "6", "+", "134", ",", "7", "@", "@", "isofs_export_encode_fh", "(", "struct", "inode", "*", "inode", ",", "len", "=", "3", ";", "fh32", "[", "0", "]", "=", "ei", "-", ">", "i_iget5_block", ";", "fh16", "[", "2", "]", "=", "(", "__u16", ")", "ei", "-", ">", "i_iget5_offset", ";", "/", "*", "fh16", "[", "sic", "]", "*", "/", "fh16", "[", "3", "]", "=", "0", ";", "/", "*", "avoid", "leaking", "uninitialized", "data", "*", "/", "fh32", "[", "2", "]", "=", "inode", "-", ">", "i_generation", ";", "if", "(", "parent", ")", "{", "struct", "iso_inode_info", "*", "eparent", ";"], "docstring_tokens": ["via", "a", "crafted", "application", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "256", ",", "7", "+", "256", ",", "6", "@", "@", "struct", "sock", "{", "struct", "sk_buff", "*", "head", ";", "struct", "sk_buff", "*", "tail", ";", "int", "len", ";", "int", "limit", ";", "}", "sk_backlog", ";", "wait_queue_head_t", "*", "sk_sleep", ";", "struct", "dst_entry", "*", "sk_dst_cache", ";", "@", "@", "-", "608", ",", "10", "+", "607", ",", "20", "@", "@", "static", "inline", "void", "__sk_add_backlog", "(", "struct", "sock", "*", "sk", ",", "struct", "sk_buff", "*", "skb", ")", "skb", "-", ">", "next", "=", "NULL", ";", "}", "/", "*", "*", "Take", "into", "account", "size", "of", "receive", "queue", "and", "backlog", "queue", "*", "/", "static", "inline", "bool", "sk_rcvqueues_full", "(", "const", "struct", "sock", "*", "sk", ",", "const", "struct", "sk_buff", "*", "skb", ")", "{", "unsigned", "int", "qsize", "=", "sk", "-", ">", "sk_backlog", ".", "len", "+", "atomic_read", "(", "&", "sk", "-", ">", "sk_rmem_alloc", ")", ";", "return", "qsize", "+", "skb", "-", ">", "truesize", ">", "sk", "-", ">", "sk_rcvbuf", ";", "}", "/", "*", "The", "per", "-", "socket", "spinlock", "must", "be", "held", "here", ".", "*", "/", "static", "inline", "__must_check", "int", "sk_add_backlog", "(", "struct", "sock", "*", "sk", ",", "struct", "sk_buff", "*", "skb", ")", "{", "if", "(", "sk", "-", ">", "sk_backlog", ".", "len", ">", "=", "max", "(", "sk", "-", ">", "sk_backlog", ".", "limit", ",", "sk", "-", ">", "sk_rcvbuf", "<", "<", "1", ")", ")", "if", "(", "sk_rcvqueues_full", "(", "sk", ",", "skb", ")", ")", "return", "-", "ENOBUFS", ";", "__sk_add_backlog", "(", "sk", ",", "skb", ")", ";", "@", "@", "-", "327", ",", "6", "+", "327", ",", "10", "@", "@", "int", "sk_receive_skb", "(", "struct", "sock", "*", "sk", ",", "struct", "sk_buff", "*", "skb", ",", "const", "int", "nested", ")", "skb", "-", ">", "dev", "=", "NULL", ";", "if", "(", "sk_rcvqueues_full", "(", "sk", ",", "skb", ")", ")", "{", "atomic_inc", "(", "&", "sk", "-", ">", "sk_drops", ")", ";", "goto", "discard_and_relse", ";", "}", "if", "(", "nested", ")", "bh_lock_sock_nested", "(", "sk", ")", ";", "else", "@", "@", "-", "1885", ",", "7", "+", "1889", ",", "6", "@", "@", "void", "sock_init_data", "(", "struct", "socket", "*", "sock", ",", "struct", "sock", "*", "sk", ")", "sk", "-", ">", "sk_allocation", "=", "GFP_KERNEL", ";", "sk", "-", ">", "sk_rcvbuf", "=", "sysctl_rmem_default", ";", "sk", "-", ">", "sk_sndbuf", "=", "sysctl_wmem_default", ";", "sk", "-", ">", "sk_backlog", ".", "limit", "=", "sk", "-", ">", "sk_rcvbuf", "<", "<", "1", ";", "sk", "-", ">", "sk_state", "=", "TCP_CLOSE", ";", "sk_set_socket", "(", "sk", ",", "sock", ")", ";", "@", "@", "-", "1372", ",", "6", "+", "1372", ",", "10", "@", "@", "int", "udp_queue_rcv_skb", "(", "struct", "sock", "*", "sk", ",", "struct", "sk_buff", "*", "skb", ")", "goto", "drop", ";", "}", "if", "(", "sk_rcvqueues_full", "(", "sk", ",", "skb", ")", ")", "goto", "drop", ";", "rc", "=", "0", ";", "bh_lock_sock", "(", "sk", ")", ";", "@", "@", "-", "584", ",", "6", "+", "584", ",", "10", "@", "@", "static", "void", "flush_stack", "(", "struct", "sock", "*", "*", "stack", ",", "unsigned", "int", "count", ",", "sk", "=", "stack", "[", "i", "]", ";", "if", "(", "skb1", ")", "{", "if", "(", "sk_rcvqueues_full", "(", "sk", ",", "skb", ")", ")", "{", "kfree_skb", "(", "skb1", ")", ";", "goto", "drop", ";", "}", "bh_lock_sock", "(", "sk", ")", ";", "if", "(", "!", "sock_owned_by_user", "(", "sk", ")", ")", "udpv6_queue_rcv_skb", "(", "sk", ",", "skb1", ")", ";", "@", "@", "-", "759", ",", "6", "+", "763", ",", "10", "@", "@", "int", "__udp6_lib_rcv", "(", "struct", "sk_buff", "*", "skb", ",", "struct", "udp_table", "*", "udptable", ",", "/", "*", "deliver", "*", "/", "if", "(", "sk_rcvqueues_full", "(", "sk", ",", "skb", ")", ")", "{", "sock_put", "(", "sk", ")", ";", "goto", "discard", ";", "}", "bh_lock_sock", "(", "sk", ")", ";", "if", "(", "!", "sock_owned_by_user", "(", "sk", ")", ")", "udpv6_queue_rcv_skb", "(", "sk", ",", "skb", ")", ";", "@", "@", "-", "3721", ",", "9", "+", "3721", ",", "6", "@", "@", "SCTP_STATIC", "int", "sctp_init_sock", "(", "struct", "sock", "*", "sk", ")", "SCTP_DBG_OBJCNT_INC", "(", "sock", ")", ";", "percpu_counter_inc", "(", "&", "sctp_sockets_allocated", ")", ";", "/", "*", "Set", "socket", "backlog", "limit", ".", "*", "/", "sk", "-", ">", "sk_backlog", ".", "limit", "=", "sysctl_sctp_rmem", "[", "1", "]", ";", "local_bh_disable", "(", ");", "sock_prot_inuse_add", "(", "sock_net", "(", "sk", ")", ",", "sk", "-", ">", "sk_prot", ",", "1", ")", ";", "local_bh_enable", "(", ");"], "docstring_tokens": ["sending", "an", "overly", "large", "amount", "of", "network", "traffic"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "62", ",", "4", "+", "62", ",", "6", "@", "@", "void", "xen_arch_register_cpu", "(", "int", "num", ")", ";", "void", "xen_arch_unregister_cpu", "(", "int", "num", ")", ";", "#", "endif", "extern", "void", "xen_set_iopl_mask", "(", "unsigned", "mask", ")", ";", "#", "endif", "/", "*", "_ASM_X86_XEN_HYPERVISOR_H", "*", "/", "@", "@", "-", "48", ",", "6", "+", "48", ",", "7", "@", "@", "#", "include", "<", "asm", "/", "syscalls", ".", "h", ">", "#", "include", "<", "asm", "/", "debugreg", ".", "h", ">", "#", "include", "<", "asm", "/", "switch_to", ".", "h", ">", "#", "include", "<", "asm", "/", "xen", "/", "hypervisor", ".", "h", ">", "asmlinkage", "extern", "void", "ret_from_fork", "(", "void", ")", ";", "@", "@", "-", "411", ",", "6", "+", "412", ",", "17", "@", "@", "__switch_to", "(", "struct", "task_struct", "*", "prev_p", ",", "struct", "task_struct", "*", "next_p", ")", "task_thread_info", "(", "prev_p", ")", "->", "flags", "&", "_TIF_WORK_CTXSW_PREV", ")", ")", "__switch_to_xtra", "(", "prev_p", ",", "next_p", ",", "tss", ")", ";", "#", "ifdef", "CONFIG_XEN", "/", "*", "*", "On", "Xen", "PV", ",", "IOPL", "bits", "in", "pt_regs", "-", ">", "flags", "have", "no", "effect", ",", "and", "*", "current_pt_regs", "(", ")-", ">", "flags", "may", "not", "match", "the", "current", "task", "'", "s", "*", "intended", "IOPL", ".", "We", "need", "to", "switch", "it", "manually", ".", "*", "/", "if", "(", "unlikely", "(", "static_cpu_has", "(", "X86_FEATURE_XENPV", ")", "&", "&", "prev", "-", ">", "iopl", "!", "=", "next", "-", ">", "iopl", ")", ")", "xen_set_iopl_mask", "(", "next", "-", ">", "iopl", ")", ";", "#", "endif", "if", "(", "static_cpu_has_bug", "(", "X86_BUG_SYSRET_SS_ATTRS", ")", ")", "{", "/", "*", "*", "AMD", "CPUs", "have", "a", "misfeature", ":", "SYSRET", "sets", "the", "SS", "selector", "but", "@", "@", "-", "961", ",", "7", "+", "961", ",", "7", "@", "@", "static", "void", "xen_load_sp0", "(", "struct", "tss_struct", "*", "tss", ",", "tss", "-", ">", "x86_tss", ".", "sp0", "=", "thread", "-", ">", "sp0", ";", "}", "static", "void", "xen_set_iopl_mask", "(", "unsigned", "mask", ")", "void", "xen_set_iopl_mask", "(", "unsigned", "mask", ")", "{", "struct", "physdev_set_iopl", "set_iopl", ";"], "docstring_tokens": ["code", "at", "a", "privilege", "level", "other", "than", "zero"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "143", ",", "17", "+", "143", ",", "48", "@", "@", "public", "void", "setTomcatAuthorization", "(", "boolean", "tomcatAuthorization", ")", "{", "}", "private", "String", "requiredSecret", "=", "null", ";", "private", "String", "secret", "=", "null", ";", "/", "**", "*", "Set", "the", "secret", "that", "must", "be", "included", "with", "every", "request", ".", "*", "*", "@", "param", "secret", "The", "required", "secret", "*", "/", "public", "void", "setSecret", "(", "String", "secret", ")", "{", "this", ".", "secret", "=", "secret", ";", "}", "protected", "String", "getSecret", "(", ")", "{", "return", "secret", ";", "}", "/", "**", "*", "Set", "the", "required", "secret", "that", "must", "be", "included", "with", "every", "request", ".", "*", "*", "@", "param", "requiredSecret", "The", "required", "secret", "*", "*", "@", "deprecated", "Replaced", "by", "{", "@", "link", "#", "setSecret", "(", "String", ")", "}.", "*", "Will", "be", "removed", "in", "Tomcat", "11", "onwards", "*", "/", "@", "Deprecated", "public", "void", "setRequiredSecret", "(", "String", "requiredSecret", ")", "{", "this", ".", "requiredSecret", "=", "requiredSecret", ";", "setSecret", "(", "requiredSecret", ")", ";", "}", "/", "**", "*", "@", "return", "The", "current", "secret", "*", "*", "@", "deprecated", "Replaced", "by", "{", "@", "link", "#", "getSecret", "(", ")}", ".", "*", "Will", "be", "removed", "in", "Tomcat", "11", "onwards", "*", "/", "@", "Deprecated", "protected", "String", "getRequiredSecret", "(", ")", "{", "return", "requiredSecret", ";", "return", "getSecret", "(", ");", "}", "private", "boolean", "secretRequired", "=", "true", ";", "public", "void", "setSecretRequired", "(", "boolean", "secretRequired", ")", "{", "this", ".", "secretRequired", "=", "secretRequired", ";", "}", "public", "boolean", "getSecretRequired", "(", ")", "{", "return", "secretRequired", ";", "}", "@", "@", "-", "210", ",", "4", "+", "241", ",", "16", "@", "@", "protected", "Processor", "createUpgradeProcessor", "(", "SocketWrapperBase", "<", "?>", "socket", ",", "throw", "new", "IllegalStateException", "(", "sm", ".", "getString", "(", "\"", "ajpprotocol", ".", "noUpgradeHandler", "\"", ",", "upgradeToken", ".", "getHttpUpgradeHandler", "(", ").", "getClass", "(", ").", "getName", "(", "))", ");", "}", "@", "Override", "public", "void", "init", "(", ")", "throws", "Exception", "{", "if", "(", "getSecretRequired", "(", "))", "{", "String", "secret", "=", "getSecret", "(", ");", "if", "(", "secret", "=", "=", "null", "|", "|", "secret", ".", "length", "(", ")", "=", "=", "0", ")", "{", "throw", "new", "IllegalArgumentException", "(", "sm", ".", "getString", "(", "\"", "ajpprotocol", ".", "nosecret", "\"", "))", ";", "}", "}", "super", ".", "init", "(", ");", "}", "}", "@", "@", "-", "698", ",", "8", "+", "698", ",", "8", "@", "@", "private", "void", "prepareRequest", "(", ")", "{", "}", "/", "/", "Decode", "extra", "attributes", "String", "requiredSecret", "=", "protocol", ".", "getRequiredSecret", "(", ");", "boolean", "secret", "=", "false", ";", "String", "secret", "=", "protocol", ".", "getSecret", "(", ");", "boolean", "secretPresentInRequest", "=", "false", ";", "byte", "attributeCode", ";", "while", "(", "(", "attributeCode", "=", "requestHeaderMessage", ".", "getByte", "(", "))", "!", "=", "Constants", ".", "SC_A_ARE_DONE", ")", "{", "@", "@", "-", "801", ",", "9", "+", "801", ",", "9", "@", "@", "private", "void", "prepareRequest", "(", ")", "{", "case", "Constants", ".", "SC_A_SECRET", ":", "requestHeaderMessage", ".", "getBytes", "(", "tmpMB", ")", ";", "if", "(", "requiredSecret", "!", "=", "null", ")", "{", "secret", "=", "true", ";", "if", "(", "!", "tmpMB", ".", "equals", "(", "requiredSecret", ")", ")", "{", "if", "(", "secret", "!", "=", "null", ")", "{", "secretPresentInRequest", "=", "true", ";", "if", "(", "!", "tmpMB", ".", "equals", "(", "secret", ")", ")", "{", "response", ".", "setStatus", "(", "403", ")", ";", "setErrorState", "(", "ErrorState", ".", "CLOSE_CLEAN", ",", "null", ")", ";", "}", "@", "@", "-", "819", ",", "7", "+", "819", ",", "7", "@", "@", "private", "void", "prepareRequest", "(", ")", "{", "}", "/", "/", "Check", "if", "secret", "was", "submitted", "if", "required", "if", "(", "(", "requiredSecret", "!", "=", "null", ")", "&", "&", "!", "secret", ")", "{", "if", "(", "(", "secret", "!", "=", "null", ")", "&", "&", "!", "secretPresentInRequest", ")", "{", "response", ".", "setStatus", "(", "403", ")", ";", "setErrorState", "(", "ErrorState", ".", "CLOSE_CLEAN", ",", "null", ")", ";", "}", "@", "@", "-", "28", ",", "5", "+", "28", ",", "6", "@", "@", "ajpprocessor", ".", "request", ".", "prepare", "=", "Error", "preparing", "request", "ajpprocessor", ".", "request", ".", "process", "=", "Error", "processing", "request", "ajpprotocol", ".", "noSSL", "=", "SSL", "is", "not", "supported", "with", "AJP", ".", "The", "SSL", "host", "configuration", "for", "[", "{", "0", "}", "]", "was", "ignored", "ajpprotocol", ".", "nosecret", "=", "The", "AJP", "Connector", "is", "configured", "with", "secretRequired", "=", "\"", "true", "\"", "but", "the", "secret", "attribute", "is", "either", "null", "or", "\"", "\".", "This", "combination", "is", "not", "valid", ".", "ajpprotocol", ".", "noUpgrade", "=", "Upgrade", "is", "not", "supported", "with", "AJP", ".", "The", "UpgradeProtocol", "configuration", "for", "[", "{", "0", "}", "]", "was", "ignored", "ajpprotocol", ".", "noUpgradeHandler", "=", "Upgrade", "is", "not", "supported", "with", "AJP", ".", "The", "HttpUpgradeHandler", "[", "{", "0", "}", "]", "can", "not", "be", "processed", "@", "@", "-", "182", ",", "6", "+", "182", ",", "14", "@", "@", "Change", "the", "default", "bind", "address", "for", "the", "AJP", "/", "1", ".", "3", "connector", "to", "be", "the", "loopback", "address", ".", "(", "markt", ")", "<", "/", "update", ">", "<", "add", ">", "Rename", "the", "<", "code", ">", "requiredSecret", "<", "/", "code", ">", "attribute", "of", "the", "AJP", "/", "1", ".", "3", "Connector", "to", "<", "code", ">", "secret", "<", "/", "code", ">", "and", "add", "a", "new", "attribute", "<", "code", ">", "secretRequired", "<", "/", "code", ">", "that", "defaults", "to", "<", "code", ">", "true", "<", "/", "code", ">", ".", "When", "<", "code", ">", "secretRequired", "<", "/", "code", ">", "is", "<", "code", ">", "true", "<", "/", "code", ">", "the", "AJP", "/", "1", ".", "3", "Connector", "will", "not", "start", "unless", "the", "<", "code", ">", "secret", "<", "/", "code", ">", "attribute", "is", "configured", "to", "a", "non", "-", "null", ",", "non", "-", "zero", "length", "String", ".", "(", "markt", ")", "<", "/", "add", ">", "<", "/", "changelog", ">", "<", "/", "subsection", ">", "<", "subsection", "name", "=", "\"", "Jasper", "\"", ">", "@", "@", "-", "428", ",", "8", "+", "428", ",", "18", "@", "@", "expected", "concurrent", "requests", "(", "synchronous", "and", "asynchronous", ")", ".<", "/", "p", ">", "<", "/", "attribute", ">", "<", "attribute", "name", "=", "\"", "requiredSecret", "\"", "required", "=", "\"", "false", "\"", ">", "<", "attribute", "name", "=", "\"", "secret", "\"", "required", "=", "\"", "false", "\"", ">", "<", "p", ">", "Only", "requests", "from", "workers", "with", "this", "secret", "keyword", "will", "be", "accepted", ".", "The", "default", "value", "is", "<", "code", ">", "null", "<", "/", "code", ">", ".", "This", "attrbute", "must", "be", "specified", "with", "a", "non", "-", "null", ",", "non", "-", "zero", "length", "value", "unless", "<", "strong", ">", "secretRequired", "<", "/", "strong", ">", "is", "explicitly", "configured", "to", "be", "<", "code", ">", "false", "<", "/", "code", ">", ".<", "/", "p", ">", "<", "/", "attribute", ">", "<", "attribute", "name", "=", "\"", "secretRequired", "\"", "required", "=", "\"", "false", "\"", ">", "<", "p", ">", "If", "this", "attribute", "is", "<", "code", ">", "true", "<", "/", "code", ">", ",", "the", "AJP", "Connector", "will", "only", "start", "if", "the", "<", "strong", ">", "secret", "<", "/", "strong", ">", "attribute", "is", "configured", "with", "a", "non", "-", "null", ",", "non", "-", "zero", "length", "value", ".", "The", "default", "value", "is", "<", "code", ">", "true", "<", "/", "code", ">", ".", "<", "/", "p", ">", "<", "/", "attribute", ">"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "0", ",", "0", "+", "1", ",", "14", "@", "@", "#", "release", "configuration", "#", "Wed", "Apr", "03", "17", ":", "15", ":", "36", "MDT", "2019", "scm", ".", "tagNameFormat", "=", "@{", "project", ".", "artifactId", "}", "-@", "{", "project", ".", "version", "}", "scm", ".", "username", "=", "sbtaylor15", "pushChanges", "=", "true", "scm", ".", "url", "=", "scm", "\\", ":", "git", "\\", ":", "https", "\\", ":/", "/", "github", ".", "com", "/", "jenkinsci", "/", "deployhub", "-", "plugin", ".", "git", "preparationGoals", "=", "clean", "install", "scm", ".", "password", "=", "G0p", "\\", "!", "1966", "remoteTagging", "=", "true", "projectVersionPolicyId", "=", "default", "scm", ".", "commentPrefix", "=", "[", "maven", "-", "release", "-", "plugin", "]", "exec", ".", "snapshotReleasePluginAllowed", "=", "false", "exec", ".", "additionalArguments", "=", "completedPhase", "=", "check", "-", "poms", "@", "@", "-", "8", ",", "10", "+", "8", ",", "10", "@", "@", "import", "java", ".", "io", ".", "InputStreamReader", ";", "import", "java", ".", "net", ".", "HttpURLConnection", ";", "import", "java", ".", "net", ".", "URL", ";", "import", "java", ".", "net", ".", "URLEncoder", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "net", ".", "URLEncoder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "/", "/", "for", "XML", "parsing", "@", "@", "-", "1", ",", "10", "+", "1", ",", "11", "@", "@", "package", "org", ".", "jenkinsci", ".", "plugins", ".", "deployhub", ";", "import", "hudson", ".", "Extension", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "bind", ".", "JavaScriptMethod", ";", "import", "hudson", ".", "Extension", ";", "import", "hudson", ".", "model", ".", "Action", ";", "@", "Extension", "@", "@", "-", "4", ",", "7", "+", "4", ",", "6", "@", "@", "import", "java", ".", "io", ".", "BufferedWriter", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "FileOutputStream", ";", "import", "java", ".", "io", ".", "FileWriter", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStreamReader", ";", "import", "java", ".", "io", ".", "OutputStreamWriter", ";", "@", "@", "-", "44", ",", "6", "+", "43", ",", "7", "@", "@", "import", "hudson", ".", "tasks", ".", "Publisher", ";", "import", "hudson", ".", "tasks", ".", "Recorder", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "hudson", ".", "util", ".", "Secret", ";", "public", "class", "DeployHub", "extends", "Recorder", "{", "@", "@", "-", "72", ",", "7", "+", "72", ",", "7", "@", "@", "public", "String", "getValue", "(", ")", "{", "private", "boolean", "debug", "=", "false", ";", "private", "final", "String", "username", ";", "private", "final", "String", "password", ";", "private", "final", "Secret", "password", ";", "private", "boolean", "deployApplication", ";", "private", "boolean", "useAdvanced", ";", "private", "boolean", "findLatestVersion", ";", "@", "@", "-", "119", ",", "7", "+", "119", ",", "7", "@", "@", "public", "DeployHub", "(", "String", "username", ",", "List", "<", "Attribute", ">", "compatts", ")", "{", "this", ".", "username", "=", "username", ";", "this", ".", "password", "=", "password", ";", "this", ".", "password", "=", "Secret", ".", "fromString", "(", "password", ")", ";", "this", ".", "deployApplication", "=", "deployApplication", ";", "this", ".", "useAdvanced", "=", "useAdvanced", ";", "this", ".", "findLatestVersion", "=", "findLatestVersion", ";", "@", "@", "-", "149", ",", "7", "+", "149", ",", "7", "@", "@", "public", "String", "getUsername", "(", ")", "{", "}", "public", "String", "getPassword", "(", ")", "{", "return", "password", ";", "return", "Secret", ".", "toString", "(", "password", ")", ";", "}", "public", "boolean", "getDeployApplication", "(", ")", "{", "@", "@", "-", "327", ",", "7", "+", "327", ",", "7", "@", "@", "public", "boolean", "perform", "(", "AbstractBuild", "<", "?,", "?", ">", "build", ",", "Launcher", "launcher", ",", "BuildListen", "/", "/", "String", "urlstr", "=", "server", "+", "\"", "/", "dmadminweb", "/", "API", "/", "login", "\"", "+", "\"?", "user", "=", "\"+", "URLEncoder", ".", "encode", "(", "username", ",", "\"", "UTF", "-", "8", "\"", ")", "+", "\"&", "pass", "=", "\"+", "URLEncoder", ".", "encode", "(", "password", ",", "\"", "UTF", "-", "8", "\"", ");", "+", "\"&", "pass", "=", "\"+", "URLEncoder", ".", "encode", "(", "Secret", ".", "toString", "(", "password", ")", ",", "\"", "UTF", "-", "8", "\"", ");", "/", "/", "listener", ".", "getLogger", "(", ").", "println", "(", "\"", "DEBUG", ":", "urlstr", "=", "\"+", "urlstr", ")", ";", "JsonObject", "res", "=", "SendMessage", "(", "listener", ",", "cm", ",", "urlstr", ")", ";", "/", "/", "listener", ".", "getLogger", "(", ").", "println", "(", "\"", "JSON", "Result", "=", "\"", "+", "res", ".", "toString", "(", "))", ";", "@", "@", "-", "4", ",", "8", "+", "4", ",", "6", "@", "@", "import", "hudson", ".", "ExtensionPoint", ";", "import", "hudson", ".", "model", ".", "Action", ";", "import", "hudson", ".", "model", ".", "Describable", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "public", "abstract", "class", "DeployHubMenu", "implements", "ExtensionPoint", ",", "Action", ",", "Describable", "<", "DeployHubMenu", ">", "{", "@", "@", "-", "1", ",", "12", "+", "1", ",", "14", "@", "@", "package", "org", ".", "jenkinsci", ".", "plugins", ".", "deployhub", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerResponse", ";", "import", "hudson", ".", "Extension", ";", "import", "hudson", ".", "model", ".", "RootAction", ";", "import", "hudson", ".", "model", ".", "Action", ";", "import", "hudson", ".", "model", ".", "RootAction", ";", "import", "jenkins", ".", "model", ".", "ModelObjectWithContextMenu", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerResponse", ";", "import", "java", ".", "util", ".", "List", ";", "/", "**", "*", "Entry", "point", "to", "all", "the", "UI", "samples", "."], "docstring_tokens": ["gaining", "access", "to", "the", "configuration", "file"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "833", ",", "8", "+", "833", ",", "10", "@", "@", "int", "make_http_soap_request", "(", "zval", "*", "this_ptr", ",", "Z_TYPE_P", "(", "value", ")", "=", "=", "IS_STRING", ")", "{", "zval", "*", "tmp", ";", "if", "(", "((", "tmp", "=", "zend_hash_index_find", "(", "Z_ARRVAL_P", "(", "data", ")", ",", "1", ")", ")", "=", "=", "NULL", "|", "|", "Z_TYPE_P", "(", "tmp", ")", "!", "=", "IS_STRING", "|", "|", "strncmp", "(", "phpurl", "-", ">", "path", "?", "phpurl", "-", ">", "path", ":", "\"/", "\",", "Z_STRVAL_P", "(", "tmp", ")", ",", "Z_STRLEN_P", "(", "tmp", ")", ")", "=", "=", "0", ")", "&", "&", "(", "(", "tmp", "=", "zend_hash_index_find", "(", "Z_ARRVAL_P", "(", "data", ")", ",", "2", ")", ")", "=", "=", "NULL", "|", "|", "Z_TYPE_P", "(", "tmp", ")", "!", "=", "IS_STRING", "|", "|", "in_domain", "(", "phpurl", "-", ">", "host", ",", "Z_STRVAL_P", "(", "tmp", ")", "))", "&", "&", "(", "use_ssl", "|", "|", "(", "tmp", "=", "zend_hash_index_find", "(", "Z_ARRVAL_P", "(", "data", ")", ",", "3", ")", ")", "=", "=", "NULL", ")", ")", "{", "smart_str_append", "(", "&", "soap_headers", ",", "key", ")", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "15", "@", "@", "-", "-", "TEST", "-", "-", "SOAP", "Bug", "#", "71610", "-", "Type", "Confusion", "Vulnerability", "-", "SOAP", "/", "make_http_soap_request", "(", ")", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "require_once", "(", "'", "skipif", ".", "inc", "'", ");", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "exploit", "=", "unserialize", "(", "'", "O", ":", "10", ":", "\"", "SoapClient", "\"", ":", "3", ":", "{", "s", ":", "3", ":", "\"", "uri", "\"", ";", "s", ":", "1", ":", "\"", "a", "\"", ";", "s", ":", "8", ":", "\"", "location", "\"", ";", "s", ":", "19", ":", "\"", "http", ":", "//", "testuri", ".", "org", "/", "\";", "s", ":", "8", ":", "\"", "_cookies", "\"", ";", "a", ":", "1", ":", "{", "s", ":", "8", ":", "\"", "manhluat", "\"", ";", "a", ":", "3", ":", "{", "i", ":", "0", ";", "s", ":", "0", ":", "\"\"", ";", "i", ":", "1", ";", "N", ";", "i", ":", "2", ";", "N", ";", "}}", "}}", "')", ";", "try", "{", "$", "exploit", "-", ">", "blahblah", "(", ");", "}", "catch", "(", "SoapFault", "$", "e", ")", "{", "echo", "$", "e", "-", ">", "getMessage", "(", ").", "\"\\", "n", "\"", ";", "}", "?", ">", "-", "-", "EXPECT", "-", "-", "looks", "like", "we", "got", "no", "XML", "document"], "docstring_tokens": ["sending", "a", "specially", "crafted", "SOAP", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1", ",", "3", "+", "1", ",", "5", "@", "@", "Version", "5", ".", "1", ".", "4", "(", "TBD", ")", "Fixed", "HTML", "comments", "incorrectly", "being", "parsed", "in", "certain", "cases", "#", "TINY", "-", "4511", "Version", "5", ".", "1", ".", "3", "(", "2019", "-", "12", "-", "04", ")", "Fixed", "sticky", "toolbar", "not", "undocking", "when", "fullscreen", "mode", "is", "activated", "#", "TINY", "-", "4390", "Fixed", "the", "\"", "Current", "Window", "\"", "target", "not", "applying", "when", "updating", "links", "using", "the", "link", "dialog", "#", "TINY", "-", "4063", "@", "@", "-", "5", ",", "9", "+", "5", ",", "9", "@", "@", "*", "For", "commercial", "licenses", "see", "https", ":", "//", "www", ".", "tiny", ".", "cloud", "/", "*", "/", "import", "Schema", "from", "'", "./", "Schema", "'", ";", "import", "Entities", "from", "'", "./", "Entities", "'", ";", "import", "Tools", "from", "'", "..", "/", "util", "/", "Tools", "'", ";", "import", "Entities", "from", "'", "./", "Entities", "'", ";", "import", "Schema", "from", "'", "./", "Schema", "'", ";", "/", "**", "*", "This", "class", "parses", "HTML", "code", "using", "pure", "JavaScript", "and", "executes", "various", "events", "for", "each", "item", "it", "finds", ".", "It", "will", "@", "@", "-", "292", ",", "7", "+", "292", ",", "7", "@", "@", "function", "SaxParser", "(", "settings", "?", ":", "SaxParserSettings", ",", "schema", "=", "Schema", "(", "))", ":", "SaxParser", "{", "/", "/", "Precompile", "RegExps", "and", "map", "objects", "tokenRegExp", "=", "new", "RegExp", "(", "'<", "(?", ":'", "+", "'", "(?", ":!", "--", "([", "\\\\", "w", "\\", "\\", "W", "]", "*?", ")-", "->", ")|", "'", "+", "/", "/", "Comment", "'", "(?", ":!", "--", "([", "\\\\", "w", "\\", "\\", "W", "]", "*?", ")-", "-!", "?>", ")|", "'", "+", "/", "/", "Comment", "'", "(?", ":!", "\\\\", "[", "CDATA", "\\", "\\[", "([", "\\\\", "w", "\\", "\\", "W", "]", "*?", ")\\", "\\]", "\\\\", "]>", ")|", "'", "+", "/", "/", "CDATA", "'", "(?", ":!", "DOCTYPE", "(", "[\\", "\\", "w", "\\", "\\", "W", "]", "*?", ")>", ")|", "'", "+", "/", "/", "DOCTYPE", "'", "(?", ":\\", "\\?", "([", "^\\", "\\", "s", "\\", "\\/", "<>", "]+", ")", "?", "([", "\\\\", "w", "\\", "\\", "W", "]", "*?", ")[", "?/", "]>", ")|", "'", "+", "/", "/", "PI", "@", "@", "-", "554", ",", "4", "+", "554", ",", "4", "@", "@", "namespace", "SaxParser", "{", "export", "const", "findEndTag", "=", "findEndTagIndex", ";", "}", "export", "default", "SaxParser", ";", "\\", "No", "newline", "at", "end", "of", "file", "export", "default", "SaxParser", ";", "@", "@", "-", "1", ",", "10", "+", "1", ",", "10", "@", "@", "import", "{", "LegacyUnit", "}", "from", "'", "@", "ephox", "/", "mcagar", "'", ";", "import", "{", "Pipeline", "}", "from", "'", "@", "ephox", "/", "agar", "'", ";", "import", "{", "UnitTest", "}", "from", "'", "@", "ephox", "/", "bedrock", "'", ";", "import", "{", "LegacyUnit", "}", "from", "'", "@", "ephox", "/", "mcagar", "'", ";", "import", "SaxParser", "from", "'", "tinymce", "/", "core", "/", "api", "/", "html", "/", "SaxParser", "'", ";", "import", "Writer", "from", "'", "tinymce", "/", "core", "/", "api", "/", "html", "/", "Writer", "'", ";", "import", "Schema", "from", "'", "tinymce", "/", "core", "/", "api", "/", "html", "/", "Schema", "'", ";", "import", "Writer", "from", "'", "tinymce", "/", "core", "/", "api", "/", "html", "/", "Writer", "'", ";", "import", "Tools", "from", "'", "tinymce", "/", "core", "/", "api", "/", "util", "/", "Tools", "'", ";", "import", "{", "UnitTest", "}", "from", "'", "@", "ephox", "/", "bedrock", "'", ";", "UnitTest", ".", "asynctest", "(", "'", "browser", ".", "tinymce", ".", "core", ".", "html", ".", "SaxParserTest", "'", ",", "function", "(", ")", "{", "const", "success", "=", "arguments", "[", "arguments", ".", "length", "-", "2", "]", ";", "@", "@", "-", "420", ",", "6", "+", "420", ",", "13", "@", "@", "UnitTest", ".", "asynctest", "(", "'", "browser", ".", "tinymce", ".", "core", ".", "html", ".", "SaxParserTest", "'", ",", "function", "(", ")", "{", "parser", ".", "parse", "(", "'<", "b", ">", "a", "<", "!-", "-", "value", "-", "->", "b", "<", "/", "b", ">", "')", ";", "LegacyUnit", ".", "equal", "(", "writer", ".", "getContent", "(", "),", "'", "<", "b", ">", "a", "<", "!-", "-", "value", "-", "->", "b", "<", "/", "b", ">", "',", "'", "Parse", "comment", "with", "tags", "around", "it", ".", "')", ";", "LegacyUnit", ".", "deepEqual", "(", "counter", ".", "counts", ",", "{", "comment", ":", "1", ",", "text", ":", "2", ",", "start", ":", "1", ",", "end", ":", "1", "}", ",", "'", "Parse", "comment", "with", "tags", "around", "it", "counts", ".", "')", ";", "counter", "=", "createCounter", "(", "writer", ")", ";", "parser", "=", "SaxParser", "(", "counter", ",", "schema", ")", ";", "writer", ".", "reset", "(", ");", "parser", ".", "parse", "(", "'<", "!-", "-", "value", "-", "-!", ">'", ");", "LegacyUnit", ".", "equal", "(", "writer", ".", "getContent", "(", "),", "'", "<!", "--", "value", "-", "->", "',", "'", "Parse", "comment", "with", "exclamation", "in", "end", "value", ".", "')", ";", "LegacyUnit", ".", "deepEqual", "(", "counter", ".", "counts", ",", "{", "comment", ":", "1", "}", ",", "'", "Parse", "comment", "with", "exclamation", "in", "end", "value", "counts", ".", "')", ";", "}", ");", "suite", ".", "test", "(", "'", "Parsing", "cdata", "'", ",", "function", "(", ")", "{"], "docstring_tokens": ["by", "using", "the", "clipboard", "or", "APIs", "to", "insert", "content", "into", "the", "editor", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "396", ",", "6", "+", "396", ",", "7", "@", "@", "static", "int", "get_name", "(", "struct", "socket", "*", "sock", ",", "struct", "sockaddr", "*", "uaddr", ",", "struct", "sockaddr_tipc", "*", "addr", "=", "(", "struct", "sockaddr_tipc", "*", ")", "uaddr", ";", "struct", "tipc_sock", "*", "tsock", "=", "tipc_sk", "(", "sock", "-", ">", "sk", ")", ";", "memset", "(", "addr", ",", "0", ",", "sizeof", "(", "*", "addr", ")", ");", "if", "(", "peer", ")", "{", "if", "(", "(", "sock", "-", ">", "state", "!", "=", "SS_CONNECTED", ")", "&", "&", "(", "(", "peer", "!", "=", "2", ")", "|", "|", "(", "sock", "-", ">", "state", "!", "=", "SS_DISCONNECTING", ")", "))"], "docstring_tokens": ["by", "reading", "a", "copy", "of", "this", "structure", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "5638", ",", "6", "+", "5638", ",", "36", "@", "@", "void", "sctp_wait_for_close", "(", "struct", "sock", "*", "sk", ",", "long", "timeout", ")", "finish_wait", "(", "sk", "-", ">", "sk_sleep", ",", "&", "wait", ")", ";", "}", "static", "void", "sctp_sock_rfree_frag", "(", "struct", "sk_buff", "*", "skb", ")", "{", "struct", "sk_buff", "*", "frag", ";", "if", "(", "!", "skb", "-", ">", "data_len", ")", "goto", "done", ";", "/", "*", "Don", "'", "t", "forget", "the", "fragments", ".", "*", "/", "for", "(", "frag", "=", "skb_shinfo", "(", "skb", ")", "->", "frag_list", ";", "frag", ";", "frag", "=", "frag", "-", ">", "next", ")", "sctp_sock_rfree_frag", "(", "frag", ")", ";", "done", ":", "sctp_sock_rfree", "(", "skb", ")", ";", "}", "static", "void", "sctp_skb_set_owner_r_frag", "(", "struct", "sk_buff", "*", "skb", ",", "struct", "sock", "*", "sk", ")", "{", "struct", "sk_buff", "*", "frag", ";", "if", "(", "!", "skb", "-", ">", "data_len", ")", "goto", "done", ";", "/", "*", "Don", "'", "t", "forget", "the", "fragments", ".", "*", "/", "for", "(", "frag", "=", "skb_shinfo", "(", "skb", ")", "->", "frag_list", ";", "frag", ";", "frag", "=", "frag", "-", ">", "next", ")", "sctp_skb_set_owner_r_frag", "(", "frag", ",", "sk", ")", ";", "done", ":", "sctp_skb_set_owner_r", "(", "skb", ",", "sk", ")", ";", "}", "/", "*", "Populate", "the", "fields", "of", "the", "newsk", "from", "the", "oldsk", "and", "migrate", "the", "assoc", "*", "and", "its", "messages", "to", "the", "newsk", ".", "*", "/", "@", "@", "-", "5692", ",", "10", "+", "5722", ",", "10", "@", "@", "static", "void", "sctp_sock_migrate", "(", "struct", "sock", "*", "oldsk", ",", "struct", "sock", "*", "newsk", ",", "sctp_skb_for_each", "(", "skb", ",", "&", "oldsk", "-", ">", "sk_receive_queue", ",", "tmp", ")", "{", "event", "=", "sctp_skb2event", "(", "skb", ")", ";", "if", "(", "event", "-", ">", "asoc", "=", "=", "assoc", ")", "{", "sctp_sock_rfree", "(", "skb", ")", ";", "sctp_sock_rfree_frag", "(", "skb", ")", ";", "__skb_unlink", "(", "skb", ",", "&", "oldsk", "-", ">", "sk_receive_queue", ")", ";", "__skb_queue_tail", "(", "&", "newsk", "-", ">", "sk_receive_queue", ",", "skb", ")", ";", "sctp_skb_set_owner_r", "(", "skb", ",", "newsk", ")", ";", "sctp_skb_set_owner_r_frag", "(", "skb", ",", "newsk", ")", ";", "}", "}", "@", "@", "-", "5723", ",", "10", "+", "5753", ",", "10", "@", "@", "static", "void", "sctp_sock_migrate", "(", "struct", "sock", "*", "oldsk", ",", "struct", "sock", "*", "newsk", ",", "sctp_skb_for_each", "(", "skb", ",", "&", "oldsp", "-", ">", "pd_lobby", ",", "tmp", ")", "{", "event", "=", "sctp_skb2event", "(", "skb", ")", ";", "if", "(", "event", "-", ">", "asoc", "=", "=", "assoc", ")", "{", "sctp_sock_rfree", "(", "skb", ")", ";", "sctp_sock_rfree_frag", "(", "skb", ")", ";", "__skb_unlink", "(", "skb", ",", "&", "oldsp", "-", ">", "pd_lobby", ")", ";", "__skb_queue_tail", "(", "queue", ",", "skb", ")", ";", "sctp_skb_set_owner_r", "(", "skb", ",", "newsk", ")", ";", "sctp_skb_set_owner_r_frag", "(", "skb", ",", "newsk", ")", ";", "}", "}", "@", "@", "-", "5738", ",", "6", "+", "5768", ",", "16", "@", "@", "static", "void", "sctp_sock_migrate", "(", "struct", "sock", "*", "oldsk", ",", "struct", "sock", "*", "newsk", ",", "}", "sctp_skb_for_each", "(", "skb", ",", "&", "assoc", "-", ">", "ulpq", ".", "reasm", ",", "tmp", ")", "{", "sctp_sock_rfree_frag", "(", "skb", ")", ";", "sctp_skb_set_owner_r_frag", "(", "skb", ",", "newsk", ")", ";", "}", "sctp_skb_for_each", "(", "skb", ",", "&", "assoc", "-", ">", "ulpq", ".", "lobby", ",", "tmp", ")", "{", "sctp_sock_rfree_frag", "(", "skb", ")", ";", "sctp_skb_set_owner_r_frag", "(", "skb", ",", "newsk", ")", ";", "}", "/", "*", "Set", "the", "type", "of", "socket", "to", "indicate", "that", "it", "is", "peeled", "off", "from", "the", "*", "original", "UDP", "-", "style", "socket", "or", "created", "with", "the", "accept", "(", ")", "call", "on", "a", "*", "TCP", "-", "style", "socket", ".", "."], "docstring_tokens": ["dereferencing", "a", "bogus", "address"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1980", ",", "15", "+", "1980", ",", "15", "@", "@", "static", "int", "mpeg4_decode_gop_header", "(", "MpegEncContext", "*", "s", ",", "GetBitContext", "*", "gb", ")", "return", "0", ";", "}", "static", "int", "mpeg4_decode_profile_level", "(", "MpegEncContext", "*", "s", ",", "GetBitContext", "*", "gb", ")", "static", "int", "mpeg4_decode_profile_level", "(", "MpegEncContext", "*", "s", ",", "GetBitContext", "*", "gb", ",", "int", "*", "profile", ",", "int", "*", "level", ")", "{", "s", "-", ">", "avctx", "-", ">", "profile", "=", "get_bits", "(", "gb", ",", "4", ")", ";", "s", "-", ">", "avctx", "-", ">", "level", "=", "get_bits", "(", "gb", ",", "4", ")", ";", "*", "profile", "=", "get_bits", "(", "gb", ",", "4", ")", ";", "*", "level", "=", "get_bits", "(", "gb", ",", "4", ")", ";", "/", "/", "for", "Simple", "profile", ",", "level", "0", "if", "(", "s", "-", ">", "avctx", "-", ">", "profile", "=", "=", "0", "&", "&", "s", "-", ">", "avctx", "-", ">", "level", "=", "=", "8", ")", "{", "s", "-", ">", "avctx", "-", ">", "level", "=", "0", ";", "if", "(", "*", "profile", "=", "=", "0", "&", "&", "*", "level", "=", "=", "8", ")", "{", "*", "level", "=", "0", ";", "}", "return", "0", ";", "@", "@", "-", "3211", ",", "13", "+", "3211", ",", "19", "@", "@", "int", "ff_mpeg4_decode_picture_header", "(", "Mpeg4DecContext", "*", "ctx", ",", "GetBitContext", "*", "gb", ")", "}", "else", "if", "(", "startcode", "=", "=", "GOP_STARTCODE", ")", "{", "mpeg4_decode_gop_header", "(", "s", ",", "gb", ")", ";", "}", "else", "if", "(", "startcode", "=", "=", "VOS_STARTCODE", ")", "{", "mpeg4_decode_profile_level", "(", "s", ",", "gb", ")", ";", "if", "(", "s", "-", ">", "avctx", "-", ">", "profile", "=", "=", "FF_PROFILE_MPEG4_SIMPLE_STUDIO", "&", "&", "(", "s", "-", ">", "avctx", "-", ">", "level", ">", "0", "&", "&", "s", "-", ">", "avctx", "-", ">", "level", "<", "9", ")", ")", "{", "int", "profile", ",", "level", ";", "mpeg4_decode_profile_level", "(", "s", ",", "gb", ",", "&", "profile", ",", "&", "level", ")", ";", "if", "(", "profile", "=", "=", "FF_PROFILE_MPEG4_SIMPLE_STUDIO", "&", "&", "(", "level", ">", "0", "&", "&", "level", "<", "9", ")", ")", "{", "s", "-", ">", "studio_profile", "=", "1", ";", "next_start_code_studio", "(", "gb", ")", ";", "extension_and_user_data", "(", "s", ",", "gb", ",", "0", ")", ";", "}", "else", "if", "(", "s", "-", ">", "studio_profile", ")", "{", "avpriv_request_sample", "(", "s", "-", ">", "avctx", ",", "\"", "Mixes", "studio", "and", "non", "studio", "profile", "\\", "n", "\"", ");", "return", "AVERROR_PATCHWELCOME", ";", "}", "s", "-", ">", "avctx", "-", ">", "profile", "=", "profile", ";", "s", "-", ">", "avctx", "-", ">", "level", "=", "level", ";", "}", "else", "if", "(", "startcode", "=", "=", "VISUAL_OBJ_STARTCODE", ")", "{", "if", "(", "s", "-", ">", "studio_profile", ")", "{", "if", "(", "(", "ret", "=", "decode_studiovisualobject", "(", "ctx", ",", "gb", ")", ")", "<", "0", ")", "@", "@", "-", "3238", ",", "6", "+", "3244", ",", "7", "@", "@", "int", "ff_mpeg4_decode_picture_header", "(", "Mpeg4DecContext", "*", "ctx", ",", "GetBitContext", "*", "gb", ")", "s", "-", ">", "avctx", "-", ">", "has_b_frames", "=", "!", "s", "-", ">", "low_delay", ";", "if", "(", "s", "-", ">", "studio_profile", ")", "{", "av_assert0", "(", "s", "-", ">", "avctx", "-", ">", "profile", "=", "=", "FF_PROFILE_MPEG4_SIMPLE_STUDIO", ")", ";", "if", "(", "!", "s", "-", ">", "avctx", "-", ">", "bits_per_raw_sample", ")", "{", "av_log", "(", "s", "-", ">", "avctx", ",", "AV_LOG_ERROR", ",", "\"", "Missing", "VOL", "header", "\\", "n", "\"", ");", "return", "AVERROR_INVALIDDATA", ";"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1150", ",", "6", "+", "1150", ",", "15", "@", "@", "public", "void", "process", "(", "InputStream", "in", ",", "ZipEntry", "zipEntry", ")", "throws", "IOException", "{", "String", "name", "=", "mapper", ".", "map", "(", "zipEntry", ".", "getName", "(", "))", ";", "if", "(", "name", "!", "=", "null", ")", "{", "File", "file", "=", "new", "File", "(", "outputDir", ",", "name", ")", ";", "/", "*", "If", "we", "see", "the", "relative", "traversal", "string", "of", "\"", "..", "\"", "we", "need", "to", "make", "sure", "*", "that", "the", "outputdir", "+", "name", "doesn", "'", "t", "leave", "the", "outputdir", ".", "See", "*", "DirectoryTraversalMaliciousTest", "for", "details", ".", "*", "/", "if", "(", "name", ".", "indexOf", "(", "\".", ".\"", ")", "!", "=", "-", "1", "&", "&", "!", "file", ".", "getCanonicalPath", "(", ").", "startsWith", "(", "outputDir", ".", "getCanonicalPath", "(", "))", ")", "{", "throw", "new", "ZipException", "(", "\"", "The", "file", "\"", "+", "name", "+", "\"", "is", "trying", "to", "leave", "the", "target", "output", "directory", "of", "\"", "+", "outputDir", "+", "\".", "Ignoring", "this", "file", ".", "\")", ";", "}", "if", "(", "zipEntry", ".", "isDirectory", "(", "))", "{", "FileUtils", ".", "forceMkdir", "(", "file", ")", ";", "}", "@", "@", "-", "1218", ",", "11", "+", "1227", ",", "29", "@", "@", "public", "void", "process", "(", "InputStream", "in", ",", "ZipEntry", "zipEntry", ")", "throws", "IOException", "{", "parentDirectory", "=", "file", ";", "}", "File", "destFile", "=", "new", "File", "(", "parentDirectory", ",", "dirs", "[", "dirs", ".", "length", "-", "1", "]", ");", "/", "*", "If", "we", "see", "the", "relative", "traversal", "string", "of", "\"", "..", "\"", "we", "need", "to", "make", "sure", "*", "that", "the", "outputdir", "+", "name", "doesn", "'", "t", "leave", "the", "outputdir", ".", "See", "*", "DirectoryTraversalMaliciousTest", "for", "details", ".", "*", "/", "if", "(", "name", ".", "indexOf", "(", "\".", ".\"", ")", "!", "=", "-", "1", "&", "&", "!", "destFile", ".", "getCanonicalPath", "(", ").", "startsWith", "(", "outputDir", ".", "getCanonicalPath", "(", "))", ")", "{", "throw", "new", "ZipException", "(", "\"", "The", "file", "\"", "+", "name", "+", "\"", "is", "trying", "to", "leave", "the", "target", "output", "directory", "of", "\"", "+", "outputDir", "+", "\".", "Ignoring", "this", "file", ".", "\")", ";", "}", "FileUtils", ".", "copy", "(", "in", ",", "destFile", ")", ";", "}", "/", "/", "it", "could", "be", "that", "there", "are", "just", "top", "level", "files", "that", "the", "unpacker", "is", "used", "for", "else", "{", "File", "destFile", "=", "new", "File", "(", "outputDir", ",", "name", ")", ";", "/", "*", "If", "we", "see", "the", "relative", "traversal", "string", "of", "\"", "..", "\"", "we", "need", "to", "make", "sure", "*", "that", "the", "outputdir", "+", "name", "doesn", "'", "t", "leave", "the", "outputdir", ".", "See", "*", "DirectoryTraversalMaliciousTest", "for", "details", ".", "*", "/", "if", "(", "name", ".", "indexOf", "(", "\".", ".\"", ")", "!", "=", "-", "1", "&", "&", "!", "destFile", ".", "getCanonicalPath", "(", ").", "startsWith", "(", "outputDir", ".", "getCanonicalPath", "(", "))", ")", "{", "throw", "new", "ZipException", "(", "\"", "The", "file", "\"", "+", "name", "+", "\"", "is", "trying", "to", "leave", "the", "target", "output", "directory", "of", "\"", "+", "outputDir", "+", "\".", "Ignoring", "this", "file", ".", "\")", ";", "}", "FileUtils", ".", "copy", "(", "in", ",", "destFile", ")", ";", "}", "}", "@", "@", "-", "1258", ",", "6", "+", "1285", ",", "15", "@", "@", "else", "if", "(", "!", "rootDir", ".", "equals", "(", "root", ")", ")", "{", "String", "name", "=", "mapper", ".", "map", "(", "getUnrootedName", "(", "root", ",", "zipEntry", ".", "getName", "(", "))", ");", "if", "(", "name", "!", "=", "null", ")", "{", "File", "file", "=", "new", "File", "(", "outputDir", ",", "name", ")", ";", "/", "*", "If", "we", "see", "the", "relative", "traversal", "string", "of", "\"", "..", "\"", "we", "need", "to", "make", "sure", "*", "that", "the", "outputdir", "+", "name", "doesn", "'", "t", "leave", "the", "outputdir", ".", "See", "*", "DirectoryTraversalMaliciousTest", "for", "details", ".", "*", "/", "if", "(", "name", ".", "indexOf", "(", "\".", ".\"", ")", "!", "=", "-", "1", "&", "&", "!", "file", ".", "getCanonicalPath", "(", ").", "startsWith", "(", "outputDir", ".", "getCanonicalPath", "(", "))", ")", "{", "throw", "new", "ZipException", "(", "\"", "The", "file", "\"", "+", "name", "+", "\"", "is", "trying", "to", "leave", "the", "target", "output", "directory", "of", "\"", "+", "outputDir", "+", "\".", "Ignoring", "this", "file", ".", "\")", ";", "}", "if", "(", "zipEntry", ".", "isDirectory", "(", "))", "{", "FileUtils", ".", "forceMkdir", "(", "file", ")", ";", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "61", "@", "@", "package", "org", ".", "zeroturnaround", ".", "zip", ";", "/", "**", "*", "Copyright", "(", "C", ")", "2012", "ZeroTurnaround", "LLC", "<", "support", "@", "zeroturnaround", ".", "com", ">", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "import", "java", ".", "io", ".", "File", ";", "import", "junit", ".", "framework", ".", "TestCase", ";", "public", "class", "DirectoryTraversalMaliciousTest", "extends", "TestCase", "{", "/", "*", "*", "This", "is", "the", "contents", "of", "the", "file", ".", "There", "is", "one", "evil", "file", "that", "tries", "to", "get", "out", "of", "the", "*", "target", ".", "*", "*", "$", "unzip", "-", "t", "zip", "-", "slip", ".", "zip", "*", "Archive", ":", "zip", "-", "slip", ".", "zip", "*", "testing", ":", "good", ".", "txt", "OK", "*", "testing", ":", ".", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/.", "./", "..", "/", "tmp", "/", "evil", ".", "txt", "OK", "*", "No", "errors", "detected", "in", "compressed", "data", "of", "zip", "-", "slip", ".", "zip", ".", "*", "/", "private", "static", "final", "File", "badFile", "=", "new", "File", "(", "\"", "src", "/", "test", "/", "resources", "/", "zip", "-", "malicious", "-", "traversal", ".", "zip", "\"", ");", "private", "static", "final", "File", "badFileBackslashes", "=", "new", "File", "(", "\"", "src", "/", "test", "/", "resources", "/", "zip", "-", "malicious", "-", "traversal", "-", "backslashes", ".", "zip", "\"", ");", "public", "void", "testUnpackDoesntLeaveTarget", "(", ")", "throws", "Exception", "{", "File", "file", "=", "File", ".", "createTempFile", "(", "\"", "temp", "\"", ",", "null", ")", ";", "File", "tmpDir", "=", "file", ".", "getParentFile", "(", ");", "try", "{", "ZipUtil", ".", "unpack", "(", "badFile", ",", "tmpDir", ")", ";", "fail", "(", ");", "}", "catch", "(", "ZipException", "e", ")", "{", "assertTrue", "(", "true", ")", ";", "}", "}", "public", "void", "testUnwrapDoesntLeaveTarget", "(", ")", "throws", "Exception", "{", "File", "file", "=", "File", ".", "createTempFile", "(", "\"", "temp", "\"", ",", "null", ")", ";", "File", "tmpDir", "=", "file", ".", "getParentFile", "(", ");", "try", "{", "ZipUtil", ".", "iterate", "(", "badFileBackslashes", ",", "new", "ZipUtil", ".", "BackslashUnpacker", "(", "tmpDir", ")", ");", "fail", "(", ");", "}", "catch", "(", "ZipException", "e", ")", "{", "assertTrue", "(", "true", ")", ";", "}", "}", "}"], "docstring_tokens": ["write", "to", "arbitrary", "files", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "50", ",", "7", "+", "50", ",", "7", "@", "@", "private", "static", "final", "String", "JAAS_USER_PREFIX", "=", "\"", "user_", "\"", ";", "private", "boolean", "complete", ";", "private", "String", "authorizationID", ";", "private", "String", "authorizationId", ";", "public", "PlainSaslServer", "(", "CallbackHandler", "callbackHandler", ")", "{", "}", "@", "@", "-", "78", ",", "7", "+", "78", ",", "7", "@", "@", "public", "PlainSaslServer", "(", "CallbackHandler", "callbackHandler", ")", "{", "}", "if", "(", "tokens", ".", "length", "!", "=", "3", ")", "throw", "new", "SaslException", "(", "\"", "Invalid", "SASL", "/", "PLAIN", "response", ":", "expected", "3", "tokens", ",", "got", "\"", "+", "tokens", ".", "length", ")", ";", "authorizationID", "=", "tokens", "[", "0", "]", ";", "String", "authorizationIdFromClient", "=", "tokens", "[", "0", "]", ";", "String", "username", "=", "tokens", "[", "1", "]", ";", "String", "password", "=", "tokens", "[", "2", "]", ";", "@", "@", "-", "88", ",", "8", "+", "88", ",", "6", "@", "@", "public", "PlainSaslServer", "(", "CallbackHandler", "callbackHandler", ")", "{", "if", "(", "password", ".", "isEmpty", "(", "))", "{", "throw", "new", "SaslException", "(", "\"", "Authentication", "failed", ":", "password", "not", "specified", "\"", ");", "}", "if", "(", "authorizationID", ".", "isEmpty", "(", "))", "authorizationID", "=", "username", ";", "try", "{", "String", "expectedPassword", "=", "JaasUtils", ".", "defaultServerJaasConfigOption", "(", "JAAS_USER_PREFIX", "+", "username", ",", "PlainLoginModule", ".", "class", ".", "getName", "(", "))", ";", "@", "@", "-", "99", ",", "6", "+", "97", ",", "12", "@", "@", "public", "PlainSaslServer", "(", "CallbackHandler", "callbackHandler", ")", "{", "}", "catch", "(", "IOException", "e", ")", "{", "throw", "new", "SaslException", "(", "\"", "Authentication", "failed", ":", "Invalid", "JAAS", "configuration", "\"", ",", "e", ")", ";", "}", "if", "(", "!", "authorizationIdFromClient", ".", "isEmpty", "(", ")", "&", "&", "!", "authorizationIdFromClient", ".", "equals", "(", "username", ")", ")", "throw", "new", "SaslException", "(", "\"", "Authentication", "failed", ":", "Client", "requested", "an", "authorization", "id", "that", "is", "different", "from", "username", "\"", ");", "this", ".", "authorizationId", "=", "username", ";", "complete", "=", "true", ";", "return", "new", "byte", "[", "0", "]", ";", "}", "@", "@", "-", "107", ",", "7", "+", "111", ",", "7", "@", "@", "public", "PlainSaslServer", "(", "CallbackHandler", "callbackHandler", ")", "{", "public", "String", "getAuthorizationID", "(", ")", "{", "if", "(", "!", "complete", ")", "throw", "new", "IllegalStateException", "(", "\"", "Authentication", "exchange", "has", "not", "completed", "\"", ");", "return", "authorizationID", ";", "return", "authorizationId", ";", "}", "@", "Override", "@", "@", "-", "66", ",", "7", "+", "66", ",", "6", "@", "@", "private", "String", "username", ";", "private", "ClientFirstMessage", "clientFirstMessage", ";", "private", "ServerFirstMessage", "serverFirstMessage", ";", "private", "String", "serverNonce", ";", "private", "ScramCredential", "scramCredential", ";", "public", "ScramSaslServer", "(", "ScramMechanism", "mechanism", ",", "Map", "<", "String", ",", "?", ">", "props", ",", "CallbackHandler", "callbackHandler", ")", "throws", "NoSuchAlgorithmException", "{", "@", "@", "-", "82", ",", "7", "+", "81", ",", "7", "@", "@", "public", "ScramSaslServer", "(", "ScramMechanism", "mechanism", ",", "Map", "<", "String", ",", "?", ">", "props", ",", "CallbackH", "switch", "(", "state", ")", "{", "case", "RECEIVE_CLIENT_FIRST_MESSAGE", ":", "this", ".", "clientFirstMessage", "=", "new", "ClientFirstMessage", "(", "response", ")", ";", "serverNonce", "=", "formatter", ".", "secureRandomString", "(", ");", "String", "serverNonce", "=", "formatter", ".", "secureRandomString", "(", ");", "try", "{", "String", "saslName", "=", "clientFirstMessage", ".", "saslName", "(", ");", "this", ".", "username", "=", "formatter", ".", "username", "(", "saslName", ")", ";", "@", "@", "-", "92", ",", "6", "+", "91", ",", "10", "@", "@", "public", "ScramSaslServer", "(", "ScramMechanism", "mechanism", ",", "Map", "<", "String", ",", "?", ">", "props", ",", "CallbackH", "this", ".", "scramCredential", "=", "credentialCallback", ".", "scramCredential", "(", ");", "if", "(", "scramCredential", "=", "=", "null", ")", "throw", "new", "SaslException", "(", "\"", "Authentication", "failed", ":", "Invalid", "user", "credentials", "\"", ");", "String", "authorizationIdFromClient", "=", "clientFirstMessage", ".", "authorizationId", "(", ");", "if", "(", "!", "authorizationIdFromClient", ".", "isEmpty", "(", ")", "&", "&", "!", "authorizationIdFromClient", ".", "equals", "(", "username", ")", ")", "throw", "new", "SaslException", "(", "\"", "Authentication", "failed", ":", "Client", "requested", "an", "authorization", "id", "that", "is", "different", "from", "username", "\"", ");", "if", "(", "scramCredential", ".", "iterations", "(", ")", "<", "mechanism", ".", "minIterations", "(", "))", "throw", "new", "SaslException", "(", "\"", "Iterations", "\"", "+", "scramCredential", ".", "iterations", "(", ")", "+", "\"", "is", "less", "than", "the", "minimum", "\"", "+", "mechanism", ".", "minIterations", "(", ")", "+", "\"", "for", "\"", "+", "mechanism", ")", ";", "this", ".", "serverFirstMessage", "=", "new", "ServerFirstMessage", "(", "clientFirstMessage", ".", "nonce", "(", "),", "@", "@", "-", "111", ",", "6", "+", "114", ",", "7", "@", "@", "public", "ScramSaslServer", "(", "ScramMechanism", "mechanism", ",", "Map", "<", "String", ",", "?", ">", "props", ",", "CallbackH", "byte", "[", "]", "serverKey", "=", "scramCredential", ".", "serverKey", "(", ");", "byte", "[", "]", "serverSignature", "=", "formatter", ".", "serverSignature", "(", "serverKey", ",", "clientFirstMessage", ",", "serverFirstMessage", ",", "clientFinalMessage", ")", ";", "ServerFinalMessage", "serverFinalMessage", "=", "new", "ServerFinalMessage", "(", "null", ",", "serverSignature", ")", ";", "clearCredentials", "(", ");", "setState", "(", "State", ".", "COMPLETE", ")", ";", "return", "serverFinalMessage", ".", "toBytes", "(", ");", "}", "catch", "(", "InvalidKeyException", "e", ")", "{", "@", "@", "-", "121", ",", "6", "+", "125", ",", "7", "@", "@", "public", "ScramSaslServer", "(", "ScramMechanism", "mechanism", ",", "Map", "<", "String", ",", "?", ">", "props", ",", "CallbackH", "throw", "new", "IllegalSaslStateException", "(", "\"", "Unexpected", "challenge", "in", "Sasl", "server", "state", "\"", "+", "state", ")", ";", "}", "}", "catch", "(", "SaslException", "e", ")", "{", "clearCredentials", "(", ");", "setState", "(", "State", ".", "FAILED", ")", ";", "throw", "e", ";", "}", "@", "@", "-", "130", ",", "8", "+", "135", ",", "7", "@", "@", "public", "ScramSaslServer", "(", "ScramMechanism", "mechanism", ",", "Map", "<", "String", ",", "?", ">", "props", ",", "CallbackH", "public", "String", "getAuthorizationID", "(", ")", "{", "if", "(", "!", "isComplete", "(", "))", "throw", "new", "IllegalStateException", "(", "\"", "Authentication", "exchange", "has", "not", "completed", "\"", ");", "String", "authzId", "=", "clientFirstMessage", ".", "authorizationId", "(", ");", "return", "authzId", "=", "=", "null", "|", "|", "authzId", ".", "length", "(", ")", "=", "=", "0", "?", "username", ":", "authzId", ";", "return", "username", ";", "}", "@", "Override", "@", "@", "-", "186", ",", "6", "+", "190", ",", "12", "@", "@", "private", "void", "verifyClientProof", "(", "ClientFinalMessage", "clientFinalMessage", ")", "throws", "Sas", "}", "}", "private", "void", "clearCredentials", "(", ")", "{", "scramCredential", "=", "null", ";", "clientFirstMessage", "=", "null", ";", "serverFirstMessage", "=", "null", ";", "}", "public", "static", "class", "ScramSaslServerFactory", "implements", "SaslServerFactory", "{", "@", "Override", "@", "@", "-", "0", ",", "0", "+", "1", ",", "75", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "kafka", ".", "common", ".", "security", ".", "plain", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "javax", ".", "security", ".", "sasl", ".", "SaslException", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "org", ".", "apache", ".", "kafka", ".", "common", ".", "security", ".", "JaasContext", ";", "import", "org", ".", "apache", ".", "kafka", ".", "common", ".", "security", ".", "authenticator", ".", "TestJaasConfig", ";", "public", "class", "PlainSaslServerTest", "{", "private", "static", "final", "String", "USER_A", "=", "\"", "userA", "\"", ";", "private", "static", "final", "String", "PASSWORD_A", "=", "\"", "passwordA", "\"", ";", "private", "static", "final", "String", "USER_B", "=", "\"", "userB", "\"", ";", "private", "static", "final", "String", "PASSWORD_B", "=", "\"", "passwordB", "\"", ";", "private", "PlainSaslServer", "saslServer", ";", "@", "Before", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "TestJaasConfig", "jaasConfig", "=", "new", "TestJaasConfig", "(", ");", "Map", "<", "String", ",", "Object", ">", "options", "=", "new", "HashMap", "<", ">(", ");", "options", ".", "put", "(", "\"", "user_", "\"", "+", "USER_A", ",", "PASSWORD_A", ")", ";", "options", ".", "put", "(", "\"", "user_", "\"", "+", "USER_B", ",", "PASSWORD_B", ")", ";", "jaasConfig", ".", "addEntry", "(", "\"", "jaasContext", "\"", ",", "PlainLoginModule", ".", "class", ".", "getName", "(", "),", "options", ")", ";", "JaasContext", "jaasContext", "=", "new", "JaasContext", "(", "\"", "jaasContext", "\"", ",", "JaasContext", ".", "Type", ".", "SERVER", ",", "jaasConfig", ")", ";", "saslServer", "=", "new", "PlainSaslServer", "(", "jaasContext", ")", ";", "}", "@", "Test", "public", "void", "noAuthorizationIdSpecified", "(", ")", "throws", "Exception", "{", "byte", "[", "]", "nextChallenge", "=", "saslServer", ".", "evaluateResponse", "(", "saslMessage", "(", "\"\"", ",", "USER_A", ",", "PASSWORD_A", ")", ");", "assertEquals", "(", "0", ",", "nextChallenge", ".", "length", ")", ";", "}", "@", "Test", "public", "void", "authorizatonIdEqualsAuthenticationId", "(", ")", "throws", "Exception", "{", "byte", "[", "]", "nextChallenge", "=", "saslServer", ".", "evaluateResponse", "(", "saslMessage", "(", "USER_A", ",", "USER_A", ",", "PASSWORD_A", ")", ");", "assertEquals", "(", "0", ",", "nextChallenge", ".", "length", ")", ";", "}", "@", "Test", "(", "expected", "=", "SaslException", ".", "class", ")", "public", "void", "authorizatonIdNotEqualsAuthenticationId", "(", ")", "throws", "Exception", "{", "saslServer", ".", "evaluateResponse", "(", "saslMessage", "(", "USER_B", ",", "USER_A", ",", "PASSWORD_A", ")", ");", "}", "private", "byte", "[", "]", "saslMessage", "(", "String", "authorizationId", ",", "String", "userName", ",", "String", "password", ")", "{", "String", "nul", "=", "\"", "\\", "u0000", "\"", ";", "String", "message", "=", "String", ".", "format", "(", "\"%", "s", "%", "s", "%", "s", "%", "s", "%", "s", "\"", ",", "authorizationId", ",", "nul", ",", "userName", ",", "nul", ",", "password", ")", ";", "return", "message", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "74", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "kafka", ".", "common", ".", "security", ".", "scram", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "javax", ".", "security", ".", "sasl", ".", "SaslException", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "org", ".", "apache", ".", "kafka", ".", "common", ".", "security", ".", "authenticator", ".", "CredentialCache", ";", "public", "class", "ScramSaslServerTest", "{", "private", "static", "final", "String", "USER_A", "=", "\"", "userA", "\"", ";", "private", "static", "final", "String", "USER_B", "=", "\"", "userB", "\"", ";", "private", "ScramMechanism", "mechanism", ";", "private", "ScramFormatter", "formatter", ";", "private", "ScramSaslServer", "saslServer", ";", "@", "Before", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "mechanism", "=", "ScramMechanism", ".", "SCRAM_SHA_256", ";", "formatter", "=", "new", "ScramFormatter", "(", "mechanism", ")", ";", "CredentialCache", ".", "Cache", "<", "ScramCredential", ">", "credentialCache", "=", "new", "CredentialCache", "(", ").", "createCache", "(", "mechanism", ".", "mechanismName", "(", "),", "ScramCredential", ".", "class", ")", ";", "credentialCache", ".", "put", "(", "USER_A", ",", "formatter", ".", "generateCredential", "(", "\"", "passwordA", "\"", ",", "4096", ")", ");", "credentialCache", ".", "put", "(", "USER_B", ",", "formatter", ".", "generateCredential", "(", "\"", "passwordB", "\"", ",", "4096", ")", ");", "ScramServerCallbackHandler", "callbackHandler", "=", "new", "ScramServerCallbackHandler", "(", "credentialCache", ")", ";", "saslServer", "=", "new", "ScramSaslServer", "(", "mechanism", ",", "new", "HashMap", "<", "String", ",", "Object", ">", "()", ",", "callbackHandler", ")", ";", "}", "@", "Test", "public", "void", "noAuthorizationIdSpecified", "(", ")", "throws", "Exception", "{", "byte", "[", "]", "nextChallenge", "=", "saslServer", ".", "evaluateResponse", "(", "clientFirstMessage", "(", "USER_A", ",", "null", ")", ");", "assertTrue", "(", "\"", "Next", "challenge", "is", "empty", "\"", ",", "nextChallenge", ".", "length", ">", "0", ")", ";", "}", "@", "Test", "public", "void", "authorizatonIdEqualsAuthenticationId", "(", ")", "throws", "Exception", "{", "byte", "[", "]", "nextChallenge", "=", "saslServer", ".", "evaluateResponse", "(", "clientFirstMessage", "(", "USER_A", ",", "USER_A", ")", ");", "assertTrue", "(", "\"", "Next", "challenge", "is", "empty", "\"", ",", "nextChallenge", ".", "length", ">", "0", ")", ";", "}", "@", "Test", "(", "expected", "=", "SaslException", ".", "class", ")", "public", "void", "authorizatonIdNotEqualsAuthenticationId", "(", ")", "throws", "Exception", "{", "saslServer", ".", "evaluateResponse", "(", "clientFirstMessage", "(", "USER_A", ",", "USER_B", ")", ");", "}", "private", "byte", "[", "]", "clientFirstMessage", "(", "String", "userName", ",", "String", "authorizationId", ")", "{", "String", "nonce", "=", "formatter", ".", "secureRandomString", "(", ");", "String", "authorizationField", "=", "authorizationId", "!", "=", "null", "?", "\"", "a", "=", "\"", "+", "authorizationId", ":", "\"", "\";", "String", "firstMessage", "=", "String", ".", "format", "(", "\"", "n", ",", "%", "s", ",", "n", "=", "%", "s", ",", "r", "=", "%", "s", "\"", ",", "authorizationField", ",", "userName", ",", "nonce", ")", ";", "return", "firstMessage", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ";", "}", "}"], "docstring_tokens": ["a", "manually", "crafted", "protocol", "message"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "158", ",", "9", "+", "158", ",", "18", "@", "@", "s", ".", "add", "(", "\"", "org", ".", "aoju", ".", "bus", ".", "proxy", ".", "provider", ".", "RmiProvider", "\"", ");", "s", ".", "add", "(", "\"", "org", ".", "aoju", ".", "bus", ".", "proxy", ".", "provider", ".", "remoting", ".", "RmiProvider", "\"", ");", "/", "/", "[", "databind", "#", "2664", "]", ":", "activemq", "-", "jms", "s", ".", "add", "(", "\"", "org", ".", "apache", ".", "activemq", ".", "jms", ".", "pool", ".", "XaPooledConnectionFactory", "\"", ");", "/", "/", "[", "databind", "#", "2664", "]", ":", "activemq", "-", "core", ",", "activemq", "-", "pool", ",", "activemq", "-", "pool", "-", "jms", "s", ".", "add", "(", "\"", "org", ".", "apache", ".", "activemq", ".", "ActiveMQConnectionFactory", "\"", ");", "/", "/", "core", "s", ".", "add", "(", "\"", "org", ".", "apache", ".", "activemq", ".", "ActiveMQXAConnectionFactory", "\"", ");", "s", ".", "add", "(", "\"", "org", ".", "apache", ".", "activemq", ".", "spring", ".", "ActiveMQConnectionFactory", "\"", ");", "s", ".", "add", "(", "\"", "org", ".", "apache", ".", "activemq", ".", "spring", ".", "ActiveMQXAConnectionFactory", "\"", ");", "s", ".", "add", "(", "\"", "org", ".", "apache", ".", "activemq", ".", "pool", ".", "JcaPooledConnectionFactory", "\"", ");", "/", "/", "pool", "s", ".", "add", "(", "\"", "org", ".", "apache", ".", "activemq", ".", "pool", ".", "PooledConnectionFactory", "\"", ");", "s", ".", "add", "(", "\"", "org", ".", "apache", ".", "activemq", ".", "pool", ".", "XaPooledConnectionFactory", "\"", ");", "s", ".", "add", "(", "\"", "org", ".", "apache", ".", "activemq", ".", "jms", ".", "pool", ".", "XaPooledConnectionFactory", "\"", ");", "/", "/", "pool", "-", "jms", "s", ".", "add", "(", "\"", "org", ".", "apache", ".", "activemq", ".", "jms", ".", "pool", ".", "JcaPooledConnectionFactory", "\"", ");", "/", "/", "[", "databind", "#", "2666", "]", ":", "apache", "/", "commons", "-", "jms", "s", ".", "add", "(", "\"", "org", ".", "apache", ".", "commons", ".", "proxy", ".", "provider", ".", "remoting", ".", "RmiProvider", "\"", ");"], "docstring_tokens": ["sending", "specially-crafted", "input"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "326", ",", "7", "+", "326", ",", "7", "@", "@", "-", "->", "<", "!-", "-", "Enables", "\"", "remember", "me", "\"", "functionality", "-", "->", "<", "sec", ":", "remember", "-", "me", "key", "=", "\"", "opencast", "\"", "user", "-", "service", "-", "ref", "=", "\"", "userDetailsService", "\"", "/", ">", "<", "sec", ":", "remember", "-", "me", "services", "-", "ref", "=", "\"", "rememberMeServices", "\"", "/", ">", "<", "!-", "-", "Set", "the", "request", "cache", "-", "->", "<", "sec", ":", "request", "-", "cache", "ref", "=", "\"", "requestCache", "\"", "/", ">", "@", "@", "-", "344", ",", "6", "+", "344", ",", "15", "@", "@", "<", "/", "sec", ":", "http", ">", "<", "bean", "id", "=", "\"", "rememberMeServices", "\"", "class", "=", "\"", "org", ".", "opencastproject", ".", "kernel", ".", "security", ".", "SystemTokenBasedRememberMeService", "\"", ">", "<", "property", "name", "=", "\"", "userDetailsService", "\"", "ref", "=", "\"", "userDetailsService", "\"", "/>", "<", "!-", "-", "All", "following", "settings", "are", "optional", "-", "->", "<", "property", "name", "=", "\"", "tokenValiditySeconds", "\"", "value", "=", "\"", "1209600", "\"", "/>", "<", "property", "name", "=", "\"", "cookieName", "\"", "value", "=", "\"", "oc", "-", "remember", "-", "me", "\"", "/>", "<", "!-", "-", "The", "following", "key", "will", "be", "augmented", "by", "system", "properties", ".", "Thus", ",", "leaving", "this", "untouched", "is", "okay", "-", "->", "<", "property", "name", "=", "\"", "key", "\"", "value", "=", "\"", "opencast", "\"", "/>", "<", "/", "bean", ">", "<", "!-", "-", "#", "##", "##", "##", "##", "##", "##", "##", "##", "##", "##", "##", "##", "##", "##", "-", "->", "<", "!-", "-", "#", "Authentication", "Filters", "#", "-", "->", "<", "!-", "-", "#", "##", "##", "##", "##", "##", "##", "##", "##", "##", "##", "##", "##", "##", "##", "-", "->", "@", "@", "-", "0", ",", "0", "+", "1", ",", "136", "@", "@", "/", "**", "*", "Licensed", "to", "The", "Apereo", "Foundation", "under", "one", "or", "more", "contributor", "license", "*", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "*", "information", "regarding", "copyright", "ownership", ".", "*", "*", "*", "The", "Apereo", "Foundation", "licenses", "this", "file", "to", "you", "under", "the", "Educational", "*", "Community", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "*", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "*", "at", ":", "*", "*", "http", ":", "//", "opensource", ".", "org", "/", "licenses", "/", "ecl2", ".", "txt", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "*", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "*", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "*", "the", "License", ".", "*", "*", "/", "package", "org", ".", "opencastproject", ".", "kernel", ".", "security", ";", "import", "org", ".", "apache", ".", "commons", ".", "io", ".", "IOUtils", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "import", "org", ".", "springframework", ".", "security", ".", "core", ".", "userdetails", ".", "UserDetailsService", ";", "import", "org", ".", "springframework", ".", "security", ".", "crypto", ".", "codec", ".", "Hex", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "authentication", ".", "rememberme", ".", "TokenBasedRememberMeServices", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "FileInputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "net", ".", "InetAddress", ";", "import", "java", ".", "net", ".", "UnknownHostException", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "security", ".", "MessageDigest", ";", "import", "java", ".", "security", ".", "NoSuchAlgorithmException", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Objects", ";", "/", "**", "*", "This", "implements", "a", "zero", "-", "configuration", "version", "Spring", "Security", "'", "s", "token", "based", "remember", "-", "me", "service", ".", "While", "the", "key", "can", "*", "still", "be", "augmented", "by", "configuration", ",", "it", "is", "generally", "generated", "based", "on", "seldom", "changing", "but", "unique", "system", "*", "properties", "like", "hostname", ",", "IP", "address", ",", "file", "system", "information", "and", "Linux", "kernel", ".", "*", "/", "public", "class", "SystemTokenBasedRememberMeService", "extends", "TokenBasedRememberMeServices", "{", "private", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "SystemTokenBasedRememberMeService", ".", "class", ")", ";", "private", "String", "key", ";", "@", "Deprecated", "public", "SystemTokenBasedRememberMeService", "(", ")", "{", "super", "(", ");", "setKey", "(", "null", ")", ";", "}", "public", "SystemTokenBasedRememberMeService", "(", "String", "key", ",", "UserDetailsService", "userDetailsService", ")", "{", "super", "(", "key", ",", "userDetailsService", ")", ";", "setKey", "(", "key", ")", ";", "}", "/", "**", "*", "Set", "a", "new", "key", "to", "be", "used", "when", "generating", "remember", "-", "me", "tokens", ".", "*", "*", "Note", "that", "the", "key", "passed", "to", "this", "method", "will", "be", "augmented", "by", "seldom", "changing", "but", "generally", "unique", "system", "*", "properties", "like", "hostname", ",", "IP", "address", ",", "file", "system", "information", "and", "Linux", "kernel", ".", "Hence", ",", "even", "setting", "no", "custom", "*", "key", "should", "be", "save", ".", "*", "/", "@", "Override", "public", "void", "setKey", "(", "String", "key", ")", "{", "/", "/", "Start", "with", "a", "user", "key", "if", "provided", "StringBuilder", "keyBuilder", "=", "new", "StringBuilder", "(", "Objects", ".", "toString", "(", "key", ",", "\"", "\")", ");", "/", "/", "This", "will", "give", "us", "the", "hostname", "and", "IP", "address", "as", "something", "which", "should", "be", "unique", "per", "system", ".", "/", "/", "For", "example", ":", "lk", ".", "elan", "-", "ev", ".", "de", "/", "10", ".", "10", ".", "10", ".", "31", "try", "{", "keyBuilder", ".", "append", "(", "InetAddress", ".", "getLocalHost", "(", "))", ";", "}", "catch", "(", "UnknownHostException", "e", ")", "{", "/", "/", "silently", "ignore", "this", "}", "/", "/", "Gather", "additional", "system", "properties", "as", "key", "/", "/", "This", "requires", "a", "proc", "-", "fs", "which", "should", "generally", "be", "available", "under", "Linux", ".", "/", "/", "But", "even", "without", ",", "we", "have", "fallbacks", "above", "and", "below", ".", "for", "(", "String", "procFile", ":", "Arrays", ".", "asList", "(", "\"/", "proc", "/", "version", "\"", ",", "\"", "/", "proc", "/", "partitions", "\"", "))", "{", "try", "(", "FileInputStream", "fileInputStream", "=", "new", "FileInputStream", "(", "new", "File", "(", "procFile", ")", "))", "{", "keyBuilder", ".", "append", "(", "IOUtils", ".", "toString", "(", "fileInputStream", ",", "StandardCharsets", ".", "UTF_8", ")", ");", "}", "catch", "(", "IOException", "e", ")", "{", "/", "/", "ignore", "this", "}", "}", "/", "/", "If", "we", "still", "have", "no", "proper", "key", ",", "just", "generate", "a", "random", "one", ".", "/", "/", "This", "will", "work", "just", "fine", "with", "the", "single", "drawback", "that", "restarting", "Opencast", "invalidates", "all", "remember", "-", "me", "tokens", ".", "/", "/", "But", "it", "should", "be", "a", "sufficiently", "good", "fallback", ".", "key", "=", "keyBuilder", ".", "toString", "(", ");", "if", "(", "key", ".", "isEmpty", "(", "))", "{", "logger", ".", "warn", "(", "\"", "Could", "not", "generate", "semi", "-", "persistent", "remember", "-", "me", "key", ".", "Will", "generate", "a", "non", "-", "persistent", "random", "one", ".", "\")", ";", "key", "=", "Double", ".", "toString", "(", "Math", ".", "random", "(", "))", ";", "}", "logger", ".", "debug", "(", "\"", "Remember", "me", "key", "before", "hashing", ":", "{", "}\"", ",", "key", ")", ";", "/", "/", "Use", "a", "SHA", "-", "512", "hash", "as", "key", "to", "have", "a", "more", "sane", "key", ".", "try", "{", "MessageDigest", "digest", "=", "MessageDigest", ".", "getInstance", "(", "\"", "SHA", "-", "512", "\"", ");", "key", "=", "new", "String", "(", "Hex", ".", "encode", "(", "digest", ".", "digest", "(", "key", ".", "getBytes", "(", "))", "))", ";", "}", "catch", "(", "NoSuchAlgorithmException", "e", ")", "{", "logger", ".", "warn", "(", "\"", "No", "SHA", "-", "512", "algorithm", "available", "!", "\")", ";", "}", "logger", ".", "debug", "(", "\"", "Calculated", "remember", "me", "key", ":", "{", "}\"", ",", "key", ")", ";", "this", ".", "key", "=", "key", ";", "super", ".", "setKey", "(", "key", ")", ";", "}", "@", "Override", "public", "String", "getKey", "(", ")", "{", "return", "this", ".", "key", ";", "}", "/", "**", "*", "Calculates", "the", "digital", "signature", "to", "be", "put", "in", "the", "cookie", ".", "Default", "value", "is", "*", "SHA", "-", "512", "(", "\"", "username", ":", "tokenExpiryTime", ":", "password", ":", "key", "\"", ")", "*", "/", "@", "Override", "protected", "String", "makeTokenSignature", "(", "long", "tokenExpiryTime", ",", "String", "username", ",", "String", "password", ")", "{", "String", "data", "=", "username", "+", "\"", ":\"", "+", "tokenExpiryTime", "+", "\"", ":\"", "+", "password", "+", "\"", ":\"", "+", "getKey", "(", ");", "MessageDigest", "digest", ";", "try", "{", "digest", "=", "MessageDigest", ".", "getInstance", "(", "\"", "SHA", "-", "512", "\"", ");", "}", "catch", "(", "NoSuchAlgorithmException", "e", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "No", "SHA", "-", "512", "algorithm", "available", "!", "\")", ";", "}", "return", "new", "String", "(", "Hex", ".", "encode", "(", "digest", ".", "digest", "(", "data", ".", "getBytes", "(", "))", "))", ";", "}", "}"], "docstring_tokens": ["based", "on", "a", "hash", "created", "from", "the", "username"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "37", ",", "9", "+", "37", ",", "14", "@", "@", "<", "artifactId", ">", "nifi", "-", "utils", "<", "/", "artifactId", ">", "<", "version", ">", "1", ".", "12", ".", "0", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "/", "dependency", ">", "<", "!-", "-<", "dependency", ">", "--", ">", "<", "!-", "-<", "groupId", ">", "org", ".", "slf4j", "<", "/", "groupId", ">", "--", ">", "<", "!-", "-<", "artifactId", ">", "slf4j", "-", "api", "<", "/", "artifactId", ">", "--", ">", "<", "!-", "-<", "/", "dependency", ">", "--", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "slf4j", "<", "/", "groupId", ">", "<", "artifactId", ">", "slf4j", "-", "api", "<", "/", "artifactId", ">", "<", "groupId", ">", "ch", ".", "qos", ".", "logback", "<", "/", "groupId", ">", "<", "artifactId", ">", "logback", "-", "classic", "<", "/", "artifactId", ">", "<", "scope", ">", "provided", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "apache", ".", "commons", "<", "/", "groupId", ">", "@", "@", "-", "0", ",", "0", "+", "1", ",", "218", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "nifi", ".", "security", ".", "util", ".", "crypto", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "security", ".", "SecureRandom", ";", "import", "java", ".", "util", ".", "concurrent", ".", "TimeUnit", ";", "import", "org", ".", "bouncycastle", ".", "crypto", ".", "generators", ".", "Argon2BytesGenerator", ";", "import", "org", ".", "bouncycastle", ".", "crypto", ".", "params", ".", "Argon2Parameters", ";", "import", "org", ".", "bouncycastle", ".", "util", ".", "encoders", ".", "Base64", ";", "import", "org", ".", "bouncycastle", ".", "util", ".", "encoders", ".", "Hex", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "/", "**", "*", "Provides", "an", "implementation", "of", "{", "@", "code", "Argon2", "}", "for", "secure", "password", "hashing", ".", "This", "class", "is", "*", "roughly", "based", "on", "Spring", "Security", "'", "s", "implementation", "but", "does", "not", "include", "the", "full", "module", "*", "in", "this", "utility", "module", ".", "This", "implementation", "uses", "{", "@", "code", "Argon2id", "}", "which", "provides", "a", "*", "balance", "of", "protection", "against", "side", "-", "channel", "and", "memory", "attacks", ".", "*", "<", "p", ">", "*", "One", "<", "strong", ">", "critical", "<", "/", "strong", ">", "difference", "is", "that", "this", "implementation", "uses", "a", "*", "<", "strong", ">", "static", "universal", "<", "/", "strong", ">", "salt", "unless", "instructed", "otherwise", ",", "which", "provides", "*", "strict", "determinism", "across", "nodes", "in", "a", "cluster", ".", "The", "purpose", "for", "this", "is", "to", "allow", "for", "*", "blind", "equality", "comparison", "of", "sensitive", "values", "hashed", "on", "different", "nodes", "(", "with", "*", "potentially", "different", "{", "@", "code", "nifi", ".", "sensitive", ".", "props", ".", "key", "}", "values", ")", "during", "flow", "inheritance", "*", "(", "see", "{", "@", "code", "FingerprintFactory", "}", ").", "*", "/", "public", "class", "Argon2SecureHasher", "implements", "SecureHasher", "{", "private", "static", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "Argon2SecureHasher", ".", "class", ")", ";", "private", "static", "final", "int", "DEFAULT_SALT_LENGTH", "=", "16", ";", "private", "static", "final", "int", "DEFAULT_HASH_LENGTH", "=", "32", ";", "private", "static", "final", "int", "DEFAULT_PARALLELISM", "=", "1", ";", "private", "static", "final", "int", "DEFAULT_MEMORY", "=", "1", "<", "<", "12", ";", "private", "static", "final", "int", "DEFAULT_ITERATIONS", "=", "3", ";", "private", "final", "int", "hashLength", ";", "private", "final", "int", "memory", ";", "private", "final", "int", "parallelism", ";", "private", "final", "int", "iterations", ";", "private", "final", "int", "saltLength", ";", "private", "final", "boolean", "usingStaticSalt", ";", "/", "/", "A", "16", "byte", "salt", "(", "nonce", ")", "is", "recommended", "for", "password", "hashing", "private", "static", "final", "byte", "[", "]", "staticSalt", "=", "\"", "NiFi", "Static", "Salt", "\"", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ";", "/", "**", "*", "Instantiates", "an", "Argon2", "secure", "hasher", "using", "the", "default", "cost", "parameters", "*", "(", "{@", "code", "hashLength", "=", "}", "{@", "link", "#", "DEFAULT_HASH_LENGTH", "}", ",", "*", "{", "@", "code", "memory", "=", "}", "{@", "link", "#", "DEFAULT_MEMORY", "}", ",", "*", "{", "@", "code", "parallelism", "=", "}", "{@", "link", "#", "DEFAULT_PARALLELISM", "}", ",", "*", "{", "@", "code", "iterations", "=", "}", "{@", "link", "#", "DEFAULT_ITERATIONS", "}", ").", "A", "static", "salt", "is", "also", "used", ".", "*", "/", "public", "Argon2SecureHasher", "(", ")", "{", "this", "(", "DEFAULT_HASH_LENGTH", ",", "DEFAULT_MEMORY", ",", "DEFAULT_PARALLELISM", ",", "DEFAULT_ITERATIONS", ",", "0", ")", ";", "}", "/", "**", "*", "Instantiates", "an", "Argon2", "secure", "hasher", "using", "the", "provided", "cost", "parameters", ".", "A", "unique", "*", "{", "@", "link", "#", "DEFAULT_SALT_LENGTH", "}", "byte", "salt", "will", "be", "generated", "on", "every", "hash", "request", ".", "*", "*", "@", "param", "hashLength", "the", "output", "length", "in", "bytes", "(", "{@", "code", "4", "to", "2", "^", "32", "-", "1", "}", ")", "*", "@", "param", "memory", "the", "integer", "number", "of", "KB", "used", "(", "{@", "code", "8p", "to", "2", "^", "32", "-", "1", "}", ")", "*", "@", "param", "parallelism", "degree", "of", "parallelism", "(", "{@", "code", "1", "to", "2", "^", "24", "-", "1", "}", ")", "*", "@", "param", "iterations", "number", "of", "iterations", "(", "{@", "code", "1", "to", "2", "^", "32", "-", "1", "}", ")", "*", "/", "public", "Argon2SecureHasher", "(", "int", "hashLength", ",", "int", "memory", ",", "int", "parallelism", ",", "int", "iterations", ")", "{", "this", "(", "hashLength", ",", "memory", ",", "parallelism", ",", "iterations", ",", "0", ")", ";", "}", "/", "**", "*", "Instantiates", "an", "Argon2", "secure", "hasher", "using", "the", "provided", "cost", "parameters", ".", "A", "unique", "*", "salt", "of", "the", "specified", "length", "will", "be", "generated", "on", "every", "hash", "request", ".", "*", "*", "@", "param", "hashLength", "the", "output", "length", "in", "bytes", "(", "{@", "code", "4", "to", "2", "^", "32", "-", "1", "}", ")", "*", "@", "param", "memory", "the", "integer", "number", "of", "KB", "used", "(", "{@", "code", "8p", "to", "2", "^", "32", "-", "1", "}", ")", "*", "@", "param", "parallelism", "degree", "of", "parallelism", "(", "{@", "code", "1", "to", "2", "^", "24", "-", "1", "}", ")", "*", "@", "param", "iterations", "number", "of", "iterations", "(", "{@", "code", "1", "to", "2", "^", "32", "-", "1", "}", ")", "*", "@", "param", "saltLength", "the", "salt", "length", "in", "bytes", "{", "@", "code", "8", "to", "2", "^", "32", "-", "1", "}", ")", "*", "/", "public", "Argon2SecureHasher", "(", "int", "hashLength", ",", "int", "memory", ",", "int", "parallelism", ",", "int", "iterations", ",", "int", "saltLength", ")", "{", "/", "/", "TODO", ":", "Implement", "boundary", "checking", "this", ".", "hashLength", "=", "hashLength", ";", "this", ".", "memory", "=", "memory", ";", "this", ".", "parallelism", "=", "parallelism", ";", "this", ".", "iterations", "=", "iterations", ";", "this", ".", "saltLength", "=", "saltLength", ";", "if", "(", "saltLength", ">", "0", ")", "{", "this", ".", "usingStaticSalt", "=", "false", ";", "}", "else", "{", "this", ".", "usingStaticSalt", "=", "true", ";", "logger", ".", "debug", "(", "\"", "Configured", "to", "use", "static", "salt", "\"", ");", "}", "}", "/", "**", "*", "Returns", "{", "@", "code", "true", "}", "if", "this", "instance", "is", "configured", "to", "use", "a", "static", "salt", ".", "*", "*", "@", "return", "true", "if", "all", "hashes", "will", "be", "generated", "using", "a", "static", "salt", "*", "/", "public", "boolean", "isUsingStaticSalt", "(", ")", "{", "return", "usingStaticSalt", ";", "}", "/", "**", "*", "Returns", "a", "salt", "to", "use", ".", "If", "using", "a", "static", "salt", "(", "see", "{", "@", "link", "#", "isUsingStaticSalt", "(", ")}", "),", "*", "this", "return", "value", "will", "be", "identical", "across", "every", "invocation", ".", "If", "using", "a", "dynamic", "salt", ",", "*", "it", "will", "be", "{", "@", "link", "#", "saltLength", "}", "bytes", "of", "a", "securely", "-", "generated", "random", "value", ".", "*", "*", "@", "return", "the", "salt", "value", "*", "/", "byte", "[", "]", "getSalt", "(", ")", "{", "if", "(", "isUsingStaticSalt", "(", "))", "{", "return", "staticSalt", ";", "}", "else", "{", "SecureRandom", "sr", "=", "new", "SecureRandom", "(", ");", "byte", "[", "]", "salt", "=", "new", "byte", "[", "saltLength", "]", ";", "sr", ".", "nextBytes", "(", "salt", ")", ";", "return", "salt", ";", "}", "}", "/", "**", "*", "Returns", "a", "String", "representation", "of", "{", "@", "code", "CHF", "(", "input", ")", "}", "in", "hex", "-", "encoded", "format", ".", "*", "*", "@", "param", "input", "the", "input", "*", "@", "return", "the", "hex", "-", "encoded", "hash", "*", "/", "@", "Override", "public", "String", "hashHex", "(", "String", "input", ")", "{", "if", "(", "input", "=", "=", "null", ")", "{", "logger", ".", "warn", "(", "\"", "Attempting", "to", "generate", "an", "Argon2", "hash", "of", "null", "input", ";", "using", "empty", "input", "\"", ");", "input", "=", "\"", "\";", "}", "return", "Hex", ".", "toHexString", "(", "hash", "(", "input", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", "))", ";", "}", "/", "**", "*", "Returns", "a", "String", "representation", "of", "{", "@", "code", "CHF", "(", "input", ")", "}", "in", "Base", "64", "-", "encoded", "format", ".", "*", "*", "@", "param", "input", "the", "input", "*", "@", "return", "the", "Base", "64", "-", "encoded", "hash", "*", "/", "@", "Override", "public", "String", "hashBase64", "(", "String", "input", ")", "{", "if", "(", "input", "=", "=", "null", ")", "{", "logger", ".", "warn", "(", "\"", "Attempting", "to", "generate", "an", "Argon2", "hash", "of", "null", "input", ";", "using", "empty", "input", "\"", ");", "input", "=", "\"", "\";", "}", "return", "Base64", ".", "toBase64String", "(", "hash", "(", "input", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", "))", ";", "}", "/", "**", "*", "Returns", "a", "byte", "[", "]", "representation", "of", "{", "@", "code", "CHF", "(", "input", ")", "}.", "*", "*", "@", "param", "input", "the", "input", "*", "@", "return", "the", "hash", "*", "/", "@", "Override", "public", "byte", "[", "]", "hashRaw", "(", "byte", "[", "]", "input", ")", "{", "return", "hash", "(", "input", ")", ";", "}", "/", "**", "*", "Internal", "method", "to", "hash", "the", "raw", "bytes", ".", "*", "*", "@", "param", "input", "the", "raw", "bytes", "to", "hash", "(", "can", "be", "length", "0", ")", "*", "@", "return", "the", "generated", "hash", "*", "/", "private", "byte", "[", "]", "hash", "(", "byte", "[", "]", "input", ")", "{", "byte", "[", "]", "salt", "=", "getSalt", "(", ");", "byte", "[", "]", "hash", "=", "new", "byte", "[", "hashLength", "]", ";", "logger", ".", "debug", "(", "\"", "Creating", "{", "}", "byte", "Argon2", "hash", "with", "salt", "[", "{}", "]\"", ",", "hashLength", ",", "Hex", ".", "toHexString", "(", "salt", ")", ");", "final", "long", "startNanos", "=", "System", ".", "nanoTime", "(", ");", "Argon2Parameters", "params", "=", "new", "Argon2Parameters", ".", "Builder", "(", "Argon2Parameters", ".", "ARGON2_id", ")", ".", "withSalt", "(", "salt", ")", ".", "withParallelism", "(", "parallelism", ")", ".", "withMemoryAsKB", "(", "memory", ")", ".", "withIterations", "(", "iterations", ")", ".", "build", "(", ");", "Argon2BytesGenerator", "generator", "=", "new", "Argon2BytesGenerator", "(", ");", "generator", ".", "init", "(", "params", ")", ";", "final", "long", "initNanos", "=", "System", ".", "nanoTime", "(", ");", "generator", ".", "generateBytes", "(", "input", ",", "hash", ")", ";", "final", "long", "generateNanos", "=", "System", ".", "nanoTime", "(", ");", "final", "long", "initDurationMicros", "=", "TimeUnit", ".", "NANOSECONDS", ".", "toMicros", "(", "initNanos", "-", "startNanos", ")", ";", "final", "long", "generateDurationMicros", "=", "TimeUnit", ".", "NANOSECONDS", ".", "toMicros", "(", "generateNanos", "-", "initNanos", ")", ";", "final", "long", "totalDurationMillis", "=", "TimeUnit", ".", "MICROSECONDS", ".", "toMillis", "(", "initDurationMicros", "+", "generateDurationMicros", ")", ";", "logger", ".", "debug", "(", "\"", "Generated", "Argon2", "hash", "in", "{", "}", "ms", "(", "init", ":", "{", "}", "\u00b5", "s", ",", "generate", ":", "{", "}", "\u00b5", "s", ")", "\",", "totalDurationMillis", ",", "initDurationMicros", ",", "generateDurationMicros", ")", ";", "return", "hash", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "56", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "nifi", ".", "security", ".", "util", ".", "crypto", ";", "/", "**", "*", "An", "interface", "which", "specifies", "that", "implementations", "should", "provide", "a", "*", "cryptographic", "hash", "function", "(", "CHF", ")", "which", "accepts", "input", "and", "returns", "a", "*", "deterministic", ",", "(", "mathematically", "-", "difficult", ")", "irreversible", "value", ".", "*", "*", "While", "SHA", "-", "256", ",", "SHA", "-", "512", ",", "and", "Blake2", "are", "CHF", "implementations", ",", "this", "interface", "is", "intended", "to", "*", "be", "used", "by", "password", "protection", "or", "key", "derivation", "functions", "(", "KDF", ")", "like", "*", "{", "@", "link", "PBKDF2CipherProvider", "}", ",", "{", "@", "link", "BcryptCipherProvider", "}", ",", "{", "@", "link", "ScryptCipherProvider", "}", ",", "*", "or", "{", "@", "link", "Argon2SecureHasher", "}", ".", "These", "classes", "implement", "iterative", "processes", "which", "make", "use", "*", "of", "cryptographic", "primitives", "to", "return", "an", "irreversible", "value", "which", "can", "either", "securely", "*", "store", "a", "password", "representation", "or", "be", "used", "as", "an", "encryption", "key", "derived", "from", "a", "password", ".", "*", "/", "public", "interface", "SecureHasher", "{", "/", "**", "*", "Returns", "a", "String", "representation", "of", "{", "@", "code", "CHF", "(", "input", ")", "}", "in", "hex", "-", "encoded", "format", ".", "*", "*", "@", "param", "input", "the", "input", "*", "@", "return", "the", "hex", "-", "encoded", "hash", "*", "/", "String", "hashHex", "(", "String", "input", ")", ";", "/", "**", "*", "Returns", "a", "String", "representation", "of", "{", "@", "code", "CHF", "(", "input", ")", "}", "in", "Base", "64", "-", "encoded", "format", ".", "*", "*", "@", "param", "input", "the", "input", "*", "@", "return", "the", "Base", "64", "-", "encoded", "hash", "*", "/", "String", "hashBase64", "(", "String", "input", ")", ";", "/", "**", "*", "Returns", "a", "byte", "[", "]", "representation", "of", "{", "@", "code", "CHF", "(", "input", ")", "}.", "*", "*", "@", "param", "input", "the", "input", "*", "@", "return", "the", "hash", "*", "/", "byte", "[", "]", "hashRaw", "(", "byte", "[", "]", "input", ")", ";", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "242", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "nifi", ".", "security", ".", "util", ".", "crypto", "import", "org", ".", "apache", ".", "kerby", ".", "util", ".", "Hex", "import", "org", ".", "bouncycastle", ".", "jce", ".", "provider", ".", "BouncyCastleProvider", "import", "org", ".", "junit", ".", "After", "import", "org", ".", "junit", ".", "Before", "import", "org", ".", "junit", ".", "BeforeClass", "import", "org", ".", "junit", ".", "Ignore", "import", "org", ".", "junit", ".", "Test", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", "import", "org", ".", "junit", ".", "runners", ".", "JUnit4", "import", "org", ".", "slf4j", ".", "Logger", "import", "org", ".", "slf4j", ".", "LoggerFactory", "import", "java", ".", "security", ".", "Security", "@", "RunWith", "(", "JUnit4", ".", "class", ")", "class", "Argon2SecureHasherTest", "extends", "GroovyTestCase", "{", "private", "static", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "Argon2SecureHasherTest", ".", "class", ")", "@", "BeforeClass", "static", "void", "setUpOnce", "(", ")", "throws", "Exception", "{", "Security", ".", "addProvider", "(", "new", "BouncyCastleProvider", "(", "))", "logger", ".", "metaClass", ".", "methodMissing", "=", "{", "String", "name", ",", "args", "-", ">", "logger", ".", "info", "(", "\"[", "${", "name", "?", ".", "toUpperCase", "(", ")}", "]", "$", "{(", "args", "as", "List", ")", ".", "join", "(", "\"", "\"", ")}", "\")", "}", "}", "@", "Before", "void", "setUp", "(", ")", "throws", "Exception", "{", "}", "@", "After", "void", "tearDown", "(", ")", "throws", "Exception", "{", "}", "private", "static", "byte", "[", "]", "decodeHex", "(", "String", "hex", ")", "{", "Hex", ".", "decode", "(", "hex", "?", ".", "replaceAll", "(", "\"[", "^", "0", "-", "9a", "-", "fA", "-", "F", "]", "\",", "\"", "\")", ")", "}", "@", "Ignore", "(", "\"", "Cannot", "override", "static", "salt", "\"", ")", "@", "Test", "void", "testShouldMatchReferenceVectors", "(", ")", "{", "/", "/", "Arrange", "int", "hashLength", "=", "32", "int", "memory", "=", "32", "int", "parallelism", "=", "4", "int", "iterations", "=", "3", "logger", ".", "info", "(", "\"", "Generating", "Argon2", "hash", "for", "hash", "length", ":", "$", "{", "hashLength", "}", "B", ",", "mem", ":", "$", "{", "memory", "}", "KiB", ",", "parallelism", ":", "$", "{", "parallelism", "}", ",", "iterations", ":", "$", "{", "iterations", "}", "\")", "Argon2SecureHasher", "a2sh", "=", "new", "Argon2SecureHasher", "(", "hashLength", ",", "memory", ",", "parallelism", ",", "iterations", ")", "/", "/", "Override", "the", "static", "salt", "for", "the", "published", "test", "vector", "/", "/", "a2sh", ".", "staticSalt", "=", "[", "0x02", "]", "*", "16", "/", "/", "Act", "byte", "[", "]", "hash", "=", "a2sh", ".", "hashRaw", "(", "[", "0x01", "]", "*", "32", "as", "byte", "[", "])", "logger", ".", "info", "(", "\"", "Generated", "hash", ":", "$", "{", "Hex", ".", "encode", "(", "hash", ")", "}\"", ")", "/", "/", "Assert", "assert", "hash", "=", "=", "decodeHex", "(", "\"", "0d", "64", "0d", "f5", "8d", "78", "76", "6c", "08", "c0", "37", "a3", "4a", "8b", "53", "c9", "d0", "\"", "\"", "1e", "f0", "45", "2d", "75", "b6", "5e", "b5", "25", "20", "e9", "6b", "01", "e6", "59", "\"", ")", "/", "/", "Clean", "up", "/", "/", "Argon2SecureHasher", ".", "staticSalt", "=", "\"", "NiFi", "Static", "Salt", "\"", ".", "bytes", "}", "@", "Test", "void", "testShouldBeDeterministicWithStaticSalt", "(", ")", "{", "/", "/", "Arrange", "int", "hashLength", "=", "32", "int", "memory", "=", "8", "int", "parallelism", "=", "4", "int", "iterations", "=", "4", "logger", ".", "info", "(", "\"", "Generating", "Argon2", "hash", "for", "hash", "length", ":", "$", "{", "hashLength", "}", "B", ",", "mem", ":", "$", "{", "memory", "}", "KiB", ",", "parallelism", ":", "$", "{", "parallelism", "}", ",", "iterations", ":", "$", "{", "iterations", "}", "\")", "int", "testIterations", "=", "10", "byte", "[", "]", "inputBytes", "=", "\"", "This", "is", "a", "sensitive", "value", "\"", ".", "bytes", "final", "String", "EXPECTED_HASH_HEX", "=", "\"", "a73a471f51b2900901a00b81e770b9c1dfc595602bb7aec64cd27754a4174919", "\"", "Argon2SecureHasher", "a2sh", "=", "new", "Argon2SecureHasher", "(", "hashLength", ",", "memory", ",", "parallelism", ",", "iterations", ")", "def", "results", "=", "[", "]", "/", "/", "Act", "testIterations", ".", "times", "{", "int", "i", "-", ">", "byte", "[", "]", "hash", "=", "a2sh", ".", "hashRaw", "(", "inputBytes", ")", "String", "hashHex", "=", "Hex", ".", "encode", "(", "hash", ")", "logger", ".", "info", "(", "\"", "Generated", "hash", ":", "$", "{", "hashHex", "}", "\")", "results", "<", "<", "hashHex", "}", "/", "/", "Assert", "assert", "results", ".", "every", "{", "it", "=", "=", "EXPECTED_HASH_HEX", "}", "}", "@", "Test", "void", "testShouldBeDifferentWithRandomSalt", "(", ")", "{", "/", "/", "Arrange", "int", "hashLength", "=", "32", "int", "memory", "=", "8", "int", "parallelism", "=", "4", "int", "iterations", "=", "4", "logger", ".", "info", "(", "\"", "Generating", "Argon2", "hash", "for", "hash", "length", ":", "$", "{", "hashLength", "}", "B", ",", "mem", ":", "$", "{", "memory", "}", "KiB", ",", "parallelism", ":", "$", "{", "parallelism", "}", ",", "iterations", ":", "$", "{", "iterations", "}", "\")", "int", "testIterations", "=", "10", "byte", "[", "]", "inputBytes", "=", "\"", "This", "is", "a", "sensitive", "value", "\"", ".", "bytes", "final", "String", "EXPECTED_HASH_HEX", "=", "\"", "a73a471f51b2900901a00b81e770b9c1dfc595602bb7aec64cd27754a4174919", "\"", "Argon2SecureHasher", "a2sh", "=", "new", "Argon2SecureHasher", "(", "hashLength", ",", "memory", ",", "parallelism", ",", "iterations", ",", "16", ")", "def", "results", "=", "[", "]", "/", "/", "Act", "testIterations", ".", "times", "{", "int", "i", "-", ">", "byte", "[", "]", "hash", "=", "a2sh", ".", "hashRaw", "(", "inputBytes", ")", "String", "hashHex", "=", "Hex", ".", "encode", "(", "hash", ")", "logger", ".", "info", "(", "\"", "Generated", "hash", ":", "$", "{", "hashHex", "}", "\")", "results", "<", "<", "hashHex", "}", "/", "/", "Assert", "assert", "results", ".", "unique", "(", ").", "size", "(", ")", "=", "=", "results", ".", "size", "(", ")", "assert", "results", ".", "every", "{", "it", "!", "=", "EXPECTED_HASH_HEX", "}", "}", "@", "Test", "void", "testShouldFormatHex", "(", ")", "{", "/", "/", "Arrange", "String", "input", "=", "\"", "This", "is", "a", "sensitive", "value", "\"", "final", "String", "EXPECTED_HASH_HEX", "=", "\"", "0c2920c52f28e0a2c77d006ec6138c8dc59580881468b85541cf886abdebcf18", "\"", "Argon2SecureHasher", "a2sh", "=", "new", "Argon2SecureHasher", "(", ")", "/", "/", "Act", "String", "hashHex", "=", "a2sh", ".", "hashHex", "(", "input", ")", "logger", ".", "info", "(", "\"", "Generated", "hash", ":", "$", "{", "hashHex", "}", "\")", "/", "/", "Assert", "assert", "hashHex", "=", "=", "EXPECTED_HASH_HEX", "}", "@", "Test", "void", "testShouldFormatBase64", "(", ")", "{", "/", "/", "Arrange", "String", "input", "=", "\"", "This", "is", "a", "sensitive", "value", "\"", "final", "String", "EXPECTED_HASH_B64", "=", "\"", "DCkgxS8o4KLHfQBuxhOMjcWVgIgUaLhVQc", "+", "Iar3rzxg", "=", "\"", "Argon2SecureHasher", "a2sh", "=", "new", "Argon2SecureHasher", "(", ")", "/", "/", "Act", "String", "hashB64", "=", "a2sh", ".", "hashBase64", "(", "input", ")", "logger", ".", "info", "(", "\"", "Generated", "hash", ":", "$", "{", "hashB64", "}", "\")", "/", "/", "Assert", "assert", "hashB64", "=", "=", "EXPECTED_HASH_B64", "}", "@", "Test", "void", "testShouldHandleNullInput", "(", ")", "{", "/", "/", "Arrange", "List", "<", "String", ">", "inputs", "=", "[", "null", ",", "\"", "\"]", "final", "String", "EXPECTED_HASH_HEX", "=", "\"", "8e5625a66b94ed9d31c1496d7f9ff49249cf05d6753b50ba0e2bf2a1108973dd", "\"", "final", "String", "EXPECTED_HASH_B64", "=", "\"", "jlYlpmuU7Z0xwUltf5", "/", "0kknPBdZ1O1C6DivyoRCJc90", "=", "\"", "Argon2SecureHasher", "a2sh", "=", "new", "Argon2SecureHasher", "(", ")", "def", "hexResults", "=", "[", "]", "def", "b64Results", "=", "[", "]", "/", "/", "Act", "inputs", ".", "each", "{", "String", "input", "-", ">", "String", "hashHex", "=", "a2sh", ".", "hashHex", "(", "input", ")", "logger", ".", "info", "(", "\"", "Generated", "hash", ":", "$", "{", "hashHex", "}", "\")", "hexResults", "<", "<", "hashHex", "String", "hashB64", "=", "a2sh", ".", "hashBase64", "(", "input", ")", "logger", ".", "info", "(", "\"", "Generated", "hash", ":", "$", "{", "hashB64", "}", "\")", "b64Results", "<", "<", "hashB64", "}", "/", "/", "Assert", "assert", "hexResults", ".", "every", "{", "it", "=", "=", "EXPECTED_HASH_HEX", "}", "assert", "b64Results", ".", "every", "{", "it", "=", "=", "EXPECTED_HASH_B64", "}", "}", "/", "**", "*", "This", "test", "can", "have", "the", "minimum", "time", "threshold", "updated", "to", "determine", "if", "the", "performance", "*", "is", "still", "sufficient", "compared", "to", "the", "existing", "threat", "model", ".", "*", "/", "@", "Test", "void", "testDefaultCostParamsShouldBeSufficient", "(", ")", "{", "/", "/", "Arrange", "int", "testIterations", "=", "10", "byte", "[", "]", "inputBytes", "=", "\"", "This", "is", "a", "sensitive", "value", "\"", ".", "bytes", "Argon2SecureHasher", "a2sh", "=", "new", "Argon2SecureHasher", "(", ")", "def", "results", "=", "[", "]", "def", "resultDurations", "=", "[", "]", "/", "/", "Act", "testIterations", ".", "times", "{", "int", "i", "-", ">", "long", "startNanos", "=", "System", ".", "nanoTime", "(", ")", "byte", "[", "]", "hash", "=", "a2sh", ".", "hashRaw", "(", "inputBytes", ")", "long", "endNanos", "=", "System", ".", "nanoTime", "(", ")", "long", "durationNanos", "=", "endNanos", "-", "startNanos", "String", "hashHex", "=", "Hex", ".", "encode", "(", "hash", ")", "logger", ".", "info", "(", "\"", "Generated", "hash", ":", "$", "{", "hashHex", "}", "in", "$", "{", "durationNanos", "}", "ns", "\"", ")", "results", "<", "<", "hashHex", "resultDurations", "<", "<", "durationNanos", "}", "/", "/", "Assert", "final", "long", "MIN_DURATION_NANOS", "=", "5_000_000", "/", "/", "5", "ms", "assert", "resultDurations", ".", "min", "(", ")", ">", "MIN_DURATION_NANOS", "assert", "resultDurations", ".", "sum", "(", ")", "/", "testIterations", ">", "MIN_DURATION_NANOS", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "39", "@", "@", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "?>", "<", "!-", "-", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "the", "License", ".", "-", "->", "<", "configuration", ">", "<", "appender", "name", "=", "\"", "CONSOLE", "\"", "class", "=", "\"", "ch", ".", "qos", ".", "logback", ".", "core", ".", "ConsoleAppender", "\"", ">", "<", "encoder", "class", "=", "\"", "ch", ".", "qos", ".", "logback", ".", "classic", ".", "encoder", ".", "PatternLayoutEncoder", "\"", ">", "<", "pattern", ">", "%-", "4r", "[", "%", "t", "]", "%", "-", "5p", "%", "c", "{", "3", "}", "-", "%", "m", "%", "n", "<", "/", "pattern", ">", "<", "/", "encoder", ">", "<", "/", "appender", ">", "<", "appender", "name", "=", "\"", "FILE", "\"", "class", "=", "\"", "ch", ".", "qos", ".", "logback", ".", "core", ".", "FileAppender", "\"", ">", "<", "file", ">", "./", "target", "/", "log", "<", "/", "file", ">", "<", "encoder", "class", "=", "\"", "ch", ".", "qos", ".", "logback", ".", "classic", ".", "encoder", ".", "PatternLayoutEncoder", "\"", ">", "<", "pattern", ">", "%", "date", "%", "level", "[", "%", "thread", "]", "%", "logger", "{", "40", "}", "%", "msg", "%", "n", "<", "/", "pattern", ">", "<", "/", "encoder", ">", "<", "/", "appender", ">", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", "\"", "level", "=", "\"", "INFO", "\"", "/>", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", ".", "security", ".", "util", ".", "crypto", "\"", "level", "=", "\"", "DEBUG", "\"", "/>", "<", "root", "level", "=", "\"", "DEBUG", "\"", ">", "<", "appender", "-", "ref", "ref", "=", "\"", "CONSOLE", "\"", "/>", "<", "/", "root", ">", "<", "/", "configuration", ">", "@", "@", "-", "16", ",", "6", "+", "16", ",", "23", "@", "@", "*", "/", "package", "org", ".", "apache", ".", "nifi", ".", "fingerprint", ";", "import", "java", ".", "io", ".", "ByteArrayInputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "UnsupportedEncodingException", ";", "import", "java", ".", "security", ".", "NoSuchAlgorithmException", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Comparator", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "SortedMap", ";", "import", "java", ".", "util", ".", "TreeMap", ";", "import", "java", ".", "util", ".", "stream", ".", "Stream", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "validation", ".", "Schema", ";", "import", "javax", ".", "xml", ".", "validation", ".", "SchemaFactory", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang3", ".", "StringUtils", ";", "import", "org", ".", "apache", ".", "nifi", ".", "bundle", ".", "BundleCoordinate", ";", "import", "org", ".", "apache", ".", "nifi", ".", "components", ".", "ConfigurableComponent", ";", "@", "@", "-", "25", ",", "6", "+", "42", ",", "8", "@", "@", "import", "org", ".", "apache", ".", "nifi", ".", "controller", ".", "serialization", ".", "FlowFromDOMFactory", ";", "import", "org", ".", "apache", ".", "nifi", ".", "encrypt", ".", "StringEncryptor", ";", "import", "org", ".", "apache", ".", "nifi", ".", "nar", ".", "ExtensionManager", ";", "import", "org", ".", "apache", ".", "nifi", ".", "security", ".", "util", ".", "crypto", ".", "Argon2SecureHasher", ";", "import", "org", ".", "apache", ".", "nifi", ".", "security", ".", "util", ".", "crypto", ".", "SecureHasher", ";", "import", "org", ".", "apache", ".", "nifi", ".", "util", ".", "BundleUtils", ";", "import", "org", ".", "apache", ".", "nifi", ".", "util", ".", "DomUtils", ";", "import", "org", ".", "apache", ".", "nifi", ".", "util", ".", "LoggingXmlParserErrorHandler", ";", "@", "@", "-", "39", ",", "24", "+", "58", ",", "6", "@", "@", "import", "org", ".", "w3c", ".", "dom", ".", "NodeList", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "validation", ".", "Schema", ";", "import", "javax", ".", "xml", ".", "validation", ".", "SchemaFactory", ";", "import", "java", ".", "io", ".", "ByteArrayInputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "UnsupportedEncodingException", ";", "import", "java", ".", "security", ".", "NoSuchAlgorithmException", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Comparator", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "SortedMap", ";", "import", "java", ".", "util", ".", "TreeMap", ";", "import", "java", ".", "util", ".", "stream", ".", "Stream", ";", "/", "**", "*", "<", "p", ">", "Creates", "a", "fingerprint", "of", "a", "flow", ".", "xml", ".", "The", "order", "of", "elements", "or", "attributes", "in", "the", "flow", ".", "xml", "does", "not", "influence", "the", "fingerprint", "generation", ".", "*", "@", "@", "-", "342", ",", "7", "+", "343", ",", "7", "@", "@", "private", "void", "addParameter", "(", "final", "StringBuilder", "builder", ",", "final", "Element", "parameterEl", "/", "/", "append", "value", "if", "(", "isEncrypted", "(", "value", ")", ")", "{", "/", "/", "propValue", "is", "non", "null", ",", "no", "need", "to", "use", "getValue", "builder", ".", "append", "(", "decrypt", "(", "value", ")", ");", "builder", ".", "append", "(", "getLoggableRepresentationOfSensitiveValue", "(", "value", ")", ");", "}", "else", "{", "builder", ".", "append", "(", "getValue", "(", "value", ",", "NO_VALUE", ")", ");", "}", "@", "@", "-", "532", ",", "15", "+", "533", ",", "41", "@", "@", "private", "StringBuilder", "addPropertyFingerprint", "(", "final", "StringBuilder", "builder", ",", "final", "/", "/", "append", "value", "if", "(", "isEncrypted", "(", "propValue", ")", ")", "{", "/", "/", "propValue", "is", "non", "null", ",", "no", "need", "to", "use", "getValue", "builder", ".", "append", "(", "decrypt", "(", "propValue", ")", ");", "/", "/", "Get", "a", "secure", ",", "deterministic", ",", "loggable", "representation", "of", "this", "value", "builder", ".", "append", "(", "getLoggableRepresentationOfSensitiveValue", "(", "propValue", ")", ");", "}", "else", "{", "builder", ".", "append", "(", "getValue", "(", "propValue", ",", "NO_VALUE", ")", ");", "}", "return", "builder", ";", "}", "/", "**", "*", "Returns", "a", "securely", "-", "derived", ",", "deterministic", "value", "from", "the", "provided", "encrypted", "property", "*", "value", ".", "This", "is", "because", "the", "flow", "fingerprint", "is", "displayed", "in", "the", "log", "if", "NiFi", "has", "*", "trouble", "inheriting", "a", "flow", ",", "so", "the", "sensitive", "value", "should", "not", "be", "disclosed", "through", "the", "*", "log", ".", "However", ",", "the", "equality", "or", "difference", "of", "the", "sensitive", "value", "can", "influence", "in", "the", "*", "inheritability", "of", "the", "flow", ",", "so", "it", "cannot", "be", "ignored", "completely", ".", "*", "*", "The", "specific", "derivation", "process", "is", "unimportant", "as", "long", "as", "it", "is", "a", "salted", ",", "*", "cryptographically", "-", "secure", "hash", "function", "with", "an", "iteration", "cost", "sufficient", "for", "password", "*", "storage", "in", "other", "applications", ".", "*", "*", "@", "param", "encryptedPropertyValue", "the", "encrypted", "property", "value", "*", "@", "return", "a", "deterministic", "string", "value", "which", "represents", "this", "input", "but", "is", "safe", "to", "print", "in", "a", "log", "*", "/", "private", "String", "getLoggableRepresentationOfSensitiveValue", "(", "String", "encryptedPropertyValue", ")", "{", "/", "/", "TODO", ":", "Implement", "Scrypt", "or", "Argon2", "secure", "hash", "of", "decrypted", "value", "/", "/", "TODO", ":", "Use", "DI", "/", "IoC", "to", "inject", "this", "implementation", "in", "the", "constructor", "of", "the", "FingerprintFactory", "/", "/", "There", "is", "little", "initialization", "cost", ",", "so", "it", "doesn", "'", "t", "make", "sense", "to", "cache", "this", "as", "a", "field", "SecureHasher", "secureHasher", "=", "new", "Argon2SecureHasher", "(", ");", "/", "/", "TODO", ":", "Extend", "{", "@", "link", "StringEncryptor", "}", "with", "secure", "hashing", "capability", "and", "inject", "?", "String", "hexEncodedHash", "=", "secureHasher", ".", "hashHex", "(", "decrypt", "(", "encryptedPropertyValue", ")", ");", "return", "hexEncodedHash", ";", "}", "private", "StringBuilder", "addPortFingerprint", "(", "final", "StringBuilder", "builder", ",", "final", "Element", "portElem", ")", "throws", "FingerprintException", "{", "/", "/", "id", "appendFirstValue", "(", "builder", ",", "DomUtils", ".", "getChildNodesByTagName", "(", "portElem", ",", "\"", "id", "\"", "))", ";", "@", "@", "-", "593", ",", "7", "+", "620", ",", "7", "@", "@", "private", "StringBuilder", "addRemoteProcessGroupFingerprint", "(", "final", "StringBuilder", "build", "\"", "transportProtocol", "\"", ",", "\"", "proxyHost", "\"", ",", "\"", "proxyPort", "\"", ",", "\"", "proxyUser", "\"", ",", "\"", "proxyPassword", "\"", "})", "{", "final", "String", "value", "=", "getFirstValue", "(", "DomUtils", ".", "getChildNodesByTagName", "(", "remoteProcessGroupElem", ",", "tagName", ")", ");", "if", "(", "isEncrypted", "(", "value", ")", ")", "{", "builder", ".", "append", "(", "decrypt", "(", "value", ")", ");", "builder", ".", "append", "(", "getLoggableRepresentationOfSensitiveValue", "(", "value", ")", ");", "}", "else", "{", "builder", ".", "append", "(", "value", ")", ";", "}", "@", "@", "-", "824", ",", "15", "+", "851", ",", "15", "@", "@", "public", "int", "compare", "(", "final", "Element", "e1", ",", "final", "Element", "e2", ")", "{", "final", "String", "e1PropName", "=", "getFirstValue", "(", "DomUtils", ".", "getChildNodesByTagName", "(", "e1", ",", "\"", "name", "\"", "))", ";", "String", "e1PropValue", "=", "getFirstValue", "(", "DomUtils", ".", "getChildNodesByTagName", "(", "e1", ",", "\"", "value", "\"", "))", ";", "if", "(", "isEncrypted", "(", "e1PropValue", ")", ")", "{", "e1PropValue", "=", "decrypt", "(", "e1PropValue", ")", ";", "e1PropValue", "=", "getLoggableRepresentationOfSensitiveValue", "(", "e1PropValue", ")", ";", "}", "final", "String", "e1CombinedValue", "=", "e1PropName", "+", "e1PropValue", ";", "/", "/", "combine", "the", "property", "name", "and", "value", "for", "the", "second", "required", "property", "final", "String", "e2PropName", "=", "getFirstValue", "(", "DomUtils", ".", "getChildNodesByTagName", "(", "e2", ",", "\"", "name", "\"", "))", ";", "String", "e2PropValue", "=", "getFirstValue", "(", "DomUtils", ".", "getChildNodesByTagName", "(", "e2", ",", "\"", "value", "\"", "))", ";", "if", "(", "isEncrypted", "(", "e2PropValue", ")", ")", "{", "e2PropValue", "=", "decrypt", "(", "e2PropValue", ")", ";", "e2PropValue", "=", "getLoggableRepresentationOfSensitiveValue", "(", "e2PropValue", ")", ";", "}", "final", "String", "e2CombinedValue", "=", "e2PropName", "+", "e2PropValue", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "88", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "nifi", ".", "fingerprint", "import", "org", ".", "apache", ".", "nifi", ".", "encrypt", ".", "StringEncryptor", "import", "org", ".", "apache", ".", "nifi", ".", "nar", ".", "ExtensionManager", "import", "org", ".", "apache", ".", "nifi", ".", "nar", ".", "StandardExtensionDiscoveringManager", "import", "org", ".", "bouncycastle", ".", "jce", ".", "provider", ".", "BouncyCastleProvider", "import", "org", ".", "junit", ".", "After", "import", "org", ".", "junit", ".", "Before", "import", "org", ".", "junit", ".", "BeforeClass", "import", "org", ".", "junit", ".", "Test", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", "import", "org", ".", "junit", ".", "runners", ".", "JUnit4", "import", "org", ".", "slf4j", ".", "Logger", "import", "org", ".", "slf4j", ".", "LoggerFactory", "import", "java", ".", "security", ".", "Security", "@", "RunWith", "(", "JUnit4", ".", "class", ")", "class", "FingerprintFactoryGroovyTest", "extends", "GroovyTestCase", "{", "private", "static", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "FingerprintFactoryGroovyTest", ".", "class", ")", "private", "static", "StringEncryptor", "mockEncryptor", "=", "[", "encrypt", ":", "{", "String", "plaintext", "-", ">", "plaintext", ".", "reverse", "(", ")", "}", ",", "decrypt", ":", "{", "String", "cipherText", "-", ">", "cipherText", ".", "reverse", "(", ")", "}", "]", "as", "StringEncryptor", "private", "static", "ExtensionManager", "extensionManager", "=", "new", "StandardExtensionDiscoveringManager", "(", ")", "@", "BeforeClass", "static", "void", "setUpOnce", "(", ")", "throws", "Exception", "{", "Security", ".", "addProvider", "(", "new", "BouncyCastleProvider", "(", "))", "logger", ".", "metaClass", ".", "methodMissing", "=", "{", "String", "name", ",", "args", "-", ">", "logger", ".", "info", "(", "\"[", "${", "name", "?", ".", "toUpperCase", "(", ")}", "]", "$", "{(", "args", "as", "List", ")", ".", "join", "(", "\"", "\"", ")}", "\")", "}", "}", "@", "Before", "void", "setUp", "(", ")", "throws", "Exception", "{", "}", "@", "After", "void", "tearDown", "(", ")", "throws", "Exception", "{", "}", "/", "**", "*", "The", "flow", "fingerprint", "should", "not", "disclose", "sensitive", "property", "values", ".", "*", "/", "@", "Test", "void", "testCreateFingerprintShouldNotDiscloseSensitivePropertyValues", "(", ")", "{", "/", "/", "Arrange", "/", "/", "Create", "flow", "String", "initialFlowXML", "=", "new", "File", "(", "\"", "src", "/", "test", "/", "resources", "/", "nifi", "/", "fingerprint", "/", "initial", ".", "xml", "\"", ").", "text", "logger", ".", "info", "(", "\"", "Read", "initial", "flow", ":", "$", "{", "initialFlowXML", "[", "0", ".", ".<", "100", "]", "}.", "..", "\")", "/", "/", "Create", "the", "FingerprintFactory", "with", "collaborators", "FingerprintFactory", "fingerprintFactory", "=", "new", "FingerprintFactory", "(", "mockEncryptor", ",", "extensionManager", ")", "/", "/", "Act", "/", "/", "Create", "the", "fingerprint", "from", "the", "flow", "String", "fingerprint", "=", "fingerprintFactory", ".", "createFingerprint", "(", "initialFlowXML", ".", "bytes", ")", "logger", ".", "info", "(", "\"", "Generated", "flow", "fingerprint", ":", "$", "{", "fingerprint", "}", "\")", "/", "/", "Assert", "/", "/", "Assert", "the", "fingerprint", "does", "not", "contain", "the", "password", "assert", "!", "(", "fingerprint", "=", "~", "\"", "originalPlaintextPassword", "\"", ")", "}", "}", "@", "@", "-", "16", ",", "6", "+", "16", ",", "26", "@", "@", "*", "/", "package", "org", ".", "apache", ".", "nifi", ".", "fingerprint", ";", "import", "static", "org", ".", "apache", ".", "nifi", ".", "controller", ".", "serialization", ".", "ScheduledStateLookup", ".", "IDENTITY_LOOKUP", ";", "import", "static", "org", ".", "apache", ".", "nifi", ".", "fingerprint", ".", "FingerprintFactory", ".", "FLOW_CONFIG_XSD", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Optional", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "javax", ".", "xml", ".", "validation", ".", "Schema", ";", "import", "javax", ".", "xml", ".", "validation", ".", "SchemaFactory", ";", "import", "org", ".", "apache", ".", "commons", ".", "io", ".", "IOUtils", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang3", ".", "StringUtils", ";", "import", "org", ".", "apache", ".", "nifi", ".", "connectable", ".", "Position", ";", "@", "@", "-", "30", ",", "6", "+", "50", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "nifi", ".", "nar", ".", "StandardExtensionDiscoveringManager", ";", "import", "org", ".", "apache", ".", "nifi", ".", "remote", ".", "RemoteGroupPort", ";", "import", "org", ".", "apache", ".", "nifi", ".", "remote", ".", "protocol", ".", "SiteToSiteTransportProtocol", ";", "import", "org", ".", "apache", ".", "nifi", ".", "security", ".", "util", ".", "crypto", ".", "Argon2SecureHasher", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "@", "@", "-", "38", ",", "27", "+", "59", ",", "6", "@", "@", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXParseException", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "javax", ".", "xml", ".", "validation", ".", "Schema", ";", "import", "javax", ".", "xml", ".", "validation", ".", "SchemaFactory", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Optional", ";", "import", "static", "org", ".", "apache", ".", "nifi", ".", "controller", ".", "serialization", ".", "ScheduledStateLookup", ".", "IDENTITY_LOOKUP", ";", "import", "static", "org", ".", "apache", ".", "nifi", ".", "fingerprint", ".", "FingerprintFactory", ".", "FLOW_CONFIG_XSD", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "/", "**", "*", "/", "public", "class", "FingerprintFactoryTest", "{", "@", "@", "-", "248", ",", "6", "+", "248", ",", "7", "@", "@", "public", "void", "testRemoteProcessGroupFingerprintRaw", "(", ")", "throws", "Exception", "{", "@", "Test", "public", "void", "testRemoteProcessGroupFingerprintWithProxy", "(", ")", "throws", "Exception", "{", "final", "String", "proxyPassword", "=", "\"", "proxy", "-", "pass", "\"", ";", "/", "/", "Fill", "out", "every", "configuration", ".", "final", "RemoteProcessGroup", "component", "=", "mock", "(", "RemoteProcessGroup", ".", "class", ")", ";", "@", "@", "-", "263", ",", "10", "+", "264", ",", "11", "@", "@", "public", "void", "testRemoteProcessGroupFingerprintWithProxy", "(", ")", "throws", "Exception", "{", "when", "(", "component", ".", "getProxyHost", "(", "))", ".", "thenReturn", "(", "\"", "proxy", "-", "host", "\"", ");", "when", "(", "component", ".", "getProxyPort", "(", "))", ".", "thenReturn", "(", "3128", ")", ";", "when", "(", "component", ".", "getProxyUser", "(", "))", ".", "thenReturn", "(", "\"", "proxy", "-", "user", "\"", ");", "when", "(", "component", ".", "getProxyPassword", "(", "))", ".", "thenReturn", "(", "\"", "proxy", "-", "pass", "\"", ");", "when", "(", "component", ".", "getProxyPassword", "(", "))", ".", "thenReturn", "(", "proxyPassword", ")", ";", "when", "(", "component", ".", "getVersionedComponentId", "(", "))", ".", "thenReturn", "(", "Optional", ".", "empty", "(", "))", ";", "/", "/", "Assert", "fingerprints", "with", "expected", "one", ".", "final", "String", "hashedProxyPassword", "=", "new", "Argon2SecureHasher", "(", ").", "hashHex", "(", "proxyPassword", ")", ";", "final", "String", "expected", "=", "\"", "id", "\"", "+", "\"", "NO_VALUE", "\"", "+", "\"", "http", ":", "//", "node1", ":", "8080", "/", "nifi", ",", "http", ":", "//", "node2", ":", "8080", "/", "nifi", "\"", "+", "@", "@", "-", "277", ",", "11", "+", "279", ",", "11", "@", "@", "public", "void", "testRemoteProcessGroupFingerprintWithProxy", "(", ")", "throws", "Exception", "{", "\"", "proxy", "-", "host", "\"", "+", "\"", "3128", "\"", "+", "\"", "proxy", "-", "user", "\"", "+", "\"", "proxy", "-", "pass", "\"", ";", "hashedProxyPassword", ";", "final", "Element", "rootElement", "=", "serializeElement", "(", "encryptor", ",", "RemoteProcessGroup", ".", "class", ",", "component", ",", "\"", "addRemoteProcessGroup", "\"", ",", "IDENTITY_LOOKUP", ")", ";", "final", "Element", "componentElement", "=", "(", "Element", ")", "rootElement", ".", "getElementsByTagName", "(", "\"", "remoteProcessGroup", "\"", ").", "item", "(", "0", ")", ";", "assertEquals", "(", "expected", ".", "toString", "(", "),", "fingerprint", "(", "\"", "addRemoteProcessGroupFingerprint", "\"", ",", "Element", ".", "class", ",", "componentElement", ")", ");", "assertEquals", "(", "expected", ",", "fingerprint", "(", "\"", "addRemoteProcessGroupFingerprint", "\"", ",", "Element", ".", "class", ",", "componentElement", ")", ");", "}", "@", "Test", "@", "@", "-", "33", ",", "6", "+", "33", ",", "7", "@", "@", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", ".", "controller", ".", "tasks", "\"", "level", "=", "\"", "DEBUG", "\"", "/", ">\"", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", ".", "controller", ".", "service", "\"", "level", "=", "\"", "DEBUG", "\"", "/>", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", ".", "encrypt", "\"", "level", "=", "\"", "DEBUG", "\"", "/>", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", ".", "security", ".", "util", ".", "crypto", "\"", "level", "=", "\"", "DEBUG", "\"", "/>", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", ".", "controller", ".", "repository", ".", "crypto", "\"", "level", "=", "\"", "DEBUG", "\"", "/>", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", ".", "security", ".", "repository", "\"", "level", "=", "\"", "DEBUG", "\"", "/>", "<", "logger", "name", "=", "\"", "org", ".", "apache", ".", "nifi", ".", "controller", ".", "service", ".", "mock", "\"", "level", "=", "\"", "ERROR", "\"", "/>", "@", "@", "-", "0", ",", "0", "+", "1", ",", "152", "@", "@", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "standalone", "=", "\"", "no", "\"", "?>", "<", "!-", "-", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "the", "License", ".", "-", "->", "<", "flowController", "encoding", "-", "version", "=", "\"", "1", ".", "4", "\"", ">", "<", "maxTimerDrivenThreadCount", ">", "10", "<", "/", "maxTimerDrivenThreadCount", ">", "<", "maxEventDrivenThreadCount", ">", "1", "<", "/", "maxEventDrivenThreadCount", ">", "<", "registries", "/", ">", "<", "parameterContexts", "/", ">", "<", "rootGroup", ">", "<", "id", ">", "f31f71c7", "-", "016f", "-", "1000", "-", "52b1", "-", "4f4e21375b31", "<", "/", "id", ">", "<", "name", ">", "NiFi", "Flow", "<", "/", "name", ">", "<", "position", "x", "=", "\"", "0", ".", "0", "\"", "y", "=", "\"", "0", ".", "0", "\"", "/>", "<", "comment", "/", ">", "<", "processor", ">", "<", "id", ">", "f3214b1c", "-", "016f", "-", "1000", "-", "0000", "-", "00001b1546be", "<", "/", "id", ">", "<", "name", ">", "GetFTP", "<", "/", "name", ">", "<", "position", "x", "=", "\"", "363", ".", "0", "\"", "y", "=", "\"", "111", ".", "01388549804688", "\"", "/>", "<", "styles", "/", ">", "<", "comment", "/", ">", "<", "class", ">", "org", ".", "apache", ".", "nifi", ".", "processors", ".", "standard", ".", "GetFTP", "<", "/", "class", ">", "<", "bundle", ">", "<", "group", ">", "org", ".", "apache", ".", "nifi", "<", "/", "group", ">", "<", "artifact", ">", "nifi", "-", "standard", "-", "nar", "<", "/", "artifact", ">", "<", "version", ">", "1", ".", "11", ".", "0", "<", "/", "version", ">", "<", "/", "bundle", ">", "<", "maxConcurrentTasks", ">", "1", "<", "/", "maxConcurrentTasks", ">", "<", "schedulingPeriod", ">", "0", "sec", "<", "/", "schedulingPeriod", ">", "<", "penalizationPeriod", ">", "30", "sec", "<", "/", "penalizationPeriod", ">", "<", "yieldPeriod", ">", "1", "sec", "<", "/", "yieldPeriod", ">", "<", "bulletinLevel", ">", "WARN", "<", "/", "bulletinLevel", ">", "<", "lossTolerant", ">", "false", "<", "/", "lossTolerant", ">", "<", "scheduledState", ">", "STOPPED", "<", "/", "scheduledState", ">", "<", "schedulingStrategy", ">", "TIMER_DRIVEN", "<", "/", "schedulingStrategy", ">", "<", "executionNode", ">", "ALL", "<", "/", "executionNode", ">", "<", "runDurationNanos", ">", "0", "<", "/", "runDurationNanos", ">", "<", "property", ">", "<", "name", ">", "Hostname", "<", "/", "name", ">", "<", "value", ">", "abc", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Port", "<", "/", "name", ">", "<", "value", ">", "21", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Username", "<", "/", "name", ">", "<", "value", ">", "abc", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Password", "<", "/", "name", ">", "<", "value", ">", "enc", "{", "drowssaPtxetnialPlanigiro", "}", "</", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Connection", "Mode", "<", "/", "name", ">", "<", "value", ">", "Passive", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Transfer", "Mode", "<", "/", "name", ">", "<", "value", ">", "Binary", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Remote", "Path", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "File", "Filter", "Regex", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Path", "Filter", "Regex", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Polling", "Interval", "<", "/", "name", ">", "<", "value", ">", "60", "sec", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Search", "Recursively", "<", "/", "name", ">", "<", "value", ">", "false", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "follow", "-", "symlink", "<", "/", "name", ">", "<", "value", ">", "false", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Ignore", "Dotted", "Files", "<", "/", "name", ">", "<", "value", ">", "true", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Delete", "Original", "<", "/", "name", ">", "<", "value", ">", "true", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Connection", "Timeout", "<", "/", "name", ">", "<", "value", ">", "30", "sec", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Data", "Timeout", "<", "/", "name", ">", "<", "value", ">", "30", "sec", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Max", "Selects", "<", "/", "name", ">", "<", "value", ">", "100", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Remote", "Poll", "Batch", "Size", "<", "/", "name", ">", "<", "value", ">", "5000", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Use", "Natural", "Ordering", "<", "/", "name", ">", "<", "value", ">", "false", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "proxy", "-", "configuration", "-", "service", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Proxy", "Type", "<", "/", "name", ">", "<", "value", ">", "DIRECT", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Proxy", "Host", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Proxy", "Port", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Http", "Proxy", "Username", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Http", "Proxy", "Password", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Internal", "Buffer", "Size", "<", "/", "name", ">", "<", "value", ">", "16KB", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "ftp", "-", "use", "-", "utf8", "<", "/", "name", ">", "<", "value", ">", "false", "<", "/", "value", ">", "<", "/", "property", ">", "<", "/", "processor", ">", "<", "/", "rootGroup", ">", "<", "controllerServices", "/", ">", "<", "reportingTasks", "/", ">", "<", "/", "flowController", ">", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "0", ",", "0", "+", "1", ",", "152", "@", "@", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "standalone", "=", "\"", "no", "\"", "?>", "<", "!-", "-", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "the", "License", ".", "-", "->", "<", "flowController", "encoding", "-", "version", "=", "\"", "1", ".", "4", "\"", ">", "<", "maxTimerDrivenThreadCount", ">", "10", "<", "/", "maxTimerDrivenThreadCount", ">", "<", "maxEventDrivenThreadCount", ">", "1", "<", "/", "maxEventDrivenThreadCount", ">", "<", "registries", "/", ">", "<", "parameterContexts", "/", ">", "<", "rootGroup", ">", "<", "id", ">", "f31f71c7", "-", "016f", "-", "1000", "-", "52b1", "-", "4f4e21375b31", "<", "/", "id", ">", "<", "name", ">", "NiFi", "Flow", "<", "/", "name", ">", "<", "position", "x", "=", "\"", "0", ".", "0", "\"", "y", "=", "\"", "0", ".", "0", "\"", "/>", "<", "comment", "/", ">", "<", "processor", ">", "<", "id", ">", "f3214b1c", "-", "016f", "-", "1000", "-", "0000", "-", "00001b1546be", "<", "/", "id", ">", "<", "name", ">", "GetFTP", "<", "/", "name", ">", "<", "position", "x", "=", "\"", "363", ".", "0", "\"", "y", "=", "\"", "111", ".", "01388549804688", "\"", "/>", "<", "styles", "/", ">", "<", "comment", "/", ">", "<", "class", ">", "org", ".", "apache", ".", "nifi", ".", "processors", ".", "standard", ".", "GetFTP", "<", "/", "class", ">", "<", "bundle", ">", "<", "group", ">", "org", ".", "apache", ".", "nifi", "<", "/", "group", ">", "<", "artifact", ">", "nifi", "-", "standard", "-", "nar", "<", "/", "artifact", ">", "<", "version", ">", "1", ".", "11", ".", "0", "<", "/", "version", ">", "<", "/", "bundle", ">", "<", "maxConcurrentTasks", ">", "1", "<", "/", "maxConcurrentTasks", ">", "<", "schedulingPeriod", ">", "0", "sec", "<", "/", "schedulingPeriod", ">", "<", "penalizationPeriod", ">", "30", "sec", "<", "/", "penalizationPeriod", ">", "<", "yieldPeriod", ">", "1", "sec", "<", "/", "yieldPeriod", ">", "<", "bulletinLevel", ">", "WARN", "<", "/", "bulletinLevel", ">", "<", "lossTolerant", ">", "false", "<", "/", "lossTolerant", ">", "<", "scheduledState", ">", "STOPPED", "<", "/", "scheduledState", ">", "<", "schedulingStrategy", ">", "TIMER_DRIVEN", "<", "/", "schedulingStrategy", ">", "<", "executionNode", ">", "ALL", "<", "/", "executionNode", ">", "<", "runDurationNanos", ">", "0", "<", "/", "runDurationNanos", ">", "<", "property", ">", "<", "name", ">", "Hostname", "<", "/", "name", ">", "<", "value", ">", "abc", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Port", "<", "/", "name", ">", "<", "value", ">", "21", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Username", "<", "/", "name", ">", "<", "value", ">", "abc", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Password", "<", "/", "name", ">", "<", "value", ">", "enc", "{", "drowssaPtxetnialPdeifidom", "}", "</", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Connection", "Mode", "<", "/", "name", ">", "<", "value", ">", "Passive", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Transfer", "Mode", "<", "/", "name", ">", "<", "value", ">", "Binary", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Remote", "Path", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "File", "Filter", "Regex", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Path", "Filter", "Regex", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Polling", "Interval", "<", "/", "name", ">", "<", "value", ">", "60", "sec", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Search", "Recursively", "<", "/", "name", ">", "<", "value", ">", "false", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "follow", "-", "symlink", "<", "/", "name", ">", "<", "value", ">", "false", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Ignore", "Dotted", "Files", "<", "/", "name", ">", "<", "value", ">", "true", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Delete", "Original", "<", "/", "name", ">", "<", "value", ">", "true", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Connection", "Timeout", "<", "/", "name", ">", "<", "value", ">", "30", "sec", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Data", "Timeout", "<", "/", "name", ">", "<", "value", ">", "30", "sec", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Max", "Selects", "<", "/", "name", ">", "<", "value", ">", "100", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Remote", "Poll", "Batch", "Size", "<", "/", "name", ">", "<", "value", ">", "5000", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Use", "Natural", "Ordering", "<", "/", "name", ">", "<", "value", ">", "false", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "proxy", "-", "configuration", "-", "service", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Proxy", "Type", "<", "/", "name", ">", "<", "value", ">", "DIRECT", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Proxy", "Host", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Proxy", "Port", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Http", "Proxy", "Username", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Http", "Proxy", "Password", "<", "/", "name", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "Internal", "Buffer", "Size", "<", "/", "name", ">", "<", "value", ">", "16KB", "<", "/", "value", ">", "<", "/", "property", ">", "<", "property", ">", "<", "name", ">", "ftp", "-", "use", "-", "utf8", "<", "/", "name", ">", "<", "value", ">", "false", "<", "/", "value", ">", "<", "/", "property", ">", "<", "/", "processor", ">", "<", "/", "rootGroup", ">", "<", "controllerServices", "/", ">", "<", "reportingTasks", "/", ">", "<", "/", "flowController", ">", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "16", ",", "8", "+", "16", ",", "22", "@", "@", "*", "/", "package", "org", ".", "apache", ".", "nifi", ".", "web", ".", "security", ".", "jwt", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "fail", ";", "import", "static", "org", ".", "mockito", ".", "ArgumentMatchers", ".", "anyInt", ";", "import", "static", "org", ".", "mockito", ".", "ArgumentMatchers", ".", "anyString", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doAnswer", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "import", "io", ".", "jsonwebtoken", ".", "JwtException", ";", "import", "org", ".", "apache", ".", "commons", ".", "codec", ".", "CharEncoding", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "security", ".", "InvalidKeyException", ";", "import", "java", ".", "security", ".", "NoSuchAlgorithmException", ";", "import", "java", ".", "util", ".", "LinkedHashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "javax", ".", "crypto", ".", "Mac", ";", "import", "javax", ".", "crypto", ".", "spec", ".", "SecretKeySpec", ";", "import", "org", ".", "apache", ".", "commons", ".", "codec", ".", "binary", ".", "Base64", ";", "import", "org", ".", "apache", ".", "nifi", ".", "admin", ".", "service", ".", "AdministrationException", ";", "import", "org", ".", "apache", ".", "nifi", ".", "admin", ".", "service", ".", "KeyService", ";", "@", "@", "-", "40", ",", "22", "+", "54", ",", "6", "@", "@", "import", "org", ".", "springframework", ".", "security", ".", "core", ".", "context", ".", "SecurityContext", ";", "import", "org", ".", "springframework", ".", "security", ".", "core", ".", "context", ".", "SecurityContextHolder", ";", "import", "javax", ".", "crypto", ".", "Mac", ";", "import", "javax", ".", "crypto", ".", "spec", ".", "SecretKeySpec", ";", "import", "java", ".", "io", ".", "UnsupportedEncodingException", ";", "import", "java", ".", "security", ".", "InvalidKeyException", ";", "import", "java", ".", "security", ".", "NoSuchAlgorithmException", ";", "import", "java", ".", "util", ".", "LinkedHashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "fail", ";", "import", "static", "org", ".", "mockito", ".", "ArgumentMatchers", ".", "anyInt", ";", "import", "static", "org", ".", "mockito", ".", "ArgumentMatchers", ".", "anyString", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doAnswer", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "public", "class", "JwtServiceTest", "{", "private", "static", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "JwtServiceTest", ".", "class", ")", ";", "@", "@", "-", "155", ",", "16", "+", "153", ",", "16", "@", "@", "private", "static", "String", "generateHS256Token", "(", "String", "rawHeader", ",", "String", "rawPayload", ",", "St", "try", "{", "logger", ".", "info", "(", "\"", "Generating", "token", "for", "\"", "+", "rawHeader", "+", "\"", "+", "\"", "+", "rawPayload", ")", ";", "String", "base64Header", "=", "Base64", ".", "encodeBase64URLSafeString", "(", "rawHeader", ".", "getBytes", "(", "CharEncoding", ".", "UTF_8", ")", ");", "String", "base64Payload", "=", "Base64", ".", "encodeBase64URLSafeString", "(", "rawPayload", ".", "getBytes", "(", "CharEncoding", ".", "UTF_8", ")", ");", "String", "base64Header", "=", "Base64", ".", "encodeBase64URLSafeString", "(", "rawHeader", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ");", "String", "base64Payload", "=", "Base64", ".", "encodeBase64URLSafeString", "(", "rawPayload", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ");", "/", "/", "TODO", ":", "Support", "valid", "/", "invalid", "manipulation", "final", "String", "body", "=", "base64Header", "+", "TOKEN_DELIMITER", "+", "base64Payload", ";", "String", "signature", "=", "generateHMAC", "(", "hmacSecret", ",", "body", ")", ";", "return", "body", "+", "TOKEN_DELIMITER", "+", "signature", ";", "}", "catch", "(", "NoSuchAlgorithmException", "|", "InvalidKeyException", "|", "UnsupportedEncodingException", "e", ")", "{", "}", "catch", "(", "NoSuchAlgorithmException", "|", "InvalidKeyException", "e", ")", "{", "final", "String", "errorMessage", "=", "\"", "Could", "not", "generate", "the", "token", "\"", ";", "logger", ".", "error", "(", "errorMessage", ",", "e", ")", ";", "fail", "(", "errorMessage", ")", ";", "@", "@", "-", "173", ",", "11", "+", "171", ",", "11", "@", "@", "private", "static", "String", "generateHS256Token", "(", "String", "rawHeader", ",", "String", "rawPayload", ",", "St", "}", "private", "static", "String", "generateHMAC", "(", "String", "hmacSecret", ",", "String", "body", ")", "throws", "NoSuchAlgorithmException", ",", "UnsupportedEncodingException", ",", "InvalidKeyException", "{", "InvalidKeyException", "{", "Mac", "hmacSHA256", "=", "Mac", ".", "getInstance", "(", "\"", "HmacSHA256", "\"", ");", "SecretKeySpec", "secret_key", "=", "new", "SecretKeySpec", "(", "hmacSecret", ".", "getBytes", "(", "\"", "UTF", "-", "8", "\"", "),", "\"", "HmacSHA256", "\"", ");", "SecretKeySpec", "secret_key", "=", "new", "SecretKeySpec", "(", "hmacSecret", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ",", "\"", "HmacSHA256", "\"", ");", "hmacSHA256", ".", "init", "(", "secret_key", ")", ";", "return", "Base64", ".", "encodeBase64URLSafeString", "(", "hmacSHA256", ".", "doFinal", "(", "body", ".", "getBytes", "(", "\"", "UTF", "-", "8", "\"", "))", ");", "return", "Base64", ".", "encodeBase64URLSafeString", "(", "hmacSHA256", ".", "doFinal", "(", "body", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", "))", ";", "}", "@", "Before", "@", "@", "-", "481", ",", "7", "+", "479", ",", "6", "@", "@", "public", "void", "testShouldNotGenerateTokenWithMissingKey", "(", ")", "throws", "Exception", "{", "@", "Test", "public", "void", "testShouldLogOutUser", "(", ")", "throws", "Exception", "{", "/", "/", "Arrange", "expectedException", ".", "expect", "(", "JwtException", ".", "class", ")", ";", "expectedException", ".", "expectMessage", "(", "\"", "Unable", "to", "validate", "the", "access", "token", ".", "\")", ";"], "docstring_tokens": ["provide", "a", "deterministic", "loggable", "value"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1054", ",", "7", "+", "1054", ",", "7", "@", "@", "static", "int", "phar_parse_pharfile", "(", "php_stream", "*", "fp", ",", "char", "*", "fname", ",", "int", "fname_len", ",", "char", "entry", ".", "is_persistent", "=", "mydata", "-", ">", "is_persistent", ";", "for", "(", "manifest_index", "=", "0", ";", "manifest_index", "<", "manifest_count", ";", "+", "+", "manifest_index", ")", "{", "if", "(", "buffer", "+", "24", ">", "endbuffer", ")", "{", "if", "(", "buffer", "+", "28", ">", "endbuffer", ")", "{", "MAPPHAR_FAIL", "(", "\"", "internal", "corruption", "of", "phar", "\\", "\"%", "s", "\\", "\"", "(", "truncated", "manifest", "entry", ")", "\")", "}", "@", "@", "-", "1068", ",", "7", "+", "1068", ",", "7", "@", "@", "static", "int", "phar_parse_pharfile", "(", "php_stream", "*", "fp", ",", "char", "*", "fname", ",", "int", "fname_len", ",", "char", "entry", ".", "manifest_pos", "=", "manifest_index", ";", "}", "if", "(", "entry", ".", "filename_len", ">", "endbuffer", "-", "buffer", "-", "20", ")", "{", "if", "(", "entry", ".", "filename_len", ">", "endbuffer", "-", "buffer", "-", "24", ")", "{", "MAPPHAR_FAIL", "(", "\"", "internal", "corruption", "of", "phar", "\\", "\"%", "s", "\\", "\"", "(", "truncated", "manifest", "entry", ")", "\")", ";", "}"], "docstring_tokens": ["using", "a", "specially-crafted", "archive", "files"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "785", ",", "7", "+", "785", ",", "7", "@", "@", "int", "ssl3_write_bytes", "(", "SSL", "*", "s", ",", "int", "type", ",", "const", "void", "*", "buf_", ",", "int", "len", ")", "i", "=", "ssl3_write_pending", "(", "s", ",", "type", ",", "&", "buf", "[", "tot", "]", ",", "nw", ")", ";", "if", "(", "i", "<", "=", "0", ")", "{", "if", "(", "i", "<", "0", ")", "{", "if", "(", "i", "<", "0", "&", "&", "(", "!", "s", "-", ">", "wbio", "|", "|", "!", "BIO_should_retry", "(", "s", "-", ">", "wbio", ")", "))", "{", "OPENSSL_free", "(", "wb", "-", ">", "buf", ")", ";", "wb", "-", ">", "buf", "=", "NULL", ";", "}"], "docstring_tokens": ["using", "a", "BIO", "other", "than", "a", "socket", "BIO", "for", "writing"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "126", ",", "6", "+", "126", ",", "7", "@", "@", "The", "JPA", "module", "supports", "defining", "a", "query", "manually", "as", "a", "String", "or", "having", "it", "being", "Derived", "queries", "with", "the", "predicates", "`", "IsStartingWith", "`", ",", "`", "StartingWith", "`", ",", "`", "StartsWith", "`", ",", "IsEndingWith", "\"", ",", "`", "EndingWith", "`", ",", "`", "EndsWith", "`", ",", "`", "IsNotContaining", "`", ",", "`", "NotContaining", "`", ",", "`", "NotContains", "`", ",", "`", "IsContaining", "`", ",", "`", "Containing", "`", ",", "`", "Contains", "`", "the", "respective", "arguments", "for", "these", "queries", "will", "get", "sanitized", ".", "This", "means", "if", "the", "arguments", "actually", "contain", "characters", "recognized", "by", "`", "LIKE", "`", "as", "wildcards", "these", "will", "get", "escaped", "so", "they", "match", "only", "as", "literals", ".", "The", "escape", "character", "used", "can", "be", "configured", "by", "setting", "the", "`", "escapeCharacter", "`", "of", "the", "`", "@", "EnableJpaRepositories", "`", "annotation", ".", "Compare", "with", "<", "<", "jpa", ".", "query", ".", "spel", "-", "expressions", ">", ">.", "=", "==", "=", "Declared", "Queries", "@", "@", "-", "459", ",", "7", "+", "460", ",", "7", "@", "@", "List", "<", "User", ">", "findByLastnameWithSpelExpression", "(", "@", "Param", "(", "\"", "lastname", "\"", ")", "String", "lastname", ")", ";", "=", "==", "=", "When", "using", "`", "like", "`", "-", "conditions", "with", "values", "that", "are", "coming", "from", "a", "not", "secure", "source", "the", "values", "should", "be", "sanitized", "so", "they", "can", "'", "t", "contain", "any", "wildcards", "and", "thereby", "allow", "attackers", "to", "select", "more", "data", "than", "they", "should", "be", "able", "to", ".", "For", "this", "purpose", "the", "the", "`", "escape", "(", "String", ",", "String", ")", "`", "method", "is", "made", "available", "in", "the", "SpEL", "context", ".", "For", "this", "purpose", "the", "the", "`", "escape", "(", "String", ")", "`", "method", "is", "made", "available", "in", "the", "SpEL", "context", ".", "It", "prefixes", "all", "instances", "of", "`", "_", "`", "and", "`", "%`", "in", "the", "first", "argument", "with", "the", "single", "character", "from", "the", "second", "argument", ".", "In", "combination", "with", "the", "`", "escape", "`", "clause", "of", "the", "`", "like", "`", "expression", "available", "in", "JPQL", "and", "standard", "SQL", "this", "allows", "easy", "cleaning", "of", "bind", "parameters", ".", "@", "@", "-", "468", ",", "13", "+", "469", ",", "14", "@", "@", "In", "combination", "with", "the", "`", "escape", "`", "clause", "of", "the", "`", "like", "`", "expression", "available", "in", "JP", "=", "==", "=", "[", "source", ",", "java", "]", "@", "Query", "(", "\"", "select", "u", "from", "User", "u", "where", "u", ".", "firstname", "like", "%", "?#", "{#", "escape", "(", "[", "0", "]", ",'", "#'", ")}", "%", "escape", "'", "#'", "\")", "@", "Query", "(", "\"", "select", "u", "from", "User", "u", "where", "u", ".", "firstname", "like", "%", "?#", "{", "escape", "(", "[", "0", "]", ")}", "%", "escape", "?", "#{", "escapeCharacter", "(", ")}", "\")", "List", "<", "User", ">", "findContainingEscaped", "(", "String", "namePart", ")", ";", "=", "==", "=", "Given", "this", "method", "declaration", "in", "an", "repository", "interface", "`", "findContainingEscaped", "(", "\"", "Peter_", "\"", ")\"", "will", "find", "`", "Peter_Parker", "`", "but", "not", "`", "Peter", "Parker", "`", ".", "Note", "that", "the", "method", "`", "escape", "(", "String", ",", "String", ")", "`", "available", "in", "the", "SpEL", "context", "will", "only", "escape", "the", "SQL", "and", "JPQL", "standard", "wildcards", "`", "_", "`", "and", "`", "%`", ".", "The", "escape", "character", "used", "can", "be", "configured", "by", "setting", "the", "`", "escapeCharacter", "`", "of", "the", "`", "@", "EnableJpaRepositories", "`", "annotation", ".", "Note", "that", "the", "method", "`", "escape", "(", "String", ")", "`", "available", "in", "the", "SpEL", "context", "will", "only", "escape", "the", "SQL", "and", "JPQL", "standard", "wildcards", "`", "_", "`", "and", "`", "%`", ".", "If", "the", "underlying", "database", "or", "the", "JPA", "implementation", "supports", "additional", "wildcards", "these", "will", "not", "get", "escaped", ".", "[", "[", "jpa", ".", "modifying", "-", "queries", "]", "]", "@", "@", "-", "20", ",", "7", "+", "20", ",", "7", "@", "@", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "springframework", ".", "util", ".", "Assert", ";", "import", "org", ".", "springframework", ".", "lang", ".", "Nullable", ";", "/", "**", "*", "A", "value", "type", "encapsulating", "an", "escape", "character", "for", "LIKE", "queries", "and", "the", "actually", "usage", "of", "it", "in", "escaping", "@", "@", "-", "39", ",", "14", "+", "39", ",", "25", "@", "@", "/", "**", "*", "Escapes", "all", "special", "like", "characters", "(", "{@", "code", "_", "}", ",", "{", "@", "code", "%", "})", "using", "the", "configured", "escape", "character", ".", "*", "*", "@", "param", "value", "must", "not", "be", "{", "@", "literal", "null", "}", ".", "*", "@", "param", "value", "May", "be", "{", "@", "literal", "null", "}", ".", "*", "@", "return", "*", "/", "@", "Nullable", "public", "String", "escape", "(", "String", "value", ")", "{", "Assert", ".", "notNull", "(", "value", ",", "\"", "Value", "must", "be", "not", "null", ".", "\")", ";", "if", "(", "value", "=", "=", "null", ")", "{", "return", "null", ";", "}", "return", "TO_REPLACE", ".", "stream", "(", ")", "/", "/", ".", "reduce", "(", "value", ",", "(", "it", ",", "character", ")", "-", ">", "it", ".", "replace", "(", "character", ",", "this", ".", "value", "+", "character", ")", ");", "}", "/", "**", "*", "Makes", "the", "underlying", "character", "available", ".", "*", "*", "@", "return", "the", "value", "*", "/", "public", "char", "escapeCharacter", "(", ")", "{", "return", "value", ";", "}", "}", "@", "@", "-", "557", ",", "7", "+", "557", ",", "7", "@", "@", "List", "<", "NameOnlyDto", ">", "findByNamedQueryWithConstructorExpression", "(", ");", "/", "/", "DATAJPA", "-", "1519", "@", "Query", "(", "\"", "select", "u", "from", "User", "u", "where", "u", ".", "firstname", "like", "%", "?#", "{", "escape", "(", "[", "0", "]", ")}", "%", "escape", "'", "\\\\", "'\"", ")", "@", "Query", "(", "\"", "select", "u", "from", "User", "u", "where", "u", ".", "firstname", "like", "%", "?#", "{", "escape", "(", "[", "0", "]", ")}", "%", "escape", "?", "#{", "escapeCharacter", "(", ")}", "\")", "List", "<", "User", ">", "findContainingEscaped", "(", "String", "namePart", ")", ";", "interface", "RolesAndFirstname", "{"], "docstring_tokens": ["using", "a", "specially-crafted", "query"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1", ",", "6", "+", "1", ",", "8", "@", "@", "PHP", "NEWS", "|", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "||", "?", "?", "?", "??", "2010", ",", "PHP", "5", ".", "3", ".", "3", "RC2", "-", "Fixed", "SplObjectStorage", "unserialization", "problems", "(", "CVE", "-", "2010", "-", "2225", ")", ".", "(", "Stas", ")", "-", "Implemented", "FR", "#", "51295", "(", "SQLite3", ":", ":", "busyTimeout", "not", "existing", ")", ".", "(", "Mark", ")", "-", "Fixed", "the", "mail", ".", "log", "ini", "setting", "when", "no", "filename", "was", "given", ".", "(", "Johannes", ")", "@", "@", "-", "115", ",", "6", "+", "115", ",", "7", "@", "@", "static", "void", "spl_object_storage_dtor", "(", "spl_SplObjectStorageElement", "*", "element", ")", "/", "*", "{", "{{", "zval_ptr_dtor", "(", "&", "element", "-", ">", "inf", ")", ";", "}", "/", "*", "}", "}}", "*", "/", "spl_SplObjectStorageElement", "*", "spl_object_storage_get", "(", "spl_SplObjectStorage", "*", "intern", ",", "zval", "*", "obj", "TSRMLS_DC", ")", "/", "*", "{", "{{", "*", "/", "{", "spl_SplObjectStorageElement", "*", "element", ";", "@", "@", "-", "632", ",", "15", "+", "633", ",", "24", "@", "@", "SPL_METHOD", "(", "SplObjectStorage", ",", "unserialize", ")", "zval_ptr_dtor", "(", "&", "pcount", ")", ";", "while", "(", "count", "-", "-", ">", "0", ")", "{", "spl_SplObjectStorageElement", "*", "pelement", ";", "if", "(", "*", "p", "!", "=", "'", ";'", ")", "{", "goto", "outexcept", ";", "}", "+", "+", "p", ";", "if", "(", "*", "p", "!", "=", "'", "O", "'", "&", "&", "*", "p", "!", "=", "'", "C", "'", "&", "&", "*", "p", "!", "=", "'", "r", "'", ")", "{", "goto", "outexcept", ";", "}", "ALLOC_INIT_ZVAL", "(", "pentry", ")", ";", "if", "(", "!", "php_var_unserialize", "(", "&", "pentry", ",", "&", "p", ",", "s", "+", "buf_len", ",", "&", "var_hash", "TSRMLS_CC", ")", ")", "{", "zval_ptr_dtor", "(", "&", "pentry", ")", ";", "goto", "outexcept", ";", "}", "if", "(", "Z_TYPE_P", "(", "pentry", ")", "!", "=", "IS_OBJECT", ")", "{", "zval_ptr_dtor", "(", "&", "pentry", ")", ";", "goto", "outexcept", ";", "}", "ALLOC_INIT_ZVAL", "(", "pinf", ")", ";", "if", "(", "*", "p", "=", "=", "'", ",'", ")", "{", "/", "*", "new", "version", "has", "inf", "*", "/", "+", "+", "p", ";", "@", "@", "-", "649", ",", "6", "+", "659", ",", "16", "@", "@", "SPL_METHOD", "(", "SplObjectStorage", ",", "unserialize", ")", "goto", "outexcept", ";", "}", "}", "pelement", "=", "spl_object_storage_get", "(", "intern", ",", "pentry", "TSRMLS_CC", ")", ";", "if", "(", "pelement", ")", "{", "if", "(", "pelement", "-", ">", "inf", ")", "{", "var_push_dtor", "(", "&", "var_hash", ",", "&", "pelement", "-", ">", "inf", ")", ";", "}", "if", "(", "pelement", "-", ">", "obj", ")", "{", "var_push_dtor", "(", "&", "var_hash", ",", "&", "pelement", "-", ">", "obj", ")", ";", "}", "}", "spl_object_storage_attach", "(", "intern", ",", "pentry", ",", "pinf", "TSRMLS_CC", ")", ";", "zval_ptr_dtor", "(", "&", "pentry", ")", ";", "zval_ptr_dtor", "(", "&", "pinf", ")", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "45", "@", "@", "-", "-", "TEST", "-", "-", "SPL", ":", "Test", "that", "serialized", "blob", "contains", "unique", "elements", "(", "CVE", "-", "2010", "-", "2225", ")", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "badblobs", "=", "array", "(", "'", "x", ":", "i", ":", "2", ";", "i", ":", "0", ";", ",", "i", ":", "1", ";", ";", "i", ":", "0", ";", ",", "i", ":", "2", ";", ";", "m", ":", "a", ":", "0", ":", "{}", "',", "'", "x", ":", "i", ":", "3", ";", "O", ":", "8", ":", "\"", "stdClass", "\"", ":", "0", ":", "{}", ",", "O", ":", "8", ":", "\"", "stdClass", "\"", ":", "0", ":", "{}", ";", "R", ":", "1", ";", ",", "i", ":", "1", ";", ";", "O", ":", "8", ":", "\"", "stdClass", "\"", ":", "0", ":", "{}", ",", "r", ":", "2", ";", ";", "m", ":", "a", ":", "0", ":", "{}", "',", "'", "x", ":", "i", ":", "3", ";", "O", ":", "8", ":", "\"", "stdClass", "\"", ":", "0", ":", "{}", ",", "O", ":", "8", ":", "\"", "stdClass", "\"", ":", "0", ":", "{}", ";", "r", ":", "1", ";", ",", "i", ":", "1", ";", ";", "O", ":", "8", ":", "\"", "stdClass", "\"", ":", "0", ":", "{}", ",", "r", ":", "2", ";", ";", "m", ":", "a", ":", "0", ":", "{}", "',", ")", ";", "foreach", "(", "$", "badblobs", "as", "$", "blob", ")", "{", "try", "{", "$", "so", "=", "new", "SplObjectStorage", "(", ");", "$", "so", "-", ">", "unserialize", "(", "$", "blob", ")", ";", "var_dump", "(", "$", "so", ")", ";", "}", "catch", "(", "UnexpectedValueException", "$", "e", ")", "{", "echo", "$", "e", "-", ">", "getMessage", "(", ").", "\"\\", "n", "\"", ";", "}", "}", "-", "-", "EXPECTF", "-", "-", "Error", "at", "offset", "6", "of", "34", "bytes", "Error", "at", "offset", "46", "of", "89", "bytes", "object", "(", "SplObjectStorage", ")", "#", "2", "(", "1", ")", "{", "[", "\"", "storage", "\"", ":\"", "SplObjectStorage", "\"", ":", "private", "]", "=>", "array", "(", "2", ")", "{", "[", "\"%", "s", "\"", "]=", ">", "array", "(", "2", ")", "{", "[", "\"", "obj", "\"", "]=", ">", "object", "(", "stdClass", ")", "#", "3", "(", "0", ")", "{", "}", "[", "\"", "inf", "\"", "]=", ">", "int", "(", "1", ")", "}", "[", "\"%", "s", "\"", "]=", ">", "array", "(", "2", ")", "{", "[", "\"", "obj", "\"", "]=", ">", "object", "(", "stdClass", ")", "#", "1", "(", "0", ")", "{", "}", "[", "\"", "inf", "\"", "]=", ">", "object", "(", "stdClass", ")", "#", "4", "(", "0", ")", "{", "}", "}", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "47", "@", "@", "-", "-", "TEST", "-", "-", "SPL", ":", "Test", "unserializing", "tested", "&", "linked", "storage", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "o", "=", "new", "StdClass", "(", ");", "$", "a", "=", "new", "StdClass", "(", ");", "$", "o", "-", ">", "a", "=", "$", "a", ";", "$", "so", "=", "new", "SplObjectStorage", "(", ");", "$", "so", "[", "$", "o", "]", "=", "1", ";", "$", "so", "[", "$", "a", "]", "=", "2", ";", "$", "s", "=", "serialize", "(", "$", "so", ")", ";", "echo", "$", "s", ".", "\"\\", "n", "\"", ";", "$", "so1", "=", "unserialize", "(", "$", "s", ")", ";", "var_dump", "(", "$", "so1", ")", ";", "-", "-", "EXPECTF", "-", "-", "C", ":", "16", ":", "\"", "SplObjectStorage", "\"", ":", "76", ":", "{", "x", ":", "i", ":", "2", ";", "O", ":", "8", ":", "\"", "stdClass", "\"", ":", "1", ":", "{", "s", ":", "1", ":", "\"", "a", "\"", ";", "O", ":", "8", ":", "\"", "stdClass", "\"", ":", "0", ":", "{}", "},", "i", ":", "1", ";", ";", "r", ":", "2", ";", ",", "i", ":", "2", ";", ";", "m", ":", "a", ":", "0", ":", "{}", "}", "object", "(", "SplObjectStorage", ")", "#", "4", "(", "1", ")", "{", "[", "\"", "storage", "\"", ":\"", "SplObjectStorage", "\"", ":", "private", "]", "=>", "array", "(", "2", ")", "{", "[", "\"%", "s", "\"", "]=", ">", "array", "(", "2", ")", "{", "[", "\"", "obj", "\"", "]=", ">", "object", "(", "stdClass", ")", "#", "5", "(", "1", ")", "{", "[", "\"", "a", "\"", "]=", ">", "object", "(", "stdClass", ")", "#", "6", "(", "0", ")", "{", "}", "}", "[", "\"", "inf", "\"", "]=", ">", "int", "(", "1", ")", "}", "[", "\"%", "s", "\"", "]=", ">", "array", "(", "2", ")", "{", "[", "\"", "obj", "\"", "]=", ">", "object", "(", "stdClass", ")", "#", "6", "(", "0", ")", "{", "}", "[", "\"", "inf", "\"", "]=", ">", "int", "(", "2", ")", "}", "}", "}", "@", "@", "-", "60", ",", "6", "+", "60", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "zval", "*", "*", "rval", ",", "const", "unsigned", "char", "*", "*", "p", ",", "const", "unsig", "var_destroy", "(", "&(", "var_hash", ")", ")", "PHPAPI", "void", "var_replace", "(", "php_unserialize_data_t", "*", "var_hash", ",", "zval", "*", "ozval", ",", "zval", "*", "*", "nzval", ")", ";", "PHPAPI", "void", "var_push_dtor", "(", "php_unserialize_data_t", "*", "var_hash", ",", "zval", "*", "*", "val", ")", ";", "PHPAPI", "void", "var_destroy", "(", "php_unserialize_data_t", "*", "var_hash", ")", ";", "#", "define", "PHP_VAR_UNSERIALIZE_ZVAL_CHANGED", "(", "var_hash", ",", "ozval", ",", "nzval", ")", "\\", "@", "@", "-", "1", ",", "4", "+", "1", ",", "4", "@", "@", "/", "*", "Generated", "by", "re2c", "0", ".", "13", ".", "5", "on", "Mon", "Apr", "12", "10", ":", "11", ":", "22", "2010", "*", "/", "/", "*", "Generated", "by", "re2c", "0", ".", "13", ".", "5", "on", "Fri", "Jun", "25", "15", ":", "36", ":", "31", "2010", "*", "/", "#", "line", "1", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "/", "*", "+", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "@", "@", "-", "56", ",", "7", "+", "56", ",", "7", "@", "@", "static", "inline", "void", "var_push", "(", "php_unserialize_data_t", "*", "var_hashx", ",", "zval", "*", "*", "rval", ")", "var_hash", "-", ">", "data", "[", "var_hash", "-", ">", "used_slots", "+", "+]", "=", "*", "rval", ";", "}", "static", "inline", "void", "var_push_dtor", "(", "php_unserialize_data_t", "*", "var_hashx", ",", "zval", "*", "*", "rval", ")", "PHPAPI", "void", "var_push_dtor", "(", "php_unserialize_data_t", "*", "var_hashx", ",", "zval", "*", "*", "rval", ")", "{", "var_entries", "*", "var_hash", "=", "var_hashx", "-", ">", "first_dtor", ",", "*", "prev", "=", "NULL", ";", "@", "@", "-", "54", ",", "7", "+", "54", ",", "7", "@", "@", "static", "inline", "void", "var_push", "(", "php_unserialize_data_t", "*", "var_hashx", ",", "zval", "*", "*", "rval", ")", "var_hash", "-", ">", "data", "[", "var_hash", "-", ">", "used_slots", "+", "+]", "=", "*", "rval", ";", "}", "static", "inline", "void", "var_push_dtor", "(", "php_unserialize_data_t", "*", "var_hashx", ",", "zval", "*", "*", "rval", ")", "PHPAPI", "void", "var_push_dtor", "(", "php_unserialize_data_t", "*", "var_hashx", ",", "zval", "*", "*", "rval", ")", "{", "var_entries", "*", "var_hash", "=", "var_hashx", "-", ">", "first_dtor", ",", "*", "prev", "=", "NULL", ";"], "docstring_tokens": ["via", "serialized", "data"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "71", ",", "6", "+", "71", ",", "7", "@", "@", "import", "io", ".", "undertow", ".", "servlet", ".", "api", ".", "ThreadSetupHandler", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "api", ".", "WebResourceCollection", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "handlers", ".", "CrawlerSessionManagerHandler", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "handlers", ".", "RedirectDirHandler", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "handlers", ".", "ServletDispatchingHandler", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "handlers", ".", "ServletHandler", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "handlers", ".", "ServletInitialHandler", ";", "@", "@", "-", "218", ",", "6", "+", "219", ",", "7", "@", "@", "public", "Void", "call", "(", "HttpServerExchange", "exchange", ",", "Object", "ignore", ")", "throws", "Exception", "{", "HttpHandler", "wrappedHandlers", "=", "ServletDispatchingHandler", ".", "INSTANCE", ";", "wrappedHandlers", "=", "wrapHandlers", "(", "wrappedHandlers", ",", "deploymentInfo", ".", "getInnerHandlerChainWrappers", "(", "))", ";", "wrappedHandlers", "=", "new", "RedirectDirHandler", "(", "wrappedHandlers", ",", "deployment", ".", "getServletPaths", "(", "))", ";", "if", "(", "!", "deploymentInfo", ".", "isSecurityDisabled", "(", "))", "{", "HttpHandler", "securityHandler", "=", "setupSecurityHandlers", "(", "wrappedHandlers", ")", ";", "wrappedHandlers", "=", "new", "PredicateHandler", "(", "DispatcherTypePredicate", ".", "REQUEST", ",", "securityHandler", ",", "wrappedHandlers", ")", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "71", "@", "@", "/", "*", "*", "JBoss", ",", "Home", "of", "Professional", "Open", "Source", ".", "*", "Copyright", "2019", "Red", "Hat", ",", "Inc", ".", ",", "and", "individual", "contributors", "*", "as", "indicated", "by", "the", "@", "author", "tags", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "io", ".", "undertow", ".", "servlet", ".", "handlers", ";", "import", "io", ".", "undertow", ".", "server", ".", "HttpHandler", ";", "import", "io", ".", "undertow", ".", "server", ".", "HttpServerExchange", ";", "import", "io", ".", "undertow", ".", "util", ".", "Headers", ";", "import", "io", ".", "undertow", ".", "util", ".", "Methods", ";", "import", "io", ".", "undertow", ".", "util", ".", "RedirectBuilder", ";", "import", "io", ".", "undertow", ".", "util", ".", "StatusCodes", ";", "/", "**", "*", "Handler", "that", "redirects", "the", "directory", "requests", "without", "trailing", "slash", "to", "the", "one", "append", "trailing", "slash", ".", "*", "*", "@", "author", "Lin", "Gao", "*", "/", "public", "class", "RedirectDirHandler", "implements", "HttpHandler", "{", "private", "static", "final", "String", "HTTP2_UPGRADE_PREFIX", "=", "\"", "h2", "\"", ";", "private", "final", "HttpHandler", "next", ";", "private", "final", "ServletPathMatches", "paths", ";", "public", "RedirectDirHandler", "(", "HttpHandler", "next", ",", "ServletPathMatches", "paths", ")", "{", "this", ".", "next", "=", "next", ";", "this", ".", "paths", "=", "paths", ";", "}", "@", "Override", "public", "void", "handleRequest", "(", "HttpServerExchange", "exchange", ")", "throws", "Exception", "{", "final", "String", "path", "=", "exchange", ".", "getRelativePath", "(", ");", "final", "ServletPathMatch", "info", "=", "paths", ".", "getServletHandlerByPath", "(", "path", ")", ";", "/", "/", "https", ":", "//", "issues", ".", "jboss", ".", "org", "/", "browse", "/", "WFLY", "-", "3439", "/", "/", "if", "the", "request", "is", "an", "upgrade", "request", "then", "we", "don", "'", "t", "want", "to", "redirect", "/", "/", "as", "there", "is", "a", "good", "chance", "the", "web", "socket", "client", "won", "'", "t", "understand", "the", "redirect", "/", "/", "we", "make", "an", "exception", "for", "HTTP2", "upgrade", "requests", ",", "as", "this", "would", "have", "already", "be", "handled", "at", "/", "/", "the", "connector", "level", "if", "it", "was", "going", "to", "be", "handled", ".", "String", "upgradeString", "=", "exchange", ".", "getRequestHeaders", "(", ").", "getFirst", "(", "Headers", ".", "UPGRADE", ")", ";", "boolean", "isUpgradeRequest", "=", "upgradeString", "!", "=", "null", "&", "&", "!", "upgradeString", ".", "startsWith", "(", "HTTP2_UPGRADE_PREFIX", ")", ";", "if", "(", "info", ".", "getType", "(", ")", "=", "=", "ServletPathMatch", ".", "Type", ".", "REDIRECT", "&", "&", "!", "isUpgradeRequest", ")", "{", "/", "/", "UNDERTOW", "-", "89", "/", "/", "we", "redirect", "on", "GET", "requests", "to", "the", "root", "context", "to", "add", "an", "/", "to", "the", "end", "if", "(", "exchange", ".", "getRequestMethod", "(", ").", "equals", "(", "Methods", ".", "GET", ")", "|", "|", "exchange", ".", "getRequestMethod", "(", ").", "equals", "(", "Methods", ".", "HEAD", ")", ")", "{", "exchange", ".", "setStatusCode", "(", "StatusCodes", ".", "FOUND", ")", ";", "}", "else", "{", "exchange", ".", "setStatusCode", "(", "StatusCodes", ".", "TEMPORARY_REDIRECT", ")", ";", "}", "exchange", ".", "getResponseHeaders", "(", ").", "put", "(", "Headers", ".", "LOCATION", ",", "RedirectBuilder", ".", "redirect", "(", "exchange", ",", "exchange", ".", "getRelativePath", "(", ")", "+", "\"", "/\"", ",", "true", ")", ");", "return", ";", "}", "next", ".", "handleRequest", "(", "exchange", ")", ";", "}", "}", "@", "@", "-", "39", ",", "11", "+", "39", ",", "8", "@", "@", "import", "io", ".", "undertow", ".", "servlet", ".", "spec", ".", "HttpServletResponseImpl", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "spec", ".", "RequestDispatcherImpl", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "spec", ".", "ServletContextImpl", ";", "import", "io", ".", "undertow", ".", "util", ".", "Headers", ";", "import", "io", ".", "undertow", ".", "util", ".", "HttpString", ";", "import", "io", ".", "undertow", ".", "util", ".", "Methods", ";", "import", "io", ".", "undertow", ".", "util", ".", "Protocols", ";", "import", "io", ".", "undertow", ".", "util", ".", "RedirectBuilder", ";", "import", "io", ".", "undertow", ".", "util", ".", "StatusCodes", ";", "import", "org", ".", "xnio", ".", "ChannelListener", ";", "import", "org", ".", "xnio", ".", "Option", ";", "@", "@", "-", "80", ",", "8", "+", "77", ",", "6", "@", "@", "*", "/", "public", "class", "ServletInitialHandler", "implements", "HttpHandler", ",", "ServletDispatcher", "{", "private", "static", "final", "String", "HTTP2_UPGRADE_PREFIX", "=", "\"", "h2", "\"", ";", "private", "static", "final", "RuntimePermission", "PERMISSION", "=", "new", "RuntimePermission", "(", "\"", "io", ".", "undertow", ".", "servlet", ".", "CREATE_INITIAL_HANDLER", "\"", ");", "private", "final", "HttpHandler", "next", ";", "@", "@", "-", "149", ",", "30", "+", "144", ",", "12", "@", "@", "public", "void", "handleRequest", "(", "final", "HttpServerExchange", "exchange", ")", "throws", "Exception", "{", "return", ";", "}", "final", "ServletPathMatch", "info", "=", "paths", ".", "getServletHandlerByPath", "(", "path", ")", ";", "/", "/", "https", ":", "//", "issues", ".", "jboss", ".", "org", "/", "browse", "/", "WFLY", "-", "3439", "/", "/", "if", "the", "request", "is", "an", "upgrade", "request", "then", "we", "don", "'", "t", "want", "to", "redirect", "/", "/", "as", "there", "is", "a", "good", "chance", "the", "web", "socket", "client", "won", "'", "t", "understand", "the", "redirect", "/", "/", "we", "make", "an", "exception", "for", "HTTP2", "upgrade", "requests", ",", "as", "this", "would", "have", "already", "be", "handled", "at", "/", "/", "the", "connector", "level", "if", "it", "was", "going", "to", "be", "handled", ".", "String", "upgradeString", "=", "exchange", ".", "getRequestHeaders", "(", ").", "getFirst", "(", "Headers", ".", "UPGRADE", ")", ";", "boolean", "isUpgradeRequest", "=", "upgradeString", "!", "=", "null", "&", "&", "!", "upgradeString", ".", "startsWith", "(", "HTTP2_UPGRADE_PREFIX", ")", ";", "if", "(", "info", ".", "getType", "(", ")", "=", "=", "ServletPathMatch", ".", "Type", ".", "REDIRECT", "&", "&", "!", "isUpgradeRequest", ")", "{", "/", "/", "UNDERTOW", "-", "89", "/", "/", "we", "redirect", "on", "GET", "requests", "to", "the", "root", "context", "to", "add", "an", "/", "to", "the", "end", "if", "(", "exchange", ".", "getRequestMethod", "(", ").", "equals", "(", "Methods", ".", "GET", ")", "|", "|", "exchange", ".", "getRequestMethod", "(", ").", "equals", "(", "Methods", ".", "HEAD", ")", ")", "{", "exchange", ".", "setStatusCode", "(", "StatusCodes", ".", "FOUND", ")", ";", "}", "else", "{", "exchange", ".", "setStatusCode", "(", "StatusCodes", ".", "TEMPORARY_REDIRECT", ")", ";", "}", "exchange", ".", "getResponseHeaders", "(", ").", "put", "(", "Headers", ".", "LOCATION", ",", "RedirectBuilder", ".", "redirect", "(", "exchange", ",", "exchange", ".", "getRelativePath", "(", ")", "+", "\"", "/\"", ",", "true", ")", ");", "return", ";", "}", "else", "if", "(", "info", ".", "getType", "(", ")", "=", "=", "ServletPathMatch", ".", "Type", ".", "REWRITE", ")", "{", "/", "/", "this", "can", "only", "happen", "if", "the", "path", "ends", "with", "a", "/", "/", "/", "otherwise", "there", "would", "be", "a", "redirect", "instead", "if", "(", "info", ".", "getType", "(", ")", "=", "=", "ServletPathMatch", ".", "Type", ".", "REWRITE", ")", "{", "/", "/", "this", "can", "only", "happen", "if", "the", "path", "ends", "with", "a", "/", "/", "/", "otherwise", "there", "would", "be", "a", "redirect", "instead", "exchange", ".", "setRelativePath", "(", "info", ".", "getRewriteLocation", "(", "))", ";", "exchange", ".", "setRequestPath", "(", "exchange", ".", "getResolvedPath", "(", ")", "+", "info", ".", "getRewriteLocation", "(", "))", ";", "}", "final", "HttpServletResponseImpl", "response", "=", "new", "HttpServletResponseImpl", "(", "exchange", ",", "servletContext", ")", ";", "final", "HttpServletRequestImpl", "request", "=", "new", "HttpServletRequestImpl", "(", "exchange", ",", "servletContext", ")", ";", "final", "ServletRequestContext", "servletRequestContext", "=", "new", "ServletRequestContext", "(", "servletContext", ".", "getDeployment", "(", "),", "request", ",", "response", ",", "info", ")", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "168", "@", "@", "/", "*", "*", "JBoss", ",", "Home", "of", "Professional", "Open", "Source", ".", "*", "Copyright", "2019", "Red", "Hat", ",", "Inc", ".", ",", "and", "individual", "contributors", "*", "as", "indicated", "by", "the", "@", "author", "tags", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "io", ".", "undertow", ".", "servlet", ".", "test", ".", "defaultservlet", ";", "import", "static", "io", ".", "undertow", ".", "util", ".", "Headers", ".", "AUTHORIZATION", ";", "import", "static", "io", ".", "undertow", ".", "util", ".", "Headers", ".", "BASIC", ";", "import", "static", "io", ".", "undertow", ".", "util", ".", "Headers", ".", "LOCATION", ";", "import", "static", "io", ".", "undertow", ".", "util", ".", "Headers", ".", "WWW_AUTHENTICATE", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "javax", ".", "servlet", ".", "ServletException", ";", "import", "org", ".", "apache", ".", "http", ".", "Header", ";", "import", "org", ".", "apache", ".", "http", ".", "HttpResponse", ";", "import", "org", ".", "apache", ".", "http", ".", "client", ".", "HttpClient", ";", "import", "org", ".", "apache", ".", "http", ".", "client", ".", "methods", ".", "HttpGet", ";", "import", "org", ".", "apache", ".", "http", ".", "impl", ".", "client", ".", "HttpClientBuilder", ";", "import", "org", ".", "junit", ".", "Assert", ";", "import", "org", ".", "junit", ".", "BeforeClass", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", ";", "import", "io", ".", "undertow", ".", "server", ".", "handlers", ".", "PathHandler", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "api", ".", "DeploymentInfo", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "api", ".", "DeploymentManager", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "api", ".", "LoginConfig", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "api", ".", "SecurityConstraint", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "api", ".", "ServletContainer", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "api", ".", "WebResourceCollection", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "test", ".", "path", ".", "ServletPathMappingTestCase", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "test", ".", "security", ".", "constraint", ".", "ServletIdentityManager", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "test", ".", "util", ".", "TestClassIntrospector", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "test", ".", "util", ".", "TestResourceLoader", ";", "import", "io", ".", "undertow", ".", "testutils", ".", "DefaultServer", ";", "import", "io", ".", "undertow", ".", "testutils", ".", "HttpClientUtils", ";", "import", "io", ".", "undertow", ".", "util", ".", "FlexBase64", ";", "import", "io", ".", "undertow", ".", "util", ".", "StatusCodes", ";", "/", "**", "*", "TestCase", "on", "redirect", "with", "or", "without", "trailing", "slash", "when", "requesting", "protected", "path", ".", "*", "*", "@", "author", "Lin", "Gao", "*", "/", "@", "RunWith", "(", "DefaultServer", ".", "class", ")", "public", "class", "SecurityRedirectTestCase", "{", "@", "BeforeClass", "public", "static", "void", "setup", "(", ")", "throws", "ServletException", "{", "final", "PathHandler", "root", "=", "new", "PathHandler", "(", ");", "final", "ServletContainer", "container", "=", "ServletContainer", ".", "Factory", ".", "newInstance", "(", ");", "ServletIdentityManager", "identityManager", "=", "new", "ServletIdentityManager", "(", ");", "identityManager", ".", "addUser", "(", "\"", "user1", "\"", ",", "\"", "password1", "\"", ",", "\"", "role1", "\"", ");", "DeploymentInfo", "builder", "=", "new", "DeploymentInfo", "(", ")", ".", "setClassIntrospecter", "(", "TestClassIntrospector", ".", "INSTANCE", ")", ".", "setClassLoader", "(", "ServletPathMappingTestCase", ".", "class", ".", "getClassLoader", "(", "))", ".", "setContextPath", "(", "\"/", "servletContext", "\"", ")", ".", "setDeploymentName", "(", "\"", "servletContext", ".", "war", "\"", ")", ".", "setResourceManager", "(", "new", "TestResourceLoader", "(", "SecurityRedirectTestCase", ".", "class", ")", ")", ".", "addWelcomePages", "(", "\"", "index", ".", "html", "\"", ")", ".", "setIdentityManager", "(", "identityManager", ")", ".", "setLoginConfig", "(", "new", "LoginConfig", "(", "\"", "BASIC", "\"", ",", "\"", "Test", "Realm", "\"", "))", ".", "addSecurityConstraint", "(", "new", "SecurityConstraint", "(", ")", ".", "addRoleAllowed", "(", "\"", "role1", "\"", ")", ".", "addWebResourceCollection", "(", "new", "WebResourceCollection", "(", ")", ".", "addUrlPatterns", "(", "\"/", "index", ".", "html", "\"", ",", "\"", "/", "filterpath", "/", "*\"", "))", ");", "DeploymentManager", "manager", "=", "container", ".", "addDeployment", "(", "builder", ")", ";", "manager", ".", "deploy", "(", ");", "root", ".", "addPrefixPath", "(", "builder", ".", "getContextPath", "(", "),", "manager", ".", "start", "(", "))", ";", "DefaultServer", ".", "setRootHandler", "(", "root", ")", ";", "}", "@", "SuppressWarnings", "(", "\"", "deprecation", "\"", ")", "@", "Test", "public", "void", "testSecurityWithWelcomeFileRedirect", "(", ")", "throws", "IOException", "{", "/", "/", "disable", "following", "redirect", "HttpClient", "client", "=", "HttpClientBuilder", ".", "create", "(", ").", "disableRedirectHandling", "(", ").", "build", "(", ");", "try", "{", "HttpGet", "get", "=", "new", "HttpGet", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "\"", ");", "HttpResponse", "result", "=", "client", ".", "execute", "(", "get", ")", ";", "Assert", ".", "assertEquals", "(", "StatusCodes", ".", "FOUND", ",", "result", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "))", ";", "Header", "[", "]", "values", "=", "result", ".", "getHeaders", "(", "LOCATION", ".", "toString", "(", "))", ";", "assertEquals", "(", "1", ",", "values", ".", "length", ")", ";", "assertEquals", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "/", "\",", "values", "[", "0", "]", ".", "getValue", "(", "))", ";", "HttpClientUtils", ".", "readResponse", "(", "result", ")", ";", "get", "=", "new", "HttpGet", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "/", "\")", ";", "result", "=", "client", ".", "execute", "(", "get", ")", ";", "Assert", ".", "assertEquals", "(", "StatusCodes", ".", "UNAUTHORIZED", ",", "result", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "))", ";", "values", "=", "result", ".", "getHeaders", "(", "WWW_AUTHENTICATE", ".", "toString", "(", "))", ";", "assertEquals", "(", "1", ",", "values", ".", "length", ")", ";", "assertEquals", "(", "BASIC", "+", "\"", "realm", "=", "\\\"", "Test", "Realm", "\\", "\"\"", ",", "values", "[", "0", "]", ".", "getValue", "(", "))", ";", "HttpClientUtils", ".", "readResponse", "(", "result", ")", ";", "get", "=", "new", "HttpGet", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "/", "\")", ";", "get", ".", "addHeader", "(", "AUTHORIZATION", ".", "toString", "(", "),", "BASIC", "+", "\"", "\"", "+", "FlexBase64", ".", "encodeString", "(", "\"", "user1", ":", "password1", "\"", ".", "getBytes", "(", "),", "false", ")", ");", "result", "=", "client", ".", "execute", "(", "get", ")", ";", "String", "response", "=", "HttpClientUtils", ".", "readResponse", "(", "result", ")", ";", "Assert", ".", "assertEquals", "(", "StatusCodes", ".", "OK", ",", "result", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "))", ";", "Assert", ".", "assertTrue", "(", "response", ".", "contains", "(", "\"", "Redirected", "home", "page", "\"", "))", ";", "}", "finally", "{", "client", ".", "getConnectionManager", "(", ").", "shutdown", "(", ");", "}", "}", "@", "SuppressWarnings", "(", "\"", "deprecation", "\"", ")", "@", "Test", "public", "void", "testSecurityWithoutWelcomeFileRedirect", "(", ")", "throws", "IOException", "{", "/", "/", "disable", "following", "redirect", "HttpClient", "client", "=", "HttpClientBuilder", ".", "create", "(", ").", "disableRedirectHandling", "(", ").", "build", "(", ");", "try", "{", "HttpGet", "get", "=", "new", "HttpGet", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "/", "filterpath", "\"", ");", "HttpResponse", "result", "=", "client", ".", "execute", "(", "get", ")", ";", "Assert", ".", "assertEquals", "(", "StatusCodes", ".", "UNAUTHORIZED", ",", "result", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "))", ";", "HttpClientUtils", ".", "readResponse", "(", "result", ")", ";", "get", "=", "new", "HttpGet", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "/", "filterpath", "/", "\")", ";", "result", "=", "client", ".", "execute", "(", "get", ")", ";", "Assert", ".", "assertEquals", "(", "StatusCodes", ".", "UNAUTHORIZED", ",", "result", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "))", ";", "Header", "[", "]", "values", "=", "result", ".", "getHeaders", "(", "WWW_AUTHENTICATE", ".", "toString", "(", "))", ";", "assertEquals", "(", "1", ",", "values", ".", "length", ")", ";", "assertEquals", "(", "BASIC", "+", "\"", "realm", "=", "\\\"", "Test", "Realm", "\\", "\"\"", ",", "values", "[", "0", "]", ".", "getValue", "(", "))", ";", "HttpClientUtils", ".", "readResponse", "(", "result", ")", ";", "get", "=", "new", "HttpGet", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "/", "filterpath", "\"", ");", "get", ".", "addHeader", "(", "AUTHORIZATION", ".", "toString", "(", "),", "BASIC", "+", "\"", "\"", "+", "FlexBase64", ".", "encodeString", "(", "\"", "user1", ":", "password1", "\"", ".", "getBytes", "(", "),", "false", ")", ");", "result", "=", "client", ".", "execute", "(", "get", ")", ";", "Assert", ".", "assertEquals", "(", "StatusCodes", ".", "FOUND", ",", "result", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "))", ";", "values", "=", "result", ".", "getHeaders", "(", "LOCATION", ".", "toString", "(", "))", ";", "assertEquals", "(", "1", ",", "values", ".", "length", ")", ";", "assertEquals", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "/", "filterpath", "/", "\",", "values", "[", "0", "]", ".", "getValue", "(", "))", ";", "HttpClientUtils", ".", "readResponse", "(", "result", ")", ";", "get", "=", "new", "HttpGet", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "/", "filterpath", "/", "filtered", ".", "txt", "\"", ");", "get", ".", "addHeader", "(", "AUTHORIZATION", ".", "toString", "(", "),", "BASIC", "+", "\"", "\"", "+", "FlexBase64", ".", "encodeString", "(", "\"", "user1", ":", "password1", "\"", ".", "getBytes", "(", "),", "false", ")", ");", "result", "=", "client", ".", "execute", "(", "get", ")", ";", "String", "response", "=", "HttpClientUtils", ".", "readResponse", "(", "result", ")", ";", "Assert", ".", "assertEquals", "(", "StatusCodes", ".", "OK", ",", "result", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "))", ";", "Assert", ".", "assertTrue", "(", "response", ".", "equals", "(", "\"", "Stuart", "\"", "))", ";", "}", "finally", "{", "client", ".", "getConnectionManager", "(", ").", "shutdown", "(", ");", "}", "}", "}"], "docstring_tokens": ["through", "requests", "without", "trailing", "slashes", "via", "the", "api", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "107", ",", "12", "+", "107", ",", "6", "@", "@", "public", "static", "void", "setDefaults", "(", ")", "X509CRL", ".", "setDefaultStr", "(", "getDefaultCRL", "(", "))", ";", "}", "/", "/", "FIXME", ":", "/", "/", "Need", "to", "shutdown", "the", "connection", "cleanly", "/", "/", "FIXME", "?", "/", "/", "add", "a", "finalizer", "method", "that", "calls", "shutdown", "public", "boolean", "processMsg", "(", "CConnection", "cc", ")", "{", "is", "=", "(", "FdInStream", ")", "cc", ".", "getInStream", "(", ");", "os", "=", "(", "FdOutStream", ")", "cc", ".", "getOutStream", "(", ");", "@", "@", "-", "269", ",", "8", "+", "263", ",", "13", "@", "@", "public", "void", "checkServerTrusted", "(", "X509Certificate", "[", "]", "chain", ",", "String", "authType", ")", "{", "Collection", "<", "?", "extends", "Certificate", ">", "certs", "=", "null", ";", "X509Certificate", "cert", "=", "chain", "[", "0", "]", ";", "String", "pk", "=", "Base64", ".", "getEncoder", "(", ").", "encodeToString", "(", "cert", ".", "getPublicKey", "(", ").", "getEncoded", "(", "))", ";", "try", "{", "cert", ".", "checkValidity", "(", ");", "verifyHostname", "(", "cert", ")", ";", "}", "catch", "(", "CertificateParsingException", "e", ")", "{", "throw", "new", "SystemException", "(", "e", ".", "getMessage", "(", "))", ";", "}", "catch", "(", "CertificateNotYetValidException", "e", ")", "{", "throw", "new", "AuthFailureException", "(", "\"", "server", "certificate", "has", "not", "been", "activated", "\"", ");", "}", "catch", "(", "CertificateExpiredException", "e", ")", "{", "@", "@", "-", "279", ",", "73", "+", "278", ",", "111", "@", "@", "public", "void", "checkServerTrusted", "(", "X509Certificate", "[", "]", "chain", ",", "String", "authType", ")", "\"", "do", "you", "want", "to", "continue", "?", "\")", ")", "throw", "new", "AuthFailureException", "(", "\"", "server", "certificate", "has", "expired", "\"", ");", "}", "String", "thumbprint", "=", "getThumbprint", "(", "cert", ")", ";", "File", "vncDir", "=", "new", "File", "(", "FileUtils", ".", "getVncHomeDir", "(", "))", ";", "File", "certFile", "=", "new", "File", "(", "vncDir", ",", "\"", "x509_savedcerts", ".", "pem", "\"", ");", "CertificateFactory", "cf", "=", "CertificateFactory", ".", "getInstance", "(", "\"", "X", ".", "509", "\"", ");", "if", "(", "vncDir", ".", "exists", "(", ")", "&", "&", "certFile", ".", "exists", "(", ")", "&", "&", "certFile", ".", "canRead", "(", "))", "{", "InputStream", "certStream", "=", "new", "MyFileInputStream", "(", "certFile", ")", ";", "certs", "=", "cf", ".", "generateCertificates", "(", "certStream", ")", ";", "for", "(", "Certificate", "c", ":", "certs", ")", "if", "(", "thumbprint", ".", "equals", "(", "getThumbprint", "(", "(", "X509Certificate", ")", "c", ")", "))", "return", ";", "}", "if", "(", "!", "vncDir", ".", "exists", "(", "))", "throw", "new", "AuthFailureException", "(", "\"", "Could", "not", "obtain", "VNC", "home", "directory", "\"", "\"", "path", "for", "known", "hosts", "storage", "\"", ");", "File", "dbPath", "=", "new", "File", "(", "vncDir", ",", "\"", "x509_known_hosts", "\"", ");", "String", "info", "=", "\"", "Subject", ":", "\"", "+", "cert", ".", "getSubjectX500Principal", "(", ").", "getName", "(", ")+", "\"\\", "n", "\"", "\"", "Issuer", ":", "\"", "+", "cert", ".", "getIssuerX500Principal", "(", ").", "getName", "(", ")+", "\"\\", "n", "\"", "\"", "Serial", "Number", ":", "\"", "+", "cert", ".", "getSerialNumber", "(", ")+", "\"\\", "n", "\"", "\"", "Version", ":", "\"", "+", "cert", ".", "getVersion", "(", ")+", "\"\\", "n", "\"", "\"", "Signature", "Algorithm", ":", "\"", "+", "cert", ".", "getPublicKey", "(", ").", "getAlgorithm", "(", ")+", "\"\\", "n", "\"", "\"", "Not", "Valid", "Before", ":", "\"", "+", "cert", ".", "getNotBefore", "(", ")+", "\"\\", "n", "\"", "\"", "Not", "Valid", "After", ":", "\"", "+", "cert", ".", "getNotAfter", "(", ")+", "\"\\", "n", "\"", "\"", "SHA", "-", "1", "Fingerprint", ":", "\"", "+", "getThumbprint", "(", "cert", ")", "+\"", "\\", "n", "\"", ";", "try", "{", "verifyHostname", "(", "cert", ")", ";", "if", "(", "dbPath", ".", "exists", "(", "))", "{", "FileReader", "db", "=", "new", "FileReader", "(", "dbPath", ")", ";", "BufferedReader", "dbBuf", "=", "new", "BufferedReader", "(", "db", ")", ";", "String", "line", ";", "String", "server", "=", "client", ".", "getServerName", "(", ").", "toLowerCase", "(", ");", "while", "(", "(", "line", "=", "dbBuf", ".", "readLine", "(", "))", "!=", "null", ")", "{", "String", "fields", "[", "]", "=", "line", ".", "split", "(", "\"\\", "\\|", "\")", ";", "if", "(", "fields", ".", "length", "=", "=", "6", ")", "{", "if", "(", "server", ".", "equals", "(", "fields", "[", "2", "]", ")", "&", "&", "pk", ".", "equals", "(", "fields", "[", "5", "]", "))", "{", "vlog", ".", "debug", "(", "\"", "Server", "certificate", "found", "in", "known", "hosts", "file", "\"", ");", "dbBuf", ".", "close", "(", ");", "return", ";", "}", "else", "if", "(", "server", ".", "equals", "(", "fields", "[", "2", "]", ")", "&", "&", "!", "pk", ".", "equals", "(", "fields", "[", "5", "]", ")", "|", "|", "!", "server", ".", "equals", "(", "fields", "[", "2", "]", ")", "&", "&", "pk", ".", "equals", "(", "fields", "[", "5", "]", "))", "{", "throw", "new", "CertStoreException", "(", ");", "}", "}", "}", "dbBuf", ".", "close", "(", ");", "}", "tm", ".", "checkServerTrusted", "(", "chain", ",", "authType", ")", ";", "}", "catch", "(", "IOException", "e", ")", "{", "throw", "new", "AuthFailureException", "(", "\"", "Could", "not", "load", "known", "hosts", "database", "\"", ");", "}", "catch", "(", "CertStoreException", "e", ")", "{", "vlog", ".", "debug", "(", "\"", "Server", "host", "key", "mismatch", "\"", ");", "vlog", ".", "debug", "(", "info", ")", ";", "String", "text", "=", "\"", "This", "host", "is", "previously", "known", "with", "a", "different", "\"", "\"", "certificate", ",", "and", "the", "new", "certificate", "has", "been", "\"", "\"", "signed", "by", "an", "unknown", "authority", "\\", "n", "\"", "\"", "\\", "n", "\"", "+", "info", "+", "\"\\", "n", "\"", "\"", "Someone", "could", "be", "trying", "to", "impersonate", "the", "site", "and", "you", "should", "not", "continue", ".", "\\", "n", "\"", "\"", "\\", "n", "\"", "\"", "Do", "you", "want", "to", "make", "an", "exception", "for", "this", "server", "?", "\";", "if", "(", "!", "msg", ".", "showMsgBox", "(", "YES_NO_OPTION", ",", "\"", "Unexpected", "certificate", "issuer", "\"", ",", "text", ")", ")", "throw", "new", "AuthFailureException", "(", "\"", "Unexpected", "certificate", "issuer", "\"", ");", "store_pubkey", "(", "dbPath", ",", "client", ".", "getServerName", "(", ").", "toLowerCase", "(", "),", "pk", ")", ";", "}", "catch", "(", "java", ".", "lang", ".", "Exception", "e", ")", "{", "if", "(", "e", ".", "getCause", "(", ")", "instanceof", "CertPathBuilderException", ")", "{", "String", "certinfo", "=", "vlog", ".", "debug", "(", "\"", "Server", "host", "not", "previously", "known", "\"", ");", "vlog", ".", "debug", "(", "info", ")", ";", "String", "text", "=", "\"", "This", "certificate", "has", "been", "signed", "by", "an", "unknown", "authority", "\\", "n", "\"", "+", "\"", "\\", "n", "\"", "+", "info", "+", "\"\\", "n", "\"", "\"", "Someone", "could", "be", "trying", "to", "impersonate", "the", "site", "and", "you", "should", "not", "continue", ".", "\\", "n", "\"", "\"", "\\", "n", "\"", "+", "\"", "Subject", ":", "\"", "+", "cert", ".", "getSubjectX500Principal", "(", ").", "getName", "(", ")+", "\"\\", "n", "\"", "+", "\"", "Issuer", ":", "\"", "+", "cert", ".", "getIssuerX500Principal", "(", ").", "getName", "(", ")+", "\"\\", "n", "\"", "+", "\"", "Serial", "Number", ":", "\"", "+", "cert", ".", "getSerialNumber", "(", ")+", "\"\\", "n", "\"", "+", "\"", "Version", ":", "\"", "+", "cert", ".", "getVersion", "(", ")+", "\"\\", "n", "\"", "+", "\"", "Signature", "Algorithm", ":", "\"", "+", "cert", ".", "getPublicKey", "(", ").", "getAlgorithm", "(", ")+", "\"\\", "n", "\"", "+", "\"", "Not", "Valid", "Before", ":", "\"", "+", "cert", ".", "getNotBefore", "(", ")+", "\"\\", "n", "\"", "+", "\"", "Not", "Valid", "After", ":", "\"", "+", "cert", ".", "getNotAfter", "(", ")+", "\"\\", "n", "\"", "+", "\"", "SHA1", "Fingerprint", ":", "\"", "+", "getThumbprint", "(", "cert", ")", "+\"", "\\", "n", "\"", "+", "\"", "\\", "n", "\"", "+", "\"", "Do", "you", "want", "to", "save", "it", "and", "continue", "?", "\";", "if", "(", "!", "msg", ".", "showMsgBox", "(", "YES_NO_OPTION", ",", "\"", "certificate", "issuer", "unknown", "\"", ",", "certinfo", ")", ")", "{", "throw", "new", "AuthFailureException", "(", "\"", "certificate", "issuer", "unknown", "\"", ");", "}", "if", "(", "certs", "=", "=", "null", "|", "|", "!", "certs", ".", "contains", "(", "cert", ")", ")", "{", "byte", "[", "]", "der", "=", "cert", ".", "getEncoded", "(", ");", "String", "pem", "=", "Base64", ".", "getEncoder", "(", ").", "encodeToString", "(", "der", ")", ";", "pem", "=", "pem", ".", "replaceAll", "(", "\"(", ".{", "64", "}", ")\"", ",", "\"", "$", "1", "\\", "n", "\"", ");", "FileWriter", "fw", "=", "null", ";", "try", "{", "if", "(", "!", "vncDir", ".", "exists", "(", "))", "vncDir", ".", "mkdir", "(", ");", "if", "(", "!", "certFile", ".", "exists", "(", ")", "&", "&", "!", "certFile", ".", "createNewFile", "(", "))", "{", "vlog", ".", "error", "(", "\"", "Certificate", "save", "failed", ".", "\")", ";", "}", "else", "{", "fw", "=", "new", "FileWriter", "(", "certFile", ".", "getAbsolutePath", "(", "),", "true", ")", ";", "fw", ".", "write", "(", "\"-", "--", "--", "BEGIN", "CERTIFICATE", "-", "--", "--", "\\", "n", "\"", ");", "fw", ".", "write", "(", "pem", "+", "\"\\", "n", "\"", ");", "fw", ".", "write", "(", "\"-", "--", "--", "END", "CERTIFICATE", "-", "--", "--", "\\", "n", "\"", ");", "}", "}", "catch", "(", "IOException", "ioe", ")", "{", "msg", ".", "showMsgBox", "(", "OK_OPTION", ",", "\"", "certificate", "save", "failed", "\"", ",", "\"", "Could", "not", "save", "the", "certificate", "\"", ");", "}", "finally", "{", "try", "{", "if", "(", "fw", "!", "=", "null", ")", "fw", ".", "close", "(", ");", "}", "catch", "(", "IOException", "ioe2", ")", "{", "throw", "new", "Exception", "(", "ioe2", ".", "getMessage", "(", "))", ";", "}", "}", "}", "\"", "Do", "you", "want", "to", "make", "an", "exception", "for", "this", "server", "?", "\";", "if", "(", "!", "msg", ".", "showMsgBox", "(", "YES_NO_OPTION", ",", "\"", "Unknown", "certificate", "issuer", "\"", ",", "text", ")", ")", "throw", "new", "AuthFailureException", "(", "\"", "Unknown", "certificate", "issuer", "\"", ");", "store_pubkey", "(", "dbPath", ",", "client", ".", "getServerName", "(", ").", "toLowerCase", "(", "),", "pk", ")", ";", "}", "else", "{", "throw", "new", "SystemException", "(", "e", ".", "getMessage", "(", "))", ";", "}", "}", "}", "private", "void", "store_pubkey", "(", "File", "dbPath", ",", "String", "serverName", ",", "String", "pk", ")", "{", "ArrayList", "<", "String", ">", "lines", "=", "new", "ArrayList", "<", "String", ">", "()", ";", "File", "vncDir", "=", "new", "File", "(", "FileUtils", ".", "getVncHomeDir", "(", "))", ";", "try", "{", "if", "(", "dbPath", ".", "exists", "(", "))", "{", "FileReader", "db", "=", "new", "FileReader", "(", "dbPath", ")", ";", "BufferedReader", "dbBuf", "=", "new", "BufferedReader", "(", "db", ")", ";", "String", "line", ";", "while", "(", "(", "line", "=", "dbBuf", ".", "readLine", "(", "))", "!=", "null", ")", "{", "String", "fields", "[", "]", "=", "line", ".", "split", "(", "\"\\", "\\|", "\")", ";", "if", "(", "fields", ".", "length", "=", "=", "6", ")", "if", "(", "!", "serverName", ".", "equals", "(", "fields", "[", "2", "]", ")", "&", "&", "!", "pk", ".", "equals", "(", "fields", "[", "5", "]", "))", "lines", ".", "add", "(", "line", ")", ";", "}", "dbBuf", ".", "close", "(", ");", "}", "}", "catch", "(", "IOException", "e", ")", "{", "throw", "new", "AuthFailureException", "(", "\"", "Could", "not", "load", "known", "hosts", "database", "\"", ");", "}", "try", "{", "if", "(", "!", "dbPath", ".", "exists", "(", "))", "dbPath", ".", "createNewFile", "(", ");", "FileWriter", "fw", "=", "new", "FileWriter", "(", "dbPath", ".", "getAbsolutePath", "(", "),", "false", ")", ";", "Iterator", "i", "=", "lines", ".", "iterator", "(", ");", "while", "(", "i", ".", "hasNext", "(", "))", "fw", ".", "write", "(", "(", "String", ")", "i", ".", "next", "(", ")+", "\"\\", "n", "\"", ");", "fw", ".", "write", "(", "\"|", "g0", "|", "\"+", "serverName", "+", "\"|", "*|", "0", "|", "\"+", "pk", "+", "\"\\", "n", "\"", ");", "fw", ".", "close", "(", ");", "}", "catch", "(", "IOException", "e", ")", "{", "vlog", ".", "error", "(", "\"", "Failed", "to", "store", "server", "certificate", "to", "known", "hosts", "database", "\"", ");", "}", "}", "public", "X509Certificate", "[", "]", "getAcceptedIssuers", "(", ")", "{", "return", "tm", ".", "getAcceptedIssuers", "(", ");", "@", "@", "-", "399", ",", "12", "+", "436", ",", "13", "@", "@", "private", "void", "verifyHostname", "(", "X509Certificate", "cert", ")", "}", "Object", "[", "]", "answer", "=", "{", "\"", "YES", "\"", ",", "\"", "NO", "\"", "};", "int", "ret", "=", "JOptionPane", ".", "showOptionDialog", "(", "null", ",", "\"", "Hostname", "verification", "failed", ".", "Do", "you", "want", "to", "continue", "?", "\",", "\"", "Hostname", "Verification", "Failure", "\"", ",", "\"", "Hostname", "(", "\"+", "client", ".", "getServerName", "(", ")+", "\")", "does", "not", "match", "the", "\"", "\"", "server", "certificate", ",", "do", "you", "want", "to", "continue", "?", "\",", "\"", "Certificate", "hostname", "mismatch", "\"", ",", "JOptionPane", ".", "YES_NO_OPTION", ",", "JOptionPane", ".", "WARNING_MESSAGE", ",", "null", ",", "answer", ",", "answer", "[", "0", "]", ");", "if", "(", "ret", "!", "=", "JOptionPane", ".", "YES_OPTION", ")", "throw", "new", "WarningException", "(", "\"", "Hostname", "verification", "failed", ".", "\")", ";", "throw", "new", "WarningException", "(", "\"", "Certificate", "hostname", "mismatch", ".", "\")", ";", "}", "catch", "(", "CertificateParsingException", "e", ")", "{", "throw", "new", "SystemException", "(", "e", ".", "getMessage", "(", "))", ";", "}", "catch", "(", "InvalidNameException", "e", ")", "{"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "15", ",", "33", "+", "15", ",", "34", "@", "@", "*", "/", "package", "com", ".", "squareup", ".", "okhttp", ".", "internal", ".", "tls", ";", "import", "com", ".", "squareup", ".", "okhttp", ".", "internal", ".", "HeldCertificate", ";", "import", "java", ".", "security", ".", "cert", ".", "Certificate", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "List", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLPeerUnverifiedException", ";", "import", "com", ".", "squareup", ".", "okhttp", ".", "internal", ".", "HeldCertificate", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "fail", ";", "public", "final", "class", "CertificateAuthorityCouncilTest", "{", "public", "final", "class", "CertificateChainCleanerTest", "{", "@", "Test", "public", "void", "normalizeSingleSelfSignedCertificate", "(", ")", "throws", "Exception", "{", "HeldCertificate", "root", "=", "new", "HeldCertificate", ".", "Builder", "(", ")", ".", "serialNumber", "(", "\"", "1", "\"", ")", ".", "build", "(", ");", "CertificateAuthorityCouncil", "council", "=", "new", "CertificateAuthorityCouncil", "(", "root", ".", "certificate", ")", ";", "assertEquals", "(", "list", "(", "root", ")", ",", "council", ".", "normalizeCertificateChain", "(", "list", "(", "root", ")", "))", ";", "CertificateChainCleaner", "council", "=", "new", "CertificateChainCleaner", "(", "new", "RealTrustRootIndex", "(", "root", ".", "certificate", ")", ");", "assertEquals", "(", "list", "(", "root", ")", ",", "council", ".", "clean", "(", "list", "(", "root", ")", "))", ";", "}", "@", "Test", "public", "void", "normalizeUnknownSelfSignedCertificate", "(", ")", "throws", "Exception", "{", "HeldCertificate", "root", "=", "new", "HeldCertificate", ".", "Builder", "(", ")", ".", "serialNumber", "(", "\"", "1", "\"", ")", ".", "build", "(", ");", "CertificateAuthorityCouncil", "council", "=", "new", "CertificateAuthorityCouncil", "(", ");", "CertificateChainCleaner", "council", "=", "new", "CertificateChainCleaner", "(", "new", "RealTrustRootIndex", "(", "))", ";", "try", "{", "council", ".", "normalizeCertificateChain", "(", "list", "(", "root", ")", ");", "council", ".", "clean", "(", "list", "(", "root", ")", ");", "fail", "(", ");", "}", "catch", "(", "SSLPeerUnverifiedException", "expected", ")", "{", "}", "@", "@", "-", "60", ",", "9", "+", "61", ",", "9", "@", "@", ".", "issuedBy", "(", "certA", ")", ".", "build", "(", ");", "CertificateAuthorityCouncil", "council", "=", "new", "CertificateAuthorityCouncil", "(", "root", ".", "certificate", ")", ";", "assertEquals", "(", "list", "(", "certB", ",", "certA", ",", "root", ")", ",", "council", ".", "normalizeCertificateChain", "(", "list", "(", "certB", ",", "certA", ",", "root", ")", "))", ";", "CertificateChainCleaner", "council", "=", "new", "CertificateChainCleaner", "(", "new", "RealTrustRootIndex", "(", "root", ".", "certificate", ")", ");", "assertEquals", "(", "list", "(", "certB", ",", "certA", ",", "root", ")", ",", "council", ".", "clean", "(", "list", "(", "certB", ",", "certA", ",", "root", ")", "))", ";", "}", "@", "Test", "public", "void", "orderedChainOfCertificatesWithoutRoot", "(", ")", "throws", "Exception", "{", "@", "@", "-", "78", ",", "9", "+", "79", ",", "9", "@", "@", ".", "issuedBy", "(", "certA", ")", ".", "build", "(", ");", "CertificateAuthorityCouncil", "council", "=", "new", "CertificateAuthorityCouncil", "(", "root", ".", "certificate", ")", ";", "assertEquals", "(", "list", "(", "certB", ",", "certA", ",", "root", ")", ",", "council", ".", "normalizeCertificateChain", "(", "list", "(", "certB", ",", "certA", ")", "))", ";", "/", "/", "Root", "is", "added", "!", "CertificateChainCleaner", "council", "=", "new", "CertificateChainCleaner", "(", "new", "RealTrustRootIndex", "(", "root", ".", "certificate", ")", ");", "assertEquals", "(", "list", "(", "certB", ",", "certA", ",", "root", ")", ",", "council", ".", "clean", "(", "list", "(", "certB", ",", "certA", ")", "))", ";", "/", "/", "Root", "is", "added", "!", "}", "@", "Test", "public", "void", "unorderedChainOfCertificatesWithRoot", "(", ")", "throws", "Exception", "{", "@", "@", "-", "100", ",", "9", "+", "101", ",", "9", "@", "@", ".", "issuedBy", "(", "certB", ")", ".", "build", "(", ");", "CertificateAuthorityCouncil", "council", "=", "new", "CertificateAuthorityCouncil", "(", "root", ".", "certificate", ")", ";", "assertEquals", "(", "list", "(", "certC", ",", "certB", ",", "certA", ",", "root", ")", ",", "council", ".", "normalizeCertificateChain", "(", "list", "(", "certC", ",", "certA", ",", "root", ",", "certB", ")", "))", ";", "CertificateChainCleaner", "council", "=", "new", "CertificateChainCleaner", "(", "new", "RealTrustRootIndex", "(", "root", ".", "certificate", ")", ");", "assertEquals", "(", "list", "(", "certC", ",", "certB", ",", "certA", ",", "root", ")", ",", "council", ".", "clean", "(", "list", "(", "certC", ",", "certA", ",", "root", ",", "certB", ")", "))", ";", "}", "@", "Test", "public", "void", "unorderedChainOfCertificatesWithoutRoot", "(", ")", "throws", "Exception", "{", "@", "@", "-", "122", ",", "9", "+", "123", ",", "9", "@", "@", ".", "issuedBy", "(", "certB", ")", ".", "build", "(", ");", "CertificateAuthorityCouncil", "council", "=", "new", "CertificateAuthorityCouncil", "(", "root", ".", "certificate", ")", ";", "assertEquals", "(", "list", "(", "certC", ",", "certB", ",", "certA", ",", "root", ")", ",", "council", ".", "normalizeCertificateChain", "(", "list", "(", "certC", ",", "certA", ",", "certB", ")", "))", ";", "CertificateChainCleaner", "council", "=", "new", "CertificateChainCleaner", "(", "new", "RealTrustRootIndex", "(", "root", ".", "certificate", ")", ");", "assertEquals", "(", "list", "(", "certC", ",", "certB", ",", "certA", ",", "root", ")", ",", "council", ".", "clean", "(", "list", "(", "certC", ",", "certA", ",", "certB", ")", "))", ";", "}", "@", "Test", "public", "void", "unrelatedCertificatesAreOmitted", "(", ")", "throws", "Exception", "{", "@", "@", "-", "143", ",", "9", "+", "144", ",", "10", "@", "@", ".", "serialNumber", "(", "\"", "4", "\"", ")", ".", "build", "(", ");", "CertificateAuthorityCouncil", "council", "=", "new", "CertificateAuthorityCouncil", "(", "root", ".", "certificate", ")", ";", "CertificateChainCleaner", "council", "=", "new", "CertificateChainCleaner", "(", "new", "RealTrustRootIndex", "(", "root", ".", "certificate", ")", ");", "assertEquals", "(", "list", "(", "certB", ",", "certA", ",", "root", ")", ",", "council", ".", "normalizeCertificateChain", "(", "list", "(", "certB", ",", "certUnnecessary", ",", "certA", ",", "root", ")", "))", ";", "council", ".", "clean", "(", "list", "(", "certB", ",", "certUnnecessary", ",", "certA", ",", "root", ")", "))", ";", "}", "@", "Test", "public", "void", "unnecessaryTrustedCertificatesAreOmitted", "(", ")", "throws", "Exception", "{", "@", "@", "-", "165", ",", "10", "+", "167", ",", "9", "@", "@", ".", "issuedBy", "(", "certA", ")", ".", "build", "(", ");", "CertificateAuthorityCouncil", "council", "=", "new", "CertificateAuthorityCouncil", "(", "superRoot", ".", "certificate", ",", "root", ".", "certificate", ")", ";", "assertEquals", "(", "list", "(", "certB", ",", "certA", ",", "root", ")", ",", "council", ".", "normalizeCertificateChain", "(", "list", "(", "certB", ",", "certA", ",", "root", ",", "superRoot", ")", "))", ";", "CertificateChainCleaner", "council", "=", "new", "CertificateChainCleaner", "(", "new", "RealTrustRootIndex", "(", "superRoot", ".", "certificate", ",", "root", ".", "certificate", ")", ");", "assertEquals", "(", "list", "(", "certB", ",", "certA", ",", "root", ")", ",", "council", ".", "clean", "(", "list", "(", "certB", ",", "certA", ",", "root", ",", "superRoot", ")", "))", ";", "}", "private", "List", "<", "Certificate", ">", "list", "(", "HeldCertificate", ".", "..", "heldCertificates", ")", "{", "@", "@", "-", "135", ",", "7", "+", "135", ",", "7", "@", "@", "private", "final", "Map", "<", "String", ",", "Set", "<", "ByteString", ">", ">", "hostnameToPins", ";", "private", "CertificatePinner", "(", "Builder", "builder", ")", "{", "hostnameToPins", "=", "Util", ".", "immutableMap", "(", "builder", ".", "hostnameToPins", ")", ";", "this", ".", "hostnameToPins", "=", "Util", ".", "immutableMap", "(", "builder", ".", "hostnameToPins", ")", ";", "}", "/", "**", "@", "@", "-", "18", ",", "6", "+", "18", ",", "9", "@", "@", "import", "android", ".", "util", ".", "Log", ";", "import", "com", ".", "squareup", ".", "okhttp", ".", "Protocol", ";", "import", "com", ".", "squareup", ".", "okhttp", ".", "internal", ".", "tls", ".", "AndroidTrustRootIndex", ";", "import", "com", ".", "squareup", ".", "okhttp", ".", "internal", ".", "tls", ".", "RealTrustRootIndex", ";", "import", "com", ".", "squareup", ".", "okhttp", ".", "internal", ".", "tls", ".", "TrustRootIndex", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Field", ";", "import", "java", ".", "lang", ".", "reflect", ".", "InvocationHandler", ";", "@", "@", "-", "86", ",", "6", "+", "89", ",", "10", "@", "@", "public", "X509TrustManager", "trustManager", "(", "SSLSocketFactory", "sslSocketFactory", ")", "{", "return", "null", ";", "}", "public", "TrustRootIndex", "trustRootIndex", "(", "X509TrustManager", "trustManager", ")", "{", "return", "new", "RealTrustRootIndex", "(", "trustManager", ".", "getAcceptedIssuers", "(", "))", ";", "}", "/", "**", "*", "Configure", "TLS", "extensions", "on", "{", "@", "code", "sslSocket", "}", "for", "{", "@", "code", "route", "}", ".", "*", "@", "@", "-", "235", ",", "7", "+", "242", ",", "18", "@", "@", "public", "Android", "(", "Class", "<", "?>", "sslParametersClass", ",", "OptionalMethod", "<", "Socket", ">", "setUseSession", "@", "Override", "public", "X509TrustManager", "trustManager", "(", "SSLSocketFactory", "sslSocketFactory", ")", "{", "Object", "context", "=", "readFieldOrNull", "(", "sslSocketFactory", ",", "sslParametersClass", ",", "\"", "sslParameters", "\"", ");", "if", "(", "context", "=", "=", "null", ")", "return", "null", ";", "if", "(", "context", "=", "=", "null", ")", "{", "/", "/", "If", "that", "didn", "'", "t", "work", ",", "try", "the", "Google", "Play", "Services", "SSL", "provider", "before", "giving", "up", ".", "This", "/", "/", "must", "be", "loaded", "by", "the", "SSLSocketFactory", "'", "s", "class", "loader", ".", "try", "{", "Class", "<", "?>", "gmsSslParametersClass", "=", "Class", ".", "forName", "(", "\"", "com", ".", "google", ".", "android", ".", "gms", ".", "org", ".", "conscrypt", ".", "SSLParametersImpl", "\"", ",", "false", ",", "sslSocketFactory", ".", "getClass", "(", ").", "getClassLoader", "(", "))", ";", "context", "=", "readFieldOrNull", "(", "sslSocketFactory", ",", "gmsSslParametersClass", ",", "\"", "sslParameters", "\"", ");", "}", "catch", "(", "ClassNotFoundException", "e", ")", "{", "return", "null", ";", "}", "}", "X509TrustManager", "x509TrustManager", "=", "readFieldOrNull", "(", "context", ",", "X509TrustManager", ".", "class", ",", "\"", "x509TrustManager", "\"", ");", "@", "@", "-", "244", ",", "6", "+", "262", ",", "12", "@", "@", "public", "Android", "(", "Class", "<", "?>", "sslParametersClass", ",", "OptionalMethod", "<", "Socket", ">", "setUseSession", "return", "readFieldOrNull", "(", "context", ",", "X509TrustManager", ".", "class", ",", "\"", "trustManager", "\"", ");", "}", "@", "Override", "public", "TrustRootIndex", "trustRootIndex", "(", "X509TrustManager", "trustManager", ")", "{", "TrustRootIndex", "result", "=", "AndroidTrustRootIndex", ".", "get", "(", "trustManager", ")", ";", "if", "(", "result", "!", "=", "null", ")", "return", "result", ";", "return", "super", ".", "trustRootIndex", "(", "trustManager", ")", ";", "}", "@", "Override", "public", "void", "configureTlsExtensions", "(", "SSLSocket", "sslSocket", ",", "String", "hostname", ",", "List", "<", "Protocol", ">", "protocols", ")", "{", "/", "/", "Enable", "SNI", "and", "session", "tickets", ".", "@", "@", "-", "35", ",", "8", "+", "35", ",", "9", "@", "@", "import", "com", ".", "squareup", ".", "okhttp", ".", "internal", ".", "http", ".", "OkHeaders", ";", "import", "com", ".", "squareup", ".", "okhttp", ".", "internal", ".", "http", ".", "RouteException", ";", "import", "com", ".", "squareup", ".", "okhttp", ".", "internal", ".", "http", ".", "StreamAllocation", ";", "import", "com", ".", "squareup", ".", "okhttp", ".", "internal", ".", "tls", ".", "CertificateAuthorityCouncil", ";", "import", "com", ".", "squareup", ".", "okhttp", ".", "internal", ".", "tls", ".", "CertificateChainCleaner", ";", "import", "com", ".", "squareup", ".", "okhttp", ".", "internal", ".", "tls", ".", "OkHostnameVerifier", ";", "import", "com", ".", "squareup", ".", "okhttp", ".", "internal", ".", "tls", ".", "TrustRootIndex", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "lang", ".", "ref", ".", "Reference", ";", "import", "java", ".", "net", ".", "ConnectException", ";", "@", "@", "-", "202", ",", "8", "+", "203", ",", "9", "@", "@", "private", "void", "connectTls", "(", "int", "readTimeout", ",", "int", "writeTimeout", ",", "/", "/", "Check", "that", "the", "certificate", "pinner", "is", "satisfied", "by", "the", "certificates", "presented", ".", "if", "(", "address", ".", "getCertificatePinner", "(", ")", "!", "=", "CertificatePinner", ".", "DEFAULT", ")", "{", "List", "<", "Certificate", ">", "certificates", "=", "certificateAuthorityCouncil", "(", "address", ".", "getSslSocketFactory", "(", "))", ".", "normalizeCertificateChain", "(", "unverifiedHandshake", ".", "peerCertificates", "(", "))", ";", "TrustRootIndex", "trustRootIndex", "=", "trustRootIndex", "(", "address", ".", "getSslSocketFactory", "(", "))", ";", "List", "<", "Certificate", ">", "certificates", "=", "new", "CertificateChainCleaner", "(", "trustRootIndex", ")", ".", "clean", "(", "unverifiedHandshake", ".", "peerCertificates", "(", "))", ";", "address", ".", "getCertificatePinner", "(", ").", "check", "(", "address", ".", "getUriHost", "(", "),", "certificates", ")", ";", "}", "@", "@", "-", "233", ",", "22", "+", "235", ",", "20", "@", "@", "private", "void", "connectTls", "(", "int", "readTimeout", ",", "int", "writeTimeout", ",", "}", "private", "static", "SSLSocketFactory", "lastSslSocketFactory", ";", "private", "static", "CertificateAuthorityCouncil", "lastCertificateAuthorityCouncil", ";", "private", "static", "TrustRootIndex", "lastTrustRootIndex", ";", "/", "**", "*", "Returns", "a", "certificate", "authority", "council", "for", "{", "@", "code", "sslSocketFactory", "}", ".", "This", "uses", "a", "static", ",", "*", "single", "-", "element", "cache", "to", "avoid", "redoing", "reflection", "and", "SSL", "indexing", "in", "the", "common", "case", "where", "most", "*", "SSL", "connections", "use", "the", "same", "SSL", "socket", "factory", ".", "*", "Returns", "a", "trust", "root", "index", "for", "{", "@", "code", "sslSocketFactory", "}", ".", "This", "uses", "a", "static", ",", "single", "-", "element", "*", "cache", "to", "avoid", "redoing", "reflection", "and", "SSL", "indexing", "in", "the", "common", "case", "where", "most", "SSL", "*", "connections", "use", "the", "same", "SSL", "socket", "factory", ".", "*", "/", "private", "static", "synchronized", "CertificateAuthorityCouncil", "certificateAuthorityCouncil", "(", "SSLSocketFactory", "sslSocketFactory", ")", "{", "private", "static", "synchronized", "TrustRootIndex", "trustRootIndex", "(", "SSLSocketFactory", "sslSocketFactory", ")", "{", "if", "(", "sslSocketFactory", "!", "=", "lastSslSocketFactory", ")", "{", "X509TrustManager", "trustManager", "=", "Platform", ".", "get", "(", ").", "trustManager", "(", "sslSocketFactory", ")", ";", "lastCertificateAuthorityCouncil", "=", "new", "CertificateAuthorityCouncil", "(", "trustManager", ".", "getAcceptedIssuers", "(", "))", ";", "lastTrustRootIndex", "=", "Platform", ".", "get", "(", ").", "trustRootIndex", "(", "trustManager", ")", ";", "lastSslSocketFactory", "=", "sslSocketFactory", ";", "}", "return", "lastCertificateAuthorityCouncil", ";", "return", "lastTrustRootIndex", ";", "}", "/", "**", "@", "@", "-", "0", ",", "0", "+", "1", ",", "63", "@", "@", "/", "*", "*", "Copyright", "(", "C", ")", "2016", "Square", ",", "Inc", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "com", ".", "squareup", ".", "okhttp", ".", "internal", ".", "tls", ";", "import", "java", ".", "lang", ".", "reflect", ".", "InvocationTargetException", ";", "import", "java", ".", "lang", ".", "reflect", ".", "Method", ";", "import", "java", ".", "security", ".", "cert", ".", "TrustAnchor", ";", "import", "java", ".", "security", ".", "cert", ".", "X509Certificate", ";", "import", "javax", ".", "net", ".", "ssl", ".", "X509TrustManager", ";", "/", "**", "*", "A", "index", "of", "trusted", "root", "certificates", "that", "exploits", "knowledge", "of", "Android", "implementation", "details", ".", "*", "This", "class", "is", "potentially", "much", "faster", "to", "initialize", "than", "{", "@", "link", "RealTrustRootIndex", "}", "because", "*", "it", "doesn", "'", "t", "need", "to", "load", "and", "index", "trusted", "CA", "certificates", ".", "*", "/", "public", "final", "class", "AndroidTrustRootIndex", "implements", "TrustRootIndex", "{", "private", "final", "X509TrustManager", "trustManager", ";", "private", "final", "Method", "findByIssuerAndSignatureMethod", ";", "public", "AndroidTrustRootIndex", "(", "X509TrustManager", "trustManager", ",", "Method", "findByIssuerAndSignatureMethod", ")", "{", "this", ".", "findByIssuerAndSignatureMethod", "=", "findByIssuerAndSignatureMethod", ";", "this", ".", "trustManager", "=", "trustManager", ";", "}", "@", "Override", "public", "X509Certificate", "findByIssuerAndSignature", "(", "X509Certificate", "cert", ")", "{", "try", "{", "TrustAnchor", "trustAnchor", "=", "(", "TrustAnchor", ")", "findByIssuerAndSignatureMethod", ".", "invoke", "(", "trustManager", ",", "cert", ")", ";", "return", "trustAnchor", ".", "getTrustedCert", "(", ");", "}", "catch", "(", "IllegalAccessException", "e", ")", "{", "throw", "new", "AssertionError", "(", ");", "}", "catch", "(", "InvocationTargetException", "e", ")", "{", "return", "null", ";", "}", "}", "public", "static", "TrustRootIndex", "get", "(", "X509TrustManager", "trustManager", ")", "{", "/", "/", "From", "org", ".", "conscrypt", ".", "TrustManagerImpl", ",", "we", "want", "the", "method", "with", "this", "signature", ":", "/", "/", "private", "TrustAnchor", "findTrustAnchorByIssuerAndSignature", "(", "X509Certificate", "lastCert", ")", ";", "try", "{", "Method", "method", "=", "trustManager", ".", "getClass", "(", ").", "getDeclaredMethod", "(", "\"", "findTrustAnchorByIssuerAndSignature", "\"", ",", "X509Certificate", ".", "class", ")", ";", "method", ".", "setAccessible", "(", "true", ")", ";", "return", "new", "AndroidTrustRootIndex", "(", "trustManager", ",", "method", ")", ";", "}", "catch", "(", "NoSuchMethodException", "e", ")", "{", "return", "null", ";", "}", "}", "}", "@", "@", "-", "17", ",", "56", "+", "17", ",", "43", "@", "@", "package", "com", ".", "squareup", ".", "okhttp", ".", "internal", ".", "tls", ";", "import", "java", ".", "security", ".", "GeneralSecurityException", ";", "import", "java", ".", "security", ".", "PublicKey", ";", "import", "java", ".", "security", ".", "cert", ".", "Certificate", ";", "import", "java", ".", "security", ".", "cert", ".", "X509Certificate", ";", "import", "java", ".", "util", ".", "ArrayDeque", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Deque", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "LinkedHashMap", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLPeerUnverifiedException", ";", "import", "javax", ".", "security", ".", "auth", ".", "x500", ".", "X500Principal", ";", "/", "**", "*", "A", "set", "of", "trusted", "Certificate", "Authority", "(", "CA", ")", "certificates", "that", "are", "trusted", "to", "verify", "the", "TLS", "*", "certificates", "offered", "by", "remote", "web", "servers", ".", "*", "Computes", "the", "effective", "certificate", "chain", "from", "the", "raw", "array", "returned", "by", "Java", "'", "s", "built", "in", "TLS", "APIs", ".", "*", "Cleaning", "a", "chain", "returns", "a", "list", "of", "certificates", "where", "the", "first", "element", "is", "{", "@", "code", "chain", "[", "0", "]", "},", "each", "*", "certificate", "is", "signed", "by", "the", "certificate", "that", "follows", ",", "and", "the", "last", "certificate", "is", "a", "trusted", "CA", "*", "certificate", ".", "*", "*", "<", "p", ">", "Use", "of", "the", "chain", "cleaner", "is", "necessary", "to", "omit", "unexpected", "certificates", "that", "aren", "'", "t", "relevant", "to", "*", "the", "TLS", "handshake", "and", "to", "extract", "the", "trusted", "CA", "certificate", "for", "the", "benefit", "of", "certificate", "*", "pinning", ".", "*", "*", "<", "p", ">", "This", "class", "includes", "code", "from", "<", "a", "href", "=", "\"", "https", ":", "//", "conscrypt", ".", "org", "/", "\">", "Conscrypt", "'", "s", "<", "/", "a", ">", "{", "@", "code", "*", "TrustManagerImpl", "}", "and", "{", "@", "code", "TrustedCertificateIndex", "}", ".", "*", "/", "public", "final", "class", "CertificateAuthorityCouncil", "{", "private", "final", "Map", "<", "X500Principal", ",", "List", "<", "X509Certificate", ">", ">", "subjectToCaCerts", "=", "new", "LinkedHashMap", "<", ">(", ");", "public", "final", "class", "CertificateChainCleaner", "{", "private", "final", "TrustRootIndex", "trustRootIndex", ";", "public", "CertificateAuthorityCouncil", "(", "X509Certificate", ".", "..", "caCerts", ")", "{", "for", "(", "X509Certificate", "caCert", ":", "caCerts", ")", "{", "X500Principal", "subject", "=", "caCert", ".", "getSubjectX500Principal", "(", ");", "List", "<", "X509Certificate", ">", "subjectCaCerts", "=", "subjectToCaCerts", ".", "get", "(", "subject", ")", ";", "if", "(", "subjectCaCerts", "=", "=", "null", ")", "{", "subjectCaCerts", "=", "new", "ArrayList", "<", ">(", "1", ")", ";", "subjectToCaCerts", ".", "put", "(", "subject", ",", "subjectCaCerts", ")", ";", "}", "subjectCaCerts", ".", "add", "(", "caCert", ")", ";", "}", "public", "CertificateChainCleaner", "(", "TrustRootIndex", "trustRootIndex", ")", "{", "this", ".", "trustRootIndex", "=", "trustRootIndex", ";", "}", "/", "**", "*", "Computes", "the", "effective", "certificate", "chain", "from", "the", "raw", "array", "returned", "by", "Java", "'", "s", "built", "in", "TLS", "*", "APIs", ".", "This", "method", "returns", "a", "list", "of", "certificates", "where", "the", "first", "element", "is", "{", "@", "code", "chain", "[", "0", "]", "},", "*", "each", "certificate", "is", "signed", "by", "the", "certificate", "that", "follows", ",", "and", "the", "last", "certificate", "is", "a", "*", "trusted", "CA", "certificate", ".", "*", "*", "<", "p", ">", "Use", "of", "this", "method", "is", "necessary", "to", "omit", "unexpected", "certificates", "that", "aren", "'", "t", "relevant", "to", "the", "*", "TLS", "handshake", "and", "to", "extract", "the", "trusted", "CA", "certificate", "for", "the", "benefit", "of", "certificate", "pinning", ".", "*", "Returns", "a", "cleaned", "chain", "for", "{", "@", "code", "chain", "}", ".", "*", "*", "<", "p", ">", "This", "method", "throws", "if", "the", "complete", "chain", "to", "a", "trusted", "CA", "certificate", "cannot", "be", "constructed", ".", "*", "This", "is", "unexpected", "unless", "the", "X509", "trust", "manager", "in", "this", "class", "is", "different", "from", "the", "trust", "*", "manager", "that", "was", "used", "to", "establish", "{", "@", "code", "chain", "}", ".", "*", "This", "is", "unexpected", "unless", "the", "trust", "root", "index", "in", "this", "class", "has", "a", "different", "trust", "manager", "than", "*", "what", "was", "used", "to", "establish", "{", "@", "code", "chain", "}", ".", "*", "/", "public", "List", "<", "Certificate", ">", "normalizeCertificateChain", "(", "List", "<", "Certificate", ">", "chain", ")", "throws", "SSLPeerUnverifiedException", "{", "public", "List", "<", "Certificate", ">", "clean", "(", "List", "<", "Certificate", ">", "chain", ")", "throws", "SSLPeerUnverifiedException", "{", "Deque", "<", "Certificate", ">", "queue", "=", "new", "ArrayDeque", "<", ">(", "chain", ")", ";", "List", "<", "Certificate", ">", "result", "=", "new", "ArrayList", "<", ">(", ");", "result", ".", "add", "(", "queue", ".", "removeFirst", "(", "))", ";", "@", "@", "-", "78", ",", "8", "+", "65", ",", "8", "@", "@", "public", "CertificateAuthorityCouncil", "(", "X509Certificate", ".", "..", "caCerts", ")", "{", "/", "/", "If", "this", "cert", "has", "been", "signed", "by", "a", "trusted", "CA", "cert", ",", "we", "'", "re", "done", ".", "Add", "the", "trusted", "CA", "/", "/", "certificate", "to", "the", "end", "of", "the", "chain", ",", "unless", "it", "'", "s", "already", "present", ".", "(", "That", "would", "happen", "if", "the", "/", "/", "first", "certificate", "in", "the", "chain", "is", "itself", "a", "self", "-", "signed", "and", "trusted", "CA", "certificate", ".", ")", "X509Certificate", "caCert", "=", "findByIssuerAndSignature", "(", "toVerify", ")", ";", "if", "(", "caCert", "!", "=", "null", "&", "&", "verifySignature", "(", "toVerify", ",", "caCert", ")", ")", "{", "X509Certificate", "caCert", "=", "trustRootIndex", ".", "findByIssuerAndSignature", "(", "toVerify", ")", ";", "if", "(", "caCert", "!", "=", "null", ")", "{", "if", "(", "result", ".", "size", "(", ")", ">", "1", "|", "|", "!", "toVerify", ".", "equals", "(", "caCert", ")", ")", "{", "result", ".", "add", "(", "caCert", ")", ";", "}", "@", "@", "-", "111", ",", "22", "+", "98", ",", "4", "@", "@", "private", "boolean", "verifySignature", "(", "X509Certificate", "toVerify", ",", "X509Certificate", "signin", "return", "false", ";", "}", "}", "/", "**", "Returns", "the", "trusted", "CA", "certificate", "that", "signed", "{", "@", "code", "cert", "}", ".", "*", "/", "private", "X509Certificate", "findByIssuerAndSignature", "(", "X509Certificate", "cert", ")", "{", "X500Principal", "issuer", "=", "cert", ".", "getIssuerX500Principal", "(", ");", "List", "<", "X509Certificate", ">", "subjectCaCerts", "=", "subjectToCaCerts", ".", "get", "(", "issuer", ")", ";", "if", "(", "subjectCaCerts", "=", "=", "null", ")", "return", "null", ";", "for", "(", "X509Certificate", "caCert", ":", "subjectCaCerts", ")", "{", "PublicKey", "publicKey", "=", "caCert", ".", "getPublicKey", "(", ");", "try", "{", "cert", ".", "verify", "(", "publicKey", ")", ";", "return", "caCert", ";", "}", "catch", "(", "Exception", "ignored", ")", "{", "}", "}", "return", "null", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "58", "@", "@", "/", "*", "*", "Copyright", "(", "C", ")", "2016", "Square", ",", "Inc", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "com", ".", "squareup", ".", "okhttp", ".", "internal", ".", "tls", ";", "import", "java", ".", "security", ".", "PublicKey", ";", "import", "java", ".", "security", ".", "cert", ".", "X509Certificate", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "LinkedHashMap", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "javax", ".", "security", ".", "auth", ".", "x500", ".", "X500Principal", ";", "public", "final", "class", "RealTrustRootIndex", "implements", "TrustRootIndex", "{", "private", "final", "Map", "<", "X500Principal", ",", "List", "<", "X509Certificate", ">", ">", "subjectToCaCerts", ";", "public", "RealTrustRootIndex", "(", "X509Certificate", ".", "..", "caCerts", ")", "{", "subjectToCaCerts", "=", "new", "LinkedHashMap", "<", ">(", ");", "for", "(", "X509Certificate", "caCert", ":", "caCerts", ")", "{", "X500Principal", "subject", "=", "caCert", ".", "getSubjectX500Principal", "(", ");", "List", "<", "X509Certificate", ">", "subjectCaCerts", "=", "subjectToCaCerts", ".", "get", "(", "subject", ")", ";", "if", "(", "subjectCaCerts", "=", "=", "null", ")", "{", "subjectCaCerts", "=", "new", "ArrayList", "<", ">(", "1", ")", ";", "subjectToCaCerts", ".", "put", "(", "subject", ",", "subjectCaCerts", ")", ";", "}", "subjectCaCerts", ".", "add", "(", "caCert", ")", ";", "}", "}", "@", "Override", "public", "X509Certificate", "findByIssuerAndSignature", "(", "X509Certificate", "cert", ")", "{", "X500Principal", "issuer", "=", "cert", ".", "getIssuerX500Principal", "(", ");", "List", "<", "X509Certificate", ">", "subjectCaCerts", "=", "subjectToCaCerts", ".", "get", "(", "issuer", ")", ";", "if", "(", "subjectCaCerts", "=", "=", "null", ")", "return", "null", ";", "for", "(", "X509Certificate", "caCert", ":", "subjectCaCerts", ")", "{", "PublicKey", "publicKey", "=", "caCert", ".", "getPublicKey", "(", ");", "try", "{", "cert", ".", "verify", "(", "publicKey", ")", ";", "return", "caCert", ";", "}", "catch", "(", "Exception", "ignored", ")", "{", "}", "}", "return", "null", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "23", "@", "@", "/", "*", "*", "Copyright", "(", "C", ")", "2016", "Square", ",", "Inc", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "com", ".", "squareup", ".", "okhttp", ".", "internal", ".", "tls", ";", "import", "java", ".", "security", ".", "cert", ".", "X509Certificate", ";", "public", "interface", "TrustRootIndex", "{", "/", "**", "Returns", "the", "trusted", "CA", "certificate", "that", "signed", "{", "@", "code", "cert", "}", ".", "*", "/", "X509Certificate", "findByIssuerAndSignature", "(", "X509Certificate", "cert", ")", ";", "}"], "docstring_tokens": ["by", "sending", "a", "certificate", "chain", "with", "a", "certificate", "from", "a", "non-pinned", "trusted", "CA", "and", "the", "pinned", "certificate", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "3422", ",", "6", "+", "3422", ",", "12", "@", "@", "sctp_disposition_t", "sctp_sf_ootb", "(", "struct", "net", "*", "net", ",", "return", "sctp_sf_violation_chunklen", "(", "net", ",", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "/", "*", "Report", "violation", "if", "chunk", "len", "overflows", "*", "/", "ch_end", "=", "(", "(", "__u8", "*", ")", "ch", ")", "+", "SCTP_PAD4", "(", "ntohs", "(", "ch", "-", ">", "length", ")", ");", "if", "(", "ch_end", ">", "skb_tail_pointer", "(", "skb", ")", ")", "return", "sctp_sf_violation_chunklen", "(", "net", ",", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "/", "*", "Now", "that", "we", "know", "we", "at", "least", "have", "a", "chunk", "header", ",", "*", "do", "things", "that", "are", "type", "appropriate", ".", "*", "/", "@", "@", "-", "3453", ",", "12", "+", "3459", ",", "6", "@", "@", "sctp_disposition_t", "sctp_sf_ootb", "(", "struct", "net", "*", "net", ",", "}", "}", "/", "*", "Report", "violation", "if", "chunk", "len", "overflows", "*", "/", "ch_end", "=", "(", "(", "__u8", "*", ")", "ch", ")", "+", "SCTP_PAD4", "(", "ntohs", "(", "ch", "-", ">", "length", ")", ");", "if", "(", "ch_end", ">", "skb_tail_pointer", "(", "skb", ")", ")", "return", "sctp_sf_violation_chunklen", "(", "net", ",", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "commands", ")", ";", "ch", "=", "(", "sctp_chunkhdr_t", "*", ")", "ch_end", ";", "}", "while", "(", "ch_end", "<", "skb_tail_pointer", "(", "skb", ")", ");"], "docstring_tokens": ["sending", "specially", "crafted", "data"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "580", ",", "6", "+", "580", ",", "12", "@", "@", "static", "Image", "*", "ReadTXTImage", "(", "const", "ImageInfo", "*", "image_info", ",", "ExceptionInfo", "*", "exception", ")", "break", ";", "}", "}", "if", "(", "EOFBlob", "(", "image", ")", "!", "=", "MagickFalse", ")", "{", "ThrowFileException", "(", "exception", ",", "CorruptImageError", ",", "\"", "UnexpectedEndOfFile", "\"", ",", "image", "-", ">", "filename", ")", ";", "break", ";", "}", "(", "void", ")", "ReadBlobString", "(", "image", ",", "text", ")", ";", "if", "(", "LocaleNCompare", "(", "(", "char", "*", ")", "text", ",", "MagickID", ",", "strlen", "(", "MagickID", ")", ")", "=", "=", "0", ")", "{"], "docstring_tokens": ["because", "the", "end-of-file", "condition", "is", "not", "considered", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "437", ",", "6", "+", "437", ",", "12", "@", "@", "static", "int", "handle_eac3", "(", "MOVMuxContext", "*", "mov", ",", "AVPacket", "*", "pkt", ",", "MOVTrack", "*", "track", ")", "info", "-", ">", "ec3_done", "=", "1", ";", "goto", "concatenate", ";", "}", "}", "else", "{", "if", "(", "hdr", "-", ">", "substreamid", "!", "=", "0", ")", "{", "avpriv_request_sample", "(", "mov", "-", ">", "fc", ",", "\"", "Multiple", "non", "EAC3", "independent", "substreams", "\"", ");", "ret", "=", "AVERROR_PATCHWELCOME", ";", "goto", "end", ";", "}", "}", "/", "*", "fill", "the", "info", "needed", "for", "the", "\"", "dec3", "\"", "atom", "*", "/"], "docstring_tokens": ["persuading", "a", "victim", "to", "open", "a", "specially-crafted", "file"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "215", ",", "7", "+", "215", ",", "7", "@", "@", "ZEND_API", "void", "zend_objects_store_del_ref_by_handle_ex", "(", "zend_object_handle", "handle", ",", "}", "zend_end_try", "(", ");", "}", "}", "/", "*", "re", "-", "read", "the", "object", "from", "the", "object", "store", "as", "the", "store", "might", "have", "been", "reallocated", "in", "the", "dtor", "*", "/", "obj", "=", "&", "EG", "(", "objects_store", ")", ".", "object_buckets", "[", "handle", "]", ".", "bucket", ".", "obj", ";", "@", "@", "-", "306", ",", "8", "+", "306", ",", "8", "@", "@", "ZEND_API", "void", "zend_object_store_ctor_failed", "(", "zval", "*", "zobject", "TSRMLS_DC", ")", "{", "zend_object_handle", "handle", "=", "Z_OBJ_HANDLE_P", "(", "zobject", ")", ";", "zend_object_store_bucket", "*", "obj_bucket", "=", "&", "EG", "(", "objects_store", ")", ".", "object_buckets", "[", "handle", "]", ";", "obj_bucket", "-", ">", "bucket", ".", "obj", ".", "handlers", "=", "Z_OBJ_HT_P", "(", "zobject", ")", ";;", "obj_bucket", "-", ">", "bucket", ".", "obj", ".", "handlers", "=", "Z_OBJ_HT_P", "(", "zobject", ")", ";", "obj_bucket", "-", ">", "destructor_called", "=", "1", ";", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "18", "@", "@", "-", "-", "TEST", "-", "-", "Bug", "#", "73052", ":", "Memory", "Corruption", "in", "During", "Deserialized", "-", "object", "Destruction", "-", "-", "FILE", "-", "-", "<", "?", "php", "class", "obj", "{", "var", "$", "ryat", ";", "public", "function", "__destruct", "(", ")", "{", "$", "this", "-", ">", "ryat", "=", "null", ";", "}", "}", "$", "poc", "=", "'", "O", ":", "3", ":", "\"", "obj", "\"", ":", "1", ":", "{'", ";", "var_dump", "(", "unserialize", "(", "$", "poc", ")", ");", "?", ">", "-", "-", "EXPECTF", "-", "-", "Notice", ":", "unserialize", "(", "):", "Error", "at", "offset", "13", "of", "13", "bytes", "in", "%", "sbug73052", ".", "php", "on", "line", "%", "d", "bool", "(", "false", ")", "@", "@", "-", "437", ",", "6", "+", "437", ",", "7", "@", "@", "static", "inline", "int", "object_common2", "(", "UNSERIALIZE_PARAMETER", ",", "long", "elements", ")", "/", "*", "We", "'", "ve", "got", "partially", "constructed", "object", "on", "our", "hands", "here", ".", "Wipe", "it", ".", "*", "/", "if", "(", "Z_TYPE_PP", "(", "rval", ")", "=", "=", "IS_OBJECT", ")", "{", "zend_hash_clean", "(", "Z_OBJPROP_PP", "(", "rval", ")", ");", "zend_object_store_ctor_failed", "(", "*", "rval", "TSRMLS_CC", ")", ";", "}", "ZVAL_NULL", "(", "*", "rval", ")", ";", "return", "0", ";", "@", "@", "-", "491", ",", "7", "+", "492", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "#", "line", "495", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "#", "line", "496", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "{", "YYCTYPE", "yych", ";", "static", "const", "unsigned", "char", "yybm", "[", "]", "=", "{", "@", "@", "-", "551", ",", "9", "+", "552", ",", "9", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "yych", "=", "*", "(", "YYMARKER", "=", "+", "+", "YYCURSOR", ")", ";", "if", "(", "yych", "=", "=", "'", ":'", ")", "goto", "yy95", ";", "yy3", ":", "#", "line", "860", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "#", "line", "861", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "{", "return", "0", ";", "}", "#", "line", "557", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "#", "line", "558", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "yy4", ":", "yych", "=", "*", "(", "YYMARKER", "=", "+", "+", "YYCURSOR", ")", ";", "if", "(", "yych", "=", "=", "'", ":'", ")", "goto", "yy89", ";", "@", "@", "-", "596", ",", "13", "+", "597", ",", "13", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "goto", "yy3", ";", "yy14", ":", "+", "+", "YYCURSOR", ";", "#", "line", "854", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "#", "line", "855", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "{", "/", "*", "this", "is", "the", "case", "where", "we", "have", "less", "data", "than", "planned", "*", "/", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_NOTICE", ",", "\"", "Unexpected", "end", "of", "serialized", "data", "\"", ");", "return", "0", ";", "/", "*", "not", "sure", "if", "it", "should", "be", "0", "or", "1", "here", "?", "*", "/", "}", "#", "line", "606", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "#", "line", "607", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "yy16", ":", "yych", "=", "*", "++", "YYCURSOR", ";", "goto", "yy3", ";", "@", "@", "-", "633", ",", "7", "+", "634", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "yych", "=", "*", "++", "YYCURSOR", ";", "if", "(", "yych", "!", "=", "'", "\"'", ")", "goto", "yy18", ";", "+", "+", "YYCURSOR", ";", "#", "line", "707", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "#", "line", "708", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "{", "size_t", "len", ",", "len2", ",", "len3", ",", "maxlen", ";", "long", "elements", ";", "@", "@", "-", "780", ",", "7", "+", "781", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "return", "object_common2", "(", "UNSERIALIZE_PASSTHRU", ",", "elements", ")", ";", "}", "#", "line", "784", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "#", "line", "785", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "yy25", ":", "yych", "=", "*", "++", "YYCURSOR", ";", "if", "(", "yych", "<", "=", "'", ",'", ")", "{", "@", "@", "-", "805", ",", "7", "+", "806", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "yych", "=", "*", "++", "YYCURSOR", ";", "if", "(", "yych", "!", "=", "'", "\"'", ")", "goto", "yy18", ";", "+", "+", "YYCURSOR", ";", "#", "line", "698", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "#", "line", "699", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "{", "if", "(", "!", "var_hash", ")", "return", "0", ";", "@", "@", "-", "814", ",", "7", "+", "815", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "return", "object_common2", "(", "UNSERIALIZE_PASSTHRU", ",", "object_common1", "(", "UNSERIALIZE_PASSTHRU", ",", "ZEND_STANDARD_CLASS_DEF_PTR", ")", ");", "}", "#", "line", "818", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "#", "line", "819", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "yy32", ":", "yych", "=", "*", "++", "YYCURSOR", ";", "if", "(", "yych", "=", "=", "'", "+'", ")", "goto", "yy33", ";", "@", "@", "-", "835", ",", "7", "+", "836", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "yych", "=", "*", "++", "YYCURSOR", ";", "if", "(", "yych", "!", "=", "'", "{'", ")", "goto", "yy18", ";", "+", "+", "YYCURSOR", ";", "#", "line", "677", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "#", "line", "678", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "{", "long", "elements", "=", "parse_iv", "(", "start", "+", "2", ")", ";", "/", "*", "use", "iv", "(", ")", "not", "uiv", "(", ")", "in", "order", "to", "check", "data", "range", "*", "/", "@", "@", "-", "856", ",", "7", "+", "857", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "return", "finish_nested_data", "(", "UNSERIALIZE_PASSTHRU", ")", ";", "}", "#", "line", "860", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "#", "line", "861", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "yy39", ":", "yych", "=", "*", "++", "YYCURSOR", ";", "if", "(", "yych", "=", "=", "'", "+'", ")", "goto", "yy40", ";", "@", "@", "-", "877", ",", "7", "+", "878", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "yych", "=", "*", "++", "YYCURSOR", ";", "if", "(", "yych", "!", "=", "'", "\"'", ")", "goto", "yy18", ";", "+", "+", "YYCURSOR", ";", "#", "line", "642", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "#", "line", "643", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "{", "size_t", "len", ",", "maxlen", ";", "char", "*", "str", ";", "@", "@", "-", "912", ",", "7", "+", "913", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "ZVAL_STRINGL", "(", "*", "rval", ",", "str", ",", "len", ",", "0", ")", ";", "return", "1", ";", "}", "#", "line", "916", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "#", "line", "917", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "yy46", ":", "yych", "=", "*", "++", "YYCURSOR", ";", "if", "(", "yych", "=", "=", "'", "+'", ")", "goto", "yy47", ";", "@", "@", "-", "933", ",", "7", "+", "934", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "yych", "=", "*", "++", "YYCURSOR", ";", "if", "(", "yych", "!", "=", "'", "\"'", ")", "goto", "yy18", ";", "+", "+", "YYCURSOR", ";", "#", "line", "609", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "#", "line", "610", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "{", "size_t", "len", ",", "maxlen", ";", "char", "*", "str", ";", "@", "@", "-", "966", ",", "7", "+", "967", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "ZVAL_STRINGL", "(", "*", "rval", ",", "str", ",", "len", ",", "1", ")", ";", "return", "1", ";", "}", "#", "line", "970", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "#", "line", "971", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "yy53", ":", "yych", "=", "*", "++", "YYCURSOR", ";", "if", "(", "yych", "<", "=", "'", "/'", ")", "{", "@", "@", "-", "1054", ",", "7", "+", "1055", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "}", "yy63", ":", "+", "+", "YYCURSOR", ";", "#", "line", "599", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "#", "line", "600", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "{", "#", "if", "SIZEOF_LONG", "=", "=", "4", "use_double", ":", "@", "@", "-", "1064", ",", "7", "+", "1065", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "ZVAL_DOUBLE", "(", "*", "rval", ",", "zend_strtod", "(", "(", "const", "char", "*", ")", "start", "+", "2", ",", "NULL", ")", ");", "return", "1", ";", "}", "#", "line", "1068", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "#", "line", "1069", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "yy65", ":", "yych", "=", "*", "++", "YYCURSOR", ";", "if", "(", "yych", "<", "=", "'", ",'", ")", "{", "@", "@", "-", "1123", ",", "7", "+", "1124", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "yych", "=", "*", "++", "YYCURSOR", ";", "if", "(", "yych", "!", "=", "'", ";'", ")", "goto", "yy18", ";", "+", "+", "YYCURSOR", ";", "#", "line", "584", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "#", "line", "585", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "{", "*", "p", "=", "YYCURSOR", ";", "INIT_PZVAL", "(", "*", "rval", ")", ";", "@", "@", "-", "1138", ",", "7", "+", "1139", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "return", "1", ";", "}", "#", "line", "1142", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "#", "line", "1143", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "yy76", ":", "yych", "=", "*", "++", "YYCURSOR", ";", "if", "(", "yych", "=", "=", "'", "N", "'", ")", "goto", "yy73", ";", "@", "@", "-", "1165", ",", "7", "+", "1166", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "if", "(", "yych", "<", "=", "'", "9", "'", ")", "goto", "yy79", ";", "if", "(", "yych", "!", "=", "'", ";'", ")", "goto", "yy18", ";", "+", "+", "YYCURSOR", ";", "#", "line", "557", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "#", "line", "558", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "{", "#", "if", "SIZEOF_LONG", "=", "=", "4", "int", "digits", "=", "YYCURSOR", "-", "start", "-", "3", ";", "@", "@", "-", "1192", ",", "32", "+", "1193", ",", "32", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "ZVAL_LONG", "(", "*", "rval", ",", "parse_iv", "(", "start", "+", "2", ")", ");", "return", "1", ";", "}", "#", "line", "1196", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "#", "line", "1197", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "yy83", ":", "yych", "=", "*", "++", "YYCURSOR", ";", "if", "(", "yych", "<", "=", "'", "/'", ")", "goto", "yy18", ";", "if", "(", "yych", ">", "=", "'", "2", "'", ")", "goto", "yy18", ";", "yych", "=", "*", "++", "YYCURSOR", ";", "if", "(", "yych", "!", "=", "'", ";'", ")", "goto", "yy18", ";", "+", "+", "YYCURSOR", ";", "#", "line", "550", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "#", "line", "551", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "{", "*", "p", "=", "YYCURSOR", ";", "INIT_PZVAL", "(", "*", "rval", ")", ";", "ZVAL_BOOL", "(", "*", "rval", ",", "parse_iv", "(", "start", "+", "2", ")", ");", "return", "1", ";", "}", "#", "line", "1211", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "#", "line", "1212", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "yy87", ":", "+", "+", "YYCURSOR", ";", "#", "line", "543", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "#", "line", "544", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "{", "*", "p", "=", "YYCURSOR", ";", "INIT_PZVAL", "(", "*", "rval", ")", ";", "ZVAL_NULL", "(", "*", "rval", ")", ";", "return", "1", ";", "}", "#", "line", "1221", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "#", "line", "1222", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "yy89", ":", "yych", "=", "*", "++", "YYCURSOR", ";", "if", "(", "yych", "<", "=", "'", ",'", ")", "{", "@", "@", "-", "1240", ",", "7", "+", "1241", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "if", "(", "yych", "<", "=", "'", "9", "'", ")", "goto", "yy91", ";", "if", "(", "yych", "!", "=", "'", ";'", ")", "goto", "yy18", ";", "+", "+", "YYCURSOR", ";", "#", "line", "520", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "#", "line", "521", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "{", "long", "id", ";", "@", "@", "-", "1263", ",", "7", "+", "1264", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "return", "1", ";", "}", "#", "line", "1267", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "#", "line", "1268", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "yy95", ":", "yych", "=", "*", "++", "YYCURSOR", ";", "if", "(", "yych", "<", "=", "'", ",'", ")", "{", "@", "@", "-", "1286", ",", "7", "+", "1287", ",", "7", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "if", "(", "yych", "<", "=", "'", "9", "'", ")", "goto", "yy97", ";", "if", "(", "yych", "!", "=", "'", ";'", ")", "goto", "yy18", ";", "+", "+", "YYCURSOR", ";", "#", "line", "499", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "#", "line", "500", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "{", "long", "id", ";", "@", "@", "-", "1307", ",", "9", "+", "1308", ",", "9", "@", "@", "PHPAPI", "int", "php_var_unserialize", "(", "UNSERIALIZE_PARAMETER", ")", "return", "1", ";", "}", "#", "line", "1311", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "#", "line", "1312", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "c", "\"", "}", "#", "line", "862", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "#", "line", "863", "\"", "ext", "/", "standard", "/", "var_unserializer", ".", "re", "\"", "return", "0", ";", "@", "@", "-", "441", ",", "6", "+", "441", ",", "7", "@", "@", "static", "inline", "int", "object_common2", "(", "UNSERIALIZE_PARAMETER", ",", "long", "elements", ")", "/", "*", "We", "'", "ve", "got", "partially", "constructed", "object", "on", "our", "hands", "here", ".", "Wipe", "it", ".", "*", "/", "if", "(", "Z_TYPE_PP", "(", "rval", ")", "=", "=", "IS_OBJECT", ")", "{", "zend_hash_clean", "(", "Z_OBJPROP_PP", "(", "rval", ")", ");", "zend_object_store_ctor_failed", "(", "*", "rval", "TSRMLS_CC", ")", ";", "}", "ZVAL_NULL", "(", "*", "rval", ")", ";", "return", "0", ";"], "docstring_tokens": ["via", "an", "unserialize", "call", "that", "references", "a", "partially", "constructed", "object", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "19", ",", "8", "+", "19", ",", "8", "@", "@", "*", "under", "normal", "circumstances", ",", "used", "to", "verify", "that", "nobody", "uses", "*", "non", "-", "initialized", "list", "entries", ".", "*", "/", "#", "define", "LIST_POISON1", "(", "(", "void", "*", ")", "0x00100100", "+", "POISON_POINTER_DELTA", ")", "#", "define", "LIST_POISON2", "(", "(", "void", "*", ")", "0x00200200", "+", "POISON_POINTER_DELTA", ")", "#", "define", "LIST_POISON1", "(", "(", "void", "*", ")", "0x100", "+", "POISON_POINTER_DELTA", ")", "#", "define", "LIST_POISON2", "(", "(", "void", "*", ")", "0x200", "+", "POISON_POINTER_DELTA", ")", "/", "**", "**", "**", "**", "**", "include", "/", "linux", "/", "timer", ".", "h", "*", "**", "**", "**", "**", "*/", "/", "*"], "docstring_tokens": ["by", "triggering", "the", "use", "of", "an", "uninitialized", "list", "entry"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "71", ",", "6", "+", "71", ",", "7", "@", "@", "wsFrame", ".", "noContinuation", "=", "A", "new", "message", "was", "started", "when", "a", "continuation", "frame", "was", "e", "wsFrame", ".", "notMasked", "=", "The", "client", "frame", "was", "not", "masked", "but", "all", "client", "frames", "must", "be", "masked", "wsFrame", ".", "oneByteCloseCode", "=", "The", "client", "sent", "a", "close", "frame", "with", "a", "single", "byte", "payload", "which", "is", "not", "valid", "wsFrame", ".", "partialHeaderComplete", "=", "WebSocket", "frame", "received", ".", "fin", "[", "{", "0", "}", "],", "rsv", "[", "{", "1", "}", "],", "OpCode", "[", "{", "2", "}", "],", "payload", "length", "[", "{", "3", "}", "]", "wsFrame", ".", "payloadMsbInvalid", "=", "An", "invalid", "WebSocket", "frame", "was", "received", "-", "the", "most", "significant", "bit", "of", "a", "64", "-", "bit", "payload", "was", "illegally", "set", "wsFrame", ".", "sessionClosed", "=", "The", "client", "data", "cannot", "be", "processed", "because", "the", "session", "has", "already", "been", "closed", "wsFrame", ".", "suspendRequested", "=", "Suspend", "of", "the", "message", "receiving", "has", "already", "been", "requested", ".", "wsFrame", ".", "textMessageTooBig", "=", "The", "decoded", "text", "message", "was", "too", "big", "for", "the", "output", "buffer", "and", "the", "endpoint", "does", "not", "support", "partial", "messages", "@", "@", "-", "261", ",", "6", "+", "261", ",", "13", "@", "@", "private", "boolean", "processRemainingHeader", "(", ")", "throws", "IOException", "{", "}", "else", "if", "(", "payloadLength", "=", "=", "127", ")", "{", "payloadLength", "=", "byteArrayToLong", "(", "inputBuffer", ".", "array", "(", "),", "inputBuffer", ".", "arrayOffset", "(", ")", "+", "inputBuffer", ".", "position", "(", "),", "8", ")", ";", "/", "/", "The", "most", "significant", "bit", "of", "those", "8", "bytes", "is", "required", "to", "be", "zero", "/", "/", "(", "see", "RFC", "6455", ",", "section", "5", ".", "2", ")", ".", "If", "the", "most", "significant", "bit", "is", "set", ",", "/", "/", "the", "resulting", "payload", "length", "will", "be", "negative", "so", "test", "for", "that", ".", "if", "(", "payloadLength", "<", "0", ")", "{", "throw", "new", "WsIOException", "(", "new", "CloseReason", "(", "CloseCodes", ".", "PROTOCOL_ERROR", ",", "sm", ".", "getString", "(", "\"", "wsFrame", ".", "payloadMsbInvalid", "\"", "))", ");", "}", "inputBuffer", ".", "position", "(", "inputBuffer", ".", "position", "(", ")", "+", "8", ")", ";", "}", "if", "(", "Util", ".", "isControl", "(", "opCode", ")", ")", "{", "@", "@", "-", "123", ",", "6", "+", "123", ",", "14", "@", "@", "<", "/", "fix", ">", "<", "/", "changelog", ">", "<", "/", "subsection", ">", "<", "subsection", "name", "=", "\"", "WebSocket", "\"", ">", "<", "changelog", ">", "<", "fix", ">", "<", "bug", ">", "64563", "<", "/", "bug", ">", ":", "Add", "additional", "validation", "of", "payload", "length", "for", "WebSocket", "messages", ".", "(", "markt", ")", "<", "/", "fix", ">", "<", "/", "changelog", ">", "<", "/", "subsection", ">", "<", "subsection", "name", "=", "\"", "Other", "\"", ">", "<", "changelog", ">", "<", "fix", ">"], "docstring_tokens": ["sending", "multiple", "requests", "with", "invalid", "payload", "lengths"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "110", ",", "6", "+", "110", ",", "7", "@", "@", "long", "dgnc_mgmt_ioctl", "(", "struct", "file", "*", "file", ",", "unsigned", "int", "cmd", ",", "unsigned", "long", "arg", ")", "spin_lock_irqsave", "(", "&", "dgnc_global_lock", ",", "flags", ")", ";", "memset", "(", "&", "ddi", ",", "0", ",", "sizeof", "(", "ddi", ")", ");", "ddi", ".", "dinfo_nboards", "=", "dgnc_NumBoards", ";", "sprintf", "(", "ddi", ".", "dinfo_version", ",", "\"", "%", "s", "\"", ",", "DG_PART", ")", ";"], "docstring_tokens": ["via", "a", "crafted", "application", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "150", ",", "15", "+", "150", ",", "19", "@", "@", "static", "PixelChannels", "*", "*", "DestroyPixelThreadSet", "(", "PixelChannels", "*", "*", "pixels", ")", "return", "(", "pixels", ")", ";", "}", "static", "PixelChannels", "*", "*", "AcquirePixelThreadSet", "(", "const", "Image", "*", "image", ")", "static", "PixelChannels", "*", "*", "AcquirePixelThreadSet", "(", "const", "Image", "*", "images", ")", "{", "const", "Image", "*", "next", ";", "PixelChannels", "*", "*", "pixels", ";", "register", "ssize_t", "i", ";", "size_t", "columns", ",", "number_threads", ";", "number_threads", "=", "(", "size_t", ")", "GetMagickResourceLimit", "(", "ThreadResource", ")", ";", "@", "@", "-", "167", ",", "16", "+", "171", ",", "18", "@", "@", "static", "PixelChannels", "*", "*", "AcquirePixelThreadSet", "(", "const", "Image", "*", "image", ")", "if", "(", "pixels", "=", "=", "(", "PixelChannels", "*", "*)", "NULL", ")", "return", "(", "(", "PixelChannels", "*", "*)", "NULL", ")", ";", "(", "void", ")", "memset", "(", "pixels", ",", "0", ",", "number_threads", "*", "sizeof", "(", "*", "pixels", ")", ");", "columns", "=", "images", "-", ">", "columns", ";", "for", "(", "next", "=", "images", ";", "next", "!", "=", "(", "Image", "*", ")", "NULL", ";", "next", "=", "next", "-", ">", "next", ")", "columns", "=", "MagickMax", "(", "next", "-", ">", "columns", ",", "columns", ")", ";", "for", "(", "i", "=", "0", ";", "i", "<", "(", "ssize_t", ")", "number_threads", ";", "i", "+", "+)", "{", "register", "ssize_t", "j", ";", "pixels", "[", "i", "]", "=(", "PixelChannels", "*", ")", "AcquireQuantumMemory", "(", "image", "-", ">", "columns", ",", "sizeof", "(", "**", "pixels", ")", ");", "pixels", "[", "i", "]", "=(", "PixelChannels", "*", ")", "AcquireQuantumMemory", "(", "columns", ",", "sizeof", "(", "**", "pixels", ")", ");", "if", "(", "pixels", "[", "i", "]", "=", "=", "(", "PixelChannels", "*", ")", "NULL", ")", "return", "(", "DestroyPixelThreadSet", "(", "pixels", ")", ");", "for", "(", "j", "=", "0", ";", "j", "<", "(", "ssize_t", ")", "image", "-", ">", "columns", ";", "j", "+", "+)", "for", "(", "j", "=", "0", ";", "j", "<", "(", "ssize_t", ")", "columns", ";", "j", "+", "+)", "{", "register", "ssize_t", "k", ";"], "docstring_tokens": ["sending", "a", "specially", "crafted", "command"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "284", ",", "6", "+", "284", ",", "7", "@", "@", "static", "int", "dcbnl_getperm_hwaddr", "(", "struct", "net_device", "*", "netdev", ",", "struct", "nlmsghdr", "*", "nlh", ",", "if", "(", "!", "netdev", "-", ">", "dcbnl_ops", "-", ">", "getpermhwaddr", ")", "return", "-", "EOPNOTSUPP", ";", "memset", "(", "perm_addr", ",", "0", ",", "sizeof", "(", "perm_addr", ")", ");", "netdev", "-", ">", "dcbnl_ops", "-", ">", "getpermhwaddr", "(", "netdev", ",", "perm_addr", ")", ";", "return", "nla_put", "(", "skb", ",", "DCB_ATTR_PERM_HWADDR", ",", "sizeof", "(", "perm_addr", ")", ",", "perm_addr", ")", ";", "@", "@", "-", "1042", ",", "6", "+", "1043", ",", "7", "@", "@", "static", "int", "dcbnl_ieee_fill", "(", "struct", "sk_buff", "*", "skb", ",", "struct", "net_device", "*", "netdev", ")", "if", "(", "ops", "-", ">", "ieee_getets", ")", "{", "struct", "ieee_ets", "ets", ";", "memset", "(", "&", "ets", ",", "0", ",", "sizeof", "(", "ets", ")", ");", "err", "=", "ops", "-", ">", "ieee_getets", "(", "netdev", ",", "&", "ets", ")", ";", "if", "(", "!", "err", "&", "&", "nla_put", "(", "skb", ",", "DCB_ATTR_IEEE_ETS", ",", "sizeof", "(", "ets", ")", ",", "&", "ets", ")", ")", "@", "@", "-", "1050", ",", "6", "+", "1052", ",", "7", "@", "@", "static", "int", "dcbnl_ieee_fill", "(", "struct", "sk_buff", "*", "skb", ",", "struct", "net_device", "*", "netdev", ")", "if", "(", "ops", "-", ">", "ieee_getmaxrate", ")", "{", "struct", "ieee_maxrate", "maxrate", ";", "memset", "(", "&", "maxrate", ",", "0", ",", "sizeof", "(", "maxrate", ")", ");", "err", "=", "ops", "-", ">", "ieee_getmaxrate", "(", "netdev", ",", "&", "maxrate", ")", ";", "if", "(", "!", "err", ")", "{", "err", "=", "nla_put", "(", "skb", ",", "DCB_ATTR_IEEE_MAXRATE", ",", "@", "@", "-", "1061", ",", "6", "+", "1064", ",", "7", "@", "@", "static", "int", "dcbnl_ieee_fill", "(", "struct", "sk_buff", "*", "skb", ",", "struct", "net_device", "*", "netdev", ")", "if", "(", "ops", "-", ">", "ieee_getpfc", ")", "{", "struct", "ieee_pfc", "pfc", ";", "memset", "(", "&", "pfc", ",", "0", ",", "sizeof", "(", "pfc", ")", ");", "err", "=", "ops", "-", ">", "ieee_getpfc", "(", "netdev", ",", "&", "pfc", ")", ";", "if", "(", "!", "err", "&", "&", "nla_put", "(", "skb", ",", "DCB_ATTR_IEEE_PFC", ",", "sizeof", "(", "pfc", ")", ",", "&", "pfc", ")", ")", "@", "@", "-", "1094", ",", "6", "+", "1098", ",", "7", "@", "@", "static", "int", "dcbnl_ieee_fill", "(", "struct", "sk_buff", "*", "skb", ",", "struct", "net_device", "*", "netdev", ")", "/", "*", "get", "peer", "info", "if", "available", "*", "/", "if", "(", "ops", "-", ">", "ieee_peer_getets", ")", "{", "struct", "ieee_ets", "ets", ";", "memset", "(", "&", "ets", ",", "0", ",", "sizeof", "(", "ets", ")", ");", "err", "=", "ops", "-", ">", "ieee_peer_getets", "(", "netdev", ",", "&", "ets", ")", ";", "if", "(", "!", "err", "&", "&", "nla_put", "(", "skb", ",", "DCB_ATTR_IEEE_PEER_ETS", ",", "sizeof", "(", "ets", ")", ",", "&", "ets", ")", ")", "@", "@", "-", "1102", ",", "6", "+", "1107", ",", "7", "@", "@", "static", "int", "dcbnl_ieee_fill", "(", "struct", "sk_buff", "*", "skb", ",", "struct", "net_device", "*", "netdev", ")", "if", "(", "ops", "-", ">", "ieee_peer_getpfc", ")", "{", "struct", "ieee_pfc", "pfc", ";", "memset", "(", "&", "pfc", ",", "0", ",", "sizeof", "(", "pfc", ")", ");", "err", "=", "ops", "-", ">", "ieee_peer_getpfc", "(", "netdev", ",", "&", "pfc", ")", ";", "if", "(", "!", "err", "&", "&", "nla_put", "(", "skb", ",", "DCB_ATTR_IEEE_PEER_PFC", ",", "sizeof", "(", "pfc", ")", ",", "&", "pfc", ")", ")", "@", "@", "-", "1280", ",", "6", "+", "1286", ",", "7", "@", "@", "static", "int", "dcbnl_cee_fill", "(", "struct", "sk_buff", "*", "skb", ",", "struct", "net_device", "*", "netdev", ")", "/", "*", "peer", "info", "if", "available", "*", "/", "if", "(", "ops", "-", ">", "cee_peer_getpg", ")", "{", "struct", "cee_pg", "pg", ";", "memset", "(", "&", "pg", ",", "0", ",", "sizeof", "(", "pg", ")", ");", "err", "=", "ops", "-", ">", "cee_peer_getpg", "(", "netdev", ",", "&", "pg", ")", ";", "if", "(", "!", "err", "&", "&", "nla_put", "(", "skb", ",", "DCB_ATTR_CEE_PEER_PG", ",", "sizeof", "(", "pg", ")", ",", "&", "pg", ")", ")", "@", "@", "-", "1288", ",", "6", "+", "1295", ",", "7", "@", "@", "static", "int", "dcbnl_cee_fill", "(", "struct", "sk_buff", "*", "skb", ",", "struct", "net_device", "*", "netdev", ")", "if", "(", "ops", "-", ">", "cee_peer_getpfc", ")", "{", "struct", "cee_pfc", "pfc", ";", "memset", "(", "&", "pfc", ",", "0", ",", "sizeof", "(", "pfc", ")", ");", "err", "=", "ops", "-", ">", "cee_peer_getpfc", "(", "netdev", ",", "&", "pfc", ")", ";", "if", "(", "!", "err", "&", "&", "nla_put", "(", "skb", ",", "DCB_ATTR_CEE_PEER_PFC", ",", "sizeof", "(", "pfc", ")", ",", "&", "pfc", ")", ")"], "docstring_tokens": ["using", "a", "specially-crafted", "application"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "509", ",", "7", "+", "509", ",", "8", "@", "@", "static", "int", "nfs_lock", "(", "struct", "file", "*", "filp", ",", "int", "cmd", ",", "struct", "file_lock", "*", "fl", ")", "return", "-", "EINVAL", ";", "/", "*", "No", "mandatory", "locks", "over", "NFS", "*", "/", "if", "(", "(", "inode", "-", ">", "i_mode", "&", "(", "S_ISGID", "|", "S_IXGRP", ")", ")", "=", "=", "S_ISGID", ")", "if", "(", "(", "inode", "-", ">", "i_mode", "&", "(", "S_ISGID", "|", "S_IXGRP", ")", ")", "=", "=", "S_ISGID", "&", "&", "fl", "-", ">", "fl_type", "!", "=", "F_UNLCK", ")", "return", "-", "ENOLCK", ";", "if", "(", "IS_GETLK", "(", "cmd", ")", ")"], "docstring_tokens": ["locking", "a", "file", "on", "an", "NFS", "filesystem", "and", "modifying", "it's", "permissions"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "419", ",", "6", "+", "419", ",", "13", "@", "@", "thrift_protocol_read_binary", "(", "ThriftProtocol", "*", "protocol", ",", "gpointer", "*", "buf", ",", "len", ",", "error", ")", ";", "}", "#", "define", "THRIFT_SKIP_RESULT_OR_RETURN", "(", "_RES", ",", "_CALL", ")", "\\", "{", "\\", "gint32", "_x", "=", "(", "_CALL", ")", ";", "\\", "if", "(", "_x", "<", "0", ")", "{", "return", "_x", ";", "}", "\\", "(", "_RES", ")", "+", "=", "_x", ";", "\\", "}", "gint32", "thrift_protocol_skip", "(", "ThriftProtocol", "*", "protocol", ",", "ThriftType", "type", ",", "GError", "*", "*", "error", ")", "{", "@", "@", "-", "469", ",", "38", "+", "476", ",", "41", "@", "@", "thrift_protocol_skip", "(", "ThriftProtocol", "*", "protocol", ",", "ThriftType", "type", ",", "GError", "*", "*", "error", ")", "gchar", "*", "name", ";", "gint16", "fid", ";", "ThriftType", "ftype", ";", "result", "+", "=", "thrift_protocol_read_struct_begin", "(", "protocol", ",", "&", "name", ",", "error", ")", ";", "THRIFT_SKIP_RESULT_OR_RETURN", "(", "result", ",", "thrift_protocol_read_struct_begin", "(", "protocol", ",", "&", "name", ",", "error", ")", ")", "while", "(", "1", ")", "{", "result", "+", "=", "thrift_protocol_read_field_begin", "(", "protocol", ",", "&", "name", ",", "&", "ftype", ",", "&", "fid", ",", "error", ")", ";", "if", "(", "result", "<", "0", ")", "{", "return", "result", ";", "}", "THRIFT_SKIP_RESULT_OR_RETURN", "(", "result", ",", "thrift_protocol_read_field_begin", "(", "protocol", ",", "&", "name", ",", "&", "ftype", ",", "&", "fid", ",", "error", ")", ")", "if", "(", "ftype", "=", "=", "T_STOP", ")", "{", "break", ";", "}", "result", "+", "=", "thrift_protocol_skip", "(", "protocol", ",", "ftype", ",", "error", ")", ";", "result", "+", "=", "thrift_protocol_read_field_end", "(", "protocol", ",", "error", ")", ";", "THRIFT_SKIP_RESULT_OR_RETURN", "(", "result", ",", "thrift_protocol_skip", "(", "protocol", ",", "ftype", ",", "error", ")", ")", "THRIFT_SKIP_RESULT_OR_RETURN", "(", "result", ",", "thrift_protocol_read_field_end", "(", "protocol", ",", "error", ")", ")", "}", "result", "+", "=", "thrift_protocol_read_struct_end", "(", "protocol", ",", "error", ")", ";", "THRIFT_SKIP_RESULT_OR_RETURN", "(", "result", ",", "thrift_protocol_read_struct_end", "(", "protocol", ",", "error", ")", ")", "return", "result", ";", "}", "case", "T_SET", ":", "{", "gint32", "result", "=", "0", ";", "ThriftType", "elem_type", ";", "guint32", "i", ",", "size", ";", "result", "+", "=", "thrift_protocol_read_set_begin", "(", "protocol", ",", "&", "elem_type", ",", "&", "size", ",", "error", ")", ";", "THRIFT_SKIP_RESULT_OR_RETURN", "(", "result", ",", "thrift_protocol_read_set_begin", "(", "protocol", ",", "&", "elem_type", ",", "&", "size", ",", "error", ")", ")", "for", "(", "i", "=", "0", ";", "i", "<", "size", ";", "i", "+", "+)", "{", "result", "+", "=", "thrift_protocol_skip", "(", "protocol", ",", "elem_type", ",", "error", ")", ";", "THRIFT_SKIP_RESULT_OR_RETURN", "(", "result", ",", "thrift_protocol_skip", "(", "protocol", ",", "elem_type", ",", "error", ")", ")", "}", "result", "+", "=", "thrift_protocol_read_set_end", "(", "protocol", ",", "error", ")", ";", "THRIFT_SKIP_RESULT_OR_RETURN", "(", "result", ",", "thrift_protocol_read_set_end", "(", "protocol", ",", "error", ")", ")", "return", "result", ";", "}", "case", "T_MAP", ":", "@", "@", "-", "509", ",", "33", "+", "519", ",", "45", "@", "@", "thrift_protocol_skip", "(", "ThriftProtocol", "*", "protocol", ",", "ThriftType", "type", ",", "GError", "*", "*", "error", ")", "ThriftType", "elem_type", ";", "ThriftType", "key_type", ";", "guint32", "i", ",", "size", ";", "result", "+", "=", "thrift_protocol_read_map_begin", "(", "protocol", ",", "&", "key_type", ",", "&", "elem_type", ",", "&", "size", ",", "error", ")", ";", "THRIFT_SKIP_RESULT_OR_RETURN", "(", "result", ",", "thrift_protocol_read_map_begin", "(", "protocol", ",", "&", "key_type", ",", "&", "elem_type", ",", "&", "size", ",", "error", ")", ")", "for", "(", "i", "=", "0", ";", "i", "<", "size", ";", "i", "+", "+)", "{", "result", "+", "=", "thrift_protocol_skip", "(", "protocol", ",", "key_type", ",", "error", ")", ";", "result", "+", "=", "thrift_protocol_skip", "(", "protocol", ",", "elem_type", ",", "error", ")", ";", "THRIFT_SKIP_RESULT_OR_RETURN", "(", "result", ",", "thrift_protocol_skip", "(", "protocol", ",", "key_type", ",", "error", ")", ")", "THRIFT_SKIP_RESULT_OR_RETURN", "(", "result", ",", "thrift_protocol_skip", "(", "protocol", ",", "elem_type", ",", "error", ")", ")", "}", "result", "+", "=", "thrift_protocol_read_map_end", "(", "protocol", ",", "error", ")", ";", "THRIFT_SKIP_RESULT_OR_RETURN", "(", "result", ",", "thrift_protocol_read_map_end", "(", "protocol", ",", "error", ")", ")", "return", "result", ";", "}", "case", "T_LIST", ":", "{", "gint32", "result", "=", "0", ";", "ThriftType", "elem_type", ";", "guint32", "i", ",", "size", ";", "result", "+", "=", "thrift_protocol_read_list_begin", "(", "protocol", ",", "&", "elem_type", ",", "&", "size", ",", "error", ")", ";", "THRIFT_SKIP_RESULT_OR_RETURN", "(", "result", ",", "thrift_protocol_read_list_begin", "(", "protocol", ",", "&", "elem_type", ",", "&", "size", ",", "error", ")", ")", "for", "(", "i", "=", "0", ";", "i", "<", "size", ";", "i", "+", "+)", "{", "result", "+", "=", "thrift_protocol_skip", "(", "protocol", ",", "elem_type", ",", "error", ")", ";", "THRIFT_SKIP_RESULT_OR_RETURN", "(", "result", ",", "thrift_protocol_skip", "(", "protocol", ",", "elem_type", ",", "error", ")", ")", "}", "result", "+", "=", "thrift_protocol_read_list_end", "(", "protocol", ",", "error", ")", ";", "THRIFT_SKIP_RESULT_OR_RETURN", "(", "result", ",", "thrift_protocol_read_list_end", "(", "protocol", ",", "error", ")", ")", "return", "result", ";", "}", "default", ":", "return", "0", ";", "break", ";", "}", "g_set_error", "(", "error", ",", "THRIFT_PROTOCOL_ERROR", ",", "THRIFT_PROTOCOL_ERROR_INVALID_DATA", ",", "\"", "unrecognized", "type", "\"", ");", "return", "-", "1", ";", "}", "/", "*", "define", "the", "GError", "domain", "for", "Thrift", "protocols", "*", "/", "@", "@", "-", "747", ",", "16", "+", "747", ",", "12", "@", "@", "uint32_t", "skip", "(", "Protocol_", "&", "prot", ",", "TType", "type", ")", "{", "result", "+", "=", "prot", ".", "readListEnd", "(", ");", "return", "result", ";", "}", "case", "T_STOP", ":", "case", "T_VOID", ":", "case", "T_U64", ":", "case", "T_UTF8", ":", "case", "T_UTF16", ":", "break", ";", "default", ":", "throw", "TProtocolException", "(", "TProtocolException", ":", ":", "INVALID_DATA", ")", ";", "break", ";", "}", "return", "0", ";", "throw", "TProtocolException", "(", "TProtocolException", ":", ":", "INVALID_DATA", ",", "\"", "invalid", "TType", "\"", ");", "}", "}", "}}", "/", "/", "apache", ":", ":", "thrift", ":", ":", "protocol", "@", "@", "-", "260", ",", "7", "+", "260", ",", "7", "@", "@", "protected", ":", "*", "in", "generated", "code", ".", "*", "/", "void", "skip", "(", "Protocol", ")", "(", "Protocol", "prot", ",", "TType", "type", ")", "if", "(", "is", "(", "Protocol", ":", "TProtocol", ")", ")", "{", "final", "switch", "(", "type", ")", "{", "switch", "(", "type", ")", "{", "case", "TType", ".", "BOOL", ":", "prot", ".", "readBool", "(", ");", "break", ";", "@", "@", "-", "324", ",", "9", "+", "324", ",", "9", "@", "@", "void", "skip", "(", "Protocol", ")", "(", "Protocol", "prot", ",", "TType", "type", ")", "if", "(", "is", "(", "Protocol", ":", "TProtocol", ")", ")", "{", "}", "prot", ".", "readSetEnd", "(", ");", "break", ";", "case", "TType", ".", "STOP", ":", "goto", "case", ";", "case", "TType", ".", "VOID", ":", "assert", "(", "false", ",", "\"", "Invalid", "field", "type", "passed", ".", "\")", ";", "default", ":", "throw", "new", "TProtocolException", "(", "TProtocolException", ".", "Type", ".", "INVALID_DATA", ")", ";", "}", "}", "@", "@", "-", "101", ",", "7", "+", "101", ",", "7", "@", "@", "class", "TProtocolUtil", "{", "break", ";", "default", ":", "break", ";", "throw", "new", "TProtocolError", "(", "TProtocolErrorType", ".", "INVALID_DATA", ",", "\"", "Invalid", "data", "\"", ");", "}", "}", "}", "@", "@", "-", "96", ",", "8", "+", "96", ",", "6", "@", "@", "func", "Skip", "(", "self", "TProtocol", ",", "fieldType", "TType", ",", "maxDepth", "int", ")", "(", "err", "error", ")", "{", "}", "switch", "fieldType", "{", "case", "STOP", ":", "return", "case", "BOOL", ":", "_", ",", "err", "=", "self", ".", "ReadBool", "(", ")", "return", "@", "@", "-", "152", ",", "7", "+", "152", ",", "8", "@", "@", "public", "static", "void", "skip", "(", "TProtocol", "prot", ",", "byte", "type", ",", "int", "maxDepth", ")", "break", ";", "}", "default", ":", "break", ";", "throw", "new", "TProtocolException", "(", "TProtocolException", ".", "INVALID_DATA", ",", "\"", "Unrecognized", "type", "\"", "+", "type", ")", ";", "}", "}", "}", "@", "@", "-", "1376", ",", "9", "+", "1376", ",", "6", "@", "@", "Thrift", ".", "Protocol", ".", "prototype", "=", "{", "skip", ":", "function", "(", "type", ")", "{", "var", "ret", ",", "i", ";", "switch", "(", "type", ")", "{", "case", "Thrift", ".", "Type", ".", "STOP", ":", "return", "null", ";", "case", "Thrift", ".", "Type", ".", "BOOL", ":", "return", "this", ".", "readBool", "(", ");", "@", "@", "-", "107", ",", "9", "+", "107", ",", "7", "@", "@", "function", "TProtocolBase", ":", "readDouble", "(", ")", "end", "function", "TProtocolBase", ":", "readString", "(", ")", "end", "function", "TProtocolBase", ":", "skip", "(", "ttype", ")", "if", "type", "=", "=", "TType", ".", "STOP", "then", "return", "elseif", "ttype", "=", "=", "TType", ".", "BOOL", "then", "if", "ttype", "=", "=", "TType", ".", "BOOL", "then", "self", ":", "readBool", "(", ")", "elseif", "ttype", "=", "=", "TType", ".", "BYTE", "then", "self", ":", "readByte", "(", ")", "@", "@", "-", "153", ",", "6", "+", "151", ",", "10", "@", "@", "function", "TProtocolBase", ":", "skip", "(", "ttype", ")", "self", ":", "skip", "(", "ettype", ")", "end", "self", ":", "readListEnd", "(", ")", "else", "terror", "(", "TProtocolException", ":", "new", "{", "message", "=", "'", "Invalid", "data", "'", "}", ")", "end", "end", "@", "@", "-", "302", ",", "8", "+", "302", ",", "6", "@", "@", "TBinaryProtocol", ".", "prototype", ".", "getTransport", "=", "function", "(", ")", "{", "TBinaryProtocol", ".", "prototype", ".", "skip", "=", "function", "(", "type", ")", "{", "switch", "(", "type", ")", "{", "case", "Type", ".", "STOP", ":", "return", ";", "case", "Type", ".", "BOOL", ":", "this", ".", "readBool", "(", ");", "break", ";", "@", "@", "-", "854", ",", "8", "+", "854", ",", "6", "@", "@", "TCompactProtocol", ".", "prototype", ".", "zigzagToI64", "=", "function", "(", "n", ")", "{", "TCompactProtocol", ".", "prototype", ".", "skip", "=", "function", "(", "type", ")", "{", "switch", "(", "type", ")", "{", "case", "Type", ".", "STOP", ":", "return", ";", "case", "Type", ".", "BOOL", ":", "this", ".", "readBool", "(", ");", "break", ";", "@", "@", "-", "738", ",", "8", "+", "738", ",", "6", "@", "@", "TJSONProtocol", ".", "prototype", ".", "getTransport", "=", "function", "(", ")", "{", "*", "/", "TJSONProtocol", ".", "prototype", ".", "skip", "=", "function", "(", "type", ")", "{", "switch", "(", "type", ")", "{", "case", "Type", ".", "STOP", ":", "return", ";", "case", "Type", ".", "BOOL", ":", "this", ".", "readBool", "(", ");", "break", ";", "@", "@", "-", "206", ",", "8", "+", "206", ",", "6", "@", "@", "struct", "(", "*", "skippage", "*", ")", "method", "skip", "typ", "=", "match", "typ", "with", "|", "T_STOP", "-", ">", "(", ")", "|", "T_VOID", "-", ">", "(", ")", "|", "T_BOOL", "-", ">", "ignore", "self", "#", "readBool", "|", "T_BYTE", "|", "T_I08", "-", ">", "ignore", "self", "#", "readByte", "@", "@", "-", "248", ",", "6", "+", "246", ",", "7", "@", "@", "struct", "self", "#", "readListEnd", ")", "|", "T_UTF8", "-", ">", "(", ")", "|", "T_UTF16", "-", ">", "(", ")", "|", "_", "-", ">", "raise", "(", "Protocol", ".", "E", "(", "Protocol", ".", "INVALID_DATA", ",", "\"", "Invalid", "data", "\"", "))", "end", "class", "virtual", "factory", "=", "@", "@", "-", "191", ",", "9", "+", "191", ",", "7", "@", "@", "def", "readUtf8", "(", "self", ")", ":", "return", "self", ".", "readString", "(", ").", "decode", "(", "'", "utf8", "'", ")", "def", "skip", "(", "self", ",", "ttype", ")", ":", "if", "ttype", "=", "=", "TType", ".", "STOP", ":", "return", "elif", "ttype", "=", "=", "TType", ".", "BOOL", ":", "if", "ttype", "=", "=", "TType", ".", "BOOL", ":", "self", ".", "readBool", "(", ")", "elif", "ttype", "=", "=", "TType", ".", "BYTE", ":", "self", ".", "readByte", "(", ")", "@", "@", "-", "232", ",", "6", "+", "230", ",", "10", "@", "@", "def", "skip", "(", "self", ",", "ttype", ")", ":", "for", "i", "in", "range", "(", "size", ")", ":", "self", ".", "skip", "(", "etype", ")", "self", ".", "readListEnd", "(", ")", "else", ":", "raise", "TProtocolException", "(", "TProtocolException", ".", "INVALID_DATA", ",", "\"", "invalid", "TType", "\"", ")", "#", "tuple", "of", ":", "(", "'", "reader", "method", "'", "name", ",", "is_container", "bool", ",", "'", "writer_method", "'", "name", ")", "_TTYPE_HANDLERS", "=", "(", "@", "@", "-", "323", ",", "8", "+", "323", ",", "6", "@", "@", "def", "read_type", "(", "field_info", ")", "def", "skip", "(", "type", ")", "case", "type", "when", "Types", ":", ":", "STOP", "nil", "when", "Types", ":", ":", "BOOL", "read_bool", "when", "Types", ":", ":", "BYTE", "@", "@", "-", "367", ",", "6", "+", "365", ",", "8", "@", "@", "def", "skip", "(", "type", ")", "skip", "(", "etype", ")", "end", "read_list_end", "else", "raise", "ProtocolException", ".", "new", "(", "ProtocolException", ":", ":", "INVALID_DATA", ",", "'", "Invalid", "data", "'", ")", "end", "end", "@", "@", "-", "163", ",", "7", "+", "163", ",", "6", "@", "@", "@", "prot", ".", "skip", "(", "Thrift", ":", ":", "Types", ":", ":", "I64", ")", "@", "prot", ".", "skip", "(", "Thrift", ":", ":", "Types", ":", ":", "DOUBLE", ")", "@", "prot", ".", "skip", "(", "Thrift", ":", ":", "Types", ":", ":", "STRING", ")", "@", "prot", ".", "skip", "(", "Thrift", ":", ":", "Types", ":", ":", "STOP", ")", "#", "should", "do", "absolutely", "nothing", "end", "it", "\"", "should", "skip", "structs", "\"", "do", "@", "@", "-", "175", ",", "8", "+", "175", ",", "9", "@", "@", "public", "extension", "TProtocol", "{", "try", "skip", "(", "type", ":", "elemType", ")", "}", "try", "readListEnd", "(", ")", "default", ":", "return", "throw", "TProtocolError", "(", "error", ":", ".", "invalidData", ",", "message", ":", "\"", "Invalid", "data", "\"", ")", "}", "}", "}"], "docstring_tokens": ["processing", "untrusted", "Thrift", "payloads"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "219", ",", "40", "+", "219", ",", "43", "@", "@", "static", "int", "date_from_ISO8601", "(", "const", "char", "*", "text", ",", "time_t", "*", "value", ")", "{", "n", "=", "10", ";", "tm", ".", "tm_mon", "=", "0", ";", "for", "(", "i", "=", "0", ";", "i", "<", "2", ";", "i", "+", "+)", "{", "XMLRPC_IS_NUMBER", "(", "text", "[", "i", "]", ")", "XMLRPC_IS_NUMBER", "(", "text", "[", "i", "+", "4", "]", ")", "tm", ".", "tm_mon", "+", "=", "(", "text", "[", "i", "+", "4", "]", "-'", "0", "'", ")*", "n", ";", "n", "/", "=", "10", ";", "}", "tm", ".", "tm_mon", "-", "-;", "if", "(", "tm", ".", "tm_mon", "<", "0", "|", "|", "tm", ".", "tm_mon", ">", "11", ")", "{", "return", "-", "1", ";", "}", "n", "=", "10", ";", "tm", ".", "tm_mday", "=", "0", ";", "for", "(", "i", "=", "0", ";", "i", "<", "2", ";", "i", "+", "+)", "{", "XMLRPC_IS_NUMBER", "(", "text", "[", "i", "]", ")", "XMLRPC_IS_NUMBER", "(", "text", "[", "i", "+", "6", "]", ")", "tm", ".", "tm_mday", "+", "=", "(", "text", "[", "i", "+", "6", "]", "-'", "0", "'", ")*", "n", ";", "n", "/", "=", "10", ";", "}", "n", "=", "10", ";", "tm", ".", "tm_hour", "=", "0", ";", "for", "(", "i", "=", "0", ";", "i", "<", "2", ";", "i", "+", "+)", "{", "XMLRPC_IS_NUMBER", "(", "text", "[", "i", "]", ")", "XMLRPC_IS_NUMBER", "(", "text", "[", "i", "+", "9", "]", ")", "tm", ".", "tm_hour", "+", "=", "(", "text", "[", "i", "+", "9", "]", "-'", "0", "'", ")*", "n", ";", "n", "/", "=", "10", ";", "}", "n", "=", "10", ";", "tm", ".", "tm_min", "=", "0", ";", "for", "(", "i", "=", "0", ";", "i", "<", "2", ";", "i", "+", "+)", "{", "XMLRPC_IS_NUMBER", "(", "text", "[", "i", "]", ")", "XMLRPC_IS_NUMBER", "(", "text", "[", "i", "+", "12", "]", ")", "tm", ".", "tm_min", "+", "=", "(", "text", "[", "i", "+", "12", "]", "-'", "0", "'", ")*", "n", ";", "n", "/", "=", "10", ";", "}", "n", "=", "10", ";", "tm", ".", "tm_sec", "=", "0", ";", "for", "(", "i", "=", "0", ";", "i", "<", "2", ";", "i", "+", "+)", "{", "XMLRPC_IS_NUMBER", "(", "text", "[", "i", "]", ")", "XMLRPC_IS_NUMBER", "(", "text", "[", "i", "+", "15", "]", ")", "tm", ".", "tm_sec", "+", "=", "(", "text", "[", "i", "+", "15", "]", "-'", "0", "'", ")*", "n", ";", "n", "/", "=", "10", ";", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "44", "@", "@", "-", "-", "TEST", "-", "-", "Bug", "#", "68027", "(", "buffer", "overflow", "in", "mkgmtime", "(", ")", "function", ")", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "\"", "xmlrpc", "\"", "))", "print", "\"", "skip", "\"", ";", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "d", "=", "'", "6", "-", "01", "-", "01", "20", ":", "00", ":", "00", "'", ";", "xmlrpc_set_type", "(", "$", "d", ",", "'", "datetime", "'", ");", "var_dump", "(", "$", "d", ")", ";", "$", "datetime", "=", "\"", "2001", "-", "0", "-", "08T21", ":", "46", ":", "40", "-", "0400", "\"", ";", "$", "obj", "=", "xmlrpc_decode", "(", "\"<", "?", "xml", "version", "=", "\\\"", "1", ".", "0", "\\", "\"?", "><", "methodResponse", ">", "<", "params", ">", "<", "param", ">", "<", "value", ">", "<", "dateTime", ".", "iso8601", ">", "$", "datetime", "<", "/", "dateTime", ".", "iso8601", ">", "</", "value", ">", "</", "param", ">", "</", "params", ">", "</", "methodResponse", ">", "\")", ";", "print_r", "(", "$", "obj", ")", ";", "$", "datetime", "=", "\"", "34770", "-", "0", "-", "08T21", ":", "46", ":", "40", "-", "0400", "\"", ";", "$", "obj", "=", "xmlrpc_decode", "(", "\"<", "?", "xml", "version", "=", "\\\"", "1", ".", "0", "\\", "\"?", "><", "methodResponse", ">", "<", "params", ">", "<", "param", ">", "<", "value", ">", "<", "dateTime", ".", "iso8601", ">", "$", "datetime", "<", "/", "dateTime", ".", "iso8601", ">", "</", "value", ">", "</", "param", ">", "</", "params", ">", "</", "methodResponse", ">", "\")", ";", "print_r", "(", "$", "obj", ")", ";", "echo", "\"", "Done", "\\", "n", "\"", ";", "?", ">", "-", "-", "EXPECTF", "-", "-", "object", "(", "stdClass", ")", "#", "1", "(", "3", ")", "{", "[", "\"", "scalar", "\"", "]=", ">", "string", "(", "16", ")", "\"", "6", "-", "01", "-", "01", "20", ":", "00", ":", "00", "\"", "[", "\"", "xmlrpc_type", "\"", "]=", ">", "string", "(", "8", ")", "\"", "datetime", "\"", "[", "\"", "timestamp", "\"", "]=", ">", "int", "(", "%", "d", ")", "}", "stdClass", "Object", "(", "[", "scalar", "]", "=", ">", "2001", "-", "0", "-", "08T21", ":", "46", ":", "40", "-", "0400", "[", "xmlrpc_type", "]", "=", ">", "datetime", "[", "timestamp", "]", "=", ">", "%", "s", ")", "stdClass", "Object", "(", "[", "scalar", "]", "=", ">", "34770", "-", "0", "-", "08T21", ":", "46", ":", "40", "-", "0400", "[", "xmlrpc_type", "]", "=", ">", "datetime", "[", "timestamp", "]", "=", ">", "%", "d", ")", "Done"], "docstring_tokens": ["sending", "an", "overly", "long", "string", "argument"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "548", ",", "6", "+", "548", ",", "13", "@", "@", "Add", "command", "line", "options", "to", "s_client", "/", "s_server", ".", "[", "Steve", "Henson", "]", "Changes", "between", "1", ".", "0", ".", "0g", "and", "1", ".", "0", ".", "0h", "[", "xx", "XXX", "xxxx", "]", "*", ")", "Fix", "CVE", "-", "2011", "-", "4619", ":", "make", "sure", "we", "really", "are", "receiving", "a", "client", "hello", "before", "rejecting", "multiple", "SGC", "restarts", ".", "Thanks", "to", "Ivan", "Nestlerode", "<", "inestlerode", "@", "us", ".", "ibm", ".", "com", ">", "for", "discovering", "this", "bug", ".", "[", "Steve", "Henson", "]", "Changes", "between", "1", ".", "0", ".", "0f", "and", "1", ".", "0", ".", "0g", "[", "18", "Jan", "2012", "]", "*", ")", "Fix", "for", "DTLS", "DoS", "issue", "introduced", "by", "fix", "for", "CVE", "-", "2011", "-", "4109", ".", "@", "@", "-", "873", ",", "14", "+", "873", ",", "6", "@", "@", "int", "ssl3_check_client_hello", "(", "SSL", "*", "s", ")", "int", "ok", ";", "long", "n", ";", "/", "*", "We", "only", "allow", "the", "client", "to", "restart", "the", "handshake", "once", "per", "*", "negotiation", ".", "*", "/", "if", "(", "s", "-", ">", "s3", "-", ">", "flags", "&", "SSL3_FLAGS_SGC_RESTART_DONE", ")", "{", "SSLerr", "(", "SSL_F_SSL3_CHECK_CLIENT_HELLO", ",", "SSL_R_MULTIPLE_SGC_RESTARTS", ")", ";", "return", "-", "1", ";", "}", "/", "*", "this", "function", "is", "called", "when", "we", "really", "expect", "a", "Certificate", "message", ",", "*", "so", "permit", "appropriate", "message", "length", "*", "/", "n", "=", "s", "-", ">", "method", "-", ">", "ssl_get_message", "(", "s", ",", "@", "@", "-", "893", ",", "6", "+", "885", ",", "13", "@", "@", "int", "ssl3_check_client_hello", "(", "SSL", "*", "s", ")", "s", "-", ">", "s3", "-", ">", "tmp", ".", "reuse_message", "=", "1", ";", "if", "(", "s", "-", ">", "s3", "-", ">", "tmp", ".", "message_type", "=", "=", "SSL3_MT_CLIENT_HELLO", ")", "{", "/", "*", "We", "only", "allow", "the", "client", "to", "restart", "the", "handshake", "once", "per", "*", "negotiation", ".", "*", "/", "if", "(", "s", "-", ">", "s3", "-", ">", "flags", "&", "SSL3_FLAGS_SGC_RESTART_DONE", ")", "{", "SSLerr", "(", "SSL_F_SSL3_CHECK_CLIENT_HELLO", ",", "SSL_R_MULTIPLE_SGC_RESTARTS", ")", ";", "return", "-", "1", ";", "}", "/", "*", "Throw", "away", "what", "we", "have", "done", "so", "far", "in", "the", "current", "handshake", ",", "*", "which", "will", "now", "be", "aborted", ".", "(", "A", "full", "SSL_clear", "would", "be", "too", "much", ".", ")", "*", "/", "#", "ifndef", "OPENSSL_NO_DH"], "docstring_tokens": ["via", "unspecified", "vectors", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "44", ",", "6", "+", "44", ",", "7", "@", "@", "import", "org", ".", "springframework", ".", "util", ".", "LinkedMultiValueMap", ";", "import", "org", ".", "springframework", ".", "util", ".", "MultiValueMap", ";", "import", "org", ".", "springframework", ".", "util", ".", "PathMatcher", ";", "import", "org", ".", "springframework", ".", "util", ".", "StringUtils", ";", "/", "**", "*", "Implementation", "of", "{", "@", "link", "SubscriptionRegistry", "}", "that", "stores", "subscriptions", "@", "@", "-", "73", ",", "6", "+", "74", ",", "7", "@", "@", "private", "volatile", "int", "cacheLimit", "=", "DEFAULT_CACHE_LIMIT", ";", "@", "Nullable", "private", "String", "selectorHeaderName", "=", "\"", "selector", "\"", ";", "private", "volatile", "boolean", "selectorHeaderInUse", "=", "false", ";", "@", "@", "-", "114", ",", "26", "+", "116", ",", "28", "@", "@", "public", "int", "getCacheLimit", "(", ")", "{", "}", "/", "**", "*", "Configure", "the", "name", "of", "a", "selector", "header", "that", "a", "subscription", "message", "can", "*", "have", "in", "order", "to", "filter", "messages", "based", "on", "their", "headers", ".", "The", "value", "of", "the", "*", "header", "can", "use", "Spring", "EL", "expressions", "against", "message", "headers", ".", "*", "<", "p", ">", "For", "example", "the", "following", "expression", "expects", "a", "header", "called", "\"", "foo", "\"", "to", "*", "have", "the", "value", "\"", "bar", "\"", ":", "*", "Configure", "the", "name", "of", "a", "header", "that", "a", "subscription", "message", "can", "have", "for", "*", "the", "purpose", "of", "filtering", "messages", "matched", "to", "the", "subscription", ".", "The", "header", "*", "value", "is", "expected", "to", "be", "a", "Spring", "EL", "boolean", "expression", "to", "be", "applied", "to", "*", "the", "headers", "of", "messages", "matched", "to", "the", "subscription", ".", "*", "<", "p", ">", "For", "example", ":", "*", "<", "pre", ">", "*", "headers", ".", "foo", "=", "=", "'", "bar", "'", "*", "<", "/", "pre", ">", "*", "<", "p", ">", "By", "default", "this", "is", "set", "to", "\"", "selector", "\"", ".", "*", "<", "p", ">", "By", "default", "this", "is", "set", "to", "\"", "selector", "\"", ".", "You", "can", "set", "it", "to", "a", "different", "*", "name", ",", "or", "to", "{", "@", "code", "null", "}", "to", "turn", "off", "support", "for", "a", "selector", "header", ".", "*", "@", "param", "selectorHeaderName", "the", "name", "to", "use", "for", "a", "selector", "header", "*", "@", "since", "4", ".", "2", "*", "/", "public", "void", "setSelectorHeaderName", "(", "String", "selectorHeaderName", ")", "{", "Assert", ".", "notNull", "(", "selectorHeaderName", ",", "\"", "'", "selectorHeaderName", "'", "must", "not", "be", "null", "\"", ");", "this", ".", "selectorHeaderName", "=", "selectorHeaderName", ";", "public", "void", "setSelectorHeaderName", "(", "@", "Nullable", "String", "selectorHeaderName", ")", "{", "this", ".", "selectorHeaderName", "=", "StringUtils", ".", "hasText", "(", "selectorHeaderName", ")", "?", "selectorHeaderName", ":", "null", ";", "}", "/", "**", "*", "Return", "the", "name", "for", "the", "selector", "header", ".", "*", "Return", "the", "name", "for", "the", "selector", "header", "name", ".", "*", "@", "since", "4", ".", "2", "*", "/", "@", "Nullable", "public", "String", "getSelectorHeaderName", "(", ")", "{", "return", "this", ".", "selectorHeaderName", ";", "}", "@", "@", "-", "143", ",", "25", "+", "147", ",", "32", "@", "@", "public", "String", "getSelectorHeaderName", "(", ")", "{", "protected", "void", "addSubscriptionInternal", "(", "String", "sessionId", ",", "String", "subsId", ",", "String", "destination", ",", "Message", "<", "?>", "message", ")", "{", "Expression", "expression", "=", "getSelectorExpression", "(", "message", ".", "getHeaders", "(", "))", ";", "this", ".", "subscriptionRegistry", ".", "addSubscription", "(", "sessionId", ",", "subsId", ",", "destination", ",", "expression", ")", ";", "this", ".", "destinationCache", ".", "updateAfterNewSubscription", "(", "destination", ",", "sessionId", ",", "subsId", ")", ";", "}", "@", "Nullable", "private", "Expression", "getSelectorExpression", "(", "MessageHeaders", "headers", ")", "{", "Expression", "expression", "=", "null", ";", "MessageHeaders", "headers", "=", "message", ".", "getHeaders", "(", ");", "String", "selector", "=", "SimpMessageHeaderAccessor", ".", "getFirstNativeHeader", "(", "getSelectorHeaderName", "(", "),", "headers", ")", ";", "if", "(", "selector", "!", "=", "null", ")", "{", "try", "{", "expression", "=", "this", ".", "expressionParser", ".", "parseExpression", "(", "selector", ")", ";", "this", ".", "selectorHeaderInUse", "=", "true", ";", "if", "(", "logger", ".", "isTraceEnabled", "(", "))", "{", "logger", ".", "trace", "(", "\"", "Subscription", "selector", ":", "[", "\"", "+", "selector", "+", "\"", "]\"", ");", "if", "(", "getSelectorHeaderName", "(", ")", "!", "=", "null", ")", "{", "String", "selector", "=", "SimpMessageHeaderAccessor", ".", "getFirstNativeHeader", "(", "getSelectorHeaderName", "(", "),", "headers", ")", ";", "if", "(", "selector", "!", "=", "null", ")", "{", "try", "{", "expression", "=", "this", ".", "expressionParser", ".", "parseExpression", "(", "selector", ")", ";", "this", ".", "selectorHeaderInUse", "=", "true", ";", "if", "(", "logger", ".", "isTraceEnabled", "(", "))", "{", "logger", ".", "trace", "(", "\"", "Subscription", "selector", ":", "[", "\"", "+", "selector", "+", "\"", "]\"", ");", "}", "}", "}", "catch", "(", "Throwable", "ex", ")", "{", "if", "(", "logger", ".", "isDebugEnabled", "(", "))", "{", "logger", ".", "debug", "(", "\"", "Failed", "to", "parse", "selector", ":", "\"", "+", "selector", ",", "ex", ")", ";", "catch", "(", "Throwable", "ex", ")", "{", "if", "(", "logger", ".", "isDebugEnabled", "(", "))", "{", "logger", ".", "debug", "(", "\"", "Failed", "to", "parse", "selector", ":", "\"", "+", "selector", ",", "ex", ")", ";", "}", "}", "}", "}", "this", ".", "subscriptionRegistry", ".", "addSubscription", "(", "sessionId", ",", "subsId", ",", "destination", ",", "expression", ")", ";", "this", ".", "destinationCache", ".", "updateAfterNewSubscription", "(", "destination", ",", "sessionId", ",", "subsId", ")", ";", "return", "expression", ";", "}", "@", "Override", "@", "@", "-", "51", ",", "27", "+", "51", ",", "32", "@", "@", "private", "static", "final", "byte", "[", "]", "EMPTY_PAYLOAD", "=", "new", "byte", "[", "0", "]", ";", "private", "final", "Map", "<", "String", ",", "SessionInfo", ">", "sessions", "=", "new", "ConcurrentHashMap", "<", ">(", ");", "private", "SubscriptionRegistry", "subscriptionRegistry", ";", "@", "Nullable", "private", "PathMatcher", "pathMatcher", ";", "@", "Nullable", "private", "Integer", "cacheLimit", ";", "@", "Nullable", "private", "String", "selectorHeaderName", "=", "\"", "selector", "\"", ";", "@", "Nullable", "private", "TaskScheduler", "taskScheduler", ";", "@", "Nullable", "private", "long", "[", "]", "heartbeatValue", ";", "@", "Nullable", "private", "ScheduledFuture", "<", "?>", "heartbeatFuture", ";", "private", "MessageHeaderInitializer", "headerInitializer", ";", "private", "SubscriptionRegistry", "subscriptionRegistry", ";", "private", "final", "Map", "<", "String", ",", "SessionInfo", ">", "sessions", "=", "new", "ConcurrentHashMap", "<", ">(", ");", "@", "Nullable", "private", "MessageHeaderInitializer", "headerInitializer", ";", "private", "ScheduledFuture", "<", "?>", "heartbeatFuture", ";", "/", "**", "@", "@", "-", "102", ",", "6", "+", "107", ",", "7", "@", "@", "public", "void", "setSubscriptionRegistry", "(", "SubscriptionRegistry", "subscriptionRegistry", ")", "{", "this", ".", "subscriptionRegistry", "=", "subscriptionRegistry", ";", "initPathMatcherToUse", "(", ");", "initCacheLimitToUse", "(", ");", "initSelectorHeaderNameToUse", "(", ");", "}", "public", "SubscriptionRegistry", "getSubscriptionRegistry", "(", ")", "{", "@", "@", "-", "149", ",", "6", "+", "155", ",", "33", "@", "@", "private", "void", "initCacheLimitToUse", "(", ")", "{", "}", "}", "/", "**", "*", "Configure", "the", "name", "of", "a", "header", "that", "a", "subscription", "message", "can", "have", "for", "*", "the", "purpose", "of", "filtering", "messages", "matched", "to", "the", "subscription", ".", "The", "header", "*", "value", "is", "expected", "to", "be", "a", "Spring", "EL", "boolean", "expression", "to", "be", "applied", "to", "*", "the", "headers", "of", "messages", "matched", "to", "the", "subscription", ".", "*", "<", "p", ">", "For", "example", ":", "*", "<", "pre", ">", "*", "headers", ".", "foo", "=", "=", "'", "bar", "'", "*", "<", "/", "pre", ">", "*", "<", "p", ">", "By", "default", "this", "is", "set", "to", "\"", "selector", "\"", ".", "You", "can", "set", "it", "to", "a", "different", "*", "name", ",", "or", "to", "{", "@", "code", "null", "}", "to", "turn", "off", "support", "for", "a", "selector", "header", ".", "*", "@", "param", "selectorHeaderName", "the", "name", "to", "use", "for", "a", "selector", "header", "*", "@", "since", "4", ".", "3", ".", "17", "*", "@", "see", "#", "setSubscriptionRegistry", "*", "@", "see", "DefaultSubscriptionRegistry", "#", "setSelectorHeaderName", "(", "String", ")", "*", "/", "public", "void", "setSelectorHeaderName", "(", "@", "Nullable", "String", "selectorHeaderName", ")", "{", "this", ".", "selectorHeaderName", "=", "selectorHeaderName", ";", "initSelectorHeaderNameToUse", "(", ");", "}", "private", "void", "initSelectorHeaderNameToUse", "(", ")", "{", "if", "(", "this", ".", "subscriptionRegistry", "instanceof", "DefaultSubscriptionRegistry", ")", "{", "(", "(", "DefaultSubscriptionRegistry", ")", "this", ".", "subscriptionRegistry", ")", ".", "setSelectorHeaderName", "(", "this", ".", "selectorHeaderName", ")", ";", "}", "}", "/", "**", "*", "Configure", "the", "{", "@", "link", "org", ".", "springframework", ".", "scheduling", ".", "TaskScheduler", "}", "to", "*", "use", "for", "providing", "heartbeat", "support", ".", "Setting", "this", "property", "also", "sets", "the", "@", "@", "-", "1", ",", "5", "+", "1", ",", "5", "@", "@", "/", "*", "*", "Copyright", "2002", "-", "2017", "the", "original", "author", "or", "authors", ".", "*", "Copyright", "2002", "-", "2018", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "@", "@", "-", "36", ",", "6", "+", "36", ",", "9", "@", "@", "@", "Nullable", "private", "long", "[", "]", "heartbeat", ";", "@", "Nullable", "private", "String", "selectorHeaderName", "=", "\"", "selector", "\"", ";", "public", "SimpleBrokerRegistration", "(", "SubscribableChannel", "inChannel", ",", "MessageChannel", "outChannel", ",", "String", "[", "]", "prefixes", ")", "{", "super", "(", "inChannel", ",", "outChannel", ",", "prefixes", ")", ";", "@", "@", "-", "68", ",", "6", "+", "71", ",", "24", "@", "@", "public", "SimpleBrokerRegistration", "setHeartbeatValue", "(", "long", "[", "]", "heartbeat", ")", "{", "return", "this", ";", "}", "/", "**", "*", "Configure", "the", "name", "of", "a", "header", "that", "a", "subscription", "message", "can", "have", "for", "*", "the", "purpose", "of", "filtering", "messages", "matched", "to", "the", "subscription", ".", "The", "header", "*", "value", "is", "expected", "to", "be", "a", "Spring", "EL", "boolean", "expression", "to", "be", "applied", "to", "*", "the", "headers", "of", "messages", "matched", "to", "the", "subscription", ".", "*", "<", "p", ">", "For", "example", ":", "*", "<", "pre", ">", "*", "headers", ".", "foo", "=", "=", "'", "bar", "'", "*", "<", "/", "pre", ">", "*", "<", "p", ">", "By", "default", "this", "is", "set", "to", "\"", "selector", "\"", ".", "You", "can", "set", "it", "to", "a", "different", "*", "name", ",", "or", "to", "{", "@", "code", "null", "}", "to", "turn", "off", "support", "for", "a", "selector", "header", ".", "*", "@", "param", "selectorHeaderName", "the", "name", "to", "use", "for", "a", "selector", "header", "*", "@", "since", "4", ".", "3", ".", "17", "*", "/", "public", "void", "setSelectorHeaderName", "(", "@", "Nullable", "String", "selectorHeaderName", ")", "{", "this", ".", "selectorHeaderName", "=", "selectorHeaderName", ";", "}", "@", "Override", "protected", "SimpleBrokerMessageHandler", "getMessageHandler", "(", "SubscribableChannel", "brokerChannel", ")", "{", "@", "@", "-", "79", ",", "6", "+", "100", ",", "7", "@", "@", "protected", "SimpleBrokerMessageHandler", "getMessageHandler", "(", "SubscribableChannel", "broke", "if", "(", "this", ".", "heartbeat", "!", "=", "null", ")", "{", "handler", ".", "setHeartbeatValue", "(", "this", ".", "heartbeat", ")", ";", "}", "handler", ".", "setSelectorHeaderName", "(", "this", ".", "selectorHeaderName", ")", ";", "return", "handler", ";", "}", "@", "@", "-", "258", ",", "14", "+", "258", ",", "16", "@", "@", "public", "void", "registerSubscriptionWithDestinationPatternRegex", "(", ")", "{", "}", "@", "Test", "public", "void", "registerSubscriptionWithSelector", "(", ")", "throws", "Exception", "{", "public", "void", "registerSubscriptionWithSelector", "(", ")", "{", "String", "sessionId", "=", "\"", "sess01", "\"", ";", "String", "subscriptionId", "=", "\"", "subs01", "\"", ";", "String", "destination", "=", "\"", "/", "foo", "\"", ";", "String", "selector", "=", "\"", "headers", ".", "foo", "=", "=", "'", "bar", "'", "\";", "this", ".", "registry", ".", "registerSubscription", "(", "subscribeMessage", "(", "sessionId", ",", "subscriptionId", ",", "destination", ",", "selector", ")", ");", "/", "/", "First", ",", "try", "with", "selector", "header", "SimpMessageHeaderAccessor", "accessor", "=", "SimpMessageHeaderAccessor", ".", "create", "(", ");", "accessor", ".", "setDestination", "(", "destination", ")", ";", "accessor", ".", "setNativeHeader", "(", "\"", "foo", "\"", ",", "\"", "bar", "\"", ");", "@", "@", "-", "276", ",", "11", "+", "278", ",", "34", "@", "@", "public", "void", "registerSubscriptionWithSelector", "(", ")", "throws", "Exception", "{", "assertEquals", "(", "1", ",", "actual", ".", "size", "(", "))", ";", "assertEquals", "(", "Collections", ".", "singletonList", "(", "subscriptionId", ")", ",", "actual", ".", "get", "(", "sessionId", ")", ");", "/", "/", "Then", "without", "actual", "=", "this", ".", "registry", ".", "findSubscriptions", "(", "createMessage", "(", "destination", ")", ");", "assertNotNull", "(", "actual", ")", ";", "assertEquals", "(", "0", ",", "actual", ".", "size", "(", "))", ";", "}", "@", "Test", "public", "void", "registerSubscriptionWithSelectorNotSupported", "(", ")", "{", "String", "sessionId", "=", "\"", "sess01", "\"", ";", "String", "subscriptionId", "=", "\"", "subs01", "\"", ";", "String", "destination", "=", "\"", "/", "foo", "\"", ";", "String", "selector", "=", "\"", "headers", ".", "foo", "=", "=", "'", "bar", "'", "\";", "this", ".", "registry", ".", "setSelectorHeaderName", "(", "null", ")", ";", "this", ".", "registry", ".", "registerSubscription", "(", "subscribeMessage", "(", "sessionId", ",", "subscriptionId", ",", "destination", ",", "selector", ")", ");", "SimpMessageHeaderAccessor", "accessor", "=", "SimpMessageHeaderAccessor", ".", "create", "(", ");", "accessor", ".", "setDestination", "(", "destination", ")", ";", "accessor", ".", "setNativeHeader", "(", "\"", "foo", "\"", ",", "\"", "bazz", "\"", ");", "Message", "<", "?>", "message", "=", "MessageBuilder", ".", "createMessage", "(", "\"\"", ",", "accessor", ".", "getMessageHeaders", "(", "))", ";", "MultiValueMap", "<", "String", ",", "String", ">", "actual", "=", "this", ".", "registry", ".", "findSubscriptions", "(", "message", ")", ";", "assertNotNull", "(", "actual", ")", ";", "assertEquals", "(", "1", ",", "actual", ".", "size", "(", "))", ";", "assertEquals", "(", "Collections", ".", "singletonList", "(", "subscriptionId", ")", ",", "actual", ".", "get", "(", "sessionId", ")", ");", "}", "@", "Test", "/", "/", "SPR", "-", "11931", "public", "void", "registerSubscriptionTwiceAndUnregister", "(", ")", "{", "this", ".", "registry", ".", "registerSubscription", "(", "subscribeMessage", "(", "\"", "sess01", "\"", ",", "\"", "subs01", "\"", ",", "\"", "/", "foo", "\"", "))", ";", "@", "@", "-", "383", ",", "6", "+", "383", ",", "10", "@", "@", "private", "RootBeanDefinition", "registerMessageBroker", "(", "Element", "brokerElement", ",", "String", "heartbeatValue", "=", "simpleBrokerElem", ".", "getAttribute", "(", "\"", "heartbeat", "\"", ");", "brokerDef", ".", "getPropertyValues", "(", ").", "add", "(", "\"", "heartbeatValue", "\"", ",", "heartbeatValue", ")", ";", "}", "if", "(", "simpleBrokerElem", ".", "hasAttribute", "(", "\"", "selector", "-", "header", "\"", "))", "{", "String", "headerName", "=", "simpleBrokerElem", ".", "getAttribute", "(", "\"", "selector", "-", "header", "\"", ");", "brokerDef", ".", "getPropertyValues", "(", ").", "add", "(", "\"", "selectorHeaderName", "\"", ",", "headerName", ")", ";", "}", "}", "else", "if", "(", "brokerRelayElem", "!", "=", "null", ")", "{", "String", "prefix", "=", "brokerRelayElem", ".", "getAttribute", "(", "\"", "prefix", "\"", ");", "@", "@", "-", "384", ",", "6", "+", "384", ",", "23", "@", "@", "]", "]>", "</", "xsd", ":", "documentation", ">", "<", "/", "xsd", ":", "annotation", ">", "<", "/", "xsd", ":", "attribute", ">", "<", "xsd", ":", "attribute", "name", "=", "\"", "selector", "-", "header", "\"", "type", "=", "\"", "xsd", ":", "string", "\"", ">", "<", "xsd", ":", "annotation", ">", "<", "xsd", ":", "documentation", "source", "=", "\"", "java", ":", "org", ".", "springframework", ".", "messaging", ".", "simp", ".", "stomp", ".", "SimpleBrokerMessageHandler", "\"", "><", "![", "CDATA", "[", "Configure", "the", "name", "of", "a", "header", "that", "a", "subscription", "message", "can", "have", "for", "the", "purpose", "of", "filtering", "messages", "matched", "to", "the", "subscription", ".", "The", "header", "value", "is", "expected", "to", "be", "a", "Spring", "EL", "boolean", "expression", "to", "be", "applied", "to", "the", "headers", "of", "messages", "matched", "to", "the", "subscription", ".", "For", "example", ":", "headers", ".", "foo", "=", "=", "'", "bar", "'", "By", "default", "this", "is", "set", "to", "\"", "selector", "\"", ".", "You", "can", "set", "it", "to", "a", "different", "name", ",", "or", "to", "\"", "\"", "to", "turn", "off", "support", "for", "a", "selector", "header", ".", "]", "]>", "</", "xsd", ":", "documentation", ">", "<", "/", "xsd", ":", "annotation", ">", "<", "/", "xsd", ":", "attribute", ">", "<", "/", "xsd", ":", "complexType", ">", "<", "xsd", ":", "complexType", "name", "=", "\"", "channel", "\"", ">", "@", "@", "-", "1", ",", "5", "+", "1", ",", "5", "@", "@", "/", "*", "*", "Copyright", "2002", "-", "2017", "the", "original", "author", "or", "authors", ".", "*", "Copyright", "2002", "-", "2018", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "@", "@", "-", "47", ",", "6", "+", "47", ",", "7", "@", "@", "import", "org", ".", "springframework", ".", "messaging", ".", "handler", ".", "invocation", ".", "HandlerMethodReturnValueHandler", ";", "import", "org", ".", "springframework", ".", "messaging", ".", "simp", ".", "SimpMessagingTemplate", ";", "import", "org", ".", "springframework", ".", "messaging", ".", "simp", ".", "annotation", ".", "support", ".", "SimpAnnotationMethodMessageHandler", ";", "import", "org", ".", "springframework", ".", "messaging", ".", "simp", ".", "broker", ".", "DefaultSubscriptionRegistry", ";", "import", "org", ".", "springframework", ".", "messaging", ".", "simp", ".", "broker", ".", "SimpleBrokerMessageHandler", ";", "import", "org", ".", "springframework", ".", "messaging", ".", "simp", ".", "stomp", ".", "StompBrokerRelayMessageHandler", ";", "import", "org", ".", "springframework", ".", "messaging", ".", "simp", ".", "user", ".", "DefaultUserDestinationResolver", ";", "@", "@", "-", "202", ",", "6", "+", "203", ",", "8", "@", "@", "public", "void", "simpleBroker", "(", ")", "throws", "Exception", "{", "assertNotNull", "(", "brokerMessageHandler", ")", ";", "Collection", "<", "String", ">", "prefixes", "=", "brokerMessageHandler", ".", "getDestinationPrefixes", "(", ");", "assertEquals", "(", "Arrays", ".", "asList", "(", "\"/", "topic", "\"", ",", "\"", "/", "queue", "\"", "),", "new", "ArrayList", "<", ">(", "prefixes", ")", ");", "DefaultSubscriptionRegistry", "registry", "=", "(", "DefaultSubscriptionRegistry", ")", "brokerMessageHandler", ".", "getSubscriptionRegistry", "(", ");", "assertEquals", "(", "\"", "my", "-", "selector", "\"", ",", "registry", ".", "getSelectorHeaderName", "(", "))", ";", "assertNotNull", "(", "brokerMessageHandler", ".", "getTaskScheduler", "(", "))", ";", "assertArrayEquals", "(", "new", "long", "[", "]", "{", "15000", ",", "15000", "}", ",", "brokerMessageHandler", ".", "getHeartbeatValue", "(", "))", ";", "@", "@", "-", "228", ",", "7", "+", "231", ",", "7", "@", "@", "public", "void", "simpleBroker", "(", ")", "throws", "Exception", "{", "assertNotNull", "(", "this", ".", "appContext", ".", "getBean", "(", "\"", "webSocketScopeConfigurer", "\"", ",", "CustomScopeConfigurer", ".", "class", ")", ");", "DirectFieldAccessor", "accessor", "=", "new", "DirectFieldAccessor", "(", "brokerMessageHandler", ".", "getSubscriptionRegistry", "(", "))", ";", "DirectFieldAccessor", "accessor", "=", "new", "DirectFieldAccessor", "(", "registry", ")", ";", "Object", "pathMatcher", "=", "accessor", ".", "getPropertyValue", "(", "\"", "pathMatcher", "\"", ");", "String", "pathSeparator", "=", "(", "String", ")", "new", "DirectFieldAccessor", "(", "pathMatcher", ")", ".", "getPropertyValue", "(", "\"", "pathSeparator", "\"", ");", "assertEquals", "(", "\".", "\",", "pathSeparator", ")", ";", "@", "@", "-", "35", ",", "7", "+", "35", ",", "8", "@", "@", "<", "websocket", ":", "stomp", "-", "error", "-", "handler", "ref", "=", "\"", "errorHandler", "\"", "/", ">", "<", "websocket", ":", "simple", "-", "broker", "prefix", "=", "\"/", "topic", ",", "/", "queue", "\"", "heartbeat", "=", "\"", "15000", ",", "15000", "\"", "scheduler", "=", "\"", "scheduler", "\"", "/", ">", "<", "websocket", ":", "simple", "-", "broker", "prefix", "=", "\"/", "topic", ",", "/", "queue", "\"", "selector", "-", "header", "=", "\"", "my", "-", "selector", "\"", "heartbeat", "=", "\"", "15000", ",", "15000", "\"", "scheduler", "=", "\"", "scheduler", "\"", "/", ">", "<", "/", "websocket", ":", "message", "-", "broker", ">"], "docstring_tokens": ["sending", "a", "specially-crafted", "message"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "84", ",", "9", "+", "84", ",", "9", "@", "@", "protected", "static", "boolean", "stringEquals", "(", "String", "s1", ",", "String", "s2", ")", "return", "true", ";", "if", "(", "s1", "=", "=", "null", "|", "|", "s2", "=", "=", "null", "|", "|", "s1", ".", "length", "(", ")", "!", "=", "s2", ".", "length", "(", "))", "return", "false", ";", "boolean", "result", "=", "false", ";", "boolean", "result", "=", "true", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "s1", ".", "length", "(", ");", "i", "+", "+)", "result", "|", "=", "s1", ".", "charAt", "(", "i", ")", "=", "=", "s2", ".", "charAt", "(", "i", ")", ";", "result", "&", "=", "s1", ".", "charAt", "(", "i", ")", "=", "=", "s2", ".", "charAt", "(", "i", ")", ";", "return", "result", ";", "}", "@", "@", "-", "103", ",", "9", "+", "103", ",", "9", "@", "@", "protected", "static", "boolean", "byteEquals", "(", "byte", "[", "]", "b1", ",", "byte", "[", "]", "b2", ")", "return", "true", ";", "if", "(", "b1", "=", "=", "null", "|", "|", "b2", "=", "=", "null", "|", "|", "b1", ".", "length", "!", "=", "b2", ".", "length", ")", "return", "false", ";", "boolean", "result", "=", "false", ";", "boolean", "result", "=", "true", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "b1", ".", "length", ";", "i", "+", "+)", "result", "|", "=", "b1", "[", "i", "]", "=", "=", "b2", "[", "i", "]", ";", "result", "&", "=", "b1", "[", "i", "]", "=", "=", "b2", "[", "i", "]", ";", "return", "result", ";", "}"], "docstring_tokens": ["by", "observing", "elapsed", "times", "before", "rejection", "of", "incorrect", "passwords", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "330", ",", "6", "+", "330", ",", "7", "@", "@", "int", "snd_ctl_add", "(", "struct", "snd_card", "*", "card", ",", "struct", "snd_kcontrol", "*", "kcontrol", ")", "{", "struct", "snd_ctl_elem_id", "id", ";", "unsigned", "int", "idx", ";", "unsigned", "int", "count", ";", "int", "err", "=", "-", "EINVAL", ";", "if", "(", "!", "kcontrol", ")", "@", "@", "-", "358", ",", "8", "+", "359", ",", "9", "@", "@", "int", "snd_ctl_add", "(", "struct", "snd_card", "*", "card", ",", "struct", "snd_kcontrol", "*", "kcontrol", ")", "card", "-", ">", "controls_count", "+", "=", "kcontrol", "-", ">", "count", ";", "kcontrol", "-", ">", "id", ".", "numid", "=", "card", "-", ">", "last_numid", "+", "1", ";", "card", "-", ">", "last_numid", "+", "=", "kcontrol", "-", ">", "count", ";", "count", "=", "kcontrol", "-", ">", "count", ";", "up_write", "(", "&", "card", "-", ">", "controls_rwsem", ")", ";", "for", "(", "idx", "=", "0", ";", "idx", "<", "kcontrol", "-", ">", "count", ";", "idx", "+", "+,", "id", ".", "index", "+", "+,", "id", ".", "numid", "+", "+)", "for", "(", "idx", "=", "0", ";", "idx", "<", "count", ";", "idx", "+", "+,", "id", ".", "index", "+", "+,", "id", ".", "numid", "+", "+)", "snd_ctl_notify", "(", "card", ",", "SNDRV_CTL_EVENT_MASK_ADD", ",", "&", "id", ")", ";", "return", "0", ";", "@", "@", "-", "388", ",", "6", "+", "390", ",", "7", "@", "@", "int", "snd_ctl_replace", "(", "struct", "snd_card", "*", "card", ",", "struct", "snd_kcontrol", "*", "kcontrol", ",", "bool", "add_on_replace", ")", "{", "struct", "snd_ctl_elem_id", "id", ";", "unsigned", "int", "count", ";", "unsigned", "int", "idx", ";", "struct", "snd_kcontrol", "*", "old", ";", "int", "ret", ";", "@", "@", "-", "423", ",", "8", "+", "426", ",", "9", "@", "@", "int", "snd_ctl_replace", "(", "struct", "snd_card", "*", "card", ",", "struct", "snd_kcontrol", "*", "kcontrol", ",", "card", "-", ">", "controls_count", "+", "=", "kcontrol", "-", ">", "count", ";", "kcontrol", "-", ">", "id", ".", "numid", "=", "card", "-", ">", "last_numid", "+", "1", ";", "card", "-", ">", "last_numid", "+", "=", "kcontrol", "-", ">", "count", ";", "count", "=", "kcontrol", "-", ">", "count", ";", "up_write", "(", "&", "card", "-", ">", "controls_rwsem", ")", ";", "for", "(", "idx", "=", "0", ";", "idx", "<", "kcontrol", "-", ">", "count", ";", "idx", "+", "+,", "id", ".", "index", "+", "+,", "id", ".", "numid", "+", "+)", "for", "(", "idx", "=", "0", ";", "idx", "<", "count", ";", "idx", "+", "+,", "id", ".", "index", "+", "+,", "id", ".", "numid", "+", "+)", "snd_ctl_notify", "(", "card", ",", "SNDRV_CTL_EVENT_MASK_ADD", ",", "&", "id", ")", ";", "return", "0", ";", "@", "@", "-", "897", ",", "9", "+", "901", ",", "9", "@", "@", "static", "int", "snd_ctl_elem_write", "(", "struct", "snd_card", "*", "card", ",", "struct", "snd_ctl_file", "*", "file", ",", "result", "=", "kctl", "-", ">", "put", "(", "kctl", ",", "control", ")", ";", "}", "if", "(", "result", ">", "0", ")", "{", "struct", "snd_ctl_elem_id", "id", "=", "control", "-", ">", "id", ";", "up_read", "(", "&", "card", "-", ">", "controls_rwsem", ")", ";", "snd_ctl_notify", "(", "card", ",", "SNDRV_CTL_EVENT_MASK_VALUE", ",", "&", "control", "-", ">", "id", ")", ";", "snd_ctl_notify", "(", "card", ",", "SNDRV_CTL_EVENT_MASK_VALUE", ",", "&", "id", ")", ";", "return", "0", ";", "}", "}", "@", "@", "-", "1333", ",", "8", "+", "1337", ",", "9", "@", "@", "static", "int", "snd_ctl_tlv_ioctl", "(", "struct", "snd_ctl_file", "*", "file", ",", "}", "err", "=", "kctl", "-", ">", "tlv", ".", "c", "(", "kctl", ",", "op_flag", ",", "tlv", ".", "length", ",", "_tlv", "-", ">", "tlv", ")", ";", "if", "(", "err", ">", "0", ")", "{", "struct", "snd_ctl_elem_id", "id", "=", "kctl", "-", ">", "id", ";", "up_read", "(", "&", "card", "-", ">", "controls_rwsem", ")", ";", "snd_ctl_notify", "(", "card", ",", "SNDRV_CTL_EVENT_MASK_TLV", ",", "&", "kctl", "-", ">", "id", ")", ";", "snd_ctl_notify", "(", "card", ",", "SNDRV_CTL_EVENT_MASK_TLV", ",", "&", "id", ")", ";", "return", "0", ";", "}", "}", "else", "{"], "docstring_tokens": ["by", "leveraging", "/dev/snd/controlCX", "access", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "97", ",", "6", "+", "97", ",", "10", "@", "@", "int", "ieee80211_radiotap_iterator_init", "(", "struct", "ieee80211_radiotap_header", "*", "radiotap_header", ",", "int", "max_length", ",", "const", "struct", "ieee80211_radiotap_vendor_namespaces", "*", "vns", ")", "{", "/", "*", "check", "the", "radiotap", "header", "can", "actually", "be", "present", "*", "/", "if", "(", "max_length", "<", "sizeof", "(", "struct", "ieee80211_radiotap_header", ")", ")", "return", "-", "EINVAL", ";", "/", "*", "Linux", "only", "supports", "version", "0", "radiotap", "format", "*", "/", "if", "(", "radiotap_header", "-", ">", "it_version", ")", "return", "-", "EINVAL", ";", "@", "@", "-", "131", ",", "7", "+", "135", ",", "8", "@", "@", "int", "ieee80211_radiotap_iterator_init", "(", "*", "/", "if", "(", "(", "unsigned", "long", ")", "iterator", "-", ">", "_arg", "-", "(", "unsigned", "long", ")", "iterator", "-", ">", "_rtheader", ">", "(", "unsigned", "long", ")", "iterator", "-", ">", "_rtheader", "sizeof", "(", "uint32_t", ")", ">", "(", "unsigned", "long", ")", "iterator", "-", ">", "_max_length", ")", "return", "-", "EINVAL", ";", "}"], "docstring_tokens": ["sending", "an", "overly", "long", "argument"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "72", ",", "6", "+", "72", ",", "7", "@", "@", "import", "org", ".", "kohsuke", ".", "stapler", ".", "QueryParameter", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "Stapler", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "interceptor", ".", "RequirePOST", ";", "/", "**", "*", "Convenience", "structure", "encapsulating", "a", "Groovy", "script", "that", "may", "either", "be", "approved", "whole", "or", "sandboxed", ".", "@", "@", "-", "407", ",", "9", "+", "408", ",", "11", "@", "@", "public", "Object", "evaluate", "(", "ClassLoader", "loader", ",", "Binding", "binding", ")", "throws", "Exception", "{", "return", "\"", "\";", "/", "/", "not", "intended", "to", "be", "displayed", "on", "its", "own", "}", "@", "RequirePOST", "public", "FormValidation", "doCheckScript", "(", "@", "QueryParameter", "String", "value", ",", "@", "QueryParameter", "boolean", "sandbox", ")", "{", "try", "{", "new", "GroovyShell", "(", "Jenkins", ".", "getInstance", "(", ").", "getPluginManager", "(", ").", "uberClassLoader", ")", ".", "parse", "(", "value", ")", ";", "new", "GroovyShell", "(", "Jenkins", ".", "getInstance", "(", ").", "getPluginManager", "(", ").", "uberClassLoader", ",", "GroovySandbox", ".", "createSecureCompilerConfiguration", "(", "))", ".", "parse", "(", "value", ")", ";", "}", "catch", "(", "CompilationFailedException", "x", ")", "{", "return", "FormValidation", ".", "error", "(", "x", ".", "getLocalizedMessage", "(", "))", ";", "}", "@", "@", "-", "57", ",", "6", "+", "57", ",", "8", "@", "@", "import", "org", ".", "apache", ".", "tools", ".", "ant", ".", "taskdefs", ".", "Expand", ";", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "scriptsecurity", ".", "scripts", ".", "ScriptApproval", ";", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "scriptsecurity", ".", "scripts", ".", "UnapprovedUsageException", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "containsString", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*;", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "scriptsecurity", ".", "scripts", ".", "languages", ".", "GroovyLanguage", ";", "@", "@", "-", "849", ",", "4", "+", "851", ",", "27", "@", "@", "public", "Void", "call", "(", ")", "throws", "Exception", "{", "}", ");", "}", "@", "Issue", "(", "\"", "SECURITY", "-", "1292", "\"", ")", "@", "Test", "public", "void", "blockASTTest", "(", ")", "throws", "Exception", "{", "SecureGroovyScript", ".", "DescriptorImpl", "d", "=", "r", ".", "jenkins", ".", "getDescriptorByType", "(", "SecureGroovyScript", ".", "DescriptorImpl", ".", "class", ")", ";", "assertThat", "(", "d", ".", "doCheckScript", "(", "\"", "import", "groovy", ".", "transform", ".", "*\\", "n", "\"", "\"", "import", "jenkins", ".", "model", ".", "Jenkins", "\\", "n", "\"", "\"", "import", "hudson", ".", "model", ".", "FreeStyleProject", "\\", "n", "\"", "\"", "@", "ASTTest", "(", "value", "=", "{", "assert", "Jenkins", ".", "getInstance", "(", ").", "createProject", "(", "FreeStyleProject", ".", "class", ",", "\\", "\"", "should", "-", "not", "-", "exist", "\\", "\")", "}", ")\\", "n", "\"", "\"", "@", "Field", "int", "x", "\\", "n", "\"", "\"", "echo", "'", "hello", "'", "\\", "n", "\"", ",", "false", ")", ".", "toString", "(", "),", "containsString", "(", "\"", "Annotation", "ASTTest", "cannot", "be", "used", "in", "the", "sandbox", "\"", "))", ";", "assertNull", "(", "r", ".", "jenkins", ".", "getItem", "(", "\"", "should", "-", "not", "-", "exist", "\"", "))", ";", "}", "@", "Issue", "(", "\"", "SECURITY", "-", "1292", "\"", ")", "@", "Test", "public", "void", "blockGrab", "(", ")", "throws", "Exception", "{", "SecureGroovyScript", ".", "DescriptorImpl", "d", "=", "r", ".", "jenkins", ".", "getDescriptorByType", "(", "SecureGroovyScript", ".", "DescriptorImpl", ".", "class", ")", ";", "assertThat", "(", "d", ".", "doCheckScript", "(", "\"@", "Grab", "(", "group", "=", "'", "foo", "'", ",", "module", "=", "'", "bar", "'", ",", "version", "=", "'", "1", ".", "0", "'", ")\\", "ndef", "foo", "\\", "n", "\"", ",", "false", ")", ".", "toString", "(", "),", "containsString", "(", "\"", "Annotation", "Grab", "cannot", "be", "used", "in", "the", "sandbox", "\"", "))", ";", "}", "}"], "docstring_tokens": ["applying", "AST", "transforming", "annotations", "to", "source", "code", "elements"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "110", ",", "7", "+", "110", ",", "6", "@", "@", "public", "void", "handle", "(", "String", "target", ",", "Request", "baseRequest", ",", "HttpServletRequest", "reques", "return", ";", "}", "if", "(", "!", "_showContexts", "|", "|", "!", "HttpMethod", ".", "GET", ".", "is", "(", "method", ")", "|", "|", "!", "request", ".", "getRequestURI", "(", ").", "equals", "(", "\"/", "\")", ")", "{", "response", ".", "sendError", "(", "HttpServletResponse", ".", "SC_NOT_FOUND", ")", ";", "@", "@", "-", "139", ",", "7", "+", "138", ",", "7", "@", "@", "public", "void", "handle", "(", "String", "target", ",", "Request", "baseRequest", ",", "HttpServletRequest", "reques", "writer", ".", "append", "(", "\"<", "table", "class", "=", "\\\"", "contexts", "\\", "\">", "<", "thead", ">", "<", "tr", ">", "\")", ";", "writer", ".", "append", "(", "\"<", "th", ">", "Context", "Path", "<", "/", "th", ">", "\")", ";", "writer", ".", "append", "(", "\"<", "th", ">", "Display", "Name", "<", "/", "th", ">", "\")", ";", "writer", ".", "append", "(", "\"<", "th", ">", "State", "<", "/", "th", ">", "\")", ";", "writer", ".", "append", "(", "\"<", "th", ">", "Status", "<", "/", "th", ">", "\")", ";", "writer", ".", "append", "(", "\"<", "th", ">", "LifeCycle", "<", "/", "th", ">", "\")", ";", "writer", ".", "append", "(", "\"<", "/", "tr", ">", "</", "thead", ">", "<", "tbody", ">", "\\", "n", "\"", ");", "@", "@", "-", "162", ",", "7", "+", "161", ",", "7", "@", "@", "public", "void", "handle", "(", "String", "target", ",", "Request", "baseRequest", ",", "HttpServletRequest", "reques", "{", "writer", ".", "append", "(", "\"<", "a", "href", "=", "\\\"", "\")", ".", "append", "(", "href", ")", ".", "append", "(", "\"\\", "\">", "\")", ";", "}", "writer", ".", "append", "(", "context", ".", "getContextPath", "(", "))", ";", "writer", ".", "append", "(", "contextPath", ".", "replaceAll", "(", "\"%", "\",", "\"", "&#", "37", ";", "\")", ");", "if", "(", "context", ".", "isRunning", "(", "))", "{", "writer", ".", "append", "(", "\"<", "/", "a", ">", "\")", ";", "@", "@", "-", "172", ",", "7", "+", "171", ",", "7", "@", "@", "public", "void", "handle", "(", "String", "target", ",", "Request", "baseRequest", ",", "HttpServletRequest", "reques", "if", "(", "StringUtil", ".", "isNotBlank", "(", "context", ".", "getDisplayName", "(", "))", ")", "{", "writer", ".", "append", "(", "context", ".", "getDisplayName", "(", "))", ";", "writer", ".", "append", "(", "StringUtil", ".", "sanitizeXmlString", "(", "context", ".", "getDisplayName", "(", "))", ");", "}", "writer", ".", "append", "(", "\"&", "nbsp", ";", "</", "td", ">", "<", "td", ">", "\")", ";", "/", "/", "Available"], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "151", ",", "7", "+", "151", ",", "7", "@", "@", "entry", "-", "point", "-", "ref", "=", "\"", "loginEntryPoint", "\"", "use", "-", "expressions", "=", "\"", "false", "\"", "xmlns", "=", "\"", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "security", "\"", ">", "<", "intercept", "-", "url", "pattern", "=", "\"/", "**", "\"", "access", "=", "\"", "IS_AUTHENTICATED_ANONYMOUSLY", "\"", "/", ">", "<", "intercept", "-", "url", "pattern", "=", "\"/", "**", "\"", "access", "=", "\"", "IS_AUTHENTICATED_FULLY", "\"", "/", ">", "<", "csrf", "disabled", "=", "\"", "false", "\"", "/>", "<", "access", "-", "denied", "-", "handler", "ref", "=", "\"", "loginEntryPoint", "\"", "/>", "<", "/", "http", ">", "@", "@", "-", "90", ",", "6", "+", "90", ",", "7", "@", "@", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "@", "Test", "public", "void", "testChangePassword", "(", ")", "throws", "Exception", "{", "webDriver", ".", "get", "(", "baseUrl", "+", "\"", "/", "change_password", "\"", ");", "signIn", "(", "userEmail", ",", "PASSWORD", ")", ";", "changePassword", "(", "PASSWORD", ",", "NEW_PASSWORD", ",", "\"", "new", "\"", ");", "@", "@", "-", "108", ",", "7", "+", "109", ",", "7", "@", "@", "public", "void", "displaysErrorWhenPasswordContravenesPolicy", "(", ")", "{", "/", "/", "the", "only", "policy", "we", "can", "contravene", "by", "default", "is", "the", "length", "String", "newPassword", "=", "new", "RandomValueStringGenerator", "(", "260", ")", ".", "generate", "(", ");", "webDriver", ".", "get", "(", "baseUrl", "+", "\"", "/", "change_password", "\"", ");", "signIn", "(", "userEmail", ",", "PASSWORD", ")", ";", "changePassword", "(", "PASSWORD", ",", "newPassword", ",", "newPassword", ")", ";", "@", "@", "-", "134", ",", "11", "+", "135", ",", "8", "@", "@", "private", "void", "signOut", "(", ")", "{", "}", "private", "void", "signIn", "(", "String", "userName", ",", "String", "password", ")", "{", "webDriver", ".", "get", "(", "baseUrl", "+", "\"", "/", "logout", ".", "do", "\"", ");", "webDriver", ".", "get", "(", "baseUrl", "+", "\"", "/", "login", "\"", ");", "webDriver", ".", "findElement", "(", "By", ".", "name", "(", "\"", "username", "\"", "))", ".", "sendKeys", "(", "userName", ")", ";", "webDriver", ".", "findElement", "(", "By", ".", "name", "(", "\"", "password", "\"", "))", ".", "sendKeys", "(", "password", ")", ";", "webDriver", ".", "findElement", "(", "By", ".", "xpath", "(", "\"/", "/", "input", "[", "@", "value", "=", "'", "Sign", "in", "'", "]\"", "))", ".", "click", "(", ");", "assertThat", "(", "webDriver", ".", "findElement", "(", "By", ".", "cssSelector", "(", "\"", "h1", "\"", "))", ".", "getText", "(", "),", "containsString", "(", "\"", "Where", "to", "?", "\")", ");", "}", "}", "@", "@", "-", "351", ",", "8", "+", "351", ",", "14", "@", "@", "public", "void", "changeEmailControllerVerifyEmailNotAllowed", "(", ")", "throws", "Exception", "{", "@", "Test", "public", "void", "changePasswordControllerChangePasswordPageNotAllowed", "(", ")", "throws", "Exception", "{", "MockMvcUtils", ".", "setDisableInternalUserManagement", "(", "false", ",", "getWebApplicationContext", "(", "))", ";", "ResultActions", "result", "=", "createUser", "(", ");", "ScimUser", "createdUser", "=", "JsonUtils", ".", "readValue", "(", "result", ".", "andReturn", "(", ").", "getResponse", "(", ").", "getContentAsString", "(", "),", "ScimUser", ".", "class", ")", ";", "MockMvcUtils", ".", "setDisableInternalUserManagement", "(", "true", ",", "getWebApplicationContext", "(", "))", ";", "getMockMvc", "(", ").", "perform", "(", "get", "(", "\"/", "change_password", "\"", "))", "getMockMvc", "(", ").", "perform", "(", "get", "(", "\"/", "change_password", "\"", ")", ".", "session", "(", "getUserSession", "(", "createdUser", ".", "getUserName", "(", "),", "PASSWD", ")", "))", ".", "andExpect", "(", "status", "(", ").", "isForbidden", "(", "))", ".", "andExpect", "(", "content", "(", ")", ".", "string", "(", "JsonObjectMatcherUtils", ".", "matchesJsonObject", "("], "docstring_tokens": ["using", "brute", "force", "techniques"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1203", ",", "6", "+", "1203", ",", "63", "@", "@", "xfs_difree", "(", "return", "error", ";", "}", "STATIC", "int", "xfs_imap_lookup", "(", "struct", "xfs_mount", "*", "mp", ",", "struct", "xfs_trans", "*", "tp", ",", "xfs_agnumber_t", "agno", ",", "xfs_agino_t", "agino", ",", "xfs_agblock_t", "agbno", ",", "xfs_agblock_t", "*", "chunk_agbno", ",", "xfs_agblock_t", "*", "offset_agbno", ",", "int", "flags", ")", "{", "struct", "xfs_inobt_rec_incore", "rec", ";", "struct", "xfs_btree_cur", "*", "cur", ";", "struct", "xfs_buf", "*", "agbp", ";", "xfs_agino_t", "startino", ";", "int", "error", ";", "int", "i", ";", "error", "=", "xfs_ialloc_read_agi", "(", "mp", ",", "tp", ",", "agno", ",", "&", "agbp", ")", ";", "if", "(", "error", ")", "{", "xfs_fs_cmn_err", "(", "CE_ALERT", ",", "mp", ",", "\"", "xfs_imap", ":", "\"", "\"", "xfs_ialloc_read_agi", "(", ")", "returned", "\"", "\"", "error", "%", "d", ",", "agno", "%", "d", "\"", ",", "error", ",", "agno", ")", ";", "return", "error", ";", "}", "/", "*", "*", "derive", "and", "lookup", "the", "exact", "inode", "record", "for", "the", "given", "agino", ".", "If", "the", "*", "record", "cannot", "be", "found", ",", "then", "it", "'", "s", "an", "invalid", "inode", "number", "and", "we", "*", "should", "abort", ".", "*", "/", "cur", "=", "xfs_inobt_init_cursor", "(", "mp", ",", "tp", ",", "agbp", ",", "agno", ")", ";", "startino", "=", "agino", "&", "~", "(", "XFS_IALLOC_INODES", "(", "mp", ")", "-", "1", ")", ";", "error", "=", "xfs_inobt_lookup", "(", "cur", ",", "startino", ",", "XFS_LOOKUP_EQ", ",", "&", "i", ")", ";", "if", "(", "!", "error", ")", "{", "if", "(", "i", ")", "error", "=", "xfs_inobt_get_rec", "(", "cur", ",", "&", "rec", ",", "&", "i", ")", ";", "if", "(", "!", "error", "&", "&", "i", "=", "=", "0", ")", "error", "=", "EINVAL", ";", "}", "xfs_trans_brelse", "(", "tp", ",", "agbp", ")", ";", "xfs_btree_del_cursor", "(", "cur", ",", "XFS_BTREE_NOERROR", ")", ";", "if", "(", "error", ")", "return", "error", ";", "/", "*", "for", "untrusted", "inodes", "check", "it", "is", "allocated", "first", "*", "/", "if", "(", "(", "flags", "&", "XFS_IGET_BULKSTAT", ")", "&", "&", "(", "rec", ".", "ir_free", "&", "XFS_INOBT_MASK", "(", "agino", "-", "rec", ".", "ir_startino", ")", "))", "return", "EINVAL", ";", "*", "chunk_agbno", "=", "XFS_AGINO_TO_AGBNO", "(", "mp", ",", "rec", ".", "ir_startino", ")", ";", "*", "offset_agbno", "=", "agbno", "-", "*", "chunk_agbno", ";", "return", "0", ";", "}", "/", "*", "*", "Return", "the", "location", "of", "the", "inode", "in", "imap", ",", "for", "mapping", "it", "into", "a", "buffer", ".", "*", "/", "@", "@", "-", "1263", ",", "6", "+", "1320", ",", "23", "@", "@", "xfs_imap", "(", "return", "XFS_ERROR", "(", "EINVAL", ")", ";", "}", "blks_per_cluster", "=", "XFS_INODE_CLUSTER_SIZE", "(", "mp", ")", ">", ">", "mp", "-", ">", "m_sb", ".", "sb_blocklog", ";", "/", "*", "*", "For", "bulkstat", "and", "handle", "lookups", ",", "we", "have", "an", "untrusted", "inode", "number", "*", "that", "we", "have", "to", "verify", "is", "valid", ".", "We", "cannot", "do", "this", "just", "by", "reading", "*", "the", "inode", "buffer", "as", "it", "may", "have", "been", "unlinked", "and", "removed", "leaving", "*", "inodes", "in", "stale", "state", "on", "disk", ".", "Hence", "we", "have", "to", "do", "a", "btree", "lookup", "*", "in", "all", "cases", "where", "an", "untrusted", "inode", "number", "is", "passed", ".", "*", "/", "if", "(", "flags", "&", "XFS_IGET_BULKSTAT", ")", "{", "error", "=", "xfs_imap_lookup", "(", "mp", ",", "tp", ",", "agno", ",", "agino", ",", "agbno", ",", "&", "chunk_agbno", ",", "&", "offset_agbno", ",", "flags", ")", ";", "if", "(", "error", ")", "return", "error", ";", "goto", "out_map", ";", "}", "/", "*", "*", "If", "the", "inode", "cluster", "size", "is", "the", "same", "as", "the", "blocksize", "or", "*", "smaller", "we", "get", "to", "the", "buffer", "by", "simple", "arithmetics", ".", "@", "@", "-", "1277", ",", "10", "+", "1351", ",", "8", "@", "@", "xfs_imap", "(", "return", "0", ";", "}", "blks_per_cluster", "=", "XFS_INODE_CLUSTER_SIZE", "(", "mp", ")", ">", ">", "mp", "-", ">", "m_sb", ".", "sb_blocklog", ";", "/", "*", "*", "If", "we", "get", "a", "block", "number", "passed", "from", "bulkstat", "we", "can", "use", "it", "to", "*", "If", "we", "get", "a", "block", "number", "passed", "we", "can", "use", "it", "to", "*", "find", "the", "buffer", "easily", ".", "*", "/", "if", "(", "imap", "-", ">", "im_blkno", ")", "{", "@", "@", "-", "1304", ",", "50", "+", "1376", ",", "13", "@", "@", "xfs_imap", "(", "offset_agbno", "=", "agbno", "&", "mp", "-", ">", "m_inoalign_mask", ";", "chunk_agbno", "=", "agbno", "-", "offset_agbno", ";", "}", "else", "{", "xfs_btree_cur_t", "*", "cur", ";", "/", "*", "inode", "btree", "cursor", "*", "/", "xfs_inobt_rec_incore_t", "chunk_rec", ";", "xfs_buf_t", "*", "agbp", ";", "/", "*", "agi", "buffer", "*", "/", "int", "i", ";", "/", "*", "temp", "state", "*", "/", "error", "=", "xfs_ialloc_read_agi", "(", "mp", ",", "tp", ",", "agno", ",", "&", "agbp", ")", ";", "if", "(", "error", ")", "{", "xfs_fs_cmn_err", "(", "CE_ALERT", ",", "mp", ",", "\"", "xfs_imap", ":", "\"", "\"", "xfs_ialloc_read_agi", "(", ")", "returned", "\"", "\"", "error", "%", "d", ",", "agno", "%", "d", "\"", ",", "error", ",", "agno", ")", ";", "return", "error", ";", "}", "cur", "=", "xfs_inobt_init_cursor", "(", "mp", ",", "tp", ",", "agbp", ",", "agno", ")", ";", "error", "=", "xfs_inobt_lookup", "(", "cur", ",", "agino", ",", "XFS_LOOKUP_LE", ",", "&", "i", ")", ";", "if", "(", "error", ")", "{", "xfs_fs_cmn_err", "(", "CE_ALERT", ",", "mp", ",", "\"", "xfs_imap", ":", "\"", "\"", "xfs_inobt_lookup", "(", ")", "failed", "\"", ");", "goto", "error0", ";", "}", "error", "=", "xfs_inobt_get_rec", "(", "cur", ",", "&", "chunk_rec", ",", "&", "i", ")", ";", "if", "(", "error", ")", "{", "xfs_fs_cmn_err", "(", "CE_ALERT", ",", "mp", ",", "\"", "xfs_imap", ":", "\"", "\"", "xfs_inobt_get_rec", "(", ")", "failed", "\"", ");", "goto", "error0", ";", "}", "if", "(", "i", "=", "=", "0", ")", "{", "#", "ifdef", "DEBUG", "xfs_fs_cmn_err", "(", "CE_ALERT", ",", "mp", ",", "\"", "xfs_imap", ":", "\"", "\"", "xfs_inobt_get_rec", "(", ")", "failed", "\"", ");", "#", "endif", "/", "*", "DEBUG", "*", "/", "error", "=", "XFS_ERROR", "(", "EINVAL", ")", ";", "}", "error0", ":", "xfs_trans_brelse", "(", "tp", ",", "agbp", ")", ";", "xfs_btree_del_cursor", "(", "cur", ",", "XFS_BTREE_NOERROR", ")", ";", "error", "=", "xfs_imap_lookup", "(", "mp", ",", "tp", ",", "agno", ",", "agino", ",", "agbno", ",", "&", "chunk_agbno", ",", "&", "offset_agbno", ",", "flags", ")", ";", "if", "(", "error", ")", "return", "error", ";", "chunk_agbno", "=", "XFS_AGINO_TO_AGBNO", "(", "mp", ",", "chunk_rec", ".", "ir_startino", ")", ";", "offset_agbno", "=", "agbno", "-", "chunk_agbno", ";", "}", "out_map", ":", "ASSERT", "(", "agbno", ">", "=", "chunk_agbno", ")", ";", "cluster_agbno", "=", "chunk_agbno", "+", "(", "(", "offset_agbno", "/", "blks_per_cluster", ")", "*", "blks_per_cluster", ")", ";"], "docstring_tokens": ["create", "a", "stale", "handle", "and", "open", "it"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1425", ",", "6", "+", "1425", ",", "7", "@", "@", "static", "int", "copy_to_user_tmpl", "(", "struct", "xfrm_policy", "*", "xp", ",", "struct", "sk_buff", "*", "skb", ")", "struct", "xfrm_user_tmpl", "*", "up", "=", "&", "vec", "[", "i", "]", ";", "struct", "xfrm_tmpl", "*", "kp", "=", "&", "xp", "-", ">", "xfrm_vec", "[", "i", "]", ";", "memset", "(", "up", ",", "0", ",", "sizeof", "(", "*", "up", ")", ");", "memcpy", "(", "&", "up", "-", ">", "id", ",", "&", "kp", "-", ">", "id", ",", "sizeof", "(", "up", "-", ">", "id", ")", ");", "up", "-", ">", "family", "=", "kp", "-", ">", "encap_family", ";", "memcpy", "(", "&", "up", "-", ">", "saddr", ",", "&", "kp", "-", ">", "saddr", ",", "sizeof", "(", "up", "-", ">", "saddr", ")", ");"], "docstring_tokens": ["getsockname"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "109", ",", "6", "+", "109", ",", "7", "@", "@", "import", "jenkins", ".", "util", ".", "AtmostOneTaskExecutor", ";", "import", "org", ".", "acegisecurity", ".", "AccessDeniedException", ";", "import", "org", ".", "acegisecurity", ".", "Authentication", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "restrictions", ".", "NoExternalUse", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "HttpResponse", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "HttpResponses", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "export", ".", "Exported", ";", "@", "@", "-", "694", ",", "15", "+", "695", ",", "68", "@", "@", "private", "synchronized", "WaitingItem", "peek", "(", ")", "{", "*", "/", "@", "Exported", "(", "inline", "=", "true", ")", "public", "synchronized", "Item", "[", "]", "getItems", "(", ")", "{", "Item", "[", "]", "r", "=", "new", "Item", "[", "waitingList", ".", "size", "(", ")", "+", "blockedProjects", ".", "size", "(", ")", "+", "buildables", ".", "size", "(", ")", "+", "pendings", ".", "size", "(", ")]", ";", "waitingList", ".", "toArray", "(", "r", ")", ";", "int", "idx", "=", "waitingList", ".", "size", "(", ");", "for", "(", "BlockedItem", "p", ":", "blockedProjects", ".", "values", "(", "))", "r", "[", "idx", "+", "+]", "=", "p", ";", "for", "(", "BuildableItem", "p", ":", "reverse", "(", "buildables", ".", "values", "(", "))", ")", "r", "[", "idx", "+", "+]", "=", "p", ";", "for", "(", "BuildableItem", "p", ":", "reverse", "(", "pendings", ".", "values", "(", "))", ")", "r", "[", "idx", "+", "+]", "=", "p", ";", "List", "<", "Item", ">", "r", "=", "new", "ArrayList", "<", "Item", ">", "()", ";", "for", "(", "WaitingItem", "p", ":", "waitingList", ")", "{", "r", "=", "filterItemListBasedOnPermissions", "(", "r", ",", "p", ")", ";", "}", "for", "(", "BlockedItem", "p", ":", "blockedProjects", ".", "values", "(", "))", "{", "r", "=", "filterItemListBasedOnPermissions", "(", "r", ",", "p", ")", ";", "}", "for", "(", "BuildableItem", "p", ":", "reverse", "(", "buildables", ".", "values", "(", "))", ")", "{", "r", "=", "filterItemListBasedOnPermissions", "(", "r", ",", "p", ")", ";", "}", "for", "(", "BuildableItem", "p", ":", "reverse", "(", "pendings", ".", "values", "(", "))", ")", "{", "r", "=", "filterItemListBasedOnPermissions", "(", "r", ",", "p", ")", ";", "}", "Item", "[", "]", "items", "=", "new", "Item", "[", "r", ".", "size", "(", ")]", ";", "r", ".", "toArray", "(", "items", ")", ";", "return", "items", ";", "}", "private", "List", "<", "Item", ">", "filterItemListBasedOnPermissions", "(", "List", "<", "Item", ">", "r", ",", "Item", "t", ")", "{", "if", "(", "t", ".", "task", "instanceof", "hudson", ".", "model", ".", "Item", ")", "{", "if", "(", "((", "hudson", ".", "model", ".", "Item", ")", "t", ".", "task", ")", ".", "hasPermission", "(", "hudson", ".", "model", ".", "Item", ".", "READ", ")", ")", "{", "r", ".", "add", "(", "t", ")", ";", "}", "}", "return", "r", ";", "}", "/", "**", "*", "Returns", "an", "array", "of", "Item", "for", "which", "it", "is", "only", "visible", "the", "name", "of", "the", "task", ".", "*", "*", "Generally", "speaking", "the", "array", "is", "sorted", "such", "that", "the", "items", "that", "are", "most", "likely", "built", "sooner", "are", "*", "at", "the", "end", ".", "*", "/", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "@", "Exported", "(", "inline", "=", "true", ")", "public", "synchronized", "StubItem", "[", "]", "getDiscoverableItems", "(", ")", "{", "List", "<", "StubItem", ">", "r", "=", "new", "ArrayList", "<", "StubItem", ">", "()", ";", "for", "(", "WaitingItem", "p", ":", "waitingList", ")", "{", "r", "=", "filterDiscoverableItemListBasedOnPermissions", "(", "r", ",", "p", ")", ";", "}", "for", "(", "BlockedItem", "p", ":", "blockedProjects", ".", "values", "(", "))", "{", "r", "=", "filterDiscoverableItemListBasedOnPermissions", "(", "r", ",", "p", ")", ";", "}", "for", "(", "BuildableItem", "p", ":", "reverse", "(", "buildables", ".", "values", "(", "))", ")", "{", "r", "=", "filterDiscoverableItemListBasedOnPermissions", "(", "r", ",", "p", ")", ";", "}", "for", "(", "BuildableItem", "p", ":", "reverse", "(", "pendings", ".", "values", "(", "))", ")", "{", "r", "=", "filterDiscoverableItemListBasedOnPermissions", "(", "r", ",", "p", ")", ";", "}", "StubItem", "[", "]", "items", "=", "new", "StubItem", "[", "r", ".", "size", "(", ")]", ";", "r", ".", "toArray", "(", "items", ")", ";", "return", "items", ";", "}", "private", "List", "<", "StubItem", ">", "filterDiscoverableItemListBasedOnPermissions", "(", "List", "<", "StubItem", ">", "r", ",", "Item", "t", ")", "{", "if", "(", "t", ".", "task", "instanceof", "hudson", ".", "model", ".", "Item", ")", "{", "if", "(", "!(", "(", "hudson", ".", "model", ".", "Item", ")", "t", ".", "task", ")", ".", "hasPermission", "(", "hudson", ".", "model", ".", "Item", ".", "READ", ")", "&", "&", "(", "(", "hudson", ".", "model", ".", "Item", ")", "t", ".", "task", ")", ".", "hasPermission", "(", "hudson", ".", "model", ".", "Item", ".", "DISCOVER", ")", ")", "{", "r", ".", "add", "(", "new", "StubItem", "(", "new", "StubTask", "(", "t", ".", "task", ")", "))", ";", "}", "}", "return", "r", ";", "}", "@", "@", "-", "1581", ",", "6", "+", "1635", ",", "42", "@", "@", "public", "String", "toString", "(", ")", "{", "}", "}", "/", "**", "*", "A", "Stub", "class", "for", "{", "@", "link", "Task", "}", "which", "exposes", "only", "the", "name", "of", "the", "Task", "to", "be", "displayed", "when", "the", "user", "*", "has", "DISCOVERY", "permissions", "only", ".", "*", "/", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "@", "ExportedBean", "(", "defaultVisibility", "=", "999", ")", "public", "static", "class", "StubTask", "{", "private", "String", "name", ";", "public", "StubTask", "(", "@", "Nonnull", "Queue", ".", "Task", "base", ")", "{", "this", ".", "name", "=", "base", ".", "getName", "(", ");", "}", "@", "Exported", "public", "String", "getName", "(", ")", "{", "return", "name", ";", "}", "}", "/", "**", "*", "A", "Stub", "class", "for", "{", "@", "link", "Item", "}", "which", "exposes", "only", "the", "name", "of", "the", "Task", "to", "be", "displayed", "when", "the", "user", "*", "has", "DISCOVERY", "permissions", "only", ".", "*", "/", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "@", "ExportedBean", "(", "defaultVisibility", "=", "999", ")", "public", "class", "StubItem", "{", "@", "Exported", "public", "StubTask", "task", ";", "public", "StubItem", "(", "StubTask", "task", ")", "{", "this", ".", "task", "=", "task", ";", "}", "}", "/", "**", "*", "An", "optional", "interface", "for", "actions", "on", "Queue", ".", "Item", ".", "@", "@", "-", "23", ",", "9", "+", "23", ",", "12", "@", "@", "*", "/", "package", "hudson", ".", "model", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "html", ".", "DomElement", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "html", ".", "DomNode", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "html", ".", "HtmlFileInput", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "html", ".", "HtmlForm", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "html", ".", "HtmlPage", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "xml", ".", "XmlPage", ";", "import", "hudson", ".", "Launcher", ";", "import", "hudson", ".", "matrix", ".", "AxisList", ";", "import", "hudson", ".", "matrix", ".", "LabelAxis", ";", "@", "@", "-", "39", ",", "11", "+", "42", ",", "16", "@", "@", "import", "hudson", ".", "model", ".", "Queue", ".", "Executable", ";", "import", "hudson", ".", "model", ".", "Queue", ".", "WaitingItem", ";", "import", "hudson", ".", "model", ".", "queue", ".", "AbstractQueueTask", ";", "import", "hudson", ".", "model", ".", "queue", ".", "CauseOfBlockage", ";", "import", "hudson", ".", "model", ".", "queue", ".", "QueueTaskDispatcher", ";", "import", "hudson", ".", "model", ".", "queue", ".", "QueueTaskFuture", ";", "import", "hudson", ".", "model", ".", "queue", ".", "ScheduleResult", ";", "import", "hudson", ".", "model", ".", "queue", ".", "SubTask", ";", "import", "hudson", ".", "security", ".", "ACL", ";", "import", "hudson", ".", "security", ".", "AuthorizationMatrixProperty", ";", "import", "hudson", ".", "security", ".", "GlobalMatrixAuthorizationStrategy", ";", "import", "hudson", ".", "security", ".", "Permission", ";", "import", "hudson", ".", "security", ".", "ProjectMatrixAuthorizationStrategy", ";", "import", "hudson", ".", "security", ".", "SparseACL", ";", "import", "hudson", ".", "slaves", ".", "DumbSlave", ";", "import", "hudson", ".", "slaves", ".", "DummyCloudImpl", ";", "@", "@", "-", "58", ",", "7", "+", "66", ",", "10", "@", "@", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "CancellationException", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ExecutionException", ";", "import", "java", ".", "util", ".", "concurrent", ".", "Future", ";", "@", "@", "-", "84", ",", "7", "+", "95", ",", "9", "@", "@", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "HudsonTestCase", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "MockQueueItemAuthenticator", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "SequenceLock", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "SleepBuilder", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "TestBuilder", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "TestExtension", ";", "import", "org", ".", "mortbay", ".", "jetty", ".", "Server", ";", "import", "org", ".", "mortbay", ".", "jetty", ".", "bio", ".", "SocketConnector", ";", "import", "org", ".", "mortbay", ".", "jetty", ".", "servlet", ".", "ServletHandler", ";", "@", "@", "-", "413", ",", "11", "+", "426", ",", "11", "@", "@", "public", "boolean", "perform", "(", "AbstractBuild", "<", "?,", "?", ">", "build", ",", "Launcher", "launcher", ",", "BuildListen", "FreeStyleBuild", "b", "=", "v", ".", "waitForStart", "(", ");", "assertEquals", "(", "1", ",", "b", ".", "getNumber", "(", "))", ";", "assertTrue", "(", "b", ".", "isBuilding", "(", "))", ";", "assertSame", "(", "p", ",", "b", ".", "getProject", "(", "))", ";", "assertSame", "(", "p", ",", "b", ".", "getProject", "(", "))", ";", "ev", ".", "signal", "(", ");", "/", "/", "let", "the", "build", "complete", "FreeStyleBuild", "b2", "=", "assertBuildStatusSuccess", "(", "v", ")", ";", "assertSame", "(", "b", ",", "b2", ")", ";", "assertSame", "(", "b", ",", "b2", ")", ";", "}", "@", "Inject", "@", "@", "-", "579", ",", "4", "+", "592", ",", "64", "@", "@", "public", "void", "testCancelInQueue", "(", ")", "throws", "Exception", "}", "catch", "(", "CancellationException", "e", ")", "{", "}", "}", "public", "void", "testQueueApiOutputShouldBeFilteredByUserPermission", "(", ")", "throws", "Exception", "{", "jenkins", ".", "setSecurityRealm", "(", "createDummySecurityRealm", "(", "))", ";", "ProjectMatrixAuthorizationStrategy", "str", "=", "new", "ProjectMatrixAuthorizationStrategy", "(", ");", "str", ".", "add", "(", "Jenkins", ".", "READ", ",", "\"", "bob", "\"", ");", "str", ".", "add", "(", "Jenkins", ".", "READ", ",", "\"", "alice", "\"", ");", "str", ".", "add", "(", "Jenkins", ".", "READ", ",", "\"", "james", "\"", ");", "jenkins", ".", "setAuthorizationStrategy", "(", "str", ")", ";", "FreeStyleProject", "project", "=", "createFreeStyleProject", "(", "\"", "project", "\"", ");", "Map", "<", "Permission", ",", "Set", "<", "String", ">", ">", "permissions", "=", "new", "HashMap", "<", "Permission", ",", "Set", "<", "String", ">", ">(", ");", "permissions", ".", "put", "(", "Item", ".", "READ", ",", "Collections", ".", "singleton", "(", "\"", "bob", "\"", "))", ";", "permissions", ".", "put", "(", "Item", ".", "DISCOVER", ",", "Collections", ".", "singleton", "(", "\"", "james", "\"", "))", ";", "AuthorizationMatrixProperty", "prop1", "=", "new", "AuthorizationMatrixProperty", "(", "permissions", ")", ";", "project", ".", "addProperty", "(", "prop1", ")", ";", "project", ".", "getBuildersList", "(", ").", "add", "(", "new", "SleepBuilder", "(", "10", ")", ");", "project", ".", "scheduleBuild2", "(", "0", ")", ";", "WebClient", "webClient", "=", "new", "WebClient", "(", ");", "webClient", ".", "login", "(", "\"", "bob", "\"", ",", "\"", "bob", "\"", ");", "XmlPage", "p", "=", "webClient", ".", "goToXml", "(", "\"/", "queue", "/", "api", "/", "xml", "\"", ");", "/", "/", "bob", "has", "permission", "on", "the", "project", "and", "will", "be", "able", "to", "see", "it", "in", "the", "queue", "together", "with", "information", "such", "as", "the", "URL", "and", "the", "name", ".", "for", "(", "DomNode", "element", ":", "p", ".", "getFirstChild", "(", ").", "getFirstChild", "(", ").", "getChildNodes", "(", "))", "{", "if", "(", "element", ".", "getNodeName", "(", ").", "equals", "(", "\"", "task", "\"", "))", "{", "assertEquals", "(", "((", "DomElement", ")", "element", ")", ".", "getElementsByTagName", "(", "\"", "name", "\"", ").", "size", "(", "),", "1", ")", ";", "assertEquals", "(", "((", "DomElement", ")", "element", ")", ".", "getElementsByTagName", "(", "\"", "name", "\"", ").", "item", "(", "0", ")", ".", "getFirstChild", "(", ").", "toString", "(", "),", "\"", "project", "\"", ");", "assertEquals", "(", "((", "DomElement", ")", "element", ")", ".", "getElementsByTagName", "(", "\"", "url", "\"", ").", "size", "(", "),", "1", ")", ";", "}", "}", "WebClient", "webClient2", "=", "new", "WebClient", "(", ");", "webClient2", ".", "login", "(", "\"", "alice", "\"", ");", "XmlPage", "p2", "=", "webClient2", ".", "goToXml", "(", "\"/", "queue", "/", "api", "/", "xml", "\"", ");", "/", "/", "alice", "does", "not", "have", "permission", "on", "the", "project", "and", "will", "not", "see", "it", "in", "the", "queue", ".", "assertEquals", "(", "\"<", "queue", ">", "</", "queue", ">", "\",", "p2", ".", "getContent", "(", "))", ";", "WebClient", "webClient3", "=", "new", "WebClient", "(", ");", "webClient3", ".", "login", "(", "\"", "james", "\"", ");", "XmlPage", "p3", "=", "webClient3", ".", "goToXml", "(", "\"/", "queue", "/", "api", "/", "xml", "\"", ");", "/", "/", "james", "has", "DISCOVER", "permission", "on", "the", "project", "and", "will", "only", "be", "able", "to", "see", "the", "task", "name", ".", "assertEquals", "(", "\"<", "queue", ">", "<", "discoverableItem", ">", "<", "task", ">", "<", "name", ">", "project", "<", "/", "name", ">", "</", "task", ">", "</", "discoverableItem", ">", "</", "queue", ">", "\",", "p3", ".", "getContent", "(", "))", ";", "}", "/", "/", "we", "force", "the", "project", "not", "to", "be", "executed", "so", "that", "it", "stays", "in", "the", "queue", "@", "TestExtension", "(", "\"", "testQueueApiOutputShouldBeFilteredByUserPermission", "\"", ")", "public", "static", "class", "MyQueueTaskDispatcher", "extends", "QueueTaskDispatcher", "{", "@", "Override", "public", "CauseOfBlockage", "canTake", "(", "Node", "node", ",", "Queue", ".", "BuildableItem", "item", ")", "{", "return", "new", "CauseOfBlockage", "(", ")", "{", "@", "Override", "public", "String", "getShortDescription", "(", ")", "{", "return", "\"", "blocked", "by", "canTake", "\"", ";", "}", "}", ";", "}", "}", "}"], "docstring_tokens": ["via", "a", "direct", "request", "to", "queue/api", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2457", ",", "7", "+", "2457", ",", "6", "@", "@", "union", "freelist_init_state", "{", "unsigned", "int", "pos", ";", "unsigned", "int", "*", "list", ";", "unsigned", "int", "count", ";", "unsigned", "int", "rand", ";", "}", ";", "struct", "rnd_state", "rnd_state", ";", "}", ";", "@", "@", "-", "2483", ",", "8", "+", "2482", ",", "7", "@", "@", "static", "bool", "freelist_state_initialize", "(", "union", "freelist_init_state", "*", "state", ",", "}", "else", "{", "state", "-", ">", "list", "=", "cachep", "-", ">", "random_seq", ";", "state", "-", ">", "count", "=", "count", ";", "state", "-", ">", "pos", "=", "0", ";", "state", "-", ">", "rand", "=", "rand", ";", "state", "-", ">", "pos", "=", "rand", "%", "count", ";", "ret", "=", "true", ";", "}", "return", "ret", ";", "@", "@", "-", "2493", ",", "7", "+", "2491", ",", "9", "@", "@", "static", "bool", "freelist_state_initialize", "(", "union", "freelist_init_state", "*", "state", ",", "/", "*", "Get", "the", "next", "entry", "on", "the", "list", "and", "randomize", "it", "using", "a", "random", "shift", "*", "/", "static", "freelist_idx_t", "next_random_slot", "(", "union", "freelist_init_state", "*", "state", ")", "{", "return", "(", "state", "-", ">", "list", "[", "state", "-", ">", "pos", "+", "+]", "+", "state", "-", ">", "rand", ")", "%", "state", "-", ">", "count", ";", "if", "(", "state", "-", ">", "pos", ">", "=", "state", "-", ">", "count", ")", "state", "-", ">", "pos", "=", "0", ";", "return", "state", "-", ">", "list", "[", "state", "-", ">", "pos", "+", "+]", ";", "}", "/", "*", "Swap", "two", "freelist", "entries", "*", "/"], "docstring_tokens": ["by", "leveraging", "the", "selection", "of", "a", "large", "value", "for", "a", "random", "number", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "398", ",", "6", "+", "398", ",", "10", "@", "@", "void", "refreshNamenodes", "(", "Configuration", "conf", ")", "private", "Configuration", "conf", ";", "private", "final", "String", "userWithLocalPathAccess", ";", "private", "String", "supergroup", ";", "private", "boolean", "isPermissionEnabled", ";", "private", "String", "dnUserName", "=", "null", ";", "/", "**", "*", "Create", "the", "DataNode", "given", "a", "configuration", "and", "an", "array", "of", "dataDirs", ".", "@", "@", "-", "419", ",", "6", "+", "423", ",", "11", "@", "@", "void", "refreshNamenodes", "(", "Configuration", "conf", ")", "this", ".", "userWithLocalPathAccess", "=", "conf", ".", "get", "(", "DFSConfigKeys", ".", "DFS_BLOCK_LOCAL_PATH_ACCESS_USER_KEY", ")", ";", "this", ".", "supergroup", "=", "conf", ".", "get", "(", "DFSConfigKeys", ".", "DFS_PERMISSIONS_SUPERUSERGROUP_KEY", ",", "DFSConfigKeys", ".", "DFS_PERMISSIONS_SUPERUSERGROUP_DEFAULT", ")", ";", "this", ".", "isPermissionEnabled", "=", "conf", ".", "getBoolean", "(", "DFSConfigKeys", ".", "DFS_PERMISSIONS_ENABLED_KEY", ",", "DFSConfigKeys", ".", "DFS_PERMISSIONS_ENABLED_DEFAULT", ")", ";", "try", "{", "confHostName", "=", "getHostName", "(", "conf", ")", ";", "hostName", "=", "confHostName", ";", "@", "@", "-", "525", ",", "6", "+", "534", ",", "33", "@", "@", "private", "void", "initIpcServer", "(", "Configuration", "conf", ")", "throws", "IOException", "{", "ipcServer", ".", "refreshServiceAcl", "(", "conf", ",", "new", "HDFSPolicyProvider", "(", "))", ";", "}", "}", "/", "**", "Check", "whether", "the", "current", "user", "is", "in", "the", "superuser", "group", ".", "*", "/", "private", "void", "checkSuperuserPrivilege", "(", ")", "throws", "IOException", ",", "AccessControlException", "{", "if", "(", "!", "isPermissionEnabled", ")", "{", "return", ";", "}", "/", "/", "Try", "to", "get", "the", "ugi", "in", "the", "RPC", "call", ".", "UserGroupInformation", "callerUgi", "=", "ipcServer", ".", "getRemoteUser", "(", ");", "if", "(", "callerUgi", "=", "=", "null", ")", "{", "/", "/", "This", "is", "not", "from", "RPC", ".", "callerUgi", "=", "UserGroupInformation", ".", "getCurrentUser", "(", ");", "}", "/", "/", "Is", "this", "by", "the", "DN", "user", "itself", "?", "assert", "dnUserName", "!", "=", "null", ";", "if", "(", "callerUgi", ".", "getShortUserName", "(", ").", "equals", "(", "dnUserName", ")", ")", "{", "return", ";", "}", "/", "/", "Is", "the", "user", "a", "member", "of", "the", "super", "group", "?", "List", "<", "String", ">", "groups", "=", "Arrays", ".", "asList", "(", "callerUgi", ".", "getGroupNames", "(", "))", ";", "if", "(", "groups", ".", "contains", "(", "supergroup", ")", ")", "{", "return", ";", "}", "/", "/", "Not", "a", "superuser", ".", "throw", "new", "AccessControlException", "(", ");", "}", "/", "**", "*", "Initialize", "the", "datanode", "'", "s", "periodic", "scanners", ":", "@", "@", "-", "704", ",", "6", "+", "740", ",", "11", "@", "@", "void", "startDataNode", "(", "Configuration", "conf", ",", "/", "/", "BlockPoolTokenSecretManager", "is", "required", "to", "create", "ipc", "server", ".", "this", ".", "blockPoolTokenSecretManager", "=", "new", "BlockPoolTokenSecretManager", "(", ");", "/", "/", "Login", "is", "done", "by", "now", ".", "Set", "the", "DN", "user", "name", ".", "dnUserName", "=", "UserGroupInformation", ".", "getCurrentUser", "(", ").", "getShortUserName", "(", ");", "LOG", ".", "info", "(", "\"", "dnUserName", "=", "\"", "+", "dnUserName", ")", ";", "LOG", ".", "info", "(", "\"", "supergroup", "=", "\"", "+", "supergroup", ")", ";", "initIpcServer", "(", "conf", ")", ";", "metrics", "=", "DataNodeMetrics", ".", "create", "(", "conf", ",", "getMachineName", "(", "))", ";", "@", "@", "-", "2230", ",", "13", "+", "2271", ",", "15", "@", "@", "public", "void", "refreshNamenodes", "(", "Configuration", "conf", ")", "throws", "IOException", "{", "@", "Override", "/", "/", "ClientDatanodeProtocol", "public", "void", "refreshNamenodes", "(", ")", "throws", "IOException", "{", "checkSuperuserPrivilege", "(", ");", "conf", "=", "new", "Configuration", "(", ");", "refreshNamenodes", "(", "conf", ")", ";", "}", "@", "Override", "/", "/", "ClientDatanodeProtocol", "public", "void", "deleteBlockPool", "(", "String", "blockPoolId", ",", "boolean", "force", ")", "throws", "IOException", "{", "checkSuperuserPrivilege", "(", ");", "LOG", ".", "info", "(", "\"", "deleteBlockPool", "command", "received", "for", "block", "pool", "\"", "+", "blockPoolId", "+", "\"", ",", "force", "=", "\"", "+", "force", ")", ";", "if", "(", "blockPoolManager", ".", "get", "(", "blockPoolId", ")", "!", "=", "null", ")", "{"], "docstring_tokens": ["by", "issuing", "a", "command", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "42", ",", "10", "+", "42", ",", "14", "@", "@", "struct", "usb_lcd", "{", "size_t", "bulk_in_size", ";", "/", "*", "the", "size", "of", "the", "receive", "buffer", "*", "/", "__u8", "bulk_in_endpointAddr", ";", "/", "*", "the", "address", "of", "the", "bulk", "in", "endpoint", "*", "/", "__u8", "bulk_out_endpointAddr", ";", "/", "*", "the", "address", "of", "the", "bulk", "out", "endpoint", "*", "/", "struct", "kref", "kref", ";", "struct", "kref", "kref", ";", "struct", "semaphore", "limit_sem", ";", "/", "*", "to", "stop", "writes", "at", "full", "throttle", "from", "*", "using", "up", "all", "RAM", "*", "/", "}", ";", "#", "define", "to_lcd_dev", "(", "d", ")", "container_of", "(", "d", ",", "struct", "usb_lcd", ",", "kref", ")", "#", "define", "USB_LCD_CONCURRENT_WRITES", "5", "static", "struct", "usb_driver", "lcd_driver", ";", "static", "DEFINE_MUTEX", "(", "usb_lcd_open_mutex", ")", ";", "@", "@", "-", "186", ",", "12", "+", "190", ",", "13", "@", "@", "static", "void", "lcd_write_bulk_callback", "(", "struct", "urb", "*", "urb", ")", "/", "*", "free", "up", "our", "allocated", "buffer", "*", "/", "usb_buffer_free", "(", "urb", "-", ">", "dev", ",", "urb", "-", ">", "transfer_buffer_length", ",", "urb", "-", ">", "transfer_buffer", ",", "urb", "-", ">", "transfer_dma", ")", ";", "up", "(", "&", "dev", "-", ">", "limit_sem", ")", ";", "}", "static", "ssize_t", "lcd_write", "(", "struct", "file", "*", "file", ",", "const", "char", "__user", "*", "user_buffer", ",", "size_t", "count", ",", "loff_t", "*", "ppos", ")", "{", "struct", "usb_lcd", "*", "dev", ";", "int", "retval", "=", "0", ";", "int", "retval", "=", "0", ",", "r", ";", "struct", "urb", "*", "urb", "=", "NULL", ";", "char", "*", "buf", "=", "NULL", ";", "@", "@", "-", "201", ",", "10", "+", "206", ",", "16", "@", "@", "static", "ssize_t", "lcd_write", "(", "struct", "file", "*", "file", ",", "const", "char", "__user", "*", "user_buffer", ",", "siz", "if", "(", "count", "=", "=", "0", ")", "goto", "exit", ";", "r", "=", "down_interruptible", "(", "&", "dev", "-", ">", "limit_sem", ")", ";", "if", "(", "r", "<", "0", ")", "return", "-", "EINTR", ";", "/", "*", "create", "a", "urb", ",", "and", "a", "buffer", "for", "it", ",", "and", "copy", "the", "data", "to", "the", "urb", "*", "/", "urb", "=", "usb_alloc_urb", "(", "0", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "urb", ")", "return", "-", "ENOMEM", ";", "if", "(", "!", "urb", ")", "{", "retval", "=", "-", "ENOMEM", ";", "goto", "err_no_buf", ";", "}", "buf", "=", "usb_buffer_alloc", "(", "dev", "-", ">", "udev", ",", "count", ",", "GFP_KERNEL", ",", "&", "urb", "-", ">", "transfer_dma", ")", ";", "if", "(", "!", "buf", ")", "{", "@", "@", "-", "239", ",", "6", "+", "250", ",", "8", "@", "@", "static", "ssize_t", "lcd_write", "(", "struct", "file", "*", "file", ",", "const", "char", "__user", "*", "user_buffer", ",", "siz", "error", ":", "usb_buffer_free", "(", "dev", "-", ">", "udev", ",", "count", ",", "buf", ",", "urb", "-", ">", "transfer_dma", ")", ";", "usb_free_urb", "(", "urb", ")", ";", "err_no_buf", ":", "up", "(", "&", "dev", "-", ">", "limit_sem", ")", ";", "return", "retval", ";", "}", "@", "@", "-", "277", ",", "6", "+", "290", ",", "7", "@", "@", "static", "int", "lcd_probe", "(", "struct", "usb_interface", "*", "interface", ",", "const", "struct", "usb_device_id", "goto", "error", ";", "}", "kref_init", "(", "&", "dev", "-", ">", "kref", ")", ";", "sema_init", "(", "&", "dev", "-", ">", "limit_sem", ",", "USB_LCD_CONCURRENT_WRITES", ")", ";", "dev", "-", ">", "udev", "=", "usb_get_dev", "(", "interface_to_usbdev", "(", "interface", ")", ");", "dev", "-", ">", "interface", "=", "interface", ";"], "docstring_tokens": ["writing", "an", "overly", "large", "amount", "of", "data"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "18", ",", "6", "+", "18", ",", "7", "@", "@", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "nio", ".", "charset", ".", "UnsupportedCharsetException", ";", "import", "java", ".", "security", ".", "SecureRandom", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "Collections", ";", "@", "@", "-", "45", ",", "7", "+", "46", ",", "7", "@", "@", "'", "B", "'", ",", "'", "C", "'", ",", "'", "D", "'", ",", "'", "E", "'", ",", "'", "F", "'", ",", "'", "G", "'", ",", "'", "H", "'", ",", "'", "I", "'", ",", "'", "J", "'", ",", "'", "K", "'", ",", "'", "L", "'", ",", "'", "M", "'", ",", "'", "N", "'", ",", "'", "O", "'", ",", "'", "P", "'", ",", "'", "Q", "'", ",", "'", "R", "'", ",", "'", "S", "'", ",", "'", "T", "'", ",", "'", "U", "'", ",", "'", "V", "'", ",", "'", "W", "'", ",", "'", "X", "'", ",", "'", "Y", "'", ",", "'", "Z", "'", "};", "private", "static", "final", "Random", "RND", "=", "new", "Random", "(", ");", "private", "static", "final", "Random", "RND", "=", "new", "SecureRandom", "(", ");", "/", "**", "*", "Comparator", "used", "by", "{", "@", "link", "#", "sortBySpecificity", "(", "List", ")", "}."], "docstring_tokens": ["sending", "a", "specially-crafted", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "7", ",", "6", "+", "7", ",", "10", "@", "@", "*", "max_comment_size", ":", "new", "option", "*", "promise", ":", "new", "API", "module", "#", "#", "Trunk", "*", "security", ":", "remove", "regexp", "vulnerable", "to", "DOS", "in", "cast", "option", ",", "npm", "report", "69742", "#", "#", "Version", "4", ".", "4", ".", "5", "*", "ts", ":", "add", "buffer", "as", "allowed", "type", "for", "input", ",", "fix", "#", "248", "@", "@", "-", "985", ",", "21", "+", "985", ",", "20", "@", "@", "function", "(", "_Transform", ")", "{", "}", "}", "if", "(", "this", ".", "__isInt", "(", "field", ")", "=", "==", "true", ")", "{", "return", "[", "undefined", ",", "parseInt", "(", "field", ")", "];", "}", "else", "if", "(", "this", ".", "__isFloat", "(", "field", ")", ")", "{", "if", "(", "this", ".", "__isFloat", "(", "field", ")", ")", "{", "return", "[", "undefined", ",", "parseFloat", "(", "field", ")", "];", "}", "else", "if", "(", "this", ".", "options", ".", "cast_date", "!", "==", "false", ")", "{", "return", "[", "undefined", ",", "this", ".", "options", ".", "cast_date", ".", "call", "(", "null", ",", "field", ",", "context", ")", "];", "}", "return", "[", "undefined", ",", "field", "]", ";", "}", "}", ",", "{", "key", ":", "\"", "__isInt", "\"", ",", "value", ":", "function", "__isInt", "(", "value", ")", "{", "return", "/", "^(", "\\-", "|\\", "+)", "?(", "[", "1", "-", "9", "]", "+[", "0", "-", "9", "]", "*)", "$/", ".", "test", "(", "value", ")", ";", "}", "}", "/", "/", "Keep", "it", "in", "case", "we", "implement", "the", "`", "cast_int", "`", "option", "/", "/", "__isInt", "(", "value", ")", "{", "/", "/", "/", "/", "return", "Number", ".", "isInteger", "(", "parseInt", "(", "value", ")", ")", "/", "/", "/", "/", "return", "!", "isNaN", "(", "parseInt", "(", "obj", ")", ")", ";", "/", "/", "return", "/", "^(", "\\-", "|\\", "+)", "?[", "1", "-", "9", "]", "[", "0", "-", "9", "]", "*$", "/.", "test", "(", "value", ")", "/", "/", "}", "}", ",", "{", "key", ":", "\"", "__isFloat", "\"", ",", "value", ":", "function", "__isFloat", "(", "value", ")", "{", "@", "@", "-", "747", ",", "18", "+", "747", ",", "19", "@", "@", "class", "Parser", "extends", "Transform", "{", "return", "[", "err", "]", "}", "}", "if", "(", "this", ".", "__isInt", "(", "field", ")", "=", "==", "true", ")", "{", "return", "[", "undefined", ",", "parseInt", "(", "field", ")", "]", "}", "else", "if", "(", "this", ".", "__isFloat", "(", "field", ")", "){", "if", "(", "this", ".", "__isFloat", "(", "field", ")", "){", "return", "[", "undefined", ",", "parseFloat", "(", "field", ")", "]", "}", "else", "if", "(", "this", ".", "options", ".", "cast_date", "!", "==", "false", ")", "{", "return", "[", "undefined", ",", "this", ".", "options", ".", "cast_date", ".", "call", "(", "null", ",", "field", ",", "context", ")", "]", "}", "return", "[", "undefined", ",", "field", "]", "}", "__isInt", "(", "value", ")", "{", "return", "/", "^(", "\\-", "|\\", "+)", "?(", "[", "1", "-", "9", "]", "+[", "0", "-", "9", "]", "*)", "$/", ".", "test", "(", "value", ")", "}", "/", "/", "Keep", "it", "in", "case", "we", "implement", "the", "`", "cast_int", "`", "option", "/", "/", "__isInt", "(", "value", ")", "{", "/", "/", "/", "/", "return", "Number", ".", "isInteger", "(", "parseInt", "(", "value", ")", ")", "/", "/", "/", "/", "return", "!", "isNaN", "(", "parseInt", "(", "obj", ")", ")", ";", "/", "/", "return", "/", "^(", "\\-", "|\\", "+)", "?[", "1", "-", "9", "]", "[", "0", "-", "9", "]", "*$", "/.", "test", "(", "value", ")", "/", "/", "}", "__isFloat", "(", "value", ")", "{", "return", "(", "value", "-", "parseFloat", "(", "value", ")", "+", "1", ")", ">", "=", "0", "/", "/", "Borrowed", "from", "jquery", "}", "@", "@", "-", "31", ",", "8", "+", "31", ",", "14", "@", "@", "describe", "'", "Option", "`", "cast", "`", "',", "-", ">", "parser", ".", "end", "(", ")", "it", "'", "ints", "'", ",", "(", "next", ")", "-", ">", "parse", "'", "123a", ",", "123", ",", "0123", ",", "',", "cast", ":", "true", ",", "(", "err", ",", "data", ")", "-", ">", "data", ".", "should", ".", "eql", "[", "[", "'", "123a", "'", ",", "123", ",", "123", ",", "'", "']", "]", "parse", "'", "123a", ",", "123", ",", "+", "123", ",", "-", "123", ",", "0123", ",", "+", "0123", ",", "-", "0123", ",", "',", "cast", ":", "true", ",", "(", "err", ",", "data", ")", "-", ">", "data", ".", "should", ".", "eql", "[", "[", "'", "123a", "'", ",", "123", ",", "123", ",", "-", "123", ",", "123", ",", "123", ",", "-", "123", ",", "'", "']", "]", "next", "(", ")", "it", "'", "ints", "isnt", "exposed", "to", "DOS", "vulnerabilities", ",", "npm", "security", "issue", "69742", "'", ",", "(", "next", ")", "-", ">", "data", "=", "Array", ".", "from", "(", "length", ":", "3000000", ")", ".", "map", "(", "(", "x", ")", "-", ">", "'", "1", "'", ")", ".", "join", "(", "''", ")", "+", "'", "!'", "parse", "data", ",", "cast", ":", "true", ",", "(", "err", ",", "data", ")", "-", ">", "data", "[", "0", "]", "[", "0", "]", ".", "length", ".", "should", ".", "eql", "3000001", "next", "(", ")", "it", "'", "float", "'", ",", "(", "next", ")", "-", ">", "@", "@", "-", "54", ",", "11", "+", "60", ",", "11", "@", "@", "describe", "'", "Option", "`", "cast", "`", "',", "-", ">", ",", "(", "err", ",", "records", ")", "-", ">", "records", ".", "should", ".", "eql", "[", "[", "'", "2000", "-", "01", "-", "01T05", ":", "00", ":", "00", ".", "000Z", "'", ",", "{", "column", ":", "1", ",", "empty_lines", ":", "0", ",", "header", ":", "false", ",", "index", ":", "1", ",", "column", ":", "1", ",", "empty_lines", ":", "0", ",", "header", ":", "false", ",", "index", ":", "1", ",", "invalid_field_length", ":", "0", ",", "lines", ":", "1", ",", "quoting", ":", "false", ",", "records", ":", "0", "}", "]", "[", "'", "2050", "-", "11", "-", "27T05", ":", "00", ":", "00", ".", "000Z", "'", ",", "{", "column", ":", "1", ",", "empty_lines", ":", "0", ",", "header", ":", "false", ",", "index", ":", "1", ",", "column", ":", "1", ",", "empty_lines", ":", "0", ",", "header", ":", "false", ",", "index", ":", "1", ",", "invalid_field_length", ":", "0", ",", "lines", ":", "2", ",", "quoting", ":", "false", ",", "records", ":", "1", "}", "]", "]", "unless", "err"], "docstring_tokens": ["sending", "a", "specially-crafted", "request", "using", "the", "cast", "option"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "99", ",", "6", "+", "99", ",", "10", "@", "@", "public", "BCryptPasswordEncoder", "(", "BCryptVersion", "version", ",", "int", "strength", ",", "SecureRandom", "r", "}", "public", "String", "encode", "(", "CharSequence", "rawPassword", ")", "{", "if", "(", "rawPassword", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "rawPassword", "cannot", "be", "null", "\"", ");", "}", "String", "salt", ";", "if", "(", "random", "!", "=", "null", ")", "{", "salt", "=", "BCrypt", ".", "gensalt", "(", "version", ".", "getVersion", "(", "),", "strength", ",", "random", ")", ";", "@", "@", "-", "109", ",", "6", "+", "113", ",", "10", "@", "@", "public", "String", "encode", "(", "CharSequence", "rawPassword", ")", "{", "}", "public", "boolean", "matches", "(", "CharSequence", "rawPassword", ",", "String", "encodedPassword", ")", "{", "if", "(", "rawPassword", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "rawPassword", "cannot", "be", "null", "\"", ");", "}", "if", "(", "encodedPassword", "=", "=", "null", "|", "|", "encodedPassword", ".", "length", "(", ")", "=", "=", "0", ")", "{", "logger", ".", "warn", "(", "\"", "Empty", "encoded", "password", "\"", ");", "return", "false", ";", "@", "@", "-", "200", ",", "4", "+", "200", ",", "16", "@", "@", "public", "void", "upgradeFromNonBCrypt", "(", ")", "{", "encoder", ".", "upgradeEncoding", "(", "\"", "not", "-", "a", "-", "bcrypt", "-", "password", "\"", ");", "}", "@", "Test", "(", "expected", "=", "IllegalArgumentException", ".", "class", ")", "public", "void", "encodeNullRawPassword", "(", ")", "{", "BCryptPasswordEncoder", "encoder", "=", "new", "BCryptPasswordEncoder", "(", ");", "encoder", ".", "encode", "(", "null", ")", ";", "}", "@", "Test", "(", "expected", "=", "IllegalArgumentException", ".", "class", ")", "public", "void", "matchNullRawPassword", "(", ")", "{", "BCryptPasswordEncoder", "encoder", "=", "new", "BCryptPasswordEncoder", "(", ");", "encoder", ".", "matches", "(", "null", ",", "\"", "does", "-", "not", "-", "matter", "\"", ");", "}", "}"], "docstring_tokens": ["using", "dictionary", "attack", "techniques"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "62", ",", "14", "+", "62", ",", "19", "@", "@", "}", "}", ",", "\"", "@", "handsontable", "/", "formulajs", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "@", "handsontable", "/", "formulajs", "/", "-/", "formulajs", "-", "2", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "PkH", "+", "27UaGV3VuMJpSv4XHsCPOgI", "=", "\",", "\"", "version", "\"", ":", "\"", "2", ".", "0", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "@", "handsontable", "/", "formulajs", "/", "-/", "formulajs", "-", "2", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "jTdJO", "/", "6ZmuaHoiTdnraGbPkdnA7m0VMrZ54vWXi22WpwnsIKAWbqjWTwvDoSuEpcc7", "/", "YHVIVlSDtfXHKmaYhdQ", "=", "=\"", ",", "\"", "requires", "\"", ":", "{", "\"", "bessel", "\"", ":", "\"", "^", "0", ".", "2", ".", "0", "\"", ",", "\"", "jStat", "\"", ":", "\"", "^", "1", ".", "7", ".", "0", "\"", "\"", "@", "handsontable", "/", "jstat", "\"", ":", "\"", "^", "1", ".", "0", ".", "0", "\"", ",", "\"", "bessel", "\"", ":", "\"", "^", "0", ".", "2", ".", "0", "\"", "}", "}", ",", "\"", "@", "handsontable", "/", "jstat", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "@", "handsontable", "/", "jstat", "/", "-/", "jstat", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "5XxZ9xIk6iSjrc1p5N", "/", "yI2dofBXp0IzZVgrkETDC196SxoJCRNOeKgM9fTHMhoxa02wuaZPLp6stojlppNxP", "/", "A", "=", "=\"", "}", ",", "\"", "JSONSelect", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "4", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "JSONSelect", "/", "-/", "JSONSelect", "-", "0", ".", "4", ".", "0", ".", "tgz", "\"", ",", "@", "@", "-", "131", ",", "7", "+", "136", ",", "7", "@", "@", "}", ",", "\"", "acorn", "-", "jsx", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "0", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "acorn", "-", "jsx", "/", "-/", "acorn", "-", "jsx", "-", "3", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "acorn", "-", "jsx", "/", "-/", "acorn", "-", "jsx", "-", "3", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "r9", "+", "UiPsezvyDSPb7IvRk4ypYs2s", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "140", ",", "7", "+", "145", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "acorn", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "3", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "acorn", "/", "-/", "acorn", "-", "3", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "acorn", "/", "-/", "acorn", "-", "3", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "ReN", "/", "s56No", "/", "JbruP", "/", "U2niu18iAXo", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "189", ",", "7", "+", "194", ",", "7", "@", "@", "}", ",", "\"", "ansi", "-", "escapes", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "1", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "3", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "3", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "UgAb8H9D41AQnu", "/", "PbWlCofQVcnV4Gs2bBJi9eZPxfU", "/", "hgglFh3SMDMENRIqdr7H6XFnXdoknctFByVsCOotTVw", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "325", ",", "7", "+", "330", ",", "7", "@", "@", "}", ",", "\"", "util", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "10", ".", "3", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "util", "/", "-/", "util", "-", "0", ".", "10", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "util", "/", "-/", "util", "-", "0", ".", "10", ".", "3", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "evsa", "/", "lCAUkZInj23", "/", "g7TeTNqwPk", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "635", ",", "7", "+", "640", ",", "7", "@", "@", "}", ",", "\"", "babel", "-", "plugin", "-", "istanbul", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "4", ".", "1", ".", "6", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "babel", "-", "plugin", "-", "istanbul", "/", "-/", "babel", "-", "plugin", "-", "istanbul", "-", "4", ".", "1", ".", "6", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "babel", "-", "plugin", "-", "istanbul", "/", "-/", "babel", "-", "plugin", "-", "istanbul", "-", "4", ".", "1", ".", "6", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "PWP9FQ1AhZhS01T", "/", "4qLSKoHGY", "/", "xvkZdVBGlKM", "/", "HuxxS3", "+", "sC66HhTNR7", "+", "MpbO", "/", "so", "/", "cz", "/", "wY94MeSWJuP1hXIPfwQ", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "653", ",", "7", "+", "658", ",", "7", "@", "@", "}", ",", "\"", "babel", "-", "plugin", "-", "syntax", "-", "object", "-", "rest", "-", "spread", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "6", ".", "13", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "babel", "-", "plugin", "-", "syntax", "-", "object", "-", "rest", "-", "spread", "/", "-/", "babel", "-", "plugin", "-", "syntax", "-", "object", "-", "rest", "-", "spread", "-", "6", ".", "13", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "babel", "-", "plugin", "-", "syntax", "-", "object", "-", "rest", "-", "spread", "/", "-/", "babel", "-", "plugin", "-", "syntax", "-", "object", "-", "rest", "-", "spread", "-", "6", ".", "13", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "/", "WU28rzhODb", "/", "o6VFjEkDpZe7O", "/", "U", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "1157", ",", "7", "+", "1162", ",", "7", "@", "@", "}", ",", "\"", "browserify", "-", "aes", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "2", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "browserify", "-", "aes", "/", "-/", "browserify", "-", "aes", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "browserify", "-", "aes", "/", "-/", "browserify", "-", "aes", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "+", "7CHXqGuspUn", "/", "Sl5aO7Ea0xWGAtETPXNSAjHo48JfLdPWcMng33Xe4znFvQweqc", "/", "uzk5zSOI3H52CYnjCfb5hA", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "1194", ",", "7", "+", "1199", ",", "7", "@", "@", "}", ",", "\"", "browserify", "-", "rsa", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "4", ".", "0", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "browserify", "-", "rsa", "/", "-/", "browserify", "-", "rsa", "-", "4", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "browserify", "-", "rsa", "/", "-/", "browserify", "-", "rsa", "-", "4", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "IeCr", "+", "vbyApzy", "+", "vsTNWenAdQTVSQ", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "1237", ",", "7", "+", "1242", ",", "7", "@", "@", "}", ",", "\"", "buffer", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "4", ".", "9", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "buffer", "/", "-/", "buffer", "-", "4", ".", "9", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "buffer", "/", "-/", "buffer", "-", "4", ".", "9", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "bRu2AbB6TvztlwlBMgkwJ8lbwpg", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "1343", ",", "7", "+", "1348", ",", "7", "@", "@", "}", ",", "\"", "chalk", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "3", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "chalk", "/", "-/", "chalk", "-", "1", ".", "1", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "chalk", "/", "-/", "chalk", "-", "1", ".", "1", ".", "3", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "qBFcVeSnAv5NFQq9OHKCKn4J", "/", "Jg", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "1738", ",", "7", "+", "1743", ",", "7", "@", "@", "}", ",", "\"", "create", "-", "hash", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "2", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "create", "-", "hash", "/", "-/", "create", "-", "hash", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "create", "-", "hash", "/", "-/", "create", "-", "hash", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "z00bCGNHDG8mHAkP7CtT1qVu", "+", "bFQUPjYq", "/", "4Iv3C3kWjTFV10zIjfSoeqXo9Asws8gwSHDGj", "/", "hl2u4OGIjapeCg", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "1751", ",", "7", "+", "1756", ",", "7", "@", "@", "}", ",", "\"", "create", "-", "hmac", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "7", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "create", "-", "hmac", "/", "-/", "create", "-", "hmac", "-", "1", ".", "1", ".", "7", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "create", "-", "hmac", "/", "-/", "create", "-", "hmac", "-", "1", ".", "1", ".", "7", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "MJG9liiZ", "+", "ogc4TzUwuvbER1JRdgvUFSB5", "+", "VR", "/", "g5h82fGaIRWMWddtKBHi7", "/", "sVhfjQZ6SehlyhvQYrcYkaUIpLg", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "1852", ",", "7", "+", "1857", ",", "7", "@", "@", "}", ",", "\"", "d", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "d", "/", "-/", "d", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "d", "/", "-/", "d", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "dUu1v", "+", "VUUdpppYuU1F9MWwRi1Y8", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "2044", ",", "7", "+", "2049", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "pify", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "3", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "7RQaasBDqEnqWISY59yosVMw6Qw", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "2099", ",", "7", "+", "2104", ",", "7", "@", "@", "}", ",", "\"", "diffie", "-", "hellman", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "5", ".", "0", ".", "3", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "diffie", "-", "hellman", "/", "-/", "diffie", "-", "hellman", "-", "5", ".", "0", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "diffie", "-", "hellman", "/", "-/", "diffie", "-", "hellman", "-", "5", ".", "0", ".", "3", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "kqag", "/", "Nl", "+", "f3GwyK25fhUMYj81BUOrZ9IuJsjIcDE5icNM9FJHAVm3VcUDxdLPoQtTuUylWm6ZIknYJwwaPxsUzg", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "2129", ",", "7", "+", "2134", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "domelementtype", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "3", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "domelementtype", "/", "-/", "domelementtype", "-", "1", ".", "1", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "domelementtype", "/", "-/", "domelementtype", "-", "1", ".", "1", ".", "3", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "vSh3PiZCiBrsUVRJJCmcXNgiGFs", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "2232", ",", "7", "+", "2237", ",", "7", "@", "@", "}", ",", "\"", "entities", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "entities", "/", "-/", "entities", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "entities", "/", "-/", "entities", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "sph6o4ITR", "/", "zeZCsk", "/", "fyeT7cSvyY", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "2408", ",", "7", "+", "2413", ",", "7", "@", "@", "}", ",", "\"", "eslint", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "4", ".", "19", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "eslint", "/", "-/", "eslint", "-", "4", ".", "19", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "eslint", "/", "-/", "eslint", "-", "4", ".", "19", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "bT3", "/", "1x1EbZB7phzYu7vCr1v3ONuzDtX8WjuM9c0iYxe", "+", "cq", "+", "pwcKEoQjl7zd3RpC6YOLgnSy3cTN58M2jcoPDIQ", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "2632", ",", "7", "+", "2637", ",", "7", "@", "@", "}", ",", "\"", "espree", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "5", ".", "4", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "espree", "/", "-/", "espree", "-", "3", ".", "5", ".", "4", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "espree", "/", "-/", "espree", "-", "3", ".", "5", ".", "4", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "yAcIQxtmMiB", "/", "jL32dzEp2enBeidsB7xWPLNiw3IIkpVds1P", "+", "h7qF9YwJq1yUNzp2OKXgAprs4F61ih66UsoD1A", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "2688", ",", "7", "+", "2693", ",", "7", "@", "@", "}", ",", "\"", "events", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "events", "/", "-/", "events", "-", "1", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "events", "/", "-/", "events", "-", "1", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "nr23Y1rQmccNzEwqH1AEKI6L2SQ", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "2816", ",", "7", "+", "2821", ",", "7", "@", "@", "}", ",", "\"", "external", "-", "editor", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "2", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "external", "-", "editor", "/", "-/", "external", "-", "editor", "-", "2", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "external", "-", "editor", "/", "-/", "external", "-", "editor", "-", "2", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "bSn6gvGxKt", "+", "b7", "+", "6TKEv1ZycHleA7aHhRHyAqJyp5pbUFuYYNIzpZnQDk7AsYckyWdEnTeAnay0aCy2aV6iTk9A", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "2848", ",", "7", "+", "2853", ",", "7", "@", "@", "}", ",", "\"", "fast", "-", "deep", "-", "equal", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "fast", "-", "deep", "-", "equal", "/", "-/", "fast", "-", "deep", "-", "equal", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "fast", "-", "deep", "-", "equal", "/", "-/", "fast", "-", "deep", "-", "equal", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "wFNHeBfIa1HaqFPIHgWbcz0CNhQ", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "3026", ",", "7", "+", "3031", ",", "8", "@", "@", "\"", "ansi", "-", "regex", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "1", ".", "1", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "aproba", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "2", ".", "0", "\"", ",", "@", "@", "-", "3047", ",", "12", "+", "3053", ",", "14", "@", "@", "\"", "balanced", "-", "match", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "0", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "brace", "-", "expansion", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "11", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "\"", "balanced", "-", "match", "\"", ":", "\"", "^", "1", ".", "0", ".", "0", "\"", ",", "\"", "concat", "-", "map", "\"", ":", "\"", "0", ".", "0", ".", "1", "\"", "@", "@", "-", "3067", ",", "17", "+", "3075", ",", "20", "@", "@", "\"", "code", "-", "point", "-", "at", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "0", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "concat", "-", "map", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "0", ".", "1", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "console", "-", "control", "-", "strings", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "0", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "core", "-", "util", "-", "is", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "2", "\"", ",", "@", "@", "-", "3194", ",", "7", "+", "3205", ",", "8", "@", "@", "\"", "inherits", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "0", ".", "3", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "ini", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "3", ".", "5", "\"", ",", "@", "@", "-", "3206", ",", "6", "+", "3218", ",", "7", "@", "@", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "0", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "\"", "number", "-", "is", "-", "nan", "\"", ":", "\"", "^", "1", ".", "0", ".", "0", "\"", "}", "@", "@", "-", "3220", ",", "19", "+", "3233", ",", "22", "@", "@", "\"", "version", "\"", ":", "\"", "3", ".", "0", ".", "4", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "\"", "brace", "-", "expansion", "\"", ":", "\"", "^", "1", ".", "1", ".", "7", "\"", "}", "}", ",", "\"", "minimist", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "0", ".", "8", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "minipass", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "2", ".", "4", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "\"", "safe", "-", "buffer", "\"", ":", "\"", "^", "5", ".", "1", ".", "1", "\"", ",", "\"", "yallist", "\"", ":", "\"", "^", "3", ".", "0", ".", "0", "\"", "@", "@", "-", "3251", ",", "6", "+", "3267", ",", "7", "@", "@", "\"", "version", "\"", ":", "\"", "0", ".", "5", ".", "1", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "\"", "minimist", "\"", ":", "\"", "0", ".", "0", ".", "8", "\"", "}", "@", "@", "-", "3331", ",", "7", "+", "3348", ",", "8", "@", "@", "\"", "number", "-", "is", "-", "nan", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "1", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "object", "-", "assign", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "4", ".", "1", ".", "1", "\"", ",", "@", "@", "-", "3343", ",", "6", "+", "3361", ",", "7", "@", "@", "\"", "version", "\"", ":", "\"", "1", ".", "4", ".", "0", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "\"", "wrappy", "\"", ":", "\"", "1", "\"", "}", "@", "@", "-", "3428", ",", "7", "+", "3447", ",", "8", "@", "@", "\"", "safe", "-", "buffer", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "5", ".", "1", ".", "1", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "safer", "-", "buffer", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "1", ".", "2", "\"", ",", "@", "@", "-", "3464", ",", "6", "+", "3484", ",", "7", "@", "@", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "2", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "\"", "code", "-", "point", "-", "at", "\"", ":", "\"", "^", "1", ".", "0", ".", "0", "\"", ",", "\"", "is", "-", "fullwidth", "-", "code", "-", "point", "\"", ":", "\"", "^", "1", ".", "0", ".", "0", "\"", ",", "@", "@", "-", "3483", ",", "6", "+", "3504", ",", "7", "@", "@", "\"", "version", "\"", ":", "\"", "3", ".", "0", ".", "1", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "\"", "ansi", "-", "regex", "\"", ":", "\"", "^", "2", ".", "0", ".", "0", "\"", "}", "@", "@", "-", "3526", ",", "12", "+", "3548", ",", "14", "@", "@", "\"", "wrappy", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "2", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "yallist", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "0", ".", "2", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", "}", "}", ",", "@", "@", "-", "3567", ",", "7", "+", "3591", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "ansi", "-", "escapes", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "4", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "1", ".", "4", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "1", ".", "4", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "06ioOzGapneTZisT52HHkRQiMG4", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "3582", ",", "7", "+", "3606", ",", "7", "@", "@", "}", ",", "\"", "external", "-", "editor", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "external", "-", "editor", "/", "-/", "external", "-", "editor", "-", "1", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "external", "-", "editor", "/", "-/", "external", "-", "editor", "-", "1", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "Etew24UPf", "/", "fnCBuvQAVwAGDEYAs", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "3603", ",", "7", "+", "3627", ",", "7", "@", "@", "}", ",", "\"", "inquirer", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "2", ".", "3", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "inquirer", "/", "-/", "inquirer", "-", "1", ".", "2", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "inquirer", "/", "-/", "inquirer", "-", "1", ".", "2", ".", "3", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "TexvMvN", "+", "97sLLtPx0aXD9UUHSRg", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "3625", ",", "7", "+", "3649", ",", "7", "@", "@", "}", ",", "\"", "minimist", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "2", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "minimist", "/", "-/", "minimist", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "minimist", "/", "-/", "minimist", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "o1AIsg9BOD7sH7kU9M1d95omQoQ", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "3681", ",", "7", "+", "3705", ",", "7", "@", "@", "}", ",", "\"", "get", "-", "stream", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "get", "-", "stream", "/", "-/", "get", "-", "stream", "-", "3", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "get", "-", "stream", "/", "-/", "get", "-", "stream", "-", "3", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "jpQ9E1jcN1VQVOy", "+", "LtsFqhdO3hQ", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "3755", ",", "7", "+", "3779", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "pify", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "3", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "7RQaasBDqEnqWISY59yosVMw6Qw", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "3963", ",", "7", "+", "3987", ",", "7", "@", "@", "}", ",", "\"", "htmlparser2", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "8", ".", "3", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "htmlparser2", "/", "-/", "htmlparser2", "-", "3", ".", "8", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "htmlparser2", "/", "-/", "htmlparser2", "-", "3", ".", "8", ".", "3", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "mWwosZFRaovoZQGn15dX5ccMEGg", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "3982", ",", "7", "+", "4006", ",", "7", "@", "@", "}", ",", "\"", "readable", "-", "stream", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "14", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "readable", "-", "stream", "/", "-/", "readable", "-", "stream", "-", "1", ".", "1", ".", "14", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "readable", "-", "stream", "/", "-/", "readable", "-", "stream", "-", "1", ".", "1", ".", "14", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "fPTFTvZI44EwhMY23SB54WbAgdk", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "4185", ",", "7", "+", "4209", ",", "7", "@", "@", "}", ",", "\"", "is", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "2", ".", "7", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "is", "/", "-/", "is", "-", "0", ".", "2", ".", "7", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "is", "/", "-/", "is", "-", "0", ".", "2", ".", "7", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "OzSixI81mXLzUEKEkZOucmS2NWI", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "4221", ",", "7", "+", "4245", ",", "7", "@", "@", "}", ",", "\"", "is", "-", "builtin", "-", "module", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "is", "-", "builtin", "-", "module", "/", "-/", "is", "-", "builtin", "-", "module", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "is", "-", "builtin", "-", "module", "/", "-/", "is", "-", "builtin", "-", "module", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "VAVy0096wxGfj3bDDLwbHgN6", "/", "74", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "4597", ",", "11", "+", "4621", ",", "6", "@", "@", "\"", "handlebars", "\"", ":", "\"", "^", "4", ".", "0", ".", "3", "\"", "}", "}", ",", "\"", "jStat", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "7", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "jStat", "/", "-/", "jStat", "-", "1", ".", "7", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "toueem", "/", "U5hyHM6pqe6OZOL", "/", "5P8MrY7Ss1K8Brg", "+", "TcfX", "+", "RAjDU", "/", "sbwy72fwzmLPQ5ykdBe1UEoWQHc7OSNWMUDQ", "=", "=\"", "}", ",", "\"", "jest", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "23", ".", "6", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "jest", "/", "-/", "jest", "-", "23", ".", "6", ".", "0", ".", "tgz", "\"", ",", "@", "@", "-", "5646", ",", "7", "+", "5665", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "commander", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "9", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "commander", "/", "-/", "commander", "-", "2", ".", "9", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "commander", "/", "-/", "commander", "-", "2", ".", "9", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "nJkJQXbhIkDLItbFFGCYQA", "/", "g99Q", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "5689", ",", "7", "+", "5708", ",", "7", "@", "@", "}", ",", "\"", "lodash", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "10", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "W", "/", "Rejkm6QYnhfUgnid", "/", "RW9FAt7Y", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "5743", ",", "7", "+", "5762", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "lodash", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "10", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "W", "/", "Rejkm6QYnhfUgnid", "/", "RW9FAt7Y", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "5821", ",", "7", "+", "5840", ",", "7", "@", "@", "}", ",", "\"", "json5", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "5", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "json5", "/", "-/", "json5", "-", "0", ".", "5", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "json5", "/", "-/", "json5", "-", "0", ".", "5", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "Hq3nrMASA0rYTiOWdn6tn6VJWCE", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "5943", ",", "7", "+", "5962", ",", "7", "@", "@", "}", ",", "\"", "load", "-", "json", "-", "file", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "load", "-", "json", "-", "file", "/", "-/", "load", "-", "json", "-", "file", "-", "2", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "load", "-", "json", "-", "file", "/", "-/", "load", "-", "json", "-", "file", "-", "2", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "eUfkIUmvgNaWy", "/", "eXvKq8", "/", "h", "/", "inKg", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "5955", ",", "7", "+", "5974", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "pify", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "3", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "7RQaasBDqEnqWISY59yosVMw6Qw", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "6196", ",", "7", "+", "6215", ",", "7", "@", "@", "}", ",", "\"", "minimist", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "0", ".", "8", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "minimist", "/", "-/", "minimist", "-", "0", ".", "0", ".", "8", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "minimist", "/", "-/", "minimist", "-", "0", ".", "0", ".", "8", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "hX", "/", "Kv8M5fSYluCKCYuhqp6ARsF0", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "6223", ",", "7", "+", "6242", ",", "7", "@", "@", "}", ",", "\"", "mkdirp", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "5", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "mkdirp", "/", "-/", "mkdirp", "-", "0", ".", "5", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "mkdirp", "/", "-/", "mkdirp", "-", "0", ".", "5", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "MAV0OOrGz3", "+", "MR2fzhkjWaX11yQM", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "6296", ",", "7", "+", "6315", ",", "7", "@", "@", "}", ",", "\"", "ncp", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "4", ".", "2", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ncp", "/", "-/", "ncp", "-", "0", ".", "4", ".", "2", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ncp", "/", "-/", "ncp", "-", "0", ".", "4", ".", "2", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "q8xsvT7C7Spyn", "/", "bnwfqPAXhKhXQ", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "6308", ",", "7", "+", "6327", ",", "7", "@", "@", "}", ",", "\"", "next", "-", "tick", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "next", "-", "tick", "/", "-/", "next", "-", "tick", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "next", "-", "tick", "/", "-/", "next", "-", "tick", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "yobR", "/", "ogoFpsBICCOPchCS524NCw", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "6377", ",", "7", "+", "6396", ",", "7", "@", "@", "}", ",", "\"", "node", ".", "extend", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "8", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "node", ".", "extend", "/", "-/", "node", ".", "extend", "-", "1", ".", "0", ".", "8", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "node", ".", "extend", "/", "-/", "node", ".", "extend", "-", "1", ".", "0", ".", "8", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "urBDefc4P0WHmQyd8Htqf2Xbdys", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "6559", ",", "13", "+", "6578", ",", "13", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "ansi", "-", "escapes", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "4", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "1", ".", "4", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "1", ".", "4", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "06ioOzGapneTZisT52HHkRQiMG4", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "\"", "lodash", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "10", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "W", "/", "Rejkm6QYnhfUgnid", "/", "RW9FAt7Y", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "6705", ",", "7", "+", "6724", ",", "7", "@", "@", "}", ",", "\"", "parse", "-", "asn1", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "5", ".", "1", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "parse", "-", "asn1", "/", "-/", "parse", "-", "asn1", "-", "5", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "parse", "-", "asn1", "/", "-/", "parse", "-", "asn1", "-", "5", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "KPx7flKXg775zZpnp9SxJlz00gTd4BmJ2yJufSc44gMCRrRQ7NSzAcSJQfifuOLgW6bEi", "+", "ftrALtsgALeB2Adw", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "6802", ",", "7", "+", "6821", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "pify", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "3", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "7RQaasBDqEnqWISY59yosVMw6Qw", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "7111", ",", "7", "+", "7130", ",", "7", "@", "@", "}", ",", "\"", "readable", "-", "stream", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "3", ".", "6", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "readable", "-", "stream", "/", "-/", "readable", "-", "stream", "-", "2", ".", "3", ".", "6", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "readable", "-", "stream", "/", "-/", "readable", "-", "stream", "-", "2", ".", "3", ".", "6", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "tQtKA9WIAhBF3", "+", "VLAseyMqZeBjW0AHJoxOtYqSUZNJxauErmLbVm2FW1y", "+", "J", "/", "YA9dUrAC39ITejlZWhVIwawkKw", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "7473", ",", "7", "+", "7492", ",", "7", "@", "@", "}", ",", "\"", "regexpp", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "regexpp", "/", "-/", "regexpp", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "regexpp", "/", "-/", "regexpp", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "LOPw8FpgdQF9etWMaAfG", "/", "WRthIdXJGYp4mJ2Jgn", "/", "2lpkbod9jPn0t9UqN7AxBOKNfzRbYyVfgc7Vk4t", "/", "MpnXgw", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "7490", ",", "7", "+", "7509", ",", "7", "@", "@", "}", ",", "\"", "regjsgen", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "2", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "regjsgen", "/", "-/", "regjsgen", "-", "0", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "regjsgen", "/", "-/", "regjsgen", "-", "0", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "bAFq3qxVT3WCP", "+", "N6wFuS1aTtsfc", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "7755", ",", "7", "+", "7774", ",", "7", "@", "@", "}", ",", "\"", "safe", "-", "regex", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "safe", "-", "regex", "/", "-/", "safe", "-", "regex", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "safe", "-", "regex", "/", "-/", "safe", "-", "regex", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "QKNmnzsHfR6UPURinhV91IAjvy4", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "8126", ",", "7", "+", "8145", ",", "7", "@", "@", "}", ",", "\"", "sha", ".", "js", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "4", ".", "11", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "sha", ".", "js", "/", "-/", "sha", ".", "js", "-", "2", ".", "4", ".", "11", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "sha", ".", "js", "/", "-/", "sha", ".", "js", "-", "2", ".", "4", ".", "11", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "QMEp5B7cftE7APOjk5Y6xgrbWu", "+", "WkLVQwk8JNjZ8nKRciZaByEW6MubieAiToS7", "+", "dwvrjGhH8jRXz3MVd0AYqQ", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "8545", ",", "7", "+", "8564", ",", "7", "@", "@", "}", ",", "\"", "strip", "-", "ansi", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "0", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "strip", "-", "ansi", "/", "-/", "strip", "-", "ansi", "-", "3", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "strip", "-", "ansi", "/", "-/", "strip", "-", "ansi", "-", "3", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "ajhfuIU9lS1f8F0Oiq", "+", "UJ43GPc8", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "8560", ",", "7", "+", "8579", ",", "7", "@", "@", "}", ",", "\"", "strip", "-", "eof", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "strip", "-", "eof", "/", "-/", "strip", "-", "eof", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "strip", "-", "eof", "/", "-/", "strip", "-", "eof", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "u0P", "/", "VZim6wXYm1n80SnJgzE2Br8", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "8645", ",", "7", "+", "8664", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "rimraf", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "2", ".", "8", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "rimraf", "/", "-/", "rimraf", "-", "2", ".", "2", ".", "8", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "rimraf", "/", "-/", "rimraf", "-", "2", ".", "2", ".", "8", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "5Dm", "+", "Kq7jJzIZUnMPmaiSnk", "/", "FBYI", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "8759", ",", "7", "+", "8778", ",", "7", "@", "@", "}", ",", "\"", "through", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "3", ".", "8", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "through", "/", "-/", "through", "-", "2", ".", "3", ".", "8", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "through", "/", "-/", "through", "-", "2", ".", "3", ".", "8", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "DdTJ", "/", "6q8NXlgsbckEV1", "+", "Doai4fU", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "9199", ",", "7", "+", "9218", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "async", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "2", ".", "10", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "async", "/", "-/", "async", "-", "0", ".", "2", ".", "10", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "async", "/", "-/", "async", "-", "0", ".", "2", ".", "10", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "trvgsGdLnXGXCMo43owjfLUmw9E", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "9275", ",", "7", "+", "9294", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "uuid", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "0", ".", "3", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "uuid", "/", "-/", "uuid", "-", "2", ".", "0", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "uuid", "/", "-/", "uuid", "-", "2", ".", "0", ".", "3", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "Z", "+", "LoY3lyFVMN", "/", "zGOW", "/", "nc6", "/", "1Hsho", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "9851", ",", "7", "+", "9870", ",", "7", "@", "@", "}", ",", "\"", "winston", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "8", ".", "3", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "winston", "/", "-/", "winston", "-", "0", ".", "8", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "winston", "/", "-/", "winston", "-", "0", ".", "8", ".", "3", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "ZLar9M0Brcrv1QCTk7HY6L7BnbA", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "9866", ",", "7", "+", "9885", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "async", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "2", ".", "10", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "async", "/", "-/", "async", "-", "0", ".", "2", ".", "10", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "async", "/", "-/", "async", "-", "0", ".", "2", ".", "10", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "trvgsGdLnXGXCMo43owjfLUmw9E", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "9892", ",", "7", "+", "9911", ",", "7", "@", "@", "}", ",", "\"", "wrap", "-", "ansi", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "1", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "wrap", "-", "ansi", "/", "-/", "wrap", "-", "ansi", "-", "2", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "wrap", "-", "ansi", "/", "-/", "wrap", "-", "ansi", "-", "2", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "2Pw9KE3QV5T", "+", "hJc8rs3Rz4JP3YU", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "9956", ",", "7", "+", "9975", ",", "7", "@", "@", "}", ",", "\"", "xmlbuilder", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "1", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "xmlbuilder", "/", "-/", "xmlbuilder", "-", "3", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "xmlbuilder", "/", "-/", "xmlbuilder", "-", "3", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "LIaIjy1OrehQ", "+", "jjKf3Ij9yCVFuE", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "9965", ",", "7", "+", "9984", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "lodash", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "10", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "W", "/", "Rejkm6QYnhfUgnid", "/", "RW9FAt7Y", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "19", ",", "7", "+", "19", ",", "7", "@", "@", "\"", "build", ":", "umd", "\"", ":", "\"", "cross", "-", "env", "BABEL_ENV", "=", "commonjs", "NODE_ENV", "=", "development", "webpack", "src", "/", "index", ".", "js", "dist", "/", "formula", "-", "parser", ".", "js", "\"", ",", "\"", "generate", "-", "parser", "\"", ":", "\"", "cd", "src", "/", "grammar", "-", "parser", "&", "&", "jison", "grammar", "-", "parser", ".", "jison", "\"", ",", "\"", "release", "\"", ":", "\"", "generate", "-", "release", "\"", ",", "\"", "prepublish", "\"", ":", "\"", "npm", "run", "clean", "&", "&", "npm", "run", "check", "&", "&", "npm", "run", "build", "&", "&", "check", "-", "es3", "-", "syntax", "lib", "/", "dist", "/", "-", "-", "kill", "-", "-", "print", "\"", "\"", "prepublish", "\"", ":", "\"", "npm", "run", "clean", "&", "&", "npm", "run", "check", "&", "&", "npm", "run", "build", "\"", "}", ",", "\"", "repository", "\"", ":", "{", "\"", "type", "\"", ":", "\"", "git", "\"", ",", "@", "@", "-", "82", ",", "7", "+", "82", ",", "7", "@", "@", "\"", "webpack", "\"", ":", "\"", "^", "3", ".", "2", ".", "0", "\"", "}", ",", "\"", "dependencies", "\"", ":", "{", "\"", "@", "handsontable", "/", "formulajs", "\"", ":", "\"", "^", "2", ".", "0", ".", "0", "\"", ",", "\"", "@", "handsontable", "/", "formulajs", "\"", ":", "\"", "^", "2", ".", "0", ".", "1", "\"", ",", "\"", "tiny", "-", "emitter", "\"", ":", "\"", "^", "2", ".", "0", ".", "1", "\"", "}", ",", "\"", "jest", "\"", ":", "{", "@", "@", "-", "187", ",", "14", "+", "187", ",", "7", "@", "@", "expseq", "$", "$", "=", "[", "$", "1", "]", ";", "}", "|", "ARRAY", "{", "var", "result", "=", "[", "];", "var", "arr", "=", "eval", "(", "\"[", "\"", "+", "yytext", "+", "\"", "]\"", ");", "arr", ".", "forEach", "(", "function", "(", "item", ")", "{", "result", ".", "push", "(", "item", ")", ";", "}", ");", "$", "$", "=", "result", ";", "$", "$", "=", "yy", ".", "trimEdges", "(", "yytext", ")", ".", "split", "(", "',", "')", ";", "}", "|", "expseq", "'", ";'", "expression", "{", "$", "1", ".", "push", "(", "$", "3", ")", ";", "@", "@", "-", "1", ",", "4", "+", "1", ",", "4", "@", "@", "/", "*", "parser", "generated", "by", "jison", "0", ".", "4", ".", "17", "*", "/", "/", "*", "parser", "generated", "by", "jison", "0", ".", "4", ".", "18", "*", "/", "/", "*", "Returns", "a", "Parser", "object", "of", "the", "following", "structure", ":", "@", "@", "-", "73", ",", "7", "+", "73", ",", "7", "@", "@", "*", "/", "var", "grammarParser", "=", "(", "function", "(", "){", "var", "o", "=", "function", "(", "k", ",", "v", ",", "o", ",", "l", ")", "{", "for", "(", "o", "=", "o", "|", "|{", "},", "l", "=", "k", ".", "length", ";", "l", "-", "-;", "o", "[", "k", "[", "l", "]", "]=", "v", ")", ";", "return", "o", "}", ",$", "V0", "=", "[", "1", ",", "5", "]", ",$", "V1", "=", "[", "1", ",", "8", "]", ",$", "V2", "=", "[", "1", ",", "6", "]", ",$", "V3", "=", "[", "1", ",", "7", "]", ",$", "V4", "=", "[", "1", ",", "9", "]", ",$", "V5", "=", "[", "1", ",", "14", "]", ",$", "V6", "=", "[", "1", ",", "15", "]", ",$", "V7", "=", "[", "1", ",", "16", "]", ",$", "V8", "=", "[", "1", ",", "12", "]", ",$", "V9", "=", "[", "1", ",", "13", "]", ",$", "Va", "=", "[", "1", ",", "17", "]", ",$", "Vb", "=", "[", "1", ",", "19", "]", ",$", "Vc", "=", "[", "1", ",", "20", "]", ",$", "Vd", "=", "[", "1", ",", "21", "]", ",$", "Ve", "=", "[", "1", ",", "22", "]", ",$", "Vf", "=", "[", "1", ",", "23", "]", ",$", "Vg", "=", "[", "1", ",", "24", "]", ",$", "Vh", "=", "[", "1", ",", "25", "]", ",$", "Vi", "=", "[", "1", ",", "26", "]", ",$", "Vj", "=", "[", "1", ",", "27", "]", ",$", "Vk", "=", "[", "1", ",", "28", "]", ",$", "Vl", "=", "[", "5", ",", "9", ",", "10", ",", "11", ",", "13", ",", "14", ",", "15", ",", "16", ",", "17", ",", "18", ",", "19", ",", "20", ",", "29", ",", "30", "]", ",$", "Vm", "=", "[", "5", ",", "9", ",", "10", ",", "11", ",", "13", ",", "14", ",", "15", ",", "16", ",", "17", ",", "18", ",", "19", ",", "20", ",", "29", ",", "30", ",", "32", "]", ",$", "Vn", "=", "[", "5", ",", "9", ",", "10", ",", "11", ",", "13", ",", "14", ",", "15", ",", "16", ",", "17", ",", "18", ",", "19", ",", "20", ",", "29", ",", "30", ",", "34", "]", ",$", "Vo", "=", "[", "5", ",", "10", ",", "11", ",", "13", ",", "14", ",", "15", ",", "16", ",", "17", ",", "29", ",", "30", "]", ",$", "Vp", "=", "[", "5", ",", "10", ",", "13", ",", "14", ",", "15", ",", "16", ",", "29", ",", "30", "]", ",$", "Vq", "=", "[", "5", ",", "10", ",", "11", ",", "13", ",", "14", ",", "15", ",", "16", ",", "17", ",", "18", ",", "19", ",", "29", ",", "30", "]", ",$", "Vr", "=", "[", "13", ",", "29", ",", "30", "]", ";", "var", "parser", "=", "{", "trace", ":", "function", "trace", "(", ")", "{", "}", ",", "var", "parser", "=", "{", "trace", ":", "function", "trace", "(", ")", "{", "}", ",", "yy", ":", "{", "},", "symbols_", ":", "{", "\"", "error", "\"", ":", "2", ",", "\"", "expressions", "\"", ":", "3", ",", "\"", "expression", "\"", ":", "4", ",", "\"", "EOF", "\"", ":", "5", ",", "\"", "variableSequence", "\"", ":", "6", ",", "\"", "number", "\"", ":", "7", ",", "\"", "STRING", "\"", ":", "8", ",", "\"&", "\":", "9", ",", "\"=", "\":", "10", ",", "\"+", "\":", "11", ",", "\"(", "\":", "12", ",", "\")", "\":", "13", ",", "\"<", "\":", "14", ",", "\">", "\":", "15", ",", "\"", "NOT", "\"", ":", "16", ",", "\"-", "\":", "17", ",", "\"*", "\":", "18", ",", "\"/", "\":", "19", ",", "\"^", "\":", "20", ",", "\"", "FUNCTION", "\"", ":", "21", ",", "\"", "expseq", "\"", ":", "22", ",", "\"", "cell", "\"", ":", "23", ",", "\"", "ABSOLUTE_CELL", "\"", ":", "24", ",", "\"", "RELATIVE_CELL", "\"", ":", "25", ",", "\"", "MIXED_CELL", "\"", ":", "26", ",", "\":", "\":", "27", ",", "\"", "ARRAY", "\"", ":", "28", ",", "\";", "\":", "29", ",", "\",", "\":", "30", ",", "\"", "VARIABLE", "\"", ":", "31", ",", "\"", "DECIMAL", "\"", ":", "32", ",", "\"", "NUMBER", "\"", ":", "33", ",", "\"%", "\":", "34", ",", "\"", "ERROR", "\"", ":", "35", ",", "\"$", "accept", "\"", ":", "0", ",", "\"$", "end", "\"", ":", "1", "}", ",", "terminals_", ":", "{", "5", ":", "\"", "EOF", "\"", ",", "8", ":", "\"", "STRING", "\"", ",", "9", ":", "\"&", "\",", "10", ":", "\"=", "\",", "11", ":", "\"+", "\",", "12", ":", "\"(", "\",", "13", ":", "\")", "\",", "14", ":", "\"<", "\",", "15", ":", "\">", "\",", "16", ":", "\"", "NOT", "\"", ",", "17", ":", "\"-", "\",", "18", ":", "\"*", "\",", "19", ":", "\"/", "\",", "20", ":", "\"^", "\",", "21", ":", "\"", "FUNCTION", "\"", ",", "24", ":", "\"", "ABSOLUTE_CELL", "\"", ",", "25", ":", "\"", "RELATIVE_CELL", "\"", ",", "26", ":", "\"", "MIXED_CELL", "\"", ",", "27", ":", "\":", "\",", "28", ":", "\"", "ARRAY", "\"", ",", "29", ":", "\";", "\",", "30", ":", "\",", "\",", "31", ":", "\"", "VARIABLE", "\"", ",", "32", ":", "\"", "DECIMAL", "\"", ",", "33", ":", "\"", "NUMBER", "\"", ",", "34", ":", "\"%", "\",", "35", ":", "\"", "ERROR", "\"", "},", "@", "@", "-", "222", ",", "14", "+", "222", ",", "7", "@", "@", "case", "38", ":", "case", "42", ":", "break", ";", "case", "39", ":", "var", "result", "=", "[", "];", "var", "arr", "=", "eval", "(", "\"[", "\"", "+", "yytext", "+", "\"", "]\"", ");", "arr", ".", "forEach", "(", "function", "(", "item", ")", "{", "result", ".", "push", "(", "item", ")", ";", "}", ");", "this", ".", "$", "=", "result", ";", "this", ".", "$", "=", "yy", ".", "trimEdges", "(", "yytext", ")", ".", "split", "(", "',", "')", ";", "break", ";", "case", "40", ":", "case", "41", ":", "@", "@", "-", "268", ",", "20", "+", "261", ",", "16", "@", "@", "break", ";", "}", ",", "table", ":", "[", "{", "2", ":", "11", ",", "3", ":", "1", ",", "4", ":", "2", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "1", ":", "[", "3", "]", "},", "{", "5", ":", "[", "1", ",", "18", "]", ",", "9", ":", "$", "Vb", ",", "10", ":", "$", "Vc", ",", "11", ":", "$", "Vd", ",", "14", ":", "$", "Ve", ",", "15", ":", "$", "Vf", ",", "16", ":", "$", "Vg", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", ",", "o", "(", "$", "Vl", ",", "[", "2", ",", "2", "]", ",{", "32", ":", "[", "1", ",", "29", "]", "})", ",", "o", "(", "$", "Vl", ",", "[", "2", ",", "3", "]", ",{", "34", ":", "[", "1", ",", "30", "]", "})", ",", "o", "(", "$", "Vl", ",", "[", "2", ",", "4", "]", "),", "{", "2", ":", "11", ",", "4", ":", "31", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "32", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "33", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "12", ":", "[", "1", ",", "34", "]", "},", "o", "(", "$", "Vl", ",", "[", "2", ",", "23", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "24", "]", ",{", "2", ":", "35", ",", "35", ":", "$", "Va", "}", "),", "o", "(", "$", "Vm", ",", "[", "2", ",", "42", "]", "),", "o", "(", "$", "Vn", ",", "[", "2", ",", "44", "]", ",{", "32", ":", "[", "1", ",", "36", "]", "})", ",", "o", "(", "$", "Vl", ",", "[", "2", ",", "26", "]", ",{", "27", ":", "[", "1", ",", "37", "]", "})", ",", "o", "(", "$", "Vl", ",", "[", "2", ",", "27", "]", ",{", "27", ":", "[", "1", ",", "38", "]", "})", ",", "o", "(", "$", "Vl", ",", "[", "2", ",", "28", "]", ",{", "27", ":", "[", "1", ",", "39", "]", "})", ",", "o", "(", "[", "5", ",", "9", ",", "10", ",", "11", ",", "13", ",", "14", ",", "15", ",", "16", ",", "17", ",", "18", ",", "19", ",", "20", ",", "29", ",", "30", ",", "35", "]", ",[", "2", ",", "47", "]", "),", "{", "1", ":", "[", "2", ",", "1", "]", "},", "{", "2", ":", "11", ",", "4", ":", "40", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "41", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "42", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "45", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "10", ":", "[", "1", ",", "43", "]", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "15", ":", "[", "1", ",", "44", "]", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "47", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "10", ":", "[", "1", ",", "46", "]", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "48", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "49", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "50", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "51", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "52", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "31", ":", "[", "1", ",", "53", "]", "},", "o", "(", "$", "Vn", ",", "[", "2", ",", "46", "]", "),", "{", "9", ":", "$", "Vb", ",", "10", ":", "$", "Vc", ",", "11", ":", "$", "Vd", ",", "13", ":", "[", "1", ",", "54", "]", ",", "14", ":", "$", "Ve", ",", "15", ":", "$", "Vf", ",", "16", ":", "$", "Vg", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", ",", "o", "(", "$", "Vo", ",", "[", "2", ",", "19", "]", ",{", "9", ":", "$", "Vb", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vo", ",", "[", "2", ",", "20", "]", ",{", "9", ":", "$", "Vb", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "{", "2", ":", "11", ",", "4", ":", "57", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "13", ":", "[", "1", ",", "55", "]", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "22", ":", "56", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "28", ":", "[", "1", ",", "58", "]", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",", "o", "(", "$", "Vl", ",", "[", "2", ",", "25", "]", "),", "{", "33", ":", "[", "1", ",", "59", "]", "},", "{", "24", ":", "[", "1", ",", "60", "]", ",", "25", ":", "[", "1", ",", "61", "]", ",", "26", ":", "[", "1", ",", "62", "]", "},", "{", "24", ":", "[", "1", ",", "63", "]", ",", "25", ":", "[", "1", ",", "64", "]", ",", "26", ":", "[", "1", ",", "65", "]", "},", "{", "24", ":", "[", "1", ",", "66", "]", ",", "25", ":", "[", "1", ",", "67", "]", ",", "26", ":", "[", "1", ",", "68", "]", "},", "o", "(", "$", "Vl", ",", "[", "2", ",", "5", "]", "),", "o", "(", "[", "5", ",", "10", ",", "13", ",", "29", ",", "30", "]", ",[", "2", ",", "6", "]", ",{", "9", ":", "$", "Vb", ",", "11", ":", "$", "Vd", ",", "14", ":", "$", "Ve", ",", "15", ":", "$", "Vf", ",", "16", ":", "$", "Vg", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vo", ",", "[", "2", ",", "7", "]", ",{", "9", ":", "$", "Vb", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "{", "2", ":", "11", ",", "4", ":", "69", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "70", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",", "o", "(", "$", "Vp", ",", "[", "2", ",", "14", "]", ",{", "9", ":", "$", "Vb", ",", "11", ":", "$", "Vd", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "{", "2", ":", "11", ",", "4", ":", "71", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",", "o", "(", "$", "Vp", ",", "[", "2", ",", "13", "]", ",{", "9", ":", "$", "Vb", ",", "11", ":", "$", "Vd", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "[", "5", ",", "10", ",", "13", ",", "16", ",", "29", ",", "30", "]", ",[", "2", ",", "12", "]", ",{", "9", ":", "$", "Vb", ",", "11", ":", "$", "Vd", ",", "14", ":", "$", "Ve", ",", "15", ":", "$", "Vf", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vo", ",", "[", "2", ",", "15", "]", ",{", "9", ":", "$", "Vb", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vq", ",", "[", "2", ",", "16", "]", ",{", "9", ":", "$", "Vb", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vq", ",", "[", "2", ",", "17", "]", ",{", "9", ":", "$", "Vb", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "[", "5", ",", "10", ",", "11", ",", "13", ",", "14", ",", "15", ",", "16", ",", "17", ",", "18", ",", "19", ",", "20", ",", "29", ",", "30", "]", ",[", "2", ",", "18", "]", ",{", "9", ":", "$", "Vb", "}", "),", "o", "(", "$", "Vm", ",", "[", "2", ",", "43", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "8", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "21", "]", "),", "{", "13", ":", "[", "1", ",", "72", "]", ",", "29", ":", "[", "1", ",", "73", "]", ",", "30", ":", "[", "1", ",", "74", "]", "},", "o", "(", "$", "Vr", ",", "[", "2", ",", "38", "]", ",{", "9", ":", "$", "Vb", ",", "10", ":", "$", "Vc", ",", "11", ":", "$", "Vd", ",", "14", ":", "$", "Ve", ",", "15", ":", "$", "Vf", ",", "16", ":", "$", "Vg", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vr", ",", "[", "2", ",", "39", "]", "),", "o", "(", "$", "Vn", ",", "[", "2", ",", "45", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "29", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "30", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "31", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "32", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "33", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "34", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "35", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "36", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "37", "]", "),", "o", "(", "$", "Vp", ",", "[", "2", ",", "9", "]", ",{", "9", ":", "$", "Vb", ",", "11", ":", "$", "Vd", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vp", ",", "[", "2", ",", "11", "]", ",{", "9", ":", "$", "Vb", ",", "11", ":", "$", "Vd", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vp", ",", "[", "2", ",", "10", "]", ",{", "9", ":", "$", "Vb", ",", "11", ":", "$", "Vd", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "22", "]", "),", "{", "2", ":", "11", ",", "4", ":", "75", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "76", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",", "o", "(", "$", "Vr", ",", "[", "2", ",", "40", "]", ",{", "9", ":", "$", "Vb", ",", "10", ":", "$", "Vc", ",", "11", ":", "$", "Vd", ",", "14", ":", "$", "Ve", ",", "15", ":", "$", "Vf", ",", "16", ":", "$", "Vg", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vr", ",", "[", "2", ",", "41", "]", ",{", "9", ":", "$", "Vb", ",", "10", ":", "$", "Vc", ",", "11", ":", "$", "Vd", ",", "14", ":", "$", "Ve", ",", "15", ":", "$", "Vf", ",", "16", ":", "$", "Vg", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", ")]", ",", "defaultActions", ":", "{", "18", ":", "[", "2", ",", "1", "]", "},", "parseError", ":", "function", "parseError", "(", "str", ",", "hash", ")", "{", "parseError", ":", "function", "parseError", "(", "str", ",", "hash", ")", "{", "if", "(", "hash", ".", "recoverable", ")", "{", "this", ".", "trace", "(", "str", ")", ";", "}", "else", "{", "function", "_parseError", "(", "msg", ",", "hash", ")", "{", "this", ".", "message", "=", "msg", ";", "this", ".", "hash", "=", "hash", ";", "}", "_parseError", ".", "prototype", "=", "Error", ";", "throw", "new", "_parseError", "(", "str", ",", "hash", ")", ";", "var", "error", "=", "new", "Error", "(", "str", ")", ";", "error", ".", "hash", "=", "hash", ";", "throw", "error", ";", "}", "}", ",", "parse", ":", "function", "parse", "(", "input", ")", "{", "parse", ":", "function", "parse", "(", "input", ")", "{", "var", "self", "=", "this", ",", "stack", "=", "[", "0", "]", ",", "tstack", "=", "[", "],", "/", "/", "token", "stack", "@", "@", "-", "331", ",", "6", "+", "320", ",", "7", "@", "@", "parse", ":", "function", "parse", "(", "input", ")", "{", "lstack", ".", "length", "=", "lstack", ".", "length", "-", "n", ";", "}", "_token_stack", ":", "var", "lex", "=", "function", "(", ")", "{", "var", "token", ";", "token", "=", "lexer", ".", "lex", "(", ")", "|", "|", "EOF", ";", "@", "@", "-", "357", ",", "6", "+", "347", ",", "7", "@", "@", "parse", ":", "function", "parse", "(", "input", ")", "{", "action", "=", "table", "[", "state", "]", "&", "&", "table", "[", "state", "]", "[", "symbol", "]", ";", "}", "_handle_error", ":", "/", "/", "handle", "parse", "error", "if", "(", "typeof", "action", "=", "==", "'", "undefined", "'", "|", "|", "!", "action", ".", "length", "|", "|", "!", "action", "[", "0", "]", ")", "{", "var", "error_rule_depth", ";", "@", "@", "-", "660", ",", "7", "+", "651", ",", "7", "@", "@", "showPosition", ":", "function", "(", ")", "{", "}", ",", "/", "/", "test", "the", "lexed", "token", ":", "return", "FALSE", "when", "not", "a", "match", ",", "otherwise", "return", "token", "test_match", ":", "function", "(", "match", ",", "indexed_rule", ")", "{", "test_match", ":", "function", "(", "match", ",", "indexed_rule", ")", "{", "var", "token", ",", "lines", ",", "backup", ";", "@", "@", "-", "790", ",", "7", "+", "781", ",", "7", "@", "@", "next", ":", "function", "(", ")", "{", "}", ",", "/", "/", "return", "next", "match", "that", "has", "a", "token", "lex", ":", "function", "lex", "(", ")", "{", "lex", ":", "function", "lex", "(", ")", "{", "var", "r", "=", "this", ".", "next", "(", ");", "if", "(", "r", ")", "{", "return", "r", ";", "@", "@", "-", "800", ",", "12", "+", "791", ",", "12", "@", "@", "lex", ":", "function", "lex", "(", ")", "{", "}", ",", "/", "/", "activates", "a", "new", "lexer", "condition", "state", "(", "pushes", "the", "new", "lexer", "condition", "state", "onto", "the", "condition", "stack", ")", "begin", ":", "function", "begin", "(", "condition", ")", "{", "begin", ":", "function", "begin", "(", "condition", ")", "{", "this", ".", "conditionStack", ".", "push", "(", "condition", ")", ";", "}", ",", "/", "/", "pop", "the", "previously", "active", "lexer", "condition", "state", "off", "the", "condition", "stack", "popState", ":", "function", "popState", "(", ")", "{", "popState", ":", "function", "popState", "(", ")", "{", "var", "n", "=", "this", ".", "conditionStack", ".", "length", "-", "1", ";", "if", "(", "n", ">", "0", ")", "{", "return", "this", ".", "conditionStack", ".", "pop", "(", ");", "@", "@", "-", "815", ",", "7", "+", "806", ",", "7", "@", "@", "popState", ":", "function", "popState", "(", ")", "{", "}", ",", "/", "/", "produce", "the", "lexer", "rule", "set", "which", "is", "active", "for", "the", "currently", "active", "lexer", "condition", "state", "_currentRules", ":", "function", "_currentRules", "(", ")", "{", "_currentRules", ":", "function", "_currentRules", "(", ")", "{", "if", "(", "this", ".", "conditionStack", ".", "length", "&", "&", "this", ".", "conditionStack", "[", "this", ".", "conditionStack", ".", "length", "-", "1", "]", ")", "{", "return", "this", ".", "conditions", "[", "this", ".", "conditionStack", "[", "this", ".", "conditionStack", ".", "length", "-", "1", "]", "].", "rules", ";", "}", "else", "{", "@", "@", "-", "824", ",", "7", "+", "815", ",", "7", "@", "@", "_currentRules", ":", "function", "_currentRules", "(", ")", "{", "}", ",", "/", "/", "return", "the", "currently", "active", "lexer", "condition", "state", ";", "when", "an", "index", "argument", "is", "provided", "it", "produces", "the", "N", "-", "th", "previous", "condition", "state", ",", "if", "available", "topState", ":", "function", "topState", "(", "n", ")", "{", "topState", ":", "function", "topState", "(", "n", ")", "{", "n", "=", "this", ".", "conditionStack", ".", "length", "-", "1", "-", "Math", ".", "abs", "(", "n", "|", "|", "0", ")", ";", "if", "(", "n", ">", "=", "0", ")", "{", "return", "this", ".", "conditionStack", "[", "n", "]", ";", "@", "@", "-", "834", ",", "7", "+", "825", ",", "7", "@", "@", "topState", ":", "function", "topState", "(", "n", ")", "{", "}", ",", "/", "/", "alias", "for", "begin", "(", "condition", ")", "pushState", ":", "function", "pushState", "(", "condition", ")", "{", "pushState", ":", "function", "pushState", "(", "condition", ")", "{", "this", ".", "begin", "(", "condition", ")", ";", "}", ",", "@", "@", "-", "940", ",", "7", "+", "931", ",", "4", "@", "@", "if", "(", "typeof", "require", "!", "==", "'", "undefined", "'", "&", "&", "typeof", "exports", "!", "==", "'", "undefined", "'", ")", "{", "exports", ".", "parser", "=", "grammarParser", ";", "exports", ".", "Parser", "=", "grammarParser", ".", "Parser", ";", "exports", ".", "parse", "=", "function", "(", ")", "{", "return", "grammarParser", ".", "parse", ".", "apply", "(", "grammarParser", ",", "arguments", ")", ";", "}", ";", "if", "(", "typeof", "module", "!", "==", "'", "undefined", "'", "&", "&", "require", ".", "main", "=", "==", "module", ")", "{", "exports", ".", "main", "(", "process", ".", "argv", ".", "slice", "(", "1", ")", ");", "}", "}", "@", "@", "-", "24", ",", "4", "+", "24", ",", "10", "@", "@", "describe", "(", "'.", "parse", "(", ")", "custom", "function", "'", ",", "(", ")", "=", ">", "{", "expect", "(", "parser", ".", "parse", "(", "'", "SUM", "(", "4", ",", "ADD_5", "(", "1", ")", ")'", "))", ".", "toMatchObject", "(", "{", "error", ":", "null", ",", "result", ":", "10", "}", ");", "expect", "(", "parser", ".", "parse", "(", "'", "GET_LETTER", "(", "\"", "Some", "string", "\"", ",", "3", ")", "')", ").", "toMatchObject", "(", "{", "error", ":", "null", ",", "result", ":", "'", "m", "'", "})", ";", "}", ");", "it", "(", "'", "should", "evaluate", "function", "with", "arguments", "passed", "as", "an", "stringified", "array", "'", ",", "(", ")", "=", ">", "{", "expect", "(", "parser", ".", "parse", "(", "'", "SUM", "(", "[]", ")'", "))", ".", "toMatchObject", "(", "{", "error", ":", "null", ",", "result", ":", "0", "}", ");", "expect", "(", "parser", ".", "parse", "(", "'", "SUM", "(", "[", "1", "]", ")'", "))", ".", "toMatchObject", "(", "{", "error", ":", "null", ",", "result", ":", "1", "}", ");", "expect", "(", "parser", ".", "parse", "(", "'", "SUM", "(", "[", "1", ",", "2", ",", "3", "]", ")'", "))", ".", "toMatchObject", "(", "{", "error", ":", "null", ",", "result", ":", "6", "}", ");", "}", ");", "}", ");"], "docstring_tokens": ["sending", "specially-crafted", "requests"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "3067", ",", "7", "+", "3067", ",", "10", "@", "@", "static", "int", "raw_cmd_copyout", "(", "int", "cmd", ",", "void", "__user", "*", "param", ",", "int", "ret", ";", "while", "(", "ptr", ")", "{", "ret", "=", "copy_to_user", "(", "param", ",", "ptr", ",", "sizeof", "(", "*", "ptr", ")", ");", "struct", "floppy_raw_cmd", "cmd", "=", "*", "ptr", ";", "cmd", ".", "next", "=", "NULL", ";", "cmd", ".", "kernel_data", "=", "NULL", ";", "ret", "=", "copy_to_user", "(", "param", ",", "&", "cmd", ",", "sizeof", "(", "cmd", ")", ");", "if", "(", "ret", ")", "return", "-", "EFAULT", ";", "param", "+", "=", "sizeof", "(", "struct", "floppy_raw_cmd", ")", ";"], "docstring_tokens": ["by", "leveraging", "write", "access", "to", "a", "/dev/fd", "device", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "4741", ",", "6", "+", "4741", ",", "7", "@", "@", "PHP_FUNCTION", "(", "openssl_encrypt", ")", "if", "(", "free_iv", ")", "{", "efree", "(", "iv", ")", ";", "}", "EVP_CIPHER_CTX_cleanup", "(", "&", "cipher_ctx", ")", ";", "}", "/", "*", "}", "}}", "*", "/", "@", "@", "-", "0", ",", "0", "+", "1", ",", "17", "@", "@", "-", "-", "TEST", "-", "-", "Bug", "#", "54060", "(", "Memory", "leak", "in", "openssl_encrypt", ")", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "\"", "openssl", "\"", "))", "die", "(", "\"", "skip", "\"", ");", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "data", "=", "\"", "jfdslkjvflsdkjvlkfjvlkjfvlkdm", ",", "4w", "043920r", "9234r", "32904r", "09243", "r7", "-", "89437", "r892374", "r894372", "r894", "7289r7", "f", "frwerfh", "i", "iurf", "iuryw", "uyrfouiwy", "ruy", "972439", "8478942", "yrhfjkdhls", "\"", ";", "$", "pass", "=", "\"", "r23498rui324hjbnkj", "\"", ";", "openssl_encrypt", "(", "$", "data", ",", "'", "des3", "'", ",", "$", "pass", ",", "false", ",", "'", "1qazxsw2", "'", ");", "echo", "\"", "Done", "\"", ";", "?", ">", "-", "-", "EXPECT", "-", "-", "Done"], "docstring_tokens": ["using", "plaintext", "data"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "281", ",", "13", "+", "281", ",", "10", "@", "@", "snd_seq_oss_open", "(", "struct", "file", "*", "file", ",", "int", "level", ")", "return", "0", ";", "_error", ":", "snd_seq_oss_writeq_delete", "(", "dp", "-", ">", "writeq", ")", ";", "snd_seq_oss_readq_delete", "(", "dp", "-", ">", "readq", ")", ";", "snd_seq_oss_synth_cleanup", "(", "dp", ")", ";", "snd_seq_oss_midi_cleanup", "(", "dp", ")", ";", "delete_port", "(", "dp", ")", ";", "delete_seq_queue", "(", "dp", "-", ">", "queue", ")", ";", "kfree", "(", "dp", ")", ";", "delete_port", "(", "dp", ")", ";", "return", "rc", ";", "}", "@", "@", "-", "350", ",", "8", "+", "347", ",", "10", "@", "@", "create_port", "(", "struct", "seq_oss_devinfo", "*", "dp", ")", "static", "int", "delete_port", "(", "struct", "seq_oss_devinfo", "*", "dp", ")", "{", "if", "(", "dp", "-", ">", "port", "<", "0", ")", "if", "(", "dp", "-", ">", "port", "<", "0", ")", "{", "kfree", "(", "dp", ")", ";", "return", "0", ";", "}", "debug_printk", "(", "(\"", "delete_port", "%", "i", "\\", "n", "\"", ",", "dp", "-", ">", "port", ")", ");", "return", "snd_seq_event_port_detach", "(", "dp", "-", ">", "cseq", ",", "dp", "-", ">", "port", ")", ";"], "docstring_tokens": ["via", "an", "unsuccessful", "attempt", "to", "open", "the", "/dev/sequencer", "device", "."]}
