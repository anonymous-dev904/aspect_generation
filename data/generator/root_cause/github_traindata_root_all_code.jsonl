{"contents": ["empty"], "code_tokens": ["@", "@", "-", "43", ",", "6", "+", "43", ",", "11", "@", "@", "import", "org", ".", "springframework", ".", "security", ".", "config", ".", "http", ".", "SessionCreationPolicy", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "authentication", ".", "AnonymousAuthenticationFilter", ";", "import", "org", ".", "springframework", ".", "security", ".", "web", ".", "authentication", ".", "preauth", ".", "x509", ".", "X509PrincipalExtractor", ";", "import", "org", ".", "springframework", ".", "web", ".", "cors", ".", "CorsConfiguration", ";", "import", "org", ".", "springframework", ".", "web", ".", "cors", ".", "CorsConfigurationSource", ";", "import", "org", ".", "springframework", ".", "web", ".", "cors", ".", "UrlBasedCorsConfigurationSource", ";", "import", "java", ".", "util", ".", "Arrays", ";", "/", "**", "*", "NiFi", "Web", "Api", "Spring", "security", "@", "@", "-", "89", ",", "6", "+", "94", ",", "7", "@", "@", "public", "void", "configure", "(", "WebSecurity", "webSecurity", ")", "throws", "Exception", "{", "@", "Override", "protected", "void", "configure", "(", "HttpSecurity", "http", ")", "throws", "Exception", "{", "http", ".", "cors", "(", ").", "and", "(", ")", ".", "rememberMe", "(", ").", "disable", "(", ")", ".", "authorizeRequests", "(", ")", ".", "anyRequest", "(", ").", "fullyAuthenticated", "(", ")", "@", "@", "-", "112", ",", "6", "+", "118", ",", "16", "@", "@", "protected", "void", "configure", "(", "HttpSecurity", "http", ")", "throws", "Exception", "{", "http", ".", "anonymous", "(", ").", "authenticationFilter", "(", "anonymousFilterBean", "(", "))", ";", "}", "@", "Bean", "CorsConfigurationSource", "corsConfigurationSource", "(", ")", "{", "CorsConfiguration", "configuration", "=", "new", "CorsConfiguration", "(", ");", "configuration", ".", "setAllowedMethods", "(", "Arrays", ".", "asList", "(", "\"", "HEAD", "\"", ",", "\"", "GET", "\"", "))", ";", "UrlBasedCorsConfigurationSource", "source", "=", "new", "UrlBasedCorsConfigurationSource", "(", ");", "source", ".", "registerCorsConfiguration", "(", "\"/", "process", "-", "groups", "/", "*/", "templates", "/", "upload", "\"", ",", "configuration", ")", ";", "return", "source", ";", "}", "@", "Bean", "@", "Override", "public", "AuthenticationManager", "authenticationManagerBean", "(", ")", "throws", "Exception", "{"], "docstring_tokens": ["improper", "validation", "of", "user-supplied", "input"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "31", ",", "6", "+", "31", ",", "8", "@", "@", "{", "final", "private", "StringBuilder", "sb", "=", "new", "StringBuilder", "(", ");", "private", "boolean", "escapeHtml", ";", "/", "**", "*", "Creates", "Json", "result", "string", "from", "the", "given", "list", ".", "<", "br", "/", ">", "*", "[", "[\"", "Horst", "\"", "],", "[", "\"", "Klaus", "\"", "],", ".", "..", "]]", "/", "/", "For", "single", "property", "<", "br", "/", ">", "@", "@", "-", "49", ",", "6", "+", "51", ",", "16", "@", "@", "public", "static", "String", "buildToStringRows", "(", "final", "Collection", "<", "?", ">", "col", ")", "return", "builder", ".", "append", "(", "col", ")", ".", "getAsString", "(", ");", "}", "/", "**", "*", "@", "param", "escapeHtml", "the", "escapeHtml", "to", "set", "(", "default", "is", "false", ")", ".", "*", "@", "return", "this", "for", "chaining", ".", "*", "/", "public", "JsonBuilder", "setEscapeHtml", "(", "final", "boolean", "escapeHtml", ")", "{", "this", ".", "escapeHtml", "=", "escapeHtml", ";", "return", "this", ";", "}", "public", "String", "getAsString", "(", ")", "{", "return", "sb", ".", "toString", "(", ");", "@", "@", "-", "117", ",", "7", "+", "129", ",", "32", "@", "@", "private", "String", "escapeString", "(", "final", "String", "string", ")", "t", "=", "\"", "000", "\"", "+", "Integer", ".", "toHexString", "(", "c", ")", ";", "sb", ".", "append", "(", "\"\\", "\\", "u", "\"", "+", "t", ".", "substring", "(", "t", ".", "length", "(", ")", "-", "4", ")", ");", "}", "else", "{", "sb", ".", "append", "(", "c", ")", ";", "if", "(", "escapeHtml", "=", "=", "true", ")", "{", "switch", "(", "c", ")", "{", "case", "'", "<'", ":", "sb", ".", "append", "(", "\"&", "lt", ";", "\")", ";", "break", ";", "case", "'", ">'", ":", "sb", ".", "append", "(", "\"&", "gt", ";", "\")", ";", "break", ";", "case", "'", "&'", ":", "sb", ".", "append", "(", "\"&", "amp", ";", "\")", ";", "break", ";", "case", "'", "\"'", ":", "sb", ".", "append", "(", "\"&", "quot", ";", "\")", ";", "break", ";", "case", "'", "\\'", "':", "sb", ".", "append", "(", "\"&", "#", "x27", ";", "\")", ";", "break", ";", "case", "'", "/'", ":", "sb", ".", "append", "(", "\"&", "#", "x2F", ";", "\")", ";", "break", ";", "default", ":", "sb", ".", "append", "(", "c", ")", ";", "}", "}", "else", "{", "sb", ".", "append", "(", "c", ")", ";", "}", "}", "}", "}", "@", "@", "-", "245", ",", "6", "+", "245", ",", "11", "@", "@", "protected", "String", "formatLabel", "(", "final", "T", "value", ")", "private", "class", "MyJsonBuilder", "extends", "JsonBuilder", "{", "private", "MyJsonBuilder", "(", ")", "{", "setEscapeHtml", "(", "true", ")", ";", "}", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "@", "Override", "protected", "String", "formatValue", "(", "final", "Object", "obj", ")"], "docstring_tokens": ["improper", "validation", "of", "user-supplied", "input"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "54", ",", "7", "+", "54", ",", "7", "@", "@", "static", "__inline__", "int", "scm_check_creds", "(", "struct", "ucred", "*", "creds", ")", "return", "-", "EINVAL", ";", "if", "(", "(", "creds", "-", ">", "pid", "=", "=", "task_tgid_vnr", "(", "current", ")", "|", "|", "ns_capable", "(", "current", "-", ">", "nsproxy", "-", ">", "pid_ns", "-", ">", "user_ns", ",", "CAP_SYS_ADMIN", ")", ")", "&", "&", "ns_capable", "(", "task_active_pid_ns", "(", "current", ")", "->", "user_ns", ",", "CAP_SYS_ADMIN", ")", ")", "&", "&", "(", "(", "uid_eq", "(", "uid", ",", "cred", "-", ">", "uid", ")", "|", "|", "uid_eq", "(", "uid", ",", "cred", "-", ">", "euid", ")", "|", "|", "uid_eq", "(", "uid", ",", "cred", "-", ">", "suid", ")", ")", "|", "|", "nsown_capable", "(", "CAP_SETUID", ")", ")", "&", "&", "(", "(", "gid_eq", "(", "gid", ",", "cred", "-", ">", "gid", ")", "|", "|", "gid_eq", "(", "gid", ",", "cred", "-", ">", "egid", ")", "|", "|"], "docstring_tokens": ["performs", "a", "capability", "check", "in", "an", "incorrect", "namespace"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "271", ",", "7", "+", "271", ",", "7", "@", "@", "struct", "synth_operations", "void", "(", "*", "reset", ")", "(", "int", "dev", ")", ";", "void", "(", "*", "hw_control", ")", "(", "int", "dev", ",", "unsigned", "char", "*", "event", ")", ";", "int", "(", "*", "load_patch", ")", "(", "int", "dev", ",", "int", "format", ",", "const", "char", "__user", "*", "addr", ",", "int", "offs", ",", "int", "count", ",", "int", "pmgr_flag", ")", ";", "int", "count", ",", "int", "pmgr_flag", ")", ";", "void", "(", "*", "aftertouch", ")", "(", "int", "dev", ",", "int", "voice", ",", "int", "pressure", ")", ";", "void", "(", "*", "controller", ")", "(", "int", "dev", ",", "int", "voice", ",", "int", "ctrl_num", ",", "int", "value", ")", ";", "void", "(", "*", "panning", ")", "(", "int", "dev", ",", "int", "voice", ",", "int", "value", ")", ";", "@", "@", "-", "476", ",", "7", "+", "476", ",", "7", "@", "@", "EXPORT_SYMBOL", "(", "midi_synth_hw_control", ")", ";", "int", "midi_synth_load_patch", "(", "int", "dev", ",", "int", "format", ",", "const", "char", "__user", "*", "addr", ",", "int", "offs", ",", "int", "count", ",", "int", "pmgr_flag", ")", "int", "count", ",", "int", "pmgr_flag", ")", "{", "int", "orig_dev", "=", "synth_devs", "[", "dev", "]", "->", "midi_dev", ";", "@", "@", "-", "491", ",", "33", "+", "491", ",", "29", "@", "@", "midi_synth_load_patch", "(", "int", "dev", ",", "int", "format", ",", "const", "char", "__user", "*", "addr", ",", "if", "(", "!", "prefix_cmd", "(", "orig_dev", ",", "0xf0", ")", ")", "return", "0", ";", "/", "*", "Invalid", "patch", "format", "*", "/", "if", "(", "format", "!", "=", "SYSEX_PATCH", ")", "{", "/", "*", "printk", "(", "\"", "MIDI", "Error", ":", "Invalid", "patch", "format", "(", "key", ")", "0x", "%", "x", "\\", "n", "\"", ",", "format", ")", ";*", "/", "return", "-", "EINVAL", ";", "}", "/", "*", "Patch", "header", "too", "short", "*", "/", "if", "(", "count", "<", "hdr_size", ")", "{", "/", "*", "printk", "(", "\"", "MIDI", "Error", ":", "Patch", "header", "too", "short", "\\", "n", "\"", ");", "*/", "return", "-", "EINVAL", ";", "}", "count", "-", "=", "hdr_size", ";", "/", "*", "*", "Copy", "the", "header", "from", "user", "space", "but", "ignore", "the", "first", "bytes", "which", "have", "*", "been", "transferred", "already", ".", "*", "Copy", "the", "header", "from", "user", "space", "*", "/", "if", "(", "copy_from_user", "(", "&(", "(", "char", "*", ")", "&", "sysex", ")", "[", "offs", "]", ",", "&", "(", "addr", ")", "[", "offs", "]", ",", "hdr_size", "-", "offs", ")", ")", "if", "(", "copy_from_user", "(", "&", "sysex", ",", "addr", ",", "hdr_size", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "count", "<", "sysex", ".", "len", ")", "{", "/", "*", "printk", "(", "KERN_WARNING", "\"", "MIDI", "Warning", ":", "Sysex", "record", "too", "short", "(", "%", "d", "<", "%", "d", ")", "\\", "n", "\"", ",", "count", ",", "(", "int", ")", "sysex", ".", "len", ")", ";*", "/", "/", "*", "Sysex", "record", "too", "short", "*", "/", "if", "(", "(", "unsigned", ")", "count", "<", "(", "unsigned", ")", "sysex", ".", "len", ")", "sysex", ".", "len", "=", "count", ";", "}", "left", "=", "sysex", ".", "len", ";", "src_offs", "=", "0", ";", "left", "=", "sysex", ".", "len", ";", "src_offs", "=", "0", ";", "for", "(", "i", "=", "0", ";", "i", "<", "left", "&", "&", "!", "signal_pending", "(", "current", ")", ";", "i", "+", "+)", "{", "@", "@", "-", "8", ",", "7", "+", "8", ",", "7", "@", "@", "int", "midi_synth_open", "(", "int", "dev", ",", "int", "mode", ")", ";", "void", "midi_synth_close", "(", "int", "dev", ")", ";", "void", "midi_synth_hw_control", "(", "int", "dev", ",", "unsigned", "char", "*", "event", ")", ";", "int", "midi_synth_load_patch", "(", "int", "dev", ",", "int", "format", ",", "const", "char", "__user", "*", "addr", ",", "int", "offs", ",", "int", "count", ",", "int", "pmgr_flag", ")", ";", "int", "count", ",", "int", "pmgr_flag", ")", ";", "void", "midi_synth_panning", "(", "int", "dev", ",", "int", "channel", ",", "int", "pressure", ")", ";", "void", "midi_synth_aftertouch", "(", "int", "dev", ",", "int", "channel", ",", "int", "pressure", ")", ";", "void", "midi_synth_controller", "(", "int", "dev", ",", "int", "channel", ",", "int", "ctrl_num", ",", "int", "value", ")", ";", "@", "@", "-", "820", ",", "7", "+", "820", ",", "7", "@", "@", "static", "void", "opl3_hw_control", "(", "int", "dev", ",", "unsigned", "char", "*", "event", ")", "}", "static", "int", "opl3_load_patch", "(", "int", "dev", ",", "int", "format", ",", "const", "char", "__user", "*", "addr", ",", "int", "offs", ",", "int", "count", ",", "int", "pmgr_flag", ")", "int", "count", ",", "int", "pmgr_flag", ")", "{", "struct", "sbi_instrument", "ins", ";", "@", "@", "-", "830", ",", "11", "+", "830", ",", "7", "@", "@", "static", "int", "opl3_load_patch", "(", "int", "dev", ",", "int", "format", ",", "const", "char", "__user", "*", "addr", ",", "return", "-", "EINVAL", ";", "}", "/", "*", "*", "What", "the", "fuck", "is", "going", "on", "here", "?", "We", "leave", "junk", "in", "the", "beginning", "*", "of", "ins", "and", "then", "check", "the", "field", "pretty", "close", "to", "that", "beginning", "?", "*", "/", "if", "(", "copy_from_user", "(", "&(", "(", "char", "*", ")", "&", "ins", ")", "[", "offs", "]", ",", "addr", "+", "offs", ",", "sizeof", "(", "ins", ")", "-", "offs", ")", ")", "if", "(", "copy_from_user", "(", "&", "ins", ",", "addr", ",", "sizeof", "(", "ins", ")", "))", "return", "-", "EFAULT", ";", "if", "(", "ins", ".", "channel", "<", "0", "|", "|", "ins", ".", "channel", ">", "=", "SBFM_MAXINSTR", ")", "@", "@", "-", "241", ",", "7", "+", "241", ",", "7", "@", "@", "int", "sequencer_write", "(", "int", "dev", ",", "struct", "file", "*", "file", ",", "const", "char", "__user", "*", "buf", ",", "int", "coun", "return", "-", "ENXIO", ";", "fmt", "=", "(", "*(", "short", "*", ")", "&", "event_rec", "[", "0", "]", ")", "&", "0xffff", ";", "err", "=", "synth_devs", "[", "dev", "]", "->", "load_patch", "(", "dev", ",", "fmt", ",", "buf", ",", "p", "+", "4", ",", "c", ",", "0", ")", ";", "err", "=", "synth_devs", "[", "dev", "]", "->", "load_patch", "(", "dev", ",", "fmt", ",", "buf", "+", "p", ",", "c", ",", "0", ")", ";", "if", "(", "err", "<", "0", ")", "return", "err", ";"], "docstring_tokens": ["malformed", "requests", "may", "result", "in", "the", "use", "of", "uninitialized", "variables"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "392", ",", "7", "+", "392", ",", "7", "@", "@", "static", "int", "gfs2_dirent_find_space", "(", "const", "struct", "gfs2_dirent", "*", "dent", ",", "unsigned", "totlen", "=", "be16_to_cpu", "(", "dent", "-", ">", "de_rec_len", ")", ";", "if", "(", "gfs2_dirent_sentinel", "(", "dent", ")", ")", "actual", "=", "GFS2_DIRENT_SIZE", "(", "0", ")", ";", "actual", "=", "0", ";", "if", "(", "totlen", "-", "actual", ">", "=", "required", ")", "return", "1", ";", "return", "0", ";"], "docstring_tokens": ["uses", "an", "incorrect", "size", "value", "in", "calculations", "associated", "with", "sentinel", "directory", "entries"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "463", ",", "6", "+", "463", ",", "70", "@", "@", "public", "Stat", "setData", "(", "String", "path", ",", "byte", "[", "]", "data", ",", "int", "version", ")", "}", "}", "/", "**", "*", "getAcl", "is", "an", "idempotent", "operation", ".", "Retry", "before", "throwing", "exception", "*", "@", "return", "list", "of", "ACLs", "*", "/", "public", "List", "<", "ACL", ">", "getAcl", "(", "String", "path", ",", "Stat", "stat", ")", "throws", "KeeperException", ",", "InterruptedException", "{", "TraceScope", "traceScope", "=", "null", ";", "try", "{", "traceScope", "=", "Trace", ".", "startSpan", "(", "\"", "RecoverableZookeeper", ".", "getAcl", "\"", ");", "RetryCounter", "retryCounter", "=", "retryCounterFactory", ".", "create", "(", ");", "while", "(", "true", ")", "{", "try", "{", "return", "checkZk", "(", ").", "getACL", "(", "path", ",", "stat", ")", ";", "}", "catch", "(", "KeeperException", "e", ")", "{", "switch", "(", "e", ".", "code", "(", "))", "{", "case", "CONNECTIONLOSS", ":", "case", "SESSIONEXPIRED", ":", "case", "OPERATIONTIMEOUT", ":", "retryOrThrow", "(", "retryCounter", ",", "e", ",", "\"", "getAcl", "\"", ");", "break", ";", "default", ":", "throw", "e", ";", "}", "}", "retryCounter", ".", "sleepUntilNextRetry", "(", ");", "}", "}", "finally", "{", "if", "(", "traceScope", "!", "=", "null", ")", "traceScope", ".", "close", "(", ");", "}", "}", "/", "**", "*", "setAcl", "is", "an", "idempotent", "operation", ".", "Retry", "before", "throwing", "exception", "*", "@", "return", "list", "of", "ACLs", "*", "/", "public", "Stat", "setAcl", "(", "String", "path", ",", "List", "<", "ACL", ">", "acls", ",", "int", "version", ")", "throws", "KeeperException", ",", "InterruptedException", "{", "TraceScope", "traceScope", "=", "null", ";", "try", "{", "traceScope", "=", "Trace", ".", "startSpan", "(", "\"", "RecoverableZookeeper", ".", "setAcl", "\"", ");", "RetryCounter", "retryCounter", "=", "retryCounterFactory", ".", "create", "(", ");", "while", "(", "true", ")", "{", "try", "{", "return", "checkZk", "(", ").", "setACL", "(", "path", ",", "acls", ",", "version", ")", ";", "}", "catch", "(", "KeeperException", "e", ")", "{", "switch", "(", "e", ".", "code", "(", "))", "{", "case", "CONNECTIONLOSS", ":", "case", "SESSIONEXPIRED", ":", "case", "OPERATIONTIMEOUT", ":", "retryOrThrow", "(", "retryCounter", ",", "e", ",", "\"", "setAcl", "\"", ");", "break", ";", "default", ":", "throw", "e", ";", "}", "}", "retryCounter", ".", "sleepUntilNextRetry", "(", ");", "}", "}", "finally", "{", "if", "(", "traceScope", "!", "=", "null", ")", "traceScope", ".", "close", "(", ");", "}", "}", "/", "**", "*", "<", "p", ">", "*", "NONSEQUENTIAL", "create", "is", "idempotent", "operation", ".", "@", "@", "-", "999", ",", "7", "+", "999", ",", "11", "@", "@", "public", "static", "boolean", "isSecureZooKeeper", "(", "Configuration", "conf", ")", "{", "try", "{", "javax", ".", "security", ".", "auth", ".", "login", ".", "Configuration", "testConfig", "=", "javax", ".", "security", ".", "auth", ".", "login", ".", "Configuration", ".", "getConfiguration", "(", ");", "if", "(", "testConfig", ".", "getAppConfigurationEntry", "(", "\"", "Client", "\"", ")", "=", "=", "null", ")", "{", "if", "(", "testConfig", ".", "getAppConfigurationEntry", "(", "\"", "Client", "\"", ")", "=", "=", "null", "&", "&", "testConfig", ".", "getAppConfigurationEntry", "(", "JaasConfiguration", ".", "CLIENT_KEYTAB_KERBEROS_CONFIG_NAME", ")", "=", "=", "null", "&", "&", "testConfig", ".", "getAppConfigurationEntry", "(", "JaasConfiguration", ".", "SERVER_KEYTAB_KERBEROS_CONFIG_NAME", ")", "=", "=", "null", ")", "{", "return", "false", ";", "}", "}", "catch", "(", "Exception", "e", ")", "{", "@", "@", "-", "1008", ",", "16", "+", "1012", ",", "15", "@", "@", "public", "static", "boolean", "isSecureZooKeeper", "(", "Configuration", "conf", ")", "{", "}", "/", "/", "Master", "&", "RSs", "uses", "hbase", ".", "zookeeper", ".", "client", ".", "*", "return", "(", "\"", "kerberos", "\"", ".", "equalsIgnoreCase", "(", "conf", ".", "get", "(", "\"", "hbase", ".", "security", ".", "authentication", "\"", "))", "&", "&", "conf", ".", "get", "(", "\"", "hbase", ".", "zookeeper", ".", "client", ".", "keytab", ".", "file", "\"", ")", "!", "=", "null", ")", ";", "return", "\"", "kerberos", "\"", ".", "equalsIgnoreCase", "(", "conf", ".", "get", "(", "\"", "hbase", ".", "security", ".", "authentication", "\"", "))", ";", "}", "private", "static", "ArrayList", "<", "ACL", ">", "createACL", "(", "ZooKeeperWatcher", "zkw", ",", "String", "node", ")", "{", "return", "createACL", "(", "zkw", ",", "node", ",", "isSecureZooKeeper", "(", "zkw", ".", "getConfiguration", "(", "))", ");", "}", "protected", "static", "ArrayList", "<", "ACL", ">", "createACL", "(", "ZooKeeperWatcher", "zkw", ",", "String", "node", ",", "boolean", "isSecureZooKeeper", ")", "{", "public", "static", "ArrayList", "<", "ACL", ">", "createACL", "(", "ZooKeeperWatcher", "zkw", ",", "String", "node", ",", "boolean", "isSecureZooKeeper", ")", "{", "if", "(", "!", "node", ".", "startsWith", "(", "zkw", ".", "baseZNode", ")", ")", "{", "return", "Ids", ".", "OPEN_ACL_UNSAFE", ";", "}", "@", "@", "-", "1030", ",", "13", "+", "1033", ",", "7", "@", "@", "public", "static", "boolean", "isSecureZooKeeper", "(", "Configuration", "conf", ")", "{", "}", "/", "/", "Certain", "znodes", "are", "accessed", "directly", "by", "the", "client", ",", "/", "/", "so", "they", "must", "be", "readable", "by", "non", "-", "authenticated", "clients", "if", "(", "(", "node", ".", "equals", "(", "zkw", ".", "baseZNode", ")", "=", "=", "true", ")", "|", "|", "(", "zkw", ".", "isAnyMetaReplicaZnode", "(", "node", ")", ")", "|", "|", "(", "node", ".", "equals", "(", "zkw", ".", "getMasterAddressZNode", "(", "))", "=", "=", "true", ")", "|", "|", "(", "node", ".", "equals", "(", "zkw", ".", "clusterIdZNode", ")", "=", "=", "true", ")", "|", "|", "(", "node", ".", "equals", "(", "zkw", ".", "rsZNode", ")", "=", "=", "true", ")", "|", "|", "(", "node", ".", "equals", "(", "zkw", ".", "backupMasterAddressesZNode", ")", "=", "=", "true", ")", "|", "|", "(", "node", ".", "startsWith", "(", "zkw", ".", "tableZNode", ")", "=", "=", "true", ")", ")", "{", "if", "(", "zkw", ".", "isClientReadable", "(", "node", ")", ")", "{", "acls", ".", "addAll", "(", "Ids", ".", "CREATOR_ALL_ACL", ")", ";", "acls", ".", "addAll", "(", "Ids", ".", "READ_ACL_UNSAFE", ")", ";", "}", "else", "{", "@", "@", "-", "21", ",", "7", "+", "21", ",", "6", "@", "@", "import", "java", ".", "io", ".", "Closeable", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "@", "@", "-", "36", ",", "11", "+", "35", ",", "15", "@", "@", "import", "org", ".", "apache", ".", "hadoop", ".", "hbase", ".", "HRegionInfo", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hbase", ".", "ZooKeeperConnectionException", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hbase", ".", "classification", ".", "InterfaceAudience", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "security", ".", "UserGroupInformation", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "KeeperException", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "WatchedEvent", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "Watcher", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "ZooDefs", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "ZooDefs", ".", "Ids", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "ZooDefs", ".", "Perms", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "ACL", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "Id", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "Stat", ";", "/", "**", "*", "Acts", "as", "the", "single", "ZooKeeper", "Watcher", ".", "One", "instance", "of", "this", "is", "instantiated", "@", "@", "-", "183", ",", "6", "+", "186", ",", "109", "@", "@", "private", "void", "createBaseZNodes", "(", ")", "throws", "ZooKeeperConnectionException", "{", "}", "}", "/", "**", "Returns", "whether", "the", "znode", "is", "supposed", "to", "be", "readable", "by", "the", "client", "*", "and", "DOES", "NOT", "contain", "sensitive", "information", "(", "world", "readable", ")", ".*", "/", "public", "boolean", "isClientReadable", "(", "String", "node", ")", "{", "/", "/", "Developer", "notice", ":", "These", "znodes", "are", "world", "readable", ".", "DO", "NOT", "add", "more", "znodes", "here", "UNLESS", "/", "/", "all", "clients", "need", "to", "access", "this", "data", "to", "work", ".", "Using", "zk", "for", "sharing", "data", "to", "clients", "(", "other", "/", "/", "than", "service", "lookup", "case", "is", "not", "a", "recommended", "design", "pattern", ".", "return", "node", ".", "equals", "(", "baseZNode", ")", "|", "|", "isAnyMetaReplicaZnode", "(", "node", ")", "|", "|", "node", ".", "equals", "(", "getMasterAddressZNode", "(", "))", "|", "|", "node", ".", "equals", "(", "clusterIdZNode", ")", "||", "node", ".", "equals", "(", "rsZNode", ")", "|", "|", "/", "/", "/", "hbase", "/", "table", "and", "/", "hbase", "/", "table", "/", "foo", "is", "allowed", ",", "/", "hbase", "/", "table", "-", "lock", "is", "not", "node", ".", "equals", "(", "tableZNode", ")", "|", "|", "node", ".", "startsWith", "(", "tableZNode", "+", "\"", "/\"", ");", "}", "/", "**", "*", "On", "master", "start", ",", "we", "check", "the", "znode", "ACLs", "under", "the", "root", "directory", "and", "set", "the", "ACLs", "properly", "*", "if", "needed", ".", "If", "the", "cluster", "goes", "from", "an", "unsecure", "setup", "to", "a", "secure", "setup", ",", "this", "step", "is", "needed", "*", "so", "that", "the", "existing", "znodes", "created", "with", "open", "permissions", "are", "now", "changed", "with", "restrictive", "*", "perms", ".", "*", "/", "public", "void", "checkAndSetZNodeAcls", "(", ")", "{", "if", "(", "!", "ZKUtil", ".", "isSecureZooKeeper", "(", "getConfiguration", "(", "))", ")", "{", "return", ";", "}", "/", "/", "Check", "the", "base", "znodes", "permission", "first", ".", "Only", "do", "the", "recursion", "if", "base", "znode", "'", "s", "perms", "are", "not", "/", "/", "correct", ".", "try", "{", "List", "<", "ACL", ">", "actualAcls", "=", "recoverableZooKeeper", ".", "getAcl", "(", "baseZNode", ",", "new", "Stat", "(", "))", ";", "if", "(", "!", "isBaseZnodeAclSetup", "(", "actualAcls", ")", ")", "{", "LOG", ".", "info", "(", "\"", "setting", "znode", "ACLs", "\"", ");", "setZnodeAclsRecursive", "(", "baseZNode", ")", ";", "}", "}", "catch", "(", "KeeperException", ".", "NoNodeException", "nne", ")", "{", "return", ";", "}", "catch", "(", "InterruptedException", "ie", ")", "{", "interruptedException", "(", "ie", ")", ";", "}", "catch", "(", "IOException", "|", "KeeperException", "e", ")", "{", "LOG", ".", "warn", "(", "\"", "Received", "exception", "while", "checking", "and", "setting", "zookeeper", "ACLs", "\"", ",", "e", ")", ";", "}", "}", "/", "**", "*", "Set", "the", "znode", "perms", "recursively", ".", "This", "will", "do", "post", "-", "order", "recursion", ",", "so", "that", "baseZnode", "ACLs", "*", "will", "be", "set", "last", "in", "case", "the", "master", "fails", "in", "between", ".", "*", "@", "param", "znode", "*", "/", "private", "void", "setZnodeAclsRecursive", "(", "String", "znode", ")", "throws", "KeeperException", ",", "InterruptedException", "{", "List", "<", "String", ">", "children", "=", "recoverableZooKeeper", ".", "getChildren", "(", "znode", ",", "false", ")", ";", "for", "(", "String", "child", ":", "children", ")", "{", "setZnodeAclsRecursive", "(", "ZKUtil", ".", "joinZNode", "(", "znode", ",", "child", ")", ");", "}", "List", "<", "ACL", ">", "acls", "=", "ZKUtil", ".", "createACL", "(", "this", ",", "znode", ",", "true", ")", ";", "LOG", ".", "info", "(", "\"", "Setting", "ACLs", "for", "znode", ":", "\"", "+", "znode", "+", "\"", ",", "acl", ":", "\"", "+", "acls", ")", ";", "recoverableZooKeeper", ".", "setAcl", "(", "znode", ",", "acls", ",", "-", "1", ")", ";", "}", "/", "**", "*", "Checks", "whether", "the", "ACLs", "returned", "from", "the", "base", "znode", "(", "/", "hbase", ")", "is", "set", "for", "secure", "setup", ".", "*", "@", "param", "acls", "acls", "from", "zookeeper", "*", "@", "return", "whether", "ACLs", "are", "set", "for", "the", "base", "znode", "*", "@", "throws", "IOException", "*", "/", "private", "boolean", "isBaseZnodeAclSetup", "(", "List", "<", "ACL", ">", "acls", ")", "throws", "IOException", "{", "String", "superUser", "=", "conf", ".", "get", "(", "\"", "hbase", ".", "superuser", "\"", ");", "/", "/", "this", "assumes", "that", "current", "authenticated", "user", "is", "the", "same", "as", "zookeeper", "client", "user", "/", "/", "configured", "via", "JAAS", "String", "hbaseUser", "=", "UserGroupInformation", ".", "getCurrentUser", "(", ").", "getShortUserName", "(", ");", "if", "(", "acls", ".", "isEmpty", "(", "))", "{", "return", "false", ";", "}", "for", "(", "ACL", "acl", ":", "acls", ")", "{", "int", "perms", "=", "acl", ".", "getPerms", "(", ");", "Id", "id", "=", "acl", ".", "getId", "(", ");", "/", "/", "We", "should", "only", "set", "at", "most", "3", "possible", "ACLs", "for", "3", "Ids", ".", "One", "for", "everyone", ",", "one", "for", "superuser", "/", "/", "and", "one", "for", "the", "hbase", "user", "if", "(", "Ids", ".", "ANYONE_ID_UNSAFE", ".", "equals", "(", "id", ")", ")", "{", "if", "(", "perms", "!", "=", "Perms", ".", "READ", ")", "{", "return", "false", ";", "}", "}", "else", "if", "(", "superUser", "!", "=", "null", "&", "&", "new", "Id", "(", "\"", "sasl", "\"", ",", "superUser", ")", ".", "equals", "(", "id", ")", ")", "{", "if", "(", "perms", "!", "=", "Perms", ".", "ALL", ")", "{", "return", "false", ";", "}", "}", "else", "if", "(", "new", "Id", "(", "\"", "sasl", "\"", ",", "hbaseUser", ")", ".", "equals", "(", "id", ")", ")", "{", "if", "(", "perms", "!", "=", "Perms", ".", "ALL", ")", "{", "return", "false", ";", "}", "}", "else", "{", "return", "false", ";", "}", "}", "return", "true", ";", "}", "@", "Override", "public", "String", "toString", "(", ")", "{", "return", "this", ".", "identifier", "+", "\"", ",", "quorum", "=", "\"", "+", "quorum", "+", "\"", ",", "baseZNode", "=", "\"", "+", "baseZNode", ";", "@", "@", "-", "304", ",", "7", "+", "410", ",", "7", "@", "@", "public", "int", "getMetaReplicaIdFromZnode", "(", "String", "znode", ")", "{", "String", "pattern", "=", "conf", ".", "get", "(", "\"", "zookeeper", ".", "znode", ".", "metaserver", "\"", ",\"", "meta", "-", "region", "-", "server", "\"", ");", "if", "(", "znode", ".", "equals", "(", "pattern", ")", ")", "return", "HRegionInfo", ".", "DEFAULT_REPLICA_ID", ";", "/", "/", "the", "non", "-", "default", "replicas", "are", "of", "the", "pattern", "meta", "-", "region", "-", "server", "-", "<", "replicaId", ">", "String", "nonDefaultPattern", "=", "pattern", "+", "\"", "-\"", ";", "String", "nonDefaultPattern", "=", "pattern", "+", "\"", "-\"", ";", "return", "Integer", ".", "parseInt", "(", "znode", ".", "substring", "(", "nonDefaultPattern", ".", "length", "(", "))", ");", "}", "@", "@", "-", "552", ",", "6", "+", "658", ",", "7", "@", "@", "public", "void", "interruptedException", "(", "InterruptedException", "ie", ")", "{", "*", "*", "@", "throws", "InterruptedException", "*", "/", "@", "Override", "public", "void", "close", "(", ")", "{", "try", "{", "if", "(", "recoverableZooKeeper", "!", "=", "null", ")", "{", "@", "@", "-", "0", ",", "0", "+", "1", ",", "59", "@", "@", "/", "**", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "*", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "*", "distributed", "with", "this", "work", "for", "additional", "information", "*", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "*", "to", "you", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "*", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "hadoop", ".", "hbase", ".", "zookeeper", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*;", "import", "java", ".", "io", ".", "IOException", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hbase", ".", "HBaseConfiguration", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hbase", ".", "ZooKeeperConnectionException", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hbase", ".", "testclassification", ".", "SmallTests", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "experimental", ".", "categories", ".", "Category", ";", "@", "Category", "(", "{", "SmallTests", ".", "class", "}", ")", "public", "class", "TestZooKeeperWatcher", "{", "@", "Test", "public", "void", "testIsClientReadable", "(", ")", "throws", "ZooKeeperConnectionException", ",", "IOException", "{", "ZooKeeperWatcher", "watcher", "=", "new", "ZooKeeperWatcher", "(", "HBaseConfiguration", ".", "create", "(", "),", "\"", "testIsClientReadable", "\"", ",", "null", ",", "false", ")", ";", "assertTrue", "(", "watcher", ".", "isClientReadable", "(", "watcher", ".", "baseZNode", ")", ");", "assertTrue", "(", "watcher", ".", "isClientReadable", "(", "watcher", ".", "getZNodeForReplica", "(", "0", ")", "))", ";", "assertTrue", "(", "watcher", ".", "isClientReadable", "(", "watcher", ".", "getMasterAddressZNode", "(", "))", ");", "assertTrue", "(", "watcher", ".", "isClientReadable", "(", "watcher", ".", "clusterIdZNode", ")", ");", "assertTrue", "(", "watcher", ".", "isClientReadable", "(", "watcher", ".", "tableZNode", ")", ");", "assertTrue", "(", "watcher", ".", "isClientReadable", "(", "ZKUtil", ".", "joinZNode", "(", "watcher", ".", "tableZNode", ",", "\"", "foo", "\"", "))", ");", "assertTrue", "(", "watcher", ".", "isClientReadable", "(", "watcher", ".", "rsZNode", ")", ");", "assertFalse", "(", "watcher", ".", "isClientReadable", "(", "watcher", ".", "tableLockZNode", ")", ");", "assertFalse", "(", "watcher", ".", "isClientReadable", "(", "watcher", ".", "balancerZNode", ")", ");", "assertFalse", "(", "watcher", ".", "isClientReadable", "(", "watcher", ".", "clusterStateZNode", ")", ");", "assertFalse", "(", "watcher", ".", "isClientReadable", "(", "watcher", ".", "drainingZNode", ")", ");", "assertFalse", "(", "watcher", ".", "isClientReadable", "(", "watcher", ".", "recoveringRegionsZNode", ")", ");", "assertFalse", "(", "watcher", ".", "isClientReadable", "(", "watcher", ".", "splitLogZNode", ")", ");", "assertFalse", "(", "watcher", ".", "isClientReadable", "(", "watcher", ".", "backupMasterAddressesZNode", ")", ");", "watcher", ".", "close", "(", ");", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "232", "@", "@", "/", "**", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "*", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "*", "distributed", "with", "this", "work", "for", "additional", "information", "*", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "*", "to", "you", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "*", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "hadoop", ".", "hbase", ".", "test", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "fail", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "apache", ".", "commons", ".", "cli", ".", "CommandLine", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "Log", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "LogFactory", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "conf", ".", "Configuration", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "FileSystem", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "Path", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "permission", ".", "FsPermission", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hbase", ".", "HBaseConfiguration", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hbase", ".", "IntegrationTestingUtility", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hbase", ".", "testclassification", ".", "IntegrationTests", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hbase", ".", "util", ".", "AbstractHBaseTool", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hbase", ".", "util", ".", "FSUtils", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hbase", ".", "zookeeper", ".", "RecoverableZooKeeper", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hbase", ".", "zookeeper", ".", "ZKUtil", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hbase", ".", "zookeeper", ".", "ZooKeeperWatcher", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "util", ".", "ToolRunner", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "KeeperException", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "KeeperException", ".", "Code", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "ZooDefs", ".", "Ids", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "ZooDefs", ".", "Perms", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "ACL", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "Id", ";", "import", "org", ".", "apache", ".", "zookeeper", ".", "data", ".", "Stat", ";", "import", "org", ".", "junit", ".", "experimental", ".", "categories", ".", "Category", ";", "/", "**", "*", "An", "integration", "test", "which", "checks", "that", "the", "znodes", "in", "zookeeper", "and", "data", "in", "the", "FileSystem", "*", "are", "protected", "for", "secure", "HBase", "deployments", ".", "*", "This", "test", "is", "intended", "to", "be", "run", "on", "clusters", "with", "kerberos", "authorization", "for", "HBase", "and", "Zookeeper", ".", "*", "*", "If", "hbase", ".", "security", ".", "authentication", "is", "not", "set", "to", "kerberos", ",", "the", "test", "does", "not", "run", "unless", "-", "f", "is", "*", "specified", "which", "bypasses", "the", "check", ".", "It", "is", "recommended", "to", "always", "run", "with", "-", "f", "on", "secure", "clusters", "*", "so", "that", "the", "test", "checks", "the", "actual", "end", "result", ",", "not", "the", "configuration", ".", "*", "*", "The", "test", "should", "be", "run", "as", "hbase", "user", "with", "kinit", "/", "TGT", "cached", "since", "it", "accesses", "HDFS", ".", "*", "<", "p", ">", "*", "Example", "usage", ":", "*", "hbase", "org", ".", "apache", ".", "hadoop", ".", "hbase", ".", "test", ".", "IntegrationTestZnodeACLs", "-", "h", "*", "/", "@", "Category", "(", "IntegrationTests", ".", "class", ")", "public", "class", "IntegrationTestZKAndFSPermissions", "extends", "AbstractHBaseTool", "{", "private", "static", "final", "Log", "LOG", "=", "LogFactory", ".", "getLog", "(", "IntegrationTestZKAndFSPermissions", ".", "class", ")", ";", "private", "String", "superUser", ";", "private", "String", "masterPrincipal", ";", "private", "boolean", "isForce", ";", "private", "String", "fsPerms", ";", "private", "boolean", "skipFSCheck", ";", "private", "boolean", "skipZKCheck", ";", "public", "static", "final", "String", "FORCE_CHECK_ARG", "=", "\"", "f", "\"", ";", "public", "static", "final", "String", "PRINCIPAL_ARG", "=", "\"", "p", "\"", ";", "public", "static", "final", "String", "SUPERUSER_ARG", "=", "\"", "s", "\"", ";", "public", "static", "final", "String", "FS_PERMS", "=", "\"", "fs_perms", "\"", ";", "public", "static", "final", "String", "SKIP_CHECK_FS", "=", "\"", "skip_fs_check", "\"", ";", "public", "static", "final", "String", "SKIP_CHECK_ZK", "=", "\"", "skip_zk_check", "\"", ";", "@", "Override", "public", "void", "setConf", "(", "Configuration", "conf", ")", "{", "super", ".", "setConf", "(", "conf", ")", ";", "}", "@", "Override", "protected", "void", "addOptions", "(", ")", "{", "addOptNoArg", "(", "FORCE_CHECK_ARG", ",", "\"", "Whether", "to", "skip", "configuration", "lookup", "and", "assume", "a", "secure", "setup", "\"", ");", "addOptWithArg", "(", "PRINCIPAL_ARG", ",", "\"", "The", "principal", "for", "zk", "authorization", "\"", ");", "addOptWithArg", "(", "SUPERUSER_ARG", ",", "\"", "The", "principal", "for", "super", "user", "\"", ");", "addOptWithArg", "(", "FS_PERMS", ",", "\"", "FS", "permissions", ",", "ex", ".", "700", ",", "750", ",", "etc", ".", "Defaults", "to", "700", "\"", ");", "addOptNoArg", "(", "SKIP_CHECK_FS", ",", "\"", "Whether", "to", "skip", "checking", "FS", "permissions", "\"", ");", "addOptNoArg", "(", "SKIP_CHECK_ZK", ",", "\"", "Whether", "to", "skip", "checking", "ZK", "permissions", "\"", ");", "}", "@", "Override", "protected", "void", "processOptions", "(", "CommandLine", "cmd", ")", "{", "isForce", "=", "cmd", ".", "hasOption", "(", "FORCE_CHECK_ARG", ")", ";", "masterPrincipal", "=", "getShortUserName", "(", "conf", ".", "get", "(", "\"", "hbase", ".", "master", ".", "kerberos", ".", "principal", "\"", "))", ";", "superUser", "=", "cmd", ".", "getOptionValue", "(", "SUPERUSER_ARG", ",", "conf", ".", "get", "(", "\"", "hbase", ".", "superuser", "\"", "))", ";", "masterPrincipal", "=", "cmd", ".", "getOptionValue", "(", "PRINCIPAL_ARG", ",", "masterPrincipal", ")", ";", "fsPerms", "=", "cmd", ".", "getOptionValue", "(", "FS_PERMS", ",", "\"", "700", "\"", ");", "skipFSCheck", "=", "cmd", ".", "hasOption", "(", "SKIP_CHECK_FS", ")", ";", "skipZKCheck", "=", "cmd", ".", "hasOption", "(", "SKIP_CHECK_ZK", ")", ";", "}", "private", "String", "getShortUserName", "(", "String", "principal", ")", "{", "for", "(", "int", "i", "=", "0", ";", "i", "<", "principal", ".", "length", "(", ");", "i", "+", "+)", "{", "if", "(", "principal", ".", "charAt", "(", "i", ")", "=", "=", "'", "/'", "|", "|", "principal", ".", "charAt", "(", "i", ")", "=", "=", "'", "@'", ")", "{", "return", "principal", ".", "substring", "(", "0", ",", "i", ")", ";", "}", "}", "return", "principal", ";", "}", "@", "Override", "protected", "int", "doWork", "(", ")", "throws", "Exception", "{", "if", "(", "!", "isForce", ")", "{", "if", "(", "!\"", "kerberos", "\"", ".", "equalsIgnoreCase", "(", "conf", ".", "get", "(", "\"", "hbase", ".", "security", ".", "authentication", "\"", "))", ")", "{", "LOG", ".", "warn", "(", "\"", "hbase", ".", "security", ".", "authentication", "is", "not", "kerberos", ",", "and", "-", "f", "is", "not", "supplied", ".", "Skip", "\"", "+", "\"", "running", "the", "test", "\"", ");", "return", "0", ";", "}", "}", "if", "(", "!", "skipZKCheck", ")", "{", "testZNodeACLs", "(", ");", "}", "if", "(", "!", "skipFSCheck", ")", "{", "testFSPerms", "(", ");", "}", "return", "0", ";", "}", "private", "void", "testZNodeACLs", "(", ")", "throws", "IOException", ",", "KeeperException", ",", "InterruptedException", "{", "ZooKeeperWatcher", "watcher", "=", "new", "ZooKeeperWatcher", "(", "conf", ",", "\"", "IntegrationTestZnodeACLs", "\"", ",", "null", ")", ";", "RecoverableZooKeeper", "zk", "=", "ZKUtil", ".", "connect", "(", "this", ".", "conf", ",", "watcher", ")", ";", "String", "baseZNode", "=", "watcher", ".", "baseZNode", ";", "LOG", ".", "info", "(", "\"\"", ");", "LOG", ".", "info", "(", "\"*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "\")", ";", "LOG", ".", "info", "(", "\"", "Checking", "ZK", "permissions", ",", "root", "znode", ":", "\"", "+", "baseZNode", ")", ";", "LOG", ".", "info", "(", "\"*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "\")", ";", "LOG", ".", "info", "(", "\"\"", ");", "checkZnodePermsRecursive", "(", "watcher", ",", "zk", ",", "baseZNode", ")", ";", "LOG", ".", "info", "(", "\"", "Checking", "ZK", "permissions", ":", "SUCCESS", "\"", ");", "}", "private", "void", "checkZnodePermsRecursive", "(", "ZooKeeperWatcher", "watcher", ",", "RecoverableZooKeeper", "zk", ",", "String", "znode", ")", "throws", "KeeperException", ",", "InterruptedException", "{", "boolean", "expectedWorldReadable", "=", "watcher", ".", "isClientReadable", "(", "znode", ")", ";", "assertZnodePerms", "(", "zk", ",", "znode", ",", "expectedWorldReadable", ")", ";", "try", "{", "List", "<", "String", ">", "children", "=", "zk", ".", "getChildren", "(", "znode", ",", "false", ")", ";", "for", "(", "String", "child", ":", "children", ")", "{", "checkZnodePermsRecursive", "(", "watcher", ",", "zk", ",", "ZKUtil", ".", "joinZNode", "(", "znode", ",", "child", ")", ");", "}", "}", "catch", "(", "KeeperException", "ke", ")", "{", "/", "/", "if", "we", "are", "not", "authenticated", "for", "listChildren", ",", "it", "is", "fine", ".", "if", "(", "ke", ".", "code", "(", ")", "!", "=", "Code", ".", "NOAUTH", ")", "{", "throw", "ke", ";", "}", "}", "}", "private", "void", "assertZnodePerms", "(", "RecoverableZooKeeper", "zk", ",", "String", "znode", ",", "boolean", "expectedWorldReadable", ")", "throws", "KeeperException", ",", "InterruptedException", "{", "Stat", "stat", "=", "new", "Stat", "(", ");", "List", "<", "ACL", ">", "acls", "=", "zk", ".", "getZooKeeper", "(", ").", "getACL", "(", "znode", ",", "stat", ")", ";", "LOG", ".", "info", "(", "\"", "Checking", "ACLs", "for", "znode", "znode", ":", "\"", "+", "znode", "+", "\"", "acls", ":", "\"", "+", "acls", ")", ";", "for", "(", "ACL", "acl", ":", "acls", ")", "{", "int", "perms", "=", "acl", ".", "getPerms", "(", ");", "Id", "id", "=", "acl", ".", "getId", "(", ");", "/", "/", "We", "should", "only", "set", "at", "most", "3", "possible", "ACL", "for", "3", "Ids", ".", "One", "for", "everyone", ",", "one", "for", "superuser", "/", "/", "and", "one", "for", "the", "hbase", "user", "if", "(", "Ids", ".", "ANYONE_ID_UNSAFE", ".", "equals", "(", "id", ")", ")", "{", "/", "/", "everyone", "should", "be", "set", "only", "if", "we", "are", "expecting", "this", "znode", "to", "be", "world", "readable", "assertTrue", "(", "expectedWorldReadable", ")", ";", "/", "/", "assert", "that", "anyone", "can", "only", "read", "assertEquals", "(", "perms", ",", "Perms", ".", "READ", ")", ";", "}", "else", "if", "(", "superUser", "!", "=", "null", "&", "&", "new", "Id", "(", "\"", "sasl", "\"", ",", "superUser", ")", ".", "equals", "(", "id", ")", ")", "{", "/", "/", "assert", "that", "super", "user", "has", "all", "the", "permissions", "assertEquals", "(", "perms", ",", "Perms", ".", "ALL", ")", ";", "}", "else", "if", "(", "new", "Id", "(", "\"", "sasl", "\"", ",", "masterPrincipal", ")", ".", "equals", "(", "id", ")", ")", "{", "/", "/", "hbase", ".", "master", ".", "kerberos", ".", "principal", "?", "assertEquals", "(", "perms", ",", "Perms", ".", "ALL", ")", ";", "}", "else", "{", "fail", "(", "\"", "An", "ACL", "is", "found", "which", "is", "not", "expected", "for", "the", "znode", ":", "\"", "+", "znode", "+", "\"", ",", "ACL", ":", "\"", "+", "acl", ")", ";", "}", "}", "}", "private", "void", "testFSPerms", "(", ")", "throws", "IOException", "{", "Path", "rootDir", "=", "FSUtils", ".", "getRootDir", "(", "conf", ")", ";", "LOG", ".", "info", "(", "\"\"", ");", "LOG", ".", "info", "(", "\"*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "\")", ";", "LOG", ".", "info", "(", "\"", "Checking", "FS", "permissions", "for", "root", "dir", ":", "\"", "+", "rootDir", ")", ";", "LOG", ".", "info", "(", "\"*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "\")", ";", "LOG", ".", "info", "(", "\"\"", ");", "FileSystem", "fs", "=", "rootDir", ".", "getFileSystem", "(", "conf", ")", ";", "short", "expectedPerms", "=", "Short", ".", "valueOf", "(", "fsPerms", ",", "8", ")", ";", "assertEquals", "(", "FsPermission", ".", "createImmutable", "(", "expectedPerms", ")", ",", "fs", ".", "getFileStatus", "(", "rootDir", ")", ".", "getPermission", "(", "))", ";", "LOG", ".", "info", "(", "\"", "Checking", "FS", "permissions", ":", "SUCCESS", "\"", ");", "}", "public", "static", "void", "main", "(", "String", "[", "]", "args", ")", "throws", "Exception", "{", "Configuration", "configuration", "=", "HBaseConfiguration", ".", "create", "(", ");", "IntegrationTestingUtility", ".", "setUseDistributedCluster", "(", "configuration", ")", ";", "IntegrationTestZKAndFSPermissions", "tool", "=", "new", "IntegrationTestZKAndFSPermissions", "(", ");", "int", "ret", "=", "ToolRunner", ".", "run", "(", "configuration", ",", "tool", ",", "args", ")", ";", "System", ".", "exit", "(", "ret", ")", ";", "}", "}", "@", "@", "-", "781", ",", "6", "+", "781", ",", "11", "@", "@", "private", "void", "finishActiveMasterInitialization", "(", "MonitoredTask", "status", ")", "/", "/", "master", "initialization", ".", "See", "HBASE", "-", "5916", ".", "this", ".", "serverManager", ".", "clearDeadServersWithSameHostNameAndPortOfOnlineServer", "(", ");", "/", "/", "Check", "and", "set", "the", "znode", "ACLs", "if", "needed", "in", "case", "we", "are", "overtaking", "a", "non", "-", "secure", "configuration", "status", ".", "setStatus", "(", "\"", "Checking", "ZNode", "ACLs", "\"", ");", "zooKeeper", ".", "checkAndSetZNodeAcls", "(", ");", "status", ".", "setStatus", "(", "\"", "Calling", "postStartMaster", "coprocessors", "\"", ");", "if", "(", "this", ".", "cpHost", "!", "=", "null", ")", "{", "/", "/", "don", "'", "t", "let", "cp", "initialization", "errors", "kill", "the", "master", "try", "{"], "docstring_tokens": ["a", "logic", "error"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "614", ",", "11", "+", "614", ",", "23", "@", "@", "static", "int", "dtls1_retrieve_buffered_fragment", "(", "SSL", "*", "s", ",", "long", "max", ",", "int", "*", "ok", ")", "int", "al", ";", "*", "ok", "=", "0", ";", "item", "=", "pqueue_peek", "(", "s", "-", ">", "d1", "-", ">", "buffered_messages", ")", ";", "if", "(", "item", "=", "=", "NULL", ")", "return", "0", ";", "do", "{", "item", "=", "pqueue_peek", "(", "s", "-", ">", "d1", "-", ">", "buffered_messages", ")", ";", "if", "(", "item", "=", "=", "NULL", ")", "return", "0", ";", "frag", "=", "(", "hm_fragment", "*", ")", "item", "-", ">", "data", ";", "if", "(", "frag", "-", ">", "msg_header", ".", "seq", "<", "s", "-", ">", "d1", "-", ">", "handshake_read_seq", ")", "{", "/", "*", "This", "is", "a", "stale", "message", "that", "has", "been", "buffered", "so", "clear", "it", "*", "/", "pqueue_pop", "(", "s", "-", ">", "d1", "-", ">", "buffered_messages", ")", ";", "dtls1_hm_fragment_free", "(", "frag", ")", ";", "pitem_free", "(", "item", ")", ";", "item", "=", "NULL", ";", "frag", "=", "NULL", ";", "}", "}", "while", "(", "item", "=", "=", "NULL", ")", ";", "frag", "=", "(", "hm_fragment", "*", ")", "item", "-", ">", "data", ";", "/", "*", "Don", "'", "t", "return", "if", "reassembly", "still", "in", "progress", "*", "/", "if", "(", "frag", "-", ">", "reassembly", "!", "=", "NULL", ")", "@", "@", "-", "1416", ",", "18", "+", "1428", ",", "6", "@", "@", "dtls1_retransmit_message", "(", "SSL", "*", "s", ",", "unsigned", "short", "seq", ",", "unsigned", "long", "frag_off", ",", "return", "ret", ";", "}", "/", "*", "call", "this", "function", "when", "the", "buffered", "messages", "are", "no", "longer", "needed", "*", "/", "void", "dtls1_clear_record_buffer", "(", "SSL", "*", "s", ")", "{", "pitem", "*", "item", ";", "for", "(", "item", "=", "pqueue_pop", "(", "s", "-", ">", "d1", "-", ">", "sent_messages", ")", ";", "item", "!", "=", "NULL", ";", "item", "=", "pqueue_pop", "(", "s", "-", ">", "d1", "-", ">", "sent_messages", ")", ")", "{", "dtls1_hm_fragment_free", "(", "(", "hm_fragment", "*", ")", "item", "-", ">", "data", ")", ";", "pitem_free", "(", "item", ")", ";", "}", "}", "unsigned", "char", "*", "dtls1_set_message_header", "(", "SSL", "*", "s", ",", "unsigned", "char", "*", "p", ",", "unsigned", "char", "mt", ",", "unsigned", "long", "len", ",", "unsigned", "long", "frag_off", ",", "@", "@", "-", "751", ",", "6", "+", "751", ",", "7", "@", "@", "int", "dtls1_connect", "(", "SSL", "*", "s", ")", "/", "*", "done", "with", "handshaking", "*", "/", "s", "-", ">", "d1", "-", ">", "handshake_read_seq", "=", "0", ";", "s", "-", ">", "d1", "-", ">", "next_handshake_write_seq", "=", "0", ";", "dtls1_clear_received_buffer", "(", "s", ")", ";", "goto", "end", ";", "/", "*", "break", ";", "*", "/", "@", "@", "-", "144", ",", "7", "+", "144", ",", "6", "@", "@", "int", "dtls1_new", "(", "SSL", "*", "s", ")", "static", "void", "dtls1_clear_queues", "(", "SSL", "*", "s", ")", "{", "pitem", "*", "item", "=", "NULL", ";", "hm_fragment", "*", "frag", "=", "NULL", ";", "DTLS1_RECORD_DATA", "*", "rdata", ";", "while", "(", "(", "item", "=", "pqueue_pop", "(", "s", "-", ">", "d1", "-", ">", "unprocessed_rcds", ".", "q", ")", ")", "!", "=", "NULL", ")", "{", "@", "@", "-", "165", ",", "28", "+", "164", ",", "44", "@", "@", "static", "void", "dtls1_clear_queues", "(", "SSL", "*", "s", ")", "pitem_free", "(", "item", ")", ";", "}", "while", "(", "(", "item", "=", "pqueue_pop", "(", "s", "-", ">", "d1", "-", ">", "buffered_app_data", ".", "q", ")", ")", "!", "=", "NULL", ")", "{", "rdata", "=", "(", "DTLS1_RECORD_DATA", "*", ")", "item", "-", ">", "data", ";", "if", "(", "rdata", "-", ">", "rbuf", ".", "buf", ")", "{", "OPENSSL_free", "(", "rdata", "-", ">", "rbuf", ".", "buf", ")", ";", "}", "OPENSSL_free", "(", "item", "-", ">", "data", ")", ";", "pitem_free", "(", "item", ")", ";", "}", "dtls1_clear_received_buffer", "(", "s", ")", ";", "dtls1_clear_sent_buffer", "(", "s", ")", ";", "}", "void", "dtls1_clear_received_buffer", "(", "SSL", "*", "s", ")", "{", "pitem", "*", "item", "=", "NULL", ";", "hm_fragment", "*", "frag", "=", "NULL", ";", "while", "(", "(", "item", "=", "pqueue_pop", "(", "s", "-", ">", "d1", "-", ">", "buffered_messages", ")", ")", "!", "=", "NULL", ")", "{", "frag", "=", "(", "hm_fragment", "*", ")", "item", "-", ">", "data", ";", "dtls1_hm_fragment_free", "(", "frag", ")", ";", "pitem_free", "(", "item", ")", ";", "}", "}", "void", "dtls1_clear_sent_buffer", "(", "SSL", "*", "s", ")", "{", "pitem", "*", "item", "=", "NULL", ";", "hm_fragment", "*", "frag", "=", "NULL", ";", "while", "(", "(", "item", "=", "pqueue_pop", "(", "s", "-", ">", "d1", "-", ">", "sent_messages", ")", ")", "!", "=", "NULL", ")", "{", "frag", "=", "(", "hm_fragment", "*", ")", "item", "-", ">", "data", ";", "dtls1_hm_fragment_free", "(", "frag", ")", ";", "pitem_free", "(", "item", ")", ";", "}", "while", "(", "(", "item", "=", "pqueue_pop", "(", "s", "-", ">", "d1", "-", ">", "buffered_app_data", ".", "q", ")", ")", "!", "=", "NULL", ")", "{", "rdata", "=", "(", "DTLS1_RECORD_DATA", "*", ")", "item", "-", ">", "data", ";", "if", "(", "rdata", "-", ">", "rbuf", ".", "buf", ")", "{", "OPENSSL_free", "(", "rdata", "-", ">", "rbuf", ".", "buf", ")", ";", "}", "OPENSSL_free", "(", "item", "-", ">", "data", ")", ";", "pitem_free", "(", "item", ")", ";", "}", "}", "void", "dtls1_free", "(", "SSL", "*", "s", ")", "{", "ssl3_free", "(", "s", ")", ";", "@", "@", "-", "420", ",", "7", "+", "435", ",", "7", "@", "@", "void", "dtls1_stop_timer", "(", "SSL", "*", "s", ")", "BIO_ctrl", "(", "SSL_get_rbio", "(", "s", ")", ",", "BIO_CTRL_DGRAM_SET_NEXT_TIMEOUT", ",", "0", ",", "&", "(", "s", "-", ">", "d1", "-", ">", "next_timeout", ")", ");", "/", "*", "Clear", "retransmission", "buffer", "*", "/", "dtls1_clear_record_buffer", "(", "s", ")", ";", "dtls1_clear_sent_buffer", "(", "s", ")", ";", "}", "int", "dtls1_check_timeout_num", "(", "SSL", "*", "s", ")", "@", "@", "-", "295", ",", "7", "+", "295", ",", "7", "@", "@", "int", "dtls1_accept", "(", "SSL", "*", "s", ")", "case", "SSL3_ST_SW_HELLO_REQ_B", ":", "s", "-", ">", "shutdown", "=", "0", ";", "dtls1_clear_record_buffer", "(", "s", ")", ";", "dtls1_clear_sent_buffer", "(", "s", ")", ";", "dtls1_start_timer", "(", "s", ")", ";", "ret", "=", "dtls1_send_hello_request", "(", "s", ")", ";", "if", "(", "ret", "<", "=", "0", ")", "@", "@", "-", "866", ",", "6", "+", "866", ",", "7", "@", "@", "int", "dtls1_accept", "(", "SSL", "*", "s", ")", "/", "*", "next", "message", "is", "server", "hello", "*", "/", "s", "-", ">", "d1", "-", ">", "handshake_write_seq", "=", "0", ";", "s", "-", ">", "d1", "-", ">", "next_handshake_write_seq", "=", "0", ";", "dtls1_clear_received_buffer", "(", "s", ")", ";", "goto", "end", ";", "/", "*", "break", ";", "*", "/", "@", "@", "-", "1026", ",", "7", "+", "1026", ",", "8", "@", "@", "int", "dtls1_retransmit_message", "(", "SSL", "*", "s", ",", "unsigned", "short", "seq", ",", "unsigned", "long", "frag_off", ",", "int", "*", "found", ")", ";", "int", "dtls1_get_queue_priority", "(", "unsigned", "short", "seq", ",", "int", "is_ccs", ")", ";", "int", "dtls1_retransmit_buffered_messages", "(", "SSL", "*", "s", ")", ";", "void", "dtls1_clear_record_buffer", "(", "SSL", "*", "s", ")", ";", "void", "dtls1_clear_received_buffer", "(", "SSL", "*", "s", ")", ";", "void", "dtls1_clear_sent_buffer", "(", "SSL", "*", "s", ")", ";", "void", "dtls1_get_message_header", "(", "unsigned", "char", "*", "data", ",", "struct", "hm_header_st", "*", "msg_hdr", ")", ";", "void", "dtls1_get_ccs_header", "(", "unsigned", "char", "*", "data", ",", "struct", "ccs_header_st", "*", "ccs_hdr", ")", ";"], "docstring_tokens": ["the", "failure", "to", "properly", "restrict", "the", "lifetime", "of", "queue", "entries", "associated", "with", "unused", "out-of-order", "messages"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "816", ",", "20", "+", "816", ",", "23", "@", "@", "static", "long", "gfs2_fallocate", "(", "struct", "file", "*", "file", ",", "int", "mode", ",", "loff_t", "offset", ",", "loff_t", "bytes", ",", "max_bytes", ";", "struct", "gfs2_alloc", "*", "al", ";", "int", "error", ";", "loff_t", "bsize_mask", "=", "~", "((", "loff_t", ")", "sdp", "-", ">", "sd_sb", ".", "sb_bsize", "-", "1", ")", ";", "loff_t", "next", "=", "(", "offset", "+", "len", "-", "1", ")", ">", ">", "sdp", "-", ">", "sd_sb", ".", "sb_bsize_shift", ";", "next", "=", "(", "next", "+", "1", ")", "<", "<", "sdp", "-", ">", "sd_sb", ".", "sb_bsize_shift", ";", "/", "*", "We", "only", "support", "the", "FALLOC_FL_KEEP_SIZE", "mode", "*", "/", "if", "(", "mode", "&", "~", "FALLOC_FL_KEEP_SIZE", ")", "return", "-", "EOPNOTSUPP", ";", "offset", "=", "(", "offset", ">", ">", "sdp", "-", ">", "sd_sb", ".", "sb_bsize_shift", ")", "<", "<", "sdp", "-", ">", "sd_sb", ".", "sb_bsize_shift", ";", "offset", "&", "=", "bsize_mask", ";", "len", "=", "next", "-", "offset", ";", "bytes", "=", "sdp", "-", ">", "sd_max_rg_data", "*", "sdp", "-", ">", "sd_sb", ".", "sb_bsize", "/", "2", ";", "if", "(", "!", "bytes", ")", "bytes", "=", "UINT_MAX", ";", "bytes", "&", "=", "bsize_mask", ";", "if", "(", "bytes", "=", "=", "0", ")", "bytes", "=", "sdp", "-", ">", "sd_sb", ".", "sb_bsize", ";", "gfs2_holder_init", "(", "ip", "-", ">", "i_gl", ",", "LM_ST_EXCLUSIVE", ",", "0", ",", "&", "ip", "-", ">", "i_gh", ")", ";", "error", "=", "gfs2_glock_nq", "(", "&", "ip", "-", ">", "i_gh", ")", ";", "@", "@", "-", "860", ",", "6", "+", "863", ",", "9", "@", "@", "static", "long", "gfs2_fallocate", "(", "struct", "file", "*", "file", ",", "int", "mode", ",", "loff_t", "offset", ",", "if", "(", "error", ")", "{", "if", "(", "error", "=", "=", "-", "ENOSPC", "&", "&", "bytes", ">", "sdp", "-", ">", "sd_sb", ".", "sb_bsize", ")", "{", "bytes", ">", ">=", "1", ";", "bytes", "&", "=", "bsize_mask", ";", "if", "(", "bytes", "=", "=", "0", ")", "bytes", "=", "sdp", "-", ">", "sd_sb", ".", "sb_bsize", ";", "goto", "retry", ";", "}", "goto", "out_qunlock", ";"], "docstring_tokens": ["does", "not", "ensure", "that", "the", "size", "of", "a", "chunk", "allocation", "is", "a", "multiple", "of", "the", "block", "size"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "32", ",", "7", "+", "32", ",", "7", "@", "@", "#", "include", "\"", "ext", "/", "standard", "/", "info", ".", "h", "\"", "#", "include", "\"", "php_mbregex", ".", "h", "\"", "#", "include", "\"", "mbstring", ".", "h", "\"", "#", "include", "\"", "php_onig_compat", ".", "h", "\"", "/", "*", "must", "come", "prior", "to", "the", "oniguruma", "header", "*", "/", "#", "include", "<", "oniguruma", ".", "h", ">", "#", "undef", "UChar", "@", "@", "-", "55", ",", "7", "+", "55", ",", "7", "@", "@", "struct", "_zend_mb_regex_globals", "{", "#", "define", "MBREX", "(", "g", ")", "(", "MBSTRG", "(", "mb_regex_globals", ")", "->", "g", ")", "/", "*", "{", "{{", "static", "void", "php_mb_regex_free_cache", "(", ")", "*", "/", "static", "void", "php_mb_regex_free_cache", "(", "php_mb_regex_t", "*", "*", "pre", ")", "static", "void", "php_mb_regex_free_cache", "(", "php_mb_regex_t", "*", "*", "pre", ")", "{", "onig_free", "(", "*", "pre", ")", ";", "}", "@", "@", "-", "78", ",", "7", "+", "78", ",", "7", "@", "@", "static", "int", "_php_mb_regex_globals_ctor", "(", "zend_mb_regex_globals", "*", "pglobals", "TSRMLS_DC", ")", "/", "*", "}", "}}", "*", "/", "/", "*", "{", "{{", "_php_mb_regex_globals_dtor", "*", "/", "static", "void", "_php_mb_regex_globals_dtor", "(", "zend_mb_regex_globals", "*", "pglobals", "TSRMLS_DC", ")", "static", "void", "_php_mb_regex_globals_dtor", "(", "zend_mb_regex_globals", "*", "pglobals", "TSRMLS_DC", ")", "{", "zend_hash_destroy", "(", "&", "pglobals", "-", ">", "ht_rc", ")", ";", "}", "@", "@", "-", "466", ",", "7", "+", "466", ",", "7", "@", "@", "static", "php_mb_regex_t", "*", "php_mbregex_compile_pattern", "(", "const", "char", "*", "pattern", ",", "int", "patl", "retval", "=", "*", "rc", ";", "}", "out", ":", "return", "retval", ";", "return", "retval", ";", "}", "/", "*", "}", "}}", "*", "/", "@", "@", "-", "483", ",", "15", "+", "483", ",", "15", "@", "@", "static", "size_t", "_php_mb_regex_get_option_string", "(", "char", "*", "str", ",", "size_t", "len", ",", "OnigOptionT", "-", "-", "len_left", ";", "*", "(", "p", "+", "+)", "=", "'", "i", "'", ";", "}", "+", "+", "len_req", ";", "+", "+", "len_req", ";", "}", "if", "(", "(", "option", "&", "ONIG_OPTION_EXTEND", ")", "!", "=", "0", ")", "{", "if", "(", "len_left", ">", "0", ")", "{", "-", "-", "len_left", ";", "*", "(", "p", "+", "+)", "=", "'", "x", "'", ";", "}", "+", "+", "len_req", ";", "+", "+", "len_req", ";", "}", "if", "(", "(", "option", "&", "(", "ONIG_OPTION_MULTILINE", "|", "ONIG_OPTION_SINGLELINE", ")", ")", "=", "=", "@", "@", "-", "500", ",", "37", "+", "500", ",", "37", "@", "@", "static", "size_t", "_php_mb_regex_get_option_string", "(", "char", "*", "str", ",", "size_t", "len", ",", "OnigOptionT", "-", "-", "len_left", ";", "*", "(", "p", "+", "+)", "=", "'", "p", "'", ";", "}", "+", "+", "len_req", ";", "+", "+", "len_req", ";", "}", "else", "{", "if", "(", "(", "option", "&", "ONIG_OPTION_MULTILINE", ")", "!", "=", "0", ")", "{", "if", "(", "len_left", ">", "0", ")", "{", "-", "-", "len_left", ";", "*", "(", "p", "+", "+)", "=", "'", "m", "'", ";", "}", "+", "+", "len_req", ";", "+", "+", "len_req", ";", "}", "if", "(", "(", "option", "&", "ONIG_OPTION_SINGLELINE", ")", "!", "=", "0", ")", "{", "if", "(", "len_left", ">", "0", ")", "{", "-", "-", "len_left", ";", "*", "(", "p", "+", "+)", "=", "'", "s", "'", ";", "}", "+", "+", "len_req", ";", "+", "+", "len_req", ";", "}", "}", "}", "if", "(", "(", "option", "&", "ONIG_OPTION_FIND_LONGEST", ")", "!", "=", "0", ")", "{", "if", "(", "len_left", ">", "0", ")", "{", "-", "-", "len_left", ";", "*", "(", "p", "+", "+)", "=", "'", "l", "'", ";", "}", "+", "+", "len_req", ";", "+", "+", "len_req", ";", "}", "if", "(", "(", "option", "&", "ONIG_OPTION_FIND_NOT_EMPTY", ")", "!", "=", "0", ")", "{", "if", "(", "len_left", ">", "0", ")", "{", "-", "-", "len_left", ";", "*", "(", "p", "+", "+)", "=", "'", "n", "'", ";", "}", "+", "+", "len_req", ";", "+", "+", "len_req", ";", "}", "c", "=", "0", ";", "@", "@", "-", "566", ",", "7", "+", "566", ",", "7", "@", "@", "static", "size_t", "_php_mb_regex_get_option_string", "(", "char", "*", "str", ",", "size_t", "len", ",", "OnigOptionT", "-", "-", "len_left", ";", "*", "(", "p", "+", "+)", "=", "'", "\\", "0", "'", ";", "}", "+", "+", "len_req", ";", "+", "+", "len_req", ";", "if", "(", "len", "<", "len_req", ")", "{", "return", "len_req", ";", "}", "@", "@", "-", "577", ",", "11", "+", "577", ",", "11", "@", "@", "static", "size_t", "_php_mb_regex_get_option_string", "(", "char", "*", "str", ",", "size_t", "len", ",", "OnigOptionT", "/", "*", "{", "{{", "_php_mb_regex_init_options", "*", "/", "static", "void", "_php_mb_regex_init_options", "(", "const", "char", "*", "parg", ",", "int", "narg", ",", "OnigOptionType", "*", "option", ",", "OnigSyntaxType", "*", "*", "syntax", ",", "int", "*", "eval", ")", "_php_mb_regex_init_options", "(", "const", "char", "*", "parg", ",", "int", "narg", ",", "OnigOptionType", "*", "option", ",", "OnigSyntaxType", "*", "*", "syntax", ",", "int", "*", "eval", ")", "{", "int", "n", ";", "char", "c", ";", "int", "optm", "=", "0", ";", "int", "optm", "=", "0", ";", "*", "syntax", "=", "ONIG_SYNTAX_RUBY", ";", "@", "@", "-", "636", ",", "13", "+", "636", ",", "13", "@", "@", "_php_mb_regex_init_options", "(", "const", "char", "*", "parg", ",", "int", "narg", ",", "OnigOptionType", "*", "option", ",", "O", "*", "syntax", "=", "ONIG_SYNTAX_POSIX_EXTENDED", ";", "break", ";", "case", "'", "e", "'", ":", "if", "(", "eval", "!", "=", "NULL", ")", "*", "eval", "=", "1", ";", "if", "(", "eval", "!", "=", "NULL", ")", "*", "eval", "=", "1", ";", "break", ";", "default", ":", "break", ";", "}", "}", "if", "(", "option", "!", "=", "NULL", ")", "*", "option", "|", "=", "optm", ";", "if", "(", "option", "!", "=", "NULL", ")", "*", "option", "|", "=", "optm", ";", "}", "}", "/", "*", "}", "}}", "*", "/", "@", "@", "-", "860", ",", "11", "+", "860", ",", "11", "@", "@", "static", "void", "_php_mb_regex_ereg_replace_exec", "(", "INTERNAL_FUNCTION_PARAMETERS", ",", "OnigOp", "}", "else", "{", "/", "*", "FIXME", ":", "this", "code", "is", "not", "multibyte", "aware", "!", "*", "/", "convert_to_long_ex", "(", "arg_pattern_zval", ")", ";", "pat_buf", "[", "0", "]", "=", "(", "char", ")", "Z_LVAL_PP", "(", "arg_pattern_zval", ")", ";", "pat_buf", "[", "0", "]", "=", "(", "char", ")", "Z_LVAL_PP", "(", "arg_pattern_zval", ")", ";", "pat_buf", "[", "1", "]", "=", "'", "\\", "0", "'", ";", "arg_pattern", "=", "pat_buf", ";", "arg_pattern_len", "=", "1", ";", "arg_pattern_len", "=", "1", ";", "}", "/", "*", "create", "regex", "pattern", "buffer", "*", "/", "re", "=", "php_mbregex_compile_pattern", "(", "arg_pattern", ",", "arg_pattern_len", ",", "options", ",", "MBREX", "(", "current_mbctype", ")", ",", "syntax", "TSRMLS_CC", ")", ";", "@", "@", "-", "934", ",", "7", "+", "934", ",", "7", "@", "@", "static", "void", "_php_mb_regex_ereg_replace_exec", "(", "INTERNAL_FUNCTION_PARAMETERS", ",", "OnigOp", "}", "}", "}", "if", "(", "eval", ")", "{", "zval", "v", ";", "/", "*", "null", "terminate", "buffer", "*", "/", "@", "@", "-", "953", ",", "32", "+", "953", ",", "31", "@", "@", "static", "void", "_php_mb_regex_ereg_replace_exec", "(", "INTERNAL_FUNCTION_PARAMETERS", ",", "OnigOp", "eval_buf", ".", "len", "=", "0", ";", "zval_dtor", "(", "&", "v", ")", ";", "}", "else", "if", "(", "is_callable", ")", "{", "zval", "*", "retval_ptr", ";", "zval", "*", "retval_ptr", "=", "NULL", ";", "zval", "*", "*", "args", "[", "1", "]", ";", "zval", "*", "subpats", ";", "int", "i", ";", "MAKE_STD_ZVAL", "(", "subpats", ")", ";", "array_init", "(", "subpats", ")", ";", "for", "(", "i", "=", "0", ";", "i", "<", "regs", "-", ">", "num_regs", ";", "i", "+", "+)", "{", "add_next_index_stringl", "(", "subpats", ",", "string", "+", "regs", "-", ">", "beg", "[", "i", "]", ",", "regs", "-", ">", "end", "[", "i", "]", "-", "regs", "-", ">", "beg", "[", "i", "]", ",", "1", ")", ";", "}", "}", "args", "[", "0", "]", "=", "&", "subpats", ";", "/", "*", "null", "terminate", "buffer", "*", "/", "smart_str_0", "(", "&", "eval_buf", ")", ";", "arg_replace_fci", ".", "param_count", "=", "1", ";", "arg_replace_fci", ".", "params", "=", "args", ";", "arg_replace_fci", ".", "retval_ptr_ptr", "=", "&", "retval_ptr", ";", "if", "(", "zend_call_function", "(", "&", "arg_replace_fci", ",", "&", "arg_replace_fci_cache", "TSRMLS_CC", ")", "=", "=", "SUCCESS", "&", "&", "arg_replace_fci", ".", "retval_ptr_ptr", ")", "{", "if", "(", "zend_call_function", "(", "&", "arg_replace_fci", ",", "&", "arg_replace_fci_cache", "TSRMLS_CC", ")", "=", "=", "SUCCESS", "&", "&", "arg_replace_fci", ".", "retval_ptr_ptr", "&", "&", "retval_ptr", ")", "{", "convert_to_string_ex", "(", "&", "retval_ptr", ")", ";", "smart_str_appendl", "(", "&", "out_buf", ",", "Z_STRVAL_P", "(", "retval_ptr", ")", ",", "Z_STRLEN_P", "(", "retval_ptr", ")", ");", "eval_buf", ".", "len", "=", "0", ";", "zval_ptr_dtor", "(", "&", "retval_ptr", ")", ";", "}", "else", "{", "efree", "(", "description", ")", ";", "if", "(", "!", "EG", "(", "exception", ")", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "Unable", "to", "call", "custom", "replacement", "function", "\"", ");", "}", "@", "@", "-", "991", ",", "7", "+", "990", ",", "7", "@", "@", "static", "void", "_php_mb_regex_ereg_replace_exec", "(", "INTERNAL_FUNCTION_PARAMETERS", ",", "OnigOp", "pos", "=", "(", "OnigUChar", "*", ")", "string", "+", "n", ";", "}", "else", "{", "if", "(", "pos", "<", "string_lim", ")", "{", "smart_str_appendl", "(", "&", "out_buf", ",", "pos", ",", "1", ")", ";", "smart_str_appendl", "(", "&", "out_buf", ",", "pos", ",", "1", ")", ";", "}", "pos", "+", "+;", "}", "@", "@", "-", "1013", ",", "7", "+", "1012", ",", "7", "@", "@", "static", "void", "_php_mb_regex_ereg_replace_exec", "(", "INTERNAL_FUNCTION_PARAMETERS", ",", "OnigOp", "smart_str_free", "(", "&", "eval_buf", ")", ";", "if", "(", "err", "<", "=", "-", "2", ")", "{", "smart_str_free", "(", "&", "out_buf", ")", ";", "smart_str_free", "(", "&", "out_buf", ")", ";", "RETVAL_FALSE", ";", "}", "else", "{", "smart_str_appendc", "(", "&", "out_buf", ",", "'", "\\", "0", "'", ");", "@", "@", "-", "1063", ",", "7", "+", "1062", ",", "7", "@", "@", "PHP_FUNCTION", "(", "mb_split", ")", "if", "(", "zend_parse_parameters", "(", "ZEND_NUM_ARGS", "(", ")", "TSRMLS_CC", ",", "\"", "ss", "|", "l", "\"", ",", "&", "arg_pattern", ",", "&", "arg_pattern_len", ",", "&", "string", ",", "&", "string_len", ",", "&", "count", ")", "=", "=", "FAILURE", ")", "{", "RETURN_FALSE", ";", "}", "}", "if", "(", "count", ">", "0", ")", "{", "count", "-", "-;", "@", "@", "-", "1317", ",", "7", "+", "1316", ",", "7", "@", "@", "PHP_FUNCTION", "(", "mb_ereg_search_init", ")", "if", "(", "zend_parse_parameters", "(", "argc", "TSRMLS_CC", ",", "\"", "z", "|", "ss", "\"", ",", "&", "arg_str", ",", "&", "arg_pattern", ",", "&", "arg_pattern_len", ",", "&", "arg_options", ",", "&", "arg_options_len", ")", "=", "=", "FAILURE", ")", "{", "return", ";", "}", "if", "(", "argc", ">", "1", "&", "&", "arg_pattern_len", "=", "=", "0", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "Empty", "pattern", "\"", ");", "RETURN_FALSE", ";", "@", "@", "-", "1416", ",", "7", "+", "1415", ",", "7", "@", "@", "PHP_FUNCTION", "(", "mb_ereg_search_setpos", ")", "/", "*", "}", "}}", "*", "/", "/", "*", "{", "{{", "php_mb_regex_set_options", "*", "/", "static", "void", "_php_mb_regex_set_options", "(", "OnigOptionType", "options", ",", "OnigSyntaxType", "*", "syntax", ",", "OnigOptionType", "*", "prev_options", ",", "OnigSyntaxType", "*", "*", "prev_syntax", "TSRMLS_DC", ")", "static", "void", "_php_mb_regex_set_options", "(", "OnigOptionType", "options", ",", "OnigSyntaxType", "*", "syntax", ",", "OnigOptionType", "*", "prev_options", ",", "OnigSyntaxType", "*", "*", "prev_syntax", "TSRMLS_DC", ")", "{", "if", "(", "prev_options", "!", "=", "NULL", ")", "{", "*", "prev_options", "=", "MBREX", "(", "regex_default_options", ")", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "17", "@", "@", "-", "-", "TEST", "-", "-", "Bug", "#", "72402", ":", "_php_mb_regex_ereg_replace_exec", "-", "double", "free", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "extension_loaded", "(", "'", "mbstring", "'", ")", "or", "die", "(", "'", "skip", "mbstring", "not", "available", "'", ");", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "function", "throwit", "(", ")", "{", "throw", "new", "Exception", "(", "'", "it", "'", ");", "}", "$", "var10", "=", "\"", "throwit", "\"", ";", "try", "{", "$", "var14", "=", "mb_ereg_replace_callback", "(", "\"\"", ",", "$", "var10", ",", "\"", "\")", ";", "}", "catch", "(", "Exception", "$", "e", ")", "{", "}", "?", ">", "DONE", "-", "-", "EXPECT", "-", "-", "DONE", "\\", "No", "newline", "at", "end", "of", "file"], "docstring_tokens": ["integer", "overflows)"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1063", ",", "7", "+", "1063", ",", "7", "@", "@", "static", "int", "mp_wait_modem_status", "(", "struct", "sb_uart_state", "*", "state", ",", "unsigned", "long", "arg", ")", "static", "int", "mp_get_count", "(", "struct", "sb_uart_state", "*", "state", ",", "struct", "serial_icounter_struct", "*", "icnt", ")", "{", "struct", "serial_icounter_struct", "icount", ";", "struct", "serial_icounter_struct", "icount", "=", "{", "};", "struct", "sb_uart_icount", "cnow", ";", "struct", "sb_uart_port", "*", "port", "=", "state", "-", ">", "port", ";"], "docstring_tokens": ["the", "failure", "to", "initialize", "a", "certain", "data", "structure"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "9529", ",", "6", "+", "9529", ",", "37", "@", "@", "static", "int", "perf_event_set_clock", "(", "struct", "perf_event", "*", "event", ",", "clockid_t", "clk_id", ")", "return", "0", ";", "}", "/", "*", "*", "Variation", "on", "perf_event_ctx_lock_nested", "(", "),", "except", "we", "take", "two", "context", "*", "mutexes", ".", "*", "/", "static", "struct", "perf_event_context", "*", "__perf_event_ctx_lock_double", "(", "struct", "perf_event", "*", "group_leader", ",", "struct", "perf_event_context", "*", "ctx", ")", "{", "struct", "perf_event_context", "*", "gctx", ";", "again", ":", "rcu_read_lock", "(", ");", "gctx", "=", "READ_ONCE", "(", "group_leader", "-", ">", "ctx", ")", ";", "if", "(", "!", "atomic_inc_not_zero", "(", "&", "gctx", "-", ">", "refcount", ")", ")", "{", "rcu_read_unlock", "(", ");", "goto", "again", ";", "}", "rcu_read_unlock", "(", ");", "mutex_lock_double", "(", "&", "gctx", "-", ">", "mutex", ",", "&", "ctx", "-", ">", "mutex", ")", ";", "if", "(", "group_leader", "-", ">", "ctx", "!", "=", "gctx", ")", "{", "mutex_unlock", "(", "&", "ctx", "-", ">", "mutex", ")", ";", "mutex_unlock", "(", "&", "gctx", "-", ">", "mutex", ")", ";", "put_ctx", "(", "gctx", ")", ";", "goto", "again", ";", "}", "return", "gctx", ";", "}", "/", "**", "*", "sys_perf_event_open", "-", "open", "a", "performance", "event", ",", "associate", "it", "to", "a", "task", "/", "cpu", "*", "@", "@", "-", "9772", ",", "12", "+", "9803", ",", "31", "@", "@", "SYSCALL_DEFINE5", "(", "perf_event_open", ",", "}", "if", "(", "move_group", ")", "{", "gctx", "=", "group_leader", "-", ">", "ctx", ";", "mutex_lock_double", "(", "&", "gctx", "-", ">", "mutex", ",", "&", "ctx", "-", ">", "mutex", ")", ";", "gctx", "=", "__perf_event_ctx_lock_double", "(", "group_leader", ",", "ctx", ")", ";", "if", "(", "gctx", "-", ">", "task", "=", "=", "TASK_TOMBSTONE", ")", "{", "err", "=", "-", "ESRCH", ";", "goto", "err_locked", ";", "}", "/", "*", "*", "Check", "if", "we", "raced", "against", "another", "sys_perf_event_open", "(", ")", "call", "*", "moving", "the", "software", "group", "underneath", "us", ".", "*", "/", "if", "(", "!(", "group_leader", "-", ">", "group_caps", "&", "PERF_EV_CAP_SOFTWARE", ")", ")", "{", "/", "*", "*", "If", "someone", "moved", "the", "group", "out", "from", "under", "us", ",", "check", "*", "if", "this", "new", "event", "wound", "up", "on", "the", "same", "ctx", ",", "if", "so", "*", "its", "the", "regular", "!", "move_group", "case", ",", "otherwise", "fail", ".", "*", "/", "if", "(", "gctx", "!", "=", "ctx", ")", "{", "err", "=", "-", "EINVAL", ";", "goto", "err_locked", ";", "}", "else", "{", "perf_event_ctx_unlock", "(", "group_leader", ",", "gctx", ")", ";", "move_group", "=", "0", ";", "}", "}", "}", "else", "{", "mutex_lock", "(", "&", "ctx", "-", ">", "mutex", ")", ";", "}", "@", "@", "-", "9879", ",", "7", "+", "9929", ",", "7", "@", "@", "SYSCALL_DEFINE5", "(", "perf_event_open", ",", "perf_unpin_context", "(", "ctx", ")", ";", "if", "(", "move_group", ")", "mutex_unlock", "(", "&", "gctx", "-", ">", "mutex", ")", ";", "perf_event_ctx_unlock", "(", "group_leader", ",", "gctx", ")", ";", "mutex_unlock", "(", "&", "ctx", "-", ">", "mutex", ")", ";", "if", "(", "task", ")", "{", "@", "@", "-", "9905", ",", "7", "+", "9955", ",", "7", "@", "@", "SYSCALL_DEFINE5", "(", "perf_event_open", ",", "err_locked", ":", "if", "(", "move_group", ")", "mutex_unlock", "(", "&", "gctx", "-", ">", "mutex", ")", ";", "perf_event_ctx_unlock", "(", "group_leader", ",", "gctx", ")", ";", "mutex_unlock", "(", "&", "ctx", "-", ">", "mutex", ")", ";", "/", "*", "err_file", ":", "*", "/", "fput", "(", "event_file", ")", ";"], "docstring_tokens": ["didn't", "apply", "the", "established", "locking", "rules", "correctly"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "545", ",", "6", "+", "545", ",", "8", "@", "@", "static", "MagickBooleanType", "WriteIPLImage", "(", "const", "ImageInfo", "*", "image_info", ",", "Image", "*", "image", ")", "scene", "=", "0", ";", "quantum_info", "=", "AcquireQuantumInfo", "(", "image_info", ",", "image", ")", ";", "if", "(", "quantum_info", "=", "=", "(", "QuantumInfo", "*", ")", "NULL", ")", "ThrowWriterException", "(", "ResourceLimitError", ",", "\"", "MemoryAllocationFailed", "\"", ");", "if", "(", "(", "quantum_info", "-", ">", "format", "=", "=", "UndefinedQuantumFormat", ")", "&", "&", "(", "IsHighDynamicRangeImage", "(", "image", ",", "&", "image", "-", ">", "exception", ")", "!", "=", "MagickFalse", ")", ")", "SetQuantumFormat", "(", "image", ",", "quantum_info", ",", "FloatingPointQuantumFormat", ")", ";"], "docstring_tokens": ["missing", "malloc", "check"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "426", ",", "7", "+", "426", ",", "7", "@", "@", "static", "int", "dummy_file_mmap", "(", "struct", "file", "*", "file", ",", "unsigned", "long", "reqprot", ",", "unsigned", "long", "addr", ",", "unsigned", "long", "addr_only", ")", "{", "if", "(", "addr", "<", "mmap_min_addr", ")", "if", "(", "(", "addr", "<", "mmap_min_addr", ")", "&", "&", "!", "capable", "(", "CAP_SYS_RAWIO", ")", ")", "return", "-", "EACCES", ";", "return", "0", ";", "}"], "docstring_tokens": ["map", "low", "memory", "areas"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "12", ",", "15", "+", "12", ",", "22", "@", "@", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "FileReader", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "StringReader", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "logging", ".", "Level", ";", "import", "java", ".", "util", ".", "logging", ".", "Logger", ";", "import", "jenkins", ".", "security", ".", "MasterToSlaveCallable", ";", "import", "org", ".", "w3c", ".", "dom", ".", "*;", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "xpath", ".", "*;", "import", "javax", ".", "xml", ".", "parsers", ".", "*;", "import", "org", ".", "xml", ".", "sax", ".", "EntityResolver", ";", "import", "org", ".", "xml", ".", "sax", ".", "InputSource", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "tokenmacro", ".", "DataBoundTokenMacro", ";", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "tokenmacro", ".", "MacroEvaluationException", ";", "@", "@", "-", "69", ",", "19", "+", "76", ",", "66", "@", "@", "public", "String", "evaluate", "(", "Run", "<", "?,", "?>", "run", ",", "FilePath", "workspace", ",", "TaskListener", "listener", ",", "private", "String", "filename", ";", "private", "String", "xpathexpression", ";", "private", "static", "final", "String", "DISALLOW_DOCTYPE_DECL", "=", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", ";", "private", "static", "final", "String", "EXTERNAL_GENERAL_ENTITIES", "=", "\"", "http", ":", "//", "xml", ".", "org", "/", "sax", "/", "features", "/", "external", "-", "general", "-", "entities", "\"", ";", "private", "static", "final", "String", "EXTERNAL_PARAMETER_ENTITIES", "=", "\"", "http", ":", "//", "xml", ".", "org", "/", "sax", "/", "features", "/", "external", "-", "parameter", "-", "entities", "\"", ";", "private", "static", "final", "String", "LOAD_EXTERNAL_DTD", "=", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "nonvalidating", "/", "load", "-", "external", "-", "dtd", "\"", ";", "public", "ReadXML", "(", "String", "root", ",", "String", "filename", ",", "String", "xpath", ")", "{", "this", ".", "root", "=", "root", ";", "this", ".", "filename", "=", "filename", ";", "this", ".", "xpathexpression", "=", "xpath", ";", "}", "public", "String", "call", "(", ")", "throws", "IOException", "{", "private", "DocumentBuilderFactory", "createFactory", "(", ")", "{", "DocumentBuilderFactory", "dFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "HashMap", "<", "String", ",", "Boolean", ">", "features", "=", "new", "HashMap", "<", ">(", ");", "features", ".", "put", "(", "DISALLOW_DOCTYPE_DECL", ",", "true", ")", ";", "features", ".", "put", "(", "EXTERNAL_GENERAL_ENTITIES", ",", "false", ")", ";", "features", ".", "put", "(", "EXTERNAL_PARAMETER_ENTITIES", ",", "false", ")", ";", "features", ".", "put", "(", "LOAD_EXTERNAL_DTD", ",", "false", ")", ";", "for", "(", "String", "feature", ":", "features", ".", "keySet", "(", "))", "{", "try", "{", "dFactory", ".", "setFeature", "(", "feature", ",", "features", ".", "get", "(", "feature", ")", ");", "}", "catch", "(", "ParserConfigurationException", "e", ")", "{", "LOGGER", ".", "log", "(", "Level", ".", "INFO", ",", "\"", "Could", "not", "enable", "/", "disable", "feature", ":", "\"", "+", "feature", ")", ";", "}", "}", "HashMap", "<", "String", ",", "String", ">", "attributes", "=", "new", "HashMap", "<", ">(", ");", "attributes", ".", "put", "(", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "\"", "true", "\"", ");", "attributes", ".", "put", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_DTD", ",", "\"", "\")", ";", "attributes", ".", "put", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_SCHEMA", ",", "\"", "\")", ";", "attributes", ".", "put", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_STYLESHEET", ",", "\"", "\")", ";", "for", "(", "String", "attribute", ":", "attributes", ".", "keySet", "(", "))", "{", "try", "{", "dFactory", ".", "setAttribute", "(", "attribute", ",", "attributes", ".", "get", "(", "attribute", ")", ");", "}", "catch", "(", "IllegalArgumentException", "e", ")", "{", "LOGGER", ".", "log", "(", "Level", ".", "INFO", ",", "\"", "Could", "not", "set", "attribute", ":", "\"", "+", "attribute", ")", ";", "}", "}", "dFactory", ".", "setXIncludeAware", "(", "false", ")", ";", "dFactory", ".", "setExpandEntityReferences", "(", "false", ")", ";", "return", "dFactory", ";", "}", "public", "String", "call", "(", ")", "{", "File", "file", "=", "new", "File", "(", "root", ",", "filename", ")", ";", "String", "result", "=", "\"", "\";", "if", "(", "file", ".", "exists", "(", "))", "{", "try", "{", "DocumentBuilderFactory", "dFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "DocumentBuilderFactory", "dFactory", "=", "createFactory", "(", ");", "EntityResolver", "noop", "=", "new", "EntityResolver", "(", ")", "{", "@", "Override", "public", "InputSource", "resolveEntity", "(", "String", "publicId", ",", "String", "systemId", ")", "{", "return", "new", "InputSource", "(", "new", "StringReader", "(", "\"\"", "))", ";", "}", "}", ";", "DocumentBuilder", "builder", "=", "dFactory", ".", "newDocumentBuilder", "(", ");", "builder", ".", "setEntityResolver", "(", "noop", ")", ";", "Document", "doc", "=", "builder", ".", "parse", "(", "file", ".", "toString", "(", "))", ";", "XPath", "xpathInstance", "=", "XPathFactory", ".", "newInstance", "(", ").", "newXPath", "(", ");", "XPathExpression", "expr", "=", "xpathInstance", ".", "compile", "(", "xpathexpression", ")", ";"], "docstring_tokens": ["require", "Overall/Administer", "or", "Job/Configure", "permission"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "124", ",", "8", "+", "124", ",", "7", "@", "@", "public", "UnixUser", "authenticate", "(", "String", "username", ",", "String", "password", ")", "throws", "PAMExcepti", "check", "(", "libpam", ".", "pam_set_item", "(", "pht", ",", "PAM_USER", ",", "username", ")", ",\"", "pam_set_item", "failed", "\"", ");", "check", "(", "libpam", ".", "pam_authenticate", "(", "pht", ",", "0", ")", ",\"", "pam_authenticate", "failed", "\"", ");", "check", "(", "libpam", ".", "pam_setcred", "(", "pht", ",", "0", ")", ",\"", "pam_setcred", "failed", "\"", ");", "/", "/", "several", "different", "error", "code", "seem", "to", "be", "used", "to", "represent", "authentication", "failures", "/", "/", "check", "(", "libpam", ".", "pam_acct_mgmt", "(", "pht", ",", "0", ")", ",\"", "pam_acct_mgmt", "failed", "\"", ");", "check", "(", "libpam", ".", "pam_acct_mgmt", "(", "pht", ",", "0", ")", ",\"", "pam_acct_mgmt", "failed", "\"", ");", "PointerByReference", "r", "=", "new", "PointerByReference", "(", ");", "check", "(", "libpam", ".", "pam_get_item", "(", "pht", ",", "PAM_USER", ",", "r", ")", ",\"", "pam_get_item", "failed", "\"", ");"], "docstring_tokens": ["did", "not", "properly", "validate", "user", "accounts", "when", "authenticating", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "156", ",", "6", "+", "156", ",", "9", "@", "@", "static", "int", "ttusbdecfe_dvbs_diseqc_send_master_cmd", "(", "struct", "dvb_frontend", "*", "fe", ",", "struc", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", ",", "0x00", "}", ";", "if", "(", "cmd", "-", ">", "msg_len", ">", "sizeof", "(", "b", ")", "-", "4", ")", "return", "-", "EINVAL", ";", "memcpy", "(", "&", "b", "[", "4", "]", ",", "cmd", "-", ">", "msg", ",", "cmd", "-", ">", "msg_len", ")", ";", "state", "-", ">", "config", "-", ">", "send_command", "(", "fe", ",", "0x72", ","], "docstring_tokens": ["improper", "bounds", "checking"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "61", ",", "7", "+", "61", ",", "6", "@", "@", "before", "the", "more", "general", "line", "given", "above", "as", "the", "first", "match", "is", "the", "one", "taken", ".", "create", "dns_resolver", "foo", ":", "*", "*", "/", "usr", "/", "sbin", "/", "dns", ".", "foo", "%", "k", "=", "==", "==", "USAGE", "=", "==", "==", "@", "@", "-", "104", ",", "6", "+", "103", ",", "14", "@", "@", "implemented", "in", "the", "module", "can", "be", "called", "after", "doing", ":", "returned", "also", ".", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "READING", "DNS", "KEYS", "FROM", "USERSPACE", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "Keys", "of", "dns_resolver", "type", "can", "be", "read", "from", "userspace", "using", "keyctl_read", "(", ")", "or", "\"", "keyctl", "read", "/", "print", "/", "pipe", "\"", ".", "=", "==", "==", "==", "==", "MECHANISM", "=", "==", "==", "==", "==", "@", "@", "-", "67", ",", "8", "+", "67", ",", "9", "@", "@", "dns_resolver_instantiate", "(", "struct", "key", "*", "key", ",", "const", "void", "*", "_data", ",", "size_t", "datalen", ")", "size_t", "result_len", "=", "0", ";", "const", "char", "*", "data", "=", "_data", ",", "*", "end", ",", "*", "opt", ";", "kenter", "(", "\"%", "%%", "d", ",", "%", "s", ",", "'%", "s", "'", ",%", "zu", "\"", ",", "key", "-", ">", "serial", ",", "key", "-", ">", "description", ",", "data", ",", "datalen", ")", ";", "kenter", "(", "\"%", "%%", "d", ",", "%", "s", ",", "'%", "*.", "*", "s", "'", ",%", "zu", "\"", ",", "key", "-", ">", "serial", ",", "key", "-", ">", "description", ",", "(", "int", ")", "datalen", ",", "(", "int", ")", "datalen", ",", "data", ",", "datalen", ")", ";", "if", "(", "datalen", "<", "=", "1", "|", "|", "!", "data", "|", "|", "data", "[", "datalen", "-", "1", "]", "!", "=", "'", "\\", "0", "'", ")", "return", "-", "EINVAL", ";", "@", "@", "-", "217", ",", "14", "+", "218", ",", "27", "@", "@", "static", "void", "dns_resolver_describe", "(", "const", "struct", "key", "*", "key", ",", "struct", "seq_file", "*", "m", ")", "seq_printf", "(", "m", ",", "\"", ":", "%", "u", "\"", ",", "key", "-", ">", "datalen", ")", ";", "}", "/", "*", "*", "read", "the", "DNS", "data", "*", "-", "the", "key", "'", "s", "semaphore", "is", "read", "-", "locked", "*", "/", "static", "long", "dns_resolver_read", "(", "const", "struct", "key", "*", "key", ",", "char", "__user", "*", "buffer", ",", "size_t", "buflen", ")", "{", "if", "(", "key", "-", ">", "type_data", ".", "x", "[", "0", "]", ")", "return", "key", "-", ">", "type_data", ".", "x", "[", "0", "]", ";", "return", "user_read", "(", "key", ",", "buffer", ",", "buflen", ")", ";", "}", "struct", "key_type", "key_type_dns_resolver", "=", "{", ".", "name", "=", "\"", "dns_resolver", "\"", ",", ".", "instantiate", "=", "dns_resolver_instantiate", ",", ".", "match", "=", "dns_resolver_match", ",", ".", "revoke", "=", "user_revoke", ",", ".", "destroy", "=", "user_destroy", ",", ".", "describe", "=", "dns_resolver_describe", ",", ".", "read", "=", "user_read", ",", ".", "read", "=", "dns_resolver_read", ",", "}", ";", "static", "int", "__init", "init_dns_resolver", "(", "void", ")"], "docstring_tokens": ["read", "an", "error", "key"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1", ",", "32", "+", "1", ",", "25", "@", "@", "package", "hudson", ".", "plugins", ".", "favorite", ";", "import", "com", ".", "google", ".", "inject", ".", "Inject", ";", "import", "hudson", ".", "Plugin", ";", "import", "hudson", ".", "model", ".", "Item", ";", "import", "hudson", ".", "model", ".", "User", ";", "import", "hudson", ".", "plugins", ".", "favorite", ".", "Favorites", ".", "FavoriteException", ";", "import", "org", ".", "acegisecurity", ".", "Authentication", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "QueryParameter", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerResponse", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "javax", ".", "annotation", ".", "Nonnull", ";", "import", "java", ".", "io", ".", "IOException", ";", "public", "class", "FavoritePlugin", "extends", "Plugin", "{", "/", "/", "For", "stapler", "public", "void", "doToggleFavorite", "(", "StaplerRequest", "req", ",", "StaplerResponse", "resp", ",", "@", "QueryParameter", "String", "job", ",", "@", "QueryParameter", "String", "userName", ",", "@", "QueryParameter", "Boolean", "redirect", ")", "throws", "IOException", "{", "if", "(", "\"\"", ".", "equals", "(", "userName", ")", "|", "|", "userName", "=", "=", "null", ")", "{", "Authentication", "authentication", "=", "Jenkins", ".", "getAuthentication", "(", ");", "userName", "=", "authentication", ".", "getName", "(", ");", "}", "public", "void", "doToggleFavorite", "(", "StaplerRequest", "req", ",", "StaplerResponse", "resp", ",", "@", "QueryParameter", "String", "job", ",", "@", "QueryParameter", "Boolean", "redirect", ")", "throws", "IOException", "{", "Jenkins", "jenkins", "=", "Jenkins", ".", "getInstance", "(", ");", "if", "(", "jenkins", "=", "=", "null", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "Jenkins", "not", "started", "\"", ");", "}", "User", "user", "=", "jenkins", ".", "getUser", "(", "userName", ")", ";", "User", "user", "=", "User", ".", "current", "(", ");", "if", "(", "user", "!", "=", "null", "&", "&", "!", "isAnonymous", "(", "user", ")", ")", "{", "try", "{", "Favorites", ".", "toggleFavorite", "(", "user", ",", "getItem", "(", "job", ")", ");"], "docstring_tokens": ["does", "not", "perform", "permission", "checks", "when", "changing", "favorite", "status"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "78", ",", "23", "+", "78", ",", "14", "@", "@", "static", "void", "rd_detach_hba", "(", "struct", "se_hba", "*", "hba", ")", "hba", "-", ">", "hba_ptr", "=", "NULL", ";", "}", "/", "*", "rd_release_device_space", "(", "):", "*", "*", "*", "/", "static", "void", "rd_release_device_space", "(", "struct", "rd_dev", "*", "rd_dev", ")", "static", "u32", "rd_release_sgl_table", "(", "struct", "rd_dev", "*", "rd_dev", ",", "struct", "rd_dev_sg_table", "*", "sg_table", ",", "u32", "sg_table_count", ")", "{", "u32", "i", ",", "j", ",", "page_count", "=", "0", ",", "sg_per_table", ";", "struct", "rd_dev_sg_table", "*", "sg_table", ";", "struct", "page", "*", "pg", ";", "struct", "scatterlist", "*", "sg", ";", "u32", "i", ",", "j", ",", "page_count", "=", "0", ",", "sg_per_table", ";", "if", "(", "!", "rd_dev", "-", ">", "sg_table_array", "|", "|", "!", "rd_dev", "-", ">", "sg_table_count", ")", "return", ";", "sg_table", "=", "rd_dev", "-", ">", "sg_table_array", ";", "for", "(", "i", "=", "0", ";", "i", "<", "rd_dev", "-", ">", "sg_table_count", ";", "i", "+", "+)", "{", "for", "(", "i", "=", "0", ";", "i", "<", "sg_table_count", ";", "i", "+", "+)", "{", "sg", "=", "sg_table", "[", "i", "]", ".", "sg_table", ";", "sg_per_table", "=", "sg_table", "[", "i", "]", ".", "rd_sg_count", ";", "@", "@", "-", "105", ",", "16", "+", "96", ",", "28", "@", "@", "static", "void", "rd_release_device_space", "(", "struct", "rd_dev", "*", "rd_dev", ")", "page_count", "+", "+;", "}", "}", "kfree", "(", "sg", ")", ";", "}", "kfree", "(", "sg_table", ")", ";", "return", "page_count", ";", "}", "static", "void", "rd_release_device_space", "(", "struct", "rd_dev", "*", "rd_dev", ")", "{", "u32", "page_count", ";", "if", "(", "!", "rd_dev", "-", ">", "sg_table_array", "|", "|", "!", "rd_dev", "-", ">", "sg_table_count", ")", "return", ";", "page_count", "=", "rd_release_sgl_table", "(", "rd_dev", ",", "rd_dev", "-", ">", "sg_table_array", ",", "rd_dev", "-", ">", "sg_table_count", ")", ";", "pr_debug", "(", "\"", "CORE_RD", "[", "%", "u", "]", "-", "Released", "device", "space", "for", "Ramdisk", "\"", "\"", "Device", "ID", ":", "%", "u", ",", "pages", "%", "u", "in", "%", "u", "tables", "total", "bytes", "%", "lu", "\\", "n", "\"", ",", "rd_dev", "-", ">", "rd_host", "-", ">", "rd_host_id", ",", "rd_dev", "-", ">", "rd_dev_id", ",", "page_count", ",", "rd_dev", "-", ">", "sg_table_count", ",", "(", "unsigned", "long", ")", "page_count", "*", "PAGE_SIZE", ")", ";", "kfree", "(", "sg_table", ")", ";", "rd_dev", "-", ">", "sg_table_array", "=", "NULL", ";", "rd_dev", "-", ">", "sg_table_count", "=", "0", ";", "}", "@", "@", "-", "124", ",", "38", "+", "127", ",", "15", "@", "@", "static", "void", "rd_release_device_space", "(", "struct", "rd_dev", "*", "rd_dev", ")", "*", "*", "*", "/", "static", "int", "rd_build_device_space", "(", "struct", "rd_dev", "*", "rd_dev", ")", "static", "int", "rd_allocate_sgl_table", "(", "struct", "rd_dev", "*", "rd_dev", ",", "struct", "rd_dev_sg_table", "*", "sg_table", ",", "u32", "total_sg_needed", ",", "unsigned", "char", "init_payload", ")", "{", "u32", "i", "=", "0", ",", "j", ",", "page_offset", "=", "0", ",", "sg_per_table", ",", "sg_tables", ",", "total_sg_needed", ";", "u32", "i", "=", "0", ",", "j", ",", "page_offset", "=", "0", ",", "sg_per_table", ";", "u32", "max_sg_per_table", "=", "(", "RD_MAX_ALLOCATION_SIZE", "/", "sizeof", "(", "struct", "scatterlist", ")", ");", "struct", "rd_dev_sg_table", "*", "sg_table", ";", "struct", "page", "*", "pg", ";", "struct", "scatterlist", "*", "sg", ";", "if", "(", "rd_dev", "-", ">", "rd_page_count", "<", "=", "0", ")", "{", "pr_err", "(", "\"", "Illegal", "page", "count", ":", "%", "u", "for", "Ramdisk", "device", "\\", "n", "\"", ",", "rd_dev", "-", ">", "rd_page_count", ")", ";", "return", "-", "EINVAL", ";", "}", "/", "*", "Don", "'", "t", "need", "backing", "pages", "for", "NULLIO", "*", "/", "if", "(", "rd_dev", "-", ">", "rd_flags", "&", "RDF_NULLIO", ")", "return", "0", ";", "total_sg_needed", "=", "rd_dev", "-", ">", "rd_page_count", ";", "sg_tables", "=", "(", "total_sg_needed", "/", "max_sg_per_table", ")", "+", "1", ";", "sg_table", "=", "kzalloc", "(", "sg_tables", "*", "sizeof", "(", "struct", "rd_dev_sg_table", ")", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "sg_table", ")", "{", "pr_err", "(", "\"", "Unable", "to", "allocate", "memory", "for", "Ramdisk", "\"", "\"", "scatterlist", "tables", "\\", "n", "\"", ");", "return", "-", "ENOMEM", ";", "}", "rd_dev", "-", ">", "sg_table_array", "=", "sg_table", ";", "rd_dev", "-", ">", "sg_table_count", "=", "sg_tables", ";", "unsigned", "char", "*", "p", ";", "while", "(", "total_sg_needed", ")", "{", "sg_per_table", "=", "(", "total_sg_needed", ">", "max_sg_per_table", ")", "?", "@", "@", "-", "186", ",", "16", "+", "166", ",", "59", "@", "@", "static", "int", "rd_build_device_space", "(", "struct", "rd_dev", "*", "rd_dev", ")", "}", "sg_assign_page", "(", "&", "sg", "[", "j", "]", ",", "pg", ")", ";", "sg", "[", "j", "]", ".", "length", "=", "PAGE_SIZE", ";", "p", "=", "kmap", "(", "pg", ")", ";", "memset", "(", "p", ",", "init_payload", ",", "PAGE_SIZE", ")", ";", "kunmap", "(", "pg", ")", ";", "}", "page_offset", "+", "=", "sg_per_table", ";", "total_sg_needed", "-", "=", "sg_per_table", ";", "}", "return", "0", ";", "}", "static", "int", "rd_build_device_space", "(", "struct", "rd_dev", "*", "rd_dev", ")", "{", "struct", "rd_dev_sg_table", "*", "sg_table", ";", "u32", "sg_tables", ",", "total_sg_needed", ";", "u32", "max_sg_per_table", "=", "(", "RD_MAX_ALLOCATION_SIZE", "/", "sizeof", "(", "struct", "scatterlist", ")", ");", "int", "rc", ";", "if", "(", "rd_dev", "-", ">", "rd_page_count", "<", "=", "0", ")", "{", "pr_err", "(", "\"", "Illegal", "page", "count", ":", "%", "u", "for", "Ramdisk", "device", "\\", "n", "\"", ",", "rd_dev", "-", ">", "rd_page_count", ")", ";", "return", "-", "EINVAL", ";", "}", "/", "*", "Don", "'", "t", "need", "backing", "pages", "for", "NULLIO", "*", "/", "if", "(", "rd_dev", "-", ">", "rd_flags", "&", "RDF_NULLIO", ")", "return", "0", ";", "total_sg_needed", "=", "rd_dev", "-", ">", "rd_page_count", ";", "sg_tables", "=", "(", "total_sg_needed", "/", "max_sg_per_table", ")", "+", "1", ";", "sg_table", "=", "kzalloc", "(", "sg_tables", "*", "sizeof", "(", "struct", "rd_dev_sg_table", ")", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "sg_table", ")", "{", "pr_err", "(", "\"", "Unable", "to", "allocate", "memory", "for", "Ramdisk", "\"", "\"", "scatterlist", "tables", "\\", "n", "\"", ");", "return", "-", "ENOMEM", ";", "}", "rd_dev", "-", ">", "sg_table_array", "=", "sg_table", ";", "rd_dev", "-", ">", "sg_table_count", "=", "sg_tables", ";", "rc", "=", "rd_allocate_sgl_table", "(", "rd_dev", ",", "sg_table", ",", "total_sg_needed", ",", "0x00", ")", ";", "if", "(", "rc", ")", "return", "rc", ";", "pr_debug", "(", "\"", "CORE_RD", "[", "%", "u", "]", "-", "Built", "Ramdisk", "Device", "ID", ":", "%", "u", "space", "of", "\"", "\"", "%", "u", "pages", "in", "%", "u", "tables", "\\", "n", "\"", ",", "rd_dev", "-", ">", "rd_host", "-", ">", "rd_host_id", ",", "rd_dev", "-", ">", "rd_dev_id", ",", "rd_dev", "-", ">", "rd_page_count", ",", "rd_dev", "-", ">", "sg_table_count", ")", ";", "\"", "%", "u", "pages", "in", "%", "u", "tables", "\\", "n", "\"", ",", "rd_dev", "-", ">", "rd_host", "-", ">", "rd_host_id", ",", "rd_dev", "-", ">", "rd_dev_id", ",", "rd_dev", "-", ">", "rd_page_count", ",", "rd_dev", "-", ">", "sg_table_count", ")", ";", "return", "0", ";", "}"], "docstring_tokens": ["the", "failure", "to", "properly", "initialize", "a", "certain", "data", "structure"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "937", ",", "7", "+", "937", ",", "8", "@", "@", "static", "Image", "*", "ReadMATImage", "(", "const", "ImageInfo", "*", "image_info", ",", "ExceptionInfo", "*", "exception", ")", "if", "(", "strncmp", "(", "MATLAB_HDR", ".", "identific", ",", "\"", "MATLAB", "\"", ",", "6", ")", ")", "{", "MATLAB_KO", ":", "clone_info", "=", "DestroyImageInfo", "(", "clone_info", ")", ";", "if", "(", "clone_info", "!", "=", "(", "ImageInfo", "*", ")", "NULL", ")", "clone_info", "=", "DestroyImageInfo", "(", "clone_info", ")", ";", "ThrowReaderException", "(", "CorruptImageError", ",", "\"", "ImproperImageHeader", "\"", ");", "}"], "docstring_tokens": ["a", "missing", "NULL", "check"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1", ",", "5", "+", "1", ",", "5", "@", "@", "/", "*", "*", "Copyright", "2002", "-", "2016", "the", "original", "author", "or", "authors", ".", "*", "Copyright", "2002", "-", "2018", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "@", "@", "-", "43", ",", "6", "+", "43", ",", "9", "@", "@", "*", "/", "public", "abstract", "class", "HttpRange", "{", "/", "**", "Maximum", "ranges", "per", "request", ".", "*", "/", "private", "static", "final", "int", "MAX_RANGES", "=", "100", ";", "private", "static", "final", "String", "BYTE_RANGE_PREFIX", "=", "\"", "bytes", "=", "\";", "@", "@", "-", "58", ",", "16", "+", "61", ",", "23", "@", "@", "public", "ResourceRegion", "toResourceRegion", "(", "Resource", "resource", ")", "{", "/", "/", "Note", ":", "custom", "InputStreamResource", "subclasses", "could", "provide", "a", "pre", "-", "calculated", "content", "length", "!", "Assert", ".", "isTrue", "(", "resource", ".", "getClass", "(", ")", "!", "=", "InputStreamResource", ".", "class", ",", "\"", "Cannot", "convert", "an", "InputStreamResource", "to", "a", "ResourceRegion", "\"", ");", "long", "contentLength", "=", "getLengthFor", "(", "resource", ")", ";", "Assert", ".", "isTrue", "(", "contentLength", ">", "0", ",", "\"", "Resource", "content", "length", "should", "be", ">", "0", "\"", ");", "long", "start", "=", "getRangeStart", "(", "contentLength", ")", ";", "long", "end", "=", "getRangeEnd", "(", "contentLength", ")", ";", "return", "new", "ResourceRegion", "(", "resource", ",", "start", ",", "end", "-", "start", "+", "1", ")", ";", "}", "private", "static", "long", "getLengthFor", "(", "Resource", "resource", ")", "{", "long", "contentLength", ";", "try", "{", "long", "contentLength", "=", "resource", ".", "contentLength", "(", ");", "contentLength", "=", "resource", ".", "contentLength", "(", ");", "Assert", ".", "isTrue", "(", "contentLength", ">", "0", ",", "\"", "Resource", "content", "length", "should", "be", ">", "0", "\"", ");", "long", "start", "=", "getRangeStart", "(", "contentLength", ")", ";", "long", "end", "=", "getRangeEnd", "(", "contentLength", ")", ";", "return", "new", "ResourceRegion", "(", "resource", ",", "start", ",", "end", "-", "start", "+", "1", ")", ";", "}", "catch", "(", "IOException", "ex", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "Failed", "to", "convert", "Resource", "to", "ResourceRegion", "\"", ",", "ex", ")", ";", "throw", "new", "IllegalArgumentException", "(", "\"", "Failed", "to", "obtain", "Resource", "content", "length", "\"", ",", "ex", ")", ";", "}", "return", "contentLength", ";", "}", "/", "**", "@", "@", "-", "121", ",", "7", "+", "131", ",", "8", "@", "@", "public", "static", "HttpRange", "createSuffixRange", "(", "long", "suffixLength", ")", "{", "*", "<", "p", ">", "This", "method", "can", "be", "used", "to", "parse", "an", "{", "@", "code", "Range", "}", "header", ".", "*", "@", "param", "ranges", "the", "string", "to", "parse", "*", "@", "return", "the", "list", "of", "ranges", "*", "@", "throws", "IllegalArgumentException", "if", "the", "string", "cannot", "be", "parsed", "*", "@", "throws", "IllegalArgumentException", "if", "the", "string", "cannot", "be", "parsed", ",", "or", "if", "*", "the", "number", "of", "ranges", "is", "greater", "than", "100", ".", "*", "/", "public", "static", "List", "<", "HttpRange", ">", "parseRanges", "(", "String", "ranges", ")", "{", "if", "(", "!", "StringUtils", ".", "hasLength", "(", "ranges", ")", ")", "{", "@", "@", "-", "133", ",", "6", "+", "144", ",", "7", "@", "@", "public", "static", "HttpRange", "createSuffixRange", "(", "long", "suffixLength", ")", "{", "ranges", "=", "ranges", ".", "substring", "(", "BYTE_RANGE_PREFIX", ".", "length", "(", "))", ";", "String", "[", "]", "tokens", "=", "StringUtils", ".", "tokenizeToStringArray", "(", "ranges", ",", "\"", ",\"", ");", "Assert", ".", "isTrue", "(", "tokens", ".", "length", "<", "=", "MAX_RANGES", ",", "\"", "Too", "many", "ranges", "\"", "+", "tokens", ".", "length", ")", ";", "List", "<", "HttpRange", ">", "result", "=", "new", "ArrayList", "<", "HttpRange", ">", "(", "tokens", ".", "length", ")", ";", "for", "(", "String", "token", ":", "tokens", ")", "{", "result", ".", "add", "(", "parseRange", "(", "token", ")", ");", "@", "@", "-", "169", ",", "6", "+", "181", ",", "8", "@", "@", "else", "if", "(", "dashIdx", "=", "=", "0", ")", "{", "*", "@", "param", "resource", "the", "resource", "to", "select", "the", "regions", "from", "*", "@", "return", "the", "list", "of", "regions", "for", "the", "given", "resource", "*", "@", "since", "4", ".", "3", "*", "@", "throws", "IllegalArgumentException", "if", "the", "sum", "of", "all", "ranges", "exceeds", "the", "*", "resource", "length", ".", "*", "/", "public", "static", "List", "<", "ResourceRegion", ">", "toResourceRegions", "(", "List", "<", "HttpRange", ">", "ranges", ",", "Resource", "resource", ")", "{", "if", "(", "CollectionUtils", ".", "isEmpty", "(", "ranges", ")", ")", "{", "@", "@", "-", "178", ",", "6", "+", "192", ",", "15", "@", "@", "else", "if", "(", "dashIdx", "=", "=", "0", ")", "{", "for", "(", "HttpRange", "range", ":", "ranges", ")", "{", "regions", ".", "add", "(", "range", ".", "toResourceRegion", "(", "resource", ")", ");", "}", "if", "(", "ranges", ".", "size", "(", ")", ">", "1", ")", "{", "long", "length", "=", "getLengthFor", "(", "resource", ")", ";", "long", "total", "=", "0", ";", "for", "(", "ResourceRegion", "region", ":", "regions", ")", "{", "total", "+", "=", "region", ".", "getCount", "(", ");", "}", "Assert", ".", "isTrue", "(", "total", "<", "length", ",", "\"", "The", "sum", "of", "all", "ranges", "(", "\"", "+", "total", "+", "\"", ")", "\"", "\"", "should", "be", "less", "than", "the", "resource", "length", "(", "\"", "+", "length", "+", "\"", ")\"", ");", "}", "return", "regions", ";", "}", "@", "@", "-", "1", ",", "5", "+", "1", ",", "5", "@", "@", "/", "*", "*", "Copyright", "2002", "-", "2017", "the", "original", "author", "or", "authors", ".", "*", "Copyright", "2002", "-", "2018", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "@", "@", "-", "18", ",", "6", "+", "18", ",", "7", "@", "@", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "nio", ".", "charset", ".", "Charset", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "List", ";", "@", "@", "-", "101", ",", "6", "+", "102", ",", "31", "@", "@", "public", "void", "parseRanges", "(", ")", "{", "assertEquals", "(", "999", ",", "ranges", ".", "get", "(", "2", ")", ".", "getRangeEnd", "(", "1000", ")", ");", "}", "@", "Test", "public", "void", "parseRangesValidations", "(", ")", "{", "/", "/", "1", ".", "At", "limit", ".", ".", "StringBuilder", "sb", "=", "new", "StringBuilder", "(", "\"", "bytes", "=", "0", "-", "0", "\"", ");", "for", "(", "int", "i", "=", "0", ";", "i", "<", "99", ";", "i", "+", "+)", "{", "sb", ".", "append", "(", "\",", "\")", ".", "append", "(", "i", ")", ".", "append", "(", "\"-", "\")", ".", "append", "(", "i", "+", "1", ")", ";", "}", "List", "<", "HttpRange", ">", "ranges", "=", "HttpRange", ".", "parseRanges", "(", "sb", ".", "toString", "(", "))", ";", "assertEquals", "(", "100", ",", "ranges", ".", "size", "(", "))", ";", "/", "/", "2", ".", "Above", "limit", ".", ".", "sb", "=", "new", "StringBuilder", "(", "\"", "bytes", "=", "0", "-", "0", "\"", ");", "for", "(", "int", "i", "=", "0", ";", "i", "<", "100", ";", "i", "+", "+)", "{", "sb", ".", "append", "(", "\",", "\")", ".", "append", "(", "i", ")", ".", "append", "(", "\"-", "\")", ".", "append", "(", "i", "+", "1", ")", ";", "}", "try", "{", "HttpRange", ".", "parseRanges", "(", "sb", ".", "toString", "(", "))", ";", "fail", "(", ");", "}", "catch", "(", "IllegalArgumentException", "ex", ")", "{", "/", "/", "Expected", "}", "}", "@", "Test", "public", "void", "rangeToString", "(", ")", "{", "List", "<", "HttpRange", ">", "ranges", "=", "new", "ArrayList", "<", ">(", ");", "@", "@", "-", "145", ",", "4", "+", "171", ",", "25", "@", "@", "public", "void", "toResourceRegionExceptionLength", "(", ")", "throws", "IOException", "{", "range", ".", "toResourceRegion", "(", "resource", ")", ";", "}", "@", "Test", "public", "void", "toResourceRegionsValidations", "(", ")", "{", "byte", "[", "]", "bytes", "=", "\"", "12345", "\"", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ";", "ByteArrayResource", "resource", "=", "new", "ByteArrayResource", "(", "bytes", ")", ";", "/", "/", "1", ".", "Below", "full", "length", "List", "<", "HttpRange", ">", "ranges", "=", "HttpRange", ".", "parseRanges", "(", "\"", "bytes", "=", "0", "-", "1", ",", "2", "-", "3", "\"", ");", "List", "<", "ResourceRegion", ">", "regions", "=", "HttpRange", ".", "toResourceRegions", "(", "ranges", ",", "resource", ")", ";", "assertEquals", "(", "2", ",", "regions", ".", "size", "(", "))", ";", "/", "/", "2", ".", "At", "full", "length", "ranges", "=", "HttpRange", ".", "parseRanges", "(", "\"", "bytes", "=", "0", "-", "1", ",", "2", "-", "4", "\"", ");", "try", "{", "HttpRange", ".", "toResourceRegions", "(", "ranges", ",", "resource", ")", ";", "fail", "(", ");", "}", "catch", "(", "IllegalArgumentException", "ex", ")", "{", "/", "/", "Expected", ".", ".", "}", "}", "}"], "docstring_tokens": ["improper", "handling", "of", "range", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "598", ",", "6", "+", "598", ",", "10", "@", "@", "private", "void", "unzip", "(", "File", "dir", ",", "File", "zipFile", ")", "throws", "IOException", "{", "while", "(", "entries", ".", "hasMoreElements", "(", "))", "{", "ZipEntry", "e", "=", "entries", ".", "nextElement", "(", ");", "File", "f", "=", "new", "File", "(", "dir", ",", "e", ".", "getName", "(", "))", ";", "if", "(", "!", "f", ".", "toPath", "(", ").", "normalize", "(", ").", "startsWith", "(", "dir", ".", "toPath", "(", "))", ")", "{", "throw", "new", "IOException", "(", "\"", "Zip", "\"", "+", "zipFile", ".", "getPath", "(", ")", "+", "\"", "contains", "illegal", "file", "name", "that", "breaks", "out", "of", "the", "target", "directory", ":", "\"", "+", "e", ".", "getName", "(", "))", ";", "}", "if", "(", "e", ".", "isDirectory", "(", "))", "{", "mkdirs", "(", "f", ")", ";", "}", "else", "{"], "docstring_tokens": ["improper", "validation", "of", "user-supplied", "input"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "164", ",", "7", "+", "164", ",", "7", "@", "@", "static", "void", "spufs_prune_dir", "(", "struct", "dentry", "*", "dir", ")", "struct", "dentry", "*", "dentry", ",", "*", "tmp", ";", "mutex_lock", "(", "&", "dir", "-", ">", "d_inode", "-", ">", "i_mutex", ")", ";", "list_for_each_entry_safe", "(", "dentry", ",", "tmp", ",", "&", "dir", "-", ">", "d_subdirs", ",", "d_u", ".", "d_child", ")", "{", "list_for_each_entry_safe", "(", "dentry", ",", "tmp", ",", "&", "dir", "-", ">", "d_subdirs", ",", "d_child", ")", "{", "spin_lock", "(", "&", "dentry", "-", ">", "d_lock", ")", ";", "if", "(", "!(", "d_unhashed", "(", "dentry", ")", ")", "&", "&", "dentry", "-", ">", "d_inode", ")", "{", "dget_dlock", "(", "dentry", ")", ";", "@", "@", "-", "258", ",", "7", "+", "258", ",", "7", "@", "@", "void", "ll_invalidate_aliases", "(", "struct", "inode", "*", "inode", ")", "inode", "-", ">", "i_ino", ",", "inode", "-", ">", "i_generation", ",", "inode", ")", ";", "ll_lock_dcache", "(", "inode", ")", ";", "ll_d_hlist_for_each_entry", "(", "dentry", ",", "p", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_alias", ")", "{", "ll_d_hlist_for_each_entry", "(", "dentry", ",", "p", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_u", ".", "d_alias", ")", "{", "CDEBUG", "(", "D_DENTRY", ",", "\"", "dentry", "in", "drop", "%", ".*", "s", "(", "%", "p", ")", "parent", "%", "p", "\"", "\"", "inode", "%", "p", "flags", "%", "d", "\\", "n", "\"", ",", "dentry", "-", ">", "d_name", ".", "len", ",", "dentry", "-", ">", "d_name", ".", "name", ",", "dentry", ",", "dentry", "-", ">", "d_parent", ",", "@", "@", "-", "711", ",", "7", "+", "711", ",", "7", "@", "@", "void", "lustre_dump_dentry", "(", "struct", "dentry", "*", "dentry", ",", "int", "recur", ")", "return", ";", "list_for_each", "(", "tmp", ",", "&", "dentry", "-", ">", "d_subdirs", ")", "{", "struct", "dentry", "*", "d", "=", "list_entry", "(", "tmp", ",", "struct", "dentry", ",", "d_u", ".", "d_child", ")", ";", "struct", "dentry", "*", "d", "=", "list_entry", "(", "tmp", ",", "struct", "dentry", ",", "d_child", ")", ";", "lustre_dump_dentry", "(", "d", ",", "recur", "-", "1", ")", ";", "}", "}", "@", "@", "-", "167", ",", "14", "+", "167", ",", "14", "@", "@", "static", "void", "ll_invalidate_negative_children", "(", "struct", "inode", "*", "dir", ")", "struct", "ll_d_hlist_node", "*", "p", ";", "ll_lock_dcache", "(", "dir", ")", ";", "ll_d_hlist_for_each_entry", "(", "dentry", ",", "p", ",", "&", "dir", "-", ">", "i_dentry", ",", "d_alias", ")", "{", "ll_d_hlist_for_each_entry", "(", "dentry", ",", "p", ",", "&", "dir", "-", ">", "i_dentry", ",", "d_u", ".", "d_alias", ")", "{", "spin_lock", "(", "&", "dentry", "-", ">", "d_lock", ")", ";", "if", "(", "!", "list_empty", "(", "&", "dentry", "-", ">", "d_subdirs", ")", ")", "{", "struct", "dentry", "*", "child", ";", "list_for_each_entry_safe", "(", "child", ",", "tmp_subdir", ",", "&", "dentry", "-", ">", "d_subdirs", ",", "d_u", ".", "d_child", ")", "{", "d_child", ")", "{", "if", "(", "child", "-", ">", "d_inode", "=", "=", "NULL", ")", "d_lustre_invalidate", "(", "child", ",", "1", ")", ";", "}", "@", "@", "-", "362", ",", "7", "+", "362", ",", "7", "@", "@", "static", "struct", "dentry", "*", "ll_find_alias", "(", "struct", "inode", "*", "inode", ",", "struct", "dentry", "*", "dentry", ")", "discon_alias", "=", "invalid_alias", "=", "NULL", ";", "ll_lock_dcache", "(", "inode", ")", ";", "ll_d_hlist_for_each_entry", "(", "alias", ",", "p", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_alias", ")", "{", "ll_d_hlist_for_each_entry", "(", "alias", ",", "p", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_u", ".", "d_alias", ")", "{", "LASSERT", "(", "alias", "!", "=", "dentry", ")", ";", "spin_lock", "(", "&", "alias", "-", ">", "d_lock", ")", ";", "@", "@", "-", "953", ",", "7", "+", "953", ",", "7", "@", "@", "static", "void", "ll_get_child_fid", "(", "struct", "inode", "*", "dir", ",", "struct", "qstr", "*", "name", ",", "{", "struct", "dentry", "*", "parent", ",", "*", "child", ";", "parent", "=", "ll_d_hlist_entry", "(", "dir", "-", ">", "i_dentry", ",", "struct", "dentry", ",", "d_alias", ")", ";", "parent", "=", "ll_d_hlist_entry", "(", "dir", "-", ">", "i_dentry", ",", "struct", "dentry", ",", "d_u", ".", "d_alias", ")", ";", "child", "=", "d_lookup", "(", "parent", ",", "name", ")", ";", "if", "(", "child", ")", "{", "if", "(", "child", "-", ">", "d_inode", ")", "@", "@", "-", "125", ",", "7", "+", "125", ",", "7", "@", "@", "affs_fix_dcache", "(", "struct", "inode", "*", "inode", ",", "u32", "entry_ino", ")", "{", "struct", "dentry", "*", "dentry", ";", "spin_lock", "(", "&", "inode", "-", ">", "i_lock", ")", ";", "hlist_for_each_entry", "(", "dentry", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_alias", ")", "{", "hlist_for_each_entry", "(", "dentry", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_u", ".", "d_alias", ")", "{", "if", "(", "entry_ino", "=", "=", "(", "u32", ")", "(", "long", ")", "dentry", "-", ">", "d_fsdata", ")", "{", "dentry", "-", ">", "d_fsdata", "=", "(", "void", "*", ")", "inode", "-", ">", "i_ino", ";", "break", ";", "@", "@", "-", "85", ",", "7", "+", "85", ",", "7", "@", "@", "static", "struct", "dentry", "*", "get_next_positive_subdir", "(", "struct", "dentry", "*", "prev", ",", "spin_lock", "(", "&", "root", "-", ">", "d_lock", ")", ";", "if", "(", "prev", ")", "next", "=", "prev", "-", ">", "d_u", ".", "d_child", ".", "next", ";", "next", "=", "prev", "-", ">", "d_child", ".", "next", ";", "else", "{", "prev", "=", "dget_dlock", "(", "root", ")", ";", "next", "=", "prev", "-", ">", "d_subdirs", ".", "next", ";", "@", "@", "-", "99", ",", "13", "+", "99", ",", "13", "@", "@", "static", "struct", "dentry", "*", "get_next_positive_subdir", "(", "struct", "dentry", "*", "prev", ",", "return", "NULL", ";", "}", "q", "=", "list_entry", "(", "next", ",", "struct", "dentry", ",", "d_u", ".", "d_child", ")", ";", "q", "=", "list_entry", "(", "next", ",", "struct", "dentry", ",", "d_child", ")", ";", "spin_lock_nested", "(", "&", "q", "-", ">", "d_lock", ",", "DENTRY_D_LOCK_NESTED", ")", ";", "/", "*", "Already", "gone", "or", "negative", "dentry", "(", "under", "construction", ")", "-", "try", "next", "*", "/", "if", "(", "!", "d_count", "(", "q", ")", "|", "|", "!", "simple_positive", "(", "q", ")", ")", "{", "spin_unlock", "(", "&", "q", "-", ">", "d_lock", ")", ";", "next", "=", "q", "-", ">", "d_u", ".", "d_child", ".", "next", ";", "next", "=", "q", "-", ">", "d_child", ".", "next", ";", "goto", "cont", ";", "}", "dget_dlock", "(", "q", ")", ";", "@", "@", "-", "155", ",", "13", "+", "155", ",", "13", "@", "@", "static", "struct", "dentry", "*", "get_next_positive_dentry", "(", "struct", "dentry", "*", "prev", ",", "goto", "relock", ";", "}", "spin_unlock", "(", "&", "p", "-", ">", "d_lock", ")", ";", "next", "=", "p", "-", ">", "d_u", ".", "d_child", ".", "next", ";", "next", "=", "p", "-", ">", "d_child", ".", "next", ";", "p", "=", "parent", ";", "if", "(", "next", "!", "=", "&", "parent", "-", ">", "d_subdirs", ")", "break", ";", "}", "}", "ret", "=", "list_entry", "(", "next", ",", "struct", "dentry", ",", "d_u", ".", "d_child", ")", ";", "ret", "=", "list_entry", "(", "next", ",", "struct", "dentry", ",", "d_child", ")", ";", "spin_lock_nested", "(", "&", "ret", "-", ">", "d_lock", ",", "DENTRY_D_LOCK_NESTED", ")", ";", "/", "*", "Negative", "dentry", "-", "try", "next", "*", "/", "@", "@", "-", "489", ",", "7", "+", "489", ",", "7", "@", "@", "struct", "dentry", "*", "autofs4_expire_indirect", "(", "struct", "super_block", "*", "sb", ",", "spin_lock", "(", "&", "sbi", "-", ">", "lookup_lock", ")", ";", "spin_lock", "(", "&", "expired", "-", ">", "d_parent", "-", ">", "d_lock", ")", ";", "spin_lock_nested", "(", "&", "expired", "-", ">", "d_lock", ",", "DENTRY_D_LOCK_NESTED", ")", ";", "list_move", "(", "&", "expired", "-", ">", "d_parent", "-", ">", "d_subdirs", ",", "&", "expired", "-", ">", "d_u", ".", "d_child", ")", ";", "list_move", "(", "&", "expired", "-", ">", "d_parent", "-", ">", "d_subdirs", ",", "&", "expired", "-", ">", "d_child", ")", ";", "spin_unlock", "(", "&", "expired", "-", ">", "d_lock", ")", ";", "spin_unlock", "(", "&", "expired", "-", ">", "d_parent", "-", ">", "d_lock", ")", ";", "spin_unlock", "(", "&", "sbi", "-", ">", "lookup_lock", ")", ";", "@", "@", "-", "687", ",", "7", "+", "687", ",", "7", "@", "@", "static", "void", "autofs_clear_leaf_automount_flags", "(", "struct", "dentry", "*", "dentry", ")", "/", "*", "only", "consider", "parents", "below", "dentrys", "in", "the", "root", "*", "/", "if", "(", "IS_ROOT", "(", "parent", "-", ">", "d_parent", ")", ")", "return", ";", "d_child", "=", "&", "dentry", "-", ">", "d_u", ".", "d_child", ";", "d_child", "=", "&", "dentry", "-", ">", "d_child", ";", "/", "*", "Set", "parent", "managed", "if", "it", "'", "s", "becoming", "empty", "*", "/", "if", "(", "d_child", "-", ">", "next", "=", "=", "&", "parent", "-", ">", "d_subdirs", "&", "&", "d_child", "-", ">", "prev", "=", "=", "&", "parent", "-", ">", "d_subdirs", ")", "@", "@", "-", "111", ",", "7", "+", "111", ",", "7", "@", "@", "static", "int", "fpos_cmp", "(", "loff_t", "l", ",", "loff_t", "r", ")", "/", "*", "*", "When", "possible", ",", "we", "try", "to", "satisfy", "a", "readdir", "by", "peeking", "at", "the", "*", "dcache", ".", "We", "make", "this", "work", "by", "carefully", "ordering", "dentries", "on", "*", "d_u", ".", "d_child", "when", "we", "initially", "get", "results", "back", "from", "the", "MDS", ",", "and", "*", "d_child", "when", "we", "initially", "get", "results", "back", "from", "the", "MDS", ",", "and", "*", "falling", "back", "to", "a", "\"", "normal", "\"", "sync", "readdir", "if", "any", "dentries", "in", "the", "dir", "*", "are", "dropped", ".", "*", "@", "@", "-", "147", ",", "11", "+", "147", ",", "11", "@", "@", "static", "int", "__dcache_readdir", "(", "struct", "file", "*", "file", ",", "struct", "dir_context", "*", "ctx", ",", "p", "=", "parent", "-", ">", "d_subdirs", ".", "prev", ";", "dout", "(", "\"", "initial", "p", "%", "p", "/", "%", "p", "\\", "n", "\"", ",", "p", "-", ">", "prev", ",", "p", "-", ">", "next", ")", ";", "}", "else", "{", "p", "=", "last", "-", ">", "d_u", ".", "d_child", ".", "prev", ";", "p", "=", "last", "-", ">", "d_child", ".", "prev", ";", "}", "more", ":", "dentry", "=", "list_entry", "(", "p", ",", "struct", "dentry", ",", "d_u", ".", "d_child", ")", ";", "dentry", "=", "list_entry", "(", "p", ",", "struct", "dentry", ",", "d_child", ")", ";", "di", "=", "ceph_dentry", "(", "dentry", ")", ";", "while", "(", "1", ")", "{", "dout", "(", "\"", "p", "%", "p", "/", "%", "p", "%", "s", "d_subdirs", "%", "p", "/", "%", "p", "\\", "n", "\"", ",", "p", "-", ">", "prev", ",", "p", "-", ">", "next", ",", "@", "@", "-", "174", ",", "7", "+", "174", ",", "7", "@", "@", "static", "int", "__dcache_readdir", "(", "struct", "file", "*", "file", ",", "struct", "dir_context", "*", "ctx", ",", "!", "dentry", "-", ">", "d_inode", "?", "\"", "null", "\"", ":", "\"", "\")", ";", "spin_unlock", "(", "&", "dentry", "-", ">", "d_lock", ")", ";", "p", "=", "p", "-", ">", "prev", ";", "dentry", "=", "list_entry", "(", "p", ",", "struct", "dentry", ",", "d_u", ".", "d_child", ")", ";", "dentry", "=", "list_entry", "(", "p", ",", "struct", "dentry", ",", "d_child", ")", ";", "di", "=", "ceph_dentry", "(", "dentry", ")", ";", "}", "@", "@", "-", "1399", ",", "7", "+", "1399", ",", "7", "@", "@", "int", "ceph_readdir_prepopulate", "(", "struct", "ceph_mds_request", "*", "req", ",", "/", "*", "reorder", "parent", "'", "s", "d_subdirs", "*", "/", "spin_lock", "(", "&", "parent", "-", ">", "d_lock", ")", ";", "spin_lock_nested", "(", "&", "dn", "-", ">", "d_lock", ",", "DENTRY_D_LOCK_NESTED", ")", ";", "list_move", "(", "&", "dn", "-", ">", "d_u", ".", "d_child", ",", "&", "parent", "-", ">", "d_subdirs", ")", ";", "list_move", "(", "&", "dn", "-", ">", "d_child", ",", "&", "parent", "-", ">", "d_subdirs", ")", ";", "spin_unlock", "(", "&", "dn", "-", ">", "d_lock", ")", ";", "spin_unlock", "(", "&", "parent", "-", ">", "d_lock", ")", ";", "}", "@", "@", "-", "895", ",", "7", "+", "895", ",", "7", "@", "@", "inode_has_hashed_dentries", "(", "struct", "inode", "*", "inode", ")", "struct", "dentry", "*", "dentry", ";", "spin_lock", "(", "&", "inode", "-", ">", "i_lock", ")", ";", "hlist_for_each_entry", "(", "dentry", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_alias", ")", "{", "hlist_for_each_entry", "(", "dentry", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_u", ".", "d_alias", ")", "{", "if", "(", "!", "d_unhashed", "(", "dentry", ")", "|", "|", "IS_ROOT", "(", "dentry", ")", ")", "{", "spin_unlock", "(", "&", "inode", "-", ">", "i_lock", ")", ";", "return", "true", ";", "@", "@", "-", "92", ",", "7", "+", "92", ",", "7", "@", "@", "static", "void", "coda_flag_children", "(", "struct", "dentry", "*", "parent", ",", "int", "flag", ")", "struct", "dentry", "*", "de", ";", "spin_lock", "(", "&", "parent", "-", ">", "d_lock", ")", ";", "list_for_each_entry", "(", "de", ",", "&", "parent", "-", ">", "d_subdirs", ",", "d_u", ".", "d_child", ")", "{", "list_for_each_entry", "(", "de", ",", "&", "parent", "-", ">", "d_subdirs", ",", "d_child", ")", "{", "/", "*", "don", "'", "t", "know", "what", "to", "do", "with", "negative", "dentries", "*", "/", "if", "(", "de", "-", ">", "d_inode", ")", "coda_flag_inode", "(", "de", "-", ">", "d_inode", ",", "flag", ")", ";", "@", "@", "-", "44", ",", "7", "+", "44", ",", "7", "@", "@", "/", "*", "*", "Usage", ":", "*", "dcache", "-", ">", "d_inode", "-", ">", "i_lock", "protects", ":", "*", "-", "i_dentry", ",", "d_alias", ",", "d_inode", "of", "aliases", "*", "-", "i_dentry", ",", "d_u", ".", "d_alias", ",", "d_inode", "of", "aliases", "*", "dcache_hash_bucket", "lock", "protects", ":", "*", "-", "the", "dcache", "hash", "table", "*", "s_anon", "bl", "list", "spinlock", "protects", ":", "@", "@", "-", "59", ",", "7", "+", "59", ",", "7", "@", "@", "*", "-", "d_unhashed", "(", ")", "*", "-", "d_parent", "and", "d_subdirs", "*", "-", "childrens", "'", "d_child", "and", "d_parent", "*", "-", "d_alias", ",", "d_inode", "*", "-", "d_u", ".", "d_alias", ",", "d_inode", "*", "*", "Ordering", ":", "*", "dentry", "-", ">", "d_inode", "-", ">", "i_lock", "@", "@", "-", "252", ",", "14", "+", "252", ",", "12", "@", "@", "static", "void", "__d_free", "(", "struct", "rcu_head", "*", "head", ")", "{", "struct", "dentry", "*", "dentry", "=", "container_of", "(", "head", ",", "struct", "dentry", ",", "d_u", ".", "d_rcu", ")", ";", "WARN_ON", "(", "!", "hlist_unhashed", "(", "&", "dentry", "-", ">", "d_alias", ")", ");", "kmem_cache_free", "(", "dentry_cache", ",", "dentry", ")", ";", "}", "static", "void", "__d_free_external", "(", "struct", "rcu_head", "*", "head", ")", "{", "struct", "dentry", "*", "dentry", "=", "container_of", "(", "head", ",", "struct", "dentry", ",", "d_u", ".", "d_rcu", ")", ";", "WARN_ON", "(", "!", "hlist_unhashed", "(", "&", "dentry", "-", ">", "d_alias", ")", ");", "kfree", "(", "external_name", "(", "dentry", ")", ");", "kmem_cache_free", "(", "dentry_cache", ",", "dentry", ")", ";", "}", "@", "@", "-", "271", ",", "6", "+", "269", ",", "7", "@", "@", "static", "inline", "int", "dname_external", "(", "const", "struct", "dentry", "*", "dentry", ")", "static", "void", "dentry_free", "(", "struct", "dentry", "*", "dentry", ")", "{", "WARN_ON", "(", "!", "hlist_unhashed", "(", "&", "dentry", "-", ">", "d_u", ".", "d_alias", ")", ");", "if", "(", "unlikely", "(", "dname_external", "(", "dentry", ")", "))", "{", "struct", "external_name", "*", "p", "=", "external_name", "(", "dentry", ")", ";", "if", "(", "likely", "(", "atomic_dec_and_test", "(", "&", "p", "-", ">", "u", ".", "count", ")", "))", "{", "@", "@", "-", "311", ",", "7", "+", "310", ",", "7", "@", "@", "static", "void", "dentry_iput", "(", "struct", "dentry", "*", "dentry", ")", "struct", "inode", "*", "inode", "=", "dentry", "-", ">", "d_inode", ";", "if", "(", "inode", ")", "{", "dentry", "-", ">", "d_inode", "=", "NULL", ";", "hlist_del_init", "(", "&", "dentry", "-", ">", "d_alias", ")", ";", "hlist_del_init", "(", "&", "dentry", "-", ">", "d_u", ".", "d_alias", ")", ";", "spin_unlock", "(", "&", "dentry", "-", ">", "d_lock", ")", ";", "spin_unlock", "(", "&", "inode", "-", ">", "i_lock", ")", ";", "if", "(", "!", "inode", "-", ">", "i_nlink", ")", "@", "@", "-", "336", ",", "7", "+", "335", ",", "7", "@", "@", "static", "void", "dentry_unlink_inode", "(", "struct", "dentry", "*", "dentry", ")", "struct", "inode", "*", "inode", "=", "dentry", "-", ">", "d_inode", ";", "__d_clear_type", "(", "dentry", ")", ";", "dentry", "-", ">", "d_inode", "=", "NULL", ";", "hlist_del_init", "(", "&", "dentry", "-", ">", "d_alias", ")", ";", "hlist_del_init", "(", "&", "dentry", "-", ">", "d_u", ".", "d_alias", ")", ";", "dentry_rcuwalk_barrier", "(", "dentry", ")", ";", "spin_unlock", "(", "&", "dentry", "-", ">", "d_lock", ")", ";", "spin_unlock", "(", "&", "inode", "-", ">", "i_lock", ")", ";", "@", "@", "-", "496", ",", "7", "+", "495", ",", "7", "@", "@", "static", "void", "__dentry_kill", "(", "struct", "dentry", "*", "dentry", ")", "}", "/", "*", "if", "it", "was", "on", "the", "hash", "then", "remove", "it", "*", "/", "__d_drop", "(", "dentry", ")", ";", "list_del", "(", "&", "dentry", "-", ">", "d_u", ".", "d_child", ")", ";", "list_del", "(", "&", "dentry", "-", ">", "d_child", ")", ";", "/", "*", "*", "Inform", "d_walk", "(", ")", "that", "we", "are", "no", "longer", "attached", "to", "the", "*", "dentry", "tree", "@", "@", "-", "722", ",", "7", "+", "721", ",", "7", "@", "@", "static", "struct", "dentry", "*", "__d_find_alias", "(", "struct", "inode", "*", "inode", ")", "again", ":", "discon_alias", "=", "NULL", ";", "hlist_for_each_entry", "(", "alias", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_alias", ")", "{", "hlist_for_each_entry", "(", "alias", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_u", ".", "d_alias", ")", "{", "spin_lock", "(", "&", "alias", "-", ">", "d_lock", ")", ";", "if", "(", "S_ISDIR", "(", "inode", "-", ">", "i_mode", ")", "|", "|", "!", "d_unhashed", "(", "alias", ")", ")", "{", "if", "(", "IS_ROOT", "(", "alias", ")", "&", "&", "@", "@", "-", "772", ",", "7", "+", "771", ",", "7", "@", "@", "void", "d_prune_aliases", "(", "struct", "inode", "*", "inode", ")", "struct", "dentry", "*", "dentry", ";", "restart", ":", "spin_lock", "(", "&", "inode", "-", ">", "i_lock", ")", ";", "hlist_for_each_entry", "(", "dentry", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_alias", ")", "{", "hlist_for_each_entry", "(", "dentry", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_u", ".", "d_alias", ")", "{", "spin_lock", "(", "&", "dentry", "-", ">", "d_lock", ")", ";", "if", "(", "!", "dentry", "-", ">", "d_lockref", ".", "count", ")", "{", "struct", "dentry", "*", "parent", "=", "lock_parent", "(", "dentry", ")", ";", "@", "@", "-", "1050", ",", "7", "+", "1049", ",", "7", "@", "@", "static", "void", "d_walk", "(", "struct", "dentry", "*", "parent", ",", "void", "*", "data", ",", "resume", ":", "while", "(", "next", "!", "=", "&", "this_parent", "-", ">", "d_subdirs", ")", "{", "struct", "list_head", "*", "tmp", "=", "next", ";", "struct", "dentry", "*", "dentry", "=", "list_entry", "(", "tmp", ",", "struct", "dentry", ",", "d_u", ".", "d_child", ")", ";", "struct", "dentry", "*", "dentry", "=", "list_entry", "(", "tmp", ",", "struct", "dentry", ",", "d_child", ")", ";", "next", "=", "tmp", "-", ">", "next", ";", "spin_lock_nested", "(", "&", "dentry", "-", ">", "d_lock", ",", "DENTRY_D_LOCK_NESTED", ")", ";", "@", "@", "-", "1102", ",", "7", "+", "1101", ",", "7", "@", "@", "static", "void", "d_walk", "(", "struct", "dentry", "*", "parent", ",", "void", "*", "data", ",", "goto", "rename_retry", ";", "}", "rcu_read_unlock", "(", ");", "next", "=", "child", "-", ">", "d_u", ".", "d_child", ".", "next", ";", "next", "=", "child", "-", ">", "d_child", ".", "next", ";", "goto", "resume", ";", "}", "if", "(", "need_seqretry", "(", "&", "rename_lock", ",", "seq", ")", ")", "{", "@", "@", "-", "1454", ",", "8", "+", "1453", ",", "8", "@", "@", "struct", "dentry", "*", "__d_alloc", "(", "struct", "super_block", "*", "sb", ",", "const", "struct", "qstr", "*", "name", ")", "INIT_HLIST_BL_NODE", "(", "&", "dentry", "-", ">", "d_hash", ")", ";", "INIT_LIST_HEAD", "(", "&", "dentry", "-", ">", "d_lru", ")", ";", "INIT_LIST_HEAD", "(", "&", "dentry", "-", ">", "d_subdirs", ")", ";", "INIT_HLIST_NODE", "(", "&", "dentry", "-", ">", "d_alias", ")", ";", "INIT_LIST_HEAD", "(", "&", "dentry", "-", ">", "d_u", ".", "d_child", ")", ";", "INIT_HLIST_NODE", "(", "&", "dentry", "-", ">", "d_u", ".", "d_alias", ")", ";", "INIT_LIST_HEAD", "(", "&", "dentry", "-", ">", "d_child", ")", ";", "d_set_d_op", "(", "dentry", ",", "dentry", "-", ">", "d_sb", "-", ">", "s_d_op", ")", ";", "this_cpu_inc", "(", "nr_dentry", ")", ";", "@", "@", "-", "1485", ",", "7", "+", "1484", ",", "7", "@", "@", "struct", "dentry", "*", "d_alloc", "(", "struct", "dentry", "*", "parent", ",", "const", "struct", "qstr", "*", "name", ")", "*", "/", "__dget_dlock", "(", "parent", ")", ";", "dentry", "-", ">", "d_parent", "=", "parent", ";", "list_add", "(", "&", "dentry", "-", ">", "d_u", ".", "d_child", ",", "&", "parent", "-", ">", "d_subdirs", ")", ";", "list_add", "(", "&", "dentry", "-", ">", "d_child", ",", "&", "parent", "-", ">", "d_subdirs", ")", ";", "spin_unlock", "(", "&", "parent", "-", ">", "d_lock", ")", ";", "return", "dentry", ";", "@", "@", "-", "1578", ",", "7", "+", "1577", ",", "7", "@", "@", "static", "void", "__d_instantiate", "(", "struct", "dentry", "*", "dentry", ",", "struct", "inode", "*", "inode", ")", "spin_lock", "(", "&", "dentry", "-", ">", "d_lock", ")", ";", "__d_set_type", "(", "dentry", ",", "add_flags", ")", ";", "if", "(", "inode", ")", "hlist_add_head", "(", "&", "dentry", "-", ">", "d_alias", ",", "&", "inode", "-", ">", "i_dentry", ")", ";", "hlist_add_head", "(", "&", "dentry", "-", ">", "d_u", ".", "d_alias", ",", "&", "inode", "-", ">", "i_dentry", ")", ";", "dentry", "-", ">", "d_inode", "=", "inode", ";", "dentry_rcuwalk_barrier", "(", "dentry", ")", ";", "spin_unlock", "(", "&", "dentry", "-", ">", "d_lock", ")", ";", "@", "@", "-", "1602", ",", "7", "+", "1601", ",", "7", "@", "@", "static", "void", "__d_instantiate", "(", "struct", "dentry", "*", "dentry", ",", "struct", "inode", "*", "inode", ")", "void", "d_instantiate", "(", "struct", "dentry", "*", "entry", ",", "struct", "inode", "*", "inode", ")", "{", "BUG_ON", "(", "!", "hlist_unhashed", "(", "&", "entry", "-", ">", "d_alias", ")", ");", "BUG_ON", "(", "!", "hlist_unhashed", "(", "&", "entry", "-", ">", "d_u", ".", "d_alias", ")", ");", "if", "(", "inode", ")", "spin_lock", "(", "&", "inode", "-", ">", "i_lock", ")", ";", "__d_instantiate", "(", "entry", ",", "inode", ")", ";", "@", "@", "-", "1641", ",", "7", "+", "1640", ",", "7", "@", "@", "static", "struct", "dentry", "*", "__d_instantiate_unique", "(", "struct", "dentry", "*", "entry", ",", "return", "NULL", ";", "}", "hlist_for_each_entry", "(", "alias", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_alias", ")", "{", "hlist_for_each_entry", "(", "alias", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_u", ".", "d_alias", ")", "{", "/", "*", "*", "Don", "'", "t", "need", "alias", "-", ">", "d_lock", "here", ",", "because", "aliases", "with", "*", "d_parent", "=", "=", "entry", "-", ">", "d_parent", "are", "not", "subject", "to", "name", "or", "@", "@", "-", "1667", ",", "7", "+", "1666", ",", "7", "@", "@", "struct", "dentry", "*", "d_instantiate_unique", "(", "struct", "dentry", "*", "entry", ",", "struct", "inode", "*", "inode", ")", "{", "struct", "dentry", "*", "result", ";", "BUG_ON", "(", "!", "hlist_unhashed", "(", "&", "entry", "-", ">", "d_alias", ")", ");", "BUG_ON", "(", "!", "hlist_unhashed", "(", "&", "entry", "-", ">", "d_u", ".", "d_alias", ")", ");", "if", "(", "inode", ")", "spin_lock", "(", "&", "inode", "-", ">", "i_lock", ")", ";", "@", "@", "-", "1698", ",", "7", "+", "1697", ",", "7", "@", "@", "EXPORT_SYMBOL", "(", "d_instantiate_unique", ")", ";", "*", "/", "int", "d_instantiate_no_diralias", "(", "struct", "dentry", "*", "entry", ",", "struct", "inode", "*", "inode", ")", "{", "BUG_ON", "(", "!", "hlist_unhashed", "(", "&", "entry", "-", ">", "d_alias", ")", ");", "BUG_ON", "(", "!", "hlist_unhashed", "(", "&", "entry", "-", ">", "d_u", ".", "d_alias", ")", ");", "spin_lock", "(", "&", "inode", "-", ">", "i_lock", ")", ";", "if", "(", "S_ISDIR", "(", "inode", "-", ">", "i_mode", ")", "&", "&", "!", "hlist_empty", "(", "&", "inode", "-", ">", "i_dentry", ")", ")", "{", "@", "@", "-", "1737", ",", "7", "+", "1736", ",", "7", "@", "@", "static", "struct", "dentry", "*", "__d_find_any_alias", "(", "struct", "inode", "*", "inode", ")", "if", "(", "hlist_empty", "(", "&", "inode", "-", ">", "i_dentry", ")", ")", "return", "NULL", ";", "alias", "=", "hlist_entry", "(", "inode", "-", ">", "i_dentry", ".", "first", ",", "struct", "dentry", ",", "d_alias", ")", ";", "alias", "=", "hlist_entry", "(", "inode", "-", ">", "i_dentry", ".", "first", ",", "struct", "dentry", ",", "d_u", ".", "d_alias", ")", ";", "__dget", "(", "alias", ")", ";", "return", "alias", ";", "}", "@", "@", "-", "1799", ",", "7", "+", "1798", ",", "7", "@", "@", "static", "struct", "dentry", "*", "__d_obtain_alias", "(", "struct", "inode", "*", "inode", ",", "int", "disconnected", ")", "spin_lock", "(", "&", "tmp", "-", ">", "d_lock", ")", ";", "tmp", "-", ">", "d_inode", "=", "inode", ";", "tmp", "-", ">", "d_flags", "|", "=", "add_flags", ";", "hlist_add_head", "(", "&", "tmp", "-", ">", "d_alias", ",", "&", "inode", "-", ">", "i_dentry", ")", ";", "hlist_add_head", "(", "&", "tmp", "-", ">", "d_u", ".", "d_alias", ",", "&", "inode", "-", ">", "i_dentry", ")", ";", "hlist_bl_lock", "(", "&", "tmp", "-", ">", "d_sb", "-", ">", "s_anon", ")", ";", "hlist_bl_add_head", "(", "&", "tmp", "-", ">", "d_hash", ",", "&", "tmp", "-", ">", "d_sb", "-", ">", "s_anon", ")", ";", "hlist_bl_unlock", "(", "&", "tmp", "-", ">", "d_sb", "-", ">", "s_anon", ")", ";", "@", "@", "-", "2234", ",", "7", "+", "2233", ",", "7", "@", "@", "int", "d_validate", "(", "struct", "dentry", "*", "dentry", ",", "struct", "dentry", "*", "dparent", ")", "struct", "dentry", "*", "child", ";", "spin_lock", "(", "&", "dparent", "-", ">", "d_lock", ")", ";", "list_for_each_entry", "(", "child", ",", "&", "dparent", "-", ">", "d_subdirs", ",", "d_u", ".", "d_child", ")", "{", "list_for_each_entry", "(", "child", ",", "&", "dparent", "-", ">", "d_subdirs", ",", "d_child", ")", "{", "if", "(", "dentry", "=", "=", "child", ")", "{", "spin_lock_nested", "(", "&", "dentry", "-", ">", "d_lock", ",", "DENTRY_D_LOCK_NESTED", ")", ";", "__dget_dlock", "(", "dentry", ")", ";", "@", "@", "-", "2525", ",", "13", "+", "2524", ",", "13", "@", "@", "static", "void", "__d_move", "(", "struct", "dentry", "*", "dentry", ",", "struct", "dentry", "*", "target", ",", "/", "*", "splicing", "a", "tree", "*", "/", "dentry", "-", ">", "d_parent", "=", "target", "-", ">", "d_parent", ";", "target", "-", ">", "d_parent", "=", "target", ";", "list_del_init", "(", "&", "target", "-", ">", "d_u", ".", "d_child", ")", ";", "list_move", "(", "&", "dentry", "-", ">", "d_u", ".", "d_child", ",", "&", "dentry", "-", ">", "d_parent", "-", ">", "d_subdirs", ")", ";", "list_del_init", "(", "&", "target", "-", ">", "d_child", ")", ";", "list_move", "(", "&", "dentry", "-", ">", "d_child", ",", "&", "dentry", "-", ">", "d_parent", "-", ">", "d_subdirs", ")", ";", "}", "else", "{", "/", "*", "swapping", "two", "dentries", "*", "/", "swap", "(", "dentry", "-", ">", "d_parent", ",", "target", "-", ">", "d_parent", ")", ";", "list_move", "(", "&", "target", "-", ">", "d_u", ".", "d_child", ",", "&", "target", "-", ">", "d_parent", "-", ">", "d_subdirs", ")", ";", "list_move", "(", "&", "dentry", "-", ">", "d_u", ".", "d_child", ",", "&", "dentry", "-", ">", "d_parent", "-", ">", "d_subdirs", ")", ";", "list_move", "(", "&", "target", "-", ">", "d_child", ",", "&", "target", "-", ">", "d_parent", "-", ">", "d_subdirs", ")", ";", "list_move", "(", "&", "dentry", "-", ">", "d_child", ",", "&", "dentry", "-", ">", "d_parent", "-", ">", "d_subdirs", ")", ";", "if", "(", "exchange", ")", "fsnotify_d_move", "(", "target", ")", ";", "fsnotify_d_move", "(", "dentry", ")", ";", "@", "@", "-", "3320", ",", "7", "+", "3319", ",", "7", "@", "@", "void", "d_tmpfile", "(", "struct", "dentry", "*", "dentry", ",", "struct", "inode", "*", "inode", ")", "{", "inode_dec_link_count", "(", "inode", ")", ";", "BUG_ON", "(", "dentry", "-", ">", "d_name", ".", "name", "!", "=", "dentry", "-", ">", "d_iname", "|", "|", "!", "hlist_unhashed", "(", "&", "dentry", "-", ">", "d_alias", ")", "|", "|", "!", "hlist_unhashed", "(", "&", "dentry", "-", ">", "d_u", ".", "d_alias", ")", "|", "|", "!", "d_unlinked", "(", "dentry", ")", ");", "spin_lock", "(", "&", "dentry", "-", ">", "d_parent", "-", ">", "d_lock", ")", ";", "spin_lock_nested", "(", "&", "dentry", "-", ">", "d_lock", ",", "DENTRY_D_LOCK_NESTED", ")", ";", "@", "@", "-", "553", ",", "7", "+", "553", ",", "7", "@", "@", "void", "debugfs_remove_recursive", "(", "struct", "dentry", "*", "dentry", ")", "*", "use", "the", "d_u", ".", "d_child", "as", "the", "rcu", "head", "and", "corrupt", "this", "list", ".", "*", "/", "spin_lock", "(", "&", "parent", "-", ">", "d_lock", ")", ";", "list_for_each_entry", "(", "child", ",", "&", "parent", "-", ">", "d_subdirs", ",", "d_u", ".", "d_child", ")", "{", "list_for_each_entry", "(", "child", ",", "&", "parent", "-", ">", "d_subdirs", ",", "d_child", ")", "{", "if", "(", "!", "debugfs_positive", "(", "child", ")", ")", "continue", ";", "@", "@", "-", "50", ",", "7", "+", "50", ",", "7", "@", "@", "find_acceptable_alias", "(", "struct", "dentry", "*", "result", ",", "inode", "=", "result", "-", ">", "d_inode", ";", "spin_lock", "(", "&", "inode", "-", ">", "i_lock", ")", ";", "hlist_for_each_entry", "(", "dentry", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_alias", ")", "{", "hlist_for_each_entry", "(", "dentry", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_u", ".", "d_alias", ")", "{", "dget", "(", "dentry", ")", ";", "spin_unlock", "(", "&", "inode", "-", ">", "i_lock", ")", ";", "if", "(", "toput", ")", "@", "@", "-", "114", ",", "18", "+", "114", ",", "18", "@", "@", "loff_t", "dcache_dir_lseek", "(", "struct", "file", "*", "file", ",", "loff_t", "offset", ",", "int", "whence", ")", "spin_lock", "(", "&", "dentry", "-", ">", "d_lock", ")", ";", "/", "*", "d_lock", "not", "required", "for", "cursor", "*", "/", "list_del", "(", "&", "cursor", "-", ">", "d_u", ".", "d_child", ")", ";", "list_del", "(", "&", "cursor", "-", ">", "d_child", ")", ";", "p", "=", "dentry", "-", ">", "d_subdirs", ".", "next", ";", "while", "(", "n", "&", "&", "p", "!", "=", "&", "dentry", "-", ">", "d_subdirs", ")", "{", "struct", "dentry", "*", "next", ";", "next", "=", "list_entry", "(", "p", ",", "struct", "dentry", ",", "d_u", ".", "d_child", ")", ";", "next", "=", "list_entry", "(", "p", ",", "struct", "dentry", ",", "d_child", ")", ";", "spin_lock_nested", "(", "&", "next", "-", ">", "d_lock", ",", "DENTRY_D_LOCK_NESTED", ")", ";", "if", "(", "simple_positive", "(", "next", ")", ")", "n", "-", "-;", "spin_unlock", "(", "&", "next", "-", ">", "d_lock", ")", ";", "p", "=", "p", "-", ">", "next", ";", "}", "list_add_tail", "(", "&", "cursor", "-", ">", "d_u", ".", "d_child", ",", "p", ")", ";", "list_add_tail", "(", "&", "cursor", "-", ">", "d_child", ",", "p", ")", ";", "spin_unlock", "(", "&", "dentry", "-", ">", "d_lock", ")", ";", "}", "}", "@", "@", "-", "150", ",", "7", "+", "150", ",", "7", "@", "@", "int", "dcache_readdir", "(", "struct", "file", "*", "file", ",", "struct", "dir_context", "*", "ctx", ")", "{", "struct", "dentry", "*", "dentry", "=", "file", "-", ">", "f_path", ".", "dentry", ";", "struct", "dentry", "*", "cursor", "=", "file", "-", ">", "private_data", ";", "struct", "list_head", "*", "p", ",", "*", "q", "=", "&", "cursor", "-", ">", "d_u", ".", "d_child", ";", "struct", "list_head", "*", "p", ",", "*", "q", "=", "&", "cursor", "-", ">", "d_child", ";", "if", "(", "!", "dir_emit_dots", "(", "file", ",", "ctx", ")", ")", "return", "0", ";", "@", "@", "-", "159", ",", "7", "+", "159", ",", "7", "@", "@", "int", "dcache_readdir", "(", "struct", "file", "*", "file", ",", "struct", "dir_context", "*", "ctx", ")", "list_move", "(", "q", ",", "&", "dentry", "-", ">", "d_subdirs", ")", ";", "for", "(", "p", "=", "q", "-", ">", "next", ";", "p", "!", "=", "&", "dentry", "-", ">", "d_subdirs", ";", "p", "=", "p", "-", ">", "next", ")", "{", "struct", "dentry", "*", "next", "=", "list_entry", "(", "p", ",", "struct", "dentry", ",", "d_u", ".", "d_child", ")", ";", "struct", "dentry", "*", "next", "=", "list_entry", "(", "p", ",", "struct", "dentry", ",", "d_child", ")", ";", "spin_lock_nested", "(", "&", "next", "-", ">", "d_lock", ",", "DENTRY_D_LOCK_NESTED", ")", ";", "if", "(", "!", "simple_positive", "(", "next", ")", ")", "{", "spin_unlock", "(", "&", "next", "-", ">", "d_lock", ")", ";", "@", "@", "-", "287", ",", "7", "+", "287", ",", "7", "@", "@", "int", "simple_empty", "(", "struct", "dentry", "*", "dentry", ")", "int", "ret", "=", "0", ";", "spin_lock", "(", "&", "dentry", "-", ">", "d_lock", ")", ";", "list_for_each_entry", "(", "child", ",", "&", "dentry", "-", ">", "d_subdirs", ",", "d_u", ".", "d_child", ")", "{", "list_for_each_entry", "(", "child", ",", "&", "dentry", "-", ">", "d_subdirs", ",", "d_child", ")", "{", "spin_lock_nested", "(", "&", "child", "-", ">", "d_lock", ",", "DENTRY_D_LOCK_NESTED", ")", ";", "if", "(", "simple_positive", "(", "child", ")", ")", "{", "spin_unlock", "(", "&", "child", "-", ">", "d_lock", ")", ";", "@", "@", "-", "403", ",", "7", "+", "403", ",", "7", "@", "@", "ncp_dget_fpos", "(", "struct", "dentry", "*", "dentry", ",", "struct", "dentry", "*", "parent", ",", "unsigned", "long", "fpos", ")", "/", "*", "If", "a", "pointer", "is", "invalid", ",", "we", "search", "the", "dentry", ".", "*", "/", "spin_lock", "(", "&", "parent", "-", ">", "d_lock", ")", ";", "list_for_each_entry", "(", "dent", ",", "&", "parent", "-", ">", "d_subdirs", ",", "d_u", ".", "d_child", ")", "{", "list_for_each_entry", "(", "dent", ",", "&", "parent", "-", ">", "d_subdirs", ",", "d_child", ")", "{", "if", "(", "(", "unsigned", "long", ")", "dent", "-", ">", "d_fsdata", "=", "=", "fpos", ")", "{", "if", "(", "dent", "-", ">", "d_inode", ")", "dget", "(", "dent", ")", ";", "@", "@", "-", "191", ",", "7", "+", "191", ",", "7", "@", "@", "ncp_renew_dentries", "(", "struct", "dentry", "*", "parent", ")", "struct", "dentry", "*", "dentry", ";", "spin_lock", "(", "&", "parent", "-", ">", "d_lock", ")", ";", "list_for_each_entry", "(", "dentry", ",", "&", "parent", "-", ">", "d_subdirs", ",", "d_u", ".", "d_child", ")", "{", "list_for_each_entry", "(", "dentry", ",", "&", "parent", "-", ">", "d_subdirs", ",", "d_child", ")", "{", "if", "(", "dentry", "-", ">", "d_fsdata", "=", "=", "NULL", ")", "ncp_age_dentry", "(", "server", ",", "dentry", ")", ";", "else", "@", "@", "-", "207", ",", "7", "+", "207", ",", "7", "@", "@", "ncp_invalidate_dircache_entries", "(", "struct", "dentry", "*", "parent", ")", "struct", "dentry", "*", "dentry", ";", "spin_lock", "(", "&", "parent", "-", ">", "d_lock", ")", ";", "list_for_each_entry", "(", "dentry", ",", "&", "parent", "-", ">", "d_subdirs", ",", "d_u", ".", "d_child", ")", "{", "list_for_each_entry", "(", "dentry", ",", "&", "parent", "-", ">", "d_subdirs", ",", "d_child", ")", "{", "dentry", "-", ">", "d_fsdata", "=", "NULL", ";", "ncp_age_dentry", "(", "server", ",", "dentry", ")", ";", "}", "@", "@", "-", "58", ",", "7", "+", "58", ",", "7", "@", "@", "static", "int", "nfs_superblock_set_dummy_root", "(", "struct", "super_block", "*", "sb", ",", "struct", "inode", "*", "i", "*", "/", "spin_lock", "(", "&", "sb", "-", ">", "s_root", "-", ">", "d_inode", "-", ">", "i_lock", ")", ";", "spin_lock", "(", "&", "sb", "-", ">", "s_root", "-", ">", "d_lock", ")", ";", "hlist_del_init", "(", "&", "sb", "-", ">", "s_root", "-", ">", "d_alias", ")", ";", "hlist_del_init", "(", "&", "sb", "-", ">", "s_root", "-", ">", "d_u", ".", "d_alias", ")", ";", "spin_unlock", "(", "&", "sb", "-", ">", "s_root", "-", ">", "d_lock", ")", ";", "spin_unlock", "(", "&", "sb", "-", ">", "s_root", "-", ">", "d_inode", "-", ">", "i_lock", ")", ";", "}", "@", "@", "-", "63", ",", "14", "+", "63", ",", "14", "@", "@", "void", "__fsnotify_update_child_dentry_flags", "(", "struct", "inode", "*", "inode", ")", "spin_lock", "(", "&", "inode", "-", ">", "i_lock", ")", ";", "/", "*", "run", "all", "of", "the", "dentries", "associated", "with", "this", "inode", ".", "Since", "this", "is", "a", "*", "directory", ",", "there", "damn", "well", "better", "only", "be", "one", "item", "on", "this", "list", "*", "/", "hlist_for_each_entry", "(", "alias", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_alias", ")", "{", "hlist_for_each_entry", "(", "alias", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_u", ".", "d_alias", ")", "{", "struct", "dentry", "*", "child", ";", "/", "*", "run", "all", "of", "the", "children", "of", "the", "original", "inode", "and", "fix", "their", "*", "d_flags", "to", "indicate", "parental", "interest", "(", "their", "parent", "is", "the", "*", "original", "inode", ")", "*", "/", "spin_lock", "(", "&", "alias", "-", ">", "d_lock", ")", ";", "list_for_each_entry", "(", "child", ",", "&", "alias", "-", ">", "d_subdirs", ",", "d_u", ".", "d_child", ")", "{", "list_for_each_entry", "(", "child", ",", "&", "alias", "-", ">", "d_subdirs", ",", "d_child", ")", "{", "if", "(", "!", "child", "-", ">", "d_inode", ")", "continue", ";", "@", "@", "-", "172", ",", "7", "+", "172", ",", "7", "@", "@", "struct", "dentry", "*", "ocfs2_find_local_alias", "(", "struct", "inode", "*", "inode", ",", "struct", "dentry", "*", "dentry", ";", "spin_lock", "(", "&", "inode", "-", ">", "i_lock", ")", ";", "hlist_for_each_entry", "(", "dentry", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_alias", ")", "{", "hlist_for_each_entry", "(", "dentry", ",", "&", "inode", "-", ">", "i_dentry", ",", "d_u", ".", "d_alias", ")", "{", "spin_lock", "(", "&", "dentry", "-", ">", "d_lock", ")", ";", "if", "(", "ocfs2_match_dentry", "(", "dentry", ",", "parent_blkno", ",", "skip_unhashed", ")", ")", "{", "trace_ocfs2_find_local_alias", "(", "dentry", "-", ">", "d_name", ".", "len", ",", "@", "@", "-", "124", ",", "15", "+", "124", ",", "15", "@", "@", "struct", "dentry", "{", "void", "*", "d_fsdata", ";", "/", "*", "fs", "-", "specific", "data", "*", "/", "struct", "list_head", "d_lru", ";", "/", "*", "LRU", "list", "*", "/", "struct", "list_head", "d_child", ";", "/", "*", "child", "of", "parent", "list", "*", "/", "struct", "list_head", "d_subdirs", ";", "/", "*", "our", "children", "*", "/", "/", "*", "*", "d_child", "and", "d_rcu", "can", "share", "memory", "*", "d_alias", "and", "d_rcu", "can", "share", "memory", "*", "/", "union", "{", "struct", "list_head", "d_child", ";", "/", "*", "child", "of", "parent", "list", "*", "/", "struct", "hlist_node", "d_alias", ";", "/", "*", "inode", "alias", "list", "*", "/", "struct", "rcu_head", "d_rcu", ";", "}", "d_u", ";", "struct", "list_head", "d_subdirs", ";", "/", "*", "our", "children", "*", "/", "struct", "hlist_node", "d_alias", ";", "/", "*", "inode", "alias", "list", "*", "/", "}", ";", "/", "*", "@", "@", "-", "6420", ",", "7", "+", "6420", ",", "7", "@", "@", "static", "int", "instance_mkdir", "(", "struct", "inode", "*", "inode", ",", "struct", "dentry", "*", "dentry", ",", "umode_t", "m", "int", "ret", ";", "/", "*", "Paranoid", ":", "Make", "sure", "the", "parent", "is", "the", "\"", "instances", "\"", "directory", "*", "/", "parent", "=", "hlist_entry", "(", "inode", "-", ">", "i_dentry", ".", "first", ",", "struct", "dentry", ",", "d_alias", ")", ";", "parent", "=", "hlist_entry", "(", "inode", "-", ">", "i_dentry", ".", "first", ",", "struct", "dentry", ",", "d_u", ".", "d_alias", ")", ";", "if", "(", "WARN_ON_ONCE", "(", "parent", "!", "=", "trace_instance_dir", ")", ")", "return", "-", "ENOENT", ";", "@", "@", "-", "6447", ",", "7", "+", "6447", ",", "7", "@", "@", "static", "int", "instance_rmdir", "(", "struct", "inode", "*", "inode", ",", "struct", "dentry", "*", "dentry", ")", "int", "ret", ";", "/", "*", "Paranoid", ":", "Make", "sure", "the", "parent", "is", "the", "\"", "instances", "\"", "directory", "*", "/", "parent", "=", "hlist_entry", "(", "inode", "-", ">", "i_dentry", ".", "first", ",", "struct", "dentry", ",", "d_alias", ")", ";", "parent", "=", "hlist_entry", "(", "inode", "-", ">", "i_dentry", ".", "first", ",", "struct", "dentry", ",", "d_u", ".", "d_alias", ")", ";", "if", "(", "WARN_ON_ONCE", "(", "parent", "!", "=", "trace_instance_dir", ")", ")", "return", "-", "ENOENT", ";", "@", "@", "-", "461", ",", "7", "+", "461", ",", "7", "@", "@", "static", "void", "remove_event_file_dir", "(", "struct", "ftrace_event_file", "*", "file", ")", "if", "(", "dir", ")", "{", "spin_lock", "(", "&", "dir", "-", ">", "d_lock", ")", ";", "/", "*", "probably", "unneeded", "*", "/", "list_for_each_entry", "(", "child", ",", "&", "dir", "-", ">", "d_subdirs", ",", "d_u", ".", "d_child", ")", "{", "list_for_each_entry", "(", "child", ",", "&", "dir", "-", ">", "d_subdirs", ",", "d_child", ")", "{", "if", "(", "child", "-", ">", "d_inode", ")", "/", "*", "probably", "unneeded", "*", "/", "child", "-", ">", "d_inode", "-", ">", "i_private", "=", "NULL", ";", "}", "@", "@", "-", "1200", ",", "7", "+", "1200", ",", "7", "@", "@", "static", "void", "sel_remove_entries", "(", "struct", "dentry", "*", "de", ")", "spin_lock", "(", "&", "de", "-", ">", "d_lock", ")", ";", "node", "=", "de", "-", ">", "d_subdirs", ".", "next", ";", "while", "(", "node", "!", "=", "&", "de", "-", ">", "d_subdirs", ")", "{", "struct", "dentry", "*", "d", "=", "list_entry", "(", "node", ",", "struct", "dentry", ",", "d_u", ".", "d_child", ")", ";", "struct", "dentry", "*", "d", "=", "list_entry", "(", "node", ",", "struct", "dentry", ",", "d_child", ")", ";", "spin_lock_nested", "(", "&", "d", "-", ">", "d_lock", ",", "DENTRY_D_LOCK_NESTED", ")", ";", "list_del_init", "(", "node", ")", ";", "@", "@", "-", "1674", ",", "12", "+", "1674", ",", "12", "@", "@", "static", "void", "sel_remove_classes", "(", "void", ")", "list_for_each", "(", "class_node", ",", "&", "class_dir", "-", ">", "d_subdirs", ")", "{", "struct", "dentry", "*", "class_subdir", "=", "list_entry", "(", "class_node", ",", "struct", "dentry", ",", "d_u", ".", "d_child", ")", ";", "struct", "dentry", ",", "d_child", ")", ";", "struct", "list_head", "*", "class_subdir_node", ";", "list_for_each", "(", "class_subdir_node", ",", "&", "class_subdir", "-", ">", "d_subdirs", ")", "{", "struct", "dentry", "*", "d", "=", "list_entry", "(", "class_subdir_node", ",", "struct", "dentry", ",", "d_u", ".", "d_child", ")", ";", "struct", "dentry", ",", "d_child", ")", ";", "if", "(", "d", "-", ">", "d_inode", ")", "if", "(", "d", "-", ">", "d_inode", "-", ">", "i_mode", "&", "S_IFDIR", ")"], "docstring_tokens": ["does", "not", "properly", "maintain", "the", "semantics", "of", "rename_lock"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "513", ",", "7", "+", "513", ",", "7", "@", "@", "public", "void", "execute", "(", "OperationContext", "context", ",", "ModelNode", "operation", ")", "throws", "Operat", "context", ".", "addStep", "(", "new", "OperationStepHandler", "(", ")", "{", "@", "Override", "public", "void", "execute", "(", "OperationContext", "context", ",", "ModelNode", "operation", ")", "throws", "OperationFailedException", "{", "context", ".", "authorize", "(", "operation", ",", "EnumSet", ".", "of", "(", "Action", ".", "ActionEffect", ".", "WRITE_RUNTIME", ")", ");", "context", ".", "authorize", "(", "operation", ",", "EnumSet", ".", "of", "(", "Action", ".", "ActionEffect", ".", "WRITE_RUNTIME", ")", ").", "failIfDenied", "(", "operation", ")", ";", "context", ".", "completeStep", "(", "new", "OperationContext", ".", "ResultHandler", "(", ")", "{", "@", "Override", "public", "void", "handleResult", "(", "OperationContext", ".", "ResultAction", "resultAction", ",", "OperationContext", "context", ",", "ModelNode", "operation", ")", "{", "@", "@", "-", "551", ",", "7", "+", "551", ",", "7", "@", "@", "public", "void", "execute", "(", "OperationContext", "context", ",", "ModelNode", "operation", ")", "throws", "Operat", "context", ".", "addStep", "(", "new", "OperationStepHandler", "(", ")", "{", "@", "Override", "public", "void", "execute", "(", "OperationContext", "context", ",", "ModelNode", "operation", ")", "throws", "OperationFailedException", "{", "context", ".", "authorize", "(", "operation", ",", "EnumSet", ".", "of", "(", "Action", ".", "ActionEffect", ".", "WRITE_RUNTIME", ")", ");", "context", ".", "authorize", "(", "operation", ",", "EnumSet", ".", "of", "(", "Action", ".", "ActionEffect", ".", "WRITE_RUNTIME", ")", ").", "failIfDenied", "(", "operation", ")", ";", "context", ".", "completeStep", "(", "new", "OperationContext", ".", "ResultHandler", "(", ")", "{", "@", "Override", "public", "void", "handleResult", "(", "OperationContext", ".", "ResultAction", "resultAction", ",", "OperationContext", "context", ",", "ModelNode", "operation", ")", "{", "@", "@", "-", "49", ",", "7", "+", "49", ",", "7", "@", "@", "public", "void", "execute", "(", "final", "OperationContext", "context", ",", "final", "ModelNode", "operation", ")", "t", "context", ".", "addStep", "(", "new", "OperationStepHandler", "(", ")", "{", "@", "Override", "public", "void", "execute", "(", "OperationContext", "context", ",", "ModelNode", "operation", ")", "throws", "OperationFailedException", "{", "context", ".", "authorize", "(", "operation", ",", "EnumSet", ".", "of", "(", "Action", ".", "ActionEffect", ".", "WRITE_RUNTIME", ")", ");", "context", ".", "authorize", "(", "operation", ",", "EnumSet", ".", "of", "(", "Action", ".", "ActionEffect", ".", "WRITE_RUNTIME", ")", ").", "failIfDenied", "(", "operation", ")", ";", "context", ".", "completeStep", "(", "new", "OperationContext", ".", "ResultHandler", "(", ")", "{", "@", "Override", "public", "void", "handleResult", "(", "OperationContext", ".", "ResultAction", "resultAction", ",", "OperationContext", "context", ",", "ModelNode", "operation", ")", "{", "@", "@", "-", "71", ",", "7", "+", "71", ",", "7", "@", "@", "public", "void", "execute", "(", "OperationContext", "context", ",", "ModelNode", "operation", ")", "throws", "Operat", "/", "/", "If", "another", "op", "that", "is", "a", "step", "in", "a", "composite", "step", "with", "this", "op", "needs", "to", "modify", "the", "container", "/", "/", "it", "will", "have", "to", "wait", "for", "container", "stability", ",", "so", "skipping", "this", "only", "matters", "for", "the", "case", "/", "/", "where", "this", "step", "is", "the", "only", "runtime", "change", ".", "context", ".", "authorize", "(", "operation", ",", "EnumSet", ".", "of", "(", "Action", ".", "ActionEffect", ".", "WRITE_RUNTIME", ")", ");", "context", ".", "authorize", "(", "operation", ",", "EnumSet", ".", "of", "(", "Action", ".", "ActionEffect", ".", "WRITE_RUNTIME", ")", ").", "failIfDenied", "(", "operation", ")", ";", "final", "ServerStatus", "status", "=", "serverInventory", ".", "stopServer", "(", "serverName", ",", "timeout", ",", "blocking", ")", ";", "try", "{", "@", "@", "-", "163", ",", "6", "+", "163", ",", "12", "@", "@", "public", "void", "testMonitor", "(", ")", "throws", "Exception", "{", "testWLFY2299", "(", "client", ",", "Outcome", ".", "UNAUTHORIZED", ",", "MONITOR_USER", ")", ";", "restartServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "MONITOR_USER", ")", ";", "stopServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "MONITOR_USER", ")", ";", "killServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "MONITOR_USER", ")", ";", "destroyServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "MONITOR_USER", ")", ";", "killServersInGroup", "(", "client", ",", "Outcome", ".", "UNAUTHORIZED", ",", "MONITOR_USER", ")", ";", "destroyServersInGroup", "(", "client", ",", "Outcome", ".", "UNAUTHORIZED", ",", "MONITOR_USER", ")", ";", "}", "@", "Test", "@", "@", "-", "261", ",", "6", "+", "267", ",", "12", "@", "@", "public", "void", "testDeployer", "(", ")", "throws", "Exception", "{", "testWLFY2299", "(", "client", ",", "Outcome", ".", "UNAUTHORIZED", ",", "DEPLOYER_USER", ")", ";", "restartServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "DEPLOYER_USER", ")", ";", "stopServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "DEPLOYER_USER", ")", ";", "killServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "DEPLOYER_USER", ")", ";", "destroyServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "DEPLOYER_USER", ")", ";", "killServersInGroup", "(", "client", ",", "Outcome", ".", "UNAUTHORIZED", ",", "DEPLOYER_USER", ")", ";", "destroyServersInGroup", "(", "client", ",", "Outcome", ".", "UNAUTHORIZED", ",", "DEPLOYER_USER", ")", ";", "}", "@", "Test", "@", "@", "-", "326", ",", "6", "+", "338", ",", "12", "@", "@", "public", "void", "testAuditor", "(", ")", "throws", "Exception", "{", "testWLFY2299", "(", "client", ",", "Outcome", ".", "UNAUTHORIZED", ",", "AUDITOR_USER", ")", ";", "restartServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "AUDITOR_USER", ")", ";", "stopServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "AUDITOR_USER", ")", ";", "killServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "AUDITOR_USER", ")", ";", "destroyServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "AUDITOR_USER", ")", ";", "killServersInGroup", "(", "client", ",", "Outcome", ".", "UNAUTHORIZED", ",", "AUDITOR_USER", ")", ";", "destroyServersInGroup", "(", "client", ",", "Outcome", ".", "UNAUTHORIZED", ",", "AUDITOR_USER", ")", ";", "}", "@", "Test", "@", "@", "-", "22", ",", "31", "+", "22", ",", "7", "@", "@", "package", "org", ".", "jboss", ".", "as", ".", "test", ".", "integration", ".", "domain", ".", "rbac", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "ACCESS_CONTROL", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "ADD", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "AUTO_START", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "BLOCKING", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "BYTES", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "CHILD_TYPE", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "CONTENT", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "DESCRIBE", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "ENABLED", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "GROUP", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "HOST", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "OPERATIONS", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "OUTCOME", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "PASSWORD", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "PATH", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "PROFILE", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "READ_CHILDREN_NAMES_OPERATION", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "READ_CONFIG_AS_XML_OPERATION", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "READ_RESOURCE_DESCRIPTION_OPERATION", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "READ_RESOURCE_OPERATION", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "REMOVE", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "RESTART", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "RESULT", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "SUBSYSTEM", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "SUCCESS", ";", "import", "static", "org", ".", "jboss", ".", "as", ".", "controller", ".", "descriptions", ".", "ModelDescriptionConstants", ".", "*;", "import", "static", "org", ".", "jboss", ".", "as", ".", "test", ".", "integration", ".", "management", ".", "util", ".", "ModelUtil", ".", "createOpNode", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "@", "@", "-", "313", ",", "6", "+", "289", ",", "53", "@", "@", "protected", "void", "restartServer", "(", "ModelControllerClient", "client", ",", "String", "host", ",", "String", "s", "RbacUtil", ".", "executeOperation", "(", "client", ",", "op", ",", "expectedOutcome", ")", ";", "}", "protected", "void", "stopServer", "(", "ModelControllerClient", "client", ",", "String", "host", ",", "String", "server", ",", "Outcome", "expectedOutcome", ",", "String", ".", "..", "roles", ")", "throws", "IOException", "{", "String", "fullAddress", "=", "String", ".", "format", "(", "\"", "host", "=", "%", "s", "/", "server", "-", "config", "=", "%", "s", "\"", ",", "host", ",", "server", ")", ";", "ModelNode", "op", "=", "createOpNode", "(", "fullAddress", ",", "STOP", ")", ";", "op", ".", "get", "(", "BLOCKING", ")", ".", "set", "(", "true", ")", ";", "configureRoles", "(", "op", ",", "roles", ")", ";", "RbacUtil", ".", "executeOperation", "(", "client", ",", "op", ",", "expectedOutcome", ")", ";", "}", "protected", "void", "killServer", "(", "ModelControllerClient", "client", ",", "String", "host", ",", "String", "server", ",", "Outcome", "expectedOutcome", ",", "String", ".", "..", "roles", ")", "throws", "IOException", "{", "String", "fullAddress", "=", "String", ".", "format", "(", "\"", "host", "=", "%", "s", "/", "server", "-", "config", "=", "%", "s", "\"", ",", "host", ",", "server", ")", ";", "ModelNode", "op", "=", "createOpNode", "(", "fullAddress", ",", "KILL", ")", ";", "op", ".", "get", "(", "BLOCKING", ")", ".", "set", "(", "true", ")", ";", "configureRoles", "(", "op", ",", "roles", ")", ";", "RbacUtil", ".", "executeOperation", "(", "client", ",", "op", ",", "expectedOutcome", ")", ";", "}", "protected", "void", "destroyServer", "(", "ModelControllerClient", "client", ",", "String", "host", ",", "String", "server", ",", "Outcome", "expectedOutcome", ",", "String", ".", "..", "roles", ")", "throws", "IOException", "{", "String", "fullAddress", "=", "String", ".", "format", "(", "\"", "host", "=", "%", "s", "/", "server", "-", "config", "=", "%", "s", "\"", ",", "host", ",", "server", ")", ";", "ModelNode", "op", "=", "createOpNode", "(", "fullAddress", ",", "DESTROY", ")", ";", "op", ".", "get", "(", "BLOCKING", ")", ".", "set", "(", "true", ")", ";", "configureRoles", "(", "op", ",", "roles", ")", ";", "RbacUtil", ".", "executeOperation", "(", "client", ",", "op", ",", "expectedOutcome", ")", ";", "}", "protected", "void", "killServersInGroup", "(", "ModelControllerClient", "client", ",", "Outcome", "expectedOutcome", ",", "String", ".", "..", "roles", ")", "throws", "IOException", "{", "final", "String", "serverGroupAddress", "=", "String", ".", "format", "(", "\"", "server", "-", "group", "=", "%", "s", "\"", ",", "SERVER_GROUP_A", ")", ";", "/", "/", "check", "ModelNode", "op", "=", "createOpNode", "(", "serverGroupAddress", ",", "KILL_SERVERS", ")", ";", "op", ".", "get", "(", "BLOCKING", ")", ".", "set", "(", "true", ")", ";", "configureRoles", "(", "op", ",", "roles", ")", ";", "RbacUtil", ".", "executeOperation", "(", "client", ",", "op", ",", "expectedOutcome", ")", ";", "}", "protected", "void", "destroyServersInGroup", "(", "ModelControllerClient", "client", ",", "Outcome", "expectedOutcome", ",", "String", ".", "..", "roles", ")", "throws", "IOException", "{", "final", "String", "serverGroupAddress", "=", "String", ".", "format", "(", "\"", "server", "-", "group", "=", "%", "s", "\"", ",", "SERVER_GROUP_A", ")", ";", "/", "/", "check", "ModelNode", "op", "=", "createOpNode", "(", "serverGroupAddress", ",", "DESTROY_SERVERS", ")", ";", "op", ".", "get", "(", "BLOCKING", ")", ".", "set", "(", "true", ")", ";", "configureRoles", "(", "op", ",", "roles", ")", ";", "RbacUtil", ".", "executeOperation", "(", "client", ",", "op", ",", "expectedOutcome", ")", ";", "}", "protected", "ModelNode", "getServerConfigAccessControl", "(", "ModelControllerClient", "client", ",", "String", ".", "..", "roles", ")", "throws", "IOException", "{", "ModelNode", "op", "=", "createOpNode", "(", "GENERIC_SERVER_CONFIG_ADDRESS", ",", "READ_RESOURCE_DESCRIPTION_OPERATION", ")", ";", "op", ".", "get", "(", "ACCESS_CONTROL", ")", ".", "set", "(", "\"", "trim", "-", "descriptions", "\"", ");", "@", "@", "-", "98", ",", "6", "+", "98", ",", "12", "@", "@", "public", "void", "testMonitor", "(", ")", "throws", "Exception", "{", "/", "/", "Monitor", "can", "'", "t", "shutdown", "testWCORE1067", "(", "client", ",", "MONITOR_USER", ")", ";", "stopServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "MONITOR_USER", ")", ";", "killServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "MONITOR_USER", ")", ";", "destroyServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "MONITOR_USER", ")", ";", "killServersInGroup", "(", "client", ",", "Outcome", ".", "UNAUTHORIZED", ",", "MONITOR_USER", ")", ";", "destroyServersInGroup", "(", "client", ",", "Outcome", ".", "UNAUTHORIZED", ",", "MONITOR_USER", ")", ";", "}", "@", "Test", "@", "@", "-", "169", ",", "6", "+", "175", ",", "12", "@", "@", "public", "void", "testDeployer", "(", ")", "throws", "Exception", "{", "/", "/", "Deployer", "can", "'", "t", "shutdown", "testWCORE1067", "(", "client", ",", "DEPLOYER_USER", ")", ";", "stopServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "DEPLOYER_USER", ")", ";", "killServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "DEPLOYER_USER", ")", ";", "destroyServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "DEPLOYER_USER", ")", ";", "killServersInGroup", "(", "client", ",", "Outcome", ".", "UNAUTHORIZED", ",", "DEPLOYER_USER", ")", ";", "destroyServersInGroup", "(", "client", ",", "Outcome", ".", "UNAUTHORIZED", ",", "DEPLOYER_USER", ")", ";", "}", "@", "Test", "@", "@", "-", "218", ",", "6", "+", "230", ",", "12", "@", "@", "public", "void", "testAuditor", "(", ")", "throws", "Exception", "{", "/", "/", "Auditor", "can", "'", "t", "shutdown", "testWCORE1067", "(", "client", ",", "AUDITOR_USER", ")", ";", "stopServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "AUDITOR_USER", ")", ";", "killServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "AUDITOR_USER", ")", ";", "destroyServer", "(", "client", ",", "MASTER", ",", "MASTER_A", ",", "Outcome", ".", "UNAUTHORIZED", ",", "AUDITOR_USER", ")", ";", "killServersInGroup", "(", "client", ",", "Outcome", ".", "UNAUTHORIZED", ",", "AUDITOR_USER", ")", ";", "destroyServersInGroup", "(", "client", ",", "Outcome", ".", "UNAUTHORIZED", ",", "AUDITOR_USER", ")", ";", "}", "@", "Test"], "docstring_tokens": ["incorrect", "default", "user", "permissions", "settings"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "517", ",", "8", "+", "517", ",", "6", "@", "@", "static", "inline", "void", "choose_new_parent", "(", "task_t", "*", "p", ",", "task_t", "*", "reaper", ",", "task_t", "*", "child_re", "*", "/", "BUG_ON", "(", "p", "=", "=", "reaper", "|", "|", "reaper", "-", ">", "exit_state", ">", "=", "EXIT_ZOMBIE", ")", ";", "p", "-", ">", "real_parent", "=", "reaper", ";", "if", "(", "p", "-", ">", "parent", "=", "=", "p", "-", ">", "real_parent", ")", "BUG", "(", ");", "}", "static", "inline", "void", "reparent_thread", "(", "task_t", "*", "p", ",", "task_t", "*", "father", ",", "int", "traced", ")"], "docstring_tokens": ["includes", "certain", "debugging", "code"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "290", ",", "6", "+", "290", ",", "11", "@", "@", "static", "int", "magicmouse_raw_event", "(", "struct", "hid_device", "*", "hdev", ",", "if", "(", "size", "<", "4", "|", "|", "(", "(", "size", "-", "4", ")", "%", "9", ")", "!", "=", "0", ")", "return", "0", ";", "npoints", "=", "(", "size", "-", "4", ")", "/", "9", ";", "if", "(", "npoints", ">", "15", ")", "{", "hid_warn", "(", "hdev", ",", "\"", "invalid", "size", "value", "(", "%", "d", ")", "for", "TRACKPAD_REPORT_ID", "\\", "n", "\"", ",", "size", ")", ";", "return", "0", ";", "}", "msc", "-", ">", "ntouches", "=", "0", ";", "for", "(", "ii", "=", "0", ";", "ii", "<", "npoints", ";", "ii", "+", "+)", "magicmouse_emit_touch", "(", "msc", ",", "ii", ",", "data", "+", "ii", "*", "9", "+", "4", ")", ";", "@", "@", "-", "307", ",", "6", "+", "312", ",", "11", "@", "@", "static", "int", "magicmouse_raw_event", "(", "struct", "hid_device", "*", "hdev", ",", "if", "(", "size", "<", "6", "|", "|", "(", "(", "size", "-", "6", ")", "%", "8", ")", "!", "=", "0", ")", "return", "0", ";", "npoints", "=", "(", "size", "-", "6", ")", "/", "8", ";", "if", "(", "npoints", ">", "15", ")", "{", "hid_warn", "(", "hdev", ",", "\"", "invalid", "size", "value", "(", "%", "d", ")", "for", "MOUSE_REPORT_ID", "\\", "n", "\"", ",", "size", ")", ";", "return", "0", ";", "}", "msc", "-", ">", "ntouches", "=", "0", ";", "for", "(", "ii", "=", "0", ";", "ii", "<", "npoints", ";", "ii", "+", "+)", "magicmouse_emit_touch", "(", "msc", ",", "ii", ",", "data", "+", "ii", "*", "8", "+", "6", ")", ";"], "docstring_tokens": ["improper", "bounds", "checking"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "116", ",", "8", "+", "116", ",", "34", "@", "@", "static", "inline", "void", "switch_mm", "(", "struct", "mm_struct", "*", "prev", ",", "struct", "mm_struct", "*", "next", ",", "#", "endif", "cpumask_set_cpu", "(", "cpu", ",", "mm_cpumask", "(", "next", ")", ");", "/", "*", "Re", "-", "load", "page", "tables", "*", "/", "/", "*", "*", "Re", "-", "load", "page", "tables", ".", "*", "*", "This", "logic", "has", "an", "ordering", "constraint", ":", "*", "*", "CPU", "0", ":", "Write", "to", "a", "PTE", "for", "'", "next", "'", "*", "CPU", "0", ":", "load", "bit", "1", "in", "mm_cpumask", ".", "if", "nonzero", ",", "send", "IPI", ".", "*", "CPU", "1", ":", "set", "bit", "1", "in", "next", "'", "s", "mm_cpumask", "*", "CPU", "1", ":", "load", "from", "the", "PTE", "that", "CPU", "0", "writes", "(", "implicit", ")", "*", "*", "We", "need", "to", "prevent", "an", "outcome", "in", "which", "CPU", "1", "observes", "*", "the", "new", "PTE", "value", "and", "CPU", "0", "observes", "bit", "1", "clear", "in", "*", "mm_cpumask", ".", "(", "If", "that", "occurs", ",", "then", "the", "IPI", "will", "never", "*", "be", "sent", ",", "and", "CPU", "0", "'", "s", "TLB", "will", "contain", "a", "stale", "entry", ".", ")", "*", "*", "The", "bad", "outcome", "can", "occur", "if", "either", "CPU", "'", "s", "load", "is", "*", "reordered", "before", "that", "CPU", "'", "s", "store", ",", "so", "both", "CPUs", "much", "*", "execute", "full", "barriers", "to", "prevent", "this", "from", "happening", ".", "*", "*", "Thus", ",", "switch_mm", "needs", "a", "full", "barrier", "between", "the", "*", "store", "to", "mm_cpumask", "and", "any", "operation", "that", "could", "load", "*", "from", "next", "-", ">", "pgd", ".", "This", "barrier", "synchronizes", "with", "*", "remote", "TLB", "flushers", ".", "Fortunately", ",", "load_cr3", "is", "*", "serializing", "and", "thus", "acts", "as", "a", "full", "barrier", ".", "*", "*", "/", "load_cr3", "(", "next", "-", ">", "pgd", ")", ";", "trace_tlb_flush", "(", "TLB_FLUSH_ON_TASK_SWITCH", ",", "TLB_FLUSH_ALL", ")", ";", "/", "*", "Stop", "flush", "ipis", "for", "the", "previous", "mm", "*", "/", "@", "@", "-", "156", ",", "10", "+", "182", ",", "15", "@", "@", "static", "inline", "void", "switch_mm", "(", "struct", "mm_struct", "*", "prev", ",", "struct", "mm_struct", "*", "next", ",", "*", "schedule", ",", "protecting", "us", "from", "simultaneous", "changes", ".", "*", "/", "cpumask_set_cpu", "(", "cpu", ",", "mm_cpumask", "(", "next", ")", ");", "/", "*", "*", "We", "were", "in", "lazy", "tlb", "mode", "and", "leave_mm", "disabled", "*", "tlb", "flush", "IPI", "delivery", ".", "We", "must", "reload", "CR3", "*", "to", "make", "sure", "to", "use", "no", "freed", "page", "tables", ".", "*", "*", "As", "above", ",", "this", "is", "a", "barrier", "that", "forces", "*", "TLB", "repopulation", "to", "be", "ordered", "after", "the", "*", "store", "to", "mm_cpumask", ".", "*", "/", "load_cr3", "(", "next", "-", ">", "pgd", ")", ";", "trace_tlb_flush", "(", "TLB_FLUSH_ON_TASK_SWITCH", ",", "TLB_FLUSH_ALL", ")", ";", "@", "@", "-", "161", ",", "7", "+", "161", ",", "10", "@", "@", "void", "flush_tlb_current_task", "(", "void", ")", "preempt_disable", "(", ");", "count_vm_tlb_event", "(", "NR_TLB_LOCAL_FLUSH_ALL", ")", ";", "/", "*", "This", "is", "an", "implicit", "full", "barrier", "that", "synchronizes", "with", "switch_mm", ".", "*", "/", "local_flush_tlb", "(", ");", "trace_tlb_flush", "(", "TLB_LOCAL_SHOOTDOWN", ",", "TLB_FLUSH_ALL", ")", ";", "if", "(", "cpumask_any_but", "(", "mm_cpumask", "(", "mm", ")", ",", "smp_processor_id", "(", "))", "<", "nr_cpu_ids", ")", "flush_tlb_others", "(", "mm_cpumask", "(", "mm", ")", ",", "mm", ",", "0UL", ",", "TLB_FLUSH_ALL", ")", ";", "@", "@", "-", "188", ",", "17", "+", "191", ",", "29", "@", "@", "void", "flush_tlb_mm_range", "(", "struct", "mm_struct", "*", "mm", ",", "unsigned", "long", "start", ",", "unsigned", "long", "base_pages_to_flush", "=", "TLB_FLUSH_ALL", ";", "preempt_disable", "(", ");", "if", "(", "current", "-", ">", "active_mm", "!", "=", "mm", ")", "if", "(", "current", "-", ">", "active_mm", "!", "=", "mm", ")", "{", "/", "*", "Synchronize", "with", "switch_mm", ".", "*", "/", "smp_mb", "(", ");", "goto", "out", ";", "}", "if", "(", "!", "current", "-", ">", "mm", ")", "{", "leave_mm", "(", "smp_processor_id", "(", "))", ";", "/", "*", "Synchronize", "with", "switch_mm", ".", "*", "/", "smp_mb", "(", ");", "goto", "out", ";", "}", "if", "(", "(", "end", "!", "=", "TLB_FLUSH_ALL", ")", "&", "&", "!", "(", "vmflag", "&", "VM_HUGETLB", ")", ")", "base_pages_to_flush", "=", "(", "end", "-", "start", ")", ">", ">", "PAGE_SHIFT", ";", "/", "*", "*", "Both", "branches", "below", "are", "implicit", "full", "barriers", "(", "MOV", "to", "CR", "or", "*", "INVLPG", ")", "that", "synchronize", "with", "switch_mm", ".", "*", "/", "if", "(", "base_pages_to_flush", ">", "tlb_single_page_flush_ceiling", ")", "{", "base_pages_to_flush", "=", "TLB_FLUSH_ALL", ";", "count_vm_tlb_event", "(", "NR_TLB_LOCAL_FLUSH_ALL", ")", ";", "@", "@", "-", "228", ",", "10", "+", "243", ",", "18", "@", "@", "void", "flush_tlb_page", "(", "struct", "vm_area_struct", "*", "vma", ",", "unsigned", "long", "start", ")", "preempt_disable", "(", ");", "if", "(", "current", "-", ">", "active_mm", "=", "=", "mm", ")", "{", "if", "(", "current", "-", ">", "mm", ")", "if", "(", "current", "-", ">", "mm", ")", "{", "/", "*", "*", "Implicit", "full", "barrier", "(", "INVLPG", ")", "that", "synchronizes", "*", "with", "switch_mm", ".", "*", "/", "__flush_tlb_one", "(", "start", ")", ";", "else", "}", "else", "{", "leave_mm", "(", "smp_processor_id", "(", "))", ";", "/", "*", "Synchronize", "with", "switch_mm", ".", "*", "/", "smp_mb", "(", ");", "}", "}", "if", "(", "cpumask_any_but", "(", "mm_cpumask", "(", "mm", ")", ",", "smp_processor_id", "(", "))", "<", "nr_cpu_ids", ")"], "docstring_tokens": ["finding", "a", "code", "path", "that", "unmaps", "a", "page"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "43", ",", "7", "+", "43", ",", "7", "@", "@", "extern", "int", "mincore_huge_pmd", "(", "struct", "vm_area_struct", "*", "vma", ",", "pmd_t", "*", "pmd", ",", "unsigned", "char", "*", "vec", ")", ";", "extern", "bool", "move_huge_pmd", "(", "struct", "vm_area_struct", "*", "vma", ",", "unsigned", "long", "old_addr", ",", "unsigned", "long", "new_addr", ",", "unsigned", "long", "old_end", ",", "pmd_t", "*", "old_pmd", ",", "pmd_t", "*", "new_pmd", ",", "bool", "*", "need_flush", ")", ";", "pmd_t", "*", "old_pmd", ",", "pmd_t", "*", "new_pmd", ")", ";", "extern", "int", "change_huge_pmd", "(", "struct", "vm_area_struct", "*", "vma", ",", "pmd_t", "*", "pmd", ",", "unsigned", "long", "addr", ",", "pgprot_t", "newprot", ",", "int", "prot_numa", ")", ";", "@", "@", "-", "1780", ",", "7", "+", "1780", ",", "7", "@", "@", "static", "pmd_t", "move_soft_dirty_pmd", "(", "pmd_t", "pmd", ")", "bool", "move_huge_pmd", "(", "struct", "vm_area_struct", "*", "vma", ",", "unsigned", "long", "old_addr", ",", "unsigned", "long", "new_addr", ",", "unsigned", "long", "old_end", ",", "pmd_t", "*", "old_pmd", ",", "pmd_t", "*", "new_pmd", ",", "bool", "*", "need_flush", ")", "pmd_t", "*", "old_pmd", ",", "pmd_t", "*", "new_pmd", ")", "{", "spinlock_t", "*", "old_ptl", ",", "*", "new_ptl", ";", "pmd_t", "pmd", ";", "@", "@", "-", "1811", ",", "7", "+", "1811", ",", "7", "@", "@", "bool", "move_huge_pmd", "(", "struct", "vm_area_struct", "*", "vma", ",", "unsigned", "long", "old_addr", ",", "if", "(", "new_ptl", "!", "=", "old_ptl", ")", "spin_lock_nested", "(", "new_ptl", ",", "SINGLE_DEPTH_NESTING", ")", ";", "pmd", "=", "pmdp_huge_get_and_clear", "(", "mm", ",", "old_addr", ",", "old_pmd", ")", ";", "if", "(", "pmd_present", "(", "pmd", ")", "&", "&", "pmd_dirty", "(", "pmd", ")", ")", "if", "(", "pmd_present", "(", "pmd", ")", ")", "force_flush", "=", "true", ";", "VM_BUG_ON", "(", "!", "pmd_none", "(", "*", "new_pmd", ")", ");", "@", "@", "-", "1822", ",", "12", "+", "1822", ",", "10", "@", "@", "bool", "move_huge_pmd", "(", "struct", "vm_area_struct", "*", "vma", ",", "unsigned", "long", "old_addr", ",", "}", "pmd", "=", "move_soft_dirty_pmd", "(", "pmd", ")", ";", "set_pmd_at", "(", "mm", ",", "new_addr", ",", "new_pmd", ",", "pmd", ")", ";", "if", "(", "new_ptl", "!", "=", "old_ptl", ")", "spin_unlock", "(", "new_ptl", ")", ";", "if", "(", "force_flush", ")", "flush_tlb_range", "(", "vma", ",", "old_addr", ",", "old_addr", "+", "PMD_SIZE", ")", ";", "else", "*", "need_flush", "=", "true", ";", "if", "(", "new_ptl", "!", "=", "old_ptl", ")", "spin_unlock", "(", "new_ptl", ")", ";", "spin_unlock", "(", "old_ptl", ")", ";", "return", "true", ";", "}", "@", "@", "-", "115", ",", "7", "+", "115", ",", "7", "@", "@", "static", "pte_t", "move_soft_dirty_pte", "(", "pte_t", "pte", ")", "static", "void", "move_ptes", "(", "struct", "vm_area_struct", "*", "vma", ",", "pmd_t", "*", "old_pmd", ",", "unsigned", "long", "old_addr", ",", "unsigned", "long", "old_end", ",", "struct", "vm_area_struct", "*", "new_vma", ",", "pmd_t", "*", "new_pmd", ",", "unsigned", "long", "new_addr", ",", "bool", "need_rmap_locks", ",", "bool", "*", "need_flush", ")", "unsigned", "long", "new_addr", ",", "bool", "need_rmap_locks", ")", "{", "struct", "mm_struct", "*", "mm", "=", "vma", "-", ">", "vm_mm", ";", "pte_t", "*", "old_pte", ",", "*", "new_pte", ",", "pte", ";", "@", "@", "-", "163", ",", "29", "+", "163", ",", "29", "@", "@", "static", "void", "move_ptes", "(", "struct", "vm_area_struct", "*", "vma", ",", "pmd_t", "*", "old_pmd", ",", "pte", "=", "ptep_get_and_clear", "(", "mm", ",", "old_addr", ",", "old_pte", ")", ";", "/", "*", "*", "If", "we", "are", "remapping", "a", "dirty", "PTE", ",", "make", "sure", "*", "If", "we", "are", "remapping", "a", "valid", "PTE", ",", "make", "sure", "*", "to", "flush", "TLB", "before", "we", "drop", "the", "PTL", "for", "the", "*", "old", "PTE", "or", "we", "may", "race", "with", "page_mkclean", "(", ").", "*", "PTE", ".", "*", "*", "This", "check", "has", "to", "be", "done", "after", "we", "removed", "the", "*", "old", "PTE", "from", "page", "tables", "or", "another", "thread", "may", "*", "dirty", "it", "after", "the", "check", "and", "before", "the", "removal", ".", "*", "NOTE", "!", "Both", "old", "and", "new", "PTL", "matter", ":", "the", "old", "one", "*", "for", "racing", "with", "page_mkclean", "(", "),", "the", "new", "one", "to", "*", "make", "sure", "the", "physical", "page", "stays", "valid", "until", "*", "the", "TLB", "entry", "for", "the", "old", "mapping", "has", "been", "*", "flushed", ".", "*", "/", "if", "(", "pte_present", "(", "pte", ")", "&", "&", "pte_dirty", "(", "pte", ")", ")", "if", "(", "pte_present", "(", "pte", ")", ")", "force_flush", "=", "true", ";", "pte", "=", "move_pte", "(", "pte", ",", "new_vma", "-", ">", "vm_page_prot", ",", "old_addr", ",", "new_addr", ")", ";", "pte", "=", "move_soft_dirty_pte", "(", "pte", ")", ";", "set_pte_at", "(", "mm", ",", "new_addr", ",", "new_pte", ",", "pte", ")", ";", "}", "arch_leave_lazy_mmu_mode", "(", ");", "if", "(", "force_flush", ")", "flush_tlb_range", "(", "vma", ",", "old_end", "-", "len", ",", "old_end", ")", ";", "if", "(", "new_ptl", "!", "=", "old_ptl", ")", "spin_unlock", "(", "new_ptl", ")", ";", "pte_unmap", "(", "new_pte", "-", "1", ")", ";", "if", "(", "force_flush", ")", "flush_tlb_range", "(", "vma", ",", "old_end", "-", "len", ",", "old_end", ")", ";", "else", "*", "need_flush", "=", "true", ";", "pte_unmap_unlock", "(", "old_pte", "-", "1", ",", "old_ptl", ")", ";", "if", "(", "need_rmap_locks", ")", "drop_rmap_locks", "(", "vma", ")", ";", "@", "@", "-", "198", ",", "7", "+", "198", ",", "6", "@", "@", "unsigned", "long", "move_page_tables", "(", "struct", "vm_area_struct", "*", "vma", ",", "{", "unsigned", "long", "extent", ",", "next", ",", "old_end", ";", "pmd_t", "*", "old_pmd", ",", "*", "new_pmd", ";", "bool", "need_flush", "=", "false", ";", "unsigned", "long", "mmun_start", ";", "/", "*", "For", "mmu_notifiers", "*", "/", "unsigned", "long", "mmun_end", ";", "/", "*", "For", "mmu_notifiers", "*", "/", "@", "@", "-", "229", ",", "8", "+", "228", ",", "7", "@", "@", "unsigned", "long", "move_page_tables", "(", "struct", "vm_area_struct", "*", "vma", ",", "if", "(", "need_rmap_locks", ")", "take_rmap_locks", "(", "vma", ")", ";", "moved", "=", "move_huge_pmd", "(", "vma", ",", "old_addr", ",", "new_addr", ",", "old_end", ",", "old_pmd", ",", "new_pmd", ",", "&", "need_flush", ")", ";", "old_end", ",", "old_pmd", ",", "new_pmd", ")", ";", "if", "(", "need_rmap_locks", ")", "drop_rmap_locks", "(", "vma", ")", ";", "if", "(", "moved", ")", "@", "@", "-", "246", ",", "10", "+", "244", ",", "8", "@", "@", "unsigned", "long", "move_page_tables", "(", "struct", "vm_area_struct", "*", "vma", ",", "if", "(", "extent", ">", "next", "-", "new_addr", ")", "extent", "=", "next", "-", "new_addr", ";", "move_ptes", "(", "vma", ",", "old_pmd", ",", "old_addr", ",", "old_addr", "+", "extent", ",", "new_vma", ",", "new_pmd", ",", "new_addr", ",", "need_rmap_locks", ",", "&", "need_flush", ")", ";", "new_pmd", ",", "new_addr", ",", "need_rmap_locks", ")", ";", "}", "if", "(", "need_flush", ")", "flush_tlb_range", "(", "vma", ",", "old_end", "-", "len", ",", "old_addr", ")", ";", "mmu_notifier_invalidate_range_end", "(", "vma", "-", ">", "vm_mm", ",", "mmun_start", ",", "mmun_end", ")", ";"], "docstring_tokens": ["missing", "security", "fixes", "without", "CVE", "identifiers"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1673", ",", "9", "+", "1673", ",", "8", "@", "@", "static", "Image", "*", "ReadDDSImage", "(", "const", "ImageInfo", "*", "image_info", ",", "ExceptionInfo", "*", "exception", ")", "/", "*", "Initialize", "image", "structure", ".", "*", "/", "if", "(", "ReadDDSInfo", "(", "image", ",", "&", "dds_info", ")", "!", "=", "MagickTrue", ")", "{", "if", "(", "ReadDDSInfo", "(", "image", ",", "&", "dds_info", ")", "!", "=", "MagickTrue", ")", "ThrowReaderException", "(", "CorruptImageError", ",", "\"", "ImproperImageHeader", "\"", ");", "}", "if", "(", "dds_info", ".", "ddscaps2", "&", "DDSCAPS2_CUBEMAP", ")", "cubemap", "=", "MagickTrue", ";", "@", "@", "-", "1772", ",", "6", "+", "1771", ",", "9", "@", "@", "static", "Image", "*", "ReadDDSImage", "(", "const", "ImageInfo", "*", "image_info", ",", "ExceptionInfo", "*", "exception", ")", "if", "(", "volume", ")", "num_images", "=", "dds_info", ".", "depth", ";", "if", "(", "num_images", "<", "1", ")", "ThrowReaderException", "(", "CorruptImageError", ",", "\"", "ImproperImageHeader", "\"", ");", "for", "(", "n", "=", "0", ";", "n", "<", "num_images", ";", "n", "+", "+)", "{", "if", "(", "n", "!", "=", "0", ")"], "docstring_tokens": ["because", "of", "missing", "checks", "in", "the", "ReadDDSImage", "function", "in", "coders/dds.c", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "64", ",", "7", "+", "64", ",", "7", "@", "@", "public", "AuthenticationInfo", "beforeAllAttempts", "(", "Collection", "<", "?", "extends", "Realm", ">", "realms", ",", "*", "otherwise", ".", "*", "/", "public", "AuthenticationInfo", "beforeAttempt", "(", "Realm", "realm", ",", "AuthenticationToken", "token", ",", "AuthenticationInfo", "aggregate", ")", "throws", "AuthenticationException", "{", "if", "(", "getStopAfterFirstSuccess", "(", ")", "&", "&", "aggregate", "!", "=", "null", "&", "&", "isEmpty", "(", "aggregate", ".", "getPrincipals", "(", "))", ")", "{", "if", "(", "getStopAfterFirstSuccess", "(", ")", "&", "&", "aggregate", "!", "=", "null", "&", "&", "!", "isEmpty", "(", "aggregate", ".", "getPrincipals", "(", "))", ")", "{", "throw", "new", "ShortCircuitIterationException", "(", ");", "}", "return", "aggregate", ";", "@", "@", "-", "98", ",", "10", "+", "98", ",", "22", "@", "@", "public", "void", "testBeforeAttemptNull", "(", ")", "{", "assertNull", "(", "strategy", ".", "beforeAttempt", "(", "null", ",", "null", ",", "null", ")", ");", "}", "@", "Test", "public", "void", "testBeforeAttemptEmptyPrincipal", "(", ")", "{", "AuthenticationInfo", "aggregate", "=", "new", "SimpleAuthenticationInfo", "(", ");", "assertEquals", "(", "strategy", ".", "beforeAttempt", "(", "null", ",", "null", ",", "aggregate", ")", ",", "aggregate", ")", ";", "}", "@", "Test", "public", "void", "testBeforeAttemptEmptyList", "(", ")", "{", "SimplePrincipalCollection", "principalCollection", "=", "new", "SimplePrincipalCollection", "(", ");", "AuthenticationInfo", "aggregate", "=", "new", "SimpleAuthenticationInfo", "(", "principalCollection", ",", "null", ")", ";", "assertEquals", "(", "strategy", ".", "beforeAttempt", "(", "null", ",", "null", ",", "aggregate", ")", ",", "aggregate", ")", ";", "}", "@", "Test", "(", "expected", "=", "ShortCircuitIterationException", ".", "class", ")", "public", "void", "testBeforeAttemptStopAfterFirstSuccess", "(", ")", "{", "AuthenticationInfo", "aggregate", "=", "new", "SimpleAuthenticationInfo", "(", ");", "AuthenticationInfo", "aggregate", "=", "new", "SimpleAuthenticationInfo", "(", "\"", "principal", "\"", ",", "null", ",", "\"", "a", "-", "realm", "-", "name", "\"", ");", "strategy", ".", "beforeAttempt", "(", "null", ",", "null", ",", "aggregate", ")", ";", "}", "}"], "docstring_tokens": ["improper", "authentication", "validation"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "128", ",", "14", "+", "128", ",", "19", "@", "@", "private", "String", "getState", "(", "ServletRequest", "request", ")", "{", "private", "void", "verifySavedState", "(", "HttpServletRequest", "request", ")", "{", "HttpSession", "session", "=", "request", ".", "getSession", "(", "false", ")", ";", "if", "(", "session", "!", "=", "null", ")", "{", "String", "savedContext", "=", "(", "String", ")", "session", ".", "getAttribute", "(", "FederationAuthenticationEntryPoint", ".", "SAVED_CONTEXT", ")", ";", "String", "state", "=", "getState", "(", "request", ")", ";", "if", "(", "savedContext", "!", "=", "null", "&", "&", "!", "savedContext", ".", "equals", "(", "state", ")", ")", "{", "logger", ".", "warn", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "throw", "new", "BadCredentialsException", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "}", "if", "(", "session", "=", "=", "null", ")", "{", "logger", ".", "warn", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "throw", "new", "BadCredentialsException", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "}", "String", "savedContext", "=", "(", "String", ")", "session", ".", "getAttribute", "(", "FederationAuthenticationEntryPoint", ".", "SAVED_CONTEXT", ")", ";", "String", "state", "=", "getState", "(", "request", ")", ";", "if", "(", "savedContext", "=", "=", "null", "|", "|", "!", "savedContext", ".", "equals", "(", "state", ")", ")", "{", "logger", ".", "warn", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "throw", "new", "BadCredentialsException", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "}", "session", ".", "removeAttribute", "(", "FederationAuthenticationEntryPoint", ".", "SAVED_CONTEXT", ")", ";", "}", "/", "**", "@", "@", "-", "128", ",", "14", "+", "128", ",", "19", "@", "@", "private", "String", "getState", "(", "ServletRequest", "request", ")", "{", "private", "void", "verifySavedState", "(", "HttpServletRequest", "request", ")", "{", "HttpSession", "session", "=", "request", ".", "getSession", "(", "false", ")", ";", "if", "(", "session", "!", "=", "null", ")", "{", "String", "savedContext", "=", "(", "String", ")", "session", ".", "getAttribute", "(", "FederationAuthenticationEntryPoint", ".", "SAVED_CONTEXT", ")", ";", "String", "state", "=", "getState", "(", "request", ")", ";", "if", "(", "savedContext", "!", "=", "null", "&", "&", "!", "savedContext", ".", "equals", "(", "state", ")", ")", "{", "logger", ".", "warn", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "throw", "new", "BadCredentialsException", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "}", "if", "(", "session", "=", "=", "null", ")", "{", "logger", ".", "warn", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "throw", "new", "BadCredentialsException", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "}", "String", "savedContext", "=", "(", "String", ")", "session", ".", "getAttribute", "(", "FederationAuthenticationEntryPoint", ".", "SAVED_CONTEXT", ")", ";", "String", "state", "=", "getState", "(", "request", ")", ";", "if", "(", "savedContext", "=", "=", "null", "|", "|", "!", "savedContext", ".", "equals", "(", "state", ")", ")", "{", "logger", ".", "warn", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "throw", "new", "BadCredentialsException", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "}", "session", ".", "removeAttribute", "(", "FederationAuthenticationEntryPoint", ".", "SAVED_CONTEXT", ")", ";", "}", "/", "**", "@", "@", "-", "152", ",", "4", "+", "152", ",", "12", "@", "@", "public", "void", "testCSRFAttack", "(", ")", "throws", "Exception", "{", "csrfAttackTest", "(", "url", ")", ";", "}", "@", "Override", "@", "org", ".", "junit", ".", "Test", "public", "void", "testCSRFAttack2", "(", ")", "throws", "Exception", "{", "String", "url", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "getRpHttpsPort", "(", ")", "+", "\"", "/\"", "+", "getServletContextName", "(", ")", "+", "\"", "/", "j_spring_fediz_security_check", "\"", ";", "csrfAttackTest2", "(", "url", ")", ";", "}", "}", "@", "@", "-", "150", ",", "4", "+", "150", ",", "12", "@", "@", "public", "void", "testCSRFAttack", "(", ")", "throws", "Exception", "{", "+", "\"", "/", "j_spring_fediz_security_check", "\"", ";", "csrfAttackTest", "(", "url", ")", ";", "}", "@", "Override", "@", "org", ".", "junit", ".", "Test", "public", "void", "testCSRFAttack2", "(", ")", "throws", "Exception", "{", "String", "url", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "getRpHttpsPort", "(", ")", "+", "\"", "/\"", "+", "getServletContextName", "(", ")", "+", "\"", "/", "j_spring_fediz_security_check", "\"", ";", "csrfAttackTest2", "(", "url", ")", ";", "}", "}", "@", "@", "-", "801", ",", "4", "+", "801", ",", "57", "@", "@", "protected", "void", "csrfAttackTest", "(", "String", "rpURL", ")", "throws", "Exception", "{", "}", "@", "org", ".", "junit", ".", "Test", "public", "void", "testCSRFAttack2", "(", ")", "throws", "Exception", "{", "String", "url", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "getRpHttpsPort", "(", ")", "+", "\"", "/\"", "+", "getServletContextName", "(", ")", "+", "\"", "/", "secure", "/", "fedservlet", "\"", ";", "csrfAttackTest2", "(", "url", ")", ";", "}", "protected", "void", "csrfAttackTest2", "(", "String", "rpURL", ")", "throws", "Exception", "{", "String", "url", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "getRpHttpsPort", "(", ")", "+", "\"", "/\"", "+", "getServletContextName", "(", ")", "+", "\"", "/", "secure", "/", "fedservlet", "\"", ";", "/", "/", "1", ".", "Log", "in", "as", "\"", "bob", "\"", "using", "another", "WebClient", "WebClient", "webClient2", "=", "new", "WebClient", "(", ");", "webClient2", ".", "getOptions", "(", ").", "setUseInsecureSSL", "(", "true", ")", ";", "webClient2", ".", "getCredentialsProvider", "(", ").", "setCredentials", "(", "new", "AuthScope", "(", "\"", "localhost", "\"", ",", "Integer", ".", "parseInt", "(", "getIdpHttpsPort", "(", "))", "),", "new", "UsernamePasswordCredentials", "(", "\"", "bob", "\"", ",", "\"", "bob", "\"", "))", ";", "webClient2", ".", "getOptions", "(", ").", "setJavaScriptEnabled", "(", "false", ")", ";", "final", "HtmlPage", "idpPage2", "=", "webClient2", ".", "getPage", "(", "url", ")", ";", "webClient2", ".", "getOptions", "(", ").", "setJavaScriptEnabled", "(", "true", ")", ";", "Assert", ".", "assertEquals", "(", "\"", "IDP", "SignIn", "Response", "Form", "\"", ",", "idpPage2", ".", "getTitleText", "(", "))", ";", "/", "/", "2", ".", "Now", "instead", "of", "clicking", "on", "the", "form", ",", "send", "the", "form", "via", "alice", "'", "s", "WebClient", "instead", "/", "/", "Send", "with", "context", ".", "..", "WebRequest", "request", "=", "new", "WebRequest", "(", "new", "URL", "(", "rpURL", ")", ",", "HttpMethod", ".", "POST", ")", ";", "request", ".", "setRequestParameters", "(", "new", "ArrayList", "<", "NameValuePair", ">", "()", ");", "DomNodeList", "<", "DomElement", ">", "results", "=", "idpPage2", ".", "getElementsByTagName", "(", "\"", "input", "\"", ");", "for", "(", "DomElement", "result", ":", "results", ")", "{", "if", "(", "\"", "wresult", "\"", ".", "equals", "(", "result", ".", "getAttributeNS", "(", "null", ",", "\"", "name", "\"", "))", "|", "|", "\"", "wa", "\"", ".", "equals", "(", "result", ".", "getAttributeNS", "(", "null", ",", "\"", "name", "\"", "))", "|", "|", "\"", "wctx", "\"", ".", "equals", "(", "result", ".", "getAttributeNS", "(", "null", ",", "\"", "name", "\"", "))", ")", "{", "String", "value", "=", "result", ".", "getAttributeNS", "(", "null", ",", "\"", "value", "\"", ");", "request", ".", "getRequestParameters", "(", ").", "add", "(", "new", "NameValuePair", "(", "result", ".", "getAttributeNS", "(", "null", ",", "\"", "name", "\"", "),", "value", ")", ");", "}", "}", "WebClient", "webClient", "=", "new", "WebClient", "(", ");", "webClient", ".", "getOptions", "(", ").", "setUseInsecureSSL", "(", "true", ")", ";", "try", "{", "webClient", ".", "getPage", "(", "request", ")", ";", "Assert", ".", "fail", "(", "\"", "Failure", "expected", "on", "a", "CSRF", "attack", "\"", ");", "}", "catch", "(", "FailingHttpStatusCodeException", "ex", ")", "{", "/", "/", "expected", "}", "webClient", ".", "close", "(", ");", "webClient2", ".", "close", "(", ");", "}", "}", "@", "@", "-", "37", ",", "6", "+", "37", ",", "7", "@", "@", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "context", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "sch", "<", "sec", ":", "intercept", "-", "url", "pattern", "=", "\"/", "index", ".", "html", "\"", "access", "=", "\"", "permitAll", "\"", "/>", "<", "sec", ":", "intercept", "-", "url", "pattern", "=", "\"/", "FederationMetadata", "/", "**", "\"", "access", "=", "\"", "isAuthenticated", "(", ")\"", "/>", "<", "sec", ":", "intercept", "-", "url", "pattern", "=", "\"/", "secure", "/", "fedservlet", "\"", "access", "=", "\"", "isAuthenticated", "(", ")\"", "/>", "<", "sec", ":", "intercept", "-", "url", "pattern", "=", "\"/", "secure", "/", "test", ".", "html", "\"", "access", "=", "\"", "isAuthenticated", "(", ")\"", "/>", "<", "sec", ":", "intercept", "-", "url", "pattern", "=", "\"/", "secure", "/", "manager", "/", "**", "\"", "access", "=", "\"", "hasRole", "(", "'", "ROLE_MANAGER", "'", ")\"", "/>", "<", "sec", ":", "intercept", "-", "url", "pattern", "=", "\"/", "secure", "/", "admin", "/", "**", "\"", "access", "=", "\"", "hasRole", "(", "'", "ROLE_ADMIN", "'", ")\"", "/>", "<", "sec", ":", "intercept", "-", "url", "pattern", "=", "\"/", "secure", "/", "user", "/", "**", "\"", "access", "=", "\"", "hasAnyRole", "(", "'", "ROLE_USER", "'", ",'", "ROLE_ADMIN", "'", ",'", "ROLE_MANAGER", "'", ")\"", "/>"], "docstring_tokens": ["improper", "validation", "of", "user-supplied", "input"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "368", ",", "7", "+", "368", ",", "7", "@", "@", "void", "exit_thread", "(", "void", ")", "void", "flush_thread", "(", "void", ")", "{", "/", "*", "Called", "by", "fs", "/", "exec", ".", "c", "(", "flush_old_exec", ")", "to", "remove", "traces", "of", "a", "/", "*", "Called", "by", "fs", "/", "exec", ".", "c", "(", "setup_new_exec", ")", "to", "remove", "traces", "of", "a", "*", "previously", "running", "executable", ".", "*", "/", "#", "ifdef", "CONFIG_SH_FPU", "if", "(", "last_task_used_math", "=", "=", "current", ")", "{", "@", "@", "-", "308", ",", "15", "+", "308", ",", "17", "@", "@", "static", "int", "load_aout_binary", "(", "struct", "linux_binprm", "*", "bprm", ",", "struct", "pt_regs", "*", "regs", ")", "if", "(", "retval", ")", "return", "retval", ";", "regs", "-", ">", "cs", "=", "__USER32_CS", ";", "regs", "-", ">", "r8", "=", "regs", "-", ">", "r9", "=", "regs", "-", ">", "r10", "=", "regs", "-", ">", "r11", "=", "regs", "-", ">", "r12", "=", "regs", "-", ">", "r13", "=", "regs", "-", ">", "r14", "=", "regs", "-", ">", "r15", "=", "0", ";", "/", "*", "OK", ",", "This", "is", "the", "point", "of", "no", "return", "*", "/", "set_personality", "(", "PER_LINUX", ")", ";", "set_thread_flag", "(", "TIF_IA32", ")", ";", "clear_thread_flag", "(", "TIF_ABI_PENDING", ")", ";", "setup_new_exec", "(", "bprm", ")", ";", "regs", "-", ">", "cs", "=", "__USER32_CS", ";", "regs", "-", ">", "r8", "=", "regs", "-", ">", "r9", "=", "regs", "-", ">", "r10", "=", "regs", "-", ">", "r11", "=", "regs", "-", ">", "r12", "=", "regs", "-", ">", "r13", "=", "regs", "-", ">", "r14", "=", "regs", "-", ">", "r15", "=", "0", ";", "current", "-", ">", "mm", "-", ">", "end_code", "=", "ex", ".", "a_text", "+", "(", "current", "-", ">", "mm", "-", ">", "start_code", "=", "N_TXTADDR", "(", "ex", ")", ");", "current", "-", ">", "mm", "-", ">", "end_data", "=", "ex", ".", "a_data", "+", "@", "@", "-", "264", ",", "6", "+", "264", ",", "7", "@", "@", "static", "int", "load_aout_binary", "(", "struct", "linux_binprm", "*", "bprm", ",", "struct", "pt_regs", "*", "regs", ")", "#", "else", "set_personality", "(", "PER_LINUX", ")", ";", "#", "endif", "setup_new_exec", "(", "bprm", ")", ";", "current", "-", ">", "mm", "-", ">", "end_code", "=", "ex", ".", "a_text", "+", "(", "current", "-", ">", "mm", "-", ">", "start_code", "=", "N_TXTADDR", "(", "ex", ")", ");", "@", "@", "-", "662", ",", "27", "+", "662", ",", "6", "@", "@", "static", "int", "load_elf_binary", "(", "struct", "linux_binprm", "*", "bprm", ",", "struct", "pt_regs", "*", "regs", ")", "if", "(", "elf_interpreter", "[", "elf_ppnt", "-", ">", "p_filesz", "-", "1", "]", "!", "=", "'", "\\", "0", "'", ")", "goto", "out_free_interp", ";", "/", "*", "*", "The", "early", "SET_PERSONALITY", "here", "is", "so", "that", "the", "lookup", "*", "for", "the", "interpreter", "happens", "in", "the", "namespace", "of", "the", "*", "to", "-", "be", "-", "execed", "image", ".", "SET_PERSONALITY", "can", "select", "an", "*", "alternate", "root", ".", "*", "*", "However", ",", "SET_PERSONALITY", "is", "NOT", "allowed", "to", "switch", "*", "this", "task", "into", "the", "new", "images", "'", "s", "memory", "mapping", "*", "policy", "-", "that", "is", ",", "TASK_SIZE", "must", "still", "evaluate", "to", "*", "that", "which", "is", "appropriate", "to", "the", "execing", "application", ".", "*", "This", "is", "because", "exit_mmap", "(", ")", "needs", "to", "have", "TASK_SIZE", "*", "evaluate", "to", "the", "size", "of", "the", "old", "image", ".", "*", "*", "So", "if", "(", "say", ")", "a", "64", "-", "bit", "application", "is", "execing", "a", "32", "-", "bit", "*", "application", "it", "is", "the", "architecture", "'", "s", "responsibility", "*", "to", "defer", "changing", "the", "value", "of", "TASK_SIZE", "until", "the", "*", "switch", "really", "is", "going", "to", "happen", "-", "do", "this", "in", "*", "flush_thread", "(", ").", "-", "akpm", "*", "/", "SET_PERSONALITY", "(", "loc", "-", ">", "elf_ex", ")", ";", "interpreter", "=", "open_exec", "(", "elf_interpreter", ")", ";", "retval", "=", "PTR_ERR", "(", "interpreter", ")", ";", "if", "(", "IS_ERR", "(", "interpreter", ")", ")", "@", "@", "-", "730", ",", "9", "+", "709", ",", "6", "@", "@", "static", "int", "load_elf_binary", "(", "struct", "linux_binprm", "*", "bprm", ",", "struct", "pt_regs", "*", "regs", ")", "/", "*", "Verify", "the", "interpreter", "has", "a", "valid", "arch", "*", "/", "if", "(", "!", "elf_check_arch", "(", "&", "loc", "-", ">", "interp_elf_ex", ")", ")", "goto", "out_free_dentry", ";", "}", "else", "{", "/", "*", "Executables", "without", "an", "interpreter", "also", "need", "a", "personality", "*", "/", "SET_PERSONALITY", "(", "loc", "-", ">", "elf_ex", ")", ";", "}", "/", "*", "Flush", "all", "traces", "of", "the", "currently", "running", "executable", "*", "/", "@", "@", "-", "752", ",", "7", "+", "728", ",", "8", "@", "@", "static", "int", "load_elf_binary", "(", "struct", "linux_binprm", "*", "bprm", ",", "struct", "pt_regs", "*", "regs", ")", "if", "(", "!(", "current", "-", ">", "personality", "&", "ADDR_NO_RANDOMIZE", ")", "&", "&", "randomize_va_space", ")", "current", "-", ">", "flags", "|", "=", "PF_RANDOMIZE", ";", "arch_pick_mmap_layout", "(", "current", "-", ">", "mm", ")", ";", "setup_new_exec", "(", "bprm", ")", ";", "/", "*", "Do", "this", "so", "that", "we", "can", "load", "the", "interpreter", ",", "if", "need", "be", ".", "We", "will", "change", "some", "of", "these", "later", "*", "/", "@", "@", "-", "321", ",", "6", "+", "321", ",", "9", "@", "@", "static", "int", "load_elf_fdpic_binary", "(", "struct", "linux_binprm", "*", "bprm", ",", "set_personality", "(", "PER_LINUX_FDPIC", ")", ";", "if", "(", "elf_read_implies_exec", "(", "&", "exec_params", ".", "hdr", ",", "executable_stack", ")", ")", "current", "-", ">", "personality", "|", "=", "READ_IMPLIES_EXEC", ";", "setup_new_exec", "(", "bprm", ")", ";", "set_binfmt", "(", "&", "elf_fdpic_format", ")", ";", "current", "-", ">", "mm", "-", ">", "start_code", "=", "0", ";", "@", "@", "-", "519", ",", "6", "+", "519", ",", "7", "@", "@", "static", "int", "load_flat_file", "(", "struct", "linux_binprm", "*", "bprm", ",", "/", "*", "OK", ",", "This", "is", "the", "point", "of", "no", "return", "*", "/", "set_personality", "(", "PER_LINUX_32BIT", ")", ";", "setup_new_exec", "(", "bprm", ")", ";", "}", "/", "*", "@", "@", "-", "227", ",", "6", "+", "227", ",", "7", "@", "@", "load_som_binary", "(", "struct", "linux_binprm", "*", "bprm", ",", "struct", "pt_regs", "*", "regs", ")", "/", "*", "OK", ",", "This", "is", "the", "point", "of", "no", "return", "*", "/", "current", "-", ">", "flags", "&", "=", "~", "PF_FORKNOEXEC", ";", "current", "-", ">", "personality", "=", "PER_HPUX", ";", "setup_new_exec", "(", "bprm", ")", ";", "/", "*", "Set", "the", "task", "size", "for", "HP", "-", "UX", "processes", "such", "that", "*", "the", "gateway", "page", "is", "outside", "the", "address", "space", ".", "@", "@", "-", "941", ",", "9", "+", "941", ",", "7", "@", "@", "void", "set_task_comm", "(", "struct", "task_struct", "*", "tsk", ",", "char", "*", "buf", ")", "int", "flush_old_exec", "(", "struct", "linux_binprm", "*", "bprm", ")", "{", "char", "*", "name", ";", "int", "i", ",", "ch", ",", "retval", ";", "char", "tcomm", "[", "sizeof", "(", "current", "-", ">", "comm", ")", "];", "int", "retval", ";", "/", "*", "*", "Make", "sure", "we", "have", "a", "private", "signal", "table", "and", "that", "@", "@", "-", "963", ",", "6", "+", "961", ",", "20", "@", "@", "int", "flush_old_exec", "(", "struct", "linux_binprm", "*", "bprm", ")", "goto", "out", ";", "bprm", "-", ">", "mm", "=", "NULL", ";", "/", "*", "We", "'", "re", "using", "it", "now", "*", "/", "return", "0", ";", "out", ":", "return", "retval", ";", "}", "EXPORT_SYMBOL", "(", "flush_old_exec", ")", ";", "void", "setup_new_exec", "(", "struct", "linux_binprm", "*", "bprm", ")", "{", "int", "i", ",", "ch", ";", "char", "*", "name", ";", "char", "tcomm", "[", "sizeof", "(", "current", "-", ">", "comm", ")", "];", "arch_pick_mmap_layout", "(", "current", "-", ">", "mm", ")", ";", "/", "*", "This", "is", "the", "point", "of", "no", "return", "*", "/", "current", "-", ">", "sas_ss_sp", "=", "current", "-", ">", "sas_ss_size", "=", "0", ";", "@", "@", "-", "1019", ",", "14", "+", "1031", ",", "8", "@", "@", "int", "flush_old_exec", "(", "struct", "linux_binprm", "*", "bprm", ")", "flush_signal_handlers", "(", "current", ",", "0", ")", ";", "flush_old_files", "(", "current", "-", ">", "files", ")", ";", "return", "0", ";", "out", ":", "return", "retval", ";", "}", "EXPORT_SYMBOL", "(", "flush_old_exec", ")", ";", "EXPORT_SYMBOL", "(", "setup_new_exec", ")", ";", "/", "*", "*", "Prepare", "credentials", "and", "lock", "-", ">", "cred_guard_mutex", ".", "@", "@", "-", "109", ",", "6", "+", "109", ",", "7", "@", "@", "extern", "int", "prepare_binprm", "(", "struct", "linux_binprm", "*", ");", "extern", "int", "__must_check", "remove_arg_zero", "(", "struct", "linux_binprm", "*", ");", "extern", "int", "search_binary_handler", "(", "struct", "linux_binprm", "*", ",", "struct", "pt_regs", "*", ");", "extern", "int", "flush_old_exec", "(", "struct", "linux_binprm", "*", "bprm", ")", ";", "extern", "void", "setup_new_exec", "(", "struct", "linux_binprm", "*", "bprm", ")", ";", "extern", "int", "suid_dumpable", ";", "#", "define", "SUID_DUMP_DISABLE", "0", "/", "*", "No", "setuid", "dumping", "*", "/", "@", "@", "-", "1369", ",", "7", "+", "1369", ",", "7", "@", "@", "struct", "task_struct", "{", "char", "comm", "[", "TASK_COMM_LEN", "]", ";", "/", "*", "executable", "name", "excluding", "path", "-", "access", "with", "[", "gs", "]", "et_task_comm", "(", "which", "lock", "it", "with", "task_lock", "(", "))", "-", "initialized", "normally", "by", "flush_old_exec", "*", "/", "-", "initialized", "normally", "by", "setup_new_exec", "*", "/", "/", "*", "file", "system", "info", "*", "/", "int", "link_count", ",", "total_link_count", ";", "#", "ifdef", "CONFIG_SYSVIPC"], "docstring_tokens": ["does", "not", "ensure", "that", "the", "ELF", "interpreter", "is", "available", "before", "a", "call", "to", "the", "SET_PERSONALITY", "macro"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1583", ",", "7", "+", "1583", ",", "7", "@", "@", "const", "struct", "file_operations", "def_blk_fops", "=", "{", ".", "compat_ioctl", "=", "compat_blkdev_ioctl", ",", "#", "endif", ".", "splice_read", "=", "generic_file_splice_read", ",", ".", "splice_write", "=", "generic_file_splice_write", ",", ".", "splice_write", "=", "iter_file_splice_write", ",", "}", ";", "int", "ioctl_by_bdev", "(", "struct", "block_device", "*", "bdev", ",", "unsigned", "cmd", ",", "unsigned", "long", "arg", ")", "@", "@", "-", "77", ",", "7", "+", "77", ",", "7", "@", "@", "const", "struct", "file_operations", "exofs_file_operations", "=", "{", ".", "fsync", "=", "exofs_file_fsync", ",", ".", "flush", "=", "exofs_flush", ",", ".", "splice_read", "=", "generic_file_splice_read", ",", ".", "splice_write", "=", "generic_file_splice_write", ",", ".", "splice_write", "=", "iter_file_splice_write", ",", "}", ";", "const", "struct", "inode_operations", "exofs_file_inode_operations", "=", "{", "@", "@", "-", "75", ",", "7", "+", "75", ",", "7", "@", "@", "const", "struct", "file_operations", "ext2_file_operations", "=", "{", ".", "release", "=", "ext2_release_file", ",", ".", "fsync", "=", "ext2_fsync", ",", ".", "splice_read", "=", "generic_file_splice_read", ",", ".", "splice_write", "=", "generic_file_splice_write", ",", ".", "splice_write", "=", "iter_file_splice_write", ",", "}", ";", "#", "ifdef", "CONFIG_EXT2_FS_XIP", "@", "@", "-", "63", ",", "7", "+", "63", ",", "7", "@", "@", "const", "struct", "file_operations", "ext3_file_operations", "=", "{", ".", "release", "=", "ext3_release_file", ",", ".", "fsync", "=", "ext3_sync_file", ",", ".", "splice_read", "=", "generic_file_splice_read", ",", ".", "splice_write", "=", "generic_file_splice_write", ",", ".", "splice_write", "=", "iter_file_splice_write", ",", "}", ";", "const", "struct", "inode_operations", "ext3_file_inode_operations", "=", "{", "@", "@", "-", "599", ",", "7", "+", "599", ",", "7", "@", "@", "const", "struct", "file_operations", "ext4_file_operations", "=", "{", ".", "release", "=", "ext4_release_file", ",", ".", "fsync", "=", "ext4_sync_file", ",", ".", "splice_read", "=", "generic_file_splice_read", ",", ".", "splice_write", "=", "generic_file_splice_write", ",", ".", "splice_write", "=", "iter_file_splice_write", ",", ".", "fallocate", "=", "ext4_fallocate", ",", "}", ";", "@", "@", "-", "692", ",", "5", "+", "692", ",", "5", "@", "@", "const", "struct", "file_operations", "f2fs_file_operations", "=", "{", ".", "compat_ioctl", "=", "f2fs_compat_ioctl", ",", "#", "endif", ".", "splice_read", "=", "generic_file_splice_read", ",", ".", "splice_write", "=", "generic_file_splice_write", ",", ".", "splice_write", "=", "iter_file_splice_write", ",", "}", ";", "@", "@", "-", "1068", ",", "7", "+", "1068", ",", "7", "@", "@", "const", "struct", "file_operations", "gfs2_file_fops", "=", "{", ".", "lock", "=", "gfs2_lock", ",", ".", "flock", "=", "gfs2_flock", ",", ".", "splice_read", "=", "generic_file_splice_read", ",", ".", "splice_write", "=", "generic_file_splice_write", ",", ".", "splice_write", "=", "iter_file_splice_write", ",", ".", "setlease", "=", "gfs2_setlease", ",", ".", "fallocate", "=", "gfs2_fallocate", ",", "}", ";", "@", "@", "-", "1098", ",", "7", "+", "1098", ",", "7", "@", "@", "const", "struct", "file_operations", "gfs2_file_fops_nolock", "=", "{", ".", "release", "=", "gfs2_release", ",", ".", "fsync", "=", "gfs2_fsync", ",", ".", "splice_read", "=", "generic_file_splice_read", ",", ".", "splice_write", "=", "generic_file_splice_write", ",", ".", "splice_write", "=", "iter_file_splice_write", ",", ".", "setlease", "=", "generic_setlease", ",", ".", "fallocate", "=", "gfs2_fallocate", ",", "}", ";", "@", "@", "-", "157", ",", "7", "+", "157", ",", "7", "@", "@", "const", "struct", "file_operations", "jfs_file_operations", "=", "{", ".", "write_iter", "=", "generic_file_write_iter", ",", ".", "mmap", "=", "generic_file_mmap", ",", ".", "splice_read", "=", "generic_file_splice_read", ",", ".", "splice_write", "=", "generic_file_splice_write", ",", ".", "splice_write", "=", "iter_file_splice_write", ",", ".", "fsync", "=", "jfs_fsync", ",", ".", "release", "=", "jfs_release", ",", ".", "unlocked_ioctl", "=", "jfs_ioctl", ",", "@", "@", "-", "38", ",", "7", "+", "38", ",", "7", "@", "@", "const", "struct", "file_operations", "ramfs_file_operations", "=", "{", ".", "mmap", "=", "generic_file_mmap", ",", ".", "fsync", "=", "noop_fsync", ",", ".", "splice_read", "=", "generic_file_splice_read", ",", ".", "splice_write", "=", "generic_file_splice_write", ",", ".", "splice_write", "=", "iter_file_splice_write", ",", ".", "llseek", "=", "generic_file_llseek", ",", "}", ";", "@", "@", "-", "43", ",", "7", "+", "43", ",", "7", "@", "@", "const", "struct", "file_operations", "ramfs_file_operations", "=", "{", ".", "write_iter", "=", "generic_file_write_iter", ",", ".", "fsync", "=", "noop_fsync", ",", ".", "splice_read", "=", "generic_file_splice_read", ",", ".", "splice_write", "=", "generic_file_splice_write", ",", ".", "splice_write", "=", "iter_file_splice_write", ",", ".", "llseek", "=", "generic_file_llseek", ",", "}", ";", "@", "@", "-", "248", ",", "7", "+", "248", ",", "7", "@", "@", "const", "struct", "file_operations", "reiserfs_file_operations", "=", "{", ".", "read_iter", "=", "generic_file_read_iter", ",", ".", "write_iter", "=", "generic_file_write_iter", ",", ".", "splice_read", "=", "generic_file_splice_read", ",", ".", "splice_write", "=", "generic_file_splice_write", ",", ".", "splice_write", "=", "iter_file_splice_write", ",", ".", "llseek", "=", "generic_file_llseek", ",", "}", ";", "@", "@", "-", "32", ",", "6", "+", "32", ",", "7", "@", "@", "#", "include", "<", "linux", "/", "gfp", ".", "h", ">", "#", "include", "<", "linux", "/", "socket", ".", "h", ">", "#", "include", "<", "linux", "/", "compat", ".", "h", ">", "#", "include", "<", "linux", "/", "aio", ".", "h", ">", "#", "include", "\"", "internal", ".", "h", "\"", "/", "*", "@", "@", "-", "1052", ",", "6", "+", "1053", ",", "145", "@", "@", "generic_file_splice_write", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "struct", "file", "*", "out", ",", "EXPORT_SYMBOL", "(", "generic_file_splice_write", ")", ";", "/", "**", "*", "iter_file_splice_write", "-", "splice", "data", "from", "a", "pipe", "to", "a", "file", "*", "@", "pipe", ":", "pipe", "info", "*", "@", "out", ":", "file", "to", "write", "to", "*", "@", "ppos", ":", "position", "in", "@", "out", "*", "@", "len", ":", "number", "of", "bytes", "to", "splice", "*", "@", "flags", ":", "splice", "modifier", "flags", "*", "*", "Description", ":", "*", "Will", "either", "move", "or", "copy", "pages", "(", "determined", "by", "@", "flags", "options", ")", "from", "*", "the", "given", "pipe", "inode", "to", "the", "given", "file", ".", "*", "This", "one", "is", "-", ">", "write_iter", "-", "based", ".", "*", "*", "/", "ssize_t", "iter_file_splice_write", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "struct", "file", "*", "out", ",", "loff_t", "*", "ppos", ",", "size_t", "len", ",", "unsigned", "int", "flags", ")", "{", "struct", "splice_desc", "sd", "=", "{", ".", "total_len", "=", "len", ",", ".", "flags", "=", "flags", ",", ".", "pos", "=", "*", "ppos", ",", ".", "u", ".", "file", "=", "out", ",", "}", ";", "int", "nbufs", "=", "pipe", "-", ">", "buffers", ";", "struct", "bio_vec", "*", "array", "=", "kcalloc", "(", "nbufs", ",", "sizeof", "(", "struct", "bio_vec", ")", ",", "GFP_KERNEL", ")", ";", "ssize_t", "ret", ";", "if", "(", "unlikely", "(", "!", "array", ")", ")", "return", "-", "ENOMEM", ";", "pipe_lock", "(", "pipe", ")", ";", "splice_from_pipe_begin", "(", "&", "sd", ")", ";", "while", "(", "sd", ".", "total_len", ")", "{", "struct", "iov_iter", "from", ";", "struct", "kiocb", "kiocb", ";", "size_t", "left", ";", "int", "n", ",", "idx", ";", "ret", "=", "splice_from_pipe_next", "(", "pipe", ",", "&", "sd", ")", ";", "if", "(", "ret", "<", "=", "0", ")", "break", ";", "if", "(", "unlikely", "(", "nbufs", "<", "pipe", "-", ">", "buffers", ")", ")", "{", "kfree", "(", "array", ")", ";", "nbufs", "=", "pipe", "-", ">", "buffers", ";", "array", "=", "kcalloc", "(", "nbufs", ",", "sizeof", "(", "struct", "bio_vec", ")", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "array", ")", "{", "ret", "=", "-", "ENOMEM", ";", "break", ";", "}", "}", "/", "*", "build", "the", "vector", "*", "/", "left", "=", "sd", ".", "total_len", ";", "for", "(", "n", "=", "0", ",", "idx", "=", "pipe", "-", ">", "curbuf", ";", "left", "&", "&", "n", "<", "pipe", "-", ">", "nrbufs", ";", "n", "+", "+,", "idx", "+", "+)", "{", "struct", "pipe_buffer", "*", "buf", "=", "pipe", "-", ">", "bufs", "+", "idx", ";", "size_t", "this_len", "=", "buf", "-", ">", "len", ";", "if", "(", "this_len", ">", "left", ")", "this_len", "=", "left", ";", "if", "(", "idx", "=", "=", "pipe", "-", ">", "buffers", "-", "1", ")", "idx", "=", "-", "1", ";", "ret", "=", "buf", "-", ">", "ops", "-", ">", "confirm", "(", "pipe", ",", "buf", ")", ";", "if", "(", "unlikely", "(", "ret", ")", ")", "{", "if", "(", "ret", "=", "=", "-", "ENODATA", ")", "ret", "=", "0", ";", "goto", "done", ";", "}", "array", "[", "n", "]", ".", "bv_page", "=", "buf", "-", ">", "page", ";", "array", "[", "n", "]", ".", "bv_len", "=", "this_len", ";", "array", "[", "n", "]", ".", "bv_offset", "=", "buf", "-", ">", "offset", ";", "left", "-", "=", "this_len", ";", "}", "/", "*", ".", "..", "iov_iter", "*", "/", "from", ".", "type", "=", "ITER_BVEC", "|", "WRITE", ";", "from", ".", "bvec", "=", "array", ";", "from", ".", "nr_segs", "=", "n", ";", "from", ".", "count", "=", "sd", ".", "total_len", "-", "left", ";", "from", ".", "iov_offset", "=", "0", ";", "/", "*", ".", "..", "and", "iocb", "*", "/", "init_sync_kiocb", "(", "&", "kiocb", ",", "out", ")", ";", "kiocb", ".", "ki_pos", "=", "sd", ".", "pos", ";", "kiocb", ".", "ki_nbytes", "=", "sd", ".", "total_len", "-", "left", ";", "/", "*", "now", ",", "send", "it", "*", "/", "ret", "=", "out", "-", ">", "f_op", "-", ">", "write_iter", "(", "&", "kiocb", ",", "&", "from", ")", ";", "if", "(", "-", "EIOCBQUEUED", "=", "=", "ret", ")", "ret", "=", "wait_on_sync_kiocb", "(", "&", "kiocb", ")", ";", "if", "(", "ret", "<", "=", "0", ")", "break", ";", "sd", ".", "num_spliced", "+", "=", "ret", ";", "sd", ".", "total_len", "-", "=", "ret", ";", "*", "ppos", "=", "sd", ".", "pos", "=", "kiocb", ".", "ki_pos", ";", "/", "*", "dismiss", "the", "fully", "eaten", "buffers", ",", "adjust", "the", "partial", "one", "*", "/", "while", "(", "ret", ")", "{", "struct", "pipe_buffer", "*", "buf", "=", "pipe", "-", ">", "bufs", "+", "pipe", "-", ">", "curbuf", ";", "if", "(", "ret", ">", "=", "buf", "-", ">", "len", ")", "{", "const", "struct", "pipe_buf_operations", "*", "ops", "=", "buf", "-", ">", "ops", ";", "ret", "-", "=", "buf", "-", ">", "len", ";", "buf", "-", ">", "len", "=", "0", ";", "buf", "-", ">", "ops", "=", "NULL", ";", "ops", "-", ">", "release", "(", "pipe", ",", "buf", ")", ";", "pipe", "-", ">", "curbuf", "=", "(", "pipe", "-", ">", "curbuf", "+", "1", ")", "&", "(", "pipe", "-", ">", "buffers", "-", "1", ")", ";", "pipe", "-", ">", "nrbufs", "-", "-;", "if", "(", "pipe", "-", ">", "files", ")", "sd", ".", "need_wakeup", "=", "true", ";", "}", "else", "{", "buf", "-", ">", "offset", "+", "=", "ret", ";", "buf", "-", ">", "len", "-", "=", "ret", ";", "ret", "=", "0", ";", "}", "}", "}", "done", ":", "kfree", "(", "array", ")", ";", "splice_from_pipe_end", "(", "pipe", ",", "&", "sd", ")", ";", "pipe_unlock", "(", "pipe", ")", ";", "if", "(", "sd", ".", "num_spliced", ")", "ret", "=", "sd", ".", "num_spliced", ";", "return", "ret", ";", "}", "EXPORT_SYMBOL", "(", "iter_file_splice_write", ")", ";", "static", "int", "write_pipe_buf", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "struct", "pipe_buffer", "*", "buf", ",", "struct", "splice_desc", "*", "sd", ")", "{", "@", "@", "-", "1585", ",", "7", "+", "1585", ",", "7", "@", "@", "const", "struct", "file_operations", "ubifs_file_operations", "=", "{", ".", "fsync", "=", "ubifs_fsync", ",", ".", "unlocked_ioctl", "=", "ubifs_ioctl", ",", ".", "splice_read", "=", "generic_file_splice_read", ",", ".", "splice_write", "=", "generic_file_splice_write", ",", ".", "splice_write", "=", "iter_file_splice_write", ",", "#", "ifdef", "CONFIG_COMPAT", ".", "compat_ioctl", "=", "ubifs_compat_ioctl", ",", "#", "endif", "@", "@", "-", "342", ",", "47", "+", "342", ",", "6", "@", "@", "xfs_file_splice_read", "(", "return", "ret", ";", "}", "/", "*", "*", "xfs_file_splice_write", "(", ")", "does", "not", "use", "xfs_rw_ilock", "(", ")", "because", "*", "generic_file_splice_write", "(", ")", "takes", "the", "i_mutex", "itself", ".", "This", ",", "in", "theory", ",", "*", "couuld", "cause", "lock", "inversions", "between", "the", "aio_write", "path", "and", "the", "splice", "path", "*", "if", "someone", "is", "doing", "concurrent", "splice", "(", "2", ")", "based", "writes", "and", "write", "(", "2", ")", "based", "*", "writes", "to", "the", "same", "inode", ".", "The", "only", "real", "way", "to", "fix", "this", "is", "to", "re", "-", "implement", "*", "the", "generic", "code", "here", "with", "correct", "locking", "orders", ".", "*", "/", "STATIC", "ssize_t", "xfs_file_splice_write", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "struct", "file", "*", "outfilp", ",", "loff_t", "*", "ppos", ",", "size_t", "count", ",", "unsigned", "int", "flags", ")", "{", "struct", "inode", "*", "inode", "=", "outfilp", "-", ">", "f_mapping", "-", ">", "host", ";", "struct", "xfs_inode", "*", "ip", "=", "XFS_I", "(", "inode", ")", ";", "int", "ioflags", "=", "0", ";", "ssize_t", "ret", ";", "XFS_STATS_INC", "(", "xs_write_calls", ")", ";", "if", "(", "outfilp", "-", ">", "f_mode", "&", "FMODE_NOCMTIME", ")", "ioflags", "|", "=", "IO_INVIS", ";", "if", "(", "XFS_FORCED_SHUTDOWN", "(", "ip", "-", ">", "i_mount", ")", ")", "return", "-", "EIO", ";", "xfs_ilock", "(", "ip", ",", "XFS_IOLOCK_EXCL", ")", ";", "trace_xfs_file_splice_write", "(", "ip", ",", "count", ",", "*", "ppos", ",", "ioflags", ")", ";", "ret", "=", "generic_file_splice_write", "(", "pipe", ",", "outfilp", ",", "ppos", ",", "count", ",", "flags", ")", ";", "if", "(", "ret", ">", "0", ")", "XFS_STATS_ADD", "(", "xs_write_bytes", ",", "ret", ")", ";", "xfs_iunlock", "(", "ip", ",", "XFS_IOLOCK_EXCL", ")", ";", "return", "ret", ";", "}", "/", "*", "*", "This", "routine", "is", "called", "to", "handle", "zeroing", "any", "space", "in", "the", "last", "block", "of", "the", "*", "file", "that", "is", "beyond", "the", "EOF", ".", "We", "do", "this", "since", "the", "size", "is", "being", "increased", "@", "@", "-", "1442", ",", "7", "+", "1401", ",", "7", "@", "@", "const", "struct", "file_operations", "xfs_file_operations", "=", "{", ".", "read_iter", "=", "xfs_file_read_iter", ",", ".", "write_iter", "=", "xfs_file_write_iter", ",", ".", "splice_read", "=", "xfs_file_splice_read", ",", ".", "splice_write", "=", "xfs_file_splice_write", ",", ".", "splice_write", "=", "iter_file_splice_write", ",", ".", "unlocked_ioctl", "=", "xfs_file_ioctl", ",", "#", "ifdef", "CONFIG_COMPAT", ".", "compat_ioctl", "=", "xfs_file_compat_ioctl", ",", "@", "@", "-", "1060", ",", "7", "+", "1060", ",", "6", "@", "@", "DEFINE_RW_EVENT", "(", "xfs_file_read", ")", ";", "DEFINE_RW_EVENT", "(", "xfs_file_buffered_write", ")", ";", "DEFINE_RW_EVENT", "(", "xfs_file_direct_write", ")", ";", "DEFINE_RW_EVENT", "(", "xfs_file_splice_read", ")", ";", "DEFINE_RW_EVENT", "(", "xfs_file_splice_write", ")", ";", "DECLARE_EVENT_CLASS", "(", "xfs_page_class", ",", "TP_PROTO", "(", "struct", "inode", "*", "inode", ",", "struct", "page", "*", "page", ",", "unsigned", "long", "off", ",", "@", "@", "-", "2434", ",", "6", "+", "2434", ",", "8", "@", "@", "extern", "ssize_t", "default_file_splice_read", "(", "struct", "file", "*", ",", "loff_t", "*", ",", "struct", "pipe_inode_info", "*", ",", "size_t", ",", "unsigned", "int", ")", ";", "extern", "ssize_t", "generic_file_splice_write", "(", "struct", "pipe_inode_info", "*", ",", "struct", "file", "*", ",", "loff_t", "*", ",", "size_t", ",", "unsigned", "int", ")", ";", "extern", "ssize_t", "iter_file_splice_write", "(", "struct", "pipe_inode_info", "*", ",", "struct", "file", "*", ",", "loff_t", "*", ",", "size_t", ",", "unsigned", "int", ")", ";", "extern", "ssize_t", "generic_splice_sendpage", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "struct", "file", "*", "out", ",", "loff_t", "*", ",", "size_t", "len", ",", "unsigned", "int", "flags", ")", ";"], "docstring_tokens": ["does", "not", "enforce", "a", "restriction", "on", "the", "maximum", "size", "of", "a", "single", "file"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "15", ",", "6", "+", "15", ",", "7", "@", "@", "package", "org", ".", "apache", ".", "geode", ".", "experimental", ".", "driver", ";", "import", "static", "org", ".", "apache", ".", "geode", ".", "internal", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "assertj", ".", "core", ".", "api", ".", "Assertions", ".", "assertThatThrownBy", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "Properties", ";", "@", "@", "-", "39", ",", "7", "+", "40", ",", "7", "@", "@", "@", "Rule", "public", "RestoreSystemProperties", "restoreSystemProperties", "=", "new", "RestoreSystemProperties", "(", ");", "private", "static", "final", "String", "TEST_USERNAME", "=", "\"", "cluster", "\"", ";", "private", "static", "final", "String", "TEST_USERNAME", "=", "\"", "\";", "private", "static", "final", "String", "TEST_PASSWORD", "=", "TEST_USERNAME", ";", "private", "Locator", "locator", ";", "private", "Cache", "cache", ";", "@", "@", "-", "89", ",", "4", "+", "90", ",", "16", "@", "@", "public", "void", "driverCanConnectWhenThereAreServers", "(", ")", "throws", "Exception", "{", ".", "setPassword", "(", "TEST_PASSWORD", ")", ".", "create", "(", ");", "assertTrue", "(", "driver", ".", "isConnected", "(", "))", ";", "}", "@", "Test", "public", "void", "driverWithBadPasswordIsRejected", "(", ")", "throws", "Exception", "{", "CacheServer", "server", "=", "cache", ".", "addCacheServer", "(", ");", "server", ".", "setPort", "(", "0", ")", ";", "server", ".", "start", "(", ");", "DriverFactory", "factory", "=", "new", "DriverFactory", "(", ").", "addLocator", "(", "\"", "localhost", "\"", ",", "locatorPort", ")", ".", "setUsername", "(", "TEST_USERNAME", ")", ".", "setPassword", "(", "\"", "my", "my", "my", "\"", ");", "assertThatThrownBy", "(", "()", "-", ">", "factory", ".", "create", "(", "))", ".", "isInstanceOf", "(", "IOException", ".", "class", ")", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "113", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "*", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "*", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "*", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "*", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "*", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "*", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "geode", ".", "experimental", ".", "driver", ";", "import", "static", "org", ".", "assertj", ".", "core", ".", "api", ".", "Assertions", ".", "assertThat", ";", "import", "static", "org", ".", "assertj", ".", "core", ".", "api", ".", "Assertions", ".", "assertThatExceptionOfType", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Properties", ";", "import", "org", ".", "assertj", ".", "core", ".", "api", ".", "ThrowableAssert", ";", "import", "org", ".", "junit", ".", "After", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "experimental", ".", "categories", ".", "Category", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "Cache", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "CacheFactory", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "RegionAttributes", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "RegionShortcut", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "server", ".", "CacheServer", ";", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "ConfigurationProperties", ";", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "Locator", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "GemFireCacheImpl", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalRegionArguments", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "LocalRegion", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "SimpleTestSecurityManager", ";", "import", "org", ".", "apache", ".", "geode", ".", "test", ".", "junit", ".", "categories", ".", "ClientServerTest", ";", "@", "Category", "(", "{", "ClientServerTest", ".", "class", "}", ")", "public", "class", "AuthorizationTest", "{", "private", "static", "final", "String", "TEST_USERNAME", "=", "\"", "\";", "private", "static", "final", "String", "TEST_PASSWORD", "=", "TEST_USERNAME", ";", "private", "Locator", "locator", ";", "private", "Cache", "cache", ";", "private", "Driver", "driver", ";", "private", "int", "locatorPort", ";", "@", "Before", "public", "void", "createServer", "(", ")", "throws", "Exception", "{", "System", ".", "setProperty", "(", "\"", "geode", ".", "feature", "-", "protobuf", "-", "protocol", "\"", ",", "\"", "true", "\"", ");", "/", "/", "Create", "a", "cache", "CacheFactory", "cf", "=", "new", "CacheFactory", "(", ");", "cf", ".", "set", "(", "ConfigurationProperties", ".", "MCAST_PORT", ",", "\"", "0", "\"", ");", "cf", ".", "setSecurityManager", "(", "new", "SimpleTestSecurityManager", "(", "))", ";", "cache", "=", "cf", ".", "create", "(", ");", "/", "/", "Start", "a", "locator", "locator", "=", "Locator", ".", "startLocatorAndDS", "(", "0", ",", "null", ",", "new", "Properties", "(", "))", ";", "locatorPort", "=", "locator", ".", "getPort", "(", ");", "/", "/", "do", "not", "start", "a", "cache", "server", "}", "@", "After", "public", "void", "cleanup", "(", ")", "{", "locator", ".", "stop", "(", ");", "cache", ".", "close", "(", ");", "}", "@", "Test", "public", "void", "performOperationsOnInternalRegion", "(", ")", "throws", "Exception", "{", "/", "/", "we", "need", "to", "use", "internal", "APIs", "to", "create", "an", "\"", "internal", "\"", "region", "GemFireCacheImpl", "serverCache", "=", "(", "GemFireCacheImpl", ")", "cache", ";", "InternalRegionArguments", "internalRegionArguments", "=", "new", "InternalRegionArguments", "(", ");", "internalRegionArguments", ".", "setIsUsedForPartitionedRegionAdmin", "(", "true", ")", ";", "RegionAttributes", "<", "String", ",", "String", ">", "attributes", "=", "serverCache", ".", "getRegionAttributes", "(", "RegionShortcut", ".", "REPLICATE", ".", "toString", "(", "))", ";", "LocalRegion", "serverRegion", "=", "(", "LocalRegion", ")", "serverCache", ".", "createVMRegion", "(", "\"", "internalRegion", "\"", ",", "attributes", ",", "internalRegionArguments", ")", ";", "assertThat", "(", "serverRegion", ".", "isInternalRegion", "(", "))", ".", "isTrue", "(", ");", "CacheServer", "server", "=", "cache", ".", "addCacheServer", "(", ");", "server", ".", "setPort", "(", "0", ")", ";", "server", ".", "start", "(", ");", "Driver", "driver", "=", "new", "DriverFactory", "(", ").", "addLocator", "(", "\"", "localhost", "\"", ",", "locatorPort", ")", ".", "setUsername", "(", "TEST_USERNAME", ")", ".", "setPassword", "(", "TEST_PASSWORD", ")", ".", "create", "(", ");", "Region", "region", "=", "driver", ".", "getRegion", "(", "\"", "internalRegion", "\"", ");", "assertThat", "(", "region", ")", ".", "isNotNull", "(", ");", "assertFailure", "(", "()", "-", ">", "region", ".", "clear", "(", "))", ";", "assertFailure", "(", "()", "-", ">", "region", ".", "get", "(", "\"", "some", "key", "\"", "))", ";", "assertFailure", "(", "()", "-", ">", "region", ".", "getAll", "(", "Collections", ".", "singleton", "(", "\"", "some", "key", "\"", "))", ");", "assertFailure", "(", "()", "-", ">", "region", ".", "keySet", "(", "))", ";", "assertFailure", "(", "()", "-", ">", "region", ".", "put", "(", "\"", "some", "key", "\"", ",", "\"", "some", "value", "\"", "))", ";", "assertFailure", "(", "()", "-", ">", "region", ".", "putAll", "(", "Collections", ".", "singletonMap", "(", "\"", "some", "key", "\"", ",", "\"", "some", "value", "\"", "))", ");", "assertFailure", "(", "()", "-", ">", "region", ".", "putIfAbsent", "(", "\"", "some", "key", "\"", ",", "\"", "some", "value", "\"", "))", ";", "assertFailure", "(", "()", "-", ">", "region", ".", "remove", "(", "\"", "some", "key", "\"", "))", ";", "assertFailure", "(", "()", "-", ">", "region", ".", "size", "(", "))", ";", "}", "private", "void", "assertFailure", "(", "final", "ThrowableAssert", ".", "ThrowingCallable", "callable", ")", "{", "assertThatExceptionOfType", "(", "IOException", ".", "class", ")", ".", "isThrownBy", "(", "callable", ")", ".", "withMessageContaining", "(", "\"", "Not", "authorized", "\"", ");", "}", "}", "@", "@", "-", "112", ",", "7", "+", "112", ",", "7", "@", "@", "public", "Object", "authenticate", "(", "Properties", "credentials", ")", "throws", "AuthenticationFailedEx", "@", "Override", "public", "boolean", "authorize", "(", "Object", "principal", ",", "ResourcePermission", "permission", ")", "{", "return", "principal", "=", "=", "authorizedPrincipal", ";", "return", "principal", ".", "equals", "(", "authorizedPrincipal", ")", ";", "}", "}", "@", "@", "-", "100", ",", "7", "+", "100", ",", "7", "@", "@", "public", "Object", "authenticate", "(", "Properties", "credentials", ")", "throws", "AuthenticationFailedEx", "@", "Override", "public", "boolean", "authorize", "(", "Object", "principal", ",", "ResourcePermission", "permission", ")", "{", "/", "/", "Only", "allow", "data", "operations", "and", "only", "from", "the", "expected", "principal", "if", "(", "principal", "!", "=", "securityPrincipal", "if", "(", "!", "principal", ".", "equals", "(", "securityPrincipal", ")", "|", "|", "permission", ".", "getResource", "(", ")", "!", "=", "ResourcePermission", ".", "Resource", ".", "DATA", ")", "{", "return", "false", ";", "}", "@", "@", "-", "41", ",", "10", "+", "41", ",", "10", "@", "@", "public", "ServerMessageExecutionContext", "(", "InternalCache", "cache", ",", "ClientStatistics", "statistics", ",", "SecurityService", "securityService", ")", "{", "super", "(", "statistics", ",", "securityService", ")", ";", "this", ".", "cache", "=", "cache", ";", "this", ".", "cache", "=", "cache", ".", "getCacheForProcessingClientRequests", "(", ");", "Security", "security", "=", "securityService", ".", "isIntegratedSecurity", "(", ")", "?", "new", "NotLoggedInSecurity", "(", ")", ":", "new", "NoSecurity", "(", ");", "this", ".", "secureCache", "=", "new", "SecureCacheImpl", "(", "cache", ",", "security", ")", ";", "this", ".", "secureCache", "=", "new", "SecureCacheImpl", "(", "this", ".", "cache", ",", "security", ")", ";", "}", "@", "Override", "@", "@", "-", "33", ",", "7", "+", "33", ",", "7", "@", "@", "import", "org", ".", "junit", ".", "experimental", ".", "categories", ".", "Category", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "IncompatibleVersionException", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCache", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCacheForClientAccess", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "client", ".", "protocol", ".", "ClientProtocolProcessor", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "tier", ".", "CachedRegionHelper", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "tier", ".", "CommunicationMode", ";", "@", "@", "-", "87", ",", "7", "+", "87", ",", "8", "@", "@", "private", "ProtobufServerConnection", "getServerConnection", "(", "Socket", "socketMock", ",", "when", "(", "socketMock", ".", "getRemoteSocketAddress", "(", "))", ".", "thenReturn", "(", "inetSocketAddressStub", ")", ";", "when", "(", "socketMock", ".", "getInetAddress", "(", "))", ".", "thenReturn", "(", "inetAddressStub", ")", ";", "InternalCache", "cache", "=", "mock", "(", "InternalCache", ".", "class", ")", ";", "InternalCacheForClientAccess", "cache", "=", "mock", "(", "InternalCacheForClientAccess", ".", "class", ")", ";", "when", "(", "cache", ".", "getCacheForProcessingClientRequests", "(", "))", ".", "thenReturn", "(", "cache", ")", ";", "CachedRegionHelper", "cachedRegionHelper", "=", "mock", "(", "CachedRegionHelper", ".", "class", ")", ";", "when", "(", "cachedRegionHelper", ".", "getCache", "(", "))", ".", "thenReturn", "(", "cache", ")", ";", "return", "new", "ProtobufServerConnection", "(", "socketMock", ",", "cache", ",", "cachedRegionHelper", ",", "@", "@", "-", "35", ",", "7", "+", "35", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "IncompatibleVersionException", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "Assert", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCache", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCacheForClientAccess", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "client", ".", "protocol", ".", "ClientProtocolProcessor", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "tier", ".", "CachedRegionHelper", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "tier", ".", "CommunicationMode", ";", "@", "@", "-", "126", ",", "7", "+", "126", ",", "8", "@", "@", "private", "ProtobufServerConnection", "getServerConnection", "(", "Socket", "socketMock", ",", "when", "(", "socketMock", ".", "getRemoteSocketAddress", "(", "))", ".", "thenReturn", "(", "inetSocketAddressStub", ")", ";", "when", "(", "socketMock", ".", "getInetAddress", "(", "))", ".", "thenReturn", "(", "inetAddressStub", ")", ";", "InternalCache", "cache", "=", "mock", "(", "InternalCache", ".", "class", ")", ";", "InternalCacheForClientAccess", "cache", "=", "mock", "(", "InternalCacheForClientAccess", ".", "class", ")", ";", "when", "(", "cache", ".", "getCacheForProcessingClientRequests", "(", "))", ".", "thenReturn", "(", "cache", ")", ";", "CachedRegionHelper", "cachedRegionHelper", "=", "mock", "(", "CachedRegionHelper", ".", "class", ")", ";", "when", "(", "cachedRegionHelper", ".", "getCache", "(", "))", ".", "thenReturn", "(", "cache", ")", ";", "return", "new", "ProtobufServerConnection", "(", "socketMock", ",", "cache", ",", "cachedRegionHelper", ",", "@", "@", "-", "15", ",", "6", "+", "15", ",", "7", "@", "@", "package", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "import", "java", ".", "io", ".", "ByteArrayInputStream", ";", "import", "java", ".", "io", ".", "ByteArrayOutputStream", ";", "@", "@", "-", "25", ",", "7", "+", "26", ",", "7", "@", "@", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "experimental", ".", "categories", ".", "Category", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCache", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCacheForClientAccess", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "TestExecutionContext", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "v1", ".", "ProtobufStreamProcessor", ";", "import", "org", ".", "apache", ".", "geode", ".", "test", ".", "junit", ".", "categories", ".", "ClientServerTest", ";", "@", "@", "-", "38", ",", "7", "+", "39", ",", "8", "@", "@", "public", "void", "receiveMessage", "(", ")", "throws", "Exception", "{", "OutputStream", "outputStream", "=", "new", "ByteArrayOutputStream", "(", "2", ")", ";", "ProtobufStreamProcessor", "protobufStreamProcessor", "=", "new", "ProtobufStreamProcessor", "(", ");", "InternalCache", "mockInternalCache", "=", "mock", "(", "InternalCache", ".", "class", ")", ";", "InternalCacheForClientAccess", "mockInternalCache", "=", "mock", "(", "InternalCacheForClientAccess", ".", "class", ")", ";", "when", "(", "mockInternalCache", ".", "getCacheForProcessingClientRequests", "(", "))", ".", "thenReturn", "(", "mockInternalCache", ")", ";", "protobufStreamProcessor", ".", "receiveMessage", "(", "inputStream", ",", "outputStream", ",", "TestExecutionContext", ".", "getNoAuthCacheExecutionContext", "(", "mockInternalCache", ")", ");", "}", "@", "@", "-", "24", ",", "6", "+", "24", ",", "7", "@", "@", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "mockito", ".", "ArgumentMatchers", ".", "any", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doNothing", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doReturn", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doThrow", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "verify", ";", "@", "@", "-", "53", ",", "6", "+", "54", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "query", ".", "internal", ".", "types", ".", "ObjectTypeImpl", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "query", ".", "internal", ".", "types", ".", "StructTypeImpl", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCache", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCacheForClientAccess", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "NotAuthorizedException", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "ResourcePermission", ";", "import", "org", ".", "apache", ".", "geode", ".", "test", ".", "junit", ".", "categories", ".", "ClientServerTest", ";", "@", "@", "-", "68", ",", "7", "+", "70", ",", "8", "@", "@", "@", "Before", "public", "void", "setUp", "(", ")", "{", "cache", "=", "mock", "(", "InternalCache", ".", "class", ")", ";", "cache", "=", "mock", "(", "InternalCacheForClientAccess", ".", "class", ")", ";", "doReturn", "(", "cache", ")", ".", "when", "(", "cache", ")", ".", "getCacheForProcessingClientRequests", "(", ");", "region", "=", "mock", "(", "Region", ".", "class", ")", ";", "when", "(", "cache", ".", "getRegion", "(", "REGION", ")", ").", "thenReturn", "(", "region", ")", ";", "security", "=", "mock", "(", "Security", ".", "class", ")", ";", "@", "@", "-", "80", ",", "7", "+", "83", ",", "7", "@", "@", "public", "void", "setUp", "(", ")", "{", "}", "@", "Test", "public", "void", "getAllSuccesses", "(", ")", "throws", "Exception", "{", "public", "void", "getAllSuccesses", "(", ")", "{", "authorize", "(", "DATA", ",", "READ", ",", "REGION", ",", "\"", "a", "\"", ");", "authorize", "(", "DATA", ",", "READ", ",", "REGION", ",", "\"", "b", "\"", ");", "Map", "<", "Object", ",", "Object", ">", "okValues", "=", "new", "HashMap", "<", ">(", ");", "@", "@", "-", "97", ",", "7", "+", "100", ",", "7", "@", "@", "public", "void", "getAllSuccesses", "(", ")", "throws", "Exception", "{", "}", "@", "Test", "public", "void", "getAllWithRegionLevelAuthorizationSucceeds", "(", ")", "throws", "Exception", "{", "public", "void", "getAllWithRegionLevelAuthorizationSucceeds", "(", ")", "{", "authorize", "(", "DATA", ",", "READ", ",", "REGION", ",", "ALL", ")", ";", "Map", "<", "Object", ",", "Object", ">", "okValues", "=", "new", "HashMap", "<", ">(", ");", "Map", "<", "Object", ",", "Exception", ">", "exceptionValues", "=", "new", "HashMap", "<", ">(", ");", "@", "@", "-", "113", ",", "7", "+", "116", ",", "7", "@", "@", "public", "void", "getAllWithRegionLevelAuthorizationSucceeds", "(", ")", "throws", "Exception", "{", "}", "@", "Test", "public", "void", "getAllWithFailure", "(", ")", "throws", "Exception", "{", "public", "void", "getAllWithFailure", "(", ")", "{", "authorize", "(", "DATA", ",", "READ", ",", "REGION", ",", "\"", "b", "\"", ");", "Map", "<", "Object", ",", "Object", ">", "okValues", "=", "new", "HashMap", "<", ">(", ");", "Map", "<", "Object", ",", "Exception", ">", "exceptionValues", "=", "new", "HashMap", "<", ">(", ");", "@", "@", "-", "131", ",", "7", "+", "134", ",", "7", "@", "@", "public", "void", "getAllWithFailure", "(", ")", "throws", "Exception", "{", "}", "@", "Test", "public", "void", "getAllIsPostProcessed", "(", ")", "throws", "Exception", "{", "public", "void", "getAllIsPostProcessed", "(", ")", "{", "authorize", "(", "DATA", ",", "READ", ",", "REGION", ",", "\"", "a", "\"", ");", "authorize", "(", "DATA", ",", "READ", ",", "REGION", ",", "\"", "b", "\"", ");", "when", "(", "security", ".", "postProcess", "(", "any", "(", "),", "any", "(", "),", "any", "(", "))", ").", "thenReturn", "(", "\"", "spam", "\"", ");", "@", "@", "-", "154", ",", "41", "+", "157", ",", "41", "@", "@", "private", "void", "authorize", "(", "ResourcePermission", ".", "Resource", "resource", ",", "}", "@", "Test", "public", "void", "get", "(", ")", "throws", "Exception", "{", "public", "void", "get", "(", ")", "{", "authorize", "(", "DATA", ",", "READ", ",", "REGION", ",", "\"", "a", "\"", ");", "when", "(", "region", ".", "get", "(", "\"", "a", "\"", "))", ".", "thenReturn", "(", "\"", "value", "\"", ");", "assertEquals", "(", "\"", "value", "\"", ",", "authorizingCache", ".", "get", "(", "REGION", ",", "\"", "a", "\"", "))", ";", "}", "@", "Test", "public", "void", "getWithFailure", "(", ")", "throws", "Exception", "{", "public", "void", "getWithFailure", "(", ")", "{", "assertThatThrownBy", "(", "()", "-", ">", "authorizingCache", ".", "get", "(", "REGION", ",", "\"", "a", "\"", "))", ".", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "getIsPostProcessed", "(", ")", "throws", "Exception", "{", "public", "void", "getIsPostProcessed", "(", ")", "{", "authorize", "(", "DATA", ",", "READ", ",", "REGION", ",", "\"", "a", "\"", ");", "when", "(", "security", ".", "postProcess", "(", "REGION", ",", "\"", "a", "\"", ",", "\"", "value", "\"", "))", ".", "thenReturn", "(", "\"", "spam", "\"", ");", "when", "(", "region", ".", "get", "(", "\"", "a", "\"", "))", ".", "thenReturn", "(", "\"", "value", "\"", ");", "assertEquals", "(", "\"", "spam", "\"", ",", "authorizingCache", ".", "get", "(", "REGION", ",", "\"", "a", "\"", "))", ";", "}", "@", "Test", "public", "void", "put", "(", ")", "throws", "Exception", "{", "public", "void", "put", "(", ")", "{", "authorize", "(", "DATA", ",", "WRITE", ",", "REGION", ",", "\"", "a", "\"", ");", "authorizingCache", ".", "put", "(", "REGION", ",", "\"", "a", "\"", ",", "\"", "value", "\"", ");", "verify", "(", "region", ")", ".", "put", "(", "\"", "a", "\"", ",", "\"", "value", "\"", ");", "}", "@", "Test", "public", "void", "putWithFailure", "(", ")", "throws", "Exception", "{", "public", "void", "putWithFailure", "(", ")", "{", "assertThatThrownBy", "(", "()", "-", ">", "authorizingCache", ".", "put", "(", "REGION", ",", "\"", "a", "\"", ",", "\"", "value", "\"", "))", ".", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "putAll", "(", ")", "throws", "Exception", "{", "public", "void", "putAll", "(", ")", "{", "authorize", "(", "DATA", ",", "WRITE", ",", "REGION", ",", "\"", "a", "\"", ");", "authorize", "(", "DATA", ",", "WRITE", ",", "REGION", ",", "\"", "c", "\"", ");", "Map", "<", "Object", ",", "Object", ">", "entries", "=", "new", "HashMap", "<", ">(", ");", "@", "@", "-", "205", ",", "7", "+", "208", ",", "7", "@", "@", "public", "void", "putAll", "(", ")", "throws", "Exception", "{", "}", "@", "Test", "public", "void", "putAllWithRegionLevelAuthorizationSucceeds", "(", ")", "throws", "Exception", "{", "public", "void", "putAllWithRegionLevelAuthorizationSucceeds", "(", ")", "{", "authorize", "(", "DATA", ",", "WRITE", ",", "REGION", ",", "ALL", ")", ";", "Map", "<", "Object", ",", "Object", ">", "entries", "=", "new", "HashMap", "<", ">(", ");", "entries", ".", "put", "(", "\"", "a", "\"", ",", "\"", "b", "\"", ");", "@", "@", "-", "221", ",", "7", "+", "224", ",", "7", "@", "@", "public", "void", "putAllWithRegionLevelAuthorizationSucceeds", "(", ")", "throws", "Exception", "{", "}", "@", "Test", "public", "void", "putAllWithFailure", "(", ")", "throws", "Exception", "{", "public", "void", "putAllWithFailure", "(", ")", "{", "authorize", "(", "DATA", ",", "WRITE", ",", "REGION", ",", "\"", "a", "\"", ");", "Map", "<", "Object", ",", "Object", ">", "entries", "=", "new", "HashMap", "<", ">(", ");", "entries", ".", "put", "(", "\"", "a", "\"", ",", "\"", "b", "\"", ");", "@", "@", "-", "239", ",", "20", "+", "242", ",", "20", "@", "@", "public", "void", "putAllWithFailure", "(", ")", "throws", "Exception", "{", "}", "@", "Test", "public", "void", "remove", "(", ")", "throws", "Exception", "{", "public", "void", "remove", "(", ")", "{", "authorize", "(", "DATA", ",", "WRITE", ",", "REGION", ",", "\"", "a", "\"", ");", "authorizingCache", ".", "remove", "(", "REGION", ",", "\"", "a", "\"", ");", "verify", "(", "region", ")", ".", "remove", "(", "\"", "a", "\"", ");", "}", "@", "Test", "public", "void", "removeWithoutAuthorization", "(", ")", "throws", "Exception", "{", "public", "void", "removeWithoutAuthorization", "(", ")", "{", "assertThatThrownBy", "(", "()", "-", ">", "authorizingCache", ".", "remove", "(", "REGION", ",", "\"", "a", "\"", "))", ".", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "removeIsPostProcessed", "(", ")", "throws", "Exception", "{", "public", "void", "removeIsPostProcessed", "(", ")", "{", "authorize", "(", "DATA", ",", "WRITE", ",", "REGION", ",", "\"", "a", "\"", ");", "when", "(", "region", ".", "remove", "(", "\"", "a", "\"", "))", ".", "thenReturn", "(", "\"", "value", "\"", ");", "when", "(", "security", ".", "postProcess", "(", "REGION", ",", "\"", "a", "\"", ",", "\"", "value", "\"", "))", ".", "thenReturn", "(", "\"", "spam", "\"", ");", "@", "@", "-", "262", ",", "7", "+", "265", ",", "7", "@", "@", "public", "void", "removeIsPostProcessed", "(", ")", "throws", "Exception", "{", "}", "@", "Test", "public", "void", "getRegionNames", "(", ")", "throws", "Exception", "{", "public", "void", "getRegionNames", "(", ")", "{", "authorize", "(", "DATA", ",", "READ", ",", "ALL", ",", "ALL", ")", ";", "Set", "<", "Region", "<", "?,", "?", ">>", "regions", "=", "new", "HashSet", "<", ">(", ");", "regions", ".", "add", "(", "region", ")", ";", "@", "@", "-", "284", ",", "59", "+", "287", ",", "59", "@", "@", "public", "void", "getRegionNames", "(", ")", "throws", "Exception", "{", "}", "@", "Test", "public", "void", "getRegionNamesWithoutAuthorization", "(", ")", "throws", "Exception", "{", "public", "void", "getRegionNamesWithoutAuthorization", "(", ")", "{", "assertThatThrownBy", "(", "()", "-", ">", "authorizingCache", ".", "getRegionNames", "(", "))", ".", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "getSize", "(", ")", "throws", "Exception", "{", "public", "void", "getSize", "(", ")", "{", "authorize", "(", "DATA", ",", "READ", ",", "REGION", ",", "ALL", ")", ";", "authorizingCache", ".", "getSize", "(", "REGION", ")", ";", "verify", "(", "region", ")", ".", "size", "(", ");", "}", "@", "Test", "public", "void", "getSizeWithoutAuthorization", "(", ")", "throws", "Exception", "{", "public", "void", "getSizeWithoutAuthorization", "(", ")", "{", "assertThatThrownBy", "(", "()", "-", ">", "authorizingCache", ".", "getSize", "(", "REGION", ")", ")", ".", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "keySet", "(", ")", "throws", "Exception", "{", "public", "void", "keySet", "(", ")", "{", "authorize", "(", "DATA", ",", "READ", ",", "REGION", ",", "ALL", ")", ";", "authorizingCache", ".", "keySet", "(", "REGION", ")", ";", "verify", "(", "region", ")", ".", "keySet", "(", ");", "}", "@", "Test", "public", "void", "keySetWithoutAuthorization", "(", ")", "throws", "Exception", "{", "public", "void", "keySetWithoutAuthorization", "(", ")", "{", "assertThatThrownBy", "(", "()", "-", ">", "authorizingCache", ".", "keySet", "(", "REGION", ")", ")", ".", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "clear", "(", ")", "throws", "Exception", "{", "public", "void", "clear", "(", ")", "{", "authorize", "(", "DATA", ",", "WRITE", ",", "REGION", ",", "ALL", ")", ";", "authorizingCache", ".", "clear", "(", "REGION", ")", ";", "verify", "(", "region", ")", ".", "clear", "(", ");", "}", "@", "Test", "public", "void", "clearWithoutAuthorization", "(", ")", "throws", "Exception", "{", "public", "void", "clearWithoutAuthorization", "(", ")", "{", "assertThatThrownBy", "(", "()", "-", ">", "authorizingCache", ".", "clear", "(", "REGION", ")", ")", ".", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "putIfAbsent", "(", ")", "throws", "Exception", "{", "public", "void", "putIfAbsent", "(", ")", "{", "authorize", "(", "DATA", ",", "WRITE", ",", "REGION", ",", "\"", "a", "\"", ");", "String", "oldValue", "=", "authorizingCache", ".", "putIfAbsent", "(", "REGION", ",", "\"", "a", "\"", ",", "\"", "b", "\"", ");", "verify", "(", "region", ")", ".", "putIfAbsent", "(", "\"", "a", "\"", ",", "\"", "b", "\"", ");", "}", "@", "Test", "public", "void", "putIfAbsentIsPostProcessed", "(", ")", "throws", "Exception", "{", "public", "void", "putIfAbsentIsPostProcessed", "(", ")", "{", "authorize", "(", "DATA", ",", "WRITE", ",", "REGION", ",", "\"", "a", "\"", ");", "when", "(", "region", ".", "putIfAbsent", "(", "any", "(", "),", "any", "(", "))", ").", "thenReturn", "(", "\"", "value", "\"", ");", "when", "(", "security", ".", "postProcess", "(", "REGION", ",", "\"", "a", "\"", ",", "\"", "value", "\"", "))", ".", "thenReturn", "(", "\"", "spam", "\"", ");", "@", "@", "-", "346", ",", "7", "+", "349", ",", "7", "@", "@", "public", "void", "putIfAbsentIsPostProcessed", "(", ")", "throws", "Exception", "{", "}", "@", "Test", "public", "void", "putIfAbsentWithoutAuthorization", "(", ")", "throws", "Exception", "{", "public", "void", "putIfAbsentWithoutAuthorization", "(", ")", "{", "assertThatThrownBy", "(", "()", "-", ">", "authorizingCache", ".", "putIfAbsent", "(", "REGION", ",", "\"", "a", "\"", ",", "\"", "b", "\"", "))", ".", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "@", "-", "20", ",", "6", "+", "20", ",", "7", "@", "@", "import", "static", "org", ".", "assertj", ".", "core", ".", "api", ".", "Assertions", ".", "assertThatThrownBy", ";", "import", "static", "org", ".", "mockito", ".", "ArgumentMatchers", ".", "any", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doNothing", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doReturn", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doThrow", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "@", "@", "-", "36", ",", "6", "+", "37", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "execute", ".", "Function", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "execute", ".", "FunctionService", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCache", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCacheForClientAccess", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "NotAuthorizedException", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "ResourcePermission", ";", "import", "org", ".", "apache", ".", "geode", ".", "test", ".", "junit", ".", "categories", ".", "ClientServerTest", ";", "@", "@", "-", "52", ",", "7", "+", "54", ",", "8", "@", "@", "@", "Before", "public", "void", "setUp", "(", ")", "{", "cache", "=", "mock", "(", "InternalCache", ".", "class", ")", ";", "cache", "=", "mock", "(", "InternalCacheForClientAccess", ".", "class", ")", ";", "doReturn", "(", "cache", ")", ".", "when", "(", "cache", ")", ".", "getCacheForProcessingClientRequests", "(", ");", "region", "=", "mock", "(", "Region", ".", "class", ")", ";", "when", "(", "cache", ".", "getRegion", "(", "REGION", ")", ").", "thenReturn", "(", "region", ")", ";", "security", "=", "mock", "(", "Security", ".", "class", ")", ";", "@", "@", "-", "39", ",", "7", "+", "39", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "internal", ".", "DistributionManager", ";", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "internal", ".", "InternalDistributedSystem", ";", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "internal", ".", "membership", ".", "InternalDistributedMember", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCache", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCacheForClientAccess", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "statistics", ".", "ProtobufClientStatistics", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "v1", ".", "FunctionAPI", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "v1", ".", "ProtobufSerializationService", ";", "@", "@", "-", "56", ",", "7", "+", "56", ",", "7", "@", "@", "private", "static", "final", "String", "TEST_GROUP2", "=", "\"", "group2", "\"", ";", "private", "static", "final", "String", "TEST_FUNCTION_ID", "=", "\"", "testFunction", "\"", ";", "public", "static", "final", "String", "NOT_A_GROUP", "=", "\"", "notAGroup", "\"", ";", "private", "InternalCache", "cacheStub", ";", "private", "InternalCacheForClientAccess", "cacheStub", ";", "private", "DistributionManager", "distributionManager", ";", "private", "ExecuteFunctionOnGroupRequestOperationHandler", "operationHandler", ";", "private", "ProtobufSerializationService", "serializationService", ";", "@", "@", "-", "88", ",", "7", "+", "88", ",", "8", "@", "@", "FunctionContext", "getContext", "(", ")", "{", "@", "Before", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "cacheStub", "=", "mock", "(", "InternalCache", ".", "class", ")", ";", "cacheStub", "=", "mock", "(", "InternalCacheForClientAccess", ".", "class", ")", ";", "when", "(", "cacheStub", ".", "getCacheForProcessingClientRequests", "(", "))", ".", "thenReturn", "(", "cacheStub", ")", ";", "serializationService", "=", "new", "ProtobufSerializationService", "(", ");", "when", "(", "cacheStub", ".", "getSecurityService", "(", "))", ".", "thenReturn", "(", "mock", "(", "SecurityService", ".", "class", ")", ");", "@", "@", "-", "35", ",", "7", "+", "35", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "DistributedSystemDisconnectedException", ";", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "internal", ".", "DistributionManager", ";", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "internal", ".", "membership", ".", "InternalDistributedMember", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCache", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCacheForClientAccess", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "statistics", ".", "ProtobufClientStatistics", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "v1", ".", "FunctionAPI", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "v1", ".", "ProtobufSerializationService", ";", "@", "@", "-", "52", ",", "7", "+", "52", ",", "7", "@", "@", "private", "static", "final", "String", "TEST_MEMBER2", "=", "\"", "member2", "\"", ";", "private", "static", "final", "String", "TEST_FUNCTION_ID", "=", "\"", "testFunction", "\"", ";", "public", "static", "final", "String", "NOT_A_MEMBER", "=", "\"", "notAMember", "\"", ";", "private", "InternalCache", "cacheStub", ";", "private", "InternalCacheForClientAccess", "cacheStub", ";", "private", "DistributionManager", "distributionManager", ";", "private", "ExecuteFunctionOnMemberRequestOperationHandler", "operationHandler", ";", "private", "ProtobufSerializationService", "serializationService", ";", "@", "@", "-", "83", ",", "7", "+", "83", ",", "8", "@", "@", "FunctionContext", "getContext", "(", ")", "{", "@", "Before", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "cacheStub", "=", "mock", "(", "InternalCache", ".", "class", ")", ";", "cacheStub", "=", "mock", "(", "InternalCacheForClientAccess", ".", "class", ")", ";", "when", "(", "cacheStub", ".", "getCacheForProcessingClientRequests", "(", "))", ".", "thenReturn", "(", "cacheStub", ")", ";", "serializationService", "=", "new", "ProtobufSerializationService", "(", ");", "when", "(", "cacheStub", ".", "getSecurityService", "(", "))", ".", "thenReturn", "(", "mock", "(", "SecurityService", ".", "class", ")", ");", "@", "@", "-", "15", ",", "6", "+", "15", ",", "7", "@", "@", "package", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "v1", ".", "operations", ";", "import", "static", "org", ".", "mockito", ".", "ArgumentMatchers", ".", "any", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doReturn", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doThrow", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "@", "@", "-", "35", ",", "6", "+", "36", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "execute", ".", "FunctionContext", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "execute", ".", "FunctionService", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCache", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCacheForClientAccess", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "LocalRegion", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "statistics", ".", "ProtobufClientStatistics", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "v1", ".", "FunctionAPI", ";", "@", "@", "-", "87", ",", "7", "+", "89", ",", "8", "@", "@", "FunctionContext", "getContext", "(", ")", "{", "@", "Before", "public", "void", "setUp", "(", ")", "{", "regionStub", "=", "mock", "(", "LocalRegion", ".", "class", ")", ";", "cacheStub", "=", "mock", "(", "InternalCache", ".", "class", ")", ";", "cacheStub", "=", "mock", "(", "InternalCacheForClientAccess", ".", "class", ")", ";", "doReturn", "(", "cacheStub", ")", ".", "when", "(", "cacheStub", ")", ".", "getCacheForProcessingClientRequests", "(", ");", "serializationService", "=", "new", "ProtobufSerializationService", "(", ");", "when", "(", "cacheStub", ".", "getRegion", "(", "TEST_REGION", ")", ").", "thenReturn", "(", "regionStub", ")", ";", "@", "@", "-", "16", ",", "6", "+", "16", ",", "7", "@", "@", "import", "static", "org", ".", "apache", ".", "geode", ".", "internal", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "TestExecutionContext", ".", "getNoAuthCacheExecutionContext", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doReturn", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "@", "@", "-", "31", ",", "6", "+", "32", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "Region", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCache", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCacheForClientAccess", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "v1", ".", "ProtobufRequestUtilities", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "v1", ".", "RegionAPI", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "v1", ".", "Result", ";", "@", "@", "-", "86", ",", "7", "+", "88", ",", "8", "@", "@", "public", "void", "processReturnsCacheRegions", "(", ")", "throws", "Exception", "{", "@", "Test", "public", "void", "processReturnsNoCacheRegions", "(", ")", "throws", "Exception", "{", "InternalCache", "emptyCache", "=", "mock", "(", "InternalCache", ".", "class", ")", ";", "InternalCache", "emptyCache", "=", "mock", "(", "InternalCacheForClientAccess", ".", "class", ")", ";", "doReturn", "(", "emptyCache", ")", ".", "when", "(", "emptyCache", ")", ".", "getCacheForProcessingClientRequests", "(", ");", "when", "(", "emptyCache", ".", "rootRegions", "(", "))", ".", "thenReturn", "(", "Collections", ".", "unmodifiableSet", "(", "new", "HashSet", "<", "Region", "<", "String", ",", "String", ">", ">(", "))", ");", "Result", "result", "=", "operationHandler", ".", "process", "(", "serializationService", ",", "@", "@", "-", "15", ",", "6", "+", "15", ",", "7", "@", "@", "package", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "v1", ".", "operations", ";", "import", "static", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "TestExecutionContext", ".", "getNoAuthCacheExecutionContext", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doReturn", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "@", "@", "-", "34", ",", "6", "+", "35", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "RegionDestroyedException", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "Scope", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCache", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCacheForClientAccess", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "v1", ".", "MessageUtil", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "v1", ".", "RegionAPI", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "v1", ".", "Result", ";", "@", "@", "-", "77", ",", "7", "+", "79", ",", "8", "@", "@", "public", "void", "processReturnsCacheRegions", "(", ")", "throws", "Exception", "{", "@", "Test", "public", "void", "processReturnsNoCacheRegions", "(", ")", "throws", "Exception", "{", "InternalCache", "emptyCache", "=", "mock", "(", "InternalCache", ".", "class", ")", ";", "InternalCache", "emptyCache", "=", "mock", "(", "InternalCacheForClientAccess", ".", "class", ")", ";", "doReturn", "(", "emptyCache", ")", ".", "when", "(", "emptyCache", ")", ".", "getCacheForProcessingClientRequests", "(", ");", "when", "(", "emptyCache", ".", "rootRegions", "(", "))", ".", "thenReturn", "(", "Collections", ".", "unmodifiableSet", "(", "new", "HashSet", "<", "Region", "<", "String", ",", "String", ">", ">(", "))", ");", "String", "unknownRegionName", "=", "\"", "UNKNOWN_REGION", "\"", ";", "@", "@", "-", "14", ",", "12", "+", "14", ",", "14", "@", "@", "*", "/", "package", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "v1", ".", "operations", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doReturn", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "experimental", ".", "categories", ".", "Category", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCache", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InternalCacheForClientAccess", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "operations", ".", "ProtobufOperationHandler", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "protocol", ".", "protobuf", ".", "v1", ".", "ProtobufSerializationService", ";", "import", "org", ".", "apache", ".", "geode", ".", "test", ".", "junit", ".", "categories", ".", "ClientServerTest", ";", "@", "@", "-", "33", ",", "7", "+", "35", ",", "8", "@", "@", "/", "/", "if", "we", "name", "this", "setUp", ",", "then", "our", "children", "override", ",", "which", "is", "all", "kinds", "of", "annoying", ".", "@", "Before", "public", "void", "setUpForChildJUnitTests", "(", ")", "throws", "Exception", "{", "cacheStub", "=", "mock", "(", "InternalCache", ".", "class", ")", ";", "cacheStub", "=", "mock", "(", "InternalCacheForClientAccess", ".", "class", ")", ";", "doReturn", "(", "cacheStub", ")", ".", "when", "(", "cacheStub", ")", ".", "getCacheForProcessingClientRequests", "(", ");", "serializationService", "=", "new", "ProtobufSerializationService", "(", ");", "}", "}"], "docstring_tokens": ["a", "flaw", "when", "operating", "in", "secure", "mode"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "836", ",", "7", "+", "836", ",", "6", "@", "@", "static", "int", "amd_gpio_remove", "(", "struct", "platform_device", "*", "pdev", ")", "gpio_dev", "=", "platform_get_drvdata", "(", "pdev", ")", ";", "gpiochip_remove", "(", "&", "gpio_dev", "-", ">", "gc", ")", ";", "pinctrl_unregister", "(", "gpio_dev", "-", ">", "pctrl", ")", ";", "return", "0", ";", "}"], "docstring_tokens": ["a", "double", "free", "flaw"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1", ",", "6", "+", "1", ",", "6", "@", "@", "{", "\"", "name", "\"", ":", "\"", "vega", "-", "cli", "\"", ",", "\"", "version", "\"", ":", "\"", "5", ".", "17", ".", "2", "\"", ",", "\"", "version", "\"", ":", "\"", "5", ".", "17", ".", "3", "\"", ",", "\"", "description", "\"", ":", "\"", "Command", "line", "utilities", "for", "server", "-", "side", "Vega", ".", "\",", "\"", "keywords", "\"", ":", "[", "\"", "vega", "\"", ",", "@", "@", "-", "21", ",", "7", "+", "21", ",", "7", "@", "@", "}", ",", "\"", "dependencies", "\"", ":", "{", "\"", "canvas", "\"", ":", "\"", "^", "2", ".", "6", ".", "1", "\"", ",", "\"", "vega", "\"", ":", "\"", "5", ".", "17", ".", "2", "\"", ",", "\"", "vega", "\"", ":", "\"", "5", ".", "17", ".", "3", "\"", ",", "\"", "yargs", "\"", ":", "\"", "16", "\"", "}", "}", "@", "@", "-", "1", ",", "6", "+", "1", ",", "6", "@", "@", "{", "\"", "name", "\"", ":", "\"", "vega", "-", "expression", "\"", ",", "\"", "version", "\"", ":", "\"", "4", ".", "0", ".", "0", "\"", ",", "\"", "version", "\"", ":", "\"", "4", ".", "0", ".", "1", "\"", ",", "\"", "description", "\"", ":", "\"", "Vega", "expression", "parser", "and", "code", "generator", ".", "\",", "\"", "keywords", "\"", ":", "[", "\"", "vega", "\"", ",", "@", "@", "-", "84", ",", "7", "+", "84", ",", "6", "@", "@", "export", "default", "function", "(", "codegen", ")", "{", "lower", ":", "fn", "(", "'", "toLowerCase", "'", ",", "STRING", ",", "0", ")", ",", "substring", ":", "fn", "(", "'", "substring", "'", ",", "STRING", ")", ",", "split", ":", "fn", "(", "'", "split", "'", ",", "STRING", ")", ",", "replace", ":", "fn", "(", "'", "replace", "'", ",", "STRING", ")", ",", "trim", ":", "fn", "(", "'", "trim", "'", ",", "STRING", ",", "0", ")", ",", "/", "/", "REGEXP", "functions", "@", "@", "-", "212", ",", "7", "+", "212", ",", "6", "@", "@", "tape", "(", "'", "Evaluate", "expressions", "with", "white", "list", "'", ",", "t", "=", ">", "{", "t", ".", "equal", "(", "evaluate", "(", "'", "trim", "(", "\"", "123", "\"", ")'", "),", "'", "123", "'", ".", "trim", "(", "))", ";", "t", ".", "equal", "(", "evaluate", "(", "'", "parseFloat", "(", "\"", "3", ".", "14", "\"", ")'", "),", "parseFloat", "(", "'", "3", ".", "14", "'", "))", ";", "t", ".", "equal", "(", "evaluate", "(", "'", "parseInt", "(", "\"", "42", "\"", ")'", "),", "parseInt", "(", "'", "42", "'", "))", ";", "t", ".", "equal", "(", "evaluate", "(", "'", "replace", "(", "\"", "hello", "world", "\"", ",", "/", "hello", "/", ",", "\"", "goodbye", "\"", ")'", "),", "'", "goodbye", "world", "'", ");", "/", "/", "should", "eval", "regular", "expression", "functions", "t", ".", "equal", "(", "evaluate", "(", "'", "test", "(", "/", "ain", "/", ",", "\"", "spain", "\"", ")'", "),", "/", "ain", "/", ".", "test", "(", "'", "spain", "'", "))", ";", "@", "@", "-", "58", ",", "6", "+", "58", ",", "7", "@", "@", "export", "{", "indexof", ",", "join", ",", "lastindexof", ",", "replace", ",", "reverse", ",", "slice", "}", "from", "'", "./", "src", "/", "functions", "/", "sequence", "'", ";", "@", "@", "-", "1", ",", "6", "+", "1", ",", "6", "@", "@", "{", "\"", "name", "\"", ":", "\"", "vega", "-", "functions", "\"", ",", "\"", "version", "\"", ":", "\"", "5", ".", "9", ".", "0", "\"", ",", "\"", "version", "\"", ":", "\"", "5", ".", "10", ".", "0", "\"", ",", "\"", "description", "\"", ":", "\"", "Custom", "functions", "for", "the", "Vega", "expression", "language", ".", "\",", "\"", "keywords", "\"", ":", "[", "\"", "vega", "\"", ",", "@", "@", "-", "25", ",", "7", "+", "25", ",", "7", "@", "@", "\"", "d3", "-", "color", "\"", ":", "\"", "^", "2", ".", "0", ".", "0", "\"", ",", "\"", "d3", "-", "geo", "\"", ":", "\"", "^", "2", ".", "0", ".", "1", "\"", ",", "\"", "vega", "-", "dataflow", "\"", ":", "\"", "^", "5", ".", "7", ".", "3", "\"", ",", "\"", "vega", "-", "expression", "\"", ":", "\"", "^", "4", ".", "0", ".", "0", "\"", ",", "\"", "vega", "-", "expression", "\"", ":", "\"", "^", "4", ".", "0", ".", "1", "\"", ",", "\"", "vega", "-", "scale", "\"", ":", "\"", "^", "7", ".", "1", ".", "1", "\"", ",", "\"", "vega", "-", "scenegraph", "\"", ":", "\"", "^", "4", ".", "9", ".", "2", "\"", ",", "\"", "vega", "-", "selections", "\"", ":", "\"", "^", "5", ".", "1", ".", "5", "\"", ",", "@", "@", "-", "142", ",", "6", "+", "142", ",", "7", "@", "@", "import", "{", "indexof", ",", "join", ",", "lastindexof", ",", "replace", ",", "reverse", ",", "slice", "}", "from", "'", "./", "functions", "/", "sequence", "'", ";", "@", "@", "-", "220", ",", "6", "+", "221", ",", "7", "@", "@", "export", "const", "functionContext", "=", "{", "indexof", ",", "join", ",", "lastindexof", ",", "replace", ",", "reverse", ",", "slice", ",", "flush", ",", "@", "@", "-", "1", ",", "4", "+", "1", ",", "4", "@", "@", "import", "{", "isArray", ",", "isString", "}", "from", "'", "vega", "-", "util", "'", ";", "import", "{", "error", ",", "isArray", ",", "isFunction", ",", "isString", "}", "from", "'", "vega", "-", "util", "'", ";", "function", "array", "(", "seq", ")", "{", "return", "isArray", "(", "seq", ")", "|", "|", "ArrayBuffer", ".", "isView", "(", "seq", ")", "?", "seq", ":", "null", ";", "@", "@", "-", "24", ",", "6", "+", "24", ",", "10", "@", "@", "export", "function", "slice", "(", "seq", ",", ".", "..", "args", ")", "{", "return", "sequence", "(", "seq", ")", ".", "slice", "(", "..", ".", "args", ")", ";", "}", "export", "function", "replace", "(", "str", ",", "pattern", ",", "repl", ")", "{", "if", "(", "isFunction", "(", "repl", ")", ")", "error", "(", "'", "Function", "argument", "passed", "to", "replace", ".", "')", ";", "return", "String", "(", "str", ")", ".", "replace", "(", "pattern", ",", "repl", ")", ";", "}", "export", "function", "reverse", "(", "seq", ")", "{", "return", "array", "(", "seq", ")", ".", "slice", "(", ").", "reverse", "(", ");", "}", "@", "@", "-", "1", ",", "5", "+", "1", ",", "12", "@", "@", "var", "tape", "=", "require", "(", "'", "tape", "'", "),", "{", "indexof", ",", "join", ",", "lastindexof", ",", "reverse", ",", "slice", "}", "=", "require", "(", "'.", "./", "')", ";", "{", "indexof", ",", "join", ",", "lastindexof", ",", "replace", ",", "reverse", ",", "slice", "}", "=", "require", "(", "'.", "./", "')", ";", "tape", "(", "'", "indexof", "finds", "first", "index", "'", ",", "t", "=", ">", "{", "t", ".", "deepEqual", "(", "indexof", "(", "[", "1", ",", "2", ",", "2", ",", "3", "]", ",", "2", ")", ",", "[", "1", ",", "2", ",", "2", ",", "3", "]", ".", "indexOf", "(", "2", ")", ");", "@", "@", "-", "15", ",", "6", "+", "22", ",", "12", "@", "@", "tape", "(", "'", "lastindexof", "finds", "last", "index", "'", ",", "t", "=", ">", "{", "t", ".", "end", "(", ");", "}", ");", "tape", "(", "'", "replace", "replaces", "substrings", "'", ",", "t", "=", ">", "{", "t", ".", "equal", "(", "replace", "(", "'", "hello", "world", "'", ",", "/", "hello", "/", ",", "'", "goodbye", "'", "),", "'", "goodbye", "world", "'", ");", "t", ".", "throws", "(", "()", "=", ">", "replace", "(", "'", "evil", "'", ",", "/", ".*", "/,", "d", "=", ">", "d", ")", ");", "t", ".", "end", "(", ");", "}", ");", "tape", "(", "'", "reverse", "reverses", "an", "array", "'", ",", "t", "=", ">", "{", "t", ".", "deepEqual", "(", "reverse", "(", "[", "1", ",", "2", ",", "3", "]", "),", "[", "1", ",", "2", ",", "3", "]", ".", "reverse", "(", "))", ";", "t", ".", "throws", "(", "()", "=", ">", "reverse", "(", "{", "reverse", ":", "v", "=", ">", "v", "+", "1", "}", "))", ";", "@", "@", "-", "1", ",", "6", "+", "1", ",", "6", "@", "@", "{", "\"", "name", "\"", ":", "\"", "vega", "-", "parser", "\"", ",", "\"", "version", "\"", ":", "\"", "6", ".", "1", ".", "1", "\"", ",", "\"", "version", "\"", ":", "\"", "6", ".", "1", ".", "2", "\"", ",", "\"", "description", "\"", ":", "\"", "Parse", "Vega", "specifications", "to", "runtime", "dataflows", ".", "\",", "\"", "keywords", "\"", ":", "[", "\"", "vega", "\"", ",", "@", "@", "-", "24", ",", "7", "+", "24", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "vega", "-", "dataflow", "\"", ":", "\"", "^", "5", ".", "7", ".", "3", "\"", ",", "\"", "vega", "-", "event", "-", "selector", "\"", ":", "\"", "^", "2", ".", "0", ".", "6", "\"", ",", "\"", "vega", "-", "functions", "\"", ":", "\"", "^", "5", ".", "9", ".", "0", "\"", ",", "\"", "vega", "-", "functions", "\"", ":", "\"", "^", "5", ".", "10", ".", "0", "\"", ",", "\"", "vega", "-", "scale", "\"", ":", "\"", "^", "7", ".", "1", ".", "1", "\"", ",", "\"", "vega", "-", "util", "\"", ":", "\"", "^", "1", ".", "15", ".", "2", "\"", "}", "@", "@", "-", "1", ",", "6", "+", "1", ",", "6", "@", "@", "{", "\"", "name", "\"", ":", "\"", "vega", "-", "view", "\"", ",", "\"", "version", "\"", ":", "\"", "5", ".", "9", ".", "1", "\"", ",", "\"", "version", "\"", ":", "\"", "5", ".", "9", ".", "2", "\"", ",", "\"", "description", "\"", ":", "\"", "View", "component", "and", "transforms", "for", "Vega", "visualizations", ".", "\",", "\"", "keywords", "\"", ":", "[", "\"", "vega", "\"", ",", "@", "@", "-", "25", ",", "7", "+", "25", ",", "7", "@", "@", "\"", "d3", "-", "timer", "\"", ":", "\"", "^", "2", ".", "0", ".", "0", "\"", ",", "\"", "vega", "-", "dataflow", "\"", ":", "\"", "^", "5", ".", "7", ".", "3", "\"", ",", "\"", "vega", "-", "format", "\"", ":", "\"", "^", "1", ".", "0", ".", "4", "\"", ",", "\"", "vega", "-", "functions", "\"", ":", "\"", "^", "5", ".", "9", ".", "0", "\"", ",", "\"", "vega", "-", "functions", "\"", ":", "\"", "^", "5", ".", "10", ".", "0", "\"", ",", "\"", "vega", "-", "runtime", "\"", ":", "\"", "^", "6", ".", "1", ".", "3", "\"", ",", "\"", "vega", "-", "scenegraph", "\"", ":", "\"", "^", "4", ".", "9", ".", "2", "\"", ",", "\"", "vega", "-", "util", "\"", ":", "\"", "^", "1", ".", "15", ".", "2", "\"", "@", "@", "-", "1", ",", "6", "+", "1", ",", "6", "@", "@", "{", "\"", "name", "\"", ":", "\"", "vega", "\"", ",", "\"", "version", "\"", ":", "\"", "5", ".", "17", ".", "2", "\"", ",", "\"", "version", "\"", ":", "\"", "5", ".", "17", ".", "3", "\"", ",", "\"", "description", "\"", ":", "\"", "The", "Vega", "visualization", "grammar", ".", "\",", "\"", "keywords", "\"", ":", "[", "\"", "vega", "\"", ",", "@", "@", "-", "34", ",", "15", "+", "34", ",", "15", "@", "@", "\"", "vega", "-", "dataflow", "\"", ":", "\"", "~", "5", ".", "7", ".", "3", "\"", ",", "\"", "vega", "-", "encode", "\"", ":", "\"", "~", "4", ".", "8", ".", "3", "\"", ",", "\"", "vega", "-", "event", "-", "selector", "\"", ":", "\"", "~", "2", ".", "0", ".", "6", "\"", ",", "\"", "vega", "-", "expression", "\"", ":", "\"", "~", "4", ".", "0", ".", "0", "\"", ",", "\"", "vega", "-", "expression", "\"", ":", "\"", "~", "4", ".", "0", ".", "1", "\"", ",", "\"", "vega", "-", "force", "\"", ":", "\"", "~", "4", ".", "0", ".", "7", "\"", ",", "\"", "vega", "-", "format", "\"", ":", "\"", "~", "1", ".", "0", ".", "4", "\"", ",", "\"", "vega", "-", "functions", "\"", ":", "\"", "~", "5", ".", "9", ".", "0", "\"", ",", "\"", "vega", "-", "functions", "\"", ":", "\"", "~", "5", ".", "10", ".", "0", "\"", ",", "\"", "vega", "-", "geo", "\"", ":", "\"", "~", "4", ".", "3", ".", "8", "\"", ",", "\"", "vega", "-", "hierarchy", "\"", ":", "\"", "~", "4", ".", "0", ".", "9", "\"", ",", "\"", "vega", "-", "label", "\"", ":", "\"", "~", "1", ".", "0", ".", "0", "\"", ",", "\"", "vega", "-", "loader", "\"", ":", "\"", "~", "4", ".", "4", ".", "0", "\"", ",", "\"", "vega", "-", "parser", "\"", ":", "\"", "~", "6", ".", "1", ".", "1", "\"", ",", "\"", "vega", "-", "parser", "\"", ":", "\"", "~", "6", ".", "1", ".", "2", "\"", ",", "\"", "vega", "-", "projection", "\"", ":", "\"", "~", "1", ".", "4", ".", "5", "\"", ",", "\"", "vega", "-", "regression", "\"", ":", "\"", "~", "1", ".", "0", ".", "9", "\"", ",", "\"", "vega", "-", "runtime", "\"", ":", "\"", "~", "6", ".", "1", ".", "3", "\"", ",", "@", "@", "-", "53", ",", "7", "+", "53", ",", "7", "@", "@", "\"", "vega", "-", "transforms", "\"", ":", "\"", "~", "4", ".", "9", ".", "3", "\"", ",", "\"", "vega", "-", "typings", "\"", ":", "\"", "~", "0", ".", "19", ".", "2", "\"", ",", "\"", "vega", "-", "util", "\"", ":", "\"", "~", "1", ".", "16", ".", "0", "\"", ",", "\"", "vega", "-", "view", "\"", ":", "\"", "~", "5", ".", "9", ".", "1", "\"", ",", "\"", "vega", "-", "view", "\"", ":", "\"", "~", "5", ".", "9", ".", "2", "\"", ",", "\"", "vega", "-", "view", "-", "transforms", "\"", ":", "\"", "~", "4", ".", "5", ".", "8", "\"", ",", "\"", "vega", "-", "voronoi", "\"", ":", "\"", "~", "4", ".", "1", ".", "5", "\"", ",", "\"", "vega", "-", "wordcloud", "\"", ":", "\"", "~", "4", ".", "1", ".", "3", "\""], "docstring_tokens": ["improper", "validation", "of", "user-supplied", "input"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "51", ",", "6", "+", "51", ",", "7", "@", "@", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "regex", ".", "Pattern", ";", "import", "static", "org", ".", "apache", ".", "hadoop", ".", "yarn", ".", "server", ".", "nodemanager", ".", "containermanager", ".", "linux", ".", "runtime", ".", "LinuxContainerRuntimeConstants", ".", "*;", "@", "@", "-", "60", ",", "6", "+", "61", ",", "12", "@", "@", "private", "static", "final", "Log", "LOG", "=", "LogFactory", ".", "getLog", "(", "DockerLinuxContainerRuntime", ".", "class", ")", ";", "/", "/", "This", "validates", "that", "the", "image", "is", "a", "proper", "docker", "image", "public", "static", "final", "String", "DOCKER_IMAGE_PATTERN", "=", "\"", "^(", "([", "a", "-", "zA", "-", "Z0", "-", "9", ".", "-]", "+)", "(:", "\\\\", "d", "+", ")?", "/)", "?(", "[", "a", "-", "z0", "-", "9_", ".", "/-", "]+", ")(", ":[", "\\\\", "w", ".", "-]", "+)", "?$", "\";", "private", "static", "final", "Pattern", "dockerImagePattern", "=", "Pattern", ".", "compile", "(", "DOCKER_IMAGE_PATTERN", ")", ";", "@", "InterfaceAudience", ".", "Private", "public", "static", "final", "String", "ENV_DOCKER_CONTAINER_IMAGE", "=", "\"", "YARN_CONTAINER_RUNTIME_DOCKER_IMAGE", "\"", ";", "@", "@", "-", "216", ",", "10", "+", "223", ",", "7", "@", "@", "public", "void", "launchContainer", "(", "ContainerRuntimeContext", "ctx", ")", ".", "getEnvironment", "(", ");", "String", "imageName", "=", "environment", ".", "get", "(", "ENV_DOCKER_CONTAINER_IMAGE", ")", ";", "if", "(", "imageName", "=", "=", "null", ")", "{", "throw", "new", "ContainerExecutionException", "(", "ENV_DOCKER_CONTAINER_IMAGE", "+", "\"", "not", "set", "!", "\")", ";", "}", "validateImageName", "(", "imageName", ")", ";", "String", "containerIdStr", "=", "container", ".", "getContainerId", "(", ").", "toString", "(", ");", "String", "runAsUser", "=", "ctx", ".", "getExecutionAttribute", "(", "RUN_AS_USER", ")", ";", "@", "@", "-", "354", ",", "4", "+", "358", ",", "16", "@", "@", "public", "void", "reapContainer", "(", "ContainerRuntimeContext", "ctx", ")", "throws", "ContainerExecutionException", "{", "}", "public", "static", "void", "validateImageName", "(", "String", "imageName", ")", "throws", "ContainerExecutionException", "{", "if", "(", "imageName", "=", "=", "null", "|", "|", "imageName", ".", "isEmpty", "(", "))", "{", "throw", "new", "ContainerExecutionException", "(", "ENV_DOCKER_CONTAINER_IMAGE", "+", "\"", "not", "set", "!", "\")", ";", "}", "if", "(", "!", "dockerImagePattern", ".", "matcher", "(", "imageName", ")", ".", "matches", "(", "))", "{", "throw", "new", "ContainerExecutionException", "(", "\"", "Image", "name", "'", "\"", "+", "imageName", "+", "\"", "'", "doesn", "'", "t", "match", "docker", "image", "name", "pattern", "\"", ");", "}", "}", "}", "@", "@", "-", "388", ",", "4", "+", "388", ",", "33", "@", "@", "public", "void", "testLaunchPrivilegedContainersWithEnabledSettingAndDefaultACL", "(", ")", "+", "\"", ":", "\"", "+", "command", ",", "command", ".", "contains", "(", "\"-", "-", "privileged", "\"", "))", ";", "}", "@", "Test", "public", "void", "testDockerImageNamePattern", "(", ")", "throws", "Exception", "{", "String", "[", "]", "validNames", "=", "{", "\"", "ubuntu", "\"", ",", "\"", "fedora", "/", "httpd", ":", "version1", ".", "0", "\"", ",", "\"", "fedora", "/", "httpd", ":", "version1", ".", "0", ".", "test", "\"", ",", "\"", "fedora", "/", "httpd", ":", "version1", ".", "0", ".", "TEST", "\"", ",", "\"", "myregistryhost", ":", "5000", "/", "ubuntu", "\"", ",", "\"", "myregistryhost", ":", "5000", "/", "fedora", "/", "httpd", ":", "version1", ".", "0", "\"", ",", "\"", "myregistryhost", ":", "5000", "/", "fedora", "/", "httpd", ":", "version1", ".", "0", ".", "test", "\"", ",", "\"", "myregistryhost", ":", "5000", "/", "fedora", "/", "httpd", ":", "version1", ".", "0", ".", "TEST", "\"", "};", "String", "[", "]", "invalidNames", "=", "{", "\"", "Ubuntu", "\"", ",", "\"", "ubuntu", "|", "|", "fedora", "\"", ",", "\"", "ubuntu", "#", "\",", "\"", "myregistryhost", ":", "50AB0", "/", "ubuntu", "\"", ",", "\"", "myregistry", "#", "host", ":", "50AB0", "/", "ubuntu", "\"", ",", "\"", ":", "8080", "/", "ubuntu", "\"", "}", ";", "for", "(", "String", "name", ":", "validNames", ")", "{", "DockerLinuxContainerRuntime", ".", "validateImageName", "(", "name", ")", ";", "}", "for", "(", "String", "name", ":", "invalidNames", ")", "{", "try", "{", "DockerLinuxContainerRuntime", ".", "validateImageName", "(", "name", ")", ";", "Assert", ".", "fail", "(", "name", "+", "\"", "is", "an", "invalid", "name", "and", "should", "fail", "the", "regex", "\"", ");", "}", "catch", "(", "ContainerExecutionException", "ce", ")", "{", "continue", ";", "}", "}", "}", "}"], "docstring_tokens": ["runs", "docker", "commands", "as", "root", "with", "insufficient", "input", "validation", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "410", ",", "6", "+", "410", ",", "8", "@", "@", "int", "rds_recvmsg", "(", "struct", "kiocb", "*", "iocb", ",", "struct", "socket", "*", "sock", ",", "struct", "msghdr", "*", "msg", ",", "rdsdebug", "(", "\"", "size", "%", "zu", "flags", "0x", "%", "x", "timeo", "%", "ld", "\\", "n", "\"", ",", "size", ",", "msg_flags", ",", "timeo", ")", ";", "msg", "-", ">", "msg_namelen", "=", "0", ";", "if", "(", "msg_flags", "&", "MSG_OOB", ")", "goto", "out", ";", "@", "@", "-", "485", ",", "6", "+", "487", ",", "7", "@", "@", "int", "rds_recvmsg", "(", "struct", "kiocb", "*", "iocb", ",", "struct", "socket", "*", "sock", ",", "struct", "msghdr", "*", "msg", ",", "sin", "-", ">", "sin_port", "=", "inc", "-", ">", "i_hdr", ".", "h_sport", ";", "sin", "-", ">", "sin_addr", ".", "s_addr", "=", "inc", "-", ">", "i_saddr", ";", "memset", "(", "sin", "-", ">", "sin_zero", ",", "0", ",", "sizeof", "(", "sin", "-", ">", "sin_zero", ")", ");", "msg", "-", ">", "msg_namelen", "=", "sizeof", "(", "*", "sin", ")", ";", "}", "break", ";", "}"], "docstring_tokens": ["does", "not", "initialize", "a", "certain", "structure", "member"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "20", ",", "7", "+", "20", ",", "7", "@", "@", "/", "**", "*", "An", "interface", "defining", "an", "*", "<", "a", "href", "=", "\"", "http", ":", "//", "en", ".", "wikipedia", ".", "org", "/", "wiki", "/", "HTTP_cookie", "\"", ">", "HTTP", "cookie", "<", "/", "a", ">", ".", "*", "@", "deprecated", "Use", "{", "@", "link", "io", ".", "netty", ".", "handler", ".", "codec", ".", "http", ".", "cookie", ".", "Cookie", "}", "instead", ".", "*", "@", "deprecated", "Use", "{", "@", "link", "org", ".", "jboss", ".", "netty", ".", "handler", ".", "codec", ".", "http", ".", "cookie", ".", "Cookie", "}", "instead", ".", "*", "/", "@", "Deprecated", "public", "interface", "Cookie", "extends", "org", ".", "jboss", ".", "netty", ".", "handler", ".", "codec", ".", "http", ".", "cookie", ".", "Cookie", "{", "@", "@", "-", "79", ",", "31", "+", "79", ",", "31", "@", "@", "*", "@", "deprecated", "Use", "{", "@", "link", "#", "maxAge", "(", ")}", "instead", ".", "*", "/", "@", "Deprecated", "long", "getMaxAge", "(", ");", "int", "getMaxAge", "(", ");", "/", "**", "*", "Returns", "the", "maximum", "age", "of", "this", "{", "@", "link", "Cookie", "}", "in", "seconds", "or", "{", "@", "link", "Long", "#", "MIN_VALUE", "}", "if", "unspecified", "*", "Returns", "the", "maximum", "age", "of", "this", "{", "@", "link", "Cookie", "}", "in", "seconds", "or", "{", "@", "link", "Integer", "#", "MIN_VALUE", "}", "if", "unspecified", "*", "*", "@", "return", "The", "maximum", "age", "of", "this", "{", "@", "link", "Cookie", "}", "*", "*", "@", "deprecated", "Not", "part", "of", "RFC6265", "*", "/", "@", "Deprecated", "long", "maxAge", "(", ");", "int", "maxAge", "(", ");", "/", "**", "*", "Sets", "the", "maximum", "age", "of", "this", "{", "@", "link", "Cookie", "}", "in", "seconds", ".", "*", "If", "an", "age", "of", "{", "@", "code", "0", "}", "is", "specified", ",", "this", "{", "@", "link", "Cookie", "}", "will", "be", "*", "automatically", "removed", "by", "browser", "because", "it", "will", "expire", "immediately", ".", "*", "If", "{", "@", "link", "Long", "#", "MIN_VALUE", "}", "is", "specified", ",", "this", "{", "@", "link", "Cookie", "}", "will", "be", "removed", "when", "the", "*", "If", "{", "@", "link", "Integer", "#", "MIN_VALUE", "}", "is", "specified", ",", "this", "{", "@", "link", "Cookie", "}", "will", "be", "removed", "when", "the", "*", "browser", "is", "closed", ".", "*", "*", "@", "param", "maxAge", "The", "maximum", "age", "of", "this", "{", "@", "link", "Cookie", "}", "in", "seconds", "*", "*", "@", "deprecated", "Not", "part", "of", "RFC6265", "*", "/", "@", "Deprecated", "void", "setMaxAge", "(", "long", "maxAge", ")", ";", "void", "setMaxAge", "(", "int", "maxAge", ")", ";", "/", "**", "*", "@", "deprecated", "Use", "{", "@", "link", "#", "version", "(", ")}", "instead", ".", "@", "@", "-", "138", ",", "7", "+", "138", ",", "7", "@", "@", "public", "CookieDecoder", "(", "boolean", "strict", ")", "{", "String", "commentURL", "=", "null", ";", "String", "domain", "=", "null", ";", "String", "path", "=", "null", ";", "long", "maxAge", "=", "Long", ".", "MIN_VALUE", ";", "int", "maxAge", "=", "Integer", ".", "MIN_VALUE", ";", "List", "<", "Integer", ">", "ports", "=", "new", "ArrayList", "<", "Integer", ">", "(", "2", ")", ";", "for", "(", "int", "j", "=", "i", "+", "1", ";", "j", "<", "names", ".", "size", "(", ");", "j", "+", "+,", "i", "+", "+)", "{", "@", "@", "-", "165", ",", "7", "+", "165", ",", "7", "@", "@", "public", "CookieDecoder", "(", "boolean", "strict", ")", "{", "HttpHeaderDateFormat", ".", "get", "(", ").", "parse", "(", "value", ")", ".", "getTime", "(", ")", "-", "System", ".", "currentTimeMillis", "(", ");", "maxAge", "=", "maxAgeMillis", "/", "1000", "+", "(", "maxAgeMillis", "%", "1000", "!", "=", "0", "?", "1", ":", "0", ")", ";", "maxAge", "=", "(", "int", ")", "(", "maxAgeMillis", "/", "1000", "+", "(", "maxAgeMillis", "%", "1000", "!", "=", "0", "?", "1", ":", "0", ")", ");", "}", "catch", "(", "ParseException", "e", ")", "{", "/", "/", "Ignore", ".", "}", "@", "@", "-", "154", ",", "7", "+", "154", ",", "7", "@", "@", "public", "void", "setPorts", "(", "Iterable", "<", "Integer", ">", "ports", ")", "{", "}", "@", "Deprecated", "public", "long", "getMaxAge", "(", ")", "{", "public", "int", "getMaxAge", "(", ")", "{", "return", "maxAge", "(", ");", "}", "@", "@", "-", "154", ",", "7", "+", "154", ",", "7", "@", "@", "public", "Cookie", "decode", "(", "String", "header", ")", "{", "private", "final", "DefaultCookie", "cookie", ";", "private", "String", "domain", ";", "private", "String", "path", ";", "private", "long", "maxAge", "=", "Long", ".", "MIN_VALUE", ";", "private", "int", "maxAge", "=", "Integer", ".", "MIN_VALUE", ";", "private", "String", "expires", ";", "private", "boolean", "secure", ";", "private", "boolean", "httpOnly", ";", "@", "@", "-", "163", ",", "18", "+", "163", ",", "18", "@", "@", "public", "CookieBuilder", "(", "DefaultCookie", "cookie", ")", "{", "this", ".", "cookie", "=", "cookie", ";", "}", "private", "long", "mergeMaxAgeAndExpire", "(", "long", "maxAge", ",", "String", "expires", ")", "{", "private", "int", "mergeMaxAgeAndExpire", "(", "int", "maxAge", ",", "String", "expires", ")", "{", "/", "/", "max", "age", "has", "precedence", "over", "expires", "if", "(", "maxAge", "!", "=", "Long", ".", "MIN_VALUE", ")", "{", "if", "(", "maxAge", "!", "=", "Integer", ".", "MIN_VALUE", ")", "{", "return", "maxAge", ";", "}", "else", "if", "(", "expires", "!", "=", "null", ")", "{", "Date", "expiresDate", "=", "HttpHeaderDateFormat", ".", "get", "(", ").", "parse", "(", "expires", ",", "new", "ParsePosition", "(", "0", ")", ");", "if", "(", "expiresDate", "!", "=", "null", ")", "{", "long", "maxAgeMillis", "=", "expiresDate", ".", "getTime", "(", ")", "-", "System", ".", "currentTimeMillis", "(", ");", "return", "maxAgeMillis", "/", "1000", "+", "(", "maxAgeMillis", "%", "1000", "!", "=", "0", "?", "1", ":", "0", ")", ";", "return", "(", "int", ")", "(", "maxAgeMillis", "/", "1000", "+", "(", "maxAgeMillis", "%", "1000", "!", "=", "0", "?", "1", ":", "0", ")", ");", "}", "}", "return", "Long", ".", "MIN_VALUE", ";", "return", "Integer", ".", "MIN_VALUE", ";", "}", "public", "Cookie", "cookie", "(", ")", "{", "@", "@", "-", "239", ",", "7", "+", "239", ",", "7", "@", "@", "private", "void", "setExpire", "(", "String", "value", ")", "{", "private", "void", "setMaxAge", "(", "String", "value", ")", "{", "try", "{", "maxAge", "=", "Math", ".", "max", "(", "Long", ".", "valueOf", "(", "value", ")", ",", "0L", ")", ";", "maxAge", "=", "Math", ".", "max", "(", "Integer", ".", "valueOf", "(", "value", ")", ",", "0", ")", ";", "}", "catch", "(", "NumberFormatException", "e1", ")", "{", "/", "/", "ignore", "failure", "to", "parse", "-", ">", "treat", "as", "session", "cookie", "}", "@", "@", "-", "87", ",", "22", "+", "87", ",", "22", "@", "@", "void", "setPath", "(", "String", "path", ")", ";", "/", "**", "*", "Returns", "the", "maximum", "age", "of", "this", "{", "@", "link", "Cookie", "}", "in", "seconds", "or", "{", "@", "link", "Long", "#", "MIN_VALUE", "}", "if", "unspecified", "*", "Returns", "the", "maximum", "age", "of", "this", "{", "@", "link", "Cookie", "}", "in", "seconds", "or", "{", "@", "link", "Integer", "#", "MIN_VALUE", "}", "if", "unspecified", "*", "*", "@", "return", "The", "maximum", "age", "of", "this", "{", "@", "link", "Cookie", "}", "*", "/", "long", "maxAge", "(", ");", "int", "maxAge", "(", ");", "/", "**", "*", "Sets", "the", "maximum", "age", "of", "this", "{", "@", "link", "Cookie", "}", "in", "seconds", ".", "*", "If", "an", "age", "of", "{", "@", "code", "0", "}", "is", "specified", ",", "this", "{", "@", "link", "Cookie", "}", "will", "be", "*", "automatically", "removed", "by", "browser", "because", "it", "will", "expire", "immediately", ".", "*", "If", "{", "@", "link", "Long", "#", "MIN_VALUE", "}", "is", "specified", ",", "this", "{", "@", "link", "Cookie", "}", "will", "be", "removed", "when", "the", "*", "If", "{", "@", "link", "Integer", "#", "MIN_VALUE", "}", "is", "specified", ",", "this", "{", "@", "link", "Cookie", "}", "will", "be", "removed", "when", "the", "*", "browser", "is", "closed", ".", "*", "*", "@", "param", "maxAge", "The", "maximum", "age", "of", "this", "{", "@", "link", "Cookie", "}", "in", "seconds", "*", "/", "void", "setMaxAge", "(", "long", "maxAge", ")", ";", "void", "setMaxAge", "(", "int", "maxAge", ")", ";", "/", "**", "*", "Checks", "to", "see", "if", "this", "{", "@", "link", "Cookie", "}", "is", "secure", "@", "@", "-", "25", ",", "7", "+", "25", ",", "7", "@", "@", "private", "boolean", "wrap", ";", "private", "String", "domain", ";", "private", "String", "path", ";", "private", "long", "maxAge", "=", "Long", ".", "MIN_VALUE", ";", "private", "int", "maxAge", "=", "Integer", ".", "MIN_VALUE", ";", "private", "boolean", "secure", ";", "private", "boolean", "httpOnly", ";", "@", "@", "-", "105", ",", "11", "+", "105", ",", "11", "@", "@", "public", "void", "setPath", "(", "String", "path", ")", "{", "this", ".", "path", "=", "validateValue", "(", "\"", "path", "\"", ",", "path", ")", ";", "}", "public", "long", "maxAge", "(", ")", "{", "public", "int", "maxAge", "(", ")", "{", "return", "maxAge", ";", "}", "public", "void", "setMaxAge", "(", "long", "maxAge", ")", "{", "public", "void", "setMaxAge", "(", "int", "maxAge", ")", "{", "this", ".", "maxAge", "=", "maxAge", ";", "}", "@", "@", "-", "93", ",", "7", "+", "93", ",", "7", "@", "@", "public", "String", "encode", "(", "Cookie", "cookie", ")", "{", "add", "(", "buf", ",", "name", ",", "value", ")", ";", "}", "if", "(", "cookie", ".", "maxAge", "(", ")", "!", "=", "Long", ".", "MIN_VALUE", ")", "{", "if", "(", "cookie", ".", "maxAge", "(", ")", "!", "=", "Integer", ".", "MIN_VALUE", ")", "{", "add", "(", "buf", ",", "CookieHeaderNames", ".", "MAX_AGE", ",", "cookie", ".", "maxAge", "(", "))", ";", "Date", "expires", "=", "new", "Date", "(", "cookie", ".", "maxAge", "(", ")", "*", "1000", "+", "System", ".", "currentTimeMillis", "(", "))", ";", "add", "(", "buf", ",", "CookieHeaderNames", ".", "EXPIRES", ",", "HttpHeaderDateFormat", ".", "get", "(", ").", "format", "(", "expires", ")", ");", "@", "@", "-", "207", ",", "7", "+", "207", ",", "7", "@", "@", "public", "void", "testDecodingClientSideCookies", "(", ")", "{", "assertNull", "(", "c", ".", "getCommentUrl", "(", "))", ";", "assertNull", "(", "c", ".", "getDomain", "(", "))", ";", "assertTrue", "(", "c", ".", "getPorts", "(", ").", "isEmpty", "(", "))", ";", "assertEquals", "(", "Long", ".", "MIN_VALUE", ",", "c", ".", "getMaxAge", "(", "))", ";", "assertEquals", "(", "Integer", ".", "MIN_VALUE", ",", "c", ".", "getMaxAge", "(", "))", ";", "c", "=", "it", ".", "next", "(", ");", "assertEquals", "(", "1", ",", "c", ".", "getVersion", "(", "))", ";", "@", "@", "-", "218", ",", "7", "+", "218", ",", "7", "@", "@", "public", "void", "testDecodingClientSideCookies", "(", ")", "{", "assertNull", "(", "c", ".", "getCommentUrl", "(", "))", ";", "assertNull", "(", "c", ".", "getDomain", "(", "))", ";", "assertTrue", "(", "c", ".", "getPorts", "(", ").", "isEmpty", "(", "))", ";", "assertEquals", "(", "Long", ".", "MIN_VALUE", ",", "c", ".", "getMaxAge", "(", "))", ";", "assertEquals", "(", "Integer", ".", "MIN_VALUE", ",", "c", ".", "getMaxAge", "(", "))", ";", "assertFalse", "(", "it", ".", "hasNext", "(", "))", ";", "}", "@", "@", "-", "243", ",", "7", "+", "243", ",", "7", "@", "@", "public", "void", "testDecodingCommaSeparatedClientSideCookies", "(", ")", "{", "assertNull", "(", "c", ".", "getCommentUrl", "(", "))", ";", "assertNull", "(", "c", ".", "getDomain", "(", "))", ";", "assertTrue", "(", "c", ".", "getPorts", "(", ").", "isEmpty", "(", "))", ";", "assertEquals", "(", "Long", ".", "MIN_VALUE", ",", "c", ".", "getMaxAge", "(", "))", ";", "assertEquals", "(", "Integer", ".", "MIN_VALUE", ",", "c", ".", "getMaxAge", "(", "))", ";", "assertTrue", "(", "it", ".", "hasNext", "(", "))", ";", "c", "=", "it", ".", "next", "(", ");", "@", "@", "-", "255", ",", "7", "+", "255", ",", "7", "@", "@", "public", "void", "testDecodingCommaSeparatedClientSideCookies", "(", ")", "{", "assertNull", "(", "c", ".", "getComment", "(", "))", ";", "assertNull", "(", "c", ".", "getCommentUrl", "(", "))", ";", "assertTrue", "(", "c", ".", "getPorts", "(", ").", "isEmpty", "(", "))", ";", "assertEquals", "(", "Long", ".", "MIN_VALUE", ",", "c", ".", "getMaxAge", "(", "))", ";", "assertEquals", "(", "Integer", ".", "MIN_VALUE", ",", "c", ".", "getMaxAge", "(", "))", ";", "assertFalse", "(", "it", ".", "hasNext", "(", "))", ";", "}", "@", "@", "-", "172", ",", "11", "+", "172", ",", "11", "@", "@", "public", "void", "testDecodingGoogleAnalyticsCookie", "(", ")", "{", "@", "Test", "public", "void", "testDecodingLongDates", "(", ")", "{", "Calendar", "cookieDate", "=", "Calendar", ".", "getInstance", "(", "TimeZone", ".", "getTimeZone", "(", "\"", "UTC", "\"", "))", ";", "cookieDate", ".", "set", "(", "9999", ",", "Calendar", ".", "DECEMBER", ",", "31", ",", "23", ",", "59", ",", "59", ")", ";", "long", "expectedMaxAge", "=", "(", "cookieDate", ".", "getTimeInMillis", "(", ")", "-", "System", ".", "currentTimeMillis", "(", "))", "/", "1000", ";", "cookieDate", ".", "set", "(", "2080", ",", "Calendar", ".", "DECEMBER", ",", "31", ",", "23", ",", "59", ",", "59", ")", ";", "int", "expectedMaxAge", "=", "(", "int", ")", "((", "cookieDate", ".", "getTimeInMillis", "(", ")", "-", "System", ".", "currentTimeMillis", "(", "))", "/", "1000", ")", ";", "String", "source", "=", "\"", "Format", "=", "EU", ";", "expires", "=", "Fri", ",", "31", "-", "Dec", "-", "9999", "23", ":", "59", ":", "59", "GMT", ";", "path", "=", "/\"", ";", "String", "source", "=", "\"", "Format", "=", "EU", ";", "expires", "=", "Fri", ",", "31", "-", "Dec", "-", "2080", "23", ":", "59", ":", "59", "GMT", ";", "path", "=", "/\"", ";", "Cookie", "cookie", "=", "ClientCookieDecoder", ".", "STRICT", ".", "decode", "(", "source", ")", ";"], "docstring_tokens": ["the", "improper", "validation", "of", "characters", "in", "a", "cookie", "name"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "606", ",", "7", "+", "606", ",", "8", "@", "@", "int", "dccp_rcv_state_process", "(", "struct", "sock", "*", "sk", ",", "struct", "sk_buff", "*", "skb", ",", "if", "(", "inet_csk", "(", "sk", ")", "->", "icsk_af_ops", "-", ">", "conn_request", "(", "sk", ",", "skb", ")", "<", "0", ")", "return", "1", ";", "goto", "discard", ";", "consume_skb", "(", "skb", ")", ";", "return", "0", ";", "}", "if", "(", "dh", "-", ">", "dccph_type", "=", "=", "DCCP_PKT_RESET", ")", "goto", "discard", ";"], "docstring_tokens": ["improper", "handling", "of", "DCCP_PKT_REQUEST", "packet", "data", "structures", "in", "the", "LISTEN", "state"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "176", ",", "6", "+", "176", ",", "13", "@", "@", "static", "long", "restore_sigcontext", "(", "struct", "pt_regs", "*", "regs", ",", "sigset_t", "*", "set", ",", "int", "sig", ",", "*", "/", "discard_lazy_cpu_state", "(", ");", "/", "*", "*", "Force", "reload", "of", "FP", "/", "VEC", ".", "*", "This", "has", "to", "be", "done", "before", "copying", "stuff", "into", "current", "-", ">", "thread", ".", "fpr", "/", "vr", "*", "for", "the", "reasons", "explained", "in", "the", "previous", "comment", ".", "*", "/", "regs", "-", ">", "msr", "&", "=", "~", "(", "MSR_FP", "|", "MSR_FE0", "|", "MSR_FE1", "|", "MSR_VEC", ")", ";", "err", "|", "=", "__copy_from_user", "(", "&", "current", "-", ">", "thread", ".", "fpr", ",", "&", "sc", "-", ">", "fp_regs", ",", "FP_REGS_SIZE", ")", ";", "#", "ifdef", "CONFIG_ALTIVEC", "@", "@", "-", "197", ",", "9", "+", "204", ",", "6", "@", "@", "static", "long", "restore_sigcontext", "(", "struct", "pt_regs", "*", "regs", ",", "sigset_t", "*", "set", ",", "int", "sig", ",", "current", "-", ">", "thread", ".", "vrsave", "=", "0", ";", "#", "endif", "/", "*", "CONFIG_ALTIVEC", "*", "/", "/", "*", "Force", "reload", "of", "FP", "/", "VEC", "*", "/", "regs", "-", ">", "msr", "&", "=", "~", "(", "MSR_FP", "|", "MSR_FE0", "|", "MSR_FE1", "|", "MSR_VEC", ")", ";", "return", "err", ";", "}"], "docstring_tokens": ["a", "vulnerability", "in", "the", "signal", "handling", "service"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1107", ",", "6", "+", "1107", ",", "8", "@", "@", "static", "int", "do_replace", "(", "struct", "net", "*", "net", ",", "const", "void", "__user", "*", "user", ",", "if", "(", "tmp", ".", "num_counters", ">", "=", "INT_MAX", "/", "sizeof", "(", "struct", "ebt_counter", ")", ")", "return", "-", "ENOMEM", ";", "tmp", ".", "name", "[", "sizeof", "(", "tmp", ".", "name", ")", "-", "1", "]", "=", "0", ";", "countersize", "=", "COUNTER_OFFSET", "(", "tmp", ".", "nentries", ")", "*", "nr_cpu_ids", ";", "newinfo", "=", "vmalloc", "(", "sizeof", "(", "*", "newinfo", ")", "+", "countersize", ")", ";", "if", "(", "!", "newinfo", ")"], "docstring_tokens": ["does", "not", "ensure", "that", "a", "certain", "name", "field", "ends", "with", "a", "'\\0", "'", "character"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "212", ",", "9", "+", "212", ",", "21", "@", "@", "private", "boolean", "isIdentityRemoved", "(", "WebSubjectContext", "subjectContext", ")", "{", "if", "(", "log", ".", "isTraceEnabled", "(", "))", "{", "log", ".", "trace", "(", "\"", "Acquired", "Base64", "encoded", "identity", "[", "\"", "+", "base64", "+", "\"", "]\"", ");", "}", "byte", "[", "]", "decoded", "=", "Base64", ".", "decode", "(", "base64", ")", ";", "byte", "[", "]", "decoded", ";", "try", "{", "decoded", "=", "Base64", ".", "decode", "(", "base64", ")", ";", "}", "catch", "(", "RuntimeException", "rtEx", ")", "{", "/", "*", "*", "https", ":", "//", "issues", ".", "apache", ".", "org", "/", "jira", "/", "browse", "/", "SHIRO", "-", "766", ":", "*", "If", "the", "base64", "string", "cannot", "be", "decoded", ",", "just", "assume", "there", "is", "no", "valid", "cookie", "value", ".", "*", "*", "/", "getCookie", "(", ").", "removeFrom", "(", "request", ",", "response", ")", ";", "log", ".", "warn", "(", "\"", "Unable", "to", "decode", "existing", "base64", "encoded", "entity", ":", "[", "\"", "+", "base64", "+", "\"", "].", "\",", "rtEx", ")", ";", "return", "null", ";", "}", "if", "(", "log", ".", "isTraceEnabled", "(", "))", "{", "log", ".", "trace", "(", "\"", "Base64", "decoded", "byte", "array", "length", ":", "\"", "+", "(", "decoded", "!", "=", "null", "?", "decoded", ".", "length", ":", "0", ")", "+", "\"", "bytes", ".", "\")", ";", "log", ".", "trace", "(", "\"", "Base64", "decoded", "byte", "array", "length", ":", "\"", "+", "decoded", ".", "length", "+", "\"", "bytes", ".", "\")", ";", "}", "return", "decoded", ";", "}", "else", "{", "@", "@", "-", "35", ",", "6", "+", "35", ",", "8", "@", "@", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletRequest", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletResponse", ";", "import", "java", ".", "util", ".", "UUID", ";", "import", "static", "org", ".", "easymock", ".", "EasyMock", ".", "*;", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*;", "@", "@", "-", "244", ",", "4", "+", "246", ",", "30", "@", "@", "public", "void", "onLogout", "(", ")", "{", "verify", "(", "mockResponse", ")", ";", "verify", "(", "cookie", ")", ";", "}", "@", "Test", "public", "void", "shouldIgnoreInvalidCookieValues", "(", ")", "{", "/", "/", "given", "HttpServletRequest", "mockRequest", "=", "createMock", "(", "HttpServletRequest", ".", "class", ")", ";", "HttpServletResponse", "mockResponse", "=", "createMock", "(", "HttpServletResponse", ".", "class", ")", ";", "WebSubjectContext", "context", "=", "new", "DefaultWebSubjectContext", "(", ");", "context", ".", "setServletRequest", "(", "mockRequest", ")", ";", "context", ".", "setServletResponse", "(", "mockResponse", ")", ";", "CookieRememberMeManager", "mgr", "=", "new", "CookieRememberMeManager", "(", ");", "Cookie", "[", "]", "cookies", "=", "new", "Cookie", "[", "]{", "new", "Cookie", "(", "CookieRememberMeManager", ".", "DEFAULT_REMEMBER_ME_COOKIE_NAME", ",", "UUID", ".", "randomUUID", "(", ").", "toString", "(", ")", "+", "\"", "%%", "ldapRealm", "\"", ")", "}", ";", "expect", "(", "mockRequest", ".", "getAttribute", "(", "ShiroHttpServletRequest", ".", "IDENTITY_REMOVED_KEY", ")", ").", "andReturn", "(", "null", ")", ";", "expect", "(", "mockRequest", ".", "getContextPath", "(", "))", ".", "andReturn", "(", "null", ")", ";", "expect", "(", "mockRequest", ".", "getCookies", "(", "))", ".", "andReturn", "(", "cookies", ")", ";", "replay", "(", "mockRequest", ")", ";", "/", "/", "when", "final", "byte", "[", "]", "rememberedSerializedIdentity", "=", "mgr", ".", "getRememberedSerializedIdentity", "(", "context", ")", ";", "/", "/", "then", "assertNull", "(", "\"", "should", "ignore", "invalid", "cookie", "values", "\"", ",", "rememberedSerializedIdentity", ")", ";", "}", "}"], "docstring_tokens": ["improper", "authentication", "validation"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "3381", ",", "6", "+", "3381", ",", "26", "@", "@", "int", "r100_cs_track_check", "(", "struct", "radeon_device", "*", "rdev", ",", "struct", "r100_cs_track", "*", "track", ")", "}", "track", "-", ">", "zb_dirty", "=", "false", ";", "if", "(", "track", "-", ">", "aa_dirty", "&", "&", "track", "-", ">", "aaresolve", ")", "{", "if", "(", "track", "-", ">", "aa", ".", "robj", "=", "=", "NULL", ")", "{", "DRM_ERROR", "(", "\"[", "drm", "]", "No", "buffer", "for", "AA", "resolve", "buffer", "%", "d", "!", "\\", "n", "\"", ",", "i", ")", ";", "return", "-", "EINVAL", ";", "}", "/", "*", "I", "believe", "the", "format", "comes", "from", "colorbuffer0", ".", "*", "/", "size", "=", "track", "-", ">", "aa", ".", "pitch", "*", "track", "-", ">", "cb", "[", "0", "]", ".", "cpp", "*", "track", "-", ">", "maxy", ";", "size", "+", "=", "track", "-", ">", "aa", ".", "offset", ";", "if", "(", "size", ">", "radeon_bo_size", "(", "track", "-", ">", "aa", ".", "robj", ")", ")", "{", "DRM_ERROR", "(", "\"[", "drm", "]", "Buffer", "too", "small", "for", "AA", "resolve", "buffer", "%", "d", "\"", "\"", "(", "need", "%", "lu", "have", "%", "lu", ")", "!", "\\", "n", "\"", ",", "i", ",", "size", ",", "radeon_bo_size", "(", "track", "-", ">", "aa", ".", "robj", ")", ");", "DRM_ERROR", "(", "\"[", "drm", "]", "AA", "resolve", "buffer", "%", "d", "(", "%", "u", "%", "u", "%", "u", "%", "u", ")", "\\", "n", "\"", ",", "i", ",", "track", "-", ">", "aa", ".", "pitch", ",", "track", "-", ">", "cb", "[", "0", "]", ".", "cpp", ",", "track", "-", ">", "aa", ".", "offset", ",", "track", "-", ">", "maxy", ")", ";", "return", "-", "EINVAL", ";", "}", "}", "track", "-", ">", "aa_dirty", "=", "false", ";", "prim_walk", "=", "(", "track", "-", ">", "vap_vf_cntl", ">", ">", "4", ")", "&", "0x3", ";", "if", "(", "track", "-", ">", "vap_vf_cntl", "&", "(", "1", "<", "<", "14", ")", ")", "{", "nverts", "=", "track", "-", ">", "vap_alt_nverts", ";", "@", "@", "-", "3455", ",", "6", "+", "3475", ",", "7", "@", "@", "void", "r100_cs_track_clear", "(", "struct", "radeon_device", "*", "rdev", ",", "struct", "r100_cs_track", "*", "track", "track", "-", ">", "cb_dirty", "=", "true", ";", "track", "-", ">", "zb_dirty", "=", "true", ";", "track", "-", ">", "tex_dirty", "=", "true", ";", "track", "-", ">", "aa_dirty", "=", "true", ";", "if", "(", "rdev", "-", ">", "family", "<", "CHIP_R300", ")", "{", "track", "-", ">", "num_cb", "=", "1", ";", "@", "@", "-", "3469", ",", "6", "+", "3490", ",", "8", "@", "@", "void", "r100_cs_track_clear", "(", "struct", "radeon_device", "*", "rdev", ",", "struct", "r100_cs_track", "*", "track", "track", "-", ">", "num_texture", "=", "16", ";", "track", "-", ">", "maxy", "=", "4096", ";", "track", "-", ">", "separate_cube", "=", "0", ";", "track", "-", ">", "aaresolve", "=", "true", ";", "track", "-", ">", "aa", ".", "robj", "=", "NULL", ";", "}", "for", "(", "i", "=", "0", ";", "i", "<", "track", "-", ">", "num_cb", ";", "i", "+", "+)", "{", "@", "@", "-", "66", ",", "15", "+", "66", ",", "17", "@", "@", "struct", "r100_cs_track", "{", "struct", "r100_cs_track_array", "arrays", "[", "11", "]", ";", "struct", "r100_cs_track_cb", "cb", "[", "R300_MAX_CB", "]", ";", "struct", "r100_cs_track_cb", "zb", ";", "struct", "r100_cs_track_cb", "aa", ";", "struct", "r100_cs_track_texture", "textures", "[", "R300_TRACK_MAX_TEXTURE", "]", ";", "bool", "z_enabled", ";", "bool", "separate_cube", ";", "bool", "zb_cb_clear", ";", "bool", "blend_read_enable", ";", "bool", "cb_dirty", ";", "bool", "zb_dirty", ";", "bool", "tex_dirty", ";", "bool", "aa_dirty", ";", "bool", "aaresolve", ";", "}", ";", "int", "r100_cs_track_check", "(", "struct", "radeon_device", "*", "rdev", ",", "struct", "r100_cs_track", "*", "track", ")", ";", "@", "@", "-", "1104", ",", "6", "+", "1104", ",", "27", "@", "@", "static", "int", "r300_packet0_check", "(", "struct", "radeon_cs_parser", "*", "p", ",", "track", "-", ">", "blend_read_enable", "=", "!", "!(", "idx_value", "&", "(", "1", "<", "<", "2", ")", ");", "track", "-", ">", "cb_dirty", "=", "true", ";", "break", ";", "case", "R300_RB3D_AARESOLVE_OFFSET", ":", "r", "=", "r100_cs_packet_next_reloc", "(", "p", ",", "&", "reloc", ")", ";", "if", "(", "r", ")", "{", "DRM_ERROR", "(", "\"", "No", "reloc", "for", "ib", "[", "%", "d", "]", "=", "0x", "%", "04X", "\\", "n", "\"", ",", "idx", ",", "reg", ")", ";", "r100_cs_dump_packet", "(", "p", ",", "pkt", ")", ";", "return", "r", ";", "}", "track", "-", ">", "aa", ".", "robj", "=", "reloc", "-", ">", "robj", ";", "track", "-", ">", "aa", ".", "offset", "=", "idx_value", ";", "track", "-", ">", "aa_dirty", "=", "true", ";", "ib", "[", "idx", "]", "=", "idx_value", "+", "(", "(", "u32", ")", "reloc", "-", ">", "lobj", ".", "gpu_offset", ")", ";", "break", ";", "case", "R300_RB3D_AARESOLVE_PITCH", ":", "track", "-", ">", "aa", ".", "pitch", "=", "idx_value", "&", "0x3FFE", ";", "track", "-", ">", "aa_dirty", "=", "true", ";", "break", ";", "case", "R300_RB3D_AARESOLVE_CTL", ":", "track", "-", ">", "aaresolve", "=", "idx_value", "&", "0x1", ";", "track", "-", ">", "aa_dirty", "=", "true", ";", "break", ";", "case", "0x4f30", ":", "/", "*", "ZB_MASK_OFFSET", "*", "/", "case", "0x4f34", ":", "/", "*", "ZB_ZMASK_PITCH", "*", "/", "case", "0x4f44", ":", "/", "*", "ZB_HIZ_OFFSET", "*", "/", "@", "@", "-", "1371", ",", "6", "+", "1371", ",", "8", "@", "@", "#", "define", "R300_RB3D_COLORPITCH2", "0x4E40", "/", "*", "GUESS", "*", "/", "#", "define", "R300_RB3D_COLORPITCH3", "0x4E44", "/", "*", "GUESS", "*", "/", "#", "define", "R300_RB3D_AARESOLVE_OFFSET", "0x4E80", "#", "define", "R300_RB3D_AARESOLVE_PITCH", "0x4E84", "#", "define", "R300_RB3D_AARESOLVE_CTL", "0x4E88", "/", "*", "gap", "*", "/", "@", "@", "-", "704", ",", "9", "+", "704", ",", "6", "@", "@", "r300", "0x4f60", "0x4E74", "RB3D_CMASK_WRINDEX", "0x4E78", "RB3D_CMASK_DWORD", "0x4E7C", "RB3D_CMASK_RDINDEX", "0x4E80", "RB3D_AARESOLVE_OFFSET", "0x4E84", "RB3D_AARESOLVE_PITCH", "0x4E88", "RB3D_AARESOLVE_CTL", "0x4EA0", "RB3D_DISCARD_SRC_PIXEL_LTE_THRESHOLD", "0x4EA4", "RB3D_DISCARD_SRC_PIXEL_GTE_THRESHOLD", "0x4F04", "ZB_ZSTENCILCNTL", "@", "@", "-", "770", ",", "9", "+", "770", ",", "6", "@", "@", "r420", "0x4f60", "0x4E74", "RB3D_CMASK_WRINDEX", "0x4E78", "RB3D_CMASK_DWORD", "0x4E7C", "RB3D_CMASK_RDINDEX", "0x4E80", "RB3D_AARESOLVE_OFFSET", "0x4E84", "RB3D_AARESOLVE_PITCH", "0x4E88", "RB3D_AARESOLVE_CTL", "0x4EA0", "RB3D_DISCARD_SRC_PIXEL_LTE_THRESHOLD", "0x4EA4", "RB3D_DISCARD_SRC_PIXEL_GTE_THRESHOLD", "0x4F04", "ZB_ZSTENCILCNTL", "@", "@", "-", "770", ",", "9", "+", "770", ",", "6", "@", "@", "rs600", "0x6d40", "0x4E74", "RB3D_CMASK_WRINDEX", "0x4E78", "RB3D_CMASK_DWORD", "0x4E7C", "RB3D_CMASK_RDINDEX", "0x4E80", "RB3D_AARESOLVE_OFFSET", "0x4E84", "RB3D_AARESOLVE_PITCH", "0x4E88", "RB3D_AARESOLVE_CTL", "0x4EA0", "RB3D_DISCARD_SRC_PIXEL_LTE_THRESHOLD", "0x4EA4", "RB3D_DISCARD_SRC_PIXEL_GTE_THRESHOLD", "0x4F04", "ZB_ZSTENCILCNTL", "@", "@", "-", "481", ",", "9", "+", "481", ",", "6", "@", "@", "rv515", "0x6d40", "0x4E74", "RB3D_CMASK_WRINDEX", "0x4E78", "RB3D_CMASK_DWORD", "0x4E7C", "RB3D_CMASK_RDINDEX", "0x4E80", "RB3D_AARESOLVE_OFFSET", "0x4E84", "RB3D_AARESOLVE_PITCH", "0x4E88", "RB3D_AARESOLVE_CTL", "0x4EA0", "RB3D_DISCARD_SRC_PIXEL_LTE_THRESHOLD", "0x4EA4", "RB3D_DISCARD_SRC_PIXEL_GTE_THRESHOLD", "0x4EF8", "RB3D_CONSTANT_COLOR_AR"], "docstring_tokens": ["the", "improper", "validation", "of", "input", "passed", "to", "the", "AARESOLVE_OFFSET", "registers"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1833", ",", "6", "+", "1833", ",", "10", "@", "@", "bytes", "respectively", ".", "Such", "letter", "suffixes", "can", "also", "be", "entirely", "omitted", ".", "and", "restore", "using", "xsave", ".", "The", "kernel", "will", "fallback", "to", "enabling", "legacy", "floating", "-", "point", "and", "sse", "state", ".", "eagerfpu", "=", "[", "X86", "]", "on", "enable", "eager", "fpu", "restore", "off", "disable", "eager", "fpu", "restore", "nohlt", "[", "BUGS", "=", "ARM", ",", "SH", "]", "Tells", "the", "kernel", "that", "the", "sleep", "(", "SH", ")", "or", "wfi", "(", "ARM", ")", "instruction", "doesn", "'", "t", "work", "correctly", "and", "not", "to", "use", "it", ".", "This", "is", "also", "useful", "when", "using", "JTAG", "debugger", ".", "@", "@", "-", "97", ",", "6", "+", "97", ",", "7", "@", "@", "#", "define", "X86_FEATURE_EXTD_APICID", "(", "3", "*", "32", "+", "26", ")", "/", "*", "has", "extended", "APICID", "(", "8", "bits", ")", "*", "/", "#", "define", "X86_FEATURE_AMD_DCM", "(", "3", "*", "32", "+", "27", ")", "/", "*", "multi", "-", "node", "processor", "*", "/", "#", "define", "X86_FEATURE_APERFMPERF", "(", "3", "*", "32", "+", "28", ")", "/", "*", "APERFMPERF", "*", "/", "#", "define", "X86_FEATURE_EAGER_FPU", "(", "3", "*", "32", "+", "29", ")", "/", "*", "\"", "eagerfpu", "\"", "Non", "lazy", "FPU", "restore", "*", "/", "/", "*", "Intel", "-", "defined", "CPU", "features", ",", "CPUID", "level", "0x00000001", "(", "ecx", ")", ",", "word", "4", "*", "/", "#", "define", "X86_FEATURE_XMM3", "(", "4", "*", "32", "+", "0", ")", "/", "*", "\"", "pni", "\"", "SSE", "-", "3", "*", "/", "@", "@", "-", "305", ",", "6", "+", "306", ",", "7", "@", "@", "extern", "const", "char", "*", "const", "x86_power_flags", "[", "32", "]", ";", "#", "define", "cpu_has_perfctr_core", "boot_cpu_has", "(", "X86_FEATURE_PERFCTR_CORE", ")", "#", "define", "cpu_has_cx8", "boot_cpu_has", "(", "X86_FEATURE_CX8", ")", "#", "define", "cpu_has_cx16", "boot_cpu_has", "(", "X86_FEATURE_CX16", ")", "#", "define", "cpu_has_eager_fpu", "boot_cpu_has", "(", "X86_FEATURE_EAGER_FPU", ")", "#", "if", "defined", "(", "CONFIG_X86_INVLPG", ")", "|", "|", "defined", "(", "CONFIG_X86_64", ")", "#", "define", "cpu_has_invlpg", "1", "@", "@", "-", "38", ",", "6", "+", "38", ",", "7", "@", "@", "int", "ia32_setup_frame", "(", "int", "sig", ",", "struct", "k_sigaction", "*", "ka", ",", "extern", "unsigned", "int", "mxcsr_feature_mask", ";", "extern", "void", "fpu_init", "(", "void", ")", ";", "extern", "void", "eager_fpu_init", "(", "void", ")", ";", "DECLARE_PER_CPU", "(", "struct", "task_struct", "*", ",", "fpu_owner_task", ")", ";", "@", "@", "-", "84", ",", "6", "+", "85", ",", "11", "@", "@", "static", "inline", "int", "is_x32_frame", "(", "void", ")", "#", "define", "X87_FSW_ES", "(", "1", "<", "<", "7", ")", "/", "*", "Exception", "Summary", "*", "/", "static", "__always_inline", "__pure", "bool", "use_eager_fpu", "(", "void", ")", "{", "return", "static_cpu_has", "(", "X86_FEATURE_EAGER_FPU", ")", ";", "}", "static", "__always_inline", "__pure", "bool", "use_xsaveopt", "(", "void", ")", "{", "return", "static_cpu_has", "(", "X86_FEATURE_XSAVEOPT", ")", ";", "@", "@", "-", "99", ",", "6", "+", "105", ",", "14", "@", "@", "static", "__always_inline", "__pure", "bool", "use_fxsr", "(", "void", ")", "return", "static_cpu_has", "(", "X86_FEATURE_FXSR", ")", ";", "}", "static", "inline", "void", "fx_finit", "(", "struct", "i387_fxsave_struct", "*", "fx", ")", "{", "memset", "(", "fx", ",", "0", ",", "xstate_size", ")", ";", "fx", "-", ">", "cwd", "=", "0x37f", ";", "if", "(", "cpu_has_xmm", ")", "fx", "-", ">", "mxcsr", "=", "MXCSR_DEFAULT", ";", "}", "extern", "void", "__sanitize_i387_state", "(", "struct", "task_struct", "*", ");", "static", "inline", "void", "sanitize_i387_state", "(", "struct", "task_struct", "*", "tsk", ")", "@", "@", "-", "291", ",", "13", "+", "305", ",", "13", "@", "@", "static", "inline", "void", "__thread_set_has_fpu", "(", "struct", "task_struct", "*", "tsk", ")", "static", "inline", "void", "__thread_fpu_end", "(", "struct", "task_struct", "*", "tsk", ")", "{", "__thread_clear_has_fpu", "(", "tsk", ")", ";", "if", "(", "!", "use_xsave", "(", "))", "if", "(", "!", "use_eager_fpu", "(", "))", "stts", "(", ");", "}", "static", "inline", "void", "__thread_fpu_begin", "(", "struct", "task_struct", "*", "tsk", ")", "{", "if", "(", "!", "use_xsave", "(", "))", "if", "(", "!", "use_eager_fpu", "(", "))", "clts", "(", ");", "__thread_set_has_fpu", "(", "tsk", ")", ";", "}", "@", "@", "-", "327", ",", "10", "+", "341", ",", "14", "@", "@", "static", "inline", "void", "drop_fpu", "(", "struct", "task_struct", "*", "tsk", ")", "static", "inline", "void", "drop_init_fpu", "(", "struct", "task_struct", "*", "tsk", ")", "{", "if", "(", "!", "use_xsave", "(", "))", "if", "(", "!", "use_eager_fpu", "(", "))", "drop_fpu", "(", "tsk", ")", ";", "else", "xrstor_state", "(", "init_xstate_buf", ",", "-", "1", ")", ";", "else", "{", "if", "(", "use_xsave", "(", "))", "xrstor_state", "(", "init_xstate_buf", ",", "-", "1", ")", ";", "else", "fxrstor_checking", "(", "&", "init_xstate_buf", "-", ">", "i387", ")", ";", "}", "}", "/", "*", "@", "@", "-", "370", ",", "7", "+", "388", ",", "7", "@", "@", "static", "inline", "fpu_switch_t", "switch_fpu_prepare", "(", "struct", "task_struct", "*", "old", ",", "struct", "ta", "*", "If", "the", "task", "has", "used", "the", "math", ",", "pre", "-", "load", "the", "FPU", "on", "xsave", "processors", "*", "or", "if", "the", "past", "5", "consecutive", "context", "-", "switches", "used", "math", ".", "*", "/", "fpu", ".", "preload", "=", "tsk_used_math", "(", "new", ")", "&", "&", "(", "use_xsave", "(", ")", "|", "|", "fpu", ".", "preload", "=", "tsk_used_math", "(", "new", ")", "&", "&", "(", "use_eager_fpu", "(", ")", "|", "|", "new", "-", ">", "fpu_counter", ">", "5", ")", ";", "if", "(", "__thread_has_fpu", "(", "old", ")", ")", "{", "if", "(", "!", "__save_init_fpu", "(", "old", ")", ")", "@", "@", "-", "383", ",", "14", "+", "401", ",", "14", "@", "@", "static", "inline", "fpu_switch_t", "switch_fpu_prepare", "(", "struct", "task_struct", "*", "old", ",", "struct", "ta", "new", "-", ">", "fpu_counter", "+", "+;", "__thread_set_has_fpu", "(", "new", ")", ";", "prefetch", "(", "new", "-", ">", "thread", ".", "fpu", ".", "state", ")", ";", "}", "else", "if", "(", "!", "use_xsave", "(", "))", "}", "else", "if", "(", "!", "use_eager_fpu", "(", "))", "stts", "(", ");", "}", "else", "{", "old", "-", ">", "fpu_counter", "=", "0", ";", "old", "-", ">", "thread", ".", "fpu", ".", "last_cpu", "=", "~", "0", ";", "if", "(", "fpu", ".", "preload", ")", "{", "new", "-", ">", "fpu_counter", "+", "+;", "if", "(", "!", "use_xsave", "(", ")", "&", "&", "fpu_lazy_restore", "(", "new", ",", "cpu", ")", ")", "if", "(", "!", "use_eager_fpu", "(", ")", "&", "&", "fpu_lazy_restore", "(", "new", ",", "cpu", ")", ")", "fpu", ".", "preload", "=", "0", ";", "else", "prefetch", "(", "new", "-", ">", "thread", ".", "fpu", ".", "state", ")", ";", "@", "@", "-", "452", ",", "15", "+", "470", ",", "23", "@", "@", "static", "inline", "void", "user_fpu_begin", "(", "void", ")", "preempt_enable", "(", ");", "}", "static", "inline", "void", "__save_fpu", "(", "struct", "task_struct", "*", "tsk", ")", "{", "if", "(", "use_xsave", "(", "))", "xsave_state", "(", "&", "tsk", "-", ">", "thread", ".", "fpu", ".", "state", "-", ">", "xsave", ",", "-", "1", ")", ";", "else", "fpu_fxsave", "(", "&", "tsk", "-", ">", "thread", ".", "fpu", ")", ";", "}", "/", "*", "*", "These", "disable", "preemption", "on", "their", "own", "and", "are", "safe", "*", "/", "static", "inline", "void", "save_init_fpu", "(", "struct", "task_struct", "*", "tsk", ")", "{", "WARN_ON_ONCE", "(", "!", "__thread_has_fpu", "(", "tsk", ")", ");", "if", "(", "use_xsave", "(", "))", "{", "xsave_state", "(", "&", "tsk", "-", ">", "thread", ".", "fpu", ".", "state", "-", ">", "xsave", ",", "-", "1", ")", ";", "if", "(", "use_eager_fpu", "(", "))", "{", "__save_fpu", "(", "tsk", ")", ";", "return", ";", "}", "@", "@", "-", "526", ",", "11", "+", "552", ",", "9", "@", "@", "static", "inline", "void", "fpu_free", "(", "struct", "fpu", "*", "fpu", ")", "static", "inline", "void", "fpu_copy", "(", "struct", "task_struct", "*", "dst", ",", "struct", "task_struct", "*", "src", ")", "{", "if", "(", "use_xsave", "(", "))", "{", "struct", "xsave_struct", "*", "xsave", "=", "&", "dst", "-", ">", "thread", ".", "fpu", ".", "state", "-", ">", "xsave", ";", "memset", "(", "&", "xsave", "-", ">", "xsave_hdr", ",", "0", ",", "sizeof", "(", "struct", "xsave_hdr_struct", ")", ");", "xsave_state", "(", "xsave", ",", "-", "1", ")", ";", "if", "(", "use_eager_fpu", "(", "))", "{", "memset", "(", "&", "dst", "-", ">", "thread", ".", "fpu", ".", "state", "-", ">", "xsave", ",", "0", ",", "xstate_size", ")", ";", "__save_fpu", "(", "dst", ")", ";", "}", "else", "{", "struct", "fpu", "*", "dfpu", "=", "&", "dst", "-", ">", "thread", ".", "fpu", ";", "struct", "fpu", "*", "sfpu", "=", "&", "src", "-", ">", "thread", ".", "fpu", ";", "@", "@", "-", "1297", ",", "7", "+", "1297", ",", "6", "@", "@", "void", "__cpuinit", "cpu_init", "(", "void", ")", "dbg_restore_debug_regs", "(", ");", "fpu_init", "(", ");", "xsave_init", "(", ");", "raw_local_save_flags", "(", "kernel_eflags", ")", ";", "@", "@", "-", "1352", ",", "6", "+", "1351", ",", "5", "@", "@", "void", "__cpuinit", "cpu_init", "(", "void", ")", "dbg_restore_debug_regs", "(", ");", "fpu_init", "(", ");", "xsave_init", "(", ");", "}", "#", "endif", "@", "@", "-", "22", ",", "9", "+", "22", ",", "8", "@", "@", "/", "*", "*", "Were", "we", "in", "an", "interrupt", "that", "interrupted", "kernel", "mode", "?", "*", "*", "For", "now", ",", "on", "xsave", "platforms", "we", "will", "return", "interrupted", "*", "kernel", "FPU", "as", "not", "-", "idle", ".", "TBD", ":", "As", "we", "use", "non", "-", "lazy", "FPU", "restore", "*", "for", "xsave", "platforms", ",", "ideally", "we", "can", "change", "the", "return", "value", "*", "For", "now", ",", "with", "eagerfpu", "we", "will", "return", "interrupted", "kernel", "FPU", "*", "state", "as", "not", "-", "idle", ".", "TBD", ":", "Ideally", "we", "can", "change", "the", "return", "value", "*", "to", "something", "like", "__thread_has_fpu", "(", "current", ")", ".", "But", "we", "need", "to", "*", "be", "careful", "of", "doing", "__thread_clear_has_fpu", "(", ")", "before", "saving", "*", "the", "FPU", "etc", "for", "supporting", "nested", "uses", "etc", ".", "For", "now", ",", "take", "@", "@", "-", "38", ",", "7", "+", "37", ",", "7", "@", "@", "*", "/", "static", "inline", "bool", "interrupted_kernel_fpu_idle", "(", "void", ")", "{", "if", "(", "use_xsave", "(", "))", "if", "(", "use_eager_fpu", "(", "))", "return", "0", ";", "return", "!", "__thread_has_fpu", "(", "current", ")", "&", "&", "@", "@", "-", "84", ",", "7", "+", "83", ",", "7", "@", "@", "void", "kernel_fpu_begin", "(", "void", ")", "__save_init_fpu", "(", "me", ")", ";", "__thread_clear_has_fpu", "(", "me", ")", ";", "/", "*", "We", "do", "'", "stts", "(", ")'", "in", "kernel_fpu_end", "(", ")", "*", "/", "}", "else", "if", "(", "!", "use_xsave", "(", "))", "{", "}", "else", "if", "(", "!", "use_eager_fpu", "(", "))", "{", "this_cpu_write", "(", "fpu_owner_task", ",", "NULL", ")", ";", "clts", "(", ");", "}", "@", "@", "-", "93", ",", "7", "+", "92", ",", "7", "@", "@", "EXPORT_SYMBOL", "(", "kernel_fpu_begin", ")", ";", "void", "kernel_fpu_end", "(", "void", ")", "{", "if", "(", "use_xsave", "(", "))", "if", "(", "use_eager_fpu", "(", "))", "math_state_restore", "(", ");", "else", "stts", "(", ");", "@", "@", "-", "122", ",", "7", "+", "121", ",", "6", "@", "@", "static", "void", "__cpuinit", "mxcsr_feature_mask_init", "(", "void", ")", "{", "unsigned", "long", "mask", "=", "0", ";", "clts", "(", ");", "if", "(", "cpu_has_fxsr", ")", "{", "memset", "(", "&", "fx_scratch", ",", "0", ",", "sizeof", "(", "struct", "i387_fxsave_struct", ")", ");", "asm", "volatile", "(", "\"", "fxsave", "%", "0", "\"", ":", ":", "\"", "m", "\"", "(", "fx_scratch", ")", ");", "@", "@", "-", "131", ",", "7", "+", "129", ",", "6", "@", "@", "static", "void", "__cpuinit", "mxcsr_feature_mask_init", "(", "void", ")", "mask", "=", "0x0000ffbf", ";", "}", "mxcsr_feature_mask", "&", "=", "mask", ";", "stts", "(", ");", "}", "static", "void", "__cpuinit", "init_thread_xstate", "(", "void", ")", "@", "@", "-", "185", ",", "9", "+", "182", ",", "8", "@", "@", "void", "__cpuinit", "fpu_init", "(", "void", ")", "init_thread_xstate", "(", ");", "mxcsr_feature_mask_init", "(", ");", "/", "*", "clean", "state", "in", "init", "*", "/", "current_thread_info", "(", ")-", ">", "status", "=", "0", ";", "clear_used_math", "(", ");", "xsave_init", "(", ");", "eager_fpu_init", "(", ");", "}", "void", "fpu_finit", "(", "struct", "fpu", "*", "fpu", ")", "@", "@", "-", "198", ",", "12", "+", "194", ",", "7", "@", "@", "void", "fpu_finit", "(", "struct", "fpu", "*", "fpu", ")", "}", "if", "(", "cpu_has_fxsr", ")", "{", "struct", "i387_fxsave_struct", "*", "fx", "=", "&", "fpu", "-", ">", "state", "-", ">", "fxsave", ";", "memset", "(", "fx", ",", "0", ",", "xstate_size", ")", ";", "fx", "-", ">", "cwd", "=", "0x37f", ";", "if", "(", "cpu_has_xmm", ")", "fx", "-", ">", "mxcsr", "=", "MXCSR_DEFAULT", ";", "fx_finit", "(", "&", "fpu", "-", ">", "state", "-", ">", "fxsave", ")", ";", "}", "else", "{", "struct", "i387_fsave_struct", "*", "fp", "=", "&", "fpu", "-", ">", "state", "-", ">", "fsave", ";", "memset", "(", "fp", ",", "0", ",", "xstate_size", ")", ";", "@", "@", "-", "156", ",", "7", "+", "156", ",", "7", "@", "@", "void", "flush_thread", "(", "void", ")", "*", "Free", "the", "FPU", "state", "for", "non", "xsave", "platforms", ".", "They", "get", "reallocated", "*", "lazily", "at", "the", "first", "use", ".", "*", "/", "if", "(", "!", "use_xsave", "(", "))", "if", "(", "!", "use_eager_fpu", "(", "))", "free_thread_xstate", "(", "tsk", ")", ";", "}", "@", "@", "-", "630", ",", "7", "+", "630", ",", "7", "@", "@", "EXPORT_SYMBOL_GPL", "(", "math_state_restore", ")", ";", "dotraplinkage", "void", "__kprobes", "do_device_not_available", "(", "struct", "pt_regs", "*", "regs", ",", "long", "error_code", ")", "{", "BUG_ON", "(", "use_xsave", "(", "))", ";", "BUG_ON", "(", "use_eager_fpu", "(", "))", ";", "#", "ifdef", "CONFIG_MATH_EMULATION", "if", "(", "read_cr0", "(", ")", "&", "X86_CR0_EM", ")", "{", "@", "@", "-", "400", ",", "7", "+", "400", ",", "7", "@", "@", "int", "__restore_xstate_sig", "(", "void", "__user", "*", "buf", ",", "void", "__user", "*", "buf_fx", ",", "int", "size", ")", "set_used_math", "(", ");", "}", "if", "(", "use_xsave", "(", "))", "if", "(", "use_eager_fpu", "(", "))", "math_state_restore", "(", ");", "return", "err", ";", "@", "@", "-", "450", ",", "28", "+", "450", ",", "10", "@", "@", "static", "void", "prepare_fx_sw_frame", "(", "void", ")", "*", "/", "static", "inline", "void", "xstate_enable", "(", "void", ")", "{", "clts", "(", ");", "set_in_cr4", "(", "X86_CR4_OSXSAVE", ")", ";", "xsetbv", "(", "XCR_XFEATURE_ENABLED_MASK", ",", "pcntxt_mask", ")", ";", "}", "/", "*", "*", "This", "is", "same", "as", "math_state_restore", "(", ").", "But", "use_xsave", "(", ")", "is", "not", "yet", "*", "patched", "to", "use", "math_state_restore", "(", ").", "*", "/", "static", "inline", "void", "init_restore_xstate", "(", "void", ")", "{", "init_fpu", "(", "current", ")", ";", "__thread_fpu_begin", "(", "current", ")", ";", "xrstor_state", "(", "init_xstate_buf", ",", "-", "1", ")", ";", "}", "static", "inline", "void", "xstate_enable_ap", "(", "void", ")", "{", "xstate_enable", "(", ");", "init_restore_xstate", "(", ");", "}", "/", "*", "*", "Record", "the", "offsets", "and", "sizes", "of", "different", "state", "managed", "by", "the", "xsave", "*", "memory", "layout", ".", "@", "@", "-", "500", ",", "17", "+", "482", ",", "20", "@", "@", "static", "void", "__init", "setup_xstate_features", "(", "void", ")", "/", "*", "*", "setup", "the", "xstate", "image", "representing", "the", "init", "state", "*", "/", "static", "void", "__init", "setup_xstate_init", "(", "void", ")", "static", "void", "__init", "setup_init_fpu_buf", "(", "void", ")", "{", "setup_xstate_features", "(", ");", "/", "*", "*", "Setup", "init_xstate_buf", "to", "represent", "the", "init", "state", "of", "*", "all", "the", "features", "managed", "by", "the", "xsave", "*", "/", "init_xstate_buf", "=", "alloc_bootmem_align", "(", "xstate_size", ",", "__alignof__", "(", "struct", "xsave_struct", ")", ");", "init_xstate_buf", "-", ">", "i387", ".", "mxcsr", "=", "MXCSR_DEFAULT", ";", "fx_finit", "(", "&", "init_xstate_buf", "-", ">", "i387", ")", ";", "if", "(", "!", "cpu_has_xsave", ")", "return", ";", "setup_xstate_features", "(", ");", "/", "*", "*", "Init", "all", "the", "features", "state", "with", "header_bv", "being", "0x0", "@", "@", "-", "523", ",", "6", "+", "508", ",", "17", "@", "@", "static", "void", "__init", "setup_xstate_init", "(", "void", ")", "xsave_state", "(", "init_xstate_buf", ",", "-", "1", ")", ";", "}", "static", "int", "disable_eagerfpu", ";", "static", "int", "__init", "eager_fpu_setup", "(", "char", "*", "s", ")", "{", "if", "(", "!", "strcmp", "(", "s", ",", "\"", "on", "\"", "))", "setup_force_cpu_cap", "(", "X86_FEATURE_EAGER_FPU", ")", ";", "else", "if", "(", "!", "strcmp", "(", "s", ",", "\"", "off", "\"", "))", "disable_eagerfpu", "=", "1", ";", "return", "1", ";", "}", "__setup", "(", "\"", "eagerfpu", "=", "\",", "eager_fpu_setup", ")", ";", "/", "*", "*", "Enable", "and", "initialize", "the", "xsave", "feature", ".", "*", "/", "@", "@", "-", "559", ",", "15", "+", "555", ",", "10", "@", "@", "static", "void", "__init", "xstate_enable_boot_cpu", "(", "void", ")", "update_regset_xstate_info", "(", "xstate_size", ",", "pcntxt_mask", ")", ";", "prepare_fx_sw_frame", "(", ");", "setup_xstate_init", "(", ");", "setup_init_fpu_buf", "(", ");", "pr_info", "(", "\"", "enabled", "xstate_bv", "0x", "%", "llx", ",", "cntxt", "size", "0x", "%", "x", "\\", "n", "\"", ",", "pcntxt_mask", ",", "xstate_size", ")", ";", "current", "-", ">", "thread", ".", "fpu", ".", "state", "=", "alloc_bootmem_align", "(", "xstate_size", ",", "__alignof__", "(", "struct", "xsave_struct", ")", ");", "init_restore_xstate", "(", ");", "}", "/", "*", "@", "@", "-", "586", ",", "6", "+", "577", ",", "42", "@", "@", "void", "__cpuinit", "xsave_init", "(", "void", ")", "return", ";", "this_func", "=", "next_func", ";", "next_func", "=", "xstate_enable_ap", ";", "next_func", "=", "xstate_enable", ";", "this_func", "(", ");", "}", "static", "inline", "void", "__init", "eager_fpu_init_bp", "(", "void", ")", "{", "current", "-", ">", "thread", ".", "fpu", ".", "state", "=", "alloc_bootmem_align", "(", "xstate_size", ",", "__alignof__", "(", "struct", "xsave_struct", ")", ");", "if", "(", "!", "init_xstate_buf", ")", "setup_init_fpu_buf", "(", ");", "}", "void", "__cpuinit", "eager_fpu_init", "(", "void", ")", "{", "static", "__refdata", "void", "(", "*", "boot_func", ")", "(", "void", ")", "=", "eager_fpu_init_bp", ";", "clear_used_math", "(", ");", "current_thread_info", "(", ")-", ">", "status", "=", "0", ";", "if", "(", "!", "cpu_has_eager_fpu", ")", "{", "stts", "(", ");", "return", ";", "}", "if", "(", "boot_func", ")", "{", "boot_func", "(", ");", "boot_func", "=", "NULL", ";", "}", "/", "*", "*", "This", "is", "same", "as", "math_state_restore", "(", ").", "But", "use_xsave", "(", ")", "is", "*", "not", "yet", "patched", "to", "use", "math_state_restore", "(", ").", "*", "/", "init_fpu", "(", "current", ")", ";", "__thread_fpu_begin", "(", "current", ")", ";", "if", "(", "cpu_has_xsave", ")", "xrstor_state", "(", "init_xstate_buf", ",", "-", "1", ")", ";", "else", "fxrstor_checking", "(", "&", "init_xstate_buf", "-", ">", "i387", ")", ";", "}"], "docstring_tokens": ["the", "cache", "line", "was", "pulled", "in", "by", "the", "speculatively", "executed", "code"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "556", ",", "7", "+", "556", ",", "7", "@", "@", "static", "char", "*", "php_ap_basename", "(", "const", "zend_encoding", "*", "encoding", ",", "char", "*", "path", "TSRMLS_DC", "{", "char", "*", "s", "=", "strrchr", "(", "path", ",", "'", "\\\\", "')", ";", "char", "*", "s2", "=", "strrchr", "(", "path", ",", "'", "/'", ");", "if", "(", "s", "&", "&", "s2", ")", "{", "if", "(", "s", ">", "s2", ")", "{", "+", "+", "s", ";", "@", "@", "-", "942", ",", "6", "+", "942", ",", "10", "@", "@", "SAPI_API", "SAPI_POST_HANDLER_FUNC", "(", "rfc1867_post_handler", ")", "/", "*", "{", "{{", "*", "/", "}", "tmp", "+", "+;", "}", "/", "*", "Brackets", "should", "always", "be", "closed", "*", "/", "if", "(", "c", "!", "=", "0", ")", "{", "skip_upload", "=", "1", ";", "}", "}", "total_bytes", "=", "cancel_upload", "=", "0", ";", "@", "@", "-", "977", ",", "7", "+", "981", ",", "7", "@", "@", "SAPI_API", "SAPI_POST_HANDLER_FUNC", "(", "rfc1867_post_handler", ")", "/", "*", "{", "{{", "*", "/", "offset", "=", "0", ";", "end", "=", "0", ";", "if", "(", "!", "cancel_upload", ")", "{", "/", "*", "only", "bother", "to", "open", "temp", "file", "if", "we", "have", "data", "*", "/", "blen", "=", "multipart_buffer_read", "(", "mbuff", ",", "buff", ",", "sizeof", "(", "buff", ")", ",", "&", "end", "TSRMLS_CC", ")", ";", "@", "@", "-", "1275", ",", "7", "+", "1279", ",", "7", "@", "@", "SAPI_API", "void", "php_rfc1867_set_multibyte_callbacks", "(", "php_rfc1867_getword", "=", "getword", ";", "php_rfc1867_getword_conf", "=", "getword_conf", ";", "php_rfc1867_basename", "=", "basename", ";", "}", "}", "/", "*", "}", "}}", "*", "/", "/", "*", "@", "@", "-", "0", ",", "0", "+", "1", ",", "67", "@", "@", "-", "-", "TEST", "-", "-", "Bug", "#", "55500", "(", "Corrupted", "$", "_FILES", "indices", "lead", "to", "security", "concern", ")", "-", "-", "INI", "-", "-", "file_uploads", "=", "1", "error_reporting", "=", "E_ALL", "&", "~", "E_NOTICE", "upload_max_filesize", "=", "1024", "-", "-", "POST_RAW", "-", "-", "Content", "-", "Type", ":", "multipart", "/", "form", "-", "data", ";", "boundary", "=", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "-", "20896060251896012921717172737", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "20896060251896012921717172737", "Content", "-", "Disposition", ":", "form", "-", "data", ";", "name", "=", "\"", "file", "[", "]\"", ";", "filename", "=", "\"", "file1", ".", "txt", "\"", "Content", "-", "Type", ":", "text", "/", "plain", "-", "file1", "1", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "20896060251896012921717172737", "Content", "-", "Disposition", ":", "form", "-", "data", ";", "name", "=", "\"", "file", "[", "[", "type", "]", "\";", "filename", "=", "\"", "file2", ".", "txt", "\"", "Content", "-", "Type", ":", "text", "/", "plain", "-", "file2", "2", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "20896060251896012921717172737", "Content", "-", "Disposition", ":", "form", "-", "data", ";", "name", "=", "\"", "file", "[", "[", "name", "]", "\";", "filename", "=", "\"", "file3", ".", "txt", "\"", "Content", "-", "Type", ":", "text", "/", "plain", "-", "file3", "3", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "20896060251896012921717172737", "Content", "-", "Disposition", ":", "form", "-", "data", ";", "name", "=", "\"", "file", "[", "name", "]", "[\"", ";", "filename", "=", "\"", "file4", ".", "txt", "\"", "Content", "-", "Type", ":", "text", "/", "plain", "-", "file3", "4", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "20896060251896012921717172737", "-", "-", "-", "-", "FILE", "-", "-", "<", "?", "php", "var_dump", "(", "$", "_FILES", ")", ";", "var_dump", "(", "$", "_POST", ")", ";", "?", ">", "-", "-", "EXPECTF", "-", "-", "array", "(", "1", ")", "{", "[", "%", "u", "|", "b", "%", "\"", "file", "\"", "]=", ">", "array", "(", "5", ")", "{", "[", "%", "u", "|", "b", "%", "\"", "name", "\"", "]=", ">", "array", "(", "1", ")", "{", "[", "0", "]", "=>", "%", "unicode", "|", "string", "%", "(", "9", ")", "\"", "file1", ".", "txt", "\"", "}", "[", "%", "u", "|", "b", "%", "\"", "type", "\"", "]=", ">", "array", "(", "1", ")", "{", "[", "0", "]", "=>", "%", "unicode", "|", "string", "%", "(", "16", ")", "\"", "text", "/", "plain", "-", "file1", "\"", "}", "[", "%", "u", "|", "b", "%", "\"", "tmp_name", "\"", "]=", ">", "array", "(", "1", ")", "{", "[", "0", "]", "=>", "%", "unicode", "|", "string", "%", "(%", "d", ")", "\"", "%", "s", "\"", "}", "[", "%", "u", "|", "b", "%", "\"", "error", "\"", "]=", ">", "array", "(", "1", ")", "{", "[", "0", "]", "=>", "int", "(", "0", ")", "}", "[", "%", "u", "|", "b", "%", "\"", "size", "\"", "]=", ">", "array", "(", "1", ")", "{", "[", "0", "]", "=>", "int", "(", "1", ")", "}", "}", "}", "array", "(", "0", ")", "{", "}"], "docstring_tokens": ["does", "not", "properly", "handle", "invalid", "[", "(open", "square", "bracket", ")", "characters", "in", "name", "values"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "42", ",", "7", "+", "42", ",", "7", "@", "@", "public", "FormattedServiceListWriter", "(", "String", "styleSheetPath", ",", "String", "title", ",", "boolean", "showForeignContexts", ",", "Bus", "bus", ")", "{", "this", ".", "styleSheetPath", "=", "styleSheetPath", ";", "this", ".", "styleSheetPath", "=", "StringEscapeUtils", ".", "escapeHtml4", "(", "styleSheetPath", ")", ";", "this", ".", "title", "=", "title", ";", "this", ".", "showForeignContexts", "=", "showForeignContexts", ";", "this", ".", "bus", "=", "bus", ";"], "docstring_tokens": ["improper", "validation", "of", "user-supplied", "input"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "0", ",", "0", "+", "1", ",", "14", "@", "@", "-", "-", "TEST", "-", "-", "Bug", "#", "60227", "(", "header", "(", ")", "cannot", "detect", "the", "multi", "-", "line", "header", "with", "CR", ")", ",", "\\", "r", "before", "\\", "n", "-", "-", "FILE", "-", "-", "<", "?", "php", "header", "(", "\"", "X", "-", "foo", ":", "e", "\\", "n", "foo", "\"", ");", "header", "(", "\"", "X", "-", "Foo6", ":", "e", "\\", "rSet", "-", "Cookie", ":", "ID", "=", "123", "\\", "n", "d", "\"", ");", "echo", "'", "foo", "'", ";", "?", ">", "-", "-", "EXPECTF", "-", "-", "Warning", ":", "Header", "may", "not", "contain", "more", "than", "a", "single", "header", ",", "new", "line", "detected", ".", "in", "%", "s", "on", "line", "%", "d", "foo", "-", "-", "EXPECTHEADERS", "-", "-", "X", "-", "foo", ":", "e", "foo", "@", "@", "-", "711", ",", "10", "+", "711", ",", "11", "@", "@", "SAPI_API", "int", "sapi_header_op", "(", "sapi_header_op_enum", "op", ",", "void", "*", "arg", "TSRMLS_DC", ")", "return", "SUCCESS", ";", "}", "else", "{", "/", "*", "new", "line", "safety", "check", "*", "/", "char", "*", "s", "=", "header_line", ",", "*", "e", "=", "header_line", "+", "header_line_len", ",", "*", "p", ";", "while", "(", "s", "<", "e", "&", "&", "(", "(", "p", "=", "memchr", "(", "s", ",", "'", "\\", "n", "'", ",", "(", "e", "-", "s", ")", "))", "|", "|", "(", "p", "=", "memchr", "(", "s", ",", "'", "\\", "r", "'", ",", "(", "e", "-", "s", ")", "))", "))", "{", "if", "(", "*(", "p", "+", "1", ")", "=", "=", "'", "'", "|", "|", "*", "(", "p", "+", "1", ")", "=", "=", "'", "\\", "t", "'", ")", "{", "s", "=", "p", "+", "1", ";", "char", "*", "s", "=", "header_line", ";", "while", "(", "s", "=", "strpbrk", "(", "s", ",", "\"", "\\", "n", "\\", "r", "\"", "))", "{", "if", "(", "s", "[", "1", "]", "=", "=", "'", "'", "|", "|", "s", "[", "1", "]", "=", "=", "'", "\\", "t", "'", ")", "{", "/", "*", "RFC", "2616", "allows", "new", "lines", "if", "followed", "by", "SP", "or", "HT", "*", "/", "s", "+", "+;", "continue", ";", "}", "efree", "(", "header_line", ")", ";"], "docstring_tokens": ["does", "not", "properly", "determine", "a", "pointer", "during", "checks", "for", "%0D", "sequences", "(aka", "carriage", "return", "characters)"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "212", ",", "9", "+", "212", ",", "21", "@", "@", "private", "boolean", "isIdentityRemoved", "(", "WebSubjectContext", "subjectContext", ")", "{", "if", "(", "log", ".", "isTraceEnabled", "(", "))", "{", "log", ".", "trace", "(", "\"", "Acquired", "Base64", "encoded", "identity", "[", "\"", "+", "base64", "+", "\"", "]\"", ");", "}", "byte", "[", "]", "decoded", "=", "Base64", ".", "decode", "(", "base64", ")", ";", "byte", "[", "]", "decoded", ";", "try", "{", "decoded", "=", "Base64", ".", "decode", "(", "base64", ")", ";", "}", "catch", "(", "RuntimeException", "rtEx", ")", "{", "/", "*", "*", "https", ":", "//", "issues", ".", "apache", ".", "org", "/", "jira", "/", "browse", "/", "SHIRO", "-", "766", ":", "*", "If", "the", "base64", "string", "cannot", "be", "decoded", ",", "just", "assume", "there", "is", "no", "valid", "cookie", "value", ".", "*", "*", "/", "getCookie", "(", ").", "removeFrom", "(", "request", ",", "response", ")", ";", "log", ".", "warn", "(", "\"", "Unable", "to", "decode", "existing", "base64", "encoded", "entity", ":", "[", "\"", "+", "base64", "+", "\"", "].", "\",", "rtEx", ")", ";", "return", "null", ";", "}", "if", "(", "log", ".", "isTraceEnabled", "(", "))", "{", "log", ".", "trace", "(", "\"", "Base64", "decoded", "byte", "array", "length", ":", "\"", "+", "(", "decoded", "!", "=", "null", "?", "decoded", ".", "length", ":", "0", ")", "+", "\"", "bytes", ".", "\")", ";", "log", ".", "trace", "(", "\"", "Base64", "decoded", "byte", "array", "length", ":", "\"", "+", "decoded", ".", "length", "+", "\"", "bytes", ".", "\")", ";", "}", "return", "decoded", ";", "}", "else", "{", "@", "@", "-", "35", ",", "6", "+", "35", ",", "8", "@", "@", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletRequest", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletResponse", ";", "import", "java", ".", "util", ".", "UUID", ";", "import", "static", "org", ".", "easymock", ".", "EasyMock", ".", "*;", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*;", "@", "@", "-", "244", ",", "4", "+", "246", ",", "30", "@", "@", "public", "void", "onLogout", "(", ")", "{", "verify", "(", "mockResponse", ")", ";", "verify", "(", "cookie", ")", ";", "}", "@", "Test", "public", "void", "shouldIgnoreInvalidCookieValues", "(", ")", "{", "/", "/", "given", "HttpServletRequest", "mockRequest", "=", "createMock", "(", "HttpServletRequest", ".", "class", ")", ";", "HttpServletResponse", "mockResponse", "=", "createMock", "(", "HttpServletResponse", ".", "class", ")", ";", "WebSubjectContext", "context", "=", "new", "DefaultWebSubjectContext", "(", ");", "context", ".", "setServletRequest", "(", "mockRequest", ")", ";", "context", ".", "setServletResponse", "(", "mockResponse", ")", ";", "CookieRememberMeManager", "mgr", "=", "new", "CookieRememberMeManager", "(", ");", "Cookie", "[", "]", "cookies", "=", "new", "Cookie", "[", "]{", "new", "Cookie", "(", "CookieRememberMeManager", ".", "DEFAULT_REMEMBER_ME_COOKIE_NAME", ",", "UUID", ".", "randomUUID", "(", ").", "toString", "(", ")", "+", "\"", "%%", "ldapRealm", "\"", ")", "}", ";", "expect", "(", "mockRequest", ".", "getAttribute", "(", "ShiroHttpServletRequest", ".", "IDENTITY_REMOVED_KEY", ")", ").", "andReturn", "(", "null", ")", ";", "expect", "(", "mockRequest", ".", "getContextPath", "(", "))", ".", "andReturn", "(", "null", ")", ";", "expect", "(", "mockRequest", ".", "getCookies", "(", "))", ".", "andReturn", "(", "cookies", ")", ";", "replay", "(", "mockRequest", ")", ";", "/", "/", "when", "final", "byte", "[", "]", "rememberedSerializedIdentity", "=", "mgr", ".", "getRememberedSerializedIdentity", "(", "context", ")", ";", "/", "/", "then", "assertNull", "(", "\"", "should", "ignore", "invalid", "cookie", "values", "\"", ",", "rememberedSerializedIdentity", ")", ";", "}", "}"], "docstring_tokens": ["improper", "authentication", "validation"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "22", ",", "6", "+", "22", ",", "9", "@", "@", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "plaincredentials", ".", "StringCredentials", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "QueryParameter", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "interceptor", ".", "RequirePOST", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "Restricted", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "restrictions", ".", "DoNotUse", ";", "import", "javax", ".", "ws", ".", "rs", ".", "ProcessingException", ";", "import", "javax", ".", "ws", ".", "rs", ".", "WebApplicationException", ";", "@", "@", "-", "131", ",", "12", "+", "134", ",", "15", "@", "@", "public", "FormValidation", "doCheckReadTimeout", "(", "@", "QueryParameter", "Integer", "value", ")", "{", "}", "}", "@", "RequirePOST", "@", "Restricted", "(", "DoNotUse", ".", "class", ")", "/", "/", "WebOnly", "public", "FormValidation", "doTestConnection", "(", "@", "QueryParameter", "String", "url", ",", "@", "QueryParameter", "String", "apiTokenId", ",", "@", "QueryParameter", "String", "clientBuilderId", ",", "@", "QueryParameter", "boolean", "ignoreCertificateErrors", ",", "@", "QueryParameter", "int", "connectionTimeout", ",", "@", "QueryParameter", "int", "readTimeout", ")", "{", "Jenkins", ".", "getActiveInstance", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "try", "{", "new", "GitLabConnection", "(", "\"\"", ",", "url", ",", "apiTokenId", ",", "clientBuilderId", ",", "ignoreCertificateErrors", ",", "connectionTimeout", ",", "readTimeout", ")", ".", "getClient", "(", ").", "getCurrentUser", "(", ");", "return", "FormValidation", ".", "ok", "(", "Messages", ".", "connection_success", "(", "))", ";"], "docstring_tokens": ["improper", "permission", "validation"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2974", ",", "7", "+", "2974", ",", "6", "@", "@", "static", "void", "binder_transaction", "(", "struct", "binder_proc", "*", "proc", ",", "t", "-", ">", "buffer", "=", "NULL", ";", "goto", "err_binder_alloc_buf_failed", ";", "}", "t", "-", ">", "buffer", "-", ">", "allow_user_free", "=", "0", ";", "t", "-", ">", "buffer", "-", ">", "debug_id", "=", "t", "-", ">", "debug_id", ";", "t", "-", ">", "buffer", "-", ">", "transaction", "=", "t", ";", "t", "-", ">", "buffer", "-", ">", "target_node", "=", "target_node", ";", "@", "@", "-", "3510", ",", "14", "+", "3509", ",", "18", "@", "@", "static", "int", "binder_thread_write", "(", "struct", "binder_proc", "*", "proc", ",", "buffer", "=", "binder_alloc_prepare_to_free", "(", "&", "proc", "-", ">", "alloc", ",", "data_ptr", ")", ";", "if", "(", "buffer", "=", "=", "NULL", ")", "{", "binder_user_error", "(", "\"%", "d", ":", "%", "d", "BC_FREE_BUFFER", "u", "%", "016llx", "no", "match", "\\", "n", "\"", ",", "proc", "-", ">", "pid", ",", "thread", "-", ">", "pid", ",", "(", "u64", ")", "data_ptr", ")", ";", "break", ";", "}", "if", "(", "!", "buffer", "-", ">", "allow_user_free", ")", "{", "binder_user_error", "(", "\"%", "d", ":", "%", "d", "BC_FREE_BUFFER", "u", "%", "016llx", "matched", "unreturned", "buffer", "\\", "n", "\"", ",", "proc", "-", ">", "pid", ",", "thread", "-", ">", "pid", ",", "(", "u64", ")", "data_ptr", ")", ";", "if", "(", "IS_ERR_OR_NULL", "(", "buffer", ")", ")", "{", "if", "(", "PTR_ERR", "(", "buffer", ")", "=", "=", "-", "EPERM", ")", "{", "binder_user_error", "(", "\"", "%", "d", ":", "%", "d", "BC_FREE_BUFFER", "u", "%", "016llx", "matched", "unreturned", "or", "currently", "freeing", "buffer", "\\", "n", "\"", ",", "proc", "-", ">", "pid", ",", "thread", "-", ">", "pid", ",", "(", "u64", ")", "data_ptr", ")", ";", "}", "else", "{", "binder_user_error", "(", "\"", "%", "d", ":", "%", "d", "BC_FREE_BUFFER", "u", "%", "016llx", "no", "match", "\\", "n", "\"", ",", "proc", "-", ">", "pid", ",", "thread", "-", ">", "pid", ",", "(", "u64", ")", "data_ptr", ")", ";", "}", "break", ";", "}", "binder_debug", "(", "BINDER_DEBUG_FREE_BUFFER", ",", "@", "@", "-", "151", ",", "16", "+", "151", ",", "12", "@", "@", "static", "struct", "binder_buffer", "*", "binder_alloc_prepare_to_free_locked", "(", "else", "{", "/", "*", "*", "Guard", "against", "user", "threads", "attempting", "to", "*", "free", "the", "buffer", "twice", "*", "free", "the", "buffer", "when", "in", "use", "by", "kernel", "or", "*", "after", "it", "'", "s", "already", "been", "freed", ".", "*", "/", "if", "(", "buffer", "-", ">", "free_in_progress", ")", "{", "binder_alloc_debug", "(", "BINDER_DEBUG_USER_ERROR", ",", "\"", "%", "d", ":", "%", "d", "FREE_BUFFER", "u", "%", "016llx", "user", "freed", "buffer", "twice", "\\", "n", "\"", ",", "alloc", "-", ">", "pid", ",", "current", "-", ">", "pid", ",", "(", "u64", ")", "user_ptr", ")", ";", "return", "NULL", ";", "}", "buffer", "-", ">", "free_in_progress", "=", "1", ";", "if", "(", "!", "buffer", "-", ">", "allow_user_free", ")", "return", "ERR_PTR", "(", "-", "EPERM", ")", ";", "buffer", "-", ">", "allow_user_free", "=", "0", ";", "return", "buffer", ";", "}", "}", "@", "@", "-", "500", ",", "7", "+", "496", ",", "7", "@", "@", "static", "struct", "binder_buffer", "*", "binder_alloc_new_buf_locked", "(", "rb_erase", "(", "best_fit", ",", "&", "alloc", "-", ">", "free_buffers", ")", ";", "buffer", "-", ">", "free", "=", "0", ";", "buffer", "-", ">", "free_in_progress", "=", "0", ";", "buffer", "-", ">", "allow_user_free", "=", "0", ";", "binder_insert_allocated_buffer_locked", "(", "alloc", ",", "buffer", ")", ";", "binder_alloc_debug", "(", "BINDER_DEBUG_BUFFER_ALLOC", ",", "\"", "%", "d", ":", "binder_alloc_buf", "size", "%", "zd", "got", "%", "pK", "\\", "n", "\"", ",", "@", "@", "-", "50", ",", "8", "+", "50", ",", "7", "@", "@", "struct", "binder_buffer", "{", "unsigned", "free", ":", "1", ";", "unsigned", "allow_user_free", ":", "1", ";", "unsigned", "async_transaction", ":", "1", ";", "unsigned", "free_in_progress", ":", "1", ";", "unsigned", "debug_id", ":", "28", ";", "unsigned", "debug_id", ":", "29", ";", "struct", "binder_transaction", "*", "transaction", ";"], "docstring_tokens": ["the", "bit", "remains", "1", "from", "the", "previous", "use"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "3517", ",", "7", "+", "3517", ",", "7", "@", "@", "PHP_FUNCTION", "(", "curl_reset", ")", "PHP_FUNCTION", "(", "curl_escape", ")", "{", "char", "*", "str", "=", "NULL", ",", "*", "res", "=", "NULL", ";", "size_t", "str_len", "=", "0", ";", "size_t", "str_len", "=", "0", ";", "zval", "*", "zid", ";", "php_curl", "*", "ch", ";", "@", "@", "-", "3529", ",", "6", "+", "3529", ",", "10", "@", "@", "PHP_FUNCTION", "(", "curl_escape", ")", "RETURN_FALSE", ";", "}", "if", "(", "ZEND_SIZE_T_INT_OVFL", "(", "str_len", ")", ")", "{", "RETURN_FALSE", ";", "}", "if", "(", "(", "res", "=", "curl_easy_escape", "(", "ch", "-", ">", "cp", ",", "str", ",", "str_len", ")", "))", "{", "RETVAL_STRING", "(", "res", ")", ";", "curl_free", "(", "res", ")", ";", "@", "@", "-", "3556", ",", "7", "+", "3560", ",", "7", "@", "@", "PHP_FUNCTION", "(", "curl_unescape", ")", "RETURN_FALSE", ";", "}", "if", "(", "str_len", ">", "INT_MAX", ")", "{", "if", "(", "ZEND_SIZE_T_INT_OVFL", "(", "str_len", ")", ")", "{", "RETURN_FALSE", ";", "}"], "docstring_tokens": ["does", "not", "work", "around", "a", "libcurl", "integer", "overflow"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1154", ",", "8", "+", "1154", ",", "6", "@", "@", "static", "int", "snd_ctl_elem_add", "(", "struct", "snd_ctl_file", "*", "file", ",", "struct", "user_element", "*", "ue", ";", "int", "idx", ",", "err", ";", "if", "(", "!", "replace", "&", "&", "card", "-", ">", "user_ctl_count", ">", "=", "MAX_USER_CONTROLS", ")", "return", "-", "ENOMEM", ";", "if", "(", "info", "-", ">", "count", "<", "1", ")", "return", "-", "EINVAL", ";", "access", "=", "info", "-", ">", "access", "=", "=", "0", "?", "SNDRV_CTL_ELEM_ACCESS_READWRITE", ":", "@", "@", "-", "1164", ",", "21", "+", "1162", ",", "16", "@", "@", "static", "int", "snd_ctl_elem_add", "(", "struct", "snd_ctl_file", "*", "file", ",", "SNDRV_CTL_ELEM_ACCESS_TLV_READWRITE", ")", ");", "info", "-", ">", "id", ".", "numid", "=", "0", ";", "memset", "(", "&", "kctl", ",", "0", ",", "sizeof", "(", "kctl", ")", ");", "down_write", "(", "&", "card", "-", ">", "controls_rwsem", ")", ";", "_kctl", "=", "snd_ctl_find_id", "(", "card", ",", "&", "info", "-", ">", "id", ")", ";", "err", "=", "0", ";", "if", "(", "_kctl", ")", "{", "if", "(", "replace", ")", "err", "=", "snd_ctl_remove", "(", "card", ",", "_kctl", ")", ";", "else", "err", "=", "-", "EBUSY", ";", "}", "else", "{", "if", "(", "replace", ")", "err", "=", "-", "ENOENT", ";", "if", "(", "replace", ")", "{", "err", "=", "snd_ctl_remove_user_ctl", "(", "file", ",", "&", "info", "-", ">", "id", ")", ";", "if", "(", "err", ")", "return", "err", ";", "}", "up_write", "(", "&", "card", "-", ">", "controls_rwsem", ")", ";", "if", "(", "err", "<", "0", ")", "return", "err", ";", "if", "(", "card", "-", ">", "user_ctl_count", ">", "=", "MAX_USER_CONTROLS", ")", "return", "-", "ENOMEM", ";", "memcpy", "(", "&", "kctl", ".", "id", ",", "&", "info", "-", ">", "id", ",", "sizeof", "(", "info", "-", ">", "id", ")", ");", "kctl", ".", "count", "=", "info", "-", ">", "owner", "?", "info", "-", ">", "owner", ":", "1", ";", "access", "|", "=", "SNDRV_CTL_ELEM_ACCESS_USER", ";"], "docstring_tokens": ["does", "not", "check", "authorization", "for", "SNDRV_CTL_IOCTL_ELEM_REPLACE", "commands"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "0", ",", "0", "+", "1", ",", "11", "@", "@", "set", "hive", ".", "test", ".", "authz", ".", "sstd", ".", "hs2", ".", "mode", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "sqlstd", ".", "SQLStdHiveAuthorizerFactoryForTest", ";", "set", "hive", ".", "security", ".", "authenticator", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "SessionStateConfigUserAuthenticator", ";", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "true", ";", "-", "-", "check", "alter", "-", "drop", "on", "partition", "create", "table", "auth_trunc2", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", ";", "alter", "table", "auth_trunc2", "add", "partition", "(", "j", "=", "42", ")", ";", "set", "user", ".", "name", "=", "user1", ";", "alter", "table", "auth_trunc2", "drop", "partition", "(", "j", "=", "42", ")", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "19", "@", "@", "set", "hive", ".", "test", ".", "authz", ".", "sstd", ".", "hs2", ".", "mode", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "sqlstd", ".", "SQLStdHiveAuthorizerFactoryForTest", ";", "set", "hive", ".", "security", ".", "authenticator", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "SessionStateConfigUserAuthenticator", ";", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "true", ";", "dfs", "$", "{", "system", ":", "test", ".", "dfs", ".", "mkdir", "}", "$", "{", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "export", "/", "temp", ";", "dfs", "-", "rmr", "$", "{", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "export", ";", "dfs", "$", "{", "system", ":", "test", ".", "dfs", ".", "mkdir", "}", "$", "{", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "export", "/", ";", "-", "-", "check", "export", "on", "partition", "create", "table", "auth_export_ptn", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", ";", "alter", "table", "auth_export_ptn", "add", "partition", "(", "j", "=", "42", ")", ";", "set", "user", ".", "name", "=", "user1", ";", "export", "table", "auth_export_ptn", "partition", "(", "j", "=", "42", ")", "to", "'", "pfile", ":", "//", "${", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "export", "'", ";", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "false", ";", "drop", "table", "auth_export_ptn", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "23", "@", "@", "set", "hive", ".", "test", ".", "authz", ".", "sstd", ".", "hs2", ".", "mode", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "sqlstd", ".", "SQLStdHiveAuthorizerFactoryForTest", ";", "set", "hive", ".", "security", ".", "authenticator", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "SessionStateConfigUserAuthenticator", ";", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "true", ";", "dfs", "$", "{", "system", ":", "test", ".", "dfs", ".", "mkdir", "}", "$", "{", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "import", "/", "temp", ";", "dfs", "-", "rmr", "$", "{", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "import", ";", "dfs", "$", "{", "system", ":", "test", ".", "dfs", ".", "mkdir", "}", "$", "{", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "import", "/", ";", "-", "-", "check", "export", "on", "partition", "create", "table", "auth_import_ptn", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", ";", "alter", "table", "auth_import_ptn", "add", "partition", "(", "j", "=", "42", ")", ";", "export", "table", "auth_import_ptn", "partition", "(", "j", "=", "42", ")", "to", "'", "pfile", ":", "//", "${", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "import", "'", ";", "alter", "table", "auth_import_ptn", "drop", "partition", "(", "j", "=", "42", ")", ";", "set", "user", ".", "name", "=", "user1", ";", "import", "table", "auth_import_ptn", "partition", "(", "j", "=", "42", ")", "from", "'", "pfile", ":", "//", "${", "system", ":", "test", ".", "tmp", ".", "dir", "}", "/", "hive", "-", "12875", "-", "import", "'", ";", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "false", ";", "drop", "table", "auth_import_ptn", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "11", "@", "@", "set", "hive", ".", "test", ".", "authz", ".", "sstd", ".", "hs2", ".", "mode", "=", "true", ";", "set", "hive", ".", "security", ".", "authorization", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "authorization", ".", "plugin", ".", "sqlstd", ".", "SQLStdHiveAuthorizerFactoryForTest", ";", "set", "hive", ".", "security", ".", "authenticator", ".", "manager", "=", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "security", ".", "SessionStateConfigUserAuthenticator", ";", "set", "hive", ".", "security", ".", "authorization", ".", "enabled", "=", "true", ";", "-", "-", "check", "truncate", "on", "partition", "create", "table", "auth_trunc2", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", ";", "alter", "table", "auth_trunc2", "add", "partition", "(", "j", "=", "42", ")", ";", "set", "user", ".", "name", "=", "user1", ";", "truncate", "table", "auth_trunc2", "partition", "(", "j", "=", "42", ")", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "18", "@", "@", "PREHOOK", ":", "query", ":", "-", "-", "check", "alter", "-", "drop", "on", "partition", "create", "table", "auth_trunc2", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", "PREHOOK", ":", "type", ":", "CREATETABLE", "PREHOOK", ":", "Output", ":", "database", ":", "default", "PREHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "POSTHOOK", ":", "query", ":", "-", "-", "check", "alter", "-", "drop", "on", "partition", "create", "table", "auth_trunc2", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", "POSTHOOK", ":", "type", ":", "CREATETABLE", "POSTHOOK", ":", "Output", ":", "database", ":", "default", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "PREHOOK", ":", "query", ":", "alter", "table", "auth_trunc2", "add", "partition", "(", "j", "=", "42", ")", "PREHOOK", ":", "type", ":", "ALTERTABLE_ADDPARTS", "PREHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "POSTHOOK", ":", "query", ":", "alter", "table", "auth_trunc2", "add", "partition", "(", "j", "=", "42", ")", "POSTHOOK", ":", "type", ":", "ALTERTABLE_ADDPARTS", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "@", "j", "=", "42", "FAILED", ":", "HiveAccessControlException", "Permission", "denied", ":", "Principal", "[", "name", "=", "user1", ",", "type", "=", "USER", "]", "does", "not", "have", "following", "privileges", "for", "operation", "ALTERTABLE_DROPPARTS", "[", "[", "DELETE", "]", "on", "Object", "[", "type", "=", "TABLE_OR_VIEW", ",", "name", "=", "default", ".", "auth_trunc2", "]", "]", "@", "@", "-", "0", ",", "0", "+", "1", ",", "19", "@", "@", "#", "##", "#", "A", "masked", "pattern", "was", "here", "#", "##", "#", "PREHOOK", ":", "query", ":", "-", "-", "check", "export", "on", "partition", "create", "table", "auth_export_ptn", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", "PREHOOK", ":", "type", ":", "CREATETABLE", "PREHOOK", ":", "Output", ":", "database", ":", "default", "PREHOOK", ":", "Output", ":", "default", "@", "auth_export_ptn", "POSTHOOK", ":", "query", ":", "-", "-", "check", "export", "on", "partition", "create", "table", "auth_export_ptn", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", "POSTHOOK", ":", "type", ":", "CREATETABLE", "POSTHOOK", ":", "Output", ":", "database", ":", "default", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_export_ptn", "PREHOOK", ":", "query", ":", "alter", "table", "auth_export_ptn", "add", "partition", "(", "j", "=", "42", ")", "PREHOOK", ":", "type", ":", "ALTERTABLE_ADDPARTS", "PREHOOK", ":", "Output", ":", "default", "@", "auth_export_ptn", "POSTHOOK", ":", "query", ":", "alter", "table", "auth_export_ptn", "add", "partition", "(", "j", "=", "42", ")", "POSTHOOK", ":", "type", ":", "ALTERTABLE_ADDPARTS", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_export_ptn", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_export_ptn", "@", "j", "=", "42", "#", "##", "#", "A", "masked", "pattern", "was", "here", "#", "##", "#", "@", "@", "-", "0", ",", "0", "+", "1", ",", "34", "@", "@", "#", "##", "#", "A", "masked", "pattern", "was", "here", "#", "##", "#", "PREHOOK", ":", "query", ":", "-", "-", "check", "export", "on", "partition", "create", "table", "auth_import_ptn", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", "PREHOOK", ":", "type", ":", "CREATETABLE", "PREHOOK", ":", "Output", ":", "database", ":", "default", "PREHOOK", ":", "Output", ":", "default", "@", "auth_import_ptn", "POSTHOOK", ":", "query", ":", "-", "-", "check", "export", "on", "partition", "create", "table", "auth_import_ptn", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", "POSTHOOK", ":", "type", ":", "CREATETABLE", "POSTHOOK", ":", "Output", ":", "database", ":", "default", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_import_ptn", "PREHOOK", ":", "query", ":", "alter", "table", "auth_import_ptn", "add", "partition", "(", "j", "=", "42", ")", "PREHOOK", ":", "type", ":", "ALTERTABLE_ADDPARTS", "PREHOOK", ":", "Output", ":", "default", "@", "auth_import_ptn", "POSTHOOK", ":", "query", ":", "alter", "table", "auth_import_ptn", "add", "partition", "(", "j", "=", "42", ")", "POSTHOOK", ":", "type", ":", "ALTERTABLE_ADDPARTS", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_import_ptn", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_import_ptn", "@", "j", "=", "42", "#", "##", "#", "A", "masked", "pattern", "was", "here", "#", "##", "#", "PREHOOK", ":", "type", ":", "EXPORT", "PREHOOK", ":", "Input", ":", "default", "@", "auth_import_ptn", "@", "j", "=", "42", "#", "##", "#", "A", "masked", "pattern", "was", "here", "#", "##", "#", "POSTHOOK", ":", "type", ":", "EXPORT", "POSTHOOK", ":", "Input", ":", "default", "@", "auth_import_ptn", "@", "j", "=", "42", "#", "##", "#", "A", "masked", "pattern", "was", "here", "#", "##", "#", "PREHOOK", ":", "query", ":", "alter", "table", "auth_import_ptn", "drop", "partition", "(", "j", "=", "42", ")", "PREHOOK", ":", "type", ":", "ALTERTABLE_DROPPARTS", "PREHOOK", ":", "Input", ":", "default", "@", "auth_import_ptn", "PREHOOK", ":", "Output", ":", "default", "@", "auth_import_ptn", "@", "j", "=", "42", "POSTHOOK", ":", "query", ":", "alter", "table", "auth_import_ptn", "drop", "partition", "(", "j", "=", "42", ")", "POSTHOOK", ":", "type", ":", "ALTERTABLE_DROPPARTS", "POSTHOOK", ":", "Input", ":", "default", "@", "auth_import_ptn", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_import_ptn", "@", "j", "=", "42", "#", "##", "#", "A", "masked", "pattern", "was", "here", "#", "##", "#", "@", "@", "-", "0", ",", "0", "+", "1", ",", "18", "@", "@", "PREHOOK", ":", "query", ":", "-", "-", "check", "truncate", "on", "partition", "create", "table", "auth_trunc2", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", "PREHOOK", ":", "type", ":", "CREATETABLE", "PREHOOK", ":", "Output", ":", "database", ":", "default", "PREHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "POSTHOOK", ":", "query", ":", "-", "-", "check", "truncate", "on", "partition", "create", "table", "auth_trunc2", "(", "i", "int", ")", "partitioned", "by", "(", "j", "int", ")", "POSTHOOK", ":", "type", ":", "CREATETABLE", "POSTHOOK", ":", "Output", ":", "database", ":", "default", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "PREHOOK", ":", "query", ":", "alter", "table", "auth_trunc2", "add", "partition", "(", "j", "=", "42", ")", "PREHOOK", ":", "type", ":", "ALTERTABLE_ADDPARTS", "PREHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "POSTHOOK", ":", "query", ":", "alter", "table", "auth_trunc2", "add", "partition", "(", "j", "=", "42", ")", "POSTHOOK", ":", "type", ":", "ALTERTABLE_ADDPARTS", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "POSTHOOK", ":", "Output", ":", "default", "@", "auth_trunc2", "@", "j", "=", "42", "FAILED", ":", "HiveAccessControlException", "Permission", "denied", ":", "Principal", "[", "name", "=", "user1", ",", "type", "=", "USER", "]", "does", "not", "have", "following", "privileges", "for", "operation", "TRUNCATETABLE", "[", "[", "OBJECT", "OWNERSHIP", "]", "on", "Object", "[", "type", "=", "TABLE_OR_VIEW", ",", "name", "=", "default", ".", "auth_trunc2", "]", "]"], "docstring_tokens": ["the", "partition-level", "privilege", "is", "not", "checked", "by", "the", "authorization", "framework"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "176", ",", "10", "+", "176", ",", "9", "@", "@", "else", "if", "(", "(", "scheme", "!", "=", "null", ")", "&", "&", "!", "scheme", ".", "equals", "(", "request", ".", "getScheme", "(", "))", ")", "{", "String", "result", "=", "link", ".", "toString", "(", ");", "if", "(", "result", ".", "indexOf", "(", "\"<", "script", ">", "\")", ">", "=", "0", ")", "{", "while", "(", "result", ".", "indexOf", "(", "\"<", "script", ">", "\")", ">", "0", ")", "{", "result", "=", "result", ".", "replaceAll", "(", "\"<", "script", ">", "\",", "\"", "script", "\"", ");", "}", "}", "try", "{", "result", "=", "encodeResult", "?", "response", ".", "encodeURL", "(", "result", ")", ":", "result", ";", "}", "catch", "(", "Exception", "ex", ")", "{"], "docstring_tokens": ["improper", "validation", "of", "user-supplied", "input"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "18", ",", "18", "+", "18", ",", "12", "@", "@", "*", "/", "package", "org", ".", "apache", ".", "syncope", ".", "client", ".", "cli", ".", "commands", ".", "configuration", ";", "import", "java", ".", "io", ".", "FileNotFoundException", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerConfigurationException", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerException", ";", "import", "org", ".", "apache", ".", "syncope", ".", "client", ".", "cli", ".", "Input", ";", "import", "org", ".", "apache", ".", "syncope", ".", "client", ".", "cli", ".", "util", ".", "XMLUtils", ";", "import", "org", ".", "apache", ".", "syncope", ".", "common", ".", "lib", ".", "SyncopeClientException", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "public", "class", "ConfigurationExport", "extends", "AbstractConfigurationCommand", "{", "@", "@", "-", "53", ",", "24", "+", "47", ",", "12", "@", "@", "public", "void", "export", "(", ")", "{", "input", ".", "firstParameter", "(", ")", "+", "EXPORT_FILE_NAME", ")", ";", "configurationResultManager", ".", "genericMessage", "(", "input", ".", "firstParameter", "(", ")", "+", "EXPORT_FILE_NAME", "+", "\"", "successfully", "created", "\"", ");", "}", "catch", "(", "final", "IOException", "ex", ")", "{", "LOG", ".", "error", "(", "\"", "Error", "exporting", "configuration", "\"", ",", "ex", ")", ";", "configurationResultManager", ".", "genericError", "(", "ex", ".", "getMessage", "(", "))", ";", "}", "catch", "(", "ParserConfigurationException", "|", "SAXException", "|", "TransformerConfigurationException", "ex", ")", "{", "LOG", ".", "error", "(", "\"", "Error", "exporting", "configuration", "\"", ",", "ex", ")", ";", "configurationResultManager", ".", "genericError", "(", "\"", "Error", "creating", "\"", "+", "input", ".", "firstParameter", "(", ")", "+", "EXPORT_FILE_NAME", "+", "\"", "\"", "+", "ex", ".", "getMessage", "(", "))", ";", "}", "catch", "(", "final", "TransformerException", "ex", ")", "{", "LOG", ".", "error", "(", "\"", "Error", "exporting", "configuration", "\"", ",", "ex", ")", ";", "if", "(", "ex", ".", "getCause", "(", ")", "instanceof", "FileNotFoundException", ")", "{", "configurationResultManager", ".", "genericError", "(", "\"", "Permission", "denied", "on", "\"", "+", "input", ".", "firstParameter", "(", "))", ";", "}", "else", "{", "configurationResultManager", ".", "genericError", "(", "\"", "Error", "creating", "\"", "+", "input", ".", "firstParameter", "(", ")", "+", "EXPORT_FILE_NAME", "+", "\"", "\"", "+", "ex", ".", "getMessage", "(", "))", ";", "}", "}", "catch", "(", "final", "SyncopeClientException", "ex", ")", "{", "LOG", ".", "error", "(", "\"", "Error", "exporting", "configuration", "\"", ",", "ex", ")", ";", "configurationResultManager", ".", "genericError", "(", "\"", "Error", "calling", "configuration", "service", "\"", "+", "ex", ".", "getMessage", "(", "))", ";", "}", "catch", "(", "final", "Exception", "ex", ")", "{", "LOG", ".", "error", "(", "\"", "Error", "exporting", "configuration", "\"", ",", "ex", ")", ";", "configurationResultManager", ".", "genericError", "(", "ex", ".", "getMessage", "(", "))", ";", "}", "}", "else", "{", "configurationResultManager", ".", "commandOptionError", "(", "EXPORT_HELP_MESSAGE", ")", ";", "@", "@", "-", "18", ",", "25", "+", "18", ",", "19", "@", "@", "*", "/", "package", "org", ".", "apache", ".", "syncope", ".", "client", ".", "cli", ".", "commands", ".", "report", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerException", ";", "import", "javax", ".", "xml", ".", "ws", ".", "WebServiceException", ";", "import", "org", ".", "apache", ".", "syncope", ".", "client", ".", "cli", ".", "Input", ";", "import", "org", ".", "apache", ".", "syncope", ".", "client", ".", "cli", ".", "util", ".", "CommandUtils", ";", "import", "org", ".", "apache", ".", "syncope", ".", "common", ".", "lib", ".", "SyncopeClientException", ";", "import", "org", ".", "apache", ".", "syncope", ".", "common", ".", "lib", ".", "types", ".", "ReportExecExportFormat", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "public", "class", "ReportExportExecution", "extends", "AbstractReportCommand", "{", "private", "static", "final", "Logger", "LOG", "=", "LoggerFactory", ".", "getLogger", "(", "ReportExportExecution", ".", "class", ")", ";", "private", "static", "final", "String", "EXPORT_EXECUTION_HELP_MESSAGE", "=", "\"", "report", "-", "-", "export", "-", "execution", "-", "result", "{", "EXECUTION", "-", "KEY", "}", "{", "EXECUTION", "-", "KEY", "}", "[", "..", ".]", "{", "FORMAT", "}", "\\", "n", "\"", "private", "static", "final", "String", "EXPORT_EXECUTION_HELP_MESSAGE", "=", "\"", "report", "-", "-", "export", "-", "execution", "-", "result", "{", "EXECUTION", "-", "KEY", "}", "{", "EXECUTION", "-", "KEY", "}", "[", "..", ".]", "{", "FORMAT", "}", "\\", "n", "\"", "+", "\"", "Format", ":", "CSV", "/", "HTML", "/", "PDF", "/", "XML", "/", "RTF", "\"", ";", "private", "final", "Input", "input", ";", "@", "@", "-", "50", ",", "28", "+", "44", ",", "19", "@", "@", "public", "void", "export", "(", ")", "{", "final", "String", "[", "]", "parameters", "=", "Arrays", ".", "copyOf", "(", "input", ".", "getParameters", "(", "),", "input", ".", "parameterNumber", "(", ")", "-", "1", ")", ";", "for", "(", "final", "String", "parameter", ":", "parameters", ")", "{", "try", "{", "final", "String", "result", "=", "reportSyncopeOperations", ".", "exportExecutionResult", "(", "parameter", ",", "input", ".", "lastParameter", "(", "))", ";", "String", "result", "=", "reportSyncopeOperations", ".", "exportExecutionResult", "(", "parameter", ",", "input", ".", "lastParameter", "(", "))", ";", "reportResultManager", ".", "genericMessage", "(", "result", "+", "\"", "created", ".", "\")", ";", "}", "catch", "(", "final", "WebServiceException", "|", "SyncopeClientException", "ex", ")", "{", "LOG", ".", "error", "(", "\"", "Error", "exporting", "execution", "\"", ",", "ex", ")", ";", "if", "(", "ex", ".", "getMessage", "(", ").", "startsWith", "(", "\"", "NotFound", "\"", "))", "{", "}", "catch", "(", "final", "WebServiceException", "|", "SyncopeClientException", "e", ")", "{", "LOG", ".", "error", "(", "\"", "Error", "exporting", "execution", "\"", ",", "e", ")", ";", "if", "(", "e", ".", "getMessage", "(", ").", "startsWith", "(", "\"", "NotFound", "\"", "))", "{", "reportResultManager", ".", "notFoundError", "(", "\"", "Report", "\"", ",", "parameter", ")", ";", "}", "else", "{", "reportResultManager", ".", "genericError", "(", "ex", ".", "getMessage", "(", "))", ";", "reportResultManager", ".", "genericError", "(", "e", ".", "getMessage", "(", "))", ";", "}", "}", "catch", "(", "final", "NumberFormatException", "ex", ")", "{", "LOG", ".", "error", "(", "\"", "Error", "exporting", "execution", "\"", ",", "ex", ")", ";", "reportResultManager", ".", "numberFormatException", "(", "\"", "report", "\"", ",", "parameter", ")", ";", "}", "catch", "(", "IOException", "|", "ParserConfigurationException", "|", "SAXException", "|", "TransformerException", "e", ")", "{", "}", "catch", "(", "final", "Exception", "e", ")", "{", "LOG", ".", "error", "(", "\"", "Error", "exporting", "execution", "\"", ",", "e", ")", ";", "reportResultManager", ".", "genericError", "(", "\"", "-", "Error", "creating", "\"", "+", "\"", "export_", "\"", "+", "parameter", "+", "\"", "\"", "+", "e", ".", "getMessage", "(", "))", ";", "}", "catch", "(", "final", "IllegalArgumentException", "ex", ")", "{", "LOG", ".", "error", "(", "\"", "Error", "exporting", "execution", "\"", ",", "ex", ")", ";", "reportResultManager", ".", "typeNotValidError", "(", "\"", "format", "\"", ",", "input", ".", "firstParameter", "(", "),", "CommandUtils", ".", "fromEnumToArray", "(", "ReportExecExportFormat", ".", "class", ")", ");", "}", "break", ";", "}", "@", "@", "-", "18", ",", "14", "+", "18", ",", "11", "@", "@", "*", "/", "package", "org", ".", "apache", ".", "syncope", ".", "client", ".", "cli", ".", "commands", ".", "report", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "OutputStream", ";", "import", "java", ".", "io", ".", "SequenceInputStream", ";", "import", "java", ".", "nio", ".", "file", ".", "Files", ";", "import", "java", ".", "nio", ".", "file", ".", "Paths", ";", "import", "java", ".", "util", ".", "List", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerException", ";", "import", "org", ".", "apache", ".", "cxf", ".", "helpers", ".", "IOUtils", ";", "import", "org", ".", "apache", ".", "syncope", ".", "client", ".", "cli", ".", "SyncopeServices", ";", "import", "org", ".", "apache", ".", "syncope", ".", "client", ".", "cli", ".", "util", ".", "XMLUtils", ";", "@", "@", "-", "34", ",", "7", "+", "31", ",", "6", "@", "@", "import", "org", ".", "apache", ".", "syncope", ".", "common", ".", "lib", ".", "types", ".", "ReportExecExportFormat", ";", "import", "org", ".", "apache", ".", "syncope", ".", "common", ".", "rest", ".", "api", ".", "beans", ".", "ExecuteQuery", ";", "import", "org", ".", "apache", ".", "syncope", ".", "common", ".", "rest", ".", "api", ".", "service", ".", "ReportService", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "public", "class", "ReportSyncopeOperations", "{", "@", "@", "-", "53", ",", "7", "+", "49", ",", "7", "@", "@", "public", "ReportTO", "read", "(", "final", "String", "reportKey", ")", "{", "}", "public", "String", "exportExecutionResult", "(", "final", "String", "executionKey", ",", "final", "String", "reportExecExportFormat", ")", "throws", "TransformerException", ",", "SAXException", ",", "IOException", ",", "ParserConfigurationException", "{", "throws", "Exception", "{", "ReportExecExportFormat", "format", "=", "ReportExecExportFormat", ".", "valueOf", "(", "reportExecExportFormat", ")", ";", "SequenceInputStream", "report", "=", "(", "SequenceInputStream", ")", "reportService", ".", "exportExecutionResult", "(", "executionKey", ",", "format", ")", ".", "@", "@", "-", "19", ",", "34", "+", "19", ",", "29", "@", "@", "package", "org", ".", "apache", ".", "syncope", ".", "client", ".", "cli", ".", "util", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "io", ".", "StringReader", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerException", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "javax", ".", "xml", ".", "transform", ".", "dom", ".", "DOMSource", ";", "import", "javax", ".", "xml", ".", "transform", ".", "stream", ".", "StreamResult", ";", "import", "org", ".", "apache", ".", "cxf", ".", "helpers", ".", "IOUtils", ";", "import", "org", ".", "xml", ".", "sax", ".", "InputSource", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "org", ".", "w3c", ".", "dom", ".", "bootstrap", ".", "DOMImplementationRegistry", ";", "import", "org", ".", "w3c", ".", "dom", ".", "ls", ".", "DOMImplementationLS", ";", "import", "org", ".", "w3c", ".", "dom", ".", "ls", ".", "LSInput", ";", "import", "org", ".", "w3c", ".", "dom", ".", "ls", ".", "LSParser", ";", "public", "final", "class", "XMLUtils", "{", "public", "static", "void", "createXMLFile", "(", "final", "InputStream", "sis", ",", "final", "String", "filePath", ")", "throws", "TransformerException", ",", "SAXException", ",", "IOException", ",", "ParserConfigurationException", "{", "DocumentBuilderFactory", "dbf", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "dbf", ".", "setFeature", "(", "javax", ".", "xml", ".", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "public", "static", "void", "createXMLFile", "(", "final", "InputStream", "sis", ",", "final", "String", "filePath", ")", "throws", "Exception", "{", "DOMImplementationRegistry", "reg", "=", "DOMImplementationRegistry", ".", "newInstance", "(", ");", "DOMImplementationLS", "domImpl", "=", "(", "DOMImplementationLS", ")", "reg", ".", "getDOMImplementation", "(", "\"", "LS", "\"", ");", "LSInput", "lsinput", "=", "domImpl", ".", "createLSInput", "(", ");", "lsinput", ".", "setByteStream", "(", "sis", ")", ";", "LSParser", "parser", "=", "domImpl", ".", "createLSParser", "(", "DOMImplementationLS", ".", "MODE_SYNCHRONOUS", ",", "null", ")", ";", "TransformerFactory", "tf", "=", "TransformerFactory", ".", "newInstance", "(", ");", "tf", ".", "setFeature", "(", "javax", ".", "xml", ".", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "tf", ".", "newTransformer", "(", ").", "transform", "(", "new", "DOMSource", "(", "dbf", ".", "newDocumentBuilder", "(", ").", "parse", "(", "new", "InputSource", "(", "new", "StringReader", "(", "IOUtils", ".", "toString", "(", "sis", ")", "))", "))", ",", "new", "StreamResult", "(", "new", "File", "(", "filePath", ")", "))", ";", "tf", ".", "setFeature", "(", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "tf", ".", "newTransformer", "(", ").", "transform", "(", "new", "DOMSource", "(", "parser", ".", "parse", "(", "lsinput", ")", "),", "new", "StreamResult", "(", "new", "File", "(", "filePath", ")", "))", ";", "}", "private", "XMLUtils", "(", ")", "{", "@", "@", "-", "19", ",", "11", "+", "19", ",", "11", "@", "@", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "regex", ".", "Pattern", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "transform", ".", "Source", ";", "import", "javax", ".", "xml", ".", "transform", ".", "Templates", ";", "import", "javax", ".", "xml", ".", "transform", ".", "Transformer", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerConfigurationException", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "javax", ".", "xml", ".", "transform", ".", "sax", ".", "SAXResult", ";", "import", "javax", ".", "xml", ".", "transform", ".", "sax", ".", "SAXTransformerFactory", ";", "import", "javax", ".", "xml", ".", "transform", ".", "sax", ".", "TransformerHandler", ";", "@", "@", "-", "34", ",", "6", "+", "34", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "cocoon", ".", "sax", ".", "AbstractSAXTransformer", ";", "import", "org", ".", "apache", ".", "cocoon", ".", "sax", ".", "SAXConsumer", ";", "import", "org", ".", "apache", ".", "cocoon", ".", "sax", ".", "util", ".", "SAXConsumerAdapter", ";", "import", "org", ".", "apache", ".", "syncope", ".", "core", ".", "provisioning", ".", "java", ".", "utils", ".", "VoidURIResolver", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "@", "@", "-", "132", ",", "7", "+", "133", ",", "7", "@", "@", "public", "void", "setParameters", "(", "final", "Map", "<", "String", ",", "?", "extends", "Object", ">", "parameters", ")", "{", "if", "(", "parameters", "=", "=", "null", ")", "{", "this", ".", "parameters", "=", "null", ";", "}", "else", "{", "this", ".", "parameters", "=", "new", "HashMap", "<", "String", ",", "Object", ">", "(", "parameters", ")", ";", "this", ".", "parameters", "=", "new", "HashMap", "<", ">(", "parameters", ")", ";", "}", "}", "@", "@", "-", "183", ",", "7", "+", "184", ",", "14", "@", "@", "public", "CacheKey", "constructCacheKey", "(", ")", "{", "*", "@", "return", "a", "new", "transformer", "factory", "*", "/", "private", "static", "SAXTransformerFactory", "createNewSAXTransformerFactory", "(", ")", "{", "return", "(", "SAXTransformerFactory", ")", "TransformerFactory", ".", "newInstance", "(", ");", "SAXTransformerFactory", "transformerFactory", "=", "(", "SAXTransformerFactory", ")", "SAXTransformerFactory", ".", "newInstance", "(", ");", "transformerFactory", ".", "setURIResolver", "(", "new", "VoidURIResolver", "(", "))", ";", "try", "{", "transformerFactory", ".", "setFeature", "(", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "}", "catch", "(", "TransformerConfigurationException", "e", ")", "{", "LOG", ".", "error", "(", "\"", "Could", "not", "enable", "secure", "XML", "processing", "\"", ",", "e", ")", ";", "}", "return", "transformerFactory", ";", "}", "@", "Override", "@", "@", "-", "42", ",", "6", "+", "42", ",", "7", "@", "@", "import", "java", ".", "util", ".", "TreeMap", ";", "import", "java", ".", "util", ".", "TreeSet", ";", "import", "javax", ".", "sql", ".", "DataSource", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "transform", ".", "OutputKeys", ";", "import", "javax", ".", "xml", ".", "transform", ".", "Transformer", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerConfigurationException", ";", "@", "@", "-", "367", ",", "8", "+", "368", ",", "8", "@", "@", "public", "void", "export", "(", "}", "StreamResult", "streamResult", "=", "new", "StreamResult", "(", "os", ")", ";", "final", "SAXTransformerFactory", "transformerFactory", "=", "(", "SAXTransformerFactory", ")", "SAXTransformerFactory", ".", "newInstance", "(", ");", "transformerFactory", ".", "setFeature", "(", "javax", ".", "xml", ".", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "SAXTransformerFactory", "transformerFactory", "=", "(", "SAXTransformerFactory", ")", "SAXTransformerFactory", ".", "newInstance", "(", ");", "transformerFactory", ".", "setFeature", "(", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "TransformerHandler", "handler", "=", "transformerFactory", ".", "newTransformerHandler", "(", ");", "Transformer", "serializer", "=", "handler", ".", "getTransformer", "(", ");", "@", "@", "-", "27", ",", "8", "+", "27", ",", "11", "@", "@", "import", "java", ".", "util", ".", "zip", ".", "Deflater", ";", "import", "java", ".", "util", ".", "zip", ".", "ZipEntry", ";", "import", "java", ".", "util", ".", "zip", ".", "ZipOutputStream", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "transform", ".", "OutputKeys", ";", "import", "javax", ".", "xml", ".", "transform", ".", "Transformer", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerConfigurationException", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "javax", ".", "xml", ".", "transform", ".", "sax", ".", "SAXTransformerFactory", ";", "import", "javax", ".", "xml", ".", "transform", ".", "sax", ".", "TransformerHandler", ";", "import", "javax", ".", "xml", ".", "transform", ".", "stream", ".", "StreamResult", ";", "@", "@", "-", "44", ",", "6", "+", "47", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "syncope", ".", "core", ".", "persistence", ".", "api", ".", "entity", ".", "Report", ";", "import", "org", ".", "apache", ".", "syncope", ".", "core", ".", "persistence", ".", "api", ".", "entity", ".", "ReportExec", ";", "import", "org", ".", "apache", ".", "syncope", ".", "core", ".", "provisioning", ".", "api", ".", "job", ".", "report", ".", "ReportJobDelegate", ";", "import", "org", ".", "apache", ".", "syncope", ".", "core", ".", "provisioning", ".", "java", ".", "utils", ".", "VoidURIResolver", ";", "import", "org", ".", "quartz", ".", "JobExecutionException", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "@", "@", "-", "58", ",", "6", "+", "62", ",", "18", "@", "@", "private", "static", "final", "Logger", "LOG", "=", "LoggerFactory", ".", "getLogger", "(", "ReportJobDelegate", ".", "class", ")", ";", "private", "static", "final", "SAXTransformerFactory", "TRANSFORMER_FACTORY", ";", "static", "{", "TRANSFORMER_FACTORY", "=", "(", "SAXTransformerFactory", ")", "TransformerFactory", ".", "newInstance", "(", ");", "TRANSFORMER_FACTORY", ".", "setURIResolver", "(", "new", "VoidURIResolver", "(", "))", ";", "try", "{", "TRANSFORMER_FACTORY", ".", "setFeature", "(", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "}", "catch", "(", "TransformerConfigurationException", "e", ")", "{", "LOG", ".", "error", "(", "\"", "Could", "not", "enable", "secure", "XML", "processing", "\"", ",", "e", ")", ";", "}", "}", "/", "**", "*", "Report", "DAO", ".", "*", "/", "@", "@", "-", "127", ",", "9", "+", "143", ",", "7", "@", "@", "public", "void", "execute", "(", "final", "String", "reportKey", ")", "throws", "JobExecutionException", "{", "ZipOutputStream", "zos", "=", "new", "ZipOutputStream", "(", "baos", ")", ";", "zos", ".", "setLevel", "(", "Deflater", ".", "BEST_COMPRESSION", ")", ";", "try", "{", "SAXTransformerFactory", "tFactory", "=", "(", "SAXTransformerFactory", ")", "SAXTransformerFactory", ".", "newInstance", "(", ");", "tFactory", ".", "setFeature", "(", "javax", ".", "xml", ".", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "handler", "=", "tFactory", ".", "newTransformerHandler", "(", ");", "handler", "=", "TRANSFORMER_FACTORY", ".", "newTransformerHandler", "(", ");", "Transformer", "serializer", "=", "handler", ".", "getTransformer", "(", ");", "serializer", ".", "setOutputProperty", "(", "OutputKeys", ".", "ENCODING", ",", "StandardCharsets", ".", "UTF_8", ".", "name", "(", "))", ";", "serializer", ".", "setOutputProperty", "(", "OutputKeys", ".", "INDENT", ",", "\"", "yes", "\"", ");", "@", "@", "-", "0", ",", "0", "+", "1", ",", "35", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "*", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "*", "distributed", "with", "this", "work", "for", "additional", "information", "*", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "*", "to", "you", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "*", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "*", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "*", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "*", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "*", "specific", "language", "governing", "permissions", "and", "limitations", "*", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "syncope", ".", "core", ".", "provisioning", ".", "java", ".", "utils", ";", "import", "javax", ".", "xml", ".", "transform", ".", "Source", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerException", ";", "import", "javax", ".", "xml", ".", "transform", ".", "URIResolver", ";", "/", "**", "*", "This", "implementation", "disallows", "any", "XSLT", "include", ",", "for", "security", "reasons", ".", "*", "/", "public", "class", "VoidURIResolver", "implements", "URIResolver", "{", "@", "Override", "public", "Source", "resolve", "(", "final", "String", "href", ",", "final", "String", "base", ")", "throws", "TransformerException", "{", "return", "null", ";", "}", "}", "@", "@", "-", "21", ",", "22", "+", "21", ",", "23", "@", "@", "import", "java", ".", "io", ".", "StringWriter", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "javax", ".", "sql", ".", "DataSource", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "transform", ".", "OutputKeys", ";", "import", "javax", ".", "xml", ".", "transform", ".", "Transformer", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerException", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "javax", ".", "xml", ".", "transform", ".", "dom", ".", "DOMSource", ";", "import", "javax", ".", "xml", ".", "transform", ".", "stream", ".", "StreamResult", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang3", ".", "StringUtils", ";", "import", "org", ".", "apache", ".", "cxf", ".", "staxutils", ".", "StaxUtils", ";", "import", "org", ".", "apache", ".", "syncope", ".", "common", ".", "lib", ".", "types", ".", "AnyTypeKind", ";", "import", "org", ".", "apache", ".", "syncope", ".", "common", ".", "lib", ".", "types", ".", "CamelEntitlement", ";", "import", "org", ".", "apache", ".", "syncope", ".", "core", ".", "provisioning", ".", "api", ".", "EntitlementsHolder", ";", "import", "org", ".", "apache", ".", "syncope", ".", "core", ".", "spring", ".", "ResourceWithFallbackLoader", ";", "import", "org", ".", "apache", ".", "syncope", ".", "core", ".", "persistence", ".", "api", ".", "DomainsHolder", ";", "import", "org", ".", "apache", ".", "syncope", ".", "core", ".", "persistence", ".", "api", ".", "SyncopeLoader", ";", "import", "org", ".", "apache", ".", "syncope", ".", "core", ".", "persistence", ".", "api", ".", "entity", ".", "CamelRoute", ";", "import", "org", ".", "apache", ".", "syncope", ".", "core", ".", "provisioning", ".", "java", ".", "utils", ".", "VoidURIResolver", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "import", "org", ".", "springframework", ".", "beans", ".", "factory", ".", "annotation", ".", "Autowired", ";", "@", "@", "-", "153", ",", "11", "+", "154", ",", "10", "@", "@", "private", "void", "loadRoutes", "(", "NodeList", "routeNodes", ";", "if", "(", "IS_JBOSS", ")", "{", "tf", "=", "TransformerFactory", ".", "newInstance", "(", ");", "tf", ".", "setFeature", "(", "javax", ".", "xml", ".", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "DocumentBuilderFactory", "dbFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "dbFactory", ".", "setFeature", "(", "javax", ".", "xml", ".", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "DocumentBuilder", "dBuilder", "=", "dbFactory", ".", "newDocumentBuilder", "(", ");", "Document", "doc", "=", "dBuilder", ".", "parse", "(", "resource", ".", "getInputStream", "(", "))", ";", "tf", ".", "setFeature", "(", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "tf", ".", "setURIResolver", "(", "new", "VoidURIResolver", "(", "))", ";", "Document", "doc", "=", "StaxUtils", ".", "read", "(", "resource", ".", "getInputStream", "(", "))", ";", "routeNodes", "=", "doc", ".", "getDocumentElement", "(", ").", "getElementsByTagName", "(", "\"", "route", "\"", ");", "}", "else", "{", "@", "@", "-", "50", ",", "6", "+", "50", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "syncope", ".", "common", ".", "lib", ".", "types", ".", "SAML2BindingType", ";", "import", "org", ".", "apache", ".", "syncope", ".", "common", ".", "lib", ".", "types", ".", "SignatureAlgorithm", ";", "import", "org", ".", "apache", ".", "syncope", ".", "core", ".", "logic", ".", "init", ".", "SAML2SPLoader", ";", "import", "org", ".", "apache", ".", "syncope", ".", "core", ".", "provisioning", ".", "java", ".", "utils", ".", "VoidURIResolver", ";", "import", "org", ".", "apache", ".", "wss4j", ".", "common", ".", "crypto", ".", "Merlin", ";", "import", "org", ".", "apache", ".", "wss4j", ".", "common", ".", "ext", ".", "WSSecurityException", ";", "import", "org", ".", "apache", ".", "wss4j", ".", "common", ".", "saml", ".", "OpenSAMLUtil", ";", "@", "@", "-", "77", ",", "6", "+", "78", ",", "7", "@", "@", "static", "{", "TRANSFORMER_FACTORY", "=", "TransformerFactory", ".", "newInstance", "(", ");", "TRANSFORMER_FACTORY", ".", "setURIResolver", "(", "new", "VoidURIResolver", "(", "))", ";", "try", "{", "TRANSFORMER_FACTORY", ".", "setFeature", "(", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "}", "catch", "(", "TransformerConfigurationException", "e", ")", "{", "@", "@", "-", "103", ",", "14", "+", "105", ",", "14", "@", "@", "public", "void", "init", "(", ")", "{", "/", "/", "Try", "to", "load", "a", "signature", "algorithm", "if", "(", "loader", ".", "getSignatureAlgorithm", "(", ")", "!", "=", "null", ")", "{", "SignatureAlgorithm", "loadedSignatureAlgorithm", "=", "SignatureAlgorithm", ".", "valueOf", "(", "loader", ".", "getSignatureAlgorithm", "(", "))", ";", "SignatureAlgorithm", ".", "valueOf", "(", "loader", ".", "getSignatureAlgorithm", "(", "))", ";", "if", "(", "loadedSignatureAlgorithm", "!", "=", "null", ")", "{", "sigAlgo", "=", "loadedSignatureAlgorithm", ".", "getAlgorithm", "(", ");", "jceSigAlgo", "=", "JCEMapper", ".", "translateURItoJCEID", "(", "sigAlgo", ")", ";", "}", "if", "(", "jceSigAlgo", "=", "=", "null", ")", "{", "LOG", ".", "warn", "(", "\"", "Signature", "algorithm", "{", "}", "is", "not", "valid", ".", "Using", "default", "algorithm", "instead", ".", "\",", "loader", ".", "getSignatureAlgorithm", "(", "))", ";", "loader", ".", "getSignatureAlgorithm", "(", "))", ";", "sigAlgo", "=", "null", ";", "}", "}", "@", "@", "-", "54", ",", "6", "+", "54", ",", "40", "@", "@", "public", "class", "ReportITCase", "extends", "AbstractITCase", "{", "protected", "static", "String", "execReport", "(", "final", "String", "reportKey", ")", "{", "ReportTO", "reportTO", "=", "reportService", ".", "read", "(", "reportKey", ")", ";", "assertNotNull", "(", "reportTO", ")", ";", "assertNotNull", "(", "reportTO", ".", "getExecutions", "(", "))", ";", "int", "preExecSize", "=", "reportTO", ".", "getExecutions", "(", ").", "size", "(", ");", "ExecTO", "exec", "=", "reportService", ".", "execute", "(", "new", "ExecuteQuery", ".", "Builder", "(", ").", "key", "(", "reportKey", ")", ".", "build", "(", "))", ";", "assertNotNull", "(", "exec", ")", ";", "int", "i", "=", "0", ";", "int", "maxit", "=", "50", ";", "/", "/", "wait", "for", "completion", "(", "executions", "incremented", ")", "do", "{", "try", "{", "Thread", ".", "sleep", "(", "1000", ")", ";", "}", "catch", "(", "InterruptedException", "e", ")", "{", "}", "reportTO", "=", "reportService", ".", "read", "(", "reportKey", ")", ";", "assertNotNull", "(", "reportTO", ")", ";", "assertNotNull", "(", "reportTO", ".", "getExecutions", "(", "))", ";", "i", "+", "+;", "}", "while", "(", "preExecSize", "=", "=", "reportTO", ".", "getExecutions", "(", ").", "size", "(", ")", "&", "&", "i", "<", "maxit", ")", ";", "if", "(", "i", "=", "=", "maxit", ")", "{", "fail", "(", "\"", "Timeout", "when", "executing", "report", "\"", "+", "reportKey", ")", ";", "}", "exec", "=", "reportTO", ".", "getExecutions", "(", ").", "get", "(", "reportTO", ".", "getExecutions", "(", ").", "size", "(", ")", "-", "1", ")", ";", "assertEquals", "(", "ReportExecStatus", ".", "SUCCESS", ".", "name", "(", "),", "exec", ".", "getStatus", "(", "))", ";", "return", "exec", ".", "getKey", "(", ");", "}", "@", "Test", "public", "void", "getReportletConfs", "(", ")", "{", "Set", "<", "String", ">", "reportletConfs", "=", "syncopeService", ".", "platform", "(", ").", "getReportletConfs", "(", ");", "@", "@", "-", "139", ",", "35", "+", "173", ",", "6", "@", "@", "public", "void", "delete", "(", ")", "{", "}", "}", "private", "String", "execute", "(", "final", "String", "reportKey", ")", "{", "ExecTO", "execution", "=", "reportService", ".", "execute", "(", "new", "ExecuteQuery", ".", "Builder", "(", ").", "key", "(", "reportKey", ")", ".", "build", "(", "))", ";", "assertNotNull", "(", "execution", ")", ";", "int", "i", "=", "0", ";", "int", "maxit", "=", "50", ";", "ReportTO", "reportTO", ";", "/", "/", "wait", "for", "report", "execution", "completion", "(", "executions", "incremented", ")", "do", "{", "try", "{", "Thread", ".", "sleep", "(", "1000", ")", ";", "}", "catch", "(", "InterruptedException", "e", ")", "{", "}", "reportTO", "=", "reportService", ".", "read", "(", "reportKey", ")", ";", "assertNotNull", "(", "reportTO", ")", ";", "assertNotNull", "(", "reportTO", ".", "getExecutions", "(", "))", ";", "i", "+", "+;", "}", "while", "(", "reportTO", ".", "getExecutions", "(", ").", "isEmpty", "(", ")", "|", "|", "(", "!", "ReportExecStatus", ".", "SUCCESS", ".", "name", "(", ").", "equals", "(", "reportTO", ".", "getExecutions", "(", ").", "get", "(", "0", ")", ".", "getStatus", "(", "))", "&", "&", "i", "<", "maxit", ")", ");", "assertEquals", "(", "ReportExecStatus", ".", "SUCCESS", ".", "name", "(", "),", "reportTO", ".", "getExecutions", "(", ").", "get", "(", "0", ")", ".", "getStatus", "(", "))", ";", "return", "reportTO", ".", "getExecutions", "(", ").", "get", "(", "0", ")", ".", "getKey", "(", ");", "}", "private", "void", "checkExport", "(", "final", "String", "execKey", ",", "final", "ReportExecExportFormat", "fmt", ")", "throws", "IOException", "{", "Response", "response", "=", "reportService", ".", "exportExecutionResult", "(", "execKey", ",", "fmt", ")", ";", "assertNotNull", "(", "response", ")", ";", "@", "@", "-", "192", ",", "7", "+", "197", ",", "7", "@", "@", "public", "void", "executeAndExport", "(", ")", "throws", "IOException", "{", "assertNotNull", "(", "reportTO", ")", ";", "try", "{", "execute", "(", "reportTO", ".", "getKey", "(", "))", ";", "execReport", "(", "reportTO", ".", "getKey", "(", "))", ";", "fail", "(", ");", "}", "catch", "(", "SyncopeClientException", "e", ")", "{", "assertEquals", "(", "ClientExceptionType", ".", "Scheduling", ",", "e", ".", "getType", "(", "))", ";", "@", "@", "-", "202", ",", "7", "+", "207", ",", "7", "@", "@", "public", "void", "executeAndExport", "(", ")", "throws", "IOException", "{", "reportTO", ".", "setActive", "(", "true", ")", ";", "reportService", ".", "update", "(", "reportTO", ")", ";", "String", "execKey", "=", "execute", "(", "reportTO", ".", "getKey", "(", "))", ";", "String", "execKey", "=", "execReport", "(", "reportTO", ".", "getKey", "(", "))", ";", "checkExport", "(", "execKey", ",", "ReportExecExportFormat", ".", "XML", ")", ";", "checkExport", "(", "execKey", ",", "ReportExecExportFormat", ".", "HTML", ")", ";", "@", "@", "-", "226", ",", "7", "+", "231", ",", "7", "@", "@", "public", "void", "deleteExecutions", "(", ")", "{", "reportTO", "=", "createReport", "(", "reportTO", ")", ";", "assertNotNull", "(", "reportTO", ")", ";", "String", "execKey", "=", "execute", "(", "reportTO", ".", "getKey", "(", "))", ";", "String", "execKey", "=", "execReport", "(", "reportTO", ".", "getKey", "(", "))", ";", "assertNotNull", "(", "execKey", ")", ";", "try", "{", "@", "@", "-", "266", ",", "7", "+", "271", ",", "7", "@", "@", "public", "void", "auditReport", "(", ")", "throws", "IOException", "{", "report", ".", "setTemplate", "(", "\"", "sample", "\"", ");", "report", "=", "createReport", "(", "report", ")", ";", "String", "execKey", "=", "execute", "(", "report", ".", "getKey", "(", "))", ";", "String", "execKey", "=", "execReport", "(", "report", ".", "getKey", "(", "))", ";", "checkExport", "(", "execKey", ",", "ReportExecExportFormat", ".", "XML", ")", ";", "report", "=", "reportService", ".", "read", "(", "report", ".", "getKey", "(", "))", ";", "@", "@", "-", "34", ",", "6", "+", "34", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "syncope", ".", "common", ".", "lib", ".", "SyncopeClientException", ";", "import", "org", ".", "apache", ".", "syncope", ".", "common", ".", "lib", ".", "to", ".", "ReportTemplateTO", ";", "import", "org", ".", "apache", ".", "syncope", ".", "common", ".", "lib", ".", "types", ".", "ClientExceptionType", ";", "import", "org", ".", "apache", ".", "syncope", ".", "common", ".", "lib", ".", "types", ".", "ReportExecExportFormat", ";", "import", "org", ".", "apache", ".", "syncope", ".", "common", ".", "lib", ".", "types", ".", "ReportTemplateFormat", ";", "import", "org", ".", "apache", ".", "syncope", ".", "fit", ".", "AbstractITCase", ";", "import", "org", ".", "junit", ".", "Test", ";", "@", "@", "-", "150", ",", "6", "+", "151", ",", "41", "@", "@", "public", "void", "crud", "(", ")", "throws", "IOException", "{", "}", "}", "@", "Test", "public", "void", "safeTemplate", "(", ")", "throws", "IOException", "{", "Response", "response", "=", "reportTemplateService", ".", "getFormat", "(", "\"", "sample", "\"", ",", "ReportTemplateFormat", ".", "HTML", ")", ";", "String", "before", "=", "IOUtils", ".", "toString", "(", "(", "InputStream", ")", "response", ".", "getEntity", "(", "),", "StandardCharsets", ".", "UTF_8", ")", ";", "assertNotNull", "(", "before", ")", ";", "String", "execKey", "=", "ReportITCase", ".", "execReport", "(", "\"", "0062ea9c", "-", "924d", "-", "4ecf", "-", "9961", "-", "4492a8cc6d1b", "\"", ");", "assertNotNull", "(", "execKey", ")", ";", "response", "=", "reportService", ".", "exportExecutionResult", "(", "execKey", ",", "ReportExecExportFormat", ".", "HTML", ")", ";", "String", "result", "=", "IOUtils", ".", "toString", "(", "(", "InputStream", ")", "response", ".", "getEntity", "(", "),", "StandardCharsets", ".", "UTF_8", ")", ";", "assertNotNull", "(", "result", ")", ";", "assertTrue", "(", "result", ".", "startsWith", "(", "\"<", "?", "xml", "version", "=", "\\\"", "1", ".", "0", "\\", "\"", "encoding", "=", "\\\"", "UTF", "-", "8", "\\", "\"?", ">\"", "+", "\"", "<!", "DOCTYPE", "html", "PUBLIC", "\\", "\"-", "//", "W3C", "/", "/", "DTD", "XHTML", "1", ".", "0", "Strict", "/", "/", "EN", "\\", "\"", "\"", "+", "\"", "\\\"", "http", ":", "//", "www", ".", "w3", ".", "org", "/", "TR", "/", "xhtml1", "/", "DTD", "/", "xhtml1", "-", "strict", ".", "dtd", "\\", "\">", "\")", ");", "String", "malicious", "=", "\"", "<?", "xml", "version", "=", "\\\"", "1", ".", "0", "\\", "\"", "encoding", "=", "\\\"", "utf", "-", "8", "\\", "\"?", ">\\", "n", "\"", "+", "\"", "<!", "DOCTYPE", "xsl", ":", "stylesheet", "\"", "+", "\"", "[<", "!", "ENTITY", "file", "SYSTEM", "\\", "\"", "webapps", "/", "syncope", "/", "WEB", "-", "INF", "/", "classes", "/", "security", ".", "properties", "\\", "\">", "]>", "\\", "n", "\"", "+", "\"", "<", "xsl", ":", "stylesheet", "version", "=", "\\\"", "1", ".", "0", "\\", "\"", "xmlns", ":", "xsl", "=", "\\\"", "http", ":", "//", "www", ".", "w3", ".", "org", "/", "1999", "/", "XSL", "/", "Transform", "\\", "\">", "\\", "n", "\"", "+", "\"", "<", "xsl", ":", "template", "match", "=", "\\\"", "/\\", "\">", "&", "file", ";", "</", "xsl", ":", "template", ">", "\\", "n", "\"", "+", "\"", "</", "xsl", ":", "stylesheet", ">", "\";", "try", "{", "reportTemplateService", ".", "setFormat", "(", "\"", "sample", "\"", ",", "ReportTemplateFormat", ".", "HTML", ",", "IOUtils", ".", "toInputStream", "(", "malicious", ",", "StandardCharsets", ".", "UTF_8", ")", ");", "response", "=", "reportService", ".", "exportExecutionResult", "(", "execKey", ",", "ReportExecExportFormat", ".", "HTML", ")", ";", "result", "=", "IOUtils", ".", "toString", "(", "(", "InputStream", ")", "response", ".", "getEntity", "(", "),", "StandardCharsets", ".", "UTF_8", ")", ";", "assertNotNull", "(", "result", ")", ";", "assertTrue", "(", "result", ".", "isEmpty", "(", "))", ";", "}", "finally", "{", "reportTemplateService", ".", "setFormat", "(", "\"", "sample", "\"", ",", "ReportTemplateFormat", ".", "HTML", ",", "IOUtils", ".", "toInputStream", "(", "before", ",", "StandardCharsets", ".", "UTF_8", ")", ");", "}", "}", "@", "Test", "public", "void", "issueSYNCOPE866", "(", ")", "{", "ReportTemplateTO", "reportTemplateTO", "=", "new", "ReportTemplateTO", "(", ");", "@", "@", "-", "21", ",", "16", "+", "21", ",", "12", "@", "@", "import", "org", ".", "apache", ".", "syncope", ".", "installer", ".", "utilities", ".", "FileSystemUtils", ";", "import", "com", ".", "izforge", ".", "izpack", ".", "panels", ".", "process", ".", "AbstractUIProcessHandler", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "Properties", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerException", ";", "import", "org", ".", "apache", ".", "syncope", ".", "installer", ".", "files", ".", "ConsolePom", ";", "import", "org", ".", "apache", ".", "syncope", ".", "installer", ".", "files", ".", "CorePom", ";", "import", "org", ".", "apache", ".", "syncope", ".", "installer", ".", "files", ".", "ParentPom", ";", "import", "org", ".", "apache", ".", "syncope", ".", "installer", ".", "utilities", ".", "InstallLog", ";", "import", "org", ".", "apache", ".", "syncope", ".", "installer", ".", "utilities", ".", "MavenUtils", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "public", "class", "ArchetypeProcess", "extends", "BaseProcess", "{", "@", "@", "-", "65", ",", "30", "+", "61", ",", "15", "@", "@", "public", "void", "run", "(", "final", "AbstractUIProcessHandler", "handler", ",", "final", "String", "[", "]", "args", ")", "{", "InstallLog", ".", "initialize", "(", "installPath", ",", "handler", ")", ";", "MavenUtils", "mavenUtils", "=", "new", "MavenUtils", "(", "mavenDir", ",", "handler", ")", ";", "File", "customMavenProxySettings", "=", "null", ";", "try", "{", "if", "(", "isProxyEnabled", "&", "&", "mavenProxyAutoconf", ")", "{", "customMavenProxySettings", "=", "MavenUtils", ".", "createSettingsWithProxy", "(", "installPath", ",", "proxyHost", ",", "proxyPort", ",", "proxyUser", ",", "proxyPwd", ")", ";", "if", "(", "isProxyEnabled", "&", "&", "mavenProxyAutoconf", ")", "{", "try", "{", "customMavenProxySettings", "=", "MavenUtils", ".", "createSettingsWithProxy", "(", "installPath", ",", "proxyHost", ",", "proxyPort", ",", "proxyUser", ",", "proxyPwd", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "StringBuilder", "message", "=", "new", "StringBuilder", "(", "\"", "Error", "during", "creation", "of", "custom", "Maven", "settings", ".", "xml", "\"", ");", "handler", ".", "emitError", "(", "message", ".", "toString", "(", "),", "e", ".", "getMessage", "(", "))", ";", "InstallLog", ".", "getInstance", "(", ").", "error", "(", "message", ".", "append", "(", "'\\", "n", "'", ").", "append", "(", "e", ".", "getMessage", "(", "))", ".", "toString", "(", "))", ";", "}", "}", "catch", "(", "IOException", "e", ")", "{", "StringBuilder", "message", "=", "new", "StringBuilder", "(", "\"", "I", "/", "O", "error", "during", "creation", "of", "Maven", "custom", "settings", ".", "xml", "\"", ");", "handler", ".", "emitError", "(", "message", ".", "toString", "(", "),", "e", ".", "getMessage", "(", "))", ";", "InstallLog", ".", "getInstance", "(", ").", "error", "(", "message", ".", "append", "(", "'\\", "n", "'", ").", "append", "(", "e", ".", "getMessage", "(", "))", ".", "toString", "(", "))", ";", "}", "catch", "(", "ParserConfigurationException", "e", ")", "{", "StringBuilder", "message", "=", "new", "StringBuilder", "(", "\"", "Parser", "configuration", "error", "during", "creation", "of", "Maven", "custom", "settings", ".", "xml", "\"", ");", "handler", ".", "emitError", "(", "message", ".", "toString", "(", "),", "e", ".", "getMessage", "(", "))", ";", "InstallLog", ".", "getInstance", "(", ").", "error", "(", "message", ".", "append", "(", "'\\", "n", "'", ").", "append", "(", "e", ".", "getMessage", "(", "))", ".", "toString", "(", "))", ";", "}", "catch", "(", "TransformerException", "e", ")", "{", "StringBuilder", "message", "=", "new", "StringBuilder", "(", "\"", "Transformer", "error", "during", "creation", "of", "Maven", "custom", "settings", ".", "xml", "\"", ");", "handler", ".", "emitError", "(", "message", ".", "toString", "(", "),", "e", ".", "getMessage", "(", "))", ";", "InstallLog", ".", "getInstance", "(", ").", "error", "(", "message", ".", "append", "(", "'\\", "n", "'", ").", "append", "(", "e", ".", "getMessage", "(", "))", ".", "toString", "(", "))", ";", "}", "catch", "(", "SAXException", "e", ")", "{", "StringBuilder", "message", "=", "new", "StringBuilder", "(", "\"", "XML", "parsing", "error", "during", "creation", "of", "Maven", "custom", "settings", ".", "xml", "\"", ");", "handler", ".", "emitError", "(", "message", ".", "toString", "(", "),", "e", ".", "getMessage", "(", "))", ";", "InstallLog", ".", "getInstance", "(", ").", "error", "(", "message", ".", "append", "(", "'\\", "n", "'", ").", "append", "(", "e", ".", "getMessage", "(", "))", ".", "toString", "(", "))", ";", "}", "handler", ".", "logOutput", "(", "\"#", "##", "##", "##", "##", "##", "##", "##", "##", "##", "##", "##", "##", "#", "IMPORTANT", "#", "##", "##", "##", "##", "##", "##", "##", "##", "##", "##", "##", "##", "#\"", ",", "true", ")", ";", "@", "@", "-", "21", ",", "10", "+", "21", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "syncope", ".", "installer", ".", "utilities", ".", "FileSystemUtils", ";", "import", "com", ".", "izforge", ".", "izpack", ".", "panels", ".", "process", ".", "AbstractUIProcessHandler", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "Properties", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerException", ";", "import", "org", ".", "apache", ".", "syncope", ".", "installer", ".", "containers", ".", "Glassfish", ";", "import", "org", ".", "apache", ".", "syncope", ".", "installer", ".", "containers", ".", "Tomcat", ";", "import", "org", ".", "apache", ".", "syncope", ".", "installer", ".", "containers", ".", "jboss", ".", "JBoss", ";", "@", "@", "-", "35", ",", "7", "+", "32", ",", "6", "@", "@", "import", "org", ".", "apache", ".", "syncope", ".", "installer", ".", "files", ".", "MasterDomainXml", ";", "import", "org", ".", "apache", ".", "syncope", ".", "installer", ".", "utilities", ".", "InstallLog", ";", "import", "org", ".", "apache", ".", "syncope", ".", "installer", ".", "utilities", ".", "MavenUtils", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "public", "final", "class", "ContainerProcess", "extends", "BaseProcess", "{", "@", "@", "-", "76", ",", "6", "+", "72", ",", "7", "@", "@", "private", "String", "logsDirectory", ";", "private", "String", "bundlesDirectory", ";", "private", "String", "modelerDirectory", ";", "private", "boolean", "withDataSource", ";", "@", "@", "-", "199", ",", "30", "+", "196", ",", "15", "@", "@", "public", "void", "run", "(", "final", "AbstractUIProcessHandler", "handler", ",", "final", "String", "[", "]", "args", ")", "{", "MavenUtils", "mavenUtils", "=", "new", "MavenUtils", "(", "mavenDir", ",", "handler", ")", ";", "File", "customMavenProxySettings", "=", "null", ";", "try", "{", "if", "(", "isProxyEnabled", "&", "&", "mavenProxyAutoconf", ")", "{", "if", "(", "isProxyEnabled", "&", "&", "mavenProxyAutoconf", ")", "{", "try", "{", "customMavenProxySettings", "=", "MavenUtils", ".", "createSettingsWithProxy", "(", "installPath", ",", "proxyHost", ",", "proxyPort", ",", "proxyUser", ",", "proxyPwd", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "StringBuilder", "message", "=", "new", "StringBuilder", "(", "\"", "Error", "during", "creation", "of", "custom", "Maven", "settings", ".", "xml", "\"", ");", "handler", ".", "emitError", "(", "message", ".", "toString", "(", "),", "e", ".", "getMessage", "(", "))", ";", "InstallLog", ".", "getInstance", "(", ").", "error", "(", "message", ".", "append", "(", "'\\", "n", "'", ").", "append", "(", "e", ".", "getMessage", "(", "))", ".", "toString", "(", "))", ";", "}", "}", "catch", "(", "IOException", "e", ")", "{", "StringBuilder", "message", "=", "new", "StringBuilder", "(", "\"", "I", "/", "O", "error", "during", "creation", "of", "Maven", "custom", "settings", ".", "xml", "\"", ");", "handler", ".", "emitError", "(", "message", ".", "toString", "(", "),", "e", ".", "getMessage", "(", "))", ";", "InstallLog", ".", "getInstance", "(", ").", "error", "(", "message", ".", "append", "(", "'\\", "n", "'", ").", "append", "(", "e", ".", "getMessage", "(", "))", ".", "toString", "(", "))", ";", "}", "catch", "(", "ParserConfigurationException", "e", ")", "{", "StringBuilder", "message", "=", "new", "StringBuilder", "(", "\"", "Parser", "configuration", "error", "during", "creation", "of", "Maven", "custom", "settings", ".", "xml", "\"", ");", "handler", ".", "emitError", "(", "message", ".", "toString", "(", "),", "e", ".", "getMessage", "(", "))", ";", "InstallLog", ".", "getInstance", "(", ").", "error", "(", "message", ".", "append", "(", "'\\", "n", "'", ").", "append", "(", "e", ".", "getMessage", "(", "))", ".", "toString", "(", "))", ";", "}", "catch", "(", "TransformerException", "e", ")", "{", "StringBuilder", "message", "=", "new", "StringBuilder", "(", "\"", "Transformer", "error", "during", "creation", "of", "Maven", "custom", "settings", ".", "xml", "\"", ");", "handler", ".", "emitError", "(", "message", ".", "toString", "(", "),", "e", ".", "getMessage", "(", "))", ";", "InstallLog", ".", "getInstance", "(", ").", "error", "(", "message", ".", "append", "(", "'\\", "n", "'", ").", "append", "(", "e", ".", "getMessage", "(", "))", ".", "toString", "(", "))", ";", "}", "catch", "(", "SAXException", "e", ")", "{", "StringBuilder", "message", "=", "new", "StringBuilder", "(", "\"", "XML", "parsing", "error", "during", "creation", "of", "Maven", "custom", "settings", ".", "xml", "\"", ");", "handler", ".", "emitError", "(", "message", ".", "toString", "(", "),", "e", ".", "getMessage", "(", "))", ";", "InstallLog", ".", "getInstance", "(", ").", "error", "(", "message", ".", "append", "(", "'\\", "n", "'", ").", "append", "(", "e", ".", "getMessage", "(", "))", ".", "toString", "(", "))", ";", "}", "Properties", "mvnProperties", "=", "new", "Properties", "(", ");", "@", "@", "-", "30", ",", "6", "+", "30", ",", "7", "@", "@", "import", "java", ".", "io", ".", "OutputStreamWriter", ";", "import", "java", ".", "io", ".", "PrintWriter", ";", "import", "java", ".", "nio", ".", "charset", ".", "Charset", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "import", "javax", ".", "xml", ".", "transform", ".", "OutputKeys", ";", "import", "javax", ".", "xml", ".", "transform", ".", "Transformer", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerException", ";", "@", "@", "-", "135", ",", "7", "+", "136", ",", "7", "@", "@", "public", "void", "appendToFile", "(", "final", "File", "file", ",", "final", "String", "content", ")", "{", "public", "static", "void", "writeXML", "(", "final", "Document", "doc", ",", "final", "OutputStream", "out", ")", "throws", "IOException", ",", "TransformerException", "{", "final", "TransformerFactory", "factory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "factory", ".", "setFeature", "(", "javax", ".", "xml", ".", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "factory", ".", "setFeature", "(", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "final", "Transformer", "transformer", "=", "factory", ".", "newTransformer", "(", ");", "transformer", ".", "setOutputProperty", "(", "OutputKeys", ".", "OMIT_XML_DECLARATION", ",", "\"", "no", "\"", ");", "transformer", ".", "setOutputProperty", "(", "OutputKeys", ".", "METHOD", ",", "\"", "xml", "\"", ");", "@", "@", "-", "20", ",", "8", "+", "20", ",", "8", "@", "@", "import", "com", ".", "izforge", ".", "izpack", ".", "panels", ".", "process", ".", "AbstractUIProcessHandler", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "FileInputStream", ";", "import", "java", ".", "io", ".", "FileNotFoundException", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "PrintStream", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "nio", ".", "file", ".", "Files", ";", "@", "@", "-", "34", ",", "11", "+", "34", ",", "6", "@", "@", "import", "java", ".", "util", ".", "logging", ".", "Level", ";", "import", "java", ".", "util", ".", "logging", ".", "Logger", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerException", ";", "import", "org", ".", "apache", ".", "commons", ".", "codec", ".", "binary", ".", "Hex", ";", "import", "org", ".", "apache", ".", "commons", ".", "io", ".", "FileUtils", ";", "import", "org", ".", "apache", ".", "maven", ".", "shared", ".", "invoker", ".", "DefaultInvocationRequest", ";", "@", "@", "-", "51", ",", "7", "+", "46", ",", "10", "@", "@", "import", "org", ".", "apache", ".", "maven", ".", "shared", ".", "invoker", ".", "PrintStreamLogger", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Element", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "org", ".", "w3c", ".", "dom", ".", "bootstrap", ".", "DOMImplementationRegistry", ";", "import", "org", ".", "w3c", ".", "dom", ".", "ls", ".", "DOMImplementationLS", ";", "import", "org", ".", "w3c", ".", "dom", ".", "ls", ".", "LSInput", ";", "import", "org", ".", "w3c", ".", "dom", ".", "ls", ".", "LSParser", ";", "public", "class", "MavenUtils", "{", "@", "@", "-", "85", ",", "7", "+", "83", ",", "7", "@", "@", "public", "void", "archetypeGenerate", "(", "request", ".", "setBatchMode", "(", "true", ")", ";", "final", "Properties", "properties", "=", "archetypeProperties", "(", "archetypeVersion", ",", "groupId", ",", "artifactId", ",", "secretKey", ",", "anonymousKey", ",", "jwsKey", ",", "adminPassword", ")", ";", "anonymousKey", ",", "jwsKey", ",", "adminPassword", ")", ";", "request", ".", "setProperties", "(", "properties", ")", ";", "if", "(", "customSettingsFile", "!", "=", "null", "&", "&", "FileUtils", ".", "sizeOf", "(", "customSettingsFile", ")", ">", "0", ")", "{", "request", ".", "setUserSettingsFile", "(", "customSettingsFile", ")", ";", "@", "@", "-", "122", ",", "7", "+", "120", ",", "7", "@", "@", "private", "Properties", "archetypeProperties", "(", "try", "{", "final", "MessageDigest", "cript", "=", "MessageDigest", ".", "getInstance", "(", "\"", "SHA", "-", "1", "\"", ");", "String", "encodedPassword", "=", "new", "String", "(", "Hex", ".", "encodeHex", "(", "cript", ".", "digest", "(", "adminPassword", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", "))", ");", "new", "String", "(", "Hex", ".", "encodeHex", "(", "cript", ".", "digest", "(", "adminPassword", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", "))", ");", "properties", ".", "setProperty", "(", "\"", "adminPassword", "\"", ",", "encodedPassword", ")", ";", "}", "catch", "(", "final", "NoSuchAlgorithmException", "ex", ")", "{", "Logger", ".", "getLogger", "(", "MavenUtils", ".", "class", ".", "getName", "(", "))", ".", "log", "(", "Level", ".", "SEVERE", ",", "\"", "NoSuchAlgorithmException", "\"", ",", "ex", ")", ";", "@", "@", "-", "193", ",", "19", "+", "191", ",", "21", "@", "@", "private", "InvocationResult", "invoke", "(", "final", "InvocationRequest", "request", ",", "final", "String", "pa", "}", "public", "static", "File", "createSettingsWithProxy", "(", "final", "String", "path", ",", "final", "String", "proxyHost", ",", "final", "String", "proxyPort", ",", "final", "String", "proxyUser", ",", "final", "String", "proxyPassword", ")", "throws", "IOException", ",", "ParserConfigurationException", ",", "TransformerException", ",", "SAXException", "{", "final", "String", "proxyUser", ",", "final", "String", "proxyPassword", ")", "throws", "Exception", "{", "final", "File", "settingsXML", "=", "new", "File", "(", "System", ".", "getProperty", "(", "MAVEN_HOME_PROPERTY", ")", "+", "(", "System", ".", "getProperty", "(", "MAVEN_HOME_PROPERTY", ")", ".", "endsWith", "(", "\"/", "\")", "?", "\"", "conf", "/", "settings", ".", "xml", "\"", ":", "\"", "/", "conf", "/", "settings", ".", "xml", "\"", "))", ";", "final", "File", "tempSettingsXML", "=", "new", "File", "(", "path", "+", "(", "path", ".", "endsWith", "(", "\"/", "\")", "?", "\"", "settings_temp", ".", "xml", "\"", ":", "\"", "/", "settings_temp", ".", "xml", "\"", "))", ";", "if", "(", "settingsXML", ".", "canRead", "(", ")", "&", "&", "!", "tempSettingsXML", ".", "exists", "(", "))", "{", "tempSettingsXML", ".", "createNewFile", "(", ");", "final", "DocumentBuilderFactory", "dbf", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "dbf", ".", "setFeature", "(", "javax", ".", "xml", ".", "XMLConstants", ".", "FEATURE_SECURE_PROCESSING", ",", "true", ")", ";", "final", "DocumentBuilder", "builder", "=", "dbf", ".", "newDocumentBuilder", "(", ");", "DOMImplementationRegistry", "reg", "=", "DOMImplementationRegistry", ".", "newInstance", "(", ");", "DOMImplementationLS", "domImpl", "=", "(", "DOMImplementationLS", ")", "reg", ".", "getDOMImplementation", "(", "\"", "LS", "\"", ");", "LSInput", "lsinput", "=", "domImpl", ".", "createLSInput", "(", ");", "lsinput", ".", "setByteStream", "(", "new", "FileInputStream", "(", "settingsXML", ")", ");", "LSParser", "parser", "=", "domImpl", ".", "createLSParser", "(", "DOMImplementationLS", ".", "MODE_SYNCHRONOUS", ",", "null", ")", ";", "/", "/", "parse", "settings", ".", "xml", "final", "Document", "settings", "=", "builder", ".", "parse", "(", "settingsXML", ")", ";", "final", "Document", "settings", "=", "parser", ".", "parse", "(", "lsinput", ")", ";", "final", "Element", "proxies", "=", "(", "Element", ")", "settings", ".", "getDocumentElement", "(", ").", "getElementsByTagName", "(", "\"", "proxies", "\"", ").", "item", "(", "0", ")", ";"], "docstring_tokens": ["not", "assign", "report", "and", "template", "entitlements", "to", "any", "administrator"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "23", ",", "4", "+", "23", ",", "4", "@", "@", "THE", "SOFTWARE", ".", "-", "->", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "l", ":", "icon", "class", "=", "\"", "icon", "-", "lock", "icon", "-", "sm", "\"", "tooltip", "=", "\"$", "{%", "Keep", "this", "build", "forever", "}", ":&", "lt", ";", "br", "/", "&", "gt", ";", "${", "build", ".", "whyKeepLog", "}", "\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "/>", "<", "l", ":", "icon", "class", "=", "\"", "icon", "-", "lock", "icon", "-", "sm", "\"", "tooltip", "=", "\"$", "{%", "Keep", "this", "build", "forever", "}", ":&", "lt", ";", "br", "/", "&", "gt", ";", "${", "h", ".", "xmlEscape", "(", "build", ".", "whyKeepLog", ")", "}\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "/>", "@", "@", "-", "0", ",", "0", "+", "1", ",", "160", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2004", "-", "2009", ",", "Sun", "Microsystems", ",", "Inc", ".", ",", "Kohsuke", "Kawaguchi", ",", "Jorg", "Heymans", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "model", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "ScriptResult", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "html", ".", "HtmlPage", ";", "import", "hudson", ".", "Launcher", ";", "import", "hudson", ".", "tasks", ".", "BuildTrigger", ";", "import", "hudson", ".", "tasks", ".", "Builder", ";", "import", "hudson", ".", "tasks", ".", "Fingerprinter", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "org", ".", "junit", ".", "Rule", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "Issue", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "JenkinsRule", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "TestExtension", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "static", "org", ".", "hamcrest", ".", "CoreMatchers", ".", "containsString", ";", "import", "static", "org", ".", "hamcrest", ".", "CoreMatchers", ".", "instanceOf", ";", "import", "static", "org", ".", "hamcrest", ".", "CoreMatchers", ".", "not", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertThat", ";", "public", "class", "RunSEC1902Test", "{", "@", "Rule", "public", "JenkinsRule", "j", "=", "new", "JenkinsRule", "(", ");", "@", "Issue", "(", "\"", "SECURITY", "-", "1902", "\"", ")", "@", "Test", "public", "void", "preventXssInBadgeTooltip", "(", ")", "throws", "Exception", "{", "j", ".", "jenkins", ".", "setQuietPeriod", "(", "0", ")", ";", "/", "*", "*", "The", "scenario", "to", "trigger", "is", "to", "have", "a", "build", "protected", "from", "deletion", "because", "of", "an", "upstream", "protected", "build", ".", "*", "Once", "we", "have", "that", "condition", ",", "we", "need", "to", "ensure", "the", "upstream", "project", "has", "a", "dangerous", "name", "*", "/", "FreeStyleProject", "up", "=", "j", ".", "createFreeStyleProject", "(", "\"", "up", "\"", ");", "up", ".", "getBuildersList", "(", ").", "add", "(", "new", "WriteFileStep", "(", "))", ";", "up", ".", "getPublishersList", "(", ").", "add", "(", "new", "Fingerprinter", "(", "\"*", "*/", "*\"", "))", ";", "FullNameChangingProject", "down", "=", "j", ".", "createProject", "(", "FullNameChangingProject", ".", "class", ",", "\"", "down", "\"", ");", "down", ".", "getBuildersList", "(", ").", "add", "(", "new", "WriteFileStep", "(", "))", ";", "down", ".", "getPublishersList", "(", ").", "add", "(", "new", "Fingerprinter", "(", "\"*", "*/", "*\"", "))", ";", "/", "/", "protected", "field", ",", "we", "are", "in", "the", "same", "package", "down", ".", "keepDependencies", "=", "true", ";", "up", ".", "getPublishersList", "(", ").", "add", "(", "new", "BuildTrigger", "(", "down", ".", "getFullName", "(", "),", "false", ")", ");", "j", ".", "jenkins", ".", "rebuildDependencyGraph", "(", ");", "FreeStyleBuild", "upBuild", "=", "j", ".", "buildAndAssertSuccess", "(", "up", ")", ";", "j", ".", "waitUntilNoActivity", "(", ");", "CustomBuild", "downBuild", "=", "down", ".", "getBuilds", "(", ").", "getLastBuild", "(", ");", "assertNotNull", "(", "\"", "The", "down", "build", "must", "exist", ",", "otherwise", "the", "up", "'", "s", "one", "is", "not", "protected", ".", "\",", "downBuild", ")", ";", "/", "/", "updating", "the", "name", "before", "the", "build", "is", "problematic", "under", "Windows", "/", "/", "so", "we", "are", "updating", "internal", "stuff", "manually", "String", "newName", "=", "\"", "Down", "<", "img", "src", "=", "x", "onerror", "=", "alert", "(", "123", ")", ">", "Project", "\"", ";", "down", ".", "setVirtualName", "(", "newName", ")", ";", "Fingerprint", "f", "=", "upBuild", ".", "getAction", "(", "Fingerprinter", ".", "FingerprintAction", ".", "class", ")", ".", "getFingerprints", "(", ").", "get", "(", "\"", "test", ".", "txt", "\"", ");", "f", ".", "add", "(", "newName", ",", "1", ")", ";", "/", "/", "keeping", "the", "minimum", "to", "validate", "it", "'", "s", "working", "and", "it", "'", "s", "not", "exploitable", "as", "there", "are", "some", "modifications", "/", "/", "like", "adding", "double", "quotes", "ensureXssIsPrevented", "(", "up", ",", "\"", "Down", "\"", ",", "\"", "<", "img", "\"", ");", "}", "private", "void", "ensureXssIsPrevented", "(", "FreeStyleProject", "upProject", ",", "String", "validationPart", ",", "String", "dangerousPart", ")", "throws", "Exception", "{", "JenkinsRule", ".", "WebClient", "wc", "=", "j", ".", "createWebClient", "(", ");", "HtmlPage", "htmlPage", "=", "wc", ".", "goTo", "(", "upProject", ".", "getUrl", "(", "))", ";", "/", "/", "trigger", "the", "tooltip", "display", "htmlPage", ".", "executeJavaScript", "(", "\"", "document", ".", "querySelector", "(", "'#", "buildHistory", "table", ".", "build", "-", "badge", "img", "'", ").", "dispatchEvent", "(", "new", "Event", "(", "'", "mouseover", "'", "))", ";\"", ");", "wc", ".", "waitForBackgroundJavaScript", "(", "500", ")", ";", "ScriptResult", "result", "=", "htmlPage", ".", "executeJavaScript", "(", "\"", "document", ".", "querySelector", "(", "'#", "tt", "'", ").", "innerHTML", ";", "\")", ";", "Object", "jsResult", "=", "result", ".", "getJavaScriptResult", "(", ");", "assertThat", "(", "jsResult", ",", "instanceOf", "(", "String", ".", "class", ")", ");", "String", "jsResultString", "=", "(", "String", ")", "jsResult", ";", "assertThat", "(", "\"", "The", "tooltip", "does", "not", "work", "as", "expected", "\"", ",", "jsResultString", ",", "containsString", "(", "validationPart", ")", ");", "assertThat", "(", "\"", "XSS", "not", "prevented", "\"", ",", "jsResultString", ",", "not", "(", "containsString", "(", "dangerousPart", ")", "))", ";", "}", "public", "static", "class", "WriteFileStep", "extends", "Builder", "{", "@", "Override", "public", "boolean", "perform", "(", "AbstractBuild", "<", "?,", "?", ">", "build", ",", "Launcher", "launcher", ",", "BuildListener", "listener", ")", "throws", "InterruptedException", ",", "IOException", "{", "build", ".", "getWorkspace", "(", ").", "child", "(", "\"", "test", ".", "txt", "\"", ").", "write", "(", "\"", "123", "\"", ",", "StandardCharsets", ".", "UTF_8", ".", "name", "(", "))", ";", "return", "true", ";", "}", "}", "public", "static", "class", "CustomBuild", "extends", "Build", "<", "FullNameChangingProject", ",", "CustomBuild", ">", "{", "public", "CustomBuild", "(", "FullNameChangingProject", "job", ")", "throws", "IOException", "{", "super", "(", "job", ")", ";", "}", "}", "static", "class", "FullNameChangingProject", "extends", "Project", "<", "FullNameChangingProject", ",", "CustomBuild", ">", "implements", "TopLevelItem", "{", "private", "volatile", "String", "virtualName", ";", "public", "FullNameChangingProject", "(", "ItemGroup", "parent", ",", "String", "name", ")", "{", "super", "(", "parent", ",", "name", ")", ";", "}", "public", "void", "setVirtualName", "(", "String", "virtualName", ")", "{", "this", ".", "virtualName", "=", "virtualName", ";", "}", "@", "Override", "public", "String", "getName", "(", ")", "{", "if", "(", "virtualName", "!", "=", "null", ")", "{", "return", "virtualName", ";", "}", "else", "{", "return", "super", ".", "getName", "(", ");", "}", "}", "@", "Override", "protected", "Class", "<", "CustomBuild", ">", "getBuildClass", "(", ")", "{", "return", "CustomBuild", ".", "class", ";", "}", "@", "Override", "public", "TopLevelItemDescriptor", "getDescriptor", "(", ")", "{", "return", "(", "FreeStyleProject", ".", "DescriptorImpl", ")", "Jenkins", ".", "get", "(", ").", "getDescriptorOrDie", "(", "getClass", "(", "))", ";", "}", "@", "TestExtension", "(", "\"", "preventXssInBadgeTooltip", "\"", ")", "public", "static", "class", "DescriptorImpl", "extends", "AbstractProjectDescriptor", "{", "@", "Override", "public", "FullNameChangingProject", "newInstance", "(", "ItemGroup", "parent", ",", "String", "name", ")", "{", "return", "new", "FullNameChangingProject", "(", "parent", ",", "name", ")", ";", "}", "}", "}", "}"], "docstring_tokens": ["does", "not", "escape", "the", "job", "name", "in", "the", "'Keep", "this", "build", "forever", "'", "badge", "tooltip"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "12", ",", "4", "+", "12", ",", "17", "@", "@", "error_reporting", "(", "E_ALL", "|", "E_STRICT", ")", ";", "require", "(", "'", "UploadHandler", ".", "php", "'", ");", "$", "upload_handler", "=", "new", "UploadHandler", "(", ");", "$", "upload_handler", "=", "new", "UploadHandler", "(", "array", "(", "/", "/", "SECURITY", "NOTICE", ":", "/", "/", "Only", "change", "the", "accept_file_types", "setting", "after", "making", "sure", "that", "any", "/", "/", "allowed", "file", "types", "cannot", "be", "executed", "by", "the", "webserver", "in", "the", "files", "/", "/", "directory", "(", "e", ".", "g", ".", "PHP", "scripts", ")", ",", "nor", "executed", "by", "the", "browser", "when", "downloaded", "/", "/", "(", "e", ".", "g", ".", "HTML", "files", "with", "embedded", "JavaScript", "code", ")", ".", "/", "/", "e", ".", "g", ".", "in", "Apache", ",", "make", "sure", "the", "provided", ".", "htaccess", "file", "is", "present", "in", "the", "/", "/", "files", "directory", "and", ".", "htaccess", "support", "has", "been", "enabled", ":", "/", "/", "https", ":", "//", "httpd", ".", "apache", ".", "org", "/", "docs", "/", "current", "/", "howto", "/", "htaccess", ".", "html", "/", "/", "By", "default", ",", "only", "allow", "file", "uploads", "with", "image", "file", "extensions", ":", "'", "accept_file_types", "'", "=", ">", "'", "/\\", ".(", "gif", "|", "jpe", "?", "g", "|", "png", ")", "$/", "i", "'", ")", ");"], "docstring_tokens": ["doesn't", "require", "any", "validation", "to", "upload", "files", "to", "the", "server"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "29", ",", "6", "+", "29", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicBoolean", ";", "import", "javax", ".", "servlet", ".", "RequestDispatcher", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletResponse", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpUpgradeHandler", ";", "import", "org", ".", "apache", ".", "coyote", ".", "AbstractProcessor", ";", "@", "@", "-", "1110", ",", "6", "+", "1111", ",", "7", "@", "@", "protected", "void", "prepareRequest", "(", ")", "{", "/", "/", "Set", "this", "every", "time", "in", "case", "limit", "has", "been", "changed", "via", "JMX", "headers", ".", "setLimit", "(", "endpoint", ".", "getMaxHeaderCount", "(", "))", ";", "boolean", "contentLengthSet", "=", "false", ";", "int", "hCount", "=", "requestHeaderMessage", ".", "getInt", "(", ");", "for", "(", "int", "i", "=", "0", ";", "i", "<", "hCount", ";", "i", "+", "+)", "{", "String", "hName", "=", "null", ";", "@", "@", "-", "1144", ",", "9", "+", "1146", ",", "15", "@", "@", "protected", "void", "prepareRequest", "(", ")", "{", "if", "(", "hId", "=", "=", "Constants", ".", "SC_REQ_CONTENT_LENGTH", "|", "|", "(", "hId", "=", "=", "-", "1", "&", "&", "tmpMB", ".", "equalsIgnoreCase", "(", "\"", "Content", "-", "Length", "\"", "))", ")", "{", "/", "/", "just", "read", "the", "content", "-", "length", "header", ",", "so", "set", "it", "long", "cl", "=", "vMB", ".", "getLong", "(", ");", "request", ".", "setContentLength", "(", "cl", ")", ";", "if", "(", "contentLengthSet", ")", "{", "response", ".", "setStatus", "(", "HttpServletResponse", ".", "SC_BAD_REQUEST", ")", ";", "error", "=", "true", ";", "}", "else", "{", "contentLengthSet", "=", "true", ";", "/", "/", "Set", "the", "content", "-", "length", "header", "for", "the", "request", "request", ".", "setContentLength", "(", "cl", ")", ";", "}", "if", "(", "cl", "!", "=", "0", ")", "{", "bodyPresent", "=", "true", ";", "}", "@", "@", "-", "1263", ",", "10", "+", "1263", ",", "20", "@", "@", "protected", "void", "prepareRequest", "(", ")", "{", "/", "/", "Parse", "content", "-", "length", "header", "long", "contentLength", "=", "request", ".", "getContentLengthLong", "(", ");", "if", "(", "contentLength", ">", "=", "0", "&", "&", "!", "contentDelimitation", ")", "{", "getInputBuffer", "(", ").", "addActiveFilter", "(", "inputFilters", "[", "Constants", ".", "IDENTITY_FILTER", "]", ");", "contentDelimitation", "=", "true", ";", "if", "(", "contentLength", ">", "=", "0", ")", "{", "if", "(", "contentDelimitation", ")", "{", "/", "/", "contentDelimitation", "being", "true", "at", "this", "point", "indicates", "that", "/", "/", "chunked", "encoding", "is", "being", "used", "but", "chunked", "encoding", "should", "/", "/", "not", "be", "used", "with", "a", "content", "length", ".", "RFC", "2616", ",", "section", "4", ".", "4", ",", "/", "/", "bullet", "3", "states", "Content", "-", "Length", "must", "be", "ignored", "in", "this", "case", "-", "/", "/", "so", "remove", "it", ".", "headers", ".", "removeHeader", "(", "\"", "content", "-", "length", "\"", ");", "request", ".", "setContentLength", "(", "-", "1", ")", ";", "}", "else", "{", "getInputBuffer", "(", ").", "addActiveFilter", "(", "inputFilters", "[", "Constants", ".", "IDENTITY_FILTER", "]", ");", "contentDelimitation", "=", "true", ";", "}", "}", "MessageBytes", "valueMB", "=", "headers", ".", "getValue", "(", "\"", "host", "\"", ");", "@", "@", "-", "98", ",", "9", "+", "98", ",", "20", "@", "@", "public", "void", "testKeepAlive", "(", ")", "throws", "Exception", "{", "ajpClient", ".", "disconnect", "(", ");", "}", "@", "Test", "public", "void", "testPost", "(", ")", "throws", "Exception", "{", "doTestPost", "(", "false", ",", "HttpServletResponse", ".", "SC_OK", ")", ";", "}", "@", "Test", "public", "void", "testSimplePost", "(", ")", "throws", "Exception", "{", "public", "void", "testPostMultipleContentLength", "(", ")", "throws", "Exception", "{", "/", "/", "Multiple", "content", "lengths", "doTestPost", "(", "true", ",", "HttpServletResponse", ".", "SC_BAD_REQUEST", ")", ";", "}", "public", "void", "doTestPost", "(", "boolean", "multipleCL", ",", "int", "expectedStatus", ")", "throws", "Exception", "{", "Tomcat", "tomcat", "=", "getTomcatInstance", "(", ");", "@", "@", "-", "119", ",", "6", "+", "130", ",", "9", "@", "@", "public", "void", "testSimplePost", "(", ")", "throws", "Exception", "{", "TesterAjpMessage", "forwardMessage", "=", "ajpClient", ".", "createForwardMessage", "(", "\"/", "echo", "-", "params", ".", "jsp", "\"", ",", "4", ")", ";", "forwardMessage", ".", "addHeader", "(", "0xA008", ",", "\"", "9", "\"", ");", "if", "(", "multipleCL", ")", "{", "forwardMessage", ".", "addHeader", "(", "0xA008", ",", "\"", "99", "\"", ");", "}", "forwardMessage", ".", "addHeader", "(", "0xA007", ",", "\"", "application", "/", "x", "-", "www", "-", "form", "-", "urlencoded", "\"", ");", "forwardMessage", ".", "end", "(", ");", "@", "@", "-", "128", ",", "15", "+", "142", ",", "20", "@", "@", "public", "void", "testSimplePost", "(", ")", "throws", "Exception", "{", "TesterAjpMessage", "responseHeaders", "=", "ajpClient", ".", "sendMessage", "(", "forwardMessage", ",", "bodyMessage", ")", ";", "/", "/", "Expect", "3", "messages", ":", "headers", ",", "body", ",", "end", "validateResponseHeaders", "(", "responseHeaders", ",", "200", ")", ";", "/", "/", "Skip", "the", "body", "TesterAjpMessage", "responseBody", "=", "ajpClient", ".", "readMessage", "(", ");", "validateResponseBody", "(", "responseBody", ",", "\"", "test", "-", "data", "\"", ");", "validateResponseEnd", "(", "ajpClient", ".", "readMessage", "(", "),", "true", ")", ";", "validateResponseHeaders", "(", "responseHeaders", ",", "expectedStatus", ")", ";", "if", "(", "expectedStatus", "=", "=", "HttpServletResponse", ".", "SC_OK", ")", "{", "/", "/", "Expect", "3", "messages", ":", "headers", ",", "body", ",", "end", "for", "a", "valid", "request", "TesterAjpMessage", "responseBody", "=", "ajpClient", ".", "readMessage", "(", ");", "validateResponseBody", "(", "responseBody", ",", "\"", "test", "-", "data", "\"", ");", "validateResponseEnd", "(", "ajpClient", ".", "readMessage", "(", "),", "true", ")", ";", "/", "/", "Double", "check", "the", "connection", "is", "still", "open", "validateCpong", "(", "ajpClient", ".", "cping", "(", "))", ";", "}", "else", "{", "/", "/", "Expect", "2", "messages", ":", "headers", ",", "end", "for", "an", "invalid", "request", "validateResponseEnd", "(", "ajpClient", ".", "readMessage", "(", "),", "false", ")", ";", "}", "/", "/", "Double", "check", "the", "connection", "is", "still", "open", "validateCpong", "(", "ajpClient", ".", "cping", "(", "))", ";", "ajpClient", ".", "disconnect", "(", ");", "}", "@", "@", "-", "103", ",", "6", "+", "103", ",", "20", "@", "@", "public", "void", "testWithTEBuffered", "(", ")", "throws", "Exception", "{", "@", "Test", "public", "void", "testWithTEChunked", "(", ")", "throws", "Exception", "{", "doTestWithTEChunked", "(", "false", ")", ";", "}", "@", "Test", "public", "void", "testWithTEChunkedWithCL", "(", ")", "throws", "Exception", "{", "/", "/", "Should", "be", "ignored", "doTestWithTEChunked", "(", "true", ")", ";", "}", "private", "void", "doTestWithTEChunked", "(", "boolean", "withCL", ")", "throws", "Exception", "{", "Tomcat", "tomcat", "=", "getTomcatInstance", "(", ");", "/", "/", "Use", "the", "normal", "Tomcat", "ROOT", "context", "@", "@", "-", "114", ",", "6", "+", "128", ",", "7", "@", "@", "public", "void", "testWithTEChunked", "(", ")", "throws", "Exception", "{", "String", "request", "=", "\"", "POST", "/", "echo", "-", "params", ".", "jsp", "HTTP", "/", "1", ".", "1", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+", "\"", "Host", ":", "any", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+", "(", "withCL", "?", "\"", "Content", "-", "length", ":", "1", "\"", "+", "SimpleHttpClient", ".", "CRLF", ":", "\"", "\")", "\"", "Transfer", "-", "encoding", ":", "chunked", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+", "\"", "Content", "-", "Type", ":", "application", "/", "x", "-", "www", "-", "form", "-", "urlencoded", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+"], "docstring_tokens": ["the", "handling", "of", "malicious", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "128", ",", "14", "+", "128", ",", "19", "@", "@", "private", "String", "getState", "(", "ServletRequest", "request", ")", "{", "private", "void", "verifySavedState", "(", "HttpServletRequest", "request", ")", "{", "HttpSession", "session", "=", "request", ".", "getSession", "(", "false", ")", ";", "if", "(", "session", "!", "=", "null", ")", "{", "String", "savedContext", "=", "(", "String", ")", "session", ".", "getAttribute", "(", "FederationAuthenticationEntryPoint", ".", "SAVED_CONTEXT", ")", ";", "String", "state", "=", "getState", "(", "request", ")", ";", "if", "(", "savedContext", "!", "=", "null", "&", "&", "!", "savedContext", ".", "equals", "(", "state", ")", ")", "{", "logger", ".", "warn", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "throw", "new", "BadCredentialsException", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "}", "if", "(", "session", "=", "=", "null", ")", "{", "logger", ".", "warn", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "throw", "new", "BadCredentialsException", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "}", "String", "savedContext", "=", "(", "String", ")", "session", ".", "getAttribute", "(", "FederationAuthenticationEntryPoint", ".", "SAVED_CONTEXT", ")", ";", "String", "state", "=", "getState", "(", "request", ")", ";", "if", "(", "savedContext", "=", "=", "null", "|", "|", "!", "savedContext", ".", "equals", "(", "state", ")", ")", "{", "logger", ".", "warn", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "throw", "new", "BadCredentialsException", "(", "\"", "The", "received", "state", "does", "not", "match", "the", "state", "saved", "in", "the", "context", "\"", ");", "}", "session", ".", "removeAttribute", "(", "FederationAuthenticationEntryPoint", ".", "SAVED_CONTEXT", ")", ";", "}", "/", "**", "@", "@", "-", "157", ",", "4", "+", "157", ",", "12", "@", "@", "public", "void", "testCSRFAttack", "(", ")", "throws", "Exception", "{", "+", "\"", "/", "j_spring_fediz_security_check", "\"", ";", "csrfAttackTest", "(", "url", ")", ";", "}", "@", "Override", "@", "org", ".", "junit", ".", "Test", "public", "void", "testCSRFAttack2", "(", ")", "throws", "Exception", "{", "String", "url", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "getRpHttpsPort", "(", ")", "+", "\"", "/\"", "+", "getServletContextName", "(", ")", "+", "\"", "/", "j_spring_fediz_security_check", "\"", ";", "csrfAttackTest2", "(", "url", ")", ";", "}", "}", "@", "@", "-", "803", ",", "4", "+", "803", ",", "56", "@", "@", "protected", "void", "csrfAttackTest", "(", "String", "rpURL", ")", "throws", "Exception", "{", "}", "@", "org", ".", "junit", ".", "Test", "public", "void", "testCSRFAttack2", "(", ")", "throws", "Exception", "{", "String", "url", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "getRpHttpsPort", "(", ")", "+", "\"", "/\"", "+", "getServletContextName", "(", ")", "+", "\"", "/", "secure", "/", "fedservlet", "\"", ";", "csrfAttackTest2", "(", "url", ")", ";", "}", "protected", "void", "csrfAttackTest2", "(", "String", "rpURL", ")", "throws", "Exception", "{", "String", "url", "=", "\"", "https", ":", "//", "localhost", ":", "\"", "+", "getRpHttpsPort", "(", ")", "+", "\"", "/\"", "+", "getServletContextName", "(", ")", "+", "\"", "/", "secure", "/", "fedservlet", "\"", ";", "/", "/", "1", ".", "Log", "in", "as", "\"", "bob", "\"", "using", "another", "WebClient", "WebClient", "webClient2", "=", "new", "WebClient", "(", ");", "webClient2", ".", "getOptions", "(", ").", "setUseInsecureSSL", "(", "true", ")", ";", "webClient2", ".", "getCredentialsProvider", "(", ").", "setCredentials", "(", "new", "AuthScope", "(", "\"", "localhost", "\"", ",", "Integer", ".", "parseInt", "(", "getIdpHttpsPort", "(", "))", "),", "new", "UsernamePasswordCredentials", "(", "\"", "bob", "\"", ",", "\"", "bob", "\"", "))", ";", "webClient2", ".", "getOptions", "(", ").", "setJavaScriptEnabled", "(", "false", ")", ";", "final", "HtmlPage", "idpPage2", "=", "webClient2", ".", "getPage", "(", "url", ")", ";", "webClient2", ".", "getOptions", "(", ").", "setJavaScriptEnabled", "(", "true", ")", ";", "Assert", ".", "assertEquals", "(", "\"", "IDP", "SignIn", "Response", "Form", "\"", ",", "idpPage2", ".", "getTitleText", "(", "))", ";", "/", "/", "2", ".", "Now", "instead", "of", "clicking", "on", "the", "form", ",", "send", "the", "form", "via", "alice", "'", "s", "WebClient", "instead", "/", "/", "Send", "with", "context", ".", "..", "WebRequest", "request", "=", "new", "WebRequest", "(", "new", "URL", "(", "rpURL", ")", ",", "HttpMethod", ".", "POST", ")", ";", "request", ".", "setRequestParameters", "(", "new", "ArrayList", "<", "NameValuePair", ">", "()", ");", "DomNodeList", "<", "DomElement", ">", "results", "=", "idpPage2", ".", "getElementsByTagName", "(", "\"", "input", "\"", ");", "for", "(", "DomElement", "result", ":", "results", ")", "{", "if", "(", "\"", "wresult", "\"", ".", "equals", "(", "result", ".", "getAttributeNS", "(", "null", ",", "\"", "name", "\"", "))", "|", "|", "\"", "wa", "\"", ".", "equals", "(", "result", ".", "getAttributeNS", "(", "null", ",", "\"", "name", "\"", "))", "|", "|", "\"", "wctx", "\"", ".", "equals", "(", "result", ".", "getAttributeNS", "(", "null", ",", "\"", "name", "\"", "))", ")", "{", "String", "value", "=", "result", ".", "getAttributeNS", "(", "null", ",", "\"", "value", "\"", ");", "request", ".", "getRequestParameters", "(", ").", "add", "(", "new", "NameValuePair", "(", "result", ".", "getAttributeNS", "(", "null", ",", "\"", "name", "\"", "),", "value", ")", ");", "}", "}", "WebClient", "webClient", "=", "new", "WebClient", "(", ");", "webClient", ".", "getOptions", "(", ").", "setUseInsecureSSL", "(", "true", ")", ";", "try", "{", "webClient", ".", "getPage", "(", "request", ")", ";", "Assert", ".", "fail", "(", "\"", "Failure", "expected", "on", "a", "CSRF", "attack", "\"", ");", "}", "catch", "(", "FailingHttpStatusCodeException", "ex", ")", "{", "/", "/", "expected", "}", "/", "/", "webClient", ".", "close", "(", ");", "/", "/", "webClient2", ".", "close", "(", ");", "}", "}", "@", "@", "-", "37", ",", "6", "+", "37", ",", "7", "@", "@", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "context", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "sch", "<", "sec", ":", "intercept", "-", "url", "pattern", "=", "\"/", "index", ".", "html", "\"", "access", "=", "\"", "permitAll", "\"", "/>", "<", "sec", ":", "intercept", "-", "url", "pattern", "=", "\"/", "FederationMetadata", "/", "**", "\"", "access", "=", "\"", "isAuthenticated", "(", ")\"", "/>", "<", "sec", ":", "intercept", "-", "url", "pattern", "=", "\"/", "secure", "/", "fedservlet", "\"", "access", "=", "\"", "isAuthenticated", "(", ")\"", "/>", "<", "sec", ":", "intercept", "-", "url", "pattern", "=", "\"/", "secure", "/", "test", ".", "html", "\"", "access", "=", "\"", "isAuthenticated", "(", ")\"", "/>", "<", "sec", ":", "intercept", "-", "url", "pattern", "=", "\"/", "secure", "/", "manager", "/", "**", "\"", "access", "=", "\"", "hasRole", "(", "'", "ROLE_MANAGER", "'", ")\"", "/>", "<", "sec", ":", "intercept", "-", "url", "pattern", "=", "\"/", "secure", "/", "admin", "/", "**", "\"", "access", "=", "\"", "hasRole", "(", "'", "ROLE_ADMIN", "'", ")\"", "/>", "<", "sec", ":", "intercept", "-", "url", "pattern", "=", "\"/", "secure", "/", "user", "/", "**", "\"", "access", "=", "\"", "hasAnyRole", "(", "'", "ROLE_USER", "'", ",'", "ROLE_ADMIN", "'", ",'", "ROLE_MANAGER", "'", ")\"", "/>"], "docstring_tokens": ["improper", "validation", "of", "user-supplied", "input"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "954", ",", "6", "+", "954", ",", "7", "@", "@", "static", "int", "rose_getname", "(", "struct", "socket", "*", "sock", ",", "struct", "sockaddr", "*", "uaddr", ",", "struct", "rose_sock", "*", "rose", "=", "rose_sk", "(", "sk", ")", ";", "int", "n", ";", "memset", "(", "srose", ",", "0", ",", "sizeof", "(", "*", "srose", ")", ");", "if", "(", "peer", "!", "=", "0", ")", "{", "if", "(", "sk", "-", ">", "sk_state", "!", "=", "TCP_ESTABLISHED", ")", "return", "-", "ENOTCONN", ";"], "docstring_tokens": ["does", "not", "initialize", "certain", "data", "structures", "within", "getname", "functions"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "18", ",", "6", "+", "18", ",", "7", "@", "@", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "nio", ".", "charset", ".", "UnsupportedCharsetException", ";", "import", "java", ".", "security", ".", "SecureRandom", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "Collections", ";", "@", "@", "-", "45", ",", "7", "+", "46", ",", "7", "@", "@", "'", "B", "'", ",", "'", "C", "'", ",", "'", "D", "'", ",", "'", "E", "'", ",", "'", "F", "'", ",", "'", "G", "'", ",", "'", "H", "'", ",", "'", "I", "'", ",", "'", "J", "'", ",", "'", "K", "'", ",", "'", "L", "'", ",", "'", "M", "'", ",", "'", "N", "'", ",", "'", "O", "'", ",", "'", "P", "'", ",", "'", "Q", "'", ",", "'", "R", "'", ",", "'", "S", "'", ",", "'", "T", "'", ",", "'", "U", "'", ",", "'", "V", "'", ",", "'", "W", "'", ",", "'", "X", "'", ",", "'", "Y", "'", ",", "'", "Z", "'", "};", "private", "static", "final", "Random", "RND", "=", "new", "Random", "(", ");", "private", "static", "final", "Random", "RND", "=", "new", "SecureRandom", "(", ");", "/", "**", "*", "Comparator", "used", "by", "{", "@", "link", "#", "sortBySpecificity", "(", "List", ")", "}."], "docstring_tokens": ["improper", "input", "validation"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "71", ",", "6", "+", "71", ",", "7", "@", "@", "import", "io", ".", "undertow", ".", "servlet", ".", "api", ".", "ThreadSetupHandler", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "api", ".", "WebResourceCollection", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "handlers", ".", "CrawlerSessionManagerHandler", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "handlers", ".", "RedirectDirHandler", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "handlers", ".", "ServletDispatchingHandler", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "handlers", ".", "ServletHandler", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "handlers", ".", "ServletInitialHandler", ";", "@", "@", "-", "218", ",", "6", "+", "219", ",", "7", "@", "@", "public", "Void", "call", "(", "HttpServerExchange", "exchange", ",", "Object", "ignore", ")", "throws", "Exception", "{", "HttpHandler", "wrappedHandlers", "=", "ServletDispatchingHandler", ".", "INSTANCE", ";", "wrappedHandlers", "=", "wrapHandlers", "(", "wrappedHandlers", ",", "deploymentInfo", ".", "getInnerHandlerChainWrappers", "(", "))", ";", "wrappedHandlers", "=", "new", "RedirectDirHandler", "(", "wrappedHandlers", ",", "deployment", ".", "getServletPaths", "(", "))", ";", "if", "(", "!", "deploymentInfo", ".", "isSecurityDisabled", "(", "))", "{", "HttpHandler", "securityHandler", "=", "setupSecurityHandlers", "(", "wrappedHandlers", ")", ";", "wrappedHandlers", "=", "new", "PredicateHandler", "(", "DispatcherTypePredicate", ".", "REQUEST", ",", "securityHandler", ",", "wrappedHandlers", ")", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "71", "@", "@", "/", "*", "*", "JBoss", ",", "Home", "of", "Professional", "Open", "Source", ".", "*", "Copyright", "2019", "Red", "Hat", ",", "Inc", ".", ",", "and", "individual", "contributors", "*", "as", "indicated", "by", "the", "@", "author", "tags", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "io", ".", "undertow", ".", "servlet", ".", "handlers", ";", "import", "io", ".", "undertow", ".", "server", ".", "HttpHandler", ";", "import", "io", ".", "undertow", ".", "server", ".", "HttpServerExchange", ";", "import", "io", ".", "undertow", ".", "util", ".", "Headers", ";", "import", "io", ".", "undertow", ".", "util", ".", "Methods", ";", "import", "io", ".", "undertow", ".", "util", ".", "RedirectBuilder", ";", "import", "io", ".", "undertow", ".", "util", ".", "StatusCodes", ";", "/", "**", "*", "Handler", "that", "redirects", "the", "directory", "requests", "without", "trailing", "slash", "to", "the", "one", "append", "trailing", "slash", ".", "*", "*", "@", "author", "Lin", "Gao", "*", "/", "public", "class", "RedirectDirHandler", "implements", "HttpHandler", "{", "private", "static", "final", "String", "HTTP2_UPGRADE_PREFIX", "=", "\"", "h2", "\"", ";", "private", "final", "HttpHandler", "next", ";", "private", "final", "ServletPathMatches", "paths", ";", "public", "RedirectDirHandler", "(", "HttpHandler", "next", ",", "ServletPathMatches", "paths", ")", "{", "this", ".", "next", "=", "next", ";", "this", ".", "paths", "=", "paths", ";", "}", "@", "Override", "public", "void", "handleRequest", "(", "HttpServerExchange", "exchange", ")", "throws", "Exception", "{", "final", "String", "path", "=", "exchange", ".", "getRelativePath", "(", ");", "final", "ServletPathMatch", "info", "=", "paths", ".", "getServletHandlerByPath", "(", "path", ")", ";", "/", "/", "https", ":", "//", "issues", ".", "jboss", ".", "org", "/", "browse", "/", "WFLY", "-", "3439", "/", "/", "if", "the", "request", "is", "an", "upgrade", "request", "then", "we", "don", "'", "t", "want", "to", "redirect", "/", "/", "as", "there", "is", "a", "good", "chance", "the", "web", "socket", "client", "won", "'", "t", "understand", "the", "redirect", "/", "/", "we", "make", "an", "exception", "for", "HTTP2", "upgrade", "requests", ",", "as", "this", "would", "have", "already", "be", "handled", "at", "/", "/", "the", "connector", "level", "if", "it", "was", "going", "to", "be", "handled", ".", "String", "upgradeString", "=", "exchange", ".", "getRequestHeaders", "(", ").", "getFirst", "(", "Headers", ".", "UPGRADE", ")", ";", "boolean", "isUpgradeRequest", "=", "upgradeString", "!", "=", "null", "&", "&", "!", "upgradeString", ".", "startsWith", "(", "HTTP2_UPGRADE_PREFIX", ")", ";", "if", "(", "info", ".", "getType", "(", ")", "=", "=", "ServletPathMatch", ".", "Type", ".", "REDIRECT", "&", "&", "!", "isUpgradeRequest", ")", "{", "/", "/", "UNDERTOW", "-", "89", "/", "/", "we", "redirect", "on", "GET", "requests", "to", "the", "root", "context", "to", "add", "an", "/", "to", "the", "end", "if", "(", "exchange", ".", "getRequestMethod", "(", ").", "equals", "(", "Methods", ".", "GET", ")", "|", "|", "exchange", ".", "getRequestMethod", "(", ").", "equals", "(", "Methods", ".", "HEAD", ")", ")", "{", "exchange", ".", "setStatusCode", "(", "StatusCodes", ".", "FOUND", ")", ";", "}", "else", "{", "exchange", ".", "setStatusCode", "(", "StatusCodes", ".", "TEMPORARY_REDIRECT", ")", ";", "}", "exchange", ".", "getResponseHeaders", "(", ").", "put", "(", "Headers", ".", "LOCATION", ",", "RedirectBuilder", ".", "redirect", "(", "exchange", ",", "exchange", ".", "getRelativePath", "(", ")", "+", "\"", "/\"", ",", "true", ")", ");", "return", ";", "}", "next", ".", "handleRequest", "(", "exchange", ")", ";", "}", "}", "@", "@", "-", "39", ",", "11", "+", "39", ",", "8", "@", "@", "import", "io", ".", "undertow", ".", "servlet", ".", "spec", ".", "HttpServletResponseImpl", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "spec", ".", "RequestDispatcherImpl", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "spec", ".", "ServletContextImpl", ";", "import", "io", ".", "undertow", ".", "util", ".", "Headers", ";", "import", "io", ".", "undertow", ".", "util", ".", "HttpString", ";", "import", "io", ".", "undertow", ".", "util", ".", "Methods", ";", "import", "io", ".", "undertow", ".", "util", ".", "Protocols", ";", "import", "io", ".", "undertow", ".", "util", ".", "RedirectBuilder", ";", "import", "io", ".", "undertow", ".", "util", ".", "StatusCodes", ";", "import", "org", ".", "xnio", ".", "ChannelListener", ";", "import", "org", ".", "xnio", ".", "Option", ";", "@", "@", "-", "80", ",", "8", "+", "77", ",", "6", "@", "@", "*", "/", "public", "class", "ServletInitialHandler", "implements", "HttpHandler", ",", "ServletDispatcher", "{", "private", "static", "final", "String", "HTTP2_UPGRADE_PREFIX", "=", "\"", "h2", "\"", ";", "private", "static", "final", "RuntimePermission", "PERMISSION", "=", "new", "RuntimePermission", "(", "\"", "io", ".", "undertow", ".", "servlet", ".", "CREATE_INITIAL_HANDLER", "\"", ");", "private", "final", "HttpHandler", "next", ";", "@", "@", "-", "149", ",", "30", "+", "144", ",", "12", "@", "@", "public", "void", "handleRequest", "(", "final", "HttpServerExchange", "exchange", ")", "throws", "Exception", "{", "return", ";", "}", "final", "ServletPathMatch", "info", "=", "paths", ".", "getServletHandlerByPath", "(", "path", ")", ";", "/", "/", "https", ":", "//", "issues", ".", "jboss", ".", "org", "/", "browse", "/", "WFLY", "-", "3439", "/", "/", "if", "the", "request", "is", "an", "upgrade", "request", "then", "we", "don", "'", "t", "want", "to", "redirect", "/", "/", "as", "there", "is", "a", "good", "chance", "the", "web", "socket", "client", "won", "'", "t", "understand", "the", "redirect", "/", "/", "we", "make", "an", "exception", "for", "HTTP2", "upgrade", "requests", ",", "as", "this", "would", "have", "already", "be", "handled", "at", "/", "/", "the", "connector", "level", "if", "it", "was", "going", "to", "be", "handled", ".", "String", "upgradeString", "=", "exchange", ".", "getRequestHeaders", "(", ").", "getFirst", "(", "Headers", ".", "UPGRADE", ")", ";", "boolean", "isUpgradeRequest", "=", "upgradeString", "!", "=", "null", "&", "&", "!", "upgradeString", ".", "startsWith", "(", "HTTP2_UPGRADE_PREFIX", ")", ";", "if", "(", "info", ".", "getType", "(", ")", "=", "=", "ServletPathMatch", ".", "Type", ".", "REDIRECT", "&", "&", "!", "isUpgradeRequest", ")", "{", "/", "/", "UNDERTOW", "-", "89", "/", "/", "we", "redirect", "on", "GET", "requests", "to", "the", "root", "context", "to", "add", "an", "/", "to", "the", "end", "if", "(", "exchange", ".", "getRequestMethod", "(", ").", "equals", "(", "Methods", ".", "GET", ")", "|", "|", "exchange", ".", "getRequestMethod", "(", ").", "equals", "(", "Methods", ".", "HEAD", ")", ")", "{", "exchange", ".", "setStatusCode", "(", "StatusCodes", ".", "FOUND", ")", ";", "}", "else", "{", "exchange", ".", "setStatusCode", "(", "StatusCodes", ".", "TEMPORARY_REDIRECT", ")", ";", "}", "exchange", ".", "getResponseHeaders", "(", ").", "put", "(", "Headers", ".", "LOCATION", ",", "RedirectBuilder", ".", "redirect", "(", "exchange", ",", "exchange", ".", "getRelativePath", "(", ")", "+", "\"", "/\"", ",", "true", ")", ");", "return", ";", "}", "else", "if", "(", "info", ".", "getType", "(", ")", "=", "=", "ServletPathMatch", ".", "Type", ".", "REWRITE", ")", "{", "/", "/", "this", "can", "only", "happen", "if", "the", "path", "ends", "with", "a", "/", "/", "/", "otherwise", "there", "would", "be", "a", "redirect", "instead", "if", "(", "info", ".", "getType", "(", ")", "=", "=", "ServletPathMatch", ".", "Type", ".", "REWRITE", ")", "{", "/", "/", "this", "can", "only", "happen", "if", "the", "path", "ends", "with", "a", "/", "/", "/", "otherwise", "there", "would", "be", "a", "redirect", "instead", "exchange", ".", "setRelativePath", "(", "info", ".", "getRewriteLocation", "(", "))", ";", "exchange", ".", "setRequestPath", "(", "exchange", ".", "getResolvedPath", "(", ")", "+", "info", ".", "getRewriteLocation", "(", "))", ";", "}", "final", "HttpServletResponseImpl", "response", "=", "new", "HttpServletResponseImpl", "(", "exchange", ",", "servletContext", ")", ";", "final", "HttpServletRequestImpl", "request", "=", "new", "HttpServletRequestImpl", "(", "exchange", ",", "servletContext", ")", ";", "final", "ServletRequestContext", "servletRequestContext", "=", "new", "ServletRequestContext", "(", "servletContext", ".", "getDeployment", "(", "),", "request", ",", "response", ",", "info", ")", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "168", "@", "@", "/", "*", "*", "JBoss", ",", "Home", "of", "Professional", "Open", "Source", ".", "*", "Copyright", "2019", "Red", "Hat", ",", "Inc", ".", ",", "and", "individual", "contributors", "*", "as", "indicated", "by", "the", "@", "author", "tags", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "io", ".", "undertow", ".", "servlet", ".", "test", ".", "defaultservlet", ";", "import", "static", "io", ".", "undertow", ".", "util", ".", "Headers", ".", "AUTHORIZATION", ";", "import", "static", "io", ".", "undertow", ".", "util", ".", "Headers", ".", "BASIC", ";", "import", "static", "io", ".", "undertow", ".", "util", ".", "Headers", ".", "LOCATION", ";", "import", "static", "io", ".", "undertow", ".", "util", ".", "Headers", ".", "WWW_AUTHENTICATE", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "javax", ".", "servlet", ".", "ServletException", ";", "import", "org", ".", "apache", ".", "http", ".", "Header", ";", "import", "org", ".", "apache", ".", "http", ".", "HttpResponse", ";", "import", "org", ".", "apache", ".", "http", ".", "client", ".", "HttpClient", ";", "import", "org", ".", "apache", ".", "http", ".", "client", ".", "methods", ".", "HttpGet", ";", "import", "org", ".", "apache", ".", "http", ".", "impl", ".", "client", ".", "HttpClientBuilder", ";", "import", "org", ".", "junit", ".", "Assert", ";", "import", "org", ".", "junit", ".", "BeforeClass", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", ";", "import", "io", ".", "undertow", ".", "server", ".", "handlers", ".", "PathHandler", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "api", ".", "DeploymentInfo", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "api", ".", "DeploymentManager", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "api", ".", "LoginConfig", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "api", ".", "SecurityConstraint", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "api", ".", "ServletContainer", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "api", ".", "WebResourceCollection", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "test", ".", "path", ".", "ServletPathMappingTestCase", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "test", ".", "security", ".", "constraint", ".", "ServletIdentityManager", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "test", ".", "util", ".", "TestClassIntrospector", ";", "import", "io", ".", "undertow", ".", "servlet", ".", "test", ".", "util", ".", "TestResourceLoader", ";", "import", "io", ".", "undertow", ".", "testutils", ".", "DefaultServer", ";", "import", "io", ".", "undertow", ".", "testutils", ".", "HttpClientUtils", ";", "import", "io", ".", "undertow", ".", "util", ".", "FlexBase64", ";", "import", "io", ".", "undertow", ".", "util", ".", "StatusCodes", ";", "/", "**", "*", "TestCase", "on", "redirect", "with", "or", "without", "trailing", "slash", "when", "requesting", "protected", "path", ".", "*", "*", "@", "author", "Lin", "Gao", "*", "/", "@", "RunWith", "(", "DefaultServer", ".", "class", ")", "public", "class", "SecurityRedirectTestCase", "{", "@", "BeforeClass", "public", "static", "void", "setup", "(", ")", "throws", "ServletException", "{", "final", "PathHandler", "root", "=", "new", "PathHandler", "(", ");", "final", "ServletContainer", "container", "=", "ServletContainer", ".", "Factory", ".", "newInstance", "(", ");", "ServletIdentityManager", "identityManager", "=", "new", "ServletIdentityManager", "(", ");", "identityManager", ".", "addUser", "(", "\"", "user1", "\"", ",", "\"", "password1", "\"", ",", "\"", "role1", "\"", ");", "DeploymentInfo", "builder", "=", "new", "DeploymentInfo", "(", ")", ".", "setClassIntrospecter", "(", "TestClassIntrospector", ".", "INSTANCE", ")", ".", "setClassLoader", "(", "ServletPathMappingTestCase", ".", "class", ".", "getClassLoader", "(", "))", ".", "setContextPath", "(", "\"/", "servletContext", "\"", ")", ".", "setDeploymentName", "(", "\"", "servletContext", ".", "war", "\"", ")", ".", "setResourceManager", "(", "new", "TestResourceLoader", "(", "SecurityRedirectTestCase", ".", "class", ")", ")", ".", "addWelcomePages", "(", "\"", "index", ".", "html", "\"", ")", ".", "setIdentityManager", "(", "identityManager", ")", ".", "setLoginConfig", "(", "new", "LoginConfig", "(", "\"", "BASIC", "\"", ",", "\"", "Test", "Realm", "\"", "))", ".", "addSecurityConstraint", "(", "new", "SecurityConstraint", "(", ")", ".", "addRoleAllowed", "(", "\"", "role1", "\"", ")", ".", "addWebResourceCollection", "(", "new", "WebResourceCollection", "(", ")", ".", "addUrlPatterns", "(", "\"/", "index", ".", "html", "\"", ",", "\"", "/", "filterpath", "/", "*\"", "))", ");", "DeploymentManager", "manager", "=", "container", ".", "addDeployment", "(", "builder", ")", ";", "manager", ".", "deploy", "(", ");", "root", ".", "addPrefixPath", "(", "builder", ".", "getContextPath", "(", "),", "manager", ".", "start", "(", "))", ";", "DefaultServer", ".", "setRootHandler", "(", "root", ")", ";", "}", "@", "SuppressWarnings", "(", "\"", "deprecation", "\"", ")", "@", "Test", "public", "void", "testSecurityWithWelcomeFileRedirect", "(", ")", "throws", "IOException", "{", "/", "/", "disable", "following", "redirect", "HttpClient", "client", "=", "HttpClientBuilder", ".", "create", "(", ").", "disableRedirectHandling", "(", ").", "build", "(", ");", "try", "{", "HttpGet", "get", "=", "new", "HttpGet", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "\"", ");", "HttpResponse", "result", "=", "client", ".", "execute", "(", "get", ")", ";", "Assert", ".", "assertEquals", "(", "StatusCodes", ".", "FOUND", ",", "result", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "))", ";", "Header", "[", "]", "values", "=", "result", ".", "getHeaders", "(", "LOCATION", ".", "toString", "(", "))", ";", "assertEquals", "(", "1", ",", "values", ".", "length", ")", ";", "assertEquals", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "/", "\",", "values", "[", "0", "]", ".", "getValue", "(", "))", ";", "HttpClientUtils", ".", "readResponse", "(", "result", ")", ";", "get", "=", "new", "HttpGet", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "/", "\")", ";", "result", "=", "client", ".", "execute", "(", "get", ")", ";", "Assert", ".", "assertEquals", "(", "StatusCodes", ".", "UNAUTHORIZED", ",", "result", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "))", ";", "values", "=", "result", ".", "getHeaders", "(", "WWW_AUTHENTICATE", ".", "toString", "(", "))", ";", "assertEquals", "(", "1", ",", "values", ".", "length", ")", ";", "assertEquals", "(", "BASIC", "+", "\"", "realm", "=", "\\\"", "Test", "Realm", "\\", "\"\"", ",", "values", "[", "0", "]", ".", "getValue", "(", "))", ";", "HttpClientUtils", ".", "readResponse", "(", "result", ")", ";", "get", "=", "new", "HttpGet", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "/", "\")", ";", "get", ".", "addHeader", "(", "AUTHORIZATION", ".", "toString", "(", "),", "BASIC", "+", "\"", "\"", "+", "FlexBase64", ".", "encodeString", "(", "\"", "user1", ":", "password1", "\"", ".", "getBytes", "(", "),", "false", ")", ");", "result", "=", "client", ".", "execute", "(", "get", ")", ";", "String", "response", "=", "HttpClientUtils", ".", "readResponse", "(", "result", ")", ";", "Assert", ".", "assertEquals", "(", "StatusCodes", ".", "OK", ",", "result", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "))", ";", "Assert", ".", "assertTrue", "(", "response", ".", "contains", "(", "\"", "Redirected", "home", "page", "\"", "))", ";", "}", "finally", "{", "client", ".", "getConnectionManager", "(", ").", "shutdown", "(", ");", "}", "}", "@", "SuppressWarnings", "(", "\"", "deprecation", "\"", ")", "@", "Test", "public", "void", "testSecurityWithoutWelcomeFileRedirect", "(", ")", "throws", "IOException", "{", "/", "/", "disable", "following", "redirect", "HttpClient", "client", "=", "HttpClientBuilder", ".", "create", "(", ").", "disableRedirectHandling", "(", ").", "build", "(", ");", "try", "{", "HttpGet", "get", "=", "new", "HttpGet", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "/", "filterpath", "\"", ");", "HttpResponse", "result", "=", "client", ".", "execute", "(", "get", ")", ";", "Assert", ".", "assertEquals", "(", "StatusCodes", ".", "UNAUTHORIZED", ",", "result", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "))", ";", "HttpClientUtils", ".", "readResponse", "(", "result", ")", ";", "get", "=", "new", "HttpGet", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "/", "filterpath", "/", "\")", ";", "result", "=", "client", ".", "execute", "(", "get", ")", ";", "Assert", ".", "assertEquals", "(", "StatusCodes", ".", "UNAUTHORIZED", ",", "result", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "))", ";", "Header", "[", "]", "values", "=", "result", ".", "getHeaders", "(", "WWW_AUTHENTICATE", ".", "toString", "(", "))", ";", "assertEquals", "(", "1", ",", "values", ".", "length", ")", ";", "assertEquals", "(", "BASIC", "+", "\"", "realm", "=", "\\\"", "Test", "Realm", "\\", "\"\"", ",", "values", "[", "0", "]", ".", "getValue", "(", "))", ";", "HttpClientUtils", ".", "readResponse", "(", "result", ")", ";", "get", "=", "new", "HttpGet", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "/", "filterpath", "\"", ");", "get", ".", "addHeader", "(", "AUTHORIZATION", ".", "toString", "(", "),", "BASIC", "+", "\"", "\"", "+", "FlexBase64", ".", "encodeString", "(", "\"", "user1", ":", "password1", "\"", ".", "getBytes", "(", "),", "false", ")", ");", "result", "=", "client", ".", "execute", "(", "get", ")", ";", "Assert", ".", "assertEquals", "(", "StatusCodes", ".", "FOUND", ",", "result", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "))", ";", "values", "=", "result", ".", "getHeaders", "(", "LOCATION", ".", "toString", "(", "))", ";", "assertEquals", "(", "1", ",", "values", ".", "length", ")", ";", "assertEquals", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "/", "filterpath", "/", "\",", "values", "[", "0", "]", ".", "getValue", "(", "))", ";", "HttpClientUtils", ".", "readResponse", "(", "result", ")", ";", "get", "=", "new", "HttpGet", "(", "DefaultServer", ".", "getDefaultServerURL", "(", ")", "+", "\"", "/", "servletContext", "/", "filterpath", "/", "filtered", ".", "txt", "\"", ");", "get", ".", "addHeader", "(", "AUTHORIZATION", ".", "toString", "(", "),", "BASIC", "+", "\"", "\"", "+", "FlexBase64", ".", "encodeString", "(", "\"", "user1", ":", "password1", "\"", ".", "getBytes", "(", "),", "false", ")", ");", "result", "=", "client", ".", "execute", "(", "get", ")", ";", "String", "response", "=", "HttpClientUtils", ".", "readResponse", "(", "result", ")", ";", "Assert", ".", "assertEquals", "(", "StatusCodes", ".", "OK", ",", "result", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "))", ";", "Assert", ".", "assertTrue", "(", "response", ".", "equals", "(", "\"", "Stuart", "\"", "))", ";", "}", "finally", "{", "client", ".", "getConnectionManager", "(", ").", "shutdown", "(", ");", "}", "}", "}"], "docstring_tokens": ["an", "issue", "with", "using", "predictable", "directory", "structures"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "332", ",", "6", "+", "332", ",", "7", "@", "@", "static", "int", "setup_routing_entry", "(", "struct", "kvm_irq_routing_table", "*", "rt", ",", "*", "/", "hlist_for_each_entry", "(", "ei", ",", "n", ",", "&", "rt", "-", ">", "map", "[", "ue", "-", ">", "gsi", "]", ",", "link", ")", "if", "(", "ei", "-", ">", "type", "=", "=", "KVM_IRQ_ROUTING_MSI", "|", "|", "ue", "-", ">", "type", "=", "=", "KVM_IRQ_ROUTING_MSI", "|", "|", "ue", "-", ">", "u", ".", "irqchip", ".", "irqchip", "=", "=", "ei", "-", ">", "irqchip", ".", "irqchip", ")", "return", "r", ";"], "docstring_tokens": ["improper", "bounds", "checking"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "143", ",", "7", "+", "143", ",", "29", "@", "@", "public", "UtilityService", "setParent", "(", "Service", "parent", ")", "{", "@", "Override", "public", "void", "authorizeRequest", "(", "Operation", "op", ")", "{", "op", ".", "complete", "(", ");", "String", "suffix", "=", "UriUtils", ".", "buildUriPath", "(", "UriUtils", ".", "URI_PATH_CHAR", ",", "UriUtils", ".", "getLastPathSegment", "(", "op", ".", "getUri", "(", "))", ");", "/", "/", "allow", "access", "to", "ui", "endpoint", "if", "(", "ServiceHost", ".", "SERVICE_URI_SUFFIX_UI", ".", "equals", "(", "suffix", ")", ")", "{", "op", ".", "complete", "(", ");", "return", ";", "}", "ServiceDocument", "doc", "=", "new", "ServiceDocument", "(", ");", "if", "(", "this", ".", "parent", ".", "getOptions", "(", ").", "contains", "(", "ServiceOption", ".", "FACTORY_ITEM", ")", ")", "{", "doc", ".", "documentSelfLink", "=", "UriUtils", ".", "buildUriPath", "(", "UriUtils", ".", "getParentPath", "(", "this", ".", "parent", ".", "getSelfLink", "(", "))", ",", "suffix", ")", ";", "}", "else", "{", "doc", ".", "documentSelfLink", "=", "UriUtils", ".", "buildUriPath", "(", "this", ".", "parent", ".", "getSelfLink", "(", "),", "suffix", ")", ";", "}", "doc", ".", "documentKind", "=", "Utils", ".", "buildKind", "(", "this", ".", "parent", ".", "getStateType", "(", "))", ";", "if", "(", "getHost", "(", ").", "isAuthorized", "(", "this", ".", "parent", ",", "doc", ",", "op", ")", ")", "{", "op", ".", "complete", "(", ");", "return", ";", "}", "op", ".", "fail", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ")", ";", "}", "@", "Override", "@", "@", "-", "462", ",", "16", "+", "462", ",", "20", "@", "@", "public", "void", "guestAuthorization", "(", ")", "throws", "Throwable", "{", ".", "setBody", "(", "state", ")", ");", "assertEquals", "(", "Operation", ".", "STATUS_CODE_UNAUTHORIZED", ",", "failureResponse", ".", "op", ".", "getStatusCode", "(", "))", ";", "OperationContext", ".", "setAuthorizationContext", "(", "this", ".", "host", ".", "getSystemAuthorizationContext", "(", "))", ";", "Map", "<", "String", ",", "ServiceStats", ".", "ServiceStat", ">", "stat", "=", "this", ".", "host", ".", "getServiceStats", "(", "UriUtils", ".", "buildUri", "(", "this", ".", "host", ",", "ServiceUriPaths", ".", "CORE_MANAGEMENT", ")", ");", "double", "currentInsertCount", "=", "stat", ".", "get", "(", "ServiceHostManagementService", ".", "STAT_NAME_AUTHORIZATION_CACHE_INSERT_COUNT", ")", ".", "latestValue", ";", "OperationContext", ".", "setAuthorizationContext", "(", "null", ")", ";", "/", "/", "Make", "a", "second", "request", "and", "verify", "that", "the", "cache", "did", "not", "get", "updated", ",", "instead", "Xenon", "re", "-", "used", "/", "/", "the", "cached", "Guest", "authorization", "context", ".", "sender", ".", "sendAndWait", "(", "Operation", ".", "createGet", "(", "this", ".", "host", ",", "ExampleService", ".", "FACTORY_LINK", ")", ");", "OperationContext", ".", "setAuthorizationContext", "(", "this", ".", "host", ".", "getSystemAuthorizationContext", "(", "))", ";", "stat", "=", "this", ".", "host", ".", "getServiceStats", "(", "UriUtils", ".", "buildUri", "(", "this", ".", "host", ",", "ServiceUriPaths", ".", "CORE_MANAGEMENT", ")", ");", "OperationContext", ".", "setAuthorizationContext", "(", "null", ")", ";", "double", "newInsertCount", "=", "stat", ".", "get", "(", "ServiceHostManagementService", ".", "STAT_NAME_AUTHORIZATION_CACHE_INSERT_COUNT", ")", ".", "latestValue", ";", "assertTrue", "(", "currentInsertCount", "=", "=", "newInsertCount", ")", ";", "@", "@", "-", "709", ",", "6", "+", "713", ",", "16", "@", "@", "public", "void", "statefulServiceAuthorization", "(", ")", "throws", "Throwable", "{", "}", "))", ";", "this", ".", "host", ".", "testWait", "(", "ctx2", ")", ";", "/", "/", "do", "GET", "on", "factory", "/", "stats", ",", "we", "should", "get", "403", "Operation", "statsGet", "=", "Operation", ".", "createGet", "(", "this", ".", "host", ",", "ExampleService", ".", "FACTORY_LINK", "+", "ServiceHost", ".", "SERVICE_URI_SUFFIX_STATS", ")", ";", "this", ".", "host", ".", "sendAndWaitExpectFailure", "(", "statsGet", ",", "Operation", ".", "STATUS_CODE_FORBIDDEN", ")", ";", "/", "/", "do", "GET", "on", "factory", "/", "config", ",", "we", "should", "get", "403", "Operation", "configGet", "=", "Operation", ".", "createGet", "(", "this", ".", "host", ",", "ExampleService", ".", "FACTORY_LINK", "+", "ServiceHost", ".", "SERVICE_URI_SUFFIX_CONFIG", ")", ";", "this", ".", "host", ".", "sendAndWaitExpectFailure", "(", "configGet", ",", "Operation", ".", "STATUS_CODE_FORBIDDEN", ")", ";", "/", "/", "Assume", "Jane", "'", "s", "identity", "this", ".", "host", ".", "assumeIdentity", "(", "this", ".", "userServicePath", ")", ";", "/", "/", "add", "docs", "accessible", "by", "jane", "@", "@", "-", "750", ",", "9", "+", "764", ",", "27", "@", "@", "public", "void", "statefulServiceAuthorization", "(", ")", "throws", "Throwable", "{", "/", "/", "reset", "the", "auth", "context", "OperationContext", ".", "setAuthorizationContext", "(", "null", ")", ";", "/", "/", "do", "GET", "on", "utility", "suffixes", "in", "example", "child", "services", ",", "we", "should", "get", "403", "for", "(", "URI", "childUri", ":", "exampleServices", ".", "keySet", "(", "))", "{", "statsGet", "=", "Operation", ".", "createGet", "(", "this", ".", "host", ",", "childUri", ".", "getPath", "(", ")", "+", "ServiceHost", ".", "SERVICE_URI_SUFFIX_STATS", ")", ";", "this", ".", "host", ".", "sendAndWaitExpectFailure", "(", "statsGet", ",", "Operation", ".", "STATUS_CODE_FORBIDDEN", ")", ";", "configGet", "=", "Operation", ".", "createGet", "(", "this", ".", "host", ",", "childUri", ".", "getPath", "(", ")", "+", "ServiceHost", ".", "SERVICE_URI_SUFFIX_CONFIG", ")", ";", "this", ".", "host", ".", "sendAndWaitExpectFailure", "(", "configGet", ",", "Operation", ".", "STATUS_CODE_FORBIDDEN", ")", ";", "}", "/", "/", "Assume", "Jane", "'", "s", "identity", "through", "header", "auth", "token", "String", "authToken", "=", "generateAuthToken", "(", "this", ".", "userServicePath", ")", ";", "/", "/", "do", "GET", "on", "utility", "suffixes", "in", "example", "child", "services", ",", "we", "should", "get", "200", "for", "(", "URI", "childUri", ":", "exampleServices", ".", "keySet", "(", "))", "{", "statsGet", "=", "Operation", ".", "createGet", "(", "this", ".", "host", ",", "childUri", ".", "getPath", "(", ")", "+", "ServiceHost", ".", "SERVICE_URI_SUFFIX_STATS", ")", ";", "statsGet", ".", "addRequestHeader", "(", "Operation", ".", "REQUEST_AUTH_TOKEN_HEADER", ",", "authToken", ")", ";", "this", ".", "host", ".", "sendAndWaitExpectSuccess", "(", "statsGet", ")", ";", "}", "verifyJaneAccess", "(", "exampleServices", ",", "authToken", ")", ";", "/", "/", "test", "user", "impersonation", "@", "@", "-", "81", ",", "10", "+", "81", ",", "6", "@", "@", "public", "void", "createUsers", "(", ")", "throws", "Throwable", "{", "*", "isn", "'", "t", "created", "immediately", ",", "so", "this", "polls", ".", "*", "/", "private", "String", "loginUser", "(", "URI", "hostUri", ")", "throws", "Throwable", "{", "URI", "usersLink", "=", "UriUtils", ".", "buildUri", "(", "hostUri", ",", "UserService", ".", "FACTORY_LINK", ")", ";", "/", "/", "wait", "for", "factory", "availability", "this", ".", "host", ".", "waitForReplicatedFactoryServiceAvailable", "(", "usersLink", ")", ";", "String", "basicAuth", "=", "BasicAuthenticationUtils", ".", "constructBasicAuth", "(", "adminUser", ",", "adminUser", ")", ";", "URI", "loginUri", "=", "UriUtils", ".", "buildUri", "(", "hostUri", ",", "ServiceUriPaths", ".", "CORE_AUTHN_BASIC", ")", ";", "AuthenticationRequest", "login", "=", "new", "AuthenticationRequest", "(", ");", "@", "@", "-", "417", ",", "9", "+", "417", ",", "13", "@", "@", "private", "void", "doRequestRateLimits", "(", ")", "throws", "Throwable", "{", "ri", ".", "limit", "=", "limit", ";", "ri", ".", "options", "=", "EnumSet", ".", "of", "(", "RequestRateInfo", ".", "Option", ".", "PAUSE_PROCESSING", ")", ";", "this", ".", "host", ".", "setRequestRateLimit", "(", "userPath", ",", "ri", ")", ";", "this", ".", "host", ".", "assumeIdentity", "(", "userPath", ")", ";", "this", ".", "host", ".", "setSystemAuthorizationContext", "(", ");", "ServiceStat", "rateLimitStatBefore", "=", "getRateLimitOpCountStat", "(", ");", "this", ".", "host", ".", "resetSystemAuthorizationContext", "(", ");", "this", ".", "host", ".", "assumeIdentity", "(", "userPath", ")", ";", "if", "(", "rateLimitStatBefore", "=", "=", "null", ")", "{", "rateLimitStatBefore", "=", "new", "ServiceStat", "(", ");", "rateLimitStatBefore", ".", "latestValue", "=", "0", ".", "0", ";", "@", "@", "-", "438", ",", "7", "+", "442", ",", "10", "@", "@", "private", "void", "doRequestRateLimits", "(", ")", "throws", "Throwable", "{", "}", "this", ".", "host", ".", "testWait", "(", "ctx2", ")", ";", "ctx2", ".", "logAfter", "(", ");", "this", ".", "host", ".", "setSystemAuthorizationContext", "(", ");", "ServiceStat", "rateLimitStatAfter", "=", "getRateLimitOpCountStat", "(", ");", "this", ".", "host", ".", "resetSystemAuthorizationContext", "(", ");", "assertTrue", "(", "rateLimitStatAfter", ".", "latestValue", ">", "rateLimitStatBefore", ".", "latestValue", ")", ";", "this", ".", "host", ".", "setMaintenanceIntervalMicros", "(", "@", "@", "-", "468", ",", "7", "+", "475", ",", "9", "@", "@", "private", "void", "doRequestRateLimits", "(", ")", "throws", "Throwable", "{", "ctx3", ".", "logAfter", "(", ");", "/", "/", "verify", "rate", "limiting", "did", "not", "happen", "this", ".", "host", ".", "setSystemAuthorizationContext", "(", ");", "ServiceStat", "rateLimitStatExpectSame", "=", "getRateLimitOpCountStat", "(", ");", "this", ".", "host", ".", "resetSystemAuthorizationContext", "(", ");", "assertTrue", "(", "rateLimitStatAfter", ".", "latestValue", "=", "=", "rateLimitStatExpectSame", ".", "latestValue", ")", ";", "}", "@", "@", "-", "2415", ",", "8", "+", "2424", ",", "9", "@", "@", "private", "ServiceStat", "getODLStopCountStat", "(", ")", "throws", "Throwable", "{", "private", "ServiceStat", "getRateLimitOpCountStat", "(", ")", "throws", "Throwable", "{", "URI", "managementServiceUri", "=", "this", ".", "host", ".", "getManagementServiceUri", "(", ");", "return", "this", ".", "host", ".", "getServiceStats", "(", "managementServiceUri", ")", "ServiceStat", "stats", "=", "this", ".", "host", ".", "getServiceStats", "(", "managementServiceUri", ")", ".", "get", "(", "ServiceHostManagementService", ".", "STAT_NAME_RATE_LIMITED_OP_COUNT", ")", ";", "return", "stats", ";", "}", "@", "Test", "@", "@", "-", "300", ",", "11", "+", "300", ",", "14", "@", "@", "public", "void", "subscriptionsWithAuth", "(", ")", "throws", "Throwable", "{", "}", "}", ";", "hostWithAuth", ".", "setSystemAuthorizationContext", "(", ");", "Operation", "subscribe", "=", "Operation", ".", "createPost", "(", "UriUtils", ".", "buildUri", "(", "hostWithAuth", ",", "minimalServiceUUID", ")", ");", "subscribe", ".", "setReferer", "(", "hostWithAuth", ".", "getReferer", "(", "))", ";", "ServiceSubscriber", "subscriber", "=", "new", "ServiceSubscriber", "(", ");", "subscriber", ".", "replayState", "=", "true", ";", "hostWithAuth", ".", "startSubscriptionService", "(", "subscribe", ",", "notifyC", ",", "subscriber", ")", ";", "hostWithAuth", ".", "resetAuthorizationContext", "(", ");", "hostWithAuth", ".", "testWait", "(", "notifyContext", ")", ";", "}", "finally", "{", "if", "(", "hostWithAuth", "!", "=", "null", ")", "{", "@", "@", "-", "14", ",", "8", "+", "14", ",", "13", "@", "@", "package", "com", ".", "vmware", ".", "xenon", ".", "common", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "ServiceHost", ".", "SERVICE_URI_SUFFIX_SYNCHRONIZATION", ";", "import", "static", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "ServiceHost", ".", "SERVICE_URI_SUFFIX_TEMPLATE", ";", "import", "static", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "ServiceHost", ".", "SERVICE_URI_SUFFIX_UI", ";", "import", "java", ".", "net", ".", "URI", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "EnumSet", ";", "@", "@", "-", "34", ",", "10", "+", "39", ",", "16", "@", "@", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "ServiceStats", ".", "TimeSeriesStats", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "ServiceStats", ".", "TimeSeriesStats", ".", "AggregationType", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "ServiceStats", ".", "TimeSeriesStats", ".", "TimeBin", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "test", ".", "AuthTestUtils", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "test", ".", "TestContext", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "test", ".", "TestRequestSender", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "test", ".", "TestRequestSender", ".", "FailureResponse", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "test", ".", "VerificationHost", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "services", ".", "common", ".", "AuthorizationContextService", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "services", ".", "common", ".", "ExampleService", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "services", ".", "common", ".", "ExampleService", ".", "ExampleServiceState", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "services", ".", "common", ".", "MinimalTestService", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "services", ".", "common", ".", "QueryTask", ".", "Query", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "services", ".", "common", ".", "ServiceUriPaths", ";", "public", "class", "TestUtilityService", "extends", "BasicReusableHostTestCase", "{", "@", "@", "-", "823", ",", "4", "+", "834", ",", "158", "@", "@", "public", "void", "statsKeyOrder", "(", ")", "{", "assertEquals", "(", "\"", "stat", "index", "2", "\"", ",", "\"", "keyCCC", "\"", ",", "statList", ".", "get", "(", "2", ")", ");", "}", "@", "Test", "public", "void", "endpointAuthorization", "(", ")", "throws", "Throwable", "{", "VerificationHost", "host", "=", "VerificationHost", ".", "create", "(", "0", ")", ";", "host", ".", "setAuthorizationService", "(", "new", "AuthorizationContextService", "(", "))", ";", "host", ".", "setAuthorizationEnabled", "(", "true", ")", ";", "host", ".", "setMaintenanceIntervalMicros", "(", "TimeUnit", ".", "MILLISECONDS", ".", "toMicros", "(", "100", ")", ");", "host", ".", "start", "(", ");", "TestRequestSender", "sender", "=", "host", ".", "getTestRequestSender", "(", ");", "host", ".", "setSystemAuthorizationContext", "(", ");", "host", ".", "waitForReplicatedFactoryServiceAvailable", "(", "UriUtils", ".", "buildUri", "(", "host", ",", "ExampleService", ".", "FACTORY_LINK", ")", ");", "String", "exampleUser", "=", "\"", "example", "@", "vmware", ".", "com", "\"", ";", "String", "examplePass", "=", "\"", "password", "\"", ";", "TestContext", "authCtx", "=", "host", ".", "testCreate", "(", "1", ")", ";", "AuthorizationSetupHelper", ".", "create", "(", ")", ".", "setHost", "(", "host", ")", ".", "setUserEmail", "(", "exampleUser", ")", ".", "setUserPassword", "(", "examplePass", ")", ".", "setResourceQuery", "(", "Query", ".", "Builder", ".", "create", "(", ")", ".", "addFieldClause", "(", "ServiceDocument", ".", "FIELD_NAME_KIND", ",", "Utils", ".", "buildKind", "(", "ExampleServiceState", ".", "class", ")", ")", ".", "build", "(", "))", ".", "setCompletion", "(", "authCtx", ".", "getCompletion", "(", "))", ".", "start", "(", ");", "authCtx", ".", "await", "(", ");", "/", "/", "create", "a", "sample", "service", "ExampleServiceState", "doc", "=", "new", "ExampleServiceState", "(", ");", "doc", ".", "name", "=", "\"", "foo", "\"", ";", "doc", ".", "documentSelfLink", "=", "\"", "foo", "\"", ";", "Operation", "post", "=", "Operation", ".", "createPost", "(", "host", ",", "ExampleService", ".", "FACTORY_LINK", ")", ".", "setBody", "(", "doc", ")", ";", "ExampleServiceState", "postResult", "=", "sender", ".", "sendAndWait", "(", "post", ",", "ExampleServiceState", ".", "class", ")", ";", "host", ".", "resetAuthorizationContext", "(", ");", "URI", "factoryAvailableUri", "=", "UriUtils", ".", "buildAvailableUri", "(", "host", ",", "ExampleService", ".", "FACTORY_LINK", ")", ";", "URI", "factoryStatsUri", "=", "UriUtils", ".", "buildStatsUri", "(", "host", ",", "ExampleService", ".", "FACTORY_LINK", ")", ";", "URI", "factoryConfigUri", "=", "UriUtils", ".", "buildConfigUri", "(", "host", ",", "ExampleService", ".", "FACTORY_LINK", ")", ";", "URI", "factorySubscriptionUri", "=", "UriUtils", ".", "buildSubscriptionUri", "(", "host", ",", "ExampleService", ".", "FACTORY_LINK", ")", ";", "URI", "factoryTemplateUri", "=", "UriUtils", ".", "buildUri", "(", "host", ",", "UriUtils", ".", "buildUriPath", "(", "ExampleService", ".", "FACTORY_LINK", ",", "SERVICE_URI_SUFFIX_TEMPLATE", ")", ");", "URI", "factorySynchUri", "=", "UriUtils", ".", "buildUri", "(", "host", ",", "UriUtils", ".", "buildUriPath", "(", "ExampleService", ".", "FACTORY_LINK", ",", "SERVICE_URI_SUFFIX_SYNCHRONIZATION", ")", ");", "URI", "factoryUiUri", "=", "UriUtils", ".", "buildUri", "(", "host", ",", "UriUtils", ".", "buildUriPath", "(", "ExampleService", ".", "FACTORY_LINK", ",", "SERVICE_URI_SUFFIX_UI", ")", ");", "URI", "serviceAvailableUri", "=", "UriUtils", ".", "buildAvailableUri", "(", "host", ",", "postResult", ".", "documentSelfLink", ")", ";", "URI", "serviceStatsUri", "=", "UriUtils", ".", "buildStatsUri", "(", "host", ",", "postResult", ".", "documentSelfLink", ")", ";", "URI", "serviceConfigUri", "=", "UriUtils", ".", "buildConfigUri", "(", "host", ",", "postResult", ".", "documentSelfLink", ")", ";", "URI", "serviceSubscriptionUri", "=", "UriUtils", ".", "buildSubscriptionUri", "(", "host", ",", "postResult", ".", "documentSelfLink", ")", ";", "URI", "serviceTemplateUri", "=", "UriUtils", ".", "buildUri", "(", "host", ",", "UriUtils", ".", "buildUriPath", "(", "postResult", ".", "documentSelfLink", ",", "SERVICE_URI_SUFFIX_TEMPLATE", ")", ");", "URI", "serviceSynchUri", "=", "UriUtils", ".", "buildUri", "(", "host", ",", "UriUtils", ".", "buildUriPath", "(", "postResult", ".", "documentSelfLink", ",", "SERVICE_URI_SUFFIX_SYNCHRONIZATION", ")", ");", "URI", "serviceUiUri", "=", "UriUtils", ".", "buildUri", "(", "host", ",", "UriUtils", ".", "buildUriPath", "(", "postResult", ".", "documentSelfLink", ",", "SERVICE_URI_SUFFIX_UI", ")", ");", "/", "/", "check", "non", "-", "authenticated", "user", "receives", "forbidden", "response", "FailureResponse", "failureResponse", ";", "Operation", "uiOpResult", ";", "/", "/", "check", "factory", "endpoints", "failureResponse", "=", "sender", ".", "sendAndWaitFailure", "(", "Operation", ".", "createGet", "(", "factoryAvailableUri", ")", ");", "assertEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "failureResponse", ".", "op", ".", "getStatusCode", "(", "))", ";", "failureResponse", "=", "sender", ".", "sendAndWaitFailure", "(", "Operation", ".", "createGet", "(", "factoryStatsUri", ")", ");", "assertEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "failureResponse", ".", "op", ".", "getStatusCode", "(", "))", ";", "failureResponse", "=", "sender", ".", "sendAndWaitFailure", "(", "Operation", ".", "createGet", "(", "factoryConfigUri", ")", ");", "assertEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "failureResponse", ".", "op", ".", "getStatusCode", "(", "))", ";", "failureResponse", "=", "sender", ".", "sendAndWaitFailure", "(", "Operation", ".", "createGet", "(", "factorySubscriptionUri", ")", ");", "assertEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "failureResponse", ".", "op", ".", "getStatusCode", "(", "))", ";", "failureResponse", "=", "sender", ".", "sendAndWaitFailure", "(", "Operation", ".", "createGet", "(", "factoryTemplateUri", ")", ");", "assertEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "failureResponse", ".", "op", ".", "getStatusCode", "(", "))", ";", "failureResponse", "=", "sender", ".", "sendAndWaitFailure", "(", "Operation", ".", "createGet", "(", "factorySynchUri", ")", ");", "assertEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "failureResponse", ".", "op", ".", "getStatusCode", "(", "))", ";", "uiOpResult", "=", "sender", ".", "sendAndWait", "(", "Operation", ".", "createGet", "(", "factoryUiUri", ")", ");", "assertNotEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "uiOpResult", ".", "getStatusCode", "(", "))", ";", "/", "/", "check", "service", "endpoints", "failureResponse", "=", "sender", ".", "sendAndWaitFailure", "(", "Operation", ".", "createGet", "(", "serviceAvailableUri", ")", ");", "assertEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "failureResponse", ".", "op", ".", "getStatusCode", "(", "))", ";", "failureResponse", "=", "sender", ".", "sendAndWaitFailure", "(", "Operation", ".", "createGet", "(", "serviceStatsUri", ")", ");", "assertEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "failureResponse", ".", "op", ".", "getStatusCode", "(", "))", ";", "failureResponse", "=", "sender", ".", "sendAndWaitFailure", "(", "Operation", ".", "createGet", "(", "serviceConfigUri", ")", ");", "assertEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "failureResponse", ".", "op", ".", "getStatusCode", "(", "))", ";", "failureResponse", "=", "sender", ".", "sendAndWaitFailure", "(", "Operation", ".", "createGet", "(", "serviceSubscriptionUri", ")", ");", "assertEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "failureResponse", ".", "op", ".", "getStatusCode", "(", "))", ";", "failureResponse", "=", "sender", ".", "sendAndWaitFailure", "(", "Operation", ".", "createGet", "(", "serviceTemplateUri", ")", ");", "assertEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "failureResponse", ".", "op", ".", "getStatusCode", "(", "))", ";", "failureResponse", "=", "sender", ".", "sendAndWaitFailure", "(", "Operation", ".", "createGet", "(", "serviceSynchUri", ")", ");", "assertEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "failureResponse", ".", "op", ".", "getStatusCode", "(", "))", ";", "uiOpResult", "=", "sender", ".", "sendAndWait", "(", "Operation", ".", "createGet", "(", "serviceUiUri", ")", ");", "assertNotEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "uiOpResult", ".", "getStatusCode", "(", "))", ";", "/", "/", "check", "authenticated", "user", "does", "NOT", "receive", "forbidden", "response", "AuthTestUtils", ".", "login", "(", "host", ",", "exampleUser", ",", "examplePass", ")", ";", "Operation", "response", ";", "/", "/", "check", "factory", "endpoints", "response", "=", "sender", ".", "sendAndWait", "(", "Operation", ".", "createGet", "(", "factoryAvailableUri", ")", ");", "assertNotEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "response", ".", "getStatusCode", "(", "))", ";", "response", "=", "sender", ".", "sendAndWait", "(", "Operation", ".", "createGet", "(", "factoryStatsUri", ")", ");", "assertNotEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "response", ".", "getStatusCode", "(", "))", ";", "response", "=", "sender", ".", "sendAndWait", "(", "Operation", ".", "createGet", "(", "factoryConfigUri", ")", ");", "assertNotEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "response", ".", "getStatusCode", "(", "))", ";", "response", "=", "sender", ".", "sendAndWait", "(", "Operation", ".", "createGet", "(", "factorySubscriptionUri", ")", ");", "assertNotEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "response", ".", "getStatusCode", "(", "))", ";", "response", "=", "sender", ".", "sendAndWait", "(", "Operation", ".", "createGet", "(", "factoryTemplateUri", ")", ");", "assertNotEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "response", ".", "getStatusCode", "(", "))", ";", "failureResponse", "=", "sender", ".", "sendAndWaitFailure", "(", "Operation", ".", "createGet", "(", "factorySynchUri", ")", ");", "assertNotEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "failureResponse", ".", "op", ".", "getStatusCode", "(", "))", ";", "response", "=", "sender", ".", "sendAndWait", "(", "Operation", ".", "createGet", "(", "factoryUiUri", ")", ");", "assertNotEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "response", ".", "getStatusCode", "(", "))", ";", "/", "/", "check", "service", "endpoints", "response", "=", "sender", ".", "sendAndWait", "(", "Operation", ".", "createGet", "(", "serviceAvailableUri", ")", ");", "assertNotEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "response", ".", "getStatusCode", "(", "))", ";", "response", "=", "sender", ".", "sendAndWait", "(", "Operation", ".", "createGet", "(", "serviceStatsUri", ")", ");", "assertNotEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "response", ".", "getStatusCode", "(", "))", ";", "response", "=", "sender", ".", "sendAndWait", "(", "Operation", ".", "createGet", "(", "serviceConfigUri", ")", ");", "assertNotEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "response", ".", "getStatusCode", "(", "))", ";", "response", "=", "sender", ".", "sendAndWait", "(", "Operation", ".", "createGet", "(", "serviceSubscriptionUri", ")", ");", "assertNotEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "response", ".", "getStatusCode", "(", "))", ";", "response", "=", "sender", ".", "sendAndWait", "(", "Operation", ".", "createGet", "(", "serviceTemplateUri", ")", ");", "assertNotEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "response", ".", "getStatusCode", "(", "))", ";", "failureResponse", "=", "sender", ".", "sendAndWaitFailure", "(", "Operation", ".", "createGet", "(", "serviceSynchUri", ")", ");", "assertNotEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "failureResponse", ".", "op", ".", "getStatusCode", "(", "))", ";", "response", "=", "sender", ".", "sendAndWait", "(", "Operation", ".", "createGet", "(", "serviceUiUri", ")", ");", "assertNotEquals", "(", "Operation", ".", "STATUS_CODE_FORBIDDEN", ",", "response", ".", "getStatusCode", "(", "))", ";", "}", "}", "@", "@", "-", "30", ",", "6", "+", "30", ",", "7", "@", "@", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "ServiceHost", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "UriUtils", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "Utils", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "services", ".", "common", ".", "ExampleService", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "services", ".", "common", ".", "ExampleService", ".", "ExampleServiceState", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "services", ".", "common", ".", "QueryTask", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "services", ".", "common", ".", "QueryTask", ".", "Query", ";", "@", "@", "-", "247", ",", "6", "+", "248", ",", "22", "@", "@", "public", "String", "getUserGroupName", "(", "String", "email", ")", "{", "UriUtils", ".", "buildUriPath", "(", "ServiceUriPaths", ".", "CORE_AUTHZ_USERS", ",", "email", ")", ")", ".", "build", "(", "))", ";", "/", "/", "Create", "resource", "group", "to", "allow", "access", "on", "utility", "paths", "String", "statsResourceGroupLink", "=", "createResourceGroup", "(", "target", ",", "\"", "stats", "-", "resource", "-", "group", "\"", ",", "Builder", ".", "create", "(", ")", ".", "addFieldClause", "(", "ServiceDocument", ".", "FIELD_NAME_SELF_LINK", ",", "ExampleService", ".", "FACTORY_LINK", "+", "ServiceHost", ".", "SERVICE_URI_SUFFIX_STATS", ")", ".", "build", "(", "))", ";", "String", "subscriptionsResourceGroupLink", "=", "createResourceGroup", "(", "target", ",", "\"", "subs", "-", "resource", "-", "group", "\"", ",", "Builder", ".", "create", "(", ")", ".", "addFieldClause", "(", "ServiceDocument", ".", "FIELD_NAME_SELF_LINK", ",", "ServiceUriPaths", ".", "CORE_LOCAL_QUERY_TASKS", "+", "ServiceHost", ".", "SERVICE_URI_SUFFIX_SUBSCRIPTIONS", ")", ".", "build", "(", "))", ";", "Collection", "<", "String", ">", "paths", "=", "new", "HashSet", "<", ">(", ");", "/", "/", "Create", "roles", "tying", "these", "together", "@", "@", "-", "261", ",", "6", "+", "278", ",", "16", "@", "@", "public", "String", "getUserGroupName", "(", "String", "email", ")", "{", "/", "/", "Create", "role", "authorizing", "access", "to", "the", "user", "'", "s", "own", "query", "tasks", "paths", ".", "add", "(", "createRole", "(", "target", ",", "userGroupLink", ",", "queryTaskResourceGroupLink", ",", "new", "HashSet", "<", ">(", "Arrays", ".", "asList", "(", "Action", ".", "GET", ",", "Action", ".", "POST", ",", "Action", ".", "PATCH", ",", "Action", ".", "DELETE", ")", "))", ");", "/", "/", "Create", "role", "authorizing", "access", "to", "/", "stats", "paths", ".", "add", "(", "createRole", "(", "target", ",", "userGroupLink", ",", "statsResourceGroupLink", ",", "new", "HashSet", "<", ">(", "Arrays", ".", "asList", "(", "Action", ".", "GET", ",", "Action", ".", "POST", ",", "Action", ".", "PATCH", ",", "Action", ".", "DELETE", ")", "))", ");", "/", "/", "Create", "role", "authorizing", "access", "to", "/", "subscriptions", "of", "query", "tasks", "paths", ".", "add", "(", "createRole", "(", "target", ",", "userGroupLink", ",", "subscriptionsResourceGroupLink", ",", "new", "HashSet", "<", ">(", "Arrays", ".", "asList", "(", "Action", ".", "GET", ",", "Action", ".", "POST", ",", "Action", ".", "PATCH", ",", "Action", ".", "DELETE", ")", "))", ");", "return", "paths", ";", "}", "@", "@", "-", "83", ",", "6", "+", "83", ",", "7", "@", "@", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "Operation", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "Operation", ".", "AuthorizationContext", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "Operation", ".", "CompletionHandler", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "OperationContext", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "Service", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "Service", ".", "Action", ";", "import", "com", ".", "vmware", ".", "xenon", ".", "common", ".", "Service", ".", "ServiceOption", ";", "@", "@", "-", "1052", ",", "7", "+", "1053", ",", "15", "@", "@", "public", "ServiceDocumentQueryResult", "getExpandedFactoryState", "(", "URI", "factoryUri", ")", "{", "}", "public", "Map", "<", "String", ",", "ServiceStat", ">", "getServiceStats", "(", "URI", "serviceUri", ")", "{", "AuthorizationContext", "ctx", "=", "null", ";", "if", "(", "this", ".", "isAuthorizationEnabled", "(", "))", "{", "ctx", "=", "OperationContext", ".", "getAuthorizationContext", "(", ");", "this", ".", "setSystemAuthorizationContext", "(", ");", "}", "ServiceStats", "stats", "=", "this", ".", "sender", ".", "sendStatsGetAndWait", "(", "serviceUri", ")", ";", "if", "(", "this", ".", "isAuthorizationEnabled", "(", "))", "{", "this", ".", "setAuthorizationContext", "(", "ctx", ")", ";", "}", "return", "stats", ".", "entries", ";", "}", "@", "@", "-", "3027", ",", "6", "+", "3027", ",", "7", "@", "@", "public", "void", "replicationWithAuthzCacheClear", "(", ")", "throws", "Throwable", "{", "VerificationHost", "groupHost", "=", "this", ".", "host", ".", "getPeerHost", "(", ");", "groupHost", ".", "setSystemAuthorizationContext", "(", ");", "/", "/", "wait", "for", "auth", "related", "services", "to", "be", "stabilized", "groupHost", ".", "waitForReplicatedFactoryServiceAvailable", "(", "UriUtils", ".", "buildUri", "(", "groupHost", ",", "UserService", ".", "FACTORY_LINK", ")", ");", "@", "@", "-", "3044", ",", "7", "+", "3045", ",", "7", "@", "@", "public", "void", "replicationWithAuthzCacheClear", "(", ")", "throws", "Throwable", "{", "String", "bazUserLink", "=", "UriUtils", ".", "buildUriPath", "(", "ServiceUriPaths", ".", "CORE_AUTHZ_USERS", ",", "\"", "baz", "@", "vmware", ".", "com", "\"", ");", "groupHost", ".", "setSystemAuthorizationContext", "(", ");", "/", "/", "create", "user", ",", "user", "-", "group", ",", "resource", "-", "group", ",", "role", "for", "foo", "@", "vmware", ".", "com", "/", "/", "user", ":", "/", "core", "/", "authz", "/", "users", "/", "foo", "@", "vmware", ".", "com", "@", "@", "-", "3255", ",", "7", "+", "3256", ",", "7", "@", "@", "private", "void", "populateAuthCacheInAllPeers", "(", "AuthorizationContext", "authContext", ")", "throw", "/", "/", "based", "on", "the", "role", "created", "in", "test", ",", "all", "users", "have", "access", "to", "ExampleService", "this", ".", "host", ".", "sendAndWaitExpectSuccess", "(", "Operation", ".", "createGet", "(", "UriUtils", ".", "buildStatsUri", "(", "peer", ",", "ExampleService", ".", "FACTORY_LINK", ")", "))", ";", "Operation", ".", "createGet", "(", "UriUtils", ".", "buildUri", "(", "peer", ",", "ExampleService", ".", "FACTORY_LINK", ")", "))", ";", "}", "this", ".", "host", ".", "waitFor", "(", "\"", "Timeout", "waiting", "for", "correct", "auth", "cache", "state", "\"", ","], "docstring_tokens": ["insufficient", "access", "controls", "for", "utility", "endpoints", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1112", ",", "6", "+", "1112", ",", "9", "@", "@", "static", "Image", "*", "ReadWPGImage", "(", "const", "ImageInfo", "*", "image_info", ",", "bpp", "=", "BitmapHeader2", ".", "Depth", ";", "UnpackRaster", ":", "status", "=", "SetImageExtent", "(", "image", ",", "image", "-", ">", "columns", ",", "image", "-", ">", "rows", ",", "exception", ")", ";", "if", "(", "status", "=", "=", "MagickFalse", ")", "break", ";", "if", "(", "(", "image", "-", ">", "colors", "=", "=", "0", ")", "&", "&", "(", "bpp", "!", "=", "24", ")", ")", "{", "image", "-", ">", "colors", "=", "one", "<", "<", "bpp", ";", "@", "@", "-", "1305", ",", "6", "+", "1308", ",", "9", "@", "@", "static", "Image", "*", "ReadWPGImage", "(", "const", "ImageInfo", "*", "image_info", ",", "}", "image", "-", ">", "columns", "=", "Bitmap2Header1", ".", "Width", ";", "image", "-", ">", "rows", "=", "Bitmap2Header1", ".", "Height", ";", "status", "=", "SetImageExtent", "(", "image", ",", "image", "-", ">", "columns", ",", "image", "-", ">", "rows", ",", "exception", ")", ";", "if", "(", "status", "=", "=", "MagickFalse", ")", "break", ";", "if", "(", "(", "image", "-", ">", "colors", "=", "=", "0", ")", "&", "&", "(", "bpp", "!", "=", "24", ")", ")", "{", "@", "@", "-", "1423", ",", "9", "+", "1429", ",", "6", "@", "@", "static", "Image", "*", "ReadWPGImage", "(", "const", "ImageInfo", "*", "image_info", ",", "ThrowReaderException", "(", "CoderError", ",", "\"", "DataEncodingSchemeIsNotSupported", "\"", ");", "}", "}", "status", "=", "SetImageExtent", "(", "image", ",", "image", "-", ">", "columns", ",", "image", "-", ">", "rows", ",", "exception", ")", ";", "if", "(", "status", "=", "=", "MagickFalse", ")", "return", "(", "DestroyImageList", "(", "image", ")", ");", "Finish", ":", "(", "void", ")", "CloseBlob", "(", "image", ")", ";"], "docstring_tokens": ["the", "lack", "of", "required", "NULL", "pointer", "checks"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "32", ",", "9", "+", "32", ",", "11", "@", "@", "*", "/", "public", "class", "MethodClosure", "extends", "Closure", "{", "public", "static", "boolean", "ALLOW_RESOLVE", "=", "false", ";", "private", "static", "final", "Class", "[", "]", "EMPTY_CLASS_ARRAY", "=", "new", "Class", "[", "0", "]", ";", "private", "String", "method", ";", "public", "MethodClosure", "(", "Object", "owner", ",", "String", "method", ")", "{", "super", "(", "owner", ")", ";", "this", ".", "method", "=", "method", ";", "@", "@", "-", "62", ",", "6", "+", "64", ",", "13", "@", "@", "public", "String", "getMethod", "(", ")", "{", "protected", "Object", "doCall", "(", "Object", "arguments", ")", "{", "return", "InvokerHelper", ".", "invokeMethod", "(", "getOwner", "(", "),", "method", ",", "arguments", ")", ";", "}", "private", "Object", "readResolve", "(", ")", "{", "if", "(", "ALLOW_RESOLVE", ")", "{", "return", "this", ";", "}", "throw", "new", "UnsupportedOperationException", "(", ");", "}", "public", "Object", "getProperty", "(", "String", "property", ")", "{", "if", "(", "\"", "method", "\"", ".", "equals", "(", "property", ")", ")", "{"], "docstring_tokens": ["the", "failure", "to", "isolate", "serialization", "code", "when", "using", "standard", "Java", "serialization", "mechanim", "to", "communicate", "between", "servers"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "{", "\"", "directory", "\"", ":", "\"", "vendor", "/", "bower", "\"", "}", "@", "@", "-", "88", ",", "18", "+", "88", ",", "18", "@", "@", "module", ".", "exports", "=", "(", "grunt", ")", "-", ">", "objectToExport", ":", "'", "Simditor", "'", "globalAlias", ":", "'", "Simditor", "'", "deps", ":", "'", "default", "'", ":", "[", "'$", "',", "'", "SimpleModule", "'", ",", "'", "simpleHotkeys", "'", ",", "'", "simpleUploader", "'", "]", "amd", ":", "[", "'", "jquery", "'", ",", "'", "simple", "-", "module", "'", ",", "'", "simple", "-", "hotkeys", "'", ",", "'", "simple", "-", "uploader", "'", "]", "cjs", ":", "[", "'", "jquery", "'", ",", "'", "simple", "-", "module", "'", ",", "'", "simple", "-", "hotkeys", "'", ",", "'", "simple", "-", "uploader", "'", "]", "'", "default", "'", ":", "[", "'$", "',", "'", "SimpleModule", "'", ",", "'", "simpleHotkeys", "'", ",", "'", "simpleUploader", "'", ",", "'", "DOMPurify", "'", "]", "amd", ":", "[", "'", "jquery", "'", ",", "'", "simple", "-", "module", "'", ",", "'", "simple", "-", "hotkeys", "'", ",", "'", "simple", "-", "uploader", "'", ",", "'", "dompurify", "'", "]", "cjs", ":", "[", "'", "jquery", "'", ",", "'", "simple", "-", "module", "'", ",", "'", "simple", "-", "hotkeys", "'", ",", "'", "simple", "-", "uploader", "'", ",", "'", "dompurify", "'", "]", "global", ":", "items", ":", "[", "'", "jQuery", "'", ",", "'", "SimpleModule", "'", ",", "'", "simple", ".", "hotkeys", "'", ",", "'", "simple", ".", "uploader", "'", "]", "items", ":", "[", "'", "jQuery", "'", ",", "'", "SimpleModule", "'", ",", "'", "simple", ".", "hotkeys", "'", ",", "'", "simple", ".", "uploader", "'", ",", "'", "window", ".", "DOMPurify", "'", "]", "prefix", ":", "'", "'", "suffix", ":", "'", "'", "copy", ":", "vendor", ":", "files", ":", "[", "{", "src", ":", "'", "vendor", "/", "bower", "/", "jquery", "/", "dist", "/", "jquery", ".", "min", ".", "js", "'", ",", "src", ":", "'", "node_modules", "/", "jquery", "/", "dist", "/", "jquery", ".", "min", ".", "js", "'", ",", "dest", ":", "'", "site", "/", "assets", "/", "scripts", "/", "jquery", ".", "min", ".", "js", "'", "}", "]", "styles", ":", "@", "@", "-", "109", ",", "14", "+", "109", ",", "17", "@", "@", "module", ".", "exports", "=", "(", "grunt", ")", "-", ">", "}", "]", "scripts", ":", "files", ":", "[", "{", "src", ":", "'", "vendor", "/", "bower", "/", "simple", "-", "module", "/", "lib", "/", "module", ".", "js", "'", ",", "src", ":", "'", "node_modules", "/", "simple", "-", "module", "/", "lib", "/", "module", ".", "js", "'", ",", "dest", ":", "'", "site", "/", "assets", "/", "scripts", "/", "module", ".", "js", "'", "}", ",", "{", "src", ":", "'", "vendor", "/", "bower", "/", "simple", "-", "uploader", "/", "lib", "/", "uploader", ".", "js", "'", ",", "src", ":", "'", "node_modules", "/", "simple", "-", "uploader", "/", "lib", "/", "uploader", ".", "js", "'", ",", "dest", ":", "'", "site", "/", "assets", "/", "scripts", "/", "uploader", ".", "js", "'", "}", ",", "{", "src", ":", "'", "vendor", "/", "bower", "/", "simple", "-", "hotkeys", "/", "lib", "/", "hotkeys", ".", "js", "'", ",", "src", ":", "'", "node_modules", "/", "simple", "-", "hotkeys", "/", "lib", "/", "hotkeys", ".", "js", "'", ",", "dest", ":", "'", "site", "/", "assets", "/", "scripts", "/", "hotkeys", ".", "js", "'", "}", ",", "{", "src", ":", "'", "node_modules", "/", "dompurify", "/", "dist", "/", "purify", ".", "js", "'", ",", "dest", ":", "'", "site", "/", "assets", "/", "scripts", "/", "dompurify", ".", "js", "'", "}", ",", "{", "src", ":", "'", "lib", "/", "simditor", ".", "js", "'", ",", "dest", ":", "'", "site", "/", "assets", "/", "scripts", "/", "simditor", ".", "js", "'", "@", "@", "-", "129", ",", "17", "+", "132", ",", "20", "@", "@", "module", ".", "exports", "=", "(", "grunt", ")", "-", ">", "src", ":", "'", "lib", "/", "*'", ",", "dest", ":", "'", "package", "/", "scripts", "/", "'", "}", ",", "{", "src", ":", "'", "vendor", "/", "bower", "/", "jquery", "/", "dist", "/", "jquery", ".", "min", ".", "js", "'", ",", "src", ":", "'", "node_modules", "/", "jquery", "/", "dist", "/", "jquery", ".", "min", ".", "js", "'", ",", "dest", ":", "'", "package", "/", "scripts", "/", "jquery", ".", "min", ".", "js", "'", "}", ",", "{", "src", ":", "'", "vendor", "/", "bower", "/", "simple", "-", "module", "/", "lib", "/", "module", ".", "js", "'", ",", "src", ":", "'", "node_modules", "/", "simple", "-", "module", "/", "lib", "/", "module", ".", "js", "'", ",", "dest", ":", "'", "package", "/", "scripts", "/", "module", ".", "js", "'", "}", ",", "{", "src", ":", "'", "vendor", "/", "bower", "/", "simple", "-", "uploader", "/", "lib", "/", "uploader", ".", "js", "'", ",", "src", ":", "'", "node_modules", "/", "simple", "-", "uploader", "/", "lib", "/", "uploader", ".", "js", "'", ",", "dest", ":", "'", "package", "/", "scripts", "/", "uploader", ".", "js", "'", "}", ",", "{", "src", ":", "'", "vendor", "/", "bower", "/", "simple", "-", "hotkeys", "/", "lib", "/", "hotkeys", ".", "js", "'", ",", "src", ":", "'", "node_modules", "/", "simple", "-", "hotkeys", "/", "lib", "/", "hotkeys", ".", "js", "'", ",", "dest", ":", "'", "package", "/", "scripts", "/", "hotkeys", ".", "js", "'", "}", ",", "{", "src", ":", "'", "node_modules", "/", "dompurify", "/", "dist", "/", "purify", ".", "js", "'", ",", "dest", ":", "'", "package", "/", "scripts", "/", "dompurify", ".", "js", "'", "}", ",", "{", "expand", ":", "true", ",", "flatten", ":", "true", "@", "@", "-", "234", ",", "10", "+", "240", ",", "11", "@", "@", "module", ".", "exports", "=", "(", "grunt", ")", "-", ">", "'", "spec", "/", "buttons", "/", "*.", "js", "'", "]", "vendor", ":", "[", "'", "vendor", "/", "bower", "/", "jquery", "/", "dist", "/", "jquery", ".", "min", ".", "js", "'", "'", "vendor", "/", "bower", "/", "simple", "-", "module", "/", "lib", "/", "module", ".", "js", "'", "'", "vendor", "/", "bower", "/", "simple", "-", "uploader", "/", "lib", "/", "uploader", ".", "js", "'", "'", "vendor", "/", "bower", "/", "simple", "-", "hotkeys", "/", "lib", "/", "hotkeys", ".", "js", "'", "'", "node_modules", "/", "jquery", "/", "dist", "/", "jquery", ".", "min", ".", "js", "'", "'", "node_modules", "/", "simple", "-", "module", "/", "lib", "/", "module", ".", "js", "'", "'", "node_modules", "/", "simple", "-", "uploader", "/", "lib", "/", "uploader", ".", "js", "'", "'", "node_modules", "/", "simple", "-", "hotkeys", "/", "lib", "/", "hotkeys", ".", "js", "'", "'", "node_modules", "/", "dompurify", "/", "dist", "/", "purify", ".", "js", "'", "]", "curl", ":", "@", "@", "-", "9", ",", "6", "+", "9", ",", "5", "@", "@", "It", "is", "used", "by", "[", "Tower", "]", "(", "http", ":", "//", "tower", ".", "im", ")", "-", "-", "a", "popular", "project", "management", "web", "appli", "Supported", "Browsers", ":", "IE10", "+", "\u3001", "Chrome", "\u3001", "Firefox", "\u3001", "Safari", ".", "*", "[", "Download", "Zip", "]", "(", "https", ":", "//", "github", ".", "com", "/", "mycolorway", "/", "simditor", "/", "releases", ")", "*", "Install", "with", "npm", ":", "$", "npm", "install", "simditor", "<", "/", "li", ">", "*", "Install", "with", "bower", ":", "$", "bower", "install", "simditor", "<", "/", "li", ">", "Demo", "and", "docs", "can", "be", "found", "[", "here", "]", "(", "http", ":", "//", "simditor", ".", "tower", ".", "im", "/", ").", "@", "@", "-", "1", ",", "40", "+", "0", ",", "0", "@", "@", "{", "\"", "name", "\"", ":", "\"", "simditor", "\"", ",", "\"", "version", "\"", ":", "\"", "2", ".", "3", ".", "21", "\"", ",", "\"", "homepage", "\"", ":", "\"", "http", ":", "//", "simditor", ".", "tower", ".", "im", "/", "\",", "\"", "authors", "\"", ":", "[", "\"", "farthinker", "<", "farthinker", "@", "gmail", ".", "com", ">", "\"", "]", ",", "\"", "description", "\"", ":", "\"", "A", "simple", "online", "editor", "\"", ",", "\"", "main", "\"", ":", "[", "\"", "lib", "/", "simditor", ".", "js", "\"", ",", "\"", "styles", "/", "simditor", ".", "css", "\"", "]", ",", "\"", "keywords", "\"", ":", "[", "\"", "editor", "\"", "]", ",", "\"", "license", "\"", ":", "\"", "MIT", "\"", ",", "\"", "ignore", "\"", ":", "[", "\"", "**", "/.", "*\"", ",", "\"", "spec", "\"", ",", "\"", "node_modules", "\"", ",", "\"", "vendor", "\"", ",", "\"", "site", "\"", ",", "\"", "_config", ".", "yml", "\"", ",", "\"", "Gemfile", "\"", ",", "\"", "Gemfile", ".", "lock", "\"", ",", "\"", "Gruntfile", ".", "coffee", "\"", ",", "\"", "package", ".", "json", "\"", ",", "\"", "server", ".", "js", "\"", ",", "\"", "README", ".", "md", "\"", ",", "\"", "umd", ".", "hbs", "\"", "]", ",", "\"", "devDependencies", "\"", ":", "{", "}", ",", "\"", "dependencies", "\"", ":", "{", "\"", "jquery", "\"", ":", "\"", "~", "2", ".", "1", ".", "4", "\"", ",", "\"", "simple", "-", "hotkeys", "\"", ":", "\"", "~", "1", ".", "0", ".", "3", "\"", ",", "\"", "simple", "-", "uploader", "\"", ":", "\"", "~", "2", ".", "0", ".", "7", "\"", ",", "\"", "simple", "-", "module", "\"", ":", "\"", "~", "2", ".", "0", ".", "6", "\"", "}", "}", "@", "@", "-", "1", ",", "7", "+", "0", ",", "0", "@", "@", "dependencies", ":", "pre", ":", "-", "npm", "install", "-", "g", "bower", "-", "bower", "install", "machine", ":", "ruby", ":", "version", ":", "2", ".", "3", ".", "1", "@", "@", "-", "1", ",", "23", "+", "1", ",", "23", "@", "@", "/", "*!", "*", "Simditor", "v2", ".", "3", ".", "21", "*", "http", ":", "//", "simditor", ".", "tower", ".", "im", "/", "*", "2018", "-", "10", "-", "17", "*", "2018", "-", "11", "-", "09", "*", "/", "(", "function", "(", "root", ",", "factory", ")", "{", "if", "(", "typeof", "define", "=", "==", "'", "function", "'", "&", "&", "define", ".", "amd", ")", "{", "/", "/", "AMD", ".", "Register", "as", "an", "anonymous", "module", "unless", "amdModuleId", "is", "set", "define", "(", "'", "simditor", "'", ",", "[", "\"", "jquery", "\"", ",\"", "simple", "-", "module", "\"", ",\"", "simple", "-", "hotkeys", "\"", ",\"", "simple", "-", "uploader", "\"", "],", "function", "(", "$,", "SimpleModule", ",", "simpleHotkeys", ",", "simpleUploader", ")", "{", "return", "(", "root", "[", "'", "Simditor", "'", "]", "=", "factory", "(", "$,", "SimpleModule", ",", "simpleHotkeys", ",", "simpleUploader", ")", ");", "define", "(", "'", "simditor", "'", ",", "[", "\"", "jquery", "\"", ",\"", "simple", "-", "module", "\"", ",\"", "simple", "-", "hotkeys", "\"", ",\"", "simple", "-", "uploader", "\"", ",\"", "dompurify", "\"", "],", "function", "(", "$,", "SimpleModule", ",", "simpleHotkeys", ",", "simpleUploader", ",", "DOMPurify", ")", "{", "return", "(", "root", "[", "'", "Simditor", "'", "]", "=", "factory", "(", "$,", "SimpleModule", ",", "simpleHotkeys", ",", "simpleUploader", ",", "DOMPurify", ")", ");", "}", ");", "}", "else", "if", "(", "typeof", "exports", "=", "==", "'", "object", "'", ")", "{", "/", "/", "Node", ".", "Does", "not", "work", "with", "strict", "CommonJS", ",", "but", "/", "/", "only", "CommonJS", "-", "like", "environments", "that", "support", "module", ".", "exports", ",", "/", "/", "like", "Node", ".", "module", ".", "exports", "=", "factory", "(", "require", "(", "\"", "jquery", "\"", "),", "require", "(", "\"", "simple", "-", "module", "\"", "),", "require", "(", "\"", "simple", "-", "hotkeys", "\"", "),", "require", "(", "\"", "simple", "-", "uploader", "\"", "))", ";", "module", ".", "exports", "=", "factory", "(", "require", "(", "\"", "jquery", "\"", "),", "require", "(", "\"", "simple", "-", "module", "\"", "),", "require", "(", "\"", "simple", "-", "hotkeys", "\"", "),", "require", "(", "\"", "simple", "-", "uploader", "\"", "),", "require", "(", "\"", "dompurify", "\"", "))", ";", "}", "else", "{", "root", "[", "'", "Simditor", "'", "]", "=", "factory", "(", "jQuery", ",", "SimpleModule", ",", "simple", ".", "hotkeys", ",", "simple", ".", "uploader", ")", ";", "root", "[", "'", "Simditor", "'", "]", "=", "factory", "(", "jQuery", ",", "SimpleModule", ",", "simple", ".", "hotkeys", ",", "simple", ".", "uploader", ",", "window", ".", "DOMPurify", ")", ";", "}", "}", "(", "this", ",", "function", "(", "$,", "SimpleModule", ",", "simpleHotkeys", ",", "simpleUploader", ")", "{", "}", "(", "this", ",", "function", "(", "$,", "SimpleModule", ",", "simpleHotkeys", ",", "simpleUploader", ",", "DOMPurify", ")", "{", "var", "AlignmentButton", ",", "BlockquoteButton", ",", "BoldButton", ",", "Button", ",", "Clipboard", ",", "CodeButton", ",", "CodePopover", ",", "ColorButton", ",", "FontScaleButton", ",", "Formatter", ",", "HrButton", ",", "ImageButton", ",", "ImagePopover", ",", "IndentButton", ",", "Indentation", ",", "InputManager", ",", "ItalicButton", ",", "Keystroke", ",", "LinkButton", ",", "LinkPopover", ",", "ListButton", ",", "OrderListButton", ",", "OutdentButton", ",", "Popover", ",", "Selection", ",", "Simditor", ",", "StrikethroughButton", ",", "TableButton", ",", "TitleButton", ",", "Toolbar", ",", "UnderlineButton", ",", "UndoManager", ",", "UnorderListButton", ",", "Util", ",", "extend", "=", "function", "(", "child", ",", "parent", ")", "{", "for", "(", "var", "key", "in", "parent", ")", "{", "if", "(", "hasProp", ".", "call", "(", "parent", ",", "key", ")", ")", "child", "[", "key", "]", "=", "parent", "[", "key", "]", ";", "}", "function", "ctor", "(", ")", "{", "this", ".", "constructor", "=", "child", ";", "}", "ctor", ".", "prototype", "=", "parent", ".", "prototype", ";", "child", ".", "prototype", "=", "new", "ctor", "(", ");", "child", ".", "__super__", "=", "parent", ".", "prototype", ";", "return", "child", ";", "}", ",", "@", "@", "-", "2342", ",", "7", "+", "2342", ",", "7", "@", "@", "Clipboard", "=", "(", "function", "(", "superClass", ")", "{", "return", "function", "(", ")", "{", "var", "pasteContent", ";", "_this", ".", "editor", ".", "hidePopover", "(", ");", "_this", ".", "editor", ".", "body", ".", "get", "(", "0", ")", ".", "innerHTML", "=", "state", ".", "html", ";", "_this", ".", "editor", ".", "body", ".", "get", "(", "0", ")", ".", "innerHTML", "=", "DOMPurify", "?", "DOMPurify", ".", "sanitize", "(", "state", ".", "html", ")", ":", "state", ".", "html", ";", "_this", ".", "editor", ".", "undoManager", ".", "caretPosition", "(", "state", ".", "caret", ")", ";", "_this", ".", "editor", ".", "body", ".", "focus", "(", ");", "_this", ".", "editor", ".", "selection", ".", "reset", "(", ");", "@", "@", "-", "2649", ",", "7", "+", "2649", ",", "7", "@", "@", "Simditor", "=", "(", "function", "(", "superClass", ")", "{", "Simditor", ".", "prototype", ".", "setValue", "=", "function", "(", "val", ")", "{", "this", ".", "hidePopover", "(", ");", "this", ".", "textarea", ".", "val", "(", "val", ")", ";", "this", ".", "body", ".", "get", "(", "0", ")", ".", "innerHTML", "=", "val", ";", "this", ".", "body", ".", "get", "(", "0", ")", ".", "innerHTML", "=", "DOMPurify", "?", "DOMPurify", ".", "sanitize", "(", "val", ")", ":", "val", ";", "this", ".", "formatter", ".", "format", "(", ");", "this", ".", "formatter", ".", "decorate", "(", ");", "this", ".", "util", ".", "reflow", "(", "this", ".", "body", ")", ";", "@", "@", "-", "1", ",", "6", "+", "1", ",", "6", "@", "@", "{", "\"", "name", "\"", ":", "\"", "simditor", "\"", ",", "\"", "version", "\"", ":", "\"", "2", ".", "3", ".", "21", "\"", ",", "\"", "version", "\"", ":", "\"", "2", ".", "3", ".", "22", "\"", ",", "\"", "description", "\"", ":", "\"", "A", "simple", "online", "editor", "\"", ",", "\"", "keywords", "\"", ":", "\"", "editor", "simditor", "\"", ",", "\"", "repository", "\"", ":", "{", "@", "@", "-", "23", ",", "26", "+", "23", ",", "28", "@", "@", "]", ",", "\"", "homepage", "\"", ":", "\"", "http", ":", "//", "simditor", ".", "tower", ".", "im", "\"", ",", "\"", "dependencies", "\"", ":", "{", "\"", "dompurify", "\"", ":", "\"", "^", "1", ".", "0", ".", "8", "\"", ",", "\"", "jquery", "\"", ":", "\"", "~", "2", ".", "1", ".", "4", "\"", ",", "\"", "simple", "-", "hotkeys", "\"", ":", "\"", "~", "1", ".", "0", ".", "3", "\"", ",", "\"", "simple", "-", "uploader", "\"", ":", "\"", "~", "2", ".", "0", ".", "7", "\"", ",", "\"", "simple", "-", "module", "\"", ":", "\"", "~", "2", ".", "0", ".", "6", "\"", "\"", "simple", "-", "module", "\"", ":", "\"", "~", "2", ".", "0", ".", "6", "\"", ",", "\"", "simple", "-", "uploader", "\"", ":", "\"", "~", "2", ".", "0", ".", "7", "\"", "}", ",", "\"", "devDependencies", "\"", ":", "{", "\"", "express", "\"", ":", "\"", "~", "3", ".", "3", ".", "4", "\"", ",", "\"", "grunt", "\"", ":", "\"", "0", ".", "x", "\"", ",", "\"", "grunt", "-", "contrib", "-", "sass", "\"", ":", "\"", "0", ".", "x", "\"", ",", "\"", "grunt", "-", "contrib", "-", "watch", "\"", ":", "\"", "0", ".", "x", "\"", ",", "\"", "grunt", "-", "banner", "\"", ":", "\"", "0", ".", "3", ".", "x", "\"", ",", "\"", "grunt", "-", "contrib", "-", "clean", "\"", ":", "\"", "0", ".", "x", "\"", ",", "\"", "grunt", "-", "contrib", "-", "coffee", "\"", ":", "\"", "0", ".", "x", "\"", ",", "\"", "grunt", "-", "contrib", "-", "copy", "\"", ":", "\"", "0", ".", "x", "\"", ",", "\"", "grunt", "-", "contrib", "-", "uglify", "\"", ":", "\"", "0", ".", "x", "\"", ",", "\"", "grunt", "-", "contrib", "-", "compress", "\"", ":", "\"", "0", ".", "x", "\"", ",", "\"", "grunt", "-", "contrib", "-", "clean", "\"", ":", "\"", "0", ".", "x", "\"", ",", "\"", "grunt", "-", "contrib", "-", "copy", "\"", ":", "\"", "0", ".", "x", "\"", ",", "\"", "grunt", "-", "contrib", "-", "jasmine", "\"", ":", "\"", "0", ".", "x", "\"", ",", "\"", "grunt", "-", "jekyll", "\"", ":", "\"", "0", ".", "x", "\"", ",", "\"", "grunt", "-", "umd", "\"", ":", "\"", "2", ".", "3", ".", "x", "\"", ",", "\"", "grunt", "-", "express", "\"", ":", "\"", "1", ".", "4", ".", "0", "\"", ",", "\"", "grunt", "-", "banner", "\"", ":", "\"", "0", ".", "3", ".", "x", "\"", ",", "\"", "grunt", "-", "contrib", "-", "sass", "\"", ":", "\"", "0", ".", "x", "\"", ",", "\"", "grunt", "-", "contrib", "-", "uglify", "\"", ":", "\"", "0", ".", "x", "\"", ",", "\"", "grunt", "-", "contrib", "-", "watch", "\"", ":", "\"", "0", ".", "x", "\"", ",", "\"", "grunt", "-", "curl", "\"", ":", "\"", "2", ".", "1", ".", "x", "\"", ",", "\"", "express", "\"", ":", "\"", "~", "3", ".", "3", ".", "4", "\"", "\"", "grunt", "-", "express", "\"", ":", "\"", "1", ".", "4", ".", "0", "\"", ",", "\"", "grunt", "-", "jekyll", "\"", ":", "\"", "0", ".", "x", "\"", ",", "\"", "grunt", "-", "parallel", "\"", ":", "\"", "^", "0", ".", "5", ".", "1", "\"", ",", "\"", "grunt", "-", "umd", "\"", ":", "\"", "2", ".", "3", ".", "x", "\"", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "1017", "@", "@", "(", "function", "(", "global", ",", "factory", ")", "{", "typeof", "exports", "=", "==", "'", "object", "'", "&", "&", "typeof", "module", "!", "==", "'", "undefined", "'", "?", "module", ".", "exports", "=", "factory", "(", ")", ":", "typeof", "define", "=", "==", "'", "function", "'", "&", "&", "define", ".", "amd", "?", "define", "(", "factory", ")", ":", "(", "global", ".", "DOMPurify", "=", "factory", "(", "))", ";", "}", "(", "this", ",", "(", "function", "(", ")", "{", "'", "use", "strict", "'", ";", "var", "html", "=", "[", "'", "a", "'", ",", "'", "abbr", "'", ",", "'", "acronym", "'", ",", "'", "address", "'", ",", "'", "area", "'", ",", "'", "article", "'", ",", "'", "aside", "'", ",", "'", "audio", "'", ",", "'", "b", "'", ",", "'", "bdi", "'", ",", "'", "bdo", "'", ",", "'", "big", "'", ",", "'", "blink", "'", ",", "'", "blockquote", "'", ",", "'", "body", "'", ",", "'", "br", "'", ",", "'", "button", "'", ",", "'", "canvas", "'", ",", "'", "caption", "'", ",", "'", "center", "'", ",", "'", "cite", "'", ",", "'", "code", "'", ",", "'", "col", "'", ",", "'", "colgroup", "'", ",", "'", "content", "'", ",", "'", "data", "'", ",", "'", "datalist", "'", ",", "'", "dd", "'", ",", "'", "decorator", "'", ",", "'", "del", "'", ",", "'", "details", "'", ",", "'", "dfn", "'", ",", "'", "dir", "'", ",", "'", "div", "'", ",", "'", "dl", "'", ",", "'", "dt", "'", ",", "'", "element", "'", ",", "'", "em", "'", ",", "'", "fieldset", "'", ",", "'", "figcaption", "'", ",", "'", "figure", "'", ",", "'", "font", "'", ",", "'", "footer", "'", ",", "'", "form", "'", ",", "'", "h1", "'", ",", "'", "h2", "'", ",", "'", "h3", "'", ",", "'", "h4", "'", ",", "'", "h5", "'", ",", "'", "h6", "'", ",", "'", "head", "'", ",", "'", "header", "'", ",", "'", "hgroup", "'", ",", "'", "hr", "'", ",", "'", "html", "'", ",", "'", "i", "'", ",", "'", "img", "'", ",", "'", "input", "'", ",", "'", "ins", "'", ",", "'", "kbd", "'", ",", "'", "label", "'", ",", "'", "legend", "'", ",", "'", "li", "'", ",", "'", "main", "'", ",", "'", "map", "'", ",", "'", "mark", "'", ",", "'", "marquee", "'", ",", "'", "menu", "'", ",", "'", "menuitem", "'", ",", "'", "meter", "'", ",", "'", "nav", "'", ",", "'", "nobr", "'", ",", "'", "ol", "'", ",", "'", "optgroup", "'", ",", "'", "option", "'", ",", "'", "output", "'", ",", "'", "p", "'", ",", "'", "pre", "'", ",", "'", "progress", "'", ",", "'", "q", "'", ",", "'", "rp", "'", ",", "'", "rt", "'", ",", "'", "ruby", "'", ",", "'", "s", "'", ",", "'", "samp", "'", ",", "'", "section", "'", ",", "'", "select", "'", ",", "'", "shadow", "'", ",", "'", "small", "'", ",", "'", "source", "'", ",", "'", "spacer", "'", ",", "'", "span", "'", ",", "'", "strike", "'", ",", "'", "strong", "'", ",", "'", "style", "'", ",", "'", "sub", "'", ",", "'", "summary", "'", ",", "'", "sup", "'", ",", "'", "table", "'", ",", "'", "tbody", "'", ",", "'", "td", "'", ",", "'", "template", "'", ",", "'", "textarea", "'", ",", "'", "tfoot", "'", ",", "'", "th", "'", ",", "'", "thead", "'", ",", "'", "time", "'", ",", "'", "tr", "'", ",", "'", "track", "'", ",", "'", "tt", "'", ",", "'", "u", "'", ",", "'", "ul", "'", ",", "'", "var", "'", ",", "'", "video", "'", ",", "'", "wbr", "'", "];", "/", "/", "SVG", "var", "svg", "=", "[", "'", "svg", "'", ",", "'", "a", "'", ",", "'", "altglyph", "'", ",", "'", "altglyphdef", "'", ",", "'", "altglyphitem", "'", ",", "'", "animatecolor", "'", ",", "'", "animatemotion", "'", ",", "'", "animatetransform", "'", ",", "'", "audio", "'", ",", "'", "canvas", "'", ",", "'", "circle", "'", ",", "'", "clippath", "'", ",", "'", "defs", "'", ",", "'", "desc", "'", ",", "'", "ellipse", "'", ",", "'", "filter", "'", ",", "'", "font", "'", ",", "'", "g", "'", ",", "'", "glyph", "'", ",", "'", "glyphref", "'", ",", "'", "hkern", "'", ",", "'", "image", "'", ",", "'", "line", "'", ",", "'", "lineargradient", "'", ",", "'", "marker", "'", ",", "'", "mask", "'", ",", "'", "metadata", "'", ",", "'", "mpath", "'", ",", "'", "path", "'", ",", "'", "pattern", "'", ",", "'", "polygon", "'", ",", "'", "polyline", "'", ",", "'", "radialgradient", "'", ",", "'", "rect", "'", ",", "'", "stop", "'", ",", "'", "style", "'", ",", "'", "switch", "'", ",", "'", "symbol", "'", ",", "'", "text", "'", ",", "'", "textpath", "'", ",", "'", "title", "'", ",", "'", "tref", "'", ",", "'", "tspan", "'", ",", "'", "video", "'", ",", "'", "view", "'", ",", "'", "vkern", "'", "];", "var", "svgFilters", "=", "[", "'", "feBlend", "'", ",", "'", "feColorMatrix", "'", ",", "'", "feComponentTransfer", "'", ",", "'", "feComposite", "'", ",", "'", "feConvolveMatrix", "'", ",", "'", "feDiffuseLighting", "'", ",", "'", "feDisplacementMap", "'", ",", "'", "feDistantLight", "'", ",", "'", "feFlood", "'", ",", "'", "feFuncA", "'", ",", "'", "feFuncB", "'", ",", "'", "feFuncG", "'", ",", "'", "feFuncR", "'", ",", "'", "feGaussianBlur", "'", ",", "'", "feMerge", "'", ",", "'", "feMergeNode", "'", ",", "'", "feMorphology", "'", ",", "'", "feOffset", "'", ",", "'", "fePointLight", "'", ",", "'", "feSpecularLighting", "'", ",", "'", "feSpotLight", "'", ",", "'", "feTile", "'", ",", "'", "feTurbulence", "'", "];", "var", "mathMl", "=", "[", "'", "math", "'", ",", "'", "menclose", "'", ",", "'", "merror", "'", ",", "'", "mfenced", "'", ",", "'", "mfrac", "'", ",", "'", "mglyph", "'", ",", "'", "mi", "'", ",", "'", "mlabeledtr", "'", ",", "'", "mmuliscripts", "'", ",", "'", "mn", "'", ",", "'", "mo", "'", ",", "'", "mover", "'", ",", "'", "mpadded", "'", ",", "'", "mphantom", "'", ",", "'", "mroot", "'", ",", "'", "mrow", "'", ",", "'", "ms", "'", ",", "'", "mpspace", "'", ",", "'", "msqrt", "'", ",", "'", "mystyle", "'", ",", "'", "msub", "'", ",", "'", "msup", "'", ",", "'", "msubsup", "'", ",", "'", "mtable", "'", ",", "'", "mtd", "'", ",", "'", "mtext", "'", ",", "'", "mtr", "'", ",", "'", "munder", "'", ",", "'", "munderover", "'", "];", "var", "text", "=", "[", "'#", "text", "'", "];", "var", "html", "$", "1", "=", "[", "'", "accept", "'", ",", "'", "action", "'", ",", "'", "align", "'", ",", "'", "alt", "'", ",", "'", "autocomplete", "'", ",", "'", "background", "'", ",", "'", "bgcolor", "'", ",", "'", "border", "'", ",", "'", "cellpadding", "'", ",", "'", "cellspacing", "'", ",", "'", "checked", "'", ",", "'", "cite", "'", ",", "'", "class", "'", ",", "'", "clear", "'", ",", "'", "color", "'", ",", "'", "cols", "'", ",", "'", "colspan", "'", ",", "'", "coords", "'", ",", "'", "crossorigin", "'", ",", "'", "datetime", "'", ",", "'", "default", "'", ",", "'", "dir", "'", ",", "'", "disabled", "'", ",", "'", "download", "'", ",", "'", "enctype", "'", ",", "'", "face", "'", ",", "'", "for", "'", ",", "'", "headers", "'", ",", "'", "height", "'", ",", "'", "hidden", "'", ",", "'", "high", "'", ",", "'", "href", "'", ",", "'", "hreflang", "'", ",", "'", "id", "'", ",", "'", "integrity", "'", ",", "'", "ismap", "'", ",", "'", "label", "'", ",", "'", "lang", "'", ",", "'", "list", "'", ",", "'", "loop", "'", ",", "'", "low", "'", ",", "'", "max", "'", ",", "'", "maxlength", "'", ",", "'", "media", "'", ",", "'", "method", "'", ",", "'", "min", "'", ",", "'", "multiple", "'", ",", "'", "name", "'", ",", "'", "noshade", "'", ",", "'", "novalidate", "'", ",", "'", "nowrap", "'", ",", "'", "open", "'", ",", "'", "optimum", "'", ",", "'", "pattern", "'", ",", "'", "placeholder", "'", ",", "'", "poster", "'", ",", "'", "preload", "'", ",", "'", "pubdate", "'", ",", "'", "radiogroup", "'", ",", "'", "readonly", "'", ",", "'", "rel", "'", ",", "'", "required", "'", ",", "'", "rev", "'", ",", "'", "reversed", "'", ",", "'", "role", "'", ",", "'", "rows", "'", ",", "'", "rowspan", "'", ",", "'", "spellcheck", "'", ",", "'", "scope", "'", ",", "'", "selected", "'", ",", "'", "shape", "'", ",", "'", "size", "'", ",", "'", "sizes", "'", ",", "'", "span", "'", ",", "'", "srclang", "'", ",", "'", "start", "'", ",", "'", "src", "'", ",", "'", "srcset", "'", ",", "'", "step", "'", ",", "'", "style", "'", ",", "'", "summary", "'", ",", "'", "tabindex", "'", ",", "'", "title", "'", ",", "'", "type", "'", ",", "'", "usemap", "'", ",", "'", "valign", "'", ",", "'", "value", "'", ",", "'", "width", "'", ",", "'", "xmlns", "'", "];", "var", "svg", "$", "1", "=", "[", "'", "accent", "-", "height", "'", ",", "'", "accumulate", "'", ",", "'", "additivive", "'", ",", "'", "alignment", "-", "baseline", "'", ",", "'", "ascent", "'", ",", "'", "attributename", "'", ",", "'", "attributetype", "'", ",", "'", "azimuth", "'", ",", "'", "basefrequency", "'", ",", "'", "baseline", "-", "shift", "'", ",", "'", "begin", "'", ",", "'", "bias", "'", ",", "'", "by", "'", ",", "'", "class", "'", ",", "'", "clip", "'", ",", "'", "clip", "-", "path", "'", ",", "'", "clip", "-", "rule", "'", ",", "'", "color", "'", ",", "'", "color", "-", "interpolation", "'", ",", "'", "color", "-", "interpolation", "-", "filters", "'", ",", "'", "color", "-", "profile", "'", ",", "'", "color", "-", "rendering", "'", ",", "'", "cx", "'", ",", "'", "cy", "'", ",", "'", "d", "'", ",", "'", "dx", "'", ",", "'", "dy", "'", ",", "'", "diffuseconstant", "'", ",", "'", "direction", "'", ",", "'", "display", "'", ",", "'", "divisor", "'", ",", "'", "dur", "'", ",", "'", "edgemode", "'", ",", "'", "elevation", "'", ",", "'", "end", "'", ",", "'", "fill", "'", ",", "'", "fill", "-", "opacity", "'", ",", "'", "fill", "-", "rule", "'", ",", "'", "filter", "'", ",", "'", "flood", "-", "color", "'", ",", "'", "flood", "-", "opacity", "'", ",", "'", "font", "-", "family", "'", ",", "'", "font", "-", "size", "'", ",", "'", "font", "-", "size", "-", "adjust", "'", ",", "'", "font", "-", "stretch", "'", ",", "'", "font", "-", "style", "'", ",", "'", "font", "-", "variant", "'", ",", "'", "font", "-", "weight", "'", ",", "'", "fx", "'", ",", "'", "fy", "'", ",", "'", "g1", "'", ",", "'", "g2", "'", ",", "'", "glyph", "-", "name", "'", ",", "'", "glyphref", "'", ",", "'", "gradientunits", "'", ",", "'", "gradienttransform", "'", ",", "'", "height", "'", ",", "'", "href", "'", ",", "'", "id", "'", ",", "'", "image", "-", "rendering", "'", ",", "'", "in", "'", ",", "'", "in2", "'", ",", "'", "k", "'", ",", "'", "k1", "'", ",", "'", "k2", "'", ",", "'", "k3", "'", ",", "'", "k4", "'", ",", "'", "kerning", "'", ",", "'", "keypoints", "'", ",", "'", "keysplines", "'", ",", "'", "keytimes", "'", ",", "'", "lang", "'", ",", "'", "lengthadjust", "'", ",", "'", "letter", "-", "spacing", "'", ",", "'", "kernelmatrix", "'", ",", "'", "kernelunitlength", "'", ",", "'", "lighting", "-", "color", "'", ",", "'", "local", "'", ",", "'", "marker", "-", "end", "'", ",", "'", "marker", "-", "mid", "'", ",", "'", "marker", "-", "start", "'", ",", "'", "markerheight", "'", ",", "'", "markerunits", "'", ",", "'", "markerwidth", "'", ",", "'", "maskcontentunits", "'", ",", "'", "maskunits", "'", ",", "'", "max", "'", ",", "'", "mask", "'", ",", "'", "media", "'", ",", "'", "method", "'", ",", "'", "mode", "'", ",", "'", "min", "'", ",", "'", "name", "'", ",", "'", "numoctaves", "'", ",", "'", "offset", "'", ",", "'", "operator", "'", ",", "'", "opacity", "'", ",", "'", "order", "'", ",", "'", "orient", "'", ",", "'", "orientation", "'", ",", "'", "origin", "'", ",", "'", "overflow", "'", ",", "'", "paint", "-", "order", "'", ",", "'", "path", "'", ",", "'", "pathlength", "'", ",", "'", "patterncontentunits", "'", ",", "'", "patterntransform", "'", ",", "'", "patternunits", "'", ",", "'", "points", "'", ",", "'", "preservealpha", "'", ",", "'", "preserveaspectratio", "'", ",", "'", "r", "'", ",", "'", "rx", "'", ",", "'", "ry", "'", ",", "'", "radius", "'", ",", "'", "refx", "'", ",", "'", "refy", "'", ",", "'", "repeatcount", "'", ",", "'", "repeatdur", "'", ",", "'", "restart", "'", ",", "'", "result", "'", ",", "'", "rotate", "'", ",", "'", "scale", "'", ",", "'", "seed", "'", ",", "'", "shape", "-", "rendering", "'", ",", "'", "specularconstant", "'", ",", "'", "specularexponent", "'", ",", "'", "spreadmethod", "'", ",", "'", "stddeviation", "'", ",", "'", "stitchtiles", "'", ",", "'", "stop", "-", "color", "'", ",", "'", "stop", "-", "opacity", "'", ",", "'", "stroke", "-", "dasharray", "'", ",", "'", "stroke", "-", "dashoffset", "'", ",", "'", "stroke", "-", "linecap", "'", ",", "'", "stroke", "-", "linejoin", "'", ",", "'", "stroke", "-", "miterlimit", "'", ",", "'", "stroke", "-", "opacity", "'", ",", "'", "stroke", "'", ",", "'", "stroke", "-", "width", "'", ",", "'", "style", "'", ",", "'", "surfacescale", "'", ",", "'", "tabindex", "'", ",", "'", "targetx", "'", ",", "'", "targety", "'", ",", "'", "transform", "'", ",", "'", "text", "-", "anchor", "'", ",", "'", "text", "-", "decoration", "'", ",", "'", "text", "-", "rendering", "'", ",", "'", "textlength", "'", ",", "'", "type", "'", ",", "'", "u1", "'", ",", "'", "u2", "'", ",", "'", "unicode", "'", ",", "'", "values", "'", ",", "'", "viewbox", "'", ",", "'", "visibility", "'", ",", "'", "vert", "-", "adv", "-", "y", "'", ",", "'", "vert", "-", "origin", "-", "x", "'", ",", "'", "vert", "-", "origin", "-", "y", "'", ",", "'", "width", "'", ",", "'", "word", "-", "spacing", "'", ",", "'", "wrap", "'", ",", "'", "writing", "-", "mode", "'", ",", "'", "xchannelselector", "'", ",", "'", "ychannelselector", "'", ",", "'", "x", "'", ",", "'", "x1", "'", ",", "'", "x2", "'", ",", "'", "xmlns", "'", ",", "'", "y", "'", ",", "'", "y1", "'", ",", "'", "y2", "'", ",", "'", "z", "'", ",", "'", "zoomandpan", "'", "];", "var", "mathMl", "$", "1", "=", "[", "'", "accent", "'", ",", "'", "accentunder", "'", ",", "'", "align", "'", ",", "'", "bevelled", "'", ",", "'", "close", "'", ",", "'", "columnsalign", "'", ",", "'", "columnlines", "'", ",", "'", "columnspan", "'", ",", "'", "denomalign", "'", ",", "'", "depth", "'", ",", "'", "dir", "'", ",", "'", "display", "'", ",", "'", "displaystyle", "'", ",", "'", "fence", "'", ",", "'", "frame", "'", ",", "'", "height", "'", ",", "'", "href", "'", ",", "'", "id", "'", ",", "'", "largeop", "'", ",", "'", "length", "'", ",", "'", "linethickness", "'", ",", "'", "lspace", "'", ",", "'", "lquote", "'", ",", "'", "mathbackground", "'", ",", "'", "mathcolor", "'", ",", "'", "mathsize", "'", ",", "'", "mathvariant", "'", ",", "'", "maxsize", "'", ",", "'", "minsize", "'", ",", "'", "movablelimits", "'", ",", "'", "notation", "'", ",", "'", "numalign", "'", ",", "'", "open", "'", ",", "'", "rowalign", "'", ",", "'", "rowlines", "'", ",", "'", "rowspacing", "'", ",", "'", "rowspan", "'", ",", "'", "rspace", "'", ",", "'", "rquote", "'", ",", "'", "scriptlevel", "'", ",", "'", "scriptminsize", "'", ",", "'", "scriptsizemultiplier", "'", ",", "'", "selection", "'", ",", "'", "separator", "'", ",", "'", "separators", "'", ",", "'", "stretchy", "'", ",", "'", "subscriptshift", "'", ",", "'", "supscriptshift", "'", ",", "'", "symmetric", "'", ",", "'", "voffset", "'", ",", "'", "width", "'", ",", "'", "xmlns", "'", "];", "var", "xml", "=", "[", "'", "xlink", ":", "href", "'", ",", "'", "xml", ":", "id", "'", ",", "'", "xlink", ":", "title", "'", ",", "'", "xml", ":", "space", "'", ",", "'", "xmlns", ":", "xlink", "'", "];", "/", "*", "Add", "properties", "to", "a", "lookup", "table", "*", "/", "function", "addToSet", "(", "set", ",", "array", ")", "{", "var", "l", "=", "array", ".", "length", ";", "while", "(", "l", "-", "-)", "{", "if", "(", "typeof", "array", "[", "l", "]", "=", "==", "'", "string", "'", ")", "{", "array", "[", "l", "]", "=", "array", "[", "l", "]", ".", "toLowerCase", "(", ");", "}", "set", "[", "array", "[", "l", "]", "]", "=", "true", ";", "}", "return", "set", ";", "}", "/", "*", "Shallow", "clone", "an", "object", "*", "/", "function", "clone", "(", "object", ")", "{", "var", "newObject", "=", "{", "};", "var", "property", "=", "void", "0", ";", "for", "(", "property", "in", "object", ")", "{", "if", "(", "Object", ".", "prototype", ".", "hasOwnProperty", ".", "call", "(", "object", ",", "property", ")", ")", "{", "newObject", "[", "property", "]", "=", "object", "[", "property", "]", ";", "}", "}", "return", "newObject", ";", "}", "var", "MUSTACHE_EXPR", "=", "/", "\\{", "\\{", "[\\", "s", "\\", "S", "]", "*|", "[\\", "s", "\\", "S", "]", "*\\", "}\\", "}/", "gm", ";", "/", "/", "Specify", "template", "detection", "regex", "for", "SAFE_FOR_TEMPLATES", "mode", "var", "ERB_EXPR", "=", "/", "<%", "[\\", "s", "\\", "S", "]", "*|", "[\\", "s", "\\", "S", "]", "*%", ">/", "gm", ";", "var", "DATA_ATTR", "=", "/", "^", "data", "-", "[\\", "-\\", "w", ".", "\\", "u00B7", "-", "\\", "uFFFF", "]", "/;", "/", "/", "eslint", "-", "disable", "-", "line", "no", "-", "useless", "-", "escape", "var", "ARIA_ATTR", "=", "/", "^", "aria", "-", "[\\", "-\\", "w", "]", "+$", "/;", "/", "/", "eslint", "-", "disable", "-", "line", "no", "-", "useless", "-", "escape", "var", "IS_ALLOWED_URI", "=", "/", "^(", "?:", "(?", ":(", "?:", "f", "|", "ht", ")", "tps", "?", "|", "mailto", "|", "tel", "|", "callto", "|", "cid", "|", "xmpp", ")", ":|", "[^", "a", "-", "z", "]", "|[", "a", "-", "z", "+", ".\\", "-]", "+(", "?:", "[^", "a", "-", "z", "+", ".\\", "-:", "]|", "$)", ")/", "i", ";", "/", "/", "eslint", "-", "disable", "-", "line", "no", "-", "useless", "-", "escape", "var", "IS_SCRIPT_OR_DATA", "=", "/", "^(", "?:", "\\", "w", "+", "script", "|", "data", ")", ":/", "i", ";", "var", "ATTR_WHITESPACE", "=", "/", "[\\", "u0000", "-", "\\", "u0020", "\\", "u00A0", "\\", "u1680", "\\", "u180E", "\\", "u2000", "-", "\\", "u2029", "\\", "u205f", "\\", "u3000", "]", "/", "g", ";", "/", "/", "eslint", "-", "disable", "-", "line", "no", "-", "control", "-", "regex", "var", "_typeof", "=", "typeof", "Symbol", "=", "==", "\"", "function", "\"", "&", "&", "typeof", "Symbol", ".", "iterator", "=", "==", "\"", "symbol", "\"", "?", "function", "(", "obj", ")", "{", "return", "typeof", "obj", ";", "}", ":", "function", "(", "obj", ")", "{", "return", "obj", "&", "&", "typeof", "Symbol", "=", "==", "\"", "function", "\"", "&", "&", "obj", ".", "constructor", "=", "==", "Symbol", "&", "&", "obj", "!", "==", "Symbol", ".", "prototype", "?", "\"", "symbol", "\"", ":", "typeof", "obj", ";", "}", ";", "function", "_toConsumableArray", "(", "arr", ")", "{", "if", "(", "Array", ".", "isArray", "(", "arr", ")", ")", "{", "for", "(", "var", "i", "=", "0", ",", "arr2", "=", "Array", "(", "arr", ".", "length", ")", ";", "i", "<", "arr", ".", "length", ";", "i", "+", "+)", "{", "arr2", "[", "i", "]", "=", "arr", "[", "i", "]", ";", "}", "return", "arr2", ";", "}", "else", "{", "return", "Array", ".", "from", "(", "arr", ")", ";", "}", "}", "var", "getGlobal", "=", "function", "getGlobal", "(", ")", "{", "return", "typeof", "window", "=", "==", "'", "undefined", "'", "?", "null", ":", "window", ";", "}", ";", "function", "createDOMPurify", "(", ")", "{", "var", "window", "=", "arguments", ".", "length", ">", "0", "&", "&", "arguments", "[", "0", "]", "!", "==", "undefined", "?", "arguments", "[", "0", "]", ":", "getGlobal", "(", ");", "var", "DOMPurify", "=", "function", "DOMPurify", "(", "root", ")", "{", "return", "createDOMPurify", "(", "root", ")", ";", "}", ";", "/", "**", "*", "Version", "label", ",", "exposed", "for", "easier", "checks", "*", "if", "DOMPurify", "is", "up", "to", "date", "or", "not", "*", "/", "DOMPurify", ".", "version", "=", "'", "1", ".", "0", ".", "8", "'", ";", "/", "**", "*", "Array", "of", "elements", "that", "DOMPurify", "removed", "during", "sanitation", ".", "*", "Empty", "if", "nothing", "was", "removed", ".", "*", "/", "DOMPurify", ".", "removed", "=", "[", "];", "if", "(", "!", "window", "|", "|", "!", "window", ".", "document", "|", "|", "window", ".", "document", ".", "nodeType", "!", "==", "9", ")", "{", "/", "/", "Not", "running", "in", "a", "browser", ",", "provide", "a", "factory", "function", "/", "/", "so", "that", "you", "can", "pass", "your", "own", "Window", "DOMPurify", ".", "isSupported", "=", "false", ";", "return", "DOMPurify", ";", "}", "var", "originalDocument", "=", "window", ".", "document", ";", "var", "useDOMParser", "=", "false", ";", "/", "/", "See", "comment", "below", "var", "removeTitle", "=", "false", ";", "/", "/", "See", "comment", "below", "var", "document", "=", "window", ".", "document", ";", "var", "DocumentFragment", "=", "window", ".", "DocumentFragment", ",", "HTMLTemplateElement", "=", "window", ".", "HTMLTemplateElement", ",", "Node", "=", "window", ".", "Node", ",", "NodeFilter", "=", "window", ".", "NodeFilter", ",", "_window", "$", "NamedNodeMap", "=", "window", ".", "NamedNodeMap", ",", "NamedNodeMap", "=", "_window", "$", "NamedNodeMap", "=", "==", "undefined", "?", "window", ".", "NamedNodeMap", "|", "|", "window", ".", "MozNamedAttrMap", ":", "_window", "$", "NamedNodeMap", ",", "Text", "=", "window", ".", "Text", ",", "Comment", "=", "window", ".", "Comment", ",", "DOMParser", "=", "window", ".", "DOMParser", ";", "/", "/", "As", "per", "issue", "#", "47", ",", "the", "web", "-", "components", "registry", "is", "inherited", "by", "a", "/", "/", "new", "document", "created", "via", "createHTMLDocument", ".", "As", "per", "the", "spec", "/", "/", "(", "http", ":", "//", "w3c", ".", "github", ".", "io", "/", "webcomponents", "/", "spec", "/", "custom", "/", "#", "creating", "-", "and", "-", "passing", "-", "registries", ")", "/", "/", "a", "new", "empty", "registry", "is", "used", "when", "creating", "a", "template", "contents", "owner", "/", "/", "document", ",", "so", "we", "use", "that", "as", "our", "parent", "document", "to", "ensure", "nothing", "/", "/", "is", "inherited", ".", "if", "(", "typeof", "HTMLTemplateElement", "=", "==", "'", "function", "'", ")", "{", "var", "template", "=", "document", ".", "createElement", "(", "'", "template", "'", ");", "if", "(", "template", ".", "content", "&", "&", "template", ".", "content", ".", "ownerDocument", ")", "{", "document", "=", "template", ".", "content", ".", "ownerDocument", ";", "}", "}", "var", "_document", "=", "document", ",", "implementation", "=", "_document", ".", "implementation", ",", "createNodeIterator", "=", "_document", ".", "createNodeIterator", ",", "getElementsByTagName", "=", "_document", ".", "getElementsByTagName", ",", "createDocumentFragment", "=", "_document", ".", "createDocumentFragment", ";", "var", "importNode", "=", "originalDocument", ".", "importNode", ";", "var", "hooks", "=", "{", "};", "/", "**", "*", "Expose", "whether", "this", "browser", "supports", "running", "the", "full", "DOMPurify", ".", "*", "/", "DOMPurify", ".", "isSupported", "=", "implementation", "&", "&", "typeof", "implementation", ".", "createHTMLDocument", "!", "==", "'", "undefined", "'", "&", "&", "document", ".", "documentMode", "!", "==", "9", ";", "var", "MUSTACHE_EXPR", "$", "$", "1", "=", "MUSTACHE_EXPR", ",", "ERB_EXPR", "$", "$", "1", "=", "ERB_EXPR", ",", "DATA_ATTR", "$", "$", "1", "=", "DATA_ATTR", ",", "ARIA_ATTR", "$", "$", "1", "=", "ARIA_ATTR", ",", "IS_SCRIPT_OR_DATA", "$", "$", "1", "=", "IS_SCRIPT_OR_DATA", ",", "ATTR_WHITESPACE", "$", "$", "1", "=", "ATTR_WHITESPACE", ";", "var", "IS_ALLOWED_URI", "$", "$", "1", "=", "IS_ALLOWED_URI", ";", "/", "**", "*", "We", "consider", "the", "elements", "and", "attributes", "below", "to", "be", "safe", ".", "Ideally", "*", "don", "'", "t", "add", "any", "new", "ones", "but", "feel", "free", "to", "remove", "unwanted", "ones", ".", "*", "/", "/", "*", "allowed", "element", "names", "*", "/", "var", "ALLOWED_TAGS", "=", "null", ";", "var", "DEFAULT_ALLOWED_TAGS", "=", "addToSet", "(", "{}", ",", "[", "].", "concat", "(", "_toConsumableArray", "(", "html", ")", ",", "_toConsumableArray", "(", "svg", ")", ",", "_toConsumableArray", "(", "svgFilters", ")", ",", "_toConsumableArray", "(", "mathMl", ")", ",", "_toConsumableArray", "(", "text", ")", "))", ";", "/", "*", "Allowed", "attribute", "names", "*", "/", "var", "ALLOWED_ATTR", "=", "null", ";", "var", "DEFAULT_ALLOWED_ATTR", "=", "addToSet", "(", "{}", ",", "[", "].", "concat", "(", "_toConsumableArray", "(", "html", "$", "1", ")", ",", "_toConsumableArray", "(", "svg", "$", "1", ")", ",", "_toConsumableArray", "(", "mathMl", "$", "1", ")", ",", "_toConsumableArray", "(", "xml", ")", "))", ";", "/", "*", "Explicitly", "forbidden", "tags", "(", "overrides", "ALLOWED_TAGS", "/", "ADD_TAGS", ")", "*", "/", "var", "FORBID_TAGS", "=", "null", ";", "/", "*", "Explicitly", "forbidden", "attributes", "(", "overrides", "ALLOWED_ATTR", "/", "ADD_ATTR", ")", "*", "/", "var", "FORBID_ATTR", "=", "null", ";", "/", "*", "Decide", "if", "ARIA", "attributes", "are", "okay", "*", "/", "var", "ALLOW_ARIA_ATTR", "=", "true", ";", "/", "*", "Decide", "if", "custom", "data", "attributes", "are", "okay", "*", "/", "var", "ALLOW_DATA_ATTR", "=", "true", ";", "/", "*", "Decide", "if", "unknown", "protocols", "are", "okay", "*", "/", "var", "ALLOW_UNKNOWN_PROTOCOLS", "=", "false", ";", "/", "*", "Output", "should", "be", "safe", "for", "jQuery", "'", "s", "$", "()", "factory", "?", "*", "/", "var", "SAFE_FOR_JQUERY", "=", "false", ";", "/", "*", "Output", "should", "be", "safe", "for", "common", "template", "engines", ".", "*", "This", "means", ",", "DOMPurify", "removes", "data", "attributes", ",", "mustaches", "and", "ERB", "*", "/", "var", "SAFE_FOR_TEMPLATES", "=", "false", ";", "/", "*", "Decide", "if", "document", "with", "<", "html", ">", "..", ".", "should", "be", "returned", "*", "/", "var", "WHOLE_DOCUMENT", "=", "false", ";", "/", "*", "Track", "whether", "config", "is", "already", "set", "on", "this", "instance", "of", "DOMPurify", ".", "*", "/", "var", "SET_CONFIG", "=", "false", ";", "/", "*", "Decide", "if", "all", "elements", "(", "e", ".", "g", ".", "style", ",", "script", ")", "must", "be", "children", "of", "*", "document", ".", "body", ".", "By", "default", ",", "browsers", "might", "move", "them", "to", "document", ".", "head", "*", "/", "var", "FORCE_BODY", "=", "false", ";", "/", "*", "Decide", "if", "a", "DOM", "`", "HTMLBodyElement", "`", "should", "be", "returned", ",", "instead", "of", "a", "html", "string", ".", "*", "If", "`", "WHOLE_DOCUMENT", "`", "is", "enabled", "a", "`", "HTMLHtmlElement", "`", "will", "be", "returned", "instead", "*", "/", "var", "RETURN_DOM", "=", "false", ";", "/", "*", "Decide", "if", "a", "DOM", "`", "DocumentFragment", "`", "should", "be", "returned", ",", "instead", "of", "a", "html", "string", "*", "/", "var", "RETURN_DOM_FRAGMENT", "=", "false", ";", "/", "*", "If", "`", "RETURN_DOM", "`", "or", "`", "RETURN_DOM_FRAGMENT", "`", "is", "enabled", ",", "decide", "if", "the", "returned", "DOM", "*", "`", "Node", "`", "is", "imported", "into", "the", "current", "`", "Document", "`", ".", "If", "this", "flag", "is", "not", "enabled", "the", "*", "`", "Node", "`", "will", "belong", "(", "its", "ownerDocument", ")", "to", "a", "fresh", "`", "HTMLDocument", "`", ",", "created", "by", "*", "DOMPurify", ".", "*", "/", "var", "RETURN_DOM_IMPORT", "=", "false", ";", "/", "*", "Output", "should", "be", "free", "from", "DOM", "clobbering", "attacks", "?", "*", "/", "var", "SANITIZE_DOM", "=", "true", ";", "/", "*", "Keep", "element", "content", "when", "removing", "element", "?", "*", "/", "var", "KEEP_CONTENT", "=", "true", ";", "/", "*", "If", "a", "`", "Node", "`", "is", "passed", "to", "sanitize", "(", "),", "then", "performs", "sanitization", "in", "-", "place", "instead", "*", "of", "importing", "it", "into", "a", "new", "Document", "and", "returning", "a", "sanitized", "copy", "*", "/", "var", "IN_PLACE", "=", "false", ";", "/", "*", "Allow", "usage", "of", "profiles", "like", "html", ",", "svg", "and", "mathMl", "*", "/", "var", "USE_PROFILES", "=", "{", "};", "/", "*", "Tags", "to", "ignore", "content", "of", "when", "KEEP_CONTENT", "is", "true", "*", "/", "var", "FORBID_CONTENTS", "=", "addToSet", "(", "{}", ",", "[", "'", "audio", "'", ",", "'", "head", "'", ",", "'", "math", "'", ",", "'", "script", "'", ",", "'", "style", "'", ",", "'", "template", "'", ",", "'", "svg", "'", ",", "'", "video", "'", "])", ";", "/", "*", "Tags", "that", "are", "safe", "for", "data", ":", "URIs", "*", "/", "var", "DATA_URI_TAGS", "=", "addToSet", "(", "{}", ",", "[", "'", "audio", "'", ",", "'", "video", "'", ",", "'", "img", "'", ",", "'", "source", "'", ",", "'", "image", "'", "])", ";", "/", "*", "Attributes", "safe", "for", "values", "like", "\"", "javascript", ":", "\"", "*", "/", "var", "URI_SAFE_ATTRIBUTES", "=", "addToSet", "(", "{}", ",", "[", "'", "alt", "'", ",", "'", "class", "'", ",", "'", "for", "'", ",", "'", "id", "'", ",", "'", "label", "'", ",", "'", "name", "'", ",", "'", "pattern", "'", ",", "'", "placeholder", "'", ",", "'", "summary", "'", ",", "'", "title", "'", ",", "'", "value", "'", ",", "'", "style", "'", ",", "'", "xmlns", "'", "])", ";", "/", "*", "Keep", "a", "reference", "to", "config", "to", "pass", "to", "hooks", "*", "/", "var", "CONFIG", "=", "null", ";", "/", "*", "Ideally", ",", "do", "not", "touch", "anything", "below", "this", "line", "*", "/", "/", "*", "______________________________________________", "*", "/", "var", "formElement", "=", "document", ".", "createElement", "(", "'", "form", "'", ");", "/", "**", "*", "_parseConfig", "*", "*", "@", "param", "{", "Object", "}", "cfg", "optional", "config", "literal", "*", "/", "/", "/", "eslint", "-", "disable", "-", "next", "-", "line", "complexity", "var", "_parseConfig", "=", "function", "_parseConfig", "(", "cfg", ")", "{", "/", "*", "Shield", "configuration", "object", "from", "tampering", "*", "/", "if", "(", "(", "typeof", "cfg", "=", "==", "'", "undefined", "'", "?", "'", "undefined", "'", ":", "_typeof", "(", "cfg", ")", ")", "!", "==", "'", "object", "'", ")", "{", "cfg", "=", "{", "};", "}", "/", "*", "Set", "configuration", "parameters", "*", "/", "ALLOWED_TAGS", "=", "'", "ALLOWED_TAGS", "'", "in", "cfg", "?", "addToSet", "(", "{}", ",", "cfg", ".", "ALLOWED_TAGS", ")", ":", "DEFAULT_ALLOWED_TAGS", ";", "ALLOWED_ATTR", "=", "'", "ALLOWED_ATTR", "'", "in", "cfg", "?", "addToSet", "(", "{}", ",", "cfg", ".", "ALLOWED_ATTR", ")", ":", "DEFAULT_ALLOWED_ATTR", ";", "FORBID_TAGS", "=", "'", "FORBID_TAGS", "'", "in", "cfg", "?", "addToSet", "(", "{}", ",", "cfg", ".", "FORBID_TAGS", ")", ":", "{", "};", "FORBID_ATTR", "=", "'", "FORBID_ATTR", "'", "in", "cfg", "?", "addToSet", "(", "{}", ",", "cfg", ".", "FORBID_ATTR", ")", ":", "{", "};", "USE_PROFILES", "=", "'", "USE_PROFILES", "'", "in", "cfg", "?", "cfg", ".", "USE_PROFILES", ":", "false", ";", "ALLOW_ARIA_ATTR", "=", "cfg", ".", "ALLOW_ARIA_ATTR", "!", "==", "false", ";", "/", "/", "Default", "true", "ALLOW_DATA_ATTR", "=", "cfg", ".", "ALLOW_DATA_ATTR", "!", "==", "false", ";", "/", "/", "Default", "true", "ALLOW_UNKNOWN_PROTOCOLS", "=", "cfg", ".", "ALLOW_UNKNOWN_PROTOCOLS", "|", "|", "false", ";", "/", "/", "Default", "false", "SAFE_FOR_JQUERY", "=", "cfg", ".", "SAFE_FOR_JQUERY", "|", "|", "false", ";", "/", "/", "Default", "false", "SAFE_FOR_TEMPLATES", "=", "cfg", ".", "SAFE_FOR_TEMPLATES", "|", "|", "false", ";", "/", "/", "Default", "false", "WHOLE_DOCUMENT", "=", "cfg", ".", "WHOLE_DOCUMENT", "|", "|", "false", ";", "/", "/", "Default", "false", "RETURN_DOM", "=", "cfg", ".", "RETURN_DOM", "|", "|", "false", ";", "/", "/", "Default", "false", "RETURN_DOM_FRAGMENT", "=", "cfg", ".", "RETURN_DOM_FRAGMENT", "|", "|", "false", ";", "/", "/", "Default", "false", "RETURN_DOM_IMPORT", "=", "cfg", ".", "RETURN_DOM_IMPORT", "|", "|", "false", ";", "/", "/", "Default", "false", "FORCE_BODY", "=", "cfg", ".", "FORCE_BODY", "|", "|", "false", ";", "/", "/", "Default", "false", "SANITIZE_DOM", "=", "cfg", ".", "SANITIZE_DOM", "!", "==", "false", ";", "/", "/", "Default", "true", "KEEP_CONTENT", "=", "cfg", ".", "KEEP_CONTENT", "!", "==", "false", ";", "/", "/", "Default", "true", "IN_PLACE", "=", "cfg", ".", "IN_PLACE", "|", "|", "false", ";", "/", "/", "Default", "false", "IS_ALLOWED_URI", "$", "$", "1", "=", "cfg", ".", "ALLOWED_URI_REGEXP", "|", "|", "IS_ALLOWED_URI", "$", "$", "1", ";", "if", "(", "SAFE_FOR_TEMPLATES", ")", "{", "ALLOW_DATA_ATTR", "=", "false", ";", "}", "if", "(", "RETURN_DOM_FRAGMENT", ")", "{", "RETURN_DOM", "=", "true", ";", "}", "/", "*", "Parse", "profile", "info", "*", "/", "if", "(", "USE_PROFILES", ")", "{", "ALLOWED_TAGS", "=", "addToSet", "(", "{}", ",", "[", "].", "concat", "(", "_toConsumableArray", "(", "text", ")", "))", ";", "ALLOWED_ATTR", "=", "[", "];", "if", "(", "USE_PROFILES", ".", "html", "=", "==", "true", ")", "{", "addToSet", "(", "ALLOWED_TAGS", ",", "html", ")", ";", "addToSet", "(", "ALLOWED_ATTR", ",", "html", "$", "1", ")", ";", "}", "if", "(", "USE_PROFILES", ".", "svg", "=", "==", "true", ")", "{", "addToSet", "(", "ALLOWED_TAGS", ",", "svg", ")", ";", "addToSet", "(", "ALLOWED_ATTR", ",", "svg", "$", "1", ")", ";", "addToSet", "(", "ALLOWED_ATTR", ",", "xml", ")", ";", "}", "if", "(", "USE_PROFILES", ".", "svgFilters", "=", "==", "true", ")", "{", "addToSet", "(", "ALLOWED_TAGS", ",", "svgFilters", ")", ";", "addToSet", "(", "ALLOWED_ATTR", ",", "svg", "$", "1", ")", ";", "addToSet", "(", "ALLOWED_ATTR", ",", "xml", ")", ";", "}", "if", "(", "USE_PROFILES", ".", "mathMl", "=", "==", "true", ")", "{", "addToSet", "(", "ALLOWED_TAGS", ",", "mathMl", ")", ";", "addToSet", "(", "ALLOWED_ATTR", ",", "mathMl", "$", "1", ")", ";", "addToSet", "(", "ALLOWED_ATTR", ",", "xml", ")", ";", "}", "}", "/", "*", "Merge", "configuration", "parameters", "*", "/", "if", "(", "cfg", ".", "ADD_TAGS", ")", "{", "if", "(", "ALLOWED_TAGS", "=", "==", "DEFAULT_ALLOWED_TAGS", ")", "{", "ALLOWED_TAGS", "=", "clone", "(", "ALLOWED_TAGS", ")", ";", "}", "addToSet", "(", "ALLOWED_TAGS", ",", "cfg", ".", "ADD_TAGS", ")", ";", "}", "if", "(", "cfg", ".", "ADD_ATTR", ")", "{", "if", "(", "ALLOWED_ATTR", "=", "==", "DEFAULT_ALLOWED_ATTR", ")", "{", "ALLOWED_ATTR", "=", "clone", "(", "ALLOWED_ATTR", ")", ";", "}", "addToSet", "(", "ALLOWED_ATTR", ",", "cfg", ".", "ADD_ATTR", ")", ";", "}", "if", "(", "cfg", ".", "ADD_URI_SAFE_ATTR", ")", "{", "addToSet", "(", "URI_SAFE_ATTRIBUTES", ",", "cfg", ".", "ADD_URI_SAFE_ATTR", ")", ";", "}", "/", "*", "Add", "#", "text", "in", "case", "KEEP_CONTENT", "is", "set", "to", "true", "*", "/", "if", "(", "KEEP_CONTENT", ")", "{", "ALLOWED_TAGS", "[", "'#", "text", "'", "]", "=", "true", ";", "}", "/", "*", "Add", "html", ",", "head", "and", "body", "to", "ALLOWED_TAGS", "in", "case", "WHOLE_DOCUMENT", "is", "true", "*", "/", "if", "(", "WHOLE_DOCUMENT", ")", "{", "addToSet", "(", "ALLOWED_TAGS", ",", "[", "'", "html", "'", ",", "'", "head", "'", ",", "'", "body", "'", "])", ";", "}", "/", "*", "Add", "tbody", "to", "ALLOWED_TAGS", "in", "case", "tables", "are", "permitted", ",", "see", "#", "286", "*", "/", "if", "(", "ALLOWED_TAGS", ".", "table", ")", "{", "addToSet", "(", "ALLOWED_TAGS", ",", "[", "'", "tbody", "'", "])", ";", "}", "/", "/", "Prevent", "further", "manipulation", "of", "configuration", ".", "/", "/", "Not", "available", "in", "IE8", ",", "Safari", "5", ",", "etc", ".", "if", "(", "Object", "&", "&", "'", "freeze", "'", "in", "Object", ")", "{", "Object", ".", "freeze", "(", "cfg", ")", ";", "}", "CONFIG", "=", "cfg", ";", "}", ";", "/", "**", "*", "_forceRemove", "*", "*", "@", "param", "{", "Node", "}", "node", "a", "DOM", "node", "*", "/", "var", "_forceRemove", "=", "function", "_forceRemove", "(", "node", ")", "{", "DOMPurify", ".", "removed", ".", "push", "(", "{", "element", ":", "node", "}", ");", "try", "{", "node", ".", "parentNode", ".", "removeChild", "(", "node", ")", ";", "}", "catch", "(", "err", ")", "{", "node", ".", "outerHTML", "=", "'", "';", "}", "}", ";", "/", "**", "*", "_removeAttribute", "*", "*", "@", "param", "{", "String", "}", "name", "an", "Attribute", "name", "*", "@", "param", "{", "Node", "}", "node", "a", "DOM", "node", "*", "/", "var", "_removeAttribute", "=", "function", "_removeAttribute", "(", "name", ",", "node", ")", "{", "try", "{", "DOMPurify", ".", "removed", ".", "push", "(", "{", "attribute", ":", "node", ".", "getAttributeNode", "(", "name", ")", ",", "from", ":", "node", "}", ");", "}", "catch", "(", "err", ")", "{", "DOMPurify", ".", "removed", ".", "push", "(", "{", "attribute", ":", "null", ",", "from", ":", "node", "}", ");", "}", "node", ".", "removeAttribute", "(", "name", ")", ";", "}", ";", "/", "**", "*", "_initDocument", "*", "*", "@", "param", "{", "String", "}", "dirty", "a", "string", "of", "dirty", "markup", "*", "@", "return", "{", "Document", "}", "a", "DOM", ",", "filled", "with", "the", "dirty", "markup", "*", "/", "var", "_initDocument", "=", "function", "_initDocument", "(", "dirty", ")", "{", "/", "*", "Create", "a", "HTML", "document", "*", "/", "var", "doc", "=", "void", "0", ";", "if", "(", "FORCE_BODY", ")", "{", "dirty", "=", "'", "<", "remove", ">", "</", "remove", ">", "'", "+", "dirty", ";", "}", "/", "*", "Use", "DOMParser", "to", "workaround", "Firefox", "bug", "(", "see", "comment", "below", ")", "*", "/", "if", "(", "useDOMParser", ")", "{", "try", "{", "doc", "=", "new", "DOMParser", "(", ").", "parseFromString", "(", "dirty", ",", "'", "text", "/", "html", "'", ");", "}", "catch", "(", "err", ")", "{", "}", "}", "/", "*", "Remove", "title", "to", "fix", "an", "mXSS", "bug", "in", "older", "MS", "Edge", "*", "/", "if", "(", "removeTitle", ")", "{", "addToSet", "(", "FORBID_TAGS", ",", "[", "'", "title", "'", "])", ";", "}", "/", "*", "Otherwise", "use", "createHTMLDocument", ",", "because", "DOMParser", "is", "unsafe", "in", "Safari", "(", "see", "comment", "below", ")", "*", "/", "if", "(", "!", "doc", "|", "|", "!", "doc", ".", "documentElement", ")", "{", "doc", "=", "implementation", ".", "createHTMLDocument", "(", "''", ");", "var", "_doc", "=", "doc", ",", "body", "=", "_doc", ".", "body", ";", "body", ".", "parentNode", ".", "removeChild", "(", "body", ".", "parentNode", ".", "firstElementChild", ")", ";", "body", ".", "outerHTML", "=", "dirty", ";", "}", "/", "*", "Work", "on", "whole", "document", "or", "just", "its", "body", "*", "/", "return", "getElementsByTagName", ".", "call", "(", "doc", ",", "WHOLE_DOCUMENT", "?", "'", "html", "'", ":", "'", "body", "'", ")[", "0", "]", ";", "}", ";", "/", "/", "Firefox", "uses", "a", "different", "parser", "for", "innerHTML", "rather", "than", "/", "/", "DOMParser", "(", "see", "https", ":", "//", "bugzilla", ".", "mozilla", ".", "org", "/", "show_bug", ".", "cgi", "?", "id", "=", "1205631", ")", "/", "/", "which", "means", "that", "you", "*", "must", "*", "use", "DOMParser", ",", "otherwise", "the", "output", "may", "/", "/", "not", "be", "safe", "if", "used", "in", "a", "document", ".", "write", "context", "later", ".", "/", "/", "/", "/", "So", "we", "feature", "detect", "the", "Firefox", "bug", "and", "use", "the", "DOMParser", "if", "necessary", ".", "/", "/", "/", "/", "MS", "Edge", ",", "in", "older", "versions", ",", "is", "affected", "by", "an", "mXSS", "behavior", ".", "The", "second", "/", "/", "check", "tests", "for", "the", "behavior", "and", "fixes", "it", "if", "necessary", ".", "if", "(", "DOMPurify", ".", "isSupported", ")", "{", "(", "function", "(", ")", "{", "try", "{", "var", "doc", "=", "_initDocument", "(", "'<", "svg", ">", "<", "p", ">", "<", "style", ">", "<", "img", "src", "=", "\"<", "/", "style", ">", "<", "img", "src", "=", "x", "onerror", "=", "alert", "(", "1", ")", "//", "\">", "')", ";", "if", "(", "doc", ".", "querySelector", "(", "'", "svg", "img", "'", "))", "{", "useDOMParser", "=", "true", ";", "}", "}", "catch", "(", "err", ")", "{", "}", "}", ")(", ");", "(", "function", "(", ")", "{", "try", "{", "var", "doc", "=", "_initDocument", "(", "'<", "x", "/", "><", "title", ">", "&", "lt", ";", "/", "title", "&", "gt", ";", "&", "lt", ";", "img", "&", "gt", ";", "')", ";", "if", "(", "doc", ".", "querySelector", "(", "'", "title", "'", ").", "textContent", ".", "match", "(", "/<", "\\/", "title", "/", "))", "{", "removeTitle", "=", "true", ";", "}", "}", "catch", "(", "err", ")", "{", "}", "}", ")(", ");", "}", "/", "**", "*", "_createIterator", "*", "*", "@", "param", "{", "Document", "}", "root", "document", "/", "fragment", "to", "create", "iterator", "for", "*", "@", "return", "{", "Iterator", "}", "iterator", "instance", "*", "/", "var", "_createIterator", "=", "function", "_createIterator", "(", "root", ")", "{", "return", "createNodeIterator", ".", "call", "(", "root", ".", "ownerDocument", "|", "|", "root", ",", "root", ",", "NodeFilter", ".", "SHOW_ELEMENT", "|", "NodeFilter", ".", "SHOW_COMMENT", "|", "NodeFilter", ".", "SHOW_TEXT", ",", "function", "(", ")", "{", "return", "NodeFilter", ".", "FILTER_ACCEPT", ";", "}", ",", "false", ")", ";", "}", ";", "/", "**", "*", "_isClobbered", "*", "*", "@", "param", "{", "Node", "}", "elm", "element", "to", "check", "for", "clobbering", "attacks", "*", "@", "return", "{", "Boolean", "}", "true", "if", "clobbered", ",", "false", "if", "safe", "*", "/", "var", "_isClobbered", "=", "function", "_isClobbered", "(", "elm", ")", "{", "if", "(", "elm", "instanceof", "Text", "|", "|", "elm", "instanceof", "Comment", ")", "{", "return", "false", ";", "}", "if", "(", "typeof", "elm", ".", "nodeName", "!", "==", "'", "string", "'", "|", "|", "typeof", "elm", ".", "textContent", "!", "==", "'", "string", "'", "|", "|", "typeof", "elm", ".", "removeChild", "!", "==", "'", "function", "'", "|", "|", "!", "(", "elm", ".", "attributes", "instanceof", "NamedNodeMap", ")", "|", "|", "typeof", "elm", ".", "removeAttribute", "!", "==", "'", "function", "'", "|", "|", "typeof", "elm", ".", "setAttribute", "!", "==", "'", "function", "'", ")", "{", "return", "true", ";", "}", "return", "false", ";", "}", ";", "/", "**", "*", "_isNode", "*", "*", "@", "param", "{", "Node", "}", "obj", "object", "to", "check", "whether", "it", "'", "s", "a", "DOM", "node", "*", "@", "return", "{", "Boolean", "}", "true", "is", "object", "is", "a", "DOM", "node", "*", "/", "var", "_isNode", "=", "function", "_isNode", "(", "obj", ")", "{", "return", "(", "typeof", "Node", "=", "==", "'", "undefined", "'", "?", "'", "undefined", "'", ":", "_typeof", "(", "Node", ")", ")", "=", "==", "'", "object", "'", "?", "obj", "instanceof", "Node", ":", "obj", "&", "&", "(", "typeof", "obj", "=", "==", "'", "undefined", "'", "?", "'", "undefined", "'", ":", "_typeof", "(", "obj", ")", ")", "=", "==", "'", "object", "'", "&", "&", "typeof", "obj", ".", "nodeType", "=", "==", "'", "number", "'", "&", "&", "typeof", "obj", ".", "nodeName", "=", "==", "'", "string", "'", ";", "}", ";", "/", "**", "*", "_executeHook", "*", "Execute", "user", "configurable", "hooks", "*", "*", "@", "param", "{", "String", "}", "entryPoint", "Name", "of", "the", "hook", "'", "s", "entry", "point", "*", "@", "param", "{", "Node", "}", "currentNode", "node", "to", "work", "on", "with", "the", "hook", "*", "@", "param", "{", "Object", "}", "data", "additional", "hook", "parameters", "*", "/", "var", "_executeHook", "=", "function", "_executeHook", "(", "entryPoint", ",", "currentNode", ",", "data", ")", "{", "if", "(", "!", "hooks", "[", "entryPoint", "]", ")", "{", "return", ";", "}", "hooks", "[", "entryPoint", "]", ".", "forEach", "(", "function", "(", "hook", ")", "{", "hook", ".", "call", "(", "DOMPurify", ",", "currentNode", ",", "data", ",", "CONFIG", ")", ";", "}", ");", "}", ";", "/", "**", "*", "_sanitizeElements", "*", "*", "@", "protect", "nodeName", "*", "@", "protect", "textContent", "*", "@", "protect", "removeChild", "*", "*", "@", "param", "{", "Node", "}", "currentNode", "to", "check", "for", "permission", "to", "exist", "*", "@", "return", "{", "Boolean", "}", "true", "if", "node", "was", "killed", ",", "false", "if", "left", "alive", "*", "/", "var", "_sanitizeElements", "=", "function", "_sanitizeElements", "(", "currentNode", ")", "{", "var", "content", "=", "void", "0", ";", "/", "*", "Execute", "a", "hook", "if", "present", "*", "/", "_executeHook", "(", "'", "beforeSanitizeElements", "'", ",", "currentNode", ",", "null", ")", ";", "/", "*", "Check", "if", "element", "is", "clobbered", "or", "can", "clobber", "*", "/", "if", "(", "_isClobbered", "(", "currentNode", ")", ")", "{", "_forceRemove", "(", "currentNode", ")", ";", "return", "true", ";", "}", "/", "*", "Now", "let", "'", "s", "check", "the", "element", "'", "s", "type", "and", "name", "*", "/", "var", "tagName", "=", "currentNode", ".", "nodeName", ".", "toLowerCase", "(", ");", "/", "*", "Execute", "a", "hook", "if", "present", "*", "/", "_executeHook", "(", "'", "uponSanitizeElement", "'", ",", "currentNode", ",", "{", "tagName", ":", "tagName", ",", "allowedTags", ":", "ALLOWED_TAGS", "}", ");", "/", "*", "Remove", "element", "if", "anything", "forbids", "its", "presence", "*", "/", "if", "(", "!", "ALLOWED_TAGS", "[", "tagName", "]", "|", "|", "FORBID_TAGS", "[", "tagName", "]", ")", "{", "/", "*", "Keep", "content", "except", "for", "black", "-", "listed", "elements", "*", "/", "if", "(", "KEEP_CONTENT", "&", "&", "!", "FORBID_CONTENTS", "[", "tagName", "]", "&", "&", "typeof", "currentNode", ".", "insertAdjacentHTML", "=", "==", "'", "function", "'", ")", "{", "try", "{", "currentNode", ".", "insertAdjacentHTML", "(", "'", "AfterEnd", "'", ",", "currentNode", ".", "innerHTML", ")", ";", "}", "catch", "(", "err", ")", "{", "}", "}", "_forceRemove", "(", "currentNode", ")", ";", "return", "true", ";", "}", "/", "*", "Convert", "markup", "to", "cover", "jQuery", "behavior", "*", "/", "if", "(", "SAFE_FOR_JQUERY", "&", "&", "!", "currentNode", ".", "firstElementChild", "&", "&", "(", "!", "currentNode", ".", "content", "|", "|", "!", "currentNode", ".", "content", ".", "firstElementChild", ")", "&", "&", "/", "</", "g", ".", "test", "(", "currentNode", ".", "textContent", ")", ")", "{", "DOMPurify", ".", "removed", ".", "push", "(", "{", "element", ":", "currentNode", ".", "cloneNode", "(", ")", "}", ");", "if", "(", "currentNode", ".", "innerHTML", ")", "{", "currentNode", ".", "innerHTML", "=", "currentNode", ".", "innerHTML", ".", "replace", "(", "/<", "/", "g", ",", "'", "&", "lt", ";", "')", ";", "}", "else", "{", "currentNode", ".", "innerHTML", "=", "currentNode", ".", "textContent", ".", "replace", "(", "/<", "/", "g", ",", "'", "&", "lt", ";", "')", ";", "}", "}", "/", "*", "Sanitize", "element", "content", "to", "be", "template", "-", "safe", "*", "/", "if", "(", "SAFE_FOR_TEMPLATES", "&", "&", "currentNode", ".", "nodeType", "=", "==", "3", ")", "{", "/", "*", "Get", "the", "element", "'", "s", "text", "content", "*", "/", "content", "=", "currentNode", ".", "textContent", ";", "content", "=", "content", ".", "replace", "(", "MUSTACHE_EXPR", "$", "$", "1", ",", "'", "'", ");", "content", "=", "content", ".", "replace", "(", "ERB_EXPR", "$", "$", "1", ",", "'", "'", ");", "if", "(", "currentNode", ".", "textContent", "!", "==", "content", ")", "{", "DOMPurify", ".", "removed", ".", "push", "(", "{", "element", ":", "currentNode", ".", "cloneNode", "(", ")", "}", ");", "currentNode", ".", "textContent", "=", "content", ";", "}", "}", "/", "*", "Execute", "a", "hook", "if", "present", "*", "/", "_executeHook", "(", "'", "afterSanitizeElements", "'", ",", "currentNode", ",", "null", ")", ";", "return", "false", ";", "}", ";", "/", "**", "*", "_isValidAttribute", "*", "*", "@", "param", "{", "string", "}", "lcTag", "Lowercase", "tag", "name", "of", "containing", "element", ".", "*", "@", "param", "{", "string", "}", "lcName", "Lowercase", "attribute", "name", ".", "*", "@", "param", "{", "string", "}", "value", "Attribute", "value", ".", "*", "@", "return", "{", "Boolean", "}", "Returns", "true", "if", "`", "value", "`", "is", "valid", ",", "otherwise", "false", ".", "*", "/", "var", "_isValidAttribute", "=", "function", "_isValidAttribute", "(", "lcTag", ",", "lcName", ",", "value", ")", "{", "/", "*", "Make", "sure", "attribute", "cannot", "clobber", "*", "/", "if", "(", "SANITIZE_DOM", "&", "&", "(", "lcName", "=", "==", "'", "id", "'", "|", "|", "lcName", "=", "==", "'", "name", "'", ")", "&", "&", "(", "value", "in", "document", "|", "|", "value", "in", "formElement", ")", ")", "{", "return", "false", ";", "}", "/", "*", "Sanitize", "attribute", "content", "to", "be", "template", "-", "safe", "*", "/", "if", "(", "SAFE_FOR_TEMPLATES", ")", "{", "value", "=", "value", ".", "replace", "(", "MUSTACHE_EXPR", "$", "$", "1", ",", "'", "'", ");", "value", "=", "value", ".", "replace", "(", "ERB_EXPR", "$", "$", "1", ",", "'", "'", ");", "}", "/", "*", "Allow", "valid", "data", "-", "*", "attributes", ":", "At", "least", "one", "character", "after", "\"", "-\"", "(", "https", ":", "//", "html", ".", "spec", ".", "whatwg", ".", "org", "/", "multipage", "/", "dom", ".", "html", "#", "embedding", "-", "custom", "-", "non", "-", "visible", "-", "data", "-", "with", "-", "the", "-", "data", "-", "*-", "attributes", ")", "XML", "-", "compatible", "(", "https", ":", "//", "html", ".", "spec", ".", "whatwg", ".", "org", "/", "multipage", "/", "infrastructure", ".", "html", "#", "xml", "-", "compatible", "and", "http", ":", "//", "www", ".", "w3", ".", "org", "/", "TR", "/", "xml", "/", "#", "d0e804", ")", "We", "don", "'", "t", "need", "to", "check", "the", "value", ";", "it", "'", "s", "always", "URI", "safe", ".", "*", "/", "if", "(", "ALLOW_DATA_ATTR", "&", "&", "DATA_ATTR", "$", "$", "1", ".", "test", "(", "lcName", ")", ")", "{", "/", "/", "This", "attribute", "is", "safe", "}", "else", "if", "(", "ALLOW_ARIA_ATTR", "&", "&", "ARIA_ATTR", "$", "$", "1", ".", "test", "(", "lcName", ")", ")", "{", "/", "/", "This", "attribute", "is", "safe", "/", "*", "Otherwise", ",", "check", "the", "name", "is", "permitted", "*", "/", "}", "else", "if", "(", "!", "ALLOWED_ATTR", "[", "lcName", "]", "|", "|", "FORBID_ATTR", "[", "lcName", "]", ")", "{", "return", "false", ";", "/", "*", "Check", "value", "is", "safe", ".", "First", ",", "is", "attr", "inert", "?", "If", "so", ",", "is", "safe", "*", "/", "}", "else", "if", "(", "URI_SAFE_ATTRIBUTES", "[", "lcName", "]", ")", "{", "/", "/", "This", "attribute", "is", "safe", "/", "*", "Check", "no", "script", ",", "data", "or", "unknown", "possibly", "unsafe", "URI", "unless", "we", "know", "URI", "values", "are", "safe", "for", "that", "attribute", "*", "/", "}", "else", "if", "(", "IS_ALLOWED_URI", "$", "$", "1", ".", "test", "(", "value", ".", "replace", "(", "ATTR_WHITESPACE", "$", "$", "1", ",", "'", "')", "))", "{", "/", "/", "This", "attribute", "is", "safe", "/", "*", "Keep", "image", "data", "URIs", "alive", "if", "src", "/", "xlink", ":", "href", "is", "allowed", "*", "/", "/", "*", "Further", "prevent", "gadget", "XSS", "for", "dynamically", "built", "script", "tags", "*", "/", "}", "else", "if", "(", "(", "lcName", "=", "==", "'", "src", "'", "|", "|", "lcName", "=", "==", "'", "xlink", ":", "href", "'", ")", "&", "&", "lcTag", "!", "==", "'", "script", "'", "&", "&", "value", ".", "indexOf", "(", "'", "data", ":", "')", "=", "==", "0", "&", "&", "DATA_URI_TAGS", "[", "lcTag", "]", ")", "{", "/", "/", "This", "attribute", "is", "safe", "/", "*", "Allow", "unknown", "protocols", ":", "This", "provides", "support", "for", "links", "that", "are", "handled", "by", "protocol", "handlers", "which", "may", "be", "unknown", "ahead", "of", "time", ",", "e", ".", "g", ".", "fb", ":", ",", "spotify", ":", "*", "/", "}", "else", "if", "(", "ALLOW_UNKNOWN_PROTOCOLS", "&", "&", "!", "IS_SCRIPT_OR_DATA", "$", "$", "1", ".", "test", "(", "value", ".", "replace", "(", "ATTR_WHITESPACE", "$", "$", "1", ",", "'", "')", "))", "{", "/", "/", "This", "attribute", "is", "safe", "/", "*", "Check", "for", "binary", "attributes", "*", "/", "/", "/", "eslint", "-", "disable", "-", "next", "-", "line", "no", "-", "negated", "-", "condition", "}", "else", "if", "(", "!", "value", ")", "{", "/", "/", "Binary", "attributes", "are", "safe", "at", "this", "point", "/", "*", "Anything", "else", ",", "presume", "unsafe", ",", "do", "not", "add", "it", "back", "*", "/", "}", "else", "{", "return", "false", ";", "}", "return", "true", ";", "}", ";", "/", "**", "*", "_sanitizeAttributes", "*", "*", "@", "protect", "attributes", "*", "@", "protect", "nodeName", "*", "@", "protect", "removeAttribute", "*", "@", "protect", "setAttribute", "*", "*", "@", "param", "{", "Node", "}", "node", "to", "sanitize", "*", "/", "/", "/", "eslint", "-", "disable", "-", "next", "-", "line", "complexity", "var", "_sanitizeAttributes", "=", "function", "_sanitizeAttributes", "(", "currentNode", ")", "{", "var", "attr", "=", "void", "0", ";", "var", "value", "=", "void", "0", ";", "var", "lcName", "=", "void", "0", ";", "var", "idAttr", "=", "void", "0", ";", "var", "l", "=", "void", "0", ";", "/", "*", "Execute", "a", "hook", "if", "present", "*", "/", "_executeHook", "(", "'", "beforeSanitizeAttributes", "'", ",", "currentNode", ",", "null", ")", ";", "var", "attributes", "=", "currentNode", ".", "attributes", ";", "/", "*", "Check", "if", "we", "have", "attributes", ";", "if", "not", "we", "might", "have", "a", "text", "node", "*", "/", "if", "(", "!", "attributes", ")", "{", "return", ";", "}", "var", "hookEvent", "=", "{", "attrName", ":", "'", "',", "attrValue", ":", "'", "',", "keepAttr", ":", "true", ",", "allowedAttributes", ":", "ALLOWED_ATTR", "}", ";", "l", "=", "attributes", ".", "length", ";", "/", "*", "Go", "backwards", "over", "all", "attributes", ";", "safely", "remove", "bad", "ones", "*", "/", "while", "(", "l", "-", "-)", "{", "attr", "=", "attributes", "[", "l", "]", ";", "var", "_attr", "=", "attr", ",", "name", "=", "_attr", ".", "name", ",", "namespaceURI", "=", "_attr", ".", "namespaceURI", ";", "value", "=", "attr", ".", "value", ".", "trim", "(", ");", "lcName", "=", "name", ".", "toLowerCase", "(", ");", "/", "*", "Execute", "a", "hook", "if", "present", "*", "/", "hookEvent", ".", "attrName", "=", "lcName", ";", "hookEvent", ".", "attrValue", "=", "value", ";", "hookEvent", ".", "keepAttr", "=", "true", ";", "_executeHook", "(", "'", "uponSanitizeAttribute", "'", ",", "currentNode", ",", "hookEvent", ")", ";", "value", "=", "hookEvent", ".", "attrValue", ";", "/", "*", "Remove", "attribute", "*", "/", "/", "/", "Safari", "(", "iOS", "+", "Mac", ")", ",", "last", "tested", "v8", ".", "0", ".", "5", ",", "crashes", "if", "you", "try", "to", "/", "/", "remove", "a", "\"", "name", "\"", "attribute", "from", "an", "<", "img", ">", "tag", "that", "has", "an", "\"", "id", "\"", "/", "/", "attribute", "at", "the", "time", ".", "if", "(", "lcName", "=", "==", "'", "name", "'", "&", "&", "currentNode", ".", "nodeName", "=", "==", "'", "IMG", "'", "&", "&", "attributes", ".", "id", ")", "{", "idAttr", "=", "attributes", ".", "id", ";", "attributes", "=", "Array", ".", "prototype", ".", "slice", ".", "apply", "(", "attributes", ")", ";", "_removeAttribute", "(", "'", "id", "'", ",", "currentNode", ")", ";", "_removeAttribute", "(", "name", ",", "currentNode", ")", ";", "if", "(", "attributes", ".", "indexOf", "(", "idAttr", ")", ">", "l", ")", "{", "currentNode", ".", "setAttribute", "(", "'", "id", "'", ",", "idAttr", ".", "value", ")", ";", "}", "}", "else", "if", "(", "/", "/", "This", "works", "around", "a", "bug", "in", "Safari", ",", "where", "input", "[", "type", "=", "file", "]", "/", "/", "cannot", "be", "dynamically", "set", "after", "type", "has", "been", "removed", "currentNode", ".", "nodeName", "=", "==", "'", "INPUT", "'", "&", "&", "lcName", "=", "==", "'", "type", "'", "&", "&", "value", "=", "==", "'", "file", "'", "&", "&", "(", "ALLOWED_ATTR", "[", "lcName", "]", "|", "|", "!", "FORBID_ATTR", "[", "lcName", "]", "))", "{", "continue", ";", "}", "else", "{", "/", "/", "This", "avoids", "a", "crash", "in", "Safari", "v9", ".", "0", "with", "double", "-", "ids", ".", "/", "/", "The", "trick", "is", "to", "first", "set", "the", "id", "to", "be", "empty", "and", "then", "to", "/", "/", "remove", "the", "attribute", "if", "(", "name", "=", "==", "'", "id", "'", ")", "{", "currentNode", ".", "setAttribute", "(", "name", ",", "'", "')", ";", "}", "_removeAttribute", "(", "name", ",", "currentNode", ")", ";", "}", "/", "*", "Did", "the", "hooks", "approve", "of", "the", "attribute", "?", "*", "/", "if", "(", "!", "hookEvent", ".", "keepAttr", ")", "{", "continue", ";", "}", "/", "*", "Is", "`", "value", "`", "valid", "for", "this", "attribute", "?", "*", "/", "var", "lcTag", "=", "currentNode", ".", "nodeName", ".", "toLowerCase", "(", ");", "if", "(", "!", "_isValidAttribute", "(", "lcTag", ",", "lcName", ",", "value", ")", ")", "{", "continue", ";", "}", "/", "*", "Handle", "invalid", "data", "-", "*", "attribute", "set", "by", "try", "-", "catching", "it", "*", "/", "try", "{", "if", "(", "namespaceURI", ")", "{", "currentNode", ".", "setAttributeNS", "(", "namespaceURI", ",", "name", ",", "value", ")", ";", "}", "else", "{", "/", "*", "Fallback", "to", "setAttribute", "(", ")", "for", "browser", "-", "unrecognized", "namespaces", "e", ".", "g", ".", "\"", "x", "-", "schema", "\"", ".", "*", "/", "currentNode", ".", "setAttribute", "(", "name", ",", "value", ")", ";", "}", "DOMPurify", ".", "removed", ".", "pop", "(", ");", "}", "catch", "(", "err", ")", "{", "}", "}", "/", "*", "Execute", "a", "hook", "if", "present", "*", "/", "_executeHook", "(", "'", "afterSanitizeAttributes", "'", ",", "currentNode", ",", "null", ")", ";", "}", ";", "/", "**", "*", "_sanitizeShadowDOM", "*", "*", "@", "param", "{", "DocumentFragment", "}", "fragment", "to", "iterate", "over", "recursively", "*", "/", "var", "_sanitizeShadowDOM", "=", "function", "_sanitizeShadowDOM", "(", "fragment", ")", "{", "var", "shadowNode", "=", "void", "0", ";", "var", "shadowIterator", "=", "_createIterator", "(", "fragment", ")", ";", "/", "*", "Execute", "a", "hook", "if", "present", "*", "/", "_executeHook", "(", "'", "beforeSanitizeShadowDOM", "'", ",", "fragment", ",", "null", ")", ";", "while", "(", "shadowNode", "=", "shadowIterator", ".", "nextNode", "(", "))", "{", "/", "*", "Execute", "a", "hook", "if", "present", "*", "/", "_executeHook", "(", "'", "uponSanitizeShadowNode", "'", ",", "shadowNode", ",", "null", ")", ";", "/", "*", "Sanitize", "tags", "and", "elements", "*", "/", "if", "(", "_sanitizeElements", "(", "shadowNode", ")", ")", "{", "continue", ";", "}", "/", "*", "Deep", "shadow", "DOM", "detected", "*", "/", "if", "(", "shadowNode", ".", "content", "instanceof", "DocumentFragment", ")", "{", "_sanitizeShadowDOM", "(", "shadowNode", ".", "content", ")", ";", "}", "/", "*", "Check", "attributes", ",", "sanitize", "if", "necessary", "*", "/", "_sanitizeAttributes", "(", "shadowNode", ")", ";", "}", "/", "*", "Execute", "a", "hook", "if", "present", "*", "/", "_executeHook", "(", "'", "afterSanitizeShadowDOM", "'", ",", "fragment", ",", "null", ")", ";", "}", ";", "/", "**", "*", "Sanitize", "*", "Public", "method", "providing", "core", "sanitation", "functionality", "*", "*", "@", "param", "{", "String", "|", "Node", "}", "dirty", "string", "or", "DOM", "node", "*", "@", "param", "{", "Object", "}", "configuration", "object", "*", "/", "/", "/", "eslint", "-", "disable", "-", "next", "-", "line", "complexity", "DOMPurify", ".", "sanitize", "=", "function", "(", "dirty", ",", "cfg", ")", "{", "var", "body", "=", "void", "0", ";", "var", "importedNode", "=", "void", "0", ";", "var", "currentNode", "=", "void", "0", ";", "var", "oldNode", "=", "void", "0", ";", "var", "returnNode", "=", "void", "0", ";", "/", "*", "Make", "sure", "we", "have", "a", "string", "to", "sanitize", ".", "DO", "NOT", "return", "early", ",", "as", "this", "will", "return", "the", "wrong", "type", "if", "the", "user", "has", "requested", "a", "DOM", "object", "rather", "than", "a", "string", "*", "/", "if", "(", "!", "dirty", ")", "{", "dirty", "=", "'", "<!", "--", ">'", ";", "}", "/", "*", "Stringify", ",", "in", "case", "dirty", "is", "an", "object", "*", "/", "if", "(", "typeof", "dirty", "!", "==", "'", "string", "'", "&", "&", "!", "_isNode", "(", "dirty", ")", ")", "{", "/", "/", "eslint", "-", "disable", "-", "next", "-", "line", "no", "-", "negated", "-", "condition", "if", "(", "typeof", "dirty", ".", "toString", "!", "==", "'", "function", "'", ")", "{", "throw", "new", "TypeError", "(", "'", "toString", "is", "not", "a", "function", "'", ");", "}", "else", "{", "dirty", "=", "dirty", ".", "toString", "(", ");", "if", "(", "typeof", "dirty", "!", "==", "'", "string", "'", ")", "{", "throw", "new", "TypeError", "(", "'", "dirty", "is", "not", "a", "string", ",", "aborting", "'", ");", "}", "}", "}", "/", "*", "Check", "we", "can", "run", ".", "Otherwise", "fall", "back", "or", "ignore", "*", "/", "if", "(", "!", "DOMPurify", ".", "isSupported", ")", "{", "if", "(", "_typeof", "(", "window", ".", "toStaticHTML", ")", "=", "==", "'", "object", "'", "|", "|", "typeof", "window", ".", "toStaticHTML", "=", "==", "'", "function", "'", ")", "{", "if", "(", "typeof", "dirty", "=", "==", "'", "string", "'", ")", "{", "return", "window", ".", "toStaticHTML", "(", "dirty", ")", ";", "}", "if", "(", "_isNode", "(", "dirty", ")", ")", "{", "return", "window", ".", "toStaticHTML", "(", "dirty", ".", "outerHTML", ")", ";", "}", "}", "return", "dirty", ";", "}", "/", "*", "Assign", "config", "vars", "*", "/", "if", "(", "!", "SET_CONFIG", ")", "{", "_parseConfig", "(", "cfg", ")", ";", "}", "/", "*", "Clean", "up", "removed", "elements", "*", "/", "DOMPurify", ".", "removed", "=", "[", "];", "if", "(", "IN_PLACE", ")", "{", "/", "*", "No", "special", "handling", "necessary", "for", "in", "-", "place", "sanitization", "*", "/", "}", "else", "if", "(", "dirty", "instanceof", "Node", ")", "{", "/", "*", "If", "dirty", "is", "a", "DOM", "element", ",", "append", "to", "an", "empty", "document", "to", "avoid", "elements", "being", "stripped", "by", "the", "parser", "*", "/", "body", "=", "_initDocument", "(", "'<", "!-", "->", "')", ";", "importedNode", "=", "body", ".", "ownerDocument", ".", "importNode", "(", "dirty", ",", "true", ")", ";", "if", "(", "importedNode", ".", "nodeType", "=", "==", "1", "&", "&", "importedNode", ".", "nodeName", "=", "==", "'", "BODY", "'", ")", "{", "/", "*", "Node", "is", "already", "a", "body", ",", "use", "as", "is", "*", "/", "body", "=", "importedNode", ";", "}", "else", "{", "body", ".", "appendChild", "(", "importedNode", ")", ";", "}", "}", "else", "{", "/", "*", "Exit", "directly", "if", "we", "have", "nothing", "to", "do", "*", "/", "if", "(", "!", "RETURN_DOM", "&", "&", "!", "WHOLE_DOCUMENT", "&", "&", "dirty", ".", "indexOf", "(", "'<", "')", "=", "==", "-", "1", ")", "{", "return", "dirty", ";", "}", "/", "*", "Initialize", "the", "document", "to", "work", "on", "*", "/", "body", "=", "_initDocument", "(", "dirty", ")", ";", "/", "*", "Check", "we", "have", "a", "DOM", "node", "from", "the", "data", "*", "/", "if", "(", "!", "body", ")", "{", "return", "RETURN_DOM", "?", "null", ":", "'", "';", "}", "}", "/", "*", "Remove", "first", "element", "node", "(", "ours", ")", "if", "FORCE_BODY", "is", "set", "*", "/", "if", "(", "body", "&", "&", "FORCE_BODY", ")", "{", "_forceRemove", "(", "body", ".", "firstChild", ")", ";", "}", "/", "*", "Get", "node", "iterator", "*", "/", "var", "nodeIterator", "=", "_createIterator", "(", "IN_PLACE", "?", "dirty", ":", "body", ")", ";", "/", "*", "Now", "start", "iterating", "over", "the", "created", "document", "*", "/", "while", "(", "currentNode", "=", "nodeIterator", ".", "nextNode", "(", "))", "{", "/", "*", "Fix", "IE", "'", "s", "strange", "behavior", "with", "manipulated", "textNodes", "#", "89", "*", "/", "if", "(", "currentNode", ".", "nodeType", "=", "==", "3", "&", "&", "currentNode", "=", "==", "oldNode", ")", "{", "continue", ";", "}", "/", "*", "Sanitize", "tags", "and", "elements", "*", "/", "if", "(", "_sanitizeElements", "(", "currentNode", ")", ")", "{", "continue", ";", "}", "/", "*", "Shadow", "DOM", "detected", ",", "sanitize", "it", "*", "/", "if", "(", "currentNode", ".", "content", "instanceof", "DocumentFragment", ")", "{", "_sanitizeShadowDOM", "(", "currentNode", ".", "content", ")", ";", "}", "/", "*", "Check", "attributes", ",", "sanitize", "if", "necessary", "*", "/", "_sanitizeAttributes", "(", "currentNode", ")", ";", "oldNode", "=", "currentNode", ";", "}", "/", "*", "If", "we", "sanitized", "`", "dirty", "`", "in", "-", "place", ",", "return", "it", ".", "*", "/", "if", "(", "IN_PLACE", ")", "{", "return", "dirty", ";", "}", "/", "*", "Return", "sanitized", "string", "or", "DOM", "*", "/", "if", "(", "RETURN_DOM", ")", "{", "if", "(", "RETURN_DOM_FRAGMENT", ")", "{", "returnNode", "=", "createDocumentFragment", ".", "call", "(", "body", ".", "ownerDocument", ")", ";", "while", "(", "body", ".", "firstChild", ")", "{", "returnNode", ".", "appendChild", "(", "body", ".", "firstChild", ")", ";", "}", "}", "else", "{", "returnNode", "=", "body", ";", "}", "if", "(", "RETURN_DOM_IMPORT", ")", "{", "/", "*", "AdoptNode", "(", ")", "is", "not", "used", "because", "internal", "state", "is", "not", "reset", "(", "e", ".", "g", ".", "the", "past", "names", "map", "of", "a", "HTMLFormElement", ")", ",", "this", "is", "safe", "in", "theory", "but", "we", "would", "rather", "not", "risk", "another", "attack", "vector", ".", "The", "state", "that", "is", "cloned", "by", "importNode", "(", ")", "is", "explicitly", "defined", "by", "the", "specs", ".", "*", "/", "returnNode", "=", "importNode", ".", "call", "(", "originalDocument", ",", "returnNode", ",", "true", ")", ";", "}", "return", "returnNode", ";", "}", "return", "WHOLE_DOCUMENT", "?", "body", ".", "outerHTML", ":", "body", ".", "innerHTML", ";", "}", ";", "/", "**", "*", "Public", "method", "to", "set", "the", "configuration", "once", "*", "setConfig", "*", "*", "@", "param", "{", "Object", "}", "cfg", "configuration", "object", "*", "/", "DOMPurify", ".", "setConfig", "=", "function", "(", "cfg", ")", "{", "_parseConfig", "(", "cfg", ")", ";", "SET_CONFIG", "=", "true", ";", "}", ";", "/", "**", "*", "Public", "method", "to", "remove", "the", "configuration", "*", "clearConfig", "*", "*", "/", "DOMPurify", ".", "clearConfig", "=", "function", "(", ")", "{", "CONFIG", "=", "null", ";", "SET_CONFIG", "=", "false", ";", "}", ";", "/", "**", "*", "Public", "method", "to", "check", "if", "an", "attribute", "value", "is", "valid", ".", "*", "Uses", "last", "set", "config", ",", "if", "any", ".", "Otherwise", ",", "uses", "config", "defaults", ".", "*", "isValidAttribute", "*", "*", "@", "param", "{", "string", "}", "tag", "Tag", "name", "of", "containing", "element", ".", "*", "@", "param", "{", "string", "}", "attr", "Attribute", "name", ".", "*", "@", "param", "{", "string", "}", "value", "Attribute", "value", ".", "*", "@", "return", "{", "Boolean", "}", "Returns", "true", "if", "`", "value", "`", "is", "valid", ".", "Otherwise", ",", "returns", "false", ".", "*", "/", "DOMPurify", ".", "isValidAttribute", "=", "function", "(", "tag", ",", "attr", ",", "value", ")", "{", "/", "*", "Initialize", "shared", "config", "vars", "if", "necessary", ".", "*", "/", "if", "(", "!", "CONFIG", ")", "{", "_parseConfig", "(", "{}", ");", "}", "var", "lcTag", "=", "tag", ".", "toLowerCase", "(", ");", "var", "lcName", "=", "attr", ".", "toLowerCase", "(", ");", "return", "_isValidAttribute", "(", "lcTag", ",", "lcName", ",", "value", ")", ";", "}", ";", "/", "**", "*", "AddHook", "*", "Public", "method", "to", "add", "DOMPurify", "hooks", "*", "*", "@", "param", "{", "String", "}", "entryPoint", "entry", "point", "for", "the", "hook", "to", "add", "*", "@", "param", "{", "Function", "}", "hookFunction", "function", "to", "execute", "*", "/", "DOMPurify", ".", "addHook", "=", "function", "(", "entryPoint", ",", "hookFunction", ")", "{", "if", "(", "typeof", "hookFunction", "!", "==", "'", "function", "'", ")", "{", "return", ";", "}", "hooks", "[", "entryPoint", "]", "=", "hooks", "[", "entryPoint", "]", "|", "|", "[", "];", "hooks", "[", "entryPoint", "]", ".", "push", "(", "hookFunction", ")", ";", "}", ";", "/", "**", "*", "RemoveHook", "*", "Public", "method", "to", "remove", "a", "DOMPurify", "hook", "at", "a", "given", "entryPoint", "*", "(", "pops", "it", "from", "the", "stack", "of", "hooks", "if", "more", "are", "present", ")", "*", "*", "@", "param", "{", "String", "}", "entryPoint", "entry", "point", "for", "the", "hook", "to", "remove", "*", "/", "DOMPurify", ".", "removeHook", "=", "function", "(", "entryPoint", ")", "{", "if", "(", "hooks", "[", "entryPoint", "]", ")", "{", "hooks", "[", "entryPoint", "]", ".", "pop", "(", ");", "}", "}", ";", "/", "**", "*", "RemoveHooks", "*", "Public", "method", "to", "remove", "all", "DOMPurify", "hooks", "at", "a", "given", "entryPoint", "*", "*", "@", "param", "{", "String", "}", "entryPoint", "entry", "point", "for", "the", "hooks", "to", "remove", "*", "/", "DOMPurify", ".", "removeHooks", "=", "function", "(", "entryPoint", ")", "{", "if", "(", "hooks", "[", "entryPoint", "]", ")", "{", "hooks", "[", "entryPoint", "]", "=", "[", "];", "}", "}", ";", "/", "**", "*", "RemoveAllHooks", "*", "Public", "method", "to", "remove", "all", "DOMPurify", "hooks", "*", "*", "/", "DOMPurify", ".", "removeAllHooks", "=", "function", "(", ")", "{", "hooks", "=", "{", "};", "}", ";", "return", "DOMPurify", ";", "}", "var", "purify", "=", "createDOMPurify", "(", ");", "return", "purify", ";", "}", "))", ");", "/", "/#", "sourceMappingURL", "=", "purify", ".", "js", ".", "map", "@", "@", "-", "1", ",", "18", "+", "1", ",", "18", "@", "@", "(", "function", "(", "root", ",", "factory", ")", "{", "if", "(", "typeof", "define", "=", "==", "'", "function", "'", "&", "&", "define", ".", "amd", ")", "{", "/", "/", "AMD", ".", "Register", "as", "an", "anonymous", "module", "unless", "amdModuleId", "is", "set", "define", "(", "'", "simditor", "'", ",", "[", "\"", "jquery", "\"", ",\"", "simple", "-", "module", "\"", ",\"", "simple", "-", "hotkeys", "\"", ",\"", "simple", "-", "uploader", "\"", "],", "function", "(", "$,", "SimpleModule", ",", "simpleHotkeys", ",", "simpleUploader", ")", "{", "return", "(", "root", "[", "'", "Simditor", "'", "]", "=", "factory", "(", "$,", "SimpleModule", ",", "simpleHotkeys", ",", "simpleUploader", ")", ");", "define", "(", "'", "simditor", "'", ",", "[", "\"", "jquery", "\"", ",\"", "simple", "-", "module", "\"", ",\"", "simple", "-", "hotkeys", "\"", ",\"", "simple", "-", "uploader", "\"", ",\"", "dompurify", "\"", "],", "function", "(", "$,", "SimpleModule", ",", "simpleHotkeys", ",", "simpleUploader", ",", "DOMPurify", ")", "{", "return", "(", "root", "[", "'", "Simditor", "'", "]", "=", "factory", "(", "$,", "SimpleModule", ",", "simpleHotkeys", ",", "simpleUploader", ",", "DOMPurify", ")", ");", "}", ");", "}", "else", "if", "(", "typeof", "exports", "=", "==", "'", "object", "'", ")", "{", "/", "/", "Node", ".", "Does", "not", "work", "with", "strict", "CommonJS", ",", "but", "/", "/", "only", "CommonJS", "-", "like", "environments", "that", "support", "module", ".", "exports", ",", "/", "/", "like", "Node", ".", "module", ".", "exports", "=", "factory", "(", "require", "(", "\"", "jquery", "\"", "),", "require", "(", "\"", "simple", "-", "module", "\"", "),", "require", "(", "\"", "simple", "-", "hotkeys", "\"", "),", "require", "(", "\"", "simple", "-", "uploader", "\"", "))", ";", "module", ".", "exports", "=", "factory", "(", "require", "(", "\"", "jquery", "\"", "),", "require", "(", "\"", "simple", "-", "module", "\"", "),", "require", "(", "\"", "simple", "-", "hotkeys", "\"", "),", "require", "(", "\"", "simple", "-", "uploader", "\"", "),", "require", "(", "\"", "dompurify", "\"", "))", ";", "}", "else", "{", "root", "[", "'", "Simditor", "'", "]", "=", "factory", "(", "jQuery", ",", "SimpleModule", ",", "simple", ".", "hotkeys", ",", "simple", ".", "uploader", ")", ";", "root", "[", "'", "Simditor", "'", "]", "=", "factory", "(", "jQuery", ",", "SimpleModule", ",", "simple", ".", "hotkeys", ",", "simple", ".", "uploader", ",", "window", ".", "DOMPurify", ")", ";", "}", "}", "(", "this", ",", "function", "(", "$,", "SimpleModule", ",", "simpleHotkeys", ",", "simpleUploader", ")", "{", "}", "(", "this", ",", "function", "(", "$,", "SimpleModule", ",", "simpleHotkeys", ",", "simpleUploader", ",", "DOMPurify", ")", "{", "var", "AlignmentButton", ",", "BlockquoteButton", ",", "BoldButton", ",", "Button", ",", "Clipboard", ",", "CodeButton", ",", "CodePopover", ",", "ColorButton", ",", "FontScaleButton", ",", "Formatter", ",", "HrButton", ",", "ImageButton", ",", "ImagePopover", ",", "IndentButton", ",", "Indentation", ",", "InputManager", ",", "ItalicButton", ",", "Keystroke", ",", "LinkButton", ",", "LinkPopover", ",", "ListButton", ",", "OrderListButton", ",", "OutdentButton", ",", "Popover", ",", "Selection", ",", "Simditor", ",", "StrikethroughButton", ",", "TableButton", ",", "TitleButton", ",", "Toolbar", ",", "UnderlineButton", ",", "UndoManager", ",", "UnorderListButton", ",", "Util", ",", "extend", "=", "function", "(", "child", ",", "parent", ")", "{", "for", "(", "var", "key", "in", "parent", ")", "{", "if", "(", "hasProp", ".", "call", "(", "parent", ",", "key", ")", ")", "child", "[", "key", "]", "=", "parent", "[", "key", "]", ";", "}", "function", "ctor", "(", ")", "{", "this", ".", "constructor", "=", "child", ";", "}", "ctor", ".", "prototype", "=", "parent", ".", "prototype", ";", "child", ".", "prototype", "=", "new", "ctor", "(", ");", "child", ".", "__super__", "=", "parent", ".", "prototype", ";", "return", "child", ";", "}", ",", "@", "@", "-", "2337", ",", "7", "+", "2337", ",", "7", "@", "@", "Clipboard", "=", "(", "function", "(", "superClass", ")", "{", "return", "function", "(", ")", "{", "var", "pasteContent", ";", "_this", ".", "editor", ".", "hidePopover", "(", ");", "_this", ".", "editor", ".", "body", ".", "get", "(", "0", ")", ".", "innerHTML", "=", "state", ".", "html", ";", "_this", ".", "editor", ".", "body", ".", "get", "(", "0", ")", ".", "innerHTML", "=", "DOMPurify", "?", "DOMPurify", ".", "sanitize", "(", "state", ".", "html", ")", ":", "state", ".", "html", ";", "_this", ".", "editor", ".", "undoManager", ".", "caretPosition", "(", "state", ".", "caret", ")", ";", "_this", ".", "editor", ".", "body", ".", "focus", "(", ");", "_this", ".", "editor", ".", "selection", ".", "reset", "(", ");", "@", "@", "-", "2644", ",", "7", "+", "2644", ",", "7", "@", "@", "Simditor", "=", "(", "function", "(", "superClass", ")", "{", "Simditor", ".", "prototype", ".", "setValue", "=", "function", "(", "val", ")", "{", "this", ".", "hidePopover", "(", ");", "this", ".", "textarea", ".", "val", "(", "val", ")", ";", "this", ".", "body", ".", "get", "(", "0", ")", ".", "innerHTML", "=", "val", ";", "this", ".", "body", ".", "get", "(", "0", ")", ".", "innerHTML", "=", "DOMPurify", "?", "DOMPurify", ".", "sanitize", "(", "val", ")", ":", "val", ";", "this", ".", "formatter", ".", "format", "(", ");", "this", ".", "formatter", ".", "decorate", "(", ");", "this", ".", "util", ".", "reflow", "(", "this", ".", "body", ")", ";", "@", "@", "-", "44", ",", "7", "+", "44", ",", "7", "@", "@", "Uploader", "=", "(", "function", "(", "superClass", ")", "{", "_this", ".", "files", ".", "splice", "(", "$.", "inArray", "(", "file", ",", "_this", ".", "files", ")", ",", "1", ")", ";", "if", "(", "_this", ".", "queue", ".", "length", ">", "0", "&", "&", "_this", ".", "files", ".", "length", "<", "_this", ".", "opts", ".", "connectionCount", ")", "{", "return", "_this", ".", "upload", "(", "_this", ".", "queue", ".", "shift", "(", "))", ";", "}", "else", "{", "}", "else", "if", "(", "_this", ".", "files", ".", "length", "=", "==", "0", ")", "{", "return", "_this", ".", "uploading", "=", "false", ";", "}", "}", ";", "@", "@", "-", "13", ",", "5", "+", "13", ",", "6", "@", "@", "<", "script", "type", "=", "\"", "text", "/", "javascript", "\"", "src", "=", "\"", "assets", "/", "scripts", "/", "module", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "type", "=", "\"", "text", "/", "javascript", "\"", "src", "=", "\"", "assets", "/", "scripts", "/", "uploader", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "type", "=", "\"", "text", "/", "javascript", "\"", "src", "=", "\"", "assets", "/", "scripts", "/", "hotkeys", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "type", "=", "\"", "text", "/", "javascript", "\"", "src", "=", "\"", "assets", "/", "scripts", "/", "dompurify", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "type", "=", "\"", "text", "/", "javascript", "\"", "src", "=", "\"", "assets", "/", "scripts", "/", "simditor", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "type", "=", "\"", "text", "/", "javascript", "\"", "src", "=", "\"", "assets", "/", "scripts", "/", "page", "-", "demo", ".", "js", "\"", "><", "/", "script", ">", "@", "@", "-", "40", ",", "7", "+", "40", ",", "7", "@", "@", "$", "bundle", "install", "`", "``", "#", "Install", "Grunt", "#", "Install", "Dependencies", "Simditor", "uses", "[", "Grunt", "]", "(", "http", ":", "//", "gruntjs", ".", "com", "/", ")", "as", "the", "task", "runner", "to", "run", "tasks", "such", "as", "auto", "-", "compiling", "and", "watching", "files", ".", "@", "@", "-", "52", ",", "30", "+", "52", ",", "12", "@", "@", "Install", "Grunt", "'", "s", "command", "line", "interface", "(", "CLI", ")", "globally", ":", "$", "sudo", "npm", "install", "-", "g", "grunt", "-", "cli", "`", "``", "Install", "grunt", ":", "Install", "grunt", "and", "other", "dependencies", ":", "`", "``", "bash", "$", "npm", "install", "$", "npm", "i", "`", "``", "#", "Install", "Bower", "Dependencies", "Simditor", "uses", "[", "Bower", "]", "(", "http", ":", "//", "bower", ".", "io", "/", ")", "to", "manage", "front", "-", "end", "libraries", ":", "Install", "bower", "\uff1a", "`", "``", "bash", "npm", "install", "-", "g", "bower", "`", "``", "Install", "bower", "dependencies", ":", "`", "``", "bash", "bower", "install", "`", "``", "#", "Run", "Project", "Run", "project", "with", "grunt", ":", "@", "@", "-", "7", ",", "10", "+", "7", ",", "9", "@", "@", "root", ":", ".", "./", "#", "Download", "Click", "[", "Here", "]", "(", "https", ":", "//", "github", ".", "com", "/", "mycolorway", "/", "simditor", "/", "releases", ")", "to", "download", "the", "zip", "file", ".", "You", "can", "also", "install", "Simditor", "by", "bower", "and", "npm", ":", "Click", "[", "Here", "]", "(", "https", ":", "//", "github", ".", "com", "/", "mycolorway", "/", "simditor", "/", "releases", ")", "to", "download", "the", "zip", "file", ".", "You", "can", "also", "install", "Simditor", "npm", ":", "*", "`", "$", "npm", "install", "simditor", "`", "*", "`", "$", "bower", "install", "simditor", "`", "`", "$", "npm", "install", "simditor", "`", "Import", "files", "below", "into", "your", "web", "application", "@", "@", "-", "22", ",", "13", "+", "21", ",", "15", "@", "@", "Import", "files", "below", "into", "your", "web", "application", "<", "script", "type", "=", "\"", "text", "/", "javascript", "\"", "src", "=", "\"[", "script", "path", "]", "/", "module", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "type", "=", "\"", "text", "/", "javascript", "\"", "src", "=", "\"[", "script", "path", "]", "/", "hotkeys", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "type", "=", "\"", "text", "/", "javascript", "\"", "src", "=", "\"[", "script", "path", "]", "/", "uploader", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "type", "=", "\"", "text", "/", "javascript", "\"", "src", "=", "\"[", "script", "path", "]", "/", "dompurify", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "type", "=", "\"", "text", "/", "javascript", "\"", "src", "=", "\"[", "script", "path", "]", "/", "simditor", ".", "js", "\"", "><", "/", "script", ">", "`", "``", "Note", "that", "*", "Simditor", "is", "based", "on", "[", "jQuery", "]", "(", "http", ":", "//", "jquery", ".", "com", ")", "and", "[", "module", ".", "js", "]", "(", "https", ":", "//", "github", ".", "com", "/", "mycolorway", "/", "simple", "-", "module", ")", ".", "*", "[", "hotkeys", ".", "js", "]", "(", "https", ":", "//", "github", ".", "com", "/", "mycolorway", "/", "simple", "-", "hotkeys", ")", "is", "used", "to", "bind", "hotkeys", ".", "*", "[", "uploader", ".", "js", "]", "(", "https", ":", "//", "github", ".", "com", "/", "mycolorway", "/", "simple", "-", "uploader", ")", "is", "related", "to", "uploading", "files", ".", "You", "don", "'", "t", "need", "to", "import", "this", "file", "if", "you", "don", "'", "t", "want", "the", "uploading", "feature", ".", "*", "[", "dompurify", ".", "js", "]", "(", "https", ":", "//", "github", ".", "com", "/", "cure53", "/", "DOMPurify", ")", "is", "used", "to", "purify", "html", "tags", "for", "preventing", "xss", "attacks", ".", "#", "Using", "Simditor", "in", "your", "project", "@", "@", "-", "75", ",", "4", "+", "76", ",", "4", "@", "@", "Want", "some", "special", "interactions", "and", "features", "?", "have", "a", "look", "at", "[", "extension", "library", "]", "(", "Sample", "extensions", ":", "*", "a", "feature", "extension", ":", "[", "simditor", "-", "autosave", "]", "(", "https", ":", "//", "github", ".", "com", "/", "mycolorway", "/", "simditor", "-", "autosave", ")", "*", "a", "button", "extension", ":", "[", "simditor", "-", "mark", "]", "(", "https", ":", "//", "github", ".", "com", "/", "mycolorway", "/", "simditor", "-", "mark", ")", "\\", "No", "newline", "at", "end", "of", "file", "*", "a", "button", "extension", ":", "[", "simditor", "-", "mark", "]", "(", "https", ":", "//", "github", ".", "com", "/", "mycolorway", "/", "simditor", "-", "mark", ")", "@", "@", "-", "12", ",", "13", "+", "12", ",", "13", "@", "@", "<", "ul", ">", "<", "li", ">", "<", "a", "href", "=", "\"", "https", ":", "//", "github", ".", "com", "/", "mycolorway", "/", "simditor", "/", "releases", "\"", "target", "=", "\"", "_blank", "\"", "class", "=", "\"\"", ">", "Download", "Zip", "<", "/", "a", ">", "</", "li", ">", "<", "li", ">", "Install", "with", "npm", ":", "$", "npm", "install", "simditor", "<", "/", "li", ">", "<", "li", ">", "Install", "with", "bower", ":", "$", "bower", "install", "simditor", "<", "/", "li", ">", "<", "/", "ul", ">", "<", "/", "textarea", ">", "<", "/", "section", ">", "<", "script", "type", "=", "\"", "text", "/", "javascript", "\"", "src", "=", "\"", "assets", "/", "scripts", "/", "module", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "type", "=", "\"", "text", "/", "javascript", "\"", "src", "=", "\"", "assets", "/", "scripts", "/", "uploader", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "type", "=", "\"", "text", "/", "javascript", "\"", "src", "=", "\"", "assets", "/", "scripts", "/", "hotkeys", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "type", "=", "\"", "text", "/", "javascript", "\"", "src", "=", "\"", "assets", "/", "scripts", "/", "dompurify", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "type", "=", "\"", "text", "/", "javascript", "\"", "src", "=", "\"", "assets", "/", "scripts", "/", "simditor", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "type", "=", "\"", "text", "/", "javascript", "\"", "src", "=", "\"", "assets", "/", "scripts", "/", "page", "-", "demo", ".", "js", "\"", "><", "/", "script", ">", "@", "@", "-", "0", ",", "0", "+", "1", ",", "63", "@", "@", "<", "!", "doctype", "html", ">", "<", "html", ">", "<", "head", ">", "<", "meta", "charset", "=", "\"", "utf", "-", "8", "\"", ">", "<", "title", ">", "Jasmine", "Spec", "Runner", "<", "/", "title", ">", "<", "link", "rel", "=", "\"", "shortcut", "icon", "\"", "type", "=", "\"", "image", "/", "png", "\"", "href", "=", "\".", "grunt", "/", "grunt", "-", "contrib", "-", "jasmine", "/", "jasmine_favicon", ".", "png", "\"", ">", "<", "link", "rel", "=", "\"", "stylesheet", "\"", "type", "=", "\"", "text", "/", "css", "\"", "href", "=", "\".", "./", ".", "grunt", "/", "grunt", "-", "contrib", "-", "jasmine", "/", "jasmine", ".", "css", "\"", ">", "<", "link", "rel", "=", "\"", "stylesheet", "\"", "type", "=", "\"", "text", "/", "css", "\"", "href", "=", "\".", "./", "styles", "/", "simditor", ".", "css", "\"", ">", "<", "/", "head", ">", "<", "body", ">", "<", "script", "src", "=", "\".", "./", ".", "grunt", "/", "grunt", "-", "contrib", "-", "jasmine", "/", "es5", "-", "shim", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\".", "./", ".", "grunt", "/", "grunt", "-", "contrib", "-", "jasmine", "/", "jasmine", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\".", "./", ".", "grunt", "/", "grunt", "-", "contrib", "-", "jasmine", "/", "jasmine", "-", "html", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\".", "./", ".", "grunt", "/", "grunt", "-", "contrib", "-", "jasmine", "/", "json2", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\".", "./", ".", "grunt", "/", "grunt", "-", "contrib", "-", "jasmine", "/", "boot", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\".", "./", "node_modules", "/", "jquery", "/", "dist", "/", "jquery", ".", "min", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\".", "./", "node_modules", "/", "simple", "-", "module", "/", "lib", "/", "module", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\".", "./", "node_modules", "/", "simple", "-", "uploader", "/", "lib", "/", "uploader", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\".", "./", "node_modules", "/", "simple", "-", "hotkeys", "/", "lib", "/", "hotkeys", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\".", "./", "node_modules", "/", "dompurify", "/", "dist", "/", "purify", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\".", "./", "lib", "/", "simditor", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\"", "core", "-", "spec", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\"", "formatter", "-", "spec", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\"", "indentation", "-", "spec", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\"", "util", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\"", "buttons", "/", "alignment", "-", "spec", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\"", "buttons", "/", "bold", "-", "spec", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\"", "buttons", "/", "code", "-", "spec", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\"", "buttons", "/", "font", "-", "scale", "-", "spec", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\"", "buttons", "/", "table", "-", "spec", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\"", "buttons", "/", "title", "-", "spec", ".", "js", "\"", "><", "/", "script", ">", "<", "script", "src", "=", "\".", "./", ".", "grunt", "/", "grunt", "-", "contrib", "-", "jasmine", "/", "reporter", ".", "js", "\"", "><", "/", "script", ">", "<", "/", "body", ">", "<", "/", "html", ">", "@", "@", "-", "79", ",", "7", "+", "79", ",", "7", "@", "@", "class", "Clipboard", "extends", "SimpleModule", "setTimeout", "=", ">", "@", "editor", ".", "hidePopover", "(", ")", "@", "editor", ".", "body", ".", "get", "(", "0", ")", ".", "innerHTML", "=", "state", ".", "html", "@", "editor", ".", "body", ".", "get", "(", "0", ")", ".", "innerHTML", "=", "if", "DOMPurify", "then", "DOMPurify", ".", "sanitize", "(", "state", ".", "html", ")", "else", "state", ".", "html", "@", "editor", ".", "undoManager", ".", "caretPosition", "state", ".", "caret", "@", "editor", ".", "body", ".", "focus", "(", ")", "@", "editor", ".", "selection", ".", "reset", "(", ")", "@", "@", "-", "112", ",", "7", "+", "112", ",", "7", "@", "@", "class", "Clipboard", "extends", "SimpleModule", "if", "!", "pasteContent", "return", "if", "@", "_pastePlainText", "if", "$", "blockEl", ".", "is", "(", "'", "table", "'", ")", "lines", "=", "pasteContent", ".", "split", "(", "'\\", "n", "'", ")", "@", "@", "-", "216", ",", "7", "+", "216", ",", "7", "@", "@", "class", "Clipboard", "extends", "SimpleModule", "$", "node", "=", "$", "(", "node", ")", "return", "unless", "$", "node", ".", "length", ">", "0", "sizeMap", "=", "[", "sizeMap", "=", "[", "'", "1", ".", "5em", "'", "'", "1", ".", "25em", "'", "'", "0", ".", "75em", "'", "@", "@", "-", "115", ",", "7", "+", "115", ",", "7", "@", "@", "class", "Simditor", "extends", "SimpleModule", "setValue", ":", "(", "val", ")", "-", ">", "@", "hidePopover", "(", ")", "@", "textarea", ".", "val", "val", "@", "body", ".", "get", "(", "0", ")", ".", "innerHTML", "=", "val", "@", "body", ".", "get", "(", "0", ")", ".", "innerHTML", "=", "if", "DOMPurify", "then", "DOMPurify", ".", "sanitize", "(", "val", ")", "else", "val", "@", "formatter", ".", "format", "(", ")", "@", "formatter", ".", "decorate", "(", ")", "@", "@", "-", "162", ",", "7", "+", "162", ",", "7", "@", "@", "class", "Formatter", "extends", "SimpleModule", "$", "node", ".", "removeAttr", "(", "attr", ".", "name", ")", "@", "_cleanNodeStyles", "$", "node", "if", "$", "node", ".", "is", "(", "'", "span", "'", ")", "if", "$", "node", "[", "0", "]", ".", "attributes", ".", "length", "=", "=", "0", "$", "node", ".", "contents", "(", ").", "first", "(", ").", "unwrap", "(", ")", "@", "@", "-", "214", ",", "7", "+", "214", ",", "7", "@", "@", "class", "Formatter", "extends", "SimpleModule", "if", "pair", "[", "0", "]", "=", "=", "'", "font", "-", "size", "'", "and", "pair", "[", "1", "]", ".", "indexOf", "(", "'", "px", "'", ")", ">", "0", "continue", "if", "parseInt", "(", "pair", "[", "1", "]", ",", "10", ")", "<", "12", "styles", "[", "$.", "trim", "(", "pair", "[", "0", "]", ")]", "=", "$", ".", "trim", "(", "pair", "[", "1", "]", ")", "if", "pair", "[", "0", "]", "in", "allowedStyles", "$", "node", ".", "css", "styles", "if", "Object", ".", "keys", "(", "styles", ")", ".", "length", ">", "0", "@", "@", "-", "1", ",", "7", "+", "1", ",", "7", "@", "@", "/", "*!", "*", "Simditor", "v2", ".", "3", ".", "21", "*", "http", ":", "//", "simditor", ".", "tower", ".", "im", "/", "*", "2018", "-", "10", "-", "17", "*", "2018", "-", "11", "-", "09", "*", "/", "@", "font", "-", "face", "{", "font", "-", "family", ":", "'", "Simditor", "'", ";"], "docstring_tokens": ["improper", "validation", "of", "user-supplied", "input"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "302", ",", "6", "+", "302", ",", "8", "@", "@", "Bug", "Fixes", "*", "SOLR", "-", "14751", ":", "Zookeeper", "Admin", "screen", "not", "working", "for", "old", "ZK", "versions", "(", "janhoy", ")", "*", "SOLR", "-", "14663", ":", "Copy", "ConfigSet", "root", "data", "from", "base", "ConfigSet", "when", "using", "CREATE", "command", "(", "Andras", "Salamon", ",", "Tom", "\u00e1", "s", "Fern", "\u00e1", "ndez", "L", "\u00f6", "bbe", ")", "=", "==", "==", "==", "==", "==", "==", "==", "==", "=", "8", ".", "6", ".", "1", "=", "==", "==", "==", "==", "==", "==", "==", "==", "=", "Bug", "Fixes", "@", "@", "-", "73", ",", "6", "+", "73", ",", "7", "@", "@", "*", "A", "{", "@", "link", "org", ".", "apache", ".", "solr", ".", "request", ".", "SolrRequestHandler", "}", "for", "ConfigSets", "API", "requests", ".", "*", "/", "public", "class", "ConfigSetsHandler", "extends", "RequestHandlerBase", "implements", "PermissionNameProvider", "{", "final", "public", "static", "Boolean", "DISABLE_CREATE_AUTH_CHECKS", "=", "Boolean", ".", "getBoolean", "(", "\"", "solr", ".", "disableConfigSetsCreateAuthChecks", "\"", ");", "/", "/", "this", "is", "for", "back", "compat", "only", "final", "public", "static", "String", "DEFAULT_CONFIGSET_NAME", "=", "\"", "_default", "\"", ";", "final", "public", "static", "String", "AUTOCREATED_CONFIGSET_SUFFIX", "=", "\"", ".", "AUTOCREATED", "\"", ";", "private", "static", "final", "Logger", "log", "=", "LoggerFactory", ".", "getLogger", "(", "MethodHandles", ".", "lookup", "(", ").", "lookupClass", "(", "))", ";", "@", "@", "-", "192", ",", "7", "+", "193", ",", "7", "@", "@", "private", "void", "handleConfigUploadRequest", "(", "SolrQueryRequest", "req", ",", "SolrQueryResponse", "r", "}", "else", "{", "filesToDelete", "=", "Collections", ".", "emptySet", "(", ");", "}", "createBaseZnode", "(", "zkClient", ",", "overwritesExisting", ",", "isTrusted", "(", "req", ")", ",", "cleanup", ",", "configPathInZk", ")", ";", "createBaseZnode", "(", "zkClient", ",", "overwritesExisting", ",", "isTrusted", "(", "req", ",", "coreContainer", ".", "getAuthenticationPlugin", "(", "))", ",", "cleanup", ",", "configPathInZk", ")", ";", "ZipInputStream", "zis", "=", "new", "ZipInputStream", "(", "inputStream", ",", "StandardCharsets", ".", "UTF_8", ")", ";", "ZipEntry", "zipEntry", "=", "null", ";", "@", "@", "-", "259", ",", "9", "+", "260", ",", "19", "@", "@", "private", "void", "deleteUnusedFiles", "(", "SolrZkClient", "zkClient", ",", "Set", "<", "String", ">", "filesToDelete", ")", "*", "Fail", "if", "an", "untrusted", "request", "tries", "to", "update", "a", "trusted", "ConfigSet", "*", "/", "private", "void", "ensureOverwritingUntrustedConfigSet", "(", "SolrZkClient", "zkClient", ",", "String", "configSetZkPath", ")", "{", "boolean", "isCurrentlyTrusted", "=", "isCurrentlyTrusted", "(", "zkClient", ",", "configSetZkPath", ")", ";", "if", "(", "isCurrentlyTrusted", ")", "{", "throw", "new", "SolrException", "(", "ErrorCode", ".", "BAD_REQUEST", ",", "\"", "Trying", "to", "make", "an", "unstrusted", "ConfigSet", "update", "on", "a", "trusted", "configSet", "\"", ");", "}", "}", "private", "static", "boolean", "isCurrentlyTrusted", "(", "SolrZkClient", "zkClient", ",", "String", "configSetZkPath", ")", "{", "byte", "[", "]", "configSetNodeContent", ";", "try", "{", "configSetNodeContent", "=", "zkClient", ".", "getData", "(", "configSetZkPath", ",", "null", ",", "null", ",", "true", ")", ";", "if", "(", "configSetNodeContent", "=", "=", "null", "|", "|", "configSetNodeContent", ".", "length", "=", "=", "0", ")", "{", "return", "true", ";", "}", "}", "catch", "(", "KeeperException", "e", ")", "{", "throw", "new", "SolrException", "(", "ErrorCode", ".", "SERVER_ERROR", ",", "\"", "Exception", "while", "fetching", "current", "configSet", "at", "\"", "+", "configSetZkPath", ",", "e", ")", ";", "}", "catch", "(", "InterruptedException", "e", ")", "{", "@", "@", "-", "270", ",", "21", "+", "281", ",", "15", "@", "@", "private", "void", "ensureOverwritingUntrustedConfigSet", "(", "SolrZkClient", "zkClient", ",", "String", "c", "}", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Map", "<", "Object", ",", "Object", ">", "contentMap", "=", "(", "Map", "<", "Object", ",", "Object", ">", ")", "Utils", ".", "fromJSON", "(", "configSetNodeContent", ")", ";", "boolean", "isCurrentlyTrusted", "=", "(", "boolean", ")", "contentMap", ".", "getOrDefault", "(", "\"", "trusted", "\"", ",", "true", ")", ";", "if", "(", "isCurrentlyTrusted", ")", "{", "throw", "new", "SolrException", "(", "ErrorCode", ".", "BAD_REQUEST", ",", "\"", "Trying", "to", "make", "an", "unstrusted", "ConfigSet", "update", "on", "a", "trusted", "configSet", "\"", ");", "}", "return", "(", "boolean", ")", "contentMap", ".", "getOrDefault", "(", "\"", "trusted", "\"", ",", "true", ")", ";", "}", "boolean", "isTrusted", "(", "SolrQueryRequest", "req", ")", "{", "AuthenticationPlugin", "authcPlugin", "=", "coreContainer", ".", "getAuthenticationPlugin", "(", ");", "if", "(", "log", ".", "isInfoEnabled", "(", "))", "{", "log", ".", "info", "(", "\"", "Trying", "to", "upload", "a", "configset", ".", "authcPlugin", ":", "{", "},", "user", "principal", ":", "{", "}\"", ",", "authcPlugin", ",", "req", ".", "getUserPrincipal", "(", "))", ";", "}", "if", "(", "authcPlugin", "!", "=", "null", "&", "&", "req", ".", "getUserPrincipal", "(", ")", "!", "=", "null", ")", "{", "static", "boolean", "isTrusted", "(", "SolrQueryRequest", "req", ",", "AuthenticationPlugin", "authPlugin", ")", "{", "if", "(", "authPlugin", "!", "=", "null", "&", "&", "req", ".", "getUserPrincipal", "(", ")", "!", "=", "null", ")", "{", "log", ".", "debug", "(", "\"", "Trusted", "configset", "request", "\"", ");", "return", "true", ";", "}", "log", ".", "debug", "(", "\"", "Untrusted", "configset", "request", "\"", ");", "return", "false", ";", "}", "@", "@", "-", "361", ",", "8", "+", "366", ",", "29", "@", "@", "public", "Category", "getCategory", "(", ")", "{", "@", "Override", "public", "Map", "<", "String", ",", "Object", ">", "call", "(", "SolrQueryRequest", "req", ",", "SolrQueryResponse", "rsp", ",", "ConfigSetsHandler", "h", ")", "throws", "Exception", "{", "String", "baseConfigSetName", "=", "req", ".", "getParams", "(", ").", "get", "(", "BASE_CONFIGSET", ",", "DEFAULT_CONFIGSET_NAME", ")", ";", "String", "newConfigSetName", "=", "req", ".", "getParams", "(", ").", "get", "(", "NAME", ")", ";", "if", "(", "newConfigSetName", "=", "=", "null", "|", "|", "newConfigSetName", ".", "length", "(", ")", "=", "=", "0", ")", "{", "throw", "new", "SolrException", "(", "ErrorCode", ".", "BAD_REQUEST", ",", "\"", "ConfigSet", "name", "not", "specified", "\"", ");", "}", "ZkConfigManager", "zkConfigManager", "=", "new", "ZkConfigManager", "(", "h", ".", "coreContainer", ".", "getZkController", "(", ").", "getZkStateReader", "(", ").", "getZkClient", "(", "))", ";", "if", "(", "zkConfigManager", ".", "configExists", "(", "newConfigSetName", ")", ")", "{", "throw", "new", "SolrException", "(", "ErrorCode", ".", "BAD_REQUEST", ",", "\"", "ConfigSet", "already", "exists", ":", "\"", "+", "newConfigSetName", ")", ";", "}", "/", "/", "is", "there", "a", "base", "config", "that", "already", "exists", "if", "(", "!", "zkConfigManager", ".", "configExists", "(", "baseConfigSetName", ")", ")", "{", "throw", "new", "SolrException", "(", "ErrorCode", ".", "BAD_REQUEST", ",", "\"", "Base", "ConfigSet", "does", "not", "exist", ":", "\"", "+", "baseConfigSetName", ")", ";", "}", "Map", "<", "String", ",", "Object", ">", "props", "=", "CollectionsHandler", ".", "copy", "(", "req", ".", "getParams", "(", ").", "required", "(", "),", "null", ",", "NAME", ")", ";", "props", ".", "put", "(", "BASE_CONFIGSET", ",", "baseConfigSetName", ")", ";", "if", "(", "!", "DISABLE_CREATE_AUTH_CHECKS", "&", "&", "!", "isTrusted", "(", "req", ",", "h", ".", "coreContainer", ".", "getAuthenticationPlugin", "(", "))", "&", "&", "isCurrentlyTrusted", "(", "h", ".", "coreContainer", ".", "getZkController", "(", ").", "getZkClient", "(", "),", "ZkConfigManager", ".", "CONFIGS_ZKNODE", "+", "\"", "/\"", "+", "baseConfigSetName", ")", ")", "{", "throw", "new", "SolrException", "(", "ErrorCode", ".", "UNAUTHORIZED", ",", "\"", "Can", "'", "t", "create", "a", "configset", "with", "an", "unauthenticated", "request", "from", "a", "trusted", "\"", "+", "BASE_CONFIGSET", ")", ";", "}", "return", "copyPropertiesWithPrefix", "(", "req", ".", "getParams", "(", "),", "props", ",", "PROPERTY_PREFIX", "+", "\"", ".\"", ");", "}", "}", ",", "@", "@", "-", "35", ",", "6", "+", "35", ",", "7", "@", "@", "import", "java", ".", "security", ".", "Principal", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Deque", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "Iterator", ";", "@", "@", "-", "68", ",", "6", "+", "69", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "solr", ".", "client", ".", "solrj", ".", "request", ".", "QueryRequest", ";", "import", "org", ".", "apache", ".", "solr", ".", "client", ".", "solrj", ".", "response", ".", "CollectionAdminResponse", ";", "import", "org", ".", "apache", ".", "solr", ".", "client", ".", "solrj", ".", "response", ".", "ConfigSetAdminResponse", ";", "import", "org", ".", "apache", ".", "solr", ".", "common", ".", "SolrException", ";", "import", "org", ".", "apache", ".", "solr", ".", "common", ".", "SolrInputDocument", ";", "import", "org", ".", "apache", ".", "solr", ".", "common", ".", "cloud", ".", "SolrZkClient", ";", "import", "org", ".", "apache", ".", "solr", ".", "common", ".", "cloud", ".", "ZkConfigManager", ";", "@", "@", "-", "136", ",", "51", "+", "138", ",", "84", "@", "@", "public", "void", "tearDown", "(", ")", "throws", "Exception", "{", "@", "Test", "public", "void", "testCreateErrors", "(", ")", "throws", "Exception", "{", "final", "String", "baseUrl", "=", "cluster", ".", "getJettySolrRunners", "(", ").", "get", "(", "0", ")", ".", "getBaseUrl", "(", ").", "toString", "(", ");", "final", "SolrClient", "solrClient", "=", "getHttpSolrClient", "(", "baseUrl", ")", ";", "zkConfigManager", ".", "uploadConfigDir", "(", "configset", "(", "\"", "configset", "-", "2", "\"", "),", "\"", "configSet", "\"", ");", "/", "/", "no", "action", "CreateNoErrorChecking", "createNoAction", "=", "new", "CreateNoErrorChecking", "(", ");", "createNoAction", ".", "setAction", "(", "null", ")", ";", "verifyException", "(", "solrClient", ",", "createNoAction", ",", "\"", "action", "\"", ");", "/", "/", "no", "ConfigSet", "name", "CreateNoErrorChecking", "create", "=", "new", "CreateNoErrorChecking", "(", ");", "verifyException", "(", "solrClient", ",", "create", ",", "NAME", ")", ";", "/", "/", "set", "ConfigSet", "create", ".", "setConfigSetName", "(", "\"", "configSetName", "\"", ");", "/", "/", "ConfigSet", "already", "exists", "Create", "alreadyExists", "=", "new", "Create", "(", ");", "alreadyExists", ".", "setConfigSetName", "(", "\"", "configSet", "\"", ").", "setBaseConfigSetName", "(", "\"", "baseConfigSet", "\"", ");", "verifyException", "(", "solrClient", ",", "alreadyExists", ",", "\"", "ConfigSet", "already", "exists", "\"", ");", "/", "/", "Base", "ConfigSet", "does", "not", "exist", "Create", "baseConfigNoExists", "=", "new", "Create", "(", ");", "baseConfigNoExists", ".", "setConfigSetName", "(", "\"", "newConfigSet", "\"", ").", "setBaseConfigSetName", "(", "\"", "baseConfigSet", "\"", ");", "verifyException", "(", "solrClient", ",", "baseConfigNoExists", ",", "\"", "Base", "ConfigSet", "does", "not", "exist", "\"", ");", "solrClient", ".", "close", "(", ");", "try", "(", "final", "SolrClient", "solrClient", "=", "getHttpSolrClient", "(", "baseUrl", ")", ")", "{", "zkConfigManager", ".", "uploadConfigDir", "(", "configset", "(", "\"", "configset", "-", "2", "\"", "),", "\"", "configSet", "\"", ");", "/", "/", "no", "action", "CreateNoErrorChecking", "createNoAction", "=", "new", "CreateNoErrorChecking", "(", ");", "createNoAction", ".", "setAction", "(", "null", ")", ";", "verifyException", "(", "solrClient", ",", "createNoAction", ",", "\"", "action", "\"", ");", "/", "/", "no", "ConfigSet", "name", "CreateNoErrorChecking", "create", "=", "new", "CreateNoErrorChecking", "(", ");", "verifyException", "(", "solrClient", ",", "create", ",", "NAME", ")", ";", "/", "/", "set", "ConfigSet", "create", ".", "setConfigSetName", "(", "\"", "configSetName", "\"", ");", "/", "/", "ConfigSet", "already", "exists", "Create", "alreadyExists", "=", "new", "Create", "(", ");", "alreadyExists", ".", "setConfigSetName", "(", "\"", "configSet", "\"", ").", "setBaseConfigSetName", "(", "\"", "baseConfigSet", "\"", ");", "verifyException", "(", "solrClient", ",", "alreadyExists", ",", "\"", "ConfigSet", "already", "exists", "\"", ");", "/", "/", "Base", "ConfigSet", "does", "not", "exist", "Create", "baseConfigNoExists", "=", "new", "Create", "(", ");", "baseConfigNoExists", ".", "setConfigSetName", "(", "\"", "newConfigSet", "\"", ").", "setBaseConfigSetName", "(", "\"", "baseConfigSet", "\"", ");", "verifyException", "(", "solrClient", ",", "baseConfigNoExists", ",", "\"", "Base", "ConfigSet", "does", "not", "exist", "\"", ");", "}", "}", "@", "Test", "public", "void", "testCreate", "(", ")", "throws", "Exception", "{", "/", "/", "no", "old", ",", "no", "new", "verifyCreate", "(", "null", ",", "\"", "configSet1", "\"", ",", "null", ",", "null", ")", ";", "verifyCreate", "(", "null", ",", "\"", "configSet1", "\"", ",", "null", ",", "null", ",", "\"", "solr", "\"", ");", "/", "/", "no", "old", ",", "new", "verifyCreate", "(", "\"", "baseConfigSet2", "\"", ",", "\"", "configSet2", "\"", ",", "null", ",", "ImmutableMap", ".", "<", "String", ",", "String", ">", "of", "(", "\"", "immutable", "\"", ",", "\"", "true", "\"", ",", "\"", "key1", "\"", ",", "\"", "value1", "\"", "))", ";", "null", ",", "ImmutableMap", ".", "<", "String", ",", "String", ">", "of", "(", "\"", "immutable", "\"", ",", "\"", "true", "\"", ",", "\"", "key1", "\"", ",", "\"", "value1", "\"", "),", "\"", "solr", "\"", ");", "/", "/", "old", ",", "no", "new", "verifyCreate", "(", "\"", "baseConfigSet3", "\"", ",", "\"", "configSet3", "\"", ",", "ImmutableMap", ".", "<", "String", ",", "String", ">", "of", "(", "\"", "immutable", "\"", ",", "\"", "false", "\"", ",", "\"", "key2", "\"", ",", "\"", "value2", "\"", "),", "null", ")", ";", "ImmutableMap", ".", "<", "String", ",", "String", ">", "of", "(", "\"", "immutable", "\"", ",", "\"", "false", "\"", ",", "\"", "key2", "\"", ",", "\"", "value2", "\"", "),", "null", ",", "\"", "solr", "\"", ");", "/", "/", "old", ",", "new", "verifyCreate", "(", "\"", "baseConfigSet4", "\"", ",", "\"", "configSet4", "\"", ",", "ImmutableMap", ".", "<", "String", ",", "String", ">", "of", "(", "\"", "immutable", "\"", ",", "\"", "true", "\"", ",", "\"", "onlyOld", "\"", ",", "\"", "onlyOldValue", "\"", "),", "ImmutableMap", ".", "<", "String", ",", "String", ">", "of", "(", "\"", "immutable", "\"", ",", "\"", "false", "\"", ",", "\"", "onlyNew", "\"", ",", "\"", "onlyNewValue", "\"", "))", ";", "ImmutableMap", ".", "<", "String", ",", "String", ">", "of", "(", "\"", "immutable", "\"", ",", "\"", "false", "\"", ",", "\"", "onlyNew", "\"", ",", "\"", "onlyNewValue", "\"", "),", "\"", "solr", "\"", ");", "}", "@", "Test", "public", "void", "testCreateWithTrust", "(", ")", "throws", "Exception", "{", "String", "configsetName", "=", "\"", "regular", "\"", ";", "String", "configsetSuffix", "=", "\"", "testCreateWithTrust", "\"", ";", "String", "configsetSuffix2", "=", "\"", "testCreateWithTrust2", "\"", ";", "uploadConfigSetWithAssertions", "(", "configsetName", ",", "configsetSuffix", ",", "\"", "solr", "\"", ");", "uploadConfigSetWithAssertions", "(", "configsetName", ",", "configsetSuffix2", ",", "null", ")", ";", "try", "(", "SolrZkClient", "zkClient", "=", "new", "SolrZkClient", "(", "cluster", ".", "getZkServer", "(", ").", "getZkAddress", "(", "),", "AbstractZkTestCase", ".", "TIMEOUT", ",", "45000", ",", "null", ")", ")", "{", "assertTrue", "(", "isTrusted", "(", "zkClient", ",", "configsetName", ",", "configsetSuffix", ")", ");", "assertFalse", "(", "isTrusted", "(", "zkClient", ",", "configsetName", ",", "configsetSuffix2", ")", ");", "try", "{", "ignoreException", "(", "\"", "unauthenticated", "request", "\"", ");", "/", "/", "trusted", "-", ">", "unstrusted", "createConfigSet", "(", "configsetName", "+", "configsetSuffix", ",", "\"", "foo", "\"", ",", "Collections", ".", "emptyMap", "(", "),", "cluster", ".", "getSolrClient", "(", "),", "null", ")", ";", "fail", "(", "\"", "Expecting", "exception", "\"", ");", "}", "catch", "(", "SolrException", "e", ")", "{", "assertEquals", "(", "SolrException", ".", "ErrorCode", ".", "UNAUTHORIZED", ".", "code", ",", "e", ".", "code", "(", "))", ";", "unIgnoreException", "(", "\"", "unauthenticated", "request", "\"", ");", "}", "/", "/", "trusted", "-", ">", "trusted", "verifyCreate", "(", "configsetName", "+", "configsetSuffix", ",", "\"", "foo2", "\"", ",", "Collections", ".", "emptyMap", "(", "),", "Collections", ".", "emptyMap", "(", "),", "\"", "solr", "\"", ");", "assertTrue", "(", "isTrusted", "(", "zkClient", ",", "\"", "foo2", "\"", ",", "\"", "\")", ");", "/", "/", "unstrusted", "-", ">", "unstrusted", "verifyCreate", "(", "configsetName", "+", "configsetSuffix2", ",", "\"", "bar", "\"", ",", "Collections", ".", "emptyMap", "(", "),", "Collections", ".", "emptyMap", "(", "),", "null", ")", ";", "assertFalse", "(", "isTrusted", "(", "zkClient", ",", "\"", "bar", "\"", ",", "\"", "\")", ");", "/", "/", "unstrusted", "-", ">", "trusted", "verifyCreate", "(", "configsetName", "+", "configsetSuffix2", ",", "\"", "bar2", "\"", ",", "Collections", ".", "emptyMap", "(", "),", "Collections", ".", "emptyMap", "(", "),", "\"", "solr", "\"", ");", "assertFalse", "(", "isTrusted", "(", "zkClient", ",", "\"", "bar2", "\"", ",", "\"", "\")", ");", "}", "}", "private", "void", "setupBaseConfigSet", "(", "String", "baseConfigSetName", ",", "Map", "<", "String", ",", "String", ">", "oldProps", ")", "throws", "Exception", "{", "@", "@", "-", "196", ",", "33", "+", "231", ",", "40", "@", "@", "private", "void", "setupBaseConfigSet", "(", "String", "baseConfigSetName", ",", "Map", "<", "String", ",", "String", ">", "ol", "}", "private", "void", "verifyCreate", "(", "String", "baseConfigSetName", ",", "String", "configSetName", ",", "Map", "<", "String", ",", "String", ">", "oldProps", ",", "Map", "<", "String", ",", "String", ">", "newProps", ")", "throws", "Exception", "{", "Map", "<", "String", ",", "String", ">", "oldProps", ",", "Map", "<", "String", ",", "String", ">", "newProps", ",", "String", "username", ")", "throws", "Exception", "{", "final", "String", "baseUrl", "=", "cluster", ".", "getJettySolrRunners", "(", ").", "get", "(", "0", ")", ".", "getBaseUrl", "(", ").", "toString", "(", ");", "final", "SolrClient", "solrClient", "=", "getHttpSolrClient", "(", "baseUrl", ")", ";", "setupBaseConfigSet", "(", "baseConfigSetName", ",", "oldProps", ")", ";", "try", "(", "final", "SolrClient", "solrClient", "=", "getHttpSolrClient", "(", "baseUrl", ")", ")", "{", "setupBaseConfigSet", "(", "baseConfigSetName", ",", "oldProps", ")", ";", "SolrZkClient", "zkClient", "=", "new", "SolrZkClient", "(", "cluster", ".", "getZkServer", "(", ").", "getZkAddress", "(", "),", "AbstractZkTestCase", ".", "TIMEOUT", ",", "AbstractZkTestCase", ".", "TIMEOUT", ",", "null", ")", ";", "try", "{", "ZkConfigManager", "configManager", "=", "new", "ZkConfigManager", "(", "zkClient", ")", ";", "assertFalse", "(", "configManager", ".", "configExists", "(", "configSetName", ")", ");", "Create", "create", "=", "new", "Create", "(", ");", "create", ".", "setBaseConfigSetName", "(", "baseConfigSetName", ")", ".", "setConfigSetName", "(", "configSetName", ")", ";", "if", "(", "newProps", "!", "=", "null", ")", "{", "Properties", "p", "=", "new", "Properties", "(", ");", "p", ".", "putAll", "(", "newProps", ")", ";", "create", ".", "setNewConfigSetProperties", "(", "p", ")", ";", "SolrZkClient", "zkClient", "=", "new", "SolrZkClient", "(", "cluster", ".", "getZkServer", "(", ").", "getZkAddress", "(", "),", "AbstractZkTestCase", ".", "TIMEOUT", ",", "AbstractZkTestCase", ".", "TIMEOUT", ",", "null", ")", ";", "try", "{", "ZkConfigManager", "configManager", "=", "new", "ZkConfigManager", "(", "zkClient", ")", ";", "assertFalse", "(", "configManager", ".", "configExists", "(", "configSetName", ")", ");", "ConfigSetAdminResponse", "response", "=", "createConfigSet", "(", "baseConfigSetName", ",", "configSetName", ",", "newProps", ",", "solrClient", ",", "username", ")", ";", "assertNotNull", "(", "response", ".", "getResponse", "(", "))", ";", "assertTrue", "(", "configManager", ".", "configExists", "(", "configSetName", ")", ");", "verifyProperties", "(", "configSetName", ",", "oldProps", ",", "newProps", ",", "zkClient", ")", ";", "}", "finally", "{", "zkClient", ".", "close", "(", ");", "}", "ConfigSetAdminResponse", "response", "=", "create", ".", "process", "(", "solrClient", ")", ";", "assertNotNull", "(", "response", ".", "getResponse", "(", "))", ";", "assertTrue", "(", "configManager", ".", "configExists", "(", "configSetName", ")", ");", "}", "}", "verifyProperties", "(", "configSetName", ",", "oldProps", ",", "newProps", ",", "zkClient", ")", ";", "}", "finally", "{", "zkClient", ".", "close", "(", ");", "private", "ConfigSetAdminResponse", "createConfigSet", "(", "String", "baseConfigSetName", ",", "String", "configSetName", ",", "Map", "<", "String", ",", "String", ">", "newProps", ",", "SolrClient", "solrClient", ",", "String", "username", ")", "throws", "SolrServerException", ",", "IOException", "{", "Create", "create", "=", "new", "Create", "(", ");", "create", ".", "setBaseConfigSetName", "(", "baseConfigSetName", ")", ".", "setConfigSetName", "(", "configSetName", ")", ";", "if", "(", "newProps", "!", "=", "null", ")", "{", "Properties", "p", "=", "new", "Properties", "(", ");", "p", ".", "putAll", "(", "newProps", ")", ";", "create", ".", "setNewConfigSetProperties", "(", "p", ")", ";", "}", "solrClient", ".", "close", "(", ");", "if", "(", "username", "!", "=", "null", ")", "{", "create", ".", "addHeader", "(", "\"", "user", "\"", ",", "username", ")", ";", "}", "return", "create", ".", "process", "(", "solrClient", ")", ";", "}", "@", "SuppressWarnings", "(", "{\"", "rawtypes", "\"", "})", "@", "@", "-", "17", ",", "6", "+", "17", ",", "7", "@", "@", "package", "org", ".", "apache", ".", "solr", ".", "cloud", ";", "import", "java", ".", "lang", ".", "invoke", ".", "MethodHandles", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "LinkedList", ";", "import", "java", ".", "util", ".", "List", ";", "@", "@", "-", "92", ",", "6", "+", "93", ",", "8", "@", "@", "public", "void", "testAPIExclusivity", "(", ")", "throws", "Exception", "{", "private", "void", "setupBaseConfigSet", "(", "String", "baseConfigSetName", ")", "throws", "Exception", "{", "solrCluster", ".", "uploadConfigSet", "(", "configset", "(", "\"", "configset", "-", "2", "\"", "),", "baseConfigSetName", ")", ";", "/", "/", "Make", "configset", "untrusted", "solrCluster", ".", "getZkClient", "(", ").", "setData", "(", "\"/", "configs", "/", "\"", "+", "baseConfigSetName", ",", "\"", "{\\", "\"", "trusted", "\\", "\":", "false", "}", "\".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ",", "true", ")", ";", "}", "private", "Exception", "getFirstExceptionOrNull", "(", "List", "<", "Exception", ">", "list", ")", "{", "@", "@", "-", "137", ",", "6", "+", "137", ",", "7", "@", "@", "private", "void", "setupBaseConfigSet", "(", "String", "baseConfigSetName", ",", "Map", "<", "String", ",", "String", ">", "ol", "getConfigSetProps", "(", "oldProps", ")", ",", "StandardCharsets", ".", "UTF_8", ")", ";", "}", "solrCluster", ".", "uploadConfigSet", "(", "tmpConfigDir", ".", "toPath", "(", "),", "baseConfigSetName", ")", ";", "solrCluster", ".", "getZkClient", "(", ").", "setData", "(", "\"/", "configs", "/", "\"", "+", "baseConfigSetName", ",", "\"", "{\\", "\"", "trusted", "\\", "\":", "false", "}", "\".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ",", "true", ")", ";", "}", "private", "StringBuilder", "getConfigSetProps", "(", "Map", "<", "String", ",", "String", ">", "map", ")", "{", "@", "@", "-", "27", ",", "7", "+", "27", ",", "6", "@", "@", "import", "org", ".", "apache", ".", "solr", ".", "response", ".", "SolrQueryResponse", ";", "import", "static", "org", ".", "apache", ".", "solr", ".", "client", ".", "solrj", ".", "SolrRequest", ".", "METHOD", ".", "DELETE", ";", "import", "static", "org", ".", "apache", ".", "solr", ".", "client", ".", "solrj", ".", "SolrRequest", ".", "METHOD", ".", "POST", ";", "import", "static", "org", ".", "apache", ".", "solr", ".", "cloud", ".", "Overseer", ".", "QUEUE_OPERATION", ";", "import", "static", "org", ".", "apache", ".", "solr", ".", "handler", ".", "admin", ".", "TestCollectionAPIs", ".", "compareOutput", ";", "@", "@", "-", "58", ",", "9", "+", "57", ",", "6", "@", "@", "protected", "void", "sendToZk", "(", "SolrQueryResponse", "rsp", ",", "/", "/", "for", "(", "Api", "api", ":", "handler", ".", "getApis", "(", "))", "apiBag", ".", "register", "(", "api", ",", "EMPTY_MAP", ")", ";", "compareOutput", "(", "apiBag", ",", "\"", "/", "cluster", "/", "configs", "/", "sample", "\"", ",", "DELETE", ",", "null", ",", "null", ",", "\"", "{", "name", ":", "sample", ",", "operation", ":", "delete", "}", "\")", ";", "compareOutput", "(", "apiBag", ",", "\"", "/", "cluster", "/", "configs", "\"", ",", "POST", ",", "\"", "{", "create", ":", "{", "name", ":", "newconf", ",", "baseConfigSet", ":", "sample", "}", "}\"", ",", "null", ",", "\"", "{", "operation", ":", "create", ",", "name", ":", "newconf", ",", "baseConfigSet", ":", "sample", ",", "immutable", ":", "false", "}", "\")", ";", "}", "}", "}", "@", "@", "-", "138", ",", "11", "+", "138", ",", "7", "@", "@", "private", "void", "copyConfigDirFromZk", "(", "String", "fromZkPath", ",", "String", "toZkPath", ",", "Set", "<", "String", ">", "for", "(", "String", "file", ":", "files", ")", "{", "List", "<", "String", ">", "children", "=", "zkClient", ".", "getChildren", "(", "fromZkPath", "+", "\"", "/\"", "+", "file", ",", "null", ",", "true", ")", ";", "if", "(", "children", ".", "size", "(", ")", "=", "=", "0", ")", "{", "final", "String", "toZkFilePath", "=", "toZkPath", "+", "\"", "/\"", "+", "file", ";", "log", ".", "info", "(", "\"", "Copying", "zk", "node", "{", "}/", "{}", "to", "{", "}\"", ",", "fromZkPath", ",", "file", ",", "toZkFilePath", ")", ";", "byte", "[", "]", "data", "=", "zkClient", ".", "getData", "(", "fromZkPath", "+", "\"", "/\"", "+", "file", ",", "null", ",", "null", ",", "true", ")", ";", "zkClient", ".", "makePath", "(", "toZkFilePath", ",", "data", ",", "true", ")", ";", "if", "(", "copiedToZkPaths", "!", "=", "null", ")", "copiedToZkPaths", ".", "add", "(", "toZkFilePath", ")", ";", "copyData", "(", "copiedToZkPaths", ",", "fromZkPath", "+", "\"", "/\"", "+", "file", ",", "toZkPath", "+", "\"", "/\"", "+", "file", ")", ";", "}", "else", "{", "copyConfigDirFromZk", "(", "fromZkPath", "+", "\"", "/\"", "+", "file", ",", "toZkPath", "+", "\"", "/\"", "+", "file", ",", "copiedToZkPaths", ")", ";", "}", "@", "@", "-", "153", ",", "6", "+", "149", ",", "13", "@", "@", "private", "void", "copyConfigDirFromZk", "(", "String", "fromZkPath", ",", "String", "toZkPath", ",", "Set", "<", "String", ">", "}", "}", "private", "void", "copyData", "(", "Set", "<", "String", ">", "copiedToZkPaths", ",", "String", "fromZkFilePath", ",", "String", "toZkFilePath", ")", "throws", "KeeperException", ",", "InterruptedException", "{", "log", ".", "info", "(", "\"", "Copying", "zk", "node", "{", "}", "to", "{", "}\"", ",", "fromZkFilePath", ",", "toZkFilePath", ")", ";", "byte", "[", "]", "data", "=", "zkClient", ".", "getData", "(", "fromZkFilePath", ",", "null", ",", "null", ",", "true", ")", ";", "zkClient", ".", "makePath", "(", "toZkFilePath", ",", "data", ",", "true", ")", ";", "if", "(", "copiedToZkPaths", "!", "=", "null", ")", "copiedToZkPaths", ".", "add", "(", "toZkFilePath", ")", ";", "}", "/", "**", "*", "Copy", "a", "config", "in", "ZooKeeper", "*", "@", "@", "-", "174", ",", "7", "+", "177", ",", "15", "@", "@", "public", "void", "copyConfigDir", "(", "String", "fromConfig", ",", "String", "toConfig", ")", "throws", "IOException", "*", "@", "throws", "IOException", "if", "an", "I", "/", "O", "error", "occurs", "*", "/", "public", "void", "copyConfigDir", "(", "String", "fromConfig", ",", "String", "toConfig", ",", "Set", "<", "String", ">", "copiedToZkPaths", ")", "throws", "IOException", "{", "copyConfigDirFromZk", "(", "CONFIGS_ZKNODE", "+", "\"", "/\"", "+", "fromConfig", ",", "CONFIGS_ZKNODE", "+", "\"", "/\"", "+", "toConfig", ",", "copiedToZkPaths", ")", ";", "String", "fromConfigPath", "=", "CONFIGS_ZKNODE", "+", "\"", "/\"", "+", "fromConfig", ";", "String", "toConfigPath", "=", "CONFIGS_ZKNODE", "+", "\"", "/\"", "+", "toConfig", ";", "try", "{", "copyData", "(", "copiedToZkPaths", ",", "fromConfigPath", ",", "toConfigPath", ")", ";", "}", "catch", "(", "KeeperException", "|", "InterruptedException", "e", ")", "{", "throw", "new", "IOException", "(", "\"", "Error", "config", "\"", "+", "fromConfig", "+", "\"", "to", "\"", "+", "toConfig", ",", "SolrZkClient", ".", "checkInterrupted", "(", "e", ")", ");", "}", "copyConfigDirFromZk", "(", "fromConfigPath", ",", "toConfigPath", ",", "copiedToZkPaths", ")", ";", "}", "/", "/", "This", "method", "is", "used", "by", "configSetUploadTool", "and", "CreateTool", "to", "resolve", "the", "configset", "directory", "."], "docstring_tokens": ["improper", "access", "control"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "122", ",", "6", "+", "122", ",", "12", "@", "@", "*", "org", ".", "apache", ".", "camel", ".", "xstream", ".", "permissions", ".", "*", "/", "private", "String", "permissions", ";", "/", "**", "*", "If", "enabled", "then", "Jackson", "is", "allowed", "to", "attempt", "to", "use", "the", "*", "CamelJacksonUnmarshalType", "header", "during", "the", "unmarshalling", ".", "This", "should", "*", "only", "be", "enabled", "when", "desired", "to", "be", "used", ".", "*", "/", "private", "Boolean", "allowUnmarshallType", "=", "false", ";", "public", "String", "getObjectMapper", "(", ")", "{", "return", "objectMapper", ";", "@", "@", "-", "242", ",", "4", "+", "248", ",", "12", "@", "@", "public", "String", "getPermissions", "(", ")", "{", "public", "void", "setPermissions", "(", "String", "permissions", ")", "{", "this", ".", "permissions", "=", "permissions", ";", "}", "public", "Boolean", "getAllowUnmarshallType", "(", ")", "{", "return", "allowUnmarshallType", ";", "}", "public", "void", "setAllowUnmarshallType", "(", "Boolean", "allowUnmarshallType", ")", "{", "this", ".", "allowUnmarshallType", "=", "allowUnmarshallType", ";", "}", "}", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "122", ",", "6", "+", "122", ",", "12", "@", "@", "*", "org", ".", "apache", ".", "camel", ".", "xstream", ".", "permissions", ".", "*", "/", "private", "String", "permissions", ";", "/", "**", "*", "If", "enabled", "then", "Jackson", "is", "allowed", "to", "attempt", "to", "use", "the", "*", "CamelJacksonUnmarshalType", "header", "during", "the", "unmarshalling", ".", "This", "should", "*", "only", "be", "enabled", "when", "desired", "to", "be", "used", ".", "*", "/", "private", "Boolean", "allowUnmarshallType", "=", "false", ";", "public", "String", "getObjectMapper", "(", ")", "{", "return", "objectMapper", ";", "@", "@", "-", "242", ",", "4", "+", "248", ",", "12", "@", "@", "public", "String", "getPermissions", "(", ")", "{", "public", "void", "setPermissions", "(", "String", "permissions", ")", "{", "this", ".", "permissions", "=", "permissions", ";", "}", "public", "Boolean", "getAllowUnmarshallType", "(", ")", "{", "return", "allowUnmarshallType", ";", "}", "public", "void", "setAllowUnmarshallType", "(", "Boolean", "allowUnmarshallType", ")", "{", "this", ".", "allowUnmarshallType", "=", "allowUnmarshallType", ";", "}", "}", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "122", ",", "6", "+", "122", ",", "12", "@", "@", "*", "org", ".", "apache", ".", "camel", ".", "xstream", ".", "permissions", ".", "*", "/", "private", "String", "permissions", ";", "/", "**", "*", "If", "enabled", "then", "Jackson", "is", "allowed", "to", "attempt", "to", "use", "the", "*", "CamelJacksonUnmarshalType", "header", "during", "the", "unmarshalling", ".", "This", "should", "*", "only", "be", "enabled", "when", "desired", "to", "be", "used", ".", "*", "/", "private", "Boolean", "allowUnmarshallType", "=", "false", ";", "public", "String", "getObjectMapper", "(", ")", "{", "return", "objectMapper", ";", "@", "@", "-", "242", ",", "4", "+", "248", ",", "12", "@", "@", "public", "String", "getPermissions", "(", ")", "{", "public", "void", "setPermissions", "(", "String", "permissions", ")", "{", "this", ".", "permissions", "=", "permissions", ";", "}", "public", "Boolean", "getAllowUnmarshallType", "(", ")", "{", "return", "allowUnmarshallType", ";", "}", "public", "void", "setAllowUnmarshallType", "(", "Boolean", "allowUnmarshallType", ")", "{", "this", ".", "allowUnmarshallType", "=", "allowUnmarshallType", ";", "}", "}", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "122", ",", "6", "+", "122", ",", "12", "@", "@", "*", "org", ".", "apache", ".", "camel", ".", "xstream", ".", "permissions", ".", "*", "/", "private", "String", "permissions", ";", "/", "**", "*", "If", "enabled", "then", "Jackson", "is", "allowed", "to", "attempt", "to", "use", "the", "*", "CamelJacksonUnmarshalType", "header", "during", "the", "unmarshalling", ".", "This", "should", "*", "only", "be", "enabled", "when", "desired", "to", "be", "used", ".", "*", "/", "private", "Boolean", "allowUnmarshallType", "=", "false", ";", "public", "String", "getObjectMapper", "(", ")", "{", "return", "objectMapper", ";", "@", "@", "-", "242", ",", "4", "+", "248", ",", "12", "@", "@", "public", "String", "getPermissions", "(", ")", "{", "public", "void", "setPermissions", "(", "String", "permissions", ")", "{", "this", ".", "permissions", "=", "permissions", ";", "}", "public", "Boolean", "getAllowUnmarshallType", "(", ")", "{", "return", "allowUnmarshallType", ";", "}", "public", "void", "setAllowUnmarshallType", "(", "Boolean", "allowUnmarshallType", ")", "{", "this", ".", "allowUnmarshallType", "=", "allowUnmarshallType", ";", "}", "}", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "20", ",", "7", "+", "20", ",", "7", "@", "@", "Gson", "Options", "/", "/", "dataformat", "options", ":", "START", "The", "JSon", "GSon", "dataformat", "supports", "15", "options", "which", "are", "listed", "below", ".", "The", "JSon", "GSon", "dataformat", "supports", "16", "options", "which", "are", "listed", "below", ".", "@", "@", "-", "43", ",", "6", "+", "43", ",", "7", "@", "@", "The", "JSon", "GSon", "dataformat", "supports", "15", "options", "which", "are", "listed", "below", ".", "|", "enableFeatures", "|", "|", "String", "|", "Set", "of", "features", "to", "enable", "on", "the", "Jackson", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "ObjectMapper", ".", "The", "features", "should", "be", "a", "name", "that", "matches", "a", "enum", "from", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "SerializationFeature", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "DeserializationFeature", "or", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "MapperFeature", "Multiple", "features", "can", "be", "separated", "by", "comma", "|", "disableFeatures", "|", "|", "String", "|", "Set", "of", "features", "to", "disable", "on", "the", "Jackson", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "ObjectMapper", ".", "The", "features", "should", "be", "a", "name", "that", "matches", "a", "enum", "from", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "SerializationFeature", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "DeserializationFeature", "or", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "MapperFeature", "Multiple", "features", "can", "be", "separated", "by", "comma", "|", "permissions", "|", "|", "String", "|", "Adds", "permissions", "that", "controls", "which", "Java", "packages", "and", "classes", "XStream", "is", "allowed", "to", "use", "during", "unmarshal", "from", "xml", "/", "json", "to", "Java", "beans", ".", "A", "permission", "must", "be", "configured", "either", "here", "or", "globally", "using", "a", "JVM", "system", "property", ".", "The", "permission", "can", "be", "specified", "in", "a", "syntax", "where", "a", "plus", "sign", "is", "allow", "and", "minus", "sign", "is", "deny", ".", "Wildcards", "is", "supported", "by", "using", ".", "as", "prefix", ".", "For", "example", "to", "allow", "com", ".", "foo", "and", "all", "subpackages", "then", "specfy", "com", ".", "foo", ".", ".", "Multiple", "permissions", "can", "be", "configured", "separated", "by", "comma", "such", "as", "com", ".", "foo", ".", "-", "com", ".", "foo", ".", "bar", ".", "MySecretBean", ".", "The", "following", "default", "permission", "is", "always", "included", ":", "-", "java", ".", "lang", ".", "java", ".", "util", ".", "unless", "its", "overridden", "by", "specifying", "a", "JVM", "system", "property", "with", "they", "key", "org", ".", "apache", ".", "camel", ".", "xstream", ".", "permissions", ".", "|", "allowUnmarshallType", "|", "false", "|", "Boolean", "|", "If", "enabled", "then", "Jackson", "is", "allowed", "to", "attempt", "to", "use", "the", "CamelJacksonUnmarshalType", "header", "during", "the", "unmarshalling", ".", "This", "should", "only", "be", "enabled", "when", "desired", "to", "be", "used", ".", "|", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "{", "%", "endraw", "%", "}", "/", "/", "dataformat", "options", ":", "END", "@", "@", "-", "21", ",", "7", "+", "21", ",", "7", "@", "@", "Jackson", "Options", "/", "/", "dataformat", "options", ":", "START", "The", "JSon", "Jackson", "dataformat", "supports", "15", "options", "which", "are", "listed", "below", ".", "The", "JSon", "Jackson", "dataformat", "supports", "16", "options", "which", "are", "listed", "below", ".", "@", "@", "-", "44", ",", "6", "+", "44", ",", "7", "@", "@", "The", "JSon", "Jackson", "dataformat", "supports", "15", "options", "which", "are", "listed", "below", ".", "|", "enableFeatures", "|", "|", "String", "|", "Set", "of", "features", "to", "enable", "on", "the", "Jackson", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "ObjectMapper", ".", "The", "features", "should", "be", "a", "name", "that", "matches", "a", "enum", "from", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "SerializationFeature", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "DeserializationFeature", "or", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "MapperFeature", "Multiple", "features", "can", "be", "separated", "by", "comma", "|", "disableFeatures", "|", "|", "String", "|", "Set", "of", "features", "to", "disable", "on", "the", "Jackson", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "ObjectMapper", ".", "The", "features", "should", "be", "a", "name", "that", "matches", "a", "enum", "from", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "SerializationFeature", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "DeserializationFeature", "or", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "MapperFeature", "Multiple", "features", "can", "be", "separated", "by", "comma", "|", "permissions", "|", "|", "String", "|", "Adds", "permissions", "that", "controls", "which", "Java", "packages", "and", "classes", "XStream", "is", "allowed", "to", "use", "during", "unmarshal", "from", "xml", "/", "json", "to", "Java", "beans", ".", "A", "permission", "must", "be", "configured", "either", "here", "or", "globally", "using", "a", "JVM", "system", "property", ".", "The", "permission", "can", "be", "specified", "in", "a", "syntax", "where", "a", "plus", "sign", "is", "allow", "and", "minus", "sign", "is", "deny", ".", "Wildcards", "is", "supported", "by", "using", ".", "as", "prefix", ".", "For", "example", "to", "allow", "com", ".", "foo", "and", "all", "subpackages", "then", "specfy", "com", ".", "foo", ".", ".", "Multiple", "permissions", "can", "be", "configured", "separated", "by", "comma", "such", "as", "com", ".", "foo", ".", "-", "com", ".", "foo", ".", "bar", ".", "MySecretBean", ".", "The", "following", "default", "permission", "is", "always", "included", ":", "-", "java", ".", "lang", ".", "java", ".", "util", ".", "unless", "its", "overridden", "by", "specifying", "a", "JVM", "system", "property", "with", "they", "key", "org", ".", "apache", ".", "camel", ".", "xstream", ".", "permissions", ".", "|", "allowUnmarshallType", "|", "false", "|", "Boolean", "|", "If", "enabled", "then", "Jackson", "is", "allowed", "to", "attempt", "to", "use", "the", "CamelJacksonUnmarshalType", "header", "during", "the", "unmarshalling", ".", "This", "should", "only", "be", "enabled", "when", "desired", "to", "be", "used", ".", "|", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "{", "%", "endraw", "%", "}", "/", "/", "dataformat", "options", ":", "END", "@", "@", "-", "21", ",", "7", "+", "21", ",", "7", "@", "@", "Johnzon", "Options", "/", "/", "dataformat", "options", ":", "START", "The", "JSon", "Johnzon", "dataformat", "supports", "15", "options", "which", "are", "listed", "below", ".", "The", "JSon", "Johnzon", "dataformat", "supports", "16", "options", "which", "are", "listed", "below", ".", "@", "@", "-", "44", ",", "6", "+", "44", ",", "7", "@", "@", "The", "JSon", "Johnzon", "dataformat", "supports", "15", "options", "which", "are", "listed", "below", ".", "|", "enableFeatures", "|", "|", "String", "|", "Set", "of", "features", "to", "enable", "on", "the", "Jackson", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "ObjectMapper", ".", "The", "features", "should", "be", "a", "name", "that", "matches", "a", "enum", "from", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "SerializationFeature", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "DeserializationFeature", "or", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "MapperFeature", "Multiple", "features", "can", "be", "separated", "by", "comma", "|", "disableFeatures", "|", "|", "String", "|", "Set", "of", "features", "to", "disable", "on", "the", "Jackson", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "ObjectMapper", ".", "The", "features", "should", "be", "a", "name", "that", "matches", "a", "enum", "from", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "SerializationFeature", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "DeserializationFeature", "or", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "MapperFeature", "Multiple", "features", "can", "be", "separated", "by", "comma", "|", "permissions", "|", "|", "String", "|", "Adds", "permissions", "that", "controls", "which", "Java", "packages", "and", "classes", "XStream", "is", "allowed", "to", "use", "during", "unmarshal", "from", "xml", "/", "json", "to", "Java", "beans", ".", "A", "permission", "must", "be", "configured", "either", "here", "or", "globally", "using", "a", "JVM", "system", "property", ".", "The", "permission", "can", "be", "specified", "in", "a", "syntax", "where", "a", "plus", "sign", "is", "allow", "and", "minus", "sign", "is", "deny", ".", "Wildcards", "is", "supported", "by", "using", ".", "as", "prefix", ".", "For", "example", "to", "allow", "com", ".", "foo", "and", "all", "subpackages", "then", "specfy", "com", ".", "foo", ".", ".", "Multiple", "permissions", "can", "be", "configured", "separated", "by", "comma", "such", "as", "com", ".", "foo", ".", "-", "com", ".", "foo", ".", "bar", ".", "MySecretBean", ".", "The", "following", "default", "permission", "is", "always", "included", ":", "-", "java", ".", "lang", ".", "java", ".", "util", ".", "unless", "its", "overridden", "by", "specifying", "a", "JVM", "system", "property", "with", "they", "key", "org", ".", "apache", ".", "camel", ".", "xstream", ".", "permissions", ".", "|", "allowUnmarshallType", "|", "false", "|", "Boolean", "|", "If", "enabled", "then", "Jackson", "is", "allowed", "to", "attempt", "to", "use", "the", "CamelJacksonUnmarshalType", "header", "during", "the", "unmarshalling", ".", "This", "should", "only", "be", "enabled", "when", "desired", "to", "be", "used", ".", "|", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "{", "%", "endraw", "%", "}", "/", "/", "dataformat", "options", ":", "END", "@", "@", "-", "27", ",", "7", "+", "27", ",", "7", "@", "@", "Options", "^", "^^", "^^", "^^", "/", "/", "dataformat", "options", ":", "START", "The", "JSon", "XStream", "dataformat", "supports", "15", "options", "which", "are", "listed", "below", ".", "The", "JSon", "XStream", "dataformat", "supports", "16", "options", "which", "are", "listed", "below", ".", "@", "@", "-", "50", ",", "6", "+", "50", ",", "7", "@", "@", "The", "JSon", "XStream", "dataformat", "supports", "15", "options", "which", "are", "listed", "below", ".", "|", "enableFeatures", "|", "|", "String", "|", "Set", "of", "features", "to", "enable", "on", "the", "Jackson", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "ObjectMapper", ".", "The", "features", "should", "be", "a", "name", "that", "matches", "a", "enum", "from", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "SerializationFeature", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "DeserializationFeature", "or", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "MapperFeature", "Multiple", "features", "can", "be", "separated", "by", "comma", "|", "disableFeatures", "|", "|", "String", "|", "Set", "of", "features", "to", "disable", "on", "the", "Jackson", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "ObjectMapper", ".", "The", "features", "should", "be", "a", "name", "that", "matches", "a", "enum", "from", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "SerializationFeature", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "DeserializationFeature", "or", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "MapperFeature", "Multiple", "features", "can", "be", "separated", "by", "comma", "|", "permissions", "|", "|", "String", "|", "Adds", "permissions", "that", "controls", "which", "Java", "packages", "and", "classes", "XStream", "is", "allowed", "to", "use", "during", "unmarshal", "from", "xml", "/", "json", "to", "Java", "beans", ".", "A", "permission", "must", "be", "configured", "either", "here", "or", "globally", "using", "a", "JVM", "system", "property", ".", "The", "permission", "can", "be", "specified", "in", "a", "syntax", "where", "a", "plus", "sign", "is", "allow", "and", "minus", "sign", "is", "deny", ".", "Wildcards", "is", "supported", "by", "using", ".", "as", "prefix", ".", "For", "example", "to", "allow", "com", ".", "foo", "and", "all", "subpackages", "then", "specfy", "com", ".", "foo", ".", ".", "Multiple", "permissions", "can", "be", "configured", "separated", "by", "comma", "such", "as", "com", ".", "foo", ".", "-", "com", ".", "foo", ".", "bar", ".", "MySecretBean", ".", "The", "following", "default", "permission", "is", "always", "included", ":", "-", "java", ".", "lang", ".", "java", ".", "util", ".", "unless", "its", "overridden", "by", "specifying", "a", "JVM", "system", "property", "with", "they", "key", "org", ".", "apache", ".", "camel", ".", "xstream", ".", "permissions", ".", "|", "allowUnmarshallType", "|", "false", "|", "Boolean", "|", "If", "enabled", "then", "Jackson", "is", "allowed", "to", "attempt", "to", "use", "the", "CamelJacksonUnmarshalType", "header", "during", "the", "unmarshalling", ".", "This", "should", "only", "be", "enabled", "when", "desired", "to", "be", "used", ".", "|", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "==", "=", "{", "%", "endraw", "%", "}", "/", "/", "dataformat", "options", ":", "END"], "docstring_tokens": ["Insufficiently", "restricting", "the", "types", "that", "can", "be", "used", "there", "however", "means", "that", "an", "attacker", "can", "trigger", "these", "behaviors", "on", "more", "or", "less", "arbitrary", "types", "on", "the", "classpath"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1108", ",", "7", "+", "1108", ",", "7", "@", "@", "public", "String", "getWhyKeepLog", "(", ")", "{", "AbstractBuild", "<", "?,", "?>", "b", "=", "p", ".", "getBuildByNumber", "(", "i", ")", ";", "if", "(", "b", "!", "=", "null", ")", "return", "Messages", ".", "AbstractBuild_KeptBecause", "(", "b", ")", ";", "return", "Messages", ".", "AbstractBuild_KeptBecause", "(", "p", ".", "hasPermission", "(", "Item", ".", "READ", ")", "?", "b", ".", "toString", "(", ")", ":", "\"", "?\"", ");", "}", "}", "@", "@", "-", "1645", ",", "16", "+", "1645", ",", "38", "@", "@", "void", "removeFromList", "(", "Descriptor", "<", "T", ">", "item", ",", "List", "<", "T", ">", "collection", ")", "throws", "IOException", "{", "*", "Gets", "the", "other", "{", "@", "link", "AbstractProject", "}", "s", "that", "should", "be", "built", "*", "when", "a", "build", "of", "this", "project", "is", "completed", ".", "*", "/", "@", "Exported", "public", "final", "List", "<", "AbstractProject", ">", "getDownstreamProjects", "(", ")", "{", "return", "Jenkins", ".", "getInstance", "(", ").", "getDependencyGraph", "(", ").", "getDownstream", "(", "this", ")", ";", "}", "@", "Exported", "@", "Exported", "(", "name", "=", "\"", "downstreamProjects", "\"", ")", "@", "Restricted", "(", "DoNotUse", ".", "class", ")", "/", "/", "only", "for", "exporting", "public", "List", "<", "AbstractProject", ">", "getDownstreamProjectsForApi", "(", ")", "{", "List", "<", "AbstractProject", ">", "r", "=", "new", "ArrayList", "<", ">(", ");", "for", "(", "AbstractProject", "p", ":", "getDownstreamProjects", "(", "))", "{", "if", "(", "p", ".", "hasPermission", "(", "Item", ".", "READ", ")", ")", "{", "r", ".", "add", "(", "p", ")", ";", "}", "}", "return", "r", ";", "}", "public", "final", "List", "<", "AbstractProject", ">", "getUpstreamProjects", "(", ")", "{", "return", "Jenkins", ".", "getInstance", "(", ").", "getDependencyGraph", "(", ").", "getUpstream", "(", "this", ")", ";", "}", "@", "Exported", "(", "name", "=", "\"", "upstreamProjects", "\"", ")", "@", "Restricted", "(", "DoNotUse", ".", "class", ")", "/", "/", "only", "for", "exporting", "public", "List", "<", "AbstractProject", ">", "getUpstreamProjectsForApi", "(", ")", "{", "List", "<", "AbstractProject", ">", "r", "=", "new", "ArrayList", "<", ">(", ");", "for", "(", "AbstractProject", "p", ":", "getUpstreamProjects", "(", "))", "{", "if", "(", "p", ".", "hasPermission", "(", "Item", ".", "READ", ")", ")", "{", "r", ".", "add", "(", "p", ")", ";", "}", "}", "return", "r", ";", "}", "/", "**", "*", "Returns", "only", "those", "upstream", "projects", "that", "defines", "{", "@", "link", "BuildTrigger", "}", "to", "this", "project", ".", "*", "This", "is", "a", "subset", "of", "{", "@", "link", "#", "getUpstreamProjects", "(", ")}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "73", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "2017", "CloudBees", ",", "Inc", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "hudson", ".", "model", ";", "import", "hudson", ".", "tasks", ".", "BuildTrigger", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "*;", "import", "org", ".", "junit", ".", "Test", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*;", "import", "org", ".", "junit", ".", "Rule", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "Issue", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "JenkinsRule", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "MockAuthorizationStrategy", ";", "/", "/", "TODO", "merge", "with", "AbstractProjectTest", "when", "converted", "from", "Groovy", "to", "Java", "public", "class", "AbstractProject2Test", "{", "@", "Rule", "public", "JenkinsRule", "r", "=", "new", "JenkinsRule", "(", ");", "@", "Issue", "(", "\"", "SECURITY", "-", "617", "\"", ")", "@", "Test", "public", "void", "upstreamDownstreamExportApi", "(", ")", "throws", "Exception", "{", "FreeStyleProject", "us", "=", "r", ".", "createFreeStyleProject", "(", "\"", "upstream", "-", "project", "\"", ");", "FreeStyleProject", "ds", "=", "r", ".", "createFreeStyleProject", "(", "\"", "downstream", "-", "project", "\"", ");", "us", ".", "getPublishersList", "(", ").", "add", "(", "new", "BuildTrigger", "(", "Collections", ".", "singleton", "(", "ds", ")", ",", "Result", ".", "SUCCESS", ")", ");", "r", ".", "jenkins", ".", "rebuildDependencyGraph", "(", ");", "assertEquals", "(", "Collections", ".", "singletonList", "(", "ds", ")", ",", "us", ".", "getDownstreamProjects", "(", "))", ";", "assertEquals", "(", "Collections", ".", "singletonList", "(", "us", ")", ",", "ds", ".", "getUpstreamProjects", "(", "))", ";", "r", ".", "jenkins", ".", "setSecurityRealm", "(", "r", ".", "createDummySecurityRealm", "(", "))", ";", "r", ".", "jenkins", ".", "setAuthorizationStrategy", "(", "new", "MockAuthorizationStrategy", "(", ").", "grant", "(", "Jenkins", ".", "READ", ")", ".", "everywhere", "(", ").", "toEveryone", "(", ").", "grant", "(", "Item", ".", "READ", ")", ".", "everywhere", "(", ").", "to", "(", "\"", "alice", "\"", ").", "grant", "(", "Item", ".", "READ", ")", ".", "onItems", "(", "us", ")", ".", "to", "(", "\"", "bob", "\"", ").", "grant", "(", "Item", ".", "READ", ")", ".", "onItems", "(", "ds", ")", ".", "to", "(", "\"", "charlie", "\"", "))", ";", "String", "api", "=", "r", ".", "createWebClient", "(", ").", "login", "(", "\"", "alice", "\"", ").", "goTo", "(", "us", ".", "getUrl", "(", ")", "+", "\"", "api", "/", "json", "?", "pretty", "\"", ",", "null", ")", ".", "getWebResponse", "(", ").", "getContentAsString", "(", ");", "System", ".", "out", ".", "println", "(", "api", ")", ";", "assertThat", "(", "api", ",", "containsString", "(", "\"", "downstream", "-", "project", "\"", "))", ";", "api", "=", "r", ".", "createWebClient", "(", ").", "login", "(", "\"", "alice", "\"", ").", "goTo", "(", "ds", ".", "getUrl", "(", ")", "+", "\"", "api", "/", "json", "?", "pretty", "\"", ",", "null", ")", ".", "getWebResponse", "(", ").", "getContentAsString", "(", ");", "System", ".", "out", ".", "println", "(", "api", ")", ";", "assertThat", "(", "api", ",", "containsString", "(", "\"", "upstream", "-", "project", "\"", "))", ";", "api", "=", "r", ".", "createWebClient", "(", ").", "login", "(", "\"", "bob", "\"", ").", "goTo", "(", "us", ".", "getUrl", "(", ")", "+", "\"", "api", "/", "json", "?", "pretty", "\"", ",", "null", ")", ".", "getWebResponse", "(", ").", "getContentAsString", "(", ");", "System", ".", "out", ".", "println", "(", "api", ")", ";", "assertThat", "(", "api", ",", "not", "(", "containsString", "(", "\"", "downstream", "-", "project", "\"", "))", ");", "api", "=", "r", ".", "createWebClient", "(", ").", "login", "(", "\"", "charlie", "\"", ").", "goTo", "(", "ds", ".", "getUrl", "(", ")", "+", "\"", "api", "/", "json", "?", "pretty", "\"", ",", "null", ")", ".", "getWebResponse", "(", ").", "getContentAsString", "(", ");", "System", ".", "out", ".", "println", "(", "api", ")", ";", "assertThat", "(", "api", ",", "not", "(", "containsString", "(", "\"", "upstream", "-", "project", "\"", "))", ");", "}", "}"], "docstring_tokens": ["run", "arbitrary", "shell", "commands", "on", "the", "master", "node"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1", ",", "5", "+", "1", ",", "5", "@", "@", "/", "*", "*", "Copyright", "2002", "-", "2011", "the", "original", "author", "or", "authors", ".", "*", "Copyright", "2002", "-", "2013", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "@", "@", "-", "17", ",", "73", "+", "17", ",", "144", "@", "@", "package", "org", ".", "springframework", ".", "http", ".", "converter", ".", "xml", ";", "import", "java", ".", "io", ".", "ByteArrayInputStream", ";", "import", "java", ".", "io", ".", "ByteArrayOutputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "io", ".", "OutputStream", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "javax", ".", "xml", ".", "stream", ".", "XMLInputFactory", ";", "import", "javax", ".", "xml", ".", "stream", ".", "XMLStreamException", ";", "import", "javax", ".", "xml", ".", "stream", ".", "XMLStreamReader", ";", "import", "javax", ".", "xml", ".", "transform", ".", "Result", ";", "import", "javax", ".", "xml", ".", "transform", ".", "Source", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerException", ";", "import", "javax", ".", "xml", ".", "transform", ".", "dom", ".", "DOMResult", ";", "import", "javax", ".", "xml", ".", "transform", ".", "TransformerFactory", ";", "import", "javax", ".", "xml", ".", "transform", ".", "dom", ".", "DOMSource", ";", "import", "javax", ".", "xml", ".", "transform", ".", "sax", ".", "SAXSource", ";", "import", "javax", ".", "xml", ".", "transform", ".", "stax", ".", "StAXSource", ";", "import", "javax", ".", "xml", ".", "transform", ".", "stream", ".", "StreamResult", ";", "import", "javax", ".", "xml", ".", "transform", ".", "stream", ".", "StreamSource", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "import", "org", ".", "xml", ".", "sax", ".", "InputSource", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "org", ".", "xml", ".", "sax", ".", "XMLReader", ";", "import", "org", ".", "xml", ".", "sax", ".", "helpers", ".", "XMLReaderFactory", ";", "import", "org", ".", "springframework", ".", "http", ".", "HttpHeaders", ";", "import", "org", ".", "springframework", ".", "http", ".", "HttpInputMessage", ";", "import", "org", ".", "springframework", ".", "http", ".", "HttpOutputMessage", ";", "import", "org", ".", "springframework", ".", "http", ".", "MediaType", ";", "import", "org", ".", "springframework", ".", "http", ".", "converter", ".", "AbstractHttpMessageConverter", ";", "import", "org", ".", "springframework", ".", "http", ".", "converter", ".", "HttpMessageConversionException", ";", "import", "org", ".", "springframework", ".", "http", ".", "converter", ".", "HttpMessageNotReadableException", ";", "import", "org", ".", "springframework", ".", "http", ".", "converter", ".", "HttpMessageNotWritableException", ";", "import", "org", ".", "springframework", ".", "util", ".", "StreamUtils", ";", "/", "**", "*", "Implementation", "of", "{", "@", "link", "org", ".", "springframework", ".", "http", ".", "converter", ".", "HttpMessageConverter", "}", "that", "can", "read", "and", "write", "{", "@", "link", "*", "Source", "}", "objects", ".", "*", "Implementation", "of", "{", "@", "link", "org", ".", "springframework", ".", "http", ".", "converter", ".", "HttpMessageConverter", "}", "*", "that", "can", "read", "and", "write", "{", "@", "link", "Source", "}", "objects", ".", "*", "*", "@", "author", "Arjen", "Poutsma", "*", "@", "since", "3", ".", "0", "*", "/", "public", "class", "SourceHttpMessageConverter", "<", "T", "extends", "Source", ">", "extends", "AbstractXmlHttpMessageConverter", "<", "T", ">", "{", "public", "class", "SourceHttpMessageConverter", "<", "T", "extends", "Source", ">", "extends", "AbstractHttpMessageConverter", "<", "T", ">", "{", "private", "final", "TransformerFactory", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "private", "boolean", "processExternalEntities", "=", "false", ";", "/", "**", "*", "Sets", "the", "{", "@", "link", "#", "setSupportedMediaTypes", "(", "java", ".", "util", ".", "List", ")", "supportedMediaTypes", "}", "*", "to", "{", "@", "code", "text", "/", "xml", "}", "and", "{", "@", "code", "application", "/", "xml", "}", ",", "and", "{", "@", "code", "application", "/", "*-", "xml", "}", ".", "*", "/", "public", "SourceHttpMessageConverter", "(", ")", "{", "super", "(", "MediaType", ".", "APPLICATION_XML", ",", "MediaType", ".", "TEXT_XML", ",", "new", "MediaType", "(", "\"", "application", "\"", ",", "\"", "*+", "xml", "\"", "))", ";", "}", "/", "**", "*", "Indicates", "whether", "external", "XML", "entities", "are", "processed", "when", "converting", "*", "to", "a", "Source", ".", "*", "<", "p", ">", "Default", "is", "{", "@", "code", "false", "}", ",", "meaning", "that", "external", "entities", "are", "not", "resolved", ".", "*", "/", "public", "void", "setProcessExternalEntities", "(", "boolean", "processExternalEntities", ")", "{", "this", ".", "processExternalEntities", "=", "processExternalEntities", ";", "}", "@", "Override", "public", "boolean", "supports", "(", "Class", "<", "?>", "clazz", ")", "{", "return", "DOMSource", ".", "class", ".", "equals", "(", "clazz", ")", "|", "|", "SAXSource", ".", "class", ".", "equals", "(", "clazz", ")", "|", "|", "StreamSource", ".", "class", ".", "equals", "(", "clazz", ")", "|", "|", "Source", ".", "class", ".", "equals", "(", "clazz", ")", ";", "return", "DOMSource", ".", "class", ".", "equals", "(", "clazz", ")", "|", "|", "SAXSource", ".", "class", ".", "equals", "(", "clazz", ")", "|", "|", "StreamSource", ".", "class", ".", "equals", "(", "clazz", ")", "|", "|", "Source", ".", "class", ".", "equals", "(", "clazz", ")", ";", "}", "@", "Override", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "protected", "T", "readFromSource", "(", "Class", "clazz", ",", "HttpHeaders", "headers", ",", "Source", "source", ")", "throws", "IOException", "{", "protected", "T", "readInternal", "(", "Class", "<", "?", "extends", "T", ">", "clazz", ",", "HttpInputMessage", "inputMessage", ")", "throws", "IOException", ",", "HttpMessageNotReadableException", "{", "InputStream", "body", "=", "inputMessage", ".", "getBody", "(", ");", "if", "(", "DOMSource", ".", "class", ".", "equals", "(", "clazz", ")", ")", "{", "return", "(", "T", ")", "readDOMSource", "(", "body", ")", ";", "}", "else", "if", "(", "SAXSource", ".", "class", ".", "equals", "(", "clazz", ")", ")", "{", "return", "(", "T", ")", "readSAXSource", "(", "body", ")", ";", "}", "else", "if", "(", "StAXSource", ".", "class", ".", "equals", "(", "clazz", ")", ")", "{", "return", "(", "T", ")", "readStAXSource", "(", "body", ")", ";", "}", "else", "if", "(", "StreamSource", ".", "class", ".", "equals", "(", "clazz", ")", "|", "|", "Source", ".", "class", ".", "equals", "(", "clazz", ")", ")", "{", "return", "(", "T", ")", "readStreamSource", "(", "body", ")", ";", "}", "else", "{", "throw", "new", "HttpMessageConversionException", "(", "\"", "Could", "not", "read", "class", "[", "\"", "+", "clazz", "\"", "].", "Only", "DOMSource", ",", "SAXSource", ",", "and", "StreamSource", "are", "supported", ".", "\")", ";", "}", "}", "private", "DOMSource", "readDOMSource", "(", "InputStream", "body", ")", "throws", "IOException", "{", "try", "{", "if", "(", "DOMSource", ".", "class", ".", "equals", "(", "clazz", ")", ")", "{", "DOMResult", "domResult", "=", "new", "DOMResult", "(", ");", "transform", "(", "source", ",", "domResult", ")", ";", "return", "(", "T", ")", "new", "DOMSource", "(", "domResult", ".", "getNode", "(", "))", ";", "}", "else", "if", "(", "SAXSource", ".", "class", ".", "equals", "(", "clazz", ")", ")", "{", "ByteArrayInputStream", "bis", "=", "transformToByteArrayInputStream", "(", "source", ")", ";", "return", "(", "T", ")", "new", "SAXSource", "(", "new", "InputSource", "(", "bis", ")", ");", "}", "else", "if", "(", "StreamSource", ".", "class", ".", "equals", "(", "clazz", ")", "|", "|", "Source", ".", "class", ".", "equals", "(", "clazz", ")", ")", "{", "ByteArrayInputStream", "bis", "=", "transformToByteArrayInputStream", "(", "source", ")", ";", "return", "(", "T", ")", "new", "StreamSource", "(", "bis", ")", ";", "}", "else", "{", "throw", "new", "HttpMessageConversionException", "(", "\"", "Could", "not", "read", "class", "[", "\"", "+", "clazz", "+", "\"", "].", "Only", "DOMSource", ",", "SAXSource", ",", "and", "StreamSource", "are", "supported", ".", "\")", ";", "}", "DocumentBuilderFactory", "documentBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "documentBuilderFactory", ".", "setNamespaceAware", "(", "true", ")", ";", "documentBuilderFactory", ".", "setFeature", "(", "\"", "http", ":", "//", "xml", ".", "org", "/", "sax", "/", "features", "/", "external", "-", "general", "-", "entities", "\"", ",", "processExternalEntities", ")", ";", "DocumentBuilder", "documentBuilder", "=", "documentBuilderFactory", ".", "newDocumentBuilder", "(", ");", "Document", "document", "=", "documentBuilder", ".", "parse", "(", "body", ")", ";", "return", "new", "DOMSource", "(", "document", ")", ";", "}", "catch", "(", "TransformerException", "ex", ")", "{", "throw", "new", "HttpMessageNotReadableException", "(", "\"", "Could", "not", "transform", "from", "[", "\"", "+", "source", "+", "\"", "]", "to", "[", "\"", "+", "clazz", "+", "\"", "]\"", ",", "ex", ")", ";", "catch", "(", "ParserConfigurationException", "ex", ")", "{", "throw", "new", "HttpMessageNotReadableException", "(", "\"", "Could", "not", "set", "feature", ":", "\"", "+", "ex", ".", "getMessage", "(", "),", "ex", ")", ";", "}", "catch", "(", "SAXException", "ex", ")", "{", "throw", "new", "HttpMessageNotReadableException", "(", "\"", "Could", "not", "parse", "document", ":", "\"", "+", "ex", ".", "getMessage", "(", "),", "ex", ")", ";", "}", "}", "private", "ByteArrayInputStream", "transformToByteArrayInputStream", "(", "Source", "source", ")", "throws", "TransformerException", "{", "ByteArrayOutputStream", "bos", "=", "new", "ByteArrayOutputStream", "(", ");", "transform", "(", "source", ",", "new", "StreamResult", "(", "bos", ")", ");", "return", "new", "ByteArrayInputStream", "(", "bos", ".", "toByteArray", "(", "))", ";", "private", "SAXSource", "readSAXSource", "(", "InputStream", "body", ")", "throws", "IOException", "{", "try", "{", "XMLReader", "reader", "=", "XMLReaderFactory", ".", "createXMLReader", "(", ");", "reader", ".", "setFeature", "(", "\"", "http", ":", "//", "xml", ".", "org", "/", "sax", "/", "features", "/", "external", "-", "general", "-", "entities", "\"", ",", "processExternalEntities", ")", ";", "byte", "[", "]", "bytes", "=", "StreamUtils", ".", "copyToByteArray", "(", "body", ")", ";", "return", "new", "SAXSource", "(", "reader", ",", "new", "InputSource", "(", "new", "ByteArrayInputStream", "(", "bytes", ")", "))", ";", "}", "catch", "(", "SAXException", "ex", ")", "{", "throw", "new", "HttpMessageNotReadableException", "(", "\"", "Could", "not", "parse", "document", ":", "\"", "+", "ex", ".", "getMessage", "(", "),", "ex", ")", ";", "}", "}", "private", "Source", "readStAXSource", "(", "InputStream", "body", ")", "{", "try", "{", "XMLInputFactory", "inputFactory", "=", "XMLInputFactory", ".", "newFactory", "(", ");", "inputFactory", ".", "setProperty", "(", "\"", "javax", ".", "xml", ".", "stream", ".", "isSupportingExternalEntities", "\"", ",", "processExternalEntities", ")", ";", "XMLStreamReader", "streamReader", "=", "inputFactory", ".", "createXMLStreamReader", "(", "body", ")", ";", "return", "new", "StAXSource", "(", "streamReader", ")", ";", "}", "catch", "(", "XMLStreamException", "ex", ")", "{", "throw", "new", "HttpMessageNotReadableException", "(", "\"", "Could", "not", "parse", "document", ":", "\"", "+", "ex", ".", "getMessage", "(", "),", "ex", ")", ";", "}", "}", "private", "StreamSource", "readStreamSource", "(", "InputStream", "body", ")", "throws", "IOException", "{", "byte", "[", "]", "bytes", "=", "StreamUtils", ".", "copyToByteArray", "(", "body", ")", ";", "return", "new", "StreamSource", "(", "new", "ByteArrayInputStream", "(", "bytes", ")", ");", "}", "@", "Override", "@", "@", "-", "102", ",", "15", "+", "173", ",", "22", "@", "@", "protected", "Long", "getContentLength", "(", "T", "t", ",", "MediaType", "contentType", ")", "{", "}", "@", "Override", "protected", "void", "writeToResult", "(", "T", "t", ",", "HttpHeaders", "headers", ",", "Result", "result", ")", "throws", "IOException", "{", "protected", "void", "writeInternal", "(", "T", "t", ",", "HttpOutputMessage", "outputMessage", ")", "throws", "IOException", ",", "HttpMessageNotWritableException", "{", "try", "{", "Result", "result", "=", "new", "StreamResult", "(", "outputMessage", ".", "getBody", "(", "))", ";", "transform", "(", "t", ",", "result", ")", ";", "}", "catch", "(", "TransformerException", "ex", ")", "{", "throw", "new", "HttpMessageNotWritableException", "(", "\"", "Could", "not", "transform", "[", "\"", "+", "t", "+", "\"", "]", "to", "[", "\"", "+", "result", "+", "\"", "]\"", ",", "ex", ")", ";", "throw", "new", "HttpMessageNotWritableException", "(", "\"", "Could", "not", "transform", "[", "\"", "+", "t", "+", "\"", "]", "to", "output", "message", "\"", ",", "ex", ")", ";", "}", "}", "private", "void", "transform", "(", "Source", "source", ",", "Result", "result", ")", "throws", "TransformerException", "{", "this", ".", "transformerFactory", ".", "newTransformer", "(", ").", "transform", "(", "source", ",", "result", ")", ";", "}", "private", "static", "class", "CountingOutputStream", "extends", "OutputStream", "{", "private", "long", "count", "=", "0", ";", "@", "@", "-", "17", ",", "39", "+", "17", ",", "59", "@", "@", "package", "org", ".", "springframework", ".", "http", ".", "converter", ".", "xml", ";", "import", "static", "org", ".", "custommonkey", ".", "xmlunit", ".", "XMLAssert", ".", "assertXMLEqual", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*;", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotEquals", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "io", ".", "InputStreamReader", ";", "import", "java", ".", "io", ".", "StringReader", ";", "import", "java", ".", "nio", ".", "charset", ".", "Charset", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "stream", ".", "XMLStreamException", ";", "import", "javax", ".", "xml", ".", "stream", ".", "XMLStreamReader", ";", "import", "javax", ".", "xml", ".", "transform", ".", "Source", ";", "import", "javax", ".", "xml", ".", "transform", ".", "dom", ".", "DOMSource", ";", "import", "javax", ".", "xml", ".", "transform", ".", "sax", ".", "SAXSource", ";", "import", "javax", ".", "xml", ".", "transform", ".", "stax", ".", "StAXSource", ";", "import", "javax", ".", "xml", ".", "transform", ".", "stream", ".", "StreamSource", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "http", ".", "MediaType", ";", "import", "org", ".", "springframework", ".", "http", ".", "MockHttpInputMessage", ";", "import", "org", ".", "springframework", ".", "http", ".", "MockHttpOutputMessage", ";", "import", "org", ".", "springframework", ".", "util", ".", "FileCopyUtils", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Element", ";", "import", "org", ".", "xml", ".", "sax", ".", "InputSource", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "org", ".", "xml", ".", "sax", ".", "XMLReader", ";", "import", "org", ".", "xml", ".", "sax", ".", "helpers", ".", "DefaultHandler", ";", "/", "**", "*", "@", "author", "Arjen", "Poutsma", "*", "/", "public", "class", "SourceHttpMessageConverterTests", "{", "private", "static", "final", "String", "BODY", "=", "\"", "<", "root", ">", "Hello", "World", "<", "/", "root", ">", "\";", "private", "SourceHttpMessageConverter", "<", "Source", ">", "converter", ";", "private", "String", "bodyExternal", ";", "@", "Before", "public", "void", "setUp", "(", ")", "{", "public", "void", "setUp", "(", ")", "throws", "IOException", "{", "converter", "=", "new", "SourceHttpMessageConverter", "<", "Source", ">", "()", ";", "Resource", "external", "=", "new", "ClassPathResource", "(", "\"", "external", ".", "txt", "\"", ",", "getClass", "(", "))", ";", "bodyExternal", "=", "\"", "<!", "DOCTYPE", "root", "[", "\"", "\"", "<", "!", "ELEMENT", "root", "ANY", ">", "\\", "n", "\"", "\"", "<", "!", "ENTITY", "ext", "SYSTEM", "\\", "\"\"", "+", "external", ".", "getURI", "(", ")", "+", "\"", "\\\"", ">", "]>", "<", "root", ">", "&", "ext", ";", "</", "root", ">", "\";", "}", "@", "Test", "@", "@", "-", "67", ",", "39", "+", "87", ",", "94", "@", "@", "public", "void", "canWrite", "(", ")", "{", "@", "Test", "public", "void", "readDOMSource", "(", ")", "throws", "Exception", "{", "String", "body", "=", "\"", "<", "root", ">", "Hello", "World", "<", "/", "root", ">", "\";", "MockHttpInputMessage", "inputMessage", "=", "new", "MockHttpInputMessage", "(", "body", ".", "getBytes", "(", "\"", "UTF", "-", "8", "\"", "))", ";", "MockHttpInputMessage", "inputMessage", "=", "new", "MockHttpInputMessage", "(", "BODY", ".", "getBytes", "(", "\"", "UTF", "-", "8", "\"", "))", ";", "inputMessage", ".", "getHeaders", "(", ").", "setContentType", "(", "new", "MediaType", "(", "\"", "application", "\"", ",", "\"", "xml", "\"", "))", ";", "DOMSource", "result", "=", "(", "DOMSource", ")", "converter", ".", "read", "(", "DOMSource", ".", "class", ",", "inputMessage", ")", ";", "Document", "document", "=", "(", "Document", ")", "result", ".", "getNode", "(", ");", "assertEquals", "(", "\"", "Invalid", "result", "\"", ",", "\"", "root", "\"", ",", "document", ".", "getDocumentElement", "(", ").", "getLocalName", "(", "))", ";", "}", "@", "Test", "public", "void", "readDOMSourceExternal", "(", ")", "throws", "Exception", "{", "MockHttpInputMessage", "inputMessage", "=", "new", "MockHttpInputMessage", "(", "bodyExternal", ".", "getBytes", "(", "\"", "UTF", "-", "8", "\"", "))", ";", "inputMessage", ".", "getHeaders", "(", ").", "setContentType", "(", "new", "MediaType", "(", "\"", "application", "\"", ",", "\"", "xml", "\"", "))", ";", "DOMSource", "result", "=", "(", "DOMSource", ")", "converter", ".", "read", "(", "DOMSource", ".", "class", ",", "inputMessage", ")", ";", "Document", "document", "=", "(", "Document", ")", "result", ".", "getNode", "(", ");", "assertEquals", "(", "\"", "Invalid", "result", "\"", ",", "\"", "root", "\"", ",", "document", ".", "getDocumentElement", "(", ").", "getLocalName", "(", "))", ";", "assertNotEquals", "(", "\"", "Invalid", "result", "\"", ",", "\"", "Foo", "Bar", "\"", ",", "document", ".", "getDocumentElement", "(", ").", "getTextContent", "(", "))", ";", "}", "@", "Test", "public", "void", "readSAXSource", "(", ")", "throws", "Exception", "{", "String", "body", "=", "\"", "<", "root", ">", "Hello", "World", "<", "/", "root", ">", "\";", "MockHttpInputMessage", "inputMessage", "=", "new", "MockHttpInputMessage", "(", "body", ".", "getBytes", "(", "\"", "UTF", "-", "8", "\"", "))", ";", "MockHttpInputMessage", "inputMessage", "=", "new", "MockHttpInputMessage", "(", "BODY", ".", "getBytes", "(", "\"", "UTF", "-", "8", "\"", "))", ";", "inputMessage", ".", "getHeaders", "(", ").", "setContentType", "(", "new", "MediaType", "(", "\"", "application", "\"", ",", "\"", "xml", "\"", "))", ";", "SAXSource", "result", "=", "(", "SAXSource", ")", "converter", ".", "read", "(", "SAXSource", ".", "class", ",", "inputMessage", ")", ";", "InputSource", "inputSource", "=", "result", ".", "getInputSource", "(", ");", "String", "s", "=", "FileCopyUtils", ".", "copyToString", "(", "new", "InputStreamReader", "(", "inputSource", ".", "getByteStream", "(", "))", ");", "assertXMLEqual", "(", "\"", "Invalid", "result", "\"", ",", "body", ",", "s", ")", ";", "assertXMLEqual", "(", "\"", "Invalid", "result", "\"", ",", "BODY", ",", "s", ")", ";", "}", "@", "Test", "public", "void", "readSAXSourceExternal", "(", ")", "throws", "Exception", "{", "MockHttpInputMessage", "inputMessage", "=", "new", "MockHttpInputMessage", "(", "bodyExternal", ".", "getBytes", "(", "\"", "UTF", "-", "8", "\"", "))", ";", "inputMessage", ".", "getHeaders", "(", ").", "setContentType", "(", "new", "MediaType", "(", "\"", "application", "\"", ",", "\"", "xml", "\"", "))", ";", "SAXSource", "result", "=", "(", "SAXSource", ")", "converter", ".", "read", "(", "SAXSource", ".", "class", ",", "inputMessage", ")", ";", "InputSource", "inputSource", "=", "result", ".", "getInputSource", "(", ");", "XMLReader", "reader", "=", "result", ".", "getXMLReader", "(", ");", "reader", ".", "setContentHandler", "(", "new", "DefaultHandler", "(", ")", "{", "@", "Override", "public", "void", "characters", "(", "char", "[", "]", "ch", ",", "int", "start", ",", "int", "length", ")", "throws", "SAXException", "{", "String", "s", "=", "new", "String", "(", "ch", ",", "start", ",", "length", ")", ";", "assertNotEquals", "(", "\"", "Invalid", "result", "\"", ",", "\"", "Foo", "Bar", "\"", ",", "s", ")", ";", "}", "}", ");", "reader", ".", "parse", "(", "inputSource", ")", ";", "}", "@", "Test", "public", "void", "readStAXSource", "(", ")", "throws", "Exception", "{", "MockHttpInputMessage", "inputMessage", "=", "new", "MockHttpInputMessage", "(", "BODY", ".", "getBytes", "(", "\"", "UTF", "-", "8", "\"", "))", ";", "inputMessage", ".", "getHeaders", "(", ").", "setContentType", "(", "new", "MediaType", "(", "\"", "application", "\"", ",", "\"", "xml", "\"", "))", ";", "StAXSource", "result", "=", "(", "StAXSource", ")", "converter", ".", "read", "(", "StAXSource", ".", "class", ",", "inputMessage", ")", ";", "XMLStreamReader", "streamReader", "=", "result", ".", "getXMLStreamReader", "(", ");", "assertTrue", "(", "streamReader", ".", "hasNext", "(", "))", ";", "streamReader", ".", "nextTag", "(", ");", "String", "s", "=", "streamReader", ".", "getLocalName", "(", ");", "assertEquals", "(", "\"", "root", "\"", ",", "s", ")", ";", "s", "=", "streamReader", ".", "getElementText", "(", ");", "assertEquals", "(", "\"", "Hello", "World", "\"", ",", "s", ")", ";", "streamReader", ".", "close", "(", ");", "}", "@", "Test", "public", "void", "readStAXSourceExternal", "(", ")", "throws", "Exception", "{", "MockHttpInputMessage", "inputMessage", "=", "new", "MockHttpInputMessage", "(", "bodyExternal", ".", "getBytes", "(", "\"", "UTF", "-", "8", "\"", "))", ";", "inputMessage", ".", "getHeaders", "(", ").", "setContentType", "(", "new", "MediaType", "(", "\"", "application", "\"", ",", "\"", "xml", "\"", "))", ";", "StAXSource", "result", "=", "(", "StAXSource", ")", "converter", ".", "read", "(", "StAXSource", ".", "class", ",", "inputMessage", ")", ";", "XMLStreamReader", "streamReader", "=", "result", ".", "getXMLStreamReader", "(", ");", "assertTrue", "(", "streamReader", ".", "hasNext", "(", "))", ";", "streamReader", ".", "next", "(", ");", "streamReader", ".", "next", "(", ");", "String", "s", "=", "streamReader", ".", "getLocalName", "(", ");", "assertEquals", "(", "\"", "root", "\"", ",", "s", ")", ";", "s", "=", "streamReader", ".", "getElementText", "(", ");", "assertNotEquals", "(", "\"", "Foo", "Bar", "\"", ",", "s", ")", ";", "streamReader", ".", "close", "(", ");", "}", "@", "Test", "public", "void", "readStreamSource", "(", ")", "throws", "Exception", "{", "String", "body", "=", "\"", "<", "root", ">", "Hello", "World", "<", "/", "root", ">", "\";", "MockHttpInputMessage", "inputMessage", "=", "new", "MockHttpInputMessage", "(", "body", ".", "getBytes", "(", "\"", "UTF", "-", "8", "\"", "))", ";", "MockHttpInputMessage", "inputMessage", "=", "new", "MockHttpInputMessage", "(", "BODY", ".", "getBytes", "(", "\"", "UTF", "-", "8", "\"", "))", ";", "inputMessage", ".", "getHeaders", "(", ").", "setContentType", "(", "new", "MediaType", "(", "\"", "application", "\"", ",", "\"", "xml", "\"", "))", ";", "StreamSource", "result", "=", "(", "StreamSource", ")", "converter", ".", "read", "(", "StreamSource", ".", "class", ",", "inputMessage", ")", ";", "String", "s", "=", "FileCopyUtils", ".", "copyToString", "(", "new", "InputStreamReader", "(", "result", ".", "getInputStream", "(", "))", ");", "assertXMLEqual", "(", "\"", "Invalid", "result", "\"", ",", "body", ",", "s", ")", ";", "assertXMLEqual", "(", "\"", "Invalid", "result", "\"", ",", "BODY", ",", "s", ")", ";", "}", "@", "Test", "public", "void", "readSource", "(", ")", "throws", "Exception", "{", "String", "body", "=", "\"", "<", "root", ">", "Hello", "World", "<", "/", "root", ">", "\";", "MockHttpInputMessage", "inputMessage", "=", "new", "MockHttpInputMessage", "(", "body", ".", "getBytes", "(", "\"", "UTF", "-", "8", "\"", "))", ";", "MockHttpInputMessage", "inputMessage", "=", "new", "MockHttpInputMessage", "(", "BODY", ".", "getBytes", "(", "\"", "UTF", "-", "8", "\"", "))", ";", "inputMessage", ".", "getHeaders", "(", ").", "setContentType", "(", "new", "MediaType", "(", "\"", "application", "\"", ",", "\"", "xml", "\"", "))", ";", "converter", ".", "read", "(", "Source", ".", "class", ",", "inputMessage", ")", ";", "}", "@", "@", "-", "0", ",", "0", "+", "1", "@", "@", "Foo", "Bar"], "docstring_tokens": ["does", "not", "disable", "external", "entity", "resolution"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "7", ",", "6", "+", "7", ",", "7", "@", "@", "PHP", "NEWS", ".", "Fixed", "bug", "#", "73272", "(", "imagescale", "(", ")", "is", "not", "affected", "by", ",", "but", "affects", "imagesetinterpolation", "(", "))", ".", "(", "cmb", ")", ".", "Fixed", "bug", "#", "73279", "(", "Integer", "overflow", "in", "gdImageScaleBilinearPalette", "(", "))", ".", "(", "cmb", ")", ".", "Fixed", "bug", "#", "73280", "(", "Stack", "Buffer", "Overflow", "in", "GD", "dynamicGetbuf", ")", ".", "(", "cmb", ")", "-", "SOAP", ":", ".", "Fixed", "bug", "#", "73037", "(", "SoapServer", "reports", "Bad", "Request", "when", "gzipped", ")", ".", "(", "Anatol", ")", "@", "@", "-", "237", ",", "7", "+", "237", ",", "7", "@", "@", "static", "int", "dynamicGetbuf", "(", "gdIOCtxPtr", "ctx", ",", "void", "*", "buf", ",", "int", "len", ")", "if", "(", "remain", ">", "=", "len", ")", "{", "rlen", "=", "len", ";", "}", "else", "{", "if", "(", "remain", "=", "=", "0", ")", "{", "if", "(", "remain", "<", "=", "0", ")", "{", "return", "EOF", ";", "}", "rlen", "=", "remain", ";"], "docstring_tokens": ["improper", "bounds", "checking"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "222", ",", "7", "+", "222", ",", "7", "@", "@", "public", "String", "toString", "(", ")", "{", "if", "(", "this", ".", "filename", "!", "=", "null", ")", "{", "if", "(", "this", ".", "charset", "=", "=", "null", "|", "|", "StandardCharsets", ".", "US_ASCII", ".", "equals", "(", "this", ".", "charset", ")", ")", "{", "sb", ".", "append", "(", "\";", "filename", "=", "\\\"", "\")", ";", "sb", ".", "append", "(", "this", ".", "filename", ")", ".", "append", "(", "'\\", "\"'", ");", "sb", ".", "append", "(", "escapeQuotationsInFilename", "(", "this", ".", "filename", ")", ").", "append", "(", "'\\", "\"'", ");", "}", "else", "{", "sb", ".", "append", "(", "\";", "filename", "*", "=\"", ");", "@", "@", "-", "428", ",", "6", "+", "428", ",", "23", "@", "@", "private", "static", "boolean", "isRFC5987AttrChar", "(", "byte", "c", ")", "{", "c", "=", "=", "'", ".'", "|", "|", "c", "=", "=", "'", "^'", "|", "|", "c", "=", "=", "'", "_", "'", "|", "|", "c", "=", "=", "'", "`'", "|", "|", "c", "=", "=", "'", "|'", "|", "|", "c", "=", "=", "'", "~'", ";", "}", "private", "static", "String", "escapeQuotationsInFilename", "(", "String", "filename", ")", "{", "if", "(", "filename", ".", "indexOf", "(", "'\"", "')", "=", "=", "-", "1", "&", "&", "filename", ".", "indexOf", "(", "'\\", "\\'", ")", "=", "=", "-", "1", ")", "{", "return", "filename", ";", "}", "boolean", "escaped", "=", "false", ";", "StringBuilder", "sb", "=", "new", "StringBuilder", "(", ");", "for", "(", "char", "c", ":", "filename", ".", "toCharArray", "(", "))", "{", "sb", ".", "append", "(", "(", "c", "=", "=", "'", "\"'", "&", "&", "!", "escaped", ")", "?", "\"", "\\\\", "\\\"", "\"", ":", "c", ")", ";", "escaped", "=", "(", "!", "escaped", "&", "&", "c", "=", "=", "'", "\\\\", "')", ";", "}", "/", "/", "Remove", "backslash", "at", "the", "end", ".", ".", "if", "(", "escaped", ")", "{", "sb", ".", "deleteCharAt", "(", "sb", ".", "length", "(", ")", "-", "1", ")", ";", "}", "return", "sb", ".", "toString", "(", ");", "}", "/", "**", "*", "Encode", "the", "given", "header", "field", "param", "as", "describe", "in", "RFC", "5987", ".", "*", "@", "param", "input", "the", "header", "field", "param", "@", "@", "-", "437", ",", "13", "+", "454", ",", "10", "@", "@", "private", "static", "boolean", "isRFC5987AttrChar", "(", "byte", "c", ")", "{", "*", "@", "see", "<", "a", "href", "=", "\"", "https", ":", "//", "tools", ".", "ietf", ".", "org", "/", "html", "/", "rfc5987", "\"", ">", "RFC", "5987", "<", "/", "a", ">", "*", "/", "private", "static", "String", "encodeFilename", "(", "String", "input", ",", "Charset", "charset", ")", "{", "Assert", ".", "notNull", "(", "input", ",", "\"", "Input", "String", "should", "not", "be", "null", "\"", ");", "Assert", ".", "notNull", "(", "charset", ",", "\"", "Charset", "should", "not", "be", "null", "\"", ");", "if", "(", "StandardCharsets", ".", "US_ASCII", ".", "equals", "(", "charset", ")", ")", "{", "return", "input", ";", "}", "Assert", ".", "isTrue", "(", "UTF_8", ".", "equals", "(", "charset", ")", "|", "|", "ISO_8859_1", ".", "equals", "(", "charset", ")", ",", "\"", "Charset", "should", "be", "UTF", "-", "8", "or", "ISO", "-", "8859", "-", "1", "\"", ");", "Assert", ".", "notNull", "(", "input", ",", "\"", "`", "input", "`", "is", "required", "\"", ");", "Assert", ".", "notNull", "(", "charset", ",", "\"", "`", "charset", "`", "is", "required", "\"", ");", "Assert", ".", "isTrue", "(", "!", "StandardCharsets", ".", "US_ASCII", ".", "equals", "(", "charset", ")", ",", "\"", "ASCII", "does", "not", "require", "encoding", "\"", ");", "Assert", ".", "isTrue", "(", "UTF_8", ".", "equals", "(", "charset", ")", "|", "|", "ISO_8859_1", ".", "equals", "(", "charset", ")", ",", "\"", "Only", "UTF", "-", "8", "and", "ISO", "-", "8859", "-", "1", "supported", ".", "\")", ";", "byte", "[", "]", "source", "=", "input", ".", "getBytes", "(", "charset", ")", ";", "int", "len", "=", "source", ".", "length", ";", "StringBuilder", "sb", "=", "new", "StringBuilder", "(", "len", "<", "<", "1", ")", ";", "@", "@", "-", "578", ",", "25", "+", "592", ",", "13", "@", "@", "public", "Builder", "name", "(", "String", "name", ")", "{", "@", "Override", "public", "Builder", "filename", "(", "String", "filename", ")", "{", "Assert", ".", "hasText", "(", "filename", ",", "\"", "No", "filename", "\"", ");", "this", ".", "filename", "=", "escapeQuotationMarks", "(", "filename", ")", ";", "this", ".", "filename", "=", "filename", ";", "return", "this", ";", "}", "private", "static", "String", "escapeQuotationMarks", "(", "String", "filename", ")", "{", "if", "(", "filename", ".", "indexOf", "(", "'\"", "')", "=", "=", "-", "1", ")", "{", "return", "filename", ";", "}", "boolean", "escaped", "=", "false", ";", "StringBuilder", "sb", "=", "new", "StringBuilder", "(", ");", "for", "(", "char", "c", ":", "filename", ".", "toCharArray", "(", "))", "{", "sb", ".", "append", "(", "(", "c", "=", "=", "'", "\"'", "&", "&", "!", "escaped", ")", "?", "\"", "\\\\", "\\\"", "\"", ":", "c", ")", ";", "escaped", "=", "(", "!", "escaped", "&", "&", "c", "=", "=", "'", "\\\\", "')", ";", "}", "return", "sb", ".", "toString", "(", ");", "}", "@", "Override", "public", "Builder", "filename", "(", "String", "filename", ",", "Charset", "charset", ")", "{", "Assert", ".", "hasText", "(", "filename", ",", "\"", "No", "filename", "\"", ");", "this", ".", "filename", "=", "filename", ";", "this", ".", "charset", "=", "charset", ";", "return", "this", ";", "@", "@", "-", "222", ",", "10", "+", "222", ",", "15", "@", "@", "public", "void", "formatWithEncodedFilenameUsingUsAscii", "(", ")", "{", "@", "Test", "/", "/", "gh", "-", "24220", "public", "void", "formatWithFilenameWithQuotes", "(", ")", "{", "BiConsumer", "<", "String", ",", "String", ">", "tester", "=", "(", "input", ",", "output", ")", "-", ">", "BiConsumer", "<", "String", ",", "String", ">", "tester", "=", "(", "input", ",", "output", ")", "-", ">", "{", "assertThat", "(", "builder", "(", "\"", "form", "-", "data", "\"", ").", "filename", "(", "input", ")", ".", "build", "(", ").", "toString", "(", "))", ".", "isEqualTo", "(", "\"", "form", "-", "data", ";", "filename", "=", "\\\"", "\"", "+", "output", "+", "\"", "\\\"", "\")", ";", "assertThat", "(", "builder", "(", "\"", "form", "-", "data", "\"", ").", "filename", "(", "input", ",", "StandardCharsets", ".", "US_ASCII", ")", ".", "build", "(", ").", "toString", "(", "))", ".", "isEqualTo", "(", "\"", "form", "-", "data", ";", "filename", "=", "\\\"", "\"", "+", "output", "+", "\"", "\\\"", "\")", ";", "}", ";", "String", "filename", "=", "\"", "\\\"", "foo", ".", "txt", "\"", ";", "tester", ".", "accept", "(", "filename", ",", "\"", "\\\\", "\"", "+", "filename", ")", ";", "@", "@", "-", "243", ",", "6", "+", "248", ",", "10", "@", "@", "public", "void", "formatWithFilenameWithQuotes", "(", ")", "{", "tester", ".", "accept", "(", "\"\\", "\"\\", "\"", "foo", ".", "txt", "\"", ",", "\"", "\\\\", "\\\"", "\\\\", "\\\"", "foo", ".", "txt", "\"", ");", "tester", ".", "accept", "(", "\"\\", "\"\\", "\"\\", "\"", "foo", ".", "txt", "\"", ",", "\"", "\\\\", "\\\"", "\\\\", "\\\"", "\\\\", "\\\"", "foo", ".", "txt", "\"", ");", "tester", ".", "accept", "(", "\"", "foo", ".", "txt", "\\", "\\\"", ",", "\"", "foo", ".", "txt", "\"", ");", "tester", ".", "accept", "(", "\"", "foo", ".", "txt", "\\", "\\\\", "\\\"", ",", "\"", "foo", ".", "txt", "\\", "\\\\", "\\\"", ");", "tester", ".", "accept", "(", "\"", "foo", ".", "txt", "\\", "\\\\", "\\\\", "\\\"", ",", "\"", "foo", ".", "txt", "\\", "\\\\", "\\\"", ");", "}", "@", "Test"], "docstring_tokens": ["a", "flaw", "when", "it", "sets", "a", "Content-Disposition", "header", "in", "the", "response"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "696", ",", "6", "+", "696", ",", "8", "@", "@", "int", "sock_getsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "if", "(", "len", "<", "0", ")", "return", "-", "EINVAL", ";", "v", ".", "val", "=", "0", ";", "switch", "(", "optname", ")", "{", "case", "SO_DEBUG", ":", "v", ".", "val", "=", "sock_flag", "(", "sk", ",", "SOCK_DBG", ")", ";"], "docstring_tokens": ["leaking", "kernel", "memory", "will", "reappear", "if", "someone", "on", "some", "architecture", "uses", "struct", "timeval", "with", "some", "internal", "padding"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "210", ",", "8", "+", "210", ",", "16", "@", "@", "public", "void", "start", "(", ")", "throws", "Exception", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_AUTHENTICATION", ",", "\"", "none", "\"", ");", "}", "else", "{", "LOG", ".", "debug", "(", "\"", "login", "credentials", "[", "{}", ":*", "**", "**", "*]", "\",", "user", ")", ";", "env", ".", "put", "(", "Context", ".", "SECURITY_PRINCIPAL", ",", "user", ")", ";", "env", ".", "put", "(", "Context", ".", "SECURITY_CREDENTIALS", ",", "password", ")", ";", "if", "(", "user", "!", "=", "null", "&", "&", "!", "\"\"", ".", "equals", "(", "user", ")", ")", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_PRINCIPAL", ",", "user", ")", ";", "}", "else", "{", "throw", "new", "Exception", "(", "\"", "Empty", "username", "is", "not", "allowed", "\"", ");", "}", "if", "(", "password", "!", "=", "null", "&", "&", "!", "\"\"", ".", "equals", "(", "password", ")", ")", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_CREDENTIALS", ",", "password", ")", ";", "}", "else", "{", "throw", "new", "Exception", "(", "\"", "Empty", "password", "is", "not", "allowed", "\"", ");", "}", "}", "boolean", "isConnected", "=", "false", ";", "while", "(", "!", "isConnected", ")", "{", "@", "@", "-", "469", ",", "11", "+", "469", ",", "15", "@", "@", "protected", "DirContext", "open", "(", ")", "throws", "NamingException", "{", "try", "{", "Hashtable", "<", "String", ",", "String", ">", "env", "=", "new", "Hashtable", "<", "String", ",", "String", ">", "()", ";", "env", ".", "put", "(", "Context", ".", "INITIAL_CONTEXT_FACTORY", ",", "initialContextFactory", ")", ";", "if", "(", "connectionUsername", "!", "=", "null", "|", "|", "!", "\"\"", ".", "equals", "(", "connectionUsername", ")", ")", "{", "if", "(", "connectionUsername", "!", "=", "null", "&", "&", "!", "\"\"", ".", "equals", "(", "connectionUsername", ")", ")", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_PRINCIPAL", ",", "connectionUsername", ")", ";", "}", "else", "{", "throw", "new", "NamingException", "(", "\"", "Empty", "username", "is", "not", "allowed", "\"", ");", "}", "if", "(", "connectionPassword", "!", "=", "null", "|", "|", "!", "\"\"", ".", "equals", "(", "connectionPassword", ")", ")", "{", "if", "(", "connectionPassword", "!", "=", "null", "&", "&", "!", "\"\"", ".", "equals", "(", "connectionPassword", ")", ")", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_CREDENTIALS", ",", "connectionPassword", ")", ";", "}", "else", "{", "throw", "new", "NamingException", "(", "\"", "Empty", "password", "is", "not", "allowed", "\"", ");", "}", "env", ".", "put", "(", "Context", ".", "SECURITY_PROTOCOL", ",", "connectionProtocol", ")", ";", "env", ".", "put", "(", "Context", ".", "PROVIDER_URL", ",", "connectionURL", ")", ";", "@", "@", "-", "125", ",", "11", "+", "125", ",", "15", "@", "@", "public", "Thread", "newThread", "(", "Runnable", "r", ")", "{", "protected", "DirContext", "createContext", "(", ")", "throws", "NamingException", "{", "Hashtable", "<", "String", ",", "String", ">", "env", "=", "new", "Hashtable", "<", "String", ",", "String", ">", "()", ";", "env", ".", "put", "(", "Context", ".", "INITIAL_CONTEXT_FACTORY", ",", "initialContextFactory", ")", ";", "if", "(", "connectionUsername", "!", "=", "null", "|", "|", "!", "\"\"", ".", "equals", "(", "connectionUsername", ")", ")", "{", "if", "(", "connectionUsername", "!", "=", "null", "&", "&", "!", "\"\"", ".", "equals", "(", "connectionUsername", ")", ")", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_PRINCIPAL", ",", "connectionUsername", ")", ";", "}", "else", "{", "throw", "new", "NamingException", "(", "\"", "Empty", "username", "is", "not", "allowed", "\"", ");", "}", "if", "(", "connectionPassword", "!", "=", "null", "|", "|", "!", "\"\"", ".", "equals", "(", "connectionPassword", ")", ")", "{", "if", "(", "connectionPassword", "!", "=", "null", "&", "&", "!", "\"\"", ".", "equals", "(", "connectionPassword", ")", ")", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_CREDENTIALS", ",", "connectionPassword", ")", ";", "}", "else", "{", "throw", "new", "NamingException", "(", "\"", "Empty", "password", "is", "not", "allowed", "\"", ");", "}", "env", ".", "put", "(", "Context", ".", "SECURITY_PROTOCOL", ",", "connectionProtocol", ")", ";", "env", ".", "put", "(", "Context", ".", "PROVIDER_URL", ",", "connectionURL", ")", ";", "@", "@", "-", "190", ",", "7", "+", "190", ",", "7", "@", "@", "protected", "boolean", "authenticate", "(", "String", "username", ",", "String", "password", ")", "throws", "LoginExc", "try", "{", "String", "filter", "=", "userSearchMatchingFormat", ".", "format", "(", "new", "String", "[", "]", "{", "username", "doRFC2254Encoding", "(", "username", ")", "}", ");", "SearchControls", "constraints", "=", "new", "SearchControls", "(", ");", "if", "(", "userSearchSubtreeBool", ")", "{", "@", "@", "-", "319", ",", "7", "+", "319", ",", "7", "@", "@", "protected", "boolean", "authenticate", "(", "String", "username", ",", "String", "password", ")", "throws", "LoginExc", "return", "list", ";", "}", "String", "filter", "=", "roleSearchMatchingFormat", ".", "format", "(", "new", "String", "[", "]", "{", "doRFC2254Encoding", "(", "dn", ")", ",", "username", "doRFC2254Encoding", "(", "dn", ")", ",", "doRFC2254Encoding", "(", "username", ")", "}", ");", "SearchControls", "constraints", "=", "new", "SearchControls", "(", ");", "@", "@", "-", "459", ",", "9", "+", "459", ",", "14", "@", "@", "protected", "DirContext", "open", "(", ")", "throws", "NamingException", "{", "env", ".", "put", "(", "Context", ".", "INITIAL_CONTEXT_FACTORY", ",", "getLDAPPropertyValue", "(", "INITIAL_CONTEXT_FACTORY", ")", ");", "if", "(", "isLoginPropertySet", "(", "CONNECTION_USERNAME", ")", ")", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_PRINCIPAL", ",", "getLDAPPropertyValue", "(", "CONNECTION_USERNAME", ")", ");", "}", "else", "{", "throw", "new", "NamingException", "(", "\"", "Empty", "username", "is", "not", "allowed", "\"", ");", "}", "if", "(", "isLoginPropertySet", "(", "CONNECTION_PASSWORD", ")", ")", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_CREDENTIALS", ",", "getLDAPPropertyValue", "(", "CONNECTION_PASSWORD", ")", ");", "}", "else", "{", "throw", "new", "NamingException", "(", "\"", "Empty", "password", "is", "not", "allowed", "\"", ");", "}", "env", ".", "put", "(", "Context", ".", "SECURITY_PROTOCOL", ",", "getLDAPPropertyValue", "(", "CONNECTION_PROTOCOL", ")", ");", "env", ".", "put", "(", "Context", ".", "PROVIDER_URL", ",", "getLDAPPropertyValue", "(", "CONNECTION_URL", ")", ");", "@", "@", "-", "484", ",", "7", "+", "489", ",", "7", "@", "@", "private", "String", "getLDAPPropertyValue", "(", "String", "propertyName", ")", "{", "private", "boolean", "isLoginPropertySet", "(", "String", "propertyName", ")", "{", "for", "(", "int", "i", "=", "0", ";", "i", "<", "config", ".", "length", ";", "i", "+", "+", ")", "{", "if", "(", "config", "[", "i", "]", ".", "getPropertyName", "(", ")", "=", "=", "propertyName", "&", "&", "config", "[", "i", "]", ".", "getPropertyValue", "(", ")", "!", "=", "null", ")", "if", "(", "config", "[", "i", "]", ".", "getPropertyName", "(", ")", "=", "=", "propertyName", "&", "&", "(", "config", "[", "i", "]", ".", "getPropertyValue", "(", ")", "!", "=", "null", "&", "&", "!", "\"\"", ".", "equals", "(", "config", "[", "i", "]", ".", "getPropertyValue", "(", "))", "))", "return", "true", ";", "}", "return", "false", ";", "@", "@", "-", "41", ",", "7", "+", "41", ",", "9", "@", "@", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "Hashtable", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "fail", ";", "@", "RunWith", "(", "FrameworkRunner", ".", "class", ")", "@", "CreateLdapServer", "(", "transports", "=", "{", "@", "CreateTransport", "(", "protocol", "=", "\"", "LDAP", "\"", ",", "port", "=", "1024", ")", "})", "@", "@", "-", "121", ",", "4", "+", "123", ",", "29", "@", "@", "public", "void", "handle", "(", "Callback", "[", "]", "callbacks", ")", "throws", "IOException", ",", "UnsupportedCallback", "context", ".", "logout", "(", ");", "}", "@", "Test", "public", "void", "testUnauthenticated", "(", ")", "throws", "LoginException", "{", "LoginContext", "context", "=", "new", "LoginContext", "(", "\"", "UnAuthenticatedLDAPLogin", "\"", ",", "new", "CallbackHandler", "(", ")", "{", "public", "void", "handle", "(", "Callback", "[", "]", "callbacks", ")", "throws", "IOException", ",", "UnsupportedCallbackException", "{", "for", "(", "int", "i", "=", "0", ";", "i", "<", "callbacks", ".", "length", ";", "i", "+", "+)", "{", "if", "(", "callbacks", "[", "i", "]", "instanceof", "NameCallback", ")", "{", "(", "(", "NameCallback", ")", "callbacks", "[", "i", "]", ").", "setName", "(", "\"", "first", "\"", ");", "}", "else", "if", "(", "callbacks", "[", "i", "]", "instanceof", "PasswordCallback", ")", "{", "(", "(", "PasswordCallback", ")", "callbacks", "[", "i", "]", ").", "setPassword", "(", "\"", "secret", "\"", ".", "toCharArray", "(", "))", ";", "}", "else", "{", "throw", "new", "UnsupportedCallbackException", "(", "callbacks", "[", "i", "]", ");", "}", "}", "}", "}", ");", "try", "{", "context", ".", "login", "(", ");", "}", "catch", "(", "LoginException", "le", ")", "{", "assertEquals", "(", "le", ".", "getCause", "(", ").", "getMessage", "(", "),", "\"", "Empty", "password", "is", "not", "allowed", "\"", ");", "return", ";", "}", "fail", "(", "\"", "Should", "have", "failed", "authenticating", "\"", ");", "}", "}", "@", "@", "-", "40", ",", "6", "+", "40", ",", "25", "@", "@", "LDAPLogin", "{", ";", "}", ";", "UnAuthenticatedLDAPLogin", "{", "org", ".", "apache", ".", "activemq", ".", "jaas", ".", "LDAPLoginModule", "required", "debug", "=", "true", "initialContextFactory", "=", "com", ".", "sun", ".", "jndi", ".", "ldap", ".", "LdapCtxFactory", "connectionURL", "=", "\"", "ldap", ":", "//", "localhost", ":", "1024", "\"", "connectionUsername", "=", "\"", "uid", "=", "admin", ",", "ou", "=", "system", "\"", "connectionPassword", "=", "\"\"", "connectionProtocol", "=", "s", "authentication", "=", "simple", "userBase", "=", "\"", "ou", "=", "system", "\"", "userSearchMatching", "=", "\"(", "uid", "=", "{", "0", "}", ")\"", "userSearchSubtree", "=", "false", "roleBase", "=", "\"", "ou", "=", "system", "\"", "roleName", "=", "dummyRoleName", "roleSearchMatching", "=", "\"(", "uid", "=", "{", "1", "}", ")\"", "roleSearchSubtree", "=", "false", ";", "}", ";", "ExpandedLDAPLogin", "{", "org", ".", "apache", ".", "activemq", ".", "jaas", ".", "LDAPLoginModule", "required", "debug", "=", "true", "@", "@", "-", "0", ",", "0", "+", "1", ",", "83", "@", "@", "/", "**", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "activemq", ".", "security", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "fail", ";", "import", "javax", ".", "jms", ".", "Connection", ";", "import", "javax", ".", "jms", ".", "Destination", ";", "import", "javax", ".", "jms", ".", "JMSException", ";", "import", "javax", ".", "jms", ".", "Message", ";", "import", "javax", ".", "jms", ".", "MessageConsumer", ";", "import", "javax", ".", "jms", ".", "MessageProducer", ";", "import", "javax", ".", "jms", ".", "Queue", ";", "import", "javax", ".", "jms", ".", "Session", ";", "import", "org", ".", "apache", ".", "activemq", ".", "ActiveMQConnectionFactory", ";", "import", "org", ".", "apache", ".", "activemq", ".", "broker", ".", "BrokerFactory", ";", "import", "org", ".", "apache", ".", "activemq", ".", "broker", ".", "BrokerService", ";", "import", "org", ".", "apache", ".", "directory", ".", "server", ".", "annotations", ".", "CreateLdapServer", ";", "import", "org", ".", "apache", ".", "directory", ".", "server", ".", "annotations", ".", "CreateTransport", ";", "import", "org", ".", "apache", ".", "directory", ".", "server", ".", "core", ".", "annotations", ".", "ApplyLdifFiles", ";", "import", "org", ".", "apache", ".", "directory", ".", "server", ".", "core", ".", "integ", ".", "AbstractLdapTestUnit", ";", "import", "org", ".", "apache", ".", "directory", ".", "server", ".", "core", ".", "integ", ".", "FrameworkRunner", ";", "import", "org", ".", "apache", ".", "directory", ".", "server", ".", "ldap", ".", "LdapServer", ";", "import", "org", ".", "junit", ".", "After", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", ";", "@", "RunWith", "(", "FrameworkRunner", ".", "class", ")", "@", "CreateLdapServer", "(", "transports", "=", "{", "@", "CreateTransport", "(", "protocol", "=", "\"", "LDAP", "\"", ",", "port", "=", "1024", ")", "})", "@", "ApplyLdifFiles", "(", "\"", "org", "/", "apache", "/", "activemq", "/", "security", "/", "activemq", ".", "ldif", "\"", ")", "public", "class", "LDAPAuthenticationTest", "extends", "AbstractLdapTestUnit", "{", "public", "BrokerService", "broker", ";", "public", "static", "LdapServer", "ldapServer", ";", "@", "Before", "public", "void", "setup", "(", ")", "throws", "Exception", "{", "System", ".", "setProperty", "(", "\"", "ldapPort", "\"", ",", "String", ".", "valueOf", "(", "getLdapServer", "(", ").", "getPort", "(", "))", ");", "broker", "=", "BrokerFactory", ".", "createBroker", "(", "\"", "xbean", ":", "org", "/", "apache", "/", "activemq", "/", "security", "/", "activemq", "-", "ldap", "-", "auth", ".", "xml", "\"", ");", "broker", ".", "start", "(", ");", "broker", ".", "waitUntilStarted", "(", ");", "}", "@", "After", "public", "void", "shutdown", "(", ")", "throws", "Exception", "{", "broker", ".", "stop", "(", ");", "broker", ".", "waitUntilStopped", "(", ");", "}", "@", "Test", "public", "void", "testWildcard", "(", ")", "throws", "Exception", "{", "ActiveMQConnectionFactory", "factory", "=", "new", "ActiveMQConnectionFactory", "(", "\"", "tcp", ":", "//", "localhost", ":", "61616", "\"", ");", "Connection", "conn", "=", "factory", ".", "createQueueConnection", "(", "\"*", "\",", "\"", "sunflower", "\"", ");", "try", "{", "conn", ".", "createSession", "(", "false", ",", "Session", ".", "AUTO_ACKNOWLEDGE", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "e", ".", "printStackTrace", "(", ");", "return", ";", "}", "fail", "(", "\"", "Should", "have", "failed", "connecting", "\"", ");", "}", "}", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "44", ",", "7", "+", "44", ",", "7", "@", "@", "@", "RunWith", "(", "FrameworkRunner", ".", "class", ")", "@", "CreateLdapServer", "(", "transports", "=", "{", "@", "CreateTransport", "(", "protocol", "=", "\"", "LDAP", "\"", ")}", ")", "@", "CreateLdapServer", "(", "transports", "=", "{", "@", "CreateTransport", "(", "protocol", "=", "\"", "LDAP", "\"", ",", "port", "=", "1024", ")", "})", "@", "ApplyLdifFiles", "(", "\"", "org", "/", "apache", "/", "activemq", "/", "security", "/", "activemq", ".", "ldif", "\"", ")", "@", "@", "-", "65", ",", "4", "+", "65", ",", "23", "@", "@", "broker2", "{", "debug", "=", "true", "org", ".", "apache", ".", "activemq", ".", "jaas", ".", "textfiledn", ".", "user", "=", "\"", "org", "/", "apache", "/", "activemq", "/", "security", "/", "users2", ".", "properties", "\"", "org", ".", "apache", ".", "activemq", ".", "jaas", ".", "textfiledn", ".", "group", "=", "\"", "org", "/", "apache", "/", "activemq", "/", "security", "/", "groups", ".", "properties", "\"", ";", "}", ";", "LDAPLogin", "{", "org", ".", "apache", ".", "activemq", ".", "jaas", ".", "LDAPLoginModule", "required", "debug", "=", "true", "initialContextFactory", "=", "com", ".", "sun", ".", "jndi", ".", "ldap", ".", "LdapCtxFactory", "connectionURL", "=", "\"", "ldap", ":", "//", "localhost", ":", "1024", "\"", "connectionUsername", "=", "\"", "uid", "=", "admin", ",", "ou", "=", "system", "\"", "connectionPassword", "=", "secret", "connectionProtocol", "=", "s", "authentication", "=", "simple", "userBase", "=", "\"", "ou", "=", "User", ",", "ou", "=", "ActiveMQ", ",", "ou", "=", "system", "\"", "userSearchMatching", "=", "\"(", "uid", "=", "{", "0", "}", ")\"", "userSearchSubtree", "=", "false", "roleBase", "=", "\"", "ou", "=", "Group", ",", "ou", "=", "ActiveMQ", ",", "ou", "=", "system", "\"", "roleName", "=", "cn", "roleSearchMatching", "=", "\"(", "uid", "=", "{", "1", "}", ")\"", "roleSearchSubtree", "=", "true", ";", "}", ";", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "0", ",", "0", "+", "1", ",", "46", "@", "@", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "?>", "<", "!-", "-", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "the", "License", ".", "-", "->", "<", "!-", "-", "START", "SNIPPET", ":", "xbean", "-", "->", "<", "beans", "xmlns", "=", "\"", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "beans", "\"", "xmlns", ":", "amq", "=", "\"", "http", ":", "//", "activemq", ".", "apache", ".", "org", "/", "schema", "/", "core", "\"", "xmlns", ":", "xsi", "=", "\"", "http", ":", "//", "www", ".", "w3", ".", "org", "/", "2001", "/", "XMLSchema", "-", "instance", "\"", "xsi", ":", "schemaLocation", "=", "\"", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "beans", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "beans", "/", "spring", "-", "beans", "-", "2", ".", "0", ".", "xsd", "http", ":", "//", "activemq", ".", "apache", ".", "org", "/", "schema", "/", "core", "http", ":", "//", "activemq", ".", "apache", ".", "org", "/", "schema", "/", "core", "/", "activemq", "-", "core", ".", "xsd", "\"", ">", "<", "bean", "class", "=", "\"", "org", ".", "springframework", ".", "beans", ".", "factory", ".", "config", ".", "PropertyPlaceholderConfigurer", "\"", "/>", "<", "broker", "useJmx", "=", "\"", "false", "\"", "xmlns", "=", "\"", "http", ":", "//", "activemq", ".", "apache", ".", "org", "/", "schema", "/", "core", "\"", "persistent", "=", "\"", "false", "\"", ">", "<", "destinations", ">", "<", "queue", "physicalName", "=", "\"", "ADMIN", ".", "FOO", "\"", "/", ">", "<", "/", "destinations", ">", "<", "plugins", ">", "<", "jaasAuthenticationPlugin", "configuration", "=", "\"", "LDAPLogin", "\"", "/>", "<", "/", "plugins", ">", "<", "transportConnectors", ">", "<", "transportConnector", "uri", "=", "\"", "tcp", ":", "//", "localhost", ":", "61616", "\"", "/>", "<", "/", "transportConnectors", ">", "<", "/", "broker", ">", "<", "/", "beans", ">", "<", "!-", "-", "END", "SNIPPET", ":", "xbean", "-", "->"], "docstring_tokens": ["allows", "wildcard", "operators", "in", "usernames"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "614", ",", "6", "+", "614", ",", "9", "@", "@", "int", "dccp_rcv_state_process", "(", "struct", "sock", "*", "sk", ",", "struct", "sk_buff", "*", "skb", ",", "/", "*", "Caller", "(", "dccp_v4_do_rcv", ")", "will", "send", "Reset", "*", "/", "dcb", "-", ">", "dccpd_reset_code", "=", "DCCP_RESET_CODE_NO_CONNECTION", ";", "return", "1", ";", "}", "else", "if", "(", "sk", "-", ">", "sk_state", "=", "=", "DCCP_CLOSED", ")", "{", "dcb", "-", ">", "dccpd_reset_code", "=", "DCCP_RESET_CODE_NO_CONNECTION", ";", "return", "1", ";", "}", "if", "(", "sk", "-", ">", "sk_state", "!", "=", "DCCP_REQUESTING", "&", "&", "sk", "-", ">", "sk_state", "!", "=", "DCCP_RESPOND", ")", "{", "@", "@", "-", "668", ",", "10", "+", "671", ",", "6", "@", "@", "int", "dccp_rcv_state_process", "(", "struct", "sock", "*", "sk", ",", "struct", "sk_buff", "*", "skb", ",", "}", "switch", "(", "sk", "-", ">", "sk_state", ")", "{", "case", "DCCP_CLOSED", ":", "dcb", "-", ">", "dccpd_reset_code", "=", "DCCP_RESET_CODE_NO_CONNECTION", ";", "return", "1", ";", "case", "DCCP_REQUESTING", ":", "queued", "=", "dccp_rcv_request_sent_state_process", "(", "sk", ",", "skb", ",", "dh", ",", "len", ")", ";", "if", "(", "queued", ">", "=", "0", ")"], "docstring_tokens": ["not", "preventing", "operations", "on", "an", "already", "torn-down", "socket"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1505", ",", "6", "+", "1505", ",", "16", "@", "@", "void", "start_thread", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "long", "start", ",", "unsigned", "long", "sp", ")", "current", "-", ">", "thread", ".", "regs", "=", "regs", "-", "1", ";", "}", "#", "ifdef", "CONFIG_PPC_TRANSACTIONAL_MEM", "/", "*", "*", "Clear", "any", "transactional", "state", ",", "we", "'", "re", "exec", "(", ")", "ing", ".", "The", "cause", "is", "*", "not", "important", "as", "there", "will", "never", "be", "a", "recheckpoint", "so", "it", "'", "s", "not", "*", "user", "visible", ".", "*", "/", "if", "(", "MSR_TM_SUSPENDED", "(", "mfmsr", "(", "))", ")", "tm_reclaim_current", "(", "0", ")", ";", "#", "endif", "memset", "(", "regs", "-", ">", "gpr", ",", "0", ",", "sizeof", "(", "regs", "-", ">", "gpr", ")", ");", "regs", "-", ">", "ctr", "=", "0", ";", "regs", "-", ">", "link", "=", "0", ";"], "docstring_tokens": ["does", "not", "return", "to", "the", "old", "process"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "159", ",", "7", "+", "159", ",", "7", "@", "@", "private", "void", "writeSession", "(", "SessionInformations", "session", ",", "boolean", "displayUser", ")", "thro", "if", "(", "remoteAddr", "=", "=", "null", ")", "{", "write", "(", "\"&", "nbsp", ";", "\")", ";", "}", "else", "{", "write", "(", "remoteAddr", ")", ";", "write", "(", "htmlEncodeButNotSpace", "(", "remoteAddr", ")", ");", "}", "write", "(", "nextColumnAlignCenter", ")", ";", "writeCountry", "(", "session", ")", ";"], "docstring_tokens": ["improper", "validation", "of", "user-supplied", "input"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "89", ",", "7", "+", "89", ",", "12", "@", "@", "private", "static", "StringBuilder", "appendTwoUpperHex", "(", "StringBuilder", "sb", ",", "int", "b", ")", "/", "**", "*", "Encode", "a", "character", "for", "URLs", "*", "@", "param", "immune", "characters", "not", "to", "encode", "*", "@", "param", "immune", "Additional", "characters", "not", "to", "encode", ".", "Note", "this", "could", "*", "break", "URL", "encoding", "as", "referenced", "in", "RFC", "3986", ".", "You", "should", "*", "especially", "be", "wary", "of", "including", "'", "%'", "in", "this", "list", "of", "immune", "*", "characters", "since", "it", "is", "used", "as", "the", "\"", "escape", "\"", "character", "for", "*", "the", "hex", "encoding", "and", "including", "it", "may", "result", "in", "subsequent", "*", "and", "/", "or", "dangerous", "results", "when", "decoding", ".", "*", "@", "param", "c", "character", "to", "encode", "*", "@", "return", "the", "encoded", "string", "representing", "c", "*", "/", "@", "@", "-", "99", ",", "6", "+", "104", ",", "11", "@", "@", "public", "String", "encodeCharacter", "(", "char", "[", "]", "immune", ",", "Character", "c", ")", "byte", "[", "]", "bytes", ";", "StringBuilder", "sb", ";", "/", "/", "check", "for", "user", "specified", "immune", "characters", "if", "(", "immune", "!", "=", "null", "&", "&", "containsCharacter", "(", "c", ".", "charValue", "(", "),", "immune", ")", ")", "return", "cStr", ";", "/", "/", "check", "for", "standard", "characters", "(", "e", ".", "g", ".", ",", "alphanumeric", ",", "etc", ".", ")", "if", "(", "UNENCODED_SET", ".", "contains", "(", "c", ")", ")", "return", "cStr", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "138", "@", "@", "package", "org", ".", "owasp", ".", "esapi", ".", "codecs", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "junit", ".", "Assert", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", ";", "import", "org", ".", "junit", ".", "runners", ".", "Parameterized", ";", "import", "org", ".", "junit", ".", "runners", ".", "Parameterized", ".", "Parameters", ";", "import", "org", ".", "owasp", ".", "esapi", ".", "EncoderConstants", ";", "import", "org", ".", "owasp", ".", "esapi", ".", "StringUtilities", ";", "import", "org", ".", "owasp", ".", "esapi", ".", "codecs", ".", "*;", "/", "**", "*", "Parameterized", "test", "to", "verify", "that", "the", "Immunity", "parameter", "for", "a", "codec", "*", "encode", "/", "decode", "event", "works", "as", "expected", "on", "a", "series", "of", "special", "characters", ".", "*", "*", "@", "author", "jeremiah", ".", "j", ".", "stacey", "@", "gmail", ".", "com", "*", "@", "since", "2", ".", "1", ".", "0", ".", "1", "*", "*", "/", "@", "RunWith", "(", "Parameterized", ".", "class", ")", "public", "class", "CodecImmunityTest", "{", "/", "**", "character", "arrays", "used", "as", "immunity", "lists", "from", "Default", "Encoder", ".", "*/", "private", "final", "static", "char", "[", "]", "IMMUNE_HTML", "=", "{", "'", ",'", ",", "'", ".'", ",", "'", "-'", ",", "'", "_", "'", ",", "'", "'", "}", ";", "private", "final", "static", "char", "[", "]", "IMMUNE_HTMLATTR", "=", "{", "'", ",'", ",", "'", ".'", ",", "'", "-'", ",", "'", "_", "'", "}", ";", "private", "final", "static", "char", "[", "]", "IMMUNE_CSS", "=", "{", "};", "private", "final", "static", "char", "[", "]", "IMMUNE_JAVASCRIPT", "=", "{", "'", ",'", ",", "'", ".'", ",", "'", "_", "'", "}", ";", "private", "final", "static", "char", "[", "]", "IMMUNE_VBSCRIPT", "=", "{", "'", ",'", ",", "'", ".'", ",", "'", "_", "'", "}", ";", "private", "final", "static", "char", "[", "]", "IMMUNE_XML", "=", "{", "'", ",'", ",", "'", ".'", ",", "'", "-'", ",", "'", "_", "'", ",", "'", "'", "}", ";", "private", "final", "static", "char", "[", "]", "IMMUNE_SQL", "=", "{", "'", "'", "}", ";", "private", "final", "static", "char", "[", "]", "IMMUNE_OS", "=", "{", "'", "-'", "}", ";", "private", "final", "static", "char", "[", "]", "IMMUNE_XMLATTR", "=", "{", "'", ",'", ",", "'", ".'", ",", "'", "-'", ",", "'", "_", "'", "}", ";", "private", "final", "static", "char", "[", "]", "IMMUNE_XPATH", "=", "{", "'", ",'", ",", "'", ".'", ",", "'", "-'", ",", "'", "_", "'", ",", "'", "'", "}", ";", "private", "final", "static", "char", "[", "]", "IMMUNE_PERCENT", "=", "{", "'", "%'", "}", ";", "/", "/", "These", "are", "inline", "in", "the", "encode", "methods", ",", "but", "same", "principle", ".", "/", "/", "private", "final", "static", "char", "[", "]", "IMMUNE_LDAP", "=", "{", "'", "\\\\", "',", "'", "*'", ",", "'", "('", ",", "'", ")'", ",", "'", "\\", "0", "'", "}", ";", "/", "/", "private", "final", "static", "char", "[", "]", "IMMUNE_DN", "=", "{", "'", "\\\\", "',", "'", ",'", ",", "'", "+'", ",", "'", "\"'", ",", "'", "<'", ",", "'", ">'", ",", "'", ";'", "}", ";", "@", "Parameters", "(", "name", "=", "\"", "{", "0", "}", "\")", "public", "static", "Collection", "<", "Object", "[", "]>", "getParams", "(", ")", "{", "Collection", "<", "Codec", ">", "knownCodecs", "=", "new", "ArrayList", "<", "Codec", ">", "()", ";", "knownCodecs", ".", "add", "(", "new", "CSSCodec", "(", "))", ";", "knownCodecs", ".", "add", "(", "new", "DB2Codec", "(", "))", ";", "knownCodecs", ".", "add", "(", "new", "HTMLEntityCodec", "(", "))", ";", "knownCodecs", ".", "add", "(", "new", "JavaScriptCodec", "(", "))", ";", "knownCodecs", ".", "add", "(", "new", "MySQLCodec", "(", "0", ")", ");", "/", "/", "Standard", "knownCodecs", ".", "add", "(", "new", "MySQLCodec", "(", "1", ")", ");", "/", "/", "ANSI", "knownCodecs", ".", "add", "(", "new", "OracleCodec", "(", "))", ";", "knownCodecs", ".", "add", "(", "new", "PercentCodec", "(", "))", ";", "knownCodecs", ".", "add", "(", "new", "UnixCodec", "(", "))", ";", "knownCodecs", ".", "add", "(", "new", "VBScriptCodec", "(", "))", ";", "knownCodecs", ".", "add", "(", "new", "WindowsCodec", "(", "))", ";", "knownCodecs", ".", "add", "(", "new", "XMLEntityCodec", "(", "))", ";", "/", "/", "TODO", ":", "Add", "more", "strings", "here", "!", "!", "List", "<", "String", ">", "sampleStrings", "=", "Arrays", ".", "asList", "(", "\"%", "De", "\"", ");", "Collection", "<", "Object", "[", "]>", "params", "=", "new", "ArrayList", "<", "Object", "[", "]>", "()", ";", "for", "(", "Codec", "codec", ":", "knownCodecs", ")", "{", "for", "(", "String", "sample", ":", "sampleStrings", ")", "{", "params", ".", "add", "(", "new", "Object", "[", "]{", "codec", ".", "getClass", "(", ").", "getSimpleName", "(", ")", "+", "\"", "\"", "+", "sample", ",", "codec", ",", "sample", "}", ");", "}", "}", "/", "/", "Add", "Tests", "for", "codecs", "against", "the", "configured", "ImmunityLists", "within", "the", "Default", "Encoder", ".", "params", ".", "addAll", "(", "buildImmunitiyValidation", "(", "new", "HTMLEntityCodec", "(", "),", "IMMUNE_HTML", ",", "\"", "IMMUNE_HTML", "\"", "))", ";", "params", ".", "addAll", "(", "buildImmunitiyValidation", "(", "new", "HTMLEntityCodec", "(", "),", "IMMUNE_XPATH", ",", "\"", "IMMUNE_XPATH", "\"", "))", ";", "params", ".", "addAll", "(", "buildImmunitiyValidation", "(", "new", "HTMLEntityCodec", "(", "),", "IMMUNE_HTMLATTR", ",", "\"", "IMMUNE_HTMLATTR", "\"", "))", ";", "params", ".", "addAll", "(", "buildImmunitiyValidation", "(", "new", "CSSCodec", "(", "),", "IMMUNE_CSS", ",", "\"", "IMMUNE_CSS", "\"", "))", ";", "/", "/", "params", ".", "addAll", "(", "buildImmunitiyValidation", "(", "new", "DB2Codec", "(", "),", "IMMUNE_HTML", ",", "\"", "\")", ");", "params", ".", "addAll", "(", "buildImmunitiyValidation", "(", "new", "JavaScriptCodec", "(", "),", "IMMUNE_JAVASCRIPT", ",", "\"", "IMMUNE_JAVASCRIPT", "\"", "))", ";", "params", ".", "addAll", "(", "buildImmunitiyValidation", "(", "new", "MySQLCodec", "(", "0", ")", ",", "IMMUNE_SQL", ",", "\"", "IMMUNE_SQL", "\"", "))", ";", "params", ".", "addAll", "(", "buildImmunitiyValidation", "(", "new", "MySQLCodec", "(", "1", ")", ",", "IMMUNE_SQL", ",", "\"", "IMMUNE_SQL", "\"", "))", ";", "params", ".", "addAll", "(", "buildImmunitiyValidation", "(", "new", "OracleCodec", "(", "),", "IMMUNE_HTML", ",", "\"", "IMMUNE_HTML", "\"", "))", ";", "/", "/", "No", "standard", "Immunity", "char", "array", "defined", "for", "PercentEncoder", ",", "but", "for", "/", "/", "GitHub", "issues", "#", "306", "and", "$", "350", ",", "we", "use", "'", "%'", ".", "params", ".", "addAll", "(", "buildImmunitiyValidation", "(", "new", "PercentCodec", "(", "),", "IMMUNE_PERCENT", ",", "\"", "IMMUNE_PERCENT", "\"", "))", ";", "params", ".", "addAll", "(", "buildImmunitiyValidation", "(", "new", "UnixCodec", "(", "),", "IMMUNE_OS", ",", "\"", "IMMUNE_OS", "\"", "))", ";", "params", ".", "addAll", "(", "buildImmunitiyValidation", "(", "new", "VBScriptCodec", "(", "),", "IMMUNE_VBSCRIPT", ",", "\"", "IMMUNE_VBSCRIPT", "\"", "))", ";", "params", ".", "addAll", "(", "buildImmunitiyValidation", "(", "new", "WindowsCodec", "(", "),", "IMMUNE_OS", ",", "\"", "IMMUNE_OS", "\"", "))", ";", "params", ".", "addAll", "(", "buildImmunitiyValidation", "(", "new", "XMLEntityCodec", "(", "),", "IMMUNE_XML", ",", "\"", "IMMUNE_XML", "\"", "))", ";", "params", ".", "addAll", "(", "buildImmunitiyValidation", "(", "new", "XMLEntityCodec", "(", "),", "IMMUNE_XMLATTR", ",", "\"", "IMMUNE_XMLATTR", "\"", "))", ";", "params", ".", "addAll", "(", "fullCharacterCodecValidation", "(", "knownCodecs", ")", ");", "return", "params", ";", "}", "private", "static", "Collection", "<", "Object", "[", "]>", "buildImmunitiyValidation", "(", "Codec", "codec", ",", "char", "[", "]", "immunities", ",", "String", "descriptor", ")", "{", "Collection", "<", "Object", "[", "]>", "params", "=", "new", "ArrayList", "<", "Object", "[", "]>", "()", ";", "for", "(", "char", "c", ":", "immunities", ")", "{", "params", ".", "add", "(", "new", "Object", "[", "]{", "codec", ".", "getClass", "(", ").", "getSimpleName", "(", ")", "+", "\"", "\"", "+", "descriptor", "+", "\"", "(", "\"+", "c", "+", "\"", ")\"", ",", "codec", ",", "String", ".", "valueOf", "(", "c", ")", "})", ";", "}", "return", "params", ";", "}", "private", "static", "Collection", "<", "Object", "[", "]>", "fullCharacterCodecValidation", "(", "Collection", "<", "Codec", ">", "codecs", ")", "{", "char", "[", "]", "holyCowTesting", "=", "StringUtilities", ".", "union", "(", "EncoderConstants", ".", "CHAR_ALPHANUMERICS", ",", "EncoderConstants", ".", "CHAR_SPECIALS", ")", ";", "Collection", "<", "Object", "[", "]>", "params", "=", "new", "ArrayList", "<", "Object", "[", "]>", "()", ";", "for", "(", "Codec", "codec", ":", "codecs", ")", "{", "params", ".", "addAll", "(", "buildImmunitiyValidation", "(", "codec", ",", "holyCowTesting", ",", "\"", "Full_ALPHA_AND_SPECIALS", "\"", "))", ";", "}", "return", "params", ";", "}", "private", "final", "Codec", "codec", ";", "private", "final", "String", "string", ";", "private", "final", "char", "[", "]", "immunityList", ";", "public", "CodecImmunityTest", "(", "String", "ignored", ",", "Codec", "codec", ",", "String", "toTest", ")", "{", "this", ".", "codec", "=", "codec", ";", "this", ".", "string", "=", "toTest", ";", "/", "**", "*", "The", "Immunity", "character", "array", "is", "every", "character", "in", "the", "String", "we", "'", "re", "testing", ".", "*", "*", "/", "this", ".", "immunityList", "=", "toTest", ".", "toCharArray", "(", ");", "}", "@", "Test", "public", "void", "testImmuneEncode", "(", ")", "{", "String", "encoded", "=", "codec", ".", "encode", "(", "immunityList", ",", "string", ")", ";", "Assert", ".", "assertEquals", "(", "string", ",", "encoded", ")", ";", "}", "/", "*", "@", "Test", "public", "void", "testImmuneDecode", "(", ")", "{", "String", "decoded", "=", "codec", ".", "decode", "(", "string", ")", ";", "Assert", ".", "assertEquals", "(", "string", ",", "decoded", ")", ";", "}", "*", "/", "}"], "docstring_tokens": ["the", "failure", "to", "properly", "resist", "tampering", "with", "serialized", "ciphertext"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "57", ",", "7", "+", "57", ",", "8", "@", "@", "extern", "pmd_t", "*", "page_check_address_pmd", "(", "struct", "page", "*", "page", ",", "(", "transparent_hugepage_flags", "&", "\\", "(", "1", "<", "<", "TRANSPARENT_HUGEPAGE_REQ_MADV_FLAG", ")", "&", "&", "\\", "(", "(", "__vma", ")", "->", "vm_flags", "&", "VM_HUGEPAGE", ")", "))", "&", "&", "\\", "!", "((", "__vma", ")", "->", "vm_flags", "&", "VM_NOHUGEPAGE", ")", ")", "!", "((", "__vma", ")", "->", "vm_flags", "&", "VM_NOHUGEPAGE", ")", "&", "&", "\\", "!", "is_vma_temporary_stack", "(", "__vma", ")", ")", "#", "define", "transparent_hugepage_defrag", "(", "__vma", ")", "\\", "(", "(", "transparent_hugepage_flags", "&", "\\", "(", "1", "<", "<", "TRANSPARENT_HUGEPAGE_DEFRAG_FLAG", ")", ")", "|", "|", "\\", "@", "@", "-", "1811", ",", "6", "+", "1811", ",", "8", "@", "@", "static", "void", "collapse_huge_page", "(", "struct", "mm_struct", "*", "mm", ",", "/", "*", "VM_PFNMAP", "vmas", "may", "have", "vm_ops", "null", "but", "vm_file", "set", "*", "/", "if", "(", "!", "vma", "-", ">", "anon_vma", "|", "|", "vma", "-", ">", "vm_ops", "|", "|", "vma", "-", ">", "vm_file", ")", "goto", "out", ";", "if", "(", "is_vma_temporary_stack", "(", "vma", ")", ")", "goto", "out", ";", "VM_BUG_ON", "(", "is_linear_pfn_mapping", "(", "vma", ")", "|", "|", "is_pfn_mapping", "(", "vma", ")", ");", "pgd", "=", "pgd_offset", "(", "mm", ",", "address", ")", ";", "@", "@", "-", "2032", ",", "32", "+", "2034", ",", "27", "@", "@", "static", "unsigned", "int", "khugepaged_scan_mm_slot", "(", "unsigned", "int", "pages", ",", "if", "(", "(!", "(", "vma", "-", ">", "vm_flags", "&", "VM_HUGEPAGE", ")", "&", "&", "!", "khugepaged_always", "(", "))", "|", "|", "(", "vma", "-", ">", "vm_flags", "&", "VM_NOHUGEPAGE", ")", ")", "{", "skip", ":", "progress", "+", "+;", "continue", ";", "}", "/", "*", "VM_PFNMAP", "vmas", "may", "have", "vm_ops", "null", "but", "vm_file", "set", "*", "/", "if", "(", "!", "vma", "-", ">", "anon_vma", "|", "|", "vma", "-", ">", "vm_ops", "|", "|", "vma", "-", ">", "vm_file", ")", "{", "khugepaged_scan", ".", "address", "=", "vma", "-", ">", "vm_end", ";", "progress", "+", "+;", "continue", ";", "}", "if", "(", "!", "vma", "-", ">", "anon_vma", "|", "|", "vma", "-", ">", "vm_ops", "|", "|", "vma", "-", ">", "vm_file", ")", "goto", "skip", ";", "if", "(", "is_vma_temporary_stack", "(", "vma", ")", ")", "goto", "skip", ";", "VM_BUG_ON", "(", "is_linear_pfn_mapping", "(", "vma", ")", "|", "|", "is_pfn_mapping", "(", "vma", ")", ");", "hstart", "=", "(", "vma", "-", ">", "vm_start", "+", "~", "HPAGE_PMD_MASK", ")", "&", "HPAGE_PMD_MASK", ";", "hend", "=", "vma", "-", ">", "vm_end", "&", "HPAGE_PMD_MASK", ";", "if", "(", "hstart", ">", "=", "hend", ")", "{", "progress", "+", "+;", "continue", ";", "}", "if", "(", "hstart", ">", "=", "hend", ")", "goto", "skip", ";", "if", "(", "khugepaged_scan", ".", "address", ">", "hend", ")", "goto", "skip", ";", "if", "(", "khugepaged_scan", ".", "address", "<", "hstart", ")", "khugepaged_scan", ".", "address", "=", "hstart", ";", "if", "(", "khugepaged_scan", ".", "address", ">", "hend", ")", "{", "khugepaged_scan", ".", "address", "=", "hend", "+", "HPAGE_PMD_SIZE", ";", "progress", "+", "+;", "continue", ";", "}", "BUG_ON", "(", "khugepaged_scan", ".", "address", "&", "~", "HPAGE_PMD_MASK", ")", ";", "VM_BUG_ON", "(", "khugepaged_scan", ".", "address", "&", "~", "HPAGE_PMD_MASK", ")", ";", "while", "(", "khugepaged_scan", ".", "address", "<", "hend", ")", "{", "int", "ret", ";", "@", "@", "-", "2086", ",", "7", "+", "2083", ",", "7", "@", "@", "static", "unsigned", "int", "khugepaged_scan_mm_slot", "(", "unsigned", "int", "pages", ",", "breakouterloop_mmap_sem", ":", "spin_lock", "(", "&", "khugepaged_mm_lock", ")", ";", "BUG_ON", "(", "khugepaged_scan", ".", "mm_slot", "!", "=", "mm_slot", ")", ";", "VM_BUG_ON", "(", "khugepaged_scan", ".", "mm_slot", "!", "=", "mm_slot", ")", ";", "/", "*", "*", "Release", "the", "current", "mm_slot", "if", "this", "mm", "is", "about", "to", "die", ",", "or", "*", "if", "we", "scanned", "all", "vmas", "of", "this", "mm", ".", "@", "@", "-", "2241", ",", "9", "+", "2238", ",", "9", "@", "@", "static", "int", "khugepaged", "(", "void", "*", "none", ")", "for", "(", ";;", ")", "{", "mutex_unlock", "(", "&", "khugepaged_mutex", ")", ";", "BUG_ON", "(", "khugepaged_thread", "!", "=", "current", ")", ";", "VM_BUG_ON", "(", "khugepaged_thread", "!", "=", "current", ")", ";", "khugepaged_loop", "(", ");", "BUG_ON", "(", "khugepaged_thread", "!", "=", "current", ")", ";", "VM_BUG_ON", "(", "khugepaged_thread", "!", "=", "current", ")", ";", "mutex_lock", "(", "&", "khugepaged_mutex", ")", ";", "if", "(", "!", "khugepaged_enabled", "(", "))"], "docstring_tokens": ["copying", "into", "the", "user", "stack"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "18", ",", "10", "+", "18", ",", "14", "@", "@", "package", "org", ".", "keycloak", ".", "common", ".", "util", ";", "import", "java", ".", "io", ".", "UnsupportedEncodingException", ";", "import", "java", ".", "net", ".", "MalformedURLException", ";", "import", "java", ".", "net", ".", "URI", ";", "import", "java", ".", "net", ".", "URL", ";", "import", "java", ".", "net", ".", "URLDecoder", ";", "import", "java", ".", "util", ".", "regex", ".", "Pattern", ";", "import", "org", ".", "keycloak", ".", "common", ".", "enums", ".", "SslRequired", ";", "/", "**", "*", "@", "author", "<", "a", "href", "=", "\"", "mailto", ":", "sthorger", "@", "redhat", ".", "com", "\"", ">", "Stian", "Thorgersen", "<", "/", "a", ">", "*", "/", "@", "@", "-", "84", ",", "4", "+", "88", ",", "28", "@", "@", "public", "static", "boolean", "isOrigin", "(", "String", "url", ")", "{", "public", "static", "String", "stripQueryParam", "(", "String", "url", ",", "String", "name", ")", "{", "return", "url", ".", "replaceFirst", "(", "\"[", "\\\\", "?&", "]\"", "+", "name", "+", "\"=", "[^", "&]", "*$", "|\"", "+", "name", "+", "\"=", "[^", "&]", "*&", "\",", "\"", "\")", ";", "}", "public", "static", "void", "checkUrl", "(", "SslRequired", "sslRequired", ",", "String", "url", ",", "String", "name", ")", "throws", "IllegalArgumentException", "{", "if", "(", "url", "=", "=", "null", ")", "{", "return", ";", "}", "URL", "parsed", ";", "try", "{", "parsed", "=", "new", "URL", "(", "url", ")", ";", "}", "catch", "(", "MalformedURLException", "e", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "The", "url", "[", "\"", "+", "name", "+", "\"", "]", "is", "malformed", "\"", ",", "e", ")", ";", "}", "String", "protocol", "=", "parsed", ".", "getProtocol", "(", ").", "toLowerCase", "(", ");", "if", "(", "!(", "\"", "http", "\"", ".", "equalsIgnoreCase", "(", "protocol", ")", "|", "|", "\"", "https", "\"", ".", "equalsIgnoreCase", "(", "protocol", ")", "))", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "Invalid", "protocol", "/", "scheme", "for", "url", "[", "\"", "+", "name", "+", "\"", "]\"", ");", "}", "if", "(", "!\"", "https", "\"", ".", "equals", "(", "protocol", ")", "&", "&", "sslRequired", ".", "isRequired", "(", "url", ")", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "The", "url", "[", "\"", "+", "name", "+", "\"", "]", "requires", "secure", "connections", "\"", ");", "}", "}", "}", "@", "@", "-", "54", ",", "4", "+", "54", ",", "14", "@", "@", "*", "@", "return", "*", "/", "Map", "<", "String", ",", "String", ">", "parseConfig", "(", "KeycloakSession", "session", ",", "InputStream", "inputStream", ")", ";", "/", "**", "*", "<", "p", ">", "Creates", "a", "provider", "specific", "{", "@", "link", "IdentityProviderModel", "}", "instance", ".", "*", "*", "<", "p", ">", "Providers", "may", "want", "to", "implement", "their", "own", "{", "@", "link", "IdentityProviderModel", "}", "type", "so", "that", "validations", "*", "can", "be", "performed", "when", "managing", "the", "provider", "configuration", "*", "*", "@", "return", "the", "provider", "specific", "instance", "*", "/", "<", "C", "extends", "IdentityProviderModel", ">", "C", "createConfig", "(", ");", "}", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "49", ",", "6", "+", "49", ",", "9", "@", "@", "import", "org", ".", "keycloak", ".", "authorization", ".", "store", ".", "ResourceStore", ";", "import", "org", ".", "keycloak", ".", "authorization", ".", "store", ".", "ScopeStore", ";", "import", "org", ".", "keycloak", ".", "authorization", ".", "store", ".", "StoreFactory", ";", "import", "org", ".", "keycloak", ".", "broker", ".", "provider", ".", "IdentityProvider", ";", "import", "org", ".", "keycloak", ".", "broker", ".", "provider", ".", "IdentityProviderFactory", ";", "import", "org", ".", "keycloak", ".", "broker", ".", "social", ".", "SocialIdentityProvider", ";", "import", "org", ".", "keycloak", ".", "common", ".", "enums", ".", "SslRequired", ";", "import", "org", ".", "keycloak", ".", "common", ".", "util", ".", "MultivaluedHashMap", ";", "import", "org", ".", "keycloak", ".", "common", ".", "util", ".", "UriUtils", ";", "@", "@", "-", "285", ",", "7", "+", "288", ",", "7", "@", "@", "public", "static", "void", "importRealm", "(", "KeycloakSession", "session", ",", "RealmRepresentation", "rep", ",", "DefaultRequiredActions", ".", "addActions", "(", "newRealm", ")", ";", "}", "importIdentityProviders", "(", "rep", ",", "newRealm", ")", ";", "importIdentityProviders", "(", "rep", ",", "newRealm", ",", "session", ")", ";", "importIdentityProviderMappers", "(", "rep", ",", "newRealm", ")", ";", "Map", "<", "String", ",", "ClientScopeModel", ">", "clientScopes", "=", "new", "HashMap", "<", ">(", ");", "@", "@", "-", "1856", ",", "10", "+", "1859", ",", "10", "@", "@", "public", "static", "void", "createClientRoleMappings", "(", "ClientModel", "clientModel", ",", "UserModel", "u", "}", "}", "private", "static", "void", "importIdentityProviders", "(", "RealmRepresentation", "rep", ",", "RealmModel", "newRealm", ")", "{", "private", "static", "void", "importIdentityProviders", "(", "RealmRepresentation", "rep", ",", "RealmModel", "newRealm", ",", "KeycloakSession", "session", ")", "{", "if", "(", "rep", ".", "getIdentityProviders", "(", ")", "!", "=", "null", ")", "{", "for", "(", "IdentityProviderRepresentation", "representation", ":", "rep", ".", "getIdentityProviders", "(", "))", "{", "newRealm", ".", "addIdentityProvider", "(", "toModel", "(", "newRealm", ",", "representation", ")", ");", "newRealm", ".", "addIdentityProvider", "(", "toModel", "(", "newRealm", ",", "representation", ",", "session", ")", ");", "}", "}", "}", "@", "@", "-", "1872", ",", "8", "+", "1875", ",", "20", "@", "@", "private", "static", "void", "importIdentityProviderMappers", "(", "RealmRepresentation", "rep", ",", "Realm", "}", "}", "public", "static", "IdentityProviderModel", "toModel", "(", "RealmModel", "realm", ",", "IdentityProviderRepresentation", "representation", ")", "{", "IdentityProviderModel", "identityProviderModel", "=", "new", "IdentityProviderModel", "(", ");", "public", "static", "IdentityProviderModel", "toModel", "(", "RealmModel", "realm", ",", "IdentityProviderRepresentation", "representation", ",", "KeycloakSession", "session", ")", "{", "IdentityProviderFactory", "providerFactory", "=", "(", "IdentityProviderFactory", ")", "session", ".", "getKeycloakSessionFactory", "(", ").", "getProviderFactory", "(", "IdentityProvider", ".", "class", ",", "representation", ".", "getProviderId", "(", "))", ";", "if", "(", "providerFactory", "=", "=", "null", ")", "{", "providerFactory", "=", "(", "IdentityProviderFactory", ")", "session", ".", "getKeycloakSessionFactory", "(", ").", "getProviderFactory", "(", "SocialIdentityProvider", ".", "class", ",", "representation", ".", "getProviderId", "(", "))", ";", "}", "if", "(", "providerFactory", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "Invalid", "identity", "provider", "id", "[", "\"", "+", "representation", ".", "getProviderId", "(", ")", "+", "\"", "]\"", ");", "}", "IdentityProviderModel", "identityProviderModel", "=", "providerFactory", ".", "createConfig", "(", ");", "identityProviderModel", ".", "setInternalId", "(", "representation", ".", "getInternalId", "(", "))", ";", "identityProviderModel", ".", "setAlias", "(", "representation", ".", "getAlias", "(", "))", ";", "@", "@", "-", "1908", ",", "6", "+", "1923", ",", "8", "@", "@", "public", "static", "IdentityProviderModel", "toModel", "(", "RealmModel", "realm", ",", "IdentityProviderRe", "}", "identityProviderModel", ".", "setPostBrokerLoginFlowId", "(", "flowModel", ".", "getId", "(", "))", ";", "}", "identityProviderModel", ".", "validate", "(", "realm", ")", ";", "return", "identityProviderModel", ";", "}", "@", "@", "-", "196", ",", "5", "+", "196", ",", "15", "@", "@", "public", "String", "getDisplayName", "(", ")", "{", "public", "void", "setDisplayName", "(", "String", "displayName", ")", "{", "this", ".", "displayName", "=", "displayName", ";", "}", "/", "**", "*", "<", "p", ">", "Validates", "this", "configuration", ".", "*", "*", "<", "p", ">", "Sub", "-", "classes", "can", "override", "this", "method", "in", "order", "to", "enforce", "provider", "specific", "validations", ".", "*", "*", "@", "param", "realm", "the", "realm", "*", "/", "public", "void", "validate", "(", "RealmModel", "realm", ")", "{", "}", "}", "@", "@", "-", "48", ",", "7", "+", "48", ",", "10", "@", "@", "public", "String", "getId", "(", ")", "{", "@", "Override", "public", "Map", "<", "String", ",", "String", ">", "parseConfig", "(", "KeycloakSession", "session", ",", "InputStream", "inputStream", ")", "{", "return", "OIDCIdentityProviderFactory", ".", "parseOIDCConfig", "(", "session", ",", "inputStream", ")", ";", "}", "}", "@", "Override", "public", "OIDCIdentityProviderConfig", "createConfig", "(", ")", "{", "return", "new", "OIDCIdentityProviderConfig", "(", ");", "}", "}", "@", "@", "-", "16", ",", "7", "+", "16", ",", "12", "@", "@", "*", "/", "package", "org", ".", "keycloak", ".", "broker", ".", "oidc", ";", "import", "static", "org", ".", "keycloak", ".", "common", ".", "util", ".", "UriUtils", ".", "checkUrl", ";", "import", "org", ".", "keycloak", ".", "common", ".", "enums", ".", "SslRequired", ";", "import", "org", ".", "keycloak", ".", "models", ".", "IdentityProviderModel", ";", "import", "org", ".", "keycloak", ".", "models", ".", "KeycloakSession", ";", "import", "org", ".", "keycloak", ".", "models", ".", "RealmModel", ";", "import", "org", ".", "keycloak", ".", "protocol", ".", "oidc", ".", "OIDCLoginProtocol", ";", "/", "**", "@", "@", "-", "28", ",", "6", "+", "33", ",", "10", "@", "@", "public", "OAuth2IdentityProviderConfig", "(", "IdentityProviderModel", "model", ")", "{", "super", "(", "model", ")", ";", "}", "public", "OAuth2IdentityProviderConfig", "(", ")", "{", "super", "(", ");", "}", "public", "String", "getAuthorizationUrl", "(", ")", "{", "return", "getConfig", "(", ").", "get", "(", "\"", "authorizationUrl", "\"", ");", "}", "@", "@", "-", "123", ",", "4", "+", "132", ",", "13", "@", "@", "public", "String", "getForwardParameters", "(", ")", "{", "public", "void", "setForwardParameters", "(", "String", "forwardParameters", ")", "{", "getConfig", "(", ").", "put", "(", "\"", "forwardParameters", "\"", ",", "forwardParameters", ")", ";", "}", "@", "Override", "public", "void", "validate", "(", "RealmModel", "realm", ")", "{", "SslRequired", "sslRequired", "=", "realm", ".", "getSslRequired", "(", ");", "checkUrl", "(", "sslRequired", ",", "getAuthorizationUrl", "(", "),", "\"", "authorization_url", "\"", ");", "checkUrl", "(", "sslRequired", ",", "getTokenUrl", "(", "),", "\"", "token_url", "\"", ");", "checkUrl", "(", "sslRequired", ",", "getUserInfoUrl", "(", "),", "\"", "userinfo_url", "\"", ");", "}", "}", "@", "@", "-", "16", ",", "7", "+", "16", ",", "12", "@", "@", "*", "/", "package", "org", ".", "keycloak", ".", "broker", ".", "oidc", ";", "import", "static", "org", ".", "keycloak", ".", "common", ".", "util", ".", "UriUtils", ".", "checkUrl", ";", "import", "org", ".", "keycloak", ".", "common", ".", "enums", ".", "SslRequired", ";", "import", "org", ".", "keycloak", ".", "models", ".", "IdentityProviderModel", ";", "import", "org", ".", "keycloak", ".", "models", ".", "KeycloakSession", ";", "import", "org", ".", "keycloak", ".", "models", ".", "RealmModel", ";", "/", "**", "*", "@", "author", "Pedro", "Igor", "@", "@", "-", "33", ",", "6", "+", "38", ",", "10", "@", "@", "public", "OIDCIdentityProviderConfig", "(", "IdentityProviderModel", "identityProviderModel", ")", "{", "super", "(", "identityProviderModel", ")", ";", "}", "public", "OIDCIdentityProviderConfig", "(", ")", "{", "super", "(", ");", "}", "public", "String", "getPrompt", "(", ")", "{", "return", "getConfig", "(", ").", "get", "(", "\"", "prompt", "\"", ");", "}", "@", "@", "-", "122", ",", "4", "+", "131", ",", "12", "@", "@", "public", "int", "getAllowedClockSkew", "(", ")", "{", "return", "0", ";", "}", "}", "@", "Override", "public", "void", "validate", "(", "RealmModel", "realm", ")", "{", "super", ".", "validate", "(", "realm", ")", ";", "SslRequired", "sslRequired", "=", "realm", ".", "getSslRequired", "(", ");", "checkUrl", "(", "sslRequired", ",", "getJwksUrl", "(", "),", "\"", "jwks_url", "\"", ");", "checkUrl", "(", "sslRequired", ",", "getLogoutUrl", "(", "),", "\"", "logout_url", "\"", ");", "}", "}", "@", "@", "-", "43", ",", "6", "+", "43", ",", "11", "@", "@", "public", "OIDCIdentityProvider", "create", "(", "KeycloakSession", "session", ",", "IdentityProviderMode", "return", "new", "OIDCIdentityProvider", "(", "session", ",", "new", "OIDCIdentityProviderConfig", "(", "model", ")", ");", "}", "@", "Override", "public", "OIDCIdentityProviderConfig", "createConfig", "(", ")", "{", "return", "new", "OIDCIdentityProviderConfig", "(", ");", "}", "@", "Override", "public", "String", "getId", "(", ")", "{", "return", "PROVIDER_ID", ";", "@", "@", "-", "60", ",", "7", "+", "65", ",", "7", "@", "@", "public", "String", "getId", "(", ")", "{", "}", "catch", "(", "IOException", "e", ")", "{", "throw", "new", "RuntimeException", "(", "\"", "failed", "to", "load", "openid", "connect", "metadata", "\"", ",", "e", ")", ";", "}", "OIDCIdentityProviderConfig", "config", "=", "new", "OIDCIdentityProviderConfig", "(", "new", "IdentityProviderModel", "(", "))", ";", "OIDCIdentityProviderConfig", "config", "=", "new", "OIDCIdentityProviderConfig", "(", ");", "config", ".", "setIssuer", "(", "rep", ".", "getIssuer", "(", "))", ";", "config", ".", "setLogoutUrl", "(", "rep", ".", "getLogoutEndpoint", "(", "))", ";", "config", ".", "setAuthorizationUrl", "(", "rep", ".", "getAuthorizationEndpoint", "(", "))", ";", "@", "@", "-", "16", ",", "8", "+", "16", ",", "13", "@", "@", "*", "/", "package", "org", ".", "keycloak", ".", "broker", ".", "saml", ";", "import", "static", "org", ".", "keycloak", ".", "common", ".", "util", ".", "UriUtils", ".", "checkUrl", ";", "import", "org", ".", "keycloak", ".", "common", ".", "enums", ".", "SslRequired", ";", "import", "org", ".", "keycloak", ".", "models", ".", "IdentityProviderModel", ";", "import", "org", ".", "keycloak", ".", "models", ".", "KeycloakSession", ";", "import", "org", ".", "keycloak", ".", "models", ".", "RealmModel", ";", "import", "org", ".", "keycloak", ".", "protocol", ".", "saml", ".", "SamlPrincipalType", ";", "import", "org", ".", "keycloak", ".", "saml", ".", "common", ".", "util", ".", "XmlKeyInfoKeyNameTransformer", ";", "@", "@", "-", "276", ",", "4", "+", "281", ",", "11", "@", "@", "public", "void", "setPrincipalAttribute", "(", "String", "principalAttribute", ")", "{", "getConfig", "(", ").", "put", "(", "PRINCIPAL_ATTRIBUTE", ",", "principalAttribute", ")", ";", "}", "@", "Override", "public", "void", "validate", "(", "RealmModel", "realm", ")", "{", "SslRequired", "sslRequired", "=", "realm", ".", "getSslRequired", "(", ");", "checkUrl", "(", "sslRequired", ",", "getSingleLogoutServiceUrl", "(", "),", "SINGLE_LOGOUT_SERVICE_URL", ")", ";", "checkUrl", "(", "sslRequired", ",", "getSingleSignOnServiceUrl", "(", "),", "SINGLE_SIGN_ON_SERVICE_URL", ")", ";", "}", "}", "@", "@", "-", "58", ",", "6", "+", "58", ",", "11", "@", "@", "public", "SAMLIdentityProvider", "create", "(", "KeycloakSession", "session", ",", "IdentityProviderMode", "return", "new", "SAMLIdentityProvider", "(", "session", ",", "new", "SAMLIdentityProviderConfig", "(", "model", ")", ",", "destinationValidator", ")", ";", "}", "@", "Override", "public", "SAMLIdentityProviderConfig", "createConfig", "(", ")", "{", "return", "new", "SAMLIdentityProviderConfig", "(", ");", "}", "@", "Override", "public", "Map", "<", "String", ",", "String", ">", "parseConfig", "(", "KeycloakSession", "session", ",", "InputStream", "inputStream", ")", "{", "try", "{", "@", "@", "-", "72", ",", "7", "+", "72", ",", "7", "@", "@", "public", "void", "remove", "(", "RealmModel", "realm", ",", "KeycloakSession", "session", ",", "IdentityProviderRe", "@", "Override", "public", "void", "create", "(", "RealmModel", "realm", ",", "KeycloakSession", "session", ",", "IdentityProviderRepresentation", "idpRep", ")", "{", "idpRep", ".", "setInternalId", "(", "KeycloakModelUtils", ".", "generateId", "(", "))", ";", "IdentityProviderModel", "identityProvider", "=", "RepresentationToModel", ".", "toModel", "(", "realm", ",", "idpRep", ")", ";", "IdentityProviderModel", "identityProvider", "=", "RepresentationToModel", ".", "toModel", "(", "realm", ",", "idpRep", ",", "session", ")", ";", "realm", ".", "addIdentityProvider", "(", "identityProvider", ")", ";", "}", "@", "@", "-", "16", ",", "6", "+", "16", ",", "8", "@", "@", "*", "/", "package", "org", ".", "keycloak", ".", "services", ".", "resources", ".", "admin", ";", "import", "static", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Response", ".", "Status", ".", "BAD_REQUEST", ";", "import", "org", ".", "jboss", ".", "logging", ".", "Logger", ";", "import", "org", ".", "jboss", ".", "resteasy", ".", "annotations", ".", "cache", ".", "NoCache", ";", "import", "javax", ".", "ws", ".", "rs", ".", "NotFoundException", ";", "@", "@", "-", "162", ",", "6", "+", "164", ",", "8", "@", "@", "public", "Response", "update", "(", "IdentityProviderRepresentation", "providerRep", ")", "{", "adminEvent", ".", "operation", "(", "OperationType", ".", "UPDATE", ")", ".", "resourcePath", "(", "session", ".", "getContext", "(", ").", "getUri", "(", "))", ".", "representation", "(", "providerRep", ")", ".", "success", "(", ");", "return", "Response", ".", "noContent", "(", ").", "build", "(", ");", "}", "catch", "(", "IllegalArgumentException", "e", ")", "{", "return", "ErrorResponse", ".", "error", "(", "\"", "Invalid", "request", "\"", ",", "BAD_REQUEST", ")", ";", "}", "catch", "(", "ModelDuplicateException", "e", ")", "{", "return", "ErrorResponse", ".", "exists", "(", "\"", "Identity", "Provider", "\"", "+", "providerRep", ".", "getAlias", "(", ")", "+", "\"", "already", "exists", "\"", ");", "}", "@", "@", "-", "176", ",", "7", "+", "180", ",", "7", "@", "@", "private", "void", "updateIdpFromRep", "(", "IdentityProviderRepresentation", "providerRep", ",", "RealmM", "lookUpProviderIdByAlias", "(", "realm", ",", "providerRep", ")", ";", "}", "IdentityProviderModel", "updated", "=", "RepresentationToModel", ".", "toModel", "(", "realm", ",", "providerRep", ")", ";", "IdentityProviderModel", "updated", "=", "RepresentationToModel", ".", "toModel", "(", "realm", ",", "providerRep", ",", "session", ")", ";", "if", "(", "updated", ".", "getConfig", "(", ")", "!", "=", "null", "&", "&", "ComponentRepresentation", ".", "SECRET_VALUE", ".", "equals", "(", "updated", ".", "getConfig", "(", ").", "get", "(", "\"", "clientSecret", "\"", "))", ")", "{", "updated", ".", "getConfig", "(", ").", "put", "(", "\"", "clientSecret", "\"", ",", "identityProviderModel", ".", "getConfig", "(", ")", "!", "=", "null", "?", "identityProviderModel", ".", "getConfig", "(", ").", "get", "(", "\"", "clientSecret", "\"", ")", ":", "null", ")", ";", "@", "@", "-", "183", ",", "14", "+", "183", ",", "16", "@", "@", "public", "Response", "create", "(", "IdentityProviderRepresentation", "representation", ")", "{", "this", ".", "auth", ".", "realm", "(", ").", "requireManageIdentityProviders", "(", ");", "try", "{", "IdentityProviderModel", "identityProvider", "=", "RepresentationToModel", ".", "toModel", "(", "realm", ",", "representation", ")", ";", "IdentityProviderModel", "identityProvider", "=", "RepresentationToModel", ".", "toModel", "(", "realm", ",", "representation", ",", "session", ")", ";", "this", ".", "realm", ".", "addIdentityProvider", "(", "identityProvider", ")", ";", "representation", ".", "setInternalId", "(", "identityProvider", ".", "getInternalId", "(", "))", ";", "adminEvent", ".", "operation", "(", "OperationType", ".", "CREATE", ")", ".", "resourcePath", "(", "session", ".", "getContext", "(", ").", "getUri", "(", "),", "identityProvider", ".", "getAlias", "(", "))", ".", "representation", "(", "StripSecretsUtils", ".", "strip", "(", "representation", ")", ").", "success", "(", ");", "return", "Response", ".", "created", "(", "session", ".", "getContext", "(", ").", "getUri", "(", ").", "getAbsolutePathBuilder", "(", ").", "path", "(", "representation", ".", "getAlias", "(", "))", ".", "build", "(", "))", ".", "build", "(", ");", "}", "catch", "(", "IllegalArgumentException", "e", ")", "{", "return", "ErrorResponse", ".", "error", "(", "\"", "Invalid", "request", "\"", ",", "BAD_REQUEST", ")", ";", "}", "catch", "(", "ModelDuplicateException", "e", ")", "{", "return", "ErrorResponse", ".", "exists", "(", "\"", "Identity", "Provider", "\"", "+", "representation", ".", "getAlias", "(", ")", "+", "\"", "already", "exists", "\"", ");", "}", "@", "@", "-", "39", ",", "6", "+", "39", ",", "11", "@", "@", "public", "BitbucketIdentityProvider", "create", "(", "KeycloakSession", "session", ",", "IdentityProvide", "return", "new", "BitbucketIdentityProvider", "(", "session", ",", "new", "OAuth2IdentityProviderConfig", "(", "model", ")", ");", "}", "@", "Override", "public", "OAuth2IdentityProviderConfig", "createConfig", "(", ")", "{", "return", "new", "OAuth2IdentityProviderConfig", "(", ");", "}", "@", "Override", "public", "String", "getId", "(", ")", "{", "return", "PROVIDER_ID", ";", "@", "@", "-", "39", ",", "6", "+", "39", ",", "11", "@", "@", "public", "FacebookIdentityProvider", "create", "(", "KeycloakSession", "session", ",", "IdentityProvider", "return", "new", "FacebookIdentityProvider", "(", "session", ",", "new", "OAuth2IdentityProviderConfig", "(", "model", ")", ");", "}", "@", "Override", "public", "OAuth2IdentityProviderConfig", "createConfig", "(", ")", "{", "return", "new", "OAuth2IdentityProviderConfig", "(", ");", "}", "@", "Override", "public", "String", "getId", "(", ")", "{", "return", "PROVIDER_ID", ";", "@", "@", "-", "39", ",", "6", "+", "39", ",", "11", "@", "@", "public", "GitHubIdentityProvider", "create", "(", "KeycloakSession", "session", ",", "IdentityProviderMo", "return", "new", "GitHubIdentityProvider", "(", "session", ",", "new", "OAuth2IdentityProviderConfig", "(", "model", ")", ");", "}", "@", "Override", "public", "OAuth2IdentityProviderConfig", "createConfig", "(", ")", "{", "return", "new", "OAuth2IdentityProviderConfig", "(", ");", "}", "@", "Override", "public", "String", "getId", "(", ")", "{", "return", "PROVIDER_ID", ";", "@", "@", "-", "16", ",", "7", "+", "16", ",", "6", "@", "@", "*", "/", "package", "org", ".", "keycloak", ".", "social", ".", "gitlab", ";", "import", "org", ".", "keycloak", ".", "broker", ".", "oidc", ".", "OAuth2IdentityProviderConfig", ";", "import", "org", ".", "keycloak", ".", "broker", ".", "oidc", ".", "OIDCIdentityProviderConfig", ";", "import", "org", ".", "keycloak", ".", "broker", ".", "provider", ".", "AbstractIdentityProviderFactory", ";", "import", "org", ".", "keycloak", ".", "broker", ".", "social", ".", "SocialIdentityProviderFactory", ";", "@", "@", "-", "40", ",", "6", "+", "39", ",", "11", "@", "@", "public", "GitLabIdentityProvider", "create", "(", "KeycloakSession", "session", ",", "IdentityProviderMo", "return", "new", "GitLabIdentityProvider", "(", "session", ",", "new", "OIDCIdentityProviderConfig", "(", "model", ")", ");", "}", "@", "Override", "public", "OIDCIdentityProviderConfig", "createConfig", "(", ")", "{", "return", "new", "OIDCIdentityProviderConfig", "(", ");", "}", "@", "Override", "public", "String", "getId", "(", ")", "{", "return", "PROVIDER_ID", ";", "@", "@", "-", "28", ",", "6", "+", "28", ",", "10", "@", "@", "public", "GoogleIdentityProviderConfig", "(", "IdentityProviderModel", "model", ")", "{", "super", "(", "model", ")", ";", "}", "public", "GoogleIdentityProviderConfig", "(", ")", "{", "}", "public", "boolean", "isUserIp", "(", ")", "{", "String", "userIp", "=", "getConfig", "(", ").", "get", "(", "\"", "userIp", "\"", ");", "return", "userIp", "=", "=", "null", "?", "false", ":", "Boolean", ".", "valueOf", "(", "userIp", ")", ";", "@", "@", "-", "16", ",", "7", "+", "16", ",", "6", "@", "@", "*", "/", "package", "org", ".", "keycloak", ".", "social", ".", "google", ";", "import", "org", ".", "keycloak", ".", "broker", ".", "oidc", ".", "OIDCIdentityProviderConfig", ";", "import", "org", ".", "keycloak", ".", "broker", ".", "provider", ".", "AbstractIdentityProviderFactory", ";", "import", "org", ".", "keycloak", ".", "models", ".", "IdentityProviderModel", ";", "import", "org", ".", "keycloak", ".", "broker", ".", "social", ".", "SocialIdentityProviderFactory", ";", "@", "@", "-", "39", ",", "6", "+", "38", ",", "11", "@", "@", "public", "GoogleIdentityProvider", "create", "(", "KeycloakSession", "session", ",", "IdentityProviderMo", "return", "new", "GoogleIdentityProvider", "(", "session", ",", "new", "GoogleIdentityProviderConfig", "(", "model", ")", ");", "}", "@", "Override", "public", "GoogleIdentityProviderConfig", "createConfig", "(", ")", "{", "return", "new", "GoogleIdentityProviderConfig", "(", ");", "}", "@", "Override", "public", "String", "getId", "(", ")", "{", "return", "PROVIDER_ID", ";", "@", "@", "-", "39", ",", "6", "+", "39", ",", "11", "@", "@", "public", "InstagramIdentityProvider", "create", "(", "KeycloakSession", "session", ",", "IdentityProvide", "return", "new", "InstagramIdentityProvider", "(", "session", ",", "new", "OAuth2IdentityProviderConfig", "(", "model", ")", ");", "}", "@", "Override", "public", "OAuth2IdentityProviderConfig", "createConfig", "(", ")", "{", "return", "new", "OAuth2IdentityProviderConfig", "(", ");", "}", "@", "Override", "public", "String", "getId", "(", ")", "{", "return", "PROVIDER_ID", ";", "@", "@", "-", "40", ",", "6", "+", "40", ",", "11", "@", "@", "public", "LinkedInIdentityProvider", "create", "(", "KeycloakSession", "session", ",", "IdentityProvider", "return", "new", "LinkedInIdentityProvider", "(", "session", ",", "new", "OAuth2IdentityProviderConfig", "(", "model", ")", ");", "}", "@", "Override", "public", "OAuth2IdentityProviderConfig", "createConfig", "(", ")", "{", "return", "new", "OAuth2IdentityProviderConfig", "(", ");", "}", "@", "Override", "public", "String", "getId", "(", ")", "{", "return", "PROVIDER_ID", ";", "@", "@", "-", "39", ",", "6", "+", "39", ",", "11", "@", "@", "public", "MicrosoftIdentityProvider", "create", "(", "KeycloakSession", "session", ",", "IdentityProvide", "return", "new", "MicrosoftIdentityProvider", "(", "session", ",", "new", "OAuth2IdentityProviderConfig", "(", "model", ")", ");", "}", "@", "Override", "public", "OAuth2IdentityProviderConfig", "createConfig", "(", ")", "{", "return", "new", "OAuth2IdentityProviderConfig", "(", ");", "}", "@", "Override", "public", "String", "getId", "(", ")", "{", "return", "PROVIDER_ID", ";", "@", "@", "-", "10", ",", "6", "+", "10", ",", "10", "@", "@", "public", "OpenshiftV3IdentityProviderConfig", "(", "IdentityProviderModel", "identityProviderM", "super", "(", "identityProviderModel", ")", ";", "}", "public", "OpenshiftV3IdentityProviderConfig", "(", ")", "{", "}", "public", "String", "getBaseUrl", "(", ")", "{", "return", "getConfig", "(", ").", "get", "(", "BASE_URL", ")", ";", "}", "@", "@", "-", "19", ",", "6", "+", "19", ",", "11", "@", "@", "public", "OpenshiftV3IdentityProvider", "create", "(", "KeycloakSession", "keycloakSession", ",", "Ident", "return", "new", "OpenshiftV3IdentityProvider", "(", "keycloakSession", ",", "new", "OpenshiftV3IdentityProviderConfig", "(", "identityProviderModel", ")", ");", "}", "@", "Override", "public", "OpenshiftV3IdentityProviderConfig", "createConfig", "(", ")", "{", "return", "new", "OpenshiftV3IdentityProviderConfig", "(", ");", "}", "@", "Override", "public", "String", "getId", "(", ")", "{", "return", "PROVIDER_ID", ";", "@", "@", "-", "19", ",", "6", "+", "19", ",", "9", "@", "@", "public", "OpenshiftV4IdentityProviderConfig", "(", "IdentityProviderModel", "identityProviderM", "super", "(", "identityProviderModel", ")", ";", "}", "public", "OpenshiftV4IdentityProviderConfig", "(", ")", "{", "}", "private", "String", "trimTrailingSlash", "(", "String", "baseUrl", ")", "{", "if", "(", "baseUrl", "!", "=", "null", "&", "&", "baseUrl", ".", "endsWith", "(", "\"/", "\")", ")", "{", "baseUrl", "=", "baseUrl", ".", "substring", "(", "0", ",", "baseUrl", ".", "length", "(", ")", "-", "1", ")", ";", "@", "@", "-", "30", ",", "4", "+", "30", ",", "8", "@", "@", "public", "String", "getId", "(", ")", "{", "return", "PROVIDER_ID", ";", "}", "@", "Override", "public", "OpenshiftV4IdentityProviderConfig", "createConfig", "(", ")", "{", "return", "new", "OpenshiftV4IdentityProviderConfig", "(", ");", "}", "}", "@", "@", "-", "28", ",", "6", "+", "28", ",", "10", "@", "@", "public", "PayPalIdentityProviderConfig", "(", "IdentityProviderModel", "model", ")", "{", "super", "(", "model", ")", ";", "}", "public", "PayPalIdentityProviderConfig", "(", ")", "{", "}", "public", "boolean", "targetSandbox", "(", ")", "{", "String", "sandbox", "=", "getConfig", "(", ").", "get", "(", "\"", "sandbox", "\"", ");", "return", "sandbox", "=", "=", "null", "?", "false", ":", "Boolean", ".", "valueOf", "(", "sandbox", ")", ";", "@", "@", "-", "39", ",", "6", "+", "39", ",", "11", "@", "@", "public", "PayPalIdentityProvider", "create", "(", "KeycloakSession", "session", ",", "IdentityProviderMo", "return", "new", "PayPalIdentityProvider", "(", "session", ",", "new", "PayPalIdentityProviderConfig", "(", "model", ")", ");", "}", "@", "Override", "public", "PayPalIdentityProviderConfig", "createConfig", "(", ")", "{", "return", "new", "PayPalIdentityProviderConfig", "(", ");", "}", "@", "Override", "public", "String", "getId", "(", ")", "{", "return", "PROVIDER_ID", ";", "@", "@", "-", "28", ",", "7", "+", "28", ",", "11", "@", "@", "public", "StackOverflowIdentityProviderConfig", "(", "IdentityProviderModel", "model", ")", "{", "super", "(", "model", ")", ";", "}", "public", "String", "getKey", "(", ")", "{", "public", "StackOverflowIdentityProviderConfig", "(", ")", "{", "}", "public", "String", "getKey", "(", ")", "{", "return", "getConfig", "(", ").", "get", "(", "\"", "key", "\"", ");", "}", "@", "@", "-", "40", ",", "6", "+", "40", ",", "11", "@", "@", "public", "StackoverflowIdentityProvider", "create", "(", "KeycloakSession", "session", ",", "IdentityPro", "return", "new", "StackoverflowIdentityProvider", "(", "session", ",", "new", "StackOverflowIdentityProviderConfig", "(", "model", ")", ");", "}", "@", "Override", "public", "StackOverflowIdentityProviderConfig", "createConfig", "(", ")", "{", "return", "new", "StackOverflowIdentityProviderConfig", "(", ");", "}", "@", "Override", "public", "String", "getId", "(", ")", "{", "return", "PROVIDER_ID", ";", "@", "@", "-", "39", ",", "6", "+", "39", ",", "11", "@", "@", "public", "TwitterIdentityProvider", "create", "(", "KeycloakSession", "session", ",", "IdentityProviderM", "return", "new", "TwitterIdentityProvider", "(", "session", ",", "new", "OAuth2IdentityProviderConfig", "(", "model", ")", ");", "}", "@", "Override", "public", "OAuth2IdentityProviderConfig", "createConfig", "(", ")", "{", "return", "new", "OAuth2IdentityProviderConfig", "(", ");", "}", "@", "Override", "public", "String", "getId", "(", ")", "{", "return", "PROVIDER_ID", ";", "@", "@", "-", "17", ",", "9", "+", "17", ",", "13", "@", "@", "package", "org", ".", "keycloak", ".", "testsuite", ".", "admin", ";", "import", "org", ".", "hamcrest", ".", "Matchers", ";", "import", "org", ".", "jboss", ".", "resteasy", ".", "plugins", ".", "providers", ".", "multipart", ".", "MultipartFormDataOutput", ";", "import", "org", ".", "junit", ".", "Rule", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "rules", ".", "ExpectedException", ";", "import", "org", ".", "keycloak", ".", "admin", ".", "client", ".", "resource", ".", "IdentityProviderResource", ";", "import", "org", ".", "keycloak", ".", "common", ".", "enums", ".", "SslRequired", ";", "import", "org", ".", "keycloak", ".", "dom", ".", "saml", ".", "v2", ".", "metadata", ".", "EndpointType", ";", "import", "org", ".", "keycloak", ".", "dom", ".", "saml", ".", "v2", ".", "metadata", ".", "EntityDescriptorType", ";", "import", "org", ".", "keycloak", ".", "dom", ".", "saml", ".", "v2", ".", "metadata", ".", "IndexedEndpointType", ";", "@", "@", "-", "35", ",", "12", "+", "39", ",", "15", "@", "@", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "IdentityProviderMapperRepresentation", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "IdentityProviderMapperTypeRepresentation", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "IdentityProviderRepresentation", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "RealmRepresentation", ";", "import", "org", ".", "keycloak", ".", "saml", ".", "common", ".", "exceptions", ".", "ParsingException", ";", "import", "org", ".", "keycloak", ".", "saml", ".", "processing", ".", "core", ".", "parsers", ".", "saml", ".", "SAMLParser", ";", "import", "org", ".", "keycloak", ".", "testsuite", ".", "Assert", ";", "import", "org", ".", "keycloak", ".", "testsuite", ".", "broker", ".", "OIDCIdentityProviderConfigRep", ";", "import", "org", ".", "keycloak", ".", "testsuite", ".", "util", ".", "AdminEventPaths", ";", "import", "org", ".", "w3c", ".", "dom", ".", "NodeList", ";", "import", "javax", ".", "ws", ".", "rs", ".", "ClientErrorException", ";", "import", "javax", ".", "ws", ".", "rs", ".", "NotFoundException", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "MediaType", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Response", ";", "@", "@", "-", "59", ",", "6", "+", "66", ",", "7", "@", "@", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "UUID", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "containsInAnyOrder", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "containsString", ";", "@", "@", "-", "75", ",", "6", "+", "83", ",", "7", "@", "@", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertThat", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "keycloak", ".", "testsuite", ".", "arquillian", ".", "AuthServerTestEnricher", ".", "AUTH_SERVER_SSL_REQUIRED", ";", "/", "**", "*", "@", "author", "<", "a", "href", "=", "\"", "mailto", ":", "sthorger", "@", "redhat", ".", "com", "\"", ">", "Stian", "Thorgersen", "<", "/", "a", ">", "@", "@", "-", "102", ",", "6", "+", "111", ",", "9", "@", "@", "+", "\"", "vOU8TyqfZF5jpv0IcrviLl", "/", "DoFrbjByeHR", "+", "pu", "/", "vClcAOjL", "/", "u7oQELuuTfNsBI4tpexUj5G8q", "/", "YbEz0gk7idf", "\"", "+", "\"", "LXrAUVcsR73oTngrhRfwUSmPrjjK0kjcRb6HL9V", "/", "+", "wh3R", "/", "6mEd59U08ExT8N38rhmn0CI3ehMdebReprP7U8", "=", "\";", "@", "Rule", "public", "ExpectedException", "expectedException", "=", "ExpectedException", ".", "none", "(", ");", "@", "Test", "public", "void", "testFindAll", "(", ")", "{", "create", "(", "createRep", "(", "\"", "google", "\"", ",", "\"", "google", "\"", "))", ";", "@", "@", "-", "143", ",", "6", "+", "155", ",", "71", "@", "@", "public", "void", "testCreate", "(", ")", "{", "assertEquals", "(", "ComponentRepresentation", ".", "SECRET_VALUE", ",", "rep", ".", "getConfig", "(", ").", "get", "(", "\"", "clientSecret", "\"", "))", ";", "}", "@", "Test", "public", "void", "failCreateInvalidUrl", "(", ")", "{", "RealmRepresentation", "realmRep", "=", "realm", ".", "toRepresentation", "(", ");", "realmRep", ".", "setSslRequired", "(", "SslRequired", ".", "ALL", ".", "name", "(", "))", ";", "try", "{", "realm", ".", "update", "(", "realmRep", ")", ";", "IdentityProviderRepresentation", "newIdentityProvider", "=", "createRep", "(", "\"", "new", "-", "identity", "-", "provider", "\"", ",", "\"", "oidc", "\"", ");", "newIdentityProvider", ".", "getConfig", "(", ").", "put", "(", "\"", "clientId", "\"", ",", "\"", "clientId", "\"", ");", "newIdentityProvider", ".", "getConfig", "(", ").", "put", "(", "\"", "clientSecret", "\"", ",", "\"", "some", "secret", "value", "\"", ");", "OIDCIdentityProviderConfigRep", "oidcConfig", "=", "new", "OIDCIdentityProviderConfigRep", "(", "newIdentityProvider", ")", ";", "oidcConfig", ".", "setAuthorizationUrl", "(", "\"", "invalid", ":", "//", "test", "\"", ");", "try", "(", "Response", "response", "=", "this", ".", "realm", ".", "identityProviders", "(", ").", "create", "(", "newIdentityProvider", ")", ")", "{", "assertEquals", "(", "AUTH_SERVER_SSL_REQUIRED", "?", "Response", ".", "Status", ".", "BAD_REQUEST", ".", "getStatusCode", "(", ")", ":", "Response", ".", "Status", ".", "CREATED", ".", "getStatusCode", "(", "),", "response", ".", "getStatus", "(", "))", ";", "}", "oidcConfig", ".", "setAuthorizationUrl", "(", "null", ")", ";", "oidcConfig", ".", "setTokenUrl", "(", "\"", "http", ":", "//", "test", "\"", ");", "try", "(", "Response", "response", "=", "this", ".", "realm", ".", "identityProviders", "(", ").", "create", "(", "newIdentityProvider", ")", ")", "{", "assertEquals", "(", "AUTH_SERVER_SSL_REQUIRED", "?", "Response", ".", "Status", ".", "BAD_REQUEST", ".", "getStatusCode", "(", ")", ":", "Response", ".", "Status", ".", "CREATED", ".", "getStatusCode", "(", "),", "response", ".", "getStatus", "(", "))", ";", "}", "oidcConfig", ".", "setAuthorizationUrl", "(", "null", ")", ";", "oidcConfig", ".", "setTokenUrl", "(", "null", ")", ";", "oidcConfig", ".", "setJwksUrl", "(", "\"", "http", ":", "//", "test", "\"", ");", "try", "(", "Response", "response", "=", "this", ".", "realm", ".", "identityProviders", "(", ").", "create", "(", "newIdentityProvider", ")", ")", "{", "assertEquals", "(", "AUTH_SERVER_SSL_REQUIRED", "?", "Response", ".", "Status", ".", "BAD_REQUEST", ".", "getStatusCode", "(", ")", ":", "Response", ".", "Status", ".", "CREATED", ".", "getStatusCode", "(", "),", "response", ".", "getStatus", "(", "))", ";", "}", "oidcConfig", ".", "setAuthorizationUrl", "(", "null", ")", ";", "oidcConfig", ".", "setTokenUrl", "(", "null", ")", ";", "oidcConfig", ".", "setJwksUrl", "(", "null", ")", ";", "oidcConfig", ".", "setLogoutUrl", "(", "\"", "http", ":", "//", "test", "\"", ");", "try", "(", "Response", "response", "=", "this", ".", "realm", ".", "identityProviders", "(", ").", "create", "(", "newIdentityProvider", ")", ")", "{", "assertEquals", "(", "AUTH_SERVER_SSL_REQUIRED", "?", "Response", ".", "Status", ".", "BAD_REQUEST", ".", "getStatusCode", "(", ")", ":", "Response", ".", "Status", ".", "CREATED", ".", "getStatusCode", "(", "),", "response", ".", "getStatus", "(", "))", ";", "}", "oidcConfig", ".", "setAuthorizationUrl", "(", "null", ")", ";", "oidcConfig", ".", "setTokenUrl", "(", "null", ")", ";", "oidcConfig", ".", "setJwksUrl", "(", "null", ")", ";", "oidcConfig", ".", "setLogoutUrl", "(", "null", ")", ";", "oidcConfig", ".", "setUserInfoUrl", "(", "\"", "http", ":", "//", "test", "\"", ");", "try", "(", "Response", "response", "=", "this", ".", "realm", ".", "identityProviders", "(", ").", "create", "(", "newIdentityProvider", ")", ")", "{", "assertEquals", "(", "AUTH_SERVER_SSL_REQUIRED", "?", "Response", ".", "Status", ".", "BAD_REQUEST", ".", "getStatusCode", "(", ")", ":", "Response", ".", "Status", ".", "CREATED", ".", "getStatusCode", "(", "),", "response", ".", "getStatus", "(", "))", ";", "}", "}", "finally", "{", "realmRep", ".", "setSslRequired", "(", "SslRequired", ".", "NONE", ".", "name", "(", "))", ";", "realm", ".", "update", "(", "realmRep", ")", ";", "}", "}", "@", "Test", "public", "void", "testCreateWithBasicAuth", "(", ")", "{", "@", "@", "-", "258", ",", "6", "+", "335", ",", "84", "@", "@", "public", "void", "testUpdate", "(", ")", "{", "assertEquals", "(", "\"$", "{", "vault", ".", "key", "}", "\",", "testingClient", ".", "testing", "(", "\"", "admin", "-", "client", "-", "test", "\"", ").", "getIdentityProviderConfig", "(", "\"", "changed", "-", "alias", "\"", ").", "get", "(", "\"", "clientSecret", "\"", "))", ";", "}", "@", "Test", "public", "void", "failUpdateInvalidUrl", "(", ")", "{", "RealmRepresentation", "realmRep", "=", "realm", ".", "toRepresentation", "(", ");", "realmRep", ".", "setSslRequired", "(", "SslRequired", ".", "ALL", ".", "name", "(", "))", ";", "try", "{", "realm", ".", "update", "(", "realmRep", ")", ";", "IdentityProviderRepresentation", "representation", "=", "createRep", "(", "UUID", ".", "randomUUID", "(", ").", "toString", "(", "),", "\"", "oidc", "\"", ");", "representation", ".", "getConfig", "(", ").", "put", "(", "\"", "clientId", "\"", ",", "\"", "clientId", "\"", ");", "representation", ".", "getConfig", "(", ").", "put", "(", "\"", "clientSecret", "\"", ",", "\"", "some", "secret", "value", "\"", ");", "try", "(", "Response", "response", "=", "realm", ".", "identityProviders", "(", ").", "create", "(", "representation", ")", ")", "{", "assertEquals", "(", "Response", ".", "Status", ".", "CREATED", ".", "getStatusCode", "(", "),", "response", ".", "getStatus", "(", "))", ";", "}", "IdentityProviderResource", "resource", "=", "this", ".", "realm", ".", "identityProviders", "(", ").", "get", "(", "representation", ".", "getAlias", "(", "))", ";", "representation", "=", "resource", ".", "toRepresentation", "(", ");", "OIDCIdentityProviderConfigRep", "oidcConfig", "=", "new", "OIDCIdentityProviderConfigRep", "(", "representation", ")", ";", "oidcConfig", ".", "setAuthorizationUrl", "(", "\"", "invalid", ":", "//", "test", "\"", ");", "this", ".", "expectedException", ".", "expect", "(", "Matchers", ".", "allOf", "(", "Matchers", ".", "instanceOf", "(", "ClientErrorException", ".", "class", ")", ",", "Matchers", ".", "hasProperty", "(", "\"", "response", "\"", ",", "Matchers", ".", "hasProperty", "(", "\"", "status", "\"", ",", "Matchers", ".", "is", "(", "Response", ".", "Status", ".", "BAD_REQUEST", ".", "getStatusCode", "(", "))", "))", "))", ";", "resource", ".", "update", "(", "representation", ")", ";", "oidcConfig", ".", "setAuthorizationUrl", "(", "null", ")", ";", "oidcConfig", ".", "setTokenUrl", "(", "\"", "http", ":", "//", "test", "\"", ");", "this", ".", "expectedException", ".", "expect", "(", "Matchers", ".", "allOf", "(", "Matchers", ".", "instanceOf", "(", "ClientErrorException", ".", "class", ")", ",", "Matchers", ".", "hasProperty", "(", "\"", "response", "\"", ",", "Matchers", ".", "hasProperty", "(", "\"", "status", "\"", ",", "Matchers", ".", "is", "(", "Response", ".", "Status", ".", "BAD_REQUEST", ".", "getStatusCode", "(", "))", "))", "))", ";", "resource", ".", "update", "(", "representation", ")", ";", "oidcConfig", ".", "setAuthorizationUrl", "(", "null", ")", ";", "oidcConfig", ".", "setTokenUrl", "(", "null", ")", ";", "oidcConfig", ".", "setJwksUrl", "(", "\"", "http", ":", "//", "test", "\"", ");", "this", ".", "expectedException", ".", "expect", "(", "Matchers", ".", "allOf", "(", "Matchers", ".", "instanceOf", "(", "ClientErrorException", ".", "class", ")", ",", "Matchers", ".", "hasProperty", "(", "\"", "response", "\"", ",", "Matchers", ".", "hasProperty", "(", "\"", "status", "\"", ",", "Matchers", ".", "is", "(", "Response", ".", "Status", ".", "BAD_REQUEST", ".", "getStatusCode", "(", "))", "))", "))", ";", "resource", ".", "update", "(", "representation", ")", ";", "oidcConfig", ".", "setAuthorizationUrl", "(", "null", ")", ";", "oidcConfig", ".", "setTokenUrl", "(", "null", ")", ";", "oidcConfig", ".", "setJwksUrl", "(", "null", ")", ";", "oidcConfig", ".", "setLogoutUrl", "(", "\"", "http", ":", "//", "test", "\"", ");", "this", ".", "expectedException", ".", "expect", "(", "Matchers", ".", "allOf", "(", "Matchers", ".", "instanceOf", "(", "ClientErrorException", ".", "class", ")", ",", "Matchers", ".", "hasProperty", "(", "\"", "response", "\"", ",", "Matchers", ".", "hasProperty", "(", "\"", "status", "\"", ",", "Matchers", ".", "is", "(", "Response", ".", "Status", ".", "BAD_REQUEST", ".", "getStatusCode", "(", "))", "))", "))", ";", "resource", ".", "update", "(", "representation", ")", ";", "oidcConfig", ".", "setAuthorizationUrl", "(", "null", ")", ";", "oidcConfig", ".", "setTokenUrl", "(", "null", ")", ";", "oidcConfig", ".", "setJwksUrl", "(", "null", ")", ";", "oidcConfig", ".", "setLogoutUrl", "(", "null", ")", ";", "oidcConfig", ".", "setUserInfoUrl", "(", "\"", "http", ":", "//", "test", "\"", ");", "this", ".", "expectedException", ".", "expect", "(", "Matchers", ".", "allOf", "(", "Matchers", ".", "instanceOf", "(", "ClientErrorException", ".", "class", ")", ",", "Matchers", ".", "hasProperty", "(", "\"", "response", "\"", ",", "Matchers", ".", "hasProperty", "(", "\"", "status", "\"", ",", "Matchers", ".", "is", "(", "Response", ".", "Status", ".", "BAD_REQUEST", ".", "getStatusCode", "(", "))", "))", "))", ";", "resource", ".", "update", "(", "representation", ")", ";", "}", "finally", "{", "realmRep", ".", "setSslRequired", "(", "SslRequired", ".", "NONE", ".", "name", "(", "))", ";", "realm", ".", "update", "(", "realmRep", ")", ";", "}", "}", "@", "Test", "public", "void", "testRemove", "(", ")", "{", "IdentityProviderRepresentation", "newIdentityProvider", "=", "createRep", "(", "\"", "remove", "-", "identity", "-", "provider", "\"", ",", "\"", "saml", "\"", ");", "@", "@", "-", "1658", ",", "8", "+", "1658", ",", "8", "@", "@", "public", "void", "invoke", "(", "RealmResource", "realm", ")", "{", "}", ",", "Resource", ".", "IDENTITY_PROVIDER", ",", "false", ")", ";", "invoke", "(", "new", "InvocationWithResponse", "(", ")", "{", "public", "void", "invoke", "(", "RealmResource", "realm", ",", "AtomicReference", "<", "Response", ">", "response", ")", "{", "response", ".", "set", "(", "realm", ".", "identityProviders", "(", ").", "create", "(", "IdentityProviderBuilder", ".", "create", "(", ").", "providerId", "(", "\"", "nosuch", "\"", ")", ".", "displayName", "(", "\"", "nosuch", "-", "foo", "\"", ").", "alias", "(", "\"", "foo", "\"", ").", "build", "(", "))", ");", "response", ".", "set", "(", "realm", ".", "identityProviders", "(", ").", "create", "(", "IdentityProviderBuilder", ".", "create", "(", ").", "providerId", "(", "\"", "oidc", "\"", ")", ".", "displayName", "(", "\"", "nosuch", "-", "foo", "\"", ").", "alias", "(", "\"", "foo", "\"", ").", "setAttribute", "(", "\"", "clientId", "\"", ",", "\"", "foo", "\"", ").", "setAttribute", "(", "\"", "clientSecret", "\"", ",", "\"", "foo", "\"", ").", "build", "(", "))", ");", "}", "}", ",", "Resource", ".", "IDENTITY_PROVIDER", ",", "true", ")", ";", "@", "@", "-", "708", ",", "7", "+", "708", ",", "7", "@", "@", "private", "void", "addSampleIdentityProvider", "(", ")", "{", "IdentityProviderRepresentation", "rep", "=", "new", "IdentityProviderRepresentation", "(", ");", "rep", ".", "setAlias", "(", "\"", "social", "-", "provider", "-", "id", "\"", ");", "rep", ".", "setProviderId", "(", "\"", "social", "-", "provider", "-", "type", "\"", ");", "rep", ".", "setProviderId", "(", "\"", "oidc", "\"", ");", "realm", ".", "identityProviders", "(", ").", "create", "(", "rep", ")", ";", "assertAdminEvents", ".", "assertEvent", "(", "realmId", ",", "OperationType", ".", "CREATE", ",", "AdminEventPaths", ".", "identityProviderPath", "(", "rep", ".", "getAlias", "(", "))", ",", "rep", ",", "ResourceType", ".", "IDENTITY_PROVIDER", ")", ";", "@", "@", "-", "279", ",", "7", "+", "279", ",", "7", "@", "@", "public", "void", "testPublicKeyCacheInvalidatedWhenProviderUpdated", "(", ")", "throws", "Exception", "/", "/", "Update", "identityProvider", "to", "some", "bad", "JWKS_URL", "OIDCIdentityProviderConfigRep", "cfg", "=", "new", "OIDCIdentityProviderConfigRep", "(", "idpRep", ")", ";", "cfg", ".", "setJwksUrl", "(", "\"", "http", ":", "//", "localhost", ":", "43214", "/", "non", "-", "existent", "\"", ");", "cfg", ".", "setJwksUrl", "(", "\"", "https", ":", "//", "localhost", ":", "43214", "/", "non", "-", "existent", "\"", ");", "updateIdentityProvider", "(", "idpRep", ")", ";", "/", "/", "Check", "that", "key", "is", "not", "cached", "anymore", "@", "@", "-", "27", ",", "7", "+", "27", ",", "7", "@", "@", "*", "*", "@", "author", "<", "a", "href", "=", "\"", "mailto", ":", "mposolda", "@", "redhat", ".", "com", "\"", ">", "Marek", "Posolda", "<", "/", "a", ">", "*", "/", "class", "OIDCIdentityProviderConfigRep", "extends", "OIDCIdentityProviderConfig", "{", "public", "class", "OIDCIdentityProviderConfigRep", "extends", "OIDCIdentityProviderConfig", "{", "private", "final", "IdentityProviderRepresentation", "rep", ";", "@", "@", "-", "43", ",", "8", "+", "43", ",", "8", "@", "@", "public", "void", "testUpdateIDPWithoutInternalId", "(", ")", "throws", "IOException", "{", ".", "providerId", "(", "SAMLIdentityProviderFactory", ".", "PROVIDER_ID", ")", ".", "alias", "(", "\"", "idpAlias", "\"", ")", ".", "displayName", "(", "\"", "SAML", "\"", ")", ".", "setAttribute", "(", "SAMLIdentityProviderConfig", ".", "SINGLE_SIGN_ON_SERVICE_URL", ",", "\"", "http", ":", "//", "saml", ".", "idp", "/", "saml", "\"", ")", ".", "setAttribute", "(", "SAMLIdentityProviderConfig", ".", "SINGLE_LOGOUT_SERVICE_URL", ",", "\"", "http", ":", "//", "saml", ".", "idp", "/", "saml", "\"", ")", ".", "setAttribute", "(", "SAMLIdentityProviderConfig", ".", "SINGLE_SIGN_ON_SERVICE_URL", ",", "\"", "https", ":", "//", "saml", ".", "idp", "/", "saml", "\"", ")", ".", "setAttribute", "(", "SAMLIdentityProviderConfig", ".", "SINGLE_LOGOUT_SERVICE_URL", ",", "\"", "https", ":", "//", "saml", ".", "idp", "/", "saml", "\"", ")", ".", "setAttribute", "(", "SAMLIdentityProviderConfig", ".", "NAME_ID_POLICY_FORMAT", ",", "\"", "urn", ":", "oasis", ":", "names", ":", "tc", ":", "SAML", ":", "1", ".", "1", ":", "nameid", "-", "format", ":", "emailAddress", "\"", ")", ".", "setAttribute", "(", "SAMLIdentityProviderConfig", ".", "POST_BINDING_RESPONSE", ",", "\"", "false", "\"", ")", ".", "setAttribute", "(", "SAMLIdentityProviderConfig", ".", "POST_BINDING_AUTHN_REQUEST", ",", "\"", "false", "\"", ")", "@", "@", "-", "91", ",", "7", "+", "91", ",", "7", "@", "@", "private", "SAML2Object", "createAuthnResponse", "(", "SAML2Object", "so", ")", "{", "final", "ResponseType", "res", "=", "new", "SAML2LoginResponseBuilder", "(", ")", ".", "requestID", "(", "req", ".", "getID", "(", "))", ".", "destination", "(", "req", ".", "getAssertionConsumerServiceURL", "(", ").", "toString", "(", "))", ".", "issuer", "(", "\"", "http", ":", "//", "saml", ".", "idp", "/", "saml", "\"", ")", ".", "issuer", "(", "\"", "https", ":", "//", "saml", ".", "idp", "/", "saml", "\"", ")", ".", "assertionExpiration", "(", "1000000", ")", ".", "subjectExpiration", "(", "1000000", ")", ".", "requestIssuer", "(", "getAuthServerRealmBase", "(", "REALM_NAME", ")", ".", "toString", "(", "))", "@", "@", "-", "118", ",", "7", "+", "118", ",", "7", "@", "@", "public", "void", "testLogoutPropagatesToSamlIdentityProvider", "(", ")", "throws", "IOException", "{", "AuthenticationExecutionInfoRepresentation", "reviewProfileAuthenticator", "=", "null", ";", "String", "firstBrokerLoginFlowAlias", "=", "null", ";", "try", "(", "IdentityProviderCreator", "idp", "=", "new", "IdentityProviderCreator", "(", "realm", ",", "addIdentityProvider", "(", "\"", "http", ":", "//", "saml", ".", "idp", "/", "saml", "\"", "))", ")", "{", "try", "(", "IdentityProviderCreator", "idp", "=", "new", "IdentityProviderCreator", "(", "realm", ",", "addIdentityProvider", "(", "\"", "https", ":", "//", "saml", ".", "idp", "/", "saml", "\"", "))", ")", "{", "IdentityProviderRepresentation", "idpRepresentation", "=", "idp", ".", "identityProvider", "(", ").", "toRepresentation", "(", ");", "firstBrokerLoginFlowAlias", "=", "idpRepresentation", ".", "getFirstBrokerLoginFlowAlias", "(", ");", "List", "<", "AuthenticationExecutionInfoRepresentation", ">", "executions", "=", "realm", ".", "flows", "(", ").", "getExecutions", "(", "firstBrokerLoginFlowAlias", ")", ";", "@", "@", "-", "168", ",", "7", "+", "168", ",", "7", "@", "@", "public", "void", "testLogoutPropagatesToSamlIdentityProvider", "(", ")", "throws", "IOException", "{", "public", "void", "testRedirectQueryParametersPreserved", "(", ")", "throws", "IOException", "{", "final", "RealmResource", "realm", "=", "adminClient", ".", "realm", "(", "REALM_NAME", ")", ";", "try", "(", "IdentityProviderCreator", "idp", "=", "new", "IdentityProviderCreator", "(", "realm", ",", "addIdentityProvider", "(", "\"", "http", ":", "//", "saml", ".", "idp", "/", "?", "service", "=", "name", "&", "serviceType", "=", "prod", "\"", "))", ")", "{", "try", "(", "IdentityProviderCreator", "idp", "=", "new", "IdentityProviderCreator", "(", "realm", ",", "addIdentityProvider", "(", "\"", "https", ":", "//", "saml", ".", "idp", "/", "?", "service", "=", "name", "&", "serviceType", "=", "prod", "\"", "))", ")", "{", "SAMLDocumentHolder", "samlResponse", "=", "new", "SamlClientBuilder", "(", ")", ".", "authnRequest", "(", "getAuthServerSamlEndpoint", "(", "REALM_NAME", ")", ",", "SAML_CLIENT_ID_SALES_POST", ",", "SAML_ASSERTION_CONSUMER_URL_SALES_POST", ",", "POST", ")", ".", "build", "(", ")", ".", "login", "(", ").", "idp", "(", "SAML_BROKER_ALIAS", ")", ".", "build", "(", ")", "@", "@", "-", "178", ",", "7", "+", "178", ",", "7", "@", "@", "public", "void", "testRedirectQueryParametersPreserved", "(", ")", "throws", "IOException", "{", "assertThat", "(", "samlResponse", ".", "getSamlObject", "(", "),", "Matchers", ".", "instanceOf", "(", "AuthnRequestType", ".", "class", ")", ");", "AuthnRequestType", "ar", "=", "(", "AuthnRequestType", ")", "samlResponse", ".", "getSamlObject", "(", ");", "assertThat", "(", "ar", ".", "getDestination", "(", "),", "Matchers", ".", "equalTo", "(", "URI", ".", "create", "(", "\"", "http", ":", "//", "saml", ".", "idp", "/", "?", "service", "=", "name", "&", "serviceType", "=", "prod", "\"", "))", ");", "assertThat", "(", "ar", ".", "getDestination", "(", "),", "Matchers", ".", "equalTo", "(", "URI", ".", "create", "(", "\"", "https", ":", "//", "saml", ".", "idp", "/", "?", "service", "=", "name", "&", "serviceType", "=", "prod", "\"", "))", ");", "Header", "[", "]", "headers", "=", "new", "SamlClientBuilder", "(", ")", ".", "authnRequest", "(", "getAuthServerSamlEndpoint", "(", "REALM_NAME", ")", ",", "SAML_CLIENT_ID_SALES_POST", ",", "SAML_ASSERTION_CONSUMER_URL_SALES_POST", ",", "POST", ")", ".", "build", "(", ")", "@", "@", "-", "187", ",", "7", "+", "187", ",", "7", "@", "@", "public", "void", "testRedirectQueryParametersPreserved", "(", ")", "throws", "IOException", "{", ".", "executeAndTransform", "(", "resp", "-", ">", "resp", ".", "getHeaders", "(", "HttpHeaders", ".", "LOCATION", ")", ");", "assertThat", "(", "headers", ".", "length", ",", "Matchers", ".", "is", "(", "1", ")", ");", "assertThat", "(", "headers", "[", "0", "]", ".", "getValue", "(", "),", "Matchers", ".", "containsString", "(", "\"", "http", ":", "//", "saml", ".", "idp", "/", "?", "service", "=", "name", "&", "serviceType", "=", "prod", "\"", "))", ";", "assertThat", "(", "headers", "[", "0", "]", ".", "getValue", "(", "),", "Matchers", ".", "containsString", "(", "\"", "https", ":", "//", "saml", ".", "idp", "/", "?", "service", "=", "name", "&", "serviceType", "=", "prod", "\"", "))", ";", "assertThat", "(", "headers", "[", "0", "]", ".", "getValue", "(", "),", "Matchers", ".", "containsString", "(", "\"", "SAMLRequest", "\"", "))", ";", "}", "}", "@", "@", "-", "228", ",", "7", "+", "228", ",", "7", "@", "@", "public", "void", "testExpiredAssertionShouldFail", "(", ")", "throws", "Exception", "{", "private", "void", "assertExpired", "(", "XMLGregorianCalendar", "notBefore", ",", "XMLGregorianCalendar", "notOnOrAfter", ",", "boolean", "shouldPass", ")", "throws", "Exception", "{", "Status", "expectedStatus", "=", "shouldPass", "?", "Status", ".", "OK", ":", "Status", ".", "BAD_REQUEST", ";", "final", "RealmResource", "realm", "=", "adminClient", ".", "realm", "(", "REALM_NAME", ")", ";", "try", "(", "IdentityProviderCreator", "idp", "=", "new", "IdentityProviderCreator", "(", "realm", ",", "addIdentityProvider", "(", "\"", "http", ":", "//", "saml", ".", "idp", "/", "\")", "))", "{", "try", "(", "IdentityProviderCreator", "idp", "=", "new", "IdentityProviderCreator", "(", "realm", ",", "addIdentityProvider", "(", "\"", "https", ":", "//", "saml", ".", "idp", "/", "\")", "))", "{", "new", "SamlClientBuilder", "(", ")", ".", "authnRequest", "(", "getAuthServerSamlEndpoint", "(", "REALM_NAME", ")", ",", "SAML_CLIENT_ID_SALES_POST", ",", "SAML_ASSERTION_CONSUMER_URL_SALES_POST", ",", "POST", ")", ".", "build", "(", ")", ".", "login", "(", ").", "idp", "(", "SAML_BROKER_ALIAS", ")", ".", "build", "(", ")", "@", "@", "-", "210", ",", "7", "+", "210", ",", "7", "@", "@", "public", "void", "testSamlPostBindingPageIdP", "(", ")", "throws", "Exception", "{", "IdentityProviderBuilder", ".", "create", "(", ")", ".", "alias", "(", "\"", "saml", "-", "idp", "\"", ")", ".", "providerId", "(", "\"", "saml", "\"", ")", ".", "setAttribute", "(", "SAMLIdentityProviderConfig", ".", "SINGLE_SIGN_ON_SERVICE_URL", ",", "\"", "http", ":", "//", "saml", "-", "idp", "-", "sso", "-", "service", "/", "\")", ".", "setAttribute", "(", "SAMLIdentityProviderConfig", ".", "SINGLE_SIGN_ON_SERVICE_URL", ",", "\"", "https", ":", "//", "saml", "-", "idp", "-", "sso", "-", "service", "/", "\")", ".", "setAttribute", "(", "SAMLIdentityProviderConfig", ".", "POST_BINDING_AUTHN_REQUEST", ",", "\"", "true", "\"", ")", ".", "build", "(", "))", ")", "{", "new", "SamlClientBuilder", "(", ")", "@", "@", "-", "75", ",", "9", "+", "75", ",", "9", "@", "@", "private", "static", "final", "String", "SP_NAME_QUALIFIER", "=", "\"", "spNameQualifier", "\"", ";", "private", "static", "final", "String", "NAME_QUALIFIER", "=", "\"", "nameQualifier", "\"", ";", "private", "static", "final", "String", "BROKER_SIGN_ON_SERVICE_URL", "=", "\"", "http", ":", "//", "saml", ".", "idp", "/", "saml", "\"", ";", "private", "static", "final", "String", "BROKER_LOGOUT_SERVICE_URL", "=", "\"", "http", ":", "//", "saml", ".", "idp", "/", "SLO", "/", "saml", "\"", ";", "private", "static", "final", "String", "BROKER_SERVICE_ID", "=", "\"", "http", ":", "//", "saml", ".", "idp", "/", "saml", "\"", ";", "private", "static", "final", "String", "BROKER_SIGN_ON_SERVICE_URL", "=", "\"", "https", ":", "//", "saml", ".", "idp", "/", "saml", "\"", ";", "private", "static", "final", "String", "BROKER_LOGOUT_SERVICE_URL", "=", "\"", "https", ":", "//", "saml", ".", "idp", "/", "SLO", "/", "saml", "\"", ";", "private", "static", "final", "String", "BROKER_SERVICE_ID", "=", "\"", "https", ":", "//", "saml", ".", "idp", "/", "saml", "\"", ";", "private", "ClientRepresentation", "salesRep", ";", "private", "ClientRepresentation", "sales2Rep", ";", "@", "@", "-", "13", ",", "9", "+", "13", ",", "9", "@", "@", "\"", "config", "\"", ":", "{", "\"", "nameIDPolicyFormat", "\"", ":", "\"", "urn", ":", "oasis", ":", "names", ":", "tc", ":", "SAML", ":", "1", ".", "1", ":", "nameid", "-", "format", ":", "emailAddress", "\"", ",", "\"", "postBindingResponse", "\"", ":", "\"", "false", "\"", ",", "\"", "singleLogoutServiceUrl", "\"", ":", "\"", "http", ":", "//", "saml", ".", "idp", "/", "saml", "\"", ",", "\"", "singleLogoutServiceUrl", "\"", ":", "\"", "https", ":", "//", "saml", ".", "idp", "/", "saml", "\"", ",", "\"", "postBindingAuthnRequest", "\"", ":", "\"", "false", "\"", ",", "\"", "singleSignOnServiceUrl", "\"", ":", "\"", "http", ":", "//", "saml", ".", "idp", "/", "saml", "\"", ",", "\"", "singleSignOnServiceUrl", "\"", ":", "\"", "https", ":", "//", "saml", ".", "idp", "/", "saml", "\"", ",", "\"", "backchannelSupported", "\"", ":", "\"", "false", "\"", "}", "}"], "docstring_tokens": ["lacks", "proper", "input", "validation", "as", "it", "allows", "a", "wide", "range", "of", "characters", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "193", ",", "9", "+", "193", ",", "30", "@", "@", "void", "f2fs_inode_chksum_set", "(", "struct", "f2fs_sb_info", "*", "sbi", ",", "struct", "page", "*", "page", ")", "ri", "-", ">", "i_inode_checksum", "=", "cpu_to_le32", "(", "f2fs_inode_chksum", "(", "sbi", ",", "page", ")", ");", "}", "static", "bool", "sanity_check_inode", "(", "struct", "inode", "*", "inode", ")", "static", "bool", "sanity_check_inode", "(", "struct", "inode", "*", "inode", ",", "struct", "page", "*", "node_page", ")", "{", "struct", "f2fs_sb_info", "*", "sbi", "=", "F2FS_I_SB", "(", "inode", ")", ";", "unsigned", "long", "long", "iblocks", ";", "iblocks", "=", "le64_to_cpu", "(", "F2FS_INODE", "(", "node_page", ")", "->", "i_blocks", ")", ";", "if", "(", "!", "iblocks", ")", "{", "set_sbi_flag", "(", "sbi", ",", "SBI_NEED_FSCK", ")", ";", "f2fs_msg", "(", "sbi", "-", ">", "sb", ",", "KERN_WARNING", ",", "\"", "%", "s", ":", "corrupted", "inode", "i_blocks", "i_ino", "=", "%", "lx", "iblocks", "=", "%", "llu", ",", "\"", "\"", "run", "fsck", "to", "fix", ".", "\",", "__func__", ",", "inode", "-", ">", "i_ino", ",", "iblocks", ")", ";", "return", "false", ";", "}", "if", "(", "ino_of_node", "(", "node_page", ")", "!", "=", "nid_of_node", "(", "node_page", ")", ")", "{", "set_sbi_flag", "(", "sbi", ",", "SBI_NEED_FSCK", ")", ";", "f2fs_msg", "(", "sbi", "-", ">", "sb", ",", "KERN_WARNING", ",", "\"", "%", "s", ":", "corrupted", "inode", "footer", "i_ino", "=", "%", "lx", ",", "ino", ",", "nid", ":", "\"", "\"", "[%", "u", ",", "%", "u", "]", "run", "fsck", "to", "fix", ".", "\",", "__func__", ",", "inode", "-", ">", "i_ino", ",", "ino_of_node", "(", "node_page", ")", ",", "nid_of_node", "(", "node_page", ")", ");", "return", "false", ";", "}", "if", "(", "f2fs_sb_has_flexible_inline_xattr", "(", "sbi", "-", ">", "sb", ")", "&", "&", "!", "f2fs_has_extra_attr", "(", "inode", ")", ")", "{", "@", "@", "-", "267", ",", "7", "+", "288", ",", "7", "@", "@", "static", "int", "do_read_inode", "(", "struct", "inode", "*", "inode", ")", "get_inline_info", "(", "inode", ",", "ri", ")", ";", "if", "(", "!", "sanity_check_inode", "(", "inode", ")", ")", "{", "if", "(", "!", "sanity_check_inode", "(", "inode", ",", "node_page", ")", ")", "{", "f2fs_put_page", "(", "node_page", ",", "1", ")", ";", "return", "-", "EINVAL", ";", "}"], "docstring_tokens": ["an", "out-of-bounds", "memory", "access", "flaw"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1807", ",", "10", "+", "1807", ",", "15", "@", "@", "int", "main", "(", "int", "argc", ",", "char", "*", "argv", "[", "])", "}", "}", "if", "(", "query_string", "=", "getenv", "(", "\"", "QUERY_STRING", "\"", "))", "{", "if", "(", "(", "query_string", "=", "getenv", "(", "\"", "QUERY_STRING", "\"", "))", "!", "=", "NULL", "&", "&", "strchr", "(", "query_string", ",", "'", "='", ")", "=", "=", "NULL", ")", "{", "/", "*", "we", "'", "ve", "got", "query", "string", "that", "has", "no", "=", "-", "apache", "CGI", "will", "pass", "it", "to", "command", "line", "*", "/", "unsigned", "char", "*", "p", ";", "decoded_query_string", "=", "strdup", "(", "query_string", ")", ";", "php_url_decode", "(", "decoded_query_string", ",", "strlen", "(", "decoded_query_string", ")", ");", "if", "(", "*", "decoded_query_string", "=", "=", "'", "-'", "&", "&", "strchr", "(", "decoded_query_string", ",", "'", "='", ")", "=", "=", "NULL", ")", "{", "for", "(", "p", "=", "decoded_query_string", ";", "*", "p", "&", "&", "*", "p", "<", "=", "'", "'", ";", "p", "+", "+)", "{", "/", "*", "skip", "all", "leading", "spaces", "*", "/", "}", "if", "(", "*", "p", "=", "=", "'", "-'", ")", "{", "skip_getopt", "=", "1", ";", "}", "free", "(", "decoded_query_string", ")", ";", "@", "@", "-", "2074", ",", "7", "+", "2079", ",", "7", "@", "@", "consult", "the", "installation", "file", "that", "came", "with", "this", "distribution", ",", "or", "visit", "\\", "n", "\\", "}", "zend_first_try", "{", "while", "(", "(", "c", "=", "php_getopt", "(", "argc", ",", "argv", ",", "OPTIONS", ",", "&", "php_optarg", ",", "&", "php_optind", ",", "1", ",", "2", ")", ")", "!", "=", "-", "1", ")", "{", "while", "(", "!", "skip_getopt", "&", "&", "(", "c", "=", "php_getopt", "(", "argc", ",", "argv", ",", "OPTIONS", ",", "&", "php_optarg", ",", "&", "php_optind", ",", "1", ",", "2", ")", ")", "!", "=", "-", "1", ")", "{", "switch", "(", "c", ")", "{", "case", "'", "T", "'", ":", "benchmark", "=", "1", ";"], "docstring_tokens": ["does", "not", "properly", "handle", "query", "strings", "that", "contain", "a", "%3D", "sequence", "but", "no", "=", "(equals", "sign", ")", "character"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "18", ",", "6", "+", "18", ",", "7", "@", "@", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "nio", ".", "ByteBuffer", ";", "import", "java", ".", "nio", ".", "charset", ".", "StandardCharsets", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedActionException", ";", "import", "java", ".", "security", ".", "PrivilegedExceptionAction", ";", "@", "@", "-", "299", ",", "18", "+", "300", ",", "18", "@", "@", "public", "final", "void", "emitHeader", "(", "String", "name", ",", "String", "value", ")", "throws", "HpackException", "{", "getConnectionId", "(", "),", "getIdentifier", "(", "))", ");", "}", "int", "queryStart", "=", "value", ".", "indexOf", "(", "'?", "')", ";", "String", "uri", ";", "if", "(", "queryStart", "=", "=", "-", "1", ")", "{", "coyoteRequest", ".", "requestURI", "(", ").", "setString", "(", "value", ")", ";", "coyoteRequest", ".", "decodedURI", "(", ").", "setString", "(", "coyoteRequest", ".", "getURLDecoder", "(", ").", "convert", "(", "value", ",", "false", ")", ");", "uri", "=", "value", ";", "}", "else", "{", "String", "uri", "=", "value", ".", "substring", "(", "0", ",", "queryStart", ")", ";", "uri", "=", "value", ".", "substring", "(", "0", ",", "queryStart", ")", ";", "String", "query", "=", "value", ".", "substring", "(", "queryStart", "+", "1", ")", ";", "coyoteRequest", ".", "requestURI", "(", ").", "setString", "(", "uri", ")", ";", "coyoteRequest", ".", "decodedURI", "(", ").", "setString", "(", "coyoteRequest", ".", "getURLDecoder", "(", ").", "convert", "(", "uri", ",", "false", ")", ");", "coyoteRequest", ".", "queryString", "(", ").", "setString", "(", "query", ")", ";", "}", "/", "/", "Bug", "61120", ".", "Set", "the", "URI", "as", "bytes", "rather", "than", "String", "so", "any", "path", "/", "/", "parameters", "are", "correctly", "processed", "byte", "[", "]", "uriBytes", "=", "uri", ".", "getBytes", "(", "StandardCharsets", ".", "ISO_8859_1", ")", ";", "coyoteRequest", ".", "requestURI", "(", ").", "setBytes", "(", "uriBytes", ",", "0", ",", "uriBytes", ".", "length", ")", ";", "break", ";", "}", "case", "\"", ":", "authority", "\"", ":", "{", "@", "@", "-", "0", ",", "0", "+", "1", ",", "97", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "coyote", ".", "http2", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "nio", ".", "ByteBuffer", ";", "import", "javax", ".", "servlet", ".", "ServletException", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServlet", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletRequest", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletResponse", ";", "import", "org", ".", "junit", ".", "Assert", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "apache", ".", "catalina", ".", "Context", ";", "import", "org", ".", "apache", ".", "catalina", ".", "startup", ".", "Tomcat", ";", "public", "class", "TestStream", "extends", "Http2TestBase", "{", "/", "*", "*", "https", ":", "//", "bz", ".", "apache", ".", "org", "/", "bugzilla", "/", "show_bug", ".", "cgi", "?", "id", "=", "61120", "*", "/", "@", "Test", "public", "void", "testPathParam", "(", ")", "throws", "Exception", "{", "enableHttp2", "(", ");", "Tomcat", "tomcat", "=", "getTomcatInstance", "(", ");", "Context", "ctxt", "=", "tomcat", ".", "addContext", "(", "\"\"", ",", "null", ")", ";", "Tomcat", ".", "addServlet", "(", "ctxt", ",", "\"", "simple", "\"", ",", "new", "SimpleServlet", "(", "))", ";", "ctxt", ".", "addServletMappingDecoded", "(", "\"/", "simple", "\"", ",", "\"", "simple", "\"", ");", "Tomcat", ".", "addServlet", "(", "ctxt", ",", "\"", "pathparam", "\"", ",", "new", "PathParam", "(", "))", ";", "ctxt", ".", "addServletMappingDecoded", "(", "\"/", "pathparam", "\"", ",", "\"", "pathparam", "\"", ");", "tomcat", ".", "start", "(", ");", "openClientConnection", "(", ");", "doHttpUpgrade", "(", ");", "sendClientPreface", "(", ");", "validateHttp2InitialResponse", "(", ");", "byte", "[", "]", "frameHeader", "=", "new", "byte", "[", "9", "]", ";", "ByteBuffer", "headersPayload", "=", "ByteBuffer", ".", "allocate", "(", "128", ")", ";", "buildGetRequest", "(", "frameHeader", ",", "headersPayload", ",", "null", ",", "3", ",", "\"", "/", "pathparam", ";", "jsessionid", "=", "\"", "+", "PathParam", ".", "EXPECTED_SESSION_ID", ")", ";", "writeFrame", "(", "frameHeader", ",", "headersPayload", ")", ";", "readSimpleGetResponse", "(", ");", "Assert", ".", "assertEquals", "(", "\"", "3", "-", "HeadersStart", "\\", "n", "\"", "\"", "3", "-", "Header", "-", "[:", "status", "]", "-[", "200", "]", "\\", "n", "\"", "\"", "3", "-", "Header", "-", "[", "content", "-", "type", "]", "-[", "text", "/", "plain", ";", "charset", "=", "UTF", "-", "8", "]", "\\", "n", "\"", "\"", "3", "-", "Header", "-", "[", "date", "]", "-[", "Wed", ",", "11", "Nov", "2015", "19", ":", "18", ":", "42", "GMT", "]", "\\", "n", "\"", "\"", "3", "-", "HeadersEnd", "\\", "n", "\"", "\"", "3", "-", "Body", "-", "2", "\\", "n", "\"", "\"", "3", "-", "EndOfStream", "\\", "n", "\"", ",", "output", ".", "getTrace", "(", "))", ";", "}", "private", "static", "final", "class", "PathParam", "extends", "HttpServlet", "{", "private", "static", "final", "long", "serialVersionUID", "=", "1L", ";", "public", "static", "final", "String", "EXPECTED_SESSION_ID", "=", "\"", "0123456789ABCDEF", "\"", ";", "@", "Override", "protected", "void", "doGet", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "throws", "ServletException", ",", "IOException", "{", "response", ".", "setContentType", "(", "\"", "text", "/", "plain", "\"", ");", "response", ".", "setCharacterEncoding", "(", "\"", "UTF", "-", "8", "\"", ");", "if", "(", "EXPECTED_SESSION_ID", ".", "equals", "(", "request", ".", "getRequestedSessionId", "(", "))", ")", "{", "response", ".", "getWriter", "(", ").", "write", "(", "\"", "OK", "\"", ");", "}", "else", "{", "response", ".", "getWriter", "(", ").", "write", "(", "\"", "FAIL", "\"", ");", "}", "}", "}", "}", "@", "@", "-", "69", ",", "6", "+", "69", ",", "10", "@", "@", "<", "bug", ">", "61086", "<", "/", "bug", ">", ":", "Explicitly", "signal", "an", "empty", "request", "body", "for", "HTTP", "205", "responses", ".", "(", "markt", ")", "<", "/", "fix", ">", "<", "fix", ">", "<", "bug", ">", "61120", "<", "/", "bug", ">", ":", "Do", "not", "ignore", "path", "parameters", "when", "processing", "HTTP", "/", "2", "requests", ".", "(", "markt", ")", "<", "/", "fix", ">", "<", "/", "changelog", ">", "<", "/", "subsection", ">", "<", "subsection", "name", "=", "\"", "Jasper", "\"", ">"], "docstring_tokens": ["bypassed", "a", "number", "of", "security", "checks", "that", "prevented", "directory", "traversal", "attacks", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "4527", ",", "7", "+", "4527", ",", "7", "@", "@", "brcmf_cfg80211_start_ap", "(", "struct", "wiphy", "*", "wiphy", ",", "struct", "net_device", "*", "ndev", ",", "(", "u8", "*", ")&", "settings", "-", ">", "beacon", ".", "head", "[", "ie_offset", "]", ",", "settings", "-", ">", "beacon", ".", "head_len", "-", "ie_offset", ",", "WLAN_EID_SSID", ")", ";", "if", "(", "!", "ssid_ie", ")", "if", "(", "!", "ssid_ie", "|", "|", "ssid_ie", "-", ">", "len", ">", "IEEE80211_MAX_SSID_LEN", ")", "return", "-", "EINVAL", ";", "memcpy", "(", "ssid_le", ".", "SSID", ",", "ssid_ie", "-", ">", "data", ",", "ssid_ie", "-", ">", "len", ")", ";"], "docstring_tokens": ["does", "not", "check", "the", "length", "of", "data", "before", "calling", "memcpy", "to", "copy", "the", "data", "to", "stack", "buffer"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "390", ",", "8", "+", "390", ",", "10", "@", "@", "static", "Image", "*", "ReadGROUP4Image", "(", "const", "ImageInfo", "*", "image_info", ",", "length", "=", "fwrite", "(", "\"\\", "000", "\\", "000", "\\", "000", "\\", "000", "\"", ",", "1", ",", "4", ",", "file", ")", ";", "length", "=", "WriteLSBLong", "(", "file", ",", "(", "long", ")", "image", "-", ">", "resolution", ".", "x", ")", ";", "length", "=", "WriteLSBLong", "(", "file", ",", "1", ")", ";", "status", "=", "MagickTrue", ";", "for", "(", "length", "=", "0", ";", "(", "c", "=", "ReadBlobByte", "(", "image", ")", ")", "!", "=", "EOF", ";", "length", "+", "+)", "(", "void", ")", "fputc", "(", "c", ",", "file", ")", ";", "if", "(", "fputc", "(", "c", ",", "file", ")", "!", "=", "c", ")", "status", "=", "MagickFalse", ";", "offset", "=", "(", "ssize_t", ")", "fseek", "(", "file", ",", "(", "ssize_t", ")", "offset", ",", "SEEK_SET", ")", ";", "length", "=", "WriteLSBLong", "(", "file", ",", "(", "unsigned", "int", ")", "length", ")", ";", "(", "void", ")", "fclose", "(", "file", ")", ";", "@", "@", "-", "413", ",", "6", "+", "415", ",", "8", "@", "@", "static", "Image", "*", "ReadGROUP4Image", "(", "const", "ImageInfo", "*", "image_info", ",", "(", "void", ")", "CopyMagickString", "(", "image", "-", ">", "magick", ",", "\"", "GROUP4", "\"", ",", "MagickPathExtent", ")", ";", "}", "(", "void", ")", "RelinquishUniqueFileResource", "(", "filename", ")", ";", "if", "(", "status", "=", "=", "MagickFalse", ")", "image", "=", "DestroyImage", "(", "image", ")", ";", "return", "(", "image", ")", ";", "}", "#", "endif"], "docstring_tokens": ["does", "not", "check", "the", "return", "value", "of", "the", "fputc", "function"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "4929", ",", "7", "+", "4929", ",", "7", "@", "@", "we", "set", "the", "flag", "only", "if", "there", "is", "a", "literal", "\"", "\\", "r", "\"", "or", "\"", "\\", "n", "\"", "in", "the", "class", ".", "*", "/", "(", "lengthptr", "=", "=", "NULL", "|", "|", "*", "lengthptr", "=", "=", "2", "+", "2", "*", "LINK_SIZE", ")", ")", "{", "cd", "-", ">", "external_options", "=", "newoptions", ";", "options", "=", "newoptions", ";", "options", "=", "*", "optionsptr", "=", "newoptions", ";", "}", "else", "{"], "docstring_tokens": ["improper", "bounds", "checking"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "794", ",", "6", "+", "794", ",", "7", "@", "@", "long", "join_session_keyring", "(", "const", "char", "*", "name", ")", "ret", "=", "PTR_ERR", "(", "keyring", ")", ";", "goto", "error2", ";", "}", "else", "if", "(", "keyring", "=", "=", "new", "-", ">", "session_keyring", ")", "{", "key_put", "(", "keyring", ")", ";", "ret", "=", "0", ";", "goto", "error2", ";", "}"], "docstring_tokens": ["mishandles", "object", "references", "in", "a", "certain", "error", "case"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1616", ",", "8", "+", "1616", ",", "14", "@", "@", "int", "wmi_set_ie", "(", "struct", "wil6210_priv", "*", "wil", ",", "u8", "type", ",", "u16", "ie_len", ",", "const", "void", "*", "ie", ")", "}", ";", "int", "rc", ";", "u16", "len", "=", "sizeof", "(", "struct", "wmi_set_appie_cmd", ")", "+", "ie_len", ";", "struct", "wmi_set_appie_cmd", "*", "cmd", "=", "kzalloc", "(", "len", ",", "GFP_KERNEL", ")", ";", "struct", "wmi_set_appie_cmd", "*", "cmd", ";", "if", "(", "len", "<", "ie_len", ")", "{", "rc", "=", "-", "EINVAL", ";", "goto", "out", ";", "}", "cmd", "=", "kzalloc", "(", "len", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "cmd", ")", "{", "rc", "=", "-", "ENOMEM", ";", "goto", "out", ";"], "docstring_tokens": ["does", "not", "handle", "unsigned", "integer", "overflow", "properly", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "27", ",", "7", "+", "27", ",", "7", "@", "@", "<", "/", "scm", ">", "<", "properties", ">", "<", "bintray", ".", "package", ">", "config", "<", "/", "bintray", ".", "package", ">", "<", "spring", "-", "cloud", "-", "commons", ".", "version", ">", "2", ".", "1", ".", "7", ".", "BUILD", "-", "SNAPSHOT", "<", "/", "spring", "-", "cloud", "-", "commons", ".", "version", ">", "<", "spring", "-", "cloud", "-", "commons", ".", "version", ">", "2", ".", "1", ".", "6", ".", "BUILD", "-", "SNAPSHOT", "<", "/", "spring", "-", "cloud", "-", "commons", ".", "version", ">", "<", "maven", "-", "checkstyle", "-", "plugin", ".", "failsOnError", ">", "true", "<", "/", "maven", "-", "checkstyle", "-", "plugin", ".", "failsOnError", ">", "<", "maven", "-", "checkstyle", "-", "plugin", ".", "failsOnViolation", ">", "true", "@", "@", "-", "6", ",", "7", "+", "6", ",", "7", "@", "@", "<", "parent", ">", "<", "artifactId", ">", "spring", "-", "cloud", "-", "dependencies", "-", "parent", "<", "/", "artifactId", ">", "<", "groupId", ">", "org", ".", "springframework", ".", "cloud", "<", "/", "groupId", ">", "<", "version", ">", "2", ".", "1", ".", "12", ".", "BUILD", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "2", ".", "1", ".", "11", ".", "BUILD", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "relativePath", "/", ">", "<", "/", "parent", ">", "<", "artifactId", ">", "spring", "-", "cloud", "-", "config", "-", "dependencies", "<", "/", "artifactId", ">", "@", "@", "-", "17", ",", "6", "+", "17", ",", "7", "@", "@", "package", "org", ".", "springframework", ".", "cloud", ".", "config", ".", "server", ".", "resource", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "LinkedHashSet", ";", "import", "java", ".", "util", ".", "Set", ";", "@", "@", "-", "56", ",", "18", "+", "57", ",", "22", "@", "@", "public", "synchronized", "Resource", "findOne", "(", "String", "application", ",", "String", "profile", ",", "String", "if", "(", "StringUtils", ".", "hasText", "(", "path", ")", ")", "{", "String", "[", "]", "locations", "=", "this", ".", "service", ".", "getLocations", "(", "application", ",", "profile", ",", "label", ")", ".", "getLocations", "(", ");", "ArrayList", "<", "Resource", ">", "locationResources", "=", "new", "ArrayList", "<", ">(", ");", "for", "(", "int", "i", "=", "locations", ".", "length", ";", "i", "-", "-", ">", "0", ";", ")", "{", "String", "location", "=", "locations", "[", "i", "]", ";", "if", "(", "!", "PathUtils", ".", "isInvalidEncodedLocation", "(", "location", ")", ")", "{", "locationResources", ".", "add", "(", "this", ".", "resourceLoader", ".", "getResource", "(", "location", ")", ");", "}", "}", "try", "{", "for", "(", "int", "i", "=", "locations", ".", "length", ";", "i", "-", "-", ">", "0", ";", ")", "{", "String", "location", "=", "locations", "[", "i", "]", ";", "if", "(", "PathUtils", ".", "isInvalidEncodedLocation", "(", "location", ")", ")", "{", "continue", ";", "}", "for", "(", "Resource", "location", ":", "locationResources", ")", "{", "for", "(", "String", "local", ":", "getProfilePaths", "(", "profile", ",", "path", ")", ")", "{", "if", "(", "!", "PathUtils", ".", "isInvalidPath", "(", "local", ")", "&", "&", "!", "PathUtils", ".", "isInvalidEncodedPath", "(", "local", ")", ")", "{", "Resource", "file", "=", "this", ".", "resourceLoader", ".", "getResource", "(", "location", ")", ".", "createRelative", "(", "local", ")", ";", "if", "(", "file", ".", "exists", "(", ")", "&", "&", "file", ".", "isReadable", "(", "))", "{", "Resource", "file", "=", "location", ".", "createRelative", "(", "local", ")", ";", "if", "(", "file", ".", "exists", "(", ")", "&", "&", "file", ".", "isReadable", "(", ")", "&", "&", "PathUtils", ".", "checkResource", "(", "file", ",", "location", ",", "locationResources", ")", ")", "{", "return", "file", ";", "}", "}", "@", "@", "-", "16", ",", "12", "+", "16", ",", "17", "@", "@", "package", "org", ".", "springframework", ".", "cloud", ".", "config", ".", "server", ".", "support", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "UnsupportedEncodingException", ";", "import", "java", ".", "net", ".", "URLDecoder", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "Log", ";", "import", "org", ".", "apache", ".", "commons", ".", "logging", ".", "LogFactory", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "UrlResource", ";", "import", "org", ".", "springframework", ".", "util", ".", "ResourceUtils", ";", "import", "org", ".", "springframework", ".", "util", ".", "StringUtils", ";", "@", "@", "-", "203", ",", "4", "+", "208", ",", "71", "@", "@", "public", "static", "boolean", "isInvalidPath", "(", "String", "path", ")", "{", "return", "false", ";", "}", "/", "**", "*", "Perform", "additional", "checks", "on", "a", "resolved", "resource", "beyond", "checking", "whether", "the", "*", "resources", "exists", "and", "is", "readable", ".", "The", "default", "implementation", "also", "verifies", "the", "*", "resource", "is", "either", "under", "the", "location", "relative", "to", "which", "it", "was", "found", "or", "is", "under", "*", "one", "of", "the", "{", "@", "link", "#", "setAllowedLocations", "allowed", "locations", "}", ".", "*", "@", "param", "resource", "the", "resource", "to", "check", "*", "@", "param", "location", "the", "location", "relative", "to", "which", "the", "resource", "was", "found", "*", "@", "param", "allowedLocations", "set", "of", "allowed", "locations", "*", "@", "return", "\"", "true", "\"", "if", "resource", "is", "in", "a", "valid", "location", ",", "\"", "false", "\"", "otherwise", ".", "*", "@", "throws", "IOException", "if", "Resource", "URLS", "fail", "to", "parse", ".", "*", "@", "since", "4", ".", "1", ".", "2", "*", "/", "public", "static", "boolean", "checkResource", "(", "Resource", "resource", ",", "Resource", "location", ",", "List", "<", "Resource", ">", "allowedLocations", ")", "throws", "IOException", "{", "if", "(", "isResourceUnderLocation", "(", "resource", ",", "location", ")", ")", "{", "return", "true", ";", "}", "if", "(", "allowedLocations", "!", "=", "null", ")", "{", "for", "(", "Resource", "current", ":", "allowedLocations", ")", "{", "if", "(", "isResourceUnderLocation", "(", "resource", ",", "current", ")", ")", "{", "return", "true", ";", "}", "}", "}", "if", "(", "logger", ".", "isWarnEnabled", "(", "))", "{", "logger", ".", "warn", "(", "\"", "Resource", "path", "\\", "\"\"", "+", "location", ".", "getURI", "(", ")", "+", "\"", "\\\"", "was", "successfully", "resolved", "\"", "+", "\"", "but", "resource", "\\", "\"\"", "+", "resource", ".", "getURL", "(", ")", "+", "\"", "\\\"", "is", "neither", "under", "the", "\"", "+", "\"", "current", "location", "\\", "\"\"", "+", "location", ".", "getURL", "(", ")", "+", "\"", "\\\"", "nor", "under", "any", "of", "the", "\"", "+", "\"", "allowed", "locations", "\"", "+", "(", "allowedLocations", "!", "=", "null", "?", "allowedLocations", ":", "\"", "[]", "\")", ");", "}", "return", "false", ";", "}", "private", "static", "boolean", "isResourceUnderLocation", "(", "Resource", "resource", ",", "Resource", "location", ")", "throws", "IOException", "{", "if", "(", "resource", ".", "getClass", "(", ")", "!", "=", "location", ".", "getClass", "(", "))", "{", "return", "false", ";", "}", "String", "resourcePath", ";", "String", "locationPath", ";", "if", "(", "resource", "instanceof", "UrlResource", ")", "{", "resourcePath", "=", "resource", ".", "getURL", "(", ").", "toExternalForm", "(", ");", "locationPath", "=", "StringUtils", ".", "cleanPath", "(", "location", ".", "getURL", "(", ").", "toString", "(", "))", ";", "}", "else", "if", "(", "resource", "instanceof", "ClassPathResource", ")", "{", "resourcePath", "=", "(", "(", "ClassPathResource", ")", "resource", ")", ".", "getPath", "(", ");", "locationPath", "=", "StringUtils", ".", "cleanPath", "(", "((", "ClassPathResource", ")", "location", ")", ".", "getPath", "(", "))", ";", "}", "else", "{", "resourcePath", "=", "resource", ".", "getURL", "(", ").", "getPath", "(", ");", "locationPath", "=", "StringUtils", ".", "cleanPath", "(", "location", ".", "getURL", "(", ").", "getPath", "(", "))", ";", "}", "if", "(", "locationPath", ".", "equals", "(", "resourcePath", ")", ")", "{", "return", "true", ";", "}", "locationPath", "=", "(", "locationPath", ".", "endsWith", "(", "\"/", "\")", "|", "|", "locationPath", ".", "isEmpty", "(", ")", "?", "locationPath", ":", "locationPath", "+", "\"", "/\"", ");", "return", "(", "resourcePath", ".", "startsWith", "(", "locationPath", ")", "&", "&", "!", "isInvalidEncodedPath", "(", "resourcePath", ")", ");", "}", "}", "@", "@", "-", "120", ",", "6", "+", "120", ",", "17", "@", "@", "public", "void", "invalidPathWithPreviousDirectoryAllEncoded", "(", ")", "{", "testInvalidPath", "(", "\"%", "2E", "%", "2E", "%", "2F", "\"", ");", "}", "@", "Test", "public", "void", "invalidPathEncodedSlash", "(", ")", "{", "String", "file", "=", "System", ".", "getProperty", "(", "\"", "user", ".", "dir", "\"", ");", "file", "=", "file", ".", "replaceFirst", "(", "\"\\", "\\/", "\",", "\"", "%", "2f", "\"", ");", "file", "+", "=", "\"", "/", "src", "/", "test", "/", "resources", "/", "ssh", "/", "key", "\"", ";", "this", ".", "exception", ".", "expect", "(", "NoSuchResourceException", ".", "class", ")", ";", "this", ".", "nativeRepository", ".", "setSearchLocations", "(", "\"", "file", ":", "./", "\")", ";", "this", ".", "output", ".", "expect", "(", "containsString", "(", "\"", "is", "neither", "under", "the", "current", "location", "\"", "))", ";", "this", ".", "repository", ".", "findOne", "(", "\"", "blah", "\"", ",", "\"", "local", "\"", ",", "\"", "master", "\"", ",", "file", ")", ";", "}", "private", "void", "testInvalidPath", "(", "String", "label", ")", "{", "this", ".", "exception", ".", "expect", "(", "NoSuchResourceException", ".", "class", ")", ";", "this", ".", "nativeRepository", ".", "setSearchLocations", "(", "\"", "file", ":", "./", "src", "/", "test", "/", "resources", "/", "test", "/", "local", "\"", ");"], "docstring_tokens": ["improper", "validation", "of", "user-supplied", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "34", ",", "18", "+", "34", ",", "19", "@", "@", "import", "org", ".", "apache", ".", "openmeetings", ".", "db", ".", "dao", ".", "user", ".", "GroupDao", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "db", ".", "dao", ".", "user", ".", "IUserService", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "db", ".", "dao", ".", "user", ".", "UserDao", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "db", ".", "entity", ".", "room", ".", "StreamClient", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "db", ".", "entity", ".", "room", ".", "Room", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "db", ".", "entity", ".", "room", ".", "Room", ".", "RoomElement", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "db", ".", "entity", ".", "room", ".", "RoomGroup", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "db", ".", "entity", ".", "room", ".", "RoomModerator", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "db", ".", "entity", ".", "room", ".", "StreamClient", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "db", ".", "entity", ".", "user", ".", "Address", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "db", ".", "entity", ".", "user", ".", "Group", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "db", ".", "entity", ".", "user", ".", "User", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "admin", ".", "AdminBaseForm", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "admin", ".", "AdminUserChoiceProvider", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "app", ".", "Application", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "common", ".", "ConfirmableAjaxBorder", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "util", ".", "RestrictiveChoiceProvider", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "util", ".", "RoomTypeDropDown", ";", "import", "org", ".", "apache", ".", "wicket", ".", "AttributeModifier", ";", "import", "org", ".", "apache", ".", "wicket", ".", "ajax", ".", "AjaxRequestTarget", ";", "@", "@", "-", "148", ",", "7", "+", "149", ",", "7", "@", "@", "public", "String", "getIdValue", "(", "Long", "id", ",", "int", "index", ")", "{", "for", "(", "Group", "org", ":", "orgList", ")", "{", "orgRooms", ".", "add", "(", "new", "RoomGroup", "(", "org", ",", "getModelObject", "(", "))", ");", "}", "add", "(", "new", "Select2MultiChoice", "<", ">(", "\"", "roomGroups", "\"", ",", "null", ",", "new", "ChoiceProvider", "<", "RoomGroup", ">", "()", "{", "add", "(", "new", "Select2MultiChoice", "<", ">(", "\"", "roomGroups", "\"", ",", "null", ",", "new", "RestrictiveChoiceProvider", "<", "RoomGroup", ">", "()", "{", "private", "static", "final", "long", "serialVersionUID", "=", "1L", ";", "@", "Override", "@", "@", "-", "158", ",", "7", "+", "159", ",", "7", "@", "@", "public", "String", "getDisplayValue", "(", "RoomGroup", "choice", ")", "{", "}", "@", "Override", "public", "String", "getIdValue", "(", "RoomGroup", "choice", ")", "{", "public", "String", "toId", "(", "RoomGroup", "choice", ")", "{", "Long", "id", "=", "choice", ".", "getGroup", "(", ").", "getId", "(", ");", "return", "id", "=", "=", "null", "?", "null", ":", "\"", "\"", "+", "id", ";", "}", "@", "@", "-", "173", ",", "16", "+", "174", ",", "10", "@", "@", "public", "void", "query", "(", "String", "term", ",", "int", "page", ",", "Response", "<", "RoomGroup", ">", "response", ")", "{", "}", "@", "Override", "public", "Collection", "<", "RoomGroup", ">", "toChoices", "(", "Collection", "<", "String", ">", "_ids", ")", "{", "List", "<", "Long", ">", "ids", "=", "new", "ArrayList", "<", ">(", ");", "for", "(", "String", "id", ":", "_ids", ")", "{", "ids", ".", "add", "(", "Long", ".", "valueOf", "(", "id", ")", ");", "}", "List", "<", "RoomGroup", ">", "list", "=", "new", "ArrayList", "<", ">(", ");", "for", "(", "Group", "o", ":", "getBean", "(", "GroupDao", ".", "class", ")", ".", "get", "(", "ids", ")", ")", "{", "list", ".", "add", "(", "new", "RoomGroup", "(", "o", ",", "RoomForm", ".", "this", ".", "getModelObject", "(", "))", ");", "}", "return", "list", ";", "public", "RoomGroup", "fromId", "(", "String", "_id", ")", "{", "Long", "id", "=", "Long", ".", "valueOf", "(", "_id", ")", ";", "Group", "g", "=", "getBean", "(", "GroupDao", ".", "class", ")", ".", "get", "(", "id", ")", ";", "return", "new", "RoomGroup", "(", "g", ",", "RoomForm", ".", "this", ".", "getModelObject", "(", "))", ";", "}", "}", ").", "setLabel", "(", "Model", ".", "of", "(", "getString", "(", "\"", "828", "\"", "))", ").", "setRequired", "(", "isGroupAdmin", ")", ");", "@", "@", "-", "30", ",", "7", "+", "30", ",", "6", "@", "@", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "Hashtable", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "@", "@", "-", "50", ",", "6", "+", "49", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "app", ".", "Application", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "common", ".", "ComunityUserForm", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "common", ".", "GeneralUserForm", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "util", ".", "RestrictiveChoiceProvider", ";", "import", "org", ".", "apache", ".", "wicket", ".", "ajax", ".", "AjaxRequestTarget", ";", "import", "org", ".", "apache", ".", "wicket", ".", "ajax", ".", "form", ".", "AjaxFormValidatingBehavior", ";", "import", "org", ".", "apache", ".", "wicket", ".", "ajax", ".", "form", ".", "OnChangeAjaxBehavior", ";", "@", "@", "-", "68", ",", "7", "+", "68", ",", "6", "@", "@", "import", "org", ".", "apache", ".", "wicket", ".", "util", ".", "time", ".", "Duration", ";", "import", "org", ".", "red5", ".", "logging", ".", "Red5LoggerFactory", ";", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "wicketstuff", ".", "select2", ".", "ChoiceProvider", ";", "import", "org", ".", "wicketstuff", ".", "select2", ".", "Response", ";", "import", "org", ".", "wicketstuff", ".", "select2", ".", "Select2MultiChoice", ";", "@", "@", "-", "192", ",", "7", "+", "191", ",", "7", "@", "@", "protected", "void", "onUpdate", "(", "AjaxRequestTarget", "target", ")", "{", "add", "(", "new", "CheckBox", "(", "\"", "forceTimeZoneCheck", "\"", "))", ";", "add", "(", "new", "Select2MultiChoice", "<", ">(", "\"", "rights", "\"", ",", "null", ",", "new", "ChoiceProvider", "<", "Right", ">", "()", "{", "add", "(", "new", "Select2MultiChoice", "<", ">(", "\"", "rights", "\"", ",", "null", ",", "new", "RestrictiveChoiceProvider", "<", "Right", ">", "()", "{", "private", "static", "final", "long", "serialVersionUID", "=", "1L", ";", "@", "Override", "@", "@", "-", "201", ",", "7", "+", "200", ",", "7", "@", "@", "public", "String", "getDisplayValue", "(", "Right", "choice", ")", "{", "}", "@", "Override", "public", "String", "getIdValue", "(", "Right", "choice", ")", "{", "public", "String", "toId", "(", "Right", "choice", ")", "{", "return", "choice", ".", "name", "(", ");", "}", "@", "@", "-", "222", ",", "12", "+", "221", ",", "8", "@", "@", "public", "void", "query", "(", "String", "term", ",", "int", "page", ",", "Response", "<", "Right", ">", "response", ")", "{", "}", "@", "Override", "public", "Collection", "<", "Right", ">", "toChoices", "(", "Collection", "<", "String", ">", "ids", ")", "{", "Collection", "<", "Right", ">", "rights", "=", "new", "ArrayList", "<", ">(", "ids", ".", "size", "(", "))", ";", "for", "(", "String", "id", ":", "ids", ")", "{", "rights", ".", "add", "(", "Right", ".", "valueOf", "(", "id", ")", ");", "}", "return", "rights", ";", "public", "Right", "fromId", "(", "String", "id", ")", "{", "return", "Right", ".", "valueOf", "(", "id", ")", ";", "}", "}", "))", ";", "add", "(", "new", "ComunityUserForm", "(", "\"", "comunity", "\"", ",", "getModel", "(", "))", ");", "@", "@", "-", "28", ",", "7", "+", "28", ",", "6", "@", "@", "import", "java", ".", "time", ".", "LocalDate", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "core", ".", "util", ".", "StrongPasswordValidator", ";", "@", "@", "-", "43", ",", "6", "+", "42", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "app", ".", "Application", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "app", ".", "WebSession", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "util", ".", "CountryDropDown", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "util", ".", "RestrictiveChoiceProvider", ";", "import", "org", ".", "apache", ".", "wicket", ".", "core", ".", "request", ".", "handler", ".", "IPartialPageRequestHandler", ";", "import", "org", ".", "apache", ".", "wicket", ".", "extensions", ".", "validation", ".", "validator", ".", "RfcCompliantEmailAddressValidator", ";", "import", "org", ".", "apache", ".", "wicket", ".", "markup", ".", "head", ".", "IHeaderResponse", ";", "@", "@", "-", "60", ",", "7", "+", "60", ",", "6", "@", "@", "import", "org", ".", "apache", ".", "wicket", ".", "model", ".", "Model", ";", "import", "org", ".", "apache", ".", "wicket", ".", "model", ".", "PropertyModel", ";", "import", "org", ".", "apache", ".", "wicket", ".", "util", ".", "string", ".", "Strings", ";", "import", "org", ".", "wicketstuff", ".", "select2", ".", "ChoiceProvider", ";", "import", "org", ".", "wicketstuff", ".", "select2", ".", "Response", ";", "import", "org", ".", "wicketstuff", ".", "select2", ".", "Select2MultiChoice", ";", "@", "@", "-", "134", ",", "7", "+", "133", ",", "7", "@", "@", "public", "void", "onValueChanged", "(", "IPartialPageRequestHandler", "target", ")", "{", "@", "Override", "protected", "void", "onInitialize", "(", ")", "{", "super", ".", "onInitialize", "(", ");", "add", "(", "new", "Select2MultiChoice", "<", ">(", "\"", "groupUsers", "\"", ",", "null", ",", "new", "ChoiceProvider", "<", "GroupUser", ">", "()", "{", "add", "(", "new", "Select2MultiChoice", "<", ">(", "\"", "groupUsers", "\"", ",", "null", ",", "new", "RestrictiveChoiceProvider", "<", "GroupUser", ">", "()", "{", "private", "static", "final", "long", "serialVersionUID", "=", "1L", ";", "@", "Override", "@", "@", "-", "143", ",", "7", "+", "142", ",", "7", "@", "@", "public", "String", "getDisplayValue", "(", "GroupUser", "choice", ")", "{", "}", "@", "Override", "public", "String", "getIdValue", "(", "GroupUser", "choice", ")", "{", "public", "String", "toId", "(", "GroupUser", "choice", ")", "{", "Long", "id", "=", "choice", ".", "getGroup", "(", ").", "getId", "(", ");", "return", "id", "=", "=", "null", "?", "null", ":", "\"", "\"", "+", "id", ";", "}", "@", "@", "-", "158", ",", "19", "+", "157", ",", "13", "@", "@", "public", "void", "query", "(", "String", "term", ",", "int", "page", ",", "Response", "<", "GroupUser", ">", "response", ")", "{", "}", "@", "Override", "public", "Collection", "<", "GroupUser", ">", "toChoices", "(", "Collection", "<", "String", ">", "_ids", ")", "{", "List", "<", "Long", ">", "ids", "=", "new", "ArrayList", "<", ">(", ");", "for", "(", "String", "id", ":", "_ids", ")", "{", "ids", ".", "add", "(", "Long", ".", "parseLong", "(", "id", ")", ");", "}", "List", "<", "GroupUser", ">", "list", "=", "new", "ArrayList", "<", ">(", ");", "public", "GroupUser", "fromId", "(", "String", "_id", ")", "{", "Long", "id", "=", "Long", ".", "parseLong", "(", "_id", ")", ";", "User", "u", "=", "GeneralUserForm", ".", "this", ".", "getModelObject", "(", ");", "for", "(", "Group", "g", ":", "getBean", "(", "GroupDao", ".", "class", ")", ".", "get", "(", "ids", ")", ")", "{", "GroupUser", "gu", "=", "new", "GroupUser", "(", "g", ",", "u", ")", ";", "int", "idx", "=", "grpUsers", ".", "indexOf", "(", "gu", ")", ";", "list", ".", "add", "(", "idx", "<", "0", "?", "gu", ":", "grpUsers", ".", "get", "(", "idx", ")", ");", "}", "return", "list", ";", "Group", "g", "=", "getBean", "(", "GroupDao", ".", "class", ")", ".", "get", "(", "id", ")", ";", "GroupUser", "gu", "=", "new", "GroupUser", "(", "g", ",", "u", ")", ";", "int", "idx", "=", "grpUsers", ".", "indexOf", "(", "gu", ")", ";", "return", "idx", "<", "0", "?", "gu", ":", "grpUsers", ".", "get", "(", "idx", ")", ";", "}", "}", ").", "setLabel", "(", "Model", ".", "of", "(", "getString", "(", "\"", "161", "\"", "))", ").", "setRequired", "(", "isAdminForm", "&", "&", "hasGroupAdminLevel", "(", "getRights", "(", "))", ").", "setEnabled", "(", "isAdminForm", ")", ");", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "59", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "*", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "*", "distributed", "with", "this", "work", "for", "additional", "information", "*", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "*", "to", "you", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ")", "+", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "*", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "*", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "*", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "*", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "*", "specific", "language", "governing", "permissions", "and", "limitations", "*", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "util", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "org", ".", "wicketstuff", ".", "select2", ".", "ChoiceProvider", ";", "public", "abstract", "class", "RestrictiveChoiceProvider", "<", "T", ">", "extends", "ChoiceProvider", "<", "T", ">", "{", "private", "static", "final", "long", "serialVersionUID", "=", "1L", ";", "private", "final", "Set", "<", "String", ">", "ids", "=", "new", "HashSet", "<", ">(", ");", "public", "abstract", "String", "toId", "(", "T", "e", ")", ";", "public", "abstract", "T", "fromId", "(", "String", "id", ")", ";", "@", "Override", "public", "final", "String", "getIdValue", "(", "T", "e", ")", "{", "String", "id", "=", "toId", "(", "e", ")", ";", "ids", ".", "add", "(", "id", ")", ";", "return", "id", ";", "}", "@", "Override", "public", "final", "Collection", "<", "T", ">", "toChoices", "(", "Collection", "<", "String", ">", "_ids", ")", "{", "Collection", "<", "T", ">", "c", "=", "new", "ArrayList", "<", ">(", ");", "for", "(", "String", "id", ":", "_ids", ")", "{", "if", "(", "ids", ".", "contains", "(", "id", ")", ")", "{", "T", "e", "=", "fromId", "(", "id", ")", ";", "if", "(", "e", "!", "=", "null", ")", "{", "c", ".", "add", "(", "e", ")", ";", "}", "}", "}", "return", "c", ";", "}", "@", "Override", "public", "void", "detach", "(", ")", "{", "}", "}", "@", "@", "-", "21", ",", "9", "+", "21", ",", "7", "@", "@", "import", "static", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "app", ".", "Application", ".", "getBean", ";", "import", "static", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "app", ".", "WebSession", ".", "getUserId", ";", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "Hashtable", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "db", ".", "dao", ".", "user", ".", "UserDao", ";", "@", "@", "-", "33", ",", "16", "+", "31", ",", "15", "@", "@", "import", "org", ".", "apache", ".", "wicket", ".", "extensions", ".", "validation", ".", "validator", ".", "RfcCompliantEmailAddressValidator", ";", "import", "org", ".", "apache", ".", "wicket", ".", "util", ".", "string", ".", "Strings", ";", "import", "org", ".", "apache", ".", "wicket", ".", "validation", ".", "Validatable", ";", "import", "org", ".", "wicketstuff", ".", "select2", ".", "ChoiceProvider", ";", "import", "org", ".", "wicketstuff", ".", "select2", ".", "Response", ";", "import", "com", ".", "github", ".", "openjson", ".", "JSONException", ";", "import", "com", ".", "github", ".", "openjson", ".", "JSONStringer", ";", "public", "class", "UserChoiceProvider", "extends", "ChoiceProvider", "<", "User", ">", "{", "public", "class", "UserChoiceProvider", "extends", "RestrictiveChoiceProvider", "<", "User", ">", "{", "private", "static", "final", "long", "serialVersionUID", "=", "1L", ";", "private", "final", "static", "int", "PAGE_SIZE", "=", "10", ";", "private", "Map", "<", "String", ",", "User", ">", "newContacts", "=", "new", "Hashtable", "<", ">(", ");", "private", "final", "Map", "<", "String", ",", "User", ">", "newContacts", "=", "new", "HashMap", "<", ">(", ");", "public", "static", "User", "getUser", "(", "String", "value", ")", "{", "User", "u", "=", "null", ";", "@", "@", "-", "81", ",", "7", "+", "78", ",", "7", "@", "@", "public", "static", "User", "getUser", "(", "String", "value", ")", "{", "}", "@", "Override", "public", "String", "getIdValue", "(", "User", "u", ")", "{", "public", "String", "toId", "(", "User", "u", ")", "{", "String", "id", "=", "\"", "\"", "+", "u", ".", "getId", "(", ");", "if", "(", "u", ".", "getId", "(", ")", "=", "=", "null", ")", "{", "newContacts", ".", "put", "(", "u", ".", "getLogin", "(", "),", "u", ")", ";", "@", "@", "-", "108", ",", "16", "+", "105", ",", "14", "@", "@", "public", "void", "query", "(", "String", "term", ",", "int", "page", ",", "Response", "<", "User", ">", "response", ")", "{", "}", "@", "Override", "public", "Collection", "<", "User", ">", "toChoices", "(", "Collection", "<", "String", ">", "ids", ")", "{", "Collection", "<", "User", ">", "c", "=", "new", "ArrayList", "<", ">(", ");", "for", "(", "String", "id", ":", "ids", ")", "{", "if", "(", "newContacts", ".", "containsKey", "(", "id", ")", ")", "{", "c", ".", "add", "(", "newContacts", ".", "get", "(", "id", ")", ");", "}", "else", "{", "c", ".", "add", "(", "getBean", "(", "UserDao", ".", "class", ")", ".", "get", "(", "Long", ".", "valueOf", "(", "id", ")", "))", ";", "}", "public", "User", "fromId", "(", "String", "id", ")", "{", "User", "u", "=", "null", ";", "if", "(", "newContacts", ".", "containsKey", "(", "id", ")", ")", "{", "u", "=", "newContacts", ".", "get", "(", "id", ")", ";", "}", "else", "{", "u", "=", "getBean", "(", "UserDao", ".", "class", ")", ".", "get", "(", "Long", ".", "valueOf", "(", "id", ")", ");", "}", "return", "c", ";", "return", "u", ";", "}", "@", "Override"], "docstring_tokens": ["has", "access", "to", "restricted", "areas"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "30", ",", "6", "+", "30", ",", "7", "@", "@", "#", "include", "<", "linux", "/", "mempolicy", ".", "h", ">", "#", "include", "<", "linux", "/", "vmalloc", ".", "h", ">", "#", "include", "<", "linux", "/", "security", ".", "h", ">", "#", "include", "<", "linux", "/", "backing", "-", "dev", ".", "h", ">", "#", "include", "<", "linux", "/", "syscalls", ".", "h", ">", "#", "include", "<", "linux", "/", "hugetlb", ".", "h", ">", "#", "include", "<", "linux", "/", "hugetlb_cgroup", ".", "h", ">", "@", "@", "-", "313", ",", "6", "+", "314", ",", "8", "@", "@", "int", "migrate_page_move_mapping", "(", "struct", "address_space", "*", "mapping", ",", "struct", "buffer_head", "*", "head", ",", "enum", "migrate_mode", "mode", ",", "int", "extra_count", ")", "{", "struct", "zone", "*", "oldzone", ",", "*", "newzone", ";", "int", "dirty", ";", "int", "expected_count", "=", "1", "+", "extra_count", ";", "void", "*", "*", "pslot", ";", "@", "@", "-", "331", ",", "6", "+", "334", ",", "9", "@", "@", "int", "migrate_page_move_mapping", "(", "struct", "address_space", "*", "mapping", ",", "return", "MIGRATEPAGE_SUCCESS", ";", "}", "oldzone", "=", "page_zone", "(", "page", ")", ";", "newzone", "=", "page_zone", "(", "newpage", ")", ";", "spin_lock_irq", "(", "&", "mapping", "-", ">", "tree_lock", ")", ";", "pslot", "=", "radix_tree_lookup_slot", "(", "&", "mapping", "-", ">", "page_tree", ",", "@", "@", "-", "378", ",", "6", "+", "384", ",", "13", "@", "@", "int", "migrate_page_move_mapping", "(", "struct", "address_space", "*", "mapping", ",", "set_page_private", "(", "newpage", ",", "page_private", "(", "page", ")", ");", "}", "/", "*", "Move", "dirty", "while", "page", "refs", "frozen", "and", "newpage", "not", "yet", "exposed", "*", "/", "dirty", "=", "PageDirty", "(", "page", ")", ";", "if", "(", "dirty", ")", "{", "ClearPageDirty", "(", "page", ")", ";", "SetPageDirty", "(", "newpage", ")", ";", "}", "radix_tree_replace_slot", "(", "pslot", ",", "newpage", ")", ";", "/", "*", "@", "@", "-", "387", ",", "6", "+", "400", ",", "9", "@", "@", "int", "migrate_page_move_mapping", "(", "struct", "address_space", "*", "mapping", ",", "*", "/", "page_unfreeze_refs", "(", "page", ",", "expected_count", "-", "1", ")", ";", "spin_unlock", "(", "&", "mapping", "-", ">", "tree_lock", ")", ";", "/", "*", "Leave", "irq", "disabled", "to", "prevent", "preemption", "while", "updating", "stats", "*", "/", "/", "*", "*", "If", "moved", "to", "a", "different", "zone", "then", "also", "account", "*", "the", "page", "for", "that", "zone", ".", "Other", "VM", "counters", "will", "be", "@", "@", "-", "397", ",", "13", "+", "413", ",", "19", "@", "@", "int", "migrate_page_move_mapping", "(", "struct", "address_space", "*", "mapping", ",", "*", "via", "NR_FILE_PAGES", "and", "NR_ANON_PAGES", "if", "they", "*", "are", "mapped", "to", "swap", "space", ".", "*", "/", "__dec_zone_page_state", "(", "page", ",", "NR_FILE_PAGES", ")", ";", "__inc_zone_page_state", "(", "newpage", ",", "NR_FILE_PAGES", ")", ";", "if", "(", "!", "PageSwapCache", "(", "page", ")", "&", "&", "PageSwapBacked", "(", "page", ")", ")", "{", "__dec_zone_page_state", "(", "page", ",", "NR_SHMEM", ")", ";", "__inc_zone_page_state", "(", "newpage", ",", "NR_SHMEM", ")", ";", "if", "(", "newzone", "!", "=", "oldzone", ")", "{", "__dec_zone_state", "(", "oldzone", ",", "NR_FILE_PAGES", ")", ";", "__inc_zone_state", "(", "newzone", ",", "NR_FILE_PAGES", ")", ";", "if", "(", "PageSwapBacked", "(", "page", ")", "&", "&", "!", "PageSwapCache", "(", "page", ")", ")", "{", "__dec_zone_state", "(", "oldzone", ",", "NR_SHMEM", ")", ";", "__inc_zone_state", "(", "newzone", ",", "NR_SHMEM", ")", ";", "}", "if", "(", "dirty", "&", "&", "mapping_cap_account_dirty", "(", "mapping", ")", ")", "{", "__dec_zone_state", "(", "oldzone", ",", "NR_FILE_DIRTY", ")", ";", "__inc_zone_state", "(", "newzone", ",", "NR_FILE_DIRTY", ")", ";", "}", "}", "spin_unlock_irq", "(", "&", "mapping", "-", ">", "tree_lock", ")", ";", "local_irq_enable", "(", ");", "return", "MIGRATEPAGE_SUCCESS", ";", "}", "@", "@", "-", "524", ",", "20", "+", "546", ",", "9", "@", "@", "void", "migrate_page_copy", "(", "struct", "page", "*", "newpage", ",", "struct", "page", "*", "page", ")", "if", "(", "PageMappedToDisk", "(", "page", ")", ")", "SetPageMappedToDisk", "(", "newpage", ")", ";", "if", "(", "PageDirty", "(", "page", ")", ")", "{", "clear_page_dirty_for_io", "(", "page", ")", ";", "/", "*", "*", "Want", "to", "mark", "the", "page", "and", "the", "radix", "tree", "as", "dirty", ",", "and", "*", "redo", "the", "accounting", "that", "clear_page_dirty_for_io", "undid", ",", "*", "but", "we", "can", "'", "t", "use", "set_page_dirty", "because", "that", "function", "*", "is", "actually", "a", "signal", "that", "all", "of", "the", "page", "has", "become", "dirty", ".", "*", "Whereas", "only", "part", "of", "our", "page", "may", "be", "dirty", ".", "*", "/", "if", "(", "PageSwapBacked", "(", "page", ")", ")", "SetPageDirty", "(", "newpage", ")", ";", "else", "__set_page_dirty_nobuffers", "(", "newpage", ")", ";", "}", "/", "*", "Move", "dirty", "on", "pages", "not", "done", "by", "migrate_page_move_mapping", "(", ")", "*", "/", "if", "(", "PageDirty", "(", "page", ")", ")", "SetPageDirty", "(", "newpage", ")", ";", "if", "(", "page_is_young", "(", "page", ")", ")", "set_page_young", "(", "newpage", ")", ";"], "docstring_tokens": ["improperly", "interacts", "with", "mm/migrate.c"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "72", ",", "6", "+", "72", ",", "7", "@", "@", "import", "org", ".", "kohsuke", ".", "stapler", ".", "QueryParameter", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "Stapler", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "interceptor", ".", "RequirePOST", ";", "/", "**", "*", "Convenience", "structure", "encapsulating", "a", "Groovy", "script", "that", "may", "either", "be", "approved", "whole", "or", "sandboxed", ".", "@", "@", "-", "407", ",", "9", "+", "408", ",", "11", "@", "@", "public", "Object", "evaluate", "(", "ClassLoader", "loader", ",", "Binding", "binding", ")", "throws", "Exception", "{", "return", "\"", "\";", "/", "/", "not", "intended", "to", "be", "displayed", "on", "its", "own", "}", "@", "RequirePOST", "public", "FormValidation", "doCheckScript", "(", "@", "QueryParameter", "String", "value", ",", "@", "QueryParameter", "boolean", "sandbox", ")", "{", "try", "{", "new", "GroovyShell", "(", "Jenkins", ".", "getInstance", "(", ").", "getPluginManager", "(", ").", "uberClassLoader", ")", ".", "parse", "(", "value", ")", ";", "new", "GroovyShell", "(", "Jenkins", ".", "getInstance", "(", ").", "getPluginManager", "(", ").", "uberClassLoader", ",", "GroovySandbox", ".", "createSecureCompilerConfiguration", "(", "))", ".", "parse", "(", "value", ")", ";", "}", "catch", "(", "CompilationFailedException", "x", ")", "{", "return", "FormValidation", ".", "error", "(", "x", ".", "getLocalizedMessage", "(", "))", ";", "}", "@", "@", "-", "57", ",", "6", "+", "57", ",", "8", "@", "@", "import", "org", ".", "apache", ".", "tools", ".", "ant", ".", "taskdefs", ".", "Expand", ";", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "scriptsecurity", ".", "scripts", ".", "ScriptApproval", ";", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "scriptsecurity", ".", "scripts", ".", "UnapprovedUsageException", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "containsString", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*;", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "scriptsecurity", ".", "scripts", ".", "languages", ".", "GroovyLanguage", ";", "@", "@", "-", "849", ",", "4", "+", "851", ",", "27", "@", "@", "public", "Void", "call", "(", ")", "throws", "Exception", "{", "}", ");", "}", "@", "Issue", "(", "\"", "SECURITY", "-", "1292", "\"", ")", "@", "Test", "public", "void", "blockASTTest", "(", ")", "throws", "Exception", "{", "SecureGroovyScript", ".", "DescriptorImpl", "d", "=", "r", ".", "jenkins", ".", "getDescriptorByType", "(", "SecureGroovyScript", ".", "DescriptorImpl", ".", "class", ")", ";", "assertThat", "(", "d", ".", "doCheckScript", "(", "\"", "import", "groovy", ".", "transform", ".", "*\\", "n", "\"", "\"", "import", "jenkins", ".", "model", ".", "Jenkins", "\\", "n", "\"", "\"", "import", "hudson", ".", "model", ".", "FreeStyleProject", "\\", "n", "\"", "\"", "@", "ASTTest", "(", "value", "=", "{", "assert", "Jenkins", ".", "getInstance", "(", ").", "createProject", "(", "FreeStyleProject", ".", "class", ",", "\\", "\"", "should", "-", "not", "-", "exist", "\\", "\")", "}", ")\\", "n", "\"", "\"", "@", "Field", "int", "x", "\\", "n", "\"", "\"", "echo", "'", "hello", "'", "\\", "n", "\"", ",", "false", ")", ".", "toString", "(", "),", "containsString", "(", "\"", "Annotation", "ASTTest", "cannot", "be", "used", "in", "the", "sandbox", "\"", "))", ";", "assertNull", "(", "r", ".", "jenkins", ".", "getItem", "(", "\"", "should", "-", "not", "-", "exist", "\"", "))", ";", "}", "@", "Issue", "(", "\"", "SECURITY", "-", "1292", "\"", ")", "@", "Test", "public", "void", "blockGrab", "(", ")", "throws", "Exception", "{", "SecureGroovyScript", ".", "DescriptorImpl", "d", "=", "r", ".", "jenkins", ".", "getDescriptorByType", "(", "SecureGroovyScript", ".", "DescriptorImpl", ".", "class", ")", ";", "assertThat", "(", "d", ".", "doCheckScript", "(", "\"@", "Grab", "(", "group", "=", "'", "foo", "'", ",", "module", "=", "'", "bar", "'", ",", "version", "=", "'", "1", ".", "0", "'", ")\\", "ndef", "foo", "\\", "n", "\"", ",", "false", ")", ".", "toString", "(", "),", "containsString", "(", "\"", "Annotation", "Grab", "cannot", "be", "used", "in", "the", "sandbox", "\"", "))", ";", "}", "}"], "docstring_tokens": ["the", "circumvention", "of", "sandbox", "protection", "during", "the", "script", "compilation", "phase"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "71", ",", "6", "+", "71", ",", "8", "@", "@", "public", "void", "invalidate", "(", ")", "{", "}", "public", "static", "void", "beginRequest", "(", ")", "{", "/", "/", "if", "the", "previous", "request", "was", "not", "ended", "properly", "for", "some", "reason", ",", "make", "sure", "it", "is", "ended", "now", "endRequest", "(", ");", "CACHE", ".", "set", "(", "new", "LinkedList", "<", "RequestScopedItem", ">", "()", ");", "}", "@", "@", "-", "80", ",", "8", "+", "82", ",", "8", "@", "@", "public", "static", "void", "beginRequest", "(", ")", "{", "*", "/", "public", "static", "void", "endRequest", "(", ")", "{", "final", "List", "<", "RequestScopedItem", ">", "result", "=", "CACHE", ".", "get", "(", ");", "CACHE", ".", "remove", "(", ");", "if", "(", "result", "!", "=", "null", ")", "{", "CACHE", ".", "remove", "(", ");", "for", "(", "final", "RequestScopedItem", "item", ":", "result", ")", "{", "item", ".", "invalidate", "(", ");", "}"], "docstring_tokens": ["the", "improper", "handling", "of", "the", "conversation", "state", "information"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "210", ",", "9", "+", "210", ",", "8", "@", "@", "int", "asn1_ber_decoder", "(", "const", "struct", "asn1_decoder", "*", "decoder", ",", "unsigned", "char", "tmp", ";", "/", "*", "Skip", "conditional", "matches", "if", "possible", "*", "/", "if", "(", "(", "op", "&", "ASN1_OP_MATCH__COND", "&", "&", "flags", "&", "FLAG_MATCHED", ")", "|", "|", "dp", "=", "=", "datalen", ")", "{", "if", "(", "(", "op", "&", "ASN1_OP_MATCH__COND", "&", "&", "flags", "&", "FLAG_MATCHED", ")", "|", "|", "(", "op", "&", "ASN1_OP_MATCH__SKIP", "&", "&", "dp", "=", "=", "datalen", ")", ")", "{", "flags", "&", "=", "~", "FLAG_LAST_MATCHED", ";", "pc", "+", "=", "asn1_op_lengths", "[", "op", "]", ";", "goto", "next_op", ";"], "docstring_tokens": ["craft", "a", "BER", "file", "without", "a", "public", "key"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "130", ",", "8", "+", "130", ",", "8", "@", "@", "function", "extractGz", "(", "archive", ",", "dst", ")", "{", "return", "deferred", ".", "promise", ";", "}", "function", "isSymlink", "(", "entry", ")", "{", "return", "entry", ".", "type", "=", "==", "'", "SymbolicLink", "'", ";", "function", "isSymlink", "(", "_", ",", "entry", ")", "{", "return", "entry", ".", "type", "=", "==", "'", "symlink", "'", ";", "}", "function", "filterSymlinks", "(", "entry", ")", "{", "@", "@", "-", "94", ",", "7", "+", "94", ",", "7", "@", "@", "\"", "test", "\"", ":", "\"", "grunt", "test", "\"", ",", "\"", "ci", "\"", ":", "\"", "grunt", "travis", "\"", ",", "\"", "coveralls", "\"", ":", "\"", "coveralls", "\"", ",", "\"", "prepublish", "\"", ":", "\"", "in", "-", "publish", "&", "&", "echo", "'", "You", "need", "to", "use", "\\", "\"", "grunt", "publish", "\\", "\"", "to", "publish", "bower", "'", "&", "&", "false", "|", "|", "not", "-", "in", "-", "publish", "\"", ",", "\"", "prepublishOnly", "\"", ":", "\"", "in", "-", "publish", "&", "&", "echo", "'", "You", "need", "to", "use", "\\", "\"", "grunt", "publish", "\\", "\"", "to", "publish", "bower", "'", "&", "&", "false", "|", "|", "not", "-", "in", "-", "publish", "\"", ",", "\"", "format", "\"", ":", "\"", "prettier", "-", "-", "write", "-", "-", "single", "-", "quote", "-", "-", "tab", "-", "width", "4", "'", "**", "/*", ".", "js", "'", "\",", "\"", "precommit", "\"", ":", "\"", "lint", "-", "staged", "\"", "}", ","], "docstring_tokens": ["has", "a", "path", "traversal", "vulnerability", "permitting", "file", "write", "in", "arbitrary", "locations", "via", "install", "command"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2", ",", "7", "+", "2", ",", "16", "@", "@", "OpenSSL", "CHANGES", "_______________", "Changes", "between", "0", ".", "9", ".", "8m", "and", "0", ".", "9", ".", "8n", "[", "xx", "XXX", "xxxx", "]", "Changes", "between", "0", ".", "9", ".", "8m", "and", "0", ".", "9", ".", "8n", "[", "24", "Mar", "2010", "]", "*", ")", "When", "rejecting", "SSL", "/", "TLS", "records", "due", "to", "an", "incorrect", "version", "number", ",", "never", "update", "s", "-", ">", "server", "with", "a", "new", "major", "version", "number", ".", "As", "of", "-", "OpenSSL", "0", ".", "9", ".", "8m", "if", "'", "short", "'", "is", "a", "16", "-", "bit", "type", ",", "-", "OpenSSL", "0", ".", "9", ".", "8f", "if", "'", "short", "'", "is", "longer", "than", "16", "bits", ",", "the", "previous", "behavior", "could", "result", "in", "a", "read", "attempt", "at", "NULL", "when", "receiving", "specific", "incorrect", "SSL", "/", "TLS", "records", "once", "record", "payload", "protection", "is", "active", ".", "(", "CVE", "-", "2010", "-", "0740", ")", "[", "Bodo", "Moeller", ",", "Adam", "Langley", "<", "agl", "@", "chromium", ".", "org", ">", "]", "*", ")", "Fix", "for", "CVE", "-", "2010", "-", "0433", "where", "some", "kerberos", "enabled", "versions", "of", "OpenSSL", "could", "be", "crashed", "if", "the", "relevant", "tables", "were", "not", "present", "(", "e", ".", "g", ".", "chrooted", ")", ".", "@", "@", "-", "291", ",", "9", "+", "291", ",", "9", "@", "@", "static", "int", "ssl3_get_record", "(", "SSL", "*", "s", ")", "if", "(", "version", "!", "=", "s", "-", ">", "version", ")", "{", "SSLerr", "(", "SSL_F_SSL3_GET_RECORD", ",", "SSL_R_WRONG_VERSION_NUMBER", ")", ";", "/", "*", "Send", "back", "error", "using", "their", "*", "version", "number", ":", "-)", "*", "/", "s", "-", ">", "version", "=", "version", ";", "if", "(", "(", "s", "-", ">", "version", "&", "0xFF00", ")", "=", "=", "(", "version", "&", "0xFF00", ")", ")", "/", "*", "Send", "back", "error", "using", "their", "minor", "version", "number", ":", "-)", "*", "/", "s", "-", ">", "version", "=", "(", "unsigned", "short", ")", "version", ";", "al", "=", "SSL_AD_PROTOCOL_VERSION", ";", "goto", "f_err", ";", "}"], "docstring_tokens": ["0x100", "is", "not", "a", "problem", "with", "signed/unsigned"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "99", ",", "6", "+", "99", ",", "10", "@", "@", "function", "undefsafe", "(", "obj", ",", "path", ",", "value", ",", "__res", ")", "{", "return", "res", ";", "}", "if", "(", "Object", ".", "getOwnPropertyNames", "(", "obj", ")", ".", "indexOf", "(", "key", ")", "=", "=", "-", "1", ")", "{", "return", "undefined", ";", "}", "obj", "=", "obj", "[", "key", "]", ";", "if", "(", "obj", "=", "==", "undefined", "|", "|", "obj", "=", "==", "null", ")", "{", "break", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "11", "@", "@", "var", "test", "=", "require", "(", "'", "tap", "'", ").", "test", ";", "var", "undefsafe", "=", "require", "(", "'.", "./", "lib", "/", "undefsafe", "'", ");", "test", "(", "'", "cannot", "modify", "prototype", "chain", "'", ",", "function", "(", "t", ")", "{", "const", "pre", "=", "{", "}.", "__proto__", ".", "toString", ";", "var", "payload", "=", "'", "__proto__", ".", "toString", "'", ";", "undefsafe", "(", "{", "a", ":", "'", "b", "'", "}", ",", "payload", ",", "'", "JHU", "'", ");", "t", ".", "notEqual", "(", "{}", ".", "toString", ",", "'", "JHU", "'", ");", "(", "{}", ".", "__proto__", ".", "toString", "=", "pre", ")", ";", "/", "/", "restore", "t", ".", "end", "(", ");", "}", ");"], "docstring_tokens": ["a", "prototype", "pollution", "flaw"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "62", ",", "14", "+", "62", ",", "19", "@", "@", "}", "}", ",", "\"", "@", "handsontable", "/", "formulajs", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "@", "handsontable", "/", "formulajs", "/", "-/", "formulajs", "-", "2", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "PkH", "+", "27UaGV3VuMJpSv4XHsCPOgI", "=", "\",", "\"", "version", "\"", ":", "\"", "2", ".", "0", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "@", "handsontable", "/", "formulajs", "/", "-/", "formulajs", "-", "2", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "jTdJO", "/", "6ZmuaHoiTdnraGbPkdnA7m0VMrZ54vWXi22WpwnsIKAWbqjWTwvDoSuEpcc7", "/", "YHVIVlSDtfXHKmaYhdQ", "=", "=\"", ",", "\"", "requires", "\"", ":", "{", "\"", "bessel", "\"", ":", "\"", "^", "0", ".", "2", ".", "0", "\"", ",", "\"", "jStat", "\"", ":", "\"", "^", "1", ".", "7", ".", "0", "\"", "\"", "@", "handsontable", "/", "jstat", "\"", ":", "\"", "^", "1", ".", "0", ".", "0", "\"", ",", "\"", "bessel", "\"", ":", "\"", "^", "0", ".", "2", ".", "0", "\"", "}", "}", ",", "\"", "@", "handsontable", "/", "jstat", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "@", "handsontable", "/", "jstat", "/", "-/", "jstat", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "5XxZ9xIk6iSjrc1p5N", "/", "yI2dofBXp0IzZVgrkETDC196SxoJCRNOeKgM9fTHMhoxa02wuaZPLp6stojlppNxP", "/", "A", "=", "=\"", "}", ",", "\"", "JSONSelect", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "4", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "JSONSelect", "/", "-/", "JSONSelect", "-", "0", ".", "4", ".", "0", ".", "tgz", "\"", ",", "@", "@", "-", "131", ",", "7", "+", "136", ",", "7", "@", "@", "}", ",", "\"", "acorn", "-", "jsx", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "0", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "acorn", "-", "jsx", "/", "-/", "acorn", "-", "jsx", "-", "3", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "acorn", "-", "jsx", "/", "-/", "acorn", "-", "jsx", "-", "3", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "r9", "+", "UiPsezvyDSPb7IvRk4ypYs2s", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "140", ",", "7", "+", "145", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "acorn", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "3", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "acorn", "/", "-/", "acorn", "-", "3", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "acorn", "/", "-/", "acorn", "-", "3", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "ReN", "/", "s56No", "/", "JbruP", "/", "U2niu18iAXo", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "189", ",", "7", "+", "194", ",", "7", "@", "@", "}", ",", "\"", "ansi", "-", "escapes", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "1", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "3", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "3", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "UgAb8H9D41AQnu", "/", "PbWlCofQVcnV4Gs2bBJi9eZPxfU", "/", "hgglFh3SMDMENRIqdr7H6XFnXdoknctFByVsCOotTVw", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "325", ",", "7", "+", "330", ",", "7", "@", "@", "}", ",", "\"", "util", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "10", ".", "3", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "util", "/", "-/", "util", "-", "0", ".", "10", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "util", "/", "-/", "util", "-", "0", ".", "10", ".", "3", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "evsa", "/", "lCAUkZInj23", "/", "g7TeTNqwPk", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "635", ",", "7", "+", "640", ",", "7", "@", "@", "}", ",", "\"", "babel", "-", "plugin", "-", "istanbul", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "4", ".", "1", ".", "6", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "babel", "-", "plugin", "-", "istanbul", "/", "-/", "babel", "-", "plugin", "-", "istanbul", "-", "4", ".", "1", ".", "6", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "babel", "-", "plugin", "-", "istanbul", "/", "-/", "babel", "-", "plugin", "-", "istanbul", "-", "4", ".", "1", ".", "6", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "PWP9FQ1AhZhS01T", "/", "4qLSKoHGY", "/", "xvkZdVBGlKM", "/", "HuxxS3", "+", "sC66HhTNR7", "+", "MpbO", "/", "so", "/", "cz", "/", "wY94MeSWJuP1hXIPfwQ", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "653", ",", "7", "+", "658", ",", "7", "@", "@", "}", ",", "\"", "babel", "-", "plugin", "-", "syntax", "-", "object", "-", "rest", "-", "spread", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "6", ".", "13", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "babel", "-", "plugin", "-", "syntax", "-", "object", "-", "rest", "-", "spread", "/", "-/", "babel", "-", "plugin", "-", "syntax", "-", "object", "-", "rest", "-", "spread", "-", "6", ".", "13", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "babel", "-", "plugin", "-", "syntax", "-", "object", "-", "rest", "-", "spread", "/", "-/", "babel", "-", "plugin", "-", "syntax", "-", "object", "-", "rest", "-", "spread", "-", "6", ".", "13", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "/", "WU28rzhODb", "/", "o6VFjEkDpZe7O", "/", "U", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "1157", ",", "7", "+", "1162", ",", "7", "@", "@", "}", ",", "\"", "browserify", "-", "aes", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "2", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "browserify", "-", "aes", "/", "-/", "browserify", "-", "aes", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "browserify", "-", "aes", "/", "-/", "browserify", "-", "aes", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "+", "7CHXqGuspUn", "/", "Sl5aO7Ea0xWGAtETPXNSAjHo48JfLdPWcMng33Xe4znFvQweqc", "/", "uzk5zSOI3H52CYnjCfb5hA", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "1194", ",", "7", "+", "1199", ",", "7", "@", "@", "}", ",", "\"", "browserify", "-", "rsa", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "4", ".", "0", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "browserify", "-", "rsa", "/", "-/", "browserify", "-", "rsa", "-", "4", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "browserify", "-", "rsa", "/", "-/", "browserify", "-", "rsa", "-", "4", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "IeCr", "+", "vbyApzy", "+", "vsTNWenAdQTVSQ", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "1237", ",", "7", "+", "1242", ",", "7", "@", "@", "}", ",", "\"", "buffer", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "4", ".", "9", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "buffer", "/", "-/", "buffer", "-", "4", ".", "9", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "buffer", "/", "-/", "buffer", "-", "4", ".", "9", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "bRu2AbB6TvztlwlBMgkwJ8lbwpg", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "1343", ",", "7", "+", "1348", ",", "7", "@", "@", "}", ",", "\"", "chalk", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "3", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "chalk", "/", "-/", "chalk", "-", "1", ".", "1", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "chalk", "/", "-/", "chalk", "-", "1", ".", "1", ".", "3", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "qBFcVeSnAv5NFQq9OHKCKn4J", "/", "Jg", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "1738", ",", "7", "+", "1743", ",", "7", "@", "@", "}", ",", "\"", "create", "-", "hash", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "2", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "create", "-", "hash", "/", "-/", "create", "-", "hash", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "create", "-", "hash", "/", "-/", "create", "-", "hash", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "z00bCGNHDG8mHAkP7CtT1qVu", "+", "bFQUPjYq", "/", "4Iv3C3kWjTFV10zIjfSoeqXo9Asws8gwSHDGj", "/", "hl2u4OGIjapeCg", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "1751", ",", "7", "+", "1756", ",", "7", "@", "@", "}", ",", "\"", "create", "-", "hmac", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "7", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "create", "-", "hmac", "/", "-/", "create", "-", "hmac", "-", "1", ".", "1", ".", "7", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "create", "-", "hmac", "/", "-/", "create", "-", "hmac", "-", "1", ".", "1", ".", "7", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "MJG9liiZ", "+", "ogc4TzUwuvbER1JRdgvUFSB5", "+", "VR", "/", "g5h82fGaIRWMWddtKBHi7", "/", "sVhfjQZ6SehlyhvQYrcYkaUIpLg", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "1852", ",", "7", "+", "1857", ",", "7", "@", "@", "}", ",", "\"", "d", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "d", "/", "-/", "d", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "d", "/", "-/", "d", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "dUu1v", "+", "VUUdpppYuU1F9MWwRi1Y8", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "2044", ",", "7", "+", "2049", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "pify", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "3", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "7RQaasBDqEnqWISY59yosVMw6Qw", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "2099", ",", "7", "+", "2104", ",", "7", "@", "@", "}", ",", "\"", "diffie", "-", "hellman", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "5", ".", "0", ".", "3", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "diffie", "-", "hellman", "/", "-/", "diffie", "-", "hellman", "-", "5", ".", "0", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "diffie", "-", "hellman", "/", "-/", "diffie", "-", "hellman", "-", "5", ".", "0", ".", "3", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "kqag", "/", "Nl", "+", "f3GwyK25fhUMYj81BUOrZ9IuJsjIcDE5icNM9FJHAVm3VcUDxdLPoQtTuUylWm6ZIknYJwwaPxsUzg", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "2129", ",", "7", "+", "2134", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "domelementtype", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "3", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "domelementtype", "/", "-/", "domelementtype", "-", "1", ".", "1", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "domelementtype", "/", "-/", "domelementtype", "-", "1", ".", "1", ".", "3", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "vSh3PiZCiBrsUVRJJCmcXNgiGFs", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "2232", ",", "7", "+", "2237", ",", "7", "@", "@", "}", ",", "\"", "entities", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "entities", "/", "-/", "entities", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "entities", "/", "-/", "entities", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "sph6o4ITR", "/", "zeZCsk", "/", "fyeT7cSvyY", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "2408", ",", "7", "+", "2413", ",", "7", "@", "@", "}", ",", "\"", "eslint", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "4", ".", "19", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "eslint", "/", "-/", "eslint", "-", "4", ".", "19", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "eslint", "/", "-/", "eslint", "-", "4", ".", "19", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "bT3", "/", "1x1EbZB7phzYu7vCr1v3ONuzDtX8WjuM9c0iYxe", "+", "cq", "+", "pwcKEoQjl7zd3RpC6YOLgnSy3cTN58M2jcoPDIQ", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "2632", ",", "7", "+", "2637", ",", "7", "@", "@", "}", ",", "\"", "espree", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "5", ".", "4", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "espree", "/", "-/", "espree", "-", "3", ".", "5", ".", "4", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "espree", "/", "-/", "espree", "-", "3", ".", "5", ".", "4", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "yAcIQxtmMiB", "/", "jL32dzEp2enBeidsB7xWPLNiw3IIkpVds1P", "+", "h7qF9YwJq1yUNzp2OKXgAprs4F61ih66UsoD1A", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "2688", ",", "7", "+", "2693", ",", "7", "@", "@", "}", ",", "\"", "events", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "events", "/", "-/", "events", "-", "1", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "events", "/", "-/", "events", "-", "1", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "nr23Y1rQmccNzEwqH1AEKI6L2SQ", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "2816", ",", "7", "+", "2821", ",", "7", "@", "@", "}", ",", "\"", "external", "-", "editor", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "2", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "external", "-", "editor", "/", "-/", "external", "-", "editor", "-", "2", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "external", "-", "editor", "/", "-/", "external", "-", "editor", "-", "2", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "bSn6gvGxKt", "+", "b7", "+", "6TKEv1ZycHleA7aHhRHyAqJyp5pbUFuYYNIzpZnQDk7AsYckyWdEnTeAnay0aCy2aV6iTk9A", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "2848", ",", "7", "+", "2853", ",", "7", "@", "@", "}", ",", "\"", "fast", "-", "deep", "-", "equal", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "fast", "-", "deep", "-", "equal", "/", "-/", "fast", "-", "deep", "-", "equal", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "fast", "-", "deep", "-", "equal", "/", "-/", "fast", "-", "deep", "-", "equal", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "wFNHeBfIa1HaqFPIHgWbcz0CNhQ", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "3026", ",", "7", "+", "3031", ",", "8", "@", "@", "\"", "ansi", "-", "regex", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "1", ".", "1", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "aproba", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "2", ".", "0", "\"", ",", "@", "@", "-", "3047", ",", "12", "+", "3053", ",", "14", "@", "@", "\"", "balanced", "-", "match", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "0", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "brace", "-", "expansion", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "11", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "\"", "balanced", "-", "match", "\"", ":", "\"", "^", "1", ".", "0", ".", "0", "\"", ",", "\"", "concat", "-", "map", "\"", ":", "\"", "0", ".", "0", ".", "1", "\"", "@", "@", "-", "3067", ",", "17", "+", "3075", ",", "20", "@", "@", "\"", "code", "-", "point", "-", "at", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "0", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "concat", "-", "map", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "0", ".", "1", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "console", "-", "control", "-", "strings", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "0", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "core", "-", "util", "-", "is", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "2", "\"", ",", "@", "@", "-", "3194", ",", "7", "+", "3205", ",", "8", "@", "@", "\"", "inherits", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "0", ".", "3", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "ini", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "3", ".", "5", "\"", ",", "@", "@", "-", "3206", ",", "6", "+", "3218", ",", "7", "@", "@", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "0", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "\"", "number", "-", "is", "-", "nan", "\"", ":", "\"", "^", "1", ".", "0", ".", "0", "\"", "}", "@", "@", "-", "3220", ",", "19", "+", "3233", ",", "22", "@", "@", "\"", "version", "\"", ":", "\"", "3", ".", "0", ".", "4", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "\"", "brace", "-", "expansion", "\"", ":", "\"", "^", "1", ".", "1", ".", "7", "\"", "}", "}", ",", "\"", "minimist", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "0", ".", "8", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "minipass", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "2", ".", "4", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "\"", "safe", "-", "buffer", "\"", ":", "\"", "^", "5", ".", "1", ".", "1", "\"", ",", "\"", "yallist", "\"", ":", "\"", "^", "3", ".", "0", ".", "0", "\"", "@", "@", "-", "3251", ",", "6", "+", "3267", ",", "7", "@", "@", "\"", "version", "\"", ":", "\"", "0", ".", "5", ".", "1", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "\"", "minimist", "\"", ":", "\"", "0", ".", "0", ".", "8", "\"", "}", "@", "@", "-", "3331", ",", "7", "+", "3348", ",", "8", "@", "@", "\"", "number", "-", "is", "-", "nan", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "1", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "object", "-", "assign", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "4", ".", "1", ".", "1", "\"", ",", "@", "@", "-", "3343", ",", "6", "+", "3361", ",", "7", "@", "@", "\"", "version", "\"", ":", "\"", "1", ".", "4", ".", "0", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "\"", "wrappy", "\"", ":", "\"", "1", "\"", "}", "@", "@", "-", "3428", ",", "7", "+", "3447", ",", "8", "@", "@", "\"", "safe", "-", "buffer", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "5", ".", "1", ".", "1", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "safer", "-", "buffer", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "1", ".", "2", "\"", ",", "@", "@", "-", "3464", ",", "6", "+", "3484", ",", "7", "@", "@", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "2", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "\"", "code", "-", "point", "-", "at", "\"", ":", "\"", "^", "1", ".", "0", ".", "0", "\"", ",", "\"", "is", "-", "fullwidth", "-", "code", "-", "point", "\"", ":", "\"", "^", "1", ".", "0", ".", "0", "\"", ",", "@", "@", "-", "3483", ",", "6", "+", "3504", ",", "7", "@", "@", "\"", "version", "\"", ":", "\"", "3", ".", "0", ".", "1", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "\"", "ansi", "-", "regex", "\"", ":", "\"", "^", "2", ".", "0", ".", "0", "\"", "}", "@", "@", "-", "3526", ",", "12", "+", "3548", ",", "14", "@", "@", "\"", "wrappy", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "2", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", ",", "\"", "yallist", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "0", ".", "2", "\"", ",", "\"", "bundled", "\"", ":", "true", ",", "\"", "dev", "\"", ":", "true", "\"", "dev", "\"", ":", "true", ",", "\"", "optional", "\"", ":", "true", "}", "}", "}", ",", "@", "@", "-", "3567", ",", "7", "+", "3591", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "ansi", "-", "escapes", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "4", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "1", ".", "4", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "1", ".", "4", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "06ioOzGapneTZisT52HHkRQiMG4", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "3582", ",", "7", "+", "3606", ",", "7", "@", "@", "}", ",", "\"", "external", "-", "editor", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "external", "-", "editor", "/", "-/", "external", "-", "editor", "-", "1", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "external", "-", "editor", "/", "-/", "external", "-", "editor", "-", "1", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "Etew24UPf", "/", "fnCBuvQAVwAGDEYAs", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "3603", ",", "7", "+", "3627", ",", "7", "@", "@", "}", ",", "\"", "inquirer", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "2", ".", "3", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "inquirer", "/", "-/", "inquirer", "-", "1", ".", "2", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "inquirer", "/", "-/", "inquirer", "-", "1", ".", "2", ".", "3", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "TexvMvN", "+", "97sLLtPx0aXD9UUHSRg", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "3625", ",", "7", "+", "3649", ",", "7", "@", "@", "}", ",", "\"", "minimist", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "2", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "minimist", "/", "-/", "minimist", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "minimist", "/", "-/", "minimist", "-", "1", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "o1AIsg9BOD7sH7kU9M1d95omQoQ", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "3681", ",", "7", "+", "3705", ",", "7", "@", "@", "}", ",", "\"", "get", "-", "stream", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "get", "-", "stream", "/", "-/", "get", "-", "stream", "-", "3", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "get", "-", "stream", "/", "-/", "get", "-", "stream", "-", "3", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "jpQ9E1jcN1VQVOy", "+", "LtsFqhdO3hQ", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "3755", ",", "7", "+", "3779", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "pify", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "3", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "7RQaasBDqEnqWISY59yosVMw6Qw", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "3963", ",", "7", "+", "3987", ",", "7", "@", "@", "}", ",", "\"", "htmlparser2", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "8", ".", "3", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "htmlparser2", "/", "-/", "htmlparser2", "-", "3", ".", "8", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "htmlparser2", "/", "-/", "htmlparser2", "-", "3", ".", "8", ".", "3", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "mWwosZFRaovoZQGn15dX5ccMEGg", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "3982", ",", "7", "+", "4006", ",", "7", "@", "@", "}", ",", "\"", "readable", "-", "stream", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "14", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "readable", "-", "stream", "/", "-/", "readable", "-", "stream", "-", "1", ".", "1", ".", "14", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "readable", "-", "stream", "/", "-/", "readable", "-", "stream", "-", "1", ".", "1", ".", "14", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "fPTFTvZI44EwhMY23SB54WbAgdk", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "4185", ",", "7", "+", "4209", ",", "7", "@", "@", "}", ",", "\"", "is", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "2", ".", "7", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "is", "/", "-/", "is", "-", "0", ".", "2", ".", "7", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "is", "/", "-/", "is", "-", "0", ".", "2", ".", "7", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "OzSixI81mXLzUEKEkZOucmS2NWI", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "4221", ",", "7", "+", "4245", ",", "7", "@", "@", "}", ",", "\"", "is", "-", "builtin", "-", "module", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "is", "-", "builtin", "-", "module", "/", "-/", "is", "-", "builtin", "-", "module", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "is", "-", "builtin", "-", "module", "/", "-/", "is", "-", "builtin", "-", "module", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "VAVy0096wxGfj3bDDLwbHgN6", "/", "74", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "4597", ",", "11", "+", "4621", ",", "6", "@", "@", "\"", "handlebars", "\"", ":", "\"", "^", "4", ".", "0", ".", "3", "\"", "}", "}", ",", "\"", "jStat", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "7", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "jStat", "/", "-/", "jStat", "-", "1", ".", "7", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "toueem", "/", "U5hyHM6pqe6OZOL", "/", "5P8MrY7Ss1K8Brg", "+", "TcfX", "+", "RAjDU", "/", "sbwy72fwzmLPQ5ykdBe1UEoWQHc7OSNWMUDQ", "=", "=\"", "}", ",", "\"", "jest", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "23", ".", "6", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "jest", "/", "-/", "jest", "-", "23", ".", "6", ".", "0", ".", "tgz", "\"", ",", "@", "@", "-", "5646", ",", "7", "+", "5665", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "commander", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "9", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "commander", "/", "-/", "commander", "-", "2", ".", "9", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "commander", "/", "-/", "commander", "-", "2", ".", "9", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "nJkJQXbhIkDLItbFFGCYQA", "/", "g99Q", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "5689", ",", "7", "+", "5708", ",", "7", "@", "@", "}", ",", "\"", "lodash", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "10", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "W", "/", "Rejkm6QYnhfUgnid", "/", "RW9FAt7Y", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "5743", ",", "7", "+", "5762", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "lodash", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "10", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "W", "/", "Rejkm6QYnhfUgnid", "/", "RW9FAt7Y", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "5821", ",", "7", "+", "5840", ",", "7", "@", "@", "}", ",", "\"", "json5", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "5", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "json5", "/", "-/", "json5", "-", "0", ".", "5", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "json5", "/", "-/", "json5", "-", "0", ".", "5", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "Hq3nrMASA0rYTiOWdn6tn6VJWCE", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "5943", ",", "7", "+", "5962", ",", "7", "@", "@", "}", ",", "\"", "load", "-", "json", "-", "file", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "load", "-", "json", "-", "file", "/", "-/", "load", "-", "json", "-", "file", "-", "2", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "load", "-", "json", "-", "file", "/", "-/", "load", "-", "json", "-", "file", "-", "2", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "eUfkIUmvgNaWy", "/", "eXvKq8", "/", "h", "/", "inKg", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "5955", ",", "7", "+", "5974", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "pify", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "3", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "7RQaasBDqEnqWISY59yosVMw6Qw", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "6196", ",", "7", "+", "6215", ",", "7", "@", "@", "}", ",", "\"", "minimist", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "0", ".", "8", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "minimist", "/", "-/", "minimist", "-", "0", ".", "0", ".", "8", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "minimist", "/", "-/", "minimist", "-", "0", ".", "0", ".", "8", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "hX", "/", "Kv8M5fSYluCKCYuhqp6ARsF0", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "6223", ",", "7", "+", "6242", ",", "7", "@", "@", "}", ",", "\"", "mkdirp", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "5", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "mkdirp", "/", "-/", "mkdirp", "-", "0", ".", "5", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "mkdirp", "/", "-/", "mkdirp", "-", "0", ".", "5", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "MAV0OOrGz3", "+", "MR2fzhkjWaX11yQM", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "6296", ",", "7", "+", "6315", ",", "7", "@", "@", "}", ",", "\"", "ncp", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "4", ".", "2", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ncp", "/", "-/", "ncp", "-", "0", ".", "4", ".", "2", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ncp", "/", "-/", "ncp", "-", "0", ".", "4", ".", "2", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "q8xsvT7C7Spyn", "/", "bnwfqPAXhKhXQ", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "6308", ",", "7", "+", "6327", ",", "7", "@", "@", "}", ",", "\"", "next", "-", "tick", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "next", "-", "tick", "/", "-/", "next", "-", "tick", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "next", "-", "tick", "/", "-/", "next", "-", "tick", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "yobR", "/", "ogoFpsBICCOPchCS524NCw", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "6377", ",", "7", "+", "6396", ",", "7", "@", "@", "}", ",", "\"", "node", ".", "extend", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "8", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "node", ".", "extend", "/", "-/", "node", ".", "extend", "-", "1", ".", "0", ".", "8", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "node", ".", "extend", "/", "-/", "node", ".", "extend", "-", "1", ".", "0", ".", "8", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "urBDefc4P0WHmQyd8Htqf2Xbdys", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "6559", ",", "13", "+", "6578", ",", "13", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "ansi", "-", "escapes", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "4", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "1", ".", "4", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "ansi", "-", "escapes", "/", "-/", "ansi", "-", "escapes", "-", "1", ".", "4", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "06ioOzGapneTZisT52HHkRQiMG4", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "\"", "lodash", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "10", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "W", "/", "Rejkm6QYnhfUgnid", "/", "RW9FAt7Y", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "6705", ",", "7", "+", "6724", ",", "7", "@", "@", "}", ",", "\"", "parse", "-", "asn1", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "5", ".", "1", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "parse", "-", "asn1", "/", "-/", "parse", "-", "asn1", "-", "5", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "parse", "-", "asn1", "/", "-/", "parse", "-", "asn1", "-", "5", ".", "1", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "KPx7flKXg775zZpnp9SxJlz00gTd4BmJ2yJufSc44gMCRrRQ7NSzAcSJQfifuOLgW6bEi", "+", "ftrALtsgALeB2Adw", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "6802", ",", "7", "+", "6821", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "pify", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "3", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "pify", "/", "-/", "pify", "-", "2", ".", "3", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "7RQaasBDqEnqWISY59yosVMw6Qw", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "7111", ",", "7", "+", "7130", ",", "7", "@", "@", "}", ",", "\"", "readable", "-", "stream", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "3", ".", "6", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "readable", "-", "stream", "/", "-/", "readable", "-", "stream", "-", "2", ".", "3", ".", "6", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "readable", "-", "stream", "/", "-/", "readable", "-", "stream", "-", "2", ".", "3", ".", "6", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "tQtKA9WIAhBF3", "+", "VLAseyMqZeBjW0AHJoxOtYqSUZNJxauErmLbVm2FW1y", "+", "J", "/", "YA9dUrAC39ITejlZWhVIwawkKw", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "7473", ",", "7", "+", "7492", ",", "7", "@", "@", "}", ",", "\"", "regexpp", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "regexpp", "/", "-/", "regexpp", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "regexpp", "/", "-/", "regexpp", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "LOPw8FpgdQF9etWMaAfG", "/", "WRthIdXJGYp4mJ2Jgn", "/", "2lpkbod9jPn0t9UqN7AxBOKNfzRbYyVfgc7Vk4t", "/", "MpnXgw", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "7490", ",", "7", "+", "7509", ",", "7", "@", "@", "}", ",", "\"", "regjsgen", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "2", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "regjsgen", "/", "-/", "regjsgen", "-", "0", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "regjsgen", "/", "-/", "regjsgen", "-", "0", ".", "2", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "bAFq3qxVT3WCP", "+", "N6wFuS1aTtsfc", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "7755", ",", "7", "+", "7774", ",", "7", "@", "@", "}", ",", "\"", "safe", "-", "regex", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "1", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "safe", "-", "regex", "/", "-/", "safe", "-", "regex", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "safe", "-", "regex", "/", "-/", "safe", "-", "regex", "-", "1", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "QKNmnzsHfR6UPURinhV91IAjvy4", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "8126", ",", "7", "+", "8145", ",", "7", "@", "@", "}", ",", "\"", "sha", ".", "js", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "4", ".", "11", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "sha", ".", "js", "/", "-/", "sha", ".", "js", "-", "2", ".", "4", ".", "11", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "sha", ".", "js", "/", "-/", "sha", ".", "js", "-", "2", ".", "4", ".", "11", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha512", "-", "QMEp5B7cftE7APOjk5Y6xgrbWu", "+", "WkLVQwk8JNjZ8nKRciZaByEW6MubieAiToS7", "+", "dwvrjGhH8jRXz3MVd0AYqQ", "=", "=\"", ",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "8545", ",", "7", "+", "8564", ",", "7", "@", "@", "}", ",", "\"", "strip", "-", "ansi", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "0", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "strip", "-", "ansi", "/", "-/", "strip", "-", "ansi", "-", "3", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "strip", "-", "ansi", "/", "-/", "strip", "-", "ansi", "-", "3", ".", "0", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "ajhfuIU9lS1f8F0Oiq", "+", "UJ43GPc8", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "8560", ",", "7", "+", "8579", ",", "7", "@", "@", "}", ",", "\"", "strip", "-", "eof", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "1", ".", "0", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "strip", "-", "eof", "/", "-/", "strip", "-", "eof", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "strip", "-", "eof", "/", "-/", "strip", "-", "eof", "-", "1", ".", "0", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "u0P", "/", "VZim6wXYm1n80SnJgzE2Br8", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "8645", ",", "7", "+", "8664", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "rimraf", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "2", ".", "8", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "rimraf", "/", "-/", "rimraf", "-", "2", ".", "2", ".", "8", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "rimraf", "/", "-/", "rimraf", "-", "2", ".", "2", ".", "8", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "5Dm", "+", "Kq7jJzIZUnMPmaiSnk", "/", "FBYI", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "8759", ",", "7", "+", "8778", ",", "7", "@", "@", "}", ",", "\"", "through", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "3", ".", "8", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "through", "/", "-/", "through", "-", "2", ".", "3", ".", "8", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "through", "/", "-/", "through", "-", "2", ".", "3", ".", "8", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "DdTJ", "/", "6q8NXlgsbckEV1", "+", "Doai4fU", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "9199", ",", "7", "+", "9218", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "async", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "2", ".", "10", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "async", "/", "-/", "async", "-", "0", ".", "2", ".", "10", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "async", "/", "-/", "async", "-", "0", ".", "2", ".", "10", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "trvgsGdLnXGXCMo43owjfLUmw9E", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "9275", ",", "7", "+", "9294", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "uuid", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "0", ".", "3", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "uuid", "/", "-/", "uuid", "-", "2", ".", "0", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "uuid", "/", "-/", "uuid", "-", "2", ".", "0", ".", "3", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "Z", "+", "LoY3lyFVMN", "/", "zGOW", "/", "nc6", "/", "1Hsho", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "9851", ",", "7", "+", "9870", ",", "7", "@", "@", "}", ",", "\"", "winston", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "8", ".", "3", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "winston", "/", "-/", "winston", "-", "0", ".", "8", ".", "3", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "winston", "/", "-/", "winston", "-", "0", ".", "8", ".", "3", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "ZLar9M0Brcrv1QCTk7HY6L7BnbA", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "9866", ",", "7", "+", "9885", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "async", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "0", ".", "2", ".", "10", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "async", "/", "-/", "async", "-", "0", ".", "2", ".", "10", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "async", "/", "-/", "async", "-", "0", ".", "2", ".", "10", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "trvgsGdLnXGXCMo43owjfLUmw9E", "=", "\",", "\"", "dev", "\"", ":", "true", "}", ",", "@", "@", "-", "9892", ",", "7", "+", "9911", ",", "7", "@", "@", "}", ",", "\"", "wrap", "-", "ansi", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "2", ".", "1", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "wrap", "-", "ansi", "/", "-/", "wrap", "-", "ansi", "-", "2", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "wrap", "-", "ansi", "/", "-/", "wrap", "-", "ansi", "-", "2", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "2Pw9KE3QV5T", "+", "hJc8rs3Rz4JP3YU", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "9956", ",", "7", "+", "9975", ",", "7", "@", "@", "}", ",", "\"", "xmlbuilder", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "1", ".", "0", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "xmlbuilder", "/", "-/", "xmlbuilder", "-", "3", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "xmlbuilder", "/", "-/", "xmlbuilder", "-", "3", ".", "1", ".", "0", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "LIaIjy1OrehQ", "+", "jjKf3Ij9yCVFuE", "=", "\",", "\"", "dev", "\"", ":", "true", ",", "\"", "requires", "\"", ":", "{", "@", "@", "-", "9965", ",", "7", "+", "9984", ",", "7", "@", "@", "\"", "dependencies", "\"", ":", "{", "\"", "lodash", "\"", ":", "{", "\"", "version", "\"", ":", "\"", "3", ".", "10", ".", "1", "\"", ",", "\"", "resolved", "\"", ":", "\"", "http", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "resolved", "\"", ":", "\"", "https", ":", "//", "registry", ".", "npmjs", ".", "org", "/", "lodash", "/", "-/", "lodash", "-", "3", ".", "10", ".", "1", ".", "tgz", "\"", ",", "\"", "integrity", "\"", ":", "\"", "sha1", "-", "W", "/", "Rejkm6QYnhfUgnid", "/", "RW9FAt7Y", "=", "\",", "\"", "dev", "\"", ":", "true", "}", "@", "@", "-", "19", ",", "7", "+", "19", ",", "7", "@", "@", "\"", "build", ":", "umd", "\"", ":", "\"", "cross", "-", "env", "BABEL_ENV", "=", "commonjs", "NODE_ENV", "=", "development", "webpack", "src", "/", "index", ".", "js", "dist", "/", "formula", "-", "parser", ".", "js", "\"", ",", "\"", "generate", "-", "parser", "\"", ":", "\"", "cd", "src", "/", "grammar", "-", "parser", "&", "&", "jison", "grammar", "-", "parser", ".", "jison", "\"", ",", "\"", "release", "\"", ":", "\"", "generate", "-", "release", "\"", ",", "\"", "prepublish", "\"", ":", "\"", "npm", "run", "clean", "&", "&", "npm", "run", "check", "&", "&", "npm", "run", "build", "&", "&", "check", "-", "es3", "-", "syntax", "lib", "/", "dist", "/", "-", "-", "kill", "-", "-", "print", "\"", "\"", "prepublish", "\"", ":", "\"", "npm", "run", "clean", "&", "&", "npm", "run", "check", "&", "&", "npm", "run", "build", "\"", "}", ",", "\"", "repository", "\"", ":", "{", "\"", "type", "\"", ":", "\"", "git", "\"", ",", "@", "@", "-", "82", ",", "7", "+", "82", ",", "7", "@", "@", "\"", "webpack", "\"", ":", "\"", "^", "3", ".", "2", ".", "0", "\"", "}", ",", "\"", "dependencies", "\"", ":", "{", "\"", "@", "handsontable", "/", "formulajs", "\"", ":", "\"", "^", "2", ".", "0", ".", "0", "\"", ",", "\"", "@", "handsontable", "/", "formulajs", "\"", ":", "\"", "^", "2", ".", "0", ".", "1", "\"", ",", "\"", "tiny", "-", "emitter", "\"", ":", "\"", "^", "2", ".", "0", ".", "1", "\"", "}", ",", "\"", "jest", "\"", ":", "{", "@", "@", "-", "187", ",", "14", "+", "187", ",", "7", "@", "@", "expseq", "$", "$", "=", "[", "$", "1", "]", ";", "}", "|", "ARRAY", "{", "var", "result", "=", "[", "];", "var", "arr", "=", "eval", "(", "\"[", "\"", "+", "yytext", "+", "\"", "]\"", ");", "arr", ".", "forEach", "(", "function", "(", "item", ")", "{", "result", ".", "push", "(", "item", ")", ";", "}", ");", "$", "$", "=", "result", ";", "$", "$", "=", "yy", ".", "trimEdges", "(", "yytext", ")", ".", "split", "(", "',", "')", ";", "}", "|", "expseq", "'", ";'", "expression", "{", "$", "1", ".", "push", "(", "$", "3", ")", ";", "@", "@", "-", "1", ",", "4", "+", "1", ",", "4", "@", "@", "/", "*", "parser", "generated", "by", "jison", "0", ".", "4", ".", "17", "*", "/", "/", "*", "parser", "generated", "by", "jison", "0", ".", "4", ".", "18", "*", "/", "/", "*", "Returns", "a", "Parser", "object", "of", "the", "following", "structure", ":", "@", "@", "-", "73", ",", "7", "+", "73", ",", "7", "@", "@", "*", "/", "var", "grammarParser", "=", "(", "function", "(", "){", "var", "o", "=", "function", "(", "k", ",", "v", ",", "o", ",", "l", ")", "{", "for", "(", "o", "=", "o", "|", "|{", "},", "l", "=", "k", ".", "length", ";", "l", "-", "-;", "o", "[", "k", "[", "l", "]", "]=", "v", ")", ";", "return", "o", "}", ",$", "V0", "=", "[", "1", ",", "5", "]", ",$", "V1", "=", "[", "1", ",", "8", "]", ",$", "V2", "=", "[", "1", ",", "6", "]", ",$", "V3", "=", "[", "1", ",", "7", "]", ",$", "V4", "=", "[", "1", ",", "9", "]", ",$", "V5", "=", "[", "1", ",", "14", "]", ",$", "V6", "=", "[", "1", ",", "15", "]", ",$", "V7", "=", "[", "1", ",", "16", "]", ",$", "V8", "=", "[", "1", ",", "12", "]", ",$", "V9", "=", "[", "1", ",", "13", "]", ",$", "Va", "=", "[", "1", ",", "17", "]", ",$", "Vb", "=", "[", "1", ",", "19", "]", ",$", "Vc", "=", "[", "1", ",", "20", "]", ",$", "Vd", "=", "[", "1", ",", "21", "]", ",$", "Ve", "=", "[", "1", ",", "22", "]", ",$", "Vf", "=", "[", "1", ",", "23", "]", ",$", "Vg", "=", "[", "1", ",", "24", "]", ",$", "Vh", "=", "[", "1", ",", "25", "]", ",$", "Vi", "=", "[", "1", ",", "26", "]", ",$", "Vj", "=", "[", "1", ",", "27", "]", ",$", "Vk", "=", "[", "1", ",", "28", "]", ",$", "Vl", "=", "[", "5", ",", "9", ",", "10", ",", "11", ",", "13", ",", "14", ",", "15", ",", "16", ",", "17", ",", "18", ",", "19", ",", "20", ",", "29", ",", "30", "]", ",$", "Vm", "=", "[", "5", ",", "9", ",", "10", ",", "11", ",", "13", ",", "14", ",", "15", ",", "16", ",", "17", ",", "18", ",", "19", ",", "20", ",", "29", ",", "30", ",", "32", "]", ",$", "Vn", "=", "[", "5", ",", "9", ",", "10", ",", "11", ",", "13", ",", "14", ",", "15", ",", "16", ",", "17", ",", "18", ",", "19", ",", "20", ",", "29", ",", "30", ",", "34", "]", ",$", "Vo", "=", "[", "5", ",", "10", ",", "11", ",", "13", ",", "14", ",", "15", ",", "16", ",", "17", ",", "29", ",", "30", "]", ",$", "Vp", "=", "[", "5", ",", "10", ",", "13", ",", "14", ",", "15", ",", "16", ",", "29", ",", "30", "]", ",$", "Vq", "=", "[", "5", ",", "10", ",", "11", ",", "13", ",", "14", ",", "15", ",", "16", ",", "17", ",", "18", ",", "19", ",", "29", ",", "30", "]", ",$", "Vr", "=", "[", "13", ",", "29", ",", "30", "]", ";", "var", "parser", "=", "{", "trace", ":", "function", "trace", "(", ")", "{", "}", ",", "var", "parser", "=", "{", "trace", ":", "function", "trace", "(", ")", "{", "}", ",", "yy", ":", "{", "},", "symbols_", ":", "{", "\"", "error", "\"", ":", "2", ",", "\"", "expressions", "\"", ":", "3", ",", "\"", "expression", "\"", ":", "4", ",", "\"", "EOF", "\"", ":", "5", ",", "\"", "variableSequence", "\"", ":", "6", ",", "\"", "number", "\"", ":", "7", ",", "\"", "STRING", "\"", ":", "8", ",", "\"&", "\":", "9", ",", "\"=", "\":", "10", ",", "\"+", "\":", "11", ",", "\"(", "\":", "12", ",", "\")", "\":", "13", ",", "\"<", "\":", "14", ",", "\">", "\":", "15", ",", "\"", "NOT", "\"", ":", "16", ",", "\"-", "\":", "17", ",", "\"*", "\":", "18", ",", "\"/", "\":", "19", ",", "\"^", "\":", "20", ",", "\"", "FUNCTION", "\"", ":", "21", ",", "\"", "expseq", "\"", ":", "22", ",", "\"", "cell", "\"", ":", "23", ",", "\"", "ABSOLUTE_CELL", "\"", ":", "24", ",", "\"", "RELATIVE_CELL", "\"", ":", "25", ",", "\"", "MIXED_CELL", "\"", ":", "26", ",", "\":", "\":", "27", ",", "\"", "ARRAY", "\"", ":", "28", ",", "\";", "\":", "29", ",", "\",", "\":", "30", ",", "\"", "VARIABLE", "\"", ":", "31", ",", "\"", "DECIMAL", "\"", ":", "32", ",", "\"", "NUMBER", "\"", ":", "33", ",", "\"%", "\":", "34", ",", "\"", "ERROR", "\"", ":", "35", ",", "\"$", "accept", "\"", ":", "0", ",", "\"$", "end", "\"", ":", "1", "}", ",", "terminals_", ":", "{", "5", ":", "\"", "EOF", "\"", ",", "8", ":", "\"", "STRING", "\"", ",", "9", ":", "\"&", "\",", "10", ":", "\"=", "\",", "11", ":", "\"+", "\",", "12", ":", "\"(", "\",", "13", ":", "\")", "\",", "14", ":", "\"<", "\",", "15", ":", "\">", "\",", "16", ":", "\"", "NOT", "\"", ",", "17", ":", "\"-", "\",", "18", ":", "\"*", "\",", "19", ":", "\"/", "\",", "20", ":", "\"^", "\",", "21", ":", "\"", "FUNCTION", "\"", ",", "24", ":", "\"", "ABSOLUTE_CELL", "\"", ",", "25", ":", "\"", "RELATIVE_CELL", "\"", ",", "26", ":", "\"", "MIXED_CELL", "\"", ",", "27", ":", "\":", "\",", "28", ":", "\"", "ARRAY", "\"", ",", "29", ":", "\";", "\",", "30", ":", "\",", "\",", "31", ":", "\"", "VARIABLE", "\"", ",", "32", ":", "\"", "DECIMAL", "\"", ",", "33", ":", "\"", "NUMBER", "\"", ",", "34", ":", "\"%", "\",", "35", ":", "\"", "ERROR", "\"", "},", "@", "@", "-", "222", ",", "14", "+", "222", ",", "7", "@", "@", "case", "38", ":", "case", "42", ":", "break", ";", "case", "39", ":", "var", "result", "=", "[", "];", "var", "arr", "=", "eval", "(", "\"[", "\"", "+", "yytext", "+", "\"", "]\"", ");", "arr", ".", "forEach", "(", "function", "(", "item", ")", "{", "result", ".", "push", "(", "item", ")", ";", "}", ");", "this", ".", "$", "=", "result", ";", "this", ".", "$", "=", "yy", ".", "trimEdges", "(", "yytext", ")", ".", "split", "(", "',", "')", ";", "break", ";", "case", "40", ":", "case", "41", ":", "@", "@", "-", "268", ",", "20", "+", "261", ",", "16", "@", "@", "break", ";", "}", ",", "table", ":", "[", "{", "2", ":", "11", ",", "3", ":", "1", ",", "4", ":", "2", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "1", ":", "[", "3", "]", "},", "{", "5", ":", "[", "1", ",", "18", "]", ",", "9", ":", "$", "Vb", ",", "10", ":", "$", "Vc", ",", "11", ":", "$", "Vd", ",", "14", ":", "$", "Ve", ",", "15", ":", "$", "Vf", ",", "16", ":", "$", "Vg", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", ",", "o", "(", "$", "Vl", ",", "[", "2", ",", "2", "]", ",{", "32", ":", "[", "1", ",", "29", "]", "})", ",", "o", "(", "$", "Vl", ",", "[", "2", ",", "3", "]", ",{", "34", ":", "[", "1", ",", "30", "]", "})", ",", "o", "(", "$", "Vl", ",", "[", "2", ",", "4", "]", "),", "{", "2", ":", "11", ",", "4", ":", "31", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "32", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "33", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "12", ":", "[", "1", ",", "34", "]", "},", "o", "(", "$", "Vl", ",", "[", "2", ",", "23", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "24", "]", ",{", "2", ":", "35", ",", "35", ":", "$", "Va", "}", "),", "o", "(", "$", "Vm", ",", "[", "2", ",", "42", "]", "),", "o", "(", "$", "Vn", ",", "[", "2", ",", "44", "]", ",{", "32", ":", "[", "1", ",", "36", "]", "})", ",", "o", "(", "$", "Vl", ",", "[", "2", ",", "26", "]", ",{", "27", ":", "[", "1", ",", "37", "]", "})", ",", "o", "(", "$", "Vl", ",", "[", "2", ",", "27", "]", ",{", "27", ":", "[", "1", ",", "38", "]", "})", ",", "o", "(", "$", "Vl", ",", "[", "2", ",", "28", "]", ",{", "27", ":", "[", "1", ",", "39", "]", "})", ",", "o", "(", "[", "5", ",", "9", ",", "10", ",", "11", ",", "13", ",", "14", ",", "15", ",", "16", ",", "17", ",", "18", ",", "19", ",", "20", ",", "29", ",", "30", ",", "35", "]", ",[", "2", ",", "47", "]", "),", "{", "1", ":", "[", "2", ",", "1", "]", "},", "{", "2", ":", "11", ",", "4", ":", "40", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "41", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "42", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "45", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "10", ":", "[", "1", ",", "43", "]", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "15", ":", "[", "1", ",", "44", "]", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "47", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "10", ":", "[", "1", ",", "46", "]", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "48", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "49", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "50", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "51", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "52", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "31", ":", "[", "1", ",", "53", "]", "},", "o", "(", "$", "Vn", ",", "[", "2", ",", "46", "]", "),", "{", "9", ":", "$", "Vb", ",", "10", ":", "$", "Vc", ",", "11", ":", "$", "Vd", ",", "13", ":", "[", "1", ",", "54", "]", ",", "14", ":", "$", "Ve", ",", "15", ":", "$", "Vf", ",", "16", ":", "$", "Vg", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", ",", "o", "(", "$", "Vo", ",", "[", "2", ",", "19", "]", ",{", "9", ":", "$", "Vb", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vo", ",", "[", "2", ",", "20", "]", ",{", "9", ":", "$", "Vb", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "{", "2", ":", "11", ",", "4", ":", "57", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "13", ":", "[", "1", ",", "55", "]", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "22", ":", "56", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "28", ":", "[", "1", ",", "58", "]", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",", "o", "(", "$", "Vl", ",", "[", "2", ",", "25", "]", "),", "{", "33", ":", "[", "1", ",", "59", "]", "},", "{", "24", ":", "[", "1", ",", "60", "]", ",", "25", ":", "[", "1", ",", "61", "]", ",", "26", ":", "[", "1", ",", "62", "]", "},", "{", "24", ":", "[", "1", ",", "63", "]", ",", "25", ":", "[", "1", ",", "64", "]", ",", "26", ":", "[", "1", ",", "65", "]", "},", "{", "24", ":", "[", "1", ",", "66", "]", ",", "25", ":", "[", "1", ",", "67", "]", ",", "26", ":", "[", "1", ",", "68", "]", "},", "o", "(", "$", "Vl", ",", "[", "2", ",", "5", "]", "),", "o", "(", "[", "5", ",", "10", ",", "13", ",", "29", ",", "30", "]", ",[", "2", ",", "6", "]", ",{", "9", ":", "$", "Vb", ",", "11", ":", "$", "Vd", ",", "14", ":", "$", "Ve", ",", "15", ":", "$", "Vf", ",", "16", ":", "$", "Vg", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vo", ",", "[", "2", ",", "7", "]", ",{", "9", ":", "$", "Vb", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "{", "2", ":", "11", ",", "4", ":", "69", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "70", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",", "o", "(", "$", "Vp", ",", "[", "2", ",", "14", "]", ",{", "9", ":", "$", "Vb", ",", "11", ":", "$", "Vd", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "{", "2", ":", "11", ",", "4", ":", "71", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",", "o", "(", "$", "Vp", ",", "[", "2", ",", "13", "]", ",{", "9", ":", "$", "Vb", ",", "11", ":", "$", "Vd", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "[", "5", ",", "10", ",", "13", ",", "16", ",", "29", ",", "30", "]", ",[", "2", ",", "12", "]", ",{", "9", ":", "$", "Vb", ",", "11", ":", "$", "Vd", ",", "14", ":", "$", "Ve", ",", "15", ":", "$", "Vf", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vo", ",", "[", "2", ",", "15", "]", ",{", "9", ":", "$", "Vb", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vq", ",", "[", "2", ",", "16", "]", ",{", "9", ":", "$", "Vb", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vq", ",", "[", "2", ",", "17", "]", ",{", "9", ":", "$", "Vb", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "[", "5", ",", "10", ",", "11", ",", "13", ",", "14", ",", "15", ",", "16", ",", "17", ",", "18", ",", "19", ",", "20", ",", "29", ",", "30", "]", ",[", "2", ",", "18", "]", ",{", "9", ":", "$", "Vb", "}", "),", "o", "(", "$", "Vm", ",", "[", "2", ",", "43", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "8", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "21", "]", "),", "{", "13", ":", "[", "1", ",", "72", "]", ",", "29", ":", "[", "1", ",", "73", "]", ",", "30", ":", "[", "1", ",", "74", "]", "},", "o", "(", "$", "Vr", ",", "[", "2", ",", "38", "]", ",{", "9", ":", "$", "Vb", ",", "10", ":", "$", "Vc", ",", "11", ":", "$", "Vd", ",", "14", ":", "$", "Ve", ",", "15", ":", "$", "Vf", ",", "16", ":", "$", "Vg", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vr", ",", "[", "2", ",", "39", "]", "),", "o", "(", "$", "Vn", ",", "[", "2", ",", "45", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "29", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "30", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "31", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "32", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "33", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "34", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "35", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "36", "]", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "37", "]", "),", "o", "(", "$", "Vp", ",", "[", "2", ",", "9", "]", ",{", "9", ":", "$", "Vb", ",", "11", ":", "$", "Vd", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vp", ",", "[", "2", ",", "11", "]", ",{", "9", ":", "$", "Vb", ",", "11", ":", "$", "Vd", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vp", ",", "[", "2", ",", "10", "]", ",{", "9", ":", "$", "Vb", ",", "11", ":", "$", "Vd", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vl", ",", "[", "2", ",", "22", "]", "),", "{", "2", ":", "11", ",", "4", ":", "75", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",{", "2", ":", "11", ",", "4", ":", "76", ",", "6", ":", "3", ",", "7", ":", "4", ",", "8", ":", "$", "V0", ",", "11", ":", "$", "V1", ",", "12", ":", "$", "V2", ",", "17", ":", "$", "V3", ",", "21", ":", "$", "V4", ",", "23", ":", "10", ",", "24", ":", "$", "V5", ",", "25", ":", "$", "V6", ",", "26", ":", "$", "V7", ",", "31", ":", "$", "V8", ",", "33", ":", "$", "V9", ",", "35", ":", "$", "Va", "}", ",", "o", "(", "$", "Vr", ",", "[", "2", ",", "40", "]", ",{", "9", ":", "$", "Vb", ",", "10", ":", "$", "Vc", ",", "11", ":", "$", "Vd", ",", "14", ":", "$", "Ve", ",", "15", ":", "$", "Vf", ",", "16", ":", "$", "Vg", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", "),", "o", "(", "$", "Vr", ",", "[", "2", ",", "41", "]", ",{", "9", ":", "$", "Vb", ",", "10", ":", "$", "Vc", ",", "11", ":", "$", "Vd", ",", "14", ":", "$", "Ve", ",", "15", ":", "$", "Vf", ",", "16", ":", "$", "Vg", ",", "17", ":", "$", "Vh", ",", "18", ":", "$", "Vi", ",", "19", ":", "$", "Vj", ",", "20", ":", "$", "Vk", "}", ")]", ",", "defaultActions", ":", "{", "18", ":", "[", "2", ",", "1", "]", "},", "parseError", ":", "function", "parseError", "(", "str", ",", "hash", ")", "{", "parseError", ":", "function", "parseError", "(", "str", ",", "hash", ")", "{", "if", "(", "hash", ".", "recoverable", ")", "{", "this", ".", "trace", "(", "str", ")", ";", "}", "else", "{", "function", "_parseError", "(", "msg", ",", "hash", ")", "{", "this", ".", "message", "=", "msg", ";", "this", ".", "hash", "=", "hash", ";", "}", "_parseError", ".", "prototype", "=", "Error", ";", "throw", "new", "_parseError", "(", "str", ",", "hash", ")", ";", "var", "error", "=", "new", "Error", "(", "str", ")", ";", "error", ".", "hash", "=", "hash", ";", "throw", "error", ";", "}", "}", ",", "parse", ":", "function", "parse", "(", "input", ")", "{", "parse", ":", "function", "parse", "(", "input", ")", "{", "var", "self", "=", "this", ",", "stack", "=", "[", "0", "]", ",", "tstack", "=", "[", "],", "/", "/", "token", "stack", "@", "@", "-", "331", ",", "6", "+", "320", ",", "7", "@", "@", "parse", ":", "function", "parse", "(", "input", ")", "{", "lstack", ".", "length", "=", "lstack", ".", "length", "-", "n", ";", "}", "_token_stack", ":", "var", "lex", "=", "function", "(", ")", "{", "var", "token", ";", "token", "=", "lexer", ".", "lex", "(", ")", "|", "|", "EOF", ";", "@", "@", "-", "357", ",", "6", "+", "347", ",", "7", "@", "@", "parse", ":", "function", "parse", "(", "input", ")", "{", "action", "=", "table", "[", "state", "]", "&", "&", "table", "[", "state", "]", "[", "symbol", "]", ";", "}", "_handle_error", ":", "/", "/", "handle", "parse", "error", "if", "(", "typeof", "action", "=", "==", "'", "undefined", "'", "|", "|", "!", "action", ".", "length", "|", "|", "!", "action", "[", "0", "]", ")", "{", "var", "error_rule_depth", ";", "@", "@", "-", "660", ",", "7", "+", "651", ",", "7", "@", "@", "showPosition", ":", "function", "(", ")", "{", "}", ",", "/", "/", "test", "the", "lexed", "token", ":", "return", "FALSE", "when", "not", "a", "match", ",", "otherwise", "return", "token", "test_match", ":", "function", "(", "match", ",", "indexed_rule", ")", "{", "test_match", ":", "function", "(", "match", ",", "indexed_rule", ")", "{", "var", "token", ",", "lines", ",", "backup", ";", "@", "@", "-", "790", ",", "7", "+", "781", ",", "7", "@", "@", "next", ":", "function", "(", ")", "{", "}", ",", "/", "/", "return", "next", "match", "that", "has", "a", "token", "lex", ":", "function", "lex", "(", ")", "{", "lex", ":", "function", "lex", "(", ")", "{", "var", "r", "=", "this", ".", "next", "(", ");", "if", "(", "r", ")", "{", "return", "r", ";", "@", "@", "-", "800", ",", "12", "+", "791", ",", "12", "@", "@", "lex", ":", "function", "lex", "(", ")", "{", "}", ",", "/", "/", "activates", "a", "new", "lexer", "condition", "state", "(", "pushes", "the", "new", "lexer", "condition", "state", "onto", "the", "condition", "stack", ")", "begin", ":", "function", "begin", "(", "condition", ")", "{", "begin", ":", "function", "begin", "(", "condition", ")", "{", "this", ".", "conditionStack", ".", "push", "(", "condition", ")", ";", "}", ",", "/", "/", "pop", "the", "previously", "active", "lexer", "condition", "state", "off", "the", "condition", "stack", "popState", ":", "function", "popState", "(", ")", "{", "popState", ":", "function", "popState", "(", ")", "{", "var", "n", "=", "this", ".", "conditionStack", ".", "length", "-", "1", ";", "if", "(", "n", ">", "0", ")", "{", "return", "this", ".", "conditionStack", ".", "pop", "(", ");", "@", "@", "-", "815", ",", "7", "+", "806", ",", "7", "@", "@", "popState", ":", "function", "popState", "(", ")", "{", "}", ",", "/", "/", "produce", "the", "lexer", "rule", "set", "which", "is", "active", "for", "the", "currently", "active", "lexer", "condition", "state", "_currentRules", ":", "function", "_currentRules", "(", ")", "{", "_currentRules", ":", "function", "_currentRules", "(", ")", "{", "if", "(", "this", ".", "conditionStack", ".", "length", "&", "&", "this", ".", "conditionStack", "[", "this", ".", "conditionStack", ".", "length", "-", "1", "]", ")", "{", "return", "this", ".", "conditions", "[", "this", ".", "conditionStack", "[", "this", ".", "conditionStack", ".", "length", "-", "1", "]", "].", "rules", ";", "}", "else", "{", "@", "@", "-", "824", ",", "7", "+", "815", ",", "7", "@", "@", "_currentRules", ":", "function", "_currentRules", "(", ")", "{", "}", ",", "/", "/", "return", "the", "currently", "active", "lexer", "condition", "state", ";", "when", "an", "index", "argument", "is", "provided", "it", "produces", "the", "N", "-", "th", "previous", "condition", "state", ",", "if", "available", "topState", ":", "function", "topState", "(", "n", ")", "{", "topState", ":", "function", "topState", "(", "n", ")", "{", "n", "=", "this", ".", "conditionStack", ".", "length", "-", "1", "-", "Math", ".", "abs", "(", "n", "|", "|", "0", ")", ";", "if", "(", "n", ">", "=", "0", ")", "{", "return", "this", ".", "conditionStack", "[", "n", "]", ";", "@", "@", "-", "834", ",", "7", "+", "825", ",", "7", "@", "@", "topState", ":", "function", "topState", "(", "n", ")", "{", "}", ",", "/", "/", "alias", "for", "begin", "(", "condition", ")", "pushState", ":", "function", "pushState", "(", "condition", ")", "{", "pushState", ":", "function", "pushState", "(", "condition", ")", "{", "this", ".", "begin", "(", "condition", ")", ";", "}", ",", "@", "@", "-", "940", ",", "7", "+", "931", ",", "4", "@", "@", "if", "(", "typeof", "require", "!", "==", "'", "undefined", "'", "&", "&", "typeof", "exports", "!", "==", "'", "undefined", "'", ")", "{", "exports", ".", "parser", "=", "grammarParser", ";", "exports", ".", "Parser", "=", "grammarParser", ".", "Parser", ";", "exports", ".", "parse", "=", "function", "(", ")", "{", "return", "grammarParser", ".", "parse", ".", "apply", "(", "grammarParser", ",", "arguments", ")", ";", "}", ";", "if", "(", "typeof", "module", "!", "==", "'", "undefined", "'", "&", "&", "require", ".", "main", "=", "==", "module", ")", "{", "exports", ".", "main", "(", "process", ".", "argv", ".", "slice", "(", "1", ")", ");", "}", "}", "@", "@", "-", "24", ",", "4", "+", "24", ",", "10", "@", "@", "describe", "(", "'.", "parse", "(", ")", "custom", "function", "'", ",", "(", ")", "=", ">", "{", "expect", "(", "parser", ".", "parse", "(", "'", "SUM", "(", "4", ",", "ADD_5", "(", "1", ")", ")'", "))", ".", "toMatchObject", "(", "{", "error", ":", "null", ",", "result", ":", "10", "}", ");", "expect", "(", "parser", ".", "parse", "(", "'", "GET_LETTER", "(", "\"", "Some", "string", "\"", ",", "3", ")", "')", ").", "toMatchObject", "(", "{", "error", ":", "null", ",", "result", ":", "'", "m", "'", "})", ";", "}", ");", "it", "(", "'", "should", "evaluate", "function", "with", "arguments", "passed", "as", "an", "stringified", "array", "'", ",", "(", ")", "=", ">", "{", "expect", "(", "parser", ".", "parse", "(", "'", "SUM", "(", "[]", ")'", "))", ".", "toMatchObject", "(", "{", "error", ":", "null", ",", "result", ":", "0", "}", ");", "expect", "(", "parser", ".", "parse", "(", "'", "SUM", "(", "[", "1", "]", ")'", "))", ".", "toMatchObject", "(", "{", "error", ":", "null", ",", "result", ":", "1", "}", ");", "expect", "(", "parser", ".", "parse", "(", "'", "SUM", "(", "[", "1", ",", "2", ",", "3", "]", ")'", "))", ".", "toMatchObject", "(", "{", "error", ":", "null", ",", "result", ":", "6", "}", ");", "}", ");", "}", ");"], "docstring_tokens": ["a", "command", "injection", "flaw"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "99", ",", "6", "+", "99", ",", "14", "@", "@", "struct", "ib_umem", "*", "ib_umem_get", "(", "struct", "ib_ucontext", "*", "context", ",", "unsigned", "long", "addr", ",", "if", "(", "dmasync", ")", "dma_set_attr", "(", "DMA_ATTR_WRITE_BARRIER", ",", "&", "attrs", ")", ";", "/", "*", "*", "If", "the", "combination", "of", "the", "addr", "and", "size", "requested", "for", "this", "memory", "*", "region", "causes", "an", "integer", "overflow", ",", "return", "error", ".", "*", "/", "if", "(", "(", "PAGE_ALIGN", "(", "addr", "+", "size", ")", "<", "=", "size", ")", "|", "|", "(", "PAGE_ALIGN", "(", "addr", "+", "size", ")", "<", "=", "addr", ")", ")", "return", "ERR_PTR", "(", "-", "EINVAL", ")", ";", "if", "(", "!", "can_do_mlock", "(", "))", "return", "ERR_PTR", "(", "-", "EPERM", ")", ";"], "docstring_tokens": ["provide", "values", "which", "will", "cause", "an", "integer", "overflow", "when", "calculating", "the", "page", "aligned", "end", "address"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1936", ",", "7", "+", "1936", ",", "7", "@", "@", "static", "Image", "*", "ReadPSDImage", "(", "const", "ImageInfo", "*", "image_info", ",", "ExceptionInfo", "*", "exception", ")", "if", "(", "blocks", "=", "=", "(", "unsigned", "char", "*", ")", "NULL", ")", "ThrowReaderException", "(", "ResourceLimitError", ",", "\"", "MemoryAllocationFailed", "\"", ");", "count", "=", "ReadBlob", "(", "image", ",", "(", "size_t", ")", "length", ",", "blocks", ")", ";", "if", "(", "(", "count", "!", "=", "(", "ssize_t", ")", "length", ")", "|", "|", "if", "(", "(", "count", "!", "=", "(", "ssize_t", ")", "length", ")", "|", "|", "(", "length", "<", "4", ")", "|", "|", "(", "LocaleNCompare", "(", "(", "char", "*", ")", "blocks", ",", "\"", "8BIM", "\"", ",", "4", ")", "!", "=", "0", ")", ")", "{", "blocks", "=", "(", "unsigned", "char", "*", ")", "RelinquishMagickMemory", "(", "blocks", ")", ";"], "docstring_tokens": ["not", "releasing", "memory"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2545", ",", "7", "+", "2545", ",", "10", "@", "@", "static", "void", "exif_thumbnail_extract", "(", "image_info_type", "*", "ImageInfo", ",", "char", "*", "offset", ",", "siz", "return", ";", "}", "/", "*", "Check", "to", "make", "sure", "we", "are", "not", "going", "to", "go", "past", "the", "ExifLength", "*", "/", "if", "(", "(", "ImageInfo", "-", ">", "Thumbnail", ".", "offset", "+", "ImageInfo", "-", ">", "Thumbnail", ".", "size", ")", ">", "length", ")", "{", "if", "(", "ImageInfo", "-", ">", "Thumbnail", ".", "size", ">", "length", "|", "|", "(", "ImageInfo", "-", ">", "Thumbnail", ".", "offset", "+", "ImageInfo", "-", ">", "Thumbnail", ".", "size", ")", ">", "length", "|", "|", "ImageInfo", "-", ">", "Thumbnail", ".", "offset", ">", "length", "-", "ImageInfo", "-", ">", "Thumbnail", ".", "size", ")", "{", "EXIF_ERRLOG_THUMBEOF", "(", "ImageInfo", ")", "return", ";", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "19", "@", "@", "-", "-", "TEST", "-", "-", "Bug", "#", "76423", "(", "Int", "Overflow", "lead", "to", "Heap", "OverFlow", "in", "exif_thumbnail_extract", "of", "exif", ".", "c", ")", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "'", "exif", "'", "))", "die", "(", "'", "skip", "exif", "extension", "not", "available", "'", ");", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "exif_read_data", "(", "__DIR__", ".", "'", "/", "bug76423", ".", "jpg", "'", ",", "0", ",", "true", ",", "true", ")", ";", "?", ">", "=", "==", "DONE", "=", "==", "-", "-", "EXPECTF", "-", "-", "Warning", ":", "exif_read_data", "(", "%", "s", ".", "jpg", ")", ":", "Thumbnail", "goes", "IFD", "boundary", "or", "end", "of", "file", "reached", "in", "%", "s", "on", "line", "%", "d", "Warning", ":", "exif_read_data", "(", "%", "s", ".", "jpg", ")", ":", "File", "structure", "corrupted", "in", "%", "s", "on", "line", "%", "d", "Warning", ":", "exif_read_data", "(", "%", "s", ".", "jpg", ")", ":", "Invalid", "JPEG", "file", "in", "%", "s", "on", "line", "%", "d", "=", "==", "DONE", "=", "=="], "docstring_tokens": ["heap-based", "buffer", "over-read"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "144", ",", "7", "+", "144", ",", "12", "@", "@", "int", "xen_pcibk_enable_msi", "(", "struct", "xen_pcibk_device", "*", "pdev", ",", "if", "(", "unlikely", "(", "verbose_request", ")", ")", "printk", "(", "KERN_DEBUG", "DRV_NAME", "\"", ":", "%", "s", ":", "enable", "MSI", "\\", "n", "\"", ",", "pci_name", "(", "dev", ")", ");", "status", "=", "pci_enable_msi", "(", "dev", ")", ";", "if", "(", "dev", "-", ">", "msi_enabled", ")", "status", "=", "-", "EALREADY", ";", "else", "if", "(", "dev", "-", ">", "msix_enabled", ")", "status", "=", "-", "ENXIO", ";", "else", "status", "=", "pci_enable_msi", "(", "dev", ")", ";", "if", "(", "status", ")", "{", "pr_warn_ratelimited", "(", "\"%", "s", ":", "error", "enabling", "MSI", "for", "guest", "%", "u", ":", "err", "%", "d", "\\", "n", "\"", ","], "docstring_tokens": ["missing", "check", "to", "verify", "whether", "the", "device", "has", "memory", "decoding", "enabled", "set", "at", "the", "start", "of", "the", "day"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "847", ",", "7", "+", "847", ",", "7", "@", "@", "static", "void", "alpha_perf_event_irq_handler", "(", "unsigned", "long", "la_ptr", ",", "data", ".", "period", "=", "event", "-", ">", "hw", ".", "last_period", ";", "if", "(", "alpha_perf_event_set_period", "(", "event", ",", "hwc", ",", "idx", ")", ")", "{", "if", "(", "perf_event_overflow", "(", "event", ",", "1", ",", "&", "data", ",", "regs", ")", ")", "{", "if", "(", "perf_event_overflow", "(", "event", ",", "&", "data", ",", "regs", ")", ")", "{", "/", "*", "Interrupts", "coming", "too", "quickly", ";", "\"", "throttle", "\"", "the", "*", "counter", ",", "i", ".", "e", ".", ",", "disable", "it", "for", "a", "little", "while", ".", "*", "/", "@", "@", "-", "479", ",", "7", "+", "479", ",", "7", "@", "@", "armv6pmu_handle_irq", "(", "int", "irq_num", ",", "if", "(", "!", "armpmu_event_set_period", "(", "event", ",", "hwc", ",", "idx", ")", ")", "continue", ";", "if", "(", "perf_event_overflow", "(", "event", ",", "0", ",", "&", "data", ",", "regs", ")", ")", "if", "(", "perf_event_overflow", "(", "event", ",", "&", "data", ",", "regs", ")", ")", "armpmu", "-", ">", "disable", "(", "hwc", ",", "idx", ")", ";", "}", "@", "@", "-", "787", ",", "7", "+", "787", ",", "7", "@", "@", "static", "irqreturn_t", "armv7pmu_handle_irq", "(", "int", "irq_num", ",", "void", "*", "dev", ")", "if", "(", "!", "armpmu_event_set_period", "(", "event", ",", "hwc", ",", "idx", ")", ")", "continue", ";", "if", "(", "perf_event_overflow", "(", "event", ",", "0", ",", "&", "data", ",", "regs", ")", ")", "if", "(", "perf_event_overflow", "(", "event", ",", "&", "data", ",", "regs", ")", ")", "armpmu", "-", ">", "disable", "(", "hwc", ",", "idx", ")", ";", "}", "@", "@", "-", "251", ",", "7", "+", "251", ",", "7", "@", "@", "xscale1pmu_handle_irq", "(", "int", "irq_num", ",", "void", "*", "dev", ")", "if", "(", "!", "armpmu_event_set_period", "(", "event", ",", "hwc", ",", "idx", ")", ")", "continue", ";", "if", "(", "perf_event_overflow", "(", "event", ",", "0", ",", "&", "data", ",", "regs", ")", ")", "if", "(", "perf_event_overflow", "(", "event", ",", "&", "data", ",", "regs", ")", ")", "armpmu", "-", ">", "disable", "(", "hwc", ",", "idx", ")", ";", "}", "@", "@", "-", "583", ",", "7", "+", "583", ",", "7", "@", "@", "xscale2pmu_handle_irq", "(", "int", "irq_num", ",", "void", "*", "dev", ")", "if", "(", "!", "armpmu_event_set_period", "(", "event", ",", "hwc", ",", "idx", ")", ")", "continue", ";", "if", "(", "perf_event_overflow", "(", "event", ",", "0", ",", "&", "data", ",", "regs", ")", ")", "if", "(", "perf_event_overflow", "(", "event", ",", "&", "data", ",", "regs", ")", ")", "armpmu", "-", ">", "disable", "(", "hwc", ",", "idx", ")", ";", "}", "@", "@", "-", "396", ",", "7", "+", "396", ",", "7", "@", "@", "static", "long", "ptrace_hbp_idx_to_num", "(", "int", "idx", ")", "/", "*", "*", "Handle", "hitting", "a", "HW", "-", "breakpoint", ".", "*", "/", "static", "void", "ptrace_hbptriggered", "(", "struct", "perf_event", "*", "bp", ",", "int", "unused", ",", "static", "void", "ptrace_hbptriggered", "(", "struct", "perf_event", "*", "bp", ",", "struct", "perf_sample_data", "*", "data", ",", "struct", "pt_regs", "*", "regs", ")", "{", "@", "@", "-", "183", ",", "7", "+", "183", ",", "7", "@", "@", "static", "int", "swp_handler", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "int", "instr", ")", "unsigned", "int", "address", ",", "destreg", ",", "data", ",", "type", ";", "unsigned", "int", "res", "=", "0", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "regs", "-", ">", "ARM_pc", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "regs", ",", "regs", "-", ">", "ARM_pc", ")", ";", "if", "(", "current", "-", ">", "pid", "!", "=", "previous_pid", ")", "{", "pr_debug", "(", "\"\\", "\"%", "s", "\\", "\"", "(", "%", "ld", ")", "uses", "deprecated", "SWP", "{", "B", "}", "instruction", "\\", "n", "\"", ",", "@", "@", "-", "318", ",", "11", "+", "318", ",", "11", "@", "@", "do_page_fault", "(", "unsigned", "long", "addr", ",", "unsigned", "int", "fsr", ",", "struct", "pt_regs", "*", "regs", ")", "fault", "=", "__do_page_fault", "(", "mm", ",", "addr", ",", "fsr", ",", "tsk", ")", ";", "up_read", "(", "&", "mm", "-", ">", "mmap_sem", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "addr", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "regs", ",", "addr", ")", ";", "if", "(", "fault", "&", "VM_FAULT_MAJOR", ")", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "0", ",", "regs", ",", "addr", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "regs", ",", "addr", ")", ";", "else", "if", "(", "fault", "&", "VM_FAULT_MINOR", ")", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "0", ",", "regs", ",", "addr", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "regs", ",", "addr", ")", ";", "/", "*", "*", "Handle", "the", "\"", "normal", "\"", "case", "first", "-", "VM_FAULT_MAJOR", "/", "VM_FAULT_MINOR", "@", "@", "-", "527", ",", "7", "+", "527", ",", "7", "@", "@", "handle_associated_event", "(", "struct", "cpu_hw_events", "*", "cpuc", ",", "if", "(", "!", "mipspmu_event_set_period", "(", "event", ",", "hwc", ",", "idx", ")", ")", "return", ";", "if", "(", "perf_event_overflow", "(", "event", ",", "0", ",", "data", ",", "regs", ")", ")", "if", "(", "perf_event_overflow", "(", "event", ",", "data", ",", "regs", ")", ")", "mipspmu", "-", ">", "disable_event", "(", "idx", ")", ";", "}", "@", "@", "-", "578", ",", "12", "+", "578", ",", "12", "@", "@", "static", "int", "simulate_llsc", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "int", "opcode", ")", "{", "if", "(", "(", "opcode", "&", "OPCODE", ")", "=", "=", "LL", ")", "{", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "0", ")", ";", "1", ",", "regs", ",", "0", ")", ";", "return", "simulate_ll", "(", "regs", ",", "opcode", ")", ";", "}", "if", "(", "(", "opcode", "&", "OPCODE", ")", "=", "=", "SC", ")", "{", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "0", ")", ";", "1", ",", "regs", ",", "0", ")", ";", "return", "simulate_sc", "(", "regs", ",", "opcode", ")", ";", "}", "@", "@", "-", "602", ",", "7", "+", "602", ",", "7", "@", "@", "static", "int", "simulate_rdhwr", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "int", "opcode", ")", "int", "rd", "=", "(", "opcode", "&", "RD", ")", ">", ">", "11", ";", "int", "rt", "=", "(", "opcode", "&", "RT", ")", ">", ">", "16", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "0", ")", ";", "1", ",", "regs", ",", "0", ")", ";", "switch", "(", "rd", ")", "{", "case", "0", ":", "/", "*", "CPU", "number", "*", "/", "regs", "-", ">", "regs", "[", "rt", "]", "=", "smp_processor_id", "(", ");", "@", "@", "-", "640", ",", "7", "+", "640", ",", "7", "@", "@", "static", "int", "simulate_sync", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "int", "opcode", ")", "{", "if", "(", "(", "opcode", "&", "OPCODE", ")", "=", "=", "SPEC0", "&", "&", "(", "opcode", "&", "FUNC", ")", "=", "=", "SYNC", ")", "{", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "0", ")", ";", "1", ",", "regs", ",", "0", ")", ";", "return", "0", ";", "}", "@", "@", "-", "111", ",", "8", "+", "111", ",", "7", "@", "@", "static", "void", "emulate_load_store_insn", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "long", "value", ";", "unsigned", "int", "res", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "0", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "regs", ",", "0", ")", ";", "/", "*", "*", "This", "load", "never", "faults", ".", "@", "@", "-", "517", ",", "7", "+", "516", ",", "7", "@", "@", "asmlinkage", "void", "do_ade", "(", "struct", "pt_regs", "*", "regs", ")", "mm_segment_t", "seg", ";", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "regs", "-", ">", "cp0_badvaddr", ")", ";", "1", ",", "regs", ",", "regs", "-", ">", "cp0_badvaddr", ")", ";", "/", "*", "*", "Did", "we", "catch", "a", "fault", "trying", "to", "load", "an", "instruction", "?", "*", "Or", "are", "we", "running", "in", "MIPS16", "mode", "?", "@", "@", "-", "272", ",", "8", "+", "272", ",", "7", "@", "@", "static", "int", "cop1Emulate", "(", "struct", "pt_regs", "*", "xcp", ",", "struct", "mips_fpu_struct", "*", "ctx", ",", "}", "emul", ":", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "0", ",", "xcp", ",", "0", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "xcp", ",", "0", ")", ";", "MIPS_FPU_EMU_INC_STATS", "(", "emulated", ")", ";", "switch", "(", "MIPSInst_OPCODE", "(", "ir", ")", ")", "{", "case", "ldc1_op", ":", "{", "@", "@", "-", "145", ",", "7", "+", "145", ",", "7", "@", "@", "asmlinkage", "void", "__kprobes", "do_page_fault", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "long", "writ", "*", "the", "fault", ".", "*", "/", "fault", "=", "handle_mm_fault", "(", "mm", ",", "vma", ",", "address", ",", "write", "?", "FAULT_FLAG_WRITE", ":", "0", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "regs", ",", "address", ")", ";", "if", "(", "unlikely", "(", "fault", "&", "VM_FAULT_ERROR", ")", ")", "{", "if", "(", "fault", "&", "VM_FAULT_OOM", ")", "goto", "out_of_memory", ";", "@", "@", "-", "154", ",", "12", "+", "154", ",", "10", "@", "@", "asmlinkage", "void", "__kprobes", "do_page_fault", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "long", "writ", "BUG", "(", ");", "}", "if", "(", "fault", "&", "VM_FAULT_MAJOR", ")", "{", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "regs", ",", "address", ")", ";", "tsk", "-", ">", "maj_flt", "+", "+;", "}", "else", "{", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "regs", ",", "address", ")", ";", "tsk", "-", ">", "min_flt", "+", "+;", "}", "@", "@", "-", "78", ",", "14", "+", "78", ",", "14", "@", "@", "extern", "void", "ppc_warn_emulated_print", "(", "const", "char", "*", "type", ")", ";", "#", "define", "PPC_WARN_EMULATED", "(", "type", ",", "regs", ")", "\\", "do", "{", "\\", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "\\", "1", ",", "0", ",", "regs", ",", "0", ")", ";", "\\", "1", ",", "regs", ",", "0", ")", ";", "\\", "__PPC_WARN_EMULATED", "(", "type", ")", ";", "\\", "}", "while", "(", "0", ")", "#", "define", "PPC_WARN_ALIGNMENT", "(", "type", ",", "regs", ")", "\\", "do", "{", "\\", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "\\", "1", ",", "0", ",", "regs", ",", "regs", "-", ">", "dar", ")", ";", "\\", "1", ",", "regs", ",", "regs", "-", ">", "dar", ")", ";", "\\", "__PPC_WARN_EMULATED", "(", "type", ")", ";", "\\", "}", "while", "(", "0", ")", "@", "@", "-", "1207", ",", "7", "+", "1207", ",", "7", "@", "@", "struct", "pmu", "power_pmu", "=", "{", "*", "here", "so", "there", "is", "no", "possibility", "of", "being", "interrupted", ".", "*", "/", "static", "void", "record_and_restart", "(", "struct", "perf_event", "*", "event", ",", "unsigned", "long", "val", ",", "struct", "pt_regs", "*", "regs", ",", "int", "nmi", ")", "struct", "pt_regs", "*", "regs", ")", "{", "u64", "period", "=", "event", "-", ">", "hw", ".", "sample_period", ";", "s64", "prev", ",", "delta", ",", "left", ";", "@", "@", "-", "1258", ",", "7", "+", "1258", ",", "7", "@", "@", "static", "void", "record_and_restart", "(", "struct", "perf_event", "*", "event", ",", "unsigned", "long", "val", ",", "if", "(", "event", "-", ">", "attr", ".", "sample_type", "&", "PERF_SAMPLE_ADDR", ")", "perf_get_data_addr", "(", "regs", ",", "&", "data", ".", "addr", ")", ";", "if", "(", "perf_event_overflow", "(", "event", ",", "nmi", ",", "&", "data", ",", "regs", ")", ")", "if", "(", "perf_event_overflow", "(", "event", ",", "&", "data", ",", "regs", ")", ")", "power_pmu_stop", "(", "event", ",", "0", ")", ";", "}", "}", "@", "@", "-", "1346", ",", "7", "+", "1346", ",", "7", "@", "@", "static", "void", "perf_event_interrupt", "(", "struct", "pt_regs", "*", "regs", ")", "if", "(", "(", "int", ")", "val", "<", "0", ")", "{", "/", "*", "event", "has", "overflowed", "*", "/", "found", "=", "1", ";", "record_and_restart", "(", "event", ",", "val", ",", "regs", ",", "nmi", ")", ";", "record_and_restart", "(", "event", ",", "val", ",", "regs", ")", ";", "}", "}", "@", "@", "-", "568", ",", "7", "+", "568", ",", "7", "@", "@", "static", "struct", "pmu", "fsl_emb_pmu", "=", "{", "*", "here", "so", "there", "is", "no", "possibility", "of", "being", "interrupted", ".", "*", "/", "static", "void", "record_and_restart", "(", "struct", "perf_event", "*", "event", ",", "unsigned", "long", "val", ",", "struct", "pt_regs", "*", "regs", ",", "int", "nmi", ")", "struct", "pt_regs", "*", "regs", ")", "{", "u64", "period", "=", "event", "-", ">", "hw", ".", "sample_period", ";", "s64", "prev", ",", "delta", ",", "left", ";", "@", "@", "-", "616", ",", "7", "+", "616", ",", "7", "@", "@", "static", "void", "record_and_restart", "(", "struct", "perf_event", "*", "event", ",", "unsigned", "long", "val", ",", "perf_sample_data_init", "(", "&", "data", ",", "0", ")", ";", "data", ".", "period", "=", "event", "-", ">", "hw", ".", "last_period", ";", "if", "(", "perf_event_overflow", "(", "event", ",", "nmi", ",", "&", "data", ",", "regs", ")", ")", "if", "(", "perf_event_overflow", "(", "event", ",", "&", "data", ",", "regs", ")", ")", "fsl_emb_pmu_stop", "(", "event", ",", "0", ")", ";", "}", "}", "@", "@", "-", "644", ",", "7", "+", "644", ",", "7", "@", "@", "static", "void", "perf_event_interrupt", "(", "struct", "pt_regs", "*", "regs", ")", "if", "(", "event", ")", "{", "/", "*", "event", "has", "overflowed", "*", "/", "found", "=", "1", ";", "record_and_restart", "(", "event", ",", "val", ",", "regs", ",", "nmi", ")", ";", "record_and_restart", "(", "event", ",", "val", ",", "regs", ")", ";", "}", "else", "{", "/", "*", "*", "Disabled", "counter", "is", "negative", ",", "@", "@", "-", "882", ",", "7", "+", "882", ",", "7", "@", "@", "void", "user_disable_single_step", "(", "struct", "task_struct", "*", "task", ")", "}", "#", "ifdef", "CONFIG_HAVE_HW_BREAKPOINT", "void", "ptrace_triggered", "(", "struct", "perf_event", "*", "bp", ",", "int", "nmi", ",", "void", "ptrace_triggered", "(", "struct", "perf_event", "*", "bp", ",", "struct", "perf_sample_data", "*", "data", ",", "struct", "pt_regs", "*", "regs", ")", "{", "struct", "perf_event_attr", "attr", ";", "@", "@", "-", "173", ",", "7", "+", "173", ",", "7", "@", "@", "int", "__kprobes", "do_page_fault", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "long", "address", ",", "die", "(", "\"", "Weird", "page", "fault", "\"", ",", "regs", ",", "SIGSEGV", ")", ";", "}", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "regs", ",", "address", ")", ";", "/", "*", "When", "running", "in", "the", "kernel", "we", "expect", "faults", "to", "occur", "only", "to", "*", "addresses", "in", "user", "space", ".", "All", "other", "faults", "represent", "errors", "in", "the", "@", "@", "-", "319", ",", "7", "+", "319", ",", "7", "@", "@", "int", "__kprobes", "do_page_fault", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "long", "address", ",", "}", "if", "(", "ret", "&", "VM_FAULT_MAJOR", ")", "{", "current", "-", ">", "maj_flt", "+", "+;", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "0", ",", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "regs", ",", "address", ")", ";", "#", "ifdef", "CONFIG_PPC_SMLPAR", "if", "(", "firmware_has_feature", "(", "FW_FEATURE_CMO", ")", ")", "{", "@", "@", "-", "330", ",", "7", "+", "330", ",", "7", "@", "@", "int", "__kprobes", "do_page_fault", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "long", "address", ",", "#", "endif", "}", "else", "{", "current", "-", ">", "min_flt", "+", "+;", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "0", ",", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "regs", ",", "address", ")", ";", "}", "up_read", "(", "&", "mm", "-", ">", "mmap_sem", ")", ";", "@", "@", "-", "299", ",", "7", "+", "299", ",", "7", "@", "@", "static", "inline", "int", "do_exception", "(", "struct", "pt_regs", "*", "regs", ",", "int", "access", ",", "goto", "out", ";", "address", "=", "trans_exc_code", "&", "__FAIL_ADDR_MASK", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "regs", ",", "address", ")", ";", "flags", "=", "FAULT_FLAG_ALLOW_RETRY", ";", "if", "(", "access", "=", "=", "VM_WRITE", "|", "|", "(", "trans_exc_code", "&", "store_indication", ")", "=", "=", "0x400", ")", "flags", "|", "=", "FAULT_FLAG_WRITE", ";", "@", "@", "-", "345", ",", "11", "+", "345", ",", "11", "@", "@", "static", "inline", "int", "do_exception", "(", "struct", "pt_regs", "*", "regs", ",", "int", "access", ",", "if", "(", "flags", "&", "FAULT_FLAG_ALLOW_RETRY", ")", "{", "if", "(", "fault", "&", "VM_FAULT_MAJOR", ")", "{", "tsk", "-", ">", "maj_flt", "+", "+;", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "0", ",", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "regs", ",", "address", ")", ";", "}", "else", "{", "tsk", "-", ">", "min_flt", "+", "+;", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "0", ",", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "regs", ",", "address", ")", ";", "}", "if", "(", "fault", "&", "VM_FAULT_RETRY", ")", "{", "@", "@", "-", "63", ",", "7", "+", "63", ",", "7", "@", "@", "static", "inline", "int", "put_stack_long", "(", "struct", "task_struct", "*", "task", ",", "int", "offset", ",", "return", "0", ";", "}", "void", "ptrace_triggered", "(", "struct", "perf_event", "*", "bp", ",", "int", "nmi", ",", "void", "ptrace_triggered", "(", "struct", "perf_event", "*", "bp", ",", "struct", "perf_sample_data", "*", "data", ",", "struct", "pt_regs", "*", "regs", ")", "{", "struct", "perf_event_attr", "attr", ";", "@", "@", "-", "393", ",", "7", "+", "393", ",", "7", "@", "@", "int", "handle_unaligned_access", "(", "insn_size_t", "instruction", ",", "struct", "pt_regs", "*", "regs", ",", "*", "/", "if", "(", "!", "expected", ")", "{", "unaligned_fixups_notify", "(", "current", ",", "instruction", ",", "regs", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "1", ",", "0", ",", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "1", ",", "regs", ",", "address", ")", ";", "}", "@", "@", "-", "434", ",", "7", "+", "434", ",", "7", "@", "@", "static", "int", "misaligned_load", "(", "struct", "pt_regs", "*", "regs", ",", "return", "error", ";", "}", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "1", ",", "regs", ",", "address", ")", ";", "destreg", "=", "(", "opcode", ">", ">", "4", ")", "&", "0x3f", ";", "if", "(", "user_mode", "(", "regs", ")", ")", "{", "@", "@", "-", "512", ",", "7", "+", "512", ",", "7", "@", "@", "static", "int", "misaligned_store", "(", "struct", "pt_regs", "*", "regs", ",", "return", "error", ";", "}", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "1", ",", "regs", ",", "address", ")", ";", "srcreg", "=", "(", "opcode", ">", ">", "4", ")", "&", "0x3f", ";", "if", "(", "user_mode", "(", "regs", ")", ")", "{", "@", "@", "-", "588", ",", "7", "+", "588", ",", "7", "@", "@", "static", "int", "misaligned_fpu_load", "(", "struct", "pt_regs", "*", "regs", ",", "return", "error", ";", "}", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "regs", ",", "address", ")", ";", "destreg", "=", "(", "opcode", ">", ">", "4", ")", "&", "0x3f", ";", "if", "(", "user_mode", "(", "regs", ")", ")", "{", "@", "@", "-", "665", ",", "7", "+", "665", ",", "7", "@", "@", "static", "int", "misaligned_fpu_store", "(", "struct", "pt_regs", "*", "regs", ",", "return", "error", ";", "}", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "regs", ",", "address", ")", ";", "srcreg", "=", "(", "opcode", ">", ">", "4", ")", "&", "0x3f", ";", "if", "(", "user_mode", "(", "regs", ")", ")", "{", "@", "@", "-", "620", ",", "7", "+", "620", ",", "7", "@", "@", "int", "do_fpu_inst", "(", "unsigned", "short", "inst", ",", "struct", "pt_regs", "*", "regs", ")", "struct", "task_struct", "*", "tsk", "=", "current", ";", "struct", "sh_fpu_soft_struct", "*", "fpu", "=", "&", "(", "tsk", "-", ">", "thread", ".", "xstate", "-", ">", "softfpu", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "0", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "regs", ",", "0", ")", ";", "if", "(", "!(", "task_thread_info", "(", "tsk", ")", "->", "status", "&", "TS_USEDFPU", ")", ")", "{", "/", "*", "initialize", "once", ".", "*", "/", "@", "@", "-", "160", ",", "7", "+", "160", ",", "7", "@", "@", "asmlinkage", "void", "__kprobes", "do_page_fault", "(", "struct", "pt_regs", "*", "regs", ",", "if", "(", "(", "regs", "-", ">", "sr", "&", "SR_IMASK", ")", "!", "=", "SR_IMASK", ")", "local_irq_enable", "(", ");", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "regs", ",", "address", ")", ";", "/", "*", "*", "If", "we", "'", "re", "in", "an", "interrupt", ",", "have", "no", "user", "context", "or", "are", "running", "@", "@", "-", "210", ",", "11", "+", "210", ",", "11", "@", "@", "asmlinkage", "void", "__kprobes", "do_page_fault", "(", "struct", "pt_regs", "*", "regs", ",", "}", "if", "(", "fault", "&", "VM_FAULT_MAJOR", ")", "{", "tsk", "-", ">", "maj_flt", "+", "+;", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "0", ",", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "regs", ",", "address", ")", ";", "}", "else", "{", "tsk", "-", ">", "min_flt", "+", "+;", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "0", ",", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "regs", ",", "address", ")", ";", "}", "@", "@", "-", "116", ",", "7", "+", "116", ",", "7", "@", "@", "asmlinkage", "void", "do_page_fault", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "long", "writeaccess", ",", "/", "*", "Not", "an", "IO", "address", ",", "so", "reenable", "interrupts", "*", "/", "local_irq_enable", "(", ");", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "regs", ",", "address", ")", ";", "/", "*", "*", "If", "we", "'", "re", "in", "an", "interrupt", "or", "have", "no", "user", "@", "@", "-", "200", ",", "11", "+", "200", ",", "11", "@", "@", "asmlinkage", "void", "do_page_fault", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "long", "writeaccess", ",", "if", "(", "fault", "&", "VM_FAULT_MAJOR", ")", "{", "tsk", "-", ">", "maj_flt", "+", "+;", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "0", ",", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "regs", ",", "address", ")", ";", "}", "else", "{", "tsk", "-", ">", "min_flt", "+", "+;", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "0", ",", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "regs", ",", "address", ")", ";", "}", "@", "@", "-", "1277", ",", "7", "+", "1277", ",", "7", "@", "@", "static", "int", "__kprobes", "perf_event_nmi_handler", "(", "struct", "notifier_block", "*", "self", ",", "if", "(", "!", "sparc_perf_event_set_period", "(", "event", ",", "hwc", ",", "idx", ")", ")", "continue", ";", "if", "(", "perf_event_overflow", "(", "event", ",", "1", ",", "&", "data", ",", "regs", ")", ")", "if", "(", "perf_event_overflow", "(", "event", ",", "&", "data", ",", "regs", ")", ")", "sparc_pmu_stop", "(", "event", ",", "0", ")", ";", "}", "@", "@", "-", "247", ",", "7", "+", "247", ",", "7", "@", "@", "asmlinkage", "void", "kernel_unaligned_trap", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "int", "insn", ")", "unsigned", "long", "addr", "=", "compute_effective_address", "(", "regs", ",", "insn", ")", ";", "int", "err", ";", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "addr", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "1", ",", "regs", ",", "addr", ")", ";", "switch", "(", "dir", ")", "{", "case", "load", ":", "err", "=", "do_int_load", "(", "fetch_reg_addr", "(", "((", "insn", ">", ">", "25", ")", "&", "0x1f", ")", ",", "@", "@", "-", "338", ",", "7", "+", "338", ",", "7", "@", "@", "asmlinkage", "void", "user_unaligned_trap", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "int", "insn", ")", "}", "addr", "=", "compute_effective_address", "(", "regs", ",", "insn", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "addr", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "1", ",", "regs", ",", "addr", ")", ";", "switch", "(", "dir", ")", "{", "case", "load", ":", "err", "=", "do_int_load", "(", "fetch_reg_addr", "(", "((", "insn", ">", ">", "25", ")", "&", "0x1f", ")", ",", "@", "@", "-", "317", ",", "7", "+", "317", ",", "7", "@", "@", "asmlinkage", "void", "kernel_unaligned_trap", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "int", "insn", ")", "addr", "=", "compute_effective_address", "(", "regs", ",", "insn", ",", "(", "(", "insn", ">", ">", "25", ")", "&", "0x1f", ")", ");", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "addr", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "1", ",", "regs", ",", "addr", ")", ";", "switch", "(", "asi", ")", "{", "case", "ASI_NL", ":", "case", "ASI_AIUPL", ":", "@", "@", "-", "384", ",", "7", "+", "384", ",", "7", "@", "@", "int", "handle_popc", "(", "u32", "insn", ",", "struct", "pt_regs", "*", "regs", ")", "int", "ret", ",", "i", ",", "rd", "=", "(", "(", "insn", ">", ">", "25", ")", "&", "0x1f", ")", ";", "int", "from_kernel", "=", "(", "regs", "-", ">", "tstate", "&", "TSTATE_PRIV", ")", "!", "=", "0", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "0", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "regs", ",", "0", ")", ";", "if", "(", "insn", "&", "0x2000", ")", "{", "maybe_flush_windows", "(", "0", ",", "0", ",", "rd", ",", "from_kernel", ")", ";", "value", "=", "sign_extend_imm13", "(", "insn", ")", ";", "@", "@", "-", "431", ",", "7", "+", "431", ",", "7", "@", "@", "int", "handle_ldf_stq", "(", "u32", "insn", ",", "struct", "pt_regs", "*", "regs", ")", "int", "asi", "=", "decode_asi", "(", "insn", ",", "regs", ")", ";", "int", "flag", "=", "(", "freg", "<", "32", ")", "?", "FPRS_DL", ":", "FPRS_DU", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "0", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "regs", ",", "0", ")", ";", "save_and_clear_fpu", "(", ");", "current_thread_info", "(", ")-", ">", "xfsr", "[", "0", "]", "&", "=", "~", "0x1c000", ";", "@", "@", "-", "554", ",", "7", "+", "554", ",", "7", "@", "@", "void", "handle_ld_nf", "(", "u32", "insn", ",", "struct", "pt_regs", "*", "regs", ")", "int", "from_kernel", "=", "(", "regs", "-", ">", "tstate", "&", "TSTATE_PRIV", ")", "!", "=", "0", ";", "unsigned", "long", "*", "reg", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "0", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "regs", ",", "0", ")", ";", "maybe_flush_windows", "(", "0", ",", "0", ",", "rd", ",", "from_kernel", ")", ";", "reg", "=", "fetch_reg_addr", "(", "rd", ",", "regs", ")", ";", "@", "@", "-", "586", ",", "7", "+", "586", ",", "7", "@", "@", "void", "handle_lddfmna", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "long", "sfar", ",", "unsigned", "long", "sfsr", "if", "(", "tstate", "&", "TSTATE_PRIV", ")", "die_if_kernel", "(", "\"", "lddfmna", "from", "kernel", "\"", ",", "regs", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "sfar", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "1", ",", "regs", ",", "sfar", ")", ";", "if", "(", "test_thread_flag", "(", "TIF_32BIT", ")", ")", "pc", "=", "(", "u32", ")", "pc", ";", "if", "(", "get_user", "(", "insn", ",", "(", "u32", "__user", "*", ")", "pc", ")", "!", "=", "-", "EFAULT", ")", "{", "@", "@", "-", "647", ",", "7", "+", "647", ",", "7", "@", "@", "void", "handle_stdfmna", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "long", "sfar", ",", "unsigned", "long", "sfsr", "if", "(", "tstate", "&", "TSTATE_PRIV", ")", "die_if_kernel", "(", "\"", "stdfmna", "from", "kernel", "\"", ",", "regs", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "sfar", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_ALIGNMENT_FAULTS", ",", "1", ",", "regs", ",", "sfar", ")", ";", "if", "(", "test_thread_flag", "(", "TIF_32BIT", ")", ")", "pc", "=", "(", "u32", ")", "pc", ";", "if", "(", "get_user", "(", "insn", ",", "(", "u32", "__user", "*", ")", "pc", ")", "!", "=", "-", "EFAULT", ")", "{", "@", "@", "-", "802", ",", "7", "+", "802", ",", "7", "@", "@", "int", "vis_emul", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "int", "insn", ")", "BUG_ON", "(", "regs", "-", ">", "tstate", "&", "TSTATE_PRIV", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "0", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "regs", ",", "0", ")", ";", "if", "(", "test_thread_flag", "(", "TIF_32BIT", ")", ")", "pc", "=", "(", "u32", ")", "pc", ";", "@", "@", "-", "164", ",", "7", "+", "164", ",", "7", "@", "@", "int", "do_mathemu", "(", "struct", "pt_regs", "*", "regs", ",", "struct", "task_struct", "*", "fpt", ")", "int", "retcode", "=", "0", ";", "/", "*", "assume", "all", "succeed", "*", "/", "unsigned", "long", "insn", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "0", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "regs", ",", "0", ")", ";", "#", "ifdef", "DEBUG_MATHEMU", "printk", "(", "\"", "In", "do_mathemu", "(", ").", "..", "pc", "is", "%", "08lx", "\\", "n", "\"", ",", "regs", "-", ">", "pc", ")", ";", "@", "@", "-", "184", ",", "7", "+", "184", ",", "7", "@", "@", "int", "do_mathemu", "(", "struct", "pt_regs", "*", "regs", ",", "struct", "fpustate", "*", "f", ")", "if", "(", "tstate", "&", "TSTATE_PRIV", ")", "die_if_kernel", "(", "\"", "unfinished", "/", "unimplemented", "FPop", "from", "kernel", "\"", ",", "regs", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "0", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_EMULATION_FAULTS", ",", "1", ",", "regs", ",", "0", ")", ";", "if", "(", "test_thread_flag", "(", "TIF_32BIT", ")", ")", "pc", "=", "(", "u32", ")", "pc", ";", "if", "(", "get_user", "(", "insn", ",", "(", "u32", "__user", "*", ")", "pc", ")", "!", "=", "-", "EFAULT", ")", "{", "@", "@", "-", "251", ",", "7", "+", "251", ",", "7", "@", "@", "asmlinkage", "void", "do_sparc_fault", "(", "struct", "pt_regs", "*", "regs", ",", "int", "text_fault", ",", "int", "write", ",", "if", "(", "in_atomic", "(", ")", "|", "|", "!", "mm", ")", "goto", "no_context", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "regs", ",", "address", ")", ";", "down_read", "(", "&", "mm", "-", ">", "mmap_sem", ")", ";", "@", "@", "-", "301", ",", "12", "+", "301", ",", "10", "@", "@", "asmlinkage", "void", "do_sparc_fault", "(", "struct", "pt_regs", "*", "regs", ",", "int", "text_fault", ",", "int", "write", ",", "}", "if", "(", "fault", "&", "VM_FAULT_MAJOR", ")", "{", "current", "-", ">", "maj_flt", "+", "+;", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "regs", ",", "address", ")", ";", "}", "else", "{", "current", "-", ">", "min_flt", "+", "+;", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "regs", ",", "address", ")", ";", "}", "up_read", "(", "&", "mm", "-", ">", "mmap_sem", ")", ";", "return", ";", "@", "@", "-", "325", ",", "7", "+", "325", ",", "7", "@", "@", "asmlinkage", "void", "__kprobes", "do_sparc64_fault", "(", "struct", "pt_regs", "*", "regs", ")", "if", "(", "in_atomic", "(", ")", "|", "|", "!", "mm", ")", "goto", "intr_or_no_mm", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "regs", ",", "address", ")", ";", "if", "(", "!", "down_read_trylock", "(", "&", "mm", "-", ">", "mmap_sem", ")", ")", "{", "if", "(", "(", "regs", "-", ">", "tstate", "&", "TSTATE_PRIV", ")", "&", "&", "@", "@", "-", "433", ",", "12", "+", "433", ",", "10", "@", "@", "asmlinkage", "void", "__kprobes", "do_sparc64_fault", "(", "struct", "pt_regs", "*", "regs", ")", "}", "if", "(", "fault", "&", "VM_FAULT_MAJOR", ")", "{", "current", "-", ">", "maj_flt", "+", "+;", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "regs", ",", "address", ")", ";", "}", "else", "{", "current", "-", ">", "min_flt", "+", "+;", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "regs", ",", "address", ")", ";", "}", "up_read", "(", "&", "mm", "-", ">", "mmap_sem", ")", ";", "@", "@", "-", "1339", ",", "7", "+", "1339", ",", "7", "@", "@", "static", "int", "x86_pmu_handle_irq", "(", "struct", "pt_regs", "*", "regs", ")", "if", "(", "!", "x86_perf_event_set_period", "(", "event", ")", ")", "continue", ";", "if", "(", "perf_event_overflow", "(", "event", ",", "1", ",", "&", "data", ",", "regs", ")", ")", "if", "(", "perf_event_overflow", "(", "event", ",", "&", "data", ",", "regs", ")", ")", "x86_pmu_stop", "(", "event", ",", "0", ")", ";", "}", "@", "@", "-", "1003", ",", "7", "+", "1003", ",", "7", "@", "@", "static", "int", "intel_pmu_handle_irq", "(", "struct", "pt_regs", "*", "regs", ")", "data", ".", "period", "=", "event", "-", ">", "hw", ".", "last_period", ";", "if", "(", "perf_event_overflow", "(", "event", ",", "1", ",", "&", "data", ",", "regs", ")", ")", "if", "(", "perf_event_overflow", "(", "event", ",", "&", "data", ",", "regs", ")", ")", "x86_pmu_stop", "(", "event", ",", "0", ")", ";", "}", "@", "@", "-", "340", ",", "7", "+", "340", ",", "7", "@", "@", "static", "int", "intel_pmu_drain_bts_buffer", "(", "void", ")", "*", "/", "perf_prepare_sample", "(", "&", "header", ",", "&", "data", ",", "event", ",", "&", "regs", ")", ";", "if", "(", "perf_output_begin", "(", "&", "handle", ",", "event", ",", "header", ".", "size", "*", "(", "top", "-", "at", ")", ",", "1", ",", "1", ")", ")", "if", "(", "perf_output_begin", "(", "&", "handle", ",", "event", ",", "header", ".", "size", "*", "(", "top", "-", "at", ")", ",", "1", ")", ")", "return", "1", ";", "for", "(", ";", "at", "<", "top", ";", "at", "+", "+)", "{", "@", "@", "-", "616", ",", "7", "+", "616", ",", "7", "@", "@", "static", "void", "__intel_pmu_pebs_event", "(", "struct", "perf_event", "*", "event", ",", "else", "regs", ".", "flags", "&", "=", "~", "PERF_EFLAGS_EXACT", ";", "if", "(", "perf_event_overflow", "(", "event", ",", "1", ",", "&", "data", ",", "&", "regs", ")", ")", "if", "(", "perf_event_overflow", "(", "event", ",", "&", "data", ",", "&", "regs", ")", ")", "x86_pmu_stop", "(", "event", ",", "0", ")", ";", "}", "@", "@", "-", "970", ",", "7", "+", "970", ",", "7", "@", "@", "static", "int", "p4_pmu_handle_irq", "(", "struct", "pt_regs", "*", "regs", ")", "if", "(", "!", "x86_perf_event_set_period", "(", "event", ")", ")", "continue", ";", "if", "(", "perf_event_overflow", "(", "event", ",", "1", ",", "&", "data", ",", "regs", ")", ")", "if", "(", "perf_event_overflow", "(", "event", ",", "&", "data", ",", "regs", ")", ")", "x86_pmu_stop", "(", "event", ",", "0", ")", ";", "}", "@", "@", "-", "608", ",", "7", "+", "608", ",", "7", "@", "@", "int", "kgdb_arch_init", "(", "void", ")", "return", "register_die_notifier", "(", "&", "kgdb_notifier", ")", ";", "}", "static", "void", "kgdb_hw_overflow_handler", "(", "struct", "perf_event", "*", "event", ",", "int", "nmi", ",", "static", "void", "kgdb_hw_overflow_handler", "(", "struct", "perf_event", "*", "event", ",", "struct", "perf_sample_data", "*", "data", ",", "struct", "pt_regs", "*", "regs", ")", "{", "struct", "task_struct", "*", "tsk", "=", "current", ";", "@", "@", "-", "528", ",", "7", "+", "528", ",", "7", "@", "@", "static", "int", "genregs_set", "(", "struct", "task_struct", "*", "target", ",", "return", "ret", ";", "}", "static", "void", "ptrace_triggered", "(", "struct", "perf_event", "*", "bp", ",", "int", "nmi", ",", "static", "void", "ptrace_triggered", "(", "struct", "perf_event", "*", "bp", ",", "struct", "perf_sample_data", "*", "data", ",", "struct", "pt_regs", "*", "regs", ")", "{", "@", "@", "-", "1059", ",", "7", "+", "1059", ",", "7", "@", "@", "do_page_fault", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "long", "error_code", ")", "if", "(", "unlikely", "(", "error_code", "&", "PF_RSVD", ")", ")", "pgtable_bad", "(", "regs", ",", "error_code", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "0", ",", "regs", ",", "address", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS", ",", "1", ",", "regs", ",", "address", ")", ";", "/", "*", "*", "If", "we", "'", "re", "in", "an", "interrupt", ",", "have", "no", "user", "context", "or", "are", "running", "@", "@", "-", "1161", ",", "11", "+", "1161", ",", "11", "@", "@", "do_page_fault", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "long", "error_code", ")", "if", "(", "flags", "&", "FAULT_FLAG_ALLOW_RETRY", ")", "{", "if", "(", "fault", "&", "VM_FAULT_MAJOR", ")", "{", "tsk", "-", ">", "maj_flt", "+", "+;", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "0", ",", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MAJ", ",", "1", ",", "regs", ",", "address", ")", ";", "}", "else", "{", "tsk", "-", ">", "min_flt", "+", "+;", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "0", ",", "perf_sw_event", "(", "PERF_COUNT_SW_PAGE_FAULTS_MIN", ",", "1", ",", "regs", ",", "address", ")", ";", "}", "if", "(", "fault", "&", "VM_FAULT_RETRY", ")", "{", "@", "@", "-", "682", ",", "7", "+", "682", ",", "7", "@", "@", "enum", "perf_event_active_state", "{", "struct", "file", ";", "struct", "perf_sample_data", ";", "typedef", "void", "(", "*", "perf_overflow_handler_t", ")", "(", "struct", "perf_event", "*", ",", "int", ",", "typedef", "void", "(", "*", "perf_overflow_handler_t", ")", "(", "struct", "perf_event", "*", ",", "struct", "perf_sample_data", "*", ",", "struct", "pt_regs", "*", "regs", ")", ";", "@", "@", "-", "925", ",", "7", "+", "925", ",", "6", "@", "@", "struct", "perf_output_handle", "{", "unsigned", "long", "size", ";", "void", "*", "addr", ";", "int", "page", ";", "int", "nmi", ";", "int", "sample", ";", "}", ";", "@", "@", "-", "993", ",", "7", "+", "992", ",", "7", "@", "@", "extern", "void", "perf_prepare_sample", "(", "struct", "perf_event_header", "*", "header", ",", "struct", "perf_event", "*", "event", ",", "struct", "pt_regs", "*", "regs", ")", ";", "extern", "int", "perf_event_overflow", "(", "struct", "perf_event", "*", "event", ",", "int", "nmi", ",", "extern", "int", "perf_event_overflow", "(", "struct", "perf_event", "*", "event", ",", "struct", "perf_sample_data", "*", "data", ",", "struct", "pt_regs", "*", "regs", ")", ";", "@", "@", "-", "1012", ",", "7", "+", "1011", ",", "7", "@", "@", "static", "inline", "int", "is_software_event", "(", "struct", "perf_event", "*", "event", ")", "extern", "struct", "jump_label_key", "perf_swevent_enabled", "[", "PERF_COUNT_SW_MAX", "]", ";", "extern", "void", "__perf_sw_event", "(", "u32", ",", "u64", ",", "int", ",", "struct", "pt_regs", "*", ",", "u64", ")", ";", "extern", "void", "__perf_sw_event", "(", "u32", ",", "u64", ",", "struct", "pt_regs", "*", ",", "u64", ")", ";", "#", "ifndef", "perf_arch_fetch_caller_regs", "static", "inline", "void", "perf_arch_fetch_caller_regs", "(", "struct", "pt_regs", "*", "regs", ",", "unsigned", "long", "ip", ")", "{", "}", "@", "@", "-", "1034", ",", "7", "+", "1033", ",", "7", "@", "@", "static", "inline", "void", "perf_fetch_caller_regs", "(", "struct", "pt_regs", "*", "regs", ")", "}", "static", "__always_inline", "void", "perf_sw_event", "(", "u32", "event_id", ",", "u64", "nr", ",", "int", "nmi", ",", "struct", "pt_regs", "*", "regs", ",", "u64", "addr", ")", "perf_sw_event", "(", "u32", "event_id", ",", "u64", "nr", ",", "struct", "pt_regs", "*", "regs", ",", "u64", "addr", ")", "{", "struct", "pt_regs", "hot_regs", ";", "@", "@", "-", "1043", ",", "7", "+", "1042", ",", "7", "@", "@", "perf_sw_event", "(", "u32", "event_id", ",", "u64", "nr", ",", "int", "nmi", ",", "struct", "pt_regs", "*", "regs", ",", "u64", "addr", ")", "perf_fetch_caller_regs", "(", "&", "hot_regs", ")", ";", "regs", "=", "&", "hot_regs", ";", "}", "__perf_sw_event", "(", "event_id", ",", "nr", ",", "nmi", ",", "regs", ",", "addr", ")", ";", "__perf_sw_event", "(", "event_id", ",", "nr", ",", "regs", ",", "addr", ")", ";", "}", "}", "@", "@", "-", "1057", ",", "7", "+", "1056", ",", "7", "@", "@", "static", "inline", "void", "perf_event_task_sched_in", "(", "struct", "task_struct", "*", "task", ")", "static", "inline", "void", "perf_event_task_sched_out", "(", "struct", "task_struct", "*", "task", ",", "struct", "task_struct", "*", "next", ")", "{", "perf_sw_event", "(", "PERF_COUNT_SW_CONTEXT_SWITCHES", ",", "1", ",", "1", ",", "NULL", ",", "0", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_CONTEXT_SWITCHES", ",", "1", ",", "NULL", ",", "0", ")", ";", "__perf_event_task_sched_out", "(", "task", ",", "next", ")", ";", "}", "@", "@", "-", "1119", ",", "7", "+", "1118", ",", "7", "@", "@", "extern", "void", "perf_bp_event", "(", "struct", "perf_event", "*", "event", ",", "void", "*", "data", ")", ";", "extern", "int", "perf_output_begin", "(", "struct", "perf_output_handle", "*", "handle", ",", "struct", "perf_event", "*", "event", ",", "unsigned", "int", "size", ",", "int", "nmi", ",", "int", "sample", ")", ";", "int", "sample", ")", ";", "extern", "void", "perf_output_end", "(", "struct", "perf_output_handle", "*", "handle", ")", ";", "extern", "void", "perf_output_copy", "(", "struct", "perf_output_handle", "*", "handle", ",", "const", "void", "*", "buf", ",", "unsigned", "int", "len", ")", ";", "@", "@", "-", "1143", ",", "8", "+", "1142", ",", "7", "@", "@", "static", "inline", "int", "perf_event_task_disable", "(", "void", ")", "{", "return", "-", "EINVAL", ";", "}", "static", "inline", "int", "perf_event_task_enable", "(", "void", ")", "{", "return", "-", "EINVAL", ";", "}", "static", "inline", "void", "perf_sw_event", "(", "u32", "event_id", ",", "u64", "nr", ",", "int", "nmi", ",", "struct", "pt_regs", "*", "regs", ",", "u64", "addr", ")", "{", "}", "perf_sw_event", "(", "u32", "event_id", ",", "u64", "nr", ",", "struct", "pt_regs", "*", "regs", ",", "u64", "addr", ")", "{", "}", "static", "inline", "void", "perf_bp_event", "(", "struct", "perf_event", "*", "event", ",", "void", "*", "data", ")", "{", "}", "@", "@", "-", "3972", ",", "7", "+", "3972", ",", "7", "@", "@", "void", "perf_prepare_sample", "(", "struct", "perf_event_header", "*", "header", ",", "}", "}", "static", "void", "perf_event_output", "(", "struct", "perf_event", "*", "event", ",", "int", "nmi", ",", "static", "void", "perf_event_output", "(", "struct", "perf_event", "*", "event", ",", "struct", "perf_sample_data", "*", "data", ",", "struct", "pt_regs", "*", "regs", ")", "{", "@", "@", "-", "3984", ",", "7", "+", "3984", ",", "7", "@", "@", "static", "void", "perf_event_output", "(", "struct", "perf_event", "*", "event", ",", "int", "nmi", ",", "perf_prepare_sample", "(", "&", "header", ",", "data", ",", "event", ",", "regs", ")", ";", "if", "(", "perf_output_begin", "(", "&", "handle", ",", "event", ",", "header", ".", "size", ",", "nmi", ",", "1", ")", ")", "if", "(", "perf_output_begin", "(", "&", "handle", ",", "event", ",", "header", ".", "size", ",", "1", ")", ")", "goto", "exit", ";", "perf_output_sample", "(", "&", "handle", ",", "&", "header", ",", "data", ",", "event", ")", ";", "@", "@", "-", "4024", ",", "7", "+", "4024", ",", "7", "@", "@", "perf_event_read_event", "(", "struct", "perf_event", "*", "event", ",", "int", "ret", ";", "perf_event_header__init_id", "(", "&", "read_event", ".", "header", ",", "&", "sample", ",", "event", ")", ";", "ret", "=", "perf_output_begin", "(", "&", "handle", ",", "event", ",", "read_event", ".", "header", ".", "size", ",", "0", ",", "0", ")", ";", "ret", "=", "perf_output_begin", "(", "&", "handle", ",", "event", ",", "read_event", ".", "header", ".", "size", ",", "0", ")", ";", "if", "(", "ret", ")", "return", ";", "@", "@", "-", "4067", ",", "7", "+", "4067", ",", "7", "@", "@", "static", "void", "perf_event_task_output", "(", "struct", "perf_event", "*", "event", ",", "perf_event_header__init_id", "(", "&", "task_event", "-", ">", "event_id", ".", "header", ",", "&", "sample", ",", "event", ")", ";", "ret", "=", "perf_output_begin", "(", "&", "handle", ",", "event", ",", "task_event", "-", ">", "event_id", ".", "header", ".", "size", ",", "0", ",", "0", ")", ";", "task_event", "-", ">", "event_id", ".", "header", ".", "size", ",", "0", ")", ";", "if", "(", "ret", ")", "goto", "out", ";", "@", "@", "-", "4204", ",", "7", "+", "4204", ",", "7", "@", "@", "static", "void", "perf_event_comm_output", "(", "struct", "perf_event", "*", "event", ",", "perf_event_header__init_id", "(", "&", "comm_event", "-", ">", "event_id", ".", "header", ",", "&", "sample", ",", "event", ")", ";", "ret", "=", "perf_output_begin", "(", "&", "handle", ",", "event", ",", "comm_event", "-", ">", "event_id", ".", "header", ".", "size", ",", "0", ",", "0", ")", ";", "comm_event", "-", ">", "event_id", ".", "header", ".", "size", ",", "0", ")", ";", "if", "(", "ret", ")", "goto", "out", ";", "@", "@", "-", "4351", ",", "7", "+", "4351", ",", "7", "@", "@", "static", "void", "perf_event_mmap_output", "(", "struct", "perf_event", "*", "event", ",", "perf_event_header__init_id", "(", "&", "mmap_event", "-", ">", "event_id", ".", "header", ",", "&", "sample", ",", "event", ")", ";", "ret", "=", "perf_output_begin", "(", "&", "handle", ",", "event", ",", "mmap_event", "-", ">", "event_id", ".", "header", ".", "size", ",", "0", ",", "0", ")", ";", "mmap_event", "-", ">", "event_id", ".", "header", ".", "size", ",", "0", ")", ";", "if", "(", "ret", ")", "goto", "out", ";", "@", "@", "-", "4546", ",", "7", "+", "4546", ",", "7", "@", "@", "static", "void", "perf_log_throttle", "(", "struct", "perf_event", "*", "event", ",", "int", "enable", ")", "perf_event_header__init_id", "(", "&", "throttle_event", ".", "header", ",", "&", "sample", ",", "event", ")", ";", "ret", "=", "perf_output_begin", "(", "&", "handle", ",", "event", ",", "throttle_event", ".", "header", ".", "size", ",", "1", ",", "0", ")", ";", "throttle_event", ".", "header", ".", "size", ",", "0", ")", ";", "if", "(", "ret", ")", "return", ";", "@", "@", "-", "4559", ",", "7", "+", "4559", ",", "7", "@", "@", "static", "void", "perf_log_throttle", "(", "struct", "perf_event", "*", "event", ",", "int", "enable", ")", "*", "Generic", "event", "overflow", "handling", ",", "sampling", ".", "*", "/", "static", "int", "__perf_event_overflow", "(", "struct", "perf_event", "*", "event", ",", "int", "nmi", ",", "static", "int", "__perf_event_overflow", "(", "struct", "perf_event", "*", "event", ",", "int", "throttle", ",", "struct", "perf_sample_data", "*", "data", ",", "struct", "pt_regs", "*", "regs", ")", "{", "@", "@", "-", "4602", ",", "34", "+", "4602", ",", "28", "@", "@", "static", "int", "__perf_event_overflow", "(", "struct", "perf_event", "*", "event", ",", "int", "nmi", ",", "if", "(", "events", "&", "&", "atomic_dec_and_test", "(", "&", "event", "-", ">", "event_limit", ")", ")", "{", "ret", "=", "1", ";", "event", "-", ">", "pending_kill", "=", "POLL_HUP", ";", "if", "(", "nmi", ")", "{", "event", "-", ">", "pending_disable", "=", "1", ";", "irq_work_queue", "(", "&", "event", "-", ">", "pending", ")", ";", "}", "else", "perf_event_disable", "(", "event", ")", ";", "event", "-", ">", "pending_disable", "=", "1", ";", "irq_work_queue", "(", "&", "event", "-", ">", "pending", ")", ";", "}", "if", "(", "event", "-", ">", "overflow_handler", ")", "event", "-", ">", "overflow_handler", "(", "event", ",", "nmi", ",", "data", ",", "regs", ")", ";", "event", "-", ">", "overflow_handler", "(", "event", ",", "data", ",", "regs", ")", ";", "else", "perf_event_output", "(", "event", ",", "nmi", ",", "data", ",", "regs", ")", ";", "perf_event_output", "(", "event", ",", "data", ",", "regs", ")", ";", "if", "(", "event", "-", ">", "fasync", "&", "&", "event", "-", ">", "pending_kill", ")", "{", "if", "(", "nmi", ")", "{", "event", "-", ">", "pending_wakeup", "=", "1", ";", "irq_work_queue", "(", "&", "event", "-", ">", "pending", ")", ";", "}", "else", "perf_event_wakeup", "(", "event", ")", ";", "event", "-", ">", "pending_wakeup", "=", "1", ";", "irq_work_queue", "(", "&", "event", "-", ">", "pending", ")", ";", "}", "return", "ret", ";", "}", "int", "perf_event_overflow", "(", "struct", "perf_event", "*", "event", ",", "int", "nmi", ",", "int", "perf_event_overflow", "(", "struct", "perf_event", "*", "event", ",", "struct", "perf_sample_data", "*", "data", ",", "struct", "pt_regs", "*", "regs", ")", "{", "return", "__perf_event_overflow", "(", "event", ",", "nmi", ",", "1", ",", "data", ",", "regs", ")", ";", "return", "__perf_event_overflow", "(", "event", ",", "1", ",", "data", ",", "regs", ")", ";", "}", "/", "*", "@", "@", "-", "4678", ",", "7", "+", "4672", ",", "7", "@", "@", "static", "u64", "perf_swevent_set_period", "(", "struct", "perf_event", "*", "event", ")", "}", "static", "void", "perf_swevent_overflow", "(", "struct", "perf_event", "*", "event", ",", "u64", "overflow", ",", "int", "nmi", ",", "struct", "perf_sample_data", "*", "data", ",", "struct", "perf_sample_data", "*", "data", ",", "struct", "pt_regs", "*", "regs", ")", "{", "struct", "hw_perf_event", "*", "hwc", "=", "&", "event", "-", ">", "hw", ";", "@", "@", "-", "4692", ",", "7", "+", "4686", ",", "7", "@", "@", "static", "void", "perf_swevent_overflow", "(", "struct", "perf_event", "*", "event", ",", "u64", "overflow", ",", "return", ";", "for", "(", ";", "overflow", ";", "overflow", "-", "-)", "{", "if", "(", "__perf_event_overflow", "(", "event", ",", "nmi", ",", "throttle", ",", "if", "(", "__perf_event_overflow", "(", "event", ",", "throttle", ",", "data", ",", "regs", ")", ")", "{", "/", "*", "*", "We", "inhibit", "the", "overflow", "from", "happening", "when", "@", "@", "-", "4705", ",", "7", "+", "4699", ",", "7", "@", "@", "static", "void", "perf_swevent_overflow", "(", "struct", "perf_event", "*", "event", ",", "u64", "overflow", ",", "}", "static", "void", "perf_swevent_event", "(", "struct", "perf_event", "*", "event", ",", "u64", "nr", ",", "int", "nmi", ",", "struct", "perf_sample_data", "*", "data", ",", "struct", "perf_sample_data", "*", "data", ",", "struct", "pt_regs", "*", "regs", ")", "{", "struct", "hw_perf_event", "*", "hwc", "=", "&", "event", "-", ">", "hw", ";", "@", "@", "-", "4719", ",", "12", "+", "4713", ",", "12", "@", "@", "static", "void", "perf_swevent_event", "(", "struct", "perf_event", "*", "event", ",", "u64", "nr", ",", "return", ";", "if", "(", "nr", "=", "=", "1", "&", "&", "hwc", "-", ">", "sample_period", "=", "=", "1", "&", "&", "!", "event", "-", ">", "attr", ".", "freq", ")", "return", "perf_swevent_overflow", "(", "event", ",", "1", ",", "nmi", ",", "data", ",", "regs", ")", ";", "return", "perf_swevent_overflow", "(", "event", ",", "1", ",", "data", ",", "regs", ")", ";", "if", "(", "local64_add_negative", "(", "nr", ",", "&", "hwc", "-", ">", "period_left", ")", ")", "return", ";", "perf_swevent_overflow", "(", "event", ",", "0", ",", "nmi", ",", "data", ",", "regs", ")", ";", "perf_swevent_overflow", "(", "event", ",", "0", ",", "data", ",", "regs", ")", ";", "}", "static", "int", "perf_exclude_event", "(", "struct", "perf_event", "*", "event", ",", "@", "@", "-", "4812", ",", "7", "+", "4806", ",", "7", "@", "@", "find_swevent_head", "(", "struct", "swevent_htable", "*", "swhash", ",", "struct", "perf_event", "*", "event", ")", "}", "static", "void", "do_perf_sw_event", "(", "enum", "perf_type_id", "type", ",", "u32", "event_id", ",", "u64", "nr", ",", "int", "nmi", ",", "u64", "nr", ",", "struct", "perf_sample_data", "*", "data", ",", "struct", "pt_regs", "*", "regs", ")", "{", "@", "@", "-", "4828", ",", "7", "+", "4822", ",", "7", "@", "@", "static", "void", "do_perf_sw_event", "(", "enum", "perf_type_id", "type", ",", "u32", "event_id", ",", "hlist_for_each_entry_rcu", "(", "event", ",", "node", ",", "head", ",", "hlist_entry", ")", "{", "if", "(", "perf_swevent_match", "(", "event", ",", "type", ",", "event_id", ",", "data", ",", "regs", ")", ")", "perf_swevent_event", "(", "event", ",", "nr", ",", "nmi", ",", "data", ",", "regs", ")", ";", "perf_swevent_event", "(", "event", ",", "nr", ",", "data", ",", "regs", ")", ";", "}", "end", ":", "rcu_read_unlock", "(", ");", "@", "@", "-", "4849", ",", "8", "+", "4843", ",", "7", "@", "@", "inline", "void", "perf_swevent_put_recursion_context", "(", "int", "rctx", ")", "put_recursion_context", "(", "swhash", "-", ">", "recursion", ",", "rctx", ")", ";", "}", "void", "__perf_sw_event", "(", "u32", "event_id", ",", "u64", "nr", ",", "int", "nmi", ",", "struct", "pt_regs", "*", "regs", ",", "u64", "addr", ")", "void", "__perf_sw_event", "(", "u32", "event_id", ",", "u64", "nr", ",", "struct", "pt_regs", "*", "regs", ",", "u64", "addr", ")", "{", "struct", "perf_sample_data", "data", ";", "int", "rctx", ";", "@", "@", "-", "4862", ",", "7", "+", "4855", ",", "7", "@", "@", "void", "__perf_sw_event", "(", "u32", "event_id", ",", "u64", "nr", ",", "int", "nmi", ",", "perf_sample_data_init", "(", "&", "data", ",", "addr", ")", ";", "do_perf_sw_event", "(", "PERF_TYPE_SOFTWARE", ",", "event_id", ",", "nr", ",", "nmi", ",", "&", "data", ",", "regs", ")", ";", "do_perf_sw_event", "(", "PERF_TYPE_SOFTWARE", ",", "event_id", ",", "nr", ",", "&", "data", ",", "regs", ")", ";", "perf_swevent_put_recursion_context", "(", "rctx", ")", ";", "preempt_enable_notrace", "(", ");", "@", "@", "-", "5110", ",", "7", "+", "5103", ",", "7", "@", "@", "void", "perf_tp_event", "(", "u64", "addr", ",", "u64", "count", ",", "void", "*", "record", ",", "int", "entry_size", ",", "hlist_for_each_entry_rcu", "(", "event", ",", "node", ",", "head", ",", "hlist_entry", ")", "{", "if", "(", "perf_tp_event_match", "(", "event", ",", "&", "data", ",", "regs", ")", ")", "perf_swevent_event", "(", "event", ",", "count", ",", "1", ",", "&", "data", ",", "regs", ")", ";", "perf_swevent_event", "(", "event", ",", "count", ",", "&", "data", ",", "regs", ")", ";", "}", "perf_swevent_put_recursion_context", "(", "rctx", ")", ";", "@", "@", "-", "5203", ",", "7", "+", "5196", ",", "7", "@", "@", "void", "perf_bp_event", "(", "struct", "perf_event", "*", "bp", ",", "void", "*", "data", ")", "perf_sample_data_init", "(", "&", "sample", ",", "bp", "-", ">", "attr", ".", "bp_addr", ")", ";", "if", "(", "!", "bp", "-", ">", "hw", ".", "state", "&", "&", "!", "perf_exclude_event", "(", "bp", ",", "regs", ")", ")", "perf_swevent_event", "(", "bp", ",", "1", ",", "1", ",", "&", "sample", ",", "regs", ")", ";", "perf_swevent_event", "(", "bp", ",", "1", ",", "&", "sample", ",", "regs", ")", ";", "}", "#", "endif", "@", "@", "-", "5232", ",", "7", "+", "5225", ",", "7", "@", "@", "static", "enum", "hrtimer_restart", "perf_swevent_hrtimer", "(", "struct", "hrtimer", "*", "hrtimer", ")", "if", "(", "regs", "&", "&", "!", "perf_exclude_event", "(", "event", ",", "regs", ")", ")", "{", "if", "(", "!(", "event", "-", ">", "attr", ".", "exclude_idle", "&", "&", "current", "-", ">", "pid", "=", "=", "0", ")", ")", "if", "(", "perf_event_overflow", "(", "event", ",", "0", ",", "&", "data", ",", "regs", ")", ")", "if", "(", "perf_event_overflow", "(", "event", ",", "&", "data", ",", "regs", ")", ")", "ret", "=", "HRTIMER_NORESTART", ";", "}", "@", "@", "-", "27", ",", "7", "+", "27", ",", "6", "@", "@", "struct", "ring_buffer", "{", "void", "*", "data_pages", "[", "0", "]", ";", "}", ";", "extern", "void", "rb_free", "(", "struct", "ring_buffer", "*", "rb", ")", ";", "extern", "struct", "ring_buffer", "*", "rb_alloc", "(", "int", "nr_pages", ",", "long", "watermark", ",", "int", "cpu", ",", "int", "flags", ")", ";", "@", "@", "-", "38", ",", "11", "+", "38", ",", "8", "@", "@", "static", "void", "perf_output_wakeup", "(", "struct", "perf_output_handle", "*", "handle", ")", "{", "atomic_set", "(", "&", "handle", "-", ">", "rb", "-", ">", "poll", ",", "POLL_IN", ")", ";", "if", "(", "handle", "-", ">", "nmi", ")", "{", "handle", "-", ">", "event", "-", ">", "pending_wakeup", "=", "1", ";", "irq_work_queue", "(", "&", "handle", "-", ">", "event", "-", ">", "pending", ")", ";", "}", "else", "perf_event_wakeup", "(", "handle", "-", ">", "event", ")", ";", "handle", "-", ">", "event", "-", ">", "pending_wakeup", "=", "1", ";", "irq_work_queue", "(", "&", "handle", "-", ">", "event", "-", ">", "pending", ")", ";", "}", "/", "*", "@", "@", "-", "102", ",", "7", "+", "99", ",", "7", "@", "@", "static", "void", "perf_output_put_handle", "(", "struct", "perf_output_handle", "*", "handle", ")", "int", "perf_output_begin", "(", "struct", "perf_output_handle", "*", "handle", ",", "struct", "perf_event", "*", "event", ",", "unsigned", "int", "size", ",", "int", "nmi", ",", "int", "sample", ")", "int", "sample", ")", "{", "struct", "ring_buffer", "*", "rb", ";", "unsigned", "long", "tail", ",", "offset", ",", "head", ";", "@", "@", "-", "127", ",", "7", "+", "124", ",", "6", "@", "@", "int", "perf_output_begin", "(", "struct", "perf_output_handle", "*", "handle", ",", "handle", "-", ">", "rb", "=", "rb", ";", "handle", "-", ">", "event", "=", "event", ";", "handle", "-", ">", "nmi", "=", "nmi", ";", "handle", "-", ">", "sample", "=", "sample", ";", "if", "(", "!", "rb", "-", ">", "nr_pages", ")", "@", "@", "-", "2220", ",", "7", "+", "2220", ",", "7", "@", "@", "void", "set_task_cpu", "(", "struct", "task_struct", "*", "p", ",", "unsigned", "int", "new_cpu", ")", "if", "(", "task_cpu", "(", "p", ")", "!", "=", "new_cpu", ")", "{", "p", "-", ">", "se", ".", "nr_migrations", "+", "+;", "perf_sw_event", "(", "PERF_COUNT_SW_CPU_MIGRATIONS", ",", "1", ",", "1", ",", "NULL", ",", "0", ")", ";", "perf_sw_event", "(", "PERF_COUNT_SW_CPU_MIGRATIONS", ",", "1", ",", "NULL", ",", "0", ")", ";", "}", "__set_task_cpu", "(", "p", ",", "new_cpu", ")", ";", "@", "@", "-", "211", ",", "7", "+", "211", ",", "7", "@", "@", "static", "struct", "perf_event_attr", "wd_hw_attr", "=", "{", "}", ";", "/", "*", "Callback", "function", "for", "perf", "event", "subsystem", "*", "/", "static", "void", "watchdog_overflow_callback", "(", "struct", "perf_event", "*", "event", ",", "int", "nmi", ",", "static", "void", "watchdog_overflow_callback", "(", "struct", "perf_event", "*", "event", ",", "struct", "perf_sample_data", "*", "data", ",", "struct", "pt_regs", "*", "regs", ")", "{", "@", "@", "-", "41", ",", "7", "+", "41", ",", "7", "@", "@", "module_param_string", "(", "ksym", ",", "ksym_name", ",", "KSYM_NAME_LEN", ",", "S_IRUGO", ")", ";", "MODULE_PARM_DESC", "(", "ksym", ",", "\"", "Kernel", "symbol", "to", "monitor", ";", "this", "module", "will", "report", "any", "\"", "\"", "write", "operations", "on", "the", "kernel", "symbol", "\"", ");", "static", "void", "sample_hbp_handler", "(", "struct", "perf_event", "*", "bp", ",", "int", "nmi", ",", "static", "void", "sample_hbp_handler", "(", "struct", "perf_event", "*", "bp", ",", "struct", "perf_sample_data", "*", "data", ",", "struct", "pt_regs", "*", "regs", ")", "{"], "docstring_tokens": ["does", "not", "properly", "handle", "event", "overflows", "associated", "with", "PERF_COUNT_SW_CPU_CLOCK", "events"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1126", ",", "12", "+", "1126", ",", "10", "@", "@", "static", "int", "ipv6_create_tempaddr", "(", "struct", "inet6_ifaddr", "*", "ifp", ",", "struct", "inet6_ifaddr", "*", "i", "if", "(", "ifp", "-", ">", "flags", "&", "IFA_F_OPTIMISTIC", ")", "addr_flags", "|", "=", "IFA_F_OPTIMISTIC", ";", "ift", "=", "!", "max_addresses", "|", "|", "ipv6_count_addresses", "(", "idev", ")", "<", "max_addresses", "?", "ipv6_add_addr", "(", "idev", ",", "&", "addr", ",", "NULL", ",", "tmp_plen", ",", "ipv6_addr_scope", "(", "&", "addr", ")", ",", "addr_flags", ",", "tmp_valid_lft", ",", "tmp_prefered_lft", ")", ":", "NULL", ";", "if", "(", "IS_ERR_OR_NULL", "(", "ift", ")", ")", "{", "ift", "=", "ipv6_add_addr", "(", "idev", ",", "&", "addr", ",", "NULL", ",", "tmp_plen", ",", "ipv6_addr_scope", "(", "&", "addr", ")", ",", "addr_flags", ",", "tmp_valid_lft", ",", "tmp_prefered_lft", ")", ";", "if", "(", "IS_ERR", "(", "ift", ")", ")", "{", "in6_ifa_put", "(", "ifp", ")", ";", "in6_dev_put", "(", "idev", ")", ";", "pr_info", "(", "\"%", "s", ":", "retry", "temporary", "address", "regeneration", "\\", "n", "\"", ",", "__func__", ")", ";"], "docstring_tokens": ["the", "improper", "handling", "of", "problems"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "283", ",", "7", "+", "283", ",", "14", "@", "@", "NOKPROBE_SYMBOL", "(", "do_async_page_fault", ")", ";", "static", "void", "__init", "paravirt_ops_setup", "(", "void", ")", "{", "pv_info", ".", "name", "=", "\"", "KVM", "\"", ";", "pv_info", ".", "paravirt_enabled", "=", "1", ";", "/", "*", "*", "KVM", "isn", "'", "t", "paravirt", "in", "the", "sense", "of", "paravirt_enabled", ".", "A", "KVM", "*", "guest", "kernel", "works", "like", "a", "bare", "metal", "kernel", "with", "additional", "*", "features", ",", "and", "paravirt_enabled", "is", "about", "features", "that", "are", "*", "missing", ".", "*", "/", "pv_info", ".", "paravirt_enabled", "=", "0", ";", "if", "(", "kvm_para_has_feature", "(", "KVM_FEATURE_NOP_IO_DELAY", ")", ")", "pv_cpu_ops", ".", "io_delay", "=", "kvm_io_delay", ";", "@", "@", "-", "261", ",", "7", "+", "261", ",", "6", "@", "@", "void", "__init", "kvmclock_init", "(", "void", ")", "#", "endif", "kvm_get_preset_lpj", "(", ");", "clocksource_register_hz", "(", "&", "kvm_clock", ",", "NSEC_PER_SEC", ")", ";", "pv_info", ".", "paravirt_enabled", "=", "1", ";", "pv_info", ".", "name", "=", "\"", "KVM", "\"", ";", "if", "(", "kvm_para_has_feature", "(", "KVM_FEATURE_CLOCKSOURCE_STABLE_BIT", ")", ")"], "docstring_tokens": ["uses", "an", "improper", "paravirt_enabled", "setting", "for", "KVM", "guest", "kernels"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "202", ",", "8", "+", "202", ",", "10", "@", "@", "xfs_attr_shortform_list", "(", "xfs_attr_list_context_t", "*", "context", ")", "sbp", "-", ">", "namelen", ",", "sbp", "-", ">", "valuelen", ",", "&", "sbp", "-", ">", "name", "[", "sbp", "-", ">", "namelen", "]", ");", "if", "(", "error", ")", "if", "(", "error", ")", "{", "kmem_free", "(", "sbuf", ")", ";", "return", "error", ";", "}", "if", "(", "context", "-", ">", "seen_enough", ")", "break", ";", "cursor", "-", ">", "offset", "+", "+;", "@", "@", "-", "454", ",", "14", "+", "456", ",", "13", "@", "@", "xfs_attr3_leaf_list_int", "(", "args", ".", "rmtblkcnt", "=", "xfs_attr3_rmt_blocks", "(", "args", ".", "dp", "-", ">", "i_mount", ",", "valuelen", ")", ";", "retval", "=", "xfs_attr_rmtval_get", "(", "&", "args", ")", ";", "if", "(", "retval", ")", "return", "retval", ";", "retval", "=", "context", "-", ">", "put_listent", "(", "context", ",", "entry", "-", ">", "flags", ",", "name_rmt", "-", ">", "name", ",", "(", "int", ")", "name_rmt", "-", ">", "namelen", ",", "valuelen", ",", "args", ".", "value", ")", ";", "if", "(", "!", "retval", ")", "retval", "=", "context", "-", ">", "put_listent", "(", "context", ",", "entry", "-", ">", "flags", ",", "name_rmt", "-", ">", "name", ",", "(", "int", ")", "name_rmt", "-", ">", "namelen", ",", "valuelen", ",", "args", ".", "value", ")", ";", "kmem_free", "(", "args", ".", "value", ")", ";", "}", "else", "{", "retval", "=", "context", "-", ">", "put_listent", "(", "context", ","], "docstring_tokens": ["error", "handling"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "340", ",", "8", "+", "340", ",", "7", "@", "@", "static", "void", "phar_do_403", "(", "char", "*", "entry", ",", "int", "entry_len", "TSRMLS_DC", ")", "/", "*", "{", "{{", "*", "/", "sapi_header_op", "(", "SAPI_HEADER_REPLACE", ",", "&", "ctr", "TSRMLS_CC", ")", ";", "sapi_send_headers", "(", "TSRMLS_C", ")", ";", "PHPWRITE", "(", "\"<", "html", ">", "\\", "n", "<", "head", ">", "\\", "n", "<", "title", ">", "Access", "Denied", "<", "/", "title", ">", "\\", "n", "<", "/", "head", ">", "\\", "n", "<", "body", ">", "\\", "n", "<", "h1", ">", "403", "-", "File", "\"", ",", "sizeof", "(", "\"<", "html", ">", "\\", "n", "<", "head", ">", "\\", "n", "<", "title", ">", "Access", "Denied", "<", "/", "title", ">", "\\", "n", "<", "/", "head", ">", "\\", "n", "<", "body", ">", "\\", "n", "<", "h1", ">", "403", "-", "File", "\"", ")", "-", "1", ")", ";", "PHPWRITE", "(", "entry", ",", "entry_len", ")", ";", "PHPWRITE", "(", "\"", "Access", "Denied", "<", "/", "h1", ">", "\\", "n", "<", "/", "body", ">", "\\", "n", "<", "/", "html", ">", "\",", "sizeof", "(", "\"", "Access", "Denied", "<", "/", "h1", ">", "\\", "n", "<", "/", "body", ">", "\\", "n", "<", "/", "html", ">", "\")", "-", "1", ")", ";", "PHPWRITE", "(", "\"", "Access", "Denied", "<", "/", "h1", ">", "\\", "n", "<", "/", "body", ">", "\\", "n", "<", "/", "html", ">", "\",", "sizeof", "(", "\"", "Access", "Denied", "<", "/", "h1", ">", "\\", "n", "<", "/", "body", ">", "\\", "n", "<", "/", "html", ">", "\")", "-", "1", ")", ";", "}", "/", "*", "}", "}}", "*", "/", "@", "@", "-", "365", ",", "8", "+", "364", ",", "7", "@", "@", "static", "void", "phar_do_404", "(", "phar_archive_data", "*", "phar", ",", "char", "*", "fname", ",", "int", "fname_len", ",", "cha", "sapi_header_op", "(", "SAPI_HEADER_REPLACE", ",", "&", "ctr", "TSRMLS_CC", ")", ";", "sapi_send_headers", "(", "TSRMLS_C", ")", ";", "PHPWRITE", "(", "\"<", "html", ">", "\\", "n", "<", "head", ">", "\\", "n", "<", "title", ">", "File", "Not", "Found", "<", "/", "title", ">", "\\", "n", "<", "/", "head", ">", "\\", "n", "<", "body", ">", "\\", "n", "<", "h1", ">", "404", "-", "File", "\"", ",", "sizeof", "(", "\"<", "html", ">", "\\", "n", "<", "head", ">", "\\", "n", "<", "title", ">", "File", "Not", "Found", "<", "/", "title", ">", "\\", "n", "<", "/", "head", ">", "\\", "n", "<", "body", ">", "\\", "n", "<", "h1", ">", "404", "-", "File", "\"", ")", "-", "1", ")", ";", "PHPWRITE", "(", "entry", ",", "entry_len", ")", ";", "PHPWRITE", "(", "\"", "Not", "Found", "<", "/", "h1", ">", "\\", "n", "<", "/", "body", ">", "\\", "n", "<", "/", "html", ">", "\",", "sizeof", "(", "\"", "Not", "Found", "<", "/", "h1", ">", "\\", "n", "<", "/", "body", ">", "\\", "n", "<", "/", "html", ">", "\")", "-", "1", ")", ";", "PHPWRITE", "(", "\"", "Not", "Found", "<", "/", "h1", ">", "\\", "n", "<", "/", "body", ">", "\\", "n", "<", "/", "html", ">", "\",", "sizeof", "(", "\"", "Not", "Found", "<", "/", "h1", ">", "\\", "n", "<", "/", "body", ">", "\\", "n", "<", "/", "html", ">", "\")", "-", "1", ")", ";", "}", "/", "*", "}", "}}", "*", "/", "@", "@", "-", "20", ",", "6", "+", "20", ",", "6", "@", "@", "Status", ":", "403", "Access", "Denied", "<", "title", ">", "Access", "Denied", "<", "/", "title", ">", "<", "/", "head", ">", "<", "body", ">", "<", "h1", ">", "403", "-", "File", "/", "hi", "Access", "Denied", "<", "/", "h1", ">", "<", "h1", ">", "403", "-", "File", "Access", "Denied", "<", "/", "h1", ">", "<", "/", "body", ">", "<", "/", "html", ">", "@", "@", "-", "18", ",", "6", "+", "18", ",", "6", "@", "@", "Status", ":", "404", "Not", "Found", "<", "title", ">", "File", "Not", "Found", "<", "/", "title", ">", "<", "/", "head", ">", "<", "body", ">", "<", "h1", ">", "404", "-", "File", "/", "notfound", ".", "php", "Not", "Found", "<", "/", "h1", ">", "<", "h1", ">", "404", "-", "File", "Not", "Found", "<", "/", "h1", ">", "<", "/", "body", ">", "<", "/", "html", ">", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "18", ",", "6", "+", "18", ",", "6", "@", "@", "Status", ":", "404", "Not", "Found", "<", "title", ">", "File", "Not", "Found", "<", "/", "title", ">", "<", "/", "head", ">", "<", "body", ">", "<", "h1", ">", "404", "-", "File", "/", "index", ".", "php", "Not", "Found", "<", "/", "h1", ">", "<", "h1", ">", "404", "-", "File", "Not", "Found", "<", "/", "h1", ">", "<", "/", "body", ">", "<", "/", "html", ">", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "19", ",", "6", "+", "19", ",", "6", "@", "@", "Status", ":", "403", "Access", "Denied", "<", "title", ">", "Access", "Denied", "<", "/", "title", ">", "<", "/", "head", ">", "<", "body", ">", "<", "h1", ">", "403", "-", "File", "/", "hi", "Access", "Denied", "<", "/", "h1", ">", "<", "h1", ">", "403", "-", "File", "Access", "Denied", "<", "/", "h1", ">", "<", "/", "body", ">", "<", "/", "html", ">", "@", "@", "-", "16", ",", "6", "+", "16", ",", "6", "@", "@", "Status", ":", "404", "Not", "Found", "<", "title", ">", "File", "Not", "Found", "<", "/", "title", ">", "<", "/", "head", ">", "<", "body", ">", "<", "h1", ">", "404", "-", "File", "/", "notfound", ".", "php", "Not", "Found", "<", "/", "h1", ">", "<", "h1", ">", "404", "-", "File", "Not", "Found", "<", "/", "h1", ">", "<", "/", "body", ">", "<", "/", "html", ">", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "16", ",", "6", "+", "16", ",", "6", "@", "@", "Status", ":", "404", "Not", "Found", "<", "title", ">", "File", "Not", "Found", "<", "/", "title", ">", "<", "/", "head", ">", "<", "body", ">", "<", "h1", ">", "404", "-", "File", "/", "index", ".", "php", "Not", "Found", "<", "/", "h1", ">", "<", "h1", ">", "404", "-", "File", "Not", "Found", "<", "/", "h1", ">", "<", "/", "body", ">", "<", "/", "html", ">", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "19", ",", "6", "+", "19", ",", "6", "@", "@", "Status", ":", "403", "Access", "Denied", "<", "title", ">", "Access", "Denied", "<", "/", "title", ">", "<", "/", "head", ">", "<", "body", ">", "<", "h1", ">", "403", "-", "File", "/", "hi", "Access", "Denied", "<", "/", "h1", ">", "<", "h1", ">", "403", "-", "File", "Access", "Denied", "<", "/", "h1", ">", "<", "/", "body", ">", "<", "/", "html", ">", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "16", ",", "6", "+", "16", ",", "6", "@", "@", "Status", ":", "404", "Not", "Found", "<", "title", ">", "File", "Not", "Found", "<", "/", "title", ">", "<", "/", "head", ">", "<", "body", ">", "<", "h1", ">", "404", "-", "File", "/", "notfound", ".", "php", "Not", "Found", "<", "/", "h1", ">", "<", "h1", ">", "404", "-", "File", "Not", "Found", "<", "/", "h1", ">", "<", "/", "body", ">", "<", "/", "html", ">", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "16", ",", "6", "+", "16", ",", "6", "@", "@", "Status", ":", "404", "Not", "Found", "<", "title", ">", "File", "Not", "Found", "<", "/", "title", ">", "<", "/", "head", ">", "<", "body", ">", "<", "h1", ">", "404", "-", "File", "/", "index", ".", "php", "Not", "Found", "<", "/", "h1", ">", "<", "h1", ">", "404", "-", "File", "Not", "Found", "<", "/", "h1", ">", "<", "/", "body", ">", "<", "/", "html", ">", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "19", ",", "6", "+", "19", ",", "6", "@", "@", "Status", ":", "403", "Access", "Denied", "<", "title", ">", "Access", "Denied", "<", "/", "title", ">", "<", "/", "head", ">", "<", "body", ">", "<", "h1", ">", "403", "-", "File", "/", "hi", "Access", "Denied", "<", "/", "h1", ">", "<", "h1", ">", "403", "-", "File", "Access", "Denied", "<", "/", "h1", ">", "<", "/", "body", ">", "<", "/", "html", ">", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "17", ",", "6", "+", "17", ",", "6", "@", "@", "Status", ":", "404", "Not", "Found", "<", "title", ">", "File", "Not", "Found", "<", "/", "title", ">", "<", "/", "head", ">", "<", "body", ">", "<", "h1", ">", "404", "-", "File", "/", "notfound", ".", "php", "Not", "Found", "<", "/", "h1", ">", "<", "h1", ">", "404", "-", "File", "Not", "Found", "<", "/", "h1", ">", "<", "/", "body", ">", "<", "/", "html", ">", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "16", ",", "6", "+", "16", ",", "6", "@", "@", "Status", ":", "404", "Not", "Found", "<", "title", ">", "File", "Not", "Found", "<", "/", "title", ">", "<", "/", "head", ">", "<", "body", ">", "<", "h1", ">", "404", "-", "File", "/", "index", ".", "php", "Not", "Found", "<", "/", "h1", ">", "<", "h1", ">", "404", "-", "File", "Not", "Found", "<", "/", "h1", ">", "<", "/", "body", ">", "<", "/", "html", ">", "\\", "No", "newline", "at", "end", "of", "file"], "docstring_tokens": ["improper", "validation", "of", "user-supplied", "input"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "149", ",", "13", "+", "149", ",", "6", "@", "@", "int", "ip6_frag_match", "(", "struct", "inet_frag_queue", "*", "q", ",", "void", "*", "a", ")", "}", "EXPORT_SYMBOL", "(", "ip6_frag_match", ")", ";", "/", "*", "Memory", "Tracking", "Functions", ".", "*", "/", "static", "void", "frag_kfree_skb", "(", "struct", "netns_frags", "*", "nf", ",", "struct", "sk_buff", "*", "skb", ")", "{", "atomic_sub", "(", "skb", "-", ">", "truesize", ",", "&", "nf", "-", ">", "mem", ")", ";", "kfree_skb", "(", "skb", ")", ";", "}", "void", "ip6_frag_init", "(", "struct", "inet_frag_queue", "*", "q", ",", "void", "*", "a", ")", "{", "struct", "frag_queue", "*", "fq", "=", "container_of", "(", "q", ",", "struct", "frag_queue", ",", "q", ")", ";", "@", "@", "-", "346", ",", "58", "+", "339", ",", "22", "@", "@", "static", "int", "ip6_frag_queue", "(", "struct", "frag_queue", "*", "fq", ",", "struct", "sk_buff", "*", "skb", ",", "}", "found", ":", "/", "*", "We", "found", "where", "to", "put", "this", "one", ".", "Check", "for", "overlap", "with", "*", "preceding", "fragment", ",", "and", ",", "if", "needed", ",", "align", "things", "so", "that", "*", "any", "overlaps", "are", "eliminated", ".", "/", "*", "RFC5722", ",", "Section", "4", ":", "*", "When", "reassembling", "an", "IPv6", "datagram", ",", "if", "*", "one", "or", "more", "its", "constituent", "fragments", "is", "determined", "to", "be", "an", "*", "overlapping", "fragment", ",", "the", "entire", "datagram", "(", "and", "any", "constituent", "*", "fragments", ",", "including", "those", "not", "yet", "received", ")", "MUST", "be", "silently", "*", "discarded", ".", "*", "/", "if", "(", "prev", ")", "{", "int", "i", "=", "(", "FRAG6_CB", "(", "prev", ")", "->", "offset", "+", "prev", "-", ">", "len", ")", "-", "offset", ";", "if", "(", "i", ">", "0", ")", "{", "offset", "+", "=", "i", ";", "if", "(", "end", "<", "=", "offset", ")", "goto", "err", ";", "if", "(", "!", "pskb_pull", "(", "skb", ",", "i", ")", ")", "goto", "err", ";", "if", "(", "skb", "-", ">", "ip_summed", "!", "=", "CHECKSUM_UNNECESSARY", ")", "skb", "-", ">", "ip_summed", "=", "CHECKSUM_NONE", ";", "}", "}", "/", "*", "Check", "for", "overlap", "with", "preceding", "fragment", ".", "*", "/", "if", "(", "prev", "&", "&", "(", "FRAG6_CB", "(", "prev", ")", "->", "offset", "+", "prev", "-", ">", "len", ")", "-", "offset", ">", "0", ")", "goto", "discard_fq", ";", "/", "*", "Look", "for", "overlap", "with", "succeeding", "segments", ".", "*", "If", "we", "can", "merge", "fragments", ",", "do", "it", ".", "*", "/", "while", "(", "next", "&", "&", "FRAG6_CB", "(", "next", ")", "->", "offset", "<", "end", ")", "{", "int", "i", "=", "end", "-", "FRAG6_CB", "(", "next", ")", "->", "offset", ";", "/", "*", "overlap", "is", "'", "i", "'", "bytes", "*", "/", "if", "(", "i", "<", "next", "-", ">", "len", ")", "{", "/", "*", "Eat", "head", "of", "the", "next", "overlapped", "fragment", "*", "and", "leave", "the", "loop", ".", "The", "next", "ones", "cannot", "overlap", ".", "*", "/", "if", "(", "!", "pskb_pull", "(", "next", ",", "i", ")", ")", "goto", "err", ";", "FRAG6_CB", "(", "next", ")", "->", "offset", "+", "=", "i", ";", "/", "*", "next", "fragment", "*", "/", "fq", "-", ">", "q", ".", "meat", "-", "=", "i", ";", "if", "(", "next", "-", ">", "ip_summed", "!", "=", "CHECKSUM_UNNECESSARY", ")", "next", "-", ">", "ip_summed", "=", "CHECKSUM_NONE", ";", "break", ";", "}", "else", "{", "struct", "sk_buff", "*", "free_it", "=", "next", ";", "/", "*", "Old", "fragment", "is", "completely", "overridden", "with", "*", "new", "one", "drop", "it", ".", "*", "/", "next", "=", "next", "-", ">", "next", ";", "if", "(", "prev", ")", "prev", "-", ">", "next", "=", "next", ";", "else", "fq", "-", ">", "q", ".", "fragments", "=", "next", ";", "fq", "-", ">", "q", ".", "meat", "-", "=", "free_it", "-", ">", "len", ";", "frag_kfree_skb", "(", "fq", "-", ">", "q", ".", "net", ",", "free_it", ")", ";", "}", "}", "/", "*", "Look", "for", "overlap", "with", "succeeding", "segment", ".", "*", "/", "if", "(", "next", "&", "&", "FRAG6_CB", "(", "next", ")", "->", "offset", "<", "end", ")", "goto", "discard_fq", ";", "FRAG6_CB", "(", "skb", ")", "->", "offset", "=", "offset", ";", "@", "@", "-", "436", ",", "6", "+", "393", ",", "8", "@", "@", "static", "int", "ip6_frag_queue", "(", "struct", "frag_queue", "*", "fq", ",", "struct", "sk_buff", "*", "skb", ",", "write_unlock", "(", "&", "ip6_frags", ".", "lock", ")", ";", "return", "-", "1", ";", "discard_fq", ":", "fq_kill", "(", "fq", ")", ";", "err", ":", "IP6_INC_STATS", "(", "net", ",", "ip6_dst_idev", "(", "skb_dst", "(", "skb", ")", "),", "IPSTATS_MIB_REASMFAILS", ")", ";"], "docstring_tokens": ["\"failure", "to", "implement", "RFC5722", "properly"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "30", ",", "6", "+", "30", ",", "7", "@", "@", "struct", "rock_state", "{", "int", "cont_size", ";", "int", "cont_extent", ";", "int", "cont_offset", ";", "int", "cont_loops", ";", "struct", "inode", "*", "inode", ";", "}", ";", "@", "@", "-", "73", ",", "6", "+", "74", ",", "9", "@", "@", "static", "void", "init_rock_state", "(", "struct", "rock_state", "*", "rs", ",", "struct", "inode", "*", "inode", ")", "rs", "-", ">", "inode", "=", "inode", ";", "}", "/", "*", "Maximum", "number", "of", "Rock", "Ridge", "continuation", "entries", "*", "/", "#", "define", "RR_MAX_CE_ENTRIES", "32", "/", "*", "*", "Returns", "0", "if", "the", "caller", "should", "continue", "scanning", ",", "1", "if", "the", "scan", "must", "end", "*", "and", "-", "ve", "on", "error", ".", "@", "@", "-", "105", ",", "6", "+", "109", ",", "8", "@", "@", "static", "int", "rock_continue", "(", "struct", "rock_state", "*", "rs", ")", "goto", "out", ";", "}", "ret", "=", "-", "EIO", ";", "if", "(", "++", "rs", "-", ">", "cont_loops", ">", "=", "RR_MAX_CE_ENTRIES", ")", "goto", "out", ";", "bh", "=", "sb_bread", "(", "rs", "-", ">", "inode", "-", ">", "i_sb", ",", "rs", "-", ">", "cont_extent", ")", ";", "if", "(", "bh", ")", "{", "memcpy", "(", "rs", "-", ">", "buffer", ",", "bh", "-", ">", "b_data", "+", "rs", "-", ">", "cont_offset", ","], "docstring_tokens": ["the", "failure", "to", "restrict", "the", "number", "of", "Rock", "Ridge", "continuation", "entries"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "45", ",", "22", "+", "45", ",", "20", "@", "@", "gdImagePtr", "gdImageCrop", "(", "gdImagePtr", "src", ",", "const", "gdRectPtr", "crop", ")", "gdImagePtr", "dst", ";", "int", "y", ";", "/", "*", "check", "size", "*", "/", "if", "(", "crop", "-", ">", "width", "<", "=", "0", "|", "|", "crop", "-", ">", "height", "<", "=", "0", ")", "{", "return", "NULL", ";", "}", "/", "*", "allocate", "the", "requested", "size", "(", "could", "be", "only", "partially", "filled", ")", "*", "/", "if", "(", "src", "-", ">", "trueColor", ")", "{", "dst", "=", "gdImageCreateTrueColor", "(", "crop", "-", ">", "width", ",", "crop", "-", ">", "height", ")", ";", "if", "(", "dst", "=", "=", "NULL", ")", "{", "return", "NULL", ";", "}", "gdImageSaveAlpha", "(", "dst", ",", "1", ")", ";", "}", "else", "{", "dst", "=", "gdImageCreate", "(", "crop", "-", ">", "width", ",", "crop", "-", ">", "height", ")", ";", "if", "(", "dst", "=", "=", "NULL", ")", "{", "return", "NULL", ";", "}", "gdImagePaletteCopy", "(", "dst", ",", "src", ")", ";", "}", "if", "(", "dst", "=", "=", "NULL", ")", "{", "return", "NULL", ";", "}", "dst", "-", ">", "transparent", "=", "src", "-", ">", "transparent", ";", "/", "*", "check", "position", "in", "the", "src", "image", "*", "/", "@", "@", "-", "24", ",", "6", "+", "24", ",", "8", "@", "@", "var_dump", "(", "imagecrop", "(", "$", "img", ",", "array", "(", "\"", "x", "\"", "=", ">", "-", "20", ",", "\"", "y", "\"", "=", ">", "-", "20", ",", "\"", "width", "\"", "=", ">", "10", ",", "\"", "height", "\"", "=", "/", "/", "POC", "#", "4", "var_dump", "(", "imagecrop", "(", "$", "img", ",", "array", "(", "\"", "x", "\"", "=", ">", "0x7fffff00", ",", "\"", "y", "\"", "=", ">", "0", ",", "\"", "width", "\"", "=", ">", "10", ",", "\"", "height", "\"", "=", ">", "10", ")", "))", ";", "/", "/", "bug", "66815", "var_dump", "(", "imagecrop", "(", "$", "img", ",", "array", "(", "\"", "x", "\"", "=", ">", "0", ",", "\"", "y", "\"", "=", ">", "0", ",", "\"", "width", "\"", "=", ">", "65535", ",", "\"", "height", "\"", "=", ">", "65535", ")", "))", ";", "?", ">", "-", "-", "EXPECTF", "resource", "(", "%", "d", ")", "of", "type", "(", "gd", ")", "@", "@", "-", "35", ",", "6", "+", "37", ",", "13", "@", "@", "Array", "[", "width", "]", "=", ">", "10", "[", "height", "]", "=", ">", "10", ")", "Warning", ":", "imagecrop", "(", "):", "gd", "warning", ":", "one", "parameter", "to", "a", "memory", "allocation", "multiplication", "is", "negative", "or", "zero", ",", "failing", "operation", "gracefully", "in", "%", "sbug66356", ".", "php", "on", "line", "%", "d", "bool", "(", "false", ")", "resource", "(", "%", "d", ")", "of", "type", "(", "gd", ")", "resource", "(", "%", "d", ")", "of", "type", "(", "gd", ")", "\\", "No", "newline", "at", "end", "of", "file", "resource", "(", "%", "d", ")", "of", "type", "(", "gd", ")", "Warning", ":", "imagecrop", "(", "):", "gd", "warning", ":", "product", "of", "memory", "allocation", "multiplication", "would", "exceed", "INT_MAX", ",", "failing", "operation", "gracefully", "in", "%", "sbug66356", ".", "php", "on", "line", "%", "d", "bool", "(", "false", ")", "\\", "No", "newline", "at", "end", "of", "file"], "docstring_tokens": ["the", "failure", "to", "check", "return", "values"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1", ",", "6", "+", "1", ",", "11", "@", "@", "package", "org", ".", "jenkinsci", ".", "plugins", ".", "fodupload", ";", "import", "com", ".", "cloudbees", ".", "plugins", ".", "credentials", ".", "CredentialsProvider", ";", "import", "hudson", ".", "Extension", ";", "import", "hudson", ".", "model", ".", "Item", ";", "import", "hudson", ".", "model", ".", "Job", ";", "import", "hudson", ".", "security", ".", "ACL", ";", "import", "hudson", ".", "security", ".", "Permission", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "hudson", ".", "util", ".", "ListBoxModel", ";", "import", "hudson", ".", "util", ".", "Secret", ";", "@", "@", "-", "13", ",", "6", "+", "18", ",", "7", "@", "@", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "fodupload", ".", "models", ".", "FodEnums", ".", "GrantType", ";", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "plaincredentials", ".", "StringCredentials", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "verb", ".", "POST", ";", "@", "Extension", "@", "@", "-", "189", ",", "27", "+", "195", ",", "32", "@", "@", "public", "FormValidation", "doTestPersonalAccessTokenConnection", "(", "@", "QueryParameter", "(", "USERNA", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "ListBoxModel", "doFillClientIdItems", "(", ")", "{", "return", "SharedUploadBuildStep", ".", "doFillStringCredentialsItems", "(", ");", "Jenkins", ".", "get", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "return", "doFillStringCredentialsItems", "(", ");", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "ListBoxModel", "doFillClientSecretItems", "(", ")", "{", "return", "SharedUploadBuildStep", ".", "doFillStringCredentialsItems", "(", ");", "Jenkins", ".", "get", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "return", "doFillStringCredentialsItems", "(", ");", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "ListBoxModel", "doFillUsernameItems", "(", ")", "{", "return", "SharedUploadBuildStep", ".", "doFillStringCredentialsItems", "(", ");", "Jenkins", ".", "get", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "return", "doFillStringCredentialsItems", "(", ");", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "ListBoxModel", "doFillPersonalAccessTokenItems", "(", ")", "{", "return", "SharedUploadBuildStep", ".", "doFillStringCredentialsItems", "(", ");", "Jenkins", ".", "get", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "return", "doFillStringCredentialsItems", "(", ");", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "ListBoxModel", "doFillTenantIdItems", "(", ")", "{", "return", "SharedUploadBuildStep", ".", "doFillStringCredentialsItems", "(", ");", "Jenkins", ".", "get", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "return", "doFillStringCredentialsItems", "(", ");", "}", "FodApiConnection", "createFodApiConnection", "(", ")", "{", "@", "@", "-", "262", ",", "6", "+", "273", ",", "17", "@", "@", "public", "FormValidation", "testConnection", "(", "FodApiConnection", "testApi", ")", "{", "FormValidation", ".", "ok", "(", "\"", "Successfully", "authenticated", "to", "Fortify", "on", "Demand", ".", "\")", ":", "FormValidation", ".", "error", "(", "\"", "Invalid", "connection", "information", ".", "Please", "check", "your", "credentials", "and", "try", "again", ".", "\")", ";", "}", "private", "ListBoxModel", "doFillStringCredentialsItems", "(", "){", "ListBoxModel", "items", "=", "CredentialsProvider", ".", "listCredentials", "(", "StringCredentials", ".", "class", ",", "Jenkins", ".", "get", "(", "),", "ACL", ".", "SYSTEM", ",", "null", ",", "null", ")", ";", "return", "items", ";", "}", "}", "@", "@", "-", "7", ",", "6", "+", "7", ",", "8", "@", "@", "import", "hudson", ".", "FilePath", ";", "import", "hudson", ".", "Launcher", ";", "import", "hudson", ".", "model", ".", "AbstractProject", ";", "import", "hudson", ".", "model", ".", "Item", ";", "import", "hudson", ".", "model", ".", "Job", ";", "import", "hudson", ".", "model", ".", "Result", ";", "import", "hudson", ".", "model", ".", "Run", ";", "import", "hudson", ".", "model", ".", "TaskListener", ";", "@", "@", "-", "35", ",", "6", "+", "37", ",", "7", "@", "@", "import", "org", ".", "kohsuke", ".", "stapler", ".", "verb", ".", "POST", ";", "import", "static", "org", ".", "jenkinsci", ".", "plugins", ".", "fodupload", ".", "SharedPollingBuildStep", ".", "*;", "import", "org", ".", "kohsuke", ".", "stapler", ".", "AncestorInPath", ";", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "class", "PollingBuildStep", "extends", "Recorder", "implements", "SimpleBuildStep", "{", "@", "@", "-", "160", ",", "9", "+", "163", ",", "10", "@", "@", "public", "FormValidation", "doCheckPollingInterval", "(", "@", "QueryParameter", "String", "pollingInter", "@", "POST", "public", "FormValidation", "doTestPersonalAccessTokenConnection", "(", "@", "QueryParameter", "(", "USERNAME", ")", "final", "String", "username", ",", "@", "QueryParameter", "(", "PERSONAL_ACCESS_TOKEN", ")", "final", "String", "personalAccessToken", ",", "@", "QueryParameter", "(", "TENANT_ID", ")", "final", "String", "tenantId", ")", "{", "Jenkins", ".", "get", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "return", "SharedPollingBuildStep", ".", "doTestPersonalAccessTokenConnection", "(", "username", ",", "personalAccessToken", ",", "tenantId", ")", ";", "@", "QueryParameter", "(", "TENANT_ID", ")", "final", "String", "tenantId", ",", "@", "AncestorInPath", "Job", "job", ")", "{", "job", ".", "checkPermission", "(", "Item", ".", "CONFIGURE", ")", ";", "return", "SharedPollingBuildStep", ".", "doTestPersonalAccessTokenConnection", "(", "username", ",", "personalAccessToken", ",", "tenantId", ",", "job", ")", ";", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "@", "@", "-", "171", ",", "18", "+", "175", ",", "18", "@", "@", "public", "ListBoxModel", "doFillPolicyFailureBuildResultPreferenceItems", "(", ")", "{", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "ListBoxModel", "doFillUsernameItems", "(", ")", "{", "return", "SharedPollingBuildStep", ".", "doFillStringCredentialsItems", "(", ");", "public", "ListBoxModel", "doFillUsernameItems", "(", "@", "AncestorInPath", "Job", "job", ")", "{", "return", "SharedPollingBuildStep", ".", "doFillStringCredentialsItems", "(", "job", ")", ";", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "ListBoxModel", "doFillPersonalAccessTokenItems", "(", ")", "{", "return", "SharedPollingBuildStep", ".", "doFillStringCredentialsItems", "(", ");", "public", "ListBoxModel", "doFillPersonalAccessTokenItems", "(", "@", "AncestorInPath", "Job", "job", ")", "{", "return", "SharedPollingBuildStep", ".", "doFillStringCredentialsItems", "(", "job", ")", ";", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "ListBoxModel", "doFillTenantIdItems", "(", ")", "{", "return", "SharedPollingBuildStep", ".", "doFillStringCredentialsItems", "(", ");", "public", "ListBoxModel", "doFillTenantIdItems", "(", "@", "AncestorInPath", "Job", "job", ")", "{", "return", "SharedPollingBuildStep", ".", "doFillStringCredentialsItems", "(", "job", ")", ";", "}", "}", "}", "@", "@", "-", "17", ",", "6", "+", "17", ",", "8", "@", "@", "import", "edu", ".", "umd", ".", "cs", ".", "findbugs", ".", "annotations", ".", "SuppressFBWarnings", ";", "import", "hudson", ".", "FilePath", ";", "import", "hudson", ".", "Launcher", ";", "import", "hudson", ".", "model", ".", "Item", ";", "import", "hudson", ".", "model", ".", "Job", ";", "import", "hudson", ".", "model", ".", "Result", ";", "import", "hudson", ".", "model", ".", "Run", ";", "import", "hudson", ".", "model", ".", "TaskListener", ";", "@", "@", "-", "25", ",", "6", "+", "27", ",", "8", "@", "@", "import", "hudson", ".", "util", ".", "ListBoxModel", ";", "import", "jenkins", ".", "model", ".", "GlobalConfiguration", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "AncestorInPath", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "verb", ".", "POST", ";", "public", "class", "SharedPollingBuildStep", "{", "@", "@", "-", "123", ",", "8", "+", "127", ",", "10", "@", "@", "public", "static", "FormValidation", "doCheckPollingInterval", "(", "String", "pollingInterval", ")", "{", "@", "POST", "public", "static", "FormValidation", "doTestPersonalAccessTokenConnection", "(", "final", "String", "username", ",", "final", "String", "personalAccessToken", ",", "final", "String", "tenantId", ")", "{", "Jenkins", ".", "get", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "final", "String", "tenantId", ",", "@", "AncestorInPath", "Job", "job", ")", "{", "job", ".", "checkPermission", "(", "Item", ".", "CONFIGURE", ")", ";", "FodApiConnection", "testApi", ";", "String", "baseUrl", "=", "GlobalConfiguration", ".", "all", "(", ").", "get", "(", "FodGlobalDescriptor", ".", "class", ")", ".", "getBaseUrl", "(", ");", "String", "apiUrl", "=", "GlobalConfiguration", ".", "all", "(", ").", "get", "(", "FodGlobalDescriptor", ".", "class", ")", ".", "getApiUrl", "(", ");", "@", "@", "-", "154", ",", "7", "+", "160", ",", "8", "@", "@", "public", "static", "ListBoxModel", "doFillPolicyFailureBuildResultPreferenceItems", "(", ")", "{", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "static", "ListBoxModel", "doFillStringCredentialsItems", "(", ")", "{", "public", "static", "ListBoxModel", "doFillStringCredentialsItems", "(", "@", "AncestorInPath", "Job", "job", ")", "{", "job", ".", "checkPermission", "(", "Item", ".", "CONFIGURE", ")", ";", "ListBoxModel", "items", "=", "CredentialsProvider", ".", "listCredentials", "(", "StringCredentials", ".", "class", ",", "Jenkins", ".", "get", "(", "),", "@", "@", "-", "21", ",", "6", "+", "21", ",", "8", "@", "@", "import", "hudson", ".", "Launcher", ";", "import", "hudson", ".", "model", ".", "AbstractBuild", ";", "import", "hudson", ".", "model", ".", "BuildListener", ";", "import", "hudson", ".", "model", ".", "Item", ";", "import", "hudson", ".", "model", ".", "Job", ";", "import", "hudson", ".", "model", ".", "Result", ";", "import", "hudson", ".", "model", ".", "Run", ";", "import", "hudson", ".", "model", ".", "TaskListener", ";", "@", "@", "-", "29", ",", "6", "+", "31", ",", "7", "@", "@", "import", "hudson", ".", "util", ".", "ListBoxModel", ";", "import", "jenkins", ".", "model", ".", "GlobalConfiguration", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "AncestorInPath", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "verb", ".", "POST", ";", "public", "class", "SharedUploadBuildStep", "{", "@", "@", "-", "113", ",", "8", "+", "116", ",", "9", "@", "@", "public", "static", "FormValidation", "doCheckBsiToken", "(", "String", "bsiToken", ",", "String", "releaseId", ")", "@", "POST", "public", "static", "FormValidation", "doTestPersonalAccessTokenConnection", "(", "final", "String", "username", ",", "final", "String", "personalAccessToken", ",", "final", "String", "tenantId", ")", "{", "Jenkins", ".", "get", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "final", "String", "tenantId", ",", "@", "AncestorInPath", "Job", "job", ")", "{", "job", ".", "checkPermission", "(", "Item", ".", "CONFIGURE", ")", ";", "FodApiConnection", "testApi", ";", "String", "baseUrl", "=", "GlobalConfiguration", ".", "all", "(", ").", "get", "(", "FodGlobalDescriptor", ".", "class", ")", ".", "getBaseUrl", "(", ");", "String", "apiUrl", "=", "GlobalConfiguration", ".", "all", "(", ").", "get", "(", "FodGlobalDescriptor", ".", "class", ")", ".", "getApiUrl", "(", ");", "@", "@", "-", "154", ",", "7", "+", "158", ",", "8", "@", "@", "public", "static", "ListBoxModel", "doFillRemediationScanPreferenceTypeItems", "(", ")", "{", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "static", "ListBoxModel", "doFillStringCredentialsItems", "(", ")", "{", "public", "static", "ListBoxModel", "doFillStringCredentialsItems", "(", "@", "AncestorInPath", "Job", "job", ")", "{", "job", ".", "checkPermission", "(", "Item", ".", "CONFIGURE", ")", ";", "ListBoxModel", "items", "=", "CredentialsProvider", ".", "listCredentials", "(", "StringCredentials", ".", "class", ",", "Jenkins", ".", "get", "(", "),", "@", "@", "-", "7", ",", "6", "+", "7", ",", "8", "@", "@", "import", "hudson", ".", "model", ".", "AbstractBuild", ";", "import", "hudson", ".", "model", ".", "AbstractProject", ";", "import", "hudson", ".", "model", ".", "BuildListener", ";", "import", "hudson", ".", "model", ".", "Item", ";", "import", "hudson", ".", "model", ".", "Job", ";", "import", "hudson", ".", "model", ".", "Run", ";", "import", "hudson", ".", "model", ".", "TaskListener", ";", "import", "hudson", ".", "security", ".", "Permission", ";", "@", "@", "-", "31", ",", "6", "+", "33", ",", "7", "@", "@", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "org", ".", "jenkinsci", ".", "plugins", ".", "fodupload", ".", "models", ".", "AuthenticationModel", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "AncestorInPath", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "QueryParameter", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "verb", ".", "POST", ";", "@", "@", "-", "196", ",", "9", "+", "199", ",", "10", "@", "@", "public", "String", "getDisplayName", "(", ")", "{", "@", "POST", "public", "FormValidation", "doTestPersonalAccessTokenConnection", "(", "@", "QueryParameter", "(", "SharedUploadBuildStep", ".", "USERNAME", ")", "final", "String", "username", ",", "@", "QueryParameter", "(", "SharedUploadBuildStep", ".", "PERSONAL_ACCESS_TOKEN", ")", "final", "String", "personalAccessToken", ",", "@", "QueryParameter", "(", "SharedUploadBuildStep", ".", "TENANT_ID", ")", "final", "String", "tenantId", ")", "{", "Jenkins", ".", "get", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "return", "SharedUploadBuildStep", ".", "doTestPersonalAccessTokenConnection", "(", "username", ",", "personalAccessToken", ",", "tenantId", ")", ";", "@", "QueryParameter", "(", "SharedUploadBuildStep", ".", "TENANT_ID", ")", "final", "String", "tenantId", ",", "@", "AncestorInPath", "Job", "job", ")", "{", "job", ".", "checkPermission", "(", "Item", ".", "CONFIGURE", ")", ";", "return", "SharedUploadBuildStep", ".", "doTestPersonalAccessTokenConnection", "(", "username", ",", "personalAccessToken", ",", "tenantId", ",", "job", ")", ";", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "@", "@", "-", "213", ",", "18", "+", "217", ",", "18", "@", "@", "public", "ListBoxModel", "doFillRemediationScanPreferenceTypeItems", "(", ")", "{", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "ListBoxModel", "doFillUsernameItems", "(", ")", "{", "return", "SharedUploadBuildStep", ".", "doFillStringCredentialsItems", "(", ");", "public", "ListBoxModel", "doFillUsernameItems", "(", "@", "AncestorInPath", "Job", "job", ")", "{", "return", "SharedUploadBuildStep", ".", "doFillStringCredentialsItems", "(", "job", ")", ";", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "ListBoxModel", "doFillPersonalAccessTokenItems", "(", ")", "{", "return", "SharedUploadBuildStep", ".", "doFillStringCredentialsItems", "(", ");", "public", "ListBoxModel", "doFillPersonalAccessTokenItems", "(", "@", "AncestorInPath", "Job", "job", ")", "{", "return", "SharedUploadBuildStep", ".", "doFillStringCredentialsItems", "(", "job", ")", ";", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "ListBoxModel", "doFillTenantIdItems", "(", ")", "{", "return", "SharedUploadBuildStep", ".", "doFillStringCredentialsItems", "(", ");", "public", "ListBoxModel", "doFillTenantIdItems", "(", "@", "AncestorInPath", "Job", "job", ")", "{", "return", "SharedUploadBuildStep", ".", "doFillStringCredentialsItems", "(", "job", ")", ";", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "@", "@", "-", "22", ",", "11", "+", "22", ",", "15", "@", "@", "import", "hudson", ".", "Launcher", ";", "import", "hudson", ".", "model", ".", "AbstractBuild", ";", "import", "hudson", ".", "model", ".", "BuildListener", ";", "import", "hudson", ".", "model", ".", "Item", ";", "import", "hudson", ".", "model", ".", "Job", ";", "import", "hudson", ".", "model", ".", "Run", ";", "import", "hudson", ".", "model", ".", "TaskListener", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "hudson", ".", "util", ".", "ListBoxModel", ";", "import", "hudson", ".", "util", ".", "Secret", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "AncestorInPath", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "verb", ".", "POST", ";", "@", "SuppressFBWarnings", "(", "\"", "unused", "\"", ")", "@", "@", "-", "193", ",", "9", "+", "197", ",", "11", "@", "@", "public", "String", "getFunctionName", "(", ")", "{", "@", "POST", "public", "FormValidation", "doTestPersonalAccessTokenConnection", "(", "@", "QueryParameter", "(", "SharedPollingBuildStep", ".", "USERNAME", ")", "final", "String", "username", ",", "@", "QueryParameter", "(", "SharedPollingBuildStep", ".", "PERSONAL_ACCESS_TOKEN", ")", "final", "String", "personalAccessToken", ",", "@", "QueryParameter", "(", "SharedPollingBuildStep", ".", "TENANT_ID", ")", "final", "String", "tenantId", ")", "{", "Jenkins", ".", "get", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "return", "SharedPollingBuildStep", ".", "doTestPersonalAccessTokenConnection", "(", "username", ",", "personalAccessToken", ",", "tenantId", ")", ";", "@", "QueryParameter", "(", "SharedPollingBuildStep", ".", "TENANT_ID", ")", "final", "String", "tenantId", ",", "@", "AncestorInPath", "Job", "job", ")", "{", "job", ".", "checkPermission", "(", "Item", ".", "CONFIGURE", ")", ";", "return", "SharedPollingBuildStep", ".", "doTestPersonalAccessTokenConnection", "(", "username", ",", "personalAccessToken", ",", "tenantId", ",", "job", ")", ";", "}", "@", "@", "-", "205", ",", "18", "+", "211", ",", "18", "@", "@", "public", "ListBoxModel", "doFillPolicyFailureBuildResultPreferenceItems", "(", ")", "{", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "ListBoxModel", "doFillUsernameItems", "(", ")", "{", "return", "SharedPollingBuildStep", ".", "doFillStringCredentialsItems", "(", ");", "public", "ListBoxModel", "doFillUsernameItems", "(", "@", "AncestorInPath", "Job", "job", ")", "{", "return", "SharedPollingBuildStep", ".", "doFillStringCredentialsItems", "(", "job", ")", ";", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "ListBoxModel", "doFillPersonalAccessTokenItems", "(", ")", "{", "return", "SharedPollingBuildStep", ".", "doFillStringCredentialsItems", "(", ");", "public", "ListBoxModel", "doFillPersonalAccessTokenItems", "(", "@", "AncestorInPath", "Job", "job", ")", "{", "return", "SharedPollingBuildStep", ".", "doFillStringCredentialsItems", "(", "job", ")", ";", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "ListBoxModel", "doFillTenantIdItems", "(", ")", "{", "return", "SharedPollingBuildStep", ".", "doFillStringCredentialsItems", "(", ");", "public", "ListBoxModel", "doFillTenantIdItems", "(", "@", "AncestorInPath", "Job", "job", ")", "{", "return", "SharedPollingBuildStep", ".", "doFillStringCredentialsItems", "(", "job", ")", ";", "}", "}", "@", "@", "-", "21", ",", "11", "+", "21", ",", "14", "@", "@", "import", "hudson", ".", "Launcher", ";", "import", "hudson", ".", "model", ".", "AbstractBuild", ";", "import", "hudson", ".", "model", ".", "BuildListener", ";", "import", "hudson", ".", "model", ".", "Item", ";", "import", "hudson", ".", "model", ".", "Job", ";", "import", "hudson", ".", "model", ".", "Run", ";", "import", "hudson", ".", "model", ".", "TaskListener", ";", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "hudson", ".", "util", ".", "ListBoxModel", ";", "import", "hudson", ".", "util", ".", "Secret", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "AncestorInPath", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "verb", ".", "POST", ";", "@", "@", "-", "211", ",", "9", "+", "214", ",", "11", "@", "@", "public", "String", "getFunctionName", "(", ")", "{", "@", "POST", "public", "FormValidation", "doTestPersonalAccessTokenConnection", "(", "@", "QueryParameter", "(", "SharedUploadBuildStep", ".", "USERNAME", ")", "final", "String", "username", ",", "@", "QueryParameter", "(", "SharedUploadBuildStep", ".", "PERSONAL_ACCESS_TOKEN", ")", "final", "String", "personalAccessToken", ",", "@", "QueryParameter", "(", "SharedUploadBuildStep", ".", "TENANT_ID", ")", "final", "String", "tenantId", ")", "{", "Jenkins", ".", "get", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "return", "SharedUploadBuildStep", ".", "doTestPersonalAccessTokenConnection", "(", "username", ",", "personalAccessToken", ",", "tenantId", ")", ";", "@", "QueryParameter", "(", "SharedUploadBuildStep", ".", "TENANT_ID", ")", "final", "String", "tenantId", ",", "@", "AncestorInPath", "Job", "job", ")", "{", "job", ".", "checkPermission", "(", "Item", ".", "CONFIGURE", ")", ";", "return", "SharedUploadBuildStep", ".", "doTestPersonalAccessTokenConnection", "(", "username", ",", "personalAccessToken", ",", "tenantId", ",", "job", ")", ";", "}", "@", "@", "-", "228", ",", "18", "+", "233", ",", "18", "@", "@", "public", "ListBoxModel", "doFillRemediationScanPreferenceTypeItems", "(", ")", "{", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "ListBoxModel", "doFillUsernameItems", "(", ")", "{", "return", "SharedUploadBuildStep", ".", "doFillStringCredentialsItems", "(", ");", "public", "ListBoxModel", "doFillUsernameItems", "(", "@", "AncestorInPath", "Job", "job", ")", "{", "return", "SharedUploadBuildStep", ".", "doFillStringCredentialsItems", "(", "job", ")", ";", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "ListBoxModel", "doFillPersonalAccessTokenItems", "(", ")", "{", "return", "SharedUploadBuildStep", ".", "doFillStringCredentialsItems", "(", ");", "public", "ListBoxModel", "doFillPersonalAccessTokenItems", "(", "@", "AncestorInPath", "Job", "job", ")", "{", "return", "SharedUploadBuildStep", ".", "doFillStringCredentialsItems", "(", "job", ")", ";", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")", "public", "ListBoxModel", "doFillTenantIdItems", "(", ")", "{", "return", "SharedUploadBuildStep", ".", "doFillStringCredentialsItems", "(", ");", "public", "ListBoxModel", "doFillTenantIdItems", "(", "@", "AncestorInPath", "Job", "job", ")", "{", "return", "SharedUploadBuildStep", ".", "doFillStringCredentialsItems", "(", "job", ")", ";", "}", "@", "SuppressWarnings", "(", "\"", "unused", "\"", ")"], "docstring_tokens": ["does", "not", "escape", "a", "tool", "path", "in", "the", "`checkVncServ", "`", "form", "validation", "endpoint", "accessed", "e.g", ".", "via", "job", "configuration", "forms"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "57", ",", "7", "+", "57", ",", "7", "@", "@", "public", "JpaUserCredentialStore", "(", "KeycloakSession", "session", ",", "EntityManager", "em", ")", "{", "@", "Override", "public", "void", "updateCredential", "(", "RealmModel", "realm", ",", "UserModel", "user", ",", "CredentialModel", "cred", ")", "{", "CredentialEntity", "entity", "=", "em", ".", "find", "(", "CredentialEntity", ".", "class", ",", "cred", ".", "getId", "(", "))", ";", "if", "(", "entity", "=", "=", "null", ")", "return", ";", "if", "(", "!", "checkCredentialEntity", "(", "entity", ",", "user", ")", ")", "return", ";", "entity", ".", "setCreatedDate", "(", "cred", ".", "getCreatedDate", "(", "))", ";", "entity", ".", "setUserLabel", "(", "cred", ".", "getUserLabel", "(", "))", ";", "entity", ".", "setType", "(", "cred", ".", "getType", "(", "))", ";", "@", "@", "-", "80", ",", "7", "+", "80", ",", "7", "@", "@", "public", "boolean", "removeStoredCredential", "(", "RealmModel", "realm", ",", "UserModel", "user", ",", "String", "i", "@", "Override", "public", "CredentialModel", "getStoredCredentialById", "(", "RealmModel", "realm", ",", "UserModel", "user", ",", "String", "id", ")", "{", "CredentialEntity", "entity", "=", "em", ".", "find", "(", "CredentialEntity", ".", "class", ",", "id", ")", ";", "if", "(", "entity", "=", "=", "null", ")", "return", "null", ";", "if", "(", "!", "checkCredentialEntity", "(", "entity", ",", "user", ")", ")", "return", "null", ";", "CredentialModel", "model", "=", "toModel", "(", "entity", ")", ";", "return", "model", ";", "}", "@", "@", "-", "161", ",", "7", "+", "161", ",", "7", "@", "@", "CredentialEntity", "createCredentialEntity", "(", "RealmModel", "realm", ",", "UserModel", "user", ",", "Creden", "CredentialEntity", "removeCredentialEntity", "(", "RealmModel", "realm", ",", "UserModel", "user", ",", "String", "id", ")", "{", "CredentialEntity", "entity", "=", "em", ".", "find", "(", "CredentialEntity", ".", "class", ",", "id", ",", "LockModeType", ".", "PESSIMISTIC_WRITE", ")", ";", "if", "(", "entity", "=", "=", "null", ")", "return", "null", ";", "if", "(", "!", "checkCredentialEntity", "(", "entity", ",", "user", ")", ")", "return", "null", ";", "int", "currentPriority", "=", "entity", ".", "getPriority", "(", ");", "@", "@", "-", "234", ",", "4", "+", "234", ",", "8", "@", "@", "public", "boolean", "moveCredentialTo", "(", "RealmModel", "realm", ",", "UserModel", "user", ",", "String", "id", ",", "Str", "return", "true", ";", "}", "private", "boolean", "checkCredentialEntity", "(", "CredentialEntity", "entity", ",", "UserModel", "user", ")", "{", "return", "entity", "!", "=", "null", "&", "&", "entity", ".", "getUser", "(", ")", "!", "=", "null", "&", "&", "entity", ".", "getUser", "(", ").", "getId", "(", ").", "equals", "(", "user", ".", "getId", "(", "))", ";", "}", "}", "@", "@", "-", "568", ",", "7", "+", "568", ",", "7", "@", "@", "public", "void", "deleteRoleMapping", "(", "RealmModel", "realm", ",", "String", "userId", ",", "RoleModel", "role", ")", "{", "@", "Override", "public", "void", "updateCredential", "(", "RealmModel", "realm", ",", "String", "userId", ",", "CredentialModel", "cred", ")", "{", "FederatedUserCredentialEntity", "entity", "=", "em", ".", "find", "(", "FederatedUserCredentialEntity", ".", "class", ",", "cred", ".", "getId", "(", "))", ";", "if", "(", "entity", "=", "=", "null", ")", "return", ";", "if", "(", "!", "checkCredentialEntity", "(", "entity", ",", "userId", ")", ")", "return", ";", "createIndex", "(", "realm", ",", "userId", ")", ";", "entity", ".", "setCreatedDate", "(", "cred", ".", "getCreatedDate", "(", "))", ";", "entity", ".", "setType", "(", "cred", ".", "getType", "(", "))", ";", "@", "@", "-", "605", ",", "7", "+", "605", ",", "7", "@", "@", "public", "CredentialModel", "createCredential", "(", "RealmModel", "realm", ",", "String", "userId", ",", "Credent", "@", "Override", "public", "boolean", "removeStoredCredential", "(", "RealmModel", "realm", ",", "String", "userId", ",", "String", "id", ")", "{", "FederatedUserCredentialEntity", "entity", "=", "em", ".", "find", "(", "FederatedUserCredentialEntity", ".", "class", ",", "id", ",", "LockModeType", ".", "PESSIMISTIC_WRITE", ")", ";", "if", "(", "entity", "=", "=", "null", ")", "return", "false", ";", "if", "(", "!", "checkCredentialEntity", "(", "entity", ",", "userId", ")", ")", "return", "false", ";", "int", "currentPriority", "=", "entity", ".", "getPriority", "(", ");", "@", "@", "-", "625", ",", "11", "+", "625", ",", "15", "@", "@", "public", "boolean", "removeStoredCredential", "(", "RealmModel", "realm", ",", "String", "userId", ",", "String", "id", "@", "Override", "public", "CredentialModel", "getStoredCredentialById", "(", "RealmModel", "realm", ",", "String", "userId", ",", "String", "id", ")", "{", "FederatedUserCredentialEntity", "entity", "=", "em", ".", "find", "(", "FederatedUserCredentialEntity", ".", "class", ",", "id", ")", ";", "if", "(", "entity", "=", "=", "null", ")", "return", "null", ";", "if", "(", "!", "checkCredentialEntity", "(", "entity", ",", "userId", ")", ")", "return", "null", ";", "CredentialModel", "model", "=", "toModel", "(", "entity", ")", ";", "return", "model", ";", "}", "private", "boolean", "checkCredentialEntity", "(", "FederatedUserCredentialEntity", "entity", ",", "String", "userId", ")", "{", "return", "entity", "!", "=", "null", "&", "&", "entity", ".", "getUserId", "(", ")", "!", "=", "null", "&", "&", "entity", ".", "getUserId", "(", ").", "equals", "(", "userId", ")", ";", "}", "protected", "CredentialModel", "toModel", "(", "FederatedUserCredentialEntity", "entity", ")", "{", "CredentialModel", "model", "=", "new", "CredentialModel", "(", ");", "model", ".", "setId", "(", "entity", ".", "getId", "(", "))", ";", "@", "@", "-", "1", ",", "6", "+", "1", ",", "7", "@", "@", "package", "org", ".", "keycloak", ".", "services", ".", "resources", ".", "account", ";", "import", "com", ".", "fasterxml", ".", "jackson", ".", "annotation", ".", "JsonIgnore", ";", "import", "org", ".", "jboss", ".", "logging", ".", "Logger", ";", "import", "org", ".", "jboss", ".", "resteasy", ".", "annotations", ".", "cache", ".", "NoCache", ";", "import", "org", ".", "keycloak", ".", "authentication", ".", "Authenticator", ";", "import", "org", ".", "keycloak", ".", "authentication", ".", "AuthenticatorFactory", ";", "@", "@", "-", "17", ",", "13", "+", "18", ",", "16", "@", "@", "import", "org", ".", "keycloak", ".", "models", ".", "utils", ".", "ModelToRepresentation", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "CredentialRepresentation", ";", "import", "org", ".", "keycloak", ".", "services", ".", "ErrorResponse", ";", "import", "org", ".", "keycloak", ".", "services", ".", "ErrorResponseException", ";", "import", "org", ".", "keycloak", ".", "services", ".", "managers", ".", "Auth", ";", "import", "org", ".", "keycloak", ".", "services", ".", "messages", ".", "Messages", ";", "import", "org", ".", "keycloak", ".", "util", ".", "JsonSerialization", ";", "import", "org", ".", "keycloak", ".", "utils", ".", "MediaType", ";", "import", "javax", ".", "ws", ".", "rs", ".", "Consumes", ";", "import", "javax", ".", "ws", ".", "rs", ".", "DELETE", ";", "import", "javax", ".", "ws", ".", "rs", ".", "GET", ";", "import", "javax", ".", "ws", ".", "rs", ".", "NotFoundException", ";", "import", "javax", ".", "ws", ".", "rs", ".", "POST", ";", "import", "javax", ".", "ws", ".", "rs", ".", "PUT", ";", "import", "javax", ".", "ws", ".", "rs", ".", "Path", ";", "@", "@", "-", "45", ",", "6", "+", "49", ",", "8", "@", "@", "public", "class", "AccountCredentialResource", "{", "private", "static", "final", "Logger", "logger", "=", "Logger", ".", "getLogger", "(", "AccountCredentialResource", ".", "class", ")", ";", "public", "static", "final", "String", "TYPE", "=", "\"", "type", "\"", ";", "public", "static", "final", "String", "ENABLED_ONLY", "=", "\"", "enabled", "-", "only", "\"", ";", "public", "static", "final", "String", "USER_CREDENTIALS", "=", "\"", "user", "-", "credentials", "\"", ";", "@", "@", "-", "279", ",", "6", "+", "285", ",", "10", "@", "@", "private", "boolean", "isFlowEffectivelyDisabled", "(", "AuthenticationFlowModel", "flow", ")", "{", "@", "NoCache", "public", "void", "removeCredential", "(", "final", "@", "PathParam", "(", "\"", "credentialId", "\"", ")", "String", "credentialId", ")", "{", "auth", ".", "require", "(", "AccountRoles", ".", "MANAGE_ACCOUNT", ")", ";", "CredentialModel", "credential", "=", "session", ".", "userCredentialManager", "(", ").", "getStoredCredentialById", "(", "realm", ",", "user", ",", "credentialId", ")", ";", "if", "(", "credential", "=", "=", "null", ")", "{", "throw", "new", "NotFoundException", "(", "\"", "Credential", "not", "found", "\"", ");", "}", "session", ".", "userCredentialManager", "(", ").", "removeStoredCredential", "(", "realm", ",", "user", ",", "credentialId", ")", ";", "}", "@", "@", "-", "287", ",", "14", "+", "297", ",", "25", "@", "@", "public", "void", "removeCredential", "(", "final", "@", "PathParam", "(", "\"", "credentialId", "\"", ")", "String", "credentialI", "*", "Update", "a", "user", "label", "of", "specified", "credential", "of", "current", "user", "*", "*", "@", "param", "credentialId", "ID", "of", "the", "credential", ",", "which", "will", "be", "updated", "*", "@", "param", "userLabel", "new", "user", "label", "*", "@", "param", "userLabel", "new", "user", "label", "as", "JSON", "string", "*", "/", "@", "PUT", "@", "Consumes", "(", "javax", ".", "ws", ".", "rs", ".", "core", ".", "MediaType", ".", "TEXT_PLAIN", ")", "@", "Consumes", "(", "MediaType", ".", "APPLICATION_JSON", ")", "@", "Path", "(", "\"{", "credentialId", "}", "/", "label", "\"", ")", "@", "NoCache", "public", "void", "setLabel", "(", "final", "@", "PathParam", "(", "\"", "credentialId", "\"", ")", "String", "credentialId", ",", "String", "userLabel", ")", "{", "auth", ".", "require", "(", "AccountRoles", ".", "MANAGE_ACCOUNT", ")", ";", "session", ".", "userCredentialManager", "(", ").", "updateCredentialLabel", "(", "realm", ",", "user", ",", "credentialId", ",", "userLabel", ")", ";", "CredentialModel", "credential", "=", "session", ".", "userCredentialManager", "(", ").", "getStoredCredentialById", "(", "realm", ",", "user", ",", "credentialId", ")", ";", "if", "(", "credential", "=", "=", "null", ")", "{", "throw", "new", "NotFoundException", "(", "\"", "Credential", "not", "found", "\"", ");", "}", "try", "{", "String", "label", "=", "JsonSerialization", ".", "readValue", "(", "userLabel", ",", "String", ".", "class", ")", ";", "session", ".", "userCredentialManager", "(", ").", "updateCredentialLabel", "(", "realm", ",", "user", ",", "credentialId", ",", "label", ")", ";", "}", "catch", "(", "IOException", "ioe", ")", "{", "throw", "new", "ErrorResponseException", "(", "ErrorResponse", ".", "error", "(", "Messages", ".", "INVALID_REQUEST", ",", "Response", ".", "Status", ".", "BAD_REQUEST", ")", ");", "}", "}", "/", "/", "TODO", ":", "This", "is", "kept", "here", "for", "now", "and", "commented", ".", "@", "@", "-", "662", ",", "6", "+", "662", ",", "12", "@", "@", "public", "void", "resetPassword", "(", "CredentialRepresentation", "cred", ")", "{", "@", "NoCache", "public", "void", "removeCredential", "(", "final", "@", "PathParam", "(", "\"", "credentialId", "\"", ")", "String", "credentialId", ")", "{", "auth", ".", "users", "(", ").", "requireManage", "(", "user", ")", ";", "CredentialModel", "credential", "=", "session", ".", "userCredentialManager", "(", ").", "getStoredCredentialById", "(", "realm", ",", "user", ",", "credentialId", ")", ";", "if", "(", "credential", "=", "=", "null", ")", "{", "/", "/", "we", "do", "this", "to", "make", "sure", "somebody", "can", "'", "t", "phish", "ids", "if", "(", "auth", ".", "users", "(", ").", "canQuery", "(", "))", "throw", "new", "NotFoundException", "(", "\"", "Credential", "not", "found", "\"", ");", "else", "throw", "new", "ForbiddenException", "(", ");", "}", "session", ".", "userCredentialManager", "(", ").", "removeStoredCredential", "(", "realm", ",", "user", ",", "credentialId", ")", ";", "adminEvent", ".", "operation", "(", "OperationType", ".", "ACTION", ")", ".", "resourcePath", "(", "session", ".", "getContext", "(", ").", "getUri", "(", "))", ".", "success", "(", ");", "}", "@", "@", "-", "677", ",", "7", "+", "683", ",", "7", "@", "@", "public", "void", "setCredentialUserLabel", "(", "final", "@", "PathParam", "(", "\"", "credentialId", "\"", ")", "String", "crede", "CredentialModel", "credential", "=", "session", ".", "userCredentialManager", "(", ").", "getStoredCredentialById", "(", "realm", ",", "user", ",", "credentialId", ")", ";", "if", "(", "credential", "=", "=", "null", ")", "{", "/", "/", "we", "do", "this", "to", "make", "sure", "somebody", "can", "'", "t", "phish", "ids", "if", "(", "auth", ".", "users", "(", ").", "canQuery", "(", "))", "throw", "new", "NotFoundException", "(", "\"", "User", "not", "found", "\"", ");", "if", "(", "auth", ".", "users", "(", ").", "canQuery", "(", "))", "throw", "new", "NotFoundException", "(", "\"", "Credential", "not", "found", "\"", ");", "else", "throw", "new", "ForbiddenException", "(", ");", "}", "session", ".", "userCredentialManager", "(", ").", "updateCredentialLabel", "(", "realm", ",", "user", ",", "credentialId", ",", "userLabel", ")", ";", "@", "@", "-", "705", ",", "7", "+", "711", ",", "7", "@", "@", "public", "void", "moveCredentialAfter", "(", "final", "@", "PathParam", "(", "\"", "credentialId", "\"", ")", "String", "credenti", "CredentialModel", "credential", "=", "session", ".", "userCredentialManager", "(", ").", "getStoredCredentialById", "(", "realm", ",", "user", ",", "credentialId", ")", ";", "if", "(", "credential", "=", "=", "null", ")", "{", "/", "/", "we", "do", "this", "to", "make", "sure", "somebody", "can", "'", "t", "phish", "ids", "if", "(", "auth", ".", "users", "(", ").", "canQuery", "(", "))", "throw", "new", "NotFoundException", "(", "\"", "User", "not", "found", "\"", ");", "if", "(", "auth", ".", "users", "(", ").", "canQuery", "(", "))", "throw", "new", "NotFoundException", "(", "\"", "Credential", "not", "found", "\"", ");", "else", "throw", "new", "ForbiddenException", "(", ");", "}", "session", ".", "userCredentialManager", "(", ").", "moveCredentialTo", "(", "realm", ",", "user", ",", "credentialId", ",", "newPreviousCredentialId", ")", ";", "@", "@", "-", "23", ",", "6", "+", "23", ",", "7", "@", "@", "import", "org", ".", "junit", ".", "Rule", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "keycloak", ".", "admin", ".", "client", ".", "resource", ".", "RealmResource", ";", "import", "org", ".", "keycloak", ".", "admin", ".", "client", ".", "resource", ".", "UserResource", ";", "import", "org", ".", "keycloak", ".", "credential", ".", "CredentialModel", ";", "import", "org", ".", "keycloak", ".", "events", ".", "Details", ";", "import", "org", ".", "keycloak", ".", "events", ".", "Errors", ";", "@", "@", "-", "33", ",", "8", "+", "34", ",", "10", "@", "@", "import", "org", ".", "keycloak", ".", "models", ".", "PasswordPolicy", ";", "import", "org", ".", "keycloak", ".", "models", ".", "RealmModel", ";", "import", "org", ".", "keycloak", ".", "models", ".", "UserModel", ";", "import", "org", ".", "keycloak", ".", "models", ".", "credential", ".", "OTPCredentialModel", ";", "import", "org", ".", "keycloak", ".", "models", ".", "utils", ".", "TimeBasedOTP", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "ClientRepresentation", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "CredentialRepresentation", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "EventRepresentation", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "RealmRepresentation", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "UserRepresentation", ";", "@", "@", "-", "63", ",", "6", "+", "66", ",", "7", "@", "@", "import", "org", ".", "keycloak", ".", "testsuite", ".", "util", ".", "OAuthClient", ";", "import", "org", ".", "keycloak", ".", "testsuite", ".", "util", ".", "RealmBuilder", ";", "import", "org", ".", "keycloak", ".", "testsuite", ".", "util", ".", "UIUtils", ";", "import", "org", ".", "keycloak", ".", "testsuite", ".", "util", ".", "URLUtils", ";", "import", "org", ".", "keycloak", ".", "testsuite", ".", "util", ".", "UserBuilder", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "org", ".", "openqa", ".", "selenium", ".", "By", ";", "@", "@", "-", "992", ",", "6", "+", "996", ",", "47", "@", "@", "public", "void", "setupTotp", "(", ")", "{", "assertFalse", "(", "errorPage", ".", "isCurrent", "(", "))", ";", "}", "@", "Test", "public", "void", "removeTotpAsDifferentUser", "(", ")", "{", "UserResource", "user1", "=", "ApiUtil", ".", "findUserByUsernameId", "(", "testRealm", "(", "),", "\"", "user", "-", "with", "-", "one", "-", "configured", "-", "otp", "\"", ");", "CredentialRepresentation", "otpCredential", "=", "user1", ".", "credentials", "(", ").", "stream", "(", ")", ".", "filter", "(", "credentialRep", "-", ">", "OTPCredentialModel", ".", "TYPE", ".", "equals", "(", "credentialRep", ".", "getType", "(", "))", ")", ".", "findFirst", "(", ")", ".", "get", "(", ");", "/", "/", "Login", "as", "evil", "user", "(", "test", "-", "user", "@", "localhost", ")", "and", "setup", "TOTP", "totpPage", ".", "open", "(", ");", "loginPage", ".", "login", "(", "\"", "test", "-", "user", "@", "localhost", "\"", ",", "\"", "password", "\"", ");", "Assert", ".", "assertTrue", "(", "totpPage", ".", "isCurrent", "(", "))", ";", "totpPageSetup", "(", ");", "totpPage", ".", "configure", "(", "totp", ".", "generateTOTP", "(", "totpPage", ".", "getTotpSecret", "(", "))", ");", "Assert", ".", "assertEquals", "(", "\"", "Mobile", "authenticator", "configured", ".", "\",", "profilePage", ".", "getSuccess", "(", "))", ";", "String", "currentStateChecker", "=", "driver", ".", "findElement", "(", "By", ".", "id", "(", "\"", "stateChecker", "\"", "))", ".", "getAttribute", "(", "\"", "value", "\"", ");", "/", "/", "Try", "to", "delete", "TOTP", "of", "\"", "user", "-", "with", "-", "one", "-", "configured", "-", "otp", "\"", "by", "replace", "ID", "of", "the", "TOTP", "credential", "in", "the", "request", "String", "currentURL", "=", "driver", ".", "getCurrentUrl", "(", ");", "String", "formParameters", "=", "\"", "stateChecker", "=", "\"", "+", "currentStateChecker", "+", "\"", "&", "submitAction", "=", "Delete", "\"", "+", "\"", "&", "credentialId", "=", "\"", "+", "otpCredential", ".", "getId", "(", ");", "URLUtils", ".", "sendPOSTRequestWithWebDriver", "(", "currentURL", ",", "formParameters", ")", ";", "/", "/", "Assert", "credential", "of", "\"", "user", "-", "with", "-", "one", "-", "configured", "-", "otp", "\"", "was", "NOT", "deleted", "and", "is", "still", "present", "for", "the", "user", "Assert", ".", "assertTrue", "(", "user1", ".", "credentials", "(", ").", "stream", "(", ")", ".", "anyMatch", "(", "credentialRepresentation", "-", ">", "credentialRepresentation", ".", "getType", "(", ").", "equals", "(", "OTPCredentialModel", ".", "TYPE", ")", "))", ";", "/", "/", "Remove", "TOTP", "for", "\"", "test", "-", "user", "\"", "and", "logout", "totpPage", ".", "removeTotp", "(", ");", "totpPage", ".", "logout", "(", ");", "}", "@", "Test", "public", "void", "changeProfileNoAccess", "(", ")", "throws", "Exception", "{", "profilePage", ".", "open", "(", ");", "@", "@", "-", "27", ",", "6", "+", "27", ",", "7", "@", "@", "import", "org", ".", "keycloak", ".", "authentication", ".", "requiredactions", ".", "WebAuthnRegisterFactory", ";", "import", "org", ".", "keycloak", ".", "broker", ".", "provider", ".", "util", ".", "SimpleHttp", ";", "import", "org", ".", "keycloak", ".", "common", ".", "Profile", ";", "import", "org", ".", "keycloak", ".", "common", ".", "util", ".", "ObjectUtil", ";", "import", "org", ".", "keycloak", ".", "credential", ".", "CredentialTypeMetadata", ";", "import", "org", ".", "keycloak", ".", "events", ".", "EventType", ";", "import", "org", ".", "keycloak", ".", "models", ".", "AuthenticationExecutionModel", ";", "@", "@", "-", "394", ",", "6", "+", "395", ",", "40", "@", "@", "public", "void", "testCredentialsGet", "(", ")", "throws", "IOException", "{", "Assert", ".", "assertNull", "(", "password", ".", "getUserCredentials", "(", "))", ";", "}", "@", "Test", "public", "void", "testCRUDCredentialOfDifferentUser", "(", ")", "throws", "IOException", "{", "/", "/", "Get", "credential", "ID", "of", "the", "OTP", "credential", "of", "the", "different", "user", "thant", "currently", "logged", "user", "UserResource", "user", "=", "ApiUtil", ".", "findUserByUsernameId", "(", "testRealm", "(", "),", "\"", "user", "-", "with", "-", "one", "-", "configured", "-", "otp", "\"", ");", "CredentialRepresentation", "otpCredential", "=", "user", ".", "credentials", "(", ").", "stream", "(", ")", ".", "filter", "(", "credentialRep", "-", ">", "OTPCredentialModel", ".", "TYPE", ".", "equals", "(", "credentialRep", ".", "getType", "(", "))", ")", ".", "findFirst", "(", ")", ".", "get", "(", ");", "/", "/", "Test", "that", "current", "user", "can", "'", "t", "update", "the", "credential", ",", "which", "belongs", "to", "the", "different", "user", "SimpleHttp", ".", "Response", "response", "=", "SimpleHttp", ".", "doPut", "(", "getAccountUrl", "(", "\"", "credentials", "/", "\"", "+", "otpCredential", ".", "getId", "(", ")", "+", "\"", "/", "label", "\"", "),", "httpClient", ")", ".", "auth", "(", "tokenUtil", ".", "getToken", "(", "))", ".", "json", "(", "\"", "new", "-", "label", "\"", ")", ".", "asResponse", "(", ");", "assertEquals", "(", "404", ",", "response", ".", "getStatus", "(", "))", ";", "/", "/", "Test", "that", "current", "user", "can", "'", "t", "delete", "the", "credential", ",", "which", "belongs", "to", "the", "different", "user", "response", "=", "SimpleHttp", ".", "doDelete", "(", "getAccountUrl", "(", "\"", "credentials", "/", "\"", "+", "otpCredential", ".", "getId", "(", "))", ",", "httpClient", ")", ".", "acceptJson", "(", ")", ".", "auth", "(", "tokenUtil", ".", "getToken", "(", "))", ".", "asResponse", "(", ");", "assertEquals", "(", "404", ",", "response", ".", "getStatus", "(", "))", ";", "/", "/", "Assert", "credential", "was", "not", "updated", "or", "removed", "CredentialRepresentation", "otpCredentialLoaded", "=", "user", ".", "credentials", "(", ").", "stream", "(", ")", ".", "filter", "(", "credentialRep", "-", ">", "OTPCredentialModel", ".", "TYPE", ".", "equals", "(", "credentialRep", ".", "getType", "(", "))", ")", ".", "findFirst", "(", ")", ".", "get", "(", ");", "Assert", ".", "assertTrue", "(", "ObjectUtil", ".", "isEqualOrBothNull", "(", "otpCredential", ".", "getUserLabel", "(", "),", "otpCredentialLoaded", ".", "getUserLabel", "(", "))", ");", "}", "/", "/", "Send", "REST", "request", "to", "get", "all", "credential", "containers", "and", "credentials", "of", "current", "user", "private", "List", "<", "AccountCredentialResource", ".", "CredentialContainer", ">", "getCredentials", "(", ")", "throws", "IOException", "{", "return", "SimpleHttp", ".", "doGet", "(", "getAccountUrl", "(", "\"", "credentials", "\"", "),", "httpClient", ")", "@", "@", "-", "32", ",", "14", "+", "32", ",", "17", "@", "@", "import", "org", ".", "keycloak", ".", "admin", ".", "client", ".", "resource", ".", "RoleMappingResource", ";", "import", "org", ".", "keycloak", ".", "admin", ".", "client", ".", "resource", ".", "UserResource", ";", "import", "org", ".", "keycloak", ".", "admin", ".", "client", ".", "resource", ".", "UsersResource", ";", "import", "org", ".", "keycloak", ".", "broker", ".", "provider", ".", "util", ".", "SimpleHttp", ";", "import", "org", ".", "keycloak", ".", "common", ".", "VerificationException", ";", "import", "org", ".", "keycloak", ".", "common", ".", "util", ".", "Base64", ";", "import", "org", ".", "keycloak", ".", "common", ".", "util", ".", "ObjectUtil", ";", "import", "org", ".", "keycloak", ".", "credential", ".", "CredentialModel", ";", "import", "org", ".", "keycloak", ".", "events", ".", "admin", ".", "OperationType", ";", "import", "org", ".", "keycloak", ".", "events", ".", "admin", ".", "ResourceType", ";", "import", "org", ".", "keycloak", ".", "models", ".", "Constants", ";", "import", "org", ".", "keycloak", ".", "models", ".", "PasswordPolicy", ";", "import", "org", ".", "keycloak", ".", "models", ".", "UserModel", ";", "import", "org", ".", "keycloak", ".", "models", ".", "credential", ".", "OTPCredentialModel", ";", "import", "org", ".", "keycloak", ".", "models", ".", "credential", ".", "PasswordCredentialModel", ";", "import", "org", ".", "keycloak", ".", "models", ".", "utils", ".", "ModelToRepresentation", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "AccessToken", ";", "@", "@", "-", "1958", ",", "6", "+", "1961", ",", "47", "@", "@", "public", "void", "testDeleteCredentials", "(", ")", "{", "user", ".", "resetPassword", "(", "credPasswd", ")", ";", "Assert", ".", "assertEquals", "(", "1", ",", "user", ".", "credentials", "(", ").", "size", "(", "))", ";", "}", "@", "Test", "public", "void", "testCRUDCredentialsOfDifferentUser", "(", ")", "{", "/", "/", "Get", "credential", "ID", "of", "the", "OTP", "credential", "of", "the", "user1", "UserResource", "user1", "=", "ApiUtil", ".", "findUserByUsernameId", "(", "testRealm", "(", "),", "\"", "user", "-", "with", "-", "one", "-", "configured", "-", "otp", "\"", ");", "CredentialRepresentation", "otpCredential", "=", "user1", ".", "credentials", "(", ").", "stream", "(", ")", ".", "filter", "(", "credentialRep", "-", ">", "OTPCredentialModel", ".", "TYPE", ".", "equals", "(", "credentialRep", ".", "getType", "(", "))", ")", ".", "findFirst", "(", ")", ".", "get", "(", ");", "/", "/", "Test", "that", "when", "admin", "operates", "on", "user", "\"", "user2", "\"", ",", "he", "can", "'", "t", "update", ",", "move", "or", "remove", "credentials", "of", "different", "user", "\"", "user1", "\"", "UserResource", "user2", "=", "ApiUtil", ".", "findUserByUsernameId", "(", "testRealm", "(", "),", "\"", "test", "-", "user", "@", "localhost", "\"", ");", "try", "{", "user2", ".", "setCredentialUserLabel", "(", "otpCredential", ".", "getId", "(", "),", "\"", "new", "-", "label", "\"", ");", "Assert", ".", "fail", "(", "\"", "Not", "expected", "to", "successfully", "update", "user", "label", "\"", ");", "}", "catch", "(", "NotFoundException", "nfe", ")", "{", "/", "/", "Expected", "}", "try", "{", "user2", ".", "moveCredentialToFirst", "(", "otpCredential", ".", "getId", "(", "))", ";", "Assert", ".", "fail", "(", "\"", "Not", "expected", "to", "successfully", "move", "credential", "\"", ");", "}", "catch", "(", "NotFoundException", "nfe", ")", "{", "/", "/", "Expected", "}", "try", "{", "user2", ".", "removeCredential", "(", "otpCredential", ".", "getId", "(", "))", ";", "Assert", ".", "fail", "(", "\"", "Not", "expected", "to", "successfully", "remove", "credential", "\"", ");", "}", "catch", "(", "NotFoundException", "nfe", ")", "{", "/", "/", "Expected", "}", "/", "/", "Assert", "credential", "was", "not", "removed", "or", "updated", "CredentialRepresentation", "otpCredentialLoaded", "=", "user1", ".", "credentials", "(", ").", "stream", "(", ")", ".", "filter", "(", "credentialRep", "-", ">", "OTPCredentialModel", ".", "TYPE", ".", "equals", "(", "credentialRep", ".", "getType", "(", "))", ")", ".", "findFirst", "(", ")", ".", "get", "(", ");", "Assert", ".", "assertTrue", "(", "ObjectUtil", ".", "isEqualOrBothNull", "(", "otpCredential", ".", "getUserLabel", "(", "),", "otpCredentialLoaded", ".", "getUserLabel", "(", "))", ");", "Assert", ".", "assertTrue", "(", "ObjectUtil", ".", "isEqualOrBothNull", "(", "otpCredential", ".", "getPriority", "(", "),", "otpCredentialLoaded", ".", "getPriority", "(", "))", ");", "}", "@", "Test", "public", "void", "testGetGroupsForUserFullRepresentation", "(", ")", "{", "@", "@", "-", "11", ",", "6", "+", "11", ",", "7", "@", "@", "import", "org", ".", "keycloak", ".", "admin", ".", "client", ".", "resource", ".", "RealmResource", ";", "import", "org", ".", "keycloak", ".", "admin", ".", "client", ".", "resource", ".", "UserResource", ";", "import", "org", ".", "keycloak", ".", "common", ".", "util", ".", "MultivaluedHashMap", ";", "import", "org", ".", "keycloak", ".", "common", ".", "util", ".", "ObjectUtil", ";", "import", "org", ".", "keycloak", ".", "credential", ".", "CredentialAuthentication", ";", "import", "org", ".", "keycloak", ".", "credential", ".", "CredentialModel", ";", "import", "org", ".", "keycloak", ".", "credential", ".", "UserCredentialStoreManager", ";", "@", "@", "-", "22", ",", "6", "+", "23", ",", "7", "@", "@", "import", "org", ".", "keycloak", ".", "models", ".", "credential", ".", "PasswordCredentialModel", ";", "import", "org", ".", "keycloak", ".", "models", ".", "utils", ".", "KeycloakModelUtils", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "ComponentRepresentation", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "CredentialRepresentation", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "GroupRepresentation", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "RealmRepresentation", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "RoleRepresentation", ";", "@", "@", "-", "76", ",", "6", "+", "78", ",", "8", "@", "@", "import", "static", "org", ".", "keycloak", ".", "storage", ".", "UserStorageProviderModel", ".", "MAX_LIFESPAN", ";", "import", "static", "org", ".", "keycloak", ".", "testsuite", ".", "actions", ".", "RequiredActionEmailVerificationTest", ".", "getPasswordResetEmailLink", ";", "import", "org", ".", "keycloak", ".", "testsuite", ".", "arquillian", ".", "annotation", ".", "AuthServerContainerExclude", ".", "AuthServer", ";", "import", "org", ".", "keycloak", ".", "testsuite", ".", "util", ".", "WaitUtils", ";", "import", "static", "org", ".", "keycloak", ".", "testsuite", ".", "util", ".", "URLAssert", ".", "assertCurrentUrlDoesntStartWith", ";", "import", "static", "org", ".", "keycloak", ".", "testsuite", ".", "util", ".", "URLAssert", ".", "assertCurrentUrlStartsWith", ";", "@", "@", "-", "960", ",", "6", "+", "964", ",", "57", "@", "@", "public", "void", "testCredentialCRUD", "(", "KeycloakSession", "session", ")", "throws", "Exception", "{", "}", ");", "}", "@", "Test", "public", "void", "testCRUDCredentialsOfDifferentUser", "(", ")", "{", "/", "/", "Create", "OTP", "credential", "for", "user1", "in", "the", "federated", "storage", "testingClient", ".", "server", "(", ").", "run", "(", "session", "-", ">", "{", "RealmModel", "realm", "=", "session", ".", "realms", "(", ").", "getRealmByName", "(", "\"", "test", "\"", ");", "UserModel", "user", "=", "session", ".", "users", "(", ").", "getUserByUsername", "(", "\"", "thor", "\"", ",", "realm", ")", ";", "Assert", ".", "assertFalse", "(", "StorageId", ".", "isLocalStorage", "(", "user", ")", ");", "CredentialModel", "otp1", "=", "OTPCredentialModel", ".", "createFromPolicy", "(", "realm", ",", "\"", "secret1", "\"", ");", "session", ".", "userCredentialManager", "(", ").", "createCredential", "(", "realm", ",", "user", ",", "otp1", ")", ";", "}", ");", "UserResource", "user1", "=", "ApiUtil", ".", "findUserByUsernameId", "(", "testRealmResource", "(", "),", "\"", "thor", "\"", ");", "CredentialRepresentation", "otpCredential", "=", "user1", ".", "credentials", "(", ").", "stream", "(", ")", ".", "filter", "(", "credentialRep", "-", ">", "OTPCredentialModel", ".", "TYPE", ".", "equals", "(", "credentialRep", ".", "getType", "(", "))", ")", ".", "findFirst", "(", ")", ".", "get", "(", ");", "/", "/", "Test", "that", "when", "admin", "operates", "on", "user", "\"", "user2", "\"", ",", "who", "is", "saved", "in", "user", "-", "storage", ",", "he", "can", "'", "t", "update", ",", "move", "or", "remove", "credentials", "of", "different", "user", "\"", "user1", "\"", "UserResource", "user2", "=", "ApiUtil", ".", "findUserByUsernameId", "(", "testRealmResource", "(", "),", "\"", "tbrady", "\"", ");", "try", "{", "user2", ".", "setCredentialUserLabel", "(", "otpCredential", ".", "getId", "(", "),", "\"", "new", "-", "label", "\"", ");", "Assert", ".", "fail", "(", "\"", "Not", "expected", "to", "successfully", "update", "user", "label", "\"", ");", "}", "catch", "(", "NotFoundException", "nfe", ")", "{", "/", "/", "Expected", "}", "try", "{", "user2", ".", "moveCredentialToFirst", "(", "otpCredential", ".", "getId", "(", "))", ";", "Assert", ".", "fail", "(", "\"", "Not", "expected", "to", "successfully", "move", "credential", "\"", ");", "}", "catch", "(", "NotFoundException", "nfe", ")", "{", "/", "/", "Expected", "}", "try", "{", "user2", ".", "removeCredential", "(", "otpCredential", ".", "getId", "(", "))", ";", "Assert", ".", "fail", "(", "\"", "Not", "expected", "to", "successfully", "remove", "credential", "\"", ");", "}", "catch", "(", "NotFoundException", "nfe", ")", "{", "/", "/", "Expected", "}", "/", "/", "Assert", "credential", "was", "not", "removed", "or", "updated", "CredentialRepresentation", "otpCredentialLoaded", "=", "user1", ".", "credentials", "(", ").", "stream", "(", ")", ".", "filter", "(", "credentialRep", "-", ">", "OTPCredentialModel", ".", "TYPE", ".", "equals", "(", "credentialRep", ".", "getType", "(", "))", ")", ".", "findFirst", "(", ")", ".", "get", "(", ");", "Assert", ".", "assertTrue", "(", "ObjectUtil", ".", "isEqualOrBothNull", "(", "otpCredential", ".", "getUserLabel", "(", "),", "otpCredentialLoaded", ".", "getUserLabel", "(", "))", ");", "Assert", ".", "assertTrue", "(", "ObjectUtil", ".", "isEqualOrBothNull", "(", "otpCredential", ".", "getPriority", "(", "),", "otpCredentialLoaded", ".", "getPriority", "(", "))", ");", "}", "private", "void", "assertOrder", "(", "List", "<", "CredentialModel", ">", "creds", ",", "String", ".", "..", "expectedIds", ")", "{", "org", ".", "keycloak", ".", "testsuite", ".", "Assert", ".", "assertEquals", "(", "expectedIds", ".", "length", ",", "creds", ".", "size", "(", "))", ";", "@", "@", "-", "78", ",", "6", "+", "78", ",", "7", "@", "@", "webauthn", "-", "help", "-", "text", "=", "Use", "your", "security", "key", "to", "log", "in", ".", "webauthn", "-", "passwordless", "-", "display", "-", "name", "=", "Security", "Key", "webauthn", "-", "passwordless", "-", "help", "-", "text", "=", "Use", "your", "security", "key", "for", "passwordless", "log", "in", ".", "basic", "-", "authentication", "=", "Basic", "Authentication", "invalidRequestMessage", "=", "Invalid", "Request", "#", "Applications", "page", "applicationsPageTitle", "=", "Applications"], "docstring_tokens": ["improper", "authorization", "validation"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "421", ",", "6", "+", "421", ",", "10", "@", "@", "int", "tipc_enable_l2_media", "(", "struct", "net", "*", "net", ",", "struct", "tipc_bearer", "*", "b", ",", "dev", "=", "dev_get_by_name", "(", "net", ",", "driver_name", ")", ";", "if", "(", "!", "dev", ")", "return", "-", "ENODEV", ";", "if", "(", "tipc_mtu_bad", "(", "dev", ",", "0", ")", ")", "{", "dev_put", "(", "dev", ")", ";", "return", "-", "EINVAL", ";", "}", "/", "*", "Associate", "TIPC", "bearer", "with", "L2", "bearer", "*", "/", "rcu_assign_pointer", "(", "b", "-", ">", "media_ptr", ",", "dev", ")", ";", "@", "@", "-", "610", ",", "8", "+", "614", ",", "6", "@", "@", "static", "int", "tipc_l2_device_event", "(", "struct", "notifier_block", "*", "nb", ",", "unsigned", "long", "evt", ",", "if", "(", "!", "b", ")", "return", "NOTIFY_DONE", ";", "b", "-", ">", "mtu", "=", "dev", "-", ">", "mtu", ";", "switch", "(", "evt", ")", "{", "case", "NETDEV_CHANGE", ":", "if", "(", "netif_carrier_ok", "(", "dev", ")", ")", "@", "@", "-", "624", ",", "6", "+", "626", ",", "11", "@", "@", "static", "int", "tipc_l2_device_event", "(", "struct", "notifier_block", "*", "nb", ",", "unsigned", "long", "evt", ",", "tipc_reset_bearer", "(", "net", ",", "b", ")", ";", "break", ";", "case", "NETDEV_CHANGEMTU", ":", "if", "(", "tipc_mtu_bad", "(", "dev", ",", "0", ")", ")", "{", "bearer_disable", "(", "net", ",", "b", ")", ";", "break", ";", "}", "b", "-", ">", "mtu", "=", "dev", "-", ">", "mtu", ";", "tipc_reset_bearer", "(", "net", ",", "b", ")", ";", "break", ";", "case", "NETDEV_CHANGEADDR", ":", "@", "@", "-", "39", ",", "6", "+", "39", ",", "7", "@", "@", "#", "include", "\"", "netlink", ".", "h", "\"", "#", "include", "\"", "core", ".", "h", "\"", "#", "include", "\"", "msg", ".", "h", "\"", "#", "include", "<", "net", "/", "genetlink", ".", "h", ">", "#", "define", "MAX_MEDIA", "3", "@", "@", "-", "59", ",", "6", "+", "60", ",", "9", "@", "@", "#", "define", "TIPC_MEDIA_TYPE_IB", "2", "#", "define", "TIPC_MEDIA_TYPE_UDP", "3", "/", "*", "minimum", "bearer", "MTU", "*", "/", "#", "define", "TIPC_MIN_BEARER_MTU", "(", "MAX_H_SIZE", "+", "INT_H_SIZE", ")", "/", "**", "*", "struct", "tipc_media_addr", "-", "destination", "address", "used", "by", "TIPC", "bearers", "*", "@", "value", ":", "address", "info", "(", "format", "defined", "by", "media", ")", "@", "@", "-", "215", ",", "4", "+", "219", ",", "13", "@", "@", "void", "tipc_bearer_xmit", "(", "struct", "net", "*", "net", ",", "u32", "bearer_id", ",", "void", "tipc_bearer_bc_xmit", "(", "struct", "net", "*", "net", ",", "u32", "bearer_id", ",", "struct", "sk_buff_head", "*", "xmitq", ")", ";", "/", "*", "check", "if", "device", "MTU", "is", "too", "low", "for", "tipc", "headers", "*", "/", "static", "inline", "bool", "tipc_mtu_bad", "(", "struct", "net_device", "*", "dev", ",", "unsigned", "int", "reserve", ")", "{", "if", "(", "dev", "-", ">", "mtu", ">", "=", "TIPC_MIN_BEARER_MTU", "+", "reserve", ")", "return", "false", ";", "netdev_warn", "(", "dev", ",", "\"", "MTU", "too", "low", "for", "tipc", "bearer", "\\", "n", "\"", ");", "return", "true", ";", "}", "#", "endif", "/", "*", "_TIPC_BEARER_H", "*", "/", "@", "@", "-", "697", ",", "6", "+", "697", ",", "11", "@", "@", "static", "int", "tipc_udp_enable", "(", "struct", "net", "*", "net", ",", "struct", "tipc_bearer", "*", "b", ",", "udp_conf", ".", "local_ip", ".", "s_addr", "=", "htonl", "(", "INADDR_ANY", ")", ";", "udp_conf", ".", "use_udp_checksums", "=", "false", ";", "ub", "-", ">", "ifindex", "=", "dev", "-", ">", "ifindex", ";", "if", "(", "tipc_mtu_bad", "(", "dev", ",", "sizeof", "(", "struct", "iphdr", ")", "sizeof", "(", "struct", "udphdr", ")", "))", "{", "err", "=", "-", "EINVAL", ";", "goto", "err", ";", "}", "b", "-", ">", "mtu", "=", "dev", "-", ">", "mtu", "-", "sizeof", "(", "struct", "iphdr", ")", "-", "sizeof", "(", "struct", "udphdr", ")", ";", "#", "if", "IS_ENABLED", "(", "CONFIG_IPV6", ")"], "docstring_tokens": ["does", "not", "validate", "the", "relationship", "between", "the", "minimum", "fragment", "length", "and", "the", "maximum", "packet", "size"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "234", ",", "19", "+", "234", ",", "19", "@", "@", "static", "int", "check_mem_permission", "(", "struct", "task_struct", "*", "task", ")", "struct", "mm_struct", "*", "mm_for_maps", "(", "struct", "task_struct", "*", "task", ")", "{", "struct", "mm_struct", "*", "mm", "=", "get_task_mm", "(", "task", ")", ";", "struct", "mm_struct", "*", "mm", ";", "if", "(", "mm", "&", "&", "mm", "!", "=", "current", "-", ">", "mm", ")", "{", "/", "*", "*", "task", "-", ">", "mm", "can", "be", "changed", "before", "security", "check", ",", "*", "in", "that", "case", "we", "must", "notice", "the", "change", "after", ".", "*", "/", "if", "(", "!", "ptrace_may_access", "(", "task", ",", "PTRACE_MODE_READ", ")", "|", "|", "mm", "!", "=", "task", "-", ">", "mm", ")", "{", "mmput", "(", "mm", ")", ";", "mm", "=", "NULL", ";", "}", "if", "(", "mutex_lock_killable", "(", "&", "task", "-", ">", "cred_guard_mutex", ")", ")", "return", "NULL", ";", "mm", "=", "get_task_mm", "(", "task", ")", ";", "if", "(", "mm", "&", "&", "mm", "!", "=", "current", "-", ">", "mm", "&", "&", "!", "ptrace_may_access", "(", "task", ",", "PTRACE_MODE_READ", ")", ")", "{", "mmput", "(", "mm", ")", ";", "mm", "=", "NULL", ";", "}", "mutex_unlock", "(", "&", "task", "-", ">", "cred_guard_mutex", ")", ";", "return", "mm", ";", "}"], "docstring_tokens": ["it", "\"allows", "access", "to", "information", "or", "capabilities"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "105", ",", "75", "+", "105", ",", "12", "@", "@", "*", "/", "String", "hash", "(", "String", "plaintext", ",", "String", "salt", ",", "int", "iterations", ")", "throws", "EncryptionException", ";", "/", "**", "*", "Encrypts", "the", "provided", "plaintext", "and", "returns", "a", "ciphertext", "string", "using", "the", "*", "master", "secret", "key", "and", "default", "cipher", "transformation", ".", "*", "<", "/", "p", ">", "<", "p", ">", "*", "<", "b", ">", "Compatibility", "with", "earlier", "ESAPI", "versions", ":", "</", "b", ">", "The", "symmetric", "encryption", "*", "in", "ESAPI", "2", ".", "0", "and", "later", "is", "not", "compatible", "with", "the", "encryption", "in", "ESAPI", "1", ".", "4", "*", "or", "earlier", ".", "Not", "only", "are", "the", "interfaces", "slightly", "different", ",", "but", "they", "format", "*", "of", "the", "serialized", "encrypted", "data", "is", "incompatible", ".", "Therefore", ",", "if", "you", "have", "*", "encrypted", "data", "with", "ESAPI", "1", ".", "4", "or", "earlier", ",", "you", "must", "first", "encrypt", "it", "and", "*", "then", "re", "-", "encrypt", "it", "with", "ESAPI", "2", ".", "0", ".", "Backward", "compatibility", "with", "ESAPI", "1", ".", "4", "*", "was", "proposed", "to", "both", "the", "ESAPI", "Developers", "and", "ESAPI", "Users", "mailing", "lists", "*", "and", "voted", "down", ".", "More", "details", "are", "available", "in", "the", "ESAPI", "document", "*", "<", "a", "href", "=", "\"", "http", ":", "//", "owasp", "-", "esapi", "-", "java", ".", "googlecode", ".", "com", "/", "svn", "/", "trunk", "/", "documentation", "/", "esapi4java", "-", "core", "-", "2", ".", "0", "-", "readme", "-", "crypto", "-", "changes", ".", "html", "\"", ">", "*", "Why", "Is", "OWASP", "Changing", "ESAPI", "Encryption", "?", "</", "a", ">", "*", "<", "/", "p", ">", "<", "p", ">", "*", "<", "b", ">", "Why", "this", "method", "is", "deprecated", ":", "</", "b", ">", "Most", "cryptographers", "strongly", "suggest", "*", "that", "if", "you", "are", "creating", "crypto", "functionality", "for", "general", "-", "purpose", "use", ",", "*", "at", "a", "minimum", "you", "should", "ensure", "that", "it", "provides", "authenticity", ",", "integrity", ",", "*", "and", "confidentiality", ".", "This", "method", "only", "provides", "confidentiality", ",", "but", "not", "*", "authenticity", "or", "integrity", ".", "Therefore", ",", "you", "are", "encouraged", "to", "use", "*", "one", "of", "the", "other", "encryption", "methods", "referenced", "below", ".", "Because", "this", "*", "method", "provides", "neither", "authenticity", "nor", "integrity", ",", "it", "may", "be", "*", "removed", "in", "some", "future", "ESAPI", "Java", "release", ".", "Note", ":", "there", "are", "some", "cases", "*", "where", "authenticity", "/", "integrity", "are", "not", "that", "important", ".", "For", "instance", ",", "consider", "*", "a", "case", "where", "the", "encrypted", "data", "is", "never", "out", "of", "your", "application", "'", "s", "control", ".", "For", "*", "example", ",", "if", "you", "receive", "data", "that", "your", "application", "is", "encrypting", "itself", "and", "then", "*", "storing", "the", "encrypted", "data", "in", "its", "own", "database", "for", "later", "use", "(", "and", "no", "other", "*", "applications", "can", "query", "or", "update", "that", "column", "of", "the", "database", ")", ",", "providing", "*", "confidentiality", "alone", "might", "be", "sufficient", ".", "However", ",", "if", "there", "are", "cases", "*", "where", "your", "application", "will", "be", "sending", "or", "receiving", "already", "encrypted", "data", "*", "over", "an", "insecure", ",", "unauthenticated", "channel", ",", "in", "such", "cases", "authenticity", "and", "*", "integrity", "of", "the", "encrypted", "data", "likely", "is", "important", "and", "this", "method", "should", "*", "be", "avoided", "in", "favor", "of", "one", "of", "the", "other", "two", ".", "*", "*", "@", "param", "plaintext", "*", "the", "plaintext", "{", "@", "code", "String", "}", "to", "encrypt", ".", "Note", "that", "if", "you", "are", "encrypting", "*", "general", "bytes", ",", "you", "should", "encypt", "that", "byte", "array", "to", "a", "String", "using", "*", "\"", "UTF", "-", "8", "\"", "encoding", ".", "*", "*", "@", "return", "*", "the", "encrypted", ",", "base64", "-", "encoded", "String", "representation", "of", "'", "plaintext", "'", "plus", "*", "the", "random", "IV", "used", ".", "*", "*", "@", "throws", "EncryptionException", "*", "if", "the", "specified", "encryption", "algorithm", "could", "not", "be", "found", "or", "another", "problem", "exists", "with", "*", "the", "encryption", "of", "'", "plaintext", "'", "*", "*", "@", "see", "#", "encrypt", "(", "PlainText", ")", "*", "@", "see", "#", "encrypt", "(", "SecretKey", ",", "PlainText", ")", "*", "*", "@", "deprecated", "As", "of", "1", ".", "4", ".", "2", ";", "use", "{", "@", "link", "#", "encrypt", "(", "PlainText", ")", "}", "instead", ",", "which", "*", "also", "ensures", "message", "authenticity", ".", "This", "method", "will", "be", "*", "completely", "removed", "as", "of", "the", "next", "major", "release", "or", "point", "*", "release", "(", "3", ".", "0", "or", "2", ".", "1", ",", "whichever", "comes", "first", ")", "as", "per", "OWASP", "*", "deprecation", "policy", ".", "*", "/", "@", "Deprecated", "String", "encrypt", "(", "String", "plaintext", ")", "throws", "EncryptionException", ";", "/", "**", "*", "Encrypts", "the", "provided", "plaintext", "bytes", "using", "the", "cipher", "transformation", "*", "specified", "by", "the", "property", "<", "code", ">", "Encryptor", ".", "CipherTransformation", "<", "/", "code", ">", "*", "and", "the", "<", "i", ">", "master", "encryption", "key", "<", "/", "i", ">", "as", "specified", "by", "the", "property", "*", "{", "@", "code", "Encryptor", ".", "MasterKey", "}", "as", "defined", "in", "the", "<", "code", ">", "ESAPI", ".", "properties", "<", "/", "code", ">", "file", ".", "*", "<", "/", "p", ">", "<", "p", ">", "*", "This", "method", "is", "preferred", "over", "{", "@", "link", "#", "encrypt", "(", "String", ")", "}", "because", "it", "also", "*", "allows", "encrypting", "of", "general", "byte", "streams", "rather", "than", "simply", "strings", "and", "*", "also", "because", "it", "returns", "a", "{", "@", "code", "CipherText", "}", "object", "and", "thus", "supports", "*", "cipher", "modes", "that", "require", "an", "Initialization", "Vector", "(", "IV", ")", ",", "such", "as", "*", "Cipher", "Block", "Chaining", "(", "CBC", ")", ".", "*", "<", "/", "p", ">", "*", "*", "@", "param", "plaintext", "The", "{", "@", "code", "PlainText", "}", "to", "be", "encrypted", ".", "*", "@", "return", "the", "{", "@", "code", "CipherText", "}", "object", "from", "which", "the", "raw", "ciphertext", ",", "the", "@", "@", "-", "217", ",", "68", "+", "154", ",", "11", "@", "@", "CipherText", "encrypt", "(", "SecretKey", "key", ",", "PlainText", "plaintext", ")", "throws", "EncryptionException", ";", "/", "**", "*", "Decrypts", "the", "provided", "ciphertext", "and", "returns", "a", "plaintext", "string", "using", "the", "*", "master", "secret", "key", "and", "default", "cipher", "transformation", ".", "*", "<", "/", "p", ">", "<", "p", ">", "*", "<", "b", ">", "Compatibility", "with", "earlier", "ESAPI", "versions", ":", "</", "b", ">", "The", "symmetric", "encryption", "*", "in", "ESAPI", "2", ".", "0", "and", "later", "is", "not", "compatible", "with", "the", "encryption", "in", "ESAPI", "1", ".", "4", "*", "or", "earlier", ".", "Not", "only", "are", "the", "interfaces", "slightly", "different", ",", "but", "they", "format", "*", "of", "the", "serialized", "encrypted", "data", "is", "incompatible", ".", "Therefore", ",", "if", "you", "have", "*", "encrypted", "data", "with", "ESAPI", "1", ".", "4", "or", "earlier", ",", "you", "must", "first", "encrypt", "it", "and", "*", "then", "re", "-", "encrypt", "it", "with", "ESAPI", "2", ".", "0", ".", "Backward", "compatibility", "with", "ESAPI", "1", ".", "4", "*", "was", "proposed", "to", "both", "the", "ESAPI", "Developers", "and", "ESAPI", "Users", "mailing", "lists", "*", "and", "voted", "down", ".", "More", "details", "are", "available", "in", "the", "ESAPI", "document", "*", "<", "a", "href", "=", "\"", "http", ":", "//", "owasp", "-", "esapi", "-", "java", ".", "googlecode", ".", "com", "/", "svn", "/", "trunk", "/", "documentation", "/", "esapi4java", "-", "core", "-", "2", ".", "0", "-", "readme", "-", "crypto", "-", "changes", ".", "html", "\"", ">", "*", "Why", "Is", "OWASP", "Changing", "ESAPI", "Encryption", "?", "</", "a", ">", "*", "<", "/", "p", ">", "<", "p", ">", "*", "<", "b", ">", "Why", "this", "method", "is", "deprecated", ":", "</", "b", ">", "Most", "cryptographers", "strongly", "suggest", "*", "that", "if", "you", "are", "creating", "crypto", "functionality", "for", "general", "-", "purpose", "use", ",", "*", "at", "a", "minimum", "you", "should", "ensure", "that", "it", "provides", "authenticity", ",", "integrity", ",", "*", "and", "confidentiality", ".", "This", "method", "only", "provides", "confidentiality", ",", "but", "not", "*", "authenticity", "or", "integrity", ".", "Therefore", ",", "you", "are", "encouraged", "to", "use", "*", "one", "of", "the", "other", "encryption", "methods", "referenced", "below", ".", "Because", "this", "*", "method", "provides", "neither", "authenticity", "nor", "integrity", ",", "it", "may", "be", "*", "removed", "in", "some", "future", "ESAPI", "Java", "release", ".", "Note", ":", "there", "are", "some", "cases", "*", "where", "authenticity", "/", "integrity", "are", "not", "that", "important", ".", "For", "instance", ",", "consider", "*", "a", "case", "where", "the", "encrypted", "data", "is", "never", "out", "of", "your", "application", "'", "s", "control", ".", "For", "*", "example", ",", "if", "you", "receive", "data", "that", "your", "application", "is", "encrypting", "itself", "and", "then", "*", "storing", "the", "encrypted", "data", "in", "its", "own", "database", "for", "later", "use", "(", "and", "no", "other", "*", "applications", "can", "query", "or", "update", "that", "column", "of", "the", "database", ")", ",", "providing", "*", "confidentiality", "alone", "might", "be", "sufficient", ".", "However", ",", "if", "there", "are", "cases", "*", "where", "your", "application", "will", "be", "sending", "or", "receiving", "already", "encrypted", "data", "*", "over", "an", "insecure", ",", "unauthenticated", "channel", ",", "in", "such", "cases", "authenticity", "and", "*", "integrity", "of", "the", "encrypted", "data", "likely", "is", "important", "and", "this", "method", "should", "*", "be", "avoided", "in", "favor", "of", "one", "of", "the", "other", "two", ".", "*", "*", "@", "param", "ciphertext", "*", "the", "ciphertext", "(", "the", "encrypted", "plaintext", ")", "that", "resulted", "from", "*", "encrypting", "using", "the", "method", "{", "@", "link", "#", "encrypt", "(", "String", ")", "}.", "*", "*", "@", "return", "*", "the", "decrypted", "ciphertext", "(", "i", ".", "e", ".", ",", "the", "corresponding", "plaintext", ")", ".", "*", "*", "@", "throws", "EncryptionException", "*", "if", "the", "specified", "encryption", "algorithm", "could", "not", "be", "found", "or", "another", "problem", "exists", "with", "*", "the", "decryption", "of", "'", "plaintext", "'", "*", "*", "@", "deprecated", "As", "of", "1", ".", "4", ".", "2", ";", "use", "{", "@", "link", "#", "decrypt", "(", "CipherText", ")", "}", "instead", ",", "which", "*", "also", "ensures", "message", "authenticity", ".", "This", "method", "will", "be", "*", "completely", "removed", "as", "of", "the", "next", "major", "release", "or", "point", "*", "release", "(", "3", ".", "0", "or", "2", ".", "1", ",", "whichever", "comes", "first", ")", "as", "per", "OWASP", "*", "deprecation", "policy", ".", "*", "/", "@", "Deprecated", "String", "decrypt", "(", "String", "ciphertext", ")", "throws", "EncryptionException", ";", "/", "**", "*", "Decrypts", "the", "provided", "{", "@", "link", "CipherText", "}", "using", "the", "information", "from", "it", "*", "and", "the", "<", "i", ">", "master", "encryption", "key", "<", "/", "i", ">", "as", "specified", "by", "the", "property", "*", "{", "@", "code", "Encryptor", ".", "MasterKey", "}", "as", "defined", "in", "the", "{", "@", "code", "ESAPI", ".", "properties", "}", "*", "file", ".", "*", "<", "/", "p", ">", "<", "p", ">", "*", "This", "decrypt", "method", "is", "to", "be", "preferred", "over", "the", "deprecated", "*", "{", "@", "link", "#", "decrypt", "(", "String", ")", "}", "method", "because", "this", "method", "can", "handle", "plaintext", "*", "bytes", "that", "were", "encrypted", "with", "cipher", "modes", "requiring", "IVs", ",", "such", "as", "CBC", ".", "*", "<", "/", "p", ">", "*", "@", "param", "ciphertext", "The", "{", "@", "code", "CipherText", "}", "object", "to", "be", "decrypted", ".", "*", "@", "return", "The", "{", "@", "code", "PlainText", "}", "object", "resulting", "from", "decrypting", "the", "specified", "@", "@", "-", "65", ",", "7", "+", "65", ",", "9", "@", "@", "/", "/", "reflected", "in", "the", "class", "CipherTextSerializer", ".", "/", "/", "This", "should", "be", "*", "same", "*", "version", "as", "in", "CipherTextSerializer", "and", "KeyDerivationFunction", ".", "/", "/", "If", "one", "changes", ",", "the", "other", "should", "as", "well", "to", "accommodate", "any", "differences", ".", "public", "static", "final", "int", "cipherTextVersion", "=", "20110203", ";", "/", "/", "Format", ":", "YYYYMMDD", ",", "max", "is", "99991231", ".", "/", "/", "Previous", "versions", ":", "20110203", "-", "Original", "version", "(", "ESAPI", "releases", "2", ".", "0", "&", "2", ".", "0", ".", "1", ")", "/", "/", "20130830", "-", "Fix", "to", "issue", "#", "306", "(", "release", "2", ".", "1", ".", "0", ")", "public", "static", "final", "int", "cipherTextVersion", "=", "20130830", ";", "/", "/", "Format", ":", "YYYYMMDD", ",", "max", "is", "99991231", ".", "/", "/", "Required", "by", "Serializable", "classes", ".", "private", "static", "final", "long", "serialVersionUID", "=", "cipherTextVersion", ";", "/", "/", "Format", ":", "YYYYMMDD", "@", "@", "-", "435", ",", "21", "+", "437", ",", "23", "@", "@", "void", "storeSeparateMAC", "(", "byte", "[", "]", "macValue", ")", "{", "*", "@", "return", "True", "if", "the", "ciphertext", "has", "not", "be", "tampered", "with", ",", "and", "false", "otherwise", ".", "*", "/", "public", "boolean", "validateMAC", "(", "SecretKey", "authKey", ")", "{", "boolean", "usesMAC", "=", "ESAPI", ".", "securityConfiguration", "(", ").", "useMACforCipherText", "(", ");", "boolean", "requiresMAC", "=", "ESAPI", ".", "securityConfiguration", "(", ").", "useMACforCipherText", "(", ");", "if", "(", "usesMAC", "&", "&", "macComputed", "(", ")", ")", "{", "/", "/", "Uses", "MAC", "and", "it", "was", "computed", "if", "(", "requiresMAC", "&", "&", "macComputed", "(", ")", ")", "{", "/", "/", "Uses", "MAC", "and", "it", "was", "computed", "/", "/", "Calculate", "MAC", "from", "HMAC", "-", "SHA1", "(", "nonce", ",", "IV", "+", "plaintext", ")", "and", "/", "/", "compare", "to", "stored", "value", "(", "separate_mac_", ")", ".", "If", "same", ",", "then", "return", "true", ",", "/", "/", "else", "return", "false", ".", "byte", "[", "]", "mac", "=", "computeMAC", "(", "authKey", ")", ";", "assert", "mac", ".", "length", "=", "=", "separate_mac_", ".", "length", ":", "\"", "MACs", "are", "of", "differnt", "lengths", ".", "Should", "both", "be", "the", "same", ".", "\";", "return", "CryptoHelper", ".", "arrayCompare", "(", "mac", ",", "separate_mac_", ")", ";", "/", "/", "Safe", "compare", "!", "!!", "}", "else", "if", "(", "!", "usesMAC", ")", "{", "/", "/", "Doesn", "'", "t", "use", "MAC", "}", "else", "if", "(", "!", "requiresMAC", ")", "{", "/", "/", "Doesn", "'", "t", "require", "a", "MAC", "return", "true", ";", "}", "else", "{", "/", "/", "Uses", "MAC", "but", "it", "has", "not", "been", "computed", "/", "stored", ".", "logger", ".", "warning", "(", "Logger", ".", "SECURITY_FAILURE", ",", "\"", "Cannot", "validate", "MAC", "as", "it", "was", "never", "computed", "and", "stored", ".", "\"", "+", "\"", "Decryption", "result", "may", "be", "garbage", "even", "when", "decryption", "succeeds", ".", "\")", ";", "return", "true", ";", "/", "/", "Need", "to", "return", "'", "true", "'", "here", "because", "of", "encrypt", "(", ")", "/", "decrypt", "(", ")", "methods", "don", "'", "t", "support", "this", ".", "}", "else", "{", "/", "/", "This", "*", "used", "*", "to", "be", "the", "case", "(", "for", "versions", "2", ".", "0", "and", "2", ".", "0", ".", "1", ")", "where", "we", "tried", "to", "/", "/", "accomodate", "the", "deprecated", "decrypt", "(", ")", "method", "from", "ESAPI", "1", ".", "4", ".", "Unfortunately", ",", "/", "/", "that", "was", "an", "EPIC", "FAIL", ".", "(", "See", "Google", "Issue", "#", "306", "for", "details", ".", ")", "logger", ".", "warning", "(", "Logger", ".", "SECURITY_FAILURE", ",", "\"", "MAC", "may", "have", "been", "tampered", "with", "(", "e", ".", "g", ".", ",", "length", "set", "to", "0", ")", ".\"", ");", "return", "false", ";", "/", "/", "Deprecated", "decrypt", "(", ")", "method", "removed", ",", "so", "now", "return", "false", ".", "}", "}", "@", "@", "-", "474", ",", "8", "+", "478", ",", "8", "@", "@", "public", "boolean", "validateMAC", "(", "SecretKey", "authKey", ")", "{", "/", "/", "If", "we", "are", "supposed", "to", "be", "using", "a", "(", "separate", ")", "MAC", ",", "also", "make", "sure", "/", "/", "that", "it", "has", "been", "computed", "/", "stored", ".", "boolean", "usesMAC", "=", "ESAPI", ".", "securityConfiguration", "(", ").", "useMACforCipherText", "(", ");", "if", "(", "usesMAC", "&", "&", "!", "macComputed", "(", ")", ")", "{", "boolean", "requiresMAC", "=", "ESAPI", ".", "securityConfiguration", "(", ").", "useMACforCipherText", "(", ");", "if", "(", "requiresMAC", "&", "&", "!", "macComputed", "(", ")", ")", "{", "String", "msg", "=", "\"", "Programming", "error", ":", "MAC", "is", "required", "for", "this", "cipher", "mode", "(", "\"", "+", "getCipherMode", "(", ")", "+", "\"", "),", "but", "MAC", "has", "not", "yet", "been", "\"", "+", "\"", "computed", "and", "stored", ".", "Call", "the", "method", "\"", "+", "@", "@", "-", "32", ",", "7", "+", "32", ",", "9", "@", "@", "public", "class", "CipherTextSerializer", "{", "/", "/", "This", "should", "be", "*", "same", "*", "version", "as", "in", "CipherText", "&", "KeyDerivationFunction", ".", "/", "/", "If", "one", "changes", ",", "the", "other", "should", "as", "well", "to", "accommodate", "any", "differences", ".", "public", "static", "final", "int", "cipherTextSerializerVersion", "=", "20110203", ";", "/", "/", "Format", ":", "YYYYMMDD", ",", "max", "is", "99991231", ".", "/", "/", "Previous", "versions", ":", "20110203", "-", "Original", "version", "(", "ESAPI", "releases", "2", ".", "0", "&", "2", ".", "0", ".", "1", ")", "/", "/", "20130830", "-", "Fix", "to", "issue", "#", "306", "(", "release", "2", ".", "1", ".", "0", ")", "public", "static", "final", "int", "cipherTextSerializerVersion", "=", "20130830", ";", "/", "/", "Format", ":", "YYYYMMDD", ",", "max", "is", "99991231", ".", "private", "static", "final", "long", "serialVersionUID", "=", "cipherTextSerializerVersion", ";", "private", "static", "final", "Logger", "logger", "=", "ESAPI", ".", "getLogger", "(", "\"", "CipherTextSerializer", "\"", ");", "@", "@", "-", "234", ",", "7", "+", "236", ",", "7", "@", "@", "private", "CipherText", "convertToCipherText", "(", "byte", "[", "]", "cipherTextSerializedBytes", ")", "debug", "(", "\"", "kdfPrf", ":", "\"", "+", "kdfPrf", ")", ";", "assert", "kdfPrf", ">", "=", "0", "&", "&", "kdfPrf", "<", "=", "15", ":", "\"", "kdfPrf", "=", "=", "\"", "+", "kdfPrf", "+", "\"", "must", "be", "between", "0", "and", "15", ".", "\";", "int", "kdfVers", "=", "(", "kdfInfo", "&", "0x07ffffff", ")", ";", "assert", "kdfVers", ">", "0", "&", "&", "kdfVers", "<", "=", "99991231", ":", "\"", "KDF", "Version", "(", "\"", "+", "kdfVers", "+", "\"", ")", "out", "of", "range", ".", "\";", "/", "/", "Really", "should", "be", ">", "=", "20110203", "(", "earliest", ")", ".", "assert", "kdfVers", ">", "=", "20110203", "&", "&", "kdfVers", "<", "=", "99991231", ":", "\"", "KDF", "Version", "(", "\"", "+", "kdfVers", "+", "\"", ")", "out", "of", "range", ".", "\";", "/", "/", "20110203", "(", "orig", "version", ")", ".", "debug", "(", "\"", "convertToCipherText", ":", "kdfPrf", "=", "\"", "+", "kdfPrf", "+", "\"", ",", "kdfVers", "=", "\"", "+", "kdfVers", ")", ";", "if", "(", "kdfVers", "!", "=", "CipherText", ".", "cipherTextVersion", ")", "{", "/", "/", "NOTE", ":", "In", "future", ",", "support", "backward", "compatibility", "via", "this", "mechanism", ".", "When", "we", "do", "this", "@", "@", "-", "49", ",", "12", "+", "49", ",", "15", "@", "@", "*", "{", "@", "link", "CipherTextSerializer", "#", "cipherTextSerializerVersion", "}", "to", "make", "sure", "*", "that", "these", "classes", "are", "all", "kept", "in", "-", "sync", "in", "order", "to", "support", "backward", "*", "compatibility", "of", "previously", "encrypted", "data", ".", "*", "*", "<", "pre", ">", "*", "Previous", "versions", ":", "20110203", "-", "Original", "version", "(", "ESAPI", "releases", "2", ".", "0", "&", "2", ".", "0", ".", "1", ")", "*", "20130830", "-", "Fix", "to", "issue", "#", "306", "(", "release", "2", ".", "1", ".", "0", ")", "*", "<", "/", "pre", ">", "*", "@", "see", "CipherTextSerializer", "#", "asSerializedByteArray", "(", ")", "*", "@", "see", "CipherText", "#", "asPortableSerializedByteArray", "(", ")", "*", "@", "see", "CipherText", "#", "fromPortableSerializedBytes", "(", "byte", "[", "])", "*", "/", "public", "static", "final", "int", "kdfVersion", "=", "20110203", ";", "/", "/", "Format", ":", "YYYYMMDD", ",", "max", "is", "99991231", ".", "public", "static", "final", "int", "kdfVersion", "=", "20130830", ";", "/", "/", "Format", ":", "YYYYMMDD", ",", "max", "is", "99991231", ".", "private", "static", "final", "long", "serialVersionUID", "=", "kdfVersion", ";", "/", "/", "Format", ":", "YYYYMMDD", "/", "/", "Pseudo", "-", "random", "function", "algorithms", "suitable", "for", "NIST", "KDF", "in", "counter", "mode", ".", "@", "@", "-", "329", ",", "28", "+", "329", ",", "6", "@", "@", "public", "String", "hash", "(", "String", "plaintext", ",", "String", "salt", ",", "int", "iterations", ")", "throws", "Encrypt", "throw", "new", "EncryptionException", "(", "\"", "Internal", "error", "\"", ",", "\"", "Can", "'", "t", "find", "encoding", "for", "\"", "+", "encoding", ",", "ex", ")", ";", "}", "}", "/", "**", "*", "Convenience", "method", "that", "encrypts", "plaintext", "strings", "the", "new", "way", "(", "default", "*", "is", "CBC", "mode", "and", "PKCS5", "padding", ")", ".", "This", "encryption", "method", "uses", "the", "master", "*", "encryption", "key", "specified", "by", "the", "{", "@", "code", "Encryptor", ".", "MasterKey", "}", "property", "*", "in", "{", "@", "code", "ESAPI", ".", "properties", "}", ".", "*", "*", "@", "param", "plaintext", "A", "String", "to", "be", "encrypted", "*", "@", "return", "A", "base64", "-", "encoded", "combination", "of", "IV", "+", "raw", "ciphertext", "*", "@", "throws", "EncryptionException", "Thrown", "when", "something", "goes", "wrong", "with", "the", "*", "encryption", ".", "*", "*", "@", "see", "org", ".", "owasp", ".", "esapi", ".", "Encryptor", "#", "encrypt", "(", "PlainText", ")", "*", "/", "@", "Deprecated", "public", "String", "encrypt", "(", "String", "plaintext", ")", "throws", "EncryptionException", "{", "logWarning", "(", "\"", "encrypt", "\"", ",", "\"", "Calling", "deprecated", "encrypt", "(", ")", "method", ".", "\")", ";", "CipherText", "ct", "=", "null", ";", "ct", "=", "encrypt", "(", "new", "PlainText", "(", "plaintext", ")", ")", ";", "return", "ct", ".", "getEncodedIVCipherText", "(", ");", "}", "/", "**", "*", "{", "@", "inheritDoc", "}", "@", "@", "-", "366", ",", "10", "+", "344", ",", "15", "@", "@", "public", "CipherText", "encrypt", "(", "PlainText", "plaintext", ")", "throws", "EncryptionException", "{", "public", "CipherText", "encrypt", "(", "SecretKey", "key", ",", "PlainText", "plain", ")", "throws", "EncryptionException", "{", "if", "(", "key", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"(", "Master", ")", "encryption", "key", "arg", "may", "not", "be", "null", ".", "Is", "Encryptor", ".", "MasterKey", "set", "?", "\")", ";", "}", "if", "(", "plain", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "PlainText", "may", "arg", "not", "be", "null", "\"", ");", "}", "byte", "[", "]", "plaintext", "=", "plain", ".", "asBytes", "(", ");", "boolean", "overwritePlaintext", "=", "ESAPI", ".", "securityConfiguration", "(", ").", "overwritePlainText", "(", ");", "assert", "key", "!", "=", "null", ":", "\"", "(", "Master", ")", "encryption", "key", "may", "not", "be", "null", "\"", ";", "boolean", "success", "=", "false", ";", "/", "/", "Used", "in", "'", "finally", "'", "clause", ".", "String", "xform", "=", "null", ";", "int", "keySize", "=", "key", ".", "getEncoded", "(", ").", "length", "*", "8", ";", "/", "/", "Convert", "to", "#", "bits", "@", "@", "-", "569", ",", "53", "+", "552", ",", "6", "@", "@", "public", "CipherText", "encrypt", "(", "SecretKey", "key", ",", "PlainText", "plain", ")", "}", "}", "/", "**", "*", "Convenience", "method", "that", "decrypts", "previously", "encrypted", "plaintext", "strings", "*", "that", "were", "encrypted", "using", "the", "new", "encryption", "mechanism", "(", "with", "CBC", "mode", "and", "*", "PKCS5", "padding", "by", "default", ")", ".", "This", "decryption", "method", "uses", "the", "master", "*", "encryption", "key", "specified", "by", "the", "{", "@", "code", "Encryptor", ".", "MasterKey", "}", "property", "*", "in", "{", "@", "code", "ESAPI", ".", "properties", "}", ".", "*", "*", "@", "param", "b64IVCiphertext", "A", "base64", "-", "encoded", "representation", "of", "the", "*", "IV", "+", "raw", "ciphertext", "string", "to", "be", "decrypted", "with", "*", "the", "default", "master", "key", ".", "*", "@", "return", "The", "plaintext", "string", "prior", "to", "encryption", ".", "*", "@", "throws", "EncryptionException", "When", "something", "fails", "with", "the", "decryption", ".", "*", "*", "@", "see", "org", ".", "owasp", ".", "esapi", ".", "Encryptor", "#", "decrypt", "(", "CipherText", ")", "*", "/", "@", "Deprecated", "public", "String", "decrypt", "(", "String", "b64IVCiphertext", ")", "throws", "EncryptionException", "{", "logWarning", "(", "\"", "decrypt", "\"", ",", "\"", "Calling", "deprecated", "decrypt", "(", ")", "method", ".", "\")", ";", "CipherText", "ct", "=", "null", ";", "try", "{", "/", "/", "We", "assume", "that", "the", "default", "cipher", "transform", "was", "used", "to", "encrypt", "this", ".", "ct", "=", "new", "CipherText", "(", ");", "/", "/", "Need", "to", "base64", "decode", "the", "IV", "+", "ciphertext", "and", "extract", "the", "IV", "to", "set", "it", "in", "CipherText", "object", ".", "byte", "[", "]", "ivPlusRawCipherText", "=", "ESAPI", ".", "encoder", "(", ").", "decodeFromBase64", "(", "b64IVCiphertext", ")", ";", "int", "blockSize", "=", "ct", ".", "getBlockSize", "(", ");", "/", "/", "Size", "in", "bytes", ".", "byte", "[", "]", "iv", "=", "new", "byte", "[", "blockSize", "]", ";", "CryptoHelper", ".", "copyByteArray", "(", "ivPlusRawCipherText", ",", "iv", ",", "blockSize", ")", ";", "/", "/", "Copy", "the", "first", "blockSize", "bytes", "into", "iv", "array", "int", "cipherTextSize", "=", "ivPlusRawCipherText", ".", "length", "-", "blockSize", ";", "byte", "[", "]", "rawCipherText", "=", "new", "byte", "[", "cipherTextSize", "]", ";", "System", ".", "arraycopy", "(", "ivPlusRawCipherText", ",", "blockSize", ",", "rawCipherText", ",", "0", ",", "cipherTextSize", ")", ";", "ct", ".", "setIVandCiphertext", "(", "iv", ",", "rawCipherText", ")", ";", "/", "/", "Now", "the", "CipherText", "object", "should", "be", "prepared", "to", "use", "it", "to", "decrypt", ".", "PlainText", "plaintext", "=", "decrypt", "(", "ct", ")", ";", "return", "plaintext", ".", "toString", "(", ");", "/", "/", "Convert", "back", "to", "a", "Java", "String", "}", "catch", "(", "UnsupportedEncodingException", "e", ")", "{", "/", "/", "Should", "never", "happen", ";", "UTF", "-", "8", "should", "be", "in", "rt", ".", "jar", ".", "logger", ".", "error", "(", "Logger", ".", "SECURITY_FAILURE", ",", "\"", "UTF", "-", "8", "encoding", "not", "available", "!", "Decryption", "failed", ".", "\",", "e", ")", ";", "return", "null", ";", "/", "/", "CHECKME", ":", "Or", "re", "-", "throw", "or", "what", "?", "Could", "also", "use", "native", "encoding", ",", "but", "that", "'", "s", "/", "/", "likely", "to", "cause", "unexpected", "and", "undesired", "effects", "far", "downstream", ".", "}", "catch", "(", "IOException", "e", ")", "{", "logger", ".", "error", "(", "Logger", ".", "SECURITY_FAILURE", ",", "\"", "Base64", "decoding", "of", "IV", "+", "ciphertext", "failed", ".", "Decryption", "failed", ".", "\",", "e", ")", ";", "return", "null", ";", "}", "}", "/", "**", "*", "{", "@", "inheritDoc", "}", "*", "/"], "docstring_tokens": ["does", "not", "properly", "resist", "tampering", "with", "serialized", "ciphertext"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "239", ",", "7", "+", "239", ",", "12", "@", "@", "static", "struct", "dentry", "*", "aio_mount", "(", "struct", "file_system_type", "*", "fs_type", ",", "static", "const", "struct", "dentry_operations", "ops", "=", "{", ".", "d_dname", "=", "simple_dname", ",", "}", ";", "return", "mount_pseudo", "(", "fs_type", ",", "\"", "aio", ":", "\",", "NULL", ",", "&", "ops", ",", "AIO_RING_MAGIC", ")", ";", "struct", "dentry", "*", "root", "=", "mount_pseudo", "(", "fs_type", ",", "\"", "aio", ":", "\",", "NULL", ",", "&", "ops", ",", "AIO_RING_MAGIC", ")", ";", "if", "(", "!", "IS_ERR", "(", "root", ")", ")", "root", "-", ">", "d_sb", "-", ">", "s_iflags", "|", "=", "SB_I_NOEXEC", ";", "return", "root", ";", "}", "/", "*", "aio_setup"], "docstring_tokens": ["does", "not", "properly", "restrict", "execute", "access"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "41", ",", "7", "+", "41", ",", "7", "@", "@", "install", ":", "fi", "-", "mkdir", "-", "p", "$", "HOME", "/", "build", "/", "cloudfoundry", "/", "uaa", "/", "uaa", "/", "build", "/", "reports", "/", "tests", "script", ":", ".", "/", "gradlew", "-", "Dspring", ".", "profiles", ".", "active", "=", "$", "TESTENV", "jacocoRootReport", "-", ".", "/", "gradlew", "-", "Dspring", ".", "profiles", ".", "active", "=", "$", "TESTENV", "-", "Djavax", ".", "net", ".", "ssl", ".", "trustStore", "=", "$", "TRAVIS_BUILD_DIR", "/", "scripts", "/", "ldap", "/", "truststore", "-", "with", "-", "ldap", "-", "certs", ".", "jks", "-", "Djavax", ".", "net", ".", "ssl", ".", "trustStoreType", "=", "JKS", "jacocoRootReport", "after_success", ":", "-", ".", "/", "gradlew", "coveralls", "-", "for", "i", "in", "$", "(", "find", "$", "HOME", "/", "build", "/", "cloudfoundry", "/", "uaa", "/", "-", "name", "reports", "-", "type", "d", ")", ";", "do", "rm", "-", "rf", "$", "i", ";", "done", "@", "@", "-", "14", ",", "13", "+", "14", ",", "16", "@", "@", "package", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "provider", ".", "ldap", ";", "import", "java", ".", "security", ".", "KeyManagementException", ";", "import", "java", ".", "security", ".", "NoSuchAlgorithmException", ";", "import", "java", ".", "util", ".", "LinkedHashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "public", "class", "ProcessLdapProperties", "{", "public", "static", "final", "String", "LDAP_SOCKET_FACTORY", "=", "\"", "java", ".", "naming", ".", "ldap", ".", "factory", ".", "socket", "\"", ";", "public", "static", "final", "String", "SKIP_SSL_VERIFICATION_SOCKET_FACTORY", "=", "\"", "org", ".", "apache", ".", "directory", ".", "api", ".", "util", ".", "DummySSLSocketFactory", "\"", ";", "public", "static", "final", "String", "EXPIRY_CHECKING_SOCKET_FACTORY", "=", "\"", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "security", ".", "LdapSocketFactory", "\"", ";", "private", "boolean", "disableSslVerification", ";", "private", "String", "baseUrl", ";", "@", "@", "-", "30", ",", "10", "+", "33", ",", "14", "@", "@", "public", "ProcessLdapProperties", "(", "String", "baseUrl", ",", "boolean", "disableSslVerification", ")", "{", "this", ".", "disableSslVerification", "=", "disableSslVerification", ";", "}", "public", "Map", "process", "(", "Map", "map", ")", "{", "public", "Map", "process", "(", "Map", "map", ")", "throws", "KeyManagementException", ",", "NoSuchAlgorithmException", "{", "Map", "result", "=", "new", "LinkedHashMap", "(", "map", ")", ";", "if", "(", "isDisableSslVerification", "(", ")", "&", "&", "isLdapsUrl", "(", "))", "{", "result", ".", "put", "(", "LDAP_SOCKET_FACTORY", ",", "SKIP_SSL_VERIFICATION_SOCKET_FACTORY", ")", ";", "if", "(", "isLdapsUrl", "(", "))", "{", "if", "(", "isDisableSslVerification", "(", "))", "{", "result", ".", "put", "(", "LDAP_SOCKET_FACTORY", ",", "SKIP_SSL_VERIFICATION_SOCKET_FACTORY", ")", ";", "}", "else", "{", "result", ".", "put", "(", "LDAP_SOCKET_FACTORY", ",", "EXPIRY_CHECKING_SOCKET_FACTORY", ")", ";", "}", "}", "return", "result", ";", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "72", "@", "@", "package", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "security", ";", "import", "javax", ".", "net", ".", "SocketFactory", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLContext", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLSocketFactory", ";", "import", "javax", ".", "net", ".", "ssl", ".", "TrustManager", ";", "import", "javax", ".", "net", ".", "ssl", ".", "X509TrustManager", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "net", ".", "InetAddress", ";", "import", "java", ".", "net", ".", "Socket", ";", "import", "java", ".", "security", ".", "SecureRandom", ";", "public", "class", "LdapSocketFactory", "extends", "SSLSocketFactory", "{", "private", "static", "SocketFactory", "instance", ";", "private", "SSLSocketFactory", "delegate", ";", "public", "static", "SocketFactory", "getDefault", "(", ")", "{", "if", "(", "instance", "=", "=", "null", ")", "{", "instance", "=", "new", "LdapSocketFactory", "(", ");", "}", "return", "instance", ";", "}", "public", "LdapSocketFactory", "(", ")", "{", "try", "{", "X509TrustManager", "trustManager", "=", "new", "X509ExpiryCheckingTrustManager", "(", ");", "TrustManager", "[", "]", "tma", "=", "new", "TrustManager", "[", "]{", "trustManager", "}", ";", "SSLContext", "sc", "=", "SSLContext", ".", "getInstance", "(", "\"", "TLS", "\"", ");", "sc", ".", "init", "(", "null", ",", "tma", ",", "new", "SecureRandom", "(", "))", ";", "this", ".", "delegate", "=", "sc", ".", "getSocketFactory", "(", ");", "}", "catch", "(", "Exception", "e", ")", "{", "e", ".", "printStackTrace", "(", ");", "}", "}", "@", "Override", "public", "String", "[", "]", "getDefaultCipherSuites", "(", ")", "{", "return", "delegate", ".", "getDefaultCipherSuites", "(", ");", "}", "@", "Override", "public", "String", "[", "]", "getSupportedCipherSuites", "(", ")", "{", "return", "delegate", ".", "getSupportedCipherSuites", "(", ");", "}", "@", "Override", "public", "Socket", "createSocket", "(", "Socket", "socket", ",", "String", "s", ",", "int", "i", ",", "boolean", "b", ")", "throws", "IOException", "{", "return", "delegate", ".", "createSocket", "(", "socket", ",", "s", ",", "i", ",", "b", ")", ";", "}", "@", "Override", "public", "Socket", "createSocket", "(", "String", "s", ",", "int", "i", ")", "throws", "IOException", "{", "return", "delegate", ".", "createSocket", "(", "s", ",", "i", ")", ";", "}", "@", "Override", "public", "Socket", "createSocket", "(", "String", "s", ",", "int", "i", ",", "InetAddress", "inetAddress", ",", "int", "i1", ")", "throws", "IOException", "{", "return", "delegate", ".", "createSocket", "(", "s", ",", "i", ",", "inetAddress", ",", "i1", ")", ";", "}", "@", "Override", "public", "Socket", "createSocket", "(", "InetAddress", "inetAddress", ",", "int", "i", ")", "throws", "IOException", "{", "return", "delegate", ".", "createSocket", "(", "inetAddress", ",", "i", ")", ";", "}", "@", "Override", "public", "Socket", "createSocket", "(", "InetAddress", "inetAddress", ",", "int", "i", ",", "InetAddress", "inetAddress1", ",", "int", "i1", ")", "throws", "IOException", "{", "return", "delegate", ".", "createSocket", "(", "inetAddress", ",", "i", ",", "inetAddress1", ",", "i1", ")", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "65", "@", "@", "package", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "security", ";", "import", "javax", ".", "net", ".", "ssl", ".", "TrustManager", ";", "import", "javax", ".", "net", ".", "ssl", ".", "TrustManagerFactory", ";", "import", "javax", ".", "net", ".", "ssl", ".", "X509TrustManager", ";", "import", "java", ".", "security", ".", "KeyStore", ";", "import", "java", ".", "security", ".", "KeyStoreException", ";", "import", "java", ".", "security", ".", "NoSuchAlgorithmException", ";", "import", "java", ".", "security", ".", "cert", ".", "CertificateException", ";", "import", "java", ".", "security", ".", "cert", ".", "X509Certificate", ";", "public", "class", "X509ExpiryCheckingTrustManager", "implements", "X509TrustManager", "{", "private", "X509TrustManager", "delegate", ";", "public", "X509ExpiryCheckingTrustManager", "(", ")", "{", "try", "{", "TrustManagerFactory", "tmf", ";", "tmf", "=", "TrustManagerFactory", ".", "getInstance", "(", "TrustManagerFactory", ".", "getDefaultAlgorithm", "(", "))", ";", "tmf", ".", "init", "(", "(", "KeyStore", ")", "null", ")", ";", "X509TrustManager", "x509Tm", "=", "null", ";", "for", "(", "TrustManager", "tm", ":", "tmf", ".", "getTrustManagers", "(", "))", "{", "if", "(", "tm", "instanceof", "X509TrustManager", ")", "{", "x509Tm", "=", "(", "X509TrustManager", ")", "tm", ";", "break", ";", "}", "}", "delegate", "=", "x509Tm", ";", "}", "catch", "(", "NoSuchAlgorithmException", "|", "KeyStoreException", "e", ")", "{", "}", "}", "protected", "void", "setDelegate", "(", "X509TrustManager", "delegate", ")", "{", "this", ".", "delegate", "=", "delegate", ";", "}", "@", "Override", "public", "void", "checkClientTrusted", "(", "X509Certificate", "[", "]", "x509Certificates", ",", "String", "s", ")", "throws", "CertificateException", "{", "if", "(", "delegate", "=", "=", "null", ")", "{", "throw", "new", "CertificateException", "(", ");", "}", "else", "{", "delegate", ".", "checkClientTrusted", "(", "x509Certificates", ",", "s", ")", ";", "}", "}", "@", "Override", "public", "void", "checkServerTrusted", "(", "X509Certificate", "[", "]", "x509Certificates", ",", "String", "s", ")", "throws", "CertificateException", "{", "if", "(", "delegate", "=", "=", "null", ")", "{", "throw", "new", "CertificateException", "(", ");", "}", "else", "{", "delegate", ".", "checkServerTrusted", "(", "x509Certificates", ",", "s", ")", ";", "}", "for", "(", "X509Certificate", "certificate", ":", "x509Certificates", ")", "{", "certificate", ".", "checkValidity", "(", ");", "}", "}", "@", "Override", "public", "X509Certificate", "[", "]", "getAcceptedIssuers", "(", ")", "{", "if", "(", "delegate", "!", "=", "null", ")", "{", "return", "delegate", ".", "getAcceptedIssuers", "(", ");", "}", "return", "new", "X509Certificate", "[", "0", "]", ";", "}", "}", "@", "@", "-", "35", ",", "4", "+", "35", ",", "15", "@", "@", "public", "void", "testProcess", "(", ")", "throws", "Exception", "{", "process", ".", "setBaseUrl", "(", "\"", "ldaps", ":", "//", "localhost", ":", "636", "\"", ");", "assertEquals", "(", "ProcessLdapProperties", ".", "SKIP_SSL_VERIFICATION_SOCKET_FACTORY", ",", "process", ".", "process", "(", "properties", ")", ".", "get", "(", "LDAP_SOCKET_FACTORY", ")", ");", "}", "}", "\\", "No", "newline", "at", "end", "of", "file", "@", "Test", "public", "void", "process_whenSslValidationIsEnabled", "(", ")", "throws", "Exception", "{", "Map", "<", "String", ",", "String", ">", "properties", "=", "new", "HashMap", "<", ">(", ");", "ProcessLdapProperties", "process", "=", "new", "ProcessLdapProperties", "(", "\"", "ldap", ":", "//", "localhost", ":", "389", "\"", ",", "false", ")", ";", "assertNull", "(", "process", ".", "process", "(", "properties", ")", ".", "get", "(", "LDAP_SOCKET_FACTORY", ")", ");", "process", ".", "setDisableSslVerification", "(", "false", ")", ";", "assertNull", "(", "process", ".", "process", "(", "properties", ")", ".", "get", "(", "LDAP_SOCKET_FACTORY", ")", ");", "process", ".", "setBaseUrl", "(", "\"", "ldaps", ":", "//", "localhost", ":", "636", "\"", ");", "assertEquals", "(", "ProcessLdapProperties", ".", "EXPIRY_CHECKING_SOCKET_FACTORY", ",", "process", ".", "process", "(", "properties", ")", ".", "get", "(", "LDAP_SOCKET_FACTORY", ")", ");", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "7", "@", "@", "package", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "security", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "*;", "public", "class", "LdapSocketFactoryTest", "{", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "59", "@", "@", "package", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "security", ";", "import", "org", ".", "junit", ".", "Assert", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "mockito", ".", "Mockito", ";", "import", "org", ".", "springframework", ".", "security", ".", "saml", ".", "trust", ".", "X509TrustManager", ";", "import", "java", ".", "security", ".", "cert", ".", "CertificateExpiredException", ";", "import", "java", ".", "security", ".", "cert", ".", "X509Certificate", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doNothing", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "doThrow", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "verify", ";", "public", "class", "X509ExpiryCheckingTrustManagerTest", "{", "@", "Test", "public", "void", "checkServerTrusted_throwsExceptionWhenCertIsExpired", "(", ")", "throws", "Exception", "{", "X509ExpiryCheckingTrustManager", "manager", "=", "new", "X509ExpiryCheckingTrustManager", "(", ");", "X509TrustManager", "mockedDelegate", "=", "Mockito", ".", "mock", "(", "X509TrustManager", ".", "class", ")", ";", "manager", ".", "setDelegate", "(", "mockedDelegate", ")", ";", "X509Certificate", "certificate", "=", "Mockito", ".", "mock", "(", "X509Certificate", ".", "class", ")", ";", "X509Certificate", "[", "]", "x509Certificates", "=", "{", "certificate", "}", ";", "doNothing", "(", ").", "when", "(", "mockedDelegate", ")", ".", "checkServerTrusted", "(", "x509Certificates", ",", "\"", "string", "\"", ");", "doThrow", "(", "new", "CertificateExpiredException", "(", "))", ".", "when", "(", "certificate", ")", ".", "checkValidity", "(", ");", "try", "{", "manager", ".", "checkServerTrusted", "(", "x509Certificates", ",", "\"", "string", "\"", ");", "Assert", ".", "fail", "(", ");", "}", "catch", "(", "CertificateExpiredException", "e", ")", "{", "verify", "(", "mockedDelegate", ")", ".", "checkServerTrusted", "(", "x509Certificates", ",", "\"", "string", "\"", ");", "verify", "(", "certificate", ")", ".", "checkValidity", "(", ");", "}", "}", "@", "Test", "public", "void", "checkClientTrusted_callsDelegate", "(", ")", "throws", "Exception", "{", "X509ExpiryCheckingTrustManager", "manager", "=", "new", "X509ExpiryCheckingTrustManager", "(", ");", "X509TrustManager", "mockedDelegate", "=", "Mockito", ".", "mock", "(", "X509TrustManager", ".", "class", ")", ";", "manager", ".", "setDelegate", "(", "mockedDelegate", ")", ";", "X509Certificate", "certificate", "=", "Mockito", ".", "mock", "(", "X509Certificate", ".", "class", ")", ";", "X509Certificate", "[", "]", "x509Certificates", "=", "{", "certificate", "}", ";", "doNothing", "(", ").", "when", "(", "mockedDelegate", ")", ".", "checkClientTrusted", "(", "x509Certificates", ",", "\"", "string", "\"", ");", "manager", ".", "checkClientTrusted", "(", "x509Certificates", ",", "\"", "string", "\"", ");", "verify", "(", "mockedDelegate", ")", ".", "checkClientTrusted", "(", "x509Certificates", ",", "\"", "string", "\"", ");", "}", "@", "Test", "public", "void", "checkAcceptedIssuers_callsDelegate", "(", ")", "throws", "Exception", "{", "X509ExpiryCheckingTrustManager", "manager", "=", "new", "X509ExpiryCheckingTrustManager", "(", ");", "X509TrustManager", "mockedDelegate", "=", "Mockito", ".", "mock", "(", "X509TrustManager", ".", "class", ")", ";", "manager", ".", "setDelegate", "(", "mockedDelegate", ")", ";", "manager", ".", "getAcceptedIssuers", "(", ");", "verify", "(", "mockedDelegate", ")", ".", "getAcceptedIssuers", "(", ");", "}", "}", "@", "@", "-", "1", ",", "8", "+", "1", ",", "8", "@", "@", "#", "Configuration", "in", "this", "file", "is", "overridden", "by", "an", "external", "file", "#", "Configuration", "in", "this", "file", "ixs", "overridden", "by", "an", "external", "file", "#", "if", "any", "of", "these", "exist", ":", "#", "[", "$", "UAA_CONFIG_URL", ",", "$", "UAA_CONFIG_PATH", "/", "uaa", ".", "yml", ",", "$", "CLOUD_FOUNDRY_CONFIG_PATH", "/", "uaa", ".", "yml", "]", "#", "spring_profiles", ":", "mysql", ",", "default", "#", "spring_profiles", ":", "mysql", ",", "default", ",", "ldap", "#", "spring_profiles", ":", "postgresql", ",", "default", "#", "spring_profiles", ":", "ldap", ",", "default", ",", "hsqldb", "#", "spring_profiles", ":", "saml", "@", "@", "-", "0", ",", "0", "+", "1", ",", "195", "@", "@", "package", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "integration", ".", "feature", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "ServerRunning", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "constants", ".", "OriginKeys", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "integration", ".", "util", ".", "IntegrationTestUtils", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "integration", ".", "util", ".", "ScreenshotOnFail", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "login", ".", "test", ".", "LoginServerClassRunner", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "provider", ".", "IdentityProvider", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "provider", ".", "LdapIdentityProviderDefinition", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "scim", ".", "ScimUser", ";", "import", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "test", ".", "UaaTestAccounts", ";", "import", "org", ".", "hamcrest", ".", "Matchers", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Rule", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", ";", "import", "org", ".", "openqa", ".", "selenium", ".", "By", ";", "import", "org", ".", "openqa", ".", "selenium", ".", "WebDriver", ";", "import", "org", ".", "springframework", ".", "beans", ".", "factory", ".", "annotation", ".", "Autowired", ";", "import", "org", ".", "springframework", ".", "beans", ".", "factory", ".", "annotation", ".", "Value", ";", "import", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "client", ".", "test", ".", "TestAccounts", ";", "import", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "common", ".", "util", ".", "RandomValueStringGenerator", ";", "import", "org", ".", "springframework", ".", "test", ".", "context", ".", "ContextConfiguration", ";", "import", "org", ".", "springframework", ".", "web", ".", "client", ".", "RestOperations", ";", "import", "org", ".", "springframework", ".", "web", ".", "client", ".", "RestTemplate", ";", "import", "static", "org", ".", "cloudfoundry", ".", "identity", ".", "uaa", ".", "integration", ".", "util", ".", "IntegrationTestUtils", ".", "doesSupportZoneDNS", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertThat", ";", "import", "static", "org", ".", "junit", ".", "Assume", ".", "assumeTrue", ";", "@", "RunWith", "(", "LoginServerClassRunner", ".", "class", ")", "@", "ContextConfiguration", "(", "classes", "=", "DefaultIntegrationTestConfig", ".", "class", ")", "public", "class", "LdapLoginIT", "{", "@", "Autowired", "@", "Rule", "public", "IntegrationTestRule", "integrationTestRule", ";", "@", "Rule", "public", "ScreenshotOnFail", "screenShootRule", "=", "new", "ScreenshotOnFail", "(", ");", "@", "Autowired", "RestOperations", "restOperations", ";", "@", "Autowired", "WebDriver", "webDriver", ";", "@", "Value", "(", "\"$", "{", "integration", ".", "test", ".", "base_url", "}", "\")", "String", "baseUrl", ";", "@", "Autowired", "TestClient", "testClient", ";", "ServerRunning", "serverRunning", "=", "ServerRunning", ".", "isRunning", "(", ");", "@", "Before", "public", "void", "clearWebDriverOfCookies", "(", ")", "throws", "Exception", "{", "screenShootRule", ".", "setWebDriver", "(", "webDriver", ")", ";", "webDriver", ".", "get", "(", "baseUrl", "+", "\"", "/", "logout", ".", "do", "\"", ");", "webDriver", ".", "get", "(", "baseUrl", ".", "replace", "(", "\"", "localhost", "\"", ",", "\"", "testzone1", ".", "localhost", "\"", ")", "+", "\"", "/", "logout", ".", "do", "\"", ");", "webDriver", ".", "get", "(", "baseUrl", ".", "replace", "(", "\"", "localhost", "\"", ",", "\"", "testzone2", ".", "localhost", "\"", ")", "+", "\"", "/", "logout", ".", "do", "\"", ");", "webDriver", ".", "manage", "(", ").", "deleteAllCookies", "(", ");", "}", "@", "Test", "public", "void", "ldapLogin_withValidSelfSignedCert", "(", ")", "throws", "Exception", "{", "/", "/", "ensure", "we", "are", "able", "to", "resolve", "DNS", "for", "hostname", "testzone2", ".", "localhost", "assumeTrue", "(", "\"", "Expected", "testzone1", "/", "2", "/", "3", "/", "4", ".", "localhost", "to", "resolve", "to", "127", ".", "0", ".", "0", ".", "1", "\"", ",", "doesSupportZoneDNS", "(", "))", ";", "String", "zoneId", "=", "\"", "testzone2", "\"", ";", "String", "zoneUrl", "=", "baseUrl", ".", "replace", "(", "\"", "localhost", "\"", ",", "\"", "testzone2", ".", "localhost", "\"", ");", "/", "/", "identity", "client", "token", "RestTemplate", "identityClient", "=", "IntegrationTestUtils", ".", "getClientCredentialsTemplate", "(", "IntegrationTestUtils", ".", "getClientCredentialsResource", "(", "baseUrl", ",", "new", "String", "[", "]{", "\"", "zones", ".", "write", "\"", ",", "\"", "zones", ".", "read", "\"", ",", "\"", "scim", ".", "zones", "\"", "},", "\"", "identity", "\"", ",", "\"", "identitysecret", "\"", ")", ")", ";", "/", "/", "admin", "client", "token", "-", "to", "create", "users", "RestTemplate", "adminClient", "=", "IntegrationTestUtils", ".", "getClientCredentialsTemplate", "(", "IntegrationTestUtils", ".", "getClientCredentialsResource", "(", "baseUrl", ",", "new", "String", "[", "0", "]", ",", "\"", "admin", "\"", ",", "\"", "adminsecret", "\"", ")", ")", ";", "/", "/", "create", "the", "zone", "IntegrationTestUtils", ".", "createZoneOrUpdateSubdomain", "(", "identityClient", ",", "baseUrl", ",", "zoneId", ",", "zoneId", ")", ";", "/", "/", "create", "a", "zone", "admin", "user", "String", "email", "=", "new", "RandomValueStringGenerator", "(", ").", "generate", "(", ")", "+", "\"@", "samltesting", ".", "org", "\"", ";", "ScimUser", "user", "=", "IntegrationTestUtils", ".", "createUser", "(", "adminClient", ",", "baseUrl", ",", "email", ",", "\"", "firstname", "\"", ",", "\"", "lastname", "\"", ",", "email", ",", "true", ")", ";", "IntegrationTestUtils", ".", "makeZoneAdmin", "(", "identityClient", ",", "baseUrl", ",", "user", ".", "getId", "(", "),", "zoneId", ")", ";", "/", "/", "get", "the", "zone", "admin", "token", "String", "zoneAdminToken", "=", "IntegrationTestUtils", ".", "getAuthorizationCodeToken", "(", "serverRunning", ",", "UaaTestAccounts", ".", "standard", "(", "serverRunning", ")", ",", "\"", "identity", "\"", ",", "\"", "identitysecret", "\"", ",", "email", ",", "\"", "secr3T", "\"", ");", "LdapIdentityProviderDefinition", "ldapIdentityProviderDefinition", "=", "LdapIdentityProviderDefinition", ".", "searchAndBindMapGroupToScopes", "(", "\"", "ldaps", ":", "//", "52", ".", "87", ".", "212", ".", "253", ":", "636", "/", "\",", "\"", "cn", "=", "admin", ",", "dc", "=", "test", ",", "dc", "=", "com", "\"", ",", "\"", "password", "\"", ",", "\"", "dc", "=", "test", ",", "dc", "=", "com", "\"", ",", "\"", "cn", "=", "{", "0", "}", "\",", "\"", "ou", "=", "scopes", ",", "dc", "=", "test", ",", "dc", "=", "com", "\"", ",", "\"", "member", "=", "{", "0", "}", "\",", "\"", "mail", "\"", ",", "null", ",", "false", ",", "true", ",", "true", ",", "100", ",", "false", ")", ";", "IdentityProvider", "provider", "=", "new", "IdentityProvider", "(", ");", "provider", ".", "setIdentityZoneId", "(", "zoneId", ")", ";", "provider", ".", "setType", "(", "OriginKeys", ".", "LDAP", ")", ";", "provider", ".", "setActive", "(", "true", ")", ";", "provider", ".", "setConfig", "(", "ldapIdentityProviderDefinition", ")", ";", "provider", ".", "setOriginKey", "(", "OriginKeys", ".", "LDAP", ")", ";", "provider", ".", "setName", "(", "\"", "simplesamlphp", "for", "uaa", "\"", ");", "provider", "=", "IntegrationTestUtils", ".", "createOrUpdateProvider", "(", "zoneAdminToken", ",", "baseUrl", ",", "provider", ")", ";", "webDriver", ".", "get", "(", "zoneUrl", "+", "\"", "/", "login", "\"", ");", "webDriver", ".", "findElement", "(", "By", ".", "name", "(", "\"", "username", "\"", "))", ".", "sendKeys", "(", "\"", "marissa4", "\"", ");", "webDriver", ".", "findElement", "(", "By", ".", "name", "(", "\"", "password", "\"", "))", ".", "sendKeys", "(", "\"", "ldap4", "\"", ");", "webDriver", ".", "findElement", "(", "By", ".", "xpath", "(", "\"/", "/", "input", "[", "@", "value", "=", "'", "Sign", "in", "'", "]\"", "))", ".", "click", "(", ");", "assertThat", "(", "webDriver", ".", "findElement", "(", "By", ".", "cssSelector", "(", "\"", "h1", "\"", "))", ".", "getText", "(", "),", "Matchers", ".", "containsString", "(", "\"", "Where", "to", "\"", "))", ";", "}", "@", "Test", "public", "void", "ldapLogin_withExpiredSelfSignedCert", "(", ")", "throws", "Exception", "{", "/", "/", "ensure", "we", "are", "able", "to", "resolve", "DNS", "for", "hostname", "testzone1", ".", "localhost", "assumeTrue", "(", "\"", "Expected", "testzone1", "/", "2", "/", "3", "/", "4", ".", "localhost", "to", "resolve", "to", "127", ".", "0", ".", "0", ".", "1", "\"", ",", "doesSupportZoneDNS", "(", "))", ";", "String", "zoneId", "=", "\"", "testzone1", "\"", ";", "String", "zoneUrl", "=", "baseUrl", ".", "replace", "(", "\"", "localhost", "\"", ",", "\"", "testzone1", ".", "localhost", "\"", ");", "/", "/", "identity", "client", "token", "RestTemplate", "identityClient", "=", "IntegrationTestUtils", ".", "getClientCredentialsTemplate", "(", "IntegrationTestUtils", ".", "getClientCredentialsResource", "(", "baseUrl", ",", "new", "String", "[", "]{", "\"", "zones", ".", "write", "\"", ",", "\"", "zones", ".", "read", "\"", ",", "\"", "scim", ".", "zones", "\"", "},", "\"", "identity", "\"", ",", "\"", "identitysecret", "\"", ")", ")", ";", "/", "/", "admin", "client", "token", "-", "to", "create", "users", "RestTemplate", "adminClient", "=", "IntegrationTestUtils", ".", "getClientCredentialsTemplate", "(", "IntegrationTestUtils", ".", "getClientCredentialsResource", "(", "baseUrl", ",", "new", "String", "[", "0", "]", ",", "\"", "admin", "\"", ",", "\"", "adminsecret", "\"", ")", ")", ";", "/", "/", "create", "the", "zone", "IntegrationTestUtils", ".", "createZoneOrUpdateSubdomain", "(", "identityClient", ",", "baseUrl", ",", "zoneId", ",", "zoneId", ")", ";", "/", "/", "create", "a", "zone", "admin", "user", "String", "email", "=", "new", "RandomValueStringGenerator", "(", ").", "generate", "(", ")", "+", "\"@", "samltesting", ".", "org", "\"", ";", "ScimUser", "user", "=", "IntegrationTestUtils", ".", "createUser", "(", "adminClient", ",", "baseUrl", ",", "email", ",", "\"", "firstname", "\"", ",", "\"", "lastname", "\"", ",", "email", ",", "true", ")", ";", "IntegrationTestUtils", ".", "makeZoneAdmin", "(", "identityClient", ",", "baseUrl", ",", "user", ".", "getId", "(", "),", "zoneId", ")", ";", "/", "/", "get", "the", "zone", "admin", "token", "String", "zoneAdminToken", "=", "IntegrationTestUtils", ".", "getAuthorizationCodeToken", "(", "serverRunning", ",", "UaaTestAccounts", ".", "standard", "(", "serverRunning", ")", ",", "\"", "identity", "\"", ",", "\"", "identitysecret", "\"", ",", "email", ",", "\"", "secr3T", "\"", ");", "LdapIdentityProviderDefinition", "ldapIdentityProviderDefinition", "=", "LdapIdentityProviderDefinition", ".", "searchAndBindMapGroupToScopes", "(", "\"", "ldaps", ":", "//", "52", ".", "20", ".", "5", ".", "106", ":", "636", "/", "\",", "\"", "cn", "=", "admin", ",", "dc", "=", "test", ",", "dc", "=", "com", "\"", ",", "\"", "password", "\"", ",", "\"", "dc", "=", "test", ",", "dc", "=", "com", "\"", ",", "\"", "cn", "=", "{", "0", "}", "\",", "\"", "ou", "=", "scopes", ",", "dc", "=", "test", ",", "dc", "=", "com", "\"", ",", "\"", "member", "=", "{", "0", "}", "\",", "\"", "mail", "\"", ",", "null", ",", "false", ",", "true", ",", "true", ",", "100", ",", "false", ")", ";", "IdentityProvider", "provider", "=", "new", "IdentityProvider", "(", ");", "provider", ".", "setIdentityZoneId", "(", "zoneId", ")", ";", "provider", ".", "setType", "(", "OriginKeys", ".", "LDAP", ")", ";", "provider", ".", "setActive", "(", "true", ")", ";", "provider", ".", "setConfig", "(", "ldapIdentityProviderDefinition", ")", ";", "provider", ".", "setOriginKey", "(", "OriginKeys", ".", "LDAP", ")", ";", "provider", ".", "setName", "(", "\"", "simplesamlphp", "for", "uaa", "\"", ");", "provider", "=", "IntegrationTestUtils", ".", "createOrUpdateProvider", "(", "zoneAdminToken", ",", "baseUrl", ",", "provider", ")", ";", "webDriver", ".", "get", "(", "zoneUrl", "+", "\"", "/", "login", "\"", ");", "webDriver", ".", "findElement", "(", "By", ".", "name", "(", "\"", "username", "\"", "))", ".", "sendKeys", "(", "\"", "marissa4", "\"", ");", "webDriver", ".", "findElement", "(", "By", ".", "name", "(", "\"", "password", "\"", "))", ".", "sendKeys", "(", "\"", "ldap4", "\"", ");", "webDriver", ".", "findElement", "(", "By", ".", "xpath", "(", "\"/", "/", "input", "[", "@", "value", "=", "'", "Sign", "in", "'", "]\"", "))", ".", "click", "(", ");", "assertThat", "(", "webDriver", ".", "findElement", "(", "By", ".", "cssSelector", "(", "\"", "h1", "\"", "))", ".", "getText", "(", "),", "Matchers", ".", "containsString", "(", "\"", "Welcome", "to", "The", "Twiglet", "Zone", "[", "\"", "+", "zoneId", "+", "\"", "]!", "\")", ");", "}", "}"], "docstring_tokens": ["improper", "validation", "of", "certificate", "expiration"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "3648", ",", "19", "+", "3648", ",", "25", "@", "@", "packet_setsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optv", "if", "(", "optlen", "!", "=", "sizeof", "(", "val", ")", ")", "return", "-", "EINVAL", ";", "if", "(", "po", "-", ">", "rx_ring", ".", "pg_vec", "|", "|", "po", "-", ">", "tx_ring", ".", "pg_vec", ")", "return", "-", "EBUSY", ";", "if", "(", "copy_from_user", "(", "&", "val", ",", "optval", ",", "sizeof", "(", "val", ")", "))", "return", "-", "EFAULT", ";", "switch", "(", "val", ")", "{", "case", "TPACKET_V1", ":", "case", "TPACKET_V2", ":", "case", "TPACKET_V3", ":", "po", "-", ">", "tp_version", "=", "val", ";", "return", "0", ";", "break", ";", "default", ":", "return", "-", "EINVAL", ";", "}", "lock_sock", "(", "sk", ")", ";", "if", "(", "po", "-", ">", "rx_ring", ".", "pg_vec", "|", "|", "po", "-", ">", "tx_ring", ".", "pg_vec", ")", "{", "ret", "=", "-", "EBUSY", ";", "}", "else", "{", "po", "-", ">", "tp_version", "=", "val", ";", "ret", "=", "0", ";", "}", "release_sock", "(", "sk", ")", ";", "return", "ret", ";", "}", "case", "PACKET_RESERVE", ":", "{", "@", "@", "-", "4164", ",", "6", "+", "4170", ",", "7", "@", "@", "static", "int", "packet_set_ring", "(", "struct", "sock", "*", "sk", ",", "union", "tpacket_req_u", "*", "req_u", ",", "/", "*", "Added", "to", "avoid", "minimal", "code", "churn", "*", "/", "struct", "tpacket_req", "*", "req", "=", "&", "req_u", "-", ">", "req", ";", "lock_sock", "(", "sk", ")", ";", "/", "*", "Opening", "a", "Tx", "-", "ring", "is", "NOT", "supported", "in", "TPACKET_V3", "*", "/", "if", "(", "!", "closing", "&", "&", "tx_ring", "&", "&", "(", "po", "-", ">", "tp_version", ">", "TPACKET_V2", ")", ")", "{", "net_warn_ratelimited", "(", "\"", "Tx", "-", "ring", "is", "not", "supported", ".", "\\", "n", "\"", ");", "@", "@", "-", "4245", ",", "7", "+", "4252", ",", "6", "@", "@", "static", "int", "packet_set_ring", "(", "struct", "sock", "*", "sk", ",", "union", "tpacket_req_u", "*", "req_u", ",", "goto", "out", ";", "}", "lock_sock", "(", "sk", ")", ";", "/", "*", "Detach", "socket", "from", "network", "*", "/", "spin_lock", "(", "&", "po", "-", ">", "bind_lock", ")", ";", "@", "@", "-", "4294", ",", "11", "+", "4300", ",", "11", "@", "@", "static", "int", "packet_set_ring", "(", "struct", "sock", "*", "sk", ",", "union", "tpacket_req_u", "*", "req_u", ",", "if", "(", "!", "tx_ring", ")", "prb_shutdown_retire_blk_timer", "(", "po", ",", "rb_queue", ")", ";", "}", "release_sock", "(", "sk", ")", ";", "if", "(", "pg_vec", ")", "free_pg_vec", "(", "pg_vec", ",", "order", ",", "req", "-", ">", "tp_block_nr", ")", ";", "out", ":", "release_sock", "(", "sk", ")", ";", "return", "err", ";", "}"], "docstring_tokens": ["reading", "code", "paths", "that", "have", "been", "opened", "up", "by", "the", "emergence", "of", "unprivileged", "namespaces"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "188", ",", "7", "+", "188", ",", "7", "@", "@", "static", "int", "____call_usermodehelper", "(", "void", "*", "data", ")", "/", "*", "Exec", "failed", "?", "*", "/", "fail", ":", "sub_info", "-", ">", "retval", "=", "retval", ";", "do_exit", "(", "0", ")", ";", "return", "0", ";", "}", "void", "call_usermodehelper_freeinfo", "(", "struct", "subprocess_info", "*", "info", ")"], "docstring_tokens": ["does", "not", "set", "a", "certain", "killable", "attribute"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "64", ",", "26", "+", "64", ",", "13", "@", "@", "int", "lg2ff_init", "(", "struct", "hid_device", "*", "hid", ")", "struct", "hid_report", "*", "report", ";", "struct", "hid_input", "*", "hidinput", "=", "list_entry", "(", "hid", "-", ">", "inputs", ".", "next", ",", "struct", "hid_input", ",", "list", ")", ";", "struct", "list_head", "*", "report_list", "=", "&", "hid", "-", ">", "report_enum", "[", "HID_OUTPUT_REPORT", "]", ".", "report_list", ";", "struct", "input_dev", "*", "dev", "=", "hidinput", "-", ">", "input", ";", "int", "error", ";", "if", "(", "list_empty", "(", "report_list", ")", ")", "{", "hid_err", "(", "hid", ",", "\"", "no", "output", "report", "found", "\\", "n", "\"", ");", "/", "*", "Check", "that", "the", "report", "looks", "ok", "*", "/", "report", "=", "hid_validate_values", "(", "hid", ",", "HID_OUTPUT_REPORT", ",", "0", ",", "0", ",", "7", ")", ";", "if", "(", "!", "report", ")", "return", "-", "ENODEV", ";", "}", "report", "=", "list_entry", "(", "report_list", "-", ">", "next", ",", "struct", "hid_report", ",", "list", ")", ";", "if", "(", "report", "-", ">", "maxfield", "<", "1", ")", "{", "hid_err", "(", "hid", ",", "\"", "output", "report", "is", "empty", "\\", "n", "\"", ");", "return", "-", "ENODEV", ";", "}", "if", "(", "report", "-", ">", "field", "[", "0", "]", "->", "report_count", "<", "7", ")", "{", "hid_err", "(", "hid", ",", "\"", "not", "enough", "values", "in", "the", "field", "\\", "n", "\"", ");", "return", "-", "ENODEV", ";", "}", "lg2ff", "=", "kmalloc", "(", "sizeof", "(", "struct", "lg2ff_device", ")", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "lg2ff", ")", "@", "@", "-", "66", ",", "10", "+", "66", ",", "11", "@", "@", "static", "int", "hid_lg3ff_play", "(", "struct", "input_dev", "*", "dev", ",", "void", "*", "data", ",", "int", "x", ",", "y", ";", "/", "*", "*", "Maxusage", "should", "always", "be", "63", "(", "maximum", "fields", ")", "*", "likely", "a", "better", "way", "to", "ensure", "this", "data", "is", "clean", "*", "Available", "values", "in", "the", "field", "should", "always", "be", "63", ",", "but", "we", "only", "use", "up", "to", "*", "35", ".", "Instead", ",", "clear", "the", "entire", "area", ",", "however", "big", "it", "is", ".", "*", "/", "memset", "(", "report", "-", ">", "field", "[", "0", "]", "->", "value", ",", "0", ",", "sizeof", "(", "__s32", ")", "*", "report", "-", ">", "field", "[", "0", "]", "->", "maxusage", ")", ";", "memset", "(", "report", "-", ">", "field", "[", "0", "]", "->", "value", ",", "0", ",", "sizeof", "(", "__s32", ")", "*", "report", "-", ">", "field", "[", "0", "]", "->", "report_count", ")", ";", "switch", "(", "effect", "-", ">", "type", ")", "{", "case", "FF_CONSTANT", ":", "@", "@", "-", "129", ",", "32", "+", "130", ",", "14", "@", "@", "static", "const", "signed", "short", "ff3_joystick_ac", "[", "]", "=", "{", "int", "lg3ff_init", "(", "struct", "hid_device", "*", "hid", ")", "{", "struct", "hid_input", "*", "hidinput", "=", "list_entry", "(", "hid", "-", ">", "inputs", ".", "next", ",", "struct", "hid_input", ",", "list", ")", ";", "struct", "list_head", "*", "report_list", "=", "&", "hid", "-", ">", "report_enum", "[", "HID_OUTPUT_REPORT", "]", ".", "report_list", ";", "struct", "input_dev", "*", "dev", "=", "hidinput", "-", ">", "input", ";", "struct", "hid_report", "*", "report", ";", "struct", "hid_field", "*", "field", ";", "const", "signed", "short", "*", "ff_bits", "=", "ff3_joystick_ac", ";", "int", "error", ";", "int", "i", ";", "/", "*", "Find", "the", "report", "to", "use", "*", "/", "if", "(", "list_empty", "(", "report_list", ")", ")", "{", "hid_err", "(", "hid", ",", "\"", "No", "output", "report", "found", "\\", "n", "\"", ");", "return", "-", "1", ";", "}", "/", "*", "Check", "that", "the", "report", "looks", "ok", "*", "/", "report", "=", "list_entry", "(", "report_list", "-", ">", "next", ",", "struct", "hid_report", ",", "list", ")", ";", "if", "(", "!", "report", ")", "{", "hid_err", "(", "hid", ",", "\"", "NULL", "output", "report", "\\", "n", "\"", ");", "return", "-", "1", ";", "}", "field", "=", "report", "-", ">", "field", "[", "0", "]", ";", "if", "(", "!", "field", ")", "{", "hid_err", "(", "hid", ",", "\"", "NULL", "field", "\\", "n", "\"", ");", "return", "-", "1", ";", "}", "if", "(", "!", "hid_validate_values", "(", "hid", ",", "HID_OUTPUT_REPORT", ",", "0", ",", "0", ",", "35", ")", ")", "return", "-", "ENODEV", ";", "/", "*", "Assume", "single", "fixed", "device", "G940", "*", "/", "for", "(", "i", "=", "0", ";", "ff_bits", "[", "i", "]", ">", "=", "0", ";", "i", "+", "+)", "@", "@", "-", "484", ",", "34", "+", "484", ",", "16", "@", "@", "static", "enum", "led_brightness", "lg4ff_led_get_brightness", "(", "struct", "led_classdev", "*", "led_cde", "int", "lg4ff_init", "(", "struct", "hid_device", "*", "hid", ")", "{", "struct", "hid_input", "*", "hidinput", "=", "list_entry", "(", "hid", "-", ">", "inputs", ".", "next", ",", "struct", "hid_input", ",", "list", ")", ";", "struct", "list_head", "*", "report_list", "=", "&", "hid", "-", ">", "report_enum", "[", "HID_OUTPUT_REPORT", "]", ".", "report_list", ";", "struct", "input_dev", "*", "dev", "=", "hidinput", "-", ">", "input", ";", "struct", "hid_report", "*", "report", ";", "struct", "hid_field", "*", "field", ";", "struct", "lg4ff_device_entry", "*", "entry", ";", "struct", "lg_drv_data", "*", "drv_data", ";", "struct", "usb_device_descriptor", "*", "udesc", ";", "int", "error", ",", "i", ",", "j", ";", "__u16", "bcdDevice", ",", "rev_maj", ",", "rev_min", ";", "/", "*", "Find", "the", "report", "to", "use", "*", "/", "if", "(", "list_empty", "(", "report_list", ")", ")", "{", "hid_err", "(", "hid", ",", "\"", "No", "output", "report", "found", "\\", "n", "\"", ");", "return", "-", "1", ";", "}", "/", "*", "Check", "that", "the", "report", "looks", "ok", "*", "/", "report", "=", "list_entry", "(", "report_list", "-", ">", "next", ",", "struct", "hid_report", ",", "list", ")", ";", "if", "(", "!", "report", ")", "{", "hid_err", "(", "hid", ",", "\"", "NULL", "output", "report", "\\", "n", "\"", ");", "if", "(", "!", "hid_validate_values", "(", "hid", ",", "HID_OUTPUT_REPORT", ",", "0", ",", "0", ",", "7", ")", ")", "return", "-", "1", ";", "}", "field", "=", "report", "-", ">", "field", "[", "0", "]", ";", "if", "(", "!", "field", ")", "{", "hid_err", "(", "hid", ",", "\"", "NULL", "field", "\\", "n", "\"", ");", "return", "-", "1", ";", "}", "/", "*", "Check", "what", "wheel", "has", "been", "connected", "*", "/", "for", "(", "i", "=", "0", ";", "i", "<", "ARRAY_SIZE", "(", "lg4ff_devices", ")", ";", "i", "+", "+)", "{", "@", "@", "-", "128", ",", "27", "+", "128", ",", "14", "@", "@", "static", "void", "hid_lgff_set_autocenter", "(", "struct", "input_dev", "*", "dev", ",", "u16", "magnitude", ")", "int", "lgff_init", "(", "struct", "hid_device", "*", "hid", ")", "{", "struct", "hid_input", "*", "hidinput", "=", "list_entry", "(", "hid", "-", ">", "inputs", ".", "next", ",", "struct", "hid_input", ",", "list", ")", ";", "struct", "list_head", "*", "report_list", "=", "&", "hid", "-", ">", "report_enum", "[", "HID_OUTPUT_REPORT", "]", ".", "report_list", ";", "struct", "input_dev", "*", "dev", "=", "hidinput", "-", ">", "input", ";", "struct", "hid_report", "*", "report", ";", "struct", "hid_field", "*", "field", ";", "const", "signed", "short", "*", "ff_bits", "=", "ff_joystick", ";", "int", "error", ";", "int", "i", ";", "/", "*", "Find", "the", "report", "to", "use", "*", "/", "if", "(", "list_empty", "(", "report_list", ")", ")", "{", "hid_err", "(", "hid", ",", "\"", "No", "output", "report", "found", "\\", "n", "\"", ");", "return", "-", "1", ";", "}", "/", "*", "Check", "that", "the", "report", "looks", "ok", "*", "/", "report", "=", "list_entry", "(", "report_list", "-", ">", "next", ",", "struct", "hid_report", ",", "list", ")", ";", "field", "=", "report", "-", ">", "field", "[", "0", "]", ";", "if", "(", "!", "field", ")", "{", "hid_err", "(", "hid", ",", "\"", "NULL", "field", "\\", "n", "\"", ");", "return", "-", "1", ";", "}", "if", "(", "!", "hid_validate_values", "(", "hid", ",", "HID_OUTPUT_REPORT", ",", "0", ",", "0", ",", "7", ")", ")", "return", "-", "ENODEV", ";", "for", "(", "i", "=", "0", ";", "i", "<", "ARRAY_SIZE", "(", "devices", ")", ";", "i", "+", "+)", "{", "if", "(", "dev", "-", ">", "id", ".", "vendor", "=", "=", "devices", "[", "i", "]", ".", "idVendor", "&", "&"], "docstring_tokens": ["Requires", "CONFIG_HID", "Memory", "write", "via", "arbitrary", "heap", "array", "index"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "635", ",", "6", "+", "635", ",", "11", "@", "@", "<", "artifactId", ">", "jaxb", "-", "api", "<", "/", "artifactId", ">", "<", "version", ">", "${", "version", ".", "javax", ".", "xml", ".", "bind", ".", "api", "}", "</", "version", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "com", ".", "sun", ".", "xml", ".", "ws", "<", "/", "groupId", ">", "<", "artifactId", ">", "jaxws", "-", "rt", "<", "/", "artifactId", ">", "<", "version", ">", "${", "version", ".", "javax", ".", "xml", ".", "ws", ".", "jaxws", ".", "rt", "}", "</", "version", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "org", ".", "hibernate", "<", "/", "groupId", ">", "@", "@", "-", "1142", ",", "6", "+", "1147", ",", "7", "@", "@", "<", "version", ".", "javax", ".", "annotation", ".", "api", ">", "1", ".", "3", ".", "2", "<", "/", "version", ".", "javax", ".", "annotation", ".", "api", ">", "<", "version", ".", "javax", ".", "inject", ">", "2", ".", "4", ".", "0", "<", "/", "version", ".", "javax", ".", "inject", ">", "<", "version", ".", "javax", ".", "xml", ".", "bind", ".", "api", ">", "2", ".", "3", ".", "1", "<", "/", "version", ".", "javax", ".", "xml", ".", "bind", ".", "api", ">", "<", "version", ".", "javax", ".", "xml", ".", "ws", ".", "jaxws", ".", "rt", ">", "2", ".", "2", "<", "/", "version", ".", "javax", ".", "xml", ".", "ws", ".", "jaxws", ".", "rt", ">", "<!", "--", "Java", "5", "-", "->", "<", "version", ".", "jmock", ">", "1", ".", "0", ".", "1", "<", "/", "version", ".", "jmock", ">", "<", "version", ".", "joda", "-", "time", ">", "1", ".", "6", "<", "/", "version", ".", "joda", "-", "time", ">", "<", "version", ".", "junit", ">", "3", ".", "8", ".", "1", "<", "/", "version", ".", "junit", ">", "@", "@", "-", "1155", ",", "7", "+", "1161", ",", "7", "@", "@", "<", "version", ".", "org", ".", "jdom2", ">", "2", ".", "0", ".", "5", "<", "/", "version", ".", "org", ".", "jdom2", ">", "<", "version", ".", "org", ".", "json", ">", "20080701", "<", "/", "version", ".", "org", ".", "json", ">", "<", "version", ".", "org", ".", "openjdk", ".", "jmh", ">", "1", ".", "21", "<", "/", "version", ".", "org", ".", "openjdk", ".", "jmh", ">", "<", "version", ".", "org", ".", "ops4j", ".", "pax", ".", "exam", ">", "3", ".", "5", ".", "0", "<", "/", "version", ".", "org", ".", "ops4j", ".", "pax", ".", "exam", ">", "<!", "--", "java", "6", "-", "->", "<", "version", ".", "org", ".", "ops4j", ".", "pax", ".", "exam", ">", "3", ".", "5", ".", "0", "<", "/", "version", ".", "org", ".", "ops4j", ".", "pax", ".", "exam", ">", "<!", "--", "Java", "6", "-", "->", "<", "version", ".", "org", ".", "slf4j", ">", "1", ".", "6", ".", "1", "<", "/", "version", ".", "org", ".", "slf4j", ">", "<", "version", ".", "stax", ">", "1", ".", "2", ".", "0", "<", "/", "version", ".", "stax", ">", "<", "version", ".", "stax", ".", "api", ">", "1", ".", "0", ".", "1", "<", "/", "version", ".", "stax", ".", "api", ">", "@", "@", "-", "0", ",", "0", "+", "1", ",", "118", "@", "@", "<", "html", ">", "<", "!-", "-", "Copyright", "(", "C", ")", "2020", "XStream", "committers", ".", "All", "rights", "reserved", ".", "The", "software", "in", "this", "package", "is", "published", "under", "the", "terms", "of", "the", "BSD", "style", "license", "a", "copy", "of", "which", "has", "been", "included", "with", "this", "distribution", "in", "the", "LICENSE", ".", "txt", "file", ".", "Created", "on", "06", ".", "December", "2020", "by", "Joerg", "Schaible", "-", "->", "<", "head", ">", "<", "title", ">", "CVE", "-", "2020", "-", "26259", "<", "/", "title", ">", "<", "/", "head", ">", "<", "body", ">", "<", "h2", "id", "=", "\"", "vulnerability", "\"", ">", "Vulnerability", "<", "/", "h2", ">", "<", "p", ">", "CVE", "-", "2020", "-", "26259", ":", "XStream", "is", "vulnerable", "to", "an", "Arbitrary", "File", "Deletion", "on", "the", "local", "host", "when", "unmarshalling", "as", "long", "as", "the", "executing", "process", "has", "sufficient", "rights", ".", "</", "p", ">", "<", "h2", "id", "=", "\"", "affected_versions", "\"", ">", "Affected", "Versions", "<", "/", "h2", ">", "<", "p", ">", "All", "versions", "until", "and", "including", "version", "1", ".", "4", ".", "14", "are", "affected", "running", "in", "a", "Java", "environment", "containing", "the", "JAX", "-", "WS", "runtime", ",", "if", "using", "the", "version", "out", "of", "the", "box", ".", "No", "user", "is", "affected", ",", "who", "followed", "the", "recommendation", "to", "setup", "<", "a", "href", "=", "\"", "security", ".", "html", "#", "framework", "\"", ">", "XStream", "'", "s", "security", "framework", "<", "/", "a", ">", "with", "a", "whitelist", ".", "</", "p", ">", "<", "h2", "id", "=", "\"", "description", "\"", ">", "Description", "<", "/", "h2", ">", "<", "p", ">", "The", "processed", "stream", "at", "unmarshalling", "time", "contains", "type", "information", "to", "recreate", "the", "formerly", "written", "objects", ".", "XStream", "creates", "therefore", "new", "instances", "based", "on", "these", "type", "information", ".", "An", "attacker", "can", "manipulate", "the", "processed", "input", "stream", "and", "replace", "or", "inject", "objects", ",", "that", "result", "in", "a", "server", "-", "side", "forgery", "request", ".", "</", "p", ">", "<", "h2", "id", "=", "\"", "reproduction", "\"", ">", "Steps", "to", "Reproduce", "<", "/", "h2", ">", "<", "p", ">", "Create", "a", "simple", "HashMap", "and", "use", "XStream", "to", "marshal", "it", "to", "XML", ".", "Replace", "the", "XML", "with", "following", "snippet", "and", "unmarshal", "it", "again", "with", "XStream", ":", "</", "p", ">", "<", "div", "class", "=", "\"", "Source", "XML", "\"", "><", "pre", ">", "&", "lt", ";", "map", "&", "gt", ";", "&", "lt", ";", "entry", "&", "gt", ";", "&", "lt", ";", "jdk", ".", "nashorn", ".", "internal", ".", "objects", ".", "NativeString", "&", "gt", ";", "&", "lt", ";", "flags", "&", "gt", ";", "0", "&", "lt", ";", "/", "flags", "&", "gt", ";", "&", "lt", ";", "value", "class", "=", "'", "com", ".", "sun", ".", "xml", ".", "internal", ".", "bind", ".", "v2", ".", "runtime", ".", "unmarshaller", ".", "Base64Data", "'", "&", "gt", ";", "&", "lt", ";", "dataHandler", "&", "gt", ";", "&", "lt", ";", "dataSource", "class", "=", "'", "com", ".", "sun", ".", "xml", ".", "internal", ".", "ws", ".", "encoding", ".", "xml", ".", "XMLMessage", "$", "XmlDataSource", "'", "&", "gt", ";", "&", "lt", ";", "contentType", "&", "gt", ";", "text", "/", "plain", "&", "lt", ";", "/", "contentType", "&", "gt", ";", "&", "lt", ";", "is", "class", "=", "'", "com", ".", "sun", ".", "xml", ".", "internal", ".", "ws", ".", "util", ".", "ReadAllStream", "$", "FileStream", "'", "&", "gt", ";", "&", "lt", ";", "tempFile", "&", "gt", ";", "/", "etc", "/", "hosts", "&", "lt", ";", "/", "tempFile", "&", "gt", ";", "&", "lt", ";", "/", "is", "&", "gt", ";", "&", "lt", ";", "/", "dataSource", "&", "gt", ";", "&", "lt", ";", "transferFlavors", "/", "&", "gt", ";", "&", "lt", ";", "/", "dataHandler", "&", "gt", ";", "&", "lt", ";", "dataLen", "&", "gt", ";", "0", "&", "lt", ";", "/", "dataLen", "&", "gt", ";", "&", "lt", ";", "/", "value", "&", "gt", ";", "&", "lt", ";", "/", "jdk", ".", "nashorn", ".", "internal", ".", "objects", ".", "NativeString", "&", "gt", ";", "&", "lt", ";", "string", "&", "gt", ";", "test", "&", "lt", ";", "/", "string", "&", "gt", ";", "&", "lt", ";", "/", "entry", "&", "gt", ";", "&", "lt", ";", "/", "map", "&", "gt", ";", "<", "/", "pre", ">", "</", "div", ">", "<", "div", "class", "=", "\"", "Source", "Java", "\"", "><", "pre", ">", "XStream", "xstream", "=", "new", "XStream", "(", ");", "xstream", ".", "fromXML", "(", "xml", ")", ";", "<", "/", "pre", ">", "</", "div", ">", "<", "p", ">", "As", "soon", "as", "the", "XML", "gets", "unmarshalled", ",", "the", "payload", "gets", "executed", "and", "the", "references", "file", "is", "deleted", ".", "</", "p", ">", "<", "p", ">", "Note", ",", "this", "example", "uses", "XML", ",", "but", "the", "attack", "can", "be", "performed", "for", "any", "supported", "format", ",", "e", ".", "g", ".", "JSON", ".", "</", "p", ">", "<", "h2", "id", "=", "\"", "impact", "\"", ">", "Impact", "<", "/", "h2", ">", "<", "p", ">", "The", "vulnerability", "may", "allow", "a", "remote", "attacker", "to", "delete", "arbitrary", "know", "files", "on", "the", "host", "as", "log", "as", "the", "executing", "process", "has", "sufficient", "rights", "only", "by", "manipulating", "the", "processed", "input", "stream", ".", "</", "p", ">", "<", "h2", "id", "=", "\"", "workaround", "\"", ">", "Workaround", "<", "/", "h2", ">", "<", "p", ">", "As", "recommended", ",", "use", "XStream", "'", "s", "security", "framework", "to", "implement", "a", "whitelist", "for", "the", "allowed", "types", ".", "</", "p", ">", "<", "p", ">", "Users", "of", "XStream", "1", ".", "4", ".", "14", "who", "insist", "to", "use", "XStream", "default", "blacklist", "-", "despite", "that", "clear", "recommendation", "-", "can", "simply", "add", "two", "lines", "to", "XStream", "'", "s", "setup", "code", ":", "</", "p", ">", "<", "div", "class", "=", "\"", "Source", "Java", "\"", "><", "pre", ">", "xstream", ".", "denyTypes", "(", "new", "String", "[", "]{", "\"", "jdk", ".", "nashorn", ".", "internal", ".", "objects", ".", "NativeString", "\"", "}", ");", "xstream", ".", "denyTypesByRegExp", "(", "new", "String", "[", "]{", "\"", ".*", "\\\\", ".", "ReadAllStream", "\\", "\\$", "FileStream", "\"", "}", ");", "<", "/", "pre", ">", "</", "div", ">", "<", "p", ">", "Users", "of", "XStream", "1", ".", "4", ".", "13", "who", "want", "to", "use", "XStream", "default", "blacklist", "can", "simply", "add", "three", "lines", "to", "XStream", "'", "s", "setup", "code", ":", "</", "p", ">", "<", "div", "class", "=", "\"", "Source", "Java", "\"", "><", "pre", ">", "xstream", ".", "denyTypes", "(", "new", "String", "[", "]{", "\"", "javax", ".", "imageio", ".", "ImageIO", "$", "ContainsFilter", "\"", ",", "\"", "jdk", ".", "nashorn", ".", "internal", ".", "objects", ".", "NativeString", "\"", "}", ");", "xstream", ".", "denyTypes", "(", "new", "Class", "[", "]{", "java", ".", "lang", ".", "ProcessBuilder", ".", "class", "}", ");", "xstream", ".", "denyTypesByRegExp", "(", "new", "String", "[", "]{", "\"", ".*", "\\\\", ".", "ReadAllStream", "\\", "\\$", "FileStream", "\"", "}", ");", "<", "/", "pre", ">", "</", "div", ">", "<", "p", ">", "Users", "of", "XStream", "1", ".", "4", ".", "12", "to", "1", ".", "4", ".", "7", "who", "want", "to", "use", "XStream", "with", "a", "blacklist", "will", "have", "to", "setup", "such", "a", "list", "from", "scratch", "and", "deny", "at", "least", "the", "following", "types", ":", "<", "em", ">", "javax", ".", "imageio", ".", "ImageIO", "$", "ContainsFilter", "<", "/", "em", ">", ",", "<", "em", ">", "java", ".", "beans", ".", "EventHandler", "<", "/", "em", ">", ",", "<", "em", ">", "java", ".", "lang", ".", "ProcessBuilder", "<", "/", "em", ">", ",", "<", "em", ">", "jdk", ".", "nashorn", ".", "internal", ".", "objects", ".", "NativeString", "<", "/", "em", ">", ",", "<", "em", ">", "java", ".", "lang", ".", "Void", "<", "/", "em", ">", "and", "<", "em", ">", "void", "<", "/", "em", ">", "and", "deny", "several", "types", "by", "name", "pattern", ".", "</", "p", ">", "<", "div", "class", "=", "\"", "Source", "Java", "\"", "><", "pre", ">", "xstream", ".", "denyTypes", "(", "new", "String", "[", "]{", "\"", "javax", ".", "imageio", ".", "ImageIO", "$", "ContainsFilter", "\"", ",", "\"", "jdk", ".", "nashorn", ".", "internal", ".", "objects", ".", "NativeString", "\"", "}", ");", "xstream", ".", "denyTypes", "(", "new", "Class", "[", "]{", "java", ".", "lang", ".", "ProcessBuilder", ".", "class", ",", "java", ".", "beans", ".", "EventHandler", ".", "class", ",", "java", ".", "lang", ".", "ProcessBuilder", ".", "class", ",", "java", ".", "lang", ".", "Void", ".", "class", ",", "void", ".", "class", "}", ");", "xstream", ".", "denyTypesByRegExp", "(", "new", "String", "[", "]{", "\"", ".*", "\\\\", "$", "LazyIterator", "\"", ",", "\"", "javax", "\\", "\\.", "crypto", "\\", "\\.", ".*", "\",", "\"", ".*", "\\\\", ".", "ReadAllStream", "\\", "\\$", "FileStream", "\"", "}", ");", "<", "/", "pre", ">", "</", "div", ">", "<", "p", ">", "Users", "of", "XStream", "1", ".", "4", ".", "6", "or", "below", "can", "register", "an", "own", "converter", "to", "prevent", "the", "unmarshalling", "of", "the", "currently", "know", "critical", "types", "of", "the", "Java", "runtime", ".", "It", "is", "in", "fact", "an", "updated", "version", "of", "the", "workaround", "for", "CVE", "-", "2013", "-", "7285", ":", "</", "p", ">", "<", "div", "class", "=", "\"", "Source", "Java", "\"", "><", "pre", ">", "xstream", ".", "registerConverter", "(", "new", "Converter", "(", ")", "{", "public", "boolean", "canConvert", "(", "Class", "type", ")", "{", "return", "type", "!", "=", "null", "&", "amp", ";", "&", "amp", ";", "(", "type", "=", "=", "java", ".", "beans", ".", "EventHandler", ".", "class", "|", "|", "type", "=", "=", "java", ".", "lang", ".", "ProcessBuilder", ".", "class", "|", "|", "type", ".", "getName", "(", ").", "equals", "(", "\"", "javax", ".", "imageio", ".", "ImageIO", "$", "ContainsFilter", "\"", ")", "|", "|", "type", ".", "getName", "(", ").", "equals", "(", "\"", "jdk", ".", "nashorn", ".", "internal", ".", "objects", ".", "NativeString", "\"", ")", "|", "|", "type", "=", "=", "java", ".", "lang", ".", "Void", ".", "class", "|", "|", "void", ".", "class", "|", "|", "Proxy", ".", "isProxy", "(", "type", ")", "|", "|", "type", ".", "getName", "(", ").", "startsWith", "(", "\"", "javax", ".", "crypto", ".", "\")", "|", "|", "type", ".", "getName", "(", ").", "endsWith", "(", "\"$", "LazyIterator", "\"", ")", "|", "|", "type", ".", "getName", "(", ").", "endsWith", "(", "\".", "ReadAllStream", "$", "FileStream", "\"", "))", ";", "}", "public", "Object", "unmarshal", "(", "HierarchicalStreamReader", "reader", ",", "UnmarshallingContext", "context", ")", "{", "throw", "new", "ConversionException", "(", "\"", "Unsupported", "type", "due", "to", "security", "reasons", ".", "\")", ";", "}", "public", "void", "marshal", "(", "Object", "source", ",", "HierarchicalStreamWriter", "writer", ",", "MarshallingContext", "context", ")", "{", "throw", "new", "ConversionException", "(", "\"", "Unsupported", "type", "due", "to", "security", "reasons", ".", "\")", ";", "}", "}", ",", "XStream", ".", "PRIORITY_LOW", ")", ";", "<", "/", "pre", ">", "</", "div", ">", "<", "h2", "id", "=", "\"", "credits", "\"", ">", "Credits", "<", "/", "h2", ">", "<", "p", ">", "\u949f\u6f66", "\u8d35", "(", "Liaogui", "Zhong", ")", "found", "and", "reported", "the", "issue", "to", "XStream", "and", "provided", "the", "required", "information", "to", "reproduce", "it", ".", "</", "p", ">", "<", "/", "body", ">", "<", "/", "html", ">", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "32", ",", "9", "+", "32", ",", "9", "@", "@", "<", "h1", "id", "=", "\"", "upcoming", "-", "1", ".", "4", ".", "x", "\"", ">", "Upcoming", "1", ".", "4", ".", "x", "maintenance", "release", "<", "/", "h1", ">", "<", "p", ">", "Not", "yet", "released", ".", "</", "p", ">", "<", "p", "class", "=", "\"", "highlight", "\"", ">", "This", "maintenance", "release", "addresses", "the", "security", "vulnerability", "<", "a", "href", "=", "\"", "CVE", "-", "2020", "-", "26258", ".", "html", "\"", ">", "CVE", "-", "2020", "-", "26258", "<", "/", "a", ">", ",", "when", "unmarshalling", "for", "XStream", "instances", "with", "uninitialized", "security", "framework", "in", "a", "Java", "runtime", "below", "Java", "15", ".", "</", "p", ">", "<", "p", "class", "=", "\"", "highlight", "\"", ">", "This", "maintenance", "release", "addresses", "the", "security", "vulnerabilities", "<", "a", "href", "=", "\"", "CVE", "-", "2020", "-", "26258", ".", "html", "\"", ">", "CVE", "-", "2020", "-", "26258", "<", "/", "a", ">", "and", "<", "a", "href", "=", "\"", "CVE", "-", "2020", "-", "26259", ".", "html", "\"", ">", "CVE", "-", "2020", "-", "26259", "<", "/", "a", ">", ",", "when", "unmarshalling", "for", "XStream", "instances", "with", "uninitialized", "security", "framework", ".", "</", "p", ">", "<", "h2", ">", "Minor", "changes", "<", "/", "h2", ">", "<", "ul", ">", "@", "@", "-", "44", ",", "9", "+", "44", ",", "9", "@", "@", "<", "h2", ">", "Minor", "changes", "<", "/", "h2", ">", "<", "h2", ">", "Stream", "compatibility", "<", "/", "h2", ">", "<", "ul", ">", "<", "li", ">", "The", "type", "jdk", ".", "nashorn", ".", "internal", ".", "objects", ".", "NativeString", "id", "now", "part", "of", "the", "default", "blacklist", "and", "the", "deserialization", "of", "XML", "containing", "one", "of", "the", "two", "types", "will", "fail", ".", "You", "will", "must", "enable", "these", "types", "by", "explicit", "configuration", ",", "if", "you", "need", "them", ".", "</", "li", ">", "<", "li", ">", "The", "type", "jdk", ".", "nashorn", ".", "internal", ".", "objects", ".", "NativeString", "and", "the", "internal", "JAX", "-", "WS", "type", "ReadAllStream", ".", "FileStream", "are", "now", "part", "of", "the", "default", "blacklist", "and", "the", "deserialization", "of", "XML", "containing", "one", "of", "the", "two", "types", "will", "fail", ".", "You", "will", "have", "to", "enable", "these", "types", "by", "explicit", "configuration", ",", "if", "you", "need", "them", ".", "</", "li", ">", "<", "/", "ul", ">", "<", "h2", ">", "Delivery", "<", "/", "h2", ">", "@", "@", "-", "77", ",", "8", "+", "77", ",", "8", "@", "@", "<", "h2", ">", "Stream", "compatibility", "<", "/", "h2", ">", "<", "ul", ">", "<", "li", ">", "The", "types", "java", ".", "lang", ".", "ProcessBuilder", "and", "javax", ".", "imageio", ".", "ImageIO", "$", "ContainsFilter", "are", "now", "part", "of", "the", "default", "blacklist", "and", "the", "deserialization", "of", "XML", "containing", "one", "of", "the", "two", "types", "will", "fail", ".", "You", "will", "must", "enable", "these", "types", "by", "explicit", "configuration", ",", "if", "you", "need", "them", ".", "</", "li", ">", "blacklist", "and", "the", "deserialization", "of", "XML", "containing", "one", "of", "the", "two", "types", "will", "fail", ".", "You", "will", "have", "to", "enable", "these", "types", "by", "explicit", "configuration", ",", "if", "you", "need", "them", ".", "</", "li", ">", "<", "/", "ul", ">", "<", "h1", "id", "=", "\"", "1", ".", "4", ".", "13", "\"", ">", "1", ".", "4", ".", "13", "<", "/", "h1", ">", "@", "@", "-", "29", ",", "9", "+", "29", ",", "10", "@", "@", "<", "p", ">", "The", "provided", "XML", "data", "is", "used", "by", "XStream", "to", "unmarshal", "Java", "objects", ".", "This", "data", "can", "be", "manipulated", "by", "injecting", "the", "XML", "representation", "of", "other", "objects", ",", "that", "were", "not", "present", "at", "marshalling", "time", ".", "An", "attacker", "could", "take", "advantage", "of", "this", "to", "access", "private", "data", ",", "execute", "arbitrary", "code", "or", "shell", "commands", "in", "the", "context", "of", "the", "server", "running", "the", "XStream", "process", ".", "Concrete", "cases", "are", "described", "in", "<", "a", "href", "=", "\"", "CVE", "-", "2013", "-", "7285", ".", "html", "\"", ">", "CVE", "-", "2013", "-", "7285", "<", "/", "a", ">", ",", "<", "a", "href", "=", "\"", "CVE", "-", "2020", "-", "26217", ".", "html", "\"", ">", "CVE", "-", "2020", "-", "26217", "<", "/", "a", ">", ",", "and", "<", "a", "href", "=", "\"", "CVE", "-", "2020", "-", "26258", ".", "html", "\"", ">", "CVE", "-", "2020", "-", "26258", "<", "/", "a", ">", ".<", "/", "p", ">", "advantage", "of", "this", "to", "access", "private", "data", ",", "delete", "local", "files", ",", "execute", "arbitrary", "code", "or", "shell", "commands", "in", "the", "context", "of", "the", "server", "running", "the", "XStream", "process", ".", "Concrete", "cases", "are", "described", "in", "<", "a", "href", "=", "\"", "CVE", "-", "2013", "-", "7285", ".", "html", "\"", ">", "CVE", "-", "2013", "-", "7285", "<", "/", "a", ">", ",", "<", "a", "href", "=", "\"", "CVE", "-", "2020", "-", "26217", ".", "html", "\"", ">", "CVE", "-", "2020", "-", "26217", "<", "/", "a", ">", ",", "<", "a", "href", "=", "\"", "CVE", "-", "2020", "-", "26258", ".", "html", "\"", ">", "CVE", "-", "2020", "-", "26258", "<", "/", "a", ">", ",", "and", "<", "a", "href", "=", "\"", "CVE", "-", "2020", "-", "26259", ".", "html", "\"", ">", "CVE", "-", "2020", "-", "26259", "<", "/", "a", ">", ".<", "/", "p", ">", "<", "p", ">", "Note", ",", "that", "the", "XML", "data", "can", "be", "manipulated", "on", "different", "levels", ".", "For", "example", ",", "manipulating", "values", "on", "existing", "objects", "(", "such", "as", "a", "price", "value", ")", ",", "accessing", "private", "data", ",", "or", "breaking", "the", "format", "and", "causing", "the", "XML", "parser", "to", "fail", ".", "@", "@", "-", "45", ",", "6", "+", "45", ",", "7", "@", "@", "<", "/", "section", ">", "<", "section", ">", "<", "name", ">", "Vulnerabilities", "<", "/", "name", ">", "<", "page", ">", "CVE", "-", "2020", "-", "26259", ".", "html", "<", "/", "page", ">", "<", "page", ">", "CVE", "-", "2020", "-", "26258", ".", "html", "<", "/", "page", ">", "<", "page", ">", "CVE", "-", "2020", "-", "26217", ".", "html", "<", "/", "page", ">", "<", "page", ">", "CVE", "-", "2017", "-", "7957", ".", "html", "<", "/", "page", ">", "@", "@", "-", "143", ",", "6", "+", "143", ",", "54", "@", "@", "<", "artifactId", ">", "commons", "-", "lang", "<", "/", "artifactId", ">", "<", "scope", ">", "test", "<", "/", "scope", ">", "<", "/", "dependency", ">", "<", "dependency", ">", "<", "groupId", ">", "com", ".", "sun", ".", "xml", ".", "ws", "<", "/", "groupId", ">", "<", "artifactId", ">", "jaxws", "-", "rt", "<", "/", "artifactId", ">", "<", "scope", ">", "test", "<", "/", "scope", ">", "<", "exclusions", ">", "<", "exclusion", ">", "<", "groupId", ">", "javax", ".", "xml", ".", "ws", "<", "/", "groupId", ">", "<", "artifactId", ">", "jaxws", "-", "api", "<", "/", "artifactId", ">", "<", "/", "exclusion", ">", "<", "exclusion", ">", "<", "groupId", ">", "com", ".", "sun", ".", "istack", "<", "/", "groupId", ">", "<", "artifactId", ">", "istack", "-", "commons", "-", "runtime", "<", "/", "artifactId", ">", "<", "/", "exclusion", ">", "<", "exclusion", ">", "<", "groupId", ">", "com", ".", "sun", ".", "xml", ".", "bind", "<", "/", "groupId", ">", "<", "artifactId", ">", "jaxb", "-", "impl", "<", "/", "artifactId", ">", "<", "/", "exclusion", ">", "<", "exclusion", ">", "<", "groupId", ">", "com", ".", "sun", ".", "xml", ".", "messaging", ".", "saaj", "<", "/", "groupId", ">", "<", "artifactId", ">", "saaj", "-", "impl", "<", "/", "artifactId", ">", "<", "/", "exclusion", ">", "<", "exclusion", ">", "<", "groupId", ">", "com", ".", "sun", ".", "xml", ".", "stream", ".", "buffer", "<", "/", "groupId", ">", "<", "artifactId", ">", "streambuffer", "<", "/", "artifactId", ">", "<", "/", "exclusion", ">", "<", "exclusion", ">", "<", "groupId", ">", "com", ".", "sun", ".", "xml", ".", "ws", "<", "/", "groupId", ">", "<", "artifactId", ">", "policy", "<", "/", "artifactId", ">", "<", "/", "exclusion", ">", "<", "exclusion", ">", "<", "groupId", ">", "com", ".", "sun", ".", "org", ".", "apache", ".", "xml", ".", "internal", "<", "/", "groupId", ">", "<", "artifactId", ">", "resolver", "<", "/", "artifactId", ">", "<", "/", "exclusion", ">", "<", "exclusion", ">", "<", "groupId", ">", "org", ".", "glassfish", ".", "gmbal", "<", "/", "groupId", ">", "<", "artifactId", ">", "gmbal", "-", "api", "-", "only", "<", "/", "artifactId", ">", "<", "/", "exclusion", ">", "<", "exclusion", ">", "<", "groupId", ">", "org", ".", "jvnet", "<", "/", "groupId", ">", "<", "artifactId", ">", "mimepull", "<", "/", "artifactId", ">", "<", "/", "exclusion", ">", "<", "exclusion", ">", "<", "groupId", ">", "org", ".", "jvnet", ".", "staxex", "<", "/", "groupId", ">", "<", "artifactId", ">", "stax", "-", "ex", "<", "/", "artifactId", ">", "<", "/", "exclusion", ">", "<", "/", "exclusions", ">", "<", "/", "dependency", ">", "<", "/", "dependencies", ">", "<", "build", ">", "@", "@", "-", "337", ",", "6", "+", "337", ",", "7", "@", "@", "private", "static", "final", "Pattern", "IGNORE_ALL", "=", "Pattern", ".", "compile", "(", "\".", "*\"", ");", "private", "static", "final", "Pattern", "LAZY_ITERATORS", "=", "Pattern", ".", "compile", "(", "\".", "*\\", "\\$", "LazyIterator", "\"", ");", "private", "static", "final", "Pattern", "JAVAX_CRYPTO", "=", "Pattern", ".", "compile", "(", "\"", "javax", "\\", "\\.", "crypto", "\\", "\\.", ".*", "\")", ";", "private", "static", "final", "Pattern", "JAXWS_FILE_STREAM", "=", "Pattern", ".", "compile", "(", "\".", "*\\", "\\.", "ReadAllStream", "\\", "\\$", "FileStream", "\"", ");", "/", "**", "*", "Constructs", "a", "default", "XStream", ".", "@", "@", "-", "646", ",", "8", "+", "647", ",", "8", "@", "@", "protected", "void", "setupSecurity", "(", ")", "{", "\"", "java", ".", "beans", ".", "EventHandler", "\"", ",", "/", "/", "\"", "java", ".", "lang", ".", "ProcessBuilder", "\"", ",", "/", "/", "\"", "javax", ".", "imageio", ".", "ImageIO", "$", "ContainsFilter", "\"", ",", "/", "/", "\"", "jdk", ".", "nashorn", ".", "internal", ".", "objects", ".", "NativeString", "\"", "})", ";", "denyTypesByRegExp", "(", "new", "Pattern", "[", "]{", "LAZY_ITERATORS", ",", "JAVAX_CRYPTO", "}", ");", "\"", "jdk", ".", "nashorn", ".", "internal", ".", "objects", ".", "NativeString", "\"", "}", ");", "denyTypesByRegExp", "(", "new", "Pattern", "[", "]{", "LAZY_ITERATORS", ",", "JAVAX_CRYPTO", ",", "JAXWS_FILE_STREAM", "}", ");", "allowTypeHierarchy", "(", "Exception", ".", "class", ")", ";", "securityInitialized", "=", "false", ";", "}", "@", "@", "-", "11", ",", "6", "+", "11", ",", "11", "@", "@", "package", "com", ".", "thoughtworks", ".", "acceptance", ";", "import", "java", ".", "beans", ".", "EventHandler", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "FileOutputStream", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "io", ".", "OutputStream", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "com", ".", "thoughtworks", ".", "xstream", ".", "XStream", ";", "@", "@", "-", "213", ",", "4", "+", "218", ",", "68", "@", "@", "public", "void", "testInstanceOfLazyIterator", "(", ")", "{", "/", "/", "OK", "}", "}", "public", "void", "testCannotUseJaxwsInputStreamToDeleteFile", "(", ")", "{", "if", "(", "JVM", ".", "isVersion", "(", "5", ")", ")", "{", "final", "String", "xml", "=", "\"", "\"", "+", "\"", "<", "is", "class", "=", "'", "com", ".", "sun", ".", "xml", ".", "ws", ".", "util", ".", "ReadAllStream", "$", "FileStream", "'", ">\\", "n", "\"", "+", "\"", "<", "tempFile", ">", "target", "/", "junit", "/", "test", ".", "txt", "<", "/", "tempFile", ">", "\\", "n", "\"", "+", "\"", "</", "is", ">", "\";", "xstream", ".", "aliasType", "(", "\"", "is", "\"", ",", "InputStream", ".", "class", ")", ";", "try", "{", "xstream", ".", "fromXML", "(", "xml", ")", ";", "fail", "(", "\"", "Thrown", "\"", "+", "ConversionException", ".", "class", ".", "getName", "(", ")", "+", "\"", "expected", "\"", ");", "}", "catch", "(", "final", "ForbiddenClassException", "e", ")", "{", "/", "/", "OK", "}", "}", "}", "public", "void", "testExplicitlyUseJaxwsInputStreamToDeleteFile", "(", ")", "throws", "IOException", "{", "if", "(", "JVM", ".", "isVersion", "(", "5", ")", ")", "{", "final", "File", "testDir", "=", "new", "File", "(", "\"", "target", "/", "junit", "\"", ");", "final", "File", "testFile", "=", "new", "File", "(", "testDir", ",", "\"", "test", ".", "txt", "\"", ");", "try", "{", "testDir", ".", "mkdirs", "(", ");", "final", "OutputStream", "out", "=", "new", "FileOutputStream", "(", "testFile", ")", ";", "out", ".", "write", "(", "\"", "JUnit", "\"", ".", "getBytes", "(", "))", ";", "out", ".", "flush", "(", ");", "out", ".", "close", "(", ");", "assertTrue", "(", "\"", "Test", "file", "\"", "+", "testFile", ".", "getPath", "(", ")", "+", "\"", "does", "not", "exist", ".", "\",", "testFile", ".", "exists", "(", "))", ";", "final", "String", "xml", "=", "\"", "\"", "+", "\"", "<", "is", "class", "=", "'", "com", ".", "sun", ".", "xml", ".", "ws", ".", "util", ".", "ReadAllStream", "$", "FileStream", "'", ">\\", "n", "\"", "+", "\"", "<", "tempFile", ">", "target", "/", "junit", "/", "test", ".", "txt", "<", "/", "tempFile", ">", "\\", "n", "\"", "+", "\"", "</", "is", ">", "\";", "xstream", ".", "addPermission", "(", "AnyTypePermission", ".", "ANY", ")", ";", "/", "/", "clear", "out", "defaults", "xstream", ".", "aliasType", "(", "\"", "is", "\"", ",", "InputStream", ".", "class", ")", ";", "InputStream", "is", "=", "null", ";", "try", "{", "is", "=", "(", "InputStream", ")", "xstream", ".", "fromXML", "(", "xml", ")", ";", "}", "catch", "(", "final", "ForbiddenClassException", "e", ")", "{", "/", "/", "OK", "}", "assertTrue", "(", "\"", "Test", "file", "\"", "+", "testFile", ".", "getPath", "(", ")", "+", "\"", "no", "longer", "exists", ".", "\",", "testFile", ".", "exists", "(", "))", ";", "byte", "[", "]", "data", "=", "new", "byte", "[", "10", "]", ";", "is", ".", "read", "(", "data", ")", ";", "is", ".", "close", "(", ");", "assertFalse", "(", "\"", "Test", "file", "\"", "+", "testFile", ".", "getPath", "(", ")", "+", "\"", "still", "exists", "exist", ".", "\",", "testFile", ".", "exists", "(", "))", ";", "}", "finally", "{", "if", "(", "testFile", ".", "exists", "(", "))", "{", "testFile", ".", "delete", "(", ");", "}", "if", "(", "testDir", ".", "exists", "(", "))", "{", "testDir", ".", "delete", "(", ");", "}", "}", "}", "}", "}"], "docstring_tokens": ["improper", "input", "sanitization"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "873", ",", "7", "+", "873", ",", "7", "@", "@", "static", "long", "get_instantiation_keyring", "(", "key_serial_t", "ringid", ",", "/", "*", "otherwise", "specify", "the", "destination", "keyring", "recorded", "in", "the", "*", "authorisation", "key", "(", "any", "KEY_SPEC_", "*", "_KEYRING", ")", "*", "/", "if", "(", "ringid", ">", "=", "KEY_SPEC_REQUESTOR_KEYRING", ")", "{", "*", "_dest_keyring", "=", "rka", "-", ">", "dest_keyring", ";", "*", "_dest_keyring", "=", "key_get", "(", "rka", "-", ">", "dest_keyring", ")", ";", "return", "0", ";", "}"], "docstring_tokens": ["does", "not", "properly", "maintain", "the", "reference", "count", "of", "a", "keyring"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "447", ",", "8", "+", "447", ",", "10", "@", "@", "static", "void", "icmp6_send", "(", "struct", "sk_buff", "*", "skb", ",", "u8", "type", ",", "u8", "code", ",", "__u32", "info", ",", "if", "(", "__ipv6_addr_needs_scope_id", "(", "addr_type", ")", ")", "iif", "=", "skb", "-", ">", "dev", "-", ">", "ifindex", ";", "else", "iif", "=", "l3mdev_master_ifindex", "(", "skb_dst", "(", "skb", ")", "->", "dev", ")", ";", "else", "{", "dst", "=", "skb_dst", "(", "skb", ")", ";", "iif", "=", "l3mdev_master_ifindex", "(", "dst", "?", "dst", "-", ">", "dev", ":", "skb", "-", ">", "dev", ")", ";", "}", "/", "*", "*", "Must", "not", "send", "error", "if", "the", "source", "does", "not", "uniquely"], "docstring_tokens": ["a", "timeout"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "216", ",", "6", "+", "216", ",", "9", "@", "@", "Bug", "Fixes", "*", "SOLR", "-", "13963", ":", "JavaBinCodec", "has", "concurrent", "modification", "of", "CharArr", "resulting", "in", "corrupt", "internode", "updates", "(", "Colvin", "Cowie", ",", "noble", ")", "*", "SOLR", "-", "13971", ":", "Velocity", "response", "writer", "'", "s", "resource", "loading", "now", "possible", "only", "through", "startup", "parameters", ".", "Also", ",", "removed", "velocity", "response", "writer", "from", "_default", "configset", ".", "(", "Ishan", "Chattopadhyaya", ")", "=", "==", "==", "==", "==", "==", "==", "==", "==", "=", "8", ".", "3", ".", "0", "=", "==", "==", "==", "==", "==", "==", "==", "==", "=", "Consult", "the", "LUCENE_CHANGES", ".", "txt", "file", "for", "additional", ",", "low", "level", ",", "changes", "in", "this", "release", ".", "@", "@", "-", "62", ",", "9", "+", "62", ",", "11", "@", "@", "/", "/", "init", "param", "names", ",", "these", "are", "_only_", "loaded", "at", "init", "time", "(", "no", "per", "-", "request", "control", "of", "these", ")", "/", "/", "-", "multiple", "different", "named", "writers", "could", "be", "created", "with", "different", "init", "params", "public", "static", "final", "String", "TEMPLATE_BASE_DIR", "=", "\"", "template", ".", "base", ".", "dir", "\"", ";", "public", "static", "final", "String", "PROPERTIES_FILE", "=", "\"", "init", ".", "properties", ".", "file", "\"", ";", "/", "/", "System", "property", "names", ",", "these", "are", "_only_", "loaded", "at", "node", "startup", "(", "no", "per", "-", "request", "control", "of", "these", ")", "public", "static", "final", "String", "PARAMS_RESOURCE_LOADER_ENABLED", "=", "\"", "params", ".", "resource", ".", "loader", ".", "enabled", "\"", ";", "public", "static", "final", "String", "SOLR_RESOURCE_LOADER_ENABLED", "=", "\"", "solr", ".", "resource", ".", "loader", ".", "enabled", "\"", ";", "public", "static", "final", "String", "PROPERTIES_FILE", "=", "\"", "init", ".", "properties", ".", "file", "\"", ";", "/", "/", "request", "param", "names", "public", "static", "final", "String", "TEMPLATE", "=", "\"", "v", ".", "template", "\"", ";", "@", "@", "-", "106", ",", "12", "+", "108", ",", "12", "@", "@", "public", "void", "init", "(", "NamedList", "args", ")", "{", "}", "/", "/", "params", "resource", "loader", ":", "off", "by", "default", "Boolean", "prle", "=", "args", ".", "getBooleanArg", "(", "PARAMS_RESOURCE_LOADER_ENABLED", ")", ";", "Boolean", "prle", "=", "Boolean", ".", "getBoolean", "(", "PARAMS_RESOURCE_LOADER_ENABLED", ")", ";", "paramsResourceLoaderEnabled", "=", "(", "null", "=", "=", "prle", "?", "false", ":", "prle", ")", ";", "/", "/", "solr", "resource", "loader", ":", "on", "by", "default", "Boolean", "srle", "=", "args", ".", "getBooleanArg", "(", "SOLR_RESOURCE_LOADER_ENABLED", ")", ";", "solrResourceLoaderEnabled", "=", "(", "null", "=", "=", "srle", "?", "true", ":", "srle", ")", ";", "/", "/", "solr", "resource", "loader", ":", "off", "by", "default", "Boolean", "srle", "=", "Boolean", ".", "getBoolean", "(", "SOLR_RESOURCE_LOADER_ENABLED", ")", ";", "solrResourceLoaderEnabled", "=", "(", "null", "=", "=", "srle", "?", "false", ":", "srle", ")", ";", "initPropertiesFileName", "=", "(", "String", ")", "args", ".", "get", "(", "PROPERTIES_FILE", ")", ";", "@", "@", "-", "27", ",", "16", "+", "27", ",", "25", "@", "@", "import", "org", ".", "apache", ".", "solr", ".", "response", ".", "SolrParamResourceLoader", ";", "import", "org", ".", "apache", ".", "solr", ".", "response", ".", "SolrQueryResponse", ";", "import", "org", ".", "apache", ".", "solr", ".", "response", ".", "VelocityResponseWriter", ";", "import", "org", ".", "junit", ".", "AfterClass", ";", "import", "org", ".", "junit", ".", "BeforeClass", ";", "import", "org", ".", "junit", ".", "Test", ";", "public", "class", "VelocityResponseWriterTest", "extends", "SolrTestCaseJ4", "{", "@", "BeforeClass", "public", "static", "void", "beforeClass", "(", ")", "throws", "Exception", "{", "System", ".", "setProperty", "(", "\"", "params", ".", "resource", ".", "loader", ".", "enabled", "\"", ",", "\"", "true", "\"", ");", "System", ".", "setProperty", "(", "\"", "solr", ".", "resource", ".", "loader", ".", "enabled", "\"", ",", "\"", "true", "\"", ");", "initCore", "(", "\"", "solrconfig", ".", "xml", "\"", ",", "\"", "schema", ".", "xml", "\"", ",", "getFile", "(", "\"", "velocity", "/", "solr", "\"", ").", "getAbsolutePath", "(", "))", ";", "System", ".", "out", ".", "println", "(", "getFile", "(", "\"", "velocity", "/", "solr", "\"", ").", "getAbsolutePath", "(", "))", ";", "}", "@", "AfterClass", "public", "static", "void", "afterClass", "(", ")", "throws", "Exception", "{", "System", ".", "clearProperty", "(", "\"", "params", ".", "resource", ".", "loader", ".", "enabled", "\"", ");", "System", ".", "clearProperty", "(", "\"", "solr", ".", "resource", ".", "loader", ".", "enabled", "\"", ");", "}", "@", "Test", "public", "void", "testVelocityResponseWriterRegistered", "(", ")", "{", "QueryResponseWriter", "writer", "=", "h", ".", "getCore", "(", ").", "getQueryResponseWriter", "(", "\"", "velocity", "\"", ");", "@", "@", "-", "81", ",", "8", "+", "81", ",", "6", "@", "@", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "contrib", "/", "langid", "/", "lib", "/", "\"", "regex", "=", "\".", "*\\", ".", "jar", "\"", "/", ">", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "dist", "/", "\"", "regex", "=", "\"", "solr", "-", "langid", "-", "\\", "d", ".", "*\\", ".", "jar", "\"", "/", ">", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "contrib", "/", "velocity", "/", "lib", "\"", "regex", "=", "\".", "*\\", ".", "jar", "\"", "/", ">", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "dist", "/", "\"", "regex", "=", "\"", "solr", "-", "velocity", "-", "\\", "d", ".", "*\\", ".", "jar", "\"", "/", ">", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "dist", "/", "\"", "regex", "=", "\"", "solr", "-", "ltr", "-", "\\", "d", ".", "*\\", ".", "jar", "\"", "/", ">", "<", "!-", "-", "an", "exact", "'", "path", "'", "can", "be", "used", "instead", "of", "a", "'", "dir", "'", "to", "specify", "a", "@", "@", "-", "780", ",", "7", "+", "778", ",", "7", "@", "@", "(", "SearchHandler", ")", "can", "be", "registered", "multiple", "times", "with", "different", "names", "(", "and", "different", "init", "parameters", ")", "-", "->", "<", "requestHandler", "name", "=", "\"/", "browse", "\"", "class", "=", "\"", "solr", ".", "SearchHandler", "\"", "useParams", "=", "\"", "query", ",", "facets", ",", "velocity", ",", "browse", "\"", ">", "<", "requestHandler", "name", "=", "\"/", "browse", "\"", "class", "=", "\"", "solr", ".", "SearchHandler", "\"", "useParams", "=", "\"", "query", ",", "facets", ",", "browse", "\"", ">", "<", "lst", "name", "=", "\"", "defaults", "\"", ">", "<", "str", "name", "=", "\"", "echoParams", "\"", ">", "explicit", "<", "/", "str", ">", "<", "/", "lst", ">", "@", "@", "-", "1292", ",", "15", "+", "1290", ",", "6", "@", "@", "<", "/", "queryResponseWriter", ">", "-", "->", "<", "!", "Custom", "response", "writers", "can", "be", "declared", "as", "needed", ".", "..", "-", "->", "<", "queryResponseWriter", "name", "=", "\"", "velocity", "\"", "class", "=", "\"", "solr", ".", "VelocityResponseWriter", "\"", "startup", "=", "\"", "lazy", "\"", ">", "<", "str", "name", "=", "\"", "template", ".", "base", ".", "dir", "\"", ">$", "{", "velocity", ".", "template", ".", "base", ".", "dir", ":", "}<", "/", "str", ">", "<", "str", "name", "=", "\"", "solr", ".", "resource", ".", "loader", ".", "enabled", "\"", ">$", "{", "velocity", ".", "solr", ".", "resource", ".", "loader", ".", "enabled", ":", "true", "}", "</", "str", ">", "<", "str", "name", "=", "\"", "params", ".", "resource", ".", "loader", ".", "enabled", "\"", ">$", "{", "velocity", ".", "params", ".", "resource", ".", "loader", ".", "enabled", ":", "false", "}", "</", "str", ">", "<", "/", "queryResponseWriter", ">", "<", "!-", "-", "XSLT", "response", "writer", "transforms", "the", "XML", "output", "by", "any", "xslt", "file", "found", "in", "Solr", "'", "s", "conf", "/", "xslt", "directory", ".", "Changes", "to", "xslt", "files", "are", "checked", "for", "every", "xsltCacheLifetimeSeconds", ".", "@", "@", "-", "81", ",", "8", "+", "81", ",", "6", "@", "@", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "contrib", "/", "langid", "/", "lib", "/", "\"", "regex", "=", "\".", "*\\", ".", "jar", "\"", "/", ">", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "dist", "/", "\"", "regex", "=", "\"", "solr", "-", "langid", "-", "\\", "d", ".", "*\\", ".", "jar", "\"", "/", ">", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "contrib", "/", "velocity", "/", "lib", "\"", "regex", "=", "\".", "*\\", ".", "jar", "\"", "/", ">", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "dist", "/", "\"", "regex", "=", "\"", "solr", "-", "velocity", "-", "\\", "d", ".", "*\\", ".", "jar", "\"", "/", ">", "<", "lib", "dir", "=", "\"$", "{", "solr", ".", "install", ".", "dir", ":", "..", "/.", "./", "..", "/.", ".}", "/", "dist", "/", "\"", "regex", "=", "\"", "solr", "-", "ltr", "-", "\\", "d", ".", "*\\", ".", "jar", "\"", "/", ">", "<", "!-", "-", "an", "exact", "'", "path", "'", "can", "be", "used", "instead", "of", "a", "'", "dir", "'", "to", "specify", "a", "@", "@", "-", "780", ",", "7", "+", "778", ",", "7", "@", "@", "(", "SearchHandler", ")", "can", "be", "registered", "multiple", "times", "with", "different", "names", "(", "and", "different", "init", "parameters", ")", "-", "->", "<", "requestHandler", "name", "=", "\"/", "browse", "\"", "class", "=", "\"", "solr", ".", "SearchHandler", "\"", "useParams", "=", "\"", "query", ",", "facets", ",", "velocity", ",", "browse", "\"", ">", "<", "requestHandler", "name", "=", "\"/", "browse", "\"", "class", "=", "\"", "solr", ".", "SearchHandler", "\"", "useParams", "=", "\"", "query", ",", "facets", ",", "browse", "\"", ">", "<", "lst", "name", "=", "\"", "defaults", "\"", ">", "<", "str", "name", "=", "\"", "echoParams", "\"", ">", "explicit", "<", "/", "str", ">", "<", "/", "lst", ">", "@", "@", "-", "1292", ",", "15", "+", "1290", ",", "6", "@", "@", "<", "/", "queryResponseWriter", ">", "-", "->", "<", "!", "Custom", "response", "writers", "can", "be", "declared", "as", "needed", ".", "..", "-", "->", "<", "queryResponseWriter", "name", "=", "\"", "velocity", "\"", "class", "=", "\"", "solr", ".", "VelocityResponseWriter", "\"", "startup", "=", "\"", "lazy", "\"", ">", "<", "str", "name", "=", "\"", "template", ".", "base", ".", "dir", "\"", ">$", "{", "velocity", ".", "template", ".", "base", ".", "dir", ":", "}<", "/", "str", ">", "<", "str", "name", "=", "\"", "solr", ".", "resource", ".", "loader", ".", "enabled", "\"", ">$", "{", "velocity", ".", "solr", ".", "resource", ".", "loader", ".", "enabled", ":", "true", "}", "</", "str", ">", "<", "str", "name", "=", "\"", "params", ".", "resource", ".", "loader", ".", "enabled", "\"", ">$", "{", "velocity", ".", "params", ".", "resource", ".", "loader", ".", "enabled", ":", "false", "}", "</", "str", ">", "<", "/", "queryResponseWriter", ">", "<", "!-", "-", "XSLT", "response", "writer", "transforms", "the", "XML", "output", "by", "any", "xslt", "file", "found", "in", "Solr", "'", "s", "conf", "/", "xslt", "directory", ".", "Changes", "to", "xslt", "files", "are", "checked", "for", "every", "xsltCacheLifetimeSeconds", ".", "@", "@", "-", "27", ",", "25", "+", "27", ",", "18", "@", "@", "Its", "JAR", "and", "dependencies", "must", "be", "added", "(", "via", "`", "<", "lib", ">", "`", "or", "solr", "/", "home", "lib", "inclusion", ")", ",", "<", "!-", "-", "<", "str", "name", "=", "\"", "init", ".", "properties", ".", "file", "\"", ">", "velocity", "-", "init", ".", "properties", "<", "/", "str", ">", "<", "bool", "name", "=", "\"", "params", ".", "resource", ".", "loader", ".", "enabled", "\"", ">", "true", "<", "/", "bool", ">", "<", "bool", "name", "=", "\"", "solr", ".", "resource", ".", "loader", ".", "enabled", "\"", ">", "false", "<", "/", "bool", ">", "<", "lst", "name", "=", "\"", "tools", "\"", ">", "<", "str", "name", "=", "\"", "mytool", "\"", ">", "com", ".", "example", ".", "MyCustomTool", "<", "/", "str", ">", "<", "/", "lst", ">", "-", "->", "<", "/", "queryResponseWriter", ">", "The", "above", "example", "shows", "the", "optional", "initialization", "and", "custom", "tool", "parameters", "used", "by", "VelocityResponseWriter", ";", "these", "are", "detailed", "in", "the", "following", "table", ".", "These", "initialization", "parameters", "are", "only", "specified", "in", "the", "writer", "registration", "in", "`", "solrconfig", ".", "xml", "`", ",", "not", "as", "request", "-", "time", "parameters", ".", "See", "further", "below", "for", "request", "-", "time", "parameters", ".", "The", "above", "example", "shows", "the", "optional", "initialization", "and", "custom", "tool", "parameters", "used", "by", "VelocityResponseWriter", ";", "these", "are", "detailed", "in", "the", "following", "table", ".", "These", "initialization", "parameters", "are", "only", "specified", "in", "the", "writer", "registration", "in", "`", "solrconfig", ".", "xml", "`", ",", "not", "as", "request", "-", "time", "parameters", ".", "In", "this", "example", ",", "all", "Solr", "nodes", "should", "be", "started", "with", "`", "-", "Dparams", ".", "resource", ".", "loader", ".", "enabled", "=", "true", "`", ".", "See", "further", "below", "for", "request", "-", "time", "parameters", ".", "=", "=", "Configuration", "&", "Usage", "=", "==", "VelocityResponseWriter", "Initialization", "Parameters", "`", "template", ".", "base", ".", "dir", "`", "::", "If", "specified", "and", "exists", "as", "a", "file", "system", "directory", ",", "a", "file", "resource", "loader", "will", "be", "added", "for", "this", "directory", ".", "Templates", "in", "this", "directory", "will", "override", "\"", "solr", "\"", "resource", "loader", "templates", ".", "`", "init", ".", "properties", ".", "file", "`", "::", "Specifies", "a", "properties", "file", "name", "which", "must", "exist", "in", "the", "Solr", "`", "conf", "/", "`", "directory", "(", "*", "not", "*", "under", "a", "`", "velocity", "/", "`", "subdirectory", ")", "or", "root", "of", "a", "JAR", "file", "in", "a", "<", "lib", ">", ".", "=", "==", "VelocityResponseWriter", "Startup", "Parameters", "`", "params", ".", "resource", ".", "loader", ".", "enabled", "`", "::", "The", "\"", "params", "\"", "resource", "loader", "allows", "templates", "to", "be", "specified", "in", "Solr", "request", "parameters", ".", "For", "example", ":", "@", "@", "-", "58", ",", "6", "+", "51", ",", "13", "@", "@", "where", "`", "v", ".", "template", "=", "custom", "`", "says", "to", "render", "a", "template", "called", "\"", "custom", "\"", "and", "the", "valu", "`", "solr", ".", "resource", ".", "loader", ".", "enabled", "`", "::", "The", "\"", "solr", "\"", "resource", "loader", "is", "the", "only", "template", "loader", "registered", "by", "default", ".", "Templates", "are", "served", "from", "resources", "visible", "to", "the", "SolrResourceLoader", "under", "a", "`", "velocity", "/", "`", "subdirectory", ".", "The", "VelocityResponseWriter", "itself", "has", "some", "built", "-", "in", "templates", "(", "in", "its", "JAR", "file", ",", "under", "`", "velocity", "/", "`)", "that", "are", "available", "automatically", "through", "this", "loader", ".", "These", "built", "-", "in", "templates", "can", "be", "overridden", "when", "the", "same", "template", "name", "is", "in", "conf", "/", "velocity", "/", "or", "by", "using", "the", "`", "template", ".", "base", ".", "dir", "`", "option", ".", "=", "==", "VelocityResponseWriter", "Initialization", "Parameters", "`", "template", ".", "base", ".", "dir", "`", "::", "If", "specified", "and", "exists", "as", "a", "file", "system", "directory", ",", "a", "file", "resource", "loader", "will", "be", "added", "for", "this", "directory", ".", "Templates", "in", "this", "directory", "will", "override", "\"", "solr", "\"", "resource", "loader", "templates", ".", "`", "init", ".", "properties", ".", "file", "`", "::", "Specifies", "a", "properties", "file", "name", "which", "must", "exist", "in", "the", "Solr", "`", "conf", "/", "`", "directory", "(", "*", "not", "*", "under", "a", "`", "velocity", "/", "`", "subdirectory", ")", "or", "root", "of", "a", "JAR", "file", "in", "a", "<", "lib", ">", ".", "`", "tools", "`", "::", "External", "\"", "tools", "\"", "can", "be", "specified", "as", "list", "of", "string", "name", "/", "value", "(", "tool", "name", "/", "class", "name", ")", "pairs", ".", "Tools", ",", "in", "the", "Velocity", "context", ",", "are", "simply", "Java", "objects", ".", "Tool", "classes", "are", "constructed", "using", "a", "no", "-", "arg", "constructor", "(", "or", "a", "single", "-", "SolrCore", "-", "arg", "constructor", "if", "it", "exists", ")", "and", "added", "to", "the", "Velocity", "context", "with", "the", "specified", "name", "."], "docstring_tokens": ["potentially", "malicious"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "20", ",", "7", "+", "20", ",", "6", "@", "@", "#", "define", "THREAD_SIZE_ORDER", "1", "#", "define", "THREAD_SIZE", "(", "PAGE_SIZE", "<", "<", "THREAD_SIZE_ORDER", ")", "#", "define", "STACKFAULT_STACK", "0", "#", "define", "DOUBLEFAULT_STACK", "1", "#", "define", "NMI_STACK", "0", "#", "define", "DEBUG_STACK", "0", "@", "@", "-", "14", ",", "12", "+", "14", ",", "11", "@", "@", "#", "define", "IRQ_STACK_ORDER", "2", "#", "define", "IRQ_STACK_SIZE", "(", "PAGE_SIZE", "<", "<", "IRQ_STACK_ORDER", ")", "#", "define", "STACKFAULT_STACK", "1", "#", "define", "DOUBLEFAULT_STACK", "2", "#", "define", "NMI_STACK", "3", "#", "define", "DEBUG_STACK", "4", "#", "define", "MCE_STACK", "5", "#", "define", "N_EXCEPTION_STACKS", "5", "/", "*", "hw", "limit", ":", "7", "*", "/", "#", "define", "DOUBLEFAULT_STACK", "1", "#", "define", "NMI_STACK", "2", "#", "define", "DEBUG_STACK", "3", "#", "define", "MCE_STACK", "4", "#", "define", "N_EXCEPTION_STACKS", "4", "/", "*", "hw", "limit", ":", "7", "*", "/", "#", "define", "PUD_PAGE_SIZE", "(", "_AC", "(", "1", ",", "UL", ")", "<", "<", "PUD_SHIFT", ")", "#", "define", "PUD_PAGE_MASK", "(", "~(", "PUD_PAGE_SIZE", "-", "1", ")", ")", "@", "@", "-", "39", ",", "6", "+", "39", ",", "7", "@", "@", "asmlinkage", "void", "simd_coprocessor_error", "(", "void", ")", ";", "#", "ifdef", "CONFIG_TRACING", "asmlinkage", "void", "trace_page_fault", "(", "void", ")", ";", "#", "define", "trace_stack_segment", "stack_segment", "#", "define", "trace_divide_error", "divide_error", "#", "define", "trace_bounds", "bounds", "#", "define", "trace_invalid_op", "invalid_op", "@", "@", "-", "24", ",", "7", "+", "24", ",", "6", "@", "@", "static", "char", "x86_stack_ids", "[", "][", "8", "]", "=", "{", "[", "DEBUG_STACK", "-", "1", "]", "=", "\"", "#", "DB", "\"", ",", "[", "NMI_STACK", "-", "1", "]", "=", "\"", "NMI", "\"", ",", "[", "DOUBLEFAULT_STACK", "-", "1", "]", "=", "\"", "#", "DF", "\"", ",", "[", "STACKFAULT_STACK", "-", "1", "]", "=", "\"", "#", "SS", "\"", ",", "[", "MCE_STACK", "-", "1", "]", "=", "\"", "#", "MC", "\"", ",", "#", "if", "DEBUG_STKSZ", ">", "EXCEPTION_STKSZ", "[", "N_EXCEPTION_STACKS", ".", "..", "@", "@", "-", "1259", ",", "7", "+", "1259", ",", "7", "@", "@", "apicinterrupt3", "HYPERVISOR_CALLBACK_VECTOR", "\\", "idtentry", "debug", "do_debug", "has_error_code", "=", "0", "paranoid", "=", "1", "shift_ist", "=", "DEBUG_STACK", "idtentry", "int3", "do_int3", "has_error_code", "=", "0", "paranoid", "=", "1", "shift_ist", "=", "DEBUG_STACK", "idtentry", "stack_segment", "do_stack_segment", "has_error_code", "=", "1", "paranoid", "=", "1", "idtentry", "stack_segment", "do_stack_segment", "has_error_code", "=", "1", "#", "ifdef", "CONFIG_XEN", "idtentry", "xen_debug", "do_debug", "has_error_code", "=", "0", "idtentry", "xen_int3", "do_int3", "has_error_code", "=", "0", "@", "@", "-", "233", ",", "27", "+", "233", ",", "11", "@", "@", "DO_ERROR", "(", "X86_TRAP_UD", ",", "SIGILL", ",", "\"", "invalid", "opcode", "\"", ",", "invalid_op", ")", "DO_ERROR", "(", "X86_TRAP_OLD_MF", ",", "SIGFPE", ",", "\"", "coprocessor", "segment", "overrun", "\"", ",", "coprocessor_segment_overrun", ")", "DO_ERROR", "(", "X86_TRAP_TS", ",", "SIGSEGV", ",", "\"", "invalid", "TSS", "\"", ",", "invalid_TSS", ")", "DO_ERROR", "(", "X86_TRAP_NP", ",", "SIGBUS", ",", "\"", "segment", "not", "present", "\"", ",", "segment_not_present", ")", "#", "ifdef", "CONFIG_X86_32", "DO_ERROR", "(", "X86_TRAP_SS", ",", "SIGBUS", ",", "\"", "stack", "segment", "\"", ",", "stack_segment", ")", "#", "endif", "DO_ERROR", "(", "X86_TRAP_AC", ",", "SIGBUS", ",", "\"", "alignment", "check", "\"", ",", "alignment_check", ")", "#", "ifdef", "CONFIG_X86_64", "/", "*", "Runs", "on", "IST", "stack", "*", "/", "dotraplinkage", "void", "do_stack_segment", "(", "struct", "pt_regs", "*", "regs", ",", "long", "error_code", ")", "{", "enum", "ctx_state", "prev_state", ";", "prev_state", "=", "exception_enter", "(", ");", "if", "(", "notify_die", "(", "DIE_TRAP", ",", "\"", "stack", "segment", "\"", ",", "regs", ",", "error_code", ",", "X86_TRAP_SS", ",", "SIGBUS", ")", "!", "=", "NOTIFY_STOP", ")", "{", "preempt_conditional_sti", "(", "regs", ")", ";", "do_trap", "(", "X86_TRAP_SS", ",", "SIGBUS", ",", "\"", "stack", "segment", "\"", ",", "regs", ",", "error_code", ",", "NULL", ")", ";", "preempt_conditional_cli", "(", "regs", ")", ";", "}", "exception_exit", "(", "prev_state", ")", ";", "}", "dotraplinkage", "void", "do_double_fault", "(", "struct", "pt_regs", "*", "regs", ",", "long", "error_code", ")", "{", "static", "const", "char", "str", "[", "]", "=", "\"", "double", "fault", "\"", ";", "@", "@", "-", "802", ",", "7", "+", "786", ",", "7", "@", "@", "void", "__init", "trap_init", "(", "void", ")", "set_intr_gate", "(", "X86_TRAP_OLD_MF", ",", "coprocessor_segment_overrun", ")", ";", "set_intr_gate", "(", "X86_TRAP_TS", ",", "invalid_TSS", ")", ";", "set_intr_gate", "(", "X86_TRAP_NP", ",", "segment_not_present", ")", ";", "set_intr_gate_ist", "(", "X86_TRAP_SS", ",", "&", "stack_segment", ",", "STACKFAULT_STACK", ")", ";", "set_intr_gate", "(", "X86_TRAP_SS", ",", "stack_segment", ")", ";", "set_intr_gate", "(", "X86_TRAP_GP", ",", "general_protection", ")", ";", "set_intr_gate", "(", "X86_TRAP_SPURIOUS", ",", "spurious_interrupt_bug", ")", ";", "set_intr_gate", "(", "X86_TRAP_MF", ",", "coprocessor_error", ")", ";"], "docstring_tokens": ["it", "basically", "unmaps", "the", "original", "userland", "address", "range", "and", "remaps", "it", "at", "a", "different", "address", "using", "non-exec/supervisor", "rights"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "256", ",", "7", "+", "256", ",", "7", "@", "@", "PHP_FUNCTION", "(", "shmop_read", ")", "RETURN_FALSE", ";", "}", "if", "(", "start", "+", "count", ">", "shmop", "-", ">", "size", "|", "|", "count", "<", "0", ")", "{", "if", "(", "count", "<", "0", "|", "|", "start", ">", "(", "INT_MAX", "-", "count", ")", "|", "|", "start", "+", "count", ">", "shmop", "-", ">", "size", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "count", "is", "out", "of", "range", "\"", ");", "RETURN_FALSE", ";", "}"], "docstring_tokens": ["reading", "arbitrary", "memory", "outside", "the", "shared", "memory", "object"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "93", ",", "6", "+", "93", ",", "7", "@", "@", "static", "long", "media_device_enum_entities", "(", "struct", "media_device", "*", "mdev", ",", "struct", "media_entity", "*", "ent", ";", "struct", "media_entity_desc", "u_ent", ";", "memset", "(", "&", "u_ent", ",", "0", ",", "sizeof", "(", "u_ent", ")", ");", "if", "(", "copy_from_user", "(", "&", "u_ent", ".", "id", ",", "&", "uent", "-", ">", "id", ",", "sizeof", "(", "u_ent", ".", "id", ")", "))", "return", "-", "EFAULT", ";"], "docstring_tokens": ["does", "not", "initialize", "a", "certain", "data", "structure"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2296", ",", "6", "+", "2296", ",", "8", "@", "@", "static", "int", "cxgb_extension_ioctl", "(", "struct", "net_device", "*", "dev", ",", "void", "__user", "*", "useraddr", ")", "case", "CHELSIO_GET_QSET_NUM", ":", "{", "struct", "ch_reg", "edata", ";", "memset", "(", "&", "edata", ",", "0", ",", "sizeof", "(", "struct", "ch_reg", ")", ");", "edata", ".", "cmd", "=", "CHELSIO_GET_QSET_NUM", ";", "edata", ".", "val", "=", "pi", "-", ">", "nqsets", ";", "if", "(", "copy_to_user", "(", "useraddr", ",", "&", "edata", ",", "sizeof", "(", "edata", ")", "))"], "docstring_tokens": ["does", "not", "properly", "initialize", "a", "certain", "structure", "member"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "172", ",", "7", "+", "172", ",", "10", "@", "@", "static", "int", "load_misc_binary", "(", "struct", "linux_binprm", "*", "bprm", ")", "goto", "_error", ";", "bprm", "-", ">", "argc", "+", "+;", "bprm", "-", ">", "interp", "=", "iname", ";", "/", "*", "for", "binfmt_script", "*", "/", "/", "*", "Update", "interp", "in", "case", "binfmt_script", "needs", "it", ".", "*", "/", "retval", "=", "bprm_change_interp", "(", "iname", ",", "bprm", ")", ";", "if", "(", "retval", "<", "0", ")", "goto", "_error", ";", "interp_file", "=", "open_exec", "(", "iname", ")", ";", "retval", "=", "PTR_ERR", "(", "interp_file", ")", ";", "@", "@", "-", "80", ",", "7", "+", "80", ",", "9", "@", "@", "static", "int", "load_script", "(", "struct", "linux_binprm", "*", "bprm", ")", "retval", "=", "copy_strings_kernel", "(", "1", ",", "&", "i_name", ",", "bprm", ")", ";", "if", "(", "retval", ")", "return", "retval", ";", "bprm", "-", ">", "argc", "+", "+;", "bprm", "-", ">", "interp", "=", "interp", ";", "retval", "=", "bprm_change_interp", "(", "interp", ",", "bprm", ")", ";", "if", "(", "retval", "<", "0", ")", "return", "retval", ";", "/", "*", "*", "OK", ",", "now", "restart", "the", "process", "with", "the", "interpreter", "'", "s", "dentry", ".", "@", "@", "-", "1175", ",", "9", "+", "1175", ",", "24", "@", "@", "void", "free_bprm", "(", "struct", "linux_binprm", "*", "bprm", ")", "mutex_unlock", "(", "&", "current", "-", ">", "signal", "-", ">", "cred_guard_mutex", ")", ";", "abort_creds", "(", "bprm", "-", ">", "cred", ")", ";", "}", "/", "*", "If", "a", "binfmt", "changed", "the", "interp", ",", "free", "it", ".", "*", "/", "if", "(", "bprm", "-", ">", "interp", "!", "=", "bprm", "-", ">", "filename", ")", "kfree", "(", "bprm", "-", ">", "interp", ")", ";", "kfree", "(", "bprm", ")", ";", "}", "int", "bprm_change_interp", "(", "char", "*", "interp", ",", "struct", "linux_binprm", "*", "bprm", ")", "{", "/", "*", "If", "a", "binfmt", "changed", "the", "interp", ",", "free", "it", "first", ".", "*", "/", "if", "(", "bprm", "-", ">", "interp", "!", "=", "bprm", "-", ">", "filename", ")", "kfree", "(", "bprm", "-", ">", "interp", ")", ";", "bprm", "-", ">", "interp", "=", "kstrdup", "(", "interp", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "bprm", "-", ">", "interp", ")", "return", "-", "ENOMEM", ";", "return", "0", ";", "}", "EXPORT_SYMBOL", "(", "bprm_change_interp", ")", ";", "/", "*", "*", "install", "the", "new", "credentials", "for", "this", "executable", "*", "/", "@", "@", "-", "112", ",", "6", "+", "112", ",", "7", "@", "@", "extern", "int", "setup_arg_pages", "(", "struct", "linux_binprm", "*", "bprm", ",", "unsigned", "long", "stack_top", ",", "int", "executable_stack", ")", ";", "extern", "int", "bprm_mm_init", "(", "struct", "linux_binprm", "*", "bprm", ")", ";", "extern", "int", "bprm_change_interp", "(", "char", "*", "interp", ",", "struct", "linux_binprm", "*", "bprm", ")", ";", "extern", "int", "copy_strings_kernel", "(", "int", "argc", ",", "const", "char", "*", "const", "*", "argv", ",", "struct", "linux_binprm", "*", "bprm", ")", ";", "extern", "int", "prepare_bprm_creds", "(", "struct", "linux_binprm", "*", "bprm", ")", ";"], "docstring_tokens": ["the", "BINPRM_MAX_RECURSION", "can", "be", "exceeded", ":", "the", "maximum", "of", "4", "recursions", "is", "ignored"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2", ",", "6", "+", "2", ",", "8", "@", "@", "Broker", ":", "-", "Fix", "for", "poor", "websockets", "performance", ".", "-", "Fix", "lazy", "bridges", "not", "timing", "out", "for", "idle_timeout", ".", "Closes", "#", "417", ".", "-", "Fix", "problems", "with", "large", "retained", "messages", "over", "websockets", ".", "Closes", "#", "427", ".", "-", "Set", "persistence", "file", "to", "only", "be", "readable", "by", "owner", ",", "except", "on", "Windows", ".", "Closes", "#", "468", ".", "Clients", ":", "-", "Don", "'", "t", "use", "/", "in", "auto", "-", "generated", "client", "ids", ".", "@", "@", "-", "402", ",", "6", "+", "402", ",", "9", "@", "@", "int", "mqtt3_db_backup", "(", "struct", "mosquitto_db", "*", "db", ",", "bool", "shutdown", ")", "goto", "error", ";", "}", "}", "/", "*", "Set", "permissions", "to", "-", "rw", "-", "--", "--", "--", "*", "/", "umask", "(", "0077", ")", ";", "#", "endif", "db_fptr", "=", "_mosquitto_fopen", "(", "outfile", ",", "\"", "wb", "\"", ");"], "docstring_tokens": ["is", "world", "readable"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1", ",", "5", "+", "1", ",", "10", "@", "@", "#", "History", "#", "not", "yet", "published", ",", "version", "7", ".", "5", ".", "1", "-", "Fix", "object", "pollution", "vulnerability", "in", "`", "math", ".", "config", "`", ".", "Thanks", "Snyk", ".", "#", "2020", "-", "10", "-", "07", ",", "version", "7", ".", "5", ".", "0", "-", "Function", "`", "pickRandom", "`", "now", "allows", "randomly", "picking", "elements", "from", "matrices", "@", "@", "-", "86", ",", "7", "+", "86", ",", "9", "@", "@", "export", "function", "deepExtend", "(", "a", ",", "b", ")", "{", "}", "for", "(", "const", "prop", "in", "b", ")", "{", "if", "(", "hasOwnProperty", "(", "b", ",", "prop", ")", ")", "{", "/", "/", "We", "check", "against", "prop", "not", "being", "in", "Object", ".", "prototype", "or", "Function", ".", "prototype", "/", "/", "to", "prevent", "polluting", "for", "example", "Object", ".", "__proto__", ".", "if", "(", "hasOwnProperty", "(", "b", ",", "prop", ")", "&", "&", "!", "(", "prop", "in", "Object", ".", "prototype", ")", "&", "&", "!", "(", "prop", "in", "Function", ".", "prototype", ")", ")", "{", "if", "(", "b", "[", "prop", "]", "&", "&", "b", "[", "prop", "]", ".", "constructor", "=", "==", "Object", ")", "{", "if", "(", "a", "[", "prop", "]", "=", "==", "undefined", ")", "{", "a", "[", "prop", "]", "=", "{", "}", "@", "@", "-", "390", ",", "6", "+", "390", ",", "34", "@", "@", "describe", "(", "'", "security", "'", ",", "function", "(", ")", "{", "assert", ".", "strictEqual", "(", "math", ".", "expression", ".", "mathWithTransform", ".", "chain", ",", "undefined", ")", "assert", ".", "deepStrictEqual", "(", "math", ".", "evaluate", "(", "'", "chain", "'", "),", "math", ".", "unit", "(", "'", "chain", "'", "))", "}", ")", "it", "(", "'", "should", "not", "allow", "polluting", "the", "Object", "prototype", "via", "config", "'", ",", "(", ")", "=", ">", "{", "const", "obj", "=", "{", "}", "assert", ".", "strictEqual", "(", "obj", ".", "polluted", ",", "undefined", ")", "/", "/", "change", "the", "configuration", "const", "newConfig", "=", "JSON", ".", "parse", "(", "'{", "\"", "__proto__", "\"", ":{", "\"", "polluted", "\"", ":\"", "yes", "\"", "}}", "')", "math", ".", "config", "(", "newConfig", ")", "assert", ".", "strictEqual", "(", "obj", ".", "polluted", ",", "undefined", ")", "}", ")", "it", "(", "'", "should", "not", "allow", "polluting", "the", "Object", "prototype", "via", "config", "via", "the", "expression", "parser", "'", ",", "(", ")", "=", ">", "{", "const", "obj", "=", "{", "}", "assert", ".", "strictEqual", "(", "obj", ".", "polluted", ",", "undefined", ")", "/", "/", "change", "the", "configuration", "math", ".", "evaluate", "(", "'", "config", "(", "{\"", "__proto__", "\"", ":{", "\"", "polluted", "\"", ":\"", "yes", "\"", "}}", ")'", ")", "assert", ".", "strictEqual", "(", "obj", ".", "polluted", ",", "undefined", ")", "}", ")", "it", "(", "'", "should", "not", "allow", "polluting", "the", "Object", "prototype", "by", "creating", "an", "object", "in", "the", "expression", "parser", "'", ",", "(", ")", "=", ">", "{", "const", "obj", "=", "{", "}", "assert", ".", "strictEqual", "(", "obj", ".", "polluted", ",", "undefined", ")", "/", "/", "change", "the", "configuration", "math", ".", "evaluate", "(", "'", "a", "=", "{", "\"", "__proto__", "\"", ":{", "\"", "polluted", "\"", ":\"", "yes", "\"", "}}", "')", "assert", ".", "strictEqual", "(", "obj", ".", "polluted", ",", "undefined", ")", "}", ")", "}", ")", "function", "isPlainObject", "(", "object", ")", "{", "@", "@", "-", "141", ",", "6", "+", "141", ",", "14", "@", "@", "describe", "(", "'", "object", "'", ",", "function", "(", ")", "{", "delete", "Object", ".", "prototype", ".", "foo", "}", ")", "it", "(", "'", "should", "not", "pollute", "Object", ".", "__proto__", "'", ",", "function", "(", ")", "{", "const", "obj", "=", "{", "}", "assert", ".", "strictEqual", "(", "obj", ".", "polluted", ",", "undefined", ")", "deepExtend", "(", "obj", ",", "JSON", ".", "parse", "(", "'{", "\"", "__proto__", "\"", ":{", "\"", "polluted", "\"", ":\"", "yes", "\"", "}}", "')", ")", "assert", ".", "strictEqual", "(", "obj", ".", "polluted", ",", "undefined", ")", "}", ")", "}", ")", "describe", "(", "'", "deepEqual", "'", ",", "function", "(", ")", "{"], "docstring_tokens": ["a", "prototype", "pollution", "flaw", "in", "the", "deepExtend", "function", "during", "configuration", "updates"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "4", ",", "6", "+", "4", ",", "10", "@", "@", "Changes", "between", "0", ".", "9", ".", "8i", "and", "0", ".", "9", ".", "8j", "[", "xx", "XXX", "xxxx", "]", "*", ")", "Properly", "check", "EVP_VerifyFinal", "(", ")", "and", "similar", "return", "values", "(", "CVE", "-", "2008", "-", "5077", ")", ".", "[", "Ben", "Laurie", ",", "Bodo", "Moeller", ",", "Google", "Security", "Team", "]", "*", ")", "Enable", "TLS", "extensions", "by", "default", ".", "[", "Ben", "Laurie", "]", "@", "@", "-", "2132", ",", "7", "+", "2132", ",", "7", "@", "@", "int", "MAIN", "(", "int", "argc", ",", "char", "*", "*", "argv", ")", "{", "ret", "=", "RSA_verify", "(", "NID_md5_sha1", ",", "buf", ",", "36", ",", "buf2", ",", "rsa_num", ",", "rsa_key", "[", "j", "]", ");", "if", "(", "ret", "=", "=", "0", ")", "if", "(", "ret", "<", "=", "0", ")", "{", "BIO_printf", "(", "bio_err", ",", "\"", "RSA", "verify", "failure", "\\", "n", "\"", ");", "@", "@", "-", "285", ",", "7", "+", "285", ",", "7", "@", "@", "int", "MAIN", "(", "int", "argc", ",", "char", "*", "*", "argv", ")", "pkey", "=", "NETSCAPE_SPKI_get_pubkey", "(", "spki", ")", ";", "if", "(", "verify", ")", "{", "i", "=", "NETSCAPE_SPKI_verify", "(", "spki", ",", "pkey", ")", ";", "if", "(", "i", ")", "BIO_printf", "(", "bio_err", ",", "\"", "Signature", "OK", "\\", "n", "\"", ");", "if", "(", "i", ">", "0", ")", "BIO_printf", "(", "bio_err", ",", "\"", "Signature", "OK", "\\", "n", "\"", ");", "else", "{", "BIO_printf", "(", "bio_err", ",", "\"", "Signature", "Failure", "\\", "n", "\"", ");", "ERR_print_errors", "(", "bio_err", ")", ";", "@", "@", "-", "266", ",", "7", "+", "266", ",", "7", "@", "@", "static", "int", "check", "(", "X509_STORE", "*", "ctx", ",", "char", "*", "file", ",", "STACK_OF", "(", "X509", ")", "*", "uchain", ",", "STACK_OF", "(", "X", "ret", "=", "0", ";", "end", ":", "if", "(", "i", ")", "if", "(", "i", ">", "0", ")", "{", "fprintf", "(", "stdout", ",", "\"", "OK", "\\", "n", "\"", ");", "ret", "=", "1", ";", "@", "@", "-", "367", ",", "4", "+", "367", ",", "3", "@", "@", "static", "int", "MS_CALLBACK", "cb", "(", "int", "ok", ",", "X509_STORE_CTX", "*", "ctx", ")", "ERR_clear_error", "(", ");", "return", "(", "ok", ")", ";", "}", "@", "@", "-", "1151", ",", "7", "+", "1151", ",", "7", "@", "@", "static", "int", "x509_certify", "(", "X509_STORE", "*", "ctx", ",", "char", "*", "CAfile", ",", "const", "EVP_MD", "*", "digest", ",", "/", "*", "NOTE", ":", "this", "certificate", "can", "/", "should", "be", "self", "signed", ",", "unless", "it", "was", "*", "a", "certificate", "request", "in", "which", "case", "it", "is", "not", ".", "*", "/", "X509_STORE_CTX_set_cert", "(", "&", "xsc", ",", "x", ")", ";", "if", "(", "!", "reqfile", "&", "&", "!", "X509_verify_cert", "(", "&", "xsc", ")", ")", "if", "(", "!", "reqfile", "&", "&", "X509_verify_cert", "(", "&", "xsc", ")", "<", "=", "0", ")", "goto", "end", ";", "if", "(", "!", "X509_check_private_key", "(", "xca", ",", "pkey", ")", ")", "@", "@", "-", "830", ",", "7", "+", "830", ",", "7", "@", "@", "int", "CMS_SignerInfo_verify", "(", "CMS_SignerInfo", "*", "si", ")", "cms_fixup_mctx", "(", "&", "mctx", ",", "si", "-", ">", "pkey", ")", ";", "r", "=", "EVP_VerifyFinal", "(", "&", "mctx", ",", "si", "-", ">", "signature", "-", ">", "data", ",", "si", "-", ">", "signature", "-", ">", "length", ",", "si", "-", ">", "pkey", ")", ";", "if", "(", "!", "r", ")", "if", "(", "r", "<", "=", "0", ")", "CMSerr", "(", "CMS_F_CMS_SIGNERINFO_VERIFY", ",", "CMS_R_VERIFICATION_FAILURE", ")", ";", "err", ":", "EVP_MD_CTX_cleanup", "(", "&", "mctx", ")", ";", "@", "@", "-", "1044", ",", "7", "+", "1044", ",", "7", "@", "@", "int", "ssl2_set_certificate", "(", "SSL", "*", "s", ",", "int", "type", ",", "int", "len", ",", "const", "unsigned", "char", "*", "data", ")", "i", "=", "ssl_verify_cert_chain", "(", "s", ",", "sk", ")", ";", "if", "(", "(", "s", "-", ">", "verify_mode", "!", "=", "SSL_VERIFY_NONE", ")", "&", "&", "(", "!", "i", ")", ")", "if", "(", "(", "s", "-", ">", "verify_mode", "!", "=", "SSL_VERIFY_NONE", ")", "&", "&", "(", "i", "<", "=", "0", ")", ")", "{", "SSLerr", "(", "SSL_F_SSL2_SET_CERTIFICATE", ",", "SSL_R_CERTIFICATE_VERIFY_FAILED", ")", ";", "goto", "err", ";", "@", "@", "-", "1054", ",", "7", "+", "1054", ",", "7", "@", "@", "static", "int", "request_certificate", "(", "SSL", "*", "s", ")", "i", "=", "ssl_verify_cert_chain", "(", "s", ",", "sk", ")", ";", "if", "(", "i", ")", "/", "*", "we", "like", "the", "packet", ",", "now", "check", "the", "chksum", "*", "/", "if", "(", "i", ">", "0", ")", "/", "*", "we", "like", "the", "packet", ",", "now", "check", "the", "chksum", "*", "/", "{", "EVP_MD_CTX", "ctx", ";", "EVP_PKEY", "*", "pkey", "=", "NULL", ";", "@", "@", "-", "1083", ",", "7", "+", "1083", ",", "7", "@", "@", "static", "int", "request_certificate", "(", "SSL", "*", "s", ")", "EVP_PKEY_free", "(", "pkey", ")", ";", "EVP_MD_CTX_cleanup", "(", "&", "ctx", ")", ";", "if", "(", "i", ")", "if", "(", "i", ">", "0", ")", "{", "if", "(", "s", "-", ">", "session", "-", ">", "peer", "!", "=", "NULL", ")", "X509_free", "(", "s", "-", ">", "session", "-", ">", "peer", ")", ";", "@", "@", "-", "972", ",", "7", "+", "972", ",", "7", "@", "@", "int", "ssl3_get_server_certificate", "(", "SSL", "*", "s", ")", "}", "i", "=", "ssl_verify_cert_chain", "(", "s", ",", "sk", ")", ";", "if", "(", "(", "s", "-", ">", "verify_mode", "!", "=", "SSL_VERIFY_NONE", ")", "&", "&", "(", "!", "i", ")", "if", "(", "(", "s", "-", ">", "verify_mode", "!", "=", "SSL_VERIFY_NONE", ")", "&", "&", "(", "i", "<", "=", "0", ")", "#", "ifndef", "OPENSSL_NO_KRB5", "&", "&", "(", "s", "-", ">", "s3", "-", ">", "tmp", ".", "new_cipher", "-", ">", "algorithms", "&", "(", "SSL_MKEY_MASK", "|", "SSL_AUTH_MASK", ")", ")", "!", "=", "(", "SSL_aKRB5", "|", "SSL_kKRB5", ")", "@", "@", "-", "1459", ",", "7", "+", "1459", ",", "7", "@", "@", "int", "ssl3_get_key_exchange", "(", "SSL", "*", "s", ")", "EVP_VerifyUpdate", "(", "&", "md_ctx", ",", "&(", "s", "-", ">", "s3", "-", ">", "client_random", "[", "0", "]", "),", "SSL3_RANDOM_SIZE", ")", ";", "EVP_VerifyUpdate", "(", "&", "md_ctx", ",", "&(", "s", "-", ">", "s3", "-", ">", "server_random", "[", "0", "]", "),", "SSL3_RANDOM_SIZE", ")", ";", "EVP_VerifyUpdate", "(", "&", "md_ctx", ",", "param", ",", "param_len", ")", ";", "if", "(", "!", "EVP_VerifyFinal", "(", "&", "md_ctx", ",", "p", ",", "(", "int", ")", "n", ",", "pkey", ")", ")", "if", "(", "EVP_VerifyFinal", "(", "&", "md_ctx", ",", "p", ",", "(", "int", ")", "n", ",", "pkey", ")", "<", "=", "0", ")", "{", "/", "*", "bad", "signature", "*", "/", "al", "=", "SSL_AD_DECRYPT_ERROR", ";", "@", "@", "-", "1477", ",", "7", "+", "1477", ",", "7", "@", "@", "int", "ssl3_get_key_exchange", "(", "SSL", "*", "s", ")", "EVP_VerifyUpdate", "(", "&", "md_ctx", ",", "&(", "s", "-", ">", "s3", "-", ">", "client_random", "[", "0", "]", "),", "SSL3_RANDOM_SIZE", ")", ";", "EVP_VerifyUpdate", "(", "&", "md_ctx", ",", "&(", "s", "-", ">", "s3", "-", ">", "server_random", "[", "0", "]", "),", "SSL3_RANDOM_SIZE", ")", ";", "EVP_VerifyUpdate", "(", "&", "md_ctx", ",", "param", ",", "param_len", ")", ";", "if", "(", "!", "EVP_VerifyFinal", "(", "&", "md_ctx", ",", "p", ",", "(", "int", ")", "n", ",", "pkey", ")", ")", "if", "(", "EVP_VerifyFinal", "(", "&", "md_ctx", ",", "p", ",", "(", "int", ")", "n", ",", "pkey", ")", "<", "=", "0", ")", "{", "/", "*", "bad", "signature", "*", "/", "al", "=", "SSL_AD_DECRYPT_ERROR", ";", "@", "@", "-", "2566", ",", "7", "+", "2566", ",", "7", "@", "@", "int", "ssl3_get_client_certificate", "(", "SSL", "*", "s", ")", "else", "{", "i", "=", "ssl_verify_cert_chain", "(", "s", ",", "sk", ")", ";", "if", "(", "!", "i", ")", "if", "(", "i", "<", "=", "0", ")", "{", "al", "=", "ssl_verify_alarm_type", "(", "s", "-", ">", "verify_result", ")", ";", "SSLerr", "(", "SSL_F_SSL3_GET_CLIENT_CERTIFICATE", ",", "SSL_R_NO_CERTIFICATE_RETURNED", ")", ";", "@", "@", "-", "2093", ",", "7", "+", "2093", ",", "7", "@", "@", "static", "int", "MS_CALLBACK", "app_verify_callback", "(", "X509_STORE_CTX", "*", "ctx", ",", "void", "*", "arg", ")", "if", "(", "cb_arg", "-", ">", "proxy_auth", ")", "{", "if", "(", "ok", ")", "if", "(", "ok", ">", "0", ")", "{", "const", "char", "*", "cond_end", "=", "NULL", ";"], "docstring_tokens": ["does", "not", "properly", "check", "the", "return", "value", "from", "the", "EVP_VerifyFinal", "function"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "4119", ",", "8", "+", "4119", ",", "7", "@", "@", "nfsd4_encode_getdeviceinfo", "(", "struct", "nfsd4_compoundres", "*", "resp", ",", "__be32", "nfserr", ",", "struct", "nfsd4_getdeviceinfo", "*", "gdev", ")", "{", "struct", "xdr_stream", "*", "xdr", "=", "&", "resp", "-", ">", "xdr", ";", "const", "struct", "nfsd4_layout_ops", "*", "ops", "=", "nfsd4_layout_ops", "[", "gdev", "-", ">", "gd_layout_type", "]", ";", "const", "struct", "nfsd4_layout_ops", "*", "ops", ";", "u32", "starting_len", "=", "xdr", "-", ">", "buf", "-", ">", "len", ",", "needed_len", ";", "__be32", "*", "p", ";", "@", "@", "-", "4137", ",", "6", "+", "4136", ",", "7", "@", "@", "nfsd4_encode_getdeviceinfo", "(", "struct", "nfsd4_compoundres", "*", "resp", ",", "__be32", "nfserr", ",", "/", "*", "If", "maxcount", "is", "0", "then", "just", "update", "notifications", "*", "/", "if", "(", "gdev", "-", ">", "gd_maxcount", "!", "=", "0", ")", "{", "ops", "=", "nfsd4_layout_ops", "[", "gdev", "-", ">", "gd_layout_type", "]", ";", "nfserr", "=", "ops", "-", ">", "encode_getdeviceinfo", "(", "xdr", ",", "gdev", ")", ";", "if", "(", "nfserr", ")", "{", "/", "*", "@", "@", "-", "4189", ",", "8", "+", "4189", ",", "7", "@", "@", "nfsd4_encode_layoutget", "(", "struct", "nfsd4_compoundres", "*", "resp", ",", "__be32", "nfserr", ",", "struct", "nfsd4_layoutget", "*", "lgp", ")", "{", "struct", "xdr_stream", "*", "xdr", "=", "&", "resp", "-", ">", "xdr", ";", "const", "struct", "nfsd4_layout_ops", "*", "ops", "=", "nfsd4_layout_ops", "[", "lgp", "-", ">", "lg_layout_type", "]", ";", "const", "struct", "nfsd4_layout_ops", "*", "ops", ";", "__be32", "*", "p", ";", "dprintk", "(", "\"%", "s", ":", "err", "%", "d", "\\", "n", "\"", ",", "__func__", ",", "nfserr", ")", ";", "@", "@", "-", "4213", ",", "6", "+", "4212", ",", "7", "@", "@", "nfsd4_encode_layoutget", "(", "struct", "nfsd4_compoundres", "*", "resp", ",", "__be32", "nfserr", ",", "*", "p", "+", "+", "=", "cpu_to_be32", "(", "lgp", "-", ">", "lg_seg", ".", "iomode", ")", ";", "*", "p", "+", "+", "=", "cpu_to_be32", "(", "lgp", "-", ">", "lg_layout_type", ")", ";", "ops", "=", "nfsd4_layout_ops", "[", "lgp", "-", ">", "lg_layout_type", "]", ";", "nfserr", "=", "ops", "-", ">", "encode_layoutget", "(", "xdr", ",", "lgp", ")", ";", "out", ":", "kfree", "(", "lgp", "-", ">", "lg_content", ")", ";"], "docstring_tokens": ["not", "properly", "mitigated", "in", "the", "network"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1154", ",", "6", "+", "1154", ",", "8", "@", "@", "static", "ssize_t", "hid_debug_events_read", "(", "struct", "file", "*", "file", ",", "char", "__user", "*", "buffer", ",", "goto", "out", ";", "if", "(", "list", "-", ">", "tail", ">", "list", "-", ">", "head", ")", "{", "len", "=", "list", "-", ">", "tail", "-", "list", "-", ">", "head", ";", "if", "(", "len", ">", "count", ")", "len", "=", "count", ";", "if", "(", "copy_to_user", "(", "buffer", "+", "ret", ",", "&", "list", "-", ">", "hid_debug_buf", "[", "list", "-", ">", "head", "]", ",", "len", ")", ")", "{", "ret", "=", "-", "EFAULT", ";", "@", "@", "-", "1163", ",", "14", "+", "1165", ",", "18", "@", "@", "static", "ssize_t", "hid_debug_events_read", "(", "struct", "file", "*", "file", ",", "char", "__user", "*", "buffer", ",", "list", "-", ">", "head", "+", "=", "len", ";", "}", "else", "{", "len", "=", "HID_DEBUG_BUFSIZE", "-", "list", "-", ">", "head", ";", "if", "(", "len", ">", "count", ")", "len", "=", "count", ";", "if", "(", "copy_to_user", "(", "buffer", ",", "&", "list", "-", ">", "hid_debug_buf", "[", "list", "-", ">", "head", "]", ",", "len", ")", ")", "{", "ret", "=", "-", "EFAULT", ";", "goto", "out", ";", "}", "list", "-", ">", "head", "=", "0", ";", "ret", "+", "=", "len", ";", "goto", "copy_rest", ";", "count", "-", "=", "len", ";", "if", "(", "count", ">", "0", ")", "goto", "copy_rest", ";", "}", "}"], "docstring_tokens": ["due", "to", "a", "missing", "bounds", "check", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "31", ",", "6", "+", "31", ",", "11", "@", "@", "struct", "skcipher_sg_list", "{", "struct", "scatterlist", "sg", "[", "0", "]", ";", "}", ";", "struct", "skcipher_tfm", "{", "struct", "crypto_skcipher", "*", "skcipher", ";", "bool", "has_key", ";", "}", ";", "struct", "skcipher_ctx", "{", "struct", "list_head", "tsgl", ";", "struct", "af_alg_sgl", "rsgl", ";", "@", "@", "-", "750", ",", "17", "+", "755", ",", "41", "@", "@", "static", "struct", "proto_ops", "algif_skcipher_ops", "=", "{", "static", "void", "*", "skcipher_bind", "(", "const", "char", "*", "name", ",", "u32", "type", ",", "u32", "mask", ")", "{", "return", "crypto_alloc_skcipher", "(", "name", ",", "type", ",", "mask", ")", ";", "struct", "skcipher_tfm", "*", "tfm", ";", "struct", "crypto_skcipher", "*", "skcipher", ";", "tfm", "=", "kzalloc", "(", "sizeof", "(", "*", "tfm", ")", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "tfm", ")", "return", "ERR_PTR", "(", "-", "ENOMEM", ")", ";", "skcipher", "=", "crypto_alloc_skcipher", "(", "name", ",", "type", ",", "mask", ")", ";", "if", "(", "IS_ERR", "(", "skcipher", ")", ")", "{", "kfree", "(", "tfm", ")", ";", "return", "ERR_CAST", "(", "skcipher", ")", ";", "}", "tfm", "-", ">", "skcipher", "=", "skcipher", ";", "return", "tfm", ";", "}", "static", "void", "skcipher_release", "(", "void", "*", "private", ")", "{", "crypto_free_skcipher", "(", "private", ")", ";", "struct", "skcipher_tfm", "*", "tfm", "=", "private", ";", "crypto_free_skcipher", "(", "tfm", "-", ">", "skcipher", ")", ";", "kfree", "(", "tfm", ")", ";", "}", "static", "int", "skcipher_setkey", "(", "void", "*", "private", ",", "const", "u8", "*", "key", ",", "unsigned", "int", "keylen", ")", "{", "return", "crypto_skcipher_setkey", "(", "private", ",", "key", ",", "keylen", ")", ";", "struct", "skcipher_tfm", "*", "tfm", "=", "private", ";", "int", "err", ";", "err", "=", "crypto_skcipher_setkey", "(", "tfm", "-", ">", "skcipher", ",", "key", ",", "keylen", ")", ";", "tfm", "-", ">", "has_key", "=", "!", "err", ";", "return", "err", ";", "}", "static", "void", "skcipher_wait", "(", "struct", "sock", "*", "sk", ")", "@", "@", "-", "792", ",", "20", "+", "821", ",", "25", "@", "@", "static", "int", "skcipher_accept_parent", "(", "void", "*", "private", ",", "struct", "sock", "*", "sk", ")", "{", "struct", "skcipher_ctx", "*", "ctx", ";", "struct", "alg_sock", "*", "ask", "=", "alg_sk", "(", "sk", ")", ";", "unsigned", "int", "len", "=", "sizeof", "(", "*", "ctx", ")", "+", "crypto_skcipher_reqsize", "(", "private", ")", ";", "struct", "skcipher_tfm", "*", "tfm", "=", "private", ";", "struct", "crypto_skcipher", "*", "skcipher", "=", "tfm", "-", ">", "skcipher", ";", "unsigned", "int", "len", "=", "sizeof", "(", "*", "ctx", ")", "+", "crypto_skcipher_reqsize", "(", "skcipher", ")", ";", "if", "(", "!", "tfm", "-", ">", "has_key", ")", "return", "-", "ENOKEY", ";", "ctx", "=", "sock_kmalloc", "(", "sk", ",", "len", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "ctx", ")", "return", "-", "ENOMEM", ";", "ctx", "-", ">", "iv", "=", "sock_kmalloc", "(", "sk", ",", "crypto_skcipher_ivsize", "(", "private", ")", ",", "ctx", "-", ">", "iv", "=", "sock_kmalloc", "(", "sk", ",", "crypto_skcipher_ivsize", "(", "skcipher", ")", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "ctx", "-", ">", "iv", ")", "{", "sock_kfree_s", "(", "sk", ",", "ctx", ",", "len", ")", ";", "return", "-", "ENOMEM", ";", "}", "memset", "(", "ctx", "-", ">", "iv", ",", "0", ",", "crypto_skcipher_ivsize", "(", "private", ")", ");", "memset", "(", "ctx", "-", ">", "iv", ",", "0", ",", "crypto_skcipher_ivsize", "(", "skcipher", ")", ");", "INIT_LIST_HEAD", "(", "&", "ctx", "-", ">", "tsgl", ")", ";", "ctx", "-", ">", "len", "=", "len", ";", "@", "@", "-", "818", ",", "7", "+", "852", ",", "7", "@", "@", "static", "int", "skcipher_accept_parent", "(", "void", "*", "private", ",", "struct", "sock", "*", "sk", ")", "ask", "-", ">", "private", "=", "ctx", ";", "skcipher_request_set_tfm", "(", "&", "ctx", "-", ">", "req", ",", "private", ")", ";", "skcipher_request_set_tfm", "(", "&", "ctx", "-", ">", "req", ",", "skcipher", ")", ";", "skcipher_request_set_callback", "(", "&", "ctx", "-", ">", "req", ",", "CRYPTO_TFM_REQ_MAY_BACKLOG", ",", "af_alg_complete", ",", "&", "ctx", "-", ">", "completion", ")", ";"], "docstring_tokens": ["does", "not", "verify", "that", "a", "setkey", "operation", "has", "been", "performed", "on", "an", "AF_ALG", "socket", "before", "an", "accept", "system", "call", "is", "processed"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "141", ",", "6", "+", "141", ",", "10", "@", "@", "int", "xstateregs_set", "(", "struct", "task_struct", "*", "target", ",", "const", "struct", "user_regset", "*", "regset", ",", "ret", "=", "copy_user_to_xstate", "(", "xsave", ",", "ubuf", ")", ";", "}", "else", "{", "ret", "=", "user_regset_copyin", "(", "&", "pos", ",", "&", "count", ",", "&", "kbuf", ",", "&", "ubuf", ",", "xsave", ",", "0", ",", "-", "1", ")", ";", "/", "*", "xcomp_bv", "must", "be", "0", "when", "using", "uncompacted", "format", "*", "/", "if", "(", "!", "ret", "&", "&", "xsave", "-", ">", "header", ".", "xcomp_bv", ")", "ret", "=", "-", "EINVAL", ";", "}", "/", "*", "@", "@", "-", "324", ",", "11", "+", "324", ",", "16", "@", "@", "static", "int", "__fpu__restore_sig", "(", "void", "__user", "*", "buf", ",", "void", "__user", "*", "buf_fx", ",", "int", "size", ")", "*", "/", "fpu__drop", "(", "fpu", ")", ";", "if", "(", "using_compacted_format", "(", "))", "if", "(", "using_compacted_format", "(", "))", "{", "err", "=", "copy_user_to_xstate", "(", "&", "fpu", "-", ">", "state", ".", "xsave", ",", "buf_fx", ")", ";", "else", "}", "else", "{", "err", "=", "__copy_from_user", "(", "&", "fpu", "-", ">", "state", ".", "xsave", ",", "buf_fx", ",", "state_size", ")", ";", "/", "*", "xcomp_bv", "must", "be", "0", "when", "using", "uncompacted", "format", "*", "/", "if", "(", "!", "err", "&", "&", "state_size", ">", "offsetof", "(", "struct", "xregs_state", ",", "header", ")", "&", "&", "fpu", "-", ">", "state", ".", "xsave", ".", "header", ".", "xcomp_bv", ")", "err", "=", "-", "EINVAL", ";", "}", "if", "(", "err", "|", "|", "__copy_from_user", "(", "&", "env", ",", "buf", ",", "sizeof", "(", "env", ")", "))", "{", "fpstate_init", "(", "&", "fpu", "-", ">", "state", ")", ";", "trace_x86_fpu_init_state", "(", "fpu", ")", ";"], "docstring_tokens": ["a", "flaw", "in", "the", "x86/fpu", "(Floating", "Point", "Unit", ")", "subsystem"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "29", ",", "7", "+", "29", ",", "7", "@", "@", "$", "(", "document", ")", ".", "ready", "(", "function", "(", "){", "/", "/", "this", "allows", "to", "display", "debug", "logs", "directly", "on", "the", "web", "page", "client", ".", "debug", "=", "function", "(", "str", ")", "{", "$", "(\"", "#", "debug", "\"", ").", "append", "(", "str", "+", "\"", "\\", "n", "\"", ");", "$", "(\"", "#", "debug", "\"", ").", "append", "(", "document", ".", "createTextNode", "(", "str", "+", "\"", "\\", "n", "\"", "))", ";", "}", ";", "/", "/", "the", "client", "is", "notified", "when", "it", "is", "connected", "to", "the", "server", ".", "var", "onconnect", "=", "function", "(", "frame", ")", "{", "@", "@", "-", "39", ",", "7", "+", "39", ",", "7", "@", "@", "$", "(", "document", ")", ".", "ready", "(", "function", "(", "){", "$", "('", "#", "send_form_input", "'", ").", "removeAttr", "(", "'", "disabled", "'", ");", "client", ".", "subscribe", "(", "destination", ",", "function", "(", "message", ")", "{", "$", "(\"", "#", "messages", "\"", ").", "append", "(", "\"<", "p", ">", "\"", "+", "message", ".", "body", "+", "\"", "</", "p", ">", "\\", "n", "\"", ");", "$", "(\"", "#", "messages", "\"", ").", "append", "(", "document", ".", "createTextNode", "(", "\"<", "p", ">", "\"", "+", "message", ".", "body", "+", "\"", "</", "p", ">", "\\", "n", "\"", "))", ";", "}", ");", "}", ";", "client", ".", "connect", "(", "login", ",", "passcode", ",", "onconnect", ")", ";", "@", "@", "-", "70", ",", "7", "+", "70", ",", "8", "@", "@", "protected", "void", "doGet", "(", "HttpServletRequest", "request", ",", "HttpServletResponse", "response", ")", "t", "}", "out", ".", "print", "(", "refreshRate", ")", ";", "out", ".", "println", "(", "\"'", "/>", "</", "head", ">", "\")", ";", "out", ".", "println", "(", "\"<", "body", ">", "Published", "<", "b", ">", "\"", "+", "count", "+", "\"", "</", "b", ">", "of", "\"", "+", "total", "+", "\"", "price", "messages", ".", "Refresh", "=", "\"", "+", "refreshRate", "+", "\"", "s", "\"", ");", "out", ".", "println", "(", "\"<", "body", ">", "Published", "<", "b", ">", "\"", "+", "escape", "(", "Integer", ".", "toString", "(", "count", ")", ")", "+", "\"", "</", "b", ">", "of", "\"", "+", "escape", "(", "Integer", ".", "toString", "(", "total", ")", ")", "+", "\"", "price", "messages", ".", "Refresh", "=", "\"", "+", "escape", "(", "refreshRate", ")", "+", "\"", "s", "\"", ");", "out", ".", "println", "(", "\"<", "/", "body", ">", "</", "html", ">", "\")", ";", "}", "catch", "(", "JMSException", "e", ")", "{", "@", "@", "-", "129", ",", "4", "+", "130", ",", "8", "@", "@", "protected", "int", "getNumberOfMessages", "(", "HttpServletRequest", "request", ")", "{", "}", "return", "1", ";", "}", "protected", "String", "escape", "(", "String", "text", ")", "throws", "IOException", "{", "return", "java", ".", "net", ".", "URLEncoder", ".", "encode", "(", "text", ",", "\"", "UTF", "-", "8", "\"", ");", "}", "}"], "docstring_tokens": ["improper", "validation", "of", "user-supplied", "input"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "296", ",", "6", "+", "296", ",", "7", "@", "@", "struct", "x86_emulate_ctxt", "{", "bool", "perm_ok", ";", "/", "*", "do", "not", "check", "permissions", "if", "true", "*", "/", "bool", "ud", ";", "/", "*", "inject", "an", "#", "UD", "if", "host", "doesn", "'", "t", "support", "insn", "*", "/", "bool", "tf", ";", "/", "*", "TF", "value", "before", "instruction", "(", "after", "for", "syscall", "/", "sysret", ")", "*", "/", "bool", "have_exception", ";", "struct", "x86_exception", "exception", ";", "@", "@", "-", "2742", ",", "6", "+", "2742", ",", "7", "@", "@", "static", "int", "em_syscall", "(", "struct", "x86_emulate_ctxt", "*", "ctxt", ")", "ctxt", "-", ">", "eflags", "&", "=", "~", "(", "X86_EFLAGS_VM", "|", "X86_EFLAGS_IF", ")", ";", "}", "ctxt", "-", ">", "tf", "=", "(", "ctxt", "-", ">", "eflags", "&", "X86_EFLAGS_TF", ")", "!", "=", "0", ";", "return", "X86EMUL_CONTINUE", ";", "}", "@", "@", "-", "5313", ",", "6", "+", "5313", ",", "8", "@", "@", "static", "void", "init_emulate_ctxt", "(", "struct", "kvm_vcpu", "*", "vcpu", ")", "kvm_x86_ops", "-", ">", "get_cs_db_l_bits", "(", "vcpu", ",", "&", "cs_db", ",", "&", "cs_l", ")", ";", "ctxt", "-", ">", "eflags", "=", "kvm_get_rflags", "(", "vcpu", ")", ";", "ctxt", "-", ">", "tf", "=", "(", "ctxt", "-", ">", "eflags", "&", "X86_EFLAGS_TF", ")", "!", "=", "0", ";", "ctxt", "-", ">", "eip", "=", "kvm_rip_read", "(", "vcpu", ")", ";", "ctxt", "-", ">", "mode", "=", "(", "!", "is_protmode", "(", "vcpu", ")", ")", "?", "X86EMUL_MODE_REAL", ":", "(", "ctxt", "-", ">", "eflags", "&", "X86_EFLAGS_VM", ")", "?", "X86EMUL_MODE_VM86", ":", "@", "@", "-", "5528", ",", "36", "+", "5530", ",", "25", "@", "@", "static", "int", "kvm_vcpu_check_hw_bp", "(", "unsigned", "long", "addr", ",", "u32", "type", ",", "u32", "dr7", ",", "return", "dr6", ";", "}", "static", "void", "kvm_vcpu_check_singlestep", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "unsigned", "long", "rflags", ",", "int", "*", "r", ")", "static", "void", "kvm_vcpu_do_singlestep", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "int", "*", "r", ")", "{", "struct", "kvm_run", "*", "kvm_run", "=", "vcpu", "-", ">", "run", ";", "/", "*", "*", "rflags", "is", "the", "old", ",", "\"", "raw", "\"", "value", "of", "the", "flags", ".", "The", "new", "value", "has", "*", "not", "been", "saved", "yet", ".", "*", "*", "This", "is", "correct", "even", "for", "TF", "set", "by", "the", "guest", ",", "because", "\"", "the", "*", "processor", "will", "not", "generate", "this", "exception", "after", "the", "instruction", "*", "that", "sets", "the", "TF", "flag", "\"", ".", "*", "/", "if", "(", "unlikely", "(", "rflags", "&", "X86_EFLAGS_TF", ")", ")", "{", "if", "(", "vcpu", "-", ">", "guest_debug", "&", "KVM_GUESTDBG_SINGLESTEP", ")", "{", "kvm_run", "-", ">", "debug", ".", "arch", ".", "dr6", "=", "DR6_BS", "|", "DR6_FIXED_1", "|", "DR6_RTM", ";", "kvm_run", "-", ">", "debug", ".", "arch", ".", "pc", "=", "vcpu", "-", ">", "arch", ".", "singlestep_rip", ";", "kvm_run", "-", ">", "debug", ".", "arch", ".", "exception", "=", "DB_VECTOR", ";", "kvm_run", "-", ">", "exit_reason", "=", "KVM_EXIT_DEBUG", ";", "*", "r", "=", "EMULATE_USER_EXIT", ";", "}", "else", "{", "/", "*", "*", "\"", "Certain", "debug", "exceptions", "may", "clear", "bit", "0", "-", "3", ".", "The", "*", "remaining", "contents", "of", "the", "DR6", "register", "are", "never", "*", "cleared", "by", "the", "processor", "\"", ".", "*", "/", "vcpu", "-", ">", "arch", ".", "dr6", "&", "=", "~", "15", ";", "vcpu", "-", ">", "arch", ".", "dr6", "|", "=", "DR6_BS", "|", "DR6_RTM", ";", "kvm_queue_exception", "(", "vcpu", ",", "DB_VECTOR", ")", ";", "}", "if", "(", "vcpu", "-", ">", "guest_debug", "&", "KVM_GUESTDBG_SINGLESTEP", ")", "{", "kvm_run", "-", ">", "debug", ".", "arch", ".", "dr6", "=", "DR6_BS", "|", "DR6_FIXED_1", "|", "DR6_RTM", ";", "kvm_run", "-", ">", "debug", ".", "arch", ".", "pc", "=", "vcpu", "-", ">", "arch", ".", "singlestep_rip", ";", "kvm_run", "-", ">", "debug", ".", "arch", ".", "exception", "=", "DB_VECTOR", ";", "kvm_run", "-", ">", "exit_reason", "=", "KVM_EXIT_DEBUG", ";", "*", "r", "=", "EMULATE_USER_EXIT", ";", "}", "else", "{", "/", "*", "*", "\"", "Certain", "debug", "exceptions", "may", "clear", "bit", "0", "-", "3", ".", "The", "*", "remaining", "contents", "of", "the", "DR6", "register", "are", "never", "*", "cleared", "by", "the", "processor", "\"", ".", "*", "/", "vcpu", "-", ">", "arch", ".", "dr6", "&", "=", "~", "15", ";", "vcpu", "-", ">", "arch", ".", "dr6", "|", "=", "DR6_BS", "|", "DR6_RTM", ";", "kvm_queue_exception", "(", "vcpu", ",", "DB_VECTOR", ")", ";", "}", "}", "@", "@", "-", "5567", ",", "7", "+", "5558", ",", "17", "@", "@", "int", "kvm_skip_emulated_instruction", "(", "struct", "kvm_vcpu", "*", "vcpu", ")", "int", "r", "=", "EMULATE_DONE", ";", "kvm_x86_ops", "-", ">", "skip_emulated_instruction", "(", "vcpu", ")", ";", "kvm_vcpu_check_singlestep", "(", "vcpu", ",", "rflags", ",", "&", "r", ")", ";", "/", "*", "*", "rflags", "is", "the", "old", ",", "\"", "raw", "\"", "value", "of", "the", "flags", ".", "The", "new", "value", "has", "*", "not", "been", "saved", "yet", ".", "*", "*", "This", "is", "correct", "even", "for", "TF", "set", "by", "the", "guest", ",", "because", "\"", "the", "*", "processor", "will", "not", "generate", "this", "exception", "after", "the", "instruction", "*", "that", "sets", "the", "TF", "flag", "\"", ".", "*", "/", "if", "(", "unlikely", "(", "rflags", "&", "X86_EFLAGS_TF", ")", ")", "kvm_vcpu_do_singlestep", "(", "vcpu", ",", "&", "r", ")", ";", "return", "r", "=", "=", "EMULATE_DONE", ";", "}", "EXPORT_SYMBOL_GPL", "(", "kvm_skip_emulated_instruction", ")", ";", "@", "@", "-", "5726", ",", "8", "+", "5727", ",", "9", "@", "@", "int", "x86_emulate_instruction", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "toggle_interruptibility", "(", "vcpu", ",", "ctxt", "-", ">", "interruptibility", ")", ";", "vcpu", "-", ">", "arch", ".", "emulate_regs_need_sync_to_vcpu", "=", "false", ";", "kvm_rip_write", "(", "vcpu", ",", "ctxt", "-", ">", "eip", ")", ";", "if", "(", "r", "=", "=", "EMULATE_DONE", ")", "kvm_vcpu_check_singlestep", "(", "vcpu", ",", "rflags", ",", "&", "r", ")", ";", "if", "(", "r", "=", "=", "EMULATE_DONE", "&", "&", "(", "ctxt", "-", ">", "tf", "|", "|", "(", "vcpu", "-", ">", "guest_debug", "&", "KVM_GUESTDBG_SINGLESTEP", ")", "))", "kvm_vcpu_do_singlestep", "(", "vcpu", ",", "&", "r", ")", ";", "if", "(", "!", "ctxt", "-", ">", "have_exception", "|", "|", "exception_type", "(", "ctxt", "-", ">", "exception", ".", "vector", ")", "=", "=", "EXCPT_TRAP", ")", "__kvm_set_rflags", "(", "vcpu", ",", "ctxt", "-", ">", "eflags", ")", ";"], "docstring_tokens": ["an", "incorrect", "debug", "exception(#DB", ")", "error"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "44", ",", "11", "+", "44", ",", "9", "@", "@", "import", "org", ".", "springframework", ".", "expression", ".", "Expression", ";", "import", "org", ".", "springframework", ".", "expression", ".", "TypedValue", ";", "import", "org", ".", "springframework", ".", "expression", ".", "spel", ".", "SpelEvaluationException", ";", "import", "org", ".", "springframework", ".", "expression", ".", "spel", ".", "SpelMessage", ";", "import", "org", ".", "springframework", ".", "expression", ".", "spel", ".", "SpelParserConfiguration", ";", "import", "org", ".", "springframework", ".", "expression", ".", "spel", ".", "standard", ".", "SpelExpressionParser", ";", "import", "org", ".", "springframework", ".", "expression", ".", "spel", ".", "support", ".", "StandardEvaluationContext", ";", "import", "org", ".", "springframework", ".", "expression", ".", "spel", ".", "support", ".", "StandardTypeConverter", ";", "import", "org", ".", "springframework", ".", "expression", ".", "spel", ".", "support", ".", "SimpleEvaluationContext", ";", "import", "org", ".", "springframework", ".", "lang", ".", "Nullable", ";", "import", "org", ".", "springframework", ".", "util", ".", "Assert", ";", "import", "org", ".", "springframework", ".", "web", ".", "bind", ".", "WebDataBinder", ";", "@", "@", "-", "176", ",", "16", "+", "174", ",", "6", "@", "@", "public", "void", "setPropertyValue", "(", "String", "propertyName", ",", "@", "Nullable", "Object", "value", ")", "throws", "throw", "new", "NotWritablePropertyException", "(", "type", ",", "propertyName", ")", ";", "}", "StandardEvaluationContext", "context", "=", "new", "StandardEvaluationContext", "(", ");", "context", ".", "addPropertyAccessor", "(", "new", "PropertyTraversingMapAccessor", "(", "type", ",", "conversionService", ")", ");", "context", ".", "setTypeConverter", "(", "new", "StandardTypeConverter", "(", "conversionService", ")", ");", "context", ".", "setTypeLocator", "(", "typeName", "-", ">", "{", "throw", "new", "SpelEvaluationException", "(", "SpelMessage", ".", "TYPE_NOT_FOUND", ",", "typeName", ")", ";", "}", ");", "context", ".", "setRootObject", "(", "map", ")", ";", "Expression", "expression", "=", "PARSER", ".", "parseExpression", "(", "propertyName", ")", ";", "PropertyPath", "leafProperty", "=", "getPropertyPath", "(", "propertyName", ")", ".", "getLeafProperty", "(", ");", "TypeInformation", "<", "?>", "owningType", "=", "leafProperty", ".", "getOwningType", "(", ");", "TypeInformation", "<", "?>", "propertyType", "=", "leafProperty", ".", "getTypeInformation", "(", ");", "@", "@", "-", "213", ",", "6", "+", "201", ",", "14", "@", "@", "public", "void", "setPropertyValue", "(", "String", "propertyName", ",", "@", "Nullable", "Object", "value", ")", "throws", "value", "=", "conversionService", ".", "convert", "(", "value", ",", "TypeDescriptor", ".", "forObject", "(", "value", ")", ",", "typeDescriptor", ")", ";", "}", "EvaluationContext", "context", "=", "SimpleEvaluationContext", "/", "/", ".", "forPropertyAccessors", "(", "new", "PropertyTraversingMapAccessor", "(", "type", ",", "conversionService", ")", ")", "/", "/", ".", "withConversionService", "(", "conversionService", ")", "/", "/", ".", "withRootObject", "(", "map", ")", "/", "/", ".", "build", "(", ");", "Expression", "expression", "=", "PARSER", ".", "parseExpression", "(", "propertyName", ")", ";", "try", "{", "expression", ".", "setValue", "(", "context", ",", "value", ")", ";", "}", "catch", "(", "SpelEvaluationException", "o_O", ")", "{"], "docstring_tokens": ["does", "not", "have", "a", "list", "of", "classes", "allowed", "for", "serialization/deserialization"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "52", ",", "6", "+", "52", ",", "8", "@", "@", "project", "(", "jansson", "C", ")", "#", "Options", "OPTION", "(", "BUILD_SHARED_LIBS", "\"", "Build", "shared", "libraries", ".", "\"", "OFF", ")", "OPTION", "(", "USE_URANDOM", "\"", "Use", "/", "dev", "/", "urandom", "to", "seed", "the", "hash", "function", ".", "\"", "ON", ")", "OPTION", "(", "USE_WINDOWS_CRYPTOAPI", "\"", "Use", "CryptGenRandom", "to", "seed", "the", "hash", "function", ".", "\"", "ON", ")", "if", "(", "MSVC", ")", "#", "This", "option", "must", "match", "the", "settings", "used", "in", "your", "program", ",", "in", "particular", "if", "you", "@", "@", "-", "85", ",", "12", "+", "87", ",", "12", "@", "@", "set", "(", "JANSSON_SOVERSION", "4", ")", "#", "for", "CheckFunctionKeywords", "set", "(", "CMAKE_MODULE_PATH", "\"", "${", "CMAKE_CURRENT_SOURCE_DIR", "}", "/", "cmake", "\"", ")", "INCLUDE", "(", "CheckCSourceCompiles", ")", "include", "(", "CheckFunctionExists", ")", "include", "(", "CheckFunctionKeywords", ")", "include", "(", "CheckIncludeFiles", ")", "include", "(", "CheckTypeSize", ")", "if", "(", "MSVC", ")", "#", "Turn", "off", "Microsofts", "\"", "security", "\"", "warnings", ".", "add_definitions", "(", "\"", "/", "W3", "/", "D_CRT_SECURE_NO_WARNINGS", "/", "wd4005", "/", "wd4996", "/", "nologo", "\"", ")", "@", "@", "-", "106", ",", "14", "+", "108", ",", "25", "@", "@", "if", "(", "CMAKE_COMPILER_IS_GNUCC", "OR", "CMAKE_COMPILER_IS_GNUCXX", ")", "set", "(", "CMAKE_C_FLAGS", "\"", "-", "fPIC", "\"", ")", "endif", "(", ")", "check_include_files", "(", "endian", ".", "h", "HAVE_ENDIAN_H", ")", "check_include_files", "(", "fcntl", ".", "h", "HAVE_FCNTL_H", ")", "check_include_files", "(", "sched", ".", "h", "HAVE_SCHED_H", ")", "check_include_files", "(", "unistd", ".", "h", "HAVE_UNISTD_H", ")", "check_include_files", "(", "sys", "/", "param", ".", "h", "HAVE_SYS_PARAM_H", ")", "check_include_files", "(", "sys", "/", "stat", ".", "h", "HAVE_SYS_STAT_H", ")", "check_include_files", "(", "sys", "/", "time", ".", "h", "HAVE_SYS_TIME_H", ")", "check_include_files", "(", "sys", "/", "time", ".", "h", "HAVE_SYS_TYPES_H", ")", "check_function_exists", "(", "close", "HAVE_CLOSE", ")", "check_function_exists", "(", "getpid", "HAVE_GETPID", ")", "check_function_exists", "(", "gettimeofday", "HAVE_GETTIMEOFDAY", ")", "check_function_exists", "(", "open", "HAVE_OPEN", ")", "check_function_exists", "(", "read", "HAVE_READ", ")", "check_function_exists", "(", "sched_yield", "HAVE_SCHED_YIELD", ")", "#", "Check", "for", "the", "int", "-", "type", "includes", "check_include_files", "(", "sys", "/", "types", ".", "h", "HAVE_SYS_TYPES_H", ")", "check_include_files", "(", "inttypes", ".", "h", "HAVE_INTTYPES_H", ")", "check_include_files", "(", "stdint", ".", "h", "HAVE_STDINT_H", ")", "#", "Check", "our", "64", "bit", "integer", "sizes", "check_type_size", "(", "__int64", "__INT64", ")", "check_type_size", "(", "int64_t", "INT64_T", ")", "@", "@", "-", "124", ",", "17", "+", "137", ",", "32", "@", "@", "check_type_size", "(", "int32_t", "INT32_T", ")", "check_type_size", "(", "__int32", "__INT32", ")", "check_type_size", "(", "\"", "long", "\"", "LONG_INT", ")", "check_type_size", "(", "\"", "int", "\"", "INT", ")", "if", "(", "HAVE_INT32_T", ")", "set", "(", "JSON_INT32", "int32_t", ")", "elseif", "(", "HAVE___INT32", ")", "set", "(", "JSON_INT32", "__int32", ")", "elseif", "(", "HAVE_LONG", "AND", "(", "${", "LONG_INT", "}", "EQUAL", "4", ")", ")", "elseif", "(", "HAVE_LONG_INT", "AND", "(", "${", "LONG_INT", "}", "EQUAL", "4", ")", ")", "set", "(", "JSON_INT32", "long", ")", "elseif", "(", "HAVE_INT", "AND", "(", "${", "INT", "}", "EQUAL", "4", ")", ")", "set", "(", "JSON_INT32", "int", ")", "else", "(", ")", "message", "(", "FATAL_ERROR", "\"", "Could", "not", "detect", "a", "valid", "32", "bit", "integer", "type", "\"", ")", "message", "(", "FATAL_ERROR", "\"", "Could", "not", "detect", "a", "valid", "32", "-", "bit", "integer", "type", "\"", ")", "endif", "(", ")", "check_type_size", "(", "uint32_t", "UINT32_T", ")", "check_type_size", "(", "__uint32", "__UINT32", ")", "check_type_size", "(", "\"", "unsigned", "long", "\"", "UNSIGNED_LONG_INT", ")", "check_type_size", "(", "\"", "unsigned", "int", "\"", "UNSIGNED_INT", ")", "if", "(", "HAVE_UINT32_T", ")", "set", "(", "JSON_UINT32", "uint32_t", ")", "elseif", "(", "HAVE___UINT32", ")", "set", "(", "JSON_UINT32", "__uint32", ")", "elseif", "(", "HAVE_UNSIGNED_LONG_INT", "AND", "(", "${", "UNSIGNED_LONG_INT", "}", "EQUAL", "4", ")", ")", "set", "(", "JSON_UINT32", "\"", "unsigned", "long", "\"", ")", "elseif", "(", "HAVE_UNSIGNED_INT", "AND", "(", "${", "UNSIGNED_INT", "}", "EQUAL", "4", ")", ")", "set", "(", "JSON_UINT32", "\"", "unsigned", "int", "\"", ")", "else", "(", ")", "message", "(", "FATAL_ERROR", "\"", "Could", "not", "detect", "a", "valid", "unsigned", "32", "-", "bit", "integer", "type", "\"", ")", "endif", "(", ")", "#", "Check", "for", "ssize_t", "and", "SSIZE_T", "existance", ".", "@", "@", "-", "206", ",", "11", "+", "234", ",", "9", "@", "@", "else", "(", ")", "set", "(", "JSON_HAVE_LOCALECONV", "0", ")", "endif", "(", ")", "#", "check", "if", "we", "have", "setlocale", "check_function_exists", "(", "setlocale", "HAVE_SETLOCALE", ")", "#", "Check", "what", "the", "inline", "keyword", "is", ".", "#", "Note", "that", "the", "original", "JSON_INLINE", "was", "always", "set", "to", "just", "'", "inline", "'", ",", "so", "this", "goes", "further", ".", "check_function_keywords", "(", "\"", "inline", "\"", ")", "@", "@", "-", "238", ",", "6", "+", "264", ",", "9", "@", "@", "elseif", "(", "HAVE__SNPRINTF", ")", "set", "(", "JSON_SNPRINTF", "_snprintf", ")", "endif", "(", ")", "check_c_source_compiles", "(", "\"", "int", "main", "(", ")", "{", "unsigned", "long", "val", ";", "__sync_bool_compare_and_swap", "(", "&", "val", ",", "0", ",", "1", ")", ";", "return", "0", ";", "}", "\"", "HAVE_SYNC_BUILTINS", ")", "check_c_source_compiles", "(", "\"", "int", "main", "(", ")", "{", "char", "l", ";", "unsigned", "long", "v", ";", "__atomic_test_and_set", "(", "&", "l", ",", "__ATOMIC_RELAXED", ")", ";", "__atomic_store_n", "(", "&", "v", ",", "1", ",", "__ATOMIC_ACQ_REL", ")", ";", "__atomic_load_n", "(", "&", "v", ",", "__ATOMIC_ACQUIRE", ")", ";", "return", "0", ";", "}", "\"", "HAVE_ATOMIC_BUILTINS", ")", "#", "Create", "pkg", "-", "conf", "file", ".", "#", "(", "We", "use", "the", "same", "files", "as", ".", "/", "configure", "does", ",", "so", "we", "#", "have", "to", "defined", "the", "same", "variables", "used", "there", ")", ".", "@", "@", "-", "1", ",", "35", "+", "1", ",", "36", "@", "@", "/", "*", "Reduced", "down", "to", "the", "defines", "that", "are", "actually", "used", "in", "the", "code", "*", "/", "/", "*", "Define", "to", "1", "if", "you", "have", "the", "<", "inttypes", ".", "h", ">", "(", "and", "friends", ")", "header", "file", ".", "*", "/", "#", "cmakedefine", "HAVE_INTTYPES_H", "1", "#", "cmakedefine", "HAVE_STDINT_H", "1", "#", "cmakedefine", "HAVE_ENDIAN_H", "1", "#", "cmakedefine", "HAVE_FCNTL_H", "1", "#", "cmakedefine", "HAVE_SCHED_H", "1", "#", "cmakedefine", "HAVE_UNISTD_H", "1", "#", "cmakedefine", "HAVE_SYS_PARAM_H", "1", "#", "cmakedefine", "HAVE_SYS_STAT_H", "1", "#", "cmakedefine", "HAVE_SYS_TIME_H", "1", "#", "cmakedefine", "HAVE_SYS_TYPES_H", "1", "#", "cmakedefine", "HAVE_STDINT_H", "1", "/", "*", "We", "must", "include", "this", "here", ",", "as", "in", "(", "eg", ")", "utf", ".", "h", "it", "will", "want", "to", "use", "the", "integer", "type", ",", "which", "in", "MSVC2010", "will", "be", "in", "stdint", ".", "h", "(", "there", "is", "no", "inttypes", ".", "h", "in", "MSVC2010", ")", "*", "/", "#", "if", "defined", "(", "HAVE_STDINT_H", ")", "#", "include", "<", "stdint", ".", "h", ">", "#", "elif", "defined", "(", "HAVE_INTTYPES_H", ")", "#", "include", "<", "inttypes", ".", "h", ">", "#", "elif", "defined", "(", "HAVE_SYS_TYPES_H", ")", "#", "include", "<", "sys", "/", "types", ".", "h", ">", "#", "endif", "#", "cmakedefine", "HAVE_CLOSE", "1", "#", "cmakedefine", "HAVE_GETPID", "1", "#", "cmakedefine", "HAVE_GETTIMEOFDAY", "1", "#", "cmakedefine", "HAVE_OPEN", "1", "#", "cmakedefine", "HAVE_READ", "1", "#", "cmakedefine", "HAVE_SCHED_YIELD", "1", "/", "*", "Define", "to", "1", "if", "you", "have", "the", "<", "locale", ".", "h", ">", "header", "file", ".", "*", "/", "#", "cmakedefine", "HAVE_LOCALE_H", "1", "#", "cmakedefine", "HAVE_SYNC_BUILTINS", "1", "#", "cmakedefine", "HAVE_ATOMIC_BUILTINS", "1", "/", "*", "Define", "to", "1", "if", "you", "have", "the", "'", "setlocale", "'", "function", ".", "*", "/", "#", "cmakedefine", "HAVE_LOCALE_H", "1", "#", "cmakedefine", "HAVE_SETLOCALE", "1", "/", "*", "Define", "to", "the", "type", "of", "a", "signed", "integer", "type", "of", "width", "exactly", "32", "bits", "if", "such", "a", "type", "exists", "and", "the", "standard", "includes", "do", "not", "define", "it", ".", "*", "/", "#", "cmakedefine", "HAVE_INT32_T", "1", "#", "ifndef", "HAVE_INT32_T", "#", "define", "int32_t", "@", "JSON_INT32", "@", "#", "endif", "#", "cmakedefine", "HAVE_UINT32_T", "1", "#", "ifndef", "HAVE_UINT32_T", "#", "define", "uint32_t", "@", "JSON_UINT32", "@", "#", "endif", "#", "cmakedefine", "HAVE_SSIZE_T", "1", "#", "ifndef", "HAVE_SSIZE_T", "@", "@", "-", "43", ",", "3", "+", "44", ",", "6", "@", "@", "#", "endif", "#", "cmakedefine", "HAVE_VSNPRINTF", "#", "cmakedefine", "USE_URANDOM", "1", "#", "cmakedefine", "USE_WINDOWS_CRYPTOAPI", "1", "@", "@", "-", "14", ",", "10", "+", "14", ",", "11", "@", "@", "AM_CONDITIONAL", "(", "[", "GCC", "]", ",", "[", "test", "x", "$", "GCC", "=", "xyes", "]", ")", "#", "Checks", "for", "libraries", ".", "#", "Checks", "for", "header", "files", ".", "AC_CHECK_HEADERS", "(", "[", "locale", ".", "h", "]", ")", "AC_CHECK_HEADERS", "(", "[", "endian", ".", "h", "fcntl", ".", "h", "locale", ".", "h", "sched", ".", "h", "unistd", ".", "h", "sys", "/", "param", ".", "h", "sys", "/", "stat", ".", "h", "sys", "/", "time", ".", "h", "sys", "/", "types", ".", "h", "]", ")", "#", "Checks", "for", "typedefs", ",", "structures", ",", "and", "compiler", "characteristics", ".", "AC_TYPE_INT32_T", "AC_TYPE_UINT32_T", "AC_TYPE_LONG_LONG_INT", "AC_C_INLINE", "@", "@", "-", "29", ",", "7", "+", "30", ",", "31", "@", "@", "esac", "AC_SUBST", "(", "[", "json_inline", "]", ")", "#", "Checks", "for", "library", "functions", ".", "AC_CHECK_FUNCS", "(", "[", "strtoll", "localeconv", "]", ")", "AC_CHECK_FUNCS", "(", "[", "close", "getpid", "gettimeofday", "localeconv", "open", "read", "sched_yield", "strtoll", "]", ")", "AC_MSG_CHECKING", "(", "[", "for", "gcc", "__sync", "builtins", "]", ")", "have_sync_builtins", "=", "no", "AC_TRY_LINK", "(", "[", "],", "[", "unsigned", "long", "val", ";", "__sync_bool_compare_and_swap", "(", "&", "val", ",", "0", ",", "1", ")", ";]", ",", "[", "have_sync_builtins", "=", "yes", "]", ",", ")", "if", "test", "\"", "x", "$", "have_sync_builtins", "\"", "=", "\"", "xyes", "\"", ";", "then", "AC_DEFINE", "(", "[", "HAVE_SYNC_BUILTINS", "]", ",", "[", "1", "]", ",", "[", "Define", "to", "1", "if", "gcc", "'", "s", "__sync", "builtins", "are", "available", "]", ")", "fi", "AC_MSG_RESULT", "(", "[$", "have_sync_builtins", "]", ")", "AC_MSG_CHECKING", "(", "[", "for", "gcc", "__atomic", "builtins", "]", ")", "have_atomic_builtins", "=", "no", "AC_TRY_LINK", "(", "[", "],", "[", "char", "l", ";", "unsigned", "long", "v", ";", "__atomic_test_and_set", "(", "&", "l", ",", "__ATOMIC_RELAXED", ")", ";", "__atomic_store_n", "(", "&", "v", ",", "1", ",", "__ATOMIC_ACQ_REL", ")", ";", "__atomic_load_n", "(", "&", "v", ",", "__ATOMIC_ACQUIRE", ")", ";]", ",", "[", "have_atomic_builtins", "=", "yes", "]", ",", ")", "if", "test", "\"", "x", "$", "have_atomic_builtins", "\"", "=", "\"", "xyes", "\"", ";", "then", "AC_DEFINE", "(", "[", "HAVE_ATOMIC_BUILTINS", "]", ",", "[", "1", "]", ",", "[", "Define", "to", "1", "if", "gcc", "'", "s", "__atomic", "builtins", "are", "available", "]", ")", "fi", "AC_MSG_RESULT", "(", "[$", "have_atomic_builtins", "]", ")", "case", "\"", "$", "ac_cv_type_long_long_int", "$", "ac_cv_func_strtoll", "\"", "in", "yesyes", ")", "json_have_long_long", "=", "1", ";", ";", "@", "@", "-", "43", ",", "6", "+", "68", ",", "27", "@", "@", "case", "\"", "$", "ac_cv_header_locale_h", "$", "ac_cv_func_localeconv", "\"", "in", "esac", "AC_SUBST", "(", "[", "json_have_localeconv", "]", ")", "#", "Features", "AC_ARG_ENABLE", "(", "[", "urandom", "]", ",", "[", "AS_HELP_STRING", "(", "[-", "-", "disable", "-", "urandom", "]", ",", "[", "Don", "'", "t", "use", "/", "dev", "/", "urandom", "to", "seed", "the", "hash", "function", "]", ")]", ",", "[", "use_urandom", "=", "$", "enableval", "]", ",", "[", "use_urandom", "=", "yes", "]", ")", "if", "test", "\"", "x", "$", "use_urandom", "\"", "=", "xyes", ";", "then", "AC_DEFINE", "(", "[", "USE_URANDOM", "]", ",", "[", "1", "]", ",", "[", "Define", "to", "1", "if", "/", "dev", "/", "urandom", "should", "be", "used", "for", "seeding", "the", "hash", "function", "]", ")", "fi", "AC_ARG_ENABLE", "(", "[", "windows", "-", "cryptoapi", "]", ",", "[", "AS_HELP_STRING", "(", "[-", "-", "disable", "-", "windows", "-", "cryptoapi", "]", ",", "[", "Don", "'", "t", "use", "CryptGenRandom", "to", "seed", "the", "hash", "function", "]", ")]", ",", "[", "use_windows_cryptoapi", "=", "$", "enableval", "]", ",", "[", "use_windows_cryptoapi", "=", "yes", "]", ")", "if", "test", "\"", "x", "$", "use_windows_cryptoapi", "\"", "=", "xyes", ";", "then", "AC_DEFINE", "(", "[", "USE_WINDOWS_CRYPTOAPI", "]", ",", "[", "1", "]", ",", "[", "Define", "to", "1", "if", "CryptGenRandom", "should", "be", "used", "for", "seeding", "the", "hash", "function", "]", ")", "fi", "AC_CONFIG_FILES", "(", "[", "jansson", ".", "pc", "Makefile", "@", "@", "-", "8", ",", "6", "+", "8", ",", "7", "@", "@", "libjansson_la_SOURCES", "=", "\\", "error", ".", "c", "\\", "hashtable", ".", "c", "\\", "hashtable", ".", "h", "\\", "hashtable_seed", ".", "c", "\\", "jansson_private", ".", "h", "\\", "load", ".", "c", "\\", "memory", ".", "c", "\\", "@", "@", "-", "5", ",", "8", "+", "5", ",", "17", "@", "@", "*", "it", "under", "the", "terms", "of", "the", "MIT", "license", ".", "See", "LICENSE", "for", "details", ".", "*", "/", "#", "if", "HAVE_CONFIG_H", "#", "include", "<", "config", ".", "h", ">", "#", "endif", "#", "include", "<", "stdlib", ".", "h", ">", "#", "include", "<", "string", ".", "h", ">", "#", "if", "HAVE_STDINT_H", "#", "include", "<", "stdint", ".", "h", ">", "#", "endif", "#", "include", "<", "jansson_config", ".", "h", ">", "/", "*", "for", "JSON_INLINE", "*", "/", "#", "include", "\"", "jansson_private", ".", "h", "\"", "/", "*", "for", "container_of", "(", ")", "*", "/", "#", "include", "\"", "hashtable", ".", "h", "\"", "@", "@", "-", "15", ",", "24", "+", "24", ",", "13", "@", "@", "typedef", "struct", "hashtable_list", "list_t", ";", "typedef", "struct", "hashtable_pair", "pair_t", ";", "typedef", "struct", "hashtable_bucket", "bucket_t", ";", "#", "define", "list_to_pair", "(", "list_", ")", "container_of", "(", "list_", ",", "pair_t", ",", "list", ")", "/", "*", "From", "http", ":", "//", "www", ".", "cse", ".", "yorku", ".", "ca", "/", "~", "oz", "/", "hash", ".", "html", "*", "/", "static", "size_t", "hash_str", "(", "const", "void", "*", "ptr", ")", "{", "const", "char", "*", "str", "=", "(", "const", "char", "*", ")", "ptr", ";", "size_t", "hash", "=", "5381", ";", "size_t", "c", ";", "extern", "volatile", "uint32_t", "hashtable_seed", ";", "while", "(", "(", "c", "=", "(", "size_t", ")", "*", "str", ")", ")", "{", "hash", "=", "(", "(", "hash", "<", "<", "5", ")", "+", "hash", ")", "+", "c", ";", "str", "+", "+;", "}", "/", "*", "Implementation", "of", "the", "hash", "function", "*", "/", "#", "include", "\"", "lookup3", ".", "h", "\"", "return", "hash", ";", "}", "#", "define", "list_to_pair", "(", "list_", ")", "container_of", "(", "list_", ",", "pair_t", ",", "list", ")", "#", "define", "hash_str", "(", "key", ")", "(", "(", "size_t", ")", "hashlittle", "(", "(", "key", ")", ",", "strlen", "(", "key", ")", ",", "hashtable_seed", ")", ")", "static", "JSON_INLINE", "void", "list_init", "(", "list_t", "*", "list", ")", "{", "@", "@", "-", "74", ",", "19", "+", "72", ",", "6", "@", "@", "static", "void", "insert_to_bucket", "(", "hashtable_t", "*", "hashtable", ",", "bucket_t", "*", "bucket", ",", "}", "}", "static", "const", "size_t", "primes", "[", "]", "=", "{", "5", ",", "13", ",", "23", ",", "53", ",", "97", ",", "193", ",", "389", ",", "769", ",", "1543", ",", "3079", ",", "6151", ",", "12289", ",", "24593", ",", "49157", ",", "98317", ",", "196613", ",", "393241", ",", "786433", ",", "1572869", ",", "3145739", ",", "6291469", ",", "12582917", ",", "25165843", ",", "50331653", ",", "100663319", ",", "201326611", ",", "402653189", ",", "805306457", ",", "1610612741", "}", ";", "static", "JSON_INLINE", "size_t", "num_buckets", "(", "hashtable_t", "*", "hashtable", ")", "{", "return", "primes", "[", "hashtable", "-", ">", "num_buckets", "]", ";", "}", "static", "pair_t", "*", "hashtable_find_pair", "(", "hashtable_t", "*", "hashtable", ",", "bucket_t", "*", "bucket", ",", "const", "char", "*", "key", ",", "size_t", "hash", ")", "{", "@", "@", "-", "120", ",", "7", "+", "105", ",", "7", "@", "@", "static", "int", "hashtable_do_del", "(", "hashtable_t", "*", "hashtable", ",", "bucket_t", "*", "bucket", ";", "size_t", "index", ";", "index", "=", "hash", "%", "num_buckets", "(", "hashtable", ")", ";", "index", "=", "hash", "&", "hashmask", "(", "hashtable", "-", ">", "order", ")", ";", "bucket", "=", "&", "hashtable", "-", ">", "buckets", "[", "index", "]", ";", "pair", "=", "hashtable_find_pair", "(", "hashtable", ",", "bucket", ",", "key", ",", "hash", ")", ";", "@", "@", "-", "167", ",", "14", "+", "152", ",", "14", "@", "@", "static", "int", "hashtable_do_rehash", "(", "hashtable_t", "*", "hashtable", ")", "jsonp_free", "(", "hashtable", "-", ">", "buckets", ")", ";", "hashtable", "-", ">", "num_buckets", "+", "+;", "new_size", "=", "num_buckets", "(", "hashtable", ")", ";", "hashtable", "-", ">", "order", "+", "+;", "new_size", "=", "hashsize", "(", "hashtable", "-", ">", "order", ")", ";", "hashtable", "-", ">", "buckets", "=", "jsonp_malloc", "(", "new_size", "*", "sizeof", "(", "bucket_t", ")", ");", "if", "(", "!", "hashtable", "-", ">", "buckets", ")", "return", "-", "1", ";", "for", "(", "i", "=", "0", ";", "i", "<", "num_buckets", "(", "hashtable", ")", ";", "i", "+", "+)", "for", "(", "i", "=", "0", ";", "i", "<", "hashsize", "(", "hashtable", "-", ">", "order", ")", ";", "i", "+", "+)", "{", "hashtable", "-", ">", "buckets", "[", "i", "]", ".", "first", "=", "hashtable", "-", ">", "buckets", "[", "i", "]", ".", "last", "=", "&", "hashtable", "-", ">", "list", ";", "@", "@", "-", "199", ",", "14", "+", "184", ",", "14", "@", "@", "int", "hashtable_init", "(", "hashtable_t", "*", "hashtable", ")", "size_t", "i", ";", "hashtable", "-", ">", "size", "=", "0", ";", "hashtable", "-", ">", "num_buckets", "=", "0", ";", "/", "*", "index", "to", "primes", "[", "]", "*", "/", "hashtable", "-", ">", "buckets", "=", "jsonp_malloc", "(", "num_buckets", "(", "hashtable", ")", "*", "sizeof", "(", "bucket_t", ")", ");", "hashtable", "-", ">", "order", "=", "3", ";", "hashtable", "-", ">", "buckets", "=", "jsonp_malloc", "(", "hashsize", "(", "hashtable", "-", ">", "order", ")", "*", "sizeof", "(", "bucket_t", ")", ");", "if", "(", "!", "hashtable", "-", ">", "buckets", ")", "return", "-", "1", ";", "list_init", "(", "&", "hashtable", "-", ">", "list", ")", ";", "for", "(", "i", "=", "0", ";", "i", "<", "num_buckets", "(", "hashtable", ")", ";", "i", "+", "+)", "for", "(", "i", "=", "0", ";", "i", "<", "hashsize", "(", "hashtable", "-", ">", "order", ")", ";", "i", "+", "+)", "{", "hashtable", "-", ">", "buckets", "[", "i", "]", ".", "first", "=", "hashtable", "-", ">", "buckets", "[", "i", "]", ".", "last", "=", "&", "hashtable", "-", ">", "list", ";", "@", "@", "-", "230", ",", "12", "+", "215", ",", "12", "@", "@", "int", "hashtable_set", "(", "hashtable_t", "*", "hashtable", ",", "size_t", "hash", ",", "index", ";", "/", "*", "rehash", "if", "the", "load", "ratio", "exceeds", "1", "*", "/", "if", "(", "hashtable", "-", ">", "size", ">", "=", "num_buckets", "(", "hashtable", ")", ")", "if", "(", "hashtable", "-", ">", "size", ">", "=", "hashsize", "(", "hashtable", "-", ">", "order", ")", ")", "if", "(", "hashtable_do_rehash", "(", "hashtable", ")", ")", "return", "-", "1", ";", "hash", "=", "hash_str", "(", "key", ")", ";", "index", "=", "hash", "%", "num_buckets", "(", "hashtable", ")", ";", "index", "=", "hash", "&", "hashmask", "(", "hashtable", "-", ">", "order", ")", ";", "bucket", "=", "&", "hashtable", "-", ">", "buckets", "[", "index", "]", ";", "pair", "=", "hashtable_find_pair", "(", "hashtable", ",", "bucket", ",", "key", ",", "hash", ")", ";", "@", "@", "-", "273", ",", "7", "+", "258", ",", "7", "@", "@", "void", "*", "hashtable_get", "(", "hashtable_t", "*", "hashtable", ",", "const", "char", "*", "key", ")", "bucket_t", "*", "bucket", ";", "hash", "=", "hash_str", "(", "key", ")", ";", "bucket", "=", "&", "hashtable", "-", ">", "buckets", "[", "hash", "%", "num_buckets", "(", "hashtable", ")", "];", "bucket", "=", "&", "hashtable", "-", ">", "buckets", "[", "hash", "&", "hashmask", "(", "hashtable", "-", ">", "order", ")", "];", "pair", "=", "hashtable_find_pair", "(", "hashtable", ",", "bucket", ",", "key", ",", "hash", ")", ";", "if", "(", "!", "pair", ")", "@", "@", "-", "294", ",", "7", "+", "279", ",", "7", "@", "@", "void", "hashtable_clear", "(", "hashtable_t", "*", "hashtable", ")", "hashtable_do_clear", "(", "hashtable", ")", ";", "for", "(", "i", "=", "0", ";", "i", "<", "num_buckets", "(", "hashtable", ")", ";", "i", "+", "+)", "for", "(", "i", "=", "0", ";", "i", "<", "hashsize", "(", "hashtable", "-", ">", "order", ")", ";", "i", "+", "+)", "{", "hashtable", "-", ">", "buckets", "[", "i", "]", ".", "first", "=", "hashtable", "-", ">", "buckets", "[", "i", "]", ".", "last", "=", "&", "hashtable", "-", ">", "list", ";", "@", "@", "-", "316", ",", "7", "+", "301", ",", "7", "@", "@", "void", "*", "hashtable_iter_at", "(", "hashtable_t", "*", "hashtable", ",", "const", "char", "*", "key", ")", "bucket_t", "*", "bucket", ";", "hash", "=", "hash_str", "(", "key", ")", ";", "bucket", "=", "&", "hashtable", "-", ">", "buckets", "[", "hash", "%", "num_buckets", "(", "hashtable", ")", "];", "bucket", "=", "&", "hashtable", "-", ">", "buckets", "[", "hash", "&", "hashmask", "(", "hashtable", "-", ">", "order", ")", "];", "pair", "=", "hashtable_find_pair", "(", "hashtable", ",", "bucket", ",", "key", ",", "hash", ")", ";", "if", "(", "!", "pair", ")", "@", "@", "-", "32", ",", "14", "+", "32", ",", "15", "@", "@", "struct", "hashtable_bucket", "{", "typedef", "struct", "hashtable", "{", "size_t", "size", ";", "struct", "hashtable_bucket", "*", "buckets", ";", "size_t", "num_buckets", ";", "/", "*", "index", "to", "primes", "[", "]", "*", "/", "size_t", "order", ";", "/", "*", "hashtable", "has", "pow", "(", "2", ",", "order", ")", "buckets", "*", "/", "struct", "hashtable_list", "list", ";", "}", "hashtable_t", ";", "#", "define", "hashtable_key_to_iter", "(", "key_", ")", "\\", "(", "&(", "container_of", "(", "key_", ",", "struct", "hashtable_pair", ",", "key", ")", "->", "list", ")", ")", "/", "**", "*", "hashtable_init", "-", "Initialize", "a", "hashtable", "object", "*", "@", "@", "-", "0", ",", "0", "+", "1", ",", "278", "@", "@", "/", "*", "Generate", "sizeof", "(", "uint32_t", ")", "bytes", "of", "as", "random", "data", "as", "possible", "to", "seed", "the", "hash", "function", ".", "*", "/", "#", "ifdef", "HAVE_CONFIG_H", "#", "include", "<", "config", ".", "h", ">", "#", "endif", "#", "include", "<", "stdio", ".", "h", ">", "#", "include", "<", "time", ".", "h", ">", "#", "ifdef", "HAVE_STDINT_H", "#", "include", "<", "stdint", ".", "h", ">", "#", "endif", "#", "ifdef", "HAVE_FCNTL_H", "#", "include", "<", "fcntl", ".", "h", ">", "#", "endif", "#", "ifdef", "HAVE_SCHED_H", "#", "include", "<", "sched", ".", "h", ">", "#", "endif", "#", "ifdef", "HAVE_UNISTD_H", "#", "include", "<", "unistd", ".", "h", ">", "#", "endif", "#", "ifdef", "HAVE_SYS_STAT_H", "#", "include", "<", "sys", "/", "stat", ".", "h", ">", "#", "endif", "#", "ifdef", "HAVE_SYS_TIME_H", "#", "include", "<", "sys", "/", "time", ".", "h", ">", "#", "endif", "#", "ifdef", "HAVE_SYS_TYPES_H", "#", "include", "<", "sys", "/", "types", ".", "h", ">", "#", "endif", "#", "if", "defined", "(", "_WIN32", ")", "/", "*", "For", "_getpid", "(", ")", "*", "/", "#", "include", "<", "process", ".", "h", ">", "#", "endif", "#", "include", "\"", "jansson", ".", "h", "\"", "static", "uint32_t", "buf_to_uint32", "(", "char", "*", "data", ")", "{", "size_t", "i", ";", "uint32_t", "result", "=", "0", ";", "for", "(", "i", "=", "0", ";", "i", "<", "sizeof", "(", "uint32_t", ")", ";", "i", "+", "+)", "result", "=", "(", "result", "<", "<", "8", ")", "|", "(", "unsigned", "char", ")", "data", "[", "i", "]", ";", "return", "result", ";", "}", "/", "*", "/", "dev", "/", "urandom", "*", "/", "#", "if", "!", "defined", "(", "_WIN32", ")", "&", "&", "defined", "(", "USE_URANDOM", ")", "static", "int", "seed_from_urandom", "(", "uint32_t", "*", "seed", ")", "{", "/", "*", "Use", "unbuffered", "I", "/", "O", "if", "we", "have", "open", "(", "),", "close", "(", ")", "and", "read", "(", ").", "Otherwise", "fall", "back", "to", "fopen", "(", ")", "*", "/", "char", "data", "[", "sizeof", "(", "uint32_t", ")", "];", "int", "ok", ";", "#", "if", "defined", "(", "HAVE_OPEN", ")", "&", "&", "defined", "(", "HAVE_CLOSE", ")", "&", "&", "defined", "(", "HAVE_READ", ")", "int", "urandom", ";", "urandom", "=", "open", "(", "\"/", "dev", "/", "urandom", "\"", ",", "O_RDONLY", ")", ";", "if", "(", "urandom", "=", "=", "-", "1", ")", "return", "1", ";", "ok", "=", "read", "(", "urandom", ",", "data", ",", "sizeof", "(", "uint32_t", ")", ")", "=", "=", "sizeof", "(", "uint32_t", ")", ";", "close", "(", "urandom", ")", ";", "#", "else", "FILE", "*", "urandom", ";", "urandom", "=", "fopen", "(", "\"/", "dev", "/", "urandom", "\"", ",", "\"", "rb", "\"", ");", "if", "(", "!", "urandom", ")", "return", "1", ";", "ok", "=", "fread", "(", "data", ",", "1", ",", "sizeof", "(", "uint32_t", ")", ",", "urandom", ")", "=", "=", "sizeof", "(", "uint32_t", ")", ";", "fclose", "(", "urandom", ")", ";", "#", "endif", "if", "(", "!", "ok", ")", "return", "1", ";", "*", "seed", "=", "buf_to_uint32", "(", "data", ")", ";", "return", "0", ";", "}", "#", "endif", "/", "*", "Windows", "Crypto", "API", "*", "/", "#", "if", "defined", "(", "_WIN32", ")", "&", "&", "defined", "(", "USE_WINDOWS_CRYPTOAPI", ")", "#", "include", "<", "windows", ".", "h", ">", "#", "include", "<", "wincrypt", ".", "h", ">", "typedef", "BOOL", "(", "WINAPI", "*", "CRYPTACQUIRECONTEXTA", ")", "(", "HCRYPTPROV", "*", "phProv", ",", "LPCSTR", "pszContainer", ",", "LPCSTR", "pszProvider", ",", "DWORD", "dwProvType", ",", "DWORD", "dwFlags", ")", ";", "typedef", "BOOL", "(", "WINAPI", "*", "CRYPTGENRANDOM", ")", "(", "HCRYPTPROV", "hProv", ",", "DWORD", "dwLen", ",", "BYTE", "*", "pbBuffer", ")", ";", "typedef", "BOOL", "(", "WINAPI", "*", "CRYPTRELEASECONTEXT", ")", "(", "HCRYPTPROV", "hProv", ",", "DWORD", "dwFlags", ")", ";", "static", "int", "seed_from_windows_cryptoapi", "(", "uint32_t", "*", "seed", ")", "{", "HINSTANCE", "hAdvAPI32", "=", "NULL", ";", "CRYPTACQUIRECONTEXTA", "pCryptAcquireContext", "=", "NULL", ";", "CRYPTGENRANDOM", "pCryptGenRandom", "=", "NULL", ";", "CRYPTRELEASECONTEXT", "pCryptReleaseContext", "=", "NULL", ";", "HCRYPTPROV", "hCryptProv", "=", "0", ";", "BYTE", "data", "[", "sizeof", "(", "uint32_t", ")", "];", "int", "ok", ";", "hAdvAPI32", "=", "GetModuleHandle", "(", "\"", "advapi32", ".", "dll", "\"", ");", "if", "(", "hAdvAPI32", "=", "=", "NULL", ")", "return", "1", ";", "pCryptAcquireContext", "=", "(", "CRYPTACQUIRECONTEXTA", ")", "GetProcAddress", "(", "hAdvAPI32", ",", "\"", "CryptAcquireContextA", "\"", ");", "if", "(", "!", "pCryptAcquireContext", ")", "return", "1", ";", "pCryptGenRandom", "=", "(", "CRYPTGENRANDOM", ")", "GetProcAddress", "(", "hAdvAPI32", ",", "\"", "CryptGenRandom", "\"", ");", "if", "(", "!", "pCryptGenRandom", ")", "return", "1", ";", "pCryptReleaseContext", "=", "(", "CRYPTRELEASECONTEXT", ")", "GetProcAddress", "(", "hAdvAPI32", ",", "\"", "CryptReleaseContext", "\"", ");", "if", "(", "!", "pCryptReleaseContext", ")", "return", "1", ";", "if", "(", "!", "pCryptAcquireContext", "(", "&", "hCryptProv", ",", "NULL", ",", "NULL", ",", "PROV_RSA_FULL", ",", "CRYPT_VERIFYCONTEXT", ")", ")", "return", "1", ";", "ok", "=", "CryptGenRandom", "(", "hCryptProv", ",", "sizeof", "(", "uint32_t", ")", ",", "data", ")", ";", "pCryptReleaseContext", "(", "hCryptProv", ",", "0", ")", ";", "if", "(", "!", "ok", ")", "return", "1", ";", "*", "seed", "=", "buf_to_uint32", "(", "(", "char", "*", ")", "data", ")", ";", "return", "0", ";", "}", "#", "endif", "/", "*", "gettimeofday", "(", ")", "and", "getpid", "(", ")", "*", "/", "static", "int", "seed_from_timestamp_and_pid", "(", "uint32_t", "*", "seed", ")", "{", "#", "ifdef", "HAVE_GETTIMEOFDAY", "/", "*", "XOR", "of", "seconds", "and", "microseconds", "*", "/", "struct", "timeval", "tv", ";", "gettimeofday", "(", "&", "tv", ",", "NULL", ")", ";", "*", "seed", "=", "(", "uint32_t", ")", "tv", ".", "tv_sec", "^", "(", "uint32_t", ")", "tv", ".", "tv_usec", ";", "#", "else", "/", "*", "Seconds", "only", "*", "/", "*", "seed", "=", "(", "uint32_t", ")", "time", "(", "NULL", ")", ";", "#", "endif", "/", "*", "XOR", "with", "PID", "for", "more", "randomness", "*", "/", "#", "if", "defined", "(", "_WIN32", ")", "*", "seed", "^", "=", "(", "uint32_t", ")", "_getpid", "(", ");", "#", "elif", "defined", "(", "HAVE_GETPID", ")", "*", "seed", "^", "=", "(", "uint32_t", ")", "getpid", "(", ");", "#", "endif", "return", "0", ";", "}", "static", "uint32_t", "generate_seed", "(", ")", "{", "uint32_t", "seed", ";", "int", "done", "=", "0", ";", "#", "if", "!", "defined", "(", "_WIN32", ")", "&", "&", "defined", "(", "USE_URANDOM", ")", "if", "(", "!", "done", "&", "&", "seed_from_urandom", "(", "&", "seed", ")", "=", "=", "0", ")", "done", "=", "1", ";", "#", "endif", "#", "if", "defined", "(", "_WIN32", ")", "&", "&", "defined", "(", "USE_WINDOWS_CRYPTOAPI", ")", "if", "(", "!", "done", "&", "&", "seed_from_windows_cryptoapi", "(", "&", "seed", ")", "=", "=", "0", ")", "done", "=", "1", ";", "#", "endif", "if", "(", "!", "done", ")", "{", "/", "*", "Fall", "back", "to", "timestamp", "and", "PID", "if", "no", "better", "randomness", "is", "available", "*", "/", "seed_from_timestamp_and_pid", "(", "&", "seed", ")", ";", "}", "/", "*", "Make", "sure", "the", "seed", "is", "never", "zero", "*", "/", "if", "(", "seed", "=", "=", "0", ")", "seed", "=", "1", ";", "return", "seed", ";", "}", "volatile", "uint32_t", "hashtable_seed", "=", "0", ";", "#", "if", "defined", "(", "HAVE_ATOMIC_BUILTINS", ")", "&", "&", "(", "defined", "(", "HAVE_SCHED_YIELD", ")", "|", "|", "!", "defined", "(", "_WIN32", ")", ")", "static", "volatile", "char", "seed_initialized", "=", "0", ";", "void", "json_object_seed", "(", "size_t", "seed", ")", "{", "uint32_t", "new_seed", "=", "(", "uint32_t", ")", "seed", ";", "if", "(", "hashtable_seed", "=", "=", "0", ")", "{", "if", "(", "__atomic_test_and_set", "(", "&", "seed_initialized", ",", "__ATOMIC_RELAXED", ")", "=", "=", "0", ")", "{", "/", "*", "Do", "the", "seeding", "ourselves", "*", "/", "if", "(", "new_seed", "=", "=", "0", ")", "new_seed", "=", "generate_seed", "(", ");", "__atomic_store_n", "(", "&", "hashtable_seed", ",", "new_seed", ",", "__ATOMIC_ACQ_REL", ")", ";", "}", "else", "{", "/", "*", "Wait", "for", "another", "thread", "to", "do", "the", "seeding", "*", "/", "do", "{", "#", "ifdef", "HAVE_SCHED_YIELD", "sched_yield", "(", ");", "#", "endif", "}", "while", "(", "__atomic_load_n", "(", "&", "hashtable_seed", ",", "__ATOMIC_ACQUIRE", ")", "=", "=", "0", ")", ";", "}", "}", "}", "#", "elif", "defined", "(", "HAVE_SYNC_BUILTINS", ")", "&", "&", "(", "defined", "(", "HAVE_SCHED_YIELD", ")", "|", "|", "!", "defined", "(", "_WIN32", ")", ")", "void", "json_object_seed", "(", "size_t", "seed", ")", "{", "uint32_t", "new_seed", "=", "(", "uint32_t", ")", "seed", ";", "if", "(", "hashtable_seed", "=", "=", "0", ")", "{", "if", "(", "new_seed", "=", "=", "0", ")", "{", "/", "*", "Explicit", "synchronization", "fences", "are", "not", "supported", "by", "the", "__sync", "builtins", ",", "so", "every", "thread", "getting", "here", "has", "to", "generate", "the", "seed", "value", ".", "*", "/", "new_seed", "=", "generate_seed", "(", ");", "}", "do", "{", "if", "(", "__sync_bool_compare_and_swap", "(", "&", "hashtable_seed", ",", "0", ",", "new_seed", ")", ")", "{", "/", "*", "We", "were", "the", "first", "to", "seed", "*", "/", "break", ";", "}", "else", "{", "/", "*", "Wait", "for", "another", "thread", "to", "do", "the", "seeding", "*", "/", "#", "ifdef", "HAVE_SCHED_YIELD", "sched_yield", "(", ");", "#", "endif", "}", "}", "while", "(", "hashtable_seed", "=", "=", "0", ")", ";", "}", "}", "#", "elif", "defined", "(", "_WIN32", ")", "static", "long", "seed_initialized", "=", "0", ";", "void", "json_object_seed", "(", "size_t", "seed", ")", "{", "uint32_t", "new_seed", "=", "(", "uint32_t", ")", "seed", ";", "if", "(", "hashtable_seed", "=", "=", "0", ")", "{", "if", "(", "InterlockedIncrement", "(", "&", "seed_initialized", ")", "=", "=", "1", ")", "{", "/", "*", "Do", "the", "seeding", "ourselves", "*", "/", "if", "(", "new_seed", "=", "=", "0", ")", "new_seed", "=", "generate_seed", "(", ");", "hashtable_seed", "=", "new_seed", ";", "}", "else", "{", "/", "*", "Wait", "for", "another", "thread", "to", "do", "the", "seeding", "*", "/", "do", "{", "SwitchToThread", "(", ");", "}", "while", "(", "hashtable_seed", "=", "=", "0", ")", ";", "}", "}", "}", "#", "else", "/", "*", "Fall", "back", "to", "a", "thread", "-", "unsafe", "version", "*", "/", "void", "json_object_seed", "(", "size_t", "seed", ")", "{", "uint32_t", "new_seed", "=", "(", "uint32_t", ")", "seed", ";", "if", "(", "hashtable_seed", "=", "=", "0", ")", "{", "if", "(", "new_seed", "=", "=", "0", ")", "new_seed", "=", "generate_seed", "(", ");", "hashtable_seed", "=", "new_seed", ";", "}", "}", "#", "endif", "@", "@", "-", "41", ",", "6", "+", "41", ",", "7", "@", "@", "EXPORTS", "json_object_iter_value", "json_object_iter_set_new", "json_object_key_to_iter", "json_object_seed", "json_dumps", "json_dumpf", "json_dump_file", "@", "@", "-", "126", ",", "6", "+", "126", ",", "7", "@", "@", "typedef", "struct", "{", "/", "*", "getters", ",", "setters", ",", "manipulation", "*", "/", "void", "json_object_seed", "(", "size_t", "seed", ")", ";", "size_t", "json_object_size", "(", "const", "json_t", "*", "object", ")", ";", "json_t", "*", "json_object_get", "(", "const", "json_t", "*", "object", ",", "const", "char", "*", "key", ")", ";", "int", "json_object_set_new", "(", "json_t", "*", "object", ",", "const", "char", "*", "key", ",", "json_t", "*", "value", ")", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "366", "@", "@", "/", "*", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "lookup3", ".", "c", ",", "by", "Bob", "Jenkins", ",", "May", "2006", ",", "Public", "Domain", ".", "These", "are", "functions", "for", "producing", "32", "-", "bit", "hashes", "for", "hash", "table", "lookup", ".", "hashword", "(", "),", "hashlittle", "(", "),", "hashlittle2", "(", "),", "hashbig", "(", "),", "mix", "(", "),", "and", "final", "(", ")", "are", "externally", "useful", "functions", ".", "Routines", "to", "test", "the", "hash", "are", "included", "if", "SELF_TEST", "is", "defined", ".", "You", "can", "use", "this", "free", "for", "any", "purpose", ".", "It", "'", "s", "in", "the", "public", "domain", ".", "It", "has", "no", "warranty", ".", "You", "probably", "want", "to", "use", "hashlittle", "(", ").", "hashlittle", "(", ")", "and", "hashbig", "(", ")", "hash", "byte", "arrays", ".", "hashlittle", "(", ")", "is", "is", "faster", "than", "hashbig", "(", ")", "on", "little", "-", "endian", "machines", ".", "Intel", "and", "AMD", "are", "little", "-", "endian", "machines", ".", "On", "second", "thought", ",", "you", "probably", "want", "hashlittle2", "(", "),", "which", "is", "identical", "to", "hashlittle", "(", ")", "except", "it", "returns", "two", "32", "-", "bit", "hashes", "for", "the", "price", "of", "one", ".", "You", "could", "implement", "hashbig2", "(", ")", "if", "you", "wanted", "but", "I", "haven", "'", "t", "bothered", "here", ".", "If", "you", "want", "to", "find", "a", "hash", "of", ",", "say", ",", "exactly", "7", "integers", ",", "do", "a", "=", "i1", ";", "b", "=", "i2", ";", "c", "=", "i3", ";", "mix", "(", "a", ",", "b", ",", "c", ")", ";", "a", "+", "=", "i4", ";", "b", "+", "=", "i5", ";", "c", "+", "=", "i6", ";", "mix", "(", "a", ",", "b", ",", "c", ")", ";", "a", "+", "=", "i7", ";", "final", "(", "a", ",", "b", ",", "c", ")", ";", "then", "use", "c", "as", "the", "hash", "value", ".", "If", "you", "have", "a", "variable", "length", "array", "of", "4", "-", "byte", "integers", "to", "hash", ",", "use", "hashword", "(", ").", "If", "you", "have", "a", "byte", "array", "(", "like", "a", "character", "string", ")", ",", "use", "hashlittle", "(", ").", "If", "you", "have", "several", "byte", "arrays", ",", "or", "a", "mix", "of", "things", ",", "see", "the", "comments", "above", "hashlittle", "(", ").", "Why", "is", "this", "so", "big", "?", "I", "read", "12", "bytes", "at", "a", "time", "into", "3", "4", "-", "byte", "integers", ",", "then", "mix", "those", "integers", ".", "This", "is", "fast", "(", "you", "can", "do", "a", "lot", "more", "thorough", "mixing", "with", "12", "*", "3", "instructions", "on", "3", "integers", "than", "you", "can", "with", "3", "instructions", "on", "1", "byte", ")", ",", "but", "shoehorning", "those", "bytes", "into", "integers", "efficiently", "is", "messy", ".", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "*", "/", "#", "include", "<", "stdlib", ".", "h", ">", "#", "ifdef", "HAVE_CONFIG_H", "#", "include", "<", "config", ".", "h", ">", "#", "endif", "#", "ifdef", "HAVE_STDINT_H", "#", "include", "<", "stdint", ".", "h", ">", "/", "*", "defines", "uint32_t", "etc", "*", "/", "#", "endif", "#", "ifdef", "HAVE_SYS_PARAM_H", "#", "include", "<", "sys", "/", "param", ".", "h", ">", "/", "*", "attempt", "to", "define", "endianness", "*", "/", "#", "endif", "#", "ifdef", "HAVE_ENDIAN_H", "#", "include", "<", "endian", ".", "h", ">", "/", "*", "attempt", "to", "define", "endianness", "*", "/", "#", "endif", "/", "*", "*", "My", "best", "guess", "at", "if", "you", "are", "big", "-", "endian", "or", "little", "-", "endian", ".", "This", "may", "*", "need", "adjustment", ".", "*", "/", "#", "if", "(", "defined", "(", "__BYTE_ORDER", ")", "&", "&", "defined", "(", "__LITTLE_ENDIAN", ")", "&", "&", "\\", "__BYTE_ORDER", "=", "=", "__LITTLE_ENDIAN", ")", "|", "|", "\\", "(", "defined", "(", "i386", ")", "|", "|", "defined", "(", "__i386__", ")", "|", "|", "defined", "(", "__i486__", ")", "|", "|", "\\", "defined", "(", "__i586__", ")", "|", "|", "defined", "(", "__i686__", ")", "|", "|", "defined", "(", "vax", ")", "|", "|", "defined", "(", "MIPSEL", ")", ")", "#", "define", "HASH_LITTLE_ENDIAN", "1", "#", "define", "HASH_BIG_ENDIAN", "0", "#", "elif", "(", "defined", "(", "__BYTE_ORDER", ")", "&", "&", "defined", "(", "__BIG_ENDIAN", ")", "&", "&", "\\", "__BYTE_ORDER", "=", "=", "__BIG_ENDIAN", ")", "|", "|", "\\", "(", "defined", "(", "sparc", ")", "|", "|", "defined", "(", "POWERPC", ")", "|", "|", "defined", "(", "mc68000", ")", "|", "|", "defined", "(", "sel", ")", ")", "#", "define", "HASH_LITTLE_ENDIAN", "0", "#", "define", "HASH_BIG_ENDIAN", "1", "#", "else", "#", "define", "HASH_LITTLE_ENDIAN", "0", "#", "define", "HASH_BIG_ENDIAN", "0", "#", "endif", "#", "define", "hashsize", "(", "n", ")", "(", "(", "uint32_t", ")", "1", "<", "<(", "n", ")", ")", "#", "define", "hashmask", "(", "n", ")", "(", "hashsize", "(", "n", ")", "-", "1", ")", "#", "define", "rot", "(", "x", ",", "k", ")", "(", "((", "x", ")", "<<", "(", "k", ")", ")", "|", "(", "(", "x", ")", ">>", "(", "32", "-", "(", "k", ")", "))", ")", "/", "*", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "mix", "-", "-", "mix", "3", "32", "-", "bit", "values", "reversibly", ".", "This", "is", "reversible", ",", "so", "any", "information", "in", "(", "a", ",", "b", ",", "c", ")", "before", "mix", "(", ")", "is", "still", "in", "(", "a", ",", "b", ",", "c", ")", "after", "mix", "(", ").", "If", "four", "pairs", "of", "(", "a", ",", "b", ",", "c", ")", "inputs", "are", "run", "through", "mix", "(", "),", "or", "through", "mix", "(", ")", "in", "reverse", ",", "there", "are", "at", "least", "32", "bits", "of", "the", "output", "that", "are", "sometimes", "the", "same", "for", "one", "pair", "and", "different", "for", "another", "pair", ".", "This", "was", "tested", "for", ":", "*", "pairs", "that", "differed", "by", "one", "bit", ",", "by", "two", "bits", ",", "in", "any", "combination", "of", "top", "bits", "of", "(", "a", ",", "b", ",", "c", ")", ",", "or", "in", "any", "combination", "of", "bottom", "bits", "of", "(", "a", ",", "b", ",", "c", ")", ".", "*", "\"", "differ", "\"", "is", "defined", "as", "+", ",", "-", ",", "^", ",", "or", "~", "^.", "For", "+", "and", "-", ",", "I", "transformed", "the", "output", "delta", "to", "a", "Gray", "code", "(", "a", "^", "(", "a", ">", ">", "1", ")", ")", "so", "a", "string", "of", "1", "'", "s", "(", "as", "is", "commonly", "produced", "by", "subtraction", ")", "look", "like", "a", "single", "1", "-", "bit", "difference", ".", "*", "the", "base", "values", "were", "pseudorandom", ",", "all", "zero", "but", "one", "bit", "set", ",", "or", "all", "zero", "plus", "a", "counter", "that", "starts", "at", "zero", ".", "Some", "k", "values", "for", "my", "\"", "a", "-", "=", "c", ";", "a", "^", "=", "rot", "(", "c", ",", "k", ")", ";", "c", "+", "=", "b", ";", "\"", "arrangement", "that", "satisfy", "this", "are", "4", "6", "8", "16", "19", "4", "9", "15", "3", "18", "27", "15", "14", "9", "3", "7", "17", "3", "Well", ",", "\"", "9", "15", "3", "18", "27", "15", "\"", "didn", "'", "t", "quite", "get", "32", "bits", "diffing", "for", "\"", "differ", "\"", "defined", "as", "+", "with", "a", "one", "-", "bit", "base", "and", "a", "two", "-", "bit", "delta", ".", "I", "used", "http", ":", "//", "burtleburtle", ".", "net", "/", "bob", "/", "hash", "/", "avalanche", ".", "html", "to", "choose", "the", "operations", ",", "constants", ",", "and", "arrangements", "of", "the", "variables", ".", "This", "does", "not", "achieve", "avalanche", ".", "There", "are", "input", "bits", "of", "(", "a", ",", "b", ",", "c", ")", "that", "fail", "to", "affect", "some", "output", "bits", "of", "(", "a", ",", "b", ",", "c", ")", ",", "especially", "of", "a", ".", "The", "most", "thoroughly", "mixed", "value", "is", "c", ",", "but", "it", "doesn", "'", "t", "really", "even", "achieve", "avalanche", "in", "c", ".", "This", "allows", "some", "parallelism", ".", "Read", "-", "after", "-", "writes", "are", "good", "at", "doubling", "the", "number", "of", "bits", "affected", ",", "so", "the", "goal", "of", "mixing", "pulls", "in", "the", "opposite", "direction", "as", "the", "goal", "of", "parallelism", ".", "I", "did", "what", "I", "could", ".", "Rotates", "seem", "to", "cost", "as", "much", "as", "shifts", "on", "every", "machine", "I", "could", "lay", "my", "hands", "on", ",", "and", "rotates", "are", "much", "kinder", "to", "the", "top", "and", "bottom", "bits", ",", "so", "I", "used", "rotates", ".", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "*", "/", "#", "define", "mix", "(", "a", ",", "b", ",", "c", ")", "\\", "{", "\\", "a", "-", "=", "c", ";", "a", "^", "=", "rot", "(", "c", ",", "4", ")", ";", "c", "+", "=", "b", ";", "\\", "b", "-", "=", "a", ";", "b", "^", "=", "rot", "(", "a", ",", "6", ")", ";", "a", "+", "=", "c", ";", "\\", "c", "-", "=", "b", ";", "c", "^", "=", "rot", "(", "b", ",", "8", ")", ";", "b", "+", "=", "a", ";", "\\", "a", "-", "=", "c", ";", "a", "^", "=", "rot", "(", "c", ",", "16", ")", ";", "c", "+", "=", "b", ";", "\\", "b", "-", "=", "a", ";", "b", "^", "=", "rot", "(", "a", ",", "19", ")", ";", "a", "+", "=", "c", ";", "\\", "c", "-", "=", "b", ";", "c", "^", "=", "rot", "(", "b", ",", "4", ")", ";", "b", "+", "=", "a", ";", "\\", "}", "/", "*", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "final", "-", "-", "final", "mixing", "of", "3", "32", "-", "bit", "values", "(", "a", ",", "b", ",", "c", ")", "into", "c", "Pairs", "of", "(", "a", ",", "b", ",", "c", ")", "values", "differing", "in", "only", "a", "few", "bits", "will", "usually", "produce", "values", "of", "c", "that", "look", "totally", "different", ".", "This", "was", "tested", "for", "*", "pairs", "that", "differed", "by", "one", "bit", ",", "by", "two", "bits", ",", "in", "any", "combination", "of", "top", "bits", "of", "(", "a", ",", "b", ",", "c", ")", ",", "or", "in", "any", "combination", "of", "bottom", "bits", "of", "(", "a", ",", "b", ",", "c", ")", ".", "*", "\"", "differ", "\"", "is", "defined", "as", "+", ",", "-", ",", "^", ",", "or", "~", "^.", "For", "+", "and", "-", ",", "I", "transformed", "the", "output", "delta", "to", "a", "Gray", "code", "(", "a", "^", "(", "a", ">", ">", "1", ")", ")", "so", "a", "string", "of", "1", "'", "s", "(", "as", "is", "commonly", "produced", "by", "subtraction", ")", "look", "like", "a", "single", "1", "-", "bit", "difference", ".", "*", "the", "base", "values", "were", "pseudorandom", ",", "all", "zero", "but", "one", "bit", "set", ",", "or", "all", "zero", "plus", "a", "counter", "that", "starts", "at", "zero", ".", "These", "constants", "passed", ":", "14", "11", "25", "16", "4", "14", "24", "12", "14", "25", "16", "4", "14", "24", "and", "these", "came", "close", ":", "4", "8", "15", "26", "3", "22", "24", "10", "8", "15", "26", "3", "22", "24", "11", "8", "15", "26", "3", "22", "24", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "*", "/", "#", "define", "final", "(", "a", ",", "b", ",", "c", ")", "\\", "{", "\\", "c", "^", "=", "b", ";", "c", "-", "=", "rot", "(", "b", ",", "14", ")", ";", "\\", "a", "^", "=", "c", ";", "a", "-", "=", "rot", "(", "c", ",", "11", ")", ";", "\\", "b", "^", "=", "a", ";", "b", "-", "=", "rot", "(", "a", ",", "25", ")", ";", "\\", "c", "^", "=", "b", ";", "c", "-", "=", "rot", "(", "b", ",", "16", ")", ";", "\\", "a", "^", "=", "c", ";", "a", "-", "=", "rot", "(", "c", ",", "4", ")", ";", "\\", "b", "^", "=", "a", ";", "b", "-", "=", "rot", "(", "a", ",", "14", ")", ";", "\\", "c", "^", "=", "b", ";", "c", "-", "=", "rot", "(", "b", ",", "24", ")", ";", "\\", "}", "/", "*", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "hashlittle", "(", ")", "-", "-", "hash", "a", "variable", "-", "length", "key", "into", "a", "32", "-", "bit", "value", "k", ":", "the", "key", "(", "the", "unaligned", "variable", "-", "length", "array", "of", "bytes", ")", "length", ":", "the", "length", "of", "the", "key", ",", "counting", "by", "bytes", "initval", ":", "can", "be", "any", "4", "-", "byte", "value", "Returns", "a", "32", "-", "bit", "value", ".", "Every", "bit", "of", "the", "key", "affects", "every", "bit", "of", "the", "return", "value", ".", "Two", "keys", "differing", "by", "one", "or", "two", "bits", "will", "have", "totally", "different", "hash", "values", ".", "The", "best", "hash", "table", "sizes", "are", "powers", "of", "2", ".", "There", "is", "no", "need", "to", "do", "mod", "a", "prime", "(", "mod", "is", "sooo", "slow", "!", ").", "If", "you", "need", "less", "than", "32", "bits", ",", "use", "a", "bitmask", ".", "For", "example", ",", "if", "you", "need", "only", "10", "bits", ",", "do", "h", "=", "(", "h", "&", "hashmask", "(", "10", ")", ");", "In", "which", "case", ",", "the", "hash", "table", "should", "have", "hashsize", "(", "10", ")", "elements", ".", "If", "you", "are", "hashing", "n", "strings", "(", "uint8_t", "*", "*)", "k", ",", "do", "it", "like", "this", ":", "for", "(", "i", "=", "0", ",", "h", "=", "0", ";", "i", "<", "n", ";", "+", "+", "i", ")", "h", "=", "hashlittle", "(", "k", "[", "i", "]", ",", "len", "[", "i", "]", ",", "h", ")", ";", "By", "Bob", "Jenkins", ",", "2006", ".", "bob_jenkins", "@", "burtleburtle", ".", "net", ".", "You", "may", "use", "this", "code", "any", "way", "you", "wish", ",", "private", ",", "educational", ",", "or", "commercial", ".", "It", "'", "s", "free", ".", "Use", "for", "hash", "table", "lookup", ",", "or", "anything", "where", "one", "collision", "in", "2", "^", "^", "32", "is", "acceptable", ".", "Do", "NOT", "use", "for", "cryptographic", "purposes", ".", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "*", "/", "static", "uint32_t", "hashlittle", "(", "const", "void", "*", "key", ",", "size_t", "length", ",", "uint32_t", "initval", ")", "{", "uint32_t", "a", ",", "b", ",", "c", ";", "/", "*", "internal", "state", "*", "/", "union", "{", "const", "void", "*", "ptr", ";", "size_t", "i", ";", "}", "u", ";", "/", "*", "needed", "for", "Mac", "Powerbook", "G4", "*", "/", "/", "*", "Set", "up", "the", "internal", "state", "*", "/", "a", "=", "b", "=", "c", "=", "0xdeadbeef", "+", "(", "(", "uint32_t", ")", "length", ")", "+", "initval", ";", "u", ".", "ptr", "=", "key", ";", "if", "(", "HASH_LITTLE_ENDIAN", "&", "&", "(", "(", "u", ".", "i", "&", "0x3", ")", "=", "=", "0", ")", ")", "{", "const", "uint32_t", "*", "k", "=", "(", "const", "uint32_t", "*", ")", "key", ";", "/", "*", "read", "32", "-", "bit", "chunks", "*", "/", "#", "ifdef", "VALGRIND", "const", "uint8_t", "*", "k8", ";", "#", "endif", "/", "*-", "--", "--", "-", "all", "but", "last", "block", ":", "aligned", "reads", "and", "affect", "32", "bits", "of", "(", "a", ",", "b", ",", "c", ")", "*", "/", "while", "(", "length", ">", "12", ")", "{", "a", "+", "=", "k", "[", "0", "]", ";", "b", "+", "=", "k", "[", "1", "]", ";", "c", "+", "=", "k", "[", "2", "]", ";", "mix", "(", "a", ",", "b", ",", "c", ")", ";", "length", "-", "=", "12", ";", "k", "+", "=", "3", ";", "}", "/", "*-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "handle", "the", "last", "(", "probably", "partial", ")", "block", "*", "/", "/", "*", "*", "\"", "k", "[", "2", "]", "&", "0xffffff", "\"", "actually", "reads", "beyond", "the", "end", "of", "the", "string", ",", "but", "*", "then", "masks", "off", "the", "part", "it", "'", "s", "not", "allowed", "to", "read", ".", "Because", "the", "*", "string", "is", "aligned", ",", "the", "masked", "-", "off", "tail", "is", "in", "the", "same", "word", "as", "the", "*", "rest", "of", "the", "string", ".", "Every", "machine", "with", "memory", "protection", "I", "'", "ve", "seen", "*", "does", "it", "on", "word", "boundaries", ",", "so", "is", "OK", "with", "this", ".", "But", "VALGRIND", "will", "*", "still", "catch", "it", "and", "complain", ".", "The", "masking", "trick", "does", "make", "the", "hash", "*", "noticably", "faster", "for", "short", "strings", "(", "like", "English", "words", ")", ".", "*", "/", "#", "ifndef", "VALGRIND", "switch", "(", "length", ")", "{", "case", "12", ":", "c", "+", "=", "k", "[", "2", "]", ";", "b", "+", "=", "k", "[", "1", "]", ";", "a", "+", "=", "k", "[", "0", "]", ";", "break", ";", "case", "11", ":", "c", "+", "=", "k", "[", "2", "]", "&", "0xffffff", ";", "b", "+", "=", "k", "[", "1", "]", ";", "a", "+", "=", "k", "[", "0", "]", ";", "break", ";", "case", "10", ":", "c", "+", "=", "k", "[", "2", "]", "&", "0xffff", ";", "b", "+", "=", "k", "[", "1", "]", ";", "a", "+", "=", "k", "[", "0", "]", ";", "break", ";", "case", "9", ":", "c", "+", "=", "k", "[", "2", "]", "&", "0xff", ";", "b", "+", "=", "k", "[", "1", "]", ";", "a", "+", "=", "k", "[", "0", "]", ";", "break", ";", "case", "8", ":", "b", "+", "=", "k", "[", "1", "]", ";", "a", "+", "=", "k", "[", "0", "]", ";", "break", ";", "case", "7", ":", "b", "+", "=", "k", "[", "1", "]", "&", "0xffffff", ";", "a", "+", "=", "k", "[", "0", "]", ";", "break", ";", "case", "6", ":", "b", "+", "=", "k", "[", "1", "]", "&", "0xffff", ";", "a", "+", "=", "k", "[", "0", "]", ";", "break", ";", "case", "5", ":", "b", "+", "=", "k", "[", "1", "]", "&", "0xff", ";", "a", "+", "=", "k", "[", "0", "]", ";", "break", ";", "case", "4", ":", "a", "+", "=", "k", "[", "0", "]", ";", "break", ";", "case", "3", ":", "a", "+", "=", "k", "[", "0", "]", "&", "0xffffff", ";", "break", ";", "case", "2", ":", "a", "+", "=", "k", "[", "0", "]", "&", "0xffff", ";", "break", ";", "case", "1", ":", "a", "+", "=", "k", "[", "0", "]", "&", "0xff", ";", "break", ";", "case", "0", ":", "return", "c", ";", "/", "*", "zero", "length", "strings", "require", "no", "mixing", "*", "/", "}", "#", "else", "/", "*", "make", "valgrind", "happy", "*", "/", "k8", "=", "(", "const", "uint8_t", "*", ")", "k", ";", "switch", "(", "length", ")", "{", "case", "12", ":", "c", "+", "=", "k", "[", "2", "]", ";", "b", "+", "=", "k", "[", "1", "]", ";", "a", "+", "=", "k", "[", "0", "]", ";", "break", ";", "case", "11", ":", "c", "+", "=(", "(", "uint32_t", ")", "k8", "[", "10", "]", ")<", "<", "16", ";", "/", "*", "fall", "through", "*", "/", "case", "10", ":", "c", "+", "=(", "(", "uint32_t", ")", "k8", "[", "9", "]", ")<", "<", "8", ";", "/", "*", "fall", "through", "*", "/", "case", "9", ":", "c", "+", "=", "k8", "[", "8", "]", ";", "/", "*", "fall", "through", "*", "/", "case", "8", ":", "b", "+", "=", "k", "[", "1", "]", ";", "a", "+", "=", "k", "[", "0", "]", ";", "break", ";", "case", "7", ":", "b", "+", "=(", "(", "uint32_t", ")", "k8", "[", "6", "]", ")<", "<", "16", ";", "/", "*", "fall", "through", "*", "/", "case", "6", ":", "b", "+", "=(", "(", "uint32_t", ")", "k8", "[", "5", "]", ")<", "<", "8", ";", "/", "*", "fall", "through", "*", "/", "case", "5", ":", "b", "+", "=", "k8", "[", "4", "]", ";", "/", "*", "fall", "through", "*", "/", "case", "4", ":", "a", "+", "=", "k", "[", "0", "]", ";", "break", ";", "case", "3", ":", "a", "+", "=(", "(", "uint32_t", ")", "k8", "[", "2", "]", ")<", "<", "16", ";", "/", "*", "fall", "through", "*", "/", "case", "2", ":", "a", "+", "=(", "(", "uint32_t", ")", "k8", "[", "1", "]", ")<", "<", "8", ";", "/", "*", "fall", "through", "*", "/", "case", "1", ":", "a", "+", "=", "k8", "[", "0", "]", ";", "break", ";", "case", "0", ":", "return", "c", ";", "}", "#", "endif", "/", "*", "!", "valgrind", "*", "/", "}", "else", "if", "(", "HASH_LITTLE_ENDIAN", "&", "&", "(", "(", "u", ".", "i", "&", "0x1", ")", "=", "=", "0", ")", ")", "{", "const", "uint16_t", "*", "k", "=", "(", "const", "uint16_t", "*", ")", "key", ";", "/", "*", "read", "16", "-", "bit", "chunks", "*", "/", "const", "uint8_t", "*", "k8", ";", "/", "*-", "--", "--", "--", "--", "--", "--", "--", "all", "but", "last", "block", ":", "aligned", "reads", "and", "different", "mixing", "*", "/", "while", "(", "length", ">", "12", ")", "{", "a", "+", "=", "k", "[", "0", "]", "+", "(", "((", "uint32_t", ")", "k", "[", "1", "]", ")<", "<", "16", ")", ";", "b", "+", "=", "k", "[", "2", "]", "+", "(", "((", "uint32_t", ")", "k", "[", "3", "]", ")<", "<", "16", ")", ";", "c", "+", "=", "k", "[", "4", "]", "+", "(", "((", "uint32_t", ")", "k", "[", "5", "]", ")<", "<", "16", ")", ";", "mix", "(", "a", ",", "b", ",", "c", ")", ";", "length", "-", "=", "12", ";", "k", "+", "=", "6", ";", "}", "/", "*-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "handle", "the", "last", "(", "probably", "partial", ")", "block", "*", "/", "k8", "=", "(", "const", "uint8_t", "*", ")", "k", ";", "switch", "(", "length", ")", "{", "case", "12", ":", "c", "+", "=", "k", "[", "4", "]", "+(", "((", "uint32_t", ")", "k", "[", "5", "]", ")<", "<", "16", ")", ";", "b", "+", "=", "k", "[", "2", "]", "+(", "((", "uint32_t", ")", "k", "[", "3", "]", ")<", "<", "16", ")", ";", "a", "+", "=", "k", "[", "0", "]", "+(", "((", "uint32_t", ")", "k", "[", "1", "]", ")<", "<", "16", ")", ";", "break", ";", "case", "11", ":", "c", "+", "=(", "(", "uint32_t", ")", "k8", "[", "10", "]", ")<", "<", "16", ";", "/", "*", "fall", "through", "*", "/", "case", "10", ":", "c", "+", "=", "k", "[", "4", "]", ";", "b", "+", "=", "k", "[", "2", "]", "+(", "((", "uint32_t", ")", "k", "[", "3", "]", ")<", "<", "16", ")", ";", "a", "+", "=", "k", "[", "0", "]", "+(", "((", "uint32_t", ")", "k", "[", "1", "]", ")<", "<", "16", ")", ";", "break", ";", "case", "9", ":", "c", "+", "=", "k8", "[", "8", "]", ";", "/", "*", "fall", "through", "*", "/", "case", "8", ":", "b", "+", "=", "k", "[", "2", "]", "+(", "((", "uint32_t", ")", "k", "[", "3", "]", ")<", "<", "16", ")", ";", "a", "+", "=", "k", "[", "0", "]", "+(", "((", "uint32_t", ")", "k", "[", "1", "]", ")<", "<", "16", ")", ";", "break", ";", "case", "7", ":", "b", "+", "=(", "(", "uint32_t", ")", "k8", "[", "6", "]", ")<", "<", "16", ";", "/", "*", "fall", "through", "*", "/", "case", "6", ":", "b", "+", "=", "k", "[", "2", "]", ";", "a", "+", "=", "k", "[", "0", "]", "+(", "((", "uint32_t", ")", "k", "[", "1", "]", ")<", "<", "16", ")", ";", "break", ";", "case", "5", ":", "b", "+", "=", "k8", "[", "4", "]", ";", "/", "*", "fall", "through", "*", "/", "case", "4", ":", "a", "+", "=", "k", "[", "0", "]", "+(", "((", "uint32_t", ")", "k", "[", "1", "]", ")<", "<", "16", ")", ";", "break", ";", "case", "3", ":", "a", "+", "=(", "(", "uint32_t", ")", "k8", "[", "2", "]", ")<", "<", "16", ";", "/", "*", "fall", "through", "*", "/", "case", "2", ":", "a", "+", "=", "k", "[", "0", "]", ";", "break", ";", "case", "1", ":", "a", "+", "=", "k8", "[", "0", "]", ";", "break", ";", "case", "0", ":", "return", "c", ";", "/", "*", "zero", "length", "requires", "no", "mixing", "*", "/", "}", "}", "else", "{", "/", "*", "need", "to", "read", "the", "key", "one", "byte", "at", "a", "time", "*", "/", "const", "uint8_t", "*", "k", "=", "(", "const", "uint8_t", "*", ")", "key", ";", "/", "*-", "--", "--", "--", "--", "--", "--", "--", "all", "but", "the", "last", "block", ":", "affect", "some", "32", "bits", "of", "(", "a", ",", "b", ",", "c", ")", "*", "/", "while", "(", "length", ">", "12", ")", "{", "a", "+", "=", "k", "[", "0", "]", ";", "a", "+", "=", "(", "(", "uint32_t", ")", "k", "[", "1", "]", ")<", "<", "8", ";", "a", "+", "=", "(", "(", "uint32_t", ")", "k", "[", "2", "]", ")<", "<", "16", ";", "a", "+", "=", "(", "(", "uint32_t", ")", "k", "[", "3", "]", ")<", "<", "24", ";", "b", "+", "=", "k", "[", "4", "]", ";", "b", "+", "=", "(", "(", "uint32_t", ")", "k", "[", "5", "]", ")<", "<", "8", ";", "b", "+", "=", "(", "(", "uint32_t", ")", "k", "[", "6", "]", ")<", "<", "16", ";", "b", "+", "=", "(", "(", "uint32_t", ")", "k", "[", "7", "]", ")<", "<", "24", ";", "c", "+", "=", "k", "[", "8", "]", ";", "c", "+", "=", "(", "(", "uint32_t", ")", "k", "[", "9", "]", ")<", "<", "8", ";", "c", "+", "=", "(", "(", "uint32_t", ")", "k", "[", "10", "]", ")<", "<", "16", ";", "c", "+", "=", "(", "(", "uint32_t", ")", "k", "[", "11", "]", ")<", "<", "24", ";", "mix", "(", "a", ",", "b", ",", "c", ")", ";", "length", "-", "=", "12", ";", "k", "+", "=", "12", ";", "}", "/", "*-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "-", "last", "block", ":", "affect", "all", "32", "bits", "of", "(", "c", ")", "*", "/", "switch", "(", "length", ")", "/", "*", "all", "the", "case", "statements", "fall", "through", "*", "/", "{", "case", "12", ":", "c", "+", "=(", "(", "uint32_t", ")", "k", "[", "11", "]", ")<", "<", "24", ";", "case", "11", ":", "c", "+", "=(", "(", "uint32_t", ")", "k", "[", "10", "]", ")<", "<", "16", ";", "case", "10", ":", "c", "+", "=(", "(", "uint32_t", ")", "k", "[", "9", "]", ")<", "<", "8", ";", "case", "9", ":", "c", "+", "=", "k", "[", "8", "]", ";", "case", "8", ":", "b", "+", "=(", "(", "uint32_t", ")", "k", "[", "7", "]", ")<", "<", "24", ";", "case", "7", ":", "b", "+", "=(", "(", "uint32_t", ")", "k", "[", "6", "]", ")<", "<", "16", ";", "case", "6", ":", "b", "+", "=(", "(", "uint32_t", ")", "k", "[", "5", "]", ")<", "<", "8", ";", "case", "5", ":", "b", "+", "=", "k", "[", "4", "]", ";", "case", "4", ":", "a", "+", "=(", "(", "uint32_t", ")", "k", "[", "3", "]", ")<", "<", "24", ";", "case", "3", ":", "a", "+", "=(", "(", "uint32_t", ")", "k", "[", "2", "]", ")<", "<", "16", ";", "case", "2", ":", "a", "+", "=(", "(", "uint32_t", ")", "k", "[", "1", "]", ")<", "<", "8", ";", "case", "1", ":", "a", "+", "=", "k", "[", "0", "]", ";", "break", ";", "case", "0", ":", "return", "c", ";", "}", "}", "final", "(", "a", ",", "b", ",", "c", ")", ";", "return", "c", ";", "}", "@", "@", "-", "10", ",", "23", "+", "10", ",", "11", "@", "@", "#", "ifdef", "HAVE_CONFIG_H", "#", "include", "<", "config", ".", "h", ">", "#", "endif", "#", "ifdef", "HAVE_INTTYPES_H", "/", "*", "inttypes", ".", "h", "includes", "stdint", ".", "h", "in", "a", "standard", "environment", ",", "so", "there", "'", "s", "no", "need", "to", "include", "stdint", ".", "h", "separately", ".", "If", "inttypes", ".", "h", "doesn", "'", "t", "define", "int32_t", ",", "it", "'", "s", "defined", "in", "config", ".", "h", ".", "*", "/", "#", "include", "<", "inttypes", ".", "h", ">", "#", "endif", "/", "*", "HAVE_INTTYPES_H", "*", "/", "#", "else", "/", "*", "!", "HAVE_CONFIG_H", "*", "/", "#", "ifdef", "_WIN32", "typedef", "int", "int32_t", ";", "#", "else", "/", "*", "!", "_WIN32", "*", "/", "/", "*", "Assume", "a", "standard", "environment", "*", "/", "#", "include", "<", "inttypes", ".", "h", ">", "#", "endif", "/", "*", "_WIN32", "*", "/", "#", "endif", "/", "*", "HAVE_CONFIG_H", "*", "/", "#", "ifdef", "HAVE_STDINT_H", "#", "include", "<", "stdint", ".", "h", ">", "#", "endif", "int", "utf8_encode", "(", "int", "codepoint", ",", "char", "*", "buffer", ",", "int", "*", "size", ")", ";", "@", "@", "-", "9", ",", "11", "+", "9", ",", "19", "@", "@", "#", "define", "_GNU_SOURCE", "#", "endif", "#", "ifdef", "HAVE_CONFIG_H", "#", "include", "<", "config", ".", "h", ">", "#", "endif", "#", "include", "<", "stddef", ".", "h", ">", "#", "include", "<", "stdlib", ".", "h", ">", "#", "include", "<", "string", ".", "h", ">", "#", "include", "<", "math", ".", "h", ">", "#", "ifdef", "HAVE_STDINT_H", "#", "include", "<", "stdint", ".", "h", ">", "#", "endif", "#", "include", "\"", "jansson", ".", "h", "\"", "#", "include", "\"", "hashtable", ".", "h", "\"", "#", "include", "\"", "jansson_private", ".", "h", "\"", "@", "@", "-", "36", ",", "11", "+", "44", ",", "19", "@", "@", "static", "JSON_INLINE", "void", "json_init", "(", "json_t", "*", "json", ",", "json_type", "type", ")", "/", "**", "*", "object", "*", "**", "/", "extern", "volatile", "uint32_t", "hashtable_seed", ";", "json_t", "*", "json_object", "(", "void", ")", "{", "json_object_t", "*", "object", "=", "jsonp_malloc", "(", "sizeof", "(", "json_object_t", ")", ");", "if", "(", "!", "object", ")", "return", "NULL", ";", "if", "(", "!", "hashtable_seed", ")", "{", "/", "*", "Autoseed", "*", "/", "json_object_seed", "(", "0", ")", ";", "}", "json_init", "(", "&", "object", "-", ">", "json", ",", "JSON_OBJECT", ")", ";", "if", "(", "hashtable_init", "(", "&", "object", "-", ">", "hashtable", ")", ")", "@", "@", "-", "37", ",", "6", "+", "37", ",", "8", "@", "@", "struct", "config", "{", "int", "sort_keys", ";", "int", "strip", ";", "int", "use_env", ";", "int", "have_hashseed", ";", "int", "hashseed", ";", "}", "conf", ";", "#", "define", "l_isspace", "(", "c", ")", "(", "(", "c", ")", "=", "=", "'", "'", "|", "|", "(", "c", ")", "=", "=", "'", "\\", "n", "'", "|", "|", "(", "c", ")", "=", "=", "'", "\\", "r", "'", "|", "|", "(", "c", ")", "=", "=", "'", "\\", "t", "'", ")", "@", "@", "-", "108", ",", "6", "+", "110", ",", "12", "@", "@", "static", "void", "read_conf", "(", "FILE", "*", "conffile", ")", "conf", ".", "sort_keys", "=", "atoi", "(", "val", ")", ";", "if", "(", "!", "strcmp", "(", "line", ",", "\"", "STRIP", "\"", "))", "conf", ".", "strip", "=", "atoi", "(", "val", ")", ";", "if", "(", "!", "strcmp", "(", "line", ",", "\"", "HASHSEED", "\"", "))", "{", "conf", ".", "have_hashseed", "=", "1", ";", "conf", ".", "hashseed", "=", "atoi", "(", "val", ")", ";", "}", "else", "{", "conf", ".", "have_hashseed", "=", "0", ";", "}", "}", "free", "(", "buffer", ")", ";", "@", "@", "-", "188", ",", "6", "+", "196", ",", "9", "@", "@", "int", "use_conf", "(", "char", "*", "test_path", ")", "if", "(", "conf", ".", "sort_keys", ")", "flags", "|", "=", "JSON_SORT_KEYS", ";", "if", "(", "conf", ".", "have_hashseed", ")", "json_object_seed", "(", "conf", ".", "hashseed", ")", ";", "if", "(", "conf", ".", "strip", ")", "{", "/", "*", "Load", "to", "memory", ",", "strip", "leading", "and", "trailing", "whitespace", "*", "/", "buffer", "=", "loadfile", "(", "infile", ")", ";", "@", "@", "-", "265", ",", "7", "+", "276", ",", "10", "@", "@", "int", "use_env", "(", ")", "flags", "|", "=", "JSON_PRESERVE_ORDER", ";", "if", "(", "getenv_int", "(", "\"", "JSON_SORT_KEYS", "\"", "))", "flags", "|", "=", "JSON_SORT_KEYS", ";", "flags", "|", "=", "JSON_SORT_KEYS", ";", "if", "(", "getenv", "(", "\"", "HASHSEED", "\"", "))", "json_object_seed", "(", "getenv_int", "(", "\"", "HASHSEED", "\"", "))", ";", "if", "(", "getenv_int", "(", "\"", "STRIP", "\"", "))", "{", "/", "*", "Load", "to", "memory", ",", "strip", "leading", "and", "trailing", "whitespace", "*", "/", "@", "@", "-", "24", ",", "13", "+", "24", ",", "13", "@", "@", "static", "void", "create_and_free_complex_object", "(", ")", "static", "void", "*", "my_malloc", "(", "size_t", "size", ")", "{", "malloc_called", "+", "=", "1", ";", "malloc_called", "=", "1", ";", "return", "malloc", "(", "size", ")", ";", "}", "static", "void", "my_free", "(", "void", "*", "ptr", ")", "{", "free_called", "+", "=", "1", ";", "free_called", "=", "1", ";", "free", "(", "ptr", ")", ";", "}", "@", "@", "-", "39", ",", "7", "+", "39", ",", "7", "@", "@", "static", "void", "test_simple", "(", ")", "json_set_alloc_funcs", "(", "my_malloc", ",", "my_free", ")", ";", "create_and_free_complex_object", "(", ");", "if", "(", "malloc_called", "!", "=", "20", "|", "|", "free_called", "!", "=", "20", ")", "if", "(", "malloc_called", "!", "=", "1", "|", "|", "free_called", "!", "=", "1", ")", "fail", "(", "\"", "Custom", "allocation", "failed", "\"", ");", "}", "@", "@", "-", "249", ",", "7", "+", "249", ",", "11", "@", "@", "static", "void", "test_set_nocheck", "(", ")", "static", "void", "test_iterators", "(", ")", "{", "int", "i", ";", "json_t", "*", "object", ",", "*", "foo", ",", "*", "bar", ",", "*", "baz", ";", "const", "char", "*", "iter_keys", "[", "3", "]", ";", "int", "have_key", "[", "3", "]", "=", "{", "0", ",", "0", ",", "0", "}", ";", "json_t", "*", "iter_values", "[", "3", "]", ";", "void", "*", "iter", ";", "if", "(", "json_object_iter", "(", "NULL", ")", ")", "@", "@", "-", "276", ",", "30", "+", "280", ",", "50", "@", "@", "static", "void", "test_iterators", "(", ")", "iter", "=", "json_object_iter", "(", "object", ")", ";", "if", "(", "!", "iter", ")", "fail", "(", "\"", "unable", "to", "get", "iterator", "\"", ");", "if", "(", "strcmp", "(", "json_object_iter_key", "(", "iter", ")", ",", "\"", "a", "\"", "))", "fail", "(", "\"", "iterating", "failed", ":", "wrong", "key", "\"", ");", "if", "(", "json_object_iter_value", "(", "iter", ")", "!", "=", "foo", ")", "fail", "(", "\"", "iterating", "failed", ":", "wrong", "value", "\"", ");", "iter_keys", "[", "0", "]", "=", "json_object_iter_key", "(", "iter", ")", ";", "iter_values", "[", "0", "]", "=", "json_object_iter_value", "(", "iter", ")", ";", "iter", "=", "json_object_iter_next", "(", "object", ",", "iter", ")", ";", "if", "(", "!", "iter", ")", "fail", "(", "\"", "unable", "to", "increment", "iterator", "\"", ");", "if", "(", "strcmp", "(", "json_object_iter_key", "(", "iter", ")", ",", "\"", "b", "\"", "))", "fail", "(", "\"", "iterating", "failed", ":", "wrong", "key", "\"", ");", "if", "(", "json_object_iter_value", "(", "iter", ")", "!", "=", "bar", ")", "fail", "(", "\"", "iterating", "failed", ":", "wrong", "value", "\"", ");", "iter_keys", "[", "1", "]", "=", "json_object_iter_key", "(", "iter", ")", ";", "iter_values", "[", "1", "]", "=", "json_object_iter_value", "(", "iter", ")", ";", "iter", "=", "json_object_iter_next", "(", "object", ",", "iter", ")", ";", "if", "(", "!", "iter", ")", "fail", "(", "\"", "unable", "to", "increment", "iterator", "\"", ");", "if", "(", "strcmp", "(", "json_object_iter_key", "(", "iter", ")", ",", "\"", "c", "\"", "))", "fail", "(", "\"", "iterating", "failed", ":", "wrong", "key", "\"", ");", "if", "(", "json_object_iter_value", "(", "iter", ")", "!", "=", "baz", ")", "fail", "(", "\"", "iterating", "failed", ":", "wrong", "value", "\"", ");", "iter_keys", "[", "2", "]", "=", "json_object_iter_key", "(", "iter", ")", ";", "iter_values", "[", "2", "]", "=", "json_object_iter_value", "(", "iter", ")", ";", "if", "(", "json_object_iter_next", "(", "object", ",", "iter", ")", "!", "=", "NULL", ")", "fail", "(", "\"", "able", "to", "iterate", "over", "the", "end", "\"", ");", "/", "*", "Check", "that", "keys", "have", "correct", "values", "*", "/", "for", "(", "i", "=", "0", ";", "i", "<", "3", ";", "i", "+", "+)", "{", "if", "(", "strcmp", "(", "iter_keys", "[", "i", "]", ",", "\"", "a", "\"", ")", "=", "=", "0", ")", "{", "if", "(", "iter_values", "[", "i", "]", "!", "=", "foo", ")", "fail", "(", "\"", "wrong", "value", "for", "iter", "key", "a", "\"", ");", "else", "have_key", "[", "0", "]", "=", "1", ";", "}", "else", "if", "(", "strcmp", "(", "iter_keys", "[", "i", "]", ",", "\"", "b", "\"", ")", "=", "=", "0", ")", "{", "if", "(", "iter_values", "[", "i", "]", "!", "=", "bar", ")", "fail", "(", "\"", "wrong", "value", "for", "iter", "key", "b", "\"", ");", "else", "have_key", "[", "1", "]", "=", "1", ";", "}", "else", "if", "(", "strcmp", "(", "iter_keys", "[", "i", "]", ",", "\"", "c", "\"", ")", "=", "=", "0", ")", "{", "if", "(", "iter_values", "[", "i", "]", "!", "=", "baz", ")", "fail", "(", "\"", "wrong", "value", "for", "iter", "key", "c", "\"", ");", "else", "have_key", "[", "2", "]", "=", "1", ";", "}", "}", "/", "*", "Check", "that", "we", "got", "all", "keys", "*", "/", "for", "(", "i", "=", "0", ";", "i", "<", "3", ";", "i", "+", "+)", "{", "if", "(", "!", "have_key", "[", "i", "]", ")", "fail", "(", "\"", "a", "key", "wasn", "'", "t", "iterated", "over", "\"", ");", "}", "if", "(", "json_object_iter_at", "(", "object", ",", "\"", "foo", "\"", "))", "fail", "(", "\"", "json_object_iter_at", "(", ")", "succeeds", "for", "non", "-", "existent", "key", "\"", ");", "@", "@", "-", "312", ",", "22", "+", "336", ",", "14", "@", "@", "static", "void", "test_iterators", "(", ")", "if", "(", "json_object_iter_value", "(", "iter", ")", "!", "=", "bar", ")", "fail", "(", "\"", "iterating", "failed", ":", "wrong", "value", "\"", ");", "iter", "=", "json_object_iter_next", "(", "object", ",", "iter", ")", ";", "if", "(", "!", "iter", ")", "fail", "(", "\"", "unable", "to", "increment", "iterator", "\"", ");", "if", "(", "strcmp", "(", "json_object_iter_key", "(", "iter", ")", ",", "\"", "c", "\"", "))", "fail", "(", "\"", "iterating", "failed", ":", "wrong", "key", "\"", ");", "if", "(", "json_object_iter_value", "(", "iter", ")", "!", "=", "baz", ")", "fail", "(", "\"", "iterating", "failed", ":", "wrong", "value", "\"", ");", "if", "(", "json_object_iter_set", "(", "object", ",", "iter", ",", "bar", ")", ")", "if", "(", "json_object_iter_set", "(", "object", ",", "iter", ",", "baz", ")", ")", "fail", "(", "\"", "unable", "to", "set", "value", "at", "iterator", "\"", ");", "if", "(", "strcmp", "(", "json_object_iter_key", "(", "iter", ")", ",", "\"", "c", "\"", "))", "if", "(", "strcmp", "(", "json_object_iter_key", "(", "iter", ")", ",", "\"", "b", "\"", "))", "fail", "(", "\"", "json_object_iter_key", "(", ")", "fails", "after", "json_object_iter_set", "(", ")\"", ");", "if", "(", "json_object_iter_value", "(", "iter", ")", "!", "=", "bar", ")", "if", "(", "json_object_iter_value", "(", "iter", ")", "!", "=", "baz", ")", "fail", "(", "\"", "json_object_iter_value", "(", ")", "fails", "after", "json_object_iter_set", "(", ")\"", ");", "if", "(", "json_object_get", "(", "object", ",", "\"", "c", "\"", ")", "!", "=", "bar", ")", "if", "(", "json_object_get", "(", "object", ",", "\"", "b", "\"", ")", "!", "=", "baz", ")", "fail", "(", "\"", "json_object_get", "(", ")", "fails", "after", "json_object_iter_set", "(", ")\"", ");", "json_decref", "(", "object", ")", ";", "@", "@", "-", "1", ",", "2", "+", "1", ",", "3", "@", "@", "JSON_COMPACT", "=", "1", "export", "JSON_COMPACT", "HASHSEED", "=", "1", "export", "JSON_COMPACT", "HASHSEED", "@", "@", "-", "1", ",", "3", "+", "1", ",", "4", "@", "@", "JSON_INDENT", "=", "4", "JSON_COMPACT", "=", "1", "export", "JSON_INDENT", "JSON_COMPACT", "HASHSEED", "=", "1", "export", "JSON_INDENT", "JSON_COMPACT", "HASHSEED", "@", "@", "-", "1", ",", "2", "+", "1", ",", "3", "@", "@", "JSON_INDENT", "=", "4", "export", "JSON_INDENT", "HASHSEED", "=", "1", "export", "JSON_INDENT", "HASHSEED", "@", "@", "-", "0", ",", "0", "+", "1", ",", "2", "@", "@", "HASHSEED", "=", "1", "export", "HASHSEED"], "docstring_tokens": ["does", "not", "restrict", "the", "ability", "to", "trigger", "hash", "collisions", "predictably"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "602", ",", "8", "+", "602", ",", "10", "@", "@", "static", "int", "clie_5_attach", "(", "struct", "usb_serial", "*", "serial", ")", "*", "/", "/", "*", "some", "sanity", "check", "*", "/", "if", "(", "serial", "-", ">", "num_ports", "<", "2", ")", "return", "-", "1", ";", "if", "(", "serial", "-", ">", "num_bulk_out", "<", "2", ")", "{", "dev_err", "(", "&", "serial", "-", ">", "interface", "-", ">", "dev", ",", "\"", "missing", "bulk", "out", "endpoints", "\\", "n", "\"", ");", "return", "-", "ENODEV", ";", "}", "/", "*", "port", "0", "now", "uses", "the", "modified", "endpoint", "Address", "*", "/", "port", "=", "serial", "-", ">", "port", "[", "0", "]", ";"], "docstring_tokens": ["an", "incomplete", "sanity", "check"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "550", ",", "11", "+", "550", ",", "17", "@", "@", "struct", "ftdi_private", "{", "spinlock_t", "rx_lock", ";", "/", "*", "spinlock", "for", "receive", "state", "*", "/", "struct", "work_struct", "rx_work", ";", "int", "rx_processed", ";", "unsigned", "long", "rx_bytes", ";", "__u16", "interface", ";", "/", "*", "FT2232C", "port", "interface", "(", "0", "for", "FT232", "/", "245", ")", "*", "/", "int", "force_baud", ";", "/", "*", "if", "non", "-", "zero", ",", "force", "the", "baud", "rate", "to", "this", "value", "*", "/", "int", "force_rtscts", ";", "/", "*", "if", "non", "-", "zero", ",", "force", "RTS", "-", "CTS", "to", "always", "be", "enabled", "*", "/", "spinlock_t", "tx_lock", ";", "/", "*", "spinlock", "for", "transmit", "state", "*", "/", "unsigned", "long", "tx_bytes", ";", "unsigned", "long", "tx_outstanding_bytes", ";", "unsigned", "long", "tx_outstanding_urbs", ";", "}", ";", "/", "*", "Used", "for", "TIOCMIWAIT", "*", "/", "@", "@", "-", "628", ",", "6", "+", "634", ",", "9", "@", "@", "static", "struct", "usb_serial_driver", "ftdi_sio_device", "=", "{", "#", "define", "HIGH", "1", "#", "define", "LOW", "0", "/", "*", "number", "of", "outstanding", "urbs", "to", "prevent", "userspace", "DoS", "from", "happening", "*", "/", "#", "define", "URB_UPPER_LIMIT", "42", "/", "*", "*", "*", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "*", "Utlity", "functions", "@", "@", "-", "1158", ",", "6", "+", "1167", ",", "7", "@", "@", "static", "int", "ftdi_sio_attach", "(", "struct", "usb_serial", "*", "serial", ")", "}", "spin_lock_init", "(", "&", "priv", "-", ">", "rx_lock", ")", ";", "spin_lock_init", "(", "&", "priv", "-", ">", "tx_lock", ")", ";", "init_waitqueue_head", "(", "&", "priv", "-", ">", "delta_msr_wait", ")", ";", "/", "*", "This", "will", "push", "the", "characters", "through", "immediately", "rather", "than", "queue", "a", "task", "to", "deliver", "them", "*", "/", "@", "@", "-", "1272", ",", "6", "+", "1282", ",", "13", "@", "@", "static", "int", "ftdi_open", "(", "struct", "usb_serial_port", "*", "port", ",", "struct", "file", "*", "filp", ")", "dbg", "(", "\"%", "s", "\"", ",", "__FUNCTION__", ")", ";", "spin_lock_irqsave", "(", "&", "priv", "-", ">", "tx_lock", ",", "flags", ")", ";", "priv", "-", ">", "tx_bytes", "=", "0", ";", "spin_unlock_irqrestore", "(", "&", "priv", "-", ">", "tx_lock", ",", "flags", ")", ";", "spin_lock_irqsave", "(", "&", "priv", "-", ">", "rx_lock", ",", "flags", ")", ";", "priv", "-", ">", "rx_bytes", "=", "0", ";", "spin_unlock_irqrestore", "(", "&", "priv", "-", ">", "rx_lock", ",", "flags", ")", ";", "if", "(", "port", "-", ">", "tty", ")", "port", "-", ">", "tty", "-", ">", "low_latency", "=", "(", "priv", "-", ">", "flags", "&", "ASYNC_LOW_LATENCY", ")", "?", "1", ":", "0", ";", "@", "@", "-", "1374", ",", "13", "+", "1391", ",", "21", "@", "@", "static", "int", "ftdi_write", "(", "struct", "usb_serial_port", "*", "port", ",", "int", "data_offset", ";", "/", "*", "will", "be", "1", "for", "the", "SIO", "and", "0", "otherwise", "*", "/", "int", "status", ";", "int", "transfer_size", ";", "unsigned", "long", "flags", ";", "dbg", "(", "\"%", "s", "port", "%", "d", ",", "%", "d", "bytes", "\"", ",", "__FUNCTION__", ",", "port", "-", ">", "number", ",", "count", ")", ";", "if", "(", "count", "=", "=", "0", ")", "{", "dbg", "(", "\"", "write", "request", "of", "0", "bytes", "\"", ");", "return", "0", ";", "}", "spin_lock_irqsave", "(", "&", "priv", "-", ">", "tx_lock", ",", "flags", ")", ";", "if", "(", "priv", "-", ">", "tx_outstanding_urbs", ">", "URB_UPPER_LIMIT", ")", "{", "spin_unlock_irqrestore", "(", "&", "priv", "-", ">", "tx_lock", ",", "flags", ")", ";", "dbg", "(", "\"%", "s", "-", "write", "limit", "hit", "\\", "n", "\"", ",", "__FUNCTION__", ")", ";", "return", "0", ";", "}", "spin_unlock_irqrestore", "(", "&", "priv", "-", ">", "tx_lock", ",", "flags", ")", ";", "data_offset", "=", "priv", "-", ">", "write_offset", ";", "dbg", "(", "\"", "data_offset", "set", "to", "%", "d", "\"", ",", "data_offset", ")", ";", "@", "@", "-", "1447", ",", "6", "+", "1472", ",", "12", "@", "@", "static", "int", "ftdi_write", "(", "struct", "usb_serial_port", "*", "port", ",", "err", "(", "\"%", "s", "-", "failed", "submitting", "write", "urb", ",", "error", "%", "d", "\"", ",", "__FUNCTION__", ",", "status", ")", ";", "count", "=", "status", ";", "kfree", "(", "buffer", ")", ";", "}", "else", "{", "spin_lock_irqsave", "(", "&", "priv", "-", ">", "tx_lock", ",", "flags", ")", ";", "+", "+", "priv", "-", ">", "tx_outstanding_urbs", ";", "priv", "-", ">", "tx_outstanding_bytes", "+", "=", "count", ";", "priv", "-", ">", "tx_bytes", "+", "=", "count", ";", "spin_unlock_irqrestore", "(", "&", "priv", "-", ">", "tx_lock", ",", "flags", ")", ";", "}", "/", "*", "we", "are", "done", "with", "this", "urb", ",", "so", "let", "the", "host", "driver", "@", "@", "-", "1462", ",", "7", "+", "1493", ",", "11", "@", "@", "static", "int", "ftdi_write", "(", "struct", "usb_serial_port", "*", "port", ",", "static", "void", "ftdi_write_bulk_callback", "(", "struct", "urb", "*", "urb", ",", "struct", "pt_regs", "*", "regs", ")", "{", "unsigned", "long", "flags", ";", "struct", "usb_serial_port", "*", "port", "=", "(", "struct", "usb_serial_port", "*", ")", "urb", "-", ">", "context", ";", "struct", "ftdi_private", "*", "priv", ";", "int", "data_offset", ";", "/", "*", "will", "be", "1", "for", "the", "SIO", "and", "0", "otherwise", "*", "/", "unsigned", "long", "countback", ";", "/", "*", "free", "up", "the", "transfer", "buffer", ",", "as", "usb_free_urb", "(", ")", "does", "not", "do", "this", "*", "/", "kfree", "(", "urb", "-", ">", "transfer_buffer", ")", ";", "@", "@", "-", "1474", ",", "34", "+", "1509", ",", "67", "@", "@", "static", "void", "ftdi_write_bulk_callback", "(", "struct", "urb", "*", "urb", ",", "struct", "pt_regs", "*", "regs", ")", "return", ";", "}", "priv", "=", "usb_get_serial_port_data", "(", "port", ")", ";", "if", "(", "!", "priv", ")", "{", "dbg", "(", "\"%", "s", "-", "bad", "port", "private", "data", "pointer", "-", "exiting", "\"", ",", "__FUNCTION__", ")", ";", "return", ";", "}", "/", "*", "account", "for", "transferred", "data", "*", "/", "countback", "=", "urb", "-", ">", "actual_length", ";", "data_offset", "=", "priv", "-", ">", "write_offset", ";", "if", "(", "data_offset", ">", "0", ")", "{", "/", "*", "Subtract", "the", "control", "bytes", "*", "/", "countback", "-", "=", "(", "data_offset", "*", "(", "(", "countback", "+", "(", "PKTSZ", "-", "1", ")", ")", "/", "PKTSZ", ")", ");", "}", "spin_lock_irqsave", "(", "&", "priv", "-", ">", "tx_lock", ",", "flags", ")", ";", "-", "-", "priv", "-", ">", "tx_outstanding_urbs", ";", "priv", "-", ">", "tx_outstanding_bytes", "-", "=", "countback", ";", "spin_unlock_irqrestore", "(", "&", "priv", "-", ">", "tx_lock", ",", "flags", ")", ";", "usb_serial_port_softint", "(", "port", ")", ";", "}", "/", "*", "ftdi_write_bulk_callback", "*", "/", "static", "int", "ftdi_write_room", "(", "struct", "usb_serial_port", "*", "port", ")", "{", "struct", "ftdi_private", "*", "priv", "=", "usb_get_serial_port_data", "(", "port", ")", ";", "int", "room", ";", "unsigned", "long", "flags", ";", "dbg", "(", "\"%", "s", "-", "port", "%", "d", "\"", ",", "__FUNCTION__", ",", "port", "-", ">", "number", ")", ";", "/", "*", "*", "We", "really", "can", "take", "anything", "the", "user", "throws", "at", "us", "*", "but", "let", "'", "s", "pick", "a", "nice", "big", "number", "to", "tell", "the", "tty", "*", "layer", "that", "we", "have", "lots", "of", "free", "space", "*", "/", "return", "2048", ";", "spin_lock_irqsave", "(", "&", "priv", "-", ">", "tx_lock", ",", "flags", ")", ";", "if", "(", "priv", "-", ">", "tx_outstanding_urbs", "<", "URB_UPPER_LIMIT", ")", "{", "/", "*", "*", "We", "really", "can", "take", "anything", "the", "user", "throws", "at", "us", "*", "but", "let", "'", "s", "pick", "a", "nice", "big", "number", "to", "tell", "the", "tty", "*", "layer", "that", "we", "have", "lots", "of", "free", "space", "*", "/", "room", "=", "2048", ";", "}", "else", "{", "room", "=", "0", ";", "}", "spin_unlock_irqrestore", "(", "&", "priv", "-", ">", "tx_lock", ",", "flags", ")", ";", "return", "room", ";", "}", "/", "*", "ftdi_write_room", "*", "/", "static", "int", "ftdi_chars_in_buffer", "(", "struct", "usb_serial_port", "*", "port", ")", "{", "/", "*", "ftdi_chars_in_buffer", "*", "/", "struct", "ftdi_private", "*", "priv", "=", "usb_get_serial_port_data", "(", "port", ")", ";", "int", "buffered", ";", "unsigned", "long", "flags", ";", "dbg", "(", "\"%", "s", "-", "port", "%", "d", "\"", ",", "__FUNCTION__", ",", "port", "-", ">", "number", ")", ";", "/", "*", "*", "We", "can", "'", "t", "really", "account", "for", "how", "much", "data", "we", "*", "have", "sent", "out", ",", "but", "hasn", "'", "t", "made", "it", "through", "to", "the", "*", "device", ",", "so", "just", "tell", "the", "tty", "layer", "that", "everything", "*", "is", "flushed", ".", "*", "/", "return", "0", ";", "spin_lock_irqsave", "(", "&", "priv", "-", ">", "tx_lock", ",", "flags", ")", ";", "buffered", "=", "(", "int", ")", "priv", "-", ">", "tx_outstanding_bytes", ";", "spin_unlock_irqrestore", "(", "&", "priv", "-", ">", "tx_lock", ",", "flags", ")", ";", "if", "(", "buffered", "<", "0", ")", "{", "err", "(", "\"%", "s", "outstanding", "tx", "bytes", "is", "negative", "!", "\",", "__FUNCTION__", ")", ";", "buffered", "=", "0", ";", "}", "return", "buffered", ";", "}", "/", "*", "ftdi_chars_in_buffer", "*", "/", "@", "@", "-", "1511", ",", "6", "+", "1579", ",", "8", "@", "@", "static", "void", "ftdi_read_bulk_callback", "(", "struct", "urb", "*", "urb", ",", "struct", "pt_regs", "*", "regs", ")", "struct", "usb_serial_port", "*", "port", "=", "(", "struct", "usb_serial_port", "*", ")", "urb", "-", ">", "context", ";", "struct", "tty_struct", "*", "tty", ";", "struct", "ftdi_private", "*", "priv", ";", "unsigned", "long", "countread", ";", "unsigned", "long", "flags", ";", "if", "(", "urb", "-", ">", "number_of_packets", ">", "0", ")", "{", "err", "(", "\"%", "s", "transfer_buffer_length", "%", "d", "actual_length", "%", "d", "number", "of", "packets", "%", "d", "\"", ",", "__FUNCTION__", ",", "@", "@", "-", "1545", ",", "6", "+", "1615", ",", "13", "@", "@", "static", "void", "ftdi_read_bulk_callback", "(", "struct", "urb", "*", "urb", ",", "struct", "pt_regs", "*", "regs", ")", "return", ";", "}", "/", "*", "count", "data", "bytes", ",", "but", "not", "status", "bytes", "*", "/", "countread", "=", "urb", "-", ">", "actual_length", ";", "countread", "-", "=", "2", "*", "(", "(", "countread", "+", "(", "PKTSZ", "-", "1", ")", ")", "/", "PKTSZ", ")", ";", "spin_lock_irqsave", "(", "&", "priv", "-", ">", "rx_lock", ",", "flags", ")", ";", "priv", "-", ">", "rx_bytes", "+", "=", "countread", ";", "spin_unlock_irqrestore", "(", "&", "priv", "-", ">", "rx_lock", ",", "flags", ")", ";", "ftdi_process_read", "(", "port", ")", ";", "}", "/", "*", "ftdi_read_bulk_callback", "*", "/"], "docstring_tokens": ["improper", "handling", "of", "queued", "data"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2217", ",", "7", "+", "2217", ",", "10", "@", "@", "public", "void", "receiveMessageHeader", "(", "final", "BasicContentHeaderProperties", "properties", ",", "closeChannel", "(", "ErrorCodes", ".", "MESSAGE_TOO_LARGE", ",", "\"", "Message", "size", "of", "\"", "+", "bodySize", "+", "\"", "greater", "than", "allowed", "maximum", "of", "\"", "+", "_connection", ".", "getMaxMessageSize", "(", "))", ";", "}", "publishContentHeader", "(", "new", "ContentHeaderBody", "(", "properties", ",", "bodySize", ")", ");", "else", "{", "publishContentHeader", "(", "new", "ContentHeaderBody", "(", "properties", ",", "bodySize", ")", ");", "}", "}", "else", "{", "@", "@", "-", "0", ",", "0", "+", "1", ",", "83", "@", "@", "/", "*", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "*", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "*", "distributed", "with", "this", "work", "for", "additional", "information", "*", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "*", "to", "you", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "*", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "*", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "*", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "*", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "*", "specific", "language", "governing", "permissions", "and", "limitations", "*", "under", "the", "License", ".", "*", "*", "/", "package", "org", ".", "apache", ".", "qpid", ".", "tests", ".", "protocol", ".", "v0_8", ".", "extension", ".", "maxsize", ";", "import", "static", "org", ".", "apache", ".", "qpid", ".", "tests", ".", "utils", ".", "BrokerAdmin", ".", "KIND_BROKER_J", ";", "import", "static", "org", ".", "hamcrest", ".", "CoreMatchers", ".", "equalTo", ";", "import", "static", "org", ".", "hamcrest", ".", "CoreMatchers", ".", "is", ";", "import", "static", "org", ".", "hamcrest", ".", "MatcherAssert", ".", "assertThat", ";", "import", "java", ".", "net", ".", "InetSocketAddress", ";", "import", "java", ".", "util", ".", "stream", ".", "Collectors", ";", "import", "java", ".", "util", ".", "stream", ".", "Stream", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "apache", ".", "qpid", ".", "server", ".", "protocol", ".", "v0_8", ".", "transport", ".", "ChannelCloseBody", ";", "import", "org", ".", "apache", ".", "qpid", ".", "server", ".", "protocol", ".", "v0_8", ".", "transport", ".", "ChannelOpenOkBody", ";", "import", "org", ".", "apache", ".", "qpid", ".", "server", ".", "protocol", ".", "v0_8", ".", "transport", ".", "ConnectionCloseOkBody", ";", "import", "org", ".", "apache", ".", "qpid", ".", "tests", ".", "protocol", ".", "ChannelClosedResponse", ";", "import", "org", ".", "apache", ".", "qpid", ".", "tests", ".", "protocol", ".", "v0_8", ".", "FrameTransport", ";", "import", "org", ".", "apache", ".", "qpid", ".", "tests", ".", "protocol", ".", "v0_8", ".", "Interaction", ";", "import", "org", ".", "apache", ".", "qpid", ".", "tests", ".", "utils", ".", "BrokerAdmin", ";", "import", "org", ".", "apache", ".", "qpid", ".", "tests", ".", "utils", ".", "BrokerAdminUsingTestBase", ";", "import", "org", ".", "apache", ".", "qpid", ".", "tests", ".", "utils", ".", "BrokerSpecific", ";", "import", "org", ".", "apache", ".", "qpid", ".", "tests", ".", "utils", ".", "ConfigItem", ";", "@", "BrokerSpecific", "(", "kind", "=", "KIND_BROKER_J", ")", "@", "ConfigItem", "(", "name", "=", "\"", "qpid", ".", "max_message_size", "\"", ",", "value", "=", "\"", "1000", "\"", ")", "public", "class", "MaximumMessageSize", "extends", "BrokerAdminUsingTestBase", "{", "private", "InetSocketAddress", "_brokerAddress", ";", "@", "Before", "public", "void", "setUp", "(", ")", "{", "_brokerAddress", "=", "getBrokerAdmin", "(", ").", "getBrokerAddress", "(", "BrokerAdmin", ".", "PortType", ".", "ANONYMOUS_AMQP", ")", ";", "getBrokerAdmin", "(", ").", "createQueue", "(", "BrokerAdmin", ".", "TEST_QUEUE_NAME", ")", ";", "}", "@", "Test", "public", "void", "limitExceeded", "(", ")", "throws", "Exception", "{", "String", "content", "=", "Stream", ".", "generate", "(", "()", "-", ">", "String", ".", "valueOf", "(", "'.", "')", ").", "limit", "(", "1001", ")", ".", "collect", "(", "Collectors", ".", "joining", "(", "))", ";", "try", "(", "FrameTransport", "transport", "=", "new", "FrameTransport", "(", "_brokerAddress", ")", ".", "connect", "(", "))", "{", "final", "Interaction", "interaction", "=", "transport", ".", "newInteraction", "(", ");", "interaction", ".", "openAnonymousConnection", "(", ")", ".", "channel", "(", ").", "open", "(", ").", "consumeResponse", "(", "ChannelOpenOkBody", ".", "class", ")", ".", "basic", "(", ").", "contentHeaderPropertiesContentType", "(", "\"", "text", "/", "plain", "\"", ")", ".", "contentHeaderPropertiesDeliveryMode", "(", "(", "byte", ")", "1", ")", ".", "contentHeaderPropertiesPriority", "(", "(", "byte", ")", "1", ")", ".", "publishExchange", "(", "\"\"", ")", ".", "publishRoutingKey", "(", "BrokerAdmin", ".", "TEST_QUEUE_NAME", ")", ".", "content", "(", "content", ")", ".", "publishMessage", "(", ")", ".", "consumeResponse", "(", "ChannelCloseBody", ".", "class", ")", ".", "channel", "(", ").", "closeOk", "(", ")", ".", "connection", "(", ").", "close", "(", ")", ".", "consumeResponse", "(", "ConnectionCloseOkBody", ".", "class", ",", "ChannelClosedResponse", ".", "class", ")", ";", "assertThat", "(", "getBrokerAdmin", "(", ").", "getQueueDepthMessages", "(", "BrokerAdmin", ".", "TEST_QUEUE_NAME", ")", ",", "is", "(", "equalTo", "(", "0", ")", "))", ";", "}", "}", "}"], "docstring_tokens": ["A", "Denial", "of", "Service"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "562", ",", "7", "+", "562", ",", "7", "@", "@", "public", "void", "internalAdd", "(", "final", "Component", "child", ")", "*", "/", "class", "MarkupChildIterator", "implements", "Iterator", "<", "Component", ">", "{", "private", "int", "indexInRemovalsSinceLastUpdate", "=", "removals_size", "(", ");", "private", "int", "indexInRemovalsSinceLastUpdate", ";", "private", "int", "expectedModCounter", "=", "-", "1", ";", "private", "Component", "currentComponent", "=", "null", ";", "private", "Iterator", "<", "Component", ">", "internalIterator", "=", "null", ";", "@", "@", "-", "590", ",", "8", "+", "590", ",", "10", "@", "@", "public", "void", "remove", "(", ")", "private", "void", "refreshInternalIteratorIfNeeded", "(", ")", "{", "if", "(", "expectedModCounter", ">", "=", "modCounter", ")", "if", "(", "expectedModCounter", ">", "=", "modCounter", ")", "{", "/", "/", "no", "new", "modifications", "return", ";", "}", "if", "(", "children", "=", "=", "null", ")", "{", "@", "@", "-", "615", ",", "7", "+", "617", ",", "6", "@", "@", "else", "if", "(", "children", "instanceof", "List", ")", "/", "/", "since", "we", "now", "have", "a", "new", "iterator", ",", "we", "need", "to", "set", "it", "to", "the", "last", "known", "position", "currentComponent", "=", "findLastExistingChildAlreadyReturned", "(", "currentComponent", ")", ";", "expectedModCounter", "=", "modCounter", ";", "indexInRemovalsSinceLastUpdate", "=", "removals_size", "(", ");", "if", "(", "currentComponent", "!", "=", "null", ")", "{", "@", "@", "-", "627", ",", "33", "+", "628", ",", "38", "@", "@", "else", "if", "(", "children", "instanceof", "List", ")", "}", "}", "private", "Component", "findLastExistingChildAlreadyReturned", "(", "Component", "target", ")", "private", "Component", "findLastExistingChildAlreadyReturned", "(", "Component", "current", ")", "{", "while", "(", "true", ")", "{", "if", "(", "target", "=", "=", "null", ")", "return", "null", ";", "RemovedChild", "removedChild", "=", "null", ";", "for", "(", "int", "i", "=", "indexInRemovalsSinceLastUpdate", ";", "i", "<", "removals_size", "(", ");", "i", "+", "+)", "{", "RemovedChild", "curRemovedChild", "=", "removals_get", "(", "i", ")", ";", "if", "(", "curRemovedChild", ".", "removedChild", "=", "=", "target", "|", "|", "curRemovedChild", ".", "removedChild", "=", "=", "null", ")", "if", "(", "current", "=", "=", "null", ")", "{", "indexInRemovalsSinceLastUpdate", "=", "0", ";", "}", "else", "{", "LinkedList", "<", "RemovedChild", ">", "removals", "=", "removals_get", "(", ");", "if", "(", "removals", "!", "=", "null", ")", "{", "check_removed", ":", "while", "(", "current", "!", "=", "null", ")", "{", "removedChild", "=", "curRemovedChild", ";", "for", "(", "int", "i", "=", "indexInRemovalsSinceLastUpdate", ";", "i", "<", "removals", ".", "size", "(", ");", "i", "+", "+)", "{", "RemovedChild", "removal", "=", "removals", ".", "get", "(", "i", ")", ";", "if", "(", "removal", ".", "removedChild", "=", "=", "current", "|", "|", "removal", ".", "removedChild", "=", "=", "null", ")", "{", "current", "=", "removal", ".", "previousSibling", ";", "/", "/", "current", "was", "removed", ",", "use", "its", "sibling", "instead", "continue", "check_removed", ";", "}", "}", "/", "/", "current", "wasn", "'", "t", "removed", ",", "keep", "it", "break", ";", "}", "}", "if", "(", "removedChild", "=", "=", "null", ")", "{", "return", "target", ";", "}", "else", "{", "target", "=", "removedChild", ".", "previousSibling", ";", "indexInRemovalsSinceLastUpdate", "=", "removals", ".", "size", "(", ");", "}", "}", "return", "current", ";", "}", "}", ";", "return", "new", "MarkupChildIterator", "(", ");", "@", "@", "-", "1361", ",", "29", "+", "1367", ",", "6", "@", "@", "private", "void", "removals_add", "(", "Component", "removedChild", ",", "Component", "prevSibling", ")", "removals", ".", "add", "(", "new", "RemovedChild", "(", "removedChild", ",", "prevSibling", ")", ");", "}", "/", "**", "*", "Gets", "the", "{", "@", "link", "RemovedChild", "}", "from", "the", "list", "of", "removals", "at", "given", "position", ".", "*", "*", "@", "param", "i", "*", "the", "position", "*", "@", "return", "the", "removed", "child", "*", "/", "private", "RemovedChild", "removals_get", "(", "int", "i", ")", "{", "return", "getMetaData", "(", "REMOVALS_KEY", ")", ".", "get", "(", "i", ")", ";", "}", "/", "**", "*", "Gets", "the", "number", "of", "removals", "that", "happened", "during", "the", "request", ".", "*", "*", "@", "return", "the", "number", "of", "removals", "*", "/", "private", "int", "removals_size", "(", ")", "{", "LinkedList", "<", "RemovedChild", ">", "removals", "=", "removals_get", "(", ");", "return", "removals", "=", "=", "null", "?", "0", ":", "removals", ".", "size", "(", ");", "}", "/", "**", "*", "@", "param", "component", "*", "Component", "being", "removed"], "docstring_tokens": ["see", "possibly", "sensitive", "information", "inside", "a", "HTML", "template"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "245", ",", "6", "+", "245", ",", "7", "@", "@", "static", "int", "l2cap_sock_getname", "(", "struct", "socket", "*", "sock", ",", "struct", "sockaddr", "*", "addr", ",", "int", "*", "l", "BT_DBG", "(", "\"", "sock", "%", "p", ",", "sk", "%", "p", "\"", ",", "sock", ",", "sk", ")", ";", "memset", "(", "la", ",", "0", ",", "sizeof", "(", "struct", "sockaddr_l2", ")", ");", "addr", "-", ">", "sa_family", "=", "AF_BLUETOOTH", ";", "*", "len", "=", "sizeof", "(", "struct", "sockaddr_l2", ")", ";"], "docstring_tokens": ["does", "not", "properly", "initialize", "certain", "structures"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "102", ",", "6", "+", "102", ",", "7", "@", "@", "static", "int", "ext3_readdir", "(", "struct", "file", "*", "filp", ",", "int", "err", ";", "struct", "inode", "*", "inode", "=", "filp", "-", ">", "f_path", ".", "dentry", "-", ">", "d_inode", ";", "int", "ret", "=", "0", ";", "int", "dir_has_error", "=", "0", ";", "sb", "=", "inode", "-", ">", "i_sb", ";", "@", "@", "-", "148", ",", "9", "+", "149", ",", "12", "@", "@", "static", "int", "ext3_readdir", "(", "struct", "file", "*", "filp", ",", "*", "of", "recovering", "data", "when", "there", "'", "s", "a", "bad", "sector", "*", "/", "if", "(", "!", "bh", ")", "{", "ext3_error", "(", "sb", ",", "\"", "ext3_readdir", "\"", ",", "\"", "directory", "#", "%", "lu", "contains", "a", "hole", "at", "offset", "%", "lu", "\"", ",", "inode", "-", ">", "i_ino", ",", "(", "unsigned", "long", ")", "filp", "-", ">", "f_pos", ")", ";", "if", "(", "!", "dir_has_error", ")", "{", "ext3_error", "(", "sb", ",", "__func__", ",", "\"", "directory", "#", "%", "lu", "\"", "\"", "contains", "a", "hole", "at", "offset", "%", "lld", "\"", ",", "inode", "-", ">", "i_ino", ",", "filp", "-", ">", "f_pos", ")", ";", "dir_has_error", "=", "1", ";", "}", "/", "*", "corrupt", "size", "?", "Maybe", "no", "more", "blocks", "to", "read", "*", "/", "if", "(", "filp", "-", ">", "f_pos", ">", "inode", "-", ">", "i_blocks", "<", "<", "9", ")", "break", ";"], "docstring_tokens": ["does", "not", "limit", "the", "number", "of", "printk", "console", "messages", "that", "report", "directory", "corruption"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1855", ",", "7", "+", "1855", ",", "7", "@", "@", "static", "int", "atyfb_ioctl", "(", "struct", "fb_info", "*", "info", ",", "u_int", "cmd", ",", "u_long", "arg", ")", "#", "if", "defined", "(", "DEBUG", ")", "&", "&", "defined", "(", "CONFIG_FB_ATY_CT", ")", "case", "ATYIO_CLKR", ":", "if", "(", "M64_HAS", "(", "INTEGRATED", ")", ")", "{", "struct", "atyclk", "clk", ";", "struct", "atyclk", "clk", "=", "{", "0", "}", ";", "union", "aty_pll", "*", "pll", "=", "&", "par", "-", ">", "pll", ";", "u32", "dsp_config", "=", "pll", "-", ">", "ct", ".", "dsp_config", ";", "u32", "dsp_on_off", "=", "pll", "-", ">", "ct", ".", "dsp_on_off", ";"], "docstring_tokens": ["does", "not", "initialize", "a", "certain", "data", "structure"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "15", ",", "7", "+", "15", ",", "7", "@", "@", "|", "Author", ":", "Sterling", "Hughes", "<", "sterling", "@", "php", ".", "net", ">", "|", "+", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "*", "/", "/", "*", "$", "Id", "$", "*", "/", "#", "ifdef", "HAVE_CONFIG_H", "@", "@", "-", "137", ",", "29", "+", "137", ",", "33", "@", "@", "struct", "php_bz2_stream_data_t", "{", "static", "size_t", "php_bz2iop_read", "(", "php_stream", "*", "stream", ",", "char", "*", "buf", ",", "size_t", "count", "TSRMLS_DC", ")", "{", "struct", "php_bz2_stream_data_t", "*", "self", "=", "(", "struct", "php_bz2_stream_data_t", "*", ")", "stream", "-", ">", "abstract", ";", "size_t", "ret", ";", "ret", "=", "BZ2_bzread", "(", "self", "-", ">", "bz_file", ",", "buf", ",", "count", ")", ";", "int", "bz2_ret", ";", "bz2_ret", "=", "BZ2_bzread", "(", "self", "-", ">", "bz_file", ",", "buf", ",", "count", ")", ";", "if", "(", "ret", "=", "=", "0", ")", "{", "if", "(", "bz2_ret", "<", "0", ")", "{", "stream", "-", ">", "eof", "=", "1", ";", "return", "-", "1", ";", "}", "if", "(", "bz2_ret", "=", "=", "0", ")", "{", "stream", "-", ">", "eof", "=", "1", ";", "}", "return", "ret", ";", "return", "(", "size_t", ")", "bz2_ret", ";", "}", "static", "size_t", "php_bz2iop_write", "(", "php_stream", "*", "stream", ",", "const", "char", "*", "buf", ",", "size_t", "count", "TSRMLS_DC", ")", "{", "struct", "php_bz2_stream_data_t", "*", "self", "=", "(", "struct", "php_bz2_stream_data_t", "*", ")", "stream", "-", ">", "abstract", ";", "return", "BZ2_bzwrite", "(", "self", "-", ">", "bz_file", ",", "(", "char", "*", ")", "buf", ",", "count", ")", ";", "return", "BZ2_bzwrite", "(", "self", "-", ">", "bz_file", ",", "(", "char", "*", ")", "buf", ",", "count", ")", ";", "}", "static", "int", "php_bz2iop_close", "(", "php_stream", "*", "stream", ",", "int", "close_handle", "TSRMLS_DC", ")", "{", "struct", "php_bz2_stream_data_t", "*", "self", "=", "(", "struct", "php_bz2_stream_data_t", "*", ")", "stream", "-", ">", "abstract", ";", "int", "ret", "=", "EOF", ";", "if", "(", "close_handle", ")", "{", "BZ2_bzclose", "(", "self", "-", ">", "bz_file", ")", ";", "}", "@", "@", "-", "191", ",", "11", "+", "195", ",", "11", "@", "@", "php_stream_ops", "php_stream_bz2io_ops", "=", "{", "}", ";", "/", "*", "{", "{{", "Bzip2", "stream", "openers", "*", "/", "PHP_BZ2_API", "php_stream", "*", "_php_stream_bz2open_from_BZFILE", "(", "BZFILE", "*", "bz", ",", "PHP_BZ2_API", "php_stream", "*", "_php_stream_bz2open_from_BZFILE", "(", "BZFILE", "*", "bz", ",", "char", "*", "mode", ",", "php_stream", "*", "innerstream", "STREAMS_DC", "TSRMLS_DC", ")", "{", "struct", "php_bz2_stream_data_t", "*", "self", ";", "self", "=", "emalloc", "(", "sizeof", "(", "*", "self", ")", ");", "self", "-", ">", "stream", "=", "innerstream", ";", "@", "@", "-", "226", ",", "15", "+", "230", ",", "15", "@", "@", "PHP_BZ2_API", "php_stream", "*", "_php_stream_bz2open", "(", "php_stream_wrapper", "*", "wrapper", ",", "virtual_filepath_ex", "(", "path", ",", "&", "path_copy", ",", "NULL", "TSRMLS_CC", ")", ";", "#", "else", "path_copy", "=", "path", ";", "#", "endif", "#", "endif", "if", "(", "php_check_open_basedir", "(", "path_copy", "TSRMLS_CC", ")", ")", "{", "#", "ifdef", "VIRTUAL_DIR", "free", "(", "path_copy", ")", ";", "#", "endif", "return", "NULL", ";", "}", "/", "*", "try", "and", "open", "it", "directly", "first", "*", "/", "bz_file", "=", "BZ2_bzopen", "(", "path_copy", ",", "mode", ")", ";", "@", "@", "-", "245", ",", "11", "+", "249", ",", "11", "@", "@", "PHP_BZ2_API", "php_stream", "*", "_php_stream_bz2open", "(", "php_stream_wrapper", "*", "wrapper", ",", "free", "(", "path_copy", ")", ";", "#", "endif", "path_copy", "=", "NULL", ";", "if", "(", "bz_file", "=", "=", "NULL", ")", "{", "/", "*", "that", "didn", "'", "t", "work", ",", "so", "try", "and", "get", "something", "from", "the", "network", "/", "wrapper", "*", "/", "stream", "=", "php_stream_open_wrapper", "(", "path", ",", "mode", ",", "options", "|", "STREAM_WILL_CAST", ",", "opened_path", ")", ";", "if", "(", "stream", ")", "{", "int", "fd", ";", "if", "(", "SUCCESS", "=", "=", "php_stream_cast", "(", "stream", ",", "PHP_STREAM_AS_FD", ",", "(", "void", "*", "*)", "&", "fd", ",", "REPORT_ERRORS", ")", ")", "{", "@", "@", "-", "264", ",", "7", "+", "268", ",", "7", "@", "@", "PHP_BZ2_API", "php_stream", "*", "_php_stream_bz2open", "(", "php_stream_wrapper", "*", "wrapper", ",", "VCWD_UNLINK", "(", "*", "opened_path", ")", ";", "}", "}", "if", "(", "bz_file", ")", "{", "retstream", "=", "_php_stream_bz2open_from_BZFILE", "(", "bz_file", ",", "mode", ",", "stream", "STREAMS_REL_CC", "TSRMLS_CC", ")", ";", "if", "(", "retstream", ")", "{", "@", "@", "-", "340", ",", "7", "+", "344", ",", "7", "@", "@", "static", "PHP_FUNCTION", "(", "bzread", ")", "if", "(", "FAILURE", "=", "=", "zend_parse_parameters", "(", "ZEND_NUM_ARGS", "(", ")", "TSRMLS_CC", ",", "\"", "r", "|", "l", "\"", ",", "&", "bz", ",", "&", "len", ")", ")", "{", "RETURN_FALSE", ";", "}", "php_stream_from_zval", "(", "stream", ",", "&", "bz", ")", ";", "if", "(", "(", "len", "+", "1", ")", "<", "1", ")", "{", "@", "@", "-", "350", ",", "13", "+", "354", ",", "13", "@", "@", "static", "PHP_FUNCTION", "(", "bzread", ")", "Z_STRVAL_P", "(", "return_value", ")", "=", "emalloc", "(", "len", "+", "1", ")", ";", "Z_STRLEN_P", "(", "return_value", ")", "=", "php_stream_read", "(", "stream", ",", "Z_STRVAL_P", "(", "return_value", ")", ",", "len", ")", ";", "if", "(", "Z_STRLEN_P", "(", "return_value", ")", "<", "0", ")", "{", "efree", "(", "Z_STRVAL_P", "(", "return_value", ")", ");", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "could", "not", "read", "valid", "bz2", "data", "from", "stream", "\"", ");", "RETURN_FALSE", ";", "RETURN_FALSE", ";", "}", "Z_STRVAL_P", "(", "return_value", ")", "[", "Z_STRLEN_P", "(", "return_value", ")", "]", "=", "0", ";", "Z_TYPE_P", "(", "return_value", ")", "=", "IS_STRING", ";", "}", "@", "@", "-", "372", ",", "7", "+", "376", ",", "7", "@", "@", "static", "PHP_FUNCTION", "(", "bzopen", ")", "BZFILE", "*", "bz", ";", "/", "*", "The", "compressed", "file", "stream", "*", "/", "php_stream", "*", "stream", "=", "NULL", ";", "if", "(", "zend_parse_parameters", "(", "ZEND_NUM_ARGS", "(", ")", "TSRMLS_CC", ",", "\"", "Zs", "\"", ",", "&", "file", ",", "&", "mode", ",", "&", "mode_len", ")", "=", "=", "FAILURE", ")", "{", "return", ";", "}", "@", "@", "-", "388", ",", "15", "+", "392", ",", "15", "@", "@", "static", "PHP_FUNCTION", "(", "bzopen", ")", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "filename", "cannot", "be", "empty", "\"", ");", "RETURN_FALSE", ";", "}", "if", "(", "CHECK_ZVAL_NULL_PATH", "(", "*", "file", ")", ")", "{", "RETURN_FALSE", ";", "}", "stream", "=", "php_stream_bz2open", "(", "NULL", ",", "Z_STRVAL_PP", "(", "file", ")", ",", "mode", ",", "REPORT_ERRORS", ",", "Z_STRVAL_PP", "(", "file", ")", ",", "mode", ",", "REPORT_ERRORS", ",", "NULL", ")", ";", "}", "else", "if", "(", "Z_TYPE_PP", "(", "file", ")", "=", "=", "IS_RESOURCE", ")", "{", "/", "*", "If", "it", "is", "a", "resource", ",", "than", "its", "a", "stream", "resource", "*", "/", "@", "@", "-", "405", ",", "7", "+", "409", ",", "7", "@", "@", "static", "PHP_FUNCTION", "(", "bzopen", ")", "php_stream_from_zval", "(", "stream", ",", "file", ")", ";", "stream_mode_len", "=", "strlen", "(", "stream", "-", ">", "mode", ")", ";", "if", "(", "stream_mode_len", "!", "=", "1", "&", "&", "!", "(", "stream_mode_len", "=", "=", "2", "&", "&", "memchr", "(", "stream", "-", ">", "mode", ",", "'", "b", "'", ",", "2", ")", "))", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "cannot", "use", "stream", "opened", "in", "mode", "'", "%", "s", "'", "\",", "stream", "-", ">", "mode", ")", ";", "RETURN_FALSE", ";", "@", "@", "-", "439", ",", "7", "+", "443", ",", "7", "@", "@", "static", "PHP_FUNCTION", "(", "bzopen", ")", "if", "(", "FAILURE", "=", "=", "php_stream_cast", "(", "stream", ",", "PHP_STREAM_AS_FD", ",", "(", "void", "*", ")", "&", "fd", ",", "REPORT_ERRORS", ")", ")", "{", "RETURN_FALSE", ";", "}", "bz", "=", "BZ2_bzdopen", "(", "fd", ",", "mode", ")", ";", "stream", "=", "php_stream_bz2open_from_BZFILE", "(", "bz", ",", "mode", ",", "stream", ")", ";", "@", "@", "-", "493", ",", "7", "+", "497", ",", "7", "@", "@", "static", "PHP_FUNCTION", "(", "bzcompress", ")", "work_factor", "=", "0", ",", "/", "*", "Work", "factor", "for", "compression", "algorithm", "*", "/", "argc", ";", "/", "*", "Argument", "count", "*", "/", "int", "source_len", ";", "/", "*", "Length", "of", "the", "source", "data", "*", "/", "unsigned", "int", "dest_len", ";", "/", "*", "Length", "of", "the", "destination", "buffer", "*", "/", "unsigned", "int", "dest_len", ";", "/", "*", "Length", "of", "the", "destination", "buffer", "*", "/", "argc", "=", "ZEND_NUM_ARGS", "(", ");", "@", "@", "-", "502", ",", "19", "+", "506", ",", "19", "@", "@", "static", "PHP_FUNCTION", "(", "bzcompress", ")", "}", "/", "*", "Assign", "them", "to", "easy", "to", "use", "variables", ",", "dest_len", "is", "initially", "the", "length", "of", "the", "data", "+", ".", "01", "x", "length", "of", "data", "+", "600", "which", "is", "the", "largest", "size", "the", "results", "of", "the", "compression", "could", "possibly", "be", ",", "at", "least", "that", "'", "s", "what", "the", "libbz2", "docs", "say", "(", "thanks", "to", "jeremy", "@", "nirvani", ".", "net", "+", ".", "01", "x", "length", "of", "data", "+", "600", "which", "is", "the", "largest", "size", "the", "results", "of", "the", "compression", "could", "possibly", "be", ",", "at", "least", "that", "'", "s", "what", "the", "libbz2", "docs", "say", "(", "thanks", "to", "jeremy", "@", "nirvani", ".", "net", "for", "pointing", "this", "out", ")", ".", "*", "/", "dest_len", "=", "(", "unsigned", "int", ")", "(", "source_len", "+", "(", "0", ".", "01", "*", "source_len", ")", "+", "600", ")", ";", "/", "*", "Allocate", "the", "destination", "buffer", "*", "/", "dest", "=", "emalloc", "(", "dest_len", "+", "1", ")", ";", "/", "*", "Handle", "the", "optional", "arguments", "*", "/", "if", "(", "argc", ">", "1", ")", "{", "block_size", "=", "zblock_size", ";", "}", "if", "(", "argc", ">", "2", ")", "{", "work_factor", "=", "zwork_factor", ";", "}", "@", "@", "-", "564", ",", "7", "+", "568", ",", "7", "@", "@", "static", "PHP_FUNCTION", "(", "bzdecompress", ")", "/", "*", "in", "most", "cases", "bz2", "offers", "at", "least", "2", ":", "1", "compression", ",", "so", "we", "use", "that", "as", "our", "base", "*", "/", "bzs", ".", "avail_out", "=", "source_len", "*", "2", ";", "bzs", ".", "next_out", "=", "dest", "=", "emalloc", "(", "bzs", ".", "avail_out", "+", "1", ")", ";", "while", "(", "(", "error", "=", "BZ2_bzDecompress", "(", "&", "bzs", ")", ")", "=", "=", "BZ_OK", "&", "&", "bzs", ".", "avail_in", ">", "0", ")", "{", "/", "*", "compression", "is", "better", "then", "2", ":", "1", ",", "need", "to", "allocate", "more", "memory", "*", "/", "bzs", ".", "avail_out", "=", "source_len", ";", "@", "@", "-", "590", ",", "13", "+", "594", ",", "13", "@", "@", "static", "PHP_FUNCTION", "(", "bzdecompress", ")", "/", "*", "{", "{{", "php_bz2_error", "(", ")", "The", "central", "error", "handling", "interface", ",", "does", "the", "work", "for", "bzerrno", ",", "bzerrstr", "and", "bzerror", "*", "/", "static", "void", "php_bz2_error", "(", "INTERNAL_FUNCTION_PARAMETERS", ",", "int", "opt", ")", "{", "{", "zval", "*", "bzp", ";", "/", "*", "BZip2", "Resource", "Pointer", "*", "/", "php_stream", "*", "stream", ";", "const", "char", "*", "errstr", ";", "/", "*", "Error", "string", "*", "/", "int", "errnum", ";", "/", "*", "Error", "number", "*", "/", "struct", "php_bz2_stream_data_t", "*", "self", ";", "if", "(", "zend_parse_parameters", "(", "ZEND_NUM_ARGS", "(", ")", "TSRMLS_CC", ",", "\"", "r", "\"", ",", "&", "bzp", ")", "=", "=", "FAILURE", ")", "{", "return", ";", "}", "@", "@", "-", "608", ",", "10", "+", "612", ",", "10", "@", "@", "static", "void", "php_bz2_error", "(", "INTERNAL_FUNCTION_PARAMETERS", ",", "int", "opt", ")", "}", "self", "=", "(", "struct", "php_bz2_stream_data_t", "*", ")", "stream", "-", ">", "abstract", ";", "/", "*", "Fetch", "the", "error", "information", "*", "/", "errstr", "=", "BZ2_bzerror", "(", "self", "-", ">", "bz_file", ",", "&", "errnum", ")", ";", "/", "*", "Determine", "what", "to", "return", "*", "/", "switch", "(", "opt", ")", "{", "case", "PHP_BZ_ERRNO", ":", "@", "@", "-", "622", ",", "7", "+", "626", ",", "7", "@", "@", "static", "void", "php_bz2_error", "(", "INTERNAL_FUNCTION_PARAMETERS", ",", "int", "opt", ")", "break", ";", "case", "PHP_BZ_ERRBOTH", ":", "array_init", "(", "return_value", ")", ";", "add_assoc_long", "(", "return_value", ",", "\"", "errno", "\"", ",", "errnum", ")", ";", "add_assoc_string", "(", "return_value", ",", "\"", "errstr", "\"", ",", "(", "char", "*", ")", "errstr", ",", "1", ")", ";", "break", ";", "@", "@", "-", "0", ",", "0", "+", "1", ",", "23", "@", "@", "-", "-", "TEST", "-", "-", "Bug", "#", "72613", "(", "Inadequate", "error", "handling", "in", "bzread", "(", "))", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "\"", "bz2", "\"", "))", "print", "\"", "skip", "\"", ";", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "fp", "=", "bzopen", "(", "__DIR__", ".", "'/", "72613", ".", "bz2", "'", ",", "'", "r", "'", ");", "if", "(", "$", "fp", "=", "==", "FALSE", ")", "{", "exit", "(", "\"", "ERROR", ":", "bzopen", "(", ")\"", ");", "}", "$", "data", "=", "\"", "\";", "while", "(", "!", "feof", "(", "$", "fp", ")", ")", "{", "$", "res", "=", "bzread", "(", "$", "fp", ")", ";", "if", "(", "$", "res", "=", "==", "FALSE", ")", "{", "exit", "(", "\"", "ERROR", ":", "bzread", "(", ")\"", ");", "}", "$", "data", ".", "=", "$", "res", ";", "}", "bzclose", "(", "$", "fp", ")", ";", "?", ">", "DONE", "-", "-", "EXPECT", "-", "-", "DONE", "\\", "No", "newline", "at", "end", "of", "file"], "docstring_tokens": ["does", "not", "perform", "adequate", "error", "handling"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "68", ",", "7", "+", "68", ",", "7", "@", "@", "Forward", "declarations", ".", "*", "/", "static", "MagickBooleanType", "WriteRGFImage", "(", "const", "ImageInfo", "*", ",", "Image", "*", ",", "ExceptionInfo", "*", ");", "WriteRGFImage", "(", "const", "ImageInfo", "*", ",", "Image", "*", ");", "/", "*", "%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "%%", "@", "@", "-", "305", ",", "7", "+", "305", ",", "7", "@", "@", "ModuleExport", "void", "UnregisterRGFImage", "(", "void", ")", "%", "The", "format", "of", "the", "WriteRGFImage", "method", "is", ":", "%", "%", "MagickBooleanType", "WriteRGFImage", "(", "const", "ImageInfo", "*", "image_info", ",", "%", "Image", "*", "image", ",", "ExceptionInfo", "*", "exception", ")", "%", "Image", "*", "image", ")", "%", "%", "A", "description", "of", "each", "parameter", "follows", ".", "%", "@", "@", "-", "316", ",", "8", "+", "316", ",", "7", "@", "@", "ModuleExport", "void", "UnregisterRGFImage", "(", "void", ")", "%", "o", "exception", ":", "return", "any", "errors", "or", "warnings", "in", "this", "structure", ".", "%", "*", "/", "static", "MagickBooleanType", "WriteRGFImage", "(", "const", "ImageInfo", "*", "image_info", ",", "Image", "*", "image", ",", "ExceptionInfo", "*", "exception", ")", "static", "MagickBooleanType", "WriteRGFImage", "(", "const", "ImageInfo", "*", "image_info", ",", "Image", "*", "image", ")", "{", "MagickBooleanType", "status", ";", "@", "@", "-", "346", ",", "9", "+", "345", ",", "7", "@", "@", "static", "MagickBooleanType", "WriteRGFImage", "(", "const", "ImageInfo", "*", "image_info", ",", "Image", "*", "image", ",", "assert", "(", "image", "-", ">", "signature", "=", "=", "MagickSignature", ")", ";", "if", "(", "image", "-", ">", "debug", "!", "=", "MagickFalse", ")", "(", "void", ")", "LogMagickEvent", "(", "TraceEvent", ",", "GetMagickModule", "(", "),", "\"%", "s", "\"", ",", "image", "-", ">", "filename", ")", ";", "assert", "(", "exception", "!", "=", "(", "ExceptionInfo", "*", ")", "NULL", ")", ";", "assert", "(", "exception", "-", ">", "signature", "=", "=", "MagickSignature", ")", ";", "status", "=", "OpenBlob", "(", "image_info", ",", "image", ",", "WriteBinaryBlobMode", ",", "exception", ")", ";", "status", "=", "OpenBlob", "(", "image_info", ",", "image", ",", "WriteBinaryBlobMode", ",", "&", "image", "-", ">", "exception", ")", ";", "if", "(", "status", "=", "=", "MagickFalse", ")", "return", "(", "status", ")", ";", "(", "void", ")", "TransformImageColorspace", "(", "image", ",", "sRGBColorspace", ")", ";", "@", "@", "-", "367", ",", "7", "+", "364", ",", "7", "@", "@", "static", "MagickBooleanType", "WriteRGFImage", "(", "const", "ImageInfo", "*", "image_info", ",", "Image", "*", "image", ",", "y", "=", "0", ";", "for", "(", "y", "=", "0", ";", "y", "<", "(", "ssize_t", ")", "image", "-", ">", "rows", ";", "y", "+", "+)", "{", "p", "=", "GetVirtualPixels", "(", "image", ",", "0", ",", "y", ",", "image", "-", ">", "columns", ",", "1", ",", "exception", ")", ";", "p", "=", "GetVirtualPixels", "(", "image", ",", "0", ",", "y", ",", "image", "-", ">", "columns", ",", "1", ",", "&", "image", "-", ">", "exception", ")", ";", "if", "(", "p", "=", "=", "(", "const", "PixelPacket", "*", ")", "NULL", ")", "break", ";", "bit", "=", "0", ";"], "docstring_tokens": ["not", "releasing", "memory"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "28", ",", "6", "+", "28", ",", "7", "@", "@", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "util", ".", "ClassLoaderUtil", ";", "import", "com", ".", "opensymphony", ".", "xwork2", ".", "util", ".", "ValueStack", ";", "import", "freemarker", ".", "cache", ".", "*;", "import", "freemarker", ".", "core", ".", "TemplateClassResolver", ";", "import", "freemarker", ".", "ext", ".", "jsp", ".", "TaglibFactory", ";", "import", "freemarker", ".", "ext", ".", "servlet", ".", "HttpRequestHashModel", ";", "import", "freemarker", ".", "ext", ".", "servlet", ".", "HttpRequestParametersHashModel", ";", "@", "@", "-", "318", ",", "16", "+", "319", ",", "23", "@", "@", "protected", "Configuration", "createConfiguration", "(", "ServletContext", "servletContext", ")", "throw", "configuration", ".", "setTemplateExceptionHandler", "(", "TemplateExceptionHandler", ".", "HTML_DEBUG_HANDLER", ")", ";", "if", "(", "mruMaxStrongSize", ">", "0", ")", "{", "LOG", ".", "debug", "(", "\"", "Sets", "Configuration", ".", "CACHE_STORAGE_KEY", "to", "strong", ":", "{}", "\",", "mruMaxStrongSize", ")", ";", "configuration", ".", "setSetting", "(", "Configuration", ".", "CACHE_STORAGE_KEY", ",", "\"", "strong", ":", "\"", "+", "mruMaxStrongSize", ")", ";", "}", "if", "(", "templateUpdateDelay", "!", "=", "null", ")", "{", "LOG", ".", "debug", "(", "\"", "Sets", "Configuration", ".", "TEMPLATE_UPDATE_DELAY_KEY", "to", "{", "}\"", ",", "templateUpdateDelay", ")", ";", "configuration", ".", "setSetting", "(", "Configuration", ".", "TEMPLATE_UPDATE_DELAY_KEY", ",", "templateUpdateDelay", ")", ";", "}", "if", "(", "encoding", "!", "=", "null", ")", "{", "LOG", ".", "debug", "(", "\"", "Sets", "DefaultEncoding", "to", "{", "}\"", ",", "encoding", ")", ";", "configuration", ".", "setDefaultEncoding", "(", "encoding", ")", ";", "}", "LOG", ".", "debug", "(", "\"", "Disabled", "localized", "lookups", "\"", ");", "configuration", ".", "setLocalizedLookup", "(", "false", ")", ";", "LOG", ".", "debug", "(", "\"", "Enabled", "whitespace", "stripping", "\"", ");", "configuration", ".", "setWhitespaceStripping", "(", "true", ")", ";", "LOG", ".", "debug", "(", "\"", "Sets", "NewBuiltinClassResolver", "to", "TemplateClassResolver", ".", "SAFER_RESOLVER", "\"", ");", "configuration", ".", "setNewBuiltinClassResolver", "(", "TemplateClassResolver", ".", "SAFER_RESOLVER", ")", ";", "return", "configuration", ";", "}"], "docstring_tokens": ["the", "use", "of", "an", "unintentional", "expression", "in", "Freemarker", "tag", "instead", "of", "string", "literals"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "158", ",", "7", "+", "158", ",", "7", "@", "@", "int", "ASN1_item_verify", "(", "const", "ASN1_ITEM", "*", "it", ",", "X509_ALGOR", "*", "a", ",", "if", "(", "signature", "-", ">", "type", "=", "=", "V_ASN1_BIT_STRING", "&", "&", "signature", "-", ">", "flags", "&", "0x7", ")", "{", "ASN1err", "(", "ASN1_F_ASN1_VERIFY", ",", "ASN1_R_INVALID_BIT_STRING_BITS_LEFT", ")", ";", "ASN1err", "(", "ASN1_F_ASN1_ITEM_VERIFY", ",", "ASN1_R_INVALID_BIT_STRING_BITS_LEFT", ")", ";", "return", "-", "1", ";", "}"], "docstring_tokens": ["the", "modification", "of", "the", "fingerprint", "without", "breaking", "the", "signature"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "568", ",", "8", "+", "568", ",", "8", "@", "@", "cond_branch", ":", "f_offset", "=", "addrs", "[", "i", "+", "filter", "[", "i", "]", ".", "jf", "]", "-", "addrs", "[", "i", "]", ";", "break", ";", "}", "if", "(", "filter", "[", "i", "]", ".", "jt", "!", "=", "0", ")", "{", "if", "(", "filter", "[", "i", "]", ".", "jf", ")", "t_offset", "+", "=", "is_near", "(", "f_offset", ")", "?", "2", ":", "6", ";", "if", "(", "filter", "[", "i", "]", ".", "jf", "&", "&", "f_offset", ")", "t_offset", "+", "=", "is_near", "(", "f_offset", ")", "?", "2", ":", "5", ";", "EMIT_COND_JMP", "(", "t_op", ",", "t_offset", ")", ";", "if", "(", "filter", "[", "i", "]", ".", "jf", ")", "EMIT_JMP", "(", "f_offset", ")", ";"], "docstring_tokens": ["a", "conditional", "jump", "is", "followed", "by", "a", "long", "jump"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "39", ",", "6", "+", "39", ",", "7", "@", "@", "import", "jenkins", ".", "model", ".", "GlobalConfiguration", ";", "import", "jenkins", ".", "model", ".", "GlobalConfigurationCategory", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "jenkins", ".", "security", ".", "RedactSecretJsonInErrorMessageSanitizer", ";", "import", "jenkins", ".", "util", ".", "io", ".", "OnMaster", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONArray", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONObject", ";", "@", "@", "-", "597", ",", "7", "+", "598", ",", "7", "@", "@", "public", "T", "newInstance", "(", "@", "Nullable", "StaplerRequest", "req", ",", "@", "Nonnull", "JSONObject", "formData", ")", "}", "catch", "(", "NoSuchMethodException", "e", ")", "{", "throw", "new", "AssertionError", "(", "e", ")", ";", "/", "/", "impossible", "}", "catch", "(", "InstantiationException", "|", "IllegalAccessException", "|", "RuntimeException", "e", ")", "{", "throw", "new", "Error", "(", "\"", "Failed", "to", "instantiate", "\"", "+", "clazz", "+", "\"", "from", "\"", "+", "formData", ",", "e", ")", ";", "throw", "new", "Error", "(", "\"", "Failed", "to", "instantiate", "\"", "+", "clazz", "+", "\"", "from", "\"", "+", "RedactSecretJsonInErrorMessageSanitizer", ".", "INSTANCE", ".", "sanitize", "(", "formData", ")", ",", "e", ")", ";", "}", "}", "@", "@", "-", "37", ",", "6", "+", "37", ",", "7", "@", "@", "import", "hudson", ".", "Launcher", ".", "LocalLauncher", ";", "import", "jenkins", ".", "AgentProtocol", ";", "import", "jenkins", ".", "diagnostics", ".", "URICheckEncodingMonitor", ";", "import", "jenkins", ".", "security", ".", "RedactSecretJsonInErrorMessageSanitizer", ";", "import", "jenkins", ".", "util", ".", "SystemProperties", ";", "import", "hudson", ".", "cli", ".", "declarative", ".", "CLIMethod", ";", "import", "hudson", ".", "cli", ".", "declarative", ".", "CLIResolver", ";", "@", "@", "-", "898", ",", "9", "+", "899", ",", "11", "@", "@", "protected", "Jenkins", "(", "File", "root", ",", "ServletContext", "context", ",", "PluginManager", "pluginManager", "if", "(", "pluginManager", "=", "=", "null", ")", "pluginManager", "=", "PluginManager", ".", "createDefault", "(", "this", ")", ";", "this", ".", "pluginManager", "=", "pluginManager", ";", "WebApp", "webApp", "=", "WebApp", ".", "get", "(", "servletContext", ")", ";", "/", "/", "JSON", "binding", "needs", "to", "be", "able", "to", "see", "all", "the", "classes", "from", "all", "the", "plugins", "WebApp", ".", "get", "(", "servletContext", ")", ".", "setClassLoader", "(", "pluginManager", ".", "uberClassLoader", ")", ";", "webApp", ".", "setClassLoader", "(", "pluginManager", ".", "uberClassLoader", ")", ";", "webApp", ".", "setJsonInErrorMessageSanitizer", "(", "RedactSecretJsonInErrorMessageSanitizer", ".", "INSTANCE", ")", ";", "adjuncts", "=", "new", "AdjunctManager", "(", "servletContext", ",", "pluginManager", ".", "uberClassLoader", ",", "\"", "adjuncts", "/", "\"+", "SESSION_HASH", ",", "TimeUnit2", ".", "DAYS", ".", "toMillis", "(", "365", ")", ");", "/", "/", "TODO", "pending", "move", "to", "standard", "blacklist", ",", "or", "API", "to", "append", "filter", "@", "@", "-", "0", ",", "0", "+", "1", ",", "118", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2018", ",", "CloudBees", ",", "Inc", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "jenkins", ".", "security", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONArray", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONObject", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "Restricted", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "restrictions", ".", "NoExternalUse", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "JsonInErrorMessageSanitizer", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "logging", ".", "Level", ";", "import", "java", ".", "util", ".", "logging", ".", "Logger", ";", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "public", "class", "RedactSecretJsonInErrorMessageSanitizer", "implements", "JsonInErrorMessageSanitizer", "{", "private", "static", "final", "Logger", "LOGGER", "=", "Logger", ".", "getLogger", "(", "RedactSecretJsonInErrorMessageSanitizer", ".", "class", ".", "getName", "(", "))", ";", "/", "/", "must", "be", "kept", "in", "sync", "with", "hudson", "-", "behavior", ".", "js", "in", "function", "buildFormTree", ",", "password", "case", "public", "static", "final", "String", "REDACT_KEY", "=", "\"", "$", "redact", "\"", ";", "public", "static", "final", "String", "REDACT_VALUE", "=", "\"", "[", "value", "redacted", "]", "\";", "public", "static", "final", "RedactSecretJsonInErrorMessageSanitizer", "INSTANCE", "=", "new", "RedactSecretJsonInErrorMessageSanitizer", "(", ");", "private", "RedactSecretJsonInErrorMessageSanitizer", "(", ")", "{", "}", "@", "Override", "public", "JSONObject", "sanitize", "(", "JSONObject", "jsonObject", ")", "{", "return", "copyAndSanitizeObject", "(", "jsonObject", ")", ";", "}", "/", "**", "*", "Accept", "anything", "as", "value", "for", "the", "{", "@", "link", "#", "REDACT_KEY", "}", "but", "only", "process", "the", "first", "level", "of", "an", "array", "and", "the", "string", "value", ".", "*", "/", "private", "Set", "<", "String", ">", "retrieveRedactedKeys", "(", "JSONObject", "jsonObject", ")", "{", "Set", "<", "String", ">", "redactedKeySet", "=", "new", "HashSet", "<", ">(", ");", "if", "(", "jsonObject", ".", "has", "(", "REDACT_KEY", ")", ")", "{", "Object", "value", "=", "jsonObject", ".", "get", "(", "REDACT_KEY", ")", ";", "if", "(", "value", "instanceof", "JSONArray", ")", "{", "for", "(", "Object", "o", ":", "jsonObject", ".", "getJSONArray", "(", "REDACT_KEY", ")", ")", "{", "if", "(", "o", "instanceof", "String", ")", "{", "redactedKeySet", ".", "add", "(", "(", "String", ")", "o", ")", ";", "}", "else", "{", "/", "/", "array", ",", "object", ",", "null", ",", "number", ",", "boolean", "LOGGER", ".", "log", "(", "Level", ".", "WARNING", ",", "\"", "Unsupported", "type", "\"", "+", "o", ".", "getClass", "(", ").", "getName", "(", ")", "+", "\"", "for", "\"", "+", "REDACT_KEY", "+", "\"", ",", "please", "use", "either", "a", "single", "String", "value", "or", "an", "Array", "\"", ");", "}", "}", "}", "else", "if", "(", "value", "instanceof", "String", ")", "{", "redactedKeySet", ".", "add", "(", "(", "String", ")", "value", ")", ";", "}", "else", "{", "/", "/", "object", ",", "null", ",", "number", ",", "boolean", "LOGGER", ".", "log", "(", "Level", ".", "WARNING", ",", "\"", "Unsupported", "type", "\"", "+", "value", ".", "getClass", "(", ").", "getName", "(", ")", "+", "\"", "for", "\"", "+", "REDACT_KEY", "+", "\"", ",", "please", "use", "either", "a", "single", "String", "value", "or", "an", "Array", "\"", ");", "}", "}", "return", "redactedKeySet", ";", "}", "private", "Object", "copyAndSanitize", "(", "Object", "value", ")", "{", "if", "(", "value", "instanceof", "JSONObject", ")", "{", "return", "copyAndSanitizeObject", "(", "(", "JSONObject", ")", "value", ")", ";", "}", "else", "if", "(", "value", "instanceof", "JSONArray", ")", "{", "return", "copyAndSanitizeArray", "(", "(", "JSONArray", ")", "value", ")", ";", "}", "else", "{", "/", "/", "string", ",", "null", ",", "number", ",", "boolean", "return", "value", ";", "}", "}", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "private", "JSONObject", "copyAndSanitizeObject", "(", "JSONObject", "jsonObject", ")", "{", "Set", "<", "String", ">", "redactedKeySet", "=", "retrieveRedactedKeys", "(", "jsonObject", ")", ";", "JSONObject", "result", "=", "new", "JSONObject", "(", ");", "jsonObject", ".", "keySet", "(", ").", "forEach", "(", "keyObject", "-", ">", "{", "String", "key", "=", "keyObject", ".", "toString", "(", ");", "if", "(", "redactedKeySet", ".", "contains", "(", "key", ")", ")", "{", "result", ".", "accumulate", "(", "key", ",", "REDACT_VALUE", ")", ";", "}", "else", "{", "Object", "value", "=", "jsonObject", ".", "get", "(", "keyObject", ")", ";", "result", ".", "accumulate", "(", "key", ",", "copyAndSanitize", "(", "value", ")", ");", "}", "}", ");", "return", "result", ";", "}", "private", "JSONArray", "copyAndSanitizeArray", "(", "JSONArray", "jsonArray", ")", "{", "JSONArray", "result", "=", "new", "JSONArray", "(", ");", "jsonArray", ".", "forEach", "(", "value", "-", ">", "result", ".", "add", "(", "copyAndSanitize", "(", "value", ")", ")", ")", ";", "return", "result", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "139", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2018", ",", "CloudBees", ",", "Inc", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "jenkins", ".", "security", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONObject", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "Issue", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotSame", ";", "@", "Issue", "(", "\"", "SECURITY", "-", "765", "\"", ")", "public", "class", "RedactSecretJsonInErrorMessageSanitizerTest", "{", "@", "Test", "public", "void", "noSecrets", "(", ")", "throws", "Exception", "{", "assertRedaction", "(", "\"", "{'", "a", "'", ":", "1", ",", "'", "b", "'", ":", "'", "2", "'", ",", "'", "c", "'", ":", "{", "'", "c1", "'", ":", "1", ",", "'", "c2", "'", ":", "'", "2", "'", ",", "'", "c3", "'", ":", "[", "'", "3a", "'", ",", "'", "3b", "'", "]}", ",", "'", "d", "'", ":", "[", "'", "4a", "'", ",", "{", "'", "d1", "'", ":", "1", ",", "'", "d2", "'", ":", "'", "2", "'", "}]", "}\"", ",", "\"", "{'", "a", "'", ":", "1", ",", "'", "b", "'", ":", "'", "2", "'", ",", "'", "c", "'", ":", "{", "'", "c1", "'", ":", "1", ",", "'", "c2", "'", ":", "'", "2", "'", ",", "'", "c3", "'", ":", "[", "'", "3a", "'", ",", "'", "3b", "'", "]}", ",", "'", "d", "'", ":", "[", "'", "4a", "'", ",", "{", "'", "d1", "'", ":", "1", ",", "'", "d2", "'", ":", "'", "2", "'", "}]", "}\"", ")", ";", "}", "@", "Test", "public", "void", "simpleWithSecret", "(", ")", "throws", "Exception", "{", "assertRedaction", "(", "\"", "{'", "a", "'", ":", "'", "secret", "'", ",", "'", "b", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "'", "a", "'", "}\"", ",", "\"", "{'", "a", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "b", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "'", "a", "'", "}\"", ")", ";", "}", "@", "Test", "public", "void", "singleWithRedactedInArray", "(", ")", "throws", "Exception", "{", "assertRedaction", "(", "\"", "{'", "a", "'", ":", "'", "secret", "'", ",", "'", "b", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "[", "'", "a", "'", "]}", "\",", "\"", "{'", "a", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "b", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "[", "'", "a", "'", "]}", "\"", ")", ";", "}", "@", "Test", "public", "void", "objectRedactedAcceptedButNotProcessed", "(", ")", "throws", "Exception", "{", "assertRedaction", "(", "\"", "{'", "a", "'", ":", "'", "secret", "'", ",", "'", "b", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "{", "'", "a", "'", ":", "'", "a", "'", "}}", "\",", "\"", "{'", "a", "'", ":", "'", "secret", "'", ",", "'", "b", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "{", "'", "a", "'", ":", "'", "a", "'", "}}", "\"", ")", ";", "}", "@", "Test", "public", "void", "weirdValuesInRedactedAcceptedButNotProcessed", "(", ")", "throws", "Exception", "{", "assertRedaction", "(", "\"", "{'", "a", "'", ":", "'", "secret", "'", ",", "'", "b", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "[", "null", ",", "true", ",", "false", ",", "1", ",", "2", ",", "'", "a", "'", "]}", "\",", "\"", "{'", "a", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "b", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "[", "null", ",", "true", ",", "false", ",", "1", ",", "2", ",", "'", "a", "'", "]}", "\"", ")", ";", "}", "@", "Test", "public", "void", "ensureTrueAndOneAsStringAreSupportedAsRedactedKey", "(", ")", "throws", "Exception", "{", "/", "/", "only", "null", "is", "not", "supported", ",", "as", "passing", "'", "null", "'", "is", "considered", "as", "null", "assertRedaction", "(", "\"", "{'", "true", "'", ":", "'", "secret1", "'", ",", "'", "1", "'", ":", "'", "secret3", "'", ",", "'", "b", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "[", "'", "true", "'", ",", "'", "1", "'", "]}", "\",", "\"", "{'", "true", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "1", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "b", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "[", "'", "true", "'", ",", "'", "1", "'", "]}", "\"", ")", ";", "}", "@", "Test", "public", "void", "redactFullBranch", "(", ")", "throws", "Exception", "{", "assertRedaction", "(", "\"", "{'", "a", "'", ":", "{", "'", "s1", "'", ":", "'", "secret1", "'", ",", "'", "s2", "'", ":", "'", "secret2", "'", ",", "'", "s3", "'", ":", "[", "1", ",", "2", ",", "3", "]", "},", "'", "b", "'", ":", "[", "4", ",", "5", ",", "6", "]", ",", "'", "c", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "[", "'", "a", "'", ",", "'", "b", "'", "]}", "\",", "\"", "{'", "a", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "b", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "c", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "[", "'", "a", "'", ",", "'", "b", "'", "]}", "\"", ")", ";", "}", "@", "Test", "public", "void", "multipleSecretAtSameLevel", "(", ")", "throws", "Exception", "{", "assertRedaction", "(", "\"", "{'", "a1", "'", ":", "'", "secret1", "'", ",", "'", "a2", "'", ":", "'", "secret2", "'", ",", "'", "b", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "[", "'", "a1", "'", ",", "'", "a2", "'", "]}", "\",", "\"", "{'", "a1", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "a2", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "b", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "[", "'", "a1", "'", ",", "'", "a2", "'", "]}", "\"", ")", ";", "}", "@", "Test", "public", "void", "redactedKeyWithoutCorrespondences", "(", ")", "throws", "Exception", "{", "assertRedaction", "(", "\"", "{'", "a1", "'", ":", "'", "secret1", "'", ",", "'", "a2", "'", ":", "'", "secret2", "'", ",", "'", "b", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "[", "'", "a0", "'", ",", "'", "a1", "'", ",", "'", "a2", "'", ",", "'", "a3", "'", "]}", "\",", "\"", "{'", "a1", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "a2", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "b", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "[", "'", "a0", "'", ",", "'", "a1", "'", ",", "'", "a2", "'", ",", "'", "a3", "'", "]}", "\"", ")", ";", "}", "@", "Test", "public", "void", "secretsAtMultipleLevels", "(", ")", "throws", "Exception", "{", "assertRedaction", "(", "\"", "{'", "a1", "'", ":", "'", "secret1", "'", ",", "'", "a2", "'", ":", "'", "secret2", "'", ",", "'", "b", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "[", "'", "a1", "'", ",", "'", "a2", "'", "],", "'", "sub", "'", ":", "{", "'", "c1", "'", ":", "'", "secret1", "'", ",", "'", "c2", "'", ":", "'", "secret2", "'", ",", "'", "c3", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "[", "'", "c1", "'", ",", "'", "c2", "'", "]}", "}\"", ",", "\"", "{'", "a1", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "a2", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "b", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "[", "'", "a1", "'", ",", "'", "a2", "'", "],", "'", "sub", "'", ":", "{", "'", "c1", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "c2", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "c3", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "[", "'", "c1", "'", ",", "'", "c2", "'", "]}", "}\"", ")", ";", "}", "@", "Test", "public", "void", "noInteractionBetweenLevels", "(", ")", "throws", "Exception", "{", "assertRedaction", "(", "\"", "{'", "a", "'", ":", "'", "secret", "'", ",", "'", "b", "'", ":", "'", "other", "'", ",", "'", "c", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "'", "a", "'", ",", "'", "sub", "'", ":", "{", "'", "a", "'", ":", "'", "other", "'", ",", "'", "b", "'", ":", "'", "secret", "'", ",", "'", "c", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "'", "b", "'", "}}", "\",", "\"", "{'", "a", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "b", "'", ":", "'", "other", "'", ",", "'", "c", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "'", "a", "'", ",", "'", "sub", "'", ":", "{", "'", "a", "'", ":", "'", "other", "'", ",", "'", "b", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "c", "'", ":", "'", "other", "'", ",", "'", "$", "redact", "'", ":", "'", "b", "'", "}}", "\"", ")", ";", "}", "@", "Test", "public", "void", "deeplyNestedObject", "(", ")", "throws", "Exception", "{", "assertRedaction", "(", "\"", "{'", "sub", "'", ":", "{", "'", "arr", "'", ":", "[", "'", "d1", "'", ",", "2", ",", "{", "'", "a1", "'", ":", "'", "other", "'", ",", "'", "b1", "'", ":'", "other", "'", ",", "'", "c1", "'", ":", "'", "secret", "'", ",", "'", "$", "redact", "'", ":", "'", "c1", "'", "},", "4", ",", "{", "'", "a2", "'", ":", "'", "other", "'", ",", "'", "b2", "'", ":", "'", "other", "'", ",", "'", "c2", "'", ":", "'", "secret", "'", ",", "'", "$", "redact", "'", ":", "'", "c2", "'", "}]", "},", "'", "$", "redact", "'", ":", "'", "b", "'", "}\"", ",", "\"", "{'", "sub", "'", ":", "{", "'", "arr", "'", ":", "[", "'", "d1", "'", ",", "2", ",", "{", "'", "a1", "'", ":", "'", "other", "'", ",", "'", "b1", "'", ":'", "other", "'", ",", "'", "c1", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "$", "redact", "'", ":", "'", "c1", "'", "},", "4", ",", "{", "'", "a2", "'", ":", "'", "other", "'", ",", "'", "b2", "'", ":", "'", "other", "'", ",", "'", "c2", "'", ":", "'", "[", "value", "redacted", "]", "',", "'", "$", "redact", "'", ":", "'", "c2", "'", "}]", "},", "'", "$", "redact", "'", ":", "'", "b", "'", "}\"", ")", ";", "}", "private", "void", "assertRedaction", "(", "String", "from", ",", "String", "to", ")", "{", "JSONObject", "input", "=", "JSONObject", ".", "fromObject", "(", "from", ".", "replace", "(", "'\\", "''", ",", "'", "\"'", "))", ";", "JSONObject", "output", "=", "RedactSecretJsonInErrorMessageSanitizer", ".", "INSTANCE", ".", "sanitize", "(", "input", ")", ";", "assertNotSame", "(", "output", ",", "input", ")", ";", "assertEquals", "(", "\"", "redaction", "of", "\"", "+", "from", ",", "to", ".", "replace", "(", "'\\", "''", ",", "'", "\"'", ").", "replace", "(", "\"", "\"", ",", "\"", "\")", ",", "output", ".", "toString", "(", ").", "replace", "(", "\"", "\"", ",", "\"", "\")", ");", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "298", "@", "@", "/", "*", "*", "The", "MIT", "License", "*", "*", "Copyright", "(", "c", ")", "2018", "CloudBees", ",", "Inc", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "*", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "*", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "*", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "*", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "*", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "*", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "*", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "*", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "*", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "*", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "*", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "*", "THE", "SOFTWARE", ".", "*", "/", "package", "jenkins", ".", "security", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "Page", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "html", ".", "HtmlForm", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "html", ".", "HtmlInput", ";", "import", "com", ".", "gargoylesoftware", ".", "htmlunit", ".", "html", ".", "HtmlPage", ";", "import", "hudson", ".", "model", ".", "Describable", ";", "import", "hudson", ".", "model", ".", "Descriptor", ";", "import", "hudson", ".", "model", ".", "RootAction", ";", "import", "hudson", ".", "util", ".", "Secret", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "net", ".", "sf", ".", "json", ".", "JSONObject", ";", "import", "org", ".", "junit", ".", "Rule", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "Issue", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "JenkinsRule", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "LoggerRule", ";", "import", "org", ".", "jvnet", ".", "hudson", ".", "test", ".", "TestExtension", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "Restricted", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "restrictions", ".", "NoExternalUse", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "DataBoundConstructor", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerRequest", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "StaplerResponse", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "interceptor", ".", "RequirePOST", ";", "import", "java", ".", "io", ".", "PrintWriter", ";", "import", "java", ".", "io", ".", "StringWriter", ";", "import", "java", ".", "util", ".", "logging", ".", "Level", ";", "import", "static", "org", ".", "hamcrest", ".", "CoreMatchers", ".", "allOf", ";", "import", "static", "org", ".", "hamcrest", ".", "CoreMatchers", ".", "containsString", ";", "import", "static", "org", ".", "hamcrest", ".", "CoreMatchers", ".", "equalTo", ";", "import", "static", "org", ".", "hamcrest", ".", "CoreMatchers", ".", "hasItem", ";", "import", "static", "org", ".", "hamcrest", ".", "CoreMatchers", ".", "not", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertThat", ";", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "public", "class", "RedactSecretJsonInErrorMessageSanitizerHtmlTest", "{", "@", "Rule", "public", "JenkinsRule", "j", "=", "new", "JenkinsRule", "(", ");", "@", "Rule", "public", "LoggerRule", "logging", "=", "new", "LoggerRule", "(", ");", "@", "Test", "@", "Issue", "(", "\"", "SECURITY", "-", "765", "\"", ")", "public", "void", "passwordsAreRedacted_andOtherStayTheSame", "(", ")", "throws", "Exception", "{", "j", ".", "jenkins", ".", "setCrumbIssuer", "(", "null", ")", ";", "TestPassword", "testPassword", "=", "j", ".", "jenkins", ".", "getExtensionList", "(", "RootAction", ".", "class", ")", ".", "get", "(", "TestPassword", ".", "class", ")", ";", "JenkinsRule", ".", "WebClient", "wc", "=", "j", ".", "createWebClient", "(", ");", "HtmlPage", "page", "=", "wc", ".", "goTo", "(", "\"", "test", "\"", ");", "String", "textSimple", "=", "\"", "plain", "-", "1", "\"", ";", "String", "pwdSimple", "=", "\"", "secret", "-", "1", "\"", ";", "(", "(", "HtmlInput", ")", "page", ".", "getElementById", "(", "\"", "text", "-", "simple", "\"", "))", ".", "setValueAttribute", "(", "textSimple", ")", ";", "(", "(", "HtmlInput", ")", "page", ".", "getElementById", "(", "\"", "pwd", "-", "simple", "\"", "))", ".", "setValueAttribute", "(", "pwdSimple", ")", ";", "String", "textLevelOne", "=", "\"", "plain", "-", "2", "\"", ";", "String", "pwdLevelOneA", "=", "\"", "secret", "-", "2", "\"", ";", "String", "pwdLevelOneB", "=", "\"", "secret", "-", "3", "\"", ";", "(", "(", "HtmlInput", ")", "page", ".", "getElementById", "(", "\"", "text", "-", "level", "-", "one", "\"", "))", ".", "setValueAttribute", "(", "textLevelOne", ")", ";", "(", "(", "HtmlInput", ")", "page", ".", "getElementById", "(", "\"", "pwd", "-", "level", "-", "one", "-", "a", "\"", "))", ".", "setValueAttribute", "(", "pwdLevelOneA", ")", ";", "(", "(", "HtmlInput", ")", "page", ".", "getElementById", "(", "\"", "pwd", "-", "level", "-", "one", "-", "b", "\"", "))", ".", "setValueAttribute", "(", "pwdLevelOneB", ")", ";", "HtmlForm", "form", "=", "page", ".", "getFormByName", "(", "\"", "config", "\"", ");", "Page", "formSubmitPage", "=", "j", ".", "submit", "(", "form", ")", ";", "assertThat", "(", "formSubmitPage", ".", "getWebResponse", "(", ").", "getStatusCode", "(", "),", "equalTo", "(", "200", ")", ");", "JSONObject", "rawJson", "=", "testPassword", ".", "lastJsonReceived", ";", "String", "rawJsonToString", "=", "rawJson", ".", "toString", "(", ");", "assertThat", "(", "rawJsonToString", ",", "containsString", "(", "textSimple", ")", ");", "assertThat", "(", "rawJsonToString", ",", "containsString", "(", "pwdSimple", ")", ");", "assertThat", "(", "rawJsonToString", ",", "containsString", "(", "textLevelOne", ")", ");", "assertThat", "(", "rawJsonToString", ",", "containsString", "(", "pwdLevelOneA", ")", ");", "assertThat", "(", "rawJson", ".", "getString", "(", "RedactSecretJsonInErrorMessageSanitizer", ".", "REDACT_KEY", ")", ",", "equalTo", "(", "\"", "pwd", "-", "simple", "\"", "))", ";", "assertThat", "(", "rawJson", ".", "getJSONObject", "(", "\"", "sub", "-", "one", "\"", ").", "getJSONArray", "(", "RedactSecretJsonInErrorMessageSanitizer", ".", "REDACT_KEY", ")", ",", "allOf", "(", "hasItem", "(", "\"", "pwd", "-", "level", "-", "one", "-", "a", "\"", "),", "hasItem", "(", "\"", "pwd", "-", "level", "-", "one", "-", "b", "\"", ")", ")", ")", ";", "JSONObject", "redactedJson", "=", "RedactSecretJsonInErrorMessageSanitizer", ".", "INSTANCE", ".", "sanitize", "(", "rawJson", ")", ";", "String", "redactedJsonToString", "=", "redactedJson", ".", "toString", "(", ");", "assertThat", "(", "redactedJsonToString", ",", "containsString", "(", "textSimple", ")", ");", "assertThat", "(", "redactedJsonToString", ",", "not", "(", "containsString", "(", "pwdSimple", ")", "))", ";", "assertThat", "(", "redactedJsonToString", ",", "containsString", "(", "textLevelOne", ")", ");", "assertThat", "(", "redactedJsonToString", ",", "not", "(", "containsString", "(", "pwdLevelOneA", ")", "))", ";", "assertThat", "(", "redactedJsonToString", ",", "not", "(", "containsString", "(", "pwdLevelOneB", ")", "))", ";", "assertThat", "(", "redactedJsonToString", ",", "containsString", "(", "RedactSecretJsonInErrorMessageSanitizer", ".", "REDACT_VALUE", ")", ");", "}", "@", "TestExtension", "(", "\"", "passwordsAreRedacted_andOtherStayTheSame", "\"", ")", "public", "static", "class", "TestPassword", "implements", "RootAction", "{", "public", "JSONObject", "lastJsonReceived", ";", "public", "void", "doSubmitTest", "(", "StaplerRequest", "req", ",", "StaplerResponse", "res", ")", "throws", "Exception", "{", "lastJsonReceived", "=", "req", ".", "getSubmittedForm", "(", ");", "res", ".", "setStatus", "(", "200", ")", ";", "}", "@", "Override", "public", "String", "getIconFileName", "(", ")", "{", "return", "null", ";", "}", "@", "Override", "public", "String", "getDisplayName", "(", ")", "{", "return", "null", ";", "}", "@", "Override", "public", "String", "getUrlName", "(", ")", "{", "return", "\"", "test", "\"", ";", "}", "}", "@", "Test", "@", "Issue", "(", "\"", "SECURITY", "-", "765", "\"", ")", "public", "void", "checkSanitizationIsApplied_inDescriptor", "(", ")", "throws", "Exception", "{", "logging", ".", "record", "(", "\"/", "jenkins", "\"", ",", "Level", ".", "ALL", ")", ".", "capture", "(", "1", ")", ";", "j", ".", "jenkins", ".", "setCrumbIssuer", "(", "null", ")", ";", "JenkinsRule", ".", "WebClient", "wc", "=", "j", ".", "createWebClient", "(", ");", "wc", ".", "getOptions", "(", ").", "setThrowExceptionOnFailingStatusCode", "(", "false", ")", ";", "HtmlPage", "page", "=", "wc", ".", "goTo", "(", "\"", "testDescribable", "\"", ");", "String", "secret", "=", "\"", "s3cr3t", "\"", ";", "(", "(", "HtmlInput", ")", "page", ".", "getElementById", "(", "\"", "password", "\"", "))", ".", "setValueAttribute", "(", "secret", ")", ";", "HtmlForm", "form", "=", "page", ".", "getFormByName", "(", "\"", "config", "\"", ");", "Page", "formSubmitPage", "=", "j", ".", "submit", "(", "form", ")", ";", "assertThat", "(", "formSubmitPage", ".", "getWebResponse", "(", ").", "getContentAsString", "(", "),", "allOf", "(", "containsString", "(", "RedactSecretJsonInErrorMessageSanitizer", ".", "REDACT_VALUE", ")", ",", "not", "(", "containsString", "(", "secret", ")", ")", ")", ");", "/", "/", "check", "the", "system", "log", "also", "Throwable", "thrown", "=", "logging", ".", "getRecords", "(", ").", "get", "(", "0", ")", ".", "getThrown", "(", ");", "/", "/", "the", "exception", "from", "Descriptor", "assertThat", "(", "thrown", ".", "getCause", "(", ").", "getMessage", "(", "),", "allOf", "(", "containsString", "(", "RedactSecretJsonInErrorMessageSanitizer", ".", "REDACT_VALUE", ")", ",", "not", "(", "containsString", "(", "secret", ")", ")", ")", ");", "/", "/", "the", "exception", "from", "RequestImpl", "assertThat", "(", "thrown", ".", "getCause", "(", ").", "getCause", "(", ").", "getMessage", "(", "),", "allOf", "(", "containsString", "(", "RedactSecretJsonInErrorMessageSanitizer", ".", "REDACT_VALUE", ")", ",", "not", "(", "containsString", "(", "secret", ")", ")", ")", ");", "StringWriter", "buffer", "=", "new", "StringWriter", "(", ");", "thrown", ".", "printStackTrace", "(", "new", "PrintWriter", "(", "buffer", ")", ");", "String", "fullStack", "=", "buffer", ".", "getBuffer", "(", ").", "toString", "(", ");", "assertThat", "(", "fullStack", ",", "allOf", "(", "containsString", "(", "RedactSecretJsonInErrorMessageSanitizer", ".", "REDACT_VALUE", ")", ",", "not", "(", "containsString", "(", "secret", ")", ")", ")", ");", "}", "@", "Test", "@", "Issue", "(", "\"", "SECURITY", "-", "765", "\"", ")", "public", "void", "checkSanitizationIsApplied_inStapler", "(", ")", "throws", "Exception", "{", "logging", ".", "record", "(", "\"/", "jenkins", "\"", ",", "Level", ".", "ALL", ")", ".", "capture", "(", "1", ")", ";", "j", ".", "jenkins", ".", "setCrumbIssuer", "(", "null", ")", ";", "JenkinsRule", ".", "WebClient", "wc", "=", "j", ".", "createWebClient", "(", ");", "wc", ".", "getOptions", "(", ").", "setThrowExceptionOnFailingStatusCode", "(", "false", ")", ";", "HtmlPage", "page", "=", "wc", ".", "goTo", "(", "\"", "testStapler", "\"", ");", "String", "secret", "=", "\"", "s3cr3t", "\"", ";", "(", "(", "HtmlInput", ")", "page", ".", "getElementById", "(", "\"", "password", "\"", "))", ".", "setValueAttribute", "(", "secret", ")", ";", "HtmlForm", "form", "=", "page", ".", "getFormByName", "(", "\"", "config", "\"", ");", "Page", "formSubmitPage", "=", "j", ".", "submit", "(", "form", ")", ";", "assertThat", "(", "formSubmitPage", ".", "getWebResponse", "(", ").", "getContentAsString", "(", "),", "allOf", "(", "containsString", "(", "RedactSecretJsonInErrorMessageSanitizer", ".", "REDACT_VALUE", ")", ",", "not", "(", "containsString", "(", "secret", ")", ")", ")", ");", "/", "/", "check", "the", "system", "log", "also", "Throwable", "thrown", "=", "logging", ".", "getRecords", "(", ").", "get", "(", "0", ")", ".", "getThrown", "(", ");", "/", "/", "the", "exception", "from", "RequestImpl", "assertThat", "(", "thrown", ".", "getCause", "(", ").", "getMessage", "(", "),", "allOf", "(", "containsString", "(", "RedactSecretJsonInErrorMessageSanitizer", ".", "REDACT_VALUE", ")", ",", "not", "(", "containsString", "(", "secret", ")", ")", ")", ");", "StringWriter", "buffer", "=", "new", "StringWriter", "(", ");", "thrown", ".", "printStackTrace", "(", "new", "PrintWriter", "(", "buffer", ")", ");", "String", "fullStack", "=", "buffer", ".", "getBuffer", "(", ").", "toString", "(", ");", "assertThat", "(", "fullStack", ",", "allOf", "(", "containsString", "(", "RedactSecretJsonInErrorMessageSanitizer", ".", "REDACT_VALUE", ")", ",", "not", "(", "containsString", "(", "secret", ")", ")", ")", ");", "}", "public", "static", "class", "TestDescribable", "implements", "Describable", "<", "TestDescribable", ">", "{", "@", "DataBoundConstructor", "public", "TestDescribable", "(", "Secret", "password", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "Try", "to", "steal", "my", "password", "\"", ");", "}", "public", "DescriptorImpl", "getDescriptor", "(", ")", "{", "return", "Jenkins", ".", "getInstance", "(", ").", "getDescriptorByType", "(", "TestDescribable", ".", "DescriptorImpl", ".", "class", ")", ";", "}", "@", "TestExtension", "(", "{", "\"", "checkSanitizationIsApplied_inStapler", "\"", ",", "\"", "checkSanitizationIsApplied_inDescriptor", "\"", "}", ")", "public", "static", "final", "class", "DescriptorImpl", "extends", "Descriptor", "<", "TestDescribable", ">", "{", "}", "}", "@", "TestExtension", "(", "\"", "checkSanitizationIsApplied_inDescriptor", "\"", ")", "public", "static", "class", "TestDescribablePage", "implements", "RootAction", "{", "public", "TestDescribable", "testDescribable", ";", "@", "RequirePOST", "public", "void", "doConfigSubmit", "(", "StaplerRequest", "req", ",", "StaplerResponse", "rsp", ")", "throws", "Exception", "{", "Jenkins", ".", "getInstance", "(", ").", "getDescriptorOrDie", "(", "TestDescribable", ".", "class", ")", ".", "newInstance", "(", "req", ",", "req", ".", "getSubmittedForm", "(", "))", ";", "}", "@", "Override", "public", "String", "getIconFileName", "(", ")", "{", "return", "null", ";", "}", "@", "Override", "public", "String", "getDisplayName", "(", ")", "{", "return", "null", ";", "}", "@", "Override", "public", "String", "getUrlName", "(", ")", "{", "return", "\"", "testDescribable", "\"", ";", "}", "}", "@", "TestExtension", "(", "\"", "checkSanitizationIsApplied_inStapler", "\"", ")", "public", "static", "class", "TestStaplerPage", "implements", "RootAction", "{", "public", "TestDescribable", "testDescribable", ";", "@", "RequirePOST", "public", "void", "doConfigSubmit", "(", "StaplerRequest", "req", ",", "StaplerResponse", "rsp", ")", "throws", "Exception", "{", "req", ".", "bindJSON", "(", "TestDescribable", ".", "class", ",", "req", ".", "getSubmittedForm", "(", "))", ";", "}", "@", "Override", "public", "String", "getIconFileName", "(", ")", "{", "return", "null", ";", "}", "@", "Override", "public", "String", "getDisplayName", "(", ")", "{", "return", "null", ";", "}", "@", "Override", "public", "String", "getUrlName", "(", ")", "{", "return", "\"", "testStapler", "\"", ";", "}", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "39", "@", "@", "<", "!-", "-", "The", "MIT", "License", "Copyright", "(", "c", ")", "2018", "CloudBees", ",", "Inc", ".", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", "-", "->", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "xmlns", ":", "f", "=", "\"/", "lib", "/", "form", "\"", ">", "<", "l", ":", "layout", "title", "=", "\"", "Making", "sure", "the", "password", "field", "gets", "an", "encrypted", "value", "\"", ">", "<", "l", ":", "main", "-", "panel", ">", "<", "f", ":", "form", "method", "=", "\"", "post", "\"", "name", "=", "\"", "config", "\"", "action", "=", "\"", "configSubmit", "\"", ">", "<", "f", ":", "entry", "field", "=", "\"", "password", "\"", ">", "<", "f", ":", "password", "id", "=", "\"", "password", "\"", "/>", "<", "/", "f", ":", "entry", ">", "<", "f", ":", "bottomButtonBar", ">", "<", "f", ":", "submit", "value", "=", "\"", "submit", "\"", "/>", "<", "/", "f", ":", "bottomButtonBar", ">", "<", "/", "f", ":", "form", ">", "<", "/", "l", ":", "main", "-", "panel", ">", "<", "/", "l", ":", "layout", ">", "<", "/", "j", ":", "jelly", ">", "@", "@", "-", "0", ",", "0", "+", "1", ",", "53", "@", "@", "<", "!-", "-", "The", "MIT", "License", "Copyright", "(", "c", ")", "2018", "CloudBees", ",", "Inc", ".", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", "-", "->", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "xmlns", ":", "f", "=", "\"/", "lib", "/", "form", "\"", ">", "<", "l", ":", "layout", "title", "=", "\"", "Making", "sure", "the", "password", "field", "gets", "an", "encrypted", "value", "\"", ">", "<", "l", ":", "main", "-", "panel", ">", "<", "f", ":", "form", "method", "=", "\"", "post", "\"", "name", "=", "\"", "config", "\"", "action", "=", "\"", "submitTest", "\"", ">", "<", "f", ":", "entry", "field", "=", "\"", "text", "-", "simple", "\"", ">", "<", "f", ":", "textbox", "id", "=", "\"", "text", "-", "simple", "\"", "/>", "<", "/", "f", ":", "entry", ">", "<", "f", ":", "entry", "field", "=", "\"", "pwd", "-", "simple", "\"", ">", "<", "f", ":", "password", "id", "=", "\"", "pwd", "-", "simple", "\"", "/>", "<", "/", "f", ":", "entry", ">", "<", "f", ":", "section", "name", "=", "\"", "sub", "-", "one", "\"", ">", "<", "f", ":", "entry", "field", "=", "\"", "text", "-", "level", "-", "one", "\"", ">", "<", "f", ":", "textbox", "id", "=", "\"", "text", "-", "level", "-", "one", "\"", "/>", "<", "/", "f", ":", "entry", ">", "<", "f", ":", "entry", "field", "=", "\"", "pwd", "-", "level", "-", "one", "-", "a", "\"", ">", "<", "f", ":", "password", "id", "=", "\"", "pwd", "-", "level", "-", "one", "-", "a", "\"", "/>", "<", "/", "f", ":", "entry", ">", "<", "f", ":", "entry", "field", "=", "\"", "pwd", "-", "level", "-", "one", "-", "b", "\"", ">", "<", "f", ":", "password", "id", "=", "\"", "pwd", "-", "level", "-", "one", "-", "b", "\"", "/>", "<", "/", "f", ":", "entry", ">", "<", "/", "f", ":", "section", ">", "<", "f", ":", "bottomButtonBar", ">", "<", "f", ":", "submit", "value", "=", "\"", "submit", "\"", "/>", "<", "/", "f", ":", "bottomButtonBar", ">", "<", "/", "f", ":", "form", ">", "<", "/", "l", ":", "main", "-", "panel", ">", "<", "/", "l", ":", "layout", ">", "<", "/", "j", ":", "jelly", ">", "@", "@", "-", "0", ",", "0", "+", "1", ",", "39", "@", "@", "<", "!-", "-", "The", "MIT", "License", "Copyright", "(", "c", ")", "2018", "CloudBees", ",", "Inc", ".", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "the", "following", "conditions", ":", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", "-", "->", "<", "?", "jelly", "escape", "-", "by", "-", "default", "=", "'", "true", "'", "?>", "<", "j", ":", "jelly", "xmlns", ":", "j", "=", "\"", "jelly", ":", "core", "\"", "xmlns", ":", "l", "=", "\"/", "lib", "/", "layout", "\"", "xmlns", ":", "f", "=", "\"/", "lib", "/", "form", "\"", ">", "<", "l", ":", "layout", "title", "=", "\"", "Making", "sure", "the", "password", "field", "gets", "an", "encrypted", "value", "\"", ">", "<", "l", ":", "main", "-", "panel", ">", "<", "f", ":", "form", "method", "=", "\"", "post", "\"", "name", "=", "\"", "config", "\"", "action", "=", "\"", "configSubmit", "\"", ">", "<", "f", ":", "entry", "field", "=", "\"", "password", "\"", ">", "<", "f", ":", "password", "id", "=", "\"", "password", "\"", "/>", "<", "/", "f", ":", "entry", ">", "<", "f", ":", "bottomButtonBar", ">", "<", "f", ":", "submit", "value", "=", "\"", "submit", "\"", "/>", "<", "/", "f", ":", "bottomButtonBar", ">", "<", "/", "f", ":", "form", ">", "<", "/", "l", ":", "main", "-", "panel", ">", "<", "/", "l", ":", "layout", ">", "<", "/", "j", ":", "jelly", ">", "@", "@", "-", "2579", ",", "7", "+", "2579", ",", "12", "@", "@", "function", "buildFormTree", "(", "form", ")", "{", "addProperty", "(", "p", ",", "e", ".", "name", ".", "substring", "(", "r", ")", ",", "e", ".", "value", ")", ";", "}", "break", ";", "case", "\"", "password", "\"", ":", "p", "=", "findParent", "(", "e", ")", ";", "addProperty", "(", "p", ",", "e", ".", "name", ",", "e", ".", "value", ")", ";", "/", "/", "must", "be", "kept", "in", "sync", "with", "RedactSecretJsonForTraceSanitizer", ".", "REDACT_KEY", "addProperty", "(", "p", ",", "\"", "$", "redact", "\"", ",", "shortenName", "(", "e", ".", "name", ")", ");", "break", ";", "default", ":", "p", "=", "findParent", "(", "e", ")", ";", "addProperty", "(", "p", ",", "e", ".", "name", ",", "e", ".", "value", ")", ";"], "docstring_tokens": ["create", "a", "large", "number", "of", "ephemeral", "user", "records", "in", "memory"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "200", ",", "16", "+", "200", ",", "18", "@", "@", "public", "void", "parse", "(", "/", "/", "Get", "the", "sample", "information", "SampleTableBox", "samples", "=", "track", ".", "getSampleTableBox", "(", ");", "SampleDescriptionBox", "sampleDesc", "=", "samples", ".", "getSampleDescriptionBox", "(", ");", "if", "(", "sampleDesc", "!", "=", "null", ")", "{", "/", "/", "Look", "for", "the", "first", "Audio", "Sample", ",", "if", "present", "AudioSampleEntry", "sample", "=", "getOrNull", "(", "sampleDesc", ",", "AudioSampleEntry", ".", "class", ")", ";", "if", "(", "sample", "!", "=", "null", ")", "{", "XMPDM", ".", "ChannelTypePropertyConverter", ".", "convertAndSet", "(", "metadata", ",", "sample", ".", "getChannelCount", "(", "))", ";", "/", "/", "metadata", ".", "set", "(", "XMPDM", ".", "AUDIO_SAMPLE_TYPE", ",", "sample", ".", "getSampleSize", "(", "))", ";", "/", "/", "TODO", "Num", "-", ">", "Type", "mapping", "metadata", ".", "set", "(", "XMPDM", ".", "AUDIO_SAMPLE_RATE", ",", "(", "int", ")", "sample", ".", "getSampleRate", "(", "))", ";", "/", "/", "metadata", ".", "set", "(", "XMPDM", ".", "AUDIO_", ",", "sample", ".", "getSamplesPerPacket", "(", "))", ";", "/", "/", "metadata", ".", "set", "(", "XMPDM", ".", "AUDIO_", ",", "sample", ".", "getBytesPerSample", "(", "))", ";", "if", "(", "samples", "!", "=", "null", ")", "{", "SampleDescriptionBox", "sampleDesc", "=", "samples", ".", "getSampleDescriptionBox", "(", ");", "if", "(", "sampleDesc", "!", "=", "null", ")", "{", "/", "/", "Look", "for", "the", "first", "Audio", "Sample", ",", "if", "present", "AudioSampleEntry", "sample", "=", "getOrNull", "(", "sampleDesc", ",", "AudioSampleEntry", ".", "class", ")", ";", "if", "(", "sample", "!", "=", "null", ")", "{", "XMPDM", ".", "ChannelTypePropertyConverter", ".", "convertAndSet", "(", "metadata", ",", "sample", ".", "getChannelCount", "(", "))", ";", "/", "/", "metadata", ".", "set", "(", "XMPDM", ".", "AUDIO_SAMPLE_TYPE", ",", "sample", ".", "getSampleSize", "(", "))", ";", "/", "/", "TODO", "Num", "-", ">", "Type", "mapping", "metadata", ".", "set", "(", "XMPDM", ".", "AUDIO_SAMPLE_RATE", ",", "(", "int", ")", "sample", ".", "getSampleRate", "(", "))", ";", "/", "/", "metadata", ".", "set", "(", "XMPDM", ".", "AUDIO_", ",", "sample", ".", "getSamplesPerPacket", "(", "))", ";", "/", "/", "metadata", ".", "set", "(", "XMPDM", ".", "AUDIO_", ",", "sample", ".", "getBytesPerSample", "(", "))", ";", "}", "}", "}", "}"], "docstring_tokens": ["an", "out", "of", "memory", "error", "and", "infinite", "loop", "flaw"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "154", ",", "7", "+", "154", ",", "13", "@", "@", "private", "void", "checkPrivileges", "(", "HiveOperationType", "hiveOpType", ",", "List", "<", "HivePrivilegeObj", "if", "(", "hiveObjects", "=", "=", "null", ")", "{", "return", ";", "}", "if", "(", "admins", "!", "=", "null", "&", "&", "Arrays", ".", "stream", "(", "admins", ")", ".", "parallel", "(", ").", "anyMatch", "(", "n", "-", ">", "n", ".", "equals", "(", "userName", ")", "))", "{", "boolean", "isAdmin", "=", "false", ";", "if", "(", "admins", "!", "=", "null", "&", "&", "admins", ".", "length", ">", "0", ")", "{", "isAdmin", "=", "Arrays", ".", "asList", "(", "admins", ")", ".", "contains", "(", "userName", ")", ";", "}", "if", "(", "isAdmin", ")", "{", "return", ";", "/", "/", "Skip", "rest", "of", "checks", "if", "user", "is", "admin", "}", "@", "@", "-", "113", ",", "6", "+", "113", ",", "7", "@", "@", "public", "HivePrivilegeObjectType", "getObjectType", "(", ")", "{", "}", "private", "static", "Map", "<", "HiveOperationType", ",", "List", "<", "PrivRequirement", ">", ">", "op2Priv", ";", "private", "static", "List", "<", "HiveOperationType", ">", "adminPrivOps", ";", "private", "static", "SQLPrivTypeGrant", "[", "]", "OWNER_PRIV_AR", "=", "arr", "(", "SQLPrivTypeGrant", ".", "OWNER_PRIV", ")", ";", "private", "static", "SQLPrivTypeGrant", "[", "]", "SEL_NOGRANT_AR", "=", "arr", "(", "SQLPrivTypeGrant", ".", "SELECT_NOGRANT", ")", ";", "@", "@", "-", "130", ",", "6", "+", "131", ",", "7", "@", "@", "public", "HivePrivilegeObjectType", "getObjectType", "(", ")", "{", "static", "{", "adminPrivOps", "=", "new", "ArrayList", "<", "HiveOperationType", ">", "()", ";", "op2Priv", "=", "new", "HashMap", "<", "HiveOperationType", ",", "List", "<", "PrivRequirement", ">", ">(", ");", "op2Priv", ".", "put", "(", "HiveOperationType", ".", "EXPLAIN", ",", "PrivRequirement", ".", "newIOPrivRequirement", "@", "@", "-", "292", ",", "6", "+", "294", ",", "8", "@", "@", "public", "HivePrivilegeObjectType", "getObjectType", "(", ")", "{", "new", "PrivRequirement", "(", "arr", "(", "SQLPrivTypeGrant", ".", "INSERT_NOGRANT", ",", "SQLPrivTypeGrant", ".", "DELETE_NOGRANT", ")", ",", "IOType", ".", "OUTPUT", ",", "null", ",", "HivePrivilegeObjectType", ".", "TABLE_OR_VIEW", ")", ",", "new", "PrivRequirement", "(", "OWNER_PRIV_AR", ",", "IOType", ".", "OUTPUT", ",", "null", ",", "HivePrivilegeObjectType", ".", "DATABASE", ")", "))", ";", "adminPrivOps", ".", "add", "(", "HiveOperationType", ".", "CREATEFUNCTION", ")", ";", "adminPrivOps", ".", "add", "(", "HiveOperationType", ".", "DROPFUNCTION", ")", ";", "/", "/", "operations", "require", "select", "priv", "op2Priv", ".", "put", "(", "HiveOperationType", ".", "SHOWCOLUMNS", ",", "PrivRequirement", ".", "newIOPrivRequirement", "@", "@", "-", "500", ",", "6", "+", "504", ",", "17", "@", "@", "public", "static", "RequiredPrivileges", "getRequiredPrivs", "(", "HiveOperationType", "hiveOpType", ",", "return", "reqPrivs", ";", "}", "/", "**", "*", "Some", "operations", "are", "tagged", "as", "requiring", "admin", "privileges", ",", "ignoring", "any", "object", "that", "*", "might", "be", "checked", "on", "it", ".", "This", "check", "is", "run", "in", "those", "cases", ".", "*", "*", "@", "param", "hiveOpType", "*", "@", "return", "*", "/", "public", "static", "boolean", "isAdminPrivOperation", "(", "HiveOperationType", "hiveOpType", ")", "{", "return", "adminPrivOps", ".", "contains", "(", "hiveOpType", ")", ";", "}", "/", "/", "for", "unit", "tests", "public", "static", "Set", "<", "HiveOperationType", ">", "getOperationTypes", "(", ")", "{", "return", "op2Priv", ".", "keySet", "(", ");"], "docstring_tokens": ["the", "failure", "to", "properly", "protect", "local", "resources"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "201", ",", "7", "+", "201", ",", "11", "@", "@", "static", "void", "keyring_destroy", "(", "struct", "key", "*", "keyring", ")", "if", "(", "keyring", "-", ">", "description", ")", "{", "write_lock", "(", "&", "keyring_name_lock", ")", ";", "list_del", "(", "&", "keyring", "-", ">", "type_data", ".", "link", ")", ";", "if", "(", "keyring", "-", ">", "type_data", ".", "link", ".", "next", "!", "=", "NULL", "&", "&", "!", "list_empty", "(", "&", "keyring", "-", ">", "type_data", ".", "link", ")", ")", "list_del", "(", "&", "keyring", "-", ">", "type_data", ".", "link", ")", ";", "write_unlock", "(", "&", "keyring_name_lock", ")", ";", "}"], "docstring_tokens": ["does", "not", "properly", "destroy", "a", "keyring", "that", "is", "not", "instantiated", "properly"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "79", ",", "6", "+", "79", ",", "7", "@", "@", "void", "clear_page_mlock", "(", "struct", "page", "*", "page", ")", "*", "/", "void", "mlock_vma_page", "(", "struct", "page", "*", "page", ")", "{", "/", "*", "Serialize", "with", "page", "migration", "*", "/", "BUG_ON", "(", "!", "PageLocked", "(", "page", ")", ");", "if", "(", "!", "TestSetPageMlocked", "(", "page", ")", ")", "{", "@", "@", "-", "174", ",", "6", "+", "175", ",", "7", "@", "@", "unsigned", "int", "munlock_vma_page", "(", "struct", "page", "*", "page", ")", "unsigned", "int", "nr_pages", ";", "struct", "zone", "*", "zone", "=", "page_zone", "(", "page", ")", ";", "/", "*", "For", "try_to_munlock", "(", ")", "and", "to", "serialize", "with", "page", "migration", "*", "/", "BUG_ON", "(", "!", "PageLocked", "(", "page", ")", ");", "/", "*", "@", "@", "-", "1332", ",", "9", "+", "1332", ",", "19", "@", "@", "static", "int", "try_to_unmap_cluster", "(", "unsigned", "long", "cursor", ",", "unsigned", "int", "*", "mapcount", ",", "BUG_ON", "(", "!", "page", "|", "|", "PageAnon", "(", "page", ")", ");", "if", "(", "locked_vma", ")", "{", "mlock_vma_page", "(", "page", ")", ";", "/", "*", "no", "-", "op", "if", "already", "mlocked", "*", "/", "if", "(", "page", "=", "=", "check_page", ")", "if", "(", "page", "=", "=", "check_page", ")", "{", "/", "*", "we", "know", "we", "have", "check_page", "locked", "*", "/", "mlock_vma_page", "(", "page", ")", ";", "ret", "=", "SWAP_MLOCK", ";", "}", "else", "if", "(", "trylock_page", "(", "page", ")", ")", "{", "/", "*", "*", "If", "we", "can", "lock", "the", "page", ",", "perform", "mlock", ".", "*", "Otherwise", "leave", "the", "page", "alone", ",", "it", "will", "be", "*", "eventually", "encountered", "again", "later", ".", "*", "/", "mlock_vma_page", "(", "page", ")", ";", "unlock_page", "(", "page", ")", ";", "}", "continue", ";", "/", "*", "don", "'", "t", "unmap", "*", "/", "}"], "docstring_tokens": ["the", "memory", "page", "migration", "or", "while", "cleaning", "the", "swap", "cache", "pages"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "11985", ",", "6", "+", "11985", ",", "8", "@", "@", "static", "void", "nested_get_vmcs12_pages", "(", "struct", "kvm_vcpu", "*", "vcpu", ")", "kunmap", "(", "vmx", "-", ">", "nested", ".", "pi_desc_page", ")", ";", "kvm_release_page_dirty", "(", "vmx", "-", ">", "nested", ".", "pi_desc_page", ")", ";", "vmx", "-", ">", "nested", ".", "pi_desc_page", "=", "NULL", ";", "vmx", "-", ">", "nested", ".", "pi_desc", "=", "NULL", ";", "vmcs_write64", "(", "POSTED_INTR_DESC_ADDR", ",", "-", "1ull", ")", ";", "}", "page", "=", "kvm_vcpu_gpa_to_page", "(", "vcpu", ",", "vmcs12", "-", ">", "posted_intr_desc_addr", ")", ";", "if", "(", "is_error_page", "(", "page", ")", ")"], "docstring_tokens": ["it", "unmaps", "the", "'pi_desc_page", "'", "without", "resetting", "'pi_desc", "'", "descriptor", "address"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "32", ",", "7", "+", "32", ",", "6", "@", "@", "import", "org", ".", "springframework", ".", "beans", ".", "factory", ".", "annotation", ".", "Autowired", ";", "import", "org", ".", "springframework", ".", "ui", ".", "ModelMap", ";", "import", "org", ".", "thymeleaf", ".", "ITemplateEngine", ";", "import", "org", ".", "thymeleaf", ".", "TemplateEngine", ";", "import", "javax", ".", "servlet", ".", "ServletException", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletRequest", ";", "@", "@", "-", "63", ",", "14", "+", "62", ",", "14", "@", "@", "protected", "IBaseResource", "addCommonParams", "(", "HttpServletRequest", "theServletRequest", ",", "fi", "final", "String", "serverBase", "=", "theRequest", ".", "getServerBase", "(", "theServletRequest", ",", "myConfig", ")", ";", "final", "String", "serverName", "=", "theRequest", ".", "getServerName", "(", "myConfig", ")", ";", "final", "String", "apiKey", "=", "theRequest", ".", "getApiKey", "(", "theServletRequest", ",", "myConfig", ")", ";", "theModel", ".", "put", "(", "\"", "serverId", "\"", ",", "serverId", ")", ";", "theModel", ".", "put", "(", "\"", "base", "\"", ",", "serverBase", ")", ";", "theModel", ".", "put", "(", "\"", "baseName", "\"", ",", "serverName", ")", ";", "theModel", ".", "put", "(", "\"", "apiKey", "\"", ",", "apiKey", ")", ";", "theModel", ".", "put", "(", "\"", "resourceName", "\"", ",", "defaultString", "(", "theRequest", ".", "getResource", "(", "))", ");", "theModel", ".", "put", "(", "\"", "encoding", "\"", ",", "theRequest", ".", "getEncoding", "(", "))", ";", "theModel", ".", "put", "(", "\"", "pretty", "\"", ",", "theRequest", ".", "getPretty", "(", "))", ";", "theModel", ".", "put", "(", "\"", "_summary", "\"", ",", "theRequest", ".", "get_summary", "(", "))", ";", "theModel", ".", "put", "(", "\"", "serverId", "\"", ",", "sanitizeInput", "(", "serverId", ")", ");", "theModel", ".", "put", "(", "\"", "base", "\"", ",", "sanitizeInput", "(", "serverBase", ")", ");", "theModel", ".", "put", "(", "\"", "baseName", "\"", ",", "sanitizeInput", "(", "serverName", ")", ");", "theModel", ".", "put", "(", "\"", "apiKey", "\"", ",", "sanitizeInput", "(", "apiKey", ")", ");", "theModel", ".", "put", "(", "\"", "resourceName", "\"", ",", "sanitizeInput", "(", "defaultString", "(", "theRequest", ".", "getResource", "(", "))", "))", ";", "theModel", ".", "put", "(", "\"", "encoding", "\"", ",", "sanitizeInput", "(", "theRequest", ".", "getEncoding", "(", "))", ");", "theModel", ".", "put", "(", "\"", "pretty", "\"", ",", "sanitizeInput", "(", "theRequest", ".", "getPretty", "(", "))", ");", "theModel", ".", "put", "(", "\"", "_summary", "\"", ",", "sanitizeInput", "(", "theRequest", ".", "get_summary", "(", "))", ");", "theModel", ".", "put", "(", "\"", "serverEntries", "\"", ",", "myConfig", ".", "getIdToServerName", "(", "))", ";", "return", "loadAndAddConf", "(", "theServletRequest", ",", "theRequest", ",", "theModel", ")", ";", "@", "@", "-", "307", ",", "7", "+", "306", ",", "6", "@", "@", "private", "IBaseResource", "loadAndAddConf", "(", "HttpServletRequest", "theServletRequest", ",", "final", "throw", "new", "IllegalStateException", "(", "\"", "Unknown", "version", ":", "\"", "+", "theRequest", ".", "getFhirVersion", "(", "myConfig", ")", ");", "}", "private", "IResource", "loadAndAddConfDstu2", "(", "HttpServletRequest", "theServletRequest", ",", "final", "HomeRequest", "theRequest", ",", "final", "ModelMap", "theModel", ")", "{", "CaptureInterceptor", "interceptor", "=", "new", "CaptureInterceptor", "(", ");", "GenericClient", "client", "=", "theRequest", ".", "newClient", "(", "theServletRequest", ",", "getContext", "(", "theRequest", ")", ",", "myConfig", ",", "interceptor", ")", ";", "@", "@", "-", "746", ",", "4", "+", "744", ",", "21", "@", "@", "public", "void", "interceptResponse", "(", "IHttpResponse", "theResponse", ")", "throws", "IOException", "{", "}", "private", "static", "String", "sanitizeInput", "(", "String", "theString", ")", "{", "String", "retVal", "=", "theString", ";", "if", "(", "retVal", "!", "=", "null", ")", "{", "for", "(", "int", "i", "=", "0", ";", "i", "<", "retVal", ".", "length", "(", ");", "i", "+", "+)", "{", "char", "nextChar", "=", "retVal", ".", "charAt", "(", "i", ")", ";", "switch", "(", "nextChar", ")", "{", "case", "'", "\\'", "':", "case", "'", "\"'", ":", "case", "'", "<'", ":", "case", "'", ">'", ":", "retVal", "=", "retVal", ".", "replace", "(", "nextChar", ",", "'", "_", "'", ");", "}", "}", "}", "return", "retVal", ";", "}", "}", "@", "@", "-", "7", ",", "6", "+", "7", ",", "11", "@", "@", "<", "/", "properties", ">", "<", "body", ">", "<", "release", "version", "=", "\"", "3", ".", "8", ".", "0", "\"", "date", "=", "\"", "TBD", "\"", "description", "=", "\"", "Hippo", "\"", ">", "<", "action", "type", "=", "\"", "fix", "\"", ">", "A", "potential", "security", "vulnerability", "in", "the", "hapi", "-", "fhir", "-", "testpage", "-", "overlay", "project", "was", "corrected", ":", "A", "URL", "parameter", "was", "not", "being", "correctly", "escaped", ",", "leading", "to", "a", "potential", "XSS", "vulnerabnility", ".", "A", "big", "thanks", "to", "Mudit", "Punia", "and", "Dushyant", "Garg", "for", "reporting", "this", ".", "<", "/", "action", ">", "<", "action", "type", "=", "\"", "add", "\"", ">", "The", "version", "of", "a", "few", "dependencies", "have", "been", "bumped", "to", "the", "latest", "versions", "(", "dependent", "HAPI", "modules", "listed", "in", "brackets", ")", ":"], "docstring_tokens": ["improper", "validation", "of", "user-supplied", "input"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "138", ",", "7", "+", "138", ",", "7", "@", "@", "static", "int", "tomoyo_mount_acl", "(", "struct", "tomoyo_request_info", "*", "r", ",", "char", "*", "dev_name", ",", "}", "if", "(", "need_dev", ")", "{", "/", "*", "Get", "mount", "point", "or", "device", "file", ".", "*", "/", "if", "(", "kern_path", "(", "dev_name", ",", "LOOKUP_FOLLOW", ",", "&", "path", ")", ")", "{", "if", "(", "!", "dev_name", "|", "|", "kern_path", "(", "dev_name", ",", "LOOKUP_FOLLOW", ",", "&", "path", ")", ")", "{", "error", "=", "-", "ENOENT", ";", "goto", "out", ";", "}"], "docstring_tokens": ["calls", "the", "kern_path", "function", "with", "arguments", "taken", "directly", "from", "a", "mount", "system", "call"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2609", ",", "6", "+", "2609", ",", "9", "@", "@", "static", "int", "sctp_process_param", "(", "struct", "sctp_association", "*", "asoc", ",", "addr_param", "=", "param", ".", "v", "+", "sizeof", "(", "sctp_addip_param_t", ")", ";", "af", "=", "sctp_get_af_specific", "(", "param_type2af", "(", "param", ".", "p", "-", ">", "type", ")", ");", "if", "(", "af", "=", "=", "NULL", ")", "break", ";", "af", "-", ">", "from_addr_param", "(", "&", "addr", ",", "addr_param", ",", "htons", "(", "asoc", "-", ">", "peer", ".", "port", ")", ",", "0", ")", ";"], "docstring_tokens": ["malformed", "packet"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "898", ",", "6", "+", "898", ",", "9", "@", "@", "static", "long", "do_splice_from", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "struct", "file", "*", "out", ",", "if", "(", "unlikely", "(", "!(", "out", "-", ">", "f_mode", "&", "FMODE_WRITE", ")", "))", "return", "-", "EBADF", ";", "if", "(", "unlikely", "(", "out", "-", ">", "f_flags", "&", "O_APPEND", ")", ")", "return", "-", "EINVAL", ";", "ret", "=", "rw_verify_area", "(", "WRITE", ",", "out", ",", "ppos", ",", "len", ")", ";", "if", "(", "unlikely", "(", "ret", "<", "0", ")", ")", "return", "ret", ";"], "docstring_tokens": ["does", "not", "reject", "file", "descriptors", "that", "have", "the", "O_APPEND", "flag", "set"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "42", ",", "8", "+", "42", ",", "10", "@", "@", "public", "class", "Http2Protocol", "implements", "UpgradeProtocol", "{", "static", "final", "long", "DEFAULT_READ_TIMEOUT", "=", "10000", ";", "static", "final", "long", "DEFAULT_KEEP_ALIVE_TIMEOUT", "=", "-", "1", ";", "static", "final", "long", "DEFAULT_WRITE_TIMEOUT", "=", "10000", ";", "static", "final", "long", "DEFAULT_KEEP_ALIVE_TIMEOUT", "=", "-", "1", ";", "static", "final", "long", "DEFAULT_STREAM_READ_TIMEOUT", "=", "20000", ";", "static", "final", "long", "DEFAULT_STREAM_WRITE_TIMEOUT", "=", "20000", ";", "/", "/", "The", "HTTP", "/", "2", "specification", "recommends", "a", "minimum", "default", "of", "100", "static", "final", "long", "DEFAULT_MAX_CONCURRENT_STREAMS", "=", "200", ";", "/", "/", "Maximum", "amount", "of", "streams", "which", "can", "be", "concurrently", "executed", "over", "@", "@", "-", "57", ",", "9", "+", "59", ",", "14", "@", "@", "private", "static", "final", "byte", "[", "]", "ALPN_IDENTIFIER", "=", "ALPN_NAME", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ";", "/", "/", "All", "timeouts", "in", "milliseconds", "/", "/", "These", "are", "the", "socket", "level", "timeouts", "private", "long", "readTimeout", "=", "DEFAULT_READ_TIMEOUT", ";", "private", "long", "keepAliveTimeout", "=", "DEFAULT_KEEP_ALIVE_TIMEOUT", ";", "private", "long", "writeTimeout", "=", "DEFAULT_WRITE_TIMEOUT", ";", "private", "long", "keepAliveTimeout", "=", "DEFAULT_KEEP_ALIVE_TIMEOUT", ";", "/", "/", "These", "are", "the", "stream", "level", "timeouts", "private", "long", "streamReadTimeout", "=", "DEFAULT_STREAM_READ_TIMEOUT", ";", "private", "long", "streamWriteTimeout", "=", "DEFAULT_STREAM_WRITE_TIMEOUT", ";", "private", "long", "maxConcurrentStreams", "=", "DEFAULT_MAX_CONCURRENT_STREAMS", ";", "private", "int", "maxConcurrentStreamExecution", "=", "DEFAULT_MAX_CONCURRENT_STREAM_EXECUTION", ";", "/", "/", "If", "a", "lower", "initial", "value", "is", "required", ",", "set", "it", "here", "but", "DO", "NOT", "change", "the", "@", "@", "-", "156", ",", "6", "+", "163", ",", "16", "@", "@", "public", "void", "setReadTimeout", "(", "long", "readTimeout", ")", "{", "}", "public", "long", "getWriteTimeout", "(", ")", "{", "return", "writeTimeout", ";", "}", "public", "void", "setWriteTimeout", "(", "long", "writeTimeout", ")", "{", "this", ".", "writeTimeout", "=", "writeTimeout", ";", "}", "public", "long", "getKeepAliveTimeout", "(", ")", "{", "return", "keepAliveTimeout", ";", "}", "@", "@", "-", "166", ",", "13", "+", "183", ",", "23", "@", "@", "public", "void", "setKeepAliveTimeout", "(", "long", "keepAliveTimeout", ")", "{", "}", "public", "long", "getWriteTimeout", "(", ")", "{", "return", "writeTimeout", ";", "public", "long", "getStreamReadTimeout", "(", ")", "{", "return", "streamReadTimeout", ";", "}", "public", "void", "setWriteTimeout", "(", "long", "writeTimeout", ")", "{", "this", ".", "writeTimeout", "=", "writeTimeout", ";", "public", "void", "setStreamReadTimeout", "(", "long", "streamReadTimeout", ")", "{", "this", ".", "streamReadTimeout", "=", "streamReadTimeout", ";", "}", "public", "long", "getStreamWriteTimeout", "(", ")", "{", "return", "streamWriteTimeout", ";", "}", "public", "void", "setStreamWriteTimeout", "(", "long", "streamWriteTimeout", ")", "{", "this", ".", "streamWriteTimeout", "=", "streamWriteTimeout", ";", "}"], "docstring_tokens": ["the", "acceptance", "of", "streams", "with", "excessive", "numbers", "of", "SETTINGS", "frames", "and", "the", "permitting", "of", "clients", "to", "keep", "streams", "open", "without", "reading/writing", "request", "data"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "279", ",", "9", "+", "279", ",", "8", "@", "@", "private", "static", "String", "recordToCsv", "(", "IBrowserConnection", "browserConnection", ",", "LdifCon", "StringBuffer", "sb", "=", "new", "StringBuffer", "(", ");", "if", "(", "exportDn", ")", "{", "sb", ".", "append", "(", "quoteCharacter", ")", ";", "sb", ".", "append", "(", "record", ".", "getDnLine", "(", ").", "getValueAsString", "(", ")", ")", ";", "sb", ".", "append", "(", "quoteCharacter", ")", ";", "String", "value", "=", "record", ".", "getDnLine", "(", ").", "getValueAsString", "(", ");", "appendValue", "(", "quoteCharacter", ",", "sb", ",", "value", ")", ";", "if", "(", "attributes", "=", "=", "null", "|", "|", "attributes", ".", "length", ">", "0", ")", "sb", ".", "append", "(", "attributeDelimiter", ")", ";", "@", "@", "-", "295", ",", "14", "+", "294", ",", "7", "@", "@", "private", "static", "String", "recordToCsv", "(", "IBrowserConnection", "browserConnection", ",", "LdifCon", "if", "(", "attributeMap", ".", "containsKey", "(", "oidString", ")", ")", "{", "String", "value", "=", "attributeMap", ".", "get", "(", "oidString", ")", ";", "/", "/", "escape", "value", "=", "value", ".", "replaceAll", "(", "quoteCharacter", ",", "quoteCharacter", "+", "quoteCharacter", ")", ";", "/", "/", "always", "quote", "sb", ".", "append", "(", "quoteCharacter", ")", ";", "sb", ".", "append", "(", "value", ")", ";", "sb", ".", "append", "(", "quoteCharacter", ")", ";", "appendValue", "(", "quoteCharacter", ",", "sb", ",", "value", ")", ";", "}", "/", "/", "delimiter", "@", "@", "-", "318", ",", "6", "+", "310", ",", "24", "@", "@", "private", "static", "String", "recordToCsv", "(", "IBrowserConnection", "browserConnection", ",", "LdifCon", "}", "private", "static", "void", "appendValue", "(", "String", "quoteCharacter", ",", "StringBuffer", "sb", ",", "String", "value", ")", "{", "/", "/", "escape", "quote", "character", "value", "=", "value", ".", "replaceAll", "(", "quoteCharacter", ",", "quoteCharacter", "+", "quoteCharacter", ")", ";", "/", "/", "prefix", "values", "starting", "with", "'", "='", "with", "a", "single", "quote", "to", "avoid", "interpretation", "as", "formula", "if", "(", "value", ".", "startsWith", "(", "\"", "=\"", ")", ")", "{", "value", "=", "\"", "'\"", "+", "value", ";", "}", "/", "/", "always", "quote", "sb", ".", "append", "(", "quoteCharacter", ")", ";", "sb", ".", "append", "(", "value", ")", ";", "sb", ".", "append", "(", "quoteCharacter", ")", ";", "}", "/", "**", "*", "Gets", "the", "attribute", "map", ".", "*", "@", "@", "-", "46", ",", "6", "+", "46", ",", "7", "@", "@", "import", "org", ".", "apache", ".", "poi", ".", "hssf", ".", "usermodel", ".", "HSSFRow", ";", "import", "org", ".", "apache", ".", "poi", ".", "hssf", ".", "usermodel", ".", "HSSFSheet", ";", "import", "org", ".", "apache", ".", "poi", ".", "hssf", ".", "usermodel", ".", "HSSFWorkbook", ";", "import", "org", ".", "apache", ".", "poi", ".", "ss", ".", "usermodel", ".", "Cell", ";", "import", "org", ".", "eclipse", ".", "core", ".", "runtime", ".", "Preferences", ";", "@", "@", "-", "151", ",", "7", "+", "152", ",", "7", "@", "@", "public", "void", "run", "(", "StudioProgressMonitor", "monitor", ")", "{", "int", "cellNum", "=", "0", ";", "attributeNameMap", ".", "put", "(", "\"", "dn", "\"", ",", "cellNum", ")", ";", "/", "/$", "NON", "-", "NLS", "-", "1", "$", "headerRow", ".", "createCell", "(", "cellNum", ")", ".", "setCellValue", "(", "\"", "dn", "\"", ")", ";", "/", "/$", "NON", "-", "NLS", "-", "1", "$", "createStringCell", "(", "headerRow", ",", "cellNum", ")", ".", "setCellValue", "(", "\"", "dn", "\"", ")", ";", "/", "/$", "NON", "-", "NLS", "-", "1", "$", "}", "/", "/", "max", "export", "@", "@", "-", "289", ",", "7", "+", "290", ",", "7", "@", "@", "private", "static", "void", "recordToHSSFRow", "(", "IBrowserConnection", "browserConnection", ",", "LdifC", "HSSFRow", "row", "=", "sheet", ".", "createRow", "(", "sheet", ".", "getLastRowNum", "(", ")", "+", "1", ")", ";", "if", "(", "exportDn", ")", "{", "HSSFCell", "cell", "=", "row", ".", "createCell", "(", "0", ")", ";", "HSSFCell", "cell", "=", "createStringCell", "(", "row", ",", "0", ")", ";", "cell", ".", "setCellValue", "(", "record", ".", "getDnLine", "(", ").", "getValueAsString", "(", ")", ")", ";", "}", "for", "(", "String", "attributeName", ":", "attributeMap", ".", "keySet", "(", ")", ")", "@", "@", "-", "300", ",", "17", "+", "301", ",", "26", "@", "@", "private", "static", "void", "recordToHSSFRow", "(", "IBrowserConnection", "browserConnection", ",", "LdifC", "{", "int", "cellNum", "=", "headerRowAttributeNameMap", ".", "size", "(", ");", "headerRowAttributeNameMap", ".", "put", "(", "attributeName", ",", "new", "Integer", "(", "cellNum", ")", ")", ";", "HSSFCell", "cell", "=", "headerRow", ".", "createCell", "(", "cellNum", ")", ";", "HSSFCell", "cell", "=", "createStringCell", "(", "headerRow", ",", "cellNum", ")", ";", "cell", ".", "setCellValue", "(", "attributeName", ")", ";", "}", "if", "(", "headerRowAttributeNameMap", ".", "containsKey", "(", "attributeName", ")", ")", "{", "int", "cellNum", "=", "headerRowAttributeNameMap", ".", "get", "(", "attributeName", ")", ".", "shortValue", "(", ");", "HSSFCell", "cell", "=", "row", ".", "createCell", "(", "cellNum", ")", ";", "HSSFCell", "cell", "=", "createStringCell", "(", "row", ",", "cellNum", ")", ";", "cell", ".", "setCellValue", "(", "value", ")", ";", "}", "}", "}", "private", "static", "HSSFCell", "createStringCell", "(", "HSSFRow", "row", ",", "int", "cellNum", ")", "{", "HSSFCell", "cell", "=", "row", ".", "createCell", "(", "cellNum", ")", ";", "cell", ".", "setCellType", "(", "Cell", ".", "CELL_TYPE_STRING", ")", ";", "return", "cell", ";", "}", "}", "@", "@", "-", "266", ",", "4", "+", "266", ",", "34", "@", "@", "public", "void", "testImportDontUptateUI", "(", ")", "throws", "Exception", "assertEquals", "(", "\"", "Only", "2", "event", "firings", "expected", "when", "importing", "LDIF", ".", "\",", "2", ",", "fireCount", ")", ";", "}", "/", "**", "*", "Export", "to", "CSV", "and", "checks", "that", "spreadsheet", "formulas", "are", "prefixed", "with", "an", "apostrophe", ".", "*", "/", "@", "Test", "public", "void", "testExportCsvShouldPrefixFormulaWithApostrophe", "(", ")", "throws", "Exception", "{", "URL", "url", "=", "Platform", ".", "getInstanceLocation", "(", ").", "getURL", "(", ");", "final", "String", "file", "=", "url", ".", "getFile", "(", ")", "+", "\"", "ImportExportTest", ".", "csv", "\"", ";", "System", ".", "out", ".", "println", "(", "file", ")", ";", "browserViewBot", ".", "selectEntry", "(", "\"", "DIT", "\"", ",", "\"", "Root", "DSE", "\"", ",", "\"", "ou", "=", "system", "\"", ",", "\"", "ou", "=", "users", "\"", ",", "\"", "cn", "=", "Wolfgang", "K", "\\", "u00f6lbel", "\"", ")", ";", "/", "/", "export", "LDIF", "ExportWizardBot", "wizardBot", "=", "browserViewBot", ".", "openExportCsvWizard", "(", ");", "assertTrue", "(", "wizardBot", ".", "isVisible", "(", ")", ")", ";", "wizardBot", ".", "typeReturningAttributes", "(", "\"", "cn", ",", "description", "\"", ")", ";", "wizardBot", ".", "clickNextButton", "(", ");", "wizardBot", ".", "typeFile", "(", "file", ")", ";", "wizardBot", ".", "clickFinishButton", "(", ");", "wizardBot", ".", "waitTillExportFinished", "(", "file", ",", "80", ")", ";", "/", "/", "is", "actually", "86", "bytes", "List", "<", "String", ">", "lines", "=", "FileUtils", ".", "readLines", "(", "new", "File", "(", "file", ")", ")", ";", "/", "/", "verify", "that", "the", "first", "line", "is", "header", "assertEquals", "(", "\"", "dn", ",", "cn", ",", "description", "\"", ",", "lines", ".", "get", "(", "0", ")", ")", ";", "/", "/", "verify", "that", "the", "second", "line", "is", "actual", "content", "and", "the", "formula", "is", "prefixed", "with", "an", "apostrophe", "assertEquals", "(", "\"", "\\\"", "cn", "=", "Wolfgang", "K", "\\", "u00f6lbel", ",", "ou", "=", "users", ",", "ou", "=", "system", "\\", "\",", "\\\"", "Wolfgang", "K", "\\", "u00f6lbel", "\\", "\",", "\\\"", "'=", "1", "+", "1", "\\", "\"\"", ",", "lines", ".", "get", "(", "1", ")", ")", ";", "}", "}", "@", "@", "-", "137", ",", "6", "+", "137", ",", "13", "@", "@", "public", "ExportWizardBot", "openExportDsmlWizard", "(", ")", "}", "public", "ExportWizardBot", "openExportCsvWizard", "(", ")", "{", "ContextMenuHelper", ".", "clickContextMenu", "(", "browserBot", ".", "getTree", "(", "),", "\"", "Export", "\"", ",", "\"", "CSV", "Export", ".", "..", "\"", ")", ";", "return", "new", "ExportWizardBot", "(", "ExportWizardBot", ".", "EXPORT_CSV_TITLE", ")", ";", "}", "public", "ImportWizardBot", "openImportLdifWizard", "(", ")", "{", "ContextMenuHelper", ".", "clickContextMenu", "(", "browserBot", ".", "getTree", "(", "),", "\"", "Import", "\"", ",", "\"", "LDIF", "Import", ".", "..", "\"", ")", ";", "@", "@", "-", "31", ",", "6", "+", "31", ",", "7", "@", "@", "{", "public", "static", "final", "String", "EXPORT_LDIF_TITLE", "=", "\"", "LDIF", "Export", "\"", ";", "public", "static", "final", "String", "EXPORT_DSML_TITLE", "=", "\"", "DSML", "Export", "\"", ";", "public", "static", "final", "String", "EXPORT_CSV_TITLE", "=", "\"", "CSV", "Export", "\"", ";", "private", "String", "title", ";", "@", "@", "-", "53", ",", "6", "+", "54", ",", "12", "@", "@", "public", "boolean", "isVisible", "(", ")", "}", "public", "void", "typeReturningAttributes", "(", "String", "returningAttributes", ")", "{", "bot", ".", "comboBoxWithLabel", "(", "\"", "Returning", "Attributes", ":", "\"", ")", ".", "setText", "(", "returningAttributes", ")", ";", "}", "public", "void", "typeFile", "(", "String", "file", ")", "{", "bot", ".", "comboBox", "(", ").", "setText", "(", "file", ")", ";", "@", "@", "-", "22", ",", "4", "+", "22", ",", "5", "@", "@", "objectClass", ":", "inetOrgPerson", "objectClass", ":", "top", "cn", ":", ":", "V29sZmdhbmcgS8O2bGJlbA", "=", "=", "sn", ":", ":", "S8O2bGJlbA", "=", "=", "description", ":", "=", "1", "+", "1"], "docstring_tokens": ["the", "failure", "to", "properly", "escape", "the", "fields"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "286", ",", "6", "+", "286", ",", "8", "@", "@", "static", "int", "caif_seqpkt_recvmsg", "(", "struct", "kiocb", "*", "iocb", ",", "struct", "socket", "*", "sock", ",", "if", "(", "m", "-", ">", "msg_flags", "&", "MSG_OOB", ")", "goto", "read_error", ";", "m", "-", ">", "msg_namelen", "=", "0", ";", "skb", "=", "skb_recv_datagram", "(", "sk", ",", "flags", ",", "0", ",", "&", "ret", ")", ";", "if", "(", "!", "skb", ")", "goto", "read_error", ";"], "docstring_tokens": ["does", "not", "initialize", "a", "certain", "length", "variable"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "156", ",", "17", "+", "156", ",", "18", "@", "@", "int", "ping_hash", "(", "struct", "sock", "*", "sk", ")", "void", "ping_unhash", "(", "struct", "sock", "*", "sk", ")", "{", "struct", "inet_sock", "*", "isk", "=", "inet_sk", "(", "sk", ")", ";", "pr_debug", "(", "\"", "ping_unhash", "(", "isk", "=", "%", "p", ",", "isk", "-", ">", "num", "=", "%", "u", ")", "\\", "n", "\"", ",", "isk", ",", "isk", "-", ">", "inet_num", ")", ";", "write_lock_bh", "(", "&", "ping_table", ".", "lock", ")", ";", "if", "(", "sk_hashed", "(", "sk", ")", ")", "{", "write_lock_bh", "(", "&", "ping_table", ".", "lock", ")", ";", "hlist_nulls_del", "(", "&", "sk", "-", ">", "sk_nulls_node", ")", ";", "sk_nulls_node_init", "(", "&", "sk", "-", ">", "sk_nulls_node", ")", ";", "sock_put", "(", "sk", ")", ";", "isk", "-", ">", "inet_num", "=", "0", ";", "isk", "-", ">", "inet_sport", "=", "0", ";", "sock_prot_inuse_add", "(", "sock_net", "(", "sk", ")", ",", "sk", "-", ">", "sk_prot", ",", "-", "1", ")", ";", "write_unlock_bh", "(", "&", "ping_table", ".", "lock", ")", ";", "}", "write_unlock_bh", "(", "&", "ping_table", ".", "lock", ")", ";", "}", "EXPORT_SYMBOL_GPL", "(", "ping_unhash", ")", ";"], "docstring_tokens": ["is", "too", "late", "in", "obtaining", "a", "certain", "lock", "and", "consequently", "cannot", "ensure", "that", "disconnect", "function", "calls", "are", "safe"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "37", ",", "7", "+", "37", ",", "7", "@", "@", "*", "/", "public", "abstract", "class", "AbstractJBossMarshaller", "extends", "AbstractMarshaller", "implements", "StreamingMarshaller", "{", "private", "static", "final", "Log", "log", "=", "LogFactory", ".", "getLog", "(", "AbstractJBossMarshaller", ".", "class", ")", ";", "protected", "static", "final", "Log", "log", "=", "LogFactory", ".", "getLog", "(", "AbstractJBossMarshaller", ".", "class", ")", ";", "private", "static", "final", "boolean", "trace", "=", "log", ".", "isTraceEnabled", "(", ");", "protected", "static", "final", "JBossMarshallerFactory", "factory", "=", "new", "JBossMarshallerFactory", "(", ");", "protected", "static", "final", "int", "DEF_INSTANCE_COUNT", "=", "16", ";", "@", "@", "-", "970", ",", "6", "+", "970", ",", "9", "@", "@", "The", "number", "of", "connections", "per", "server", ",", "total", "number", "of", "connections", ",", "how", "long", "shou", "=", "==", "=", "Marshalling", "data", "The", "Hot", "Rod", "client", "allows", "one", "to", "plug", "in", "a", "custom", "marshaller", "for", "transforming", "user", "objects", "into", "byte", "arrays", "and", "the", "other", "way", "around", ".", "This", "transformation", "is", "needed", "because", "of", "Hot", "Rod", "'", "s", "binary", "nature", "-", "it", "doesn", "'", "t", "know", "about", "objects", ".", ".", "WARNING", ":", "If", "developing", "your", "own", "custom", "marshaller", ",", "take", "care", "of", "potential", "injection", "attacks", ".", "To", "avoid", "such", "attacks", ",", "make", "the", "marshaller", "verify", "that", "any", "class", "names", "read", ",", "before", "instantiating", "it", ",", "is", "amongst", "the", "expected", "/", "allowed", "class", "names", ".", "The", "marshaller", "can", "be", "plugged", "through", "the", "\"", "marshaller", "\"", "configuration", "element", "(", "see", "Configuration", "section", ")", ":", "the", "value", "should", "be", "the", "fully", "qualified", "name", "of", "a", "class", "implementing", "the", "link", ":", "{", "javadocroot", "}", "/", "org", "/", "infinispan", "/", "marshall", "/", "Marshaller", ".", "html", "[", "Marshaller", "]", "interface", ".", "This", "is", "a", "optional", "parameter", ",", "if", "not", "specified", "it", "defaults", "to", "the", "link", ":", "{", "javadocroot", "}", "/", "org", "/", "infinispan", "/", "marshall", "/", "jboss", "/", "GenericJBossMarshaller", ".", "html", "[", "GenericJBossMarshaller", "]", "-", "a", "highly", "optimized", "implementation", "based", "on", "the", "link", ":", "http", ":", "//", "www", ".", "jboss", ".", "org", "/", "jbossmarshalling", "[", "JBoss", "Marshalling", "]", "library", ".", "Since", "version", "6", ".", "0", ",", "there", "'", "s", "a", "new", "marshaller", "available", "to", "Java", "Hot", "Rod", "clients", "based", "on", "Protostream", "which", "generates", "portable", "payloads", ".", "You", "can", "find", "more", "information", "about", "it", "<", "<", "_querying_via_the_java_hot_rod_client", ",", "here", ">", ">", "@", "@", "-", "167", ",", "7", "+", "167", ",", "7", "@", "@", "private", "void", "createHotRodCache", "(", "HotRodServer", "server", ")", "{", "hotrod", "=", "server", ";", "hotrodClient", "=", "new", "RemoteCacheManager", "(", "new", "ConfigurationBuilder", "(", ")", ".", "addServers", "(", "\"", "localhost", ":", "\"", "+", "hotrod", ".", "getPort", "(", "))", ".", "addJavaSerialWhiteList", "(", "\".", "*", "Person", ".", "*\"", ")", ".", "addJavaSerialWhiteList", "(", "\".", "*", "Person", ".", "*\"", ",", "\"", ".*", "CustomEvent", ".", "*\"", ")", ".", "marshaller", "(", "marshaller", ")", ".", "build", "(", "))", ";", "hotrodCache", "=", "cacheName", ".", "isEmpty", "(", ")"], "docstring_tokens": ["unsafely", "read", "deserialized", "data", "on", "information", "from", "the", "cache"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "269", ",", "6", "+", "269", ",", "14", "@", "@", "static", "chunk_t", "area_location", "(", "struct", "pstore", "*", "ps", ",", "chunk_t", "area", ")", "return", "NUM_SNAPSHOT_HDR_CHUNKS", "+", "(", "(", "ps", "-", ">", "exceptions_per_area", "+", "1", ")", "*", "area", ")", ";", "}", "static", "void", "skip_metadata", "(", "struct", "pstore", "*", "ps", ")", "{", "uint32_t", "stride", "=", "ps", "-", ">", "exceptions_per_area", "+", "1", ";", "chunk_t", "next_free", "=", "ps", "-", ">", "next_free", ";", "if", "(", "sector_div", "(", "next_free", ",", "stride", ")", "=", "=", "NUM_SNAPSHOT_HDR_CHUNKS", ")", "ps", "-", ">", "next_free", "+", "+;", "}", "/", "*", "*", "Read", "or", "write", "a", "metadata", "area", ".", "Remembering", "to", "skip", "the", "first", "*", "chunk", "which", "holds", "the", "header", ".", "@", "@", "-", "502", ",", "6", "+", "510", ",", "8", "@", "@", "static", "int", "read_exceptions", "(", "struct", "pstore", "*", "ps", ",", "ps", "-", ">", "current_area", "-", "-;", "skip_metadata", "(", "ps", ")", ";", "return", "0", ";", "}", "@", "@", "-", "616", ",", "8", "+", "626", ",", "6", "@", "@", "static", "int", "persistent_prepare_exception", "(", "struct", "dm_exception_store", "*", "store", ",", "struct", "dm_exception", "*", "e", ")", "{", "struct", "pstore", "*", "ps", "=", "get_info", "(", "store", ")", ";", "uint32_t", "stride", ";", "chunk_t", "next_free", ";", "sector_t", "size", "=", "get_dev_size", "(", "dm_snap_cow", "(", "store", "-", ">", "snap", ")", "->", "bdev", ")", ";", "/", "*", "Is", "there", "enough", "room", "?", "*", "/", "@", "@", "-", "630", ",", "10", "+", "638", ",", "8", "@", "@", "static", "int", "persistent_prepare_exception", "(", "struct", "dm_exception_store", "*", "store", ",", "*", "Move", "onto", "the", "next", "free", "pending", ",", "making", "sure", "to", "take", "*", "into", "account", "the", "location", "of", "the", "metadata", "chunks", ".", "*", "/", "stride", "=", "(", "ps", "-", ">", "exceptions_per_area", "+", "1", ")", ";", "next_free", "=", "+", "+", "ps", "-", ">", "next_free", ";", "if", "(", "sector_div", "(", "next_free", ",", "stride", ")", "=", "=", "1", ")", "ps", "-", ">", "next_free", "+", "+;", "ps", "-", ">", "next_free", "+", "+;", "skip_metadata", "(", "ps", ")", ";", "atomic_inc", "(", "&", "ps", "-", ">", "pending_count", ")", ";", "return", "0", ";"], "docstring_tokens": ["an", "error", "when", "data", "is", "written", "to", "snapshot", "block", "devices"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "383", ",", "9", "+", "383", ",", "6", "@", "@", "EXPORT_SYMBOL", "(", "hashbin_new", ")", ";", "*", "for", "deallocating", "this", "structure", "if", "it", "'", "s", "complex", ".", "If", "not", "the", "user", "can", "*", "just", "supply", "kfree", ",", "which", "should", "take", "care", "of", "the", "job", ".", "*", "/", "#", "ifdef", "CONFIG_LOCKDEP", "static", "int", "hashbin_lock_depth", "=", "0", ";", "#", "endif", "int", "hashbin_delete", "(", "hashbin_t", "*", "hashbin", ",", "FREE_FUNC", "free_func", ")", "{", "irda_queue_t", "*", "queue", ";", "@", "@", "-", "396", ",", "22", "+", "393", ",", "27", "@", "@", "int", "hashbin_delete", "(", "hashbin_t", "*", "hashbin", ",", "FREE_FUNC", "free_func", ")", "IRDA_ASSERT", "(", "hashbin", "-", ">", "magic", "=", "=", "HB_MAGIC", ",", "return", "-", "1", ";", ");", "/", "*", "Synchronize", "*", "/", "if", "(", "hashbin", "-", ">", "hb_type", "&", "HB_LOCK", ")", "{", "spin_lock_irqsave_nested", "(", "&", "hashbin", "-", ">", "hb_spinlock", ",", "flags", ",", "hashbin_lock_depth", "+", "+)", ";", "}", "if", "(", "hashbin", "-", ">", "hb_type", "&", "HB_LOCK", ")", "spin_lock_irqsave", "(", "&", "hashbin", "-", ">", "hb_spinlock", ",", "flags", ")", ";", "/", "*", "*", "Free", "the", "entries", "in", "the", "hashbin", ",", "TODO", ":", "use", "hashbin_clear", "when", "*", "it", "has", "been", "shown", "to", "work", "*", "/", "for", "(", "i", "=", "0", ";", "i", "<", "HASHBIN_SIZE", ";", "i", "+", "+", ")", "{", "queue", "=", "dequeue_first", "(", "(", "irda_queue_t", "*", "*)", "&", "hashbin", "-", ">", "hb_queue", "[", "i", "]", ");", "while", "(", "queue", ")", "{", "if", "(", "free_func", ")", "(", "*", "free_func", ")", "(", "queue", ")", ";", "queue", "=", "dequeue_first", "(", "(", "irda_queue_t", "*", "*)", "&", "hashbin", "-", ">", "hb_queue", "[", "i", "]", ");", "while", "(", "1", ")", "{", "queue", "=", "dequeue_first", "(", "(", "irda_queue_t", "*", "*)", "&", "hashbin", "-", ">", "hb_queue", "[", "i", "]", ");", "if", "(", "!", "queue", ")", "break", ";", "if", "(", "free_func", ")", "{", "if", "(", "hashbin", "-", ">", "hb_type", "&", "HB_LOCK", ")", "spin_unlock_irqrestore", "(", "&", "hashbin", "-", ">", "hb_spinlock", ",", "flags", ")", ";", "free_func", "(", "queue", ")", ";", "if", "(", "hashbin", "-", ">", "hb_type", "&", "HB_LOCK", ")", "spin_lock_irqsave", "(", "&", "hashbin", "-", ">", "hb_spinlock", ",", "flags", ")", ";", "}", "}", "}", "@", "@", "-", "420", ",", "12", "+", "422", ",", "8", "@", "@", "int", "hashbin_delete", "(", "hashbin_t", "*", "hashbin", ",", "FREE_FUNC", "free_func", ")", "hashbin", "-", ">", "magic", "=", "~", "HB_MAGIC", ";", "/", "*", "Release", "lock", "*", "/", "if", "(", "hashbin", "-", ">", "hb_type", "&", "HB_LOCK", ")", "{", "if", "(", "hashbin", "-", ">", "hb_type", "&", "HB_LOCK", ")", "spin_unlock_irqrestore", "(", "&", "hashbin", "-", ">", "hb_spinlock", ",", "flags", ")", ";", "#", "ifdef", "CONFIG_LOCKDEP", "hashbin_lock_depth", "-", "-;", "#", "endif", "}", "/", "*", "*", "Free", "the", "hashbin", "structure"], "docstring_tokens": ["improperly", "manages", "lock", "dropping"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2034", ",", "10", "+", "2034", ",", "8", "@", "@", "static", "ssize_t", "fuse_dev_splice_write", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "rem", "+", "=", "pipe", "-", ">", "bufs", "[", "(", "pipe", "-", ">", "curbuf", "+", "idx", ")", "&", "(", "pipe", "-", ">", "buffers", "-", "1", ")", "].", "len", ";", "ret", "=", "-", "EINVAL", ";", "if", "(", "rem", "<", "len", ")", "{", "pipe_unlock", "(", "pipe", ")", ";", "goto", "out", ";", "}", "if", "(", "rem", "<", "len", ")", "goto", "out_free", ";", "rem", "=", "len", ";", "while", "(", "rem", ")", "{", "@", "@", "-", "2055", ",", "7", "+", "2053", ",", "9", "@", "@", "static", "ssize_t", "fuse_dev_splice_write", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "pipe", "-", ">", "curbuf", "=", "(", "pipe", "-", ">", "curbuf", "+", "1", ")", "&", "(", "pipe", "-", ">", "buffers", "-", "1", ")", ";", "pipe", "-", ">", "nrbufs", "-", "-;", "}", "else", "{", "pipe_buf_get", "(", "pipe", ",", "ibuf", ")", ";", "if", "(", "!", "pipe_buf_get", "(", "pipe", ",", "ibuf", ")", ")", "goto", "out_free", ";", "*", "obuf", "=", "*", "ibuf", ";", "obuf", "-", ">", "flags", "&", "=", "~", "PIPE_BUF_FLAG_GIFT", ";", "obuf", "-", ">", "len", "=", "rem", ";", "@", "@", "-", "2078", ",", "11", "+", "2078", ",", "11", "@", "@", "static", "ssize_t", "fuse_dev_splice_write", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "ret", "=", "fuse_dev_do_write", "(", "fud", ",", "&", "cs", ",", "len", ")", ";", "pipe_lock", "(", "pipe", ")", ";", "out_free", ":", "for", "(", "idx", "=", "0", ";", "idx", "<", "nbuf", ";", "idx", "+", "+)", "pipe_buf_release", "(", "pipe", ",", "&", "bufs", "[", "idx", "]", ");", "pipe_unlock", "(", "pipe", ")", ";", "out", ":", "kvfree", "(", "bufs", ")", ";", "return", "ret", ";", "}", "@", "@", "-", "189", ",", "9", "+", "189", ",", "9", "@", "@", "EXPORT_SYMBOL", "(", "generic_pipe_buf_steal", ")", ";", "*", "in", "the", "tee", "(", ")", "system", "call", ",", "when", "we", "duplicate", "the", "buffers", "in", "one", "*", "pipe", "into", "another", ".", "*", "/", "void", "generic_pipe_buf_get", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "struct", "pipe_buffer", "*", "buf", ")", "bool", "generic_pipe_buf_get", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "struct", "pipe_buffer", "*", "buf", ")", "{", "get_page", "(", "buf", "-", ">", "page", ")", ";", "return", "try_get_page", "(", "buf", "-", ">", "page", ")", ";", "}", "EXPORT_SYMBOL", "(", "generic_pipe_buf_get", ")", ";", "@", "@", "-", "1588", ",", "7", "+", "1588", ",", "11", "@", "@", "static", "int", "splice_pipe_to_pipe", "(", "struct", "pipe_inode_info", "*", "ipipe", ",", "*", "Get", "a", "reference", "to", "this", "pipe", "buffer", ",", "*", "so", "we", "can", "copy", "the", "contents", "over", ".", "*", "/", "pipe_buf_get", "(", "ipipe", ",", "ibuf", ")", ";", "if", "(", "!", "pipe_buf_get", "(", "ipipe", ",", "ibuf", ")", ")", "{", "if", "(", "ret", "=", "=", "0", ")", "ret", "=", "-", "EFAULT", ";", "break", ";", "}", "*", "obuf", "=", "*", "ibuf", ";", "/", "*", "@", "@", "-", "1660", ",", "7", "+", "1664", ",", "11", "@", "@", "static", "int", "link_pipe", "(", "struct", "pipe_inode_info", "*", "ipipe", ",", "*", "Get", "a", "reference", "to", "this", "pipe", "buffer", ",", "*", "so", "we", "can", "copy", "the", "contents", "over", ".", "*", "/", "pipe_buf_get", "(", "ipipe", ",", "ibuf", ")", ";", "if", "(", "!", "pipe_buf_get", "(", "ipipe", ",", "ibuf", ")", ")", "{", "if", "(", "ret", "=", "=", "0", ")", "ret", "=", "-", "EFAULT", ";", "break", ";", "}", "obuf", "=", "opipe", "-", ">", "bufs", "+", "nbuf", ";", "*", "obuf", "=", "*", "ibuf", ";", "@", "@", "-", "108", ",", "18", "+", "108", ",", "20", "@", "@", "struct", "pipe_buf_operations", "{", "/", "*", "*", "Get", "a", "reference", "to", "the", "pipe", "buffer", ".", "*", "/", "void", "(", "*", "get", ")", "(", "struct", "pipe_inode_info", "*", ",", "struct", "pipe_buffer", "*", ");", "bool", "(", "*", "get", ")", "(", "struct", "pipe_inode_info", "*", ",", "struct", "pipe_buffer", "*", ");", "}", ";", "/", "**", "*", "pipe_buf_get", "-", "get", "a", "reference", "to", "a", "pipe_buffer", "*", "@", "pipe", ":", "the", "pipe", "that", "the", "buffer", "belongs", "to", "*", "@", "buf", ":", "the", "buffer", "to", "get", "a", "reference", "to", "*", "*", "Return", ":", "%", "true", "if", "the", "reference", "was", "successfully", "obtained", ".", "*", "/", "static", "inline", "void", "pipe_buf_get", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "static", "inline", "__must_check", "bool", "pipe_buf_get", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "struct", "pipe_buffer", "*", "buf", ")", "{", "buf", "-", ">", "ops", "-", ">", "get", "(", "pipe", ",", "buf", ")", ";", "return", "buf", "-", ">", "ops", "-", ">", "get", "(", "pipe", ",", "buf", ")", ";", "}", "/", "**", "@", "@", "-", "178", ",", "7", "+", "180", ",", "7", "@", "@", "struct", "pipe_inode_info", "*", "alloc_pipe_info", "(", "void", ")", ";", "void", "free_pipe_info", "(", "struct", "pipe_inode_info", "*", ");", "/", "*", "Generic", "pipe", "buffer", "ops", "functions", "*", "/", "void", "generic_pipe_buf_get", "(", "struct", "pipe_inode_info", "*", ",", "struct", "pipe_buffer", "*", ");", "bool", "generic_pipe_buf_get", "(", "struct", "pipe_inode_info", "*", ",", "struct", "pipe_buffer", "*", ");", "int", "generic_pipe_buf_confirm", "(", "struct", "pipe_inode_info", "*", ",", "struct", "pipe_buffer", "*", ");", "int", "generic_pipe_buf_steal", "(", "struct", "pipe_inode_info", "*", ",", "struct", "pipe_buffer", "*", ");", "void", "generic_pipe_buf_release", "(", "struct", "pipe_inode_info", "*", ",", "struct", "pipe_buffer", "*", ");", "@", "@", "-", "6835", ",", "12", "+", "6835", ",", "16", "@", "@", "static", "void", "buffer_pipe_buf_release", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "buf", "-", ">", "private", "=", "0", ";", "}", "static", "void", "buffer_pipe_buf_get", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "static", "bool", "buffer_pipe_buf_get", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "struct", "pipe_buffer", "*", "buf", ")", "{", "struct", "buffer_ref", "*", "ref", "=", "(", "struct", "buffer_ref", "*", ")", "buf", "-", ">", "private", ";", "if", "(", "ref", "-", ">", "ref", ">", "INT_MAX", "/", "2", ")", "return", "false", ";", "ref", "-", ">", "ref", "+", "+;", "return", "true", ";", "}", "/", "*", "Pipe", "buffer", "operations", "for", "a", "buffer", ".", "*", "/"], "docstring_tokens": ["missing", "locking"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "4027", ",", "8", "+", "4027", ",", "9", "@", "@", "static", "bool", "e1000_clean_rx_irq", "(", "struct", "e1000_adapter", "*", "adapter", ",", "PCI_DMA_FROMDEVICE", ")", ";", "length", "=", "le16_to_cpu", "(", "rx_desc", "-", ">", "length", ")", ";", "if", "(", "unlikely", "(", "!(", "status", "&", "E1000_RXD_STAT_EOP", ")", "))", "{", "/", "*", "!", "EOP", "means", "multiple", "descriptors", "were", "used", "to", "store", "a", "single", "*", "packet", ",", "also", "make", "sure", "the", "frame", "isn", "'", "t", "just", "CRC", "only", "*", "/", "if", "(", "unlikely", "(", "!(", "status", "&", "E1000_RXD_STAT_EOP", ")", "|", "|", "(", "length", "<", "=", "4", ")", "))", "{", "/", "*", "All", "receives", "must", "fit", "into", "a", "single", "buffer", "*", "/", "E1000_DBG", "(", "\"%", "s", ":", "Receive", "packet", "consumed", "multiple", "\"", "\"", "buffers", "\\", "n", "\"", ",", "netdev", "-", ">", "name", ")", ";"], "docstring_tokens": ["does", "not", "expect", "something", "above", "the", "space", "allocated", "to", "the", "current", "skb", "and", "crashes", "loudly"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "112", ",", "6", "+", "112", ",", "7", "@", "@", "protected", "int", "spdyInitialWindowSize", ";", "protected", "int", "spdyMaxConcurrentStreams", ";", "protected", "TimeConverter", "timeConverter", ";", "protected", "boolean", "acceptAnyCertificate", ";", "protected", "AsyncHttpClientConfig", "(", ")", "{", "}", "@", "@", "-", "151", ",", "7", "+", "152", ",", "8", "@", "@", "private", "AsyncHttpClientConfig", "(", "int", "maxTotalConnections", ",", "/", "/", "boolean", "spdyEnabled", ",", "/", "/", "int", "spdyInitialWindowSize", ",", "/", "/", "int", "spdyMaxConcurrentStreams", ",", "/", "/", "TimeConverter", "timeConverter", ")", "{", "TimeConverter", "timeConverter", ",", "/", "/", "boolean", "acceptAnyCertificate", ")", "{", "this", ".", "maxTotalConnections", "=", "maxTotalConnections", ";", "this", ".", "maxConnectionPerHost", "=", "maxConnectionPerHost", ";", "@", "@", "-", "187", ",", "6", "+", "189", ",", "7", "@", "@", "private", "AsyncHttpClientConfig", "(", "int", "maxTotalConnections", ",", "/", "/", "this", ".", "spdyInitialWindowSize", "=", "spdyInitialWindowSize", ";", "this", ".", "spdyMaxConcurrentStreams", "=", "spdyMaxConcurrentStreams", ";", "this", ".", "timeConverter", "=", "timeConverter", ";", "this", ".", "acceptAnyCertificate", "=", "acceptAnyCertificate", ";", "}", "@", "@", "-", "533", ",", "6", "+", "536", ",", "10", "@", "@", "public", "TimeConverter", "getTimeConverter", "(", ")", "{", "return", "timeConverter", ";", "}", "public", "boolean", "isAcceptAnyCertificate", "(", ")", "{", "return", "acceptAnyCertificate", ";", "}", "/", "**", "*", "Builder", "for", "an", "{", "@", "link", "AsyncHttpClient", "}", "*", "/", "@", "@", "-", "564", ",", "6", "+", "571", ",", "7", "@", "@", "public", "TimeConverter", "getTimeConverter", "(", ")", "{", "private", "boolean", "spdyEnabled", "=", "defaultSpdyEnabled", "(", ");", "private", "int", "spdyInitialWindowSize", "=", "defaultSpdyInitialWindowSize", "(", ");", "private", "int", "spdyMaxConcurrentStreams", "=", "defaultSpdyMaxConcurrentStreams", "(", ");", "private", "boolean", "acceptAnyCertificate", "=", "defaultAcceptAnyCertificate", "(", ");", "private", "ScheduledExecutorService", "reaper", ";", "private", "ExecutorService", "applicationThreadPool", ";", "@", "@", "-", "1078", ",", "6", "+", "1086", ",", "11", "@", "@", "public", "Builder", "setTimeConverter", "(", "TimeConverter", "timeConverter", ")", "{", "return", "this", ";", "}", "public", "Builder", "setAcceptAnyCertificate", "(", "boolean", "acceptAnyCertificate", ")", "{", "this", ".", "acceptAnyCertificate", "=", "acceptAnyCertificate", ";", "return", "this", ";", "}", "/", "**", "*", "Create", "a", "config", "builder", "with", "values", "taken", "from", "the", "given", "prototype", "configuration", ".", "*", "@", "@", "-", "1186", ",", "7", "+", "1199", ",", "8", "@", "@", "public", "Thread", "newThread", "(", "Runnable", "r", ")", "{", "spdyEnabled", ",", "/", "/", "spdyInitialWindowSize", ",", "/", "/", "spdyMaxConcurrentStreams", ",", "/", "/", "timeConverter", ")", ";", "timeConverter", ",", "/", "/", "acceptAnyCertificate", ")", ";", "}", "}", "}", "@", "@", "-", "70", ",", "6", "+", "70", ",", "7", "@", "@", "void", "configureDefaults", "(", ")", "{", "spdyEnabled", "=", "defaultSpdyEnabled", "(", ");", "spdyInitialWindowSize", "=", "defaultSpdyInitialWindowSize", "(", ");", "spdyMaxConcurrentStreams", "=", "defaultSpdyMaxConcurrentStreams", "(", ");", "acceptAnyCertificate", "=", "defaultAcceptAnyCertificate", "(", ");", "if", "(", "defaultUseProxySelector", "(", "))", "{", "proxyServerSelector", "=", "ProxyUtils", ".", "getJdkDefaultProxyServerSelector", "(", ");", "}", "else", "if", "(", "defaultUseProxyProperties", "(", "))", "{", "@", "@", "-", "234", ",", "4", "+", "235", ",", "9", "@", "@", "public", "AsyncHttpClientConfigBean", "setIoThreadMultiplier", "(", "int", "ioThreadMultiplier", ")", "{", "this", ".", "ioThreadMultiplier", "=", "ioThreadMultiplier", ";", "return", "this", ";", "}", "public", "AsyncHttpClientConfigBean", "setAcceptAnyCertificate", "(", "boolean", "acceptAnyCertificate", ")", "{", "this", ".", "acceptAnyCertificate", "=", "acceptAnyCertificate", ";", "return", "this", ";", "}", "}", "@", "@", "-", "133", ",", "4", "+", "133", ",", "8", "@", "@", "public", "static", "int", "defaultSpdyInitialWindowSize", "(", ")", "{", "public", "static", "int", "defaultSpdyMaxConcurrentStreams", "(", ")", "{", "return", "Integer", ".", "getInteger", "(", "ASYNC_CLIENT", "+", "\"", "spdyMaxConcurrentStreams", "\"", ",", "100", ")", ";", "}", "public", "static", "boolean", "defaultAcceptAnyCertificate", "(", ")", "{", "return", "getBoolean", "(", "ASYNC_CLIENT", "+", "\"", "acceptAnyCertificate", "\"", ",", "false", ")", ";", "}", "}", "@", "@", "-", "678", ",", "6", "+", "678", ",", "11", "@", "@", "public", "Builder", "setProviderClass", "(", "String", "providerClass", ")", "{", "return", "this", ";", "}", "public", "Builder", "setAcceptAnyCertificate", "(", "boolean", "acceptAnyCertificate", ")", "{", "configBuilder", ".", "setAcceptAnyCertificate", "(", "acceptAnyCertificate", ")", ";", "return", "this", ";", "}", "public", "SimpleAsyncHttpClient", "build", "(", ")", "{", "if", "(", "realmBuilder", "!", "=", "null", ")", "{", "@", "@", "-", "44", ",", "4", "+", "44", ",", "8", "@", "@", "public", "static", "boolean", "getBoolean", "(", "String", "systemPropName", ",", "boolean", "defaultValue", ")", "{", "String", "systemPropValue", "=", "System", ".", "getProperty", "(", "systemPropName", ")", ";", "return", "systemPropValue", "!", "=", "null", "?", "systemPropValue", ".", "equalsIgnoreCase", "(", "\"", "true", "\"", ")", ":", "defaultValue", ";", "}", "public", "static", "<", "T", ">", "T", "withDefault", "(", "T", "value", ",", "T", "defaults", ")", "{", "return", "value", "!", "=", "null", "?", "value", ":", "value", ";", "}", "}", "@", "@", "-", "16", ",", "14", "+", "16", ",", "47", "@", "@", "package", "org", ".", "asynchttpclient", ".", "util", ";", "import", "javax", ".", "net", ".", "ssl", ".", "SSLContext", ";", "import", "javax", ".", "net", ".", "ssl", ".", "TrustManager", ";", "import", "javax", ".", "net", ".", "ssl", ".", "X509TrustManager", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "security", ".", "GeneralSecurityException", ";", "import", "java", ".", "security", ".", "KeyManagementException", ";", "import", "java", ".", "security", ".", "NoSuchAlgorithmException", ";", "import", "java", ".", "security", ".", "SecureRandom", ";", "/", "**", "*", "This", "class", "is", "a", "copy", "of", "http", ":", "//", "github", ".", "com", "/", "sonatype", "/", "wagon", "-", "ning", "/", "raw", "/", "master", "/", "src", "/", "main", "/", "java", "/", "org", "/", "apache", "/", "maven", "/", "wagon", "/", "providers", "/", "http", "/", "SslUtils", ".", "java", "*", "/", "public", "class", "SslUtils", "{", "static", "class", "LooseTrustManager", "implements", "X509TrustManager", "{", "public", "java", ".", "security", ".", "cert", ".", "X509Certificate", "[", "]", "getAcceptedIssuers", "(", ")", "{", "return", "new", "java", ".", "security", ".", "cert", ".", "X509Certificate", "[", "0", "]", ";", "}", "public", "void", "checkClientTrusted", "(", "java", ".", "security", ".", "cert", ".", "X509Certificate", "[", "]", "certs", ",", "String", "authType", ")", "{", "}", "public", "void", "checkServerTrusted", "(", "java", ".", "security", ".", "cert", ".", "X509Certificate", "[", "]", "certs", ",", "String", "authType", ")", "{", "}", "}", "private", "SSLContext", "looseTrustManagerSSLContext", "=", "looseTrustManagerSSLContext", "(", ");", "private", "SSLContext", "looseTrustManagerSSLContext", "(", ")", "{", "try", "{", "SSLContext", "sslContext", "=", "SSLContext", ".", "getInstance", "(", "\"", "TLS", "\"", ");", "sslContext", ".", "init", "(", "null", ",", "new", "TrustManager", "[", "]", "{", "new", "LooseTrustManager", "(", ")", "}", ",", "new", "SecureRandom", "(", "))", ";", "return", "sslContext", ";", "}", "catch", "(", "NoSuchAlgorithmException", "e", ")", "{", "throw", "new", "ExceptionInInitializerError", "(", "e", ")", ";", "}", "catch", "(", "KeyManagementException", "e", ")", "{", "throw", "new", "ExceptionInInitializerError", "(", "e", ")", ";", "}", "}", "private", "static", "class", "SingletonHolder", "{", "public", "static", "final", "SslUtils", "instance", "=", "new", "SslUtils", "(", ");", "}", "@", "@", "-", "32", ",", "7", "+", "65", ",", "7", "@", "@", "public", "static", "SslUtils", "getInstance", "(", ")", "{", "return", "SingletonHolder", ".", "instance", ";", "}", "public", "SSLContext", "getSSLContext", "(", ")", "throws", "GeneralSecurityException", ",", "IOException", "{", "return", "SSLContext", ".", "getDefault", "(", ");", "public", "SSLContext", "getSSLContext", "(", "boolean", "acceptAnyCertificate", ")", "throws", "GeneralSecurityException", ",", "IOException", "{", "return", "acceptAnyCertificate", "?", "looseTrustManagerSSLContext", ":", "SSLContext", ".", "getDefault", "(", ");", "}", "}", "@", "@", "-", "96", ",", "7", "+", "96", ",", "11", "@", "@", "public", "void", "runAllSequentiallyBecauseNotThreadSafe", "(", ")", "throws", "Exception", "{", "public", "void", "httpToHttpsRedirect", "(", ")", "throws", "Exception", "{", "redirectDone", ".", "getAndSet", "(", "false", ")", ";", "AsyncHttpClientConfig", "cg", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ").", "setMaxRedirects", "(", "5", ")", ".", "setFollowRedirects", "(", "true", ")", ".", "build", "(", ");", "AsyncHttpClientConfig", "cg", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ")/", "/", ".", "setMaxRedirects", "(", "5", ")", "//", ".", "setFollowRedirects", "(", "true", ")", "//", ".", "setAcceptAnyCertificate", "(", "true", ")", "//", ".", "build", "(", ");", "AsyncHttpClient", "c", "=", "getAsyncHttpClient", "(", "cg", ")", ";", "try", "{", "Response", "response", "=", "c", ".", "prepareGet", "(", "getTargetUrl", "(", "))", ".", "setHeader", "(", "\"", "X", "-", "redirect", "\"", ",", "getTargetUrl2", "(", "))", ".", "execute", "(", ").", "get", "(", ");", "@", "@", "-", "112", ",", "7", "+", "116", ",", "11", "@", "@", "public", "void", "httpToHttpsRedirect", "(", ")", "throws", "Exception", "{", "public", "void", "httpToHttpsProperConfig", "(", ")", "throws", "Exception", "{", "redirectDone", ".", "getAndSet", "(", "false", ")", ";", "AsyncHttpClientConfig", "cg", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ").", "setMaxRedirects", "(", "5", ")", ".", "setFollowRedirects", "(", "true", ")", ".", "build", "(", ");", "AsyncHttpClientConfig", "cg", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ")/", "/", ".", "setMaxRedirects", "(", "5", ")", "//", ".", "setFollowRedirects", "(", "true", ")", "//", ".", "setAcceptAnyCertificate", "(", "true", ")", "//", ".", "build", "(", ");", "AsyncHttpClient", "c", "=", "getAsyncHttpClient", "(", "cg", ")", ";", "try", "{", "Response", "response", "=", "c", ".", "prepareGet", "(", "getTargetUrl", "(", "))", ".", "setHeader", "(", "\"", "X", "-", "redirect", "\"", ",", "getTargetUrl2", "(", ")", "+", "\"", "/", "test2", "\"", ").", "execute", "(", ").", "get", "(", ");", "@", "@", "-", "134", ",", "7", "+", "142", ",", "11", "@", "@", "public", "void", "httpToHttpsProperConfig", "(", ")", "throws", "Exception", "{", "public", "void", "relativeLocationUrl", "(", ")", "throws", "Exception", "{", "redirectDone", ".", "getAndSet", "(", "false", ")", ";", "AsyncHttpClientConfig", "cg", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ").", "setMaxRedirects", "(", "5", ")", ".", "setFollowRedirects", "(", "true", ")", ".", "build", "(", ");", "AsyncHttpClientConfig", "cg", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ")/", "/", ".", "setMaxRedirects", "(", "5", ")", "//", ".", "setFollowRedirects", "(", "true", ")", "//", ".", "setAcceptAnyCertificate", "(", "true", ")", "//", ".", "build", "(", ");", "AsyncHttpClient", "c", "=", "getAsyncHttpClient", "(", "cg", ")", ";", "try", "{", "Response", "response", "=", "c", ".", "prepareGet", "(", "getTargetUrl", "(", "))", ".", "setHeader", "(", "\"", "X", "-", "redirect", "\"", ",", "\"", "/", "foo", "/", "test", "\"", ").", "execute", "(", ").", "get", "(", ");", "@", "@", "-", "74", ",", "12", "+", "74", ",", "14", "@", "@", "public", "void", "tearDownGlobal", "(", ")", "throws", "Exception", "{", "@", "Test", "(", "groups", "=", "{", "\"", "online", "\"", ",", "\"", "default_provider", "\"", "}", ")", "public", "void", "testRequestProxy", "(", ")", "throws", "IOException", ",", "InterruptedException", ",", "ExecutionException", ",", "TimeoutException", "{", "AsyncHttpClientConfig", ".", "Builder", "b", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ");", "b", ".", "setFollowRedirects", "(", "true", ")", ";", "ProxyServer", "ps", "=", "new", "ProxyServer", "(", "ProxyServer", ".", "Protocol", ".", "HTTPS", ",", "\"", "127", ".", "0", ".", "0", ".", "1", "\"", ",", "port1", ")", ";", "AsyncHttpClientConfig", "config", "=", "b", ".", "build", "(", ");", "AsyncHttpClientConfig", "config", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ")/", "/", ".", "setFollowRedirects", "(", "true", ")", "//", ".", "setAcceptAnyCertificate", "(", "true", ")", "//", ".", "build", "(", ");", "AsyncHttpClient", "asyncHttpClient", "=", "getAsyncHttpClient", "(", "config", ")", ";", "try", "{", "RequestBuilder", "rb", "=", "new", "RequestBuilder", "(", "\"", "GET", "\"", ").", "setProxyServer", "(", "ps", ")", ".", "setUrl", "(", "getTargetUrl2", "(", "))", ";", "@", "@", "-", "108", ",", "6", "+", "110", ",", "7", "@", "@", "public", "void", "testConfigProxy", "(", ")", "throws", "IOException", ",", "InterruptedException", ",", "Executio", "AsyncHttpClientConfig", "config", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ")/", "/", ".", "setFollowRedirects", "(", "true", ")", "//", ".", "setProxyServer", "(", "new", "ProxyServer", "(", "ProxyServer", ".", "Protocol", ".", "HTTPS", ",", "\"", "127", ".", "0", ".", "0", ".", "1", "\"", ",", "port1", ")", ")/", "/", ".", "setAcceptAnyCertificate", "(", "true", ")", "//", ".", "build", "(", ");", "AsyncHttpClient", "asyncHttpClient", "=", "getAsyncHttpClient", "(", "config", ")", ";", "try", "{", "@", "@", "-", "136", ",", "7", "+", "139", ",", "12", "@", "@", "public", "void", "testSimpleAHCConfigProxy", "(", ")", "throws", "IOException", ",", "InterruptedException", ",", "SimpleAsyncHttpClient", "client", "=", "new", "SimpleAsyncHttpClient", ".", "Builder", "(", ")/", "/", ".", "setProviderClass", "(", "getProviderClass", "(", "))", "//", ".", "setProxyProtocol", "(", "ProxyServer", ".", "Protocol", ".", "HTTPS", ")", ".", "setProxyHost", "(", "\"", "127", ".", "0", ".", "0", ".", "1", "\"", ").", "setProxyPort", "(", "port1", ")", ".", "setFollowRedirects", "(", "true", ")", ".", "setUrl", "(", "getTargetUrl2", "(", "))", "//", ".", "setProxyProtocol", "(", "ProxyServer", ".", "Protocol", ".", "HTTPS", ")", "//", ".", "setProxyHost", "(", "\"", "127", ".", "0", ".", "0", ".", "1", "\"", ")/", "/", ".", "setProxyPort", "(", "port1", ")", "//", ".", "setFollowRedirects", "(", "true", ")", "//", ".", "setUrl", "(", "getTargetUrl2", "(", "))", "//", ".", "setAcceptAnyCertificate", "(", "true", ")", "//", ".", "setHeader", "(", "\"", "Content", "-", "Type", "\"", ",", "\"", "text", "/", "html", "\"", ")/", "/", ".", "build", "(", ");", "try", "{", "@", "@", "-", "78", ",", "7", "+", "78", ",", "7", "@", "@", "protected", "String", "getTargetUrl", "(", ")", "{", "public", "void", "echoText", "(", ")", "throws", "Exception", "{", "ProxyServer", "ps", "=", "new", "ProxyServer", "(", "ProxyServer", ".", "Protocol", ".", "HTTPS", ",", "\"", "127", ".", "0", ".", "0", ".", "1", "\"", ",", "port1", ")", ";", "AsyncHttpClientConfig", "config", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ").", "setProxyServer", "(", "ps", ")", ".", "build", "(", ");", "AsyncHttpClientConfig", "config", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ").", "setProxyServer", "(", "ps", ")", ".", "setAcceptAnyCertificate", "(", "true", ")", ".", "build", "(", ");", "AsyncHttpClient", "asyncHttpClient", "=", "getAsyncHttpClient", "(", "config", ")", ";", "try", "{", "final", "CountDownLatch", "latch", "=", "new", "CountDownLatch", "(", "1", ")", ";", "@", "@", "-", "253", ",", "7", "+", "253", ",", "7", "@", "@", "public", "void", "onTimeout", "(", "Connection", "connection", ")", "{", "SSLContext", "context", "=", "clientConfig", ".", "getSSLContext", "(", ");", "if", "(", "context", "=", "=", "null", ")", "{", "try", "{", "context", "=", "SslUtils", ".", "getInstance", "(", ").", "getSSLContext", "(", ");", "context", "=", "SslUtils", ".", "getInstance", "(", ").", "getSSLContext", "(", "clientConfig", ".", "isAcceptAnyCertificate", "(", "))", ";", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "new", "IllegalStateException", "(", "e", ")", ";", "}", "@", "@", "-", "138", ",", "6", "+", "138", ",", "7", "@", "@", "private", "void", "doSimpleFeeder", "(", "final", "boolean", "secure", ")", "{", "AsyncHttpClientConfig", "config", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ")", ".", "setMaxConnectionsPerHost", "(", "60", ")", ".", "setMaxConnectionsTotal", "(", "60", ")", ".", "setAcceptAnyCertificate", "(", "true", ")", ".", "build", "(", ");", "final", "AsyncHttpClient", "client", "=", "new", "DefaultAsyncHttpClient", "(", "new", "GrizzlyAsyncHttpProvider", "(", "config", ")", ",", "config", ")", ";", "@", "@", "-", "240", ",", "6", "+", "241", ",", "7", "@", "@", "private", "void", "doNonBlockingFeeder", "(", "final", "boolean", "secure", ")", "{", "AsyncHttpClientConfig", "config", "=", "new", "AsyncHttpClientConfig", ".", "Builder", "(", ")", ".", "setMaxConnectionsPerHost", "(", "60", ")", ".", "setMaxConnectionsTotal", "(", "60", ")", ".", "setAcceptAnyCertificate", "(", "true", ")", ".", "build", "(", ");", "final", "AsyncHttpClient", "client", "=", "new", "DefaultAsyncHttpClient", "(", "new", "GrizzlyAsyncHttpProvider", "(", "config", ")", ",", "config", ")", ";", "@", "@", "-", "209", ",", "10", "+", "209", ",", "9", "@", "@", "private", "SSLEngine", "createSSLEngine", "(", ")", "throws", "IOException", ",", "GeneralSecurityException", "}", "else", "{", "SSLContext", "sslContext", "=", "config", ".", "getSSLContext", "(", ");", "if", "(", "sslContext", "=", "=", "null", ")", "{", "sslContext", "=", "SslUtils", ".", "getInstance", "(", ").", "getSSLContext", "(", ");", "}", "if", "(", "sslContext", "=", "=", "null", ")", "sslContext", "=", "SslUtils", ".", "getInstance", "(", ").", "getSSLContext", "(", "config", ".", "isAcceptAnyCertificate", "(", "))", ";", "SSLEngine", "sslEngine", "=", "sslContext", ".", "createSSLEngine", "(", ");", "sslEngine", ".", "setUseClientMode", "(", "true", ")", ";", "return", "sslEngine", ";"], "docstring_tokens": ["an", "unexpected/improper", "decision", "process"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "24", ",", "6", "+", "24", ",", "13", "@", "@", "*", "Information", "about", "the", "sync", "operation", "that", "is", "currently", "underway", ".", "*", "/", "public", "class", "SyncInfo", "implements", "Parcelable", "{", "/", "**", "*", "Used", "when", "the", "caller", "receiving", "this", "object", "doesn", "'", "t", "have", "permission", "to", "access", "the", "accounts", "*", "on", "device", ".", "*", "@", "See", "Manifest", ".", "permission", ".", "GET_ACCOUNTS", "*", "/", "private", "static", "final", "Account", "REDACTED_ACCOUNT", "=", "new", "Account", "(", "\"*", "**", "**", "\",", "\"", "**", "**", "*\"", ");", "/", "**", "@", "hide", "*", "/", "public", "final", "int", "authorityId", ";", "@", "@", "-", "44", ",", "6", "+", "51", ",", "17", "@", "@", "*", "/", "public", "final", "long", "startTime", ";", "/", "**", "*", "Creates", "a", "SyncInfo", "object", "with", "an", "unusable", "Account", ".", "Used", "when", "the", "caller", "receiving", "this", "*", "object", "doesn", "'", "t", "have", "access", "to", "the", "accounts", "on", "the", "device", ".", "*", "@", "See", "Manifest", ".", "permission", ".", "GET_ACCOUNTS", "*", "@", "hide", "*", "/", "public", "static", "SyncInfo", "createAccountRedacted", "(", "int", "authorityId", ",", "String", "authority", ",", "long", "startTime", ")", "{", "return", "new", "SyncInfo", "(", "authorityId", ",", "REDACTED_ACCOUNT", ",", "authority", ",", "startTime", ")", ";", "}", "/", "**", "@", "hide", "*", "/", "public", "SyncInfo", "(", "int", "authorityId", ",", "Account", "account", ",", "String", "authority", ",", "long", "startTime", ")", "{", "this", ".", "authorityId", "=", "authorityId", ";", "@", "@", "-", "772", ",", "9", "+", "772", ",", "13", "@", "@", "public", "boolean", "isSyncActive", "(", "Account", "account", ",", "String", "authority", ",", "ComponentName", "cna", "mContext", ".", "enforceCallingOrSelfPermission", "(", "Manifest", ".", "permission", ".", "READ_SYNC_STATS", ",", "\"", "no", "permission", "to", "read", "the", "sync", "stats", "\"", ");", "final", "boolean", "canAccessAccounts", "=", "mContext", ".", "checkCallingOrSelfPermission", "(", "Manifest", ".", "permission", ".", "GET_ACCOUNTS", ")", "=", "=", "PackageManager", ".", "PERMISSION_GRANTED", ";", "long", "identityToken", "=", "clearCallingIdentity", "(", ");", "try", "{", "return", "getSyncManager", "(", ").", "getSyncStorageEngine", "(", ").", "getCurrentSyncsCopy", "(", "userId", ")", ";", "return", "getSyncManager", "(", ").", "getSyncStorageEngine", "(", ")", ".", "getCurrentSyncsCopy", "(", "userId", ",", "canAccessAccounts", ")", ";", "}", "finally", "{", "restoreCallingIdentity", "(", "identityToken", ")", ";", "}", "@", "@", "-", "1426", ",", "15", "+", "1426", ",", "23", "@", "@", "public", "void", "stopSyncEvent", "(", "long", "historyId", ",", "long", "elapsedTime", ",", "String", "resultMessage", "}", "/", "**", "*", "@", "return", "a", "copy", "of", "the", "current", "syncs", "data", "structure", ".", "Will", "not", "return", "*", "null", ".", "*", "@", "param", "userId", "Id", "of", "user", "to", "return", "current", "sync", "info", ".", "*", "@", "param", "canAccessAccounts", "Determines", "whether", "to", "redact", "Account", "information", "from", "the", "result", ".", "*", "@", "return", "a", "copy", "of", "the", "current", "syncs", "data", "structure", ".", "Will", "not", "return", "null", ".", "*", "/", "public", "List", "<", "SyncInfo", ">", "getCurrentSyncsCopy", "(", "int", "userId", ")", "{", "public", "List", "<", "SyncInfo", ">", "getCurrentSyncsCopy", "(", "int", "userId", ",", "boolean", "canAccessAccounts", ")", "{", "synchronized", "(", "mAuthorities", ")", "{", "final", "List", "<", "SyncInfo", ">", "syncs", "=", "getCurrentSyncsLocked", "(", "userId", ")", ";", "final", "List", "<", "SyncInfo", ">", "syncsCopy", "=", "new", "ArrayList", "<", "SyncInfo", ">", "()", ";", "for", "(", "SyncInfo", "sync", ":", "syncs", ")", "{", "syncsCopy", ".", "add", "(", "new", "SyncInfo", "(", "sync", ")", ");", "SyncInfo", "copy", ";", "if", "(", "!", "canAccessAccounts", ")", "{", "copy", "=", "SyncInfo", ".", "createAccountRedacted", "(", "sync", ".", "authorityId", ",", "sync", ".", "authority", ",", "sync", ".", "startTime", ")", ";", "}", "else", "{", "copy", "=", "new", "SyncInfo", "(", "sync", ")", ";", "}", "syncsCopy", ".", "add", "(", "copy", ")", ";", "}", "return", "syncsCopy", ";", "}"], "docstring_tokens": ["does", "not", "check", "for", "a", "GET_ACCOUNTS", "permission"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "17", ",", "6", "+", "17", ",", "7", "@", "@", "#", "include", "<", "linux", "/", "kernel", ".", "h", ">", "#", "include", "<", "linux", "/", "module", ".", "h", ">", "#", "include", "<", "linux", "/", "slab", ".", "h", ">", "#", "include", "<", "linux", "/", "crypto", ".", "h", ">", "#", "include", "<", "asm", "/", "i387", ".", "h", ">", "struct", "crypto_fpu_ctx", "{", "@", "@", "-", "159", ",", "3", "+", "160", ",", "5", "@", "@", "void", "__exit", "crypto_fpu_exit", "(", "void", ")", "{", "crypto_unregister_template", "(", "&", "crypto_fpu_tmpl", ")", ";", "}", "MODULE_ALIAS_CRYPTO", "(", "\"", "fpu", "\"", ");", "@", "@", "-", "509", ",", "8", "+", "509", ",", "8", "@", "@", "static", "struct", "crypto_template", "*", "__crypto_lookup_template", "(", "const", "char", "*", "name", ")", "struct", "crypto_template", "*", "crypto_lookup_template", "(", "const", "char", "*", "name", ")", "{", "return", "try_then_request_module", "(", "__crypto_lookup_template", "(", "name", ")", ",", "\"", "%", "s", "\"", ",", "name", ")", ";", "return", "try_then_request_module", "(", "__crypto_lookup_template", "(", "name", ")", ",", "\"", "crypto", "-", "%", "s", "\"", ",", "name", ")", ";", "}", "EXPORT_SYMBOL_GPL", "(", "crypto_lookup_template", ")", ";", "@", "@", "-", "721", ",", "3", "+", "721", ",", "4", "@", "@", "module_exit", "(", "crypto_authenc_module_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "Simple", "AEAD", "wrapper", "for", "IPsec", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "authenc", "\"", ");", "@", "@", "-", "814", ",", "3", "+", "814", ",", "4", "@", "@", "module_exit", "(", "crypto_authenc_esn_module_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_AUTHOR", "(", "\"", "Steffen", "Klassert", "<", "steffen", ".", "klassert", "@", "secunet", ".", "com", ">", "\")", ";", "MODULE_DESCRIPTION", "(", "\"", "AEAD", "wrapper", "for", "IPsec", "with", "extended", "sequence", "numbers", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "authencesn", "\"", ");", "@", "@", "-", "289", ",", "3", "+", "289", ",", "4", "@", "@", "module_exit", "(", "crypto_cbc_module_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "CBC", "block", "cipher", "algorithm", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "cbc", "\"", ");", "@", "@", "-", "881", ",", "3", "+", "881", ",", "4", "@", "@", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "Counter", "with", "CBC", "MAC", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "ccm_base", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "rfc4309", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "ccm", "\"", ");", "@", "@", "-", "359", ",", "3", "+", "359", ",", "4", "@", "@", "module_exit", "(", "chainiv_module_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "Chain", "IV", "Generator", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "chainiv", "\"", ");", "@", "@", "-", "313", ",", "3", "+", "313", ",", "4", "@", "@", "module_exit", "(", "crypto_cmac_module_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "CMAC", "keyed", "hash", "algorithm", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "cmac", "\"", ");", "@", "@", "-", "955", ",", "3", "+", "955", ",", "4", "@", "@", "module_exit", "(", "cryptd_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "Software", "async", "crypto", "daemon", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "cryptd", "\"", ");", "@", "@", "-", "467", ",", "3", "+", "467", ",", "4", "@", "@", "module_exit", "(", "crypto_ctr_module_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "CTR", "Counter", "block", "mode", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "rfc3686", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "ctr", "\"", ");", "@", "@", "-", "351", ",", "3", "+", "351", ",", "4", "@", "@", "module_exit", "(", "crypto_cts_module_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "Dual", "BSD", "/", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "CTS", "-", "CBC", "CipherText", "Stealing", "for", "CBC", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "cts", "\"", ");", "@", "@", "-", "185", ",", "3", "+", "185", ",", "4", "@", "@", "module_exit", "(", "crypto_ecb_module_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "ECB", "block", "cipher", "algorithm", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "ecb", "\"", ");", "@", "@", "-", "267", ",", "3", "+", "267", ",", "4", "@", "@", "module_exit", "(", "eseqiv_module_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "Encrypted", "Sequence", "Number", "IV", "Generator", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "eseqiv", "\"", ");", "@", "@", "-", "1444", ",", "3", "+", "1444", ",", "4", "@", "@", "MODULE_AUTHOR", "(", "\"", "Mikko", "Herranen", "<", "mh1", "@", "iki", ".", "fi", ">", "\")", ";", "MODULE_ALIAS_CRYPTO", "(", "\"", "gcm_base", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "rfc4106", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "rfc4543", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "gcm", "\"", ");", "@", "@", "-", "268", ",", "3", "+", "268", ",", "4", "@", "@", "module_exit", "(", "hmac_module_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "HMAC", "hash", "algorithm", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "hmac", "\"", ");", "@", "@", "-", "400", ",", "3", "+", "400", ",", "4", "@", "@", "module_exit", "(", "crypto_module_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "LRW", "block", "cipher", "mode", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "lrw", "\"", ");", "@", "@", "-", "703", ",", "3", "+", "703", ",", "4", "@", "@", "module_exit", "(", "mcryptd_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "Software", "async", "multibuffer", "crypto", "daemon", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "mcryptd", "\"", ");", "@", "@", "-", "295", ",", "3", "+", "295", ",", "4", "@", "@", "module_exit", "(", "crypto_pcbc_module_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "PCBC", "block", "cipher", "algorithm", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "pcbc", "\"", ");", "@", "@", "-", "565", ",", "3", "+", "565", ",", "4", "@", "@", "module_exit", "(", "pcrypt_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_AUTHOR", "(", "\"", "Steffen", "Klassert", "<", "steffen", ".", "klassert", "@", "secunet", ".", "com", ">", "\")", ";", "MODULE_DESCRIPTION", "(", "\"", "Parallel", "crypto", "wrapper", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "pcrypt", "\"", ");", "@", "@", "-", "362", ",", "3", "+", "362", ",", "4", "@", "@", "module_exit", "(", "seqiv_module_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "Sequence", "Number", "IV", "Generator", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "seqiv", "\"", ");", "@", "@", "-", "713", ",", "3", "+", "713", ",", "4", "@", "@", "module_exit", "(", "vmac_module_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "VMAC", "hash", "algorithm", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "vmac", "\"", ");", "@", "@", "-", "286", ",", "3", "+", "286", ",", "4", "@", "@", "module_exit", "(", "crypto_xcbc_module_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "XCBC", "keyed", "hash", "algorithm", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "xcbc", "\"", ");", "@", "@", "-", "362", ",", "3", "+", "362", ",", "4", "@", "@", "module_exit", "(", "crypto_module_exit", ")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "MODULE_DESCRIPTION", "(", "\"", "XTS", "block", "cipher", "mode", "\"", ");", "MODULE_ALIAS_CRYPTO", "(", "\"", "xts", "\"", ");"], "docstring_tokens": ["does", "not", "include", "the", "general", "concepts", "of", "\"making", "things", "safer", "with", "no", "real", "cost", "\"", "and", "\"Allowing", "simple"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "3689", ",", "7", "+", "3689", ",", "7", "@", "@", "iscsi_if_rx", "(", "struct", "sk_buff", "*", "skb", ")", "uint32_t", "group", ";", "nlh", "=", "nlmsg_hdr", "(", "skb", ")", ";", "if", "(", "nlh", "-", ">", "nlmsg_len", "<", "sizeof", "(", "*", "nlh", ")", "|", "|", "if", "(", "nlh", "-", ">", "nlmsg_len", "<", "sizeof", "(", "*", "nlh", ")", "+", "sizeof", "(", "*", "ev", ")", "|", "|", "skb", "-", ">", "len", "<", "nlh", "-", ">", "nlmsg_len", ")", "{", "break", ";", "}"], "docstring_tokens": ["incorrect", "length", "validation", "in", "the", "kernel", "code"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "210", ",", "8", "+", "210", ",", "16", "@", "@", "public", "void", "start", "(", ")", "throws", "Exception", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_AUTHENTICATION", ",", "\"", "none", "\"", ");", "}", "else", "{", "LOG", ".", "debug", "(", "\"", "login", "credentials", "[", "{}", ":*", "**", "**", "*]", "\",", "user", ")", ";", "env", ".", "put", "(", "Context", ".", "SECURITY_PRINCIPAL", ",", "user", ")", ";", "env", ".", "put", "(", "Context", ".", "SECURITY_CREDENTIALS", ",", "password", ")", ";", "if", "(", "user", "!", "=", "null", "&", "&", "!", "\"\"", ".", "equals", "(", "user", ")", ")", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_PRINCIPAL", ",", "user", ")", ";", "}", "else", "{", "throw", "new", "Exception", "(", "\"", "Empty", "username", "is", "not", "allowed", "\"", ");", "}", "if", "(", "password", "!", "=", "null", "&", "&", "!", "\"\"", ".", "equals", "(", "password", ")", ")", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_CREDENTIALS", ",", "password", ")", ";", "}", "else", "{", "throw", "new", "Exception", "(", "\"", "Empty", "password", "is", "not", "allowed", "\"", ");", "}", "}", "boolean", "isConnected", "=", "false", ";", "while", "(", "!", "isConnected", ")", "{", "@", "@", "-", "469", ",", "11", "+", "469", ",", "15", "@", "@", "protected", "DirContext", "open", "(", ")", "throws", "NamingException", "{", "try", "{", "Hashtable", "<", "String", ",", "String", ">", "env", "=", "new", "Hashtable", "<", "String", ",", "String", ">", "()", ";", "env", ".", "put", "(", "Context", ".", "INITIAL_CONTEXT_FACTORY", ",", "initialContextFactory", ")", ";", "if", "(", "connectionUsername", "!", "=", "null", "|", "|", "!", "\"\"", ".", "equals", "(", "connectionUsername", ")", ")", "{", "if", "(", "connectionUsername", "!", "=", "null", "&", "&", "!", "\"\"", ".", "equals", "(", "connectionUsername", ")", ")", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_PRINCIPAL", ",", "connectionUsername", ")", ";", "}", "else", "{", "throw", "new", "NamingException", "(", "\"", "Empty", "username", "is", "not", "allowed", "\"", ");", "}", "if", "(", "connectionPassword", "!", "=", "null", "|", "|", "!", "\"\"", ".", "equals", "(", "connectionPassword", ")", ")", "{", "if", "(", "connectionPassword", "!", "=", "null", "&", "&", "!", "\"\"", ".", "equals", "(", "connectionPassword", ")", ")", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_CREDENTIALS", ",", "connectionPassword", ")", ";", "}", "else", "{", "throw", "new", "NamingException", "(", "\"", "Empty", "password", "is", "not", "allowed", "\"", ");", "}", "env", ".", "put", "(", "Context", ".", "SECURITY_PROTOCOL", ",", "connectionProtocol", ")", ";", "env", ".", "put", "(", "Context", ".", "PROVIDER_URL", ",", "connectionURL", ")", ";", "@", "@", "-", "125", ",", "11", "+", "125", ",", "15", "@", "@", "public", "Thread", "newThread", "(", "Runnable", "r", ")", "{", "protected", "DirContext", "createContext", "(", ")", "throws", "NamingException", "{", "Hashtable", "<", "String", ",", "String", ">", "env", "=", "new", "Hashtable", "<", "String", ",", "String", ">", "()", ";", "env", ".", "put", "(", "Context", ".", "INITIAL_CONTEXT_FACTORY", ",", "initialContextFactory", ")", ";", "if", "(", "connectionUsername", "!", "=", "null", "|", "|", "!", "\"\"", ".", "equals", "(", "connectionUsername", ")", ")", "{", "if", "(", "connectionUsername", "!", "=", "null", "&", "&", "!", "\"\"", ".", "equals", "(", "connectionUsername", ")", ")", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_PRINCIPAL", ",", "connectionUsername", ")", ";", "}", "else", "{", "throw", "new", "NamingException", "(", "\"", "Empty", "username", "is", "not", "allowed", "\"", ");", "}", "if", "(", "connectionPassword", "!", "=", "null", "|", "|", "!", "\"\"", ".", "equals", "(", "connectionPassword", ")", ")", "{", "if", "(", "connectionPassword", "!", "=", "null", "&", "&", "!", "\"\"", ".", "equals", "(", "connectionPassword", ")", ")", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_CREDENTIALS", ",", "connectionPassword", ")", ";", "}", "else", "{", "throw", "new", "NamingException", "(", "\"", "Empty", "password", "is", "not", "allowed", "\"", ");", "}", "env", ".", "put", "(", "Context", ".", "SECURITY_PROTOCOL", ",", "connectionProtocol", ")", ";", "env", ".", "put", "(", "Context", ".", "PROVIDER_URL", ",", "connectionURL", ")", ";", "@", "@", "-", "190", ",", "7", "+", "190", ",", "7", "@", "@", "protected", "boolean", "authenticate", "(", "String", "username", ",", "String", "password", ")", "throws", "LoginExc", "try", "{", "String", "filter", "=", "userSearchMatchingFormat", ".", "format", "(", "new", "String", "[", "]", "{", "username", "doRFC2254Encoding", "(", "username", ")", "}", ");", "SearchControls", "constraints", "=", "new", "SearchControls", "(", ");", "if", "(", "userSearchSubtreeBool", ")", "{", "@", "@", "-", "319", ",", "7", "+", "319", ",", "7", "@", "@", "protected", "boolean", "authenticate", "(", "String", "username", ",", "String", "password", ")", "throws", "LoginExc", "return", "list", ";", "}", "String", "filter", "=", "roleSearchMatchingFormat", ".", "format", "(", "new", "String", "[", "]", "{", "doRFC2254Encoding", "(", "dn", ")", ",", "username", "doRFC2254Encoding", "(", "dn", ")", ",", "doRFC2254Encoding", "(", "username", ")", "}", ");", "SearchControls", "constraints", "=", "new", "SearchControls", "(", ");", "@", "@", "-", "459", ",", "9", "+", "459", ",", "14", "@", "@", "protected", "DirContext", "open", "(", ")", "throws", "NamingException", "{", "env", ".", "put", "(", "Context", ".", "INITIAL_CONTEXT_FACTORY", ",", "getLDAPPropertyValue", "(", "INITIAL_CONTEXT_FACTORY", ")", ");", "if", "(", "isLoginPropertySet", "(", "CONNECTION_USERNAME", ")", ")", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_PRINCIPAL", ",", "getLDAPPropertyValue", "(", "CONNECTION_USERNAME", ")", ");", "}", "else", "{", "throw", "new", "NamingException", "(", "\"", "Empty", "username", "is", "not", "allowed", "\"", ");", "}", "if", "(", "isLoginPropertySet", "(", "CONNECTION_PASSWORD", ")", ")", "{", "env", ".", "put", "(", "Context", ".", "SECURITY_CREDENTIALS", ",", "getLDAPPropertyValue", "(", "CONNECTION_PASSWORD", ")", ");", "}", "else", "{", "throw", "new", "NamingException", "(", "\"", "Empty", "password", "is", "not", "allowed", "\"", ");", "}", "env", ".", "put", "(", "Context", ".", "SECURITY_PROTOCOL", ",", "getLDAPPropertyValue", "(", "CONNECTION_PROTOCOL", ")", ");", "env", ".", "put", "(", "Context", ".", "PROVIDER_URL", ",", "getLDAPPropertyValue", "(", "CONNECTION_URL", ")", ");", "@", "@", "-", "484", ",", "7", "+", "489", ",", "7", "@", "@", "private", "String", "getLDAPPropertyValue", "(", "String", "propertyName", ")", "{", "private", "boolean", "isLoginPropertySet", "(", "String", "propertyName", ")", "{", "for", "(", "int", "i", "=", "0", ";", "i", "<", "config", ".", "length", ";", "i", "+", "+", ")", "{", "if", "(", "config", "[", "i", "]", ".", "getPropertyName", "(", ")", "=", "=", "propertyName", "&", "&", "config", "[", "i", "]", ".", "getPropertyValue", "(", ")", "!", "=", "null", ")", "if", "(", "config", "[", "i", "]", ".", "getPropertyName", "(", ")", "=", "=", "propertyName", "&", "&", "(", "config", "[", "i", "]", ".", "getPropertyValue", "(", ")", "!", "=", "null", "&", "&", "!", "\"\"", ".", "equals", "(", "config", "[", "i", "]", ".", "getPropertyValue", "(", "))", "))", "return", "true", ";", "}", "return", "false", ";", "@", "@", "-", "41", ",", "7", "+", "41", ",", "9", "@", "@", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "Hashtable", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertTrue", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "fail", ";", "@", "RunWith", "(", "FrameworkRunner", ".", "class", ")", "@", "CreateLdapServer", "(", "transports", "=", "{", "@", "CreateTransport", "(", "protocol", "=", "\"", "LDAP", "\"", ",", "port", "=", "1024", ")", "})", "@", "@", "-", "121", ",", "4", "+", "123", ",", "29", "@", "@", "public", "void", "handle", "(", "Callback", "[", "]", "callbacks", ")", "throws", "IOException", ",", "UnsupportedCallback", "context", ".", "logout", "(", ");", "}", "@", "Test", "public", "void", "testUnauthenticated", "(", ")", "throws", "LoginException", "{", "LoginContext", "context", "=", "new", "LoginContext", "(", "\"", "UnAuthenticatedLDAPLogin", "\"", ",", "new", "CallbackHandler", "(", ")", "{", "public", "void", "handle", "(", "Callback", "[", "]", "callbacks", ")", "throws", "IOException", ",", "UnsupportedCallbackException", "{", "for", "(", "int", "i", "=", "0", ";", "i", "<", "callbacks", ".", "length", ";", "i", "+", "+)", "{", "if", "(", "callbacks", "[", "i", "]", "instanceof", "NameCallback", ")", "{", "(", "(", "NameCallback", ")", "callbacks", "[", "i", "]", ").", "setName", "(", "\"", "first", "\"", ");", "}", "else", "if", "(", "callbacks", "[", "i", "]", "instanceof", "PasswordCallback", ")", "{", "(", "(", "PasswordCallback", ")", "callbacks", "[", "i", "]", ").", "setPassword", "(", "\"", "secret", "\"", ".", "toCharArray", "(", "))", ";", "}", "else", "{", "throw", "new", "UnsupportedCallbackException", "(", "callbacks", "[", "i", "]", ");", "}", "}", "}", "}", ");", "try", "{", "context", ".", "login", "(", ");", "}", "catch", "(", "LoginException", "le", ")", "{", "assertEquals", "(", "le", ".", "getCause", "(", ").", "getMessage", "(", "),", "\"", "Empty", "password", "is", "not", "allowed", "\"", ");", "return", ";", "}", "fail", "(", "\"", "Should", "have", "failed", "authenticating", "\"", ");", "}", "}", "@", "@", "-", "40", ",", "6", "+", "40", ",", "25", "@", "@", "LDAPLogin", "{", ";", "}", ";", "UnAuthenticatedLDAPLogin", "{", "org", ".", "apache", ".", "activemq", ".", "jaas", ".", "LDAPLoginModule", "required", "debug", "=", "true", "initialContextFactory", "=", "com", ".", "sun", ".", "jndi", ".", "ldap", ".", "LdapCtxFactory", "connectionURL", "=", "\"", "ldap", ":", "//", "localhost", ":", "1024", "\"", "connectionUsername", "=", "\"", "uid", "=", "admin", ",", "ou", "=", "system", "\"", "connectionPassword", "=", "\"\"", "connectionProtocol", "=", "s", "authentication", "=", "simple", "userBase", "=", "\"", "ou", "=", "system", "\"", "userSearchMatching", "=", "\"(", "uid", "=", "{", "0", "}", ")\"", "userSearchSubtree", "=", "false", "roleBase", "=", "\"", "ou", "=", "system", "\"", "roleName", "=", "dummyRoleName", "roleSearchMatching", "=", "\"(", "uid", "=", "{", "1", "}", ")\"", "roleSearchSubtree", "=", "false", ";", "}", ";", "ExpandedLDAPLogin", "{", "org", ".", "apache", ".", "activemq", ".", "jaas", ".", "LDAPLoginModule", "required", "debug", "=", "true", "@", "@", "-", "0", ",", "0", "+", "1", ",", "83", "@", "@", "/", "**", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "activemq", ".", "security", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "fail", ";", "import", "javax", ".", "jms", ".", "Connection", ";", "import", "javax", ".", "jms", ".", "Destination", ";", "import", "javax", ".", "jms", ".", "JMSException", ";", "import", "javax", ".", "jms", ".", "Message", ";", "import", "javax", ".", "jms", ".", "MessageConsumer", ";", "import", "javax", ".", "jms", ".", "MessageProducer", ";", "import", "javax", ".", "jms", ".", "Queue", ";", "import", "javax", ".", "jms", ".", "Session", ";", "import", "org", ".", "apache", ".", "activemq", ".", "ActiveMQConnectionFactory", ";", "import", "org", ".", "apache", ".", "activemq", ".", "broker", ".", "BrokerFactory", ";", "import", "org", ".", "apache", ".", "activemq", ".", "broker", ".", "BrokerService", ";", "import", "org", ".", "apache", ".", "directory", ".", "server", ".", "annotations", ".", "CreateLdapServer", ";", "import", "org", ".", "apache", ".", "directory", ".", "server", ".", "annotations", ".", "CreateTransport", ";", "import", "org", ".", "apache", ".", "directory", ".", "server", ".", "core", ".", "annotations", ".", "ApplyLdifFiles", ";", "import", "org", ".", "apache", ".", "directory", ".", "server", ".", "core", ".", "integ", ".", "AbstractLdapTestUnit", ";", "import", "org", ".", "apache", ".", "directory", ".", "server", ".", "core", ".", "integ", ".", "FrameworkRunner", ";", "import", "org", ".", "apache", ".", "directory", ".", "server", ".", "ldap", ".", "LdapServer", ";", "import", "org", ".", "junit", ".", "After", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", ";", "@", "RunWith", "(", "FrameworkRunner", ".", "class", ")", "@", "CreateLdapServer", "(", "transports", "=", "{", "@", "CreateTransport", "(", "protocol", "=", "\"", "LDAP", "\"", ",", "port", "=", "1024", ")", "})", "@", "ApplyLdifFiles", "(", "\"", "org", "/", "apache", "/", "activemq", "/", "security", "/", "activemq", ".", "ldif", "\"", ")", "public", "class", "LDAPAuthenticationTest", "extends", "AbstractLdapTestUnit", "{", "public", "BrokerService", "broker", ";", "public", "static", "LdapServer", "ldapServer", ";", "@", "Before", "public", "void", "setup", "(", ")", "throws", "Exception", "{", "System", ".", "setProperty", "(", "\"", "ldapPort", "\"", ",", "String", ".", "valueOf", "(", "getLdapServer", "(", ").", "getPort", "(", "))", ");", "broker", "=", "BrokerFactory", ".", "createBroker", "(", "\"", "xbean", ":", "org", "/", "apache", "/", "activemq", "/", "security", "/", "activemq", "-", "ldap", "-", "auth", ".", "xml", "\"", ");", "broker", ".", "start", "(", ");", "broker", ".", "waitUntilStarted", "(", ");", "}", "@", "After", "public", "void", "shutdown", "(", ")", "throws", "Exception", "{", "broker", ".", "stop", "(", ");", "broker", ".", "waitUntilStopped", "(", ");", "}", "@", "Test", "public", "void", "testWildcard", "(", ")", "throws", "Exception", "{", "ActiveMQConnectionFactory", "factory", "=", "new", "ActiveMQConnectionFactory", "(", "\"", "tcp", ":", "//", "localhost", ":", "61616", "\"", ");", "Connection", "conn", "=", "factory", ".", "createQueueConnection", "(", "\"*", "\",", "\"", "sunflower", "\"", ");", "try", "{", "conn", ".", "createSession", "(", "false", ",", "Session", ".", "AUTO_ACKNOWLEDGE", ")", ";", "}", "catch", "(", "Exception", "e", ")", "{", "e", ".", "printStackTrace", "(", ");", "return", ";", "}", "fail", "(", "\"", "Should", "have", "failed", "connecting", "\"", ");", "}", "}", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "44", ",", "7", "+", "44", ",", "7", "@", "@", "@", "RunWith", "(", "FrameworkRunner", ".", "class", ")", "@", "CreateLdapServer", "(", "transports", "=", "{", "@", "CreateTransport", "(", "protocol", "=", "\"", "LDAP", "\"", ")}", ")", "@", "CreateLdapServer", "(", "transports", "=", "{", "@", "CreateTransport", "(", "protocol", "=", "\"", "LDAP", "\"", ",", "port", "=", "1024", ")", "})", "@", "ApplyLdifFiles", "(", "\"", "org", "/", "apache", "/", "activemq", "/", "security", "/", "activemq", ".", "ldif", "\"", ")", "@", "@", "-", "65", ",", "4", "+", "65", ",", "23", "@", "@", "broker2", "{", "debug", "=", "true", "org", ".", "apache", ".", "activemq", ".", "jaas", ".", "textfiledn", ".", "user", "=", "\"", "org", "/", "apache", "/", "activemq", "/", "security", "/", "users2", ".", "properties", "\"", "org", ".", "apache", ".", "activemq", ".", "jaas", ".", "textfiledn", ".", "group", "=", "\"", "org", "/", "apache", "/", "activemq", "/", "security", "/", "groups", ".", "properties", "\"", ";", "}", ";", "LDAPLogin", "{", "org", ".", "apache", ".", "activemq", ".", "jaas", ".", "LDAPLoginModule", "required", "debug", "=", "true", "initialContextFactory", "=", "com", ".", "sun", ".", "jndi", ".", "ldap", ".", "LdapCtxFactory", "connectionURL", "=", "\"", "ldap", ":", "//", "localhost", ":", "1024", "\"", "connectionUsername", "=", "\"", "uid", "=", "admin", ",", "ou", "=", "system", "\"", "connectionPassword", "=", "secret", "connectionProtocol", "=", "s", "authentication", "=", "simple", "userBase", "=", "\"", "ou", "=", "User", ",", "ou", "=", "ActiveMQ", ",", "ou", "=", "system", "\"", "userSearchMatching", "=", "\"(", "uid", "=", "{", "0", "}", ")\"", "userSearchSubtree", "=", "false", "roleBase", "=", "\"", "ou", "=", "Group", ",", "ou", "=", "ActiveMQ", ",", "ou", "=", "system", "\"", "roleName", "=", "cn", "roleSearchMatching", "=", "\"(", "uid", "=", "{", "1", "}", ")\"", "roleSearchSubtree", "=", "true", ";", "}", ";", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "0", ",", "0", "+", "1", ",", "46", "@", "@", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "?>", "<", "!-", "-", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "limitations", "under", "the", "License", ".", "-", "->", "<", "!-", "-", "START", "SNIPPET", ":", "xbean", "-", "->", "<", "beans", "xmlns", "=", "\"", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "beans", "\"", "xmlns", ":", "amq", "=", "\"", "http", ":", "//", "activemq", ".", "apache", ".", "org", "/", "schema", "/", "core", "\"", "xmlns", ":", "xsi", "=", "\"", "http", ":", "//", "www", ".", "w3", ".", "org", "/", "2001", "/", "XMLSchema", "-", "instance", "\"", "xsi", ":", "schemaLocation", "=", "\"", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "beans", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "beans", "/", "spring", "-", "beans", "-", "2", ".", "0", ".", "xsd", "http", ":", "//", "activemq", ".", "apache", ".", "org", "/", "schema", "/", "core", "http", ":", "//", "activemq", ".", "apache", ".", "org", "/", "schema", "/", "core", "/", "activemq", "-", "core", ".", "xsd", "\"", ">", "<", "bean", "class", "=", "\"", "org", ".", "springframework", ".", "beans", ".", "factory", ".", "config", ".", "PropertyPlaceholderConfigurer", "\"", "/>", "<", "broker", "useJmx", "=", "\"", "false", "\"", "xmlns", "=", "\"", "http", ":", "//", "activemq", ".", "apache", ".", "org", "/", "schema", "/", "core", "\"", "persistent", "=", "\"", "false", "\"", ">", "<", "destinations", ">", "<", "queue", "physicalName", "=", "\"", "ADMIN", ".", "FOO", "\"", "/", ">", "<", "/", "destinations", ">", "<", "plugins", ">", "<", "jaasAuthenticationPlugin", "configuration", "=", "\"", "LDAPLogin", "\"", "/>", "<", "/", "plugins", ">", "<", "transportConnectors", ">", "<", "transportConnector", "uri", "=", "\"", "tcp", ":", "//", "localhost", ":", "61616", "\"", "/>", "<", "/", "transportConnectors", ">", "<", "/", "broker", ">", "<", "/", "beans", ">", "<", "!-", "-", "END", "SNIPPET", ":", "xbean", "-", "->"], "docstring_tokens": ["allows", "wildcard", "operators", "in", "usernames"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "213", ",", "7", "+", "213", ",", "7", "@", "@", "xfs_attr_calc_size", "(", "*", "Out", "of", "line", "attribute", ",", "cannot", "double", "split", ",", "but", "*", "make", "room", "for", "the", "attribute", "value", "itself", ".", "*", "/", "uint", "dblocks", "=", "XFS_B_TO_FSB", "(", "mp", ",", "valuelen", ")", ";", "uint", "dblocks", "=", "xfs_attr3_rmt_blocks", "(", "mp", ",", "valuelen", ")", ";", "nblks", "+", "=", "dblocks", ";", "nblks", "+", "=", "XFS_NEXTENTADD_SPACE_RES", "(", "mp", ",", "dblocks", ",", "XFS_ATTR_FORK", ")", ";", "}", "@", "@", "-", "698", ",", "11", "+", "698", ",", "22", "@", "@", "xfs_attr_leaf_addname", "(", "xfs_da_args_t", "*", "args", ")", "trace_xfs_attr_leaf_replace", "(", "args", ")", ";", "/", "*", "save", "the", "attribute", "state", "for", "later", "removal", "*", "/", "args", "-", ">", "op_flags", "|", "=", "XFS_DA_OP_RENAME", ";", "/", "*", "an", "atomic", "rename", "*", "/", "args", "-", ">", "blkno2", "=", "args", "-", ">", "blkno", ";", "/", "*", "set", "2nd", "entry", "info", "*", "/", "args", "-", ">", "index2", "=", "args", "-", ">", "index", ";", "args", "-", ">", "rmtblkno2", "=", "args", "-", ">", "rmtblkno", ";", "args", "-", ">", "rmtblkcnt2", "=", "args", "-", ">", "rmtblkcnt", ";", "args", "-", ">", "rmtvaluelen2", "=", "args", "-", ">", "rmtvaluelen", ";", "/", "*", "*", "clear", "the", "remote", "attr", "state", "now", "that", "it", "is", "saved", "so", "that", "the", "*", "values", "reflect", "the", "state", "of", "the", "attribute", "we", "are", "about", "to", "*", "add", ",", "not", "the", "attribute", "we", "just", "found", "and", "will", "remove", "later", ".", "*", "/", "args", "-", ">", "rmtblkno", "=", "0", ";", "args", "-", ">", "rmtblkcnt", "=", "0", ";", "args", "-", ">", "rmtvaluelen", "=", "0", ";", "}", "/", "*", "@", "@", "-", "794", ",", "6", "+", "805", ",", "7", "@", "@", "xfs_attr_leaf_addname", "(", "xfs_da_args_t", "*", "args", ")", "args", "-", ">", "blkno", "=", "args", "-", ">", "blkno2", ";", "args", "-", ">", "rmtblkno", "=", "args", "-", ">", "rmtblkno2", ";", "args", "-", ">", "rmtblkcnt", "=", "args", "-", ">", "rmtblkcnt2", ";", "args", "-", ">", "rmtvaluelen", "=", "args", "-", ">", "rmtvaluelen2", ";", "if", "(", "args", "-", ">", "rmtblkno", ")", "{", "error", "=", "xfs_attr_rmtval_remove", "(", "args", ")", ";", "if", "(", "error", ")", "@", "@", "-", "999", ",", "13", "+", "1011", ",", "22", "@", "@", "xfs_attr_node_addname", "(", "xfs_da_args_t", "*", "args", ")", "trace_xfs_attr_node_replace", "(", "args", ")", ";", "/", "*", "save", "the", "attribute", "state", "for", "later", "removal", "*", "/", "args", "-", ">", "op_flags", "|", "=", "XFS_DA_OP_RENAME", ";", "/", "*", "atomic", "rename", "op", "*", "/", "args", "-", ">", "blkno2", "=", "args", "-", ">", "blkno", ";", "/", "*", "set", "2nd", "entry", "info", "*", "/", "args", "-", ">", "index2", "=", "args", "-", ">", "index", ";", "args", "-", ">", "rmtblkno2", "=", "args", "-", ">", "rmtblkno", ";", "args", "-", ">", "rmtblkcnt2", "=", "args", "-", ">", "rmtblkcnt", ";", "args", "-", ">", "rmtvaluelen2", "=", "args", "-", ">", "rmtvaluelen", ";", "/", "*", "*", "clear", "the", "remote", "attr", "state", "now", "that", "it", "is", "saved", "so", "that", "the", "*", "values", "reflect", "the", "state", "of", "the", "attribute", "we", "are", "about", "to", "*", "add", ",", "not", "the", "attribute", "we", "just", "found", "and", "will", "remove", "later", ".", "*", "/", "args", "-", ">", "rmtblkno", "=", "0", ";", "args", "-", ">", "rmtblkcnt", "=", "0", ";", "args", "-", ">", "rmtvaluelen", "=", "0", ";", "}", "retval", "=", "xfs_attr3_leaf_add", "(", "blk", "-", ">", "bp", ",", "state", "-", ">", "args", ")", ";", "@", "@", "-", "1133", ",", "6", "+", "1154", ",", "7", "@", "@", "xfs_attr_node_addname", "(", "xfs_da_args_t", "*", "args", ")", "args", "-", ">", "blkno", "=", "args", "-", ">", "blkno2", ";", "args", "-", ">", "rmtblkno", "=", "args", "-", ">", "rmtblkno2", ";", "args", "-", ">", "rmtblkcnt", "=", "args", "-", ">", "rmtblkcnt2", ";", "args", "-", ">", "rmtvaluelen", "=", "args", "-", ">", "rmtvaluelen2", ";", "if", "(", "args", "-", ">", "rmtblkno", ")", "{", "error", "=", "xfs_attr_rmtval_remove", "(", "args", ")", ";", "if", "(", "error", ")", "@", "@", "-", "1229", ",", "6", "+", "1229", ",", "7", "@", "@", "xfs_attr3_leaf_add_work", "(", "name_rmt", "-", ">", "valueblk", "=", "0", ";", "args", "-", ">", "rmtblkno", "=", "1", ";", "args", "-", ">", "rmtblkcnt", "=", "xfs_attr3_rmt_blocks", "(", "mp", ",", "args", "-", ">", "valuelen", ")", ";", "args", "-", ">", "rmtvaluelen", "=", "args", "-", ">", "valuelen", ";", "}", "xfs_trans_log_buf", "(", "args", "-", ">", "trans", ",", "bp", ",", "XFS_DA_LOGRANGE", "(", "leaf", ",", "xfs_attr3_leaf_name", "(", "leaf", ",", "args", "-", ">", "index", ")", ",", "@", "@", "-", "2167", ",", "11", "+", "2168", ",", "11", "@", "@", "xfs_attr3_leaf_lookup_int", "(", "if", "(", "!", "xfs_attr_namesp_match", "(", "args", "-", ">", "flags", ",", "entry", "-", ">", "flags", ")", ")", "continue", ";", "args", "-", ">", "index", "=", "probe", ";", "args", "-", ">", "valuelen", "=", "be32_to_cpu", "(", "name_rmt", "-", ">", "valuelen", ")", ";", "args", "-", ">", "rmtvaluelen", "=", "be32_to_cpu", "(", "name_rmt", "-", ">", "valuelen", ")", ";", "args", "-", ">", "rmtblkno", "=", "be32_to_cpu", "(", "name_rmt", "-", ">", "valueblk", ")", ";", "args", "-", ">", "rmtblkcnt", "=", "xfs_attr3_rmt_blocks", "(", "args", "-", ">", "dp", "-", ">", "i_mount", ",", "args", "-", ">", "valuelen", ")", ";", "args", "-", ">", "rmtvaluelen", ")", ";", "return", "XFS_ERROR", "(", "EEXIST", ")", ";", "}", "}", "@", "@", "-", "2220", ",", "19", "+", "2221", ",", "19", "@", "@", "xfs_attr3_leaf_getvalue", "(", "name_rmt", "=", "xfs_attr3_leaf_name_remote", "(", "leaf", ",", "args", "-", ">", "index", ")", ";", "ASSERT", "(", "name_rmt", "-", ">", "namelen", "=", "=", "args", "-", ">", "namelen", ")", ";", "ASSERT", "(", "memcmp", "(", "args", "-", ">", "name", ",", "name_rmt", "-", ">", "name", ",", "args", "-", ">", "namelen", ")", "=", "=", "0", ")", ";", "valuelen", "=", "be32_to_cpu", "(", "name_rmt", "-", ">", "valuelen", ")", ";", "args", "-", ">", "rmtvaluelen", "=", "be32_to_cpu", "(", "name_rmt", "-", ">", "valuelen", ")", ";", "args", "-", ">", "rmtblkno", "=", "be32_to_cpu", "(", "name_rmt", "-", ">", "valueblk", ")", ";", "args", "-", ">", "rmtblkcnt", "=", "xfs_attr3_rmt_blocks", "(", "args", "-", ">", "dp", "-", ">", "i_mount", ",", "valuelen", ")", ";", "args", "-", ">", "rmtvaluelen", ")", ";", "if", "(", "args", "-", ">", "flags", "&", "ATTR_KERNOVAL", ")", "{", "args", "-", ">", "valuelen", "=", "valuelen", ";", "args", "-", ">", "valuelen", "=", "args", "-", ">", "rmtvaluelen", ";", "return", "0", ";", "}", "if", "(", "args", "-", ">", "valuelen", "<", "valuelen", ")", "{", "args", "-", ">", "valuelen", "=", "valuelen", ";", "if", "(", "args", "-", ">", "valuelen", "<", "args", "-", ">", "rmtvaluelen", ")", "{", "args", "-", ">", "valuelen", "=", "args", "-", ">", "rmtvaluelen", ";", "return", "XFS_ERROR", "(", "ERANGE", ")", ";", "}", "args", "-", ">", "valuelen", "=", "valuelen", ";", "args", "-", ">", "valuelen", "=", "args", "-", ">", "rmtvaluelen", ";", "}", "return", "0", ";", "}", "@", "@", "-", "2519", ",", "7", "+", "2520", ",", "7", "@", "@", "xfs_attr3_leaf_clearflag", "(", "ASSERT", "(", "(", "entry", "-", ">", "flags", "&", "XFS_ATTR_LOCAL", ")", "=", "=", "0", ")", ";", "name_rmt", "=", "xfs_attr3_leaf_name_remote", "(", "leaf", ",", "args", "-", ">", "index", ")", ";", "name_rmt", "-", ">", "valueblk", "=", "cpu_to_be32", "(", "args", "-", ">", "rmtblkno", ")", ";", "name_rmt", "-", ">", "valuelen", "=", "cpu_to_be32", "(", "args", "-", ">", "valuelen", ")", ";", "name_rmt", "-", ">", "valuelen", "=", "cpu_to_be32", "(", "args", "-", ">", "rmtvaluelen", ")", ";", "xfs_trans_log_buf", "(", "args", "-", ">", "trans", ",", "bp", ",", "XFS_DA_LOGRANGE", "(", "leaf", ",", "name_rmt", ",", "sizeof", "(", "*", "name_rmt", ")", "))", ";", "}", "@", "@", "-", "2677", ",", "7", "+", "2678", ",", "7", "@", "@", "xfs_attr3_leaf_flipflags", "(", "ASSERT", "(", "(", "entry1", "-", ">", "flags", "&", "XFS_ATTR_LOCAL", ")", "=", "=", "0", ")", ";", "name_rmt", "=", "xfs_attr3_leaf_name_remote", "(", "leaf1", ",", "args", "-", ">", "index", ")", ";", "name_rmt", "-", ">", "valueblk", "=", "cpu_to_be32", "(", "args", "-", ">", "rmtblkno", ")", ";", "name_rmt", "-", ">", "valuelen", "=", "cpu_to_be32", "(", "args", "-", ">", "valuelen", ")", ";", "name_rmt", "-", ">", "valuelen", "=", "cpu_to_be32", "(", "args", "-", ">", "rmtvaluelen", ")", ";", "xfs_trans_log_buf", "(", "args", "-", ">", "trans", ",", "bp1", ",", "XFS_DA_LOGRANGE", "(", "leaf1", ",", "name_rmt", ",", "sizeof", "(", "*", "name_rmt", ")", "))", ";", "}", "@", "@", "-", "447", ",", "6", "+", "447", ",", "7", "@", "@", "xfs_attr3_leaf_list_int", "(", "args", ".", "dp", "=", "context", "-", ">", "dp", ";", "args", ".", "whichfork", "=", "XFS_ATTR_FORK", ";", "args", ".", "valuelen", "=", "valuelen", ";", "args", ".", "rmtvaluelen", "=", "valuelen", ";", "args", ".", "value", "=", "kmem_alloc", "(", "valuelen", ",", "KM_SLEEP", "|", "KM_NOFS", ")", ";", "args", ".", "rmtblkno", "=", "be32_to_cpu", "(", "name_rmt", "-", ">", "valueblk", ")", ";", "args", ".", "rmtblkcnt", "=", "xfs_attr3_rmt_blocks", "(", "@", "@", "-", "337", ",", "7", "+", "337", ",", "7", "@", "@", "xfs_attr_rmtval_get", "(", "struct", "xfs_buf", "*", "bp", ";", "xfs_dablk_t", "lblkno", "=", "args", "-", ">", "rmtblkno", ";", "__uint8_t", "*", "dst", "=", "args", "-", ">", "value", ";", "int", "valuelen", "=", "args", "-", ">", "valuelen", ";", "int", "valuelen", ";", "int", "nmap", ";", "int", "error", ";", "int", "blkcnt", "=", "args", "-", ">", "rmtblkcnt", ";", "@", "@", "-", "347", ",", "7", "+", "347", ",", "9", "@", "@", "xfs_attr_rmtval_get", "(", "trace_xfs_attr_rmtval_get", "(", "args", ")", ";", "ASSERT", "(", "!(", "args", "-", ">", "flags", "&", "ATTR_KERNOVAL", ")", ");", "ASSERT", "(", "args", "-", ">", "rmtvaluelen", "=", "=", "args", "-", ">", "valuelen", ")", ";", "valuelen", "=", "args", "-", ">", "rmtvaluelen", ";", "while", "(", "valuelen", ">", "0", ")", "{", "nmap", "=", "ATTR_RMTVALUE_MAPSIZE", ";", "error", "=", "xfs_bmapi_read", "(", "args", "-", ">", "dp", ",", "(", "xfs_fileoff_t", ")", "lblkno", ",", "@", "@", "-", "415", ",", "7", "+", "417", ",", "7", "@", "@", "xfs_attr_rmtval_set", "(", "*", "attributes", "have", "headers", ",", "we", "can", "'", "t", "just", "do", "a", "straight", "byte", "to", "FSB", "*", "conversion", "and", "have", "to", "take", "the", "header", "space", "into", "account", ".", "*", "/", "blkcnt", "=", "xfs_attr3_rmt_blocks", "(", "mp", ",", "args", "-", ">", "valuelen", ")", ";", "blkcnt", "=", "xfs_attr3_rmt_blocks", "(", "mp", ",", "args", "-", ">", "rmtvaluelen", ")", ";", "error", "=", "xfs_bmap_first_unused", "(", "args", "-", ">", "trans", ",", "args", "-", ">", "dp", ",", "blkcnt", ",", "&", "lfileoff", ",", "XFS_ATTR_FORK", ")", ";", "if", "(", "error", ")", "@", "@", "-", "480", ",", "7", "+", "482", ",", "7", "@", "@", "xfs_attr_rmtval_set", "(", "*", "/", "lblkno", "=", "args", "-", ">", "rmtblkno", ";", "blkcnt", "=", "args", "-", ">", "rmtblkcnt", ";", "valuelen", "=", "args", "-", ">", "valuelen", ";", "valuelen", "=", "args", "-", ">", "rmtvaluelen", ";", "while", "(", "valuelen", ">", "0", ")", "{", "struct", "xfs_buf", "*", "bp", ";", "xfs_daddr_t", "dblkno", ";", "@", "@", "-", "60", ",", "10", "+", "60", ",", "12", "@", "@", "typedef", "struct", "xfs_da_args", "{", "int", "index", ";", "/", "*", "index", "of", "attr", "of", "interest", "in", "blk", "*", "/", "xfs_dablk_t", "rmtblkno", ";", "/", "*", "remote", "attr", "value", "starting", "blkno", "*", "/", "int", "rmtblkcnt", ";", "/", "*", "remote", "attr", "value", "block", "count", "*", "/", "int", "rmtvaluelen", ";", "/", "*", "remote", "attr", "value", "length", "in", "bytes", "*", "/", "xfs_dablk_t", "blkno2", ";", "/", "*", "blkno", "of", "2nd", "attr", "leaf", "of", "interest", "*", "/", "int", "index2", ";", "/", "*", "index", "of", "2nd", "attr", "in", "blk", "*", "/", "xfs_dablk_t", "rmtblkno2", ";", "/", "*", "remote", "attr", "value", "starting", "blkno", "*", "/", "int", "rmtblkcnt2", ";", "/", "*", "remote", "attr", "value", "block", "count", "*", "/", "int", "rmtvaluelen2", ";", "/", "*", "remote", "attr", "value", "length", "in", "bytes", "*", "/", "int", "op_flags", ";", "/", "*", "operation", "flags", "*", "/", "enum", "xfs_dacmp", "cmpresult", ";", "/", "*", "name", "compare", "result", "for", "lookups", "*", "/", "}", "xfs_da_args_t", ";"], "docstring_tokens": ["improperly", "uses", "an", "old", "size", "value", "during", "remote", "attribute", "replacement"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1", ",", "141", "+", "1", ",", "142", "@", "@", "/", "*", "*", "*", "*", "Copyright", "2014", "Orient", "Technologies", "LTD", "(", "info", "(", "at", ")", "orientechnologies", ".", "com", ")", "*", "*", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "*", "limitations", "under", "the", "License", ".", "*", "*", "*", "*", "For", "more", "information", ":", "http", ":", "//", "www", ".", "orientechnologies", ".", "com", "*", "*", "/", "*", "*", "*", "Copyright", "2014", "Orient", "Technologies", "LTD", "(", "info", "(", "at", ")", "orientechnologies", ".", "com", ")", "*", "*", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "*", "limitations", "under", "the", "License", ".", "*", "*", "*", "*", "For", "more", "information", ":", "http", ":", "//", "www", ".", "orientechnologies", ".", "com", "*", "*", "/", "package", "com", ".", "orientechnologies", ".", "orient", ".", "server", ".", "network", ".", "protocol", ".", "http", ";", "import", "com", ".", "orientechnologies", ".", "common", ".", "concur", ".", "resource", ".", "OSharedResourceAbstract", ";", "import", "com", ".", "orientechnologies", ".", "common", ".", "log", ".", "OLogManager", ";", "import", "com", ".", "orientechnologies", ".", "orient", ".", "core", ".", "Orient", ";", "import", "com", ".", "orientechnologies", ".", "orient", ".", "core", ".", "config", ".", "OGlobalConfiguration", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Map", ".", "Entry", ";", "import", "java", ".", "util", ".", "Random", ";", "import", "java", ".", "util", ".", "TimerTask", ";", "import", "com", ".", "orientechnologies", ".", "common", ".", "log", ".", "OLogManager", ";", "import", "com", ".", "orientechnologies", ".", "orient", ".", "core", ".", "Orient", ";", "import", "com", ".", "orientechnologies", ".", "orient", ".", "core", ".", "config", ".", "OGlobalConfiguration", ";", "import", "java", ".", "security", ".", "SecureRandom", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Map", ".", "Entry", ";", "import", "java", ".", "util", ".", "Random", ";", "import", "java", ".", "util", ".", "TimerTask", ";", "/", "**", "*", "Handles", "the", "HTTP", "sessions", "such", "as", "a", "real", "HTTP", "Server", ".", "*", "*", "@", "author", "Luca", "Garulli", "*", "/", "public", "class", "OHttpSessionManager", "extends", "OSharedResourceAbstract", "{", "private", "static", "final", "OHttpSessionManager", "instance", "=", "new", "OHttpSessionManager", "(", ");", "private", "Map", "<", "String", ",", "OHttpSession", ">", "sessions", "=", "new", "HashMap", "<", "String", ",", "OHttpSession", ">", "()", ";", "private", "int", "expirationTime", ";", "private", "Random", "random", "=", "new", "Random", "(", ");", "protected", "OHttpSessionManager", "(", ")", "{", "expirationTime", "=", "OGlobalConfiguration", ".", "NETWORK_HTTP_SESSION_EXPIRE_TIMEOUT", ".", "getValueAsInteger", "(", ")", "*", "1000", ";", "Orient", ".", "instance", "(", ").", "scheduleTask", "(", "new", "TimerTask", "(", ")", "{", "@", "Override", "public", "void", "run", "(", ")", "{", "final", "int", "expired", "=", "checkSessionsValidity", "(", ");", "if", "(", "expired", ">", "0", ")", "OLogManager", ".", "instance", "(", ").", "debug", "(", "this", ",", "\"", "Removed", "%", "d", "session", "because", "expired", "\"", ",", "expired", ")", ";", "}", "}", ",", "expirationTime", ",", "expirationTime", ")", ";", "}", "public", "int", "checkSessionsValidity", "(", ")", "{", "int", "expired", "=", "0", ";", "acquireExclusiveLock", "(", ");", "try", "{", "final", "long", "now", "=", "System", ".", "currentTimeMillis", "(", ");", "Entry", "<", "String", ",", "OHttpSession", ">", "s", ";", "for", "(", "Iterator", "<", "Map", ".", "Entry", "<", "String", ",", "OHttpSession", ">", ">", "it", "=", "sessions", ".", "entrySet", "(", ").", "iterator", "(", ");", "it", ".", "hasNext", "(", ");", ")", "{", "s", "=", "it", ".", "next", "(", ");", "if", "(", "now", "-", "s", ".", "getValue", "(", ").", "getUpdatedOn", "(", ")", ">", "expirationTime", ")", "{", "/", "/", "REMOVE", "THE", "SESSION", "it", ".", "remove", "(", ");", "expired", "+", "+;", "}", "}", "}", "finally", "{", "releaseExclusiveLock", "(", ");", "}", "return", "expired", ";", "}", "public", "OHttpSession", "[", "]", "getSessions", "(", ")", "{", "acquireSharedLock", "(", ");", "try", "{", "return", "(", "OHttpSession", "[", "])", "sessions", ".", "values", "(", ").", "toArray", "(", "new", "OHttpSession", "[", "sessions", ".", "size", "(", ")]", ");", "}", "finally", "{", "releaseSharedLock", "(", ");", "}", "}", "public", "OHttpSession", "getSession", "(", "final", "String", "iId", ")", "{", "acquireSharedLock", "(", ");", "try", "{", "final", "OHttpSession", "sess", "=", "sessions", ".", "get", "(", "iId", ")", ";", "if", "(", "sess", "!", "=", "null", ")", "sess", ".", "updateLastUpdatedOn", "(", ");", "return", "sess", ";", "}", "finally", "{", "releaseSharedLock", "(", ");", "}", "}", "public", "String", "createSession", "(", "final", "String", "iDatabaseName", ",", "final", "String", "iUserName", ",", "final", "String", "iUserPassword", ")", "{", "acquireExclusiveLock", "(", ");", "try", "{", "final", "String", "id", "=", "\"", "OS", "\"", "+", "System", ".", "currentTimeMillis", "(", ")", "+", "random", ".", "nextLong", "(", ");", "sessions", ".", "put", "(", "id", ",", "new", "OHttpSession", "(", "id", ",", "iDatabaseName", ",", "iUserName", ",", "iUserPassword", ")", ");", "return", "id", ";", "}", "finally", "{", "releaseExclusiveLock", "(", ");", "}", "}", "public", "OHttpSession", "removeSession", "(", "final", "String", "iSessionId", ")", "{", "acquireExclusiveLock", "(", ");", "try", "{", "return", "sessions", ".", "remove", "(", "iSessionId", ")", ";", "}", "finally", "{", "releaseExclusiveLock", "(", ");", "}", "}", "public", "int", "getExpirationTime", "(", ")", "{", "return", "expirationTime", ";", "}", "public", "void", "setExpirationTime", "(", "int", "expirationTime", ")", "{", "this", ".", "expirationTime", "=", "expirationTime", ";", "}", "public", "static", "OHttpSessionManager", "getInstance", "(", ")", "{", "return", "instance", ";", "}", "}", "*", "Handles", "the", "HTTP", "sessions", "such", "as", "a", "real", "HTTP", "Server", ".", "*", "*", "@", "author", "Luca", "Garulli", "*", "/", "public", "class", "OHttpSessionManager", "extends", "OSharedResourceAbstract", "{", "private", "static", "final", "OHttpSessionManager", "instance", "=", "new", "OHttpSessionManager", "(", ");", "private", "Map", "<", "String", ",", "OHttpSession", ">", "sessions", "=", "new", "HashMap", "<", "String", ",", "OHttpSession", ">", "()", ";", "private", "int", "expirationTime", ";", "private", "Random", "random", "=", "new", "SecureRandom", "(", ");", "protected", "OHttpSessionManager", "(", ")", "{", "expirationTime", "=", "OGlobalConfiguration", ".", "NETWORK_HTTP_SESSION_EXPIRE_TIMEOUT", ".", "getValueAsInteger", "(", ")", "*", "1000", ";", "Orient", ".", "instance", "(", ").", "scheduleTask", "(", "new", "TimerTask", "(", ")", "{", "@", "Override", "public", "void", "run", "(", ")", "{", "final", "int", "expired", "=", "checkSessionsValidity", "(", ");", "if", "(", "expired", ">", "0", ")", "OLogManager", ".", "instance", "(", ").", "debug", "(", "this", ",", "\"", "Removed", "%", "d", "session", "because", "expired", "\"", ",", "expired", ")", ";", "}", "}", ",", "expirationTime", ",", "expirationTime", ")", ";", "}", "public", "int", "checkSessionsValidity", "(", ")", "{", "int", "expired", "=", "0", ";", "acquireExclusiveLock", "(", ");", "try", "{", "final", "long", "now", "=", "System", ".", "currentTimeMillis", "(", ");", "Entry", "<", "String", ",", "OHttpSession", ">", "s", ";", "for", "(", "Iterator", "<", "Map", ".", "Entry", "<", "String", ",", "OHttpSession", ">", ">", "it", "=", "sessions", ".", "entrySet", "(", ").", "iterator", "(", ");", "it", ".", "hasNext", "(", ");", ")", "{", "s", "=", "it", ".", "next", "(", ");", "if", "(", "now", "-", "s", ".", "getValue", "(", ").", "getUpdatedOn", "(", ")", ">", "expirationTime", ")", "{", "/", "/", "REMOVE", "THE", "SESSION", "it", ".", "remove", "(", ");", "expired", "+", "+;", "}", "}", "}", "finally", "{", "releaseExclusiveLock", "(", ");", "}", "return", "expired", ";", "}", "public", "OHttpSession", "[", "]", "getSessions", "(", ")", "{", "acquireSharedLock", "(", ");", "try", "{", "return", "(", "OHttpSession", "[", "])", "sessions", ".", "values", "(", ").", "toArray", "(", "new", "OHttpSession", "[", "sessions", ".", "size", "(", ")]", ");", "}", "finally", "{", "releaseSharedLock", "(", ");", "}", "}", "public", "OHttpSession", "getSession", "(", "final", "String", "iId", ")", "{", "acquireSharedLock", "(", ");", "try", "{", "final", "OHttpSession", "sess", "=", "sessions", ".", "get", "(", "iId", ")", ";", "if", "(", "sess", "!", "=", "null", ")", "sess", ".", "updateLastUpdatedOn", "(", ");", "return", "sess", ";", "}", "finally", "{", "releaseSharedLock", "(", ");", "}", "}", "public", "String", "createSession", "(", "final", "String", "iDatabaseName", ",", "final", "String", "iUserName", ",", "final", "String", "iUserPassword", ")", "{", "acquireExclusiveLock", "(", ");", "try", "{", "final", "String", "id", "=", "\"", "OS", "\"", "+", "System", ".", "currentTimeMillis", "(", ")", "+", "random", ".", "nextLong", "(", ");", "sessions", ".", "put", "(", "id", ",", "new", "OHttpSession", "(", "id", ",", "iDatabaseName", ",", "iUserName", ",", "iUserPassword", ")", ");", "return", "id", ";", "}", "finally", "{", "releaseExclusiveLock", "(", ");", "}", "}", "public", "OHttpSession", "removeSession", "(", "final", "String", "iSessionId", ")", "{", "acquireExclusiveLock", "(", ");", "try", "{", "return", "sessions", ".", "remove", "(", "iSessionId", ")", ";", "}", "finally", "{", "releaseExclusiveLock", "(", ");", "}", "}", "public", "int", "getExpirationTime", "(", ")", "{", "return", "expirationTime", ";", "}", "public", "void", "setExpirationTime", "(", "int", "expirationTime", ")", "{", "this", ".", "expirationTime", "=", "expirationTime", ";", "}", "public", "static", "OHttpSessionManager", "getInstance", "(", ")", "{", "return", "instance", ";", "}", "}"], "docstring_tokens": ["the", "use", "of", "insufficient", "random", "values"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2965", ",", "9", "+", "2965", ",", "7", "@", "@", "public", "void", "validatePoolFactory", "(", "PoolFactory", "poolFactory", ")", "{", "@", "Override", "public", "<", "K", ",", "V", ">", "Region", "<", "K", ",", "V", ">", "createRegion", "(", "String", "name", ",", "RegionAttributes", "<", "K", ",", "V", ">", "aRegionAttributes", ")", "throws", "RegionExistsException", ",", "TimeoutException", "{", "if", "(", "isClient", "(", "))", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "operation", "is", "not", "supported", "on", "a", "client", "cache", "\"", ");", "}", "throwIfClient", "(", ");", "return", "basicCreateRegion", "(", "name", ",", "aRegionAttributes", ")", ";", "}", "@", "@", "-", "3214", ",", "11", "+", "3212", ",", "8", "@", "@", "public", "Region", "getRegion", "(", "String", "path", ")", "{", "synchronized", "(", "this", ".", "rootRegions", ")", "{", "for", "(", "Object", "region", ":", "this", ".", "rootRegions", ".", "values", "(", "))", "{", "InternalRegion", "internalRegion", "=", "(", "InternalRegion", ")", "region", ";", "if", "(", "internalRegion", ".", "isSecret", "(", ")", "|", "|", "internalRegion", ".", "isUsedForMetaRegion", "(", ")", "|", "|", "internalRegion", "instanceof", "HARegion", "|", "|", "internalRegion", ".", "isUsedForPartitionedRegionAdmin", "(", ")", "|", "|", "internalRegion", ".", "isInternalRegion", "(", ")/", "*", "internalRegion", ".", "isUsedForPartitionedRegionBucket", "(", ")", "*", "/)", "{", "continue", ";", "/", "/", "Skip", "administrative", "PartitionedRegions", "if", "(", "internalRegion", ".", "isInternalRegion", "(", "))", "{", "continue", ";", "/", "/", "Skip", "internal", "regions", "}", "result", ".", "add", "(", "internalRegion", ")", ";", "result", ".", "addAll", "(", "internalRegion", ".", "basicSubregions", "(", "true", ")", ");", "@", "@", "-", "3392", ",", "7", "+", "3387", ",", "7", "@", "@", "private", "boolean", "isGlobalRegionInitializing", "(", "InternalRegion", "region", ")", "{", "synchronized", "(", "this", ".", "rootRegions", ")", "{", "for", "(", "InternalRegion", "region", ":", "this", ".", "rootRegions", ".", "values", "(", "))", "{", "/", "/", "If", "this", "is", "an", "internal", "meta", "-", "region", ",", "don", "'", "t", "return", "it", "to", "end", "user", "if", "(", "region", ".", "isSecret", "(", ")", "|", "|", "region", ".", "isUsedForMetaRegion", "(", ")", "|", "|", "region", "instanceof", "HARegion", "if", "(", "region", ".", "isSecret", "(", ")", "|", "|", "region", ".", "isUsedForMetaRegion", "(", ")", "|", "|", "!", "includePRAdminRegions", "&", "&", "(", "region", ".", "isUsedForPartitionedRegionAdmin", "(", ")", "|", "|", "region", ".", "isUsedForPartitionedRegionBucket", "(", "))", ")", "{", "continue", ";", "/", "/", "Skip", "administrative", "PartitionedRegions", "@", "@", "-", "3446", ",", "9", "+", "3441", ",", "7", "@", "@", "public", "int", "getLockTimeout", "(", ")", "{", "@", "Override", "public", "void", "setLockTimeout", "(", "int", "seconds", ")", "{", "if", "(", "isClient", "(", "))", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "operation", "is", "not", "supported", "on", "a", "client", "cache", "\"", ");", "}", "throwIfClient", "(", ");", "this", ".", "stopper", ".", "checkCancelInProgress", "(", "null", ")", ";", "this", ".", "lockTimeout", "=", "seconds", ";", "}", "@", "@", "-", "3460", ",", "9", "+", "3453", ",", "7", "@", "@", "public", "int", "getLockLease", "(", ")", "{", "@", "Override", "public", "void", "setLockLease", "(", "int", "seconds", ")", "{", "if", "(", "isClient", "(", "))", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "operation", "is", "not", "supported", "on", "a", "client", "cache", "\"", ");", "}", "throwIfClient", "(", ");", "this", ".", "stopper", ".", "checkCancelInProgress", "(", "null", ")", ";", "this", ".", "lockLease", "=", "seconds", ";", "}", "@", "@", "-", "3474", ",", "9", "+", "3465", ",", "7", "@", "@", "public", "int", "getSearchTimeout", "(", ")", "{", "@", "Override", "public", "void", "setSearchTimeout", "(", "int", "seconds", ")", "{", "if", "(", "isClient", "(", "))", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "operation", "is", "not", "supported", "on", "a", "client", "cache", "\"", ");", "}", "throwIfClient", "(", ");", "this", ".", "stopper", ".", "checkCancelInProgress", "(", "null", ")", ";", "this", ".", "searchTimeout", "=", "seconds", ";", "}", "@", "@", "-", "3488", ",", "9", "+", "3477", ",", "7", "@", "@", "public", "int", "getMessageSyncInterval", "(", ")", "{", "@", "Override", "public", "void", "setMessageSyncInterval", "(", "int", "seconds", ")", "{", "if", "(", "isClient", "(", "))", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "operation", "is", "not", "supported", "on", "a", "client", "cache", "\"", ");", "}", "throwIfClient", "(", ");", "this", ".", "stopper", ".", "checkCancelInProgress", "(", "null", ")", ";", "if", "(", "seconds", "<", "0", ")", "{", "throw", "new", "IllegalArgumentException", "(", "@", "@", "-", "3798", ",", "9", "+", "3785", ",", "7", "@", "@", "public", "CacheServer", "addCacheServer", "(", ")", "{", "@", "Override", "public", "CacheServer", "addCacheServer", "(", "boolean", "isGatewayReceiver", ")", "{", "if", "(", "isClient", "(", "))", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "operation", "is", "not", "supported", "on", "a", "client", "cache", "\"", ");", "}", "throwIfClient", "(", ");", "this", ".", "stopper", ".", "checkCancelInProgress", "(", "null", ")", ";", "CacheServerImpl", "cacheServer", "=", "new", "CacheServerImpl", "(", "this", ",", "isGatewayReceiver", ")", ";", "@", "@", "-", "3818", ",", "9", "+", "3803", ",", "7", "@", "@", "public", "boolean", "removeCacheServer", "(", "CacheServer", "cacheServer", ")", "{", "@", "Override", "public", "void", "addGatewaySender", "(", "GatewaySender", "sender", ")", "{", "if", "(", "isClient", "(", "))", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "operation", "is", "not", "supported", "on", "a", "client", "cache", "\"", ");", "}", "throwIfClient", "(", ");", "this", ".", "stopper", ".", "checkCancelInProgress", "(", "null", ")", ";", "@", "@", "-", "3867", ",", "9", "+", "3850", ",", "7", "@", "@", "public", "void", "addGatewaySender", "(", "GatewaySender", "sender", ")", "{", "@", "Override", "public", "void", "removeGatewaySender", "(", "GatewaySender", "sender", ")", "{", "if", "(", "isClient", "(", "))", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "operation", "is", "not", "supported", "on", "a", "client", "cache", "\"", ");", "}", "throwIfClient", "(", ");", "this", ".", "stopper", ".", "checkCancelInProgress", "(", "null", ")", ";", "@", "@", "-", "3891", ",", "9", "+", "3872", ",", "7", "@", "@", "public", "void", "removeGatewaySender", "(", "GatewaySender", "sender", ")", "{", "@", "Override", "public", "void", "addGatewayReceiver", "(", "GatewayReceiver", "receiver", ")", "{", "if", "(", "isClient", "(", "))", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "operation", "is", "not", "supported", "on", "a", "client", "cache", "\"", ");", "}", "throwIfClient", "(", ");", "this", ".", "stopper", ".", "checkCancelInProgress", "(", "null", ")", ";", "synchronized", "(", "this", ".", "allGatewayReceiversLock", ")", "{", "Set", "<", "GatewayReceiver", ">", "newReceivers", "=", "new", "HashSet", "<", ">(", "this", ".", "allGatewayReceivers", ".", "size", "(", ")", "+", "1", ")", ";", "@", "@", "-", "3906", ",", "9", "+", "3885", ",", "7", "@", "@", "public", "void", "addGatewayReceiver", "(", "GatewayReceiver", "receiver", ")", "{", "}", "public", "void", "removeGatewayReceiver", "(", "GatewayReceiver", "receiver", ")", "{", "if", "(", "isClient", "(", "))", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "operation", "is", "not", "supported", "on", "a", "client", "cache", "\"", ");", "}", "throwIfClient", "(", ");", "this", ".", "stopper", ".", "checkCancelInProgress", "(", "null", ")", ";", "synchronized", "(", "this", ".", "allGatewayReceiversLock", ")", "{", "Set", "<", "GatewayReceiver", ">", "newReceivers", "=", "new", "HashSet", "<", ">(", "this", ".", "allGatewayReceivers", ".", "size", "(", ")", "+", "1", ")", ";", "@", "@", "-", "3992", ",", "9", "+", "3969", ",", "7", "@", "@", "public", "AsyncEventQueue", "getAsyncEventQueue", "(", "String", "id", ")", "{", "@", "Override", "public", "void", "removeAsyncEventQueue", "(", "AsyncEventQueue", "asyncQueue", ")", "{", "if", "(", "isClient", "(", "))", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "operation", "is", "not", "supported", "on", "a", "client", "cache", "\"", ");", "}", "throwIfClient", "(", ");", "/", "/", "first", "remove", "the", "gateway", "sender", "of", "the", "queue", "if", "(", "asyncQueue", "instanceof", "AsyncEventQueueImpl", ")", "{", "removeGatewaySender", "(", "((", "AsyncEventQueueImpl", ")", "asyncQueue", ")", ".", "getSender", "(", "))", ";", "@", "@", "-", "4201", ",", "9", "+", "4176", ",", "7", "@", "@", "public", "void", "removePartitionedRegion", "(", "PartitionedRegion", "region", ")", "{", "@", "Override", "public", "void", "setIsServer", "(", "boolean", "isServer", ")", "{", "if", "(", "isClient", "(", "))", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "operation", "is", "not", "supported", "on", "a", "client", "cache", "\"", ");", "}", "throwIfClient", "(", ");", "this", ".", "stopper", ".", "checkCancelInProgress", "(", "null", ")", ";", "this", ".", "isServer", "=", "isServer", ";", "@", "@", "-", "4642", ",", "21", "+", "4615", ",", "16", "@", "@", "public", "TXManagerImpl", "getTxManager", "(", ")", "{", "*", "/", "@", "Override", "public", "<", "K", ",", "V", ">", "RegionFactory", "<", "K", ",", "V", ">", "createRegionFactory", "(", "RegionShortcut", "shortcut", ")", "{", "if", "(", "isClient", "(", "))", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "operation", "is", "not", "supported", "on", "a", "client", "cache", "\"", ");", "}", "else", "{", "return", "new", "RegionFactoryImpl", "<", ">(", "this", ",", "shortcut", ")", ";", "}", "throwIfClient", "(", ");", "return", "new", "RegionFactoryImpl", "<", ">(", "this", ",", "shortcut", ")", ";", "}", "/", "**", "*", "@", "since", "GemFire", "6", ".", "5", "*", "/", "@", "Override", "public", "<", "K", ",", "V", ">", "RegionFactory", "<", "K", ",", "V", ">", "createRegionFactory", "(", ")", "{", "if", "(", "isClient", "(", "))", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "operation", "is", "not", "supported", "on", "a", "client", "cache", "\"", ");", "}", "throwIfClient", "(", ");", "return", "new", "RegionFactoryImpl", "<", ">(", "this", ")", ";", "}", "@", "@", "-", "4665", ",", "9", "+", "4633", ",", "7", "@", "@", "public", "TXManagerImpl", "getTxManager", "(", ")", "{", "*", "/", "@", "Override", "public", "<", "K", ",", "V", ">", "RegionFactory", "<", "K", ",", "V", ">", "createRegionFactory", "(", "String", "regionAttributesId", ")", "{", "if", "(", "isClient", "(", "))", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "operation", "is", "not", "supported", "on", "a", "client", "cache", "\"", ");", "}", "throwIfClient", "(", ");", "return", "new", "RegionFactoryImpl", "<", ">(", "this", ",", "regionAttributesId", ")", ";", "}", "@", "@", "-", "4676", ",", "9", "+", "4642", ",", "7", "@", "@", "public", "TXManagerImpl", "getTxManager", "(", ")", "{", "*", "/", "@", "Override", "public", "<", "K", ",", "V", ">", "RegionFactory", "<", "K", ",", "V", ">", "createRegionFactory", "(", "RegionAttributes", "<", "K", ",", "V", ">", "regionAttributes", ")", "{", "if", "(", "isClient", "(", "))", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "operation", "is", "not", "supported", "on", "a", "client", "cache", "\"", ");", "}", "throwIfClient", "(", ");", "return", "new", "RegionFactoryImpl", "<", ">(", "this", ",", "regionAttributes", ")", ";", "}", "@", "@", "-", "5382", ",", "4", "+", "5346", ",", "19", "@", "@", "public", "void", "registerPdxMetaData", "(", "Object", "instance", ")", "{", "throw", "new", "SerializationException", "(", "\"", "Serialization", "failed", "\"", ",", "e", ")", ";", "}", "}", "private", "void", "throwIfClient", "(", ")", "{", "if", "(", "isClient", "(", "))", "{", "throw", "new", "UnsupportedOperationException", "(", "\"", "operation", "is", "not", "supported", "on", "a", "client", "cache", "\"", ");", "}", "}", "private", "final", "InternalCacheForClientAccess", "cacheForClients", "=", "new", "InternalCacheForClientAccess", "(", "this", ")", ";", "@", "Override", "public", "InternalCache", "getCacheForProcessingClientRequests", "(", ")", "{", "return", "cacheForClients", ";", "}", "}", "@", "@", "-", "361", ",", "4", "+", "361", ",", "11", "@", "@", "void", "invokeRegionEntrySynchronizationListenersAfterSynchronization", "(", "Boolean", "getPdxReadSerializedOverride", "(", ");", "void", "setPdxReadSerializedOverride", "(", "boolean", "pdxReadSerialized", ")", ";", "/", "**", "*", "Returns", "a", "version", "of", "InternalCache", "that", "can", "only", "access", "*", "application", "visible", "regions", ".", "Any", "regions", "created", "internally", "*", "by", "Geode", "will", "not", "be", "accessible", "from", "the", "returned", "cache", ".", "*", "/", "InternalCache", "getCacheForProcessingClientRequests", "(", ");", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "1189", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ";", "import", "java", ".", "io", ".", "File", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "net", ".", "URL", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Properties", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "concurrent", ".", "Executor", ";", "import", "java", ".", "util", ".", "concurrent", ".", "TimeUnit", ";", "import", "javax", ".", "naming", ".", "Context", ";", "import", "javax", ".", "transaction", ".", "TransactionManager", ";", "import", "org", ".", "apache", ".", "geode", ".", "CancelCriterion", ";", "import", "org", ".", "apache", ".", "geode", ".", "LogWriter", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "Cache", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "CacheClosedException", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "CacheTransactionManager", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "CacheWriterException", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "Declarable", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "DiskStore", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "DiskStoreFactory", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "GatewayException", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "Region", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "RegionAttributes", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "RegionExistsException", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "RegionFactory", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "RegionShortcut", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "TimeoutException", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "asyncqueue", ".", "AsyncEventQueue", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "asyncqueue", ".", "AsyncEventQueueFactory", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "asyncqueue", ".", "internal", ".", "AsyncEventQueueImpl", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "client", ".", "internal", ".", "ClientMetadataService", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "control", ".", "ResourceManager", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "query", ".", "QueryService", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "query", ".", "internal", ".", "InternalQueryService", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "query", ".", "internal", ".", "QueryMonitor", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "query", ".", "internal", ".", "cq", ".", "CqService", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "server", ".", "CacheServer", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "snapshot", ".", "CacheSnapshotService", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "util", ".", "GatewayConflictResolver", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "wan", ".", "GatewayReceiver", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "wan", ".", "GatewayReceiverFactory", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "wan", ".", "GatewaySender", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "wan", ".", "GatewaySenderFactory", ";", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "DistributedLockService", ";", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "DistributedMember", ";", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "DistributedSystem", ";", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "internal", ".", "DistributionAdvisor", ";", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "internal", ".", "DistributionManager", ";", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "internal", ".", "InternalDistributedSystem", ";", "import", "org", ".", "apache", ".", "geode", ".", "distributed", ".", "internal", ".", "membership", ".", "InternalDistributedMember", ";", "import", "org", ".", "apache", ".", "geode", ".", "i18n", ".", "LogWriterI18n", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "SystemTimer", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "InitialImageOperation", ".", "Entry", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "backup", ".", "BackupService", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "control", ".", "InternalResourceManager", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "control", ".", "ResourceAdvisor", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "event", ".", "EventTrackerExpiryTask", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "extension", ".", "ExtensionPoint", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "persistence", ".", "PersistentMemberManager", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "tier", ".", "sockets", ".", "CacheClientNotifier", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ".", "tier", ".", "sockets", ".", "ClientProxyMembershipID", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "logging", ".", "InternalLogWriter", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "offheap", ".", "MemoryAllocator", ";", "import", "org", ".", "apache", ".", "geode", ".", "internal", ".", "security", ".", "SecurityService", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "JmxManagerAdvisor", ";", "import", "org", ".", "apache", ".", "geode", ".", "management", ".", "internal", ".", "RestAgent", ";", "import", "org", ".", "apache", ".", "geode", ".", "pdx", ".", "PdxInstance", ";", "import", "org", ".", "apache", ".", "geode", ".", "pdx", ".", "PdxInstanceFactory", ";", "import", "org", ".", "apache", ".", "geode", ".", "pdx", ".", "PdxSerializer", ";", "import", "org", ".", "apache", ".", "geode", ".", "pdx", ".", "internal", ".", "TypeRegistry", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "NotAuthorizedException", ";", "/", "**", "*", "This", "class", "delegates", "all", "methods", "to", "the", "InternalCache", "instance", "*", "it", "wraps", ".", "Any", "regions", "returned", "will", "be", "checked", "and", "if", "they", "are", "*", "internal", "an", "exception", "is", "thrown", "if", "they", "are", ".", "*", "Note", ":", "an", "instance", "of", "this", "class", "should", "be", "used", "by", "servers", "that", "*", "process", "requests", "from", "clients", "that", "contains", "region", "names", "to", "prevent", "*", "the", "client", "from", "directly", "accessing", "internal", "regions", ".", "*", "/", "public", "class", "InternalCacheForClientAccess", "implements", "InternalCache", "{", "private", "final", "InternalCache", "delegate", ";", "public", "InternalCacheForClientAccess", "(", "InternalCache", "delegate", ")", "{", "this", ".", "delegate", "=", "delegate", ";", "}", "private", "void", "checkForInternalRegion", "(", "Region", "<", "?,", "?", ">", "r", ")", "{", "InternalRegion", "ir", "=", "(", "InternalRegion", ")", "r", ";", "if", "(", "ir", ".", "isInternalRegion", "(", "))", "{", "throw", "new", "NotAuthorizedException", "(", "\"", "The", "region", "\"", "+", "r", ".", "getName", "(", ")", "+", "\"", "is", "an", "internal", "region", "that", "a", "client", "is", "never", "allowed", "to", "access", "\"", ");", "}", "}", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "private", "void", "checkSetOfRegions", "(", "@", "SuppressWarnings", "(", "\"", "rawtypes", "\"", ")", "Set", "regions", ")", "{", "for", "(", "InternalRegion", "r", ":", "(", "Set", "<", "InternalRegion", ">", ")", "regions", ")", "{", "checkForInternalRegion", "(", "r", ")", ";", "}", "}", "@", "Override", "public", "<", "K", ",", "V", ">", "Region", "<", "K", ",", "V", ">", "getRegion", "(", "String", "path", ")", "{", "Region", "<", "K", ",", "V", ">", "result", "=", "delegate", ".", "getRegion", "(", "path", ")", ";", "checkForInternalRegion", "(", "result", ")", ";", "return", "result", ";", "}", "@", "Override", "public", "Region", "getRegion", "(", "String", "path", ",", "boolean", "returnDestroyedRegion", ")", "{", "Region", "result", "=", "delegate", ".", "getRegion", "(", "path", ",", "returnDestroyedRegion", ")", ";", "checkForInternalRegion", "(", "result", ")", ";", "return", "result", ";", "}", "@", "Override", "public", "InternalRegion", "getReinitializingRegion", "(", "String", "fullPath", ")", "{", "InternalRegion", "result", "=", "delegate", ".", "getReinitializingRegion", "(", "fullPath", ")", ";", "checkForInternalRegion", "(", "result", ")", ";", "return", "result", ";", "}", "@", "Override", "public", "InternalRegion", "getRegionByPath", "(", "String", "path", ")", "{", "InternalRegion", "result", "=", "delegate", ".", "getRegionByPath", "(", "path", ")", ";", "checkForInternalRegion", "(", "result", ")", ";", "return", "result", ";", "}", "@", "Override", "public", "InternalRegion", "getRegionByPathForProcessing", "(", "String", "path", ")", "{", "InternalRegion", "result", "=", "delegate", ".", "getRegionByPathForProcessing", "(", "path", ")", ";", "checkForInternalRegion", "(", "result", ")", ";", "return", "result", ";", "}", "@", "Override", "public", "DistributedRegion", "getRegionInDestroy", "(", "String", "path", ")", "{", "DistributedRegion", "result", "=", "delegate", ".", "getRegionInDestroy", "(", "path", ")", ";", "checkForInternalRegion", "(", "result", ")", ";", "return", "result", ";", "}", "@", "Override", "public", "Set", "<", "PartitionedRegion", ">", "getPartitionedRegions", "(", ")", "{", "Set", "<", "PartitionedRegion", ">", "result", "=", "delegate", ".", "getPartitionedRegions", "(", ");", "checkSetOfRegions", "(", "result", ")", ";", "return", "result", ";", "}", "@", "Override", "public", "Set", "<", "Region", "<", "?,", "?", ">>", "rootRegions", "(", ")", "{", "Set", "<", "Region", "<", "?,", "?", ">>", "result", "=", "delegate", ".", "rootRegions", "(", ");", "checkSetOfRegions", "(", "result", ")", ";", "return", "result", ";", "}", "@", "Override", "public", "Set", "<", "Region", "<", "?,", "?", ">>", "rootRegions", "(", "boolean", "includePRAdminRegions", ")", "{", "Set", "<", "Region", "<", "?,", "?", ">>", "result", "=", "delegate", ".", "rootRegions", "(", "includePRAdminRegions", ")", ";", "checkSetOfRegions", "(", "result", ")", ";", "return", "result", ";", "}", "@", "Override", "public", "Set", "<", "InternalRegion", ">", "getAllRegions", "(", ")", "{", "Set", "<", "InternalRegion", ">", "result", "=", "delegate", ".", "getAllRegions", "(", ");", "checkSetOfRegions", "(", "result", ")", ";", "return", "result", ";", "}", "@", "Override", "public", "<", "K", ",", "V", ">", "Region", "<", "K", ",", "V", ">", "createVMRegion", "(", "String", "name", ",", "RegionAttributes", "<", "K", ",", "V", ">", "p_attrs", ",", "InternalRegionArguments", "internalRegionArgs", ")", "throws", "RegionExistsException", ",", "TimeoutException", ",", "IOException", ",", "ClassNotFoundException", "{", "if", "(", "internalRegionArgs", "!", "=", "null", ")", "{", "if", "(", "internalRegionArgs", ".", "isInternalRegion", "(", ")", "|", "|", "internalRegionArgs", ".", "isUsedForPartitionedRegionBucket", "(", ")", "|", "|", "internalRegionArgs", ".", "isUsedForMetaRegion", "(", ")", "|", "|", "internalRegionArgs", ".", "isUsedForSerialGatewaySenderQueue", "(", ")", "|", "|", "internalRegionArgs", ".", "isUsedForParallelGatewaySenderQueue", "(", "))", "{", "throw", "new", "NotAuthorizedException", "(", "\"", "The", "region", "\"", "+", "name", "+", "\"", "is", "an", "internal", "region", "that", "a", "client", "is", "never", "allowed", "to", "create", "\"", ");", "}", "}", "return", "delegate", ".", "createVMRegion", "(", "name", ",", "p_attrs", ",", "internalRegionArgs", ")", ";", "}", "@", "Override", "public", "Cache", "getReconnectedCache", "(", ")", "{", "Cache", "reconnectedCache", "=", "delegate", ".", "getReconnectedCache", "(", ");", "if", "(", "reconnectedCache", "!", "=", "null", ")", "{", "return", "new", "InternalCacheForClientAccess", "(", "(", "InternalCache", ")", "reconnectedCache", ")", ";", "}", "else", "{", "return", "null", ";", "}", "}", "@", "Override", "public", "FilterProfile", "getFilterProfile", "(", "String", "regionName", ")", "{", "InternalRegion", "r", "=", "(", "InternalRegion", ")", "getRegion", "(", "regionName", ",", "true", ")", ";", "if", "(", "r", "!", "=", "null", ")", "{", "return", "r", ".", "getFilterProfile", "(", ");", "}", "return", "null", ";", "}", "@", "Override", "public", "<", "K", ",", "V", ">", "Region", "<", "K", ",", "V", ">", "basicCreateRegion", "(", "String", "name", ",", "RegionAttributes", "<", "K", ",", "V", ">", "attrs", ")", "throws", "RegionExistsException", ",", "TimeoutException", "{", "return", "delegate", ".", "basicCreateRegion", "(", "name", ",", "attrs", ")", ";", "}", "@", "Override", "public", "<", "K", ",", "V", ">", "Region", "<", "K", ",", "V", ">", "createVMRegion", "(", "String", "name", ",", "RegionAttributes", "<", "K", ",", "V", ">", "aRegionAttributes", ")", "throws", "RegionExistsException", ",", "TimeoutException", "{", "return", "delegate", ".", "createVMRegion", "(", "name", ",", "aRegionAttributes", ")", ";", "}", "@", "Override", "public", "<", "K", ",", "V", ">", "Region", "<", "K", ",", "V", ">", "createRegion", "(", "String", "name", ",", "RegionAttributes", "<", "K", ",", "V", ">", "aRegionAttributes", ")", "throws", "RegionExistsException", ",", "TimeoutException", "{", "return", "delegate", ".", "createRegion", "(", "name", ",", "aRegionAttributes", ")", ";", "}", "@", "Override", "public", "<", "K", ",", "V", ">", "RegionFactory", "<", "K", ",", "V", ">", "createRegionFactory", "(", ")", "{", "return", "delegate", ".", "createRegionFactory", "(", ");", "}", "@", "Override", "public", "<", "K", ",", "V", ">", "RegionFactory", "<", "K", ",", "V", ">", "createRegionFactory", "(", "RegionShortcut", "shortcut", ")", "{", "return", "delegate", ".", "createRegionFactory", "(", "shortcut", ")", ";", "}", "@", "Override", "public", "<", "K", ",", "V", ">", "RegionFactory", "<", "K", ",", "V", ">", "createRegionFactory", "(", "String", "regionAttributesId", ")", "{", "return", "delegate", ".", "createRegionFactory", "(", "regionAttributesId", ")", ";", "}", "@", "Override", "public", "<", "K", ",", "V", ">", "RegionFactory", "<", "K", ",", "V", ">", "createRegionFactory", "(", "RegionAttributes", "<", "K", ",", "V", ">", "regionAttributes", ")", "{", "return", "delegate", ".", "createRegionFactory", "(", "regionAttributes", ")", ";", "}", "@", "Override", "public", "void", "close", "(", "boolean", "keepAlive", ")", "{", "delegate", ".", "close", "(", "keepAlive", ")", ";", "}", "@", "Override", "public", "LogWriterI18n", "getLoggerI18n", "(", ")", "{", "return", "delegate", ".", "getLoggerI18n", "(", ");", "}", "@", "Override", "public", "LogWriterI18n", "getSecurityLoggerI18n", "(", ")", "{", "return", "delegate", ".", "getSecurityLoggerI18n", "(", ");", "}", "@", "Override", "public", "int", "getLockTimeout", "(", ")", "{", "return", "delegate", ".", "getLockTimeout", "(", ");", "}", "@", "Override", "public", "void", "setLockTimeout", "(", "int", "seconds", ")", "{", "delegate", ".", "setLockTimeout", "(", "seconds", ")", ";", "}", "@", "Override", "public", "int", "getMessageSyncInterval", "(", ")", "{", "return", "delegate", ".", "getMessageSyncInterval", "(", ");", "}", "@", "Override", "public", "void", "setMessageSyncInterval", "(", "int", "seconds", ")", "{", "delegate", ".", "setMessageSyncInterval", "(", "seconds", ")", ";", "}", "@", "Override", "public", "int", "getLockLease", "(", ")", "{", "return", "delegate", ".", "getLockLease", "(", ");", "}", "@", "Override", "public", "void", "setLockLease", "(", "int", "seconds", ")", "{", "delegate", ".", "setLockLease", "(", "seconds", ")", ";", "}", "@", "Override", "public", "int", "getSearchTimeout", "(", ")", "{", "return", "delegate", ".", "getSearchTimeout", "(", ");", "}", "@", "Override", "public", "void", "setSearchTimeout", "(", "int", "seconds", ")", "{", "delegate", ".", "setSearchTimeout", "(", "seconds", ")", ";", "}", "@", "Override", "public", "CacheServer", "addCacheServer", "(", ")", "{", "return", "delegate", ".", "addCacheServer", "(", ");", "}", "@", "Override", "public", "List", "<", "CacheServer", ">", "getCacheServers", "(", ")", "{", "return", "delegate", ".", "getCacheServers", "(", ");", "}", "@", "Override", "public", "void", "setGatewayConflictResolver", "(", "GatewayConflictResolver", "resolver", ")", "{", "delegate", ".", "setGatewayConflictResolver", "(", "resolver", ")", ";", "}", "@", "Override", "public", "GatewayConflictResolver", "getGatewayConflictResolver", "(", ")", "{", "return", "delegate", ".", "getGatewayConflictResolver", "(", ");", "}", "@", "Override", "public", "void", "setIsServer", "(", "boolean", "isServer", ")", "{", "delegate", ".", "setIsServer", "(", "isServer", ")", ";", "}", "@", "Override", "public", "boolean", "isServer", "(", ")", "{", "return", "delegate", ".", "isServer", "(", ");", "}", "@", "Override", "public", "void", "readyForEvents", "(", ")", "{", "delegate", ".", "readyForEvents", "(", ");", "}", "@", "Override", "public", "GatewaySenderFactory", "createGatewaySenderFactory", "(", ")", "{", "return", "delegate", ".", "createGatewaySenderFactory", "(", ");", "}", "@", "Override", "public", "AsyncEventQueueFactory", "createAsyncEventQueueFactory", "(", ")", "{", "return", "delegate", ".", "createAsyncEventQueueFactory", "(", ");", "}", "@", "Override", "public", "GatewayReceiverFactory", "createGatewayReceiverFactory", "(", ")", "{", "return", "delegate", ".", "createGatewayReceiverFactory", "(", ");", "}", "@", "Override", "public", "Set", "<", "GatewaySender", ">", "getGatewaySenders", "(", ")", "{", "return", "delegate", ".", "getGatewaySenders", "(", ");", "}", "@", "Override", "public", "GatewaySender", "getGatewaySender", "(", "String", "id", ")", "{", "return", "delegate", ".", "getGatewaySender", "(", "id", ")", ";", "}", "@", "Override", "public", "Set", "<", "GatewayReceiver", ">", "getGatewayReceivers", "(", ")", "{", "return", "delegate", ".", "getGatewayReceivers", "(", ");", "}", "@", "Override", "public", "Set", "<", "AsyncEventQueue", ">", "getAsyncEventQueues", "(", ")", "{", "return", "delegate", ".", "getAsyncEventQueues", "(", ");", "}", "@", "Override", "public", "AsyncEventQueue", "getAsyncEventQueue", "(", "String", "id", ")", "{", "return", "delegate", ".", "getAsyncEventQueue", "(", "id", ")", ";", "}", "@", "Override", "public", "Set", "<", "DistributedMember", ">", "getMembers", "(", ")", "{", "return", "delegate", ".", "getMembers", "(", ");", "}", "@", "Override", "public", "Set", "<", "DistributedMember", ">", "getAdminMembers", "(", ")", "{", "return", "delegate", ".", "getAdminMembers", "(", ");", "}", "@", "Override", "public", "Set", "<", "DistributedMember", ">", "getMembers", "(", "Region", "region", ")", "{", "return", "delegate", ".", "getMembers", "(", "region", ")", ";", "}", "@", "Override", "public", "CacheSnapshotService", "getSnapshotService", "(", ")", "{", "return", "delegate", ".", "getSnapshotService", "(", ");", "}", "@", "Override", "public", "boolean", "isReconnecting", "(", ")", "{", "return", "delegate", ".", "isReconnecting", "(", ");", "}", "@", "Override", "public", "boolean", "waitUntilReconnected", "(", "long", "time", ",", "TimeUnit", "units", ")", "throws", "InterruptedException", "{", "return", "delegate", ".", "waitUntilReconnected", "(", "time", ",", "units", ")", ";", "}", "@", "Override", "public", "void", "stopReconnecting", "(", ")", "{", "delegate", ".", "stopReconnecting", "(", ");", "}", "@", "Override", "public", "String", "getName", "(", ")", "{", "return", "delegate", ".", "getName", "(", ");", "}", "@", "Override", "public", "DistributedSystem", "getDistributedSystem", "(", ")", "{", "return", "delegate", ".", "getDistributedSystem", "(", ");", "}", "@", "Override", "public", "ResourceManager", "getResourceManager", "(", ")", "{", "return", "delegate", ".", "getResourceManager", "(", ");", "}", "@", "Override", "public", "void", "setCopyOnRead", "(", "boolean", "copyOnRead", ")", "{", "delegate", ".", "setCopyOnRead", "(", "copyOnRead", ")", ";", "}", "@", "Override", "public", "boolean", "getCopyOnRead", "(", ")", "{", "return", "delegate", ".", "getCopyOnRead", "(", ");", "}", "@", "Override", "public", "<", "K", ",", "V", ">", "RegionAttributes", "<", "K", ",", "V", ">", "getRegionAttributes", "(", "String", "id", ")", "{", "return", "delegate", ".", "getRegionAttributes", "(", "id", ")", ";", "}", "@", "Override", "public", "<", "K", ",", "V", ">", "void", "setRegionAttributes", "(", "String", "id", ",", "RegionAttributes", "<", "K", ",", "V", ">", "attrs", ")", "{", "delegate", ".", "setRegionAttributes", "(", "id", ",", "attrs", ")", ";", "}", "@", "Override", "public", "<", "K", ",", "V", ">", "Map", "<", "String", ",", "RegionAttributes", "<", "K", ",", "V", ">", ">", "listRegionAttributes", "(", ")", "{", "return", "delegate", ".", "listRegionAttributes", "(", ");", "}", "@", "Override", "public", "void", "loadCacheXml", "(", "InputStream", "is", ")", "throws", "TimeoutException", ",", "CacheWriterException", ",", "GatewayException", ",", "RegionExistsException", "{", "delegate", ".", "loadCacheXml", "(", "is", ")", ";", "}", "@", "Override", "public", "LogWriter", "getLogger", "(", ")", "{", "return", "delegate", ".", "getLogger", "(", ");", "}", "@", "Override", "public", "LogWriter", "getSecurityLogger", "(", ")", "{", "return", "delegate", ".", "getSecurityLogger", "(", ");", "}", "@", "Override", "public", "DiskStore", "findDiskStore", "(", "String", "name", ")", "{", "return", "delegate", ".", "findDiskStore", "(", "name", ")", ";", "}", "@", "Override", "public", "DiskStoreFactory", "createDiskStoreFactory", "(", ")", "{", "return", "delegate", ".", "createDiskStoreFactory", "(", ");", "}", "@", "Override", "public", "boolean", "getPdxReadSerialized", "(", ")", "{", "return", "delegate", ".", "getPdxReadSerialized", "(", ");", "}", "@", "Override", "public", "PdxSerializer", "getPdxSerializer", "(", ")", "{", "return", "delegate", ".", "getPdxSerializer", "(", ");", "}", "@", "Override", "public", "String", "getPdxDiskStore", "(", ")", "{", "return", "delegate", ".", "getPdxDiskStore", "(", ");", "}", "@", "Override", "public", "boolean", "getPdxPersistent", "(", ")", "{", "return", "delegate", ".", "getPdxPersistent", "(", ");", "}", "@", "Override", "public", "boolean", "getPdxIgnoreUnreadFields", "(", ")", "{", "return", "delegate", ".", "getPdxIgnoreUnreadFields", "(", ");", "}", "@", "Override", "public", "void", "registerPdxMetaData", "(", "Object", "instance", ")", "{", "delegate", ".", "registerPdxMetaData", "(", "instance", ")", ";", "}", "@", "Override", "public", "CacheTransactionManager", "getCacheTransactionManager", "(", ")", "{", "return", "delegate", ".", "getCacheTransactionManager", "(", ");", "}", "@", "Override", "public", "Context", "getJNDIContext", "(", ")", "{", "return", "delegate", ".", "getJNDIContext", "(", ");", "}", "@", "Override", "public", "Declarable", "getInitializer", "(", ")", "{", "return", "delegate", ".", "getInitializer", "(", ");", "}", "@", "Override", "public", "Properties", "getInitializerProps", "(", ")", "{", "return", "delegate", ".", "getInitializerProps", "(", ");", "}", "@", "Override", "public", "CancelCriterion", "getCancelCriterion", "(", ")", "{", "return", "delegate", ".", "getCancelCriterion", "(", ");", "}", "@", "Override", "public", "PdxInstanceFactory", "createPdxInstanceFactory", "(", "String", "className", ")", "{", "return", "delegate", ".", "createPdxInstanceFactory", "(", "className", ")", ";", "}", "@", "Override", "public", "PdxInstance", "createPdxEnum", "(", "String", "className", ",", "String", "enumName", ",", "int", "enumOrdinal", ")", "{", "return", "delegate", ".", "createPdxEnum", "(", "className", ",", "enumName", ",", "enumOrdinal", ")", ";", "}", "@", "Override", "public", "void", "close", "(", ")", "{", "delegate", ".", "close", "(", ");", "}", "@", "Override", "public", "boolean", "isClosed", "(", ")", "{", "return", "delegate", ".", "isClosed", "(", ");", "}", "@", "Override", "public", "ExtensionPoint", "<", "Cache", ">", "getExtensionPoint", "(", ")", "{", "return", "delegate", ".", "getExtensionPoint", "(", ");", "}", "@", "Override", "public", "InternalDistributedMember", "getMyId", "(", ")", "{", "return", "delegate", ".", "getMyId", "(", ");", "}", "@", "Override", "public", "Collection", "<", "DiskStore", ">", "listDiskStores", "(", ")", "{", "return", "delegate", ".", "listDiskStores", "(", ");", "}", "@", "Override", "public", "Collection", "<", "DiskStore", ">", "listDiskStoresIncludingRegionOwned", "(", ")", "{", "return", "delegate", ".", "listDiskStoresIncludingRegionOwned", "(", ");", "}", "@", "Override", "public", "CqService", "getCqService", "(", ")", "{", "return", "delegate", ".", "getCqService", "(", ");", "}", "@", "Override", "public", "<", "T", "extends", "CacheService", ">", "T", "getService", "(", "Class", "<", "T", ">", "clazz", ")", "{", "return", "delegate", ".", "getService", "(", "clazz", ")", ";", "}", "@", "Override", "public", "Collection", "<", "CacheService", ">", "getServices", "(", ")", "{", "return", "delegate", ".", "getServices", "(", ");", "}", "@", "Override", "public", "SystemTimer", "getCCPTimer", "(", ")", "{", "return", "delegate", ".", "getCCPTimer", "(", ");", "}", "@", "Override", "public", "void", "cleanupForClient", "(", "CacheClientNotifier", "ccn", ",", "ClientProxyMembershipID", "client", ")", "{", "delegate", ".", "cleanupForClient", "(", "ccn", ",", "client", ")", ";", "}", "@", "Override", "public", "void", "purgeCCPTimer", "(", ")", "{", "delegate", ".", "purgeCCPTimer", "(", ");", "}", "@", "Override", "public", "MemoryAllocator", "getOffHeapStore", "(", ")", "{", "return", "delegate", ".", "getOffHeapStore", "(", ");", "}", "@", "Override", "public", "DistributedLockService", "getPartitionedRegionLockService", "(", ")", "{", "return", "delegate", ".", "getPartitionedRegionLockService", "(", ");", "}", "@", "Override", "public", "PersistentMemberManager", "getPersistentMemberManager", "(", ")", "{", "return", "delegate", ".", "getPersistentMemberManager", "(", ");", "}", "@", "Override", "public", "Set", "<", "GatewaySender", ">", "getAllGatewaySenders", "(", ")", "{", "return", "delegate", ".", "getAllGatewaySenders", "(", ");", "}", "@", "Override", "public", "CachePerfStats", "getCachePerfStats", "(", ")", "{", "return", "delegate", ".", "getCachePerfStats", "(", ");", "}", "@", "Override", "public", "DistributionManager", "getDistributionManager", "(", ")", "{", "return", "delegate", ".", "getDistributionManager", "(", ");", "}", "@", "Override", "public", "void", "regionReinitialized", "(", "Region", "region", ")", "{", "delegate", ".", "regionReinitialized", "(", "region", ")", ";", "}", "@", "Override", "public", "void", "setRegionByPath", "(", "String", "path", ",", "InternalRegion", "r", ")", "{", "delegate", ".", "setRegionByPath", "(", "path", ",", "r", ")", ";", "}", "@", "Override", "public", "InternalResourceManager", "getInternalResourceManager", "(", ")", "{", "return", "delegate", ".", "getInternalResourceManager", "(", ");", "}", "@", "Override", "public", "ResourceAdvisor", "getResourceAdvisor", "(", ")", "{", "return", "delegate", ".", "getResourceAdvisor", "(", ");", "}", "@", "Override", "public", "boolean", "isCacheAtShutdownAll", "(", ")", "{", "return", "delegate", ".", "isCacheAtShutdownAll", "(", ");", "}", "@", "Override", "public", "boolean", "requiresNotificationFromPR", "(", "PartitionedRegion", "r", ")", "{", "return", "delegate", ".", "requiresNotificationFromPR", "(", "r", ")", ";", "}", "@", "Override", "public", "<", "K", ",", "V", ">", "RegionAttributes", "<", "K", ",", "V", ">", "invokeRegionBefore", "(", "InternalRegion", "parent", ",", "String", "name", ",", "RegionAttributes", "<", "K", ",", "V", ">", "attrs", ",", "InternalRegionArguments", "internalRegionArgs", ")", "{", "return", "delegate", ".", "invokeRegionBefore", "(", "parent", ",", "name", ",", "attrs", ",", "internalRegionArgs", ")", ";", "}", "@", "Override", "public", "void", "invokeRegionAfter", "(", "InternalRegion", "region", ")", "{", "delegate", ".", "invokeRegionAfter", "(", "region", ")", ";", "}", "@", "Override", "public", "void", "invokeBeforeDestroyed", "(", "InternalRegion", "region", ")", "{", "delegate", ".", "invokeBeforeDestroyed", "(", "region", ")", ";", "}", "@", "Override", "public", "void", "invokeCleanupFailedInitialization", "(", "InternalRegion", "region", ")", "{", "delegate", ".", "invokeCleanupFailedInitialization", "(", "region", ")", ";", "}", "@", "Override", "public", "TXManagerImpl", "getTXMgr", "(", ")", "{", "return", "delegate", ".", "getTXMgr", "(", ");", "}", "@", "Override", "public", "boolean", "forcedDisconnect", "(", ")", "{", "return", "delegate", ".", "forcedDisconnect", "(", ");", "}", "@", "Override", "public", "InternalResourceManager", "getInternalResourceManager", "(", "boolean", "checkCancellationInProgress", ")", "{", "return", "delegate", ".", "getInternalResourceManager", "(", ");", "}", "@", "Override", "public", "boolean", "isCopyOnRead", "(", ")", "{", "return", "delegate", ".", "isCopyOnRead", "(", ");", "}", "@", "Override", "public", "TombstoneService", "getTombstoneService", "(", ")", "{", "return", "delegate", ".", "getTombstoneService", "(", ");", "}", "@", "Override", "public", "QueryService", "getLocalQueryService", "(", ")", "{", "return", "delegate", ".", "getLocalQueryService", "(", ");", "}", "@", "Override", "public", "void", "registerInterestStarted", "(", ")", "{", "delegate", ".", "registerInterestStarted", "(", ");", "}", "@", "Override", "public", "void", "registerInterestCompleted", "(", ")", "{", "delegate", ".", "registerInterestCompleted", "(", ");", "}", "@", "Override", "public", "void", "regionReinitializing", "(", "String", "fullPath", ")", "{", "delegate", ".", "regionReinitializing", "(", "fullPath", ")", ";", "}", "@", "Override", "public", "void", "unregisterReinitializingRegion", "(", "String", "fullPath", ")", "{", "delegate", ".", "unregisterReinitializingRegion", "(", "fullPath", ")", ";", "}", "@", "Override", "public", "boolean", "removeRoot", "(", "InternalRegion", "rootRgn", ")", "{", "return", "delegate", ".", "removeRoot", "(", "rootRgn", ")", ";", "}", "@", "Override", "public", "Executor", "getEventThreadPool", "(", ")", "{", "return", "delegate", ".", "getEventThreadPool", "(", ");", "}", "@", "Override", "public", "boolean", "keepDurableSubscriptionsAlive", "(", ")", "{", "return", "delegate", ".", "keepDurableSubscriptionsAlive", "(", ");", "}", "@", "Override", "public", "CacheClosedException", "getCacheClosedException", "(", "String", "reason", ")", "{", "return", "delegate", ".", "getCacheClosedException", "(", "reason", ")", ";", "}", "@", "Override", "public", "CacheClosedException", "getCacheClosedException", "(", "String", "reason", ",", "Throwable", "cause", ")", "{", "return", "delegate", ".", "getCacheClosedException", "(", "reason", ",", "cause", ")", ";", "}", "@", "Override", "public", "TypeRegistry", "getPdxRegistry", "(", ")", "{", "return", "delegate", ".", "getPdxRegistry", "(", ");", "}", "@", "Override", "public", "DiskStoreImpl", "getOrCreateDefaultDiskStore", "(", ")", "{", "return", "delegate", ".", "getOrCreateDefaultDiskStore", "(", ");", "}", "@", "Override", "public", "ExpirationScheduler", "getExpirationScheduler", "(", ")", "{", "return", "delegate", ".", "getExpirationScheduler", "(", ");", "}", "@", "Override", "public", "TransactionManager", "getJTATransactionManager", "(", ")", "{", "return", "delegate", ".", "getJTATransactionManager", "(", ");", "}", "@", "Override", "public", "TXManagerImpl", "getTxManager", "(", ")", "{", "return", "delegate", ".", "getTxManager", "(", ");", "}", "@", "Override", "public", "void", "beginDestroy", "(", "String", "path", ",", "DistributedRegion", "region", ")", "{", "delegate", ".", "beginDestroy", "(", "path", ",", "region", ")", ";", "}", "@", "Override", "public", "void", "endDestroy", "(", "String", "path", ",", "DistributedRegion", "region", ")", "{", "delegate", ".", "endDestroy", "(", "path", ",", "region", ")", ";", "}", "@", "Override", "public", "ClientMetadataService", "getClientMetadataService", "(", ")", "{", "return", "delegate", ".", "getClientMetadataService", "(", ");", "}", "@", "Override", "public", "long", "cacheTimeMillis", "(", ")", "{", "return", "delegate", ".", "cacheTimeMillis", "(", ");", "}", "@", "Override", "public", "URL", "getCacheXmlURL", "(", ")", "{", "return", "delegate", ".", "getCacheXmlURL", "(", ");", "}", "@", "Override", "public", "List", "<", "File", ">", "getBackupFiles", "(", ")", "{", "return", "delegate", ".", "getBackupFiles", "(", ");", "}", "@", "Override", "public", "boolean", "isClient", "(", ")", "{", "return", "delegate", ".", "isClient", "(", ");", "}", "@", "Override", "public", "InternalDistributedSystem", "getInternalDistributedSystem", "(", ")", "{", "return", "delegate", ".", "getInternalDistributedSystem", "(", ");", "}", "@", "Override", "public", "void", "addRegionListener", "(", "RegionListener", "regionListener", ")", "{", "delegate", ".", "addRegionListener", "(", "regionListener", ")", ";", "}", "@", "Override", "public", "void", "removeRegionListener", "(", "RegionListener", "regionListener", ")", "{", "delegate", ".", "removeRegionListener", "(", "regionListener", ")", ";", "}", "@", "Override", "public", "Set", "<", "RegionListener", ">", "getRegionListeners", "(", ")", "{", "return", "delegate", ".", "getRegionListeners", "(", ");", "}", "@", "Override", "public", "CacheConfig", "getCacheConfig", "(", ")", "{", "return", "delegate", ".", "getCacheConfig", "(", ");", "}", "@", "Override", "public", "boolean", "getPdxReadSerializedByAnyGemFireServices", "(", ")", "{", "return", "delegate", ".", "getPdxReadSerializedByAnyGemFireServices", "(", ");", "}", "@", "Override", "public", "void", "setDeclarativeCacheConfig", "(", "CacheConfig", "cacheConfig", ")", "{", "delegate", ".", "setDeclarativeCacheConfig", "(", "cacheConfig", ")", ";", "}", "@", "Override", "public", "void", "initializePdxRegistry", "(", ")", "{", "delegate", ".", "initializePdxRegistry", "(", ");", "}", "@", "Override", "public", "void", "readyDynamicRegionFactory", "(", ")", "{", "delegate", ".", "readyDynamicRegionFactory", "(", ");", "}", "@", "Override", "public", "void", "setBackupFiles", "(", "List", "<", "File", ">", "backups", ")", "{", "delegate", ".", "setBackupFiles", "(", "backups", ")", ";", "}", "@", "Override", "public", "void", "addDeclarableProperties", "(", "Map", "<", "Declarable", ",", "Properties", ">", "mapOfNewDeclarableProps", ")", "{", "delegate", ".", "addDeclarableProperties", "(", "mapOfNewDeclarableProps", ")", ";", "}", "@", "Override", "public", "void", "setInitializer", "(", "Declarable", "initializer", ",", "Properties", "initializerProps", ")", "{", "delegate", ".", "setInitializer", "(", "initializer", ",", "initializerProps", ")", ";", "}", "@", "Override", "public", "boolean", "hasPool", "(", ")", "{", "return", "delegate", ".", "hasPool", "(", ");", "}", "@", "Override", "public", "DiskStoreFactory", "createDiskStoreFactory", "(", "DiskStoreAttributes", "attrs", ")", "{", "return", "delegate", ".", "createDiskStoreFactory", "(", "attrs", ")", ";", "}", "@", "Override", "public", "void", "determineDefaultPool", "(", ")", "{", "delegate", ".", "determineDefaultPool", "(", ");", "}", "@", "Override", "public", "BackupService", "getBackupService", "(", ")", "{", "return", "delegate", ".", "getBackupService", "(", ");", "}", "@", "Override", "public", "Throwable", "getDisconnectCause", "(", ")", "{", "return", "delegate", ".", "getDisconnectCause", "(", ");", "}", "@", "Override", "public", "void", "addPartitionedRegion", "(", "PartitionedRegion", "region", ")", "{", "delegate", ".", "addPartitionedRegion", "(", "region", ")", ";", "}", "@", "Override", "public", "void", "removePartitionedRegion", "(", "PartitionedRegion", "region", ")", "{", "delegate", ".", "removePartitionedRegion", "(", "region", ")", ";", "}", "@", "Override", "public", "void", "addDiskStore", "(", "DiskStoreImpl", "dsi", ")", "{", "delegate", ".", "addDiskStore", "(", "dsi", ")", ";", "}", "@", "Override", "public", "TXEntryStateFactory", "getTXEntryStateFactory", "(", ")", "{", "return", "delegate", ".", "getTXEntryStateFactory", "(", ");", "}", "@", "Override", "public", "EventTrackerExpiryTask", "getEventTrackerTask", "(", ")", "{", "return", "delegate", ".", "getEventTrackerTask", "(", ");", "}", "@", "Override", "public", "void", "removeDiskStore", "(", "DiskStoreImpl", "diskStore", ")", "{", "delegate", ".", "removeDiskStore", "(", "diskStore", ")", ";", "}", "@", "Override", "public", "void", "addGatewaySender", "(", "GatewaySender", "sender", ")", "{", "delegate", ".", "addGatewaySender", "(", "sender", ")", ";", "}", "@", "Override", "public", "void", "addAsyncEventQueue", "(", "AsyncEventQueueImpl", "asyncQueue", ")", "{", "delegate", ".", "addAsyncEventQueue", "(", "asyncQueue", ")", ";", "}", "@", "Override", "public", "void", "removeAsyncEventQueue", "(", "AsyncEventQueue", "asyncQueue", ")", "{", "delegate", ".", "removeAsyncEventQueue", "(", "asyncQueue", ")", ";", "}", "@", "Override", "public", "QueryMonitor", "getQueryMonitor", "(", ")", "{", "return", "delegate", ".", "getQueryMonitor", "(", ");", "}", "@", "Override", "public", "void", "close", "(", "String", "reason", ",", "Throwable", "systemFailureCause", ",", "boolean", "keepAlive", ",", "boolean", "keepDS", ")", "{", "delegate", ".", "close", "(", "reason", ",", "systemFailureCause", ",", "keepAlive", ",", "keepDS", ")", ";", "}", "@", "Override", "public", "JmxManagerAdvisor", "getJmxManagerAdvisor", "(", ")", "{", "return", "delegate", ".", "getJmxManagerAdvisor", "(", ");", "}", "@", "Override", "public", "List", "<", "Properties", ">", "getDeclarableProperties", "(", "String", "className", ")", "{", "return", "delegate", ".", "getDeclarableProperties", "(", "className", ")", ";", "}", "@", "Override", "public", "int", "getUpTime", "(", ")", "{", "return", "delegate", ".", "getUpTime", "(", ");", "}", "@", "Override", "public", "void", "addRegionOwnedDiskStore", "(", "DiskStoreImpl", "dsi", ")", "{", "delegate", ".", "addRegionOwnedDiskStore", "(", "dsi", ")", ";", "}", "@", "Override", "public", "DiskStoreMonitor", "getDiskStoreMonitor", "(", ")", "{", "return", "delegate", ".", "getDiskStoreMonitor", "(", ");", "}", "@", "Override", "public", "void", "close", "(", "String", "reason", ",", "Throwable", "optionalCause", ")", "{", "delegate", ".", "close", "(", "reason", ",", "optionalCause", ")", ";", "}", "@", "Override", "public", "List", "getCacheServersAndGatewayReceiver", "(", ")", "{", "return", "delegate", ".", "getCacheServersAndGatewayReceiver", "(", ");", "}", "@", "Override", "public", "boolean", "isGlobalRegionInitializing", "(", "String", "fullPath", ")", "{", "return", "delegate", ".", "isGlobalRegionInitializing", "(", "fullPath", ")", ";", "}", "@", "Override", "public", "DistributionAdvisor", "getDistributionAdvisor", "(", ")", "{", "return", "delegate", ".", "getDistributionAdvisor", "(", ");", "}", "@", "Override", "public", "void", "setQueryMonitorRequiredForResourceManager", "(", "boolean", "required", ")", "{", "delegate", ".", "setQueryMonitorRequiredForResourceManager", "(", "required", ")", ";", "}", "@", "Override", "public", "boolean", "isQueryMonitorDisabledForLowMemory", "(", ")", "{", "return", "delegate", ".", "isQueryMonitorDisabledForLowMemory", "(", ");", "}", "@", "Override", "public", "boolean", "isRESTServiceRunning", "(", ")", "{", "return", "delegate", ".", "isRESTServiceRunning", "(", ");", "}", "@", "Override", "public", "InternalLogWriter", "getInternalLogWriter", "(", ")", "{", "return", "delegate", ".", "getInternalLogWriter", "(", ");", "}", "@", "Override", "public", "InternalLogWriter", "getSecurityInternalLogWriter", "(", ")", "{", "return", "delegate", ".", "getSecurityInternalLogWriter", "(", ");", "}", "@", "Override", "public", "Set", "<", "InternalRegion", ">", "getApplicationRegions", "(", ")", "{", "return", "delegate", ".", "getApplicationRegions", "(", ");", "}", "@", "Override", "public", "void", "removeGatewaySender", "(", "GatewaySender", "sender", ")", "{", "delegate", ".", "removeGatewaySender", "(", "sender", ")", ";", "}", "@", "Override", "public", "DistributedLockService", "getGatewaySenderLockService", "(", ")", "{", "return", "delegate", ".", "getGatewaySenderLockService", "(", ");", "}", "@", "Override", "public", "RestAgent", "getRestAgent", "(", ")", "{", "return", "delegate", ".", "getRestAgent", "(", ");", "}", "@", "Override", "public", "Properties", "getDeclarableProperties", "(", "Declarable", "declarable", ")", "{", "return", "delegate", ".", "getDeclarableProperties", "(", "declarable", ")", ";", "}", "@", "Override", "public", "void", "setRESTServiceRunning", "(", "boolean", "isRESTServiceRunning", ")", "{", "delegate", ".", "setRESTServiceRunning", "(", "isRESTServiceRunning", ")", ";", "}", "@", "Override", "public", "void", "close", "(", "String", "reason", ",", "boolean", "keepAlive", ",", "boolean", "keepDS", ")", "{", "delegate", ".", "close", "(", "reason", ",", "keepAlive", ",", "keepDS", ")", ";", "}", "@", "Override", "public", "void", "addGatewayReceiver", "(", "GatewayReceiver", "receiver", ")", "{", "delegate", ".", "addGatewayReceiver", "(", "receiver", ")", ";", "}", "@", "Override", "public", "void", "removeGatewayReceiver", "(", "GatewayReceiver", "receiver", ")", "{", "delegate", ".", "removeGatewayReceiver", "(", "receiver", ")", ";", "}", "@", "Override", "public", "CacheServer", "addCacheServer", "(", "boolean", "isGatewayReceiver", ")", "{", "return", "delegate", ".", "addCacheServer", "(", "isGatewayReceiver", ")", ";", "}", "@", "Override", "public", "boolean", "removeCacheServer", "(", "CacheServer", "cacheServer", ")", "{", "return", "delegate", ".", "removeCacheServer", "(", "cacheServer", ")", ";", "}", "@", "Override", "public", "void", "setReadSerializedForTest", "(", "boolean", "value", ")", "{", "delegate", ".", "setReadSerializedForTest", "(", "value", ")", ";", "}", "@", "Override", "public", "void", "setReadSerializedForCurrentThread", "(", "boolean", "value", ")", "{", "delegate", ".", "setReadSerializedForCurrentThread", "(", "value", ")", ";", "}", "@", "Override", "public", "PdxInstanceFactory", "createPdxInstanceFactory", "(", "String", "className", ",", "boolean", "expectDomainClass", ")", "{", "return", "delegate", ".", "createPdxInstanceFactory", "(", "className", ",", "expectDomainClass", ")", ";", "}", "@", "Override", "public", "void", "waitForRegisterInterestsInProgress", "(", ")", "{", "delegate", ".", "waitForRegisterInterestsInProgress", "(", ");", "}", "@", "Override", "public", "void", "reLoadClusterConfiguration", "(", ")", "throws", "IOException", ",", "ClassNotFoundException", "{", "delegate", ".", "reLoadClusterConfiguration", "(", ");", "}", "@", "Override", "public", "SecurityService", "getSecurityService", "(", ")", "{", "return", "delegate", ".", "getSecurityService", "(", ");", "}", "@", "Override", "public", "boolean", "hasPersistentRegion", "(", ")", "{", "return", "delegate", ".", "hasPersistentRegion", "(", ");", "}", "@", "Override", "public", "void", "shutDownAll", "(", ")", "{", "delegate", ".", "shutDownAll", "(", ");", "}", "@", "Override", "public", "void", "invokeRegionEntrySynchronizationListenersAfterSynchronization", "(", "InternalDistributedMember", "sender", ",", "InternalRegion", "region", ",", "List", "<", "Entry", ">", "entriesToSynchronize", ")", "{", "delegate", ".", "invokeRegionEntrySynchronizationListenersAfterSynchronization", "(", "sender", ",", "region", ",", "entriesToSynchronize", ")", ";", "}", "@", "Override", "public", "InternalQueryService", "getQueryService", "(", ")", "{", "return", "delegate", ".", "getQueryService", "(", ");", "}", "@", "Override", "public", "Set", "<", "AsyncEventQueue", ">", "getAsyncEventQueues", "(", "boolean", "visibleOnly", ")", "{", "return", "delegate", ".", "getAsyncEventQueues", "(", "visibleOnly", ")", ";", "}", "@", "Override", "public", "void", "closeDiskStores", "(", ")", "{", "delegate", ".", "closeDiskStores", "(", ");", "}", "@", "Override", "public", "Object", "convertPdxInstanceIfNeeded", "(", "Object", "obj", ",", "boolean", "preferCD", ")", "{", "return", "delegate", ".", "convertPdxInstanceIfNeeded", "(", "obj", ",", "preferCD", ")", ";", "}", "@", "Override", "public", "Boolean", "getPdxReadSerializedOverride", "(", ")", "{", "return", "delegate", ".", "getPdxReadSerializedOverride", "(", ");", "}", "@", "Override", "public", "void", "setPdxReadSerializedOverride", "(", "boolean", "pdxReadSerialized", ")", "{", "delegate", ".", "setPdxReadSerializedOverride", "(", "pdxReadSerialized", ")", ";", "}", "@", "Override", "public", "InternalCache", "getCacheForProcessingClientRequests", "(", ")", "{", "return", "this", ";", "}", "}", "@", "@", "-", "2369", ",", "4", "+", "2369", ",", "9", "@", "@", "public", "void", "setPdxReadSerializedOverride", "(", "boolean", "pdxReadSerialized", ")", "{", "public", "void", "registerPdxMetaData", "(", "Object", "instance", ")", "{", "throw", "new", "UnsupportedOperationException", "(", "LocalizedStrings", ".", "SHOULDNT_INVOKE", ".", "toLocalizedString", "(", "))", ";", "}", "@", "Override", "public", "InternalCache", "getCacheForProcessingClientRequests", "(", ")", "{", "throw", "new", "UnsupportedOperationException", "(", "LocalizedStrings", ".", "SHOULDNT_INVOKE", ".", "toLocalizedString", "(", "))", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "332", "@", "@", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "geode", ".", "internal", ".", "cache", ";", "import", "static", "org", ".", "assertj", ".", "core", ".", "api", ".", "Assertions", ".", "assertThat", ";", "import", "static", "org", ".", "assertj", ".", "core", ".", "api", ".", "Assertions", ".", "assertThatThrownBy", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "any", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "mock", ";", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "when", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "junit", ".", "experimental", ".", "categories", ".", "Category", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "Cache", ";", "import", "org", ".", "apache", ".", "geode", ".", "cache", ".", "Region", ";", "import", "org", ".", "apache", ".", "geode", ".", "security", ".", "NotAuthorizedException", ";", "import", "org", ".", "apache", ".", "geode", ".", "test", ".", "junit", ".", "categories", ".", "UnitTest", ";", "@", "Category", "(", "UnitTest", ".", "class", ")", "public", "class", "InternalCacheForClientAccessTest", "{", "private", "InternalCache", "delegate", ";", "private", "InternalCacheForClientAccess", "cache", ";", "private", "DistributedRegion", "secretRegion", ";", "private", "DistributedRegion", "applicationRegion", ";", "private", "Set", "applicationRegions", ";", "private", "Set", "secretRegions", ";", "@", "Before", "public", "void", "setup", "(", ")", "{", "delegate", "=", "mock", "(", "InternalCache", ".", "class", ")", ";", "cache", "=", "new", "InternalCacheForClientAccess", "(", "delegate", ")", ";", "secretRegion", "=", "mock", "(", "DistributedRegion", ".", "class", ")", ";", "when", "(", "secretRegion", ".", "isInternalRegion", "(", "))", ".", "thenReturn", "(", "true", ")", ";", "applicationRegion", "=", "mock", "(", "DistributedRegion", ".", "class", ")", ";", "when", "(", "applicationRegion", ".", "isInternalRegion", "(", "))", ".", "thenReturn", "(", "false", ")", ";", "applicationRegions", "=", "Collections", ".", "singleton", "(", "applicationRegion", ")", ";", "secretRegions", "=", "Collections", ".", "singleton", "(", "secretRegion", ")", ";", "}", "@", "Test", "public", "void", "getRegionWithApplicationWorks", "(", ")", "{", "when", "(", "delegate", ".", "getRegion", "(", "\"", "application", "\"", "))", ".", "thenReturn", "(", "applicationRegion", ")", ";", "Region", "result", "=", "cache", ".", "getRegion", "(", "\"", "application", "\"", ");", "assertThat", "(", "result", ")", ".", "isSameAs", "(", "applicationRegion", ")", ";", "}", "@", "Test", "public", "void", "getRegionWithSecretThrows", "(", ")", "{", "when", "(", "delegate", ".", "getRegion", "(", "\"", "secret", "\"", "))", ".", "thenReturn", "(", "secretRegion", ")", ";", "assertThatThrownBy", "(", "()", "-", ">", "{", "cache", ".", "getRegion", "(", "\"", "secret", "\"", ");", "}", ").", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "getFilterProfileWithApplicationWorks", "(", ")", "{", "when", "(", "delegate", ".", "getRegion", "(", "\"", "application", "\"", ",", "true", ")", ").", "thenReturn", "(", "applicationRegion", ")", ";", "FilterProfile", "filterProfile", "=", "mock", "(", "FilterProfile", ".", "class", ")", ";", "when", "(", "applicationRegion", ".", "getFilterProfile", "(", "))", ".", "thenReturn", "(", "filterProfile", ")", ";", "FilterProfile", "result", "=", "cache", ".", "getFilterProfile", "(", "\"", "application", "\"", ");", "assertThat", "(", "result", ")", ".", "isSameAs", "(", "filterProfile", ")", ";", "}", "@", "Test", "public", "void", "getFilterProfileWithSecretThrows", "(", ")", "{", "when", "(", "delegate", ".", "getRegion", "(", "\"", "secret", "\"", ",", "true", ")", ").", "thenReturn", "(", "secretRegion", ")", ";", "assertThatThrownBy", "(", "()", "-", ">", "{", "cache", ".", "getFilterProfile", "(", "\"", "secret", "\"", ");", "}", ").", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "getRegionBooleanWithApplicationWorks", "(", ")", "{", "when", "(", "delegate", ".", "getRegion", "(", "\"", "application", "\"", ",", "true", ")", ").", "thenReturn", "(", "applicationRegion", ")", ";", "Region", "result", "=", "cache", ".", "getRegion", "(", "\"", "application", "\"", ",", "true", ")", ";", "assertThat", "(", "result", ")", ".", "isSameAs", "(", "applicationRegion", ")", ";", "}", "@", "Test", "public", "void", "getRegionBooleanWithSecretThrows", "(", ")", "{", "when", "(", "delegate", ".", "getRegion", "(", "\"", "secret", "\"", ",", "false", ")", ").", "thenReturn", "(", "secretRegion", ")", ";", "assertThatThrownBy", "(", "()", "-", ">", "{", "cache", ".", "getRegion", "(", "\"", "secret", "\"", ",", "false", ")", ";", "}", ").", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "getReinitializingRegionWithApplicationWorks", "(", ")", "{", "when", "(", "delegate", ".", "getReinitializingRegion", "(", "\"", "application", "\"", "))", ".", "thenReturn", "(", "applicationRegion", ")", ";", "Region", "result", "=", "cache", ".", "getReinitializingRegion", "(", "\"", "application", "\"", ");", "assertThat", "(", "result", ")", ".", "isSameAs", "(", "applicationRegion", ")", ";", "}", "@", "Test", "public", "void", "getReinitializingRegionWithSecretThrows", "(", ")", "{", "when", "(", "delegate", ".", "getReinitializingRegion", "(", "\"", "secret", "\"", "))", ".", "thenReturn", "(", "secretRegion", ")", ";", "assertThatThrownBy", "(", "()", "-", ">", "{", "cache", ".", "getReinitializingRegion", "(", "\"", "secret", "\"", ");", "}", ").", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "getRegionByPathWithApplicationWorks", "(", ")", "{", "when", "(", "delegate", ".", "getRegionByPath", "(", "\"", "application", "\"", "))", ".", "thenReturn", "(", "applicationRegion", ")", ";", "Region", "result", "=", "cache", ".", "getRegionByPath", "(", "\"", "application", "\"", ");", "assertThat", "(", "result", ")", ".", "isSameAs", "(", "applicationRegion", ")", ";", "}", "@", "Test", "public", "void", "getRegionByPathWithSecretThrows", "(", ")", "{", "when", "(", "delegate", ".", "getRegionByPath", "(", "\"", "secret", "\"", "))", ".", "thenReturn", "(", "secretRegion", ")", ";", "assertThatThrownBy", "(", "()", "-", ">", "{", "cache", ".", "getRegionByPath", "(", "\"", "secret", "\"", ");", "}", ").", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "getRegionByPathForProcessingWithApplicationWorks", "(", ")", "{", "when", "(", "delegate", ".", "getRegionByPathForProcessing", "(", "\"", "application", "\"", "))", ".", "thenReturn", "(", "applicationRegion", ")", ";", "Region", "result", "=", "cache", ".", "getRegionByPathForProcessing", "(", "\"", "application", "\"", ");", "assertThat", "(", "result", ")", ".", "isSameAs", "(", "applicationRegion", ")", ";", "}", "@", "Test", "public", "void", "getRegionByPathForProcessingWithSecretThrows", "(", ")", "{", "when", "(", "delegate", ".", "getRegionByPathForProcessing", "(", "\"", "secret", "\"", "))", ".", "thenReturn", "(", "secretRegion", ")", ";", "assertThatThrownBy", "(", "()", "-", ">", "{", "cache", ".", "getRegionByPathForProcessing", "(", "\"", "secret", "\"", ");", "}", ").", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "getRegionInDestroyWithApplicationWorks", "(", ")", "{", "when", "(", "delegate", ".", "getRegionInDestroy", "(", "\"", "application", "\"", "))", ".", "thenReturn", "(", "applicationRegion", ")", ";", "Region", "result", "=", "cache", ".", "getRegionInDestroy", "(", "\"", "application", "\"", ");", "assertThat", "(", "result", ")", ".", "isSameAs", "(", "applicationRegion", ")", ";", "}", "@", "Test", "public", "void", "getRegionInDestroyWithSecretThrows", "(", ")", "{", "when", "(", "delegate", ".", "getRegionInDestroy", "(", "\"", "secret", "\"", "))", ".", "thenReturn", "(", "secretRegion", ")", ";", "assertThatThrownBy", "(", "()", "-", ">", "{", "cache", ".", "getRegionInDestroy", "(", "\"", "secret", "\"", ");", "}", ").", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "getPartitionedRegionsWithApplicationWorks", "(", ")", "{", "when", "(", "delegate", ".", "getPartitionedRegions", "(", "))", ".", "thenReturn", "(", "applicationRegions", ")", ";", "Set", "result", "=", "cache", ".", "getPartitionedRegions", "(", ");", "assertThat", "(", "result", ")", ".", "isSameAs", "(", "applicationRegions", ")", ";", "}", "@", "Test", "public", "void", "getPartitionedRegionsWithSecretThrows", "(", ")", "{", "when", "(", "delegate", ".", "getPartitionedRegions", "(", "))", ".", "thenReturn", "(", "secretRegions", ")", ";", "assertThatThrownBy", "(", "()", "-", ">", "{", "cache", ".", "getPartitionedRegions", "(", ");", "}", ").", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "rootRegionsWithApplicationWorks", "(", ")", "{", "when", "(", "delegate", ".", "rootRegions", "(", "))", ".", "thenReturn", "(", "applicationRegions", ")", ";", "Set", "result", "=", "cache", ".", "rootRegions", "(", ");", "assertThat", "(", "result", ")", ".", "isSameAs", "(", "applicationRegions", ")", ";", "}", "@", "Test", "public", "void", "rootRegionsWithSecretThrows", "(", ")", "{", "when", "(", "delegate", ".", "rootRegions", "(", "))", ".", "thenReturn", "(", "secretRegions", ")", ";", "assertThatThrownBy", "(", "()", "-", ">", "{", "cache", ".", "rootRegions", "(", ");", "}", ").", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "rootRegionsWithParameterWithApplicationWorks", "(", ")", "{", "when", "(", "delegate", ".", "rootRegions", "(", "true", ")", ").", "thenReturn", "(", "applicationRegions", ")", ";", "Set", "result", "=", "cache", ".", "rootRegions", "(", "true", ")", ";", "assertThat", "(", "result", ")", ".", "isSameAs", "(", "applicationRegions", ")", ";", "}", "@", "Test", "public", "void", "rootRegionsWithParameterWithSecretThrows", "(", ")", "{", "when", "(", "delegate", ".", "rootRegions", "(", "true", ")", ").", "thenReturn", "(", "secretRegions", ")", ";", "assertThatThrownBy", "(", "()", "-", ">", "{", "cache", ".", "rootRegions", "(", "true", ")", ";", "}", ").", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "getAllRegionsWithApplicationWorks", "(", ")", "{", "when", "(", "delegate", ".", "getAllRegions", "(", "))", ".", "thenReturn", "(", "applicationRegions", ")", ";", "Set", "result", "=", "cache", ".", "getAllRegions", "(", ");", "assertThat", "(", "result", ")", ".", "isSameAs", "(", "applicationRegions", ")", ";", "}", "@", "Test", "public", "void", "getAllRegionsWithSecretThrows", "(", ")", "{", "when", "(", "delegate", ".", "getAllRegions", "(", "))", ".", "thenReturn", "(", "secretRegions", ")", ";", "assertThatThrownBy", "(", "()", "-", ">", "{", "cache", ".", "getAllRegions", "(", ");", "}", ").", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "createVMRegionWithNullArgsApplicationWorks", "(", ")", "throws", "Exception", "{", "when", "(", "delegate", ".", "createVMRegion", "(", "any", "(", "),", "any", "(", "),", "any", "(", "))", ").", "thenReturn", "(", "applicationRegion", ")", ";", "Region", "result", "=", "cache", ".", "createVMRegion", "(", "null", ",", "null", ",", "null", ")", ";", "assertThat", "(", "result", ")", ".", "isSameAs", "(", "applicationRegion", ")", ";", "}", "@", "Test", "public", "void", "createVMRegionWithDefaultArgsApplicationWorks", "(", ")", "throws", "Exception", "{", "when", "(", "delegate", ".", "createVMRegion", "(", "any", "(", "),", "any", "(", "),", "any", "(", "))", ").", "thenReturn", "(", "applicationRegion", ")", ";", "Region", "result", "=", "cache", ".", "createVMRegion", "(", "null", ",", "null", ",", "new", "InternalRegionArguments", "(", "))", ";", "assertThat", "(", "result", ")", ".", "isSameAs", "(", "applicationRegion", ")", ";", "}", "@", "Test", "public", "void", "createVMRegionWithInternalRegionThrows", "(", ")", "throws", "Exception", "{", "assertThatThrownBy", "(", "()", "-", ">", "{", "cache", ".", "createVMRegion", "(", "null", ",", "null", ",", "new", "InternalRegionArguments", "(", ").", "setInternalRegion", "(", "true", ")", ");", "}", ").", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "createVMRegionWithUsedForPartitionedRegionBucketThrows", "(", ")", "throws", "Exception", "{", "assertThatThrownBy", "(", "()", "-", ">", "{", "cache", ".", "createVMRegion", "(", "null", ",", "null", ",", "new", "InternalRegionArguments", "(", ").", "setPartitionedRegionBucketRedundancy", "(", "0", ")", ");", "}", ").", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "createVMRegionWithUsedForMetaRegionThrows", "(", ")", "throws", "Exception", "{", "assertThatThrownBy", "(", "()", "-", ">", "{", "cache", ".", "createVMRegion", "(", "null", ",", "null", ",", "new", "InternalRegionArguments", "(", ").", "setIsUsedForMetaRegion", "(", "true", ")", ");", "}", ").", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "createVMRegionWithUsedForSerialGatewaySenderQueueThrows", "(", ")", "throws", "Exception", "{", "assertThatThrownBy", "(", "()", "-", ">", "{", "cache", ".", "createVMRegion", "(", "null", ",", "null", ",", "new", "InternalRegionArguments", "(", ").", "setIsUsedForSerialGatewaySenderQueue", "(", "true", ")", ");", "}", ").", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "createVMRegionWithUsedForParallelGatewaySenderQueueThrows", "(", ")", "throws", "Exception", "{", "assertThatThrownBy", "(", "()", "-", ">", "{", "cache", ".", "createVMRegion", "(", "null", ",", "null", ",", "new", "InternalRegionArguments", "(", ").", "setIsUsedForParallelGatewaySenderQueue", "(", "true", ")", ");", "}", ").", "isInstanceOf", "(", "NotAuthorizedException", ".", "class", ")", ";", "}", "@", "Test", "public", "void", "getReconnectedCacheReturnsNull", "(", ")", "throws", "Exception", "{", "when", "(", "delegate", ".", "getReconnectedCache", "(", "))", ".", "thenReturn", "(", "null", ")", ";", "Cache", "result", "=", "cache", ".", "getReconnectedCache", "(", ");", "assertThat", "(", "result", ")", ".", "isNull", "(", ");", "}", "@", "Test", "public", "void", "getReconnectedCacheReturnsWrappedCache", "(", ")", "throws", "Exception", "{", "when", "(", "delegate", ".", "getReconnectedCache", "(", "))", ".", "thenReturn", "(", "delegate", ")", ";", "Cache", "result", "=", "cache", ".", "getReconnectedCache", "(", ");", "assertThat", "(", "result", ")", ".", "isInstanceOf", "(", "InternalCacheForClientAccess", ".", "class", ")", ";", "}", "}"], "docstring_tokens": ["a", "flaw", "when", "operating", "in", "secure", "mode"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "502", ",", "6", "+", "502", ",", "13", "@", "@", "static", "int", "rds_rdma_pages", "(", "struct", "rds_rdma_args", "*", "args", ")", "return", "-", "EINVAL", ";", "tot_pages", "+", "=", "nr_pages", ";", "/", "*", "*", "nr_pages", "for", "one", "entry", "is", "limited", "to", "(", "UINT_MAX", ">", ">", "PAGE_SHIFT", ")", "+", "1", ",", "*", "so", "tot_pages", "cannot", "overflow", "without", "first", "going", "negative", ".", "*", "/", "if", "(", "(", "int", ")", "tot_pages", "<", "0", ")", "return", "-", "EINVAL", ";", "}", "return", "tot_pages", ";"], "docstring_tokens": ["an", "incomplete", "fix"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "59", ",", "20", "+", "59", ",", "23", "@", "@", "ENTRY", "(", "startup_continue", ")", ".", "quad", "0", "#", "cr12", ":", "tracing", "off", ".", "quad", "0", "#", "cr13", ":", "home", "space", "segment", "table", ".", "quad", "0xc0000000", "#", "cr14", ":", "machine", "check", "handling", "off", ".", "quad", "0", "#", "cr15", ":", "linkage", "stack", "operations", ".", "quad", ".", "Llinkage_stack", "#", "cr15", ":", "linkage", "stack", "operations", ".", "Lpcmsk", ":", ".", "quad", "0x0000000180000000", ".", "L4malign", ":", ".", "quad", "0xffffffffffc00000", ".", "Lscan2g", ":", ".", "quad", "0x80000000", "+", "0x20000", "-", "8", "#", "2GB", "+", "128K", "-", "8", ".", "Lnop", ":", ".", "long", "0x07000700", ".", "Lparmaddr", ":", ".", "quad", "PARMAREA", ".", "align", "64", ".", "Lduct", ":", ".", "long", "0", ",", "0", ",", "0", ",", "0", ",", ".", "Lduald", ",", "0", ",", "0", ",", "0", ".", "Lduct", ":", ".", "long", "0", ",", ".", "Laste", ",", ".", "Laste", ",", "0", ",", ".", "Lduald", ",", "0", ",", "0", ",", "0", ".", "long", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ".", "Laste", ":", ".", "quad", "0", ",", "0xffffffffffffffff", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ".", "align", "128", ".", "Lduald", ":", ".", "rept", "8", ".", "long", "0x80000000", ",", "0", ",", "0", ",", "0", "#", "invalid", "access", "-", "list", "entries", ".", "endr", ".", "Llinkage_stack", ":", ".", "long", "0", ",", "0", ",", "0x89000000", ",", "0", ",", "0", ",", "0", ",", "0x8a000000", ",", "0", "ENTRY", "(", "_ehead", ")"], "docstring_tokens": ["does", "not", "properly", "handle", "attempted", "use", "of", "the", "linkage", "stack"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1926", ",", "7", "+", "1926", ",", "7", "@", "@", "static", "ssize_t", "ocfs2_file_splice_write", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "out", "-", ">", "f_path", ".", "dentry", "-", ">", "d_name", ".", "len", ",", "out", "-", ">", "f_path", ".", "dentry", "-", ">", "d_name", ".", "name", ")", ";", "inode_double_lock", "(", "inode", ",", "pipe", "-", ">", "inode", ")", ";", "mutex_lock_nested", "(", "&", "inode", "-", ">", "i_mutex", ",", "I_MUTEX_PARENT", ")", ";", "ret", "=", "ocfs2_rw_lock", "(", "inode", ",", "1", ")", ";", "if", "(", "ret", "<", "0", ")", "{", "@", "@", "-", "1941", ",", "12", "+", "1941", ",", "16", "@", "@", "static", "ssize_t", "ocfs2_file_splice_write", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "goto", "out_unlock", ";", "}", "if", "(", "pipe", "-", ">", "inode", ")", "mutex_lock_nested", "(", "&", "pipe", "-", ">", "inode", "-", ">", "i_mutex", ",", "I_MUTEX_CHILD", ")", ";", "ret", "=", "generic_file_splice_write_nolock", "(", "pipe", ",", "out", ",", "ppos", ",", "len", ",", "flags", ")", ";", "if", "(", "pipe", "-", ">", "inode", ")", "mutex_unlock", "(", "&", "pipe", "-", ">", "inode", "-", ">", "i_mutex", ")", ";", "out_unlock", ":", "ocfs2_rw_unlock", "(", "inode", ",", "1", ")", ";", "out", ":", "inode_double_unlock", "(", "inode", ",", "pipe", "-", ">", "inode", ")", ";", "mutex_unlock", "(", "&", "inode", "-", ">", "i_mutex", ")", ";", "mlog_exit", "(", "ret", ")", ";", "return", "ret", ";", "@", "@", "-", "737", ",", "10", "+", "737", ",", "19", "@", "@", "ssize_t", "splice_from_pipe", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "struct", "file", "*", "out", ",", "*", "-", ">", "write_end", ".", "Most", "of", "the", "time", ",", "these", "expect", "i_mutex", "to", "*", "be", "held", ".", "Since", "this", "may", "result", "in", "an", "ABBA", "deadlock", "with", "*", "pipe", "-", ">", "inode", ",", "we", "have", "to", "order", "lock", "acquiry", "here", ".", "*", "*", "Outer", "lock", "must", "be", "inode", "-", ">", "i_mutex", ",", "as", "pipe_wait", "(", ")", "will", "*", "release", "and", "reacquire", "pipe", "-", ">", "inode", "-", ">", "i_mutex", ",", "AND", "inode", "must", "*", "never", "be", "a", "pipe", ".", "*", "/", "inode_double_lock", "(", "inode", ",", "pipe", "-", ">", "inode", ")", ";", "WARN_ON", "(", "S_ISFIFO", "(", "inode", "-", ">", "i_mode", ")", ");", "mutex_lock_nested", "(", "&", "inode", "-", ">", "i_mutex", ",", "I_MUTEX_PARENT", ")", ";", "if", "(", "pipe", "-", ">", "inode", ")", "mutex_lock_nested", "(", "&", "pipe", "-", ">", "inode", "-", ">", "i_mutex", ",", "I_MUTEX_CHILD", ")", ";", "ret", "=", "__splice_from_pipe", "(", "pipe", ",", "&", "sd", ",", "actor", ")", ";", "inode_double_unlock", "(", "inode", ",", "pipe", "-", ">", "inode", ")", ";", "if", "(", "pipe", "-", ">", "inode", ")", "mutex_unlock", "(", "&", "pipe", "-", ">", "inode", "-", ">", "i_mutex", ")", ";", "mutex_unlock", "(", "&", "inode", "-", ">", "i_mutex", ")", ";", "return", "ret", ";", "}", "@", "@", "-", "831", ",", "11", "+", "840", ",", "17", "@", "@", "generic_file_splice_write", "(", "struct", "pipe_inode_info", "*", "pipe", ",", "struct", "file", "*", "out", ",", "}", ";", "ssize_t", "ret", ";", "inode_double_lock", "(", "inode", ",", "pipe", "-", ">", "inode", ")", ";", "WARN_ON", "(", "S_ISFIFO", "(", "inode", "-", ">", "i_mode", ")", ");", "mutex_lock_nested", "(", "&", "inode", "-", ">", "i_mutex", ",", "I_MUTEX_PARENT", ")", ";", "ret", "=", "file_remove_suid", "(", "out", ")", ";", "if", "(", "likely", "(", "!", "ret", ")", ")", "if", "(", "likely", "(", "!", "ret", ")", ")", "{", "if", "(", "pipe", "-", ">", "inode", ")", "mutex_lock_nested", "(", "&", "pipe", "-", ">", "inode", "-", ">", "i_mutex", ",", "I_MUTEX_CHILD", ")", ";", "ret", "=", "__splice_from_pipe", "(", "pipe", ",", "&", "sd", ",", "pipe_to_file", ")", ";", "inode_double_unlock", "(", "inode", ",", "pipe", "-", ">", "inode", ")", ";", "if", "(", "pipe", "-", ">", "inode", ")", "mutex_unlock", "(", "&", "pipe", "-", ">", "inode", "-", ">", "i_mutex", ")", ";", "}", "mutex_unlock", "(", "&", "inode", "-", ">", "i_mutex", ")", ";", "if", "(", "ret", ">", "0", ")", "{", "unsigned", "long", "nr_pages", ";"], "docstring_tokens": ["does", "not", "make", "the", "box", "unresponsive"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "283", ",", "6", "+", "283", ",", "7", "@", "@", "enum", "LINUX_MIB_TCPACKCOMPRESSED", ",", "/", "*", "TCPAckCompressed", "*", "/", "LINUX_MIB_TCPZEROWINDOWDROP", ",", "/", "*", "TCPZeroWindowDrop", "*", "/", "LINUX_MIB_TCPRCVQDROP", ",", "/", "*", "TCPRcvQDrop", "*", "/", "LINUX_MIB_TCPWQUEUETOOBIG", ",", "/", "*", "TCPWqueueTooBig", "*", "/", "__LINUX_MIB_MAX", "}", ";", "@", "@", "-", "287", ",", "6", "+", "287", ",", "7", "@", "@", "static", "const", "struct", "snmp_mib", "snmp4_net_list", "[", "]", "=", "{", "SNMP_MIB_ITEM", "(", "\"", "TCPAckCompressed", "\"", ",", "LINUX_MIB_TCPACKCOMPRESSED", ")", ",", "SNMP_MIB_ITEM", "(", "\"", "TCPZeroWindowDrop", "\"", ",", "LINUX_MIB_TCPZEROWINDOWDROP", ")", ",", "SNMP_MIB_ITEM", "(", "\"", "TCPRcvQDrop", "\"", ",", "LINUX_MIB_TCPRCVQDROP", ")", ",", "SNMP_MIB_ITEM", "(", "\"", "TCPWqueueTooBig", "\"", ",", "LINUX_MIB_TCPWQUEUETOOBIG", ")", ",", "SNMP_MIB_SENTINEL", "}", ";", "@", "@", "-", "1296", ",", "6", "+", "1296", ",", "11", "@", "@", "int", "tcp_fragment", "(", "struct", "sock", "*", "sk", ",", "enum", "tcp_queue", "tcp_queue", ",", "if", "(", "nsize", "<", "0", ")", "nsize", "=", "0", ";", "if", "(", "unlikely", "(", "(", "sk", "-", ">", "sk_wmem_queued", ">", ">", "1", ")", ">", "sk", "-", ">", "sk_sndbuf", ")", ")", "{", "NET_INC_STATS", "(", "sock_net", "(", "sk", ")", ",", "LINUX_MIB_TCPWQUEUETOOBIG", ")", ";", "return", "-", "ENOMEM", ";", "}", "if", "(", "skb_unclone", "(", "skb", ",", "gfp", ")", ")", "return", "-", "ENOMEM", ";"], "docstring_tokens": ["not", "spamming", "and", "unnecessarily", "disclosing", "to", "the", "non-Linux", "distros", ")"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "70", ",", "6", "+", "70", ",", "7", "@", "@", "#", "include", "\"", "php_main", ".", "h", "\"", "#", "include", "\"", "fopen_wrappers", ".", "h", "\"", "#", "include", "\"", "ext", "/", "standard", "/", "php_standard", ".", "h", "\"", "#", "include", "\"", "ext", "/", "standard", "/", "url", ".", "h", "\"", "#", "ifdef", "PHP_WIN32", "#", "include", "<", "io", ".", "h", ">", "@", "@", "-", "1508", ",", "6", "+", "1509", ",", "9", "@", "@", "int", "main", "(", "int", "argc", ",", "char", "*", "argv", "[", "])", "#", "ifndef", "PHP_WIN32", "int", "status", "=", "0", ";", "#", "endif", "char", "*", "query_string", ";", "char", "*", "decoded_query_string", ";", "int", "skip_getopt", "=", "0", ";", "#", "if", "0", "&", "&", "defined", "(", "PHP_DEBUG", ")", "/", "*", "IIS", "is", "always", "making", "things", "more", "difficult", ".", "This", "allows", "@", "@", "-", "1557", ",", "7", "+", "1561", ",", "16", "@", "@", "int", "main", "(", "int", "argc", ",", "char", "*", "argv", "[", "])", "}", "}", "while", "(", "(", "c", "=", "php_getopt", "(", "argc", ",", "argv", ",", "OPTIONS", ",", "&", "php_optarg", ",", "&", "php_optind", ",", "0", ",", "2", ")", ")", "!", "=", "-", "1", ")", "{", "if", "(", "query_string", "=", "getenv", "(", "\"", "QUERY_STRING", "\"", "))", "{", "decoded_query_string", "=", "strdup", "(", "query_string", ")", ";", "php_url_decode", "(", "decoded_query_string", ",", "strlen", "(", "decoded_query_string", ")", ");", "if", "(", "*", "decoded_query_string", "=", "=", "'", "-'", "&", "&", "strchr", "(", "decoded_query_string", ",", "'", "='", ")", "=", "=", "NULL", ")", "{", "skip_getopt", "=", "1", ";", "}", "free", "(", "decoded_query_string", ")", ";", "}", "while", "(", "!", "skip_getopt", "&", "&", "(", "c", "=", "php_getopt", "(", "argc", ",", "argv", ",", "OPTIONS", ",", "&", "php_optarg", ",", "&", "php_optind", ",", "0", ",", "2", ")", ")", "!", "=", "-", "1", ")", "{", "switch", "(", "c", ")", "{", "case", "'", "c", "'", ":", "if", "(", "cgi_sapi_module", ".", "php_ini_path_override", ")", "{"], "docstring_tokens": ["incomplete", "fix"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "29", ",", "6", "+", "29", ",", "7", "@", "@", "import", "java", ".", "util", ".", "concurrent", ".", "atomic", ".", "AtomicBoolean", ";", "import", "javax", ".", "servlet", ".", "RequestDispatcher", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletResponse", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpUpgradeHandler", ";", "import", "org", ".", "apache", ".", "coyote", ".", "AbstractProcessor", ";", "@", "@", "-", "1110", ",", "6", "+", "1111", ",", "7", "@", "@", "protected", "void", "prepareRequest", "(", ")", "{", "/", "/", "Set", "this", "every", "time", "in", "case", "limit", "has", "been", "changed", "via", "JMX", "headers", ".", "setLimit", "(", "endpoint", ".", "getMaxHeaderCount", "(", "))", ";", "boolean", "contentLengthSet", "=", "false", ";", "int", "hCount", "=", "requestHeaderMessage", ".", "getInt", "(", ");", "for", "(", "int", "i", "=", "0", ";", "i", "<", "hCount", ";", "i", "+", "+)", "{", "String", "hName", "=", "null", ";", "@", "@", "-", "1144", ",", "9", "+", "1146", ",", "15", "@", "@", "protected", "void", "prepareRequest", "(", ")", "{", "if", "(", "hId", "=", "=", "Constants", ".", "SC_REQ_CONTENT_LENGTH", "|", "|", "(", "hId", "=", "=", "-", "1", "&", "&", "tmpMB", ".", "equalsIgnoreCase", "(", "\"", "Content", "-", "Length", "\"", "))", ")", "{", "/", "/", "just", "read", "the", "content", "-", "length", "header", ",", "so", "set", "it", "long", "cl", "=", "vMB", ".", "getLong", "(", ");", "request", ".", "setContentLength", "(", "cl", ")", ";", "if", "(", "contentLengthSet", ")", "{", "response", ".", "setStatus", "(", "HttpServletResponse", ".", "SC_BAD_REQUEST", ")", ";", "error", "=", "true", ";", "}", "else", "{", "contentLengthSet", "=", "true", ";", "/", "/", "Set", "the", "content", "-", "length", "header", "for", "the", "request", "request", ".", "setContentLength", "(", "cl", ")", ";", "}", "if", "(", "cl", "!", "=", "0", ")", "{", "bodyPresent", "=", "true", ";", "}", "@", "@", "-", "1263", ",", "10", "+", "1263", ",", "20", "@", "@", "protected", "void", "prepareRequest", "(", ")", "{", "/", "/", "Parse", "content", "-", "length", "header", "long", "contentLength", "=", "request", ".", "getContentLengthLong", "(", ");", "if", "(", "contentLength", ">", "=", "0", "&", "&", "!", "contentDelimitation", ")", "{", "getInputBuffer", "(", ").", "addActiveFilter", "(", "inputFilters", "[", "Constants", ".", "IDENTITY_FILTER", "]", ");", "contentDelimitation", "=", "true", ";", "if", "(", "contentLength", ">", "=", "0", ")", "{", "if", "(", "contentDelimitation", ")", "{", "/", "/", "contentDelimitation", "being", "true", "at", "this", "point", "indicates", "that", "/", "/", "chunked", "encoding", "is", "being", "used", "but", "chunked", "encoding", "should", "/", "/", "not", "be", "used", "with", "a", "content", "length", ".", "RFC", "2616", ",", "section", "4", ".", "4", ",", "/", "/", "bullet", "3", "states", "Content", "-", "Length", "must", "be", "ignored", "in", "this", "case", "-", "/", "/", "so", "remove", "it", ".", "headers", ".", "removeHeader", "(", "\"", "content", "-", "length", "\"", ");", "request", ".", "setContentLength", "(", "-", "1", ")", ";", "}", "else", "{", "getInputBuffer", "(", ").", "addActiveFilter", "(", "inputFilters", "[", "Constants", ".", "IDENTITY_FILTER", "]", ");", "contentDelimitation", "=", "true", ";", "}", "}", "MessageBytes", "valueMB", "=", "headers", ".", "getValue", "(", "\"", "host", "\"", ");", "@", "@", "-", "98", ",", "9", "+", "98", ",", "20", "@", "@", "public", "void", "testKeepAlive", "(", ")", "throws", "Exception", "{", "ajpClient", ".", "disconnect", "(", ");", "}", "@", "Test", "public", "void", "testPost", "(", ")", "throws", "Exception", "{", "doTestPost", "(", "false", ",", "HttpServletResponse", ".", "SC_OK", ")", ";", "}", "@", "Test", "public", "void", "testSimplePost", "(", ")", "throws", "Exception", "{", "public", "void", "testPostMultipleContentLength", "(", ")", "throws", "Exception", "{", "/", "/", "Multiple", "content", "lengths", "doTestPost", "(", "true", ",", "HttpServletResponse", ".", "SC_BAD_REQUEST", ")", ";", "}", "public", "void", "doTestPost", "(", "boolean", "multipleCL", ",", "int", "expectedStatus", ")", "throws", "Exception", "{", "Tomcat", "tomcat", "=", "getTomcatInstance", "(", ");", "@", "@", "-", "119", ",", "6", "+", "130", ",", "9", "@", "@", "public", "void", "testSimplePost", "(", ")", "throws", "Exception", "{", "TesterAjpMessage", "forwardMessage", "=", "ajpClient", ".", "createForwardMessage", "(", "\"/", "echo", "-", "params", ".", "jsp", "\"", ",", "4", ")", ";", "forwardMessage", ".", "addHeader", "(", "0xA008", ",", "\"", "9", "\"", ");", "if", "(", "multipleCL", ")", "{", "forwardMessage", ".", "addHeader", "(", "0xA008", ",", "\"", "99", "\"", ");", "}", "forwardMessage", ".", "addHeader", "(", "0xA007", ",", "\"", "application", "/", "x", "-", "www", "-", "form", "-", "urlencoded", "\"", ");", "forwardMessage", ".", "end", "(", ");", "@", "@", "-", "128", ",", "15", "+", "142", ",", "20", "@", "@", "public", "void", "testSimplePost", "(", ")", "throws", "Exception", "{", "TesterAjpMessage", "responseHeaders", "=", "ajpClient", ".", "sendMessage", "(", "forwardMessage", ",", "bodyMessage", ")", ";", "/", "/", "Expect", "3", "messages", ":", "headers", ",", "body", ",", "end", "validateResponseHeaders", "(", "responseHeaders", ",", "200", ")", ";", "/", "/", "Skip", "the", "body", "TesterAjpMessage", "responseBody", "=", "ajpClient", ".", "readMessage", "(", ");", "validateResponseBody", "(", "responseBody", ",", "\"", "test", "-", "data", "\"", ");", "validateResponseEnd", "(", "ajpClient", ".", "readMessage", "(", "),", "true", ")", ";", "validateResponseHeaders", "(", "responseHeaders", ",", "expectedStatus", ")", ";", "if", "(", "expectedStatus", "=", "=", "HttpServletResponse", ".", "SC_OK", ")", "{", "/", "/", "Expect", "3", "messages", ":", "headers", ",", "body", ",", "end", "for", "a", "valid", "request", "TesterAjpMessage", "responseBody", "=", "ajpClient", ".", "readMessage", "(", ");", "validateResponseBody", "(", "responseBody", ",", "\"", "test", "-", "data", "\"", ");", "validateResponseEnd", "(", "ajpClient", ".", "readMessage", "(", "),", "true", ")", ";", "/", "/", "Double", "check", "the", "connection", "is", "still", "open", "validateCpong", "(", "ajpClient", ".", "cping", "(", "))", ";", "}", "else", "{", "/", "/", "Expect", "2", "messages", ":", "headers", ",", "end", "for", "an", "invalid", "request", "validateResponseEnd", "(", "ajpClient", ".", "readMessage", "(", "),", "false", ")", ";", "}", "/", "/", "Double", "check", "the", "connection", "is", "still", "open", "validateCpong", "(", "ajpClient", ".", "cping", "(", "))", ";", "ajpClient", ".", "disconnect", "(", ");", "}", "@", "@", "-", "103", ",", "6", "+", "103", ",", "20", "@", "@", "public", "void", "testWithTEBuffered", "(", ")", "throws", "Exception", "{", "@", "Test", "public", "void", "testWithTEChunked", "(", ")", "throws", "Exception", "{", "doTestWithTEChunked", "(", "false", ")", ";", "}", "@", "Test", "public", "void", "testWithTEChunkedWithCL", "(", ")", "throws", "Exception", "{", "/", "/", "Should", "be", "ignored", "doTestWithTEChunked", "(", "true", ")", ";", "}", "private", "void", "doTestWithTEChunked", "(", "boolean", "withCL", ")", "throws", "Exception", "{", "Tomcat", "tomcat", "=", "getTomcatInstance", "(", ");", "/", "/", "Use", "the", "normal", "Tomcat", "ROOT", "context", "@", "@", "-", "114", ",", "6", "+", "128", ",", "7", "@", "@", "public", "void", "testWithTEChunked", "(", ")", "throws", "Exception", "{", "String", "request", "=", "\"", "POST", "/", "echo", "-", "params", ".", "jsp", "HTTP", "/", "1", ".", "1", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+", "\"", "Host", ":", "any", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+", "(", "withCL", "?", "\"", "Content", "-", "length", ":", "1", "\"", "+", "SimpleHttpClient", ".", "CRLF", ":", "\"", "\")", "\"", "Transfer", "-", "encoding", ":", "chunked", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+", "\"", "Content", "-", "Type", ":", "application", "/", "x", "-", "www", "-", "form", "-", "urlencoded", "\"", "+", "SimpleHttpClient", ".", "CRLF", "+"], "docstring_tokens": ["the", "handling", "of", "malicious", "request"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "123", ",", "6", "+", "123", ",", "8", "@", "@", "import", "java", ".", "util", ".", "logging", ".", "SimpleFormatter", ";", "import", "java", ".", "util", ".", "regex", ".", "Pattern", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang", ".", "StringUtils", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "Restricted", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "restrictions", ".", "NoExternalUse", ";", "/", "**", "*", "Utility", "functions", "used", "in", "views", ".", "@", "@", "-", "426", ",", "6", "+", "428", ",", "15", "@", "@", "public", "static", "String", "getCookie", "(", "HttpServletRequest", "req", ",", "String", "name", ",", "String", "defaul", "return", "c", ".", "getValue", "(", ");", "}", "private", "static", "final", "Pattern", "ICON_SIZE", "=", "Pattern", ".", "compile", "(", "\"\\", "\\", "d", "+", "x", "\\", "\\", "d", "+", "\")", ";", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "public", "static", "String", "validateIconSize", "(", "String", "iconSize", ")", "throws", "SecurityException", "{", "if", "(", "!", "ICON_SIZE", ".", "matcher", "(", "iconSize", ")", ".", "matches", "(", "))", "{", "throw", "new", "SecurityException", "(", "\"", "invalid", "iconSize", "\"", ");", "}", "return", "iconSize", ";", "}", "/", "**", "*", "Gets", "the", "suffix", "to", "use", "for", "YUI", "JavaScript", ".", "*", "/", "@", "@", "-", "766", ",", "7", "+", "766", ",", "7", "@", "@", "public", "AsynchPeople", "(", "View", "parent", ")", "{", "{", "StaplerRequest", "req", "=", "Stapler", ".", "getCurrentRequest", "(", ");", "iconSize", "=", "req", "!", "=", "null", "?", "Functions", ".", "getCookie", "(", "req", ",", "\"", "iconSize", "\"", ",", "\"", "32x32", "\"", ")", ":", "\"", "32x32", "\"", ";", "iconSize", "=", "req", "!", "=", "null", "?", "Functions", ".", "validateIconSize", "(", "Functions", ".", "getCookie", "(", "req", ",", "\"", "iconSize", "\"", ",", "\"", "32x32", "\"", "))", ":", "\"", "32x32", "\"", ";", "}", "@", "Override", "protected", "void", "compute", "(", ")", "throws", "Exception", "{", "@", "@", "-", "295", ",", "7", "+", "295", ",", "6", "@", "@", "import", "static", "java", ".", "util", ".", "logging", ".", "Level", ".", "SEVERE", ";", "import", "java", ".", "util", ".", "logging", ".", "LogRecord", ";", "import", "java", ".", "util", ".", "logging", ".", "Logger", ";", "import", "java", ".", "util", ".", "regex", ".", "Pattern", ";", "import", "javax", ".", "annotation", ".", "CheckForNull", ";", "import", "javax", ".", "annotation", ".", "Nonnull", ";", "import", "javax", ".", "annotation", ".", "Nullable", ";", "@", "@", "-", "3417", ",", "9", "+", "3416", ",", "9", "@", "@", "public", "void", "doSignup", "(", "StaplerRequest", "req", ",", "StaplerResponse", "rsp", ")", "throws", "IOExcepti", "*", "/", "public", "void", "doIconSize", "(", "StaplerRequest", "req", ",", "StaplerResponse", "rsp", ")", "throws", "IOException", ",", "ServletException", "{", "String", "qs", "=", "req", ".", "getQueryString", "(", ");", "if", "(", "qs", "=", "=", "null", "|", "|", "!", "ICON_SIZE", ".", "matcher", "(", "qs", ")", ".", "matches", "(", "))", "if", "(", "qs", "=", "=", "null", ")", "throw", "new", "ServletException", "(", ");", "Cookie", "cookie", "=", "new", "Cookie", "(", "\"", "iconSize", "\"", ",", "qs", ")", ";", "Cookie", "cookie", "=", "new", "Cookie", "(", "\"", "iconSize", "\"", ",", "Functions", ".", "validateIconSize", "(", "qs", ")", ");", "cookie", ".", "setMaxAge", "(", "/*", "~", "4", "mo", ".", "*", "/", "9999999", ")", ";", "/", "/", "#", "762", "rsp", ".", "addCookie", "(", "cookie", ")", ";", "String", "ref", "=", "req", ".", "getHeader", "(", "\"", "Referer", "\"", ");", "@", "@", "-", "3964", ",", "8", "+", "3963", ",", "6", "@", "@", "public", "static", "VersionNumber", "getVersion", "(", ")", "{", "private", "static", "final", "Logger", "LOGGER", "=", "Logger", ".", "getLogger", "(", "Jenkins", ".", "class", ".", "getName", "(", "))", ";", "private", "static", "final", "Pattern", "ICON_SIZE", "=", "Pattern", ".", "compile", "(", "\"\\", "\\", "d", "+", "x", "\\", "\\", "d", "+", "\")", ";", "public", "static", "final", "PermissionGroup", "PERMISSIONS", "=", "Permission", ".", "HUDSON_PERMISSIONS", ";", "public", "static", "final", "Permission", "ADMINISTER", "=", "Permission", ".", "HUDSON_ADMINISTER", ";", "public", "static", "final", "Permission", "READ", "=", "new", "Permission", "(", "PERMISSIONS", ",", "\"", "Read", "\"", ",", "Messages", ".", "_Hudson_ReadPermission_Description", "(", "),", "Permission", ".", "READ", ",", "PermissionScope", ".", "JENKINS", ")", ";"], "docstring_tokens": ["improper", "validation", "of", "user-supplied", "input"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1251", ",", "8", "+", "1251", ",", "27", "@", "@", "static", "int", "digi_port_init", "(", "struct", "usb_serial_port", "*", "port", ",", "unsigned", "port_num", ")", "static", "int", "digi_startup", "(", "struct", "usb_serial", "*", "serial", ")", "{", "struct", "device", "*", "dev", "=", "&", "serial", "-", ">", "interface", "-", ">", "dev", ";", "struct", "digi_serial", "*", "serial_priv", ";", "int", "ret", ";", "int", "i", ";", "/", "*", "check", "whether", "the", "device", "has", "the", "expected", "number", "of", "endpoints", "*", "/", "if", "(", "serial", "-", ">", "num_port_pointers", "<", "serial", "-", ">", "type", "-", ">", "num_ports", "+", "1", ")", "{", "dev_err", "(", "dev", ",", "\"", "OOB", "endpoints", "missing", "\\", "n", "\"", ");", "return", "-", "ENODEV", ";", "}", "for", "(", "i", "=", "0", ";", "i", "<", "serial", "-", ">", "type", "-", ">", "num_ports", "+", "1", ";", "i", "+", "+)", "{", "if", "(", "!", "serial", "-", ">", "port", "[", "i", "]", "->", "read_urb", ")", "{", "dev_err", "(", "dev", ",", "\"", "bulk", "-", "in", "endpoint", "missing", "\\", "n", "\"", ");", "return", "-", "ENODEV", ";", "}", "if", "(", "!", "serial", "-", ">", "port", "[", "i", "]", "->", "write_urb", ")", "{", "dev_err", "(", "dev", ",", "\"", "bulk", "-", "out", "endpoint", "missing", "\\", "n", "\"", ");", "return", "-", "ENODEV", ";", "}", "}", "serial_priv", "=", "kzalloc", "(", "sizeof", "(", "*", "serial_priv", ")", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "serial_priv", ")"], "docstring_tokens": ["no", "security", "patch", "was", "provided", "by", "the", "vendor", "."]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "154", ",", "7", "+", "154", ",", "7", "@", "@", "static", "int", "ibwdt_set_heartbeat", "(", "int", "t", ")", "return", "-", "EINVAL", ";", "for", "(", "i", "=", "0x0F", ";", "i", ">", "-", "1", ";", "i", "-", "-)", "if", "(", "wd_times", "[", "i", "]", ">", "t", ")", "if", "(", "wd_times", "[", "i", "]", ">", "=", "t", ")", "break", ";", "wd_margin", "=", "i", ";", "return", "0", ";"], "docstring_tokens": ["does", "not", "restrict", "access", "to", "unprivileged", "users"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2408", ",", "7", "+", "2408", ",", "13", "@", "@", "static", "int", "check_alu_op", "(", "struct", "bpf_verifier_env", "*", "env", ",", "struct", "bpf_insn", "*", "insn", ")", "*", "remember", "the", "value", "we", "stored", "into", "this", "reg", "*", "/", "regs", "[", "insn", "-", ">", "dst_reg", "]", ".", "type", "=", "SCALAR_VALUE", ";", "__mark_reg_known", "(", "regs", "+", "insn", "-", ">", "dst_reg", ",", "insn", "-", ">", "imm", ")", ";", "if", "(", "BPF_CLASS", "(", "insn", "-", ">", "code", ")", "=", "=", "BPF_ALU64", ")", "{", "__mark_reg_known", "(", "regs", "+", "insn", "-", ">", "dst_reg", ",", "insn", "-", ">", "imm", ")", ";", "}", "else", "{", "__mark_reg_known", "(", "regs", "+", "insn", "-", ">", "dst_reg", ",", "(", "u32", ")", "insn", "-", ">", "imm", ")", ";", "}", "}", "}", "else", "if", "(", "opcode", ">", "BPF_END", ")", "{"], "docstring_tokens": ["incorrect", "tracking", "of", "register", "size", "truncation", "\"", "Here", "is", "a", "crasher", "that", "uses", "this", "to", "again", "write", "to", "a", "noncanonical", "address"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "654", ",", "6", "+", "654", ",", "8", "@", "@", "public", "void", "run", "(", ")", "{", "@", "RequirePOST", "public", "void", "doLaunchSlaveAgent", "(", "StaplerRequest", "req", ",", "StaplerResponse", "rsp", ")", "throws", "IOException", ",", "ServletException", "{", "checkPermission", "(", "CONNECT", ")", ";", "if", "(", "channel", "!", "=", "null", ")", "{", "req", ".", "getView", "(", "this", ",", "\"", "already", "-", "launched", ".", "jelly", "\"", ").", "forward", "(", "req", ",", "rsp", ")", ";", "return", ";"], "docstring_tokens": ["not", "properly", "escape", "display", "names", "of", "items"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "875", ",", "7", "+", "875", ",", "7", "@", "@", "Renderer", ".", "prototype", ".", "link", "=", "function", "(", "href", ",", "title", ",", "text", ")", "{", "}", "catch", "(", "e", ")", "{", "return", "'", "';", "}", "if", "(", "prot", ".", "indexOf", "(", "'", "javascript", ":", "')", "=", "==", "0", "|", "|", "prot", ".", "indexOf", "(", "'", "vbscript", ":", "')", "=", "==", "0", ")", "{", "if", "(", "prot", ".", "indexOf", "(", "'", "javascript", ":", "')", "=", "==", "0", "|", "|", "prot", ".", "indexOf", "(", "'", "vbscript", ":", "')", "=", "==", "0", "|", "|", "prot", ".", "indexOf", "(", "'", "data", ":", "')", "=", "==", "0", ")", "{", "return", "'", "';", "}", "}", "@", "@", "-", "1", ",", "4", "+", "1", ",", "5", "@", "@", "<", "p", ">", "</", "p", ">", "<", "p", ">", "</", "p", ">", "<", "p", ">", "</", "p", ">", "<", "p", ">", "</", "p", ">", "<", "p", ">", "</", "p", ">", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "4", ",", "4", "+", "4", ",", "6", "@", "@", "[", "URL", "]", "(", "javascript", "&", "colon", ";", "alert", "&", "#", "40", ";", "1", "&", "#", "41", ";", ")", "[", "URL", "]", "(", "javascript", "&", "#", "58document", ";", "alert", "&", "#", "40", ";", "1", "&", "#", "41", ";", ")", "\\", "No", "newline", "at", "end", "of", "file", "[", "URL", "]", "(", "javascript", "&", "#", "58document", ";", "alert", "&", "#", "40", ";", "1", "&", "#", "41", ";", ")", "[", "URL", "]", "(", "data", ":", "text", "/", "html", ";", "base64", ",", "PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K", ")", "\\", "No", "newline", "at", "end", "of", "file"], "docstring_tokens": ["improper", "validation", "of", "user-supplied", "input"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "36", ",", "8", "+", "36", ",", "6", "@", "@", "struct", "files_stat_struct", "files_stat", "=", "{", ".", "max_files", "=", "NR_FILE", "}", ";", "DEFINE_STATIC_LGLOCK", "(", "files_lglock", ")", ";", "/", "*", "SLAB", "cache", "for", "file", "structures", "*", "/", "static", "struct", "kmem_cache", "*", "filp_cachep", "__read_mostly", ";", "@", "@", "-", "134", ",", "7", "+", "132", ",", "6", "@", "@", "struct", "file", "*", "get_empty_filp", "(", "void", ")", "return", "ERR_PTR", "(", "error", ")", ";", "}", "INIT_LIST_HEAD", "(", "&", "f", "-", ">", "f_u", ".", "fu_list", ")", ";", "atomic_long_set", "(", "&", "f", "-", ">", "f_count", ",", "1", ")", ";", "rwlock_init", "(", "&", "f", "-", ">", "f_owner", ".", "lock", ")", ";", "spin_lock_init", "(", "&", "f", "-", ">", "f_lock", ")", ";", "@", "@", "-", "304", ",", "7", "+", "301", ",", "6", "@", "@", "void", "fput", "(", "struct", "file", "*", "file", ")", "if", "(", "atomic_long_dec_and_test", "(", "&", "file", "-", ">", "f_count", ")", ")", "{", "struct", "task_struct", "*", "task", "=", "current", ";", "file_sb_list_del", "(", "file", ")", ";", "if", "(", "likely", "(", "!", "in_interrupt", "(", ")", "&", "&", "!", "(", "task", "-", ">", "flags", "&", "PF_KTHREAD", ")", "))", "{", "init_task_work", "(", "&", "file", "-", ">", "f_u", ".", "fu_rcuhead", ",", "____fput", ")", ";", "if", "(", "!", "task_work_add", "(", "task", ",", "&", "file", "-", ">", "f_u", ".", "fu_rcuhead", ",", "true", ")", ")", "@", "@", "-", "333", ",", "7", "+", "329", ",", "6", "@", "@", "void", "__fput_sync", "(", "struct", "file", "*", "file", ")", "{", "if", "(", "atomic_long_dec_and_test", "(", "&", "file", "-", ">", "f_count", ")", ")", "{", "struct", "task_struct", "*", "task", "=", "current", ";", "file_sb_list_del", "(", "file", ")", ";", "BUG_ON", "(", "!(", "task", "-", ">", "flags", "&", "PF_KTHREAD", ")", ");", "__fput", "(", "file", ")", ";", "}", "@", "@", "-", "345", ",", "129", "+", "340", ",", "10", "@", "@", "void", "put_filp", "(", "struct", "file", "*", "file", ")", "{", "if", "(", "atomic_long_dec_and_test", "(", "&", "file", "-", ">", "f_count", ")", ")", "{", "security_file_free", "(", "file", ")", ";", "file_sb_list_del", "(", "file", ")", ";", "file_free", "(", "file", ")", ";", "}", "}", "static", "inline", "int", "file_list_cpu", "(", "struct", "file", "*", "file", ")", "{", "#", "ifdef", "CONFIG_SMP", "return", "file", "-", ">", "f_sb_list_cpu", ";", "#", "else", "return", "smp_processor_id", "(", ");", "#", "endif", "}", "/", "*", "helper", "for", "file_sb_list_add", "to", "reduce", "ifdefs", "*", "/", "static", "inline", "void", "__file_sb_list_add", "(", "struct", "file", "*", "file", ",", "struct", "super_block", "*", "sb", ")", "{", "struct", "list_head", "*", "list", ";", "#", "ifdef", "CONFIG_SMP", "int", "cpu", ";", "cpu", "=", "smp_processor_id", "(", ");", "file", "-", ">", "f_sb_list_cpu", "=", "cpu", ";", "list", "=", "per_cpu_ptr", "(", "sb", "-", ">", "s_files", ",", "cpu", ")", ";", "#", "else", "list", "=", "&", "sb", "-", ">", "s_files", ";", "#", "endif", "list_add", "(", "&", "file", "-", ">", "f_u", ".", "fu_list", ",", "list", ")", ";", "}", "/", "**", "*", "file_sb_list_add", "-", "add", "a", "file", "to", "the", "sb", "'", "s", "file", "list", "*", "@", "file", ":", "file", "to", "add", "*", "@", "sb", ":", "sb", "to", "add", "it", "to", "*", "*", "Use", "this", "function", "to", "associate", "a", "file", "with", "the", "superblock", "of", "the", "inode", "it", "*", "refers", "to", ".", "*", "/", "void", "file_sb_list_add", "(", "struct", "file", "*", "file", ",", "struct", "super_block", "*", "sb", ")", "{", "if", "(", "likely", "(", "!(", "file", "-", ">", "f_mode", "&", "FMODE_WRITE", ")", "))", "return", ";", "if", "(", "!", "S_ISREG", "(", "file_inode", "(", "file", ")", "->", "i_mode", ")", ")", "return", ";", "lg_local_lock", "(", "&", "files_lglock", ")", ";", "__file_sb_list_add", "(", "file", ",", "sb", ")", ";", "lg_local_unlock", "(", "&", "files_lglock", ")", ";", "}", "/", "**", "*", "file_sb_list_del", "-", "remove", "a", "file", "from", "the", "sb", "'", "s", "file", "list", "*", "@", "file", ":", "file", "to", "remove", "*", "@", "sb", ":", "sb", "to", "remove", "it", "from", "*", "*", "Use", "this", "function", "to", "remove", "a", "file", "from", "its", "superblock", ".", "*", "/", "void", "file_sb_list_del", "(", "struct", "file", "*", "file", ")", "{", "if", "(", "!", "list_empty", "(", "&", "file", "-", ">", "f_u", ".", "fu_list", ")", ")", "{", "lg_local_lock_cpu", "(", "&", "files_lglock", ",", "file_list_cpu", "(", "file", ")", ");", "list_del_init", "(", "&", "file", "-", ">", "f_u", ".", "fu_list", ")", ";", "lg_local_unlock_cpu", "(", "&", "files_lglock", ",", "file_list_cpu", "(", "file", ")", ");", "}", "}", "#", "ifdef", "CONFIG_SMP", "/", "*", "*", "These", "macros", "iterate", "all", "files", "on", "all", "CPUs", "for", "a", "given", "superblock", ".", "*", "files_lglock", "must", "be", "held", "globally", ".", "*", "/", "#", "define", "do_file_list_for_each_entry", "(", "__sb", ",", "__file", ")", "\\", "{", "\\", "int", "i", ";", "\\", "for_each_possible_cpu", "(", "i", ")", "{", "\\", "struct", "list_head", "*", "list", ";", "\\", "list", "=", "per_cpu_ptr", "(", "(", "__sb", ")", "->", "s_files", ",", "i", ")", ";", "\\", "list_for_each_entry", "(", "(", "__file", ")", ",", "list", ",", "f_u", ".", "fu_list", ")", "#", "define", "while_file_list_for_each_entry", "\\", "}", "\\", "}", "#", "else", "#", "define", "do_file_list_for_each_entry", "(", "__sb", ",", "__file", ")", "\\", "{", "\\", "struct", "list_head", "*", "list", ";", "\\", "list", "=", "&", "(", "sb", ")", "->", "s_files", ";", "\\", "list_for_each_entry", "(", "(", "__file", ")", ",", "list", ",", "f_u", ".", "fu_list", ")", "#", "define", "while_file_list_for_each_entry", "\\", "}", "#", "endif", "/", "**", "*", "mark_files_ro", "-", "mark", "all", "files", "read", "-", "only", "*", "@", "sb", ":", "superblock", "in", "question", "*", "*", "All", "files", "are", "marked", "read", "-", "only", ".", "We", "don", "'", "t", "care", "about", "pending", "*", "delete", "files", "so", "this", "should", "be", "used", "in", "'", "force", "'", "mode", "only", ".", "*", "/", "void", "mark_files_ro", "(", "struct", "super_block", "*", "sb", ")", "{", "struct", "file", "*", "f", ";", "lg_global_lock", "(", "&", "files_lglock", ")", ";", "do_file_list_for_each_entry", "(", "sb", ",", "f", ")", "{", "if", "(", "!", "file_count", "(", "f", ")", ")", "continue", ";", "if", "(", "!(", "f", "-", ">", "f_mode", "&", "FMODE_WRITE", ")", ")", "continue", ";", "spin_lock", "(", "&", "f", "-", ">", "f_lock", ")", ";", "f", "-", ">", "f_mode", "&", "=", "~", "FMODE_WRITE", ";", "spin_unlock", "(", "&", "f", "-", ">", "f_lock", ")", ";", "if", "(", "file_check_writeable", "(", "f", ")", "!", "=", "0", ")", "continue", ";", "__mnt_drop_write", "(", "f", "-", ">", "f_path", ".", "mnt", ")", ";", "file_release_write", "(", "f", ")", ";", "}", "while_file_list_for_each_entry", ";", "lg_global_unlock", "(", "&", "files_lglock", ")", ";", "}", "void", "__init", "files_init", "(", "unsigned", "long", "mempages", ")", "{", "unsigned", "long", "n", ";", "@", "@", "-", "483", ",", "6", "+", "359", ",", "5", "@", "@", "void", "__init", "files_init", "(", "unsigned", "long", "mempages", ")", "n", "=", "(", "mempages", "*", "(", "PAGE_SIZE", "/", "1024", ")", ")", "/", "10", ";", "files_stat", ".", "max_files", "=", "max_t", "(", "unsigned", "long", ",", "n", ",", "NR_FILE", ")", ";", "files_defer_init", "(", ");", "lg_lock_init", "(", "&", "files_lglock", ",", "\"", "files_lglock", "\"", ");", "percpu_counter_init", "(", "&", "nr_files", ",", "0", ")", ";", "}", "@", "@", "-", "73", ",", "9", "+", "73", ",", "6", "@", "@", "extern", "void", "chroot_fs_refs", "(", "const", "struct", "path", "*", ",", "const", "struct", "path", "*", ");", "/", "*", "*", "file_table", ".", "c", "*", "/", "extern", "void", "file_sb_list_add", "(", "struct", "file", "*", "f", ",", "struct", "super_block", "*", "sb", ")", ";", "extern", "void", "file_sb_list_del", "(", "struct", "file", "*", "f", ")", ";", "extern", "void", "mark_files_ro", "(", "struct", "super_block", "*", ");", "extern", "struct", "file", "*", "get_empty_filp", "(", "void", ")", ";", "/", "*", "@", "@", "-", "685", ",", "7", "+", "685", ",", "6", "@", "@", "static", "int", "do_dentry_open", "(", "struct", "file", "*", "f", ",", "}", "f", "-", ">", "f_mapping", "=", "inode", "-", ">", "i_mapping", ";", "file_sb_list_add", "(", "f", ",", "inode", "-", ">", "i_sb", ")", ";", "if", "(", "unlikely", "(", "f", "-", ">", "f_mode", "&", "FMODE_PATH", ")", ")", "{", "f", "-", ">", "f_op", "=", "&", "empty_fops", ";", "@", "@", "-", "724", ",", "7", "+", "723", ",", "6", "@", "@", "static", "int", "do_dentry_open", "(", "struct", "file", "*", "f", ",", "cleanup_all", ":", "fops_put", "(", "f", "-", ">", "f_op", ")", ";", "file_sb_list_del", "(", "f", ")", ";", "if", "(", "f", "-", ">", "f_mode", "&", "FMODE_WRITE", ")", "{", "put_write_access", "(", "inode", ")", ";", "if", "(", "!", "special_file", "(", "inode", "-", ">", "i_mode", ")", ")", "{", "@", "@", "-", "140", ",", "9", "+", "140", ",", "6", "@", "@", "static", "void", "destroy_super", "(", "struct", "super_block", "*", "s", ")", "int", "i", ";", "list_lru_destroy", "(", "&", "s", "-", ">", "s_dentry_lru", ")", ";", "list_lru_destroy", "(", "&", "s", "-", ">", "s_inode_lru", ")", ";", "#", "ifdef", "CONFIG_SMP", "free_percpu", "(", "s", "-", ">", "s_files", ")", ";", "#", "endif", "for", "(", "i", "=", "0", ";", "i", "<", "SB_FREEZE_LEVELS", ";", "i", "+", "+)", "percpu_counter_destroy", "(", "&", "s", "-", ">", "s_writers", ".", "counter", "[", "i", "]", ");", "security_sb_free", "(", "s", ")", ";", "@", "@", "-", "172", ",", "15", "+", "169", ",", "6", "@", "@", "static", "struct", "super_block", "*", "alloc_super", "(", "struct", "file_system_type", "*", "type", ",", "int", "flags", ")", "if", "(", "security_sb_alloc", "(", "s", ")", ")", "goto", "fail", ";", "#", "ifdef", "CONFIG_SMP", "s", "-", ">", "s_files", "=", "alloc_percpu", "(", "struct", "list_head", ")", ";", "if", "(", "!", "s", "-", ">", "s_files", ")", "goto", "fail", ";", "for_each_possible_cpu", "(", "i", ")", "INIT_LIST_HEAD", "(", "per_cpu_ptr", "(", "s", "-", ">", "s_files", ",", "i", ")", ");", "#", "else", "INIT_LIST_HEAD", "(", "&", "s", "-", ">", "s_files", ")", ";", "#", "endif", "for", "(", "i", "=", "0", ";", "i", "<", "SB_FREEZE_LEVELS", ";", "i", "+", "+)", "{", "if", "(", "percpu_counter_init", "(", "&", "s", "-", ">", "s_writers", ".", "counter", "[", "i", "]", ",", "0", ")", "<", "0", ")", "goto", "fail", ";", "@", "@", "-", "722", ",", "7", "+", "710", ",", "8", "@", "@", "int", "do_remount_sb", "(", "struct", "super_block", "*", "sb", ",", "int", "flags", ",", "void", "*", "data", ",", "int", "force", ")", "make", "sure", "there", "are", "no", "rw", "files", "opened", "*", "/", "if", "(", "remount_ro", ")", "{", "if", "(", "force", ")", "{", "mark_files_ro", "(", "sb", ")", ";", "sb", "-", ">", "s_readonly_remount", "=", "1", ";", "smp_wmb", "(", ");", "}", "else", "{", "retval", "=", "sb_prepare_remount_readonly", "(", "sb", ")", ";", "if", "(", "retval", ")", "@", "@", "-", "764", ",", "12", "+", "764", ",", "7", "@", "@", "static", "inline", "int", "ra_has_index", "(", "struct", "file_ra_state", "*", "ra", ",", "pgoff_t", "index", ")", "#", "define", "FILE_MNT_WRITE_RELEASED", "2", "struct", "file", "{", "/", "*", "*", "fu_list", "becomes", "invalid", "after", "file_free", "is", "called", "and", "queued", "via", "*", "fu_rcuhead", "for", "RCU", "freeing", "*", "/", "union", "{", "struct", "list_head", "fu_list", ";", "struct", "llist_node", "fu_llist", ";", "struct", "rcu_head", "fu_rcuhead", ";", "}", "f_u", ";", "@", "@", "-", "783", ",", "9", "+", "778", ",", "6", "@", "@", "struct", "file", "{", "*", "Must", "not", "be", "taken", "from", "IRQ", "context", ".", "*", "/", "spinlock_t", "f_lock", ";", "#", "ifdef", "CONFIG_SMP", "int", "f_sb_list_cpu", ";", "#", "endif", "atomic_long_t", "f_count", ";", "unsigned", "int", "f_flags", ";", "fmode_t", "f_mode", ";", "@", "@", "-", "1264", ",", "11", "+", "1256", ",", "6", "@", "@", "struct", "super_block", "{", "struct", "list_head", "s_inodes", ";", "/", "*", "all", "inodes", "*", "/", "struct", "hlist_bl_head", "s_anon", ";", "/", "*", "anonymous", "dentries", "for", "(", "nfs", ")", "exporting", "*", "/", "#", "ifdef", "CONFIG_SMP", "struct", "list_head", "__percpu", "*", "s_files", ";", "#", "else", "struct", "list_head", "s_files", ";", "#", "endif", "struct", "list_head", "s_mounts", ";", "/", "*", "list", "of", "mounts", ";", "_not_", "for", "fs", "use", "*", "/", "struct", "block_device", "*", "s_bdev", ";", "struct", "backing_dev_info", "*", "s_bdi", ";"], "docstring_tokens": ["a", "soft", "lockup", "when", "performing\\r\\nAsynchronous", "I/O", "operations", "due", "to", "files_lock", "excessive", "locking"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1494", ",", "6", "+", "1494", ",", "13", "@", "@", "static", "int", "sanity_check_raw_super", "(", "struct", "f2fs_sb_info", "*", "sbi", ",", "return", "1", ";", "}", "if", "(", "le32_to_cpu", "(", "raw_super", "-", ">", "segment_count", ")", ">", "F2FS_MAX_SEGMENT", ")", "{", "f2fs_msg", "(", "sb", ",", "KERN_INFO", ",", "\"", "Invalid", "segment", "count", "(", "%", "u", ")", "\",", "le32_to_cpu", "(", "raw_super", "-", ">", "segment_count", ")", ");", "return", "1", ";", "}", "/", "*", "check", "CP", "/", "SIT", "/", "NAT", "/", "SSA", "/", "MAIN_AREA", "area", "boundary", "*", "/", "if", "(", "sanity_check_area_boundary", "(", "sbi", ",", "bh", ")", ")", "return", "1", ";", "@", "@", "-", "301", ",", "6", "+", "301", ",", "12", "@", "@", "struct", "f2fs_nat_block", "{", "#", "define", "SIT_VBLOCK_MAP_SIZE", "64", "#", "define", "SIT_ENTRY_PER_BLOCK", "(", "PAGE_SIZE", "/", "sizeof", "(", "struct", "f2fs_sit_entry", ")", ")", "/", "*", "*", "F2FS", "uses", "4", "bytes", "to", "represent", "block", "address", ".", "As", "a", "result", ",", "supported", "size", "of", "*", "disk", "is", "16", "TB", "and", "it", "equals", "to", "16", "*", "1024", "*", "1024", "/", "2", "segments", ".", "*", "/", "#", "define", "F2FS_MAX_SEGMENT", "(", "(", "16", "*", "1024", "*", "1024", ")", "/", "2", ")", "/", "*", "*", "Note", "that", "f2fs_sit_entry", "-", ">", "vblocks", "has", "the", "following", "bit", "-", "field", "information", ".", "*", "[", "15", ":", "10", "]", ":", "allocation", "type", "such", "as", "CURSEG_XXXX_TYPE"], "docstring_tokens": ["does", "not", "validate", "the", "segment", "count"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "0", ",", "0", "+", "1", ",", "13", "@", "@", "root", "=", "true", "[", "*]", "end_of_line", "=", "lf", "insert_final_newline", "=", "true", "[", "*.", "js", "]", "charset", "=", "utf", "-", "8", "indent_style", "=", "tab", "[", "{.", "travis", ".", "yml", ",", "package", ".", "json", "}", "]", "indent_style", "=", "space", "indent_size", "=", "2", "@", "@", "-", "1", ",", "2", "+", "1", "@", "@", "node_modules", "lib", "/", "parse", ".", "js", "\\", "No", "newline", "at", "end", "of", "file", "@", "@", "-", "1", ",", "8", "+", "1", ",", "187", "@", "@", "{", "\"", "extends", "\"", ":", "\"", "peerigon", "/", "es5", "\"", ",", "\"", "root", "\"", ":", "true", ",", "\"", "env", "\"", ":", "{", "\"", "node", "\"", ":", "true", ",", "\"", "browser", "\"", ":", "true", "}", "\"", "parserOptions", "\"", ":", "{", "\"", "ecmaVersion", "\"", ":", "7", "}", ",", "\"", "plugins", "\"", ":", "[", "],", "\"", "globals", "\"", ":{", "\"", "Promise", "\"", ":", "true", ",", "\"", "JQLite", "\"", ":", "true", ",", "\"", "JQLitePrototype", "\"", ":", "true", ",", "\"", "ArrayBuffer", "\"", ":", "true", "}", ",", "\"", "env", "\"", ":", "{", "\"", "node", "\"", ":", "true", ",", "\"", "browser", "\"", ":", "true", ",", "\"", "mocha", "\"", ":", "true", "}", ",", "\"", "rules", "\"", ":", "{", "\"", "accessor", "-", "pairs", "\"", ":", "2", ",", "\"", "array", "-", "bracket", "-", "spacing", "\"", ":", "[", "2", ",", "\"", "never", "\"", "],", "\"", "arrow", "-", "parens", "\"", ":", "0", ",", "\"", "arrow", "-", "spacing", "\"", ":", "[", "2", ",", "{", "\"", "before", "\"", ":", "true", ",", "\"", "after", "\"", ":", "true", "}", "],", "\"", "block", "-", "scoped", "-", "var", "\"", ":", "2", ",", "\"", "block", "-", "spacing", "\"", ":", "[", "2", ",", "\"", "always", "\"", "],", "\"", "brace", "-", "style", "\"", ":", "0", ",", "\"", "callback", "-", "return", "\"", ":", "2", ",", "\"", "camelcase", "\"", ":", "[", "0", ",", "{", "\"", "properties", "\"", ":", "\"", "never", "\"", "}]", ",", "\"", "comma", "-", "dangle", "\"", ":", "[", "0", ",", "\"", "always", "-", "multiline", "\"", "],", "\"", "comma", "-", "spacing", "\"", ":", "[", "2", ",", "{", "\"", "before", "\"", ":", "false", ",", "\"", "after", "\"", ":", "true", "}", "],", "\"", "comma", "-", "style", "\"", ":", "[", "2", ",", "\"", "last", "\"", "],", "\"", "complexity", "\"", ":", "[", "2", ",", "10", "]", ",", "\"", "computed", "-", "property", "-", "spacing", "\"", ":", "[", "2", ",", "\"", "never", "\"", "],", "\"", "consistent", "-", "return", "\"", ":", "0", ",", "\"", "consistent", "-", "this", "\"", ":", "[", "2", ",", "\"", "self", "\"", "],", "\"", "constructor", "-", "super", "\"", ":", "2", ",", "\"", "curly", "\"", ":", "[", "2", ",", "\"", "all", "\"", "],", "\"", "default", "-", "case", "\"", ":", "0", ",", "\"", "dot", "-", "location", "\"", ":", "[", "2", ",", "\"", "property", "\"", "],", "\"", "dot", "-", "notation", "\"", ":", "2", ",", "\"", "eol", "-", "last", "\"", ":", "2", ",", "\"", "eqeqeq", "\"", ":", "[", "2", ",", "\"", "smart", "\"", "],", "\"", "func", "-", "names", "\"", ":", "0", ",", "\"", "func", "-", "style", "\"", ":", "[", "2", ",", "\"", "declaration", "\"", "],", "\"", "generator", "-", "star", "-", "spacing", "\"", ":", "[", "2", ",", "{", "\"", "before", "\"", ":", "false", ",", "\"", "after", "\"", ":", "true", "}", "],", "\"", "global", "-", "require", "\"", ":", "0", ",", "\"", "guard", "-", "for", "-", "in", "\"", ":", "2", ",", "\"", "handle", "-", "callback", "-", "err", "\"", ":", "2", ",", "\"", "id", "-", "length", "\"", ":", "0", ",", "\"", "id", "-", "match", "\"", ":", "0", ",", "\"", "init", "-", "declarations", "\"", ":", "0", ",", "\"", "key", "-", "spacing", "\"", ":", "[", "2", ",", "{", "\"", "beforeColon", "\"", ":", "false", ",", "\"", "afterColon", "\"", ":", "true", ",", "\"", "mode", "\"", ":", "\"", "strict", "\"", "}]", ",", "\"", "linebreak", "-", "style", "\"", ":", "0", ",", "\"", "lines", "-", "around", "-", "comment", "\"", ":", "0", ",", "\"", "max", "-", "nested", "-", "callbacks", "\"", ":", "0", ",", "\"", "new", "-", "cap", "\"", ":", "[", "2", ",", "{", "\"", "newIsCapExceptions", "\"", ":", "[", "\"", "Boom", ".", "badRequest", "\"", ",", "\"", "Boom", ".", "forbidden", "\"", ",", "\"", "Boom", ".", "unauthorized", "\"", ",", "\"", "Boom", ".", "wrap", "\"", "],", "\"", "capIsNewExceptions", "\"", ":", "[", "\"", "squeeze", ".", "Squeeze", "\"", "]", "}", "],", "\"", "new", "-", "parens", "\"", ":", "2", ",", "\"", "newline", "-", "after", "-", "var", "\"", ":", "0", ",", "\"", "no", "-", "alert", "\"", ":", "2", ",", "\"", "no", "-", "array", "-", "constructor", "\"", ":", "2", ",", "\"", "no", "-", "caller", "\"", ":", "2", ",", "\"", "no", "-", "catch", "-", "shadow", "\"", ":", "0", ",", "\"", "no", "-", "class", "-", "assign", "\"", ":", "2", ",", "\"", "no", "-", "console", "\"", ":", "2", ",", "\"", "no", "-", "const", "-", "assign", "\"", ":", "2", ",", "\"", "no", "-", "constant", "-", "condition", "\"", ":", "[", "2", ",", "{", "\"", "checkLoops", "\"", ":", "false", "}", "],", "\"", "no", "-", "continue", "\"", ":", "0", ",", "\"", "no", "-", "control", "-", "regex", "\"", ":", "0", ",", "\"", "no", "-", "debugger", "\"", ":", "2", ",", "\"", "no", "-", "delete", "-", "var", "\"", ":", "2", ",", "\"", "no", "-", "div", "-", "regex", "\"", ":", "2", ",", "\"", "no", "-", "dupe", "-", "args", "\"", ":", "2", ",", "\"", "no", "-", "dupe", "-", "class", "-", "members", "\"", ":", "2", ",", "\"", "no", "-", "dupe", "-", "keys", "\"", ":", "2", ",", "\"", "no", "-", "duplicate", "-", "case", "\"", ":", "2", ",", "\"", "no", "-", "else", "-", "return", "\"", ":", "2", ",", "\"", "no", "-", "empty", "\"", ":", "2", ",", "\"", "no", "-", "empty", "-", "character", "-", "class", "\"", ":", "2", ",", "\"", "no", "-", "eval", "\"", ":", "2", ",", "\"", "no", "-", "ex", "-", "assign", "\"", ":", "2", ",", "\"", "no", "-", "extend", "-", "native", "\"", ":", "2", ",", "\"", "no", "-", "extra", "-", "bind", "\"", ":", "2", ",", "\"", "no", "-", "extra", "-", "boolean", "-", "cast", "\"", ":", "2", ",", "\"", "no", "-", "extra", "-", "parens", "\"", ":", "[", "2", ",", "\"", "functions", "\"", "],", "\"", "no", "-", "extra", "-", "semi", "\"", ":", "2", ",", "\"", "no", "-", "fallthrough", "\"", ":", "2", ",", "\"", "no", "-", "floating", "-", "decimal", "\"", ":", "2", ",", "\"", "no", "-", "func", "-", "assign", "\"", ":", "2", ",", "\"", "no", "-", "implicit", "-", "coercion", "\"", ":", "0", ",", "\"", "no", "-", "implied", "-", "eval", "\"", ":", "2", ",", "\"", "no", "-", "inline", "-", "comments", "\"", ":", "0", ",", "\"", "no", "-", "inner", "-", "declarations", "\"", ":", "2", ",", "\"", "no", "-", "invalid", "-", "regexp", "\"", ":", "2", ",", "\"", "no", "-", "irregular", "-", "whitespace", "\"", ":", "2", ",", "\"", "no", "-", "iterator", "\"", ":", "2", ",", "\"", "no", "-", "label", "-", "var", "\"", ":", "2", ",", "\"", "no", "-", "labels", "\"", ":", "0", ",", "\"", "no", "-", "lone", "-", "blocks", "\"", ":", "2", ",", "\"", "no", "-", "lonely", "-", "if", "\"", ":", "2", ",", "\"", "no", "-", "loop", "-", "func", "\"", ":", "2", ",", "\"", "no", "-", "mixed", "-", "requires", "\"", ":", "2", ",", "\"", "no", "-", "mixed", "-", "spaces", "-", "and", "-", "tabs", "\"", ":", "0", ",", "\"", "no", "-", "multi", "-", "spaces", "\"", ":", "2", ",", "\"", "no", "-", "multi", "-", "str", "\"", ":", "2", ",", "\"", "no", "-", "multiple", "-", "empty", "-", "lines", "\"", ":", "[", "2", ",", "{", "\"", "max", "\"", ":", "1", "}", "],", "\"", "no", "-", "native", "-", "reassign", "\"", ":", "2", ",", "\"", "no", "-", "negated", "-", "in", "-", "lhs", "\"", ":", "2", ",", "\"", "no", "-", "new", "\"", ":", "2", ",", "\"", "no", "-", "new", "-", "func", "\"", ":", "2", ",", "\"", "no", "-", "new", "-", "object", "\"", ":", "2", ",", "\"", "no", "-", "new", "-", "require", "\"", ":", "2", ",", "\"", "no", "-", "new", "-", "wrappers", "\"", ":", "2", ",", "\"", "no", "-", "obj", "-", "calls", "\"", ":", "2", ",", "\"", "no", "-", "octal", "\"", ":", "2", ",", "\"", "no", "-", "octal", "-", "escape", "\"", ":", "2", ",", "\"", "no", "-", "param", "-", "reassign", "\"", ":", "0", ",", "\"", "no", "-", "path", "-", "concat", "\"", ":", "2", ",", "\"", "no", "-", "process", "-", "env", "\"", ":", "2", ",", "\"", "no", "-", "process", "-", "exit", "\"", ":", "2", ",", "\"", "no", "-", "proto", "\"", ":", "2", ",", "\"", "no", "-", "redeclare", "\"", ":", "2", ",", "\"", "no", "-", "regex", "-", "spaces", "\"", ":", "2", ",", "\"", "no", "-", "restricted", "-", "modules", "\"", ":", "0", ",", "\"", "no", "-", "restricted", "-", "syntax", "\"", ":", "0", ",", "\"", "no", "-", "return", "-", "assign", "\"", ":", "0", ",", "\"", "no", "-", "script", "-", "url", "\"", ":", "2", ",", "\"", "no", "-", "self", "-", "compare", "\"", ":", "2", ",", "\"", "no", "-", "sequences", "\"", ":", "2", ",", "\"", "no", "-", "shadow", "\"", ":", "0", ",", "\"", "no", "-", "shadow", "-", "restricted", "-", "names", "\"", ":", "2", ",", "\"", "no", "-", "spaced", "-", "func", "\"", ":", "2", ",", "\"", "no", "-", "sparse", "-", "arrays", "\"", ":", "2", ",", "\"", "no", "-", "ternary", "\"", ":", "0", ",", "\"", "no", "-", "this", "-", "before", "-", "super", "\"", ":", "2", ",", "\"", "no", "-", "throw", "-", "literal", "\"", ":", "2", ",", "\"", "no", "-", "trailing", "-", "spaces", "\"", ":", "2", ",", "\"", "no", "-", "undef", "\"", ":", "2", ",", "\"", "no", "-", "undef", "-", "init", "\"", ":", "0", ",", "\"", "no", "-", "undefined", "\"", ":", "0", ",", "\"", "no", "-", "underscore", "-", "dangle", "\"", ":", "0", ",", "\"", "no", "-", "unexpected", "-", "multiline", "\"", ":", "2", ",", "\"", "no", "-", "unneeded", "-", "ternary", "\"", ":", "2", ",", "\"", "no", "-", "unreachable", "\"", ":", "2", ",", "\"", "no", "-", "unused", "-", "expressions", "\"", ":", "2", ",", "\"", "no", "-", "unused", "-", "vars", "\"", ":", "2", ",", "\"", "no", "-", "use", "-", "before", "-", "define", "\"", ":", "[", "2", ",", "\"", "nofunc", "\"", "],", "\"", "no", "-", "useless", "-", "call", "\"", ":", "2", ",", "\"", "no", "-", "useless", "-", "concat", "\"", ":", "2", ",", "\"", "no", "-", "var", "\"", ":", "0", ",", "\"", "no", "-", "void", "\"", ":", "2", ",", "\"", "no", "-", "warning", "-", "comments", "\"", ":", "[", "2", ",", "{", "\"", "terms", "\"", ":", "[", "\"", "todo", "\"", ",", "\"", "fixme", "\"", "],", "\"", "location", "\"", ":", "\"", "anywhere", "\"", "}]", ",", "\"", "no", "-", "with", "\"", ":", "2", ",", "\"", "object", "-", "curly", "-", "spacing", "\"", ":", "0", ",", "\"", "object", "-", "shorthand", "\"", ":", "0", ",", "\"", "one", "-", "var", "\"", ":", "0", ",", "\"", "operator", "-", "assignment", "\"", ":", "[", "0", ",", "\"", "always", "\"", "],", "\"", "operator", "-", "linebreak", "\"", ":", "0", ",", "\"", "padded", "-", "blocks", "\"", ":", "[", "2", ",", "\"", "never", "\"", "],", "\"", "prefer", "-", "arrow", "-", "callback", "\"", ":", "0", ",", "\"", "prefer", "-", "const", "\"", ":", "0", ",", "\"", "prefer", "-", "destructuring", "\"", ":", "[", "0", ",", "{", "\"", "AssignmentExpression", "\"", ":", "{", "\"", "array", "\"", ":", "true", ",", "\"", "object", "\"", ":", "false", "}", "}", "],", "\"", "prefer", "-", "reflect", "\"", ":", "0", ",", "\"", "prefer", "-", "spread", "\"", ":", "0", ",", "\"", "prefer", "-", "template", "\"", ":", "0", ",", "\"", "quotes", "\"", ":", "[", "2", ",", "\"", "double", "\"", ",", "{", "\"", "avoidEscape", "\"", ":", "true", "}", "],", "\"", "quote", "-", "props", "\"", ":", "[", "2", ",", "\"", "as", "-", "needed", "\"", "],", "\"", "radix", "\"", ":", "2", ",", "\"", "require", "-", "jsdoc", "\"", ":", "0", ",", "\"", "require", "-", "yield", "\"", ":", "2", ",", "\"", "semi", "\"", ":", "[", "2", ",", "\"", "always", "\"", "],", "\"", "semi", "-", "spacing", "\"", ":", "[", "2", ",", "{", "\"", "before", "\"", ":", "false", ",", "\"", "after", "\"", ":", "true", "}", "],", "\"", "sort", "-", "vars", "\"", ":", "0", ",", "\"", "use", "-", "isnan", "\"", ":", "2", ",", "\"", "valid", "-", "jsdoc", "\"", ":", "0", ",", "\"", "valid", "-", "typeof", "\"", ":", "2", ",", "\"", "vars", "-", "on", "-", "top", "\"", ":", "0", ",", "\"", "wrap", "-", "iife", "\"", ":", "[", "2", ",", "\"", "inside", "\"", "],", "\"", "wrap", "-", "regex", "\"", ":", "0", ",", "\"", "yoda", "\"", ":", "[", "2", ",", "\"", "never", "\"", "]", "}", "}", "@", "@", "-", "1", ",", "5", "+", "1", ",", "6", "@", "@", "angular", "-", "expressions", "=", "==", "==", "==", "==", "==", "==", "==", "==", "==", "*", "*", "A", "security", "vulnerability", "has", "been", "found", "that", "affects", "all", "versions", "before", "1", ".", "0", ".", "1", ".", "Please", "read", "this", "advisory", "https", ":", "//", "github", ".", "com", "/", "peerigon", "/", "angular", "-", "expressions", "/", "security", "/", "advisories", "/", "GHSA", "-", "hxhm", "-", "96pp", "-", "2m43", "for", "more", "information", ".", "**", "#", "angular", "-", "expressions", "*", "*[", "angular", "'", "s", "nicest", "part", "]", "(", "https", ":", "//", "github", ".", "com", "/", "angular", "/", "angular", ".", "js", "/", "blob", "/", "6b049c74ccc9ee19688bb9bbe504c300e61776dc", "/", "src", "/", "ng", "/", "parse", ".", "js", ")", "extracted", "as", "a", "standalone", "module", "for", "the", "browser", "and", "node", ".", "**", "@", "@", "-", "38", ",", "16", "+", "39", ",", "13", "@", "@", "Check", "out", "[", "their", "readme", "]", "(", "http", ":", "//", "docs", ".", "angularjs", ".", "org", "/", "guide", "/", "expression", ")", "for", "further", "<", "br", "/", ">", "Setup", "#", "#", "Setup", "[", "![", "npm", "status", "]", "(", "https", ":", "//", "nodei", ".", "co", "/", "npm", "/", "angular", "-", "expressions", ".", "svg", "?", "downloads", "=", "true", "&", "stars", "=", "true", "&", "downloadRank", "=", "true", ")", "](", "https", ":", "//", "npmjs", ".", "org", "/", "package", "/", "angular", "-", "expressions", ")", "<", "br", "/", ">", "Filters", "#", "#", "Filters", "Angular", "provides", "a", "mechanism", "to", "define", "filters", "on", "expressions", ":", "@", "@", "-", "62", ",", "25", "+", "60", ",", "24", "@", "@", "Arguments", "are", "evaluated", "against", "the", "scope", ":", "`", "``", "javascript", "expressions", ".", "filters", ".", "currency", "=", "(", "input", ",", "currency", ",", "digits", ")", "=", ">", "{", "input", "=", "input", ".", "toFixed", "(", "digits", ")", ";", "input", "=", "input", ".", "toFixed", "(", "digits", ")", ";", "if", "(", "currency", "=", "==", "\"", "EUR", "\"", ")", "{", "return", "input", "+", "\"", "\u20ac\"", ";", "}", "else", "{", "return", "input", "+", "\"", "$\"", ";", "}", "if", "(", "currency", "=", "==", "\"", "EUR", "\"", ")", "{", "return", "input", "+", "\"", "\u20ac\"", ";", "}", "else", "{", "return", "input", "+", "\"", "$\"", ";", "}", "}", ";", "expr", "=", "expressions", ".", "compile", "(", "\"", "1", ".", "2345", "|", "currency", ":", "selectedCurrency", ":", "2", "\"", ");", "expr", "(", "{", "selectedCurrency", ":", "\"", "EUR", "\"", "selectedCurrency", ":", "\"", "EUR", "\"", "}", ");", "/", "/", "returns", "'", "1", ".", "23", "\u20ac", "'", "`", "``", "<", "br", "/", ">", "API", "#", "#", "API", "#", "##", "exports", "@", "@", "-", "104", ",", "9", "+", "101", ",", "9", "@", "@", "Example", "output", "of", ":", "`", "compile", "(", "\"", "tmp", "+", "1", "\"", ").", "ast", "`", "constant", ":", "false", "}", "`", "``", "*", "NOTE", "*", "angular", "$", "parse", "do", "not", "export", "ast", "variable", "it", "'", "s", "done", "by", "this", "library", ".", "_NOTE_", "angular", "\\", "$", "parse", "do", "not", "export", "ast", "variable", "it", "'", "s", "done", "by", "this", "library", ".", "#", "##", "#", ".", "compile", ".", "cache", "=", "{", "}", "#", "##", "#", ".", "compile", ".", "cache", "=", "Object", ".", "create", "(", "null", ")", "A", "cache", "containing", "all", "compiled", "functions", ".", "The", "src", "is", "used", "as", "key", ".", "Set", "this", "on", "`", "false", "`", "to", "disable", "the", "cache", ".", "@", "@", "-", "122", ",", "34", "+", "119", ",", "34", "@", "@", "The", "internal", "[", "Lexer", "]", "(", "https", ":", "//", "github", ".", "com", "/", "angular", "/", "angular", ".", "js", "/", "blob", "/", "6b049c74ccc9ee19", "The", "internal", "[", "Parser", "]", "(", "https", ":", "//", "github", ".", "com", "/", "angular", "/", "angular", ".", "js", "/", "blob", "/", "6b049c74ccc9ee19688bb9bbe504c300e61776dc", "/", "src", "/", "ng", "/", "parse", ".", "js", "#", "L390", ")", ".", "-", "--", "#", "##", "evaluate", "(", "scope", "?", "):", "*", "#", "##", "evaluate", "(", "scope", "?", "):", "\\", "*", "Evaluates", "the", "compiled", "`", "src", "`", "and", "returns", "the", "result", "of", "the", "expression", ".", "Property", "look", "-", "ups", "or", "assignments", "are", "executed", "on", "a", "given", "`", "scope", "`", ".", "#", "##", "evaluate", ".", "assign", "(", "scope", ",", "value", ")", ":", "*", "#", "##", "evaluate", ".", "assign", "(", "scope", ",", "value", ")", ":", "\\", "*", "Tries", "to", "assign", "the", "given", "`", "value", "`", "to", "the", "result", "of", "the", "compiled", "expression", "on", "the", "given", "`", "scope", "`", "and", "returns", "the", "result", "of", "the", "assignment", ".", "<", "br", "/", ">", "In", "the", "browser", "#", "#", "In", "the", "browser", "There", "is", "no", "`", "dist", "`", "build", "because", "it", "'", "s", "not", "2005", "anymore", ".", "Use", "a", "module", "bundler", "like", "[", "webpack", "]", "(", "http", ":", "//", "webpack", ".", "github", ".", "io", "/", ")", "or", "[", "browserify", "]", "(", "http", ":", "//", "browserify", ".", "org", "/", ").", "They", "'", "re", "both", "capable", "of", "CommonJS", "and", "AMD", ".", "<", "br", "/", ">", "Security", "#", "#", "Security", "The", "code", "of", "angular", "was", "not", "secured", "from", "reading", "prototype", ",", "and", "since", "version", "1", ".", "0", ".", "1", "of", "angular", "-", "expressions", ",", "the", "module", "disallows", "reading", "properties", "that", "are", "not", "ownProperties", ".", "See", "[", "this", "blog", "post", "]", "(", "http", ":", "//", "blog", ".", "angularjs", ".", "org", "/", "2016", "/", "09", "/", "angular", "-", "16", "-", "expression", "-", "sandbox", "-", "removal", ".", "html", ")", "for", "more", "details", "about", "the", "sandbox", "that", "got", "removed", "completely", "in", "angular", "1", ".", "6", ".", "Comment", "from", "`", "angular", ".", "js", "/", "src", "/", "ng", "/", "parse", ".", "js", "`", ":", "Angular", "expressions", "are", "generally", "considered", "safe", "because", "these", "expressions", "only", "have", "direct", "access", "to", "$", "scope", "and", "locals", ".", "However", ",", "one", "can", "obtain", "the", "ability", "to", "execute", "arbitrary", "JS", "code", "by", "access", "to", "\\", "$", "scope", "and", "locals", ".", "However", ",", "one", "can", "obtain", "the", "ability", "to", "execute", "arbitrary", "JS", "code", "by", "obtaining", "a", "reference", "to", "native", "JS", "functions", "such", "as", "the", "Function", "constructor", ".", "As", "an", "example", ",", "consider", "the", "following", "Angular", "expression", ":", "@", "@", "-", "180", ",", "16", "+", "177", ",", "13", "@", "@", "window", "or", "some", "DOM", "object", "that", "has", "a", "reference", "to", "window", "is", "published", "onto", "a", "Sco", "<", "br", "/", ">", "#", "#", "Authorship", "Authorship", "Kudos", "go", "entirely", "to", "the", "great", "angular", ".", "js", "team", ",", "it", "'", "s", "their", "implementation", "!", "<", "br", "/", ">", "Contributing", "#", "#", "Contributing", "Suggestions", "and", "bug", "-", "fixes", "are", "always", "appreciated", ".", "Don", "'", "t", "hesitate", "to", "create", "an", "issue", "or", "pull", "-", "request", ".", "All", "contributed", "code", "should", "pass", "@", "@", "-", "198", ",", "12", "+", "192", ",", "10", "@", "@", "Suggestions", "and", "bug", "-", "fixes", "are", "always", "appreciated", ".", "Don", "'", "t", "hesitate", "to", "create", "an", "is", "<", "br", "/", ">", "License", "#", "#", "License", "[", "Unlicense", "]", "(", "http", ":", "//", "unlicense", ".", "org", "/", ")", "Sponsors", "#", "#", "Sponsors", "[", "<", "img", "src", "=", "\"", "https", ":", "//", "assets", ".", "peerigon", ".", "com", "/", "peerigon", "/", "logo", "/", "peerigon", "-", "logo", "-", "flat", "-", "spinat", ".", "png", "\"", "width", "=", "\"", "150", "\"", "/", ">]", "(", "https", ":", "//", "peerigon", ".", "com", ")", "@", "@", "-", "6", ",", "24", "+", "6", ",", "29", "@", "@", "var", "filters", "=", "{", "};", "var", "Lexer", "=", "parse", ".", "Lexer", ";", "var", "Parser", "=", "parse", ".", "Parser", ";", "var", "parserOptions", "=", "{", "csp", ":", "false", ",", "/", "/", "noUnsafeEval", ",", "expensiveChecks", ":", "true", ",", "literals", ":", "{", "/", "/", "defined", "at", ":", "function", "$", "ParseProvider", "(", ")", "{", "true", ":", "true", ",", "false", ":", "false", ",", "null", ":", "null", ",", "/", "*", "eslint", "no", "-", "undefined", ":", "0", "*", "/", "undefined", ":", "undefined", "/", "*", "eslint", ":", "no", "-", "undefined", ":", "1", "*", "/", "}", "/", "/", "isIdentifierStart", ":", "undefined", ",", "/", "/", "isFunction", "(", "identStart", ")", "&", "&", "identStart", ",", "/", "/", "isIdentifierContinue", ":", "undefined", "/", "/", "isFunction", "(", "identContinue", ")", "&", "&", "identContinue", "csp", ":", "false", ",", "/", "/", "noUnsafeEval", ",", "expensiveChecks", ":", "true", ",", "literals", ":", "{", "/", "/", "defined", "at", ":", "function", "$", "ParseProvider", "(", ")", "{", "true", ":", "true", ",", "false", ":", "false", ",", "null", ":", "null", ",", "/", "*", "eslint", "no", "-", "undefined", ":", "0", "*", "/", "undefined", ":", "undefined", "/", "*", "eslint", ":", "no", "-", "undefined", ":", "1", "*", "/", "}", "/", "/", "isIdentifierStart", ":", "undefined", ",", "/", "/", "isFunction", "(", "identStart", ")", "&", "&", "identStart", ",", "/", "/", "isIdentifierContinue", ":", "undefined", "/", "/", "isFunction", "(", "identContinue", ")", "&", "&", "identContinue", "}", ";", "var", "lexer", "=", "new", "Lexer", "(", "{}", ");", "var", "parser", "=", "new", "Parser", "(", "lexer", ",", "function", "getFilter", "(", "name", ")", "{", "return", "filters", "[", "name", "]", ";", "}", ",", "parserOptions", ")", ";", "var", "parser", "=", "new", "Parser", "(", "lexer", ",", "function", "getFilter", "(", "name", ")", "{", "return", "filters", "[", "name", "]", ";", "}", ",", "parserOptions", ")", ";", "/", "**", "*", "Compiles", "src", "and", "returns", "a", "function", "that", "executes", "src", "on", "a", "target", "object", ".", "@", "@", "-", "33", ",", "22", "+", "38", ",", "24", "@", "@", "var", "parser", "=", "new", "Parser", "(", "lexer", ",", "function", "getFilter", "(", "name", ")", "{", "*", "@", "returns", "{", "function", "}", "*", "/", "function", "compile", "(", "src", ")", "{", "var", "cached", ";", "var", "cached", ";", "if", "(", "typeof", "src", "!", "==", "\"", "string", "\"", ")", "{", "throw", "new", "TypeError", "(", "\"", "src", "must", "be", "a", "string", ",", "instead", "saw", "'", "\"", "+", "typeof", "src", "+", "\"", "'\"", ");", "}", "if", "(", "typeof", "src", "!", "==", "\"", "string", "\"", ")", "{", "throw", "new", "TypeError", "(", "\"", "src", "must", "be", "a", "string", ",", "instead", "saw", "'", "\"", "+", "typeof", "src", "+", "\"", "'\"", ")", ";", "}", "if", "(", "!", "compile", ".", "cache", ")", "{", "return", "parser", ".", "parse", "(", "src", ")", ";", "}", "if", "(", "!", "compile", ".", "cache", ")", "{", "return", "parser", ".", "parse", "(", "src", ")", ";", "}", "cached", "=", "compile", ".", "cache", "[", "src", "]", ";", "if", "(", "!", "cached", ")", "{", "cached", "=", "compile", ".", "cache", "[", "src", "]", "=", "parser", ".", "parse", "(", "src", ")", ";", "}", "cached", "=", "compile", ".", "cache", "[", "src", "]", ";", "if", "(", "!", "cached", ")", "{", "cached", "=", "compile", ".", "cache", "[", "src", "]", "=", "parser", ".", "parse", "(", "src", ")", ";", "}", "return", "cached", ";", "return", "cached", ";", "}", "/", "**", "@", "@", "-", "57", ",", "7", "+", "64", ",", "7", "@", "@", "function", "compile", "(", "src", ")", "{", "*", "*", "@", "type", "{", "object", "}", "*", "/", "compile", ".", "cache", "=", "{", "};", "compile", ".", "cache", "=", "Object", ".", "create", "(", "null", ")", ";", "exports", ".", "Lexer", "=", "Lexer", ";", "exports", ".", "Parser", "=", "Parser", ";", "@", "@", "-", "5", ",", "8", "+", "5", ",", "8", "@", "@", "\"", "main", "\"", ":", "\"", "./", "lib", "/", "main", ".", "js", "\"", ",", "\"", "scripts", "\"", ":", "{", "\"", "test", "\"", ":", "\"", "mocha", "test", "/", "main", ".", "test", ".", "js", "-", "R", "spec", "\"", ",", "\"", "test", "-", "browser", "\"", ":", "\"", "webpack", "-", "dev", "-", "server", "mocha", "\\", "\\!", "./", "test", "/", "main", ".", "test", ".", "js", "-", "d", "\"", ",", "\"", "posttest", "\"", ":", "\"", "eslint", "-", "-", "fix", "lib", "test", "\"", "\"", "test", "-", "browser", "\"", ":", "\"", "webpack", "-", "dev", "-", "server", "'", "mocha", "-", "loader", "!", "./", "test", "/", "main", ".", "test", ".", "js", "'", "-", "-", "output", "-", "filename", "output", ".", "js", "-", "-", "port", "8081", "\"", ",", "\"", "posttest", "\"", ":", "\"", "eslint", "-", "-", "fix", "lib", "test", "&", "&", "prettier", "-", "-", "write", "lib", "/", "*.", "js", "test", "/", "*.", "js", "\"", "}", ",", "\"", "keywords", "\"", ":", "[", "\"", "angular", "\"", ",", "@", "@", "-", "20", ",", "11", "+", "20", ",", "13", "@", "@", "\"", "dependencies", "\"", ":", "{", "},", "\"", "devDependencies", "\"", ":", "{", "\"", "chai", "\"", ":", "\"", "^", "3", ".", "2", ".", "0", "\"", ",", "\"", "eslint", "\"", ":", "\"", "^", "1", ".", "5", ".", "0", "\"", ",", "\"", "eslint", "-", "config", "-", "peerigon", "\"", ":", "\"", "^", "0", ".", "1", ".", "0", "\"", ",", "\"", "mocha", "\"", ":", "\"", "^", "2", ".", "3", ".", "2", "\"", ",", "\"", "mocha", "-", "loader", "\"", ":", "\"", "^", "0", ".", "7", ".", "1", "\"", ",", "\"", "webpack", "-", "dev", "-", "server", "\"", ":", "\"", "^", "1", ".", "11", ".", "0", "\"", "\"", "eslint", "\"", ":", "\"", "^", "5", ".", "16", ".", "0", "\"", ",", "\"", "mocha", "\"", ":", "\"", "^", "7", ".", "0", ".", "0", "\"", ",", "\"", "mocha", "-", "loader", "\"", ":", "\"", "^", "4", ".", "0", ".", "1", "\"", ",", "\"", "prettier", "\"", ":", "\"", "^", "1", ".", "19", ".", "1", "\"", ",", "\"", "webpack", "\"", ":", "\"", "^", "4", ".", "41", ".", "5", "\"", ",", "\"", "webpack", "-", "cli", "\"", ":", "\"", "^", "3", ".", "3", ".", "10", "\"", ",", "\"", "webpack", "-", "dev", "-", "server", "\"", ":", "\"", "^", "3", ".", "10", ".", "1", "\"", "}", ",", "\"", "repository", "\"", ":", "{", "\"", "type", "\"", ":", "\"", "git", "\"", ",", "@", "@", "-", "1", ",", "3", "+", "0", ",", "0", "@", "@", "{", "\"", "extends", "\"", ":", "\"", "peerigon", "/", "es5tests", "\"", "}", "@", "@", "-", "9", ",", "466", "+", "9", ",", "473", "@", "@", "chai", ".", "config", ".", "includeStack", "=", "true", ";", "/", "/", "These", "tests", "make", "no", "claim", "to", "be", "complete", ".", "We", "only", "test", "the", "most", "important", "parts", "of", "angular", "expressions", ".", "/", "/", "I", "hope", "they", "have", "their", "own", "tests", ";", ")", "describe", "(", "\"", "expressions", "\"", ",", "function", "(", ")", "{", "describe", "(", "\".", "Lexer", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "be", "a", "function", "\"", ",", "function", "(", ")", "{", "expect", "(", "expressions", ".", "Lexer", ")", ".", "to", ".", "be", ".", "a", "(", "\"", "function", "\"", ");", "}", ");", "it", "(", "\"", "should", "provide", "a", ".", "lex", "(", ")-", "method", "\"", ",", "function", "(", ")", "{", "var", "lexer", "=", "new", "expressions", ".", "Lexer", "(", ");", "expect", "(", "lexer", ".", "lex", ")", ".", "to", ".", "be", ".", "a", "(", "\"", "function", "\"", ");", "}", ");", "}", ");", "describe", "(", "\".", "Parser", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "be", "a", "function", "\"", ",", "function", "(", ")", "{", "expect", "(", "expressions", ".", "Parser", ")", ".", "to", ".", "be", ".", "a", "(", "\"", "function", "\"", ");", "}", ");", "it", "(", "\"", "should", "provide", "a", ".", "parse", "(", ")-", "method", "\"", ",", "function", "(", ")", "{", "var", "parser", "=", "new", "expressions", ".", "Parser", "(", "undefined", ",", "undefined", ",", "{", "})", ";", "expect", "(", "parser", ".", "parse", ")", ".", "to", ".", "be", ".", "a", "(", "\"", "function", "\"", ");", "}", ");", "}", ");", "describe", "(", "\".", "compile", "(", "src", ")", "\",", "function", "(", ")", "{", "var", "scope", ";", "var", "evaluate", ";", "beforeEach", "(", "function", "(", ")", "{", "scope", "=", "{", "ship", ":", "{", "pirate", ":", "{", "name", ":", "\"", "Jenny", "\"", "}", "}", "}", ";", "}", ");", "it", "(", "\"", "should", "return", "a", "function", "\"", ",", "function", "(", ")", "{", "expect", "(", "compile", "(", "\"\"", "))", ".", "to", ".", "be", ".", "a", "(", "\"", "function", "\"", ");", "}", ");", "it", "(", "\"", "should", "throw", "an", "error", "if", "the", "given", "value", "is", "not", "a", "string", "\"", ",", "function", "(", ")", "{", "expect", "(", "function", "(", ")", "{", "compile", "(", ");", "}", ").", "to", ".", "throw", "(", "\"", "src", "must", "be", "a", "string", ",", "instead", "saw", "'", "undefined", "'", "\")", ";", "}", ");", "it", "(", "\"", "should", "expose", "the", "ast", "\"", ",", "function", "(", ")", "{", "expect", "(", "compile", "(", "\"", "tmp", "\"", ").", "ast", ")", ".", "to", ".", "be", ".", "a", "(", "\"", "object", "\"", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "literals", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "return", "null", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "null", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "null", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "true", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "true", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "true", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "false", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "false", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "false", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "2", ".", "34e5", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "2", ".", "34e5", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "2", ".", "34e5", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "'", "string", "'", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"'", "string", "'", "\")", ";", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "\"", "string", "\"", ");", "}", ");", "it", "(", "\"", "should", "return", "[", "ship", ",", "1", ",", "2", ",", "[", "]]", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"[", "ship", ",", "1", ",", "2", ",", "[", "]]", "\")", ";", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "eql", "(", "[", "scope", ".", "ship", ",", "1", ",", "2", ",", "[", "]]", ");", "}", ");", "it", "(", "\"", "should", "return", "{", "test", ":", "'", "value", "'", ",", "'", "new", "-", "object", "'", ":", "{", "}", "}", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"{", "test", ":", "'", "value", "'", ",", "'", "new", "-", "object", "'", ":", "{", "}", "}", "\")", ";", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "eql", "(", "{", "test", ":", "\"", "value", "\"", ",", "\"", "new", "-", "object", "\"", ":", "{", "}", "}", ");", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "simple", "key", "look", "-", "ups", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "return", "the", "value", "if", "its", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "ship", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "scope", ".", "ship", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "undefined", "instead", "of", "throwing", "a", "ReferenceError", "if", "it", "'", "s", "not", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "notDefined", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "undefined", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "scope", "even", "when", "the", "'", "this", "'", "keyword", "is", "used", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "this", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "scope", ")", ";", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "simple", "assignments", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "set", "the", "new", "value", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "newValue", "=", "'", "new", "'", "\")", ";", "evaluate", "(", "scope", ")", ";", "expect", "(", "scope", ".", "newValue", ")", ".", "to", ".", "equal", "(", "\"", "new", "\"", ");", "}", ");", "it", "(", "\"", "should", "change", "the", "value", "if", "its", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "ship", "=", "'", "ship", "'", "\")", ";", "evaluate", "(", "scope", ")", ";", "expect", "(", "scope", ".", "ship", ")", ".", "to", ".", "equal", "(", "\"", "ship", "\"", ");", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "dot", "-", "notated", "loop", "-", "ups", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "return", "the", "value", "if", "its", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "ship", ".", "pirate", ".", "name", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "\"", "Jenny", "\"", ");", "}", ");", "it", "(", "\"", "should", "return", "undefined", "instead", "of", "throwing", "a", "ReferenceError", "if", "it", "'", "s", "not", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "island", ".", "pirate", ".", "name", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "undefined", ")", ";", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "dot", "-", "notated", "assignments", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "set", "the", "new", "value", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "island", ".", "pirate", ".", "name", "=", "'", "St", "\u00f6", "rtebeker", "'", "\")", ";", "evaluate", "(", "scope", ")", ";", "expect", "(", "scope", ".", "island", ".", "pirate", ".", "name", ")", ".", "to", ".", "equal", "(", "\"", "St", "\u00f6", "rtebeker", "\"", ");", "}", ");", "it", "(", "\"", "should", "change", "the", "value", "if", "its", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "ship", ".", "pirate", ".", "name", "=", "'", "St", "\u00f6", "rtebeker", "'", "\")", ";", "evaluate", "(", "scope", ")", ";", "expect", "(", "scope", ".", "ship", ".", "pirate", ".", "name", ")", ".", "to", ".", "equal", "(", "\"", "St", "\u00f6", "rtebeker", "\"", ");", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "array", "look", "-", "ups", "\"", ",", "function", "(", ")", "{", "beforeEach", "(", "function", "(", ")", "{", "scope", ".", "ships", "=", "[", "{", "pirate", ":", "\"", "Jenny", "\"", "}", ",", "{", "pirate", ":", "\"", "St", "\u00f6", "rtebeker", "\"", "}", "]", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "value", "if", "its", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "ships", "[", "1", "]", ".", "pirate", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "\"", "St", "\u00f6", "rtebeker", "\"", ");", "}", ");", "it", "(", "\"", "should", "return", "undefined", "instead", "of", "throwing", "a", "ReferenceError", "if", "it", "'", "s", "not", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "ships", "[", "2", "]", ".", "pirate", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "undefined", ")", ";", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "array", "assignments", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "change", "the", "value", "if", "its", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "scope", ".", "ships", "=", "[", "{", "pirate", ":", "\"", "Jenny", "\"", "}", "]", ";", "evaluate", "=", "compile", "(", "\"", "ships", "[", "0", "]", ".", "pirate", "=", "'", "St", "\u00f6", "rtebeker", "'", "\")", ";", "evaluate", "(", "scope", ")", ";", "expect", "(", "scope", ".", "ships", "[", "0", "]", ".", "pirate", ")", ".", "to", ".", "equal", "(", "\"", "St", "\u00f6", "rtebeker", "\"", ");", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "function", "calls", "\"", ",", "function", "(", ")", "{", "describe", "(", "\"", "using", "no", "arguments", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "return", "the", "function", "'", "s", "return", "value", "\"", ",", "function", "(", ")", "{", "scope", ".", "findPirate", "=", "function", "(", ")", "{", "return", "scope", ".", "ship", ".", "pirate", ";", "}", ";", "evaluate", "=", "compile", "(", "\"", "findPirate", "(", ")\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "scope", ".", "ship", ".", "pirate", ")", ";", "}", ");", "it", "(", "\"", "should", "call", "the", "function", "on", "the", "scope", "\"", ",", "function", "(", ")", "{", "scope", ".", "returnThis", "=", "function", "(", ")", "{", "return", "this", ";", "}", ";", "evaluate", "=", "compile", "(", "\"", "returnThis", "(", ")\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "scope", ")", ";", "}", ");", "it", "(", "\"", "should", "call", "the", "function", "on", "the", "object", "where", "it", "is", "defined", "\"", ",", "function", "(", ")", "{", "scope", ".", "ship", ".", "returnThis", "=", "function", "(", ")", "{", "return", "this", ";", "}", ";", "evaluate", "=", "compile", "(", "\"", "ship", ".", "returnThis", "(", ")\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "scope", ".", "ship", ")", ";", "}", ");", "}", ");", "describe", "(", "\"", "using", "arguments", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "parse", "the", "arguments", "accordingly", "\"", ",", "function", "(", ")", "{", "scope", ".", "findPirate", "=", "function", "(", "pirate", ")", "{", "return", "Array", ".", "prototype", ".", "slice", ".", "call", "(", "arguments", ")", ";", "}", ";", "evaluate", "=", "compile", "(", "\"", "findPirate", "(", "ship", ".", "pirate", ",", "1", ",", "[", "2", ",", "3", "]", ")\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "eql", "(", "[", "scope", ".", "ship", ".", "pirate", ",", "1", ",", "[", "2", ",", "3", "]", "])", ";", "}", ");", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "operators", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "+", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "1", "+", "1", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "2", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "-", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "1", "-", "1", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "0", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "*", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "2", "*", "2", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "4", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "/", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "4", "/", "2", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "2", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "%", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "3", "%", "2", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "1", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "&", "&\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "true", "&", "&", "true", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "true", ")", ";", "evaluate", "=", "compile", "(", "\"", "true", "&", "&", "false", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "false", ")", ";", "evaluate", "=", "compile", "(", "\"", "false", "&", "&", "false", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "false", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "|", "|\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "true", "|", "|", "true", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "true", ")", ";", "evaluate", "=", "compile", "(", "\"", "true", "|", "|", "false", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "true", ")", ";", "evaluate", "=", "compile", "(", "\"", "false", "|", "|", "false", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "false", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "!", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"!", "true", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "false", ")", ";", "evaluate", "=", "compile", "(", "\"!", "false", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "true", ")", ";", "}", ");", "/", "*", "Ooops", ",", "angular", "doesn", "'", "t", "support", "+", "+.", "Maybe", "someday", "?", "describe", "(", "\"", "expressions", "\"", ",", "function", "(", ")", "{", "describe", "(", "\".", "Lexer", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "be", "a", "function", "\"", ",", "function", "(", ")", "{", "expect", "(", "expressions", ".", "Lexer", ")", ".", "to", ".", "be", ".", "a", "(", "\"", "function", "\"", ");", "}", ");", "it", "(", "\"", "should", "provide", "a", ".", "lex", "(", ")-", "method", "\"", ",", "function", "(", ")", "{", "var", "lexer", "=", "new", "expressions", ".", "Lexer", "(", ");", "expect", "(", "lexer", ".", "lex", ")", ".", "to", ".", "be", ".", "a", "(", "\"", "function", "\"", ");", "}", ");", "}", ");", "describe", "(", "\".", "Parser", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "be", "a", "function", "\"", ",", "function", "(", ")", "{", "expect", "(", "expressions", ".", "Parser", ")", ".", "to", ".", "be", ".", "a", "(", "\"", "function", "\"", ");", "}", ");", "it", "(", "\"", "should", "provide", "a", ".", "parse", "(", ")-", "method", "\"", ",", "function", "(", ")", "{", "var", "parser", "=", "new", "expressions", ".", "Parser", "(", "undefined", ",", "undefined", ",", "{", "})", ";", "expect", "(", "parser", ".", "parse", ")", ".", "to", ".", "be", ".", "a", "(", "\"", "function", "\"", ");", "}", ");", "}", ");", "describe", "(", "\".", "compile", "(", "src", ")", "\",", "function", "(", ")", "{", "var", "scope", ";", "var", "evaluate", ";", "beforeEach", "(", "function", "(", ")", "{", "scope", "=", "{", "ship", ":", "{", "pirate", ":", "{", "name", ":", "\"", "Jenny", "\"", "}", "}", "}", ";", "}", ");", "it", "(", "\"", "should", "return", "a", "function", "\"", ",", "function", "(", ")", "{", "expect", "(", "compile", "(", "\"\"", "))", ".", "to", ".", "be", ".", "a", "(", "\"", "function", "\"", ");", "}", ");", "it", "(", "\"", "should", "throw", "an", "error", "if", "the", "given", "value", "is", "not", "a", "string", "\"", ",", "function", "(", ")", "{", "expect", "(", "function", "(", ")", "{", "compile", "(", ");", "}", ").", "to", ".", "throw", "(", "\"", "src", "must", "be", "a", "string", ",", "instead", "saw", "'", "undefined", "'", "\")", ";", "}", ");", "it", "(", "\"", "should", "expose", "the", "ast", "\"", ",", "function", "(", ")", "{", "expect", "(", "compile", "(", "\"", "tmp", "\"", ").", "ast", ")", ".", "to", ".", "be", ".", "a", "(", "\"", "object", "\"", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "literals", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "return", "null", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "null", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "null", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "true", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "true", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "true", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "false", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "false", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "false", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "2", ".", "34e5", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "2", ".", "34e5", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "2", ".", "34e5", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "'", "string", "'", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"'", "string", "'", "\")", ";", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "\"", "string", "\"", ");", "}", ");", "it", "(", "\"", "should", "return", "[", "ship", ",", "1", ",", "2", ",", "[", "]]", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"[", "ship", ",", "1", ",", "2", ",", "[", "]]", "\")", ";", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "eql", "(", "[", "scope", ".", "ship", ",", "1", ",", "2", ",", "[", "]]", ");", "}", ");", "it", "(", "\"", "should", "return", "{", "test", ":", "'", "value", "'", ",", "'", "new", "-", "object", "'", ":", "{", "}", "}", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"{", "test", ":", "'", "value", "'", ",", "'", "new", "-", "object", "'", ":", "{", "}", "}", "\")", ";", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "eql", "(", "{", "test", ":", "\"", "value", "\"", ",", "\"", "new", "-", "object", "\"", ":", "{", "}", "}", ");", "}", ");", "it", "(", "\"", "should", "return", "context", "value", "when", "nothing", "in", "the", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "test", "\"", ");", "expect", "(", "evaluate", "(", "scope", ",", "{", "test", ":", "\"", "hello", "\"", "}", "))", ".", "to", ".", "equal", "(", "\"", "hello", "\"", ");", "}", ");", "it", "(", "\"", "should", "return", "context", "value", "when", "something", "in", "the", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "test", "\"", ");", "expect", "(", "evaluate", "(", "{", "test", ":", "\"", "bye", "\"", "}", ",", "{", "test", ":", "\"", "hello", "\"", "}", "))", ".", "to", ".", "equal", "(", "\"", "hello", "\"", ");", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "simple", "key", "look", "-", "ups", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "return", "the", "value", "if", "its", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "ship", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "scope", ".", "ship", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "undefined", "instead", "of", "throwing", "a", "ReferenceError", "if", "it", "'", "s", "not", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "notDefined", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "undefined", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "scope", "even", "when", "the", "'", "this", "'", "keyword", "is", "used", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "this", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "scope", ")", ";", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "simple", "assignments", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "set", "the", "new", "value", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "newValue", "=", "'", "new", "'", "\")", ";", "evaluate", "(", "scope", ")", ";", "expect", "(", "scope", ".", "newValue", ")", ".", "to", ".", "equal", "(", "\"", "new", "\"", ");", "}", ");", "it", "(", "\"", "should", "change", "the", "value", "if", "its", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "ship", "=", "'", "ship", "'", "\")", ";", "evaluate", "(", "scope", ")", ";", "expect", "(", "scope", ".", "ship", ")", ".", "to", ".", "equal", "(", "\"", "ship", "\"", ");", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "dot", "-", "notated", "loop", "-", "ups", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "return", "the", "value", "if", "its", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "ship", ".", "pirate", ".", "name", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "\"", "Jenny", "\"", ");", "}", ");", "it", "(", "\"", "should", "return", "undefined", "instead", "of", "throwing", "a", "ReferenceError", "if", "it", "'", "s", "not", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "island", ".", "pirate", ".", "name", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "undefined", ")", ";", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "dot", "-", "notated", "assignments", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "set", "the", "new", "value", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "island", ".", "pirate", ".", "name", "=", "'", "St", "\u00f6", "rtebeker", "'", "\")", ";", "evaluate", "(", "scope", ")", ";", "expect", "(", "scope", ".", "island", ".", "pirate", ".", "name", ")", ".", "to", ".", "equal", "(", "\"", "St", "\u00f6", "rtebeker", "\"", ");", "}", ");", "it", "(", "\"", "should", "change", "the", "value", "if", "its", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "ship", ".", "pirate", ".", "name", "=", "'", "St", "\u00f6", "rtebeker", "'", "\")", ";", "evaluate", "(", "scope", ")", ";", "expect", "(", "scope", ".", "ship", ".", "pirate", ".", "name", ")", ".", "to", ".", "equal", "(", "\"", "St", "\u00f6", "rtebeker", "\"", ");", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "array", "look", "-", "ups", "\"", ",", "function", "(", ")", "{", "beforeEach", "(", "function", "(", ")", "{", "scope", ".", "ships", "=", "[", "{", "pirate", ":", "\"", "Jenny", "\"", "}", ",", "{", "pirate", ":", "\"", "St", "\u00f6", "rtebeker", "\"", "}", "];", "}", ");", "it", "(", "\"", "should", "return", "the", "value", "if", "its", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "ships", "[", "1", "]", ".", "pirate", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "\"", "St", "\u00f6", "rtebeker", "\"", ");", "}", ");", "it", "(", "\"", "should", "return", "undefined", "instead", "of", "throwing", "a", "ReferenceError", "if", "it", "'", "s", "not", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "ships", "[", "2", "]", ".", "pirate", "\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "undefined", ")", ";", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "array", "assignments", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "change", "the", "value", "if", "its", "defined", "on", "scope", "\"", ",", "function", "(", ")", "{", "scope", ".", "ships", "=", "[", "{", "pirate", ":", "\"", "Jenny", "\"", "}", "];", "evaluate", "=", "compile", "(", "\"", "ships", "[", "0", "]", ".", "pirate", "=", "'", "St", "\u00f6", "rtebeker", "'", "\")", ";", "evaluate", "(", "scope", ")", ";", "expect", "(", "scope", ".", "ships", "[", "0", "]", ".", "pirate", ")", ".", "to", ".", "equal", "(", "\"", "St", "\u00f6", "rtebeker", "\"", ");", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "function", "calls", "\"", ",", "function", "(", ")", "{", "describe", "(", "\"", "using", "no", "arguments", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "return", "the", "function", "'", "s", "return", "value", "\"", ",", "function", "(", ")", "{", "scope", ".", "findPirate", "=", "function", "(", ")", "{", "return", "scope", ".", "ship", ".", "pirate", ";", "}", ";", "evaluate", "=", "compile", "(", "\"", "findPirate", "(", ")\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "scope", ".", "ship", ".", "pirate", ")", ";", "}", ");", "it", "(", "\"", "should", "call", "the", "function", "on", "the", "scope", "\"", ",", "function", "(", ")", "{", "scope", ".", "returnThis", "=", "function", "(", ")", "{", "return", "this", ";", "}", ";", "evaluate", "=", "compile", "(", "\"", "returnThis", "(", ")\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "scope", ")", ";", "}", ");", "it", "(", "\"", "should", "call", "the", "function", "on", "the", "object", "where", "it", "is", "defined", "\"", ",", "function", "(", ")", "{", "scope", ".", "ship", ".", "returnThis", "=", "function", "(", ")", "{", "return", "this", ";", "}", ";", "evaluate", "=", "compile", "(", "\"", "ship", ".", "returnThis", "(", ")\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "scope", ".", "ship", ")", ";", "}", ");", "}", ");", "describe", "(", "\"", "using", "arguments", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "parse", "the", "arguments", "accordingly", "\"", ",", "function", "(", ")", "{", "scope", ".", "findPirate", "=", "function", "(", ")", "{", "return", "Array", ".", "prototype", ".", "slice", ".", "call", "(", "arguments", ")", ";", "}", ";", "evaluate", "=", "compile", "(", "\"", "findPirate", "(", "ship", ".", "pirate", ",", "1", ",", "[", "2", ",", "3", "]", ")\"", ");", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "eql", "(", "[", "scope", ".", "ship", ".", "pirate", ",", "1", ",", "[", "2", ",", "3", "]", "])", ";", "}", ");", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "operators", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "+", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "1", "+", "1", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "2", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "-", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "1", "-", "1", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "0", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "*", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "2", "*", "2", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "4", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "/", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "4", "/", "2", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "2", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "%", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "3", "%", "2", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "1", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "&", "&\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "true", "&", "&", "true", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "true", ")", ";", "evaluate", "=", "compile", "(", "\"", "true", "&", "&", "false", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "false", ")", ";", "evaluate", "=", "compile", "(", "\"", "false", "&", "&", "false", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "false", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "|", "|\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "true", "|", "|", "true", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "true", ")", ";", "evaluate", "=", "compile", "(", "\"", "true", "|", "|", "false", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "true", ")", ";", "evaluate", "=", "compile", "(", "\"", "false", "|", "|", "false", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "false", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "!", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"!", "true", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "false", ")", ";", "evaluate", "=", "compile", "(", "\"!", "false", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "true", ")", ";", "}", ");", "/", "*", "Ooops", ",", "angular", "doesn", "'", "t", "support", "+", "+.", "Maybe", "someday", "?", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "+", "+\"", ",", "function", "(", ")", "{", "scope", ".", "value", "=", "2", ";", "evaluate", "=", "compile", "(", "\"", "value", "+", "+\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "3", ")", ";", "expect", "(", "scope", ".", "value", ")", ".", "to", ".", "equal", "(", "3", ")", ";", "}", ");", "*/", "/", "*", "Ooops", ",", "angular", "doesn", "'", "t", "support", "-", "-.", "Maybe", "someday", "?", "/", "*", "Ooops", ",", "angular", "doesn", "'", "t", "support", "-", "-.", "Maybe", "someday", "?", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "-", "-\"", ",", "function", "(", ")", "{", "scope", ".", "value", "=", "2", ";", "evaluate", "=", "compile", "(", "\"", "value", "-", "-\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "1", ")", ";", "expect", "(", "scope", ".", "value", ")", ".", "to", ".", "equal", "(", "1", ")", ";", "}", ");", "*/", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "?", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "true", "?", "'", "it", "works", "'", ":", "false", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "\"", "it", "works", "\"", ");", "evaluate", "=", "compile", "(", "\"", "false", "?", "false", ":", "'", "it", "works", "'", "\")", ";", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "\"", "it", "works", "\"", ");", "}", ");", "}", ");", "describe", "(", "\"", "using", "complex", "expressions", "\"", ",", "function", "(", ")", "{", "beforeEach", "(", "function", "(", ")", "{", "scope", ".", "ships", "=", "[", "{", "pirate", ":", "function", "(", "str", ")", "{", "return", "str", ";", "}", "}", ",", "{", "pirate", ":", "function", "(", "str", ")", "{", "return", "str", ";", "}", "}", "]", ";", "scope", ".", "index", "=", "0", ";", "scope", ".", "pi", "=", "\"", "pi", "\"", ";", "scope", ".", "Jenny", "=", "\"", "Jenny", "\"", ";", "}", ");", "it", "(", "\"", "should", "still", "be", "parseable", "and", "executable", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "ships", "[", "index", "]", "[", "pi", "+", "'", "rate", "'", "](", "Jenny", ")", "\")", ";", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "\"", "Jenny", "\"", ");", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "syntactical", "errors", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "give", "a", "readable", "error", "message", "\"", ",", "function", "(", ")", "{", "expect", "(", "function", "(", ")", "{", "compile", "(", "\"'", "unterminated", "string", "\"", ");", "}", ").", "to", ".", "throw", "(", "\"", "Lexer", "Error", ":", "Unterminated", "quote", "at", "columns", "0", "-", "20", "[", "'", "unterminated", "string", "]", "in", "expression", "[", "'", "unterminated", "string", "]", ".\"", ");", "}", ");", "it", "(", "\"", "should", "give", "a", "readable", "error", "message", "\"", ",", "function", "(", ")", "{", "expect", "(", "function", "(", ")", "{", "compile", "(", "\"", "3", "=", "4", "\"", ");", "}", ").", "to", ".", "throw", "(", "\"[", "$", "parse", ":", "lval", "]", "Trying", "to", "assign", "a", "value", "to", "a", "non", "l", "-", "value", "\\", "nhttp", ":", "//", "errors", ".", "angularjs", ".", "org", "/", "\\\"", "NG_VERSION_FULL", "\\", "\"/", "$", "parse", "/", "lval", "\"", ");", "}", ");", "}", ");", "describe", "(", "\"", "when", "using", "filters", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "apply", "the", "given", "filter", "\"", ",", "function", "(", ")", "{", "expressions", ".", "filters", ".", "currency", "=", "function", "(", "input", ",", "currency", ",", "digits", ")", "{", "input", "=", "input", ".", "toFixed", "(", "digits", ")", ";", "if", "(", "currency", "=", "==", "\"", "EUR", "\"", ")", "{", "return", "input", "+", "\"", "\u20ac\"", ";", "}", "return", "input", "+", "\"", "$\"", ";", "}", ";", "evaluate", "=", "compile", "(", "\"", "1", ".", "2345", "|", "currency", ":", "selectedCurrency", ":", "2", "\"", ");", "expect", "(", "evaluate", "(", "{", "selectedCurrency", ":", "\"", "EUR", "\"", "}", "))", ".", "to", ".", "equal", "(", "\"", "1", ".", "23", "\u20ac", "\")", ";", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "the", "same", "expression", "multiple", "times", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "cache", "the", "generated", "function", "\"", ",", "function", "(", ")", "{", "expect", "(", "compile", "(", "\"", "a", "\"", "))", ".", "to", ".", "equal", "(", "compile", "(", "\"", "a", "\"", "))", ";", "}", ");", "}", ");", "describe", "(", "\"", "for", "assigning", "values", "\"", ",", "function", "(", ")", "{", "beforeEach", "(", "function", "(", ")", "{", "scope", "=", "{", "};", "}", ");", "it", "(", "\"", "should", "expose", "an", "'", "assign", "'", "-", "function", "\"", ",", "function", "(", ")", "{", "var", "fn", "=", "compile", "(", "\"", "a", "\"", ");", "expect", "(", "fn", ".", "assign", ")", ".", "to", ".", "be", ".", "a", "(", "\"", "function", "\"", ");", "fn", ".", "assign", "(", "scope", ",", "123", ")", ";", "expect", "(", "scope", ".", "a", ")", ".", "to", ".", "equal", "(", "123", ")", ";", "}", ");", "describe", "(", "\"", "the", "'", "assign", "'", "-", "function", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "work", "for", "expressions", "ending", "with", "brackets", "\"", ",", "function", "(", ")", "{", "var", "fn", "=", "compile", "(", "\"", "a", ".", "b", "[", "'", "c", "'", "]\"", ");", "fn", ".", "assign", "(", "scope", ",", "123", ")", ";", "expect", "(", "scope", ".", "a", ".", "b", ".", "c", ")", ".", "to", ".", "equal", "(", "123", ")", ";", "}", ");", "it", "(", "\"", "should", "work", "for", "expressions", "with", "brackets", "in", "the", "middle", "\"", ",", "function", "(", ")", "{", "var", "fn", "=", "compile", "(", "\"", "a", "[", "\\\"", "b", "\\", "\"]", ".", "c", "\"", ");", "fn", ".", "assign", "(", "scope", ",", "123", ")", ";", "expect", "(", "scope", ".", "a", ".", "b", ".", "c", ")", ".", "to", ".", "equal", "(", "123", ")", ";", "}", ");", "it", "(", "\"", "should", "work", "for", "expressions", "with", "brackets", "in", "the", "middle", "\"", ",", "function", "(", ")", "{", "var", "fn", "=", "compile", "(", "\"", "a", "[", "\\\"", "b", "\\", "\"]", ".", "c", "\"", ");", "fn", ".", "assign", "(", "scope", ",", "123", ")", ";", "expect", "(", "scope", ".", "a", ".", "b", ".", "c", ")", ".", "to", ".", "equal", "(", "123", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "result", "of", "the", "assignment", "\"", ",", "function", "(", ")", "{", "var", "fn", "=", "compile", "(", "\"", "a", "[", "\\\"", "b", "\\", "\"]", ".", "c", "\"", ");", "expect", "(", "fn", ".", "assign", "(", "scope", ",", "123", ")", ").", "to", ".", "equal", "(", "123", ")", ";", "}", ");", "}", ");", "}", ");", "describe", "(", "\".", "cache", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "be", "an", "object", "by", "default", "\"", ",", "function", "(", ")", "{", "expect", "(", "compile", ".", "cache", ")", ".", "to", ".", "be", ".", "an", "(", "\"", "object", "\"", ");", "}", ");", "it", "(", "\"", "should", "cache", "the", "generated", "function", "by", "the", "expression", "\"", ",", "function", "(", ")", "{", "var", "fn", "=", "compile", "(", "\"", "a", "\"", ");", "expect", "(", "compile", ".", "cache", ".", "a", ")", ".", "to", ".", "equal", "(", "fn", ")", ";", "}", ");", "describe", "(", "\"", "when", "setting", "it", "to", "false", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "disable", "the", "cache", "\"", ",", "function", "(", ")", "{", "compile", ".", "cache", "=", "false", ";", "expect", "(", "compile", "(", "\"", "a", "\"", "))", ".", "to", ".", "not", ".", "equal", "(", "compile", "(", "\"", "a", "\"", "))", ";", "compile", ".", "cache", "=", "{", "};", "}", ");", "}", ");", "}", ");", "}", ");", "describe", "(", "\".", "filters", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "be", "an", "object", "\"", ",", "function", "(", ")", "{", "expect", "(", "expressions", ".", "filters", ")", ".", "to", ".", "be", ".", "an", "(", "\"", "object", "\"", ");", "}", ");", "}", ");", "it", "(", "\"", "should", "return", "the", "expected", "result", "when", "using", "?", "\",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "true", "?", "'", "it", "works", "'", ":", "false", "\"", ");", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "\"", "it", "works", "\"", ");", "evaluate", "=", "compile", "(", "\"", "false", "?", "false", ":", "'", "it", "works", "'", "\")", ";", "expect", "(", "evaluate", "(", "))", ".", "to", ".", "equal", "(", "\"", "it", "works", "\"", ");", "}", ");", "}", ");", "describe", "(", "\"", "using", "complex", "expressions", "\"", ",", "function", "(", ")", "{", "beforeEach", "(", "function", "(", ")", "{", "scope", ".", "ships", "=", "[", "{", "pirate", ":", "function", "(", "str", ")", "{", "return", "str", ";", "}", "}", ",", "{", "pirate", ":", "function", "(", "str", ")", "{", "return", "str", ";", "}", "}", "]", ";", "scope", ".", "index", "=", "0", ";", "scope", ".", "pi", "=", "\"", "pi", "\"", ";", "scope", ".", "Jenny", "=", "\"", "Jenny", "\"", ";", "}", ");", "it", "(", "\"", "should", "still", "be", "parseable", "and", "executable", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "ships", "[", "index", "]", "[", "pi", "+", "'", "rate", "'", "](", "Jenny", ")", "\")", ";", "expect", "(", "evaluate", "(", "scope", ")", ").", "to", ".", "equal", "(", "\"", "Jenny", "\"", ");", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "syntactical", "errors", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "give", "a", "readable", "error", "message", "\"", ",", "function", "(", ")", "{", "expect", "(", "function", "(", ")", "{", "compile", "(", "\"'", "unterminated", "string", "\"", ");", "}", ").", "to", ".", "throw", "(", "\"", "Lexer", "Error", ":", "Unterminated", "quote", "at", "columns", "0", "-", "20", "[", "'", "unterminated", "string", "]", "in", "expression", "[", "'", "unterminated", "string", "]", ".\"", ")", ";", "}", ");", "it", "(", "\"", "should", "give", "a", "readable", "error", "message", "\"", ",", "function", "(", ")", "{", "expect", "(", "function", "(", ")", "{", "compile", "(", "\"", "3", "=", "4", "\"", ");", "}", ").", "to", ".", "throw", "(", "'", "[$", "parse", ":", "lval", "]", "Trying", "to", "assign", "a", "value", "to", "a", "non", "l", "-", "value", "\\", "nhttp", ":", "//", "errors", ".", "angularjs", ".", "org", "/", "\"", "NG_VERSION_FULL", "\"", "/$", "parse", "/", "lval", "'", ")", ";", "}", ");", "}", ");", "describe", "(", "\"", "when", "using", "filters", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "apply", "the", "given", "filter", "\"", ",", "function", "(", ")", "{", "expressions", ".", "filters", ".", "currency", "=", "function", "(", "input", ",", "currency", ",", "digits", ")", "{", "input", "=", "input", ".", "toFixed", "(", "digits", ")", ";", "if", "(", "currency", "=", "==", "\"", "EUR", "\"", ")", "{", "return", "input", "+", "\"", "\u20ac\"", ";", "}", "return", "input", "+", "\"", "$\"", ";", "}", ";", "evaluate", "=", "compile", "(", "\"", "1", ".", "2345", "|", "currency", ":", "selectedCurrency", ":", "2", "\"", ");", "expect", "(", "evaluate", "(", "{", "selectedCurrency", ":", "\"", "EUR", "\"", "}", ")", ")", ".", "to", ".", "equal", "(", "\"", "1", ".", "23", "\u20ac", "\")", ";", "}", ");", "}", ");", "describe", "(", "\"", "when", "evaluating", "the", "same", "expression", "multiple", "times", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "cache", "the", "generated", "function", "\"", ",", "function", "(", ")", "{", "expect", "(", "compile", "(", "\"", "a", "\"", "))", ".", "to", ".", "equal", "(", "compile", "(", "\"", "a", "\"", "))", ";", "}", ");", "}", ");", "describe", "(", "\"", "for", "assigning", "values", "\"", ",", "function", "(", ")", "{", "beforeEach", "(", "function", "(", ")", "{", "scope", "=", "{", "};", "}", ");", "it", "(", "\"", "should", "expose", "an", "'", "assign", "'", "-", "function", "\"", ",", "function", "(", ")", "{", "var", "fn", "=", "compile", "(", "\"", "a", "\"", ");", "expect", "(", "fn", ".", "assign", ")", ".", "to", ".", "be", ".", "a", "(", "\"", "function", "\"", ");", "fn", ".", "assign", "(", "scope", ",", "123", ")", ";", "expect", "(", "scope", ".", "a", ")", ".", "to", ".", "equal", "(", "123", ")", ";", "}", ");", "describe", "(", "\"", "the", "'", "assign", "'", "-", "function", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "work", "for", "expressions", "ending", "with", "brackets", "\"", ",", "function", "(", ")", "{", "var", "fn", "=", "compile", "(", "\"", "a", ".", "b", "[", "'", "c", "'", "]\"", ");", "fn", ".", "assign", "(", "scope", ",", "123", ")", ";", "expect", "(", "scope", ".", "a", ".", "b", ".", "c", ")", ".", "to", ".", "equal", "(", "123", ")", ";", "}", ");", "it", "(", "\"", "should", "work", "for", "expressions", "with", "brackets", "in", "the", "middle", "\"", ",", "function", "(", ")", "{", "var", "fn", "=", "compile", "(", "'", "a", "[", "\"", "b", "\"", "].", "c", "'", ");", "fn", ".", "assign", "(", "scope", ",", "123", ")", ";", "expect", "(", "scope", ".", "a", ".", "b", ".", "c", ")", ".", "to", ".", "equal", "(", "123", ")", ";", "}", ");", "it", "(", "\"", "should", "return", "the", "result", "of", "the", "assignment", "\"", ",", "function", "(", ")", "{", "var", "fn", "=", "compile", "(", "'", "a", "[", "\"", "b", "\"", "].", "c", "'", ");", "expect", "(", "fn", ".", "assign", "(", "scope", ",", "123", ")", ").", "to", ".", "equal", "(", "123", ")", ";", "}", ");", "}", ");", "}", ");", "describe", "(", "\".", "cache", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "be", "an", "object", "by", "default", "\"", ",", "function", "(", ")", "{", "expect", "(", "compile", ".", "cache", ")", ".", "to", ".", "be", ".", "an", "(", "\"", "object", "\"", ");", "}", ");", "it", "(", "\"", "should", "cache", "the", "generated", "function", "by", "the", "expression", "\"", ",", "function", "(", ")", "{", "var", "fn", "=", "compile", "(", "\"", "a", "\"", ");", "expect", "(", "compile", ".", "cache", ".", "a", ")", ".", "to", ".", "equal", "(", "fn", ")", ";", "}", ");", "describe", "(", "\"", "when", "setting", "it", "to", "false", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "disable", "the", "cache", "\"", ",", "function", "(", ")", "{", "compile", ".", "cache", "=", "false", ";", "expect", "(", "compile", "(", "\"", "a", "\"", "))", ".", "to", ".", "not", ".", "equal", "(", "compile", "(", "\"", "a", "\"", "))", ";", "compile", ".", "cache", "=", "Object", ".", "create", "(", "null", ")", ";", "}", ");", "}", ");", "}", ");", "}", ");", "describe", "(", "\".", "filters", "\"", ",", "function", "(", ")", "{", "it", "(", "\"", "should", "be", "an", "object", "\"", ",", "function", "(", ")", "{", "expect", "(", "expressions", ".", "filters", ")", ".", "to", ".", "be", ".", "an", "(", "\"", "object", "\"", ");", "}", ");", "}", ");", "describe", "(", "\"", "prototype", "\"", ",", "function", "(", ")", "{", "var", "evaluate", ";", "it", "(", "\"", "should", "not", "leak", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"'", "'.", "split", "\"", ");", "expect", "(", "evaluate", "(", "{}", "))", ".", "to", ".", "eql", "(", "undefined", ")", ";", "}", ");", "it", "(", "\"", "should", "not", "leak", "with", "computed", "prop", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "a", "[", "'", "split", "'", "]\"", ");", "expect", "(", "evaluate", "(", "{", "a", ":", "\"", "\"", "}", "))", ".", "to", ".", "eql", "(", "undefined", ")", ";", "}", ");", "it", "(", "\"", "should", "allow", "to", "read", "string", "length", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"'", "abc", "'", ".", "length", "\"", ");", "expect", "(", "evaluate", "(", "{}", "))", ".", "to", ".", "eql", "(", "3", ")", ";", "}", ");", "it", "(", "\"", "should", "allow", "to", "read", "users", "length", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "users", ".", "length", "\"", ");", "expect", "(", "evaluate", "(", "{", "users", ":", "[", "1", ",", "4", ",", "4", "]", "}", "))", ".", "to", ".", "eql", "(", "3", ")", ";", "}", ");", "/", "/", "it", "(", "\"", "should", "disallow", "from", "changing", "prototype", "\"", ",", "function", "(", ")", "{", "/", "/", "evaluate", "=", "compile", "(", "\"", "name", ".", "split", "=", "10", "\"", ");", "/", "/", "var", "scope", "=", "{", "name", ":", "\"", "hello", "\"", "}", ";", "/", "/", "evaluate", "(", "scope", ")", ";", "/", "/", "expect", "(", "scope", ".", "name", ".", "split", ")", ".", "to", ".", "be", ".", "a", "(", "\"", "function", "\"", ");", "/", "/", "}", ");", "/", "/", "/", "/", "it", "(", "\"", "should", "work", "with", "__proto__", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "__proto__", "\"", ");", "expect", "(", "evaluate", "(", "{}", "))", ".", "to", ".", "eql", "(", "undefined", ")", ";", "}", ");", "it", "(", "\"", "should", "work", "with", "toString", "\"", ",", "function", "(", ")", "{", "evaluate", "=", "compile", "(", "\"", "toString", "\"", ");", "expect", "(", "evaluate", "(", "{", "toString", ":", "10", "}", "))", ".", "to", ".", "eql", "(", "10", ")", ";", "}", ");", "}", ");", "}", ");"], "docstring_tokens": ["improper", "input", "validation"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "2792", ",", "7", "+", "2792", ",", "7", "@", "@", "static", "int", "rtl8169_rx_interrupt", "(", "struct", "net_device", "*", "dev", ",", "pkt_size", ",", "PCI_DMA_FROMDEVICE", ")", ";", "rtl8169_mark_to_asic", "(", "desc", ",", "tp", "-", ">", "rx_buf_sz", ")", ";", "}", "else", "{", "pci_unmap_single", "(", "pdev", ",", "addr", ",", "pkt_size", ",", "pci_unmap_single", "(", "pdev", ",", "addr", ",", "tp", "-", ">", "rx_buf_sz", ",", "PCI_DMA_FROMDEVICE", ")", ";", "tp", "-", ">", "Rx_skbuff", "[", "entry", "]", "=", "NULL", ";", "}"], "docstring_tokens": ["an", "out-of-IOMMU", "error"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1649", ",", "9", "+", "1649", ",", "12", "@", "@", "static", "inline", "int", "skb_gro_header_hard", "(", "struct", "sk_buff", "*", "skb", ",", "unsigned", "int", "hlen", ")", "static", "inline", "void", "*", "skb_gro_header_slow", "(", "struct", "sk_buff", "*", "skb", ",", "unsigned", "int", "hlen", ",", "unsigned", "int", "offset", ")", "{", "if", "(", "!", "pskb_may_pull", "(", "skb", ",", "hlen", ")", ")", "return", "NULL", ";", "NAPI_GRO_CB", "(", "skb", ")", "->", "frag0", "=", "NULL", ";", "NAPI_GRO_CB", "(", "skb", ")", "->", "frag0_len", "=", "0", ";", "return", "pskb_may_pull", "(", "skb", ",", "hlen", ")", "?", "skb", "-", ">", "data", "+", "offset", ":", "NULL", ";", "return", "skb", "-", ">", "data", "+", "offset", ";", "}", "static", "inline", "void", "*", "skb_gro_mac_header", "(", "struct", "sk_buff", "*", "skb", ")"], "docstring_tokens": ["when", "Generic", "Receive", "Offload", "(GRO", ")", "is", "enabled"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "1784", ",", "6", "+", "1784", ",", "15", "@", "@", ".", "align", "32", ".", "L8x_tail_done", ":", "add", "(", "%", "rdx", ")", ",%", "r8", "#", "can", "this", "overflow", "?", "adc", "\\", "$", "0", ",", "%", "r9", "adc", "\\", "$", "0", ",", "%", "r10", "adc", "\\", "$", "0", ",", "%", "r11", "adc", "\\", "$", "0", ",", "%", "r12", "adc", "\\", "$", "0", ",", "%", "r13", "adc", "\\", "$", "0", ",", "%", "r14", "adc", "\\", "$", "0", ",", "%", "r15", "#", "can", "'", "t", "overflow", ",", "because", "we", "#", "started", "with", "\"", "overhung", "\"", "part", "#", "of", "multiplication", "xor", "%", "rax", ",", "%", "rax", "neg", "$", "carry", "@", "@", "-", "3130", ",", "6", "+", "3139", ",", "15", "@", "@", ".", "align", "32", ".", "Lsqrx8x_tail_done", ":", "add", "24", "+", "8", "(", "%", "rsp", ")", ",%", "r8", "#", "can", "this", "overflow", "?", "adc", "\\", "$", "0", ",", "%", "r9", "adc", "\\", "$", "0", ",", "%", "r10", "adc", "\\", "$", "0", ",", "%", "r11", "adc", "\\", "$", "0", ",", "%", "r12", "adc", "\\", "$", "0", ",", "%", "r13", "adc", "\\", "$", "0", ",", "%", "r14", "adc", "\\", "$", "0", ",", "%", "r15", "#", "can", "'", "t", "overflow", ",", "because", "we", "#", "started", "with", "\"", "overhung", "\"", "part", "#", "of", "multiplication", "mov", "$", "carry", ",", "%", "rax", "#", "xor", "%", "rax", ",", "%", "rax", "sub", "16", "+", "8", "(", "%", "rsp", ")", ",$", "carry", "#", "mov", "16", "(", "%", "rsp", ")", ",%", "cf", "@", "@", "-", "3173", ",", "13", "+", "3191", ",", "11", "@", "@", "my", "@", "ri", "=", "map", "(", "\"%", "r", "$", "_", "\"", ",(", "10", ".", ".", "13", ")", ");", "my", "@", "ni", "=", "map", "(", "\"%", "r", "$", "_", "\"", ",(", "14", ".", ".", "15", ")", ");", "$", "code", ".", "=<", "<", "___", ";", "xor", "%", "rbx", ",", "%", "rbx", "xor", "%", "ebx", ",", "%", "ebx", "sub", "%", "r15", ",", "%", "rsi", "#", "compare", "top", "-", "most", "words", "adc", "%", "rbx", ",", "%", "rbx", "mov", "%", "rcx", ",", "%", "r10", "#", "-", "$", "num", ".", "byte", "0x67", "or", "%", "rbx", ",", "%", "rax", ".", "byte", "0x67", "mov", "%", "rcx", ",", "%", "r9", "#", "-", "$", "num", "xor", "\\", "$", "1", ",", "%", "rax", "sar", "\\", "$", "3", "+", "2", ",", "%", "rcx", "#", "cf", "=", "0", "@", "@", "-", "1016", ",", "6", "+", "1016", ",", "24", "@", "@", "int", "test_mod_exp", "(", "BIO", "*", "bp", ",", "BN_CTX", "*", "ctx", ")", "return", "0", ";", "}", "}", "/", "*", "Regression", "test", "for", "carry", "propagation", "bug", "in", "sqr8x_reduction", "*", "/", "BN_hex2bn", "(", "&", "a", ",", "\"", "050505050505", "\"", ");", "BN_hex2bn", "(", "&", "b", ",", "\"", "02", "\"", ");", "BN_hex2bn", "(", "&", "c", ",", "\"", "4141414141414141414141274141414141414141414141414141414141414141", "\"", "\"", "4141414141414141414141414141414141414141414141414141414141414141", "\"", "\"", "4141414141414141414141800000000000000000000000000000000000000000", "\"", "\"", "0000000000000000000000000000000000000000000000000000000000000000", "\"", "\"", "0000000000000000000000000000000000000000000000000000000000000000", "\"", "\"", "0000000000000000000000000000000000000000000000000000000001", "\"", ");", "BN_mod_exp", "(", "d", ",", "a", ",", "b", ",", "c", ",", "ctx", ")", ";", "BN_mul", "(", "e", ",", "a", ",", "a", ",", "ctx", ")", ";", "if", "(", "BN_cmp", "(", "d", ",", "e", ")", ")", "{", "fprintf", "(", "stderr", ",", "\"", "BN_mod_exp", "and", "BN_mul", "produce", "different", "results", "!", "\\", "n", "\"", ");", "return", "0", ";", "}", "BN_free", "(", "a", ")", ";", "BN_free", "(", "b", ")", ";", "BN_free", "(", "c", ")", ";"], "docstring_tokens": ["carry", "propagation", "and", "produces", "incorrect", "output"]}
{"contents": ["empty"], "code_tokens": ["@", "@", "-", "314", ",", "12", "+", "314", ",", "20", "@", "@", "function", "pluginConnectionError", "(", "codeServer", ")", "{", "if", "(", "$", "errFn", ")", "{", "$", "errFn", "(", "$", "moduleName", ")", ";", "}", "else", "{", "__gwt_displayGlassMessage", "(", "\"", "Plugin", "failed", "to", "connect", "to", "Development", "Mode", "server", "at", "\"", "+", "codeServer", ",", "__gwt_displayGlassMessage", "(", "\"", "Plugin", "failed", "to", "connect", "to", "Development", "Mode", "server", "at", "\"", "simpleEscape", "(", "codeServer", ")", ",", "\"", "Follow", "the", "underlying", "troubleshooting", "instructions", "\"", ");", "loadIframe", "(", "\"", "http", ":", "//", "code", ".", "google", ".", "com", "/", "p", "/", "google", "-", "web", "-", "toolkit", "/", "wiki", "/", "TroubleshootingOOPHM", "\"", ");", "}", "}", "function", "simpleEscape", "(", "originalString", ")", "{", "return", "originalString", ".", "replace", "(", "\"&", "\",", "\"&", "amp", ";", "\")", ".", "replace", "(", "\"<", "\",", "\"&", "lt", ";", "\")", ".", "replace", "(", "\">", "\",", "\"&", "gt", ";", "\")", ".", "replace", "(", "\"\\", "\"\"", ",\"", "&", "quot", ";", "\")", ";", "}", "function", "tryConnectingToPlugin", "(", "sessionId", ",", "url", ")", "{", "/", "/", "Note", "that", "the", "order", "is", "important", "var", "pluginFinders", "=", "[", "findPluginXPCOM", ",", "findPluginObject", ",", "findPluginEmbed", "]", ";", "@", "@", "-", "295", ",", "14", "+", "295", ",", "22", "@", "@", "if", "(", "errFn", ")", "{", "errFn", "(", "modName", ")", ";", "}", "else", "{", "__gwt_displayGlassMessage", "(", "\"", "Plugin", "failed", "to", "connect", "to", "Development", "Mode", "server", "at", "\"", "+", "$", "hosted", ",", "__gwt_displayGlassMessage", "(", "\"", "Plugin", "failed", "to", "connect", "to", "Development", "Mode", "server", "at", "\"", "simpleEscape", "(", "$", "hosted", ")", ",", "\"", "Follow", "the", "underlying", "troubleshooting", "instructions", "\"", ");", "loadIframe", "(", "\"", "http", ":", "//", "code", ".", "google", ".", "com", "/", "p", "/", "google", "-", "web", "-", "toolkit", "/", "wiki", "/", "TroubleshootingOOPHM", "\"", ");", "}", "}", "}", "}", "function", "simpleEscape", "(", "originalString", ")", "{", "return", "originalString", ".", "replace", "(", "\"&", "\",", "\"&", "amp", ";", "\")", ".", "replace", "(", "\"<", "\",", "\"&", "lt", ";", "\")", ".", "replace", "(", "\">", "\",", "\"&", "gt", ";", "\")", ".", "replace", "(", "\"\\", "\"\"", ",\"", "&", "quot", ";", "\")", ";", "}", "window", ".", "onunload", "=", "function", "(", ")", "{", "}", ";"], "docstring_tokens": ["improper", "validation", "of", "user-supplied", "input"]}
