{"contents": ["empty"], "code_tokens": ["if", "(", "shader_rec_offset", "<", "args", "-", ">", "bin_cl_size", "|", "|", "uniforms_offset", "<", "shader_rec_offset", "|", "|</s>if", "(", "uniforms_offset", "<", "shader_rec_offset", "|", "|"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "or", "possibly", "have", "unspecified", "other", "impact"]}
{"contents": ["empty"], "code_tokens": ["hdr", "-", ">", "sadb_msg_satype", "=", "SADB_SATYPE_UNSPEC", ";</s>"], "docstring_tokens": ["obtain", "sensitive", "information", "from", "kernel", "heap", "memory"]}
{"contents": ["empty"], "code_tokens": ["memset", "(", "ptr", ",", "0", ",", "size", ")", ";", "memset", "(", "addr", ",", "0", ",", "size", ")", ";</s>if", "(", "flags", "&", "__GFP_ZERO", ")", "memset", "(", "ptr", ",", "0", ",", "size", ")", ";", "if", "(", "flags", "&", "__GFP_ZERO", ")", "memset", "(", "addr", ",", "0", ",", "size", ")", ";"], "docstring_tokens": ["obtain", "sensitive", "information", "from", "kernel", "memory"]}
{"contents": ["empty"], "code_tokens": ["check", "(", "libpam", ".", "pam_acct_mgmt", "(", "pht", ",", "0", ")", ",\"", "pam_acct_mgmt", "failed", "\"", ");</s>/", "/", "several", "different", "error", "code", "seem", "to", "be", "used", "to", "represent", "authentication", "failures", "/", "/", "check", "(", "libpam", ".", "pam_acct_mgmt", "(", "pht", ",", "0", ")", ",\"", "pam_acct_mgmt", "failed", "\"", ");"], "docstring_tokens": ["bypass", "security", "restrictions", "and", "possibly", "access", "sensitive", "information", "."]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "eclipse", ".", "jetty", ".", "util", ".", "UrlEncoded", ";", "String", "href", "=", "UrlEncoded", ".", "encodeString", "(", "contextPath", ".", "substring", "(", "1", ")", ",", "UTF_8", ")", ";", "href", "+", "=", "'", "/'", ";</s>StringBuilder", "href", "=", "new", "StringBuilder", "(", ");", "href", ".", "append", "(", "contextPath", ")", ";", "href", ".", "append", "(", "\"/", "\")", ";"], "docstring_tokens": ["obtain", "sensitive", "information"]}
{"contents": ["empty"], "code_tokens": ["static", "int", "kvm_vcpu_initialized", "(", "struct", "kvm_vcpu", "*", "vcpu", ")", "{", "return", "vcpu", "-", ">", "arch", ".", "target", ">", "=", "0", ";", "}", "if", "(", "unlikely", "(", "!", "kvm_vcpu_initialized", "(", "vcpu", ")", "))", "if", "(", "unlikely", "(", "!", "kvm_vcpu_initialized", "(", "vcpu", ")", "))", "return", "-", "ENOEXEC", ";", "if", "(", "unlikely", "(", "!", "kvm_vcpu_initialized", "(", "vcpu", ")", "))", "return", "-", "ENOEXEC", ";</s>/", "*", "Make", "sure", "they", "initialize", "the", "vcpu", "with", "KVM_ARM_VCPU_INIT", "*", "/", "if", "(", "unlikely", "(", "vcpu", "-", ">", "arch", ".", "target", "<", "0", ")", ")"], "docstring_tokens": ["the", "kernel", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["String", "variableValue", "=", "ssiMediator", ".", "getVariableValue", "(", "variableName", ",", "\"", "entity", "\"", ");", "<", "fix", ">", "Encode", "the", "output", "of", "the", "SSI", "<", "code", ">", "printenv", "<", "/", "code", ">", "command", ".", "(", "markt", ")", "<", "/", "fix", "></s>String", "variableValue", "=", "ssiMediator", ".", "getVariableValue", "(", "variableName", ")", ";"], "docstring_tokens": ["steal", "the", "victim's", "cookie-based", "authentication", "credentials"]}
{"contents": ["empty"], "code_tokens": ["*", ")", "Sanity", "check", "record", "length", "before", "skipping", "explicit", "IV", "in", "DTLS", "to", "fix", "DoS", "attack", ".", "Thanks", "to", "Codenomicon", "for", "discovering", "this", "issue", "using", "Fuzz", "-", "o", "-", "Matic", "fuzzing", "as", "a", "service", "testing", "platform", ".", "(", "CVE", "-", "2012", "-", "2333", ")", "[", "Steve", "Henson", "]", "if", "(", "i", "+", "bs", ">", "(", "int", ")", "rec", "-", ">", "length", ")</s>if", "(", "i", ">", "(", "int", ")", "rec", "-", ">", "length", ")"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(buffer", "over-read", ")", "or", "possibly", "have", "unspecified", "other", "impact"]}
{"contents": ["empty"], "code_tokens": ["xmlns", ":", "xsi", "=", "\"", "http", ":", "//", "www", ".", "w3", ".", "org", "/", "2001", "/", "XMLSchema", "-", "instance", "\"", "xsi", ":", "schemaLocation", "=", "\"", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "beans", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "beans", "/", "spring", "-", "beans", ".", "xsd", "\"", ">", "<", "web", "-", "resource", "-", "collection", ">", "<", "web", "-", "resource", "-", "name", ">", "Forbidden", "<", "/", "web", "-", "resource", "-", "name", ">", "<", "url", "-", "pattern", ">", "/*", "</", "url", "-", "pattern", ">", "<", "http", "-", "method", ">", "PUT", "<", "/", "http", "-", "method", ">", "<", "http", "-", "method", ">", "HEAD", "<", "/", "http", "-", "method", ">", "<", "http", "-", "method", ">", "PATCH", "<", "/", "http", "-", "method", ">", "<", "http", "-", "method", ">", "DELETE", "<", "/", "http", "-", "method", ">", "<", "http", "-", "method", ">", "TRACE", "<", "/", "http", "-", "method", ">", "<", "/", "web", "-", "resource", "-", "collection", ">", "<", "web", "-", "resource", "-", "collection", ">", "<", "web", "-", "resource", "-", "name", ">", "Forbidden", "<", "/", "web", "-", "resource", "-", "name", ">", "<", "url", "-", "pattern", ">", "/", "services", "/", "*<", "/", "url", "-", "pattern", ">", "<", "http", "-", "method", ">", "TRACE", "<", "/", "http", "-", "method", ">", "<", "/", "web", "-", "resource", "-", "collection", ">", "public", "static", "ServiceResult", "loginNoCheck", "(", "String", "user", ",", "String", "pass", ")", "{", "return", "sr", ";", "}", "public", "static", "ServiceResult", "login", "(", "String", "user", ",", "String", "pass", ")", "{", "ServiceResult", "sr", "=", "loginNoCheck", "(", "user", ",", "pass", ")", ";", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "*", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "*", "distributed", "with", "this", "work", "for", "additional", "information", "*", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "*", "to", "you", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ")", "+", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "*", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "*", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "*", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "*", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "*", "specific", "language", "governing", "permissions", "and", "limitations", "*", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "openmeetings", ".", "test", ".", "webservice", ";", "import", "static", "org", ".", "apache", ".", "openmeetings", ".", "db", ".", "util", ".", "ApplicationHelper", ".", "getWicketTester", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertNotNull", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Response", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "db", ".", "dto", ".", "basic", ".", "ServiceResult", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "db", ".", "dto", ".", "basic", ".", "ServiceResult", ".", "Type", ";", "import", "org", ".", "apache", ".", "openmeetings", ".", "web", ".", "app", ".", "WebSession", ";", "import", "org", ".", "apache", ".", "wicket", ".", "util", ".", "tester", ".", "WicketTester", ";", "import", "org", ".", "junit", ".", "After", ";", "import", "org", ".", "junit", ".", "Test", ";", "public", "class", "TestGroupService", "extends", "AbstractWebServiceTest", "{", "protected", "WicketTester", "tester", ";", "public", "final", "static", "String", "GROUP_SERVICE_URL", "=", "BASE_SERVICES_URL", "+", "\"", "/", "group", "\"", ";", "@", "Override", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "super", ".", "setUp", "(", ");", "tester", "=", "getWicketTester", "(", ");", "assertNotNull", "(", "\"", "Web", "session", "should", "not", "be", "null", "\"", ",", "WebSession", ".", "get", "(", "))", ";", "}", "@", "Test", "public", "void", "putTest", "(", ")", "{", "ServiceResult", "r", "=", "login", "(", ");", "Response", "resp", "=", "getClient", "(", "GROUP_SERVICE_URL", ")", ".", "path", "(", "\"/", "\")", ".", "query", "(", "\"", "sid", "\"", ",", "r", ".", "getMessage", "(", "))", ".", "put", "(", "\"\"", ");", "assertEquals", "(", "\"", "Call", "should", "NOT", "be", "successful", "\"", ",", "Response", ".", "Status", ".", "METHOD_NOT_ALLOWED", ".", "getStatusCode", "(", "),", "resp", ".", "getStatus", "(", "))", ";", "}", "@", "Test", "public", "void", "addRemoveTest", "(", ")", "{", "ServiceResult", "r", "=", "login", "(", ");", "long", "groupId", "=", "-", "1", ";", "{", "Response", "resp", "=", "getClient", "(", "GROUP_SERVICE_URL", ")", ".", "path", "(", "\"/", "\")", ".", "query", "(", "\"", "sid", "\"", ",", "r", ".", "getMessage", "(", "))", ".", "query", "(", "\"", "name", "\"", ",", "\"", "Test", "Group", "\"", ").", "post", "(", "\"\"", ");", "assertNotNull", "(", "\"", "Valid", "ServiceResult", "should", "be", "returned", "\"", ",", "resp", ")", ";", "assertEquals", "(", "\"", "Call", "should", "be", "successful", "\"", ",", "Response", ".", "Status", ".", "OK", ".", "getStatusCode", "(", "),", "resp", ".", "getStatus", "(", "))", ";", "ServiceResult", "r1", "=", "resp", ".", "readEntity", "(", "ServiceResult", ".", "class", ")", ";", "assertEquals", "(", "\"", "OM", "Call", "should", "be", "successful", "\"", ",", "r1", ".", "getType", "(", "),", "Type", ".", "SUCCESS", ".", "name", "(", "))", ";", "groupId", "=", "r1", ".", "getCode", "(", ");", "}", "/", "/", "delete", "group", "created", "{", "Response", "resp", "=", "getClient", "(", "GROUP_SERVICE_URL", ")", ".", "path", "(", "\"/", "\"", "+", "groupId", ")", ".", "query", "(", "\"", "sid", "\"", ",", "r", ".", "getMessage", "(", "))", ".", "delete", "(", ");", "assertNotNull", "(", "\"", "Valid", "ServiceResult", "should", "be", "returned", "\"", ",", "resp", ")", ";", "assertEquals", "(", "\"", "Call", "should", "be", "successful", "\"", ",", "Response", ".", "Status", ".", "OK", ".", "getStatusCode", "(", "),", "resp", ".", "getStatus", "(", "))", ";", "ServiceResult", "r1", "=", "resp", ".", "readEntity", "(", "ServiceResult", ".", "class", ")", ";", "assertEquals", "(", "\"", "OM", "Call", "should", "be", "successful", "\"", ",", "r1", ".", "getType", "(", "),", "Type", ".", "SUCCESS", ".", "name", "(", "))", ";", "}", "}", "@", "After", "public", "void", "tearDown", "(", ")", "{", "if", "(", "tester", "!", "=", "null", ")", "{", "/", "/", "can", "be", "null", "in", "case", "exception", "on", "initialization", "tester", ".", "destroy", "(", ");", "}", "}", "}", "@", "@", "-", "46", ",", "6", "+", "46", ",", "13", "@", "@", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "@", "Test", "public", "void", "invalidLoginTest", "(", ")", "{", "ServiceResult", "r", "=", "loginNoCheck", "(", "\"", "invalid", "-", "user", "\"", ",", "\"", "bad", "pass", "\"", ");", "assertNotNull", "(", "\"", "Valid", "ServiceResult", "should", "be", "returned", "\"", ",", "r", ")", ";", "assertEquals", "(", "\"", "Login", "should", "NOT", "be", "successful", "\"", ",", "Type", ".", "ERROR", ".", "name", "(", "),", "r", ".", "getType", "(", "))", ";", "}</s>-", "->", "xmlns", ":", "xsi", "=", "\"", "http", ":", "//", "www", ".", "w3", ".", "org", "/", "2001", "/", "XMLSchema", "-", "instance", "\"", "xsi", ":", "schemaLocation", "=", "\"", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "beans", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "beans", "/", "spring", "-", "beans", ".", "xsd", "\"", ">", "public", "static", "ServiceResult", "login", "(", "String", "user", ",", "String", "pass", ")", "{"], "docstring_tokens": ["gain", "access", "to", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "springframework", ".", "expression", ".", "spel", ".", "support", ".", "SimpleEvaluationContext", ";", "EvaluationContext", "context", "=", "SimpleEvaluationContext", "/", "/", ".", "forPropertyAccessors", "(", "new", "PropertyTraversingMapAccessor", "(", "type", ",", "conversionService", ")", ")", "/", "/", ".", "withConversionService", "(", "conversionService", ")", "/", "/", ".", "withRootObject", "(", "map", ")", "/", "/", ".", "build", "(", ");", "Expression", "expression", "=", "PARSER", ".", "parseExpression", "(", "propertyName", ")", ";</s>import", "org", ".", "springframework", ".", "expression", ".", "spel", ".", "SpelMessage", ";", "import", "org", ".", "springframework", ".", "expression", ".", "spel", ".", "support", ".", "StandardEvaluationContext", ";", "import", "org", ".", "springframework", ".", "expression", ".", "spel", ".", "support", ".", "StandardTypeConverter", ";", "StandardEvaluationContext", "context", "=", "new", "StandardEvaluationContext", "(", ");", "context", ".", "addPropertyAccessor", "(", "new", "PropertyTraversingMapAccessor", "(", "type", ",", "conversionService", ")", ");", "context", ".", "setTypeConverter", "(", "new", "StandardTypeConverter", "(", "conversionService", ")", ");", "context", ".", "setTypeLocator", "(", "typeName", "-", ">", "{", "throw", "new", "SpelEvaluationException", "(", "SpelMessage", ".", "TYPE_NOT_FOUND", ",", "typeName", ")", ";", "}", ");", "context", ".", "setRootObject", "(", "map", ")", ";", "Expression", "expression", "=", "PARSER", ".", "parseExpression", "(", "propertyName", ")", ";"], "docstring_tokens": ["execute", "arbitrary", "code", "on", "Ignite", "nodes"]}
{"contents": ["empty"], "code_tokens": ["static", "inline", "bool", "is_nmi", "(", "u32", "intr_info", ")", "=", "=", "(", "INTR_TYPE_NMI_INTR", "|", "INTR_INFO_VALID_MASK", ")", ";", "if", "(", "is_nmi", "(", "intr_info", ")", ")", "if", "(", "is_nmi", "(", "intr_info", ")", ")", "if", "(", "is_nmi", "(", "exit_intr_info", ")", ")", "{</s>static", "inline", "bool", "is_exception", "(", "u32", "intr_info", ")", "=", "=", "(", "INTR_TYPE_HARD_EXCEPTION", "|", "INTR_INFO_VALID_MASK", ")", ";", "if", "(", "(", "intr_info", "&", "INTR_INFO_INTR_TYPE_MASK", ")", "=", "=", "INTR_TYPE_NMI_INTR", ")", "if", "(", "!", "is_exception", "(", "intr_info", ")", ")", "if", "(", "(", "exit_intr_info", "&", "INTR_INFO_INTR_TYPE_MASK", ")", "=", "=", "INTR_TYPE_NMI_INTR", "&", "&", "(", "exit_intr_info", "&", "INTR_INFO_VALID_MASK", ")", ")", "{"], "docstring_tokens": ["the", "application", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "!", "save_pgd", ")", "return", "EFI_ABORTED", ";", "return", "efi_mm", ".", "pgd", ";", "if", "(", "!", "save_pgd", ")", "return", "NULL", ";", "out", ":", "efi_call_phys_epilog", "(", "save_pgd", ")", ";", "return", "NULL", ";</s>return", "NULL", ";", "out", ":"], "docstring_tokens": ["a", "denial", "of", "service", "condition"]}
{"contents": ["empty"], "code_tokens": ["import", "java", ".", "util", ".", "ArrayList", ";", "ArrayList", "<", "Resource", ">", "locationResources", "=", "new", "ArrayList", "<", ">(", ");", "for", "(", "int", "i", "=", "locations", ".", "length", ";", "i", "-", "-", ">", "0", ";", ")", "{", "String", "location", "=", "locations", "[", "i", "]", ";", "if", "(", "!", "PathUtils", ".", "isInvalidEncodedLocation", "(", "location", ")", ")", "{", "locationResources", ".", "add", "(", "this", ".", "resourceLoader", ".", "getResource", "(", "location", ")", ");", "}", "}", "for", "(", "Resource", "location", ":", "locationResources", ")", "{", "Resource", "file", "=", "location", ".", "createRelative", "(", "local", ")", ";", "if", "(", "file", ".", "exists", "(", ")", "&", "&", "file", ".", "isReadable", "(", ")", "&", "&", "PathUtils", ".", "checkResource", "(", "file", ",", "location", ",", "locationResources", ")", ")", "{", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "List", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "ClassPathResource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "Resource", ";", "import", "org", ".", "springframework", ".", "core", ".", "io", ".", "UrlResource", ";", "/", "**", "*", "Perform", "additional", "checks", "on", "a", "resolved", "resource", "beyond", "checking", "whether", "the", "*", "resources", "exists", "and", "is", "readable", ".", "The", "default", "implementation", "also", "verifies", "the", "*", "resource", "is", "either", "under", "the", "location", "relative", "to", "which", "it", "was", "found", "or", "is", "under", "*", "one", "of", "the", "{", "@", "link", "#", "setAllowedLocations", "allowed", "locations", "}", ".", "*", "@", "param", "resource", "the", "resource", "to", "check", "*", "@", "param", "location", "the", "location", "relative", "to", "which", "the", "resource", "was", "found", "*", "@", "param", "allowedLocations", "set", "of", "allowed", "locations", "*", "@", "return", "\"", "true", "\"", "if", "resource", "is", "in", "a", "valid", "location", ",", "\"", "false", "\"", "otherwise", ".", "*", "@", "throws", "IOException", "if", "Resource", "URLS", "fail", "to", "parse", ".", "*", "@", "since", "4", ".", "1", ".", "2", "*", "/", "public", "static", "boolean", "checkResource", "(", "Resource", "resource", ",", "Resource", "location", ",", "List", "<", "Resource", ">", "allowedLocations", ")", "throws", "IOException", "{", "if", "(", "isResourceUnderLocation", "(", "resource", ",", "location", ")", ")", "{", "return", "true", ";", "}", "if", "(", "allowedLocations", "!", "=", "null", ")", "{", "for", "(", "Resource", "current", ":", "allowedLocations", ")", "{", "if", "(", "isResourceUnderLocation", "(", "resource", ",", "current", ")", ")", "{", "return", "true", ";", "}", "}", "}", "if", "(", "logger", ".", "isWarnEnabled", "(", "))", "{", "logger", ".", "warn", "(", "\"", "Resource", "path", "\\", "\"\"", "+", "location", ".", "getURI", "(", ")", "+", "\"", "\\\"", "was", "successfully", "resolved", "\"", "+", "\"", "but", "resource", "\\", "\"\"", "+", "resource", ".", "getURL", "(", ")", "+", "\"", "\\\"", "is", "neither", "under", "the", "\"", "+", "\"", "current", "location", "\\", "\"\"", "+", "location", ".", "getURL", "(", ")", "+", "\"", "\\\"", "nor", "under", "any", "of", "the", "\"", "+", "\"", "allowed", "locations", "\"", "+", "(", "allowedLocations", "!", "=", "null", "?", "allowedLocations", ":", "\"", "[]", "\")", ");", "}", "return", "false", ";", "}", "private", "static", "boolean", "isResourceUnderLocation", "(", "Resource", "resource", ",", "Resource", "location", ")", "throws", "IOException", "{", "if", "(", "resource", ".", "getClass", "(", ")", "!", "=", "location", ".", "getClass", "(", "))", "{", "return", "false", ";", "}", "String", "resourcePath", ";", "String", "locationPath", ";", "if", "(", "resource", "instanceof", "UrlResource", ")", "{", "resourcePath", "=", "resource", ".", "getURL", "(", ").", "toExternalForm", "(", ");", "locationPath", "=", "StringUtils", ".", "cleanPath", "(", "location", ".", "getURL", "(", ").", "toString", "(", "))", ";", "}", "else", "if", "(", "resource", "instanceof", "ClassPathResource", ")", "{", "resourcePath", "=", "(", "(", "ClassPathResource", ")", "resource", ")", ".", "getPath", "(", ");", "locationPath", "=", "StringUtils", ".", "cleanPath", "(", "((", "ClassPathResource", ")", "location", ")", ".", "getPath", "(", "))", ";", "}", "else", "{", "resourcePath", "=", "resource", ".", "getURL", "(", ").", "getPath", "(", ");", "locationPath", "=", "StringUtils", ".", "cleanPath", "(", "location", ".", "getURL", "(", ").", "getPath", "(", "))", ";", "}", "if", "(", "locationPath", ".", "equals", "(", "resourcePath", ")", ")", "{", "return", "true", ";", "}", "locationPath", "=", "(", "locationPath", ".", "endsWith", "(", "\"/", "\")", "|", "|", "locationPath", ".", "isEmpty", "(", ")", "?", "locationPath", ":", "locationPath", "+", "\"", "/\"", ");", "return", "(", "resourcePath", ".", "startsWith", "(", "locationPath", ")", "&", "&", "!", "isInvalidEncodedPath", "(", "resourcePath", ")", ");", "}", "@", "Test", "public", "void", "invalidPathEncodedSlash", "(", ")", "{", "String", "file", "=", "System", ".", "getProperty", "(", "\"", "user", ".", "dir", "\"", ");", "file", "=", "file", ".", "replaceFirst", "(", "\"\\", "\\/", "\",", "\"", "%", "2f", "\"", ");", "file", "+", "=", "\"", "/", "src", "/", "test", "/", "resources", "/", "ssh", "/", "key", "\"", ";", "this", ".", "exception", ".", "expect", "(", "NoSuchResourceException", ".", "class", ")", ";", "this", ".", "nativeRepository", ".", "setSearchLocations", "(", "\"", "file", ":", "./", "\")", ";", "this", ".", "output", ".", "expect", "(", "containsString", "(", "\"", "is", "neither", "under", "the", "current", "location", "\"", "))", ";", "this", ".", "repository", ".", "findOne", "(", "\"", "blah", "\"", ",", "\"", "local", "\"", ",", "\"", "master", "\"", ",", "file", ")", ";", "}</s>for", "(", "int", "i", "=", "locations", ".", "length", ";", "i", "-", "-", ">", "0", ";", ")", "{", "String", "location", "=", "locations", "[", "i", "]", ";", "if", "(", "PathUtils", ".", "isInvalidEncodedLocation", "(", "location", ")", ")", "{", "continue", ";", "}", "Resource", "file", "=", "this", ".", "resourceLoader", ".", "getResource", "(", "location", ")", ".", "createRelative", "(", "local", ")", ";", "if", "(", "file", ".", "exists", "(", ")", "&", "&", "file", ".", "isReadable", "(", "))", "{"], "docstring_tokens": ["serve", "arbitrary", "configuration", "files"]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "apache", ".", "hadoop", ".", "hive", ".", "ql", ".", "exec", ".", "FunctionRegistry", ";", "FunctionRegistry", ".", "setupPermissionsForBuiltinUDFs", "(", "\"\"", ",", "HiveAuthzConf", ".", "HIVE_UDF_BLACK_LIST", ")", ";", "public", "static", "final", "String", "HIVE_UDF_WHITE_LIST", "=", "\"", "concat", ",", "substr", ",", "substring", ",", "space", ",", "repeat", ",", "ascii", ",", "lpad", ",", "rpad", ",", "size", ",", "round", ",", "floor", ",", "sqrt", ",", "ceil", ",", "\"", "\"", "ceiling", ",", "rand", ",", "abs", ",", "pmod", ",", "ln", ",", "log2", ",", "sin", ",", "asin", ",", "cos", ",", "acos", ",", "log10", ",", "log", ",", "exp", ",", "power", ",", "pow", ",", "sign", ",", "pi", ",", "\"", "\"", "degrees", ",", "radians", ",", "atan", ",", "tan", ",", "e", ",", "conv", ",", "bin", ",", "hex", ",", "unhex", ",", "base64", ",", "unbase64", ",", "encode", ",", "decode", ",", "upper", ",", "\"", "\"", "lower", ",", "ucase", ",", "lcase", ",", "trim", ",", "ltrim", ",", "rtrim", ",", "length", ",", "reverse", ",", "field", ",", "find_in_set", ",", "initcap", ",", "like", ",", "\"", "\"", "rlike", ",", "regexp", ",", "regexp_replace", ",", "regexp_extract", ",", "parse_url", ",", "nvl", ",", "split", ",", "str_to_map", ",", "translate", "\"", "\"", ",", "positive", ",", "negative", ",", "day", ",", "dayofmonth", ",", "month", ",", "year", ",", "hour", ",", "minute", ",", "second", ",", "from_unixtime", ",", "\"", "\"", "to_date", ",", "weekofyear", ",", "last_day", ",", "date_add", ",", "date_sub", ",", "datediff", ",", "add_months", ",", "get_json_object", ",", "\"", "\"", "xpath_string", ",", "xpath_boolean", ",", "xpath_number", ",", "xpath_double", ",", "xpath_float", ",", "xpath_long", ",", "\"", "\"", "xpath_int", ",", "xpath_short", ",", "xpath", ",", "+,", "-,", "*,", "/,", "%,", "div", ",", "&,", "|,", "^,", "~,", "current_database", ",", "isnull", ",", "\"", "\"", "isnotnull", ",", "if", ",", "in", ",", "and", ",", "or", ",", "=,", "==", ",<", "=>", ",!", "=,", "<>", ",<", ",<", "=,", ">,", ">=", ",", "not", ",", "!,", "between", ",", "ewah_bitmap_and", ",", "\"", "\"", "ewah_bitmap_or", ",", "ewah_bitmap_empty", ",", "boolean", ",", "tinyint", ",", "smallint", ",", "int", ",", "bigint", ",", "float", ",", "double", ",", "\"", "\"", "string", ",", "date", ",", "timestamp", ",", "binary", ",", "decimal", ",", "varchar", ",", "char", ",", "max", ",", "min", ",", "sum", ",", "count", ",", "avg", ",", "std", ",", "stddev", ",", "\"", "\"", "stddev_pop", ",", "stddev_samp", ",", "variance", ",", "var_pop", ",", "var_samp", ",", "covar_pop", ",", "covar_samp", ",", "corr", ",", "\"", "\"", "histogram_numeric", ",", "percentile_approx", ",", "collect_set", ",", "collect_list", ",", "ngrams", ",", "\"", "\"", "context_ngrams", ",", "ewah_bitmap", ",", "compute_stats", ",", "percentile", ",", "\"", "\"", "array", ",", "assert_true", ",", "map", ",", "struct", ",", "named_struct", ",", "create_union", ",", "case", ",", "when", ",", "hash", ",", "coalesce", ",", "\"", "\"", "index", ",", "in_file", ",", "instr", ",", "locate", ",", "elt", ",", "concat_ws", ",", "sort_array", ",", "\"", "\"", "array_contains", ",", "sentences", ",", "map_keys", ",", "map_values", ",", "format_number", ",", "printf", ",", "greatest", ",", "least", ",", "\"", "\"", "from_utc_timestamp", ",", "to_utc_timestamp", ",", "unix_timestamp", ",", "to_unix_timestamp", ",", "explode", ",", "\"", "\"", "inline", ",", "json_tuple", ",", "parse_url_tuple", ",", "posexplode", ",", "stack", ",", "lead", ",", "lag", ",", "row_number", ",", "rank", ",", "\"", "\"", "dense_rank", ",", "percent_rank", ",", "cume_dist", ",", "ntile", ",", "first_value", ",", "last_value", ",", "noop", ",", "noopwithmap", ",", "\"", "\"", "noopstreaming", ",", "noopwithmapstreaming", ",", "windowingtablefunction", ",", "matchpath", "\"", ";", "public", "static", "final", "String", "HIVE_UDF_BLACK_LIST", "=", "\"", "reflect", ",", "reflect2", ",", "java_method", "\"", ";", "AuthzConfVars", ".", "SENTRY_TESTING_MODE", ",</s>AUTHZ_UDF_WHITELIST", "(", "\"", "sentry", ".", "hive", ".", "udf", ".", "whitelist", "\"", ",", "HIVE_UDF_WHITE_LIST", ")", ",", "AUTHZ_UDF_WHITELIST_DEPRECATED", "(", "\"", "hive", ".", "sentry", ".", "udf", ".", "whitelist", "\"", ",", "HIVE_UDF_WHITE_LIST", ")", ",", "private", "static", "final", "String", "HIVE_UDF_WHITE_LIST", "=", "\"", "date", ",", "decimal", ",", "timestamp", ",", "\"", "+", "/", "/", "SENTRY", "-", "312", "\"", "abs", ",", "acos", ",", "and", ",", "array", ",", "array_contains", ",", "ascii", ",", "asin", ",", "assert_true", ",", "atan", ",", "avg", ",", "\"", "+", "\"", "between", ",", "bin", ",", "case", ",", "cast", ",", "ceil", ",", "ceiling", ",", "coalesce", ",", "collect_list", ",", "collect_set", ",", "compute_stats", ",", "concat", ",", "concat_ws", ",", "\"", "+", "\"", "UDFConv", ",", "UDFHex", ",", "UDFSign", ",", "UDFToBoolean", ",", "UDFToByte", ",", "UDFToDouble", ",", "UDFToFloat", ",", "UDFToInteger", ",", "UDFToLong", ",", "UDFToShort", ",", "UDFToString", ",", "\"", "+", "\"", "context_ngrams", ",", "conv", ",", "corr", ",", "cos", ",", "count", ",", "covar_pop", ",", "covar_samp", ",", "create_union", ",", "date_add", ",", "date_sub", ",", "\"", "+", "\"", "datediff", ",", "day", ",", "dayofmonth", ",", "degrees", ",", "div", ",", "e", ",", "elt", ",", "ewah_bitmap", ",", "ewah_bitmap_and", ",", "ewah_bitmap_empty", ",", "\"", "+", "\"", "ewah_bitmap_or", ",", "exp", ",", "explode", ",", "field", ",", "find_in_set", ",", "floor", ",", "format_number", ",", "from_unixtime", ",", "\"", "+", "\"", "from_utc_timestamp", ",", "get_json_object", ",", "hash", ",", "hex", ",", "histogram_numeric", ",", "hour", ",", "if", ",", "in", ",", "in_file", ",", "index", ",", "\"", "+", "\"", "inline", ",", "instr", ",", "isnotnull", ",", "isnull", ",", "\"", "+", "/", "/", "java_method", "is", "skipped", "\"", "json_tuple", ",", "lcase", ",", "length", ",", "like", ",", "ln", ",", "locate", ",", "log", ",", "\"", "+", "\"", "log10", ",", "log2", ",", "lower", ",", "lpad", ",", "ltrim", ",", "map", ",", "map_keys", ",", "map_values", ",", "max", ",", "min", ",", "\"", "+", "\"", "minute", ",", "month", ",", "named_struct", ",", "negative", ",", "ngrams", ",", "not", ",", "or", ",", "parse_url", ",", "parse_url_tuple", ",", "percentile", ",", "\"", "+", "\"", "percentile_approx", ",", "pi", ",", "pmod", ",", "posexplode", ",", "positive", ",", "pow", ",", "power", ",", "printf", ",", "radians", ",", "rand", ",", "\"", "+", "/", "/", "reflect", "is", "skipped", "\"", "regexp", ",", "regexp_extract", ",", "regexp_replace", ",", "repeat", ",", "reverse", ",", "rlike", ",", "round", ",", "rpad", ",", "rtrim", ",", "second", ",", "\"", "+", "\"", "sentences", ",", "sign", ",", "sin", ",", "size", ",", "sort_array", ",", "space", ",", "split", ",", "sqrt", ",", "stack", ",", "std", ",", "\"", "+", "\"", "stddev", ",", "stddev_pop", ",", "stddev_samp", ",", "str_to_map", ",", "struct", ",", "substr", ",", "substring", ",", "sum", ",", "tan", ",", "to_date", ",", "\"", "+", "\"", "to_utc_timestamp", ",", "translate", ",", "trim", ",", "ucase", ",", "unhex", ",", "union_map", ",", "unix_timestamp", ",", "upper", ",", "var_pop", ",", "var_samp", ",", "\"", "+", "\"", "variance", ",", "weekofyear", ",", "when", ",", "xpath", ",", "xpath_boolean", ",", "xpath_double", ",", "xpath_float", ",", "xpath_int", ",", "xpath_long", ",", "\"", "+", "\"", "xpath_number", ",", "xpath_short", ",", "xpath_string", ",", "year", ",", "base64", ",", "cume_dist", ",", "decode", ",", "dense_rank", ",", "first_value", ",", "\"", "+", "\"", "lag", ",", "last_value", ",", "lead", ",", "noop", ",", "noopwithmap", ",", "ntile", ",", "nvl", ",", "percent_rank", ",", "rank", ",", "to_unix_timestamp", ",", "\"", "+", "\"", "current_database", ",", "char", ",", "varchar", ",", "matchpath", ",", "row_number", ",", "unbase64", ",", "windowingtablefunction", "\"", ";", "currentToDeprecatedProps", ".", "put", "(", "AuthzConfVars", ".", "AUTHZ_UDF_WHITELIST", ".", "getVar", "(", "),", "AuthzConfVars", ".", "AUTHZ_UDF_WHITELIST_DEPRECATED", ")", ";", "AuthzConfVars", ".", "SENTRY_TESTING_MODE", ",", "AuthzConfVars", ".", "AUTHZ_UDF_WHITELIST", ",", "properties", ".", "put", "(", "ConfVars", ".", "HIVE_SERVER2_BUILTIN_UDF_BLACKLIST", ".", "varname", ",", "\"", "reflect", ",", "reflect2", ",", "java_method", "\"", ");"], "docstring_tokens": ["explicitly", "configure", "the", "blacklist", "functions", "in", "the", "hive", "configuration"]}
{"contents": ["empty"], "code_tokens": ["stream", ".", "inputBuffer", ".", "readTimeout", "=", "Timeout", "waiting", "to", "read", "data", "from", "client", "inBuffer", ".", "wait", "(", "handler", ".", "getProtocol", "(", ").", "getStreamReadTimeout", "(", "))", ";", "if", "(", "inBuffer", ".", "position", "(", ")", "=", "=", "0", ")", "{", "String", "msg", "=", "sm", ".", "getString", "(", "\"", "stream", ".", "inputBuffer", ".", "readTimeout", "\"", ");", "StreamException", "se", "=", "new", "StreamException", "(", "msg", ",", "Http2Error", ".", "ENHANCE_YOUR_CALM", ",", "getIdAsInt", "(", "))", ";", "/", "/", "Trigger", "a", "reset", "once", "control", "returns", "to", "Tomcat", "coyoteResponse", ".", "setError", "(", ");", "streamOutputBuffer", ".", "reset", "=", "se", ";", "throw", "new", "CloseNowException", "(", "msg", ",", "se", ")", ";", "}", "import", "java", ".", "util", ".", "Map", ";", "protected", "void", "sendParameterPostRequest", "(", "int", "streamId", ",", "byte", "[", "]", "padding", ",", "String", "body", ",", "long", "contentLength", ",", "boolean", "useExpectation", ")", "throws", "IOException", "{", "byte", "[", "]", "headersFrameHeader", "=", "new", "byte", "[", "9", "]", ";", "ByteBuffer", "headersPayload", "=", "ByteBuffer", ".", "allocate", "(", "128", ")", ";", "byte", "[", "]", "dataFrameHeader", "=", "new", "byte", "[", "9", "]", ";", "ByteBuffer", "dataPayload", "=", "ByteBuffer", ".", "allocate", "(", "128", ")", ";", "buildPostRequest", "(", "headersFrameHeader", ",", "headersPayload", ",", "useExpectation", ",", "\"", "application", "/", "x", "-", "www", "-", "form", "-", "urlencoded", "\"", ",", "contentLength", ",", "\"", "/", "parameter", "\"", ",", "dataFrameHeader", ",", "dataPayload", ",", "padding", ",", "null", ",", "null", ",", "streamId", ")", ";", "writeFrame", "(", "headersFrameHeader", ",", "headersPayload", ")", ";", "if", "(", "body", "!", "=", "null", ")", "{", "dataPayload", ".", "put", "(", "body", ".", "getBytes", "(", "StandardCharsets", ".", "ISO_8859_1", ")", ");", "writeFrame", "(", "dataFrameHeader", ",", "dataPayload", ")", ";", "}", "}", "buildPostRequest", "(", "headersFrameHeader", ",", "headersPayload", ",", "useExpectation", ",", "null", ",", "-", "1", ",", "\"", "/", "simple", "\"", ",", "dataFrameHeader", ",", "dataPayload", ",", "padding", ",", "trailersFrameHeader", ",", "trailersPayload", ",", "streamId", ")", ";", "}", "protected", "void", "buildPostRequest", "(", "byte", "[", "]", "headersFrameHeader", ",", "ByteBuffer", "headersPayload", ",", "boolean", "useExpectation", ",", "String", "contentType", ",", "long", "contentLength", ",", "String", "path", ",", "byte", "[", "]", "dataFrameHeader", ",", "ByteBuffer", "dataPayload", ",", "byte", "[", "]", "padding", ",", "byte", "[", "]", "trailersFrameHeader", ",", "ByteBuffer", "trailersPayload", ",", "int", "streamId", ")", "{", "headers", ".", "addValue", "(", "\":", "path", "\"", ").", "setString", "(", "path", ")", ";", "if", "(", "contentType", "!", "=", "null", ")", "{", "headers", ".", "addValue", "(", "\"", "content", "-", "type", "\"", ").", "setString", "(", "contentType", ")", ";", "}", "if", "(", "contentLength", ">", "-", "1", ")", "{", "headers", ".", "addValue", "(", "\"", "content", "-", "length", "\"", ").", "setLong", "(", "contentLength", ")", ";", "}", "Tomcat", ".", "addServlet", "(", "ctxt", ",", "\"", "parameter", "\"", ",", "new", "ParameterServlet", "(", "))", ";", "ctxt", ".", "addServletMappingDecoded", "(", "\"/", "parameter", "\"", ",", "\"", "parameter", "\"", ");", "static", "class", "ParameterServlet", "extends", "HttpServlet", "{", "private", "static", "final", "long", "serialVersionUID", "=", "1L", ";", "@", "Override", "protected", "void", "doPost", "(", "HttpServletRequest", "req", ",", "HttpServletResponse", "resp", ")", "throws", "ServletException", ",", "IOException", "{", "Map", "<", "String", ",", "String", "[", "]>", "params", "=", "req", ".", "getParameterMap", "(", ");", "resp", ".", "setContentType", "(", "\"", "text", "/", "plain", "\"", ");", "resp", ".", "setCharacterEncoding", "(", "\"", "UTF", "-", "8", "\"", ");", "resp", ".", "getWriter", "(", ").", "print", "(", "params", ".", "size", "(", "))", ";", "}", "}", "sendSettings", "(", "0", ",", "false", ",", "new", "SettingValue", "(", "Setting", ".", "INITIAL_WINDOW_SIZE", ".", "getId", "(", "),", "0", ")", ");", "sendSettings", "(", "0", ",", "false", ",", "new", "SettingValue", "(", "Setting", ".", "INITIAL_WINDOW_SIZE", ".", "getId", "(", "),", "0", ")", ");", "/", "*", "*", "Timeout", "with", "app", "reading", "request", "body", "directly", ".", "*", "/", "@", "Test", "public", "void", "testClientPostsNoBody", "(", ")", "throws", "Exception", "{", "sendSimplePostRequest", "(", "3", ",", "null", ",", "false", ")", ";", "/", "/", "Headers", "parser", ".", "readFrame", "(", "false", ")", ";", "output", ".", "clearTrace", "(", ");", "parser", ".", "readFrame", "(", "false", ")", ";", "Assert", ".", "assertEquals", "(", "\"", "3", "-", "RST", "-", "[", "11", "]", "\\", "n", "\"", ",", "output", ".", "getTrace", "(", "))", ";", "}", "/", "*", "*", "Timeout", "with", "app", "processing", "parameters", ".", "*", "/", "@", "Test", "public", "void", "testClientPostsNoParameters", "(", ")", "throws", "Exception", "{", "sendParameterPostRequest", "(", "3", ",", "null", ",", "null", ",", "10", ",", "false", ")", ";", "/", "/", "Headers", "parser", ".", "readFrame", "(", "false", ")", ";", "output", ".", "clearTrace", "(", ");", "parser", ".", "readFrame", "(", "false", ")", ";", "Assert", ".", "assertEquals", "(", "\"", "3", "-", "RST", "-", "[", "11", "]", "\\", "n", "\"", ",", "output", ".", "getTrace", "(", "))", ";", "}</s>inBuffer", ".", "wait", "(", ");", "headers", ".", "addValue", "(", "\":", "path", "\"", ").", "setString", "(", "\"/", "simple", "\"", ");", "sendSettings", "(", "0", ",", "false", ",", "new", "SettingValue", "(", "Setting", ".", "INITIAL_WINDOW_SIZE", ".", "getId", "(", "),", "0", ")", ");"], "docstring_tokens": ["a", "denial", "of", "service"]}
{"contents": ["empty"], "code_tokens": ["bool", "sctp_verify_asconf", "(", "const", "struct", "sctp_association", "*", "asoc", ",", "struct", "sctp_chunk", "*", "chunk", ",", "bool", "addr_param_needed", ",", "struct", "sctp_paramhdr", "*", "*", "errp", ")", ";", "/", "*", "Verify", "the", "ASCONF", "packet", "before", "we", "process", "it", ".", "*", "/", "bool", "sctp_verify_asconf", "(", "const", "struct", "sctp_association", "*", "asoc", ",", "struct", "sctp_chunk", "*", "chunk", ",", "bool", "addr_param_needed", ",", "struct", "sctp_paramhdr", "*", "*", "errp", ")", "{", "sctp_addip_chunk_t", "*", "addip", "=", "(", "sctp_addip_chunk_t", "*", ")", "chunk", "-", ">", "chunk_hdr", ";", "bool", "addr_param_seen", "=", "false", ";", "sctp_walk_params", "(", "param", ",", "addip", ",", "addip_hdr", ".", "params", ")", "{", "size_t", "length", "=", "ntohs", "(", "param", ".", "p", "-", ">", "length", ")", ";", "*", "errp", "=", "param", ".", "p", ";", "case", "SCTP_PARAM_ERR_CAUSE", ":", "break", ";", "case", "SCTP_PARAM_IPV4_ADDRESS", ":", "if", "(", "length", "!", "=", "sizeof", "(", "sctp_ipv4addr_param_t", ")", ")", "return", "false", ";", "addr_param_seen", "=", "true", ";", "break", ";", "case", "SCTP_PARAM_IPV6_ADDRESS", ":", "if", "(", "length", "!", "=", "sizeof", "(", "sctp_ipv6addr_param_t", ")", ")", "return", "false", ";", "addr_param_seen", "=", "true", ";", "break", ";", "/", "*", "In", "ASCONF", "chunks", ",", "these", "need", "to", "be", "first", ".", "*", "/", "if", "(", "addr_param_needed", "&", "&", "!", "addr_param_seen", ")", "return", "false", ";", "length", "=", "ntohs", "(", "param", ".", "addip", "-", ">", "param_hdr", ".", "length", ")", ";", "if", "(", "length", "<", "sizeof", "(", "sctp_addip_param_t", ")", "sizeof", "(", "sctp_paramhdr_t", ")", ")", "return", "false", ";", "return", "false", ";", "/", "*", "This", "is", "unkown", "to", "us", ",", "reject", "!", "*", "/", "return", "false", ";", "/", "*", "Remaining", "sanity", "checks", ".", "*", "/", "if", "(", "addr_param_needed", "&", "&", "!", "addr_param_seen", ")", "return", "false", ";", "if", "(", "!", "addr_param_needed", "&", "&", "addr_param_seen", ")", "return", "false", ";", "if", "(", "param", ".", "v", "!", "=", "chunk", "-", ">", "chunk_end", ")", "return", "false", ";", "return", "true", ";", "sctp_addip_chunk_t", "*", "addip", "=", "(", "sctp_addip_chunk_t", "*", ")", "asconf", "-", ">", "chunk_hdr", ";", "bool", "all_param_pass", "=", "true", ";", "union", "sctp_params", "param", ";", "sctp_walk_params", "(", "param", ",", "addip", ",", "addip_hdr", ".", "params", ")", "{", "/", "*", "Skip", "preceeding", "address", "parameters", ".", "*", "/", "if", "(", "param", ".", "p", "-", ">", "type", "=", "=", "SCTP_PARAM_IPV4_ADDRESS", "|", "|", "param", ".", "p", "-", ">", "type", "=", "=", "SCTP_PARAM_IPV6_ADDRESS", ")", "continue", ";", "param", ".", "addip", ")", ";", "if", "(", "err_code", "!", "=", "SCTP_ERROR_NO_ERROR", ")", "all_param_pass", "=", "false", ";", "sctp_add_asconf_response", "(", "asconf_ack", ",", "param", ".", "addip", "-", ">", "crr_id", ",", "err_code", ",", "param", ".", "addip", ")", ";", "if", "(", "err_code", "=", "=", "SCTP_ERROR_RSRC_LOW", ")", "if", "(", "!", "sctp_verify_asconf", "(", "asoc", ",", "chunk", ",", "true", ",", "&", "err_param", ")", ")", "if", "(", "!", "sctp_verify_asconf", "(", "asoc", ",", "asconf_ack", ",", "false", ",", "&", "err_param", ")", ")</s>int", "sctp_verify_asconf", "(", "const", "struct", "sctp_association", "*", "asoc", ",", "struct", "sctp_paramhdr", "*", "param_hdr", ",", "void", "*", "chunk_end", ",", "struct", "sctp_paramhdr", "*", "*", "errp", ")", ";", "/", "*", "Verify", "the", "ASCONF", "packet", "before", "we", "process", "it", ".", "*", "/", "int", "sctp_verify_asconf", "(", "const", "struct", "sctp_association", "*", "asoc", ",", "struct", "sctp_paramhdr", "*", "param_hdr", ",", "void", "*", "chunk_end", ",", "struct", "sctp_paramhdr", "*", "*", "errp", ")", "{", "sctp_addip_param_t", "*", "asconf_param", ";", "int", "length", ",", "plen", ";", "param", ".", "v", "=", "(", "sctp_paramhdr_t", "*", ")", "param_hdr", ";", "while", "(", "param", ".", "v", "<", "=", "chunk_end", "-", "sizeof", "(", "sctp_paramhdr_t", ")", ")", "{", "length", "=", "ntohs", "(", "param", ".", "p", "-", ">", "length", ")", ";", "*", "errp", "=", "param", ".", "p", ";", "if", "(", "param", ".", "v", ">", "chunk_end", "-", "length", "|", "|", "length", "<", "sizeof", "(", "sctp_paramhdr_t", ")", ")", "return", "0", ";", "asconf_param", "=", "(", "sctp_addip_param_t", "*", ")", "param", ".", "v", ";", "plen", "=", "ntohs", "(", "asconf_param", "-", ">", "param_hdr", ".", "length", ")", ";", "if", "(", "plen", "<", "sizeof", "(", "sctp_addip_param_t", ")", "+", "sizeof", "(", "sctp_paramhdr_t", ")", ")", "return", "0", ";", "return", "0", ";", "break", ";", "param", ".", "v", "+", "=", "WORD_ROUND", "(", "length", ")", ";", "if", "(", "param", ".", "v", "!", "=", "chunk_end", ")", "return", "0", ";", "return", "1", ";", "int", "all_param_pass", "=", "1", ";", "while", "(", "chunk_len", ">", "0", ")", "{", "asconf_param", ")", ";", "if", "(", "SCTP_ERROR_NO_ERROR", "!", "=", "err_code", ")", "all_param_pass", "=", "0", ";", "sctp_add_asconf_response", "(", "asconf_ack", ",", "asconf_param", "-", ">", "crr_id", ",", "err_code", ",", "asconf_param", ")", ";", "if", "(", "SCTP_ERROR_RSRC_LOW", "=", "=", "err_code", ")", "/", "*", "Move", "to", "the", "next", "ASCONF", "param", ".", "*", "/", "length", "=", "ntohs", "(", "asconf_param", "-", ">", "param_hdr", ".", "length", ")", ";", "asconf_param", "=", "(", "void", "*", ")", "asconf_param", "+", "length", ";", "chunk_len", "-", "=", "length", ";", "union", "sctp_addr_param", "*", "addr_param", ";", "int", "length", ";", "addr_param", "=", "(", "union", "sctp_addr_param", "*", ")", "hdr", "-", ">", "params", ";", "length", "=", "ntohs", "(", "addr_param", "-", ">", "p", ".", "length", ")", ";", "if", "(", "length", "<", "sizeof", "(", "sctp_paramhdr_t", ")", ")", "return", "sctp_sf_violation_paramlen", "(", "net", ",", "ep", ",", "asoc", ",", "type", ",", "arg", ",", "(", "void", "*", ")", "addr_param", ",", "commands", ")", ";", "if", "(", "!", "sctp_verify_asconf", "(", "asoc", ",", "(", "sctp_paramhdr_t", "*", ")(", "(", "void", "*", ")", "addr_param", "+", "length", ")", ",", "(", "void", "*", ")", "chunk", "-", ">", "chunk_end", ",", "&", "err_param", ")", ")", "if", "(", "!", "sctp_verify_asconf", "(", "asoc", ",", "(", "sctp_paramhdr_t", "*", ")", "addip_hdr", "-", ">", "params", ",", "(", "void", "*", ")", "asconf_ack", "-", ">", "chunk_end", ",", "&", "err_param", ")", ")"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(system", "crash", ")"]}
{"contents": ["empty"], "code_tokens": ["maven", "{", "url", "\"", "https", ":", "//", "dl", ".", "bintray", ".", "com", "/", "kotlin", "/", "kotlin", "-", "dev", "\"", "}", "maven", "{", "url", "\"", "https", ":", "//", "dl", ".", "bintray", ".", "com", "/", "kotlin", "/", "kotlin", "-", "dev", "\"", "}", "maven", "{", "url", "\"", "https", ":", "//", "dl", ".", "bintray", ".", "com", "/", "arrow", "-", "kt", "/", "arrow", "-", "kt", "\"", "}", "}</s>maven", "{", "url", "\"", "http", ":", "//", "dl", ".", "bintray", ".", "com", "/", "kotlin", "/", "kotlin", "-", "dev", "\"", "}", "maven", "{", "url", "\"", "http", ":", "//", "dl", ".", "bintray", ".", "com", "/", "kotlin", "/", "kotlin", "-", "dev", "\"", "}", "maven", "{", "url", "\"", "http", ":", "//", "dl", ".", "bintray", ".", "com", "/", "arrow", "-", "kt", "/", "arrow", "-", "kt", "\"", "}", "}"], "docstring_tokens": ["launch", "further", "attacks", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["#", "define", "pmd_read_atomic", "pmd_read_atomic", "/", "*", "*", "pte_offset_map_lock", "on", "32bit", "PAE", "kernels", "was", "reading", "the", "pmd_t", "with", "*", "a", "\"", "*", "pmdp", "\"", "dereference", "done", "by", "gcc", ".", "Problem", "is", ",", "in", "certain", "places", "*", "where", "pte_offset_map_lock", "is", "called", ",", "concurrent", "page", "faults", "are", "*", "allowed", ",", "if", "the", "mmap_sem", "is", "hold", "for", "reading", ".", "An", "example", "is", "mincore", "*", "vs", "page", "faults", "vs", "MADV_DONTNEED", ".", "On", "the", "page", "fault", "side", "*", "pmd_populate", "rightfully", "does", "a", "set_64bit", ",", "but", "if", "we", "'", "re", "reading", "the", "*", "pmd_t", "with", "a", "\"", "*", "pmdp", "\"", "on", "the", "mincore", "side", ",", "a", "SMP", "race", "can", "happen", "*", "because", "gcc", "will", "not", "read", "the", "64bit", "of", "the", "pmd", "atomically", ".", "To", "fix", "*", "this", "all", "places", "running", "pmd_offset_map_lock", "(", ")", "while", "holding", "the", "*", "mmap_sem", "in", "read", "mode", ",", "shall", "read", "the", "pmdp", "pointer", "using", "this", "*", "function", "to", "know", "if", "the", "pmd", "is", "null", "nor", "not", ",", "and", "in", "turn", "to", "know", "if", "*", "they", "can", "run", "pmd_offset_map_lock", "or", "pmd_trans_huge", "or", "other", "pmd", "*", "operations", ".", "*", "*", "Without", "THP", "if", "the", "mmap_sem", "is", "hold", "for", "reading", ",", "the", "*", "pmd", "can", "only", "transition", "from", "null", "to", "not", "null", "while", "pmd_read_atomic", "runs", ".", "*", "So", "there", "'", "s", "no", "need", "of", "literally", "reading", "it", "atomically", ".", "*", "*", "With", "THP", "if", "the", "mmap_sem", "is", "hold", "for", "reading", ",", "the", "pmd", "can", "become", "*", "THP", "or", "null", "or", "point", "to", "a", "pte", "(", "and", "in", "turn", "become", "\"", "stable", "\"", ")", "at", "any", "*", "time", "under", "pmd_read_atomic", ",", "so", "it", "'", "s", "mandatory", "to", "read", "it", "atomically", "*", "with", "cmpxchg8b", ".", "*", "/", "#", "ifndef", "CONFIG_TRANSPARENT_HUGEPAGE", "static", "inline", "pmd_t", "pmd_read_atomic", "(", "pmd_t", "*", "pmdp", ")", "{", "pmdval_t", "ret", ";", "u32", "*", "tmp", "=", "(", "u32", "*", ")", "pmdp", ";", "ret", "=", "(", "pmdval_t", ")", "(", "*", "tmp", ")", ";", "if", "(", "ret", ")", "{", "/", "*", "*", "If", "the", "low", "part", "is", "null", ",", "we", "must", "not", "read", "the", "high", "part", "*", "or", "we", "can", "end", "up", "with", "a", "partial", "pmd", ".", "*", "/", "smp_rmb", "(", ");", "ret", "|", "=", "(", "(", "pmdval_t", ")", "*(", "tmp", "+", "1", ")", ")", "<", "<", "32", ";", "}", "return", "(", "pmd_t", ")", "{", "ret", "}", ";", "}", "#", "else", "/", "*", "CONFIG_TRANSPARENT_HUGEPAGE", "*", "/", "static", "inline", "pmd_t", "pmd_read_atomic", "(", "pmd_t", "*", "pmdp", ")", "{", "return", "(", "pmd_t", ")", "{", "atomic64_read", "(", "(", "atomic64_t", "*", ")", "pmdp", ")", "}", ";", "}", "#", "endif", "/", "*", "CONFIG_TRANSPARENT_HUGEPAGE", "*", "/", "#", "ifndef", "pmd_read_atomic", "static", "inline", "pmd_t", "pmd_read_atomic", "(", "pmd_t", "*", "pmdp", ")", "{", "/", "*", "*", "Depend", "on", "compiler", "for", "an", "atomic", "pmd", "read", ".", "NOTE", ":", "this", "is", "*", "only", "going", "to", "work", ",", "if", "the", "pmdval_t", "isn", "'", "t", "larger", "than", "*", "an", "unsigned", "long", ".", "*", "/", "return", "*", "pmdp", ";", "}", "#", "endif", "*", "*", "For", "32bit", "kernels", "with", "a", "64bit", "large", "pmd_t", "this", "automatically", "takes", "*", "care", "of", "reading", "the", "pmd", "atomically", "to", "avoid", "SMP", "race", "conditions", "*", "against", "pmd_populate", "(", ")", "when", "the", "mmap_sem", "is", "hold", "for", "reading", "by", "the", "*", "caller", "(", "a", "special", "atomic", "read", "not", "done", "by", "\"", "gcc", "\"", "as", "in", "the", "generic", "*", "version", "above", ",", "is", "also", "needed", "when", "THP", "is", "disabled", "because", "the", "page", "*", "fault", "can", "populate", "the", "pmd", "from", "under", "us", ")", ".", "pmd_t", "pmdval", "=", "pmd_read_atomic", "(", "pmd", ")", ";</s>/", "*", "depend", "on", "compiler", "for", "an", "atomic", "pmd", "read", "*", "/", "pmd_t", "pmdval", "=", "*", "pmd", ";"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(panic", ")"]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "support", ".", "JpaEvaluationContextExtension", ";", "private", "static", "final", "String", "ESCAPE_CHARACTER_PROPERTY", "=", "\"", "escapeCharacter", "\"", ";", "if", "(", "AnnotationRepositoryConfigurationSource", ".", "class", ".", "isInstance", "(", "source", ")", ")", "{", "return", "(", "Character", ")", "AnnotationRepositoryConfigurationSource", ".", "class", "/", "/", ".", "cast", "(", "source", ")", "/", "/", ".", "getAttributes", "(", ")", "/", "/", ".", "get", "(", "ESCAPE_CHARACTER_PROPERTY", ")", ";", "String", "attribute", "=", "source", ".", "getAttribute", "(", "ESCAPE_CHARACTER_PROPERTY", ")", ";", "return", "attribute", "=", "=", "null", "?", "null", ":", "attribute", ".", "toCharArray", "(", ")[", "0", "]", ";", "/", "/", "EvaluationContextExtension", "for", "JPA", "specific", "SpEL", "functions", "Character", "escapeCharacter", "=", "getEscapeCharacter", "(", "config", ")", ";", "BeanDefinitionBuilder", "builder", "=", "BeanDefinitionBuilder", ".", "rootBeanDefinition", "(", "JpaEvaluationContextExtension", ".", "class", ")", ";", "builder", ".", "addConstructorArgValue", "(", "escapeCharacter", "=", "=", "null", "?", "'", "\\\\", "'", ":", "escapeCharacter", ")", ";", "registerIfNotAlreadyRegistered", "(", "builder", ".", "getBeanDefinition", "(", "),", "registry", ",", "JpaEvaluationContextExtension", ".", "class", ".", "getName", "(", "),", "source", ")", ";", "package", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "query", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "List", ";", "*", "A", "value", "type", "encapsulating", "an", "escape", "character", "for", "LIKE", "queries", "and", "the", "actually", "usage", "of", "it", "in", "escaping", "*", "{", "@", "link", "String", "}", "s", ".", "*", "@", "author", "Oliver", "Drotbohm", "private", "static", "final", "List", "<", "String", ">", "TO_REPLACE", "=", "Arrays", ".", "asList", "(", "\"", "_", "\"", ",", "\"", "%\"", ");", "/", "**", "*", "Escapes", "all", "special", "like", "characters", "(", "{@", "code", "_", "}", ",", "{", "@", "code", "%", "})", "using", "the", "configured", "escape", "character", ".", "*", "*", "@", "param", "value", "must", "not", "be", "{", "@", "literal", "null", "}", ".", "*", "@", "return", "*", "/", "String", "result", "=", "value", ";", "for", "(", "String", "toReplace", ":", "TO_REPLACE", ")", "{", "result", "=", "result", ".", "replace", "(", "toReplace", ",", "value", "+", "toReplace", ")", ";", "}", "return", "result", ";", "/", "*", "*", "Copyright", "2019", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "support", ";", "import", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "query", ".", "EscapeCharacter", ";", "import", "org", ".", "springframework", ".", "data", ".", "repository", ".", "query", ".", "spi", ".", "EvaluationContextExtension", ";", "import", "org", ".", "springframework", ".", "data", ".", "repository", ".", "query", ".", "spi", ".", "EvaluationContextExtensionSupport", ";", "/", "**", "*", "{", "@", "link", "EvaluationContextExtension", "}", "to", "register", "{", "@", "link", "EscapeCharacter", "}", "as", "root", "object", "to", "essentially", "expose", "an", "*", "{", "@", "code", "expose", "(", "\u2026)", "}", "function", "to", "SpEL", ".", "*", "*", "@", "author", "Oliver", "Drotbohm", "*", "/", "public", "class", "JpaEvaluationContextExtension", "extends", "EvaluationContextExtensionSupport", "{", "private", "final", "EscapeCharacter", "character", ";", "/", "**", "*", "Creates", "a", "new", "{", "@", "link", "JpaEvaluationContextExtension", "}", "for", "the", "given", "escape", "character", ".", "*", "*", "@", "param", "escapeCharacter", "the", "character", "to", "be", "used", "to", "escape", "parameters", "for", "LIKE", "expression", ".", "*", "/", "public", "JpaEvaluationContextExtension", "(", "char", "escapeCharacter", ")", "{", "this", ".", "character", "=", "EscapeCharacter", ".", "of", "(", "escapeCharacter", ")", ";", "}", "/", "*", "*", "(", "non", "-", "Javadoc", ")", "*", "@", "see", "org", ".", "springframework", ".", "data", ".", "spel", ".", "spi", ".", "EvaluationContextExtension", "#", "getExtensionId", "(", ")", "*", "/", "@", "Override", "public", "String", "getExtensionId", "(", ")", "{", "return", "\"", "jpa", "\"", ";", "}", "/", "*", "*", "(", "non", "-", "Javadoc", ")", "*", "@", "see", "org", ".", "springframework", ".", "data", ".", "spel", ".", "spi", ".", "EvaluationContextExtension", "#", "getRootObject", "(", ")", "*", "/", "@", "Override", "public", "Object", "getRootObject", "(", ")", "{", "return", "character", ";", "}", "}", "@", "@", "-", "30", ",", "6", "+", "30", ",", "7", "@", "@", "import", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "query", ".", "EscapeCharacter", ";", "import", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "query", ".", "EscapeCharacter", ";", "http", "\\", ":/", "/", "www", ".", "springframework", ".", "org", "/", "schema", "/", "data", "/", "jpa", "/", "spring", "-", "jpa", "-", "1", ".", "11", ".", "xsd", "=", "org", "/", "springframework", "/", "data", "/", "jpa", "/", "repository", "/", "config", "/", "spring", "-", "jpa", "-", "1", ".", "11", ".", "xsd", "http", "\\", ":/", "/", "www", ".", "springframework", ".", "org", "/", "schema", "/", "data", "/", "jpa", "/", "spring", "-", "jpa", ".", "xsd", "=", "org", "/", "springframework", "/", "data", "/", "jpa", "/", "repository", "/", "config", "/", "spring", "-", "jpa", "-", "1", ".", "11", ".", "xsd", "@", "@", "-", "0", ",", "0", "+", "1", ",", "65", "@", "@", "<", "?", "xml", "version", "=", "\"", "1", ".", "0", "\"", "encoding", "=", "\"", "UTF", "-", "8", "\"", "?", ">", "<", "xsd", ":", "schema", "xmlns", "=", "\"", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "data", "/", "jpa", "\"", "xmlns", ":", "xsd", "=", "\"", "http", ":", "//", "www", ".", "w3", ".", "org", "/", "2001", "/", "XMLSchema", "\"", "xmlns", ":", "tool", "=", "\"", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "tool", "\"", "xmlns", ":", "context", "=", "\"", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "context", "\"", "xmlns", ":", "repository", "=", "\"", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "data", "/", "repository", "\"", "targetNamespace", "=", "\"", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "data", "/", "jpa", "\"", "elementFormDefault", "=", "\"", "qualified", "\"", "attributeFormDefault", "=", "\"", "unqualified", "\"", ">", "<", "xsd", ":", "import", "namespace", "=", "\"", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "tool", "\"", "/", ">", "<", "xsd", ":", "import", "namespace", "=", "\"", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "context", "\"", "/", ">", "<", "xsd", ":", "import", "namespace", "=", "\"", "http", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "data", "/", "repository", "\"", "schemaLocation", "=", "\"", "https", ":", "//", "www", ".", "springframework", ".", "org", "/", "schema", "/", "data", "/", "repository", "/", "spring", "-", "repository", ".", "xsd", "\"", "/", ">", "<", "xsd", ":", "element", "name", "=", "\"", "repositories", "\"", ">", "<", "xsd", ":", "complexType", ">", "<", "xsd", ":", "complexContent", ">", "<", "xsd", ":", "extension", "base", "=", "\"", "repository", ":", "repositories", "\"", ">", "<", "xsd", ":", "attributeGroup", "ref", "=", "\"", "repository", ":", "transactional", "-", "repository", "-", "attributes", "\"", "/", ">", "<", "xsd", ":", "attribute", "name", "=", "\"", "entity", "-", "manager", "-", "factory", "-", "ref", "\"", "type", "=", "\"", "entityManagerFactoryRef", "\"", "/", ">", "<", "xsd", ":", "attribute", "name", "=", "\"", "enable", "-", "default", "-", "transactions", "\"", "type", "=", "\"", "xsd", ":", "boolean", "\"", ">", "<", "xsd", ":", "annotation", ">", "<", "xsd", ":", "documentation", ">", "<!", "[", "CDATA", "[", "Controls", "whether", "repositories", "get", "transactions", "enabled", "by", "default", ".", "]", "]>", "</", "xsd", ":", "documentation", ">", "<", "/", "xsd", ":", "annotation", ">", "<", "/", "xsd", ":", "attribute", ">", "<", "xsd", ":", "attribute", "name", "=", "\"", "escape", "-", "character", "\"", "type", "=", "\"", "xsd", ":", "string", "\"", "default", "=", "\"\\", "\">", "<", "xsd", ":", "annotation", ">", "<", "xsd", ":", "documentation", ">", "<!", "[", "CDATA", "[", "Configures", "what", "character", "is", "used", "to", "escape", "the", "LIKE", "wildcards", "_", "and", "%", "in", "derived", "queries", "with", "contains", ",", "startsWith", "or", "endsWith", "clauses", ".", "Defaults", "to", "\\", ".", "]", "]>", "</", "xsd", ":", "documentation", ">", "<", "/", "xsd", ":", "annotation", ">", "<", "/", "xsd", ":", "attribute", ">", "<", "/", "xsd", ":", "extension", ">", "<", "/", "xsd", ":", "complexContent", ">", "<", "/", "xsd", ":", "complexType", ">", "<", "/", "xsd", ":", "element", ">", "<", "xsd", ":", "element", "name", "=", "\"", "auditing", "\"", ">", "<", "xsd", ":", "annotation", ">", "<", "xsd", ":", "appinfo", ">", "<", "tool", ":", "annotation", ">", "<", "tool", ":", "exports", "type", "=", "\"", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "domain", ".", "support", ".", "AuditingEntityListener", "\"", "/", ">", "<", "tool", ":", "exports", "type", "=", "\"", "org", ".", "springframework", ".", "data", ".", "auditing", ".", "AuditingHandler", "\"", "/", ">", "<", "/", "tool", ":", "annotation", ">", "<", "/", "xsd", ":", "appinfo", ">", "<", "/", "xsd", ":", "annotation", ">", "<", "xsd", ":", "complexType", ">", "<", "xsd", ":", "attributeGroup", "ref", "=", "\"", "repository", ":", "auditing", "-", "attributes", "\"", "/", ">", "<", "/", "xsd", ":", "complexType", ">", "<", "/", "xsd", ":", "element", ">", "<", "xsd", ":", "simpleType", "name", "=", "\"", "entityManagerFactoryRef", "\"", ">", "<", "xsd", ":", "annotation", ">", "<", "xsd", ":", "appinfo", ">", "<", "tool", ":", "annotation", "kind", "=", "\"", "ref", "\"", ">", "<", "tool", ":", "assignable", "-", "to", "type", "=", "\"", "org", ".", "springframework", ".", "orm", ".", "jpa", ".", "AbstractEntityManagerFactoryBean", "\"", "/", ">", "<", "/", "tool", ":", "annotation", ">", "<", "/", "xsd", ":", "appinfo", ">", "<", "/", "xsd", ":", "annotation", ">", "<", "xsd", ":", "union", "memberTypes", "=", "\"", "xsd", ":", "string", "\"", "/", ">", "<", "/", "xsd", ":", "simpleType", ">", "<", "/", "xsd", ":", "schema", ">", "@", "Query", "(", "\"", "select", "u", "from", "User", "u", "where", "u", ".", "firstname", "like", "%", "?#", "{", "escape", "(", "[", "0", "]", ")}", "%", "escape", "'", "\\\\", "'\"", ")</s>try", "{", "return", "AnnotationRepositoryConfigurationSource", ".", "class", ".", "isInstance", "(", "source", ")", "/", "/", "?", "(", "Character", ")", "AnnotationRepositoryConfigurationSource", ".", "class", ".", "cast", "(", "source", ")", ".", "getAttributes", "(", ")", ".", "get", "(", "\"", "escapeCharacter", "\"", ")", "/", "/", ":", "source", ".", "getAttribute", "(", "\"", "escapeCharacter", "\"", ").", "toCharArray", "(", ")[", "0", "]", ";", "}", "catch", "(", "IllegalArgumentException", "___", ")", "{", "return", "null", ";", "package", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "support", ";", "*", "A", "Value", "-", "class", "encapsulating", "an", "escape", "character", "for", "LIKE", "queries", "and", "the", "actually", "usage", "of", "it", "in", "escaping", "Strings", ".", "return", "value", ".", "replace", "(", "\"", "_", "\"", ",", "value", "+", "\"", "_", "\"", ").", "replace", "(", "\"%", "\",", "value", "+", "\"", "%\"", ");", "}", "/", "/", "used", "for", "SpEL", "expressions", "static", "String", "escape", "(", "String", "value", ",", "String", "escape", ")", "{", "Assert", ".", "hasText", "(", "escape", ",", "\"", "escape", "must", "be", "a", "sinlge", "character", "String", ".", "\")", ";", "char", "[", "]", "chars", "=", "escape", ".", "toCharArray", "(", ");", "Assert", ".", "isTrue", "(", "chars", ".", "length", "=", "=", "1", ",", "\"", "escape", "must", "be", "a", "single", "character", "String", ".", "\")", ";", "return", "EscapeCharacter", ".", "of", "(", "chars", "[", "0", "]", ").", "escape", "(", "value", ")", ";", "import", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "support", ".", "EscapeCharacter", ";", "import", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "support", ".", "EscapeCharacter", ";", "import", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "support", ".", "EscapeCharacter", ";", "import", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "support", ".", "EscapeCharacter", ";", "http", "\\", ":/", "/", "www", ".", "springframework", ".", "org", "/", "schema", "/", "data", "/", "jpa", "/", "spring", "-", "jpa", ".", "xsd", "=", "org", "/", "springframework", "/", "data", "/", "jpa", "/", "repository", "/", "config", "/", "spring", "-", "jpa", "-", "1", ".", "8", ".", "xsd", "import", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "support", ".", "EscapeCharacter", ";", "import", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "support", ".", "EscapeCharacter", ";", "import", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "support", ".", "EscapeCharacter", ";", "import", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "support", ".", "EscapeCharacter", ";", "import", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "support", ".", "EscapeCharacter", ";", "import", "org", ".", "springframework", ".", "data", ".", "jpa", ".", "repository", ".", "support", ".", "EscapeCharacter", ";", "@", "Query", "(", "\"", "select", "u", "from", "User", "u", "where", "u", ".", "firstname", "like", "%", "?#", "{#", "escape", "(", "[", "0", "]", ",'", "#'", ")}", "%", "escape", "'", "#'", "\")"], "docstring_tokens": ["obtain", "sensitive", "information"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "regset", "-", ">", "core_note_type", "&", "&", "regset", "-", ">", "get", "&", "&", "if", "(", "!", "regset", "-", ">", "get", ")", "return", "-", "EOPNOTSUPP", ";", "if", "(", "!", "regset", "-", ">", "set", ")", "return", "-", "EOPNOTSUPP", ";</s>if", "(", "regset", "-", ">", "core_note_type", "&", "&"], "docstring_tokens": ["the", "application", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "arg", ">", "=", "cdi", "-", ">", "capacity", ")</s>if", "(", "(", "int", ")", "arg", ">", "=", "cdi", "-", ">", "capacity", ")"], "docstring_tokens": ["obtain", "sensitive", "information"]}
{"contents": ["empty"], "code_tokens": ["struct", "uio_mem", "*", "mem", ";", "mem", "=", "idev", "-", ">", "info", "-", ">", "mem", "+", "mi", ";", "if", "(", "vma", "-", ">", "vm_end", "-", "vma", "-", ">", "vm_start", ">", "mem", "-", ">", "size", ")", "return", "-", "EINVAL", ";", "vma", "-", ">", "vm_ops", "=", "&", "uio_physical_vm_ops", ";", "/", "*", "*", "We", "cannot", "use", "the", "vm_iomap_memory", "(", ")", "helper", "here", ",", "*", "because", "vma", "-", ">", "vm_pgoff", "is", "the", "map", "index", "we", "looked", "*", "up", "above", "in", "uio_find_mem_index", "(", "),", "rather", "than", "an", "*", "actual", "page", "offset", "into", "the", "mmap", ".", "*", "*", "So", "we", "just", "do", "the", "physical", "mmap", "without", "a", "page", "*", "offset", ".", "*", "/", "mem", "-", ">", "addr", ">", ">", "PAGE_SHIFT", ",", "return", "vm_iomap_memory", "(", "vma", ",", "fbdev", "-", ">", "fb_phys", ",", "fbdev", "-", ">", "fb_len", ")", ";", "return", "vm_iomap_memory", "(", "vma", ",", "fbdev", "-", ">", "fb_phys", ",", "fbdev", "-", ">", "fb_len", ")", ";</s>vma", "-", ">", "vm_ops", "=", "&", "uio_physical_vm_ops", ";", "idev", "-", ">", "info", "-", ">", "mem", "[", "mi", "]", ".", "addr", ">", ">", "PAGE_SHIFT", ",", "unsigned", "int", "len", ";", "unsigned", "long", "start", "=", "0", ",", "off", ";", "if", "(", "vma", "-", ">", "vm_pgoff", ">", "(", "~", "0UL", ">", ">", "PAGE_SHIFT", ")", ")", "{", "return", "-", "EINVAL", ";", "}", "start", "=", "fbdev", "-", ">", "fb_phys", "&", "PAGE_MASK", ";", "len", "=", "PAGE_ALIGN", "(", "(", "start", "&", "~", "PAGE_MASK", ")", "+", "fbdev", "-", ">", "fb_len", ")", ";", "off", "=", "vma", "-", ">", "vm_pgoff", "<", "<", "PAGE_SHIFT", ";", "if", "(", "(", "vma", "-", ">", "vm_end", "-", "vma", "-", ">", "vm_start", "+", "off", ")", ">", "len", ")", "{", "return", "-", "EINVAL", ";", "}", "off", "+", "=", "start", ";", "vma", "-", ">", "vm_pgoff", "=", "off", ">", ">", "PAGE_SHIFT", ";", "if", "(", "io_remap_pfn_range", "(", "vma", ",", "vma", "-", ">", "vm_start", ",", "off", ">", ">", "PAGE_SHIFT", ",", "vma", "-", ">", "vm_end", "-", "vma", "-", ">", "vm_start", ",", "vma", "-", ">", "vm_page_prot", ")", ")", "{", "return", "-", "EAGAIN", ";", "}", "return", "0", ";", "unsigned", "int", "len", ";", "unsigned", "long", "start", "=", "0", ",", "off", ";", "if", "(", "vma", "-", ">", "vm_pgoff", ">", "(", "~", "0UL", ">", ">", "PAGE_SHIFT", ")", ")", "{", "return", "-", "EINVAL", ";", "}", "start", "=", "fbdev", "-", ">", "fb_phys", "&", "PAGE_MASK", ";", "len", "=", "PAGE_ALIGN", "(", "(", "start", "&", "~", "PAGE_MASK", ")", "+", "fbdev", "-", ">", "fb_len", ")", ";", "off", "=", "vma", "-", ">", "vm_pgoff", "<", "<", "PAGE_SHIFT", ";", "if", "(", "(", "vma", "-", ">", "vm_end", "-", "vma", "-", ">", "vm_start", "+", "off", ")", ">", "len", ")", "{", "return", "-", "EINVAL", ";", "}", "off", "+", "=", "start", ";", "vma", "-", ">", "vm_pgoff", "=", "off", ">", ">", "PAGE_SHIFT", ";", "return", "io_remap_pfn_range", "(", "vma", ",", "vma", "-", ">", "vm_start", ",", "off", ">", ">", "PAGE_SHIFT", ",", "vma", "-", ">", "vm_end", "-", "vma", "-", ">", "vm_start", ",", "vma", "-", ">", "vm_page_prot", ")", ";"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(memory", "corruption", ")", "or", "possibly", "gain", "privileges"]}
{"contents": ["empty"], "code_tokens": ["method", ".", "setAccessible", "(", "true", ")", ";", "return", "invokeMethod", "(", "instance", ",", "method", ",", "parameters", ")", ";", "}", "public", "static", "Object", "invokeMethod", "(", "Object", "instance", ",", "Method", "method", ",", "Object", "[", "]", "parameters", ")", "{", "throw", "new", "CacheException", "(", "\"", "Unable", "to", "invoke", "method", "\"", "+", "method", "+", "\"", "on", "object", "of", "type", "\"", "+", "(", "instance", "=", "=", "null", "?", "\"", "null", "\"", ":", "instance", ".", "getClass", "(", ").", "getSimpleName", "(", "))", "throw", "new", "CacheException", "(", "\"", "Unable", "to", "invoke", "method", "\"", "+", "method", "+", "\"", "on", "object", "of", "type", "\"", "+", "(", "instance", "=", "=", "null", "?", "\"", "null", "\"", ":", "instance", ".", "getClass", "(", ").", "getSimpleName", "(", "))", "field", ".", "setAccessible", "(", "true", ")", ";", "setField", "(", "instance", ",", "field", ",", "value", ")", ";", "}", "public", "static", "void", "setField", "(", "Object", "instance", ",", "Field", "field", ",", "Object", "value", ")", "{", "(", "instance", "=", "=", "null", "?", "\"", "null", "\"", ":", "instance", ".", "getClass", "(", ").", "getName", "(", "))", "+", "\"", "to", "\"", "+", "value", ",", "e", ")", ";", "import", "static", "org", ".", "infinispan", ".", "commons", ".", "util", ".", "ReflectionUtil", ".", "invokeMethod", ";", "method", ".", "setAccessible", "(", "true", ")", ";", "AccessController", ".", "doPrivileged", "(", "(", "PrivilegedAction", "<", "List", "<", "Method", ">", ">)", "(", ")", "-", ">", "{", "method", ".", "setAccessible", "(", "true", ")", ";", "return", "null", ";", "}", ");", "return", "invokeMethod", "(", "instance", ",", "method", ",", "Util", ".", "EMPTY_OBJECT_ARRAY", ")", ";", "package", "org", ".", "infinispan", ".", "factories", ".", "impl", ";", "import", "java", ".", "lang", ".", "reflect", ".", "AccessibleObject", ";", "import", "java", ".", "security", ".", "AccessController", ";", "import", "java", ".", "security", ".", "PrivilegedAction", ";", "import", "org", ".", "infinispan", ".", "security", ".", "Security", ";", "import", "org", ".", "infinispan", ".", "util", ".", "logging", ".", "Log", ";", "import", "org", ".", "infinispan", ".", "util", ".", "logging", ".", "LogFactory", ";", "/", "**", "*", "SecurityActions", "for", "the", "org", ".", "infinispan", ".", "factories", "package", ".", "*", "<", "p", ">", "*", "Do", "not", "move", ".", "Do", "not", "change", "class", "and", "method", "visibility", "to", "avoid", "being", "called", "from", "other", "*", "{", "@", "link", "java", ".", "security", ".", "CodeSource", "}", "s", ",", "thus", "granting", "privilege", "escalation", "to", "external", "code", ".", "*", "*", "@", "author", "Dan", "Berindei", "*", "@", "since", "9", ".", "4", "*", "/", "final", "class", "SecurityActions", "{", "private", "static", "final", "Log", "log", "=", "LogFactory", ".", "getLog", "(", "SecurityActions", ".", "class", ")", ";", "static", "<", "T", ">", "void", "doPrivileged", "(", "PrivilegedAction", "<", "T", ">", "runnable", ")", "{", "if", "(", "System", ".", "getSecurityManager", "(", ")", "!", "=", "null", ")", "{", "AccessController", ".", "doPrivileged", "(", "(", "PrivilegedAction", "<", "Void", ">", ")", "(", ")", "-", ">", "{", "runnable", ".", "run", "(", ");", "return", "null", ";", "}", ");", "}", "else", "{", "Security", ".", "doPrivileged", "(", "(", "PrivilegedAction", "<", "Void", ">", ")", "(", ")", "-", ">", "{", "runnable", ".", "run", "(", ");", "return", "null", ";", "}", ");", "}", "}", "static", "void", "setAccessible", "(", "AccessibleObject", "member", ")", "{", "doPrivileged", "(", "()", "-", ">", "{", "member", ".", "setAccessible", "(", "true", ")", ";", "return", "null", ";", "}", ");", "}", "}</s>method", ".", "setAccessible", "(", "true", ")", ";", "throw", "new", "CacheException", "(", "\"", "Unable", "to", "invoke", "method", "\"", "+", "method", "+", "\"", "on", "object", "of", "type", "\"", "+", "(", "instance", "=", "=", "null", "?", "\"", "null", "\"", ":", "instance", ".", "getClass", "(", ").", "getSimpleName", "(", "))", "+", "throw", "new", "CacheException", "(", "\"", "Unable", "to", "invoke", "method", "\"", "+", "method", "+", "\"", "on", "object", "of", "type", "\"", "+", "(", "instance", "=", "=", "null", "?", "\"", "null", "\"", ":", "instance", ".", "getClass", "(", ").", "getSimpleName", "(", "))", "+", "field", ".", "setAccessible", "(", "true", ")", ";", "(", "instance", "=", "=", "null", "?", "\"", "null", "\"", ":", "instance", ".", "getClass", "(", ").", "getName", "(", "))", "+", "\"", "to", "\"", "+", "value", ",", "e", ")", ";", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "import", "static", "org", ".", "infinispan", ".", "commons", ".", "util", ".", "ReflectionUtil", ".", "invokeAccessibly", ";", "Object", "object", ";", "return", "invokeAccessibly", "(", "instance", ",", "method", ",", "Util", ".", "EMPTY_OBJECT_ARRAY", ")", ";", "return", "AccessController", ".", "doPrivileged", "(", "(", "PrivilegedAction", "<", "Object", ">", ")", "(", ")", "-", ">", "invokeAccessibly", "(", "instance", ",", "method", ",", "Util", ".", "EMPTY_OBJECT_ARRAY", ")", ");"], "docstring_tokens": ["invoke", "private", "methods", "in", "any", "class", "with", "Infinispan's", "privileges"]}
{"contents": ["empty"], "code_tokens": ["*", ")", "Fix", "bug", "where", "CRLs", "with", "nextUpdate", "in", "the", "past", "are", "sometimes", "accepted", "by", "initialising", "X509_STORE_CTX", "properly", ".", "(", "CVE", "-", "2011", "-", "3207", ")", "[", "Kaspar", "Brand", "<", "ossl", "@", "velox", ".", "ch", ">", "]", "for", "multi", "-", "threaded", "use", "of", "ECDH", ".", "(", "CVE", "-", "2011", "-", "3210", ")", "ctx", "-", ">", "current_crl_score", "=", "0", ";", "ctx", "-", ">", "current_crl", "=", "NULL", ";", "ctx", "-", ">", "current_crl_score", "=", "0", ";", "ctx", "-", ">", "current_reasons", "=", "0", ";</s>for", "multi", "-", "threaded", "use", "of", "ECDH", "."], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(daemon", "crash", ")"]}
{"contents": ["empty"], "code_tokens": ["<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "<", "/", "version", ">", "@", "SuiteClasses", "(", "{", "XLoggerTest", ".", "class", "}", ")", "listAppender", "=", "new", "ListAppender", "(", ");", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "<", "/", "version", ">", "<", "h3", ">", "February", "16th", ",", "2019", "-", "Release", "of", "SLF4J", "1", ".", "8", ".", "0", "-", "beta3", "<", "/", "h3", ">", "<", "p", ">", "Fixed", "<", "a", "href", "=", "\"", "https", ":", "//", "nvd", ".", "nist", ".", "gov", "/", "vuln", "/", "detail", "/", "CVE", "-", "2018", "-", "8088", "\"", ">", "CVE", "-", "2018", "-", "8088", "<", "/", "a", ">", "by", "removing", "the", "<", "code", ">", "EventData", "<", "/", "code", ">", "<", "code", ">", "EventException", "<", "/", "code", ">", "<", "code", ">", "EventLogger", "<", "/", "code", ">", "classes", "in", "the", "same", "way", "as", "done", "in", "SLF4J", "1", ".", "7", ".", "26", ".", "<", "/", "p", ">", "<", "h3", ">", "February", "16th", ",", "2019", "-", "Release", "of", "SLF4J", "1", ".", "7", ".", "26", "<", "/", "h3", ">", "<", "p", ">", "Due", "to", "popular", "demand", "in", "relation", "<", "a", "href", "=", "\"", "https", ":", "//", "nvd", ".", "nist", ".", "gov", "/", "vuln", "/", "detail", "/", "CVE", "-", "2018", "-", "8088", "\"", ">", "CVE", "-", "2018", "-", "8088", "<", "/", "a", ">", ",", "removed", "<", "code", ">", "EventData", "<", "/", "code", ">", "<", "code", ">", "EventException", "<", "/", "code", ">", "<", "code", ">", "EventLogger", "<", "/", "code", ">", "classes", "in", "the", "<", "code", ">", "org", ".", "slf4j", ".", "ext", "<", "/", "code", ">", "package", "in", "the", "slf4j", "-", "ext", "module", ".", "These", "classes", "were", "rarely", "used", ".", "<", "/", "p", ">", "<", "p", ">", "The", "aforementioned", "vulnerabilty", "has", "quite", "a", "low", "severty", "but", "was", "incorrectly", "marked", "critical", "in", "National", "Vulnerability", "Database", ".", "However", ",", "it", "was", "easier", "to", "remove", "the", "rarely", "-", "used", "incriminated", "classes", "than", "to", "try", "to", "convince", "the", "universe", "that", "the", "severity", "of", "the", "vulnerability", "was", "indeed", "low", ".", "<", "/", "p", "></s><", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "dependency", ">", "<", "groupId", ">", "commons", "-", "lang", "<", "/", "groupId", ">", "<", "artifactId", ">", "commons", "-", "lang", "<", "/", "artifactId", ">", "<", "version", ">", "2", ".", "4", "<", "/", "version", ">", "<", "optional", ">", "true", "<", "/", "optional", ">", "<", "/", "dependency", ">", "/", "**", "*", "Copyright", "(", "c", ")", "2004", "-", "2011", "QOS", ".", "ch", "*", "All", "rights", "reserved", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "*", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "*", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "*", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "*", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "*", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "*", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "*", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "*", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "*", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "*", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "*", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "*", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "*", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", "*", "*", "/", "package", "org", ".", "slf4j", ".", "ext", ";", "import", "java", ".", "io", ".", "Serializable", ";", "import", "java", ".", "io", ".", "ByteArrayInputStream", ";", "import", "java", ".", "io", ".", "ByteArrayOutputStream", ";", "import", "java", ".", "util", ".", "Date", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "beans", ".", "XMLDecoder", ";", "import", "java", ".", "beans", ".", "XMLEncoder", ";", "import", "java", ".", "beans", ".", "ExceptionListener", ";", "/", "**", "*", "Base", "class", "for", "Event", "Data", ".", "Event", "Data", "contains", "data", "to", "be", "logged", "about", "an", "*", "event", ".", "Users", "may", "extend", "this", "class", "for", "each", "EventType", "they", "want", "to", "log", ".", "*", "*", "@", "author", "Ralph", "Goers", "*", "*", "@", "deprecated", "Due", "to", "a", "security", "vulnerability", ",", "this", "class", "will", "be", "removed", "without", "replacement", ".", "*", "/", "public", "class", "EventData", "implements", "Serializable", "{", "private", "static", "final", "long", "serialVersionUID", "=", "153270778642103985L", ";", "private", "Map", "<", "String", ",", "Object", ">", "eventData", "=", "new", "HashMap", "<", "String", ",", "Object", ">", "()", ";", "public", "static", "final", "String", "EVENT_MESSAGE", "=", "\"", "EventMessage", "\"", ";", "public", "static", "final", "String", "EVENT_TYPE", "=", "\"", "EventType", "\"", ";", "public", "static", "final", "String", "EVENT_DATETIME", "=", "\"", "EventDateTime", "\"", ";", "public", "static", "final", "String", "EVENT_ID", "=", "\"", "EventId", "\"", ";", "/", "**", "*", "Default", "Constructor", "*", "/", "public", "EventData", "(", ")", "{", "}", "/", "**", "*", "Constructor", "to", "create", "event", "data", "from", "a", "Map", ".", "*", "*", "@", "param", "map", "*", "The", "event", "data", ".", "*", "/", "public", "EventData", "(", "Map", "<", "String", ",", "Object", ">", "map", ")", "{", "eventData", ".", "putAll", "(", "map", ")", ";", "}", "/", "**", "*", "Construct", "from", "a", "serialized", "form", "of", "the", "Map", "containing", "the", "RequestInfo", "*", "elements", "*", "*", "@", "param", "xml", "*", "The", "serialized", "form", "of", "the", "RequestInfo", "Map", ".", "*", "/", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "public", "EventData", "(", "String", "xml", ")", "{", "ByteArrayInputStream", "bais", "=", "new", "ByteArrayInputStream", "(", "xml", ".", "getBytes", "(", "))", ";", "try", "{", "XMLDecoder", "decoder", "=", "new", "XMLDecoder", "(", "bais", ")", ";", "this", ".", "eventData", "=", "(", "Map", "<", "String", ",", "Object", ">", ")", "decoder", ".", "readObject", "(", ");", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "new", "EventException", "(", "\"", "Error", "decoding", "\"", "+", "xml", ",", "e", ")", ";", "}", "}", "/", "**", "*", "Serialize", "all", "the", "EventData", "items", "into", "an", "XML", "representation", ".", "*", "*", "@", "return", "an", "XML", "String", "containing", "all", "the", "EventData", "items", ".", "*", "/", "public", "String", "toXML", "(", ")", "{", "return", "toXML", "(", "eventData", ")", ";", "}", "/", "**", "*", "Serialize", "all", "the", "EventData", "items", "into", "an", "XML", "representation", ".", "*", "*", "@", "param", "map", "the", "Map", "to", "transform", "*", "@", "return", "an", "XML", "String", "containing", "all", "the", "EventData", "items", ".", "*", "/", "public", "static", "String", "toXML", "(", "Map", "<", "String", ",", "Object", ">", "map", ")", "{", "ByteArrayOutputStream", "baos", "=", "new", "ByteArrayOutputStream", "(", ");", "try", "{", "XMLEncoder", "encoder", "=", "new", "XMLEncoder", "(", "baos", ")", ";", "encoder", ".", "setExceptionListener", "(", "new", "ExceptionListener", "(", ")", "{", "public", "void", "exceptionThrown", "(", "Exception", "exception", ")", "{", "exception", ".", "printStackTrace", "(", ");", "}", "}", ");", "encoder", ".", "writeObject", "(", "map", ")", ";", "encoder", ".", "close", "(", ");", "return", "baos", ".", "toString", "(", ");", "}", "catch", "(", "Exception", "e", ")", "{", "e", ".", "printStackTrace", "(", ");", "return", "null", ";", "}", "}", "/", "**", "*", "Retrieve", "the", "event", "identifier", ".", "*", "*", "@", "return", "The", "event", "identifier", "*", "/", "public", "String", "getEventId", "(", ")", "{", "return", "(", "String", ")", "this", ".", "eventData", ".", "get", "(", "EVENT_ID", ")", ";", "}", "/", "**", "*", "Set", "the", "event", "identifier", ".", "*", "*", "@", "param", "eventId", "*", "The", "event", "identifier", ".", "*", "/", "public", "void", "setEventId", "(", "String", "eventId", ")", "{", "if", "(", "eventId", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "eventId", "cannot", "be", "null", "\"", ");", "}", "this", ".", "eventData", ".", "put", "(", "EVENT_ID", ",", "eventId", ")", ";", "}", "/", "**", "*", "Retrieve", "the", "message", "text", "associated", "with", "this", "event", ",", "if", "any", ".", "*", "*", "@", "return", "The", "message", "text", "associated", "with", "this", "event", "or", "null", "if", "there", "is", "*", "none", ".", "*", "/", "public", "String", "getMessage", "(", ")", "{", "return", "(", "String", ")", "this", ".", "eventData", ".", "get", "(", "EVENT_MESSAGE", ")", ";", "}", "/", "**", "*", "Set", "the", "message", "text", "associated", "with", "this", "event", ".", "*", "*", "@", "param", "message", "*", "The", "message", "text", ".", "*", "/", "public", "void", "setMessage", "(", "String", "message", ")", "{", "this", ".", "eventData", ".", "put", "(", "EVENT_MESSAGE", ",", "message", ")", ";", "}", "/", "**", "*", "Retrieve", "the", "date", "and", "time", "the", "event", "occurred", ".", "*", "*", "@", "return", "The", "Date", "associated", "with", "the", "event", ".", "*", "/", "public", "Date", "getEventDateTime", "(", ")", "{", "return", "(", "Date", ")", "this", ".", "eventData", ".", "get", "(", "EVENT_DATETIME", ")", ";", "}", "/", "**", "*", "Set", "the", "date", "and", "time", "the", "event", "occurred", "in", "case", "it", "is", "not", "the", "same", "as", "when", "*", "the", "event", "was", "logged", ".", "*", "*", "@", "param", "eventDateTime", "*", "The", "event", "Date", ".", "*", "/", "public", "void", "setEventDateTime", "(", "Date", "eventDateTime", ")", "{", "this", ".", "eventData", ".", "put", "(", "EVENT_DATETIME", ",", "eventDateTime", ")", ";", "}", "/", "**", "*", "Set", "the", "type", "of", "event", "that", "occurred", ".", "*", "*", "@", "param", "eventType", "*", "The", "type", "of", "the", "event", ".", "*", "/", "public", "void", "setEventType", "(", "String", "eventType", ")", "{", "this", ".", "eventData", ".", "put", "(", "EVENT_TYPE", ",", "eventType", ")", ";", "}", "/", "**", "*", "Retrieve", "the", "type", "of", "the", "event", ".", "*", "*", "@", "return", "The", "event", "type", ".", "*", "/", "public", "String", "getEventType", "(", ")", "{", "return", "(", "String", ")", "this", ".", "eventData", ".", "get", "(", "EVENT_TYPE", ")", ";", "}", "/", "**", "*", "Add", "arbitrary", "attributes", "about", "the", "event", ".", "*", "*", "@", "param", "name", "*", "The", "attribute", "'", "s", "key", ".", "*", "@", "param", "obj", "*", "The", "data", "associated", "with", "the", "key", ".", "*", "/", "public", "void", "put", "(", "String", "name", ",", "Serializable", "obj", ")", "{", "this", ".", "eventData", ".", "put", "(", "name", ",", "obj", ")", ";", "}", "/", "**", "*", "Retrieve", "an", "event", "attribute", ".", "*", "*", "@", "param", "name", "*", "The", "attribute", "'", "s", "key", ".", "*", "@", "return", "The", "value", "associated", "with", "the", "key", "or", "null", "if", "the", "key", "is", "not", "*", "present", ".", "*", "/", "public", "Serializable", "get", "(", "String", "name", ")", "{", "return", "(", "Serializable", ")", "this", ".", "eventData", ".", "get", "(", "name", ")", ";", "}", "/", "**", "*", "Populate", "the", "event", "data", "from", "a", "Map", ".", "*", "*", "@", "param", "data", "*", "The", "Map", "to", "copy", ".", "*", "/", "public", "void", "putAll", "(", "Map", "<", "String", ",", "Object", ">", "data", ")", "{", "this", ".", "eventData", ".", "putAll", "(", "data", ")", ";", "}", "/", "**", "*", "Returns", "the", "number", "of", "attributes", "in", "the", "EventData", ".", "*", "*", "@", "return", "the", "number", "of", "attributes", "in", "the", "EventData", ".", "*", "/", "public", "int", "getSize", "(", ")", "{", "return", "this", ".", "eventData", ".", "size", "(", ");", "}", "/", "**", "*", "Returns", "an", "Iterator", "over", "all", "the", "entries", "in", "the", "EventData", ".", "*", "*", "@", "return", "an", "Iterator", "that", "can", "be", "used", "to", "access", "all", "the", "event", "attributes", ".", "*", "/", "public", "Iterator", "<", "Map", ".", "Entry", "<", "String", ",", "Object", ">", ">", "getEntrySetIterator", "(", ")", "{", "return", "this", ".", "eventData", ".", "entrySet", "(", ").", "iterator", "(", ");", "}", "/", "**", "*", "Retrieve", "all", "the", "attributes", "in", "the", "EventData", "as", "a", "Map", ".", "Changes", "to", "this", "map", "*", "will", "be", "reflected", "in", "the", "EventData", ".", "*", "*", "@", "return", "The", "Map", "of", "attributes", "in", "this", "EventData", "instance", ".", "*", "/", "public", "Map", "<", "String", ",", "Object", ">", "getEventMap", "(", ")", "{", "return", "this", ".", "eventData", ";", "}", "/", "**", "*", "Convert", "the", "EventData", "to", "a", "String", ".", "*", "*", "@", "return", "The", "EventData", "as", "a", "String", ".", "*", "/", "@", "Override", "public", "String", "toString", "(", ")", "{", "return", "toXML", "(", ");", "}", "/", "**", "*", "Compare", "two", "EventData", "objects", "for", "equality", ".", "*", "*", "@", "param", "o", "*", "The", "Object", "to", "compare", ".", "*", "@", "return", "true", "if", "the", "objects", "are", "the", "same", "instance", "or", "contain", "all", "the", "same", "*", "keys", "and", "their", "values", ".", "*", "/", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "@", "Override", "public", "boolean", "equals", "(", "Object", "o", ")", "{", "if", "(", "this", "=", "=", "o", ")", "{", "return", "true", ";", "}", "if", "(", "!(", "o", "instanceof", "EventData", "|", "|", "o", "instanceof", "Map", ")", ")", "{", "return", "false", ";", "}", "Map", "<", "String", ",", "Object", ">", "map", "=", "(", "o", "instanceof", "EventData", ")", "?", "(", "(", "EventData", ")", "o", ")", ".", "getEventMap", "(", ")", ":", "(", "Map", "<", "String", ",", "Object", ">", ")", "o", ";", "return", "this", ".", "eventData", ".", "equals", "(", "map", ")", ";", "}", "/", "**", "*", "Compute", "the", "hashCode", "for", "this", "EventData", "instance", ".", "*", "*", "@", "return", "The", "hashcode", "for", "this", "EventData", "instance", ".", "*", "/", "@", "Override", "public", "int", "hashCode", "(", ")", "{", "return", "this", ".", "eventData", ".", "hashCode", "(", ");", "}", "}", "/", "**", "*", "Copyright", "(", "c", ")", "2004", "-", "2011", "QOS", ".", "ch", "*", "All", "rights", "reserved", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "*", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "*", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "*", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "*", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "*", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "*", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "*", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "*", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "*", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "*", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "*", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "*", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "*", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", "*", "*", "/", "package", "org", ".", "slf4j", ".", "ext", ";", "/", "**", "*", "Exception", "used", "to", "identify", "issues", "related", "to", "an", "event", "that", "is", "being", "logged", ".", "*", "*", "@", "deprecated", "This", "class", "will", "be", "removed", "in", "subsequent", "released", "without", "replacement", ".", "Only", "used", "by", "EventData", ".", "*", "/", "public", "class", "EventException", "extends", "RuntimeException", "{", "private", "static", "final", "long", "serialVersionUID", "=", "-", "22873966112391992L", ";", "/", "**", "*", "Default", "constructor", ".", "*", "/", "public", "EventException", "(", ")", "{", "super", "(", ");", "}", "/", "**", "*", "Constructor", "that", "allows", "an", "exception", "message", ".", "*", "@", "param", "exceptionMessage", "The", "exception", "message", ".", "*", "/", "public", "EventException", "(", "String", "exceptionMessage", ")", "{", "super", "(", "exceptionMessage", ")", ";", "}", "/", "**", "*", "Constructor", "that", "chains", "another", "Exception", "or", "Error", ".", "*", "@", "param", "originalException", "The", "original", "exception", ".", "*", "/", "public", "EventException", "(", "Throwable", "originalException", ")", "{", "super", "(", "originalException", ")", ";", "}", "/", "**", "*", "Constructor", "that", "chains", "another", "Exception", "or", "Error", "and", "also", "allows", "a", "message", "*", "to", "be", "specified", ".", "*", "@", "param", "exceptionMessage", "The", "exception", "message", ".", "*", "@", "param", "originalException", "The", "original", "exception", ".", "*", "/", "public", "EventException", "(", "String", "exceptionMessage", ",", "Throwable", "originalException", ")", "{", "super", "(", "exceptionMessage", ",", "originalException", ")", ";", "}", "}", "@", "@", "-", "1", ",", "64", "+", "0", ",", "0", "@", "@", "/", "**", "*", "Copyright", "(", "c", ")", "2004", "-", "2011", "QOS", ".", "ch", "*", "All", "rights", "reserved", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "*", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "*", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "*", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "*", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "*", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "*", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "*", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "*", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "*", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "*", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "*", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "*", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "*", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", "*", "*", "/", "package", "org", ".", "slf4j", ".", "ext", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "import", "org", ".", "slf4j", ".", "Marker", ";", "import", "org", ".", "slf4j", ".", "MarkerFactory", ";", "import", "org", ".", "slf4j", ".", "spi", ".", "LocationAwareLogger", ";", "/", "**", "*", "Simple", "Logger", "used", "to", "log", "events", ".", "All", "events", "are", "directed", "to", "a", "logger", "named", "\"", "EventLogger", "\"", "*", "with", "a", "level", "of", "INFO", "and", "with", "an", "Event", "marker", ".", "*", "*", "@", "author", "Ralph", "Goers", "*", "/", "public", "class", "EventLogger", "{", "private", "static", "final", "String", "FQCN", "=", "EventLogger", ".", "class", ".", "getName", "(", ");", "static", "Marker", "EVENT_MARKER", "=", "MarkerFactory", ".", "getMarker", "(", "\"", "EVENT", "\"", ");", "private", "static", "LoggerWrapper", "eventLogger", "=", "new", "LoggerWrapper", "(", "LoggerFactory", ".", "getLogger", "(", "\"", "EventLogger", "\"", "),", "FQCN", ")", ";", "/", "**", "*", "There", "can", "only", "be", "a", "single", "EventLogger", ".", "*", "/", "private", "EventLogger", "(", ")", "{", "}", "/", "**", "*", "Logs", "the", "event", ".", "*", "*", "@", "param", "data", "The", "EventData", ".", "*", "/", "public", "static", "void", "logEvent", "(", "EventData", "data", ")", "{", "if", "(", "eventLogger", ".", "instanceofLAL", ")", "{", "(", "(", "LocationAwareLogger", ")", "eventLogger", ".", "logger", ")", ".", "log", "(", "EVENT_MARKER", ",", "FQCN", ",", "LocationAwareLogger", ".", "INFO_INT", ",", "data", ".", "toXML", "(", "),", "new", "Object", "[", "]", "{", "data", "}", ",", "null", ")", ";", "}", "else", "{", "eventLogger", ".", "logger", ".", "info", "(", "EVENT_MARKER", ",", "data", ".", "toXML", "(", "),", "data", ")", ";", "}", "}", "}", "@", "@", "-", "1", ",", "49", "+", "0", ",", "0", "@", "@", "/", "**", "*", "Copyright", "(", "c", ")", "2004", "-", "2011", "QOS", ".", "ch", "*", "All", "rights", "reserved", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "*", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "*", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "*", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "*", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "*", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "*", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "*", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "*", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "*", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "*", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "*", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "*", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "*", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", "*", "*", "/", "package", "org", ".", "slf4j", ".", "ext", ";", "import", "org", ".", "apache", ".", "commons", ".", "lang", ".", "text", ".", "StrLookup", ";", "import", "org", ".", "slf4j", ".", "MDC", ";", "/", "**", "*", "This", "class", "can", "be", "used", "with", "the", "Commons", "Lang", "StrSubstitutor", "to", "replace", "*", "tokens", "that", "occur", "in", "Strings", "with", "their", "values", "in", "the", "MDC", ".", "*", "*", "@", "author", "Ralph", "Goers", "*", "/", "public", "class", "MDCStrLookup", "extends", "StrLookup", "{", "/", "**", "*", "Looks", "up", "up", "a", "value", "in", "the", "MDC", ".", "*", "*", "@", "param", "key", "the", "key", "to", "be", "looked", "up", ",", "may", "be", "null", "*", "@", "return", "the", "matching", "value", ",", "null", "if", "no", "match", "*", "/", "public", "String", "lookup", "(", "String", "key", ")", "{", "if", "(", "key", "=", "=", "null", ")", "{", "return", "null", ";", "}", "return", "MDC", ".", "get", "(", "key", ")", ";", "}", "}", "@", "@", "-", "1", ",", "106", "+", "0", ",", "0", "@", "@", "/", "**", "*", "Copyright", "(", "c", ")", "2004", "-", "2011", "QOS", ".", "ch", "*", "All", "rights", "reserved", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "*", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "*", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "*", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "*", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "*", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "*", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "*", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "*", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "*", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "*", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "*", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "*", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "*", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", "*", "*", "/", "package", "org", ".", "slf4j", ".", "dummyExt", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "java", ".", "util", ".", "Date", ";", "import", "java", ".", "util", ".", "Locale", ";", "import", "java", ".", "util", ".", "TimeZone", ";", "import", "org", ".", "apache", ".", "log4j", ".", "spi", ".", "LocationInfo", ";", "import", "org", ".", "apache", ".", "log4j", ".", "spi", ".", "LoggingEvent", ";", "import", "org", ".", "junit", ".", "After", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "slf4j", ".", "MDC", ";", "import", "org", ".", "slf4j", ".", "ext", ".", "EventData", ";", "import", "org", ".", "slf4j", ".", "ext", ".", "EventLogger", ";", "public", "class", "EventLoggerTest", "{", "ListAppender", "listAppender", ";", "org", ".", "apache", ".", "log4j", ".", "Logger", "log4", ";", "final", "static", "String", "EXPECTED_FILE_NAME", "=", "\"", "EventLoggerTest", ".", "java", "\"", ";", "@", "Before", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "/", "/", "start", "from", "a", "clean", "slate", "for", "each", "test", "listAppender", "=", "new", "ListAppender", "(", ");", "listAppender", ".", "extractLocationInfo", "=", "true", ";", "org", ".", "apache", ".", "log4j", ".", "Logger", "eventLogger", "=", "org", ".", "apache", ".", "log4j", ".", "Logger", ".", "getLogger", "(", "\"", "EventLogger", "\"", ");", "eventLogger", ".", "addAppender", "(", "listAppender", ")", ";", "eventLogger", ".", "setLevel", "(", "org", ".", "apache", ".", "log4j", ".", "Level", ".", "TRACE", ")", ";", "eventLogger", ".", "setAdditivity", "(", "false", ")", ";", "/", "/", "Items", "that", "apply", "to", "any", "activity", "MDC", ".", "put", "(", "\"", "ipAddress", "\"", ",", "\"", "192", ".", "168", ".", "1", ".", "110", "\"", ");", "MDC", ".", "put", "(", "\"", "login", "\"", ",", "\"", "TestUSer", "\"", ");", "MDC", ".", "put", "(", "\"", "hostname", "\"", ",", "\"", "localhost", "\"", ");", "MDC", ".", "put", "(", "\"", "productName", "\"", ",", "\"", "SLF4J", "\"", ");", "MDC", ".", "put", "(", "\"", "locale", "\"", ",", "Locale", ".", "getDefault", "(", ").", "getDisplayName", "(", "))", ";", "MDC", ".", "put", "(", "\"", "timezone", "\"", ",", "TimeZone", ".", "getDefault", "(", ").", "getDisplayName", "(", "))", ";", "}", "@", "After", "public", "void", "tearDown", "(", ")", "throws", "Exception", "{", "MDC", ".", "clear", "(", ");", "}", "void", "verify", "(", "LoggingEvent", "le", ",", "String", "expectedMsg", ")", "{", "assertEquals", "(", "expectedMsg", ",", "le", ".", "getMessage", "(", "))", ";", "assertEquals", "(", "EXPECTED_FILE_NAME", ",", "le", ".", "getLocationInformation", "(", ").", "getFileName", "(", "))", ";", "}", "@", "Test", "public", "void", "testEventLogger", "(", ")", "{", "EventData", "data", "[", "]", "=", "new", "EventData", "[", "2", "]", ";", "data", "[", "0", "]", "=", "new", "EventData", "(", ");", "data", "[", "0", "]", ".", "setEventType", "(", "\"", "Login", "\"", ");", "data", "[", "0", "]", ".", "setEventId", "(", "\"", "1", "\"", ");", "data", "[", "0", "]", ".", "setEventDateTime", "(", "new", "Date", "(", "))", ";", "data", "[", "0", "]", ".", "put", "(", "\"", "Userid", "\"", ",", "\"", "TestUser", "\"", ");", "EventLogger", ".", "logEvent", "(", "data", "[", "0", "]", ");", "data", "[", "1", "]", "=", "new", "EventData", "(", ");", "data", "[", "1", "]", ".", "setEventType", "(", "\"", "Update", "\"", ");", "data", "[", "1", "]", ".", "setEventId", "(", "\"", "2", "\"", ");", "data", "[", "1", "]", ".", "setEventDateTime", "(", "new", "Date", "(", "))", ";", "data", "[", "1", "]", ".", "put", "(", "\"", "FileName", "\"", ",", "\"", "/", "etc", "/", "hosts", "\"", ");", "EventLogger", ".", "logEvent", "(", "data", "[", "1", "]", ");", "assertEquals", "(", "2", ",", "listAppender", ".", "list", ".", "size", "(", "))", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "2", ";", "+", "+", "i", ")", "{", "LoggingEvent", "event", "=", "listAppender", ".", "list", ".", "get", "(", "i", ")", ";", "verify", "(", "event", ",", "data", "[", "i", "]", ".", "toXML", "(", "))", ";", "LocationInfo", "li", "=", "event", ".", "getLocationInformation", "(", ");", "assertEquals", "(", "this", ".", "getClass", "(", ").", "getName", "(", "),", "li", ".", "getClassName", "(", "))", ";", "assertEquals", "(", "event", ".", "getMDC", "(", "\"", "hostname", "\"", "),", "\"", "localhost", "\"", ");", "}", "}", "}", "/", "**", "*", "Copyright", "(", "c", ")", "2004", "-", "2011", "QOS", ".", "ch", "*", "All", "rights", "reserved", ".", "*", "*", "Permission", "is", "hereby", "granted", ",", "free", "of", "charge", ",", "to", "any", "person", "obtaining", "*", "a", "copy", "of", "this", "software", "and", "associated", "documentation", "files", "(", "the", "*", "\"", "Software", "\"", "),", "to", "deal", "in", "the", "Software", "without", "restriction", ",", "including", "*", "without", "limitation", "the", "rights", "to", "use", ",", "copy", ",", "modify", ",", "merge", ",", "publish", ",", "*", "distribute", ",", "sublicense", ",", "and", "/", "or", "sell", "copies", "of", "the", "Software", ",", "and", "to", "*", "permit", "persons", "to", "whom", "the", "Software", "is", "furnished", "to", "do", "so", ",", "subject", "to", "*", "the", "following", "conditions", ":", "*", "*", "The", "above", "copyright", "notice", "and", "this", "permission", "notice", "shall", "be", "*", "included", "in", "all", "copies", "or", "substantial", "portions", "of", "the", "Software", ".", "*", "*", "THE", "SOFTWARE", "IS", "PROVIDED", "\"", "AS", "IS", "\"", ",", "WITHOUT", "WARRANTY", "OF", "ANY", "KIND", ",", "*", "EXPRESS", "OR", "IMPLIED", ",", "INCLUDING", "BUT", "NOT", "LIMITED", "TO", "THE", "WARRANTIES", "OF", "*", "MERCHANTABILITY", ",", "FITNESS", "FOR", "A", "PARTICULAR", "PURPOSE", "AND", "*", "NONINFRINGEMENT", ".", "IN", "NO", "EVENT", "SHALL", "THE", "AUTHORS", "OR", "COPYRIGHT", "HOLDERS", "BE", "*", "LIABLE", "FOR", "ANY", "CLAIM", ",", "DAMAGES", "OR", "OTHER", "LIABILITY", ",", "WHETHER", "IN", "AN", "ACTION", "*", "OF", "CONTRACT", ",", "TORT", "OR", "OTHERWISE", ",", "ARISING", "FROM", ",", "OUT", "OF", "OR", "IN", "CONNECTION", "*", "WITH", "THE", "SOFTWARE", "OR", "THE", "USE", "OR", "OTHER", "DEALINGS", "IN", "THE", "SOFTWARE", ".", "*", "*", "/", "package", "org", ".", "slf4j", ".", "dummyExt", ";", "import", "static", "org", ".", "junit", ".", "Assert", ".", "assertEquals", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "org", ".", "slf4j", ".", "MDC", ";", "import", "org", ".", "slf4j", ".", "ext", ".", "MDCStrLookup", ";", "public", "class", "MDCStrLookupTest", "{", "@", "Test", "public", "void", "testLookup", "(", ")", "throws", "Exception", "{", "MDC", ".", "put", "(", "\"", "key", "\"", ",", "\"", "value", "\"", ");", "MDC", ".", "put", "(", "\"", "number", "\"", ",", "\"", "2", "\"", ");", "MDCStrLookup", "lookup", "=", "new", "MDCStrLookup", "(", ");", "assertEquals", "(", "\"", "value", "\"", ",", "lookup", ".", "lookup", "(", "\"", "key", "\"", "))", ";", "assertEquals", "(", "\"", "2", "\"", ",", "lookup", ".", "lookup", "(", "\"", "number", "\"", "))", ";", "assertEquals", "(", "null", ",", "lookup", ".", "lookup", "(", "null", ")", ");", "assertEquals", "(", "null", ",", "lookup", ".", "lookup", "(", "\"\"", "))", ";", "assertEquals", "(", "null", ",", "lookup", ".", "lookup", "(", "\"", "other", "\"", "))", ";", "}", "}", "@", "@", "-", "29", ",", "6", "+", "29", ",", "6", "@", "@", "@", "SuiteClasses", "(", "{", "MDCStrLookupTest", ".", "class", ",", "XLoggerTest", ".", "class", ",", "EventLoggerTest", ".", "class", "}", ")", "listAppender", "=", "new", "ListAppender", "(", ");", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "version", ">", "1", ".", "8", ".", "0", "-", "beta3", "-", "SNAPSHOT", "<", "/", "version", ">", "<", "h3", ">", "2018", "-", "Release", "of", "SLF4J", "1", ".", "8", ".", "0", "-", "beta3", "<", "/", "h3", ">"], "docstring_tokens": ["bypass", "intended", "access", "restrictions"]}
{"contents": ["empty"], "code_tokens": ["struct", "mutex", "user_ctl_lock", ";", "/", "*", "protects", "user", "controls", "against", "concurrent", "access", "*", "/", "struct", "snd_card", "*", "card", ";", "mutex_lock", "(", "&", "ue", "-", ">", "card", "-", ">", "user_ctl_lock", ")", ";", "mutex_unlock", "(", "&", "ue", "-", ">", "card", "-", ">", "user_ctl_lock", ")", ";", "mutex_lock", "(", "&", "ue", "-", ">", "card", "-", ">", "user_ctl_lock", ")", ";", "mutex_unlock", "(", "&", "ue", "-", ">", "card", "-", ">", "user_ctl_lock", ")", ";", "mutex_lock", "(", "&", "ue", "-", ">", "card", "-", ">", "user_ctl_lock", ")", ";", "mutex_unlock", "(", "&", "ue", "-", ">", "card", "-", ">", "user_ctl_lock", ")", ";", "int", "ret", "=", "0", ";", "mutex_lock", "(", "&", "ue", "-", ">", "card", "-", ">", "user_ctl_lock", ")", ";", "if", "(", "!", "ue", "-", ">", "tlv_data_size", "|", "|", "!", "ue", "-", ">", "tlv_data", ")", "{", "ret", "=", "-", "ENXIO", ";", "goto", "err_unlock", ";", "}", "if", "(", "size", "<", "ue", "-", ">", "tlv_data_size", ")", "{", "ret", "=", "-", "ENOSPC", ";", "goto", "err_unlock", ";", "}", "ret", "=", "-", "EFAULT", ";", "err_unlock", ":", "mutex_unlock", "(", "&", "ue", "-", ">", "card", "-", ">", "user_ctl_lock", ")", ";", "if", "(", "ret", ")", "return", "ret", ";", "ue", "-", ">", "card", "=", "card", ";", "mutex_init", "(", "&", "card", "-", ">", "user_ctl_lock", ")", ";</s>if", "(", "!", "ue", "-", ">", "tlv_data_size", "|", "|", "!", "ue", "-", ">", "tlv_data", ")", "return", "-", "ENXIO", ";", "if", "(", "size", "<", "ue", "-", ">", "tlv_data_size", ")", "return", "-", "ENOSPC", ";", "return", "-", "EFAULT", ";"], "docstring_tokens": ["obtain", "sensitive", "information", "from", "kernel", "memory"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "If", "we", "'", "re", "limited", ",", "always", "leave", "two", "wakeup", "worth", "'", "s", "BITS", "*", "/", "int", "bytes", "=", "nbytes", ";", "/", "*", "pull", "at", "least", "as", "many", "as", "BYTES", "as", "wakeup", "BITS", "*", "/", "bytes", "=", "max_t", "(", "int", ",", "bytes", ",", "random_read_wakeup_thresh", "/", "8", ")", ";", "/", "*", "but", "never", "more", "than", "the", "buffer", "size", "*", "/", "bytes", "=", "min_t", "(", "int", ",", "bytes", ",", "sizeof", "(", "tmp", ")", ");</s>int", "bytes", "=", "max_t", "(", "int", ",", "random_read_wakeup_thresh", "/", "8", ",", "min_t", "(", "int", ",", "nbytes", ",", "sizeof", "(", "tmp", ")", "))", ";"], "docstring_tokens": ["overflow", "a", "buffer", "and", "execute", "arbitrary", "code", "on", "the", "system", "with", "elevated", "privileges", "or", "cause", "the", "system", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["import", "java", ".", "util", ".", "ArrayList", ";", "import", "javax", ".", "lang", ".", "model", ".", "SourceVersion", ";", "import", "org", ".", "springframework", ".", "beans", ".", "BeanWrapperImpl", ";", "import", "org", ".", "springframework", ".", "beans", ".", "PropertyAccessorUtils", ";", "if", "(", "expressionParser", "instanceof", "BeanWrapperExpressionParser", "|", "|", "checkModelProperty", "(", "parameter", ",", "model", ")", ")", "{", "Expression", "target", "=", "expressionParser", ".", "parseExpression", "(", "parameter", ",", "parserContext", ")", ";", "DefaultMapping", "mapping", "=", "new", "DefaultMapping", "(", "source", ",", "target", ")", ";", "if", "(", "logger", ".", "isDebugEnabled", "(", "))", "{", "logger", ".", "debug", "(", "\"", "Adding", "default", "mapping", "for", "parameter", "'", "\"", "+", "parameter", "+", "\"", "'\"", ");", "}", "mapper", ".", "addMapping", "(", "mapping", ")", ";", "}", "/", "**", "*", "Perform", "basic", "checks", "on", "the", "given", "expression", "to", "see", "if", "it", "looks", "like", "a", "property", "path", ".", "*", "Check", "if", "the", "top", "nested", "property", "is", "a", "readable", "property", "on", "the", "Model", ".", "*", "Check", "if", "the", "remaining", "nested", "properties", "are", "valid", "Java", "identifiers", ".", "*", "/", "private", "boolean", "checkModelProperty", "(", "String", "expression", ",", "Object", "model", ")", "{", "List", "<", "String", ">", "propertyNames", "=", "new", "ArrayList", "<", "String", ">", "()", ";", "while", "(", "true", ")", "{", "int", "index", "=", "PropertyAccessorUtils", ".", "getFirstNestedPropertySeparatorIndex", "(", "expression", ")", ";", "String", "nestedProperty", "=", "index", "!", "=", "-", "1", "?", "expression", ".", "substring", "(", "0", ",", "index", ")", ":", "expression", ";", "nestedProperty", "=", "PropertyAccessorUtils", ".", "getPropertyName", "(", "nestedProperty", ")", ";", "propertyNames", ".", "add", "(", "nestedProperty", ")", ";", "if", "(", "index", "=", "=", "-", "1", ")", "{", "break", ";", "}", "if", "(", "expression", ".", "length", "(", ")", "=", "=", "index", "+", "1", ")", "{", "return", "false", ";", "}", "expression", "=", "expression", ".", "substring", "(", "index", "+", "1", ")", ";", "}", "BeanWrapperImpl", "beanWrapper", "=", "new", "BeanWrapperImpl", "(", "model", ")", ";", "if", "(", "!", "beanWrapper", ".", "isReadableProperty", "(", "propertyNames", ".", "get", "(", "0", ")", "))", "{", "return", "false", ";", "}", "for", "(", "int", "i", "=", "0", ";", "i", "<", "propertyNames", ".", "size", "(", ");", "i", "+", "+)", "{", "if", "(", "!", "SourceVersion", ".", "isName", "(", "propertyNames", ".", "get", "(", "i", ")", "))", "{", "return", "false", ";", "}", "}", "return", "true", ";</s>Expression", "target", "=", "expressionParser", ".", "parseExpression", "(", "parameter", ",", "parserContext", ")", ";", "DefaultMapping", "mapping", "=", "new", "DefaultMapping", "(", "source", ",", "target", ")", ";", "if", "(", "logger", ".", "isDebugEnabled", "(", "))", "{", "logger", ".", "debug", "(", "\"", "Adding", "default", "mapping", "for", "parameter", "'", "\"", "+", "parameter", "+", "\"", "'\"", ");", "mapper", ".", "addMapping", "(", "mapping", ")", ";"], "docstring_tokens": ["launch", "further", "attacks", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["/", "/", "[", "databind", "#", "2052", "]", ":", "Jodd", "-", "db", ",", "with", "jndi", "/", "ldap", "lookup", "s", ".", "add", "(", "\"", "jodd", ".", "db", ".", "connection", ".", "DataSourceConnectionProvider", "\"", ");", "/", "/", "[", "databind", "#", "2058", "]", ":", "Oracle", "JDBC", "driver", ",", "with", "jndi", "/", "ldap", "lookup", "s", ".", "add", "(", "\"", "oracle", ".", "jdbc", ".", "connector", ".", "OracleManagedConnectionFactory", "\"", ");", "s", ".", "add", "(", "\"", "oracle", ".", "jdbc", ".", "rowset", ".", "OracleJDBCRowSet", "\"", ");</s>"], "docstring_tokens": ["take", "control", "of", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "BN_is_zero", "(", "dh", "-", ">", "p", ")", ")", "{", "SSLerr", "(", "SSL_F_SSL3_GET_KEY_EXCHANGE", ",", "SSL_R_BAD_DH_P_VALUE", ")", ";", "goto", "f_err", ";", "}", "if", "(", "BN_is_zero", "(", "dh", "-", ">", "g", ")", ")", "{", "SSLerr", "(", "SSL_F_SSL3_GET_KEY_EXCHANGE", ",", "SSL_R_BAD_DH_G_VALUE", ")", ";", "goto", "f_err", ";", "}", "if", "(", "BN_is_zero", "(", "dh", "-", ">", "pub_key", ")", ")", "{", "SSLerr", "(", "SSL_F_SSL3_GET_KEY_EXCHANGE", ",", "SSL_R_BAD_DH_PUB_KEY_VALUE", ")", ";", "goto", "f_err", ";", "}", "#", "define", "SSL_R_BAD_DH_G_VALUE", "375", "#", "define", "SSL_R_BAD_DH_PUB_KEY_VALUE", "393", "#", "define", "SSL_R_BAD_DH_P_VALUE", "395", "{", "ERR_REASON", "(", "SSL_R_BAD_DH_G_VALUE", ")", ",", "\"", "bad", "dh", "g", "value", "\"", "},", "{", "ERR_REASON", "(", "SSL_R_BAD_DH_PUB_KEY_VALUE", ")", ",", "\"", "bad", "dh", "pub", "key", "value", "\"", "},", "{", "ERR_REASON", "(", "SSL_R_BAD_DH_P_VALUE", ")", ",", "\"", "bad", "dh", "p", "value", "\"", "},</s>"], "docstring_tokens": ["trigger", "a", "segfault", "and", "cause", "a", "denial", "of", "service"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "byte_count", ">", "IFDlength", "|", "|", "offset_val", ">", "IFDlength", "-", "byte_count", "|", "|", "value_ptr", "<", "dir_entry", ")", "{", "if", "(", "byte_count", ">", "ImageInfo", "-", ">", "FileSize", "|", "|", "offset_val", ">", "ImageInfo", "-", ">", "FileSize", "-", "byte_count", "|", "|", "(", "ImageInfo", "-", ">", "FileType", "!", "=", "IMAGE_FILETYPE_TIFF_II", "&", "&", "ImageInfo", "-", ">", "FileType", "!", "=", "IMAGE_FILETYPE_TIFF_MM", "&", "&", "ImageInfo", "-", ">", "FileType", "!", "=", "IMAGE_FILETYPE_JPEG", ")", ")", "{", "-", "-", "TEST", "-", "-", "Bug", "#", "34704", "(", "Integer", "overflow", "during", "the", "parsing", "of", "invalid", "exif", "header", ")", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "'", "exif", "'", "))", "print", "'", "skip", "exif", "extension", "not", "available", "'", ";?", ">", "-", "-", "INI", "-", "-", "output_handler", "=", "zlib", ".", "output_compression", "=", "0", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "infile", "=", "dirname", "(", "__FILE__", ")", ".'", "/", "bug60150", ".", "jpg", "'", ";", "var_dump", "(", "exif_read_data", "(", "$", "infile", ")", ");", "?", ">", "=", "==", "DONE", "=", "==", "-", "-", "EXPECTF", "-", "-", "Warning", ":", "exif_read_data", "(", "bug60150", ".", "jpg", ")", ":", "Process", "tag", "(", "x9003", "=", "DateTimeOri", ")", ":", "Illegal", "pointer", "offset", "(", "x", "%", "x", "+", "x", "%", "x", "=", "x", "%", "x", ">", "x", "%", "x", ")", "in", "%", "s", "on", "line", "%", "d", "Warning", ":", "exif_read_data", "(", "bug60150", ".", "jpg", ")", ":", "Error", "reading", "from", "file", ":", "got", "=", "x", "%", "x", "(", "=%", "d", ")", "!", "=", "itemlen", "-", "%", "d", "=", "x", "%", "x", "(", "=%", "d", ")", "in", "%", "s", "on", "line", "%", "d", "Warning", ":", "exif_read_data", "(", "bug60150", ".", "jpg", ")", ":", "Invalid", "JPEG", "file", "in", "%", "s", "on", "line", "%", "d", "bool", "(", "false", ")", "=", "==", "DONE", "=", "==</s>if", "(", "offset_val", "+", "byte_count", ">", "IFDlength", "|", "|", "value_ptr", "<", "dir_entry", ")", "{", "if", "(", "offset_val", "+", "byte_count", ">", "ImageInfo", "-", ">", "FileSize", "|", "|", "(", "ImageInfo", "-", ">", "FileType", "!", "=", "IMAGE_FILETYPE_TIFF_II", "&", "&", "ImageInfo", "-", ">", "FileType", "!", "=", "IMAGE_FILETYPE_TIFF_MM", "&", "&", "ImageInfo", "-", ">", "FileType", "!", "=", "IMAGE_FILETYPE_JPEG", ")", ")", "{"], "docstring_tokens": ["read", "the", "contents", "of", "arbitrary", "memory", "locations", "or", "cause", "a", "denial", "of", "service"]}
{"contents": ["empty"], "code_tokens": ["Starting", "with", "version", "1", ".", "6", ".", "1", "URL", "repositories", "with", "`", "http", ":", "`,", "`", "https", ":", "`,", "and", "`", "ftp", ":", "`", "URLs", "has", "to", "be", "whitelisted", "by", "specifying", "allowed", "URLs", "in", "the", "`", "repositories", ".", "url", ".", "allowed_urls", "`", "setting", ".", "This", "setting", "supports", "wildcards", "in", "the", "place", "of", "host", ",", "path", ",", "query", ",", "and", "fragment", ".", "For", "example", ":", "[", "source", ",", "yaml", "]", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "repositories", ".", "url", ".", "allowed_urls", ":", "[", "\"", "http", ":", "//", "www", ".", "example", ".", "org", "/", "root", "/", "*\"", ",", "\"", "https", ":", "//", "*.", "mydomain", ".", "com", "/", "*?", "*#", "*\"", "]", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "@", "@", "-", "122", ",", "6", "+", "122", ",", "19", "@", "@", "point", "to", "the", "root", "of", "the", "shared", "filesystem", "repository", ".", "The", "following", "settings", "ar", "URL", "Repository", "supports", "the", "following", "protocols", ":", "\"", "http", "\"", ",", "\"", "https", "\"", ",", "\"", "ftp", "\"", ",", "\"", "file", "\"", "and", "\"", "jar", "\"", ".", "URL", "repositories", "with", "`", "http", ":", "`,", "`", "https", ":", "`,", "and", "`", "ftp", ":", "`", "URLs", "has", "to", "be", "whitelisted", "by", "specifying", "allowed", "URLs", "in", "the", "`", "repositories", ".", "url", ".", "allowed_urls", "`", "setting", ".", "This", "setting", "supports", "wildcards", "in", "the", "place", "of", "host", ",", "path", ",", "query", ",", "and", "fragment", ".", "For", "example", ":", "[", "source", ",", "yaml", "]", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "repositories", ".", "url", ".", "allowed_urls", ":", "[", "\"", "http", ":", "//", "www", ".", "example", ".", "org", "/", "root", "/", "*\"", ",", "\"", "https", ":", "//", "*.", "mydomain", ".", "com", "/", "*?", "*#", "*\"", "]", "-", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "--", "URL", "repositories", "with", "`", "file", ":", "`", "URLs", "can", "only", "point", "to", "locations", "registered", "in", "the", "`", "repo", ".", "path", "`", "setting", "similiar", "to", "shared", "file", "system", "repository", ".", "/", "*", "*", "Licensed", "to", "Elasticsearch", "under", "one", "or", "more", "contributor", "*", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "*", "ownership", ".", "Elasticsearch", "licenses", "this", "file", "to", "you", "under", "*", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "you", "may", "*", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "*", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "*", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "*", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "*", "specific", "language", "governing", "permissions", "and", "limitations", "*", "under", "the", "License", ".", "*", "/", "package", "org", ".", "elasticsearch", ".", "common", ".", "util", ";", "import", "org", ".", "elasticsearch", ".", "common", ".", "regex", ".", "Regex", ";", "import", "java", ".", "net", ".", "URI", ";", "import", "java", ".", "net", ".", "URISyntaxException", ";", "/", "**", "*", "URI", "Pattern", "matcher", "*", "*", "The", "pattern", "is", "URI", "in", "which", "authority", ",", "path", ",", "query", "and", "fragment", "can", "be", "replace", "with", "simple", "pattern", ".", "*", "*", "For", "example", ":", "foobar", ":", "//", "*.", "local", "/", "some_path", "/", "*?", "*#", "*", "will", "match", "all", "uris", "with", "schema", "foobar", "in", "local", "domain", "*", "with", "any", "port", ",", "with", "path", "that", "starts", "some_path", "and", "with", "any", "query", "and", "fragment", ".", "*", "/", "public", "class", "URIPattern", "{", "private", "final", "URI", "uriPattern", ";", "/", "**", "*", "Constructs", "uri", "pattern", "*", "@", "param", "pattern", "*", "/", "public", "URIPattern", "(", "String", "pattern", ")", "{", "try", "{", "uriPattern", "=", "new", "URI", "(", "pattern", ")", ";", "}", "catch", "(", "URISyntaxException", "ex", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "cannot", "parse", "URI", "pattern", "[", "\"", "+", "pattern", "+", "\"", "]\"", ");", "}", "}", "/", "**", "*", "Returns", "true", "if", "the", "given", "uri", "matches", "the", "pattern", "*", "/", "public", "boolean", "match", "(", "URI", "uri", ")", "{", "return", "matchNormalized", "(", "uri", ".", "normalize", "(", "))", ";", "}", "public", "static", "boolean", "match", "(", "URIPattern", "[", "]", "patterns", ",", "URI", "uri", ")", "{", "URI", "normalized", "=", "uri", ".", "normalize", "(", ");", "for", "(", "URIPattern", "pattern", ":", "patterns", ")", "{", "if", "(", "pattern", ".", "matchNormalized", "(", "normalized", ")", ")", "{", "return", "true", ";", "}", "}", "return", "false", ";", "}", "private", "boolean", "matchNormalized", "(", "URI", "uri", ")", "{", "if", "(", "uriPattern", ".", "isOpaque", "(", "))", "{", "/", "/", "This", "url", "only", "has", "scheme", ",", "scheme", "-", "specific", "part", "and", "fragment", "return", "uri", ".", "isOpaque", "(", ")", "&", "&", "match", "(", "uriPattern", ".", "getScheme", "(", "),", "uri", ".", "getScheme", "(", "))", "&", "&", "match", "(", "uriPattern", ".", "getSchemeSpecificPart", "(", "),", "uri", ".", "getSchemeSpecificPart", "(", "))", "&", "&", "match", "(", "uriPattern", ".", "getFragment", "(", "),", "uri", ".", "getFragment", "(", "))", ";", "}", "else", "{", "return", "match", "(", "uriPattern", ".", "getScheme", "(", "),", "uri", ".", "getScheme", "(", "))", "&", "&", "match", "(", "uriPattern", ".", "getAuthority", "(", "),", "uri", ".", "getAuthority", "(", "))", "&", "&", "match", "(", "uriPattern", ".", "getQuery", "(", "),", "uri", ".", "getQuery", "(", "))", "&", "&", "match", "(", "uriPattern", ".", "getPath", "(", "),", "uri", ".", "getPath", "(", "))", "&", "&", "match", "(", "uriPattern", ".", "getFragment", "(", "),", "uri", ".", "getFragment", "(", "))", ";", "}", "}", "private", "boolean", "match", "(", "String", "pattern", ",", "String", "value", ")", "{", "if", "(", "value", "=", "=", "null", ")", "{", "/", "/", "If", "the", "pattern", "is", "empty", "or", "matches", "anything", "-", "it", "'", "s", "a", "match", "if", "(", "pattern", "=", "=", "null", "|", "|", "Regex", ".", "isMatchAllPattern", "(", "pattern", ")", ")", "{", "return", "true", ";", "}", "}", "return", "Regex", ".", "simpleMatch", "(", "pattern", ",", "value", ")", ";", "}", "@", "Override", "public", "String", "toString", "(", ")", "{", "return", "uriPattern", ".", "toString", "(", ");", "}", "}", "@", "@", "-", "29", ",", "8", "+", "29", ",", "11", "@", "@", "import", "java", ".", "net", ".", "URI", ";", "import", "java", ".", "net", ".", "URISyntaxException", ";", "import", "java", ".", "nio", ".", "file", ".", "Paths", ";", "/", "**", "*", "Checks", "if", "the", "specified", "URL", "is", "pointing", "to", "the", "local", "file", "system", "and", "if", "it", "does", ",", "resolves", "the", "specified", "url", "*", "against", "the", "list", "of", "configured", "repository", "roots", "*", "*", "If", "the", "specified", "url", "doesn", "'", "t", "match", "any", "of", "the", "roots", ",", "returns", "null", ".", "*", "/", "public", "URL", "resolveRepoURL", "(", "URL", "url", ")", "{", "try", "{", "if", "(", "\"", "file", "\"", ".", "equalsIgnoreCase", "(", "url", ".", "getProtocol", "(", "))", ")", "{", "if", "(", "url", ".", "getHost", "(", ")", "=", "=", "null", "|", "|", "\"", "\".", "equals", "(", "url", ".", "getHost", "(", "))", ")", "{", "/", "/", "only", "local", "file", "urls", "are", "supported", "File", "file", "=", "resolve", "(", "repoFiles", ",", "url", ".", "toURI", "(", "))", ";", "if", "(", "file", "=", "=", "null", ")", "{", "/", "/", "Couldn", "'", "t", "resolve", "against", "known", "repo", "locations", "return", "null", ";", "}", "/", "/", "Normalize", "URL", "return", "file", ".", "toURI", "(", ").", "toURL", "(", ");", "}", "return", "null", ";", "}", "else", "if", "(", "\"", "jar", "\"", ".", "equals", "(", "url", ".", "getProtocol", "(", "))", ")", "{", "String", "file", "=", "url", ".", "toURI", "(", ").", "getSchemeSpecificPart", "(", ");", "int", "pos", "=", "file", ".", "indexOf", "(", "\"!", "/\"", ");", "if", "(", "pos", "<", "0", ")", "{", "return", "null", ";", "}", "String", "jarTail", "=", "file", ".", "substring", "(", "pos", ")", ";", "String", "filePath", "=", "file", ".", "substring", "(", "0", ",", "pos", ")", ";", "URL", "internalUrl", "=", "new", "URL", "(", "filePath", ")", ";", "URL", "normalizedUrl", "=", "resolveRepoURL", "(", "internalUrl", ")", ";", "if", "(", "normalizedUrl", "=", "=", "null", ")", "{", "return", "null", ";", "}", "return", "new", "URL", "(", "\"", "jar", "\"", ",", "\"", "\",", "normalizedUrl", ".", "toExternalForm", "(", ")", "+", "jarTail", ")", ";", "}", "else", "{", "/", "/", "It", "'", "s", "not", "file", "or", "jar", "url", "and", "it", "didn", "'", "t", "match", "the", "white", "list", "-", "reject", "return", "null", ";", "}", "}", "catch", "(", "MalformedURLException", "ex", ")", "{", "/", "/", "cannot", "make", "sense", "of", "this", "file", "url", "return", "null", ";", "}", "catch", "(", "URISyntaxException", "ex", ")", "{", "return", "null", ";", "}", "}", "/", "**", "*", "Tries", "to", "resolve", "the", "given", "path", "against", "the", "list", "of", "available", "roots", ".", "*", "*", "If", "path", "starts", "with", "one", "of", "the", "listed", "roots", ",", "it", "returned", "back", "by", "this", "method", ",", "otherwise", "null", "is", "returned", ".", "*", "/", "public", "static", "File", "resolve", "(", "File", "[", "]", "roots", ",", "URI", "uri", ")", "{", "return", "resolve", "(", "roots", ",", "Paths", ".", "get", "(", "uri", ")", ".", "normalize", "(", ").", "toString", "(", "))", ";", "}", "import", "org", ".", "elasticsearch", ".", "common", ".", "Strings", ";", "import", "org", ".", "elasticsearch", ".", "common", ".", "util", ".", "URIPattern", ";", "import", "org", ".", "elasticsearch", ".", "env", ".", "Environment", ";", "import", "java", ".", "net", ".", "URISyntaxException", ";", "public", "final", "static", "String", "[", "]", "DEFAULT_SUPPORTED_PROTOCOLS", "=", "{", "\"", "http", "\"", ",", "\"", "https", "\"", ",", "\"", "ftp", "\"", ",", "\"", "file", "\"", ",", "\"", "jar", "\"", "};", "public", "final", "static", "String", "SUPPORTED_PROTOCOLS_SETTING", "=", "\"", "repositories", ".", "url", ".", "supported_protocols", "\"", ";", "public", "final", "static", "String", "ALLOWED_URLS_SETTING", "=", "\"", "repositories", ".", "url", ".", "allowed_urls", "\"", ";", "private", "final", "String", "[", "]", "supportedProtocols", ";", "private", "final", "URIPattern", "[", "]", "urlWhiteList", ";", "private", "final", "Environment", "environment", ";", "public", "URLRepository", "(", "RepositoryName", "name", ",", "RepositorySettings", "repositorySettings", ",", "IndexShardRepository", "indexShardRepository", ",", "Environment", "environment", ")", "throws", "IOException", "{", "supportedProtocols", "=", "settings", ".", "getAsArray", "(", "SUPPORTED_PROTOCOLS_SETTING", ",", "DEFAULT_SUPPORTED_PROTOCOLS", ")", ";", "String", "[", "]", "urlWhiteList", "=", "settings", ".", "getAsArray", "(", "ALLOWED_URLS_SETTING", ",", "Strings", ".", "EMPTY_ARRAY", ")", ";", "this", ".", "urlWhiteList", "=", "new", "URIPattern", "[", "urlWhiteList", ".", "length", "]", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "urlWhiteList", ".", "length", ";", "i", "+", "+)", "{", "this", ".", "urlWhiteList", "[", "i", "]", "=", "new", "URIPattern", "(", "urlWhiteList", "[", "i", "]", ");", "}", "this", ".", "environment", "=", "environment", ";", "URL", "normalizedURL", "=", "checkURL", "(", "url", ")", ";", "blobStore", "=", "new", "URLBlobStore", "(", "componentSettings", ",", "normalizedURL", ")", ";", "/", "**", "*", "Makes", "sure", "that", "the", "url", "is", "white", "listed", "or", "if", "it", "points", "to", "the", "local", "file", "system", "it", "matches", "one", "on", "of", "the", "root", "path", "in", "path", ".", "repo", "*", "/", "private", "URL", "checkURL", "(", "URL", "url", ")", "{", "String", "protocol", "=", "url", ".", "getProtocol", "(", ");", "if", "(", "protocol", "=", "=", "null", ")", "{", "throw", "new", "RepositoryException", "(", "repositoryName", ",", "\"", "unknown", "url", "protocol", "from", "URL", "[", "\"", "+", "url", "+", "\"", "]\"", ");", "}", "for", "(", "String", "supportedProtocol", ":", "supportedProtocols", ")", "{", "if", "(", "supportedProtocol", ".", "equals", "(", "protocol", ")", ")", "{", "try", "{", "if", "(", "URIPattern", ".", "match", "(", "urlWhiteList", ",", "url", ".", "toURI", "(", "))", ")", "{", "/", "/", "URL", "matches", "white", "list", "-", "no", "additional", "processing", "is", "needed", "return", "url", ";", "}", "}", "catch", "(", "URISyntaxException", "ex", ")", "{", "logger", ".", "warn", "(", "\"", "cannot", "parse", "the", "specified", "url", "[", "{}", "]\"", ",", "url", ")", ";", "throw", "new", "RepositoryException", "(", "repositoryName", ",", "\"", "cannot", "parse", "the", "specified", "url", "[", "\"", "+", "url", "+", "\"", "]\"", ");", "}", "/", "/", "We", "didn", "'", "t", "match", "white", "list", "-", "try", "to", "resolve", "against", "repo", ".", "path", "URL", "normalizedUrl", "=", "environment", ".", "resolveRepoURL", "(", "url", ")", ";", "if", "(", "normalizedUrl", "=", "=", "null", ")", "{", "logger", ".", "warn", "(", "\"", "The", "specified", "url", "[", "{}", "]", "doesn", "'", "t", "start", "with", "any", "repository", "paths", "specified", "by", "the", "path", ".", "repo", "setting", ":", "[", "{}", "]", "or", "by", "repositories", ".", "url", ".", "allowed_urls", "setting", ":", "[", "{}", "]", "\"", ",", "url", ",", "environment", ".", "repoFiles", "(", "))", ";", "throw", "new", "RepositoryException", "(", "repositoryName", ",", "\"", "file", "url", "[", "\"", "+", "url", "+", "\"", "]", "doesn", "'", "t", "match", "any", "of", "the", "locations", "specified", "by", "path", ".", "repo", "or", "repositories", ".", "url", ".", "allowed_urls", "\"", ");", "}", "return", "normalizedUrl", ";", "}", "}", "throw", "new", "RepositoryException", "(", "repositoryName", ",", "\"", "unsupported", "url", "protocol", "[", "\"", "+", "protocol", "+", "\"", "]", "from", "URL", "[", "\"", "+", "url", "+", "\"", "]\"", ");", "}", "import", "org", ".", "elasticsearch", ".", "common", ".", "settings", ".", "Settings", ";", "import", "java", ".", "net", ".", "URISyntaxException", ";", "@", "Override", "protected", "Settings", "nodeSettings", "(", "int", "nodeOrdinal", ")", "{", "try", "{", "URI", "repoDirUri", "=", "getClass", "(", ").", "getResource", "(", "\".", "\")", ".", "toURI", "(", ");", "URI", "repoJarPatternUri", "=", "new", "URI", "(", "\"", "jar", ":", "\"", "+", "repoDirUri", ".", "toString", "(", ")", "+", "\"", "*.", "zip", "!", "/", "repo", "/", "\")", ";", "return", "ImmutableSettings", ".", "settingsBuilder", "(", ")", ".", "put", "(", "super", ".", "nodeSettings", "(", "nodeOrdinal", ")", ")", ".", "putArray", "(", "\"", "repositories", ".", "url", ".", "allowed_urls", "\"", ",", "repoJarPatternUri", ".", "toString", "(", "))", ".", "build", "(", ");", "}", "catch", "(", "URISyntaxException", "ex", ")", "{", "throw", "new", "IllegalArgumentException", "(", "ex", ")", ";", "}", "}", "/", "*", "*", "Licensed", "to", "Elasticsearch", "under", "one", "or", "more", "contributor", "*", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "*", "ownership", ".", "Elasticsearch", "licenses", "this", "file", "to", "you", "under", "*", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "you", "may", "*", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "*", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "*", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "*", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "*", "specific", "language", "governing", "permissions", "and", "limitations", "*", "under", "the", "License", ".", "*", "/", "package", "org", ".", "elasticsearch", ".", "common", ".", "util", ";", "import", "org", ".", "elasticsearch", ".", "test", ".", "ElasticsearchTestCase", ";", "import", "org", ".", "junit", ".", "Test", ";", "import", "java", ".", "net", ".", "URI", ";", "public", "class", "URIPatternTests", "extends", "ElasticsearchTestCase", "{", "@", "Test", "public", "void", "testURIPattern", "(", ")", "throws", "Exception", "{", "assertTrue", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "\")", ".", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "\")", "))", ";", "assertFalse", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "somepath", "\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "\")", "))", ";", "assertTrue", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "somepath", "\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "somepath", "\"", "))", ");", "assertFalse", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "somepath", "\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "somepath", "/", "more", "\"", "))", ");", "assertTrue", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "somepath", "/", "*\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "somepath", "/", "more", "\"", "))", ");", "assertTrue", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "somepath", "/", "*\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "somepath", "/", "more", "/", "andmore", "\"", "))", ");", "assertTrue", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "somepath", "/", "*\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "somepath", "/", "more", "/", "andmore", "/", "..", "/", "bitmore", "\"", "))", ");", "assertFalse", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "somepath", "/", "*\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "somepath", "/", "..", "/", "more", "\"", "))", ");", "assertFalse", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "somepath", "/", "*\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "\")", "))", ";", "assertFalse", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "somepath", "/", "*\"", ").", "match", "(", "new", "URI", "(", "\"", "https", ":", "//", "test", ".", "local", "/", "somepath", "/", "more", "\"", "))", ");", "assertFalse", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "test", ".", "local", ":", "1234", "/", "somepath", "/", "*\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "somepath", "/", "more", "\"", "))", ");", "assertFalse", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "test", ".", "local", ":", "1234", "/", "somepath", "/", "*\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "test", ".", "local", "/", "somepath", "/", "more", "\"", "))", ");", "assertTrue", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "test", ".", "local", ":", "1234", "/", "somepath", "/", "*\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "test", ".", "local", ":", "1234", "/", "somepath", "/", "more", "\"", "))", ");", "assertTrue", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "*.", "local", ":", "1234", "/", "somepath", "/", "*\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "foobar", ".", "local", ":", "1234", "/", "somepath", "/", "more", "\"", "))", ");", "assertFalse", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "*.", "local", ":", "1234", "/", "somepath", "/", "*\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "foobar", ".", "local", ":", "2345", "/", "somepath", "/", "more", "\"", "))", ");", "assertTrue", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "*.", "local", ":", "*/", "somepath", "/", "*\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "foobar", ".", "local", ":", "2345", "/", "somepath", "/", "more", "\"", "))", ");", "assertFalse", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "*.", "local", ":", "*/", "somepath", "/", "*\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "foobar", ".", "local", ":", "2345", "/", "somepath", "/", "more", "?", "par", "=", "val", "\"", "))", ");", "assertTrue", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "*.", "local", ":", "*/", "somepath", "/", "*?", "*\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "foobar", ".", "local", ":", "2345", "/", "somepath", "/", "more", "?", "par", "=", "val", "\"", "))", ");", "assertFalse", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "*.", "local", ":", "*/", "somepath", "/", "*?", "*\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "foobar", ".", "local", ":", "2345", "/", "somepath", "/", "more", "?", "par", "=", "val", "#", "frag", "\"", "))", ");", "assertTrue", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "*.", "local", ":", "*/", "somepath", "/", "*?", "*#", "*\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "foobar", ".", "local", ":", "2345", "/", "somepath", "/", "more", "?", "par", "=", "val", "#", "frag", "\"", "))", ");", "assertTrue", "(", "new", "URIPattern", "(", "\"", "http", ":", "//", "*.", "local", "/", "somepath", "/", "*?", "*#", "*\"", ").", "match", "(", "new", "URI", "(", "\"", "http", ":", "//", "foobar", ".", "local", "/", "somepath", "/", "more", "\"", "))", ");", "}", "}", "@", "@", "-", "25", ",", "8", "+", "25", ",", "10", "@", "@", "import", "java", ".", "net", ".", "URL", ";", "import", "static", "org", ".", "hamcrest", ".", "CoreMatchers", ".", "endsWith", ";", "assertThat", "(", "environment", ".", "resolveRepoURL", "(", "new", "URL", "(", "\"", "file", ":", "//", "/", "test", "/", "repos", "/", "repo1", "\"", "))", ",", "notNullValue", "(", "))", ";", "assertThat", "(", "environment", ".", "resolveRepoURL", "(", "new", "URL", "(", "\"", "file", ":", "/", "test", "/", "repos", "/", "repo1", "\"", "))", ",", "notNullValue", "(", "))", ";", "assertThat", "(", "environment", ".", "resolveRepoURL", "(", "new", "URL", "(", "\"", "file", ":", "//", "test", "/", "repos", "/", "repo1", "\"", "))", ",", "nullValue", "(", "))", ";", "assertThat", "(", "environment", ".", "resolveRepoURL", "(", "new", "URL", "(", "\"", "file", ":", "//", "/", "test", "/", "repos", "/", "..", "/", "repo1", "\"", "))", ",", "nullValue", "(", "))", ";", "assertThat", "(", "environment", ".", "resolveRepoURL", "(", "new", "URL", "(", "\"", "http", ":", "//", "localhost", "/", "test", "/", "\")", "),", "nullValue", "(", "))", ";", "assertThat", "(", "environment", ".", "resolveRepoURL", "(", "new", "URL", "(", "\"", "jar", ":", "file", ":", "//", "/", "test", "/", "repos", "/", "repo1", "!", "/", "repo", "/", "\")", "),", "notNullValue", "(", "))", ";", "assertThat", "(", "environment", ".", "resolveRepoURL", "(", "new", "URL", "(", "\"", "jar", ":", "file", ":", "/", "test", "/", "repos", "/", "repo1", "!", "/", "repo", "/", "\")", "),", "notNullValue", "(", "))", ";", "assertThat", "(", "environment", ".", "resolveRepoURL", "(", "new", "URL", "(", "\"", "jar", ":", "file", ":", "//", "/", "test", "/", "repos", "/", "repo1", "!", "/", "repo", "/", "\")", ").", "toString", "(", "),", "endsWith", "(", "\"", "repo1", "!", "/", "repo", "/", "\")", ");", "assertThat", "(", "environment", ".", "resolveRepoURL", "(", "new", "URL", "(", "\"", "jar", ":", "file", ":", "//", "/", "test", "/", "repos", "/", "..", "/", "repo1", "!", "/", "repo", "/", "\")", "),", "nullValue", "(", "))", ";", "assertThat", "(", "environment", ".", "resolveRepoURL", "(", "new", "URL", "(", "\"", "jar", ":", "http", ":", "//", "localhost", "/", "test", "/", "..", "/", "repo1", "?", "blah", "!", "/", "repo", "/", "\")", "),", "nullValue", "(", "))", ";", "import", "static", "org", ".", "apache", ".", "lucene", ".", "util", ".", "LuceneTestCase", ".", "createTempDir", ";", "logger", ".", "info", "(", "\"-", "->", "trying", "creating", "fs", "repository", "with", "location", "that", "is", "not", "registered", "in", "path", ".", "repo", "setting", "\"", ");", "File", "invalidRepoPath", "=", "newTempDir", "(", ").", "getAbsoluteFile", "(", ");", "String", "location", "=", "invalidRepoPath", ".", "toString", "(", ");", "try", "{", "client", "(", ").", "admin", "(", ").", "cluster", "(", ").", "preparePutRepository", "(", "\"", "test", "-", "repo", "\"", ")", ".", "setType", "(", "\"", "fs", "\"", ").", "setSettings", "(", "ImmutableSettings", ".", "settingsBuilder", "(", ").", "put", "(", "\"", "location", "\"", ",", "location", ")", ")", ".", "get", "(", ");", "fail", "(", "\"", "Shouldn", "'", "t", "be", "here", ".", "Location", "=", "\"", "+", "location", ")", ";", "}", "catch", "(", "RepositoryException", "ex", ")", "{", "assertThat", "(", "ex", ".", "getDetailedMessage", "(", "),", "containsString", "(", "\"", "location", "[", "\"", "+", "location", "+", "\"", "]", "doesn", "'", "t", "match", "any", "of", "the", "locations", "specified", "by", "path", ".", "repo", "\"", "))", ";", "}", "String", "repoUrl", "=", "invalidRepoPath", ".", "toURI", "(", ").", "toURL", "(", ").", "toString", "(", ");", "String", "unsupportedUrl", "=", "repoUrl", ".", "replace", "(", "\"", "file", ":", "/\"", ",", "\"", "netdoc", ":", "/\"", ");", "logger", ".", "info", "(", "\"-", "->", "trying", "creating", "url", "repository", "with", "unsupported", "url", "protocol", "\"", ");", "try", "{", "client", "(", ").", "admin", "(", ").", "cluster", "(", ").", "preparePutRepository", "(", "\"", "test", "-", "repo", "\"", ")", ".", "setType", "(", "\"", "url", "\"", ").", "setSettings", "(", "ImmutableSettings", ".", "settingsBuilder", "(", ").", "put", "(", "\"", "url", "\"", ",", "unsupportedUrl", ")", ")", ".", "get", "(", ");", "fail", "(", "\"", "Shouldn", "'", "t", "be", "here", "\"", ");", "}", "catch", "(", "RepositoryException", "ex", ")", "{", "assertThat", "(", "ex", ".", "getDetailedMessage", "(", "),", "containsString", "(", "\"", "unsupported", "url", "protocol", "[", "netdoc", "]", "\")", ");", "}", "logger", ".", "info", "(", "\"-", "->", "trying", "creating", "url", "repository", "with", "location", "that", "is", "not", "registered", "in", "path", ".", "repo", "setting", "\"", ");", "try", "{", "client", "(", ").", "admin", "(", ").", "cluster", "(", ").", "preparePutRepository", "(", "\"", "test", "-", "repo", "\"", ")", ".", "setType", "(", "\"", "url", "\"", ").", "setSettings", "(", "ImmutableSettings", ".", "settingsBuilder", "(", ").", "put", "(", "\"", "url", "\"", ",", "invalidRepoPath", ".", "toURI", "(", ").", "toURL", "(", "))", ")", ".", "get", "(", ");", "fail", "(", "\"", "Shouldn", "'", "t", "be", "here", "\"", ");", "}", "catch", "(", "RepositoryException", "ex", ")", "{", "assertThat", "(", "ex", ".", "getDetailedMessage", "(", "),", "containsString", "(", "\"", "doesn", "'", "t", "match", "any", "of", "the", "locations", "specified", "by", "path", ".", "repo", "\"", "))", ";", "}", "import", "org", ".", "elasticsearch", ".", "repositories", ".", "uri", ".", "URLRepository", ";", ".", "putArray", "(", "URLRepository", ".", "ALLOWED_URLS_SETTING", ",", "\"", "http", ":", "//", "snapshot", ".", "test", "*", "\")</s>import", "org", ".", "elasticsearch", ".", "threadpool", ".", "ThreadPool", ";", "public", "URLRepository", "(", "RepositoryName", "name", ",", "RepositorySettings", "repositorySettings", ",", "IndexShardRepository", "indexShardRepository", ")", "throws", "IOException", "{", "blobStore", "=", "new", "URLBlobStore", "(", "componentSettings", ",", "url", ")", ";", "import", "com", ".", "carrotsearch", ".", "randomizedtesting", ".", "LifecycleScope", ";"], "docstring_tokens": ["read", "arbitrary", "files", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["const", "zend_encoding", "*", "from", ",", "*", "to", ";", "to", "=", "zend_multibyte_fetch_encoding", "(", "ImageInfo", "-", ">", "encode_unicode", "TSRMLS_CC", ")", ";", "from", "=", "zend_multibyte_fetch_encoding", "(", "decode", "TSRMLS_CC", ")", ";", "if", "(", "!", "to", "|", "|", "!", "from", "|", "|", "zend_multibyte_encoding_converter", "(", "to", ",", "from", "to", "=", "zend_multibyte_fetch_encoding", "(", "ImageInfo", "-", ">", "encode_jis", "TSRMLS_CC", ")", ";", "from", "=", "zend_multibyte_fetch_encoding", "(", "ImageInfo", "-", ">", "motorola_intel", "?", "ImageInfo", "-", ">", "decode_jis_be", ":", "ImageInfo", "-", ">", "decode_jis_le", "TSRMLS_CC", ")", ";", "if", "(", "!", "to", "|", "|", "!", "from", "|", "|", "zend_multibyte_encoding_converter", "(", "to", ",", "from", "-", "-", "TEST", "-", "-", "Bug", "72618", "(", "NULL", "Pointer", "Dereference", "in", "exif_process_user_comment", ")", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "'", "exif", "'", "))", "print", "'", "skip", "exif", "extension", "not", "available", "'", ";?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "var_dump", "(", "count", "(", "exif_read_data", "(", "dirname", "(", "__FILE__", ")", ".", "\"", "/", "bug72618", ".", "jpg", "\"", "))", ");", "?", ">", "-", "-", "EXPECTF", "-", "-", "Warning", ":", "exif_read_data", "(", "bug72618", ".", "jpg", ")", ":", "IFD", "data", "bad", "offset", ":", "0x058E", "length", "0x0030", "in", "%", "s", "/", "bug72618", ".", "php", "on", "line", "%", "d", "int", "(", "13", ")</s>if", "(", "zend_multibyte_encoding_converter", "(", "zend_multibyte_fetch_encoding", "(", "ImageInfo", "-", ">", "encode_unicode", "TSRMLS_CC", ")", ",", "zend_multibyte_fetch_encoding", "(", "decode", "TSRMLS_CC", ")", "if", "(", "zend_multibyte_encoding_converter", "(", "zend_multibyte_fetch_encoding", "(", "ImageInfo", "-", ">", "encode_jis", "TSRMLS_CC", ")", ",", "zend_multibyte_fetch_encoding", "(", "ImageInfo", "-", ">", "motorola_intel", "?", "ImageInfo", "-", ">", "decode_jis_be", ":", "ImageInfo", "-", ">", "decode_jis_le", "TSRMLS_CC", ")"], "docstring_tokens": ["the", "application", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["&", "&", "(", "mask", "&", "MAY_OPEN", ")", "&", "&", "!", "(", "mask", "&", "MAY_EXEC", ")", ")</s>&", "&", "(", "mask", "&", "MAY_OPEN", ")", ")"], "docstring_tokens": ["bypass", "security", "restrictions", "and", "execute", "scripts", "on", "an", "NFSv4", "share", "without", "supplying", "proper", "credentials"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "pskb_expand_head", "(", "skb_out", ",", "0", ",", "size", "-", "skb_out", "-", ">", "len", ",", "GFP_ATOMIC", ")", "<", "0", ")", "{</s>if", "(", "pskb_expand_head", "(", "skb_out", ",", "0", ",", "size", "-", "skb", "-", ">", "len", ",", "GFP_ATOMIC", ")", "<", "0", ")", "{"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(mesh-node", "system", "crash", ")"]}
{"contents": ["empty"], "code_tokens": ["STD_PHP_INI_ENTRY", "(", "\"", "mbstring", ".", "func_overload", "\"", ",", "\"", "0", "\"", ",", "PHP_INI_SYSTEM", ",", "OnUpdateLong", ",", "func_overload", ",", "zend_mbstring_globals", ",", "mbstring_globals", ")</s>STD_PHP_INI_ENTRY", "(", "\"", "mbstring", ".", "func_overload", "\"", ",", "\"", "0", "\"", ",", "PHP_INI_SYSTEM", "|", "PHP_INI_PERDIR", ",", "OnUpdateLong", ",", "func_overload", ",", "zend_mbstring_globals", ",", "mbstring_globals", ")"], "docstring_tokens": ["modify", "behavior", "of", "other", "sites", "hosted", "on", "the", "same", "web", "server"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "syscall_nr", "<", "0", "|", "|", "syscall_nr", ">", "=", "NR_syscalls", ")", "if", "(", "syscall_nr", "<", "0", "|", "|", "syscall_nr", ">", "=", "NR_syscalls", ")", "if", "(", "syscall_nr", "<", "0", "|", "|", "syscall_nr", ">", "=", "NR_syscalls", ")", "if", "(", "syscall_nr", "<", "0", "|", "|", "syscall_nr", ">", "=", "NR_syscalls", ")</s>if", "(", "syscall_nr", "<", "0", ")", "if", "(", "syscall_nr", "<", "0", ")", "if", "(", "syscall_nr", "<", "0", ")", "if", "(", "syscall_nr", "<", "0", ")"], "docstring_tokens": ["the", "system", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["dm_len", "+", "=", "bfa_port_meminfo", "(", ");", "static", "void", "bfa_com_port_attach", "(", "struct", "bfa_s", "*", "bfa", ",", "struct", "bfa_meminfo_s", "*", "mi", ")", "{", "struct", "bfa_port_s", "*", "port", "=", "&", "bfa", "-", ">", "modules", ".", "port", ";", "uint32_t", "dm_len", ";", "uint8_t", "*", "dm_kva", ";", "uint64_t", "dm_pa", ";", "dm_len", "=", "bfa_port_meminfo", "(", ");", "dm_kva", "=", "bfa_meminfo_dma_virt", "(", "mi", ")", ";", "dm_pa", "=", "bfa_meminfo_dma_phys", "(", "mi", ")", ";", "memset", "(", "port", ",", "0", ",", "sizeof", "(", "struct", "bfa_port_s", ")", ");", "bfa_port_attach", "(", "port", ",", "&", "bfa", "-", ">", "ioc", ",", "bfa", ",", "bfa", "-", ">", "trcmod", ",", "bfa", "-", ">", "logm", ")", ";", "bfa_port_mem_claim", "(", "port", ",", "dm_kva", ",", "dm_pa", ")", ";", "bfa_meminfo_dma_virt", "(", "mi", ")", "=", "dm_kva", "+", "dm_len", ";", "bfa_meminfo_dma_phys", "(", "mi", ")", "=", "dm_pa", "+", "dm_len", ";", "}", "bfa_com_port_attach", "(", "bfa", ",", "meminfo", ")", ";</s>"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(system", "crash", ")"]}
{"contents": ["empty"], "code_tokens": ["\"", ")(", "((", "\\\\", "/{", "0", ",", "1", "}", "([", "a", "-", "z0", "-", "9", "$", "_", "\\", "\\.", "\\\\", "+!", "\\\\", "*\\", "\\'", "\\\\", "(\\", "\\)", ",;", ":@", "&=", "-]", "|%", "[", "0", "-", "9a", "-", "f", "]", "{", "2", "}", ")*", ")*", "\"", "assertFalse", "(", "pattern", ".", "matcher", "(", "\"", "http", ":", "//", "example", ".", "com", "/", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "//", "/?", "?\"", ").", "matches", "(", "))", ";</s>\"", ")(", "((", "\\\\", "/+", "([", "a", "-", "z0", "-", "9", "$", "_", "\\", "\\.", "\\\\", "+!", "\\\\", "*\\", "\\'", "\\\\", "(\\", "\\)", ",;", ":@", "&=", "-]", "|%", "[", "0", "-", "9a", "-", "f", "]", "{", "2", "}", ")*", ")*", "\"", "+"], "docstring_tokens": ["overload", "the", "server", "process"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "uid_eq", "(", "uid", ",", "file", "-", ">", "f_cred", "-", ">", "fsuid", ")", ")", "if", "(", "gid_eq", "(", "gid", ",", "file", "-", ">", "f_cred", "-", ">", "fsgid", ")", ")</s>if", "(", "uid_eq", "(", "uid", ",", "current_fsuid", "(", "))", ")", "if", "(", "gid_eq", "(", "gid", ",", "current_fsgid", "(", "))", ")"], "docstring_tokens": ["gain", "elevated", "privileges", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "year", "<", "1970", "|", "|", "mon", "<", "1", "|", "|", "mon", ">", "12", ")", "goto", "invalid_time", ";", "mon_len", "=", "month_lengths", "[", "mon", "-", "1", "]", ";", "if", "(", "day", "<", "1", "|", "|", "day", ">", "mon_len", "|", "|</s>mon_len", "=", "month_lengths", "[", "mon", "]", ";", "if", "(", "year", "<", "1970", "|", "|", "mon", "<", "1", "|", "|", "mon", ">", "12", "|", "|", "day", "<", "1", "|", "|", "day", ">", "mon_len", "|", "|"], "docstring_tokens": ["obtain", "sensitive", "information"]}
{"contents": ["empty"], "code_tokens": ["eagerfpu", "=", "[", "X86", "]", "on", "enable", "eager", "fpu", "restore", "off", "disable", "eager", "fpu", "restore", "#", "define", "X86_FEATURE_EAGER_FPU", "(", "3", "*", "32", "+", "29", ")", "/", "*", "\"", "eagerfpu", "\"", "Non", "lazy", "FPU", "restore", "*", "/", "#", "define", "cpu_has_eager_fpu", "boot_cpu_has", "(", "X86_FEATURE_EAGER_FPU", ")", "extern", "void", "eager_fpu_init", "(", "void", ")", ";", "static", "__always_inline", "__pure", "bool", "use_eager_fpu", "(", "void", ")", "{", "return", "static_cpu_has", "(", "X86_FEATURE_EAGER_FPU", ")", ";", "}", "static", "inline", "void", "fx_finit", "(", "struct", "i387_fxsave_struct", "*", "fx", ")", "{", "memset", "(", "fx", ",", "0", ",", "xstate_size", ")", ";", "fx", "-", ">", "cwd", "=", "0x37f", ";", "if", "(", "cpu_has_xmm", ")", "fx", "-", ">", "mxcsr", "=", "MXCSR_DEFAULT", ";", "}", "if", "(", "!", "use_eager_fpu", "(", "))", "if", "(", "!", "use_eager_fpu", "(", "))", "if", "(", "!", "use_eager_fpu", "(", "))", "else", "{", "if", "(", "use_xsave", "(", "))", "xrstor_state", "(", "init_xstate_buf", ",", "-", "1", ")", ";", "else", "fxrstor_checking", "(", "&", "init_xstate_buf", "-", ">", "i387", ")", ";", "}", "fpu", ".", "preload", "=", "tsk_used_math", "(", "new", ")", "&", "&", "(", "use_eager_fpu", "(", ")", "|", "|", "}", "else", "if", "(", "!", "use_eager_fpu", "(", "))", "if", "(", "!", "use_eager_fpu", "(", ")", "&", "&", "fpu_lazy_restore", "(", "new", ",", "cpu", ")", ")", "static", "inline", "void", "__save_fpu", "(", "struct", "task_struct", "*", "tsk", ")", "{", "if", "(", "use_xsave", "(", "))", "xsave_state", "(", "&", "tsk", "-", ">", "thread", ".", "fpu", ".", "state", "-", ">", "xsave", ",", "-", "1", ")", ";", "else", "fpu_fxsave", "(", "&", "tsk", "-", ">", "thread", ".", "fpu", ")", ";", "}", "if", "(", "use_eager_fpu", "(", "))", "{", "__save_fpu", "(", "tsk", ")", ";", "if", "(", "use_eager_fpu", "(", "))", "{", "memset", "(", "&", "dst", "-", ">", "thread", ".", "fpu", ".", "state", "-", ">", "xsave", ",", "0", ",", "xstate_size", ")", ";", "__save_fpu", "(", "dst", ")", ";", "*", "For", "now", ",", "with", "eagerfpu", "we", "will", "return", "interrupted", "kernel", "FPU", "*", "state", "as", "not", "-", "idle", ".", "TBD", ":", "Ideally", "we", "can", "change", "the", "return", "value", "if", "(", "use_eager_fpu", "(", "))", "}", "else", "if", "(", "!", "use_eager_fpu", "(", "))", "{", "if", "(", "use_eager_fpu", "(", "))", "xsave_init", "(", ");", "eager_fpu_init", "(", ");", "fx_finit", "(", "&", "fpu", "-", ">", "state", "-", ">", "fxsave", ")", ";", "if", "(", "!", "use_eager_fpu", "(", "))", "BUG_ON", "(", "use_eager_fpu", "(", "))", ";", "if", "(", "use_eager_fpu", "(", "))", "static", "void", "__init", "setup_init_fpu_buf", "(", "void", ")", "fx_finit", "(", "&", "init_xstate_buf", "-", ">", "i387", ")", ";", "if", "(", "!", "cpu_has_xsave", ")", "return", ";", "setup_xstate_features", "(", ");", "static", "int", "disable_eagerfpu", ";", "static", "int", "__init", "eager_fpu_setup", "(", "char", "*", "s", ")", "{", "if", "(", "!", "strcmp", "(", "s", ",", "\"", "on", "\"", "))", "setup_force_cpu_cap", "(", "X86_FEATURE_EAGER_FPU", ")", ";", "else", "if", "(", "!", "strcmp", "(", "s", ",", "\"", "off", "\"", "))", "disable_eagerfpu", "=", "1", ";", "return", "1", ";", "}", "__setup", "(", "\"", "eagerfpu", "=", "\",", "eager_fpu_setup", ")", ";", "setup_init_fpu_buf", "(", ");", "next_func", "=", "xstate_enable", ";", "static", "inline", "void", "__init", "eager_fpu_init_bp", "(", "void", ")", "{", "current", "-", ">", "thread", ".", "fpu", ".", "state", "=", "alloc_bootmem_align", "(", "xstate_size", ",", "__alignof__", "(", "struct", "xsave_struct", ")", ");", "if", "(", "!", "init_xstate_buf", ")", "setup_init_fpu_buf", "(", ");", "}", "void", "__cpuinit", "eager_fpu_init", "(", "void", ")", "{", "static", "__refdata", "void", "(", "*", "boot_func", ")", "(", "void", ")", "=", "eager_fpu_init_bp", ";", "clear_used_math", "(", ");", "current_thread_info", "(", ")-", ">", "status", "=", "0", ";", "if", "(", "!", "cpu_has_eager_fpu", ")", "{", "stts", "(", ");", "return", ";", "}", "if", "(", "boot_func", ")", "{", "boot_func", "(", ");", "boot_func", "=", "NULL", ";", "}", "/", "*", "*", "This", "is", "same", "as", "math_state_restore", "(", ").", "But", "use_xsave", "(", ")", "is", "*", "not", "yet", "patched", "to", "use", "math_state_restore", "(", ").", "*", "/", "init_fpu", "(", "current", ")", ";", "__thread_fpu_begin", "(", "current", ")", ";", "if", "(", "cpu_has_xsave", ")", "xrstor_state", "(", "init_xstate_buf", ",", "-", "1", ")", ";", "else", "fxrstor_checking", "(", "&", "init_xstate_buf", "-", ">", "i387", ")", ";", "}</s>if", "(", "!", "use_xsave", "(", "))", "if", "(", "!", "use_xsave", "(", "))", "if", "(", "!", "use_xsave", "(", "))", "else", "xrstor_state", "(", "init_xstate_buf", ",", "-", "1", ")", ";", "fpu", ".", "preload", "=", "tsk_used_math", "(", "new", ")", "&", "&", "(", "use_xsave", "(", ")", "|", "|", "}", "else", "if", "(", "!", "use_xsave", "(", "))", "if", "(", "!", "use_xsave", "(", ")", "&", "&", "fpu_lazy_restore", "(", "new", ",", "cpu", ")", ")", "if", "(", "use_xsave", "(", "))", "{", "xsave_state", "(", "&", "tsk", "-", ">", "thread", ".", "fpu", ".", "state", "-", ">", "xsave", ",", "-", "1", ")", ";", "if", "(", "use_xsave", "(", "))", "{", "struct", "xsave_struct", "*", "xsave", "=", "&", "dst", "-", ">", "thread", ".", "fpu", ".", "state", "-", ">", "xsave", ";", "memset", "(", "&", "xsave", "-", ">", "xsave_hdr", ",", "0", ",", "sizeof", "(", "struct", "xsave_hdr_struct", ")", ");", "xsave_state", "(", "xsave", ",", "-", "1", ")", ";", "xsave_init", "(", ");", "xsave_init", "(", ");", "*", "For", "now", ",", "on", "xsave", "platforms", "we", "will", "return", "interrupted", "*", "kernel", "FPU", "as", "not", "-", "idle", ".", "TBD", ":", "As", "we", "use", "non", "-", "lazy", "FPU", "restore", "*", "for", "xsave", "platforms", ",", "ideally", "we", "can", "change", "the", "return", "value", "if", "(", "use_xsave", "(", "))", "}", "else", "if", "(", "!", "use_xsave", "(", "))", "{", "if", "(", "use_xsave", "(", "))", "clts", "(", ");", "stts", "(", ");", "/", "*", "clean", "state", "in", "init", "*", "/", "current_thread_info", "(", ")-", ">", "status", "=", "0", ";", "clear_used_math", "(", ");", "struct", "i387_fxsave_struct", "*", "fx", "=", "&", "fpu", "-", ">", "state", "-", ">", "fxsave", ";", "memset", "(", "fx", ",", "0", ",", "xstate_size", ")", ";", "fx", "-", ">", "cwd", "=", "0x37f", ";", "if", "(", "cpu_has_xmm", ")", "fx", "-", ">", "mxcsr", "=", "MXCSR_DEFAULT", ";", "if", "(", "!", "use_xsave", "(", "))", "BUG_ON", "(", "use_xsave", "(", "))", ";", "if", "(", "use_xsave", "(", "))", "clts", "(", ");", "/", "*", "*", "This", "is", "same", "as", "math_state_restore", "(", ").", "But", "use_xsave", "(", ")", "is", "not", "yet", "*", "patched", "to", "use", "math_state_restore", "(", ").", "*", "/", "static", "inline", "void", "init_restore_xstate", "(", "void", ")", "{", "init_fpu", "(", "current", ")", ";", "__thread_fpu_begin", "(", "current", ")", ";", "xrstor_state", "(", "init_xstate_buf", ",", "-", "1", ")", ";", "}", "static", "inline", "void", "xstate_enable_ap", "(", "void", ")", "{", "xstate_enable", "(", ");", "init_restore_xstate", "(", ");", "}", "static", "void", "__init", "setup_xstate_init", "(", "void", ")", "setup_xstate_features", "(", ");", "init_xstate_buf", "-", ">", "i387", ".", "mxcsr", "=", "MXCSR_DEFAULT", ";", "setup_xstate_init", "(", ");", "current", "-", ">", "thread", ".", "fpu", ".", "state", "=", "alloc_bootmem_align", "(", "xstate_size", ",", "__alignof__", "(", "struct", "xsave_struct", ")", ");", "init_restore_xstate", "(", ");", "next_func", "=", "xstate_enable_ap", ";"], "docstring_tokens": ["be", "leaked", "across", "process", "or", "virtual", "machine", "boundaries"]}
{"contents": ["empty"], "code_tokens": ["obj", "-", "$(", "CONFIG_FS_MBCACHE", ")", "+", "=", "mbcache", ".", "o", "mbcache2", ".", "o", "#", "include", "<", "linux", "/", "spinlock", ".", "h", ">", "#", "include", "<", "linux", "/", "slab", ".", "h", ">", "#", "include", "<", "linux", "/", "list", ".", "h", ">", "#", "include", "<", "linux", "/", "list_bl", ".", "h", ">", "#", "include", "<", "linux", "/", "module", ".", "h", ">", "#", "include", "<", "linux", "/", "sched", ".", "h", ">", "#", "include", "<", "linux", "/", "mbcache2", ".", "h", ">", "/", "*", "*", "Mbcache", "is", "a", "simple", "key", "-", "value", "store", ".", "Keys", "need", "not", "be", "unique", ",", "however", "*", "key", "-", "value", "pairs", "are", "expected", "to", "be", "unique", "(", "we", "use", "this", "fact", "in", "*", "mb2_cache_entry_delete_block", "(", "))", ".", "*", "*", "Ext2", "and", "ext4", "use", "this", "cache", "for", "deduplication", "of", "extended", "attribute", "blocks", ".", "*", "They", "use", "hash", "of", "a", "block", "contents", "as", "a", "key", "and", "block", "number", "as", "a", "value", ".", "*", "That", "'", "s", "why", "keys", "need", "not", "be", "unique", "(", "different", "xattr", "blocks", "may", "end", "up", "having", "*", "the", "same", "hash", ")", ".", "However", "block", "number", "always", "uniquely", "identifies", "a", "cache", "*", "entry", ".", "*", "*", "We", "provide", "functions", "for", "creation", "and", "removal", "of", "entries", ",", "search", "by", "key", ",", "*", "and", "a", "special", "\"", "delete", "entry", "with", "given", "key", "-", "value", "pair", "\"", "operation", ".", "Fixed", "*", "size", "hash", "table", "is", "used", "for", "fast", "key", "lookups", ".", "*", "/", "struct", "mb2_cache", "{", "/", "*", "Hash", "table", "of", "entries", "*", "/", "struct", "hlist_bl_head", "*", "c_hash", ";", "/", "*", "log2", "of", "hash", "table", "size", "*", "/", "int", "c_bucket_bits", ";", "/", "*", "Protects", "c_lru_list", ",", "c_entry_count", "*", "/", "spinlock_t", "c_lru_list_lock", ";", "struct", "list_head", "c_lru_list", ";", "/", "*", "Number", "of", "entries", "in", "cache", "*", "/", "unsigned", "long", "c_entry_count", ";", "struct", "shrinker", "c_shrink", ";", "}", ";", "static", "struct", "kmem_cache", "*", "mb2_entry_cache", ";", "/", "*", "*", "mb2_cache_entry_create", "-", "create", "entry", "in", "cache", "*", "@", "cache", "-", "cache", "where", "the", "entry", "should", "be", "created", "*", "@", "mask", "-", "gfp", "mask", "with", "which", "the", "entry", "should", "be", "allocated", "*", "@", "key", "-", "key", "of", "the", "entry", "*", "@", "block", "-", "block", "that", "contains", "data", "*", "*", "Creates", "entry", "in", "@", "cache", "with", "key", "@", "key", "and", "records", "that", "data", "is", "stored", "in", "*", "block", "@", "block", ".", "The", "function", "returns", "-", "EBUSY", "if", "entry", "with", "the", "same", "key", "*", "and", "for", "the", "same", "block", "already", "exists", "in", "cache", ".", "Otherwise", "0", "is", "returned", ".", "*", "/", "int", "mb2_cache_entry_create", "(", "struct", "mb2_cache", "*", "cache", ",", "gfp_t", "mask", ",", "u32", "key", ",", "sector_t", "block", ")", "{", "struct", "mb2_cache_entry", "*", "entry", ",", "*", "dup", ";", "struct", "hlist_bl_node", "*", "dup_node", ";", "struct", "hlist_bl_head", "*", "head", ";", "entry", "=", "kmem_cache_alloc", "(", "mb2_entry_cache", ",", "mask", ")", ";", "if", "(", "!", "entry", ")", "return", "-", "ENOMEM", ";", "INIT_LIST_HEAD", "(", "&", "entry", "-", ">", "e_lru_list", ")", ";", "/", "*", "One", "ref", "for", "hash", ",", "one", "ref", "returned", "*", "/", "atomic_set", "(", "&", "entry", "-", ">", "e_refcnt", ",", "1", ")", ";", "entry", "-", ">", "e_key", "=", "key", ";", "entry", "-", ">", "e_block", "=", "block", ";", "head", "=", "&", "cache", "-", ">", "c_hash", "[", "hash_32", "(", "key", ",", "cache", "-", ">", "c_bucket_bits", ")", "];", "entry", "-", ">", "e_hash_list_head", "=", "head", ";", "hlist_bl_lock", "(", "head", ")", ";", "hlist_bl_for_each_entry", "(", "dup", ",", "dup_node", ",", "head", ",", "e_hash_list", ")", "{", "if", "(", "dup", "-", ">", "e_key", "=", "=", "key", "&", "&", "dup", "-", ">", "e_block", "=", "=", "block", ")", "{", "hlist_bl_unlock", "(", "head", ")", ";", "kmem_cache_free", "(", "mb2_entry_cache", ",", "entry", ")", ";", "return", "-", "EBUSY", ";", "}", "}", "hlist_bl_add_head", "(", "&", "entry", "-", ">", "e_hash_list", ",", "head", ")", ";", "hlist_bl_unlock", "(", "head", ")", ";", "spin_lock", "(", "&", "cache", "-", ">", "c_lru_list_lock", ")", ";", "list_add_tail", "(", "&", "entry", "-", ">", "e_lru_list", ",", "&", "cache", "-", ">", "c_lru_list", ")", ";", "/", "*", "Grab", "ref", "for", "LRU", "list", "*", "/", "atomic_inc", "(", "&", "entry", "-", ">", "e_refcnt", ")", ";", "cache", "-", ">", "c_entry_count", "+", "+;", "spin_unlock", "(", "&", "cache", "-", ">", "c_lru_list_lock", ")", ";", "return", "0", ";", "}", "EXPORT_SYMBOL", "(", "mb2_cache_entry_create", ")", ";", "void", "__mb2_cache_entry_free", "(", "struct", "mb2_cache_entry", "*", "entry", ")", "{", "kmem_cache_free", "(", "mb2_entry_cache", ",", "entry", ")", ";", "}", "EXPORT_SYMBOL", "(", "__mb2_cache_entry_free", ")", ";", "static", "struct", "mb2_cache_entry", "*", "__entry_find", "(", "struct", "mb2_cache", "*", "cache", ",", "struct", "mb2_cache_entry", "*", "entry", ",", "u32", "key", ")", "{", "struct", "mb2_cache_entry", "*", "old_entry", "=", "entry", ";", "struct", "hlist_bl_node", "*", "node", ";", "struct", "hlist_bl_head", "*", "head", ";", "if", "(", "entry", ")", "head", "=", "entry", "-", ">", "e_hash_list_head", ";", "else", "head", "=", "&", "cache", "-", ">", "c_hash", "[", "hash_32", "(", "key", ",", "cache", "-", ">", "c_bucket_bits", ")", "];", "hlist_bl_lock", "(", "head", ")", ";", "if", "(", "entry", "&", "&", "!", "hlist_bl_unhashed", "(", "&", "entry", "-", ">", "e_hash_list", ")", ")", "node", "=", "entry", "-", ">", "e_hash_list", ".", "next", ";", "else", "node", "=", "hlist_bl_first", "(", "head", ")", ";", "while", "(", "node", ")", "{", "entry", "=", "hlist_bl_entry", "(", "node", ",", "struct", "mb2_cache_entry", ",", "e_hash_list", ")", ";", "if", "(", "entry", "-", ">", "e_key", "=", "=", "key", ")", "{", "atomic_inc", "(", "&", "entry", "-", ">", "e_refcnt", ")", ";", "goto", "out", ";", "}", "node", "=", "node", "-", ">", "next", ";", "}", "entry", "=", "NULL", ";", "out", ":", "hlist_bl_unlock", "(", "head", ")", ";", "if", "(", "old_entry", ")", "mb2_cache_entry_put", "(", "cache", ",", "old_entry", ")", ";", "return", "entry", ";", "}", "/", "*", "*", "mb2_cache_entry_find_first", "-", "find", "the", "first", "entry", "in", "cache", "with", "given", "key", "*", "@", "cache", ":", "cache", "where", "we", "should", "search", "*", "@", "key", ":", "key", "to", "look", "for", "*", "*", "Search", "in", "@", "cache", "for", "entry", "with", "key", "@", "key", ".", "Grabs", "reference", "to", "the", "first", "*", "entry", "found", "and", "returns", "the", "entry", ".", "*", "/", "struct", "mb2_cache_entry", "*", "mb2_cache_entry_find_first", "(", "struct", "mb2_cache", "*", "cache", ",", "u32", "key", ")", "{", "return", "__entry_find", "(", "cache", ",", "NULL", ",", "key", ")", ";", "}", "EXPORT_SYMBOL", "(", "mb2_cache_entry_find_first", ")", ";", "/", "*", "*", "mb2_cache_entry_find_next", "-", "find", "next", "entry", "in", "cache", "with", "the", "same", "*", "@", "cache", ":", "cache", "where", "we", "should", "search", "*", "@", "entry", ":", "entry", "to", "start", "search", "from", "*", "*", "Finds", "next", "entry", "in", "the", "hash", "chain", "which", "has", "the", "same", "key", "as", "@", "entry", ".", "*", "If", "@", "entry", "is", "unhashed", "(", "which", "can", "happen", "when", "deletion", "of", "entry", "races", "*", "with", "the", "search", ")", ",", "finds", "the", "first", "entry", "in", "the", "hash", "chain", ".", "The", "function", "*", "drops", "reference", "to", "@", "entry", "and", "returns", "with", "a", "reference", "to", "the", "found", "entry", ".", "*", "/", "struct", "mb2_cache_entry", "*", "mb2_cache_entry_find_next", "(", "struct", "mb2_cache", "*", "cache", ",", "struct", "mb2_cache_entry", "*", "entry", ")", "{", "return", "__entry_find", "(", "cache", ",", "entry", ",", "entry", "-", ">", "e_key", ")", ";", "}", "EXPORT_SYMBOL", "(", "mb2_cache_entry_find_next", ")", ";", "/", "*", "mb2_cache_entry_delete_block", "-", "remove", "information", "about", "block", "from", "cache", "*", "@", "cache", "-", "cache", "we", "work", "with", "*", "@", "key", "-", "key", "of", "the", "entry", "to", "remove", "*", "@", "block", "-", "block", "containing", "data", "for", "@", "key", "*", "*", "Remove", "entry", "from", "cache", "@", "cache", "with", "key", "@", "key", "with", "data", "stored", "in", "@", "block", ".", "*", "/", "void", "mb2_cache_entry_delete_block", "(", "struct", "mb2_cache", "*", "cache", ",", "u32", "key", ",", "sector_t", "block", ")", "{", "struct", "hlist_bl_node", "*", "node", ";", "struct", "hlist_bl_head", "*", "head", ";", "struct", "mb2_cache_entry", "*", "entry", ";", "head", "=", "&", "cache", "-", ">", "c_hash", "[", "hash_32", "(", "key", ",", "cache", "-", ">", "c_bucket_bits", ")", "];", "hlist_bl_lock", "(", "head", ")", ";", "hlist_bl_for_each_entry", "(", "entry", ",", "node", ",", "head", ",", "e_hash_list", ")", "{", "if", "(", "entry", "-", ">", "e_key", "=", "=", "key", "&", "&", "entry", "-", ">", "e_block", "=", "=", "block", ")", "{", "/", "*", "We", "keep", "hash", "list", "reference", "to", "keep", "entry", "alive", "*", "/", "hlist_bl_del_init", "(", "&", "entry", "-", ">", "e_hash_list", ")", ";", "hlist_bl_unlock", "(", "head", ")", ";", "spin_lock", "(", "&", "cache", "-", ">", "c_lru_list_lock", ")", ";", "if", "(", "!", "list_empty", "(", "&", "entry", "-", ">", "e_lru_list", ")", ")", "{", "list_del_init", "(", "&", "entry", "-", ">", "e_lru_list", ")", ";", "cache", "-", ">", "c_entry_count", "-", "-;", "atomic_dec", "(", "&", "entry", "-", ">", "e_refcnt", ")", ";", "}", "spin_unlock", "(", "&", "cache", "-", ">", "c_lru_list_lock", ")", ";", "mb2_cache_entry_put", "(", "cache", ",", "entry", ")", ";", "return", ";", "}", "}", "hlist_bl_unlock", "(", "head", ")", ";", "}", "EXPORT_SYMBOL", "(", "mb2_cache_entry_delete_block", ")", ";", "/", "*", "mb2_cache_entry_touch", "-", "cache", "entry", "got", "used", "*", "@", "cache", "-", "cache", "the", "entry", "belongs", "to", "*", "@", "entry", "-", "entry", "that", "got", "used", "*", "*", "Move", "entry", "in", "lru", "list", "to", "reflect", "the", "fact", "that", "it", "was", "used", ".", "*", "/", "void", "mb2_cache_entry_touch", "(", "struct", "mb2_cache", "*", "cache", ",", "struct", "mb2_cache_entry", "*", "entry", ")", "{", "spin_lock", "(", "&", "cache", "-", ">", "c_lru_list_lock", ")", ";", "if", "(", "!", "list_empty", "(", "&", "entry", "-", ">", "e_lru_list", ")", ")", "list_move_tail", "(", "&", "cache", "-", ">", "c_lru_list", ",", "&", "entry", "-", ">", "e_lru_list", ")", ";", "spin_unlock", "(", "&", "cache", "-", ">", "c_lru_list_lock", ")", ";", "}", "EXPORT_SYMBOL", "(", "mb2_cache_entry_touch", ")", ";", "static", "unsigned", "long", "mb2_cache_count", "(", "struct", "shrinker", "*", "shrink", ",", "struct", "shrink_control", "*", "sc", ")", "{", "struct", "mb2_cache", "*", "cache", "=", "container_of", "(", "shrink", ",", "struct", "mb2_cache", ",", "c_shrink", ")", ";", "return", "cache", "-", ">", "c_entry_count", ";", "}", "/", "*", "Shrink", "number", "of", "entries", "in", "cache", "*", "/", "static", "unsigned", "long", "mb2_cache_scan", "(", "struct", "shrinker", "*", "shrink", ",", "struct", "shrink_control", "*", "sc", ")", "{", "int", "nr_to_scan", "=", "sc", "-", ">", "nr_to_scan", ";", "struct", "mb2_cache", "*", "cache", "=", "container_of", "(", "shrink", ",", "struct", "mb2_cache", ",", "c_shrink", ")", ";", "struct", "mb2_cache_entry", "*", "entry", ";", "struct", "hlist_bl_head", "*", "head", ";", "unsigned", "int", "shrunk", "=", "0", ";", "spin_lock", "(", "&", "cache", "-", ">", "c_lru_list_lock", ")", ";", "while", "(", "nr_to_scan", "-", "-", "&", "&", "!", "list_empty", "(", "&", "cache", "-", ">", "c_lru_list", ")", ")", "{", "entry", "=", "list_first_entry", "(", "&", "cache", "-", ">", "c_lru_list", ",", "struct", "mb2_cache_entry", ",", "e_lru_list", ")", ";", "list_del_init", "(", "&", "entry", "-", ">", "e_lru_list", ")", ";", "cache", "-", ">", "c_entry_count", "-", "-;", "/", "*", "*", "We", "keep", "LRU", "list", "reference", "so", "that", "entry", "doesn", "'", "t", "go", "away", "*", "from", "under", "us", ".", "*", "/", "spin_unlock", "(", "&", "cache", "-", ">", "c_lru_list_lock", ")", ";", "head", "=", "entry", "-", ">", "e_hash_list_head", ";", "hlist_bl_lock", "(", "head", ")", ";", "if", "(", "!", "hlist_bl_unhashed", "(", "&", "entry", "-", ">", "e_hash_list", ")", ")", "{", "hlist_bl_del_init", "(", "&", "entry", "-", ">", "e_hash_list", ")", ";", "atomic_dec", "(", "&", "entry", "-", ">", "e_refcnt", ")", ";", "}", "hlist_bl_unlock", "(", "head", ")", ";", "if", "(", "mb2_cache_entry_put", "(", "cache", ",", "entry", ")", ")", "shrunk", "+", "+;", "cond_resched", "(", ");", "spin_lock", "(", "&", "cache", "-", ">", "c_lru_list_lock", ")", ";", "}", "spin_unlock", "(", "&", "cache", "-", ">", "c_lru_list_lock", ")", ";", "return", "shrunk", ";", "}", "/", "*", "*", "mb2_cache_create", "-", "create", "cache", "*", "@", "bucket_bits", ":", "log2", "of", "the", "hash", "table", "size", "*", "*", "Create", "cache", "for", "keys", "with", "2", "^", "bucket_bits", "hash", "entries", ".", "*", "/", "struct", "mb2_cache", "*", "mb2_cache_create", "(", "int", "bucket_bits", ")", "{", "struct", "mb2_cache", "*", "cache", ";", "int", "bucket_count", "=", "1", "<", "<", "bucket_bits", ";", "int", "i", ";", "if", "(", "!", "try_module_get", "(", "THIS_MODULE", ")", ")", "return", "NULL", ";", "cache", "=", "kzalloc", "(", "sizeof", "(", "struct", "mb2_cache", ")", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "cache", ")", "goto", "err_out", ";", "cache", "-", ">", "c_bucket_bits", "=", "bucket_bits", ";", "INIT_LIST_HEAD", "(", "&", "cache", "-", ">", "c_lru_list", ")", ";", "spin_lock_init", "(", "&", "cache", "-", ">", "c_lru_list_lock", ")", ";", "cache", "-", ">", "c_hash", "=", "kmalloc", "(", "bucket_count", "*", "sizeof", "(", "struct", "hlist_bl_head", ")", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "cache", "-", ">", "c_hash", ")", "{", "kfree", "(", "cache", ")", ";", "goto", "err_out", ";", "}", "for", "(", "i", "=", "0", ";", "i", "<", "bucket_count", ";", "i", "+", "+)", "INIT_HLIST_BL_HEAD", "(", "&", "cache", "-", ">", "c_hash", "[", "i", "]", ");", "cache", "-", ">", "c_shrink", ".", "count_objects", "=", "mb2_cache_count", ";", "cache", "-", ">", "c_shrink", ".", "scan_objects", "=", "mb2_cache_scan", ";", "cache", "-", ">", "c_shrink", ".", "seeks", "=", "DEFAULT_SEEKS", ";", "register_shrinker", "(", "&", "cache", "-", ">", "c_shrink", ")", ";", "return", "cache", ";", "err_out", ":", "module_put", "(", "THIS_MODULE", ")", ";", "return", "NULL", ";", "}", "EXPORT_SYMBOL", "(", "mb2_cache_create", ")", ";", "/", "*", "*", "mb2_cache_destroy", "-", "destroy", "cache", "*", "@", "cache", ":", "the", "cache", "to", "destroy", "*", "*", "Free", "all", "entries", "in", "cache", "and", "cache", "itself", ".", "Caller", "must", "make", "sure", "nobody", "*", "(", "except", "shrinker", ")", "can", "reach", "@", "cache", "when", "calling", "this", ".", "*", "/", "void", "mb2_cache_destroy", "(", "struct", "mb2_cache", "*", "cache", ")", "{", "struct", "mb2_cache_entry", "*", "entry", ",", "*", "next", ";", "unregister_shrinker", "(", "&", "cache", "-", ">", "c_shrink", ")", ";", "/", "*", "*", "We", "don", "'", "t", "bother", "with", "any", "locking", ".", "Cache", "must", "not", "be", "used", "at", "this", "*", "point", ".", "*", "/", "list_for_each_entry_safe", "(", "entry", ",", "next", ",", "&", "cache", "-", ">", "c_lru_list", ",", "e_lru_list", ")", "{", "if", "(", "!", "hlist_bl_unhashed", "(", "&", "entry", "-", ">", "e_hash_list", ")", ")", "{", "hlist_bl_del_init", "(", "&", "entry", "-", ">", "e_hash_list", ")", ";", "atomic_dec", "(", "&", "entry", "-", ">", "e_refcnt", ")", ";", "}", "else", "WARN_ON", "(", "1", ")", ";", "list_del", "(", "&", "entry", "-", ">", "e_lru_list", ")", ";", "WARN_ON", "(", "atomic_read", "(", "&", "entry", "-", ">", "e_refcnt", ")", "!", "=", "1", ")", ";", "mb2_cache_entry_put", "(", "cache", ",", "entry", ")", ";", "}", "kfree", "(", "cache", "-", ">", "c_hash", ")", ";", "kfree", "(", "cache", ")", ";", "module_put", "(", "THIS_MODULE", ")", ";", "}", "EXPORT_SYMBOL", "(", "mb2_cache_destroy", ")", ";", "static", "int", "__init", "mb2cache_init", "(", "void", ")", "{", "mb2_entry_cache", "=", "kmem_cache_create", "(", "\"", "mbcache", "\"", ",", "sizeof", "(", "struct", "mb2_cache_entry", ")", ",", "0", ",", "SLAB_RECLAIM_ACCOUNT", "|", "SLAB_MEM_SPREAD", ",", "NULL", ")", ";", "BUG_ON", "(", "!", "mb2_entry_cache", ")", ";", "return", "0", ";", "}", "static", "void", "__exit", "mb2cache_exit", "(", "void", ")", "{", "kmem_cache_destroy", "(", "mb2_entry_cache", ")", ";", "}", "module_init", "(", "mb2cache_init", ")", "module_exit", "(", "mb2cache_exit", ")", "MODULE_AUTHOR", "(", "\"", "Jan", "Kara", "<", "jack", "@", "suse", ".", "cz", ">", "\")", ";", "MODULE_DESCRIPTION", "(", "\"", "Meta", "block", "cache", "(", "for", "extended", "attributes", ")", "\")", ";", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "@", "@", "-", "0", ",", "0", "+", "1", ",", "50", "@", "@", "#", "ifndef", "_LINUX_MB2CACHE_H", "#", "define", "_LINUX_MB2CACHE_H", "#", "include", "<", "linux", "/", "hash", ".", "h", ">", "#", "include", "<", "linux", "/", "list_bl", ".", "h", ">", "#", "include", "<", "linux", "/", "list", ".", "h", ">", "#", "include", "<", "linux", "/", "atomic", ".", "h", ">", "#", "include", "<", "linux", "/", "fs", ".", "h", ">", "struct", "mb2_cache", ";", "struct", "mb2_cache_entry", "{", "/", "*", "LRU", "list", "-", "protected", "by", "cache", "-", ">", "c_lru_list_lock", "*", "/", "struct", "list_head", "e_lru_list", ";", "/", "*", "Hash", "table", "list", "-", "protected", "by", "bitlock", "in", "e_hash_list_head", "*", "/", "struct", "hlist_bl_node", "e_hash_list", ";", "atomic_t", "e_refcnt", ";", "/", "*", "Key", "in", "hash", "-", "stable", "during", "lifetime", "of", "the", "entry", "*", "/", "u32", "e_key", ";", "/", "*", "Block", "number", "of", "hashed", "block", "-", "stable", "during", "lifetime", "of", "the", "entry", "*", "/", "sector_t", "e_block", ";", "/", "*", "Head", "of", "hash", "list", "(", "for", "list", "bit", "lock", ")", "-", "stable", "*", "/", "struct", "hlist_bl_head", "*", "e_hash_list_head", ";", "}", ";", "struct", "mb2_cache", "*", "mb2_cache_create", "(", "int", "bucket_bits", ")", ";", "void", "mb2_cache_destroy", "(", "struct", "mb2_cache", "*", "cache", ")", ";", "int", "mb2_cache_entry_create", "(", "struct", "mb2_cache", "*", "cache", ",", "gfp_t", "mask", ",", "u32", "key", ",", "sector_t", "block", ")", ";", "void", "__mb2_cache_entry_free", "(", "struct", "mb2_cache_entry", "*", "entry", ")", ";", "static", "inline", "int", "mb2_cache_entry_put", "(", "struct", "mb2_cache", "*", "cache", ",", "struct", "mb2_cache_entry", "*", "entry", ")", "{", "if", "(", "!", "atomic_dec_and_test", "(", "&", "entry", "-", ">", "e_refcnt", ")", ")", "return", "0", ";", "__mb2_cache_entry_free", "(", "entry", ")", ";", "return", "1", ";", "}", "void", "mb2_cache_entry_delete_block", "(", "struct", "mb2_cache", "*", "cache", ",", "u32", "key", ",", "sector_t", "block", ")", ";", "struct", "mb2_cache_entry", "*", "mb2_cache_entry_find_first", "(", "struct", "mb2_cache", "*", "cache", ",", "u32", "key", ")", ";", "struct", "mb2_cache_entry", "*", "mb2_cache_entry_find_next", "(", "struct", "mb2_cache", "*", "cache", ",", "struct", "mb2_cache_entry", "*", "entry", ")", ";", "void", "mb2_cache_entry_touch", "(", "struct", "mb2_cache", "*", "cache", ",", "struct", "mb2_cache_entry", "*", "entry", ")", ";", "#", "endif", "/", "*", "_LINUX_MB2CACHE_H", "*", "/</s>obj", "-", "$(", "CONFIG_FS_MBCACHE", ")", "+", "=", "mbcache", ".", "o"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(soft", "lockup", ")"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "task_pid_vnr", "(", "p", ")", ">", "1", "&", "&", "!", "same_thread_group", "(", "p", ",", "current", ")", ")", "{", "+", "+", "count", ";</s>if", "(", "p", "-", ">", "pid", ">", "1", "&", "&", "!", "same_thread_group", "(", "p", ",", "current", ")", ")", "{"], "docstring_tokens": ["bypass", "the", "intended", "namespace", "isolation", "and", "send", "arbitrary", "signals", "to", "all", "processes", "in", "all", "namespaces"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "strncmp", "(", "name", ",", "mixer_vols", "[", "i", "]", ".", "name", ",", "32", ")", "=", "=", "0", ")", "{", "strncpy", "(", "mixer_vols", "[", "n", "]", ".", "name", ",", "name", ",", "32", ")", ";</s>if", "(", "strcmp", "(", "name", ",", "mixer_vols", "[", "i", "]", ".", "name", ")", "=", "=", "0", ")", "{", "strcpy", "(", "mixer_vols", "[", "n", "]", ".", "name", ",", "name", ")", ";"], "docstring_tokens": ["overflow", "a", "buffer", "and", "execute", "arbitrary", "code", "on", "the", "system", "with", "elevated", "privileges"]}
{"contents": ["empty"], "code_tokens": ["for", "(", "int", "i", "=", "0", ";", "i", "<", "size", "(", ");", "i", "+", "+)", "COSBase", "base", "=", "getObject", "(", "i", ")", ";", "retval", "[", "i", "]", "=", "base", "instanceof", "COSNumber", "?", "(", "(", "COSNumber", ")", "base", ")", ".", "floatValue", "(", ")", ":", "0", ";</s>for", "(", "int", "i", "=", "0", ";", "i", "<", "size", "(", ");", "i", "+", "+", ")", "retval", "[", "i", "]", "=", "(", "(", "COSNumber", ")", "getObject", "(", "i", ")", ").", "floatValue", "(", ");"], "docstring_tokens": ["trigger", "an", "extremely", "long", "running", "computation", "when", "parsing", "the", "page", "tree", "."]}
{"contents": ["empty"], "code_tokens": ["-", "Core", ":", ".", "Fixed", "CVE", "-", "2012", "-", "2143", ".", "(", "Solar", "Designer", ")", "*", "q", "+", "+", "=", "*", "key", "<", "<", "1", ";", "if", "(", "*", "key", ")", "-", "-", "TEST", "-", "-", "crypt", "(", ")", "function", "-", "characters", ">", "0x80", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "function_exists", "(", "'", "crypt", "'", "))", "{", "die", "(", "\"", "SKIP", "crypt", "(", ")", "is", "not", "available", "\"", ");", "}", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "var_dump", "(", "crypt", "(", "\"\u00c0", "1234abcd", "\"", ",", "\"", "99", "\"", "))", ";", "var_dump", "(", "crypt", "(", "\"\u00c0", "9234abcd", "\"", ",", "\"", "99", "\"", "))", ";", "var_dump", "(", "crypt", "(", "\"\u00c0", "1234abcd", "\"", ",", "\"", "_01234567", "\"", "))", ";", "var_dump", "(", "crypt", "(", "\"\u00c0", "9234abcd", "\"", ",", "\"", "_01234567", "\"", "))", ";", "-", "-", "EXPECT", "-", "-", "string", "(", "13", ")", "\"", "99PxawtsTfX56", "\"", "string", "(", "13", ")", "\"", "99jcVcGxUZOWk", "\"", "string", "(", "20", ")", "\"", "_01234567IBjxKliXXRQ", "\"", "string", "(", "20", ")", "\"", "_012345678OSGpGQRVHA", "\"</s>-", "COM", ":", "-", "Fileinfo", ":", "if", "(", "(*", "q", "+", "+", "=", "*", "key", "<", "<", "1", ")", ")"], "docstring_tokens": ["encrypt", "its", "users", "'", "passwords"]}
{"contents": ["empty"], "code_tokens": ["api_title", "=", "'", "ACL", "API", "'", ",", "api_version", "=", "'", "1", ".", "0", "'", ",", "api_description", "=", "'", "REST", "API", "for", "ACL", "app", "'", ",", "api_package", "=", "'", "org", ".", "onosproject", ".", "acl", "'", ",", "*", "Generate", "new", "ACL", "flow", "rules", "for", "new", "or", "updated", "host", "following", "the", "given", "ACL", "rule", ".", "/", "/", "if", "a", "new", "host", "appears", "or", "is", "updated", "and", "an", "existing", "rule", "denies", "if", "(", "event", ".", "type", "(", ")", "=", "=", "HostEvent", ".", "Type", ".", "HOST_ADDED", "|", "|", "event", ".", "type", "(", ")", "=", "=", "HostEvent", ".", "Type", ".", "HOST_UPDATED", ")", "{</s>*", "Generate", "new", "ACL", "flow", "rules", "for", "new", "host", "following", "the", "given", "ACL", "rule", ".", "/", "/", "if", "a", "new", "host", "appears", "and", "an", "existing", "rule", "denies", "if", "(", "event", ".", "type", "(", ")", "=", "=", "HostEvent", ".", "Type", ".", "HOST_ADDED", ")", "{"], "docstring_tokens": ["bypass", "network", "access", "control"]}
{"contents": ["empty"], "code_tokens": ["Fix", "\"", "redzone", "overwritten", "\"", "bug", "in", "cifs_put_tcon", "(", "CIFSTcon", "may", "allocate", "too", "little", "memory", "for", "the", "\"", "nativeFileSystem", "\"", "field", "returned", "by", "the", "server", "during", "mount", ")", ".", "kzalloc", "(", "2", "*", "(", "length", "+", "1", ")", ",", "GFP_KERNEL", ")", ";</s>-", "--", "--", "--", "--", "--", "-", "@", "@", "-", "3674", ",", "7", "+", "3674", ",", "7", "@", "@", "CIFSTCon", "(", "unsigned", "int", "xid", ",", "struct", "cifsSesInfo", "*", "ses", ",", "kzalloc", "(", "length", "+", "2", ",", "GFP_KERNEL", ")", ";"], "docstring_tokens": ["overflow", "a", "buffer", "and", "execute", "arbitrary", "code", "on", "the", "system", "with", "elevated", "privileges", "or", "cause", "the", "CIFS", "client", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["*", "String", "rendering", "of", "the", "data", "return", "Messages", ".", "ResponseTimeMonitor_TimeOut", "(", "fc", ")", ";", "<", "p", "class", "=", "\"", "warning", "\"", ">$", "{", "it", "}", "</", "p", "></s>*", "HTML", "rendering", "of", "the", "data", "return", "Util", ".", "wrapToErrorSpan", "(", "Messages", ".", "ResponseTimeMonitor_TimeOut", "(", "fc", ")", ");", "<", "p", "class", "=", "\"", "warning", "\"", "><", "j", ":", "out", "value", "=", "\"$", "{", "it", "}", "\"", "/", "><", "/", "p", ">"], "docstring_tokens": ["steal", "the", "victim's", "cookie-based", "authentication", "credentials"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "path_length", "<", "=", "0", "|", "|", "path_length", ">", "=", "MAXPATHLEN", "-", "1", ")", "{</s>if", "(", "path_length", "=", "=", "0", "|", "|", "path_length", ">", "=", "MAXPATHLEN", "-", "1", ")", "{"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(stack-based", "buffer", "overflow", ")", "or", "possibly", "have", "unspecified", "other", "impact"]}
{"contents": ["empty"], "code_tokens": ["static", "inline", "void", "enable_x2apic_msr_intercepts", "(", "unsigned", "long", "*", "msr_bitmap", ")", "{", "int", "msr", ";", "for", "(", "msr", "=", "0x800", ";", "msr", "<", "=", "0x8ff", ";", "msr", "+", "=", "BITS_PER_LONG", ")", "{", "unsigned", "word", "=", "msr", "/", "BITS_PER_LONG", ";", "msr_bitmap", "[", "word", "]", "=", "~", "0", ";", "msr_bitmap", "[", "word", "+", "(", "0x800", "/", "sizeof", "(", "long", ")", ")]", "=", "~", "0", ";", "}", "}", "/", "*", "*", "To", "keep", "the", "control", "flow", "simple", ",", "pay", "eight", "8", "-", "byte", "writes", "(", "sixteen", "*", "4", "-", "byte", "writes", "on", "32", "-", "bit", "systems", ")", "up", "front", "to", "enable", "intercepts", "for", "*", "the", "x2APIC", "MSR", "range", "and", "selectively", "disable", "them", "below", ".", "*", "/", "enable_x2apic_msr_intercepts", "(", "msr_bitmap_l0", ")", ";", "if", "(", "nested_cpu_has_virt_x2apic_mode", "(", "vmcs12", ")", ")", "{", "if", "(", "nested_cpu_has_apic_reg_virt", "(", "vmcs12", ")", ")", "{", "/", "*", "*", "L0", "need", "not", "intercept", "reads", "for", "MSRs", "between", "0x800", "*", "and", "0x8ff", ",", "it", "just", "lets", "the", "processor", "take", "the", "value", "*", "from", "the", "virtual", "-", "APIC", "page", ";", "take", "those", "256", "bits", "*", "directly", "from", "the", "L1", "bitmap", ".", "*", "/", "for", "(", "msr", "=", "0x800", ";", "msr", "<", "=", "0x8ff", ";", "msr", "+", "=", "BITS_PER_LONG", ")", "{", "unsigned", "word", "=", "msr", "/", "BITS_PER_LONG", ";", "msr_bitmap_l0", "[", "word", "]", "=", "msr_bitmap_l1", "[", "word", "]", ";", "}", "}", "X2APIC_MSR", "(", "APIC_TASKPRI", ")", ",", "if", "(", "nested_cpu_has_vid", "(", "vmcs12", ")", ")", "{", "nested_vmx_disable_intercept_for_msr", "(", "msr_bitmap_l1", ",", "msr_bitmap_l0", ",", "X2APIC_MSR", "(", "APIC_EOI", ")", ",", "MSR_TYPE_W", ")", ";", "nested_vmx_disable_intercept_for_msr", "(", "msr_bitmap_l1", ",", "msr_bitmap_l0", ",", "X2APIC_MSR", "(", "APIC_SELF_IPI", ")", ",", "MSR_TYPE_W", ")", ";", "}</s>if", "(", "nested_cpu_has_apic_reg_virt", "(", "vmcs12", ")", ")", "{", "/", "*", "*", "L0", "need", "not", "intercept", "reads", "for", "MSRs", "between", "0x800", "and", "0x8ff", ",", "it", "*", "just", "lets", "the", "processor", "take", "the", "value", "from", "the", "virtual", "-", "APIC", "page", ";", "*", "take", "those", "256", "bits", "directly", "from", "the", "L1", "bitmap", ".", "*", "/", "for", "(", "msr", "=", "0x800", ";", "msr", "<", "=", "0x8ff", ";", "msr", "+", "=", "BITS_PER_LONG", ")", "{", "unsigned", "word", "=", "msr", "/", "BITS_PER_LONG", ";", "msr_bitmap_l0", "[", "word", "]", "=", "msr_bitmap_l1", "[", "word", "]", ";", "msr_bitmap_l0", "[", "word", "+", "(", "0x800", "/", "sizeof", "(", "long", ")", ")]", "=", "~", "0", ";", "}", "}", "else", "{", "for", "(", "msr", "=", "0x800", ";", "msr", "<", "=", "0x8ff", ";", "msr", "+", "=", "BITS_PER_LONG", ")", "{", "unsigned", "word", "=", "msr", "/", "BITS_PER_LONG", ";", "msr_bitmap_l0", "[", "word", "]", "=", "~", "0", ";", "msr_bitmap_l0", "[", "word", "+", "(", "0x800", "/", "sizeof", "(", "long", ")", ")]", "=", "~", "0", ";", "}", "}", "nested_vmx_disable_intercept_for_msr", "(", "msr_bitmap_l1", ",", "msr_bitmap_l0", ",", "X2APIC_MSR", "(", "APIC_TASKPRI", ")", ",", "MSR_TYPE_W", ")", ";", "if", "(", "nested_cpu_has_vid", "(", "vmcs12", ")", ")", "{", "nested_vmx_disable_intercept_for_msr", "(", "msr_bitmap_l1", ",", "msr_bitmap_l0", ",", "X2APIC_MSR", "(", "APIC_EOI", ")", ",", "MSR_TYPE_W", ")", ";", "X2APIC_MSR", "(", "APIC_SELF_IPI", ")", ","], "docstring_tokens": ["crash", "the", "host", "kernel"]}
{"contents": ["empty"], "code_tokens": ["expect", "(", "request", ".", "getPathInfo", "(", "))", ".", "andReturn", "(", "path", ")", ";", "uri", "=", "valueOrEmpty", "(", "request", ".", "getContextPath", "(", "))", "+", "\"", "/\"", "valueOrEmpty", "(", "request", ".", "getServletPath", "(", "))", "valueOrEmpty", "(", "request", ".", "getPathInfo", "(", "))", ";", "private", "static", "String", "valueOrEmpty", "(", "String", "input", ")", "{", "if", "(", "input", "=", "=", "null", ")", "{", "return", "\"", "\";", "}", "return", "input", ";", "}", "@", "Test", "void", "testGetRequestUriWithServlet", "(", ")", "{", "dotTestGetPathWithinApplicationFromRequest", "(", "\"/", "\",", "\"", "/", "servlet", "\"", ",", "\"", "/", "foobar", "\"", ",", "\"", "/", "servlet", "/", "foobar", "\"", ")", "dotTestGetPathWithinApplicationFromRequest", "(", "\"\"", ",", "\"", "/", "servlet", "\"", ",", "\"", "/", "foobar", "\"", ",", "\"", "/", "servlet", "/", "foobar", "\"", ")", "dotTestGetPathWithinApplicationFromRequest", "(", "\"\"", ",", "\"", "servlet", "\"", ",", "\"", "/", "foobar", "\"", ",", "\"", "/", "servlet", "/", "foobar", "\"", ")", "dotTestGetPathWithinApplicationFromRequest", "(", "\"/", "\",", "\"", "servlet", "\"", ",", "\"", "/", "foobar", "\"", ",", "\"", "/", "servlet", "/", "foobar", "\"", ")", "dotTestGetPathWithinApplicationFromRequest", "(", "\"/", "/\"", ",", "\"", "servlet", "\"", ",", "\"", "/", "foobar", "\"", ",", "\"", "/", "servlet", "/", "foobar", "\"", ")", "dotTestGetPathWithinApplicationFromRequest", "(", "\"/", "/\"", ",", "\"", "//", "servlet", "\"", ",", "\"", "//", "foobar", "\"", ",", "\"", "/", "servlet", "/", "foobar", "\"", ")", "dotTestGetPathWithinApplicationFromRequest", "(", "\"/", "context", "-", "path", "\"", ",", "\"", "/", "servlet", "\"", ",", "\"", "/", "foobar", "\"", ",", "\"", "/", "servlet", "/", "foobar", "\"", ")", "dotTestGetPathWithinApplicationFromRequest", "(", "\"/", "/", "context", "-", "path", "\"", ",", "\"", "//", "servlet", "\"", ",", "\"", "//", "foobar", "\"", ",", "\"", "/", "servlet", "/", "foobar", "\"", ")", "dotTestGetPathWithinApplicationFromRequest", "(", "\"/", "/", "context", "-", "path", "\"", ",", "\"", "/", "servlet", "\"", ",", "\"", "/.", "./", "servlet", "/", "other", "\"", ",", "\"", "/", "servlet", "/", "other", "\"", ")", "dotTestGetPathWithinApplicationFromRequest", "(", "\"/", "/", "context", "-", "path", "\"", ",", "\"", "/", "asdf", "\"", ",", "\"", "/.", "./", "servlet", "/", "other", "\"", ",", "\"", "/", "servlet", "/", "other", "\"", ")", "dotTestGetPathWithinApplicationFromRequest", "(", "\"/", "/", "context", "-", "path", "\"", ",", "\"", "/", "asdf", "\"", ",", "\"", ";/", "..", "/", "servlet", "/", "other", "\"", ",", "\"", "/", "asdf", "\"", ")", "dotTestGetPathWithinApplicationFromRequest", "(", "\"/", "context", "%", "2525path", "\"", ",", "\"", "/", "servlet", "\"", ",", "\"", "/", "foobar", "\"", ",", "\"", "/", "servlet", "/", "foobar", "\"", ")", "dotTestGetPathWithinApplicationFromRequest", "(", "\"/", "c", "%", "6Fntext", "%", "20path", "\"", ",", "\"", "/", "servlet", "\"", ",", "\"", "/", "foobar", "\"", ",", "\"", "/", "servlet", "/", "foobar", "\"", ")", "dotTestGetPathWithinApplicationFromRequest", "(", "\"/", "context", "path", "\"", ",", "\"", "/", "servlet", "\"", ",", "\"", "/", "foobar", "\"", ",", "\"", "/", "servlet", "/", "foobar", "\"", ")", "dotTestGetPathWithinApplicationFromRequest", "(", "\"\"", ",", "null", ",", "null", ",", "\"", "/\"", ")", "dotTestGetPathWithinApplicationFromRequest", "(", "\"\"", ",", "\"", "index", ".", "jsp", "\"", ",", "null", ",", "\"", "/", "index", ".", "jsp", "\"", ")", "}", "void", "dotTestGetPathWithinApplicationFromRequest", "(", "String", "contextPath", ",", "String", "servletPath", ",", "String", "pathInfo", ",", "String", "expectedValue", ")", "{", "HttpServletRequest", "request", "=", "createMock", "(", "HttpServletRequest", ")", "expect", "(", "request", ".", "getAttribute", "(", "WebUtils", ".", "INCLUDE_CONTEXT_PATH_ATTRIBUTE", ")", ").", "andReturn", "(", "null", ")", "expect", "(", "request", ".", "getAttribute", "(", "WebUtils", ".", "INCLUDE_REQUEST_URI_ATTRIBUTE", ")", ").", "andReturn", "(", "null", ")", "expect", "(", "request", ".", "getServletPath", "(", "))", ".", "andReturn", "(", "servletPath", ")", "expect", "(", "request", ".", "getContextPath", "(", "))", ".", "andReturn", "(", "contextPath", ")", ".", "times", "(", "2", ")", "expect", "(", "request", ".", "getPathInfo", "(", "))", ".", "andReturn", "(", "pathInfo", ")", "expect", "(", "request", ".", "getCharacterEncoding", "(", "))", ".", "andReturn", "(", "\"", "UTF", "-", "8", "\"", ").", "anyTimes", "(", ")", "replay", "request", "assertEquals", "expectedValue", ",", "WebUtils", ".", "getPathWithinApplication", "(", "request", ")", "verify", "request", "}", "expect", "(", "request", ".", "getServletPath", "(", "))", ".", "andReturn", "(", "\"\"", ").", "anyTimes", "(", ");", "expect", "(", "request", ".", "getPathInfo", "(", "))", ".", "andReturn", "(", "ENABLED_PATH", ")", ".", "anyTimes", "(", ");", "expect", "(", "request", ".", "getServletPath", "(", "))", ".", "andReturn", "(", "\"\"", ").", "anyTimes", "(", ");", "expect", "(", "request", ".", "getPathInfo", "(", "))", ".", "andReturn", "(", "\"/", "\")", ".", "anyTimes", "(", ");", "expect", "(", "request", ".", "getServletPath", "(", "))", ".", "andReturn", "(", "\"\"", ").", "anyTimes", "(", ");", "expect", "(", "request", ".", "getPathInfo", "(", "))", ".", "andReturn", "(", "\"/", "resource", "/", "book", "\"", ").", "anyTimes", "(", ");", "expect", "(", "request", ".", "getServletPath", "(", "))", ".", "andReturn", "(", "\"\"", ").", "anyTimes", "(", ");", "expect", "(", "request", ".", "getPathInfo", "(", "))", ".", "andReturn", "(", "\"/", "resource", "/", "book", "/", "\")", ".", "anyTimes", "(", ");", "expect", "(", "request", ".", "getServletPath", "(", "))", ".", "andReturn", "(", "\"\"", ").", "anyTimes", "(", ");", "expect", "(", "request", ".", "getPathInfo", "(", "))", ".", "andReturn", "(", "\"/", "resource", "/", "book", "/", "/\"", ").", "anyTimes", "(", ");", "expect", "(", "request", ".", "getServletPath", "(", "))", ".", "andReturn", "(", "\"\"", ");", "expect", "(", "request", ".", "getPathInfo", "(", "))", ".", "andReturn", "(", "\"/", "index", ".", "html", "\"", ");", "expect", "(", "request", ".", "getServletPath", "(", "))", ".", "andReturn", "(", "\"/", "\")", ";", "expect", "(", "request", ".", "getPathInfo", "(", "))", ".", "andReturn", "(", "\".", "/", "index", ".", "html", "\"", ");", "expect", "(", "request", ".", "getServletPath", "(", "))", ".", "andReturn", "(", "\"/", "public", "/", "\")", ";", "expect", "(", "request", ".", "getPathInfo", "(", "))", ".", "andReturn", "(", "\".", "./", "index", ".", "html", "\"", ");", "expect", "(", "request", ".", "getServletPath", "(", "))", ".", "andReturn", "(", "\"/", "\")", ";", "expect", "(", "request", ".", "getPathInfo", "(", "))", ".", "andReturn", "(", "null", ")", ";", "expect", "(", "request", ".", "getServletPath", "(", "))", ".", "andReturn", "(", "\"\"", ");", "expect", "(", "request", ".", "getPathInfo", "(", "))", ".", "andReturn", "(", "\"/", "resource", "/", "book", "\"", ");", "expect", "(", "request", ".", "getServletPath", "(", "))", ".", "andReturn", "(", "\"/", "\")", ";", "expect", "(", "request", ".", "getPathInfo", "(", "))", ".", "andReturn", "(", "null", ")", ";", "expect", "(", "request", ".", "getServletPath", "(", "))", ".", "andReturn", "(", "\"\"", ");", "expect", "(", "request", ".", "getPathInfo", "(", "))", ".", "andReturn", "(", "\"/", "resource", "/", "book", "\"", ");", "expect", "(", "request", ".", "getServletPath", "(", "))", ".", "andReturn", "(", "\"\"", ");", "expect", "(", "request", ".", "getPathInfo", "(", "))", ".", "andReturn", "(", "\"/", "resource", "/", "book", "/", "/\"", ");</s>expect", "(", "request", ".", "getRequestURI", "(", "))", ".", "andReturn", "(", "path", ")", ";", "uri", "=", "request", ".", "getRequestURI", "(", ");", "expect", "(", "request", ".", "getRequestURI", "(", "))", ".", "andReturn", "(", "\"/", "index", ".", "html", "\"", ");", "expect", "(", "request", ".", "getRequestURI", "(", "))", ".", "andReturn", "(", "\"/", "./", "index", ".", "html", "\"", ");", "expect", "(", "request", ".", "getRequestURI", "(", "))", ".", "andReturn", "(", "\"/", "public", "/", "..", "/", "index", ".", "html", "\"", ");", "expect", "(", "request", ".", "getRequestURI", "(", "))", ".", "andReturn", "(", "\"/", "\")", ";", "expect", "(", "request", ".", "getRequestURI", "(", "))", ".", "andReturn", "(", "\"/", "resource", "/", "book", "\"", ");", "expect", "(", "request", ".", "getRequestURI", "(", "))", ".", "andReturn", "(", "\"/", "\")", ";", "expect", "(", "request", ".", "getRequestURI", "(", "))", ".", "andReturn", "(", "\"/", "resource", "/", "book", "/", "\")", ";", "expect", "(", "request", ".", "getRequestURI", "(", "))", ".", "andReturn", "(", "\"/", "resource", "/", "book", "/", "/\"", ");"], "docstring_tokens": ["cause", "an", "authentication", "bypass", "."]}
{"contents": ["empty"], "code_tokens": ["Note", ":", "Be", "aware", "that", "root", "can", "mis", "-", "use", "this", "driver", "to", "modify", "arbitrary", "memory", "and", "gain", "additional", "rights", ",", "if", "root", "'", "s", "privileges", "got", "restricted", "(", "for", "example", "if", "root", "is", "not", "allowed", "to", "load", "additional", "modules", "after", "boot", ")", ".", "@", "@", "-", "380", ",", "6", "+", "380", ",", "21", "@", "@", "config", "ACPI_HED", "config", "ACPI_CUSTOM_METHOD", "tristate", "\"", "Allow", "ACPI", "methods", "to", "be", "inserted", "/", "replaced", "at", "run", "time", "\"", "depends", "on", "DEBUG_FS", "default", "n", "help", "This", "debug", "facility", "allows", "ACPI", "AML", "methods", "to", "me", "inserted", "and", "/", "or", "replaced", "without", "rebooting", "the", "system", ".", "For", "details", "refer", "to", ":", "Documentation", "/", "acpi", "/", "method", "-", "customizing", ".", "txt", ".", "NOTE", ":", "This", "option", "is", "security", "sensitive", ",", "because", "it", "allows", "arbitrary", "kernel", "memory", "to", "be", "written", "to", "by", "root", "(", "uid", "=", "0", ")", "users", ",", "allowing", "them", "to", "bypass", "certain", "security", "measures", "(", "e", ".", "g", ".", "if", "root", "is", "not", "allowed", "to", "load", "additional", "kernel", "modules", "after", "boot", ",", "this", "feature", "may", "be", "used", "to", "override", "that", "restriction", ")", ".", "obj", "-", "$(", "CONFIG_ACPI_CUSTOM_METHOD", ")", "+=", "custom_method", ".", "o", "/", "*", "*", "debugfs", ".", "c", "-", "ACPI", "debugfs", "interface", "to", "userspace", ".", "*", "/", "#", "include", "<", "linux", "/", "init", ".", "h", ">", "#", "include", "<", "linux", "/", "module", ".", "h", ">", "#", "include", "<", "linux", "/", "kernel", ".", "h", ">", "#", "include", "<", "linux", "/", "uaccess", ".", "h", ">", "#", "include", "<", "linux", "/", "debugfs", ".", "h", ">", "#", "include", "<", "acpi", "/", "acpi_drivers", ".", "h", ">", "#", "include", "\"", "internal", ".", "h", "\"", "#", "define", "_COMPONENT", "ACPI_SYSTEM_COMPONENT", "ACPI_MODULE_NAME", "(", "\"", "custom_method", "\"", ");", "MODULE_LICENSE", "(", "\"", "GPL", "\"", ");", "static", "struct", "dentry", "*", "cm_dentry", ";", "/", "*", "/", "sys", "/", "kernel", "/", "debug", "/", "acpi", "/", "custom_method", "*", "/", "static", "ssize_t", "cm_write", "(", "struct", "file", "*", "file", ",", "const", "char", "__user", "*", "user_buf", ",", "size_t", "count", ",", "loff_t", "*", "ppos", ")", "{", "static", "char", "*", "buf", ";", "static", "u32", "max_size", ";", "static", "u32", "uncopied_bytes", ";", "struct", "acpi_table_header", "table", ";", "acpi_status", "status", ";", "if", "(", "!(", "*", "ppos", ")", ")", "{", "/", "*", "parse", "the", "table", "header", "to", "get", "the", "table", "length", "*", "/", "if", "(", "count", "<", "=", "sizeof", "(", "struct", "acpi_table_header", ")", ")", "return", "-", "EINVAL", ";", "if", "(", "copy_from_user", "(", "&", "table", ",", "user_buf", ",", "sizeof", "(", "struct", "acpi_table_header", ")", "))", "return", "-", "EFAULT", ";", "uncopied_bytes", "=", "max_size", "=", "table", ".", "length", ";", "buf", "=", "kzalloc", "(", "max_size", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "buf", ")", "return", "-", "ENOMEM", ";", "}", "if", "(", "buf", "=", "=", "NULL", ")", "return", "-", "EINVAL", ";", "if", "(", "(*", "ppos", ">", "max_size", ")", "|", "|", "(", "*", "ppos", "+", "count", ">", "max_size", ")", "|", "|", "(", "*", "ppos", "+", "count", "<", "count", ")", "|", "|", "(", "count", ">", "uncopied_bytes", ")", ")", "return", "-", "EINVAL", ";", "if", "(", "copy_from_user", "(", "buf", "+", "(", "*", "ppos", ")", ",", "user_buf", ",", "count", ")", ")", "{", "kfree", "(", "buf", ")", ";", "buf", "=", "NULL", ";", "return", "-", "EFAULT", ";", "}", "uncopied_bytes", "-", "=", "count", ";", "*", "ppos", "+", "=", "count", ";", "if", "(", "!", "uncopied_bytes", ")", "{", "status", "=", "acpi_install_method", "(", "buf", ")", ";", "kfree", "(", "buf", ")", ";", "buf", "=", "NULL", ";", "if", "(", "ACPI_FAILURE", "(", "status", ")", ")", "return", "-", "EINVAL", ";", "add_taint", "(", "TAINT_OVERRIDDEN_ACPI_TABLE", ")", ";", "}", "return", "count", ";", "}", "static", "const", "struct", "file_operations", "cm_fops", "=", "{", ".", "write", "=", "cm_write", ",", ".", "llseek", "=", "default_llseek", ",", "}", ";", "static", "int", "__init", "acpi_custom_method_init", "(", "void", ")", "{", "if", "(", "acpi_debugfs_dir", "=", "=", "NULL", ")", "return", "-", "ENOENT", ";", "cm_dentry", "=", "debugfs_create_file", "(", "\"", "custom_method", "\"", ",", "S_IWUSR", ",", "acpi_debugfs_dir", ",", "NULL", ",", "&", "cm_fops", ")", ";", "if", "(", "cm_dentry", "=", "=", "NULL", ")", "return", "-", "ENODEV", ";", "return", "0", ";", "}", "static", "void", "__exit", "acpi_custom_method_exit", "(", "void", ")", "{", "if", "(", "cm_dentry", ")", "debugfs_remove", "(", "cm_dentry", ")", ";", "}", "module_init", "(", "acpi_custom_method_init", ")", ";", "module_exit", "(", "acpi_custom_method_exit", ")", ";", "@", "@", "-", "3", ",", "94", "+", "3", ",", "16", "@", "@", "EXPORT_SYMBOL_GPL", "(", "acpi_debugfs_dir", ")", ";</s>#", "include", "<", "linux", "/", "module", ".", "h", ">", "#", "include", "<", "linux", "/", "kernel", ".", "h", ">", "#", "include", "<", "linux", "/", "uaccess", ".", "h", ">", "static", "struct", "dentry", "*", "cm_dentry", ";", "/", "*", "/", "sys", "/", "kernel", "/", "debug", "/", "acpi", "/", "custom_method", "*", "/", "static", "ssize_t", "cm_write", "(", "struct", "file", "*", "file", ",", "const", "char", "__user", "*", "user_buf", ",", "size_t", "count", ",", "loff_t", "*", "ppos", ")", "{", "static", "char", "*", "buf", ";", "static", "u32", "max_size", ";", "static", "u32", "uncopied_bytes", ";", "struct", "acpi_table_header", "table", ";", "acpi_status", "status", ";", "if", "(", "!(", "*", "ppos", ")", ")", "{", "/", "*", "parse", "the", "table", "header", "to", "get", "the", "table", "length", "*", "/", "if", "(", "count", "<", "=", "sizeof", "(", "struct", "acpi_table_header", ")", ")", "return", "-", "EINVAL", ";", "if", "(", "copy_from_user", "(", "&", "table", ",", "user_buf", ",", "sizeof", "(", "struct", "acpi_table_header", ")", "))", "return", "-", "EFAULT", ";", "uncopied_bytes", "=", "max_size", "=", "table", ".", "length", ";", "buf", "=", "kzalloc", "(", "max_size", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "buf", ")", "return", "-", "ENOMEM", ";", "}", "if", "(", "buf", "=", "=", "NULL", ")", "return", "-", "EINVAL", ";", "if", "(", "(*", "ppos", ">", "max_size", ")", "|", "|", "(", "*", "ppos", "+", "count", ">", "max_size", ")", "|", "|", "(", "*", "ppos", "+", "count", "<", "count", ")", "|", "|", "(", "count", ">", "uncopied_bytes", ")", ")", "return", "-", "EINVAL", ";", "if", "(", "copy_from_user", "(", "buf", "+", "(", "*", "ppos", ")", ",", "user_buf", ",", "count", ")", ")", "{", "kfree", "(", "buf", ")", ";", "buf", "=", "NULL", ";", "return", "-", "EFAULT", ";", "}", "uncopied_bytes", "-", "=", "count", ";", "*", "ppos", "+", "=", "count", ";", "if", "(", "!", "uncopied_bytes", ")", "{", "status", "=", "acpi_install_method", "(", "buf", ")", ";", "kfree", "(", "buf", ")", ";", "buf", "=", "NULL", ";", "if", "(", "ACPI_FAILURE", "(", "status", ")", ")", "return", "-", "EINVAL", ";", "add_taint", "(", "TAINT_OVERRIDDEN_ACPI_TABLE", ")", ";", "}", "return", "count", ";", "}", "static", "const", "struct", "file_operations", "cm_fops", "=", "{", ".", "write", "=", "cm_write", ",", ".", "llseek", "=", "default_llseek", ",", "}", ";", "static", "int", "__init", "acpi_custom_method_init", "(", "void", ")", "{", "if", "(", "!", "acpi_debugfs_dir", ")", "return", "-", "ENOENT", ";", "cm_dentry", "=", "debugfs_create_file", "(", "\"", "custom_method", "\"", ",", "S_IWUSR", ",", "acpi_debugfs_dir", ",", "NULL", ",", "&", "cm_fops", ")", ";", "if", "(", "!", "cm_dentry", ")", "return", "-", "ENODEV", ";", "return", "0", ";", "}", "acpi_custom_method_init", "(", ");"], "docstring_tokens": ["likely", "resulting", "in", "escalated", "capability", "privileges[1]"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "pte", ")", "else", "if", "(", "walk", "-", ">", "pte_hole", ")", "err", "=", "walk", "-", ">", "pte_hole", "(", "addr", ",", "next", ",", "walk", ")", ";</s>if", "(", "pte", "&", "&", "walk", "-", ">", "hugetlb_entry", ")"], "docstring_tokens": ["obtain", "sensitive", "information", "from", "uninitialized", "kernel", "memory"]}
{"contents": ["empty"], "code_tokens": ["int", "skb_zerocopy", "(", "struct", "sk_buff", "*", "to", ",", "struct", "sk_buff", "*", "from", ",", "int", "len", ",", "int", "hlen", ")", ";", "*", "*", "Return", "value", ":", "*", "0", ":", "everything", "is", "OK", "*", "-", "ENOMEM", ":", "couldn", "'", "t", "orphan", "frags", "of", "@", "from", "due", "to", "lack", "of", "memory", "*", "-", "EFAULT", ":", "skb_copy_bits", "(", ")", "found", "some", "problem", "with", "skb", "geometry", "int", "skb_zerocopy", "(", "struct", "sk_buff", "*", "to", ",", "struct", "sk_buff", "*", "from", ",", "int", "len", ",", "int", "hlen", ")", "int", "ret", ";", "if", "(", "len", "<", "=", "skb_tailroom", "(", "to", ")", ")", "return", "skb_copy_bits", "(", "from", ",", "0", ",", "skb_put", "(", "to", ",", "len", ")", ",", "len", ")", ";", "ret", "=", "skb_copy_bits", "(", "from", ",", "0", ",", "skb_put", "(", "to", ",", "hlen", ")", ",", "hlen", ")", ";", "if", "(", "unlikely", "(", "ret", ")", ")", "return", "ret", ";", "if", "(", "unlikely", "(", "skb_orphan_frags", "(", "from", ",", "GFP_ATOMIC", ")", "))", "{", "skb_tx_error", "(", "from", ")", ";", "return", "-", "ENOMEM", ";", "}", "return", "0", ";", "if", "(", "!", "skb", ")", "{", "skb_tx_error", "(", "entskb", ")", ";", "}", "skb_tx_error", "(", "entskb", ")", ";", "if", "(", "skb_zerocopy", "(", "skb", ",", "entskb", ",", "data_len", ",", "hlen", ")", ")", "goto", "nla_put_failure", ";", "skb_tx_error", "(", "entskb", ")", ";", "err", "=", "skb_zerocopy", "(", "user_skb", ",", "skb", ",", "skb", "-", ">", "len", ",", "hlen", ")", ";", "if", "(", "err", ")", "goto", "out", ";", "if", "(", "err", ")", "skb_tx_error", "(", "skb", ")", ";</s>void", "skb_zerocopy", "(", "struct", "sk_buff", "*", "to", ",", "const", "struct", "sk_buff", "*", "from", ",", "int", "len", ",", "int", "hlen", ")", ";", "void", "skb_zerocopy", "(", "struct", "sk_buff", "*", "to", ",", "const", "struct", "sk_buff", "*", "from", ",", "int", "len", ",", "int", "hlen", ")", "if", "(", "len", "<", "=", "skb_tailroom", "(", "to", ")", ")", "{", "skb_copy_bits", "(", "from", ",", "0", ",", "skb_put", "(", "to", ",", "len", ")", ",", "len", ")", ";", "return", ";", "}", "skb_copy_bits", "(", "from", ",", "0", ",", "skb_put", "(", "to", ",", "hlen", ")", ",", "hlen", ")", ";", "if", "(", "!", "skb", ")", "skb_zerocopy", "(", "skb", ",", "entskb", ",", "data_len", ",", "hlen", ")", ";", "skb_zerocopy", "(", "user_skb", ",", "skb", ",", "skb", "-", ">", "len", ",", "hlen", ")", ";"], "docstring_tokens": ["obtain", "sensitive", "information", "from", "kernel", "memory"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "!", "check_mnt", "(", "real_mount", "(", "path", "-", ">", "mnt", ")", "))", "tree", "=", "ERR_PTR", "(", "-", "EINVAL", ")", ";", "else", "tree", "=", "copy_tree", "(", "real_mount", "(", "path", "-", ">", "mnt", ")", ",", "path", "-", ">", "dentry", ",", "CL_COPY_ALL", "|", "CL_PRIVATE", ")", ";</s>tree", "=", "copy_tree", "(", "real_mount", "(", "path", "-", ">", "mnt", ")", ",", "path", "-", ">", "dentry", ",", "CL_COPY_ALL", "|", "CL_PRIVATE", ")", ";"], "docstring_tokens": ["gain", "access", "to", "every", "file", "on", "essentially", "any", "filesystem", "in", "the", "mount", "namespace"]}
{"contents": ["empty"], "code_tokens": ["#", "define", "DRM_IOCTL_DEF", "(", "ioctl", ",", "_func", ",", "_flags", ")", "\\", "[", "DRM_IOCTL_NR", "(", "ioctl", ")", "]", "=", "{", ".", "cmd", "=", "ioctl", ",", ".", "func", "=", "_func", ",", ".", "flags", "=", "_flags", ",", ".", "cmd_drv", "=", "0", "}", "unsigned", "int", "usize", ",", "asize", ";", "(", "nr", "<", "DRM_COMMAND_BASE", "+", "dev", "-", ">", "driver", "-", ">", "num_ioctls", ")", ")", "{", "u32", "drv_size", ";", "drv_size", "=", "_IOC_SIZE", "(", "ioctl", "-", ">", "cmd_drv", ")", ";", "usize", "=", "asize", "=", "_IOC_SIZE", "(", "cmd", ")", ";", "if", "(", "drv_size", ">", "asize", ")", "asize", "=", "drv_size", ";", "}", "usize", "=", "asize", "=", "_IOC_SIZE", "(", "cmd", ")", ";", "if", "(", "asize", "<", "=", "sizeof", "(", "stack_kdata", ")", ")", "{", "kdata", "=", "kmalloc", "(", "asize", ",", "GFP_KERNEL", ")", ";", "usize", ")", "!", "=", "0", ")", "{", "memset", "(", "kdata", ",", "0", ",", "usize", ")", ";", "usize", ")", "!", "=", "0", ")", "DRM_IOCTL_DEF_DRV", "(", "I810_INIT", ",", "i810_dma_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I810_VERTEX", ",", "i810_dma_vertex", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I810_CLEAR", ",", "i810_clear_bufs", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I810_FLUSH", ",", "i810_flush_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I810_GETAGE", ",", "i810_getage", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I810_GETBUF", ",", "i810_getbuf", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I810_SWAP", ",", "i810_swap_bufs", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I810_COPY", ",", "i810_copybuf", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I810_DOCOPY", ",", "i810_docopy", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I810_OV0INFO", ",", "i810_ov0_info", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I810_FSTATUS", ",", "i810_fstatus", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I810_OV0FLIP", ",", "i810_ov0_flip", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I810_MC", ",", "i810_dma_mc", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I810_RSTATUS", ",", "i810_rstatus", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I810_FLIP", ",", "i810_flip_bufs", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I830_INIT", ",", "i830_dma_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I830_VERTEX", ",", "i830_dma_vertex", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I830_CLEAR", ",", "i830_clear_bufs", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I830_FLUSH", ",", "i830_flush_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I830_GETAGE", ",", "i830_getage", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I830_GETBUF", ",", "i830_getbuf", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I830_SWAP", ",", "i830_swap_bufs", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I830_COPY", ",", "i830_copybuf", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I830_DOCOPY", ",", "i830_docopy", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I830_FLIP", ",", "i830_flip_bufs", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I830_IRQ_EMIT", ",", "i830_irq_emit", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I830_IRQ_WAIT", ",", "i830_irq_wait", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I830_GETPARAM", ",", "i830_getparam", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I830_SETPARAM", ",", "i830_setparam", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_INIT", ",", "i915_dma_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_FLUSH", ",", "i915_flush_ioctl", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_FLIP", ",", "i915_flip_bufs", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_BATCHBUFFER", ",", "i915_batchbuffer", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_IRQ_EMIT", ",", "i915_irq_emit", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_IRQ_WAIT", ",", "i915_irq_wait", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GETPARAM", ",", "i915_getparam", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_SETPARAM", ",", "i915_setparam", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_ALLOC", ",", "i915_mem_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_FREE", ",", "i915_mem_free", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_INIT_HEAP", ",", "i915_mem_init_heap", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_CMDBUFFER", ",", "i915_cmdbuffer", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_DESTROY_HEAP", ",", "i915_mem_destroy_heap", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_SET_VBLANK_PIPE", ",", "i915_vblank_pipe_set", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GET_VBLANK_PIPE", ",", "i915_vblank_pipe_get", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_VBLANK_SWAP", ",", "i915_vblank_swap", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_HWS_ADDR", ",", "i915_set_status_page", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_INIT", ",", "i915_gem_init_ioctl", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_EXECBUFFER", ",", "i915_gem_execbuffer", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_EXECBUFFER2", ",", "i915_gem_execbuffer2", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_PIN", ",", "i915_gem_pin_ioctl", ",", "DRM_AUTH", "|", "DRM_ROOT_ONLY", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_UNPIN", ",", "i915_gem_unpin_ioctl", ",", "DRM_AUTH", "|", "DRM_ROOT_ONLY", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_BUSY", ",", "i915_gem_busy_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_THROTTLE", ",", "i915_gem_throttle_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_ENTERVT", ",", "i915_gem_entervt_ioctl", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_LEAVEVT", ",", "i915_gem_leavevt_ioctl", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_CREATE", ",", "i915_gem_create_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_PREAD", ",", "i915_gem_pread_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_PWRITE", ",", "i915_gem_pwrite_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_MMAP", ",", "i915_gem_mmap_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_MMAP_GTT", ",", "i915_gem_mmap_gtt_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_SET_DOMAIN", ",", "i915_gem_set_domain_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_SW_FINISH", ",", "i915_gem_sw_finish_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_SET_TILING", ",", "i915_gem_set_tiling", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_GET_TILING", ",", "i915_gem_get_tiling", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_GET_APERTURE", ",", "i915_gem_get_aperture_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GET_PIPE_FROM_CRTC_ID", ",", "intel_get_pipe_from_crtc_id", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_GEM_MADVISE", ",", "i915_gem_madvise_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_OVERLAY_PUT_IMAGE", ",", "intel_overlay_put_image", ",", "DRM_MASTER", "|", "DRM_CONTROL_ALLOW", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "I915_OVERLAY_ATTRS", ",", "intel_overlay_attrs", ",", "DRM_MASTER", "|", "DRM_CONTROL_ALLOW", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "MGA_INIT", ",", "mga_dma_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "MGA_FLUSH", ",", "mga_dma_flush", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "MGA_RESET", ",", "mga_dma_reset", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "MGA_SWAP", ",", "mga_dma_swap", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "MGA_CLEAR", ",", "mga_dma_clear", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "MGA_VERTEX", ",", "mga_dma_vertex", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "MGA_INDICES", ",", "mga_dma_indices", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "MGA_ILOAD", ",", "mga_dma_iload", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "MGA_BLIT", ",", "mga_dma_blit", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "MGA_GETPARAM", ",", "mga_getparam", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "MGA_SET_FENCE", ",", "mga_set_fence", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "MGA_WAIT_FENCE", ",", "mga_wait_fence", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "MGA_DMA_BOOTSTRAP", ",", "mga_dma_bootstrap", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "NOUVEAU_GETPARAM", ",", "nouveau_ioctl_getparam", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "NOUVEAU_SETPARAM", ",", "nouveau_ioctl_setparam", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "NOUVEAU_CHANNEL_ALLOC", ",", "nouveau_ioctl_fifo_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "NOUVEAU_CHANNEL_FREE", ",", "nouveau_ioctl_fifo_free", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "NOUVEAU_GROBJ_ALLOC", ",", "nouveau_ioctl_grobj_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "NOUVEAU_NOTIFIEROBJ_ALLOC", ",", "nouveau_ioctl_notifier_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "NOUVEAU_GPUOBJ_FREE", ",", "nouveau_ioctl_gpuobj_free", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "NOUVEAU_GEM_NEW", ",", "nouveau_gem_ioctl_new", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "NOUVEAU_GEM_PUSHBUF", ",", "nouveau_gem_ioctl_pushbuf", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "NOUVEAU_GEM_CPU_PREP", ",", "nouveau_gem_ioctl_cpu_prep", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "NOUVEAU_GEM_CPU_FINI", ",", "nouveau_gem_ioctl_cpu_fini", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "NOUVEAU_GEM_INFO", ",", "nouveau_gem_ioctl_info", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "R128_INIT", ",", "r128_cce_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "R128_CCE_START", ",", "r128_cce_start", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "R128_CCE_STOP", ",", "r128_cce_stop", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "R128_CCE_RESET", ",", "r128_cce_reset", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "R128_CCE_IDLE", ",", "r128_cce_idle", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "R128_RESET", ",", "r128_engine_reset", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "R128_FULLSCREEN", ",", "r128_fullscreen", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "R128_SWAP", ",", "r128_cce_swap", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "R128_FLIP", ",", "r128_cce_flip", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "R128_CLEAR", ",", "r128_cce_clear", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "R128_VERTEX", ",", "r128_cce_vertex", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "R128_INDICES", ",", "r128_cce_indices", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "R128_BLIT", ",", "r128_cce_blit", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "R128_DEPTH", ",", "r128_cce_depth", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "R128_STIPPLE", ",", "r128_cce_stipple", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "R128_INDIRECT", ",", "r128_cce_indirect", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "R128_GETPARAM", ",", "r128_getparam", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CP_INIT", ",", "radeon_cp_init_kms", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CP_START", ",", "radeon_cp_start_kms", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CP_STOP", ",", "radeon_cp_stop_kms", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CP_RESET", ",", "radeon_cp_reset_kms", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CP_IDLE", ",", "radeon_cp_idle_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CP_RESUME", ",", "radeon_cp_resume_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_RESET", ",", "radeon_engine_reset_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_FULLSCREEN", ",", "radeon_fullscreen_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_SWAP", ",", "radeon_cp_swap_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CLEAR", ",", "radeon_cp_clear_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_VERTEX", ",", "radeon_cp_vertex_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_INDICES", ",", "radeon_cp_indices_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_TEXTURE", ",", "radeon_cp_texture_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_STIPPLE", ",", "radeon_cp_stipple_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_INDIRECT", ",", "radeon_cp_indirect_kms", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_VERTEX2", ",", "radeon_cp_vertex2_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CMDBUF", ",", "radeon_cp_cmdbuf_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_GETPARAM", ",", "radeon_cp_getparam_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_FLIP", ",", "radeon_cp_flip_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_ALLOC", ",", "radeon_mem_alloc_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_FREE", ",", "radeon_mem_free_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_INIT_HEAP", ",", "radeon_mem_init_heap_kms", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_IRQ_EMIT", ",", "radeon_irq_emit_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_IRQ_WAIT", ",", "radeon_irq_wait_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_SETPARAM", ",", "radeon_cp_setparam_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_SURF_ALLOC", ",", "radeon_surface_alloc_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_SURF_FREE", ",", "radeon_surface_free_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_GEM_INFO", ",", "radeon_gem_info_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_GEM_CREATE", ",", "radeon_gem_create_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_GEM_MMAP", ",", "radeon_gem_mmap_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_GEM_SET_DOMAIN", ",", "radeon_gem_set_domain_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_GEM_PREAD", ",", "radeon_gem_pread_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_GEM_PWRITE", ",", "radeon_gem_pwrite_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_GEM_WAIT_IDLE", ",", "radeon_gem_wait_idle_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CS", ",", "radeon_cs_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_INFO", ",", "radeon_info_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_GEM_SET_TILING", ",", "radeon_gem_set_tiling_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_GEM_GET_TILING", ",", "radeon_gem_get_tiling_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_GEM_BUSY", ",", "radeon_gem_busy_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CP_INIT", ",", "radeon_cp_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CP_START", ",", "radeon_cp_start", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CP_STOP", ",", "radeon_cp_stop", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CP_RESET", ",", "radeon_cp_reset", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CP_IDLE", ",", "radeon_cp_idle", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CP_RESUME", ",", "radeon_cp_resume", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_RESET", ",", "radeon_engine_reset", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_FULLSCREEN", ",", "radeon_fullscreen", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_SWAP", ",", "radeon_cp_swap", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CLEAR", ",", "radeon_cp_clear", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_VERTEX", ",", "radeon_cp_vertex", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_INDICES", ",", "radeon_cp_indices", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_TEXTURE", ",", "radeon_cp_texture", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_STIPPLE", ",", "radeon_cp_stipple", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_INDIRECT", ",", "radeon_cp_indirect", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_VERTEX2", ",", "radeon_cp_vertex2", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CMDBUF", ",", "radeon_cp_cmdbuf", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_GETPARAM", ",", "radeon_cp_getparam", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_FLIP", ",", "radeon_cp_flip", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_ALLOC", ",", "radeon_mem_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_FREE", ",", "radeon_mem_free", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_INIT_HEAP", ",", "radeon_mem_init_heap", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_IRQ_EMIT", ",", "radeon_irq_emit", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_IRQ_WAIT", ",", "radeon_irq_wait", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_SETPARAM", ",", "radeon_cp_setparam", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_SURF_ALLOC", ",", "radeon_surface_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_SURF_FREE", ",", "radeon_surface_free", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "RADEON_CS", ",", "r600_cs_legacy_ioctl", ",", "DRM_AUTH", ")", "DRM_IOCTL_DEF_DRV", "(", "SAVAGE_BCI_INIT", ",", "savage_bci_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "SAVAGE_BCI_CMDBUF", ",", "savage_bci_cmdbuf", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "SAVAGE_BCI_EVENT_EMIT", ",", "savage_bci_event_emit", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "SAVAGE_BCI_EVENT_WAIT", ",", "savage_bci_event_wait", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "SIS_FB_ALLOC", ",", "sis_fb_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "SIS_FB_FREE", ",", "sis_drm_free", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "SIS_AGP_INIT", ",", "sis_ioctl_agp_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "SIS_AGP_ALLOC", ",", "sis_ioctl_agp_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "SIS_AGP_FREE", ",", "sis_drm_free", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "SIS_FB_INIT", ",", "sis_fb_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "VIA_ALLOCMEM", ",", "via_mem_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "VIA_FREEMEM", ",", "via_mem_free", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "VIA_AGP_INIT", ",", "via_agp_init", ",", "DRM_AUTH", "|", "DRM_MASTER", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "VIA_FB_INIT", ",", "via_fb_init", ",", "DRM_AUTH", "|", "DRM_MASTER", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "VIA_MAP_INIT", ",", "via_map_init", ",", "DRM_AUTH", "|", "DRM_MASTER", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "VIA_DEC_FUTEX", ",", "via_decoder_futex", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "VIA_DMA_INIT", ",", "via_dma_init", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "VIA_CMDBUFFER", ",", "via_cmdbuffer", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "VIA_FLUSH", ",", "via_flush_ioctl", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "VIA_PCICMD", ",", "via_pci_cmdbuffer", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "VIA_CMDBUF_SIZE", ",", "via_cmdbuf_size", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "VIA_WAIT_IRQ", ",", "via_wait_irq", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "VIA_DMA_BLIT", ",", "via_dma_blit", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF_DRV", "(", "VIA_BLIT_SYNC", ",", "via_dma_blit_sync", ",", "DRM_AUTH", ")", "[", "DRM_IOCTL_NR", "(", "DRM_IOCTL_", "#", "#", "ioctl", ")", "-", "DRM_COMMAND_BASE", "]", "=", "{", "DRM_", "#", "#", "ioctl", ",", "flags", ",", "func", ",", "DRM_IOCTL_", "#", "#", "ioctl", "}", "VMW_IOCTL_DEF", "(", "VMW_GET_PARAM", ",", "vmw_getparam_ioctl", ",", "VMW_IOCTL_DEF", "(", "VMW_ALLOC_DMABUF", ",", "vmw_dmabuf_alloc_ioctl", ",", "VMW_IOCTL_DEF", "(", "VMW_UNREF_DMABUF", ",", "vmw_dmabuf_unref_ioctl", ",", "VMW_IOCTL_DEF", "(", "VMW_CURSOR_BYPASS", ",", "VMW_IOCTL_DEF", "(", "VMW_CONTROL_STREAM", ",", "vmw_overlay_ioctl", ",", "VMW_IOCTL_DEF", "(", "VMW_CLAIM_STREAM", ",", "vmw_stream_claim_ioctl", ",", "VMW_IOCTL_DEF", "(", "VMW_UNREF_STREAM", ",", "vmw_stream_unref_ioctl", ",", "VMW_IOCTL_DEF", "(", "VMW_CREATE_CONTEXT", ",", "vmw_context_define_ioctl", ",", "VMW_IOCTL_DEF", "(", "VMW_UNREF_CONTEXT", ",", "vmw_context_destroy_ioctl", ",", "VMW_IOCTL_DEF", "(", "VMW_CREATE_SURFACE", ",", "vmw_surface_define_ioctl", ",", "VMW_IOCTL_DEF", "(", "VMW_UNREF_SURFACE", ",", "vmw_surface_destroy_ioctl", ",", "VMW_IOCTL_DEF", "(", "VMW_REF_SURFACE", ",", "vmw_surface_reference_ioctl", ",", "VMW_IOCTL_DEF", "(", "VMW_EXECBUF", ",", "vmw_execbuf_ioctl", ",", "VMW_IOCTL_DEF", "(", "VMW_FIFO_DEBUG", ",", "vmw_fifo_debug_ioctl", ",", "VMW_IOCTL_DEF", "(", "VMW_FENCE_WAIT", ",", "vmw_fence_wait_ioctl", ",", "VMW_IOCTL_DEF", "(", "VMW_UPDATE_LAYOUT", ",", "vmw_kms_update_layout_ioctl", ",", "unsigned", "int", "cmd_drv", ";", "#", "define", "DRM_IOCTL_DEF_DRV", "(", "ioctl", ",", "_func", ",", "_flags", ")", "\\", "[", "DRM_IOCTL_NR", "(", "DRM_", "#", "#", "ioctl", ")", "]", "=", "{", ".", "cmd", "=", "DRM_", "#", "#", "ioctl", ",", ".", "func", "=", "_func", ",", ".", "flags", "=", "_flags", ",", ".", "cmd_drv", "=", "DRM_IOCTL_", "#", "#", "ioctl", "}", "#", "define", "DRM_IOCTL_I830_INIT", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_I830_INIT", ",", "drm_i830_init_t", ")", "#", "define", "DRM_IOCTL_I830_VERTEX", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_I830_VERTEX", ",", "drm_i830_vertex_t", ")", "#", "define", "DRM_IOCTL_I830_CLEAR", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_I830_CLEAR", ",", "drm_i830_clear_t", ")", "#", "define", "DRM_IOCTL_I830_FLUSH", "DRM_IO", "(", "DRM_COMMAND_BASE", "+", "DRM_I830_FLUSH", ")", "#", "define", "DRM_IOCTL_I830_GETAGE", "DRM_IO", "(", "DRM_COMMAND_BASE", "+", "DRM_I830_GETAGE", ")", "#", "define", "DRM_IOCTL_I830_GETBUF", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_I830_GETBUF", ",", "drm_i830_dma_t", ")", "#", "define", "DRM_IOCTL_I830_SWAP", "DRM_IO", "(", "DRM_COMMAND_BASE", "+", "DRM_I830_SWAP", ")", "#", "define", "DRM_IOCTL_I830_COPY", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_I830_COPY", ",", "drm_i830_copy_t", ")", "#", "define", "DRM_IOCTL_I830_DOCOPY", "DRM_IO", "(", "DRM_COMMAND_BASE", "+", "DRM_I830_DOCOPY", ")", "#", "define", "DRM_IOCTL_I830_FLIP", "DRM_IO", "(", "DRM_COMMAND_BASE", "+", "DRM_I830_FLIP", ")", "#", "define", "DRM_IOCTL_I830_IRQ_EMIT", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_I830_IRQ_EMIT", ",", "drm_i830_irq_emit_t", ")", "#", "define", "DRM_IOCTL_I830_IRQ_WAIT", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_I830_IRQ_WAIT", ",", "drm_i830_irq_wait_t", ")", "#", "define", "DRM_IOCTL_I830_GETPARAM", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_I830_GETPARAM", ",", "drm_i830_getparam_t", ")", "#", "define", "DRM_IOCTL_I830_SETPARAM", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_I830_SETPARAM", ",", "drm_i830_setparam_t", ")", "#", "define", "DRM_IOCTL_I915_HWS_ADDR", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_I915_HWS_ADDR", ",", "struct", "drm_i915_gem_init", ")", "#", "define", "DRM_IOCTL_MGA_FLUSH", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_MGA_FLUSH", ",", "struct", "drm_lock", ")", "#", "define", "DRM_IOCTL_NOUVEAU_GETPARAM", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_NOUVEAU_GETPARAM", ",", "struct", "drm_nouveau_getparam", ")", "#", "define", "DRM_IOCTL_NOUVEAU_SETPARAM", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_NOUVEAU_SETPARAM", ",", "struct", "drm_nouveau_setparam", ")", "#", "define", "DRM_IOCTL_NOUVEAU_CHANNEL_ALLOC", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_NOUVEAU_CHANNEL_ALLOC", ",", "struct", "drm_nouveau_channel_alloc", ")", "#", "define", "DRM_IOCTL_NOUVEAU_CHANNEL_FREE", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_NOUVEAU_CHANNEL_FREE", ",", "struct", "drm_nouveau_channel_free", ")", "#", "define", "DRM_IOCTL_NOUVEAU_GROBJ_ALLOC", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_NOUVEAU_GROBJ_ALLOC", ",", "struct", "drm_nouveau_grobj_alloc", ")", "#", "define", "DRM_IOCTL_NOUVEAU_NOTIFIEROBJ_ALLOC", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_NOUVEAU_NOTIFIEROBJ_ALLOC", ",", "struct", "drm_nouveau_notifierobj_alloc", ")", "#", "define", "DRM_IOCTL_NOUVEAU_GPUOBJ_FREE", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_NOUVEAU_GPUOBJ_FREE", ",", "struct", "drm_nouveau_gpuobj_free", ")", "#", "define", "DRM_IOCTL_NOUVEAU_GEM_NEW", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_NOUVEAU_GEM_NEW", ",", "struct", "drm_nouveau_gem_new", ")", "#", "define", "DRM_IOCTL_NOUVEAU_GEM_PUSHBUF", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_NOUVEAU_GEM_PUSHBUF", ",", "struct", "drm_nouveau_gem_pushbuf", ")", "#", "define", "DRM_IOCTL_NOUVEAU_GEM_CPU_PREP", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_NOUVEAU_GEM_CPU_PREP", ",", "struct", "drm_nouveau_gem_cpu_prep", ")", "#", "define", "DRM_IOCTL_NOUVEAU_GEM_CPU_FINI", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_NOUVEAU_GEM_CPU_FINI", ",", "struct", "drm_nouveau_gem_cpu_fini", ")", "#", "define", "DRM_IOCTL_NOUVEAU_GEM_INFO", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_NOUVEAU_GEM_INFO", ",", "struct", "drm_nouveau_gem_info", ")", "#", "define", "DRM_IOCTL_RADEON_GEM_SET_TILING", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_RADEON_GEM_SET_TILING", ",", "struct", "drm_radeon_gem_set_tiling", ")", "#", "define", "DRM_IOCTL_RADEON_GEM_GET_TILING", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_RADEON_GEM_GET_TILING", ",", "struct", "drm_radeon_gem_get_tiling", ")", "#", "define", "DRM_IOCTL_SAVAGE_BCI_INIT", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_SAVAGE_BCI_INIT", ",", "drm_savage_init_t", ")", "#", "define", "DRM_IOCTL_SAVAGE_BCI_CMDBUF", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_SAVAGE_BCI_CMDBUF", ",", "drm_savage_cmdbuf_t", ")", "#", "define", "DRM_IOCTL_SAVAGE_BCI_EVENT_EMIT", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_SAVAGE_BCI_EVENT_EMIT", ",", "drm_savage_event_emit_t", ")", "#", "define", "DRM_IOCTL_SAVAGE_BCI_EVENT_WAIT", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_SAVAGE_BCI_EVENT_WAIT", ",", "drm_savage_event_wait_t", ")</s>(", "nr", "<", "DRM_COMMAND_BASE", "+", "dev", "-", ">", "driver", "-", ">", "num_ioctls", ")", ")", "if", "(", "_IOC_SIZE", "(", "cmd", ")", "<", "=", "sizeof", "(", "stack_kdata", ")", ")", "{", "kdata", "=", "kmalloc", "(", "_IOC_SIZE", "(", "cmd", ")", ",", "GFP_KERNEL", ")", ";", "_IOC_SIZE", "(", "cmd", ")", ")", "!", "=", "0", ")", "{", "memset", "(", "kdata", ",", "0", ",", "_IOC_SIZE", "(", "cmd", ")", ");", "_IOC_SIZE", "(", "cmd", ")", ")", "!", "=", "0", ")", "DRM_IOCTL_DEF", "(", "DRM_I810_INIT", ",", "i810_dma_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I810_VERTEX", ",", "i810_dma_vertex", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I810_CLEAR", ",", "i810_clear_bufs", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I810_FLUSH", ",", "i810_flush_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I810_GETAGE", ",", "i810_getage", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I810_GETBUF", ",", "i810_getbuf", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I810_SWAP", ",", "i810_swap_bufs", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I810_COPY", ",", "i810_copybuf", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I810_DOCOPY", ",", "i810_docopy", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I810_OV0INFO", ",", "i810_ov0_info", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I810_FSTATUS", ",", "i810_fstatus", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I810_OV0FLIP", ",", "i810_ov0_flip", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I810_MC", ",", "i810_dma_mc", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I810_RSTATUS", ",", "i810_rstatus", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I810_FLIP", ",", "i810_flip_bufs", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I830_INIT", ",", "i830_dma_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I830_VERTEX", ",", "i830_dma_vertex", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I830_CLEAR", ",", "i830_clear_bufs", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I830_FLUSH", ",", "i830_flush_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I830_GETAGE", ",", "i830_getage", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I830_GETBUF", ",", "i830_getbuf", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I830_SWAP", ",", "i830_swap_bufs", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I830_COPY", ",", "i830_copybuf", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I830_DOCOPY", ",", "i830_docopy", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I830_FLIP", ",", "i830_flip_bufs", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I830_IRQ_EMIT", ",", "i830_irq_emit", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I830_IRQ_WAIT", ",", "i830_irq_wait", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I830_GETPARAM", ",", "i830_getparam", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I830_SETPARAM", ",", "i830_setparam", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_INIT", ",", "i915_dma_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_FLUSH", ",", "i915_flush_ioctl", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_FLIP", ",", "i915_flip_bufs", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_BATCHBUFFER", ",", "i915_batchbuffer", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_IRQ_EMIT", ",", "i915_irq_emit", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_IRQ_WAIT", ",", "i915_irq_wait", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GETPARAM", ",", "i915_getparam", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_SETPARAM", ",", "i915_setparam", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_ALLOC", ",", "i915_mem_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_FREE", ",", "i915_mem_free", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_INIT_HEAP", ",", "i915_mem_init_heap", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_CMDBUFFER", ",", "i915_cmdbuffer", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_DESTROY_HEAP", ",", "i915_mem_destroy_heap", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_SET_VBLANK_PIPE", ",", "i915_vblank_pipe_set", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GET_VBLANK_PIPE", ",", "i915_vblank_pipe_get", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_VBLANK_SWAP", ",", "i915_vblank_swap", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_HWS_ADDR", ",", "i915_set_status_page", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_INIT", ",", "i915_gem_init_ioctl", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_EXECBUFFER", ",", "i915_gem_execbuffer", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_EXECBUFFER2", ",", "i915_gem_execbuffer2", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_PIN", ",", "i915_gem_pin_ioctl", ",", "DRM_AUTH", "|", "DRM_ROOT_ONLY", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_UNPIN", ",", "i915_gem_unpin_ioctl", ",", "DRM_AUTH", "|", "DRM_ROOT_ONLY", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_BUSY", ",", "i915_gem_busy_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_THROTTLE", ",", "i915_gem_throttle_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_ENTERVT", ",", "i915_gem_entervt_ioctl", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_LEAVEVT", ",", "i915_gem_leavevt_ioctl", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_CREATE", ",", "i915_gem_create_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_PREAD", ",", "i915_gem_pread_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_PWRITE", ",", "i915_gem_pwrite_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_MMAP", ",", "i915_gem_mmap_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_MMAP_GTT", ",", "i915_gem_mmap_gtt_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_SET_DOMAIN", ",", "i915_gem_set_domain_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_SW_FINISH", ",", "i915_gem_sw_finish_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_SET_TILING", ",", "i915_gem_set_tiling", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_GET_TILING", ",", "i915_gem_get_tiling", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_GET_APERTURE", ",", "i915_gem_get_aperture_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GET_PIPE_FROM_CRTC_ID", ",", "intel_get_pipe_from_crtc_id", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_GEM_MADVISE", ",", "i915_gem_madvise_ioctl", ",", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_OVERLAY_PUT_IMAGE", ",", "intel_overlay_put_image", ",", "DRM_MASTER", "|", "DRM_CONTROL_ALLOW", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_I915_OVERLAY_ATTRS", ",", "intel_overlay_attrs", ",", "DRM_MASTER", "|", "DRM_CONTROL_ALLOW", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_MGA_INIT", ",", "mga_dma_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_MGA_FLUSH", ",", "mga_dma_flush", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_MGA_RESET", ",", "mga_dma_reset", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_MGA_SWAP", ",", "mga_dma_swap", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_MGA_CLEAR", ",", "mga_dma_clear", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_MGA_VERTEX", ",", "mga_dma_vertex", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_MGA_INDICES", ",", "mga_dma_indices", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_MGA_ILOAD", ",", "mga_dma_iload", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_MGA_BLIT", ",", "mga_dma_blit", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_MGA_GETPARAM", ",", "mga_getparam", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_MGA_SET_FENCE", ",", "mga_set_fence", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_MGA_WAIT_FENCE", ",", "mga_wait_fence", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_MGA_DMA_BOOTSTRAP", ",", "mga_dma_bootstrap", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_NOUVEAU_GETPARAM", ",", "nouveau_ioctl_getparam", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_NOUVEAU_SETPARAM", ",", "nouveau_ioctl_setparam", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_NOUVEAU_CHANNEL_ALLOC", ",", "nouveau_ioctl_fifo_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_NOUVEAU_CHANNEL_FREE", ",", "nouveau_ioctl_fifo_free", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_NOUVEAU_GROBJ_ALLOC", ",", "nouveau_ioctl_grobj_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_NOUVEAU_NOTIFIEROBJ_ALLOC", ",", "nouveau_ioctl_notifier_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_NOUVEAU_GPUOBJ_FREE", ",", "nouveau_ioctl_gpuobj_free", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_NOUVEAU_GEM_NEW", ",", "nouveau_gem_ioctl_new", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_NOUVEAU_GEM_PUSHBUF", ",", "nouveau_gem_ioctl_pushbuf", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_NOUVEAU_GEM_CPU_PREP", ",", "nouveau_gem_ioctl_cpu_prep", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_NOUVEAU_GEM_CPU_FINI", ",", "nouveau_gem_ioctl_cpu_fini", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_NOUVEAU_GEM_INFO", ",", "nouveau_gem_ioctl_info", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_R128_INIT", ",", "r128_cce_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_R128_CCE_START", ",", "r128_cce_start", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_R128_CCE_STOP", ",", "r128_cce_stop", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_R128_CCE_RESET", ",", "r128_cce_reset", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_R128_CCE_IDLE", ",", "r128_cce_idle", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_R128_RESET", ",", "r128_engine_reset", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_R128_FULLSCREEN", ",", "r128_fullscreen", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_R128_SWAP", ",", "r128_cce_swap", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_R128_FLIP", ",", "r128_cce_flip", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_R128_CLEAR", ",", "r128_cce_clear", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_R128_VERTEX", ",", "r128_cce_vertex", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_R128_INDICES", ",", "r128_cce_indices", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_R128_BLIT", ",", "r128_cce_blit", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_R128_DEPTH", ",", "r128_cce_depth", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_R128_STIPPLE", ",", "r128_cce_stipple", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_R128_INDIRECT", ",", "r128_cce_indirect", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_R128_GETPARAM", ",", "r128_getparam", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CP_INIT", ",", "radeon_cp_init_kms", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CP_START", ",", "radeon_cp_start_kms", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CP_STOP", ",", "radeon_cp_stop_kms", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CP_RESET", ",", "radeon_cp_reset_kms", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CP_IDLE", ",", "radeon_cp_idle_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CP_RESUME", ",", "radeon_cp_resume_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_RESET", ",", "radeon_engine_reset_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_FULLSCREEN", ",", "radeon_fullscreen_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_SWAP", ",", "radeon_cp_swap_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CLEAR", ",", "radeon_cp_clear_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_VERTEX", ",", "radeon_cp_vertex_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_INDICES", ",", "radeon_cp_indices_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_TEXTURE", ",", "radeon_cp_texture_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_STIPPLE", ",", "radeon_cp_stipple_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_INDIRECT", ",", "radeon_cp_indirect_kms", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_VERTEX2", ",", "radeon_cp_vertex2_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CMDBUF", ",", "radeon_cp_cmdbuf_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_GETPARAM", ",", "radeon_cp_getparam_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_FLIP", ",", "radeon_cp_flip_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_ALLOC", ",", "radeon_mem_alloc_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_FREE", ",", "radeon_mem_free_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_INIT_HEAP", ",", "radeon_mem_init_heap_kms", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_IRQ_EMIT", ",", "radeon_irq_emit_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_IRQ_WAIT", ",", "radeon_irq_wait_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_SETPARAM", ",", "radeon_cp_setparam_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_SURF_ALLOC", ",", "radeon_surface_alloc_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_SURF_FREE", ",", "radeon_surface_free_kms", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_GEM_INFO", ",", "radeon_gem_info_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_GEM_CREATE", ",", "radeon_gem_create_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_GEM_MMAP", ",", "radeon_gem_mmap_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_GEM_SET_DOMAIN", ",", "radeon_gem_set_domain_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_GEM_PREAD", ",", "radeon_gem_pread_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_GEM_PWRITE", ",", "radeon_gem_pwrite_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_GEM_WAIT_IDLE", ",", "radeon_gem_wait_idle_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CS", ",", "radeon_cs_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_INFO", ",", "radeon_info_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_GEM_SET_TILING", ",", "radeon_gem_set_tiling_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_GEM_GET_TILING", ",", "radeon_gem_get_tiling_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_GEM_BUSY", ",", "radeon_gem_busy_ioctl", ",", "DRM_AUTH", "|", "DRM_UNLOCKED", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CP_INIT", ",", "radeon_cp_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CP_START", ",", "radeon_cp_start", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CP_STOP", ",", "radeon_cp_stop", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CP_RESET", ",", "radeon_cp_reset", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CP_IDLE", ",", "radeon_cp_idle", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CP_RESUME", ",", "radeon_cp_resume", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_RESET", ",", "radeon_engine_reset", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_FULLSCREEN", ",", "radeon_fullscreen", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_SWAP", ",", "radeon_cp_swap", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CLEAR", ",", "radeon_cp_clear", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_VERTEX", ",", "radeon_cp_vertex", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_INDICES", ",", "radeon_cp_indices", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_TEXTURE", ",", "radeon_cp_texture", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_STIPPLE", ",", "radeon_cp_stipple", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_INDIRECT", ",", "radeon_cp_indirect", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_VERTEX2", ",", "radeon_cp_vertex2", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CMDBUF", ",", "radeon_cp_cmdbuf", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_GETPARAM", ",", "radeon_cp_getparam", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_FLIP", ",", "radeon_cp_flip", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_ALLOC", ",", "radeon_mem_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_FREE", ",", "radeon_mem_free", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_INIT_HEAP", ",", "radeon_mem_init_heap", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_IRQ_EMIT", ",", "radeon_irq_emit", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_IRQ_WAIT", ",", "radeon_irq_wait", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_SETPARAM", ",", "radeon_cp_setparam", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_SURF_ALLOC", ",", "radeon_surface_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_SURF_FREE", ",", "radeon_surface_free", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_RADEON_CS", ",", "r600_cs_legacy_ioctl", ",", "DRM_AUTH", ")", "DRM_IOCTL_DEF", "(", "DRM_SAVAGE_BCI_INIT", ",", "savage_bci_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_SAVAGE_BCI_CMDBUF", ",", "savage_bci_cmdbuf", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_SAVAGE_BCI_EVENT_EMIT", ",", "savage_bci_event_emit", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_SAVAGE_BCI_EVENT_WAIT", ",", "savage_bci_event_wait", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_SIS_FB_ALLOC", ",", "sis_fb_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_SIS_FB_FREE", ",", "sis_drm_free", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_SIS_AGP_INIT", ",", "sis_ioctl_agp_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_SIS_AGP_ALLOC", ",", "sis_ioctl_agp_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_SIS_AGP_FREE", ",", "sis_drm_free", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_SIS_FB_INIT", ",", "sis_fb_init", ",", "DRM_AUTH", "|", "DRM_MASTER", "|", "DRM_ROOT_ONLY", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_VIA_ALLOCMEM", ",", "via_mem_alloc", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_VIA_FREEMEM", ",", "via_mem_free", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_VIA_AGP_INIT", ",", "via_agp_init", ",", "DRM_AUTH", "|", "DRM_MASTER", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_VIA_FB_INIT", ",", "via_fb_init", ",", "DRM_AUTH", "|", "DRM_MASTER", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_VIA_MAP_INIT", ",", "via_map_init", ",", "DRM_AUTH", "|", "DRM_MASTER", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_VIA_DEC_FUTEX", ",", "via_decoder_futex", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_VIA_DMA_INIT", ",", "via_dma_init", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_VIA_CMDBUFFER", ",", "via_cmdbuffer", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_VIA_FLUSH", ",", "via_flush_ioctl", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_VIA_PCICMD", ",", "via_pci_cmdbuffer", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_VIA_CMDBUF_SIZE", ",", "via_cmdbuf_size", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_VIA_WAIT_IRQ", ",", "via_wait_irq", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_VIA_DMA_BLIT", ",", "via_dma_blit", ",", "DRM_AUTH", ")", ",", "DRM_IOCTL_DEF", "(", "DRM_VIA_BLIT_SYNC", ",", "via_dma_blit_sync", ",", "DRM_AUTH", ")", "[", "DRM_IOCTL_NR", "(", "ioctl", ")", "-", "DRM_COMMAND_BASE", "]", "=", "{", "ioctl", ",", "flags", ",", "func", "}", "VMW_IOCTL_DEF", "(", "DRM_IOCTL_VMW_GET_PARAM", ",", "vmw_getparam_ioctl", ",", "VMW_IOCTL_DEF", "(", "DRM_IOCTL_VMW_ALLOC_DMABUF", ",", "vmw_dmabuf_alloc_ioctl", ",", "VMW_IOCTL_DEF", "(", "DRM_IOCTL_VMW_UNREF_DMABUF", ",", "vmw_dmabuf_unref_ioctl", ",", "VMW_IOCTL_DEF", "(", "DRM_IOCTL_VMW_CURSOR_BYPASS", ",", "VMW_IOCTL_DEF", "(", "DRM_IOCTL_VMW_CONTROL_STREAM", ",", "vmw_overlay_ioctl", ",", "VMW_IOCTL_DEF", "(", "DRM_IOCTL_VMW_CLAIM_STREAM", ",", "vmw_stream_claim_ioctl", ",", "VMW_IOCTL_DEF", "(", "DRM_IOCTL_VMW_UNREF_STREAM", ",", "vmw_stream_unref_ioctl", ",", "VMW_IOCTL_DEF", "(", "DRM_IOCTL_VMW_CREATE_CONTEXT", ",", "vmw_context_define_ioctl", ",", "VMW_IOCTL_DEF", "(", "DRM_IOCTL_VMW_UNREF_CONTEXT", ",", "vmw_context_destroy_ioctl", ",", "VMW_IOCTL_DEF", "(", "DRM_IOCTL_VMW_CREATE_SURFACE", ",", "vmw_surface_define_ioctl", ",", "VMW_IOCTL_DEF", "(", "DRM_IOCTL_VMW_UNREF_SURFACE", ",", "vmw_surface_destroy_ioctl", ",", "VMW_IOCTL_DEF", "(", "DRM_IOCTL_VMW_REF_SURFACE", ",", "vmw_surface_reference_ioctl", ",", "VMW_IOCTL_DEF", "(", "DRM_IOCTL_VMW_EXECBUF", ",", "vmw_execbuf_ioctl", ",", "VMW_IOCTL_DEF", "(", "DRM_IOCTL_VMW_FIFO_DEBUG", ",", "vmw_fifo_debug_ioctl", ",", "VMW_IOCTL_DEF", "(", "DRM_IOCTL_VMW_FENCE_WAIT", ",", "vmw_fence_wait_ioctl", ",", "VMW_IOCTL_DEF", "(", "DRM_IOCTL_VMW_UPDATE_LAYOUT", ",", "vmw_kms_update_layout_ioctl", ",", "#", "define", "DRM_IOCTL_DEF", "(", "ioctl", ",", "_func", ",", "_flags", ")", "\\", "[", "DRM_IOCTL_NR", "(", "ioctl", ")", "]", "=", "{", ".", "cmd", "=", "ioctl", ",", ".", "func", "=", "_func", ",", ".", "flags", "=", "_flags", "}", "#", "define", "DRM_IOCTL_I830_INIT", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_IOCTL_I830_INIT", ",", "drm_i830_init_t", ")", "#", "define", "DRM_IOCTL_I830_VERTEX", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_IOCTL_I830_VERTEX", ",", "drm_i830_vertex_t", ")", "#", "define", "DRM_IOCTL_I830_CLEAR", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_IOCTL_I830_CLEAR", ",", "drm_i830_clear_t", ")", "#", "define", "DRM_IOCTL_I830_FLUSH", "DRM_IO", "(", "DRM_COMMAND_BASE", "+", "DRM_IOCTL_I830_FLUSH", ")", "#", "define", "DRM_IOCTL_I830_GETAGE", "DRM_IO", "(", "DRM_COMMAND_BASE", "+", "DRM_IOCTL_I830_GETAGE", ")", "#", "define", "DRM_IOCTL_I830_GETBUF", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_IOCTL_I830_GETBUF", ",", "drm_i830_dma_t", ")", "#", "define", "DRM_IOCTL_I830_SWAP", "DRM_IO", "(", "DRM_COMMAND_BASE", "+", "DRM_IOCTL_I830_SWAP", ")", "#", "define", "DRM_IOCTL_I830_COPY", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_IOCTL_I830_COPY", ",", "drm_i830_copy_t", ")", "#", "define", "DRM_IOCTL_I830_DOCOPY", "DRM_IO", "(", "DRM_COMMAND_BASE", "+", "DRM_IOCTL_I830_DOCOPY", ")", "#", "define", "DRM_IOCTL_I830_FLIP", "DRM_IO", "(", "DRM_COMMAND_BASE", "+", "DRM_IOCTL_I830_FLIP", ")", "#", "define", "DRM_IOCTL_I830_IRQ_EMIT", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_IOCTL_I830_IRQ_EMIT", ",", "drm_i830_irq_emit_t", ")", "#", "define", "DRM_IOCTL_I830_IRQ_WAIT", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_IOCTL_I830_IRQ_WAIT", ",", "drm_i830_irq_wait_t", ")", "#", "define", "DRM_IOCTL_I830_GETPARAM", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_IOCTL_I830_GETPARAM", ",", "drm_i830_getparam_t", ")", "#", "define", "DRM_IOCTL_I830_SETPARAM", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_IOCTL_I830_SETPARAM", ",", "drm_i830_setparam_t", ")", "#", "define", "DRM_IOCTL_MGA_FLUSH", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_MGA_FLUSH", ",", "drm_lock_t", ")", "#", "define", "DRM_IOCTL_RADEON_SET_TILING", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_RADEON_GEM_SET_TILING", ",", "struct", "drm_radeon_gem_set_tiling", ")", "#", "define", "DRM_IOCTL_RADEON_GET_TILING", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_RADEON_GEM_GET_TILING", ",", "struct", "drm_radeon_gem_get_tiling", ")", "#", "define", "DRM_IOCTL_SAVAGE_INIT", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_SAVAGE_BCI_INIT", ",", "drm_savage_init_t", ")", "#", "define", "DRM_IOCTL_SAVAGE_CMDBUF", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_SAVAGE_BCI_CMDBUF", ",", "drm_savage_cmdbuf_t", ")", "#", "define", "DRM_IOCTL_SAVAGE_EVENT_EMIT", "DRM_IOWR", "(", "DRM_COMMAND_BASE", "+", "DRM_SAVAGE_BCI_EVENT_EMIT", ",", "drm_savage_event_emit_t", ")", "#", "define", "DRM_IOCTL_SAVAGE_EVENT_WAIT", "DRM_IOW", "(", "DRM_COMMAND_BASE", "+", "DRM_SAVAGE_BCI_EVENT_WAIT", ",", "drm_savage_event_wait_t", ")"], "docstring_tokens": ["obtain", "potentially", "sensitive", "information", "from", "kernel", "memory"]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "apache", ".", "kylin", ".", "metrics", ".", "MetricsManager", ";", "import", "org", ".", "apache", ".", "kylin", ".", "rest", ".", "request", ".", "PrepareSqlRequest", ";", "toDelHDFSPaths", ".", "add", "(", "JobBuilderSupport", ".", "getJobWorkingDir", "(", "seg", ".", "getConfig", "(", ").", "getHdfsWorkingDirectory", "(", "),", "seg", ".", "getLastBuildJobID", "(", "))", ");", "long", "rowCount", "=", "(", "rowCountMap", "=", "=", "null", "|", "|", "rowCountMap", ".", "size", "(", ")", "=", "=", "0", ")", "?", "0L", ":", "rowCountMap", ".", "get", "(", "cuboidId", ")", ";", "+", "\"", "from", "\"", "+", "table", "/", "/", "+", "\"", "where", "\"", "+", "QueryCubePropertyEnum", ".", "CUBE", ".", "toString", "(", ")", "+", "\"", "=", "?", "\"", "/", "/", "+", "\"", "group", "by", "\"", "+", "cuboidColumn", ";", "List", "<", "List", "<", "String", ">", ">", "orgHitFrequency", "=", "getPrepareQueryResult", "(", "cubeName", ",", "sql", ")", ";", "+", "\"", "from", "\"", "+", "table", "/", "/", "+", "\"", "where", "\"", "+", "QueryCubePropertyEnum", ".", "CUBE", ".", "toString", "(", ")", "+", "\"", "=", "?", "\"", "/", "/", "+", "\"", "group", "by", "\"", "+", "cuboidSource", "+", "\"", ",", "\"", "+", "cuboidTgt", ";", "List", "<", "List", "<", "String", ">", ">", "orgRollingUpCount", "=", "getPrepareQueryResult", "(", "cubeName", ",", "sql", ")", ";", "+", "\"", "from", "\"", "+", "table", "/", "/", "+", "\"", "where", "\"", "+", "QueryCubePropertyEnum", ".", "CUBE", ".", "toString", "(", ")", "+", "\"", "=", "?", "\"", "/", "/", "+", "\"", "and", "\"", "+", "QueryCubePropertyEnum", ".", "IF_MATCH", ".", "toString", "(", ")", "+", "\"", "=", "true", "\"", "/", "/", "+", "\"", "group", "by", "\"", "+", "cuboidSource", ";", "List", "<", "List", "<", "String", ">", ">", "orgMatchHitFrequency", "=", "getPrepareQueryResult", "(", "cubeName", ",", "sql", ")", ";", "private", "List", "<", "List", "<", "String", ">", ">", "getPrepareQueryResult", "(", "String", "cubeName", ",", "String", "sql", ")", "{", "PrepareSqlRequest", "sqlRequest", "=", "new", "PrepareSqlRequest", "(", ");", "sqlRequest", ".", "setProject", "(", "MetricsManager", ".", "SYSTEM_PROJECT", ")", ";", "PrepareSqlRequest", ".", "StateParam", "[", "]", "params", "=", "new", "PrepareSqlRequest", ".", "StateParam", "[", "1", "]", ";", "params", "[", "0", "]", "=", "new", "PrepareSqlRequest", ".", "StateParam", "(", ");", "params", "[", "0", "]", ".", "setClassName", "(", "\"", "java", ".", "lang", ".", "String", "\"", ");", "params", "[", "0", "]", ".", "setValue", "(", "cubeName", ")", ";", "sqlRequest", ".", "setParams", "(", "params", ")", ";", "sqlRequest", ".", "setSql", "(", "sql", ")", ";", "return", "queryService", ".", "doQueryWithCache", "(", "sqlRequest", ",", "false", ")", ".", "getResults", "(", ");", "}", "+", "\"", "or", "hasPermission", "(", "#", "cube", ",", "'", "ADMINISTRATION", "'", ")", "or", "hasPermission", "(", "#", "cube", ",", "'", "MANAGEMENT", "'", ")\"", ")</s>toDelHDFSPaths", ".", "add", "(", "JobBuilderSupport", ".", "getJobWorkingDir", "(", "seg", ".", "getConfig", "(", ").", "getHdfsWorkingDirectory", "(", "),", "seg", ".", "getLastBuildJobID", "(", "))", ");", "long", "rowCount", "=", "rowCountMap", "=", "=", "null", "?", "0L", ":", "rowCountMap", ".", "get", "(", "cuboidId", ")", ";", "+", "\"", "where", "\"", "+", "QueryCubePropertyEnum", ".", "CUBE", ".", "toString", "(", ")", "+", "\"", "=", "'", "\"", "+", "cubeName", "+", "\"", "'\"", "/", "/", "List", "<", "List", "<", "String", ">", ">", "orgHitFrequency", "=", "queryService", ".", "querySystemCube", "(", "sql", ")", ".", "getResults", "(", ");", "+", "\"", "where", "\"", "+", "QueryCubePropertyEnum", ".", "CUBE", ".", "toString", "(", ")", "+", "\"", "=", "'", "\"", "+", "cubeName", "+", "\"", "'", "\"", "/", "/", "List", "<", "List", "<", "String", ">", ">", "orgRollingUpCount", "=", "queryService", ".", "querySystemCube", "(", "sql", ")", ".", "getResults", "(", ");", "+", "\"", "where", "\"", "+", "QueryCubePropertyEnum", ".", "CUBE", ".", "toString", "(", ")", "+", "\"", "=", "'", "\"", "+", "cubeName", "+", "\"", "'\"", "/", "/", "List", "<", "List", "<", "String", ">", ">", "orgMatchHitFrequency", "=", "queryService", ".", "querySystemCube", "(", "sql", ")", ".", "getResults", "(", ");"], "docstring_tokens": ["modify", "or", "delete", "information", "in", "the", "back-end", "database"]}
{"contents": ["empty"], "code_tokens": ["while", "(", "leftover", "&", "&", "mc_saved_count", "<", "ARRAY_SIZE", "(", "mc_saved_tmp", ")", ")", "{</s>while", "(", "leftover", ")", "{"], "docstring_tokens": ["overflow", "a", "buffer", "and", "execute", "arbitrary", "code", "on", "the", "system", "with", "kernel-level", "privileges"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "!", "capable", "(", "CAP_SYS_RAWIO", ")", ")", "return", "-", "EPERM", ";</s>"], "docstring_tokens": ["bypass", "intended", "access", "restrictions"]}
{"contents": ["empty"], "code_tokens": ["merge_m86_ensure_that_buffers_used_by_imagedecoder_haven_t_been", ".", "patch", "@", "@", "-", "0", ",", "0", "+", "1", ",", "179", "@", "@", "From", "0000000000000000000000000000000000000000", "Mon", "Sep", "17", "00", ":", "00", ":", "00", "2001", "From", ":", "Dale", "Curtis", "<", "dalecurtis", "@", "chromium", ".", "org", ">", "Date", ":", "Fri", ",", "13", "Nov", "2020", "21", ":", "06", ":", "58", "+", "0000", "Subject", ":", "Merge", "M86", ":", "\"", "Ensure", "that", "buffers", "used", "by", "ImageDecoder", "haven", "'", "t", "been", "neutered", ".", "\"", "Since", "JavaScript", "may", "detach", "the", "underlying", "buffers", ",", "we", "need", "to", "check", "to", "ensure", "they", "'", "re", "still", "valid", "before", "using", "them", "for", "decoding", ".", "TBR", "=", "sandersd", "(", "cherry", "picked", "from", "commit", "fa93fba6a28d384b0a0cddd63e85eb10cb97bb53", ")", "Test", ":", "Updated", "unittests", ".", "Manual", "test", "case", "breaks", ".", "Change", "-", "Id", ":", "Iefe5f8adf619cd6afdfedcb08a13c2996bfe0d32", "Fixed", ":", "1146761", "Reviewed", "-", "on", ":", "https", ":", "//", "chromium", "-", "review", ".", "googlesource", ".", "com", "/", "c", "/", "chromium", "/", "src", "/", "+/", "2527542", "Commit", "-", "Queue", ":", "Dale", "Curtis", "<", "dalecurtis", "@", "chromium", ".", "org", ">", "Auto", "-", "Submit", ":", "Dale", "Curtis", "<", "dalecurtis", "@", "chromium", ".", "org", ">", "Reviewed", "-", "by", ":", "Dan", "Sanders", "<", "sandersd", "@", "chromium", ".", "org", ">", "Cr", "-", "Original", "-", "Commit", "-", "Position", ":", "refs", "/", "heads", "/", "master", "@", "{#", "825615", "}", "Reviewed", "-", "on", ":", "https", ":", "//", "chromium", "-", "review", ".", "googlesource", ".", "com", "/", "c", "/", "chromium", "/", "src", "/", "+/", "2537781", "Reviewed", "-", "by", ":", "Dale", "Curtis", "<", "dalecurtis", "@", "chromium", ".", "org", ">", "Cr", "-", "Commit", "-", "Position", ":", "refs", "/", "branch", "-", "heads", "/", "4240", "@", "{#", "1453", "}", "Cr", "-", "Branched", "-", "From", ":", "f297677702651916bbf65e59c0d4bbd4ce57d1ee", "-", "refs", "/", "heads", "/", "master", "@", "{#", "800218", "}", "diff", "-", "-", "git", "a", "/", "third_party", "/", "blink", "/", "renderer", "/", "modules", "/", "webcodecs", "/", "image_decoder_external", ".", "cc", "b", "/", "third_party", "/", "blink", "/", "renderer", "/", "modules", "/", "webcodecs", "/", "image_decoder_external", ".", "cc", "index", "e42ceaf37038b58e53d11bfb63b7a27aa414a87b", ".", ".", "780fdbef3afb9cca322002f736fc3d9b87f834b3", "100644", "-", "--", "a", "/", "third_party", "/", "blink", "/", "renderer", "/", "modules", "/", "webcodecs", "/", "image_decoder_external", ".", "cc", "b", "/", "third_party", "/", "blink", "/", "renderer", "/", "modules", "/", "webcodecs", "/", "image_decoder_external", ".", "cc", "@", "@", "-", "99", ",", "9", "+", "99", ",", "8", "@", "@", "ImageDecoderExternal", ":", ":", "ImageDecoderExternal", "(", "ScriptState", "*", "script_state", ",", "return", ";", "}", "-", "/", "/", "TODO", ":", "Data", "is", "owned", "by", "the", "caller", "who", "may", "be", "free", "to", "manipulate", "it", ".", "We", "will", "-", "/", "/", "probably", "need", "to", "make", "a", "copy", "to", "our", "own", "internal", "data", "or", "neuter", "the", "buffers", "-", "/", "/", "as", "seen", "by", "JS", ".", "/", "/", "Since", "data", "is", "owned", "by", "the", "caller", "who", "may", "be", "free", "to", "manipulate", "it", ",", "we", "must", "/", "/", "check", "HasValidEncodedData", "(", ")", "before", "attempting", "to", "access", "|", "decoder_", "|", ".", "segment_reader_", "=", "SegmentReader", ":", ":", "CreateFromSkData", "(", "SkData", ":", ":", "MakeWithoutCopy", "(", "buffer", ".", "Data", "(", "),", "buffer", ".", "ByteLengthAsSizeT", "(", "))", ");", "if", "(", "!", "segment_reader_", ")", "{", "@", "@", "-", "206", ",", "6", "+", "205", ",", "7", "@", "@", "void", "ImageDecoderExternal", ":", ":", "Trace", "(", "Visitor", "*", "visitor", ")", "const", "{", "void", "ImageDecoderExternal", ":", ":", "CreateImageDecoder", "(", ")", "{", "DCHECK", "(", "!", "decoder_", ")", ";", "DCHECK", "(", "HasValidEncodedData", "(", "))", ";", "/", "/", "TODO", ":", "We", "should", "probably", "call", "ImageDecoder", ":", ":", "SetMemoryAllocator", "(", ")", "so", "that", "/", "/", "we", "can", "recycle", "frame", "buffers", "for", "decoded", "images", ".", "@", "@", "-", "260", ",", "6", "+", "260", ",", "13", "@", "@", "void", "ImageDecoderExternal", ":", ":", "MaybeSatisfyPendingDecodes", "(", ")", "{", "continue", ";", "}", "if", "(", "!", "HasValidEncodedData", "(", "))", "{", "request", "-", ">", "resolver", "-", ">", "Reject", "(", "MakeGarbageCollected", "<", "DOMException", ">", "(", "DOMExceptionCode", ":", ":", "kInvalidStateError", ",", "\"", "Source", "data", "has", "been", "neutered", "\"", "))", ";", "continue", ";", "}", "auto", "*", "image", "=", "decoder_", "-", ">", "DecodeFrameBufferAtIndex", "(", "request", "-", ">", "frame_index", ")", ";", "if", "(", "decoder_", "-", ">", "Failed", "(", ")", "|", "|", "!", "image", ")", "{", "request", "-", ">", "complete", "=", "true", ";", "@", "@", "-", "326", ",", "6", "+", "333", ",", "7", "@", "@", "void", "ImageDecoderExternal", ":", ":", "MaybeSatisfyPendingDecodes", "(", ")", "{", "}", "void", "ImageDecoderExternal", ":", ":", "MaybeSatisfyPendingMetadataDecodes", "(", ")", "{", "DCHECK", "(", "HasValidEncodedData", "(", "))", ";", "DCHECK", "(", "decoder_", ")", ";", "DCHECK", "(", "decoder_", "-", ">", "Failed", "(", ")", "|", "|", "decoder_", "-", ">", "IsDecodedSizeAvailable", "(", "))", ";", "for", "(", "auto", "&", "resolver", ":", "pending_metadata_decodes_", ")", "@", "@", "-", "334", ",", "6", "+", "342", ",", "9", "@", "@", "void", "ImageDecoderExternal", ":", ":", "MaybeSatisfyPendingMetadataDecodes", "(", ")", "{", "}", "void", "ImageDecoderExternal", ":", ":", "MaybeUpdateMetadata", "(", ")", "{", "if", "(", "!", "HasValidEncodedData", "(", "))", "return", ";", "const", "size_t", "decoded_frame_count", "=", "decoder_", "-", ">", "FrameCount", "(", ");", "if", "(", "decoder_", "-", ">", "Failed", "(", "))", "{", "MaybeSatisfyPendingMetadataDecodes", "(", ");", "@", "@", "-", "358", ",", "4", "+", "369", ",", "22", "@", "@", "void", "ImageDecoderExternal", ":", ":", "MaybeUpdateMetadata", "(", ")", "{", "MaybeSatisfyPendingMetadataDecodes", "(", ");", "}", "bool", "ImageDecoderExternal", ":", ":", "HasValidEncodedData", "(", ")", "const", "{", "/", "/", "If", "we", "keep", "an", "internal", "copy", "of", "the", "data", ",", "it", "'", "s", "always", "valid", ".", "if", "(", "stream_buffer_", ")", "return", "true", ";", "if", "(", "init_data_", "-", ">", "data", "(", ").", "IsArrayBuffer", "(", ")", "&", "&", "init_data_", "-", ">", "data", "(", ").", "GetAsArrayBuffer", "(", ")-", ">", "IsDetached", "(", "))", "{", "return", "false", ";", "}", "if", "(", "init_data_", "-", ">", "data", "(", ").", "IsArrayBufferView", "(", ")", "&", "&", "!", "init_data_", "-", ">", "data", "(", ").", "GetAsArrayBufferView", "(", ")-", ">", "BaseAddress", "(", "))", "{", "return", "false", ";", "}", "return", "true", ";", "}", "}", "/", "/", "namespace", "blink", "diff", "-", "-", "git", "a", "/", "third_party", "/", "blink", "/", "renderer", "/", "modules", "/", "webcodecs", "/", "image_decoder_external", ".", "cc", ".", "rej", "b", "/", "third_party", "/", "blink", "/", "renderer", "/", "modules", "/", "webcodecs", "/", "image_decoder_external", ".", "cc", ".", "rej", "new", "file", "mode", "100644", "index", "0000000000000000000000000000000000000000", ".", ".", "68d0eae0c7cd414f8cbe90aee79417d2a4ffe98b", "-", "--", "/", "dev", "/", "null", "b", "/", "third_party", "/", "blink", "/", "renderer", "/", "modules", "/", "webcodecs", "/", "image_decoder_external", ".", "cc", ".", "rej", "@", "@", "-", "0", ",", "0", "+", "1", ",", "53", "@", "@", "diff", "a", "/", "third_party", "/", "blink", "/", "renderer", "/", "modules", "/", "webcodecs", "/", "image_decoder_external", ".", "cc", "b", "/", "third_party", "/", "blink", "/", "renderer", "/", "modules", "/", "webcodecs", "/", "image_decoder_external", ".", "cc", "(", "rejected", "hunks", ")", "@", "@", "-", "120", ",", "9", "+", "120", ",", "8", "@", "@", "return", ";", "}", "-", "/", "/", "TODO", "(", "crbug", ".", "com", "/", "1073995", ")", ":", "Data", "is", "owned", "by", "the", "caller", "who", "may", "be", "free", "to", "-", "/", "/", "manipulate", "it", ".", "We", "will", "probably", "need", "to", "make", "a", "copy", "to", "our", "own", "internal", "-", "/", "/", "data", "or", "neuter", "the", "buffers", "as", "seen", "by", "JS", ".", "/", "/", "Since", "data", "is", "owned", "by", "the", "caller", "who", "may", "be", "free", "to", "manipulate", "it", ",", "we", "must", "/", "/", "check", "HasValidEncodedData", "(", ")", "before", "attempting", "to", "access", "|", "decoder_", "|", ".", "segment_reader_", "=", "SegmentReader", ":", ":", "CreateFromSkData", "(", "SkData", ":", ":", "MakeWithoutCopy", "(", "buffer", ".", "Data", "(", "),", "buffer", ".", "ByteLengthAsSizeT", "(", "))", ");", "if", "(", "!", "segment_reader_", ")", "{", "@", "@", "-", "266", ",", "6", "+", "265", ",", "7", "@", "@", "void", "ImageDecoderExternal", ":", ":", "CreateImageDecoder", "(", ")", "{", "DCHECK", "(", "!", "decoder_", ")", ";", "DCHECK", "(", "HasValidEncodedData", "(", "))", ";", "/", "/", "TODO", "(", "crbug", ".", "com", "/", "1073995", ")", ":", "We", "should", "probably", "call", "/", "/", "ImageDecoder", ":", ":", "SetMemoryAllocator", "(", ")", "so", "that", "we", "can", "recycle", "frame", "buffers", "for", "@", "@", "-", "320", ",", "6", "+", "320", ",", "13", "@", "@", "continue", ";", "}", "if", "(", "!", "HasValidEncodedData", "(", "))", "{", "request", "-", ">", "exception", "=", "MakeGarbageCollected", "<", "DOMException", ">", "(", "DOMExceptionCode", ":", ":", "kInvalidStateError", ",", "\"", "Source", "data", "has", "been", "neutered", "\"", ");", "continue", ";", "}", "auto", "*", "image", "=", "decoder_", "-", ">", "DecodeFrameBufferAtIndex", "(", "request", "-", ">", "frame_index", ")", ";", "if", "(", "decoder_", "-", ">", "Failed", "(", ")", "|", "|", "!", "image", ")", "{", "/", "/", "TODO", "(", "crbug", ".", "com", "/", "1073995", ")", ":", "Include", "frameIndex", "in", "rejection", "?", "@", "@", "-", "398", ",", "6", "+", "405", ",", "7", "@", "@", "}", "void", "ImageDecoderExternal", ":", ":", "MaybeSatisfyPendingMetadataDecodes", "(", ")", "{", "DCHECK", "(", "HasValidEncodedData", "(", "))", ";", "DCHECK", "(", "decoder_", ")", ";", "if", "(", "!", "decoder_", "-", ">", "IsSizeAvailable", "(", ")", "&", "&", "!", "decoder_", "-", ">", "Failed", "(", "))", "return", ";", "@", "@", "-", "409", ",", "6", "+", "417", ",", "9", "@", "@", "}", "void", "ImageDecoderExternal", ":", ":", "MaybeUpdateMetadata", "(", ")", "{", "if", "(", "!", "HasValidEncodedData", "(", "))", "return", ";", "/", "/", "Since", "we", "always", "create", "the", "decoder", "at", "construction", ",", "we", "need", "to", "wait", "until", "/", "/", "at", "least", "the", "size", "is", "available", "before", "signaling", "that", "metadata", "has", "been", "/", "/", "retrieved", ".", "diff", "-", "-", "git", "a", "/", "third_party", "/", "blink", "/", "renderer", "/", "modules", "/", "webcodecs", "/", "image_decoder_external", ".", "h", "b", "/", "third_party", "/", "blink", "/", "renderer", "/", "modules", "/", "webcodecs", "/", "image_decoder_external", ".", "h", "index", "1b4ac0ce7eade63c06c1030c29fc90a8551aa7c2", ".", ".", "7d9d534ce14d07e49fca99f11297e74b1311363e", "100644", "-", "--", "a", "/", "third_party", "/", "blink", "/", "renderer", "/", "modules", "/", "webcodecs", "/", "image_decoder_external", ".", "h", "b", "/", "third_party", "/", "blink", "/", "renderer", "/", "modules", "/", "webcodecs", "/", "image_decoder_external", ".", "h", "@", "@", "-", "61", ",", "6", "+", "61", ",", "10", "@", "@", "class", "MODULES_EXPORT", "ImageDecoderExternal", "final", ":", "public", "ScriptWrappable", ",", "void", "MaybeSatisfyPendingMetadataDecodes", "(", ");", "void", "MaybeUpdateMetadata", "(", ");", "/", "/", "Returns", "false", "if", "the", "decoder", "was", "constructed", "with", "an", "ArrayBuffer", "or", "/", "/", "ArrayBufferView", "that", "has", "since", "been", "neutered", ".", "bool", "HasValidEncodedData", "(", ")", "const", ";", "Member", "<", "ScriptState", ">", "script_state_", ";", "/", "/", "Used", "when", "a", "ReadableStream", "is", "provided", ".</s>"], "docstring_tokens": ["execute", "arbitrary", "code", "or", "cause", "the", "application", "to", "crash", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["cors", "{", "#", "change", "for", "production", "allowOrigin", "=", "\"", "*\"", "}", "import", "com", ".", "walmartlabs", ".", "concord", ".", "server", ".", "cfg", ".", "ServerConfiguration", ";", "import", "javax", ".", "inject", ".", "Inject", ";", "private", "final", "ServerConfiguration", "cfg", ";", "@", "Inject", "public", "CORSFilter", "(", "ServerConfiguration", "cfg", ")", "{", "this", ".", "cfg", "=", "cfg", ";", "}", "httpResp", ".", "setHeader", "(", "\"", "Access", "-", "Control", "-", "Allow", "-", "Origin", "\"", ",", "cfg", ".", "getCORSConfiguration", "(", ").", "getAllowOrigin", "(", "))", ";", "@", "Inject", "private", "CORSConfiguration", "corsConfiguration", ";", "public", "CORSConfiguration", "getCORSConfiguration", "(", ")", "{", "return", "corsConfiguration", ";", "}", "@", "Named", "@", "Singleton", "public", "static", "class", "CORSConfiguration", "implements", "Serializable", "{", "@", "Inject", "@", "Config", "(", "\"", "server", ".", "cors", ".", "allowOrigin", "\"", ")", "private", "String", "allowOrigin", ";", "public", "String", "getAllowOrigin", "(", ")", "{", "return", "allowOrigin", ";", "}", "}</s>httpResp", ".", "setHeader", "(", "\"", "Access", "-", "Control", "-", "Allow", "-", "Origin", "\"", ",", "\"", "*\"", ");"], "docstring_tokens": ["and", "references", "to", "usernames"]}
{"contents": ["empty"], "code_tokens": ["char", "*", "command", ",", "*", "largs", "=", "NULL", ",", "*", "args", "=", "value", ";", "/", "*", "AppArmor", "requires", "that", "the", "buffer", "must", "be", "null", "terminated", "atm", "*", "/", "if", "(", "args", "[", "size", "-", "1", "]", "!", "=", "'", "\\", "0", "'", ")", "{", "/", "*", "null", "terminate", "*", "/", "largs", "=", "args", "=", "kmalloc", "(", "size", "+", "1", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "args", ")", "return", "-", "ENOMEM", ";", "memcpy", "(", "args", ",", "value", ",", "size", ")", ";", "args", "[", "size", "]", "=", "'", "\\", "0", "'", ";", "}", "error", "=", "-", "EINVAL", ";", "goto", "out", ";", "goto", "out", ";", "goto", "fail", ";", "out", ":", "kfree", "(", "largs", ")", ";", "aad", ".", "error", "=", "error", "=", "-", "EINVAL", ";", "goto", "out", ";</s>char", "*", "command", ",", "*", "args", "=", "value", ";", "/", "*", "args", "points", "to", "a", "PAGE_SIZE", "buffer", ",", "AppArmor", "requires", "that", "*", "the", "buffer", "must", "be", "null", "terminated", "or", "have", "size", "<", "=", "PAGE_SIZE", "-", "1", "*", "so", "that", "AppArmor", "can", "null", "terminate", "them", "*", "/", "if", "(", "args", "[", "size", "-", "1", "]", "!", "=", "'", "\\", "0", "'", ")", "{", "if", "(", "size", "=", "=", "PAGE_SIZE", ")", "return", "-", "EINVAL", ";", "args", "[", "size", "]", "=", "'", "\\", "0", "'", ";", "}", "args", "=", "value", ";", "return", "-", "EINVAL", ";", "return", "-", "EINVAL", ";", "return", "-", "EINVAL", ";", "aad", ".", "error", "=", "-", "EINVAL", ";", "return", "-", "EINVAL", ";"], "docstring_tokens": ["a", "local", "privilege", "escalation"]}
{"contents": ["empty"], "code_tokens": ["#", "define", "UNIX_INFLIGHT_TRIGGER_GC", "16000", "/", "*", "*", "If", "number", "of", "inflight", "sockets", "is", "insane", ",", "*", "force", "a", "garbage", "collect", "right", "now", ".", "*", "/", "if", "(", "unix_tot_inflight", ">", "UNIX_INFLIGHT_TRIGGER_GC", "&", "&", "!", "gc_in_progress", ")", "unix_gc", "(", ");</s>"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(system", "hang", ")"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "page", "=", "=", "NULL", ")", "{", "return", "kvm_skip_emulated_instruction", "(", "vcpu", ")", ";", "}", "if", "(", "*(", "u32", "*", ")", "kmap", "(", "page", ")", "!", "=", "VMCS12_REVISION", ")", "{", "nested_release_page_clean", "(", "page", ")", ";", "nested_vmx_failInvalid", "(", "vcpu", ")", ";", "nested_release_page_clean", "(", "page", ")", ";</s>if", "(", "page", "=", "=", "NULL", "|", "|", "*", "(", "u32", "*", ")", "kmap", "(", "page", ")", "!", "=", "VMCS12_REVISION", ")", "{"], "docstring_tokens": ["memory", "consumption", "and", "the", "system", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["memset", "(", "&", "r1", ",", "0", ",", "sizeof", "(", "r1", ")", ");</s>"], "docstring_tokens": ["obtain", "sensitive", "information", "from", "kernel", "stack", "memory"]}
{"contents": ["empty"], "code_tokens": ["rule_buf", "=", "kzalloc", "(", "info", ".", "rule_cnt", "*", "sizeof", "(", "u32", ")", ",</s>rule_buf", "=", "kmalloc", "(", "info", ".", "rule_cnt", "*", "sizeof", "(", "u32", ")", ","], "docstring_tokens": ["obtain", "potentially", "sensitive", "information"]}
{"contents": ["empty"], "code_tokens": ["/", "/", "If", "we", "have", "not", "switched", "to", "studio", "profile", "than", "we", "also", "did", "not", "switch", "bps", "/", "/", "that", "means", "something", "else", "(", "like", "a", "previous", "instance", ")", "outside", "set", "bps", "which", "/", "/", "would", "be", "inconsistant", "with", "the", "currect", "state", ",", "thus", "reset", "it", "if", "(", "!", "s", "-", ">", "studio_profile", "&", "&", "s", "-", ">", "avctx", "-", ">", "bits_per_raw_sample", "!", "=", "8", ")", "s", "-", ">", "avctx", "-", ">", "bits_per_raw_sample", "=", "0", ";</s>"], "docstring_tokens": ["a", "denial", "of", "service", "condition"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "test_bit", "(", "ATM_VF_LISTEN", ",", "&", "vcc", "-", ">", "flags", ")", ")", "{", "error", "=", "-", "EADDRINUSE", ";", "goto", "out", ";", "}", "vcc_insert_socket", "(", "sk", ")", ";</s>vcc_insert_socket", "(", "sk", ")", ";"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(kernel", "infinite", "loop", ")"]}
{"contents": ["empty"], "code_tokens": ["(", "(", "image", "-", ">", "ping", "=", "=", "MagickFalse", ")", "&", "&", "(", "jp2_image", "-", ">", "comps", "[", "i", "]", ".", "data", "=", "=", "NULL", ")", "))</s>(", "jp2_image", "-", ">", "comps", "[", "i", "]", ".", "data", "=", "=", "NULL", ")", ")"], "docstring_tokens": ["the", "application", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["memset", "(", "sax", ",", "0", ",", "sizeof", "(", "*", "sax", ")", ");</s>memset", "(", "sax", ",", "0", ",", "sizeof", "(", "sax", ")", ");"], "docstring_tokens": ["obtain", "sensitive", "information", "from", "kernel", "stack", "memory"]}
{"contents": ["empty"], "code_tokens": ["public", "interface", "Enum", "{", "int", "getLength", "(", ");", "}", "public", "int", "getLength", "(", ")", "{", "return", "LENGTH", ";", "}", "/", "/", "String", "table", "in", "the", "fsimage", "utilizes", "an", "expanded", "bit", "range", ".", "public", "static", "final", "String", "DFS_IMAGE_EXPANDED_STRING_TABLES_KEY", "=", "\"", "dfs", ".", "image", ".", "string", "-", "tables", ".", "expanded", "\"", ";", "public", "static", "final", "boolean", "DFS_IMAGE_EXPANDED_STRING_TABLES_DEFAULT", "=", "false", ";", "*", "*", "Note", ":", "this", "format", "is", "used", "both", "in", "-", "memory", "and", "on", "-", "disk", ".", "Changes", "will", "be", "*", "incompatible", ".", "*", "public", "enum", "AclEntryStatusFormat", "implements", "LongBitFormat", ".", "Enum", "{", "PERMISSION", "(", "null", ",", "3", ")", ",", "TYPE", "(", "PERMISSION", ".", "BITS", ",", "2", ")", ",", "SCOPE", "(", "TYPE", ".", "BITS", ",", "1", ")", ",", "NAME", "(", "SCOPE", ".", "BITS", ",", "24", ")", ";", "private", "static", "final", "FsAction", "[", "]", "FSACTION_VALUES", "=", "FsAction", ".", "values", "(", ");", "private", "static", "final", "AclEntryScope", "[", "]", "ACL_ENTRY_SCOPE_VALUES", "=", "AclEntryScope", ".", "values", "(", ");", "private", "static", "final", "AclEntryType", "[", "]", "ACL_ENTRY_TYPE_VALUES", "=", "AclEntryType", ".", "values", "(", ");", "return", "ACL_ENTRY_SCOPE_VALUES", "[", "ordinal", "]", ";", "return", "ACL_ENTRY_TYPE_VALUES", "[", "ordinal", "]", ";", "return", "FSACTION_VALUES", "[", "ordinal", "]", ";", "return", "getName", "(", "aclEntry", ",", "null", ")", ";", "}", "static", "String", "getName", "(", "int", "aclEntry", ",", "SerialNumberManager", ".", "StringTable", "stringTable", ")", "{", "SerialNumberManager", "snm", "=", "getSerialNumberManager", "(", "getType", "(", "aclEntry", ")", ");", "if", "(", "snm", "!", "=", "null", ")", "{", "int", "nid", "=", "(", "int", ")", "NAME", ".", "BITS", ".", "retrieve", "(", "aclEntry", ")", ";", "return", "snm", ".", "getString", "(", "nid", ",", "stringTable", ")", ";", "SerialNumberManager", "snm", "=", "getSerialNumberManager", "(", "aclEntry", ".", "getType", "(", "))", ";", "if", "(", "snm", "!", "=", "null", ")", "{", "int", "nid", "=", "snm", ".", "getSerialNumber", "(", "aclEntry", ".", "getName", "(", "))", ";", "aclEntryInt", "=", "NAME", ".", "BITS", ".", "combine", "(", "nid", ",", "aclEntryInt", ")", ";", "return", "toAclEntry", "(", "aclEntry", ",", "null", ")", ";", "}", "static", "AclEntry", "toAclEntry", "(", "int", "aclEntry", ",", "SerialNumberManager", ".", "StringTable", "stringTable", ")", "{", "return", "new", "AclEntry", ".", "Builder", "(", ")", ".", "setScope", "(", "getScope", "(", "aclEntry", ")", ")", ".", "setType", "(", "getType", "(", "aclEntry", ")", ")", ".", "setPermission", "(", "getPermission", "(", "aclEntry", ")", ")", ".", "setName", "(", "getName", "(", "aclEntry", ",", "stringTable", ")", ")", ".", "build", "(", ");", "private", "static", "SerialNumberManager", "getSerialNumberManager", "(", "AclEntryType", "type", ")", "{", "switch", "(", "type", ")", "{", "case", "USER", ":", "return", "SerialNumberManager", ".", "USER", ";", "case", "GROUP", ":", "return", "SerialNumberManager", ".", "GROUP", ";", "default", ":", "return", "null", ";", "}", "@", "Override", "public", "int", "getLength", "(", ")", "{", "return", "BITS", ".", "getLength", "(", ");", "/", "/", "used", "to", "enable", "/", "disable", "the", "use", "of", "expanded", "string", "tables", ".", "SerialNumberManager", ".", "initialize", "(", "conf", ")", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "INodeWithAdditionalFields", ".", "PermissionStatusFormat", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "SerialNumberManager", ".", "StringTable", ";", "/", "/", "the", "loader", "must", "decode", "all", "fields", "referencing", "serial", "number", "based", "fields", "/", "/", "via", "to", "<", "Item", ">", "methods", "with", "the", "string", "table", ".", "final", "StringTable", "stringTable", ")", "{", "return", "PermissionStatusFormat", ".", "toPermissionStatus", "(", "id", ",", "stringTable", ")", ";", "AclFeatureProto", "proto", ",", "final", "StringTable", "stringTable", ")", "{", "b", ".", "add", "(", "AclEntryStatusFormat", ".", "toAclEntry", "(", "v", ",", "stringTable", ")", ");", "XAttrFeatureProto", "proto", ",", "final", "StringTable", "stringTable", ")", "{", "b", ".", "add", "(", "XAttrFormat", ".", "toXAttr", "(", "v", ",", "value", ",", "stringTable", ")", ");", "/", "/", "the", "saver", "can", "directly", "write", "out", "fields", "referencing", "serial", "numbers", ".", "/", "/", "the", "serial", "number", "maps", "will", "be", "compacted", "when", "loading", ".", "private", "static", "long", "buildPermissionStatus", "(", "INodeAttributes", "n", ")", "{", "return", "n", ".", "getPermissionLong", "(", ");", "private", "static", "AclFeatureProto", ".", "Builder", "buildAclEntries", "(", "AclFeature", "f", ")", "{", "b", ".", "addEntries", "(", "e", ")", ";", "private", "static", "XAttrFeatureProto", ".", "Builder", "buildXAttrs", "(", "XAttrFeature", "f", ")", "{", "int", "v", "=", "XAttrFormat", ".", "toInt", "(", "a", ")", ";", ".", "setPermission", "(", "buildPermissionStatus", "(", "file", ")", ")", "b", ".", "setAcl", "(", "buildAclEntries", "(", "f", ")", ");", "b", ".", "setXAttrs", "(", "buildXAttrs", "(", "xAttrFeature", ")", ");", ".", "setPermission", "(", "buildPermissionStatus", "(", "dir", ")", ");", "b", ".", "setAcl", "(", "buildAclEntries", "(", "f", ")", ");", "b", ".", "setXAttrs", "(", "buildXAttrs", "(", "xAttrFeature", ")", ");", ".", "setPermission", "(", "buildPermissionStatus", "(", "n", ")", ")", "private", "SerialNumberManager", ".", "StringTable", "stringTable", ";", "public", "SerialNumberManager", ".", "StringTable", "getStringTable", "(", ")", "{", "ctx", ".", "stringTable", "=", "SerialNumberManager", ".", "newStringTable", "(", "s", ".", "getNumEntry", "(", "),", "s", ".", "getMaskBits", "(", "))", ";", "ctx", ".", "stringTable", ".", "put", "(", "e", ".", "getId", "(", "),", "e", ".", "getStr", "(", "))", ";", "SerialNumberManager", ".", "StringTable", "stringTable", "=", "SerialNumberManager", ".", "getStringTable", "(", ");", ".", "setNumEntry", "(", "stringTable", ".", "size", "(", "))", ".", "setMaskBits", "(", "stringTable", ".", "getMaskBits", "(", "))", ";", "for", "(", "Entry", "<", "Integer", ",", "String", ">", "e", ":", "stringTable", ")", "{", ".", "newBuilder", "(", ").", "setId", "(", "e", ".", "getKey", "(", "))", ".", "setStr", "(", "e", ".", "getValue", "(", "))", ";", "/", "/", "Note", ":", "this", "format", "is", "used", "both", "in", "-", "memory", "and", "on", "-", "disk", ".", "Changes", "will", "be", "/", "/", "incompatible", ".", "enum", "PermissionStatusFormat", "implements", "LongBitFormat", ".", "Enum", "{", "String", "s", "=", "SerialNumberManager", ".", "USER", ".", "getString", "(", "n", ")", ";", "assert", "s", "!", "=", "null", ";", "return", "s", ";", "return", "SerialNumberManager", ".", "GROUP", ".", "getString", "(", "n", ")", ";", "final", "int", "user", "=", "SerialNumberManager", ".", "USER", ".", "getSerialNumber", "(", "assert", "user", "!", "=", "0", ";", "/", "/", "ideally", "should", "assert", "on", "group", "but", "inodes", "are", "created", "with", "null", "/", "/", "group", "and", "then", "updated", "only", "when", "added", "to", "a", "directory", ".", "final", "int", "group", "=", "SerialNumberManager", ".", "GROUP", ".", "getSerialNumber", "(", "static", "PermissionStatus", "toPermissionStatus", "(", "long", "id", ",", "SerialNumberManager", ".", "StringTable", "stringTable", ")", "{", "int", "uid", "=", "(", "int", ")", "USER", ".", "BITS", ".", "retrieve", "(", "id", ")", ";", "int", "gid", "=", "(", "int", ")", "GROUP", ".", "BITS", ".", "retrieve", "(", "id", ")", ";", "return", "new", "PermissionStatus", "(", "SerialNumberManager", ".", "USER", ".", "getString", "(", "uid", ",", "stringTable", ")", ",", "SerialNumberManager", ".", "GROUP", ".", "getString", "(", "gid", ",", "stringTable", ")", ",", "new", "FsPermission", "(", "getMode", "(", "id", ")", "))", ";", "}", "@", "Override", "public", "int", "getLength", "(", ")", "{", "return", "BITS", ".", "getLength", "(", ");", "}", "int", "n", "=", "SerialNumberManager", ".", "USER", ".", "getSerialNumber", "(", "user", ")", ";", "int", "n", "=", "SerialNumberManager", ".", "GROUP", ".", "getSerialNumber", "(", "group", ")", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "conf", ".", "Configuration", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "INodeWithAdditionalFields", ".", "PermissionStatusFormat", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "util", ".", "LongBitFormat", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Map", ".", "Entry", ";", "import", "static", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "DFSConfigKeys", ".", "DFS_IMAGE_EXPANDED_STRING_TABLES_DEFAULT", ";", "import", "static", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "DFSConfigKeys", ".", "DFS_IMAGE_EXPANDED_STRING_TABLES_KEY", ";", "/", "**", "Manage", "name", "-", "to", "-", "serial", "-", "number", "maps", "for", "various", "string", "tables", ".", "*", "/", "public", "enum", "SerialNumberManager", "{", "GLOBAL", "(", "),", "/", "/", "NEVER", "EVER", "directly", "access", "!", "USER", "(", "PermissionStatusFormat", ".", "USER", ",", "AclEntryStatusFormat", ".", "NAME", ")", ",", "GROUP", "(", "PermissionStatusFormat", ".", "GROUP", ",", "AclEntryStatusFormat", ".", "NAME", ")", ",", "XATTR", "(", "XAttrFormat", ".", "NAME", ")", ";", "private", "static", "final", "SerialNumberManager", "[", "]", "values", "=", "values", "(", ");", "private", "static", "final", "int", "maxEntryBits", ";", "private", "static", "final", "int", "maxEntryNumber", ";", "private", "static", "final", "int", "maskBits", ";", "private", "static", "boolean", "initialized", ";", "private", "SerialNumberMap", "<", "String", ">", "serialMap", ";", "private", "int", "bitLength", "=", "Integer", ".", "SIZE", ";", "private", "boolean", "enabled", ";", "static", "{", "maxEntryBits", "=", "Integer", ".", "numberOfLeadingZeros", "(", "values", ".", "length", ")", ";", "maxEntryNumber", "=", "(", "1", "<", "<", "maxEntryBits", ")", "-", "1", ";", "maskBits", "=", "Integer", ".", "SIZE", "-", "maxEntryBits", ";", "for", "(", "SerialNumberManager", "snm", ":", "values", ")", "{", "/", "/", "account", "for", "string", "table", "mask", "bits", ".", "snm", ".", "updateLength", "(", "maxEntryBits", ")", ";", "/", "/", "find", "max", "allowed", "length", "in", "case", "global", "is", "enabled", ".", "GLOBAL", ".", "updateLength", "(", "snm", ".", "getLength", "(", "))", ";", "}", "/", "/", "can", "reinitialize", "once", "later", ".", "initializeSerialMaps", "(", "DFS_IMAGE_EXPANDED_STRING_TABLES_DEFAULT", ")", ";", "}", "static", "synchronized", "void", "initialize", "(", "Configuration", "conf", ")", "{", "boolean", "useExpanded", "=", "conf", ".", "getBoolean", "(", "DFS_IMAGE_EXPANDED_STRING_TABLES_KEY", ",", "DFS_IMAGE_EXPANDED_STRING_TABLES_DEFAULT", ")", ";", "if", "(", "initialized", ")", "{", "if", "(", "useExpanded", "^", "!", "GLOBAL", ".", "enabled", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "Cannot", "change", "serial", "maps", "\"", ");", "}", "return", ";", "}", "initializeSerialMaps", "(", "useExpanded", ")", ";", "for", "(", "SerialNumberManager", "snm", ":", "values", ")", "{", "if", "(", "snm", ".", "enabled", ")", "{", "FSDirectory", ".", "LOG", ".", "info", "(", "snm", "+", "\"", "serial", "map", ":", "bits", "=", "\"", "+", "snm", ".", "getLength", "(", ")", "\"", "maxEntries", "=", "\"", "+", "snm", ".", "serialMap", ".", "getMax", "(", "))", ";", "}", "}", "initialized", "=", "true", ";", "}", "private", "static", "void", "initializeSerialMaps", "(", "boolean", "useExpanded", ")", "{", "if", "(", "useExpanded", ")", "{", "/", "/", "initialize", "per", "-", "manager", "serial", "maps", "for", "all", "but", "global", ".", "for", "(", "SerialNumberManager", "snm", ":", "values", ")", "{", "snm", ".", "enabled", "=", "(", "snm", "!", "=", "GLOBAL", ")", ";", "snm", ".", "serialMap", "=", "snm", ".", "enabled", "?", "new", "SerialNumberMap", "<", "String", ">", "(", "snm", ")", ":", "null", ";", "}", "}", "else", "{", "/", "/", "initialize", "all", "managers", "to", "use", "the", "global", "serial", "map", ".", "SerialNumberMap", "<", "String", ">", "globalSerialMap", "=", "new", "SerialNumberMap", "<", ">(", "GLOBAL", ")", ";", "for", "(", "SerialNumberManager", "snm", ":", "values", ")", "{", "snm", ".", "enabled", "=", "(", "snm", "=", "=", "GLOBAL", ")", ";", "snm", ".", "serialMap", "=", "globalSerialMap", ";", "}", "}", "}", "SerialNumberManager", "(", "LongBitFormat", ".", "Enum", ".", "..", "elements", ")", "{", "/", "/", "compute", "the", "smallest", "bit", "length", "registered", "with", "the", "serial", "manager", ".", "for", "(", "LongBitFormat", ".", "Enum", "element", ":", "elements", ")", "{", "updateLength", "(", "element", ".", "getLength", "(", "))", ";", "}", "}", "int", "getLength", "(", ")", "{", "return", "bitLength", ";", "}", "private", "void", "updateLength", "(", "int", "maxLength", ")", "{", "bitLength", "=", "Math", ".", "min", "(", "bitLength", ",", "maxLength", ")", ";", "}", "public", "int", "getSerialNumber", "(", "String", "u", ")", "{", "return", "serialMap", ".", "get", "(", "u", ")", ";", "}", "public", "String", "getString", "(", "int", "id", ")", "{", "return", "serialMap", ".", "get", "(", "id", ")", ";", "}", "public", "String", "getString", "(", "int", "id", ",", "StringTable", "stringTable", ")", "{", "return", "(", "stringTable", "!", "=", "null", ")", "?", "stringTable", ".", "get", "(", "this", ",", "id", ")", ":", "getString", "(", "id", ")", ";", "}", "private", "int", "getMask", "(", "int", "bits", ")", "{", "return", "ordinal", "(", ")", "<", "<", "(", "Integer", ".", "SIZE", "-", "bits", ")", ";", "}", "private", "static", "int", "getMaskBits", "(", ")", "{", "return", "GLOBAL", ".", "enabled", "?", "0", ":", "maskBits", ";", "}", "private", "int", "size", "(", ")", "{", "return", "enabled", "?", "serialMap", ".", "size", "(", ")", ":", "0", ";", "}", "private", "Iterable", "<", "Entry", "<", "Integer", ",", "String", ">", ">", "entrySet", "(", ")", "{", "if", "(", "!", "enabled", ")", "{", "return", "Collections", ".", "emptySet", "(", ");", "}", "return", "serialMap", ".", "entrySet", "(", ");", "}", "/", "/", "returns", "snapshot", "of", "current", "values", "for", "a", "save", ".", "public", "static", "StringTable", "getStringTable", "(", ")", "{", "/", "/", "approximate", "size", "for", "capacity", ".", "int", "size", "=", "0", ";", "for", "(", "final", "SerialNumberManager", "snm", ":", "values", ")", "{", "size", "+", "=", "snm", ".", "size", "(", ");", "}", "int", "tableMaskBits", "=", "getMaskBits", "(", ");", "StringTable", "map", "=", "new", "StringTable", "(", "size", ",", "tableMaskBits", ")", ";", "for", "(", "final", "SerialNumberManager", "snm", ":", "values", ")", "{", "final", "int", "mask", "=", "snm", ".", "getMask", "(", "tableMaskBits", ")", ";", "for", "(", "Entry", "<", "Integer", ",", "String", ">", "entry", ":", "snm", ".", "entrySet", "(", "))", "{", "map", ".", "put", "(", "entry", ".", "getKey", "(", ")", "|", "mask", ",", "entry", ".", "getValue", "(", "))", ";", "}", "}", "return", "map", ";", "}", "/", "/", "returns", "an", "empty", "table", "for", "load", ".", "public", "static", "StringTable", "newStringTable", "(", "int", "size", ",", "int", "bits", ")", "{", "if", "(", "bits", ">", "maskBits", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "String", "table", "bits", "\"", "+", "bits", "+", "\"", ">", "\"", "+", "maskBits", ")", ";", "}", "return", "new", "StringTable", "(", "size", ",", "bits", ")", ";", "}", "public", "static", "class", "StringTable", "implements", "Iterable", "<", "Entry", "<", "Integer", ",", "String", ">", ">", "{", "private", "final", "int", "tableMaskBits", ";", "private", "final", "Map", "<", "Integer", ",", "String", ">", "map", ";", "private", "StringTable", "(", "int", "size", ",", "int", "loadingMaskBits", ")", "{", "this", ".", "tableMaskBits", "=", "loadingMaskBits", ";", "this", ".", "map", "=", "new", "HashMap", "<", ">(", "size", ")", ";", "}", "private", "String", "get", "(", "SerialNumberManager", "snm", ",", "int", "id", ")", "{", "if", "(", "tableMaskBits", "!", "=", "0", ")", "{", "if", "(", "id", ">", "maxEntryNumber", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "serial", "id", "\"", "+", "id", "+", "\"", ">", "\"", "+", "maxEntryNumber", ")", ";", "}", "id", "|", "=", "snm", ".", "getMask", "(", "tableMaskBits", ")", ";", "}", "return", "map", ".", "get", "(", "id", ")", ";", "}", "public", "void", "put", "(", "int", "id", ",", "String", "str", ")", "{", "map", ".", "put", "(", "id", ",", "str", ")", ";", "}", "public", "Iterator", "<", "Entry", "<", "Integer", ",", "String", ">", ">", "iterator", "(", ")", "{", "return", "map", ".", "entrySet", "(", ").", "iterator", "(", ");", "}", "public", "int", "size", "(", ")", "{", "return", "map", ".", "size", "(", ");", "}", "public", "int", "getMaskBits", "(", ")", "{", "return", "tableMaskBits", ";", "}", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "private", "String", "name", ";", "private", "final", "int", "max", ";", "private", "final", "AtomicInteger", "current", "=", "new", "AtomicInteger", "(", "1", ")", ";", "SerialNumberMap", "(", "SerialNumberManager", "snm", ")", "{", "this", "(", "snm", ".", "name", "(", "),", "snm", ".", "getLength", "(", "))", ";", "}", "SerialNumberMap", "(", "String", "name", ",", "int", "bitLength", ")", "{", "this", ".", "name", "=", "name", ";", "this", ".", "max", "=", "(", "1", "<", "<", "bitLength", ")", "-", "1", ";", "}", "sn", "=", "current", ".", "getAndIncrement", "(", ");", "if", "(", "sn", ">", "max", ")", "{", "current", ".", "getAndDecrement", "(", ");", "throw", "new", "IllegalStateException", "(", "name", "+", "\"", ":", "serial", "number", "map", "is", "full", "\"", ");", "throw", "new", "IllegalStateException", "(", "name", "+", "\"", ":", "serial", "number", "\"", "+", "i", "+", "\"", "does", "not", "exist", "\"", ");", "int", "getMax", "(", ")", "{", "return", "max", ";", "}", "Set", "<", "Map", ".", "Entry", "<", "Integer", ",", "T", ">", ">", "entrySet", "(", ")", "{", "return", "new", "HashSet", "<", ">(", "i2t", ".", "entrySet", "(", "))", ";", "}", "public", "int", "size", "(", ")", "{", "return", "i2t", ".", "size", "(", ");", "}", "return", "\"", "current", "=", "\"", "+", "current", "+", "\"", ",\\", "n", "\"", "\"", "max", "=", "\"", "+", "max", "+", "\"", ",\\", "n", "t2i", "=", "\"", "+", "t2i", "+", "\"", ",\\", "n", "i2t", "=", "\"", "+", "i2t", ";", "*", "*", "Note", ":", "this", "format", "is", "used", "both", "in", "-", "memory", "and", "on", "-", "disk", ".", "Changes", "will", "be", "*", "incompatible", ".", "*", "public", "enum", "XAttrFormat", "implements", "LongBitFormat", ".", "Enum", "{", "RESERVED", "(", "null", ",", "5", ")", ",", "NS_EXT", "(", "RESERVED", ".", "BITS", ",", "1", ")", ",", "NAME", "(", "NS_EXT", ".", "BITS", ",", "24", ")", ",", "NS", "(", "NAME", ".", "BITS", ",", "2", ")", ";", "private", "static", "final", "int", "NS_EXT_SHIFT", "=", "NS", ".", "BITS", ".", "getLength", "(", ");", "private", "static", "final", "int", "NS_MASK", "=", "(", "1", "<", "<", "NS_EXT_SHIFT", ")", "-", "1", ";", "private", "static", "final", "int", "XATTR_VALUE_LEN_MAX", "=", "1", "<", "<", "16", ";", "private", "static", "final", "XAttr", ".", "NameSpace", "[", "]", "XATTR_NAMESPACE_VALUES", "=", "XAttr", ".", "NameSpace", ".", "values", "(", ");", "private", "final", "LongBitFormat", "BITS", ";", "XAttrFormat", "(", "LongBitFormat", "previous", ",", "int", "length", ")", "{", "BITS", "=", "new", "LongBitFormat", "(", "name", "(", "),", "previous", ",", "length", ",", "0", ")", ";", "}", "@", "Override", "public", "int", "getLength", "(", ")", "{", "return", "BITS", ".", "getLength", "(", ");", "}", "static", "XAttr", ".", "NameSpace", "getNamespace", "(", "int", "record", ")", "{", "long", "nid", "=", "NS", ".", "BITS", ".", "retrieve", "(", "record", ")", ";", "nid", "|", "=", "NS_EXT", ".", "BITS", ".", "retrieve", "(", "record", ")", "<", "<", "NS_EXT_SHIFT", ";", "return", "XATTR_NAMESPACE_VALUES", "[", "(", "int", ")", "nid", "]", ";", "}", "public", "static", "String", "getName", "(", "int", "record", ")", "{", "int", "nid", "=", "(", "int", ")", "NAME", ".", "BITS", ".", "retrieve", "(", "record", ")", ";", "return", "SerialNumberManager", ".", "XATTR", ".", "getString", "(", "nid", ")", ";", "static", "int", "toInt", "(", "XAttr", "a", ")", "{", "int", "nid", "=", "SerialNumberManager", ".", "XATTR", ".", "getSerialNumber", "(", "a", ".", "getName", "(", "))", ";", "int", "nsOrd", "=", "a", ".", "getNameSpace", "(", ").", "ordinal", "(", ");", "long", "value", "=", "NS", ".", "BITS", ".", "combine", "(", "nsOrd", "&", "NS_MASK", ",", "0L", ")", ";", "value", "=", "NS_EXT", ".", "BITS", ".", "combine", "(", "nsOrd", ">", ">>", "NS_EXT_SHIFT", ",", "value", ")", ";", "value", "=", "NAME", ".", "BITS", ".", "combine", "(", "nid", ",", "value", ")", ";", "return", "(", "int", ")", "value", ";", "}", "static", "XAttr", "toXAttr", "(", "int", "record", ",", "byte", "[", "]", "value", ",", "SerialNumberManager", ".", "StringTable", "stringTable", ")", "{", "int", "nid", "=", "(", "int", ")", "NAME", ".", "BITS", ".", "retrieve", "(", "record", ")", ";", "String", "name", "=", "SerialNumberManager", ".", "XATTR", ".", "getString", "(", "nid", ",", "stringTable", ")", ";", "return", "new", "XAttr", ".", "Builder", "(", ")", ".", "setNameSpace", "(", "getNamespace", "(", "record", ")", ")", ".", "setName", "(", "name", ")", ".", "setValue", "(", "value", ")", ".", "build", "(", ");", "}", "builder", ".", "setNameSpace", "(", "XAttrFormat", ".", "getNamespace", "(", "v", ")", ");", "builder", ".", "setName", "(", "XAttrFormat", ".", "getName", "(", "v", ")", ");", "XAttr", ".", "NameSpace", "namespace", "=", "XAttrFormat", ".", "getNamespace", "(", "v", ")", ";", "String", "name", "=", "XAttrFormat", ".", "getName", "(", "v", ")", ";", "/", "/", "big", "-", "endian", "int", "v", "=", "XAttrFormat", ".", "toInt", "(", "a", ")", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "SerialNumberManager", ";", "private", "final", "SerialNumberManager", ".", "StringTable", "stringTable", ";", "private", "FSImageLoader", "(", "SerialNumberManager", ".", "StringTable", "stringTable", ",", "byte", "[", "][", "]", "inodes", ",", "Map", "<", "Long", ",", "long", "[", "]>", "dirmap", ")", "{", "SerialNumberManager", ".", "StringTable", "stringTable", "=", "null", ";", "static", "SerialNumberManager", ".", "StringTable", "loadStringTable", "(", "InputStream", "in", ")", "throws", "IOException", "{", "SerialNumberManager", ".", "StringTable", "stringTable", "=", "SerialNumberManager", ".", "newStringTable", "(", "s", ".", "getNumEntry", "(", "),", "s", ".", "getMaskBits", "(", "))", ";", "stringTable", ".", "put", "(", "e", ".", "getId", "(", "),", "e", ".", "getStr", "(", "))", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "SerialNumberManager", ";", "private", "SerialNumberManager", ".", "StringTable", "stringTable", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "SerialNumberManager", ";", "private", "SerialNumberManager", ".", "StringTable", "stringTable", ";", "o", "(", "SECTION_NAME", ",", "SerialNumberManager", ".", "XATTR", ".", "getString", "(", "XATTR_NAME_MASK", "&", "(", "encodedName", ">", ">", "XATTR_NAME_OFFSET", ")", ",", "stringTable", ")", ");", "if", "(", "d", ".", "hasSnapshotCopy", "(", "))", "{", "dumpINodeDirectory", "(", "d", ".", "getSnapshotCopy", "(", "))", ";", "stringTable", "=", "FSImageLoader", ".", "loadStringTable", "(", "in", ")", ";", "optional", "uint32", "maskBits", "=", "2", "[", "default", "=", "0", "]", ";", "INodeDirectory", "parent", "=", "namesystem", ".", "getFSDirectory", "(", ").", "getRoot", "(", ");</s>*", "The", "bits", "can", "be", "divided", "in", "four", "segments", ":", "<", "br", ">", "*", "[", "0", ":", "1", ")", "|", "|", "[", "1", ":", "3", ")", "|", "|", "[", "3", ":", "6", ")", "|", "|", "[", "6", ":", "7", ")", "|", "|", "[", "7", ":", "32", ")", "<", "br", ">", "*", "<", "br", ">", "*", "[", "0", ":", "1", ")", "-", "-", "the", "scope", "of", "the", "entry", "(", "AclEntryScope", ")", "<", "br", ">", "*", "[", "1", ":", "3", ")", "-", "-", "the", "type", "of", "the", "entry", "(", "AclEntryType", ")", "<", "br", ">", "*", "[", "3", ":", "6", ")", "-", "-", "the", "permission", "of", "the", "entry", "(", "FsAction", ")", "<", "br", ">", "*", "[", "6", ":", "7", ")", "-", "-", "A", "flag", "to", "indicate", "whether", "Named", "entry", "or", "not", "<", "br", ">", "*", "[", "7", ":", "8", ")", "-", "-", "Reserved", "<", "br", ">", "*", "[", "8", ":", "32", ")", "-", "-", "the", "name", "of", "the", "entry", ",", "which", "is", "an", "ID", "that", "points", "to", "a", "<", "br", ">", "*", "string", "in", "the", "StringTableSection", ".", "<", "br", ">", "public", "enum", "AclEntryStatusFormat", "{", "SCOPE", "(", "null", ",", "1", ")", ",", "TYPE", "(", "SCOPE", ".", "BITS", ",", "2", ")", ",", "PERMISSION", "(", "TYPE", ".", "BITS", ",", "3", ")", ",", "NAMED_ENTRY_CHECK", "(", "PERMISSION", ".", "BITS", ",", "1", ")", ",", "RESERVED", "(", "NAMED_ENTRY_CHECK", ".", "BITS", ",", "1", ")", ",", "NAME", "(", "RESERVED", ".", "BITS", ",", "24", ")", ";", "return", "AclEntryScope", ".", "values", "(", ")[", "ordinal", "]", ";", "return", "AclEntryType", ".", "values", "(", ")[", "ordinal", "]", ";", "return", "FsAction", ".", "values", "(", ")[", "ordinal", "]", ";", "int", "nameExists", "=", "(", "int", ")", "NAMED_ENTRY_CHECK", ".", "BITS", ".", "retrieve", "(", "aclEntry", ")", ";", "if", "(", "nameExists", "=", "=", "0", ")", "{", "return", "null", ";", "}", "int", "id", "=", "(", "int", ")", "NAME", ".", "BITS", ".", "retrieve", "(", "aclEntry", ")", ";", "AclEntryType", "type", "=", "getType", "(", "aclEntry", ")", ";", "if", "(", "type", "=", "=", "AclEntryType", ".", "USER", ")", "{", "return", "SerialNumberManager", ".", "INSTANCE", ".", "getUser", "(", "id", ")", ";", "}", "else", "if", "(", "type", "=", "=", "AclEntryType", ".", "GROUP", ")", "{", "return", "SerialNumberManager", ".", "INSTANCE", ".", "getGroup", "(", "id", ")", ";", "if", "(", "aclEntry", ".", "getName", "(", ")", "!", "=", "null", ")", "{", "aclEntryInt", "=", "NAMED_ENTRY_CHECK", ".", "BITS", ".", "combine", "(", "1", ",", "aclEntryInt", ")", ";", "if", "(", "aclEntry", ".", "getType", "(", ")", "=", "=", "AclEntryType", ".", "USER", ")", "{", "int", "userId", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getUserSerialNumber", "(", "aclEntry", ".", "getName", "(", "))", ";", "aclEntryInt", "=", "NAME", ".", "BITS", ".", "combine", "(", "userId", ",", "aclEntryInt", ")", ";", "}", "else", "if", "(", "aclEntry", ".", "getType", "(", ")", "=", "=", "AclEntryType", ".", "GROUP", ")", "{", "int", "groupId", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getGroupSerialNumber", "(", "aclEntry", ".", "getName", "(", "))", ";", "aclEntryInt", "=", "NAME", ".", "BITS", ".", "combine", "(", "groupId", ",", "aclEntryInt", ")", ";", "}", "AclEntry", ".", "Builder", "builder", "=", "new", "AclEntry", ".", "Builder", "(", ");", "builder", ".", "setScope", "(", "getScope", "(", "aclEntry", ")", ").", "setType", "(", "getType", "(", "aclEntry", ")", ")", ".", "setPermission", "(", "getPermission", "(", "aclEntry", ")", ");", "if", "(", "getName", "(", "aclEntry", ")", "!", "=", "null", ")", "{", "builder", ".", "setName", "(", "getName", "(", "aclEntry", ")", ");", "}", "return", "builder", ".", "build", "(", ");", "public", "static", "ImmutableList", "<", "AclEntry", ">", "toAclEntries", "(", "int", "[", "]", "entries", ")", "{", "ImmutableList", ".", "Builder", "<", "AclEntry", ">", "b", "=", "new", "ImmutableList", ".", "Builder", "<", "AclEntry", ">", "()", ";", "for", "(", "int", "entry", ":", "entries", ")", "{", "AclEntry", "aclEntry", "=", "toAclEntry", "(", "entry", ")", ";", "b", ".", "add", "(", "aclEntry", ")", ";", "return", "b", ".", "build", "(", ");", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "permission", ".", "AclEntryScope", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "permission", ".", "AclEntryType", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "permission", ".", "FsAction", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "fs", ".", "permission", ".", "FsPermission", ";", "import", "com", ".", "google", ".", "common", ".", "base", ".", "Preconditions", ";", "private", "final", "static", "long", "USER_GROUP_STRID_MASK", "=", "(", "1", "<", "<", "24", ")", "-", "1", ";", "private", "final", "static", "int", "USER_STRID_OFFSET", "=", "40", ";", "private", "final", "static", "int", "GROUP_STRID_OFFSET", "=", "16", ";", "private", "static", "final", "int", "ACL_ENTRY_TYPE_MASK", "=", "3", ";", "private", "static", "final", "int", "ACL_ENTRY_SCOPE_MASK", "=", "1", ";", "private", "static", "final", "FsAction", "[", "]", "FSACTION_VALUES", "=", "FsAction", ".", "values", "(", ");", "private", "static", "final", "AclEntryScope", "[", "]", "ACL_ENTRY_SCOPE_VALUES", "=", "AclEntryScope", ".", "values", "(", ");", "private", "static", "final", "AclEntryType", "[", "]", "ACL_ENTRY_TYPE_VALUES", "=", "AclEntryType", ".", "values", "(", ");", "private", "static", "final", "XAttr", ".", "NameSpace", "[", "]", "XATTR_NAMESPACE_VALUES", "=", "XAttr", ".", "NameSpace", ".", "values", "(", ");", "final", "String", "[", "]", "stringTable", ")", "{", "short", "perm", "=", "(", "short", ")", "(", "id", "&", "(", "(", "1", "<", "<", "GROUP_STRID_OFFSET", ")", "-", "1", ")", ");", "int", "gsid", "=", "(", "int", ")", "(", "(", "id", ">", ">", "GROUP_STRID_OFFSET", ")", "&", "USER_GROUP_STRID_MASK", ")", ";", "int", "usid", "=", "(", "int", ")", "(", "(", "id", ">", ">", "USER_STRID_OFFSET", ")", "&", "USER_GROUP_STRID_MASK", ")", ";", "return", "new", "PermissionStatus", "(", "stringTable", "[", "usid", "]", ",", "stringTable", "[", "gsid", "]", ",", "new", "FsPermission", "(", "perm", ")", ");", "AclFeatureProto", "proto", ",", "final", "String", "[", "]", "stringTable", ")", "{", "int", "p", "=", "v", "&", "ACL_ENTRY_PERM_MASK", ";", "int", "t", "=", "(", "v", ">", ">", "ACL_ENTRY_TYPE_OFFSET", ")", "&", "ACL_ENTRY_TYPE_MASK", ";", "int", "s", "=", "(", "v", ">", ">", "ACL_ENTRY_SCOPE_OFFSET", ")", "&", "ACL_ENTRY_SCOPE_MASK", ";", "int", "nid", "=", "(", "v", ">", ">", "ACL_ENTRY_NAME_OFFSET", ")", "&", "ACL_ENTRY_NAME_MASK", ";", "String", "name", "=", "stringTable", "[", "nid", "]", ";", "b", ".", "add", "(", "new", "AclEntry", ".", "Builder", "(", ").", "setName", "(", "name", ")", ".", "setPermission", "(", "FSACTION_VALUES", "[", "p", "]", ")", ".", "setScope", "(", "ACL_ENTRY_SCOPE_VALUES", "[", "s", "]", ")", ".", "setType", "(", "ACL_ENTRY_TYPE_VALUES", "[", "t", "]", ").", "build", "(", "))", ";", "XAttrFeatureProto", "proto", ",", "final", "String", "[", "]", "stringTable", ")", "{", "int", "nid", "=", "(", "v", ">", ">", "XATTR_NAME_OFFSET", ")", "&", "XATTR_NAME_MASK", ";", "int", "ns", "=", "(", "v", ">", ">", "XATTR_NAMESPACE_OFFSET", ")", "&", "XATTR_NAMESPACE_MASK", ";", "ns", "|", "=", "(", "(", "v", ">", ">", "XATTR_NAMESPACE_EXT_OFFSET", ")", "&", "XATTR_NAMESPACE_EXT_MASK", ")", "<", "<", "2", ";", "String", "name", "=", "stringTable", "[", "nid", "]", ";", "b", ".", "add", "(", "new", "XAttr", ".", "Builder", "(", ").", "setNameSpace", "(", "XATTR_NAMESPACE_VALUES", "[", "ns", "]", ")", ".", "setName", "(", "name", ")", ".", "setValue", "(", "value", ")", ".", "build", "(", "))", ";", "private", "static", "long", "buildPermissionStatus", "(", "INodeAttributes", "n", ",", "final", "SaverContext", ".", "DeduplicationMap", "<", "String", ">", "stringMap", ")", "{", "long", "userId", "=", "stringMap", ".", "getId", "(", "n", ".", "getUserName", "(", "))", ";", "long", "groupId", "=", "stringMap", ".", "getId", "(", "n", ".", "getGroupName", "(", "))", ";", "return", "(", "(", "userId", "&", "USER_GROUP_STRID_MASK", ")", "<", "<", "USER_STRID_OFFSET", ")", "|", "(", "(", "groupId", "&", "USER_GROUP_STRID_MASK", ")", "<", "<", "GROUP_STRID_OFFSET", ")", "|", "n", ".", "getFsPermissionShort", "(", ");", "private", "static", "AclFeatureProto", ".", "Builder", "buildAclEntries", "(", "AclFeature", "f", ",", "final", "SaverContext", ".", "DeduplicationMap", "<", "String", ">", "map", ")", "{", "int", "nameId", "=", "map", ".", "getId", "(", "AclEntryStatusFormat", ".", "getName", "(", "e", ")", ");", "int", "v", "=", "(", "(", "nameId", "&", "ACL_ENTRY_NAME_MASK", ")", "<", "<", "ACL_ENTRY_NAME_OFFSET", ")", "|", "(", "AclEntryStatusFormat", ".", "getType", "(", "e", ")", ".", "ordinal", "(", ")", "<", "<", "ACL_ENTRY_TYPE_OFFSET", ")", "|", "(", "AclEntryStatusFormat", ".", "getScope", "(", "e", ")", ".", "ordinal", "(", ")", "<", "<", "ACL_ENTRY_SCOPE_OFFSET", ")", "|", "(", "AclEntryStatusFormat", ".", "getPermission", "(", "e", ")", ".", "ordinal", "(", "))", ";", "b", ".", "addEntries", "(", "v", ")", ";", "private", "static", "XAttrFeatureProto", ".", "Builder", "buildXAttrs", "(", "XAttrFeature", "f", ",", "final", "SaverContext", ".", "DeduplicationMap", "<", "String", ">", "stringMap", ")", "{", "int", "nsOrd", "=", "a", ".", "getNameSpace", "(", ").", "ordinal", "(", ");", "Preconditions", ".", "checkArgument", "(", "nsOrd", "<", "8", ",", "\"", "Too", "many", "namespaces", ".", "\")", ";", "int", "v", "=", "(", "(", "nsOrd", "&", "XATTR_NAMESPACE_MASK", ")", "<", "<", "XATTR_NAMESPACE_OFFSET", ")", "|", "(", "(", "stringMap", ".", "getId", "(", "a", ".", "getName", "(", "))", "&", "XATTR_NAME_MASK", ")", "<", "<", "XATTR_NAME_OFFSET", ")", ";", "v", "|", "=", "(", "((", "nsOrd", ">", ">", "2", ")", "&", "XATTR_NAMESPACE_EXT_MASK", ")", "<", "<", "XATTR_NAMESPACE_EXT_OFFSET", ")", ";", ".", "setPermission", "(", "buildPermissionStatus", "(", "file", ",", "state", ".", "getStringMap", "(", "))", ")", "b", ".", "setAcl", "(", "buildAclEntries", "(", "f", ",", "state", ".", "getStringMap", "(", "))", ");", "b", ".", "setXAttrs", "(", "buildXAttrs", "(", "xAttrFeature", ",", "state", ".", "getStringMap", "(", "))", ");", ".", "setPermission", "(", "buildPermissionStatus", "(", "dir", ",", "state", ".", "getStringMap", "(", "))", ");", "b", ".", "setAcl", "(", "buildAclEntries", "(", "f", ",", "state", ".", "getStringMap", "(", "))", ");", "b", ".", "setXAttrs", "(", "buildXAttrs", "(", "xAttrFeature", ",", "state", ".", "getStringMap", "(", "))", ");", ".", "setPermission", "(", "buildPermissionStatus", "(", "n", ",", "state", ".", "getStringMap", "(", "))", ")", "private", "String", "[", "]", "stringTable", ";", "public", "String", "[", "]", "getStringTable", "(", ")", "{", "private", "final", "DeduplicationMap", "<", "String", ">", "stringMap", "=", "DeduplicationMap", ".", "newMap", "(", ");", "public", "DeduplicationMap", "<", "String", ">", "getStringMap", "(", ")", "{", "return", "stringMap", ";", "}", "ctx", ".", "stringTable", "=", "new", "String", "[", "s", ".", "getNumEntry", "(", ")", "+", "1", "]", ";", "ctx", ".", "stringTable", "[", "e", ".", "getId", "(", ")]", "=", "e", ".", "getStr", "(", ");", ".", "setNumEntry", "(", "saverContext", ".", "stringMap", ".", "size", "(", "))", ";", "for", "(", "Entry", "<", "String", ",", "Integer", ">", "e", ":", "saverContext", ".", "stringMap", ".", "entrySet", "(", "))", "{", ".", "newBuilder", "(", ").", "setId", "(", "e", ".", "getValue", "(", "))", ".", "setStr", "(", "e", ".", "getKey", "(", "))", ";", "static", "enum", "PermissionStatusFormat", "{", "return", "SerialNumberManager", ".", "INSTANCE", ".", "getUser", "(", "n", ")", ";", "return", "SerialNumberManager", ".", "INSTANCE", ".", "getGroup", "(", "n", ")", ";", "final", "int", "user", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getUserSerialNumber", "(", "final", "int", "group", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getGroupSerialNumber", "(", "int", "n", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getUserSerialNumber", "(", "user", ")", ";", "int", "n", "=", "SerialNumberManager", ".", "INSTANCE", ".", "getGroupSerialNumber", "(", "group", ")", ";", "/", "**", "Manage", "name", "-", "to", "-", "serial", "-", "number", "maps", "for", "users", "and", "groups", ".", "*", "/", "class", "SerialNumberManager", "{", "/", "**", "This", "is", "the", "only", "instance", "of", "{", "@", "link", "SerialNumberManager", "}", ".*", "/", "static", "final", "SerialNumberManager", "INSTANCE", "=", "new", "SerialNumberManager", "(", ");", "private", "final", "SerialNumberMap", "<", "String", ">", "usermap", "=", "new", "SerialNumberMap", "<", "String", ">", "()", ";", "private", "final", "SerialNumberMap", "<", "String", ">", "groupmap", "=", "new", "SerialNumberMap", "<", "String", ">", "()", ";", "private", "SerialNumberManager", "(", ")", "{", "}", "int", "getUserSerialNumber", "(", "String", "u", ")", "{", "return", "usermap", ".", "get", "(", "u", ")", ";}", "int", "getGroupSerialNumber", "(", "String", "g", ")", "{", "return", "groupmap", ".", "get", "(", "g", ")", ";}", "String", "getUser", "(", "int", "n", ")", "{", "return", "usermap", ".", "get", "(", "n", ")", ";}", "String", "getGroup", "(", "int", "n", ")", "{", "return", "groupmap", ".", "get", "(", "n", ")", ";}", "{", "getUserSerialNumber", "(", "null", ")", ";", "getGroupSerialNumber", "(", "null", ")", ";", "private", "final", "AtomicInteger", "max", "=", "new", "AtomicInteger", "(", "1", ")", ";", "sn", "=", "max", ".", "getAndIncrement", "(", ");", "if", "(", "sn", "<", "0", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "Too", "many", "elements", "!", "\")", ";", "throw", "new", "IllegalStateException", "(", "\"!", "i2t", ".", "containsKey", "(", "\"", "+", "i", "+", "\"", "),", "this", "=", "\"", "+", "this", ")", ";", "return", "\"", "max", "=", "\"", "+", "max", "+", "\"", ",\\", "n", "t2i", "=", "\"", "+", "t2i", "+", "\"", ",\\", "n", "i2t", "=", "\"", "+", "i2t", ";", "*", "For", "each", "XAttr", ":", "<", "br", ">", "*", "The", "first", "4", "bytes", "represents", "XAttr", "namespace", "and", "name", "<", "br", ">", "*", "[", "0", ":", "3", ")", "-", "XAttr", "namespace", "<", "br", ">", "*", "[", "3", ":", "8", ")", "-", "Reserved", "<", "br", ">", "*", "[", "8", ":", "32", ")", "-", "The", "name", "of", "the", "entry", ",", "which", "is", "an", "ID", "that", "points", "to", "a", "*", "string", "in", "map", "<", "br", ">", "*", "The", "following", "two", "bytes", "represents", "the", "length", "of", "XAttr", "value", "<", "br", ">", "*", "The", "remaining", "bytes", "is", "the", "XAttr", "value", "<", "br", ">", "class", "XAttrFormat", "{", "private", "enum", "XAttrStatusFormat", "{", "NAMESPACE", "(", "null", ",", "3", ")", ",", "RESERVED", "(", "NAMESPACE", ".", "BITS", ",", "5", ")", ",", "NAME", "(", "RESERVED", ".", "BITS", ",", "24", ")", ";", "private", "final", "LongBitFormat", "BITS", ";", "XAttrStatusFormat", "(", "LongBitFormat", "previous", ",", "int", "length", ")", "{", "BITS", "=", "new", "LongBitFormat", "(", "name", "(", "),", "previous", ",", "length", ",", "0", ")", ";", "}", "static", "XAttr", ".", "NameSpace", "getNamespace", "(", "int", "xattrStatus", ")", "{", "int", "ordinal", "=", "(", "int", ")", "NAMESPACE", ".", "BITS", ".", "retrieve", "(", "xattrStatus", ")", ";", "return", "XAttr", ".", "NameSpace", ".", "values", "(", ")[", "ordinal", "]", ";", "}", "static", "String", "getName", "(", "int", "xattrStatus", ")", "{", "int", "id", "=", "(", "int", ")", "NAME", ".", "BITS", ".", "retrieve", "(", "xattrStatus", ")", ";", "return", "XAttrStorage", ".", "getName", "(", "id", ")", ";", "}", "static", "int", "toInt", "(", "XAttr", ".", "NameSpace", "namespace", ",", "String", "name", ")", "{", "long", "xattrStatusInt", "=", "0", ";", "xattrStatusInt", "=", "NAMESPACE", ".", "BITS", ".", "combine", "(", "namespace", ".", "ordinal", "(", "),", "xattrStatusInt", ")", ";", "int", "nid", "=", "XAttrStorage", ".", "getNameSerialNumber", "(", "name", ")", ";", "xattrStatusInt", "=", "NAME", ".", "BITS", ".", "combine", "(", "nid", ",", "xattrStatusInt", ")", ";", "return", "(", "int", ")", "xattrStatusInt", ";", "}", "private", "static", "final", "int", "XATTR_VALUE_LEN_MAX", "=", "1", "<", "<", "16", ";", "builder", ".", "setNameSpace", "(", "XAttrStatusFormat", ".", "getNamespace", "(", "v", ")", ");", "builder", ".", "setName", "(", "XAttrStatusFormat", ".", "getName", "(", "v", ")", ");", "XAttr", ".", "NameSpace", "namespace", "=", "XAttrStatusFormat", ".", "getNamespace", "(", "v", ")", ";", "String", "name", "=", "XAttrStatusFormat", ".", "getName", "(", "v", ")", ";", "int", "v", "=", "XAttrStatusFormat", ".", "toInt", "(", "a", ".", "getNameSpace", "(", "),", "a", ".", "getName", "(", "))", ";", "private", "static", "final", "SerialNumberMap", "<", "String", ">", "NAME_MAP", "=", "new", "SerialNumberMap", "<", ">(", ");", "public", "static", "int", "getNameSerialNumber", "(", "String", "name", ")", "{", "return", "NAME_MAP", ".", "get", "(", "name", ")", ";", "}", "public", "static", "String", "getName", "(", "int", "n", ")", "{", "return", "NAME_MAP", ".", "get", "(", "n", ")", ";", "}", "private", "final", "String", "[", "]", "stringTable", ";", "private", "FSImageLoader", "(", "String", "[", "]", "stringTable", ",", "byte", "[", "][", "]", "inodes", ",", "Map", "<", "Long", ",", "long", "[", "]>", "dirmap", ")", "{", "String", "[", "]", "stringTable", "=", "null", ";", "static", "String", "[", "]", "loadStringTable", "(", "InputStream", "in", ")", "throws", "IOException", "{", "String", "[", "]", "stringTable", "=", "new", "String", "[", "s", ".", "getNumEntry", "(", ")", "+", "1", "]", ";", "stringTable", "[", "e", ".", "getId", "(", ")]", "=", "e", ".", "getStr", "(", ");", "private", "String", "[", "]", "stringTable", ";", "import", "org", ".", "apache", ".", "hadoop", ".", "hdfs", ".", "server", ".", "namenode", ".", "FsImageProto", ".", "StringTableSection", ";", "private", "String", "[", "]", "stringTable", ";", "o", "(", "SECTION_NAME", ",", "stringTable", "[", "XATTR_NAME_MASK", "&", "(", "encodedName", ">", ">", "XATTR_NAME_OFFSET", ")", "])", ";", "INodeDirectory", "snapshotCopy", "=", "d", ".", "getSnapshotCopy", "(", ");", "if", "(", "snapshotCopy", "!", "=", "null", ")", "{", "dumpINodeDirectory", "(", "snapshotCopy", ")", ";", "StringTableSection", "s", "=", "StringTableSection", ".", "parseDelimitedFrom", "(", "in", ")", ";", "stringTable", "=", "new", "String", "[", "s", ".", "getNumEntry", "(", ")", "+", "1", "]", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "s", ".", "getNumEntry", "(", ");", "+", "+", "i", ")", "{", "StringTableSection", ".", "Entry", "e", "=", "StringTableSection", ".", "Entry", ".", "parseDelimitedFrom", "(", "in", ")", ";", "stringTable", "[", "e", ".", "getId", "(", ")]", "=", "e", ".", "getStr", "(", ");", "}", "INodeDirectory", "mparent", "=", "mock", "(", "INodeDirectory", ".", "class", ")", ";", "INodeDirectory", "parent", "=", "new", "INodeDirectory", "(", "mparent", ".", "getId", "(", "),", "new", "byte", "[", "0", "]", ",", "mparent", ".", "getPermissionStatus", "(", "),", "mparent", ".", "getAccessTime", "(", "))", ";", "parent", ".", "setLocalName", "(", "new", "byte", "[", "0", "]", ");", "file", ".", "setParent", "(", "parent", ")", ";"], "docstring_tokens": ["the", "user/group", "information"]}
{"contents": ["empty"], "code_tokens": ["size_t", "len", ";", "len", "=", "svc_print_xprts", "(", "tmpbuf", ",", "sizeof", "(", "tmpbuf", ")", ");", "return", "simple_read_from_buffer", "(", "buffer", ",", "*", "lenp", ",", "ppos", ",", "tmpbuf", ",", "len", ")", ";</s>int", "len", ";", "if", "(", "write", ")", "return", "-", "EINVAL", ";", "else", "{", "len", "=", "svc_print_xprts", "(", "tmpbuf", ",", "sizeof", "(", "tmpbuf", ")", ");", "if", "(", "!", "access_ok", "(", "VERIFY_WRITE", ",", "buffer", ",", "len", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "__copy_to_user", "(", "buffer", ",", "tmpbuf", ",", "len", ")", ")", "return", "-", "EFAULT", ";", "}", "*", "lenp", "-", "=", "len", ";", "*", "ppos", "+", "=", "len", ";", "return", "0", ";"], "docstring_tokens": ["overflow", "a", "stack-based", "buffer", "and", "have", "unspecified", "other", "impact"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "uri", ".", "getHost", "(", ")", "!", "=", "null", "&", "&", "uri", ".", "getHost", "(", ").", "endsWith", "(", "\".", "example", ".", "com", "\"", "))", "{</s>if", "(", "uri", ".", "getHost", "(", ")", "!", "=", "null", "&", "&", "uri", ".", "getHost", "(", ").", "endsWith", "(", "\"", "example", ".", "com", "\"", "))", "{"], "docstring_tokens": ["circumvent", "the", "access", "control", "."]}
{"contents": ["empty"], "code_tokens": ["if", "(", "s", "-", ">", "method", "-", ">", "version", "=", "=", "TLS1_2_VERSION", "&", "&</s>if", "(", "TLS1_get_version", "(", "s", ")", ">", "=", "TLS1_2_VERSION", "&", "&"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(daemon", "crash", ")"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "err", ")", "return", "-", "EFAULT", ";</s>"], "docstring_tokens": ["obtain", "sensitive", "information", "from", "kernel", "stack", "memory"]}
{"contents": ["empty"], "code_tokens": ["memset", "(", "&", "tread", ",", "0", ",", "sizeof", "(", "tread", ")", ");</s>"], "docstring_tokens": ["obtain", "sensitive", "information", "from", "kernel", "stack", "memory"]}
{"contents": ["empty"], "code_tokens": ["import", "java", ".", "util", ".", "function", ".", "BiFunction", ";", "/", "/", "for", "general", "case", ",", "/", "**", "*", "@", "Deprecated", "due", "to", "potential", "unbounded", "latency", "on", "some", "JRE", "releases", ".", "*", "/", "/", "**", "*", "Extracts", "the", "seconds", "and", "nanoseconds", "component", "of", "{", "@", "code", "seconds", "}", "as", "{", "@", "code", "long", "}", "and", "{", "@", "code", "int", "}", "*", "values", ",", "passing", "them", "to", "the", "given", "converter", ".", "The", "implementation", "avoids", "latency", "issues", "present", "*", "on", "some", "JRE", "releases", ".", "*", "*", "@", "since", "2", ".", "9", ".", "8", "*", "/", "public", "static", "<", "T", ">", "T", "extractSecondsAndNanos", "(", "BigDecimal", "seconds", ",", "BiFunction", "<", "Long", ",", "Integer", ",", "T", ">", "convert", ")", "{", "/", "/", "Complexity", "is", "here", "to", "workaround", "unbounded", "latency", "in", "some", "BigDecimal", "operations", ".", "/", "/", "https", ":", "//", "github", ".", "com", "/", "FasterXML", "/", "jackson", "-", "databind", "/", "issues", "/", "2141", "long", "secondsOnly", ";", "int", "nanosOnly", ";", "BigDecimal", "nanoseconds", "=", "seconds", ".", "scaleByPowerOfTen", "(", "9", ")", ";", "if", "(", "nanoseconds", ".", "precision", "(", ")", "-", "nanoseconds", ".", "scale", "(", ")", "<", "=", "0", ")", "{", "/", "/", "There", "are", "no", "non", "-", "zero", "digits", "to", "the", "left", "of", "the", "decimal", "point", ".", "/", "/", "This", "protects", "against", "very", "negative", "exponents", ".", "secondsOnly", "=", "nanosOnly", "=", "0", ";", "}", "else", "if", "(", "seconds", ".", "scale", "(", ")", "<", "-", "63", ")", "{", "/", "/", "There", "would", "be", "no", "low", "-", "order", "bits", "once", "we", "chop", "to", "a", "long", ".", "/", "/", "This", "protects", "against", "very", "positive", "exponents", ".", "secondsOnly", "=", "nanosOnly", "=", "0", ";", "}", "else", "{", "/", "/", "Now", "we", "know", "that", "seconds", "has", "reasonable", "scale", ",", "we", "can", "safely", "chop", "it", "apart", ".", "secondsOnly", "=", "seconds", ".", "longValue", "(", ");", "nanosOnly", "=", "nanoseconds", ".", "subtract", "(", "new", "BigDecimal", "(", "secondsOnly", ")", ".", "scaleByPowerOfTen", "(", "9", ")", ").", "intValue", "(", ");", "}", "return", "convert", ".", "apply", "(", "secondsOnly", ",", "nanosOnly", ")", ";", "}", "return", "DecimalUtils", ".", "extractSecondsAndNanos", "(", "value", ",", "Duration", ":", ":", "ofSeconds", ")", ";", "FromDecimalArguments", "args", "=", "DecimalUtils", ".", "extractSecondsAndNanos", "(", "value", ",", "(", "s", ",", "ns", ")", "-", ">", "new", "FromDecimalArguments", "(", "s", ",", "ns", ",", "getZone", "(", "context", ")", "))", ";", "return", "fromNanoseconds", ".", "apply", "(", "args", ")", ";", "private", "void", "checkExtractSecondsAndNanos", "(", "long", "expectedSeconds", ",", "int", "expectedNanos", ",", "BigDecimal", "decimal", ")", "{", "DecimalUtils", ".", "extractSecondsAndNanos", "(", "decimal", ",", "(", "Long", "s", ",", "Integer", "ns", ")", "-", ">", "{", "assertEquals", "(", "\"", "The", "second", "part", "is", "not", "correct", ".", "\",", "expectedSeconds", ",", "s", ".", "longValue", "(", "))", ";", "assertEquals", "(", "\"", "The", "nanosecond", "part", "is", "not", "correct", ".", "\",", "expectedNanos", ",", "ns", ".", "intValue", "(", "))", ";", "return", "null", ";", "}", ");", "}", "@", "Test", "public", "void", "testExtractSecondsAndNanos01", "(", ")", "{", "BigDecimal", "value", "=", "new", "BigDecimal", "(", "\"", "0", "\"", ");", "checkExtractSecondsAndNanos", "(", "0L", ",", "0", ",", "value", ")", ";", "}", "@", "Test", "public", "void", "testExtractSecondsAndNanos02", "(", ")", "{", "BigDecimal", "value", "=", "new", "BigDecimal", "(", "\"", "15", ".", "000000072", "\"", ");", "checkExtractSecondsAndNanos", "(", "15L", ",", "72", ",", "value", ")", ";", "}", "@", "Test", "public", "void", "testExtractSecondsAndNanos03", "(", ")", "{", "BigDecimal", "value", "=", "new", "BigDecimal", "(", "\"", "15", ".", "72", "\"", ");", "checkExtractSecondsAndNanos", "(", "15L", ",", "720000000", ",", "value", ")", ";", "}", "@", "Test", "public", "void", "testExtractSecondsAndNanos04", "(", ")", "{", "BigDecimal", "value", "=", "new", "BigDecimal", "(", "\"", "19827342231", ".", "192837465", "\"", ");", "checkExtractSecondsAndNanos", "(", "19827342231L", ",", "192837465", ",", "value", ")", ";", "}", "@", "Test", "public", "void", "testExtractSecondsAndNanos05", "(", ")", "{", "BigDecimal", "value", "=", "new", "BigDecimal", "(", "\"", "19827342231", "\"", ");", "checkExtractSecondsAndNanos", "(", "19827342231L", ",", "0", ",", "value", ")", ";", "}", "@", "Test", "public", "void", "testExtractSecondsAndNanos06", "(", ")", "{", "BigDecimal", "value", "=", "new", "BigDecimal", "(", "\"", "19827342231", ".", "999999999", "\"", ");", "checkExtractSecondsAndNanos", "(", "19827342231L", ",", "999999999", ",", "value", ")", ";", "}", "@", "Test", "(", "timeout", "=", "100", ")", "public", "void", "testExtractSecondsAndNanos07", "(", ")", "{", "BigDecimal", "value", "=", "new", "BigDecimal", "(", "\"", "1e10000000", "\"", ");", "checkExtractSecondsAndNanos", "(", "0L", ",", "0", ",", "value", ")", ";", "}", "@", "Test", "(", "timeout", "=", "100", ")", "@", "Test", "(", "timeout", "=", "100", ")", "@", "Test", "(", "timeout", "=", "100", ")", "@", "Test", "(", "timeout", "=", "100", ")", "@", "Test", "(", "timeout", "=", "100", ")", "@", "Test", "(", "timeout", "=", "100", ")", "@", "Test", "(", "timeout", "=", "100", ")", "@", "Test", "(", "timeout", "=", "100", ")</s>/", "/", "for", "general", "case", ",", "long", "seconds", "=", "value", ".", "longValue", "(", ");", "int", "nanoseconds", "=", "DecimalUtils", ".", "extractNanosecondDecimal", "(", "value", ",", "seconds", ")", ";", "return", "Duration", ".", "ofSeconds", "(", "seconds", ",", "nanoseconds", ")", ";", "long", "seconds", "=", "value", ".", "longValue", "(", ");", "int", "nanoseconds", "=", "DecimalUtils", ".", "extractNanosecondDecimal", "(", "value", ",", "seconds", ")", ";", "return", "fromNanoseconds", ".", "apply", "(", "new", "FromDecimalArguments", "(", "seconds", ",", "nanoseconds", ",", "getZone", "(", "context", ")", "))", ";", "@", "Test", "@", "Test", "@", "Test", "@", "Test", "@", "Test", "@", "Test", "@", "Test", "@", "Test"], "docstring_tokens": ["the", "application", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "Set", ";", "private", "static", "final", "Set", "<", "String", ">", "components", "=", "new", "HashSet", "<", ">(", ");", "static", "{", "components", ".", "add", "(", "\"", "java", ".", "util", ".", "TreeMap", "\"", ");", "components", ".", "add", "(", "\"", "java", ".", "lang", ".", "Integer", "\"", ");", "components", ".", "add", "(", "\"", "java", ".", "lang", ".", "Number", "\"", ");", "components", ".", "add", "(", "\"", "org", ".", "bouncycastle", ".", "pqc", ".", "crypto", ".", "xmss", ".", "BDS", "\"", ");", "components", ".", "add", "(", "\"", "java", ".", "util", ".", "ArrayList", "\"", ");", "components", ".", "add", "(", "\"", "org", ".", "bouncycastle", ".", "pqc", ".", "crypto", ".", "xmss", ".", "XMSSNode", "\"", ");", "components", ".", "add", "(", "\"[", "B", "\"", ");", "components", ".", "add", "(", "\"", "java", ".", "util", ".", "LinkedList", "\"", ");", "components", ".", "add", "(", "\"", "java", ".", "util", ".", "Stack", "\"", ");", "components", ".", "add", "(", "\"", "java", ".", "util", ".", "Vector", "\"", ");", "components", ".", "add", "(", "\"[", "Ljava", ".", "lang", ".", "Object", ";", "\")", ";", "components", ".", "add", "(", "\"", "org", ".", "bouncycastle", ".", "pqc", ".", "crypto", ".", "xmss", ".", "BDSTreeHash", "\"", ");", "}", "else", "{", "if", "(", "!", "components", ".", "contains", "(", "desc", ".", "getName", "(", "))", ")", "{", "throw", "new", "InvalidClassException", "(", "\"", "unexpected", "class", ":", "\"", ",", "desc", ".", "getName", "(", "))", ";", "}", "}</s>"], "docstring_tokens": ["execute", "arbitrary", "code", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["import", "java", ".", "nio", ".", "file", ".", "Path", ";", "import", "org", ".", "apache", ".", "felix", ".", "gogo", ".", "runtime", ".", "CommandSessionImpl", ";", "commandProcessor", "=", "new", "CommandProcessorImpl", "(", "threadIO", ")", "{", "@", "Override", "public", "Object", "invoke", "(", "CommandSessionImpl", "session", ",", "Object", "target", ",", "String", "name", ",", "List", "<", "Object", ">", "args", ")", "throws", "Exception", "{", "return", "SessionFactoryImpl", ".", "this", ".", "invoke", "(", "session", ",", "target", ",", "name", ",", "args", ")", ";", "}", "@", "Override", "public", "Path", "redirect", "(", "CommandSessionImpl", "session", ",", "Path", "path", ",", "int", "mode", ")", "{", "return", "SessionFactoryImpl", ".", "this", ".", "redirect", "(", "session", ",", "path", ",", "mode", ")", ";", "}", "}", ";", "protected", "Object", "invoke", "(", "CommandSessionImpl", "session", ",", "Object", "target", ",", "String", "name", ",", "List", "<", "Object", ">", "args", ")", "throws", "Exception", "{", "return", "Reflective", ".", "invoke", "(", "session", ",", "target", ",", "name", ",", "args", ")", ";", "}", "protected", "Path", "redirect", "(", "CommandSessionImpl", "session", ",", "Path", "path", ",", "int", "mode", ")", "{", "return", "session", ".", "currentDir", "(", ").", "resolve", "(", "path", ")", ";", "}", "factory", ".", "checkSecurity", "(", "getScope", "(", "),", "getName", "(", "),", "arguments", ")", ";", "import", "java", ".", "nio", ".", "file", ".", "Path", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "org", ".", "apache", ".", "felix", ".", "gogo", ".", "runtime", ".", "CommandSessionImpl", ";", "private", "static", "final", "String", "CONFIGURATION_FILTER", "=", "\"", "(\"", "+", "Constants", ".", "SERVICE_PID", "+", "\"", "=\"", "+", "PROXY_COMMAND_ACL_PID_PREFIX", "+", "\"", "*)", "\";", "private", "static", "final", "String", "SHELL_SCOPE", "=", "\"", "shell", "\"", ";", "private", "static", "final", "String", "SHELL_INVOKE", "=", "\"", ".", "invoke", "\"", ";", "private", "static", "final", "String", "SHELL_REDIRECT", "=", "\"", ".", "redirect", "\"", ";", "@", "Override", "protected", "Object", "invoke", "(", "CommandSessionImpl", "session", ",", "Object", "target", ",", "String", "name", ",", "List", "<", "Object", ">", "args", ")", "throws", "Exception", "{", "checkSecurity", "(", "SHELL_SCOPE", ",", "SHELL_INVOKE", ",", "Arrays", ".", "asList", "(", "target", ",", "name", ",", "args", ")", ");", "return", "super", ".", "invoke", "(", "session", ",", "target", ",", "name", ",", "args", ")", ";", "}", "@", "Override", "protected", "Path", "redirect", "(", "CommandSessionImpl", "session", ",", "Path", "path", ",", "int", "mode", ")", "{", "checkSecurity", "(", "SHELL_SCOPE", ",", "SHELL_REDIRECT", ",", "Arrays", ".", "asList", "(", "path", ",", "mode", ")", ");", "return", "super", ".", "redirect", "(", "session", ",", "path", ",", "mode", ")", ";", "}", "Command", "cmd", "=", "(", "Command", ")", "service", ";", "return", "isVisible", "(", "cmd", ".", "getScope", "(", "),", "cmd", ".", "getName", "(", "))", ";", "protected", "boolean", "isVisible", "(", "String", "scope", ",", "String", "name", ")", "{", "Dictionary", "<", "String", ",", "Object", ">", "config", "=", "getScopeConfig", "(", "scope", ")", ";", "ACLConfigurationParser", ".", "getRolesForInvocation", "(", "name", ",", "null", ",", "null", ",", "config", ",", "roles", ")", ";", "void", "checkSecurity", "(", "String", "scope", ",", "String", "name", ",", "List", "<", "Object", ">", "arguments", ")", "{", "Dictionary", "<", "String", ",", "Object", ">", "config", "=", "getScopeConfig", "(", "scope", ")", ";", "if", "(", "!", "isVisible", "(", "scope", ",", "name", ")", ")", "{", "throw", "new", "CommandNotFoundException", "(", "scope", "+", "\"", ":\"", "+", "name", ")", ";", "ACLConfigurationParser", ".", "Specificity", "s", "=", "ACLConfigurationParser", ".", "getRolesForInvocation", "(", "name", ",", "new", "Object", "[", "]", "{", "arguments", ".", "toString", "(", ")", "}", ",", "null", ",", "config", ",", "roles", ")", ";</s>commandProcessor", "=", "new", "CommandProcessorImpl", "(", "threadIO", ")", ";", "factory", ".", "checkSecurity", "(", "this", ",", "session", ",", "arguments", ")", ";", "import", "org", ".", "apache", ".", "karaf", ".", "shell", ".", "api", ".", "console", ".", "Session", ";", "private", "static", "final", "String", "CONFIGURATION_FILTER", "=", "\"", "(\"", "+", "Constants", ".", "SERVICE_PID", "+", "\"", "=\"", "+", "PROXY_COMMAND_ACL_PID_PREFIX", "+", "\"", "*)", "\";", "return", "isVisible", "(", "(", "Command", ")", "service", ")", ";", "protected", "boolean", "isVisible", "(", "Command", "command", ")", "{", "Dictionary", "<", "String", ",", "Object", ">", "config", "=", "getScopeConfig", "(", "command", ".", "getScope", "(", "))", ";", "ACLConfigurationParser", ".", "getRolesForInvocation", "(", "command", ".", "getName", "(", "),", "null", ",", "null", ",", "config", ",", "roles", ")", ";", "void", "checkSecurity", "(", "SecuredCommand", "command", ",", "Session", "session", ",", "List", "<", "Object", ">", "arguments", ")", "{", "Dictionary", "<", "String", ",", "Object", ">", "config", "=", "getScopeConfig", "(", "command", ".", "getScope", "(", "))", ";", "if", "(", "!", "isVisible", "(", "command", ")", ")", "{", "throw", "new", "CommandNotFoundException", "(", "command", ".", "getScope", "(", ")", "+", "\"", ":\"", "+", "command", ".", "getName", "(", "))", ";", "ACLConfigurationParser", ".", "Specificity", "s", "=", "ACLConfigurationParser", ".", "getRolesForInvocation", "(", "command", ".", "getName", "(", "),", "new", "Object", "[", "]", "{", "arguments", ".", "toString", "(", ")", "}", ",", "null", ",", "config", ",", "roles", ")", ";"], "docstring_tokens": ["read", "and", "write", "a", "large", "number", "of", "files", "as", "the", "Karaf", "process", "user"]}
{"contents": ["empty"], "code_tokens": ["length", "=", "GetStringInfoLength", "(", "profile", ")", ";", "if", "(", "length", ">", "65533L", ")", "{", "(", "void", ")", "ThrowMagickException", "(", "&", "image", "-", ">", "exception", ",", "GetMagickModule", "(", "),", "CoderWarning", ",", "\"", "ExifProfileSizeExceedsLimit", "\"", ",", "image", "-", ">", "filename", ")", ";", "length", "=", "65533L", ";", "}", "jpeg_write_marker", "(", "jpeg_info", ",", "XML_MARKER", ",", "GetStringInfoDatum", "(", "profile", ")", ",", "<", "message", "name", "=", "\"", "ExifProfileSizeExceedsLimit", "\"", ">", "exif", "profile", "size", "exceeds", "limit", "and", "will", "be", "truncated", "<", "/", "message", "></s>for", "(", "i", "=", "0", ";", "i", "<", "(", "ssize_t", ")", "GetStringInfoLength", "(", "profile", ")", ";", "i", "+", "=", "65533L", ")", "length", "=", "MagickMin", "(", "GetStringInfoLength", "(", "profile", ")", "-", "i", ",", "65533L", ")", ";", "jpeg_write_marker", "(", "jpeg_info", ",", "XML_MARKER", ",", "GetStringInfoDatum", "(", "profile", ")", "+", "i", ","], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(application", "crash", ")", "or", "have", "other", "unspecified", "impact"]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "keycloak", ".", "validation", ".", "ValidationUtil", ";", "ValidationUtil", ".", "validateClient", "(", "session", ",", "app", ",", "false", ",", "r", "-", ">", "{", "throw", "new", "RuntimeException", "(", "\"", "Invalid", "client", "\"", "+", "app", ".", "getClientId", "(", ")", "+", "\"", ":", "\"", "+", "r", ".", "getAllErrorsAsString", "(", "))", ";", "*", "Copyright", "2020", "Red", "Hat", ",", "Inc", ".", "and", "/", "or", "its", "affiliates", "import", "org", ".", "keycloak", ".", "representations", ".", "oidc", ".", "OIDCClientRepresentation", ";", "/", "**", "*", "@", "author", "Vaclav", "Muzikar", "<", "vmuzikar", "@", "redhat", ".", "com", ">", "*", "/", "public", "class", "ClientValidationContext", "extends", "DefaultValidationContext", "<", "ClientModel", ">", "{", "public", "ClientValidationContext", "(", "Event", "event", ",", "KeycloakSession", "session", ",", "ClientModel", "objectToValidate", ")", "{", "super", "(", "event", ",", "session", ",", "objectToValidate", ")", ";", "public", "static", "class", "OIDCContext", "extends", "ClientValidationContext", "{", "private", "final", "OIDCClientRepresentation", "oidcClient", ";", "public", "OIDCContext", "(", "Event", "event", ",", "KeycloakSession", "session", ",", "ClientModel", "objectToValidate", ",", "OIDCClientRepresentation", "oidcClient", ")", "{", "super", "(", "event", ",", "session", ",", "objectToValidate", ")", ";", "this", ".", "oidcClient", "=", "oidcClient", ";", "}", "public", "OIDCClientRepresentation", "getOIDCClient", "(", ")", "{", "return", "oidcClient", ";", "}", "}", "import", "org", ".", "keycloak", ".", "models", ".", "ClientModel", ";", "public", "interface", "ClientValidationProvider", "extends", "Validator", "<", "ClientModel", ">", "{", "/", "/", "for", "a", "special", "case", "when", "performing", "OIDC", "client", "registration", "ValidationResult", "validate", "(", "ClientValidationContext", ".", "OIDCContext", "validationContext", ")", ";", "/", "*", "*", "Copyright", "2020", "Red", "Hat", ",", "Inc", ".", "and", "/", "or", "its", "affiliates", "*", "and", "other", "contributors", "as", "indicated", "by", "the", "@", "author", "tags", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "keycloak", ".", "validation", ";", "import", "org", ".", "keycloak", ".", "models", ".", "KeycloakSession", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "Set", ";", "/", "**", "*", "@", "author", "Vaclav", "Muzikar", "<", "vmuzikar", "@", "redhat", ".", "com", ">", "*", "/", "public", "abstract", "class", "DefaultValidationContext", "<", "T", ">", "implements", "ValidationContext", "<", "T", ">", "{", "private", "final", "Event", "event", ";", "private", "final", "KeycloakSession", "session", ";", "private", "final", "T", "objectToValidate", ";", "private", "final", "Set", "<", "ValidationError", ">", "errors", ";", "public", "DefaultValidationContext", "(", "Event", "event", ",", "KeycloakSession", "session", ",", "T", "objectToValidate", ")", "{", "this", ".", "event", "=", "event", ";", "this", ".", "session", "=", "session", ";", "this", ".", "objectToValidate", "=", "objectToValidate", ";", "this", ".", "errors", "=", "new", "HashSet", "<", ">(", ");", "}", "@", "Override", "public", "Event", "getEvent", "(", ")", "{", "return", "event", ";", "}", "@", "Override", "public", "KeycloakSession", "getSession", "(", ")", "{", "return", "session", ";", "}", "@", "Override", "public", "T", "getObjectToValidate", "(", ")", "{", "return", "objectToValidate", ";", "}", "@", "Override", "public", "ValidationContext", "<", "T", ">", "addError", "(", "String", "message", ")", "{", "return", "addError", "(", "null", ",", "message", ",", "null", ")", ";", "}", "@", "Override", "public", "ValidationContext", "<", "T", ">", "addError", "(", "String", "fieldId", ",", "String", "message", ")", "{", "return", "addError", "(", "fieldId", ",", "message", ",", "null", ")", ";", "}", "@", "Override", "public", "ValidationContext", "<", "T", ">", "addError", "(", "String", "fieldId", ",", "String", "message", ",", "String", "localizedMessageKey", ",", "Object", ".", "..", "localizedMessageParams", ")", "{", "errors", ".", "add", "(", "new", "ValidationError", "(", "fieldId", ",", "message", ",", "localizedMessageKey", ",", "localizedMessageParams", ")", ");", "return", "this", ";", "}", "@", "Override", "public", "ValidationResult", "toResult", "(", ")", "{", "return", "new", "ValidationResult", "(", "new", "HashSet", "<", ">(", "errors", ")", ");", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "39", "@", "@", "/", "*", "*", "Copyright", "2019", "Red", "Hat", ",", "Inc", ".", "and", "/", "or", "its", "affiliates", "*", "and", "other", "contributors", "as", "indicated", "by", "the", "@", "author", "tags", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "keycloak", ".", "validation", ";", "import", "org", ".", "keycloak", ".", "models", ".", "KeycloakSession", ";", "public", "interface", "ValidationContext", "<", "T", ">", "{", "enum", "Event", "{", "CREATE", ",", "UPDATE", "}", "Event", "getEvent", "(", ");", "KeycloakSession", "getSession", "(", ");", "T", "getObjectToValidate", "(", ");", "ValidationContext", "<", "T", ">", "addError", "(", "String", "message", ")", ";", "ValidationContext", "<", "T", ">", "addError", "(", "String", "fieldId", ",", "String", "message", ")", ";", "ValidationContext", "<", "T", ">", "addError", "(", "String", "fieldId", ",", "String", "message", ",", "String", "localizedMessageKey", ",", "Object", ".", "..", "localizedMessageParams", ")", ";", "ValidationResult", "toResult", "(", ");", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "87", "@", "@", "/", "*", "*", "Copyright", "2020", "Red", "Hat", ",", "Inc", ".", "and", "/", "or", "its", "affiliates", "*", "and", "other", "contributors", "as", "indicated", "by", "the", "@", "author", "tags", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "keycloak", ".", "validation", ";", "import", "java", ".", "text", ".", "MessageFormat", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Objects", ";", "import", "java", ".", "util", ".", "Properties", ";", "/", "**", "*", "@", "author", "Vaclav", "Muzikar", "<", "vmuzikar", "@", "redhat", ".", "com", ">", "*", "/", "public", "class", "ValidationError", "{", "private", "final", "String", "fieldId", ";", "private", "final", "String", "message", ";", "private", "final", "String", "localizedMessageKey", ";", "private", "final", "Object", "[", "]", "localizedMessageParameters", ";", "public", "ValidationError", "(", "String", "fieldId", ",", "String", "message", ",", "String", "localizedMessageKey", ",", "Object", "[", "]", "localizedMessageParameters", ")", "{", "if", "(", "message", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "Message", "must", "be", "set", "\"", ");", "}", "this", ".", "fieldId", "=", "fieldId", ";", "this", ".", "message", "=", "message", ";", "this", ".", "localizedMessageKey", "=", "localizedMessageKey", ";", "this", ".", "localizedMessageParameters", "=", "localizedMessageParameters", ";", "}", "public", "String", "getFieldId", "(", ")", "{", "return", "fieldId", ";", "}", "public", "String", "getLocalizedMessageKey", "(", ")", "{", "return", "localizedMessageKey", ";", "}", "public", "Object", "[", "]", "getLocalizedMessageParams", "(", ")", "{", "return", "localizedMessageParameters", ";", "}", "public", "String", "getMessage", "(", ")", "{", "return", "message", ";", "}", "public", "String", "getLocalizedMessage", "(", "Properties", "messagesBundle", ")", "{", "if", "(", "getLocalizedMessageKey", "(", ")", "!", "=", "null", ")", "{", "return", "MessageFormat", ".", "format", "(", "messagesBundle", ".", "getProperty", "(", "getLocalizedMessageKey", "(", "),", "getMessage", "(", "))", ",", "getLocalizedMessageParams", "(", "))", ";", "}", "else", "{", "return", "getMessage", "(", ");", "}", "}", "@", "Override", "public", "boolean", "equals", "(", "Object", "o", ")", "{", "if", "(", "this", "=", "=", "o", ")", "return", "true", ";", "if", "(", "o", "=", "=", "null", "|", "|", "getClass", "(", ")", "!", "=", "o", ".", "getClass", "(", "))", "return", "false", ";", "ValidationError", "error", "=", "(", "ValidationError", ")", "o", ";", "return", "Objects", ".", "equals", "(", "fieldId", ",", "error", ".", "fieldId", ")", "&", "&", "message", ".", "equals", "(", "error", ".", "message", ")", "&", "&", "Objects", ".", "equals", "(", "localizedMessageKey", ",", "error", ".", "localizedMessageKey", ")", "&", "&", "Arrays", ".", "equals", "(", "localizedMessageParameters", ",", "error", ".", "localizedMessageParameters", ")", ";", "}", "@", "Override", "public", "int", "hashCode", "(", ")", "{", "int", "result", "=", "Objects", ".", "hash", "(", "fieldId", ",", "message", ",", "localizedMessageKey", ")", ";", "result", "=", "31", "*", "result", "+", "Arrays", ".", "hashCode", "(", "localizedMessageParameters", ")", ";", "return", "result", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "69", "@", "@", "/", "*", "*", "Copyright", "2020", "Red", "Hat", ",", "Inc", ".", "and", "/", "or", "its", "affiliates", "*", "and", "other", "contributors", "as", "indicated", "by", "the", "@", "author", "tags", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "keycloak", ".", "validation", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Properties", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "function", ".", "Function", ";", "import", "java", ".", "util", ".", "stream", ".", "Collectors", ";", "/", "**", "*", "@", "author", "Vaclav", "Muzikar", "<", "vmuzikar", "@", "redhat", ".", "com", ">", "*", "/", "public", "class", "ValidationResult", "{", "private", "final", "boolean", "valid", ";", "private", "final", "Set", "<", "ValidationError", ">", "errors", ";", "public", "ValidationResult", "(", "Set", "<", "ValidationError", ">", "errors", ")", "{", "this", ".", "valid", "=", "errors", ".", "size", "(", ")", "=", "=", "0", ";", "this", ".", "errors", "=", "Collections", ".", "unmodifiableSet", "(", "errors", ")", ";", "}", "public", "boolean", "isValid", "(", ")", "{", "return", "valid", ";", "}", "public", "Set", "<", "ValidationError", ">", "getErrors", "(", ")", "{", "return", "errors", ";", "}", "public", "String", "getAllErrorsAsString", "(", ")", "{", "return", "getAllErrorsAsString", "(", "ValidationError", ":", ":", "getMessage", ")", ";", "}", "public", "String", "getAllLocalizedErrorsAsString", "(", "Properties", "messagesBundle", ")", "{", "return", "getAllErrorsAsString", "(", "x", "-", ">", "x", ".", "getLocalizedMessage", "(", "messagesBundle", ")", ");", "}", "protected", "String", "getAllErrorsAsString", "(", "Function", "<", "ValidationError", ",", "String", ">", "function", ")", "{", "return", "errors", ".", "stream", "(", ").", "map", "(", "function", ")", ".", "collect", "(", "Collectors", ".", "joining", "(", "\";", "\"", "))", ";", "}", "public", "boolean", "fieldHasError", "(", "String", "fieldId", ")", "{", "if", "(", "fieldId", "=", "=", "null", ")", "{", "return", "false", ";", "}", "for", "(", "ValidationError", "error", ":", "errors", ")", "{", "if", "(", "fieldId", ".", "equals", "(", "error", ".", "getFieldId", "(", "))", ")", "{", "return", "true", ";", "}", "}", "return", "false", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "56", "@", "@", "/", "*", "*", "Copyright", "2019", "Red", "Hat", ",", "Inc", ".", "and", "/", "or", "its", "affiliates", "*", "and", "other", "contributors", "as", "indicated", "by", "the", "@", "author", "tags", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "keycloak", ".", "validation", ";", "import", "org", ".", "keycloak", ".", "models", ".", "ClientModel", ";", "import", "org", ".", "keycloak", ".", "models", ".", "KeycloakSession", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "oidc", ".", "OIDCClientRepresentation", ";", "import", "javax", ".", "ws", ".", "rs", ".", "BadRequestException", ";", "public", "class", "ValidationUtil", "{", "public", "static", "void", "validateClient", "(", "KeycloakSession", "session", ",", "ClientModel", "client", ",", "boolean", "create", ",", "ErrorHandler", "errorHandler", ")", "throws", "BadRequestException", "{", "validateClient", "(", "session", ",", "client", ",", "null", ",", "create", ",", "errorHandler", ")", ";", "}", "public", "static", "void", "validateClient", "(", "KeycloakSession", "session", ",", "ClientModel", "client", ",", "OIDCClientRepresentation", "oidcClient", ",", "boolean", "create", ",", "ErrorHandler", "errorHandler", ")", "throws", "BadRequestException", "{", "ClientValidationProvider", "provider", "=", "session", ".", "getProvider", "(", "ClientValidationProvider", ".", "class", ")", ";", "if", "(", "provider", "!", "=", "null", ")", "{", "ValidationContext", ".", "Event", "event", "=", "create", "?", "ValidationContext", ".", "Event", ".", "CREATE", ":", "ValidationContext", ".", "Event", ".", "UPDATE", ";", "ValidationResult", "result", ";", "if", "(", "oidcClient", "!", "=", "null", ")", "{", "result", "=", "provider", ".", "validate", "(", "new", "ClientValidationContext", ".", "OIDCContext", "(", "event", ",", "session", ",", "client", ",", "oidcClient", ")", ");", "}", "else", "{", "result", "=", "provider", ".", "validate", "(", "new", "ClientValidationContext", "(", "event", ",", "session", ",", "client", ")", ");", "}", "if", "(", "!", "result", ".", "isValid", "(", "))", "{", "errorHandler", ".", "onError", "(", "result", ")", ";", "}", "}", "}", "public", "interface", "ErrorHandler", "{", "void", "onError", "(", "ValidationResult", "context", ")", ";", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "27", "@", "@", "/", "*", "*", "Copyright", "2020", "Red", "Hat", ",", "Inc", ".", "and", "/", "or", "its", "affiliates", "*", "and", "other", "contributors", "as", "indicated", "by", "the", "@", "author", "tags", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "keycloak", ".", "validation", ";", "import", "org", ".", "keycloak", ".", "provider", ".", "Provider", ";", "/", "**", "*", "@", "author", "Vaclav", "Muzikar", "<", "vmuzikar", "@", "redhat", ".", "com", ">", "*", "/", "public", "interface", "Validator", "<", "T", ">", "extends", "Provider", "{", "ValidationResult", "validate", "(", "ValidationContext", "<", "T", ">", "validationContext", ")", ";", "}", "@", "@", "-", "46", ",", "6", "+", "46", ",", "7", "@", "@", "public", "Response", "createSaml", "(", "String", "descriptor", ")", "{", "validateClient", "(", "client", ",", "true", ")", ";", "import", "org", ".", "keycloak", ".", "models", ".", "ClientInitialAccessModel", ";", "import", "org", ".", "keycloak", ".", "models", ".", "ClientModel", ";", "import", "org", ".", "keycloak", ".", "models", ".", "KeycloakSession", ";", "import", "org", ".", "keycloak", ".", "models", ".", "ModelDuplicateException", ";", "import", "org", ".", "keycloak", ".", "models", ".", "RealmModel", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "oidc", ".", "OIDCClientRepresentation", ";", "import", "org", ".", "keycloak", ".", "validation", ".", "ValidationUtil", ";", "public", "void", "validateClient", "(", "ClientModel", "clientModel", ",", "OIDCClientRepresentation", "oidcClient", ",", "boolean", "create", ")", "{", "ValidationUtil", ".", "validateClient", "(", "session", ",", "clientModel", ",", "oidcClient", ",", "create", ",", "r", "-", ">", "{", "session", ".", "getTransactionManager", "(", ").", "setRollbackOnly", "(", ");", "String", "errorCode", "=", "r", ".", "fieldHasError", "(", "\"", "redirectUris", "\"", ")", "?", "ErrorCodes", ".", "INVALID_REDIRECT_URI", ":", "ErrorCodes", ".", "INVALID_CLIENT_METADATA", ";", "throw", "new", "ErrorResponseException", "(", "errorCode", ",", "r", ".", "getAllErrorsAsString", "(", "),", "Response", ".", "Status", ".", "BAD_REQUEST", ")", ";", "}", ");", "}", "public", "void", "validateClient", "(", "ClientRepresentation", "clientRep", ",", "boolean", "create", ")", "{", "validateClient", "(", "session", ".", "getContext", "(", ").", "getRealm", "(", ").", "getClientByClientId", "(", "clientRep", ".", "getClientId", "(", "))", ",", "null", ",", "create", ")", ";", "}", "validateClient", "(", "client", ",", "true", ")", ";", "validateClient", "(", "client", ",", "false", ")", ";", "validateClient", "(", "clientModel", ",", "clientOIDC", ",", "true", ")", ";", "validateClient", "(", "clientModel", ",", "clientOIDC", ",", "false", ")", ";", "import", "org", ".", "keycloak", ".", "utils", ".", "ReservedCharValidator", ";", "import", "org", ".", "keycloak", ".", "validation", ".", "ValidationUtil", ";", "ValidationUtil", ".", "validateClient", "(", "session", ",", "client", ",", "false", ",", "r", "-", ">", "{", "throw", "new", "ErrorResponseException", "(", "Errors", ".", "INVALID_INPUT", ",", "r", ".", "getAllLocalizedErrorsAsString", "(", "AdminRoot", ".", "getMessages", "(", "session", ",", "realm", ",", "auth", ".", "adminAuth", "(", ").", "getToken", "(", ").", "getLocale", "(", "))", "),", "Response", ".", "Status", ".", "BAD_REQUEST", ")", ";", "import", "org", ".", "keycloak", ".", "validation", ".", "ValidationUtil", ";", "ValidationUtil", ".", "validateClient", "(", "session", ",", "clientModel", ",", "true", ",", "r", "-", ">", "{", "throw", "new", "ErrorResponseException", "(", "Errors", ".", "INVALID_INPUT", ",", "r", ".", "getAllLocalizedErrorsAsString", "(", "AdminRoot", ".", "getMessages", "(", "session", ",", "realm", ",", "auth", ".", "adminAuth", "(", ").", "getToken", "(", ").", "getLocale", "(", "))", "),", "Response", ".", "Status", ".", "BAD_REQUEST", ")", ";", "import", "org", ".", "keycloak", ".", "protocol", ".", "ProtocolMapperConfigException", ";", "import", "org", ".", "keycloak", ".", "protocol", ".", "oidc", ".", "mappers", ".", "PairwiseSubMapperHelper", ";", "import", "org", ".", "keycloak", ".", "protocol", ".", "oidc", ".", "utils", ".", "PairwiseSubMapperUtils", ";", "import", "org", ".", "keycloak", ".", "protocol", ".", "oidc", ".", "utils", ".", "PairwiseSubMapperValidator", ";", "import", "org", ".", "keycloak", ".", "protocol", ".", "oidc", ".", "utils", ".", "SubjectType", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "ProtocolMapperRepresentation", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "oidc", ".", "OIDCClientRepresentation", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "static", "org", ".", "keycloak", ".", "models", ".", "utils", ".", "ModelToRepresentation", ".", "toRepresentation", ";", "private", "enum", "FieldMessages", "{", "ROOT_URL", "(", "\"", "rootUrl", "\"", ",", "\"", "Root", "URL", "is", "not", "a", "valid", "URL", "\"", ",", "\"", "clientRootURLInvalid", "\"", ",", "\"", "Root", "URL", "must", "not", "contain", "an", "URL", "fragment", "\"", ",", "\"", "clientRootURLFragmentError", "\"", ",", "\"", "Root", "URL", "uses", "an", "illegal", "scheme", "\"", ",", "\"", "clientRootURLIllegalSchemeError", "\"", "),", "BASE_URL", "(", "\"", "baseUrl", "\"", ",", "\"", "Base", "URL", "is", "not", "a", "valid", "URL", "\"", ",", "\"", "clientBaseURLInvalid", "\"", ",", "null", ",", "null", ",", "\"", "Base", "URL", "uses", "an", "illegal", "scheme", "\"", ",", "\"", "clientBaseURLIllegalSchemeError", "\"", "),", "REDIRECT_URIS", "(", "\"", "redirectUris", "\"", ",", "\"", "A", "redirect", "URI", "is", "not", "a", "valid", "URI", "\"", ",", "\"", "clientRedirectURIsInvalid", "\"", ",", "\"", "Redirect", "URIs", "must", "not", "contain", "an", "URI", "fragment", "\"", ",", "\"", "clientRedirectURIsFragmentError", "\"", ",", "\"", "A", "redirect", "URI", "uses", "an", "illegal", "scheme", "\"", ",", "\"", "clientRedirectURIsIllegalSchemeError", "\"", ");", "private", "String", "fieldId", ";", "private", "String", "invalid", ";", "private", "String", "invalidKey", ";", "private", "String", "fragment", ";", "private", "String", "fragmentKey", ";", "private", "String", "scheme", ";", "private", "String", "schemeKey", ";", "FieldMessages", "(", "String", "fieldId", ",", "String", "invalid", ",", "String", "invalidKey", ",", "String", "fragment", ",", "String", "fragmentKey", ",", "String", "scheme", ",", "String", "schemeKey", ")", "{", "this", ".", "fieldId", "=", "fieldId", ";", "this", ".", "invalid", "=", "invalid", ";", "this", ".", "invalidKey", "=", "invalidKey", ";", "this", ".", "fragment", "=", "fragment", ";", "this", ".", "fragmentKey", "=", "fragmentKey", ";", "this", ".", "scheme", "=", "scheme", ";", "this", ".", "schemeKey", "=", "schemeKey", ";", "}", "public", "String", "getFieldId", "(", ")", "{", "return", "fieldId", ";", "}", "public", "String", "getInvalid", "(", ")", "{", "return", "invalid", ";", "}", "public", "String", "getInvalidKey", "(", ")", "{", "return", "invalidKey", ";", "}", "public", "String", "getFragment", "(", ")", "{", "return", "fragment", ";", "}", "public", "String", "getFragmentKey", "(", ")", "{", "return", "fragmentKey", ";", "}", "public", "String", "getScheme", "(", ")", "{", "return", "scheme", ";", "}", "public", "String", "getSchemeKey", "(", ")", "{", "return", "schemeKey", ";", "}", "}", "public", "ValidationResult", "validate", "(", "ValidationContext", "<", "ClientModel", ">", "context", ")", "{", "validateUrls", "(", "context", ")", ";", "validatePairwiseInClientModel", "(", "context", ")", ";", "return", "context", ".", "toResult", "(", ");", "@", "Override", "public", "ValidationResult", "validate", "(", "ClientValidationContext", ".", "OIDCContext", "context", ")", "{", "validateUrls", "(", "context", ")", ";", "validatePairwiseInOIDCClient", "(", "context", ")", ";", "return", "context", ".", "toResult", "(", ");", "}", "private", "void", "validateUrls", "(", "ValidationContext", "<", "ClientModel", ">", "context", ")", "{", "ClientModel", "client", "=", "context", ".", "getObjectToValidate", "(", ");", "String", "rootUrl", "=", "ResolveRelative", ".", "resolveRootUrl", "(", "authServerUrl", ",", "authServerUrl", ",", "client", ".", "getRootUrl", "(", "))", ";", "/", "/", "don", "'", "t", "need", "to", "use", "actual", "rootUrl", "here", "as", "it", "'", "d", "interfere", "with", "others", "URL", "validations", "String", "baseUrl", "=", "ResolveRelative", ".", "resolveRelativeUri", "(", "authServerUrl", ",", "authServerUrl", ",", "authServerUrl", ",", "client", ".", "getBaseUrl", "(", "))", ";", "checkUri", "(", "FieldMessages", ".", "ROOT_URL", ",", "rootUrl", ",", "context", ",", "true", ",", "true", ")", ";", "checkUri", "(", "FieldMessages", ".", "BASE_URL", ",", "baseUrl", ",", "context", ",", "true", ",", "false", ")", ";", "client", ".", "getRedirectUris", "(", ").", "stream", "(", ")", ".", "map", "(", "u", "-", ">", "ResolveRelative", ".", "resolveRelativeUri", "(", "authServerUrl", ",", "authServerUrl", ",", "rootUrl", ",", "u", ")", ")", ".", "forEach", "(", "u", "-", ">", "checkUri", "(", "FieldMessages", ".", "REDIRECT_URIS", ",", "u", ",", "context", ",", "false", ",", "true", ")", ");", "private", "void", "checkUri", "(", "FieldMessages", "field", ",", "String", "url", ",", "ValidationContext", "<", "ClientModel", ">", "context", ",", "boolean", "checkValidUrl", ",", "boolean", "checkFragment", ")", "{", "if", "(", "url", "=", "=", "null", "|", "|", "url", ".", "isEmpty", "(", "))", "{", "return", ";", "URI", "uri", "=", "new", "URI", "(", "url", ")", ";", "boolean", "valid", "=", "true", ";", "if", "(", "uri", ".", "getScheme", "(", ")", "!", "=", "null", "&", "&", "(", "uri", ".", "getScheme", "(", ").", "equals", "(", "\"", "data", "\"", ")", "|", "|", "uri", ".", "getScheme", "(", ").", "equals", "(", "\"", "javascript", "\"", "))", ")", "{", "context", ".", "addError", "(", "field", ".", "getFieldId", "(", "),", "field", ".", "getScheme", "(", "),", "field", ".", "getSchemeKey", "(", "))", ";", "/", "/", "KEYCLOAK", "-", "3421", "if", "(", "checkFragment", "&", "&", "uri", ".", "getFragment", "(", ")", "!", "=", "null", ")", "{", "context", ".", "addError", "(", "field", ".", "getFieldId", "(", "),", "field", ".", "getFragment", "(", "),", "field", ".", "getFragmentKey", "(", "))", ";", "valid", "=", "false", ";", "}", "/", "/", "Don", "'", "t", "check", "if", "URL", "is", "valid", "if", "there", "are", "other", "problems", "with", "it", ";", "otherwise", "it", "could", "lead", "to", "duplicit", "errors", ".", "/", "/", "This", "cannot", "be", "moved", "higher", "because", "it", "acts", "on", "differently", "based", "on", "environment", "(", "e", ".", "g", ".", "sometimes", "it", "checks", "/", "/", "scheme", ",", "sometimes", "it", "doesn", "'", "t", ")", ".", "if", "(", "checkValidUrl", "&", "&", "valid", ")", "{", "uri", ".", "toURL", "(", ");", "/", "/", "throws", "an", "exception", "}", "}", "catch", "(", "MalformedURLException", "|", "IllegalArgumentException", "|", "URISyntaxException", "e", ")", "{", "context", ".", "addError", "(", "field", ".", "getFieldId", "(", "),", "field", ".", "getInvalid", "(", "),", "field", ".", "getInvalidKey", "(", "))", ";", "}", "}", "private", "void", "validatePairwiseInClientModel", "(", "ValidationContext", "<", "ClientModel", ">", "context", ")", "{", "List", "<", "ProtocolMapperRepresentation", ">", "foundPairwiseMappers", "=", "PairwiseSubMapperUtils", ".", "getPairwiseSubMappers", "(", "toRepresentation", "(", "context", ".", "getObjectToValidate", "(", "),", "context", ".", "getSession", "(", "))", ");", "for", "(", "ProtocolMapperRepresentation", "foundPairwise", ":", "foundPairwiseMappers", ")", "{", "String", "sectorIdentifierUri", "=", "PairwiseSubMapperHelper", ".", "getSectorIdentifierUri", "(", "foundPairwise", ")", ";", "validatePairwise", "(", "context", ",", "sectorIdentifierUri", ")", ";", "}", "private", "void", "validatePairwiseInOIDCClient", "(", "ClientValidationContext", ".", "OIDCContext", "context", ")", "{", "OIDCClientRepresentation", "oidcRep", "=", "context", ".", "getOIDCClient", "(", ");", "SubjectType", "subjectType", "=", "SubjectType", ".", "parse", "(", "oidcRep", ".", "getSubjectType", "(", "))", ";", "String", "sectorIdentifierUri", "=", "oidcRep", ".", "getSectorIdentifierUri", "(", ");", "/", "/", "If", "sector_identifier_uri", "is", "in", "oidc", "config", ",", "then", "always", "validate", "it", "if", "(", "SubjectType", ".", "PAIRWISE", "=", "=", "subjectType", "|", "|", "(", "sectorIdentifierUri", "!", "=", "null", "&", "&", "!", "sectorIdentifierUri", ".", "isEmpty", "(", "))", ")", "{", "validatePairwise", "(", "context", ",", "oidcRep", ".", "getSectorIdentifierUri", "(", "))", ";", "private", "void", "validatePairwise", "(", "ValidationContext", "<", "ClientModel", ">", "context", ",", "String", "sectorIdentifierUri", ")", "{", "ClientModel", "client", "=", "context", ".", "getObjectToValidate", "(", ");", "String", "rootUrl", "=", "client", ".", "getRootUrl", "(", ");", "Set", "<", "String", ">", "redirectUris", "=", "new", "HashSet", "<", ">(", ");", "if", "(", "client", ".", "getRedirectUris", "(", ")", "!", "=", "null", ")", "redirectUris", ".", "addAll", "(", "client", ".", "getRedirectUris", "(", "))", ";", "try", "{", "PairwiseSubMapperValidator", ".", "validate", "(", "context", ".", "getSession", "(", "),", "rootUrl", ",", "redirectUris", ",", "sectorIdentifierUri", ")", ";", "}", "catch", "(", "ProtocolMapperConfigException", "e", ")", "{", "context", ".", "addError", "(", "\"", "pairWise", "\"", ",", "e", ".", "getMessage", "(", "),", "e", ".", "getMessageKey", "(", "))", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "Objects", ";", "import", "static", "java", ".", "util", ".", "Arrays", ".", "asList", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "containsInAnyOrder", ";", "public", "void", "testInvalidUrlClientValidation", "(", ")", "{", "testClientUriValidation", "(", "\"", "Root", "URL", "is", "not", "a", "valid", "URL", "\"", ",", "\"", "Base", "URL", "is", "not", "a", "valid", "URL", "\"", ",", "null", ",", "\"", "invalid", "\"", ",", "\"", "myapp", ":", "//", "some", "-", "fake", "-", "app", "\"", ");", "public", "void", "testIllegalSchemeClientValidation", "(", ")", "{", "testClientUriValidation", "(", "\"", "Root", "URL", "uses", "an", "illegal", "scheme", "\"", ",", "\"", "Base", "URL", "uses", "an", "illegal", "scheme", "\"", ",", "\"", "A", "redirect", "URI", "uses", "an", "illegal", "scheme", "\"", ",", "\"", "data", ":", "text", "/", "html", ";", "base64", ",", "PHNjcmlwdD5jb25maXJtKGRvY3VtZW50LmRvbWFpbik7PC9zY3JpcHQ", "+", "\",", "\"", "javascript", ":", "confirm", "(", "document", ".", "domain", ")", "/*", "\"", ")", ";", "}", "/", "/", "KEYCLOAK", "-", "3421", "@", "Test", "public", "void", "testFragmentProhibitedClientValidation", "(", ")", "{", "testClientUriValidation", "(", "\"", "Root", "URL", "must", "not", "contain", "an", "URL", "fragment", "\"", ",", "null", ",", "\"", "Redirect", "URIs", "must", "not", "contain", "an", "URI", "fragment", "\"", ",", "\"", "http", ":", "//", "redhat", ".", "com", "/", "abcd", "#", "someFragment", "\"", ")", ";", "}", "private", "void", "testClientUriValidation", "(", "String", "expectedRootUrlError", ",", "String", "expectedBaseUrlError", ",", "String", "expectedRedirectUrisError", ",", "String", ".", "..", "testUrls", ")", "{", "testClientUriValidation", "(", "false", ",", "expectedRootUrlError", ",", "expectedBaseUrlError", ",", "expectedRedirectUrisError", ",", "testUrls", ")", ";", "testClientUriValidation", "(", "true", ",", "expectedRootUrlError", ",", "expectedBaseUrlError", ",", "expectedRedirectUrisError", ",", "testUrls", ")", ";", "private", "void", "testClientUriValidation", "(", "boolean", "create", ",", "String", "expectedRootUrlError", ",", "String", "expectedBaseUrlError", ",", "String", "expectedRedirectUrisError", ",", "String", ".", "..", "testUrls", ")", "{", "ClientRepresentation", "rep", ";", "if", "(", "create", ")", "{", "rep", "=", "new", "ClientRepresentation", "(", ");", "rep", ".", "setClientId", "(", "\"", "my", "-", "app2", "\"", ");", "rep", ".", "setEnabled", "(", "true", ")", ";", "}", "else", "{", "rep", "=", "createClient", "(", ");", "}", "for", "(", "String", "testUrl", ":", "testUrls", ")", "{", "if", "(", "expectedRootUrlError", "!", "=", "null", ")", "{", "rep", ".", "setRootUrl", "(", "testUrl", ")", ";", "createOrUpdateClientExpectingValidationErrors", "(", "rep", ",", "create", ",", "expectedRootUrlError", ")", ";", "}", "rep", ".", "setRootUrl", "(", "null", ")", ";", "if", "(", "expectedBaseUrlError", "!", "=", "null", ")", "{", "rep", ".", "setBaseUrl", "(", "testUrl", ")", ";", "createOrUpdateClientExpectingValidationErrors", "(", "rep", ",", "create", ",", "expectedBaseUrlError", ")", ";", "}", "rep", ".", "setBaseUrl", "(", "null", ")", ";", "if", "(", "expectedRedirectUrisError", "!", "=", "null", ")", "{", "rep", ".", "setRedirectUris", "(", "Collections", ".", "singletonList", "(", "testUrl", ")", ");", "createOrUpdateClientExpectingValidationErrors", "(", "rep", ",", "create", ",", "expectedRedirectUrisError", ")", ";", "}", "rep", ".", "setRedirectUris", "(", "null", ")", ";", "if", "(", "expectedRootUrlError", "!", "=", "null", ")", "rep", ".", "setRootUrl", "(", "testUrl", ")", ";", "if", "(", "expectedBaseUrlError", "!", "=", "null", ")", "rep", ".", "setBaseUrl", "(", "testUrl", ")", ";", "if", "(", "expectedRedirectUrisError", "!", "=", "null", ")", "rep", ".", "setRedirectUris", "(", "Collections", ".", "singletonList", "(", "testUrl", ")", ");", "createOrUpdateClientExpectingValidationErrors", "(", "rep", ",", "create", ",", "expectedRootUrlError", ",", "expectedBaseUrlError", ",", "expectedRedirectUrisError", ")", ";", "rep", ".", "setRootUrl", "(", "null", ")", ";", "rep", ".", "setBaseUrl", "(", "null", ")", ";", "rep", ".", "setRedirectUris", "(", "null", ")", ";", "}", "private", "void", "createOrUpdateClientExpectingValidationErrors", "(", "ClientRepresentation", "rep", ",", "boolean", "create", ",", "String", ".", "..", "expectedErrors", ")", "{", "Response", "response", "=", "null", ";", "if", "(", "create", ")", "{", "response", "=", "realm", ".", "clients", "(", ").", "create", "(", "rep", ")", ";", "else", "{", "try", "{", "realm", ".", "clients", "(", ").", "get", "(", "rep", ".", "getId", "(", "))", ".", "update", "(", "rep", ")", ";", "fail", "(", "\"", "Expected", "exception", "\"", ");", "}", "catch", "(", "BadRequestException", "e", ")", "{", "response", "=", "e", ".", "getResponse", "(", ");", "}", "}", "expectedErrors", "=", "Arrays", ".", "stream", "(", "expectedErrors", ")", ".", "filter", "(", "Objects", ":", ":", "nonNull", ")", ".", "toArray", "(", "String", "[", "]:", ":", "new", ")", ";", "assertEquals", "(", "response", ".", "getStatus", "(", "),", "400", ")", ";", "OAuth2ErrorRepresentation", "errorRep", "=", "response", ".", "readEntity", "(", "OAuth2ErrorRepresentation", ".", "class", ")", ";", "List", "<", "String", ">", "actualErrors", "=", "asList", "(", "errorRep", ".", "getErrorDescription", "(", ").", "split", "(", "\";", "\"", "))", ";", "assertThat", "(", "actualErrors", ",", "containsInAnyOrder", "(", "expectedErrors", ")", ");", "assertEquals", "(", "\"", "invalid_input", "\"", ",", "errorRep", ".", "getError", "(", "))", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "org", ".", "keycloak", ".", "testsuite", ".", "client", ".", "resources", ".", "TestApplicationResourceUrls", ";", ".", "pairwise", "(", "TestApplicationResourceUrls", ".", "pairwiseSectorIdentifierUri", "(", "))", ")", "testingClient", ".", "testApp", "(", ").", "oidcClientEndpoints", "(", ").", "setSectorIdentifierRedirectUris", "(", "Collections", ".", "singletonList", "(", "\"", "http", ":", "//", "localhost", "/", "resource", "-", "server", "-", "test", "\"", "))", ";", "import", "org", ".", "keycloak", ".", "testsuite", ".", "client", ".", "resources", ".", "TestApplicationResourceUrls", ";", ".", "pairwise", "(", "TestApplicationResourceUrls", ".", "pairwiseSectorIdentifierUri", "(", "))", ".", "pairwise", "(", "TestApplicationResourceUrls", ".", "pairwiseSectorIdentifierUri", "(", "))", "configureSectorIdentifierRedirectUris", "(", ");", "}", "private", "void", "configureSectorIdentifierRedirectUris", "(", ")", "{", "testingClient", ".", "testApp", "(", ").", "oidcClientEndpoints", "(", ").", "setSectorIdentifierRedirectUris", "(", "Arrays", ".", "asList", "(", "\"", "http", ":", "//", "localhost", "/", "resource", "-", "server", "-", "test", "\"", ",", "\"", "http", ":", "//", "localhost", "/", "test", "-", "client", "\"", "))", ";", "configureSectorIdentifierRedirectUris", "(", ");", "import", "org", ".", "keycloak", ".", "testsuite", ".", "arquillian", ".", "annotation", ".", "AuthServerContainerExclude", ".", "AuthServer", ";", "import", "java", ".", "util", ".", "Arrays", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Objects", ";", "import", "static", "java", ".", "util", ".", "Arrays", ".", "asList", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "containsInAnyOrder", ";", "import", "static", "org", ".", "keycloak", ".", "services", ".", "clientregistration", ".", "ErrorCodes", ".", "INVALID_CLIENT_METADATA", ";", "import", "static", "org", ".", "keycloak", ".", "services", ".", "clientregistration", ".", "ErrorCodes", ".", "INVALID_REDIRECT_URI", ";", "public", "void", "testInvalidUrlClientValidation", "(", ")", "{", "testClientUriValidation", "(", "\"", "Root", "URL", "is", "not", "a", "valid", "URL", "\"", ",", "\"", "Base", "URL", "is", "not", "a", "valid", "URL", "\"", ",", "null", ",", "\"", "invalid", "\"", ",", "\"", "myapp", ":", "//", "some", "-", "fake", "-", "app", "\"", ");", "}", "@", "Test", "public", "void", "testIllegalSchemeClientValidation", "(", ")", "{", "testClientUriValidation", "(", "\"", "Root", "URL", "uses", "an", "illegal", "scheme", "\"", ",", "\"", "Base", "URL", "uses", "an", "illegal", "scheme", "\"", ",", "\"", "A", "redirect", "URI", "uses", "an", "illegal", "scheme", "\"", ",", "\"", "data", ":", "text", "/", "html", ";", "base64", ",", "PHNjcmlwdD5jb25maXJtKGRvY3VtZW50LmRvbWFpbik7PC9zY3JpcHQ", "+", "\",", "\"", "javascript", ":", "confirm", "(", "document", ".", "domain", ")", "/*", "\"", ")", ";", "/", "/", "KEYCLOAK", "-", "3421", "public", "void", "testFragmentProhibitedClientValidation", "(", ")", "{", "testClientUriValidation", "(", "\"", "Root", "URL", "must", "not", "contain", "an", "URL", "fragment", "\"", ",", "null", ",", "\"", "Redirect", "URIs", "must", "not", "contain", "an", "URI", "fragment", "\"", ",", "\"", "http", ":", "//", "redhat", ".", "com", "/", "abcd", "#", "someFragment", "\"", ")", ";", "}", "private", "void", "testClientUriValidation", "(", "String", "expectedRootUrlError", ",", "String", "expectedBaseUrlError", ",", "String", "expectedRedirectUrisError", ",", "String", ".", "..", "testUrls", ")", "{", "testClientUriValidation", "(", "true", ",", "expectedRootUrlError", ",", "expectedBaseUrlError", ",", "expectedRedirectUrisError", ",", "testUrls", ")", ";", "testClientUriValidation", "(", "false", ",", "expectedRootUrlError", ",", "expectedBaseUrlError", ",", "expectedRedirectUrisError", ",", "testUrls", ")", ";", "}", "private", "void", "testClientUriValidation", "(", "boolean", "register", ",", "String", "expectedRootUrlError", ",", "String", "expectedBaseUrlError", ",", "String", "expectedRedirectUrisError", ",", "String", ".", "..", "testUrls", ")", "{", "ClientRepresentation", "rep", ";", "if", "(", "register", ")", "{", "authCreateClients", "(", ");", "rep", "=", "buildClient", "(", ");", "}", "else", "{", "try", "{", "registerClientAsAdmin", "(", ");", "rep", "=", "reg", ".", "get", "(", "CLIENT_ID", ")", ";", "}", "catch", "(", "ClientRegistrationException", "e", ")", "{", "throw", "new", "RuntimeException", "(", "e", ")", ";", "}", "}", "for", "(", "String", "testUrl", ":", "testUrls", ")", "{", "if", "(", "expectedRootUrlError", "!", "=", "null", ")", "{", "rep", ".", "setRootUrl", "(", "testUrl", ")", ";", "registerOrUpdateClientExpectingValidationErrors", "(", "rep", ",", "register", ",", "false", ",", "expectedRootUrlError", ")", ";", "}", "rep", ".", "setRootUrl", "(", "null", ")", ";", "if", "(", "expectedBaseUrlError", "!", "=", "null", ")", "{", "rep", ".", "setBaseUrl", "(", "testUrl", ")", ";", "registerOrUpdateClientExpectingValidationErrors", "(", "rep", ",", "register", ",", "false", ",", "expectedBaseUrlError", ")", ";", "}", "rep", ".", "setBaseUrl", "(", "null", ")", ";", "if", "(", "expectedRedirectUrisError", "!", "=", "null", ")", "{", "rep", ".", "setRedirectUris", "(", "Collections", ".", "singletonList", "(", "testUrl", ")", ");", "registerOrUpdateClientExpectingValidationErrors", "(", "rep", ",", "register", ",", "true", ",", "expectedRedirectUrisError", ")", ";", "}", "rep", ".", "setRedirectUris", "(", "null", ")", ";", "if", "(", "expectedRootUrlError", "!", "=", "null", ")", "rep", ".", "setRootUrl", "(", "testUrl", ")", ";", "if", "(", "expectedBaseUrlError", "!", "=", "null", ")", "rep", ".", "setBaseUrl", "(", "testUrl", ")", ";", "if", "(", "expectedRedirectUrisError", "!", "=", "null", ")", "rep", ".", "setRedirectUris", "(", "Collections", ".", "singletonList", "(", "testUrl", ")", ");", "registerOrUpdateClientExpectingValidationErrors", "(", "rep", ",", "register", ",", "expectedRedirectUrisError", "!", "=", "null", ",", "expectedRootUrlError", ",", "expectedBaseUrlError", ",", "expectedRedirectUrisError", ")", ";", "rep", ".", "setRootUrl", "(", "null", ")", ";", "rep", ".", "setBaseUrl", "(", "null", ")", ";", "rep", ".", "setRedirectUris", "(", "null", ")", ";", "}", "}", "private", "void", "registerOrUpdateClientExpectingValidationErrors", "(", "ClientRepresentation", "rep", ",", "boolean", "register", ",", "boolean", "redirectUris", ",", "String", ".", "..", "expectedErrors", ")", "{", "HttpErrorException", "errorException", "=", "null", ";", "try", "{", "if", "(", "register", ")", "{", "registerClient", "(", "rep", ")", ";", "}", "else", "{", "reg", ".", "update", "(", "rep", ")", ";", "}", "fail", "(", "\"", "Expected", "exception", "\"", ");", "}", "catch", "(", "ClientRegistrationException", "e", ")", "{", "errorException", "=", "(", "HttpErrorException", ")", "e", ".", "getCause", "(", ");", "expectedErrors", "=", "Arrays", ".", "stream", "(", "expectedErrors", ")", ".", "filter", "(", "Objects", ":", ":", "nonNull", ")", ".", "toArray", "(", "String", "[", "]:", ":", "new", ")", ";", "assertEquals", "(", "errorException", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "),", "400", ")", ";", "OAuth2ErrorRepresentation", "errorRep", ";", "try", "{", "errorRep", "=", "JsonSerialization", ".", "readValue", "(", "errorException", ".", "getErrorResponse", "(", "),", "OAuth2ErrorRepresentation", ".", "class", ")", ";", "}", "catch", "(", "IOException", "e", ")", "{", "throw", "new", "RuntimeException", "(", "e", ")", ";", "}", "List", "<", "String", ">", "actualErrors", "=", "asList", "(", "errorRep", ".", "getErrorDescription", "(", ").", "split", "(", "\";", "\"", "))", ";", "assertThat", "(", "actualErrors", ",", "containsInAnyOrder", "(", "expectedErrors", ")", ");", "assertEquals", "(", "redirectUris", "?", "INVALID_REDIRECT_URI", ":", "INVALID_CLIENT_METADATA", ",", "errorRep", ".", "getError", "(", "))", ";", "clientRootURLIllegalSchemeError", "=", "Root", "URL", "uses", "an", "illegal", "scheme", "clientBaseURLIllegalSchemeError", "=", "Base", "URL", "uses", "an", "illegal", "scheme", "clientRedirectURIsIllegalSchemeError", "=", "A", "redirect", "URI", "uses", "an", "illegal", "scheme", "clientBaseURLInvalid", "=", "Base", "URL", "is", "not", "a", "valid", "URL", "clientRootURLInvalid", "=", "Root", "URL", "is", "not", "a", "valid", "URL", "clientRedirectURIsInvalid", "=", "A", "redirect", "URI", "is", "not", "a", "valid", "URI</s>import", "java", ".", "util", ".", "function", ".", "Function", ";", "import", "org", ".", "keycloak", ".", "validation", ".", "ClientValidationUtil", ";", "ClientValidationUtil", ".", "validate", "(", "session", ",", "app", ",", "false", ",", "c", "-", ">", "{", "throw", "new", "RuntimeException", "(", "\"", "Invalid", "client", "\"", "+", "app", ".", "getClientId", "(", ")", "+", "\"", ":", "\"", "+", "c", ".", "getError", "(", "))", ";", "*", "Copyright", "2019", "Red", "Hat", ",", "Inc", ".", "and", "/", "or", "its", "affiliates", "public", "interface", "ClientValidationContext", "{", "enum", "Event", "{", "CREATE", ",", "UPDATE", "Event", "getEvent", "(", ");", "KeycloakSession", "getSession", "(", ");", "ClientModel", "getClient", "(", ");", "String", "getError", "(", ");", "ClientValidationContext", "invalid", "(", "String", "error", ")", ";", "import", "org", ".", "keycloak", ".", "provider", ".", "Provider", ";", "public", "interface", "ClientValidationProvider", "extends", "Provider", "{", "void", "validate", "(", "ClientValidationContext", "context", ")", ";", "/", "*", "*", "Copyright", "2019", "Red", "Hat", ",", "Inc", ".", "and", "/", "or", "its", "affiliates", "*", "and", "other", "contributors", "as", "indicated", "by", "the", "@", "author", "tags", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "keycloak", ".", "validation", ";", "import", "org", ".", "keycloak", ".", "models", ".", "ClientModel", ";", "import", "org", ".", "keycloak", ".", "models", ".", "KeycloakSession", ";", "import", "javax", ".", "ws", ".", "rs", ".", "BadRequestException", ";", "public", "class", "ClientValidationUtil", "{", "public", "static", "void", "validate", "(", "KeycloakSession", "session", ",", "ClientModel", "client", ",", "boolean", "create", ",", "ErrorHandler", "errorHandler", ")", "throws", "BadRequestException", "{", "ClientValidationProvider", "provider", "=", "session", ".", "getProvider", "(", "ClientValidationProvider", ".", "class", ")", ";", "if", "(", "provider", "!", "=", "null", ")", "{", "DefaultClientValidationContext", "context", "=", "new", "DefaultClientValidationContext", "(", "create", "?", "ClientValidationContext", ".", "Event", ".", "CREATE", ":", "ClientValidationContext", ".", "Event", ".", "UPDATE", ",", "session", ",", "client", ")", ";", "provider", ".", "validate", "(", "context", ")", ";", "if", "(", "!", "context", ".", "isValid", "(", "))", "{", "errorHandler", ".", "onError", "(", "context", ")", ";", "}", "}", "}", "public", "interface", "ErrorHandler", "{", "void", "onError", "(", "ClientValidationContext", "context", ")", ";", "}", "private", "static", "class", "DefaultClientValidationContext", "implements", "ClientValidationContext", "{", "private", "Event", "event", ";", "private", "KeycloakSession", "session", ";", "private", "ClientModel", "client", ";", "private", "String", "error", ";", "public", "DefaultClientValidationContext", "(", "Event", "event", ",", "KeycloakSession", "session", ",", "ClientModel", "client", ")", "{", "this", ".", "event", "=", "event", ";", "this", ".", "session", "=", "session", ";", "this", ".", "client", "=", "client", ";", "}", "public", "boolean", "isValid", "(", ")", "{", "return", "error", "=", "=", "null", ";", "}", "public", "String", "getError", "(", ")", "{", "return", "error", ";", "}", "@", "Override", "public", "Event", "getEvent", "(", ")", "{", "return", "event", ";", "}", "@", "Override", "public", "KeycloakSession", "getSession", "(", ")", "{", "return", "session", ";", "}", "@", "Override", "public", "ClientModel", "getClient", "(", ")", "{", "return", "client", ";", "}", "@", "Override", "public", "ClientValidationContext", "invalid", "(", "String", "error", ")", "{", "this", ".", "error", "=", "error", ";", "return", "this", ";", "}", "}", "}", "@", "@", "-", "0", ",", "0", "+", "1", ",", "77", "@", "@", "import", "org", ".", "keycloak", ".", "services", ".", "validation", ".", "ClientValidator", ";", "import", "org", ".", "keycloak", ".", "services", ".", "validation", ".", "ValidationMessages", ";", "@", "Override", "public", "boolean", "validateClient", "(", "ValidationMessages", "validationMessages", ")", "{", "return", "ClientValidator", ".", "validate", "(", "client", ",", "validationMessages", ")", ";", "}", "import", "org", ".", "keycloak", ".", "models", ".", "*;", "import", "org", ".", "keycloak", ".", "services", ".", "validation", ".", "ValidationMessages", ";", "import", "org", ".", "keycloak", ".", "validation", ".", "ClientValidationUtil", ";", "ValidationMessages", "validationMessages", "=", "new", "ValidationMessages", "(", ");", "if", "(", "!", "context", ".", "validateClient", "(", "validationMessages", ")", ")", "{", "String", "errorCode", "=", "validationMessages", ".", "fieldHasError", "(", "\"", "redirectUris", "\"", ")", "?", "ErrorCodes", ".", "INVALID_REDIRECT_URI", ":", "ErrorCodes", ".", "INVALID_CLIENT_METADATA", ";", "throw", "new", "ErrorResponseException", "(", "errorCode", ",", "validationMessages", ".", "getStringMessages", "(", "),", "Response", ".", "Status", ".", "BAD_REQUEST", ")", ";", "}", "ClientValidationUtil", ".", "validate", "(", "session", ",", "clientModel", ",", "true", ",", "c", "-", ">", "{", "session", ".", "getTransactionManager", "(", ").", "setRollbackOnly", "(", ");", "throw", "new", "ErrorResponseException", "(", "ErrorCodes", ".", "INVALID_CLIENT_METADATA", ",", "c", ".", "getError", "(", "),", "Response", ".", "Status", ".", "BAD_REQUEST", ")", ";", "}", ");", "ValidationMessages", "validationMessages", "=", "new", "ValidationMessages", "(", ");", "if", "(", "!", "context", ".", "validateClient", "(", "validationMessages", ")", ")", "{", "String", "errorCode", "=", "validationMessages", ".", "fieldHasError", "(", "\"", "redirectUris", "\"", ")", "?", "ErrorCodes", ".", "INVALID_REDIRECT_URI", ":", "ErrorCodes", ".", "INVALID_CLIENT_METADATA", ";", "throw", "new", "ErrorResponseException", "(", "errorCode", ",", "validationMessages", ".", "getStringMessages", "(", "),", "Response", ".", "Status", ".", "BAD_REQUEST", ")", ";", "}", "ClientValidationUtil", ".", "validate", "(", "session", ",", "client", ",", "false", ",", "c", "-", ">", "{", "session", ".", "getTransactionManager", "(", ").", "setRollbackOnly", "(", ");", "throw", "new", "ErrorResponseException", "(", "ErrorCodes", ".", "INVALID_CLIENT_METADATA", ",", "c", ".", "getError", "(", "),", "Response", ".", "Status", ".", "BAD_REQUEST", ")", ";", "}", ");", "import", "org", ".", "keycloak", ".", "services", ".", "validation", ".", "ValidationMessages", ";", "boolean", "validateClient", "(", "ValidationMessages", "validationMessages", ")", ";", "import", "org", ".", "keycloak", ".", "services", ".", "validation", ".", "PairwiseClientValidator", ";", "import", "org", ".", "keycloak", ".", "services", ".", "validation", ".", "ValidationMessages", ";", "@", "Override", "public", "boolean", "validateClient", "(", "ValidationMessages", "validationMessages", ")", "{", "return", "super", ".", "validateClient", "(", "validationMessages", ")", "&", "&", "PairwiseClientValidator", ".", "validate", "(", "session", ",", "client", ",", "validationMessages", ")", ";", "}", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "org", ".", "keycloak", ".", "protocol", ".", "oidc", ".", "utils", ".", "SubjectType", ";", "import", "org", ".", "keycloak", ".", "services", ".", "clientregistration", ".", "DefaultClientRegistrationContext", ";", "import", "org", ".", "keycloak", ".", "services", ".", "validation", ".", "PairwiseClientValidator", ";", "import", "org", ".", "keycloak", ".", "services", ".", "validation", ".", "ValidationMessages", ";", "@", "Override", "public", "boolean", "validateClient", "(", "ValidationMessages", "validationMessages", ")", "{", "boolean", "valid", "=", "super", ".", "validateClient", "(", "validationMessages", ")", ";", "String", "rootUrl", "=", "client", ".", "getRootUrl", "(", ");", "Set", "<", "String", ">", "redirectUris", "=", "new", "HashSet", "<", ">(", ");", "if", "(", "client", ".", "getRedirectUris", "(", ")", "!", "=", "null", ")", "redirectUris", ".", "addAll", "(", "client", ".", "getRedirectUris", "(", "))", ";", "SubjectType", "subjectType", "=", "SubjectType", ".", "parse", "(", "oidcRep", ".", "getSubjectType", "(", "))", ";", "String", "sectorIdentifierUri", "=", "oidcRep", ".", "getSectorIdentifierUri", "(", ");", "/", "/", "If", "sector_identifier_uri", "is", "in", "oidc", "config", ",", "then", "always", "validate", "it", "if", "(", "SubjectType", ".", "PAIRWISE", "=", "=", "subjectType", "|", "|", "(", "sectorIdentifierUri", "!", "=", "null", "&", "&", "!", "sectorIdentifierUri", ".", "isEmpty", "(", "))", ")", "{", "valid", "=", "valid", "&", "&", "PairwiseClientValidator", ".", "validate", "(", "session", ",", "rootUrl", ",", "redirectUris", ",", "oidcRep", ".", "getSectorIdentifierUri", "(", "),", "validationMessages", ")", ";", "}", "return", "valid", ";", "}", "import", "org", ".", "keycloak", ".", "common", ".", "Profile", ";", "import", "org", ".", "keycloak", ".", "services", ".", "validation", ".", "ClientValidator", ";", "import", "org", ".", "keycloak", ".", "services", ".", "validation", ".", "PairwiseClientValidator", ";", "import", "org", ".", "keycloak", ".", "services", ".", "validation", ".", "ValidationMessages", ";", "import", "org", ".", "keycloak", ".", "utils", ".", "ProfileHelper", ";", "import", "org", ".", "keycloak", ".", "validation", ".", "ClientValidationUtil", ";", "import", "java", ".", "util", ".", "Properties", ";", "import", "org", ".", "keycloak", ".", "utils", ".", "ReservedCharValidator", ";", "ValidationMessages", "validationMessages", "=", "new", "ValidationMessages", "(", ");", "if", "(", "!", "ClientValidator", ".", "validate", "(", "rep", ",", "validationMessages", ")", "|", "|", "!", "PairwiseClientValidator", ".", "validate", "(", "session", ",", "rep", ",", "validationMessages", ")", ")", "{", "Properties", "messages", "=", "AdminRoot", ".", "getMessages", "(", "session", ",", "realm", ",", "auth", ".", "adminAuth", "(", ").", "getToken", "(", ").", "getLocale", "(", "))", ";", "throw", "new", "ErrorResponseException", "(", "validationMessages", ".", "getStringMessages", "(", "),", "validationMessages", ".", "getStringMessages", "(", "messages", ")", ",", "Response", ".", "Status", ".", "BAD_REQUEST", ")", ";", "}", "ClientValidationUtil", ".", "validate", "(", "session", ",", "client", ",", "false", ",", "c", "-", ">", "{", "throw", "new", "ErrorResponseException", "(", "Errors", ".", "INVALID_INPUT", ",", "c", ".", "getError", "(", "),", "Response", ".", "Status", ".", "BAD_REQUEST", ")", ";", "import", "org", ".", "keycloak", ".", "services", ".", "validation", ".", "ClientValidator", ";", "import", "org", ".", "keycloak", ".", "services", ".", "validation", ".", "PairwiseClientValidator", ";", "import", "org", ".", "keycloak", ".", "services", ".", "validation", ".", "ValidationMessages", ";", "import", "org", ".", "keycloak", ".", "validation", ".", "ClientValidationUtil", ";", "import", "java", ".", "util", ".", "Properties", ";", "ValidationMessages", "validationMessages", "=", "new", "ValidationMessages", "(", ");", "if", "(", "!", "ClientValidator", ".", "validate", "(", "rep", ",", "validationMessages", ")", "|", "|", "!", "PairwiseClientValidator", ".", "validate", "(", "session", ",", "rep", ",", "validationMessages", ")", ")", "{", "Properties", "messages", "=", "AdminRoot", ".", "getMessages", "(", "session", ",", "realm", ",", "auth", ".", "adminAuth", "(", ").", "getToken", "(", ").", "getLocale", "(", "))", ";", "throw", "new", "ErrorResponseException", "(", "validationMessages", ".", "getStringMessages", "(", "),", "validationMessages", ".", "getStringMessages", "(", "messages", ")", ",", "Response", ".", "Status", ".", "BAD_REQUEST", ")", ";", "}", "ClientValidationUtil", ".", "validate", "(", "session", ",", "clientModel", ",", "true", ",", "c", "-", ">", "{", "throw", "new", "ErrorResponseException", "(", "Errors", ".", "INVALID_INPUT", ",", "c", ".", "getError", "(", "),", "Response", ".", "Status", ".", "BAD_REQUEST", ")", ";", "/", "*", "*", "*", "*", "Copyright", "2016", "Red", "Hat", ",", "Inc", ".", "and", "/", "or", "its", "affiliates", "*", "*", "and", "other", "contributors", "as", "indicated", "by", "the", "@", "author", "tags", ".", "*", "*", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "*", "limitations", "under", "the", "License", ".", "*", "*", "/", "package", "org", ".", "keycloak", ".", "services", ".", "validation", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "ClientRepresentation", ";", "/", "**", "*", "@", "author", "Vaclav", "Muzikar", "<", "vmuzikar", "@", "redhat", ".", "com", ">", "*", "/", "public", "class", "ClientValidator", "{", "/", "**", "*", "Checks", "if", "the", "Client", "'", "s", "Redirect", "URIs", "doesn", "'", "t", "contain", "any", "URI", "fragments", "(", "like", "http", ":", "//", "example", ".", "org", "/", "auth", "#", "fragment", ")", "*", "*", "@", "see", "<", "a", "href", "=", "\"", "https", ":", "//", "issues", ".", "jboss", ".", "org", "/", "browse", "/", "KEYCLOAK", "-", "3421", "\"", ">", "KEYCLOAK", "-", "3421", "<", "/", "a", ">", "*", "@", "param", "client", "*", "@", "param", "messages", "*", "@", "return", "true", "if", "Redirect", "URIs", "doesn", "'", "t", "contain", "any", "URI", "with", "fragments", "*", "/", "public", "static", "boolean", "validate", "(", "ClientRepresentation", "client", ",", "ValidationMessages", "messages", ")", "{", "boolean", "isValid", "=", "true", ";", "if", "(", "client", ".", "getRedirectUris", "(", ")", "!", "=", "null", ")", "{", "long", "urisWithFragmentCount", "=", "client", ".", "getRedirectUris", "(", ").", "stream", "(", ").", "filter", "(", "p", "-", ">", "p", ".", "contains", "(", "\"#", "\")", ").", "count", "(", ");", "if", "(", "urisWithFragmentCount", ">", "0", ")", "{", "messages", ".", "add", "(", "\"", "redirectUris", "\"", ",", "\"", "Redirect", "URIs", "must", "not", "contain", "an", "URI", "fragment", "\"", ",", "\"", "clientRedirectURIsFragmentError", "\"", ");", "isValid", "=", "false", ";", "}", "}", "if", "(", "client", ".", "getRootUrl", "(", ")", "!", "=", "null", "&", "&", "client", ".", "getRootUrl", "(", ").", "contains", "(", "\"#", "\")", ")", "{", "messages", ".", "add", "(", "\"", "rootUrl", "\"", ",", "\"", "Root", "URL", "must", "not", "contain", "an", "URL", "fragment", "\"", ",", "\"", "clientRootURLFragmentError", "\"", ");", "isValid", "=", "false", ";", "}", "return", "isValid", ";", "}", "}", "@", "@", "-", "1", ",", "47", "+", "0", ",", "0", "@", "@", "package", "org", ".", "keycloak", ".", "services", ".", "validation", ";", "import", "org", ".", "keycloak", ".", "models", ".", "KeycloakSession", ";", "import", "org", ".", "keycloak", ".", "protocol", ".", "ProtocolMapperConfigException", ";", "import", "org", ".", "keycloak", ".", "protocol", ".", "oidc", ".", "mappers", ".", "PairwiseSubMapperHelper", ";", "import", "org", ".", "keycloak", ".", "protocol", ".", "oidc", ".", "utils", ".", "PairwiseSubMapperUtils", ";", "import", "org", ".", "keycloak", ".", "protocol", ".", "oidc", ".", "utils", ".", "PairwiseSubMapperValidator", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "ClientRepresentation", ";", "import", "org", ".", "keycloak", ".", "representations", ".", "idm", ".", "ProtocolMapperRepresentation", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Set", ";", "/", "**", "*", "@", "author", "<", "a", "href", "=", "\"", "mailto", ":", "martin", ".", "hardselius", "@", "gmail", ".", "com", "\"", ">", "Martin", "Hardselius", "<", "/", "a", ">", "*", "/", "public", "class", "PairwiseClientValidator", "{", "public", "static", "boolean", "validate", "(", "KeycloakSession", "session", ",", "ClientRepresentation", "client", ",", "ValidationMessages", "messages", ")", "{", "String", "rootUrl", "=", "client", ".", "getRootUrl", "(", ");", "Set", "<", "String", ">", "redirectUris", "=", "new", "HashSet", "<", ">(", ");", "boolean", "valid", "=", "true", ";", "List", "<", "ProtocolMapperRepresentation", ">", "foundPairwiseMappers", "=", "PairwiseSubMapperUtils", ".", "getPairwiseSubMappers", "(", "client", ")", ";", "for", "(", "ProtocolMapperRepresentation", "foundPairwise", ":", "foundPairwiseMappers", ")", "{", "String", "sectorIdentifierUri", "=", "PairwiseSubMapperHelper", ".", "getSectorIdentifierUri", "(", "foundPairwise", ")", ";", "if", "(", "client", ".", "getRedirectUris", "(", ")", "!", "=", "null", ")", "redirectUris", ".", "addAll", "(", "client", ".", "getRedirectUris", "(", "))", ";", "valid", "=", "valid", "&", "&", "validate", "(", "session", ",", "rootUrl", ",", "redirectUris", ",", "sectorIdentifierUri", ",", "messages", ")", ";", "}", "return", "true", ";", "}", "public", "static", "boolean", "validate", "(", "KeycloakSession", "session", ",", "String", "rootUrl", ",", "Set", "<", "String", ">", "redirectUris", ",", "String", "sectorIdentifierUri", ",", "ValidationMessages", "messages", ")", "{", "try", "{", "PairwiseSubMapperValidator", ".", "validate", "(", "session", ",", "rootUrl", ",", "redirectUris", ",", "sectorIdentifierUri", ")", ";", "}", "catch", "(", "ProtocolMapperConfigException", "e", ")", "{", "messages", ".", "add", "(", "e", ".", "getMessage", "(", "),", "e", ".", "getMessageKey", "(", "))", ";", "return", "false", ";", "}", "return", "true", ";", "}", "}", "@", "@", "-", "1", ",", "100", "+", "0", ",", "0", "@", "@", "/", "*", "*", "*", "*", "Copyright", "2016", "Red", "Hat", ",", "Inc", ".", "and", "/", "or", "its", "affiliates", "*", "*", "and", "other", "contributors", "as", "indicated", "by", "the", "@", "author", "tags", ".", "*", "*", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "*", "limitations", "under", "the", "License", ".", "*", "*", "/", "package", "org", ".", "keycloak", ".", "services", ".", "validation", ";", "import", "java", ".", "text", ".", "MessageFormat", ";", "import", "java", ".", "util", ".", "Properties", ";", "/", "**", "*", "@", "author", "Vaclav", "Muzikar", "<", "vmuzikar", "@", "redhat", ".", "com", ">", "*", "/", "public", "class", "ValidationMessage", "{", "private", "String", "fieldId", ";", "private", "String", "message", ";", "private", "String", "localizedMessageKey", ";", "private", "Object", "[", "]", "localizedMessageParameters", ";", "public", "ValidationMessage", "(", "String", "message", ")", "{", "this", ".", "message", "=", "message", ";", "}", "public", "ValidationMessage", "(", "String", "message", ",", "String", "localizedMessageKey", ",", "Object", ".", "..", "localizedMessageParameters", ")", "{", "this", ".", "message", "=", "message", ";", "this", ".", "localizedMessageKey", "=", "localizedMessageKey", ";", "this", ".", "localizedMessageParameters", "=", "localizedMessageParameters", ";", "}", "public", "String", "getFieldId", "(", ")", "{", "return", "fieldId", ";", "}", "public", "void", "setFieldId", "(", "String", "fieldId", ")", "{", "this", ".", "fieldId", "=", "fieldId", ";", "}", "public", "String", "getLocalizedMessageKey", "(", ")", "{", "return", "localizedMessageKey", ";", "}", "public", "void", "setLocalizedMessageKey", "(", "String", "localizedMessageKey", ")", "{", "this", ".", "localizedMessageKey", "=", "localizedMessageKey", ";", "}", "public", "Object", "[", "]", "getLocalizedMessageParameters", "(", ")", "{", "return", "localizedMessageParameters", ";", "}", "public", "void", "setLocalizedMessageParameters", "(", "Object", "[", "]", "localizedMessageParameters", ")", "{", "this", ".", "localizedMessageParameters", "=", "localizedMessageParameters", ";", "}", "public", "String", "getMessage", "(", ")", "{", "return", "message", ";", "}", "public", "String", "getMessage", "(", "Properties", "localizedMessages", ")", "{", "if", "(", "getLocalizedMessageKey", "(", ")", "!", "=", "null", ")", "{", "return", "MessageFormat", ".", "format", "(", "localizedMessages", ".", "getProperty", "(", "getLocalizedMessageKey", "(", "),", "getMessage", "(", "))", ",", "getLocalizedMessageParameters", "(", "))", ";", "}", "else", "{", "return", "getMessage", "(", ");", "}", "}", "@", "Override", "public", "boolean", "equals", "(", "Object", "o", ")", "{", "if", "(", "this", "=", "=", "o", ")", "return", "true", ";", "if", "(", "o", "=", "=", "null", "|", "|", "getClass", "(", ")", "!", "=", "o", ".", "getClass", "(", "))", "return", "false", ";", "ValidationMessage", "message1", "=", "(", "ValidationMessage", ")", "o", ";", "if", "(", "getFieldId", "(", ")", "!", "=", "null", "?", "!", "getFieldId", "(", ").", "equals", "(", "message1", ".", "getFieldId", "(", "))", ":", "message1", ".", "getFieldId", "(", ")", "!", "=", "null", ")", "return", "false", ";", "return", "getMessage", "(", ")", "!", "=", "null", "?", "getMessage", "(", ").", "equals", "(", "message1", ".", "getMessage", "(", "))", ":", "message1", ".", "getMessage", "(", ")", "=", "=", "null", ";", "}", "@", "Override", "public", "int", "hashCode", "(", ")", "{", "int", "result", "=", "getFieldId", "(", ")", "!", "=", "null", "?", "getFieldId", "(", ").", "hashCode", "(", ")", ":", "0", ";", "result", "=", "31", "*", "result", "+", "(", "getMessage", "(", ")", "!", "=", "null", "?", "getMessage", "(", ").", "hashCode", "(", ")", ":", "0", ")", ";", "return", "result", ";", "}", "}", "@", "@", "-", "1", ",", "89", "+", "0", ",", "0", "@", "@", "/", "*", "*", "*", "*", "Copyright", "2016", "Red", "Hat", ",", "Inc", ".", "and", "/", "or", "its", "affiliates", "*", "*", "and", "other", "contributors", "as", "indicated", "by", "the", "@", "author", "tags", ".", "*", "*", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "*", "limitations", "under", "the", "License", ".", "*", "*", "/", "package", "org", ".", "keycloak", ".", "services", ".", "validation", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "LinkedHashSet", ";", "import", "java", ".", "util", ".", "Properties", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "function", ".", "Function", ";", "import", "java", ".", "util", ".", "stream", ".", "Collectors", ";", "/", "**", "*", "@", "author", "Vaclav", "Muzikar", "<", "vmuzikar", "@", "redhat", ".", "com", ">", "*", "/", "public", "class", "ValidationMessages", "{", "private", "Set", "<", "ValidationMessage", ">", "messages", "=", "new", "LinkedHashSet", "<", ">(", ");", "public", "ValidationMessages", "(", ")", "{", "}", "public", "ValidationMessages", "(", "String", ".", "..", "messages", ")", "{", "for", "(", "String", "message", ":", "messages", ")", "{", "add", "(", "message", ")", ";", "}", "}", "public", "void", "add", "(", "String", "message", ")", "{", "messages", ".", "add", "(", "new", "ValidationMessage", "(", "message", ")", ");", "}", "public", "void", "add", "(", "String", "message", ",", "String", "localizedMessageKey", ")", "{", "messages", ".", "add", "(", "new", "ValidationMessage", "(", "message", ",", "localizedMessageKey", ")", ");", "}", "public", "void", "add", "(", "String", "fieldId", ",", "String", "message", ",", "String", "localizedMessageKey", ")", "{", "ValidationMessage", "validationMessage", "=", "new", "ValidationMessage", "(", "message", ",", "localizedMessageKey", ")", ";", "validationMessage", ".", "setFieldId", "(", "fieldId", ")", ";", "add", "(", "validationMessage", ")", ";", "}", "public", "void", "add", "(", "ValidationMessage", "message", ")", "{", "messages", ".", "add", "(", "message", ")", ";", "}", "public", "boolean", "fieldHasError", "(", "String", "fieldId", ")", "{", "if", "(", "fieldId", "=", "=", "null", ")", "{", "return", "false", ";", "}", "for", "(", "ValidationMessage", "message", ":", "messages", ")", "{", "if", "(", "fieldId", ".", "equals", "(", "message", ".", "getFieldId", "(", "))", ")", "{", "return", "true", ";", "}", "}", "return", "false", ";", "}", "public", "Set", "<", "ValidationMessage", ">", "getMessages", "(", ")", "{", "return", "Collections", ".", "unmodifiableSet", "(", "messages", ")", ";", "}", "protected", "String", "getStringMessages", "(", "Function", "<", "?", "super", "ValidationMessage", ",", "?", "extends", "String", ">", "function", ")", "{", "return", "messages", ".", "stream", "(", ").", "map", "(", "function", ")", ".", "collect", "(", "Collectors", ".", "joining", "(", "\";", "\"", "))", ";", "}", "public", "String", "getStringMessages", "(", ")", "{", "return", "getStringMessages", "(", "ValidationMessage", ":", ":", "getMessage", ")", ";", "}", "public", "String", "getStringMessages", "(", "Properties", "localizedMessages", ")", "{", "return", "getStringMessages", "(", "x", "-", ">", "x", ".", "getMessage", "(", "localizedMessages", ")", ");", "}", "}", "@", "@", "-", "17", ",", "72", "+", "17", ",", "189", "@", "@", "import", "java", ".", "net", ".", "URL", ";", "private", "ClientValidationContext", "context", ";", "public", "void", "validate", "(", "ClientValidationContext", "context", ")", "{", "this", ".", "context", "=", "context", ";", "try", "{", "validate", "(", "context", ".", "getClient", "(", "))", ";", "}", "catch", "(", "ValidationException", "e", ")", "{", "context", ".", "invalid", "(", "e", ".", "getMessage", "(", "))", ";", "}", "private", "void", "validate", "(", "ClientModel", "client", ")", "throws", "ValidationException", "{", "String", "resolvedRootUrl", "=", "ResolveRelative", ".", "resolveRootUrl", "(", "authServerUrl", ",", "authServerUrl", ",", "client", ".", "getRootUrl", "(", "))", ";", "String", "resolvedBaseUrl", "=", "ResolveRelative", ".", "resolveRelativeUri", "(", "authServerUrl", ",", "authServerUrl", ",", "resolvedRootUrl", ",", "client", ".", "getBaseUrl", "(", "))", ";", "validateRootUrl", "(", "resolvedRootUrl", ")", ";", "validateBaseUrl", "(", "resolvedBaseUrl", ")", ";", "}", "private", "void", "validateRootUrl", "(", "String", "rootUrl", ")", "throws", "ValidationException", "{", "if", "(", "rootUrl", "!", "=", "null", "&", "&", "!", "rootUrl", ".", "isEmpty", "(", "))", "{", "basicHttpUrlCheck", "(", "\"", "rootUrl", "\"", ",", "rootUrl", ")", ";", "}", "private", "void", "validateBaseUrl", "(", "String", "baseUrl", ")", "throws", "ValidationException", "{", "if", "(", "baseUrl", "!", "=", "null", "&", "&", "!", "baseUrl", ".", "isEmpty", "(", "))", "{", "basicHttpUrlCheck", "(", "\"", "baseUrl", "\"", ",", "baseUrl", ")", ";", "}", "private", "void", "basicHttpUrlCheck", "(", "String", "field", ",", "String", "url", ")", "throws", "ValidationException", "{", "boolean", "valid", "=", "true", ";", "URI", "uri", "=", "new", "URL", "(", "url", ")", ".", "toURI", "(", ");", "if", "(", "uri", ".", "getScheme", "(", ")", "=", "=", "null", "|", "|", "uri", ".", "getScheme", "(", ").", "isEmpty", "(", "))", "{", "}", "catch", "(", "MalformedURLException", "|", "URISyntaxException", "e", ")", "{", "valid", "=", "false", ";", "if", "(", "!", "valid", ")", "{", "throw", "new", "ValidationException", "(", "\"", "Invalid", "URL", "in", "\"", "+", "field", ")", ";", "class", "ValidationException", "extends", "Exception", "{", "public", "ValidationException", "(", "String", "message", ")", "{", "super", "(", "message", ",", "null", ",", "false", ",", "false", ")", ";", "public", "void", "createClientValidation", "(", ")", "{", "ClientRepresentation", "rep", "=", "new", "ClientRepresentation", "(", ");", "rep", ".", "setClientId", "(", "\"", "my", "-", "app", "\"", ");", "rep", ".", "setDescription", "(", "\"", "my", "-", "app", "description", "\"", ");", "rep", ".", "setEnabled", "(", "true", ")", ";", "rep", ".", "setRootUrl", "(", "\"", "invalid", "\"", ");", "createClientExpectingValidationError", "(", "rep", ",", "\"", "Invalid", "URL", "in", "rootUrl", "\"", ");", "rep", ".", "setRootUrl", "(", "null", ")", ";", "rep", ".", "setBaseUrl", "(", "\"", "invalid", "\"", ");", "createClientExpectingValidationError", "(", "rep", ",", "\"", "Invalid", "URL", "in", "baseUrl", "\"", ");", "rep", ".", "setRootUrl", "(", "null", ")", ";", "rep", ".", "setBaseUrl", "(", "\"/", "valid", "\"", ");", "createClientExpectingSuccessfulClientCreation", "(", "rep", ")", ";", "rep", ".", "setRootUrl", "(", "\"\"", ");", "rep", ".", "setBaseUrl", "(", "\"/", "valid", "\"", ");", "createClientExpectingSuccessfulClientCreation", "(", "rep", ")", ";", "public", "void", "updateClientValidation", "(", ")", "{", "ClientRepresentation", "rep", "=", "createClient", "(", ");", "rep", ".", "setClientId", "(", "\"", "my", "-", "app", "\"", ");", "rep", ".", "setDescription", "(", "\"", "my", "-", "app", "description", "\"", ");", "rep", ".", "setEnabled", "(", "true", ")", ";", "rep", ".", "setRootUrl", "(", "\"", "invalid", "\"", ");", "updateClientExpectingValidationError", "(", "rep", ",", "\"", "Invalid", "URL", "in", "rootUrl", "\"", ");", "rep", ".", "setRootUrl", "(", "null", ")", ";", "rep", ".", "setBaseUrl", "(", "\"", "invalid", "\"", ");", "updateClientExpectingValidationError", "(", "rep", ",", "\"", "Invalid", "URL", "in", "baseUrl", "\"", ");", "ClientRepresentation", "stored", "=", "realm", ".", "clients", "(", ").", "get", "(", "rep", ".", "getId", "(", "))", ".", "toRepresentation", "(", ");", "assertNull", "(", "stored", ".", "getRootUrl", "(", "))", ";", "assertNull", "(", "stored", ".", "getBaseUrl", "(", "))", ";", "rep", ".", "setRootUrl", "(", "null", ")", ";", "rep", ".", "setBaseUrl", "(", "\"/", "valid", "\"", ");", "updateClientExpectingSuccessfulClientUpdate", "(", "rep", ",", "null", ",", "\"", "/", "valid", "\"", ");", "rep", ".", "setRootUrl", "(", "\"\"", ");", "rep", ".", "setBaseUrl", "(", "\"/", "valid", "\"", ");", "updateClientExpectingSuccessfulClientUpdate", "(", "rep", ",", "\"", "\",", "\"", "/", "valid", "\"", ");", "private", "void", "createClientExpectingValidationError", "(", "ClientRepresentation", "rep", ",", "String", "expectedError", ")", "{", "Response", "response", "=", "realm", ".", "clients", "(", ").", "create", "(", "rep", ")", ";", "assertEquals", "(", "400", ",", "response", ".", "getStatus", "(", "))", ";", "OAuth2ErrorRepresentation", "error", "=", "response", ".", "readEntity", "(", "OAuth2ErrorRepresentation", ".", "class", ")", ";", "assertEquals", "(", "\"", "invalid_input", "\"", ",", "error", ".", "getError", "(", "))", ";", "assertEquals", "(", "expectedError", ",", "error", ".", "getErrorDescription", "(", "))", ";", "assertNull", "(", "response", ".", "getLocation", "(", "))", ";", "response", ".", "close", "(", ");", "}", "private", "void", "createClientExpectingSuccessfulClientCreation", "(", "ClientRepresentation", "rep", ")", "{", "Response", "response", "=", "realm", ".", "clients", "(", ").", "create", "(", "rep", ")", ";", "assertEquals", "(", "201", ",", "response", ".", "getStatus", "(", "))", ";", "String", "id", "=", "ApiUtil", ".", "getCreatedId", "(", "response", ")", ";", "realm", ".", "clients", "(", ").", "get", "(", "id", ")", ".", "remove", "(", ");", "response", ".", "close", "(", ");", "private", "void", "updateClientExpectingValidationError", "(", "ClientRepresentation", "rep", ",", "String", "expectedError", ")", "{", "try", "{", "realm", ".", "clients", "(", ").", "get", "(", "rep", ".", "getId", "(", "))", ".", "update", "(", "rep", ")", ";", "fail", "(", "\"", "Expected", "exception", "\"", ");", "}", "catch", "(", "BadRequestException", "e", ")", "{", "Response", "response", "=", "e", ".", "getResponse", "(", ");", "assertEquals", "(", "400", ",", "response", ".", "getStatus", "(", "))", ";", "OAuth2ErrorRepresentation", "error", "=", "response", ".", "readEntity", "(", "OAuth2ErrorRepresentation", ".", "class", ")", ";", "assertEquals", "(", "\"", "invalid_input", "\"", ",", "error", ".", "getError", "(", "))", ";", "assertEquals", "(", "expectedError", ",", "error", ".", "getErrorDescription", "(", "))", ";", "/", "/", "KEYCLOAK", "-", "3421", "@", "Test", "public", "void", "createClientWithFragments", "(", ")", "{", "ClientRepresentation", "client", "=", "ClientBuilder", ".", "create", "(", ")", ".", "clientId", "(", "\"", "client", "-", "with", "-", "fragment", "\"", ")", ".", "rootUrl", "(", "\"", "http", ":", "//", "localhost", "/", "base", "#", "someFragment", "\"", ")", ".", "redirectUris", "(", "\"", "http", ":", "//", "localhost", "/", "auth", "\"", ",", "\"", "http", ":", "//", "localhost", "/", "auth", "#", "fragment", "\"", ",", "\"", "http", ":", "//", "localhost", "/", "auth", "*", "\",", "\"", "/", "relative", "\"", ")", ".", "build", "(", ");", "Response", "response", "=", "realm", ".", "clients", "(", ").", "create", "(", "client", ")", ";", "assertUriFragmentError", "(", "response", ")", ";", "}", "/", "/", "KEYCLOAK", "-", "3421", "@", "Test", "public", "void", "updateClientWithFragments", "(", ")", "{", "ClientRepresentation", "client", "=", "ClientBuilder", ".", "create", "(", ")", ".", "clientId", "(", "\"", "client", "-", "with", "-", "fragment", "\"", ")", ".", "redirectUris", "(", "\"", "http", ":", "//", "localhost", "/", "auth", "\"", ",", "\"", "http", ":", "//", "localhost", "/", "auth", "*", "\")", ".", "build", "(", ");", "Response", "response", "=", "realm", ".", "clients", "(", ").", "create", "(", "client", ")", ";", "String", "clientUuid", "=", "ApiUtil", ".", "getCreatedId", "(", "response", ")", ";", "ClientResource", "clientResource", "=", "realm", ".", "clients", "(", ").", "get", "(", "clientUuid", ")", ";", "getCleanup", "(", ").", "addClientUuid", "(", "clientUuid", ")", ";", "response", ".", "close", "(", ");", "client", "=", "clientResource", ".", "toRepresentation", "(", ");", "client", ".", "setRootUrl", "(", "\"", "http", ":", "//", "localhost", "/", "base", "#", "someFragment", "\"", ");", "List", "<", "String", ">", "redirectUris", "=", "client", ".", "getRedirectUris", "(", ");", "redirectUris", ".", "add", "(", "\"", "http", ":", "//", "localhost", "/", "auth", "#", "fragment", "\"", ");", "redirectUris", ".", "add", "(", "\"/", "relative", "\"", ");", "client", ".", "setRedirectUris", "(", "redirectUris", ")", ";", "try", "{", "clientResource", ".", "update", "(", "client", ")", ";", "fail", "(", "\"", "Should", "fail", "\"", ");", "}", "catch", "(", "BadRequestException", "e", ")", "{", "assertUriFragmentError", "(", "e", ".", "getResponse", "(", "))", ";", "}", "}", "private", "void", "assertUriFragmentError", "(", "Response", "response", ")", "{", "assertEquals", "(", "response", ".", "getStatus", "(", "),", "400", ")", ";", "String", "error", "=", "response", ".", "readEntity", "(", "OAuth2ErrorRepresentation", ".", "class", ")", ".", "getError", "(", ");", "assertTrue", "(", "\"", "Error", "response", "doesn", "'", "t", "mention", "Redirect", "URIs", "fragments", "\"", ",", "error", ".", "contains", "(", "\"", "Redirect", "URIs", "must", "not", "contain", "an", "URI", "fragment", "\"", "))", ";", "assertTrue", "(", "\"", "Error", "response", "doesn", "'", "t", "mention", "Root", "URL", "fragments", "\"", ",", "error", ".", "contains", "(", "\"", "Root", "URL", "must", "not", "contain", "an", "URL", "fragment", "\"", "))", ";", "}", ".", "pairwise", "(", "\"", "http", ":", "//", "pairwise", ".", "com", "\"", "))", ".", "pairwise", "(", "\"", "http", ":", "//", "pairwise", ".", "com", "\"", ")", ".", "pairwise", "(", "\"", "http", ":", "//", "pairwise", ".", "com", "\"", ")", "import", "org", ".", "keycloak", ".", "services", ".", "clientregistration", ".", "ErrorCodes", ";", "import", "org", ".", "keycloak", ".", "testsuite", ".", "arquillian", ".", "annotation", ".", "AuthServerContainerExclude", ".", "AuthServer", ";", "public", "void", "registerClientValidation", "(", ")", "throws", "IOException", "{", "authCreateClients", "(", ");", "ClientRepresentation", "client", "=", "buildClient", "(", ");", "client", ".", "setRootUrl", "(", "\"", "invalid", "\"", ");", "try", "{", "registerClient", "(", "client", ")", ";", "}", "catch", "(", "ClientRegistrationException", "e", ")", "{", "HttpErrorException", "c", "=", "(", "HttpErrorException", ")", "e", ".", "getCause", "(", ");", "assertEquals", "(", "400", ",", "c", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "))", ";", "OAuth2ErrorRepresentation", "error", "=", "JsonSerialization", ".", "readValue", "(", "c", ".", "getErrorResponse", "(", "),", "OAuth2ErrorRepresentation", ".", "class", ")", ";", "assertEquals", "(", "\"", "invalid_client_metadata", "\"", ",", "error", ".", "getError", "(", "))", ";", "assertEquals", "(", "\"", "Invalid", "URL", "in", "rootUrl", "\"", ",", "error", ".", "getErrorDescription", "(", "))", ";", "}", "public", "void", "updateClientValidation", "(", ")", "throws", "IOException", ",", "ClientRegistrationException", "{", "registerClientAsAdmin", "(", ");", "ClientRepresentation", "client", "=", "reg", ".", "get", "(", "CLIENT_ID", ")", ";", "client", ".", "setRootUrl", "(", "\"", "invalid", "\"", ");", "try", "{", "reg", ".", "update", "(", "client", ")", ";", "}", "catch", "(", "ClientRegistrationException", "e", ")", "{", "HttpErrorException", "c", "=", "(", "HttpErrorException", ")", "e", ".", "getCause", "(", ");", "assertEquals", "(", "400", ",", "c", ".", "getStatusLine", "(", ").", "getStatusCode", "(", "))", ";", "OAuth2ErrorRepresentation", "error", "=", "JsonSerialization", ".", "readValue", "(", "c", ".", "getErrorResponse", "(", "),", "OAuth2ErrorRepresentation", ".", "class", ")", ";", "assertEquals", "(", "\"", "invalid_client_metadata", "\"", ",", "error", ".", "getError", "(", "))", ";", "assertEquals", "(", "\"", "Invalid", "URL", "in", "rootUrl", "\"", ",", "error", ".", "getErrorDescription", "(", "))", ";", "ClientRepresentation", "updatedClient", "=", "reg", ".", "get", "(", "CLIENT_ID", ")", ";", "assertNull", "(", "updatedClient", ".", "getRootUrl", "(", "))", ";"], "docstring_tokens": ["steal", "the", "victim's", "cookie-based", "authentication", "credentials"]}
{"contents": ["empty"], "code_tokens": ["struct", "file", "*", "file", ";", "int", "fput_needed", ",", "ret", ";", "file", "=", "fget_light", "(", "fd", ",", "&", "fput_needed", ")", ";", "ret", "=", "-", "EINVAL", ";", "goto", "out", ";", "goto", "out", ";", "ret", "=", "put_user", "(", "new_encode_dev", "(", "tty_devnum", "(", "real_tty", ")", "),", "ptr", ")", ";", "out", ":", "fput_light", "(", "file", ",", "fput_needed", ")", ";", "return", "ret", ";</s>struct", "file", "*", "file", "=", "fget", "(", "fd", ")", ";", "return", "-", "EINVAL", ";", "return", "-", "EINVAL", ";", "return", "put_user", "(", "new_encode_dev", "(", "tty_devnum", "(", "real_tty", ")", "),", "ptr", ")", ";"], "docstring_tokens": ["release", "the", "resources", "incorrectly", "and", "cause", "the", "kernel", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "*", "notice", "that", "we", "are", "intentionally", "putting", "the", "SELinux", "check", "before", "*", "the", "secondary", "cap_file_mmap", "check", ".", "This", "is", "such", "a", "likely", "attempt", "*", "at", "bad", "behaviour", "/", "exploit", "that", "we", "always", "want", "to", "get", "the", "AVC", ",", "even", "*", "if", "DAC", "would", "have", "also", "denied", "the", "operation", ".", "*", "/", "if", "(", "addr", "<", "mmap_min_addr", ")", "{", "if", "(", "rc", ")", "return", "rc", ";", "}", "/", "*", "do", "DAC", "check", "on", "address", "space", "usage", "*", "/", "rc", "=", "cap_file_mmap", "(", "file", ",", "reqprot", ",", "prot", ",", "flags", ",", "addr", ",", "addr_only", ")", ";</s>if", "(", "addr", "<", "mmap_min_addr", ")"], "docstring_tokens": ["gain", "elevated", "privileges", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["12", "Dec", "2013", ",", "PHP", "5", ".", "3", ".", "28", ".", "Fixed", "memory", "corruption", "in", "openssl_x509_parse", "(", ")", "(", "CVE", "-", "2013", "-", "6420", ")", ".", "(", "Stefan", "Esser", ")", ".", "if", "(", "ASN1_STRING_type", "(", "timestr", ")", "!", "=", "V_ASN1_UTCTIME", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "illegal", "ASN1", "data", "type", "for", "timestamp", "\"", ");", "if", "(", "ASN1_STRING_length", "(", "timestr", ")", "!", "=", "strlen", "(", "ASN1_STRING_data", "(", "timestr", ")", "))", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "illegal", "length", "in", "timestamp", "\"", ");", "return", "(", "time_t", ")", "-", "1", ";", "}", "if", "(", "ASN1_STRING_length", "(", "timestr", ")", "<", "13", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "unable", "to", "parse", "time", "string", "%", "s", "correctly", "\"", ",", "timestr", "-", ">", "data", ")", ";", "return", "(", "time_t", ")", "-", "1", ";", "}", "strbuf", "=", "estrdup", "(", "(", "char", "*", ")", "ASN1_STRING_data", "(", "timestr", ")", ");", "thestr", "=", "strbuf", "+", "ASN1_STRING_length", "(", "timestr", ")", "-", "3", ";", "-", "--", "--", "BEGIN", "CERTIFICATE", "-", "--", "--", "MIIEpDCCA4ygAwIBAgIJAJzu8r6u6eBcMA0GCSqGSIb3DQEBBQUAMIHDMQswCQYD", "VQQGEwJERTEcMBoGA1UECAwTTm9yZHJoZWluLVdlc3RmYWxlbjEQMA4GA1UEBwwH", "S8ODwrZsbjEUMBIGA1UECgwLU2VrdGlvbkVpbnMxHzAdBgNVBAsMFk1hbGljaW91", "cyBDZXJ0IFNlY3Rpb24xITAfBgNVBAMMGG1hbGljaW91cy5zZWt0aW9uZWlucy5k", "ZTEqMCgGCSqGSIb3DQEJARYbc3RlZmFuLmVzc2VyQHNla3Rpb25laW5zLmRlMHUY", "ZDE5NzAwMTAxMDAwMDAwWgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA", "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA", "AAAAAAAXDTE0MTEyODExMzkzNVowgcMxCzAJBgNVBAYTAkRFMRwwGgYDVQQIDBNO", "b3JkcmhlaW4tV2VzdGZhbGVuMRAwDgYDVQQHDAdLw4PCtmxuMRQwEgYDVQQKDAtT", "ZWt0aW9uRWluczEfMB0GA1UECwwWTWFsaWNpb3VzIENlcnQgU2VjdGlvbjEhMB8G", "A1UEAwwYbWFsaWNpb3VzLnNla3Rpb25laW5zLmRlMSowKAYJKoZIhvcNAQkBFhtz", "dGVmYW4uZXNzZXJAc2VrdGlvbmVpbnMuZGUwggEiMA0GCSqGSIb3DQEBAQUAA4IB", "DwAwggEKAoIBAQDDAf3hl7JY0XcFniyEJpSSDqn0OqBr6QP65usJPRt", "/", "8PaDoqBu", "wEYT", "/", "Na", "+", "6fsgPjC0uK9DZgWg2tHWWoanSblAMoz5PH6Z", "+", "S4SHRZ7e2dDIjPjdhjh", "0mLg2UMO5yp0V797Ggs9lNt6JRfH81MN2obXWs4NtztLMuD6egqpr8dDbr34aOs8", "pkdui5UawTZksy5pLPHq5cMhFGm06v65CLo0V2Pd9", "+", "KAokPrPcN5KLKebz7mLpk6", "SMeEXOKP4idEqxyQ7O7fBuHMedsQhu", "+", "prY3si3BUyKfQtP5CZnX2bp0wKHxX12DX", "1nfFIt9DbGvHTcyOuN", "+", "nZLPBm3vWxntyIIvVAgMBAAGjQjBAMAkGA1UdEwQCMAAw", "EQYJYIZIAYb4QgEBBAQDAgeAMAsGA1UdDwQEAwIFoDATBgNVHSUEDDAKBggrBgEF", "BQcDAjANBgkqhkiG9w0BAQUFAAOCAQEAG0fZYYCTbdj1XYc", "+", "1SnoaPR", "+", "vI8C8CaD", "8", "+", "0UYhdnyU4gga0BAcDrY9e94eEAu6ZqycF6FjLqXXdAboppWocr6T6GD1x33Ckl", "VArzG", "/", "KxQohGD2JeqkhIMlDomxHO7ka39", "+", "Oa8i2vWLVyjU8AZvWMAruHa4EENyG7", "lW2AagaFKFCr9TnXTfrdxGVEbv7KVQ6bdhg5p5SjpWH1", "+", "Mq03uR3ZXPBYdyV8319", "o0lVj1KFI2DCL", "/", "liWisJRoof", "+", "1cR35Ctd0wYBcpB6TZslMcOPl76dwKwJgeJo2Qg", "Zsfmc2vC1", "/", "qOlNuNq", "/", "0TzzkVGv8ETT3CgaU", "+", "UXe4XOVvkccebJn2dg", "=", "=", "-", "--", "--", "END", "CERTIFICATE", "-", "--", "--", "@", "@", "-", "0", ",", "0", "+", "1", ",", "18", "@", "@", "-", "-", "TEST", "-", "-", "CVE", "-", "2013", "-", "6420", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "\"", "openssl", "\"", "))", "die", "(", "\"", "skip", "\"", ");", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "crt", "=", "substr", "(", "__FILE__", ",", "0", ",", "-", "4", ")", ".'", ".", "crt", "'", ";", "$", "info", "=", "openssl_x509_parse", "(", "\"", "file", ":", "//", "$", "crt", "\"", ");", "var_dump", "(", "$", "info", "[", "'", "issuer", "'", "][", "'", "emailAddress", "'", "],", "$", "info", "[", "\"", "validFrom_time_t", "\"", "])", ";", "?", ">", "Done", "-", "-", "EXPECTF", "-", "-", "%", "s", "openssl_x509_parse", "(", "):", "illegal", "ASN1", "data", "type", "for", "timestamp", "in", "%", "s", "/", "cve", "-", "2013", "-", "6420", ".", "php", "on", "line", "3", "string", "(", "27", ")", "\"", "stefan", ".", "esser", "@", "sektioneins", ".", "de", "\"", "int", "(", "-", "1", ")", "Done</s>?", "?", "?", "??", "2013", ",", "PHP", "5", ".", "3", ".", "28", "-", "Openssl", ":", "if", "(", "timestr", "-", ">", "length", "<", "13", ")", "{", "php_error_docref", "(", "NULL", "TSRMLS_CC", ",", "E_WARNING", ",", "\"", "extension", "author", "too", "lazy", "to", "parse", "%", "s", "correctly", "\"", ",", "timestr", "-", ">", "data", ")", ";", "strbuf", "=", "estrdup", "(", "(", "char", "*", ")", "timestr", "-", ">", "data", ")", ";", "thestr", "=", "strbuf", "+", "timestr", "-", ">", "length", "-", "3", ";"], "docstring_tokens": ["execute", "arbitrary", "code", "or", "cause", "a", "denial", "of", "service", "(memory", "corruption", ")"]}
{"contents": ["empty"], "code_tokens": ["public", "boolean", "isEmpty", "(", ")", "{", "return", "clusterPrivileges", ".", "length", "=", "=", "0", "&", "&", "configurableClusterPrivileges", ".", "length", "=", "=", "0", "&", "&", "indicesPrivileges", ".", "length", "=", "=", "0", "&", "&", "applicationPrivileges", ".", "length", "=", "=", "0", "&", "&", "runAs", ".", "length", "=", "=", "0", "&", "&", "metadata", ".", "size", "(", ")", "=", "=", "0", ";", "}", "if", "(", "Authentication", ".", "AuthenticationType", ".", "API_KEY", "=", "=", "authentication", ".", "getAuthenticationType", "(", ")", "&", "&", "grantsAnyPrivileges", "(", "request", ")", ")", "{", "listener", ".", "onFailure", "(", "new", "IllegalArgumentException", "(", "\"", "creating", "derived", "api", "keys", "requires", "an", "explicit", "role", "descriptor", "that", "is", "empty", "(", "has", "no", "privileges", ")", "\")", ");", "return", ";", "}", "private", "boolean", "grantsAnyPrivileges", "(", "CreateApiKeyRequest", "request", ")", "{", "return", "request", ".", "getRoleDescriptors", "(", ")", "=", "=", "null", "|", "|", "request", ".", "getRoleDescriptors", "(", ").", "isEmpty", "(", ")", "|", "|", "false", "=", "=", "request", ".", "getRoleDescriptors", "(", ").", "stream", "(", ").", "allMatch", "(", "RoleDescriptor", ":", ":", "isEmpty", ")", ";", "}", "import", "org", ".", "elasticsearch", ".", "action", ".", "admin", ".", "indices", ".", "refresh", ".", "RefreshAction", ";", "import", "org", ".", "elasticsearch", ".", "action", ".", "admin", ".", "indices", ".", "refresh", ".", "RefreshRequestBuilder", ";", "public", "void", "testDerivedKeys", "(", ")", "throws", "ExecutionException", ",", "InterruptedException", "{", "final", "Client", "client", "=", "client", "(", ").", "filterWithHeader", "(", "Collections", ".", "singletonMap", "(", "\"", "Authorization", "\"", ",", "UsernamePasswordToken", ".", "basicAuthHeaderValue", "(", "SecuritySettingsSource", ".", "TEST_SUPERUSER", ",", "SecuritySettingsSourceField", ".", "TEST_PASSWORD_SECURE_STRING", ")", "))", ";", "final", "CreateApiKeyResponse", "response", "=", "new", "SecurityClient", "(", "client", ")", ".", "prepareCreateApiKey", "(", ")", ".", "setName", "(", "\"", "key", "-", "1", "\"", ")", ".", "setRoleDescriptors", "(", "Collections", ".", "singletonList", "(", "new", "RoleDescriptor", "(", "\"", "role", "\"", ",", "new", "String", "[", "]", "{", "\"", "manage_api_key", "\"", "}", ",", "null", ",", "null", ")", "))", ".", "get", "(", ");", "assertEquals", "(", "\"", "key", "-", "1", "\"", ",", "response", ".", "getName", "(", "))", ";", "assertNotNull", "(", "response", ".", "getId", "(", "))", ";", "assertNotNull", "(", "response", ".", "getKey", "(", "))", ";", "/", "/", "use", "the", "first", "ApiKey", "for", "authorized", "action", "final", "String", "base64ApiKeyKeyValue", "=", "Base64", ".", "getEncoder", "(", ").", "encodeToString", "(", "(", "response", ".", "getId", "(", ")", "+", "\"", ":\"", "+", "response", ".", "getKey", "(", ").", "toString", "(", "))", ".", "getBytes", "(", "StandardCharsets", ".", "UTF_8", ")", ");", "final", "SecurityClient", "clientKey1", "=", "new", "SecurityClient", "(", "client", "(", ").", "filterWithHeader", "(", "Collections", ".", "singletonMap", "(", "\"", "Authorization", "\"", ",", "\"", "ApiKey", "\"", "+", "base64ApiKeyKeyValue", ")", "))", ";", "final", "String", "expectedMessage", "=", "\"", "creating", "derived", "api", "keys", "requires", "an", "explicit", "role", "descriptor", "that", "is", "empty", "\"", ";", "final", "IllegalArgumentException", "e1", "=", "expectThrows", "(", "IllegalArgumentException", ".", "class", ",", "(", ")", "-", ">", "clientKey1", ".", "prepareCreateApiKey", "(", ").", "setName", "(", "\"", "key", "-", "2", "\"", ").", "get", "(", "))", ";", "assertThat", "(", "e1", ".", "getMessage", "(", "),", "containsString", "(", "expectedMessage", ")", ");", "final", "IllegalArgumentException", "e2", "=", "expectThrows", "(", "IllegalArgumentException", ".", "class", ",", "(", ")", "-", ">", "clientKey1", ".", "prepareCreateApiKey", "(", ").", "setName", "(", "\"", "key", "-", "3", "\"", ")", ".", "setRoleDescriptors", "(", "Collections", ".", "emptyList", "(", "))", ".", "get", "(", "))", ";", "assertThat", "(", "e2", ".", "getMessage", "(", "),", "containsString", "(", "expectedMessage", ")", ");", "final", "IllegalArgumentException", "e3", "=", "expectThrows", "(", "IllegalArgumentException", ".", "class", ",", "(", ")", "-", ">", "clientKey1", ".", "prepareCreateApiKey", "(", ").", "setName", "(", "\"", "key", "-", "4", "\"", ")", ".", "setRoleDescriptors", "(", "Collections", ".", "singletonList", "(", "new", "RoleDescriptor", "(", "\"", "role", "\"", ",", "new", "String", "[", "]", "{", "\"", "manage_own_api_key", "\"", "},", "null", ",", "null", ")", ")", ").", "get", "(", "))", ";", "assertThat", "(", "e3", ".", "getMessage", "(", "),", "containsString", "(", "expectedMessage", ")", ");", "final", "List", "<", "RoleDescriptor", ">", "roleDescriptors", "=", "randomList", "(", "2", ",", "10", ",", "(", ")", "-", ">", "new", "RoleDescriptor", "(", "\"", "role", "\"", ",", "null", ",", "null", ",", "null", ")", ");", "roleDescriptors", ".", "set", "(", "randomInt", "(", "roleDescriptors", ".", "size", "(", ")", "-", "1", ")", ",", "new", "RoleDescriptor", "(", "\"", "role", "\"", ",", "new", "String", "[", "]", "{", "\"", "manage_own_api_key", "\"", "},", "null", ",", "null", ")", ");", "final", "IllegalArgumentException", "e4", "=", "expectThrows", "(", "IllegalArgumentException", ".", "class", ",", "(", ")", "-", ">", "clientKey1", ".", "prepareCreateApiKey", "(", ").", "setName", "(", "\"", "key", "-", "5", "\"", ")", ".", "setRoleDescriptors", "(", "roleDescriptors", ")", ".", "get", "(", "))", ";", "assertThat", "(", "e4", ".", "getMessage", "(", "),", "containsString", "(", "expectedMessage", ")", ");", "final", "CreateApiKeyResponse", "key100Response", "=", "clientKey1", ".", "prepareCreateApiKey", "(", ").", "setName", "(", "\"", "key", "-", "100", "\"", ")", ".", "setRoleDescriptors", "(", "Collections", ".", "singletonList", "(", "new", "RoleDescriptor", "(", "\"", "role", "\"", ",", "null", ",", "null", ",", "null", ")", ")", ").", "get", "(", ");", "assertEquals", "(", "\"", "key", "-", "100", "\"", ",", "key100Response", ".", "getName", "(", "))", ";", "assertNotNull", "(", "key100Response", ".", "getId", "(", "))", ";", "assertNotNull", "(", "key100Response", ".", "getKey", "(", "))", ";", "/", "/", "Check", "at", "the", "end", "to", "allow", "sometime", "for", "the", "operation", "to", "happen", ".", "Since", "an", "erroneous", "creation", "is", "/", "/", "asynchronous", "so", "that", "the", "document", "is", "not", "available", "immediately", ".", "assertApiKeyNotCreated", "(", "client", ",", "\"", "key", "-", "2", "\"", ");", "assertApiKeyNotCreated", "(", "client", ",", "\"", "key", "-", "3", "\"", ");", "assertApiKeyNotCreated", "(", "client", ",", "\"", "key", "-", "4", "\"", ");", "assertApiKeyNotCreated", "(", "client", ",", "\"", "key", "-", "5", "\"", ");", "}", "private", "void", "assertApiKeyNotCreated", "(", "Client", "client", ",", "String", "keyName", ")", "throws", "ExecutionException", ",", "InterruptedException", "{", "new", "RefreshRequestBuilder", "(", "client", ",", "RefreshAction", ".", "INSTANCE", ")", ".", "setIndices", "(", "SECURITY_MAIN_ALIAS", ")", ".", "execute", "(", ").", "get", "(", ");", "PlainActionFuture", "<", "GetApiKeyResponse", ">", "getApiKeyResponseListener", "=", "new", "PlainActionFuture", "<", ">(", ");", "new", "SecurityClient", "(", "client", ")", ".", "getApiKey", "(", "GetApiKeyRequest", ".", "usingApiKeyName", "(", "keyName", ",", "false", ")", ",", "getApiKeyResponseListener", ")", ";", "assertEquals", "(", "0", ",", "getApiKeyResponseListener", ".", "get", "(", ").", "getApiKeyInfos", "(", ").", "length", ")", ";", "}", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "List", ";", "public", "void", "testIsEmpty", "(", ")", "{", "assertTrue", "(", "new", "RoleDescriptor", "(", "randomAlphaOfLengthBetween", "(", "1", ",", "10", ")", ",", "null", ",", "null", ",", "null", ",", "null", ",", "null", ",", "null", ",", "null", ")", ".", "isEmpty", "(", "))", ";", "assertTrue", "(", "new", "RoleDescriptor", "(", "randomAlphaOfLengthBetween", "(", "1", ",", "10", ")", ",", "new", "String", "[", "0", "]", ",", "new", "RoleDescriptor", ".", "IndicesPrivileges", "[", "0", "]", ",", "new", "RoleDescriptor", ".", "ApplicationResourcePrivileges", "[", "0", "]", ",", "new", "ConfigurableClusterPrivilege", "[", "0", "]", ",", "new", "String", "[", "0", "]", ",", "new", "HashMap", "<", ">(", "),", "new", "HashMap", "<", ">(", "))", ".", "isEmpty", "(", "))", ";", "final", "List", "<", "Boolean", ">", "booleans", "=", "Arrays", ".", "asList", "(", "randomBoolean", "(", "),", "randomBoolean", "(", "),", "randomBoolean", "(", "),", "randomBoolean", "(", "),", "randomBoolean", "(", "),", "randomBoolean", "(", "))", ";", "final", "RoleDescriptor", "roleDescriptor", "=", "new", "RoleDescriptor", "(", "randomAlphaOfLengthBetween", "(", "1", ",", "10", ")", ",", "booleans", ".", "get", "(", "0", ")", "?", "new", "String", "[", "0", "]", ":", "new", "String", "[", "]", "{", "\"", "foo", "\"", "}", ",", "booleans", ".", "get", "(", "1", ")", "?", "new", "RoleDescriptor", ".", "IndicesPrivileges", "[", "0", "]", ":", "new", "RoleDescriptor", ".", "IndicesPrivileges", "[", "]", "{", "RoleDescriptor", ".", "IndicesPrivileges", ".", "builder", "(", ").", "indices", "(", "\"", "idx", "\"", ").", "privileges", "(", "\"", "foo", "\"", ").", "build", "(", ")", "}", ",", "booleans", ".", "get", "(", "2", ")", "?", "new", "RoleDescriptor", ".", "ApplicationResourcePrivileges", "[", "0", "]", ":", "new", "RoleDescriptor", ".", "ApplicationResourcePrivileges", "[", "]", "{", "RoleDescriptor", ".", "ApplicationResourcePrivileges", ".", "builder", "(", ")", ".", "application", "(", "\"", "app", "\"", ").", "privileges", "(", "\"", "foo", "\"", ").", "resources", "(", "\"", "res", "\"", ").", "build", "(", ")", "}", ",", "booleans", ".", "get", "(", "3", ")", "?", "new", "ConfigurableClusterPrivilege", "[", "0", "]", ":", "new", "ConfigurableClusterPrivilege", "[", "]", "{", "new", "ConfigurableClusterPrivileges", ".", "ManageApplicationPrivileges", "(", "Collections", ".", "singleton", "(", "\"", "foo", "\"", "))", "}", ",", "booleans", ".", "get", "(", "4", ")", "?", "new", "String", "[", "0", "]", ":", "new", "String", "[", "]", "{", "\"", "foo", "\"", "}", ",", "booleans", ".", "get", "(", "5", ")", "?", "new", "HashMap", "<", ">(", ")", ":", "Collections", ".", "singletonMap", "(", "\"", "foo", "\"", ",", "\"", "bar", "\"", "),", "Collections", ".", "singletonMap", "(", "\"", "foo", "\"", ",", "\"", "bar", "\"", "))", ";", "if", "(", "booleans", ".", "stream", "(", ").", "anyMatch", "(", "e", "-", ">", "e", ".", "equals", "(", "false", ")", "))", "{", "assertFalse", "(", "roleDescriptor", ".", "isEmpty", "(", "))", ";", "}", "else", "{", "assertTrue", "(", "roleDescriptor", ".", "isEmpty", "(", "))", ";", "}", "}</s>"], "docstring_tokens": ["escalate", "privileges"]}
{"contents": ["empty"], "code_tokens": ["bool", "current_chrooted", "(", "void", ")", "{", "/", "*", "Does", "the", "current", "process", "have", "a", "non", "-", "standard", "root", "*", "/", "struct", "path", "ns_root", ";", "struct", "path", "fs_root", ";", "bool", "chrooted", ";", "/", "*", "Find", "the", "namespace", "root", "*", "/", "ns_root", ".", "mnt", "=", "&", "current", "-", ">", "nsproxy", "-", ">", "mnt_ns", "-", ">", "root", "-", ">", "mnt", ";", "ns_root", ".", "dentry", "=", "ns_root", ".", "mnt", "-", ">", "mnt_root", ";", "path_get", "(", "&", "ns_root", ")", ";", "while", "(", "d_mountpoint", "(", "ns_root", ".", "dentry", ")", "&", "&", "follow_down_one", "(", "&", "ns_root", ")", ")", ";", "get_fs_root", "(", "current", "-", ">", "fs", ",", "&", "fs_root", ")", ";", "chrooted", "=", "!", "path_equal", "(", "&", "fs_root", ",", "&", "ns_root", ")", ";", "path_put", "(", "&", "fs_root", ")", ";", "path_put", "(", "&", "ns_root", ")", ";", "return", "chrooted", ";", "}", "extern", "bool", "current_chrooted", "(", "void", ")", ";", "/", "*", "*", "Verify", "that", "we", "can", "not", "violate", "the", "policy", "of", "which", "files", "*", "may", "be", "accessed", "that", "is", "specified", "by", "the", "root", "directory", ",", "*", "by", "verifing", "that", "the", "root", "directory", "is", "at", "the", "root", "of", "the", "*", "mount", "namespace", "which", "allows", "all", "files", "to", "be", "accessed", ".", "*", "/", "if", "(", "current_chrooted", "(", "))", "return", "-", "EPERM", ";</s>"], "docstring_tokens": ["bypass", "intended", "filesystem", "restrictions"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "EVP_SealInit", "(", "ctx", ",", "cipher", ",", "eks", ",", "eksl", ",", "&", "iv_buf", "[", "0", "]", ",", "pkeys", ",", "nkeys", ")", "<", "=", "0", "|", "|", "-", "--", "--", "BEGIN", "CERTIFICATE", "-", "--", "--", "MIIEoDCCBAmgAwIBAgIBJzANBgkqhkiG9w0BAQQFADCBkDELMAkGA1UEFhMCUk8x", "EDAOBgNVBAgTB1JvbWFuaWExEDAOBgNVBAcTB0NyYWlvdmExDzANBgNVBAoTBlNl", "cmdpdTETMBEGA1UECxMKU2VyZ2l1IFNSTDESMBAGA1UEAxMJU2VyZ2l1IENBMSMw", "IQYJKoZIhvcNAQkBFhRuX3NlcmdpdUBob3RtYWlsLmNvbTAeFw0wNDA1MTQxMzM0", "NTZaFw0wNTA1MTQxMzM0NTZaMIGaMQswCQYDVQQGEwJSTzEQMA4GA1UECBMHUm9t", "YW5pYTEQMA4GA1UEBxMHQ3JhaW92YTETMBEGA1UEChMKU2VyZ2l1IFNSTDETMBEG", "A1UECxMKU2VyZ2l1IFNSTDEYMBYGA1UEAxMPU2VyZ2l1IHBlcnNvbmFsMSMwIQYJ", "KoZIhvcNAQkBFhRuX3NlcmdpdUBob3RtYWlsLmNvbTCBnzANBgkqhkiG9w0BAQEF", "AAOBjQAwgYkCgYEApNj7XXz8T8FcLIWpBniPYom3QcT6T7u0xRPHqtqzj5oboBYp", "DJe5d354", "/", "y0gJTpiLt8", "+", "fTrPgWXnbHm3pOHgXzTcX6Arani0GDU0", "/", "xDi4VkCRGcS", "YqX2sJpcDzAbmK9UDMt3xf", "/", "O1B8AJan3RfO0Bm3ozTEPziLMkmsiYr5b", "/", "L4CAwEA", "AaOCAfwwggH4MAkGA1UdEwQCMAAwNQYJYIZIAYb4QgENBCgWJkZvciBHcmlkIHVz", "ZSBvbmx5OyByZXF1ZXN0IHRhZyB1c2VyVGFnMBEGCWCGSAGG", "+", "EIBAQQEAwIF4DA", "/", "BgNVHR8EODA2MDSgMqAwhi5odHRwOi8vbW9iaWxlLmJsdWUtc29mdHdhcmUucm86", "OTAvY2EvY3JsLnNodG1sMDUGCWCGSAGG", "+", "EIBCAQoFiZodHRwOi8vbW9iaWxlLmJs", "dWUtc29mdHdhcmUucm86OTAvcHViLzAhBgNVHREEGjAYgRZzZXJnaXVAYmx1ZXNv", "ZnR3YXJlLnJvMB0GA1UdDgQWBBSwp", "/", "/", "5QRXeIzm93TEPl6CyonTg", "/", "DCBpwYDVR0j", "BIGfMIGcoYGWpIGTMIGQMQswCQYDVQQGEwJSTzEQMA4GA1UECBMHUm9tYW5pYTEQ", "MA4GA1UEBxMHQ3JhaW92YTEPMA0GA1UEChMGU2VyZ2l1MRMwEQYDVQQLEwpTZXJn", "aXUgU1JMMRIwEAYDVQQDEwlTZXJnaXUgQ0ExIzAhBgkqhkiG9w0BCQEWFG5fc2Vy", "Z2l1QGhvdG1haWwuY29tggEAMAsGA1UdDwQEAwIE8DAjBglghkgBhvhCAQIEFhYU", "aHR0cDovLzYyLjIzMS45OC41Mi8wCwYDKgMEBAQ", "+", "52I0MA0GCSqGSIb3DQEBBAUA", "A4GBAIBIOJ", "+", "iiLyQfNJEY", "+", "IMefayQea0nmuXYY", "+", "F", "+", "L1DFjSC7xChytgYoPNnKkhh", "3dWPtxbswiqKYUnGi6y3Hi4UhDsOaDW29t2S305hSc2qgjOiNtRYQIVYQ8EHG1k7", "Fl63S7uCOhnVJt", "+", "4MnUK1N6", "/", "pwgsp", "+", "Z2GvEsDG1qCKnvNpf6", "-", "--", "--", "END", "CERTIFICATE", "-", "--", "--", "@", "@", "-", "0", ",", "0", "+", "1", ",", "17", "@", "@", "-", "-", "TEST", "-", "-", "Bug", "#", "74651", ":", "negative", "-", "size", "-", "param", "(", "-", "1", ")", "in", "memcpy", "in", "zif_openssl_seal", "(", ")", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "\"", "openssl", "\"", "))", "die", "(", "\"", "skip", "openssl", "not", "loaded", "\"", ");", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "inputstr", "=", "file_get_contents", "(", "__DIR__", ".", "\"", "/", "74651", ".", "pem", "\"", ");", "$", "pub_key_id", "=", "openssl_get_publickey", "(", "$", "inputstr", ")", ";", "var_dump", "(", "$", "pub_key_id", ")", ";", "var_dump", "(", "openssl_seal", "(", "$", "inputstr", ",", "$", "sealed", ",", "$", "ekeys", ",", "array", "(", "$", "pub_key_id", ",", "$", "pub_key_id", ")", ",", "'", "AES", "-", "128", "-", "ECB", "'", "))", ";", "?", ">", "-", "-", "EXPECTF", "-", "-", "resource", "(", "%", "d", ")", "of", "type", "(", "OpenSSL", "key", ")", "bool", "(", "false", ")</s>if", "(", "!", "EVP_SealInit", "(", "ctx", ",", "cipher", ",", "eks", ",", "eksl", ",", "&", "iv_buf", "[", "0", "]", ",", "pkeys", ",", "nkeys", ")", "|", "|"], "docstring_tokens": ["a", "crash", "of", "the", "PHP", "interpreter"]}
{"contents": ["empty"], "code_tokens": ["*", "Used", "for", "descriptor", "reading", ".", "unsigned", "int", "bytes", ",", "struct", "kvm_vcpu", "*", "vcpu", ",", "u32", "*", "error", ")", ";", "/", "*", "*", "fetch", ":", "Read", "bytes", "of", "standard", "(", "non", "-", "emulated", "/", "special", ")", "memory", ".", "*", "Used", "for", "instruction", "fetch", ".", "*", "@", "addr", ":", "[", "IN", "]", "Linear", "address", "from", "which", "to", "read", ".", "*", "@", "val", ":", "[", "OUT", "]", "Value", "read", "from", "memory", ",", "zero", "-", "extended", "to", "'", "u_long", "'", ".", "*", "@", "bytes", ":", "[", "IN", "]", "Number", "of", "bytes", "to", "read", "from", "memory", ".", "*", "/", "int", "(", "*", "fetch", ")", "(", "unsigned", "long", "addr", ",", "void", "*", "val", ",", "unsigned", "int", "bytes", ",", "struct", "kvm_vcpu", "*", "vcpu", ",", "u32", "*", "error", ")", ";", "gpa_t", "(", "*", "gva_to_gpa", ")", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "gva_t", "gva", ",", "u32", "access", ",", "u32", "*", "error", ")", ";", "gpa_t", "kvm_mmu_gva_to_gpa_read", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "gva_t", "gva", ",", "u32", "*", "error", ")", ";", "gpa_t", "kvm_mmu_gva_to_gpa_fetch", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "gva_t", "gva", ",", "u32", "*", "error", ")", ";", "gpa_t", "kvm_mmu_gva_to_gpa_write", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "gva_t", "gva", ",", "u32", "*", "error", ")", ";", "gpa_t", "kvm_mmu_gva_to_gpa_system", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "gva_t", "gva", ",", "u32", "*", "error", ")", ";", "rc", "=", "ops", "-", ">", "fetch", "(", "linear", ",", "fc", "-", ">", "data", ",", "size", ",", "ctxt", "-", ">", "vcpu", ",", "NULL", ")", ";", "ctxt", "-", ">", "vcpu", ",", "NULL", ")", ";", "ctxt", "-", ">", "vcpu", ",", "NULL", ")", ";", "gpa_t", "gpa", "=", "kvm_mmu_gva_to_gpa_read", "(", "vcpu", ",", "gva", ",", "NULL", ")", ";", "static", "gpa_t", "nonpaging_gva_to_gpa", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "gva_t", "vaddr", ",", "u32", "access", ",", "u32", "*", "error", ")", "if", "(", "error", ")", "*", "error", "=", "0", ";", "gpa", "=", "kvm_mmu_gva_to_gpa_read", "(", "vcpu", ",", "gva", ",", "NULL", ")", ";", "gpa_t", "gpa", "=", "kvm_mmu_gva_to_gpa_read", "(", "vcpu", ",", "va", ",", "NULL", ")", ";", "#", "define", "PFERR_PRESENT_MASK", "(", "1U", "<", "<", "0", ")", "#", "define", "PFERR_WRITE_MASK", "(", "1U", "<", "<", "1", ")", "#", "define", "PFERR_USER_MASK", "(", "1U", "<", "<", "2", ")", "#", "define", "PFERR_RSVD_MASK", "(", "1U", "<", "<", "3", ")", "#", "define", "PFERR_FETCH_MASK", "(", "1U", "<", "<", "4", ")", "static", "gpa_t", "FNAME", "(", "gva_to_gpa", ")", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "gva_t", "vaddr", ",", "u32", "access", ",", "u32", "*", "error", ")", "r", "=", "FNAME", "(", "walk_addr", ")", "(&", "walker", ",", "vcpu", ",", "vaddr", ",", "!", "!(", "access", "&", "PFERR_WRITE_MASK", ")", ",", "!", "!(", "access", "&", "PFERR_USER_MASK", ")", ",", "!", "!(", "access", "&", "PFERR_FETCH_MASK", ")", ");", "}", "else", "if", "(", "error", ")", "*", "error", "=", "walker", ".", "error_code", ";", "gpa_t", "kvm_mmu_gva_to_gpa_read", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "gva_t", "gva", ",", "u32", "*", "error", ")", "{", "u32", "access", "=", "(", "kvm_x86_ops", "-", ">", "get_cpl", "(", "vcpu", ")", "=", "=", "3", ")", "?", "PFERR_USER_MASK", ":", "0", ";", "return", "vcpu", "-", ">", "arch", ".", "mmu", ".", "gva_to_gpa", "(", "vcpu", ",", "gva", ",", "access", ",", "error", ")", ";", "}", "gpa_t", "kvm_mmu_gva_to_gpa_fetch", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "gva_t", "gva", ",", "u32", "*", "error", ")", "{", "u32", "access", "=", "(", "kvm_x86_ops", "-", ">", "get_cpl", "(", "vcpu", ")", "=", "=", "3", ")", "?", "PFERR_USER_MASK", ":", "0", ";", "access", "|", "=", "PFERR_FETCH_MASK", ";", "return", "vcpu", "-", ">", "arch", ".", "mmu", ".", "gva_to_gpa", "(", "vcpu", ",", "gva", ",", "access", ",", "error", ")", ";", "}", "gpa_t", "kvm_mmu_gva_to_gpa_write", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "gva_t", "gva", ",", "u32", "*", "error", ")", "{", "u32", "access", "=", "(", "kvm_x86_ops", "-", ">", "get_cpl", "(", "vcpu", ")", "=", "=", "3", ")", "?", "PFERR_USER_MASK", ":", "0", ";", "access", "|", "=", "PFERR_WRITE_MASK", ";", "return", "vcpu", "-", ">", "arch", ".", "mmu", ".", "gva_to_gpa", "(", "vcpu", ",", "gva", ",", "access", ",", "error", ")", ";", "}", "/", "*", "uses", "this", "to", "access", "any", "guest", "'", "s", "mapped", "memory", "without", "checking", "CPL", "*", "/", "gpa_t", "kvm_mmu_gva_to_gpa_system", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "gva_t", "gva", ",", "u32", "*", "error", ")", "{", "return", "vcpu", "-", ">", "arch", ".", "mmu", ".", "gva_to_gpa", "(", "vcpu", ",", "gva", ",", "0", ",", "error", ")", ";", "}", "static", "int", "kvm_read_guest_virt_helper", "(", "gva_t", "addr", ",", "void", "*", "val", ",", "unsigned", "int", "bytes", ",", "struct", "kvm_vcpu", "*", "vcpu", ",", "u32", "access", ",", "u32", "*", "error", ")", "gpa_t", "gpa", "=", "vcpu", "-", ">", "arch", ".", "mmu", ".", "gva_to_gpa", "(", "vcpu", ",", "addr", ",", "access", ",", "error", ")", ";", "/", "*", "used", "for", "instruction", "fetching", "*", "/", "static", "int", "kvm_fetch_guest_virt", "(", "gva_t", "addr", ",", "void", "*", "val", ",", "unsigned", "int", "bytes", ",", "struct", "kvm_vcpu", "*", "vcpu", ",", "u32", "*", "error", ")", "{", "u32", "access", "=", "(", "kvm_x86_ops", "-", ">", "get_cpl", "(", "vcpu", ")", "=", "=", "3", ")", "?", "PFERR_USER_MASK", ":", "0", ";", "return", "kvm_read_guest_virt_helper", "(", "addr", ",", "val", ",", "bytes", ",", "vcpu", ",", "access", "|", "PFERR_FETCH_MASK", ",", "error", ")", ";", "}", "static", "int", "kvm_read_guest_virt", "(", "gva_t", "addr", ",", "void", "*", "val", ",", "unsigned", "int", "bytes", ",", "struct", "kvm_vcpu", "*", "vcpu", ",", "u32", "*", "error", ")", "{", "u32", "access", "=", "(", "kvm_x86_ops", "-", ">", "get_cpl", "(", "vcpu", ")", "=", "=", "3", ")", "?", "PFERR_USER_MASK", ":", "0", ";", "return", "kvm_read_guest_virt_helper", "(", "addr", ",", "val", ",", "bytes", ",", "vcpu", ",", "access", ",", "error", ")", ";", "}", "static", "int", "kvm_read_guest_virt_system", "(", "gva_t", "addr", ",", "void", "*", "val", ",", "unsigned", "int", "bytes", ",", "struct", "kvm_vcpu", "*", "vcpu", ",", "u32", "*", "error", ")", "{", "return", "kvm_read_guest_virt_helper", "(", "addr", ",", "val", ",", "bytes", ",", "vcpu", ",", "0", ",", "error", ")", ";", "}", "struct", "kvm_vcpu", "*", "vcpu", ",", "u32", "*", "error", ")", "gpa_t", "gpa", "=", "kvm_mmu_gva_to_gpa_write", "(", "vcpu", ",", "addr", ",", "error", ")", ";", "u32", "error_code", ";", "gpa", "=", "kvm_mmu_gva_to_gpa_read", "(", "vcpu", ",", "addr", ",", "&", "error_code", ")", ";", "if", "(", "gpa", "=", "=", "UNMAPPED_GVA", ")", "{", "kvm_inject_page_fault", "(", "vcpu", ",", "addr", ",", "error_code", ")", ";", "return", "X86EMUL_PROPAGATE_FAULT", ";", "}", "if", "(", "kvm_read_guest_virt", "(", "addr", ",", "val", ",", "bytes", ",", "vcpu", ",", "NULL", ")", "u32", "error_code", ";", "gpa", "=", "kvm_mmu_gva_to_gpa_write", "(", "vcpu", ",", "addr", ",", "&", "error_code", ")", ";", "kvm_inject_page_fault", "(", "vcpu", ",", "addr", ",", "error_code", ")", ";", "gpa", "=", "kvm_mmu_gva_to_gpa_write", "(", "vcpu", ",", "addr", ",", "NULL", ")", ";", "kvm_read_guest_virt", "(", "rip_linear", ",", "(", "void", "*", ")", "opcodes", ",", "4", ",", "vcpu", ",", "NULL", ")", ";", ".", "read_std", "=", "kvm_read_guest_virt_system", ",", ".", "fetch", "=", "kvm_fetch_guest_virt", ",", "u32", "error_code", ";", "ret", "=", "kvm_write_guest_virt", "(", "q", ",", "p", ",", "bytes", ",", "vcpu", ",", "&", "error_code", ")", ";", "ret", "=", "kvm_read_guest_virt", "(", "q", ",", "p", ",", "bytes", ",", "vcpu", ",", "&", "error_code", ")", ";", "if", "(", "ret", "=", "=", "X86EMUL_PROPAGATE_FAULT", ")", "kvm_inject_page_fault", "(", "vcpu", ",", "q", ",", "error_code", ")", ";", "goto", "out", ";", "out", ":", "if", "(", "ret", "=", "=", "X86EMUL_PROPAGATE_FAULT", ")", "return", "kvm_read_guest_virt_system", "(", "dtable", ".", "base", "+", "index", "*", "8", ",", "seg_desc", ",", "sizeof", "(", "*", "seg_desc", ")", ",", "vcpu", ",", "NULL", ")", ";", "return", "kvm_write_guest_virt", "(", "dtable", ".", "base", "+", "index", "*", "8", ",", "seg_desc", ",", "sizeof", "(", "*", "seg_desc", ")", ",", "vcpu", ",", "NULL", ")", ";", "}", "static", "gpa_t", "get_tss_base_addr_write", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "struct", "desc_struct", "*", "seg_desc", ")", "{", "u32", "base_addr", "=", "get_desc_base", "(", "seg_desc", ")", ";", "return", "kvm_mmu_gva_to_gpa_write", "(", "vcpu", ",", "base_addr", ",", "NULL", ")", ";", "static", "gpa_t", "get_tss_base_addr_read", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "return", "kvm_mmu_gva_to_gpa_read", "(", "vcpu", ",", "base_addr", ",", "NULL", ")", ";", "if", "(", "kvm_read_guest", "(", "vcpu", "-", ">", "kvm", ",", "get_tss_base_addr_read", "(", "vcpu", ",", "nseg_desc", ")", ",", "get_tss_base_addr_write", "(", "vcpu", ",", "nseg_desc", ")", ",", "if", "(", "kvm_read_guest", "(", "vcpu", "-", ">", "kvm", ",", "get_tss_base_addr_read", "(", "vcpu", ",", "nseg_desc", ")", ",", "get_tss_base_addr_write", "(", "vcpu", ",", "nseg_desc", ")", ",", "old_tss_base", "=", "kvm_mmu_gva_to_gpa_write", "(", "vcpu", ",", "old_tss_base", ",", "NULL", ")", ";", "gpa", "=", "kvm_mmu_gva_to_gpa_system", "(", "vcpu", ",", "vaddr", ",", "NULL", ")", ";</s>*", "Used", "for", "instruction", "fetch", ",", "stack", "operations", ",", "and", "others", ".", "unsigned", "int", "bytes", ",", "struct", "kvm_vcpu", "*", "vcpu", ")", ";", "gpa_t", "(", "*", "gva_to_gpa", ")", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "gva_t", "gva", ")", ";", "rc", "=", "ops", "-", ">", "read_std", "(", "linear", ",", "fc", "-", ">", "data", ",", "size", ",", "ctxt", "-", ">", "vcpu", ")", ";", "ctxt", "-", ">", "vcpu", ")", ";", "ctxt", "-", ">", "vcpu", ")", ";", "#", "define", "PFERR_PRESENT_MASK", "(", "1U", "<", "<", "0", ")", "#", "define", "PFERR_WRITE_MASK", "(", "1U", "<", "<", "1", ")", "#", "define", "PFERR_USER_MASK", "(", "1U", "<", "<", "2", ")", "#", "define", "PFERR_RSVD_MASK", "(", "1U", "<", "<", "3", ")", "#", "define", "PFERR_FETCH_MASK", "(", "1U", "<", "<", "4", ")", "gpa_t", "gpa", "=", "vcpu", "-", ">", "arch", ".", "mmu", ".", "gva_to_gpa", "(", "vcpu", ",", "gva", ")", ";", "static", "gpa_t", "nonpaging_gva_to_gpa", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "gva_t", "vaddr", ")", "gpa", "=", "vcpu", "-", ">", "arch", ".", "mmu", ".", "gva_to_gpa", "(", "vcpu", ",", "gva", ")", ";", "gpa_t", "gpa", "=", "vcpu", "-", ">", "arch", ".", "mmu", ".", "gva_to_gpa", "(", "vcpu", ",", "va", ")", ";", "static", "gpa_t", "FNAME", "(", "gva_to_gpa", ")", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "gva_t", "vaddr", ")", "r", "=", "FNAME", "(", "walk_addr", ")", "(&", "walker", ",", "vcpu", ",", "vaddr", ",", "0", ",", "0", ",", "0", ")", ";", "}", "static", "int", "kvm_read_guest_virt", "(", "gva_t", "addr", ",", "void", "*", "val", ",", "unsigned", "int", "bytes", ",", "struct", "kvm_vcpu", "*", "vcpu", ")", "gpa_t", "gpa", "=", "vcpu", "-", ">", "arch", ".", "mmu", ".", "gva_to_gpa", "(", "vcpu", ",", "addr", ")", ";", "struct", "kvm_vcpu", "*", "vcpu", ")", "gpa_t", "gpa", "=", "vcpu", "-", ">", "arch", ".", "mmu", ".", "gva_to_gpa", "(", "vcpu", ",", "addr", ")", ";", "gpa", "=", "vcpu", "-", ">", "arch", ".", "mmu", ".", "gva_to_gpa", "(", "vcpu", ",", "addr", ")", ";", "if", "(", "kvm_read_guest_virt", "(", "addr", ",", "val", ",", "bytes", ",", "vcpu", ")", "if", "(", "gpa", "=", "=", "UNMAPPED_GVA", ")", "return", "X86EMUL_PROPAGATE_FAULT", ";", "gpa", "=", "vcpu", "-", ">", "arch", ".", "mmu", ".", "gva_to_gpa", "(", "vcpu", ",", "addr", ")", ";", "kvm_inject_page_fault", "(", "vcpu", ",", "addr", ",", "2", ")", ";", "gpa", "=", "vcpu", "-", ">", "arch", ".", "mmu", ".", "gva_to_gpa", "(", "vcpu", ",", "addr", ")", ";", "kvm_read_guest_virt", "(", "rip_linear", ",", "(", "void", "*", ")", "opcodes", ",", "4", ",", "vcpu", ")", ";", ".", "read_std", "=", "kvm_read_guest_virt", ",", "ret", "=", "kvm_write_guest_virt", "(", "q", ",", "p", ",", "bytes", ",", "vcpu", ")", ";", "ret", "=", "kvm_read_guest_virt", "(", "q", ",", "p", ",", "bytes", ",", "vcpu", ")", ";", "return", "r", ";", "if", "(", "ret", "=", "=", "X86EMUL_PROPAGATE_FAULT", ")", "{", "kvm_inject_gp", "(", "vcpu", ",", "0", ")", ";", "}", "return", "kvm_read_guest_virt", "(", "dtable", ".", "base", "+", "index", "*", "8", ",", "seg_desc", ",", "sizeof", "(", "*", "seg_desc", ")", ",", "vcpu", ")", ";", "return", "kvm_write_guest_virt", "(", "dtable", ".", "base", "+", "index", "*", "8", ",", "seg_desc", ",", "sizeof", "(", "*", "seg_desc", ")", ",", "vcpu", ")", ";", "static", "gpa_t", "get_tss_base_addr", "(", "struct", "kvm_vcpu", "*", "vcpu", ",", "return", "vcpu", "-", ">", "arch", ".", "mmu", ".", "gva_to_gpa", "(", "vcpu", ",", "base_addr", ")", ";", "if", "(", "kvm_read_guest", "(", "vcpu", "-", ">", "kvm", ",", "get_tss_base_addr", "(", "vcpu", ",", "nseg_desc", ")", ",", "get_tss_base_addr", "(", "vcpu", ",", "nseg_desc", ")", ",", "if", "(", "kvm_read_guest", "(", "vcpu", "-", ">", "kvm", ",", "get_tss_base_addr", "(", "vcpu", ",", "nseg_desc", ")", ",", "get_tss_base_addr", "(", "vcpu", ",", "nseg_desc", ")", ",", "old_tss_base", "=", "vcpu", "-", ">", "arch", ".", "mmu", ".", "gva_to_gpa", "(", "vcpu", ",", "old_tss_base", ")", ";", "gpa", "=", "vcpu", "-", ">", "arch", ".", "mmu", ".", "gva_to_gpa", "(", "vcpu", ",", "vaddr", ")", ";"], "docstring_tokens": ["the", "guest", "OS", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["char", "*", "newbuf", ",", "*", "oldbuf", ";", "newbuf", "=", "kmalloc", "(", "params", "-", ">", "buffer_size", ",", "GFP_KERNEL", ")", ";", "spin_lock_irq", "(", "&", "runtime", "-", ">", "lock", ")", ";", "oldbuf", "=", "runtime", "-", ">", "buffer", ";", "runtime", "-", ">", "appl_ptr", "=", "runtime", "-", ">", "hw_ptr", "=", "0", ";", "spin_unlock_irq", "(", "&", "runtime", "-", ">", "lock", ")", ";", "kfree", "(", "oldbuf", ")", ";", "char", "*", "newbuf", ",", "*", "oldbuf", ";", "newbuf", "=", "kmalloc", "(", "params", "-", ">", "buffer_size", ",", "GFP_KERNEL", ")", ";", "spin_lock_irq", "(", "&", "runtime", "-", ">", "lock", ")", ";", "oldbuf", "=", "runtime", "-", ">", "buffer", ";", "runtime", "-", ">", "appl_ptr", "=", "runtime", "-", ">", "hw_ptr", "=", "0", ";", "spin_unlock_irq", "(", "&", "runtime", "-", ">", "lock", ")", ";", "kfree", "(", "oldbuf", ")", ";</s>char", "*", "newbuf", ";", "newbuf", "=", "krealloc", "(", "runtime", "-", ">", "buffer", ",", "params", "-", ">", "buffer_size", ",", "GFP_KERNEL", ")", ";", "char", "*", "newbuf", ";", "newbuf", "=", "krealloc", "(", "runtime", "-", ">", "buffer", ",", "params", "-", ">", "buffer_size", ",", "GFP_KERNEL", ")", ";"], "docstring_tokens": ["gain", "elevated", "privileges"]}
{"contents": ["empty"], "code_tokens": ["private", "static", "final", "int", "MAX_RECORD_SIZE", "=", "1_000_000", ";", "if", "(", "length", ">", "MAX_RECORD_SIZE", ")", "{", "throw", "new", "IOException", "(", "\"", "Record", "size", "(", "\"+", "length", "\"", "bytes", ")", "is", "larger", "than", "the", "allowed", "record", "size", ":", "\"", "+", "MAX_RECORD_SIZE", ")", ";", "}</s>"], "docstring_tokens": ["a", "denial", "of", "service", "condition"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "pmd_none", "(", "pmdval", ")", "|", "|", "pmd_trans_huge", "(", "pmdval", ")", ")", "pmd_clear_bad", "(", "pmd", ")", ";</s>if", "(", "pmd_none", "(", "pmdval", ")", ")", "if", "(", "!", "pmd_trans_huge", "(", "pmdval", ")", ")", "pmd_clear_bad", "(", "pmd", ")", ";"], "docstring_tokens": ["the", "system", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["msg", "-", ">", "msg_namelen", "=", "0", ";</s>"], "docstring_tokens": ["obtain", "sensitive", "information", "from", "kernel", "stack", "memory"]}
{"contents": ["empty"], "code_tokens": ["*", "Copyright", "2002", "-", "2018", "the", "original", "author", "or", "authors", ".", "import", "org", ".", "springframework", ".", "security", ".", "core", ".", "GrantedAuthority", ";", "import", "org", ".", "springframework", ".", "util", ".", "ObjectUtils", ";", "import", "java", ".", "net", ".", "URI", ";", "import", "java", ".", "security", ".", "Principal", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Date", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "HashSet", ";", "import", "java", ".", "util", ".", "LinkedHashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "@", "SessionAttributes", "(", "{", "AuthorizationEndpoint", ".", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "AuthorizationEndpoint", ".", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", "}", ")", "static", "final", "String", "AUTHORIZATION_REQUEST_ATTR_NAME", "=", "\"", "authorizationRequest", "\"", ";", "static", "final", "String", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", "=", "\"", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "provider", ".", "endpoint", ".", "AuthorizationEndpoint", ".", "ORIGINAL_AUTHORIZATION_REQUEST", "\"", ";", "/", "/", "Store", "authorizationRequest", "AND", "an", "immutable", "Map", "of", "authorizationRequest", "in", "session", "/", "/", "which", "will", "be", "used", "to", "validate", "against", "in", "approveOrDeny", "(", ")", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "authorizationRequest", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "unmodifiableMap", "(", "authorizationRequest", ")", ");", "Map", "<", "String", ",", "Object", ">", "unmodifiableMap", "(", "AuthorizationRequest", "authorizationRequest", ")", "{", "Map", "<", "String", ",", "Object", ">", "authorizationRequestMap", "=", "new", "HashMap", "<", "String", ",", "Object", ">", "()", ";", "authorizationRequestMap", ".", "put", "(", "OAuth2Utils", ".", "CLIENT_ID", ",", "authorizationRequest", ".", "getClientId", "(", "))", ";", "authorizationRequestMap", ".", "put", "(", "OAuth2Utils", ".", "STATE", ",", "authorizationRequest", ".", "getState", "(", "))", ";", "authorizationRequestMap", ".", "put", "(", "OAuth2Utils", ".", "REDIRECT_URI", ",", "authorizationRequest", ".", "getRedirectUri", "(", "))", ";", "if", "(", "authorizationRequest", ".", "getResponseTypes", "(", ")", "!", "=", "null", ")", "{", "authorizationRequestMap", ".", "put", "(", "OAuth2Utils", ".", "RESPONSE_TYPE", ",", "Collections", ".", "unmodifiableSet", "(", "new", "HashSet", "<", "String", ">", "(", "authorizationRequest", ".", "getResponseTypes", "(", "))", "))", ";", "}", "if", "(", "authorizationRequest", ".", "getScope", "(", ")", "!", "=", "null", ")", "{", "authorizationRequestMap", ".", "put", "(", "OAuth2Utils", ".", "SCOPE", ",", "Collections", ".", "unmodifiableSet", "(", "new", "HashSet", "<", "String", ">", "(", "authorizationRequest", ".", "getScope", "(", "))", "))", ";", "}", "authorizationRequestMap", ".", "put", "(", "\"", "approved", "\"", ",", "authorizationRequest", ".", "isApproved", "(", "))", ";", "if", "(", "authorizationRequest", ".", "getResourceIds", "(", ")", "!", "=", "null", ")", "{", "authorizationRequestMap", ".", "put", "(", "\"", "resourceIds", "\"", ",", "Collections", ".", "unmodifiableSet", "(", "new", "HashSet", "<", "String", ">", "(", "authorizationRequest", ".", "getResourceIds", "(", "))", "))", ";", "}", "if", "(", "authorizationRequest", ".", "getAuthorities", "(", ")", "!", "=", "null", ")", "{", "authorizationRequestMap", ".", "put", "(", "\"", "authorities", "\"", ",", "Collections", ".", "unmodifiableSet", "(", "new", "HashSet", "<", "GrantedAuthority", ">", "(", "authorizationRequest", ".", "getAuthorities", "(", "))", "))", ";", "}", "return", "Collections", ".", "unmodifiableMap", "(", "authorizationRequestMap", ")", ";", "}", "AuthorizationRequest", "authorizationRequest", "=", "(", "AuthorizationRequest", ")", "model", ".", "get", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ")", ";", "/", "/", "Check", "to", "ensure", "the", "Authorization", "Request", "was", "not", "modified", "during", "the", "user", "approval", "step", "@", "SuppressWarnings", "(", "\"", "unchecked", "\"", ")", "Map", "<", "String", ",", "Object", ">", "originalAuthorizationRequest", "=", "(", "Map", "<", "String", ",", "Object", ">", ")", "model", ".", "get", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ")", ";", "if", "(", "isAuthorizationRequestModified", "(", "authorizationRequest", ",", "originalAuthorizationRequest", ")", ")", "{", "throw", "new", "InvalidRequestException", "(", "\"", "Changes", "were", "detected", "from", "the", "original", "authorization", "request", ".", "\")", ";", "}", "private", "boolean", "isAuthorizationRequestModified", "(", "AuthorizationRequest", "authorizationRequest", ",", "Map", "<", "String", ",", "Object", ">", "originalAuthorizationRequest", ")", "{", "if", "(", "!", "ObjectUtils", ".", "nullSafeEquals", "(", "authorizationRequest", ".", "getClientId", "(", "),", "originalAuthorizationRequest", ".", "get", "(", "OAuth2Utils", ".", "CLIENT_ID", ")", "))", "{", "return", "true", ";", "}", "if", "(", "!", "ObjectUtils", ".", "nullSafeEquals", "(", "authorizationRequest", ".", "getState", "(", "),", "originalAuthorizationRequest", ".", "get", "(", "OAuth2Utils", ".", "STATE", ")", "))", "{", "return", "true", ";", "}", "if", "(", "!", "ObjectUtils", ".", "nullSafeEquals", "(", "authorizationRequest", ".", "getRedirectUri", "(", "),", "originalAuthorizationRequest", ".", "get", "(", "OAuth2Utils", ".", "REDIRECT_URI", ")", "))", "{", "return", "true", ";", "}", "if", "(", "!", "ObjectUtils", ".", "nullSafeEquals", "(", "authorizationRequest", ".", "getResponseTypes", "(", "),", "originalAuthorizationRequest", ".", "get", "(", "OAuth2Utils", ".", "RESPONSE_TYPE", ")", "))", "{", "return", "true", ";", "}", "if", "(", "!", "ObjectUtils", ".", "nullSafeEquals", "(", "authorizationRequest", ".", "getScope", "(", "),", "originalAuthorizationRequest", ".", "get", "(", "OAuth2Utils", ".", "SCOPE", ")", "))", "{", "return", "true", ";", "}", "if", "(", "!", "ObjectUtils", ".", "nullSafeEquals", "(", "authorizationRequest", ".", "isApproved", "(", "),", "originalAuthorizationRequest", ".", "get", "(", "\"", "approved", "\"", "))", ")", "{", "return", "true", ";", "}", "if", "(", "!", "ObjectUtils", ".", "nullSafeEquals", "(", "authorizationRequest", ".", "getResourceIds", "(", "),", "originalAuthorizationRequest", ".", "get", "(", "\"", "resourceIds", "\"", "))", ")", "{", "return", "true", ";", "}", "if", "(", "!", "ObjectUtils", ".", "nullSafeEquals", "(", "authorizationRequest", ".", "getAuthorities", "(", "),", "originalAuthorizationRequest", ".", "get", "(", "\"", "authorities", "\"", "))", ")", "{", "return", "true", ";", "}", "return", "false", ";", "}", "webRequest", ",", "AUTHORIZATION_REQUEST_ATTR_NAME", ")", ";", "*", "Copyright", "2006", "-", "2018", "the", "original", "author", "or", "authors", ".", "import", "static", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "provider", ".", "endpoint", ".", "AuthorizationEndpoint", ".", "AUTHORIZATION_REQUEST_ATTR_NAME", ";", "import", "static", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "provider", ".", "endpoint", ".", "AuthorizationEndpoint", ".", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ";", "import", "org", ".", "springframework", ".", "security", ".", "core", ".", "authority", ".", "AuthorityUtils", ";", "AuthorizationRequest", "request", "=", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "#", "bar", "\"", ",", "null", ",", "null", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ";", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "request", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "request", ")", ");", "AuthorizationRequest", "request", "=", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "?", "foo", "=", "bar", "\"", ",", "null", ",", "null", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ";", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "request", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "request", ")", ");", "AuthorizationRequest", "request", "=", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "\"", ",", "\"", "=", "?", "s", "\"", ",", "null", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ";", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "request", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "request", ")", ");", "AuthorizationRequest", "request", "=", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "?", "foo", "=", "bar", "&", "bar", "=", "foo", "\"", ",", "null", ",", "null", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ";", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "request", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "request", ")", ");", "AuthorizationRequest", "request", "=", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "?", "foo", "=", "b", "=", "&", "bar", "=", "f", "$", "\",", "null", ",", "null", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ";", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "request", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "request", ")", ");", "AuthorizationRequest", "request", "=", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "path", "?", "foo", "=", "b", "%", "20", "%", "3D", "&", "bar", "=", "f", "%", "20", "$", "\",", "null", ",", "null", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ";", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "request", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "request", ")", ");", "AuthorizationRequest", "request", "=", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", "?", "t", "=", "a", "%", "3Db", "%", "26ep", "%", "3Dtest", "%", "2540test", ".", "me", "\"", ",", "null", ",", "null", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ";", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "request", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "request", ")", ");", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "request", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "request", ")", ");", "AuthorizationRequest", "request", "=", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "\"", ",", "null", ",", "null", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ";", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "request", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "request", ")", ");", "AUTHORIZATION_REQUEST_ATTR_NAME", ")", ";", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "request", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "request", ")", ");", "endpoint", ".", "approveOrDeny", "(", "approvalParameters", ",", "model", ",", "sessionStatus", ",", "principal", ")", ";", "}", "@", "Test", "(", "expected", "=", "InvalidRequestException", ".", "class", ")", "public", "void", "testApproveWithModifiedClientId", "(", ")", "throws", "Exception", "{", "AuthorizationRequest", "authorizationRequest", "=", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "\"", ",", "\"", "state", "-", "1234", "\"", ",", "\"", "read", "\"", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ";", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "authorizationRequest", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "authorizationRequest", ")", ");", "authorizationRequest", ".", "setClientId", "(", "\"", "bar", "\"", ");", "/", "/", "Modify", "authorization", "request", "Map", "<", "String", ",", "String", ">", "approvalParameters", "=", "new", "HashMap", "<", "String", ",", "String", ">", "()", ";", "approvalParameters", ".", "put", "(", "\"", "user_oauth_approval", "\"", ",", "\"", "true", "\"", ");", "endpoint", ".", "approveOrDeny", "(", "approvalParameters", ",", "model", ",", "sessionStatus", ",", "principal", ")", ";", "}", "@", "Test", "(", "expected", "=", "InvalidRequestException", ".", "class", ")", "public", "void", "testApproveWithModifiedState", "(", ")", "throws", "Exception", "{", "AuthorizationRequest", "authorizationRequest", "=", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "\"", ",", "\"", "state", "-", "1234", "\"", ",", "\"", "read", "\"", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ";", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "authorizationRequest", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "authorizationRequest", ")", ");", "authorizationRequest", ".", "setState", "(", "\"", "state", "-", "5678", "\"", ");", "/", "/", "Modify", "authorization", "request", "Map", "<", "String", ",", "String", ">", "approvalParameters", "=", "new", "HashMap", "<", "String", ",", "String", ">", "()", ";", "approvalParameters", ".", "put", "(", "\"", "user_oauth_approval", "\"", ",", "\"", "true", "\"", ");", "endpoint", ".", "approveOrDeny", "(", "approvalParameters", ",", "model", ",", "sessionStatus", ",", "principal", ")", ";", "}", "@", "Test", "(", "expected", "=", "InvalidRequestException", ".", "class", ")", "public", "void", "testApproveWithModifiedRedirectUri", "(", ")", "throws", "Exception", "{", "AuthorizationRequest", "authorizationRequest", "=", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "\"", ",", "\"", "state", "-", "1234", "\"", ",", "\"", "read", "\"", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ";", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "authorizationRequest", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "authorizationRequest", ")", ");", "authorizationRequest", ".", "setRedirectUri", "(", "\"", "http", ":", "//", "somewhere", ".", "com", "\"", ");", "/", "/", "Modify", "authorization", "request", "Map", "<", "String", ",", "String", ">", "approvalParameters", "=", "new", "HashMap", "<", "String", ",", "String", ">", "()", ";", "approvalParameters", ".", "put", "(", "\"", "user_oauth_approval", "\"", ",", "\"", "true", "\"", ");", "endpoint", ".", "approveOrDeny", "(", "approvalParameters", ",", "model", ",", "sessionStatus", ",", "principal", ")", ";", "}", "@", "Test", "(", "expected", "=", "InvalidRequestException", ".", "class", ")", "public", "void", "testApproveWithModifiedResponseTypes", "(", ")", "throws", "Exception", "{", "AuthorizationRequest", "authorizationRequest", "=", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "\"", ",", "\"", "state", "-", "1234", "\"", ",", "\"", "read", "\"", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ";", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "authorizationRequest", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "authorizationRequest", ")", ");", "authorizationRequest", ".", "setResponseTypes", "(", "Collections", ".", "singleton", "(", "\"", "implicit", "\"", "))", ";", "/", "/", "Modify", "authorization", "request", "Map", "<", "String", ",", "String", ">", "approvalParameters", "=", "new", "HashMap", "<", "String", ",", "String", ">", "()", ";", "approvalParameters", ".", "put", "(", "\"", "user_oauth_approval", "\"", ",", "\"", "true", "\"", ");", "}", "@", "Test", "(", "expected", "=", "InvalidRequestException", ".", "class", ")", "public", "void", "testApproveWithModifiedScope", "(", ")", "throws", "Exception", "{", "AuthorizationRequest", "authorizationRequest", "=", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "\"", ",", "\"", "state", "-", "1234", "\"", ",", "\"", "read", "\"", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ";", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "authorizationRequest", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "authorizationRequest", ")", ");", "authorizationRequest", ".", "setScope", "(", "Arrays", ".", "asList", "(", "\"", "read", "\"", ",", "\"", "write", "\"", "))", ";", "/", "/", "Modify", "authorization", "request", "Map", "<", "String", ",", "String", ">", "approvalParameters", "=", "new", "HashMap", "<", "String", ",", "String", ">", "()", ";", "approvalParameters", ".", "put", "(", "\"", "user_oauth_approval", "\"", ",", "\"", "true", "\"", ");", "endpoint", ".", "approveOrDeny", "(", "approvalParameters", ",", "model", ",", "sessionStatus", ",", "principal", ")", ";", "}", "@", "Test", "(", "expected", "=", "InvalidRequestException", ".", "class", ")", "public", "void", "testApproveWithModifiedApproved", "(", ")", "throws", "Exception", "{", "AuthorizationRequest", "authorizationRequest", "=", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "\"", ",", "\"", "state", "-", "1234", "\"", ",", "\"", "read", "\"", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ";", "authorizationRequest", ".", "setApproved", "(", "false", ")", ";", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "authorizationRequest", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "authorizationRequest", ")", ");", "authorizationRequest", ".", "setApproved", "(", "true", ")", ";", "/", "/", "Modify", "authorization", "request", "Map", "<", "String", ",", "String", ">", "approvalParameters", "=", "new", "HashMap", "<", "String", ",", "String", ">", "()", ";", "approvalParameters", ".", "put", "(", "\"", "user_oauth_approval", "\"", ",", "\"", "true", "\"", ");", "endpoint", ".", "approveOrDeny", "(", "approvalParameters", ",", "model", ",", "sessionStatus", ",", "principal", ")", ";", "}", "@", "Test", "(", "expected", "=", "InvalidRequestException", ".", "class", ")", "public", "void", "testApproveWithModifiedResourceIds", "(", ")", "throws", "Exception", "{", "AuthorizationRequest", "authorizationRequest", "=", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "\"", ",", "\"", "state", "-", "1234", "\"", ",", "\"", "read", "\"", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ";", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "authorizationRequest", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "authorizationRequest", ")", ");", "authorizationRequest", ".", "setResourceIds", "(", "Collections", ".", "singleton", "(", "\"", "resource", "-", "other", "\"", "))", ";", "/", "/", "Modify", "authorization", "request", "Map", "<", "String", ",", "String", ">", "approvalParameters", "=", "new", "HashMap", "<", "String", ",", "String", ">", "()", ";", "approvalParameters", ".", "put", "(", "\"", "user_oauth_approval", "\"", ",", "\"", "true", "\"", ");", "endpoint", ".", "approveOrDeny", "(", "approvalParameters", ",", "model", ",", "sessionStatus", ",", "principal", ")", ";", "}", "@", "Test", "(", "expected", "=", "InvalidRequestException", ".", "class", ")", "public", "void", "testApproveWithModifiedAuthorities", "(", ")", "throws", "Exception", "{", "AuthorizationRequest", "authorizationRequest", "=", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "\"", ",", "\"", "state", "-", "1234", "\"", ",", "\"", "read", "\"", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ";", "model", ".", "put", "(", "AUTHORIZATION_REQUEST_ATTR_NAME", ",", "authorizationRequest", ")", ";", "model", ".", "put", "(", "ORIGINAL_AUTHORIZATION_REQUEST_ATTR_NAME", ",", "endpoint", ".", "unmodifiableMap", "(", "authorizationRequest", ")", ");", "authorizationRequest", ".", "setAuthorities", "(", "AuthorityUtils", ".", "commaSeparatedStringToAuthorityList", "(", "\"", "authority", "-", "other", "\"", "))", ";", "/", "/", "Modify", "authorization", "request", "Map", "<", "String", ",", "String", ">", "approvalParameters", "=", "new", "HashMap", "<", "String", ",", "String", ">", "()", ";", "approvalParameters", ".", "put", "(", "\"", "user_oauth_approval", "\"", ",", "\"", "true", "\"", ");", "endpoint", ".", "approveOrDeny", "(", "approvalParameters", ",", "model", ",", "sessionStatus", ",", "principal", ")", ";</s>*", "Copyright", "2002", "-", "2011", "the", "original", "author", "or", "authors", ".", "import", "java", ".", "net", ".", "URI", ";", "import", "java", ".", "security", ".", "Principal", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Date", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "LinkedHashMap", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Set", ";", "@", "SessionAttributes", "(", "\"", "authorizationRequest", "\"", ")", "/", "/", "Place", "auth", "request", "into", "the", "model", "so", "that", "it", "is", "stored", "in", "the", "session", "/", "/", "for", "approveOrDeny", "to", "use", ".", "That", "way", "we", "make", "sure", "that", "auth", "request", "comes", "from", "the", "session", ",", "/", "/", "so", "any", "auth", "request", "parameters", "passed", "to", "approveOrDeny", "will", "be", "ignored", "and", "retrieved", "from", "the", "session", ".", "model", ".", "put", "(", "\"", "authorizationRequest", "\"", ",", "authorizationRequest", ")", ";", "AuthorizationRequest", "authorizationRequest", "=", "(", "AuthorizationRequest", ")", "model", ".", "get", "(", "\"", "authorizationRequest", "\"", ");", "webRequest", ",", "\"", "authorizationRequest", "\"", ");", "*", "Copyright", "2006", "-", "2011", "the", "original", "author", "or", "authors", ".", "model", ".", "put", "(", "\"", "authorizationRequest", "\"", ",", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "#", "bar", "\"", ",", "null", ",", "null", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ");", "model", ".", "put", "(", "\"", "authorizationRequest", "\"", ",", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "?", "foo", "=", "bar", "\"", ",", "null", ",", "null", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ");", "model", ".", "put", "(", "\"", "authorizationRequest", "\"", ",", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "\"", ",", "\"", "=", "?", "s", "\"", ",", "null", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ");", "model", ".", "put", "(", "\"", "authorizationRequest", "\"", ",", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "?", "foo", "=", "bar", "&", "bar", "=", "foo", "\"", ",", "null", ",", "null", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ");", "model", ".", "put", "(", "\"", "authorizationRequest", "\"", ",", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "?", "foo", "=", "b", "=", "&", "bar", "=", "f", "$", "\",", "null", ",", "null", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ");", "model", ".", "put", "(", "\"", "authorizationRequest", "\"", ",", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "path", "?", "foo", "=", "b", "%", "20", "%", "3D", "&", "bar", "=", "f", "%", "20", "$", "\",", "null", ",", "null", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ");", "model", ".", "put", "(", "\"", "authorizationRequest", "\"", ",", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", "?", "t", "=", "a", "%", "3Db", "%", "26ep", "%", "3Dtest", "%", "2540test", ".", "me", "\"", ",", "null", ",", "null", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ");", "model", ".", "put", "(", "\"", "authorizationRequest", "\"", ",", "request", ")", ";", "model", ".", "put", "(", "\"", "authorizationRequest", "\"", ",", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "\"", ",", "null", ",", "null", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ");", "\"", "authorizationRequest", "\"", ");", "model", ".", "put", "(", "\"", "authorizationRequest", "\"", ",", "request", ")", ";"], "docstring_tokens": ["gain", "elevated", "privileges", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "*", "Mask", "used", "when", "checking", "the", "page", "offset", "value", "passed", "in", "via", "system", "*", "calls", ".", "This", "value", "will", "be", "converted", "to", "a", "loff_t", "which", "is", "signed", ".", "*", "Therefore", ",", "we", "want", "to", "check", "the", "upper", "PAGE_SHIFT", "+", "1", "bits", "of", "the", "*", "value", ".", "The", "extra", "bit", "(", "-", "1", "in", "the", "shift", "value", ")", "is", "to", "take", "the", "sign", "*", "bit", "into", "account", ".", "*", "/", "#", "define", "PGOFF_LOFFT_MAX", "\\", "(", "((", "1UL", "<", "<", "(", "PAGE_SHIFT", "+", "1", ")", ")", "-", "1", ")", "<", "<", "(", "BITS_PER_LONG", "-", "(", "PAGE_SHIFT", "+", "1", ")", "))", "*", "page", "based", "offset", "in", "vm_pgoff", "could", "be", "sufficiently", "large", "to", "*", "overflow", "a", "(", "l", ")", "off_t", "when", "converted", "to", "byte", "offset", ".", "if", "(", "vma", "-", ">", "vm_pgoff", "&", "PGOFF_LOFFT_MAX", ")", "/", "*", "must", "be", "huge", "page", "aligned", "*", "/", "#", "include", "<", "linux", "/", "mmdebug", ".", "h", ">", "/", "*", "This", "should", "never", "happen", "*", "/", "if", "(", "from", ">", "to", ")", "{", "VM_WARN", "(", "1", ",", "\"", "%", "s", "called", "with", "a", "negative", "range", "\\", "n", "\"", ",", "__func__", ")", ";", "return", "-", "EINVAL", ";", "}</s>*", "Offset", "passed", "to", "mmap", "(", "before", "page", "shift", ")", "could", "have", "been", "*", "negative", "when", "represented", "as", "a", "(", "l", ")", "off_t", ".", "if", "(", "((", "loff_t", ")", "vma", "-", ">", "vm_pgoff", "<", "<", "PAGE_SHIFT", ")", "<", "0", ")"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(BUG", ")"]}
{"contents": ["empty"], "code_tokens": ["import", "jenkins", ".", "model", ".", "Jenkins", ";", "final", "Jenkins", "instance", "=", "Jenkins", ".", "getInstance", "(", ");", "if", "(", "instance", "=", "=", "null", ")", "{", "throw", "new", "IllegalStateException", "(", "\"", "Jenkins", "instance", "not", "available", ".", "Could", "not", "handle", "test", "connection", "request", ".", "\")", ";", "}", "instance", ".", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";</s>"], "docstring_tokens": ["initiate", "a", "connection", "test", "to", "an", "attacker-specified", "server", "with", "attacker-specified", "username", "and", "password"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "startingResource", "=", "=", "null", ")", "{", "throw", "new", "PersistenceException", "(", "\"", "Access", "denied", "for", "root", "resource", ",", "resource", "can", "'", "t", "be", "created", ":", "\"", "+", "path", ")", ";", "}</s>"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(infinite", "loop", ")"]}
{"contents": ["empty"], "code_tokens": ["struct", "tc_gact", "opt", "=", "{", ".", "index", "=", "gact", "-", ">", "tcf_index", ",", ".", "refcnt", "=", "gact", "-", ">", "tcf_refcnt", "-", "ref", ",", ".", "bindcnt", "=", "gact", "-", ">", "tcf_bindcnt", "-", "bind", ",", ".", "action", "=", "gact", "-", ">", "tcf_action", ",", "}", ";", "struct", "tc_gact_p", "p_opt", "=", "{", ".", "paction", "=", "gact", "-", ">", "tcfg_paction", ",", ".", "pval", "=", "gact", "-", ">", "tcfg_pval", ",", ".", "ptype", "=", "gact", "-", ">", "tcfg_ptype", ",", "}", ";", "struct", "tc_mirred", "opt", "=", "{", ".", "index", "=", "m", "-", ">", "tcf_index", ",", ".", "action", "=", "m", "-", ">", "tcf_action", ",", ".", "refcnt", "=", "m", "-", ">", "tcf_refcnt", "-", "ref", ",", ".", "bindcnt", "=", "m", "-", ">", "tcf_bindcnt", "-", "bind", ",", ".", "eaction", "=", "m", "-", ">", "tcfm_eaction", ",", ".", "ifindex", "=", "m", "-", ">", "tcfm_ifindex", ",", "}", ";", "struct", "tc_nat", "opt", "=", "{", ".", "old_addr", "=", "p", "-", ">", "old_addr", ",", ".", "new_addr", "=", "p", "-", ">", "new_addr", ",", ".", "mask", "=", "p", "-", ">", "mask", ",", ".", "flags", "=", "p", "-", ">", "flags", ",", ".", "index", "=", "p", "-", ">", "tcf_index", ",", ".", "action", "=", "p", "-", ">", "tcf_action", ",", ".", "refcnt", "=", "p", "-", ">", "tcf_refcnt", "-", "ref", ",", ".", "bindcnt", "=", "p", "-", ">", "tcf_bindcnt", "-", "bind", ",", "}", ";", "struct", "tc_defact", "opt", "=", "{", ".", "index", "=", "d", "-", ">", "tcf_index", ",", ".", "refcnt", "=", "d", "-", ">", "tcf_refcnt", "-", "ref", ",", ".", "bindcnt", "=", "d", "-", ">", "tcf_bindcnt", "-", "bind", ",", ".", "action", "=", "d", "-", ">", "tcf_action", ",", "}", ";", "struct", "tc_skbedit", "opt", "=", "{", ".", "index", "=", "d", "-", ">", "tcf_index", ",", ".", "refcnt", "=", "d", "-", ">", "tcf_refcnt", "-", "ref", ",", ".", "bindcnt", "=", "d", "-", ">", "tcf_bindcnt", "-", "bind", ",", ".", "action", "=", "d", "-", ">", "tcf_action", ",", "}", ";</s>struct", "tc_gact", "opt", ";", "opt", ".", "index", "=", "gact", "-", ">", "tcf_index", ";", "opt", ".", "refcnt", "=", "gact", "-", ">", "tcf_refcnt", "-", "ref", ";", "opt", ".", "bindcnt", "=", "gact", "-", ">", "tcf_bindcnt", "-", "bind", ";", "opt", ".", "action", "=", "gact", "-", ">", "tcf_action", ";", "struct", "tc_gact_p", "p_opt", ";", "p_opt", ".", "paction", "=", "gact", "-", ">", "tcfg_paction", ";", "p_opt", ".", "pval", "=", "gact", "-", ">", "tcfg_pval", ";", "p_opt", ".", "ptype", "=", "gact", "-", ">", "tcfg_ptype", ";", "struct", "tc_mirred", "opt", ";", "opt", ".", "index", "=", "m", "-", ">", "tcf_index", ";", "opt", ".", "action", "=", "m", "-", ">", "tcf_action", ";", "opt", ".", "refcnt", "=", "m", "-", ">", "tcf_refcnt", "-", "ref", ";", "opt", ".", "bindcnt", "=", "m", "-", ">", "tcf_bindcnt", "-", "bind", ";", "opt", ".", "eaction", "=", "m", "-", ">", "tcfm_eaction", ";", "opt", ".", "ifindex", "=", "m", "-", ">", "tcfm_ifindex", ";", "struct", "tc_nat", "opt", ";", "opt", ".", "old_addr", "=", "p", "-", ">", "old_addr", ";", "opt", ".", "new_addr", "=", "p", "-", ">", "new_addr", ";", "opt", ".", "mask", "=", "p", "-", ">", "mask", ";", "opt", ".", "flags", "=", "p", "-", ">", "flags", ";", "opt", ".", "index", "=", "p", "-", ">", "tcf_index", ";", "opt", ".", "action", "=", "p", "-", ">", "tcf_action", ";", "opt", ".", "refcnt", "=", "p", "-", ">", "tcf_refcnt", "-", "ref", ";", "opt", ".", "bindcnt", "=", "p", "-", ">", "tcf_bindcnt", "-", "bind", ";", "struct", "tc_defact", "opt", ";", "opt", ".", "index", "=", "d", "-", ">", "tcf_index", ";", "opt", ".", "refcnt", "=", "d", "-", ">", "tcf_refcnt", "-", "ref", ";", "opt", ".", "bindcnt", "=", "d", "-", ">", "tcf_bindcnt", "-", "bind", ";", "opt", ".", "action", "=", "d", "-", ">", "tcf_action", ";", "struct", "tc_skbedit", "opt", ";", "opt", ".", "index", "=", "d", "-", ">", "tcf_index", ";", "opt", ".", "refcnt", "=", "d", "-", ">", "tcf_refcnt", "-", "ref", ";", "opt", ".", "bindcnt", "=", "d", "-", ">", "tcf_bindcnt", "-", "bind", ";", "opt", ".", "action", "=", "d", "-", ">", "tcf_action", ";"], "docstring_tokens": ["obtain", "potentially", "sensitive", "information", "from", "kernel", "memory"]}
{"contents": ["empty"], "code_tokens": ["#", "2460", ":", "Block", "one", "mode", "gadget", "type", "(", "ehcache", ",", "no", "CVE", "allocated", "yet", ")", "/", "/", "[", "databind", "#", "2387", "]", ",", "[", "databind", "#", "2460", "]", ":", "EHCache", "s", ".", "add", "(", "\"", "net", ".", "sf", ".", "ehcache", ".", "hibernate", ".", "EhcacheJtaTransactionManagerLookup", "\"", ");</s>/", "/", "[", "databind", "#", "2387", "]", ":", "EHCache"], "docstring_tokens": ["launch", "further", "attacks", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["<", "strong", ">", "<", "a", "href", "=", "'$", "xwiki", ".", "getURL", "(", "'", "XWiki", ".", "XWikiLogin", "'", ",", "'", "login", "'", ",", "\"", "xredirect", "=", "$", "escapetool", ".", "url", "(", "$", "xwiki", ".", "relativeRequestURL", ")", "\")", "'>", "$", "escapetool", ".", "xml", "(", "$", "services", ".", "localization", ".", "render", "(", "'", "login", "'", "))", "<", "/", "a", ">", "<", "/", "strong", ">", "newlist", ".", "add", "(", "XMLUtils", ".", "escapeElementText", "(", "getDisplayValue", "(", "value", ",", "name", ",", "map", ",", "context", ")", "))", ";", "buffer", ".", "append", "(", "XMLUtils", ".", "escapeElementText", "(", "getDisplayValue", "(", "prop", ".", "getValue", "(", "),", "name", ",", "map", ",", "context", ")", "))", ";", "import", "org", ".", "xwiki", ".", "xml", ".", "XMLUtils", ";", "@", "Override", "public", "void", "displayView", "(", "StringBuffer", "buffer", ",", "String", "name", ",", "String", "prefix", ",", "BaseCollection", "object", ",", "XWikiContext", "context", ")", "{", "BaseProperty", "property", "=", "(", "BaseProperty", ")", "object", ".", "safeget", "(", "name", ")", ";", "if", "(", "property", "!", "=", "null", ")", "{", "buffer", ".", "append", "(", "XMLUtils", ".", "escapeElementText", "(", "property", ".", "toText", "(", "))", ");", "}", "}", "BaseProperty", "property", "=", "(", "BaseProperty", ")", "object", ".", "safeget", "(", "name", ")", ";", "if", "(", "property", "!", "=", "null", ")", "{", "String", "content", "=", "property", ".", "toText", "(", ");", "if", "(", "doc", "!", "=", "null", ")", "{", "String", "syntax", "=", "getObjectDocumentSyntax", "(", "object", ",", "context", ")", ".", "toIdString", "(", ");", "buffer", ".", "append", "(", "context", ".", "getDoc", "(", ").", "getRenderedContent", "(", "content", ",", "syntax", ",", "context", ")", ");", "}", "else", "{", "buffer", ".", "append", "(", "content", ")", ";", "}", "+", "'", "='", "+", "StringUtils", ".", "reverse", "(", "VALUES_WITH_HTML_SPECIAL_CHARS", ".", "get", "(", "1", ")", ")", "+", "'", "|'", "+", "VALUES_WITH_HTML_SPECIAL_CHARS", ".", "get", "(", "2", ")", ");", "assertEquals", "(", "\"", "a", "&", "#", "60", ";", "b", ">", "c", "*", "3", "'", "2", "\\", "\"", "1", "*", "x", "{", "y", "&", "#", "38", ";", "z", "\"", ",", "staticListClass", ".", "displayView", "(", "propertyName", ",", "\"", "\",", "object", ",", "null", ")", ");", "/", "/", "Replaces", "the", "element", "'", "s", "content", "with", "the", "temporary", "container", "'", "s", "content", ",", "while", "also", "evaluating", "/", "/", "any", "inline", "scripts", ".", "/", "/", "The", "replacement", "is", "done", "by", "inserting", "the", "child", "elements", "of", "the", "temporary", "container", "into", "the", "/", "/", "element", "'", "s", "content", ".", "var", "pane", "=", "$", "(", "extraID", "+", "\"", "pane", "\"", ");", "container", ".", "childElements", "(", ").", "forEach", "(", "function", "(", "e", ")", "{", "pane", ".", "insert", "(", "e", ")", ";", "}", ");</s><", "strong", ">", "<", "a", "href", "=", "'$", "xwiki", ".", "getURL", "(", "'", "XWiki", ".", "XWikiLogin", "'", ",", "'", "login", "'", ",", "\"", "xredirect", "=", "$", "escapetool", ".", "url", "(", "$", "xwiki", ".", "relativeRequestURL", ")", "\")", "'>", "$", "services", ".", "localization", ".", "render", "(", "'", "login", "'", ")<", "/", "a", ">", "</", "strong", ">", "newlist", ".", "add", "(", "getDisplayValue", "(", "value", ",", "name", ",", "map", ",", "context", ")", ");", "buffer", ".", "append", "(", "getDisplayValue", "(", "prop", ".", "getValue", "(", "),", "name", ",", "map", ",", "context", ")", ");", "StringBuffer", "result", "=", "new", "StringBuffer", "(", ");", "super", ".", "displayView", "(", "result", ",", "name", ",", "prefix", ",", "object", ",", "context", ")", ";", "if", "(", "doc", "!", "=", "null", ")", "{", "String", "syntax", "=", "getObjectDocumentSyntax", "(", "object", ",", "context", ")", ".", "toIdString", "(", ");", "buffer", ".", "append", "(", "context", ".", "getDoc", "(", ").", "getRenderedContent", "(", "result", ".", "toString", "(", "),", "syntax", ",", "context", ")", ");", "}", "else", "{", "buffer", ".", "append", "(", "result", ")", ";", "assertEquals", "(", "\"", "a", "<", "b", ">", "c", "*", "3", "'", "2", "\\", "\"", "1", "*", "x", "{", "y", "&", "z", "\"", ",", "staticListClass", ".", "displayView", "(", "propertyName", ",", "\"", "\",", "object", ",", "null", ")", ");", "/", "/", "Replace", "the", "element", "'", "s", "content", "with", "the", "temporary", "container", "'", "s", "content", ",", "while", "also", "evaluating", "any", "inline", "scripts", ".", "/", "/", "Note", ":", "This", "also", "does", "stripScripts", "internally", ",", "but", "it", "'", "s", "OK", "now", ",", "since", "we", "have", "already", "added", "the", "necessary", "external", "scripts", "to", "head", ".", "$", "(", "extraID", "+", "\"", "pane", "\"", ").", "update", "(", "container", ".", "innerHTML", ")", ";"], "docstring_tokens": ["and", "use", "this", "information", "to", "launch", "further", "attacks", "against", "the", "affected", "system"]}
{"contents": ["empty"], "code_tokens": ["#", "define", "MAX_PASSWORD_SIZE", "512", "/", "*", "max", "for", "windows", "seems", "to", "be", "256", "wide", "chars", "*", "/", "cifs_find_smb_ses", "(", "struct", "TCP_Server_Info", "*", "server", ",", "struct", "smb_vol", "*", "vol", ")", "list_for_each_entry", "(", "ses", ",", "&", "server", "-", ">", "smb_ses_list", ",", "smb_ses_list", ")", "{", "switch", "(", "server", "-", ">", "secType", ")", "{", "case", "Kerberos", ":", "if", "(", "vol", "-", ">", "linux_uid", "!", "=", "ses", "-", ">", "linux_uid", ")", "continue", ";", "break", ";", "default", ":", "/", "*", "anything", "else", "takes", "username", "/", "password", "*", "/", "if", "(", "strncmp", "(", "ses", "-", ">", "userName", ",", "vol", "-", ">", "username", ",", "MAX_USERNAME_SIZE", ")", ")", "continue", ";", "if", "(", "strlen", "(", "vol", "-", ">", "username", ")", "!", "=", "0", "&", "&", "strncmp", "(", "ses", "-", ">", "password", ",", "vol", "-", ">", "password", ",", "MAX_PASSWORD_SIZE", ")", ")", "continue", ";", "}", "+", "+", "ses", "-", ">", "ses_count", ";", "ses", "=", "cifs_find_smb_ses", "(", "server", ",", "volume_info", ")", ";</s>#", "define", "MAX_PASSWORD_SIZE", "16", "cifs_find_smb_ses", "(", "struct", "TCP_Server_Info", "*", "server", ",", "char", "*", "username", ")", "struct", "list_head", "*", "tmp", ";", "list_for_each", "(", "tmp", ",", "&", "server", "-", ">", "smb_ses_list", ")", "{", "ses", "=", "list_entry", "(", "tmp", ",", "struct", "cifsSesInfo", ",", "smb_ses_list", ")", ";", "if", "(", "strncmp", "(", "ses", "-", ">", "userName", ",", "username", ",", "MAX_USERNAME_SIZE", ")", ")", "continue", ";", "ses", "=", "cifs_find_smb_ses", "(", "server", ",", "volume_info", "-", ">", "username", ")", ";"], "docstring_tokens": ["mount", "the", "same", "share", "without", "knowing", "the", "correct", "password"]}
{"contents": ["empty"], "code_tokens": ["memset", "(", "&", "sync", ",", "0", ",", "sizeof", "(", "sync", ")", ");</s>"], "docstring_tokens": ["obtain", "sensitive", "information", "from", "kernel", "memory"]}
{"contents": ["empty"], "code_tokens": ["<", "input", "type", "=", "\"", "hidden", "\"", "wicket", ":", "id", "=", "\"", "textarea", "\"", "/>", "import", "org", ".", "apache", ".", "wicket", ".", "markup", ".", "html", ".", "form", ".", "HiddenField", ";", "private", "HiddenField", "<", "String", ">", "textarea", ";", "this", ".", "textarea", "=", "new", "HiddenField", "<", "String", ">", "(\"", "textarea", "\"", ",", "this", ".", "getModel", "(", "))", ";", "this", ".", "textarea", ".", "setOutputMarkupId", "(", "true", ")", ";", "this", ".", "add", "(", "this", ".", "textarea", ")", ";</s>-", "->", "<", "wicket", ":", "head", ">", "<", "style", "type", "=", "\"", "text", "/", "css", "\"", ">", ".", "wysiwyg", "-", "editor", "-", "textarea", "{", "display", ":", "none", ";", "}", "<", "/", "style", ">", "<", "/", "wicket", ":", "head", ">", "<", "textarea", "wicket", ":", "id", "=", "\"", "textarea", "\"", "class", "=", "\"", "wysiwyg", "-", "editor", "-", "textarea", "\"", "><", "/", "textarea", ">", "import", "org", ".", "apache", ".", "wicket", ".", "markup", ".", "html", ".", "form", ".", "TextArea", ";", "private", "TextArea", "<", "String", ">", "textarea", ";", "this", ".", "textarea", "=", "new", "TextArea", "<", "String", ">", "(\"", "textarea", "\"", ",", "this", ".", "getModel", "(", "))", ";", "this", ".", "add", "(", "this", ".", "textarea", ".", "setOutputMarkupId", "(", "true", ")", ");"], "docstring_tokens": ["steal", "the", "victim's", "cookie-based", "authentication", "credentials"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "bl", "-", "i", ">", "inl", ")", "{</s>if", "(", "i", "+", "inl", "<", "bl", ")", "{"], "docstring_tokens": ["casuse", "allocation", "of", "large", "amounts", "of", "memory", "potentially", "consuming", "excessive", "resources", "or", "exhausting", "memory"]}
{"contents": ["empty"], "code_tokens": ["case", "IS_BOOL", ":", "case", "IS_LONG", ":", "zend_call_method_with_1_params", "(", "&", "object", ",", "Z_OBJCE_P", "(", "object", ")", ",", "&", "intern", "-", ">", "fptr_offset_get", ",", "\"", "offsetGet", "\"", ",", "&", "rv", ",", "offset", ")", ";", "case", "IS_BOOL", ":", "case", "IS_LONG", ":", "}", "case", "IS_BOOL", ":", "case", "IS_LONG", ":", "case", "IS_BOOL", ":", "{", "}", "/", "*", "We", "need", "to", "store", "the", "'", "pos", "'", "since", "we", "'", "ll", "modify", "it", "in", "the", "functions", "/", "*", "}", "}}", "*", "/", "if", "(", "pflags", ")", "{", "zval_ptr_dtor", "(", "&", "pflags", ")", ";", "}", "if", "(", "pflags", ")", "{", "zval_ptr_dtor", "(", "&", "pflags", ")", ";", "}", "-", "-", "TEST", "-", "-", "Bug", "#", "70068", "(", "Dangling", "pointer", "in", "the", "unserialization", "of", "ArrayObject", "items", ")", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "a", "=", "unserialize", "(", "'", "a", ":", "3", ":", "{", "i", ":", "0", ";", "C", ":", "11", ":", "\"", "ArrayObject", "\"", ":", "20", ":", "{", "x", ":", "i", ":", "0", ";", "r", ":", "3", ";", ";", "m", ":", "a", ":", "0", ":", "{}", ";}", "i", ":", "1", ";", "d", ":", "11", ";", "i", ":", "2", ";", "S", ":", "31", ":", "\"", "AAAAAAAABBBBCCCC", "\\", "01", "\\", "00", "\\", "00", "\\", "00", "\\", "04", "\\", "00", "\\", "00", "\\", "00", "\\", "00", "\\", "00", "\\", "00", "\\", "00", "\\", "00", "\\", "00", "\\", "00", "\"", ";}", "')", ";", "?", ">", "OK", "-", "-", "EXPECT", "-", "-", "OK</s>case", "IS_BOOL", ":", "case", "IS_LONG", ":", "zend_call_method_with_1_params", "(", "&", "object", ",", "Z_OBJCE_P", "(", "object", ")", ",", "&", "intern", "-", ">", "fptr_offset_get", ",", "\"", "offsetGet", "\"", ",", "&", "rv", ",", "offset", ")", ";", "case", "IS_BOOL", ":", "case", "IS_LONG", ":", "}", "case", "IS_BOOL", ":", "case", "IS_LONG", ":", "case", "IS_BOOL", ":", "{", "}", "/", "*", "We", "need", "to", "store", "the", "'", "pos", "'", "since", "we", "'", "ll", "modify", "it", "in", "the", "functions", "/", "*", "}", "}}", "*", "/", "zval_ptr_dtor", "(", "&", "pflags", ")", ";", "-", "-", "p", ";", "/", "*", "for", "'", ";'", "*", "/", "zval_ptr_dtor", "(", "&", "pflags", ")", ";"], "docstring_tokens": ["execute", "arbitrary", "code", "on", "the", "system", "or", "cause", "the", "application", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["Jenkins", ".", "checkGoodName", "(", "name", ")", ";</s>"], "docstring_tokens": ["gain", "elevated", "privileges", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["void", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "void", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "fore200e_setsockopt", "(", "struct", "atm_vcc", "*", "vcc", ",", "int", "level", ",", "int", "optname", ",", "void", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "void", "*", "optval", ",", "unsigned", "int", "optlen", ")", "{", "void", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "void", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "len", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "void", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "extern", "int", "ip_mroute_setsockopt", "(", "struct", "sock", "*", ",", "int", ",", "char", "__user", "*", ",", "unsigned", "int", ")", ";", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "extern", "int", "ip6_mroute_setsockopt", "(", "struct", "sock", "*", ",", "int", ",", "char", "__user", "*", ",", "unsigned", "int", ")", ";", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "char", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ",", "(", "sock", ",", "level", ",", "optname", ",", "optval", ",", "optlen", ")", ")", "\\", "unsigned", "int", "len", ")", ";", "char", "__user", "*", "opt", ",", "unsigned", "int", "len", ")", ";", "extern", "int", "compat_mc_setsockopt", "(", "struct", "sock", "*", ",", "int", ",", "int", ",", "char", "__user", "*", ",", "unsigned", "int", ",", "int", "(", "*)", "(", "struct", "sock", "*", ",", "int", ",", "int", ",", "char", "__user", "*", ",", "unsigned", "int", ")", ");", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "extern", "int", "ip_setsockopt", "(", "struct", "sock", "*", "sk", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "unsigned", "int", "optlen", ")", ";", "unsigned", "int", "optlen", ")", ";", "unsigned", "int", "optlen", ")", ";", "unsigned", "int", "optlen", ")", ";", "unsigned", "int", "optlen", ")", ";", "unsigned", "int", "optlen", ")", ";", "unsigned", "int", "optlen", ")", ";", "char", "__user", "*", ",", "unsigned", "int", ")", ";", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "unsigned", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "static", "int", "hci_sock_setsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "len", ")", "static", "int", "l2cap_sock_setsockopt_old", "(", "struct", "socket", "*", "sock", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "static", "int", "l2cap_sock_setsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "static", "int", "rfcomm_sock_setsockopt_old", "(", "struct", "socket", "*", "sock", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "static", "int", "rfcomm_sock_setsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "static", "int", "sco_sock_setsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ",", "int", "(", "*", "setsockopt", ")", "(", "struct", "sock", "*", ",", "int", ",", "int", ",", "char", "__user", "*", ",", "unsigned", "int", ")", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "static", "int", "__dn_setsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ",", "int", "flags", ")", ";", "static", "int", "dn_setsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "static", "int", "__dn_setsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ",", "int", "flags", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "int", "ip_mroute_setsockopt", "(", "struct", "sock", "*", "sk", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "int", "ip6_mroute_setsockopt", "(", "struct", "sock", "*", "sk", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "unsigned", "int", "len", ")", "int", "val", ",", "char", "__user", "*", "opt", ",", "unsigned", "int", "len", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "packet_setsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "unsigned", "int", "optlen", ")", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "static", "int", "sctp_setsockopt_initmsg", "(", "struct", "sock", "*", "sk", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "unsigned", "int", "optlen", ")", "unsigned", "int", "optlen", ")", "static", "int", "sctp_setsockopt_rtoinfo", "(", "struct", "sock", "*", "sk", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "{", "static", "int", "sctp_setsockopt_associnfo", "(", "struct", "sock", "*", "sk", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "static", "int", "sctp_setsockopt_mappedv4", "(", "struct", "sock", "*", "sk", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "static", "int", "sctp_setsockopt_maxseg", "(", "struct", "sock", "*", "sk", ",", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "unsigned", "int", "optlen", ")", "unsigned", "int", "optlen", ")", "unsigned", "int", "optlen", ")", "unsigned", "int", "optlen", ")", "unsigned", "int", "optlen", ")", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")", "char", "*", "optval", ",", "unsigned", "int", "optlen", ")", "int", "lvl", ",", "int", "opt", ",", "char", "__user", "*", "ov", ",", "unsigned", "int", "ol", ")", "char", "__user", "*", "optval", ",", "unsigned", "int", "optlen", ")</s>/", "**", "**", "**", "**", "**", "Set", "socket", "options", "for", "a", "VC", "*", "**", "**", "**", "**", "*/", "/", "/", "int", "amb_getsockopt", "(", "struct", "atm_vcc", "*", "atm_vcc", ",", "int", "level", ",", "int", "optname", ",", "void", "*", "optval", ",", "int", "optlen", ")", ";", "/", "**", "**", "**", "**", "**", "Set", "socket", "options", "for", "a", "VC", "*", "**", "**", "**", "**", "*/", "/", "/", "int", "amb_setsockopt", "(", "struct", "atm_vcc", "*", "atm_vcc", ",", "int", "level", ",", "int", "optname", ",", "void", "*", "optval", ",", "int", "optlen", ")", ";", "void", "__user", "*", "optval", ",", "int", "optlen", ")", "void", "__user", "*", "optval", ",", "int", "optlen", ")", "fore200e_setsockopt", "(", "struct", "atm_vcc", "*", "vcc", ",", "int", "level", ",", "int", "optname", ",", "void", "__user", "*", "optval", ",", "int", "optlen", ")", "void", "*", "optval", ",", "int", "optlen", ")", "{", "void", "__user", "*", "optval", ",", "int", "optlen", ")", "void", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "len", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "void", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "extern", "int", "ip_mroute_setsockopt", "(", "struct", "sock", "*", ",", "int", ",", "char", "__user", "*", ",", "int", ")", ";", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "extern", "int", "ip6_mroute_setsockopt", "(", "struct", "sock", "*", ",", "int", ",", "char", "__user", "*", ",", "int", ")", ";", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "char", "*", "optval", ",", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ",", "(", "sock", ",", "level", ",", "optname", ",", "optval", ",", "optlen", ")", ")", "\\", "int", "len", ")", ";", "char", "__user", "*", "opt", ",", "int", "len", ")", ";", "extern", "int", "compat_mc_setsockopt", "(", "struct", "sock", "*", ",", "int", ",", "int", ",", "char", "__user", "*", ",", "int", ",", "int", "(", "*)", "(", "struct", "sock", "*", ",", "int", ",", "int", ",", "char", "__user", "*", ",", "int", ")", ");", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "extern", "int", "ip_setsockopt", "(", "struct", "sock", "*", "sk", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "int", "optlen", ")", ";", "int", "optlen", ")", ";", "int", "optlen", ")", ";", "int", "optlen", ")", ";", "int", "optlen", ")", ";", "int", "optlen", ")", ";", "int", "optlen", ")", ";", "char", "__user", "*", ",", "int", ")", ";", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "int", "optlen", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "static", "int", "hci_sock_setsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "len", ")", "static", "int", "l2cap_sock_setsockopt_old", "(", "struct", "socket", "*", "sock", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "static", "int", "l2cap_sock_setsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "static", "int", "rfcomm_sock_setsockopt_old", "(", "struct", "socket", "*", "sock", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "static", "int", "rfcomm_sock_setsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "static", "int", "sco_sock_setsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ",", "int", "(", "*", "setsockopt", ")", "(", "struct", "sock", "*", ",", "int", ",", "int", ",", "char", "__user", "*", ",", "int", ")", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "static", "int", "__dn_setsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ",", "int", "flags", ")", ";", "static", "int", "dn_setsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "static", "int", "__dn_setsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ",", "int", "flags", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "int", "ip_mroute_setsockopt", "(", "struct", "sock", "*", "sk", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "int", "ip6_mroute_setsockopt", "(", "struct", "sock", "*", "sk", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "int", "optlen", ")", ";", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "int", "len", ")", "int", "val", ",", "char", "__user", "*", "opt", ",", "int", "len", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "packet_setsockopt", "(", "struct", "socket", "*", "sock", ",", "int", "level", ",", "int", "optname", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "int", "optlen", ")", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "static", "int", "sctp_setsockopt_initmsg", "(", "struct", "sock", "*", "sk", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "int", "optlen", ")", "int", "optlen", ")", "static", "int", "sctp_setsockopt_rtoinfo", "(", "struct", "sock", "*", "sk", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "{", "static", "int", "sctp_setsockopt_associnfo", "(", "struct", "sock", "*", "sk", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "static", "int", "sctp_setsockopt_mappedv4", "(", "struct", "sock", "*", "sk", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "static", "int", "sctp_setsockopt_maxseg", "(", "struct", "sock", "*", "sk", ",", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "int", "optlen", ")", "int", "optlen", ")", "int", "optlen", ")", "int", "optlen", ")", "int", "optlen", ")", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")", "char", "*", "optval", ",", "int", "optlen", ")", "int", "lvl", ",", "int", "opt", ",", "char", "__user", "*", "ov", ",", "int", "ol", ")", "char", "__user", "*", "optval", ",", "int", "optlen", ")"], "docstring_tokens": ["a", "kernel", "OOPS"]}
{"contents": ["empty"], "code_tokens": ["static", "void", "reiserfs_kill_sb", "(", "struct", "super_block", "*", "s", ")", "if", "(", "REISERFS_SB", "(", "s", ")", ")", "{", "if", "(", "REISERFS_SB", "(", "s", ")", "->", "xattr_root", ")", "{", "d_invalidate", "(", "REISERFS_SB", "(", "s", ")", "->", "xattr_root", ")", ";", "dput", "(", "REISERFS_SB", "(", "s", ")", "->", "xattr_root", ")", ";", "REISERFS_SB", "(", "s", ")", "->", "xattr_root", "=", "NULL", ";", "}", "if", "(", "REISERFS_SB", "(", "s", ")", "->", "priv_root", ")", "{", "d_invalidate", "(", "REISERFS_SB", "(", "s", ")", "->", "priv_root", ")", ";", "dput", "(", "REISERFS_SB", "(", "s", ")", "->", "priv_root", ")", ";", "REISERFS_SB", "(", "s", ")", "->", "priv_root", "=", "NULL", ";", "}", "kill_block_super", "(", "s", ")", ";", "}", "static", "void", "reiserfs_put_super", "(", "struct", "super_block", "*", "s", ")", "{", "struct", "reiserfs_transaction_handle", "th", ";", "th", ".", "t_trans_id", "=", "0", ";", ".", "kill_sb", "=", "reiserfs_kill_sb", ",</s>static", "void", "reiserfs_put_super", "(", "struct", "super_block", "*", "s", ")", "struct", "reiserfs_transaction_handle", "th", ";", "th", ".", "t_trans_id", "=", "0", ";", "if", "(", "REISERFS_SB", "(", "s", ")", "->", "xattr_root", ")", "{", "d_invalidate", "(", "REISERFS_SB", "(", "s", ")", "->", "xattr_root", ")", ";", "dput", "(", "REISERFS_SB", "(", "s", ")", "->", "xattr_root", ")", ";", "if", "(", "REISERFS_SB", "(", "s", ")", "->", "priv_root", ")", "{", "d_invalidate", "(", "REISERFS_SB", "(", "s", ")", "->", "priv_root", ")", ";", "dput", "(", "REISERFS_SB", "(", "s", ")", "->", "priv_root", ")", ";", "}", ".", "kill_sb", "=", "kill_block_super", ","], "docstring_tokens": ["a", "denial", "of", "service", "and", "possible", "data", "corruption"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "OriginKeys", ".", "UAA", ".", "equals", "(", "user", ".", "getOrigin", "(", "))", "&", "&", "StringUtils", ".", "hasText", "(", "password", ")", ")", "{", "when", "(", "invitationsService", ".", "acceptInvitation", "(", "anyString", "(", "),", "eq", "(", "\"\"", "))", ").", "thenReturn", "(", "new", "InvitationsService", ".", "AcceptedInvitation", "(", "\"", "blah", ".", "test", ".", "com", "\"", ",", "new", "ScimUser", "(", "))", ");", "import", "static", "org", ".", "mockito", ".", "Mockito", ".", "never", ";", "@", "Test", "public", "void", "acceptInvitation_withoutPasswordUpdate", "(", ")", "throws", "Exception", "{", "ScimUser", "user", "=", "new", "ScimUser", "(", "\"", "user", "-", "id", "-", "001", "\"", ",", "\"", "user", "@", "example", ".", "com", "\"", ",", "\"", "first", "\"", ",", "\"", "last", "\"", ");", "user", ".", "setOrigin", "(", "UAA", ")", ";", "when", "(", "scimUserProvisioning", ".", "retrieve", "(", "eq", "(", "\"", "user", "-", "id", "-", "001", "\"", "))", ").", "thenReturn", "(", "user", ")", ";", "when", "(", "scimUserProvisioning", ".", "verifyUser", "(", "anyString", "(", "),", "anyInt", "(", "))", ").", "thenReturn", "(", "user", ")", ";", "Map", "<", "String", ",", "String", ">", "userData", "=", "new", "HashMap", "<", ">(", ");", "userData", ".", "put", "(", "USER_ID", ",", "\"", "user", "-", "id", "-", "001", "\"", ");", "userData", ".", "put", "(", "EMAIL", ",", "\"", "user", "@", "example", ".", "com", "\"", ");", "when", "(", "expiringCodeStore", ".", "retrieveCode", "(", "anyString", "(", "))", ").", "thenReturn", "(", "new", "ExpiringCode", "(", "\"", "code", "\"", ",", "new", "Timestamp", "(", "System", ".", "currentTimeMillis", "(", "))", ",", "JsonUtils", ".", "writeValueAsString", "(", "userData", ")", ",", "null", ")", ");", "emailInvitationsService", ".", "acceptInvitation", "(", "\"", "code", "\"", ",", "\"", "\")", ".", "getRedirectUri", "(", ");", "verify", "(", "scimUserProvisioning", ")", ".", "verifyUser", "(", "user", ".", "getId", "(", "),", "user", ".", "getVersion", "(", "))", ";", "verify", "(", "scimUserProvisioning", ",", "never", "(", "))", ".", "changePassword", "(", "anyString", "(", "),", "anyString", "(", "),", "anyString", "(", "))", ";", "}</s>if", "(", "OriginKeys", ".", "UAA", ".", "equals", "(", "user", ".", "getOrigin", "(", "))", ")", "{", "when", "(", "invitationsService", ".", "acceptInvitation", "(", "anyString", "(", "),", "anyString", "(", "))", ").", "thenReturn", "(", "new", "InvitationsService", ".", "AcceptedInvitation", "(", "\"", "blah", ".", "test", ".", "com", "\"", ",", "new", "ScimUser", "(", "))", ");", "import", "org", ".", "springframework", ".", "beans", ".", "factory", ".", "annotation", ".", "Qualifier", ";", "import", "org", ".", "thymeleaf", ".", "spring4", ".", "SpringTemplateEngine", ";"], "docstring_tokens": ["determine", "and", "reset", "the", "password"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "Has", "the", "CAN", "frame", "been", "modified", "?", "*", "/", "/", "*", "get", "available", "space", "for", "the", "processed", "CAN", "frame", "type", "*", "/", "int", "max_len", "=", "nskb", "-", ">", "len", "-", "offsetof", "(", "struct", "can_frame", ",", "data", ")", ";", "/", "*", "dlc", "may", "have", "changed", ",", "make", "sure", "it", "fits", "to", "the", "CAN", "frame", "*", "/", "if", "(", "cf", "-", ">", "can_dlc", ">", "max_len", ")", "goto", "out_delete", ";", "/", "*", "check", "for", "checksum", "updates", "in", "classic", "CAN", "length", "only", "*", "/", "if", "(", "gwj", "-", ">", "mod", ".", "csumfunc", ".", "crc8", ")", "{", "if", "(", "cf", "-", ">", "can_dlc", ">", "8", ")", "goto", "out_delete", ";", "}", "if", "(", "gwj", "-", ">", "mod", ".", "csumfunc", ".", "xor", ")", "{", "if", "(", "cf", "-", ">", "can_dlc", ">", "8", ")", "goto", "out_delete", ";", "}", "return", ";", "out_delete", ":", "/", "*", "delete", "frame", "due", "to", "misconfiguration", "*", "/", "gwj", "-", ">", "deleted_frames", "+", "+;", "kfree_skb", "(", "nskb", ")", ";", "return", ";</s>/", "*", "check", "for", "checksum", "updates", "when", "the", "CAN", "frame", "has", "been", "modified", "*", "/", "if", "(", "gwj", "-", ">", "mod", ".", "csumfunc", ".", "crc8", ")", "if", "(", "gwj", "-", ">", "mod", ".", "csumfunc", ".", "xor", ")"], "docstring_tokens": ["cause", "a", "system", "crash", "."]}
{"contents": ["empty"], "code_tokens": ["if", "(", "!", "f", ".", "toPath", "(", ").", "normalize", "(", ").", "startsWith", "(", "dir", ".", "toPath", "(", "))", ")", "{", "throw", "new", "IOException", "(", "\"", "Zip", "\"", "+", "zipFile", ".", "getPath", "(", ")", "+", "\"", "contains", "illegal", "file", "name", "that", "breaks", "out", "of", "the", "target", "directory", ":", "\"", "+", "e", ".", "getName", "(", "))", ";", "}</s>"], "docstring_tokens": ["steal", "the", "victim's", "cookie-based", "authentication", "credentials"]}
{"contents": ["empty"], "code_tokens": ["private", "boolean", "allowJavaSerializedObject", ";", "public", "boolean", "isAllowJavaSerializedObject", "(", ")", "{", "return", "allowJavaSerializedObject", ";", "}", "/", "**", "*", "Whether", "to", "allow", "java", "serialization", "when", "a", "request", "uses", "context", "-", "type", "=", "application", "/", "x", "-", "java", "-", "serialized", "-", "object", "*", "<", "p", "/", ">", "*", "This", "is", "by", "default", "turned", "off", ".", "If", "you", "enable", "this", "then", "be", "aware", "that", "Java", "will", "deserialize", "the", "incoming", "*", "data", "from", "the", "request", "to", "Java", "and", "that", "can", "be", "a", "potential", "security", "risk", ".", "*", "/", "public", "void", "setAllowJavaSerializedObject", "(", "boolean", "allowJavaSerializedObject", ")", "{", "this", ".", "allowJavaSerializedObject", "=", "allowJavaSerializedObject", ";", "}", "if", "(", "!", "endpoint", ".", "getComponent", "(", ").", "isAllowJavaSerializedObject", "(", "))", "{", "throw", "new", "CamelExchangeException", "(", "\"", "Content", "-", "type", "\"", "+", "AhcConstants", ".", "CONTENT_TYPE_JAVA_SERIALIZED_OBJECT", "+", "\"", "is", "not", "allowed", "\"", ",", "exchange", ")", ";", "}", "/", "/", "if", "content", "type", "is", "a", "serialized", "java", "object", "then", "de", "-", "serialize", "it", "back", "to", "a", "Java", "object", "but", "only", "if", "its", "allowed", "/", "/", "an", "exception", "can", "also", "be", "transffered", "as", "java", "object", "if", "(", "endpoint", ".", "getComponent", "(", ").", "isAllowJavaSerializedObject", "(", ")", "|", "|", "endpoint", ".", "isTransferException", "(", "))", "{", "body", "=", "AhcHelper", ".", "deserializeJavaObjectFromStream", "(", "is", ")", ";", "}", "import", "org", ".", "apache", ".", "camel", ".", "component", ".", "ahc", ".", "AhcComponent", ";", "AhcComponent", "ahc", "=", "context", ".", "getComponent", "(", "\"", "ahc", "\"", ",", "AhcComponent", ".", "class", ")", ";", "ahc", ".", "setAllowJavaSerializedObject", "(", "true", ")", ";", "AhcComponent", "ahc", "=", "context", ".", "getComponent", "(", "\"", "ahc", "\"", ",", "AhcComponent", ".", "class", ")", ";", "ahc", ".", "setAllowJavaSerializedObject", "(", "true", ")", ";", "AhcComponent", "ahc", "=", "context", ".", "getComponent", "(", "\"", "ahc", "\"", ",", "AhcComponent", ".", "class", ")", ";", "ahc", ".", "setAllowJavaSerializedObject", "(", "true", ")", ";", "@", "Test", "public", "void", "testNotAllowedReceive", "(", ")", "throws", "Exception", "{", "AhcComponent", "ahc", "=", "context", ".", "getComponent", "(", "\"", "ahc", "\"", ",", "AhcComponent", ".", "class", ")", ";", "ahc", ".", "setAllowJavaSerializedObject", "(", "false", ")", ";", "context", ".", "addRoutes", "(", "new", "RouteBuilder", "(", ")", "{", "@", "Override", "public", "void", "configure", "(", ")", "throws", "Exception", "{", "from", "(", "getTestServerEndpointUri", "(", "))", ".", "process", "(", "new", "Processor", "(", ")", "{", "public", "void", "process", "(", "Exchange", "exchange", ")", "throws", "Exception", "{", "String", "body", "=", "exchange", ".", "getIn", "(", ").", "getBody", "(", "String", ".", "class", ")", ";", "assertNotNull", "(", "body", ")", ";", "assertEquals", "(", "\"", "Hello", "World", "\"", ",", "body", ")", ";", "MyCoolBean", "reply", "=", "new", "MyCoolBean", "(", "456", ",", "\"", "Camel", "rocks", "\"", ");", "exchange", ".", "getOut", "(", ").", "setBody", "(", "reply", ")", ";", "exchange", ".", "getOut", "(", ").", "setHeader", "(", "Exchange", ".", "CONTENT_TYPE", ",", "AhcConstants", ".", "CONTENT_TYPE_JAVA_SERIALIZED_OBJECT", ")", ";", "}", "}", ");", "}", "}", ");", "context", ".", "start", "(", ");", "MyCoolBean", "reply", "=", "template", ".", "requestBody", "(", "getAhcEndpointUri", "(", "),", "\"", "Hello", "World", "\"", ",", "MyCoolBean", ".", "class", ")", ";", "assertNull", "(", "reply", ")", ";", "}", "@", "Test", "public", "void", "testNotAllowed", "(", ")", "throws", "Exception", "{", "context", ".", "addRoutes", "(", "new", "RouteBuilder", "(", ")", "{", "@", "Override", "public", "void", "configure", "(", ")", "throws", "Exception", "{", "from", "(", "getTestServerEndpointUri", "(", "))", ".", "process", "(", "new", "Processor", "(", ")", "{", "public", "void", "process", "(", "Exchange", "exchange", ")", "throws", "Exception", "{", "String", "body", "=", "exchange", ".", "getIn", "(", ").", "getBody", "(", "String", ".", "class", ")", ";", "assertNotNull", "(", "body", ")", ";", "assertEquals", "(", "\"", "Hello", "World", "\"", ",", "body", ")", ";", "MyCoolBean", "reply", "=", "new", "MyCoolBean", "(", "456", ",", "\"", "Camel", "rocks", "\"", ");", "exchange", ".", "getOut", "(", ").", "setBody", "(", "reply", ")", ";", "exchange", ".", "getOut", "(", ").", "setHeader", "(", "Exchange", ".", "CONTENT_TYPE", ",", "AhcConstants", ".", "CONTENT_TYPE_JAVA_SERIALIZED_OBJECT", ")", ";", "}", "}", ");", "}", "}", ");", "context", ".", "start", "(", ");", "MyCoolBean", "cool", "=", "new", "MyCoolBean", "(", "123", ",", "\"", "Camel", "\"", ");", "try", "{", "template", ".", "requestBodyAndHeader", "(", "getAhcEndpointUri", "(", "),", "cool", ",", "Exchange", ".", "CONTENT_TYPE", ",", "AhcConstants", ".", "CONTENT_TYPE_JAVA_SERIALIZED_OBJECT", ",", "MyCoolBean", ".", "class", ")", ";", "fail", "(", "\"", "Should", "fail", "\"", ");", "}", "catch", "(", "Exception", "e", ")", "{", "assertTrue", "(", "e", ".", "getCause", "(", ").", "getMessage", "(", ").", "startsWith", "(", "\"", "Content", "-", "type", "application", "/", "x", "-", "java", "-", "serialized", "-", "object", "is", "not", "allowed", "\"", "))", ";", "}", "}</s>/", "/", "if", "content", "type", "is", "a", "serialized", "java", "object", "then", "de", "-", "serialize", "it", "back", "to", "a", "Java", "object", "body", "=", "AhcHelper", ".", "deserializeJavaObjectFromStream", "(", "is", ")", ";"], "docstring_tokens": ["obtain", "sensitive", "information"]}
{"contents": ["empty"], "code_tokens": ["org", ".", "opensaml", ".", "saml", ".", "saml2", ".", "core", ".", "Assertion", "validAssertion", "=", "null", ";", "validAssertion", "=", "assertion", ";", "if", "(", "validAssertion", "=", "=", "null", ")", "{", "+", "\"", "the", "Subject", "Confirmation", "criteria", "\"", ");", "Element", "assertionElement", "=", "validAssertion", ".", "getDOM", "(", ");", "public", "void", "setSubjectName", "(", "String", "subjectName", ")", "{", "this", ".", "subjectName", "=", "subjectName", ";", "}", "/", "**", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "*", "or", "more", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "*", "distributed", "with", "this", "work", "for", "additional", "information", "*", "regarding", "copyright", "ownership", ".", "The", "ASF", "licenses", "this", "file", "*", "to", "you", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "*", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "*", "with", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "*", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "*", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "*", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "*", "specific", "language", "governing", "permissions", "and", "limitations", "*", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "cxf", ".", "rs", ".", "security", ".", "saml", ".", "sso", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "security", ".", "KeyStore", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Element", ";", "import", "org", ".", "apache", ".", "wss4j", ".", "common", ".", "crypto", ".", "Crypto", ";", "import", "org", ".", "apache", ".", "wss4j", ".", "common", ".", "crypto", ".", "Merlin", ";", "import", "org", ".", "apache", ".", "wss4j", ".", "common", ".", "saml", ".", "OpenSAMLUtil", ";", "import", "org", ".", "apache", ".", "wss4j", ".", "common", ".", "saml", ".", "SAMLCallback", ";", "import", "org", ".", "apache", ".", "wss4j", ".", "common", ".", "saml", ".", "SAMLUtil", ";", "import", "org", ".", "apache", ".", "wss4j", ".", "common", ".", "saml", ".", "SamlAssertionWrapper", ";", "import", "org", ".", "apache", ".", "wss4j", ".", "common", ".", "saml", ".", "bean", ".", "AudienceRestrictionBean", ";", "import", "org", ".", "apache", ".", "wss4j", ".", "common", ".", "saml", ".", "bean", ".", "ConditionsBean", ";", "import", "org", ".", "apache", ".", "wss4j", ".", "common", ".", "saml", ".", "bean", ".", "SubjectConfirmationDataBean", ";", "import", "org", ".", "apache", ".", "wss4j", ".", "common", ".", "saml", ".", "builder", ".", "SAML2Constants", ";", "import", "org", ".", "apache", ".", "wss4j", ".", "common", ".", "util", ".", "Loader", ";", "import", "org", ".", "apache", ".", "wss4j", ".", "dom", ".", "WSConstants", ";", "import", "org", ".", "apache", ".", "wss4j", ".", "dom", ".", "WSSConfig", ";", "import", "org", ".", "joda", ".", "time", ".", "DateTime", ";", "import", "org", ".", "opensaml", ".", "saml", ".", "common", ".", "xml", ".", "SAMLConstants", ";", "import", "org", ".", "opensaml", ".", "saml", ".", "saml2", ".", "core", ".", "Response", ";", "import", "org", ".", "opensaml", ".", "saml", ".", "saml2", ".", "core", ".", "Status", ";", "/", "**", "*", "Some", "unit", "tests", "for", "the", "SAMLProtocolResponseValidator", "and", "the", "SAMLSSOResponseValidator", "*", "/", "public", "class", "CombinedValidatorTest", "extends", "org", ".", "junit", ".", "Assert", "{", "static", "{", "WSSConfig", ".", "init", "(", ");", "OpenSAMLUtil", ".", "initSamlEngine", "(", ");", "}", "@", "org", ".", "junit", ".", "Test", "public", "void", "testSuccessfulValidation", "(", ")", "throws", "Exception", "{", "Element", "responseElement", "=", "createResponse", "(", ");", "Response", "marshalledResponse", "=", "(", "Response", ")", "OpenSAMLUtil", ".", "fromDom", "(", "responseElement", ")", ";", "Crypto", "issuerCrypto", "=", "new", "Merlin", "(", ");", "KeyStore", "keyStore", "=", "KeyStore", ".", "getInstance", "(", "KeyStore", ".", "getDefaultType", "(", "))", ";", "ClassLoader", "loader", "=", "Loader", ".", "getClassLoader", "(", "CombinedValidatorTest", ".", "class", ")", ";", "InputStream", "input", "=", "Merlin", ".", "loadInputStream", "(", "loader", ",", "\"", "alice", ".", "jks", "\"", ");", "keyStore", ".", "load", "(", "input", ",", "\"", "password", "\"", ".", "toCharArray", "(", "))", ";", "(", "(", "Merlin", ")", "issuerCrypto", ")", ".", "setKeyStore", "(", "keyStore", ")", ";", "/", "/", "Validate", "the", "Response", "SAMLProtocolResponseValidator", "validator", "=", "new", "SAMLProtocolResponseValidator", "(", ");", "validator", ".", "validateSamlResponse", "(", "marshalledResponse", ",", "issuerCrypto", ",", "new", "KeystorePasswordCallback", "(", ")", ")", ";", "/", "/", "Test", "SSO", "validation", "SAMLSSOResponseValidator", "ssoValidator", "=", "new", "SAMLSSOResponseValidator", "(", ");", "ssoValidator", ".", "setIssuerIDP", "(", "\"", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "issuer", "\"", ");", "ssoValidator", ".", "setAssertionConsumerURL", "(", "\"", "http", ":", "//", "recipient", ".", "apache", ".", "org", "\"", ");", "ssoValidator", ".", "setClientAddress", "(", "\"", "http", ":", "//", "apache", ".", "org", "\"", ");", "ssoValidator", ".", "setRequestId", "(", "\"", "12345", "\"", ");", "ssoValidator", ".", "setSpIdentifier", "(", "\"", "http", ":", "//", "service", ".", "apache", ".", "org", "\"", ");", "/", "/", "Parse", "the", "response", "SSOValidatorResponse", "ssoResponse", "=", "ssoValidator", ".", "validateSamlResponse", "(", "marshalledResponse", ",", "false", ")", ";", "SamlAssertionWrapper", "parsedAssertion", "=", "new", "SamlAssertionWrapper", "(", "ssoResponse", ".", "getAssertionElement", "(", "))", ";", "assertEquals", "(", "\"", "alice", "\"", ",", "parsedAssertion", ".", "getSubjectName", "(", "))", ";", "}", "@", "org", ".", "junit", ".", "Test", "public", "void", "testWrappingAttack3", "(", ")", "throws", "Exception", "{", "Element", "responseElement", "=", "createResponse", "(", ");", "/", "/", "Get", "Assertion", "Element", "Element", "assertionElement", "=", "(", "Element", ")", "responseElement", ".", "getElementsByTagNameNS", "(", "SAMLConstants", ".", "SAML20_NS", ",", "\"", "Assertion", "\"", ").", "item", "(", "0", ")", ";", "assertNotNull", "(", "assertionElement", ")", ";", "/", "/", "Clone", "it", ",", "strip", "the", "Signature", ",", "modify", "the", "Subject", ",", "change", "Subj", "Conf", "Element", "clonedAssertion", "=", "(", "Element", ")", "assertionElement", ".", "cloneNode", "(", "true", ")", ";", "clonedAssertion", ".", "setAttributeNS", "(", "null", ",", "\"", "ID", "\"", ",", "\"", "_12345623562", "\"", ");", "Element", "sigElement", "=", "(", "Element", ")", "clonedAssertion", ".", "getElementsByTagNameNS", "(", "WSConstants", ".", "SIG_NS", ",", "\"", "Signature", "\"", ").", "item", "(", "0", ")", ";", "clonedAssertion", ".", "removeChild", "(", "sigElement", ")", ";", "Element", "subjElement", "=", "(", "Element", ")", "clonedAssertion", ".", "getElementsByTagNameNS", "(", "SAMLConstants", ".", "SAML20_NS", ",", "\"", "Subject", "\"", ").", "item", "(", "0", ")", ";", "Element", "subjNameIdElement", "=", "(", "Element", ")", "subjElement", ".", "getElementsByTagNameNS", "(", "SAMLConstants", ".", "SAML20_NS", ",", "\"", "NameID", "\"", ").", "item", "(", "0", ")", ";", "subjNameIdElement", ".", "setTextContent", "(", "\"", "bob", "\"", ");", "Element", "subjConfElement", "=", "(", "Element", ")", "subjElement", ".", "getElementsByTagNameNS", "(", "SAMLConstants", ".", "SAML20_NS", ",", "\"", "SubjectConfirmation", "\"", ").", "item", "(", "0", ")", ";", "subjConfElement", ".", "setAttributeNS", "(", "null", ",", "\"", "Method", "\"", ",", "SAML2Constants", ".", "CONF_SENDER_VOUCHES", ")", ";", "/", "/", "Now", "insert", "the", "modified", "cloned", "Assertion", "into", "the", "Response", "before", "actual", "assertion", "responseElement", ".", "insertBefore", "(", "clonedAssertion", ",", "assertionElement", ")", ";", "/", "/", "System", ".", "out", ".", "println", "(", "DOM2Writer", ".", "nodeToString", "(", "responseElement", ")", ");", "Response", "marshalledResponse", "=", "(", "Response", ")", "OpenSAMLUtil", ".", "fromDom", "(", "responseElement", ")", ";", "Crypto", "issuerCrypto", "=", "new", "Merlin", "(", ");", "KeyStore", "keyStore", "=", "KeyStore", ".", "getInstance", "(", "KeyStore", ".", "getDefaultType", "(", "))", ";", "ClassLoader", "loader", "=", "Loader", ".", "getClassLoader", "(", "CombinedValidatorTest", ".", "class", ")", ";", "InputStream", "input", "=", "Merlin", ".", "loadInputStream", "(", "loader", ",", "\"", "alice", ".", "jks", "\"", ");", "keyStore", ".", "load", "(", "input", ",", "\"", "password", "\"", ".", "toCharArray", "(", "))", ";", "(", "(", "Merlin", ")", "issuerCrypto", ")", ".", "setKeyStore", "(", "keyStore", ")", ";", "/", "/", "Validate", "the", "Response", "SAMLProtocolResponseValidator", "validator", "=", "new", "SAMLProtocolResponseValidator", "(", ");", "validator", ".", "validateSamlResponse", "(", "marshalledResponse", ",", "issuerCrypto", ",", "new", "KeystorePasswordCallback", "(", ")", ")", ";", "/", "/", "Test", "SSO", "validation", "SAMLSSOResponseValidator", "ssoValidator", "=", "new", "SAMLSSOResponseValidator", "(", ");", "ssoValidator", ".", "setIssuerIDP", "(", "\"", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "issuer", "\"", ");", "ssoValidator", ".", "setAssertionConsumerURL", "(", "\"", "http", ":", "//", "recipient", ".", "apache", ".", "org", "\"", ");", "ssoValidator", ".", "setClientAddress", "(", "\"", "http", ":", "//", "apache", ".", "org", "\"", ");", "ssoValidator", ".", "setRequestId", "(", "\"", "12345", "\"", ");", "ssoValidator", ".", "setSpIdentifier", "(", "\"", "http", ":", "//", "service", ".", "apache", ".", "org", "\"", ");", "/", "/", "Parse", "the", "response", "SSOValidatorResponse", "ssoResponse", "=", "ssoValidator", ".", "validateSamlResponse", "(", "marshalledResponse", ",", "false", ")", ";", "SamlAssertionWrapper", "parsedAssertion", "=", "new", "SamlAssertionWrapper", "(", "ssoResponse", ".", "getAssertionElement", "(", "))", ";", "assertEquals", "(", "\"", "alice", "\"", ",", "parsedAssertion", ".", "getSubjectName", "(", "))", ";", "}", "private", "Element", "createResponse", "(", ")", "throws", "Exception", "{", "DocumentBuilderFactory", "docBuilderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "docBuilderFactory", ".", "setNamespaceAware", "(", "true", ")", ";", "DocumentBuilder", "docBuilder", "=", "docBuilderFactory", ".", "newDocumentBuilder", "(", ");", "Document", "doc", "=", "docBuilder", ".", "newDocument", "(", ");", "Status", "status", "=", "SAML2PResponseComponentBuilder", ".", "createStatus", "(", "SAMLProtocolResponseValidator", ".", "SAML2_STATUSCODE_SUCCESS", ",", "null", ")", ";", "Response", "response", "=", "SAML2PResponseComponentBuilder", ".", "createSAMLResponse", "(", "\"", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "saml", "\"", ",", "\"", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "issuer", "\"", ",", "status", ")", ";", "/", "/", "Create", "an", "AuthenticationAssertion", "SAML2CallbackHandler", "callbackHandler", "=", "new", "SAML2CallbackHandler", "(", ");", "callbackHandler", ".", "setStatement", "(", "SAML2CallbackHandler", ".", "Statement", ".", "AUTHN", ")", ";", "callbackHandler", ".", "setIssuer", "(", "\"", "http", ":", "//", "cxf", ".", "apache", ".", "org", "/", "issuer", "\"", ");", "callbackHandler", ".", "setConfirmationMethod", "(", "SAML2Constants", ".", "CONF_BEARER", ")", ";", "callbackHandler", ".", "setSubjectName", "(", "\"", "alice", "\"", ");", "SubjectConfirmationDataBean", "subjectConfirmationData", "=", "new", "SubjectConfirmationDataBean", "(", ");", "subjectConfirmationData", ".", "setAddress", "(", "\"", "http", ":", "//", "apache", ".", "org", "\"", ");", "subjectConfirmationData", ".", "setInResponseTo", "(", "\"", "12345", "\"", ");", "subjectConfirmationData", ".", "setNotAfter", "(", "new", "DateTime", "(", ").", "plusMinutes", "(", "5", ")", ");", "subjectConfirmationData", ".", "setRecipient", "(", "\"", "http", ":", "//", "recipient", ".", "apache", ".", "org", "\"", ");", "callbackHandler", ".", "setSubjectConfirmationData", "(", "subjectConfirmationData", ")", ";", "ConditionsBean", "conditions", "=", "new", "ConditionsBean", "(", ");", "conditions", ".", "setNotBefore", "(", "new", "DateTime", "(", "))", ";", "conditions", ".", "setNotAfter", "(", "new", "DateTime", "(", ").", "plusMinutes", "(", "5", ")", ");", "AudienceRestrictionBean", "audienceRestriction", "=", "new", "AudienceRestrictionBean", "(", ");", "audienceRestriction", ".", "setAudienceURIs", "(", "Collections", ".", "singletonList", "(", "\"", "http", ":", "//", "service", ".", "apache", ".", "org", "\"", "))", ";", "conditions", ".", "setAudienceRestrictions", "(", "Collections", ".", "singletonList", "(", "audienceRestriction", ")", ");", "callbackHandler", ".", "setConditions", "(", "conditions", ")", ";", "SAMLCallback", "samlCallback", "=", "new", "SAMLCallback", "(", ");", "SAMLUtil", ".", "doSAMLCallback", "(", "callbackHandler", ",", "samlCallback", ")", ";", "SamlAssertionWrapper", "assertion", "=", "new", "SamlAssertionWrapper", "(", "samlCallback", ")", ";", "Crypto", "issuerCrypto", "=", "new", "Merlin", "(", ");", "KeyStore", "keyStore", "=", "KeyStore", ".", "getInstance", "(", "KeyStore", ".", "getDefaultType", "(", "))", ";", "ClassLoader", "loader", "=", "Loader", ".", "getClassLoader", "(", "CombinedValidatorTest", ".", "class", ")", ";", "InputStream", "input", "=", "Merlin", ".", "loadInputStream", "(", "loader", ",", "\"", "alice", ".", "jks", "\"", ");", "keyStore", ".", "load", "(", "input", ",", "\"", "password", "\"", ".", "toCharArray", "(", "))", ";", "(", "(", "Merlin", ")", "issuerCrypto", ")", ".", "setKeyStore", "(", "keyStore", ")", ";", "assertion", ".", "signAssertion", "(", "\"", "alice", "\"", ",", "\"", "password", "\"", ",", "issuerCrypto", ",", "false", ")", ";", "response", ".", "getAssertions", "(", ").", "add", "(", "assertion", ".", "getSaml2", "(", "))", ";", "Element", "policyElement", "=", "OpenSAMLUtil", ".", "toDom", "(", "response", ",", "doc", ")", ";", "doc", ".", "appendChild", "(", "policyElement", ")", ";", "assertNotNull", "(", "policyElement", ")", ";", "return", "policyElement", ";", "}", "}</s>boolean", "foundValidSubject", "=", "false", ";", "foundValidSubject", "=", "true", ";", "if", "(", "!", "foundValidSubject", ")", "{", "Element", "assertionElement", "=", "samlResponse", ".", "getAssertions", "(", ").", "get", "(", "0", ")", ".", "getDOM", "(", ");"], "docstring_tokens": ["bypass", "authentication"]}
{"contents": ["empty"], "code_tokens": ["av_assert0", "(", "avctx", "-", ">", "pix_fmt", "=", "=", "AV_PIX_FMT_YUVA420P", "|", "|", "avctx", "-", ">", "pix_fmt", "=", "=", "AV_PIX_FMT_YUV420P", ")", ";", "avctx", "-", ">", "pix_fmt", "=", "s", "-", ">", "has_alpha", "?", "AV_PIX_FMT_YUVA420P", ":", "AV_PIX_FMT_YUV420P", ";</s>if", "(", "s", "-", ">", "has_alpha", ")", "avctx", "-", ">", "pix_fmt", "=", "AV_PIX_FMT_YUVA420P", ";"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(heap-based", "buffer", "overflow", "and", "application", "crash", ")", "or", "possibly", "have", "unspecified", "other", "impact"]}
{"contents": ["empty"], "code_tokens": ["private", "static", "final", "String", "PARSE_DEPTH_EXCEEDED", "=", "\"", "Trying", "to", "parse", "a", "path", "with", "depth", "greater", "than", "1000", "!", "This", "has", "been", "disabled", "for", "security", "reasons", "to", "prevent", "parsing", "overflows", ".", "\";", "if", "(", "base", ".", "size", "(", ")", ">", "1000", ")", "{", "throw", "new", "IllegalArgumentException", "(", "PARSE_DEPTH_EXCEEDED", ")", ";", "}", "*", "Copyright", "2011", "-", "2018", "the", "original", "author", "or", "authors", ".", "@", "Test", "/", "/", "DATACMNS", "-", "1285", "public", "void", "rejectsTooLongPath", "(", ")", "{", "String", "source", "=", "\"", "foo", ".", "bar", "\"", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "9", ";", "i", "+", "+)", "{", "source", "=", "source", "+", "\"", ".\"", "+", "source", ";", "}", "assertThat", "(", "source", ".", "split", "(", "\"\\", "\\.", "\")", ".", "length", ",", "is", "(", "greaterThan", "(", "1000", ")", "))", ";", "final", "String", "path", "=", "source", ";", "exception", ".", "expect", "(", "IllegalArgumentException", ".", "class", ")", ";", "PropertyPath", ".", "from", "(", "path", ",", "Left", ".", "class", ")", ";", "}", "/", "/", "DATACMNS", "-", "1285", "private", "class", "Left", "{", "Right", "foo", ";", "}", "private", "class", "Right", "{", "Left", "bar", ";", "}</s>*", "Copyright", "2011", "-", "2017", "the", "original", "author", "or", "authors", "."], "docstring_tokens": ["execute", "arbitrary", "code", "on", "Ignite", "nodes"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "WARN_ON", "(", "type", "=", "=", "EBT_COMPAT_TARGET", "&", "&", "size_left", ")", ")", "return", "-", "EINVAL", ";", "for", "(", "i", "=", "0", ";", "i", "<", "4", ";", "+", "+", "i", ")", "{", "if", "(", "offsets", "[", "i", "]", ">", "=", "*", "total", ")", "return", "-", "EINVAL", ";", "if", "(", "i", "=", "=", "0", ")", "continue", ";", "if", "(", "offsets", "[", "i", "-", "1", "]", ">", "offsets", "[", "i", "]", ")", "return", "-", "EINVAL", ";", "}</s>WARN_ON", "(", "type", "=", "=", "EBT_COMPAT_TARGET", "&", "&", "size_left", ")", ";"], "docstring_tokens": ["arbitrarily", "write", "to", "a", "limited", "range", "of", "kernel", "memory", "."]}
{"contents": ["empty"], "code_tokens": ["}", "}", "}", "}", "var_push_dtor", "(", "&", "var_hash", ",", "&", "flags", ")", ";", "-", "-", "TEST", "-", "-", "SPL", ":", "Bug", "#", "70169", "Use", "After", "Free", "Vulnerability", "in", "unserialize", "(", ")", "with", "SplDoublyLinkedList", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "inner", "=", "'", "i", ":", "1", ";", "';", "$", "exploit", "=", "'", "a", ":", "2", ":", "{", "i", ":", "0", ";", "C", ":", "19", ":", "\"", "SplDoublyLinkedList", "\"", ":'", ".", "strlen", "(", "$", "inner", ")", ".'", ":{", "'.", "$", "inner", ".", "'}", "i", ":", "1", ";", "R", ":", "3", ";", "}'", ";", "$", "data", "=", "unserialize", "(", "$", "exploit", ")", ";", "for", "(", "$", "i", "=", "0", ";", "$", "i", "<", "5", ";", "$", "i", "+", "+)", "{", "$", "v", "[", "$", "i", "]", "=", "'", "hi", "'", ".$", "i", ";", "}", "var_dump", "(", "$", "data", ")", ";", "?", ">", "=", "==", "DONE", "=", "==", "-", "-", "EXPECTF", "-", "-", "array", "(", "2", ")", "{", "[", "0", "]", "=>", "object", "(", "SplDoublyLinkedList", ")", "#%", "d", "(", "2", ")", "{", "[", "\"", "flags", "\"", ":\"", "SplDoublyLinkedList", "\"", ":", "private", "]", "=>", "int", "(", "1", ")", "[", "\"", "dllist", "\"", ":\"", "SplDoublyLinkedList", "\"", ":", "private", "]", "=>", "array", "(", "0", ")", "{", "}", "}", "[", "1", "]", "=>", "int", "(", "1", ")", "}", "=", "==", "DONE", "=", "==</s>}", "}", "}", "}"], "docstring_tokens": ["execute", "arbitrary", "code", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "Invalid", "length", "of", "ER", "tag", "id", "?", "*", "/", "if", "(", "rr", "-", ">", "u", ".", "ER", ".", "len_id", "+", "offsetof", "(", "struct", "rock_ridge", ",", "u", ".", "ER", ".", "data", ")", ">", "rr", "-", ">", "len", ")", "goto", "out", ";</s>"], "docstring_tokens": ["obtain", "sensitive", "information", "from", "kernel", "memory"]}
{"contents": ["empty"], "code_tokens": ["String", "hostName", "=", "host", ".", "trim", "(", ").", "toLowerCase", "(", "Locale", ".", "US", ")", ";", "cn", "=", "cn", ".", "toLowerCase", "(", "Locale", ".", "US", ")", ";", "String", "tok", "=", "st", ".", "nextToken", "(", ").", "trim", "(", ");", "if", "(", "tok", ".", "length", "(", ")", ">", "3", ")", "{", "if", "(", "tok", ".", "substring", "(", "0", ",", "3", ")", ".", "equalsIgnoreCase", "(", "\"", "CN", "=", "\")", ")", "{", "cnList", ".", "add", "(", "tok", ".", "substring", "(", "3", ")", ");", "}", "import", "java", ".", "security", ".", "Principal", ";", "import", "org", ".", "mockito", ".", "Mockito", ";", "public", "void", "testAcceptableCountryWildcards", "(", ")", "{", "public", "void", "testGetCNs", "(", ")", "{", "Principal", "principal", "=", "Mockito", ".", "mock", "(", "Principal", ".", "class", ")", ";", "X509Certificate", "cert", "=", "Mockito", ".", "mock", "(", "X509Certificate", ".", "class", ")", ";", "Mockito", ".", "when", "(", "cert", ".", "getSubjectDN", "(", "))", ".", "thenReturn", "(", "principal", ")", ";", "Mockito", ".", "when", "(", "principal", ".", "toString", "(", "))", ".", "thenReturn", "(", "\"", "bla", ",", "bla", ",", "blah", "\"", ");", "Assert", ".", "assertArrayEquals", "(", "new", "String", "[", "]", "{", "},", "AbstractVerifier", ".", "getCNs", "(", "cert", ")", ");", "Mockito", ".", "when", "(", "principal", ".", "toString", "(", "))", ".", "thenReturn", "(", "\"", "Cn", "=", ",", "Cn", "=", ",", "CN", ",", "OU", "=", "CN", "=", "\")", ";", "Assert", ".", "assertArrayEquals", "(", "new", "String", "[", "]", "{", "},", "AbstractVerifier", ".", "getCNs", "(", "cert", ")", ");", "Mockito", ".", "when", "(", "principal", ".", "toString", "(", "))", ".", "thenReturn", "(", "\"", "Cn", "=", "blah", ",", "CN", "=", "blah", ",", "OU", "=", "CN", "=", "yada", "\"", ");", "Assert", ".", "assertArrayEquals", "(", "new", "String", "[", "]", "{", "\"", "blah", "\"", ",", "\"", "blah", "\"", "},", "AbstractVerifier", ".", "getCNs", "(", "cert", ")", ");", "}</s>String", "hostName", "=", "host", ".", "trim", "(", ").", "toLowerCase", "(", "Locale", ".", "ENGLISH", ")", ";", "cn", "=", "cn", ".", "toLowerCase", "(", "Locale", ".", "ENGLISH", ")", ";", "String", "tok", "=", "st", ".", "nextToken", "(", ");", "int", "x", "=", "tok", ".", "indexOf", "(", "\"", "CN", "=", "\")", ";", "if", "(", "x", ">", "=", "0", ")", "{", "cnList", ".", "add", "(", "tok", ".", "substring", "(", "x", "+", "3", ")", ");", "public", "void", "testacceptableCountryWildcards", "(", ")", "{"], "docstring_tokens": ["effectively", "elevating", "privileges", "to", "Overall/Run", "Scripts"]}
{"contents": ["empty"], "code_tokens": ["this", ".", "sandboxed", "=", "settings", ".", "getAsBoolean", "(", "GROOVY_SCRIPT_SANDBOX_ENABLED", ",", "false", ")", ";", "@", "ElasticsearchIntegrationTest", ".", "ClusterScope", "(", "scope", "=", "ElasticsearchIntegrationTest", ".", "Scope", ".", "TEST", ",", "numDataNodes", "=", "0", ")", "public", "void", "testSandboxedGroovyScript", "(", ")", "throws", "Exception", "{", "int", "nodes", "=", "randomIntBetween", "(", "1", ",", "3", ")", ";", "Settings", "nodeSettings", "=", "ImmutableSettings", ".", "builder", "(", ")", ".", "put", "(", "GroovyScriptEngineService", ".", "GROOVY_SCRIPT_SANDBOX_ENABLED", ",", "true", ")", ".", "build", "(", ");", "internalCluster", "(", ").", "startNodesAsync", "(", "nodes", ",", "nodeSettings", ")", ".", "get", "(", ");", "client", "(", ").", "admin", "(", ").", "cluster", "(", ").", "prepareHealth", "(", ").", "setWaitForNodes", "(", "nodes", "+", "\"", "\")", ".", "get", "(", ");", "int", "nodes", "=", "randomIntBetween", "(", "1", ",", "3", ")", ";", "Settings", "nodeSettings", "=", "ImmutableSettings", ".", "builder", "(", ")", ".", "put", "(", "GroovyScriptEngineService", ".", "GROOVY_SCRIPT_SANDBOX_ENABLED", ",", "true", ")", ".", "build", "(", ");", "internalCluster", "(", ").", "startNodesAsync", "(", "nodes", ",", "nodeSettings", ")", ".", "get", "(", ");", "client", "(", ").", "admin", "(", ").", "cluster", "(", ").", "prepareHealth", "(", ").", "setWaitForNodes", "(", "nodes", "+", "\"", "\")", ".", "get", "(", ");", ".", "put", "(", "\"", "script", ".", "disable_dynamic", "\"", ",", "false", ")</s>this", ".", "sandboxed", "=", "settings", ".", "getAsBoolean", "(", "GROOVY_SCRIPT_SANDBOX_ENABLED", ",", "true", ")", ";", "@", "ElasticsearchIntegrationTest", ".", "ClusterScope", "(", "scope", "=", "ElasticsearchIntegrationTest", ".", "Scope", ".", "TEST", ")", "public", "void", "testSandboxedGroovyScript", "(", ")", "{", "try", "{", "client", "(", ").", "prepareSearch", "(", "\"", "test", "\"", ").", "setQuery", "(", "constantScoreQuery", "(", "scriptFilter", "(", "\"", "pr", "=", "Runtime", ".", "getRuntime", "(", ").", "exec", "(", "\\\"", "touch", "/", "tmp", "/", "gotcha", "\\", "\")", ";", "pr", ".", "waitFor", "(", ")\"", ").", "lang", "(", "\"", "groovy", "\"", "))", ").", "get", "(", ");", "fail", "(", "\"", "should", "have", "thrown", "an", "exception", "\"", ");", "}", "catch", "(", "SearchPhaseExecutionException", "e", ")", "{", "assertThat", "(", "ExceptionsHelper", ".", "detailedMessage", "(", "e", ")", "+", "\"", "should", "not", "contained", "NotSerializableTransportException", "\"", ",", "ExceptionsHelper", ".", "detailedMessage", "(", "e", ")", ".", "contains", "(", "\"", "NotSerializableTransportException", "\"", "),", "equalTo", "(", "false", ")", ");", "assertThat", "(", "ExceptionsHelper", ".", "detailedMessage", "(", "e", ")", "+", "\"", "should", "have", "contained", "GroovyScriptCompilationException", "\"", ",", "ExceptionsHelper", ".", "detailedMessage", "(", "e", ")", ".", "contains", "(", "\"", "GroovyScriptCompilationException", "\"", "),", "equalTo", "(", "true", ")", ");", "assertThat", "(", "ExceptionsHelper", ".", "detailedMessage", "(", "e", ")", "+", "\"", "should", "have", "contained", "Method", "calls", "not", "allowed", "on", "[", "java", ".", "lang", ".", "Runtime", "]", "\",", "ExceptionsHelper", ".", "detailedMessage", "(", "e", ")", ".", "contains", "(", "\"", "Method", "calls", "not", "allowed", "on", "[", "java", ".", "lang", ".", "Runtime", "]", "\")", ",", "equalTo", "(", "true", ")", ");", "}"], "docstring_tokens": ["bypass", "the", "sandbox", "protection", "mechanism", "and", "execute", "arbitrary", "shell", "commands"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "rawPassword", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "rawPassword", "cannot", "be", "null", "\"", ");", "}", "if", "(", "rawPassword", "=", "=", "null", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "rawPassword", "cannot", "be", "null", "\"", ");", "}", "@", "Test", "(", "expected", "=", "IllegalArgumentException", ".", "class", ")", "public", "void", "encodeNullRawPassword", "(", ")", "{", "BCryptPasswordEncoder", "encoder", "=", "new", "BCryptPasswordEncoder", "(", ");", "encoder", ".", "encode", "(", "null", ")", ";", "}", "@", "Test", "(", "expected", "=", "IllegalArgumentException", ".", "class", ")", "public", "void", "matchNullRawPassword", "(", ")", "{", "BCryptPasswordEncoder", "encoder", "=", "new", "BCryptPasswordEncoder", "(", ");", "encoder", ".", "matches", "(", "null", ",", "\"", "does", "-", "not", "-", "matter", "\"", ");", "}</s>"], "docstring_tokens": ["and", "use", "this", "information", "to", "launch", "further", "attacks", "against", "the", "affected", "system"]}
{"contents": ["empty"], "code_tokens": ["memset", "(", "perm_addr", ",", "0", ",", "sizeof", "(", "perm_addr", ")", ");", "memset", "(", "&", "ets", ",", "0", ",", "sizeof", "(", "ets", ")", ");", "memset", "(", "&", "maxrate", ",", "0", ",", "sizeof", "(", "maxrate", ")", ");", "memset", "(", "&", "pfc", ",", "0", ",", "sizeof", "(", "pfc", ")", ");", "memset", "(", "&", "ets", ",", "0", ",", "sizeof", "(", "ets", ")", ");", "memset", "(", "&", "pfc", ",", "0", ",", "sizeof", "(", "pfc", ")", ");", "memset", "(", "&", "pg", ",", "0", ",", "sizeof", "(", "pg", ")", ");", "memset", "(", "&", "pfc", ",", "0", ",", "sizeof", "(", "pfc", ")", ");</s>"], "docstring_tokens": ["obtain", "sensitive", "information", "from", "kernel", "stack", "memory"]}
{"contents": ["empty"], "code_tokens": ["<", "version", ">", "1", ".", "39", "-", "SNAPSHOT", "<", "/", "version", ">", "import", "com", ".", "amazonaws", ".", "SdkClientException", ";", "try", "{", "AWSCredentialsProvider", "credentialsProvider", "=", "createCredentialsProvider", "(", "useInstanceProfileForCredentials", ",", "credentialsId", ")", ";", "AmazonEC2", "client", "=", "connect", "(", "credentialsProvider", ",", "new", "URL", "(", "\"", "http", ":", "//", "ec2", ".", "amazonaws", ".", "com", "\"", "))", ";", "DescribeRegionsResult", "regions", "=", "client", ".", "describeRegions", "(", ");", "List", "<", "Region", ">", "regionList", "=", "regions", ".", "getRegions", "(", ");", "for", "(", "Region", "r", ":", "regionList", ")", "{", "String", "name", "=", "r", ".", "getRegionName", "(", ");", "model", ".", "add", "(", "name", ",", "name", ")", ";", "}", "}", "catch", "(", "SdkClientException", "ex", ")", "{", "/", "/", "Ignore", ",", "as", "this", "may", "happen", "before", "the", "credentials", "are", "specified", "import", "org", ".", "kohsuke", ".", "accmod", ".", "Restricted", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "restrictions", ".", "NoExternalUse", ";", "if", "(", "StringUtils", ".", "isNotBlank", "(", "remoteAdmin", ")", "|", "|", "StringUtils", ".", "isNotBlank", "(", "jvmopts", ")", "|", "|", "StringUtils", ".", "isNotBlank", "(", "tmpDir", ")", "){", "LOGGER", ".", "log", "(", "Level", ".", "FINE", ",", "\"", "As", "remoteAdmin", ",", "jvmopts", "or", "tmpDir", "is", "not", "blank", ",", "we", "must", "ensure", "the", "user", "has", "RUN_SCRIPTS", "rights", ".", "\")", ";", "Jenkins", "j", "=", "Jenkins", ".", "getInstance", "(", ");", "if", "(", "j", "!", "=", "null", ")", "{", "j", ".", "checkPermission", "(", "Jenkins", ".", "RUN_SCRIPTS", ")", ";", "}", "}", "Jenkins", ".", "getInstance", "(", ").", "checkPermission", "(", "Jenkins", ".", "RUN_SCRIPTS", ")", ";", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "public", "FormValidation", "doCheckRemoteAdmin", "(", "@", "QueryParameter", "String", "value", ")", "{", "if", "(", "StringUtils", ".", "isBlank", "(", "value", ")", "|", "|", "Jenkins", ".", "getInstance", "(", ").", "hasPermission", "(", "Jenkins", ".", "RUN_SCRIPTS", ")", "){", "return", "FormValidation", ".", "ok", "(", ");", "}", "else", "{", "return", "FormValidation", ".", "error", "(", "Messages", ".", "General_MissingPermission", "(", "))", ";", "}", "}", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "public", "FormValidation", "doCheckTmpDir", "(", "@", "QueryParameter", "String", "value", ")", "{", "if", "(", "StringUtils", ".", "isBlank", "(", "value", ")", "|", "|", "Jenkins", ".", "getInstance", "(", ").", "hasPermission", "(", "Jenkins", ".", "RUN_SCRIPTS", ")", "){", "return", "FormValidation", ".", "ok", "(", ");", "}", "else", "{", "return", "FormValidation", ".", "error", "(", "Messages", ".", "General_MissingPermission", "(", "))", ";", "}", "}", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "public", "FormValidation", "doCheckJvmopts", "(", "@", "QueryParameter", "String", "value", ")", "{", "if", "(", "StringUtils", ".", "isBlank", "(", "value", ")", "|", "|", "Jenkins", ".", "getInstance", "(", ").", "hasPermission", "(", "Jenkins", ".", "RUN_SCRIPTS", ")", "){", "return", "FormValidation", ".", "ok", "(", ");", "}", "else", "{", "return", "FormValidation", ".", "error", "(", "Messages", ".", "General_MissingPermission", "(", "))", ";", "}", "}", "import", "hudson", ".", "util", ".", "FormValidation", ";", "import", "jenkins", ".", "model", ".", "Jenkins", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "Restricted", ";", "import", "org", ".", "kohsuke", ".", "accmod", ".", "restrictions", ".", "NoExternalUse", ";", "import", "org", ".", "kohsuke", ".", "stapler", ".", "QueryParameter", ";", "this", ".", "readResolve", "(", ");", "}", "protected", "Object", "readResolve", "(", ")", "{", "Jenkins", ".", "getInstance", "(", ").", "checkPermission", "(", "Jenkins", ".", "RUN_SCRIPTS", ")", ";", "return", "this", ";", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "public", "FormValidation", "doCheckRootCommandPrefix", "(", "@", "QueryParameter", "String", "value", ")", "{", "if", "(", "StringUtils", ".", "isBlank", "(", "value", ")", "|", "|", "Jenkins", ".", "getInstance", "(", ").", "hasPermission", "(", "Jenkins", ".", "RUN_SCRIPTS", ")", "){", "return", "FormValidation", ".", "ok", "(", ");", "}", "else", "{", "return", "FormValidation", ".", "error", "(", "Messages", ".", "General_MissingPermission", "(", "))", ";", "}", "}", "@", "Restricted", "(", "NoExternalUse", ".", "class", ")", "public", "FormValidation", "doCheckSlaveCommandPrefix", "(", "@", "QueryParameter", "String", "value", ")", "{", "if", "(", "StringUtils", ".", "isBlank", "(", "value", ")", "|", "|", "Jenkins", ".", "getInstance", "(", ").", "hasPermission", "(", "Jenkins", ".", "RUN_SCRIPTS", ")", "){", "return", "FormValidation", ".", "ok", "(", ");", "}", "else", "{", "return", "FormValidation", ".", "error", "(", "Messages", ".", "General_MissingPermission", "(", "))", ";", "}", "}", "CommandLauncher", "commandLauncher", "=", "new", "CommandLauncher", "(", "sshClientLaunchString", ",", "null", ")", ";", "AmazonEC2Cloud", ".", "NonUniqName", "=", "Cloud", "name", "must", "be", "unique", "across", "EC2", "clouds", "General", ".", "MissingPermission", "=", "You", "do", "not", "have", "the", "Overall", "/", "RunScripts", "right", "to", "modify", "this", "field</s><", "version", ">", "1", ".", "38", "-", "SNAPSHOT", "<", "/", "version", ">", "AWSCredentialsProvider", "credentialsProvider", "=", "createCredentialsProvider", "(", "useInstanceProfileForCredentials", ",", "credentialsId", ")", ";", "AmazonEC2", "client", "=", "connect", "(", "credentialsProvider", ",", "new", "URL", "(", "\"", "http", ":", "//", "ec2", ".", "amazonaws", ".", "com", "\"", "))", ";", "DescribeRegionsResult", "regions", "=", "client", ".", "describeRegions", "(", ");", "List", "<", "Region", ">", "regionList", "=", "regions", ".", "getRegions", "(", ");", "for", "(", "Region", "r", ":", "regionList", ")", "{", "String", "name", "=", "r", ".", "getRegionName", "(", ");", "model", ".", "add", "(", "name", ",", "name", ")", ";", "CommandLauncher", "commandLauncher", "=", "new", "CommandLauncher", "(", "sshClientLaunchString", ")", ";", "AmazonEC2Cloud", ".", "NonUniqName", "=", "Cloud", "name", "must", "be", "unique", "across", "EC2", "clouds"], "docstring_tokens": ["run", "arbitrary", "shell", "commands", "on", "the", "master", "node"]}
{"contents": ["empty"], "code_tokens": ["byte", "[", "]", "m", "=", "c", ".", "doFinal", "(", "encryptedPreMasterSecret", ")", ";", "if", "(", "m", "!", "=", "null", "&", "&", "m", ".", "length", "=", "=", "48", ")", "{", "M", "=", "m", ";", "}</s>M", "=", "c", ".", "doFinal", "(", "encryptedPreMasterSecret", ")", ";"], "docstring_tokens": ["recover", "the", "private", "key", "from", "a", "vulnerable", "application", "."]}
{"contents": ["empty"], "code_tokens": ["if", "(", "sk", "-", ">", "sk_protocol", "=", "=", "IPPROTO_TCP", "&", "&", "sk", "-", ">", "sk_type", "=", "=", "SOCK_STREAM", ")</s>if", "(", "sk", "-", ">", "sk_protocol", "=", "=", "IPPROTO_TCP", ")"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(system", "crash", ")"]}
{"contents": ["empty"], "code_tokens": ["struct", "sockaddr", "*", "addr_p", "=", "(", "struct", "sockaddr", "*", ")", "&", "addr", ";", "socklen_t", "addr_l", "=", "sizeof", "(", "addr", ")", ";", "len", "=", "recvfrom", "(", "fd", ",", "kvp_recv_buffer", ",", "sizeof", "(", "kvp_recv_buffer", ")", ",", "0", ",", "addr_p", ",", "&", "addr_l", ")", ";", "if", "(", "len", "<", "0", "|", "|", "addr", ".", "nl_pid", ")", "{", "syslog", "(", "LOG_ERR", ",", "\"", "recvfrom", "failed", ";", "pid", ":", "%", "u", "error", ":", "%", "d", "%", "s", "\"", ",", "addr", ".", "nl_pid", ",", "errno", ",", "strerror", "(", "errno", ")", ");</s>len", "=", "recv", "(", "fd", ",", "kvp_recv_buffer", ",", "sizeof", "(", "kvp_recv_buffer", ")", ",", "0", ")", ";", "if", "(", "len", "<", "0", ")", "{", "syslog", "(", "LOG_ERR", ",", "\"", "recv", "failed", ";", "error", ":", "%", "d", "\"", ",", "len", ")", ";"], "docstring_tokens": ["spoof", "Netlink", "communication"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "kill", "pending", "URBs", "*", "/", "snd_usb_mixer_disconnect", "(", "mixer", ")", ";", "if", "(", "mixer", "-", ">", "disconnected", ")", "return", ";", "if", "(", "mixer", "-", ">", "urb", ")", "usb_kill_urb", "(", "mixer", "-", ">", "urb", ")", ";", "if", "(", "mixer", "-", ">", "rc_urb", ")", "usb_kill_urb", "(", "mixer", "-", ">", "rc_urb", ")", ";", "mixer", "-", ">", "disconnected", "=", "true", ";", "bool", "disconnected", ";</s>usb_kill_urb", "(", "mixer", "-", ">", "urb", ")", ";", "usb_kill_urb", "(", "mixer", "-", ">", "rc_urb", ")", ";"], "docstring_tokens": ["the", "system", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "*", "Check", "bus_irq", "boundary", ".", "*", "/", "if", "(", "bus_irq", ">", "=", "NR_IRQS_LEGACY", ")", "{", "pr_warn", "(", "\"", "Invalid", "bus_irq", "%", "u", "for", "legacy", "override", "\\", "n", "\"", ",", "bus_irq", ")", ";", "return", ";", "}</s>"], "docstring_tokens": ["overflow", "a", "buffer", "to", "gain", "privileges"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "!", "access_ok", "(", "VERIFY_READ", ",", "uregs", ",", "sizeof", "(", "elf_xtregs_t", ")", "))", "return", "-", "EFAULT", ";</s>"], "docstring_tokens": ["obtain", "sensitive", "information", "from", "kernel", "memory", "locations"]}
{"contents": ["empty"], "code_tokens": ["clear_tsk_need_resched", "(", "tsk", ")", ";", "int", "cpu", "=", "cpu_of", "(", "rq", ")", ";", "u64", "irq_time", ";", "if", "(", "rq", "-", ">", "skip_clock_update", ")", "return", ";", "rq", "-", ">", "clock", "=", "sched_clock_cpu", "(", "cpu", ")", ";", "irq_time", "=", "irq_time_cpu", "(", "cpu", ")", ";", "if", "(", "rq", "-", ">", "clock", "-", "irq_time", ">", "rq", "-", ">", "clock_task", ")", "rq", "-", ">", "clock_task", "=", "rq", "-", ">", "clock", "-", "irq_time", ";", "sched_irq_time_avg_update", "(", "rq", ",", "irq_time", ")", ";", "if", "(", "rq", "-", ">", "curr", "-", ">", "se", ".", "on_rq", "&", "&", "test_tsk_need_resched", "(", "rq", "-", ">", "curr", ")", ")", "clear_tsk_need_resched", "(", "prev", ")", ";", "rq", "-", ">", "skip_clock_update", "=", "0", ";", "+", "+*", "switch_count", ";", "WARN_ON_ONCE", "(", "test_tsk_need_resched", "(", "next", ")", ");</s>if", "(", "!", "rq", "-", ">", "skip_clock_update", ")", "{", "int", "cpu", "=", "cpu_of", "(", "rq", ")", ";", "u64", "irq_time", ";", "rq", "-", ">", "clock", "=", "sched_clock_cpu", "(", "cpu", ")", ";", "irq_time", "=", "irq_time_cpu", "(", "cpu", ")", ";", "if", "(", "rq", "-", ">", "clock", "-", "irq_time", ">", "rq", "-", ">", "clock_task", ")", "rq", "-", ">", "clock_task", "=", "rq", "-", ">", "clock", "-", "irq_time", ";", "sched_irq_time_avg_update", "(", "rq", ",", "irq_time", ")", ";", "}", "if", "(", "test_tsk_need_resched", "(", "rq", "-", ">", "curr", ")", ")", "rq", "-", ">", "skip_clock_update", "=", "0", ";", "clear_tsk_need_resched", "(", "prev", ")", ";"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(system", "hang", ")"]}
{"contents": ["empty"], "code_tokens": ["parseLocation", "=", "false", ";", "parseLocation", "=", "false", ";", "protected", "boolean", "parseLocation", "=", "true", ";", "lastFinalLocation", "=", "parseLocation", "?", "conditionalParse", "(", "location", ",", "invocation", ")", ":", "location", ";", "parseLocation", "=", "false", ";", "String", "finalNamespace", "=", "this", ".", "namespace", "!", "=", "null", "?", "TextParseUtil", ".", "translateVariables", "(", "namespace", ",", "stack", ")", ":", "invocation", ".", "getProxy", "(", ").", "getNamespace", "(", ");", "?", "TextParseUtil", ".", "translateVariables", "(", "this", ".", "methodName", ",", "stack", ")", ":", "null", ";</s>lastFinalLocation", "=", "conditionalParse", "(", "location", ",", "invocation", ")", ";", "/", "/", "if", "the", "finalNamespace", "wasn", "'", "t", "explicitly", "defined", ",", "assume", "the", "current", "one", "if", "(", "this", ".", "namespace", "=", "=", "null", ")", "{", "this", ".", "namespace", "=", "invocation", ".", "getProxy", "(", ").", "getNamespace", "(", ");", "}", "String", "finalNamespace", "=", "TextParseUtil", ".", "translateVariables", "(", "namespace", ",", "stack", ")", ";", "?", "TextParseUtil", ".", "translateVariables", "(", "this", ".", "methodName", ",", "stack", ")", ":", "null", ";"], "docstring_tokens": ["execute", "arbitrary", "code", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "normalized", ".", "equals", "(", "\"/", ".\"", "))", "{", "return", "\"", "/\"", ";", "}", "if", "(", "normalized", ".", "equals", "(", "\"/", "..", "\")", ")", "{", "return", "null", ";", "/", "/", "Trying", "to", "go", "outside", "our", "context", "}", "@", "Test", "public", "void", "testNormalize14", "(", ")", "{", "doTestNormalize", "(", "\"/", "/.", ".\"", ",", "null", ")", ";", "}", "@", "Test", "public", "void", "testNormalize15", "(", ")", "{", "doTestNormalize", "(", "\"/", "/.", "./", "\",", "null", ")", ";", "}", "@", "Test", "public", "void", "testNormalize16", "(", ")", "{", "doTestNormalize", "(", "\"/", "./", "..", "\",", "null", ")", ";", "}", "@", "Test", "public", "void", "testNormalize17", "(", ")", "{", "doTestNormalize", "(", "\"/", "./", "..", "/\"", ",", "null", ")", ";", "}", "@", "Test", "public", "void", "testNormalize18", "(", ")", "{", "doTestNormalize", "(", "\"/", "a", "/", "..", "/.", ".\"", ",", "null", ")", ";", "}", "@", "Test", "public", "void", "testNormalize19", "(", ")", "{", "doTestNormalize", "(", "\"/", "a", "/", "..", "/.", "./", "\",", "null", ")", ";", "}", "<", "subsection", "name", "=", "\"", "Coyote", "\"", ">", "<", "changelog", ">", "<", "fix", ">", "Correct", "some", "edge", "cases", "in", "<", "code", ">", "RequestUtil", ".", "normalize", "(", ")<", "/", "code", ">", ".", "(", "markt", ")", "<", "/", "fix", ">", "<", "/", "changelog", ">", "<", "/", "subsection", ">", "Correct", "a", "couple", "of", "edge", "cases", "in", "<", "code", ">", "RequestUtil", ".", "normalize", "(", ")<", "/", "code", ">", ".</s>if", "(", "normalized", ".", "equals", "(", "\"/", ".\"", "))", "{", "return", "\"", "/\"", ";", "}", "if", "(", "normalized", ".", "equals", "(", "\"/", "..", "\")", ")", "{", "return", "null", ";", "/", "/", "Trying", "to", "go", "outside", "our", "context", "}", "Correct", "a", "coupe", "of", "edge", "cases", "in", "<", "code", ">", "RequestUtil", ".", "normalize", "(", ")<", "/", "code", ">", "."], "docstring_tokens": ["bypass", "intended", "SecurityManager", "restrictions", "and", "list", "a", "parent", "directory"]}
{"contents": ["empty"], "code_tokens": ["BN_set_flags", "(", "rsa", "-", ">", "p", ",", "BN_FLG_CONSTTIME", ")", ";", "BN_set_flags", "(", "rsa", "-", ">", "q", ",", "BN_FLG_CONSTTIME", ")", ";</s>"], "docstring_tokens": ["obtain", "sensitive", "information"]}
{"contents": ["empty"], "code_tokens": ["#", "include", "\"", "volumes", ".", "h", "\"", "__printf", "(", "4", ",", "5", ")", "__cold", "static", "void", "block_group_err", "(", "const", "struct", "btrfs_fs_info", "*", "fs_info", ",", "const", "struct", "extent_buffer", "*", "eb", ",", "int", "slot", ",", "const", "char", "*", "fmt", ",", ".", "..", ")", "{", "struct", "btrfs_key", "key", ";", "struct", "va_format", "vaf", ";", "va_list", "args", ";", "btrfs_item_key_to_cpu", "(", "eb", ",", "&", "key", ",", "slot", ")", ";", "va_start", "(", "args", ",", "fmt", ")", ";", "vaf", ".", "fmt", "=", "fmt", ";", "vaf", ".", "va", "=", "&", "args", ";", "btrfs_crit", "(", "fs_info", ",", "\"", "corrupt", "%", "s", ":", "root", "=", "%", "llu", "block", "=", "%", "llu", "slot", "=", "%", "d", "bg_start", "=", "%", "llu", "bg_len", "=", "%", "llu", ",", "%", "pV", "\"", ",", "btrfs_header_level", "(", "eb", ")", "=", "=", "0", "?", "\"", "leaf", "\"", ":", "\"", "node", "\"", ",", "btrfs_header_owner", "(", "eb", ")", ",", "btrfs_header_bytenr", "(", "eb", ")", ",", "slot", ",", "key", ".", "objectid", ",", "key", ".", "offset", ",", "&", "vaf", ")", ";", "va_end", "(", "args", ")", ";", "}", "static", "int", "check_block_group_item", "(", "struct", "btrfs_fs_info", "*", "fs_info", ",", "struct", "extent_buffer", "*", "leaf", ",", "struct", "btrfs_key", "*", "key", ",", "int", "slot", ")", "{", "struct", "btrfs_block_group_item", "bgi", ";", "u32", "item_size", "=", "btrfs_item_size_nr", "(", "leaf", ",", "slot", ")", ";", "u64", "flags", ";", "u64", "type", ";", "/", "*", "*", "Here", "we", "don", "'", "t", "really", "care", "about", "alignment", "since", "extent", "allocator", "can", "*", "handle", "it", ".", "We", "care", "more", "about", "the", "size", ",", "as", "if", "one", "block", "group", "is", "*", "larger", "than", "maximum", "size", ",", "it", "'", "s", "must", "be", "some", "obvious", "corruption", ".", "*", "/", "if", "(", "key", "-", ">", "offset", ">", "BTRFS_MAX_DATA_CHUNK_SIZE", "|", "|", "key", "-", ">", "offset", "=", "=", "0", ")", "{", "block_group_err", "(", "fs_info", ",", "leaf", ",", "slot", ",", "\"", "invalid", "block", "group", "size", ",", "have", "%", "llu", "expect", "(", "0", ",", "%", "llu", "]", "\",", "key", "-", ">", "offset", ",", "BTRFS_MAX_DATA_CHUNK_SIZE", ")", ";", "return", "-", "EUCLEAN", ";", "}", "if", "(", "item_size", "!", "=", "sizeof", "(", "bgi", ")", ")", "{", "block_group_err", "(", "fs_info", ",", "leaf", ",", "slot", ",", "\"", "invalid", "item", "size", ",", "have", "%", "u", "expect", "%", "zu", "\"", ",", "item_size", ",", "sizeof", "(", "bgi", ")", ");", "return", "-", "EUCLEAN", ";", "}", "read_extent_buffer", "(", "leaf", ",", "&", "bgi", ",", "btrfs_item_ptr_offset", "(", "leaf", ",", "slot", ")", ",", "sizeof", "(", "bgi", ")", ");", "if", "(", "btrfs_block_group_chunk_objectid", "(", "&", "bgi", ")", "!", "=", "BTRFS_FIRST_CHUNK_TREE_OBJECTID", ")", "{", "block_group_err", "(", "fs_info", ",", "leaf", ",", "slot", ",", "\"", "invalid", "block", "group", "chunk", "objectid", ",", "have", "%", "llu", "expect", "%", "llu", "\"", ",", "btrfs_block_group_chunk_objectid", "(", "&", "bgi", ")", ",", "BTRFS_FIRST_CHUNK_TREE_OBJECTID", ")", ";", "return", "-", "EUCLEAN", ";", "}", "if", "(", "btrfs_block_group_used", "(", "&", "bgi", ")", ">", "key", "-", ">", "offset", ")", "{", "block_group_err", "(", "fs_info", ",", "leaf", ",", "slot", ",", "\"", "invalid", "block", "group", "used", ",", "have", "%", "llu", "expect", "[", "0", ",", "%", "llu", ")", "\",", "btrfs_block_group_used", "(", "&", "bgi", ")", ",", "key", "-", ">", "offset", ")", ";", "return", "-", "EUCLEAN", ";", "}", "flags", "=", "btrfs_block_group_flags", "(", "&", "bgi", ")", ";", "if", "(", "hweight64", "(", "flags", "&", "BTRFS_BLOCK_GROUP_PROFILE_MASK", ")", ">", "1", ")", "{", "block_group_err", "(", "fs_info", ",", "leaf", ",", "slot", ",", "\"", "invalid", "profile", "flags", ",", "have", "0x", "%", "llx", "(", "%", "lu", "bits", "set", ")", "expect", "no", "more", "than", "1", "bit", "set", "\"", ",", "flags", "&", "BTRFS_BLOCK_GROUP_PROFILE_MASK", ",", "hweight64", "(", "flags", "&", "BTRFS_BLOCK_GROUP_PROFILE_MASK", ")", ");", "return", "-", "EUCLEAN", ";", "}", "type", "=", "flags", "&", "BTRFS_BLOCK_GROUP_TYPE_MASK", ";", "if", "(", "type", "!", "=", "BTRFS_BLOCK_GROUP_DATA", "&", "&", "type", "!", "=", "BTRFS_BLOCK_GROUP_METADATA", "&", "&", "type", "!", "=", "BTRFS_BLOCK_GROUP_SYSTEM", "&", "&", "type", "!", "=", "(", "BTRFS_BLOCK_GROUP_METADATA", "|", "BTRFS_BLOCK_GROUP_DATA", ")", ")", "{", "block_group_err", "(", "fs_info", ",", "leaf", ",", "slot", ",", "\"", "invalid", "type", ",", "have", "0x", "%", "llx", "(", "%", "lu", "bits", "set", ")", "expect", "either", "0x", "%", "llx", ",", "0x", "%", "llx", ",", "0x", "%", "llu", "or", "0x", "%", "llx", "\"", ",", "type", ",", "hweight64", "(", "type", ")", ",", "BTRFS_BLOCK_GROUP_DATA", ",", "BTRFS_BLOCK_GROUP_METADATA", ",", "BTRFS_BLOCK_GROUP_SYSTEM", ",", "BTRFS_BLOCK_GROUP_METADATA", "|", "BTRFS_BLOCK_GROUP_DATA", ")", ";", "return", "-", "EUCLEAN", ";", "}", "return", "0", ";", "}", "case", "BTRFS_BLOCK_GROUP_ITEM_KEY", ":", "ret", "=", "check_block_group_item", "(", "fs_info", ",", "leaf", ",", "key", ",", "slot", ")", ";", "break", ";", "max_chunk_size", "=", "BTRFS_MAX_DATA_CHUNK_SIZE", ";", "#", "define", "BTRFS_MAX_DATA_CHUNK_SIZE", "(", "10ULL", "*", "SZ_1G", ")</s>max_chunk_size", "=", "10", "*", "max_stripe_size", ";"], "docstring_tokens": ["a", "denial", "of", "service", "condition"]}
{"contents": ["empty"], "code_tokens": ["{", "SVM_EXIT_EXCP_BASE", "+", "AC_VECTOR", ",", "\"", "AC", "excp", "\"", "}", ",", "\\", "set_exception_intercept", "(", "svm", ",", "AC_VECTOR", ")", ";", "static", "int", "ac_interception", "(", "struct", "vcpu_svm", "*", "svm", ")", "{", "kvm_queue_exception_e", "(", "&", "svm", "-", ">", "vcpu", ",", "AC_VECTOR", ",", "0", ")", ";", "return", "1", ";", "}", "[", "SVM_EXIT_EXCP_BASE", "+", "AC_VECTOR", "]", "=", "ac_interception", ",", "(", "1u", "<", "<", "NM_VECTOR", ")", "|", "(", "1u", "<", "<", "DB_VECTOR", ")", "|", "(", "1u", "<", "<", "AC_VECTOR", ")", ";", "case", "AC_VECTOR", ":", "kvm_queue_exception_e", "(", "vcpu", ",", "AC_VECTOR", ",", "error_code", ")", ";", "return", "1", ";</s>(", "1u", "<", "<", "NM_VECTOR", ")", "|", "(", "1u", "<", "<", "DB_VECTOR", ")", ";"], "docstring_tokens": ["operating", "system", "kernels", "do", "not", "permit", "this", ";", "we", "are", "not", "aware", "of", "any", "exceptions", "."]}
{"contents": ["empty"], "code_tokens": ["if", "(", "(", "tagName", "=", "==", "'", "svg", "'", "|", "|", "tagName", "=", "==", "'", "math", "'", ")", "&", "&", "currentNode", ".", "querySelectorAll", "(", "'", "p", ",", "br", ",", "form", ",", "table", "'", ").", "length", "!", "==", "0", ")", "{", "if", "(", "(", "tagName", "=", "==", "'", "svg", "'", "|", "|", "tagName", "=", "==", "'", "math", "'", ")", "&", "&", "currentNode", ".", "querySelectorAll", "(", "'", "p", ",", "br", ",", "form", ",", "table", "'", ").", "length", "!", "==", "0", ")", "{", "if", "(", "(", "tagName", "=", "==", "'", "svg", "'", "|", "|", "tagName", "=", "==", "'", "math", "'", ")", "&", "&", "currentNode", ".", "querySelectorAll", "(", "'", "p", ",", "br", ",", "form", ",", "table", "'", ").", "length", "!", "==", "0", ")", "{", "!", "function", "(", "e", ",", "t", ")", "{\"", "object", "\"", "==", "typeof", "exports", "&", "&\"", "undefined", "\"", "!=", "typeof", "module", "?", "module", ".", "exports", "=", "t", "(", "):", "\"", "function", "\"", "==", "typeof", "define", "&", "&", "define", ".", "amd", "?", "define", "(", "t", ")", ":(", "e", "=", "e", "|", "|", "self", ")", ".", "DOMPurify", "=", "t", "(", ")}", "(", "this", ",", "(", "function", "(", "){", "\"", "use", "strict", "\"", ";", "var", "e", "=", "Object", ".", "hasOwnProperty", ",", "t", "=", "Object", ".", "setPrototypeOf", ",", "n", "=", "Object", ".", "isFrozen", ",", "r", "=", "Object", ".", "keys", ",", "o", "=", "Object", ".", "freeze", ",", "i", "=", "Object", ".", "seal", ",", "a", "=", "Object", ".", "create", ",", "l", "=", "\"", "undefined", "\"", "!=", "typeof", "Reflect", "&", "&", "Reflect", ",", "c", "=", "l", ".", "apply", ",", "s", "=", "l", ".", "construct", ";", "c", "|", "|(", "c", "=", "function", "(", "e", ",", "t", ",", "n", ")", "{", "return", "e", ".", "apply", "(", "t", ",", "n", ")", "})", ",", "o", "|", "|(", "o", "=", "function", "(", "e", ")", "{", "return", "e", "}", "),", "i", "|", "|(", "i", "=", "function", "(", "e", ")", "{", "return", "e", "}", "),", "s", "|", "|(", "s", "=", "function", "(", "e", ",", "t", ")", "{", "return", "new", "(", "Function", ".", "prototype", ".", "bind", ".", "apply", "(", "e", ",", "[", "null", "]", ".", "concat", "(", "function", "(", "e", ")", "{", "if", "(", "Array", ".", "isArray", "(", "e", ")", "){", "for", "(", "var", "t", "=", "0", ",", "n", "=", "Array", "(", "e", ".", "length", ")", ";", "t", "<", "e", ".", "length", ";", "t", "+", "+)", "n", "[", "t", "]", "=", "e", "[", "t", "]", ";", "return", "n", "}", "return", "Array", ".", "from", "(", "e", ")", "}(", "t", ")", "))", ")}", ");", "var", "u", "=", "k", "(", "Array", ".", "prototype", ".", "forEach", ")", ",", "d", "=", "k", "(", "Array", ".", "prototype", ".", "indexOf", ")", ",", "f", "=", "k", "(", "Array", ".", "prototype", ".", "join", ")", ",", "p", "=", "k", "(", "Array", ".", "prototype", ".", "pop", ")", ",", "m", "=", "k", "(", "Array", ".", "prototype", ".", "push", ")", ",", "y", "=", "k", "(", "Array", ".", "prototype", ".", "slice", ")", ",", "g", "=", "k", "(", "String", ".", "prototype", ".", "toLowerCase", ")", ",", "h", "=", "k", "(", "String", ".", "prototype", ".", "match", ")", ",", "v", "=", "k", "(", "String", ".", "prototype", ".", "replace", ")", ",", "b", "=", "k", "(", "String", ".", "prototype", ".", "indexOf", ")", ",", "T", "=", "k", "(", "String", ".", "prototype", ".", "trim", ")", ",", "A", "=", "k", "(", "RegExp", ".", "prototype", ".", "test", ")", ",", "x", "=", "L", "(", "RegExp", ")", ",", "S", "=", "L", "(", "TypeError", ")", ";", "function", "k", "(", "e", ")", "{", "return", "function", "(", "t", ")", "{", "for", "(", "var", "n", "=", "arguments", ".", "length", ",", "r", "=", "Array", "(", "n", ">", "1", "?", "n", "-", "1", ":", "0", ")", ",", "o", "=", "1", ";", "o", "<", "n", ";", "o", "+", "+)", "r", "[", "o", "-", "1", "]", "=", "arguments", "[", "o", "]", ";", "return", "c", "(", "e", ",", "t", ",", "r", ")", "}}", "function", "L", "(", "e", ")", "{", "return", "function", "(", "){", "for", "(", "var", "t", "=", "arguments", ".", "length", ",", "n", "=", "Array", "(", "t", ")", ",", "r", "=", "0", ";", "r", "<", "t", ";", "r", "+", "+)", "n", "[", "r", "]", "=", "arguments", "[", "r", "]", ";", "return", "s", "(", "e", ",", "n", ")", "}}", "function", "_", "(", "e", ",", "r", ")", "{", "t", "&", "&", "t", "(", "e", ",", "null", ")", ";", "for", "(", "var", "o", "=", "r", ".", "length", ";", "o", "-", "-;", "){", "var", "i", "=", "r", "[", "o", "]", ";", "if", "(", "\"", "string", "\"", "==", "typeof", "i", ")", "{", "var", "a", "=", "g", "(", "i", ")", ";", "a", "!", "==", "i", "&", "&(", "n", "(", "r", ")", "||", "(", "r", "[", "o", "]", "=", "a", ")", ",", "i", "=", "a", ")", "}", "e", "[", "i", "]", "=!", "0", "}", "return", "e", "}", "function", "E", "(", "t", ")", "{", "var", "n", "=", "a", "(", "null", ")", ",", "r", "=", "void", "0", ";", "for", "(", "r", "in", "t", ")", "c", "(", "e", ",", "t", ",", "[", "r", "]", ")&", "&(", "n", "[", "r", "]", "=", "t", "[", "r", "]", ");", "return", "n", "}", "var", "M", "=", "o", "(", "[\"", "a", "\"", ",\"", "abbr", "\"", ",\"", "acronym", "\"", ",\"", "address", "\"", ",\"", "area", "\"", ",\"", "article", "\"", ",\"", "aside", "\"", ",\"", "audio", "\"", ",\"", "b", "\"", ",\"", "bdi", "\"", ",\"", "bdo", "\"", ",\"", "big", "\"", ",\"", "blink", "\"", ",\"", "blockquote", "\"", ",\"", "body", "\"", ",\"", "br", "\"", ",\"", "button", "\"", ",\"", "canvas", "\"", ",\"", "caption", "\"", ",\"", "center", "\"", ",\"", "cite", "\"", ",\"", "code", "\"", ",\"", "col", "\"", ",\"", "colgroup", "\"", ",\"", "content", "\"", ",\"", "data", "\"", ",\"", "datalist", "\"", ",\"", "dd", "\"", ",\"", "decorator", "\"", ",\"", "del", "\"", ",\"", "details", "\"", ",\"", "dfn", "\"", ",\"", "dir", "\"", ",\"", "div", "\"", ",\"", "dl", "\"", ",\"", "dt", "\"", ",\"", "element", "\"", ",\"", "em", "\"", ",\"", "fieldset", "\"", ",\"", "figcaption", "\"", ",\"", "figure", "\"", ",\"", "font", "\"", ",\"", "footer", "\"", ",\"", "form", "\"", ",\"", "h1", "\"", ",\"", "h2", "\"", ",\"", "h3", "\"", ",\"", "h4", "\"", ",\"", "h5", "\"", ",\"", "h6", "\"", ",\"", "head", "\"", ",\"", "header", "\"", ",\"", "hgroup", "\"", ",\"", "hr", "\"", ",\"", "html", "\"", ",\"", "i", "\"", ",\"", "img", "\"", ",\"", "input", "\"", ",\"", "ins", "\"", ",\"", "kbd", "\"", ",\"", "label", "\"", ",\"", "legend", "\"", ",\"", "li", "\"", ",\"", "main", "\"", ",\"", "map", "\"", ",\"", "mark", "\"", ",\"", "marquee", "\"", ",\"", "menu", "\"", ",\"", "menuitem", "\"", ",\"", "meter", "\"", ",\"", "nav", "\"", ",\"", "nobr", "\"", ",\"", "ol", "\"", ",\"", "optgroup", "\"", ",\"", "option", "\"", ",\"", "output", "\"", ",\"", "p", "\"", ",\"", "picture", "\"", ",\"", "pre", "\"", ",\"", "progress", "\"", ",\"", "q", "\"", ",\"", "rp", "\"", ",\"", "rt", "\"", ",\"", "ruby", "\"", ",\"", "s", "\"", ",\"", "samp", "\"", ",\"", "section", "\"", ",\"", "select", "\"", ",\"", "shadow", "\"", ",\"", "small", "\"", ",\"", "source", "\"", ",\"", "spacer", "\"", ",\"", "span", "\"", ",\"", "strike", "\"", ",\"", "strong", "\"", ",\"", "style", "\"", ",\"", "sub", "\"", ",\"", "summary", "\"", ",\"", "sup", "\"", ",\"", "table", "\"", ",\"", "tbody", "\"", ",\"", "td", "\"", ",\"", "template", "\"", ",\"", "textarea", "\"", ",\"", "tfoot", "\"", ",\"", "th", "\"", ",\"", "thead", "\"", ",\"", "time", "\"", ",\"", "tr", "\"", ",\"", "track", "\"", ",\"", "tt", "\"", ",\"", "u", "\"", ",\"", "ul", "\"", ",\"", "var", "\"", ",\"", "video", "\"", ",\"", "wbr", "\"", "])", ",", "D", "=", "o", "(", "[\"", "svg", "\"", ",\"", "a", "\"", ",\"", "altglyph", "\"", ",\"", "altglyphdef", "\"", ",\"", "altglyphitem", "\"", ",\"", "animatecolor", "\"", ",\"", "animatemotion", "\"", ",\"", "animatetransform", "\"", ",\"", "audio", "\"", ",\"", "canvas", "\"", ",\"", "circle", "\"", ",\"", "clippath", "\"", ",\"", "defs", "\"", ",\"", "desc", "\"", ",\"", "ellipse", "\"", ",\"", "filter", "\"", ",\"", "font", "\"", ",\"", "g", "\"", ",\"", "glyph", "\"", ",\"", "glyphref", "\"", ",\"", "hkern", "\"", ",\"", "image", "\"", ",\"", "line", "\"", ",\"", "lineargradient", "\"", ",\"", "marker", "\"", ",\"", "mask", "\"", ",\"", "metadata", "\"", ",\"", "mpath", "\"", ",\"", "path", "\"", ",\"", "pattern", "\"", ",\"", "polygon", "\"", ",\"", "polyline", "\"", ",\"", "radialgradient", "\"", ",\"", "rect", "\"", ",\"", "stop", "\"", ",\"", "style", "\"", ",\"", "switch", "\"", ",\"", "symbol", "\"", ",\"", "text", "\"", ",\"", "textpath", "\"", ",\"", "title", "\"", ",\"", "tref", "\"", ",\"", "tspan", "\"", ",\"", "video", "\"", ",\"", "view", "\"", ",\"", "vkern", "\"", "])", ",", "N", "=", "o", "(", "[\"", "feBlend", "\"", ",\"", "feColorMatrix", "\"", ",\"", "feComponentTransfer", "\"", ",\"", "feComposite", "\"", ",\"", "feConvolveMatrix", "\"", ",\"", "feDiffuseLighting", "\"", ",\"", "feDisplacementMap", "\"", ",\"", "feDistantLight", "\"", ",\"", "feFlood", "\"", ",\"", "feFuncA", "\"", ",\"", "feFuncB", "\"", ",\"", "feFuncG", "\"", ",\"", "feFuncR", "\"", ",\"", "feGaussianBlur", "\"", ",\"", "feMerge", "\"", ",\"", "feMergeNode", "\"", ",\"", "feMorphology", "\"", ",\"", "feOffset", "\"", ",\"", "fePointLight", "\"", ",\"", "feSpecularLighting", "\"", ",\"", "feSpotLight", "\"", ",\"", "feTile", "\"", ",\"", "feTurbulence", "\"", "])", ",", "O", "=", "o", "(", "[\"", "math", "\"", ",\"", "menclose", "\"", ",\"", "merror", "\"", ",\"", "mfenced", "\"", ",\"", "mfrac", "\"", ",\"", "mglyph", "\"", ",\"", "mi", "\"", ",\"", "mlabeledtr", "\"", ",\"", "mmultiscripts", "\"", ",\"", "mn", "\"", ",\"", "mo", "\"", ",\"", "mover", "\"", ",\"", "mpadded", "\"", ",\"", "mphantom", "\"", ",\"", "mroot", "\"", ",\"", "mrow", "\"", ",\"", "ms", "\"", ",\"", "mspace", "\"", ",\"", "msqrt", "\"", ",\"", "mstyle", "\"", ",\"", "msub", "\"", ",\"", "msup", "\"", ",\"", "msubsup", "\"", ",\"", "mtable", "\"", ",\"", "mtd", "\"", ",\"", "mtext", "\"", ",\"", "mtr", "\"", ",\"", "munder", "\"", ",\"", "munderover", "\"", "])", ",", "R", "=", "o", "(", "[\"", "#", "text", "\"", "])", ",", "w", "=", "o", "(", "[\"", "accept", "\"", ",\"", "action", "\"", ",\"", "align", "\"", ",\"", "alt", "\"", ",\"", "autocapitalize", "\"", ",\"", "autocomplete", "\"", ",\"", "autopictureinpicture", "\"", ",\"", "autoplay", "\"", ",\"", "background", "\"", ",\"", "bgcolor", "\"", ",\"", "border", "\"", ",\"", "capture", "\"", ",\"", "cellpadding", "\"", ",\"", "cellspacing", "\"", ",\"", "checked", "\"", ",\"", "cite", "\"", ",\"", "class", "\"", ",\"", "clear", "\"", ",\"", "color", "\"", ",\"", "cols", "\"", ",\"", "colspan", "\"", ",\"", "controls", "\"", ",\"", "controlslist", "\"", ",\"", "coords", "\"", ",\"", "crossorigin", "\"", ",\"", "datetime", "\"", ",\"", "decoding", "\"", ",\"", "default", "\"", ",\"", "dir", "\"", ",\"", "disabled", "\"", ",\"", "disablepictureinpicture", "\"", ",\"", "disableremoteplayback", "\"", ",\"", "download", "\"", ",\"", "draggable", "\"", ",\"", "enctype", "\"", ",\"", "enterkeyhint", "\"", ",\"", "face", "\"", ",\"", "for", "\"", ",\"", "headers", "\"", ",\"", "height", "\"", ",\"", "hidden", "\"", ",\"", "high", "\"", ",\"", "href", "\"", ",\"", "hreflang", "\"", ",\"", "id", "\"", ",\"", "inputmode", "\"", ",\"", "integrity", "\"", ",\"", "ismap", "\"", ",\"", "kind", "\"", ",\"", "label", "\"", ",\"", "lang", "\"", ",\"", "list", "\"", ",\"", "loading", "\"", ",\"", "loop", "\"", ",\"", "low", "\"", ",\"", "max", "\"", ",\"", "maxlength", "\"", ",\"", "media", "\"", ",\"", "method", "\"", ",\"", "min", "\"", ",\"", "minlength", "\"", ",\"", "multiple", "\"", ",\"", "muted", "\"", ",\"", "name", "\"", ",\"", "noshade", "\"", ",\"", "novalidate", "\"", ",\"", "nowrap", "\"", ",\"", "open", "\"", ",\"", "optimum", "\"", ",\"", "pattern", "\"", ",\"", "placeholder", "\"", ",\"", "playsinline", "\"", ",\"", "poster", "\"", ",\"", "preload", "\"", ",\"", "pubdate", "\"", ",\"", "radiogroup", "\"", ",\"", "readonly", "\"", ",\"", "rel", "\"", ",\"", "required", "\"", ",\"", "rev", "\"", ",\"", "reversed", "\"", ",\"", "role", "\"", ",\"", "rows", "\"", ",\"", "rowspan", "\"", ",\"", "spellcheck", "\"", ",\"", "scope", "\"", ",\"", "selected", "\"", ",\"", "shape", "\"", ",\"", "size", "\"", ",\"", "sizes", "\"", ",\"", "span", "\"", ",\"", "srclang", "\"", ",\"", "start", "\"", ",\"", "src", "\"", ",\"", "srcset", "\"", ",\"", "step", "\"", ",\"", "style", "\"", ",\"", "summary", "\"", ",\"", "tabindex", "\"", ",\"", "title", "\"", ",\"", "translate", "\"", ",\"", "type", "\"", ",\"", "usemap", "\"", ",\"", "valign", "\"", ",\"", "value", "\"", ",\"", "width", "\"", ",\"", "xmlns", "\"", "])", ",", "F", "=", "o", "(", "[\"", "accent", "-", "height", "\"", ",\"", "accumulate", "\"", ",\"", "additive", "\"", ",\"", "alignment", "-", "baseline", "\"", ",\"", "ascent", "\"", ",\"", "attributename", "\"", ",\"", "attributetype", "\"", ",\"", "azimuth", "\"", ",\"", "basefrequency", "\"", ",\"", "baseline", "-", "shift", "\"", ",\"", "begin", "\"", ",\"", "bias", "\"", ",\"", "by", "\"", ",\"", "class", "\"", ",\"", "clip", "\"", ",\"", "clippathunits", "\"", ",\"", "clip", "-", "path", "\"", ",\"", "clip", "-", "rule", "\"", ",\"", "color", "\"", ",\"", "color", "-", "interpolation", "\"", ",\"", "color", "-", "interpolation", "-", "filters", "\"", ",\"", "color", "-", "profile", "\"", ",\"", "color", "-", "rendering", "\"", ",\"", "cx", "\"", ",\"", "cy", "\"", ",\"", "d", "\"", ",\"", "dx", "\"", ",\"", "dy", "\"", ",\"", "diffuseconstant", "\"", ",\"", "direction", "\"", ",\"", "display", "\"", ",\"", "divisor", "\"", ",\"", "dur", "\"", ",\"", "edgemode", "\"", ",\"", "elevation", "\"", ",\"", "end", "\"", ",\"", "fill", "\"", ",\"", "fill", "-", "opacity", "\"", ",\"", "fill", "-", "rule", "\"", ",\"", "filter", "\"", ",\"", "filterunits", "\"", ",\"", "flood", "-", "color", "\"", ",\"", "flood", "-", "opacity", "\"", ",\"", "font", "-", "family", "\"", ",\"", "font", "-", "size", "\"", ",\"", "font", "-", "size", "-", "adjust", "\"", ",\"", "font", "-", "stretch", "\"", ",\"", "font", "-", "style", "\"", ",\"", "font", "-", "variant", "\"", ",\"", "font", "-", "weight", "\"", ",\"", "fx", "\"", ",\"", "fy", "\"", ",\"", "g1", "\"", ",\"", "g2", "\"", ",\"", "glyph", "-", "name", "\"", ",\"", "glyphref", "\"", ",\"", "gradientunits", "\"", ",\"", "gradienttransform", "\"", ",\"", "height", "\"", ",\"", "href", "\"", ",\"", "id", "\"", ",\"", "image", "-", "rendering", "\"", ",\"", "in", "\"", ",\"", "in2", "\"", ",\"", "k", "\"", ",\"", "k1", "\"", ",\"", "k2", "\"", ",\"", "k3", "\"", ",\"", "k4", "\"", ",\"", "kerning", "\"", ",\"", "keypoints", "\"", ",\"", "keysplines", "\"", ",\"", "keytimes", "\"", ",\"", "lang", "\"", ",\"", "lengthadjust", "\"", ",\"", "letter", "-", "spacing", "\"", ",\"", "kernelmatrix", "\"", ",\"", "kernelunitlength", "\"", ",\"", "lighting", "-", "color", "\"", ",\"", "local", "\"", ",\"", "marker", "-", "end", "\"", ",\"", "marker", "-", "mid", "\"", ",\"", "marker", "-", "start", "\"", ",\"", "markerheight", "\"", ",\"", "markerunits", "\"", ",\"", "markerwidth", "\"", ",\"", "maskcontentunits", "\"", ",\"", "maskunits", "\"", ",\"", "max", "\"", ",\"", "mask", "\"", ",\"", "media", "\"", ",\"", "method", "\"", ",\"", "mode", "\"", ",\"", "min", "\"", ",\"", "name", "\"", ",\"", "numoctaves", "\"", ",\"", "offset", "\"", ",\"", "operator", "\"", ",\"", "opacity", "\"", ",\"", "order", "\"", ",\"", "orient", "\"", ",\"", "orientation", "\"", ",\"", "origin", "\"", ",\"", "overflow", "\"", ",\"", "paint", "-", "order", "\"", ",\"", "path", "\"", ",\"", "pathlength", "\"", ",\"", "patterncontentunits", "\"", ",\"", "patterntransform", "\"", ",\"", "patternunits", "\"", ",\"", "points", "\"", ",\"", "preservealpha", "\"", ",\"", "preserveaspectratio", "\"", ",\"", "primitiveunits", "\"", ",\"", "r", "\"", ",\"", "rx", "\"", ",\"", "ry", "\"", ",\"", "radius", "\"", ",\"", "refx", "\"", ",\"", "refy", "\"", ",\"", "repeatcount", "\"", ",\"", "repeatdur", "\"", ",\"", "restart", "\"", ",\"", "result", "\"", ",\"", "rotate", "\"", ",\"", "scale", "\"", ",\"", "seed", "\"", ",\"", "shape", "-", "rendering", "\"", ",\"", "specularconstant", "\"", ",\"", "specularexponent", "\"", ",\"", "spreadmethod", "\"", ",\"", "startoffset", "\"", ",\"", "stddeviation", "\"", ",\"", "stitchtiles", "\"", ",\"", "stop", "-", "color", "\"", ",\"", "stop", "-", "opacity", "\"", ",\"", "stroke", "-", "dasharray", "\"", ",\"", "stroke", "-", "dashoffset", "\"", ",\"", "stroke", "-", "linecap", "\"", ",\"", "stroke", "-", "linejoin", "\"", ",\"", "stroke", "-", "miterlimit", "\"", ",\"", "stroke", "-", "opacity", "\"", ",\"", "stroke", "\"", ",\"", "stroke", "-", "width", "\"", ",\"", "style", "\"", ",\"", "surfacescale", "\"", ",\"", "systemlanguage", "\"", ",\"", "tabindex", "\"", ",\"", "targetx", "\"", ",\"", "targety", "\"", ",\"", "transform", "\"", ",\"", "text", "-", "anchor", "\"", ",\"", "text", "-", "decoration", "\"", ",\"", "text", "-", "rendering", "\"", ",\"", "textlength", "\"", ",\"", "type", "\"", ",\"", "u1", "\"", ",\"", "u2", "\"", ",\"", "unicode", "\"", ",\"", "values", "\"", ",\"", "viewbox", "\"", ",\"", "visibility", "\"", ",\"", "version", "\"", ",\"", "vert", "-", "adv", "-", "y", "\"", ",\"", "vert", "-", "origin", "-", "x", "\"", ",\"", "vert", "-", "origin", "-", "y", "\"", ",\"", "width", "\"", ",\"", "word", "-", "spacing", "\"", ",\"", "wrap", "\"", ",\"", "writing", "-", "mode", "\"", ",\"", "xchannelselector", "\"", ",\"", "ychannelselector", "\"", ",\"", "x", "\"", ",\"", "x1", "\"", ",\"", "x2", "\"", ",\"", "xmlns", "\"", ",\"", "y", "\"", ",\"", "y1", "\"", ",\"", "y2", "\"", ",\"", "z", "\"", ",\"", "zoomandpan", "\"", "])", ",", "H", "=", "o", "(", "[\"", "accent", "\"", ",\"", "accentunder", "\"", ",\"", "align", "\"", ",\"", "bevelled", "\"", ",\"", "close", "\"", ",\"", "columnsalign", "\"", ",\"", "columnlines", "\"", ",\"", "columnspan", "\"", ",\"", "denomalign", "\"", ",\"", "depth", "\"", ",\"", "dir", "\"", ",\"", "display", "\"", ",\"", "displaystyle", "\"", ",\"", "encoding", "\"", ",\"", "fence", "\"", ",\"", "frame", "\"", ",\"", "height", "\"", ",\"", "href", "\"", ",\"", "id", "\"", ",\"", "largeop", "\"", ",\"", "length", "\"", ",\"", "linethickness", "\"", ",\"", "lspace", "\"", ",\"", "lquote", "\"", ",\"", "mathbackground", "\"", ",\"", "mathcolor", "\"", ",\"", "mathsize", "\"", ",\"", "mathvariant", "\"", ",\"", "maxsize", "\"", ",\"", "minsize", "\"", ",\"", "movablelimits", "\"", ",\"", "notation", "\"", ",\"", "numalign", "\"", ",\"", "open", "\"", ",\"", "rowalign", "\"", ",\"", "rowlines", "\"", ",\"", "rowspacing", "\"", ",\"", "rowspan", "\"", ",\"", "rspace", "\"", ",\"", "rquote", "\"", ",\"", "scriptlevel", "\"", ",\"", "scriptminsize", "\"", ",\"", "scriptsizemultiplier", "\"", ",\"", "selection", "\"", ",\"", "separator", "\"", ",\"", "separators", "\"", ",\"", "stretchy", "\"", ",\"", "subscriptshift", "\"", ",\"", "supscriptshift", "\"", ",\"", "symmetric", "\"", ",\"", "voffset", "\"", ",\"", "width", "\"", ",\"", "xmlns", "\"", "])", ",", "C", "=", "o", "(", "[\"", "xlink", ":", "href", "\"", ",\"", "xml", ":", "id", "\"", ",\"", "xlink", ":", "title", "\"", ",\"", "xml", ":", "space", "\"", ",\"", "xmlns", ":", "xlink", "\"", "])", ",", "z", "=", "i", "(", "/\\", "{\\", "{[", "\\", "s", "\\", "S", "]", "*|", "[\\", "s", "\\", "S", "]", "*\\", "}\\", "}/", "gm", ")", ",", "I", "=", "i", "(", "/<", "%[", "\\", "s", "\\", "S", "]", "*|", "[\\", "s", "\\", "S", "]", "*%", ">/", "gm", ")", ",", "U", "=", "i", "(", "/^", "data", "-", "[\\", "-\\", "w", ".", "\\", "u00B7", "-", "\\", "uFFFF", "]", "/)", ",", "j", "=", "i", "(", "/^", "aria", "-", "[\\", "-\\", "w", "]", "+$", "/)", ",", "P", "=", "i", "(", "/^", "(?", ":(", "?:", "(?", ":", "f", "|", "ht", ")", "tps", "?", "|", "mailto", "|", "tel", "|", "callto", "|", "cid", "|", "xmpp", ")", ":|", "[^", "a", "-", "z", "]", "|[", "a", "-", "z", "+", ".\\", "-]", "+(", "?:", "[^", "a", "-", "z", "+", ".\\", "-:", "]|", "$)", ")/", "i", ")", ",", "G", "=", "i", "(", "/^", "(?", ":\\", "w", "+", "script", "|", "data", ")", ":/", "i", ")", ",", "W", "=", "i", "(", "/[", "\\", "u0000", "-", "\\", "u0020", "\\", "u00A0", "\\", "u1680", "\\", "u180E", "\\", "u2000", "-", "\\", "u2029", "\\", "u205F", "\\", "u3000", "]", "/", "g", ")", ",", "B", "=", "\"", "function", "\"", "==", "typeof", "Symbol", "&", "&\"", "symbol", "\"", "==", "typeof", "Symbol", ".", "iterator", "?", "function", "(", "e", ")", "{", "return", "typeof", "e", "}", ":", "function", "(", "e", ")", "{", "return", "e", "&", "&\"", "function", "\"", "==", "typeof", "Symbol", "&", "&", "e", ".", "constructor", "=", "==", "Symbol", "&", "&", "e", "!", "==", "Symbol", ".", "prototype", "?", "\"", "symbol", "\"", ":", "typeof", "e", "}", ";", "function", "q", "(", "e", ")", "{", "if", "(", "Array", ".", "isArray", "(", "e", ")", "){", "for", "(", "var", "t", "=", "0", ",", "n", "=", "Array", "(", "e", ".", "length", ")", ";", "t", "<", "e", ".", "length", ";", "t", "+", "+)", "n", "[", "t", "]", "=", "e", "[", "t", "]", ";", "return", "n", "}", "return", "Array", ".", "from", "(", "e", ")", "}", "var", "K", "=", "function", "(", "){", "return", "\"", "undefined", "\"", "==", "typeof", "window", "?", "null", ":", "window", "}", ",", "V", "=", "function", "(", "e", ",", "t", ")", "{", "if", "(", "\"", "object", "\"", "!=", "=(", "void", "0", "=", "==", "e", "?", "\"", "undefined", "\"", ":", "B", "(", "e", ")", ")|", "|\"", "function", "\"", "!=", "typeof", "e", ".", "createPolicy", ")", "return", "null", ";", "var", "n", "=", "null", ";", "t", ".", "currentScript", "&", "&", "t", ".", "currentScript", ".", "hasAttribute", "(", "\"", "data", "-", "tt", "-", "policy", "-", "suffix", "\"", ")&", "&(", "n", "=", "t", ".", "currentScript", ".", "getAttribute", "(", "\"", "data", "-", "tt", "-", "policy", "-", "suffix", "\"", "))", ";", "var", "r", "=", "\"", "dompurify", "\"", "+(", "n", "?", "\"#", "\"+", "n", ":", "\"\"", ");", "try", "{", "return", "e", ".", "createPolicy", "(", "r", ",", "{", "createHTML", ":", "function", "(", "e", ")", "{", "return", "e", "}", "})", "}", "catch", "(", "e", ")", "{", "return", "console", ".", "warn", "(", "\"", "TrustedTypes", "policy", "\"", "+", "r", "+", "\"", "could", "not", "be", "created", ".", "\")", ",", "null", "}", "};", "return", "function", "e", "(", "){", "var", "t", "=", "arguments", ".", "length", ">", "0", "&", "&", "void", "0", "!", "==", "arguments", "[", "0", "]", "?", "arguments", "[", "0", "]", ":", "K", "(", "),", "n", "=", "function", "(", "t", ")", "{", "return", "e", "(", "t", ")", "};", "if", "(", "n", ".", "version", "=", "\"", "2", ".", "0", ".", "16", "\"", ",", "n", ".", "removed", "=", "[]", ",!", "t", "|", "|!", "t", ".", "document", "|", "|", "9", "!", "==", "t", ".", "document", ".", "nodeType", ")", "return", "n", ".", "isSupported", "=", "!", "1", ",", "n", ";", "var", "i", "=", "t", ".", "document", ",", "a", "=", "!", "1", ",", "l", "=", "t", ".", "document", ",", "c", "=", "t", ".", "DocumentFragment", ",", "s", "=", "t", ".", "HTMLTemplateElement", ",", "k", "=", "t", ".", "Node", ",", "L", "=", "t", ".", "NodeFilter", ",", "Y", "=", "t", ".", "NamedNodeMap", ",", "X", "=", "void", "0", "=", "==", "Y", "?", "t", ".", "NamedNodeMap", "|", "|", "t", ".", "MozNamedAttrMap", ":", "Y", ",", "$=", "t", ".", "Text", ",", "J", "=", "t", ".", "Comment", ",", "Q", "=", "t", ".", "DOMParser", ",", "Z", "=", "t", ".", "trustedTypes", ";", "if", "(", "\"", "function", "\"", "==", "typeof", "s", ")", "{", "var", "ee", "=", "l", ".", "createElement", "(", "\"", "template", "\"", ");", "ee", ".", "content", "&", "&", "ee", ".", "content", ".", "ownerDocument", "&", "&(", "l", "=", "ee", ".", "content", ".", "ownerDocument", ")", "}", "var", "te", "=", "V", "(", "Z", ",", "i", ")", ",", "ne", "=", "te", "&", "&", "He", "?", "te", ".", "createHTML", "(", "\"\"", "):", "\"\"", ",", "re", "=", "l", ",", "oe", "=", "re", ".", "implementation", ",", "ie", "=", "re", ".", "createNodeIterator", ",", "ae", "=", "re", ".", "getElementsByTagName", ",", "le", "=", "re", ".", "createDocumentFragment", ",", "ce", "=", "i", ".", "importNode", ",", "se", "=", "{}", ";", "try", "{", "se", "=", "E", "(", "l", ")", ".", "documentMode", "?", "l", ".", "documentMode", ":", "{}", "}", "catch", "(", "e", ")", "{}", "var", "ue", "=", "{}", ";", "n", ".", "isSupported", "=", "oe", "&", "&", "void", "0", "!", "==", "oe", ".", "createHTMLDocument", "&", "&", "9", "!", "==", "se", ";", "var", "de", "=", "z", ",", "fe", "=", "I", ",", "pe", "=", "U", ",", "me", "=", "j", ",", "ye", "=", "G", ",", "ge", "=", "W", ",", "he", "=", "P", ",", "ve", "=", "null", ",", "be", "=", "_", "(", "{}", ",[", "].", "concat", "(", "q", "(", "M", ")", ",", "q", "(", "D", ")", ",", "q", "(", "N", ")", ",", "q", "(", "O", ")", ",", "q", "(", "R", ")", "))", ",", "Te", "=", "null", ",", "Ae", "=", "_", "(", "{}", ",[", "].", "concat", "(", "q", "(", "w", ")", ",", "q", "(", "F", ")", ",", "q", "(", "H", ")", ",", "q", "(", "C", ")", "))", ",", "xe", "=", "null", ",", "Se", "=", "null", ",", "ke", "=", "!", "0", ",", "Le", "=", "!", "0", ",", "_e", "=", "!", "1", ",", "Ee", "=", "!", "1", ",", "Me", "=", "!", "1", ",", "De", "=", "!", "1", ",", "Ne", "=", "!", "1", ",", "Oe", "=", "!", "1", ",", "Re", "=", "!", "1", ",", "we", "=", "!", "1", ",", "Fe", "=", "!", "1", ",", "He", "=", "!", "1", ",", "Ce", "=", "!", "0", ",", "ze", "=", "!", "0", ",", "Ie", "=", "!", "1", ",", "Ue", "=", "{}", ",", "je", "=", "_", "(", "{}", ",[", "\"", "annotation", "-", "xml", "\"", ",\"", "audio", "\"", ",\"", "colgroup", "\"", ",\"", "desc", "\"", ",\"", "foreignobject", "\"", ",\"", "head", "\"", ",\"", "iframe", "\"", ",\"", "math", "\"", ",\"", "mi", "\"", ",\"", "mn", "\"", ",\"", "mo", "\"", ",\"", "ms", "\"", ",\"", "mtext", "\"", ",\"", "noembed", "\"", ",\"", "noframes", "\"", ",\"", "plaintext", "\"", ",\"", "script", "\"", ",\"", "style", "\"", ",\"", "svg", "\"", ",\"", "template", "\"", ",\"", "thead", "\"", ",\"", "title", "\"", ",\"", "video", "\"", ",\"", "xmp", "\"", "])", ",", "Pe", "=", "null", ",", "Ge", "=", "_", "(", "{}", ",[", "\"", "audio", "\"", ",\"", "video", "\"", ",\"", "img", "\"", ",\"", "source", "\"", ",\"", "image", "\"", ",\"", "track", "\"", "])", ",", "We", "=", "null", ",", "Be", "=", "_", "(", "{}", ",[", "\"", "alt", "\"", ",\"", "class", "\"", ",\"", "for", "\"", ",\"", "id", "\"", ",\"", "label", "\"", ",\"", "name", "\"", ",\"", "pattern", "\"", ",\"", "placeholder", "\"", ",\"", "summary", "\"", ",\"", "title", "\"", ",\"", "value", "\"", ",\"", "style", "\"", ",\"", "xmlns", "\"", "])", ",", "qe", "=", "null", ",", "Ke", "=", "l", ".", "createElement", "(", "\"", "form", "\"", "),", "Ve", "=", "function", "(", "e", ")", "{", "qe", "&", "&", "qe", "=", "==", "e", "|", "|(", "e", "&", "&\"", "object", "\"", "==", "=(", "void", "0", "=", "==", "e", "?", "\"", "undefined", "\"", ":", "B", "(", "e", ")", ")|", "|(", "e", "=", "{}", "),", "e", "=", "E", "(", "e", ")", ",", "ve", "=", "\"", "ALLOWED_TAGS", "\"", "in", "e", "?", "_", "(", "{}", ",", "e", ".", "ALLOWED_TAGS", ")", ":", "be", ",", "Te", "=", "\"", "ALLOWED_ATTR", "\"", "in", "e", "?", "_", "(", "{}", ",", "e", ".", "ALLOWED_ATTR", ")", ":", "Ae", ",", "We", "=", "\"", "ADD_URI_SAFE_ATTR", "\"", "in", "e", "?", "_", "(", "E", "(", "Be", ")", ",", "e", ".", "ADD_URI_SAFE_ATTR", ")", ":", "Be", ",", "Pe", "=", "\"", "ADD_DATA_URI_TAGS", "\"", "in", "e", "?", "_", "(", "E", "(", "Ge", ")", ",", "e", ".", "ADD_DATA_URI_TAGS", ")", ":", "Ge", ",", "xe", "=", "\"", "FORBID_TAGS", "\"", "in", "e", "?", "_", "(", "{}", ",", "e", ".", "FORBID_TAGS", ")", ":{", "},", "Se", "=", "\"", "FORBID_ATTR", "\"", "in", "e", "?", "_", "(", "{}", ",", "e", ".", "FORBID_ATTR", ")", ":{", "},", "Ue", "=", "\"", "USE_PROFILES", "\"", "in", "e", "&", "&", "e", ".", "USE_PROFILES", ",", "ke", "=", "!", "1", "!", "==", "e", ".", "ALLOW_ARIA_ATTR", ",", "Le", "=", "!", "1", "!", "==", "e", ".", "ALLOW_DATA_ATTR", ",", "_e", "=", "e", ".", "ALLOW_UNKNOWN_PROTOCOLS", "|", "|!", "1", ",", "Ee", "=", "e", ".", "SAFE_FOR_JQUERY", "|", "|!", "1", ",", "Me", "=", "e", ".", "SAFE_FOR_TEMPLATES", "|", "|!", "1", ",", "De", "=", "e", ".", "WHOLE_DOCUMENT", "|", "|!", "1", ",", "Re", "=", "e", ".", "RETURN_DOM", "|", "|!", "1", ",", "we", "=", "e", ".", "RETURN_DOM_FRAGMENT", "|", "|!", "1", ",", "Fe", "=", "e", ".", "RETURN_DOM_IMPORT", "|", "|!", "1", ",", "He", "=", "e", ".", "RETURN_TRUSTED_TYPE", "|", "|!", "1", ",", "Oe", "=", "e", ".", "FORCE_BODY", "|", "|!", "1", ",", "Ce", "=", "!", "1", "!", "==", "e", ".", "SANITIZE_DOM", ",", "ze", "=", "!", "1", "!", "==", "e", ".", "KEEP_CONTENT", ",", "Ie", "=", "e", ".", "IN_PLACE", "|", "|!", "1", ",", "he", "=", "e", ".", "ALLOWED_URI_REGEXP", "|", "|", "he", ",", "Me", "&", "&(", "Le", "=", "!", "1", ")", ",", "we", "&", "&(", "Re", "=", "!", "0", ")", ",", "Ue", "&", "&(", "ve", "=", "_", "(", "{}", ",[", "].", "concat", "(", "q", "(", "R", ")", "))", ",", "Te", "=", "[]", ",!", "0", "=", "==", "Ue", ".", "html", "&", "&(", "_", "(", "ve", ",", "M", ")", ",", "_", "(", "Te", ",", "w", ")", "),", "!", "0", "=", "==", "Ue", ".", "svg", "&", "&(", "_", "(", "ve", ",", "D", ")", ",", "_", "(", "Te", ",", "F", ")", ",", "_", "(", "Te", ",", "C", ")", "),", "!", "0", "=", "==", "Ue", ".", "svgFilters", "&", "&(", "_", "(", "ve", ",", "N", ")", ",", "_", "(", "Te", ",", "F", ")", ",", "_", "(", "Te", ",", "C", ")", "),", "!", "0", "=", "==", "Ue", ".", "mathMl", "&", "&(", "_", "(", "ve", ",", "O", ")", ",", "_", "(", "Te", ",", "H", ")", ",", "_", "(", "Te", ",", "C", ")", "))", ",", "e", ".", "ADD_TAGS", "&", "&(", "ve", "=", "==", "be", "&", "&(", "ve", "=", "E", "(", "ve", ")", "),", "_", "(", "ve", ",", "e", ".", "ADD_TAGS", ")", "),", "e", ".", "ADD_ATTR", "&", "&(", "Te", "=", "==", "Ae", "&", "&(", "Te", "=", "E", "(", "Te", ")", "),", "_", "(", "Te", ",", "e", ".", "ADD_ATTR", ")", "),", "e", ".", "ADD_URI_SAFE_ATTR", "&", "&", "_", "(", "We", ",", "e", ".", "ADD_URI_SAFE_ATTR", ")", ",", "ze", "&", "&(", "ve", "[", "\"#", "text", "\"", "]=", "!", "0", ")", ",", "De", "&", "&", "_", "(", "ve", ",", "[\"", "html", "\"", ",\"", "head", "\"", ",\"", "body", "\"", "])", ",", "ve", ".", "table", "&", "&(", "_", "(", "ve", ",", "[\"", "tbody", "\"", "])", ",", "delete", "xe", ".", "tbody", ")", ",", "o", "&", "&", "o", "(", "e", ")", ",", "qe", "=", "e", ")", "},", "Ye", "=", "function", "(", "e", ")", "{", "m", "(", "n", ".", "removed", ",", "{", "element", ":", "e", "}", ");", "try", "{", "e", ".", "parentNode", ".", "removeChild", "(", "e", ")", "}", "catch", "(", "t", ")", "{", "e", ".", "outerHTML", "=", "ne", "}", "},", "Xe", "=", "function", "(", "e", ",", "t", ")", "{", "try", "{", "m", "(", "n", ".", "removed", ",", "{", "attribute", ":", "t", ".", "getAttributeNode", "(", "e", ")", ",", "from", ":", "t", "}", ")}", "catch", "(", "e", ")", "{", "m", "(", "n", ".", "removed", ",", "{", "attribute", ":", "null", ",", "from", ":", "t", "}", ")}", "t", ".", "removeAttribute", "(", "e", ")", "},", "$", "e", "=", "function", "(", "e", ")", "{", "var", "t", "=", "void", "0", ",", "n", "=", "void", "0", ";", "if", "(", "Oe", ")", "e", "=", "\"<", "remove", ">", "</", "remove", ">", "\"+", "e", ";", "else", "{", "var", "r", "=", "h", "(", "e", ",", "/^", "[\\", "r", "\\", "n", "\\", "t", "]", "+/", ");", "n", "=", "r", "&", "&", "r", "[", "0", "]", "}", "var", "o", "=", "te", "?", "te", ".", "createHTML", "(", "e", ")", ":", "e", ";", "try", "{", "t", "=", "(", "new", "Q", ")", ".", "parseFromString", "(", "o", ",", "\"", "text", "/", "html", "\"", ")}", "catch", "(", "e", ")", "{}", "if", "(", "a", "&", "&", "_", "(", "xe", ",", "[\"", "title", "\"", "])", ",!", "t", "|", "|!", "t", ".", "documentElement", ")", "{", "var", "i", "=", "(", "t", "=", "oe", ".", "createHTMLDocument", "(", "\"\"", "))", ".", "body", ";", "i", ".", "parentNode", ".", "removeChild", "(", "i", ".", "parentNode", ".", "firstElementChild", ")", ",", "i", ".", "outerHTML", "=", "o", "}", "return", "e", "&", "&", "n", "&", "&", "t", ".", "body", ".", "insertBefore", "(", "l", ".", "createTextNode", "(", "n", ")", ",", "t", ".", "body", ".", "childNodes", "[", "0", "]", "||", "null", ")", ",", "ae", ".", "call", "(", "t", ",", "De", "?", "\"", "html", "\"", ":\"", "body", "\"", ")[", "0", "]", "};", "n", ".", "isSupported", "&", "&", "function", "(", "){", "try", "{", "var", "e", "=", "$", "e", "(", "\"<", "x", "/", "><", "title", ">", "&", "lt", ";", "/", "title", "&", "gt", ";", "&", "lt", ";", "img", "&", "gt", ";", "\")", ";", "A", "(", "/<", "\\/", "title", "/", ",", "e", ".", "querySelector", "(", "\"", "title", "\"", ").", "innerHTML", ")", "&&", "(", "a", "=", "!", "0", ")", "}", "catch", "(", "e", ")", "{}", "}(", ");", "var", "Je", "=", "function", "(", "e", ")", "{", "return", "ie", ".", "call", "(", "e", ".", "ownerDocument", "|", "|", "e", ",", "e", ",", "L", ".", "SHOW_ELEMENT", "|", "L", ".", "SHOW_COMMENT", "|", "L", ".", "SHOW_TEXT", ",", "(", "function", "(", "){", "return", "L", ".", "FILTER_ACCEPT", "}", "),", "!", "1", ")", "},", "Qe", "=", "function", "(", "e", ")", "{", "return", "!", "(", "e", "instanceof", "$", "||", "e", "instanceof", "J", ")", "&&", "!(", "\"", "string", "\"", "==", "typeof", "e", ".", "nodeName", "&", "&\"", "string", "\"", "==", "typeof", "e", ".", "textContent", "&", "&\"", "function", "\"", "==", "typeof", "e", ".", "removeChild", "&", "&", "e", ".", "attributes", "instanceof", "X", "&", "&\"", "function", "\"", "==", "typeof", "e", ".", "removeAttribute", "&", "&\"", "function", "\"", "==", "typeof", "e", ".", "setAttribute", "&", "&\"", "string", "\"", "==", "typeof", "e", ".", "namespaceURI", ")", "},", "Ze", "=", "function", "(", "e", ")", "{", "return", "\"", "object", "\"", "==", "=(", "void", "0", "=", "==", "k", "?", "\"", "undefined", "\"", ":", "B", "(", "k", ")", ")?", "e", "instanceof", "k", ":", "e", "&", "&\"", "object", "\"", "==", "=(", "void", "0", "=", "==", "e", "?", "\"", "undefined", "\"", ":", "B", "(", "e", ")", ")&", "&\"", "number", "\"", "==", "typeof", "e", ".", "nodeType", "&", "&\"", "string", "\"", "==", "typeof", "e", ".", "nodeName", "}", ",", "et", "=", "function", "(", "e", ",", "t", ",", "r", ")", "{", "ue", "[", "e", "]", "&&", "u", "(", "ue", "[", "e", "]", ",(", "function", "(", "e", ")", "{", "e", ".", "call", "(", "n", ",", "t", ",", "r", ",", "qe", ")", "})", ")}", ",", "tt", "=", "function", "(", "e", ")", "{", "var", "t", "=", "void", "0", ";", "if", "(", "et", "(", "\"", "beforeSanitizeElements", "\"", ",", "e", ",", "null", ")", ",", "Qe", "(", "e", ")", ")", "return", "Ye", "(", "e", ")", ",!", "0", ";", "if", "(", "h", "(", "e", ".", "nodeName", ",", "/[", "\\", "u0080", "-", "\\", "uFFFF", "]", "/)", ")", "return", "Ye", "(", "e", ")", ",!", "0", ";", "var", "r", "=", "g", "(", "e", ".", "nodeName", ")", ";", "if", "(", "et", "(", "\"", "uponSanitizeElement", "\"", ",", "e", ",", "{", "tagName", ":", "r", ",", "allowedTags", ":", "ve", "}", "),", "(\"", "svg", "\"", "==", "=", "r", "|", "|\"", "math", "\"", "==", "=", "r", ")", "&&", "0", "!", "==", "e", ".", "querySelectorAll", "(", "\"", "p", ",", "br", ",", "form", ",", "table", "\"", ").", "length", ")", "return", "Ye", "(", "e", ")", ",!", "0", ";", "if", "(", "!", "ve", "[", "r", "]", "||", "xe", "[", "r", "]", "){", "if", "(", "ze", "&", "&!", "je", "[", "r", "]", "&&", "\"", "function", "\"", "==", "typeof", "e", ".", "insertAdjacentHTML", ")", "try", "{", "var", "o", "=", "e", ".", "innerHTML", ";", "e", ".", "insertAdjacentHTML", "(", "\"", "AfterEnd", "\"", ",", "te", "?", "te", ".", "createHTML", "(", "o", ")", ":", "o", ")", "}", "catch", "(", "e", ")", "{}", "return", "Ye", "(", "e", ")", ",!", "0", "}", "return", "\"", "noscript", "\"", "==", "=", "r", "&", "&", "A", "(", "/<", "\\/", "noscript", "/", "i", ",", "e", ".", "innerHTML", ")", "||", "\"", "noembed", "\"", "==", "=", "r", "&", "&", "A", "(", "/<", "\\/", "noembed", "/", "i", ",", "e", ".", "innerHTML", ")", "?(", "Ye", "(", "e", ")", ",!", "0", ")", ":(", "!", "Ee", "|", "|", "Ze", "(", "e", ".", "firstElementChild", ")", "||", "Ze", "(", "e", ".", "content", ")", "&&", "Ze", "(", "e", ".", "content", ".", "firstElementChild", ")", "||", "!", "A", "(", "/<", "/", "g", ",", "e", ".", "textContent", ")", "||", "(", "m", "(", "n", ".", "removed", ",", "{", "element", ":", "e", ".", "cloneNode", "(", ")}", "),", "e", ".", "innerHTML", "?", "e", ".", "innerHTML", "=", "v", "(", "e", ".", "innerHTML", ",", "/<", "/", "g", ",", "\"&", "lt", ";", "\")", ":", "e", ".", "innerHTML", "=", "v", "(", "e", ".", "textContent", ",", "/<", "/", "g", ",", "\"&", "lt", ";", "\")", "),", "Me", "&", "&", "3", "=", "==", "e", ".", "nodeType", "&", "&(", "t", "=", "e", ".", "textContent", ",", "t", "=", "v", "(", "t", ",", "de", ",", "\"", "\"", "),", "t", "=", "v", "(", "t", ",", "fe", ",", "\"", "\"", "),", "e", ".", "textContent", "!", "==", "t", "&", "&(", "m", "(", "n", ".", "removed", ",", "{", "element", ":", "e", ".", "cloneNode", "(", ")}", "),", "e", ".", "textContent", "=", "t", ")", "),", "et", "(", "\"", "afterSanitizeElements", "\"", ",", "e", ",", "null", ")", ",!", "1", ")", "},", "nt", "=", "function", "(", "e", ",", "t", ",", "n", ")", "{", "if", "(", "Ce", "&", "&(", "\"", "id", "\"", "==", "=", "t", "|", "|\"", "name", "\"", "==", "=", "t", ")", "&&", "(", "n", "in", "l", "|", "|", "n", "in", "Ke", ")", ")", "return", "!", "1", ";", "if", "(", "Le", "&", "&", "A", "(", "pe", ",", "t", ")", ");", "else", "if", "(", "ke", "&", "&", "A", "(", "me", ",", "t", ")", ");", "else", "{", "if", "(", "!", "Te", "[", "t", "]", "||", "Se", "[", "t", "]", ")", "return", "!", "1", ";", "if", "(", "We", "[", "t", "]", ");", "else", "if", "(", "A", "(", "he", ",", "v", "(", "n", ",", "ge", ",", "\"\"", "))", ");", "else", "if", "(", "\"", "src", "\"", "!=", "=", "t", "&", "&\"", "xlink", ":", "href", "\"", "!=", "=", "t", "&", "&\"", "href", "\"", "!=", "=", "t", "|", "|\"", "script", "\"", "==", "=", "e", "|", "|", "0", "!", "==", "b", "(", "n", ",", "\"", "data", ":", "\")", "||", "!", "Pe", "[", "e", "]", "){", "if", "(", "_e", "&", "&!", "A", "(", "ye", ",", "v", "(", "n", ",", "ge", ",", "\"\"", "))", ");", "else", "if", "(", "n", ")", "return", "!", "1", "}", "else", ";", "}", "return", "!", "0", "}", ",", "rt", "=", "function", "(", "e", ")", "{", "var", "t", "=", "void", "0", ",", "o", "=", "void", "0", ",", "i", "=", "void", "0", ",", "a", "=", "void", "0", ",", "l", "=", "void", "0", ";", "et", "(", "\"", "beforeSanitizeAttributes", "\"", ",", "e", ",", "null", ")", ";", "var", "c", "=", "e", ".", "attributes", ";", "if", "(", "c", ")", "{", "var", "s", "=", "{", "attrName", ":", "\"\"", ",", "attrValue", ":", "\"\"", ",", "keepAttr", ":", "!", "0", ",", "allowedAttributes", ":", "Te", "}", ";", "for", "(", "l", "=", "c", ".", "length", ";", "l", "-", "-;", "){", "var", "u", "=", "t", "=", "c", "[", "l", "]", ",", "m", "=", "u", ".", "name", ",", "h", "=", "u", ".", "namespaceURI", ";", "if", "(", "o", "=", "T", "(", "t", ".", "value", ")", ",", "i", "=", "g", "(", "m", ")", ",", "s", ".", "attrName", "=", "i", ",", "s", ".", "attrValue", "=", "o", ",", "s", ".", "keepAttr", "=", "!", "0", ",", "s", ".", "forceKeepAttr", "=", "void", "0", ",", "et", "(", "\"", "uponSanitizeAttribute", "\"", ",", "e", ",", "s", ")", ",", "o", "=", "s", ".", "attrValue", ",", "!", "s", ".", "forceKeepAttr", ")", "{", "if", "(", "\"", "name", "\"", "==", "=", "i", "&", "&\"", "IMG", "\"", "==", "=", "e", ".", "nodeName", "&", "&", "c", ".", "id", ")", "a", "=", "c", ".", "id", ",", "c", "=", "y", "(", "c", ",", "[]", "),", "Xe", "(", "\"", "id", "\"", ",", "e", ")", ",", "Xe", "(", "m", ",", "e", ")", ",", "d", "(", "c", ",", "a", ")", ">", "l", "&", "&", "e", ".", "setAttribute", "(", "\"", "id", "\"", ",", "a", ".", "value", ")", ";", "else", "{", "if", "(", "\"", "INPUT", "\"", "==", "=", "e", ".", "nodeName", "&", "&\"", "type", "\"", "==", "=", "i", "&", "&\"", "file", "\"", "==", "=", "o", "&", "&", "s", ".", "keepAttr", "&", "&(", "Te", "[", "i", "]", "||", "!", "Se", "[", "i", "]", "))", "continue", ";", "\"", "id", "\"", "==", "=", "m", "&", "&", "e", ".", "setAttribute", "(", "m", ",", "\"\"", "),", "Xe", "(", "m", ",", "e", ")", "}", "if", "(", "s", ".", "keepAttr", ")", "if", "(", "Ee", "&", "&", "A", "(", "/\\", "/>", "/", "i", ",", "o", ")", ")", "Xe", "(", "m", ",", "e", ")", ";", "else", "if", "(", "A", "(", "/", "svg", "|", "math", "/", "i", ",", "e", ".", "namespaceURI", ")", "&&", "A", "(", "x", "(", "\"<", "/(", "\"+", "f", "(", "r", "(", "je", ")", ",\"", "|\"", ")+", "\")", "\",", "\"", "i", "\"", "),", "o", ")", ")", "Xe", "(", "m", ",", "e", ")", ";", "else", "{", "Me", "&", "&(", "o", "=", "v", "(", "o", ",", "de", ",", "\"", "\"", "),", "o", "=", "v", "(", "o", ",", "fe", ",", "\"", "\"", "))", ";", "var", "b", "=", "e", ".", "nodeName", ".", "toLowerCase", "(", ");", "if", "(", "nt", "(", "b", ",", "i", ",", "o", ")", ")", "try", "{", "h", "?", "e", ".", "setAttributeNS", "(", "h", ",", "m", ",", "o", ")", ":", "e", ".", "setAttribute", "(", "m", ",", "o", ")", ",", "p", "(", "n", ".", "removed", ")", "}", "catch", "(", "e", ")", "{}", "}}", "}", "et", "(", "\"", "afterSanitizeAttributes", "\"", ",", "e", ",", "null", ")", "}}", ",", "ot", "=", "function", "e", "(", "t", ")", "{", "var", "n", "=", "void", "0", ",", "r", "=", "Je", "(", "t", ")", ";", "for", "(", "et", "(", "\"", "beforeSanitizeShadowDOM", "\"", ",", "t", ",", "null", ")", ";", "n", "=", "r", ".", "nextNode", "(", ");", ")", "et", "(", "\"", "uponSanitizeShadowNode", "\"", ",", "n", ",", "null", ")", ",", "tt", "(", "n", ")", "||", "(", "n", ".", "content", "instanceof", "c", "&", "&", "e", "(", "n", ".", "content", ")", ",", "rt", "(", "n", ")", ");", "et", "(", "\"", "afterSanitizeShadowDOM", "\"", ",", "t", ",", "null", ")", "};", "return", "n", ".", "sanitize", "=", "function", "(", "e", ",", "r", ")", "{", "var", "o", "=", "void", "0", ",", "a", "=", "void", "0", ",", "l", "=", "void", "0", ",", "s", "=", "void", "0", ",", "u", "=", "void", "0", ";", "if", "(", "e", "|", "|(", "e", "=", "\"\\", "x3c", "!", "--", "\\", "x3e", "\"", "),", "\"", "string", "\"", "!=", "typeof", "e", "&", "&!", "Ze", "(", "e", ")", "){", "if", "(", "\"", "function", "\"", "!=", "typeof", "e", ".", "toString", ")", "throw", "S", "(", "\"", "toString", "is", "not", "a", "function", "\"", ");", "if", "(", "\"", "string", "\"", "!=", "typeof", "(", "e", "=", "e", ".", "toString", "(", "))", ")", "throw", "S", "(", "\"", "dirty", "is", "not", "a", "string", ",", "aborting", "\"", ")}", "if", "(", "!", "n", ".", "isSupported", ")", "{", "if", "(", "\"", "object", "\"", "==", "=", "B", "(", "t", ".", "toStaticHTML", ")", "||", "\"", "function", "\"", "==", "typeof", "t", ".", "toStaticHTML", ")", "{", "if", "(", "\"", "string", "\"", "==", "typeof", "e", ")", "return", "t", ".", "toStaticHTML", "(", "e", ")", ";", "if", "(", "Ze", "(", "e", ")", ")", "return", "t", ".", "toStaticHTML", "(", "e", ".", "outerHTML", ")", "}", "return", "e", "}", "if", "(", "Ne", "|", "|", "Ve", "(", "r", ")", ",", "n", ".", "removed", "=", "[]", ",\"", "string", "\"", "==", "typeof", "e", "&", "&(", "Ie", "=", "!", "1", ")", ",", "Ie", ")", ";", "else", "if", "(", "e", "instanceof", "k", ")", "1", "=", "==", "(", "a", "=", "(", "o", "=", "$", "e", "(", "\"\\", "x3c", "!", "--", "\\", "x3e", "\"", "))", ".", "ownerDocument", ".", "importNode", "(", "e", ",", "!", "0", ")", ").", "nodeType", "&", "&\"", "BODY", "\"", "==", "=", "a", ".", "nodeName", "|", "|\"", "HTML", "\"", "==", "=", "a", ".", "nodeName", "?", "o", "=", "a", ":", "o", ".", "appendChild", "(", "a", ")", ";", "else", "{", "if", "(", "!", "Re", "&", "&!", "Me", "&", "&!", "De", "&", "&-", "1", "=", "==", "e", ".", "indexOf", "(", "\"<", "\")", ")", "return", "te", "&", "&", "He", "?", "te", ".", "createHTML", "(", "e", ")", ":", "e", ";", "if", "(", "!(", "o", "=", "$", "e", "(", "e", ")", "))", "return", "Re", "?", "null", ":", "ne", "}", "o", "&", "&", "Oe", "&", "&", "Ye", "(", "o", ".", "firstChild", ")", ";", "for", "(", "var", "d", "=", "Je", "(", "Ie", "?", "e", ":", "o", ")", ";", "l", "=", "d", ".", "nextNode", "(", ");", ")", "3", "=", "==", "l", ".", "nodeType", "&", "&", "l", "=", "==", "s", "|", "|", "tt", "(", "l", ")", "||", "(", "l", ".", "content", "instanceof", "c", "&", "&", "ot", "(", "l", ".", "content", ")", ",", "rt", "(", "l", ")", ",", "s", "=", "l", ")", ";", "if", "(", "s", "=", "null", ",", "Ie", ")", "return", "e", ";", "if", "(", "Re", ")", "{", "if", "(", "we", ")", "for", "(", "u", "=", "le", ".", "call", "(", "o", ".", "ownerDocument", ")", ";", "o", ".", "firstChild", ";", ")", "u", ".", "appendChild", "(", "o", ".", "firstChild", ")", ";", "else", "u", "=", "o", ";", "return", "Fe", "&", "&(", "u", "=", "ce", ".", "call", "(", "i", ",", "u", ",", "!", "0", ")", "),", "u", "}", "var", "f", "=", "De", "?", "o", ".", "outerHTML", ":", "o", ".", "innerHTML", ";", "return", "Me", "&", "&(", "f", "=", "v", "(", "f", ",", "de", ",", "\"", "\"", "),", "f", "=", "v", "(", "f", ",", "fe", ",", "\"", "\"", "))", ",", "te", "&", "&", "He", "?", "te", ".", "createHTML", "(", "f", ")", ":", "f", "}", ",", "n", ".", "setConfig", "=", "function", "(", "e", ")", "{", "Ve", "(", "e", ")", ",", "Ne", "=", "!", "0", "}", ",", "n", ".", "clearConfig", "=", "function", "(", "){", "qe", "=", "null", ",", "Ne", "=", "!", "1", "}", ",", "n", ".", "isValidAttribute", "=", "function", "(", "e", ",", "t", ",", "n", ")", "{", "qe", "|", "|", "Ve", "(", "{}", ");", "var", "r", "=", "g", "(", "e", ")", ",", "o", "=", "g", "(", "t", ")", ";", "return", "nt", "(", "r", ",", "o", ",", "n", ")", "},", "n", ".", "addHook", "=", "function", "(", "e", ",", "t", ")", "{\"", "function", "\"", "==", "typeof", "t", "&", "&(", "ue", "[", "e", "]", "=", "ue", "[", "e", "]", "||", "[]", ",", "m", "(", "ue", "[", "e", "]", ",", "t", ")", ")}", ",", "n", ".", "removeHook", "=", "function", "(", "e", ")", "{", "ue", "[", "e", "]", "&&", "p", "(", "ue", "[", "e", "]", ")}", ",", "n", ".", "removeHooks", "=", "function", "(", "e", ")", "{", "ue", "[", "e", "]", "&&", "(", "ue", "[", "e", "]", "=[", "])", "},", "n", ".", "removeAllHooks", "=", "function", "(", "){", "ue", "=", "{}", "},", "n", "}", "()", "})", ");", "currentNode", ".", "querySelectorAll", "(", "'", "p", ",", "br", ",", "form", ",", "table", "'", ").", "length", "!", "==", "0", "\"", "title", "\"", ":", "\"", "Tests", "against", "nesting", "-", "based", "mXSS", "behavior", "1", "/", "2", "\"", ",", "}", ",", "{", "\"", "title", "\"", ":", "\"", "Tests", "against", "nesting", "-", "based", "mXSS", "behavior", "2", "/", "2", "\"", ",", "\"", "payload", "\"", ":", "\"", "<", "math", ">", "<", "mtext", ">", "<", "table", ">", "<", "mglyph", ">", "<", "style", ">", "<", "math", ">", "CLICKME", "<", "/", "math", ">", "\",", "\"", "expected", "\"", ":", "[", "\"", "\"", "]</s>if", "(", "(", "tagName", "=", "==", "'", "svg", "'", "|", "|", "tagName", "=", "==", "'", "math", "'", ")", "&", "&", "currentNode", ".", "querySelectorAll", "(", "'", "p", ",", "br", ",", "form", "'", ").", "length", "!", "==", "0", ")", "{", "if", "(", "(", "tagName", "=", "==", "'", "svg", "'", "|", "|", "tagName", "=", "==", "'", "math", "'", ")", "&", "&", "currentNode", ".", "querySelectorAll", "(", "'", "p", ",", "br", ",", "form", "'", ").", "length", "!", "==", "0", ")", "{", "if", "(", "(", "tagName", "=", "==", "'", "svg", "'", "|", "|", "tagName", "=", "==", "'", "math", "'", ")", "&", "&", "currentNode", ".", "querySelectorAll", "(", "'", "p", ",", "br", ",", "form", "'", ").", "length", "!", "==", "0", ")", "{", "!", "function", "(", "e", ",", "t", ")", "{\"", "object", "\"", "==", "typeof", "exports", "&", "&\"", "undefined", "\"", "!=", "typeof", "module", "?", "module", ".", "exports", "=", "t", "(", "):", "\"", "function", "\"", "==", "typeof", "define", "&", "&", "define", ".", "amd", "?", "define", "(", "t", ")", ":(", "e", "=", "e", "|", "|", "self", ")", ".", "DOMPurify", "=", "t", "(", ")}", "(", "this", ",", "(", "function", "(", "){", "\"", "use", "strict", "\"", ";", "var", "e", "=", "Object", ".", "hasOwnProperty", ",", "t", "=", "Object", ".", "setPrototypeOf", ",", "n", "=", "Object", ".", "isFrozen", ",", "r", "=", "Object", ".", "keys", ",", "o", "=", "Object", ".", "freeze", ",", "i", "=", "Object", ".", "seal", ",", "a", "=", "Object", ".", "create", ",", "l", "=", "\"", "undefined", "\"", "!=", "typeof", "Reflect", "&", "&", "Reflect", ",", "c", "=", "l", ".", "apply", ",", "s", "=", "l", ".", "construct", ";", "c", "|", "|(", "c", "=", "function", "(", "e", ",", "t", ",", "n", ")", "{", "return", "e", ".", "apply", "(", "t", ",", "n", ")", "})", ",", "o", "|", "|(", "o", "=", "function", "(", "e", ")", "{", "return", "e", "}", "),", "i", "|", "|(", "i", "=", "function", "(", "e", ")", "{", "return", "e", "}", "),", "s", "|", "|(", "s", "=", "function", "(", "e", ",", "t", ")", "{", "return", "new", "(", "Function", ".", "prototype", ".", "bind", ".", "apply", "(", "e", ",", "[", "null", "]", ".", "concat", "(", "function", "(", "e", ")", "{", "if", "(", "Array", ".", "isArray", "(", "e", ")", "){", "for", "(", "var", "t", "=", "0", ",", "n", "=", "Array", "(", "e", ".", "length", ")", ";", "t", "<", "e", ".", "length", ";", "t", "+", "+)", "n", "[", "t", "]", "=", "e", "[", "t", "]", ";", "return", "n", "}", "return", "Array", ".", "from", "(", "e", ")", "}(", "t", ")", "))", ")}", ");", "var", "u", "=", "k", "(", "Array", ".", "prototype", ".", "forEach", ")", ",", "d", "=", "k", "(", "Array", ".", "prototype", ".", "indexOf", ")", ",", "f", "=", "k", "(", "Array", ".", "prototype", ".", "join", ")", ",", "p", "=", "k", "(", "Array", ".", "prototype", ".", "pop", ")", ",", "m", "=", "k", "(", "Array", ".", "prototype", ".", "push", ")", ",", "y", "=", "k", "(", "Array", ".", "prototype", ".", "slice", ")", ",", "g", "=", "k", "(", "String", ".", "prototype", ".", "toLowerCase", ")", ",", "h", "=", "k", "(", "String", ".", "prototype", ".", "match", ")", ",", "v", "=", "k", "(", "String", ".", "prototype", ".", "replace", ")", ",", "b", "=", "k", "(", "String", ".", "prototype", ".", "indexOf", ")", ",", "T", "=", "k", "(", "String", ".", "prototype", ".", "trim", ")", ",", "A", "=", "k", "(", "RegExp", ".", "prototype", ".", "test", ")", ",", "x", "=", "L", "(", "RegExp", ")", ",", "S", "=", "L", "(", "TypeError", ")", ";", "function", "k", "(", "e", ")", "{", "return", "function", "(", "t", ")", "{", "for", "(", "var", "n", "=", "arguments", ".", "length", ",", "r", "=", "Array", "(", "n", ">", "1", "?", "n", "-", "1", ":", "0", ")", ",", "o", "=", "1", ";", "o", "<", "n", ";", "o", "+", "+)", "r", "[", "o", "-", "1", "]", "=", "arguments", "[", "o", "]", ";", "return", "c", "(", "e", ",", "t", ",", "r", ")", "}}", "function", "L", "(", "e", ")", "{", "return", "function", "(", "){", "for", "(", "var", "t", "=", "arguments", ".", "length", ",", "n", "=", "Array", "(", "t", ")", ",", "r", "=", "0", ";", "r", "<", "t", ";", "r", "+", "+)", "n", "[", "r", "]", "=", "arguments", "[", "r", "]", ";", "return", "s", "(", "e", ",", "n", ")", "}}", "function", "_", "(", "e", ",", "r", ")", "{", "t", "&", "&", "t", "(", "e", ",", "null", ")", ";", "for", "(", "var", "o", "=", "r", ".", "length", ";", "o", "-", "-;", "){", "var", "i", "=", "r", "[", "o", "]", ";", "if", "(", "\"", "string", "\"", "==", "typeof", "i", ")", "{", "var", "a", "=", "g", "(", "i", ")", ";", "a", "!", "==", "i", "&", "&(", "n", "(", "r", ")", "||", "(", "r", "[", "o", "]", "=", "a", ")", ",", "i", "=", "a", ")", "}", "e", "[", "i", "]", "=!", "0", "}", "return", "e", "}", "function", "E", "(", "t", ")", "{", "var", "n", "=", "a", "(", "null", ")", ",", "r", "=", "void", "0", ";", "for", "(", "r", "in", "t", ")", "c", "(", "e", ",", "t", ",", "[", "r", "]", ")&", "&(", "n", "[", "r", "]", "=", "t", "[", "r", "]", ");", "return", "n", "}", "var", "M", "=", "o", "(", "[\"", "a", "\"", ",\"", "abbr", "\"", ",\"", "acronym", "\"", ",\"", "address", "\"", ",\"", "area", "\"", ",\"", "article", "\"", ",\"", "aside", "\"", ",\"", "audio", "\"", ",\"", "b", "\"", ",\"", "bdi", "\"", ",\"", "bdo", "\"", ",\"", "big", "\"", ",\"", "blink", "\"", ",\"", "blockquote", "\"", ",\"", "body", "\"", ",\"", "br", "\"", ",\"", "button", "\"", ",\"", "canvas", "\"", ",\"", "caption", "\"", ",\"", "center", "\"", ",\"", "cite", "\"", ",\"", "code", "\"", ",\"", "col", "\"", ",\"", "colgroup", "\"", ",\"", "content", "\"", ",\"", "data", "\"", ",\"", "datalist", "\"", ",\"", "dd", "\"", ",\"", "decorator", "\"", ",\"", "del", "\"", ",\"", "details", "\"", ",\"", "dfn", "\"", ",\"", "dir", "\"", ",\"", "div", "\"", ",\"", "dl", "\"", ",\"", "dt", "\"", ",\"", "element", "\"", ",\"", "em", "\"", ",\"", "fieldset", "\"", ",\"", "figcaption", "\"", ",\"", "figure", "\"", ",\"", "font", "\"", ",\"", "footer", "\"", ",\"", "form", "\"", ",\"", "h1", "\"", ",\"", "h2", "\"", ",\"", "h3", "\"", ",\"", "h4", "\"", ",\"", "h5", "\"", ",\"", "h6", "\"", ",\"", "head", "\"", ",\"", "header", "\"", ",\"", "hgroup", "\"", ",\"", "hr", "\"", ",\"", "html", "\"", ",\"", "i", "\"", ",\"", "img", "\"", ",\"", "input", "\"", ",\"", "ins", "\"", ",\"", "kbd", "\"", ",\"", "label", "\"", ",\"", "legend", "\"", ",\"", "li", "\"", ",\"", "main", "\"", ",\"", "map", "\"", ",\"", "mark", "\"", ",\"", "marquee", "\"", ",\"", "menu", "\"", ",\"", "menuitem", "\"", ",\"", "meter", "\"", ",\"", "nav", "\"", ",\"", "nobr", "\"", ",\"", "ol", "\"", ",\"", "optgroup", "\"", ",\"", "option", "\"", ",\"", "output", "\"", ",\"", "p", "\"", ",\"", "picture", "\"", ",\"", "pre", "\"", ",\"", "progress", "\"", ",\"", "q", "\"", ",\"", "rp", "\"", ",\"", "rt", "\"", ",\"", "ruby", "\"", ",\"", "s", "\"", ",\"", "samp", "\"", ",\"", "section", "\"", ",\"", "select", "\"", ",\"", "shadow", "\"", ",\"", "small", "\"", ",\"", "source", "\"", ",\"", "spacer", "\"", ",\"", "span", "\"", ",\"", "strike", "\"", ",\"", "strong", "\"", ",\"", "style", "\"", ",\"", "sub", "\"", ",\"", "summary", "\"", ",\"", "sup", "\"", ",\"", "table", "\"", ",\"", "tbody", "\"", ",\"", "td", "\"", ",\"", "template", "\"", ",\"", "textarea", "\"", ",\"", "tfoot", "\"", ",\"", "th", "\"", ",\"", "thead", "\"", ",\"", "time", "\"", ",\"", "tr", "\"", ",\"", "track", "\"", ",\"", "tt", "\"", ",\"", "u", "\"", ",\"", "ul", "\"", ",\"", "var", "\"", ",\"", "video", "\"", ",\"", "wbr", "\"", "])", ",", "D", "=", "o", "(", "[\"", "svg", "\"", ",\"", "a", "\"", ",\"", "altglyph", "\"", ",\"", "altglyphdef", "\"", ",\"", "altglyphitem", "\"", ",\"", "animatecolor", "\"", ",\"", "animatemotion", "\"", ",\"", "animatetransform", "\"", ",\"", "audio", "\"", ",\"", "canvas", "\"", ",\"", "circle", "\"", ",\"", "clippath", "\"", ",\"", "defs", "\"", ",\"", "desc", "\"", ",\"", "ellipse", "\"", ",\"", "filter", "\"", ",\"", "font", "\"", ",\"", "g", "\"", ",\"", "glyph", "\"", ",\"", "glyphref", "\"", ",\"", "hkern", "\"", ",\"", "image", "\"", ",\"", "line", "\"", ",\"", "lineargradient", "\"", ",\"", "marker", "\"", ",\"", "mask", "\"", ",\"", "metadata", "\"", ",\"", "mpath", "\"", ",\"", "path", "\"", ",\"", "pattern", "\"", ",\"", "polygon", "\"", ",\"", "polyline", "\"", ",\"", "radialgradient", "\"", ",\"", "rect", "\"", ",\"", "stop", "\"", ",\"", "style", "\"", ",\"", "switch", "\"", ",\"", "symbol", "\"", ",\"", "text", "\"", ",\"", "textpath", "\"", ",\"", "title", "\"", ",\"", "tref", "\"", ",\"", "tspan", "\"", ",\"", "video", "\"", ",\"", "view", "\"", ",\"", "vkern", "\"", "])", ",", "N", "=", "o", "(", "[\"", "feBlend", "\"", ",\"", "feColorMatrix", "\"", ",\"", "feComponentTransfer", "\"", ",\"", "feComposite", "\"", ",\"", "feConvolveMatrix", "\"", ",\"", "feDiffuseLighting", "\"", ",\"", "feDisplacementMap", "\"", ",\"", "feDistantLight", "\"", ",\"", "feFlood", "\"", ",\"", "feFuncA", "\"", ",\"", "feFuncB", "\"", ",\"", "feFuncG", "\"", ",\"", "feFuncR", "\"", ",\"", "feGaussianBlur", "\"", ",\"", "feMerge", "\"", ",\"", "feMergeNode", "\"", ",\"", "feMorphology", "\"", ",\"", "feOffset", "\"", ",\"", "fePointLight", "\"", ",\"", "feSpecularLighting", "\"", ",\"", "feSpotLight", "\"", ",\"", "feTile", "\"", ",\"", "feTurbulence", "\"", "])", ",", "O", "=", "o", "(", "[\"", "math", "\"", ",\"", "menclose", "\"", ",\"", "merror", "\"", ",\"", "mfenced", "\"", ",\"", "mfrac", "\"", ",\"", "mglyph", "\"", ",\"", "mi", "\"", ",\"", "mlabeledtr", "\"", ",\"", "mmultiscripts", "\"", ",\"", "mn", "\"", ",\"", "mo", "\"", ",\"", "mover", "\"", ",\"", "mpadded", "\"", ",\"", "mphantom", "\"", ",\"", "mroot", "\"", ",\"", "mrow", "\"", ",\"", "ms", "\"", ",\"", "mspace", "\"", ",\"", "msqrt", "\"", ",\"", "mstyle", "\"", ",\"", "msub", "\"", ",\"", "msup", "\"", ",\"", "msubsup", "\"", ",\"", "mtable", "\"", ",\"", "mtd", "\"", ",\"", "mtext", "\"", ",\"", "mtr", "\"", ",\"", "munder", "\"", ",\"", "munderover", "\"", "])", ",", "R", "=", "o", "(", "[\"", "#", "text", "\"", "])", ",", "w", "=", "o", "(", "[\"", "accept", "\"", ",\"", "action", "\"", ",\"", "align", "\"", ",\"", "alt", "\"", ",\"", "autocapitalize", "\"", ",\"", "autocomplete", "\"", ",\"", "autopictureinpicture", "\"", ",\"", "autoplay", "\"", ",\"", "background", "\"", ",\"", "bgcolor", "\"", ",\"", "border", "\"", ",\"", "capture", "\"", ",\"", "cellpadding", "\"", ",\"", "cellspacing", "\"", ",\"", "checked", "\"", ",\"", "cite", "\"", ",\"", "class", "\"", ",\"", "clear", "\"", ",\"", "color", "\"", ",\"", "cols", "\"", ",\"", "colspan", "\"", ",\"", "controls", "\"", ",\"", "controlslist", "\"", ",\"", "coords", "\"", ",\"", "crossorigin", "\"", ",\"", "datetime", "\"", ",\"", "decoding", "\"", ",\"", "default", "\"", ",\"", "dir", "\"", ",\"", "disabled", "\"", ",\"", "disablepictureinpicture", "\"", ",\"", "disableremoteplayback", "\"", ",\"", "download", "\"", ",\"", "draggable", "\"", ",\"", "enctype", "\"", ",\"", "enterkeyhint", "\"", ",\"", "face", "\"", ",\"", "for", "\"", ",\"", "headers", "\"", ",\"", "height", "\"", ",\"", "hidden", "\"", ",\"", "high", "\"", ",\"", "href", "\"", ",\"", "hreflang", "\"", ",\"", "id", "\"", ",\"", "inputmode", "\"", ",\"", "integrity", "\"", ",\"", "ismap", "\"", ",\"", "kind", "\"", ",\"", "label", "\"", ",\"", "lang", "\"", ",\"", "list", "\"", ",\"", "loading", "\"", ",\"", "loop", "\"", ",\"", "low", "\"", ",\"", "max", "\"", ",\"", "maxlength", "\"", ",\"", "media", "\"", ",\"", "method", "\"", ",\"", "min", "\"", ",\"", "minlength", "\"", ",\"", "multiple", "\"", ",\"", "muted", "\"", ",\"", "name", "\"", ",\"", "noshade", "\"", ",\"", "novalidate", "\"", ",\"", "nowrap", "\"", ",\"", "open", "\"", ",\"", "optimum", "\"", ",\"", "pattern", "\"", ",\"", "placeholder", "\"", ",\"", "playsinline", "\"", ",\"", "poster", "\"", ",\"", "preload", "\"", ",\"", "pubdate", "\"", ",\"", "radiogroup", "\"", ",\"", "readonly", "\"", ",\"", "rel", "\"", ",\"", "required", "\"", ",\"", "rev", "\"", ",\"", "reversed", "\"", ",\"", "role", "\"", ",\"", "rows", "\"", ",\"", "rowspan", "\"", ",\"", "spellcheck", "\"", ",\"", "scope", "\"", ",\"", "selected", "\"", ",\"", "shape", "\"", ",\"", "size", "\"", ",\"", "sizes", "\"", ",\"", "span", "\"", ",\"", "srclang", "\"", ",\"", "start", "\"", ",\"", "src", "\"", ",\"", "srcset", "\"", ",\"", "step", "\"", ",\"", "style", "\"", ",\"", "summary", "\"", ",\"", "tabindex", "\"", ",\"", "title", "\"", ",\"", "translate", "\"", ",\"", "type", "\"", ",\"", "usemap", "\"", ",\"", "valign", "\"", ",\"", "value", "\"", ",\"", "width", "\"", ",\"", "xmlns", "\"", "])", ",", "F", "=", "o", "(", "[\"", "accent", "-", "height", "\"", ",\"", "accumulate", "\"", ",\"", "additive", "\"", ",\"", "alignment", "-", "baseline", "\"", ",\"", "ascent", "\"", ",\"", "attributename", "\"", ",\"", "attributetype", "\"", ",\"", "azimuth", "\"", ",\"", "basefrequency", "\"", ",\"", "baseline", "-", "shift", "\"", ",\"", "begin", "\"", ",\"", "bias", "\"", ",\"", "by", "\"", ",\"", "class", "\"", ",\"", "clip", "\"", ",\"", "clippathunits", "\"", ",\"", "clip", "-", "path", "\"", ",\"", "clip", "-", "rule", "\"", ",\"", "color", "\"", ",\"", "color", "-", "interpolation", "\"", ",\"", "color", "-", "interpolation", "-", "filters", "\"", ",\"", "color", "-", "profile", "\"", ",\"", "color", "-", "rendering", "\"", ",\"", "cx", "\"", ",\"", "cy", "\"", ",\"", "d", "\"", ",\"", "dx", "\"", ",\"", "dy", "\"", ",\"", "diffuseconstant", "\"", ",\"", "direction", "\"", ",\"", "display", "\"", ",\"", "divisor", "\"", ",\"", "dur", "\"", ",\"", "edgemode", "\"", ",\"", "elevation", "\"", ",\"", "end", "\"", ",\"", "fill", "\"", ",\"", "fill", "-", "opacity", "\"", ",\"", "fill", "-", "rule", "\"", ",\"", "filter", "\"", ",\"", "filterunits", "\"", ",\"", "flood", "-", "color", "\"", ",\"", "flood", "-", "opacity", "\"", ",\"", "font", "-", "family", "\"", ",\"", "font", "-", "size", "\"", ",\"", "font", "-", "size", "-", "adjust", "\"", ",\"", "font", "-", "stretch", "\"", ",\"", "font", "-", "style", "\"", ",\"", "font", "-", "variant", "\"", ",\"", "font", "-", "weight", "\"", ",\"", "fx", "\"", ",\"", "fy", "\"", ",\"", "g1", "\"", ",\"", "g2", "\"", ",\"", "glyph", "-", "name", "\"", ",\"", "glyphref", "\"", ",\"", "gradientunits", "\"", ",\"", "gradienttransform", "\"", ",\"", "height", "\"", ",\"", "href", "\"", ",\"", "id", "\"", ",\"", "image", "-", "rendering", "\"", ",\"", "in", "\"", ",\"", "in2", "\"", ",\"", "k", "\"", ",\"", "k1", "\"", ",\"", "k2", "\"", ",\"", "k3", "\"", ",\"", "k4", "\"", ",\"", "kerning", "\"", ",\"", "keypoints", "\"", ",\"", "keysplines", "\"", ",\"", "keytimes", "\"", ",\"", "lang", "\"", ",\"", "lengthadjust", "\"", ",\"", "letter", "-", "spacing", "\"", ",\"", "kernelmatrix", "\"", ",\"", "kernelunitlength", "\"", ",\"", "lighting", "-", "color", "\"", ",\"", "local", "\"", ",\"", "marker", "-", "end", "\"", ",\"", "marker", "-", "mid", "\"", ",\"", "marker", "-", "start", "\"", ",\"", "markerheight", "\"", ",\"", "markerunits", "\"", ",\"", "markerwidth", "\"", ",\"", "maskcontentunits", "\"", ",\"", "maskunits", "\"", ",\"", "max", "\"", ",\"", "mask", "\"", ",\"", "media", "\"", ",\"", "method", "\"", ",\"", "mode", "\"", ",\"", "min", "\"", ",\"", "name", "\"", ",\"", "numoctaves", "\"", ",\"", "offset", "\"", ",\"", "operator", "\"", ",\"", "opacity", "\"", ",\"", "order", "\"", ",\"", "orient", "\"", ",\"", "orientation", "\"", ",\"", "origin", "\"", ",\"", "overflow", "\"", ",\"", "paint", "-", "order", "\"", ",\"", "path", "\"", ",\"", "pathlength", "\"", ",\"", "patterncontentunits", "\"", ",\"", "patterntransform", "\"", ",\"", "patternunits", "\"", ",\"", "points", "\"", ",\"", "preservealpha", "\"", ",\"", "preserveaspectratio", "\"", ",\"", "primitiveunits", "\"", ",\"", "r", "\"", ",\"", "rx", "\"", ",\"", "ry", "\"", ",\"", "radius", "\"", ",\"", "refx", "\"", ",\"", "refy", "\"", ",\"", "repeatcount", "\"", ",\"", "repeatdur", "\"", ",\"", "restart", "\"", ",\"", "result", "\"", ",\"", "rotate", "\"", ",\"", "scale", "\"", ",\"", "seed", "\"", ",\"", "shape", "-", "rendering", "\"", ",\"", "specularconstant", "\"", ",\"", "specularexponent", "\"", ",\"", "spreadmethod", "\"", ",\"", "startoffset", "\"", ",\"", "stddeviation", "\"", ",\"", "stitchtiles", "\"", ",\"", "stop", "-", "color", "\"", ",\"", "stop", "-", "opacity", "\"", ",\"", "stroke", "-", "dasharray", "\"", ",\"", "stroke", "-", "dashoffset", "\"", ",\"", "stroke", "-", "linecap", "\"", ",\"", "stroke", "-", "linejoin", "\"", ",\"", "stroke", "-", "miterlimit", "\"", ",\"", "stroke", "-", "opacity", "\"", ",\"", "stroke", "\"", ",\"", "stroke", "-", "width", "\"", ",\"", "style", "\"", ",\"", "surfacescale", "\"", ",\"", "systemlanguage", "\"", ",\"", "tabindex", "\"", ",\"", "targetx", "\"", ",\"", "targety", "\"", ",\"", "transform", "\"", ",\"", "text", "-", "anchor", "\"", ",\"", "text", "-", "decoration", "\"", ",\"", "text", "-", "rendering", "\"", ",\"", "textlength", "\"", ",\"", "type", "\"", ",\"", "u1", "\"", ",\"", "u2", "\"", ",\"", "unicode", "\"", ",\"", "values", "\"", ",\"", "viewbox", "\"", ",\"", "visibility", "\"", ",\"", "version", "\"", ",\"", "vert", "-", "adv", "-", "y", "\"", ",\"", "vert", "-", "origin", "-", "x", "\"", ",\"", "vert", "-", "origin", "-", "y", "\"", ",\"", "width", "\"", ",\"", "word", "-", "spacing", "\"", ",\"", "wrap", "\"", ",\"", "writing", "-", "mode", "\"", ",\"", "xchannelselector", "\"", ",\"", "ychannelselector", "\"", ",\"", "x", "\"", ",\"", "x1", "\"", ",\"", "x2", "\"", ",\"", "xmlns", "\"", ",\"", "y", "\"", ",\"", "y1", "\"", ",\"", "y2", "\"", ",\"", "z", "\"", ",\"", "zoomandpan", "\"", "])", ",", "H", "=", "o", "(", "[\"", "accent", "\"", ",\"", "accentunder", "\"", ",\"", "align", "\"", ",\"", "bevelled", "\"", ",\"", "close", "\"", ",\"", "columnsalign", "\"", ",\"", "columnlines", "\"", ",\"", "columnspan", "\"", ",\"", "denomalign", "\"", ",\"", "depth", "\"", ",\"", "dir", "\"", ",\"", "display", "\"", ",\"", "displaystyle", "\"", ",\"", "encoding", "\"", ",\"", "fence", "\"", ",\"", "frame", "\"", ",\"", "height", "\"", ",\"", "href", "\"", ",\"", "id", "\"", ",\"", "largeop", "\"", ",\"", "length", "\"", ",\"", "linethickness", "\"", ",\"", "lspace", "\"", ",\"", "lquote", "\"", ",\"", "mathbackground", "\"", ",\"", "mathcolor", "\"", ",\"", "mathsize", "\"", ",\"", "mathvariant", "\"", ",\"", "maxsize", "\"", ",\"", "minsize", "\"", ",\"", "movablelimits", "\"", ",\"", "notation", "\"", ",\"", "numalign", "\"", ",\"", "open", "\"", ",\"", "rowalign", "\"", ",\"", "rowlines", "\"", ",\"", "rowspacing", "\"", ",\"", "rowspan", "\"", ",\"", "rspace", "\"", ",\"", "rquote", "\"", ",\"", "scriptlevel", "\"", ",\"", "scriptminsize", "\"", ",\"", "scriptsizemultiplier", "\"", ",\"", "selection", "\"", ",\"", "separator", "\"", ",\"", "separators", "\"", ",\"", "stretchy", "\"", ",\"", "subscriptshift", "\"", ",\"", "supscriptshift", "\"", ",\"", "symmetric", "\"", ",\"", "voffset", "\"", ",\"", "width", "\"", ",\"", "xmlns", "\"", "])", ",", "C", "=", "o", "(", "[\"", "xlink", ":", "href", "\"", ",\"", "xml", ":", "id", "\"", ",\"", "xlink", ":", "title", "\"", ",\"", "xml", ":", "space", "\"", ",\"", "xmlns", ":", "xlink", "\"", "])", ",", "z", "=", "i", "(", "/\\", "{\\", "{[", "\\", "s", "\\", "S", "]", "*|", "[\\", "s", "\\", "S", "]", "*\\", "}\\", "}/", "gm", ")", ",", "I", "=", "i", "(", "/<", "%[", "\\", "s", "\\", "S", "]", "*|", "[\\", "s", "\\", "S", "]", "*%", ">/", "gm", ")", ",", "U", "=", "i", "(", "/^", "data", "-", "[\\", "-\\", "w", ".", "\\", "u00B7", "-", "\\", "uFFFF", "]", "/)", ",", "j", "=", "i", "(", "/^", "aria", "-", "[\\", "-\\", "w", "]", "+$", "/)", ",", "P", "=", "i", "(", "/^", "(?", ":(", "?:", "(?", ":", "f", "|", "ht", ")", "tps", "?", "|", "mailto", "|", "tel", "|", "callto", "|", "cid", "|", "xmpp", ")", ":|", "[^", "a", "-", "z", "]", "|[", "a", "-", "z", "+", ".\\", "-]", "+(", "?:", "[^", "a", "-", "z", "+", ".\\", "-:", "]|", "$)", ")/", "i", ")", ",", "G", "=", "i", "(", "/^", "(?", ":\\", "w", "+", "script", "|", "data", ")", ":/", "i", ")", ",", "W", "=", "i", "(", "/[", "\\", "u0000", "-", "\\", "u0020", "\\", "u00A0", "\\", "u1680", "\\", "u180E", "\\", "u2000", "-", "\\", "u2029", "\\", "u205F", "\\", "u3000", "]", "/", "g", ")", ",", "B", "=", "\"", "function", "\"", "==", "typeof", "Symbol", "&", "&\"", "symbol", "\"", "==", "typeof", "Symbol", ".", "iterator", "?", "function", "(", "e", ")", "{", "return", "typeof", "e", "}", ":", "function", "(", "e", ")", "{", "return", "e", "&", "&\"", "function", "\"", "==", "typeof", "Symbol", "&", "&", "e", ".", "constructor", "=", "==", "Symbol", "&", "&", "e", "!", "==", "Symbol", ".", "prototype", "?", "\"", "symbol", "\"", ":", "typeof", "e", "}", ";", "function", "q", "(", "e", ")", "{", "if", "(", "Array", ".", "isArray", "(", "e", ")", "){", "for", "(", "var", "t", "=", "0", ",", "n", "=", "Array", "(", "e", ".", "length", ")", ";", "t", "<", "e", ".", "length", ";", "t", "+", "+)", "n", "[", "t", "]", "=", "e", "[", "t", "]", ";", "return", "n", "}", "return", "Array", ".", "from", "(", "e", ")", "}", "var", "K", "=", "function", "(", "){", "return", "\"", "undefined", "\"", "==", "typeof", "window", "?", "null", ":", "window", "}", ",", "V", "=", "function", "(", "e", ",", "t", ")", "{", "if", "(", "\"", "object", "\"", "!=", "=(", "void", "0", "=", "==", "e", "?", "\"", "undefined", "\"", ":", "B", "(", "e", ")", ")|", "|\"", "function", "\"", "!=", "typeof", "e", ".", "createPolicy", ")", "return", "null", ";", "var", "n", "=", "null", ";", "t", ".", "currentScript", "&", "&", "t", ".", "currentScript", ".", "hasAttribute", "(", "\"", "data", "-", "tt", "-", "policy", "-", "suffix", "\"", ")&", "&(", "n", "=", "t", ".", "currentScript", ".", "getAttribute", "(", "\"", "data", "-", "tt", "-", "policy", "-", "suffix", "\"", "))", ";", "var", "r", "=", "\"", "dompurify", "\"", "+(", "n", "?", "\"#", "\"+", "n", ":", "\"\"", ");", "try", "{", "return", "e", ".", "createPolicy", "(", "r", ",", "{", "createHTML", ":", "function", "(", "e", ")", "{", "return", "e", "}", "})", "}", "catch", "(", "e", ")", "{", "return", "console", ".", "warn", "(", "\"", "TrustedTypes", "policy", "\"", "+", "r", "+", "\"", "could", "not", "be", "created", ".", "\")", ",", "null", "}", "};", "return", "function", "e", "(", "){", "var", "t", "=", "arguments", ".", "length", ">", "0", "&", "&", "void", "0", "!", "==", "arguments", "[", "0", "]", "?", "arguments", "[", "0", "]", ":", "K", "(", "),", "n", "=", "function", "(", "t", ")", "{", "return", "e", "(", "t", ")", "};", "if", "(", "n", ".", "version", "=", "\"", "2", ".", "0", ".", "16", "\"", ",", "n", ".", "removed", "=", "[]", ",!", "t", "|", "|!", "t", ".", "document", "|", "|", "9", "!", "==", "t", ".", "document", ".", "nodeType", ")", "return", "n", ".", "isSupported", "=", "!", "1", ",", "n", ";", "var", "i", "=", "t", ".", "document", ",", "a", "=", "!", "1", ",", "l", "=", "t", ".", "document", ",", "c", "=", "t", ".", "DocumentFragment", ",", "s", "=", "t", ".", "HTMLTemplateElement", ",", "k", "=", "t", ".", "Node", ",", "L", "=", "t", ".", "NodeFilter", ",", "Y", "=", "t", ".", "NamedNodeMap", ",", "X", "=", "void", "0", "=", "==", "Y", "?", "t", ".", "NamedNodeMap", "|", "|", "t", ".", "MozNamedAttrMap", ":", "Y", ",", "$=", "t", ".", "Text", ",", "J", "=", "t", ".", "Comment", ",", "Q", "=", "t", ".", "DOMParser", ",", "Z", "=", "t", ".", "trustedTypes", ";", "if", "(", "\"", "function", "\"", "==", "typeof", "s", ")", "{", "var", "ee", "=", "l", ".", "createElement", "(", "\"", "template", "\"", ");", "ee", ".", "content", "&", "&", "ee", ".", "content", ".", "ownerDocument", "&", "&(", "l", "=", "ee", ".", "content", ".", "ownerDocument", ")", "}", "var", "te", "=", "V", "(", "Z", ",", "i", ")", ",", "ne", "=", "te", "&", "&", "He", "?", "te", ".", "createHTML", "(", "\"\"", "):", "\"\"", ",", "re", "=", "l", ",", "oe", "=", "re", ".", "implementation", ",", "ie", "=", "re", ".", "createNodeIterator", ",", "ae", "=", "re", ".", "getElementsByTagName", ",", "le", "=", "re", ".", "createDocumentFragment", ",", "ce", "=", "i", ".", "importNode", ",", "se", "=", "{}", ";", "try", "{", "se", "=", "E", "(", "l", ")", ".", "documentMode", "?", "l", ".", "documentMode", ":", "{}", "}", "catch", "(", "e", ")", "{}", "var", "ue", "=", "{}", ";", "n", ".", "isSupported", "=", "oe", "&", "&", "void", "0", "!", "==", "oe", ".", "createHTMLDocument", "&", "&", "9", "!", "==", "se", ";", "var", "de", "=", "z", ",", "fe", "=", "I", ",", "pe", "=", "U", ",", "me", "=", "j", ",", "ye", "=", "G", ",", "ge", "=", "W", ",", "he", "=", "P", ",", "ve", "=", "null", ",", "be", "=", "_", "(", "{}", ",[", "].", "concat", "(", "q", "(", "M", ")", ",", "q", "(", "D", ")", ",", "q", "(", "N", ")", ",", "q", "(", "O", ")", ",", "q", "(", "R", ")", "))", ",", "Te", "=", "null", ",", "Ae", "=", "_", "(", "{}", ",[", "].", "concat", "(", "q", "(", "w", ")", ",", "q", "(", "F", ")", ",", "q", "(", "H", ")", ",", "q", "(", "C", ")", "))", ",", "xe", "=", "null", ",", "Se", "=", "null", ",", "ke", "=", "!", "0", ",", "Le", "=", "!", "0", ",", "_e", "=", "!", "1", ",", "Ee", "=", "!", "1", ",", "Me", "=", "!", "1", ",", "De", "=", "!", "1", ",", "Ne", "=", "!", "1", ",", "Oe", "=", "!", "1", ",", "Re", "=", "!", "1", ",", "we", "=", "!", "1", ",", "Fe", "=", "!", "1", ",", "He", "=", "!", "1", ",", "Ce", "=", "!", "0", ",", "ze", "=", "!", "0", ",", "Ie", "=", "!", "1", ",", "Ue", "=", "{}", ",", "je", "=", "_", "(", "{}", ",[", "\"", "annotation", "-", "xml", "\"", ",\"", "audio", "\"", ",\"", "colgroup", "\"", ",\"", "desc", "\"", ",\"", "foreignobject", "\"", ",\"", "head", "\"", ",\"", "iframe", "\"", ",\"", "math", "\"", ",\"", "mi", "\"", ",\"", "mn", "\"", ",\"", "mo", "\"", ",\"", "ms", "\"", ",\"", "mtext", "\"", ",\"", "noembed", "\"", ",\"", "noframes", "\"", ",\"", "plaintext", "\"", ",\"", "script", "\"", ",\"", "style", "\"", ",\"", "svg", "\"", ",\"", "template", "\"", ",\"", "thead", "\"", ",\"", "title", "\"", ",\"", "video", "\"", ",\"", "xmp", "\"", "])", ",", "Pe", "=", "null", ",", "Ge", "=", "_", "(", "{}", ",[", "\"", "audio", "\"", ",\"", "video", "\"", ",\"", "img", "\"", ",\"", "source", "\"", ",\"", "image", "\"", ",\"", "track", "\"", "])", ",", "We", "=", "null", ",", "Be", "=", "_", "(", "{}", ",[", "\"", "alt", "\"", ",\"", "class", "\"", ",\"", "for", "\"", ",\"", "id", "\"", ",\"", "label", "\"", ",\"", "name", "\"", ",\"", "pattern", "\"", ",\"", "placeholder", "\"", ",\"", "summary", "\"", ",\"", "title", "\"", ",\"", "value", "\"", ",\"", "style", "\"", ",\"", "xmlns", "\"", "])", ",", "qe", "=", "null", ",", "Ke", "=", "l", ".", "createElement", "(", "\"", "form", "\"", "),", "Ve", "=", "function", "(", "e", ")", "{", "qe", "&", "&", "qe", "=", "==", "e", "|", "|(", "e", "&", "&\"", "object", "\"", "==", "=(", "void", "0", "=", "==", "e", "?", "\"", "undefined", "\"", ":", "B", "(", "e", ")", ")|", "|(", "e", "=", "{}", "),", "e", "=", "E", "(", "e", ")", ",", "ve", "=", "\"", "ALLOWED_TAGS", "\"", "in", "e", "?", "_", "(", "{}", ",", "e", ".", "ALLOWED_TAGS", ")", ":", "be", ",", "Te", "=", "\"", "ALLOWED_ATTR", "\"", "in", "e", "?", "_", "(", "{}", ",", "e", ".", "ALLOWED_ATTR", ")", ":", "Ae", ",", "We", "=", "\"", "ADD_URI_SAFE_ATTR", "\"", "in", "e", "?", "_", "(", "E", "(", "Be", ")", ",", "e", ".", "ADD_URI_SAFE_ATTR", ")", ":", "Be", ",", "Pe", "=", "\"", "ADD_DATA_URI_TAGS", "\"", "in", "e", "?", "_", "(", "E", "(", "Ge", ")", ",", "e", ".", "ADD_DATA_URI_TAGS", ")", ":", "Ge", ",", "xe", "=", "\"", "FORBID_TAGS", "\"", "in", "e", "?", "_", "(", "{}", ",", "e", ".", "FORBID_TAGS", ")", ":{", "},", "Se", "=", "\"", "FORBID_ATTR", "\"", "in", "e", "?", "_", "(", "{}", ",", "e", ".", "FORBID_ATTR", ")", ":{", "},", "Ue", "=", "\"", "USE_PROFILES", "\"", "in", "e", "&", "&", "e", ".", "USE_PROFILES", ",", "ke", "=", "!", "1", "!", "==", "e", ".", "ALLOW_ARIA_ATTR", ",", "Le", "=", "!", "1", "!", "==", "e", ".", "ALLOW_DATA_ATTR", ",", "_e", "=", "e", ".", "ALLOW_UNKNOWN_PROTOCOLS", "|", "|!", "1", ",", "Ee", "=", "e", ".", "SAFE_FOR_JQUERY", "|", "|!", "1", ",", "Me", "=", "e", ".", "SAFE_FOR_TEMPLATES", "|", "|!", "1", ",", "De", "=", "e", ".", "WHOLE_DOCUMENT", "|", "|!", "1", ",", "Re", "=", "e", ".", "RETURN_DOM", "|", "|!", "1", ",", "we", "=", "e", ".", "RETURN_DOM_FRAGMENT", "|", "|!", "1", ",", "Fe", "=", "e", ".", "RETURN_DOM_IMPORT", "|", "|!", "1", ",", "He", "=", "e", ".", "RETURN_TRUSTED_TYPE", "|", "|!", "1", ",", "Oe", "=", "e", ".", "FORCE_BODY", "|", "|!", "1", ",", "Ce", "=", "!", "1", "!", "==", "e", ".", "SANITIZE_DOM", ",", "ze", "=", "!", "1", "!", "==", "e", ".", "KEEP_CONTENT", ",", "Ie", "=", "e", ".", "IN_PLACE", "|", "|!", "1", ",", "he", "=", "e", ".", "ALLOWED_URI_REGEXP", "|", "|", "he", ",", "Me", "&", "&(", "Le", "=", "!", "1", ")", ",", "we", "&", "&(", "Re", "=", "!", "0", ")", ",", "Ue", "&", "&(", "ve", "=", "_", "(", "{}", ",[", "].", "concat", "(", "q", "(", "R", ")", "))", ",", "Te", "=", "[]", ",!", "0", "=", "==", "Ue", ".", "html", "&", "&(", "_", "(", "ve", ",", "M", ")", ",", "_", "(", "Te", ",", "w", ")", "),", "!", "0", "=", "==", "Ue", ".", "svg", "&", "&(", "_", "(", "ve", ",", "D", ")", ",", "_", "(", "Te", ",", "F", ")", ",", "_", "(", "Te", ",", "C", ")", "),", "!", "0", "=", "==", "Ue", ".", "svgFilters", "&", "&(", "_", "(", "ve", ",", "N", ")", ",", "_", "(", "Te", ",", "F", ")", ",", "_", "(", "Te", ",", "C", ")", "),", "!", "0", "=", "==", "Ue", ".", "mathMl", "&", "&(", "_", "(", "ve", ",", "O", ")", ",", "_", "(", "Te", ",", "H", ")", ",", "_", "(", "Te", ",", "C", ")", "))", ",", "e", ".", "ADD_TAGS", "&", "&(", "ve", "=", "==", "be", "&", "&(", "ve", "=", "E", "(", "ve", ")", "),", "_", "(", "ve", ",", "e", ".", "ADD_TAGS", ")", "),", "e", ".", "ADD_ATTR", "&", "&(", "Te", "=", "==", "Ae", "&", "&(", "Te", "=", "E", "(", "Te", ")", "),", "_", "(", "Te", ",", "e", ".", "ADD_ATTR", ")", "),", "e", ".", "ADD_URI_SAFE_ATTR", "&", "&", "_", "(", "We", ",", "e", ".", "ADD_URI_SAFE_ATTR", ")", ",", "ze", "&", "&(", "ve", "[", "\"#", "text", "\"", "]=", "!", "0", ")", ",", "De", "&", "&", "_", "(", "ve", ",", "[\"", "html", "\"", ",\"", "head", "\"", ",\"", "body", "\"", "])", ",", "ve", ".", "table", "&", "&(", "_", "(", "ve", ",", "[\"", "tbody", "\"", "])", ",", "delete", "xe", ".", "tbody", ")", ",", "o", "&", "&", "o", "(", "e", ")", ",", "qe", "=", "e", ")", "},", "Ye", "=", "function", "(", "e", ")", "{", "m", "(", "n", ".", "removed", ",", "{", "element", ":", "e", "}", ");", "try", "{", "e", ".", "parentNode", ".", "removeChild", "(", "e", ")", "}", "catch", "(", "t", ")", "{", "e", ".", "outerHTML", "=", "ne", "}", "},", "Xe", "=", "function", "(", "e", ",", "t", ")", "{", "try", "{", "m", "(", "n", ".", "removed", ",", "{", "attribute", ":", "t", ".", "getAttributeNode", "(", "e", ")", ",", "from", ":", "t", "}", ")}", "catch", "(", "e", ")", "{", "m", "(", "n", ".", "removed", ",", "{", "attribute", ":", "null", ",", "from", ":", "t", "}", ")}", "t", ".", "removeAttribute", "(", "e", ")", "},", "$", "e", "=", "function", "(", "e", ")", "{", "var", "t", "=", "void", "0", ",", "n", "=", "void", "0", ";", "if", "(", "Oe", ")", "e", "=", "\"<", "remove", ">", "</", "remove", ">", "\"+", "e", ";", "else", "{", "var", "r", "=", "h", "(", "e", ",", "/^", "[\\", "r", "\\", "n", "\\", "t", "]", "+/", ");", "n", "=", "r", "&", "&", "r", "[", "0", "]", "}", "var", "o", "=", "te", "?", "te", ".", "createHTML", "(", "e", ")", ":", "e", ";", "try", "{", "t", "=", "(", "new", "Q", ")", ".", "parseFromString", "(", "o", ",", "\"", "text", "/", "html", "\"", ")}", "catch", "(", "e", ")", "{}", "if", "(", "a", "&", "&", "_", "(", "xe", ",", "[\"", "title", "\"", "])", ",!", "t", "|", "|!", "t", ".", "documentElement", ")", "{", "var", "i", "=", "(", "t", "=", "oe", ".", "createHTMLDocument", "(", "\"\"", "))", ".", "body", ";", "i", ".", "parentNode", ".", "removeChild", "(", "i", ".", "parentNode", ".", "firstElementChild", ")", ",", "i", ".", "outerHTML", "=", "o", "}", "return", "e", "&", "&", "n", "&", "&", "t", ".", "body", ".", "insertBefore", "(", "l", ".", "createTextNode", "(", "n", ")", ",", "t", ".", "body", ".", "childNodes", "[", "0", "]", "||", "null", ")", ",", "ae", ".", "call", "(", "t", ",", "De", "?", "\"", "html", "\"", ":\"", "body", "\"", ")[", "0", "]", "};", "n", ".", "isSupported", "&", "&", "function", "(", "){", "try", "{", "var", "e", "=", "$", "e", "(", "\"<", "x", "/", "><", "title", ">", "&", "lt", ";", "/", "title", "&", "gt", ";", "&", "lt", ";", "img", "&", "gt", ";", "\")", ";", "A", "(", "/<", "\\/", "title", "/", ",", "e", ".", "querySelector", "(", "\"", "title", "\"", ").", "innerHTML", ")", "&&", "(", "a", "=", "!", "0", ")", "}", "catch", "(", "e", ")", "{}", "}(", ");", "var", "Je", "=", "function", "(", "e", ")", "{", "return", "ie", ".", "call", "(", "e", ".", "ownerDocument", "|", "|", "e", ",", "e", ",", "L", ".", "SHOW_ELEMENT", "|", "L", ".", "SHOW_COMMENT", "|", "L", ".", "SHOW_TEXT", ",", "(", "function", "(", "){", "return", "L", ".", "FILTER_ACCEPT", "}", "),", "!", "1", ")", "},", "Qe", "=", "function", "(", "e", ")", "{", "return", "!", "(", "e", "instanceof", "$", "||", "e", "instanceof", "J", ")", "&&", "!(", "\"", "string", "\"", "==", "typeof", "e", ".", "nodeName", "&", "&\"", "string", "\"", "==", "typeof", "e", ".", "textContent", "&", "&\"", "function", "\"", "==", "typeof", "e", ".", "removeChild", "&", "&", "e", ".", "attributes", "instanceof", "X", "&", "&\"", "function", "\"", "==", "typeof", "e", ".", "removeAttribute", "&", "&\"", "function", "\"", "==", "typeof", "e", ".", "setAttribute", "&", "&\"", "string", "\"", "==", "typeof", "e", ".", "namespaceURI", ")", "},", "Ze", "=", "function", "(", "e", ")", "{", "return", "\"", "object", "\"", "==", "=(", "void", "0", "=", "==", "k", "?", "\"", "undefined", "\"", ":", "B", "(", "k", ")", ")?", "e", "instanceof", "k", ":", "e", "&", "&\"", "object", "\"", "==", "=(", "void", "0", "=", "==", "e", "?", "\"", "undefined", "\"", ":", "B", "(", "e", ")", ")&", "&\"", "number", "\"", "==", "typeof", "e", ".", "nodeType", "&", "&\"", "string", "\"", "==", "typeof", "e", ".", "nodeName", "}", ",", "et", "=", "function", "(", "e", ",", "t", ",", "r", ")", "{", "ue", "[", "e", "]", "&&", "u", "(", "ue", "[", "e", "]", ",(", "function", "(", "e", ")", "{", "e", ".", "call", "(", "n", ",", "t", ",", "r", ",", "qe", ")", "})", ")}", ",", "tt", "=", "function", "(", "e", ")", "{", "var", "t", "=", "void", "0", ";", "if", "(", "et", "(", "\"", "beforeSanitizeElements", "\"", ",", "e", ",", "null", ")", ",", "Qe", "(", "e", ")", ")", "return", "Ye", "(", "e", ")", ",!", "0", ";", "if", "(", "h", "(", "e", ".", "nodeName", ",", "/[", "\\", "u0080", "-", "\\", "uFFFF", "]", "/)", ")", "return", "Ye", "(", "e", ")", ",!", "0", ";", "var", "r", "=", "g", "(", "e", ".", "nodeName", ")", ";", "if", "(", "et", "(", "\"", "uponSanitizeElement", "\"", ",", "e", ",", "{", "tagName", ":", "r", ",", "allowedTags", ":", "ve", "}", "),", "(\"", "svg", "\"", "==", "=", "r", "|", "|\"", "math", "\"", "==", "=", "r", ")", "&&", "0", "!", "==", "e", ".", "querySelectorAll", "(", "\"", "p", ",", "br", ",", "form", "\"", ").", "length", ")", "return", "Ye", "(", "e", ")", ",!", "0", ";", "if", "(", "!", "ve", "[", "r", "]", "||", "xe", "[", "r", "]", "){", "if", "(", "ze", "&", "&!", "je", "[", "r", "]", "&&", "\"", "function", "\"", "==", "typeof", "e", ".", "insertAdjacentHTML", ")", "try", "{", "var", "o", "=", "e", ".", "innerHTML", ";", "e", ".", "insertAdjacentHTML", "(", "\"", "AfterEnd", "\"", ",", "te", "?", "te", ".", "createHTML", "(", "o", ")", ":", "o", ")", "}", "catch", "(", "e", ")", "{}", "return", "Ye", "(", "e", ")", ",!", "0", "}", "return", "\"", "noscript", "\"", "==", "=", "r", "&", "&", "A", "(", "/<", "\\/", "noscript", "/", "i", ",", "e", ".", "innerHTML", ")", "||", "\"", "noembed", "\"", "==", "=", "r", "&", "&", "A", "(", "/<", "\\/", "noembed", "/", "i", ",", "e", ".", "innerHTML", ")", "?(", "Ye", "(", "e", ")", ",!", "0", ")", ":(", "!", "Ee", "|", "|", "Ze", "(", "e", ".", "firstElementChild", ")", "||", "Ze", "(", "e", ".", "content", ")", "&&", "Ze", "(", "e", ".", "content", ".", "firstElementChild", ")", "||", "!", "A", "(", "/<", "/", "g", ",", "e", ".", "textContent", ")", "||", "(", "m", "(", "n", ".", "removed", ",", "{", "element", ":", "e", ".", "cloneNode", "(", ")}", "),", "e", ".", "innerHTML", "?", "e", ".", "innerHTML", "=", "v", "(", "e", ".", "innerHTML", ",", "/<", "/", "g", ",", "\"&", "lt", ";", "\")", ":", "e", ".", "innerHTML", "=", "v", "(", "e", ".", "textContent", ",", "/<", "/", "g", ",", "\"&", "lt", ";", "\")", "),", "Me", "&", "&", "3", "=", "==", "e", ".", "nodeType", "&", "&(", "t", "=", "e", ".", "textContent", ",", "t", "=", "v", "(", "t", ",", "de", ",", "\"", "\"", "),", "t", "=", "v", "(", "t", ",", "fe", ",", "\"", "\"", "),", "e", ".", "textContent", "!", "==", "t", "&", "&(", "m", "(", "n", ".", "removed", ",", "{", "element", ":", "e", ".", "cloneNode", "(", ")}", "),", "e", ".", "textContent", "=", "t", ")", "),", "et", "(", "\"", "afterSanitizeElements", "\"", ",", "e", ",", "null", ")", ",!", "1", ")", "},", "nt", "=", "function", "(", "e", ",", "t", ",", "n", ")", "{", "if", "(", "Ce", "&", "&(", "\"", "id", "\"", "==", "=", "t", "|", "|\"", "name", "\"", "==", "=", "t", ")", "&&", "(", "n", "in", "l", "|", "|", "n", "in", "Ke", ")", ")", "return", "!", "1", ";", "if", "(", "Le", "&", "&", "A", "(", "pe", ",", "t", ")", ");", "else", "if", "(", "ke", "&", "&", "A", "(", "me", ",", "t", ")", ");", "else", "{", "if", "(", "!", "Te", "[", "t", "]", "||", "Se", "[", "t", "]", ")", "return", "!", "1", ";", "if", "(", "We", "[", "t", "]", ");", "else", "if", "(", "A", "(", "he", ",", "v", "(", "n", ",", "ge", ",", "\"\"", "))", ");", "else", "if", "(", "\"", "src", "\"", "!=", "=", "t", "&", "&\"", "xlink", ":", "href", "\"", "!=", "=", "t", "&", "&\"", "href", "\"", "!=", "=", "t", "|", "|\"", "script", "\"", "==", "=", "e", "|", "|", "0", "!", "==", "b", "(", "n", ",", "\"", "data", ":", "\")", "||", "!", "Pe", "[", "e", "]", "){", "if", "(", "_e", "&", "&!", "A", "(", "ye", ",", "v", "(", "n", ",", "ge", ",", "\"\"", "))", ");", "else", "if", "(", "n", ")", "return", "!", "1", "}", "else", ";", "}", "return", "!", "0", "}", ",", "rt", "=", "function", "(", "e", ")", "{", "var", "t", "=", "void", "0", ",", "o", "=", "void", "0", ",", "i", "=", "void", "0", ",", "a", "=", "void", "0", ",", "l", "=", "void", "0", ";", "et", "(", "\"", "beforeSanitizeAttributes", "\"", ",", "e", ",", "null", ")", ";", "var", "c", "=", "e", ".", "attributes", ";", "if", "(", "c", ")", "{", "var", "s", "=", "{", "attrName", ":", "\"\"", ",", "attrValue", ":", "\"\"", ",", "keepAttr", ":", "!", "0", ",", "allowedAttributes", ":", "Te", "}", ";", "for", "(", "l", "=", "c", ".", "length", ";", "l", "-", "-;", "){", "var", "u", "=", "t", "=", "c", "[", "l", "]", ",", "m", "=", "u", ".", "name", ",", "h", "=", "u", ".", "namespaceURI", ";", "if", "(", "o", "=", "T", "(", "t", ".", "value", ")", ",", "i", "=", "g", "(", "m", ")", ",", "s", ".", "attrName", "=", "i", ",", "s", ".", "attrValue", "=", "o", ",", "s", ".", "keepAttr", "=", "!", "0", ",", "s", ".", "forceKeepAttr", "=", "void", "0", ",", "et", "(", "\"", "uponSanitizeAttribute", "\"", ",", "e", ",", "s", ")", ",", "o", "=", "s", ".", "attrValue", ",", "!", "s", ".", "forceKeepAttr", ")", "{", "if", "(", "\"", "name", "\"", "==", "=", "i", "&", "&\"", "IMG", "\"", "==", "=", "e", ".", "nodeName", "&", "&", "c", ".", "id", ")", "a", "=", "c", ".", "id", ",", "c", "=", "y", "(", "c", ",", "[]", "),", "Xe", "(", "\"", "id", "\"", ",", "e", ")", ",", "Xe", "(", "m", ",", "e", ")", ",", "d", "(", "c", ",", "a", ")", ">", "l", "&", "&", "e", ".", "setAttribute", "(", "\"", "id", "\"", ",", "a", ".", "value", ")", ";", "else", "{", "if", "(", "\"", "INPUT", "\"", "==", "=", "e", ".", "nodeName", "&", "&\"", "type", "\"", "==", "=", "i", "&", "&\"", "file", "\"", "==", "=", "o", "&", "&", "s", ".", "keepAttr", "&", "&(", "Te", "[", "i", "]", "||", "!", "Se", "[", "i", "]", "))", "continue", ";", "\"", "id", "\"", "==", "=", "m", "&", "&", "e", ".", "setAttribute", "(", "m", ",", "\"\"", "),", "Xe", "(", "m", ",", "e", ")", "}", "if", "(", "s", ".", "keepAttr", ")", "if", "(", "Ee", "&", "&", "A", "(", "/\\", "/>", "/", "i", ",", "o", ")", ")", "Xe", "(", "m", ",", "e", ")", ";", "else", "if", "(", "A", "(", "/", "svg", "|", "math", "/", "i", ",", "e", ".", "namespaceURI", ")", "&&", "A", "(", "x", "(", "\"<", "/(", "\"+", "f", "(", "r", "(", "je", ")", ",\"", "|\"", ")+", "\")", "\",", "\"", "i", "\"", "),", "o", ")", ")", "Xe", "(", "m", ",", "e", ")", ";", "else", "{", "Me", "&", "&(", "o", "=", "v", "(", "o", ",", "de", ",", "\"", "\"", "),", "o", "=", "v", "(", "o", ",", "fe", ",", "\"", "\"", "))", ";", "var", "b", "=", "e", ".", "nodeName", ".", "toLowerCase", "(", ");", "if", "(", "nt", "(", "b", ",", "i", ",", "o", ")", ")", "try", "{", "h", "?", "e", ".", "setAttributeNS", "(", "h", ",", "m", ",", "o", ")", ":", "e", ".", "setAttribute", "(", "m", ",", "o", ")", ",", "p", "(", "n", ".", "removed", ")", "}", "catch", "(", "e", ")", "{}", "}}", "}", "et", "(", "\"", "afterSanitizeAttributes", "\"", ",", "e", ",", "null", ")", "}}", ",", "ot", "=", "function", "e", "(", "t", ")", "{", "var", "n", "=", "void", "0", ",", "r", "=", "Je", "(", "t", ")", ";", "for", "(", "et", "(", "\"", "beforeSanitizeShadowDOM", "\"", ",", "t", ",", "null", ")", ";", "n", "=", "r", ".", "nextNode", "(", ");", ")", "et", "(", "\"", "uponSanitizeShadowNode", "\"", ",", "n", ",", "null", ")", ",", "tt", "(", "n", ")", "||", "(", "n", ".", "content", "instanceof", "c", "&", "&", "e", "(", "n", ".", "content", ")", ",", "rt", "(", "n", ")", ");", "et", "(", "\"", "afterSanitizeShadowDOM", "\"", ",", "t", ",", "null", ")", "};", "return", "n", ".", "sanitize", "=", "function", "(", "e", ",", "r", ")", "{", "var", "o", "=", "void", "0", ",", "a", "=", "void", "0", ",", "l", "=", "void", "0", ",", "s", "=", "void", "0", ",", "u", "=", "void", "0", ";", "if", "(", "e", "|", "|(", "e", "=", "\"\\", "x3c", "!", "--", "\\", "x3e", "\"", "),", "\"", "string", "\"", "!=", "typeof", "e", "&", "&!", "Ze", "(", "e", ")", "){", "if", "(", "\"", "function", "\"", "!=", "typeof", "e", ".", "toString", ")", "throw", "S", "(", "\"", "toString", "is", "not", "a", "function", "\"", ");", "if", "(", "\"", "string", "\"", "!=", "typeof", "(", "e", "=", "e", ".", "toString", "(", "))", ")", "throw", "S", "(", "\"", "dirty", "is", "not", "a", "string", ",", "aborting", "\"", ")}", "if", "(", "!", "n", ".", "isSupported", ")", "{", "if", "(", "\"", "object", "\"", "==", "=", "B", "(", "t", ".", "toStaticHTML", ")", "||", "\"", "function", "\"", "==", "typeof", "t", ".", "toStaticHTML", ")", "{", "if", "(", "\"", "string", "\"", "==", "typeof", "e", ")", "return", "t", ".", "toStaticHTML", "(", "e", ")", ";", "if", "(", "Ze", "(", "e", ")", ")", "return", "t", ".", "toStaticHTML", "(", "e", ".", "outerHTML", ")", "}", "return", "e", "}", "if", "(", "Ne", "|", "|", "Ve", "(", "r", ")", ",", "n", ".", "removed", "=", "[]", ",\"", "string", "\"", "==", "typeof", "e", "&", "&(", "Ie", "=", "!", "1", ")", ",", "Ie", ")", ";", "else", "if", "(", "e", "instanceof", "k", ")", "1", "=", "==", "(", "a", "=", "(", "o", "=", "$", "e", "(", "\"\\", "x3c", "!", "--", "\\", "x3e", "\"", "))", ".", "ownerDocument", ".", "importNode", "(", "e", ",", "!", "0", ")", ").", "nodeType", "&", "&\"", "BODY", "\"", "==", "=", "a", ".", "nodeName", "|", "|\"", "HTML", "\"", "==", "=", "a", ".", "nodeName", "?", "o", "=", "a", ":", "o", ".", "appendChild", "(", "a", ")", ";", "else", "{", "if", "(", "!", "Re", "&", "&!", "Me", "&", "&!", "De", "&", "&-", "1", "=", "==", "e", ".", "indexOf", "(", "\"<", "\")", ")", "return", "te", "&", "&", "He", "?", "te", ".", "createHTML", "(", "e", ")", ":", "e", ";", "if", "(", "!(", "o", "=", "$", "e", "(", "e", ")", "))", "return", "Re", "?", "null", ":", "ne", "}", "o", "&", "&", "Oe", "&", "&", "Ye", "(", "o", ".", "firstChild", ")", ";", "for", "(", "var", "d", "=", "Je", "(", "Ie", "?", "e", ":", "o", ")", ";", "l", "=", "d", ".", "nextNode", "(", ");", ")", "3", "=", "==", "l", ".", "nodeType", "&", "&", "l", "=", "==", "s", "|", "|", "tt", "(", "l", ")", "||", "(", "l", ".", "content", "instanceof", "c", "&", "&", "ot", "(", "l", ".", "content", ")", ",", "rt", "(", "l", ")", ",", "s", "=", "l", ")", ";", "if", "(", "s", "=", "null", ",", "Ie", ")", "return", "e", ";", "if", "(", "Re", ")", "{", "if", "(", "we", ")", "for", "(", "u", "=", "le", ".", "call", "(", "o", ".", "ownerDocument", ")", ";", "o", ".", "firstChild", ";", ")", "u", ".", "appendChild", "(", "o", ".", "firstChild", ")", ";", "else", "u", "=", "o", ";", "return", "Fe", "&", "&(", "u", "=", "ce", ".", "call", "(", "i", ",", "u", ",", "!", "0", ")", "),", "u", "}", "var", "f", "=", "De", "?", "o", ".", "outerHTML", ":", "o", ".", "innerHTML", ";", "return", "Me", "&", "&(", "f", "=", "v", "(", "f", ",", "de", ",", "\"", "\"", "),", "f", "=", "v", "(", "f", ",", "fe", ",", "\"", "\"", "))", ",", "te", "&", "&", "He", "?", "te", ".", "createHTML", "(", "f", ")", ":", "f", "}", ",", "n", ".", "setConfig", "=", "function", "(", "e", ")", "{", "Ve", "(", "e", ")", ",", "Ne", "=", "!", "0", "}", ",", "n", ".", "clearConfig", "=", "function", "(", "){", "qe", "=", "null", ",", "Ne", "=", "!", "1", "}", ",", "n", ".", "isValidAttribute", "=", "function", "(", "e", ",", "t", ",", "n", ")", "{", "qe", "|", "|", "Ve", "(", "{}", ");", "var", "r", "=", "g", "(", "e", ")", ",", "o", "=", "g", "(", "t", ")", ";", "return", "nt", "(", "r", ",", "o", ",", "n", ")", "},", "n", ".", "addHook", "=", "function", "(", "e", ",", "t", ")", "{\"", "function", "\"", "==", "typeof", "t", "&", "&(", "ue", "[", "e", "]", "=", "ue", "[", "e", "]", "||", "[]", ",", "m", "(", "ue", "[", "e", "]", ",", "t", ")", ")}", ",", "n", ".", "removeHook", "=", "function", "(", "e", ")", "{", "ue", "[", "e", "]", "&&", "p", "(", "ue", "[", "e", "]", ")}", ",", "n", ".", "removeHooks", "=", "function", "(", "e", ")", "{", "ue", "[", "e", "]", "&&", "(", "ue", "[", "e", "]", "=[", "])", "},", "n", ".", "removeAllHooks", "=", "function", "(", "){", "ue", "=", "{}", "},", "n", "}", "()", "})", ");", "currentNode", ".", "querySelectorAll", "(", "'", "p", ",", "br", ",", "form", "'", ").", "length", "!", "==", "0", "\"", "title", "\"", ":", "\"", "Tests", "against", "nesting", "-", "based", "mXSS", "behavior", "1", "/", "1", "\"", ","], "docstring_tokens": ["steal", "the", "victim's", "cookie-based", "authentication", "credentials"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "!", "IS_ERR", "(", "vma", ")", ")", "vma_stop", "(", "priv", ",", "vma", ")", ";</s>vma_stop", "(", "priv", ",", "vma", ")", ";"], "docstring_tokens": ["the", "kernel", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["private", "void", "closeIdleStreams", "(", "int", "newMaxActiveRemoteStreamId", ")", "{", "for", "(", "Entry", "<", "Integer", ",", "Stream", ">", "entry", ":", "streams", ".", "entrySet", "(", "))", "{", "if", "(", "entry", ".", "getKey", "(", ").", "intValue", "(", ")", ">", "maxActiveRemoteStreamId", "&", "&", "entry", ".", "getKey", "(", ").", "intValue", "(", ")", "<", "newMaxActiveRemoteStreamId", ")", "{", "entry", ".", "getValue", "(", ").", "closeIfIdle", "(", ");", "doTestImplicitClose", "(", "5", ")", ";", "}", "/", "/", "https", ":", "//", "bz", ".", "apache", ".", "org", "/", "bugzilla", "/", "show_bug", ".", "cgi", "?", "id", "=", "64467", "@", "Test", "public", "void", "testImplicitCloseLargeId", "(", ")", "throws", "Exception", "{", "doTestImplicitClose", "(", "Integer", ".", "MAX_VALUE", "-", "8", ")", ";", "}", "private", "void", "doTestImplicitClose", "(", "int", "lastStreamId", ")", "throws", "Exception", "{", "long", "startFirst", "=", "System", ".", "nanoTime", "(", ");", "long", "durationFirst", "=", "System", ".", "nanoTime", "(", ")", "-", "startFirst", ";", "sendPriority", "(", "lastStreamId", ",", "0", ",", "16", ")", ";", "long", "startSecond", "=", "System", ".", "nanoTime", "(", ");", "sendSimpleGetRequest", "(", "lastStreamId", ")", ";", "long", "durationSecond", "=", "System", ".", "nanoTime", "(", ")", "-", "startSecond", ";", "Assert", ".", "assertEquals", "(", "getSimpleResponseTrace", "(", "lastStreamId", ")", ",", "output", ".", "getTrace", "(", "))", ";", "/", "/", "Allow", "second", "request", "to", "take", "up", "to", "5", "times", "first", "request", "or", "up", "to", "1", "second", "-", "whichever", "is", "the", "larger", "-", "mainly", "/", "/", "to", "allow", "for", "CI", "systems", "under", "load", "that", "can", "exhibit", "significant", "timing", "variation", ".", "Assert", ".", "assertTrue", "(", "\"", "First", "request", "took", "[", "\"", "+", "durationFirst", "/", "1000000", "+", "\"", "ms", "]", ",", "second", "request", "took", "[", "\"", "durationSecond", "/", "1000000", "+", "\"", "ms", "]", "\",", "durationSecond", "<", "1000000000", "|", "|", "durationSecond", "<", "durationFirst", "*", "3", ")", ";", "handleGoAwayResponse", "(", "lastStreamId", ")", ";", "<", "fix", ">", "<", "bug", ">", "64467", "<", "/", "bug", ">", ":", "Improve", "performance", "of", "closing", "idle", "HTTP", "/", "2", "streams", ".", "(", "markt", ")", "<", "/", "fix", "></s>private", "void", "closeIdleStreams", "(", "int", "newMaxActiveRemoteStreamId", ")", "throws", "Http2Exception", "{", "for", "(", "int", "i", "=", "maxActiveRemoteStreamId", "+", "2", ";", "i", "<", "newMaxActiveRemoteStreamId", ";", "i", "+", "=", "2", ")", "{", "Stream", "stream", "=", "getStream", "(", "i", ",", "false", ")", ";", "if", "(", "stream", "!", "=", "null", ")", "{", "stream", ".", "closeIfIdle", "(", ");", "sendPriority", "(", "5", ",", "0", ",", "16", ")", ";", "sendSimpleGetRequest", "(", "5", ")", ";", "Assert", ".", "assertEquals", "(", "getSimpleResponseTrace", "(", "5", ")", ",", "output", ".", "getTrace", "(", "))", ";", "handleGoAwayResponse", "(", "5", ")", ";"], "docstring_tokens": ["trigger", "high", "CPU\\r\\nusage", "for", "several", "seconds"]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "kohsuke", ".", "stapler", ".", "verb", ".", "POST", ";", "@", "POST", "if", "(", "project", "=", "=", "null", ")", "{", "Jenkins", ".", "get", "(", ").", "checkPermission", "(", "Jenkins", ".", "ADMINISTER", ")", ";", "}", "else", "{", "project", ".", "checkPermission", "(", "Item", ".", "CONFIGURE", ")", ";", "}</s>"], "docstring_tokens": ["initiate", "a", "connection", "test", "to", "an", "attacker-specified", "server"]}
{"contents": ["empty"], "code_tokens": ["-", "-", "TEST", "-", "-", "Bug", "#", "71587", "(", "Use", "-", "After", "-", "Free", "/", "Double", "-", "Free", "in", "WDDX", "Deserialize", ")", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "\"", "wddx", "\"", "))", "print", "\"", "skip", "\"", ";", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "xml", "=", "<", "<<", "EOF", "<", "?", "xml", "version", "=", "'", "1", ".", "0", "'", "?", ">", "<", "!", "DOCTYPE", "wddxPacket", "SYSTEM", "'", "wddx_0100", ".", "dtd", "'", ">", "<", "wddxPacket", "version", "=", "'", "1", ".", "0", "'", ">", "<", "array", ">", "<", "var", "name", "=", "'", "ML", "'", "><", "/", "var", ">", "<", "string", ">", "manhluat", "<", "/", "string", ">", "<", "var", "name", "=", "'", "ML2", "'", "><", "/", "var", ">", "<", "boolean", "value", "=", "'", "a", "'", "/>", "<", "boolean", "value", "=", "'", "true", "'", "/>", "<", "/", "array", ">", "<", "/", "wddxPacket", ">", "EOF", ";", "$", "wddx", "=", "wddx_deserialize", "(", "$", "xml", ")", ";", "var_dump", "(", "$", "wddx", ")", ";", "/", "/", "Print", "mem", "leak", "foreach", "(", "$", "wddx", "as", "$", "k", "=", ">$", "v", ")", "printf", "(", "\"", "Key", ":", "%", "s", "\\", "nValue", ":", "%", "s", "\\", "n", "\"", ",", "bin2hex", "(", "$", "k", ")", ",", "bin2hex", "(", "$", "v", ")", ");", "?", ">", "DONE", "-", "-", "EXPECTF", "-", "-", "array", "(", "2", ")", "{", "[", "0", "]", "=>", "string", "(", "8", ")", "\"", "manhluat", "\"", "[", "1", "]", "=>", "bool", "(", "true", ")", "}", "Key", ":", "30", "Value", ":", "6d616e686c756174", "Key", ":", "31", "Value", ":", "31", "DONE", "@", "@", "-", "936", ",", "6", "+", "936", ",", "16", "@", "@", "static", "void", "php_wddx_pop_element", "(", "void", "*", "user_data", ",", "const", "XML_Char", "*", "name", ")", "if", "(", "!", "ent1", "-", ">", "data", ")", "{", "if", "(", "stack", "-", ">", "top", ">", "1", ")", "{", "stack", "-", ">", "top", "-", "-;", "}", "else", "{", "stack", "-", ">", "done", "=", "1", ";", "}", "efree", "(", "ent1", ")", ";", "return", ";", "}", "stack", "-", ">", "varname", "=", "NULL", ";", "switch", "(", "ent", "-", ">", "type", ")", "{", "if", "(", "ent", "-", ">", "varname", ")", "{", "}", "ent", "-", ">", "data", "=", "NULL", ";</s>switch", "(", "Z_TYPE_P", "(", "ent", ")", ")", "{", "stack", "-", ">", "top", "-", "-;", "if", "(", "ent", "-", ">", "varname", ")", "efree", "(", "ent", ")", ";"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(memory", "corruption", "and", "application", "crash", ")", "or", "possibly", "have", "unspecified", "other", "impact"]}
{"contents": ["empty"], "code_tokens": ["union", "acpi_operand_object", "*", "prev", ";", "union", "acpi_operand_object", "*", "next", ";", "/", "*", "Delete", "any", "module", "-", "level", "code", "blocks", "*", "/", "next", "=", "acpi_gbl_module_code_list", ";", "while", "(", "next", ")", "{", "prev", "=", "next", ";", "next", "=", "next", "-", ">", "method", ".", "mutex", ";", "prev", "-", ">", "method", ".", "mutex", "=", "NULL", ";", "/", "*", "Clear", "the", "Mutex", "(", "cheated", ")", "field", "*", "/", "acpi_ut_remove_reference", "(", "prev", ")", ";</s>#", "ifdef", "ACPI_EXEC_APP", "{", "union", "acpi_operand_object", "*", "prev", ";", "union", "acpi_operand_object", "*", "next", ";", "/", "*", "Delete", "any", "module", "-", "level", "code", "blocks", "*", "/", "next", "=", "acpi_gbl_module_code_list", ";", "while", "(", "next", ")", "{", "prev", "=", "next", ";", "next", "=", "next", "-", ">", "method", ".", "mutex", ";", "prev", "-", ">", "method", ".", "mutex", "=", "NULL", ";", "/", "*", "Clear", "the", "Mutex", "(", "cheated", ")", "field", "*", "/", "acpi_ut_remove_reference", "(", "prev", ")", ";", "}", "#", "endif"], "docstring_tokens": ["obtain", "sensitive", "information", "from", "kernel", "memory", "and", "bypass", "the", "KASLR", "protection", "mechanism"]}
{"contents": ["empty"], "code_tokens": ["#", "include", "<", "linux", "/", "crypto", ".", "h", ">", "struct", "crypto_cipher", "*", "tfm_des", ";", "tfm_des", "=", "crypto_alloc_cipher", "(", "\"", "des", "\"", ",", "0", ",", "0", ")", ";", "return", "PTR_ERR", "(", "tfm_des", ")", ";", "crypto_cipher_setkey", "(", "tfm_des", ",", "key2", ",", "8", ")", ";", "crypto_cipher_encrypt_one", "(", "tfm_des", ",", "out", ",", "in", ")", ";", "crypto_free_cipher", "(", "tfm_des", ")", ";", "return", "0", ";</s>#", "include", "<", "crypto", "/", "skcipher", ".", "h", ">", "int", "rc", ";", "struct", "crypto_skcipher", "*", "tfm_des", ";", "struct", "scatterlist", "sgin", ",", "sgout", ";", "struct", "skcipher_request", "*", "req", ";", "tfm_des", "=", "crypto_alloc_skcipher", "(", "\"", "ecb", "(", "des", ")", "\",", "0", ",", "CRYPTO_ALG_ASYNC", ")", ";", "rc", "=", "PTR_ERR", "(", "tfm_des", ")", ";", "cifs_dbg", "(", "VFS", ",", "\"", "could", "not", "allocate", "des", "crypto", "API", "\\", "n", "\"", ");", "goto", "smbhash_err", ";", "}", "req", "=", "skcipher_request_alloc", "(", "tfm_des", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "req", ")", "{", "rc", "=", "-", "ENOMEM", ";", "goto", "smbhash_free_skcipher", ";", "crypto_skcipher_setkey", "(", "tfm_des", ",", "key2", ",", "8", ")", ";", "sg_init_one", "(", "&", "sgin", ",", "in", ",", "8", ")", ";", "sg_init_one", "(", "&", "sgout", ",", "out", ",", "8", ")", ";", "skcipher_request_set_callback", "(", "req", ",", "0", ",", "NULL", ",", "NULL", ")", ";", "skcipher_request_set_crypt", "(", "req", ",", "&", "sgin", ",", "&", "sgout", ",", "8", ",", "NULL", ")", ";", "rc", "=", "crypto_skcipher_encrypt", "(", "req", ")", ";", "if", "(", "rc", ")", "cifs_dbg", "(", "VFS", ",", "\"", "could", "not", "encrypt", "crypt", "key", "rc", ":", "%", "d", "\\", "n", "\"", ",", "rc", ")", ";", "skcipher_request_free", "(", "req", ")", ";", "smbhash_free_skcipher", ":", "crypto_free_skcipher", "(", "tfm_des", ")", ";", "smbhash_err", ":", "return", "rc", ";"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(system", "crash", "or", "memory", "corruption", ")", "or", "possibly", "have", "unspecified", "other", "impact"]}
{"contents": ["empty"], "code_tokens": ["void", "__oom_reap_task_mm", "(", "struct", "mm_struct", "*", "mm", ")", ";", "if", "(", "unlikely", "(", "mm_is_oom_victim", "(", "mm", ")", "))", "{", "/", "*", "*", "Manually", "reap", "the", "mm", "to", "free", "as", "much", "memory", "as", "possible", ".", "*", "Then", ",", "as", "the", "oom", "reaper", "does", ",", "set", "MMF_OOM_SKIP", "to", "disregard", "*", "this", "mm", "from", "further", "consideration", ".", "Taking", "mm", "-", ">", "mmap_sem", "for", "*", "write", "after", "setting", "MMF_OOM_SKIP", "will", "guarantee", "that", "the", "oom", "*", "reaper", "will", "not", "run", "on", "this", "mm", "again", "after", "mmap_sem", "is", "*", "dropped", ".", "*", "*", "Nothing", "can", "be", "holding", "mm", "-", ">", "mmap_sem", "here", "and", "the", "above", "call", "*", "to", "mmu_notifier_release", "(", "mm", ")", "ensures", "mmu", "notifier", "callbacks", "in", "*", "__oom_reap_task_mm", "(", ")", "will", "not", "block", ".", "*", "*", "This", "needs", "to", "be", "done", "before", "calling", "munlock_vma_pages_all", "(", "),", "*", "which", "clears", "VM_LOCKED", ",", "otherwise", "the", "oom", "reaper", "cannot", "*", "reliably", "test", "it", ".", "*", "/", "mutex_lock", "(", "&", "oom_lock", ")", ";", "__oom_reap_task_mm", "(", "mm", ")", ";", "mutex_unlock", "(", "&", "oom_lock", ")", ";", "set_bit", "(", "MMF_OOM_SKIP", ",", "&", "mm", "-", ">", "flags", ")", ";", "down_write", "(", "&", "mm", "-", ">", "mmap_sem", ")", ";", "up_write", "(", "&", "mm", "-", ">", "mmap_sem", ")", ";", "}", "void", "__oom_reap_task_mm", "(", "struct", "mm_struct", "*", "mm", ")", "/", "*", "*", "Tell", "all", "users", "of", "get_user", "/", "copy_from_user", "etc", ".", "..", "that", "the", "content", "*", "is", "no", "longer", "stable", ".", "No", "barriers", "really", "needed", "because", "unmapping", "*", "should", "imply", "barriers", "already", "and", "the", "reader", "would", "hit", "a", "page", "fault", "*", "if", "it", "stumbled", "over", "a", "reaped", "memory", ".", "*", "/", "set_bit", "(", "MMF_UNSTABLE", ",", "&", "mm", "-", ">", "flags", ")", ";", "for", "(", "vma", "=", "mm", "-", ">", "mmap", ";", "vma", ";", "vma", "=", "vma", "-", ">", "vm_next", ")", "{", "if", "(", "!", "can_madv_dontneed_vma", "(", "vma", ")", ")", "continue", ";", "/", "*", "*", "Only", "anonymous", "pages", "have", "a", "good", "chance", "to", "be", "dropped", "*", "without", "additional", "steps", "which", "we", "cannot", "afford", "as", "we", "*", "are", "OOM", "already", ".", "*", "*", "We", "do", "not", "even", "care", "about", "fs", "backed", "pages", "because", "all", "*", "which", "are", "reclaimable", "have", "already", "been", "reclaimed", "and", "*", "we", "do", "not", "want", "to", "block", "exit_mmap", "by", "keeping", "mm", "ref", "*", "count", "elevated", "without", "a", "good", "reason", ".", "*", "/", "if", "(", "vma_is_anonymous", "(", "vma", ")", "|", "|", "!", "(", "vma", "-", ">", "vm_flags", "&", "VM_SHARED", ")", ")", "{", "const", "unsigned", "long", "start", "=", "vma", "-", ">", "vm_start", ";", "const", "unsigned", "long", "end", "=", "vma", "-", ">", "vm_end", ";", "struct", "mmu_gather", "tlb", ";", "tlb_gather_mmu", "(", "&", "tlb", ",", "mm", ",", "start", ",", "end", ")", ";", "mmu_notifier_invalidate_range_start", "(", "mm", ",", "start", ",", "end", ")", ";", "unmap_page_range", "(", "&", "tlb", ",", "vma", ",", "start", ",", "end", ",", "NULL", ")", ";", "mmu_notifier_invalidate_range_end", "(", "mm", ",", "start", ",", "end", ")", ";", "tlb_finish_mmu", "(", "&", "tlb", ",", "start", ",", "end", ")", ";", "}", "}", "}", "static", "bool", "oom_reap_task_mm", "(", "struct", "task_struct", "*", "tsk", ",", "struct", "mm_struct", "*", "mm", ")", "{", "*", "oom_reap_task_mm", "exit_mm", "__oom_reap_task_mm", "(", "mm", ")", ";", "while", "(", "attempts", "+", "+", "<", "MAX_OOM_REAP_RETRIES", "&", "&", "!", "oom_reap_task_mm", "(", "tsk", ",", "mm", ")", ")</s>if", "(", "unlikely", "(", "mm_is_oom_victim", "(", "mm", ")", "))", "{", "/", "*", "*", "Wait", "for", "oom_reap_task", "(", ")", "to", "stop", "working", "on", "this", "*", "mm", ".", "Because", "MMF_OOM_SKIP", "is", "already", "set", "before", "*", "calling", "down_read", "(", "),", "oom_reap_task", "(", ")", "will", "not", "run", "*", "on", "this", "\"", "mm", "\"", "post", "up_write", "(", ").", "*", "*", "mm_is_oom_victim", "(", ")", "cannot", "be", "set", "from", "under", "us", "*", "either", "because", "victim", "-", ">", "mm", "is", "already", "set", "to", "NULL", "*", "under", "task_lock", "before", "calling", "mmput", "and", "oom_mm", "is", "*", "set", "not", "NULL", "by", "the", "OOM", "killer", "only", "if", "victim", "-", ">", "mm", "*", "is", "found", "not", "NULL", "while", "holding", "the", "task_lock", ".", "*", "/", "set_bit", "(", "MMF_OOM_SKIP", ",", "&", "mm", "-", ">", "flags", ")", ";", "down_write", "(", "&", "mm", "-", ">", "mmap_sem", ")", ";", "up_write", "(", "&", "mm", "-", ">", "mmap_sem", ")", ";", "}", "static", "bool", "__oom_reap_task_mm", "(", "struct", "task_struct", "*", "tsk", ",", "struct", "mm_struct", "*", "mm", ")", "struct", "mmu_gather", "tlb", ";", "*", "__oom_reap_task_mm", "exit_mm", "/", "*", "*", "Tell", "all", "users", "of", "get_user", "/", "copy_from_user", "etc", ".", "..", "that", "the", "content", "*", "is", "no", "longer", "stable", ".", "No", "barriers", "really", "needed", "because", "unmapping", "*", "should", "imply", "barriers", "already", "and", "the", "reader", "would", "hit", "a", "page", "fault", "*", "if", "it", "stumbled", "over", "a", "reaped", "memory", ".", "*", "/", "set_bit", "(", "MMF_UNSTABLE", ",", "&", "mm", "-", ">", "flags", ")", ";", "for", "(", "vma", "=", "mm", "-", ">", "mmap", ";", "vma", ";", "vma", "=", "vma", "-", ">", "vm_next", ")", "{", "if", "(", "!", "can_madv_dontneed_vma", "(", "vma", ")", ")", "continue", ";", "/", "*", "*", "Only", "anonymous", "pages", "have", "a", "good", "chance", "to", "be", "dropped", "*", "without", "additional", "steps", "which", "we", "cannot", "afford", "as", "we", "*", "are", "OOM", "already", ".", "*", "*", "We", "do", "not", "even", "care", "about", "fs", "backed", "pages", "because", "all", "*", "which", "are", "reclaimable", "have", "already", "been", "reclaimed", "and", "*", "we", "do", "not", "want", "to", "block", "exit_mmap", "by", "keeping", "mm", "ref", "*", "count", "elevated", "without", "a", "good", "reason", ".", "*", "/", "if", "(", "vma_is_anonymous", "(", "vma", ")", "|", "|", "!", "(", "vma", "-", ">", "vm_flags", "&", "VM_SHARED", ")", ")", "{", "const", "unsigned", "long", "start", "=", "vma", "-", ">", "vm_start", ";", "const", "unsigned", "long", "end", "=", "vma", "-", ">", "vm_end", ";", "tlb_gather_mmu", "(", "&", "tlb", ",", "mm", ",", "start", ",", "end", ")", ";", "mmu_notifier_invalidate_range_start", "(", "mm", ",", "start", ",", "end", ")", ";", "unmap_page_range", "(", "&", "tlb", ",", "vma", ",", "start", ",", "end", ",", "NULL", ")", ";", "mmu_notifier_invalidate_range_end", "(", "mm", ",", "start", ",", "end", ")", ";", "tlb_finish_mmu", "(", "&", "tlb", ",", "start", ",", "end", ")", ";", "}", "}", "while", "(", "attempts", "+", "+", "<", "MAX_OOM_REAP_RETRIES", "&", "&", "!", "__oom_reap_task_mm", "(", "tsk", ",", "mm", ")", ")"], "docstring_tokens": ["a", "bad", "memory", "access", "or", "a", "NULL", "pointer", "dereference", "due", "to", "concurrent", "memory", "unmapping"]}
{"contents": ["empty"], "code_tokens": ["import", "javax", ".", "servlet", ".", "http", ".", "HttpServletResponse", ";", "boolean", "contentLengthSet", "=", "false", ";", "long", "cl", "=", "vMB", ".", "getLong", "(", ");", "if", "(", "contentLengthSet", ")", "{", "response", ".", "setStatus", "(", "HttpServletResponse", ".", "SC_BAD_REQUEST", ")", ";", "error", "=", "true", ";", "}", "else", "{", "contentLengthSet", "=", "true", ";", "/", "/", "Set", "the", "content", "-", "length", "header", "for", "the", "request", "request", ".", "setContentLength", "(", "cl", ")", ";", "}", "if", "(", "contentLength", ">", "=", "0", ")", "{", "if", "(", "contentDelimitation", ")", "{", "/", "/", "contentDelimitation", "being", "true", "at", "this", "point", "indicates", "that", "/", "/", "chunked", "encoding", "is", "being", "used", "but", "chunked", "encoding", "should", "/", "/", "not", "be", "used", "with", "a", "content", "length", ".", "RFC", "2616", ",", "section", "4", ".", "4", ",", "/", "/", "bullet", "3", "states", "Content", "-", "Length", "must", "be", "ignored", "in", "this", "case", "-", "/", "/", "so", "remove", "it", ".", "headers", ".", "removeHeader", "(", "\"", "content", "-", "length", "\"", ");", "request", ".", "setContentLength", "(", "-", "1", ")", ";", "}", "else", "{", "getInputBuffer", "(", ").", "addActiveFilter", "(", "inputFilters", "[", "Constants", ".", "IDENTITY_FILTER", "]", ");", "contentDelimitation", "=", "true", ";", "}", "@", "Test", "public", "void", "testPost", "(", ")", "throws", "Exception", "{", "doTestPost", "(", "false", ",", "HttpServletResponse", ".", "SC_OK", ")", ";", "}", "public", "void", "testPostMultipleContentLength", "(", ")", "throws", "Exception", "{", "/", "/", "Multiple", "content", "lengths", "doTestPost", "(", "true", ",", "HttpServletResponse", ".", "SC_BAD_REQUEST", ")", ";", "}", "public", "void", "doTestPost", "(", "boolean", "multipleCL", ",", "int", "expectedStatus", ")", "throws", "Exception", "{", "if", "(", "multipleCL", ")", "{", "forwardMessage", ".", "addHeader", "(", "0xA008", ",", "\"", "99", "\"", ");", "}", "validateResponseHeaders", "(", "responseHeaders", ",", "expectedStatus", ")", ";", "if", "(", "expectedStatus", "=", "=", "HttpServletResponse", ".", "SC_OK", ")", "{", "/", "/", "Expect", "3", "messages", ":", "headers", ",", "body", ",", "end", "for", "a", "valid", "request", "TesterAjpMessage", "responseBody", "=", "ajpClient", ".", "readMessage", "(", ");", "validateResponseBody", "(", "responseBody", ",", "\"", "test", "-", "data", "\"", ");", "validateResponseEnd", "(", "ajpClient", ".", "readMessage", "(", "),", "true", ")", ";", "/", "/", "Double", "check", "the", "connection", "is", "still", "open", "validateCpong", "(", "ajpClient", ".", "cping", "(", "))", ";", "}", "else", "{", "/", "/", "Expect", "2", "messages", ":", "headers", ",", "end", "for", "an", "invalid", "request", "validateResponseEnd", "(", "ajpClient", ".", "readMessage", "(", "),", "false", ")", ";", "}", "@", "Test", "public", "void", "testWithTEChunked", "(", ")", "throws", "Exception", "{", "doTestWithTEChunked", "(", "false", ")", ";", "}", "@", "Test", "public", "void", "testWithTEChunkedWithCL", "(", ")", "throws", "Exception", "{", "/", "/", "Should", "be", "ignored", "doTestWithTEChunked", "(", "true", ")", ";", "}", "private", "void", "doTestWithTEChunked", "(", "boolean", "withCL", ")", "throws", "Exception", "{", "Tomcat", "tomcat", "=", "getTomcatInstance", "(", ");", "/", "/", "Use", "the", "normal", "Tomcat", "ROOT", "context", "File", "root", "=", "new", "File", "(", "\"", "test", "/", "webapp", "-", "3", ".", "0", "\"", ");", "tomcat", ".", "addWebapp", "(", "\"\"", ",", "root", ".", "getAbsolutePath", "(", "))", ";", "tomcat", ".", "start", "(", ");", "String", "request", "=", "\"", "POST", "/", "echo", "-", "params", ".", "jsp", "HTTP", "/", "1", ".", "1", "\"", "+", "SimpleHttpClient", ".", "CRLF", "\"", "Host", ":", "any", "\"", "+", "SimpleHttpClient", ".", "CRLF", "(", "withCL", "?", "\"", "Content", "-", "length", ":", "1", "\"", "+", "SimpleHttpClient", ".", "CRLF", ":", "\"", "\")", "\"", "Transfer", "-", "encoding", ":", "chunked", "\"", "+", "SimpleHttpClient", ".", "CRLF", "\"", "Content", "-", "Type", ":", "application", "/", "x", "-", "www", "-", "form", "-", "urlencoded", "\"", "SimpleHttpClient", ".", "CRLF", "\"", "Connection", ":", "close", "\"", "+", "SimpleHttpClient", ".", "CRLF", "SimpleHttpClient", ".", "CRLF", "\"", "9", "\"", "+", "SimpleHttpClient", ".", "CRLF", "\"", "test", "=", "data", "\"", "+", "SimpleHttpClient", ".", "CRLF", "\"", "0", "\"", "+", "SimpleHttpClient", ".", "CRLF", "SimpleHttpClient", ".", "CRLF", ";", "Client", "client", "=", "new", "Client", "(", "tomcat", ".", "getConnector", "(", ").", "getLocalPort", "(", "))", ";", "client", ".", "setRequest", "(", "new", "String", "[", "]", "{", "request", "}", ");", "client", ".", "connect", "(", ");", "client", ".", "processRequest", "(", ");", "assertTrue", "(", "client", ".", "isResponse200", "(", "))", ";", "assertTrue", "(", "client", ".", "getResponseBody", "(", ").", "contains", "(", "\"", "test", "-", "data", "\"", "))", ";", "}</s>/", "/", "just", "read", "the", "content", "-", "length", "header", ",", "so", "set", "it", "request", ".", "setContentLength", "(", "vMB", ".", "getLong", "(", "))", ";", "if", "(", "contentLength", ">", "=", "0", "&", "&", "!", "contentDelimitation", ")", "{", "getInputBuffer", "(", ").", "addActiveFilter", "(", "inputFilters", "[", "Constants", ".", "IDENTITY_FILTER", "]", ");", "contentDelimitation", "=", "true", ";", "public", "void", "testSimplePost", "(", ")", "throws", "Exception", "{", "/", "/", "Expect", "3", "messages", ":", "headers", ",", "body", ",", "end", "validateResponseHeaders", "(", "responseHeaders", ",", "200", ")", ";", "/", "/", "Skip", "the", "body", "TesterAjpMessage", "responseBody", "=", "ajpClient", ".", "readMessage", "(", ");", "validateResponseBody", "(", "responseBody", ",", "\"", "test", "-", "data", "\"", ");", "validateResponseEnd", "(", "ajpClient", ".", "readMessage", "(", "),", "true", ")", ";", "/", "/", "Double", "check", "the", "connection", "is", "still", "open", "validateCpong", "(", "ajpClient", ".", "cping", "(", "))", ";"], "docstring_tokens": ["trigger", "incorrect", "identification", "of", "a", "request's", "length", "and", "conduct", "request-smuggling", "attacks"]}
{"contents": ["empty"], "code_tokens": ["static", "inline", "void", "init_idle_pids", "(", "struct", "pid_link", "*", "links", ")", "{", "enum", "pid_type", "type", ";", "for", "(", "type", "=", "PIDTYPE_PID", ";", "type", "<", "PIDTYPE_MAX", ";", "+", "+", "type", ")", "{", "INIT_HLIST_NODE", "(", "&", "links", "[", "type", "]", ".", "node", ")", ";", "/", "*", "not", "really", "needed", "*", "/", "links", "[", "type", "]", ".", "pid", "=", "&", "init_struct_pid", ";", "}", "}", "if", "(", "!", "IS_ERR", "(", "task", ")", ")", "{", "init_idle_pids", "(", "task", "-", ">", "pids", ")", ";", "}</s>if", "(", "!", "IS_ERR", "(", "task", ")", ")"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(system", "crash", ")"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "unlikely", "(", "len", "+", "ring", "-", ">", "frameoffset", ">", "ring", "-", ">", "rx_buffersize", ")", ")", "{", "#", "define", "B43_DMA0_RX_BUFFERSIZE", "(", "B43_DMA0_RX_FRAMEOFFSET", "+", "IEEE80211_MAX_FRAME_LEN", ")</s>if", "(", "unlikely", "(", "len", ">", "ring", "-", ">", "rx_buffersize", ")", ")", "{", "#", "define", "B43_DMA0_RX_BUFFERSIZE", "IEEE80211_MAX_FRAME_LEN"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(system", "crash", ")"]}
{"contents": ["empty"], "code_tokens": ["auth_chunks", "-", ">", "param_hdr", ".", "length", "=", "htons", "(", "sizeof", "(", "sctp_paramhdr_t", ")", ");", "auth_chunks", "-", ">", "param_hdr", ".", "length", "+", "=", "htons", "(", "2", ")", ";", "if", "(", "!", "sctp_auth_enable", ")", "return", "-", "EACCES", ";", "if", "(", "!", "sctp_auth_enable", ")", "return", "-", "EACCES", ";", "if", "(", "!", "sctp_auth_enable", ")", "return", "-", "EACCES", ";", "if", "(", "!", "sctp_auth_enable", ")", "return", "-", "EACCES", ";", "if", "(", "!", "sctp_auth_enable", ")", "return", "-", "EACCES", ";", "struct", "sctp_hmacalgo", "__user", "*", "p", "=", "(", "void", "__user", "*", ")", "optval", ";", "__u16", "data_len", "=", "0", ";", "u32", "num_idents", ";", "if", "(", "!", "sctp_auth_enable", ")", "return", "-", "EACCES", ";", "data_len", "=", "ntohs", "(", "hmacs", "-", ">", "param_hdr", ".", "length", ")", "-", "sizeof", "(", "sctp_paramhdr_t", ")", ";", "if", "(", "len", "<", "sizeof", "(", "struct", "sctp_hmacalgo", ")", "+", "data_len", ")", "len", "=", "sizeof", "(", "struct", "sctp_hmacalgo", ")", "+", "data_len", ";", "num_idents", "=", "data_len", "/", "sizeof", "(", "u16", ")", ";", "if", "(", "put_user", "(", "num_idents", ",", "&", "p", "-", ">", "shmac_num_idents", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "copy_to_user", "(", "p", "-", ">", "shmac_idents", ",", "hmacs", "-", ">", "hmac_ids", ",", "data_len", ")", ")", "if", "(", "!", "sctp_auth_enable", ")", "return", "-", "EACCES", ";", "len", "=", "sizeof", "(", "struct", "sctp_authkeyid", ")", ";", "if", "(", "put_user", "(", "len", ",", "optlen", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "copy_to_user", "(", "optval", ",", "&", "val", ",", "len", ")", ")", "return", "-", "EFAULT", ";", "u32", "num_chunks", "=", "0", ";", "if", "(", "!", "sctp_auth_enable", ")", "return", "-", "EACCES", ";", "if", "(", "len", "<", "sizeof", "(", "struct", "sctp_authchunks", ")", ")", "if", "(", "copy_from_user", "(", "&", "val", ",", "optval", ",", "sizeof", "(", "struct", "sctp_authchunks", ")", "))", "if", "(", "!", "ch", ")", "goto", "num", ";", "if", "(", "copy_to_user", "(", "to", ",", "ch", "-", ">", "chunks", ",", "num_chunks", ")", ")", "num", ":", "len", "=", "sizeof", "(", "struct", "sctp_authchunks", ")", "+", "num_chunks", ";", "if", "(", "put_user", "(", "len", ",", "optlen", ")", ")", "return", "-", "EFAULT", ";", "u32", "num_chunks", "=", "0", ";", "if", "(", "!", "sctp_auth_enable", ")", "return", "-", "EACCES", ";", "if", "(", "len", "<", "sizeof", "(", "struct", "sctp_authchunks", ")", ")", "if", "(", "copy_from_user", "(", "&", "val", ",", "optval", ",", "sizeof", "(", "struct", "sctp_authchunks", ")", "))", "if", "(", "!", "ch", ")", "goto", "num", ";", "if", "(", "len", "<", "sizeof", "(", "struct", "sctp_authchunks", ")", "+", "num_chunks", ")", "if", "(", "copy_to_user", "(", "to", ",", "ch", "-", ">", "chunks", ",", "num_chunks", ")", ")", "return", "-", "EFAULT", ";", "num", ":", "len", "=", "sizeof", "(", "struct", "sctp_authchunks", ")", "+", "num_chunks", ";</s>auth_chunks", "-", ">", "param_hdr", ".", "length", "=", "htons", "(", "sizeof", "(", "sctp_paramhdr_t", ")", "+", "2", ")", ";", "__u16", "param_len", ";", "param_len", "=", "ntohs", "(", "hmacs", "-", ">", "param_hdr", ".", "length", ")", ";", "if", "(", "len", "<", "param_len", ")", "if", "(", "copy_to_user", "(", "optval", ",", "hmacs", "-", ">", "hmac_ids", ",", "len", ")", ")", "u32", "num_chunks", ";", "if", "(", "len", "<", "=", "sizeof", "(", "struct", "sctp_authchunks", ")", ")", "if", "(", "copy_from_user", "(", "&", "val", ",", "p", ",", "sizeof", "(", "struct", "sctp_authchunks", ")", "))", "len", "=", "num_chunks", ";", "if", "(", "put_user", "(", "len", ",", "optlen", ")", ")", "if", "(", "copy_to_user", "(", "to", ",", "ch", "-", ">", "chunks", ",", "len", ")", ")", "return", "-", "EFAULT", ";", "u32", "num_chunks", ";", "if", "(", "len", "<", "=", "sizeof", "(", "struct", "sctp_authchunks", ")", ")", "if", "(", "copy_from_user", "(", "&", "val", ",", "p", ",", "sizeof", "(", "struct", "sctp_authchunks", ")", "))", "if", "(", "len", "<", "num_chunks", ")", "len", "=", "num_chunks", ";", "if", "(", "copy_to_user", "(", "to", ",", "ch", "-", ">", "chunks", ",", "len", ")", ")", "return", "-", "EFAULT", ";"], "docstring_tokens": ["a", "system", "panic", "and", "result", "in", "a", "denial", "of", "service"]}
{"contents": ["empty"], "code_tokens": ["static", "void", "hidp_process_report", "(", "struct", "hidp_session", "*", "session", ",", "int", "type", ",", "const", "u8", "*", "data", ",", "unsigned", "int", "len", ",", "int", "intr", ")</s>static", "void", "hidp_process_report", "(", "struct", "hidp_session", "*", "session", ",", "int", "type", ",", "const", "u8", "*", "data", ",", "int", "len", ",", "int", "intr", ")"], "docstring_tokens": ["gain", "elevated", "privileges"]}
{"contents": ["empty"], "code_tokens": ["/", "/", "Force", "reconnect", "with", "user", "credentials", "ctx", ".", "reconnect", "(", "null", ")", ";</s>"], "docstring_tokens": ["bypass", "authentication", "with", "arbitrary", "password"]}
{"contents": ["empty"], "code_tokens": ["static", "struct", "mount", "*", "last_dest", ",", "*", "first_source", ",", "*", "last_source", ",", "*", "dest_master", ";", "bool", "done", ";", "if", "(", "p", "=", "=", "dest_master", "|", "|", "IS_MNT_MARKED", "(", "p", ")", ")", "do", "{", "struct", "mount", "*", "parent", "=", "last_source", "-", ">", "mnt_parent", ";", "if", "(", "last_source", "=", "=", "first_source", ")", "break", ";", "done", "=", "parent", "-", ">", "mnt_master", "=", "=", "p", ";", "if", "(", "done", "&", "&", "peers", "(", "n", ",", "parent", ")", ")", "break", ";", "last_source", "=", "last_source", "-", ">", "mnt_master", ";", "}", "while", "(", "!", "done", ")", ";", "first_source", "=", "source_mnt", ";</s>static", "struct", "mount", "*", "last_dest", ",", "*", "last_source", ",", "*", "dest_master", ";", "if", "(", "p", "=", "=", "dest_master", "|", "|", "IS_MNT_MARKED", "(", "p", ")", ")", "{", "while", "(", "last_dest", "-", ">", "mnt_master", "!", "=", "p", ")", "{", "last_source", "=", "last_source", "-", ">", "mnt_master", ";", "last_dest", "=", "last_source", "-", ">", "mnt_parent", ";", "}", "if", "(", "!", "peers", "(", "n", ",", "last_dest", ")", ")", "{", "last_source", "=", "last_source", "-", ">", "mnt_master", ";", "last_dest", "=", "last_source", "-", ">", "mnt_parent", ";", "}", "}"], "docstring_tokens": ["a", "kernel", "oops"]}
{"contents": ["empty"], "code_tokens": ["import", "akka", ".", "annotation", ".", "InternalApi", "import", "org", ".", "slf4j", ".", "Logger", "import", "org", ".", "slf4j", ".", "LoggerFactory", "import", "scala", ".", "language", ".", "existentials", "private", "val", "logger", ":", "Logger", "=", "LoggerFactory", ".", "getLogger", "(", "classOf", "[", "Form", "[", "T", "]", "])", "@", "deprecated", "(", "\"", "Use", "bind", "(", "JsValue", ",", "Int", ")", "instead", "to", "specify", "the", "maximum", "chars", "that", "should", "be", "consumed", "by", "the", "flattened", "form", "representation", "of", "the", "JSON", "\"", ",", "\"", "2", ".", "8", ".", "3", "\"", ")", "def", "bind", "(", "data", ":", "JsValue", ")", ":", "Form", "[", "T", "]", "=", "{", "logger", ".", "warn", "(", "s", "\"", "Binding", "json", "field", "from", "form", "with", "a", "hardcoded", "max", "size", "of", "$", "{", "Form", ".", "FromJsonMaxChars", "}", "bytes", ".", "This", "is", "deprecated", ".", "Use", "bind", "(", "JsValue", ",", "Int", ")", "instead", ".", "\"", ")", "bind", "(", "FormUtils", ".", "fromJson", "(", "data", ",", "Form", ".", "FromJsonMaxChars", ")", ")", "}", "/", "**", "*", "Binds", "data", "to", "this", "form", ",", "i", ".", "e", ".", "handles", "form", "submission", ".", "*", "*", "@", "param", "data", "Json", "data", "to", "submit", "*", "@", "param", "maxChars", "The", "maximum", "number", "of", "chars", "allowed", "to", "be", "used", "in", "the", "intermediate", "map", "representation", "*", "of", "the", "JSON", ".", "`", "parse", ".", "DefaultMaxTextLength", "`", "is", "recommended", "to", "passed", "for", "this", "parameter", ".", "*", "@", "return", "a", "copy", "of", "this", "form", ",", "filled", "with", "the", "new", "data", "*", "/", "def", "bind", "(", "data", ":", "JsValue", ",", "maxChars", ":", "Int", ")", ":", "Form", "[", "T", "]", "=", "bind", "(", "FormUtils", ".", "fromJson", "(", "data", ",", "maxChars", ")", ")", "val", "data", ":", "Map", "[", "String", ",", "Seq", "[", "String", "]", "]", "=", "unwrap", "match", "{", "case", "body", ":", "play", ".", "api", ".", "libs", ".", "json", ".", "JsValue", "=", ">", "FormUtils", ".", "fromJson", "(", "body", ",", "Form", ".", "FromJsonMaxChars", ")", ".", "mapValues", "(", "Seq", "(", "_", ")", ").", "toMap", "val", "method", ":", "Map", "[", "_", "<", ":", "String", ",", "Seq", "[", "String", "]", "]", "=", "request", ".", "method", ".", "toUpperCase", "match", "{", "/", "**", "*", "INTERNAL", "API", "*", "*", "Default", "maximum", "number", "of", "chars", "allowed", "to", "be", "used", "in", "the", "intermediate", "map", "representation", "of", "the", "*", "JSON", ".", "Defaults", "to", "100k", "which", "is", "the", "default", "of", "parser", ".", "maxMemoryBuffer", "*", "/", "@", "InternalApi", "val", "FromJsonMaxChars", ":", "Long", "=", "102400", "def", "fromJson", "(", "js", ":", "JsValue", ",", "maxChars", ":", "Long", ")", ":", "Map", "[", "String", ",", "String", "]", "=", "doFromJson", "(", "FromJsonRoot", "(", "js", ")", ",", "Map", ".", "empty", ",", "0", ",", "maxChars", ")", "@", "annotation", ".", "tailrec", "private", "def", "doFromJson", "(", "context", ":", "FromJsonContext", ",", "form", ":", "Map", "[", "String", ",", "String", "]", ",", "cumulativeChars", ":", "Int", ",", "maxChars", ":", "Long", ")", ":", "Map", "[", "String", ",", "String", "]", "=", "context", "match", "{", "case", "FromJsonTerm", "=", ">", "form", "case", "ctx", ":", "FromJsonContextValue", "=", ">", "/", "/", "Ensure", "this", "contexts", "next", "is", "initialised", ",", "this", "prevents", "unbounded", "recursion", ".", "ctx", ".", "next", "ctx", ".", "value", "match", "{", "case", "obj", ":", "JsObject", "if", "obj", ".", "fields", ".", "nonEmpty", "=", ">", "doFromJson", "(", "FromJsonObject", "(", "ctx", ",", "obj", ".", "fields", ".", "toIndexedSeq", ",", "0", ")", ",", "form", ",", "cumulativeChars", ",", "maxChars", ")", "case", "JsArray", "(", "values", ")", "if", "values", ".", "nonEmpty", "=", ">", "doFromJson", "(", "FromJsonArray", "(", "ctx", ",", "values", ",", "0", ")", ",", "form", ",", "cumulativeChars", ",", "maxChars", ")", "case", "JsNull", "|", "JsArray", "(", "_", ")", "|", "JsObject", "(", "_", ")", "=", ">", "doFromJson", "(", "ctx", ".", "next", ",", "form", ",", "cumulativeChars", ",", "maxChars", ")", "case", "simple", "=", ">", "val", "value", "=", "simple", "match", "{", "case", "JsString", "(", "v", ")", "=", ">", "v", "case", "JsNumber", "(", "v", ")", "=", ">", "v", ".", "toString", "case", "JsBoolean", "(", "v", ")", "=", ">", "v", ".", "toString", "}", "val", "prefix", "=", "ctx", ".", "prefix", "val", "newCumulativeChars", "=", "cumulativeChars", "+", "prefix", ".", "length", "+", "value", ".", "length", "if", "(", "newCumulativeChars", ">", "maxChars", ")", "{", "throw", "FormJsonExpansionTooLarge", "(", "maxChars", ")", "}", "doFromJson", "(", "ctx", ".", "next", ",", "form", ".", "updated", "(", "prefix", ",", "value", ")", ",", "newCumulativeChars", ",", "maxChars", ")", "}", "}", "private", "sealed", "trait", "FromJsonContext", "private", "sealed", "trait", "FromJsonContextValue", "extends", "FromJsonContext", "{", "def", "value", ":", "JsValue", "def", "prefix", ":", "String", "def", "next", ":", "FromJsonContext", "}", "private", "case", "object", "FromJsonTerm", "extends", "FromJsonContext", "private", "case", "class", "FromJsonRoot", "(", "value", ":", "JsValue", ")", "extends", "FromJsonContextValue", "{", "override", "def", "prefix", "=", "\"", "\"", "override", "def", "next", ":", "FromJsonContext", "=", "FromJsonTerm", "}", "private", "case", "class", "FromJsonArray", "(", "parent", ":", "FromJsonContextValue", ",", "values", ":", "scala", ".", "collection", ".", "IndexedSeq", "[", "JsValue", "]", ",", "idx", ":", "Int", ")", "extends", "FromJsonContextValue", "{", "override", "def", "value", ":", "JsValue", "=", "values", "(", "idx", ")", "override", "val", "prefix", ":", "String", "=", "s", "\"", "${", "parent", ".", "prefix", "}", "[$", "idx", "]", "\"", "override", "lazy", "val", "next", ":", "FromJsonContext", "=", "if", "(", "idx", "+", "1", "<", "values", ".", "length", ")", "{", "FromJsonArray", "(", "parent", ",", "values", ",", "idx", "+", "1", ")", "}", "else", "{", "parent", ".", "next", "}", "}", "private", "case", "class", "FromJsonObject", "(", "parent", ":", "FromJsonContextValue", ",", "fields", ":", "IndexedSeq", "[", "(", "String", ",", "JsValue", ")", "],", "idx", ":", "Int", ")", "extends", "FromJsonContextValue", "{", "override", "def", "value", ":", "JsValue", "=", "fields", "(", "idx", ")", ".", "_2", "override", "val", "prefix", ":", "String", "=", "if", "(", "parent", ".", "prefix", ".", "isEmpty", ")", "{", "fields", "(", "idx", ")", ".", "_1", "}", "else", "{", "parent", ".", "prefix", "+", "\"", ".\"", "+", "fields", "(", "idx", ")", ".", "_1", "}", "override", "lazy", "val", "next", ":", "FromJsonContext", "=", "if", "(", "idx", "+", "1", "<", "fields", ".", "length", ")", "{", "FromJsonObject", "(", "parent", ",", "fields", ",", "idx", "+", "1", ")", "}", "else", "{", "parent", ".", "next", "}", "case", "class", "FormJsonExpansionTooLarge", "(", "limit", ":", "Long", ")", "extends", "RuntimeException", "(", "s", "\"", "Binding", "form", "from", "JSON", "exceeds", "form", "expansion", "limit", "of", "$", "limit", "\"", ")", "@", "@", "-", "0", ",", "0", "+", "1", ",", "123", "@", "@", "/", "*", "*", "Copyright", "(", "C", ")", "Lightbend", "Inc", ".", "<", "https", ":", "//", "www", ".", "lightbend", ".", "com", ">", "*", "/", "package", "play", ".", "api", ".", "data", "import", "org", ".", "specs2", ".", "mutable", ".", "Specification", "import", "play", ".", "api", ".", "libs", ".", "json", ".", "JsNull", "import", "play", ".", "api", ".", "libs", ".", "json", ".", "Json", "class", "FormUtilsSpec", "extends", "Specification", "{", "\"", "FormUtils", ".", "fromJson", "\"", "should", "{", "\"", "convert", "a", "complex", "json", "structure", "to", "a", "map", "\"", "in", "{", "val", "json", "=", "Json", ".", "obj", "(", "\"", "arr", "\"", "-", ">", "Json", ".", "arr", "(", "Json", ".", "obj", "(", "\"", "a", "\"", "-", ">", "\"", "an", "-", "a", "\"", ",", "\"", "b", "\"", "-", ">", "true", ",", "\"", "c", "\"", "-", ">", "JsNull", ",", "\"", "d", "\"", "-", ">", "10", ")", ",", "\"", "str", "\"", ",", "20", ",", "\"", "blah", "\"", ")", ",", "\"", "e", "\"", "-", ">", "Json", ".", "obj", "(", "\"", "f", "\"", "-", ">", "\"", "an", "-", "f", "\"", ",", "\"", "g", "\"", "-", ">", "false", ",", ")", ",", "\"", "h", "\"", "-", ">", "\"", "an", "-", "h", "\"", ",", "\"", "i", "\"", "-", ">", "30", ",", "\"", "j", "\"", "-", ">", "Json", ".", "arr", "(", "Json", ".", "arr", "(", "40", ")", ")", ")", "val", "expected", "=", "Seq", "(", "\"", "arr", "[", "0", "]", ".", "a", "\"", "-", ">", "\"", "an", "-", "a", "\"", ",", "\"", "arr", "[", "0", "]", ".", "b", "\"", "-", ">", "\"", "true", "\"", ",", "\"", "arr", "[", "0", "]", ".", "d", "\"", "-", ">", "\"", "10", "\"", ",", "\"", "arr", "[", "1", "]", "\"", "-", ">", "\"", "str", "\"", ",", "\"", "arr", "[", "2", "]", "\"", "-", ">", "\"", "20", "\"", ",", "\"", "arr", "[", "3", "]", "\"", "-", ">", "\"", "blah", "\"", ",", "\"", "e", ".", "f", "\"", "-", ">", "\"", "an", "-", "f", "\"", ",", "\"", "e", ".", "g", "\"", "-", ">", "\"", "false", "\"", ",", "\"", "h", "\"", "-", ">", "\"", "an", "-", "h", "\"", ",", "\"", "i", "\"", "-", ">", "\"", "30", "\"", ",", "\"", "j", "[", "0", "]", "[", "0", "]", "\"", "-", ">", "\"", "40", "\"", ",", ")", "val", "map", "=", "FormUtils", ".", "fromJson", "(", "json", ",", "1000", ")", "map", ".", "toSeq", "must", "containTheSameElementsAs", "(", "expected", ")", "}", "\"", "not", "stack", "overflow", "when", "converting", "heavily", "nested", "arrays", "\"", "in", "{", "try", "{", "FormUtils", ".", "fromJson", "(", "Json", ".", "parse", "(", "\"{", "\\\"", "arr", "\\", "\":", "\"", "+", "(", "\"[", "\"", "*", "10000", ")", "+", "\"", "1", "\"", "+", "(", "\"]", "\"", "*", "10000", ")", "+", "\"", "}\"", "),", "1000000", ")", "}", "catch", "{", "case", "e", ":", "StackOverflowError", "=", ">", "ko", "(", "\"", "StackOverflowError", "thrown", "\"", ")", "}", "ok", "}", "\"", "parse", "normally", "when", "the", "input", "is", "small", "enough", "\"", "in", "{", "val", "keyLength", "=", "10", "val", "itemCount", "=", "10", "val", "maxChars", "=", "500", "*", "1000", "/", "/", "a", "limit", "we", "'", "re", "not", "reaching", "try", "{", "FormUtils", ".", "fromJson", "(", "Json", ".", "obj", "(", "\"", "a", "\"", "*", "keyLength", "-", ">", "Json", ".", "arr", "(", "0", "to", "itemCount", ")", "),", "maxChars", ")", "}", "catch", "{", "case", "_", ":", "OutOfMemoryError", "=", ">", "ko", "(", "\"", "OutOfMemoryError", "\"", ")", "}", "ok", "}", "\"", "abort", "parsing", "when", "maximum", "memory", "is", "used", "\"", "in", "{", "/", "/", "Even", "when", "the", "JSON", "is", "small", ",", "if", "the", "memory", "limit", "is", "exceed", "the", "parsing", "must", "stop", ".", "val", "keyLength", "=", "10", "val", "itemCount", "=", "10", "val", "maxChars", "=", "3", "/", "/", "yeah", ",", "maxChars", "is", "only", "3", "chars", ".", "We", "want", "to", "hit", "the", "limit", ".", "(", "try", "{", "FormUtils", ".", "fromJson", "(", "Json", ".", "obj", "(", "\"", "a", "\"", "*", "keyLength", "-", ">", "Json", ".", "arr", "(", "0", "to", "itemCount", ")", "),", "maxChars", ")", "}", "catch", "{", "case", "_", ":", "OutOfMemoryError", "=", ">", "ko", "(", "\"", "OutOfMemoryError", "\"", ")", "}", ")", "must", "throwA", "[", "FormJsonExpansionTooLarge", "]", "}", "\"", "not", "run", "out", "of", "heap", "when", "converting", "arrays", "with", "very", "long", "keys", "\"", "in", "{", "/", "/", "a", "similar", "scenario", "to", "the", "previous", "one", "but", "this", "would", "cause", "OOME", "if", "it", "weren", "'", "t", "for", "the", "limit", "val", "keyLength", "=", "10000", "val", "itemCount", "=", "100000", "val", "maxChars", "=", "keyLength", "/", "/", "some", "value", "we", "'", "re", "likely", "to", "exceed", ".", "We", "want", "this", "limit", "to", "kick", "in", ".", "(", "try", "{", "FormUtils", ".", "fromJson", "(", "/", "/", "A", "JSON", "object", "with", "a", "key", "of", "length", "10000", ",", "pointing", "to", "a", "list", "with", "100000", "elements", ".", "/", "/", "In", "memory", ",", "this", "will", "consume", "at", "most", "a", "few", "MB", "of", "space", ".", "When", "expanded", ",", "will", "consume", "/", "/", "many", "GB", "of", "space", ".", "Json", ".", "obj", "(", "\"", "a", "\"", "*", "keyLength", "-", ">", "Json", ".", "arr", "(", "0", "to", "itemCount", ")", "),", "maxChars", ")", "}", "catch", "{", "case", "_", ":", "OutOfMemoryError", "=", ">", "/", "/", "No", "guarantee", "we", "'", "ll", "be", "the", "thread", "that", "gets", "this", ",", "or", "that", "our", "handling", "will", "be", "graceful", ",", "/", "/", "but", "at", "least", "try", ".", "ko", "(", "\"", "OutOfMemoryError", "\"", ")", "}", ")", "must", "throwA", "[", "FormJsonExpansionTooLarge", "]", "}", "}", "}", "@", "@", "-", "209", ",", "7", "+", "209", ",", "9", "@", "@", "object", "BuildSettings", "{", "/", "/", "Limit", "JSON", "parsing", "resources", "ProblemFilters", ".", "exclude", "[", "DirectMissingMethodProblem", "]", "(\"", "play", ".", "api", ".", "data", ".", "FormUtils", ".", "fromJson", "$", "default", "$", "1", "\"", "),", "ProblemFilters", ".", "exclude", "[", "IncompatibleMethTypeProblem", "]", "(\"", "play", ".", "api", ".", "data", ".", "FormUtils", ".", "fromJson", "\"", "),", "/", "/", "is", "private", "@", "Deprecated", "logger", ".", "warn", "(", "\"", "Binding", "json", "field", "from", "form", "with", "a", "hardcoded", "max", "size", "of", "{", "}", "bytes", ".", "This", "is", "deprecated", ".", "Use", "bind", "(", "Lang", ",", "TypedMap", ",", "JsonNode", ",", "Int", ",", "String", ".", "..", ")", "instead", ".", "\",", "FROM_JSON_MAX_CHARS", ")", ";", "return", "bind", "(", "lang", ",", "attrs", ",", "data", ",", "FROM_JSON_MAX_CHARS", ",", "allowedFields", ")", ";", "}", "@", "Override", "public", "DynamicForm", "bind", "(", "Lang", "lang", ",", "TypedMap", "attrs", ",", "JsonNode", "data", ",", "long", "maxChars", ",", "String", ".", "..", "allowedFields", ")", "{", "play", ".", "api", ".", "libs", ".", "json", ".", "Json", ".", "parse", "(", "play", ".", "libs", ".", "Json", ".", "stringify", "(", "data", ")", "),", "maxChars", ")", "),", "import", "org", ".", "slf4j", ".", "Logger", ";", "import", "org", ".", "slf4j", ".", "LoggerFactory", ";", "import", "play", ".", "api", ".", "data", ".", "Form", "$", ";", "protected", "static", "final", "long", "FROM_JSON_MAX_CHARS", "=", "Form", "$", ".", "MODULE", "$", ".", "FromJsonMaxChars", "(", ");", "protected", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "getClass", "(", "))", ";", "long", "maxMemoryBuffer", "=", "config", ".", "getMemorySize", "(", "\"", "play", ".", "http", ".", "parser", ".", "maxMemoryBuffer", "\"", ").", "toBytes", "(", ");", "play", ".", "api", ".", "libs", ".", "json", ".", "Json", ".", "parse", "(", "play", ".", "libs", ".", "Json", ".", "stringify", "(", "request", ".", "body", "(", ").", "asJson", "(", "))", "),", "maxMemoryBuffer", ")", ");", "*", "@", "deprecated", "Deprecated", "as", "of", "2", ".", "8", ".", "3", ".", "Use", "{", "@", "link", "#", "bind", "(", "Lang", ",", "TypedMap", ",", "JsonNode", ",", "int", ",", "String", ".", "..", ")}", "*", "instead", "to", "specify", "the", "maximum", "chars", "that", "should", "be", "consumed", "by", "the", "flattened", "form", "*", "representation", "of", "the", "JSON", ".", "@", "Deprecated", "logger", ".", "warn", "(", "\"", "Binding", "json", "field", "from", "form", "with", "a", "hardcoded", "max", "size", "of", "{", "}", "bytes", ".", "This", "is", "deprecated", ".", "Use", "bind", "(", "Lang", ",", "TypedMap", ",", "JsonNode", ",", "Int", ",", "String", ".", "..", ")", "instead", ".", "\",", "FROM_JSON_MAX_CHARS", ")", ";", "return", "bind", "(", "lang", ",", "attrs", ",", "data", ",", "FROM_JSON_MAX_CHARS", ",", "allowedFields", ")", ";", "}", "/", "**", "*", "Binds", "Json", "data", "to", "this", "form", "-", "that", "is", ",", "handles", "form", "submission", ".", "*", "*", "@", "param", "lang", "used", "for", "validators", "and", "formatters", "during", "binding", "and", "is", "part", "of", "{", "@", "link", "*", "ValidationPayload", "}", ".", "Later", "also", "used", "for", "formatting", "when", "retrieving", "a", "field", "(", "via", "{", "@", "link", "*", "#", "field", "(", "String", ")", "}", "or", "{", "@", "link", "#", "apply", "(", "String", ")", "})", "and", "for", "translations", "in", "{", "@", "link", "#", "errorsAsJson", "(", ")}", ".", "*", "For", "these", "methods", "the", "lang", "can", "be", "change", "via", "{", "@", "link", "#", "withLang", "(", "Lang", ")", "}.", "*", "@", "param", "attrs", "will", "be", "passed", "to", "validators", "via", "{", "@", "link", "ValidationPayload", "}", "*", "@", "param", "data", "data", "to", "submit", "*", "@", "param", "maxChars", "The", "maximum", "number", "of", "chars", "allowed", "to", "be", "used", "in", "the", "intermediate", "map", "*", "representation", "of", "the", "JSON", ".", "`", "parse", ".", "DefaultMaxTextLength", "`", "is", "recommended", "to", "passed", "for", "this", "*", "parameter", ".", "*", "@", "param", "allowedFields", "the", "fields", "that", "should", "be", "bound", "to", "the", "form", ",", "all", "fields", "if", "not", "specified", ".", "*", "@", "return", "a", "copy", "of", "this", "form", "filled", "with", "the", "new", "data", "*", "/", "public", "Form", "<", "T", ">", "bind", "(", "Lang", "lang", ",", "TypedMap", "attrs", ",", "JsonNode", "data", ",", "long", "maxChars", ",", "String", ".", "..", "allowedFields", ")", "{", "play", ".", "api", ".", "libs", ".", "json", ".", "Json", ".", "parse", "(", "play", ".", "libs", ".", "Json", ".", "stringify", "(", "data", ")", "),", "maxChars", ")", "),</s>import", "scala", ".", "language", ".", "existentials", "def", "bind", "(", "data", ":", "JsValue", ")", ":", "Form", "[", "T", "]", "=", "bind", "(", "FormUtils", ".", "fromJson", "(", "js", "=", "data", ")", ")", "val", "data", "=", "unwrap", "match", "{", "case", "body", ":", "play", ".", "api", ".", "libs", ".", "json", ".", "JsValue", "=", ">", "FormUtils", ".", "fromJson", "(", "js", "=", "body", ")", ".", "mapValues", "(", "Seq", "(", "_", ")", ")", "val", "method", "=", "request", ".", "method", ".", "toUpperCase", "match", "{", "def", "fromJson", "(", "prefix", ":", "String", "=", "\"", "\",", "js", ":", "JsValue", ")", ":", "Map", "[", "String", ",", "String", "]", "=", "js", "match", "{", "case", "JsObject", "(", "fields", ")", "=", ">", "val", "prefix2", "=", "Option", "(", "prefix", ")", ".", "filterNot", "(", "_", ".", "isEmpty", ")", ".", "map", "(", "_", "+", "\"", ".\"", ").", "getOrElse", "(", "\"\"", ")", "fields", ".", "iterator", ".", "map", "{", "case", "(", "key", ",", "value", ")", "=", ">", "fromJson", "(", "prefix2", "+", "key", ",", "value", ")", "}", ".", "foldLeft", "(", "Map", ".", "empty", "[", "String", ",", "String", "]", ")(", "_", "+", "+", "_", ")", "case", "JsArray", "(", "values", ")", "=", ">", "values", ".", "zipWithIndex", ".", "iterator", ".", "map", "{", "case", "(", "value", ",", "i", ")", "=", ">", "fromJson", "(", "s", "\"", "$", "prefix", "[", "$", "i", "]", "\",", "value", ")", "}", ".", "foldLeft", "(", "Map", ".", "empty", "[", "String", ",", "String", "]", ")(", "_", "+", "+", "_", ")", "case", "JsNull", "=", ">", "Map", ".", "empty", "case", "JsUndefined", "(", ")", "=", ">", "Map", ".", "empty", "case", "JsBoolean", "(", "value", ")", "=", ">", "Map", "(", "prefix", "-", ">", "value", ".", "toString", ")", "case", "JsNumber", "(", "value", ")", "=", ">", "Map", "(", "prefix", "-", ">", "value", ".", "toString", ")", "case", "JsString", "(", "value", ")", "=", ">", "Map", "(", "prefix", "-", ">", "value", ".", "toString", ")", "/", "/", "Add", "mima", "filters", "here", "\"", "\",", "play", ".", "api", ".", "libs", ".", "json", ".", "Json", ".", "parse", "(", "play", ".", "libs", ".", "Json", ".", "stringify", "(", "data", ")", "))", "),", "\"", "\",", "play", ".", "api", ".", "libs", ".", "json", ".", "Json", ".", "parse", "(", "play", ".", "libs", ".", "Json", ".", "stringify", "(", "request", ".", "body", "(", ").", "asJson", "(", "))", "))", ");", "\"", "\",", "play", ".", "api", ".", "libs", ".", "json", ".", "Json", ".", "parse", "(", "play", ".", "libs", ".", "Json", ".", "stringify", "(", "data", ")", "))", "),"], "docstring_tokens": ["a", "denial", "of", "service", "condition"]}
{"contents": ["empty"], "code_tokens": ["/", "**", "*", "The", "default", "buffer", "size", "to", "use", "for", "the", "skip", "(", ")", "methods", ".", "*", "/", "private", "static", "final", "int", "SKIP_BUFFER_SIZE", "=", "2048", ";", "private", "static", "byte", "[", "]", "SKIP_BYTE_BUFFER", ";", "*", "Skips", "bytes", "from", "an", "input", "byte", "stream", ".", "*", "This", "implementation", "guarantees", "that", "it", "will", "read", "as", "many", "bytes", "*", "as", "possible", "before", "giving", "up", ";", "this", "may", "not", "always", "be", "the", "case", "for", "*", "skip", "(", ")", "implementations", "in", "subclasses", "of", "{", "@", "link", "InputStream", "}", ".", "*", "<", "p", ">", "*", "Note", "that", "the", "implementation", "uses", "{", "@", "link", "InputStream", "#", "read", "(", "byte", "[", "],", "int", ",", "int", ")", "}", "rather", "*", "than", "delegating", "to", "{", "@", "link", "InputStream", "#", "skip", "(", "long", ")", "}.", "*", "This", "means", "that", "the", "method", "may", "be", "considerably", "less", "efficient", "than", "using", "the", "actual", "skip", "implementation", ",", "*", "this", "is", "done", "to", "guarantee", "that", "the", "correct", "number", "of", "bytes", "are", "skipped", ".", "*", "<", "/", "p", ">", "*", "<", "p", ">", "*", "This", "mimics", "POI", "'", "s", "{", "@", "link", "#", "readFully", "(", "InputStream", ",", "byte", "[", "])", "}.", "*", "If", "the", "end", "of", "file", "is", "reached", "before", "any", "bytes", "are", "read", ",", "returns", "<", "tt", ">", "-", "1", "<", "/", "tt", ">", ".", "If", "*", "the", "end", "of", "the", "file", "is", "reached", "after", "some", "bytes", "are", "read", ",", "returns", "the", "*", "number", "of", "bytes", "read", ".", "If", "the", "end", "of", "the", "file", "isn", "'", "t", "reached", "before", "<", "tt", ">", "len", "<", "/", "tt", ">", "*", "bytes", "have", "been", "read", ",", "will", "return", "<", "tt", ">", "len", "<", "/", "tt", ">", "bytes", ".", "</", "p", ">", "*", "<", "/", "p", ">", "*", "<", "p", ">", "*", "Copied", "nearly", "verbatim", "from", "commons", "-", "io", "41a3e9c", "*", "<", "/", "p", ">", "*", "*", "@", "param", "input", "byte", "stream", "to", "skip", "*", "@", "param", "toSkip", "number", "of", "bytes", "to", "skip", ".", "*", "@", "return", "number", "of", "bytes", "actually", "skipped", ".", "*", "@", "throws", "IOException", "if", "there", "is", "a", "problem", "reading", "the", "file", "*", "@", "throws", "IllegalArgumentException", "if", "toSkip", "is", "negative", "*", "@", "see", "InputStream", "#", "skip", "(", "long", ")", "public", "static", "long", "skipFully", "(", "final", "InputStream", "input", ",", "final", "long", "toSkip", ")", "throws", "IOException", "{", "if", "(", "toSkip", "<", "0", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "Skip", "count", "must", "be", "non", "-", "negative", ",", "actual", ":", "\"", "+", "toSkip", ")", ";", "if", "(", "toSkip", "=", "=", "0", ")", "{", "return", "0L", ";", "}", "/", "*", "*", "N", ".", "B", ".", "no", "need", "to", "synchronize", "this", "because", ":", "-", "we", "don", "'", "t", "care", "if", "the", "buffer", "is", "created", "multiple", "times", "(", "the", "data", "*", "is", "ignored", ")", "-", "we", "always", "use", "the", "same", "size", "buffer", ",", "so", "if", "it", "it", "is", "recreated", "it", "will", "still", "be", "OK", "(", "if", "the", "buffer", "*", "size", "were", "variable", ",", "we", "would", "need", "to", "synch", ".", "to", "ensure", "some", "other", "thread", "did", "not", "create", "a", "smaller", "one", ")", "*", "/", "if", "(", "SKIP_BYTE_BUFFER", "=", "=", "null", ")", "{", "SKIP_BYTE_BUFFER", "=", "new", "byte", "[", "SKIP_BUFFER_SIZE", "]", ";", "}", "long", "remain", "=", "toSkip", ";", "while", "(", "remain", ">", "0", ")", "{", "/", "/", "See", "https", ":", "//", "issues", ".", "apache", ".", "org", "/", "jira", "/", "browse", "/", "IO", "-", "203", "for", "why", "we", "use", "read", "(", ")", "rather", "than", "delegating", "to", "skip", "(", ")", "final", "long", "n", "=", "input", ".", "read", "(", "SKIP_BYTE_BUFFER", ",", "0", ",", "(", "int", ")", "Math", ".", "min", "(", "remain", ",", "SKIP_BUFFER_SIZE", ")", ");", "if", "(", "n", "<", "0", ")", "{", "/", "/", "EOF", "break", ";", "remain", "-", "=", "n", ";", "}", "if", "(", "toSkip", "=", "=", "remain", ")", "{", "return", "-", "1L", ";", "return", "toSkip", "-", "remain", ";", "long", "read", "=", "IOUtils", ".", "readFully", "(", "leis", ",", "arr", ",", "initialBytes", ".", "length", ",", "dataSize", ")", ";", "if", "(", "read", "!", "=", "dataSize", ")", "{", "throw", "new", "RecordFormatException", "(", "\"", "InputStream", "ended", "before", "full", "record", "could", "be", "read", "\"", ");", "}", "long", "toSkip", "=", "recordSize", "-", "dataSize", ";", "long", "skipped", "=", "IOUtils", ".", "skipFully", "(", "leis", ",", "toSkip", ")", ";", "if", "(", "toSkip", "!", "=", "skipped", ")", "{", "throw", "new", "RecordFormatException", "(", "\"", "InputStream", "ended", "before", "full", "record", "could", "be", "read", "\"", ");", "}", "long", "read", "=", "IOUtils", ".", "readFully", "(", "leis", ",", "arr", ")", ";", "if", "(", "read", "!", "=", "dataSize", ")", "{", "throw", "new", "RecordFormatException", "(", "\"", "InputStream", "ended", "before", "full", "record", "could", "be", "read", "\"", ");", "}", "long", "toSkip", "=", "recordSize", "-", "dataSize", ";", "long", "skipped", "=", "IOUtils", ".", "skipFully", "(", "leis", ",", "recordSize", "-", "dataSize", ")", ";", "if", "(", "toSkip", "!", "=", "skipped", ")", "{", "throw", "new", "RecordFormatException", "(", "\"", "InputStream", "ended", "before", "full", "record", "could", "be", "read", "\"", ");", "}", "if", "(", "skipped", "<", "recordSize", ")", "{", "static", "final", "long", "LENGTH", "=", "new", "Random", "(", ").", "nextInt", "(", "10000", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "LENGTH", ";", "i", "+", "+)", "{", "os", ".", "write", "(", "0x01", ")", ";", "assertEquals", "(", "\"", "length", ":", "\"", "+", "LENGTH", ",", "LENGTH", ",", "skipped", ")", ";", "assertEquals", "(", "\"", "length", ":", "\"", "+", "LENGTH", ",", "LENGTH", ",", "skipped", ")", ";", "assertEquals", "(", "\"", "length", ":", "\"", "+", "LENGTH", ",", "LENGTH", ",", "skipped", ")", ";", "assertEquals", "(", "\"", "length", ":", "\"", "+", "LENGTH", ",", "LENGTH", ",", "skipped", ")", ";", "}", "@", "Test", "public", "void", "testZeroByte", "(", ")", "throws", "IOException", "{", "long", "skipped", "=", "IOUtils", ".", "skipFully", "(", "(", "new", "ByteArrayInputStream", "(", "new", "byte", "[", "0", "]", "))", ",", "100", ")", ";", "assertEquals", "(", "\"", "zero", "byte", "\"", ",", "-", "1L", ",", "skipped", ")", ";", "}", "@", "Test", "public", "void", "testSkipZero", "(", ")", "throws", "IOException", "{", "InputStream", "is", "=", "new", "FileInputStream", "(", "TMP", ")", ";", "long", "skipped", "=", "IOUtils", ".", "skipFully", "(", "is", ",", "0", ")", ";", "assertEquals", "(", "\"", "zero", "length", "\"", ",", "0", ",", "skipped", ")", ";", "}", "@", "Test", "(", "expected", "=", "IllegalArgumentException", ".", "class", ")", "public", "void", "testSkipNegative", "(", ")", "throws", "IOException", "{", "InputStream", "is", "=", "new", "FileInputStream", "(", "TMP", ")", ";", "long", "skipped", "=", "IOUtils", ".", "skipFully", "(", "is", ",", "-", "1", ")", ";", "assertEquals", "(", "\"", "length", ":", "\"", "+", "LENGTH", ",", "10000", ",", "skipped", ")", ";</s>*", "Skips", "bytes", "from", "a", "stream", ".", "Returns", "-", "1L", "if", "len", ">", "available", "(", ")", "or", "if", "EOF", "was", "hit", "before", "*", "the", "end", "of", "the", "stream", ".", "*", "@", "param", "in", "inputstream", "*", "@", "param", "len", "length", "to", "skip", "*", "@", "return", "number", "of", "bytes", "skipped", "*", "@", "throws", "IOException", "on", "IOException", "public", "static", "long", "skipFully", "(", "InputStream", "in", ",", "long", "len", ")", "throws", "IOException", "{", "long", "total", "=", "0", ";", "while", "(", "true", ")", "{", "long", "toSkip", "=", "len", "-", "total", ";", "/", "/", "check", "that", "the", "stream", "has", "the", "toSkip", "available", "/", "/", "FileInputStream", "can", "mis", "-", "report", "20k", "skipped", "on", "a", "10k", "file", "if", "(", "toSkip", ">", "in", ".", "available", "(", "))", "{", "return", "-", "1L", ";", "}", "long", "got", "=", "in", ".", "skip", "(", "len", "-", "total", ")", ";", "if", "(", "got", "<", "0", ")", "{", "return", "-", "1L", ";", "}", "else", "if", "(", "got", "=", "=", "0", ")", "{", "got", "=", "fallBackToReadFully", "(", "len", "-", "total", ",", "in", ")", ";", "if", "(", "got", "<", "0", ")", "{", "return", "-", "1L", ";", "}", "}", "total", "+", "=", "got", ";", "if", "(", "total", "=", "=", "len", ")", "{", "return", "total", ";", "}", "}", "/", "/", "an", "InputStream", "can", "return", "0", "whether", "or", "not", "it", "hits", "EOF", "/", "/", "if", "it", "returns", "0", ",", "back", "off", "to", "readFully", "to", "test", "for", "-", "1", "private", "static", "long", "fallBackToReadFully", "(", "long", "lenToRead", ",", "InputStream", "in", ")", "throws", "IOException", "{", "byte", "[", "]", "buffer", "=", "new", "byte", "[", "8192", "]", ";", "long", "readSoFar", "=", "0", ";", "while", "(", "true", ")", "{", "int", "toSkip", "=", "(", "lenToRead", ">", "Integer", ".", "MAX_VALUE", "|", "|", "(", "lenToRead", "-", "readSoFar", ")", ">", "buffer", ".", "length", ")", "?", "buffer", ".", "length", ":", "(", "int", ")", "(", "lenToRead", "-", "readSoFar", ")", ";", "long", "readNow", "=", "readFully", "(", "in", ",", "buffer", ",", "0", ",", "toSkip", ")", ";", "if", "(", "readNow", "<", "toSkip", ")", "{", "return", "-", "1L", ";", "}", "readSoFar", "+", "=", "readNow", ";", "if", "(", "readSoFar", "=", "=", "lenToRead", ")", "{", "return", "readSoFar", ";", "IOUtils", ".", "readFully", "(", "leis", ",", "arr", ",", "initialBytes", ".", "length", ",", "dataSize", ")", ";", "IOUtils", ".", "skipFully", "(", "leis", ",", "recordSize", "-", "dataSize", ")", ";", "IOUtils", ".", "readFully", "(", "leis", ",", "arr", ")", ";", "IOUtils", ".", "skipFully", "(", "leis", ",", "recordSize", "-", "dataSize", ")", ";", "if", "(", "skipped", "<", "0", ")", "{", "static", "long", "SEED", "=", "new", "Random", "(", ").", "nextLong", "(", ");", "static", "Random", "RANDOM", "=", "new", "Random", "(", "SEED", ")", ";", "for", "(", "int", "i", "=", "0", ";", "i", "<", "RANDOM", ".", "nextInt", "(", "10000", ")", ";", "i", "+", "+)", "{", "os", ".", "write", "(", "RANDOM", ".", "nextInt", "(", "(", "byte", ")", "127", ")", ");", "assertEquals", "(", "\"", "seed", ":", "\"", "+", "SEED", ",", "-", "1L", ",", "skipped", ")", ";", "assertEquals", "(", "\"", "seed", ":", "\"", "+", "SEED", ",", "-", "1L", ",", "skipped", ")", ";", "assertEquals", "(", "\"", "seed", ":", "\"", "+", "SEED", ",", "-", "1L", ",", "skipped", ")", ";", "assertEquals", "(", "\"", "seed", ":", "\"", "+", "SEED", ",", "-", "1L", ",", "skipped", ")", ";", "assertEquals", "(", "\"", "seed", ":", "\"", "+", "SEED", ",", "10000", ",", "skipped", ")", ";"], "docstring_tokens": ["the", "application", "to", "enter", "into", "an", "infinite", "loop", "or", "an", "out", "of", "memory", "exception"]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "xml", ".", "sax", ".", "SAXNotRecognizedException", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXNotSupportedException", ";", "private", "static", "final", "SAXParserFactory", "spf", "=", "SAXParserFactory", ".", "newInstance", "(", ");", "static", "{", "try", "{", "spf", ".", "setFeature", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", ",", "true", ")", ";", "}", "catch", "(", "SAXNotRecognizedException", "|", "SAXNotSupportedException", "|", "ParserConfigurationException", "e", ")", "{", "throw", "new", "RuntimeException", "(", "e", ")", ";", "}", "}", "synchronized", "(", "spf", ")", "{", "xr", "=", "spf", ".", "newSAXParser", "(", ").", "getXMLReader", "(", ");", "}", "synchronized", "(", "spf", ")", "{", "xr", "=", "spf", ".", "newSAXParser", "(", ").", "getXMLReader", "(", ");", "}", "DocumentBuilderFactory", "dbf", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "dbf", ".", "setFeature", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", ",", "true", ")", ";", "DocumentBuilder", "docBuilder", "=", "dbf", ".", "newDocumentBuilder", "(", ");", "factory", ".", "setFeature", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", ",", "false", ")", ";", "import", "org", ".", "apache", ".", "uima", ".", "internal", ".", "util", ".", "XMLUtils", ";", "XMLReader", "xmlReader", "=", "XMLUtils", ".", "createXMLReader", "(", ");", "import", "org", ".", "apache", ".", "uima", ".", "internal", ".", "util", ".", "XMLUtils", ";", "XMLReader", "xmlReader", "=", "XMLUtils", ".", "createXMLReader", "(", ");", "XMLReader", "xmlReader", "=", "XMLUtils", ".", "createXMLReader", "(", ");", "factory", ".", "setFeature", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", ",", "true", ")", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXException", ";", "import", "org", ".", "xml", ".", "sax", ".", "XMLReader", ";", "import", "org", ".", "xml", ".", "sax", ".", "helpers", ".", "XMLReaderFactory", ";", "public", "static", "XMLReader", "createXMLReader", "(", ")", "throws", "SAXException", "{", "XMLReader", "xmlReader", "=", "XMLReaderFactory", ".", "createXMLReader", "(", ");", "xmlReader", ".", "setFeature", "(", "\"", "http", ":", "//", "xml", ".", "org", "/", "sax", "/", "features", "/", "external", "-", "general", "-", "entities", "\"", ",", "false", ")", ";", "xmlReader", ".", "setFeature", "(", "\"", "http", ":", "//", "xml", ".", "org", "/", "sax", "/", "features", "/", "external", "-", "parameter", "-", "entities", "\"", ",", "false", ")", ";", "xmlReader", ".", "setFeature", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "nonvalidating", "/", "load", "-", "external", "-", "dtd", "\"", ",", "false", ")", ";", "return", "xmlReader", ";", "}", "factory", ".", "setFeature", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", ",", "true", ")", ";", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "static", "{", "transformerFactory", ".", "setAttribute", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_DTD", ",", "\"", "\")", ";", "transformerFactory", ".", "setAttribute", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_STYLESHEET", ",", "\"", "\")", ";", "}", "import", "org", ".", "apache", ".", "uima", ".", "internal", ".", "util", ".", "XMLUtils", ";", "XMLReader", "xmlReader", "=", "XMLUtils", ".", "createXMLReader", "(", ");", "XMLReader", "xmlReader", "=", "XMLUtils", ".", "createXMLReader", "(", ");", "factory", ".", "setFeature", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", ",", "true", ")", ";", "import", "org", ".", "apache", ".", "uima", ".", "internal", ".", "util", ".", "XMLUtils", ";", "+", "\"", "<", "uima", ".", "tcas", ".", "DocumentAnnotation", "_indexed", "=", "\\\"", "1", "\\", "\"", "_id", "=", "\\\"", "8", "\\", "\"", "sofa", "=", "\\\"", "1", "\\", "\"", "begin", "=", "\\\"", "0", "\\", "\"", "end", "=", "\\\"", "13", "\\", "\"", "language", "=", "\\\"", "en", "\\", "\"/", ">\"", "+", "\"", "<", "foo", ".", "Bar", "_indexed", "=", "\\\"", "1", "\\", "\"", "_id", "=", "\\\"", "2", "\\", "\"", "sofa", "=", "\\\"", "1", "\\", "\"", "begin", "=", "\\\"", "0", "\\", "\"", "end", "=", "\\\"", "0", "\\", "\"", "baz", "=", "\\\"", "blah", "\\", "\">", "this", "is", "the", "value", "feature", "<", "/", "foo", ".", "Bar", ">", "</", "CAS", ">", "\";", "XMLReader", "xmlReader", "=", "XMLUtils", ".", "createXMLReader", "(", ");", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "TransformerFactory", "transformerFactory", "=", "TransformerFactory", ".", "newInstance", "(", ");", "transformerFactory", ".", "setAttribute", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_DTD", ",", "\"", "\")", ";", "transformerFactory", ".", "setAttribute", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_STYLESHEET", ",", "\"", "\")", ";", "Transformer", "t", "=", "transformerFactory", ".", "newTransformer", "(", ");", "try", "{", "documentBuilderFacoty", ".", "setFeature", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", ",", "true", ")", ";", "}", "catch", "(", "ParserConfigurationException", "e1", ")", "{", "throw", "new", "RuntimeException", "(", "e1", ")", ";", "}", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXNotRecognizedException", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXNotSupportedException", ";", "{", "try", "{", "parserFactory", ".", "setFeature", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", ",", "true", ")", ";", "}", "catch", "(", "SAXNotRecognizedException", "|", "SAXNotSupportedException", "|", "ParserConfigurationException", "e", ")", "{", "throw", "new", "RuntimeException", "(", "e", ")", ";", "}", "}", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXNotRecognizedException", ";", "import", "org", ".", "xml", ".", "sax", ".", "SAXNotSupportedException", ";", "{", "try", "{", "parserFactory", ".", "setFeature", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", ",", "true", ")", ";", "}", "catch", "(", "SAXNotRecognizedException", "|", "SAXNotSupportedException", "|", "ParserConfigurationException", "e", ")", "{", "throw", "new", "RuntimeException", "(", "e", ")", ";", "}", "}", "SAXParserFactory", "saxParserFactory", "=", "SAXParserFactory", ".", "newInstance", "(", ");", "saxParserFactory", ".", "setFeature", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", ",", "true", ")", ";", "SAXParser", "parser", "=", "saxParserFactory", ".", "newSAXParser", "(", ");", "SAXParserFactory", "saxParserFactory", "=", "SAXParserFactory", ".", "newInstance", "(", ");", "saxParserFactory", ".", "setFeature", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", ",", "true", ")", ";", "SAXParser", "parser", "=", "saxParserFactory", ".", "newSAXParser", "(", ");", "import", "javax", ".", "xml", ".", "XMLConstants", ";", "mTFactory", ".", "setAttribute", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_DTD", ",", "\"", "\")", ";", "mTFactory", ".", "setAttribute", "(", "XMLConstants", ".", "ACCESS_EXTERNAL_STYLESHEET", ",", "\"", "\")", ";</s>xr", "=", "SAXParserFactory", ".", "newInstance", "(", ").", "newSAXParser", "(", ").", "getXMLReader", "(", ");", "xr", "=", "SAXParserFactory", ".", "newInstance", "(", ").", "newSAXParser", "(", ").", "getXMLReader", "(", ");", "DocumentBuilder", "docBuilder", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ").", "newDocumentBuilder", "(", ");", "XMLReader", "xmlReader", "=", "XMLReaderFactory", ".", "createXMLReader", "(", ");", "XMLReader", "xmlReader", "=", "XMLReaderFactory", ".", "createXMLReader", "(", ");", "XMLReader", "xmlReader", "=", "XMLReaderFactory", ".", "createXMLReader", "(", ");", "XMLReader", "xmlReader", "=", "XMLReaderFactory", ".", "createXMLReader", "(", ");", "XMLReader", "xmlReader", "=", "XMLReaderFactory", ".", "createXMLReader", "(", ");", "XMLReader", "xmlReader", "=", "XMLReaderFactory", ".", "createXMLReader", "(", ");", "Transformer", "t", "=", "TransformerFactory", ".", "newInstance", "(", ").", "newTransformer", "(", ");", "SAXParser", "parser", "=", "SAXParserFactory", ".", "newInstance", "(", ").", "newSAXParser", "(", ");", "SAXParser", "parser", "=", "SAXParserFactory", ".", "newInstance", "(", ").", "newSAXParser", "(", ");"], "docstring_tokens": ["cause", "inadvertent", "disclosure", "of", "local", "files", "or", "other", "internal", "content", "."]}
{"contents": ["empty"], "code_tokens": ["err", "=", "pid_ns_prepare_proc", "(", "&", "init_pid_ns", ")", ";", "if", "(", "err", ")", "{", "kern_unmount", "(", "ns", "-", ">", "proc_mnt", ")", ";</s>struct", "vfsmount", "*", "mnt", ";", "mnt", "=", "kern_mount_data", "(", "&", "proc_fs_type", ",", "&", "init_pid_ns", ")", ";", "if", "(", "IS_ERR", "(", "mnt", ")", ")", "{", "init_pid_ns", ".", "proc_mnt", "=", "mnt", ";", "mntput", "(", "ns", "-", ">", "proc_mnt", ")", ";"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(reference", "leak", "and", "memory", "consumption", ")"]}
{"contents": ["empty"], "code_tokens": ["memset", "(", "&", "viainfo", ",", "0", ",", "sizeof", "(", "struct", "viafb_ioctl_info", ")", ");</s>"], "docstring_tokens": ["obtain", "potentially", "sensitive", "information", "from", "kernel", "stack", "memory"]}
{"contents": ["empty"], "code_tokens": ["<", "exclusions", ">", "<", "exclusion", ">", "<", "groupId", ">", "org", ".", "slf4j", "<", "/", "groupId", ">", "<", "artifactId", ">", "slf4j", "-", "log4j12", "<", "/", "artifactId", ">", "<", "/", "exclusion", ">", "<", "exclusion", ">", "<", "groupId", ">", "log4j", "<", "/", "groupId", ">", "<", "artifactId", ">", "log4j", "<", "/", "artifactId", ">", "<", "/", "exclusion", ">", "<", "/", "exclusions", ">", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "net", ".", "URI", ";", "import", "java", ".", "net", ".", "URISyntaxException", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Date", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Objects", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "UUID", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ArrayBlockingQueue", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ConcurrentHashMap", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ConcurrentMap", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ExecutorService", ";", "import", "java", ".", "util", ".", "concurrent", ".", "Executors", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ThreadFactory", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ThreadPoolExecutor", ";", "import", "java", ".", "util", ".", "concurrent", ".", "TimeUnit", ";", "import", "java", ".", "util", ".", "function", ".", "Consumer", ";", "import", "java", ".", "util", ".", "function", ".", "Function", ";", "import", "java", ".", "util", ".", "stream", ".", "Collectors", ";", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletRequest", ";", "import", "javax", ".", "ws", ".", "rs", ".", "Consumes", ";", "import", "javax", ".", "ws", ".", "rs", ".", "DELETE", ";", "import", "javax", ".", "ws", ".", "rs", ".", "DefaultValue", ";", "import", "javax", ".", "ws", ".", "rs", ".", "GET", ";", "import", "javax", ".", "ws", ".", "rs", ".", "HttpMethod", ";", "import", "javax", ".", "ws", ".", "rs", ".", "POST", ";", "import", "javax", ".", "ws", ".", "rs", ".", "PUT", ";", "import", "javax", ".", "ws", ".", "rs", ".", "Path", ";", "import", "javax", ".", "ws", ".", "rs", ".", "PathParam", ";", "import", "javax", ".", "ws", ".", "rs", ".", "Produces", ";", "import", "javax", ".", "ws", ".", "rs", ".", "QueryParam", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Context", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "HttpHeaders", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "MediaType", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "MultivaluedHashMap", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "MultivaluedMap", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Response", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Response", ".", "Status", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "UriBuilder", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "UriInfo", ";", "import", "javax", ".", "xml", ".", "bind", ".", "JAXBContext", ";", "import", "javax", ".", "xml", ".", "bind", ".", "JAXBElement", ";", "import", "javax", ".", "xml", ".", "bind", ".", "JAXBException", ";", "import", "javax", ".", "xml", ".", "bind", ".", "Unmarshaller", ";", "import", "javax", ".", "xml", ".", "stream", ".", "XMLStreamReader", ";", "import", "org", ".", "apache", ".", "commons", ".", "text", ".", "StringEscapeUtils", ";", "return", "desiredState", "!", "=", "ScheduledState", ".", "STOPPED", "|", "|", "status", ".", "getAggregateSnapshot", "(", ").", "getActiveThreadCount", "(", ")", "=", "=", "0", ";", "return", "allProcessorsMatch", ";", "/", "/", "TODO", ":", "Potentially", "refactor", "the", "template", "parsing", "to", "a", "service", "layer", "outside", "of", "the", "resource", "for", "web", "request", "handling", "String", "responseXml", "=", "String", ".", "format", "(", "\"<", "errorResponse", "status", "=", "\\\"", "%", "s", "\\", "\"", "statusText", "=", "\\\"", "%", "s", "\\", "\"/", ">\"", ",", "Response", ".", "Status", ".", "BAD_REQUEST", ".", "getStatusCode", "(", "),", "sanitizeErrorResponse", "(", "iae", ".", "getMessage", "(", "))", ");", "Response", ".", "Status", ".", "INTERNAL_SERVER_ERROR", ".", "getStatusCode", "(", "),", "sanitizeErrorResponse", "(", "e", ".", "getMessage", "(", "))", ");", "/", "**", "*", "Returns", "the", "sanitized", "error", "response", "which", "can", "safely", "be", "displayed", "on", "the", "error", "page", ".", "*", "*", "@", "param", "errorResponse", "the", "initial", "error", "response", "*", "@", "return", "the", "HTML", "-", "escaped", "error", "response", "*", "/", "private", "String", "sanitizeErrorResponse", "(", "String", "errorResponse", ")", "{", "if", "(", "errorResponse", "=", "=", "null", "|", "|", "StringUtils", ".", "isEmpty", "(", "errorResponse", ")", ")", "{", "return", "\"", "\";", "}", "return", "StringEscapeUtils", ".", "escapeHtml4", "(", "errorResponse", ")", ";", "}", "String", "responseXml", "=", "String", ".", "format", "(", "\"<", "errorResponse", "status", "=", "\\\"", "%", "s", "\\", "\"", "statusText", "=", "\\\"", "%", "s", "\\", "\"/", ">\"", ",", "Response", ".", "Status", ".", "BAD_REQUEST", ".", "getStatusCode", "(", "),", "sanitizeErrorResponse", "(", "e", ".", "getMessage", "(", "))", ");", "Response", ".", "Status", ".", "INTERNAL_SERVER_ERROR", ".", "getStatusCode", "(", "),", "sanitizeErrorResponse", "(", "e", ".", "getMessage", "(", "))", ");", "/", "*", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "nifi", ".", "web", ".", "api", "import", "org", ".", "apache", ".", "nifi", ".", "authorization", ".", "AuthorizeAccess", "import", "org", ".", "apache", ".", "nifi", ".", "util", ".", "NiFiProperties", "import", "org", ".", "apache", ".", "nifi", ".", "web", ".", "NiFiServiceFacade", "import", "org", ".", "apache", ".", "nifi", ".", "web", ".", "api", ".", "dto", ".", "FlowSnippetDTO", "import", "org", ".", "apache", ".", "nifi", ".", "web", ".", "api", ".", "dto", ".", "TemplateDTO", "import", "org", ".", "apache", ".", "nifi", ".", "web", ".", "api", ".", "entity", ".", "TemplateEntity", "import", "org", ".", "junit", ".", "After", "import", "org", ".", "junit", ".", "Before", "import", "org", ".", "junit", ".", "BeforeClass", "import", "org", ".", "junit", ".", "Rule", "import", "org", ".", "junit", ".", "Test", "import", "org", ".", "junit", ".", "rules", ".", "TestName", "import", "org", ".", "junit", ".", "runner", ".", "RunWith", "import", "org", ".", "junit", ".", "runners", ".", "JUnit4", "import", "org", ".", "slf4j", ".", "Logger", "import", "org", ".", "slf4j", ".", "LoggerFactory", "import", "javax", ".", "servlet", ".", "http", ".", "HttpServletRequest", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Response", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "UriInfo", "@", "RunWith", "(", "JUnit4", ".", "class", ")", "class", "ProcessGroupResourceTest", "extends", "GroovyTestCase", "{", "private", "static", "final", "Logger", "logger", "=", "LoggerFactory", ".", "getLogger", "(", "ProcessGroupResourceTest", ".", "class", ")", "@", "Rule", "public", "TestName", "testName", "=", "new", "TestName", "(", ")", "@", "BeforeClass", "static", "void", "setUpOnce", "(", ")", "throws", "Exception", "{", "logger", ".", "metaClass", ".", "methodMissing", "=", "{", "String", "name", ",", "args", "-", ">", "logger", ".", "debug", "(", "\"[", "${", "name", "?", ".", "toUpperCase", "(", ")}", "]", "$", "{(", "args", "as", "List", ")", ".", "join", "(", "\"", "\"", ")}", "\")", "}", "}", "@", "Before", "void", "setUp", "(", ")", "throws", "Exception", "{", "}", "@", "After", "void", "tearDown", "(", ")", "throws", "Exception", "{", "}", "/", "**", "This", "test", "creates", "a", "malformed", "template", "upload", "request", "to", "exercise", "error", "handling", "and", "sanitization", "*", "/", "@", "Test", "void", "testUploadShouldHandleMalformedTemplate", "(", ")", "{", "/", "/", "Arrange", "ProcessGroupResource", "pgResource", "=", "new", "ProcessGroupResource", "(", ")", "/", "/", "Mocking", "the", "returned", "template", "object", "to", "throw", "a", "specific", "exception", "would", "be", "nice", "final", "String", "TEMPLATE_WITH_XSS_PLAIN", "=", "\"", "<?", "xml", "version", "=", "\\\"", "1", ".", "0", "\\", "\"", "encoding", "=", "'>", "<", "script", "xmlns", "=", "\\\"", "http", ":", "//", "www", ".", "w3", ".", "org", "/", "1999", "/", "xhtml", "\\", "\">", "alert", "(", "JSON", ".", "stringify", "(", "localstorage", ")", ");", "</", "script", ">", "<", "errorResponse", "test", "=", "'?", ">\"", "logger", ".", "info", "(", "\"", "Malformed", "template", "XML", ":", "$", "{", "TEMPLATE_WITH_XSS_PLAIN", "}", "\")", "InputStream", "contentInputStream", "=", "new", "ByteArrayInputStream", "(", "TEMPLATE_WITH_XSS_PLAIN", ".", "bytes", ")", "HttpServletRequest", "mockRequest", "=", "[", ":]", "as", "HttpServletRequest", "UriInfo", "mockUriInfo", "=", "[", ":]", "as", "UriInfo", "String", "groupId", "=", "\"", "1", "\"", "/", "/", "Build", "a", "malformed", "template", "object", "which", "can", "be", "unmarshalled", "from", "XML", "/", "/", "Act", "/", "/", "Try", "to", "submit", "the", "malformed", "template", "Response", "response", "=", "pgResource", ".", "uploadTemplate", "(", "mockRequest", ",", "mockUriInfo", ",", "groupId", ",", "false", ",", "contentInputStream", ")", "logger", ".", "info", "(", "\"", "Response", ":", "$", "{", "response", "}", "\")", "/", "/", "Assert", "/", "/", "Assert", "that", "the", "expected", "error", "response", "was", "returned", "assert", "response", ".", "status", "=", "=", "Response", ".", "Status", ".", "OK", ".", "statusCode", "/", "/", "Assert", "that", "the", "error", "response", "is", "sanitized", "String", "responseEntity", "=", "response", ".", "entity", "as", "String", "logger", ".", "info", "(", "\"", "Error", "response", ":", "$", "{", "responseEntity", "}", "\")", "assert", "!", "(", "responseEntity", "=", "~", "/", "<", "script", ".", "*>", "/)", "}", "/", "**", "This", "test", "creates", "a", "malformed", "template", "import", "request", "to", "exercise", "error", "handling", "and", "sanitization", "*", "/", "@", "Test", "void", "testImportShouldHandleMalformedTemplate", "(", ")", "{", "/", "/", "Arrange", "ProcessGroupResource", "pgResource", "=", "new", "ProcessGroupResource", "(", ")", "/", "/", "Configure", "parent", "fields", "for", "write", "lock", "process", "pgResource", ".", "properties", "=", "[", "isNode", ":", "{", "-", ">", "return", "false", "}", "]", "as", "NiFiProperties", "pgResource", ".", "serviceFacade", "=", "[", "authorizeAccess", ":", "{", "AuthorizeAccess", "a", "-", ">", "}", ",", "verifyCanAddTemplate", ":", "{", "String", "gid", ",", "String", "templateName", "-", ">", "}", ",", "importTemplate", ":", "{", "TemplateDTO", "template", ",", "String", "gid", ",", "Optional", "<", "String", ">", "seedId", "-", ">", "logger", ".", "mock", "(", "\"", "Called", "importTemplate", ";", "\")", "template", "}", "]", "as", "NiFiServiceFacade", "pgResource", ".", "templateResource", "=", "[", "populateRemainingTemplateContent", ":", "{", "TemplateDTO", "td", "-", ">", "}", "]", "as", "TemplateResource", "final", "String", "TEMPLATE_WITH_XSS_PLAIN", "=", "\"", "<?", "xml", "version", "=", "\\\"", "1", ".", "0", "\\", "\"", "encoding", "=", "'>", "<", "script", "xmlns", "=", "\\\"", "http", ":", "//", "www", ".", "w3", ".", "org", "/", "1999", "/", "xhtml", "\\", "\">", "alert", "(", "JSON", ".", "stringify", "(", "localstorage", ")", ");", "</", "script", ">", "<", "errorResponse", "test", "=", "'?", ">\"", "logger", ".", "info", "(", "\"", "Malformed", "template", "XML", ":", "$", "{", "TEMPLATE_WITH_XSS_PLAIN", "}", "\")", "TemplateDTO", "mockIAETemplate", "=", "[", "getName", ":", "{", "-", ">", "\"", "mockIAETemplate", "\"", "}", ",", "getUri", ":", "{", "-", ">", "throw", "new", "IllegalArgumentException", "(", "\"", "Expected", "exception", "with", "<", "script", ">", "element", "\"", ")", "}", ",", "getSnippet", ":", "{", "-", ">", "new", "FlowSnippetDTO", "(", ")", "}", "]", "as", "TemplateDTO", "TemplateDTO", "mockExceptionTemplate", "=", "[", "getName", ":", "{", "-", ">", "\"", "mockExceptionTemplate", "\"", "}", ",", "getUri", ":", "{", "-", ">", "throw", "new", "RuntimeException", "(", "\"", "Expected", "exception", "with", "<", "script", ">", "element", "\"", ")", "}", ",", "getSnippet", ":", "{", "-", ">", "new", "FlowSnippetDTO", "(", ")", "}", "]", "as", "TemplateDTO", "TemplateEntity", "mockIAETemplateEntity", "=", "[", "getTemplate", ":", "{", "-", ">", "mockIAETemplate", "}", "]", "as", "TemplateEntity", "TemplateEntity", "mockExceptionTemplateEntity", "=", "[", "getTemplate", ":", "{", "-", ">", "mockExceptionTemplate", "}", "]", "as", "TemplateEntity", "/", "/", "Override", "the", "request", "object", "and", "store", "it", "for", "ApplicationResource", "#", "withWriteLock", "HttpServletRequest", "mockRequest", "=", "[", "getHeader", ":", "{", "String", "headerName", "-", ">", "logger", ".", "mock", "(", "\"", "Requesting", "header", "$", "{", "headerName", "}", ";", "returning", "null", "\"", ")", "null", "}", "]", "as", "HttpServletRequest", "/", "/", "Set", "the", "persisted", "request", "object", "so", "the", "parent", "ApplicationResource", "can", "use", "it", "pgResource", ".", "httpServletRequest", "=", "mockRequest", "String", "groupId", "=", "\"", "1", "\"", "/", "/", "Act", "List", "<", "Response", ">", "responses", "=", "[", "mockIAETemplateEntity", ",", "mockExceptionTemplateEntity", "]", ".", "collect", "{", "TemplateEntity", "te", "-", ">", "/", "/", "Try", "to", "submit", "the", "malformed", "template", "which", "throws", "some", "kind", "of", "exception", "Response", "response", "=", "pgResource", ".", "importTemplate", "(", "mockRequest", ",", "groupId", ",", "te", ")", "logger", ".", "info", "(", "\"", "Response", ":", "$", "{", "response", "}", "\")", "response", "}", "/", "/", "Assert", "responses", ".", "each", "{", "Response", "r", "-", ">", "/", "/", "Assert", "that", "the", "expected", "error", "response", "was", "returned", "assert", "r", ".", "status", "=", "=", "Response", ".", "Status", ".", "OK", ".", "statusCode", "/", "/", "Assert", "that", "the", "error", "response", "is", "sanitized", "String", "entity", "=", "r", ".", "entity", "as", "String", "logger", ".", "info", "(", "\"", "Error", "response", ":", "$", "{", "entity", "}", "\")", "assert", "!", "(", "entity", "=", "~", "/", "<", "script", ".", "*>", "/)", "}", "}", "}</s>import", "javax", ".", "servlet", ".", "http", ".", "HttpServletRequest", ";", "import", "javax", ".", "ws", ".", "rs", ".", "Consumes", ";", "import", "javax", ".", "ws", ".", "rs", ".", "DELETE", ";", "import", "javax", ".", "ws", ".", "rs", ".", "DefaultValue", ";", "import", "javax", ".", "ws", ".", "rs", ".", "GET", ";", "import", "javax", ".", "ws", ".", "rs", ".", "HttpMethod", ";", "import", "javax", ".", "ws", ".", "rs", ".", "POST", ";", "import", "javax", ".", "ws", ".", "rs", ".", "PUT", ";", "import", "javax", ".", "ws", ".", "rs", ".", "Path", ";", "import", "javax", ".", "ws", ".", "rs", ".", "PathParam", ";", "import", "javax", ".", "ws", ".", "rs", ".", "Produces", ";", "import", "javax", ".", "ws", ".", "rs", ".", "QueryParam", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Context", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "HttpHeaders", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "MediaType", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "MultivaluedHashMap", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "MultivaluedMap", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Response", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Response", ".", "Status", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "UriBuilder", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "UriInfo", ";", "import", "javax", ".", "xml", ".", "bind", ".", "JAXBContext", ";", "import", "javax", ".", "xml", ".", "bind", ".", "JAXBElement", ";", "import", "javax", ".", "xml", ".", "bind", ".", "JAXBException", ";", "import", "javax", ".", "xml", ".", "bind", ".", "Unmarshaller", ";", "import", "javax", ".", "xml", ".", "stream", ".", "XMLStreamReader", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "io", ".", "InputStream", ";", "import", "java", ".", "net", ".", "URI", ";", "import", "java", ".", "net", ".", "URISyntaxException", ";", "import", "java", ".", "util", ".", "Collection", ";", "import", "java", ".", "util", ".", "Collections", ";", "import", "java", ".", "util", ".", "Date", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Objects", ";", "import", "java", ".", "util", ".", "Set", ";", "import", "java", ".", "util", ".", "UUID", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ArrayBlockingQueue", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ConcurrentHashMap", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ConcurrentMap", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ExecutorService", ";", "import", "java", ".", "util", ".", "concurrent", ".", "Executors", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ThreadFactory", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ThreadPoolExecutor", ";", "import", "java", ".", "util", ".", "concurrent", ".", "TimeUnit", ";", "import", "java", ".", "util", ".", "function", ".", "Consumer", ";", "import", "java", ".", "util", ".", "function", ".", "Function", ";", "import", "java", ".", "util", ".", "stream", ".", "Collectors", ";", "if", "(", "desiredState", "=", "=", "ScheduledState", ".", "STOPPED", "&", "&", "status", ".", "getAggregateSnapshot", "(", ").", "getActiveThreadCount", "(", ")", "!", "=", "0", ")", "{", "return", "false", ";", "}", "return", "true", ";", "if", "(", "!", "allProcessorsMatch", ")", "{", "return", "false", ";", "}", "return", "true", ";", "String", "responseXml", "=", "String", ".", "format", "(", "\"<", "errorResponse", "status", "=", "\\\"", "%", "s", "\\", "\"", "statusText", "=", "\\\"", "%", "s", "\\", "\"/", ">\"", ",", "Response", ".", "Status", ".", "BAD_REQUEST", ".", "getStatusCode", "(", "),", "iae", ".", "getMessage", "(", "))", ";", "Response", ".", "Status", ".", "INTERNAL_SERVER_ERROR", ".", "getStatusCode", "(", "),", "e", ".", "getMessage", "(", "))", ";", "String", "responseXml", "=", "String", ".", "format", "(", "\"<", "errorResponse", "status", "=", "\\\"", "%", "s", "\\", "\"", "statusText", "=", "\\\"", "%", "s", "\\", "\"/", ">\"", ",", "Response", ".", "Status", ".", "BAD_REQUEST", ".", "getStatusCode", "(", "),", "e", ".", "getMessage", "(", "))", ";", "Response", ".", "Status", ".", "INTERNAL_SERVER_ERROR", ".", "getStatusCode", "(", "),", "e", ".", "getMessage", "(", "))", ";"], "docstring_tokens": ["steal", "the", "victim's", "cookie-based", "authentication", "credentials"]}
{"contents": ["empty"], "code_tokens": ["/", "/", "do", "a", "lookup", "of", "the", "user", "to", "trigger", "authentication", "ctx", ".", "lookup", "(", "principal", ".", "toString", "(", ")", ")", ";", "@", "Test", "public", "void", "shouldFailLoginWrongPasswordWithLdapOnlyUsingStartTls", "(", ")", "throws", "Throwable", "{", "getLdapServer", "(", ").", "setConfidentialityRequired", "(", "true", ")", ";", "try", "(", "EmbeddedTestCertificates", "ignore", "=", "new", "EmbeddedTestCertificates", "(", ")", ")", "{", "/", "/", "When", "restartNeo4jServerWithOverriddenSettings", "(", "ldapOnlyAuthSettings", ".", "andThen", "(", "settings", "-", ">", "{", "settings", ".", "put", "(", "SecuritySettings", ".", "ldap_server", ",", "\"", "localhost", ":", "10389", "\"", ")", ";", "settings", ".", "put", "(", "SecuritySettings", ".", "ldap_use_starttls", ",", "\"", "true", "\"", ")", ";", "}", ")", ")", ";", "/", "/", "Then", "assertAuthFail", "(", "\"", "neo", "\"", ",", "\"", "wrong", "\"", ")", ";", "}", "}", "@", "Test", "public", "void", "shouldFailLoginWrongPasswordWithLdapUserContextUsingStartTls", "(", ")", "throws", "Throwable", "{", "getLdapServer", "(", ").", "setConfidentialityRequired", "(", "true", ")", ";", "try", "(", "EmbeddedTestCertificates", "ignore", "=", "new", "EmbeddedTestCertificates", "(", ")", ")", "{", "/", "/", "When", "restartNeo4jServerWithOverriddenSettings", "(", "ldapOnlyAuthSettings", ".", "andThen", "(", "settings", "-", ">", "{", "settings", ".", "put", "(", "SecuritySettings", ".", "ldap_authorization_use_system_account", ",", "\"", "false", "\"", ")", ";", "settings", ".", "put", "(", "SecuritySettings", ".", "ldap_server", ",", "\"", "localhost", ":", "10389", "\"", ")", ";", "settings", ".", "put", "(", "SecuritySettings", ".", "ldap_use_starttls", ",", "\"", "true", "\"", ")", ";", "}", ")", ")", ";", "/", "/", "Then", "assertAuthFail", "(", "\"", "neo", "\"", ",", "\"", "wrong", "\"", ")", ";", "}", "}</s>"], "docstring_tokens": ["bypass", "access", "restrictions"]}
{"contents": ["empty"], "code_tokens": ["int", "err", ";", "mutex_lock", "(", "&", "client", "-", ">", "ioctl_mutex", ")", ";", "err", "=", "snd_seq_pool_init", "(", "client", "-", ">", "pool", ")", ";", "mutex_unlock", "(", "&", "client", "-", ">", "ioctl_mutex", ")", ";", "if", "(", "err", "<", "0", ")", "err", "=", "-", "EINVAL", ";</s>int", "err", "=", "-", "EINVAL", ";", "if", "(", "snd_seq_pool_init", "(", "client", "-", ">", "pool", ")", "<", "0", ")"], "docstring_tokens": ["overflow", "a", "buffer", "and", "execute", "arbitrary", "code", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "updates", "could", "not", "contain", "anything", "about", "the", "private", "*", "protocol", "info", ",", "in", "that", "case", "skip", "the", "parsing", "*", "/", "if", "(", "!", "attr", ")", "return", "0", ";</s>"], "docstring_tokens": ["a", "denial", "of", "service"]}
{"contents": ["empty"], "code_tokens": ["newnp", "-", ">", "ipv6_fl_list", "=", "NULL", ";</s>"], "docstring_tokens": ["crash", "the", "affected", "system"]}
{"contents": ["empty"], "code_tokens": ["#", "include", "<", "linux", "/", "nospec", ".", "h", ">", "ac", "-", ">", "ac_2order", "=", "array_index_nospec", "(", "i", "-", "1", ",", "sb", "-", ">", "s_blocksize_bits", "+", "2", ")", ";</s>ac", "-", ">", "ac_2order", "=", "i", "-", "1", ";"], "docstring_tokens": ["unauthorized", "disclosure", "of", "information", "to", "an", "attacker", "with", "local", "user", "access"]}
{"contents": ["empty"], "code_tokens": ["package", "org", ".", "jboss", ".", "resteasy", ".", "plugins", ".", "providers", ".", "jackson", ";", "import", "com", ".", "fasterxml", ".", "jackson", ".", "databind", ".", "exc", ".", "UnrecognizedPropertyException", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "MediaType", ";", "import", "javax", ".", "ws", ".", "rs", ".", "core", ".", "Response", ";", "import", "javax", ".", "ws", ".", "rs", ".", "ext", ".", "ExceptionMapper", ";", "import", "javax", ".", "ws", ".", "rs", ".", "ext", ".", "Provider", ";", "import", "org", ".", "jboss", ".", "resteasy", ".", "util", ".", "HttpResponseCodes", ";", "/", "**", "*", "(", "RESTEASY", "-", "1485", ")", "Address", "concerns", "of", "a", "possible", "XSS", "attack", "by", "removing", "some", "*", "details", "of", "the", "exception", ".", "*", "*", "User", ":", "rsearls", "*", "Date", ":", "9", "/", "22", "/", "16", "*", "/", "@", "Provider", "public", "class", "UnrecognizedPropertyExceptionHandler", "implements", "ExceptionMapper", "<", "UnrecognizedPropertyException", ">", "{", "@", "Override", "public", "Response", "toResponse", "(", "UnrecognizedPropertyException", "exception", ")", "{", "return", "Response", ".", "status", "(", "HttpResponseCodes", ".", "SC_BAD_REQUEST", ")", ".", "type", "(", "MediaType", ".", "TEXT_HTML", ")", ".", "entity", "(", "exception", ".", "getOriginalMessage", "(", "))", ".", "build", "(", ");", "}", "}", "@", "@", "-", "1", "+", "1", ",", "2", "@", "@", "org", ".", "jboss", ".", "resteasy", ".", "plugins", ".", "providers", ".", "jackson", ".", "UnrecognizedPropertyExceptionHandler", "@", "@", "-", "0", ",", "0", "+", "1", ",", "73", "@", "@", "package", "org", ".", "jboss", ".", "resteasy", ".", "plugins", ".", "interceptors", ".", "encoding", ";", "import", "java", ".", "io", ".", "IOException", ";", "import", "java", ".", "util", ".", "HashMap", ";", "import", "javax", ".", "annotation", ".", "Priority", ";", "import", "javax", ".", "ws", ".", "rs", ".", "Priorities", ";", "import", "javax", ".", "ws", ".", "rs", ".", "container", ".", "ContainerRequestContext", ";", "import", "javax", ".", "ws", ".", "rs", ".", "container", ".", "ContainerResponseContext", ";", "import", "javax", ".", "ws", ".", "rs", ".", "container", ".", "ContainerResponseFilter", ";", "import", "javax", ".", "ws", ".", "rs", ".", "ext", ".", "Provider", ";", "import", "org", ".", "jboss", ".", "resteasy", ".", "util", ".", "HttpResponseCodes", ";", "/", "**", "*", "(", "RESTEASY", "-", "1485", ")", "Thwart", "select", "XSS", "attack", "by", "escaping", "special", "chars", "in", "*", "Exception", "message", ".", "*", "*", "User", ":", "rsearls", "*", "Date", ":", "9", "/", "16", "/", "16", "*", "/", "@", "Provider", "@", "Priority", "(", "Priorities", ".", "ENTITY_CODER", ")", "public", "class", "MessageSanitizerContainerResponseFilter", "implements", "ContainerResponseFilter", "{", "@", "Override", "public", "void", "filter", "(", "ContainerRequestContext", "requestContext", ",", "ContainerResponseContext", "responseContext", ")", "throws", "IOException", "{", "if", "(", "HttpResponseCodes", ".", "SC_BAD_REQUEST", "=", "=", "responseContext", ".", "getStatus", "(", "))", "{", "Object", "entity", "=", "responseContext", ".", "getEntity", "(", ");", "if", "(", "entity", "!", "=", "null", "&", "&", "entity", "instanceof", "String", ")", "{", "String", "escapedMsg", "=", "escapeXml", "(", "(", "String", ")", "entity", ")", ";", "responseContext", ".", "setEntity", "(", "escapedMsg", ")", ";", "}", "}", "}", "/", "/", "set", "of", "replacement", "chars", "to", "hex", "encoding", "private", "static", "final", "HashMap", "<", "String", ",", "String", ">", "replacementMap", ";", "static", "{", "replacementMap", "=", "new", "HashMap", "<", "String", ",", "String", ">", "()", ";", "replacementMap", ".", "put", "(", "\"/", "\",", "\"", "&#", "x2F", ";", "\")", ";", "replacementMap", ".", "put", "(", "\"<", "\",", "\"", "&", "lt", ";", "\")", ";", "replacementMap", ".", "put", "(", "\">", "\",", "\"", "&", "gt", ";", "\")", ";", "replacementMap", ".", "put", "(", "\"&", "\",", "\"", "&", "amp", ";", "\")", ";", "replacementMap", ".", "put", "(", "\"\\", "\"\"", ",", "\"", "&", "quot", ";", "\")", ";", "replacementMap", ".", "put", "(", "\"'", "\",", "\"", "&#", "x27", ";", "\")", ";", "}", "/", "**", "*", "Replace", "char", "with", "the", "hex", "encoding", "*", "@", "param", "str", "*", "@", "return", "*", "/", "private", "String", "escapeXml", "(", "String", "str", ")", "{", "StringBuilder", "sb", "=", "new", "StringBuilder", "(", ");", "if", "(", "!", "str", ".", "isEmpty", "(", "))", "{", "/", "/", "the", "vertical", "bar", ",", "|", ",", "is", "a", "special", "regular", "expression", "char", "that", "/", "/", "causes", "splitting", "on", "individual", "characters", ".", "for", "(", "String", "key", ":", "str", ".", "split", "(", "\"|", "\")", ")", "{", "String", "value", "=", "replacementMap", ".", "get", "(", "key", ")", ";", "if", "(", "value", "=", "=", "null", ")", "{", "sb", ".", "append", "(", "key", ")", ";", "}", "else", "{", "sb", ".", "append", "(", "value", ")", ";", "}", "}", "}", "return", "sb", ".", "toString", "(", ");", "}", "}", "@", "@", "-", "16", ",", "5", "+", "16", ",", "6", "@", "@", "org", ".", "jboss", ".", "resteasy", ".", "plugins", ".", "providers", ".", "IIOImageProvider", "org", ".", "jboss", ".", "resteasy", ".", "plugins", ".", "interceptors", ".", "encoding", ".", "MessageSanitizerContainerResponseFilter", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "Concatenation", "of", "s", "and", "t", "must", "have", "length", "&", "gt", ";", "5", "\"", ",", "violation", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "\"", "Exception", "has", "wrong", "message", "\"", ",", "\"", "Concatenation", "of", "s", "and", "t", "must", "have", "length", "&", "gt", ";", "5", "\"", ",", "cv", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "\"", "Exception", "has", "wrong", "message", "\"", ",", "\"", "s", "must", "have", "length", ":", "3", "&", "lt", ";", "=", "length", "&", "lt", ";", "=", "5", "\"", ",", "cv", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "Concatenation", "of", "s", "and", "t", "must", "have", "length", "&", "gt", ";", "5", "\"", ",", "cv", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "ValidationComplexResourceWithClassConstraint", "(", "&", "quot", ";", "a", "&", "quot", ";", ",", "&", "quot", ";", "b", "&", "quot", ";", ")\"", ",", "cv", ".", "getValue", "(", "))", ";", "Assert", ".", "assertTrue", "(", "WRONG_ERROR_MSG", ",", "cv", ".", "getMessage", "(", ").", "equals", "(", "\"", "s", "must", "have", "length", ":", "1", "&", "lt", ";", "=", "length", "&", "lt", ";", "=", "3", "\"", "))", ";", "Assert", ".", "assertTrue", "(", "WRONG_ERROR_MSG", ",", "cv", ".", "getMessage", "(", ").", "equals", "(", "\"", "s", "must", "have", "length", ":", "3", "&", "lt", ";", "=", "length", "&", "lt", ";", "=", "5", "\"", "))", ";", "Assert", ".", "assertTrue", "(", "WRONG_ERROR_MSG", ",", "cv1", ".", "getMessage", "(", ").", "equals", "(", "\"", "s", "must", "have", "length", ":", "1", "&", "lt", ";", "=", "length", "&", "lt", ";", "=", "3", "\"", "))", ";", "Assert", ".", "assertTrue", "(", "WRONG_ERROR_MSG", ",", "cv2", ".", "getMessage", "(", ").", "equals", "(", "\"", "s", "must", "have", "length", ":", "3", "&", "lt", ";", "=", "length", "&", "lt", ";", "=", "5", "\"", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "Concatenation", "of", "s", "and", "t", "must", "have", "length", "&", "gt", ";", "5", "\"", ",", "cv", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "s", "must", "have", "length", ":", "3", "&", "lt", ";", "=", "length", "&", "lt", ";", "=", "5", "\"", ",", "cv", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "Concatenation", "of", "s", "and", "t", "must", "have", "length", "&", "gt", ";", "5", "\"", ",", "cv", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "Concatenation", "of", "s", "and", "t", "must", "have", "length", "&", "gt", ";", "5", "\"", ",", "cv", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "s", "must", "have", "length", ":", "3", "&", "lt", ";", "=", "length", "&", "lt", ";", "=", "5", "\"", ",", "cv", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "Parameters", "must", "total", "&", "lt", ";", "=", "7", "\"", ",", "violation", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "Concatenation", "of", "s", "and", "t", "must", "have", "length", "&", "gt", ";", "5", "\"", ",", "violation", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "s", "must", "have", "length", ":", "3", "&", "lt", ";", "=", "length", "&", "lt", ";", "=", "5", "\"", ",", "violation", ".", "getMessage", "(", "))", ";", "\"", "[", "Concatenation", "of", "s", "and", "u", "must", "have", "length", "&", "gt", ";", "5", "]", "\\", "r", "\"", "\"", "[", "s", "must", "have", "length", ":", "3", "&", "lt", ";", "=", "length", "&", "lt", ";", "=", "5", "]", "\\", "r", "\"", "Assert", ".", "assertThat", "(", "\"", "Wrong", "content", "of", "response", "\"", ",", "entity", ",", "containsString", "(", "\"", "http", ":", "&#", "x2F", ";", "&#", "x2F", ";", "apache", ".", "org", "&", "#", "x2F", ";", "xml", "&", "#", "x2F", ";", "features", "&", "#", "x2F", ";", "disallow", "-", "doctype", "-", "decl", "\"", "))", ";", "Assert", ".", "assertThat", "(", "\"", "Wrong", "content", "of", "response", "\"", ",", "entity", ",", "containsString", "(", "\"", "http", ":", "&#", "x2F", ";", "&#", "x2F", ";", "apache", ".", "org", "&", "#", "x2F", ";", "xml", "&", "#", "x2F", ";", "features", "&", "#", "x2F", ";", "disallow", "-", "doctype", "-", "decl", "\"", "))", ";</s>Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "Concatenation", "of", "s", "and", "t", "must", "have", "length", ">", "5", "\"", ",", "violation", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "\"", "Exception", "has", "wrong", "message", "\"", ",", "\"", "Concatenation", "of", "s", "and", "t", "must", "have", "length", ">", "5", "\"", ",", "cv", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "\"", "Exception", "has", "wrong", "message", "\"", ",", "\"", "s", "must", "have", "length", ":", "3", "<", "=", "length", "<", "=", "5", "\"", ",", "cv", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "Concatenation", "of", "s", "and", "t", "must", "have", "length", ">", "5", "\"", ",", "cv", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "ValidationComplexResourceWithClassConstraint", "(", "\\\"", "a", "\\", "\",", "\\", "\"", "b", "\\", "\")", "\",", "cv", ".", "getValue", "(", "))", ";", "Assert", ".", "assertTrue", "(", "WRONG_ERROR_MSG", ",", "cv", ".", "getMessage", "(", ").", "equals", "(", "\"", "s", "must", "have", "length", ":", "1", "<", "=", "length", "<", "=", "3", "\"", "))", ";", "Assert", ".", "assertTrue", "(", "WRONG_ERROR_MSG", ",", "cv", ".", "getMessage", "(", ").", "equals", "(", "\"", "s", "must", "have", "length", ":", "3", "<", "=", "length", "<", "=", "5", "\"", "))", ";", "Assert", ".", "assertTrue", "(", "WRONG_ERROR_MSG", ",", "cv1", ".", "getMessage", "(", ").", "equals", "(", "\"", "s", "must", "have", "length", ":", "1", "<", "=", "length", "<", "=", "3", "\"", "))", ";", "Assert", ".", "assertTrue", "(", "WRONG_ERROR_MSG", ",", "cv2", ".", "getMessage", "(", ").", "equals", "(", "\"", "s", "must", "have", "length", ":", "3", "<", "=", "length", "<", "=", "5", "\"", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "Concatenation", "of", "s", "and", "t", "must", "have", "length", ">", "5", "\"", ",", "cv", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "s", "must", "have", "length", ":", "3", "<", "=", "length", "<", "=", "5", "\"", ",", "cv", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "Concatenation", "of", "s", "and", "t", "must", "have", "length", ">", "5", "\"", ",", "cv", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "Concatenation", "of", "s", "and", "t", "must", "have", "length", ">", "5", "\"", ",", "cv", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "s", "must", "have", "length", ":", "3", "<", "=", "length", "<", "=", "5", "\"", ",", "cv", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "Parameters", "must", "total", "<", "=", "7", "\"", ",", "violation", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "Concatenation", "of", "s", "and", "t", "must", "have", "length", ">", "5", "\"", ",", "violation", ".", "getMessage", "(", "))", ";", "Assert", ".", "assertEquals", "(", "WRONG_ERROR_MSG", ",", "\"", "s", "must", "have", "length", ":", "3", "<", "=", "length", "<", "=", "5", "\"", ",", "violation", ".", "getMessage", "(", "))", ";", "\"", "[", "Concatenation", "of", "s", "and", "u", "must", "have", "length", ">", "5", "]", "\\", "r", "\"", "+", "\"", "[", "s", "must", "have", "length", ":", "3", "<", "=", "length", "<", "=", "5", "]", "\\", "r", "\"", "+", "Assert", ".", "assertThat", "(", "\"", "Wrong", "content", "of", "response", "\"", ",", "entity", ",", "containsString", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", "))", ";", "Assert", ".", "assertThat", "(", "\"", "Wrong", "content", "of", "response", "\"", ",", "entity", ",", "containsString", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", "))", ";"], "docstring_tokens": ["steal", "the", "victim's", "cookie-based", "authentication", "credentials"]}
{"contents": ["empty"], "code_tokens": ["#", "include", "<", "linux", "/", "cred", ".", "h", ">", "/", "*", "for", "sg_check_file_access", "(", ")", "*", "/", "/", "*", "*", "The", "SCSI", "interfaces", "that", "use", "read", "(", ")", "and", "write", "(", ")", "as", "an", "asynchronous", "variant", "of", "*", "ioctl", "(", "..", ".,", "SG_IO", ",", ".", "..", ")", "are", "fundamentally", "unsafe", ",", "since", "there", "are", "lots", "of", "ways", "*", "to", "trigger", "read", "(", ")", "and", "write", "(", ")", "calls", "from", "various", "contexts", "with", "elevated", "*", "privileges", ".", "This", "can", "lead", "to", "kernel", "memory", "corruption", "(", "e", ".", "g", ".", "if", "these", "*", "interfaces", "are", "called", "through", "splice", "(", "))", "and", "privilege", "escalation", "inside", "*", "userspace", "(", "e", ".", "g", ".", "if", "a", "process", "with", "access", "to", "such", "a", "device", "passes", "a", "file", "*", "descriptor", "to", "a", "SUID", "binary", "as", "stdin", "/", "stdout", "/", "stderr", ")", ".", "*", "*", "This", "function", "provides", "protection", "for", "the", "legacy", "API", "by", "restricting", "the", "*", "calling", "context", ".", "*", "/", "static", "int", "sg_check_file_access", "(", "struct", "file", "*", "filp", ",", "const", "char", "*", "caller", ")", "{", "if", "(", "filp", "-", ">", "f_cred", "!", "=", "current_real_cred", "(", "))", "{", "pr_err_once", "(", "\"%", "s", ":", "process", "%", "d", "(", "%", "s", ")", "changed", "security", "contexts", "after", "opening", "file", "descriptor", ",", "this", "is", "not", "allowed", ".", "\\", "n", "\"", ",", "caller", ",", "task_tgid_vnr", "(", "current", ")", ",", "current", "-", ">", "comm", ")", ";", "return", "-", "EPERM", ";", "}", "if", "(", "uaccess_kernel", "(", "))", "{", "pr_err_once", "(", "\"%", "s", ":", "process", "%", "d", "(", "%", "s", ")", "called", "from", "kernel", "context", ",", "this", "is", "not", "allowed", ".", "\\", "n", "\"", ",", "caller", ",", "task_tgid_vnr", "(", "current", ")", ",", "current", "-", ">", "comm", ")", ";", "return", "-", "EACCES", ";", "}", "return", "0", ";", "}", "/", "*", "*", "This", "could", "cause", "a", "response", "to", "be", "stranded", ".", "Close", "the", "associated", "*", "file", "descriptor", "to", "free", "up", "any", "resources", "being", "held", ".", "*", "/", "retval", "=", "sg_check_file_access", "(", "filp", ",", "__func__", ")", ";", "if", "(", "retval", ")", "return", "retval", ";", "int", "retval", ";", "retval", "=", "sg_check_file_access", "(", "filp", ",", "__func__", ")", ";", "if", "(", "retval", ")", "return", "retval", ";</s>if", "(", "unlikely", "(", "uaccess_kernel", "(", "))", ")", "return", "-", "EINVAL", ";"], "docstring_tokens": ["gain", "elevated", "privileges"]}
{"contents": ["empty"], "code_tokens": ["import", "javax", ".", "net", ".", "ssl", ".", "SSLParameters", ";", "SSLEngine", "sslEngine", "=", "createSSLEngine", "(", "userProperties", ",", "host", ",", "port", ")", ";", "private", "SSLEngine", "createSSLEngine", "(", "Map", "<", "String", ",", "Object", ">", "userProperties", ",", "String", "host", ",", "int", "port", ")", "SSLEngine", "engine", "=", "sslContext", ".", "createSSLEngine", "(", "host", ",", "port", ")", ";", "/", "/", "Enable", "host", "verification", "/", "/", "Start", "with", "current", "settings", "(", "returns", "a", "copy", ")", "SSLParameters", "sslParams", "=", "engine", ".", "getSSLParameters", "(", ");", "/", "/", "Use", "HTTPS", "since", "WebSocket", "starts", "over", "HTTP", "(", "S", ")", "sslParams", ".", "setEndpointIdentificationAlgorithm", "(", "\"", "HTTPS", "\"", ");", "/", "/", "Write", "the", "parameters", "back", "engine", ".", "setSSLParameters", "(", "sslParams", ")", ";", "<", "fix", ">", "Enable", "host", "name", "verification", "when", "using", "TLS", "with", "the", "WebSocket", "client", ".", "(", "markt", ")", "<", "/", "fix", ">", "<", "p", ">", "If", "the", "<", "code", ">", "org", ".", "apache", ".", "tomcat", ".", "websocket", ".", "SSL_CONTEXT", "<", "/", "code", ">", "property", "is", "set", "then", "the", "<", "code", ">", "org", ".", "apache", ".", "tomcat", ".", "websocket", ".", "SSL_TRUSTSTORE", "<", "/", "code", ">", "and", "<", "code", ">", "org", ".", "apache", ".", "tomcat", ".", "websocket", ".", "SSL_TRUSTSTORE_PWD", "<", "/", "code", ">", "properties", "will", "be", "ignored", ".", "</", "p", ">", "<", "p", ">", "For", "secure", "server", "end", "points", ",", "host", "name", "verification", "is", "enabled", "by", "default", ".", "To", "bypass", "this", "verification", "(", "not", "recommended", ")", ",", "it", "is", "necessary", "to", "provide", "a", "custom", "<", "code", ">", "SSLContext", "<", "/", "code", ">", "via", "the", "<", "code", ">", "org", ".", "apache", ".", "tomcat", ".", "websocket", ".", "SSL_CONTEXT", "<", "/", "code", ">", "user", "property", ".", "The", "custom", "<", "code", ">", "SSLContext", "<", "/", "code", ">", "must", "be", "configured", "with", "a", "custom", "<", "code", ">", "TrustManager", "<", "/", "code", ">", "that", "extends", "<", "code", ">", "javax", ".", "net", ".", "ssl", ".", "X509ExtendedTrustManager", "<", "/", "code", ">", ".", "The", "desired", "verification", "(", "or", "lack", "of", "verification", ")", "can", "then", "be", "controlled", "by", "appropriate", "implementations", "of", "the", "individual", "abstract", "methods", ".", "</", "p", "></s>SSLEngine", "sslEngine", "=", "createSSLEngine", "(", "userProperties", ")", ";", "private", "SSLEngine", "createSSLEngine", "(", "Map", "<", "String", ",", "Object", ">", "userProperties", ")", "SSLEngine", "engine", "=", "sslContext", ".", "createSSLEngine", "(", ");", "<", "p", ">", "If", "the", "<", "code", ">", "org", ".", "apache", ".", "tomcat", ".", "websocket", ".", "SSL_CONTEXT", "<", "/", "code", ">", "property", "is", "set", "then", "the", "<", "code", ">", "org", ".", "apache", ".", "tomcat", ".", "websocket", ".", "SSL_TRUSTSTORE", "<", "/", "code", ">", "and", "<", "code", ">", "org", ".", "apache", ".", "tomcat", ".", "websocket", ".", "SSL_TRUSTSTORE_PWD", "<", "/", "code", ">", "properties", "will", "be", "ignored", ".", "</", "p", ">"], "docstring_tokens": ["bypass", "security", "constraints", "to", "access", "restricted", "resources"]}
{"contents": ["empty"], "code_tokens": ["static", "void", "pwc_iso_stop", "(", "struct", "pwc_device", "*", "pdev", ")", "PWC_DEBUG_MEMORY", "(", "\"", "Unlinking", "URB", "%", "p", "\\", "n", "\"", ",", "urb", ")", ";", "usb_kill_urb", "(", "urb", ")", ";", "}", "}", "}", "static", "void", "pwc_iso_free", "(", "struct", "pwc_device", "*", "pdev", ")", "{", "int", "i", ";", "/", "*", "Freeing", "ISOC", "buffers", "one", "by", "one", "*", "/", "for", "(", "i", "=", "0", ";", "i", "<", "MAX_ISO_BUFS", ";", "i", "+", "+)", "{", "struct", "urb", "*", "urb", ";", "urb", "=", "pdev", "-", ">", "sbuf", "[", "i", "]", ".", "urb", ";", "if", "(", "urb", "!", "=", "0", ")", "{", "}", "void", "pwc_isoc_cleanup", "(", "struct", "pwc_device", "*", "pdev", ")", "{", "PWC_DEBUG_OPEN", "(", "\">", ">", "pwc_isoc_cleanup", "(", ")\\", "n", "\"", ");", "if", "(", "pdev", "=", "=", "NULL", ")", "return", ";", "if", "(", "pdev", "-", ">", "iso_init", "=", "=", "0", ")", "return", ";", "pwc_iso_stop", "(", "pdev", ")", ";", "pwc_iso_free", "(", "pdev", ")", ";", "lock_kernel", "(", ");", "int", "bytes_to_read", ",", "rv", "=", "0", ";", "mutex_lock", "(", "&", "pdev", "-", ">", "modlock", ")", ";", "if", "(", "pdev", "-", ">", "error_status", ")", "{", "rv", "=", "-", "pdev", "-", ">", "error_status", ";", "/", "*", "Something", "happened", ",", "report", "what", ".", "*", "/", "goto", "err_out", ";", "}", "rv", "=", "-", "pdev", "-", ">", "error_status", ";", "goto", "err_out", ";", "rv", "=", "-", "EWOULDBLOCK", ";", "goto", "err_out", ";", "rv", "=", "-", "ERESTARTSYS", ";", "goto", "err_out", ";", "if", "(", "pwc_handle_frame", "(", "pdev", ")", ")", "{", "rv", "=", "-", "EFAULT", ";", "goto", "err_out", ";", "}", "if", "(", "copy_to_user", "(", "buf", ",", "image_buffer_addr", ",", "count", ")", ")", "{", "rv", "=", "-", "EFAULT", ";", "goto", "err_out", ";", "}", "mutex_unlock", "(", "&", "pdev", "-", ">", "modlock", ")", ";", "err_out", ":", "mutex_unlock", "(", "&", "pdev", "-", ">", "modlock", ")", ";", "return", "rv", ";", "struct", "video_device", "*", "vdev", "=", "file", "-", ">", "private_data", ";", "struct", "pwc_device", "*", "pdev", ";", "int", "r", "=", "-", "ENODEV", ";", "if", "(", "!", "vdev", ")", "goto", "out", ";", "pdev", "=", "vdev", "-", ">", "priv", ";", "mutex_lock", "(", "&", "pdev", "-", ">", "modlock", ")", ";", "if", "(", "!", "pdev", "-", ">", "unplugged", ")", "r", "=", "video_usercopy", "(", "inode", ",", "file", ",", "cmd", ",", "arg", ",", "pwc_video_do_ioctl", ")", ";", "mutex_unlock", "(", "&", "pdev", "-", ">", "modlock", ")", ";", "out", ":", "return", "r", ";", "mutex_lock", "(", "&", "pdev", "-", ">", "modlock", ")", ";", "mutex_unlock", "(", "&", "pdev", "-", ">", "modlock", ")", ";", "pwc_iso_stop", "(", "pdev", ")", ";</s>void", "pwc_isoc_cleanup", "(", "struct", "pwc_device", "*", "pdev", ")", "PWC_DEBUG_OPEN", "(", "\">", ">", "pwc_isoc_cleanup", "(", ")\\", "n", "\"", ");", "if", "(", "pdev", "=", "=", "NULL", ")", "return", ";", "if", "(", "pdev", "-", ">", "iso_init", "=", "=", "0", ")", "return", ";", "if", "(", "pdev", "-", ">", "iso_init", ")", "{", "PWC_DEBUG_MEMORY", "(", "\"", "Unlinking", "URB", "%", "p", "\\", "n", "\"", ",", "urb", ")", ";", "usb_kill_urb", "(", "urb", ")", ";", "}", "lock_kernel", "(", ");", "int", "bytes_to_read", ";", "if", "(", "pdev", "-", ">", "error_status", ")", "return", "-", "pdev", "-", ">", "error_status", ";", "/", "*", "Something", "happened", ",", "report", "what", ".", "*", "/", "return", "-", "pdev", "-", ">", "error_status", ";", "return", "-", "EWOULDBLOCK", ";", "return", "-", "ERESTARTSYS", ";", "if", "(", "pwc_handle_frame", "(", "pdev", ")", ")", "return", "-", "EFAULT", ";", "if", "(", "copy_to_user", "(", "buf", ",", "image_buffer_addr", ",", "count", ")", ")", "return", "-", "EFAULT", ";", "return", "video_usercopy", "(", "inode", ",", "file", ",", "cmd", ",", "arg", ",", "pwc_video_do_ioctl", ")", ";"], "docstring_tokens": ["resulting", "in", "a", "denial", "of", "service"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "nb", ":", "there", "'", "s", "a", "4", "-", "byte", "hole", "here", "*", "/", "}", "else", "if", "(", "addr", "<", "(", "addr_t", ")", "&", "dummy", "-", ">", "regs", ".", "fp_regs", ")", "{", "/", "*", "*", "prevent", "reads", "of", "padding", "hole", "between", "*", "orig_gpr2", "and", "fp_regs", "on", "s390", ".", "*", "/", "tmp", "=", "0", ";", "}", "else", "if", "(", "addr", "<", "(", "addr_t", ")", "&", "dummy", "-", ">", "regs", ".", "fp_regs", ")", "{", "/", "*", "*", "prevent", "writes", "of", "padding", "hole", "between", "*", "orig_gpr2", "and", "fp_regs", "on", "s390", ".", "*", "/", "return", "0", ";", "}", "else", "if", "(", "addr", "<", "(", "addr_t", ")", "&", "dummy32", "-", ">", "regs", ".", "fp_regs", ")", "{", "/", "*", "*", "prevent", "reads", "of", "padding", "hole", "between", "*", "orig_gpr2", "and", "fp_regs", "on", "s390", ".", "*", "/", "tmp", "=", "0", ";", "}", "else", "if", "(", "addr", "<", "(", "addr_t", ")", "&", "dummy32", "-", ">", "regs", ".", "fp_regs", ")", "{", "/", "*", "*", "prevent", "writess", "of", "padding", "hole", "between", "*", "orig_gpr2", "and", "fp_regs", "on", "s390", ".", "*", "/", "return", "0", ";</s>"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(kernel", "panic", ")"]}
{"contents": ["empty"], "code_tokens": ["CDV_EXEC_LOG", "(", "@\"", "Exec", ":", "Flushed", "JS", "-", ">", "native", "queue", "(", "hadCommands", "=", "%", "d", ")", ".\"", ",", "[", "batchJSON", "length", "]", ">", "0", ")", ";", "if", "(", "[[", "url", "fragment", "]", "hasPrefix", ":", "@\"", "%", "01", "\"", "])", "{", "NSString", "*", "inlineCommands", "=", "[", "[", "url", "fragment", "]", "substringFromIndex", ":", "3", "]", ";", "if", "(", "[", "inlineCommands", "length", "]", "=", "=", "0", ")", "{", "[", "_commandQueue", "fetchCommandsFromJs", "]", ";", "}", "else", "{", "inlineCommands", "=", "[", "inlineCommands", "stringByRemovingPercentEncoding", "]", ";", "[", "_commandQueue", "enqueueCommandBatch", ":", "inlineCommands", "]", ";", "}", "return", "NO", ";", "}</s>-", "(", "void", ")", "enqueueCommandBatch", ":", "(", "NSString", "*", ")", "batchJSON", "CDV_EXEC_LOG", "(", "@\"", "Exec", ":", "Flushed", "JS", "-", ">", "native", "queue", "(", "hadCommands", "=", "%", "d", ")", ".\"", ",", "[", "queuedCommandsJSON", "length", "]", ">", "0", ")", ";"], "docstring_tokens": ["bypass", "intended", "device-resource", "restrictions", "of", "an", "event-based", "bridge"]}
{"contents": ["empty"], "code_tokens": ["@", "UriParam", "(", "label", "=", "\"", "producer", "\"", ",", "defaultValue", "=", "\"", "true", "\"", ")", "protected", "boolean", "jailStartingDirectory", "=", "true", ";", "public", "boolean", "isJailStartingDirectory", "(", ")", "{", "return", "jailStartingDirectory", ";", "}", "/", "**", "*", "Used", "for", "jailing", "(", "restricting", ")", "writing", "files", "to", "the", "starting", "directory", "(", "and", "sub", ")", "only", ".", "*", "This", "is", "enabled", "by", "default", "to", "not", "allow", "Camel", "to", "write", "files", "to", "outside", "directories", "(", "to", "be", "more", "secured", "out", "of", "the", "box", ")", ".", "*", "You", "can", "turn", "this", "off", "to", "allow", "writing", "files", "to", "directories", "outside", "the", "starting", "directory", ",", "such", "as", "parent", "or", "root", "folders", ".", "*", "/", "public", "void", "setJailStartingDirectory", "(", "boolean", "jailStartingDirectory", ")", "{", "this", ".", "jailStartingDirectory", "=", "jailStartingDirectory", ";", "}", "import", "org", ".", "apache", ".", "camel", ".", "CamelExchangeException", ";", "if", "(", "value", "instanceof", "String", "&", "&", "StringHelper", ".", "hasStartToken", "(", "(", "String", ")", "value", ",", "\"", "simple", "\"", "))", "{", "if", "(", "endpoint", ".", "isJailStartingDirectory", "(", "))", "{", "/", "/", "check", "for", "file", "must", "be", "within", "starting", "directory", "(", "need", "to", "compact", "first", "as", "the", "name", "can", "be", "using", "relative", "paths", "via", ".", "./", "etc", ")", "String", "compatchAnswer", "=", "FileUtil", ".", "compactPath", "(", "answer", ")", ";", "String", "compatchBaseDir", "=", "FileUtil", ".", "compactPath", "(", "baseDir", ")", ";", "if", "(", "!", "compatchAnswer", ".", "startsWith", "(", "compatchBaseDir", ")", ")", "{", "throw", "new", "IllegalArgumentException", "(", "\"", "Cannot", "write", "file", "with", "name", ":", "\"", "+", "compatchAnswer", "+", "\"", "as", "the", "filename", "is", "jailed", "to", "the", "starting", "directory", ":", "\"", "+", "compatchBaseDir", ")", ";", "}", "}", "template", ".", "sendBody", "(", "\"", "file", ":", "//", "target", "/", "filelanguage", "?", "jailStartingDirectory", "=", "false", "&", "fileName", "=", "\"", "+", "expression", ",", "\"", "Hello", "World", "\"", ");", "/", "**", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "camel", ".", "component", ".", "file", ";", "import", "org", ".", "apache", ".", "camel", ".", "ContextTestSupport", ";", "import", "org", ".", "apache", ".", "camel", ".", "Exchange", ";", "import", "org", ".", "apache", ".", "camel", ".", "builder", ".", "RouteBuilder", ";", "import", "org", ".", "apache", ".", "camel", ".", "component", ".", "mock", ".", "MockEndpoint", ";", "import", "org", ".", "junit", ".", "Before", ";", "import", "org", ".", "junit", ".", "Test", ";", "public", "class", "FileProducerJailStartingDirectoryTest", "extends", "ContextTestSupport", "{", "@", "Override", "@", "Before", "public", "void", "setUp", "(", ")", "throws", "Exception", "{", "deleteDirectory", "(", "\"", "target", "/", "jail", "\"", ");", "super", ".", "setUp", "(", ");", "}", "@", "Test", "public", "void", "testWriteOutsideStartingDirectory", "(", ")", "throws", "Exception", "{", "MockEndpoint", "mock", "=", "getMockEndpoint", "(", "\"", "mock", ":", "result", "\"", ");", "mock", ".", "expectedMessageCount", "(", "0", ")", ";", "try", "{", "template", ".", "sendBodyAndHeader", "(", "\"", "direct", ":", "start", "\"", ",", "\"", "Hello", "World", "\"", ",", "Exchange", ".", "FILE_NAME", ",", "\"", "hello", ".", "txt", "\"", ");", "fail", "(", "\"", "Should", "have", "thrown", "exception", "\"", ");", "}", "catch", "(", "Exception", "e", ")", "{", "IllegalArgumentException", "iae", "=", "assertIsInstanceOf", "(", "IllegalArgumentException", ".", "class", ",", "e", ".", "getCause", "(", "))", ";", "assertTrue", "(", "iae", ".", "getMessage", "(", ").", "contains", "(", "\"", "as", "the", "filename", "is", "jailed", "to", "the", "starting", "directory", "\"", "))", ";", "}", "assertMockEndpointsSatisfied", "(", ");", "}", "@", "Test", "public", "void", "testWriteInsideStartingDirectory", "(", ")", "throws", "Exception", "{", "MockEndpoint", "mock", "=", "getMockEndpoint", "(", "\"", "mock", ":", "result", "\"", ");", "mock", ".", "expectedMessageCount", "(", "1", ")", ";", "template", ".", "sendBodyAndHeader", "(", "\"", "direct", ":", "start", "\"", ",", "\"", "Bye", "World", "\"", ",", "Exchange", ".", "FILE_NAME", ",", "\"", "outbox", "/", "bye", ".", "txt", "\"", ");", "assertMockEndpointsSatisfied", "(", ");", "}", "@", "Override", "protected", "RouteBuilder", "createRouteBuilder", "(", ")", "throws", "Exception", "{", "return", "new", "RouteBuilder", "(", ")", "{", "@", "Override", "public", "void", "configure", "(", ")", "throws", "Exception", "{", "from", "(", "\"", "direct", ":", "start", "\"", ")", ".", "setHeader", "(", "Exchange", ".", "FILE_NAME", ",", "simple", "(", "\".", "./", "${", "file", ":", "name", "}", "\")", ")", ".", "to", "(", "\"", "file", ":", "target", "/", "jail", "/", "outbox", "\"", ")", ".", "to", "(", "\"", "mock", ":", "result", "\"", ");", "}", "}", ";", "}", "}", "@", "@", "-", "85", ",", "7", "+", "85", ",", "7", "@", "@", "public", "void", "testProducerDateByExpression", "(", ")", "throws", "Exception", "{", "String", "url", "=", "\"", "ftp", ":", "//", "admin", "@", "localhost", ":", "\"", "+", "getPort", "(", ")", "+", "\"", "/", "filelanguage", "/", "foo", "?", "password", "=", "admin", "&", "jailStartingDirectory", "=", "false", "\"", ";", "/", "**", "*", "Licensed", "to", "the", "Apache", "Software", "Foundation", "(", "ASF", ")", "under", "one", "or", "more", "*", "contributor", "license", "agreements", ".", "See", "the", "NOTICE", "file", "distributed", "with", "*", "this", "work", "for", "additional", "information", "regarding", "copyright", "ownership", ".", "*", "The", "ASF", "licenses", "this", "file", "to", "You", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "*", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "*", "/", "package", "org", ".", "apache", ".", "camel", ".", "component", ".", "file", ".", "remote", ";", "import", "org", ".", "apache", ".", "camel", ".", "Exchange", ";", "import", "org", ".", "apache", ".", "camel", ".", "builder", ".", "RouteBuilder", ";", "import", "org", ".", "apache", ".", "camel", ".", "component", ".", "mock", ".", "MockEndpoint", ";", "import", "org", ".", "junit", ".", "Test", ";", "public", "class", "FtpProducerJailStartingDirectoryTest", "extends", "FtpServerTestSupport", "{", "private", "String", "getFtpUrl", "(", ")", "{", "return", "\"", "ftp", ":", "//", "admin", "@", "localhost", ":", "\"", "+", "getPort", "(", ")", "+", "\"", "/", "upload", "/", "jail", "?", "binary", "=", "false", "&", "password", "=", "admin", "&", "tempPrefix", "=", ".", "uploading", "\"", ";", "}", "@", "Test", "public", "void", "testWriteOutsideStartingDirectory", "(", ")", "throws", "Exception", "{", "MockEndpoint", "mock", "=", "getMockEndpoint", "(", "\"", "mock", ":", "result", "\"", ");", "mock", ".", "expectedMessageCount", "(", "0", ")", ";", "try", "{", "template", ".", "sendBodyAndHeader", "(", "\"", "direct", ":", "start", "\"", ",", "\"", "Hello", "World", "\"", ",", "Exchange", ".", "FILE_NAME", ",", "\"", "hello", ".", "txt", "\"", ");", "fail", "(", "\"", "Should", "have", "thrown", "exception", "\"", ");", "}", "catch", "(", "Exception", "e", ")", "{", "IllegalArgumentException", "iae", "=", "assertIsInstanceOf", "(", "IllegalArgumentException", ".", "class", ",", "e", ".", "getCause", "(", "))", ";", "assertTrue", "(", "iae", ".", "getMessage", "(", ").", "contains", "(", "\"", "as", "the", "filename", "is", "jailed", "to", "the", "starting", "directory", "\"", "))", ";", "}", "assertMockEndpointsSatisfied", "(", ");", "}", "@", "Test", "public", "void", "testWriteInsideStartingDirectory", "(", ")", "throws", "Exception", "{", "MockEndpoint", "mock", "=", "getMockEndpoint", "(", "\"", "mock", ":", "result", "\"", ");", "mock", ".", "expectedMessageCount", "(", "1", ")", ";", "template", ".", "sendBodyAndHeader", "(", "\"", "direct", ":", "start", "\"", ",", "\"", "Bye", "World", "\"", ",", "Exchange", ".", "FILE_NAME", ",", "\"", "jail", "/", "bye", ".", "txt", "\"", ");", "assertMockEndpointsSatisfied", "(", ");", "}", "@", "Override", "protected", "RouteBuilder", "createRouteBuilder", "(", ")", "throws", "Exception", "{", "return", "new", "RouteBuilder", "(", ")", "{", "@", "Override", "public", "void", "configure", "(", ")", "throws", "Exception", "{", "from", "(", "\"", "direct", ":", "start", "\"", ")", ".", "setHeader", "(", "Exchange", ".", "FILE_NAME", ",", "simple", "(", "\".", "./", "${", "file", ":", "name", "}", "\")", ")", ".", "to", "(", "getFtpUrl", "(", "))", ".", "to", "(", "\"", "mock", ":", "result", "\"", ");", "}", "}", ";", "}", "}</s>if", "(", "value", "!", "=", "null", "&", "&", "value", "instanceof", "String", "&", "&", "StringHelper", ".", "hasStartToken", "(", "(", "String", ")", "value", ",", "\"", "simple", "\"", "))", "{", "template", ".", "sendBody", "(", "\"", "file", ":", "//", "target", "/", "filelanguage", "?", "fileName", "=", "\"", "+", "expression", ",", "\"", "Hello", "World", "\"", ");", "String", "url", "=", "\"", "ftp", ":", "//", "admin", "@", "localhost", ":", "\"", "+", "getPort", "(", ")", "+", "\"", "/", "filelanguage", "/", "foo", "?", "password", "=", "admin", "\"", ";"], "docstring_tokens": ["view", "arbitrary", "files", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "template", ".", "TemplateManagerUtil", ";", "ClassLoader", "classLoader", "=", "hotDeployEvent", ".", "getContextClassLoader", "(", ");", "TemplateManagerUtil", ".", "destroy", "(", "classLoader", ")", ";", "PACLPolicyManager", ".", "unregister", "(", "classLoader", ")", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "lang", ".", "PortalSecurityManagerThreadLocal", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLClassLoaderUtil", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLPolicy", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLPolicyManager", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ConcurrentHashMap", ";", "_classLoaderHelperUtilities", ".", "clear", "(", ");", "_classLoaderHelperUtilities", "=", "null", ";", "public", "void", "destroy", "(", "ClassLoader", "classLoader", ")", "{", "_classLoaderHelperUtilities", ".", "remove", "(", "classLoader", ")", ";", "}", "if", "(", "templateContextType", ".", "equals", "(", "TemplateContextType", ".", "CLASS_LOADER", ")", ")", "{", "/", "/", "This", "template", "will", "have", "all", "of", "its", "utilities", "initialized", "within", "/", "/", "the", "class", "loader", "of", "the", "current", "thread", "ClassLoader", "contextClassLoader", "=", "PACLClassLoaderUtil", ".", "getContextClassLoader", "(", ");", "PACLPolicy", "threadLocalPACLPolicy", "=", "PortalSecurityManagerThreadLocal", ".", "getPACLPolicy", "(", ");", "PACLPolicy", "contextClassLoaderPACLPolicy", "=", "PACLPolicyManager", ".", "getPACLPolicy", "(", "contextClassLoader", ")", ";", "try", "{", "PortalSecurityManagerThreadLocal", ".", "setPACLPolicy", "(", "contextClassLoaderPACLPolicy", ")", ";", "Map", "<", "String", ",", "Object", ">", "helperUtilities", "=", "_classLoaderHelperUtilities", ".", "get", "(", "contextClassLoader", ")", ";", "if", "(", "helperUtilities", "=", "=", "null", ")", "{", "helperUtilities", "=", "_templateContextHelper", ".", "getHelperUtilities", "(", ");", "_classLoaderHelperUtilities", ".", "put", "(", "contextClassLoader", ",", "helperUtilities", ")", ";", "}", "return", "new", "PACLFreeMarkerTemplate", "(", "templateId", ",", "templateContent", ",", "errorTemplateId", ",", "errorTemplateContent", ",", "helperUtilities", ",", "_configuration", ",", "_templateContextHelper", ",", "_stringTemplateLoader", ",", "contextClassLoaderPACLPolicy", ")", ";", "}", "finally", "{", "PortalSecurityManagerThreadLocal", ".", "setPACLPolicy", "(", "threadLocalPACLPolicy", ")", ";", "}", "}", "else", "if", "(", "templateContextType", ".", "equals", "(", "TemplateContextType", ".", "EMPTY", ")", ")", "{", "_configuration", ".", "setNewBuiltinClassResolver", "(", "new", "LiferayTemplateClassResolver", "(", "))", ";", "private", "Map", "<", "ClassLoader", ",", "Map", "<", "String", ",", "Object", ">", ">", "_classLoaderHelperUtilities", "=", "new", "ConcurrentHashMap", "<", "ClassLoader", ",", "Map", "<", "String", ",", "Object", ">", ">(", ");", "helperUtilities", ".", "put", "(", "\"", "objectUtil", "\"", ",", "new", "LiferayObjectConstructor", "(", "))", ";", "/", "**", "*", "Copyright", "(", "c", ")", "2000", "-", "2012", "Liferay", ",", "Inc", ".", "All", "rights", "reserved", ".", "*", "*", "This", "library", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "it", "under", "*", "the", "terms", "of", "the", "GNU", "Lesser", "General", "Public", "License", "as", "published", "by", "the", "Free", "*", "Software", "Foundation", ";", "either", "version", "2", ".", "1", "of", "the", "License", ",", "or", "(", "at", "your", "option", ")", "*", "any", "later", "version", ".", "*", "*", "This", "library", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "but", "WITHOUT", "*", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "MERCHANTABILITY", "or", "FITNESS", "*", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "GNU", "Lesser", "General", "Public", "License", "for", "more", "*", "details", ".", "*", "/", "package", "com", ".", "liferay", ".", "portal", ".", "freemarker", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLClassLoaderUtil", ";", "import", "freemarker", ".", "ext", ".", "beans", ".", "BeansWrapper", ";", "import", "freemarker", ".", "template", ".", "TemplateMethodModelEx", ";", "import", "freemarker", ".", "template", ".", "TemplateModelException", ";", "import", "java", ".", "util", ".", "List", ";", "/", "**", "*", "@", "author", "Raymond", "Aug", "\u00e9", "*", "/", "public", "class", "LiferayObjectConstructor", "implements", "TemplateMethodModelEx", "{", "public", "Object", "exec", "(", "@", "SuppressWarnings", "(", "\"", "rawtypes", "\"", ")", "List", "arguments", ")", "throws", "TemplateModelException", "{", "if", "(", "arguments", ".", "isEmpty", "(", "))", "{", "throw", "new", "TemplateModelException", "(", "\"", "This", "method", "must", "have", "at", "least", "one", "argument", "as", "the", "name", "of", "\"", "\"", "the", "class", "to", "instantiate", "\"", ");", "}", "Class", "<", "?>", "clazz", "=", "null", ";", "try", "{", "String", "className", "=", "String", ".", "valueOf", "(", "arguments", ".", "get", "(", "0", ")", ");", "clazz", "=", "Class", ".", "forName", "(", "className", ",", "true", ",", "PACLClassLoaderUtil", ".", "getContextClassLoader", "(", "))", ";", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "new", "TemplateModelException", "(", "e", ".", "getMessage", "(", "))", ";", "}", "BeansWrapper", "beansWrapper", "=", "BeansWrapper", ".", "getDefaultInstance", "(", ");", "Object", "object", "=", "beansWrapper", ".", "newInstance", "(", "clazz", ",", "arguments", ".", "subList", "(", "1", ",", "arguments", ".", "size", "(", "))", ");", "return", "beansWrapper", ".", "wrap", "(", "object", ")", ";", "}", "}", "/", "**", "*", "Copyright", "(", "c", ")", "2000", "-", "2012", "Liferay", ",", "Inc", ".", "All", "rights", "reserved", ".", "*", "*", "This", "library", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "it", "under", "*", "the", "terms", "of", "the", "GNU", "Lesser", "General", "Public", "License", "as", "published", "by", "the", "Free", "*", "Software", "Foundation", ";", "either", "version", "2", ".", "1", "of", "the", "License", ",", "or", "(", "at", "your", "option", ")", "*", "any", "later", "version", ".", "*", "*", "This", "library", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "but", "WITHOUT", "*", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "MERCHANTABILITY", "or", "FITNESS", "*", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "GNU", "Lesser", "General", "Public", "License", "for", "more", "*", "details", ".", "*", "/", "package", "com", ".", "liferay", ".", "portal", ".", "freemarker", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLClassLoaderUtil", ";", "import", "com", ".", "liferay", ".", "portal", ".", "util", ".", "PropsValues", ";", "import", "freemarker", ".", "core", ".", "Environment", ";", "import", "freemarker", ".", "core", ".", "TemplateClassResolver", ";", "import", "freemarker", ".", "template", ".", "Template", ";", "import", "freemarker", ".", "template", ".", "TemplateException", ";", "import", "freemarker", ".", "template", ".", "utility", ".", "ObjectConstructor", ";", "/", "**", "*", "@", "author", "Raymond", "Aug", "\u00e9", "*", "/", "public", "class", "LiferayTemplateClassResolver", "implements", "TemplateClassResolver", "{", "public", "Class", "<", "?>", "resolve", "(", "String", "className", ",", "Environment", "environment", ",", "Template", "template", ")", "throws", "TemplateException", "{", "if", "(", "className", ".", "equals", "(", "ObjectConstructor", ".", "class", ".", "getName", "(", "))", ")", "{", "throw", "new", "TemplateException", "(", "\"", "Instantiating", "\"", "+", "className", "+", "\"", "is", "not", "allowed", "in", "the", "\"", "\"", "template", "for", "security", "reasons", "\"", ",", "environment", ")", ";", "}", "for", "(", "String", "restrictedClassName", ":", "PropsValues", ".", "FREEMARKER_ENGINE_RESTRICTED_CLASSES", ")", "{", "if", "(", "className", ".", "equals", "(", "restrictedClassName", ")", ")", "{", "throw", "new", "TemplateException", "(", "\"", "Instantiating", "\"", "+", "className", "+", "\"", "is", "not", "allowed", "in", "the", "\"", "\"", "template", "for", "security", "reasons", "\"", ",", "environment", ")", ";", "}", "}", "for", "(", "String", "restrictedPackageName", ":", "PropsValues", ".", "FREEMARKER_ENGINE_RESTRICTED_PACKAGES", ")", "{", "if", "(", "className", ".", "startsWith", "(", "restrictedPackageName", ")", ")", "{", "throw", "new", "TemplateException", "(", "\"", "Instantiating", "\"", "+", "className", "+", "\"", "is", "not", "allowed", "in", "the", "\"", "\"", "template", "for", "security", "reasons", "\"", ",", "environment", ")", ";", "}", "}", "try", "{", "return", "Class", ".", "forName", "(", "className", ",", "true", ",", "PACLClassLoaderUtil", ".", "getContextClassLoader", "(", "))", ";", "}", "catch", "(", "Exception", "e", ")", "{", "throw", "new", "TemplateException", "(", "e", ",", "environment", ")", ";", "}", "}", "}", "/", "**", "*", "Copyright", "(", "c", ")", "2000", "-", "2012", "Liferay", ",", "Inc", ".", "All", "rights", "reserved", ".", "*", "*", "This", "library", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "it", "under", "*", "the", "terms", "of", "the", "GNU", "Lesser", "General", "Public", "License", "as", "published", "by", "the", "Free", "*", "Software", "Foundation", ";", "either", "version", "2", ".", "1", "of", "the", "License", ",", "or", "(", "at", "your", "option", ")", "*", "any", "later", "version", ".", "*", "*", "This", "library", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "but", "WITHOUT", "*", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "MERCHANTABILITY", "or", "FITNESS", "*", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "GNU", "Lesser", "General", "Public", "License", "for", "more", "*", "details", ".", "*", "/", "package", "com", ".", "liferay", ".", "portal", ".", "freemarker", ";", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "template", ".", "TemplateException", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "lang", ".", "PortalSecurityManagerThreadLocal", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLPolicy", ";", "import", "com", ".", "liferay", ".", "portal", ".", "template", ".", "TemplateContextHelper", ";", "import", "freemarker", ".", "template", ".", "Configuration", ";", "import", "java", ".", "io", ".", "Writer", ";", "import", "java", ".", "util", ".", "Map", ";", "/", "**", "*", "@", "author", "Raymond", "Aug", "\u00e9", "*", "/", "public", "class", "PACLFreeMarkerTemplate", "extends", "FreeMarkerTemplate", "{", "public", "PACLFreeMarkerTemplate", "(", "String", "templateId", ",", "String", "templateContent", ",", "String", "errorTemplateId", ",", "String", "errorTemplateContent", ",", "Map", "<", "String", ",", "Object", ">", "context", ",", "Configuration", "configuration", ",", "TemplateContextHelper", "templateContextHelper", ",", "StringTemplateLoader", "stringTemplateLoader", ",", "PACLPolicy", "paclPolicy", ")", "{", "super", "(", "templateId", ",", "templateContent", ",", "errorTemplateId", ",", "errorTemplateContent", ",", "context", ",", "configuration", ",", "templateContextHelper", ",", "stringTemplateLoader", ")", ";", "_paclPolicy", "=", "paclPolicy", ";", "}", "@", "Override", "public", "boolean", "processTemplate", "(", "Writer", "writer", ")", "throws", "TemplateException", "{", "PACLPolicy", "initialPolicy", "=", "PortalSecurityManagerThreadLocal", ".", "getPACLPolicy", "(", ");", "try", "{", "PortalSecurityManagerThreadLocal", ".", "setPACLPolicy", "(", "_paclPolicy", ")", ";", "return", "super", ".", "processTemplate", "(", "writer", ")", ";", "}", "finally", "{", "PortalSecurityManagerThreadLocal", ".", "setPACLPolicy", "(", "initialPolicy", ")", ";", "}", "}", "private", "PACLPolicy", "_paclPolicy", ";", "}", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "log", ".", "Log", ";", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "log", ".", "LogFactoryUtil", ";", "try", "{", "variables", ".", "put", "(", "\"", "auditMessageFactoryUtil", "\"", ",", "AuditMessageFactoryUtil", ".", "getAuditMessageFactory", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "auditRouterUtil", "\"", ",", "AuditRouterUtil", ".", "getAuditRouter", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "browserSniffer", "\"", ",", "BrowserSnifferUtil", ".", "getBrowserSniffer", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "dateFormatFactory", "\"", ",", "FastDateFormatFactoryUtil", ".", "getFastDateFormatFactory", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "ServiceLocator", "serviceLocator", "=", "ServiceLocator", ".", "getInstance", "(", ");", "/", "/", "Service", "locator", "variables", ".", "put", "(", "\"", "serviceLocator", "\"", ",", "serviceLocator", ")", ";", "try", "{", "variables", ".", "put", "(", "\"", "expandoColumnLocalService", "\"", ",", "serviceLocator", ".", "findService", "(", "ExpandoColumnLocalService", ".", "class", ".", "getName", "(", "))", ");", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "/", "/", "Expando", "row", "service", "try", "{", "variables", ".", "put", "(", "\"", "expandoRowLocalService", "\"", ",", "serviceLocator", ".", "findService", "(", "ExpandoRowLocalService", ".", "class", ".", "getName", "(", "))", ");", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "/", "/", "Expando", "table", "service", "try", "{", "variables", ".", "put", "(", "\"", "expandoTableLocalService", "\"", ",", "serviceLocator", ".", "findService", "(", "ExpandoTableLocalService", ".", "class", ".", "getName", "(", "))", ");", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "/", "/", "Expando", "value", "service", "try", "{", "variables", ".", "put", "(", "\"", "expandoValueLocalService", "\"", ",", "serviceLocator", ".", "findService", "(", "ExpandoValueLocalService", ".", "class", ".", "getName", "(", "))", ");", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "htmlUtil", "\"", ",", "HtmlUtil", ".", "getHtml", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "httpUtil", "\"", ",", "HttpUtil", ".", "getHttp", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "journalContentUtil", "\"", ",", "JournalContentUtil", ".", "getJournalContent", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "jsonFactoryUtil", "\"", ",", "JSONFactoryUtil", ".", "getJSONFactory", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "languageUtil", "\"", ",", "LanguageUtil", ".", "getLanguage", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "unicodeLanguageUtil", "\"", ",", "UnicodeLanguageUtil", ".", "getUnicodeLanguage", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "localeUtil", "\"", ",", "LocaleUtil", ".", "getInstance", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "portalUtil", "\"", ",", "PortalUtil", ".", "getPortal", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "portal", "\"", ",", "PortalUtil", ".", "getPortal", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "prefsPropsUtil", "\"", ",", "PrefsPropsUtil", ".", "getPrefsProps", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "propsUtil", "\"", ",", "PropsUtil", ".", "getProps", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "portletURLFactory", "\"", ",", "PortletURLFactoryUtil", ".", "getPortletURLFactory", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "randomizer", "\"", ",", "Randomizer_IW", ".", "getInstance", "(", ").", "getWrappedInstance", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "UtilLocator", "utilLocator", "=", "UtilLocator", ".", "getInstance", "(", ");", "/", "/", "Util", "locator", "variables", ".", "put", "(", "\"", "utilLocator", "\"", ",", "utilLocator", ")", ";", "/", "/", "SAX", "reader", "util", "try", "{", "variables", ".", "put", "(", "\"", "saxReaderUtil", "\"", ",", "utilLocator", ".", "findUtil", "(", "SAXReader", ".", "class", ".", "getName", "(", "))", ");", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "webServerToken", "\"", ",", "WebServerServletTokenUtil", ".", "getWebServerServletToken", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "accountPermission", "\"", ",", "AccountPermissionUtil", ".", "getAccountPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "commonPermission", "\"", ",", "CommonPermissionUtil", ".", "getCommonPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "groupPermission", "\"", ",", "GroupPermissionUtil", ".", "getGroupPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "layoutPermission", "\"", ",", "LayoutPermissionUtil", ".", "getLayoutPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "organizationPermission", "\"", ",", "OrganizationPermissionUtil", ".", "getOrganizationPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "passwordPolicyPermission", "\"", ",", "PasswordPolicyPermissionUtil", ".", "getPasswordPolicyPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "portalPermission", "\"", ",", "PortalPermissionUtil", ".", "getPortalPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "portletPermission", "\"", ",", "PortletPermissionUtil", ".", "getPortletPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "rolePermission", "\"", ",", "RolePermissionUtil", ".", "getRolePermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "userGroupPermission", "\"", ",", "UserGroupPermissionUtil", ".", "getUserGroupPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "userPermission", "\"", ",", "UserPermissionUtil", ".", "getUserPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "dateFormats", "\"", ",", "FastDateFormatFactoryUtil", ".", "getFastDateFormatFactory", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "imageToken", "\"", ",", "WebServerServletTokenUtil", ".", "getWebServerServletToken", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "try", "{", "variables", ".", "put", "(", "\"", "locationPermission", "\"", ",", "OrganizationPermissionUtil", ".", "getOrganizationPermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "private", "static", "Log", "_log", "=", "LogFactoryUtil", ".", "getLog", "(", "TemplateContextHelper", ".", "class", ")", ";", "public", "static", "final", "String", "[", "]", "FREEMARKER_ENGINE_RESTRICTED_CLASSES", "=", "PropsUtil", ".", "getArray", "(", "PropsKeys", ".", "FREEMARKER_ENGINE_RESTRICTED_CLASSES", ")", ";", "public", "static", "final", "String", "[", "]", "FREEMARKER_ENGINE_RESTRICTED_PACKAGES", "=", "PropsUtil", ".", "getArray", "(", "PropsKeys", ".", "FREEMARKER_ENGINE_RESTRICTED_PACKAGES", ")", ";", "public", "static", "final", "String", "[", "]", "VELOCITY_ENGINE_RESTRICTED_CLASSES", "=", "PropsUtil", ".", "getArray", "(", "PropsKeys", ".", "VELOCITY_ENGINE_RESTRICTED_CLASSES", ")", ";", "public", "static", "final", "String", "[", "]", "VELOCITY_ENGINE_RESTRICTED_PACKAGES", "=", "PropsUtil", ".", "getArray", "(", "PropsKeys", ".", "VELOCITY_ENGINE_RESTRICTED_PACKAGES", ")", ";", "/", "**", "*", "Copyright", "(", "c", ")", "2000", "-", "2012", "Liferay", ",", "Inc", ".", "All", "rights", "reserved", ".", "*", "*", "This", "library", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "it", "under", "*", "the", "terms", "of", "the", "GNU", "Lesser", "General", "Public", "License", "as", "published", "by", "the", "Free", "*", "Software", "Foundation", ";", "either", "version", "2", ".", "1", "of", "the", "License", ",", "or", "(", "at", "your", "option", ")", "*", "any", "later", "version", ".", "*", "*", "This", "library", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "but", "WITHOUT", "*", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "MERCHANTABILITY", "or", "FITNESS", "*", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "GNU", "Lesser", "General", "Public", "License", "for", "more", "*", "details", ".", "*", "/", "package", "com", ".", "liferay", ".", "portal", ".", "velocity", ";", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "log", ".", "Log", ";", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "log", ".", "LogFactoryUtil", ";", "import", "org", ".", "apache", ".", "velocity", ".", "app", ".", "event", ".", "MethodExceptionEventHandler", ";", "/", "**", "*", "@", "author", "Raymond", "Aug", "\u00e9", "*", "/", "public", "class", "LiferayMethodExceptionEventHandler", "implements", "MethodExceptionEventHandler", "{", "public", "Object", "methodException", "(", "@", "SuppressWarnings", "(", "\"", "rawtypes", "\"", ")", "Class", "clazz", ",", "String", "method", ",", "Exception", "e", ")", "throws", "Exception", "{", "_log", ".", "error", "(", "e", ",", "e", ")", ";", "return", "null", ";", "}", "private", "static", "Log", "_log", "=", "LogFactoryUtil", ".", "getLog", "(", "LiferayMethodExceptionEventHandler", ".", "class", ")", ";", "}", "/", "**", "*", "Copyright", "(", "c", ")", "2000", "-", "2012", "Liferay", ",", "Inc", ".", "All", "rights", "reserved", ".", "*", "*", "This", "library", "is", "free", "software", ";", "you", "can", "redistribute", "it", "and", "/", "or", "modify", "it", "under", "*", "the", "terms", "of", "the", "GNU", "Lesser", "General", "Public", "License", "as", "published", "by", "the", "Free", "*", "Software", "Foundation", ";", "either", "version", "2", ".", "1", "of", "the", "License", ",", "or", "(", "at", "your", "option", ")", "*", "any", "later", "version", ".", "*", "*", "This", "library", "is", "distributed", "in", "the", "hope", "that", "it", "will", "be", "useful", ",", "but", "WITHOUT", "*", "ANY", "WARRANTY", ";", "without", "even", "the", "implied", "warranty", "of", "MERCHANTABILITY", "or", "FITNESS", "*", "FOR", "A", "PARTICULAR", "PURPOSE", ".", "See", "the", "GNU", "Lesser", "General", "Public", "License", "for", "more", "*", "details", ".", "*", "/", "package", "com", ".", "liferay", ".", "portal", ".", "velocity", ";", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "template", ".", "TemplateException", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "lang", ".", "PortalSecurityManagerThreadLocal", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLPolicy", ";", "import", "com", ".", "liferay", ".", "portal", ".", "template", ".", "TemplateContextHelper", ";", "import", "java", ".", "io", ".", "Writer", ";", "import", "org", ".", "apache", ".", "velocity", ".", "VelocityContext", ";", "import", "org", ".", "apache", ".", "velocity", ".", "app", ".", "VelocityEngine", ";", "/", "**", "*", "@", "author", "Raymond", "Aug", "\u00e9", "*", "/", "public", "class", "PACLVelocityTemplate", "extends", "VelocityTemplate", "{", "public", "PACLVelocityTemplate", "(", "String", "templateId", ",", "String", "templateContent", ",", "String", "errorTemplateId", ",", "String", "errorTemplateContent", ",", "VelocityContext", "velocityContext", ",", "VelocityEngine", "velocityEngine", ",", "TemplateContextHelper", "templateContextHelper", ",", "PACLPolicy", "paclPolicy", ")", "{", "super", "(", "templateId", ",", "templateContent", ",", "errorTemplateId", ",", "errorTemplateContent", ",", "velocityContext", ",", "velocityEngine", ",", "templateContextHelper", ")", ";", "_paclPolicy", "=", "paclPolicy", ";", "}", "@", "Override", "public", "boolean", "processTemplate", "(", "Writer", "writer", ")", "throws", "TemplateException", "{", "PACLPolicy", "initialPolicy", "=", "PortalSecurityManagerThreadLocal", ".", "getPACLPolicy", "(", ");", "try", "{", "PortalSecurityManagerThreadLocal", ".", "setPACLPolicy", "(", "_paclPolicy", ")", ";", "return", "super", ".", "processTemplate", "(", "writer", ")", ";", "}", "finally", "{", "PortalSecurityManagerThreadLocal", ".", "setPACLPolicy", "(", "initialPolicy", ")", ";", "}", "}", "private", "PACLPolicy", "_paclPolicy", ";", "}", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "util", ".", "StringUtil", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "lang", ".", "PortalSecurityManagerThreadLocal", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLClassLoaderUtil", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLPolicy", ";", "import", "com", ".", "liferay", ".", "portal", ".", "security", ".", "pacl", ".", "PACLPolicyManager", ";", "import", "java", ".", "util", ".", "concurrent", ".", "ConcurrentHashMap", ";", "import", "org", ".", "apache", ".", "velocity", ".", "runtime", ".", "RuntimeConstants", ";", "import", "org", ".", "apache", ".", "velocity", ".", "util", ".", "introspection", ".", "SecureUberspector", ";", "_classLoaderVelocityContexts", ".", "clear", "(", ");", "_classLoaderVelocityContexts", "=", "null", ";", "public", "void", "destroy", "(", "ClassLoader", "classLoader", ")", "{", "_classLoaderVelocityContexts", ".", "remove", "(", "classLoader", ")", ";", "}", "if", "(", "templateContextType", ".", "equals", "(", "TemplateContextType", ".", "CLASS_LOADER", ")", ")", "{", "/", "/", "This", "template", "will", "have", "all", "of", "its", "utilities", "initialized", "within", "/", "/", "the", "class", "loader", "of", "the", "current", "thread", "ClassLoader", "contextClassLoader", "=", "PACLClassLoaderUtil", ".", "getContextClassLoader", "(", ");", "PACLPolicy", "threadLocalPACLPolicy", "=", "PortalSecurityManagerThreadLocal", ".", "getPACLPolicy", "(", ");", "PACLPolicy", "contextClassLoaderPACLPolicy", "=", "PACLPolicyManager", ".", "getPACLPolicy", "(", "contextClassLoader", ")", ";", "try", "{", "PortalSecurityManagerThreadLocal", ".", "setPACLPolicy", "(", "contextClassLoaderPACLPolicy", ")", ";", "VelocityContext", "velocityContext", "=", "_classLoaderVelocityContexts", ".", "get", "(", "contextClassLoader", ")", ";", "if", "(", "velocityContext", "=", "=", "null", ")", "{", "velocityContext", "=", "new", "VelocityContext", "(", ");", "Map", "<", "String", ",", "Object", ">", "helperUtilities", "=", "_templateContextHelper", ".", "getHelperUtilities", "(", ");", "for", "(", "Map", ".", "Entry", "<", "String", ",", "Object", ">", "entry", ":", "helperUtilities", ".", "entrySet", "(", "))", "{", "velocityContext", ".", "put", "(", "entry", ".", "getKey", "(", "),", "entry", ".", "getValue", "(", "))", ";", "}", "_classLoaderVelocityContexts", ".", "put", "(", "contextClassLoader", ",", "velocityContext", ")", ";", "}", "return", "new", "PACLVelocityTemplate", "(", "templateId", ",", "templateContent", ",", "errorTemplateId", ",", "errorTemplateContent", ",", "velocityContext", ",", "_velocityEngine", ",", "_templateContextHelper", ",", "contextClassLoaderPACLPolicy", ")", ";", "}", "finally", "{", "PortalSecurityManagerThreadLocal", ".", "setPACLPolicy", "(", "threadLocalPACLPolicy", ")", ";", "}", "}", "else", "if", "(", "templateContextType", ".", "equals", "(", "TemplateContextType", ".", "EMPTY", ")", ")", "{", "extendedProperties", ".", "setProperty", "(", "VelocityEngine", ".", "EVENTHANDLER_METHODEXCEPTION", ",", "LiferayMethodExceptionEventHandler", ".", "class", ".", "getName", "(", "))", ";", "RuntimeConstants", ".", "INTROSPECTOR_RESTRICT_CLASSES", ",", "StringUtil", ".", "merge", "(", "PropsValues", ".", "VELOCITY_ENGINE_RESTRICTED_CLASSES", ")", ");", "RuntimeConstants", ".", "INTROSPECTOR_RESTRICT_PACKAGES", ",", "StringUtil", ".", "merge", "(", "PropsValues", ".", "VELOCITY_ENGINE_RESTRICTED_PACKAGES", ")", ");", "VelocityEngine", ".", "RESOURCE_LOADER", ",", "\"", "string", ",", "servlet", "\"", ");", "\"", "servlet", ".", "\"", "+", "VelocityEngine", ".", "RESOURCE_LOADER", "+", "\"", ".", "cache", "\"", ",", "\"", "servlet", ".", "\"", "+", "VelocityEngine", ".", "RESOURCE_LOADER", "+", "\"", ".", "class", "\"", ",", "extendedProperties", ".", "setProperty", "(", "\"", "string", ".", "\"", "+", "VelocityEngine", ".", "RESOURCE_LOADER", "+", "\"", ".", "cache", "\"", ",", "String", ".", "valueOf", "(", "PropsValues", ".", "VELOCITY_ENGINE_RESOURCE_MANAGER_CACHE_ENABLED", ")", ");", "extendedProperties", ".", "setProperty", "(", "\"", "string", ".", "\"", "+", "VelocityEngine", ".", "RESOURCE_LOADER", "+", "\"", ".", "class", "\"", ",", "StringResourceLoader", ".", "class", ".", "getName", "(", "))", ";", "extendedProperties", ".", "setProperty", "(", "\"", "string", ".", "\"", "+", "VelocityEngine", ".", "RESOURCE_LOADER", "+", "\"", ".", "repository", ".", "class", "\"", ",", "StringResourceRepositoryImpl", ".", "class", ".", "getName", "(", "))", ";", "extendedProperties", ".", "setProperty", "(", "VelocityEngine", ".", "RUNTIME_LOG_LOGSYSTEM_CLASS", ",", "PropsUtil", ".", "get", "(", "PropsKeys", ".", "VELOCITY_ENGINE_LOGGER", ")", ");", "extendedProperties", ".", "setProperty", "(", "VelocityEngine", ".", "RUNTIME_LOG_LOGSYSTEM", "+", "\"", ".", "log4j", ".", "category", "\"", ",", "PropsUtil", ".", "get", "(", "PropsKeys", ".", "VELOCITY_ENGINE_LOGGER_CATEGORY", ")", ");", "extendedProperties", ".", "setProperty", "(", "RuntimeConstants", ".", "UBERSPECT_CLASSNAME", ",", "SecureUberspector", ".", "class", ".", "getName", "(", "))", ";", "private", "Map", "<", "ClassLoader", ",", "VelocityContext", ">", "_classLoaderVelocityContexts", "=", "new", "ConcurrentHashMap", "<", "ClassLoader", ",", "VelocityContext", ">", "()", ";", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "log", ".", "Log", ";", "import", "com", ".", "liferay", ".", "portal", ".", "kernel", ".", "log", ".", "LogFactoryUtil", ";", "try", "{", "velocityContext", ".", "put", "(", "\"", "rolePermission", "\"", ",", "RolePermissionUtil", ".", "getRolePermission", "(", "))", ";", "}", "catch", "(", "SecurityException", "se", ")", "{", "_log", ".", "error", "(", "se", ",", "se", ")", ";", "}", "private", "static", "Log", "_log", "=", "LogFactoryUtil", ".", "getLog", "(", "VelocityTemplateContextHelper", ".", "class", ")", ";", "public", "void", "destroy", "(", "ClassLoader", "classLoader", ")", ";", "public", "static", "void", "destroy", "(", "ClassLoader", "classLoader", ")", "{", "Map", "<", "String", ",", "TemplateManager", ">", "templateManagers", "=", "_getTemplateManagers", "(", ");", "for", "(", "TemplateManager", "templateManager", ":", "templateManagers", ".", "values", "(", "))", "{", "templateManager", ".", "destroy", "(", "classLoader", ")", ";", "}", "}", "public", "static", "final", "String", "FREEMARKER_ENGINE_RESTRICTED_CLASSES", "=", "\"", "freemarker", ".", "engine", ".", "restricted", ".", "classes", "\"", ";", "public", "static", "final", "String", "FREEMARKER_ENGINE_RESTRICTED_PACKAGES", "=", "\"", "freemarker", ".", "engine", ".", "restricted", ".", "packages", "\"", ";", "public", "static", "final", "String", "VELOCITY_ENGINE_RESTRICTED_CLASSES", "=", "\"", "velocity", ".", "engine", ".", "restricted", ".", "classes", "\"", ";", "public", "static", "final", "String", "VELOCITY_ENGINE_RESTRICTED_PACKAGES", "=", "\"", "velocity", ".", "engine", ".", "restricted", ".", "packages", "\"", ";</s>PACLPolicyManager", ".", "unregister", "(", "hotDeployEvent", ".", "getContextClassLoader", "(", "))", ";", "if", "(", "templateContextType", ".", "equals", "(", "TemplateContextType", ".", "EMPTY", ")", ")", "{", "import", "freemarker", ".", "template", ".", "utility", ".", "ObjectConstructor", ";", "helperUtilities", ".", "put", "(", "\"", "objectUtil", "\"", ",", "new", "ObjectConstructor", "(", "))", ";", "variables", ".", "put", "(", "\"", "auditMessageFactoryUtil", "\"", ",", "AuditMessageFactoryUtil", ".", "getAuditMessageFactory", "(", "))", ";", "variables", ".", "put", "(", "\"", "auditRouterUtil", "\"", ",", "AuditRouterUtil", ".", "getAuditRouter", "(", "))", ";", "variables", ".", "put", "(", "\"", "browserSniffer", "\"", ",", "BrowserSnifferUtil", ".", "getBrowserSniffer", "(", "))", ";", "variables", ".", "put", "(", "\"", "dateFormatFactory", "\"", ",", "FastDateFormatFactoryUtil", ".", "getFastDateFormatFactory", "(", "))", ";", "ServiceLocator", "serviceLocator", "=", "ServiceLocator", ".", "getInstance", "(", ");", "variables", ".", "put", "(", "\"", "expandoColumnLocalService", "\"", ",", "serviceLocator", ".", "findService", "(", "ExpandoColumnLocalService", ".", "class", ".", "getName", "(", "))", ");", "/", "/", "Expando", "row", "service", "variables", ".", "put", "(", "\"", "expandoRowLocalService", "\"", ",", "serviceLocator", ".", "findService", "(", "ExpandoRowLocalService", ".", "class", ".", "getName", "(", "))", ");", "/", "/", "Expando", "table", "service", "variables", ".", "put", "(", "\"", "expandoTableLocalService", "\"", ",", "serviceLocator", ".", "findService", "(", "ExpandoTableLocalService", ".", "class", ".", "getName", "(", "))", ");", "/", "/", "Expando", "value", "service", "variables", ".", "put", "(", "\"", "expandoValueLocalService", "\"", ",", "serviceLocator", ".", "findService", "(", "ExpandoValueLocalService", ".", "class", ".", "getName", "(", "))", ");", "variables", ".", "put", "(", "\"", "htmlUtil", "\"", ",", "HtmlUtil", ".", "getHtml", "(", "))", ";", "variables", ".", "put", "(", "\"", "httpUtil", "\"", ",", "HttpUtil", ".", "getHttp", "(", "))", ";", "variables", ".", "put", "(", "\"", "journalContentUtil", "\"", ",", "JournalContentUtil", ".", "getJournalContent", "(", "))", ";", "variables", ".", "put", "(", "\"", "jsonFactoryUtil", "\"", ",", "JSONFactoryUtil", ".", "getJSONFactory", "(", "))", ";", "variables", ".", "put", "(", "\"", "languageUtil", "\"", ",", "LanguageUtil", ".", "getLanguage", "(", "))", ";", "variables", ".", "put", "(", "\"", "unicodeLanguageUtil", "\"", ",", "UnicodeLanguageUtil", ".", "getUnicodeLanguage", "(", "))", ";", "variables", ".", "put", "(", "\"", "localeUtil", "\"", ",", "LocaleUtil", ".", "getInstance", "(", "))", ";", "variables", ".", "put", "(", "\"", "portalUtil", "\"", ",", "PortalUtil", ".", "getPortal", "(", "))", ";", "variables", ".", "put", "(", "\"", "portal", "\"", ",", "PortalUtil", ".", "getPortal", "(", "))", ";", "variables", ".", "put", "(", "\"", "prefsPropsUtil", "\"", ",", "PrefsPropsUtil", ".", "getPrefsProps", "(", "))", ";", "variables", ".", "put", "(", "\"", "propsUtil", "\"", ",", "PropsUtil", ".", "getProps", "(", "))", ";", "variables", ".", "put", "(", "\"", "portletURLFactory", "\"", ",", "PortletURLFactoryUtil", ".", "getPortletURLFactory", "(", "))", ";", "variables", ".", "put", "(", "\"", "randomizer", "\"", ",", "Randomizer_IW", ".", "getInstance", "(", ").", "getWrappedInstance", "(", "))", ";", "/", "/", "SAX", "reader", "util", "UtilLocator", "utilLocator", "=", "UtilLocator", ".", "getInstance", "(", ");", "variables", ".", "put", "(", "\"", "saxReaderUtil", "\"", ",", "utilLocator", ".", "findUtil", "(", "SAXReader", ".", "class", ".", "getName", "(", "))", ");", "/", "/", "Service", "locator", "variables", ".", "put", "(", "\"", "serviceLocator", "\"", ",", "serviceLocator", ")", ";", "/", "/", "Util", "locator", "variables", ".", "put", "(", "\"", "utilLocator", "\"", ",", "utilLocator", ")", ";", "variables", ".", "put", "(", "\"", "webServerToken", "\"", ",", "WebServerServletTokenUtil", ".", "getWebServerServletToken", "(", "))", ";", "variables", ".", "put", "(", "\"", "accountPermission", "\"", ",", "AccountPermissionUtil", ".", "getAccountPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "commonPermission", "\"", ",", "CommonPermissionUtil", ".", "getCommonPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "groupPermission", "\"", ",", "GroupPermissionUtil", ".", "getGroupPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "layoutPermission", "\"", ",", "LayoutPermissionUtil", ".", "getLayoutPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "organizationPermission", "\"", ",", "OrganizationPermissionUtil", ".", "getOrganizationPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "passwordPolicyPermission", "\"", ",", "PasswordPolicyPermissionUtil", ".", "getPasswordPolicyPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "portalPermission", "\"", ",", "PortalPermissionUtil", ".", "getPortalPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "portletPermission", "\"", ",", "PortletPermissionUtil", ".", "getPortletPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "rolePermission", "\"", ",", "RolePermissionUtil", ".", "getRolePermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "userGroupPermission", "\"", ",", "UserGroupPermissionUtil", ".", "getUserGroupPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "userPermission", "\"", ",", "UserPermissionUtil", ".", "getUserPermission", "(", "))", ";", "variables", ".", "put", "(", "\"", "dateFormats", "\"", ",", "FastDateFormatFactoryUtil", ".", "getFastDateFormatFactory", "(", "))", ";", "variables", ".", "put", "(", "\"", "imageToken", "\"", ",", "WebServerServletTokenUtil", ".", "getWebServerServletToken", "(", "))", ";", "variables", ".", "put", "(", "\"", "locationPermission", "\"", ",", "OrganizationPermissionUtil", ".", "getOrganizationPermission", "(", "))", ";", "if", "(", "templateContextType", ".", "equals", "(", "TemplateContextType", ".", "EMPTY", ")", ")", "{", "extendedProperties", ".", "setProperty", "(", "_RESOURCE_LOADER", ",", "\"", "string", ",", "servlet", "\"", ");", "\"", "string", ".", "\"", "+", "_RESOURCE_LOADER", "+", "\"", ".", "cache", "\"", ",", "String", ".", "valueOf", "(", "PropsValues", ".", "VELOCITY_ENGINE_RESOURCE_MANAGER_CACHE_ENABLED", ")", ");", "\"", "string", ".", "\"", "+", "_RESOURCE_LOADER", "+", "\"", ".", "class", "\"", ",", "StringResourceLoader", ".", "class", ".", "getName", "(", "))", ";", "\"", "string", ".", "\"", "+", "_RESOURCE_LOADER", "+", "\"", ".", "repository", ".", "class", "\"", ",", "StringResourceRepositoryImpl", ".", "class", ".", "getName", "(", "))", ";", "\"", "servlet", ".", "\"", "+", "_RESOURCE_LOADER", "+", "\"", ".", "cache", "\"", ",", "\"", "servlet", ".", "\"", "+", "_RESOURCE_LOADER", "+", "\"", ".", "class", "\"", ",", "extendedProperties", ".", "setProperty", "(", "VelocityEngine", ".", "RUNTIME_LOG_LOGSYSTEM_CLASS", ",", "PropsUtil", ".", "get", "(", "PropsKeys", ".", "VELOCITY_ENGINE_LOGGER", ")", ");", "extendedProperties", ".", "setProperty", "(", "VelocityEngine", ".", "RUNTIME_LOG_LOGSYSTEM", "+", "\"", ".", "log4j", ".", "category", "\"", ",", "PropsUtil", ".", "get", "(", "PropsKeys", ".", "VELOCITY_ENGINE_LOGGER_CATEGORY", ")", ");", "private", "static", "final", "String", "_RESOURCE_LOADER", "=", "VelocityEngine", ".", "RESOURCE_LOADER", ";", "velocityContext", ".", "put", "(", "\"", "rolePermission", "\"", ",", "RolePermissionUtil", ".", "getRolePermission", "(", "))", ";"], "docstring_tokens": ["execute", "arbitrary", "commands", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": [".", "llseek", "=", "no_llseek", ",</s>.", "llseek", "=", "ftrace_regex_lseek", ","], "docstring_tokens": ["a", "denial", "of", "service"]}
{"contents": ["empty"], "code_tokens": ["</s>System", ".", "out", ".", "println", "(", "\"", "415", "miser", "!", "!!", "\")", ";", "import", "org", ".", "junit", ".", "Ignore", ";", "@", "Ignore", "@", "Ignore", "@", "Ignore", "@", "Ignore"], "docstring_tokens": ["obtain", "sensitive", "information"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "len", "<", "0", "|", "|", "len", ">", "MAX_RDS_PS_NAME", ")", "{", "if", "(", "len", "<", "0", "|", "|", "len", ">", "MAX_RDS_RADIO_TEXT", ")", "{</s>if", "(", "len", ">", "MAX_RDS_PS_NAME", ")", "{", "if", "(", "len", ">", "MAX_RDS_RADIO_TEXT", ")", "{"], "docstring_tokens": ["overflow", "a", "buffer", "and", "execute", "arbitrary", "code", "on", "the", "system", "or", "cause", "the", "application", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "key", "=", "==", "'", "__proto__", "'", "|", "|", "key", "=", "==", "'", "constructor", "'", ")", "{", "continue", ";", "}", "it", "(", "'", "should", "not", "pollute", "the", "prototype", "with", "a", "`", "__proto__", "`", "property", "'", ",(", ")", "=", ">", "{", "const", "object", "=", "JSON", ".", "parse", "(", "'{", "\"", "__proto__", "\"", ":", "{", "\"", "admin", "\"", ":", "true", "}", "}'", ");", "const", "plainObject", "=", "{", "};", "classToPlainFromExist", "(", "object", ",", "plainObject", ")", ";", "expect", "(", "(", "plainObject", "as", "any", ")", ".", "admin", ")", ".", "toEqual", "(", "undefined", ")", ";", "}", ");", "it", "(", "'", "should", "not", "pollute", "the", "prototype", "with", "a", "`", "constructor", ".", "prototype", "`", "property", "'", ",", "(", ")", "=", ">", "{", "const", "object", "=", "JSON", ".", "parse", "(", "'{", "\"", "constructor", "\"", ":", "{", "\"", "prototype", "\"", ":", "{", "\"", "admin", "\"", ":", "true", "}", "}}", "')", ";", "const", "plainObject", "=", "{", "};", "classToPlainFromExist", "(", "object", ",", "plainObject", ")", ";", "expect", "(", "(", "plainObject", "as", "any", ")", ".", "admin", ")", ".", "toEqual", "(", "undefined", ")", ";", "}", ");</s>"], "docstring_tokens": ["execute", "arbitrary", "command", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["vmx", "-", ">", "nested", ".", "pi_desc", "=", "NULL", ";", "vmcs_write64", "(", "POSTED_INTR_DESC_ADDR", ",", "-", "1ull", ")", ";</s>"], "docstring_tokens": ["a", "denial", "of", "service", "or", "possibly", "gain", "elevated", "privileges"]}
{"contents": ["empty"], "code_tokens": ["atomic_inc", "(", "&", "fl1", "-", ">", "users", ")", ";</s>atomic_inc", "(", "&", "fl", "-", ">", "users", ")", ";"], "docstring_tokens": ["corrupt", "kernel", "memory", "or", "cause", "a", "denial", "of", "service", "(crash", ")"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "LOG", ".", "isWarnEnabled", "(", "))", "{", "LOG", ".", "warn", "(", "\"", "Action", "[", "#", "0", "]", "do", "not", "match", "allowed", "action", "names", "pattern", "[", "#", "1", "]", ",", "cleaning", "it", "up", "!", "\",</s>if", "(", "LOG", ".", "isDebugEnabled", "(", "))", "{", "LOG", ".", "debug", "(", "\"", "Action", "[", "#", "0", "]", "do", "not", "match", "allowed", "action", "names", "pattern", "[", "#", "1", "]", ",", "cleaning", "it", "up", "!", "\","], "docstring_tokens": ["modify", "server-side", "objects", "and", "inject", "and", "execute", "arbitrary", "commands", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["goto", "kill_priv", ";", "kill_priv", ":", "/", "*", "User", "has", "permission", "for", "the", "change", "*", "/", "if", "(", "ia_valid", "&", "ATTR_KILL_PRIV", ")", "{", "int", "error", ";", "error", "=", "security_inode_killpriv", "(", "dentry", ")", ";", "if", "(", "error", ")", "return", "error", ";", "}", "if", "(", "error", "<", "0", ")", "if", "(", "error", "=", "=", "0", ")", "ia_valid", "=", "attr", "-", ">", "ia_valid", "&", "=", "~", "ATTR_KILL_PRIV", ";</s>return", "0", ";", "attr", "-", ">", "ia_valid", "&", "=", "~", "ATTR_KILL_PRIV", ";", "ia_valid", "&", "=", "~", "ATTR_KILL_PRIV", ";", "if", "(", "error", ">", "0", ")", "error", "=", "security_inode_killpriv", "(", "dentry", ")", ";", "if", "(", "error", ")"], "docstring_tokens": ["remove", "capabilities", "resulting", "in", "a", "denial", "of", "service"]}
{"contents": ["empty"], "code_tokens": ["var", "mkdirp", "=", "require", "(", "'", "mkdirp", "'", ")", "mkdirp", "(", "etc", ",", "function", "(", ")", "{", "mkdirp", "(", "this", ".", "prefix", ",", "cb", ")", "mkdirp", "(", "path", ".", "dirname", "(", "target", ".", "path", ")", ",", "function", "(", "er", ")", "{", "var", "mkdirp", "=", "require", "(", "'", "mkdirp", "'", ")", "mkdirp", "(", "prefix", ",", "function", "(", "er", ")", "{", "var", "mkdirp", "=", "require", "(", "'", "mkdirp", "'", ")", "mkdirp", "(", "self", ".", "where", ",", "iferr", "(", "cb", ",", "function", "(", ")", "{", "mkdirp", "(", "this", ".", "where", ",", "iferr", "(", "cb", ",", "function", "(", ")", "{", "const", "mkdirp", "=", "BB", ".", "promisify", "(", "require", "(", "'", "mkdirp", "'", "))", "return", "mkdirp", "(", "path", ".", "dirname", "(", "stageTo", ")", ").", "then", "(", "()", "=", ">", "{", "const", "mkdirp", "=", "Bluebird", ".", "promisify", "(", "require", "(", "'", "mkdirp", "'", "))", "return", "mkdirp", "(", "path", ".", "dirname", "(", "dir", ")", ")", "return", "mkdirp", "(", "path", ".", "join", "(", "pkg", ".", "realpath", ",", "'", "node_modules", "'", "))", ".", "then", "(", "()", "=", ">", "Bluebird", ".", "map", "(", "modules", ",", "(", "file", ")", "=", ">", "{", "var", "mkdirp", "=", "require", "(", "'", "mkdirp", "'", ")", "mkdirp", "(", "path", ".", "resolve", "(", "to", ",", "'", "..", "')", ",", "iferr", "(", "done", ",", "moveNodeModules", "(", "next", ")", "))", "mkdirp", "(", "from", ",", "iferr", "(", "done", ",", "function", "(", ")", "{", "var", "mkdirp", "=", "require", "(", "'", "mkdirp", "'", ")", "mkdirp", "(", "path", ".", "join", "(", "pkg", ".", "path", ",", "'", "node_modules", "'", "),", "function", "(", "mkdirEr", ")", "{", "moveModules", "(", "mkdirEr", ",", "files", ")", "}", ")", "var", "mkdir", "=", "require", "(", "'", "mkdirp", "'", ")", "mkdir", "(", "root", ",", "function", "(", "er", ")", "{", "var", "stats", "=", "{", "}", "return", "log", ".", "verbose", "(", "'", "correctMkdir", "'", ",", "path", ",", "'", "correctMkdir", "already", "in", "flight", ";", "waiting", "'", ")", "log", ".", "verbose", "(", "'", "correctMkdir", "'", ",", "path", ",", "'", "correctMkdir", "not", "in", "flight", ";", "initializing", "'", ")", "if", "(", "er", ")", "return", "makeDirectory", "(", "path", ",", "cb", ")", "function", "makeDirectory", "(", "path", ",", "cb", ")", "{", "return", "log", ".", "verbose", "(", "'", "makeDirectory", "'", ",", "path", ",", "'", "creation", "already", "in", "flight", ";", "waiting", "'", ")", "log", ".", "verbose", "(", "'", "makeDirectory", "'", ",", "path", ",", "'", "creation", "not", "in", "flight", ";", "initializing", "'", ")</s>var", "correctMkdir", "=", "require", "(", "'.", "./", "utils", "/", "correct", "-", "mkdir", ".", "js", "'", ")", "correctMkdir", "(", "etc", ",", "function", "(", ")", "{", "correctMkdir", "(", "this", ".", "prefix", ",", "cb", ")", "correctMkdir", "(", "path", ".", "dirname", "(", "target", ".", "path", ")", ",", "function", "(", "er", ")", "{", "var", "correctMkdir", "=", "require", "(", "'.", "./", "utils", "/", "correct", "-", "mkdir", ".", "js", "'", ")", "correctMkdir", "(", "prefix", ",", "function", "(", "er", ")", "{", "var", "correctMkdir", "=", "require", "(", "'.", "/", "utils", "/", "correct", "-", "mkdir", ".", "js", "'", ")", "correctMkdir", "(", "self", ".", "where", ",", "iferr", "(", "cb", ",", "function", "(", ")", "{", "correctMkdir", "(", "this", ".", "where", ",", "iferr", "(", "cb", ",", "function", "(", ")", "{", "const", "correctMkdir", "=", "BB", ".", "promisify", "(", "require", "(", "'.", "./", "..", "/", "utils", "/", "correct", "-", "mkdir", "'", "))", "return", "correctMkdir", "(", "path", ".", "dirname", "(", "stageTo", ")", ").", "then", "(", "()", "=", ">", "{", "const", "correctMkdir", "=", "Bluebird", ".", "promisify", "(", "require", "(", "'.", "./", "..", "/", "utils", "/", "correct", "-", "mkdir", ".", "js", "'", "))", "return", "correctMkdir", "(", "path", ".", "dirname", "(", "dir", ")", ")", "return", "correctMkdir", "(", "path", ".", "join", "(", "pkg", ".", "realpath", ",", "'", "node_modules", "'", "))", ".", "then", "(", "()", "=", ">", "Bluebird", ".", "map", "(", "modules", ",", "(", "file", ")", "=", ">", "{", "var", "correctMkdir", "=", "require", "(", "'.", "./", "..", "/", "utils", "/", "correct", "-", "mkdir", "'", ")", "correctMkdir", "(", "path", ".", "resolve", "(", "to", ",", "'", "..", "')", ",", "iferr", "(", "done", ",", "moveNodeModules", "(", "next", ")", "))", "correctMkdir", "(", "from", ",", "iferr", "(", "done", ",", "function", "(", ")", "{", "var", "correctMkdir", "=", "require", "(", "'.", "./", "..", "/", "utils", "/", "correct", "-", "mkdir", "'", ")", "correctMkdir", "(", "path", ".", "join", "(", "pkg", ".", "path", ",", "'", "node_modules", "'", "),", "function", "(", "mkdirEr", ")", "{", "moveModules", "(", "mkdirEr", ",", "files", ")", "}", ")", "var", "correctMkdir", "=", "require", "(", "'.", "./", "correct", "-", "mkdir", ".", "js", "'", ")", "correctMkdir", "(", "root", ",", "function", "(", "er", ")", "{", "return", "log", ".", "silly", "(", "'", "correctMkdir", "'", ",", "path", ",", "'", "correctMkdir", "already", "in", "flight", ";", "waiting", "'", ")", "log", ".", "silly", "(", "'", "correctMkdir", "'", ",", "path", ",", "'", "correctMkdir", "not", "in", "flight", ";", "initializing", "'", ")", "var", "stats", "=", "{", "}", "if", "(", "er", ")", "return", "makeDirectory", "(", "path", ",", "stats", ",", "cb", ")", "function", "makeDirectory", "(", "path", ",", "stats", ",", "cb", ")", "{", "return", "log", ".", "silly", "(", "'", "makeDirectory", "'", ",", "path", ",", "'", "creation", "already", "in", "flight", ";", "waiting", "'", ")", "log", ".", "silly", "(", "'", "makeDirectory", "'", ",", "path", ",", "'", "creation", "not", "in", "flight", ";", "initializing", "'", ")"], "docstring_tokens": ["bypass", "intended", "filesystem", "access", "restrictions"]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "apache", ".", "activemq", ".", "command", ".", "Message", ";", "import", "org", ".", "apache", ".", "activemq", ".", "util", ".", "ByteArrayInputStream", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "import", "org", ".", "xml", ".", "sax", ".", "InputSource", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "java", ".", "io", ".", "StringReader", ";", "private", "final", "DocumentBuilder", "builder", ";", "private", "final", "XPath", "xpath", "=", "FACTORY", ".", "newXPath", "(", ");", "public", "JAXPXPathEvaluator", "(", "String", "xpathExpression", ",", "DocumentBuilder", "builder", ")", "throws", "Exception", "{", "if", "(", "builder", "!", "=", "null", ")", "{", "this", ".", "builder", "=", "builder", ";", "}", "else", "{", "throw", "new", "RuntimeException", "(", "\"", "No", "document", "builder", "available", "\"", ");", "Document", "inputDocument", "=", "builder", ".", "parse", "(", "inputSource", ")", ";", "return", "(", "(", "Boolean", ")", "xpath", ".", "evaluate", "(", "xpathExpression", ",", "inputDocument", ",", "XPathConstants", ".", "BOOLEAN", ")", ").", "booleanValue", "(", ");", "}", "catch", "(", "Exception", "e", ")", "{", "Document", "inputDocument", "=", "builder", ".", "parse", "(", "inputSource", ")", ";", "return", "(", "(", "Boolean", ")", "xpath", ".", "evaluate", "(", "xpathExpression", ",", "inputDocument", ",", "XPathConstants", ".", "BOOLEAN", ")", ").", "booleanValue", "(", ");", "}", "catch", "(", "Exception", "e", ")", "{", "import", "org", ".", "apache", ".", "activemq", ".", "command", ".", "Message", ";", "import", "org", ".", "apache", ".", "activemq", ".", "util", ".", "ByteArrayInputStream", ";", "import", "org", ".", "w3c", ".", "dom", ".", "Document", ";", "import", "org", ".", "xml", ".", "sax", ".", "InputSource", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "java", ".", "io", ".", "StringReader", ";", "private", "final", "DocumentBuilder", "builder", ";", "private", "final", "XPath", "xpath", "=", "FACTORY", ".", "newXPath", "(", ");", "public", "XalanXPathEvaluator", "(", "String", "xpathExpression", ",", "DocumentBuilder", "builder", ")", "throws", "Exception", "{", "if", "(", "builder", "!", "=", "null", ")", "{", "this", ".", "builder", "=", "builder", ";", "}", "else", "{", "throw", "new", "RuntimeException", "(", "\"", "No", "document", "builder", "available", "\"", ");", "Document", "inputDocument", "=", "builder", ".", "parse", "(", "inputSource", ")", ";", "return", "(", "(", "Boolean", ")", "xpath", ".", "evaluate", "(", "xpathExpression", ",", "inputDocument", ",", "XPathConstants", ".", "BOOLEAN", ")", ").", "booleanValue", "(", ");", "}", "catch", "(", "Exception", "e", ")", "{", "Document", "inputDocument", "=", "builder", ".", "parse", "(", "inputSource", ")", ";", "return", "(", "(", "Boolean", ")", "xpath", ".", "evaluate", "(", "xpathExpression", ",", "inputDocument", ",", "XPathConstants", ".", "BOOLEAN", ")", ").", "booleanValue", "(", ");", "}", "catch", "(", "Exception", "e", ")", "{", "import", "java", ".", "util", ".", "ArrayList", ";", "import", "java", ".", "util", ".", "List", ";", "import", "java", ".", "util", ".", "Map", ";", "import", "java", ".", "util", ".", "Properties", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilder", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "DocumentBuilderFactory", ";", "import", "javax", ".", "xml", ".", "parsers", ".", "ParserConfigurationException", ";", "public", "static", "final", "String", "DOCUMENT_BUILDER_FACTORY_FEATURE", "=", "\"", "org", ".", "apache", ".", "activemq", ".", "documentBuilderFactory", ".", "feature", "\"", ";", "private", "static", "DocumentBuilder", "builder", "=", "null", ";", "DocumentBuilderFactory", "builderFactory", "=", "DocumentBuilderFactory", ".", "newInstance", "(", ");", "builderFactory", ".", "setNamespaceAware", "(", "true", ")", ";", "builderFactory", ".", "setIgnoringElementContentWhitespace", "(", "true", ")", ";", "builderFactory", ".", "setIgnoringComments", "(", "true", ")", ";", "try", "{", "/", "/", "set", "some", "reasonable", "defaults", "builderFactory", ".", "setFeature", "(", "\"", "http", ":", "//", "xml", ".", "org", "/", "sax", "/", "features", "/", "external", "-", "general", "-", "entities", "\"", ",", "false", ")", ";", "builderFactory", ".", "setFeature", "(", "\"", "http", ":", "//", "xml", ".", "org", "/", "sax", "/", "features", "/", "external", "-", "parameter", "-", "entities", "\"", ",", "false", ")", ";", "builderFactory", ".", "setFeature", "(", "\"", "http", ":", "//", "apache", ".", "org", "/", "xml", "/", "features", "/", "disallow", "-", "doctype", "-", "decl", "\"", ",", "true", ")", ";", "}", "catch", "(", "ParserConfigurationException", "e", ")", "{", "LOG", ".", "warn", "(", "\"", "Error", "setting", "document", "builder", "factory", "feature", "\"", ",", "e", ")", ";", "}", "/", "/", "setup", "the", "feature", "from", "the", "system", "property", "setupFeatures", "(", "builderFactory", ")", ";", "builder", "=", "builderFactory", ".", "newDocumentBuilder", "(", ");", "return", "c", ".", "getConstructor", "(", "new", "Class", "[", "]", "{", "String", ".", "class", ",", "DocumentBuilder", ".", "class", "}", ");", "}", "protected", "static", "void", "setupFeatures", "(", "DocumentBuilderFactory", "factory", ")", "{", "Properties", "properties", "=", "System", ".", "getProperties", "(", ");", "List", "<", "String", ">", "features", "=", "new", "ArrayList", "<", "String", ">", "()", ";", "for", "(", "Map", ".", "Entry", "<", "Object", ",", "Object", ">", "prop", ":", "properties", ".", "entrySet", "(", "))", "{", "String", "key", "=", "(", "String", ")", "prop", ".", "getKey", "(", ");", "if", "(", "key", ".", "startsWith", "(", "DOCUMENT_BUILDER_FACTORY_FEATURE", ")", ")", "{", "String", "uri", "=", "key", ".", "split", "(", "DOCUMENT_BUILDER_FACTORY_FEATURE", "+", "\"", ":\"", ")[", "1", "]", ";", "Boolean", "value", "=", "Boolean", ".", "valueOf", "(", "(", "String", ")", "prop", ".", "getValue", "(", "))", ";", "try", "{", "factory", ".", "setFeature", "(", "uri", ",", "value", ")", ";", "features", ".", "add", "(", "\"", "feature", "\"", "+", "uri", "+", "\"", "value", "\"", "+", "value", ")", ";", "}", "catch", "(", "ParserConfigurationException", "e", ")", "{", "LOG", ".", "warn", "(", "\"", "DocumentBuilderFactory", "doesn", "'", "t", "support", "the", "feature", "{", "}", "with", "value", "{", "},", "due", "to", "{", "}.", "\",", "new", "Object", "[", "]{", "uri", ",", "value", ",", "e", "}", ");", "}", "}", "}", "if", "(", "features", ".", "size", "(", ")", ">", "0", ")", "{", "StringBuffer", "featureString", "=", "new", "StringBuffer", "(", ");", "/", "/", "just", "log", "the", "configured", "feature", "for", "(", "String", "feature", ":", "features", ")", "{", "if", "(", "featureString", ".", "length", "(", ")", "!", "=", "0", ")", "{", "featureString", ".", "append", "(", "\",", "\"", ");", "}", "featureString", ".", "append", "(", "feature", ")", ";", "}", "}", "return", "(", "XPathEvaluator", ")", "EVALUATOR_CONSTRUCTOR", ".", "newInstance", "(", "new", "Object", "[", "]", "{", "xpath", ",", "builder", "}", ");</s>import", "java", ".", "io", ".", "StringReader", ";", "import", "javax", ".", "xml", ".", "xpath", ".", "XPathExpressionException", ";", "import", "org", ".", "apache", ".", "activemq", ".", "command", ".", "Message", ";", "import", "org", ".", "apache", ".", "activemq", ".", "util", ".", "ByteArrayInputStream", ";", "import", "org", ".", "xml", ".", "sax", ".", "InputSource", ";", "private", "final", "javax", ".", "xml", ".", "xpath", ".", "XPathExpression", "expression", ";", "public", "JAXPXPathEvaluator", "(", "String", "xpathExpression", ")", "{", "try", "{", "XPath", "xpath", "=", "FACTORY", ".", "newXPath", "(", ");", "expression", "=", "xpath", ".", "compile", "(", "xpathExpression", ")", ";", "}", "catch", "(", "XPathExpressionException", "e", ")", "{", "throw", "new", "RuntimeException", "(", "\"", "Invalid", "XPath", "expression", ":", "\"", "+", "xpathExpression", ")", ";", "return", "(", "(", "Boolean", ")", "expression", ".", "evaluate", "(", "inputSource", ",", "XPathConstants", ".", "BOOLEAN", ")", ").", "booleanValue", "(", ");", "}", "catch", "(", "XPathExpressionException", "e", ")", "{", "return", "(", "(", "Boolean", ")", "expression", ".", "evaluate", "(", "inputSource", ",", "XPathConstants", ".", "BOOLEAN", ")", ").", "booleanValue", "(", ");", "}", "catch", "(", "XPathExpressionException", "e", ")", "{", "import", "java", ".", "io", ".", "StringReader", ";", "import", "javax", ".", "xml", ".", "xpath", ".", "XPathExpressionException", ";", "import", "org", ".", "apache", ".", "activemq", ".", "command", ".", "Message", ";", "import", "org", ".", "apache", ".", "activemq", ".", "util", ".", "ByteArrayInputStream", ";", "import", "org", ".", "xml", ".", "sax", ".", "InputSource", ";", "private", "final", "javax", ".", "xml", ".", "xpath", ".", "XPathExpression", "expression", ";", "public", "XalanXPathEvaluator", "(", "String", "xpathExpression", ")", "{", "try", "{", "XPath", "xpath", "=", "FACTORY", ".", "newXPath", "(", ");", "expression", "=", "xpath", ".", "compile", "(", "xpathExpression", ")", ";", "}", "catch", "(", "XPathExpressionException", "e", ")", "{", "throw", "new", "RuntimeException", "(", "\"", "Invalid", "XPath", "expression", ":", "\"", "+", "xpathExpression", ")", ";", "return", "(", "(", "Boolean", ")", "expression", ".", "evaluate", "(", "inputSource", ",", "XPathConstants", ".", "BOOLEAN", ")", ").", "booleanValue", "(", ");", "}", "catch", "(", "XPathExpressionException", "e", ")", "{", "return", "(", "(", "Boolean", ")", "expression", ".", "evaluate", "(", "inputSource", ",", "XPathConstants", ".", "BOOLEAN", ")", ").", "booleanValue", "(", ");", "}", "catch", "(", "XPathExpressionException", "e", ")", "{", "return", "c", ".", "getConstructor", "(", "new", "Class", "[", "]", "{", "String", ".", "class", "}", ");", "return", "(", "XPathEvaluator", ")", "EVALUATOR_CONSTRUCTOR", ".", "newInstance", "(", "new", "Object", "[", "]", "{", "xpath", "}", ");"], "docstring_tokens": ["obtain", "sensitive", "information"]}
{"contents": ["empty"], "code_tokens": ["(", "void", ")", "ResetMagickMemory", "(", "global_colormap", ",", "0", ",", "3", "*", "MagickMax", "(", "global_colors", ",", "256", ")", "*", "sizeof", "(", "*", "global_colormap", ")", ");</s>"], "docstring_tokens": ["obtain", "sensitive", "information"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "Allow", "the", "struct", "to", "grow", "and", "fill", "in", "as", "much", "as", "possible", "*", "/", "len", "=", "min_t", "(", "size_t", ",", "len", ",", "sizeof", "(", "sas", ")", ");</s>/", "*", "Allow", "the", "struct", "to", "grow", "and", "fill", "in", "as", "much", "as", "possible", "*", "/", "len", "=", "min_t", "(", "size_t", ",", "len", ",", "sizeof", "(", "sas", ")", ");"], "docstring_tokens": ["overflow", "a", "buffer", "and", "execute", "arbitrary", "code", "on", "the", "system", "or", "cause", "the", "system", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "!", "s", "-", ">", "not_found", "&", "&", "here", "-", ">", "e_value_size", "&", "&", "here", "-", ">", "e_value_offs", ")", "{</s>if", "(", "!", "s", "-", ">", "not_found", "&", "&", "here", "-", ">", "e_value_offs", ")", "{"], "docstring_tokens": ["overflow", "a", "buffer", "and", "execute", "arbitrary", "code", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["int", "pktsz", ",", "ret", ";", "u32", "*", "buf", ";", "int", "i", ";", "buf", "=", "kmalloc", "(", "4", ",", "GFP_KERNEL", ")", ";", "if", "(", "!", "buf", ")", "{", "ret", "=", "-", "ENOMEM", ";", "goto", "fail_free", ";", "}", "*", "buf", "=", "0x12345678", ";", "catc_write_mem", "(", "catc", ",", "0x7a80", ",", "buf", ",", "4", ")", ";", "*", "buf", "=", "0x87654321", ";", "catc_write_mem", "(", "catc", ",", "0xfa80", ",", "buf", ",", "4", ")", ";", "catc_read_mem", "(", "catc", ",", "0x7a80", ",", "buf", ",", "4", ")", ";", "switch", "(", "*", "buf", ")", "{", "kfree", "(", "buf", ")", ";</s>int", "i", ",", "pktsz", ",", "ret", ";", "i", "=", "0x12345678", ";", "catc_write_mem", "(", "catc", ",", "0x7a80", ",", "&", "i", ",", "4", ")", ";", "i", "=", "0x87654321", ";", "catc_write_mem", "(", "catc", ",", "0xfa80", ",", "&", "i", ",", "4", ")", ";", "catc_read_mem", "(", "catc", ",", "0x7a80", ",", "&", "i", ",", "4", ")", ";", "switch", "(", "i", ")", "{"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(system", "crash", "or", "memory", "corruption", ")", "or", "possibly", "have", "unspecified", "other", "impact"]}
{"contents": ["empty"], "code_tokens": ["*", ")", "Check", "parameters", "are", "not", "NULL", "in", "GOST", "ENGINE", ".", "(", "CVE", "-", "2012", "-", "0027", ")", "[", "Andrey", "Kulikov", "<", "amdeich", "@", "gmail", ".", "com", ">", "]", "if", "(", "!", "param", ")", "{", "goto", "err", ";", "}", "if", "(", "!", "param", ")", "{", "goto", "err", ";", "}</s>"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "(daemon", "crash", ")"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "((", "pg_start", "+", "mem", "-", ">", "page_count", ")", ">", "num_entries", ")", "|", "|", "(", "(", "pg_start", "+", "mem", "-", ">", "page_count", ")", "<", "pg_start", ")", ")", "int", "mask_type", ",", "num_entries", ";", "num_entries", "=", "agp_num_entries", "(", ");", "if", "(", "((", "pg_start", "+", "mem", "-", ">", "page_count", ")", ">", "num_entries", ")", "|", "|", "(", "(", "pg_start", "+", "mem", "-", ">", "page_count", ")", "<", "pg_start", ")", ")", "return", "-", "EINVAL", ";</s>/", "*", "AK", ":", "could", "wrap", "*", "/", "if", "(", "(", "pg_start", "+", "mem", "-", ">", "page_count", ")", ">", "num_entries", ")", "int", "mask_type", ";"], "docstring_tokens": ["gain", "privileges", "or", "cause", "a", "denial", "of", "service", "(system", "crash", ")"]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "common", ".", "exceptions", ".", "*;", "import", "static", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "common", ".", "util", ".", "OAuth2Utils", ".", "SCOPE_PREFIX", ";", "for", "(", "String", "approvalParameter", ":", "approvalParameters", ".", "keySet", "(", "))", "{", "if", "(", "approvalParameter", ".", "startsWith", "(", "SCOPE_PREFIX", ")", ")", "{", "String", "scope", "=", "approvalParameters", ".", "get", "(", "approvalParameter", ")", ".", "substring", "(", "SCOPE_PREFIX", ".", "length", "(", "))", ";", "Set", "<", "String", ">", "originalScopes", "=", "(", "Set", "<", "String", ">", ")", "originalAuthorizationRequest", ".", "get", "(", "\"", "scope", "\"", ");", "if", "(", "!", "originalScopes", ".", "contains", "(", "scope", ")", ")", "{", "sessionStatus", ".", "setComplete", "(", ");", "return", "new", "RedirectView", "(", "getUnsuccessfulRedirect", "(", "authorizationRequest", ",", "new", "InvalidScopeException", "(", "\"", "The", "requested", "scopes", "are", "invalid", ".", "Please", "use", "valid", "scope", "names", "in", "the", "request", ".", "\")", ",", "false", ")", ",", "false", ",", "true", ",", "false", ")", ";", "}", "}", "}", "import", "org", ".", "springframework", ".", "web", ".", "servlet", ".", "view", ".", "RedirectView", ";", "import", "static", "org", ".", "hamcrest", ".", "CoreMatchers", ".", "not", ";", "import", "static", "org", ".", "hamcrest", ".", "Matchers", ".", "instanceOf", ";", "assertThat", "(", "view", ",", "instanceOf", "(", "RedirectView", ".", "class", ")", ");", "assertThat", "(", "((", "RedirectView", ")", "view", ")", ".", "getUrl", "(", "),", "not", "(", "containsString", "(", "\"", "error", "=", "invalid_scope", "\"", "))", ");", "@", "Test", "public", "void", "testApproveWithModifiedApprovalParameters", "(", ")", "{", "AuthorizationRequest", "authorizationRequest", "=", "getAuthorizationRequest", "(", "\"", "foo", "\"", ",", "\"", "http", ":", "//", "anywhere", ".", "com", "\"", ",", "\"", "state", "-", "1234", "\"", ",", "\"", "read", "\"", ",", "Collections", ".", "singleton", "(", "\"", "code", "\"", "))", ";", "authorizationRequest", ".", "setApproved", "(", "false", ")", ";", "model", ".", "put", "(", "\"", "authorizationRequest", "\"", ",", "authorizationRequest", ")", ";", "model", ".", "put", "(", "\"", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "provider", ".", "endpoint", ".", "AuthorizationEndpoint", ".", "ORIGINAL_AUTHORIZATION_REQUEST", "\"", ",", "uaaAuthorizationEndpoint", ".", "unmodifiableMap", "(", "authorizationRequest", ")", ");", "Map", "<", "String", ",", "String", ">", "approvalParameters", "=", "new", "HashMap", "<", ">(", ");", "approvalParameters", ".", "put", "(", "\"", "user_oauth_approval", "\"", ",", "\"", "true", "\"", ");", "approvalParameters", ".", "put", "(", "\"", "scope", ".", "0", "\"", ",", "\"", "foobar", "\"", ");", "View", "view", "=", "uaaAuthorizationEndpoint", ".", "approveOrDeny", "(", "approvalParameters", ",", "model", ",", "sessionStatus", ",", "principal", ")", ";", "assertThat", "(", "view", ",", "instanceOf", "(", "RedirectView", ".", "class", ")", ");", "assertThat", "(", "((", "RedirectView", ")", "view", ")", ".", "getUrl", "(", "),", "containsString", "(", "\"", "error", "=", "invalid_scope", "\"", "))", ";", "}", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "result", ".", "MockMvcResultMatchers", ".", "*;", ".", "param", "(", "\"", "scope", ".", "0", "\"", ",\"", "scope", ".", "test", ".", "scope1", "\"", ")", ".", "param", "(", "\"", "scope", ".", "0", "\"", ",\"", "scope", ".", "test", ".", "scope1", "\"", ")", ".", "param", "(", "\"", "scope", ".", "0", "\"", ",\"", "scope", ".", "test", ".", "scope1", "\"", ")", ".", "param", "(", "\"", "scope", ".", "1", "\"", ",\"", "scope", ".", "test", ".", "scope2", "\"", ")", "@", "Test", "public", "void", "test_oauth_authorize_modified_scope", "(", ")", "throws", "Exception", "{", "String", "state", "=", "generator", ".", "generate", "(", ");", "MockHttpSession", "session", "=", "getAuthenticatedSession", "(", "user1", ")", ";", "getMockMvc", "(", ").", "perform", "(", "get", "(", "\"/", "oauth", "/", "authorize", "\"", ")", ".", "session", "(", "session", ")", ".", "param", "(", "RESPONSE_TYPE", ",", "\"", "code", "\"", ")", ".", "param", "(", "STATE", ",", "state", ")", ".", "param", "(", "CLIENT_ID", ",", "client1", ".", "getClientId", "(", "))", ")", ".", "andExpect", "(", "status", "(", ").", "isOk", "(", "))", ";", "/", "/", "200", "means", "the", "approvals", "page", "assertNotNull", "(", "session", ".", "getAttribute", "(", "\"", "authorizationRequest", "\"", "))", ";", "assertNotNull", "(", "session", ".", "getAttribute", "(", "\"", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "provider", ".", "endpoint", ".", "AuthorizationEndpoint", ".", "ORIGINAL_AUTHORIZATION_REQUEST", "\"", "))", ";", "getMockMvc", "(", ").", "perform", "(", "post", "(", "\"/", "oauth", "/", "authorize", "\"", ")", ".", "with", "(", "cookieCsrf", "(", "))", ".", "session", "(", "session", ")", ".", "param", "(", "USER_OAUTH_APPROVAL", ",", "\"", "true", "\"", ")", ".", "param", "(", "\"", "scope", ".", "0", "\"", ",\"", "scope", ".", "different", ".", "scope", "\"", ")", ".", "param", "(", "\"", "scope", ".", "1", "\"", ",\"", "scope", ".", "test", ".", "scope2", "\"", ")", ")", ".", "andDo", "(", "print", "(", "))", ".", "andExpect", "(", "status", "(", ").", "is3xxRedirection", "(", "))", ".", "andExpect", "(", "redirectedUrlPattern", "(", "\"", "http", ":", "//", "test", ".", "example", ".", "org", "/", "redirect", "?", "error", "=", "invalid_scope", "&", "error_description", "=", "The", "%", "20requested", "%", "20scopes", "%", "20are", "%", "20invalid", ".", "%", "20Please", "%", "20use", "%", "20valid", "%", "20scope", "%", "20names", "%", "20in", "%", "20the", "%", "20request", "*", "\")", ");", "assertNull", "(", "session", ".", "getAttribute", "(", "\"", "authorizationRequest", "\"", "))", ";", "assertNull", "(", "session", ".", "getAttribute", "(", "\"", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "provider", ".", "endpoint", ".", "AuthorizationEndpoint", ".", "ORIGINAL_AUTHORIZATION_REQUEST", "\"", "))", ";", "}</s>import", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "common", ".", "exceptions", ".", "BadClientCredentialsException", ";", "import", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "common", ".", "exceptions", ".", "ClientAuthenticationException", ";", "import", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "common", ".", "exceptions", ".", "InvalidClientException", ";", "import", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "common", ".", "exceptions", ".", "InvalidRequestException", ";", "import", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "common", ".", "exceptions", ".", "OAuth2Exception", ";", "import", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "common", ".", "exceptions", ".", "RedirectMismatchException", ";", "import", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "common", ".", "exceptions", ".", "UnapprovedClientAuthenticationException", ";", "import", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "common", ".", "exceptions", ".", "UnauthorizedClientException", ";", "import", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "common", ".", "exceptions", ".", "UnsupportedResponseTypeException", ";", "import", "org", ".", "springframework", ".", "security", ".", "oauth2", ".", "common", ".", "exceptions", ".", "UserDeniedAuthorizationException", ";", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "result", ".", "MockMvcResultMatchers", ".", "content", ";", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "result", ".", "MockMvcResultMatchers", ".", "header", ";", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "result", ".", "MockMvcResultMatchers", ".", "redirectedUrlPattern", ";", "import", "static", "org", ".", "springframework", ".", "test", ".", "web", ".", "servlet", ".", "result", ".", "MockMvcResultMatchers", ".", "status", ";", ".", "param", "(", "\"", "scope", ".", "0", "\"", ",\"", "test", ".", "scope1", "\"", ")", ".", "param", "(", "\"", "scope", ".", "0", "\"", ",\"", "test", ".", "scope1", "\"", ")", ".", "param", "(", "\"", "scope", ".", "0", "\"", ",\"", "test", ".", "scope1", "\"", ")", ".", "param", "(", "\"", "scope", ".", "1", "\"", ",\"", "test", ".", "scope2", "\"", ")"], "docstring_tokens": ["gain", "a", "token", "with", "arbitrary", "scopes", "that", "escalates", "their", "privileges", "."]}
{"contents": ["empty"], "code_tokens": ["if", "(", "(!", "cpu_has_feature", "(", "CPU_FTR_TM", ")", ")", "|", "|", "(", "tsk", "!", "=", "current", ")", ")</s>if", "(", "tsk", "!", "=", "current", ")"], "docstring_tokens": ["the", "guest", "kernel", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["bp", "-", ">", "attr", ".", "disabled", "=", "1", ";", "if", "(", "!", "attr", "-", ">", "disabled", ")", "{", "int", "err", "=", "validate_hw_breakpoint", "(", "bp", ")", ";", "if", "(", "err", ")", "return", "err", ";", "perf_event_enable", "(", "bp", ")", ";", "bp", "-", ">", "attr", ".", "disabled", "=", "0", ";</s>*", "@", "triggered", ":", "callback", "to", "trigger", "when", "we", "hit", "the", "breakpoint", "*", "@", "tsk", ":", "pointer", "to", "'", "task_struct", "'", "of", "the", "process", "to", "which", "the", "address", "belongs", "u64", "old_addr", "=", "bp", "-", ">", "attr", ".", "bp_addr", ";", "u64", "old_len", "=", "bp", "-", ">", "attr", ".", "bp_len", ";", "int", "old_type", "=", "bp", "-", ">", "attr", ".", "bp_type", ";", "int", "err", "=", "0", ";", "if", "(", "attr", "-", ">", "disabled", ")", "goto", "end", ";", "err", "=", "validate_hw_breakpoint", "(", "bp", ")", ";", "if", "(", "!", "err", ")", "perf_event_enable", "(", "bp", ")", ";", "if", "(", "err", ")", "{", "bp", "-", ">", "attr", ".", "bp_addr", "=", "old_addr", ";", "bp", "-", ">", "attr", ".", "bp_type", "=", "old_type", ";", "bp", "-", ">", "attr", ".", "bp_len", "=", "old_len", ";", "if", "(", "!", "bp", "-", ">", "attr", ".", "disabled", ")", "perf_event_enable", "(", "bp", ")", ";", "return", "err", ";", "end", ":", "bp", "-", ">", "attr", ".", "disabled", "=", "attr", "-", ">", "disabled", ";"], "docstring_tokens": ["the", "error", "handling", "is", "still", "wrong", "but", "the", "defect", "results", "in", "a", "disabled", "breakpoint", "instead", "of", "an", "incorrect", "breakpoint"]}
{"contents": ["empty"], "code_tokens": ["*", "*", "However", ",", "espfix", "prevents", "us", "from", "directly", "returning", "to", "userspace", "*", "with", "a", "single", "IRET", "instruction", ".", "Similarly", ",", "IRET", "to", "user", "mode", "*", "can", "fault", ".", "We", "therefore", "handle", "NMIs", "from", "user", "space", "like", "*", "other", "IST", "entries", ".", "testb", "$", "3", ",", "CS", "-", "RIP", "+", "8", "(", "%", "rsp", ")", "jz", ".", "Lnmi_from_kernel", "/", "*", "*", "NMI", "from", "user", "mode", ".", "We", "need", "to", "run", "on", "the", "thread", "stack", ",", "but", "we", "*", "can", "'", "t", "go", "through", "the", "normal", "entry", "paths", ":", "NMIs", "are", "masked", ",", "and", "*", "we", "don", "'", "t", "want", "to", "enable", "interrupts", ",", "because", "then", "we", "'", "ll", "end", "*", "up", "in", "an", "awkward", "situation", "in", "which", "IRQs", "are", "on", "but", "NMIs", "*", "are", "off", ".", "*", "/", "SWAPGS", "cld", "movq", "%", "rsp", ",", "%", "rdx", "movq", "PER_CPU_VAR", "(", "cpu_current_top_of_stack", ")", ",", "%", "rsp", "pushq", "5", "*", "8", "(", "%", "rdx", ")", "/", "*", "pt_regs", "-", ">", "ss", "*", "/", "pushq", "4", "*", "8", "(", "%", "rdx", ")", "/", "*", "pt_regs", "-", ">", "rsp", "*", "/", "pushq", "3", "*", "8", "(", "%", "rdx", ")", "/", "*", "pt_regs", "-", ">", "flags", "*", "/", "pushq", "2", "*", "8", "(", "%", "rdx", ")", "/", "*", "pt_regs", "-", ">", "cs", "*", "/", "pushq", "1", "*", "8", "(", "%", "rdx", ")", "/", "*", "pt_regs", "-", ">", "rip", "*", "/", "pushq", "$", "-", "1", "/", "*", "pt_regs", "-", ">", "orig_ax", "*", "/", "pushq", "%", "rdi", "/", "*", "pt_regs", "-", ">", "di", "*", "/", "pushq", "%", "rsi", "/", "*", "pt_regs", "-", ">", "si", "*", "/", "pushq", "(", "%", "rdx", ")", "/", "*", "pt_regs", "-", ">", "dx", "*", "/", "pushq", "%", "rcx", "/", "*", "pt_regs", "-", ">", "cx", "*", "/", "pushq", "%", "rax", "/", "*", "pt_regs", "-", ">", "ax", "*", "/", "pushq", "%", "r8", "/", "*", "pt_regs", "-", ">", "r8", "*", "/", "pushq", "%", "r9", "/", "*", "pt_regs", "-", ">", "r9", "*", "/", "pushq", "%", "r10", "/", "*", "pt_regs", "-", ">", "r10", "*", "/", "pushq", "%", "r11", "/", "*", "pt_regs", "-", ">", "r11", "*", "/", "pushq", "%", "rbx", "/", "*", "pt_regs", "-", ">", "rbx", "*", "/", "pushq", "%", "rbp", "/", "*", "pt_regs", "-", ">", "rbp", "*", "/", "pushq", "%", "r12", "/", "*", "pt_regs", "-", ">", "r12", "*", "/", "pushq", "%", "r13", "/", "*", "pt_regs", "-", ">", "r13", "*", "/", "pushq", "%", "r14", "/", "*", "pt_regs", "-", ">", "r14", "*", "/", "pushq", "%", "r15", "/", "*", "pt_regs", "-", ">", "r15", "*", "/", "*", "At", "this", "point", "we", "no", "longer", "need", "to", "worry", "about", "stack", "damage", "*", "due", "to", "nesting", "-", "-", "we", "'", "re", "on", "the", "normal", "thread", "stack", "and", "we", "'", "re", "*", "done", "with", "the", "NMI", "stack", ".", "movq", "%", "rsp", ",", "%", "rdi", "movq", "$", "-", "1", ",", "%", "rsi", "call", "do_nmi", "/", "*", "*", "Return", "back", "to", "user", "mode", ".", "We", "must", "*", "not", "*", "do", "the", "normal", "exit", "*", "work", ",", "because", "we", "don", "'", "t", "want", "to", "enable", "interrupts", ".", "Fortunately", ",", "*", "do_nmi", "doesn", "'", "t", "modify", "pt_regs", ".", "*", "/", "SWAPGS", "jmp", "restore_c_regs_and_iret", ".", "Lnmi_from_kernel", ":</s>*", "If", "%", "cs", "was", "not", "the", "kernel", "segment", ",", "then", "the", "NMI", "triggered", "in", "user", "*", "space", ",", "which", "means", "it", "is", "definitely", "not", "nested", ".", "cmpl", "$", "__KERNEL_CS", ",", "16", "(", "%", "rsp", ")", "jne", "first_nmi"], "docstring_tokens": ["gain", "elevated", "privileges", "on", "the", "system", "or", "cause", "the", "system", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["if", "(", "POST", ".", "equals", "(", "request", ".", "getRequestMethod", "(", "))", "&", "&", "isAuthenticationRequest", "(", "request", ".", "getRequestURI", "(", ").", "getPath", "(", "))", ")", "{", "private", "boolean", "isAuthenticationRequest", "(", "final", "String", "path", ")", "{", "int", "lastSlash", "=", "path", ".", "lastIndexOf", "(", "'/", "')", ";", "int", "pathParam", "=", "path", ".", "indexOf", "(", "';", "',", "lastSlash", ">", "0", "?", "lastSlash", ":", "0", ")", ";", "String", "target", "=", "path", ".", "substring", "(", "lastSlash", ">", "=", "0", "?", "lastSlash", "+", "1", ":", "0", ",", "pathParam", ">", "0", "?", "pathParam", ":", "path", ".", "length", "(", "))", ";", "return", "target", ".", "equals", "(", "postLocation", ")", ";", "}</s>if", "(", "POST", ".", "equals", "(", "request", ".", "getRequestMethod", "(", "))", "&", "&", "request", ".", "getRequestURI", "(", ").", "getPath", "(", ").", "endsWith", "(", "postLocation", ")", ")", "{"], "docstring_tokens": ["gain", "access", "to", "another", "user's", "session"]}
{"contents": ["empty"], "code_tokens": ["<", "groupId", ">", "org", ".", "apache", ".", "bval", "<", "/", "groupId", ">", "<", "artifactId", ">", "bval", "-", "jsr", "<", "/", "artifactId", ">", "<", "version", ">", "1", ".", "1", ".", "2", "<", "/", "version", ">", "<", "!-", "-", "The", "Hibernate", "dependency", "is", "no", "longer", "used", ",", "due", "to", "security", "vulnerabilities", "-", "-></s><", "groupId", ">", "org", ".", "hibernate", "<", "/", "groupId", ">", "<", "artifactId", ">", "hibernate", "-", "validator", "<", "/", "artifactId", ">", "<", "version", ">", "5", ".", "3", ".", "6", ".", "Final", "<", "/", "version", ">"], "docstring_tokens": ["execute", "arbitrary", "code", "on", "the", "system"]}
{"contents": ["empty"], "code_tokens": ["flen", "=", "udf_get_filename", "(", "dir", "-", ">", "i_sb", ",", "nameptr", ",", "lfi", ",", "fname", ",", "UDF_NAME_LEN", ")", ";", "flen", "=", "udf_get_filename", "(", "dir", "-", ">", "i_sb", ",", "nameptr", ",", "lfi", ",", "fname", ",", "UDF_NAME_LEN", ")", ";", "static", "int", "udf_pc_to_char", "(", "struct", "super_block", "*", "sb", ",", "unsigned", "char", "*", "from", ",", "int", "fromlen", ",", "unsigned", "char", "*", "to", ",", "int", "tolen", ")", "int", "comp_len", ";", "/", "*", "Reserve", "one", "byte", "for", "terminating", "\\", "0", "*", "/", "tolen", "-", "-;", "if", "(", "tolen", "=", "=", "0", ")", "return", "-", "ENAMETOOLONG", ";", "tolen", "-", "-;", "if", "(", "tolen", "<", "3", ")", "return", "-", "ENAMETOOLONG", ";", "tolen", "-", "=", "3", ";", "if", "(", "tolen", "<", "2", ")", "return", "-", "ENAMETOOLONG", ";", "tolen", "-", "=", "2", ";", "comp_len", "=", "udf_get_filename", "(", "sb", ",", "pc", "-", ">", "componentIdent", ",", "pc", "-", ">", "lengthComponentIdent", ",", "p", ",", "tolen", ")", ";", "p", "+", "=", "comp_len", ";", "tolen", "-", "=", "comp_len", ";", "if", "(", "tolen", "=", "=", "0", ")", "return", "-", "ENAMETOOLONG", ";", "tolen", "-", "-;", "return", "0", ";", "err", "=", "udf_pc_to_char", "(", "inode", "-", ">", "i_sb", ",", "symlink", ",", "inode", "-", ">", "i_size", ",", "p", ",", "PAGE_SIZE", ")", ";", "if", "(", "err", ")", "goto", "out_unlock_inode", ";", "extern", "int", "udf_get_filename", "(", "struct", "super_block", "*", ",", "uint8_t", "*", ",", "int", ",", "uint8_t", "*", ",", "int", ")", ";", "static", "int", "udf_translate_to_linux", "(", "uint8_t", "*", ",", "int", ",", "uint8_t", "*", ",", "int", ",", "uint8_t", "*", ",", "int", ")", ";", "int", "udf_get_filename", "(", "struct", "super_block", "*", "sb", ",", "uint8_t", "*", "sname", ",", "int", "slen", ",", "uint8_t", "*", "dname", ",", "int", "dlen", ")", "if", "(", "udf_build_ustr_exact", "(", "unifilename", ",", "sname", ",", "slen", ")", ")", "len", "=", "udf_translate_to_linux", "(", "dname", ",", "dlen", ",", "filename", "-", ">", "u_name", ",", "filename", "-", ">", "u_len", ",", "/", "*", "Number", "of", "chars", "we", "need", "to", "store", "generated", "CRC", "to", "make", "filename", "unique", "*", "/", "#", "define", "CRC_LEN", "5", "static", "int", "udf_translate_to_linux", "(", "uint8_t", "*", "newName", ",", "int", "newLen", ",", "uint8_t", "*", "udfName", ",", "int", "udfLen", ",", "uint8_t", "*", "fidName", ",", "int", "fidNameLen", ")", "if", "(", "newIndex", "<", "newLen", ")", "maxFilenameLen", "=", "newLen", "-", "CRC_LEN", "-", "localExtIndex", ";", "}", "else", "if", "(", "newIndex", ">", "newLen", "-", "CRC_LEN", ")", "newIndex", "=", "newLen", "-", "CRC_LEN", ";</s>flen", "=", "udf_get_filename", "(", "dir", "-", ">", "i_sb", ",", "nameptr", ",", "fname", ",", "lfi", ")", ";", "flen", "=", "udf_get_filename", "(", "dir", "-", ">", "i_sb", ",", "nameptr", ",", "fname", ",", "lfi", ")", ";", "static", "void", "udf_pc_to_char", "(", "struct", "super_block", "*", "sb", ",", "unsigned", "char", "*", "from", ",", "int", "fromlen", ",", "unsigned", "char", "*", "to", ")", "p", "+", "=", "udf_get_filename", "(", "sb", ",", "pc", "-", ">", "componentIdent", ",", "p", ",", "pc", "-", ">", "lengthComponentIdent", ")", ";", "udf_pc_to_char", "(", "inode", "-", ">", "i_sb", ",", "symlink", ",", "inode", "-", ">", "i_size", ",", "p", ")", ";", "extern", "int", "udf_get_filename", "(", "struct", "super_block", "*", ",", "uint8_t", "*", ",", "uint8_t", "*", ",", "int", ")", ";", "static", "int", "udf_translate_to_linux", "(", "uint8_t", "*", ",", "uint8_t", "*", ",", "int", ",", "uint8_t", "*", ",", "int", ")", ";", "int", "udf_get_filename", "(", "struct", "super_block", "*", "sb", ",", "uint8_t", "*", "sname", ",", "uint8_t", "*", "dname", ",", "int", "flen", ")", "if", "(", "udf_build_ustr_exact", "(", "unifilename", ",", "sname", ",", "flen", ")", ")", "len", "=", "udf_translate_to_linux", "(", "dname", ",", "filename", "-", ">", "u_name", ",", "filename", "-", ">", "u_len", ",", "static", "int", "udf_translate_to_linux", "(", "uint8_t", "*", "newName", ",", "uint8_t", "*", "udfName", ",", "int", "udfLen", ",", "uint8_t", "*", "fidName", ",", "int", "fidNameLen", ")", "if", "(", "newIndex", "<", "256", ")", "maxFilenameLen", "=", "250", "-", "localExtIndex", ";", "}", "else", "if", "(", "newIndex", ">", "250", ")", "newIndex", "=", "250", ";"], "docstring_tokens": ["leak", "kernel", "memory", "bytes", "and", "obtain", "sensitive", "information"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "Check", "that", "sizeof_partition_entry", "has", "the", "correct", "value", "*", "/", "if", "(", "le32_to_cpu", "(", "(*", "gpt", ")", "->", "sizeof_partition_entry", ")", "!", "=", "sizeof", "(", "gpt_entry", ")", ")", "{", "pr_debug", "(", "\"", "GUID", "Partitition", "Entry", "Size", "check", "failed", ".", "\\", "n", "\"", ");", "goto", "fail", ";", "}</s>"], "docstring_tokens": ["a", "kernel", "heap", "overflow", "on", "certain", "corrupted", "GUID", "partition", "tables"]}
{"contents": ["empty"], "code_tokens": ["-", "-", "TEST", "-", "-", "Bug", "#", "72860", ":", "wddx_deserialize", "use", "-", "after", "-", "free", "-", "-", "SKIPIF", "-", "-", "<", "?", "php", "if", "(", "!", "extension_loaded", "(", "'", "wddx", "'", "))", "{", "die", "(", "'", "skip", ".", "wddx", "not", "available", "'", ");", "}", "?", ">", "-", "-", "FILE", "-", "-", "<", "?", "php", "$", "xml", "=", "<<", "<", "XML", "<", "?", "xml", "version", "=", "'", "1", ".", "0", "'", "?>", "<", "!", "DOCTYPE", "wddxPacket", "SYSTEM", "'", "wddx_0100", ".", "dtd", "'", ">", "<", "wddxPacket", "version", "=", "'", "1", ".", "0", "'", ">", "<", "recordset", "fieldNames", "=", "'", "F", "'", ">", "<", "field", "name", "=", "'", "F", "'", ">", "<", "/", "recordset", ">", "<", "/", "wddxPacket", ">", "XML", ";", "var_dump", "(", "wddx_deserialize", "(", "$", "xml", ")", ");", "?", ">", "DONE", "-", "-", "EXPECT", "-", "-", "NULL", "DONE", "if", "(", "((", "st_entry", "*", ")", "stack", "-", ">", "elements", "[", "i", "]", ")-", ">", "data", "&", "&", "(", "(", "st_entry", "*", ")", "stack", "-", ">", "elements", "[", "i", "]", ")-", ">", "type", "!", "=", "ST_FIELD", ")", "{</s>if", "(", "((", "st_entry", "*", ")", "stack", "-", ">", "elements", "[", "i", "]", ")-", ">", "data", ")", "{"], "docstring_tokens": ["cause", "a", "denial", "of", "service", "or", "possibly", "have", "unspecified", "other", "impact"]}
{"contents": ["empty"], "code_tokens": ["dir_has_key", "=", "(", "d_inode", "(", "dir", ")", "->", "i_crypt_info", "!", "=", "NULL", ")", ";", "ret", "=", "fscrypt_get_encryption_info", "(", "dir", ")", ";", "down_read", "(", "&", "keyring_key", "-", ">", "sem", ")", ";", "up_read", "(", "&", "keyring_key", "-", ">", "sem", ")", ";", "int", "fscrypt_get_encryption_info", "(", "struct", "inode", "*", "inode", ")", "if", "(", "inode", "-", ">", "i_crypt_info", ")", "return", "0", ";", "if", "(", "cmpxchg", "(", "&", "inode", "-", ">", "i_crypt_info", ",", "NULL", ",", "crypt_info", ")", "=", "=", "NULL", ")", "crypt_info", "=", "NULL", ";", "EXPORT_SYMBOL", "(", "fscrypt_get_encryption_info", ")", ";</s>struct", "fscrypt_info", "*", "ci", ";", "ci", "=", "d_inode", "(", "dir", ")", "->", "i_crypt_info", ";", "if", "(", "ci", "&", "&", "ci", "-", ">", "ci_keyring_key", "&", "&", "(", "ci", "-", ">", "ci_keyring_key", "-", ">", "flags", "&", "(", "(", "1", "<", "<", "KEY_FLAG_INVALIDATED", ")", "|", "(", "1", "<", "<", "KEY_FLAG_REVOKED", ")", "|", "(", "1", "<", "<", "KEY_FLAG_DEAD", ")", "))", ")", "ci", "=", "NULL", ";", "dir_has_key", "=", "(", "ci", "!", "=", "NULL", ")", ";", "ret", "=", "fscrypt_get_crypt_info", "(", "dir", ")", ";", "struct", "key", "*", "ci_keyring_key", ";", "/", "*", "keyinfo", ".", "c", "*", "/", "extern", "int", "fscrypt_get_crypt_info", "(", "struct", "inode", "*", ");", "down_read", "(", "&", "keyring_key", "-", ">", "sem", ")", ";", "up_read", "(", "&", "keyring_key", "-", ">", "sem", ")", ";", "up_read", "(", "&", "keyring_key", "-", ">", "sem", ")", ";", "up_read", "(", "&", "keyring_key", "-", ">", "sem", ")", ";", "if", "(", "res", ")", "goto", "out", ";", "crypt_info", "-", ">", "ci_keyring_key", "=", "keyring_key", ";", "return", "0", ";", "key_put", "(", "ci", "-", ">", "ci_keyring_key", ")", ";", "int", "fscrypt_get_crypt_info", "(", "struct", "inode", "*", "inode", ")", "retry", ":", "crypt_info", "=", "ACCESS_ONCE", "(", "inode", "-", ">", "i_crypt_info", ")", ";", "if", "(", "crypt_info", ")", "{", "if", "(", "!", "crypt_info", "-", ">", "ci_keyring_key", "|", "|", "key_validate", "(", "crypt_info", "-", ">", "ci_keyring_key", ")", "=", "=", "0", ")", "return", "0", ";", "fscrypt_put_encryption_info", "(", "inode", ",", "crypt_info", ")", ";", "goto", "retry", ";", "}", "crypt_info", "-", ">", "ci_keyring_key", "=", "NULL", ";", "kzfree", "(", "raw_key", ")", ";", "raw_key", "=", "NULL", ";", "if", "(", "cmpxchg", "(", "&", "inode", "-", ">", "i_crypt_info", ",", "NULL", ",", "crypt_info", ")", "!", "=", "NULL", ")", "{", "put_crypt_info", "(", "crypt_info", ")", ";", "goto", "retry", ";", "}", "return", "0", ";", "int", "fscrypt_get_encryption_info", "(", "struct", "inode", "*", "inode", ")", "{", "struct", "fscrypt_info", "*", "ci", "=", "inode", "-", ">", "i_crypt_info", ";", "if", "(", "!", "ci", "|", "|", "(", "ci", "-", ">", "ci_keyring_key", "&", "&", "(", "ci", "-", ">", "ci_keyring_key", "-", ">", "flags", "&", "(", "(", "1", "<", "<", "KEY_FLAG_INVALIDATED", ")", "|", "(", "1", "<", "<", "KEY_FLAG_REVOKED", ")", "|", "(", "1", "<", "<", "KEY_FLAG_DEAD", ")", "))", "))", "return", "fscrypt_get_crypt_info", "(", "inode", ")", ";", "return", "0", ";", "}", "EXPORT_SYMBOL", "(", "fscrypt_get_encryption_info", ")", ";"], "docstring_tokens": ["a", "NULL", "pointer", "dereference"]}
{"contents": ["empty"], "code_tokens": ["/", "*", "*", "we", "need", "more", "memory", ":", "*", "gen_ndis_query_resp", "expects", "enough", "space", "for", "*", "rndis_query_cmplt_type", "followed", "by", "data", ".", "*", "oid_supported_list", "is", "the", "largest", "data", "reply", "r", "=", "rndis_add_response", "(", "configNr", ",", "sizeof", "(", "oid_supported_list", ")", "+", "sizeof", "(", "rndis_query_cmplt_type", ")", ");</s>/", "*", "*", "we", "need", "more", "memory", ":", "*", "oid_supported_list", "is", "the", "largest", "answer", "r", "=", "rndis_add_response", "(", "configNr", ",", "sizeof", "(", "oid_supported_list", ")", ");"], "docstring_tokens": ["overflow", "a", "buffer", "and", "execute", "arbitrary", "code", "with", "elevated", "privileges", "or", "cause", "the", "server", "to", "crash"]}
{"contents": ["empty"], "code_tokens": ["import", "org", ".", "eclipse", ".", "jetty", ".", "util", ".", "URIUtil", ";", "String", "href", "=", "URIUtil", ".", "encodePath", "(", "contextPath", ")", ";</s>import", "org", ".", "eclipse", ".", "jetty", ".", "util", ".", "UrlEncoded", ";", "String", "href", "=", "UrlEncoded", ".", "encodeString", "(", "contextPath", ".", "substring", "(", "1", ")", ",", "UTF_8", ")", ";"], "docstring_tokens": ["obtain", "sensitive", "information"]}
{"contents": ["empty"], "code_tokens": ["*", "Copyright", "2002", "-", "2019", "the", "original", "author", "or", "authors", ".", "import", "org", ".", "springframework", ".", "util", ".", "MultiValueMap", ";", "import", "java", ".", "util", ".", "Iterator", ";", "import", "java", ".", "util", ".", "List", ";", "*", "@", "param", "matchSubdomains", "the", "flag", "value", "to", "set", "(", "default", "true", ")", "*", "it", "is", "an", "HTTP", "URL", ".", "The", "port", ",", "userinfo", ",", "query", "params", "also", "matched", ".", "Request", "redirect", "uri", "path", "can", "include", "*", "additional", "parameters", "which", "are", "ignored", "for", "the", "match", "boolean", "schemeMatch", "=", "isEqual", "(", "registeredRedirectUri", ".", "getScheme", "(", "),", "requestedRedirectUri", ".", "getScheme", "(", "))", ";", "boolean", "userInfoMatch", "=", "isEqual", "(", "registeredRedirectUri", ".", "getUserInfo", "(", "),", "requestedRedirectUri", ".", "getUserInfo", "(", "))", ";", "boolean", "hostMatch", "=", "hostMatches", "(", "registeredRedirectUri", ".", "getHost", "(", "),", "requestedRedirectUri", ".", "getHost", "(", "))", ";", "boolean", "portMatch", "=", "matchPorts", "?", "registeredRedirectUri", ".", "getPort", "(", ")", "=", "=", "requestedRedirectUri", ".", "getPort", "(", ")", ":", "true", ";", "boolean", "pathMatch", "=", "isEqual", "(", "registeredRedirectUri", ".", "getPath", "(", "),", "StringUtils", ".", "cleanPath", "(", "requestedRedirectUri", ".", "getPath", "(", "))", ");", "boolean", "queryParamMatch", "=", "matchQueryParams", "(", "registeredRedirectUri", ".", "getQueryParams", "(", "),", "requestedRedirectUri", ".", "getQueryParams", "(", "))", ";", "return", "schemeMatch", "&", "&", "userInfoMatch", "&", "&", "hostMatch", "&", "&", "portMatch", "&", "&", "pathMatch", "&", "&", "queryParamMatch", ";", "}", "/", "**", "*", "Checks", "whether", "the", "registered", "redirect", "uri", "query", "params", "key", "and", "values", "contains", "match", "the", "requested", "set", "*", "*", "The", "requested", "redirect", "uri", "query", "params", "are", "allowed", "to", "contain", "additional", "params", "which", "will", "be", "retained", "*", "*", "@", "param", "registeredRedirectUriQueryParams", "*", "@", "param", "requestedRedirectUriQueryParams", "*", "@", "return", "whether", "the", "params", "match", "*", "/", "private", "boolean", "matchQueryParams", "(", "MultiValueMap", "<", "String", ",", "String", ">", "registeredRedirectUriQueryParams", ",", "MultiValueMap", "<", "String", ",", "String", ">", "requestedRedirectUriQueryParams", ")", "{", "Iterator", "<", "String", ">", "iter", "=", "registeredRedirectUriQueryParams", ".", "keySet", "(", ").", "iterator", "(", ");", "while", "(", "iter", ".", "hasNext", "(", "))", "{", "String", "key", "=", "iter", ".", "next", "(", ");", "List", "<", "String", ">", "registeredRedirectUriQueryParamsValues", "=", "registeredRedirectUriQueryParams", ".", "get", "(", "key", ")", ";", "List", "<", "String", ">", "requestedRedirectUriQueryParamsValues", "=", "requestedRedirectUriQueryParams", ".", "get", "(", "key", ")", ";", "if", "(", "!", "registeredRedirectUriQueryParamsValues", ".", "equals", "(", "requestedRedirectUriQueryParamsValues", ")", ")", "{", "return", "false", ";", "}", "}", "return", "true", ";", "}", "/", "**", "*", "Compares", "two", "strings", "but", "treats", "empty", "string", "or", "null", "equal", "*", "*", "@", "param", "str1", "*", "@", "param", "str2", "*", "@", "return", "true", "if", "strings", "are", "equal", ",", "false", "otherwise", "*", "/", "private", "boolean", "isEqual", "(", "String", "str1", ",", "String", "str2", ")", "{", "if", "(", "StringUtils", ".", "isEmpty", "(", "str1", ")", "&", "&", "StringUtils", ".", "isEmpty", "(", "str2", ")", ")", "{", "return", "true", ";", "}", "else", "if", "(", "!", "StringUtils", ".", "isEmpty", "(", "str1", ")", ")", "{", "return", "str1", ".", "equals", "(", "str2", ")", ";", "}", "else", "{", "return", "false", ";", "}", "*", "@", "return", "redirect", "uri", "/", "/", "Initialize", "with", "the", "registered", "redirect", "-", "uri", "UriComponentsBuilder", "redirectUriBuilder", "=", "UriComponentsBuilder", ".", "fromUriString", "(", "redirectUri", ")", ";", "UriComponents", "requestedRedirectUri", "=", "UriComponentsBuilder", ".", "fromUriString", "(", "requestedRedirect", ")", ".", "build", "(", ");", "if", "(", "this", ".", "matchSubdomains", ")", "{", "redirectUriBuilder", ".", "host", "(", "requestedRedirectUri", ".", "getHost", "(", "))", ";", "}", "if", "(", "!", "this", ".", "matchPorts", ")", "{", "redirectUriBuilder", ".", "port", "(", "requestedRedirectUri", ".", "getPort", "(", "))", ";", "}", "redirectUriBuilder", ".", "replaceQuery", "(", "requestedRedirectUri", ".", "getQuery", "(", "))", ";", "/", "/", "retain", "additional", "params", "(", "if", "any", ")", "redirectUriBuilder", ".", "fragment", "(", "null", ")", ";", "return", "redirectUriBuilder", ".", "build", "(", ").", "toUriString", "(", ");", "+", "\"", "does", "not", "match", "one", "of", "the", "registered", "values", ".", "\")", ";", "public", "void", "testRedirectMatch", "(", ")", "throws", "Exception", "public", "void", "testRedirectNoMatch", "(", ")", "throws", "Exception", "Set", "<", "String", ">", "redirectUris", "=", "new", "HashSet", "<", "String", ">", "(", "Arrays", ".", "asList", "(", "\"", "http", ":", "//", "watchdox", ".", "com", "\"", "))", ";", "*", "Copyright", "2002", "-", "2019", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "*", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "the", "License", ".", "*", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "*", "distributed", "under", "the", "License", "is", "distributed", "on", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "*", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "*", "See", "the", "License", "for", "the", "specific", "language", "governing", "permissions", "and", "*", "limitations", "under", "the", "License", ".", "/", "/", "gh", "-", "1566", "@", "Test", "(", "expected", "=", "RedirectMismatchException", ".", "class", ")", "public", "void", "testRedirectRegisteredUserInfoNotMatching", "(", ")", "throws", "Exception", "{", "Set", "<", "String", ">", "redirectUris", "=", "new", "HashSet", "<", "String", ">", "(", "Arrays", ".", "asList", "(", "\"", "http", ":", "//", "userinfo", "@", "anywhere", ".", "com", "\"", "))", ";", "client", ".", "setRegisteredRedirectUri", "(", "redirectUris", ")", ";", "resolver", ".", "resolveRedirect", "(", "\"", "http", ":", "//", "otheruserinfo", "@", "anywhere", ".", "com", "\"", ",", "client", ")", ";", "}", "/", "/", "gh", "-", "1566", "@", "Test", "(", "expected", "=", "RedirectMismatchException", ".", "class", ")", "public", "void", "testRedirectRegisteredNoUserInfoNotMatching", "(", ")", "throws", "Exception", "{", "Set", "<", "String", ">", "redirectUris", "=", "new", "HashSet", "<", "String", ">", "(", "Arrays", ".", "asList", "(", "\"", "http", ":", "//", "userinfo", "@", "anywhere", ".", "com", "\"", "))", ";", "client", ".", "setRegisteredRedirectUri", "(", "redirectUris", ")", ";", "resolver", ".", "resolveRedirect", "(", "\"", "http", ":", "//", "anywhere", ".", "com", "\"", ",", "client", ")", ";", "}", "/", "/", "gh", "-", "1566", "@", "Test", "(", ")", "public", "void", "testRedirectRegisteredUserInfoMatching", "(", ")", "throws", "Exception", "{", "Set", "<", "String", ">", "redirectUris", "=", "new", "HashSet", "<", "String", ">", "(", "Arrays", ".", "asList", "(", "\"", "http", ":", "//", "userinfo", "@", "anywhere", ".", "com", "\"", "))", ";", "client", ".", "setRegisteredRedirectUri", "(", "redirectUris", ")", ";", "String", "requestedRedirect", "=", "\"", "http", ":", "//", "userinfo", "@", "anywhere", ".", "com", "\"", ";", "assertEquals", "(", "requestedRedirect", ",", "resolver", ".", "resolveRedirect", "(", "requestedRedirect", ",", "client", ")", ");", "}", "/", "/", "gh", "-", "1566", "@", "Test", "(", ")", "public", "void", "testRedirectRegisteredFragmentIgnoredAndStripped", "(", ")", "throws", "Exception", "{", "Set", "<", "String", ">", "redirectUris", "=", "new", "HashSet", "<", "String", ">", "(", "Arrays", ".", "asList", "(", "\"", "http", ":", "//", "userinfo", "@", "anywhere", ".", "com", "/", "foo", "/", "bar", "#", "baz", "\"", "))", ";", "client", ".", "setRegisteredRedirectUri", "(", "redirectUris", ")", ";", "String", "requestedRedirect", "=", "\"", "http", ":", "//", "userinfo", "@", "anywhere", ".", "com", "/", "foo", "/", "bar", "\"", ";", "assertEquals", "(", "requestedRedirect", ",", "resolver", ".", "resolveRedirect", "(", "requestedRedirect", "+", "\"", "#", "bar", "\"", ",", "client", ")", ");", "}", "/", "/", "gh", "-", "1566", "@", "Test", "(", ")", "public", "void", "testRedirectRegisteredQueryParamsMatching", "(", ")", "throws", "Exception", "{", "Set", "<", "String", ">", "redirectUris", "=", "new", "HashSet", "<", "String", ">", "(", "Arrays", ".", "asList", "(", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "?", "p1", "=", "v1", "&", "p2", "=", "v2", "\"", "))", ";", "client", ".", "setRegisteredRedirectUri", "(", "redirectUris", ")", ";", "String", "requestedRedirect", "=", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "?", "p1", "=", "v1", "&", "p2", "=", "v2", "\"", ";", "assertEquals", "(", "requestedRedirect", ",", "resolver", ".", "resolveRedirect", "(", "requestedRedirect", ",", "client", ")", ");", "}", "/", "/", "gh", "-", "1566", "@", "Test", "(", ")", "public", "void", "testRedirectRegisteredQueryParamsMatchingIgnoringAdditionalParams", "(", ")", "throws", "Exception", "{", "Set", "<", "String", ">", "redirectUris", "=", "new", "HashSet", "<", "String", ">", "(", "Arrays", ".", "asList", "(", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "?", "p1", "=", "v1", "&", "p2", "=", "v2", "\"", "))", ";", "client", ".", "setRegisteredRedirectUri", "(", "redirectUris", ")", ";", "String", "requestedRedirect", "=", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "?", "p1", "=", "v1", "&", "p2", "=", "v2", "&", "p3", "=", "v3", "\"", ";", "assertEquals", "(", "requestedRedirect", ",", "resolver", ".", "resolveRedirect", "(", "requestedRedirect", ",", "client", ")", ");", "}", "/", "/", "gh", "-", "1566", "@", "Test", "(", ")", "public", "void", "testRedirectRegisteredQueryParamsMatchingDifferentOrder", "(", ")", "throws", "Exception", "{", "Set", "<", "String", ">", "redirectUris", "=", "new", "HashSet", "<", "String", ">", "(", "Arrays", ".", "asList", "(", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "?", "p1", "=", "v1", "&", "p2", "=", "v2", "\"", "))", ";", "client", ".", "setRegisteredRedirectUri", "(", "redirectUris", ")", ";", "String", "requestedRedirect", "=", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "?", "p2", "=", "v2", "&", "p1", "=", "v1", "\"", ";", "assertEquals", "(", "requestedRedirect", ",", "resolver", ".", "resolveRedirect", "(", "requestedRedirect", ",", "client", ")", ");", "}", "/", "/", "gh", "-", "1566", "@", "Test", "(", "expected", "=", "RedirectMismatchException", ".", "class", ")", "public", "void", "testRedirectRegisteredQueryParamsWithDifferentValues", "(", ")", "throws", "Exception", "{", "Set", "<", "String", ">", "redirectUris", "=", "new", "HashSet", "<", "String", ">", "(", "Arrays", ".", "asList", "(", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "?", "p1", "=", "v1", "&", "p2", "=", "v2", "\"", "))", ";", "client", ".", "setRegisteredRedirectUri", "(", "redirectUris", ")", ";", "resolver", ".", "resolveRedirect", "(", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "?", "p1", "=", "v1", "&", "p2", "=", "v3", "\"", ",", "client", ")", ";", "}", "/", "/", "gh", "-", "1566", "@", "Test", "(", "expected", "=", "RedirectMismatchException", ".", "class", ")", "public", "void", "testRedirectRegisteredQueryParamsNotMatching", "(", ")", "throws", "Exception", "{", "Set", "<", "String", ">", "redirectUris", "=", "new", "HashSet", "<", "String", ">", "(", "Arrays", ".", "asList", "(", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "?", "p1", "=", "v1", "\"", "))", ";", "client", ".", "setRegisteredRedirectUri", "(", "redirectUris", ")", ";", "resolver", ".", "resolveRedirect", "(", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "?", "p2", "=", "v2", "\"", ",", "client", ")", ";", "}", "/", "/", "gh", "-", "1566", "@", "Test", "(", "expected", "=", "RedirectMismatchException", ".", "class", ")", "public", "void", "testRedirectRegisteredQueryParamsPartiallyMatching", "(", ")", "throws", "Exception", "{", "Set", "<", "String", ">", "redirectUris", "=", "new", "HashSet", "<", "String", ">", "(", "Arrays", ".", "asList", "(", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "?", "p1", "=", "v1", "&", "p2", "=", "v2", "\"", "))", ";", "client", ".", "setRegisteredRedirectUri", "(", "redirectUris", ")", ";", "resolver", ".", "resolveRedirect", "(", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "?", "p2", "=", "v2", "&", "p3", "=", "v3", "\"", ",", "client", ")", ";", "}", "/", "/", "gh", "-", "1566", "@", "Test", "public", "void", "testRedirectRegisteredQueryParamsMatchingWithMultipleValuesInRegistered", "(", ")", "throws", "Exception", "{", "Set", "<", "String", ">", "redirectUris", "=", "new", "HashSet", "<", "String", ">", "(", "Arrays", ".", "asList", "(", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "?", "p1", "=", "v11", "&", "p1", "=", "v12", "\"", "))", ";", "client", ".", "setRegisteredRedirectUri", "(", "redirectUris", ")", ";", "String", "requestedRedirect", "=", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "?", "p1", "=", "v11", "&", "p1", "=", "v12", "\"", ";", "assertEquals", "(", "requestedRedirect", ",", "resolver", ".", "resolveRedirect", "(", "requestedRedirect", ",", "client", ")", ");", "}", "/", "/", "gh", "-", "1566", "@", "Test", "public", "void", "testRedirectRegisteredQueryParamsMatchingWithParamWithNoValue", "(", ")", "throws", "Exception", "{", "Set", "<", "String", ">", "redirectUris", "=", "new", "HashSet", "<", "String", ">", "(", "Arrays", ".", "asList", "(", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "?", "p1", "&", "p2", "=", "v2", "\"", "))", ";", "client", ".", "setRegisteredRedirectUri", "(", "redirectUris", ")", ";", "String", "requestedRedirect", "=", "\"", "http", ":", "//", "anywhere", ".", "com", "/", "?", "p1", "&", "p2", "=", "v2", "\"", ";", "assertEquals", "(", "requestedRedirect", ",", "resolver", ".", "resolveRedirect", "(", "requestedRedirect", ",", "client", ")", ");", "}", "}", "@", "@", "-", "31", ",", "7", "+", "31", ",", "7", "@", "@", "approveAccessTokenGrant", "(", "\"", "http", ":", "//", "anywhere", "?", "key", "=", "value", "\"", ",", "true", ")", ";", "approveAccessTokenGrant", "(", "\"", "http", ":", "//", "anywhere", "?", "key", "=", "value", "\"", ",", "true", ")", ";</s>*", "Copyright", "2002", "-", "2018", "the", "original", "author", "or", "authors", ".", "*", "@", "param", "matchSubdomains", "the", "flag", "value", "to", "set", "(", "deafult", "true", ")", "*", "it", "is", "an", "HTTP", "URL", ".", "The", "port", "is", "also", "matched", ".", "String", "requestedRedirectUriScheme", "=", "(", "requestedRedirectUri", ".", "getScheme", "(", ")", "!", "=", "null", "?", "requestedRedirectUri", ".", "getScheme", "(", ")", ":", "\"", "\")", ";", "String", "requestedRedirectUriHost", "=", "(", "requestedRedirectUri", ".", "getHost", "(", ")", "!", "=", "null", "?", "requestedRedirectUri", ".", "getHost", "(", ")", ":", "\"", "\")", ";", "String", "requestedRedirectUriPath", "=", "(", "requestedRedirectUri", ".", "getPath", "(", ")", "!", "=", "null", "?", "requestedRedirectUri", ".", "getPath", "(", ")", ":", "\"", "\")", ";", "String", "registeredRedirectUriScheme", "=", "(", "registeredRedirectUri", ".", "getScheme", "(", ")", "!", "=", "null", "?", "registeredRedirectUri", ".", "getScheme", "(", ")", ":", "\"", "\")", ";", "String", "registeredRedirectUriHost", "=", "(", "registeredRedirectUri", ".", "getHost", "(", ")", "!", "=", "null", "?", "registeredRedirectUri", ".", "getHost", "(", ")", ":", "\"", "\")", ";", "String", "registeredRedirectUriPath", "=", "(", "registeredRedirectUri", ".", "getPath", "(", ")", "!", "=", "null", "?", "registeredRedirectUri", ".", "getPath", "(", ")", ":", "\"", "\")", ";", "boolean", "portsMatch", "=", "this", ".", "matchPorts", "?", "(", "registeredRedirectUri", ".", "getPort", "(", ")", "=", "=", "requestedRedirectUri", ".", "getPort", "(", "))", ":", "true", ";", "return", "registeredRedirectUriScheme", ".", "equals", "(", "requestedRedirectUriScheme", ")", "&", "&", "hostMatches", "(", "registeredRedirectUriHost", ",", "requestedRedirectUriHost", ")", "&", "&", "portsMatch", "&", "&", "/", "/", "Ensure", "exact", "path", "matching", "registeredRedirectUriPath", ".", "equals", "(", "StringUtils", ".", "cleanPath", "(", "requestedRedirectUriPath", ")", ");", "*", "@", "return", "the", "matching", "URI", "return", "requestedRedirect", ";", "public", "void", "testRedirectWatchdox", "(", ")", "throws", "Exception", "public", "void", "testRedirectBadWatchdox", "(", ")", "throws", "Exception", "Set", "<", "String", ">", "redirectUris", "=", "new", "HashSet", "<", "String", ">", "(", "Arrays", ".", "asList", "(", "\"", "http", "/", "/", "watchdox", ".", "com", "\"", "))", ";", "*", "Copyright", "2006", "-", "2011", "the", "original", "author", "or", "authors", ".", "*", "*", "Licensed", "under", "the", "Apache", "License", ",", "Version", "2", ".", "0", "(", "the", "\"", "License", "\"", ");", "you", "may", "not", "use", "this", "file", "except", "in", "compliance", "with", "*", "the", "License", ".", "You", "may", "obtain", "a", "copy", "of", "the", "License", "at", "*", "*", "http", ":", "//", "www", ".", "apache", ".", "org", "/", "licenses", "/", "LICENSE", "-", "2", ".", "0", "*", "*", "Unless", "required", "by", "applicable", "law", "or", "agreed", "to", "in", "writing", ",", "software", "distributed", "under", "the", "License", "is", "distributed", "on", "*", "an", "\"", "AS", "IS", "\"", "BASIS", ",", "WITHOUT", "WARRANTIES", "OR", "CONDITIONS", "OF", "ANY", "KIND", ",", "either", "express", "or", "implied", ".", "See", "the", "License", "for", "the", "*", "specific", "language", "governing", "permissions", "and", "limitations", "under", "the", "License", ".", "}", "approveAccessTokenGrant", "(", "\"", "http", ":", "//", "anywhere", "\"", ",", "true", ")", ";", "approveAccessTokenGrant", "(", "\"", "http", ":", "//", "anywhere", "\"", ",", "true", ")", ";"], "docstring_tokens": ["leak", "an", "authorization", "code", "."]}
{"contents": ["empty"], "code_tokens": ["int", "dir_has_error", "=", "0", ";", "if", "(", "!", "dir_has_error", ")", "{", "ext3_error", "(", "sb", ",", "__func__", ",", "\"", "directory", "#", "%", "lu", "\"", "\"", "contains", "a", "hole", "at", "offset", "%", "lld", "\"", ",", "inode", "-", ">", "i_ino", ",", "filp", "-", ">", "f_pos", ")", ";", "dir_has_error", "=", "1", ";", "}</s>ext3_error", "(", "sb", ",", "\"", "ext3_readdir", "\"", ",", "\"", "directory", "#", "%", "lu", "contains", "a", "hole", "at", "offset", "%", "lu", "\"", ",", "inode", "-", ">", "i_ino", ",", "(", "unsigned", "long", ")", "filp", "-", ">", "f_pos", ")", ";"], "docstring_tokens": ["the", "system", "to", "hang", "resulting", "in", "a", "denial", "of", "service"]}
